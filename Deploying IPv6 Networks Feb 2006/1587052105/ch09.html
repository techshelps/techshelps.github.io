<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Chapter 9.&nbsp; Securing IPv6 Networks</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch08lev1sec5.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch09lev1sec1.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><TD valign="top"><a name="ch09"></a>
<h2 class="docChapterTitle">Chapter 9. Securing IPv6 Networks</H2>
<p class="docText"><a name="iddle1870"></a>It is regularly stated that IPv6 is more secure than IPv4. In fact, this argument is often used to promote the deployment of IPv6. The assertion stems from the original mandated use of IPsec in host-to-host communication, as specified in RFC 2401. It is a natural requirement in the context of IPv6's intent to provide a new infrastructure that supports peer-to-peer applications. If this mandate would be enforced by all hosts, properly implemented by all applications, and a reliable and efficient key-exchange system would be universally adopted, it would mean a more secure data transport. The consistent use of IPsec on host-to-host communication would also enable network operators to track sources of attacks. Nevertheless, it would not prevent application layer security threats, which are common.</P>
<a name="ch09note01"></a><div class="docNote"><p class="docNoteTitle">Note</p>

<p class="docText">RFC 2401's requirement to use IPsec on all hosts might limit IPv6 adoption for certain communication devices. Mobile phones, for example, might not have the capability to implement IPsec. To stimulate the adoption of IPv6 by the third generation of mobile systems, the IPsec requirement might become optional in the future.</P>
</div><br>
<p class="docText">At this time, however, the conditions for a consistent use of end-to-end security are not in place; so for the most part, IPv6 is neither more nor less secure than IPv4. Both protocols face most of the same threats. IPv6 specificities bring new perspectives on some types of attacks. These specificities along with protocol security enhancements intrinsically close the door for some threats, although open new doors for others. Moreover, the likely coexistence of the two versions of IP can potentially offer attackers new venues to exploit security holes and to circumvent the defenses of one protocol to attack the other.</p>
<p class="docText">This chapter reviews the security threats faced by an IPv6 infrastructure and its users. It draws a parallel to IPv4, highlighting differences and similarities. The review is based on an exhaustive study of this topic by Sean Convery and Darrin Miller in the white paper, &quot;IPv6 and IPv4 Threat Comparison and Best-Practice Evaluation.&quot; <a class="docLink" href="#ch09table01">Table 9-1</a> summarizes the topics covered later in this chapter.</P>
<a name="ch09table01"></a><P><table cellspacing="0" class="allBorders" border="1" RULES="all" cellpadding="4"><caption><H5 class="docTableTitle">Table 9-1. Review of Security Threats</h5></caption><colgroup><col width="100"><col width="200"><col width="200"></colgroup><thead><tr><th class="thead" scope="col" align="left" valign="bottom"><p class="docText">Threat</p></th><th class="thead" scope="col" align="left" valign="bottom"><p class="docText">IPv6 Characteristics</P></th><th class="thead" scope="col" align="left" valign="bottom"><p class="docText">Mitigation</p></th></tr><TR><th class="thead" scope="col" align="left" valign="bottom" colspan="3" style="background-color:#DDDDDD"><p class="docText">Threats with New Considerations in IPv6</P></th></tr></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText">Reconnaissance</p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Scanning for hosts is not feasible because of large address space. Well-known addresses, in particular multicast, are vulnerable.</p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Same as IPv4. Privacy extensions can make reconnaissance less effective.</P></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">Unauthorized access</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">End-to-end security reduces the exposure. Extension headers (EH) open new attack venues.</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Use privacy extensions to reduce a host's exposure. Use multiple addresses with different scopes. Manage EH use.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">Header manipulation</P></td><td class="docTableCell" align="left" valign="top"><p class="docText">IPv6 can take advantage of chained and large-size EHs.</p>
<p class="docText">EHs that must be processed by all stacks are particularly useful to an attacker.</P></td><TD class="docTableCell" align="left" valign="top"><p class="docText">The EHs usage should be strictly controlled based on deployed services.</P></td></TR><tr><td class="docTableCell" align="left" valign="top"><p class="docText">Fragmentation</P></TD><TD class="docTableCell" align="left" valign="top"><p class="docText">No fragment overlap should be allowed in IPv6, but some stacks do reassemble overlapping fragments. The impact of tiny fragments is minimal in IPv6.</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Use properly implemented stacks that do not allow fragment overlap.</P></td></tr><TR><TD class="docTableCell" align="left" valign="top"><p class="docText">Layer 3/layer 4 spoofing</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">The use of tunneling offers more spoofing opportunities even though they are not different from IPv4 tunneling.</p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Same mitigation techniques as with IPv4.</p></TD></tr><TR><td class="docTableCell" align="left" valign="top"><p class="docText">Host initialization and address-resolution attacks</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">DHCP has similar vulnerabilities for the two protocols. Neighbor Discovery has similar vulnerabilities as ARP. Stateless autoconfiguration and renumbering offer new attack options.</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Use an interim solution such as static neighbors; the SEND recommendations are adopted by the IPv6 stacks.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">Broadcast-amplification attacks (Smurf)</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">No concept of broadcast in IPv6, and that reduces the amplification options.</P></td><td class="docTableCell" align="left" valign="top"><p class="docText">Use filtering for multicast traffic, in particular, because it is the only amplification option.</p></TD></tr><TR><TD class="docTableCell" align="left" valign="top"><p class="docText">Routing attacks</p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">IPsec provides additional peering security for some protocols. From a threat perspective, it is similar to IPv4.</p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText">Same as IPv4. Wherever possible, implement IPsec.</P></td></tr><tr><TD class="docTableCell" align="left" valign="top"><p class="docText">Viruses and worms</p></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Same as IPv4. Random scanning used by worms to propagate is impractical in IPv6 because of the large address space.</P></td><td class="docTableCell" align="left" valign="top"><p class="docText">Same as IPv4.</p></td></TR><tr><td class="docTableCell" align="left" valign="top"><p class="docText">Transition-mechanism attacks</P></td><TD class="docTableCell" align="left" valign="top"><p class="docText">New ports to open in IPv4 firewalls. Automatic tunnels are more susceptible to attacks. IPv6-IPv4 translation can hide the sources of attacks.</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Tighter control of ports opened in the firewalls; open only the ones needed. Use static tunnels when possible.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">Mobile IP</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Embedded in IPv6. Has specific security features.</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Filter out all routing headers except Type 2 if MIPv6 is used. Securing MIPv6 beyond IPsec is a work in progress.</p></TD></tr><tr><td class="docTableCell" align="left" valign="top" colspan="3" style="background-color:#DDDDDD"><p class="docText"><span class="docEmphStrong">Threats with Similar Behavior in IPv4 and IPv6</span></P></td></TR><TR><td class="docTableCell" align="left" valign="top"><p class="docText">Sniffing</P></td><td class="docTableCell" align="left" valign="top"><p class="docText">Same as IPv4.</P></TD><TD class="docTableCell" align="left" valign="top"><p class="docText">Same as IPv4</p></td></tr><TR><td class="docTableCell" align="left" valign="top"><p class="docText">Application layer attacks</p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText">IPsec offers the potential to increase security and to track attackers.</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Similar to IPv4, security ultimately relies on host defenses.</p></TD></tr><tr><TD class="docTableCell" align="left" valign="top"><p class="docText">Rogue devices</p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Same as IPv4.</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">IPsec can prevent interaction with such devices. Lower-layer protocols such as 802.1x can be used to block unauthorized devices from connecting to the network.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">Man-in-the-middle attacks</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">IPsec can protect so long as the key is not stolen.</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">There is a big need for a scalable and operationally feasible authentication and key-exchange mechanism.</P></td></tr><tr><TD class="docTableCell" align="left" valign="top"><p class="docText">Flooding attacks</p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText">Same as IPv4, with a few additional traffic types.</p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Use traffic-limiting mechanisms.</p></TD></TR></table></P><br>
<p class="docText">The analysis of the security threats is complemented with a set of best practices rules that apply in each case presented. The security tools available for IPv6 in Cisco devices are also discussed in this chapter.</p>
<a name="ch09note02"></a><div class="docNote"><p class="docNoteTitle">Note</p>

<p class="docText">The best practices recommended should be viewed in the light of the fact that at the time of this writing there is limited experience operating IPv6 networks.</P>
</div><br>
<p class="docText">Before tackling IPv6 security, it is important to discuss the typical IPv4 topology to implement perimeter security. On one hand, this discussion would help choose the best way to integrate IPv6 in the existent networks without weakening deployed security measures. On the other hand, because of the similarities between the two protocols, it is likely that the same concepts will be used to secure IPv6 networks, too.</p>
<p class="docText"><a class="docLink" href="#ch09fig01">Figure 9-1</a> shows the typical topology used in deploying perimeter security for IPv4 networks. You can add dedicated devices such as intrusion detection systems (IDSs) to this topology if the functionality is not supported by the same device that acts as a firewall. Additional levels of security are most likely implemented at the host level, particularly for important devices and resources.</P>
<a name="ch09fig01"></a><P><center>
<h5 class="docFigureTitle">Figure 9-1. Typical IPv4 Perimeter Security Topology</h5>

<p class="docText">
<img border="0" alt="" width="500" height="256" SRC="images/09fig01.jpg"></p>

</center></p><BR>
<p class="docText"><a name="iddle1771"></a><a name="iddle1880"></a>This figure shows is a common approach to securing networks, but this setup relies on fact that its perimeter can be clearly identified. Many books are available for more in-depth information about IPv4 security such as Sean Convery's <span class="docEmphasis">Network Security Architectures</span>.</p>

<a href="22971536.html"><img src="images/pixel.jpg" alt="" width="1" height="1" border="0"></a></TD></TR></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch08lev1sec5.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch09lev1sec1.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>