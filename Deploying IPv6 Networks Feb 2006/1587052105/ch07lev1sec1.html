<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Virtual Private Network Overview</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch07.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch07lev1sec2.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><TR><TD valign="top"><a name="ch07lev1sec1"></a>
<H3 class="docSection1Title">Virtual Private Network Overview</h3>
<p class="docText">VPN technology enables enterprises to connect their sites together over a public infrastructure; it allows businesses to set up extranets between themselves, and telecommuters to connect to their office network. It has mechanisms that offer security and quality of service (QoS), enabling applications such as voice and video.</p>
<p class="docText">For enterprises buying VPN service (instead of building their own private network using, for example, leased lines) from an SP, the main benefits are price and flexibility. The lower prices and flexibility are the result of the SP's ability to reduce operational costs by consolidating its services over a single IP infrastructure. This consolidation leads to better use of resources and enables the provider to offer value-added services such as guaranteed QoS, multicast, redundant routes, fast path recovery, and so on, on a &quot;get-what-you-pay-for&quot; basis.</p>
<p class="docText">Two VPN models have been widely deployed in recent years: the CE-based (&quot;overlay&quot;) model, and the PE-based (&quot;peer-to-peer&quot;) model. Although they are briefly discussed in the following sections, the terminology is introduced here:</p>
<ul><li><p class="docText"><span class="docEmphStrong">Provider network</span> This is the SP network, enabling connectivity between customer sites (also referred as P-network).</p></li><li><p class="docText"><span class="docEmphStrong">Customer network</span> This is the customer network, typically a set of customer sites, to be connected over the P-network.</p></li><li><p class="docText"><span class="docEmphStrong">Customer site</span> This is one, topologically contiguous customer site such as a campus or remote office.</P></li><li><p class="docText"><span class="docEmphStrong">Provider device (P)</span> An SP router that does not connect to customer sites.</P></LI><li><p class="docText"><span class="docEmphStrong">Provider edge device (PE)</span> An SP router connected to VPN customer sites. The PE router marks the edge of the P-network.</p></li><li><p class="docText"><span class="docEmphStrong">Customer edge device (CE)</span> A customer router that connects the customer site to the P-network.</P></li><li><p class="docText"><span class="docEmphStrong">Virtual private network (VPN)</span> A set of customer sites that are allowed to communicate with each other and are subject to a common set of administrative policies. Note that a &quot;site&quot; can be a single remote user.</p></li><LI><p class="docText"><span class="docEmphStrong">IPv4 VPN</span> A VPN that connects IPv4-enabled sites.</P></LI><li><p class="docText"><span class="docEmphStrong">IPv6 VPN</span> A VPN that connects IPv6-enabled sites.</p></li><li><p class="docText"><span class="docEmphStrong">Dual-stack VPN</span> A VPN that connects separately IPv4-enabled sites and IPv6-enabled sites.</p></li><li><p class="docText"><span class="docEmphStrong">Hybrid VPN</span> A VPN that connects IPv4-only enabled sites and IPv6-only enabled site.</p></li></ul>
<p class="docText">Many of the same techniques and mechanisms are used in both the CE-based and the PE-based VPN models. The difference between the two models is one of economy, politics, and administrative domains rather than technology.</p>
<p class="docText">IPsec is most often used in CE-based VPNs, and MPLS in PE-based VPNs.</p>
<p class="docText">The mechanisms and technology used in deploying IPv6 VPNs are the same as for IPv4 VPNs. Some differences apply as to how an IPv6 VPN will be deployed, however. Because IPv6 has enough addresses (to say the least), there is no need to use a private overlapping address range. Avoiding overlapping address space simplifies management and makes merging several private internets into a single private internet much easier.</p>
<p class="docText">A challenge for the deployment of IPv6 in general and IPv6 VPN in particular relates to its coexistence with IPv4. It is expected that the public infrastructure will migrate to IPv6 at a slower pace than some of the private networks. In a network where most of the core will remain IPv4 only, IPv6 VPNs will have to be tunneled over it. Benefits and issues related to tunneling are not specific to VPNs, and various mechanisms are reviewed in <a class="docLink" href="ch03.html#ch03">Chapter 3</a>, &quot;Delivering IPv6 Unicast Services,&quot; in the section &quot;<a class="docLink" href="ch03lev1sec4.html#ch03lev2sec8">IPv6 over IPv4 Tunnels</a>.&quot;) In an MPLS-enabled network, however, using a similar approach as 6PE (see <a class="docLink" href="ch03.html#ch03">Chapter 3</a>, section &quot;<a class="docLink" href="ch03lev1sec4.html#ch03lev3sec21">IPv6 over 6PE</a>&quot;), IPv6 MPLS VPN could run over an IPv4-based core without the drawbacks of <a name="iddle1171"></a><a name="iddle1220"></a><a name="iddle1726"></a><a name="iddle1740"></a>tunneling. Such an implementation of IPv6 VPN is referred to as <span class="docEmphasis">6VPE</span> and is discussed in the section &quot;<a class="docLink" href="ch07lev1sec3.html#ch07lev1sec3">BGP-MPLS IPv6 VPNs: A PE-Based VPN Solution</a>.&quot;</p>
<p class="docText">For a more in-depth study of VPNs, refer to the following books: <span class="docEmphasis">VPN Applications Guide</span> by David McDysan, and <span class="docEmphasis">MPLS and VPN Architectures</span> by Ivan Pepelnjak and Jim Guichard.</P>
<a name="ch07lev2sec1"></a>
<H4 class="docSection2Title">Provider-Provisioned VPNs</H4>
<p class="docText">Provider-provisioned VPNs (PPVPNs) are VPN services operated by the SPs. <a class="docLink" href="#ch07table01">Table 7-1</a> illustrates the taxonomy of PPVPN.</P>
<a name="ch07table01"></a><P><table cellspacing="0" class="allBorders" border="1" RULES="all" cellpadding="4"><caption><h5 class="docTableTitle">Table 7-1. Taxonomy of PPVPNs</h5></caption><colgroup><col width="75"><col width="75"><col width="130"><col width="270"></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top" rowspan="7"><p class="docText">PPVPN</p></td><td class="docTableCell" align="left" valign="top" rowspan="4"><p class="docText">L2 VPN</p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphUl">CE-based</span></p></td><TD class="docTableCell" align="left" valign="top"><p class="docText">L2TP: Layer 2 Tunneling Protocol.</p></td></TR><TR><td class="docTableCell" align="left" valign="top" rowspan="3"><p class="docText"><span class="docEmphUl">PE-based</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">VPWS: Wire service.</P></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">VPLS: LAN service.</P></TD></TR><tr><td class="docTableCell" align="left" valign="top"><p class="docText">IPLS: IP-only LAN service.</p></td></tr><tr><td class="docTableCell" align="left" valign="top" rowspan="3"><p class="docText">L3 VPN</p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphUl">CE-based</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">IPsec. VPN knowledge limited to CEs.</p></TD></TR><TR><TD class="docTableCell" align="left" valign="top" rowspan="6"><p class="docText"><span class="docEmphUl">PE-based</span></P>
<p class="docText">Per-VPN forwarding tables</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">BGP-MPLS IP VPN: The PE maintains VPN states to provide users isolation.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">Virtual router: The PE maintains a logical view per VPN.</p></td></tr></table></p><BR>
<p class="docText">Because layer 2 VPNs are transparent to higher-layer protocols, they are applicable to both IPv4 and IPv6. They also prove useful for transporting legacy System Networks Architecture (SNA) NetBIOS and IPX traffic, for which a layer 3 VPN solution is not available. They offer a quick path for supporting IPv6 VPNs.</p>

<a name="ch07lev2sec2"></a>
<h4 class="docSection2Title">CE-Based VPNs</H4>
<p class="docText">CE-based VPNs can provide layer 2 or layer 3 services. CE routers connect together over the common infrastructure by the means of trunks. The trunks can be layer 1 (TDM), layer 2 (virtual circuit), or layer 3 (IP tunnels). The VPN can be operated by the user or the provider. In all cases, they terminate at the customer sites. The boundary between the private network and the shared public infrastructure is on the CE router. Any tunneling mechanism can be used to achieve CE-based L3 VPN, such as IPsec, 6to4, or IP-in-IP.</P>
<p class="docText">With IPsec, data integrity and confidentiality is guaranteed &quot;end to end&quot; (apart from the fact that there are no guarantees when it comes to security).</p>
<p class="docText">Other tunneling mechanisms, such as GRE tunneling, 6to4, or IP-in-IP, can also be used, but these have none of IPsec's security capabilities, unless of course, you use IPsec to secure them.</p>
<p class="docText">L2TP, specified in RFC 2661, is also used as a CE-based L2 VPN protocol.</p>
<p class="docText"><a name="iddle1086"></a><a name="iddle1691"></a><a name="iddle2046"></a>CE-based VPNs can easily span multiple providers: the CE-to-CE tunnels work as long as there is IP connectivity.</p>
<p class="docText">Routing occurs between customer sites and is transparent to the SP; the customer network is an overlay on top of the provider network, which is used as a transport mechanism. To achieve effective routing, each site has to have a tunnel to every other site in what is called a fully meshed design. This would result in <span class="docEmphasis">N(N</span>1)/2 number of tunnels for <span class="docEmphasis">N</span> sites. Not only could the number of tunnels result in scalability issues on the routers terminating the tunnels, but the number also results in a huge cost of operating the network. Each time a new site is added, new tunnels must be created on all the other sites. Typically, some sort of hub-and-spoke network is used to work around this problem; however, this workaround might result in suboptimal routing.</P>
<p class="docText">QoS is also a problematic area for CE-based VPNs, especially when the VPN crosses multiple SPs. In this case, service level agreements (SLAs) are difficult to negotiate. In this respect, PE-based VPNs are better, not because they can offer better QoS, but because the provider has already prepared the network for QoS and can offer this as a value-added service as a part of the PE-based VPN offering.</p>

<a name="ch07lev2sec3"></a>
<h4 class="docSection2Title">PE-Based VPNs</h4>
<p class="docText">PE-based VPN solutions involve the capability of the PE router to separate customer routing policies. Two approaches have emerged to achieve this. With the first approach, the physical PE router can be split into disjointed logical routers, each instance taking care of one VPN. With the second approach, each VPN routing table is managed independently by a single router exchanging routes between sites. The former is the so-called virtual router approach, whereas the latter is the BGP-MPLS IP VPN approach. You can use both with IPv6, but only BGP-MPLS IPv6 VPN has been implemented on Cisco routers.</p>
<p class="docText">In the PE-based VPN model, the CE router and the PE router share a common routing protocol and associated routing tables. A fraction of the PE is literally a part of the customer network, in charge of exchanging customer routes with remote customer sites by peering with remote PEs. CEs never peer directly; instead, they peer indirectly via PEs. Therefore, to achieve optimal routing, it is sufficient to mesh PEs, which are significantly less than the CEs of all customers (a PE can be attached to several customers). If you deploy MPLS PE-based VPNs, the data plane is operated independently of the routing plane, so that routing hubs do not result in suboptimal forwarding paths. Because routing uses the Border Gateway Protocol (BGP), it can leverage BGP mechanisms such as route reflectors to limit the number of peerings required.</P>

<a name="ch07lev2sec4"></a>
<H4 class="docSection2Title">Addressing Considerations</H4>
<p class="docText">Regardless of the VPN model deployed, you must define an addressing plan for the VPN, one that allows hosts to communicate within one site, within one VPN (with other sites), and with public resources.</p>
<p class="docText"><a name="iddle1172"></a><a name="iddle1221"></a><a name="iddle1382"></a><a name="iddle1692"></a><a name="iddle1733"></a><a name="iddle1898"></a><a name="iddle1999"></a><a name="iddle2027"></a><a name="iddle2055"></a>VPN IPv4 sites often use private addressing as defined in RFC 1918 for their addressing plan. These addresses do not need to be registered, and they are not routable on the public network. Whenever a host within a private site needs to access a public domain, it goes through a device exposing a public address on its behalf. With IPv4, this can be a Network Address Translator (NAT) or an application proxy.</p>
<p class="docText">Given the larger address space available with IPv6, the easiest solution to this problem is to use IPv6 global addresses for the private addressing plan.</p>
<p class="docText">Another approach is to use unique local addresses (ULAs), described in <a class="docLink" href="ch02.html#ch02">Chapter 2</a>, &quot;An IPv6 Refresher,&quot; in the section &quot;<a class="docLink" href="ch02lev1sec1.html#ch02lev4sec2">Unique Local Unicast Address</a>.&quot; According to Internet Draft draft-ietf-ipv6-unique-local-addr (Proposed Standard), ULAs are easier to filter at site boundaries based on their scope (well-known prefix structure). They are also Internet service provider independent and can be used for communications inside of a site without having any permanent or intermittent Internet connectivity.</p>
<p class="docText">When a host within a private site needs to access a public domain, it can either go via an IPv6 application proxy (such as a web proxy for accessing web pages), which will access the public resource on its behalf with a global routable address, or it can use a public address of its own. In the latter case, if ULAs have been deployed, the IPv6 host is configured with a routable global address, too. The source address selection algorithm, described in <a class="docLink" href="ch02.html#ch02">Chapter 2</a>, is used to select one or the other based on the destination address.</p>

<a name="ch07lev2sec5"></a>
<h4 class="docSection2Title">Security Considerations</h4>
<p class="docText">The two VPN models approach security in different ways. The goal of the PE-based model is to offer security similar to the layer 2 VPNs it was designed to replace. The CE-based model was designed by the IPsec working group and focused heavily on all aspects of security from the start.</p>
<p class="docText"><a class="docLink" href="#ch07table02">Table 7-2</a> compares the security aspects of the two most deployed technologies of each model, IPsec and MPLS.</p>
<a name="ch07table02"></a><p><table cellspacing="0" class="allBorders" border="1" RULES="all" cellpadding="4"><caption><h5 class="docTableTitle">Table 7-2. Security Comparison Between IPsec and MPLS</h5></caption><colgroup><col width="150"><col width="150"><col width="200"></colgroup><thead><tr><th class="thead" scope="col" align="left" valign="bottom"><p class="docText">Security Feature</p></th><th class="thead" scope="col" align="left" valign="bottom"><p class="docText">IPsec</P></th><th class="thead" scope="col" align="center" valign="bottom"><p class="docText">MPLS</P></th></TR></thead><TR><TD class="docTableCell" align="left" valign="top"><p class="docText">Data confidentiality</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Through encryption algorithms</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">By defining a single path between physical sites.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">Data integrity</p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Through hashing algorithms</p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText">Not available, but separate routing lowers the risk of data alteration.</p></td></tr><tr><TD class="docTableCell" align="left" valign="top"><p class="docText">Data availability</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">None &quot;extra.&quot; Relies on Internet transport. Redundancy can be deployed.</p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText">Relies on MPLS transport. Label switched path (LSP) can be protected by using private label tables.</P>
<p class="docText">Redundancy can be deployed.</p></td></tr></table></p><br>
<p class="docText"><a name="iddle1035"></a><a name="iddle1165"></a><a name="iddle1168"></a><a name="iddle1217"></a><a name="iddle1450"></a><a name="iddle1777"></a>You can easily use IPsec to secure remote-access traffic. MPLS VPNs face the challenge of securing the traffic of a remote user as it traverses the network of an SP other than the one providing the VPN service. Solutions exist to enable the traffic to cross the SP boundaries, but they may entail deployment challenges. You can see examples in the section &quot;<a class="docLink" href="ch07lev1sec4.html#ch07lev2sec24">Interprovider VPNs</a>&quot; as well as in <a class="docLink" href="ch13.html#ch13">Chapter 13</a>, &quot;Deploying IPv6 in an MPLS Service Provider Network.&quot;</p>
<p class="docText">Access to the Internet from a VPN is a challenge because such access can open a door for attackers. However, you can access the Internet from both VPN models, although more easily with IPsec, which does not separately manage private and public routing tables. In addition, poor implementations or complex configurations could easily defeat the best intentions. In that regard, it is important to note that IPsec puts most of the configuration burden on the CE, whereas for the MPLS VPN, the configuration complexity is on the PE, which typically is a router with more resources than the CE.</p>
<p class="docText">As with all security, it all comes down to whom you trust. MPLS VPNs provide no data confidentiality, and you have to trust the provider to get the configuration right, so that traffic is not leaked outside the VPN. In the IPsec case, you get data confidentiality, but only to the edge of the site. Because traffic inside the site is unencrypted, additional security policies need to be implemented. If communications must be confidential, traffic should be encrypted end to end. In that case, it does not make any difference whether the VPN itself provides data confidentiality.</p>


</TD></TR></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch07.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch07lev1sec2.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>