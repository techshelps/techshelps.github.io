<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<title>MSComm Control Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbobjcommx"></a>MSComm Control Example</h1>
<p>
The following simple example shows basic serial communications using a modem: </p>
<pre><code>Private Sub Form_Load ()
   ' Buffer to hold input string
   Dim Instring As String
   ' Use COM1.
   <span class=cfe><b>MSComm1</b></span>.CommPort = 1
   ' 9600 baud, no parity, 8 data, and 1 stop bit.
   <span class=cfe><b>MSComm1</b></span>.Settings = "9600,N,8,1"
   ' Tell the control to read entire buffer when Input
   ' is used.
   <span class=cfe><b>MSComm1</b></span>.InputLen = 0
   ' Open the port.
   <span class=cfe><b>MSComm1</b></span>.PortOpen = True
   ' Send the attention command to the modem.
   MSComm1.Output = "ATV1Q0" &amp; Chr$(13) ' Ensure that 
   ' the modem responds with "OK".
   ' Wait for data to come back to the serial port.
   Do
      DoEvents
   Buffer$ = Buffer$ &amp; MSComm1.Input
   Loop Until InStr(Buffer$, "OK" &amp; vbCRLF)
   ' Read the "OK" response data in the serial port.
   ' Close the serial port.
   MSComm1.PortOpen = False
End Sub
</code></pre>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The <b>MSComm</b> control can use polling or an event-driven method to retrieve data from the port. This simple example uses the polling method. For an example of the event-driven method, see help for the OnComm event.</p>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
