<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<title>MAPIMessages Control</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbobjmapim"></a>MAPIMessages Control</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbobjMAPIM_C;vbobjMAPIMC;vbproBooksOnlineJumpTopic">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbobjMAPIM_X;vbobjMAPIMX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Properties">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbobjMAPIM_P;vbobjMAPIMP">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Methods">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbobjMAPIM_M;vbobjMAPIMM">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Events">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbobjMAPIM_E;vbobjMAPIME">
</object></p>
<p>
The messaging application program interface (MAPI) controls allow you to create mail-enabled Visual Basic MAPI applications. There are two MAPI controls:
<ul type=disc>
<li>
MAPISession<br><br></li>
<li>
MAPIMessages</li>
</ul>
<p>
The <b>MAPISession</b> control signs on and establishes a MAPI session. It is also used to sign off from a MAPI session. The <b>MAPIMessages</b> control allows the user to perform a variety of messaging system functions.</p>
<p>
The MAPI controls are invisible at run time. In addition, there are no events for the controls. To use them, you must specify the appropriate methods.</p>
<p>
The <b>MAPIMessages</b> control performs a variety of messaging system functions after a messaging session is established with the <b>MAPISession</b> control.</p>
<p>
For these controls to work, MAPI services must be present. MAPI services are provided in MAPI compliant electronic mail systems.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;If you attempt to run a program that uses the MAPI controls, make sure that you have the 32-bit MAPI DLLs installed properly or you may not be able to perform simple MAPI functions such as SignOn. For example, on Windows 95, you must install Mail during the operating system setup, or install it separately from the control panel to correctly use MAPI functions or MAPI custom controls from Visual Basic.</p>
<p class=label>
<b>Syntax</b></p>
<p>
MAPIMessages</p>
<p class=label>
<b>Remarks</b></p>
<p>
With the MAPIMessages control, you can:
<ul type=disc>
<li>
Access messages currently in the Inbox.<br><br></li>
<li>
Compose a new message.<br><br></li>
<li>
Add and delete message recipients and attachments.<br><br></li>
<li>
Send messages (with or without a supporting user interface).<br><br></li>
<li>
Save, copy, and delete messages.<br><br></li>
<li>
Display the Address Book dialog box.<br><br></li>
<li>
Display the Details dialog box.<br><br></li>
<li>
Access attachments, including Object Linking and Embedding (OLE) attachments.<br><br></li>
<li>
Resolve a recipient name during addressing.<br><br></li>
<li>
Perform reply, reply-all, and forward actions on messages.</li>
</ul>
<p>
Most of the properties of the <b>MAPIMessages</b> control can be categorized into four functional areas: address book, file attachment, message, and recipient properties. The file attachment, message, and recipient properties are controlled by the <b>AttachmentIndex</b>, <b>MsgIndex</b>, and <b>RecipIndex</b> properties, respectively.</p>
<p class=label>
<b>Message Buffers</b></p>
<p>
When using the <b>MAPIMessages</b> control, you need to keep track of two buffers, the <i>compose buffer</i> and the <i>read buffer</i>. The read buffer is made up of an indexed set of messages fetched from a user's Inbox. The <b>MsgIndex</b> property is used to access individual messages within this set, starting with a value of 0 for the first message and incrementing by one for each message through the end of the set.</p>
<p>
The message set is built using the <b>Fetch</b> method. The set includes all messages of type <b>FetchMsgType</b> and is sorted as specified by the <b>FetchSorted</b> property. Previously read messages can be included or left out of the message set with the <b>FetchUnreadOnly</b> property. Messages in the read buffer can't be altered by the user, but can be copied to the compose buffer for alteration.</p>
<p>
Messages can be created or edited in the compose buffer. The compose buffer is the active buffer when the <b>MsgIndex</b> property is set to -1. Many of the messaging actions are valid only within the compose buffer, such as sending messages, sending messages with a dialog box, saving messages, or deleting recipients and attachments.</p>
<p>
Refer to the object library in the Object Browser for property and error constants for the control.</p>
</BODY>
</HTML>
