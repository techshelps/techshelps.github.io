<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">
   <title>Setting Up Behaviors</title><link rel="stylesheet" type="text/css" href="./style/cpm.css"><link rel="stylesheet" type="text/css" href="./style/isd.css"><link rel="stylesheet" type="text/css" href="./style/commons.css"><link rel="stylesheet" type="text/css" href="./style/contents.css"><link rel="stylesheet" type="text/css" href="./style/header.css"><link rel="stylesheet" type="text/css" href="./style/indexes.css"><link rel="stylesheet" type="text/css" href="./style/search.css"><link rel="stylesheet" type="text/css" href="./style/med.css"><script type="text/javascript" src="./scripts/ac.strings.js"></script><script type="text/javascript" src="./ac_common.js"></script><script type="text/javascript" src="./scripts/acmap.js"></script><script type="text/javascript" src="./scripts/ac.acad_ak.js"></script><script type="text/javascript" src="./scripts/index-processing.js"></script><script type="text/javascript" src="./scripts/search-processing.js"></script><script type="text/javascript" src="./scripts/toc-processing.js"></script><script type="text/javascript" src="./scripts/highlight.js"></script><script type="text/javascript" src="./scripts/favorites.js"></script><script type="text/javascript" src="./scripts/commons-processing.js"></script><script language="javascript">
            function hideInfo() {
                info = document.getElementById('infoline');
                info.innerHTML = ' ';
                info.style.visibility = 'hidden';
            }
            function showInfo(title) {
                info = document.getElementById('infoline');
                info.innerHTML = title;
                info.style.visibility='visible';
            }
        </script><meta name="description" content="Setting Up Behaviors"><meta name="keywords" content=""><meta name="topic-type" content="concept"></head><body><!--
							Name = Topic;
							Class =  CPM-Topic ISD-Topic ;
							Url = WSf742dab041063133fb5604511363e4556c-7fe9.htm--><div class="head"><div class="head-block"><div class="nav-group"><!--browse buttons--><div class="browse"><nobr><!--No Additional browse buttons are defined--><div id="prevTitle" style="display:none">Associating Bipeds with Delegates</div><a href="WSf742dab041063133fb5604511363e4556c-7fea.htm" class="headNavLink" onmouseover="showInfo(document.getElementById('prevTitle').innerHTML);" onmouseout="hideInfo();"><img src="./images/nav-prev-xp.gif" border="0"></a><div id="parentTitle" style="display:none">Animating Biped Crowds</div><a href="WS1a9193826455f5ff13cfd6e1136132a36f-7cbf.htm" class="headNavLink" onmouseover="showInfo(document.getElementById('parentTitle').innerHTML);" onmouseout="hideInfo();"><img src="./images/nav-up-xp.gif" border="0"></a><div id="nextTitle" style="display:none">Creating Multiple BIP Files</div><a href="WSf742dab041063133fb5604511363e4556c-7fe8.htm" class="headNavLink" onmouseover="showInfo(document.getElementById('nextTitle').innerHTML);" onmouseout="hideInfo();"><img src="./images/nav-next-xp.gif" border="0"></a></nobr></div><!--end browse buttons--></div><div class="button-info"><span id="infoline">&nbsp;</span></div><div class="ancestry"><a href="welcome.htm">Autodesk 3ds Max Tutorials</a>&nbsp;&gt;&nbsp;<a href="WSf742dab04106313311b7d0e3112a19e3350-8000.htm">Character Animation Tutorials</a>&nbsp;&gt;&nbsp;<a href="WS1a9193826455f5ff13cfd6e1136132a36f-7cbf.htm">Animating Biped Crowds</a>&nbsp;&gt;&nbsp;</div><div class="head-text"><span>Setting Up Behaviors</span></div></div></div><div class="head-margin">&nbsp;</div><div style="line-height: 0pt">&nbsp;</div><div class="head-margin">&nbsp;</div><span style="display:none"><a name="WSf742dab041063133fb5604511363e4556c-7fe9"></a></span>

<!--Body-->
<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c43"></a></span>In this lesson, you'll work with biped settings
and behaviors to make the simulation solve correctly.</p>
<!--UList--><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c42"></a></span>
<p class="list-intro"><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c41"></a></span>Set
up this lesson:</p>
<ul><li>Open
the file <em class="mild">my_biped_crowds03.max</em> that you
created in the previous lesson, or open <em class="mild">tut_biped_crowds03.max</em>.<span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c40"></a></span><div class="figure-anchor">
<p><img src="./images/MED/3dsMaxTut/English/ill/ill_biped_crowd_merge_pandas.png"></p>
</div>
<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c3f"></a></span>This file contains the scene from the previously
completed lesson. </p>
</li></ul>

<!--OList--><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c3e"></a></span>
<p class="list-intro"><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c3d"></a></span>Set
delegates to use random start clips:</p>
<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c3c"></a></span>You can specify that biped/delegates should
use either the first clip of the current script or a random start
clip setting. When you first solve this simulation, none of the
bipeds will have scripts, so you must choose the second option.</p>
<ol type="1" start="1"><li>Select
the Crowd helper in the viewport.</li><li>
<img src="./images/MED/3dsMaxTut/English/but/b_edit_mult_delegates.png"> In the
Modify panel &gt; Setup rollout, click Multiple Delegate Editing.</li><li>In
the Edit Multiple Delegates dialog &gt; Delegates To Edit group, click
the Add button.</li><li>In
the Select dialog, click All and then Select. This selects all delegates
for editing.</li><li>In
the Biped group, choose Random Start Clip and turn on its SET check
box.<span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c3b"></a></span><div class="figure-anchor">
<p><img src="./images/MED/3dsMaxTut/English/dlg/dlg_biped_crowds_setting_up_behaviors_edit.png"></p>
</div>
<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c3a"></a></span>Turning on SET indicates that this new setting
should take effect when you click Apply Edit.</p>
</li><li>Click
the Apply Edit button at the bottom of the dialog.</li></ol>






<!--UList--><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c39"></a></span>
<p class="list-intro"><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c38"></a></span>Solve
the simulation:</p>
<ul><li>In
the Modify panel &gt; Solve rollout, click the Solve button.<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c37"></a></span>After a few moments, each biped moves to its
respective delegate, and begins to walk through the simulation.</p>
<div><span style="display:none"><a name="WS1a9193826455f5ff662ffb11407b58d52-714c"></a></span><div class="note-tip"><span class="label">Tip</span>You can speed up the solution process significantly
by increasing the Solve rollout &gt; Display During Solve group
&gt; Frequency setting to a higher number such as <span class="charspan-special">
<em class="strong">20</em>
</span> or <span class="charspan-special">
<em class="strong">50</em>
</span>.
This will update viewports less frequently during the solution process.
For even faster solution calculation, you can turn off Update Display,
but you will not be able to see the solution until it is complete.<span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c36"></a></span><div class="figure-anchor">
<p><img src="./images/MED/3dsMaxTut/English/rol/rol_biped_crowds_setting_up_behaviors_solve.png"></p>
</div>
</div></div>
<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c35"></a></span>The bipeds move toward and away from the center,
as the delegates did earlier. However, they tend to cluster at the
center. The fathers don't wander very much from the center, and
the other bipeds follow them.</p>
<span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c34"></a></span><div class="figure-anchor">
<p><img src="./images/MED/3dsMaxTut/English/ill/ill_biped_crowd_center_bunch.png"></p>
</div>
<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c33"></a></span>This is a common situation with biped crowds.
Often, the behavior settings for delegates alone are not exactly
right for a biped simulation. You will change the behaviors slightly
to suit the bipeds.</p>
<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c32"></a></span>There is an additional problem that the bipeds
pass through one another. You will solve this problem after you
get the behaviors working correctly.</p>
<div><span style="display:none"><a name="WS1a9193826455f5ff662ffb11407b58d52-714b"></a></span><div class="note-tip"><span class="label">Tip</span>
<img src="./images/MED/3dsMaxTut/English/but/but_biped_convert.png"> All
the clips in this simulation contain freeform animation, rather
than footsteps. Freeform and footstep clips work equally well in
a biped crowd simulation. However, a simulation that uses footstep
clips will display all the footsteps used by each biped, which can
clutter viewports and make it difficult to see what's going on in
the scene. For this reason, freeform clips were used for this simulation.
The clips actually started out as footstep clips, but were converted
to freeform animation by loading the clip on a biped and clicking
Convert on the Motion panel &gt; Biped rollout.</div></div>
</li></ul>

<!--OList--><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c31"></a></span>
<p class="list-intro"><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c30"></a></span>Adjust
the behaviors:</p>
<ol type="1" start="1"><li>Select
the Crowd helper.</li><li>On
the Modify panel &gt; Setup rollout &gt; Behaviors group, choose the
Wander behavior.<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c2f"></a></span>In the Wander Behavior rollout, the Period value
sets the number of frames during which the delegate or biped should
wander. Then the biped or delegate ceases wandering, and follows
other behaviors in the simulation. </p>
<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c2e"></a></span>When using the Wander behavior with biped crowds,
the Period should be set to slightly longer than the average clip
length. This gives the simulation enough time to choose an entire
clip for the wandering period. Most clips in this simulation are
about 90 frames long.</p>
</li><li>In
the Wander Behavior rollout, change the Period value to <em class="strong">100</em>.<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c2d"></a></span>To keep the father bipeds from clustering at
the center, you can also reduce the weight of the behavior that
causes them to seek the center box.</p>
</li><li>
<img src="./images/MED/3dsMaxTut/English/but/b_behav_assign.png"> In the
Setup rollout, click Behavior Assignments.</li><li>In
the Behavior Assignments area, highlight the Seek Center Box behavior
assigned to the Fathers team, and change the Weight value at the bottom
of the dialog to <em class="strong">0.01</em>. Click OK to close the dialog.<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c2c"></a></span>This lower weight setting will make the father
bipeds less likely to seek the center box, and more likely to wander.</p>
</li><li>In
the Solve rollout, click Solve.<span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c2b"></a></span><div class="figure-anchor">
<p><img src="./images/MED/3dsMaxTut/English/ill/ill_biped_crowds_setting_up_behaviors_solve1.png"></p>
</div>
<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c2a"></a></span>This time, the activity in the scene is more
varied. The bipeds approach the center, walk away from the center,
and come back, which is similar to the original movement of the
delegates alone. </p>
<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c29"></a></span>However, the bipeds don't always avoid each
other successfully; at times, they pass through one another. This
happens because directional changes indicated by the delegate behaviors
can be overridden by the motion clips guiding the biped animation.
To avoid collisions, the biped motion must take precedence.</p>
</li></ol>






<!--OList--><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c28"></a></span>
<p class="list-intro"><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c27"></a></span>Set
priorities:</p>
<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c26"></a></span>To resolve the problem of biped collisions,
you can set priorities for bipeds. This approach causes the crowd
system to solve one biped's motion at a time. As each biped's motion
is determined, subsequent bipeds can accurately predict the location
of bipeds solved earlier, and choose clips in such a way that collisions
will be avoided. </p>
<ol type="1" start="1"><li>Go
to frame 0.<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c25"></a></span>The Browns, the three delegates at the top of
the Top viewport, will have priority over the Blacks.</p>
</li><li>Select
the Crowd helper.</li><li>On
the Modify panel, at the bottom of the Priority rollout, turn on
Display Priorities.<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c24"></a></span>In the viewport, each delegate displays the
number 0. By default, the Priority value 0 is assigned to all delegates.
You can change Priority assignments manually, picking delegates
in the appropriate order. </p>
<span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c23"></a></span><div class="figure-anchor">
<p><img src="./images/MED/3dsMaxTut/English/ill/ill_biped_crowds_setting_up_behaviors_display.png"></p>
</div>
<div style="margin-top:9pt"><span style="display:none"><a name="WS1a9193826455f5ff662ffb11407b58d52-714a"></a></span><div class="note-note"><span class="label">Note</span>Delegates
with lower Priority values take precedence over those with higher
values. Thus, for example, a delegate with Priority 0 goes before
a delegate with Priority 1, and so on.</div></div>
</li><li>In
the Priority rollout &gt; Assign By Picking group, click the Pick/Assign
button.<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c22"></a></span>When this mode is turned on, you can pick only
delegates in the scene.</p>
</li><li>In
the Top viewport, click the rightmost delegate in the top group.<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c21"></a></span>By default, you assign a Priority value of 0
to the first delegate you pick, so the number doesn't change.</p>
</li><li>Pick
the delegate to its left.<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c20"></a></span>The Priority value 1 appears next to the delegate. </p>
</li><li>Continue
to pick delegates in a counter-clockwise manner, ending with the
rightmost delegate at the bottom of the Top viewport. <p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c1f"></a></span>The Brown family members now have priorities
0, 1, and 2, while the Blacks have 3, 4, and 5.</p>
</li><li>Right-click
in the viewport to turn off Pick/Assign.<div><span style="display:none"><a name="WS1a9193826455f5ff662ffb11407b58d52-7149"></a></span><div class="note-tip"><span class="label">Tip</span>If
the priority numbers are obscured by the bipeds, you can check the
priority assignments by selecting each delegate and checking its Priority
value at the bottom of the Modify panel. If you do so, select the Crowd
helper again before continuing.</div></div>
<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c1e"></a></span>To enable Crowd to use priorities, you must
turn the feature on.</p>
</li><li>In
the Solve rollout &gt; Bipeds group, turn on Biped/Delegates Only,
Use Priorities and Backtracking.<span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c1d"></a></span><div class="figure-anchor">
<p><img src="./images/MED/3dsMaxTut/English/rol/rol_biped_crowds_setting_up_behaviors_use_priorities.png"></p>
</div>
</li></ol>









<!--OList--><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c1c"></a></span>
<p class="list-intro"><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c1b"></a></span>Solve
the simulation:</p>
<ol type="1" start="1"><li>In
the Modify panel &gt; Solve rollout, turn on Update Display if it's
turned off.<div><span style="display:none"><a name="WS1a9193826455f5ff662ffb11407b58d52-7148"></a></span><div class="note-note"><span class="label">Note</span>If
you are concerned about system performance, you can turn off Update
Display for faster solution calculation.</div></div>
</li><li>Set
Frequency to 20.</li><li>Click
Solve to start the solution.<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c1a"></a></span>This time, because Use Priorities is on, the
solution proceeds one biped at a time. First, the Brown father heads
toward the center, and then his child and wife join in, one at a
time. During each subsequent sub-solution, you can see the previously
solved delegates moving without their bipeds. Next, the Black father
takes his turn, followed by the mother and child.</p>
<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c19"></a></span>At certain points during the solution calculation,
you will see the time slider jump back to an earlier frame. This
occurs when the system uses <em class="mild">backtracking</em> to
avoid collisions. </p>
<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c18"></a></span>When the crowd system can't find a way to avoid
a collision, and returns to the previous motion clip to try a different
path through the motion flow network. If the crowd system can't
avoid a collision by jumping back one clip, it jumps back again
to look for a better path, and so on. You can see the time slider
jump back during backtracking even when the Update Display option
is turned off.</p>
<span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c17"></a></span><div class="figure-anchor">
<p><img src="./images/MED/3dsMaxTut/English/ill/ill_biped_crowds_setting_up_behaviors_final.png"></p>
</div>
<div style="margin-top:9pt"><span style="display:none"><a name="WS1a9193826455f5ff662ffb11407b58d52-7147"></a></span><div class="note-tip"><span class="label">Tip</span>In
a crowd simulation with more bipeds, you can also help prevent collisions
by setting different start frames for each delegate. For example,
delegates closer to the center of the scene can start moving before
delegates farther away. You can set start frames individually for
delegates by selecting a delegate and changing the Start Frame value
on the Modify panel, or you can set them all at once by selecting
the Crowd helper and clicking Modify panel &gt; Priority rollout
&gt; Set Start Frames.</div></div>
</li><li>Save
your work as <em class="strong">my_tut_biped_crowds04.max</em>
</li></ol>




<div class="section"><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c16"></a></span>
<p class="section_title_h1"><a name="TOC_ENTRY__d0e44703"></a>Next</p>
<p><span style="display:none"><a name="WS1a9193826455f5ff13cfd6e1136132a36f-7c15"></a></span>
<span class="hypertext">
<span class="char_link"><a href="WSf742dab041063133fb5604511363e4556c-7fe8.htm"><!--Reference = WSf742dab041063133fb5604511363e4556c-7fe8; Target topic = WSf742dab041063133fb5604511363e4556c-7fe8.htm-->Creating Multiple BIP Files</a></span>
</span>
</p>
</div>

<!----><div class="footer-block"><a href="javascript:doComments('./html/ac.cmtdialog.htm');"><span class="comments-link">Please send us your comment about this page</span></a></div><br></body><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
