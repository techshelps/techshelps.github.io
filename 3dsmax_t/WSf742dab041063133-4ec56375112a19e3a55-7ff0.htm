<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">
   <title>Photons and Final Gather</title><link rel="stylesheet" type="text/css" href="./style/cpm.css"><link rel="stylesheet" type="text/css" href="./style/isd.css"><link rel="stylesheet" type="text/css" href="./style/commons.css"><link rel="stylesheet" type="text/css" href="./style/contents.css"><link rel="stylesheet" type="text/css" href="./style/header.css"><link rel="stylesheet" type="text/css" href="./style/indexes.css"><link rel="stylesheet" type="text/css" href="./style/search.css"><link rel="stylesheet" type="text/css" href="./style/med.css"><script type="text/javascript" src="./scripts/ac.strings.js"></script><script type="text/javascript" src="./ac_common.js"></script><script type="text/javascript" src="./scripts/acmap.js"></script><script type="text/javascript" src="./scripts/ac.acad_ak.js"></script><script type="text/javascript" src="./scripts/index-processing.js"></script><script type="text/javascript" src="./scripts/search-processing.js"></script><script type="text/javascript" src="./scripts/toc-processing.js"></script><script type="text/javascript" src="./scripts/highlight.js"></script><script type="text/javascript" src="./scripts/favorites.js"></script><script type="text/javascript" src="./scripts/commons-processing.js"></script><script language="javascript">
            function hideInfo() {
                info = document.getElementById('infoline');
                info.innerHTML = ' ';
                info.style.visibility = 'hidden';
            }
            function showInfo(title) {
                info = document.getElementById('infoline');
                info.innerHTML = title;
                info.style.visibility='visible';
            }
        </script><meta name="description" content="Photons and Final Gather"><meta name="keywords" content=""><meta name="topic-type" content="concept"></head><body><!--
							Name = Topic;
							Class =  CPM-Topic ISD-Topic ;
							Url = WSf742dab041063133-4ec56375112a19e3a55-7ff0.htm--><div class="head"><div class="head-block"><div class="nav-group"><!--browse buttons--><div class="browse"><nobr><!--No Additional browse buttons are defined--><div id="prevTitle" style="display:none">Photons</div><a href="WSf742dab041063133-4ec56375112a19e3a55-7ff1.htm" class="headNavLink" onmouseover="showInfo(document.getElementById('prevTitle').innerHTML);" onmouseout="hideInfo();"><img src="./images/nav-prev-xp.gif" border="0"></a><div id="parentTitle" style="display:none">Rendering with mental ray: Final Gather and Global Illumination</div><a href="WS73099cc142f4875514c01ac112a7acef16-7f05.htm" class="headNavLink" onmouseover="showInfo(document.getElementById('parentTitle').innerHTML);" onmouseout="hideInfo();"><img src="./images/nav-up-xp.gif" border="0"></a><div id="nextTitle" style="display:none">Rendering with mental ray: Sky Portal and Exposure Control</div><a href="WS1a9193826455f5ff662ffb11407b58d52-291c.htm" class="headNavLink" onmouseover="showInfo(document.getElementById('nextTitle').innerHTML);" onmouseout="hideInfo();"><img src="./images/nav-next-xp.gif" border="0"></a></nobr></div><!--end browse buttons--></div><div class="button-info"><span id="infoline">&nbsp;</span></div><div class="ancestry"><a href="welcome.htm">Autodesk 3ds Max Tutorials</a>&nbsp;&gt;&nbsp;<a href="WS73099cc142f4875514c01ac112a7acef16-8000.htm">Lighting and Rendering</a>&nbsp;&gt;&nbsp;<a href="WS73099cc142f4875514c01ac112a7acef16-7f05.htm">Rendering with mental ray: Final Gather and Global
Illumination</a>&nbsp;&gt;&nbsp;</div><div class="head-text"><span>Photons and Final Gather</span></div></div></div><div class="head-margin">&nbsp;</div><div style="line-height: 0pt">&nbsp;</div><div class="head-margin">&nbsp;</div><span style="display:none"><a name="WSf742dab041063133-4ec56375112a19e3a55-7ff0"></a></span>

<!--Body-->
<p><span style="display:none"><a name="WS1a9193826455f5ffba679e112c9ef5a71-1f3a"></a></span>You can combine final gather with photons. Photons
correctly distribute energy into the scene, using several bounces.
Final gather does lookups into this solution to get an image that
has both details and correct bouncing of light within the scene.</p>
<p><span style="display:none"><a name="WS1a9193826455f5ffba679e112c9ef5a71-1f39"></a></span>When combining photons and FG, the good news
is that you don't need a detailed photon solution: Final gather
generates the local details. It is thus possible to use a low number
of photons. You don't have to use 5 million photons and then combine
them with 2,000 FG samples. You can use as few as 5,000-50,000 photons
for the overall lighting, and then add FG rays for the details.</p>
<div class="section"><span style="display:none"><a name="WS73099cc142f4875514c01ac112a7acef16-7e8b"></a></span>
<p class="section_title_h1"><a name="TOC_ENTRY__d0e74277"></a>Performance Considerations</p>
<p><span style="display:none"><a name="WS1a9193826455f5ffba679e112c9ef5a71-1f38"></a></span>Combining FG and photons can give a performance
improvement of around five times when it replaces final gather multibounce.
Five bounces in FG take roughly five times as long as one bounce
(assuming a room with white walls). Shooting photons instead can
be done in a few seconds. Whether or not to use photons, then, depends
on:</p>
<!--UList--><span style="display:none"><a name="WS73099cc142f4875514c01ac112a7acef16-7e8a"></a></span>
<ul><li>Are
multiple bounces required? Exterior rendering, for example, doesn't
need that. Also, bright rooms with a lot of glass work fine with
a single bounce.</li><li>Do
photons work easily with the scene or do they create photon leaks?</li></ul>


</div>
<div class="section"><span style="display:none"><a name="WS73099cc142f4875514c01ac112a7acef16-7e89"></a></span>
<p class="section_title_h1"><a name="TOC_ENTRY__d0e74295"></a>Becoming an Expert</p>
<p><span style="display:none"><a name="WS1a9193826455f5ffba679e112c9ef5a71-1f37"></a></span>Before combining FG and photons, it's best that
you gain experience handling photons. In particular, you need to
know how to get a smooth photon solution. To become an expert on
FG and photons, study these points:</p>
<!--UList--><span style="display:none"><a name="WS73099cc142f4875514c01ac112a7acef16-7e88"></a></span>
<ul><li>Final
gather &#8220;sees&#8221; the photon solution.</li><li>First
render with FG off, and make sure the photon solution is smooth.
It doesn't have to be as smooth as a solution that only uses photons,
but be aware that bright spots, or big jumps in intensity across
an edge, are &#8220;seen&#8221; by final gather. When final gather sees an unsmooth
solution, it creates splotches. Increasing final gather quality <em class="mild">cannot</em> solve
this. Shooting 10,000 rays at a bright spot will still see a bright
spot.</li><li>Always
do the photon test first, and then add FG. Do not ignore this: It
is valuable information that can save you days of experimenting.</li></ul>



<p><span style="display:none"><a name="WS1a9193826455f5ffba679e112c9ef5a71-1f36"></a></span>If you don't follow this advice, combining photons
and FG can, in particular, create artifacts along edges.</p>
<p><span style="display:none"><a name="WS1a9193826455f5ffba679e112c9ef5a71-1f35"></a></span>The following image is from a different scene,
not included in the tutorial, to illustrate the effect. You can
see artifacts along the edge where the left wall intersects the
floor. The scene uses final gather combined with photons.</p>
<span style="display:none"><a name="WS73099cc142f4875514c01ac112a7acef16-7e87"></a></span><div class="figure-anchor">
<p><img src="./images/MED/3dsMaxTut/English/il/il_fg_artefacts_along_edges.png"></p>
<p class="figure-title">Artifacts along edges</p>
</div>
<p><span style="display:none"><a name="WS1a9193826455f5ffba679e112c9ef5a71-1f34"></a></span> The next image shows the photon solution that's
responsible for the artifacts.</p>
<span style="display:none"><a name="WS73099cc142f4875514c01ac112a7acef16-7e86"></a></span><div class="figure-anchor">
<p><img src="./images/MED/3dsMaxTut/English/il/il_fg_along_edges.png"></p>
<p class="figure-title">Unsmooth photon solution</p>
</div>
<p><span style="display:none"><a name="WS1a9193826455f5ffba679e112c9ef5a71-1f33"></a></span>For two of the artifacts we choose a point (red
and green) and show what final gather &#8220;sees&#8221;: a lot of bright photons
in one case, and a lot of dark wall in the other. This is the cause
of the artifacts.</p>
<p><span style="display:none"><a name="WS1a9193826455f5ffba679e112c9ef5a71-1f32"></a></span>Always check the photon solution first to insure
that photon intensity is reasonable smooth along edges. If it isn't
smooth enough, final gather will see it and maintain the jump no
matter how high you set final gather quality. If you stick to this
formula, you can easily resolve this.</p>
</div>
<div class="section"><span style="display:none"><a name="WS73099cc142f4875514c01ac112a7acef16-7e85"></a></span>
<p class="section_title_h1"><a name="TOC_ENTRY__d0e74350"></a>Photons, Ambient Occlusion and Beyond</p>
<p><span style="display:none"><a name="WS1a9193826455f5ffba679e112c9ef5a71-1f31"></a></span>This possibility is mentioned for completeness.
In most cases combining final gather and ambient occlusion (AO)
gives better results. You can always use ambient occlusion to add
contact shadows to an overly smooth global illumination image: First
create a smooth photon-based image, using a few photons and a large
Maximum Sampling Radius setting. Then use the mental ray <a href="ms-its:3dsmax.chm::/WSf742dab0410631334fd1fb1c112a1ce99ff-7f74.htm">Arch &amp; Design material</a>,
and activate ambient occlusion in it. Details on how to add AO are
described in the <span class="hypertext">
<span class="char_link"><a href="WSf742dab041063133-4ec56375112a19e3a55-7ff3.htm"><!--Reference = WSf742dab041063133-4ec56375112a19e3a55-7ff3; Target topic = WSf742dab041063133-4ec56375112a19e3a55-7ff3.htm-->final
gather lesson</a></span>

</span>.</p>
<p><span style="display:none"><a name="WS1a9193826455f5ffba679e112c9ef5a71-1f30"></a></span>You can also achieve attractive results quickly
by combining all three methods:</p>
<!--UList--><span style="display:none"><a name="WS73099cc142f4875514c01ac112a7acef16-7e84"></a></span>
<ul><li>Photons,
for fast overall transport of light energy</li><li>FG,
to smooth the photon solution into medium-size details</li><li>AO,
to bring out small details from the medium-sized detail</li></ul>



<p><span style="display:none"><a name="WS1a9193826455f5ffba679e112c9ef5a71-1f2f"></a></span>In other words: Let photons handle things at
the meter scale, FG handle things at the 0.1-meter scale, and let
AO bring out detail at the centimeter/millimeter scale. This can
create fast, smooth, yet detailed renderings.</p>
<p><span style="display:none"><a name="WS1a9193826455f5ffba679e112c9ef5a71-1f2e"></a></span>The approach is the same as that described earlier
in this lesson, for photons+FG, except you intentionally use a lower-density
and smoother FG solution, which renders faster, with AO added on top.</p>
</div>

<!----><div class="footer-block"><a href="javascript:doComments('./html/ac.cmtdialog.htm');"><span class="comments-link">Please send us your comment about this page</span></a></div><br></body><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script></html>
