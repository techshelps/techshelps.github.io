<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CreateRecordset Method Example (VBScript)</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>RDS 2.5 API Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="mdmthcreaterecordsetx"></A>CreateRecordset Method Example (VBScript)</H1>

<P>This code example creates a <A HREF="mdobjodbrec.htm">Recordset</A> on the server side. It has two columns with four rows each. Cut and paste the following code to Notepad or another text editor and save it as <B>CreateRecordsetVBS.asp</B>.</P>

<P class="normal"><CODE>&lt;!-- BeginCreateRecordsetVBS --&gt;</CODE></P>

<P class="normal"><CODE>&lt;%@ Language=VBScript %&gt;</CODE></P>

<P class="normal"><CODE>&lt;html&gt;</CODE></P>

<P class="normal"><CODE>&lt;head&gt;</CODE></P>

<P class="normal"><CODE>&lt;meta name="VI60_DefaultClientScript"  content=VBScript&gt;</CODE></P>

<P class="normal"><CODE>&lt;meta name="GENERATOR" content="Microsoft Visual Studio 6.0"&gt;</CODE></P>

<P class="normal"><CODE>&lt;title&gt;CreateRecordset Method Example (VBScript)&lt;/title&gt;</CODE></P>

<P class="normal"><CODE>&lt;style&gt;</CODE></P>

<P class="normal"><CODE>&lt;!--</CODE></P>

<P class="normal"><CODE>body {</CODE></P>

<P class="normal"><CODE>font-family: 'Verdana','Arial','Helvetica',sans-serif;</CODE></P>

<P class="normal"><CODE>BACKGROUND-COLOR:white;</CODE></P>

<P class="normal"><CODE>COLOR:black;</CODE></P>

<P class="normal"><CODE>}</CODE></P>

<P class="normal"><CODE>.thead {</CODE></P>

<P class="normal"><CODE>background-color: #008080; </CODE></P>

<P class="normal"><CODE>font-family: 'Verdana','Arial','Helvetica',sans-serif; </CODE></P>

<P class="normal"><CODE>font-size: x-small;</CODE></P>

<P class="normal"><CODE>color: white;</CODE></P>

<P class="normal"><CODE>}</CODE></P>

<P class="normal"><CODE>.thead2 {</CODE></P>

<P class="normal"><CODE>background-color: #800000; </CODE></P>

<P class="normal"><CODE>font-family: 'Verdana','Arial','Helvetica',sans-serif; </CODE></P>

<P class="normal"><CODE>font-size: x-small;</CODE></P>

<P class="normal"><CODE>color: white;</CODE></P>

<P class="normal"><CODE>}</CODE></P>

<P class="normal"><CODE>.tbody { </CODE></P>

<P class="normal"><CODE>text-align: center;</CODE></P>

<P class="normal"><CODE>background-color: #f7efde;</CODE></P>

<P class="normal"><CODE>font-family: 'Verdana','Arial','Helvetica',sans-serif; </CODE></P>

<P class="normal"><CODE>font-size: x-small;</CODE></P>

<P class="normal"><CODE>}</CODE></P>

<P class="normal"><CODE>--&gt;</CODE></P>

<P class="normal"><CODE>&lt;/style&gt;</CODE></P>

<P class="normal"><CODE>&lt;/head&gt;</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>&lt;body&gt;</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>&lt;OBJECT classid=clsid:BD96C556-65A3-11D0-983A-00C04FC29E33 height=1 id=DC1 width=1&gt;</CODE></P>

<P class="normal"><CODE>&lt;/OBJECT&gt;</CODE></P>

<P class="normal"><CODE>&lt;h1&gt;CreateRecordset Method Example (VBScript)&lt;/h1&gt;</CODE></P>

<P class="normal"><CODE>&lt;script language = "vbscript"&gt;</CODE></P>

<P class="normal"><CODE>' use the RDS.DataControl to create an empty recordset; </CODE></P>

<P class="normal"><CODE>' takes an array of variants where every element is itself another</CODE></P>

<P class="normal"><CODE>' array of variants, one for every column required in the recordset</CODE></P>

<P class="normal"><CODE></CODE></P>

<P class="normal"><CODE>' the elements of the inner array are the column's</CODE></P>

<P class="normal"><CODE>' name, type, size, and nullability</CODE></P>

<P class="normal"><CODE>Sub GetRS()</CODE></P>

<P class="normal"><CODE>Dim Record(2)</CODE></P>

<P class="normal"><CODE>Dim Field1(3)</CODE></P>

<P class="normal"><CODE>Dim Field2(3)</CODE></P>

<P class="normal"><CODE>Dim Field3(3)</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>' for each field, specify the name type, size, and nullability</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>Field1(0) = "Name"   ' Column name.</CODE></P>

<P class="normal"><CODE>Field1(1) = CInt(129)   ' Column type.</CODE></P>

<P class="normal"><CODE>Field1(2) = CInt(40)   ' Column size.</CODE></P>

<P class="normal"><CODE>Field1(3) = False      ' Nullable?</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>Field2(0) = "Age"</CODE></P>

<P class="normal"><CODE>Field2 (1) = CInt(3)</CODE></P>

<P class="normal"><CODE>Field2 (2) = CInt(-1)</CODE></P>

<P class="normal"><CODE>Field2 (3) = True</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>Field3 (0) = "DateOfBirth"</CODE></P>

<P class="normal"><CODE>Field3 (1) = CInt(7)</CODE></P>

<P class="normal"><CODE>Field3 (2) = CInt(-1)</CODE></P>

<P class="normal"><CODE>Field3 (3) = True</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>' put all fields into an array of arrays</CODE></P>

<P class="normal"><CODE>Record(0) = Field1</CODE></P>

<P class="normal"><CODE>Record(1) = Field2</CODE></P>

<P class="normal"><CODE>Record(2) = Field3</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>Dim NewRs </CODE></P>

<P class="normal"><CODE>Set NewRS = DC1.CreateRecordset(Record)</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>Dim fields(2)</CODE></P>

<P class="normal"><CODE>fields(0) = Field1(0)</CODE></P>

<P class="normal"><CODE>fields(1) = Field2(0)</CODE></P>

<P class="normal"><CODE>fields(2) = Field3(0)</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>' Populate the new recordset with data values.</CODE></P>

<P class="normal"><CODE>Dim fieldVals(2)</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>' Use AddNew to add the records.</CODE></P>

<P class="normal"><CODE>fieldVals(0) = "Joe"</CODE></P>

<P class="normal"><CODE>fieldVals(1) = 5</CODE></P>

<P class="normal"><CODE>fieldVals(2) = CDate(#1/5/96#)</CODE></P>

<P class="normal"><CODE>NewRS.AddNew fields, fieldVals</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>fieldVals(0) = "Mary"</CODE></P>

<P class="normal"><CODE>fieldVals(1) = 6</CODE></P>

<P class="normal"><CODE>fieldVals(2) = CDate(#6/5/94#)</CODE></P>

<P class="normal"><CODE>NewRS.AddNew fields, fieldVals</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>fieldVals(0) = "Alex"</CODE></P>

<P class="normal"><CODE>fieldVals(1) = 13</CODE></P>

<P class="normal"><CODE>fieldVals(2) = CDate(#1/6/88#)</CODE></P>

<P class="normal"><CODE>NewRS.AddNew fields, fieldVals</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>fieldVals(0) = "Susan"</CODE></P>

<P class="normal"><CODE>fieldVals(1) = 13</CODE></P>

<P class="normal"><CODE>fieldVals(2) = CDate(#8/6/87#)</CODE></P>

<P class="normal"><CODE>NewRS.AddNew fields, fieldVals</CODE></P>

<P class="normal"><CODE></CODE></P>

<P class="normal"><CODE>NewRS.MoveFirst</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>' Set the newly created and populated Recordset to</CODE></P>

<P class="normal"><CODE>' the SourceRecordset property of the</CODE></P>

<P class="normal"><CODE>' RDS.DataControl to bind to visual controls</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>Set DC1.SourceRecordset = NewRS</CODE></P>

<P class="normal"><CODE>End Sub</CODE></P>

<P class="normal"><CODE>&lt;/script&gt;</CODE></P>

<P class="normal"><CODE>&lt;table datasrc="#DC1" align="center"&gt;</CODE></P>

<P class="normal"><CODE>&lt;thead&gt;</CODE></P>

<P class="normal"><CODE>&lt;tr id="ColHeaders" class="thead2"&gt;</CODE></P>

<P class="normal"><CODE>&lt;th&gt;Name&lt;/th&gt;</CODE></P>

<P class="normal"><CODE>&lt;th&gt;Age&lt;/th&gt;</CODE></P>

<P class="normal"><CODE>&lt;th&gt;D.O.B.&lt;/th&gt;</CODE></P>

<P class="normal"><CODE>&lt;/tr&gt;</CODE></P>

<P class="normal"><CODE>&lt;/thead&gt;</CODE></P>

<P class="normal"><CODE>&lt;tbody class="tbody"&gt;</CODE></P>

<P class="normal"><CODE>&lt;tr&gt;</CODE></P>

<P class="normal"><CODE>&lt;td&gt;&lt;input datafld="Name" size=15 id=text1 name=text1&gt; &lt;/td&gt;</CODE></P>

<P class="normal"><CODE>&lt;td&gt;&lt;input datafld="Age" size=25 id=text2 name=text2&gt; &lt;/td&gt;</CODE></P>

<P class="normal"><CODE>&lt;td&gt;&lt;input datafld="DateOfBirth" size=25 id=text3 name=text3&gt; &lt;/td&gt;</CODE></P>

<P class="normal"><CODE>&lt;/tr&gt;</CODE></P>

<P class="normal"><CODE>&lt;/tbody&gt;</CODE></P>

<P class="normal"><CODE>&lt;/table&gt;</CODE></P>

<P class="normal"><CODE>&lt;input type = "button" onclick = "GetRS()" value="Go!"&gt;</CODE></P>

<P class="normal"><CODE>&lt;/body&gt;</CODE></P>

<P class="normal"><CODE>&lt;/html&gt;</CODE></P>

<P class="normal"><CODE>&lt;!-- EndCreateRecordsetVBS --&gt;</CODE></P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="mdmthcreaterec.htm">CreateRecordset Method (RDS)</A> | <A HREF="mdobjodbrec.htm">Recordset Object</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
</HTML>
