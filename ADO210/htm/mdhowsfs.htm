<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Marking Business Objects as Safe for Scripting</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>RDS 2.5</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="mdhowsfs"></A>Marking Business Objects as Safe for Scripting</H1>

<P>To help ensure a secure Internet environment, you need to mark any <A HREF="mddefglossary.htm#mddefbusinessobject">business objects</A> instantiated with the <A HREF="mdobjdataspace.htm">RDS.DataSpace</A> object's <A HREF="mdmthcreateobj.htm">CreateObject</A> method as "safe for scripting." You need to ensure they are marked as such in the License area of the system registry before they can be used in <A HREF="mddefglossary.htm#mddefdcom">DCOM</A>.</P>

<P>To manually mark your business object as safe for scripting, create a text file with a .reg extension that contains the following text. The following two numbers enable the safe-for-scripting feature:</P>

<PRE class="code">[HKEY_CLASSES_ROOT\CLSID\&lt;<I>MyActiveXGUID</I>&gt;\Implemented 
Categories\{7DD95801-9882-11CF-9FA9-00AA006C42C4}]
[HKEY_CLASSES_ROOT\CLSID\&lt;<I>MyActiveXGUID</I>&gt;\Implemented 
Categories\{7DD95802-9882-11CF-9FA9-00AA006C42C4}]</PRE>

<P>where &lt;<I>MyActiveXGUID</I>&gt; is the hexadecimal GUID number of your business object. Save it and merge it into your registry by using the Registry Editor or double-clicking the .reg file in Windows Explorer.</P>

<P>Business objects created in Microsoft®<SUP> </SUP>Visual Basic can be automatically marked as "safe for scripting" with the Package and Deployment Wizard. When the wizard asks you to specify safety settings, select <B>Safe for initialization</B> and <B>Safe for scripting</B>.</P>

<P>On the last step, the Application Setup Wizard creates an .htm and a .cab file. You can then copy these two files to the target computer and double-click the .htm file to load the page and correctly register the server.</P>

<P>Because the business object will be installed in the Windows\System32\Occache directory by default, move it to the Windows\System32 directory and change the <B>HKEY_CLASSES_ROOT\CLSID\</B>&lt;<I>MyActiveXGUID</I>&gt;\<B>InprocServer32</B> registry key to match the correct path.</P>

<BLOCKQUOTE class="dtBlock">
<B>Note</B> Business objects marked as safe for scripting or safe for initialization can be instantiated and initialized by anyone over the network. Any custom business object must not be designed and implemented casually. It is imperative that such objects do not present a security threat that hackers can explore to gain access to the sensitive area of the hosting server and inflict damages. </BLOCKQUOTE>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
</HTML>
