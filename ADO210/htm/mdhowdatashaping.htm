<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Data Shaping</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>ADO 2.5</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="mdhowdatashaping"></A>Data Shaping</H1>

<P>Data shaping enables you to define the columns of a shaped <B>Recordset</B>, the relationships between the entities represented by the columns, and the manner in which the <B>Recordset</B> is populated with data.</P>

<P>Columns of a shaped <B>Recordset</B> may contain data from a data provider such as Microsoft SQL Server, references to another <B>Recordset</B>, values derived from a calculation on a single row of a <B>Recordset</B>, values derived from an operation over a column of an entire <B>Recordset</B>; or they may be a newly fabricated, empty column.</P>

<P>When you retrieve the value of a column that contains a reference to another <B>Recordset</B>, ADO automatically returns the actual <B>Recordset</B> represented by the reference. A <B>Recordset</B> that contains another <B>Recordset</B> is called a hierarchical recordset. Hierarchical recordsets exhibit a <I>parent-child</I> relationship, in which the <I>parent</I> is the containing recordset and the <I>child</I> is the contained recordset. The reference to a <B>Recordset</B> is actually a reference to a subset of the child, called a <I>chapter</I>. A single parent may reference more than one child <B>Recordset</B>.</P>

<P>The shape command syntax enables you to programmatically create a shaped <B>Recordset</B>. You can then access the components of the <B>Recordset</B> programmatically or through an appropriate visual control. A shape command is issued like any other ADO command text.</P>

<P>You can make hierarchical <B>Recordset</B> objects in two ways with the shape command syntax. The first appends a child <B>Recordset</B> to a parent <B>Recordset</B>. The parent and child typically have at least one column in common: the value of the column in a row of the parent is the same as the value of the column in all rows of the child.</P>

<P>The second way generates a parent <B>Recordset</B> from a child <B>Recordset</B>. The records in the child <B>Recordset</B> are grouped, typically using the BY clause, and one row is added to the parent <B>Recordset</B> for each resulting group in the child. If the BY clause is omitted, the child <B>Recordset</B> will form a single group and the parent <B>Recordset</B> will contain exactly one row. This is useful for computing "grand total" aggregates over the entire child <B>Recordset</B>.</P>

<P>Regardless of which way the parent <B>Recordset</B> is formed, it will contain a chapter column that is used to relate it to a child <B>Recordset</B>. If you wish, the parent <B>Recordset</B> may also have columns that contain aggregates (SUM, MIN, MAX, and so on) over the child rows. Both the parent and the child <B>Recordset</B> may have columns which contain an expression on the row in the <B>Recordset</B>, as well as columns which are new and initially empty.</P>

<P>You can nest hierarchical <B>Recordset</B> objects to any depth (that is, create child <B>Recordset</B> objects of child <B>Recordset</B> objects, and so on).</P>

<P>You can access the <B>Recordset</B> components of the shaped <B>Recordset</B> programmatically or through an appropriate visual control.</P>

<P>Microsoft provides a visual tool that generates shape commands (see <A HREF="http://msdn.microsoft.com/library/devprods/vs6/vbasic/vb98/vbrgndedesigner.htm">The Data Environment Designer</A> in the Visual Basic documentation) and another that displays hierarchical cursors (see <A HREF="http://msdn.microsoft.com/library/devprods/vs6/vbasic/vbcon98/vbconhflexgridcontrol.htm">Using the Microsoft Hierarchical Flexgrid Control</A> in the Visual Basic documentation).</P>

<P>For examples of shape commands and their resulting hierarchies, see Using the Data Shaping Service for OLE DB: A Closer Look.</P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
