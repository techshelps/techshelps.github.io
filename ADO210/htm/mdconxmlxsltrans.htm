<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>XSLT Transformations</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>ADO 2.5</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H2 class="dtH2"><A NAME="mdconxmlxsltrans"></A>XSLT Transformations</H2>

<P>XSLT can be applied to the generated XML to transform it into another format. Understanding the XML format in ADO helps in developing XSLT templates that can transform it into a more user-friendly form.</P>

<P>For example, you know that each row of the <B>Recordset</B> is saved as the z:row element inside the rs:data element. Similarly, each field of the <B>Recordset</B> is saved as an attribute-value pair for this element.</P>

<P>The following XSLT script can be applied to the XML shown in the previous section to transform it into an HTML table to be displayed in the browser:</P>

<PRE class="code">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;html xmlns:xsl="http://www.w3.org/TR/WD-xsl"&gt;
&lt;body STYLE="font-family:Arial, helvetica, sans-serif; font-size:12pt; background-color:white"&gt;
&lt;table border="1" style="table-layout:fixed" width="600"&gt;
&nbsp;&nbsp;&lt;col width="200"&gt;&lt;/col&gt;
&nbsp;&nbsp;&lt;tr bgcolor="teal"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;&lt;font color="white"&gt;CustomerId&lt;/font&gt;&lt;/th&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;&lt;font color="white"&gt;CompanyName&lt;/font&gt;&lt;/th&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;&lt;font color="white"&gt;ContactName&lt;/font&gt;&lt;/th&gt;
&nbsp;&nbsp;&lt;/tr&gt;
&lt;xsl:for-each select="xml/rs:data/z:row"&gt;
&nbsp;&nbsp;&lt;tr bgcolor="navy"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;font color="white"&gt;&lt;xsl:value-of select="@CustomerID"/&gt;&lt;/font&gt;&lt;/td&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;font color="white"&gt;&lt;xsl:value-of select="@CompanyName"/&gt;&lt;/font&gt;&lt;/td&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;font color="white"&gt;&lt;xsl:value-of select="@ContactName"/&gt;&lt;/font&gt;&lt;/td&gt; 
&nbsp;&nbsp;&lt;/tr&gt;
&lt;/xsl:for-each&gt;
&lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;</PRE>

<P>The XSLT converts the XML stream generated by the ADO <B>Save</B> method into an HTML table which displays each field of the <B>Recordset</B> along with a table heading. Table headings and rows also are assigned different fonts and colors.</P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
</HTML>
