<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Creating the Connection String</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>ADO 2.5</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="mdconfillinconnstring"></A>Creating the Connection String</H1>

<P>ADO directly supports five arguments in a connection string. Other arguments are passed to the provider that is named in the <I>Provider</I> argument without any processing by ADO.</P>
<div class="tablediv"><table cellspacing="0" class="dtTABLE">

<TR VALIGN="top">
<TH width=50%>Argument</TH>
<TH width=50%>Description</TH>
</TR>

<TR VALIGN="top">
<TD width=50%><I>Provider</I></TD>
<TD width=50%>Specifies the name of a provider to use for the connection.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><I>File Name</I></TD>
<TD width=50%>Specifies the name of a provider-specific file (for example, a persisted data source object) containing preset connection information.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><I>URL</I></TD>
<TD width=50%>Specifies the connection string as an absolute URL identifying a resource, such as a file or directory.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><I>Remote Provider</I></TD>
<TD width=50%>Specifies the name of a provider to use when opening a client-side connection. (Remote Data Service only.)</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><I>Remote Server</I></TD>
<TD width=50%>Specifies the path name of the server to use when opening a client-side connection. (Remote Data Service only.)</TD>
</TR>
</table></div>

<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>&nbsp;&nbsp;&nbsp;In the following examples and throughout the ADO Programmer's Guide, the user id "MyId" with a password of "123aBc" is used to authenticate against the server. You should substitute these values with valid login credentials for your server. Also, substitute the name of your server for "MySqlServer".</BLOCKQUOTE>

<P>The HelloData application in Chapter 1 used the following connection string:</P>

<PRE class="code">m_sConnStr = "Provider='SQLOLEDB';Data Source='MySqlServer';" &amp; _
             "Initial Catalog='Northwind';Integrated Security='SSPI';"</PRE>

<P>The only ADO parameter supplied in this connection string was "Provider=SQLOLEDB", which indicated the Microsoft OLE DB Provider for SQL Server. Other valid parameters that can be passed in the connection string can be determined by referring to individual providers' documentation. According to the OLE DB Provider for SQL Server documentation, you can substitute "Server" for the <I>Data Source</I> parameter and "Database" for the <I>Initial Catalog</I> parameter. Thus, the following connection string would produce results identical to the first:</P>

<PRE class="code">m_sConnStr = "Provider='SQLOLEDB';<code><b class="cfe">Server</b></code>='MySqlServer';" &amp; _
             "<code><b class="cfe">Database</b></code>='Northwind';Integrated Security='SSPI';"</PRE>

<P>To open the connection, simply pass the connection string as the first argument in the <B>Connection</B> object <B>Open</B> method:</P>

<PRE class="code">objConn.Open m_sConnStr</PRE>

<P>It is also possible to supply much of this information by setting properties of the <B>Connection</B> object before opening the connection. For example, you could achieve the same effect as the connection string above by using the following code:</P>

<PRE class="code">With objConn
   .Provider = "SQLOLEDB"
   .DefaultDatabase = "Northwind"
   .Properties("Data Source") = "MySqlServer"
   .Properties("Integrated Security") = "SSPI"
   .Open
End With</PRE>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
</HTML>
