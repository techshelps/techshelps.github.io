<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Dealing with Failed Updates</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>ADO 2.5</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H2 class="dtH2"><A NAME="mdconfailedupdates"></A>Dealing with Failed Updates</H2>

<P>When an update concludes with errors, how you resolve the errors depends on the nature and severity of the errors and the logic of your application. However, if the database is shared with other users, a typical error is that someone else modifies the field before you do. This type of error is called a <I>conflict. </I>ADO detects this situation and reports an error.</P>

<P>If there are update errors, they will be trapped in an error-handling routine. Filter the <B>Recordset</B> with the <B>adFilterConflictingRecords</B> constant so that only the conflicting rows are visible. In this example, the error-resolution strategy is merely to print the author's first and last names (<B>au_fname</B> and <B>au_lname</B>).</P>

<P>The code to alert the user to the update conflict looks like this:</P>

<PRE class="code">objRs.<code><b class="cfe">Filter</b></code>&nbsp;=&nbsp;adFilterConflictingRecords
objRs.MoveFirst
Do&nbsp;While&nbsp;Not&nbsp;objRst.EOF
&nbsp;&nbsp;&nbsp;Debug.Print&nbsp;"Conflict:&nbsp;Name&nbsp;=&nbsp;&nbsp;";&nbsp;objRs!au_fname;&nbsp;"&nbsp;";&nbsp;objRs!au_lname
&nbsp;&nbsp;&nbsp;objRs.MoveNext
Loop</PRE>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
