<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="ltr">
	<HEAD>
		<TITLE>WillExecute Event (ADO)</TITLE>
		<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
		<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
		<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
		<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT>
	</HEAD>
	<body topmargin="0" id="bodyID" class="dtBODY">
		
		<div id="scrbanner">
			<div id="bannerrow1">
				<TABLE CLASS="bannerparthead" CELLSPACING="0">
					<TR ID="hdr">
						<TD CLASS="bannerparthead td" nowrap>ADO 2.5 API Reference</TD>
						<TD valign="center"><a href="#Feedback"><IMG name="feedb" onclick="startFeedback(SDKFeedB)" style="CURSOR: hand" hspace="15" alt="" src="../stylesheets/mailto.gif" align="right"></a></TD>
					</TR>
				</TABLE>
			</div>
		</div>
		<DIV id="scrtext" valign="bottom">
			<H1 class="dtH1"><A NAME="mdevtwillexecuteevent"></A>WillExecute Event</H1>
			<P>The <B>WillExecute</B> event is called just before a pending command executes on 
				a connection.</P>
			<H4 class="dtH4">Syntax</H4>
			<PRE class="syntax"><B>WillExecute</B> <I>Source, CursorType, LockType, Options, adStatus, pCommand, pRecordset, pConnection</I></PRE>
			<H4 class="dtH4">Parameters</H4>
			<DL>
				<DT><I>Source</I>
					<DD>
						A <B>String</B> that contains an SQL command or a stored procedure name. <DT><I>CursorType</I>
							<DD>
								A <A HREF="mdcstcursortypeenum.htm">CursorTypeEnum</A> that contains the type 
								of cursor for the <B>Recordset</B> that will be opened. With this parameter, 
								you can change the cursor to any type during a <B>Recordset</B> <A HREF="mdmthrstopen.htm">
									Open</A> operation. <I>CursorType</I> will be ignored for any other 
								operation. <DT><I>LockType</I>
									<DD>
										A <A HREF="mdcstlocktypeenum.htm">LockTypeEnum</A> that contains the lock type 
										for the <B>Recordset</B> that will be opened. With this parameter, you can 
										change the lock to any type during a <B>Recordset</B> <B>Open</B> operation. <I>LockType</I>
										will be ignored for any other operation. <DT><I>Options</I>
											<DD>
												A <B>Long</B> value that indicates options that can be used to execute the 
												command or open the <B>Recordset</B>. <DT><I>adStatus</I>
													<DD>
														An <A HREF="mdcsteventstatusenum.htm">EventStatusEnum</A> status value that may 
														be <B>adStatusCantDeny</B> or <B>adStatusOK</B> when this event is called. If 
														it is <B>adStatusCantDeny</B>, this event may not request cancellation of the 
														pending operation.
														<P>Before this event returns, set this parameter to <B>adStatusUnwantedEvent</B> to 
															prevent subsequent notifications, or <B>adStatusCancel</B> to request 
															cancellation of the operation that caused this event.</P>
														<DT><I>pCommand</I>
															<DD>
																The <A HREF="mdobjcommand.htm">Command</A> object for which this event 
																notification applies. <DT><I>pRecordset</I>
																	<DD>
																		The <A HREF="mdobjodbrec.htm">Recordset</A> object for which this event 
																		notification applies. <DT><I>pConnection</I>
																			<DD>
																				The <A HREF="mdobjconnection.htm">Connection</A> object for which this event 
																				notification applies.</DD>
			</DL>
			<H4 class="dtH4">Remarks</H4>
			<P>A <B>WillExecute</B> event may occur due to a <B>Connection.</B><A HREF="mdmthcnnexecute.htm">Execute</A>,
				<B>Command.</B><A HREF="mdmthcmdexecute.htm">Execute</A>, or <B>Recordset.</B><A HREF="mdmthrstopen.htm">Open</A>
				method The <I>pConnection</I> parameter should always contain a valid reference 
				to a <B>Connection</B> object. If the event is due to <B>Connection.Execute</B>, 
				the <I>pRecordset</I> and <I>pCommand</I> parameters are set to <B>Nothing</B>. 
				If the event is due to <B>Recordset.Open</B>, the <I>pRecordset </I>parameter 
				will reference the <B>Recordset</B> object and the <I>pCommand</I> parameter is 
				set to <B>Nothing</B>. If the event is due to <B>Command.Execute</B>, the <I>pCommand</I>
				parameter will reference the <B>Command</B> object and the <I>pRecordset</I> parameter 
				is set to <B>Nothing</B>.</P>
			<P><B>WillExecute</B> allows you to examine and modify the pending execution 
				parameters. This event may return a request that the pending command be 
				canceled.</P>
			<H4 class="dtH4">See Also</H4>
			<P><A HREF="mdevteventmodelxvc.htm">Visual C++ Example</A></P>
			<P><A HREF="mdmscadoevents.htm">ADO Event Handler Summary</A></P>
			<P>Applies To: <A HREF="mdobjconnection.htm">Connection Object</A></P>
			<H4><A NAME="feedback"></A></H4>
			<SPAN id="SDKFeedB"></SPAN>
		</DIV>
		<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">© 1998-2002 Microsoft 
				Corporation. All rights reserved.</A></P>
	</body>
</HTML>
