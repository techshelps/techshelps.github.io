<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Required Client Settings</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>RDS 2.5</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="mdmscrequiredclientsettings"></A>Required Client Settings</H1>

<P>Specify the following settings to use a custom <B>DataFactory</B> handler.

<UL type="disc">
	<LI>Specify "Provider=MS Remote" in the <A HREF="mdobjconnection.htm">Connection</A> object <A HREF="mdproprovider.htm">Provider</A> property or the <B>Connection</B> object connection string "<B>Provider=</B>" keyword.</li>

	<LI>Set the <A HREF="mdprocursorlocation.htm">CursorLocation</A> property to <B>adUseClient</B>.</li>

	<LI>Specify the name of the handler to use in the <A HREF="mdobjdatacontrol.htm">RDS.DataControl</A> object's <B>Handler</B> property, or the <A HREF="mdobjodbrec.htm">Recordset</A> object's connection string "<B>Handler=</B>" keyword. (You cannot set the handler in the <B>Connection</B> object connect string.)</li>
</UL>

<BLOCKQUOTE class="dtBlock">
RDS provides a default handler on the server named <B>MSDFMAP.Handler</B>. (The default customization file is named <B>MSDFMAP.INI</B>.)</BLOCKQUOTE>

<P class="label"><B>Example</B></P>

<P>Assume that the following sections in <B>MSDFMAP.INI</B> and the data source name, AdvWorks, have been previously defined:</P>

<PRE class="code">[connect CustomerDataBase]
Access=ReadWrite
Connect="DSN=AdvWorks"

[sql CustomerById]
SQL="SELECT * FROM Customers WHERE CustomerID = ?"</PRE>

<P>The following code snippets are written in Visual Basic:</P>

<H2 class="dtH2">RDS.DataControl Version</H2>

<PRE class="code">Dim dc as New RDS.DataControl
Set dc.<code><b class="cfe">Handler</b></code> = "MSDFMAP.Handler"
Set dc.<code><b class="cfe">Server</b></code> = "http://yourServer"
Set dc.<code><b class="cfe">Connect</b></code> = "Data Source=CustomerDatabase"
Set dc.<code><b class="cfe">SQL</b></code> = "CustomerById(4)"
dc.<code><b class="cfe">Refresh</b></code></PRE>

<H2 class="dtH2">Recordset Version</H2>

<PRE class="code">Dim rs as New ADODB.Recordset
rs.CursorLocation = <code><b class="cfe">adUseClient</b></code></PRE>

<P>Specify either the <A HREF="mdprohandlerpropertyrds.htm">Handler</A> property or keyword; the <B>Provider</B> property or keyword; and the <I>CustomerById</I> and <I>CustomerDatabase</I> identifiers. Then open the <B>Recordset</B> object.</P>

<PRE class="code">rs.Open "<code><b class="cfe">CustomerById(4)</b></code>", "<code><b class="cfe">Handler</b></code>=MSDFMAP.Handler;" &amp; _
   "<code><b class="cfe">Provider</b></code>=MS Remote;Data Source=<code><b class="cfe">CustomerDatabase</b></code>;" &amp; _
   "Remote Server=http://yourServer"</PRE>

<H4 class="dtH4">See Also</H4>

<P><A HREF="mdmsccustomizationfileconnectsection.htm">Customization File Connect Section</A> | <A HREF="mdmsccustomizationfilelogssection.htm">Customization File Logs Section</A> | <A HREF="mdmsccustomizationfilesqlsection.htm">Customization File SQL Section</A> | <A HREF="mdmsccustomizationfileuserlistsection.htm">Customization File UserList Section</A> | <A HREF="mdmscdatafactorycustomization.htm">DataFactory Customization</A> | <A HREF="mdrefmsremote.htm">Microsoft OLE DB Remoting Provider</A> | <A HREF="mdmscunderstandingcustomizationfile.htm">Understanding the Customization File</A> | <A HREF="mdmscwritingyourowncustomizedhandler.htm">Writing Your Own Customized Handler</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
</HTML>
