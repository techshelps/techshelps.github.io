<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>More About Recordset Persistence</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>ADO 2.5</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="mdmscrecordsetpersistence"></A>More About Recordset Persistence</H1>

<P>The ADO Recordset object supports storing a <B>Recordset</B> object's contents in a file using its <A HREF="mdmthrstsave.htm">Save</A> method. The persistently stored file may exist on a local drive, network server, or as a URL on a Web site. Later, the file can be restored with either the <B>Recordset</B> object's <A HREF="mdmthrstopen.htm">Open</A> method or the <A HREF="mdobjconnection.htm">Connection</A> object's <A HREF="mdmthcnnexecute.htm">Execute</A> method.</P>

<P>In addition, the <A HREF="mdmthgetstringmethod(recordset)ado.htm">GetString</A> method converts a <B>Recordset</B> object to a form in which the columns and rows are delimited with characters you specify.</P>

<P>To persist a <B>Recordset</B>, begin by converting it to a form that can be stored in a file. <B>Recordset</B> objects can be stored in the proprietary Advanced Data TableGram (ADTG) format or the open Extensible Markup Language (XML) format. ADTG examples are shown below. For more information about XML persistence, see <A HREF="mdconpersistingrecordsxmlformat.htm">Persisting Records in XML format</A>.</P>

<P>Save any pending changes in the persisted file. Doing this allows you to issue a query that returns a <B>Recordset</B> object, edits the <B>Recordset</B>, saves it and the pending changes, later restores the <B>Recordset</B>, and then updates the data source with the saved pending changes.</P>

<P>For information about persistently storing <B>Stream</B> objects, see <A HREF="mdmscstreamspersistence.htm">Streams and Persistence</A> in Chapter 10.</P>

<P>For an example of <B>Recordset</B> persistence, see the <A HREF="mdhowxmlrspersistscenario.htm">XML Recordset Persistence Scenario</A>.</P>

<H4 class="dtH4">Example</H4>

<P class="label"><B>Save a Recordset:</B></P>

<PRE class="code">Dim rs as New ADODB.Recordset
rs.<code><b class="cfe">Save</b></code> "c:\yourFile.adtg", adPersistADTG</PRE>

<P class="label"><B>Open a persisted file with Recordset.Open:</B></P>

<PRE class="code">Dim rs as New ADODB.Recordset
rs.<code><b class="cfe">Open</b></code> "c:\yourFile.adtg", "Provider='<code><b class="cfe">MSPersist'</b></code>",,,<code><b class="cfe">adCmdFile</b></code></PRE>

<P>Optionally, if the <B>Recordset</B> does not have an active connection, you can accept all the defaults and simply code the following:</P>

<PRE class="code">Dim rs as New ADODB.Recordset
rs.<code><b class="cfe">Open</b></code> "c:\yourFile.adtg"</PRE>

<P class="label"><B>Open a persisted file with Connection.Execute:</B></P>

<PRE class="code">Dim conn as New ADODB.Connection
Dim rs as ADODB.Recordset
conn.Open "Provider='<code><b class="cfe">MSPersist'</b></code>"
Set rs = conn.<code><b class="cfe">execute</b></code>("c:\yourFile.adtg")</PRE>

<P class="label"><B>Open a persisted file with RDS.DataControl:</B></P>

<P>In this case, the <B>Server</B> property is not set.</P>

<PRE class="code">Dim dc as New RDS.DataControl
dc.<code><b class="cfe">Connection</b></code> = "Provider='<code><b class="cfe">MSPersist'</b></code>"
dc.<code><b class="cfe">SQL</b></code> = "c:\yourFile.adtg"
dc.<code><b class="cfe">Refresh</b></code></PRE>

<H4 class="dtH4">See Also</H4>

<P><A HREF="mdmthgetstringmethod(recordset)ado.htm">GetString Method</A> | <A HREF="mdrefmspersist.htm">Microsoft OLE DB Persistence Provider</A> | <A HREF="mdobjodbrec.htm">Recordset Object</A> | <A HREF="mdmscstreamspersistence.htm">Streams and Persistence</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
</HTML>
