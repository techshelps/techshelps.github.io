<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Persisting Records in XML Format</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>ADO 2.5</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="mdconpersistingrecordsxmlformat"></A>Persisting Records in XML Format</H1>

<P>Like ADTG format, <B>Recordset</B> persistence in XML format is implemented with the Microsoft OLE DB Persistence Provider. This provider generates a forward-only, read-only rowset from a saved XML file or stream that contains the schema information generated by ADO. Similarly, it can take an ADO <B>Recordset</B>, generate XML, and save it to a file or any object that implements the COM <B>IStream</B> interface. (In fact, a file is just another example of an object that supports <B>IStream</B>.) For versions 2.5 and later, ADO relies on the Microsoft XML Parser (MSXML) to load the XML into the <B>Recordset</B>; therefore msxml.dll is required. For version 2.5, MSXML shipped with Internet Explorer 5. For version 2.6, MSXML shipped with SQL Server 2000.</P>

<BLOCKQUOTE class="dtBlock">
<b class="le">Note</b>&nbsp;&nbsp;&nbsp;Some limitations apply when saving hierarchical <B>Recordsets</B> (data shapes) to XML format. You cannot save to XML if the hierarchical <B>Recordset</B> contains pending updates, and you cannot save a parameterized hierarchical <B>Recordset</B>. For more information, see <A HREF="mdconhierarchicalrecordsetsxml.htm">Hierarchical Recordsets in XML</A>.</BLOCKQUOTE>

<P>The easiest way to persist data into XML and load it back again through ADO is with the <B>Save</B> and <B>Open</B> methods, respectively. The following ADO code example demonstrates saving the data in the Titles table to a file named titles.sav.</P>

<PRE class="code">Dim rs as new Recordset
Dim rs2 as new Recordset
Dim c as new Connection
Dim s as new Stream

' Query the Titles table.
c.Open "provider='sqloledb';data source='mydb';initial catalog='pubs';Integrated Security='SSPI'"
rs.cursorlocation = adUseClient
rs.Open "select * from titles", c, adOpenStatic

<code class="ce">' Save to the file in the XML format. Note that if you don't specify </code>
<code class="ce">' adPersistXML, a binary format (ADTG) will be used by default.</code>
<code class="ce">rs.Save "titles.sav", adPersistXML</code>

<code class="ce">' Save the Recordset into the ADO Stream object.</code>
<code class="ce">rs.save s, adPersistXML</code>
<code class="ce">rs.Close</code>
<code class="ce">c.Close</code>

<code class="ce">set rs = nothing</code>

<code class="ce">' Reopen the file.</code>
<code class="ce">rs.Open "titles.sav",,,,adCmdFile</code>
<code class="ce">' Open the Stream back into a Recordset.</code>
<code class="ce">rs2.open s</code></PRE>

<P>ADO always persists the entire <B>Recordset</B> object. If you wish to only persist a subset of rows of the <B>Recordset</B> object, use the <B>Filter</B> method to narrow down the rows or change your selection clause. However, you must open a <B>Recordset</B> object with a client-side cursor (<B>CursorLocation</B> = <B>adUseClient</B>) to use the <B>Filter</B> method for saving a subset of rows. For example, to retrieve titles that start with the letter "b," you can apply a filter to an open <B>Recordset</B> object:</P>

<PRE class="code">rs.Filter "title_id like 'B*'"
rs.Save "btitles.sav", adPersistXML</PRE>

<P>ADO always uses the Client Cursor Engine rowset to produce a scrollable, bookmarkable <B>Recordset</B> object on top of the forward-only data generated by the Persistence Provider.</P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
