<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Close Method (ADO)</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>ADO 2.5 API Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="mdmthclose"></A>Close Method</H1>

<P>Closes an open object and any dependent objects.</P>

<H4 class="dtH4">Syntax</H4>

<PRE class="syntax"><I>object</I>.<B>Close</B></PRE>

<H4 class="dtH4">Remarks</H4>

<P>Use the <B>Close</B> method to close a <A HREF="mdobjconnection.htm">Connection</A>, a <A HREF="mdobjrecord.htm">Record</A>, a <A HREF="mdobjodbrec.htm">Recordset</A>, or a <A HREF="mdobjstream.htm">Stream</A> object to free any associated system resources. Closing an object does not remove it from memory; you can change its property settings and open it again later. To completely eliminate an object from memory, set the <A HREF="mddefglossary.htm#mddefobjectvariable">object variable</A> to <I>Nothing</I> (in Visual Basic) after closing the object.</P>

<P class="label"><B>Connection</B></P>

<P>Using the <B>Close</B> method to close a <B>Connection</B> object also closes any active <B>Recordset</B> objects associated with the connection. A <A HREF="mdobjcommand.htm">Command</A> object associated with the <B>Connection</B> object you are closing will persist, but it will no longer be associated with a <B>Connection</B> object; that is, its <A HREF="mdproactivecon.htm">ActiveConnection</A> property will be set to <B>Nothing</B>. Also, the <B>Command</B> object's <A HREF="mdcolparameters.htm">Parameters</A> collection will be cleared of any provider-defined parameters.</P>

<P>You can later call the <A HREF="mdmthcnnopen.htm">Open</A> method to re-establish the connection to the same, or another, data source. While the <B>Connection</B> object is closed, calling any methods that require an open connection to the data source generates an error.</P>

<P>Closing a <B>Connection</B> object while there are open <B>Recordset</B> objects on the connection rolls back any pending changes in all of the <B>Recordset</B> objects. Explicitly closing a <B>Connection</B> object (calling the <B>Close</B> method) while a transaction is in progress generates an error. If a <B>Connection</B> object falls out of scope while a transaction is in progress, ADO automatically rolls back the transaction.</P>

<P class="label"><B>Recordset, Record, Stream</B></P>

<P>Using the <B>Close</B> method to close a <B>Recordset</B>, <B>Record</B>, or <B>Stream</B> object releases the associated data and any exclusive access you may have had to the data through this particular object. You can later call the <A HREF="mdmthrstopen.htm">Open</A> method to reopen the object with the same, or modified, attributes.</P>

<P>While a <B>Recordset</B> object is closed, calling any methods that require a live <A HREF="mddefglossary.htm#mddefcursor">cursor</A> generates an error.</P>

<P>If an edit is in progress while in immediate update mode, calling the <B>Close</B> method generates an error; instead, call the <A HREF="mdmthupdate.htm">Update</A> or <A HREF="mdmthcancelupdate.htm">CancelUpdate</A> method first. If you close the <B>Recordset</B> object while in batch update mode, all changes since the last <A HREF="mdmthupdatebatch.htm">UpdateBatch</A> call are lost.</P>

<P>If you use the <A HREF="mdmthclone.htm">Clone</A> method to create copies of an open <B>Recordset</B> object, closing the original or a clone does not affect any of the other copies.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="mdmthopenx.htm">Visual Basic Example</A> | <A HREF="mdmthopenclosevbscriptx.htm">VBScript Example</A> | <A HREF="mdmthopenxvc.htm">Visual C++ Example</A> | <A HREF="mdmthopenxvj.htm">Visual J++ Example</A></P>

<P><A HREF="mdmthcnnopen.htm">Open Method (ADO Connection)</A> | <A HREF="mdmthrstopen.htm">Open Method (ADO Recordset)</A> | <A HREF="mdmthrstsave.htm">Save Method</A></P>

<P>Applies To: <A HREF="mdobjconnection.htm">Connection Object</A> | <A HREF="mdobjrecord.htm">Record Object</A> | <A HREF="mdobjodbrec.htm">Recordset Object</A> | <A HREF="mdobjstream.htm">Stream Object</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
