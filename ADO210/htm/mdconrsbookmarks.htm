<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Using Bookmarks</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>ADO 2.5</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="mdconrsbookmarks"></A>Using Bookmarks</H1>

<P>It is often useful to return directly to a specific record after having moved around in the <B>Recordset</B> without having to scroll through every record and compare values. For example, if you attempt to search for a record using the <B>Find</B> method but the search returns no records, you are automatically placed at either end of the <B>Recordset</B>. If your provider supports them, bookmarks can be used to mark your place before using the <B>Find</B> method so you can return to your location. A bookmark is a <B>Variant</B> type value that uniquely identifies a record in a <B>Recordset</B> object. </P>

<P>You can also use a variant array of bookmarks with the <B>Recordset</B> <B>Filter</B> method to filter on a selected set of records. For details about this technique, see Filtering the Results in the topic, <A HREF="mdconworkingwithrecordsets.htm">Working with Recordsets</A>, later in this chapter.</P>

<P>You can use the <B>Bookmark</B> property to get a bookmark for a record, or set the current record in a <B>Recordset</B> object to the record identified by a valid bookmark. The following code uses the <B>Bookmark</B> property to set a bookmark and then return to the bookmarked record after moving on to other records. To determine if your <B>Recordset</B> supports bookmarks, use the <B>Supports</B> method. </P>

<PRE class="code">'BeginBookmarkEg
    Dim varBookmark As Variant
    Dim blnCanBkmrk As Boolean
    
    objRs.Open strSQL, strConnStr, adOpenStatic, adLockOptimistic, adCmdText
    
    If objRs.RecordCount &gt; 4 Then
        objRs.Move 4                       ' move to the fifth record
        blnCanBkmrk = objRs.Supports(adBookmark)
        If blnCanBkmrk = True Then
            varBookmark = objRs.Bookmark   ' record the bookmark
            objRs.MoveLast                 ' move to a different record
            objRs.Bookmark = varBookmark   ' return to the bookmarked (sixth) record
        End If
    End If
'EndBookmarkEg</PRE>

<P>The <A HREF="mdmthsupports.htm">Supports</A> method is covered in more detail later. </P>

<P>Except for the case of cloned <B>Recordsets</B>, bookmarks are unique to the <B>Recordset</B> in which they were created, even if the same command is used. This means that you cannot use a <B>Bookmark</B> obtained from one <B>Recordset</B> to move to the same record in a second <B>Recordset</B> opened with the same command.</P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
</HTML>
