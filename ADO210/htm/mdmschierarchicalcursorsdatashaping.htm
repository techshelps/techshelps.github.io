<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Chapter 9: Data Shaping</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>ADO 2.5</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="mdmschierarchicalcursorsdatashaping"></A>Chapter 9: Data Shaping</H1>

<P><I>Data shaping</I> provides a way to query a data source and return a <A HREF="mdobjodbrec.htm">Recordset</A> that represents a parent-child relationship between two or more logical entities (a hierarchy). A classic example of a hierarchical relationship is customers and orders. For every customer in a database, there can be zero or more orders. Regular SQL provides a means of retrieving the data using JOIN syntax, but this can be inefficient and unwieldy because redundant parent data is repeated in each record returned for a given parent-child relationship. Data shaping can relate a single parent record in the parent <B>Recordset</B> to multiple child records in the child <B>Recordset</B>, avoiding the redundancy of a JOIN. Most people find the parent-child multiple <B>Recordset</B> programming model more natural and easier to work with than the single <B>Recordset</B> JOIN model.</P>

<P>The data shaping syntax also provides other capabilities. Developers can create new <B>Recordset</B> objects without an underlying data source by using the NEW keyword to describe the fields of the parent and child <B>Recordsets</B>. The new <B>Recordset</B> object can be populated with data and persistently stored. Developers can also perform various calculations or aggregations (for example, SUM, AVG, and MAX) on child fields. Data shaping can also create a parent <B>Recordset</B> from a child <B>Recordset</B> by grouping records in the child and placing one row in the parent for each group in the child.</P>

<P>See the following topics to learn more about data shaping:

<UL type="disc">
	<LI><A HREF="mdmschierarchicalcursorsdatashapingdetail.htm">Data Shaping Summary</A></li>

	<LI><A HREF="mdmscrequiredprovidersfordatashaping.htm">Required Providers for Data Shaping</A></li>

	<LI><A HREF="mdmscshapecommandsingeneral.htm">Shape Commands in General</A></li>

	<LI><A HREF="mdmscshapeappendcommand.htm">Shape APPEND Clause</A></li>

	<LI><A HREF="mdmscshapecomputecommand.htm">Shape COMPUTE Clause</A></li>

	<LI><A HREF="mdobjfabricatinghierarchicalrecordsets.htm">Fabricating Hierarchical Recordsets</A></li>

	<LI><A HREF="mdmscaccessingrowsinhierarchicalrecordset.htm">Accessing Rows in a Hierarchical Recordset</A></li>

	<LI><A HREF="mdmscformalshapegrammar.htm">Formal Shape Grammar</A></li>

	<LI><A HREF="mdmscvbafunctions.htm">Visual Basic for Applications Functions</A></li>
</UL>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
