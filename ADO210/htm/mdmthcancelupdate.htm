<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CancelUpdate Method (ADO)</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>ADO 2.5 API Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="mdmthcancelupdate"></A>CancelUpdate Method</H1>

<P>Cancels any changes made to the current or new row of a <A HREF="mdobjodbrec.htm">Recordset</A> object, or the <A HREF="mdcolfields.htm">Fields</A> collection of a <A HREF="mdobjrecord.htm">Record</A> object, before calling the <A HREF="mdmthupdate.htm">Update</A> method.</P>

<H4 class="dtH4">Syntax</H4>

<PRE class="syntax"><I>recordset</I>.<B>CancelUpdate</B>
<I>record.Fields</I>.<B>CancelUpdate</B></PRE>

<H4 class="dtH4">Remarks</H4>

<P class="label"><B>Recordset</B></P>

<P>Use the <B>CancelUpdate</B> method to cancel any changes made to the current row or to discard a newly added row. You cannot cancel changes to the current row or a new row after you call the <B>Update</B> method, unless the changes are either part of a transaction that you can roll back with the <A HREF="mdmthbegintrans.htm">RollbackTrans</A> method, or part of a batch update. In the case of a batch update, you can cancel the <B>Update</B> with the <B>CancelUpdate</B> or <A HREF="mdmthcancelbatch.htm">CancelBatch</A> method.</P>

<P>If you are adding a new row when you call the <B>CancelUpdate</B> method, the current row becomes the row that was current before the <A HREF="mdmthaddnew.htm">AddNew</A> call.</P>

<P>If you are in edit mode and want to move off the current record (for example, with <A HREF="mdmthmove.htm">Move</A>, <A HREF="mdmthnextrec.htm">NextRecordset</A>, or <A HREF="mdmthclose.htm">Close</A>), you can use <B>CancelUpdate</B> to cancel any pending changes. You may need to do this if the update cannot successfully be posted to the data source (for example, an attempted delete that fails due to referential integrity violations will leave the <B>Recordset</B> in edit mode after a call to <A HREF="mdmthrstdelete.htm">Delete</A>).</P>

<P class="label"><B>Record</B></P>

<P>The <B>CancelUpdate</B> method cancels any pending insertions or deletions of <A HREF="mdobjfield.htm">Field</A> objects, and cancels pending updates of existing fields and restores them to their original values. The <A HREF="mdprostatus.htm">Status</A> property of all fields in the <B>Fields</B> collection is set to <B>adFieldOK</B>.</P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="mdmthupdatex.htm">Visual Basic Example</A> | <A HREF="mdmthupdatexvc.htm">Visual C++ Example</A> | <A HREF="mdmthupdatexvj.htm">Visual J++ Example</A></P>

<P><A HREF="mdmthaddnew.htm">AddNew Method</A> | <A HREF="mdmthadocancel.htm">Cancel Method</A> | <A HREF="mdmthrdscancel.htm">Cancel Method (RDS)</A> | <A HREF="mdmthcancelbatch.htm">CancelBatch Method</A> | <A HREF="mdmthrdscanupd.htm">CancelUpdate Method (RDS)</A> | <A HREF="mdproeditmode.htm">EditMode Property</A> | <A HREF="mdmthupdate.htm">Update Method</A></P>

<P>Applies To: <A HREF="mdcolfields.htm">Fields Collection</A> | <A HREF="mdobjodbrec.htm">Recordset Object</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
