<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="ltr">
	<HEAD>
		<TITLE>Execute Method (ADO Command)</TITLE>
		<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
		<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
		<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
		<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT>
	</HEAD>
	<body topmargin="0" id="bodyID" class="dtBODY">
		
		<div id="scrbanner">
			<div id="bannerrow1">
				<TABLE CLASS="bannerparthead" CELLSPACING="0">
					<TR ID="hdr">
						<TD CLASS="bannerparthead td" nowrap>ADO 2.5 API Reference</TD>
						<TD valign="center"><a href="#Feedback"><IMG name="feedb" onclick="startFeedback(SDKFeedB)" style="CURSOR: hand" hspace="15" alt="" src="../stylesheets/mailto.gif" align="right"></a></TD>
					</TR>
				</TABLE>
			</div>
		</div>
		<DIV id="scrtext" valign="bottom">
			<H1 class="dtH1"><A NAME="mdmthcmdexecute"></A>Execute Method (ADO Command)</H1>
			<P>Executes the query, SQL statement, or stored procedure specified in the <A HREF="mdprocommandtext.htm">
					CommandText</A> property.</P>
			<H4 class="dtH4">Syntax</H4>
			<P>For a <B>Recordset</B>-returning <B>Command</B>:</P>
			<PRE class="syntax"><B>Set</B> <I>recordset</I> = <I>command</I>.<B>Execute( </B><I>RecordsAffected</I><B>, </B><I>Parameters</I><B>, </B><I>Options </I><B>)</B></PRE>
			<P>For a non–recordset-returning <B>Command</B>:</P>
			<PRE class="syntax"><I>command</I>.<B>Execute</B> <I>RecordsAffected</I><B>, </B><I>Parameters</I><B>, </B><I>Options</I></PRE>
			<H4 class="dtH4">Return Value</H4>
			<P>Returns a <A HREF="mdobjodbrec.htm">Recordset</A> object reference or <B>Nothing</B>.</P>
			<H4 class="dtH4">Parameters</H4>
			<DL>
				<DT><I>RecordsAffected</I>
					<DD>
						Optional. A <B>Long</B> variable to which the <A HREF="mddefglossary.htm#mddefdataprovider">
							provider</A> returns the number of records that the operation affected. The <I>RecordsAffected</I>
						parameter applies only for action queries or stored procedures. <I>RecordsAffected</I>
						does not return the number of records returned by a result-returning query or 
						stored procedure. To obtain this information, use the <A HREF="mdprorecordcount.htm">
							RecordCount</A> property. The <B>Execute</B> method will not return the 
						correct information when used with <B>adAsyncExecute</B>, simply because when a 
						command is executed asynchronously, the number of records affected may not yet 
						be known at the time the method returns. <DT><I>Parameters</I>
							<DD>
								</I>Optional. A <B>Variant</B> array of parameter values passed with an SQL 
								statement. (Output parameters will not return correct values when passed in 
								this argument.) <DT><I>Options</I>
									<DD>
										Optional. A <B>Long</B> value that indicates how the provider should evaluate 
										the <A HREF="mdprocommandtext.htm">CommandText</A>&nbsp;property of the <A HREF="mdobjcommand.htm">
											Command</A> object. Can be a bitmask value made using <A HREF="mdcstcommandtypeenum.htm">
											CommandTypeEnum</A> and/or <A HREF="mdcstexecuteoptionenum.htm">ExecuteOptionEnum</A>
										values. For example, you could use both <B>adCmdText</B> and <B>adExecuteNoRecords</B>
										together in combination if you want to have ADO evaluate the value of the <B>CommandText</B>
										property as text and indicate that the command should discard and not return 
										any records that might be generated when the command text executes.</DD>
			</DL>
			<H4 class="dtH4">Remarks</H4>
			<P>Using the <B>Execute</B> method on a <B>Command</B> object executes the query 
				specified in the <B>CommandText</B> property of the object. If the <B>CommandText</B>
				property specifies a row-returning query, any results that the execution 
				generates are stored in a new <B>Recordset</B> object. If the command is not a 
				row-returning query, the provider returns a closed <B>Recordset</B> object. 
				Some application languages allow you to ignore this return value if no <B>Recordset</B>
				is desired.</P>
			<P class="T">If the query has parameters, the current values for the <B>Command</B> 
				object's parameters are used unless you override these with parameter values 
				passed with the <B>Execute</B> call. You can override a subset of the 
				parameters by omitting new values for some of the parameters when calling the <B>Execute</B>
				method. The order in which you specify the parameters is the same order in 
				which the method passes them. For example, if there were four (or more) 
				parameters and you wanted to pass new values for only the first and fourth 
				parameters, you would pass <CODE>Array(var1,,,var4)</CODE> as the <I>Parameters</I>
				argument.</P>
			<P class="NT"><B>Note&nbsp;&nbsp;&nbsp;</B>Output parameters will not return 
				correct values when passed in the <I>Parameters</I>
			argument.
			<P class="NT">An <A HREF="mdevtexecutecomplete.htm">ExecuteComplete</A> event will 
				be issued when this operation concludes.
				<H4 class="dtH4">See Also</H4>
			<P><A HREF="mdmthexecutex.htm">Visual Basic Example</A> | <A HREF="mdmthexecutevbscriptx.htm">
					VBScript Example</A> | <A HREF="mdmthexecutexvc.htm">Visual C++ Example</A> 
				| <A HREF="mdmthexecutexvj.htm">Visual J++ Example</A>&nbsp;|&nbsp; <A HREF="mdprocommandtext.htm">
					CommandText Property</A> | <A HREF="mdcstcommandtypeenum.htm">CommandTypeEnum</A>
				| <A HREF="mdmthcnnexecute.htm">Execute Method (ADO Connection)</A> | <A HREF="mdevtexecutecomplete.htm">
					ExecuteComplete Event</A></P>
			<P>Applies To: <A HREF="mdobjcommand.htm">Command Object</A></P>
			<H4><A NAME="feedback"></A></H4>
			<SPAN id="SDKFeedB"></SPAN>
		</DIV>
		<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">© 1998-2002 Microsoft 
				Corporation. All rights reserved.</A></P>
	</body>
</HTML>
