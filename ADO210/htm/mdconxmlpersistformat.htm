<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>XML Persistence Format</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>ADO 2.5</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H2 class="dtH2"><A NAME="mdconxmlpersistformat"></A>XML Persistence Format</H2>

<P>ADO uses UTF-8 encoding for the XML stream it persists.</P>

<P>The ADO XML format is broken into two sections, a schema section followed by the data section. The following is an example XML file for the Shippers table from the Northwind database. Various parts of the XML are discussed following the example.</P>

<PRE class="code">&lt;xml xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882" 
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" 
xmlns:rs="urn:schemas-microsoft-com:rowset" 
xmlns:z="#RowsetSchema"&gt; 
&nbsp;&nbsp;&lt;s:Schema id="RowsetSchema"&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&lt;s:ElementType name="row" content="eltOnly" rs:updatable="true"&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s:AttributeType name="ShipperID" rs:number="1" 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rs:basetable="shippers" rs:basecolumn="ShipperID"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rs:keycolumn="true"&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s:datatype dt:type="int" dt:maxLength="4" rs:precision="10" 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rs:fixedlength="true" rs:maybenull="false"/&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/s:AttributeType&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s:AttributeType name="CompanyName" rs:number="2" 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rs:nullable="true" rs:write="true" rs:basetable="shippers" 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rs:basecolumn="CompanyName"&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s:datatype dt:type="string" dt:maxLength="40" /&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/s:AttributeType&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s:AttributeType name="Phone" rs:number="3" rs:nullable="true" 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rs:write="true" rs:basetable="shippers" 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rs:basecolumn="Phone"&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s:datatype dt:type="string" dt:maxLength="24"/&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/s:AttributeType&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;s:extends type="rs:rowbase"/&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/s:ElementType&gt; 
&nbsp;&nbsp;&lt;/s:Schema&gt; 

&nbsp;&nbsp;&lt;rs:data&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&lt;z:row ShipperID="1" CompanyName="Speedy Express" 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Phone="(503) 555-9831"/&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&lt;z:row ShipperID="2" CompanyName="United Package" 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Phone="(503) 555-3199"/&gt; 
&nbsp;&nbsp;&nbsp;&nbsp;&lt;z:row ShipperID="3" CompanyName="Federal Shipping" 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Phone="(503) 555-9931"/&gt; 
&nbsp;&nbsp;&lt;/rs:data&gt; 
&lt;/xml&gt;</PRE>

<P>The schema shows the declarations of namespaces, the schema section, and the data section. The schema section contains definitions for row, ShipperID, CompanyName, and Phone.</P>

<P>Schema definitions conform to the XML-Data specification and are able to be fully validated (though validation will not occur in Internet Explorer 5). You can view this specification at <A HREF="http://www.w3.org/TR/1998/NOTE-XML-data/">http://www.w3.org/TR/1998/NOTE-XML-data/</A>. XML-Data is the only supported schema format for <B>Recordset</B> persistence currently.</P>

<P>The data section has three rows containing information about shippers. For an empty rowset, the data section may be empty, but the &lt;rs:data&gt; tags must be present. With no data, you could write the tag shorthand as simply &lt;rs:data/&gt;. Any tag prefixed with "rs" indicates that it is in the namespace defined by urn:schemas-microsoft-com:rowset. The full definition of this schema is defined in the appendix to this document.</P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
</HTML>
