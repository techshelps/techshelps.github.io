<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="ltr">
	<HEAD>
		<TITLE>Execute Method (ADO Connection)</TITLE>
		<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
		<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
		<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
		<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT>
	</HEAD>
	<body topmargin="0" id="bodyID" class="dtBODY">
		
		<div id="scrbanner">
			<div id="bannerrow1">
				<TABLE CLASS="bannerparthead" CELLSPACING="0">
					<TR ID="hdr">
						<TD CLASS="bannerparthead td" nowrap>ADO 2.5 API Reference</TD>
						<TD valign="center"><a href="#Feedback"><IMG name="feedb" onclick="startFeedback(SDKFeedB)" style="CURSOR: hand" hspace="15" alt="" src="../stylesheets/mailto.gif" align="right"></a></TD>
					</TR>
				</TABLE>
			</div>
		</div>
		<DIV id="scrtext" valign="bottom">
			<H1 class="dtH1"><A NAME="mdmthcnnexecute"></A>Execute Method (ADO Connection)</H1>
			<P>Executes the specified query, SQL statement, stored procedure, or <A HREF="mddefglossary.htm#mddefdataprovider">
					provider</A>-specific text.</P>
			<H4 class="dtH4">Syntax</H4>
			<P>For a non–row-returning command string:</P>
			<PRE class="syntax"><I>connection</I><B>.Execute</B> <I>CommandText</I><B>, </B><I>RecordsAffected</I><B>, </B><I>Options</I> </PRE>
			<P>For a row-returning command string:</P>
			<PRE class="syntax"><B>Set </B><I>recordset</I> = <I>connection</I><B>.Execute</B> <B>(</B><I>CommandText</I><B>, </B><I>RecordsAffected</I><B>, </B><I>Options</I><B>)</B></PRE>
			<H4 class="dtH4">Return Value</H4>
			<P>Returns a <A HREF="mdobjodbrec.htm">Recordset</A> object reference.</P>
			<H4 class="dtH4">Parameters</H4>
			<DL>
				<DT><I>CommandText</I>
					<DD>
						A <B>String</B> value that contains the SQL statement, stored procedure, a URL, 
						or provider-specific text to execute. Optionally, table names can be used but 
						only if the provider is SQL aware. For example if a table name of "Customers" 
						is used, ADO will automatically prepend the standard SQL Select syntax to form 
						and pass "SELECT * FROM Customers" as a T-SQL statement to the provider. <DT><I>RecordsAffected</I>
							<DD>
								Optional. A <B>Long</B> variable to which the provider returns the number of 
								records that the operation affected. <DT><I>Options</I>
									<DD>
										Optional. A <B>Long</B> value that indicates how the provider should evaluate 
										the <I>CommandText</I> argument. Can be a bitmask of one or more <A HREF="mdcstcommandtypeenum.htm">
											CommandTypeEnum</A> or <A HREF="mdcstexecuteoptionenum.htm">ExecuteOptionEnum</A>
										values.</DD>
			</DL>
			<BLOCKQUOTE class="dtBlock"> <b class="le">Note</b>&nbsp;&nbsp;&nbsp;Use the <B>ExecuteOptionEnum</B>
				value <B>adExecuteNoRecords</B> to improve performance by minimizing internal 
				processing.</BLOCKQUOTE><BLOCKQUOTE class="dtBlock"> Do not use the <B>CommandTypeEnum</B>
				values of <B>adCmdFile</B> or <B>adCmdTableDirect</B> with <B>Execute</B>. 
				These values can only be used as options with the <A HREF="mdmthrstopen.htm">Open</A>
				and <A HREF="mdmthadorequery.htm">Requery</A> methods of a <B>Recordset</B>.</BLOCKQUOTE>
			<H4 class="dtH4">Remarks</H4>
			<P>Using the <B>Execute</B> method on a <A HREF="mdobjconnection.htm">Connection</A>
				object executes whatever query you pass to the method in the <I>CommandText</I> 
				argument on the specified connection. If the <I>CommandText</I> argument 
				specifies a row-returning query, any results that the execution generates are 
				stored in a new <B>Recordset</B> object. If the command is not intended to 
				return results (for example, an SQL UPDATE query) the provider returns <B>Nothing</B>
				as long as the option <B>adExecuteNoRecords</B> is specified; otherwise Execute 
				returns a closed <B>Recordset</B>.</P>
			<P>The returned <B>Recordset</B> object is always a read-only, forward-only <A HREF="mddefglossary.htm#mddefcursor">
					cursor</A>. If you need a <B>Recordset</B> object with more functionality, 
				first create a <B>Recordset</B> object with the desired property settings, then 
				use the <B>Recordset</B> object's <A HREF="mdmthrstopen.htm">Open</A> method to 
				execute the query and return the desired cursor type.</P>
			<P>The contents of the <I>CommandText</I> argument are specific to the provider and 
				can be standard SQL syntax or any special command format that the provider 
				supports.</P>
			<P>An <A HREF="mdevtexecutecomplete.htm">ExecuteComplete</A> event will be issued 
				when this operation concludes.</P>
			<BLOCKQUOTE class="dtBlock"> <b class="le">Note</b>&nbsp;&nbsp;&nbsp;URLs using the 
				http scheme will automatically invoke the <A HREF="mdrefproviderrosebud.htm">Microsoft 
					OLE DB Provider for Internet Publishing</A>. For more information, see <A HREF="mdmsccompleteabsoluterelativeurls.htm">
					Absolute and Relative URLs</A>.</BLOCKQUOTE>
			<H4 class="dtH4">See Also</H4>
			<P><A HREF="mdmthexecutex.htm">Visual Basic Example</A> | <A HREF="mdmthexecutexvc.htm">
					Visual C++ Example</A> | <A HREF="mdmthexecutexvj.htm">Visual J++ Example</A></P>
			<P><A HREF="mdmthcmdexecute.htm">Execute Method (ADO Command)</A> | <A HREF="mdevtexecutecomplete.htm">
					ExecuteComplete Event</A></P>
			<P>Applies To: <A HREF="mdobjconnection.htm">Connection Object</A></P>
			<H4><A NAME="feedback"></A></H4>
			<SPAN id="SDKFeedB"></SPAN>
		</DIV>
		<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">© 1998-2002 Microsoft 
				Corporation. All rights reserved.</A></P>
	</body>
</HTML>
