<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ADO/WFC</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>ADO 2.5</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="mdconeventsadowfc"></A>ADO/WFC</H1>

<P>ADO for Windows Foundation Classes (ADO/WFC) builds on the ADO event model and presents a simplified application programming interface. In general, ADO/WFC intercepts ADO events, consolidates the event parameters into a single event class, and then calls your event handler.</P>

<P class="labelproc"><B>To use ADO events in ADO/WFC</B>

<OL type="1">
	<LI>Define your own event handler to process an event. For example, if you wanted to process the <B>ConnectComplete</B> event in the <B>ConnectionEvent</B> family, you might use this code:
<PRE class="code">public void onConnectComplete(Object sender,ConnectionEvent e)
{
&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("onConnectComplete:" + e);
}</PRE>
</li>

	<LI>Define a handler object to represent your event handler. The handler object should be of data type <B>ConnectEventHandler</B> for an event of type <B>ConnectionEvent</B>, or data type <B>RecordsetEventHandler</B> for an event of type <B>RecordsetEvent</B>. For example, code the following for your <B>ConnectComplete</B> event handler:
<PRE class="code">&nbsp;&nbsp;&nbsp;&nbsp;ConnectionEventHandler handler = 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new ConnectionEventHandler(this, "onConnectComplete");</PRE>

<P>The first argument of the <B>ConnectionEventHandler</B> constructor is a reference to the class that contains the event handler named in the second argument.

<P>The Microsoft Visual J++ compiler also supports an equivalent syntax:

<PRE class="code">&nbsp;&nbsp;&nbsp;&nbsp;ConnectionEventHandler handler = 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new ConnectionEventHandler(this.onConnectComplete);</PRE>

<P>The single argument is a reference to the desired class (<B>this</B>) and method within the class (<B>onConnectComplete</B>).
</li>

	<LI>Add your event handler to a list of handlers designated to process a particular type of event. Use the method with a name such as <B>addOn</B><I>EventName</I>(<I>handler</I>).</li>

	<LI>ADO/WFC internally implements all the ADO event handlers. Therefore, an event caused by a <B>Connection</B> or <B>Recordset</B> operation is intercepted by an ADO/WFC event handler.
<P>The ADO/WFC event handler passes ADO <B>ConnectionEvent</B> parameters in an instance of the ADO/WFC <B>ConnectionEvent</B> class, or ADO <B>RecordsetEvent</B> parameters in an instance of the ADO/WFC <B>RecordsetEvent</B> class. These ADO/WFC classes consolidate the ADO event parameters; that is, each ADO/WFC class contains one data member for each unique parameter in all the ADO <B>ConnectionEvent</B> or <B>RecordsetEvent</B> methods.
</li>

	<LI>ADO/WFC then calls your event handler with the ADO/WFC event object. For example, your <B>onConnectComplete</B> handler has a signature like this:
<PRE class="code">&nbsp;&nbsp;&nbsp;&nbsp;public void onConnectComplete(Object sender,ConnectionEvent e)</PRE>

<P>The first argument is the type of object that sent the event (<A HREF="mdobjconnection.htm">Connection</A> or <A HREF="mdobjodbrec.htm">Recordset</A>), and the second argument is the ADO/WFC event object (<B>ConnectionEvent</B> or <B>RecordsetEvent</B>).

<P>The signature of your event handler is simpler than an ADO event. However, you must still understand the ADO event model to know what parameters apply to an event and how to respond.
</li>

	<LI>Return from your event handler to the ADO/WFC handler for the ADO event. ADO/WFC copies pertinent ADO/WFC event data members back to the ADO event parameters, and then the ADO event handler returns.</li>

	<LI>When you are finished processing, remove your handler from the list of ADO/WFC event handlers. Use the method with a name such as <B>removeOn</B><I>EventName</I>(<I>handler</I>).</li>
</OL>

<H4 class="dtH4">See Also</H4>

<P><A HREF="mdmscadoevents.htm">ADO Event Handler Summary</A> | <A HREF="mdmscadoforjava.htm">ADO/WFC Programming </A> | <A HREF="mdidxadoforjavasyntax.htm">ADO/WFC Syntax Index</A> | <A HREF="mdmsceventparameters.htm">Event Parameters</A> | <A HREF="mdmschoweventhandlersworktogether.htm">How Event Handlers Work Together</A> | <A HREF="mdmsctypesofevents.htm">Types of Events</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
</HTML>
