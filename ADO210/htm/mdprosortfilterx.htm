<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>FilterColumn, FilterCriterion, FilterValue, SortColumn, and SortDirection Properties and Reset Method Example (VBScript)</TITLE>
<SCRIPT SRC="../stylesheets/vs70link.js"></SCRIPT>
<SCRIPT SRC="../stylesheets/vs70.js"></SCRIPT>
<SCRIPT LANGUAGE="JScript" SRC="../stylesheets/ADO.js"></SCRIPT></HEAD>
<body topmargin=0 id="bodyID" class = "dtBODY">

<div id="scrbanner">
<div id="bannerrow1">
<TABLE CLASS="bannerparthead" CELLSPACING=0>
<TR ID="hdr">
<TD CLASS="bannerparthead td" nowrap>RDS 2.5 API Reference</TD><TD valign=middle><a href="#Feedback"><IMG name="feedb" onclick=startFeedback(SDKFeedB) style="CURSOR: hand;" hspace=15 alt="" src="../stylesheets/mailto.gif" align=right></a></TD>
</TR>
</TABLE>
</div>
</div>
<DIV id="scrtext" valign="bottom">
<H1 class="dtH1"><A NAME="mdprosortfilterx"></A>FilterColumn, FilterCriterion, FilterValue, SortColumn, and SortDirection Properties and Reset Method Example (VBScript)</H1>

<P>The following code shows how to set the <A HREF="mdobjdatacontrol.htm">RDS.DataControl</A> <B>Server</B> parameter at design<U> </U>time and bind it to a data-aware HTML table using a data source. Cut and paste the following code to Notepad or another text editor and save it as <B>FilterColumnVBS.asp</B>.</P>

<P class="normal"><CODE>&lt;!-- BeginFilterColumnVBS --&gt;</CODE></P>

<P class="normal"><CODE>&lt;%@ Language=VBScript %&gt;</CODE></P>

<P class="normal"><CODE>&lt;HTML&gt;</CODE></P>

<P class="normal"><CODE>&lt;HEAD&gt;</CODE></P>

<P class="normal"><CODE>&lt;META name="VI60_DefaultClientScript" Content="VBScript"&gt;</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>&lt;META NAME="GENERATOR" Content="Microsoft Visual Studio 6.0"&gt;</CODE></P>

<P class="normal"><CODE>&lt;TITLE&gt;FilterColumn, FilterCriterion, FilterValue, SortColumn, and SortDirection </CODE></P>

<P class="normal"><CODE>Properties and Reset Method Example (VBScript)&lt;/TITLE&gt;</CODE></P>

<P class="normal"><CODE>&lt;/HEAD&gt;</CODE></P>

<P class="normal"><CODE>&lt;BODY&gt;</CODE></P>

<P class="normal"><CODE>&lt;h1&gt;FilterColumn, FilterCriterion, FilterValue, SortColumn, and SortDirection </CODE></P>

<P class="normal"><CODE>Properties and Reset Method Example (VBScript)&lt;/h1&gt;</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>&lt;OBJECT classid="clsid:BD96C556-65A3-11D0-983A-00C04FC29E33" ID=RDS HEIGHT=1 WIDTH=1&gt;</CODE></P>

<P class="normal"><CODE>&lt;PARAM NAME="SQL" VALUE="Select FirstName, LastName, Title, ReportsTo, Extension from Employees"&gt;</CODE></P>

<P class="normal"><CODE>&lt;PARAM NAME="Connect" VALUE="Provider='sqloledb';Data Source=&lt;%=Request.ServerVariables("SERVER_NAME")%&gt;;Integrated Security='SSPI';Initial Catalog='Northwind'"&gt;</CODE></P>

<P class="normal"><CODE>&lt;PARAM NAME="Server" VALUE="http://&lt;%=Request.ServerVariables("SERVER_NAME")%&gt;"&gt;</CODE></P>

<P class="normal"><CODE>&lt;/OBJECT&gt;</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>Sort Column: &lt;SELECT NAME="cboSortColumn"&gt; </CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=""&gt;&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=ID&gt;ID&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=FirstName&gt;FirstName&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=LastName&gt;LastName&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=Title&gt;Title&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=Title&gt;ReportsTo&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=Phone&gt;Extension&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;/SELECT&gt;</CODE></P>

<P class="normal"><CODE>&lt;br&gt;</CODE></P>

<P class="normal"><CODE>Sort Direction: &lt;SELECT NAME="cboSortDir"&gt; </CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=""&gt;&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=TRUE&gt;Ascending&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=FALSE&gt;Descending&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;/SELECT&gt;</CODE></P>

<P class="normal"><CODE>&lt;HR WIDTH="25%"&gt;</CODE></P>

<P class="normal"><CODE>Filter Column: &lt;SELECT NAME="cboFilterColumn"&gt; </CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=""&gt;&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=FirstName&gt;FirstName&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=LastName&gt;LastName&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=Title&gt;Title&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=Room&gt;ReportsTo&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=Phone&gt;Extension&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;/SELECT&gt;</CODE></P>

<P class="normal"><CODE>&lt;br&gt;</CODE></P>

<P class="normal"><CODE>Filter Criterion: &lt;SELECT NAME="cboCriterion"&gt; </CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE=""&gt;&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE="="&gt;=&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE="&amp;gt;"&gt;&amp;gt;&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE="&amp;lt;"&gt;&amp;lt;&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE="&amp;gt;="&gt;&amp;gt;=&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE="&amp;lt;="&gt;&amp;lt;=&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;OPTION VALUE="&amp;lt;&amp;gt;"&gt;&amp;lt;&amp;gt;&lt;/OPTION&gt;</CODE></P>

<P class="normal"><CODE>&lt;/SELECT&gt; </CODE></P>

<P class="normal"><CODE>&lt;br&gt;</CODE></P>

<P class="normal"><CODE>Filter Value: &lt;INPUT NAME="txtFilterValue"&gt;</CODE></P>

<P class="normal"><CODE>&lt;HR WIDTH="25%"&gt;</CODE></P>

<P class="normal"><CODE>&lt;INPUT TYPE=BUTTON NAME=Clear VALUE="CLEAR ALL"&gt; &amp;nbsp;</CODE></P>

<P class="normal"><CODE>&lt;INPUT TYPE=BUTTON NAME=SortFilter VALUE="APPLY"&gt;</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>&lt;HR&gt;</CODE></P>

<P class="normal"><CODE>&lt;TABLE DATASRC=#RDS ID="DataTable"&gt;</CODE></P>

<P class="normal"><CODE>&lt;THEAD&gt;</CODE></P>

<P class="normal"><CODE>&lt;TR&gt;</CODE></P>

<P class="normal"><CODE>&lt;TH&gt;FirstName&lt;/TH&gt;</CODE></P>

<P class="normal"><CODE>&lt;TH&gt;LastName&lt;/TH&gt;</CODE></P>

<P class="normal"><CODE>&lt;TH&gt;Title&lt;/TH&gt;</CODE></P>

<P class="normal"><CODE>&lt;TH&gt;Reports To&lt;/TH&gt;</CODE></P>

<P class="normal"><CODE>&lt;TH&gt;Extension&lt;/TH&gt;</CODE></P>

<P class="normal"><CODE>&lt;/TR&gt;</CODE></P>

<P class="normal"><CODE>&lt;/THEAD&gt;</CODE></P>

<P class="normal"><CODE>&lt;TBODY&gt;</CODE></P>

<P class="normal"><CODE>&lt;TR&gt;</CODE></P>

<P class="normal"><CODE>&lt;TD&gt;&lt;SPAN DATAFLD="FirstName"&gt;&lt;/SPAN&gt;&lt;/TD&gt;</CODE></P>

<P class="normal"><CODE>&lt;TD&gt;&lt;SPAN DATAFLD="LastName"&gt;&lt;/SPAN&gt;&lt;/TD&gt;</CODE></P>

<P class="normal"><CODE>&lt;TD&gt;&lt;SPAN DATAFLD="Title"&gt;&lt;/SPAN&gt;&lt;/TD&gt;</CODE></P>

<P class="normal"><CODE>&lt;TD&gt;&lt;SPAN DATAFLD="ReportsTo"&gt;&lt;/SPAN&gt;&lt;/TD&gt;</CODE></P>

<P class="normal"><CODE>&lt;TD&gt;&lt;SPAN DATAFLD="Extension"&gt;&lt;/SPAN&gt;&lt;/TD&gt;</CODE></P>

<P class="normal"><CODE>&lt;/TR&gt;</CODE></P>

<P class="normal"><CODE>&lt;/TBODY&gt;</CODE></P>

<P class="normal"><CODE>&lt;/TABLE&gt;</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>&lt;Script Language="VBScript"&gt;</CODE></P>

<P class="normal"><CODE>&lt;!--</CODE></P>

<P class="normal"><CODE>Const adFilterNone = 0</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>Sub SortFilter_OnClick</CODE></P>

<P class="normal"><CODE>Dim vCriterion</CODE></P>

<P class="normal"><CODE>Dim vSortDir</CODE></P>

<P class="normal"><CODE>Dim vSortCol</CODE></P>

<P class="normal"><CODE>Dim vFilterCol</CODE></P>

<P class="normal"><CODE></CODE></P>

<P class="normal"><CODE>' The value of SortColumn will be the </CODE></P>

<P class="normal"><CODE>' value of what the user picks in the</CODE></P>

<P class="normal"><CODE>' cboSortColumn box.</CODE></P>

<P class="normal"><CODE>vSortCol = cboSortColumn.options(cboSortColumn.selectedIndex).value</CODE></P>

<P class="normal"><CODE></CODE></P>

<P class="normal"><CODE>If(vSortCol &lt;&gt; "") then</CODE></P>

<P class="normal"><CODE>RDS.SortColumn = vSortCol</CODE></P>

<P class="normal"><CODE>End If</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>' The value of SortDirection will be the </CODE></P>

<P class="normal"><CODE>' value of what the user specifies in the</CODE></P>

<P class="normal"><CODE>' cboSortdirection box.</CODE></P>

<P class="normal"><CODE></CODE></P>

<P class="normal"><CODE>If (vSortCol &lt;&gt; "") then</CODE></P>

<P class="normal"><CODE>vSortDir = cboSortDir.options(cboSortDir.selectedIndex).value</CODE></P>

<P class="normal"><CODE>If (vSortDir = "") then</CODE></P>

<P class="normal"><CODE>MsgBox "You must select a direction for the sort."</CODE></P>

<P class="normal"><CODE>Exit Sub</CODE></P>

<P class="normal"><CODE>Else</CODE></P>

<P class="normal"><CODE>If vSortDir = "Ascending" Then vSortDir = "TRUE"</CODE></P>

<P class="normal"><CODE>If vSortDir = "Descending" Then vSortDir = "FALSE"</CODE></P>

<P class="normal"><CODE>RDS.SortDirection = vSortDir</CODE></P>

<P class="normal"><CODE>End If</CODE></P>

<P class="normal"><CODE>End If</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>' The value of FilterColumn will be the </CODE></P>

<P class="normal"><CODE>' value of what the user specifies in the</CODE></P>

<P class="normal"><CODE>' cboFilterColumn box.</CODE></P>

<P class="normal"><CODE>vFilterCol = cboFilterColumn.options(cboFilterColumn.selectedIndex).value</CODE></P>

<P class="normal"><CODE></CODE></P>

<P class="normal"><CODE>If(vFilterCol &lt;&gt; "") then</CODE></P>

<P class="normal"><CODE>RDS.FilterColumn = vFilterCol</CODE></P>

<P class="normal"><CODE>End If</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>' The value of FilterCriterion will be the </CODE></P>

<P class="normal"><CODE>' text value of what the user specifies in the</CODE></P>

<P class="normal"><CODE>' cboCriterion box.</CODE></P>

<P class="normal"><CODE>vCriterion = cboCriterion.options(cboCriterion.selectedIndex).value</CODE></P>

<P class="normal"><CODE>If (vCriterion &lt;&gt; "") Then</CODE></P>

<P class="normal"><CODE>RDS.FilterCriterion = vCriterion</CODE></P>

<P class="normal"><CODE>End If</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>' txtFilterValue is a rich text box</CODE></P>

<P class="normal"><CODE>' control. The value of FilterValue will be the </CODE></P>

<P class="normal"><CODE>' text value of what the user specifies in the</CODE></P>

<P class="normal"><CODE>' txtFilterValue box.</CODE></P>

<P class="normal"><CODE>If (txtFilterValue.value &lt;&gt; "") Then</CODE></P>

<P class="normal"><CODE>RDS.FilterValue = txtFilterValue.value</CODE></P>

<P class="normal"><CODE>End If</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>' Execute the sort and filter on a client-side</CODE></P>

<P class="normal"><CODE>' Recordset based on the specified sort and filter</CODE></P>

<P class="normal"><CODE>' properties. Calling Reset refreshes the result set</CODE></P>

<P class="normal"><CODE>' that is displayed in the data-bound controls to</CODE></P>

<P class="normal"><CODE>' display the filtered, sorted recordset.</CODE></P>

<P class="normal"><CODE>RDS.Reset</CODE></P>

<P class="normal"><CODE>End Sub</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>Sub Clear_onClick()</CODE></P>

<P class="normal"><CODE>'clear the HTML input controls</CODE></P>

<P class="normal"><CODE>cboSortColumn.selectedIndex = 0</CODE></P>

<P class="normal"><CODE>cboSortDir.selectedIndex = 0</CODE></P>

<P class="normal"><CODE>cboFilterColumn.selectedIndex = 0</CODE></P>

<P class="normal"><CODE>cboCriterion.selectedIndex = 0</CODE></P>

<P class="normal"><CODE>txtFilterValue.value = ""</CODE></P>

<P class="normal"><CODE></CODE></P>

<P class="normal"><CODE>'clear the filter</CODE></P>

<P class="normal"><CODE>RDS.FilterCriterion = ""</CODE></P>

<P class="normal"><CODE>RDS.Reset(FALSE)</CODE></P>

<P class="normal"><CODE>End Sub</CODE></P>

<P class="normal"><CODE>--&gt;</CODE></P>

<P class="normal"><CODE>&lt;/Script&gt;</CODE></P>

<P class="normal"></P>

<P class="normal"><CODE>&lt;/BODY&gt;</CODE></P>

<P class="normal"><CODE>&lt;/HTML&gt;</CODE></P>

<P class="normal"><CODE>&lt;!-- EndFilterColumnVBS --&gt;</CODE></P>

<H4 class="dtH4">See Also</H4>

<P><A HREF="mdobjdatacontrol.htm">DataControl Object (RDS)</A> | <A HREF="mdprofiltercol.htm">FilterColumn Property (RDS)</A> | <A HREF="mdprofiltercrit.htm">FilterCriterion Property (RDS)</A> | <A HREF="mdpropropfilter.htm">FilterValue Property (RDS)</A> | <A HREF="mdmthreset.htm">Reset Method (RDS)</A> | <A HREF="mdprosortcol.htm">SortColumn Property (RDS)</A> | <A HREF="mdprosortdir.htm">SortDirection Property (RDS)</A></P>
<H4><A NAME="feedback"></A></H4>
<SPAN id="SDKFeedB"></SPAN>
</div>
<P align="center"><A HREF="ado_sdk_copyright_and_trademarks.htm">&copy; 1998-2003 Microsoft Corporation. All rights reserved.</A></P>
</BODY>
</HTML>
