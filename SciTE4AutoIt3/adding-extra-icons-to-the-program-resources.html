<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Adding extra icons to the program resources</title>
  <meta name="generator" content="HelpMaker">
  <meta name="keywords" content="AutoIt3Wrapper">
  <link rel="stylesheet" type="text/css" href="hm.css">
  <style type="text/css">
body {
  background-color: #FFFCEA;
  }
  span.c12 { font-size:10pt; font-family:Arial; color:#000000}
  span.c11 { font-size:10pt; font-family:Courier New; color:#000000}
  span.c10 { font-size:10pt; font-family:Courier New; color:#0000ff}
  span.c9 { font-size:10pt; font-family:Courier New; color:#000080}
  span.c8 { font-size:10pt; font-family:Courier New; color:#010101}
  span.c7 { font-size:10pt; font-family:Courier New; color:#ff0000}
  span.c6 { font-size:10pt; font-family:Courier New; color:#008000}
  p.c5 {margin-left:0mm; margin-right:0mm; text-indent:0mm; margin-top:1.76mm; margin-bottom:1.76mm;}
  span.c4 { font-size:10pt; font-family:Arial; color:#010101}
  table.c3 {background-color: #C0C0C0}
  div.c2 {text-align: left}
  span.c1 {font-size:16pt; font-family:Arial; color:#8b0000}
  </style>
  <style type="text/css">
span.c1 {font-weight: bold; text-decoration: underline;}
  </style>
</head>
<body>
  <table class="c3" border="0" cellpadding="2" cellspacing="0" width="100%">
    <tbody>
      <tr>
        <td align="left">
          <div class="c2">
            <span class="c1">Adding extra icons to the program resources</span>
          </div>
        </td>
        <td align="right"><a href="directives-available.html">Previous</a>&nbsp;<a href="Introduction.html">Top</a>&nbsp;<a href="adding-data-to-the-program-resources.html">Next</a></td>
      </tr>
    </tbody>
  </table>
  <hr>
  <p class="c5"><span class="c4">This script shows how to add additional Icons to the program resources and then use them.<br>
  <span class="c1">Compile the script and run the exe to see it in action</span>:</span></p>
  <p class="c5"><span class="c4"><br></span></p>
  <div class="c2">
    <span class="c6">; Add icons to the file resource table</span>
  </div>
  <div class="c2">
    <span class="c6">; As no resource names are specified, they will be set automatically to 201+</span>
  </div>
  <div class="c2">
    <span class="c7">#AutoIt3Wrapper_Res_Icon_Add=C:\Program Files (x86)\AutoIt3\Icons\au3.ico</span>
  </div>
  <div class="c2">
    <span class="c7">#AutoIt3Wrapper_Res_Icon_Add=C:\Program Files (x86)\AutoIt3\Icons\au3script_v10.ico</span>
  </div>
  <div class="c2">
    <span class="c7">#AutoIt3Wrapper_Res_Icon_Add=C:\Program Files (x86)\AutoIt3\Icons\au3script_v9.ico</span>
  </div>
  <div class="c2">
    <span class="c7">#AutoIt3Wrapper_Res_Icon_Add=C:\Program Files (x86)\AutoIt3\Icons\filetype-blank.ico</span>
  </div>
  <div class="c2">
    <span class="c8"><br></span>
  </div>
  <div class="c2">
    <span class="c8">#include</span> <span class="c7">&lt;ButtonConstants.au3&gt;</span>
  </div>
  <div class="c2">
    <span class="c8"><br></span>
  </div>
  <div class="c2">
    <span class="c6">; Create the GUI</span>
  </div>
  <div class="c2">
    <span class="c8">$hGUI</span> <span class="c7">=</span> <span class="c9">GUICreate</span><span class="c7">("Demo icon resources")</span>
  </div>
  <div class="c2">
    <span class="c8">$cButton</span> <span class="c7">=</span> <span class="c9">GUICtrlCreateButton</span><span class="c7">("",</span> <span class="c10">10</span><span class="c7">,</span> <span class="c10">10</span><span class="c7">,</span> <span class=
    "c10">40</span><span class="c7">,</span> <span class="c10">40</span><span class="c7">, $BS_ICON)</span>
  </div>
  <div class="c2">
    <span class="c8">$cLabel</span> <span class="c7">=</span> <span class="c9">GUICtrlCreateLabel</span><span class="c7">("",</span> <span class="c10">70</span><span class="c7">,</span> <span class="c10">25</span><span class="c7">,</span> <span class=
    "c10">200</span><span class="c7">,</span> <span class="c10">20</span><span class="c7">)</span>
  </div>
  <div class="c2">
    <span class="c9">GUISetState</span><span class="c7">(</span><span class="c11">@SW_SHOW</span><span class="c7">,</span> <span class="c11">$hGUI</span><span class="c7">)</span>
  </div>
  <div class="c2">
    <span class="c8"><br></span>
  </div>
  <div class="c2">
    <span class="c6">; Now run through the added icons in the resource table</span>
  </div>
  <div class="c2">
    <span class="c8">For $x =</span> <span class="c10">201 To 204</span>
  </div>
  <div class="c2">
    <span class="c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c6">; Change the tray icon</span>
  </div>
  <div class="c2">
    <span class="c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rc1</span> <span class="c7">=</span> <span class="c9">TraySetIcon</span><span class="c7">(</span><span class="c11">@ScriptFullPath</span><span class="c7">,</span> <span class=
    "c11">$x</span><span class="c7">)</span>
  </div>
  <div class="c2">
    <span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c6">; Change the icon in the button</span>
  </div>
  <div class="c2">
    <span class="c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rc2</span> <span class="c7">=</span> <span class="c9">GUICtrlSetImage</span><span class="c7">(</span><span class="c11">$cButton</span><span class="c7">,</span> <span class=
    "c11">@ScriptFullPath</span><span class="c7">,</span> <span class="c11">$x</span><span class="c7">)</span>
  </div>
  <div class="c2">
    <span class="c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9">GUICtrlSetData</span><span class="c7">($cLabel, "Icon Name: " &amp;</span> <span class="c11">$x</span><span class="c7">)</span>
  </div>
  <div class="c2">
    <span class="c8"><br></span>
  </div>
  <div class="c2">
    <span class="c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9">TrayTip</span><span class="c7">("Added icon: " &amp;</span> <span class="c11">$x</span><span class="c7">, "TraySetIcon rc: " &amp;</span> <span class="c11">$rc1</span>
    <span class="c7">&amp;</span> <span class="c11">@CRLF</span> <span class="c7">&amp; "GUICtrlSetImage rc: " &amp;</span> <span class="c11">$rc2</span><span class="c7">,</span> <span class="c10">3</span><span class="c7">)</span>
  </div>
  <div class="c2">
    <span class="c7"><br></span>
  </div>
  <div class="c2">
    <span class="c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c6">; Allow time for icon to be seen</span>
  </div>
  <div class="c2">
    <span class="c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c9">Sleep</span><span class="c7">(</span><span class="c10">5000</span><span class="c7">)</span>
  </div>
  <div class="c2">
    <span class="c8">Next</span>
  </div>
  <div class="c2">
    <span class="c8"><br></span>
  </div>
  <div class="c2">
    <span class="c6">; Delete the GUI</span>
  </div>
  <div class="c2">
    <span class="c9">GUIDelete</span><span class="c7">($hGUI)</span>
  </div>
  <div class="c2">
    <span class="c4"><br></span>
  </div>
  <div class="c2">
    <span class="c12">The</span> <span class="c4">directives require full pathnames&nbsp; for the icon files - you may have to adjust those used if you did not carry out a standard installation.</span>
  </div>
</body>
</html>
