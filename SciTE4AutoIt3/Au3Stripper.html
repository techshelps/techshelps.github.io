<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Au3Stripper</title>
  <meta name="generator" content="HelpMaker">
  <meta name="keywords" content="Au3Stripper">
  <link rel="stylesheet" type="text/css" href="hm.css">
  <style type="text/css">
body.c14 {background-color: rgb(255, 252, 234);}
  p.c13 {margin: 1.76mm 0mm; text-indent: 0mm;}
  ul.c12 {margin-left: 40px;}
  div.c11 {margin: 0mm 0mm 0mm 25mm; text-align: left; text-indent: 0mm}
  div.c10 {margin: 0mm 0mm 0mm 13mm; text-align: left; text-indent: 0mm}
  table.c9 {border: medium none ; border-collapse: collapse;}
  td.c8 {border: 1px solid rgb(5, 0, 0);}
  p.c7 {margin: 0mm 0mm 1.76mm 38mm; text-indent: -5mm;}
  div.c6 {margin: 0mm 0mm 0mm 38mm; text-align: left; text-indent: -5mm}
  p.c5 {margin: 0mm 0mm 1.76mm 25mm; text-indent: -6mm;}
  p.c4 {margin: 0mm 0mm 1.76mm 19mm; text-indent: -6mm;}
  div.c3 {margin: 0mm 0mm 0mm 19mm; text-align: left; text-indent: -6mm}
  div.c2 {text-align: left}
  table.c1 {background-color: #C0C0C0}
  </style>
  <style type="text/css">
span.c2 {color: rgb(153, 51, 153);}
  table.c1 {width: 815px; height: 433px;}
  </style>
</head>
<body class="c14">
  <table class="c1" border="0" cellpadding="2" cellspacing="0" width="100%">
    <tbody>
      <tr>
        <td align="left">
          <h1>Au3Stripper</h1>
        </td>
        <td align="right"><a href="Versioning_with_SVN.html">Previous</a>&nbsp;<a href="Introduction.html">Top</a>&nbsp;<a href="Tidy.html">Next</a></td>
      </tr>
    </tbody>
  </table>
  <hr>
  <div class="c2">
    <h2>Introduction:</h2>
  </div>A few things to note before use:
  <div class="c2">
    <br>
  </div>
  <div class="c3">
    &#183;&nbsp;&nbsp; &nbsp;&nbsp;Ensure the script is working correctly before using Au3Stripper.
  </div>
  <div class="c3">
    &#183;&nbsp;&nbsp; &nbsp;&nbsp;Ensure the Au3Stripped script is extensively tested
  </div>
  <div class="c3">
    &#183;&nbsp;&nbsp; &nbsp;&nbsp;Do not complain if using Au3Stripper prevented the script from working correctly
  </div>
  <div class="c2">
    <h2>What Au3Stripper does:</h2>
  </div>
  <div class="c2">
    Au3Stripper&nbsp;will read your script and the include files you have added and create a new source file.&nbsp; As it works it will do all or some of the following depending on the parameters you have chosen:
  </div>
  <div class="c2">
    <br>
  </div>
  <p class="c4">&#183;&nbsp;&nbsp; &nbsp; Strip all unused UDF's (Funcs) and/or unused Global/Local Variables from your main script and all included files.</p>
  <p class="c4">&#183;&nbsp;&nbsp; &nbsp; PreExpand Global Const Variables.</p>
  <p class="c4">&#183;&nbsp;&nbsp; &nbsp;&nbsp;Rename Variables</p>
  <p class="c4">&#183;&nbsp;&nbsp; &nbsp;&nbsp;Rename Func names</p>
  <p class="c4">&#183;&nbsp;&nbsp; &nbsp;&nbsp;Warn you that the script is likely to have difficulties running if a parameter cannot be determined before run-time.&nbsp; This usually occurs if:</p>
  <p class="c5">&#183;&nbsp;&nbsp; &nbsp;A function takes a literal string parameter defining a function or variable.&nbsp; In this case the resulting string might not be able to be correctly linked to the correct variable or function name during the
  process.&nbsp; This only affects certain AutoIt3 functions:</p>
  <div class="c6">
    AdlibRegister()
  </div>
  <div class="c6">
    AdlibUnRegister()
  </div>
  <div class="c6">
    Call()
  </div>
  <div class="c6">
    Eval()
  </div>
  <div class="c6">
    Execute()
  </div>
  <div class="c6">
    GUIRegisterMsg()
  </div>
  <div class="c6">
    GUISetOnEvent()
  </div>
  <div class="c6">
    GUICtrlSetOnEvent()
  </div>
  <div class="c6">
    TrayItemSetOnEvent()
  </div>
  <div class="c6">
    HotKeySet()
  </div>
  <div class="c6">
    IsDeclared()
  </div>
  <div class="c6">
    ObjEvent()
  </div>
  <p class="c5">&#183;&nbsp;&nbsp; &nbsp;A parameter contains an Ampersand (&amp;) - as the parameter is concatenated from other variables/strings it too might not be correctly linked.&nbsp;</p>
  <p class="c4">&#183;&nbsp;&nbsp; &nbsp;&nbsp;Produce an Au3Stripper.log which contains all information about the conversion process in case of problems.</p>
  <div class="c2">
    <h2>Supported commandline or compiler directive options:</h2>
  </div>
  <div class="c2">
    The following parameters can be passed on the command line or within the script via the #Au3Stripper_Parameters= directive:
  </div>
  <div class="c2">
    &nbsp;&nbsp;
  </div>
  <table class="c9 c1" border="1" bordercolor="#050000">
    <tbody>
      <tr>
        <td class="c8" valign="top">
          <div class="c2">
            /TraceLog
          </div>
          <div class="c2">
            /TL
          </div>
        </td>
        <td class="c8" valign="top">
          <div class="c2">
            Create Au3Stripper.Log with a trace of all actions.
          </div>
        </td>
      </tr>
      <tr>
        <td class="c8" height="14" valign="top">
          <div class="c2">
            /debug
          </div>
        </td>
        <td class="c8" height="14" valign="top">
          <div class="c2">
            Create Au3stripper.Log and a sourcecode resultfile per iteration: Au3Stripper-Iteration-?.au3.<br>
          </div>
        </td>
      </tr>
      <tr>
        <td class="c8" valign="top">
          <div class="c2">
            /PreExpand
          </div>
          <div class="c2">
            /PE
          </div>
        </td>
        <td class="c8" valign="top">
          <div class="c2">
            Replace any reference to a Global Const variable with its actual value.
          </div>
        </td>
      </tr>
      <tr>
        <td class="c8" valign="top">
          <div class="c2">
            /StripOnly
          </div>
          <div class="c2">
            /SO
          </div>
        </td>
        <td class="c8" valign="top">
          <div class="c2">
            Set the options to:/SF=1 /SV=1 which is now also the default when no parameters are specified.
          </div>
        </td>
      </tr>
      <tr>
        <td class="c8" valign="top">
          <div class="c2">
            /StripUnusedFunc=0/1
          </div>
          <div class="c2">
            /SF=0/1
          </div>
        </td>
        <td class="c8" valign="top">
          <div class="c2">
            Strip unused Funcs (Default = 1)
          </div>
        </td>
      </tr>
      <tr>
        <td class="c8" valign="top">
          <div class="c2">
            /StripUnusedVars=0/1
          </div>
          <div class="c2">
            /SV=0/1
          </div>
        </td>
        <td class="c8" valign="top">
          <div class="c2">
            Strip unused Global and Local variable declarations (Default = 1)
          </div>
        </td>
      </tr>
      <tr>
        <td class="c8" valign="top">
          <div class="c2">
            /MergeOnly
          </div>
          <div class="c2">
            /MO
          </div>
        </td>
        <td class="c8" valign="top">
          <div class="c2">
            Will produce a scriptfile as AUT2EXE includes in the Compiled EXE. This allows you to find the proper linenumber when errors are reported.<br>
            Note: Make sure you remove the #pragma lines or else the linenumbers will be off by the that number of records<br>
          </div>
        </td>
      </tr>
      <tr>
        <td class="c8" valign="top">
          <div class="c2">
            /MaxIterations
          </div>
          <div class="c2">
            /MI
          </div>
        </td>
        <td class="c8" valign="top">Sets the maximum Iterations Au3Stripper will perform. Default is 5.<br></td>
      </tr>
      <tr>
        <td class="c8" height="30" valign="top">
          <div class="c2">
            /RenameMinimum
          </div>
          <div class="c2">
            /RM
          </div>
        </td>
        <td class="c8" height="30" valign="top">
          <div class="c2">
            Generates a much smaller file by substituting function and variable names with unique 2+-character names
          </div>
        </td>
      </tr>
      <tr>
        <td class="c8" valign="top">
          <div class="c2">
            /ShowConsoleInfo=0/1/9
          </div>
          <div class="c2">
            /SCI=0/1/9
          </div>
        </td>
        <td class="c8" valign="top">
          <div class="c2">
            0 = (Default) Minimal output to the console - only warnings and errors.
          </div>
          <div class="c2">
            1 = Show more progress information
          </div>
          <div class="c2">
            9 = Show all debug lines as found in the Au3Stripper.log.
          </div>
        </td>
      </tr>
      <tr>
        <td class="c8" height="14" valign="top">
          <div class="c2">
            /rsln
          </div>
        </td>
        <td class="c8" height="14" valign="top">
          <div class="c2">
            Replace @ScriptLineNumber with the actual line number in the merged source. This is for debug purposes with compiled scripts. All master lines will show 2 numbers in the format xxx/yyy where xxx is the original master script line number and
            yyy the merged script line number.
          </div>
        </td>
      </tr>
      <tr>
        <td class="c8" height="14" valign="top">
          <div class="c2">
            /Beta
          </div>
        </td>
        <td class="c8" height="14" valign="top">
          <div class="c2">
            Use the ...\AutoIt\Beta\Include files if installed
          </div>
        </td>
      </tr>
    </tbody>
  </table>
  <div class="c2">
    <br>
    <a name="directives"></a>The directives used within the script to control Au3Stripper are as follows:<br>
  </div>
  <div class="c10">
    <span class="c2">#AutoIt3Wrapper_Run_Au3Stripper=y&nbsp;</span>&nbsp;&nbsp;&nbsp;Run Au3Stripper before compilation (Default=n)
  </div>
  <div class="c10">
    <span class="c2">#Au3Stripper_Parameters=</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Use the parameters as listed above
  </div>
  <div class="c10">
    <span class="c2">#Au3Stripper_Off</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stop
    the Stripping process below this line
  </div>
  <div class="c10">
    <span class="c2">#Au3Stripper_On&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Start
    the Stripping process below this line
  </div>
  <div class="c10">
    <span class="c2">#Au3Stripper</span><span class="c2">_AlwaysStrip</span><span class="c2">_Off</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stop the Stripping ALL LINES process
  </div>
  <div class="c10">
    <span class="c2">#Au3Stripper</span><span class="c2">_AlwaysStrip</span><span class="c2">_On&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Start the Stripping ALL LINES from here
  </div>
  <div class="c10">
    <span class="c2">#Au3Stripper_Ignore_Funcs=&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Do not Strip these functions. FuncNames may end with an * to indicated matching FuncNames starting
    with the specified string.<br>
  </div>
  <div class="c10">
    <span class="c2">#Au3Stripper_Ignore_Variables=</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Do not Strip these variables. VarNames may end with an * to indicated matching VarNames starting with the specified string.
  </div>
  <div class="c2">
    <h2>Running Au3Stripper</h2>
  </div>
  <div class="c2">
    Au3Stripper&nbsp;can be run:
  </div>
  <div class="c10">
    <h3>Manually.&nbsp;</h3>
  </div>
  <div class="c10">
    Add these lines to the UserOptions file accessed via the &lt;Options&gt; menu within SciTE:
  </div>
  <div class="c11">
    command.46.*.au3="$(SciteDefaultHome)\au3Stripper\Au3Stripper.exe" "$(FilePath)"
  </div>
  <div class="c11">
    command.name.46.au3=Au3Stripper
  </div>
  <div class="c11">
    command.save.before.46.*.au3=1
  </div>
  <div class="c11">
    command.is.filter.46.*.au3=1
  </div>
  <div class="c10">
    Au3Stripper&nbsp;will now appear as a &lt;Tools&gt; menu item. Note the command number may have to be adjusted - see <a href="SciTE4AutoIt3-user-options-file.html">here</a> for more details.
  </div>
  <div class="c10">
    <h3>Batch:</h3>
  </div>
  <div class="c11">
    Au3Stripper.exe Scriptname.au3
  </div>
  <div class="c10">
    <h3>From within SciTE:</h3>
  </div>
  <div class="c10">
    If the&nbsp;#AutoIt3Wrapper_Run_Au3Stripper=y directive is added to the script then AutoIt3Wrapper will do the following:
  </div>
  <ul class="c12">
    <li>Run Au3Check against the original script</li>
    <li>If there are no errors, run Au3Stripper to create an Stripped source file Scriptname_Stripped in the same folder containing all the source (the script and any #include files)</li>
    <li>Run Au3Check on the Stripped file to ensure that no problems were caused during the process</li>
    <li>Run Aut2Exe to compile the Stripped file to create the executable file</li>
  </ul><br>
  <p class="c13"><br></p>
  <div class="c2">
    &nbsp;&nbsp;
  </div>
</body>
</html>
