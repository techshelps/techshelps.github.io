<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Adding data to the program resources</title>
  <meta name="generator" content="HelpMaker">
  <meta name="keywords" content="AutoIt3Wrapper">
  <link rel="stylesheet" type="text/css" href="hm.css">
  <style type="text/css">
body {
  background-color: #FFFCEA;
  }
  span.c20 { font-size:10pt; font-family:Courier New; color:#000080}
  span.c19 { font-size:10pt; font-family:Arial; color:#000000}
  span.c18 { font-size:12pt; font-family:Arial; color:#000000}
  span.c17 { font-size:9pt; font-family:Courier New; color:#010101}
  div.c16 {margin-bottom: 0.00mm; margin-left: 13mm; margin-right: 0mm; margin-top: 0.00mm; text-align: left; text-indent: 0mm}
  span.c15 { font-size:10pt; font-family:Courier New; color:#010101}
  span.c14 { font-size:10pt; font-family:Arial; color:#010101}
  span.c13 { font-size:16pt; font-family:Courier New; color:#008000}
  span.c12 { font-size:10pt; font-family:Courier New; color:#ff0000}
  span.c11 { font-size:10pt; font-family:Courier New; color:#000090}
  span.c10 { font-size:10pt; font-family:Courier New; color:#ff8000}
  span.c9 { font-size:10pt; font-family:Courier New; color:#5a5a5a}
  span.c8 { font-size:10pt; font-family:Courier New; color:#0000ff}
  span.c7 { font-size:10pt; font-family:Courier New; color:#dc143c}
  span.c6 { font-size:10pt; font-family:Courier New; color:#008000}
  span.c5 { font-size:10pt; font-family:Courier New; color:#000000}
  span.c4 { font-size:12pt; font-family:Arial; color:#010101}
  table.c3 {background-color: #C0C0C0}
  div.c2 {text-align: left}
  span.c1 {font-size:16pt; font-family:Arial; color:#8b0000}
  </style>
</head>
<body>
  <table class="c3" border="0" cellpadding="2" cellspacing="0" width="100%">
    <tbody>
      <tr>
        <td align="left">
          <div class="c2">
            <span class="c1">Adding data to the program resources</span>
          </div>
        </td>
        <td align="right"><a href="adding-extra-icons-to-the-program-resources.html">Previous</a>&nbsp;<a href="Introduction.html">Top</a>&nbsp;<a href="Versioning_with_SVN.html">Next</a></td>
      </tr>
    </tbody>
  </table>
  <hr>
  <div class="c2">
    <span class="c4"><strong>Adding a sound:</strong></span>
  </div>
  <div class="c2">
    <span class="c5"><br></span>
  </div>
  <div class="c2">
    <span class="c6"><em>; Example - Adding a sound file</em></span>
  </div>
  <div class="c2">
    <span class="c5"><br></span>
  </div>
  <div class="c2">
    <span class="c6"><em>; Add the file</em></span>
  </div>
  <div class="c2">
    <span class="c7">#AutoIt3Wrapper_Res_File_Add=C:\WINDOWS\Media\tada.wav, SOUND, MYWAV</span>
  </div>
  <div class="c2">
    <span class="c5"><br></span>
  </div>
  <div class="c2">
    <span class="c8">Global</span> <span class="c8">Const</span> <span class="c9">$SND_RESOURCE</span> <span class="c10">=</span> <span class="c8">0x00040004</span>
  </div>
  <div class="c2">
    <span class="c8">Global</span> <span class="c8">Const</span> <span class="c9">$SND_ASYNC</span> <span class="c10">=</span> <span class="c8">1</span>
  </div>
  <div class="c2">
    <span class="c5"><br></span>
  </div>
  <div class="c2">
    <span class="c6"><em>; Play the file - the script will pause as it sounds</em></span>
  </div>
  <div class="c2">
    <span class="c11">DllCall</span><span class="c10">(</span><span class="c12">"winmm.dll"</span><span class="c10">,</span> <span class="c12">"int"</span><span class="c10">,</span> <span class="c12">"PlaySound"</span><span class="c10">,</span>
    <span class="c12">"str"</span><span class="c10">,</span> <span class="c12">"MYWAV"</span><span class="c10">,</span> <span class="c12">"hwnd"</span><span class="c10">,</span> <span class="c8">0</span><span class="c10">,</span> <span class=
    "c12">"int"</span><span class="c10">,</span> <span class="c9">$SND_RESOURCE</span><span class="c10">)</span>
  </div>
  <div class="c2">
    <span class="c6"><em>; Play the file again, but this time the script continues</em></span>
  </div>
  <div class="c2">
    <span class="c11">DllCall</span><span class="c10">(</span><span class="c12">"winmm.dll"</span><span class="c10">,</span> <span class="c12">"int"</span><span class="c10">,</span> <span class="c12">"PlaySound"</span><span class="c10">,</span>
    <span class="c12">"str"</span><span class="c10">,</span> <span class="c12">"MYWAV"</span><span class="c10">,</span> <span class="c12">"hwnd"</span><span class="c10">,</span> <span class="c8">0</span><span class="c10">,</span> <span class=
    "c12">"int"</span><span class="c10">,</span> <span class="c11">BitOR</span><span class="c10">(</span><span class="c9">$SND_RESOURCE</span><span class="c10">,</span> <span class="c9">$SND_ASYNC</span><span class="c10">))</span>
  </div>
  <div class="c2">
    <span class="c5"><br></span>
  </div>
  <div class="c2">
    <span class="c8">For</span> <span class="c9">$n</span> <span class="c10">=</span> <span class="c8">1</span> <span class="c8">To</span> <span class="c8">100</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c11">Sleep</span><span class="c10">(</span><span class="c8">15</span><span class="c10">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c11">ToolTip</span><span class="c10">(</span><span class="c12">"Asynch! "</span> <span class="c10">&amp;</span> <span class="c9">$n</span><span class="c10">)</span>
  </div>
  <div class="c2">
    <span class="c8">Next</span>
  </div>
  <div class="c2">
    <span class="c13"><em><br></em></span>
  </div>
  <div class="c2">
    <span class="c4"><strong>Adding a string:</strong></span>
  </div>
  <div class="c2">
    <span class="c4"><br></span>
  </div>
  <div class="c2">
    <span class="c14">First create a file like this:</span>
  </div>
  <div class="c2">
    <span class="c14"><br></span>
  </div>
  <div class="c16">
    <span class="c15"># string ID = WORD (16 bits):<br>
    # first 4 bits = string index in the block, 0-15<br>
    # top 12 bits = block ID - 1<br>
    # blocks must start at 1, so top 12 bits equal to 0 is block 1<br>
    #<br>
    # the section heading is the language to update<br>
    # be aware that AutoIt uses several string blocks in the UK language 2057 for built-in strings<br>
    #<br>
    [0]<br>
    0=first string in first block<br>
    1=second string in first block<br>
    15=last string in first block<br>
    32=first string in third block<br>
    33=second string in third block<br>
    <br>
    [2057]<br>
    0=this is UK string 1<br>
    1=this is UK string 2</span>
  </div>
  <div class="c2">
    <span class="c14"><br></span>
  </div>
  <div class="c2">
    <span class="c14">And save it as</span> <span class="c17">"test_rt_string.ini"</span> <span class="c14">in the same folder as the script.&nbsp; You can then add it to the resources like this:</span>
  </div>
  <div class="c2">
    <span class="c5"><br></span>
  </div>
  <div class="c2">
    <span class="c7">#AutoIt3Wrapper_Res</span><span class="c12">_File_Add=test_rt_string.ini, RT_STRING</span>
  </div>
  <div class="c2">
    <span class="c6"><br></span>
  </div>
  <div class="c2">
    <span class="c18"><strong>Adding a file:</strong></span>
  </div>
  <div class="c2">
    <span class="c5"><br></span>
  </div>
  <div class="c2">
    <span class="c19">Files are stored in the RT_RCDATA section and are usually stored byte for byte.&nbsp; If the section value is set to -10 (RT_RCDATA is internally evaluated as 10) then the file is compressed before being added:</span>
  </div>
  <div class="c2">
    <span class="c5"><br></span>
  </div>
  <div class="c2">
    <span class="c12">#AutoIt3Wrapper_Res_File_Add=file_name, RT_RCDATA</span><span class="c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: UNCOMPRESSED</span>
  </div>
  <div class="c2">
    <span class="c12">#AutoIt3Wrapper_Res_File_Add=file_name, 10</span><span class="c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; UNCOMPRESSED</span>
  </div>
  <div class="c2">
    <span class="c12">#AutoIt3Wrapper_Res_File_Add=file_name, -10</span><span class="c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; COMPRESSED</span>
  </div>
  <div class="c2">
    <span class="c5"><br></span>
  </div>
  <div class="c2">
    <span class="c19">When the file is required it can be extracted using this code. Set the <em>$isCompressed</em> parameter to match the <em>Res_File_Add</em> directive:</span>
  </div>
  <div class="c2">
    <span class="c5"><br></span>
  </div>
  <div class="c2">
    <span class="c5">#include</span> <span class="c12">&lt;WinAPIRes.au3&gt;</span>
  </div>
  <div class="c2">
    <span class="c5">#include</span> <span class="c12">&lt;WinAPIInternals.au3&gt;</span>
  </div>
  <div class="c2">
    <span class="c5"><br></span>
  </div>
  <div class="c2">
    <span class="c20">Func</span> <span class="c5">_FileInstallFromResource</span><span class="c12">(</span><span class="c5">$sResName</span><span class="c12">,</span> <span class="c5">$sDest</span><span class="c12">,</span> <span class=
    "c5">$isCompressed</span> <span class="c12">=</span> <span class="c8">False</span><span class="c12">,</span> <span class="c5">$iUncompressedSize</span> <span class="c12">=</span> <span class="c8">Default</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">Local</span> <span class="c5">$bBytes</span> <span class="c12">=</span> <span class="c5">_GetResourceAsBytes</span><span class="c12">(</span><span class="c5">$sResName</span><span class=
    "c12">,</span> <span class="c5">$isCompressed</span><span class="c12">,</span> <span class="c5">$iUncompressedSize</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">If</span> <span class="c5">@error</span> <span class="c8">Then Return</span> <span class="c20">SetError</span><span class="c12">(</span><span class="c5">@error</span><span class=
    "c12">,</span> <span class="c8">0</span><span class="c12">,</span> <span class="c8">0</span><span class="c5">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c20">FileDelete</span><span class="c12">(</span><span class="c5">$sDest</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c20">FileWrite</span><span class="c12">(</span><span class="c5">$sDest</span><span class="c12">,</span> <span class="c5">$bBytes</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c8">EndFunc</span>
  </div>
  <div class="c2">
    <span class="c5"><br></span>
  </div>
  <div class="c2">
    <span class="c8">Func</span> <span class="c5">_GetResourceAsBytes</span><span class="c12">(</span><span class="c5">$sResName</span><span class="c12">,</span> <span class="c5">$isCompressed</span> <span class="c12">=</span> <span class=
    "c8">False</span><span class="c12">,</span> <span class="c5">$iUncompressedSize</span> <span class="c12">=</span> <span class="c8">Default</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5"><br></span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">Local</span> <span class="c5">$hMod</span> <span class="c12">=</span> <span class="c8">_WinAPI_GetModuleHandle</span><span class="c12">(</span><span class="c8">Null</span><span class=
    "c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">Local</span> <span class="c5">$hRes</span> <span class="c12">=</span> <span class="c8">_WinAPI_FindResource</span><span class="c12">(</span><span class="c5">$hMod</span><span class=
    "c12">,</span> <span class="c8">10</span><span class="c12">,</span> <span class="c5">$sResName</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">If</span> <span class="c5">@error</span> <span class="c8">Or Not</span> <span class="c5">$hRes</span> <span class="c8">Then Return</span> <span class="c20">SetError</span><span class=
    "c12">(</span><span class="c8">1</span><span class="c12">,</span> <span class="c8">0</span><span class="c12">,</span> <span class="c8">0</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">Local</span> <span class="c5">$dSize</span> <span class="c12">=</span> <span class="c8">_WinAPI_SizeOfResource</span><span class="c12">(</span><span class="c5">$hMod</span><span class=
    "c12">,</span> <span class="c5">$hRes</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">If</span> <span class="c5">@error</span> <span class="c8">Or Not</span> <span class="c5">$dSize</span> <span class="c8">Then Return</span> <span class="c20">SetError</span><span class=
    "c12">(</span><span class="c8">2</span><span class="c12">,</span> <span class="c8">0</span><span class="c12">,</span> <span class="c8">0</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">Local</span> <span class="c5">$hLoad</span> <span class="c12">=</span> <span class="c8">_WinAPI_LoadResource</span><span class="c12">(</span><span class="c5">$hMod</span><span class=
    "c12">,</span> <span class="c5">$hRes</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">If</span> <span class="c5">@error</span> <span class="c8">Or Not</span> <span class="c5">$hLoad</span> <span class="c8">Then Return</span> <span class="c20">SetError</span><span class=
    "c12">(</span><span class="c8">3</span><span class="c12">,</span> <span class="c8">0</span><span class="c12">,</span> <span class="c8">0</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">Local</span> <span class="c5">$pData</span> <span class="c12">=</span> <span class="c8">_WinAPI_LockResource</span><span class="c12">(</span><span class="c5">$hLoad</span><span class=
    "c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">If</span> <span class="c5">@error</span> <span class="c8">Or Not</span> <span class="c5">$pData</span> <span class="c8">Then Return</span> <span class="c20">SetError</span><span class=
    "c12">(</span><span class="c8">4</span><span class="c12">,</span> <span class="c8">0</span><span class="c12">,</span> <span class="c8">0</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">Local</span> <span class="c5">$tBuffer</span> <span class="c12">=</span> <span class="c20">DllStructCreate(</span><span class="c12">"byte[" &amp;</span> <span class="c5">$dSize</span>
    <span class="c12">&amp; "]")</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">_WinAPI_MoveMemory</span><span class="c12">(</span><span class="c20">DllStructGetPtr</span><span class="c12">(</span><span class="c5">$tBuffer</span><span class="c12">),</span> <span class=
    "c5">$pData</span><span class="c12">,</span> <span class="c5">$dSize</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">If</span> <span class="c5">$isCompressed</span> <span class="c8">Then</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <span class="c8">Local</span> <span class="c5">$oBuffer</span>
  </div>
  <div class="c2">
    <span class="c8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _WinAPI_LZNTDecompress</span><span class="c12">(</span><span class="c5">$tBuffer</span><span class="c12">,</span> <span class="c5">$oBuffer</span><span class="c12">,</span> <span class=
    "c5">$iUncompressedSize</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <span class="c8">If</span> <span class="c5">@error</span> <span class="c8">Then Return</span> <span class="c20">SetError</span><span class="c12">(</span><span class=
    "c8">5</span><span class="c12">,</span> <span class="c8">0</span><span class="c12">,</span> <span class="c8">0</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tBuffer</span> <span class="c12">=</span> <span class="c5">$oBuffer</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">EndIf</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">Return</span> <span class="c20">DllStructGetData</span><span class="c12">(</span><span class="c5">$tBuffer</span><span class="c12">,</span> <span class="c8">1</span><span class=
    "c12">)</span>
  </div>
  <div class="c2">
    <span class="c8">EndFunc</span>
  </div>
  <div class="c2">
    <span class="c5"><br></span>
  </div>
  <div class="c2">
    <span class="c5">Func _WinAPI_LZNTDecompress</span><span class="c12">(</span><span class="c8">ByRef</span> <span class="c5">$tInput</span><span class="c12">,</span> <span class="c8">ByRef</span> <span class="c5">$tOutput</span><span class=
    "c12">,</span> <span class="c5">$iUncompressedSize</span> <span class="c12">=</span> <span class="c8">Default</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c6">&nbsp;&nbsp;&nbsp; ; if no uncompressed size given, use 16x the input buffer</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">If</span> <span class="c5">$iUncompressedSize</span> <span class="c12">=</span> <span class="c8">Default Then</span> <span class="c5">$iUncompressedSize</span> <span class="c12">=</span>
    <span class="c8">16</span> <span class="c12">*</span> <span class="c20">DllStructGetSize</span><span class="c12">(</span><span class="c5">$tInput</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">Local</span> <span class="c5">$tBuffer</span><span class="c12">,</span> <span class="c5">$ret</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp; $tOutput</span> <span class="c12">=</span> <span class="c8">0</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp; $tBuffer</span> <span class="c8">=</span> <span class="c20">DllStructCreate</span><span class="c12">("byte[" &amp;</span> <span class="c5">$iUncompressedSize</span> <span class="c12">&amp; "]")</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">If</span> <span class="c5">@error</span> <span class="c8">Then Return</span> <span class="c20">SetError</span><span class="c12">(</span><span class="c8">1</span><span class="c12">,</span>
    <span class="c8">0</span><span class="c12">,</span> <span class="c8">0</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp; $ret</span> <span class="c12">=</span> <span class="c20">DllCall</span><span class="c12">("ntdll.dll", "long", "RtlDecompressBuffer", "ushort",</span> <span class="c8">2</span><span class="c12">, "struct*",</span>
    <span class="c5">$tBuffer</span><span class="c12">, "ulong",</span> <span class="c5">$iUncompressedSize</span><span class="c12">, "struct*",</span> <span class="c5">$tInput</span><span class="c12">, "ulong",</span> <span class=
    "c20">DllStructGetSize</span><span class="c12">(</span><span class="c5">$tInput</span><span class="c12">), "ulong*",</span> <span class="c8">0</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">If</span> <span class="c5">@error</span> <span class="c8">Then Return</span> <span class="c20">SetError</span><span class="c12">(</span><span class="c8">2</span><span class="c12">,</span>
    <span class="c8">0</span><span class="c12">,</span> <span class="c8">0</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">If</span> <span class="c5">$ret</span><span class="c12">[</span><span class="c8">0</span><span class="c12">]</span> <span class="c8">Then Return</span> <span class=
    "c20">SetError</span><span class="c12">(</span><span class="c8">3</span><span class="c12">,</span> <span class="c5">$ret</span><span class="c12">[</span><span class="c8">0</span><span class="c12">],</span> <span class="c8">0</span><span class=
    "c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp; $tOutput</span> <span class="c12">=</span> <span class="c20">DllStructCreate</span><span class="c12">("byte[" &amp;</span> <span class="c5">$ret</span><span class="c12">[</span><span class="c8">6</span><span class=
    "c12">] &amp; "]")</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">If Not _WinAPI_MoveMemory</span><span class="c12">(</span><span class="c20">DllStructGetPtr</span><span class="c12">(</span><span class="c5">$tOutput</span><span class="c12">),</span>
    <span class="c8">DllStructGetPtr</span><span class="c12">(</span><span class="c5">$tBuffer</span><span class="c12">),</span> <span class="c5">$ret</span><span class="c12">[</span><span class="c8">6</span><span class="c12">])</span> <span class=
    "c8">Then</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $tOutput</span> <span class="c12">=</span> <span class="c8">0</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <span class="c8">Return</span> <span class="c20">SetError</span><span class="c12">(</span><span class="c8">4</span><span class="c12">,</span> <span class="c8">0</span><span class=
    "c12">,</span> <span class="c8">0</span><span class="c12">)</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">EndIf</span>
  </div>
  <div class="c2">
    <span class="c5">&nbsp;&nbsp;&nbsp;</span> <span class="c8">Return</span> <span class="c5">$ret</span><span class="c12">[</span><span class="c8">6</span><span class="c12">]</span>
  </div>
  <div class="c2">
    <span class="c8">EndFunc</span>
  </div>
</body>
</html>
