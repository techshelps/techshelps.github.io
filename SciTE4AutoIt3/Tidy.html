<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Tidy</title>
  <meta name="generator" content="HelpMaker">
  <meta name="keywords" content="Tidy">
  <link rel="stylesheet" type="text/css" href="hm.css">
  <style type="text/css">
body.c11 {background-color: rgb(255, 252, 234);}
  table.c10 {text-align: left; width: 837px; height: 672px;}
  span.c9 {font-weight: bold;}
  table.c8 {text-align: left; width: 100%;}
  span.c7 {font-weight: 400; background-color: rgb(255, 255, 255); background-position: 0% 50%;}
  span.c6 {font-weight: 400;}
  big.c5 {font-weight: bold;}
  big.c4 {color: rgb(153, 51, 153); font-weight: bold;}
  p.c3 {margin: 1.76mm 0mm; text-indent: 0mm;}
  div.c2 {text-align: left}
  table.c1 {background-color: #C0C0C0}
  </style>
  <style type="text/css">
div.c6 {margin-left: 40px;}
  span.c5 {font-style: italic; font-weight: normal;}
  span.c4 {color: red;}
  span.c3 {color: rgb(153, 51, 153);}
  em.c2 {color: rgb(0, 0, 153);}
  span.c1 {font-style: italic; color: rgb(0, 0, 153);}
  </style>
</head>
<body class="c11">
  <table class="c1" border="0" cellpadding="2" cellspacing="0" width="100%">
    <tbody>
      <tr>
        <td align="left">
          <h1>Tidy</h1>
        </td>
        <td align="right"><a href="Au3Stripper.html">Previous</a>&nbsp;<a href="Introduction.html">Top</a>&nbsp;<a href="SciTEConfig.html">Next</a></td>
      </tr>
    </tbody>
  </table>
  <hr>
  <h2>Tidy functions</h2>Tidy can do all or any of the following
  <ul>
    <li>Clean up the indentation with either spaces or Tabs (use <a href="SciTEConfig.html">SciTEConfig</a> to select which).</li>
    <li>Change all Functions/Keywords/Macros to proper case as defined in the configuration files</li>
    <li>All user functions and all Func definitions in the script are loaded into the Functions table. This option only works in combination with the previous option.</li>
    <li>Standardize all variable names to uppercase, lowercase or as capitalised at the first declaration/occurrence</li>
    <li>Add a space or remove additional spaces around operators/keywords/functions.</li>
    <li>Remove empty lines.</li>
    <li>Remove trailing spaces.</li>
    <li>Add the function name as a comment after EndFunc to identity which Func ends at that point</li>
    <li>Generate a Documentation file with program logic and Xref reports for Variables and UDF's.</li>
    <li>Check for coding errors like missing EndIf/WEnd or defining a Func inside a loop.</li>
    <li>Sort all Func-EndFunc blocks in alphabetical order limited by #region-#endregion blocks if used</li>
  </ul>
  <div class="c2">
    <br>
  </div>
  <div class="c2">
    Example 1 - Standard indentation and capitalisation:
  </div>
  <div class="c2">
    <br>
  </div>
  <div class="c2"><img src="Tidyb1.PNG" alt="graphic" border="0"><img src="Tidyb2.PNG" alt="graphic" border="0"></div>
  <div class="c2">
    <br>
  </div>
  <div class="c2">
    Example 2 - Simple syntax Check:
  </div>
  <div class="c2">
    <br>
  </div>
  <div class="c2"><img src="Tidyb3.PNG" alt="graphic" border="0"><img src="Tidyb4.PNG" alt="graphic" border="0"></div>
  <p class="c3">If it finds a syntax problem, Tidy will insert warning comments as shown below and indicate the number of errors found in the lower pane of the editor. In this case the End If is incorrectly spelt and so does not close the If before the
  Func starts. When the error is fixed, just run Tidy again and all the inserted lines will be removed automatically.&nbsp; If multiple errors are shown, always start by fixing the first one and rerunning Tidy as the subsequent errors may flow from an
  incorrect structure earlier in the script as in the example shown.</p>
  <h2>Running Tidy</h2>
  <p class="c3">Tidy can be run in several ways:</p>
  <p>From within SciTE by pressing Ctrl-T</p>
  <p>Run Tidy.exe directly and a dialog will ask for the input file<br></p>
  <p>Right-click on an .au3 file and select Tidy (if the full SciTE4AutoIt3 package has been installed)</p>
  <h2><a name="directives" id="directives"></a>Setting Tidy options</h2>Tidy default options are set in Tidy.ini which is stored in folder <span class="c1">%LOCALAPPDATA%\AutoIt v3\SciTE\Tidy</span> <span class="c5">when using the Installer version and
  <em class="c2">...\AutoIt3\SciTE\Tidy</em>&nbsp; for the portable version</span>.&nbsp;<br>
  Use these directives to disable tidy for a block of code:<br>
  <big class="c4">#Tidy_Off&nbsp;<br>
  #Tidy_On<br></big> Use this&nbsp;directives to set the inline comment column to a fix column going forward, use 0 to use the current column again:<br>
  <big class="c5"><span class="c3">#Tidy_ILC_Pos=nn<br></span></big><br>
  <big class="c5"><span class="c3">#Tidy_Parameters=<br></span></big> <big class="c5">These settings can be overridden by specifying the below parameters on the Tidy commandline or&nbsp; <span class="c3">#Tidy_Parameters</span> Directive in the
  script:</big>
  <table class="c8" border="1" cellpadding="2" cellspacing="2">
    <tbody>
      <tr>
        <td>
          <p><strong>/proper <span class="c6">or</span> /pr=0/<span class="c4">1</span><br>
          /properconstants or /prc=0/<span class="c4">1</span><br>
          /updatevars or /uv=1/2/<span class="c4">3</span></strong><br>
          <strong>/tabchar <span class="c6">or</span> /tc=0<br>
          /gen_doc <span class="c6">or</span> /gd<br>
          /r_empty_lines <span class="c6">or</span> /rel&nbsp;<br>
          /r_extra_empty_lines <span class="c6">or</span> /reel&nbsp;<br>
          /showconsoleinfo=0/<span class="c4">1</span>/9 <span class="c6">or</span> /sci=0/<span class="c4">1</span>/9<br>
          /gen_doc_show <span class="c6">or</span> /gds<br>
          /showdiffpgm=xyz.exe</strong><strong>"%new%" "%old%"</strong> <strong><span class="c6">or</span> /sdp=xyz.exe</strong><strong>"%new%" "%old%"</strong><strong><br>
          /noshowdiffpgm <span class="c6">or</span> /nsdp<br>
          /keepnversions=<span class="c6"><em>n</em></span> <span class="c6">or</span> /kv=<span class="c6"><em>n<br></em></span>/backupdir=<span class="c5">directory</span> <span class="c6">or</span> /bdir=<span class=
          "c6"><em>directory</em></span><em><span class="c6"><br></span></em> /Tidy_commentblock <span class="c6">or</span> /tcb</strong></p>
          <div class="c6">
            <strong>/tcb=0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&gt;only indent the whole commentblock&nbsp; (default)</strong><br>
            <strong>/tcb&nbsp; or /tcb=1 =&gt;Tidy inside commentblock</strong><br>
            <strong>/tcb=-1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&gt;leave whole commentbock alone</strong><br>
          </div>
          <p><strong>/Skip_CE_Comment <span class="c6">or</span> /scec</strong><br>
          <strong>/Skip_EndFunc_Comment <span class="c6">or</span> /sefc<br></strong><strong>/Remove_EndFunc_comment&nbsp;or&nbsp;/refc<br></strong><strong>/Skip_EndRegion_Comment <span class="c6">or</span> /serc<br>
          /Region_Indent <span class="c6">or</span> /ri<br>
          <strong>/Remove_Endregion_Comment&nbsp;or&nbsp;/rerc<br>
          /Sort_Funcs <span class="c6">or</span> /sf<br></strong><strong>/Sort_Funcs_Comment <span class="c6">or</span> /sfc<br></strong><strong>/End_With_NewLine <span class="c6">or</span> /ewnl</strong></strong></p>
        </td>
      </tr>
    </tbody>
  </table><span class="c9"><br></span>There is an example ini file in the folder to serve as a template:<br>
  <h2>Setting Tidy's options (Tidy.ini):</h2>
  <table class="c10" border="1" cellpadding="2" cellspacing="2">
    <tbody>
      <tr>
        <td><span class="c9">[ProgramSettings]</span><br>
        #--&gt;Indent&nbsp; 0 = Tabs&nbsp; &gt;0 = Number of Space<br>
        tabchar=0<br>
        #--&gt;Define the TabSize size<br>
        tabsize=4<br>
        #--&gt;Update Functions/Keywords/Macros/UDFs to Proper case<br>
        proper=1<br>
        <br>
        &nbsp;* * * Update Constants defined in the "constant Include files"<br>
        properconstants=0<br>
        <br>
        #--&gt;Update Variables to: 1=UpperCase; 2=LowerCase; 3=First Dim/Local/Global or "First_Seen" Case<br>
        vars=3<br>
        <br>
        #--&gt;Update Spaces around Delimiters<br>
        delim=1<br>
        <br>
        #--&gt;Add comment to EndFunc statement e.g. "EndFunc&nbsp;&nbsp; ;==&gt;UDF_Name"<br>
        endfunc_comment=1<br>
        #--&gt;Ingnore EndFunc statement comments.<br>
        #~ endfunc_comment=0<br>
        #--&gt;Remove comments from EndFunc statement.<br>
        #~ endfunc_comment=-1<br>
        <br>
        #--&gt;Add comment to EndRegion and make it the same as the #Region Comments.<br>
        endregion_comment=1<br>
        <br>
        #--&gt;Add comment to #CE/#CommentEnd and make it the same as the #CS/CommentStart Comments.<br>
        ce_comment=1<br>
        <br>
        #--&gt; Tidy commentblock 0=only indent the whole commentblock&nbsp; (default=0)<br>
        #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 1=Tidy inside commentblock<br>
        #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -1=leave whole commentbock alone<br>
        Tidy_commentblock=0<br>
        <br>
        #--&gt;Ignore EndFunc statement comments.<br>
        #~ endregion_comment=0<br>
        #--&gt;Remove comments from EndFunc statement.<br>
        #~ endregion_comment=-1<br>
        <br>
        #--&gt;Indent #region sections<br>
        region_indent=0<br>
        <br>
        #--&gt;Define the default column for inline comments, 0=keep current position<br>
        ilc_pos=0<br>
        <br>
        #--&gt;Generate Documentation file for the Program and optionally Display it with Notepad at the end ot the Tidy run<br>
        Gen_Doc=0<br>
        Gen_Doc_Show=0<br>
        <br>
        #--&gt; Keep x Version of the File before the Tidy run and optionally store them in SubDirectory "\Backup"<br>
        KeepNVersions=5<br>
        <br>
        #--&gt; Target backup directory which defaults to Scriptdir\Backup. Any other directory needs to exist or else it will use the default directory!<br>
        backupDir=<br>
        <br>
        #--&gt; Remove Empty lines from Script Source<br>
        Remove_Empty_Lines=<br>
        <br>
        #--&gt; 1=Show Tidy Errors in Console&nbsp;&nbsp; 9=Debug Output<br>
        ShowConsoleInfo=<br>
        <br>
        #--&gt; Run DIFF program at the end of the Tidy run to show the difference between original and new program.<br>
        #~ ShowDiffPgm=C:\Progra~1\WinMerge\winmerge.exe "%new%" "%old%"<br>
        <br>
        #--&gt; End With NewLine: 0=Strip Lastline CRLF;&nbsp;&nbsp; 1=Always end with CRLF (Default)<br>
        End_With_NewLine=1<br></td>
      </tr>
    </tbody>
  </table><span class="c9"><br></span><big><strong><br></strong></big>
</body>
</html>
