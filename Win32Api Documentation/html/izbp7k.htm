<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ScrollWindowEx</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="izbp7k"></A><B>ScrollWindowEx  <A HREF="4nirae.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="rps9no.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="42xsezb.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>ScrollWindowEx</B> function scrolls the content of the specified window's client area. This function is similar to the <B>ScrollWindow</B> function, but it has additional features. </P>

<P><B>int ScrollWindowEx(</B></P>

<TABLE cols=2 width=486>

<TR VALIGN="top">
<TD width=41%><B>HWND</B> <I>hWnd</I><B>,</B></TD>
<TD width=59%>// handle of window to scroll</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    int</B> <I>dx</I><B>,</B></TD>
<TD width=59%>// amount of horizontal scrolling</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    int</B> <I>dy</I><B>,</B></TD>
<TD width=59%>// amount of vertical scrolling</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    CONST RECT</B> <B>*</B><I>prcScroll</I><B>,</B></TD>
<TD width=59%>// address of structure with scroll rectangle</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    CONST RECT</B> <B>*</B><I>prcClip</I><B>,</B></TD>
<TD width=59%>// address of structure with clip rectangle</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    HRGN</B> <I>hrgnUpdate</I><B>,</B></TD>
<TD width=59%>// handle of update region</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    LPRECT</B> <I>prcUpdate</I><B>,</B></TD>
<TD width=59%>// address of structure for update rectangle</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    UINT</B> <I>flags</I> </TD>
<TD width=59%>// scrolling flags</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>   );</B></TD>
<TD width=59%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hWnd</I></P>

<P>Identifies the window where the client area is to be scrolled. </P>

<P><I>dx</I></P>

<P>Specifies the amount, in device units, of horizontal scrolling. This parameter must be a negative value to scroll to the left. </P>

<P><I>dy</I></P>

<P>Specifies the amount, in device units, of vertical scrolling. This parameter must be a negative value to scroll up. </P>

<P><I>prcScroll</I></P>

<P>Points to the <A HREF="ezena2.htm"><B>RECT</B></A> structure specifying the portion of the client area to be scrolled. If this parameter is NULL, the entire client area is scrolled. </P>

<P><I>prcClip</I></P>

<P>Points to the <B>RECT</B> structure containing the coordinates of the clipping rectangle. Only device bits within the clipping rectangle are affected. Bits scrolled from the outside of the rectangle to the inside are painted; bits scrolled from the inside of the rectangle to the outside are not painted. </P>

<P><I>hrgnUpdate</I></P>

<P>Identifies the region that is modified to hold the region invalidated by scrolling. This parameter may be NULL. </P>

<P><I>prcUpdate</I></P>

<P>Points to the <B>RECT</B> structure receiving the boundaries of the rectangle invalidated by scrolling. This parameter may be NULL. </P>

<P><I>flags</I></P>

<P>Specifies flags that control scrolling. This parameter can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=39%><B>Value</B></TD>
<TD width=61%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=39%>SW_ERASE</TD>
<TD width=61%>Erases the newly invalidated region by sending a WM_ERASEBKGND message to the window when specified with the SW_INVALIDATE flag.</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>SW_INVALIDATE</TD>
<TD width=61%>Invalidates the region identified by the <I>hrgnUpdate</I> parameter after scrolling.</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>SW_SCROLLCHILDREN</TD>
<TD width=61%>Scrolls all child windows that intersect the rectangle pointed to by the <I>prcScroll</I> parameter. The child windows are scrolled by the number of pixels specified by the <I>dx</I> and <I>dy</I> parameters. Windows sends a WM_MOVE message to all child windows that intersect the <I>prcScroll</I> rectangle, even if they do not move.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is SIMPLEREGION (rectangular invalidated region), COMPLEXREGION (nonrectangular invalidated region; overlapping rectangles), or NULLREGION (no invalidated region). </P>

<P>If the function fails, the return value is ERROR. </P>

<P><B>Remarks</B></P>

<P>If the SW_INVALIDATE and SW_ERASE flags are not specified, <B>ScrollWindowEx</B> does not invalidate the area that is scrolled from. If either of these flags is set, <B>ScrollWindowEx</B> invalidates this area. The area is not updated until the application calls the <A HREF="19g_54e.htm"><B>UpdateWindow</B></A> function, calls the <A HREF="jiztxu.htm"><B>RedrawWindow</B></A> function (specifying the RDW_UPDATENOW or RDW_ERASENOW flag), or retrieves the WM_PAINT message from the application queue. </P>

<P>If the window has the WS_CLIPCHILDREN style, the returned areas specified by <I>hrgnUpdate</I> and <I>prcUpdate</I> represent the total area of the scrolled window that must be updated, including any areas in child windows that need updating. </P>

<P>If the SW_SCROLLCHILDREN flag is specified, Windows does not properly update the screen if part of a child window is scrolled. The part of the scrolled child window that lies outside the source rectangle is not erased and is not properly redrawn in its new destination. To move child windows that do not lie completely within the rectangle specified by <I>prcScroll</I>, use the <B>DeferWindowPos</B> function. The cursor is repositioned if the SW_SCROLLCHILDREN flag is set and the caret rectangle intersects the scroll rectangle. </P>

<P>All input and output coordinates (for <I>prcScroll</I>, <I>prcClip</I>, <I>prcUpdate</I>, and <I>hrgnUpdate</I>) are determined as client coordinates, regardless of whether the window has the CS_OWNDC or CS_CLASSDC class style. Use the <B>LPtoDP</B> and <B>DPtoLP</B> functions to convert to and from logical coordinates, if necessary. </P>

<P><B>See Also</B></P>

<P><A HREF="17fgvwe.htm"><B>DeferWindowPos</B></A>, <A HREF="12b1hdv.htm"><B>DPtoLP</B></A>, <A HREF="h8phpf.htm"><B>LPtoDP</B></A>, <A HREF="ezena2.htm"><B>RECT</B></A>, <A HREF="jiztxu.htm"><B>RedrawWindow</B></A>, <A HREF="1q6a6xp.htm"><B>ScrollDC</B></A>, <A HREF="nz.wwx.htm"><B>ScrollWindow</B></A>, <A HREF="19g_54e.htm"><B>UpdateWindow</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
