<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Residuesd Objects</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="uolp23"></A><B>Residues</B></P>

<P>The initiator indicates whether it wants residues by setting the <I>pstgNewResidues</I> parameter to a valid address when calling the <A HREF="1tqatwu.htm"><B>IReconcilableObject::Reconcile</B></A> member function. If the reconciler does not support the creation of residues, it must return immediately the REC_E_NORESIDUES value, unless the <I>dwFlags</I> parameter specifies the RECONCILEF_NORESIDUESOK value.</P>

<P>The briefcase reconciler returns residues to the initiator by creating new storage elements and copying them to the array pointed to by <I>pstgNewResidues</I>. For structured storage residues, the reconciler copies an <B>IStorage</B> interface, and for flat storage residues, it copies either an <B>IStream</B> or <B>IStorage</B> interface with the STATEBITS_FLAT flag set. The reconciler uses <B>IStorage</B> to create the necessary storage, using <B>IStorage::CreateStream</B> to create flat storage for a residue that is a stream and <B>IStorage::CreateStorage</B> to create structured storage.</P>

<P>The initiator prepares <I>pstgNewResidues</I> such that it contains no elements in the nonreserved part of the <B>IStorage</B> namespace. The briefcase reconciler places each residue in an element whose name corresponds to the order of its initial version. For example, the first residue is contained in "1," the second in "2," and so on. If the reconciled object itself produces a residue, that is found in the element named "0." </P>

<P>The briefcase reconciler commits each of the newly created elements individually, ensuring that the initiator has access to the information. The reconciler does not, however, commit <I>pstgNewResidues</I> itself. The initiator is responsible for committing this or otherwise disposing of it.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
