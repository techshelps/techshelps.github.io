<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>SetServiceBits</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="_xo0ag"></A><B>SetServiceBits  <A HREF="139uxb..htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="12c8zrk.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="we4jtq.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>SetServiceBits</B> function registers a service's service type with the Service Control Manager and the Server service. The Server service can then announce the registered service type as one it currently supports. The LAN Manager functions <A HREF="9u8_wy.htm"><B>NetServerGetInfo</B></A> and <A HREF="69q..rn.htm"><B>NetServerEnum</B></A> obtain a specified machine's supported service types.</P>

<P>A service type is represented as a set of bit flags; the <B>SetServiceBits</B> function sets or clears combinations of those bit flags.</P>

<P><B>BOOL SetServiceBits(</B></P>

<TABLE cols=2 width=610>

<TR VALIGN="top">
<TD width=53%><B>SERVICE_STATUS_HANDLE </B><I>hServiceStatus</I><B>,</B></TD>
<TD width=47%>// service status handle</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>    DWORD </B><I>dwServiceBits</I><B>,</B></TD>
<TD width=47%>// service type bits to set or clear</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>    BOOL </B><I>bSetBitsOn</I><B>,</B></TD>
<TD width=47%>// flag to set or clear the service type bits</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>    BOOL</B> <I>bUpdateImmediately</I></TD>
<TD width=47%>// flag to announce server type immediately</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>   );</B></TD>
<TD width=47%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hServiceStatus</I></P>

<P>A handle to the Service Control Manager's status information structure for a service. A service obtains a <B>SERVICE_STATUS_HANDLE</B> value by calling the <A HREF="hbd0d..htm"><B>RegisterServiceCtrlHandler</B></A> function. It is the service's handle for making calls to the Service Control Manager.</P>

<P><I>dwServiceBits</I></P>

<P>A set of bit flags that specifies a service type.</P>

<P>Certain bit flags (0xC00F3F7B) are reserved for use by Microsoft. The <B>SetServiceBits</B> function fails with the error ERROR_INVALID_DATA if any of these bit flags are set in <I>dwServiceBits</I>. There are 18 of these bit flags:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=55%><B>Bit Flag Constant</B></TD>
<TD width=45%><B>Value</B></TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_WORKSTATION</TD>
<TD width=45%>0x00000001</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_SERVER</TD>
<TD width=45%>0x00000002</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_DOMAIN_CTRL</TD>
<TD width=45%>0x00000008</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_DOMAIN_BAKCTRL</TD>
<TD width=45%>0x00000010</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_TIME_SOURCE</TD>
<TD width=45%>0x00000020</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_AFP</TD>
<TD width=45%>0x00000040</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_DOMAIN_MEMBER</TD>
<TD width=45%>0x00000100</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_PRINTQ_SERVER</TD>
<TD width=45%>0x00000200</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_DIALIN_SERVER</TD>
<TD width=45%>0x00000400</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_XENIX_SERVER</TD>
<TD width=45%>0x00000800</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_SERVER_UNIX </TD>
<TD width=45%>0x00000800</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_NT</TD>
<TD width=45%>0x00001000</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_WFW</TD>
<TD width=45%>0x00002000</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_POTENTIAL_BROWSER</TD>
<TD width=45%>0x00010000</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_BACKUP_BROWSER</TD>
<TD width=45%>0x00020000</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_MASTER_BROWSER</TD>
<TD width=45%>0x00040000</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_DOMAIN_MASTER</TD>
<TD width=45%>0x00080000</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_LOCAL_LIST_ONLY</TD>
<TD width=45%>0x40000000</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>SV_TYPE_DOMAIN_ENUM</TD>
<TD width=45%>0x80000000</TD>
</TR>
</TABLE><BR>

<P></P>

<P>Certain bit flags (0x00300084) are defined by Microsoft, but are not specifically reserved for systems software. There are four of these bit flags:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=53%><B>Bit Flag Constant</B></TD>
<TD width=47%><B>Value</B></TD>
</TR>

<TR VALIGN="top">
<TD width=53%>SV_TYPE_SV_TYPE_SQLSERVER</TD>
<TD width=47%>0x00000004</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>SV_TYPE_NOVELL</TD>
<TD width=47%>0x00000080</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>SV_TYPE_DOMAIN_CTRL</TD>
<TD width=47%>0x00100000</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>SV_TYPE_DOMAIN_BAKCTRL</TD>
<TD width=47%>0x00200000</TD>
</TR>
</TABLE><BR>

<P></P>

<P>Certain bit flags (0x3FC0C000) are not defined by Microsoft, and their use is not coordinated by Microsoft. Developers of applications that use these bits should be aware that other applications may also use them, thus creating a conflict. There are 10 of these bit flags:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=51%><B>Value</B></TD>
<TD width=49%><B>Value</B></TD>
</TR>

<TR VALIGN="top">
<TD width=51%>0x00004000</TD>
<TD width=49%>0x02000000</TD>
</TR>

<TR VALIGN="top">
<TD width=51%>0x00008000</TD>
<TD width=49%>0x04000000</TD>
</TR>

<TR VALIGN="top">
<TD width=51%>0x00400000</TD>
<TD width=49%>0x08000000</TD>
</TR>

<TR VALIGN="top">
<TD width=51%>0x00800000</TD>
<TD width=49%>0x10000000</TD>
</TR>

<TR VALIGN="top">
<TD width=51%>0x01000000</TD>
<TD width=49%>0x20000000</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>bSetBitsOn</I></P>

<P>A BOOLEAN that specifies whether the function is to set or clear the bit flags that are set in <I>dwServiceBit.</I> The value TRUE specifies that the bits are to be set; FALSE specifies clearing.</P>

<P><I>bUpdateImmediately</I></P>

<P>A BOOLEAN that specifies whether the Server service is to perform an immediate update, announcing the new service type. The value TRUE specifies an immediate update; FALSE specifies otherwise.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>.</P>

<P><B>See Also</B></P>

<P><A HREF="9u8_wy.htm"><B>NetServerGetInfo</B></A>, <A HREF="69q..rn.htm"><B>NetServerEnum</B></A>, <A HREF="hbd0d..htm"><B>RegisterServiceCtrlHandler</B></A>, <A HREF="u71xdk.htm"><B>SetServiceStatus</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
