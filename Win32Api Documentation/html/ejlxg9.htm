<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>IsTextUnicode</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="ejlxg9"></A><B>IsTextUnicode  <A HREF="1ot5i0o.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1r0c_vq.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="21act6p.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>IsTextUnicode</B> function determines whether a buffer probably contains a form of Unicode text. The function uses various statistical and deterministic methods to make its determination, under the control of flags passed via <I>lpi</I>. When the function returns, the results of such tests are reported via <I>lpi</I>. If all specified tests are passed, the function returns TRUE; otherwise, it returns FALSE.</P>

<P><B>DWORD IsTextUnicode(</B></P>

<TABLE cols=2 width=625>

<TR VALIGN="top">
<TD width=32%><B>CONST LPVOID</B> <I>lpBuffer</I><B>,</B></TD>
<TD width=68%>// pointer to an input buffer to be examined</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    int </B><I>cb</I><B>,</B></TD>
<TD width=68%>// the size in bytes of the input buffer</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    LPINT </B><I>lpi</I></TD>
<TD width=68%>// pointer to flags that condition text examination and receive results</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>   );</B></TD>
<TD width=68%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpBuffer</I></P>

<P>Pointer to the input buffer to be examined.</P>

<P><I>cb</I></P>

<P>Specifies the size, in bytes, of the input buffer pointed to by <I>lpBuffer</I>.</P>

<P><I>lpi</I></P>

<P>Pointer to an<I> </I><B>int</B> that, upon entry to the function, contains a set of flags that specify the tests to be applied to the input buffer text. Upon exit from the function, that same <B>int</B> contains a set of bit flags indicating the results of the specified tests: 1 if the contents of the buffer pass a test, 0 for failure. Only flags that are set upon entry to the function are significant upon exit.</P>

<P>If <I>lpi</I> is NULL, the function uses all available tests to determine whether the data in the buffer is probably Unicode text.</P>

<P>Here are the constants used with <I>*lpi</I>'s bit flags:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=62%><B>Value</B></TD>
<TD width=38%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_ASCII16</TD>
<TD width=38%>The text is Unicode, and contains nothing but zero-extended ASCII values/characters.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_REVERSE_ASCII16</TD>
<TD width=38%>Same as the preceding, except that the Unicode text is byte-reversed.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_STATISTICS</TD>
<TD width=38%>The text is probably Unicode, with the determination made by applying statistical analysis. Absolute certainty is not guaranteed. See the note in the following Remarks section. </TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_REVERSE_STATISTICS</TD>
<TD width=38%>Same as the preceding, except that the probably-Unicode text is byte-reversed.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_CONTROLS</TD>
<TD width=38%>The text contains Unicode representations of one or more of these non-printing characters: RETURN, LINEFEED, SPACE, CJK_SPACE, TAB.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_REVERSE_CONTROLS</TD>
<TD width=38%>Same as the preceding, except that the Unicode characters are byte-reversed.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_BUFFER_TOO_SMALL</TD>
<TD width=38%>There are too few characters in the buffer for meaningful analysis (fewer than two bytes).</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_SIGNATURE</TD>
<TD width=38%>The text contains the Unicode byte-order mark (BOM) 0xFEFF as its first character.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_REVERSE_SIGNATURE</TD>
<TD width=38%>The text contains the Unicode byte-reversed byte-order mark (Reverse BOM) 0xFFFE as its first character.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_ILLEGAL_CHARS</TD>
<TD width=38%>The text contains one of these Unicode-illegal characters: embedded Reverse BOM, UNICODE_NUL, CRLF (packed into one <B>WORD</B>), or 0xFFFF.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_ODD_LENGTH</TD>
<TD width=38%>The number of characters in the string is odd. A string of odd length cannot (by definition) be Unicode text.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_NULL_BYTES</TD>
<TD width=38%>The text contains null bytes, which indicate non-ASCII text.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_UNICODE_MASK</TD>
<TD width=38%>This flag constant is a combination of IS_TEXT_UNICODE_ASCII16, IS_TEXT_UNICODE_STATISTICS, IS_TEXT_UNICODE_CONTROLS, IS_TEXT_UNICODE_SIGNATURE. </TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_REVERSE_MASK</TD>
<TD width=38%>This flag constant is a combination of IS_TEXT_UNICODE_REVERSE_ASCII16, IS_TEXT_UNICODE_REVERSE_STATISTICS, IS_TEXT_UNICODE_REVERSE_CONTROLS, IS_TEXT_UNICODE_REVERSE_SIGNATURE.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_NOT_UNICODE_MASK</TD>
<TD width=38%>This flag constant is a combination of IS_TEXT_UNICODE_ILLEGAL_CHARS, IS_TEXT_UNICODE_ODD_LENGTH, and two currently unused bit flags.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>IS_TEXT_UNICODE_NOT_ASCII_MASK</TD>
<TD width=38%>This flag constant is a combination of IS_TEXT_UNICODE_NULL_BYTES and three currently unused bit flags.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>The function returns nonzero if the data in the buffer passes the specified tests.</P>

<P>The function returns zero if the data in the buffer does not pass the specified tests.</P>

<P>In either case, the <B>int </B>pointed to by <I>lpi</I> contains the results of the specific tests the function applied to make its determination.</P>

<P><B>Remarks</B></P>

<P>As noted in the preceding table of flag constants, the IS_TEXT_UNICODE_STATISTICS and IS_TEXT_UNICODE_REVERSE_STATISTICS tests use statistical analysis. These tests are not foolproof. The statistical tests assume certain amounts of variation between low and high bytes in a string, and some ASCII strings can slip through. For example, if <I>lpBuffer</I> points to the ASCII string 0x41, 0x0A, 0x0D, 0x1D (A\n\r^Z), the string passes the IS_TEXT_UNICODE_STATISTICS test, though failure would be preferable. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
