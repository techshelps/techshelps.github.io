<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Filenames and Directories</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="3e7cwf"></A><B>Filenames and Directories</B></P>

<P>The information in this section applies to both Explorer-style and old-style Open and Save As dialog boxes.</P>

<P>Before calling the <A HREF="fzgrjg.htm"><B>GetOpenFileName</B></A> or <A HREF="182.5be.htm"><B>GetSaveFileName</B></A> functions, the <B>lpstrFile</B> member of the <A HREF="2wivnae.htm"><B>OPENFILENAME</B></A> structure must point to the buffer to receive the filename. The <B>nMaxFile</B> member must specify the size, in bytes (ANSI version) or characters (Unicode version), of the <B>lpstrFile</B> buffer. </P>

<P>If the user specifies a filename and clicks the OK button, the dialog box copies the selected drive, directory, and filename to the <B>lpstrFile</B> buffer. The function also sets the <B>nFileOffset</B> and <B>nFileExtension</B> members to the offsets, in bytes or characters, from the start of the buffer to the filename and to the filename extension, respectively. </P>

<P>To retrieve just the filename and extension, set the <B>lpstrFileTitle</B> member to point to a buffer and set the <B>nMaxFileTitle</B> member to the size, in bytes (ANSI version) or characters (Unicode version), of the buffer. Alternatively, you can pass the <B>lpstrFile</B> buffer in a call to the <A HREF="1vgou4i.htm"><B>GetFileTitle</B></A> function to get the display name of the selected file. Note, however, that the filename that <B>GetFileTitle</B> returns includes an extension only if that is the user's preference for displaying filenames. </P>

<P>The dialog box uses the current directory for the calling process as the initial directory from which to display files and directories. Use the <A HREF="lwy0ba.htm"><B>GetCurrentDirectory</B></A> or <A HREF="hwnghc.htm"><B>SetCurrentDirectory</B></A> functions to get or change your current directory. To specify a different initial directory without changing your current directory, use the <B>lpstrInitialDir</B> member to specify the name of a directory. The dialog box automatically changes your current directory when the user selects a different drive or directory. To prevent the dialog box from changing your current directory, set the OFN_NOCHANGEDIR flag. This flag does not prevent the user from changing directories to find a file.</P>

<P>To specify a default filename extension, use the <B>lpstrDefExt</B> member. If the user specifies a filename that does not have an extension, the dialog box adds your default extension. If you specify a default extension and the user specifies a filename with a different extension, the dialog box sets the OFN_EXTENSIONDIFFERENT flag. </P>

<P>To let the user select more than one file from a directory, set the OFN_ALLOWMULTISELECT flag. For compatibility with older applications, the default multiple selection dialog box uses the old-style user interface. To display an Explorer-style multiple selection dialog box, you must also set the OFN_EXPLORER flag.</P>

<P>If the user selects more than one file, the buffer pointed to by the <B>lpstrFile</B> member returns the path to the current directory followed by the filenames of the selected files. The <B>nFileOffset</B> member is the offset to the first filename, and the <B>nFileExtension</B> member is not used. The following table describes the difference between Explorer-style and old-style dialog boxes in returning multiple filenames.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=28%><B>Dialog box style</B></TD>
<TD width=72%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>Explorer-style dialog boxes</TD>
<TD width=72%>The directory and filename strings are NULL separated, with an extra NULL character after the last filename. This format enables the Explorer-style dialogs to return long filenames that include spaces. </TD>
</TR>

<TR VALIGN="top">
<TD width=28%>Old-style dialog boxes</TD>
<TD width=72%>The directory and filename strings are separated by spaces. For filenames with spaces, the function uses short filenames.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>You can use the <A HREF="2a0z0q6.htm"><B>FindFirstFile</B></A> function to convert between long and short filenames. </P>

</BODY>
</HTML>
