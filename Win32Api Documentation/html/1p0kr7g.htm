<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Registering a File Viewer</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1p0kr7g"></A><B>Registering a File Viewer</B></P>

<P>This section shows how to register a hypothetical file viewer for "AcmeWord Document" files with the .AWD filename extension. The file viewer is implemented in an in-process server DLL called ACMEWRDV.DLL. The DLL has this class identifier: 00021116-0000-0000-C000-000000000046. The program that installs the file viewer creates the following registry entries.</P>

<P>HKEY_CLASSES_ROOT  </P>

<P>\QuickView </P>

<P>\.AWD = AcmeWord Document </P>

<P>\{00021117-0000-0000-C000-000000000046} = AcmeWord Document <BR>
                                                      Viewer </P>

<P>\CLSID </P>

<P>\{00021117-0000-0000-C000-000000000046} = AcmeWord Document <BR>
                                                  Viewer </P>

<P>\InprocServer32 = c:\acmeword\acmewrdv.dll </P>

<P>= ThreadingModel = "Apartment" </P>

<P></P>

<P>The .REG file, which is an ASCII text file, contains these entries. (Note that wrapped lines are indented on the second line.)</P>

<P>HKEY_CLASSES_ROOT\QuickView\.AWD = AcmeWord Document  </P>

<P>HKEY_CLASSES_ROOT\QuickView\.AWD \{00021117-0000-0000-C000-<BR>
    000000000046} = AcmeWord Document Viewer </P>

<P>HKEY_CLASSES_ROOT\CLSID\{00021117-0000-0000-C000-000000000046} = <BR>
    AcmeWord Document Viewer </P>

<P>HKEY_CLASSES_ROOT\CLSID\{00021117-0000-0000-C000-000000000046} <BR>
    \InprocServer32 = c:\acmeword\acmewrdv.dll </P>

<P>= ThreadingModel = "Apartment" </P>

<P></P>

<P>The Quick View program uses these registry entries to associate a path with the class identifier of a file viewer's in-process server DLL.</P>

</BODY>
</HTML>
