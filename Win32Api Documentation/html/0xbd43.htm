<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>MODEMDEVCAPS</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="0xbd43"></A><B>MODEMDEVCAPS  <A HREF="6.jpgb.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="5jpun8.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1ock5rm.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>MODEMDEVCAPS</B> structure contains information about the capabilities of a modem.</P>

<P>typedef struct modemdevcaps_tag {<BR>
    DWORD dwActualSize;               // size of returned data, in bytes<BR>
    DWORD dwRequiredSize;             // total size of structure<BR>
    DWORD dwDevSpecificOffset;        // offset of provider-defined data<BR>
    DWORD dwDevSpecificSize;          // size of provider-defined data<BR>
<BR>
    // Product and version identification<BR>
    DWORD dwModemProviderVersion;     // provider version number<BR>
    DWORD dwModemManufacturerOffset;  // offset of manufacturer name<BR>
    DWORD dwModemManufacturerSize;    // length of manufacturer name<BR>
    DWORD dwModemModelOffset;         // offset of model name<BR>
    DWORD dwModemModelSize;           // length of model name<BR>
    DWORD dwModemVersionOffset;       // offset of version name<BR>
    DWORD dwModemVersionSize;         // length of version name<BR>
<BR>
    // Local option capabilities<BR>
    DWORD dwDialOptions;              // bitmap of supported values<BR>
    DWORD dwCallSetupFailTimer;       // maximum in seconds<BR>
    DWORD dwInactivityTimeout;        // maximum in tenths of seconds<BR>
    DWORD dwSpeakerVolume;            // bitmap of supported values<BR>
    DWORD dwSpeakerMode;              // bitmap of supported values<BR>
    DWORD dwModemOptions;             // bitmap of supported values<BR>
    DWORD dwMaxDTERate;               // maximum value in bit/s<BR>
    DWORD dwMaxDCERate;               // maximum value in bit/s<BR>
<BR>
    // Variable portion for strings and provider-specific data<BR>
    BYTE abVariablePortion [1];       // variable-length data<BR>
} MODEMDEVCAPS, *PMODEMDEVCAPS, *LPMODEMDEVCAPS;<BR>
  </P>

<P><B>Members</B></P>

<P><B>dwActualSize</B></P>

<P>Specifies the size, in bytes, of the data actually returned to the application. This member may be less than the <B>dwRequiredSize</B> member, if an application did not allocate enough space for the variable-length portion of the structure.</P>

<P><B>dwRequiredSize</B></P>

<P>Specifies the number of bytes required for the entire <B>MODEMDEVCAPS</B> structure, including the variable-length portion.</P>

<P><B>dwDevSpecificOffset</B></P>

<P>Specifies the offset of the provider-defined portion of the structure, in bytes relative to the beginning of the structure.</P>

<P><B>dwDevSpecificSize</B></P>

<P>Specifies the size of the provider-defined portion of the structure, in bytes.</P>

<P><B>dwModemProviderVersion</B></P>

<P>Specifies the version of the service provider. The format and use of this member depends on the service provider.</P>

<P><B>dwModemManufacturerOffset</B></P>

<P>Specifies the offset of a text string that contains the name of the modem manufacturer. The offset is specified in bytes relative to the beginning of the structure.</P>

<P><B>dwModemManufacturerSize</B></P>

<P>Specifies the length of the modem manufacturer name, in bytes. The string is not null-terminated.</P>

<P><B>dwModemModelOffset</B></P>

<P>Specifies the offset of a text string that contains the model of the modem. The offset is specified in bytes relative to the beginning of the structure.</P>

<P><B>dwModemModelSize</B></P>

<P>Specifies the length of the model name, in bytes. The string is not null-terminated.</P>

<P><B>dwModemVersionOffset</B></P>

<P>Specifies the offset of a text string that gives the version and revision of the attached modem, if the provider could determine the information. The offset is specified in bytes relative to the beginning of the structure.</P>

<P><B>dwModemVersionSize</B></P>

<P>Specifies the length of the modem version string, in bytes. The string is not null-terminated.</P>

<P><B>dwDialOptions</B></P>

<P>Specifies dialing options that are supported by the modem device. This member can be zero or more of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=47%><B>Value</B></TD>
<TD width=53%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=47%>DIALOPTION_DIALBILLING</TD>
<TD width=53%>Specifies that the modem supports waiting for billing tone (bong).</TD>
</TR>

<TR VALIGN="top">
<TD width=47%>DIALOPTION_DIALQUIET</TD>
<TD width=53%>Specifies that the modem supports waiting for quiet.</TD>
</TR>

<TR VALIGN="top">
<TD width=47%>DIALOPTION_DIALDIALTONE</TD>
<TD width=53%>Specifies that the modem supports waiting for a dial tone.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>dwCallSetupFailTimer</B></P>

<P>Specifies the maximum call setup timeout supported by the modem, in seconds. This is the largest value that can be specified for the corresponding member of the <A HREF="muyhwn.htm"><B>MODEMSETTINGS</B></A> structure.</P>

<P><B>dwInactivityTimeout</B></P>

<P>Specifies the maximum inactivity timeout supported by the modem, in tenths of seconds. This is the largest value that can be specified for the corresponding member of the <B>MODEMSETTINGS</B> structure.</P>

<P><B>dwSpeakerVolume</B></P>

<P>Specifies the speaker volume settings supported by the modem. This member can be zero or more of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=42%><B>Value</B></TD>
<TD width=58%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=42%>MDMVOLFLAG_LOW</TD>
<TD width=58%>The modem supports low (MDMVOL_LOW) volume.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>MDMVOLFLAG_MEDIUM</TD>
<TD width=58%>The modem supports medium (MDMVOL_MEDIUM) volume.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>MDMVOLFLAG_HIGH</TD>
<TD width=58%>The modem supports high (MDMVOL_HIGH) volume.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>dwSpeakerMode</B></P>

<P>Specifies the speaker mode settings supported by the modem. This member can be zero or more of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=48%><B>Value</B></TD>
<TD width=52%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MDMSPKRFLAG_OFF</TD>
<TD width=52%>The modem supports the MDMSPKR_OFF speaker mode.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MDMSPKRFLAG_DIAL</TD>
<TD width=52%>The modem supports the MDMSPKR_DIAL speaker mode.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MDMSPKRFLAG_ON</TD>
<TD width=52%>The modem supports the MDMSPKR_ON speaker mode.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MDMSPKRFLAG_CALLSETUP</TD>
<TD width=52%>The modem supports the MDMSPKR_CALLSETUP speaker mode.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>dwModemOptions</B></P>

<P>Specifies supported modem options. This member can be zero or more of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=48%>MDM_BLIND_DIAL</TD>
<TD width=52%>MDM_FLOWCONTROL_SOFT</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MDM_CCITT_OVERRIDE</TD>
<TD width=52%>MDM_FORCED_EC</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MDM_CELLULAR</TD>
<TD width=52%>MDM_SPEED_ADJUST</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MDM_COMPRESSION</TD>
<TD width=52%>MDM_TONE_DIAL</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MDM_ERROR_CONTROL</TD>
<TD width=52%>MDM_V23_OVERRIDE</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>MDM_FLOWCONTROL_HARD</TD>
<TD width=52%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P>When <B>MODEMDEVCAPS</B> is used to set modem options, as part of the <B>MODEMSETTINGS</B> structure, these values are used as follows:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=49%><B>Value</B></TD>
<TD width=51%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=49%>MDM_CCITT_OVERRIDE</TD>
<TD width=51%>When set, CCITT modulations are enabled for V.21 and V.22 or V.23.
<P>When clear, bell modulations are enabled for 103 and 212A.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>MDM_V23_OVERRIDE</TD>
<TD width=51%>When set, CCITT modulations are enabled for V.23.
<P>When clear, CCITT modulations are enabled for V.21 and V.22.</P>
</TD>
</TR>
</TABLE><BR>

<P></P>

<P>For V.23 to be set, both MDM_CCITT_OVERRIDE and MDM_V23_OVERRIDE must be set.</P>

<P><B>dwMaxDTERate</B></P>

<P>Maximum DTE rate in bits per second.</P>

<P><B>dwMaxDCERate</B></P>

<P>Maximum DCE rate in bits per second.</P>

<P><B>abVariablePortion</B></P>

<P>Contains variable-length information, including strings and any provider-defined information.</P>

<P><B>See Also</B></P>

<P><A HREF="muyhwn.htm"><B>MODEMSETTINGS</B></A><B> </B></P>

</BODY>
</HTML>
