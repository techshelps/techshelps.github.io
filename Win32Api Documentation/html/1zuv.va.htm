<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>RasDial</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1zuv.va"></A><B>RasDial  <A HREF="wjuqv8.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="35kj_0r.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="lrsi7i.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>RasDial</B> function establishes a RAS connection between a RAS client and a RAS server. The connection data includes callback and user authentication information. </P>

<P><B>DWORD RasDial(</B></P>

<TABLE cols=2 width=671>

<TR VALIGN="top">
<TD width=50%><B>LPRASDIALEXTENSIONS</B> <I>lpRasDialExtensions</I><B>,</B></TD>
<TD width=50%>// pointer to function extensions data</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>    LPTSTR</B> <I>lpszPhonebook</I><B>,</B></TD>
<TD width=50%>// pointer to full path and filename of phone-book file</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>    LPRASDIALPARAMS</B> <I>lpRasDialParams</I><B>,</B></TD>
<TD width=50%>// pointer to calling parameters data</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>    DWORD</B> <I>dwNotifierType</I><B>,</B></TD>
<TD width=50%>// specifies type of RasDial event handler </TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>    LPVOID</B> <I>lpvNotifier</I><B>,</B></TD>
<TD width=50%>// specifies a handler for RasDial events</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>    LPHRASCONN</B> <I>lphRasConn</I> </TD>
<TD width=50%>// pointer to variable to receive connection handle</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>   );</B></TD>
<TD width=50%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpRasDialExtensions</I></P>

<P><B>Windows NT:</B></P>

<P>Points to a <A HREF="1__tqgb.htm"><B>RASDIALEXTENSIONS</B></A> structure that specifies a set of <B>RasDial </B>extended features to enable. If you do not need to enable any of the extensions, set this parameter to NULL. </P>

<P><B>Windows 95:</B></P>

<P>This parameter is ignored. On Windows 95, <B>RasDial</B> always uses the default behaviors for the <B>RASDIALEXTENSIONS</B> options.</P>

<P><I>lpszPhonebook</I></P>

<P><B>Windows NT: </B>Pointer to a null-terminated string that specifies the full path and filename of a phone-book (.PBK) file. If this parameter is NULL, the function uses the current default phone-book file. The default phone-book file is the one selected by the user in the <B>User Preferences</B> property sheet of the <B>Dial-Up Networking</B> dialog box.</P>

<P><B>Windows 95: </B>This parameter is ignored. Dial-up networking stores phone-book entries in the registry rather than in a phone-book file.</P>

<P><I>lpRasDialParams</I></P>

<P>Points to a <A HREF="3o3p0vx.htm"><B>RASDIALPARAMS</B></A> structure that specifies calling parameters for the RAS connection. </P>

<P>The caller must set the <B>RASDIALPARAMS</B> structure's <B>dwSize</B> member to the <B>sizeof(RASDIALPARAMS)</B> to identify the version of the structure being passed. </P>

<P><I>dwNotifierType</I></P>

<P>Specifies the nature of the <I>lpvNotifier</I> parameter. If <I>lpvNotifier</I> is NULL, <I>dwNotifierType</I> is ignored. If <I>lpvNotifier</I> is not NULL, set <I>dwNotifierType</I> to one of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=37%><B>Value</B></TD>
<TD width=63%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=37%>0xFFFFFFFF</TD>
<TD width=63%>The <I>lpvNotifier</I> parameter is a handle to a window to receive progress notification messages. In a progress notification message, <I>wParam</I> is the equivalent of the <I>rasconnstate</I> parameter of <A HREF="0arw_f.htm"><B>RasDialFunc</B></A><B> </B>and <A HREF="2xbtbfx.htm"><B>RasDialFunc1</B></A>, and <I>lParam</I> is the equivalent of the <I>dwError</I> parameter of <B>RasDialFunc </B>and <B>RasDialFunc1</B>. 
<P>The progress notification message uses a system registered message code. You can obtain the value of this message code as follows: </P>

<P>{UINT unMsg = </P>

<P>RegisterWindowMessageA( RASDIALEVENT );</P>

<P>if (unMsg == 0)</P>

<P>unMsg = WM_RASDIALEVENT;   </P>

<P>}</P>

<P></P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=37%>0</TD>
<TD width=63%>The <I>lpvNotifier</I> parameter points to a <A HREF="0arw_f.htm"><B>RasDialFunc</B></A> callback function. </TD>
</TR>

<TR VALIGN="top">
<TD width=37%>1</TD>
<TD width=63%>The <I>lpvNotifier</I> parameter points to a <A HREF="2xbtbfx.htm"><B>RasDialFunc1</B></A> callback function. </TD>
</TR>

<TR VALIGN="top">
<TD width=37%>2</TD>
<TD width=63%><B>Windows NT:</B> The <I>lpvNotifier</I> parameter points to a <A HREF="2xbtbfy.htm"><B>RasDialFunc2</B></A> callback function. </TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lpvNotifier</I></P>

<P>Specifies a window handle or a <B>RasDialFunc</B>, <B>RasDialFunc1</B>, or <B>RasDialFunc2</B> callback function to receive <B>RasDial</B> event notifications. The <I>dwNotifierType</I> parameter specifies the nature of <I>lpvNotifier</I>. Please refer to its description preceding for further detail.</P>

<P>If this parameter is not NULL, <B>RasDial</B> sends the window a message, or calls the callback function, for each <B>RasDial</B> event. Additionally, the <B>RasDial</B> call operates asynchronously: <B>RasDial</B> returns immediately, before the connection is established, and communicates its progress via the window or callback function. </P>

<P>If <I>lpvNotifier</I> is NULL, the <B>RasDial</B> call operates synchronously: <B>RasDial </B>does not return until the connection attempt has completed successfully or failed. </P>

<P>If <I>lpvNotifier</I> is not NULL, notifications to the window or callback function can occur at any time after the initial call to <B>RasDial</B>. Notifications end when one of the following events occurs:</P>

<P></P>

<P>·The connection is established. In other words, the RAS connection state is RASCS_Connected.</P>

<P>·The connection fails. In other words, <I>dwError</I> is nonzero.</P>

<P>·<A HREF="0_qzpb.htm"><B>RasHangUp</B></A> is called on the connection.</P>

<P></P>

<P>The callback notifications are made in the context of a thread captured during the initial call to <B>RasDial</B>.</P>

<P><I>lphRasConn</I></P>

<P>Points to a variable of type <B>HRASCONN</B>. You must set the <B>HRASCONN</B> variable to NULL before calling <B>RasDial</B>. If <B>RasDial </B>succeeds, it stores a handle to the RAS connection into *<I>lphRasConn</I>.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the immediate return value is zero. In addition, the function stores a handle to the RAS connection into the variable pointed to by <I>lphRasConn</I>. </P>

<P>If the function fails, the immediate return value is a nonzero error value, either from the set listed in the RAS header file or ERROR_NOT_ENOUGH_MEMORY. </P>

<P><B>Remarks</B></P>

<P>Errors that occur after the immediate return can be detected by <A HREF="11ewq3o.htm"><B>RasGetConnectStatus</B></A>. Data is available until an application calls <A HREF="0_qzpb.htm"><B>RasHangUp</B></A> to hang up the connection. </P>

<P>An application must eventually call <B>RasHangUp</B> whenever a non-NULL connection handle is stored into *<I>lphRasConn</I>. This applies even if <B>RasDial </B>returns a nonzero (error) value. </P>

<P>An application can safely call <B>RasHangUp</B> from a <B>RasDial</B> notifier callback function. If this is done, however, the hangup does not occur until the routine returns. </P>

<P><B>Windows NT:</B></P>

<P>If the structure pointed to by <I>lpRasDialExtensions </I>enables RDEOPT_PausedStates, the <B>RasDial</B> function pauses whenever it enters a state in which the RASCS_PAUSED bit is set to one. To restart <B>RasDial</B> from such a paused state, call <B>RasDial</B> again, passing the connection handle returned from the original <B>RasDial</B> call in *<I>lphRasConn</I>. The same notifier used in the original <B>RasDial</B> call must be used when restarting from a paused state.</P>

<P>To specify that <B>RasDial</B> should enter a RASCS_CallbackSetByCaller state, set <I>lpRasDialParams</I>-&gt;<B>szCallbackNumber</B> to "*" on the initial call to <B>RasDial</B>. When your notification handler is called with this state, you can set the the callback number to a number supplied by the user. </P>

<P><B>Windows 95:</B></P>

<P>Windows 95 does not support the RASCS_CallbackSetByCaller state or any of the other paused states.</P>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="12pubzh.htm"><B>RasDialDlg</B></A>, <A HREF="0arw_f.htm"><B>RasDialFunc</B></A>, <A HREF="2xbtbfx.htm"><B>RasDialFunc1</B></A>, <A HREF="2xbtbfy.htm"><B>RasDialFunc2</B></A>, <A HREF="11ewq3o.htm"><B>RasGetConnectStatus</B></A>, <A HREF="0_qzpb.htm"><B>RasHangUp</B></A>, <A HREF="1__tqgb.htm"><B>RASDIALEXTENSIONS</B></A>, <A HREF="3o3p0vx.htm"><B>RASDIALPARAMS</B></A>, <A HREF="jt_h1v.htm">WM_RASDIALEVENT</A> </P>

<P></P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
