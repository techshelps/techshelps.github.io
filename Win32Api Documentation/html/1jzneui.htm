<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>DlgDirListComboBox</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1jzneui"></A><B>DlgDirListComboBox  <A HREF="182jnfs.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="blmy52.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="53fr_hx.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>DlgDirListComboBox</B> function fills the specified combo box with a directory listing. It fills the list with the names of all files, drives, and subdirectories that match the specified attributes and path string. </P>

<P><B>int DlgDirListComboBox(</B></P>

<TABLE cols=2 width=439>

<TR VALIGN="top">
<TD width=40%><B>HWND</B> <I>hDlg</I><B>,</B></TD>
<TD width=60%>// handle to dialog box with combo box  </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    LPTSTR</B> <I>lpPathSpec</I><B>,</B></TD>
<TD width=60%>// pointer to path or filename string </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    int</B> <I>nIDComboBox</I><B>,</B></TD>
<TD width=60%>// identifier of combo box </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    int</B> <I>nIDStaticPath</I><B>,</B></TD>
<TD width=60%>// identifier of static control </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    UINT</B> <I>uFiletype</I> </TD>
<TD width=60%>// file attributes to display </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>   );</B></TD>
<TD width=60%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hDlg</I></P>

<P>Identifies the dialog box that contains the combo box. </P>

<P><I>lpPathSpec</I></P>

<P>Points to a null-terminated string of the following form: </P>

<P>[<I>drive</I><B>:</B>][<B>\</B>]][<I>directory</I><B>\</B>[...]][<I>filename</I>] </P>

<P>If the specified string includes a drive or directory path, the <B>DlgDirListComboBox</B> function changes the current drive and directory before filling the list. After the list is filled, the drive and directory path are removed from the string specified by the <I>lpPathSpec</I> parameter. </P>

<P><I>nIDComboBox</I></P>

<P>Specifies the identifier of a combo box control in a dialog box. If <I>nIDComboBox</I> is zero, the <B>DlgDirListComboBox</B> function assumes no combo box exists and does not attempt to fill it. </P>

<P><I>nIDStaticPath</I></P>

<P>Specifies the identifier of the static text control in which the <B>DlgDirListComboBox</B> function is to display the current directory. If <I>nIDStaticPath</I> is zero, <B>DlgDirListComboBox</B> assumes no such control is present. </P>

<P><I>uFiletype</I></P>

<P>Specifies the attributes of the files to be displayed. It can be any combination of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%><B>Value</B></TD>
<TD width=67%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_ARCHIVE</TD>
<TD width=67%>Includes archived files.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_DIRECTORY</TD>
<TD width=67%>Includes subdirectories. Subdirectory names are enclosed in square brackets ([ ]).</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_DRIVES</TD>
<TD width=67%>Includes drives. Drives are listed in the form [-<I>x</I>-], where <I>x</I> is the drive letter.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_EXCLUSIVE</TD>
<TD width=67%>Includes only files with the specified attributes. By default, read-write files are listed even if DDL_READWRITE is not specified.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_HIDDEN</TD>
<TD width=67%>Includes hidden files.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_READONLY</TD>
<TD width=67%>Includes read-only files.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_READWRITE</TD>
<TD width=67%>Includes read-write files with no additional attributes.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_SYSTEM</TD>
<TD width=67%>Includes system files.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_POSTMSGS</TD>
<TD width=67%>Posts messages to the application's message queue. By default, the <B>DlgDirList</B> function sends messages directly to the dialog box procedure.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. For example, if the string specified by <I>lpPathSpec</I> is not a valid path, the function fails. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>If the <I>lpszPathSpec</I> parameter points to a zero-length string or to a string specifying a drive, directory, or both ¾ but no filename ¾ the filename *.* (wildcards) is assumed. </P>

<P><B>Windows NT:</B></P>

<P>The directory listing displays long filenames, if any.</P>

<P><B>Windows 95:</B></P>

<P>The directory listing displays short filenames (the 8.3 form). You can use the <B>SHGetFileInfo</B> or <B>GetFullPathName</B> functions to get the corresponding long filename.</P>

<P><B>See Also</B></P>

<P><A HREF="eyoakl.htm"><B>DlgDirList</B></A>, <A HREF="1e7xwyp.htm"><B>DlgDirSelectComboBoxEx</B></A>, <A HREF="8n6hyc.htm"><B>GetFullPathName</B></A>,<B> <A HREF="1o2ghja.htm">SHGetFileInfo</A></B></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
