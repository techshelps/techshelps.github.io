<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>GetPrinterDriver</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="ehb0hh"></A><B>GetPrinterDriver  <A HREF="10i0k6h.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="joiq6.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="yhp8x..htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetPrinterDriver</B> function retrieves driver data for the specified printer. </P>

<P><B>BOOL GetPrinterDriver(</B></P>

<TABLE cols=2 width=611>

<TR VALIGN="top">
<TD width=31%><B>HANDLE</B> <I>hPrinter</I><B>,</B></TD>
<TD width=69%>// printer object </TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>    LPTSTR</B> <I>pEnvironment</I><B>,</B></TD>
<TD width=69%>// address of environment </TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>    DWORD</B> <I>Level</I><B>,</B></TD>
<TD width=69%>// structure level </TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>    LPBYTE</B> <I>pDriverInfo</I><B>,</B></TD>
<TD width=69%>// address of structure array </TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>    DWORD</B> <I>cbBuf</I><B>,</B></TD>
<TD width=69%>// size, in bytes, of array </TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>    LPDWORD</B> <I>pcbNeeded</I> </TD>
<TD width=69%>// address of variable with number of bytes retrieved (or required) </TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>   );</B></TD>
<TD width=69%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hPrinter</I></P>

<P>Identifies the printer for which the driver data should be retrieved. </P>

<P><I>pEnvironment</I></P>

<P>Points to a null-terminated string that specifies the environment. For example, "Windows NT x86" specifies Windows NT running on an Intel 80386 or 80486 processor. If this parameter is NULL, the current environment of the calling application and client machine (not of the destination application and print server) is used. </P>

<P><I>Level</I></P>

<P>Specifies the version of the structure to which <I>lpbForm</I> points. This value must be either 1, 2., or 3.</P>

<P><I>pDriverInfo</I></P>

<P>Points to either a <A HREF="15iyypc.htm"><B>DRIVER_INFO_1</B></A>, <A HREF="camz93.htm"><B>DRIVER_INFO_2</B></A>, or <A HREF="cbmz93.htm"><B>DRIVER_INFO_3</B></A>structure. If <I>Level</I> is 1, this array receives a <B>DRIVER_INFO_1</B> structure; if <I>Level</I> is 2, this array receives a <B>DRIVER_INFO_2</B> structure, if <I>Level</I> is 3, this array receives a <B>DRIVER_INFO_3</B> structure.</P>

<P><I>cbBuf</I></P>

<P>Specifies the size, in bytes, of the array at which <I>pDriverInfo</I> points. </P>

<P><I>pcbNeeded</I></P>

<P>Points to a value that specifies the number of bytes copied if the function succeeds or the number of bytes required if <I>cbBuf</I> is too small. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>The printer handle identified by the <I>hPrinter</I> parameter should be retrieved by calling the <B>OpenPrinter</B> function. </P>

<P>The <B>DRIVER_INFO_2</B> and<B> DRIVER_INFO_3 </B>structures contain a full path and filename specifying the location of the printer driver. An application can use the path and filename to load a printer driver by calling the <B>LoadLibrary</B> function and supplying the path and filename as the single argument. </P>

<P><B>See Also</B></P>

<P><A HREF="12dsaat.htm"><B>AddPrinterDriver</B></A>, <A HREF="15iyypc.htm"><B>DRIVER_INFO_1</B></A>, <A HREF="camz93.htm"><B>DRIVER_INFO_2</B></A>, <A HREF="1dibzdw.htm"><B>EnumPrinterDrivers</B></A>, <A HREF="1vghbf8.htm"><B>LoadLibrary</B></A>, <A HREF="9gwvgs.htm"><B>OpenPrinter</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
