<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CBTProc</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="j9p_3k"></A><B>CBTProc  <A HREF="19i1q_t.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="qpp.yo.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="rnpdgc.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>CBTProc</B> hook procedure is an application-defined or library-defined callback function that the system calls before activating, creating, destroying, minimizing, maximizing, moving, or sizing a window; before completing a system command; before removing a mouse or keyboard event from the system message queue; before setting the keyboard focus; or before synchronizing with the system message queue. The value returned by the hook procedure determines whether Windows allows or prevents one of these operations. A computer-based training (CBT) application uses this hook procedure to receive useful notifications from the system. </P>

<P><B>LRESULT CALLBACK CBTProc(</B></P>

<TABLE cols=2 width=345>

<TR VALIGN="top">
<TD width=48%><B>int</B> <I>nCode</I><B>,</B></TD>
<TD width=52%>// hook code</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    WPARAM</B> <I>wParam</I><B>,</B></TD>
<TD width=52%>// depends on hook code</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    LPARAM</B> <I>lParam</I> </TD>
<TD width=52%>// depends on hook code</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>   );</B></TD>
<TD width=52%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>nCode</I></P>

<P>Specifies a code that the hook procedure uses to determine how to process the message. This parameter can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=38%><B>Value</B></TD>
<TD width=62%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=38%>HCBT_ACTIVATE</TD>
<TD width=62%>The system is about to activate a window.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>HCBT_CLICKSKIPPED</TD>
<TD width=62%>The system has removed a mouse message from the system message queue. Upon receiving this hook code, a CBT application must install a <A HREF="17p7nrh.htm">WH_JOURNALPLAYBACK hook</A> procedure in response to the mouse message.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>HCBT_CREATEWND</TD>
<TD width=62%>A window is about to be created. The system calls the hook procedure before sending the <A HREF="2re1yt3.htm">WM_CREATE</A> or <A HREF="11ps3hu.htm">WM_NCCREATE</A> message to the window. If the hook procedure returns a nonzero value, the system destroys the window; the <A HREF="we1r5q.htm"><B>CreateWindow</B></A> function returns NULL, but the <A HREF="0yqmho.htm">WM_DESTROY</A> message is not sent to the window. If the hook procedure returns zero, the window is created normally.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>&nbsp;</TD>
<TD width=62%>At the time of the HCBT_CREATEWND notification, the window has been created, but its final size and position may not have been determined and its parent window may not have been established. It is possible to send messages to the newly created window, although it has not yet received WM_NCCREATE or WM_CREATE messages. It is also possible to change the position in the Z order of the newly created window by modifying the <B>hwndInsertAfter</B> member of the <A HREF="4mzo9_.htm"><B>CBT_CREATEWND</B></A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>HCBT_DESTROYWND</TD>
<TD width=62%>A window is about to be destroyed.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>HCBT_KEYSKIPPED</TD>
<TD width=62%>The system has removed a keyboard message from the system message queue. Upon receiving this hook code, a CBT application must install a <A HREF="17p7nrh.htm">WH_JOURNALPLAYBACK_hook</A> hook procedure in response to the keyboard message.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>HCBT_MINMAX</TD>
<TD width=62%>A window is about to be minimized or maximized.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>HCBT_MOVESIZE</TD>
<TD width=62%>A window is about to be moved or sized.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>HCBT_QS</TD>
<TD width=62%>The system has retrieved a <A HREF="sml7ih.htm">WM_QUEUESYNC</A> message from the system message queue.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>HCBT_SETFOCUS</TD>
<TD width=62%>A window is about to receive the keyboard focus.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>HCBT_SYSCOMMAND</TD>
<TD width=62%>A system command is about to be carried out. This allows a CBT application to prevent task switching by means of hot keys.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>If <I>nCode</I> is less than zero, the hook procedure must pass the message to the <A HREF="2ebdbc.htm"><B>CallNextHookEx</B></A> function without further processing and should return the value returned by <B>CallNextHookEx</B>. </P>

<P><I>wParam</I></P>

<P>Depends on the <I>nCode</I> parameter. For details, see the following Remarks section. </P>

<P><I>lParam</I></P>

<P>Depends on the <I>nCode</I> parameter. For details, see the following Remarks section. </P>

<P></P>

<P><B>Return Values</B></P>

<P>For operations corresponding to the following CBT hook codes, the return value must be 0 to allow the operation, or 1 to prevent it: </P>

<P>HCBT_ACTIVATE<BR>
HCBT_CREATEWND<BR>
HCBT_DESTROYWND<BR>
HCBT_MINMAX<BR>
HCBT_MOVESIZE<BR>
HCBT_SETFOCUS<BR>
HCBT_SYSCOMMAND</P>

<P>For operations corresponding to the following CBT hook codes, the return value is ignored: </P>

<P>HCBT_CLICKSKIPPED<BR>
HCBT_KEYSKIPPED<BR>
HCBT_QS</P>

<P><B>Remarks</B></P>

<P>The hook procedure should not install a <A HREF="17p7nrh.htm">WH_JOURNALPLAYBACK_hook</A> hook procedure except in the situations described in the preceding list of hook codes. </P>

<P>This hook procedure must be in a dynamic-link library (DLL). An application installs the hook procedure by specifying the WH_CBT hook type and the address of the hook procedure in a call to the <A HREF="2d7__i2.htm"><B>SetWindowsHookEx</B></A> function. </P>

<P>The following table describes the <I>wParam</I> and <I>lParam</I> parameters for each HCBT_ hook code: </P>

<TABLE cols=3>

<TR VALIGN="top">
<TD width=34%><B>Value</B></TD>
<TD width=25%><B>wParam</B></TD>
<TD width=41%><B>lParam</B></TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>HCBT_ACTIVATE</B></TD>
<TD width=25%>Specifies the handle to the window about to be activated.</TD>
<TD width=41%>Specifies a long pointer to a <A HREF="al5vak.htm"><B>CBTACTIVATESTRUCT</B></A> structure containing the handle to the active window and specifies whether the activation is changing because of a mouse click.  </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>HCBT_CLICKSKIPPED</B></TD>
<TD width=25%>Identifies the mouse message removed from the system message queue.</TD>
<TD width=41%>Specifies a long pointer to a <A HREF="13c74vj.htm"><B>MOUSEHOOKSTRUCT</B></A> structure containing the hit-test code and the handle to the window for which the mouse message is intended. 
<P>The HCBT_CLICKSKIPPED value is sent to a <B>CBTProc</B> hook procedure only if a WH_MOUSE hook is installed. For a list of hit-test codes, see <A HREF="1_tnzjb.htm"><B>WM_NCHITTEST</B></A> .  </P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>HCBT_CREATEWND</B></TD>
<TD width=25%>Specifies the handle to the new window.</TD>
<TD width=41%>Specifies a long pointer to a <A HREF="4mzo9_.htm"><B>CBT_CREATEWND</B></A> structure containing initialization parameters for the window. The parameters include the coordinates and dimensions of the window. By changing these parameters, a <B>CBTProc</B> hook procedure can set the initial size and position of the window.  </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>HCBT_DESTROYWND</B></TD>
<TD width=25%>Specifies the handle to the window about to be destroyed.</TD>
<TD width=41%>Is undefined and must be set to zero. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>HCBT_KEYSKIPPED</B></TD>
<TD width=25%>Identifies the virtual-key code.</TD>
<TD width=41%>Specifies the repeat count, scan code, key-transition code, previous key state, and context code. The HCBT_KEYSKIPPED value is sent to a <B>CBTProc</B> hook procedure only if a WH_KEYBOARD hook is installed. For more information, see the <A HREF="1ubr_9n.htm"><B>WM_KEYUP</B></A> or <A HREF="cxjo_p.htm"><B>WM_KEYDOWN</B></A> message. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>HCBT_MINMAX</B></TD>
<TD width=25%>Specifies the handle to the window being minimized or maximized.</TD>
<TD width=41%>Specifies, in the low-order word, a show-window value (SW_) specifying the operation. For a list of show-window values, see the <A HREF="3mejbzs.htm"><B>ShowWindow</B></A>. The high-order word is undefined. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>HCBT_MOVESIZE</B></TD>
<TD width=25%>Specifies the handle to the window to be moved or sized.</TD>
<TD width=41%>Specifies a long pointer to a <A HREF="ezena2.htm"><B>RECT</B></A> structure containing the coordinates of the window. By changing the values in the structure, a <B>CBTProc</B> hook procedure can set the final coordinates of the window.  </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>HCBT_QS</B></TD>
<TD width=25%>Is undefined and must be zero.</TD>
<TD width=41%>Is undefined and must be zero. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>HCBT_SETFOCUS</B></TD>
<TD width=25%>Specifies the handle to the window gaining the keyboard focus.</TD>
<TD width=41%>Specifies the handle to the window losing the keyboard focus. </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>HCBT_SYSCOMMAND</B></TD>
<TD width=25%>Specifies a system-command value (SC_) specifying the system command. For more information about system-command values, see <A HREF="3xmtv4t.htm"><B>WM_SYSCOMMAND</B></A>. </TD>
<TD width=41%>Contains the same data as the <I>lParam</I> value of a <A HREF="3xmtv4t.htm"><B>WM_SYSCOMMAND</B></A> message: If a system menu command is chosen with the mouse, the low-order word contains the x-coordinate of the cursor, in screen coordinates, and the high-order word contains the y-coordinate; otherwise, the parameter is not used. </TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>CBTProc</B> is a placeholder for the application-defined or library-defined function name. </P>

<P><B>See Also</B></P>

<P><A HREF="2ebdbc.htm"><B>CallNextHookEx</B></A>,<B> <A HREF="we1r5q.htm">CreateWindow</A></B>,<B> <A HREF="2d7__i2.htm">SetWindowsHookEx</A></B>,<B> </B><A HREF="3xmtv4t.htm">WM_SYSCOMMAND</A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
