<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WM_GETTEXTLENGTH</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="16t.gdk"></A><B>WM_GETTEXTLENGTH  <A HREF="_z09gp.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1p1lg2i.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="2n04rtj.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>An application sends a WM_GETTEXTLENGTH message to determine the length, in characters, of the text associated with a window. The length does not include the terminating null character. </P>

<P>WM_GETTEXTLENGTH  </P>

<P>wParam = 0; // not used; must be zero </P>

<P>lParam = 0; // not used; must be zero </P>

<P></P>

<P><B>Parameters</B></P>

<P>This message has no parameters. </P>

<P><B>Return Values</B></P>

<P>The return value is the length, in characters, of the text. </P>

<P><B>Default Action</B></P>

<P>The <A HREF="32d1nbh.htm"><B>DefWindowProc</B></A> function returns the length, in characters, of the text. Under certain conditions, this value may actually be greater than the length of the text. For more information, see the following Remarks section.</P>

<P><B>Remarks</B></P>

<P>For an edit control, the text to be copied is the content of the edit control. For a combo box, the text is the content of the edit control (or static-text) portion of the combo box. For a button, the text is the button name. For other windows, the text is the window title. To determine the length of an item in a list box, an application can use the LB_GETTEXTLEN message. </P>

<P>Under certain conditions, the <A HREF="32d1nbh.htm"><B>DefWindowProc</B></A><B> </B>function returns a value that is larger than the actual length of the text. This occurs with certain mixtures of ANSI and Unicode, and is due to the operating system allowing for the possible existence of DBCS characters within the text. The return value, however, will always be at least as large as the actual length of the text; you can thus always use it to guide buffer allocation. This behavior can occur when an application uses both ANSI functions and common dialogs, which use Unicode. </P>

<P>To obtain the exact length of the text, use the WM_GETTEXT, LB_GETTEXT, or CB_GETLBTEXT messages, or the <B>GetWindowText</B> function.</P>

<P><B>See Also</B></P>

<P><A HREF="ibsg8m.htm">CB_GETLBTEXT</A>, <A HREF="32d1nbh.htm"><B>DefWindowProc</B></A>, <A HREF="9911lt.htm"><B>GetWindowText</B></A>, <A HREF="k2czsw.htm"><B>GetWindowTextLength</B></A>, <A HREF="3w.ajt.htm">LB_GETTEXT</A>, <A HREF="1pwxmwl.htm">LB_GETTEXTLEN</A>, <A HREF="g5lbj5.htm">WM_GETTEXT</A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
