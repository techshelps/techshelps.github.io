<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Accelerator Tables</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="kgzgkp"></A><B>Accelerator Tables</B></P>

<P>An <I>accelerator table</I> consists of an array of <A HREF="le60xl.htm"><B>ACCEL</B></A> structures, each defining an individual accelerator. Each <B>ACCEL</B> structure includes the following information: </P>

<P>·The accelerator's keystroke combination. </P>

<P>·The accelerator's identifier. </P>

<P>·Various flags. This includes one that specifies whether Windows is to provide visual feedback by highlighting the corresponding menu item, if any, when the accelerator is used </P>

<P></P>

<P>To process accelerator keystrokes for a given thread, the developer must call the <A HREF="288m6o.htm"><B>TranslateAccelerator</B></A> function in the message loop associated with the thread's message queue. The <B>TranslateAccelerator</B> function monitors keyboard input to the message queue, checking for key combinations that match an entry in the accelerator table. When <B>TranslateAccelerator</B> finds a match, it translates the keyboard input (that is, the <A HREF="1ubr_9n.htm">WM_KEYUP</A> and <A HREF="cxjo_p.htm">WM_KEYDOWN</A> messages) into a <A HREF="71v.3j.htm">WM_COMMAND</A> or <A HREF="3xmtv4t.htm">WM_SYSCOMMAND</A> message and then sends the message to the window procedure of the specified window. The following illustration shows how accelerators are processed. </P>

<P><IMG SRC="../images/bm19.gif" ALT="" BORDER=0></P>

<P>The WM_COMMAND message includes the identifier of the accelerator that caused <B>TranslateAccelerator</B> to generate the message. The window procedure examines the identifier to determine the source of the message and then processes the message accordingly. </P>

<P>Accelerator tables exist at two different levels in Windows. Windows maintains a single, system-wide accelerator table that applies to all applications. An application cannot modify the system accelerator table. For a description of the accelerators provided by the system accelerator table, see <A HREF="16n14c.htm">Accelerator Keystroke Assignments</A>. </P>

<P>Windows also maintains accelerator tables for each application. An application can define any number of accelerator tables for use with its own windows. A unique 32-bit handle (<B>HACCEL</B>) identifies each table. However, only one accelerator table can be active at a time for a given thread. The handle of the accelerator table passed to the <A HREF="288m6o.htm"><B>TranslateAccelerator</B></A> function determines which accelerator table is active for a thread. The active accelerator table can be changed at any time by passing a different accelerator-table handle to <B>TranslateAccelerator</B>. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
