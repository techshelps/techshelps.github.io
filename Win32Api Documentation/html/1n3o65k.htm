<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Creating a Shortcut to a Nonfile Object</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1n3o65k"></A><B>Creating a Shortcut to a Nonfile Object</B></P>

<P>Creating a shortcut to a nonfile object, such as a printer, is similar to creating a shortcut to a file. The main difference is that, rather than setting the path to the file, you must set the identifier list to the printer. To set the identifier list, you must call the <A HREF="8h5jbg.htm"><B>IShellLink::SetIDList</B></A> member function, specifying the address of an identifier list.</P>

<P>Each object within the shell's namespace has an item identifier, a variable-length byte stream containing information that identifies the object within its folder. The shell often concatenates item identifiers into null-terminated lists consisting of any number of item identifiers. </P>

<P>In general, if you need to set a shortcut to an item that does not have a filename, such as a printer, you will already have a pointer to the object's <A HREF="113z9we.htm"><B>IShellFolder</B></A> interface. The <B>IShellFolder</B> interface is used to create namespace extensions. </P>

<P>Once you have the class identifier for the <B>IShellFolder</B> interface, you can call the <B>CoCreateInstance</B> function to get the address of the interface. Then you can call the interface to enumerate the objects in the folder and retrieve the address of the item identifier for the object that you are searching for. Finally, you can use the address in a call to the <B>IShellLink::SetIDList</B> member function to create a shortcut to the object.</P>

</BODY>
</HTML>
