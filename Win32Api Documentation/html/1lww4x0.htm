<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>RegisterEventSource</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1lww4x0"></A><B>RegisterEventSource  <A HREF="6_g0uf.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="ejmiui.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="gw7e2k.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>RegisterEventSource</B> function returns a handle that can be used with the <A HREF="49908m.htm"><B>ReportEvent</B></A> function to log an event. </P>

<P>Any source name can be used; it will be carried in the event log record so that Event Viewer can use it for filtering. </P>

<P><B>HANDLE RegisterEventSource(</B></P>

<TABLE cols=2 width=486>

<TR VALIGN="top">
<TD width=47%><B>LPCTSTR</B> <I>lpUNCServerName</I><B>,</B></TD>
<TD width=53%>// server name for source </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    LPCTSTR</B> <I>lpSourceName</I> </TD>
<TD width=53%>// source name for registered handle  </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>   );</B></TD>
<TD width=53%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpUNCServerName</I></P>

<P>Points to a null-terminated string that specifies the Universal Naming Convention (UNC) name of the server on which this operation is to be performed. If this parameter is NULL, the operation is performed on the local computer. </P>

<P><I>lpSourceName</I></P>

<P>Points to a null-terminated string that specifies the name of the source referenced by the returned handle. The source name must be a subkey of a logfile entry under the <B>EventLog</B> key in the registry. For example, the source name WinApp would be valid if the registry had the following form: </P>

<P>HKEY_LOCAL_MACHINE  </P>

<P>System </P>

<P>CurrentControlSet </P>

<P>Services </P>

<P>EventLog </P>

<P>Application </P>

<P>WinApp </P>

<P>Security </P>

<P>System </P>

<P></P>

<P>If the source name cannot be found, the event logging service uses the <B>Application</B> logfile with no message files for the event identifier or category. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is a handle that can be used with the <B>ReportEvent</B> function.</P>

<P>If the function fails, the return value is NULL. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>See Also</B></P>

<P><A HREF="1203jtr.htm"><B>DeregisterEventSource</B></A>, <A HREF="49908m.htm"><B>ReportEvent</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
