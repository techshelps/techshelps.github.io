<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetShortPathName</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="9uttyv"></A><B>GetShortPathName  <A HREF="4oy0d1.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="qnj9so.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1f83g2.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetShortPathName</B> function obtains the short path form of a specified input path. </P>

<P><B>DWORD GetShortPathName(</B></P>

<TABLE cols=2 width=645>

<TR VALIGN="top">
<TD width=30%><B>LPCTSTR</B> <I>lpszLongPath</I><B>,</B></TD>
<TD width=70%>// points to a null-terminated path string</TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>    LPTSTR</B> <I>lpszShortPath</I><B>,</B></TD>
<TD width=70%>// points to a buffer to receive the null-terminated short form of the path </TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>    DWORD</B> <I>cchBuffer</I> </TD>
<TD width=70%>// specifies the size of the buffer pointed to by <I>lpszShortPath</I></TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>   );</B></TD>
<TD width=70%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpszLongPath</I></P>

<P>Points to a null-terminated path string. The function obtains the short form of this path.</P>

<P><I>lpszShortPath</I></P>

<P>Points to a buffer to receive the null-terminated short form of the path specified by <I>lpszLongPath</I>.</P>

<P><I>cchBuffer</I></P>

<P>Specifies the size, in characters, of the buffer pointed to by <I>lpszShortPath</I>.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is the length, in characters, of the string copied to <I>lpszShortPath</I>, not including the terminating null character.</P>

<P>If the function fails due to the <I>lpszShortPath</I> buffer being too small to contain the short path string, the return value is the size, in characters, of the short path string. You need to call the function with a short path buffer that is at least as large as the short path string. </P>

<P>If the function fails for any other reason, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>.</P>

<P><B>Remarks</B></P>

<P>When an application calls this function and specifies a path on a volume that does not support 8.3 aliases, the function fails with ERROR_INVALID_PARAMETER if the path is longer than 67 bytes.</P>

<P>The path specified by <I>lpszLongPath</I> does not have to be a fully qualified path or a long path. The short form may be longer than the specifed path. </P>

<P>If the specified path is already in its short form, there is no need for any conversion, and the function simply copies the specified path to the buffer for the short path. </P>

<P>You can set <I>lpszShortPath</I> to the same value as <I>lpszLongPath</I>; in other words, you can set the buffer for the short path to the address of the input path string. </P>

<P>You can obtain the long name of a file from the short name by calling the <B>FindFirstFile</B> function. </P>

<P><B>See Also</B></P>

<P><A HREF="8n6hyc.htm"><B>GetFullPathName</B></A>, <A HREF="2a0z0q6.htm"><B>FindFirstFile</B></A> </P>

</BODY>
</HTML>
