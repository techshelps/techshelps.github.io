<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Translating Character Messages</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1n11jss"></A><B>Translating Character Messages</B></P>

<P>Any thread that receives character input from the user must include the <A HREF="fhwolf.htm"><B>TranslateMessage</B></A> function in its message loop. This function examines the virtual-key code of a keystroke message and, if the code corresponds to a character, places a character message into the message queue. The character message is removed and dispatched on the next iteration of the message loop; the <I>wParam</I> parameter of the message contains the character code. </P>

<P>In general, a thread's message loop should use the <B>TranslateMessage</B> function to translate every message, not just virtual-key messages. Although <B>TranslateMessage</B> has no effect on other types of messages, it guarantees that keyboard input is translated correctly. The following example shows how to include the <B>TranslateMessage</B> function in a typical thread message loop. </P>

<P>while (GetMessage(&amp;msg, (HWND) NULL, 0, 0)) {  </P>

<P>if (TranslateAccelerator(hwndMain, haccl, &amp;msg) == 0) { </P>

<P>TranslateMessage(&amp;msg); </P>

<P>DispatchMessage(&amp;msg); </P>

<P>} </P>

<P>} </P>

<P></P>

</BODY>
</HTML>
