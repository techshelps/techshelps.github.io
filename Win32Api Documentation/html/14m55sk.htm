<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>RasGetSubEntryProperties [New - Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="14m55sk"></A><B>RasGetSubEntryProperties  <A HREF="l7oj7g.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="35kj_0r.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="lrsi7i.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>[New - Windows NT]</P>

<P>The <B>RasGetSubEntryProperties</B> function retrieves information about a subentry for a specified phone-book entry. </P>

<P><B>DWORD RasGetSubEntryProperties(</B></P>

<TABLE cols=2 width=663>

<TR VALIGN="top">
<TD width=39%><B>LPTSTR</B> <I>lpszPhonebook</I><B>,</B></TD>
<TD width=61%>// pointer to full path and filename of phone-book file</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    LPTSTR</B> <I>lpszEntry</I><B>,</B></TD>
<TD width=61%>// pointer to an entry name</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    DWORD</B> <I>dwSubEntry</I><B>,</B></TD>
<TD width=61%>// index of the subentry</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    LPRASSUBENTRY</B> <I>lpRasSubEntry</I><B>,</B></TD>
<TD width=61%>// pointer to structure that receives information about subentry</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    LPDWORD</B> <I>lpdwcb</I></TD>
<TD width=61%>// size, in bytes, of the structure</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>   );</B></TD>
<TD width=61%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpszPhonebook</I></P>

<P><B>Windows NT: </B>Pointer to a null-terminated string that specifies the full path and filename of a phone-book (.PBK) file. If this parameter is NULL, the function uses the current default phone-book file. The default phone-book file is the one selected by the user in the <B>User Preferences</B> property sheet of the <B>Dial-Up Networking</B> dialog box.</P>

<P><I>lpszEntry</I></P>

<P>Pointer to a null-terminated string containing the name of an existing entry in the phone book.</P>

<P><I>dwSubEntry</I></P>

<P>Specifies the one-based index of the subentry.</P>

<P><I>lpRasSubEntry</I></P>

<P>Pointer to a <A HREF="1nznwsp.htm"><B>RASSUBENTRY</B></A> structure followed by additional bytes for the alternate phone number list, if there is one. The structure receives the information about the specified subentry. Before calling the function, set the <B>dwSize</B> member of the structure to sizeof(RASSUBENTRY) to identify the version of the structure. This parameter can be NULL.</P>

<P><I>lpdwcb</I></P>

<P>Pointer to a variable that contains the size, in bytes, of the <I>lpRasSubEntry</I> buffer. On return, the function sets this variable to the number of bytes returned, or the number of bytes required if the buffer is too small. This parameter can be NULL if <I>lpRasSubEntry</I> is NULL.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is zero.</P>

<P>If the function fails, the return value can be one of the following error codes. </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=62%><B>Value</B></TD>
<TD width=38%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=62%>ERROR_INVALID_PARAMETER </TD>
<TD width=38%>The function was called with an invalid parameter.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>ERROR_BUFFER_INVALID </TD>
<TD width=38%>The address or buffer specified by <I>lpRasSubEntry </I>is invalid.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>ERROR_BUFFER_TOO_SMALL </TD>
<TD width=38%>The <I>lpRasSubEntry</I> buffer is too small. The <I>lpdwcb </I>variable receives the required buffer size. </TD>
</TR>

<TR VALIGN="top">
<TD width=62%>ERROR_CANNOT_OPEN_PHONEBOOK </TD>
<TD width=38%>The phone book is corrupted or is missing components.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>ERROR_CANNOT_FIND_PHONEBOOK_ENTRY</TD>
<TD width=38%>The phone-book entry does not exist.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>A RAS phone-book entry can have zero or more subentries, each minimally consisting of a device and a phone number. A phone-book entry with multiple subentries can be configured to dial the first available or all subentries when the entry is dialed.</P>

<P>Use the <B>RasGetEntryProperties</B> function to retrieve a <B>RASENTRY</B> structure containing information about the subentries of a phone-book entry. The <B>dwSubEntries</B> member indicates the number of subentries and the <B>dwDialMode</B> member indicates the dialing configuration.</P>

<P><B>See Also</B></P>

<P><A HREF="3rcv.yk.htm"><B>RasGetEntryProperties</B></A>, <A HREF="vji5sp.htm"><B>RASENTRY</B></A>, <A HREF="1br3dv6.htm"><B>RasSetSubEntryProperties</B></A>, <A HREF="1nznwsp.htm"><B>RASSUBENTRY</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
