<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetClipboardData</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="61r7gx"></A><B>GetClipboardData  <A HREF="22vwrpt.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="32linv3.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="9647hm.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetClipboardData</B> function retrieves data from the clipboard in a specified format. The clipboard must have been opened previously. </P>

<P><B>HANDLE GetClipboardData(</B></P>

<TABLE cols=2 width=285>

<TR VALIGN="top">
<TD width=48%><B>UINT</B> <I>uFormat</I> </TD>
<TD width=52%>// clipboard format  </TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>   );</B></TD>
<TD width=52%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>uFormat</I></P>

<P>Specifies a clipboard format. For a description of the clipboard formats, see the <A HREF="1uhxs93.htm"><B>SetClipboardData</B></A> function. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is the handle of a clipboard object in the specified format.</P>

<P>If the function fails, the return value is NULL. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>An application can enumerate the available formats in advance by using the <A HREF="tiao4c.htm"><B>EnumClipboardFormats</B></A> function. </P>

<P>The clipboard controls the handle that the <B>GetClipboardData</B> function returns, not the application. The application should copy the data immediately. The application cannot rely on being able to make long-term use of the handle. The application must not free the handle nor leave it locked. </P>

<P>The operating system performs implicit data format conversions between certain clipboard formats when an application calls the <A HREF="#61r7gx"><B>GetClipboardData</B></A> function. For example, if the CF_OEMTEXT format is on the clipboard, a window can retrieve data in the CF_TEXT format. The format on the clipboard is converted to the requested format on demand. The following table shows the clipboard data type conversions that are available. Note that some of these automatic type conversions are not available on all platforms.</P>

<TABLE cols=3>

<TR VALIGN="top">
<TD width=31%><B>Clipboard Format</B></TD>
<TD width=30%><B>Conversion Format</B></TD>
<TD width=39%><B>Platform Support</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>CF_BITMAP</TD>
<TD width=30%>CF_DIB</TD>
<TD width=39%>Windows NT, Windows 95</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>CF_DIB</TD>
<TD width=30%>CF_BITMAP</TD>
<TD width=39%>Windows NT, Windows 95</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>CF_DIB</TD>
<TD width=30%>CF_PALETTE</TD>
<TD width=39%>Windows NT, Windows 95</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>CF_ENHMETAFILE</TD>
<TD width=30%>CF_METAFILEPICT</TD>
<TD width=39%>Windows NT, Windows 95</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>CF_METAFILEPICT</TD>
<TD width=30%>CF_ENHMETAFILE</TD>
<TD width=39%>Windows NT, Windows 95</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>CF_OEMTEXT</TD>
<TD width=30%>CF_TEXT</TD>
<TD width=39%>Windows NT, Windows 95</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>CF_OEMTEXT</TD>
<TD width=30%>CF_UNICODETEXT</TD>
<TD width=39%>Windows NT</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>CF_TEXT</TD>
<TD width=30%>CF_OEMTEXT</TD>
<TD width=39%>Windows NT, Windows 95</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>CF_TEXT</TD>
<TD width=30%>CF_UNICODETEXT</TD>
<TD width=39%>Windows NT</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>CF_UNICODETEXT</TD>
<TD width=30%>CF_OEMTEXT</TD>
<TD width=39%>Windows NT</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>CF_UNICODETEXT</TD>
<TD width=30%>CF_TEXT</TD>
<TD width=39%>Windows NT</TD>
</TR>
</TABLE><BR>

<P></P>

<P>If the operating system provides an automatic type conversion for a particular clipboard format, there is no advantage to placing the conversion format(s) on the clipboard.</P>

<P>If the system provides an automatic type conversion for a particular clipboard format, and you call <A HREF="tiao4c.htm"><B>EnumClipboardFormats</B></A> to enumerate the clipboard data formats, the operating system first enumerates the format that is on the clipboard, followed by the formats to which it can be converted.</P>

<P>If the clipboard contains data in the CF_PALETTE format, the application should use the <B>SelectPalette</B> and <B>RealizePalette</B> functions to realize any other data in the clipboard against that logical palette.</P>

<P>See <B>SetClipboardData</B> for further information on specific clipboard data formats.</P>

<P><B>See Also</B></P>

<P><A HREF="tiao4c.htm"><B>EnumClipboardFormats</B></A>, <A HREF="1uhxs93.htm"><B>SetClipboardData</B></A>, <A HREF="d.58yj.htm"><B>RealizePalette</B></A>, <A HREF="4zx._h5.htm"><B>SelectPalette</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
