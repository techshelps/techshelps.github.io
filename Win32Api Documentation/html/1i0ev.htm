<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Initialization</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1i0ev"></A><B>Initialization</B></P>

<P>Before calling any other DDEML function, an application must call the <A HREF="1_pfuxk.htm"><B>DdeInitialize</B></A> function. <B>DdeInitialize</B> obtains an instance identifier for the application, registers the application's DDE callback function with the DDEML, and specifies the transaction filter flags for the callback function. </P>

<P>Each instance of an application or a dynamic-link library (DLL) must pass its instance identifier as the <I>idInst</I> parameter to any other DDEML function that requires it. The purpose of multiple DDEML instances is to support DLLs that must use the DDEML at the same time an application is using it. An application must not use more than one instance of the DDEML. </P>

<P><I>Transaction filters</I> optimize system performance by preventing the DDEML from passing unwanted transactions to the application's DDE callback function. An application sets the transaction filters when it calls <B>DdeInitialize</B>. An application must specify a transaction filter flag for each type of transaction that it does not process in its callback function. An application can change its transaction filters with a subsequent call to <B>DdeInitialize</B>. For a complete list of transaction filter flags, see the description of <B>DdeInitialize</B> in the <I>Microsoft Win32 Programmer's Reference, Volume 3</I>. For more information about transactions, see <A HREF="cb55_c.htm">Transaction Management</A>. </P>

<P>The following example shows how to initialize an application to use the DDEML. </P>

<P>DWORD idInst = 0;  </P>

<P>HINSTANCE hinst;  </P>

<P></P>

<P>. </P>

<P>. </P>

<P>. </P>

<P>DdeInitialize(&amp;idInst,         /* receives instance identifier */ </P>

<P>(PFNCALLBACK) DdeCallback, /* address of callback function */ </P>

<P>CBF_FAIL_EXECUTES |        /* filter XTYPE_EXECUTE         */ </P>

<P>CBF_SKIP_ALLNOTIFICATIONS, /* filter notifications         */ </P>

<P>0); </P>

<P>. </P>

<P>. </P>

<P>. </P>

<P></P>

<P>An application must call the <A HREF="cod.6m.htm"><B>DdeUninitialize</B></A> function when it is no longer going to use the DDEML. This function terminates any conversations currently open for the application and frees the DDEML resources the system allocated for the application. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
