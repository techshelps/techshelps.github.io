<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetTokenInformation</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="kt5z95"></A><B>GetTokenInformation  <A HREF="iuk.m6.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1966ja.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="afqqmm.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetTokenInformation</B> function retrieves a specified type of information about an access token. The calling process must have appropriate access rights to obtain the information. </P>

<P><B>BOOL GetTokenInformation(</B></P>

<TABLE cols=2 width=626>

<TR VALIGN="top">
<TD width=62%><B>HANDLE</B> <I>TokenHandle</I><B>,</B></TD>
<TD width=38%>// handle of access token</TD>
</TR>

<TR VALIGN="top">
<TD width=62%><B>    TOKEN_INFORMATION_CLASS</B> <I>TokenInformationClass</I><B>,</B></TD>
<TD width=38%>// type of information to retrieve</TD>
</TR>

<TR VALIGN="top">
<TD width=62%><B>    LPVOID</B> <I>TokenInformation</I><B>,</B></TD>
<TD width=38%>// address of retrieved information </TD>
</TR>

<TR VALIGN="top">
<TD width=62%><B>    DWORD</B> <I>TokenInformationLength</I><B>,</B></TD>
<TD width=38%>// size of information buffer</TD>
</TR>

<TR VALIGN="top">
<TD width=62%><B>    PDWORD</B> <I>ReturnLength</I> </TD>
<TD width=38%>// address of required buffer size</TD>
</TR>

<TR VALIGN="top">
<TD width=62%><B>   );</B></TD>
<TD width=38%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>TokenHandle</I></P>

<P>Identifies an access token from which information is retrieved. </P>

<P><I>TokenInformationClass</I></P>

<P>Specifies a variable of the <A HREF="z2c1h2.htm"><B>TOKEN_INFORMATION_CLASS</B></A> enumerated type identifying the type of information the function retrieves. </P>

<P><I>TokenInformation</I></P>

<P>Points to a buffer the function fills with the requested information. The structure put into this buffer depends upon the type of information specified by the <I>TokenInformationClass</I> parameter, as shown in the following list: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=40%><B>Token Information Class</B></TD>
<TD width=60%><B>Structure Returned</B></TD>
</TR>

<TR VALIGN="top">
<TD width=40%>TokenUser</TD>
<TD width=60%><A HREF="6e5y_o7.htm"><B>TOKEN_USER</B></A> structure. TOKEN_QUERY access is needed to retrieve this information.</TD>
</TR>

<TR VALIGN="top">
<TD width=40%>TokenGroups</TD>
<TD width=60%><A HREF="qokoo8.htm"><B>TOKEN_GROUPS</B></A> structure. TOKEN_QUERY access is needed to retrieve this information.</TD>
</TR>

<TR VALIGN="top">
<TD width=40%>TokenPrivileges</TD>
<TD width=60%><A HREF="199qkb..htm"><B>TOKEN_PRIVILEGES</B></A> structure. TOKEN_QUERY access is needed to retrieve this information.</TD>
</TR>

<TR VALIGN="top">
<TD width=40%>TokenOwner</TD>
<TD width=60%><A HREF="1369g97.htm"><B>TOKEN_OWNER</B></A> structure. TOKEN_QUERY access is needed to retrieve this information.</TD>
</TR>

<TR VALIGN="top">
<TD width=40%>TokenPrimaryGroup</TD>
<TD width=60%><A HREF="21rzul3.htm"><B>TOKEN_PRIMARY_GROUP</B></A> structure. TOKEN_QUERY access is needed to retrieve this information.</TD>
</TR>

<TR VALIGN="top">
<TD width=40%>TokenDefaultDacl</TD>
<TD width=60%><A HREF="2uqc8we.htm"><B>TOKEN_DEFAULT_DACL</B></A> structure. TOKEN_QUERY access is needed to retrieve this information.</TD>
</TR>

<TR VALIGN="top">
<TD width=40%>TokenSource</TD>
<TD width=60%><A HREF="1l21edo.htm"><B>TOKEN_SOURCE</B></A> structure. TOKEN_QUERY_SOURCE access is needed to retrieve this information.</TD>
</TR>

<TR VALIGN="top">
<TD width=40%>TokenType</TD>
<TD width=60%><A HREF="_get7w.htm"><B>TOKEN_TYPE</B></A> enumerated type. TOKEN_QUERY access is needed to retrieve this information.</TD>
</TR>

<TR VALIGN="top">
<TD width=40%>TokenImpersonationLevel</TD>
<TD width=60%><A HREF="7c9aq0.htm"><B>SECURITY_IMPERSONATION_LEVEL</B></A> enumerated type. TOKEN_QUERY access is needed to retrieve this information about a token. If the access token is not an impersonation token, the function fails.</TD>
</TR>

<TR VALIGN="top">
<TD width=40%>TokenStatistics</TD>
<TD width=60%><A HREF="7d_toe.htm"><B>TOKEN_STATISTICS</B></A> structure. TOKEN_QUERY access is needed to retrieve this information.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>The formats for the retrieved structures and enumerated types are listed in the following Remarks section. </P>

<P><I>TokenInformationLength</I></P>

<P>Specifies the size, in bytes, of the buffer pointed to by the <I>TokenInformation</I> parameter. </P>

<P><I>ReturnLength</I></P>

<P>Points to a variable receiving the actual number of bytes needed for the buffer pointed to by the <I>TokenInformation</I> parameter. If this value is larger than the value specified in the <I>TokenInformationLength</I> parameter, the function fails and stores no data in the buffer. </P>

<P>If the value of the <I>TokenInformationClass</I> parameter is <B>TokenDefaultDacl</B> and the token has no default access-control list, the function sets the variable pointed to by <I>ReturnLength</I> to zero and stores no data in the buffer. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>See Also</B></P>

<P><A HREF="6m1u_m2.htm"><B>AdjustTokenGroups</B></A>,<B> <A HREF="1e0u7w4.htm">AdjustTokenPrivileges</A></B>,<B> <A HREF="1r9su.q.htm">OpenProcessToken</A></B>,<B> <A HREF="bsqiuv.htm">OpenThreadToken</A></B>,<B> <A HREF="2ido0z..htm">SetTokenInformation</A></B>, <A HREF="7c9aq0.htm"><B>SECURITY_IMPERSONATION_LEVEL</B></A>, <A HREF="2uqc8we.htm"><B>TOKEN_DEFAULT_DACL</B></A>, <A HREF="qokoo8.htm"><B>TOKEN_GROUPS</B></A>, <A HREF="z2c1h2.htm"><B>TOKEN_INFORMATION_CLASS</B></A>, <A HREF="1369g97.htm"><B>TOKEN_OWNER</B></A>, <A HREF="21rzul3.htm"><B>TOKEN_PRIMARY_GROUP</B></A>, <A HREF="199qkb..htm"><B>TOKEN_PRIVILEGES</B></A>, <A HREF="1l21edo.htm"><B>TOKEN_SOURCE</B></A>, <A HREF="7d_toe.htm"><B>TOKEN_STATISTICS</B></A>, <A HREF="_get7w.htm"><B>TOKEN_TYPE</B></A>, <A HREF="6e5y_o7.htm"><B>TOKEN_USER</B></A> </P>

</BODY>
</HTML>
