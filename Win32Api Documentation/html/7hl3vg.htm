<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Thread Connection to a Desktop</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="7hl3vg"></A><B>Thread Connection to a Desktop</B></P>

<P>After a <A HREF="9.tca.htm">process connects to a window station</A>, the Win32 server assigns a desktop to the thread making the connection to Win32. The desktop assigned during this connection process cannot be closed by calling the <A HREF="6k98g0.htm"><B>CloseDesktop</B></A> function. The Win32 server determines the desktop to assign to the thread according to the following rules:</P>

<P>1.If the thread has called the <A HREF="1n0x8yo.htm"><B>SetThreadDesktop</B></A> function, it connects to the specified desktop.</P>

<P>2.If the thread did not call <B>SetThreadDesktop</B>, it connects to the desktop inherited from the parent process.</P>

<P>3.If the thread did not call <B>SetThreadDesktop</B> and did not inherit a desktop, the Win32 server attempts to open for MAXIMUM_ALLOWED access and connect to a desktop as follows:</P>

<P>a.If a desktop name was specified in the <B>lpDesktop</B> member of the <A HREF="d.kh8s.htm"><B>STARTUPINFO</B></A> structure that was passed to the <A HREF="5fbj_xx.htm"><B>CreateProcess</B></A> function when the process was created, the thread connects to the specified desktop.</P>

<P>b.Otherwise, the thread connects to the default desktop of the window station to which the process connected.</P>

<P>The desktop assigned during this connection process cannot be closed by calling the <A HREF="6k98g0.htm"><B>CloseDesktop</B></A> function.</P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
