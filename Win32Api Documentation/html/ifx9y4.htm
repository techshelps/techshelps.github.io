<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Customizing the Find or Replace Dialog Box</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="ifx9y4"></A><B>Customizing the Find or Replace Dialog Box</B></P>

<P>To customize a Find or Replace dialog box, you can use any of the following methods: </P>

<P>·Specify values in the <A HREF="1de83do.htm"><B>FINDREPLACE</B></A> structure when you create the dialog box</P>

<P>·Provide a custom template</P>

<P>·Provide a hook procedure</P>

<P></P>

<P>When you create a Find or Replace dialog box, you can set flags in the <B>Flags</B> member of the <B>FINDREPLACE</B> structure to hide or disable any of the search option controls. For example, you can set the FR_NOMATCHCASE flag to disable the Match Case check box or set the FR_HIDEMATCHCASE flag to hide it.</P>

<P>You can provide a custom template for a Find or Replace dialog box, for example, if you want to include additional controls that are unique to your application. The <A HREF="55jx_hv.htm"><B>FindText</B></A><B> </B>and<B> <A HREF="1s0xwwr.htm">ReplaceText</A></B> functions use your custom template in place of the default template. </P>

<P><B><IMG SRC="../images/bm4.gif" ALT="" BORDER=0>To provide a custom template for a Find or Replace dialog box</B></P>

<P>1.Create the custom template by modifying the default template specified in the FINDTEXT.DLG file. The control identifiers used in the default Find or Replace dialog template are defined in the DLGS.H file.</P>

<P>2.Use the <A HREF="1de83do.htm"><B>FINDREPLACE</B></A> structure to enable the template as follows:</P>

<P>·If your custom template is a resource in an application or dynamic-link library, set the FR_ENABLETEMPLATE flag in the <B>Flags</B> member. Use the <B>hInstance</B> and <B>lpTemplateName</B> members of the structure to identify the module and resource name. </P>

<P><B>-Or-</B></P>

<P>·If your custom template is already in memory, set the FR_ENABLETEMPLATEHANDLE flag. Use the <B>hInstance</B> member to identify the memory object that contains the template. </P>

<P></P>

<P>You can provide an <A HREF="13618ab.htm"><B>FRHookProc</B></A> hook procedure for a Find or Replace dialog box. The hook procedure can process messages sent to the dialog box. If you use a custom template to define additional controls, you must provide a hook procedure to process input for your controls. </P>

<P><B><IMG SRC="../images/bm4.gif" ALT="" BORDER=0>To enable a hook procedure for a Find or Replace dialog box</B></P>

<P>1.Set the FR_ENABLEHOOK flag in the <B>Flags</B> member of the <A HREF="1de83do.htm"><B>FINDREPLACE</B></A> structure.</P>

<P>2.Specify the address of the hook procedure in the <B>lpfnHook</B> member.</P>

<P></P>

<P>After processing its <A HREF="ii1w.b.htm">WM_INITDIALOG</A> message, the dialog box procedure sends a WM_INITDIALOG message to the hook procedure. The <I>lParam</I> parameter of this message is a pointer to the <B>FINDREPLACE</B> structure used to initialize the dialog box. </P>

<P>If the hook procedure returns FALSE in response to the WM_INITDIALOG message, the dialog box will not be shown unless the hook procedure displays it. To do this, first perform any other paint operations, and then call the <A HREF="3mejbzs.htm"><B>ShowWindow</B></A> and <A HREF="19g_54e.htm"><B>UpdateWindow</B></A> functions. The following code provides an example: </P>

<P>// We've returned FALSE in response to WM_INITDIALOG.  </P>

<P>// We've performed any other paint operations. </P>

<P>// Now we display the dialog box. </P>

<P>ShowWindow(hDlg, SW_SHOWNORMAL); </P>

<P>UpdateWindow(hDlg); </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
