<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Adding the Undelete Command</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1_0jol4"></A><B>Adding the Undelete Command</B></P>

<P>File Manager supports a hook for adding an Undelete command to the File menu (below the Delete command). If an "undelete" dynamic-link library is specified in the WINFILE.INI file, File Manager adds the Undelete command to the File menu when starting. When the user chooses the Undelete command, File Manager calls the DLL. </P>

<P>The [settings] section of the WINFILE.INI file should include a reference to the undelete DLL, as follows. </P>

<P>[settings]  </P>

<P>UNDELETE.DLL=C:\MYDIR\OTHER.DLL </P>

<P></P>

<P>An undelete DLL must include a standard entry point, the <A HREF="3fxroh5.htm"><B>UndeleteFile</B></A> function. This function must be exported by specifying the name of the function in the <B>EXPORTS</B> statement of the DLL's module-definition (.DEF) file. </P>

<P>The <A HREF="3fxroh5.htm"><B>UndeleteFile</B></A> function is defined as follows: </P>

<P>DWORD APIENTRY UndeleteFile(hwndParent, lpszDir)  </P>

<P>HWND hwndParent; </P>

<P>LPSTR lpszDir; </P>

<P></P>

<P>The <I>hwndParent</I> parameter identifies the parent window for any dialog boxes the DLL creates. The <I>lpszDir</I> parameter specifies the initial directory to be used (for example, C:\TEMP). </P>

</BODY>
</HTML>
