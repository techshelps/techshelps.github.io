<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IContextMenu</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="gakt5j"></A><B>IContextMenu  <A HREF="aezfl..htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1erm.gm.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>IContextMenu</B> interface is used to either create or merge a context menu associated with a certain object.</P>

<P>Default context menus are available for most objects that are visible within the Explorer's name space, such as files, folders, and printer objects. System-provided context menus are adaptable to file objects of any type, provided you have made the appropriate registry entries. </P>

<P><B>When to Implement</B></P>

<P>Implement <B>IContexMenu</B> in the following situations:</P>

<P>·To add dynamic menu items to a context menu associated with an object in the shell's name space. Implementation is accomplished by means of a handler located within an COM in-process server DLL.</P>

<P>·To allow menu items to be dynamically added to non-default drag-and-drop menus. Implementation is accomplished by means of a handler.</P>

<P>·Applications may either create or merge context menus of items in the shell' name space (or extended name space). This is accomplished by an application calling <B>IContextMenu</B> using <A HREF="_6hhgi.htm"><B>IShellFolder::GetUIObjectOf</B></A>.</P>

<P>·A namespace extension should implement <B>IContextMenu</B> so that either the shell or another application can access context menus belonging to items in its own name space. This is accomplished by using <B>IShellFolder::GetUIObjectOf</B>.</P>

<P></P>

<P>Shell extensions based on this interface must be initialized by using the <B>IShellExtInit</B> interface and menu items can be inserted by using either the <A HREF="1o2j7n8.htm"><B>InsertMenu</B></A> or <A HREF="4gm3_tz.htm"><B>InsertMenuItem</B></A> functions.</P>

<P>Also of note is that shell extensions do not work unless all appropriate registry entries are made.</P>

<P><B>When to Use</B></P>

<P>You don't call this interface directly. It is called by the shell when a user selects a context menu item that has been added by a handler registered under the appropriate registry keys, or when an application includes it as the <I>riid</I> parameter in a call to <B>IShellFolder::GetUIObjectOf</B>.</P>

<P><B>Methods in Vtable Order</B></P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=46%><B>IUnknown Methods</B></TD>
<TD width=54%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>QueryInterface</B></TD>
<TD width=54%>Returns pointers to supported interfaces.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>AddRef</B></TD>
<TD width=54%>Increments reference count.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>Release</B></TD>
<TD width=54%>Decrements reference count.</TD>
</TR>
</TABLE><BR>

<P></P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=46%><B>IContextMenu Methods</B></TD>
<TD width=54%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=46%><A HREF="m5cu4_.htm"><B>QueryContextMenu</B></A></TD>
<TD width=54%>Adds commands to a context menu.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><A HREF="1l08xt3.htm"><B>InvokeCommand</B></A></TD>
<TD width=54%>Carries out a menu command, either in response to user input or otherwise. For an example, see <A HREF="5338sx.htm"><B>IExtractIcon</B></A>.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><A HREF="0cx4hr.htm"><B>GetCommandString</B></A></TD>
<TD width=54%>Retrieves the language-independent name of a menu command or the help text for a menu command.</TD>
</TR>
</TABLE><BR>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
