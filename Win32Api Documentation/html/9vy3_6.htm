<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Public Key Blob Format</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="9vy3_6"></A><B>Public Key Blob Format</B></P>

<P>Public key blobs (type PUBLICKEYBLOB) are used to store RSA public keys. They have the following format:</P>

<P>BLOBHEADER blobheader;</P>

<P>RSAPUBKEY rsapubkey;</P>

<P>BYTE modulus[rsapubkey.bitlen/8];</P>

<P></P>

<P>Notice that PUBLICKEYBLOBs are not encrypted, but contain public keys in plaintext form.</P>

<P>The <B>RSAPUBKEY</B> structure contains information specific to the particular public key contained in the key blob. It is defined as follows:</P>

<P>typedef struct _RSAPUBKEY {</P>

<P>DWORD magic;</P>

<P>DWORD bitlen;</P>

<P>DWORD pubexp;</P>

<P>} RSAPUBKEY;</P>

<P></P>

<P>The following table describes each of the fields in the <B>RSAPUBKEY</B> structure.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=21%><B>Field</B></TD>
<TD width=79%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=21%><B>magic</B></TD>
<TD width=79%>This must always be set to 0x31415352. Notice that this is just an ASCII encoding of "RSA1."</TD>
</TR>

<TR VALIGN="top">
<TD width=21%><B>bitlen</B></TD>
<TD width=79%>Number of bits in the modulus. In practice, this must always be a multiple of 8.</TD>
</TR>

<TR VALIGN="top">
<TD width=21%><B>pubexp</B></TD>
<TD width=79%>The public exponent.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>The public key modulus data is located directly after the <B>RSAPUBKEY</B> structure. The size of this data will vary depending on the size of the public key. The number of bytes can be determined by dividing the value of <B>RSAPUBKEY</B>'s<B> bitlen</B> field by 8.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
