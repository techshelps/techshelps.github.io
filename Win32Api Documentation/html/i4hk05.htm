<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Current Selection</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="i4hk05"></A><B>Current Selection</B></P>

<P>The <I>current selection</I> is a list item the user has selected; the selected text appears in the selection field of the combo box. However, in the case of a simple combo box or a drop down combo box, the current selection is only one form of possible user input in a combo box. The user can also type text in the selection field. </P>

<P>The current selection is identified by the zero-based index of the selected list item. An application can set and retrieve it at any time. The parent window or dialog box procedure receives notifications when user changes the current selection for a combo box. The parent window or dialog box is not notified when the application changes the selection. </P>

<P>When a combo box is created, there is no current selection. This is also true for a simple or drop-down combo box, if the user has edited the contents of the selection field. To set the current selection, an application sends the <A HREF="22i4e47.htm">CB_SETCURSEL</A> message to the combo box. An application can also use the <A HREF="8kdo2d.htm">CB_SELECTSTRING</A> message to set the current selection to a list item whose string begins with a specified string. To determine the current selection, an application sends the <A HREF="1342t.u.htm">CB_GETCURSEL</A> message to the combo box. If there is no current selection, this message returns CB_ERR. </P>

<P>When the user changes the current selection in a combo box, the parent window or dialog-box procedure receives a <A HREF="71v.3j.htm">WM_COMMAND</A> message with the notification message <A HREF="_jwjeb.htm">CBN_SELCHANGE</A> in the high-order word of the <I>wParam</I> parameter. As a result, the application can respond to this notification message and execute a specific process each time the user selects a list item. This notification message is not sent when the current selection is set using the CB_SETCURSEL message. </P>

<P>In a drop-down combo box or drop-down list box, an application wait for the use to close the list box before processing a change in the current selection. This can be useful when significant processing is required. For example, to update a directory list based on the selected drive, an application can process the <A HREF="1_ho878.htm">CBN_CLOSEUP</A> message instead of CBN_SELCHANGE to update a directory list after the user selects a drive. </P>

<P>An application could also process the notification messages <A HREF="315z0ja.htm">CBN_SELENDOK</A> and <A HREF="1bscwek.htm">CBN_SELENDCANCEL</A>. The system sends CBN_SELENDOK when the user selects a list item, or selects an item and then closes the list. This indicates the user has finished, and the selection should be processed. CBN_SELENDCANCEL is sent when the user selects an item, but then selects another control, presses the ESCAPE key while the drop-down list is open, or closes the dialog box. This indicates the user's selection should be ignored. In a simple combo box, CBN_SELENDOK is sent before every CBN_SELCHANGE message. If the WS_EX_NOPARENTNOTIFY window style is specified for the combo box, the system does not send CBN_SELENDOK and CBN_SELENDCANCEL messages. </P>

<P>In a simple combo box, the system sends the <A HREF="ancq4b.htm">CBN_DBLCLK</A> notification message when the user double-clicks a list item. In a drop-down combo box or drop-down list, a single click hides the list so it is not possible to double-click an item. </P>

</BODY>
</HTML>
