<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>ExtractAssociatedIcon</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="hroio."></A><B>ExtractAssociatedIcon  <A HREF="3o162ok.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="9ymza7.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="k0wmjb.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>ExtractAssociatedIcon</B> function returns the handle of an indexed icon found in a file or an icon found in an associated executable file. </P>

<P><B>HICON ExtractAssociatedIcon(</B></P>

<TABLE cols=2 width=501>

<TR VALIGN="top">
<TD width=34%><B>HINSTANCE</B> <I>hInst</I><B>,</B></TD>
<TD width=66%>// application instance handle</TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>    LPTSTR</B> <I>lpIconPath</I><B>,</B></TD>
<TD width=66%>// path and filename of file for which icon is wanted</TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>    LPWORD</B> <I>lpiIcon</I> </TD>
<TD width=66%>// pointer to icon index</TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>   );</B></TD>
<TD width=66%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hInst</I></P>

<P>Specifies the instance of the application calling the function. </P>

<P><I>lpIconPath</I></P>

<P>Points to a string that specifies the full path and filename of the file for which an icon is desired. The function extracts the icon handle from that file, or from an executable file associated with that file. </P>

<P>If the icon handle is obtained from an executable file, the function stores the full path and filename of that executable in the string pointed to by <I>lpIconPath</I>. </P>

<P><I>lpiIcon</I></P>

<P>Points to a <B>WORD</B> that specifies the index of the icon whose handle is to be obtained. </P>

<P>If the icon handle is obtained from an executable file, the function stores the icon's identifier in the <B>WORD</B> pointed to by <I>lpiIcon</I>. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is an icon handle. If the icon is extracted from an associated executable file, the function stores the full path and filename of the executable file in the string pointed to by <I>lpIconPath</I>, and stores the icon's identifier in the <B>WORD</B> pointed to by <I>lpiIcon</I>. </P>

<P>If the function fails, the return value is NULL. </P>

<P><B>Remarks</B></P>

<P>The <B>ExtractAssociatedIcon</B> function first looks for the indexed icon in the file specified by <I>lpIconPath</I>. If the function cannot obtain the icon handle from that file, and the file has an associated executable file, it looks in that executable file for an icon. Associations with executable files are based on filename extensions, are stored in the per-user part of the registry, and can be defined using File Manager's Associate command. </P>

<P><B>See Also</B></P>

<P><A HREF="191zn5o.htm"><B>ExtractIcon</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
