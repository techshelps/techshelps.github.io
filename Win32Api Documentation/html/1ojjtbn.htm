<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Pop-up Topics</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1ojjtbn"></A><B>Pop-up Topics</B></P>

<P>You can display a pop-up topic that contains information for a specific control or menu by calling the <A HREF="1p1p.rf.htm"><B>WinHelp</B></A> function with the HELP_WM_HELP or HELP_CONTEXTMENU command. These commands display a topic in a pop-up window near the corresponding control or menu. To let the user return immediately to work in the application, the pop-up window is destroyed as soon as the user presses a key or clicks the left mouse button.</P>

<P>You use the HELP_WM_HELP command when processing WM_HELP messages for control windows. Because most controls pass the WM_HELP message to the <A HREF="32d1nbh.htm"><B>DefWindowProc</B></A> function, the corresponding dialog box procedure (or parent window procedure) processes this message. Rather than give a specific context identifier, the dialog box procedure must pass an array of control and context identifier pairs to <B>WinHelp</B> along with the control handle specified in the <B>hItemHandle</B> member of <A HREF="8ebbkx.htm"><B>HELPINFO</B></A> structure passed with the WM_HELP message. The function determines the identifier of the control for which the WM_HELP message was generated and uses the matching context identifier to display the appropriate topic. </P>

<P>You use the HELP_CONTEXTMENU command when processing WM_CONTEXTMENU messages. Because most controls pass the WM_CONTEXTMENU message to the <B>DefWindowProc</B> function, the corresponding dialog box procedure (or parent window procedure) processes this message. Again, the procedure specify an array of control and context identifier pairs and the handle in <I>wParam</I> when calling <A HREF="1p1p.rf.htm"><B>WinHelp</B></A> so that the function can pick the appropriate context identifier from the array and display the appropriate topic. Unlike the HELP_WM_HELP command, HELP_CONTEXTMENU first displays a What's This? command in a menu. If the user chooses the command, <B>WinHelp</B> displays the topic. Otherwise, the request is canceled.</P>

<P>You can also display pop-up topics by using the HELP_CONTEXTPOPUP command and specifying a context identifier of the topic. This command is similar to the HELP_CONTEXT command but invokes the pop-up instance of Windows Help used by HELP_WM_HELP and HELP_CONTEXTMENU. Applications can use this command in response to <A HREF="d98_nq.htm">WM_HELP</A> messages to display help for menus and for windows that are not controls in a dialog box. To use this command most effectively, the application should assign context identifiers to these menus and windows.</P>

<P>You can assign a context identifier to any window or menu in the application. When the user's help requests generates a WM_HELP message, the system includes the context identifier in the <A HREF="8ebbkx.htm"><B>HELPINFO</B></A> structure that it passes to the parent window along with the WM_HELP message. The parent window can then pass the context identifier to <B>WinHelp</B> to display the requested help topic.</P>

<P>You use the <A HREF="9tvqk5.htm"><B>SetWindowContextHelpId</B></A> function to assign a context identifier to a window or control and the <B>SetMenuContextHelpId</B> function to assign a context identifier to a menu. You can retrieve the context identifier for a window or menu by using the <A HREF="12kme3_.htm"><B>GetWindowContextHelpId</B></A> or <B>GetMenuContextHelpId</B> function.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
