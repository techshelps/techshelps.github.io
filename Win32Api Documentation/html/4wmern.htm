<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>GetProcessHeaps</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="4wmern"></A><B>GetProcessHeaps  <A HREF="f0623v.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="7gqv3r.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="9cqndc.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetProcessHeaps</B> function obtains handles to all of the heaps that are valid for the calling process.</P>

<P><B>DWORD GetProcessHeaps(</B></P>

<TABLE cols=2 width=565>

<TR VALIGN="top">
<TD width=37%><B>DWORD</B> <I>NumberOfHeaps</I><B>,</B></TD>
<TD width=63%>// maximum number of heap handles buffer can receive</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    PHANDLE</B> <I>ProcessHeaps</I> </TD>
<TD width=63%>// points to buffer to receive array of heap handles</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>   );</B></TD>
<TD width=63%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>NumberOfHeaps</I></P>

<P>Specifies the maximum number of heap handles that can be stored into the buffer pointed to by <I>ProcessHeaps</I>. </P>

<P><I>ProcessHeaps</I></P>

<P>Points to a buffer to receive an array of heap handles.</P>

<P></P>

<P><B>Return Values</B></P>

<P>The return value is the number of heap handles that are valid for the calling process. </P>

<P>If the return value is less than or equal to <I>NumberOfHeaps</I>, it is also the number of heap handles stored into the buffer pointed to by <I>ProcessHeaps</I>.</P>

<P>If the return value is greater than <I>NumberOfHeaps</I>, the buffer pointed to by <I>ProcessHeaps</I> is too small to hold all the valid heap handles of the calling process.The function will have stored no handles into that buffer. In this situation, use the return value to allocate a buffer that is large enough to receive the handles, and call the function again.</P>

<P>If the return value is zero, the function has failed, because every Win32 process has at least one valid heap, the process heap. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>Use the <B>GetProcessHeap </B>function to obtain a handle to the process heap of the calling process. The <B>GetProcessHeaps </B>function obtains a handle to that heap, plus handles to any additional private heaps created by calling the <B>HeapCreate </B>function.</P>

<P><B>See Also</B></P>

<P><A HREF="26hfdb.htm"><B>GetProcessHeap</B></A>, <A HREF="e.pz6h.htm"><B>HeapCreate</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
