<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SearchPath</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1fba0sq"></A><B>SearchPath  <A HREF="22m6i.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="qnj9so.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1f83g2.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>SearchPath</B> function searches for the specified file. </P>

<P><B>DWORD SearchPath(</B></P>

<TABLE cols=2 width=451>

<TR VALIGN="top">
<TD width=42%><B>LPCTSTR</B> <I>lpPath</I><B>,</B></TD>
<TD width=58%>// address of search path </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    LPCTSTR</B> <I>lpFileName</I><B>,</B></TD>
<TD width=58%>// address of filename </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    LPCTSTR</B> <I>lpExtension</I><B>,</B></TD>
<TD width=58%>// address of extension </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    DWORD</B> <I>nBufferLength</I><B>,</B></TD>
<TD width=58%>// size, in characters, of buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    LPTSTR</B> <I>lpBuffer</I><B>,</B></TD>
<TD width=58%>// address of buffer for found filename </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    LPTSTR</B> <B>*</B><I>lpFilePart</I> </TD>
<TD width=58%>// address of pointer to file component </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>   );</B></TD>
<TD width=58%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpPath</I></P>

<P>Points to a null-terminated string that specifies the path to be searched for the file. If this parameter is NULL, the function searches for a matching file in the following directories in the following sequence: </P>

<P>1.The directory from which the application loaded. </P>

<P>2.The current directory. </P>

<P>3.<B>Windows 95:</B> The Windows system directory. Use the <A HREF="3oj42sv.htm"><B>GetSystemDirectory</B></A> function to get the path of this directory.</P>

<P><B>Windows NT:</B> The 32-bit Windows system directory. Use the <B>GetSystemDirectory</B> function to get the path of this directory. The name of this directory is SYSTEM32.</P>

<P>4.<B>Windows NT:</B> The 16-bit Windows system directory. There is no Win32 function that obtains the path of this directory, but it is searched. The name of this directory is SYSTEM.</P>

<P>5.The Windows directory. Use the <A HREF="1b6tycn.htm"><B>GetWindowsDirectory</B></A> function to get the path of this directory. </P>

<P>6.The directories that are listed in the PATH environment variable. </P>

<P><I>lpFileName</I></P>

<P>Points to a null-terminated string that specifies the name of the file to search for. </P>

<P><I>lpExtension</I></P>

<P>Points to a null-terminated string that specifies an extension to be added to the filename when searching for the file. The first character of the filename extension must be a period (.). The extension is added only if the specified filename does not end with an extension. </P>

<P>If a filename extension is not required or if the filename contains an extension, this parameter can be NULL. </P>

<P><I>nBufferLength</I></P>

<P>Specifies the length, in characters, of the buffer that receives the valid path and filename. </P>

<P><I>lpBuffer</I></P>

<P>Points to the buffer for the valid path and filename of the file found. </P>

<P><I>lpFilePart</I></P>

<P>Points to the address (within <I>lpBuffer</I>) of the last component of the valid path and filename, which is the address of the character immediately following the final backslash (\) in the path. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the value returned is the length, in characters, of the string copied to the buffer, not including the terminating null character. If the return value is greater than <I>nBufferLength</I>, the value returned is the size of the buffer required to hold the path. </P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>See Also</B></P>

<P><A HREF="2a0z0q6.htm"><B>FindFirstFile</B></A>, <A HREF="jkcucc.htm"><B>FindNextFile</B></A>, <A HREF="3oj42sv.htm"><B>GetSystemDirectory</B></A>, <A HREF="1b6tycn.htm"><B>GetWindowsDirectory</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
