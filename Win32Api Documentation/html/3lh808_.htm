<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>CreateFont</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="3lh808_"></A><B>CreateFont  <A HREF="1chzrdl.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="4jd_z5i.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1xkvu5n.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>CreateFont</B> function creates a logical font that has specific characteristics. The logical font can subsequently be selected as the font for any device. </P>

<P><B>HFONT CreateFont(</B></P>

<TABLE cols=2 width=457>

<TR VALIGN="top">
<TD width=49%><B>int</B> <I>nHeight</I><B>,</B></TD>
<TD width=51%>// logical height of font </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    int</B> <I>nWidth</I><B>,</B></TD>
<TD width=51%>// logical average character width </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    int</B> <I>nEscapement</I><B>,</B></TD>
<TD width=51%>// angle of escapement </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    int</B> <I>nOrientation</I><B>,</B></TD>
<TD width=51%>// base-line orientation angle </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    int</B> <I>fnWeight</I><B>,</B></TD>
<TD width=51%>// font weight </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    DWORD</B> <I>fdwItalic</I><B>,</B></TD>
<TD width=51%>// italic attribute flag </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    DWORD</B> <I>fdwUnderline</I><B>,</B></TD>
<TD width=51%>// underline attribute flag </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    DWORD</B> <I>fdwStrikeOut</I><B>,</B></TD>
<TD width=51%>// strikeout attribute flag </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    DWORD</B> <I>fdwCharSet</I><B>,</B></TD>
<TD width=51%>// character set identifier </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    DWORD</B> <I>fdwOutputPrecision</I><B>,</B></TD>
<TD width=51%>// output precision </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    DWORD</B> <I>fdwClipPrecision</I><B>,</B></TD>
<TD width=51%>// clipping precision </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    DWORD</B> <I>fdwQuality</I><B>,</B></TD>
<TD width=51%>// output quality </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    DWORD</B> <I>fdwPitchAndFamily</I><B>,</B></TD>
<TD width=51%>// pitch and family </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    LPCTSTR</B> <I>lpszFace</I> </TD>
<TD width=51%>// pointer to typeface name string </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>   );</B></TD>
<TD width=51%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>nHeight</I></P>

<P>Specifies the height, in logical units, of the font's character cell or character. The character height value (also known as the em height) is the character cell height value minus the internal-leading value. The font mapper interprets the value specified in <I>nHeight</I> in the following manner:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=16%><B>Value</B></TD>
<TD width=84%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=16%>&gt; 0</TD>
<TD width=84%>The font mapper transforms this value into device units and matches it against the cell height of the available fonts.</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>0</TD>
<TD width=84%>The font mapper uses a default height value when it searches for a match.</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>&lt; 0</TD>
<TD width=84%>The font mapper transforms this value into device units and matches its absolute value against the character height of the available fonts.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>For all height comparisons, the font mapper looks for the largest font that does not exceed the requested size. </P>

<P>This mapping occurs when the font is used for the first time. </P>

<P>For the MM_TEXT mapping mode, you can use the following formula to specify a height for a font with a specified point size:</P>

<P></P>

<P>nHeight = -MulDiv(PointSize, GetDeviceCaps(hDC, LOGPIXELSY), 72);</P>

<P></P>

<P><I>nWidth</I></P>

<P>Specifies the average width, in logical units, of characters in the requested font. If this value is zero, the font mapper chooses a "closest match" value. The "closest match" value is determined by comparing the absolute values of the difference between the current device's aspect ratio and the digitized aspect ratio of available fonts. </P>

<P><I>nEscapement</I></P>

<P>Specifies the angle, in tenths of degrees, between the escapement vector and the x-axis of the device. The escapement vector is parallel to the base line of a row of text. </P>

<P><B>Windows NT:</B> </P>

<P>When the graphics mode is set to GM_ADVANCED, you can specify the escapement angle of the string independently of the orientation angle of the string's characters.</P>

<P>When the graphics mode is set to GM_COMPATIBLE, <I>nEscapement</I> specifies both the escapement and orientation. You should set <I>nEscapement</I> and <I>nOrientation</I> to the same value.</P>

<P><B>Windows 95:</B> </P>

<P>The <I>nEscapement</I> parameter specifies both the escapement and orientation. You should set <I>nEscapement</I> and <I>nOrientation</I> to the same value.</P>

<P><I>nOrientation</I></P>

<P>Specifies the angle, in tenths of degrees, between each character's base line and the x-axis of the device. </P>

<P><I>fnWeight</I></P>

<P>Specifies the weight of the font in the range 0 through 1000. For example, 400 is normal and 700 is bold. If this value is zero, a default weight is used.</P>

<P>The following values are defined for convenience:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%><B>Value</B></TD>
<TD width=67%><B>Weight</B></TD>
</TR>

<TR VALIGN="top">
<TD width=33%>FW_DONTCARE</TD>
<TD width=67%>0</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>FW_THIN</TD>
<TD width=67%>100</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>FW_EXTRALIGHT</TD>
<TD width=67%>200</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>FW_ULTRALIGHT</TD>
<TD width=67%>200</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>FW_LIGHT</TD>
<TD width=67%>300</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>FW_NORMAL</TD>
<TD width=67%>400</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>FW_REGULAR</TD>
<TD width=67%>400</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>FW_MEDIUM</TD>
<TD width=67%>500</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>FW_SEMIBOLD</TD>
<TD width=67%>600</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>FW_DEMIBOLD</TD>
<TD width=67%>600</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>FW_BOLD</TD>
<TD width=67%>700</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>FW_EXTRABOLD</TD>
<TD width=67%>800</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>FW_ULTRABOLD</TD>
<TD width=67%>800</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>FW_HEAVY</TD>
<TD width=67%>900</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>FW_BLACK</TD>
<TD width=67%>900</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>fdwItalic</I></P>

<P>Specifies an italic font if set to TRUE. </P>

<P><I>fdwUnderline</I></P>

<P>Specifies an underlined font if set to TRUE. </P>

<P><I>fdwStrikeOut</I></P>

<P>Specifies a strikeout font if set to TRUE. </P>

<P><I>fdwCharSet</I></P>

<P>Specifies the character set. The following values are predefined: </P>

<P>ANSI_CHARSET<BR>
DEFAULT_CHARSET<BR>
SYMBOL_CHARSET<BR>
SHIFTJIS_CHARSET<BR>
GB2312_CHARSET<BR>
HANGEUL_CHARSET<BR>
CHINESEBIG5_CHARSET<BR>
OEM_CHARSET</P>

<P><B>Windows 95 only:</B></P>

<P>JOHAB_CHARSET<BR>
HEBREW_CHARSET<BR>
ARABIC_CHARSET<BR>
GREEK_CHARSET<BR>
TURKISH_CHARSET<BR>
THAI_CHARSET<BR>
EASTEUROPE_CHARSET<BR>
RUSSIAN_CHARSET<BR>
MAC_CHARSET<BR>
BALTIC_CHARSET</P>

<P>The OEM_CHARSET value specifies a character set that is operating-system dependent. </P>

<P>You can use the DEFAULT_CHARSET value to allow the name and size of a font to fully describe the logical font. If the specified font name does not exist, a font from any character set can be substituted for the specified font, so you should use DEFAULT_CHARSET sparingly to avoid unexpected results.</P>

<P>Fonts with other character sets may exist in the operating system. If an application uses a font with an unknown character set, it should not attempt to translate or interpret strings that are rendered with that font. </P>

<P>This parameter is important in the font mapping process. To ensure consistent results, specify a specific character set. If you specify a typeface name in the <I>lpszFace </I>parameter, make sure that the <I>fdwCharSet</I> value matches the character set of the typeface specified in <I>lpszFace.</I></P>

<P><I>fdwOutputPrecision</I></P>

<P>Specifies the output precision. The output precision defines how closely the output must match the requested font's height, width, character orientation, escapement, pitch, and font type. It can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=42%><B>Value</B></TD>
<TD width=58%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=42%>OUT_CHARACTER_PRECIS</TD>
<TD width=58%>Not used.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>OUT_DEFAULT_PRECIS</TD>
<TD width=58%>Specifies the default font mapper behavior.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>OUT_DEVICE_PRECIS</TD>
<TD width=58%>Instructs the font mapper to choose a Device font when the system contains multiple fonts with the same name.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>OUT_OUTLINE_PRECIS</TD>
<TD width=58%><B>Windows NT:</B> This value instructs the font mapper to choose from TrueType and other outline-based fonts.
<P><B>Windows 95:</B> This value is not used.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>OUT_RASTER_PRECIS</TD>
<TD width=58%>Instructs the font mapper to choose a raster font when the system contains multiple fonts with the same name.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>OUT_STRING_PRECIS</TD>
<TD width=58%>This value is not used by the font mapper, but it is returned when raster fonts are enumerated.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>OUT_STROKE_PRECIS</TD>
<TD width=58%><B>Windows NT:</B> This value is not used by the font mapper, but it is returned when TrueType, other outline-based fonts, and vector fonts are enumerated. 
<P><B>Windows 95:</B> This value is used to map vector fonts, and is returned when TrueType or vector fonts are enumerated. </P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>OUT_TT_ONLY_PRECIS</TD>
<TD width=58%>Instructs the font mapper to choose from only TrueType fonts. If there are no TrueType fonts installed in the system, the font mapper returns to default behavior.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>OUT_TT_PRECIS</TD>
<TD width=58%>Instructs the font mapper to choose a TrueType font when the system contains multiple fonts with the same name.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>Applications can use the OUT_DEVICE_PRECIS, OUT_RASTER_PRECIS, and OUT_TT_PRECIS values to control how the font mapper chooses a font when the operating system contains more than one font with a specified name. For example, if an operating system contains a font named Symbol in raster and TrueType form, specifying OUT_TT_PRECIS forces the font mapper to choose the TrueType version. Specifying OUT_TT_ONLY_PRECIS forces the font mapper to choose a TrueType font, even if it must substitute a TrueType font of another name.</P>

<P><I>fdwClipPrecision</I></P>

<P>Specifies the clipping precision. The clipping precision defines how to clip characters that are partially outside the clipping region. It can be one or more of the following values: </P>

<P></P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=42%><B>Value</B></TD>
<TD width=58%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=42%>CLIP_DEFAULT_PRECIS</TD>
<TD width=58%>Specifies default clipping behavior.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>CLIP_CHARACTER_PRECIS</TD>
<TD width=58%>Not used.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>CLIP_STROKE_PRECIS</TD>
<TD width=58%>Not used by the font mapper, but is returned when raster, vector, or TrueType fonts are enumerated.
<P><B>Windows NT:</B> For compatibility, this value is always returned when enumerating fonts.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>CLIP_MASK</TD>
<TD width=58%>Not used.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>CLIP_EMBEDDED</TD>
<TD width=58%>You must specify this flag to use an embedded read-only font.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>CLIP_LH_ANGLES</TD>
<TD width=58%>When this value is used, the rotation for all fonts depends on whether the orientation of the coordinate system is left-handed or right-handed. 
<P>If not used, device fonts always rotate counterclockwise, but the rotation of other fonts is dependent on the orientation of the coordinate system.</P>

<P>For more information about the orientation of coordinate systems, see the description of the <I>nOrientation</I> parameter</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>CLIP_TT_ALWAYS</TD>
<TD width=58%>Not used.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>fdwQuality</I></P>

<P>Specifies the output quality. The output quality defines how carefully GDI must attempt to match the logical-font attributes to those of an actual physical font. It can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=36%><B>Value</B></TD>
<TD width=64%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=36%>DEFAULT_QUALITY</TD>
<TD width=64%>Appearance of the font does not matter.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>DRAFT_QUALITY</TD>
<TD width=64%>Appearance of the font is less important than when the PROOF_QUALITY value is used. For GDI raster fonts, scaling is enabled, which means that more font sizes are available, but the quality may be lower. Bold, italic, underline, and strikeout fonts are synthesized if necessary.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>PROOF_QUALITY</TD>
<TD width=64%>Character quality of the font is more important than exact matching of the logical-font attributes. For GDI raster fonts, scaling is disabled and the font closest in size is chosen. Although the chosen font size may not be mapped exactly when PROOF_QUALITY is used, the quality of the font is high and there is no distortion of appearance. Bold, italic, underline, and strikeout fonts are synthesized if necessary.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>fdwPitchAndFamily</I></P>

<P>Specifies the pitch and family of the font. The two low-order bits specify the pitch of the font and can be one of the following values: </P>

<P>DEFAULT_PITCH<BR>
FIXED_PITCH<BR>
VARIABLE_PITCH</P>

<P>The four high-order bits specify the font family and can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=31%><B>Value</B></TD>
<TD width=69%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>FF_DECORATIVE</TD>
<TD width=69%>Novelty fonts. Old English is an example.</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>FF_DONTCARE</TD>
<TD width=69%>Don't care or don't know.</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>FF_MODERN</TD>
<TD width=69%>Fonts with constant stroke width, with or without serifs. Pica, Elite, and Courier New® are examples.</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>FF_ROMAN</TD>
<TD width=69%>Fonts with variable stroke width and with serifs. MS® Serif is an example.</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>FF_SCRIPT</TD>
<TD width=69%>Fonts designed to look like handwriting. Script and Cursive are examples.</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>FF_SWISS</TD>
<TD width=69%>Fonts with variable stroke width and without serifs. MS Sans Serif is an example.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>An application can specify a value for the <I>fdwPitchAndFamily</I> parameter by using the Boolean OR operator to join a pitch constant with a family constant. </P>

<P>Font families describe the look of a font in a general way. They are intended for specifying fonts when the exact typeface requested is not available. </P>

<P><I>lpszFace</I></P>

<P>Points to a null-terminated string that specifies the typeface name of the font. The length of this string must not exceed 32 characters, including the null terminator. The <A HREF="zxznx3.htm"><B>EnumFontFamilies</B></A> function can be used to enumerate the typeface names of all currently available fonts. </P>

<P>If <I>lpszFace</I> is NULL or points to an empty string, GDI uses the first font that matches the other specified attributes.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is a handle to a logical font.</P>

<P>If the function fails, the return value is NULL. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>When you no longer need the font, call the <B>DeleteObject</B> function to delete it. </P>

<P>To help protect the copyrights of vendors who provide fonts for Windows operating systems, applications should always report the exact name of a selected font. Because available fonts can vary from system to system, do not assume that the selected font is always the same as the requested font. For example, if you request a font named "Palatino," but no such font is available on the system, the font mapper will substitute a font that has similar attributes but a different name. Always report the name of the selected font to the user.</P>

<P><B>See Also</B></P>

<P><A HREF="y31ava.htm"><B>DeleteObject</B></A>, <A HREF="4n4gw4.htm"><B>SelectObject</B></A>, <A HREF="zxznx3.htm"><B>EnumFontFamilies</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
