<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Dragging the Tree-View Item</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="qc.rbu"></A><B>Dragging the Tree-View Item</B></P>

<P>You drag a tree-view item by calling the <A HREF="mzs9yn.htm"><B>ImageList_DragMove</B></A> function when the parent window receives a <A HREF="1mq_iq2.htm">WM_MOUSEMOVE</A> message, as the following example shows. The example also performs hit testing during the drag operation to determine whether to highlight other items in the tree view as targets of a drag and drop operation.</P>

<P>// Main_OnMouseMove - drags an item in a tree-view control,  </P>

<P>//     highlighting the item that is the target. </P>

<P>// hwndParent - handle of the parent window </P>

<P>// hwndTV - handle of the tree-view control </P>

<P>// xCur and yCur - x- and y-coordinates of the mouse cursor </P>

<P>void Main_OnMouseMove(HWND hwndParent, HWND hwndTV, LONG xCur, LONG yCur) </P>

<P>{ </P>

<P>HTREEITEM htiTarget;  // handle of target item </P>

<P>TV_HITTESTINFO tvht;  // hit test information </P>

<P></P>

<P>if (g_fDragging) { </P>

<P></P>

<P>// Drag the item to the current position of the mouse cursor. </P>

<P>ImageList_DragMove(xCur, yCur); </P>

<P></P>

<P>// Find out if the cursor is on the item. If it is, highlight </P>

<P>// the item as a drop target. </P>

<P>tvht.pt.x = xCur; </P>

<P>tvht.pt.y = yCur; </P>

<P>if ((htiTarget = TreeView_HitTest(hwndTV, &amp;tvht)) != NULL) { </P>

<P>TreeView_SelectDropTarget(hwndTV, htiTarget); </P>

<P>} </P>

<P>} </P>

<P>return; </P>

<P>} </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
