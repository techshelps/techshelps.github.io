<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ExtCreatePen</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="6kg3d6"></A><B>ExtCreatePen  <A HREF="32ssbvz.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="udihne.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1xs0jus.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>ExtCreatePen</B> function creates a logical cosmetic or geometric pen that has the specified style, width, and brush attributes. </P>

<P><B>HPEN ExtCreatePen(</B></P>

<TABLE cols=2 width=509>

<TR VALIGN="top">
<TD width=41%><B>DWORD</B> <I>dwPenStyle</I><B>,</B></TD>
<TD width=59%>// pen style </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    DWORD</B> <I>dwWidth</I><B>,</B></TD>
<TD width=59%>// pen width </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    CONST LOGBRUSH</B> <I>*lplb</I><B>,</B></TD>
<TD width=59%>// pointer to structure for brush attributes </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    DWORD</B> <I>dwStyleCount</I><B>,</B></TD>
<TD width=59%>// length of array containing custom style bits </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    CONST DWORD</B> <I>*lpStyle</I> </TD>
<TD width=59%>// optional array of custom style bits </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>   );</B></TD>
<TD width=59%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>dwPenStyle</I></P>

<P>Specifies a combination of type, style, end cap, and join attributes. The values from each category are combined by using the bitwise OR operator (|). </P>

<P>The pen type can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=38%><B>Type</B></TD>
<TD width=62%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_GEOMETRIC</TD>
<TD width=62%>Pen is geometric.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_COSMETIC</TD>
<TD width=62%>Pen is cosmetic.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>The pen style can be any one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=38%><B>Style</B></TD>
<TD width=62%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_ALTERNATE</TD>
<TD width=62%><B>Windows NT:</B> Pen sets every other pixel. (This style is applicable only for cosmetic pens.)
<P><B>Windows 95:</B> Not supported.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_SOLID</TD>
<TD width=62%>Pen is solid.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_DASH</TD>
<TD width=62%>Pen is dashed.
<P><B>Windows 95:</B> This style is not supported for geometric lines.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_DOT</TD>
<TD width=62%>Pen is dotted.
<P><B>Windows 95:</B> This style is not supported for geometric lines.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_DASHDOT</TD>
<TD width=62%>Pen has alternating dashes and dots.
<P><B>Windows 95:</B> This style is not supported for geometric lines.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_DASHDOTDOT</TD>
<TD width=62%>Pen has alternating dashes and double dots.
<P><B>Windows 95:</B> This style is not supported for geometric lines.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_NULL</TD>
<TD width=62%>Pen is invisible.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_USERSTYLE</TD>
<TD width=62%><B>Windows NT:</B> Pen uses a styling array supplied by the user.
<P><B>Windows 95:</B> Not supported.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_INSIDEFRAME</TD>
<TD width=62%>Pen is solid. When this pen is used in any graphics device interface (GDI) drawing function that takes a bounding rectangle, the dimensions of the figure are shrunk so that it fits entirely in the bounding rectangle, taking into account the width of the pen. This applies only to geometric pens.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>The end cap is only specified for geometric pens. The end cap can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=38%><B>End cap</B></TD>
<TD width=62%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_ENDCAP_ROUND</TD>
<TD width=62%>End caps are round.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_ENDCAP_SQUARE</TD>
<TD width=62%>End caps are square.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_ENDCAP_FLAT</TD>
<TD width=62%>End caps are flat.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>The join is only specified for geometric pens. The join can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=38%><B>Line join</B></TD>
<TD width=62%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_JOIN_BEVEL</TD>
<TD width=62%>Joins are beveled.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_JOIN_MITER</TD>
<TD width=62%>Joins are mitered when they are within the current limit set by the <A HREF="0lwide.htm"><B>SetMiterLimit</B></A> function. If it exceeds this limit, the join is beveled.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>PS_JOIN_ROUND</TD>
<TD width=62%>Joins are round.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Windows 95:</B> The PS_ENDCAP_ROUND, PS_ENDCAP_SQUARE, PS_ENDCAP_FLAT, PS_JOIN_BEVEL, PS_JOIN_MITER, and PS_JOIN_ROUND styles are supported only for geometric pens when used to draw paths.</P>

<P><I>dwWidth</I></P>

<P>Specifies the width of the pen. If the <I>dwPenStyle</I> parameter is PS_GEOMETRIC, the width is given in logical units. If <I>dwPenStyle</I> is PS_COSMETIC, the width must be set to 1. </P>

<P><I>lplb</I></P>

<P>Points to a <A HREF="_3e1k.htm"><B>LOGBRUSH</B></A> structure. If <I>dwPenStyle</I> is PS_COSMETIC, the <B>lbColor</B> member specifies the color of the pen and the <B>lbStyle</B> member must be set to BS_SOLID. If <I>dwPenStyle</I> is PS_GEOMETRIC, all members must be used to specify the brush attributes of the pen.</P>

<P><I>dwStyleCount</I></P>

<P>Specifies the length, in doubleword units, of the <I>lpStyle</I> array. This value must be zero if <I>dwPenStyle</I> is not PS_USERSTYLE. </P>

<P><I>lpStyle</I></P>

<P>Points to an array of doubleword values. The first value specifies the length of the first dash in a user-defined style, the second value specifies the length of the first space, and so on. This pointer must be NULL if <I>dwPenStyle</I> is not PS_USERSTYLE. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is a handle that identifies a logical pen.</P>

<P>If the function fails, the return value is zero. </P>

<P><B>Remarks</B></P>

<P>A geometric pen can have any width and can have any of the attributes of a brush, such as dithers and patterns. A cosmetic pen can only be a single pixel wide and must be a solid color, but cosmetic pens are generally faster than geometric pens. </P>

<P>The width of a geometric pen is always specified in world units. The width of a cosmetic pen is always 1. </P>

<P>End cap and join are only specified for geometric pens. </P>

<P>After an application creates a logical pen, it can select that pen into a device context by calling the <A HREF="4n4gw4.htm"><B>SelectObject</B></A> function. After a pen is selected into a device context, it can be used to draw lines and curves. </P>

<P>If <I>dwPenStyle</I> is PS_COSMETIC and PS_USERSTYLE, the entries in the <I>lpStyle</I> array specify lengths of dashes and spaces in style units. A style unit is defined by the device where the pen is used to draw a line. </P>

<P>If <I>dwPenStyle</I> is PS_GEOMETRIC and PS_USERSTYLE, the entries in the <I>lpStyle</I> array specify lengths of dashes and spaces in logical units. </P>

<P>If <I>dwPenStyle</I> is PS_ALTERNATE, the style unit is ignored and every other pixel is set. </P>

<P>If the <B>lbStyle</B> member of the <A HREF="_3e1k.htm"><B>LOGBRUSH</B></A><B> </B>structure pointed to by <I>lplb</I> is BS_PATTERN, the bitmap pointed to by the <B>lbHatch </B>member of that structure cannot be a dib section. A dib section is a bitmap created by <A HREF="gsao6s.htm"><B>CreateDibSection</B></A>. If that bitmap is a dib section, the <B>ExtCreatePen</B> function fails.</P>

<P>When an application no longer requires a specified pen, it should call the <A HREF="y31ava.htm"><B>DeleteObject</B></A> function to delete the pen. </P>

<P><B>See Also</B></P>

<P><A HREF="10xg29a.htm"><B>CreatePen</B></A>, <A HREF="gsao6s.htm"><B>CreateDibSection</B></A>, <A HREF="5f44_m_.htm"><B>CreatePenIndirect</B></A>, <A HREF="y31ava.htm"><B>DeleteObject</B></A>, <A HREF="3v6uf0.htm"><B>GetObject</B></A>, <A HREF="_3e1k.htm"><B>LOGBRUSH</B></A>, <A HREF="4n4gw4.htm"><B>SelectObject</B></A>, <A HREF="0lwide.htm"><B>SetMiterLimit</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
