<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Replacing Control Panel Pages</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="bx2mvq"></A><B>Replacing Control Panel Pages</B></P>

<P>The <B>ReplacePage</B> member function is called only by Control Panel applications. It allows you to replace the property sheet of a standard Control Panel application with a custom page. For example, if a mouse manufacturer adds extra buttons to its mouse, the manufacturer can replace the standard Mouse Control Panel's "Buttons" property sheet page. The <B>ReplacePage</B> member function is not called by the shell because the shell does not have any property sheet pages that can be replaced by a shell extension. Currently, only Control Panel applications call this member function, but other property sheet suppliers could use this member function to allow their property sheet pages to be replaced.</P>

<P>Each property sheet handler that allows a property sheet page to be replaced must specify the registry location where other handlers that replace pages register themselves. For standard Control Panel applications, this location is defined by the <B>REGSTR_PATH_CONTROLSFOLDER</B> macro in the REGSTR.H file. The macro defines the key under the <B>HKEY_LOCAL_MACHINE</B> key in which all Control Panel property sheet page replacement handlers must register. For example, a property sheet handler that needs to replace a property sheet page for the  Mouse Control Panel would register a property sheet extension handler in the following registry location.</P>

<P>HKEY_LOCAL_MACHINE  </P>

<P>REGSTR_PATH_CONTROLSFOLDER </P>

<P>Mouse </P>

<P>shellex </P>

<P>PropertySheetHandlers = NewMousePage </P>

<P>NewMousePage = {00000000-1111-2222-3333-00000000000002} </P>

<P></P>

<P>In addition, a property sheet handler that allows replaceable pages must define identifiers for each page that can be replaced. </P>

<P>Standard Control Panel applications define this location in the REGSTR.H and CPLEXT.H header files. In REGSTR.H, the <B>REGSTR_PATH_CONTROLSFOLDER</B> macro defines the key under the <B>HKEY_LOCAL_MACHINE</B> key in which all Control Panel property sheet page replacement handlers must register. CPLEXT.H defines the subkey for each Control Panel application that contains a replacable property sheet page: \<B>Mouse</B> for a Mouse Control Panel application and \<B>Keyboard</B> for a Keyboard Control Panel application. </P>

<P>Standard Control Panel applications define these identifiers in CPLEXT.H. For example, CPLPAGE_MOUSE_BUTTONS defines the identifier for the Mouse Control Panel's Buttons page, and CPLPAGE_KEYBOARD_SPEED defines the identifier for the Keyboard Control Panel's Speed page.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
