<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Initializing a Dialog Box</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="iif3c_"></A><B>Initializing a Dialog Box</B></P>

<P>You initialize the dialog box and its contents while processing the <A HREF="ii1w.b.htm">WM_INITDIALOG</A> message. The most common task is to initialize the controls to reflect the current dialog box settings. Another common task is to center a dialog box on the screen or within its owner window. A useful task for some dialog boxes is to set the input focus to a given control rather than accept the default input focus. </P>

<P>In the following example, the dialog box procedure centers the dialog box and sets the input focus while processing the WM_INITDIALOG message. To center the dialog box, the procedure retrieves the window rectangles for the dialog box and the owner window and calculates a new position for the dialog box. To set the input focus, the procedure checks the <I>wParam</I> parameter to determine the identifier of the default input focus: </P>

<P>HWND hwndOwner;  </P>

<P>RECT rc, rcDlg, rcOwner; </P>

<P></P>

<P>case WM_INITDIALOG: </P>

<P></P>

<P>// Get the owner window and dialog box rectangles. </P>

<P></P>

<P>if ((hwndOwner = GetParent(hwndDlg)) == NULL) </P>

<P>hwndOwner = GetDesktopWindow(); </P>

<P>GetWindowRect(hwndOwner, &amp;rcOwner); </P>

<P>GetWindowRect(hwndDlg, &amp;rcDlg); </P>

<P>CopyRect(&amp;rc, &amp;rcOwner); </P>

<P></P>

<P>// Offset the owner and dialog box rectangles so that </P>

<P>// right and bottom values represent the width and </P>

<P>// height, and then offset the owner again to discard </P>

<P>// space taken up by the dialog box. </P>

<P></P>

<P>OffsetRect(&amp;rcDlg, -rcDlg.left, -rcDlg.top); </P>

<P>OffsetRect(&amp;rc, -rc.left, -rc.top); </P>

<P>OffsetRect(&amp;rc, -rcDlg.right, -rcDlg.bottom); </P>

<P></P>

<P>// The new position is the sum of half the remaining </P>

<P>// space and the owner's original position. </P>

<P></P>

<P>SetWindowPos(hwndDlg, </P>

<P>HWND_TOP, </P>

<P>rcOwner.left + (rc.right / 2), </P>

<P>rcOwner.top + (rc.bottom / 2), </P>

<P>0, 0,          // ignores size arguments </P>

<P>SWP_NOSIZE); </P>

<P></P>

<P>if (GetDlgCtrlID((HWND) wParam) != ID_ITEMNAME) { </P>

<P>SetFocus(GetDlgItem(hwndDlg, ID_ITEMNAME)); </P>

<P>return FALSE; </P>

<P>} </P>

<P>return TRUE; </P>

<P></P>

<P>In the preceding statements, the procedure uses the <A HREF="r3ju_j.htm"><B>GetParent</B></A> function to retrieve the owner window handle for a dialog box. The function returns the owner window handle for dialog boxes, and the parent window handle for child windows. Because an application can create a dialog box that has no owner, the procedure checks the returned handle and uses the <A HREF="ie.zw6.htm"><B>GetDesktopWindow</B></A> function to retrieve the desktop window handle, if necessary. After calculating the new position, the procedure uses the <A HREF="4557_v1.htm"><B>SetWindowPos</B></A> function to move the dialog box, specifying the HWND_TOP value to ensure that the dialog box remains on top of the owner window. </P>

<P>Before setting the input focus, the procedure checks the control identifier of the default input focus. Windows passes the window handle of the default input focus in the <I>wParam</I> parameter. The <A HREF="1migt1q.htm"><B>GetDlgCtrlID</B></A> function returns the identifier for the control identified by the window handle. If the identifier does not match the correct identifier, the procedure uses the <A HREF="35o7yrp.htm"><B>SetFocus</B></A> function to set the input focus. The <A HREF="id1quq.htm"><B>GetDlgItem</B></A> function is required to retrieve the window handle of the desired control. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
