<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>How to Look Up a User's Full Name</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1gs5prh"></A><B>How to Look Up a User's Full Name</B></P>

<P>Computers running Windows can be organized into a domain, which is a collection of computers on a Windows NT Server network. The domain administrator maintains centralized user and group account information.</P>

<P>To find the full name of a user, given the user name and domain name on Windows NT:</P>

<P>·Convert the user name and domain name to Unicode, if they are not already Unicode strings. </P>

<P>·Look up the computer name of the domain controller (DC) by calling <A HREF="7w3qt4.htm"><B>NetGetDCName</B></A>.</P>

<P>·Look up the user name on the DC computer by calling <A HREF="fpy53h.htm"><B>NetUserGetInfo</B></A>.</P>

<P>·Convert the full user name to ANSI, unless the program is expecting to work with Unicode strings.</P>

<P></P>

<P>The following sample code is a function that takes a user name and a domain name in the first two arguments and returns the user's full name in the third argument.</P>

<P>#include &lt;windows.h&gt;</P>

<P>#include &lt;lm.h&gt;</P>

<P>#include &lt;stdio.h&gt;</P>

<P></P>

<P>BOOL GetFullName( char *UserName, char *Domain, char *dest )</P>

<P>{</P>

<P>WCHAR wszUserName[256];          // Unicode user name</P>

<P>WCHAR wszDomain[256]; </P>

<P>LPBYTE ComputerName;</P>

<P>struct _SERVER_INFO_100 *si100;  // Server structure</P>

<P>struct _USER_INFO_2 *ui;         // User structure</P>

<P>// Convert ANSI user name and domain to Unicode</P>

<P>MultiByteToWideChar( CP_ACP, 0, UserName,</P>

<P>strlen(UserName)+1, wszUserName, sizeof(wszUserName) );</P>

<P>MultiByteTOWideChar( CP_ACP, 0, Domain,</P>

<P>strlen(Domain)+1, wszDomain, sizeof(wszDomain) );</P>

<P>// Get the computer name of a DC for the domain.</P>

<P>NetGetDCName( NULL, wszDomain, &amp;ComputerName );</P>

<P>// Look up the user on the DC.</P>

<P>if( NetUserGetInfo( (LPWSTR) ComputerName,</P>

<P>(LPWSTR) &amp;wszUserName, 2, (LPBYTE *) &amp;ui ) )</P>

<P>{</P>

<P>printf( "Error getting user information.\n" );</P>

<P>return( FALSE );</P>

<P>}</P>

<P>// Convert the Unicode full name to ANSI.</P>

<P>WideCharToMultiByte( CP_ACP, 0, ui-&gt;usri2_full_name, -1,</P>

<P>dest, 256, NULL, NULL );</P>

<P>return (TRUE);</P>

<P>}</P>

<P></P>

</BODY>
</HTML>
