<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Retrieving Network Errors</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="4zu9a0"></A><B>Retrieving Network Errors</B></P>

<P>When one of the WNet functions returns WN_EXTENDED_ERROR, an application can call the <A HREF="1kvezqm.htm"><B>WNetGetLastError</B></A> function to get more information about the error that occurred. This information is usually specific to the network provider. </P>

<P>The following example illustrates an application-defined error-handling function (NetErrorHandler) that takes three arguments: a window handle, the error code returned by one of the WNet functions, and the name of the function that produced the error. If the error code is WN_EXTENDED_ERROR, NetErrorHandler calls <B>WNetGetLastError</B> to get extended error information. </P>

<P>BOOL WINAPI NetErrorHandler(HWND hwnd,  </P>

<P>DWORD dwErrorCode, </P>

<P>LPSTR lpszFunction) </P>

<P>{ </P>

<P>DWORD dwWNetResult, dwLastError; </P>

<P>CHAR szError[256]; </P>

<P>CHAR szCaption[256]; </P>

<P>CHAR szDescription[256]; </P>

<P>CHAR szProvider[256]; </P>

<P></P>

<P>// The following code performs standard error-handling. </P>

<P></P>

<P>if (dwErrorCode != ERROR_EXTENDED_ERROR) </P>

<P>{ </P>

<P>wsprintf((LPSTR) szError, "%s failed; \nResult is %ld", </P>

<P>lpszFunction, dwErrorCode); </P>

<P>wsprintf((LPSTR) szCaption, "%s error", lpszFunction); </P>

<P>MessageBox(hwnd, (LPSTR) szError, (LPSTR) szCaption, MB_OK); </P>

<P>return TRUE; </P>

<P>} </P>

<P></P>

<P>// The following code performs error-handling when the </P>

<P>// ERROR_EXTENDED_ERROR return value indicates that WNetGetLastError </P>

<P>// can retrieve additional information. </P>

<P></P>

<P>else </P>

<P>{ </P>

<P>dwWNetResult = WNetGetLastError(&amp;dwLastError, </P>

<P>(LPSTR) szDescription,  // buffer for error description </P>

<P>sizeof(szDescription), </P>

<P>(LPSTR) szProvider,     // buffer for provider name </P>

<P>sizeof(szProvider)); </P>

<P></P>

<P>if(dwWNetResult != NO_ERROR) { </P>

<P>wsprintf((LPSTR) szError, </P>

<P>"WNetGetLastError failed; error %ld", dwWNetResult); </P>

<P>MessageBox(hwnd, (LPSTR) szError, </P>

<P>"WNetGetLastError", MB_OK); </P>

<P>return FALSE; </P>

<P>} </P>

<P></P>

<P>wsprintf((LPSTR) szError, </P>

<P>"%s failed with code %ld;\n%s", </P>

<P>(LPSTR) szProvider, dwLastError, (LPSTR) szDescription); </P>

<P>wsprintf((LPSTR) szCaption, "%s error", lpszFunction); </P>

<P>MessageBox(hwnd, (LPSTR) szError, (LPSTR) szCaption, MB_OK); </P>

<P>return TRUE; </P>

<P>} </P>

<P>} </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
