<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>LookupSecurityDescriptorParts [New - Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="4oyq7ue"></A><B>LookupSecurityDescriptorParts  <A HREF="_61565.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1966ja.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="afqqmm.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>[New - Windows NT]</P>

<P>The <B>LookupSecurityDescriptorParts</B> function retrieves security information from a self-relative security descriptor. </P>

<P><B>DWORD LookupSecurityDescriptorParts(</B></P>

<TABLE cols=2 width=665>

<TR VALIGN="top">
<TD width=48%><B>PTRUSTEE</B> *<I>pOwner</I><B>,</B></TD>
<TD width=52%>// receives the owner SID from the security descriptor</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    PTRUSTEE</B> *<I>pGroup</I><B>,</B></TD>
<TD width=52%>// receives the group SID from the security descriptor</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    PULONG</B> <I>cCountOfAccessEntries</I><B>,</B></TD>
<TD width=52%>// receives number of access-control entries</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    PEXPLICIT_ACCESS</B> *<I>pListOfAccessEntries</I><B>,</B></TD>
<TD width=52%>// receives an array of DACL access-control entries</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    PULONG</B> <I>cCountOfAuditEntries</I><B>,</B></TD>
<TD width=52%>// receives number of audit-control entries </TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    PEXPLICIT_ACCESS</B> *<I>pListOfAuditEntries</I><B>,</B></TD>
<TD width=52%>// receives an array of SACL audit-control entries</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    PSECURITY_DESCRIPTOR</B> <I>pSD</I></TD>
<TD width=52%>// pointer that receives the new security descriptor</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>   );</B></TD>
<TD width=52%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>pOwner</I></P>

<P>Pointer to a variable that receives a pointer to a <A HREF="2gkczjv.htm"><B>TRUSTEE</B></A> structure. The function looks up the name associated with the owner <A HREF="clji72.htm">SID</A> in the <I>pSD</I> security descriptor, and returns a pointer to the name in the <B>ptstrName</B> member of the <B>TRUSTEE</B> structure. The function sets the <B>TrusteeForm</B> member to TRUSTEE_IS_NAME. </P>

<P>This parameter can be NULL if you are not interested in the name of the owner.</P>

<P><I>pGroup</I></P>

<P>Pointer to a variable that receives a pointer to a <B>TRUSTEE</B> structure. The function looks up the name associated with the primary group SID of the security descriptor, and returns a pointer to the name in the <B>ptstrName</B> member of the <B>TRUSTEE</B> structure. The function sets the <B>TrusteeForm</B> member to TRUSTEE_IS_NAME. </P>

<P>This parameter can be NULL if you are not interested in the name of the group.</P>

<P><I>cCountOfAccessEntries</I></P>

<P>Pointer to a <B>ULONG</B> that receives the number of <A HREF=".aeuaj.htm"><B>EXPLICIT_ACCESS</B></A> structures returned in the <I>pListOfAccessEntries</I> array<I>. </I>This parameter can be NULL only if the <I>pListOfAccessEntries</I> parameter is also NULL. </P>

<P><I>pListOfAccessEntries</I></P>

<P>Pointer to a variable that receives a pointer to an array of <B>EXPLICIT_ACCESS</B> structures that describe the ACEs in the DACL of the security descriptor. The <A HREF="2gkczjv.htm"><B>TRUSTEE</B></A> structure in these <B>EXPLICIT_ACCESS</B> structures use the TRUSTEE_IS_NAME form. For a description of how an array of <B>EXPLICIT_ACCESS</B> structures describes the ACEs in an <A HREF="lm6.t4.htm">ACL</A>, see the <A HREF="d1e2ub.htm"><B>GetExplicitEntriesFromAcl</B></A> function. If this parameter is NULL, the <I>cCountOfAccessEntries</I> parameter must also be NULL. </P>

<P><I>cCountOfAuditEntries</I></P>

<P>Pointer to a <B>ULONG</B> that receives the number of <B>EXPLICIT_ACCESS</B> structures returned in the <I>pListOfAuditEntries</I> array<I>. </I>This parameter can be NULL only if the <I>pListOfAuditEntries</I> parameter is also NULL. </P>

<P><I>pListOfAuditEntries</I></P>

<P>Pointer to a variable that receives a pointer to an array of <B>EXPLICIT_ACCESS</B> structures that describe the ACEs in the SACL of the security descriptor. The <B>TRUSTEE</B> structure in these <B>EXPLICIT_ACCESS</B> structures uses the TRUSTEE_IS_NAME form. If this parameter is NULL, the <I>cCountOfAuditEntries</I> parameter must also be NULL. </P>

<P><I>pSD</I></P>

<P>Pointer to an existing self-relative security descriptor from which the function retrieves security information. A self-relative security descriptor stores a <A HREF="188mr8k.htm"><B>SECURITY_DESCRIPTOR</B></A> structure and associated security information in a contiguous block of memory. This differs from an absolute security descriptor, which contains pointers to the associated security information.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is ERROR_SUCCESS.</P>

<P>If the function fails, the return value is a nonzero error code defined in WINERROR.H. </P>

<P><B>Remarks</B></P>

<P>The <B>LookupSecurityDescriptorParts</B> function retrieves the names of the owner and primary group of the security descriptor. It also returns descriptions of the access-control entries in the DACL and audit-control entries in the SACL of the security descriptor.</P>

<P>The parameters other than <I>pSD</I> can be NULL if you are not interested in the information. If you do not want information about the DACL, both <I>pListOfAccessEntries</I> and <I>cCountOfAccessEntries</I> must be NULL. If you do not want information about the SACL, both <I>pListOfAuditEntries</I> and <I>cCountOfAuditEntries</I> must be NULL. Similarly, if you do want DACL or SACL information, both of the corresponding parameters must be non-NULL.</P>

<P>You must call the <B>LocalFree</B> function to free any buffers returned by the <I>pOwner</I>, <I>pGroup</I>, <I>pListOfAccessEntries</I>, or <I>pListOfAuditEntries</I> parameters.</P>

<P>The <B>LookupSecurityDescriptorParts</B> function is intended for trusted servers that implement or expose security on their own objects. The function works with a self-relative security descriptor suitable for serializing into a stream and storing to disk, as a trusted server might require. </P>

<P><B>See Also</B></P>

<P><A HREF="lf6.t4.htm"><B>ACE</B></A>, <A HREF="lm6.t4.htm"><B>ACL</B></A>, <A HREF=".aeuaj.htm"><B>EXPLICIT_ACCESS</B></A>, <A HREF="0wv2ny.htm"><B>LocalFree</B></A>, <A HREF="188mr8k.htm"><B>SECURITY_DESCRIPTOR</B></A>, <A HREF="d1e2ub.htm"><B>GetExplicitEntriesFromAcl</B></A>, <A HREF="clji72.htm"><B>SID</B></A>, <A HREF="2gkczjv.htm"><B>TRUSTEE</B></A> </P>

</BODY>
</HTML>
