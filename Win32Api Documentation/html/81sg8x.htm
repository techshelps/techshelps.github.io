<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>CreateEnhMetaFile</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="81sg8x"></A><B>CreateEnhMetaFile  <A HREF="8by72s.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="2kdk_u7.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="9vrpau.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>CreateEnhMetaFile</B> function creates a device context for an enhanced-format metafile. This device context can be used to store a device-independent picture. </P>

<P><B>HDC CreateEnhMetaFile(</B></P>

<TABLE cols=2 width=475>

<TR VALIGN="top">
<TD width=41%><B>HDC</B> <I>hdcRef</I><B>,</B></TD>
<TD width=59%>// handle to a reference device context </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    LPCTSTR</B> <I>lpFilename</I><B>,</B></TD>
<TD width=59%>// pointer to a filename string </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    CONST RECT *</B><I>lpRect</I><B>,</B></TD>
<TD width=59%>// pointer to a bounding rectangle </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    LPCTSTR</B> <I>lpDescription</I> </TD>
<TD width=59%>// pointer to an optional description string  </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>   );</B></TD>
<TD width=59%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hdcRef</I></P>

<P>Identifies a reference device for the enhanced metafile. </P>

<P><I>lpFilename</I></P>

<P>Points to the filename for the enhanced metafile to be created. If this parameter is NULL, the enhanced metafile is memory based and its contents are lost when it is deleted by using the <A HREF="4tukya.htm"><B>DeleteEnhMetaFile</B></A> function. </P>

<P><I>lpRect</I></P>

<P>Points to a <A HREF="ezena2.htm"><B>RECT</B></A> structure that specifies the dimensions (in .01-millimeter units) of the picture to be stored in the enhanced metafile.</P>

<P><I>lpDescription</I></P>

<P>Points to a string that specifies the name of the application that created the picture, as well as the picture's title. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is a handle to the device context for the enhanced metafile.</P>

<P>If the function fails, the return value is NULL. </P>

<P><B>Remarks</B></P>

<P>Where text arguments must use Unicode characters, use the <B>CreateEnhMetaFile</B> function as a wide-character function. Where text arguments must use characters from the Windows 3.<I>x</I> character set, use this function as an ANSI function. </P>

<P>Windows uses the reference device identified by the <I>hdcRef</I> parameter to record the resolution and units of the device on which a picture originally appeared. If the <I>hdcRef</I> parameter is NULL, it uses the current display device for reference. </P>

<P>The <B>left</B> and <B>top</B> members of the <A HREF="ezena2.htm"><B>RECT</B></A> structure pointed to by the <I>lpRect</I> parameter must be less than the <B>right</B> and <B>bottom</B> members, respectively. Points along the edges of the rectangle are included in the picture. If <I>lpRect</I> is NULL, the graphics device interface (GDI) computes the dimensions of the smallest rectangle that surrounds the picture drawn by the application. The <I>lpRect</I> parameter should be provided where possible. </P>

<P>The string pointed to by the <I>lpDescription</I> parameter must contain a null character between the application name and the picture name and must terminate with two null characters ¾ for example, "XYZ Graphics Editor\0Bald Eagle\0\0", where \0 represents the null character. If <I>lpDescription</I> is NULL, there is no corresponding entry in the enhanced-metafile header. </P>

<P>Applications use the device context created by this function to store a graphics picture in an enhanced metafile. The handle identifying this device context can be passed to any GDI function. </P>

<P>After an application stores a picture in an enhanced metafile, it can display the picture on any output device by calling the <B>PlayEnhMetaFile</B> function. When displaying the picture, Windows uses the rectangle pointed to by the <I>lpRect</I> parameter and the resolution data from the reference device to position and scale the picture. </P>

<P>The device context returned by this function contains the same default attributes associated with any new device context. </P>

<P>Applications must use the <B>GetWinMetaFileBits</B> function to convert an enhanced metafile to the older Windows metafile format. </P>

<P>The filename for the enhanced metafile should use the .EMF extension. </P>

<P><B>See Also</B></P>

<P><A HREF="1nbayvp.htm"><B>CloseEnhMetaFile</B></A>, <A HREF="4tukya.htm"><B>DeleteEnhMetaFile</B></A>, <A HREF="1z9hnk..htm"><B>GetEnhMetaFileDescription</B></A>, <A HREF="1y1xb8k.htm"><B>GetEnhMetaFileHeader</B></A>, <A HREF="ldp6ik.htm"><B>GetWinMetaFileBits</B></A>, <A HREF="1p5tba.htm"><B>PlayEnhMetaFile</B></A>, <A HREF="ezena2.htm"><B>RECT</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
