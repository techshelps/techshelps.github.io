<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Keyboard Input Model</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="6d.r8w"></A><B>Keyboard Input Model</B></P>

<P>Windows provides device-independent keyboard support for applications by installing a keyboard device driver appropriate for the current keyboard. Windows provides language-independent keyboard support by using the language-specific keyboard layout currently selected by the user or the application. The keyboard device driver receives scan codes from the keyboard, which are sent to the keyboard layout where they are translated into messages and posted to the appropriate windows in your application. </P>

<P>Assigned to each key on a keyboard is a unique value called a <I>scan code</I>, a device-dependent identifier for the key on the keyboard. A keyboard generates two scan codes when the user types a key ¾ one when the user presses the key and another when the user releases the key. </P>

<P>The keyboard device driver interprets a scan code and translates (maps) it to a <I>virtual-key code</I>, a device-independent value defined by Windows that identifies the purpose of a key. After translating a scan code, the keyboard layout creates a message that includes the scan code, the virtual-key code, and other information about the keystroke, and then places the message in the system message queue. Windows removes the message from the system message queue and posts it to the message queue of the appropriate thread. Eventually, the thread's message loop removes the message and passes it to the appropriate window procedure for processing. The following figure illustrates the keyboard input model for Windows. </P>

<P><IMG SRC="../images/bm21.gif" ALT="" BORDER=0></P>

</BODY>
</HTML>
