<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Retrieving a Window Property</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1cqovxk"></A><B>Retrieving a Window Property</B></P>

<P>A window can create handles to its window property data and use the data for any purpose. The following example uses <A HREF="4m9p_3x.htm"><B>GetProp</B></A> to obtain handles to the window properties identified by PROP_ICON, PROP_CURSOR, and PROP_BUFFER. The example then displays the contents of the newly obtained memory buffer, cursor, and icon in the window's client area. </P>

<P>#define PATHLENGTH 256  </P>

<P></P>

<P>HWND hwndSubclass;     // handle of a subclassed window </P>

<P>HANDLE hIconProp, hCursProp; </P>

<P>HGLOBAL hMemProp; </P>

<P>char *lpFilename; </P>

<P>TCHAR tchBuffer[PATHLENGTH]; </P>

<P>int nSize; </P>

<P>HDC hdc; </P>

<P></P>

<P>// Get the window properties, then use the data. </P>

<P></P>

<P>hIconProp = (HICON) GetProp(hwndSubclass, "PROP_ICON"); </P>

<P>TextOut(hdc, 10, 40, "PROP_ICON", 9); </P>

<P>DrawIcon(hdc, 90, 40, hIconProp); </P>

<P></P>

<P>hCursProp = (HCURSOR) GetProp(hwndSubclass, "PROP_CURSOR"); </P>

<P>TextOut(hdc, 10, 85, "PROP_CURSOR", 9); </P>

<P>DrawIcon(hdc, 110, 85, hCursProp); </P>

<P></P>

<P>hMemProp = (HGLOBAL) GetProp(hwndSubclass, "PROP_BUFFER"); </P>

<P>lpFilename = GlobalLock(hMemProp); </P>

<P>nSize = sprintf(tchBuffer, </P>

<P>"Path to file:  %s", lpFilename); </P>

<P>TextOut(hdc, 10, 10, tchBuffer, nSize); </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
