<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Enumerating the Installed Fonts</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="tajm31"></A><B>Enumerating the Installed Fonts</B></P>

<P>In some instances, an application must be able to enumerate the available fonts and select the one most appropriate for a particular operation. An application can enumerate the available fonts by calling the <A HREF="8av20gf.htm"><B>EnumFonts</B></A> or <A HREF="zxznx3.htm"><B>EnumFontFamilies</B></A> function. These functions send information about the available fonts to a callback function that the application supplies. The callback function receives information in <A HREF="5m4itk.htm"><B>LOGFONT</B></A> and <A HREF="k_sjw.htm"><B>NEWTEXTMETRIC</B></A> structures. (The <B>NEWTEXTMETRIC</B> structure contains information about a TrueType font. When the callback function receives information about a non-TrueType font, the information is contained in a <A HREF="3qpxyyn.htm"><B>TEXTMETRIC</B></A> structure.) By using this information, an application can limit the user's choices to only those fonts that are available. </P>

<P>The <B>EnumFontFamilies</B> function is similar to the <B>EnumFonts</B> function but includes some extra functionality. <B>EnumFontFamilies</B> allows an application to take advantage of styles available with TrueType fonts. New and upgraded applications should use <B>EnumFontFamilies</B> instead of <B>EnumFonts</B>. </P>

<P>In previous versions of Windows, the only style attributes were weight and italic; any other styles were specified in the family name for the font. For example, when an application used the <B>EnumFonts</B> function to query the available Courier fonts, <B>EnumFonts</B> might return information for Courier, Courier Bold, Courier Bold Italic, and Courier Italic. It would not return information about any other Courier fonts that might be installed, because any other Courier fonts would typically have a different family name. </P>

<P>TrueType fonts are organized around a typeface name (for example, Courier New) and style names (for example, italic, bold, and extra-bold). The <B>EnumFontFamilies</B> function enumerates all the styles associated with a given family name, not simply the bold and italic attributes. For example, when the system includes a TrueType font called Courier New Extra-Bold, <B>EnumFontFamilies</B> lists it with the other Courier New fonts. The capabilities of <B>EnumFontFamilies</B> are helpful for fonts with many or unusual styles and for fonts that cross international borders. </P>

<P>If an application does not supply a typeface name, the <A HREF="8av20gf.htm"><B>EnumFonts</B></A> and <A HREF="zxznx3.htm"><B>EnumFontFamilies</B></A> functions supply information about one font in each available family. To enumerate all the fonts in a device context, the application can specify NULL for the typeface name, compile a list of the available typefaces, and then enumerate each font in each typeface. </P>

<P>The following example uses the <B>EnumFontFamilies</B> function to retrieve the number of available raster, vector, and TrueType font families. </P>

<P>UINT uAlignPrev;  </P>

<P>int aFontCount[] = { 0, 0, 0 }; </P>

<P>char szCount[8]; </P>

<P></P>

<P>EnumFontFamilies(hdc, (LPCTSTR) NULL, </P>

<P>(FONTENUMPROC) EnumFamCallBack, (LPARAM) aFontCount); </P>

<P></P>

<P>uAlignPrev = SetTextAlign(hdc, TA_UPDATECP); </P>

<P></P>

<P>MoveToEx(hdc, 10, 50, (LPPOINT)NULL); </P>

<P>TextOut(hdc, 0, 0, "Number of raster fonts: ", 24); </P>

<P>itoa(aFontCount[0], szCount, 10); </P>

<P>TextOut(hdc, 0, 0, szCount, strlen(szCount)); </P>

<P></P>

<P>MoveToEx(hdc, 10, 75, (LPPOINT)NULL); </P>

<P>TextOut(hdc, 0, 0, "Number of vector fonts: ", 24); </P>

<P>itoa(aFontCount[1], szCount, 10); </P>

<P>TextOut(hdc, 0, 0, szCount, strlen(szCount)); </P>

<P></P>

<P>MoveToEx(hdc, 10, 100, (LPPOINT)NULL); </P>

<P>TextOut(hdc, 0, 0, "Number of TrueType fonts: ", 26); </P>

<P>itoa(aFontCount[2], szCount, 10); </P>

<P>TextOut(hdc, 0, 0, szCount, strlen(szCount)); </P>

<P></P>

<P>SetTextAlign(hdc, uAlignPrev); </P>

<P>. </P>

<P>. </P>

<P>. </P>

<P></P>

<P>BOOL FAR PASCAL EnumFamCallBack(lplf, lpntm, FontType, aFontCount) </P>

<P>LPLOGFONT lplf; </P>

<P>LPNEWTEXTMETRIC lpntm; </P>

<P>DWORD FontType; </P>

<P>LPVOID aFontCount; </P>

<P>{ </P>

<P>int far * aiFontCount = (int far *) aFontCount; </P>

<P></P>

<P>/* </P>

<P>* Record the number of raster, TrueType, and vector </P>

<P>* fonts in the font-count array. </P>

<P>*/ </P>

<P></P>

<P>if (FontType &amp; RASTER_FONTTYPE) </P>

<P>aiFontCount[0]++; </P>

<P>else if (FontType &amp; TRUETYPE_FONTTYPE) </P>

<P>aiFontCount[2]++; </P>

<P>else </P>

<P>aiFontCount[1]++; </P>

<P></P>

<P>if (aiFontCount[0] || aiFontCount[1] || aiFontCount[2]) </P>

<P>return TRUE; </P>

<P>else </P>

<P>return FALSE; </P>

<P></P>

<P>UNREFERENCED_PARAMETER( lplf ); </P>

<P>UNREFERENCED_PARAMETER( lpntm ); </P>

<P>} </P>

<P></P>

<P>This example uses two masks, RASTER_FONTTYPE and TRUETYPE_FONTTYPE, to determine the type of font being enumerated. If the RASTER_FONTTYPE bit is set, the font is a raster font. If the TRUETYPE_FONTTYPE bit is set, the font is a TrueType font. If neither bit is set, the font is a vector font. A third mask, DEVICE_FONTTYPE, is set when a device (for example, a laser printer) supports downloading TrueType fonts; it is zero if the device is a display adapter, dot-matrix printer, or other raster device. An application can also use the DEVICE_FONTTYPE mask to distinguish GDI-supplied raster fonts from device-supplied fonts. Windows can simulate bold, italic, underline, and strikeout attributes for GDI-supplied raster fonts, but not for device-supplied fonts. </P>

<P>An application can also check bits 1 and 2 in the <B>tmPitchAndFamily</B> member of the <A HREF="k_sjw.htm"><B>NEWTEXTMETRIC</B></A> structure to identify a TrueType font. If bit 1 is 0 and bit 2 is 1, the font is a TrueType font. </P>

<P>Vector fonts are categorized as OEM_CHARSET instead of ANSI_CHARSET. Some applications identify vector fonts by using this information, checking the <B>tmCharSet</B> member of the <B>NEWTEXTMETRIC</B> structure. This categorization usually prevents the font mapper from choosing vector fonts unless they are specifically requested. (Most applications no longer use vector fonts because their strokes are single lines and they take longer to draw than TrueType fonts, which offer many of the same scaling and rotation features that required vector fonts in earlier versions of Windows.) </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
