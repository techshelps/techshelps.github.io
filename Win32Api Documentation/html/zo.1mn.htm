<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>LZOpenFile</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="zo.1mn"></A><B>LZOpenFile  <A HREF="h35zza.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="_f77a7.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="7d2bul.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>LZOpenFile</B> function creates, opens, reopens, or deletes the specified file. </P>

<P><B>INT LZOpenFile(</B></P>

<TABLE cols=2 width=493>

<TR VALIGN="top">
<TD width=45%><B>LPTSTR</B> <I>lpFileName</I><B>,</B></TD>
<TD width=55%>// address of name of file to be opened  </TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    LPOFSTRUCT</B> <I>lpReOpenBuf</I><B>,</B></TD>
<TD width=55%>// address of open file structure</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    WORD</B> <I>wStyle</I> </TD>
<TD width=55%>// action to take</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>   );</B></TD>
<TD width=55%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpFileName</I></P>

<P>Points to a string that specifies the name of a file. </P>

<P><I>lpReOpenBuf</I></P>

<P>Points to the <A HREF="6w2f_8o.htm"><B>OFSTRUCT</B></A> structure that is to receive information about the file when the file is first opened. The structure can be used in subsequent calls to the <B>LZOpenFile</B> function to refer to the open file. </P>

<P>The <B>szPathName</B> member of this structure contains characters from the original equipment manufacturer (OEM) character set. </P>

<P><I>wStyle</I></P>

<P>Specifies the action to take. This parameter can be a combination of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=43%><B>Value</B></TD>
<TD width=57%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=43%>OF_CANCEL</TD>
<TD width=57%>Ignored. In the Win32-based application programming interface (API), the OF_PROMPT style produces a dialog box containing a Cancel button.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>OF_CREATE</TD>
<TD width=57%>Directs <B>LZOpenFile</B> to create a new file. If the file already exists, it is truncated to zero length.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>OF_DELETE</TD>
<TD width=57%>Deletes the file.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>OF_EXIST</TD>
<TD width=57%>Opens the file and then closes it to test for a file's existence.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>OF_PARSE</TD>
<TD width=57%>Fills the <B>OFSTRUCT</B> structure but carries out no other action.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>OF_PROMPT</TD>
<TD width=57%>Displays a dialog box if the requested file does not exist. The dialog box informs the user that Windows cannot find the file, and it contains Retry and Cancel buttons. Choosing the Cancel button directs <B>LZOpenFile</B> to return a "file not found" error message.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>OF_READ</TD>
<TD width=57%>Opens the file for reading only.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>OF_READWRITE</TD>
<TD width=57%>Opens the file for reading and writing.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>OF_REOPEN</TD>
<TD width=57%>Opens the file using information in the reopen buffer.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>OF_SHARE_DENY_NONE</TD>
<TD width=57%>Opens the file without denying other processes read or write access to the file. <B>LZOpenFile</B> fails if the file has been opened in compatibility mode by any other process.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>OF_SHARE_DENY_READ</TD>
<TD width=57%>Opens the file and denies other processes read access to the file. <B>LZOpenFile</B> fails if the file has been opened in compatibility mode or has been opened for read access by any other process.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>OF_SHARE_DENY_WRITE</TD>
<TD width=57%>Opens the file and denies other processes write access to the file. <B>LZOpenFile</B> fails if the file has been opened in compatibility mode or has been opened for write access by any other process.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>OF_SHARE_EXCLUSIVE</TD>
<TD width=57%>Opens the file in exclusive mode, denying other processes both read and write access to the file. <B>LZOpenFile</B> fails if the file has been opened in any other mode for read or write access, even by the current process.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>OF_WRITE</TD>
<TD width=57%>Opens the file for writing only.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds and the value specified by the <I>wStyle</I> parameter is not OF_READ, the return value is a handle identifying the file. If the file is compressed and opened with <I>wStyle</I> set to OF_READ, the return value is a special file handle. </P>

<P>If the function fails, the return value is an LZERROR_* code. These codes have values less than zero. Note that <B>LZOpenFile</B> calls neither <B>SetLastError</B> nor <B>SetLastErrorEx</B>; thus, its failure does not affect a thread's last-error code. </P>

<P>Here is a list of the LZERROR_* codes that <B>LZOpenFile</B> can return upon failure: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=39%><B>Value</B></TD>
<TD width=61%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=39%>LZERROR_BADINHANDLE</TD>
<TD width=61%>The handle identifying the source file is not valid. The file cannot be read.</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>LZERROR_GLOBALLOC</TD>
<TD width=61%>The maximum number of open compressed files has been exceeded or local memory cannot be allocated.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>If the <I>wStyle</I> parameter is the OF_READ flag (or OF_READ and any of the OF_SHARE_ flags) and the file is compressed, <B>LZOpenFile</B> calls the <A HREF="hbeguj.htm"><B>LZInit</B></A> function, which performs the required initialization for the decompression operations. </P>

<P>The handle this function returns is compatible only with the functions in LZEXPAND.DLL; it should not be used for other file operations. </P>

<P><B>See Also</B></P>

<P><A HREF="4o4b_sn.htm"><B>LZClose</B></A>, <A HREF="hbeguj.htm"><B>LZInit</B></A>, <A HREF="3..s.to.htm"><B>LZRead</B></A></P>

</BODY>
</HTML>
