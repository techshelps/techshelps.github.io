<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IShellExtInit::Initialize [Now Supported on Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="hj1mvv"></A><B>IShellExtInit::Initialize  <A HREF="nfwoj.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A></B></P>

<P>[Now Supported on Windows NT]</P>

<P>Initializes a property sheet extension, context menu extension, or drag and drop handler.</P>

<P><B>HRESULT Initialize(</B></P>

<TABLE cols=2 width=510>

<TR VALIGN="top">
<TD width=41%><B>LPCITEMIDLIST</B> <I>pidlFolder</I><B>,</B></TD>
<TD width=59%>// Points to an ITEMIDLIST structure</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    LPDATAOBJECT</B> <I>lpdobj</I><B>,</B></TD>
<TD width=59%>// Points to an IDataObject interface</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    HKEY</B> <I>hkeyProgID</I></TD>
<TD width=59%>// Registry key for the file object or folder type</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>   );</B></TD>
<TD width=59%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>pidlFolder</I></P>

<P>Pointer to an <A HREF="16gub2n.htm"><B>ITEMIDLIST</B></A> (item identifier list) structure that uniquely identifies a folder. For property sheet extensions, this parameter is NULL. For context menu extensions, it is the IDList for the folder that cotains the item whose context menu is being displayed. For non-default drag-and-drop menu extensions, this parameter must specify the target folder. </P>

<P><I>lpdobj</I></P>

<P>Pointer to an <B>IDataObject</B> interface object that can be used to retrieve the objects being acted upon.</P>

<P><I>hkeyProgID</I></P>

<P>Registry key for the file object or folder type.</P>

<P></P>

<P><B>Return Values</B></P>

<P>Returns NOERROR if successful or an OLE-defined error value otherwise.</P>

<P><B>Remarks</B></P>

<P>The meanings of some parameters depend on the extension type. For drag and drop handlers, the item identifier list specifies the destination folder (the drop target), the <B>IDataObject</B> interface identifies the items being dropped, and the registry key specifies the file class of the destination folder.</P>

<P>For context menu extensions, the item identifier list specifies the folder that contains the selected file objects, the <B>IDataObject</B> interface identifies the selected file objects, and the registry key specifies the file class of the file object that has the focus.</P>

<P><B>Notes to Implementors</B></P>

<P>This is the first method that the shell calls after it creates an instance of a property sheet extension, context menu extension, or drag and drop handler.</P>

<P><B>See Also</B></P>

<P><A HREF="ehqr2a.htm"><B>IShellExtInit</B></A>, <A HREF="16gub2n.htm"><B>ITEMIDLIST</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
