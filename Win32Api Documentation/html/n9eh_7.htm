<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Customization</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="n9eh_7"></A><B>Customization</B></P>

<P>A toolbar has built in customization features that you can make available to the user by giving the toolbar the CCS_ADJUSTABLE common control style. The customization features allow the user to drag a button to a new position or to remove a button by dragging it off the toolbar. In addition, the user can double-click the toolbar to display the Customize Toolbar dialog box, which allows the user to add, delete, and rearrange toolbar buttons. An application can display the dialog box by using the <A HREF="x_2n2t.htm">TB_CUSTOMIZE</A> message.</P>

<P>The toolbar sends notification messages (in the form of <A HREF="1mzt7br.htm">WM_NOTIFY</A> messages) to the parent window at each step in the customization process. If the user holds the SHIFT key down and begins dragging a button, the toolbar automatically handles the drag operation. The toolbar sends the <A HREF="edv.pn.htm">TBN_QUERYDELETE</A> notification message to the parent window to determine whether the button may be deleted. The drag operation ends if the parent window returns FALSE. Otherwise, the toolbar captures mouse input and waits for the user to release the mouse button. </P>

<P>When the user releases the mouse button, the toolbar determines the location of the mouse cursor. If the cursor is outside the toolbar, the button is deleted. If the cursor is on another toolbar button, the toolbar sends the <A HREF="jn2.o2.htm">TBN_QUERYINSERT</A> notification message to the parent window to determine if a button may be inserted to the left of the given button. The button is inserted if the parent window returns TRUE; otherwise, it is not. The toolbar sends the <A HREF="1.4ebbo.htm">TBN_TOOLBARCHANGE</A> notification message to signal the end of the drag operation. </P>

<P>If the user begins a drag operation without holding down the SHIFT key, the toolbar sends the <A HREF="2jz6mua.htm">TBN_BEGINDRAG</A> notification message to the parent window. An application that implements its own button-dragging code can use this message as a signal to begin a drag operation. The toolbar sends the <A HREF="cmhdfw.htm">TBN_ENDDRAG</A> notification message to signal the end of the drag operation. </P>

<P>A toolbar sends notification messages when the user customizes a toolbar by using the Customize Toolbar dialog box. The toolbar sends the <A HREF="qnqk3p.htm">TBN_BEGINADJUST</A> notification message after the user double-clicks the toolbar, but before the dialog box is created. Next, the toolbar begins sending a series of <A HREF="jn2.o2.htm">TBN_QUERYINSERT</A> notification messages to determine whether the toolbar allows buttons to be inserted. When the parent window returns TRUE, the toolbar stops sending TBN_QUERYINSERT notifications. If the parent window does not return TRUE for any button, the toolbar destroys the dialog box. </P>

<P>Next, the toolbar determines if any buttons may be deleted by sending one <A HREF="edv.pn.htm">TBN_QUERYDELETE</A> notification message for each button in the toolbar. The parent window returns TRUE to indicate that a button may be deleted; otherwise, it returns FALSE. The toolbar adds all toolbar buttons to the dialog box, but it grays those that may not be deleted. </P>

<P>Whenever the toolbar needs information about a button in the Customize Toolbar dialog box, it sends the <A HREF="e4hgrr.htm">TBN_GETBUTTONINFO</A> notification message, specifying the index of the button for which it needs information and the address of a <A HREF="dba0sv.htm"><B>TBNOTIFY</B></A> structure. The parent window must fill the structure with the relevant information. </P>

<P>The Customize Toolbar dialog box includes a Help button and a Reset button. When the user chooses the Help button, the toolbar sends the <A HREF="swqmue.htm">TBN_CUSTHELP</A> notification message. The parent window should respond by displaying help information. The dialog box sends the <A HREF="15fvjh5.htm">TBN_RESET</A> notification message when the user selects the Reset button. This message signals that the toolbar is about to reinitialize the dialog box. </P>

<P>An application can use the <A HREF="3yyhps5.htm">TB_SAVERESTORE</A> message to save the current state of a toolbar in an initialization file or to restore the state based on information previously stored in an initialization file. The message saves the state information in the specified initialization file or in the WIN.INI file if no initialization file is specified. An application typically stores the state before the user begins customizing the toolbar in case the user later wants to restore the toolbar to its original state. </P>

</BODY>
</HTML>
