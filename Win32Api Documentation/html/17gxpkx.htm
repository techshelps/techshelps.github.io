<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>WideCharToMultiByte</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="17gxpkx"></A><B>WideCharToMultiByte  <A HREF="4tusv6.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1r0c_vq.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="21act6p.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>WideCharToMultiByte</B> function maps a wide-character string to a new character string. The new character string is not necessarily from a multibyte character set. </P>

<P><B>int WideCharToMultiByte(</B></P>

<TABLE cols=2 width=547>

<TR VALIGN="top">
<TD width=41%><B>UINT</B> <I>CodePage</I><B>,</B></TD>
<TD width=59%>// code page </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    DWORD</B> <I>dwFlags</I><B>,</B></TD>
<TD width=59%>// performance and mapping flags </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    LPCWSTR</B> <I>lpWideCharStr</I><B>,</B></TD>
<TD width=59%>// address of wide-character string </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    int</B> <I>cchWideChar</I><B>,</B></TD>
<TD width=59%>// number of characters in string </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    LPSTR</B> <I>lpMultiByteStr</I><B>,</B></TD>
<TD width=59%>// address of buffer for new string </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    int</B> <I>cchMultiByte</I><B>,</B></TD>
<TD width=59%>// size of buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    LPCSTR</B> <I>lpDefaultChar</I><B>,</B></TD>
<TD width=59%>// address of default for unmappable characters  </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    LPBOOL</B> <I>lpUsedDefaultChar</I> </TD>
<TD width=59%>// address of flag set when default char. used </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>   );</B></TD>
<TD width=59%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>CodePage</I></P>

<P>Specifies the code page used to perform the conversion. This parameter can be given the value of any codepage that is installed or available in the system. The following values may be used to specify one of the system default code pages: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=24%><B>Value</B></TD>
<TD width=76%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=24%>CP_ACP</TD>
<TD width=76%>ANSI code page</TD>
</TR>

<TR VALIGN="top">
<TD width=24%>CP_MACCP</TD>
<TD width=76%>Macintosh code page</TD>
</TR>

<TR VALIGN="top">
<TD width=24%>CP_OEMCP</TD>
<TD width=76%>OEM code page</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>dwFlags</I></P>

<P>A set of bit flags that specify the handling of unmapped characters. The function performs more quickly when <B>none</B> of these flags is set. The following flag constants are defined:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=39%><B>Value</B></TD>
<TD width=61%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=39%>WC_COMPOSITECHECK</TD>
<TD width=61%>Convert composite characters to precomposed characters.</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>WC_DISCARDNS</TD>
<TD width=61%>Discard nonspacing characters during conversion.</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>WC_SEPCHARS</TD>
<TD width=61%>Generate separate characters during conversion. This is the default conversion behavior.</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>WC_DEFAULTCHAR</TD>
<TD width=61%>Replace exceptions with the default character during conversion.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>When WC_COMPOSITECHECK is specified, the function converts composite characters to precomposed characters. A composite character consists of a base character and a nonspacing character, each having different character values. A precomposed character has a single character value for a base/nonspacing character combination. In the character <I>è</I>, the <I>e</I> is the base character, and the accent grave mark is the nonspacing character.</P>

<P>When an application specifies WC_COMPOSITECHECK, it can use the last 3 flags in this list (WC_DISCARDNS, WC_SEPCHARS, and WC_DEFAULTCHAR) to customize the conversion to precomposed characters. These flags determine the function's behavior when there is no precomposed mapping for a base/nonspace character combination in a wide-character string. These last 3 flags can <B>only</B> be used if the WC_COMPOSITECHECK flag is set.</P>

<P>The function's default behavior is to generate separate characters (WC_SEPCHARS) for unmapped composite characters.</P>

<P><I>lpWideCharStr</I></P>

<P>Points to the wide-character string to be converted. </P>

<P><I>cchWideChar</I></P>

<P>Specifies the number of characters in the string pointed to by the <I>lpWideCharStr</I> parameter. If this value is -1, the string is assumed to be null-terminated and the length is calculated automatically. </P>

<P><I>lpMultiByteStr</I></P>

<P>Points to the buffer to receive the translated string. </P>

<P><I>cchMultiByte</I></P>

<P>Specifies the size in characters of the buffer pointed to by the <I>lpMultiByteStr</I> parameter. If this value is zero, the function returns the number of bytes required for the buffer. (In this case, the <I>lpMultiByteStr</I> buffer is not used.) </P>

<P><I>lpDefaultChar</I></P>

<P>Points to the character used if a wide character cannot be represented in the specified code page. If this parameter is NULL, a system default value is used. The function is faster when both <I>lpDefaultChar</I> and <I>lpUsedDefaultChar</I> are NULL. </P>

<P><I>lpUsedDefaultChar</I></P>

<P>Points to a flag that indicates whether a default character was used. The flag is set to TRUE if one or more wide characters in the source string cannot be represented in the specified code page. Otherwise, the flag is set to FALSE. This parameter may be NULL. The function is faster when both <I>lpDefaultChar</I> and <I>lpUsedDefaultChar</I> are NULL. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, and <I>cchMultiByte</I> is nonzero, the return value is the number of bytes written to the buffer pointed to by <I>lpMultiByteStr</I>. </P>

<P>If the function succeeds, and <I>cchMultiByte</I> is zero, the return value is the required size, in bytes, for a buffer that can receive the translated string. </P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. <B>GetLastError</B> may return one of the following error codes:</P>

<P>ERROR_INSUFFICIENT_BUFFER<BR>
ERROR_INVALID_FLAGS<BR>
ERROR_INVALID_PARAMETER</P>

<P><B>Remarks</B></P>

<P>The <I>lpMultiByteStr</I> and <I>lpWideCharStr</I> pointers must not be the same. If they are the same, the function fails, and <B>GetLastError</B> returns ERROR_INVALID_PARAMETER. </P>

<P>An application can use the <I>lpDefaultChar</I> parameter to change the default character used for the conversion. </P>

<P>As noted earlier, the <B>WideCharToMultiByte </B>function operates most efficiently when both <I>lpDefaultChar</I> and <I>lpUsedDefaultChar</I> are NULL. The following table shows the behavior of <B>WideCharToMultiByte</B> for the four combinations of <I>lpDefaultChar</I> and <I>lpUsedDefaultChar</I> :</P>

<TABLE cols=3>

<TR VALIGN="top">
<TD width=24%><B><I>lpDefaultChar</I></B></TD>
<TD width=29%><B><I>lpUsedDefaultChar</I></B></TD>
<TD width=47%><B>Result</B></TD>
</TR>

<TR VALIGN="top">
<TD width=24%>NULL</TD>
<TD width=29%>NULL</TD>
<TD width=47%>No default checking. This is the most efficient, quick way to use this function.</TD>
</TR>

<TR VALIGN="top">
<TD width=24%>non-NULL</TD>
<TD width=29%>NULL</TD>
<TD width=47%>Uses the specified default character, but does not set <I>lpUsedDefaultChar</I>.</TD>
</TR>

<TR VALIGN="top">
<TD width=24%>NULL</TD>
<TD width=29%>non-NULL</TD>
<TD width=47%>Uses the system default character and sets <I>lpUsedDefaultChar</I> if necessary.</TD>
</TR>

<TR VALIGN="top">
<TD width=24%>non-NULL</TD>
<TD width=29%>non-NULL</TD>
<TD width=47%>Uses the specified default character and sets <I>lpUsedDefaultChar</I> if necessary.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="2dr2_sz.htm"><B>MultiByteToWideChar</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
