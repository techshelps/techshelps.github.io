<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>RasAdminGetUserAccountServer [New - Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="hyop9."></A><B>RasAdminGetUserAccountServer  <A HREF="14dxb.b.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="35kj_0r.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1mpuhlc.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>[New - Windows NT]</P>

<P>The <B>RasAdminGetUserAccountServer</B> function retrieves the name of the server that has the user account database. You can use the returned server name in the <A HREF="in.ich.htm"><B>RasAdminUserGetInfo</B></A> and <A HREF="121gq90.htm"><B>RasAdminUserSetInfo</B></A> functions to get or set information about a specified user.</P>

<P><B>DWORD RasAdminGetUserAccountServer(</B></P>

<TABLE cols=2 width=569>

<TR VALIGN="top">
<TD width=44%><B>const WCHAR</B> *<I>lpszDomain</I><B>,</B></TD>
<TD width=56%>// pointer to the name of the Windows NT domain</TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    const WCHAR</B> *<I>lpszServer</I><B>,</B></TD>
<TD width=56%>// pointer to the name of the RAS server</TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    LPWSTR</B> <I>lpszUserAccountServer</I></TD>
<TD width=56%>// receives the name of the user account server</TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>   );</B></TD>
<TD width=56%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpszDomain</I></P>

<P>Pointer to a null-terminated Unicode string that contains the name of the domain to which the RAS server belongs. This parameter can be NULL if you are running your RAS administration application on a Windows NT Workstation or Server that is not participating in a Windows NT domain. If this parameter is NULL, the <I>lpszServer</I> parameter must be non-NULL.</P>

<P><I>lpszServer</I></P>

<P>Pointer to a null-terminated Unicode string that contains the name of the Windows NT RAS server. Specify the name with leading "\\" characters, in the form: \\<I>servername</I>. This parameter can be NULL if the <I>lpszDomain</I> parameter is not NULL.</P>

<P><I>lpszUserAccountServer</I></P>

<P>Pointer to a buffer that receives a null-terminated Unicode string containing the name of the primary domain controller (PDC) Windows NT server that has the user account database. The buffer should be big enough to hold the server name (UNCLEN +1). The function prefixes the returned server name with leading "\\" characters, in the form: \\<I>servername</I>. If the server name specified by <I>lpszServer</I> is a stand-alone Windows NT Server or Workstation (that is, the server or workstation does not participate in a Windows NT domain), then the server name itself is returned in the <I>lpszUserAccountServer</I> buffer. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is ERROR_SUCCESS.</P>

<P>If the function fails, the return value can be the following error code. </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=48%><B>Value</B></TD>
<TD width=52%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=48%>ERROR_INVALID_PARAMETER</TD>
<TD width=52%>Both <I>lpszDomain</I> and <I>lpszServer</I> are NULL.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>Do not call <B>GetLastError</B> to get error information for this function.</P>

<P><B>Remarks</B></P>

<P>The <I>lpszDomain</I> parameter should specify a valid Windows NT domain name. If you are running your RAS administration application on a Windows NT Workstation or Server that is not participating in a Windows NT domain (for example, the workstation or server is in its own work group), then set <I>lpszDomain</I> to NULL. In this case, you must specify your server name in the <I>lpszServer</I> parameter. Be sure to prefix the server name with the "\\" characters. To get the server name, call the <B>GetComputerName</B> function.</P>

<P><B>See Also</B></P>

<P><A HREF="3188tg.htm"><B>GetComputerName</B></A>, <A HREF="in.ich.htm"><B>RasAdminUserGetInfo</B></A>, <A HREF="121gq90.htm"><B>RasAdminUserSetInfo</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
