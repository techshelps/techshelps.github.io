<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Private Key Blob Format</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="11jdd0t"></A><B>Private Key Blob Format</B></P>

<P>Private key blobs (type PRIVATEKEYBLOB) are used to store RSA public/private key pairs. They have the following format:</P>

<P>BLOBHEADER blobheader;</P>

<P>RSAPUBKEY rsapubkey;</P>

<P>BYTE modulus[rsapubkey.bitlen/8];</P>

<P>BYTE prime1[rsapubkey.bitlen/16];</P>

<P>BYTE prime2[rsapubkey.bitlen/16];</P>

<P>BYTE exponent1[rsapubkey.bitlen/16];</P>

<P>BYTE exponent2[rsapubkey.bitlen/16];</P>

<P>BYTE coefficient[rsapubkey.bitlen/16];</P>

<P>BYTE privateExponent[rsapubkey.bitlen/8];</P>

<P></P>

<P>If the key blob is encrypted, then everything but the <B>BLOBHEADER</B> portion of the blob is encrypted. Note that the encryption algorithm and encryption key parameters are not stored along with the private key blob. It is the responsibility of the application to manage this information.</P>

<P>The following table describes each private key blob component. Note that these fields largely correspond to the ones described in section 7.2 of <I>PKCS #1: RSA Encryption Standard</I>.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=27%><B>Field</B></TD>
<TD width=73%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=27%><B>blobheader</B></TD>
<TD width=73%>A <B>BLOBHEADER</B> structure as described in a previous section. The <B>bType</B> field must always have a value of PRIVATEKEYBLOB.</TD>
</TR>

<TR VALIGN="top">
<TD width=27%><B>rsapubkey</B></TD>
<TD width=73%>A RSAPUBKEY structure as described in a previous section. The <B>magic</B> field must always have a value of 0x32415352 ("RSA2").</TD>
</TR>

<TR VALIGN="top">
<TD width=27%><B>modulus</B></TD>
<TD width=73%>The modulus. This has a value of "prime1 * prime2" and is often known as "n".</TD>
</TR>

<TR VALIGN="top">
<TD width=27%><B>prime1</B></TD>
<TD width=73%>Prime number 1, often known as "p".</TD>
</TR>

<TR VALIGN="top">
<TD width=27%><B>prime2</B></TD>
<TD width=73%>Prime number 2, often known as "q".</TD>
</TR>

<TR VALIGN="top">
<TD width=27%><B>exponent1</B></TD>
<TD width=73%>Exponent 1. This has a numeric value of "d mod (p - 1)".</TD>
</TR>

<TR VALIGN="top">
<TD width=27%><B>exponent2</B></TD>
<TD width=73%>Exponent 2. This has a numeric value of "d mod (q - 1)".</TD>
</TR>

<TR VALIGN="top">
<TD width=27%><B>coefficient</B></TD>
<TD width=73%>Coefficient. This has a numeric value of "(inverse of q) mod p".</TD>
</TR>

<TR VALIGN="top">
<TD width=27%><B>privateExponent</B></TD>
<TD width=73%>Private exponent, often known as "d".</TD>
</TR>
</TABLE><BR>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
