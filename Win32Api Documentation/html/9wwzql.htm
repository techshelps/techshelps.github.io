<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Registering Your Namespace Extension</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="9wwzql"></A><B>Registering Your Namespace Extension</B></P>

<P>Registering your extension is not particularly difficult but it must be done precisely or users will never find your namespace extension. Consider the following registry entries, some of which are required for any namespace extension.</P>

<P>Namespace extensions, like all COM objects, must be registered in the CLSID section. In addition, they also have to be "apartment aware", having the named value ThreadingModel set to Apartment, as shown below.</P>

<P>HKEY_CLASSES_ROOT\CLSID\{<I>CLSID</I>}  </P>

<P>HKEY_CLASSES_ROOT_CLSID\{<I>CLSID</I>}\InProcServer32\(default)=path\filename.dll</P>

<P>HKEY_CLASSES_ROOT_CLSID\{<I>CLSID</I>}\InProcServer32\"ThreadingModel" = "Apartment"</P>

<P></P>

<P>If your namespace extension is going to run under a rooted Explorer, you should add the following entries so the Open and Explorer verbs appear on your namespace extension.</P>

<P>HKEY_CLASSES_ROOT_CLSID\{<I>CLSID</I>}\Shell\Open\Command\(default)</P>

<P>=c:\windows\explorer.exe/root,%1</P>

<P>HKEY_CLASSES_ROOT_CLSID\{<I>CLSID</I>}\Shell\Explore\Command\(default)   </P>

<P>=c:\windows\explorer.exe/e,/root/%1</P>

<P></P>

<P>You can also include entries under the following key for the default icon. </P>

<P>HKEY_CLASSES_ROOT_CLSID\{<I>CLSID</I>}\DefaultIcon\(default)="path\filename.dll",IconIndex</P>

<P></P>

<P>The following is an optional key but one that can be very important. If you include the "Attributes" named value under ...{<I>CLSID</I>}\ShellFolder, it specifies the attributes of a junction point by using the SFGAO_* flags returned by the <A HREF="2eqgekf.htm"><B>IShellFolder::GetAttributesOf</B></A> method.</P>

<P>HKEY_CLASSES_ROOT_CLSID\{<I>CLSID</I>}\ShellFolder\Attributes = 0000 00 00  </P>

<P></P>

<P>For example, if the SFGAO_FOLDER flag is set and its junction point exists in the system namespace, the user sees your extension's icon in the Explorer's left pane and is able to browse into it using the standard (nonrooted) Explorer. If this flag is not set, you must provide a rooted Explorer for browsing</P>

<P>Another example is the SFGAO_HASSUBFOLDER flag. If it is set, the Explorer can make the extension's icon expandable to the next level by displaying the + icon to its left. </P>

<P>Other registry entries you should know about include those required for putting items into MyComputer or on the Desktop. The following entries list all the items in those two locations:</P>

<P>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer</P>

<P>\MyComputer\NameSpace</P>

<P>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer</P>

<P>\Desktop\NameSpace</P>

<P></P>

<P>Finally, the following entry is currently required only for Windows NT but it should <I>always</I> be included for future compatibility. This is the list of extensions that the shell will load. Extensions not on this list will not be loaded by the shell on NT. </P>

<P>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WindowsNT\CurrentVersion\ShellExtensions</P>

<P>\Approved\{<I>CLSID</I>}="<I>Extension Name</I>"</P>

</BODY>
</HTML>
