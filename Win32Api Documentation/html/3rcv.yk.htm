<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>RasGetEntryProperties [New - Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="3rcv.yk"></A><B>RasGetEntryProperties  <A HREF="fdirfg.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="35kj_0r.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="lrsi7i.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>[New - Windows NT]</P>

<P>The <B>RasGetEntryProperties </B>function retrieves the properties of a phone-book entry.</P>

<P><B>DWORD RasGetEntryProperties(</B></P>

<TABLE cols=2 width=642>

<TR VALIGN="top">
<TD width=36%><B>LPTSTR</B> <I>lpszPhonebook</I><B>,</B></TD>
<TD width=64%>// pointer to full path and filename of phone-book file</TD>
</TR>

<TR VALIGN="top">
<TD width=36%><B>    LPTSTR</B> <I>lpszEntry</I><B>,</B></TD>
<TD width=64%>// pointer to an entry name </TD>
</TR>

<TR VALIGN="top">
<TD width=36%><B>    LPRASENTRY</B> <I>lpRasEntry</I><B>,</B></TD>
<TD width=64%>// buffer that receives entry information</TD>
</TR>

<TR VALIGN="top">
<TD width=36%><B>    LPDWORD</B> <I>lpdwEntryInfoSize</I><B>,</B></TD>
<TD width=64%>// size, in bytes, of the <I>lpRasEntry</I> buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=36%><B>    LPBYTE</B> <I>lpbDeviceInfo</I><B>,</B></TD>
<TD width=64%>// buffer that receives device-specific configuration information</TD>
</TR>

<TR VALIGN="top">
<TD width=36%><B>    LPDWORD</B> <I>lpdwDeviceInfoSize</I></TD>
<TD width=64%>// size, in bytes, of the <I>lpbDeviceInfo</I> buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=36%><B>   );</B></TD>
<TD width=64%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpszPhonebook</I></P>

<P><B>Windows NT: </B>Pointer to a null-terminated string that specifies the full path and filename of a phone-book (.PBK) file. If this parameter is NULL, the function uses the current default phone-book file. The default phone-book file is the one selected by the user in the <B>User Preferences</B> property sheet of the <B>Dial-Up Networking</B> dialog box.</P>

<P><I>lpszEntry</I></P>

<P>Pointer to a null-terminated string containing an existing entry name. If you specify an empty string, "", the function returns default values in the buffers pointed to by the <I>lpRasEntry</I> and <I>lpbDeviceInfo</I> parameters.</P>

<P><I>lpRasEntry</I></P>

<P>Pointer to a <A HREF="vji5sp.htm"><B>RASENTRY</B></A> structure followed by additional bytes for the alternate phone number list, if there is one. The structure receives the connection data associated with the phone-book entry specified by the <I>lpszEntry</I> parameter. Before calling the function, set the <B>dwSize</B> member of the structure to sizeof(RASENTRY) to identify the version of the structure. This parameter can be NULL.</P>

<P><I>lpdwEntryInfoSize</I></P>

<P>Pointer to a variable that contains the size, in bytes, of the <I>lpRasEntry</I> buffer. On return, the function sets this variable to the number of bytes required. This parameter can be NULL if the <I>lpRasEntry</I> parameter is NULL.</P>

<P>To determine the required buffer size, call <B>RasGetEntryProperties</B> with <I>lpRasEntry</I> set to NULL and *<I>lpdwEntryInfoSize</I> set to zero. The function returns the required buffer size in *<I>lpdwEntryInfoSize</I>.</P>

<P><I>lpbDeviceInfo</I></P>

<P>Pointer to a buffer that receives device-specific configuration information. This is opaque TAPI device configuration information that you should not manipulate directly. This parameter can be NULL. For more information about TAPI device configuration, see the Win32 Telephony (TAPI) Programmer's Reference. </P>

<P><I>lpdwDeviceInfoSize</I></P>

<P>Pointer to a variable that contains the size, in bytes, of the buffer specified by the <I>lpbDeviceInfo</I> parameter. On return, the function sets this variable to the number of bytes required. This parameter can be NULL if the <I>lpbDeviceInfo</I> parameter s NULL.</P>

<P>To determine the required buffer size, call <B>RasGetEntryProperties</B> with <I>lpbDeviceInfo</I> set to NULL and *<I>lpdwDeviceInfoSize</I> set to zero. The function returns the required buffer size in *<I>lpdwDeviceInfoSize</I>.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is zero.</P>

<P>If the function fails, the return value can be one of the following error codes.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=66%><B>Value</B></TD>
<TD width=34%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=66%>ERROR_INVALID_PARAMETER </TD>
<TD width=34%>The function was called with an invalid parameter.</TD>
</TR>

<TR VALIGN="top">
<TD width=66%>ERROR_BUFFER_INVALID </TD>
<TD width=34%>The address or buffer specified by <I>lpRasEntry </I>is invalid.</TD>
</TR>

<TR VALIGN="top">
<TD width=66%>ERROR_BUFFER_TOO_SMALL </TD>
<TD width=34%>The buffer size indicated in <I>lpdwEntryInfoSize </I>is too small.</TD>
</TR>

<TR VALIGN="top">
<TD width=66%>ERROR_CANNOT_OPEN_PHONEBOOK </TD>
<TD width=34%>The phone book is corrupted or is missing components.</TD>
</TR>

<TR VALIGN="top">
<TD width=66%>ERROR_CANNOT_FIND_PHONEBOOK_ENTRY</TD>
<TD width=34%>The phone-book entry does not exist.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="vji5sp.htm"><B>RASENTRY</B></A>, <A HREF="4ocjekt.htm"><B>RasSetEntryProperties</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
