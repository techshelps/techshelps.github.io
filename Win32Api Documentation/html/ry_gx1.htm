<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Getting the System Version</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="ry_gx1"></A><B>Getting the System Version</B></P>

<P>The following example uses the <A HREF="3_iy_yv.htm"><B>GetVersionEx</B></A> function to obtain the current version of Windows and then displays the version number in a message box. </P>

<P>OSVERSIONINFO osvi;</P>

<P>char szVersion [80];</P>

<P></P>

<P>memset(&amp;osvi, 0, sizeof(OSVERSIONINFO));</P>

<P>osvi.dwOSVersionInfoSize = sizeof (OSVERSIONINFO);</P>

<P>GetVersionEx (&amp;osvi);</P>

<P>if (osvi.dwPlatformId == VER_PLATFORM_WIN32s)</P>

<P>wsprintf (szVersion, "Microsoft Win32s %d.%d (Build %d)",</P>

<P>osvi.dwMajorVersion,</P>

<P>osvi.dwMinorVersion,</P>

<P>osvi.dwBuildNumber &amp; 0xFFFF);</P>

<P>else if (osvi.dwPlatformId == VER_PLATFORM_WIN32_WINDOWS)</P>

<P>wsprintf (szVersion, "Microsoft Windows 95 %d.%d (Build %d)",</P>

<P>osvi.dwMajorVersion,</P>

<P>osvi.dwMinorVersion,</P>

<P>osvi.dwBuildNumber &amp; 0xFFFF);</P>

<P>else if (osvi.dwPlatformId == VER_PLATFORM_WIN32_NT)</P>

<P>wsprintf (szVersion, "Microsoft Windows NT %d.%d (Build %d)",</P>

<P>osvi.dwMajorVersion,</P>

<P>osvi.dwMinorVersion,</P>

<P>osvi.dwBuildNumber &amp; 0xFFFF);</P>

<P>MessageBox( NULL, szVersion, "Version Check", MB_OK );</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
