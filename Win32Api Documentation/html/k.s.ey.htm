<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SHFILEOPSTRUCT</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="k.s.ey"></A><B>SHFILEOPSTRUCT  <A HREF="j47lcb.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="b2.3c..htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1lc0a5k.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>Contains information that the <A HREF="x0825p.htm"><B>SHFileOperation</B></A> function uses to perform file operations.</P>

<P>typedef struct _SHFILEOPSTRUCT { // shfos  </P>

<P>HWND         hwnd; </P>

<P>UINT         wFunc; </P>

<P>LPCSTR       pFrom; </P>

<P>LPCSTR       pTo; </P>

<P>FILEOP_FLAGS fFlags; </P>

<P>BOOL         fAnyOperationsAborted; </P>

<P>LPVOID       hNameMappings; </P>

<P>LPCSTR       lpszProgressTitle; </P>

<P>} SHFILEOPSTRUCT, FAR *LPSHFILEOPSTRUCT; </P>

<P></P>

<P><B>Members</B></P>

<P><B>hwnd</B></P>

<P>Handle of the dialog box to use to display information about the status of the operation. </P>

<P><B>wFunc</B></P>

<P>Operation to perform. This member can be one of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=27%>FO_COPY</TD>
<TD width=73%>Copies the files specified by <B>pFrom</B> to the location specified by <B>pTo</B>.</TD>
</TR>

<TR VALIGN="top">
<TD width=27%>FO_DELETE</TD>
<TD width=73%>Deletes the files specified by <B>pFrom</B> (<B>pTo</B> is ignored).</TD>
</TR>

<TR VALIGN="top">
<TD width=27%>FO_MOVE</TD>
<TD width=73%>Moves the files specified by <B>pFrom</B> to the location specified by <B>pTo</B>.</TD>
</TR>

<TR VALIGN="top">
<TD width=27%>FO_RENAME</TD>
<TD width=73%>Renames the files specified by <B>pFrom</B>. </TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>pFrom</B></P>

<P>Pointer to a buffer that specifies one or more source file names. Multiple names must be null-separated. The list of names must be double null-terminated.</P>

<P><B>pTo</B></P>

<P>Pointer to a buffer that contains the name of the destination file or directory. The buffer can contain mutiple destination file names if the <B>fFlags</B> member specifies FOF_MULTIDESTFILES. Multiple names must be null-separated. The list of names must be double null-terminated.</P>

<P><B>fFlags</B></P>

<P>Flags that control the file operation. This member can be a combination of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=43%>FOF_ALLOWUNDO</TD>
<TD width=57%>Preserves undo information, if possible.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>FOF_CONFIRMMOUSE</TD>
<TD width=57%>Not implemented.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>FOF_FILESONLY</TD>
<TD width=57%>Performs the operation only on files if a wildcard filename (*.*) is specified.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>FOF_MULTIDESTFILES</TD>
<TD width=57%>Indicates that the <B>pTo</B> member specifies multiple destination files (one for each source file) rather than one directory where all source files are to be deposited.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>FOF_NOCONFIRMATION</TD>
<TD width=57%>Responds with "yes to all" for any dialog box that is displayed.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>FOF_NOCONFIRMMKDIR</TD>
<TD width=57%>Does not confirm the creation of a new directory if the operation requires one to be created.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>FOF_RENAMEONCOLLISION</TD>
<TD width=57%>Gives the file being operated on a new name (such as "Copy #1 of...") in a move, copy, or rename operation if a file of the target name already exists.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>FOF_SILENT</TD>
<TD width=57%>Does not display a progress dialog box.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>FOF_SIMPLEPROGRESS</TD>
<TD width=57%>Displays a progress dialog box, but does not show the filenames.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>FOF_WANTMAPPINGHANDLE</TD>
<TD width=57%>Fills in the <B>hNameMappings</B> member. The handle must be freed by using the <A HREF="5bh6_o_.htm"><B>SHFreeNameMappings</B></A> function.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>fAnyOperationsAborted</B></P>

<P>Value that receives TRUE if the user aborted any file operations before they were completed or FALSE otherwise.</P>

<P><B>hNameMappings</B></P>

<P>Handle of a filename mapping object that contains an array of <A HREF="bqehwx.htm"><B>SHNAMEMAPPING</B></A> structures. Each structure contains the old and new path names for each file that was moved, copied, or renamed. This member is used only if <B>fFlags</B> includes FOF_WANTMAPPINGHANDLE.</P>

<P><B>lpszProgressTitle</B></P>

<P>Pointer to a string to use as the title for a progress dialog box. This member is used only if <B>fFlags</B> includes FOF_SIMPLEPROGRESS.</P>

<P></P>

<P><B>Remarks</B></P>

<P>If <B>pFrom</B> or <B>pTo</B> are unqualified names, the current directories are taken from the global current drive and directory settings as managed by the <B>GetCurrentDirectory</B> and <B>SetCurrentDirectory </B>functions.</P>

<P><B>See Also</B></P>

<P><A HREF="lwy0ba.htm"><B>GetCurrentDirectory</B></A>, <A HREF="hwnghc.htm"><B>SetCurrentDirectory</B></A>, <A HREF="x0825p.htm"><B>SHFileOperation</B></A>, <A HREF="5bh6_o_.htm"><B>SHFreeNameMappings</B></A>, <A HREF="bqehwx.htm"><B>SHNAMEMAPPING</B></A> </P>

</BODY>
</HTML>
