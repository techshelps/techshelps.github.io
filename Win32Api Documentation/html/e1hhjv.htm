<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>GetFontData</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="e1hhjv"></A><B>GetFontData  <A HREF="dm0co1.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="4jd_z5i.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1xkvu5n.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetFontData</B> function retrieves font metric data for a TrueType font. </P>

<P><B>DWORD GetFontData(</B></P>

<TABLE cols=2 width=419>

<TR VALIGN="top">
<TD width=39%><B>HDC</B> <I>hdc</I><B>,</B></TD>
<TD width=61%>// handle of device context </TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    DWORD</B> <I>dwTable</I><B>,</B></TD>
<TD width=61%>// metric table to query </TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    DWORD</B> <I>dwOffset</I><B>,</B></TD>
<TD width=61%>// offset into table being queried </TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    LPVOID</B> <I>lpvBuffer</I><B>,</B></TD>
<TD width=61%>// address of buffer for returned data  </TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    DWORD</B> <I>cbData</I> </TD>
<TD width=61%>// length of data to query </TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>   );</B></TD>
<TD width=61%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hdc</I></P>

<P>Identifies the device context. </P>

<P><I>dwTable</I></P>

<P>Specifies the name of a font metric table from which the font data is to be retrieved. This parameter can identify one of the metric tables documented in the TrueType Font Files specification published by Microsoft Corporation. If this parameter is zero, the information is retrieved starting at the beginning of the font file. </P>

<P><I>dwOffset</I></P>

<P>Specifies the offset from the beginning of the font metric table to the location where the function should begin retrieving information. If this parameter is zero, the information is retrieved starting at the beginning of the table specified by the <I>dwTable</I> parameter. If this value is greater than or equal to the size of the table, an error occurs. </P>

<P><I>lpvBuffer</I></P>

<P>Points to a buffer to receive the font information. If this parameter is NULL, the function returns the size of the buffer required for the font data. </P>

<P><I>cbData</I></P>

<P>Specifies the length, in bytes, of the information to be retrieved. If this parameter is zero, <B>GetFontData</B> returns the size of the data specified in the <I>dwTable</I> parameter. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is the number of bytes returned.</P>

<P>If the function fails, the return value is GDI_ERROR. </P>

<P><B>Remarks</B></P>

<P>An application can sometimes use the <B>GetFontData</B> function to save a TrueType font with a document. To do this, the application determines whether the font can be embedded by checking the <B>otmfsType</B> member of the <B>OUTLINETEXTMETRIC</B> structure. If bit 1 of <B>otmfsType</B> is set, embedding is not permitted for the font. If bit 1 is clear, the font can be embedded. If bit 2 is set, the embedding is read-only. If embedding is permitted, the application can retrieve the entire font file, specifying zero for the <I>dwTable</I>, <I>dwOffset</I>, and <I>cbData</I> parameters. </P>

<P>If an application attempts to use this function to retrieve information for a non-TrueType font, an error occurs. </P>

<P><B>See Also</B></P>

<P><A HREF="zd2pdo.htm"><B>GetTextMetrics</B></A>, <A HREF="ca9ocg.htm"><B>OUTLINETEXTMETRIC</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
