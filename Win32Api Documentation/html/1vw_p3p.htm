<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>SetupComm</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1vw_p3p"></A><B>SetupComm  <A HREF="v.t0nx.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="5jpun8.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="llpv25.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>SetupComm</B> function initializes the communications parameters for a specified communications device. </P>

<P><B>BOOL SetupComm(</B></P>

<TABLE cols=2 width=431>

<TR VALIGN="top">
<TD width=42%><B>HANDLE</B> <I>hFile</I><B>,</B></TD>
<TD width=58%>// handle of communications device  </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    DWORD</B> <I>dwInQueue</I><B>,</B></TD>
<TD width=58%>// size of input buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    DWORD</B> <I>dwOutQueue</I></TD>
<TD width=58%>// size of output buffer</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>   );</B></TD>
<TD width=58%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hFile</I></P>

<P>Identifies the communications device. The <A HREF="xn35yd.htm"><B>CreateFile</B></A> function returns this handle. </P>

<P><I>dwInQueue</I></P>

<P>Specifies the recommended size, in bytes, of the device's internal input buffer. </P>

<P><I>dwOutQueue</I></P>

<P>Specifies the recommended size, in bytes, of the device's internal output buffer. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>After a process uses the <B>CreateFile</B> function to open a handle to a communications device, it can call <B>SetupComm</B> to set the communications parameters for the device. If it does not set them, the device uses the default parameters when the first call to another communications function occurs. </P>

<P>The <I>dwInQueue</I> and <I>dwOutQueue</I> parameters specify the recommended sizes for the internal buffers used by the driver for the specified device. For example, YMODEM protocol packets are slightly larger than 1024 bytes. Therefore, a recommended buffer size might be 1200 bytes for YMODEM communications. For Ethernet-based communications, a recommended buffer size might be 1600 bytes, which is slightly larger than a single Ethernet frame. </P>

<P>The device driver receives the recommended buffer sizes, but is free to use any input and output (I/O) buffering scheme, as long as it provides reasonable performance and data is not lost due to overrun (except under extreme circumstances). For example, the function can succeed even though the driver does not allocate a buffer, as long as some other portion of the operating system provides equivalent functionality. </P>

<P>If the device driver determines that the recommended buffer sizes involve transfers beyond its ability to handle, the function can fail. </P>

<P><B>See Also</B></P>

<P><A HREF="xn35yd.htm"><B>CreateFile</B></A>, <A HREF="2tsk0g9.htm"><B>SetCommState</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
