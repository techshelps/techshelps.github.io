<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SetPrinter</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="839c6p"></A><B>SetPrinter  <A HREF="a8xaf9.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="joiq6.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="yhp8x..htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>SetPrinter</B> function sets the state of the specified printer by pausing printing, resuming printing, or clearing all print jobs. The function can also be used to set printer data. </P>

<P><B>BOOL SetPrinter(</B></P>

<TABLE cols=2 width=455>

<TR VALIGN="top">
<TD width=37%><B>HANDLE</B> <I>hPrinter</I><B>,</B></TD>
<TD width=63%>// handle of printer object </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    DWORD</B> <I>Level</I><B>,</B></TD>
<TD width=63%>// structure level </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    LPBYTE</B> <I>pPrinter</I><B>,</B></TD>
<TD width=63%>// address of array containing printer data  </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    DWORD</B> <I>Command</I> </TD>
<TD width=63%>// printer-state command </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>   );</B></TD>
<TD width=63%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hPrinter</I></P>

<P>Handle to the printer of interest. </P>

<P><I>Level</I></P>

<P><B>Windows 95:</B> Specifies the type of data contained in <I>pPrinter</I>. This parameter must be 0, 2, 3, 4, or 5. This parameter must be zero if <I>Command</I> is not equal to zero.</P>

<P><B>Windows NT:</B> Specifies the type of data contained in <I>pPrinter. </I>This parameter must be 0, 2, 3, 5, or 6. This parameter must be zero if <I>Command</I> is not equal to zero.</P>

<P><I>pPrinter</I></P>

<P>This is either a DWORD value indicating the printer status, or a pointer to an array of bytes that may contain printer data. </P>

<P>If <I>Level</I> is 0, and the <I>Command</I> parameter is PRINTER_CONTROL_SET_STATUS, <I>pPrinter</I> must contain a DWORD value that specifies the new printer status to set. For a list of the possible status values, see the <B>Status</B> member of the PRINTER_INFO_2 structure. Note that PRINTER_STATUS_PAUSED and PRINTER_STATUS_PENDING_DELETION are not valid status values to set. </P>

<P>If <I>Level</I> is 0, but the <I>Command</I> parameter is not PRINTER_CONTROL_SET_STATUS, <I>pPrinter</I> must be NULL. </P>

<P><B>Windows 95:</B> If <I>Level</I> is 2, 3, 4, or 5, <I>pPrinter</I> points to an array that contains PRINTER_INFO_2, PRINTER_INFO_3, PRINTER_INFO_4, or PRINTER_INFO_5 structures, respectively.</P>

<P><B>Windows NT:</B> If <I>Level</I> is 2, 3, 5, or 6, <I>pPrinter</I> points to an array that contains PRINTER_INFO_2,  PRINTER_INFO_3, PRINTER_INFO_5, or PRINTER_INFO_6 structures, respectively.</P>

<P><I>Command</I></P>

<P>This parameter can be zero or one of the following values. If it is zero, the printer retains its original state and the printer data is reconfigured by using the structure to which <I>pPrinter</I> points. </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=53%><B>Value</B></TD>
<TD width=47%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=53%>PRINTER_CONTROL_PAUSE</TD>
<TD width=47%>Pauses the printer.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>PRINTER_CONTROL_PURGE</TD>
<TD width=47%>Deletes all print jobs in the printer.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>PRINTER_CONTROL_RESUME</TD>
<TD width=47%>Resumes a paused printer.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>PRINTER_CONTROL_SET_STATUS</TD>
<TD width=47%>Sets the printer status.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>If <I>Command</I> is any of the above values, <I>Level</I> must be zero.</P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>You can obtain the handle <I>hPrinter</I> is by calling the <A HREF="9gwvgs.htm"><B>OpenPrinter</B></A> function. </P>

<P>To modify the current printer settings, an application should call <A HREF="ek5z48.htm"><B>GetPrinter</B></A> to retrieve the current settings into a <A HREF="x0ethp.htm"><B>PRINTER_INFO_2</B></A> structure, modify the members of that structure as necessary, and then call the <A HREF="#839c6p"><B>SetPrinter</B></A> function. </P>

<P>The <B>SetPrinter</B> function ignores the following members of a <B>PRINTER_INFO_2</B> structure: </P>

<P><B>pServerName</B>, <B>AveragePPM</B>, <B>Status</B>, and <B>cJobs</B> </P>

<P>Pausing a printer suspends scheduling of all print jobs for that printer, except for the one print job that may be currently printing. Print jobs can be submitted to a paused printer, but no jobs will be scheduled to print on that printer until printing is resumed. If a printer is cleared, all print jobs for that printer are deleted, except for the current print job. </P>

<P>If the printer data structure contains a pointer to a security descriptor, only those components of the security descriptor that the caller has permission to write should be present. An application that wants to write particular security descriptor components must open the printer with sufficient access permission to modify those components. The following table shows the security descriptor components that can be modified for particular access permission values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=45%><B>Access Permission</B></TD>
<TD width=55%><B>Modifiable Security Descriptor Components </B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%>WRITE_OWNER</TD>
<TD width=55%>Owner, primary proup</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>WRITE_DAC</TD>
<TD width=55%>Discretionary access-control list (ACL)</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>ACCESS_SYSTEM_SECURITY</TD>
<TD width=55%>System ACL</TD>
</TR>
</TABLE><BR>

<P></P>

<P>If the calling application lacks a required permission, <B>SetPrinter</B> fails. Those components of a security descriptor that an application does not wish to modify should be NULL or not be present, as appropriate. If you do not want to modify the security descriptor, and are calling <B>SetPrinter </B>with a <B>PRINTER_INFO_2 </B>structure, set the <B>pSecurityDescriptor</B> member of that structure to NULL. </P>

<P><B>Windows 95:</B> <B>SetPrinter</B> does not update the <B>pShareName</B> member in the <B>PRINTER_INFO_2</B> structure.</P>

<P><B>Windows 95: SetPrinter</B> is not supported when called against a Windows NT printer from a Windows 95 machine using the printer's UNC name.</P>

<P><B>See Also</B></P>

<P><A HREF="m6o4k_.htm"><B>AddPrinter</B></A>, <A HREF="ek5z48.htm"><B>GetPrinter</B></A>, <A HREF="9gwvgs.htm"><B>OpenPrinter</B></A>, <A HREF="x0ethp.htm"><B>PRINTER_INFO_2</B></A>, <A HREF="1jdqt55.htm"><B>PRINTER_INFO_3</B></A>, <A HREF="x.ethp.htm"><B>PRINTER_INFO_4</B></A>, <A HREF="x_ethp.htm"><B>PRINTER_INFO_5</B></A>, <A HREF="1jgqt55.htm"><B>PRINTER_INFO_6</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
