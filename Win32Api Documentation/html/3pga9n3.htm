<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>DeviceCapabilities</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="3pga9n3"></A><B>DeviceCapabilities  <A HREF="_zbqz9.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="2fduzal.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="de09ns.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>DeviceCapabilities</B> function retrieves the capabilities of a printer device driver. </P>

<P><B>DWORD DeviceCapabilities(</B></P>

<TABLE cols=2 width=503>

<TR VALIGN="top">
<TD width=48%><B>LPCTSTR</B> <I>pDevice</I><B>,</B></TD>
<TD width=52%>// pointer to a printer-name string </TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    LPCTSTR</B> <I>pPort</I><B>,</B></TD>
<TD width=52%>// pointer to a port-name string </TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    WORD</B> <I>fwCapability</I><B>,</B></TD>
<TD width=52%>// device capability to query </TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    LPTSTR</B> <I>pOutput</I><B>,</B></TD>
<TD width=52%>// pointer to the output </TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    CONST DEVMODE</B> <B>*</B><I>pDevMode</I> </TD>
<TD width=52%>// pointer to structure with device data  </TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>   );</B></TD>
<TD width=52%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>pDevice</I></P>

<P>Pointer to a null-terminated string that contains the name of the printer. Note that this is the name of the printer, not of the printer driver.</P>

<P><I>pPort</I></P>

<P>Pointer to a null-terminated string that contains the name of the port to which the device is connected, such as "LPT1". </P>

<P><I>fwCapability</I></P>

<P>Specifies the capabilities to query. This parameter can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=42%><B>Value</B></TD>
<TD width=58%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=42%>DC_BINADJUST</TD>
<TD width=58%><B>Windows 95 only:</B> Retrieves the page positioning for the paper source specified in the <B>DEVMODE</B> structure pointed to by <I>pdevMode</I>. The return value can be one of the following:</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>&nbsp;</TD>
<TD width=58%>    DCBA_FACEUPNONE</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>&nbsp;</TD>
<TD width=58%>    DCBA_FACEUPCENTER</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>&nbsp;</TD>
<TD width=58%>    DCBA_FACEUPLEFT</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>&nbsp;</TD>
<TD width=58%>    DCBA_FACEUPRIGHT</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>&nbsp;</TD>
<TD width=58%>    DCBA_FACEDOWNNONE</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>&nbsp;</TD>
<TD width=58%>    DCBA_FACEDOWNCENTER</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>&nbsp;</TD>
<TD width=58%>    DCBA_FACEDOWNLEFT</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>&nbsp;</TD>
<TD width=58%>    DCBA_FACEDOWNRIGHT</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>DC_BINNAMES</TD>
<TD width=58%>Copies an array containing a list of the names of the paper bins. This array is in the form <B>char</B> <I>PaperNames</I>[<I>cBinMax</I>][<I>cchBinName</I>] where <I>cchBinName</I> is 24. If the <I>pOutput</I> parameter is NULL, the return value is the number of bin entries required. Otherwise, the return value is the number of bins copied.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>DC_BINS</TD>
<TD width=58%>Retrieves a list of available bins. The function copies the list to the <I>pOutput</I> parameter as a <B>WORD</B> array. If <I>pOutput</I> is NULL, the function returns the number of supported bins to allow the application the opportunity to allocate a buffer with the correct size. For more information about these bins, see the description of the <B>dmDefaultSource</B> member of the <A HREF="1bkrzj1.htm"><B>DEVMODE</B></A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>DC_COPIES</TD>
<TD width=58%>Returns the number of copies the device can print.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>DC_DRIVER</TD>
<TD width=58%>Returns the version number of the printer driver.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>DC_DATATYPE_PRODUCED</TD>
<TD width=58%><B>Windows 95 only:</B> The return value is the number of datatypes supported by the printer driver. If the function returns -1, the driver understands the "RAW" datatype only. The names of the supported datatypes are copied to an array. Use the names in the <A HREF="3kadk3.htm"><B>DOCINFO</B></A> structure when calling the <A HREF="231v06s.htm"><B>StartDoc</B></A> function to specify the datatype.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>DC_DUPLEX</TD>
<TD width=58%>Returns the level of duplex support. The function returns 1 if the printer is capable of duplex printing. Otherwise, the return value is zero.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>DC_EMF_COMPLIANT</TD>
<TD width=58%><B>Windows 95 only:</B> Determines if a printer driver supports enhanced metafile (EMF). A return value of 1 means the driver supports EMF. A return value of -1 means that the driver does not support EMF</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>DC_ENUMRESOLUTIONS</TD>
<TD width=58%>Returns a list of available resolutions. If <I>pOutput</I> is NULL, the function returns the number of available resolution configurations. Resolutions are represented by pairs of <B>LONG</B> integers representing the horizontal and vertical resolutions (specified in dots per inch).</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>DC_EXTRA</TD>
<TD width=58%>Returns the number of bytes required for the device-specific portion of the <B>DEVMODE</B> structure for the printer driver.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>DC_FIELDS</TD>
<TD width=58%>Returns the <B>dmFields</B> member of the printer driver's <A HREF="1bkrzj1.htm"><B>DEVMODE</B></A> structure. The <B>dmFields</B> member indicates which members in the device-independent portion of the structure are supported by the printer driver.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>DC_FILEDEPENDENCIES</TD>
<TD width=58%>Returns a list of files that also need to be loaded when a driver is installed. If the <I>pOutput</I> parameter is NULL, the function returns the number of files. Otherwise, <I>pOutput</I> points to an array of filenames in the form <B>char[</B><I>chFileName</I><B>, 64]</B>. Each filename is a null-terminated string.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>DC_MAXEXTENT</TD>
<TD width=58%>Returns a <A HREF="24h.4h.htm"><B>POINTS</B></A> structure that contains the maximum paper size that the <B>dmPaperLength</B> and <B>dmPaperWidth</B> members of the printer driver's <B>DEVMODE</B> structure can specify. The <B>x</B> member of the <B>POINTS</B> structure contains the maximum <B>dmPaperWidth</B> value, and the <B>y</B> member contains the maximum <B>dmPaperLength</B> value. </TD>
</TR>

<TR VALIGN="top">
<TD width=42%>DC_MINEXTENT</TD>
<TD width=58%>Returns a <B>POINTS</B> structure that contains the minimum paper size that the <B>dmPaperLength</B> and <B>dmPaperWidth</B> members of the printer driver's <A HREF="1bkrzj1.htm"><B>DEVMODE</B></A> structure can specify. The <B>x</B> member of the <B>POINTS</B> structure contains the minimum <B>dmPaperWidth</B> value, and the <B>y</B> member contains the minimum <B>dmPaperLength</B> value.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>DC_ORIENTATION</TD>
<TD width=58%>Returns the relationship between portrait and landscape orientations for a device, in terms of the number of degrees that portrait orientation is rotated counterclockwise to produce landscape orientation. The return value can be one of the following:</TD>
</TR>
</TABLE><BR>

<P></P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=58%><B>Value</B></TD>
<TD width=42%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=58%>0</TD>
<TD width=42%>No landscape orientation.</TD>
</TR>

<TR VALIGN="top">
<TD width=58%>90</TD>
<TD width=42%>Portrait is rotated 90 degrees to produce landscape. (For example, Hewlett-Packard PCL printers.)</TD>
</TR>

<TR VALIGN="top">
<TD width=58%>270</TD>
<TD width=42%>Portrait is rotated 270 degrees to produce landscape. (For example, dot-matrix printers.)</TD>
</TR>
</TABLE><BR>

<P></P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=41%>DC_PAPERNAMES</TD>
<TD width=59%>Retrieves a list of supported paper names (for example, Letter or Legal). If the <I>pOutput</I> parameter is NULL, the function returns the number of paper sizes available. Otherwise, <I>pOutput</I> points to an array for the paper names in the form <B>char[</B><I>cPaperNames</I><B>, 64]</B>. Each paper name is a null-terminated string.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DC_PAPERS</TD>
<TD width=59%>Retrieves a list of supported paper sizes. The function copies the list to <I>pOutput</I> as a <B>WORD</B> array and returns the number of entries in the array. If <I>pOutput</I> is NULL, the function returns the number of supported paper sizes to allow the application the opportunity to allocate a buffer with the correct size. For more information on paper sizes, see the description of the <B>dmPaperSize</B> member of the <A HREF="1bkrzj1.htm"><B>DEVMODE</B></A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DC_PAPERSIZE</TD>
<TD width=59%>Copies the dimensions of all supported paper sizes, in tenths of a millimeter, to an array of <B>POINT</B> structures pointed to by the <I>pOutput</I> parameter. The width (x-dimension) and length (y-dimension) of a paper size are returned as if the paper were in the DMORIENT_PORTRAIT orientation.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DC_SIZE</TD>
<TD width=59%>Returns the <B>dmSize</B> member of the printer driver's <A HREF="1bkrzj1.htm"><B>DEVMODE</B></A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>DC_TRUETYPE</TD>
<TD width=59%>Retrieves the abilities of the driver to use TrueType fonts. For DC_TRUETYPE, the <I>pOutput</I> parameter should be NULL. The return value can be one or more of the following:</TD>
</TR>
</TABLE><BR>

<P></P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=75%><B>Value</B></TD>
<TD width=25%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=75%>DCTT_BITMAP</TD>
<TD width=25%>Device can print TrueType fonts as graphics. (For example, dot-matrix and PCL printers.)</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>DCTT_DOWNLOAD</TD>
<TD width=25%>Device can download TrueType fonts. (For example, PCL and PostScript printers.)</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>DCTT_DOWNLOAD_<BR>
OUTLINE</TD>
<TD width=25%><B>Windows 95 only:</B> Device can download outline TrueType fonts.</TD>
</TR>

<TR VALIGN="top">
<TD width=75%>DCTT_SUBDEV</TD>
<TD width=25%>Device can substitute device fonts for TrueType fonts. (For example, PostScript printers.)</TD>
</TR>
</TABLE><BR>

<P></P>

<P></P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=42%>DC_VERSION</TD>
<TD width=58%>Returns the specification version to which the printer driver conforms.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>pOutput</I></P>

<P>Pointer to an array of bytes. The format of the array depends on the setting of the <I>fwCapability</I> parameter. If <I>pOutput</I> is zero, <B>DeviceCapabilities</B> returns the number of bytes required for the output data. </P>

<P><I>pDevMode</I></P>

<P>Pointer to a <A HREF="1bkrzj1.htm"><B>DEVMODE</B></A> structure. If this parameter is NULL, <B>DeviceCapabilities</B> retrieves the current default initialization values for the specified printer driver. Otherwise, the function retrieves the values contained in the structure to which <I>pDevMode</I> points. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value depends on the setting of the <I>fwCapability</I> parameter. </P>

<P>If the function fails, the return value is -1. </P>

<P><B>Remarks</B></P>

<P>In previous versions of Windows, the <B>DeviceCapabilities</B> function was implemented in the printer driver and you needed to call the <B>LoadLibrary</B> and <B>GetProcAddress</B> functions to get a pointer to the function. This is no longer necessary since <B>DeviceCapabilities</B> is part of the Win32 API and you can call it directly. You should not call <B>LoadLibrary</B> on the printer driver.</P>

<P>The <B>DEVMODE</B> structure pointed to by the <I>pDevMode</I> parameter may be obtained by calling the <B>DocumentProperties</B> function.  </P>

<P><B>See Also</B></P>

<P><A HREF="1bkrzj1.htm"><B>DEVMODE</B></A>, <A HREF="c1cm.y.htm"><B>DocumentProperties</B></A>, <A HREF="19irwll.htm"><B>GetDeviceCaps</B></A>, <A HREF="c_pcn4.htm"><B>GetProcAddress</B></A>, <A HREF="1vghbf8.htm"><B>LoadLibrary</B></A>, <A HREF="44vp0_.htm"><B>POINT</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
