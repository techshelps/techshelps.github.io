<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>AddPrinterDriver</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="12dsaat"></A><B>AddPrinterDriver  <A HREF="xcufx8.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="joiq6.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="yhp8x..htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>AddPrinterDriver</B> function installs a local or remote printer driver and links the configuration, data, and driver files. </P>

<P><B>BOOL AddPrinterDriver(</B></P>

<TABLE cols=2 width=405>

<TR VALIGN="top">
<TD width=42%><B>LPTSTR</B> <I>pName</I><B>,</B></TD>
<TD width=58%>// pointer to server name </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    DWORD</B> <I>Level</I><B>,</B></TD>
<TD width=58%>// printer info. structure level </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    LPBYTE</B> <I>pDriverInfo</I> </TD>
<TD width=58%>// pointer to printer info. structure </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>   );</B></TD>
<TD width=58%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>pName</I></P>

<P>Pointer to a null-terminated string that specifies the name of the server on which the driver should be installed. </P>

<P>If <I>pName</I> is NULL, the driver will be installed locally. </P>

<P><I>Level</I></P>

<P>Specifies the version of the structure to which <I>pDriverInfo</I> points.</P>

<P>This value can be either 2 or 3.</P>

<P><I>pDriverInfo</I></P>

<P>Pointer to either a <A HREF="camz93.htm"><B>DRIVER_INFO_2</B></A> structure or a <A HREF="cbmz93.htm"><B>DRIVER_INFO_3</B></A> structure. If <I>Level</I> is 2, this parameter receives a <B>DRIVER_INFO_2</B> structure. If <I>Level</I> is 3, this parameter receives a <B>DRIVER_INFO_3</B> structure.</P>

<P>If the <I>pEnvironment</I> member of the structure pointed to by <I>pDriverInfo</I> is NULL, the current environment of the caller/client (not of the destination/server) is used.</P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>Before an application calls the <B>AddPrinterDriver </B>function, all files required by the driver must be copied to the system's printer-driver directory. An application can retrieve the name of this directory by calling the <B>GetPrinterDriverDirectory</B> function. </P>

<P>An application can determine which printer drivers are currently installed by calling the <B>EnumPrinterDrivers</B> function. </P>

<P><B>See Also</B></P>

<P><A HREF="camz93.htm"><B>DRIVER_INFO_2</B></A>, <A HREF="cbmz93.htm"><B>DRIVER_INFO_3</B></A>, <A HREF="1dibzdw.htm"><B>EnumPrinterDrivers</B></A>, <A HREF="166k1_h.htm"><B>GetPrinterDriverDirectory</B></A> </P>

</BODY>
</HTML>
