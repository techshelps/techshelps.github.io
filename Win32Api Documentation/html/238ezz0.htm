<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>AT_ENUM</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="238ezz0"></A><B>AT_ENUM  <A HREF="h.ovhi.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="l.g6mo.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="v9hkzc.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>AT_ENUM</B> structure enumerates and returns information about an entire queue of jobs that have already been submitted.</P>

<P>typedef struct _AT_ENUM {</P>

<P>DWORD   JobId;</P>

<P>DWORD   JobTime;</P>

<P>DWORD   DaysOfMonth;</P>

<P>UCHAR   DaysOfWeek;</P>

<P>UCHAR   Flags;</P>

<P>LPWSTR  Command;</P>

<P>} AT_ENUM, *PAT_ENUM, *LPAT_ENUM;</P>

<P></P>

<P><B>Members</B></P>

<P><B>JobID</B></P>

<P>Job identifier of an already submitted job.</P>

<P><B>JobTime</B></P>

<P>Time of day at which a job is scheduled to run. Time is a local time at a computer on which the Schedule service is running. Time is measured from midnight and is expressed in milliseconds.</P>

<P><B>DaysOfMonth</B></P>

<P>Bitmask for the days of the month on which a job is scheduled to run. The bitmask is NULL if a job was scheduled to run only once at the first occurrence of <B>JobTime</B><I>.</I> For each bit that is set in the bitmask a job will run at <B>JobTime</B> on a corresponding day of the month. Bit 0 corresponds to first day of the month, and so on.</P>

<P><B>DaysOfWeek</B></P>

<P>Bitmask for the days of the week on which this job is scheduled to run. The bitmask is NULL if a job was scheduled to run only once at the first occurrence of <B>JobTime</B><I>.</I> For each bit that is set in the bitmask a job will run at <B>JobTime</B> on a corresponding day of the week. Bit 0 corresponds to Monday (first day of the week), and so on.</P>

<P><B>Flags</B></P>

<P>Bitmask describing job properties. For job submission (<A HREF="abm99a.htm"><B>NetScheduleJobAdd</B></A>), possible values are:</P>

<P>JOB_RUN_PERIODICALLY</P>

<P>If this flag bit is set, the job runs on every day for which corresponding bits in <B>DaysOfMonth</B> or <B>DaysOfWeek</B> are set. If this flag bit is clear, the job runs only once for each bit that was set in <B>DaysOfMonth</B> or <B>DaysOfWeek</B> at the time of job submission.</P>

<P>JOB_ADD_CURRENT_DATE</P>

<P>When this flag bit is set, the job will also execute at the first occurrence of <B>JobTime</B> at the computer to which the job is submitted. In other words, setting this flag bit is equivalent to setting the corresponding day bit in the <B>DaysOfMonth</B> bitmask.</P>

<P>For job information retrieval (<A HREF="15ejnpp.htm"><B>NetScheduleJobEnum</B></A> and <A HREF="gq6vrx.htm"><B>NetScheduleJobGetInfo</B></A>), possible values are:</P>

<P>JOB_RUN_PERIODICALLY</P>

<P>This flag bit is equal to the original value of this flag bit when a job was submitted.</P>

<P>JOB_EXEC_ERROR</P>

<P>This flag bit is set whenever the Schedule service failed to execute successfully this job the last time this job was supposed to run.</P>

<P>JOB_RUNS_TODAY</P>

<P>This flag bit is set if <B>JobId</B> is larger than the current time of day at the computer at which this job is queued.</P>

<P><B>Command</B></P>

<P>Pointer to a Unicode string that contains the name of the command, batch program, or binary file to execute.</P>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="15ejnpp.htm"><B>NetScheduleJobEnum</B></A> </P>

</BODY>
</HTML>
