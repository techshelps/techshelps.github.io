<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Service Security</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="2bqkrbe"></A><B>Service Security</B></P>

<P>When a process uses the <A HREF="nbxjug.htm"><B>OpenSCManager</B></A> function to open a handle to a database of installed services, it can request different types of access. The system performs a security check before granting the requested access. All processes are permitted the following access to the database:</P>

<P>·SC_MANAGER_CONNECT </P>

<P>·SC_MANAGER_ENUMERATE_SERVICE </P>

<P>·SC_MANAGER_QUERY_LOCK_STATUS </P>

<P></P>

<P>This enables any process to open a handle to the SCManager object that it can use in calls to the <A HREF="20gsky6.htm"><B>OpenService</B></A>, <A HREF="y21_8w.htm"><B>EnumServicesStatus</B></A>, and <A HREF="dkgkou.htm"><B>QueryServiceLockStatus</B></A> functions. Only processes with Administrator privileges are able to open handles to the SCManager object that can be used by the <A HREF="2wng26.htm"><B>CreateService</B></A> and <A HREF="23k5hc.htm"><B>LockServiceDatabase</B></A> functions. </P>

<P>When a process uses the <B>OpenService</B> function, the system performs an access check. The type of access permitted to different users depends on the <A HREF="188mr8k.htm"><B>SECURITY_DESCRIPTOR</B></A> structure associated with the service object. The SCM creates a service object's security descriptor when the service is installed by the <B>CreateService</B> function. You can use the <A HREF="1f_vgrd.htm"><B>QueryServiceObjectSecurity</B></A> and <A HREF="e9.1kc.htm"><B>SetServiceObjectSecurity</B></A> functions to query and set the security descriptor of a service object. The default security descriptor of a service object permits the following access: </P>

<P>·All users have SERVICE_QUERY_CONFIG, SERVICE_QUERY_STATUS, SERVICE_ENUMERATE_DEPENDENTS, SERVICE_INTERROGATE, and SERVICE_USER_DEFINED_CONTROL access. </P>

<P>·Members of the Power Users group and the LocalSystem account have SERVICE_START, SERVICE_PAUSE_CONTINUE, and SERVICE_STOP access, plus the access rights granted to all users. </P>

<P>·Members of the Administrators and System Operators groups have SERVICE_ALL_ACCESS access. </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
