<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>OpenProcess</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="9mlgut"></A><B>OpenProcess  <A HREF="b3ugni.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="glns2h.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="7wnz9r.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>OpenProcess</B> function returns a handle of an existing process object. </P>

<P><B>HANDLE OpenProcess(</B></P>

<TABLE cols=2 width=399>

<TR VALIGN="top">
<TD width=54%><B>DWORD</B> <I>dwDesiredAccess</I><B>,</B></TD>
<TD width=46%>// access flag </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><B>    BOOL</B> <I>bInheritHandle</I><B>,</B></TD>
<TD width=46%>// handle inheritance flag </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><B>    DWORD</B> <I>dwProcessId</I> </TD>
<TD width=46%>// process identifier </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><B>   );</B></TD>
<TD width=46%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>dwDesiredAccess</I></P>

<P>Specifies the access to the process object. For operating systems that support security checking, this access is checked against any security descriptor for the target process. Any combination of the following access flags can be specified in addition to the STANDARD_RIGHTS_REQUIRED access flags: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=53%><B>Access</B></TD>
<TD width=47%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=53%>PROCESS_ALL_ACCESS</TD>
<TD width=47%>Specifies all possible access flags for the process object.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>PROCESS_CREATE_PROCESS</TD>
<TD width=47%>Used internally.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>PROCESS_CREATE_THREAD</TD>
<TD width=47%>Enables using the process handle in the <A HREF="19iu6kt.htm"><B>CreateRemoteThread</B></A> function to create a thread in the process.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>PROCESS_DUP_HANDLE</TD>
<TD width=47%>Enables using the process handle as either the source or target process in the <A HREF="1ojqkwy.htm"><B>DuplicateHandle</B></A> function to duplicate a handle.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>PROCESS_QUERY_INFORMATION</TD>
<TD width=47%>Enables using the process handle in the <A HREF="2mm.i..htm"><B>GetExitCodeProcess</B></A> and <A HREF="f6uwf_.htm"><B>GetPriorityClass</B></A> functions to read information from the process object.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>PROCESS_SET_INFORMATION</TD>
<TD width=47%>Enables using the process handle in the <A HREF="1hdphk3.htm"><B>SetPriorityClass</B></A> function to set the priority class of the process.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>PROCESS_TERMINATE</TD>
<TD width=47%>Enables using the process handle in the <A HREF=".d3m14.htm"><B>TerminateProcess</B></A> function to terminate the process.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>PROCESS_VM_OPERATION</TD>
<TD width=47%>Enables using the process handle in the <A HREF="sflvdy.htm"><B>VirtualProtectEx</B></A> and <A HREF="_4c4hp.htm"><B>WriteProcessMemory</B></A> functions to modify the virtual memory of the process.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>PROCESS_VM_READ</TD>
<TD width=47%>Enables using the process handle in the <A HREF="2rlm_kf.htm"><B>ReadProcessMemory</B></A> function to read from the virtual memory of the process.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>PROCESS_VM_WRITE</TD>
<TD width=47%>Enables using the process handle in the <A HREF="_4c4hp.htm"><B>WriteProcessMemory</B></A> function to write to the virtual memory of the process.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>SYNCHRONIZE</TD>
<TD width=47%><B>Windows NT only:</B> Enables using the process handle in any of the <A HREF="y2tc_3.htm">wait functions</A> to wait for the process to terminate.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>bInheritHandle</I></P>

<P>Specifies whether the returned handle can be inherited by a new process created by the current process. If TRUE, the handle is inheritable. </P>

<P><I>dwProcessId</I></P>

<P>Specifies the process identifier of the process to open. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is an open handle of the specified process.</P>

<P>If the function fails, the return value is NULL. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>The handle returned by the <B>OpenProcess</B> function can be used in any function that requires a handle to a process, such as the <A HREF="y2tc_3.htm">wait functions</A>, provided the appropriate access rights were requested. </P>

<P>When you are finished with the handle, be sure to close it using the <B>CloseHandle</B> function.</P>

<P><B>See Also</B></P>

<P><A HREF="ngwwie.htm"><B>CloseHandle</B></A>, <A HREF="5fbj_xx.htm"><B>CreateProcess</B></A>, <A HREF="19iu6kt.htm"><B>CreateRemoteThread</B></A>, <A HREF="1ojqkwy.htm"><B>DuplicateHandle</B></A>, <A HREF="jiu.65.htm"><B>GetCurrentProcess</B></A>, <A HREF="1ogbyvz.htm"><B>GetCurrentProcessId</B></A>, <A HREF="2mm.i..htm"><B>GetExitCodeProcess</B></A>, <A HREF="f6uwf_.htm"><B>GetPriorityClass</B></A>, <A HREF="2rlm_kf.htm"><B>ReadProcessMemory</B></A>, <A HREF="1hdphk3.htm"><B>SetPriorityClass</B></A>, <A HREF=".d3m14.htm"><B>TerminateProcess</B></A>, <A HREF="sflvdy.htm"><B>VirtualProtectEx</B></A>, <A HREF="_4c4hp.htm"><B>WriteProcessMemory</B></A> </P>

</BODY>
</HTML>
