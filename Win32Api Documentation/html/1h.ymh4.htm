<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>UI Negotiation (Menu, Toolbar, and Status Bar)</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1h.ymh4"></A><B>UI Negotiation (Menu, Toolbar, and Status Bar)</B></P>

<P>The mechanism to determine which items will appear in the view window while the contents are visible is similar to OLE in-place activation but notable differences do exist. Three of them are discussed here.</P>

<P>First, the view window always exists even though it does not have the input focus. Therefore, it should maintain three states:</P>

<P>·Deactivated</P>

<P>·Activated with the focus</P>

<P>·Activated without the focus</P>

<P></P>

<P>The view window may present different sets of menu items depending on the focus state. The Explorer notifies the state changes by calling <A HREF="04695_.htm"><B>IShellView::UIActivate</B></A>. The view object should call <B>IShellBrowser::OnViewWindowActivate</B> when the view window is activated by the user.</P>

<P>Second, the Explorer does not support layout negotiation. Instead, it allows the view window to add toolbar buttons or set status bar texts. The view window may create modeless popups. The view object may call <B>IShellBrowser::GetControlWindow</B> or <B>IShellBrowser::SendControlMsg</B> to control them. The Explorer forwards appropriate notification messages from those controls using <B>IShellView::ForwardControlMsg</B>.</P>

<P>Third, the Explorer allows the view window to add menu items to the Explorer's pull-down menus (in addition to inserting top-level pull-down menus). In other words, the view object is allowed to insert menu items to submenus returned from <B>IShellBrowser::InsertMenus</B>. To let the Explorer dispatch menu messages correctly, a certain range of menu item IDs (between SHVIEW_FIRST and SHVIEW_LAST) must be used.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
