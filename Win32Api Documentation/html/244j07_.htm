<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>RASCONNSTATE</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="244j07_"></A><B>RASCONNSTATE  <A HREF="2cq8b6.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="35kj_0r.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="kf1wk..htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>RASCONNSTATE</B> enumeration type contains values that specify the states that may occur during a RAS connection operation. If you use the <A HREF="1zuv.va.htm"><B>RasDial</B></A> function to establish a RAS connection, you can specify a window, or a <A HREF="0arw_f.htm"><B>RasDialFunc</B></A>, <A HREF="2xbtbfx.htm"><B>RasDialFunc1</B></A>, or <A HREF="2xbtbfy.htm"><B>RasDialFunc2</B></A> callback function to receive notification messages that report the current connection state. You can also use the <A HREF="11ewq3o.htm"><B>RasGetConnectStatus</B></A> function to get the connection state for a specified connection.</P>

<P>typedef enum _RASCONNSTATE {  </P>

<P>RASCS_OpenPort = 0, </P>

<P>RASCS_PortOpened, </P>

<P>RASCS_ConnectDevice, </P>

<P>RASCS_DeviceConnected, </P>

<P>RASCS_AllDevicesConnected, </P>

<P>RASCS_Authenticate, </P>

<P>RASCS_AuthNotify, </P>

<P>RASCS_AuthRetry, </P>

<P>RASCS_AuthCallback, </P>

<P>RASCS_AuthChangePassword, </P>

<P>RASCS_AuthProject, </P>

<P>RASCS_AuthLinkSpeed, </P>

<P>RASCS_AuthAck, </P>

<P>RASCS_ReAuthenticate, </P>

<P>RASCS_Authenticated, </P>

<P>RASCS_PrepareForCallback, </P>

<P>RASCS_WaitForModemReset, </P>

<P>RASCS_WaitForCallback,<BR>
    RASCS_Projected, </P>

<P></P>

<P>#if (WINVER &gt;= 0x400) </P>

<P>RASCS_StartAuthentication,    // Windows 95 only </P>

<P>RASCS_CallbackComplete,       // Windows 95 only </P>

<P>RASCS_LogonNetwork,           // Windows 95 only </P>

<P>#endif </P>

<P>RASCS_SubEntryConnected,</P>

<P>RASCS_SubEntryDisconnected,</P>

<P></P>

<P>RASCS_Interactive = RASCS_PAUSED, </P>

<P>RASCS_RetryAuthentication, </P>

<P>RASCS_CallbackSetByCaller, </P>

<P>RASCS_PasswordExpired, </P>

<P></P>

<P>RASCS_Connected = RASCS_DONE, </P>

<P>RASCS_Disconnected </P>

<P>} RASCONNSTATE ; </P>

<P></P>

<P>The enumerator values are listed here in the general order in which the connection states occur. However, you should not write code that depends on the order or occurrence of particular <B>RASCONNSTATE</B> connection states, because this may vary between platforms.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=42%><B>Enumerator</B></TD>
<TD width=58%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_OpenPort</B></TD>
<TD width=58%>The communication port is about to be opened.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_PortOpened</B></TD>
<TD width=58%>The communication port has been opened successfully.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_ConnectDevice</B></TD>
<TD width=58%>A device is about to be connected. <B>RasGetConnectStatus</B> can be called to determine the name and type of the device being connected.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_DeviceConnected</B></TD>
<TD width=58%>A device has connected successfully. <B>RasGetConnectStatus</B> can be called to determine the name and type of the device being connected.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>&nbsp;</TD>
<TD width=58%>For a simple modem connection, <B>RASCS_ConnectDevice</B> and <B>RASCS_DeviceConnected</B> will be called only once. For a dial-up X.25 PAD connection, the pair will be called first for the modem, then for the PAD. If a preconnect switch is configured, the pair will be called for the switch before any other devices connect. Likewise, the pair will be called for a postconnect switch after any other devices connect.
<P><B>Windows 95:</B> Note that Windows 95 does not currently support multistage connections such as the X.25 PAD connection described earlier.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_AllDevicesConnected</B></TD>
<TD width=58%>All devices in the device chain have successfully connected. At this point, the physical link is established.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_Authenticate</B></TD>
<TD width=58%>The authentication process is starting. Remote access does not allow the remote client to generate any traffic on the LAN until authentication has been successfully completed. 
<P>Remote access authentication on a Windows NT or Windows 95 server consists of:</P>

<P>·Validating the user name/ password on the specified domain. </P>

<P>·Projecting the client onto the LAN. This means that the remote access server does what is necessary to send and receive data on the LAN on behalf of the client. For example, the remote access server might need to add a NetBIOS name that corresponds to the client's computer name. </P>

<P>·Call-back processing in which the client hangs up and the server calls back. (The user needs special permissions on the remote access server for this.) </P>

<P>·Calculating the link speed. This is necessary to correctly set transport time-outs to match the relatively slow speed of the remote link. </P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_AuthNotify</B></TD>
<TD width=58%>An authentication event has occurred. If <I>dwError</I> is zero, this event will be immediately followed by one of the more specific authentication states following. If <I>dwError</I> is nonzero, authentication has failed, and the error value indicates why.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_AuthRetry</B></TD>
<TD width=58%>The client has requested another validation attempt with a new user name/password/domain. This state does not occur in Windows NT version 3.1.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_AuthCallback</B></TD>
<TD width=58%>The remote access server has requested a callback number. This occurs only if the user has "Set By Caller" callback privilege on the server.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_AuthChangePassword</B></TD>
<TD width=58%>The client has requested to change the password on the account. This state does not occur in Windows NT version 3.1.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_AuthProject</B></TD>
<TD width=58%>The projection phase is starting.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_AuthLinkSpeed</B></TD>
<TD width=58%>The link-speed calculation phase is starting.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_AuthAck</B></TD>
<TD width=58%>An authentication request is being acknowledged.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_ReAuthenticate</B></TD>
<TD width=58%>Reauthentication (after callback) is starting.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_Authenticated</B></TD>
<TD width=58%>The client has successfully completed authentication.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_PrepareForCallback</B></TD>
<TD width=58%>The line is about to disconnect in preparation for callback.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_WaitForModemReset</B></TD>
<TD width=58%>The client is delaying in order to give the modem time to reset itself in preparation for callback.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_WaitForCallback</B></TD>
<TD width=58%>The client is waiting for an incoming call from the remote access server.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_Projected</B></TD>
<TD width=58%>This state occurs after the RASCS_AuthProject state. It indicates that projection result information is available. You can access the projection result information by calling <A HREF="1xevgyp.htm"><B>RasGetProjectionInfo</B></A>.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_StartAuthentication</B></TD>
<TD width=58%><B>Windows 95 only:</B> Indicates that user authentication is being initiated or retried.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_CallbackComplete</B></TD>
<TD width=58%><B>Windows 95 only:</B> Indicates that the client has been called back and is about to resume authentication.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_LogonNetwork</B></TD>
<TD width=58%><B>Windows 95 only:</B> Indicates that the client is logging on to the network.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_SubEntryConnected</B></TD>
<TD width=58%>When dialing a multilink phone-book entry, this state indicates that a subentry has been connected during the dialing process. The <I>dwSubEntry</I> parameter of a <B>RasDialFunc2</B> callback function indicates the index of the subentry. When the final state of all subentries in the phone-book entry has been determined, the connection state is <B>RASCS_Connected</B> if one or more subentries have been connected successfully.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_SubEntryDisconnected</B></TD>
<TD width=58%>When dialing a multilink phone-book entry, this state indicates that a subentry has been disconnected during the dialing process. The <I>dwSubEntry</I> parameter of a <B>RasDialFunc2</B> callback function indicates the index of the subentry. </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_Interactive</B></TD>
<TD width=58%>This state corresponds to the terminal state supported by RASPHONE.EXE. This state does not occur in Windows NT version 3.1.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_RetryAuthentication</B></TD>
<TD width=58%>This state corresponds to the retry authentication state supported by RASPHONE.EXE. This state does not occur in Windows NT version 3.1.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_CallbackSetByCaller</B></TD>
<TD width=58%>This state corresponds to the callback state supported by RASPHONE.EXE. This state does not occur in Windows NT version 3.1.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_PasswordExpired</B></TD>
<TD width=58%>This state corresponds to the change password state supported by RASPHONE.EXE. This state does not occur in Windows NT version 3.1.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_Connected</B></TD>
<TD width=58%>Successful connection.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>RASCS_Disconnected</B></TD>
<TD width=58%>Disconnection or failed connection.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>The connection process states are divided into three classes: running states, paused states, and terminal states. </P>

<P>An application can easily determine the class of a specific state by performing Boolean bit operations with the RASCS_PAUSED and RASCS_DONE bitmasks. Here are some examples: </P>

<P>fDoneState = (state &amp; RASCS_DONE);  </P>

<P>fPausedState = (state &amp; RASCS_PAUSED); </P>

<P>fRunState = !(fDoneState || fPausedState); </P>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="1zuv.va.htm"><B>RasDial</B></A>, <A HREF="11ewq3o.htm"><B>RasGetConnectStatus</B></A>, <A HREF="1xevgyp.htm"><B>RasGetProjectionInfo</B></A>, <A HREF="5akh3_.htm"><B>RASCONNSTATUS</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
