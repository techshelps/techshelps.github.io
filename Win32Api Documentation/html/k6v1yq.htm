<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Escape</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="k6v1yq"></A><B>Escape  <IMG SRC="../images/bm1.gif" ALT="" BORDER=0>  <A HREF="joiq6.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="yhp8x..htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>Escape</B> function allows applications to access capabilities of a particular device not directly available through GDI. Escape calls made by an application are translated and sent to the driver. </P>

<P><B>int Escape(</B></P>

<TABLE cols=2 width=418>

<TR VALIGN="top">
<TD width=41%><B>HDC</B> <I>hdc</I><B>,</B></TD>
<TD width=59%>// handle to device context </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    int</B> <I>nEscape</I><B>,</B></TD>
<TD width=59%>// escape function </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    int</B> <I>cbInput</I><B>,</B></TD>
<TD width=59%>// number of bytes in input structure </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    LPCSTR</B> <I>lpvInData</I><B>,</B></TD>
<TD width=59%>// pointer to input structure </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    LPVOID</B> <I>lpvOutData</I> </TD>
<TD width=59%>// pointer to output structure </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>   );</B></TD>
<TD width=59%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hdc</I></P>

<P>Identifies the device context. </P>

<P><I>nEscape</I></P>

<P>Specifies the escape function to be performed. This parameter must be one of the predefined escape values. Use the <A HREF="11kppe_.htm"><B>ExtEscape</B></A> function if your application defines a private escape value. </P>

<P><I>cbInput</I></P>

<P>Specifies the number of bytes of data pointed to by the <I>lpvInData</I> parameter. </P>

<P><I>lpvInData</I></P>

<P>Points to the input structure required for the specified escape. </P>

<P><I>lpvOutData</I></P>

<P>Points to the structure that receives output from this escape. This parameter should be NULL if no data is returned. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is greater than zero, except with the QUERYESCSUPPORT printer escape, which checks for implementation only. If the escape is not implemented, the return value is zero. </P>

<P>If the function fails, the return value is an error. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Errors</B></P>

<P>If the function fails, the return value is one of the following values. </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=32%><B>Value</B></TD>
<TD width=68%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=32%>SP_ERROR</TD>
<TD width=68%>General error. If SP_ERROR is returned, <B>Escape </B>may set the last error code to:
<P>ERROR_INVALID_PARAMETER<BR>
ERROR_DISK_FULL<BR>
ERROR_NOT_ENOUGH_MEMORY<BR>
ERROR_PRINT_CANCELLED</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=32%>SP_OUTOFDISK</TD>
<TD width=68%>Not enough disk space is currently available for spooling, and no more space will become available.</TD>
</TR>

<TR VALIGN="top">
<TD width=32%>SP_OUTOFMEMORY</TD>
<TD width=68%>Not enough memory is available for spooling.</TD>
</TR>

<TR VALIGN="top">
<TD width=32%>SP_USERABORT</TD>
<TD width=68%>The user terminated the job through Windows Print Manager.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>The Win32 API provides six new functions that supersede some printer escapes: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=22%><B>Function</B></TD>
<TD width=78%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=22%><A HREF="2jkztwm.htm"><B>AbortDoc</B></A></TD>
<TD width=78%>Terminates a print job. Supersedes the ABORTDOC escape.</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><A HREF="1phx_3y.htm"><B>EndDoc</B></A></TD>
<TD width=78%>Ends a print job. Supersedes the ENDDOC escape.</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><A HREF="6zjxo8.htm"><B>EndPage</B></A></TD>
<TD width=78%>Ends a page. Supersedes the NEWFRAME escape. Unlike NEWFRAME, this function is always called after printing a page.</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><A HREF="hcn8b4.htm"><B>SetAbortProc</B></A></TD>
<TD width=78%>Sets the abort function for a print job. Supersedes the SETABORTPROC escape.</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><A HREF="231v06s.htm"><B>StartDoc</B></A></TD>
<TD width=78%>Starts a print job. Supersedes the STARTDOC escape.</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><A HREF="1jz9np.htm"><B>StartPage</B></A></TD>
<TD width=78%>Prepares printer driver to receive data.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>The Win32 API provides six new indexes for the <B>GetDeviceCaps</B> function that supersede some printer escapes: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%><B>Index</B></TD>
<TD width=67%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=33%>PHYSICALWIDTH</TD>
<TD width=67%>For printing devices: the width of the physical page, in device units. For example, a printer set to print at 600 dpi on 8.5"x11" paper has a physical width value of 5100 device units. Note that the physical page is almost always greater than the printable area of the page, and never smaller. </TD>
</TR>

<TR VALIGN="top">
<TD width=33%>PHYSICALHEIGHT</TD>
<TD width=67%>For printing devices: the height of the physical page, in device units. For example, a printer set to print at 600 dpi on 8.5"x11" paper has a physical height value of 6600 device units. Note that the physical page is almost always greater than the printable area of the page, and never smaller.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>PHYSICALOFFSETX</TD>
<TD width=67%>For printing devices: the distance  from the left edge of the physical page to the left edge of the printable area, in device units. For example, a printer set to print at 600 dpi on 8.5"x11" paper, that cannot print on the leftmost 0.25" of paper, has a horizontal physical offset of 150 device  units.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>PHYSICALOFFSETY</TD>
<TD width=67%>For printing devices: the distance from the top edge of the physical page to the top edge of the printable area, in device units. For example, a printer set to print at 600 dpi on 8.5"x11" paper, that cannot print on the topmost 0.5" of paper, has a vertical physical offset of 300 device units.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>Of the original printer escapes, only the following can be used by Win32-based application:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=35%><B>Escape</B></TD>
<TD width=65%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=35%>QUERYYESCSUPPORT</TD>
<TD width=65%>Determines whether a particular escape is implemented by the device driver.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>Following is a list of the obsolete printer escapes that are supported only for compatibility with 16-bit versions of Windows: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%><B>Escape</B></TD>
<TD width=67%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ABORTDOC</TD>
<TD width=67%>Stops the current print job and erases everything the application has written to the device since the last ENDDOC escape.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ENDDOC</TD>
<TD width=67%>Ends a print job started by the STARTDOC escape.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>GETPHYSPAGESIZE</TD>
<TD width=67%>Retrieves the physical page size and copies it to the specified location.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>GETPRINTINGOFFSET</TD>
<TD width=67%>Retrieves the offset from the upper-left corner of the physical page where the actual printing or drawing begins.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>GETSCALINGFACTOR</TD>
<TD width=67%>Retrieves the scaling factors for the x-axis and the y-axis of a printer.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>NEWFRAME</TD>
<TD width=67%>Informs the printer that the application has finished writing to a page.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>NEXTBAND</TD>
<TD width=67%>Informs the printer that the application has finished writing to a band.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>PASSTHROUGH</TD>
<TD width=67%>Allows the application to send data directly to a printer.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>SETABORTPROC</TD>
<TD width=67%>Sets the Abort function for a print job.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>STARTDOC</TD>
<TD width=67%>Informs a printer driver that a new print job is starting.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="2jkztwm.htm"><B>AbortDoc</B></A>, <A HREF="1phx_3y.htm"><B>EndDoc</B></A>, <A HREF="6zjxo8.htm"><B>EndPage</B></A>, <A HREF="11kppe_.htm"><B>ExtEscape</B></A>, <A HREF="hcn8b4.htm"><B>SetAbortProc</B></A>, <A HREF="231v06s.htm"><B>StartDoc</B></A>, <A HREF="1jz9np.htm"><B>StartPage</B></A>, <A HREF="1alkhas.htm"><B>ResetDC</B></A> </P>

</BODY>
</HTML>
