<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Subclassing a Window</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="3.yl_h5"></A><B>Subclassing a Window</B></P>

<P>To subclass an instance of a window, call the <A HREF="d2okir.htm"><B>SetWindowLong</B></A> function and specify the handle of the window to subclass the GWL_WNDPROC flag and a pointer to the subclass procedure. <B>SetWindowLong</B> returns a pointer to the original window procedure; use this pointer to pass messages to the original procedure. The subclass window procedure must use the <A HREF="ncd2vj.htm"><B>CallWindowProc</B></A> function to call the original window procedure. </P>

<P>The following example shows how to subclass an instance of an edit control in a dialog box. The subclass window procedure enables the edit control to receive all keyboard input, including the ENTER and TAB keys, whenever the control has the input focus. </P>

<P>WNDPROC wpOrigEditProc;  </P>

<P></P>

<P>LRESULT APIENTRY EditBoxProc(</P>

<P>HWND hwndDlg, </P>

<P>UINT uMsg, </P>

<P>WPARAM wParam, </P>

<P>LPARAM lParam) </P>

<P>{ </P>

<P>HWND hwndEdit; </P>

<P></P>

<P>switch(uMsg) </P>

<P>{ </P>

<P>case WM_INITDIALOG: </P>

<P>// Retrieve the handle of the edit control. </P>

<P>hwndEdit = GetDlgItem(hwndDlg, ID_EDIT); </P>

<P></P>

<P>// Subclass the edit control. </P>

<P>wpOrigEditProc = (WNDPROC) SetWindowLong(hwndEdit, </P>

<P>GWL_WNDPROC, (LONG) EditSubclassProc); </P>

<P>// </P>

<P>// Continue the initialization procedure. </P>

<P>// </P>

<P>return TRUE; </P>

<P></P>

<P>case WM_DESTROY: </P>

<P>// Remove the subclass from the edit control. </P>

<P>SetWindowLong(hwndEdit, GWL_WNDPROC, </P>

<P>(LONG) wpOrigEditProc); </P>

<P>// </P>

<P>// Continue the cleanup procedure. </P>

<P>// </P>

<P>break; </P>

<P>} </P>

<P>return FALSE; </P>

<P>UNREFERENCED_PARAMETER(lParam); </P>

<P>} </P>

<P></P>

<P>// Subclass procedure </P>

<P>LRESULT APIENTRY EditSubclassProc(</P>

<P>HWND hwnd, </P>

<P>UINT uMsg, </P>

<P>WPARAM wParam, </P>

<P>LPARAM lParam) </P>

<P>{ </P>

<P>if (uMsg == WM_GETDLGCODE) </P>

<P>return DLGC_WANTALLKEYS; </P>

<P></P>

<P>return CallWindowProc(wpOrigEditProc, hwnd, uMsg, </P>

<P>wParam, lParam); </P>

<P>} </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
