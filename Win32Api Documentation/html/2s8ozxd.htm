<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ImageList_LoadImage</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="2s8ozxd"></A><B>ImageList_LoadImage  <A HREF="1kbk6yl.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="mk1vkp.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="4vbh.wp.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>ImageList_LoadImage</B> function creates an image list from the specified bitmap, cursor, or icon resource.</P>

<P><B>HIMAGELIST ImageList_LoadImage(</B></P>

<TABLE cols=2 width=214>

<TR VALIGN="top">
<TD width=84%><B>HINSTANCE</B> <I>hi</I><B>,</B> </TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=84%><B>    LPCSTR</B> <I>lpbmp</I><B>, </B></TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=84%><B>    int</B> <I>cx</I><B>, </B></TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=84%><B>    int</B> <I>cGrow</I><B>, </B></TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=84%><B>    COLORREF</B> <I>crMask</I><B>, </B></TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=84%><B>    UINT</B> <I>uType</I><B>, </B></TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=84%><B>    UINT</B> <I>uFlags</I></TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=84%><B>   );</B></TD>
<TD width=16%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hi</I> </P>

<P>Handle to the instance that contains the resource. </P>

<P>If the <I>hi</I> parameter is zero, the low-order word of this parameter must be the identifier of the OEM image to load. The OEM image identifiers are defined in WINUSER.H. Following are the identifier prefixes and their meanings:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=16%><B>Prefix</B></TD>
<TD width=84%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=16%>OBM_</TD>
<TD width=84%>OEM bitmaps</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>OIC_</TD>
<TD width=84%>OEM icons</TD>
</TR>

<TR VALIGN="top">
<TD width=16%>OCR_</TD>
<TD width=84%>OEM cursors</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lpbmsp</I></P>

<P>Pointer to a null-terminated string that contains the name of the image to load. </P>

<P>If the <I>uFlags</I> parameter specifies the LR_LOADFROMFILE value, the <I>lpbmp</I> parameter must be the name of the file that contains the image. </P>

<P><I>cx</I></P>

<P>Width of each image. The height of each image and the initial number of images are inferred by the dimensions of the specified resource.</P>

<P><I>cGrow</I></P>

<P>Amount of images by which the image list can grow when the system needs to resize the list to make room for new images. This parameter represents the number of new images that the resized image list can contain.</P>

<P><I>crMask</I></P>

<P>Color used to generate a mask. Each pixel of this color in the specified bitmap, cursor, or icon is changed to black, and the corresponding bit in the mask is set to 1. If this parameter is the CLR_NONE value, no mask is generated.</P>

<P><I>uType</I></P>

<P>Flag that specifies the type of image to load. This parameter can be one of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=29%><B>Value</B></TD>
<TD width=71%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=29%>IMAGE_BITMAP</TD>
<TD width=71%>Loads a bitmap.</TD>
</TR>

<TR VALIGN="top">
<TD width=29%>IMAGE_CURSOR</TD>
<TD width=71%>Loads a cursor.</TD>
</TR>

<TR VALIGN="top">
<TD width=29%>IMAsssGE_ICON</TD>
<TD width=71%>Loads an icon.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>uFlags</I></P>

<P>Flags that specify how to load the image. This parameter can be a combination of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=41%><B>Value</B></TD>
<TD width=59%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=41%>LR_DEFAULTCOLOR</TD>
<TD width=59%>Uses the color format of the display.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>LR_LOADDEFAULTSIZE</TD>
<TD width=59%>Uses the width or height specified by the system metric values for cursors and icons if the <I>cx </I>parameter is set to zero. If this value is not specified and <I>cx</I> is set to zero, the function sets the size to that specified in the resource. If the resource contains multiple images, the function sets the size to that of the first image. </TD>
</TR>

<TR VALIGN="top">
<TD width=41%>LR_LOADFROMFILE</TD>
<TD width=59%>Loads the image from the file specified by the <I>lpbmp</I> parameter.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>LR_LOADMAP3DCOLORS</TD>
<TD width=59%>Searches the color table for the image and replaces the following shades of gray with the corresponding three-dimensional color:</TD>
</TR>
</TABLE><BR>

<P></P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=45%>Dk Gray,<BR>
<A HREF="959q0ee.htm">RGB</A>(128, 128, 128)</TD>
<TD width=55%>COLOR_3DSHADOW</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>Gray, <BR>
RGB(192, 192, 192)</TD>
<TD width=55%>COLOR_3DFACE</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>Lt Gray, <BR>
<A HREF="959q0ee.htm">RGB</A>(223, 223, 223)</TD>
<TD width=55%>COLOR_3DLIGHT</TD>
</TR>
</TABLE><BR>

<P></P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=39%>LR_LOADTRANSPARENT</TD>
<TD width=61%>Retrieves the color value of the first pixel in the image and replaces the corresponding entry in the color table with the default window color (the COLOR_WINDOW display color). All pixels in the image that use that entry become the default window value color. This value applies only to images that have corresponding color tables. </TD>
</TR>

<TR VALIGN="top">
<TD width=39%>LR_MONOCHROME</TD>
<TD width=61%>Loads the image in black and white.</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>LR_SHARED</TD>
<TD width=61%>Shares the image handle if the image is loaded multiple times. Do not use this value for images that have nontraditional sizes that might change after loading or for images that are loaded from a file. </TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is the handle of the image list.</P>

<P>If the function fails, the return value is NULL.</P>

<P><B>See Also</B></P>

<P><A HREF="959q0ee.htm">RGB</A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
