<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Drag and Drop Operations</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1on2_gf"></A><B>Drag and Drop Operations</B></P>

<P>A tree-view control notifies the parent window when the user starts to drag an item. The parent window receives a <A HREF="2mlkc5e.htm">TVN_BEGINDRAG</A> notification message when the user begins dragging an item with the left mouse button and a <A HREF="1fn._21.htm">TVN_BEGINRDRAG</A> notification message when the user begins dragging with the right button. You can prevent a tree-view control from sending these notifications by giving the tree-view control the TVS_DISABLEDRAGDROP style. </P>

<P>You obtain an image to display during a drag operation by using the <A HREF="ltyrp_.htm">TVM_CREATEDRAGIMAGE</A> message. The tree-view control creates a dragging bitmap based on the label of the item being dragged. Then the tree-view control creates an image list, adds the bitmap to it, and returns the handle of the image list. </P>

<P>You must provide the code that actually drags the item. This typically involves using the dragging capabilities of the image list functions and processing the <A HREF="1mq_iq2.htm">WM_MOUSEMOVE</A> and <A HREF="yl9yek.htm">WM_LBUTTONUP</A> (or <A HREF="15.j.k4.htm">WM_RBUTTONUP</A>) messages sent to the parent window after the drag operation has begun. For more information about the image list functions, see <A HREF="mk1vkp.htm">Image Lists</A>. For more information about dragging a tree-view item, see <A HREF="61dx.nd.htm">Dragging a Tree-View Item</A>.</P>

<P>If items in a tree-view control are to be the targets of a drag and drop operation, you need to know when the mouse cursor is on a target item. You can find out by using the <A HREF="fz0c2e.htm">TVM_HITTEST</A> message. You specify the address of a <A HREF="1676x_p.htm"><B>TV_HITTESTINFO</B></A> structure that contains the current coordinates of the mouse cursor. When the <A HREF="1724msn.htm"><B>SendMessage</B></A> function returns, the structure contains a flag indicating the location of the mouse cursor relative to the tree-view control. If the cursor is over an item in the tree-view control, the structure contains the handle of the item as well.</P>

<P>You can indicate that an item is the target of a drag and drop operation by using the <A HREF="10orxhp.htm">TVM_SETITEM</A> message to set the state to the TVIS_DROPHILITED value. An item that has this state is drawn in the style used to indicate a drag and drop target.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
