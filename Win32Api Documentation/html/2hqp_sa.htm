<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Creating a Keyboard Interface for a Standard Scroll Bar</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="2hqp_sa"></A><B>Creating a Keyboard Interface for a Standard Scroll Bar</B></P>

<P>Although a scroll bar control provides a built-in keyboard interface, a standard scroll bar does not. To implement a keyboard interface for a standard scroll bar, a window procedure must process the <A HREF="cxjo_p.htm">WM_KEYDOWN</A> message and examine the virtual-key code specified by the <I>wParam</I> parameter. If the virtual-key code corresponds to an arrow key, the window procedure sends itself a <A HREF="e_2m08.htm">WM_HSCROLL</A> or <A HREF="1i8puw5.htm">WM_VSCROLL</A> message with the low-order word of the <I>wParam</I> parameter set to the appropriate scroll bar notification message. For example, when the user presses the UP arrow key, the window procedure receives a WM_KEYDOWN message with <I>wParam</I> equal to VK_UP. In response, the window procedure sends itself a WM_VSCROLL message with the low-order word of <I>wParam</I> set to the SB_LINEUP notification message. </P>

<P>The following example shows how to include a keyboard interface for a standard scroll bar. </P>

<P>WORD wScrollNotify = 0xFFFF;  </P>

<P></P>

<P>. </P>

<P>. </P>

<P>. </P>

<P></P>

<P>case WM_KEYDOWN: </P>

<P>switch (wParam) { </P>

<P>case VK_UP: </P>

<P>wScrollNotify = SB_LINEUP; </P>

<P>break; </P>

<P></P>

<P>case VK_PRIOR: </P>

<P>wScrollNotify = SB_PAGEUP; </P>

<P>break; </P>

<P></P>

<P>case VK_NEXT: </P>

<P>wScrollNotify = SB_PAGEDOWN; </P>

<P>break; </P>

<P></P>

<P>case VK_DOWN: </P>

<P>wScrollNotify = SB_LINEDOWN; </P>

<P>break; </P>

<P></P>

<P>case VK_HOME: </P>

<P>wScrollNotify = SB_TOP; </P>

<P>break; </P>

<P></P>

<P>case VK_END: </P>

<P>wScrollNotify = SB_BOTTOM; </P>

<P>break; </P>

<P>} </P>

<P></P>

<P>if (wScrollNotify != -1) </P>

<P>SendMessage(hwnd, WM_VSCROLL, </P>

<P>MAKELONG(wScrollNotify, 0), 0L); </P>

<P></P>

<P>break; </P>

<P>. </P>

<P>. </P>

<P>. </P>

<P></P>

</BODY>
</HTML>
