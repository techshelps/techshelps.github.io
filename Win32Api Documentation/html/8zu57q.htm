<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>FILEOKSTRING</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="8zu57q"></A><B>FILEOKSTRING  <A HREF="1ofmk4n.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="y3i0nj.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1lhvm4l.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>An Open or Save As dialog box sends the FILEOKSTRING registered message to your hook procedure when the user specifies a filename and clicks the OK button. The hook procedure can accept the filename and allow the dialog box to close, or reject the filename and force the dialog box to remain open. </P>

<P>For Explorer-style Open and Save As dialog boxes, this message has been superseded by the <A HREF="yh4i0e.htm">CDN_FILEOK</A> notification message.</P>

<P>MessageID = RegisterWindowMessage(FILEOKSTRING);<BR>
wParam = 0;<BR>
lpofn = (LPOPENFILENAME) lParam;<BR>
  </P>

<P><B>Parameters</B></P>

<P><I>lpofn</I></P>

<P>Pointer to an <A HREF="2wivnae.htm"><B>OPENFILENAME</B></A> structure. The <B>lpstrFile</B> member of this structure contains the drive, path, and filename specified by the user.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the hook procedure returns zero, the Open or Save As dialog box accepts the specified filename and closes.</P>

<P>If the hook procedure returns a nonzero value, the Open or Save As dialog box rejects the specified filename and remains open.</P>

<P><B>Remarks</B></P>

<P>The hook procedure must specify the FILEOKSTRING constant in a call to the <B>RegisterWindowMessage</B> function to get the identifier for the message sent by the dialog box.</P>

<P><B>See Also</B></P>

<P><A HREF="yh4i0e.htm">CDN_FILEOK</A>, <A HREF="2wivnae.htm"><B>OPENFILENAME</B></A>, <A HREF="xkgsv4.htm"><B>RegisterWindowMessage</B></A> </P>

</BODY>
</HTML>
