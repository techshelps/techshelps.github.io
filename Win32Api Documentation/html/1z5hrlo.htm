<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Adding a Window Property</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1z5hrlo"></A><B>Adding a Window Property</B></P>

<P>The following example loads an icon and then a cursor and allocates memory for a buffer. The example then uses the <A HREF="1odjg5p.htm"><B>SetProp</B></A> function to assign the resulting icon, cursor, and memory handles as window properties for the window identified by the application-defined hwndSubclass variable. The properties are identified by the strings PROP_ICON, PROP_CURSOR, and PROP_BUFFER. </P>

<P>#define BUFFER 4096  </P>

<P></P>

<P>HINSTANCE hinst;       // handle of current instance </P>

<P>HWND hwndSubclass;     // handle of a subclassed window </P>

<P>HANDLE hIcon, hCursor; </P>

<P>HGLOBAL hMem; </P>

<P>char *lpMem; </P>

<P>TCHAR tchPath[] = "c:\\winnt\\samples\\winprop.c"; </P>

<P></P>

<P>// Load resources. </P>

<P></P>

<P>hIcon = LoadIcon(hinst, MAKEINTRESOURCE(400)); </P>

<P>hCursor = LoadCursor(hinst, MAKEINTRESOURCE(220)); </P>

<P></P>

<P>// Allocate and fill a memory buffer. </P>

<P></P>

<P>hMem = GlobalAlloc(GPTR, BUFFER); </P>

<P>lpMem = GlobalLock(hMem); </P>

<P>lstrcpy(lpMem, tchPath); </P>

<P>GlobalUnlock(hMem); </P>

<P></P>

<P>// Set the window properties for hwndSubclass. </P>

<P></P>

<P>SetProp(hwndSubclass, "PROP_ICON", hIcon); </P>

<P>SetProp(hwndSubclass, "PROP_CURSOR", hCursor); </P>

<P>SetProp(hwndSubclass, "PROP_BUFFER", hMem); </P>

<P></P>

</BODY>
</HTML>
