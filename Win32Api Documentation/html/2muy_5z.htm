<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetNumberFormat</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="2muy_5z"></A><B>GetNumberFormat  <A HREF="._iypv.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1r0c_vq.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="21act6p.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetNumberFormat</B> function formats a number string as a number string customized for a specified locale.</P>

<P><B>int GetNumberFormat(</B></P>

<TABLE cols=2 width=579>

<TR VALIGN="top">
<TD width=43%><B>LCID</B> <I>Locale</I><B>,</B></TD>
<TD width=57%>// locale for which number string is to be formatted </TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>    DWORD</B> <I>dwFlags</I><B>,</B></TD>
<TD width=57%>// bit flag that controls the function's operation</TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>    LPCTSTR</B> <I>lpValue</I><B>,</B></TD>
<TD width=57%>// pointer to input number string</TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>    CONST NUMBERFMT</B> <I>*lpFormat</I><B>,</B></TD>
<TD width=57%>// pointer to a formatting information structure</TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>    LPTSTR</B> <I>lpNumberStr</I><B>,</B></TD>
<TD width=57%>// pointer to output buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>    int</B> <I>cchNumber</I> </TD>
<TD width=57%>// size of output buffer</TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>   );</B></TD>
<TD width=57%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>Locale</I></P>

<P>Specifies the locale for which the number string is to be formatted. If <I>lpFormat</I> is NULL, the function formats the string according to the number format for this locale. If <I>lpFormat</I> is not NULL, the function uses the locale only for formatting information not specified in the <A HREF="7kak4c.htm"><B>NUMBERFMT</B></A> structure (for example, the locale's string value for the negative sign).</P>

<P>This parameter can be a locale identifier created by the <A HREF="d5jw6g.htm"><B>MAKELCID</B></A> macro, or one of the following predefined values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=50%>LOCALE_SYSTEM_DEFAULT</TD>
<TD width=50%>Default system locale.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>LOCALE_USER_DEFAULT</TD>
<TD width=50%>Default user locale.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>dwFlags</I></P>

<P>Contains a bit flag that controls the operation of the function. If <I>lpFormat</I> is non-NULL, this parameter must be zero.</P>

<P>If <I>lpFormat</I> is NULL, you can specify the LOCALE_NOUSEROVERRIDE flag to format the string using the system default number format for the specified locale; or you can specify zero to format the string using any user overrides to the locale's default number format</P>

<P><I>lpValue</I></P>

<P>Points to a null-terminated string containing the number string to format. </P>

<P>This string can only contain the following characters:</P>

<P>·Characters '0' through '9'</P>

<P>·One decimal point (dot) if the number is a floating-point value</P>

<P>·A minus sign in the first character position if the number is a negative value</P>

<P>All other characters are invalid. The function returns an error if the string pointed to by <I>lpValue</I> deviates from these rules.</P>

<P><I>lpFormat</I></P>

<P>Pointer to a <A HREF="7kak4c.htm"><B>NUMBERFMT</B></A> structure that contains number formatting information. All members in the structure pointed to by <I>lpFormat</I> must contain appropriate values.</P>

<P>If <I>lpFormat</I> is NULL, the function uses the number format of the specified locale.</P>

<P></P>

<P><I>lpNumberStr</I></P>

<P>Points to a buffer to receive the formatted number string.</P>

<P><I>cchNumber</I></P>

<P>Specifies the size, in bytes (ANSI version) or characters (Unicode version), of the <I>lpNumberStr</I> buffer. If <I>cchNumber</I> is zero, the function returns the number of bytes or characters required to hold the formatted number string, and the buffer pointed to by <I>lpNumberStr</I> is not used.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is the number of bytes (ANSI version) or characters (Unicode version) written to the buffer pointed to by <I>lpNumberStr</I>, or if the <I>cchNumber</I> parameter is zero, the number of bytes or characters required to hold the formatted number string. </P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. <B>GetLastError</B> may return one of the following error codes: </P>

<P>ERROR_INSUFFICIENT_BUFFER<BR>
ERROR_INVALID FLAGS<BR>
ERROR_INVALID_PARAMETER</P>

<P><B>See Also</B></P>

<P><A HREF="hzj7em.htm"><B>GetCurrencyFormat</B></A>,<B> <A HREF="7kak4c.htm">NUMBERFMT</A></B> </P>

</BODY>
</HTML>
