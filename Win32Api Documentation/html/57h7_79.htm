<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Using Functions That Have No Unicode Equivalents</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="57h7_79"></A><B>Using Functions That Have No Unicode Equivalents</B></P>

<P>Windows functions that have not been exported in a Unicode version have typically been replaced by more powerful or extended functions that do support Unicode. If you are porting code that calls the <A HREF="47xk05.htm"><B>OpenFile</B></A> function, for example, you can support Unicode by using the <A HREF="xn35yd.htm"><B>CreateFile</B></A> or <A HREF="xn35yd.htm"><B>CreateFileEx</B></A> function instead. </P>

<P>If a function has no Unicode equivalent, you can map characters to and from 8-bit character sets before and after the function call. For example, the number-formatting functions <B>atoi</B> and <B>itoa</B> use only the digits 0 through 9. Normally, mapping Unicode to 8-bit characters could cause loss of data, but you can avoid this by making your code type independent and conditionalizing the expressions. For example, the following statements are type dependent and should be changed to support Unicode. </P>

<P>char str[4];  </P>

<P></P>

<P>num = atoi(str); </P>

<P></P>

<P>These statements could be rewritten as follows to make them type independent. </P>

<P>TCHAR tstr[4];  </P>

<P></P>

<P>CHAR strTmp[SIZE]; </P>

<P></P>

<P>#ifdef UNICODE </P>

<P></P>

<P>wcstombs(strTmp, (const wchar_t *) tstr, sizeof(strTmp)); </P>

<P></P>

<P>num = atoi(strTmp); </P>

<P></P>

<P>#else </P>

<P></P>

<P>num = atoi(tstr); </P>

<P></P>

<P>#endif </P>

<P></P>

<P>In this example, the <B>wcstombs</B> function is the standard C function that translates Unicode to ASCII. The example relies on the fact that the digits 0 through 9 can always be translated from Unicode to ASCII, even if some of the surrounding text cannot. The <B>atoi</B> function stops at any character that is not a digit. You can use the <A HREF="2kbvc5.htm"><B>LCMapString</B></A> function if you need to process text that includes the native digits provided for some of the scripts in Unicode. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
