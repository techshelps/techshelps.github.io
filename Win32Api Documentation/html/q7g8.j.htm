<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Retrieving the Last-Write Time</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="q7g8.j"></A><B>Retrieving the Last-Write Time</B></P>

<P>The following example retrieves the last-write time for a file, converts it to local time based on the current time-zone settings, and creates a date and time string that can be shown to the user.</P>

<P>// GetLastWriteTime - retrieves the last-write time and converts the<BR>
//                      time to a string<BR>
// Return value - TRUE if successful, FALSE otherwise<BR>
// hFile      - must be a valid file handle<BR>
// lpszString - address of buffer to receive string<BR>
<BR>
BOOL GetLastWriteTime(HANDLE hFile, LPSTR lpszString)<BR>
{<BR>
    FILETIME ftCreate, ftAccess, ftWrite, ftLocal;<BR>
    SYSTEMTIME stCreate;<BR>
<BR>
    // Retrieve the file times for the file.<BR>
    if (!GetFileTime(hFile, &amp;ftCreate, &amp;ftAccess, &amp;ftWrite))<BR>
        return FALSE;<BR>
<BR>
    // Convert the last-write time to local time.<BR>
    if (!FileTimeToLocalFileTime(&amp;ftWrite, &amp;ftLocal))<BR>
        return FALSE;<BR>
<BR>
    // Convert the local file time from UTC to system time.<BR>
    FileTimeToSystemTime(&amp;ftLocal, &amp;stCreate);<BR>
<BR>
    // Build a string showing the date and time.<BR>
    wsprintf(lpszString, "%02d/%02d/%d  %02d:%02d",<BR>
        stCreate.wDay, stCreate.wMonth, stCreate.wYear,<BR>
        stCreate.wHour, stCreate.wMinute);<BR>
<BR>
    return TRUE;<BR>
}<BR>
<BR>
  </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
