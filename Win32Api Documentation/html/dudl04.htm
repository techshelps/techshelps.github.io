<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IExtractIcon::GetIconLocation [Now Supported on Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="dudl04"></A><B>IExtractIcon::GetIconLocation  <A HREF="u5yivm.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A></B></P>

<P>[Now Supported on Windows NT]</P>

<P>Retrieves the location and index of an icon.</P>

<P><B>HRESULT GetIconLocation(</B></P>

<TABLE cols=2 width=439>

<TR VALIGN="top">
<TD width=36%><B>UINT</B> <I>uFlags</I><B>,</B></TD>
<TD width=64%>//Status values</TD>
</TR>

<TR VALIGN="top">
<TD width=36%><B>    LPSTR</B> <I>szIconFile</I><B>,</B></TD>
<TD width=64%>//Address of buffer receiving icon location</TD>
</TR>

<TR VALIGN="top">
<TD width=36%><B>    INT</B> <I>cchMax</I><B>,</B></TD>
<TD width=64%>//Size of buffer receiving icon location</TD>
</TR>

<TR VALIGN="top">
<TD width=36%><B>    int </B>*<I>piIndex</I><B>,</B></TD>
<TD width=64%>//Pointer that receivs the icon index</TD>
</TR>

<TR VALIGN="top">
<TD width=36%><B>    UINT</B> *<I>pwFlags</I></TD>
<TD width=64%>//Pointer to zero or more values</TD>
</TR>

<TR VALIGN="top">
<TD width=36%><B>   );</B></TD>
<TD width=64%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>uFlags</I></P>

<P>Flags. This parameter can be zero or the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=28%>GIL_FORSHELL</TD>
<TD width=72%>The icon is to be displayed in a shell folder.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%>GIL_OPENICON</TD>
<TD width=72%>The icon should be in the "open" state if both open- and closed-state images are available. If this flag is not specified the icon should be in the normal or "closed" state. This flag is typically used for folder objects.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>szIconFile</I> and <I>cchMax</I></P>

<P>Address of the buffer that receives the icon location. The icon location is a null-terminated string that identifies the location of the icon.</P>

<P><I>cchMax</I></P>

<P>Size of the buffer that receives the icon location.</P>

<P><I>piIndex</I></P>

<P>Pointer to an integer that receives the icon index, which further describes the icon location.</P>

<P><I>pwFlags</I></P>

<P>Pointer to an unsigned integer that receives zero or more of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=34%>GIL_DONTCACHE</TD>
<TD width=66%>The physical image bits for this icon should not be cached by the caller. This distinction is important to consider because a GIL_DONTCACHELOCATION flag may be introducted in future versions of the shell..</TD>
</TR>

<TR VALIGN="top">
<TD width=34%>GIL_NOTFILENAME</TD>
<TD width=66%>The location is not a filename/index pair. Callers that decide to extract the icon from the location must call this object's <A HREF="hdx87o.htm"><B>IExtractIcon::Extract</B></A> method to obtain the desired icon images.</TD>
</TR>

<TR VALIGN="top">
<TD width=34%>GIL_PERCLASS</TD>
<TD width=66%>All objects of this class have the same icon. This flag is used internally by the shell. Typical implementations of <B>IExtractIcon</B> do not require this flag because it implies that an icon handler is not required to resolve the icon on a per-object basis. the recommended method for implementing per-class icons is to register a DefaultIcon for the class.</TD>
</TR>

<TR VALIGN="top">
<TD width=34%>GIL_PERINSTANCE</TD>
<TD width=66%>Each object of this class has its own icon. Used internally by the shell to handle cases like setup.exe where more than one object with identical names could be known to the shell and have different icons. Typical implementations of <B>IExtractIcon</B> do not require this flag.</TD>
</TR>

<TR VALIGN="top">
<TD width=34%>GIL_SIMULATEDOC</TD>
<TD width=66%>The caller should create a document icon using the specified icon.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>Returns NOERROR if the function returned a valid location or S_FALSE if the shell should use a default icon.</P>

<P><B>See Also</B></P>

<P><A HREF="5338sx.htm"><B>IExtractIcon</B></A>, <A HREF="hdx87o.htm"><B>IExtractIcon::Extract</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
