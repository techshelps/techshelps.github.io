<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Disconnectingnections</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="twkoco"></A><B>Disconnecting</B></P>

<P>When a RAS client application starts a connection operation, the <A HREF="1zuv.va.htm"><B>RasDial</B></A> call receives an <B>HRASCONN</B> connection handle to identify the connection. If the returned handle is not NULL, the client must eventually call the <A HREF="0_qzpb.htm"><B>RasHangUp</B></A> function to end the connection. If an error occurs during the connection operation, the client must call <B>RasHangUp</B> even though the connection was never established.</P>

<P>The application that calls <B>RasHangUp</B> should not exit immediately, because the Remote Access Connection Manager needs time to properly terminate the connection. Instead, the application should wait until the <A HREF="11ewq3o.htm"><B>RasGetConnectStatus</B></A> function returns ERROR_INVALID_HANDLE, indicating that the connection has been deleted.</P>

<P>A RAS client application might need to end a connection even though it does not have the handle returned by <B>RasDial</B>. For example, the application that called <B>RasDial</B> might have exited once the connection was successfully established. In this case, the disconnecting application can use the <A HREF="lydo7.htm"><B>RasEnumConnections</B></A> function to get all the current connections. For each connection, <B>RasEnumConnections</B> returns a <A HREF="04l.ry.htm"><B>RASCONN</B></A> structure containing the <B>HRASCONN</B> connection handle and the phonebook entry name or phone number specified when the connection operation was started. This information can be used to display a list of connections from which the user can select the connection to end.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
