<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Creating a Logical Font</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="96c5jg"></A><B>Creating a Logical Font</B></P>

<P>You can use the Font common dialog box to display available fonts. The <A HREF="1c8v_vz.htm"><B>ChooseFont</B></A> dialog box is displayed after an application initializes the members of a <A HREF="5awy_t0.htm"><B>CHOOSEFONT</B></A> structure and calls the <B>ChooseFont</B> function. After the user chooses one of the available fonts and presses the OK button, the <B>ChooseFont</B> function initializes a <A HREF="5m4itk.htm"><B>LOGFONT</B></A> structure with the relevant data. Your application can then call the <A HREF="zy._9a.htm"><B>CreateFontIndirect</B></A> function and create a logical font based on the user's request. The following example demonstrates how this is done. </P>

<P>HFONT FAR PASCAL MyCreateFont( void )  </P>

<P>{ </P>

<P></P>

<P>CHOOSEFONT cf; </P>

<P>LOGFONT lf; </P>

<P>HFONT hfont; </P>

<P></P>

<P>/* Initialize members of the CHOOSEFONT structure. */ </P>

<P></P>

<P>cf.lStructSize = sizeof(CHOOSEFONT); </P>

<P>cf.hwndOwner = (HWND)NULL; </P>

<P>cf.hDC = (HDC)NULL; </P>

<P>cf.lpLogFont = &amp;lf; </P>

<P>cf.iPointSize = 0; </P>

<P>cf.Flags = CF_SCREENFONTS; </P>

<P>cf.rgbColors = RGB(0,0,0); </P>

<P>cf.lCustData = 0L; </P>

<P>cf.lpfnHook = (LPCFHOOKPROC)NULL; </P>

<P>cf.lpTemplateName = (LPSTR)NULL; </P>

<P>cf.hInstance = (HINSTANCE) NULL; </P>

<P>cf.lpszStyle = (LPSTR)NULL; </P>

<P>cf.nFontType = SCREEN_FONTTYPE; </P>

<P>cf.nSizeMin = 0; </P>

<P>cf.nSizeMax = 0; </P>

<P></P>

<P>/* Display the CHOOSEFONT common-dialog box. */ </P>

<P></P>

<P>ChooseFont(&amp;cf); </P>

<P></P>

<P>/* Create a logical font based on the user's   */ </P>

<P>/* selection and return a handle identifying   */ </P>

<P>/* that font.                                  */ </P>

<P></P>

<P>hfont = CreateFontIndirect(cf.lpLogFont); </P>

<P>return (hfont); </P>

<P>} </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
