<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>FindFirstFileEx [New - Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="g.xf1m"></A><B>FindFirstFileEx  <A HREF="3ozi.vx.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="qnj9so.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1f83g2.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>[New - Windows NT]</P>

<P>The <B>FindFirstFileEx</B> function searches a directory for a file whose name and attributes match those specified in the function call.</P>

<P><B>HANDLE FindFirstFileEx(</B></P>

<TABLE cols=2 width=565>

<TR VALIGN="top">
<TD width=48%><B>LPCTSTR</B> <I>lpFileName</I><B>,</B></TD>
<TD width=52%>// pointer to the name of the file to search for</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    FINDEX_INFO_LEVELS</B> <I>fInfoLevelId</I><B>,</B></TD>
<TD width=52%>// information level of the returned data</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    LPVOID</B> <I>lpFindFileData</I><B>,</B></TD>
<TD width=52%>// pointer to the returned information</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    FINDEX_SEARCH_OPS</B> <I>fSearchOp</I><B>,</B></TD>
<TD width=52%>// type of filtering to perform</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    LPVOID</B> <I>lpSearchFilter</I><B>,</B></TD>
<TD width=52%>// pointer to search criteria</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    DWORD</B> <I>dwAdditionalFlags</I></TD>
<TD width=52%>// additional search control flags</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>   );</B></TD>
<TD width=52%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpFileName</I></P>

<P>Points to a null-terminated string that specifies a valid directory or path and filename, which can contain wildcard characters (* and ?).</P>

<P><I>fInfoLevelId</I></P>

<P>Specifies the information level of the returned data. If the FindExInfoStandard constant is used, the <I>lpFindFileData</I> pointer is the standard <A HREF="4tj_4n.htm"><B>WIN32_FIND_DATA</B></A> structure used with <A HREF="2a0z0q6.htm"><B>FindFirstFile</B></A>. At this time, no other information levels are supported.</P>

<P><I>lpFindFileData</I></P>

<P>Pointer to the file data. The pointer type is determined by the level of information specified in the <I>fInfoLevelId</I> parameter.</P>

<P><I>fSearchOp</I></P>

<P>Specifies the type of filtering to perform beyond wildcard matching. For more details, see the Remarks section later in this topic.</P>

<P><I>lpSearchFilter</I></P>

<P>If the specified <I>fSearchOp</I> needs structured search information, <I>lpSearchFilter</I> points to the search criteria. At this time, none of the supported <I>fSearchOp</I> values require extended search information. Therefore, this pointer must be NULL.</P>

<P><I>dwAdditionalFlags</I></P>

<P>Specifies additional flags for controlling the search. You can use the FIND_FIRST_EX_CASE_SENSITIVE flag for case-sensitive searches. The default search is case insensitive. At this time, no other flags are defined.</P>

<P></P>

<P><B>Return Value</B></P>

<P>If the function succeeds, the return value is a search handle that can be used in a subsequent call to the <A HREF="jkcucc.htm"><B>FindNextFile</B></A> or <A HREF="dk5rpx.htm"><B>FindClose</B></A><B> </B>functions.</P>

<P>If the function fails, the return value is INVALID_HANDLE_VALUE. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>.</P>

<P><B>Remarks</B></P>

<P>The <B>FindFirstFileEx</B> function is provided to open a search handle and return information about the first file whose name matches the specified pattern and attributes. </P>

<P>The way additional filtering is done depends on the value of <I>fSearchOp</I>. The <I>fSearchOp</I> parameter can be one of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=45%><B>Value</B></TD>
<TD width=55%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%>FindExSearchNameMatch</TD>
<TD width=55%>Search for a file that matches the specified filename. Note that <I>lpSearchFilter</I> must be NULL when this search operation is used.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>FindExSearchLimitToDevices</TD>
<TD width=55%>Only device names are returned. Device names are generally accessible through the \\.\&lt;name&gt; convention. The <I>dwAdditionalFlags</I> parameter cannot be FIND_FIRST_EX_CASE_SENSITIVE when this search operation is used.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>FindExSearchLimitToDirectories</TD>
<TD width=55%>This is an advisory flag. 
<P>If the file system supports directory filtering, the function searches for a "file" that matches the specified filename and that is a directory. </P>

<P>If the file system does not support directory filtering, this flag is silently ignored.</P>

<P>The <I>lpSearchFilter</I> parameter must be NULL when this search operation is used.</P>

<P>If you want directory filtering, use this flag on all file systems, but be sure to examine the file attribute data stored into *<I>lpFindFileData</I> to determine whether the function has indeed returned a handle to a directory.</P>
</TD>
</TR>
</TABLE><BR>

<P></P>

<P>If the underlying file system does not support a particular type of filtering, other than directory filtering, <B>FindFirstFileEx</B> fails with the error ERROR_NOT_SUPPORTED. The application has to use type FileExSearchNameMatch and perform its own filtering. </P>

<P>Once established, the search handle can be used in the <A HREF="jkcucc.htm"><B>FindNextFile</B></A> function to search for other files that match the same pattern with the same filtering being performed. When the search handle is no longer needed, it should be closed using the <A HREF="dk5rpx.htm"><B>FindClose</B></A> function.</P>

<P>The call </P>

<P>FindFirstFileEx( lpFileName,  </P>

<P>FindExInfoStandard, </P>

<P>lpFindData, </P>

<P>FindExSearchNameMatch, </P>

<P>NULL, </P>

<P>0 );</P>

<P></P>

<P>is equivalent to the call</P>

<P>FindFirstFile( lpFileName, lpFindData);</P>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="2a0z0q6.htm"><B>FindFirstFile</B></A>,<B> <A HREF="jkcucc.htm">FindNextFile</A></B>, <A HREF="dk5rpx.htm"><B>FindClose</B></A>,<B> <A HREF="4tj_4n.htm">WIN32_FIND_DATA</A></B></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
