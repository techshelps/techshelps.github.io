<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CDM_GETFILEPATH [New - Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1gtwr8n"></A><B>CDM_GETFILEPATH  <A HREF="2ymtywg.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="y3i0nj.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1lhvm4l.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>[New - Windows NT]</P>

<P>The <B>CDM_GETFILEPATH</B> message retrieves the path and filename of the selected file in an Explorer-style Open or Save As common dialog box. The dialog box must have been created with the OFN_EXPLORER flag; otherwise, the message fails.</P>

<P>CDM_GETFILEPATH  </P>

<P>wParam = (WPARAM) cbmax; </P>

<P>lParam = (LPARAM) (LPTSTR) psz; </P>

<P></P>

<P>// Corresponding macro </P>

<P>int CommDlg_OpenSave_GetFilePath(hdlg, psz, cbmax); </P>

<P></P>

<P></P>

<P><B>Parameters</B></P>

<P><I>hdlg</I></P>

<P>Handle of the common dialog box window to receive the message.</P>

<P><I>psz</I></P>

<P>Pointer to the buffer that receives the filename and path. </P>

<P><I>cbmax</I></P>

<P>Size, in bytes (ANSI version) or characters (Unicode version), of the <I>psz</I> buffer. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the message succeeds, the return value is the size, in bytes or characters, of the filename and path string, including the terminating NULL character. This is either the number of bytes or characters copied to the <I>psz</I> buffer, or the required buffer size if the buffer is too small.</P>

<P>If an error occurs, the return value is less than zero.</P>

<P><B>See Also</B></P>

<P><A HREF="fzgrjg.htm"><B>GetOpenFileName</B></A>, <A HREF="182.5be.htm"><B>GetSaveFileName</B></A>, <A HREF="2wivnae.htm"><B>OPENFILENAME</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
