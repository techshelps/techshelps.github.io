<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Power Messages</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="n9e151"></A><B>Power Messages</B></P>

<P>The system sends power messages to all applications and installable drivers whenever a power management event occurs or whenever an application calls the <A HREF="l1da37.htm"><B>SetSystemPowerState</B></A> function to suspend operation. The system sends these messages through the <A HREF="gcm3zp.htm">WM_POWERBROADCAST</A> message, setting the <I>wParam</I> parameter to the message type. For example, the message type, <A HREF="1n6xjyy.htm">PBT_APMPOWERSTATUSCHANGE</A>, indicates a system power status change message. </P>

<P>The system sends a <A HREF="6wjk0..htm">PBT_APMQUERYSUSPEND</A> message to request permission to suspend system operation. The system expects each application and driver to determine whether the requested event should occur and to return TRUE or BROADCAST_QUERY_DENY indicating this decision. Any application or driver can deny the request and prevent it from occurring.</P>

<P>The system sends a <A HREF="q98b9o.htm">PBT_APMSUSPEND</A> message immediately before suspending operation. This gives applications and drivers one last chance to prepare for the event before it occurs. In many cases, the system sends these messages without requesting permission to do so. This happens, for example, if an application forces suspension with the <B>SetSystemPowerState</B> function.</P>

<P>The system sends the <A HREF="1n8kix4.htm">PBT_APMQUERYSUSPENDFAILED</A> message whenever a requested event is denied. These messages are intended to notify applications and drivers to continue operation as usual. </P>

<P>The system sends the <A HREF="o23vs8.htm">PBT_APMRESUMESUSPEND</A> or <A HREF="w6.9zn.htm">PBT_APMRESUMECRITICAL</A> message when system operation has been restored. </P>

<P></P>

<P><B>Note</B>  The <A HREF="1uh10tp.htm">WM_POWER</A> message, previously available to applications and drivers for use with power management, is maintained for backward compatibility. All current applications and installable drivers should use and process the <A HREF="gcm3zp.htm">WM_POWERBROADCAST</A> message instead.</P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
