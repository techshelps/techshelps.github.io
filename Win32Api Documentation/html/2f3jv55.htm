<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Service Control Requests</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="2f3jv55"></A><B>Service Control Requests</B></P>

<P>To send control requests to a running service, a service control program uses the <A HREF="2nu_3f.htm"><B>ControlService</B></A> function. This function specifies a control value that is passed to the <A HREF="1eqr9ip.htm"><B>Handler</B></A> function of the specified service. This control value can be a user-defined code, or it can be one of the standard codes that enable the calling program to perform the following actions: </P>

<P>·Stop a service (SERVICE_CONTROL_STOP). </P>

<P>·Pause a service (SERVICE_CONTROL_PAUSE). </P>

<P>·Resume executing a paused service (SERVICE_CONTROL_CONTINUE). </P>

<P>·Retrieve updated status information from a service (SERVICE_CONTROL_INTERROGATE). </P>

<P></P>

<P>For more information, see <A HREF="03rel2.htm">Sending Control Requests to a Service</A>. </P>

<P>Each service specifies the control values that it will accept and process. To determine which of the standard control values are accepted by a service, use the <A HREF="jps..c.htm"><B>QueryServiceStatus</B></A> function or specify the SERVICE_CONTROL_INTERROGATE control value in a call to the <A HREF="2nu_3f.htm"><B>ControlService</B></A> function. The <B>dwControlsAccepted</B> member of the <A HREF="25uoeu.htm"><B>SERVICE_STATUS</B></A> structure returned by these functions indicates whether the service can be stopped, paused, or resumed. All services accept the SERVICE_CONTROL_INTERROGATE control value. </P>

<P><B>Note</B>  The <B>QueryServiceStatus</B> function reports the most recent status for a specified service, but does not get an updated status from the service itself. Using the SERVICE_CONTROL_INTERROGATE control value in a call to <B>ControlService</B> ensures that the status information returned is current. </P>

</BODY>
</HTML>
