<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>FMExtensionProc</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1bvwzve"></A><B>FMExtensionProc  <A HREF="p6kvh2.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="cfzx.u.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="40ra.w7.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>FMExtensionProc</B> function is an application-defined callback function that processes menu commands and messages sent to a File Manager extension dynamic-link library (DLL). </P>

<P><B>LONG WINAPI FMExtensionProc(</B></P>

<TABLE cols=2 width=385>

<TR VALIGN="top">
<TD width=37%><B>HWND</B> <I>hwnd</I><B>,</B></TD>
<TD width=63%>// handle to extension window</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    WORD</B> <I>wEvent</I><B>,</B></TD>
<TD width=63%>// menu-item identifier, or message </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    LONG</B> <I>lParam</I> </TD>
<TD width=63%>// additional message information</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>   );</B></TD>
<TD width=63%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hwnd</I></P>

<P>Identifies the File Manager window. An extension DLL should use this handle to specify the owner for any dialog box or message box that the DLL may display and to send request messages to File Manager. </P>

<P><I>wEvent</I></P>

<P>Specifies the message. This parameter can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=44%><B>Value</B></TD>
<TD width=56%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=44%>1-99</TD>
<TD width=56%>The user selected the menu item identified by this number.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>FMEVENT_INITMENU</TD>
<TD width=56%>User selected the extension's menu.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>FMEVENT_LOAD</TD>
<TD width=56%>File Manager is loading the extension DLL.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>FMEVENT_SELCHANGE</TD>
<TD width=56%>Selection changed in File Manager's directory window or in Search Results window.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>FMEVENT_UNLOAD</TD>
<TD width=56%>File Manager is unloading the extension DLL.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>FMEVENT_USER_REFRESH</TD>
<TD width=56%>User chose the Refresh command from the Window menu.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lParam</I></P>

<P>Specifies 32 bits of additional message-specific information. </P>

<P></P>

<P><B>Return Values</B></P>

<P>The callback function should return the result of the message processing. The actual return value depends on the message processed. </P>

<P><B>Remarks</B></P>

<P>Whenever File Manager calls the <B>FMExtensionProc</B> function, it waits to refresh its directory windows (for changes in the file system) until after the function returns. This allows the extension to perform large numbers of file operations without excessive repainting by File Manager. It is not necessary for the extension to send the FM_REFRESH_WINDOWS message to notify File Manager to repaint its windows. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
