<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Querying the Event Log</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="d6e__t"></A><B>Querying the Event Log</B></P>

<P>The following code sample displays the number of event records currently in the <B>Application</B> event log and the <B>System</B> event log. </P>

<P>/* Open the System log. */  </P>

<P></P>

<P>h = OpenEventLog(NULL,  /* uses local computer   */ </P>

<P>"System");          /* source name          */ </P>

<P>if (h == NULL) </P>

<P>ErrorExit("could not open System event log"); </P>

<P></P>

<P>/* Get the number of records in the System event log. */ </P>

<P></P>

<P>if (!GetNumberOfEventLogRecords(h, &amp;cRecords)) </P>

<P>ErrorExit </P>

<P>("could not get number of records"); </P>

<P></P>

<P>printf("There are %d records in the System event log.\n", cRecords); </P>

<P></P>

<P>CloseEventLog(h); </P>

<P></P>

<P>/* Open the Application log. */ </P>

<P></P>

<P>h = OpenEventLog(NULL,  /* uses local computer  */ </P>

<P>"Application");     /* source name          */ </P>

<P>if (h == NULL) </P>

<P>ErrorExit("could not open Application event log"); </P>

<P></P>

<P>/* Get the number of records in the Application event log. */ </P>

<P></P>

<P>if (!GetNumberOfEventLogRecords(h, &amp;cRecords)) </P>

<P>ErrorExit("could not get number of records"); </P>

<P></P>

<P>printf("There are %d records in the Application event log.\n", </P>

<P>cRecords); </P>

<P></P>

<P>CloseEventLog(h); </P>

<P></P>

</BODY>
</HTML>
