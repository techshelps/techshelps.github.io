<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Handler</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1eqr9ip"></A><B>Handler  <A HREF="168w7wc.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="12c8zrk.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="we4jtq.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>A <B>Handler</B> function is a function that a service process specifies as the control handling function of a particular service. The function can have any application-defined name. </P>

<P><B>VOID WINAPI Handler(</B></P>

<TABLE cols=2 width=361>

<TR VALIGN="top">
<TD width=48%><B>DWORD</B> <I>fdwControl</I> </TD>
<TD width=52%>// requested control code  </TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>   );</B></TD>
<TD width=52%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>fdwControl</I></P>

<P>Indicates the requested control code. This value can be one of the standard control codes in the table, or it can be a user-defined control code in the range of 128 to 255, inclusive. For user-defined control codes, the service defines the action associated with the control code. </P>

<TABLE cols=3>

<TR VALIGN="top">
<TD width=14%><B>Value</B></TD>
<TD width=73%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>SERVICE_CONTROL_STOP</TD>
<TD colspan=20 width=1798360499%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=14%>&nbsp;</TD>
<TD width=73%>Requests the service to stop.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>SERVICE_CONTROL_PAUSE</TD>
<TD colspan=20 width=1798360499%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=14%>&nbsp;</TD>
<TD width=73%>Requests the service to pause.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>SERVICE_CONTROL_CONTINUE</TD>
<TD colspan=20 width=1798360499%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=14%>&nbsp;</TD>
<TD width=73%>Requests the paused service to resume.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>SERVICE_CONTROL_INTERROGATE</TD>
<TD colspan=20 width=1798360499%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=14%>&nbsp;</TD>
<TD width=73%>Requests the service to immediately report its current status information to the service control manager.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>SERVICE_CONTROL_SHUTDOWN</TD>
<TD colspan=20 width=1798360499%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=14%>&nbsp;</TD>
<TD width=73%>Requests the service to perform cleanup tasks, because the system is shutting down. Due to extremely limited time available for shutdown, this control should only be used by services that absolutely need to shut down ¾  for instance, when the eventlog service needs to clear a dirty bit in the files that it maintains, or when the server service needs to shut down so that network connections aren't made when the system is in the shutdown state.
<P>If the service takes time to shut down, and sends out STOP_PENDING status messages, it is highly recommended that these messages include a waithint so that the service controller will know how long to wait before indicating to the system that service shutdown is complete. The system gives the service control manager a limited amount of time (about 20 seconds) to complete service shutdown, after which time system shutdown proceeds regardless of whether service shutdown is complete.</P>
</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>This function does not return a value. </P>

<P><B>Remarks</B></P>

<P>When a Win32 service is started, its <B>ServiceMain</B> function should immediately call the <B>RegisterServiceCtrlHandler</B> function to specify a <B>Handler</B> function to handle control requests. </P>

<P>Whenever it receives a control request from the service control manager, the control dispatcher in the main thread of a Win32 service process invokes the control handler function for the specified service. After handling the control request, the control handler must call the <B>SetServiceStatus</B> function to report its current status to the service control manager. </P>

<P><B>See Also</B></P>

<P><A HREF="hbd0d..htm"><B>RegisterServiceCtrlHandler</B></A>, <A HREF="y7r.4o.htm"><B>ServiceMain</B></A>, <A HREF="u71xdk.htm"><B>SetServiceStatus</B></A> </P>

</BODY>
</HTML>
