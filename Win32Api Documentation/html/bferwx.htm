<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Enhanced Metafiles</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="bferwx"></A><B>Enhanced Metafiles</B></P>

<P>An <I>enhanced metafile</I> is an array of records. A metafile record is a variable-length <A HREF="ofdyrh.htm"><B>ENHMETARECORD</B></A> structure. This structure identifies the record type, specifies the record length, and contains additional data that is dependent on the record type. </P>

<P>The first record in an enhanced metafile is always the enhanced-metafile header. The header specifies the following information.</P>

<P>·Size of the metafile, in bytes </P>

<P>·Dimensions of the picture frame, in device units </P>

<P>·Dimensions of the picture frame, in .01-millimeter units </P>

<P>·Number of records in the metafile </P>

<P>·Offset to an optional text description </P>

<P>·Size of the optional palette </P>

<P>·Resolution of the original device, in pixels </P>

<P>·Resolution of the original device, in millimeters </P>

<P></P>

<P>An optional text description can follow the header record. The text description describes the picture and the author's name. The optional palette specifies the colors used to create the enhanced metafile. The remaining records identify the GDI functions used to create the picture. The following hexadecimal output corresponds to a record generated for a call to the <A HREF="1gp60x2.htm"><B>SetMapMode</B></A> function. </P>

<P>00000011 0000000C 00000004  </P>

<P></P>

<P>The value 0x00000011 specifies the record type (corresponds to the EMR_SETMAPMODE constant defined in the file WINGDI.H). The value 0x0000000C specifies the length of the record, in bytes. The value 0x00000004 identifies the mapping mode (corresponds to the MM_LOENGLISH constant defined in the file WINGDI.H). </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
