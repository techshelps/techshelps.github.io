<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>IShellBrowser::InsertMenusSB [Now Supported on Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="kol_oe"></A><B>IShellBrowser::InsertMenusSB  <A HREF="17githc.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A></B></P>

<P>[Now Supported on Windows NT]</P>

<P>Allows the Explorer to insert its menu groups into the composite menu being displayed while viewing or using an extended namespace.</P>

<P><B>HRESULT InsertMenusSB(</B></P>

<TABLE cols=2 width=583>

<TR VALIGN="top">
<TD width=55%><B>HMENU</B> <I>hmenuShared</I><B>,</B></TD>
<TD width=45%>// A handle to an empty menu</TD>
</TR>

<TR VALIGN="top">
<TD width=55%><B>    LPOLEMENUGROUPWIDTHS</B> <I>lpMenuWidths</I></TD>
<TD width=45%>// Points to OLEMENUGROUPWIDTHS</TD>
</TR>

<TR VALIGN="top">
<TD width=55%><B>   );</B></TD>
<TD width=45%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hmenuShared</I></P>

<P>Specifies a handle to an empty menu.</P>

<P><I>lpMenuWidths</I></P>

<P>Points to an OLEMENUGROUPWIDTHS array of 6 LONG values. The container fills in elements 0,2, and 4 to reflect the number of menu elements it provided in the File, View, and Window menu groups.</P>

<P></P>

<P><B>Return Values</B></P>

<P>Returns NOERROR if successful or an OLE-defined error value otherwise.</P>

<P><B>Remarks</B></P>

<P>This method is similar to <B>IOleInPlaceFrame::InsertMenus</B>. The Explorer puts File and Edit pulldown menus in the File menu group, View and Tools in the Container menu group, and Help in the Window menu group. Each pulldown menu will have a unique identifier, FCIDM_MENU_FILE/EDIT/VIEW/TOOLS/HELP. The view is allowed to insert menu items into those submenus by their identifiers, which is different from OLE's in-place activation mechanism. The command IDs for menus that the view inserts into either the Explorer's submenus or its own submenus, must be between FCIDM_SHVIEWFIRST and FCIDM_SHVIEWLAST.</P>

<P><B>Notes to Callers</B></P>

<P>This method is called by namespace extensions when they are first being activated so they can insert their menus into the frame-level user interface.</P>

<P>The object application asks the container to add its menus to the menu specified in <I>hmenuShared</I> and to set the group counts in the OLEMENUGROUPWIDTHS array pointed to by <I>lpMenuWidths</I>. The object application then adds its own menus and counts. Objects can call <B>IOleInPlaceFrame::InsertMenus</B> as many times as necessary to build up the composite menus. The container should use the initial menu handle associated with the composite menu for all items in the drop-down menus.</P>

<P><B>Notes to Implementors</B></P>

<P>For <B>IShellBrowser</B> implementations, the menu identifiers must be in the range of FCIDM_BROWSERFIRST to FCIDM_BROWSERLAST.</P>

<P><B>See Also</B></P>

<P><A HREF="pgetm9.htm"><B>IShellBrowser</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
