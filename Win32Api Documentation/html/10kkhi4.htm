<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>LZCopy</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="10kkhi4"></A><B>LZCopy  <A HREF="jyz5tp.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="_f77a7.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="7d2bul.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>LZCopy</B> function copies a source file to a destination file. If the source file is compressed with the Microsoft File Compression Utility (COMPRESS.EXE), this function creates a decompressed destination file. If the source file is not compressed, this function duplicates the original file. </P>

<P><B>LONG LZCopy(</B></P>

<TABLE cols=2 width=406>

<TR VALIGN="top">
<TD width=32%><B>INT</B> <I>hfSource</I><B>,</B></TD>
<TD width=68%>// LZ file handle identifying source file</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    INT</B> <I>hfDest</I> </TD>
<TD width=68%>// LZ file handle identifying destination file</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>   );</B></TD>
<TD width=68%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hfSource</I></P>

<P>Identifies the source file. </P>

<P><I>hfDest</I></P>

<P>Identifies the destination file. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value specifies the size, in bytes, of the destination file. </P>

<P>If the function fails, the return value is an LZERROR_* code. These codes have values less than zero. Note that <B>LZCopy</B> calls neither <B>SetLastError</B> nor <B>SetLastErrorEx</B>; thus, its failure does not affect a thread's last-error code. </P>

<P>Here is a list of the LZERROR_* codes that <B>LZCopy</B> can return upon failure: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=42%><B>Value</B></TD>
<TD width=58%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=42%>LZERROR_BADINHANDLE</TD>
<TD width=58%>The handle identifying the source file is not valid. The file cannot be read.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>LZERROR_BADOUTHANDLE</TD>
<TD width=58%>The handle identifying the destination file is not valid. The file cannot be written.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>LZERROR_GLOBALLOC</TD>
<TD width=58%>The maximum number of open compressed files has been exceeded or local memory cannot be allocated.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>LZERROR_GLOBLOCK</TD>
<TD width=58%>The LZ file handle cannot be locked down.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>LZERROR_READ</TD>
<TD width=58%>The source file format is not valid.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>The handles identifying the source and destination files must be retrieved by calling the <A HREF="hbeguj.htm"><B>LZInit</B></A> or <A HREF="zo.1mn.htm"><B>LZOpenFile</B></A> function. </P>

<P>The preferred function to use for copying files is <B>LZCopy</B>. The <B>CopyLZFile</B> function is provided for compatibility with 16-bit versions of Windows.</P>

<P>If the function succeeds, the file identified by the <I>hfDest</I> parameter is always uncompressed. </P>

<P><B>See Also</B></P>

<P><A HREF="115h030.htm"><B>CopyLZFile</B></A>, <A HREF="hbeguj.htm"><B>LZInit</B></A>, <A HREF="zo.1mn.htm"><B>LZOpenFile</B></A> </P>

</BODY>
</HTML>
