<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Scrolling a Screen Buffer's Window</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="q9pvq4"></A><B>Scrolling a Screen Buffer's Window</B></P>

<P>The <A HREF="br66lz.htm"><B>SetConsoleWindowInfo</B></A> function can be used to scroll the contents of a screen buffer in the console window. This function can also change the window size. The function can either specify the new upper left and lower right corners of the screen buffer's window as absolute screen buffer coordinates or specify the changes from the current window coordinates. The function fails if the specified window coordinates are outside the boundaries of the screen buffer. </P>

<P>The following example scrolls the view of the screen buffer up one row by modifying the absolute window coordinates returned by the <A HREF="h61zfu.htm"><B>GetConsoleScreenBufferInfo</B></A> function. </P>

<P>HANDLE hStdout;  </P>

<P>CONSOLE_SCREEN_BUFFER_INFO csbiInfo; </P>

<P>SMALL_RECT srctWindow; </P>

<P></P>

<P>hStdout = GetStdHandle(STD_OUTPUT_HANDLE); </P>

<P></P>

<P>/* Get the current screen buffer size and window position. */ </P>

<P></P>

<P>if (! GetConsoleScreenBufferInfo(hStdout, &amp;csbiInfo)) </P>

<P>MyErrorExit("GetConsoleScreenBufferInfo"); </P>

<P></P>

<P>/* Set srctWindow to the current window size and location. */ </P>

<P></P>

<P>srctWindow = csbiInfo.srWindow; </P>

<P></P>

<P>/* If window is not at the screen buffer top, move it up one line. */ </P>

<P></P>

<P>if ( srctWindow.Top &gt; 0 ) { </P>

<P>srctWindow.Top -= 1;      /* move top up by one row    */ </P>

<P>srctWindow.Bottom -= 1;   /* move bottom up by one row */ </P>

<P>if (! SetConsoleWindowInfo( </P>

<P>hStdout,      /* screen buffer handle       */ </P>

<P>TRUE,         /* absolute coordinates       */ </P>

<P>&amp;srctWindow)) /* specifies new location     */ </P>

<P>MyErrorExit("SetConsoleWindowInfo"); </P>

<P>} </P>

<P></P>

<P>The same scrolling can be done by specifying changes in the window coordinates. </P>

<P>/* Get the current screen buffer window position. */  </P>

<P></P>

<P>if (! GetConsoleScreenBufferInfo(hStdout, &amp;csbiInfo)) </P>

<P>MyErrorExit("GetConsoleScreenBufferInfo"); </P>

<P></P>

<P>/*If window is not at the screen buffer top, move it up one line. */ </P>

<P></P>

<P>if (csbiInfo.srWindow.Top &gt; 0) { </P>

<P>srctWindow.Top = -1;      /* move top up by one row    */ </P>

<P>srctWindow.Bottom = -1;   /* move bottom up by one row */ </P>

<P>srctWindow.Left = 0;      /* no change                 */ </P>

<P>srctWindow.Right = 0;     /* no change                 */ </P>

<P>if (! SetConsoleWindowInfo( </P>

<P>hStdout,      /* screen buffer handle   */ </P>

<P>FALSE,        /* deltas, not absolute   */ </P>

<P>&amp;srctWindow)) /* specifies new location */ </P>

<P>MyErrorExit("SetConsoleWindowInfo"); </P>

<P>} </P>

<P></P>

</BODY>
</HTML>
