<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Hook Procedures for Common Dialog Boxes</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="12sb5zu"></A><B>Hook Procedures for Common Dialog Boxes</B></P>

<P>For each of the common dialog boxes, you can enable a hook procedure to process messages from the default dialog box procedure. There are two general types of common dialog hook procedures: </P>

<P>·The standard hook procedure used with most common dialog boxes</P>

<P>·The Explorer-style hook procedure supported by the Open and Save As dialog boxes </P>

<P></P>

<P>When you provide a standard hook procedure for one of the common dialog boxes, the default dialog box procedure handles its messages as follows.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=32%><B>Message</B></TD>
<TD width=68%><B>Handling</B></TD>
</TR>

<TR VALIGN="top">
<TD width=32%><A HREF="ii1w.b.htm">WM_INITDIALOG</A> </TD>
<TD width=68%>The default dialog box procedure processes the message before passing it to the hook procedure. The message's <I>lParam</I> parameter is a pointer to the initialization structure specified when the dialog was created.</TD>
</TR>

<TR VALIGN="top">
<TD width=32%>All other messages</TD>
<TD width=68%>The hook procedure receives the message first. Then, the return value of the hook procedure determines whether the default dialog procedure processes the message or ignores it.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>For the Explorer-style Open and Save As dialog boxes, the hook procedure does not receive messages intended for the standard controls in the common dialog box. Instead, it receives notification messages from the dialog box and messages for any additional controls that you defined in a custom template. For more information, see <A HREF="265k7c5.htm">Explorer-Style Hook Procedures</A>. </P>

<P>To enable a hook procedure, set an ENABLEHOOK value in the <B>Flags</B> member of the corresponding structure for the dialog box. If an ENABLEHOOK flag is set, an <B>lpfnHook</B> member of the structure must specify the address of the hook procedure. </P>

<P>The following table shows the type of hook procedure to provide for each of the common dialog boxes.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=32%><B>Common dialog box type</B></TD>
<TD width=68%><B>Hook procedure</B></TD>
</TR>

<TR VALIGN="top">
<TD width=32%>Color</TD>
<TD width=68%><A HREF="1c6i0je.htm"><B>CCHookProc</B></A> </TD>
</TR>

<TR VALIGN="top">
<TD width=32%>Find or Replace</TD>
<TD width=68%><A HREF="13618ab.htm"><B>FRHookProc</B></A> </TD>
</TR>

<TR VALIGN="top">
<TD width=32%>Font</TD>
<TD width=68%><A HREF="71nx3z.htm"><B>CFHookProc</B></A> </TD>
</TR>

<TR VALIGN="top">
<TD width=32%>Open or Save As <BR>
(Explorer-style)</TD>
<TD width=68%><A HREF="f31p7d.htm"><B>OFNHookProc</B></A> </TD>
</TR>

<TR VALIGN="top">
<TD width=32%>Open or Save As<BR>
(Old-style)</TD>
<TD width=68%><A HREF="4_i3_.9.htm"><B>OFNHookProcOldStyle</B></A> </TD>
</TR>

<TR VALIGN="top">
<TD width=32%>Print</TD>
<TD width=68%><A HREF="9iia8w.htm"><B>PrintHookProc</B></A> </TD>
</TR>

<TR VALIGN="top">
<TD width=32%>Page Setup</TD>
<TD width=68%><A HREF="f5p5bl.htm"><B>PageSetupHook</B></A> </TD>
</TR>
</TABLE><BR>

<P></P>

<P>For the Page Setup dialog box, you can also specify a <A HREF="1y2j3f.htm"><B>PagePaintHook</B></A> hook procedure. This is a special hook procedure that you can use to customize the appearance of the sample page displayed by the Page Setup dialog box.</P>

<P></P>

<P><B>Note</B>  The Print Setup dialog box has been superseded by the Page Setup dialog box, which should be used by new applications written for Windows 95 or for Windows NT versions 3.51 or later. However, for compatibility with earlier versions of Windows, the <A HREF="11768vz.htm"><B>PrintDlg</B></A> function continues to support display of the Print Setup dialog box. You can provide a <A HREF="gtvlam.htm"><B>SetupHookProc</B></A> hook procedure for the Print Setup dialog box. </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
