<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Subentries and Multilink Connections</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="cpyvt1"></A><B>Subentries and Multilink Connections</B></P>

<P>Windows NT version 4.0 provides support for phone-book subentries, which enable multilink connections. A multilink connection combines the bandwidth of multiple connections to provide a single connection with higher bandwidth. </P>

<P>A RAS phone-book entry can have zero or more subentries. The <A HREF="3rcv.yk.htm"><B>RasGetEntryProperties</B></A> function retrieves a <A HREF="vji5sp.htm"><B>RASENTRY</B></A> structure that includes information about the subentries of a phone-book entry. The <B>dwSubEntries</B> member of the <B>RASENTRY</B> structure indicates the number of subentries. Phone-book entries initially have no subentries. To add subentries to a phone-book entry, use the <A HREF="1br3dv6.htm"><B>RasSetSubEntryProperties</B></A> function.</P>

<P>The properties for each subentry include a phone number and the name and type of the TAPI device to use when dialing the subentry. In addition, a subentry can include a list of alternate phone numbers to dial if RAS cannot make a connection using the primary number. The <B>RasSetSubEntryProperties</B> and <A HREF="14m55sk.htm"><B>RasGetSubEntryProperties</B></A> functions use the <A HREF="1nznwsp.htm"><B>RASSUBENTRY</B></A> structure to set and retrieve the properties of a specified phone-book subentry. Subentries are identified by a one-based index.</P>

<P>You can call the <A HREF="4ocjekt.htm"><B>RasSetEntryProperties</B></A> function to configure a multilink RAS entry to connect all subentries when it is first dialed. Alternatively, you can configure an entry to provide variable bandwidth. In this case, RAS connects a single subentry initially, and then connects or disconnects additional subentries as needed. For a variable-bandwidth multilink connection, you can use the <A HREF="3o3p0vx.htm"><B>RASDIALPARAMS</B></A> structure to specify the initial subentry to connect when you call the <A HREF="1zuv.va.htm"><B>RasDial</B></A> function. When using the <A HREF="12pubzh.htm"><B>RasDialDlg</B></A> function to connect a multilink entry, you can use the <A HREF="17jlk87.htm"><B>RASDIALDLG</B></A> structure to specify the initial subentry to connect. </P>

<P>For a variable-bandwidth multilink connection, use the <A HREF="vji5sp.htm"><B>RASENTRY</B></A> structure with the <B>RasSetEntryProperties</B> function to specify the parameters for connecting and disconnecting the individual subentries. RAS connects an additional subentry when the bandwidth being used exceeds a specified percentage of the available bandwidth for a specified interval. </P>

<P>If you call the <B>RasDial</B> function to establish a multilink connection, you can specify a <A HREF="2xbtbfy.htm"><B>RasDialFunc2</B></A> callback function to receive notifications about the connection. <B>RasDialFunc2</B> is similar to the <A HREF="2xbtbfx.htm"><B>RasDialFunc1</B></A> callback function, except that it provides additional information for a multilink connection, such as the index of the subentry that caused the notification. RAS calls your <B>RasDialFunc2</B> function when it connects or disconnects a subentry. </P>

<P>You can use an <B>HRASCONN</B> connection handle to hang up or retrieve information about a multilink connection. You can get a connection handle for each of the subentry connections that make up the multilink, as well as for the combined multilink connection. When you call the <A HREF="1zuv.va.htm"><B>RasDial</B></A> function to establish a multilink connection, <B>RasDial</B> returns a handle to the combined multilink connection. Similarly, <A HREF="lydo7.htm"><B>RasEnumConnections</B></A> returns the combined multilink handle when you enumerate connections. To get a handle to one of the subentry connections in a multilink connection, call the <A HREF="xe_g22.htm"><B>RasGetSubEntryHandle</B></A> function. </P>

<P>You can use the combined multilink connection handle and the subentry connection handles in the <A HREF="0_qzpb.htm"><B>RasHangUp</B></A>, <A HREF="11ewq3o.htm"><B>RasGetConnectStatus</B></A>, and <A HREF="1xevgyp.htm"><B>RasGetProjectionInfo</B></A> functions. Calling <B>RasHangUp</B> with a combined multilink handle terminates the entire connection; calling it with a subentry handle hangs up only that subentry connection. Similarly, <B>RasGetConnectStatus</B> returns information for the combined or individual connection, depending on the handle specified. The projection information returned by <B>RasGetProjectionInfo</B> for a multilink entry is the same for each of the subentry connection handles as it is for the main connection handle.</P>

</BODY>
</HTML>
