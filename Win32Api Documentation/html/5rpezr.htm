<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>COMMPROP</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="5rpezr"></A><B>COMMPROP  <A HREF="mafsh_.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="5jpun8.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1ock5rm.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>COMMPROP</B> structure is used by the <A HREF="16dv39w.htm"><B>GetCommProperties</B></A> function to return information about a given communications driver. </P>

<P>typedef struct _COMMPROP { // cmmp  </P>

<P>WORD  wPacketLength;       // packet size, in bytes </P>

<P>WORD  wPacketVersion;      // packet version </P>

<P>DWORD dwServiceMask;       // services implemented </P>

<P>DWORD dwReserved1;         // reserved </P>

<P>DWORD dwMaxTxQueue;        // max Tx bufsize, in bytes </P>

<P>DWORD dwMaxRxQueue;        // max Rx bufsize, in bytes </P>

<P>DWORD dwMaxBaud;           // max baud rate, in bps </P>

<P>DWORD dwProvSubType;       // specific provider type </P>

<P>DWORD dwProvCapabilities;  // capabilities supported </P>

<P>DWORD dwSettableParams;    // changable parameters </P>

<P>DWORD dwSettableBaud;      // allowable baud rates </P>

<P>WORD  wSettableData;       // allowable byte sizes </P>

<P>WORD  wSettableStopParity; // stop bits/parity allowed </P>

<P>DWORD dwCurrentTxQueue;    // Tx buffer size, in bytes </P>

<P>DWORD dwCurrentRxQueue;    // Rx buffer size, in bytes </P>

<P>DWORD dwProvSpec1;         // provider-specific data </P>

<P>DWORD dwProvSpec2;         // provider-specific data </P>

<P>WCHAR wcProvChar[1];       // provider-specific data </P>

<P>} COMMPROP; </P>

<P></P>

<P><B>Members</B></P>

<P><B>wPacketLength</B></P>

<P>Specifies the size, in bytes, of the entire data packet, regardless of the amount of data requested. </P>

<P><B>wPacketVersion</B></P>

<P>Specifies the version of the structure. </P>

<P><B>dwServiceMask</B></P>

<P>Specifies a bitmask indicating which services are implemented by this provider. The SP_SERIALCOMM value is always specified for communications providers, including modem providers. </P>

<P><B>dwReserved1</B></P>

<P>Reserved; do not use. </P>

<P><B>dwMaxTxQueue</B></P>

<P>Specifies the maximum size, in bytes, of the driver's internal output buffer. A value of zero indicates that no maximum value is imposed by the serial provider. </P>

<P><B>dwMaxRxQueue</B></P>

<P>Specifies the maximum size, in bytes, of the driver's internal input buffer. A value of zero indicates that no maximum value is imposed by the serial provider. </P>

<P><B>dwMaxBaud</B></P>

<P>Specifies the maximum allowable baud rate, in bits per second (bps). This member can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=26%><B>Value</B></TD>
<TD width=74%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_075</TD>
<TD width=74%>75 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_110</TD>
<TD width=74%>110 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_134_5</TD>
<TD width=74%>134.5 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_150</TD>
<TD width=74%>150 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_300</TD>
<TD width=74%>300 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_600</TD>
<TD width=74%>600 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_1200</TD>
<TD width=74%>1200 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_1800</TD>
<TD width=74%>1800 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_2400</TD>
<TD width=74%>2400 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_4800</TD>
<TD width=74%>4800 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_7200</TD>
<TD width=74%>7200 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_9600</TD>
<TD width=74%>9600 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_14400</TD>
<TD width=74%>14400 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_19200</TD>
<TD width=74%>19200 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_38400</TD>
<TD width=74%>38400 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_56K</TD>
<TD width=74%>56K bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_57600</TD>
<TD width=74%>57600 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_115200</TD>
<TD width=74%>115200 bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_128K</TD>
<TD width=74%>128K bps</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>BAUD_USER</TD>
<TD width=74%>Programmable baud rates available</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>dwProvSubType</B></P>

<P>Specifies the specific communications provider type: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=41%><B>Value</B></TD>
<TD width=59%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PST_FAX</TD>
<TD width=59%>FAX device</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PST_LAT</TD>
<TD width=59%>LAT protocol</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PST_MODEM</TD>
<TD width=59%>Modem device</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PST_NETWORK_BRIDGE</TD>
<TD width=59%>Unspecified network bridge</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PST_PARALLELPORT</TD>
<TD width=59%>Parallel port</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PST_RS232</TD>
<TD width=59%>RS-232 serial port</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PST_RS422</TD>
<TD width=59%>RS-422 port</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PST_RS423</TD>
<TD width=59%>RS-423 port</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PST_RS449</TD>
<TD width=59%>RS-449 port</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PST_SCANNER</TD>
<TD width=59%>Scanner device</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PST_TCPIP_TELNET</TD>
<TD width=59%>TCP/IP Telnet® protocol</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PST_UNSPECIFIED</TD>
<TD width=59%>Unspecified</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>PST_X25</TD>
<TD width=59%>X.25 standards</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>dwProvCapabilities</B></P>

<P>Specifies a bitmask indicating the capabilities offered by the provider. This member can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=39%><B>Value</B></TD>
<TD width=61%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PCF_16BITMODE</TD>
<TD width=61%>Special 16-bit mode supported</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PCF_DTRDSR</TD>
<TD width=61%>DTR (data-terminal-ready)/DSR (data-set-ready) supported</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PCF_INTTIMEOUTS</TD>
<TD width=61%>Interval time-outs supported</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PCF_PARITY_CHECK</TD>
<TD width=61%>Parity checking supported</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PCF_RLSD</TD>
<TD width=61%>RLSD (receive-line-signal-detect) supported</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PCF_RTSCTS</TD>
<TD width=61%>RTS (request-to-send)/CTS (clear-to-send) supported</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PCF_SETXCHAR</TD>
<TD width=61%>Settable XON/XOFF supported</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PCF_SPECIALCHARS</TD>
<TD width=61%>Special character support provided</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PCF_TOTALTIMEOUTS</TD>
<TD width=61%>Total (elapsed) time-outs supported</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>PCF_XONXOFF</TD>
<TD width=61%>XON/XOFF flow control supported</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>dwSettableParams</B></P>

<P>Specifies a bitmask indicating the communications parameter that can be changed. This member can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=35%><B>Value</B></TD>
<TD width=65%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SP_BAUD</TD>
<TD width=65%>Baud rate</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SP_DATABITS</TD>
<TD width=65%>Data bits</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SP_HANDSHAKING</TD>
<TD width=65%>Handshaking (flow control)</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SP_PARITY</TD>
<TD width=65%>Parity</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SP_PARITY_CHECK</TD>
<TD width=65%>Parity checking</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SP_RLSD</TD>
<TD width=65%>RLSD (receive-line-signal-detect)</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SP_STOPBITS</TD>
<TD width=65%>Stop bits</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>dwSettableBaud</B></P>

<P>Specifies a bitmask indicating the baud rates that can be used. For values, see the <B>dwMaxBaud</B> member. </P>

<P><B>wSettableData</B></P>

<P>Specifies a bitmask indicating the number of data bits that can be set. This member can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=28%><B>Value</B></TD>
<TD width=72%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>DATABITS_5</TD>
<TD width=72%>5 data bits</TD>
</TR>

<TR VALIGN="top">
<TD width=28%>DATABITS_6</TD>
<TD width=72%>6 data bits</TD>
</TR>

<TR VALIGN="top">
<TD width=28%>DATABITS_7</TD>
<TD width=72%>7 data bits</TD>
</TR>

<TR VALIGN="top">
<TD width=28%>DATABITS_8</TD>
<TD width=72%>8 data bits</TD>
</TR>

<TR VALIGN="top">
<TD width=28%>DATABITS_16</TD>
<TD width=72%>16 data bits</TD>
</TR>

<TR VALIGN="top">
<TD width=28%>DATABITS_16X</TD>
<TD width=72%>Special wide path through serial hardware lines</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>wSettableStopParity</B></P>

<P>Specifies a bitmask indicating the stop bit and parity settings that can be selected. This member can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=30%><B>Value</B></TD>
<TD width=70%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=30%>STOPBITS_10</TD>
<TD width=70%>1 stop bit</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>STOPBITS_15</TD>
<TD width=70%>1.5 stop bits</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>STOPBITS_20</TD>
<TD width=70%>2 stop bits</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>PARITY_NONE</TD>
<TD width=70%>No parity</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>PARITY_ODD</TD>
<TD width=70%>Odd parity</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>PARITY_EVEN</TD>
<TD width=70%>Even parity</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>PARITY_MARK</TD>
<TD width=70%>Mark parity</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>PARITY_SPACE</TD>
<TD width=70%>Space parity</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>dwCurrentTxQueue</B></P>

<P>Specifies the size, in bytes, of the driver's internal output buffer. A value of zero indicates that the value is unavailable. </P>

<P><B>dwCurrentRxQueue</B></P>

<P>Specifies the size, in bytes, of the driver's internal input buffer. A value of zero indicates that the value is unavailable. </P>

<P><B>dwProvSpec1</B></P>

<P>Specifies provider-specific data. Applications should ignore this member unless they have detailed information about the format of the data required by the provider.</P>

<P>Set this member to COMMPROP_INITIALIZED before calling the <B>GetCommProperties</B> function to indicate that the <B>wPacketLength</B> member is already valid.</P>

<P><B>dwProvSpec2</B></P>

<P>Specifies provider-specific data. Applications should ignore this member unless they have detailed information about the format of the data required by the provider.</P>

<P><B>wcProvChar</B></P>

<P>Specifies provider-specific data. Applications should ignore this member unless they have detailed information about the format of the data required by the provider.</P>

<P></P>

<P><B>Remarks</B></P>

<P>The contents of the <B>dwProvSpec1</B>, <B>dwProvSpec2</B>, and <B>wcProvChar</B> members depend on the provider subtype (specified by the <B>dwProvSubType</B> member).</P>

<P>If the provider subtype is PST_MODEM, these members are used as follows:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=30%><B>Value</B></TD>
<TD width=70%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>dwProvSpec1</B></TD>
<TD width=70%>Not used.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>dwProvSpec2</B></TD>
<TD width=70%>Not used.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>wcProvChar </B></TD>
<TD width=70%>Contains a <A HREF="0xbd43.htm"><B>MODEMDEVCAPS</B></A> structure.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="16dv39w.htm"><B>GetCommProperties</B></A></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
