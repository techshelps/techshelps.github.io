<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SetSystemPowerState</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="l1da37"></A><B>SetSystemPowerState  <A HREF="r043jy.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="xd3rtk.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="13h_3tt.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>SetSystemPowerState</B> function suspends the system by shutting power down. Depending on the <I>ForceFlag</I> parameter, the function either suspends operation immediately or requests permission from all applications and device drivers before doing so. </P>

<P><B>BOOL SetSystemPowerState(</B></P>

<TABLE cols=2 width=185>

<TR VALIGN="top">
<TD width=81%><B>BOOL</B> <I>fSuspend</I><B>,</B></TD>
<TD width=19%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=81%><B>    BOOL</B> <I>fForce</I></TD>
<TD width=19%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=81%><B>   );</B></TD>
<TD width=19%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>fSuspend</I></P>

<P>Suspension technique. If TRUE, the system suspends using RAM-alive technique. Otherwise, suspends using hibernate technique.</P>

<P><I>fForce</I></P>

<P>Forced suspension. If TRUE, the function sends a <A HREF="q98b9o.htm">PBT_APMSUSPEND</A> message to each application and driver, then immediately suspends operation. If FALSE, the function sends a <A HREF="6wjk0..htm">PBT_APMQUERYSUSPEND</A> message to each application to request permission to suspend operation. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If power has been suspended and subsequently restored, the return value is nonzero.</P>

<P>If the system was not suspended, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>If any application or driver denies permission to suspend operation, the function sends a PBT_APMQUERYSUSPENDFAILED message to each application and driver. If power is suspended, this function returns only after system operation is resumed and related WM_POWERBROADCAST messages have been sent to all applications and drivers. </P>

<P><B>See Also</B></P>

<P><A HREF="6wjk0..htm">PBT_APMQUERYSUSPEND</A>, <A HREF="1n8kix4.htm">PBT_APMQUERYSUSPENDFAILED</A>, <A HREF="q98b9o.htm">PBT_APMSUSPEND</A>, <A HREF="gcm3zp.htm">WM_POWERBROADCAST</A> </P>

</BODY>
</HTML>
