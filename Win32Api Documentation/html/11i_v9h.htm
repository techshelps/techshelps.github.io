<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Sharing Icon Resources</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="11i_v9h"></A><B>Sharing Icon Resources</B></P>

<P>The following code uses the functions<B> <A HREF="109rral.htm">CreateIconFromResourceEx</A></B>, <A HREF="g6f5fh.htm"><B>DrawIcon</B></A>, and <A HREF="14qk1pe.htm"><B>LookupIconIdFromDirectoryEx</B></A>, and several of the resource functions, to create an icon handle based on icon data from another executable file. Then, it displays the icon in a window. </P>

<P>HICON hIcon1;       // icon handle  </P>

<P>HINSTANCE hExe;     // handle to loaded .EXE file </P>

<P>HRSRC hResource;    // handle for FindResource  </P>

<P>HRSRC hMem;         // handle for LoadResource </P>

<P>BYTE *lpResource;   // address of resource data  </P>

<P>int nID;            // ID of resource that best fits current screen </P>

<P></P>

<P>HDC hdc;        // handle of display context </P>

<P></P>

<P>// Load the file from which to copy the icon. </P>

<P></P>

<P>hExe = LoadLibrary("myapp.exe"); </P>

<P></P>

<P>// Find the icon directory whose identifier is 440. </P>

<P></P>

<P>hResource = FindResource(hExe, </P>

<P>MAKEINTRESOURCE(440), </P>

<P>RT_GROUP_ICON); </P>

<P></P>

<P>// Load and lock the icon directory. </P>

<P></P>

<P>hMem = LoadResource(hExe, hResource); </P>

<P></P>

<P>lpResource = LockResource(hMem); </P>

<P></P>

<P>// Get the identifier of the icon that is most appropriate </P>

<P>// for the video display. </P>

<P></P>

<P>nID = LookupIconIdFromDirectoryEx((PBYTE) lpResource, TRUE, </P>

<P>CXICON, CYICON, LR_DEFAULTCOLOR); </P>

<P></P>

<P>// Find the bits for the nID icon. </P>

<P></P>

<P>hResource = FindResource(hExe, </P>

<P>MAKEINTRESOURCE(nID), </P>

<P>MAKEINTRESOURCE(RT_ICON)); </P>

<P></P>

<P>// Load and lock the icon. </P>

<P></P>

<P>hMem = LoadResource(hExe, hResource); </P>

<P></P>

<P>lpResource = LockResource(hMem); </P>

<P></P>

<P>// Create a handle to the icon. </P>

<P></P>

<P>hIcon1 = CreateIconFromResourceEx((PBYTE) lpResource, </P>

<P>SizeofResource(hExe, hResource), TRUE, 0x00030000, </P>

<P>CXICON, CYICON, LR_DEFAULTCOLOR); </P>

<P></P>

<P>// Draw the icon in the client area. </P>

<P></P>

<P>DrawIcon(hdc, 10, 20, hIcon1); </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
