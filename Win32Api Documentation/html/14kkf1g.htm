<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Window Procedure Superclassing</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="14kkf1g"></A><B>Window Procedure Superclassing</B></P>

<P><I>Superclassing</I> is a technique that allows an application to create a new window class with the basic functionality of the existing class, plus enhancements provided by the application. A superclass is based on an existing window class called the <I>base class</I>. Frequently, the base class is a system global window class such as an edit control, but it can be any window class. </P>

<P>A superclass has its own window procedure, called the superclass procedure. The <I>superclass procedure</I> can take three actions upon receiving a message: It can pass the message to the original window procedure, modify the message and pass it to the original window procedure, or process the message and not pass it to the original window procedure. If the superclass procedure processes a message, it can do so before, after, or both before and after it passes the message to the original window procedure. </P>

<P>Unlike a subclass procedure, a superclass procedure can process window creation messages (<A HREF="11ps3hu.htm">WM_NCCREATE</A>, <A HREF="2re1yt3.htm">WM_CREATE</A>, and so on), but it must also pass them to the original base-class window procedure so that the base-class window procedure can perform its initialization procedure. </P>

<P>To superclass a window class, an application first calls the <A HREF="h9ywp4.htm"><B>GetClassInfo</B></A> function to retrieve information about the base class. <B>GetClassInfo</B> fills a <A HREF="1onjoi2.htm"><B>WNDCLASS</B></A> structure with the values from the <B>WNDCLASS</B> structure of the base class. Next, the application copies its own instance handle into the <B>hInstance</B> member of the <B>WNDCLASS</B> structure and copies the name of the superclass into the <B>lpszClassName</B> member. If the base class has a menu, the application must provide a new menu with the same menu identifiers and copy the menu name into the <B>lpszMenuName</B> member. If the superclass procedure processes the <A HREF="71v.3j.htm">WM_COMMAND</A> message and does not pass it to the window procedure of the base class, the menu need not have corresponding identifiers. <B>GetClassInfo</B> does not return the <B>lpszMenuName</B>, <B>lpszClassName</B>, or <B>hInstance</B> member of the <B>WNDCLASS</B> structure. </P>

<P>An application must also set the <B>lpfnWndProc</B> member of the <B>WNDCLASS</B> structure. The <B>GetClassInfo</B> function fills this member with the address of the original window procedure for the class. The application must save this address, to pass messages to the original window procedure, and then copy the address of the superclass procedure into the <B>lpfnWndProc</B> member. The application can, if necessary, modify any other members of the <B>WNDCLASS</B> structure. After it fills the <B>WNDCLASS</B> structure, the application registers the superclass by passing the address of the structure to the <A HREF="6v_00hu.htm"><B>RegisterClass</B></A> function. The superclass can then be used to create windows. </P>

<P>Because superclassing registers a new window class, an application can add to both the extra class bytes and the extra window bytes. The superclass must not use the original extra bytes for the base class or the window for the same reasons that an instance subclass or a global subclass should not use them. Also, if the application adds extra bytes for its use to either the class or the window instance, it must reference the extra bytes relative to the number of extra bytes used by the original base class. Because the number of bytes used by the base class may vary from one version of the base class to the next, the starting offset for the superclass's own extra bytes may also vary from one version of the base class to the next. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
