<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Delayed Rendering3</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="2o41em"></A><B>Delayed Rendering</B></P>

<P>When placing a clipboard format on the clipboard, a window can delay rendering the data in that format until the data is needed. To do so, an application can specify NULL for the <I>hData</I> parameter of the <A HREF="1uhxs93.htm"><B>SetClipboardData</B></A> function. This is useful if the application supports several clipboard formats, some or all of which are time-consuming to render. By passing a NULL handle, a window renders complex clipboard formats only when and if they are needed. </P>

<P>If a window delays rendering a clipboard format, it must be prepared to render the format upon request for as long as it is the clipboard owner. The system sends the clipboard owner a <A HREF="3w7hwo.htm">WM_RENDERFORMAT</A> message when a request is received for a specific format that has not been rendered. Upon receiving this message, the window should call the <B>SetClipboardData</B> function to place a global memory handle on the clipboard in the requested format. </P>

<P>If the clipboard owner is destroyed and has delayed rendering some or all clipboard formats, it receives the <A HREF="a5oxdl.htm">WM_RENDERALLFORMATS</A> message. Upon receiving this message, the window should place valid memory handles on the clipboard for all clipboard formats that it provides. This ensures that these formats remain available after the clipboard owner is destroyed. </P>

<P>An application should not open the clipboard before calling <A HREF="1uhxs93.htm"><B>SetClipboardData</B></A> in response to the WM_RENDERFORMAT or WM_RENDERALLFORMATS message. </P>

<P>Any clipboard formats that are not rendered in response to the WM_RENDERALLFORMATS message cease to be available to other applications and are no longer enumerated by the clipboard functions. </P>

</BODY>
</HTML>
