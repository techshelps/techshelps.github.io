<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Modifying the New Submenu</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="18feo9n"></A><B>Modifying the New Submenu</B></P>

<P>The File menu in a file system folder contains a New submenu that, by default, includes the Shortcut and Folder commands. These commands allow the user to create new shortcuts and folders within the current folder. The New submenu can also include other nondefault commands that let the user create new files of various types within the current folder, such as sound files, text files, and bitmap files. For example, the New submenu might include a Sound command that creates a .WAV file in the current folder. </P>

<P>If your application creates a type of file that the user may want to create from within a file system folder, you should consider adding a command for it to the New submenu. For example, suppose you have created a graphics application that creates files with the .XYZ filename extension. You could add a command, such as XYZ Picture, that creates a new .XYZ file or launches your application and opens a new .XYZ file for editing.</P>

<P>You add a command to the New submenu by including a <B>ShellNew</B> key below the file association key for your filetype. When the system needs to create the New submenu, it searches through the file association entries for instances of the <B>ShellNew</B> key. When it finds an instance of <B>ShellNew</B>, the system retrieves the string associated with the application identifier key (xyzfile) and adds the string to the New submenu as a new command. Note that an Open command must be registered below the application identifier key; otherwise, the system does not add the Open command to the New submenu. </P>

<P>The following example shows the registry entries needed to add the XYZ Picture command to the New submenu.</P>

<P>HKEY_CLASSES_ROOT<BR>
    .xyz="xyzfile"<BR>
        ShellNew  </P>

<P>NullFile="" </P>

<P>. </P>

<P>. </P>

<P>. </P>

<P>xyzfile="XYZ Picture" </P>

<P>shell </P>

<P>open </P>

<P>command="C:\XYZ\XYZAPP.EXE %1 </P>

<P></P>

<P>The data names for the <B>ShellNew</B> key specify the method to use to create a new file of the type designated by the filename extension. There are four possible data names and values for the <B>ShellNew</B> key.</P>

<TABLE cols=3>

<TR VALIGN="top">
<TD width=15%><B>Data name</B></TD>
<TD width=21%><B>Value</B></TD>
<TD width=64%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=15%>NullFile</TD>
<TD width=21%>""</TD>
<TD width=64%>Creates an empty (null) file. If this data name is specified, Data and FileName are ignored.</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>Data </TD>
<TD width=21%><I>binary-value</I></TD>
<TD width=64%>Creates a file that contains the data specified by <I>binary-value</I>. This data name is ignored if either NullFile or FileName is specified.</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>FileName</TD>
<TD width=21%><I>path-name</I></TD>
<TD width=64%>Creates a copy of the file specified by <I>path-name</I>. This data name is ignored if NullFile is specified.</TD>
</TR>

<TR VALIGN="top">
<TD width=15%>Command</TD>
<TD width=21%><I>path-name</I></TD>
<TD width=64%>Executes the command specified by <I>path-name</I> when the file is created. For example, the command might start a wizard.</TD>
</TR>
</TABLE><BR>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
