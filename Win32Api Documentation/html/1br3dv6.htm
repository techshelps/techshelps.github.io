<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>RasSetSubEntryProperties [New - Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1br3dv6"></A><B>RasSetSubEntryProperties  <A HREF="i_zs38.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="35kj_0r.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="lrsi7i.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>[New - Windows NT]</P>

<P>The <B>RasSetSubEntryProperties</B> function creates a new subentry or modifies an existing subentry of a specified phone-book entry. </P>

<P><B>DWORD RasSetSubEntryProperties(</B></P>

<TABLE cols=3 width=1225>

<TR VALIGN="top">
<TD width=30%><B>LPTSTR</B> <I>lpszPhonebook</I><B>,</B></TD>
<TD width=31%>// pointer to full path and filename of phone-book file</TD>
<TD width=39%>// pointer to the full path and filename of the phone-book file</TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>    LPTSTR</B> <I>lpszEntry</I><B>,</B></TD>
<TD width=31%>// pointer to an entry name</TD>
<TD width=39%>// pointer to an entry name </TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>    DWORD</B> <I>dwSubEntry</I><B>,</B></TD>
<TD width=31%>// index of the subentry</TD>
<TD width=39%>//</TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>    LPRASSUBENTRY</B> <I>lpRasSubEntry</I><B>,</B></TD>
<TD width=31%>// pointer to structure containing information about subentry</TD>
<TD width=39%>// </TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>    DWORD</B> <I>dwcb</I></TD>
<TD width=31%>// size, in bytes, of the structure</TD>
<TD width=39%>//</TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>   );</B></TD>
<TD width=31%>&nbsp;</TD>
<TD width=39%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpszPhonebook</I></P>

<P><B>Windows NT: </B>Pointer to a null-terminated string that specifies the full path and filename of a phone-book (.PBK) file. If this parameter is NULL, the function uses the current default phone-book file. The default phone-book file is the one selected by the user in the <B>User Preferences</B> property sheet of the <B>Dial-Up Networking</B> dialog box.</P>

<P><I>lpszEntry</I></P>

<P>Pointer to a null-terminated string containing the name of an existing entry in the phone book.</P>

<P><I>dwSubEntry</I></P>

<P>Specifies the one-based index of the subentry. If the index matches an existing subentry index, the function changes the properties of that subentry. If the index does not match an existing index, the function creates a new subentry.</P>

<P><I>lpRasSubEntry</I></P>

<P>Pointer to a <A HREF="1nznwsp.htm"><B>RASSUBENTRY</B></A> structure that contains the data for the subentry. </P>

<P>The structure might be followed by an array of null-terminated alternate phone number strings. The last string is terminated by two consecutive null characters. The <B>dwAlternateOffset</B> member of the <B>RASSUBENTRY</B> structure contains the offset to the first string.</P>

<P><I>dwcb</I></P>

<P>Specifies the size, in bytes, of the <I>lpRasSubEntry</I> buffer.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is zero.</P>

<P>If the function fails, the return value can be one of the following error codes. </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=64%><B>Value</B></TD>
<TD width=36%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=64%>ERROR_BUFFER_INVALID</TD>
<TD width=36%>The address or buffer specified by <I>lpRasEntry </I>is invalid.</TD>
</TR>

<TR VALIGN="top">
<TD width=64%>ERROR_CANNOT_FIND_PHONEBOOK_ENTRY</TD>
<TD width=36%>The phone-book entry does not exist.</TD>
</TR>

<TR VALIGN="top">
<TD width=64%>ERROR_CANNOT_OPEN_PHONEBOOK</TD>
<TD width=36%>The phone book is corrupted or missing components.</TD>
</TR>

<TR VALIGN="top">
<TD width=64%>ERROR_INVALID_PARAMETER </TD>
<TD width=36%>The function was called with an invalid parameter.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>A RAS phone-book entry can have zero or more subentries, each minimally consisting of a device and a phone number. A phone-book entry with multiple subentries can be configured to dial either the first available subentry or all subentries when the entry is dialed.</P>

<P>Use the <B>RasGetEntryProperties</B> function to retrieve a <B>RASENTRY</B> structure containing information about the subentries of a phone-book entry. The <B>dwSubEntries</B> member indicates the number of subentries and the <B>dwDialMode</B> member indicates the dialing configuration.</P>

<P><B>See Also</B></P>

<P><A HREF="3rcv.yk.htm"><B>RasGetEntryProperties</B></A>, <A HREF="vji5sp.htm"><B>RASENTRY</B></A>, <A HREF="1nznwsp.htm"><B>RASSUBENTRY</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
