<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ReplaceText</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1s0xwwr"></A><B>ReplaceText  <A HREF="42_s3bu.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="y3i0nj.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="_grvj7.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>ReplaceText</B> function creates a system-defined modeless dialog box that lets the user specify a string to search for and a replacement string, as well as options to control the find and replace operations.</P>

<P><B>HWND ReplaceText(</B></P>

<TABLE cols=2 width=467>

<TR VALIGN="top">
<TD width=39%><B>LPFINDREPLACE</B> <I>lpfr</I> </TD>
<TD width=61%>// pointer to structure with initialization data</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>   );</B></TD>
<TD width=61%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpfr</I></P>

<P>Pointer to a <A HREF="1de83do.htm"><B>FINDREPLACE</B></A> structure that contains information used to initialize the dialog box. The dialog box uses this structure to send information about the user's input to your application. For more information, see the following Remarks section.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is the window handle to the dialog box. You can use the window handle to communicate with the dialog box or close it. </P>

<P>If the function fails, the return value is NULL. To get extended error information, call the <A HREF="12gq63s.htm"><B>CommDlgExtendedError</B></A> function, which can return one of the following error codes: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=49%>CDERR_FINDRESFAILURE</TD>
<TD width=51%>CDERR_MEMLOCKFAILURE</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>CDERR_INITIALIZATION</TD>
<TD width=51%>CDERR_NOHINSTANCE</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>CDERR_LOADRESFAILURE</TD>
<TD width=51%>CDERR_NOHOOK</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>CDERR_LOADSTRFAILURE</TD>
<TD width=51%>CDERR_NOTEMPLATE</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>CDERR_LOCKRESFAILURE</TD>
<TD width=51%>CDERR_STRUCTSIZE</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>CDERR_MEMALLOCFAILURE</TD>
<TD width=51%>FRERR_BUFFERLENGTHZERO</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>The <B>ReplaceText</B> function does not perform a text replacement operation. Instead, the dialog box sends <A HREF="gy41ze.htm">FINDMSGSTRING</A> registered messages to the window procedure of the owner window of the dialog box. When you create the dialog box, the <B>hwndOwner</B> member of the <B>FINDREPLACE</B> structure identifies the owner window. </P>

<P>Before calling <B>ReplaceText</B>, you must call the <A HREF="xkgsv4.htm"><B>RegisterWindowMessage</B></A> function to get the identifier for the FINDMSGSTRING message. The dialog box procedure uses this identifier to send messages when the user clicks the Find Next, Replace, or Replace All buttons, or when the dialog box is closing. The <I>lParam</I> parameter of a FINDMSGSTRING message contains a pointer to the <A HREF="1de83do.htm"><B>FINDREPLACE</B></A> structure. The <B>Flags</B> member of this structure indicates the event that caused the message. Other members of the structure indicate the user's input.</P>

<P>If you create a Replace dialog box, you must also use the <A HREF="3mdxb3e.htm"><B>IsDialogMessage</B></A> function in the main message loop of your application to ensure that the dialog box correctly processes keyboard input, such as the TAB and ESC keys. The <B>IsDialogMessage</B> function returns a value that indicates whether the Replace dialog box processed the message. </P>

<P>You can provide an <A HREF="13618ab.htm"><B>FRHookProc</B></A> hook procedure for a Replace dialog box. The hook procedure can process messages sent to the dialog box. To enable a hook procedure, set the FR_ENABLEHOOK flag in the <B>Flags</B> member of the <B>FINDREPLACE</B> structure and specify the address of the hook procedure in the <B>lpfnHook</B> member. </P>

<P><B>See Also</B></P>

<P><A HREF="12gq63s.htm"><B>CommDlgExtendedError</B></A>,<B> <A HREF="1de83do.htm">FINDREPLACE</A></B>, <A HREF="13618ab.htm"><B>FRHookProc</B></A>, <A HREF="3mdxb3e.htm"><B>IsDialogMessage</B></A>, <A HREF="xkgsv4.htm"><B>RegisterWindowMessage</B></A>, <A HREF="jye6cz.htm">WM_CTLCOLORDLG</A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
