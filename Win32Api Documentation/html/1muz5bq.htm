<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Creating and Opening Files</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1muz5bq"></A><B>Creating and Opening Files</B></P>

<P>You can use the <A HREF="xn35yd.htm"><B>CreateFile</B></A> function to create a new file or open an existing file. You must specify the filename, preferred access, share mode, creation instructions, and attributes. </P>

<P>In the following example, <A HREF="xn35yd.htm"><B>CreateFile</B></A> opens an existing file for reading. </P>

<P>HANDLE hFile;  </P>

<P></P>

<P>hFile = CreateFile("MYFILE.TXT",           // open MYFILE.TXT </P>

<P>GENERIC_READ,              // open for reading </P>

<P>FILE_SHARE_READ,           // share for reading </P>

<P>NULL,                      // no security </P>

<P>OPEN_EXISTING,             // existing file only </P>

<P>FILE_ATTRIBUTE_NORMAL,     // normal file </P>

<P>NULL);                     // no attr. template </P>

<P></P>

<P>if (hFile == INVALID_HANDLE_VALUE) { </P>

<P>ErrorHandler("Could not open file.");   /* process error */ </P>

<P>} </P>

<P></P>

<P>In this example, <A HREF="xn35yd.htm"><B>CreateFile</B></A> succeeds only if a file named MYFILE.TXT already exists in the current directory. An application should check the return value of <B>CreateFile</B> before attempting to use the handle to access the file. If an error occurs, the application should use the <A HREF="11c2vs7.htm"><B>GetLastError</B></A> function to get extended error information and respond accordingly. </P>

<P>A file must be closed before it can be deleted. The following lines close and delete the MYFILE.TXT file. </P>

<P>CloseHandle(hFile);  </P>

<P>DeleteFile("MYFILE.TXT"); </P>

<P></P>

<P>In the following example, <A HREF="xn35yd.htm"><B>CreateFile</B></A> creates a new file and opens it for writing. </P>

<P>HANDLE hFile;  </P>

<P></P>

<P>hFile = CreateFile("MYFILE.TXT",           // create MYFILE.TXT </P>

<P>GENERIC_WRITE,                // open for writing </P>

<P>0,                            // do not share </P>

<P>NULL,                         // no security </P>

<P>CREATE_ALWAYS,                // overwrite existing </P>

<P>FILE_ATTRIBUTE_NORMAL |       // normal file </P>

<P>FILE_FLAG_OVERLAPPED,         // asynchronous I/O </P>

<P>NULL);                        // no attr. template </P>

<P>if (hFile == INVALID_HANDLE_VALUE) { </P>

<P>ErrorHandler("Could not open file.");  // process error </P>

<P>} </P>

<P></P>

<P>In addition to the standard attributes (read only, hidden, system, and so on), you can also specify security attributes by including a pointer to a <A HREF="be53kg.htm"><B>SECURITY_ATTRIBUTES</B></A> structure as the fourth parameter. However, the underlying file system must support security for these attributes for them to have any effect. For more information about security, see <A HREF="1966ja.htm">Security</A>. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
