<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>MapFileAndCheckSumA</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1jdo42j"></A><B>MapFileAndCheckSumA  <A HREF="c16hbv.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>MapFileAndCheckSumA</B> function computes the checksum of an image file.</P>

<P><B>ULONG MapFileAndCheckSumA(</B></P>

<TABLE cols=2 width=263>

<TR VALIGN="top">
<TD width=87%><B>IN LPSTR </B><I>Filename</I><B>,</B></TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=87%><B>    OUT LPDWORD </B><I>HeaderSum</I><B>,</B></TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=87%><B>    OUT LPDWORD </B><I>CheckSum</I></TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=87%><B>   );</B></TD>
<TD width=13%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>Filename</I></P>

<P>The filename of the file for which the checksum is to be computed.</P>

<P><I>HeaderSum</I></P>

<P>A pointer to a variable that receives the original checksum from the image file, or zero if there is an error.</P>

<P><I>CheckSum</I></P>

<P>A pointer to the variable that receives the computed checksum.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is CHECKSUM_SUCCESS.</P>

<P>If the function fails, then the return value is one of the following:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=52%><B>Value</B></TD>
<TD width=48%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=52%>CHECKSUM_OPEN_FAILURE </TD>
<TD width=48%>Could not open the file.</TD>
</TR>

<TR VALIGN="top">
<TD width=52%>CHECKSUM_MAP_FAILURE </TD>
<TD width=48%>Could not create the file mapping for the file.</TD>
</TR>

<TR VALIGN="top">
<TD width=52%>CHECKSUM_MAPVIEW_FAILURE </TD>
<TD width=48%>Could not map a view of the file.</TD>
</TR>

<TR VALIGN="top">
<TD width=52%>CHECKSUM_UNICODE_FAILURE </TD>
<TD width=48%>Could not convert the filename to UNICODE.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>A new checksum for the file is computed and returned in the <I>CheckSum</I> parameter. This function is used by any application that creates or modifies an executable image. Checksums are required for Windows NT kernel mode drivers and some system DLLs. The Win32 linker computes the original checksum at link time, if the linker switch for checksumming is turned on. It is recommended that all images have valid checksums.</P>

</BODY>
</HTML>
