<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Creating an Animation Control</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="33xw0j8"></A><B>Creating an Animation Control</B></P>

<P>The following function creates an animation control in a dialog box. The animation control is positioned below the specified control, and the dimensions of the animation control are based on the dimensions of a frame in the AVI clip. </P>

<P>// CreateAnimationCtrl - creates an animation control, positions it  </P>

<P>//     below the specified control in a dialog box, and opens the AVI </P>

<P>//     clip for the animation control. </P>

<P>// Returns the handle to the animation control. </P>

<P>// hwndDlg - handle to the dialog box </P>

<P>// nIDCtl - identifier of the control below which the animation control </P>

<P>//     is to be positioned </P>

<P>// </P>

<P>// Constants </P>

<P>//     IDC_ANIMATE - identifier of the animation control </P>

<P>//     CX_FRAME, CY_FRAME - width and height of the frames </P>

<P>//         in the AVI clip </P>

<P>HWND CreateAnimationCtrl(HWND hwndDlg, int nIDCtl) </P>

<P>{ </P>

<P>HWND hwndAnim = NULL; </P>

<P>RECT rc; </P>

<P>POINT pt; </P>

<P></P>

<P>// Create the animation control. </P>

<P>hwndAnim = Animate_Create(hwndDlg, IDC_ANIMATE, </P>

<P>WS_BORDER | WS_CHILD, g_hinst); </P>

<P></P>

<P>// Get the screen coordinates of the specified control button. </P>

<P>GetWindowRect(GetDlgItem(hwndDlg, nIDCtl), &amp;rc); </P>

<P></P>

<P>// Convert the coordinates of the lower-left corner to </P>

<P>// client coordinates. </P>

<P>pt.x = rc.left; </P>

<P>pt.y = rc.bottom; </P>

<P>ScreenToClient(hwndDlg, &amp;pt); </P>

<P></P>

<P>// Position the animation control below the Stop button. </P>

<P>SetWindowPos(hwndAnim, 0, pt.x, pt.y + 20, </P>

<P>CX_FRAME, CY_FRAME, </P>

<P>SWP_NOZORDER | SWP_DRAWFRAME); </P>

<P></P>

<P>// Open the AVI clip, and show the animation control. </P>

<P>Animate_Open(hwndAnim, "SEARCH"); </P>

<P>ShowWindow(hwndAnim, SW_SHOW); </P>

<P></P>

<P>return hwndAnim; </P>

<P>} </P>

<P></P>

</BODY>
</HTML>
