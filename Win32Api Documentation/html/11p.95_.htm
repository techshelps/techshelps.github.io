<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Print Dialog Box</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="11p.95_"></A><B>Print Dialog Box</B></P>

<P>The Print dialog box lets the user select options for a particular print job. For example, the user can specify the printer to use, the range of pages to print, and the number of copies. </P>

<P>You create and display a Print dialog box by initializing a <A HREF="17iw9wo.htm"><B>PRINTDLG</B></A> structure and passing the structure to the <A HREF="11768vz.htm"><B>PrintDlg</B></A> function. </P>

<P>The following illustration shows a typical Print dialog box.</P>

<P><IMG SRC="../images/bm13.gif" ALT="" BORDER=0></P>

<P>If the user clicks the OK button, <A HREF="11768vz.htm"><B>PrintDlg</B></A> returns TRUE and uses the <A HREF="17iw9wo.htm"><B>PRINTDLG</B></A> structure to return information about the user's selections. For example, the <B>hDevMode</B> and <B>hDevNames</B> members typically return global memory handles for <A HREF="1bkrzj1.htm"><B>DEVMODE</B></A> and <A HREF="9vt77_.htm"><B>DEVNAMES</B></A> structures. You can use the information in these structures to create a device context or an information context for the selected printer. </P>

<P>If the user cancels the Print dialog box or an error occurs, <B>PrintDlg</B> returns FALSE. You can determine the cause of an error by using the <A HREF="12gq63s.htm"><B>CommDlgExtendedError</B></A> function to retrieve the extended error value. </P>

<P>The Print dialog box includes a Print Range group of radio buttons that indicate whether the user wants to print all pages, a range of pages, or only the selected text. Before calling <B>PrintDlg</B>, you can set one of the PD_ALLPAGES, PD_SELECTION, or PD_PAGENUMS flags to indicate which button is initially selected. When <A HREF="11768vz.htm"><B>PrintDlg</B></A> returns TRUE, the function sets one of these flags to indicate the user's selections. If PD_PAGENUMS is set, the <B>nFromPage</B> and <B>nToPage</B> members of the <A HREF="17iw9wo.htm"><B>PRINTDLG</B></A> structure contain the starting and ending pages specified by the user. To disable the Pages radio button and its associated "From:" and "To:" edit controls, set the PD_NOPAGENUMS flag. To disable the Selection radio button, set the PD_NOSELECTION flag.</P>

<P>The dialog box includes an edit control in which the user can type the number of copies to print. If the <B>hDevMode</B> member of the <B>PRINTDLG</B> structure is non-NULL, the <B>dmCopies</B> member of the <A HREF="1bkrzj1.htm"><B>DEVMODE</B></A> structure specifies the initial value for this edit control. If <B>hDevMode</B> is NULL, the <B>nCopies</B> member of the <B>PRINTDLG</B> structure specifies the initial value. When <B>PrintDlg</B> returns, <B>nCopies</B> typically indicates the number of copies specified by the user. However, if you set the PD_USEDEVMODECOPIESANDCOLLATE flag when you create the dialog box, <B>nCopies</B> is always set to 1 on return and the <B>dmCopies</B> member of <B>DEVMODE</B> indicates the number of copies to print. </P>

<P>The Collate check box indicates whether the user wants to collate the pages if multiple copies are being printed. The PD_COLLATE flag is set if the Collate check box is checked. If your application does not support multiple copies or simulated collation, set the PD_USEDEVMODECOPIESANDCOLLATE flag in the <B>Flags</B> member of the <A HREF="17iw9wo.htm"><B>PRINTDLG</B></A> structure. This disables the Collate check box and the "Number of Copies:" edit control unless the printer driver supports multiple copies and collation.</P>

<P>The Print To File check box indicates whether the user wants to send output to a file rather than to a printer. You can set the PD_PRINTTOFILE flag so the check box is initially checked. To hide the check box, set the PD_HIDEPRINTTOFILE flag. To disable it, set the PD_DISABLEPRINTTOFILE flag. If the user selects the Print To File option, <A HREF="11768vz.htm"><B>PrintDlg</B></A> sets the PD_PRINTTOFILE flag and returns "FILE:" at the offset indicated by the <B>wOutputOffset</B> member of the <A HREF="9vt77_.htm"><B>DEVNAMES</B></A> structure. When you call the <A HREF="231v06s.htm"><B>StartDoc</B></A> function to start the printing operation, specify this "FILE:" string in the <B>lpszOutput</B> member of the <A HREF="3kadk3.htm"><B>DOCINFO</B></A> structure. Specifying this string causes the print subsystem to query the user for the name of the output file. </P>

<P>By default, the Print dialog box initially displays information about the current default printer. You can direct it to display information for another installed printer by initializing a <A HREF="1bkrzj1.htm"><B>DEVMODE</B></A> or <B>DEVNAMES</B> structure and assigning the global memory handle for the structure to the <B>hDevMode</B> or <B>hDevNames</B> member. The device name you specify in the <B>dmDeviceName</B> member of the <B>DEVMODE</B> structure or in the <B>wDriverOffset</B> member of the <B>DEVNAMES</B> structure must identify a printer device that is also listed in the [Devices] section of the WIN.INI file. If the device is not listed, <B>PrintDlg</B> returns an error.</P>

<P>You can direct <A HREF="11768vz.htm"><B>PrintDlg</B></A> to create a device context or information context for the printer by setting the PD_RETURNDC or PD_RETURNIC flag in the <B>Flags</B> member of the <A HREF="17iw9wo.htm"><B>PRINTDLG</B></A> structure. The function returns the handle of the device context or information context in the <B>hDC</B> member. If you use the PD_RETURNDC flag, you can use the device context to generate output for the printer. </P>

<P>To retrieve information about the default printer without displaying the Print dialog box, set the PD_RETURNDEFAULT flag. In this case, <A HREF="11768vz.htm"><B>PrintDlg</B></A> returns immediately after setting the <B>hDevMode</B> and <B>hDevNames</B> members to handles for structures containing the information.</P>

<P>By default, <B>PrintDlg</B> displays message boxes when errors occur. For example, the function displays an error message if no printers are installed. To prevent the function from displaying these warning messages, set the PD_NOWARNING flag. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
