<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Subdocumentst</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="6a_prk"></A><B>Subdocuments</B></P>

<P>The file parser adds subdocuments ¾ that is, headers, footers, footnotes, and comments ¾ to the document by using the <A HREF="3hla_lt.htm"><B>SOPutBreak</B></A> function. The file parser must call <B>SOPutBreak</B> with the SO_SUBDOCBEGINBREAK value to start a subdocument and with the SO_SUBDOCENDBREAK value to end it. </P>

<P>After ending a subdocument, the file parser must restore character and paragraph attributes to their state before the subdocument was started. The file parser can use the <A HREF="1qsl_uu.htm"><B>SUUserPushData</B></A> and <A HREF="12zn9yl.htm"><B>SUUserPopData</B></A> functions to save and restore nested subdocument information. A parser can nest subdocuments without limit. The following example shows when to save and restore this information.</P>

<P>This is a &lt;Bold On&gt; <B>test<BR>
</B><BR>
    // At this point, the filter should save its internal <BR>
    // information to reflect the fact that bold is on.<BR>
    SOPutBreak(SO_SUBDOCBEGINBREAK);<BR>
    SoPutSubdocInfo(...);<BR>
&lt;Subdoc Begin&gt; <B>This is a </B>&lt;Bold Off&gt;subdocument&lt;Subdoc End&gt;<BR>
<BR>
    // At this point, the filter should restore its internal <BR>
    // information to reflect the fact that bold is on.<BR>
    SOPutBreak(SO_SUBDOCENDBREAK);<BR>
<BR>
<B>document </B>&lt;Bold Off&gt;of mine. <BR>
 </P>

<P>File parsers are not expected to correctly exit a subdocument when run from a regular paragraph break (with the SO_PARABREAK value) inside the subdocument. The display engine lets the file parser run to the subdocument's end break (that is, the SO_SUBDOCENDBREAK value) and returns the SO_STOP value to it.</P>

</BODY>
</HTML>
