<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Font Creation and Selection</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="dw6ecp"></A><B>Font Creation and Selection</B></P>

<P>Previous versions of Windows required that the application developer provide source code and a dialog box template to support an interface that displayed the available fonts from which the user could choose. The new Font common dialog box simplifies the creation and selection process. By initializing the <A HREF="5awy_t0.htm"><B>CHOOSEFONT</B></A> structure and calling the <A HREF="1c8v_vz.htm"><B>ChooseFont</B></A> function, an application can support the same font-selection interface that previously required many lines of code. (For more information about the Font common dialog box, see <A HREF="y3i0nj.htm">Common Dialog Box Library</A>.)</P>

<P><B>Selection by the User</B></P>

<P>Most font creation and selection operations involve the user. For example, word processing applications let the user select unique fonts for headings, footnotes, and body text. After the user selects a font by using the Font dialog box and presses the OK button, the <A HREF="1c8v_vz.htm"><B>ChooseFont</B></A> function initializes the members of a <A HREF="5m4itk.htm"><B>LOGFONT</B></A> structure with the attributes of the requested font. To use this font for text-output operations, an application must first create a logical font and then select that font into its device context. A <I>logical font</I> is an application-supplied description of an ideal font. A developer can create a logical font by calling the <A HREF="3lh808_.htm"><B>CreateFont</B></A> or the <A HREF="zy._9a.htm"><B>CreateFontIndirect</B></A> functions. In this case, the application would call <B>CreateFontIndirect</B> and supply a pointer to the <B>LOGFONT</B> structure initialized by <B>ChooseFont</B>. In general, it is more efficient to call <B>CreateFontIndirect</B> because <B>CreateFont</B> requires several parameters while <B>CreateFontIndirect</B> requires only one ¾ a pointer to <B>LOGFONT</B>. </P>

<P>Before an application can actually begin drawing text with a logical font, it must find the closest match from the fonts stored internally on the device and the fonts whose resources have been loaded into the operating system. The fonts stored on the device or in the operating system are called <I>physical fonts</I>. The process of finding the physical font that most closely matches a specified logical font is called font mapping. This process occurs when an application calls the <A HREF="4n4gw4.htm"><B>SelectObject</B></A> function and supplies a handle identifying a logical font. Font mapping is performed by using an internal algorithm that compares the attributes of the requested logical font against the attributes of available physical fonts. When the font mapper algorithm completes its search and determines the closest possible match, the <B>SelectObject</B> function returns and the application can begin drawing text with the new font. </P>

<P>The <A HREF="fa9bq8.htm"><B>SetMapperFlags</B></A> function specifies whether or not the font mapper algorithm searches only for physical fonts with aspect ratios that match the physical device. The aspect ratio for a device is the ratio formed by the width and the height of a pixel on that device. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
