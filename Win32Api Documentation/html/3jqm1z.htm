<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>IFileViewer Interface</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="3jqm1z"></A><B>IFileViewer<I> </I>Interface</B></P>

<P>The shell uses the <A HREF="33s7zao.htm"><B>IFileViewer</B></A> interface to tell a file viewer object when to show its user interface for the file being viewed or to print the file. In addition to the usual <B>IUnknown</B><I> </I>members, the interface includes the <B>ShowInitialize</B>, <B>Show</B>, and <B>PrintTo</B> member functions. </P>

<P>Before calling the <B>Show</B> member function, the shell calls <B>ShowInitialize</B> to instruct the file viewer to perform any creations, allocations, or loading. <B>ShowInitialize</B> may fail, whereas <B>Show</B> may not because Quick View needs to know, before anything becomes visible and before transferring control to the file viewer, whether the file viewer can show the file. If the file viewer can show the file, Quick View hides its Searching dialog box before the file viewer window appears.</P>

<P>The <B>ShowInitialize</B> member function should return the same FV_ error codes listed in the topic <A HREF="kc1ql9.htm">Structure of Registry Entries</A>. Although the sample file viewer included in the Win32 SDK uses a more generic form of error codes, new file viewer DLLs should use the FV_ form.</P>

<P>The <B>Show</B> member function is similar to the Windows <A HREF="3mejbzs.htm"><B>ShowWindow</B></A> function in that it receives a Show command indicating how the file viewer should initially display its window. The meaning of the Show command is exactly the same as for <B>ShowWindow</B>. In general, Quick View passes the Show command from its <A HREF="12si984.htm"><B>WinMain</B></A> function directly to <B>IFileViewer::Show</B>,<I> </I>which passes the command to <B>ShowWindow</B><I>.</I> Since Quick View obtains this parameter from the shell, this design enables the shell to open a file viewer in the minimized, normal, or maximized state and even allows the shell to hide a file viewer (with the SW_HIDE value). There is no extra overhead in providing this flexibility. Note that the Windows 95 shell always starts Quick View with the SW_SHOWNORMAL value.</P>

<P>The only case when <B>Show</B> may fail is if <B>ShowInitialize</B><I> </I>has not been called. In that case, it returns the E_UNEXPECTED status code (SCODE). Otherwise, <B>Show</B> must return the NOERROR error code.</P>

<P>The <B>PrintTo</B> member function is like <B>Show</B> in that it does not return until it finishes printing or an error occurs. If an error occurs, the file viewer object is responsible for informing the user of the problem. When calling <B>PrintTo</B>, the shell specifies the name of the printer driver that the file viewer should use to print the file. The shell also specifies a flag that indicates whether the file viewer should display any UI elements, including error message, during the print operation. If the flag is FALSE, the file viewer may show Print dialog boxes, Printer Setup dialog boxes, error messages, and so on. </P>

<P>The interface identifier of <A HREF="33s7zao.htm"><B>IFileViewer</B></A> is defined in the Windows header files as the IID_IFileViewer interface identifier. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
