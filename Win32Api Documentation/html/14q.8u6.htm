<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Creating a File Manager Extension</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="14q.8u6"></A><B>Creating a File Manager Extension</B></P>

<P>A File Manager extension must reside in a DLL that includes a standard entry point, the <A HREF="1bvwzve.htm"><B>FMExtensionProc</B></A> callback function. The extension must include the WFEXT.H header file that defines File Manager messages and structures. File Manager communicates with the extension DLL by sending the following messages to the DLL's <B>FMExtensionProc</B> function. </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=42%><B>Message</B></TD>
<TD width=58%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=42%>1-99</TD>
<TD width=58%>User has selected an item from the extension-supplied menu. The value is the identifier of the selected menu item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>FMEVENT_HELPSTRING</TD>
<TD width=58%>User is selecting an extension menu or toolbar command item. File Manager wants the extension to supply a helpstring.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>FMEVENT_HELPMENUITEM</TD>
<TD width=58%>User has pressed F1 while selecting an extension menu or toolbar command item. File Manager wants the extension to call <A HREF="1p1p.rf.htm"><B>WinHelp</B></A> appropriately for the command item.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>FMEVENT_INITMENU</TD>
<TD width=58%>User has selected the extension's menu. The extension should initialize items in the menu.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>FMEVENT_LOAD</TD>
<TD width=58%>File Manager is loading the extension DLL and prompts the DLL for information about the menu that the DLL supplies.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>FMEVENT_SELCHANGE</TD>
<TD width=58%>Selection in the File Manager directory window or Search Results window has changed.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>FMEVENT_TOOLBARLOAD</TD>
<TD width=58%>File Manager is creating the toolbar and prompts the extension DLL for information about any buttons the DLL adds to the toolbar.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>FMEVENT_UNLOAD</TD>
<TD width=58%>File Manager is unloading the extension DLL.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>FMEVENT_USER_REFRESH</TD>
<TD width=58%>User has chosen the Refresh command from the Window menu. The extension should update items in the menu, if necessary.</TD>
</TR>
</TABLE><BR>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
