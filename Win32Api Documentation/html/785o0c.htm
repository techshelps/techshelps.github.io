<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WM_SETTINGCHANGE</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="785o0c"></A><B>WM_SETTINGCHANGE  <A HREF="3g46eg.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1p1lg2i.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="2n04rtj.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The system sends the WM_SETTINGCHANGE message to all top-level windows when the <A HREF="flzd_g.htm"><B>SystemParametersInfo</B></A> function changes a system-wide setting. The system sends this message only if the <B>SystemParametersInfo</B> caller specifies the SPIF_SENDCHANGE flag.</P>

<P>An application can send WM_SETTINGCHANGE to all top-level windows when it makes changes to system parameters. For example, you can send this message after a call to the <A HREF=".5x90f.htm"><B>WriteProfileString</B></A>, <A HREF="4_9a0oj.htm"><B>WriteProfileSection</B></A>, or <A HREF="bph0ra.htm"><B>SetLocaleInfo</B></A> functions, or after making changes to system parameters in the registry.</P>

<P>The WM_SETTINGCHANGE message is the same as the older WM_WININICHANGE message.</P>

<P>WM_SETTINGCHANGE  </P>

<P>wParam = wFlag;                         // system-wide parameter flag </P>

<P>lParam = (LPARAM) (LPCTSTR) pszSection; // name of changed section or registry</P>

<P></P>

<P><B>Parameters</B></P>

<P><I>wFlag</I></P>

<P>Value of <I>wParam</I>. When the system sends the message as a result of a <A HREF="flzd_g.htm"><B>SystemParametersInfo</B></A> call, this parameter is a flag that indicates the system parameter that was changed. For a list of values, see the <B>SystemParametersInfo</B> function.</P>

<P>When an application sends the message, this parameter must be NULL. </P>

<P><I>pszMetrics</I></P>

<P>Value of <I>lParam</I>. Pointer to a string that indicates the area containing the system parameter that was changed. For example, this string can be the name of a registry key or the name of a section in the WIN.INI file. </P>

<P>This parameter is not particularly useful in determining which system parameter changed. For example, when the string is a registry name, it typically indicates only the leaf node in the registry, not the whole path. In addition, some applications send this message with <I>lParam</I> set to NULL. In general, when you receive this message, you should check and reload any system parameter settings that are used by your application.</P>

<P><B>Return Values</B></P>

<P>If you process this message, return zero.</P>

<P><B>Remarks</B></P>

<P>To send the WM_SETTINGCHANGE message to all top-level windows, use the <A HREF="1724msn.htm"><B>SendMessage</B></A> function with the <I>hwnd</I> parameter set to HWND_BROADCAST. </P>

<P>Calls to functions that change the WIN.INI file might be mapped to the registry instead. This mapping occurs when the WIN.INI file and the section being changed are specified in the registry under the following keys: </P>

<P><B>HKEY_LOCAL_MACHINE</B>\<B>Software</B>\<B>Microsoft</B>\<BR>
        <B>Windows NT</B>\<B>CurrentVersion</B>\<B>IniFileMapping</B></P>

<P>The change in the storage location has no effect on the behavior of this message. </P>

<P><B>See Also</B></P>

<P><A HREF="1724msn.htm"><B>SendMessage</B></A>, <A HREF="bph0ra.htm"><B>SetLocaleInfo</B></A>, <A HREF="flzd_g.htm"><B>SystemParametersInfo</B></A>, <A HREF="2s_lyu.htm">WM_WININICHANGE</A>, <A HREF="4_9a0oj.htm"><B>WriteProfileSection</B></A>, <A HREF=".5x90f.htm"><B>WriteProfileString</B></A> </P>

<P></P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
