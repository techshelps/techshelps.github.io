<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WM_DDE_POKE</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="59onr."></A><B>WM_DDE_POKE  <A HREF="1jxd2sk.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="w3rlry.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="00i2ql.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>A DDE client application posts a WM_DDE_POKE message to a DDE server application. A client uses this message to request the server to accept an unsolicited data item. The server is expected to reply with a <A HREF="9k0..a.htm">WM_DDE_ACK</A> message indicating whether it accepted the data item. </P>

<P>WM_DDE_POKE  </P>

<P>wParam = (WPARAM) hwnd;        // handle of posting application </P>

<P>lParam = (LPARAM) lPackedVal;  // packed DDEPOKE and item atom </P>

<P></P>

<P><B>Parameters</B></P>

<P><I>hwnd</I></P>

<P>Value of <I>wParam</I>. Identifies the client window posting the message. </P>

<P><I>lPackedVal</I></P>

<P>Value of <I>lParam</I>. The component parameters that are packed into <I>lPackedVal</I> are extracted by calling the <A HREF="51wgiv.htm"><B>UnpackDDElParam</B></A> function. The low-order word is <I>hData</I>. The high-order word is <I>aItem</I>. </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=22%><B>Parameter</B></TD>
<TD width=78%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=22%>hData</TD>
<TD width=78%>Identifies a global memory object containing a <A HREF="ke_nj2.htm"><B>DDEPOKE</B></A> structure with the data and additional information. </TD>
</TR>

<TR VALIGN="top">
<TD width=22%>aItem</TD>
<TD width=78%>Contains a global atom that identifies the data item for which the data or notification is being sent.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P><B>Posting</B> </P>

<P>The client application posts the WM_DDE_POKE message by using the <A HREF="fixdt_.htm"><B>PostMessage</B></A> function. </P>

<P>The client application must allocate memory for the <I>hData</I> object by using the <A HREF="f12w9..htm"><B>GlobalAlloc</B></A> function with the GMEM_DDESHARE option. The client application must delete the <I>hData</I> object if either of the following conditions is true: </P>

<P>·The server application responds with a negative <A HREF="9k0..a.htm">WM_DDE_ACK</A> message. </P>

<P>·The <B>fRelease</B> member is FALSE, but the server application responds with either a positive or negative WM_DDE_ACK. </P>

<P></P>

<P>The client application must create the <I>aItem</I> atom by using the <A HREF="1qh2cm4.htm"><B>GlobalAddAtom</B></A> function. </P>

<P>The client application must create or reuse the WM_DDE_POKE <I>lPackedVal</I> parameter by calling the <A HREF="1_gbv6y.htm"><B>PackDDElParam</B></A> function or the <A HREF="14dc0a.htm"><B>ReuseDDElParam</B></A> function with <I>hData</I> supplied as the low-order word and <I>aItem</I> supplied as the high-order word. </P>

<P><B>Receiving</B> </P>

<P>The server application should post the WM_DDE_ACK message to respond positively or negatively. When posting WM_DDE_ACK, the server can either reuse the <I>aItem</I> atom, or it can delete it and create a new one. </P>

<P>The server must create or reuse the WM_DDE_ACK <I>lPackedVal</I> parameter by calling the <A HREF="1_gbv6y.htm"><B>PackDDElParam</B></A> function or the <A HREF="14dc0a.htm"><B>ReuseDDElParam</B></A> function with <I>wStatus</I> supplied as the low-order word and <I>aItem</I> supplied as the high-order word. </P>

<P>To free the <I>hData</I> object, the server should call the <A HREF="dvjhb..htm"><B>GlobalFree</B></A> function. Also, if the data format is either CF_DSPMETAFILEPICT or CF_METAFILEPICT, the server must also call <B>DeleteMetaFile</B> with the embedded metafile handle. These two formats have an extra level of indirection; that is, an application must lock <I>hData</I> to get a pointer to a handle, then lock that handle to get a pointer to a <B>METAFILEPICT </B>structure, and finally call <B>DeleteMetaFile</B> with the handle from the <B>hMF</B> member of the <B>METAFILEPICT</B> structure. </P>

<P>To free the <I>lPackedVal</I> object, the server should call the <B>FreeDDElParam</B> function. </P>

<P><B>See Also</B></P>

<P><A HREF="ke_nj2.htm"><B>DDEPOKE</B></A>, <A HREF=".s_c_s.htm"><B>DeleteMetaFile</B></A>, <A HREF="z7tg.k.htm"><B>FreeDDElParam</B></A>, <A HREF="1qh2cm4.htm"><B>GlobalAddAtom</B></A>, <A HREF="f12w9..htm"><B>GlobalAlloc</B></A>, <A HREF="dvjhb..htm"><B>GlobalFree</B></A>, <A HREF="iz3ixw.htm"><B>METAFILEPICT</B></A>, <A HREF="1_gbv6y.htm"><B>PackDDElParam</B></A>, <A HREF="fixdt_.htm"><B>PostMessage</B></A>, <A HREF="14dc0a.htm"><B>ReuseDDElParam</B></A>, <A HREF="1724msn.htm"><B>SendMessage</B></A>, <A HREF="51wgiv.htm"><B>UnpackDDElParam</B></A>, <A HREF="9k0..a.htm">WM_DDE_ACK</A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
