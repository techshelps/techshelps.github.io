<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>VerFindFile</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="5lg8gh"></A><B>VerFindFile  <A HREF="1k2x9lp.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="13zskj.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="hdit7h.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>VerFindFile</B> function determines where to install a file based on whether it locates another version of the file in the system. The values <B>VerFindFile</B> returns in the specified buffers are used in a subsequent call to <A HREF="1amjr40.htm"><B>VerInstallFile</B></A>. </P>

<P>As with the other file installation functions, <B>VerFindFile</B> will only work with Win32 file images. 16-bit Windows file images are not supported. </P>

<P><B>DWORD VerFindFile(</B></P>

<TABLE cols=2 width=555>

<TR VALIGN="top">
<TD width=32%><B>DWORD</B> <I>dwFlags</I><B>,</B></TD>
<TD width=68%>// bit flags that condition function behavior</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    LPTSTR</B> <I>szFileName</I><B>,</B></TD>
<TD width=68%>// file to be installed</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    LPTSTR</B> <I>szWinDir</I><B>,</B></TD>
<TD width=68%>// Windows directory</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    LPTSTR</B> <I>szAppDir</I><B>,</B></TD>
<TD width=68%>// directory where related files are being installed</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    LPTSTR</B> <I>szCurDir</I><B>,</B></TD>
<TD width=68%>// receives path of directory where file is currently installed</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    PUINT</B> <I>lpuCurDirLen</I><B>,</B></TD>
<TD width=68%>// size of string in szCurDir</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    LPTSTR</B> <I>szDestDir</I><B>,</B></TD>
<TD width=68%>// receives path of recommended destination directory</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    PUINT</B> <I>lpuDestDirLen</I> </TD>
<TD width=68%>// size of string in szDestDir</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>   );</B></TD>
<TD width=68%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>dwFlags</I></P>

<P>Contains a bitmask of flags. This parameter can be the following value: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=36%><B>Flag</B></TD>
<TD width=64%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=36%>VFFF_ISSHAREDFILE</TD>
<TD width=64%>The source file can be shared by multiple applications. An application can use this information to determine where the file should be copied.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>All other values are reserved. </P>

<P><I>szFileName</I></P>

<P>Points to the name of the file to be installed. The filename can include only the filename and extension, not a path. </P>

<P><I>szWinDir</I></P>

<P>Points to the directory in which Windows is running or will be run. This string is returned by the <A HREF="1b6tycn.htm"><B>GetWindowsDirectory</B></A> function. </P>

<P><I>szAppDir</I></P>

<P>Points to the directory where the installation program is installing a set of related files. If the installation program is installing an application, this is the directory where the application will reside. This parameter also points to the application's current directory unless otherwise specified. </P>

<P><I>szCurDir</I></P>

<P>Points to a buffer that receives the path to a current version of the file being installed. The path is a zero-terminated string. If a current version is not installed, the buffer will contain a zero-length string. The buffer should be at least _MAX_PATH characters long, although this is not required. </P>

<P><I>lpuCurDirLen</I></P>

<P>Points to a variable that contains the length of the <I>szCurDir</I> buffer. This pointer must not be NULL. </P>

<P>When the function returns, <I>lpuCurDirLen</I> contains the size, in characters, of the data returned in <I>szCurDir</I>, including the terminating null character. If the buffer is too small to contain all the data, <I>lpuCurDirLen</I> will be the size of the buffer required to hold the path. </P>

<P><I>szDestDir</I></P>

<P>Points to a buffer that receives the path to the installation location recommended by <B>VerFindFile</B>. The path is a zero-terminated string. The buffer should be at least _MAX_PATH characters long, although this is not required. </P>

<P><I>lpuDestDirLen</I></P>

<P>Points to a variable that contains the length of the <I>szDestDir</I> buffer. This pointer must not be NULL. </P>

<P>When the function returns, <I>lpuDestDirLen</I> contains the size, in characters, of the data returned in <I>szDestDir</I>, including the terminating null character. If the buffer is too small to contain all the data, <I>lpuDestDirLen</I> will be the size of the buffer needed to hold the path. </P>

<P></P>

<P><B>Return Values</B></P>

<P>The return value is a bitmask that indicates the status of the file. It can be one or more of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=34%><B>Value</B></TD>
<TD width=66%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=34%>VFF_CURNEDEST</TD>
<TD width=66%>The currently installed version of the file is not in the recommended destination.</TD>
</TR>

<TR VALIGN="top">
<TD width=34%>VFF_FILEINUSE</TD>
<TD width=66%>Windows is using the currently installed version of the file; therefore, the file cannot be overwritten or deleted.</TD>
</TR>

<TR VALIGN="top">
<TD width=34%>VFF_BUFFTOOSMALL</TD>
<TD width=66%>At least one of the buffers was too small to contain the corresponding string. An application should check the output buffers to determine which buffer was too small.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>All other values are reserved. </P>

<P><B>Remarks</B></P>

<P><B>VerFindFile</B> searches for a copy of the specified file by using the <B>OpenFile</B> function. However, it determines the system directory from the specified Windows directory, or searches the path. </P>

<P>If the <I>dwFlags</I> parameter indicates that the file is private to this application (not VFFF_ISSHAREDFILE), <B>VerFindFile</B> recommends installing the file in the application's directory. Otherwise, if the system is running a shared copy of Windows, the function recommends installing the file in the Windows directory. If the system is running a private copy of Windows, the function recommends installing the file in the system directory. </P>

<P><B>See Also</B></P>

<P><A HREF="1b6tycn.htm"><B>GetWindowsDirectory</B></A>, <A HREF="47xk05.htm"><B>OpenFile</B></A>, <A HREF="1amjr40.htm"><B>VerInstallFile</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
