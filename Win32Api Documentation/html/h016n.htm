<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Dragging Images</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="h016n"></A><B>Dragging Images</B></P>

<P>The Win32 API includes functions for dragging an image on the screen. The dragging functions move an image smoothly, in color, and without any flashing of the cursor. Both masked and unmasked images can be dragged.</P>

<P>The <A HREF="12ohw6o.htm"><B>ImageList_BeginDrag</B></A> function begins a drag operation. The parameters include the handle of the image list, the index of the image to drag, and the location of the hot spot within the image. The hot spot is a single pixel that the dragging functions recognize as the exact screen location of the image. Typically, an application sets the hot spot so that it coincides with the hot spot of the mouse cursor. The <A HREF="mzs9yn.htm"><B>ImageList_DragMove</B></A> function moves the image to a new location.</P>

<P>The <A HREF="4tkv_j1.htm"><B>ImageList_DragEnter</B></A><B> </B>function sets the initial position of the drag image within a window and draws the image at the position. The parameters include the handle of the window in which to draw the image and the coordinates of the initial position within the window. The coordinates are relative to the window's upper-left corner, not the client area. The same is true for all of the image dragging functions that take coordinates as parameters. This means you must compensate for the widths of window elements, such as the border, title bar, and menu bar, when specifying the coordinates. If you specify a NULL window handle when calling <B>ImageList_DragEnter</B>, the dragging functions draw the image in the device context associated with the desktop window, and the coordinates are relative to the upper-left corner of the screen. </P>

<P><B>ImageList_DragEnter</B> locks all other updates to the given window during the drag operation. If you need to do any drawing during a drag operation, such as highlighting the target of a drag and drop operation, you can temporarily hide the dragged image by using the <A HREF="4.ny85.htm"><B>ImageList_DragLeave</B></A> function. Another method is to use the <A HREF="4m9cxu5.htm"><B>GetDCEx</B></A> function with the DCX_LOCKWINDOWUPDATE value to retrieve a device context that allows you to draw. You must be careful, however, not to obliterate the dragged image.</P>

<P>The <A HREF="q9pa74.htm"><B>ImageList_SetDragCursorImage</B></A> creates a new drag image by combining the given image (typically a mouse cursor image) with the current drag image. Because the dragging functions use the new image during a drag operation, you should use the <A HREF="ewiss9.htm"><B>ShowCursor</B></A> function to hide the actual mouse cursor after calling <B>ImageList_SetDragCursorImage</B>. Otherwise, the system may appear to have two mouse cursors for the duration of the drag operation.</P>

<P>When an application calls <A HREF="12ohw6o.htm"><B>ImageList_BeginDrag</B></A>, the system creates an temporary, internal image list can copies the specified drag image to the internal list. You can retrieves the handle of the temporary drag image list by using the <A HREF="gsuvfa.htm"><B>ImageList_GetDragImage</B></A> function. The function also retrieves the current drag position, and the offset of the drag image relative to the drag position. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
