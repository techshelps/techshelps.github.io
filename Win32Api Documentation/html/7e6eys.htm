<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetUserObjectInformation</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="7e6eys"></A><B>GetUserObjectInformation  <A HREF="a009ja.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="3ocly5.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="2ggw8w5.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetUserObjectInformation</B> function returns information about a window station or desktop object.</P>

<P><B>BOOL GetUserObjectInformation(</B></P>

<TABLE cols=2 width=551>

<TR VALIGN="top">
<TD width=40%><B>HANDLE</B> <I>hObj</I><B>,</B></TD>
<TD width=60%>// handle of object to get information for</TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    int</B> <I>nIndex</I><B>,</B></TD>
<TD width=60%>// type of information to get</TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    PVOID</B> <I>pvInfo</I><B>,</B></TD>
<TD width=60%>// points to buffer that receives the information</TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    DWORD</B> <I>nLength</I><B>,</B></TD>
<TD width=60%>// size, in bytes, of <I>pvInfo</I> buffer</TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    LPDWORD</B> <I>lpnLengthNeeded</I></TD>
<TD width=60%>// receives required size, in bytes, of <I>pvInfo</I> buffer</TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>   );</B></TD>
<TD width=60%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hObj</I></P>

<P>Identifies the window station or desktop object for which to return information. This can be an HDESK or HWINSTA handle (for example, a handle returned by <A HREF="1_i7s06.htm"><B>CreateWindowStation</B></A>, <A HREF="3o8ycvo.htm"><B>OpenWindowStation</B></A>, <A HREF="mih.i.htm"><B>CreateDesktop</B></A>, or <A HREF="6lunhd.htm"><B>OpenDesktop</B></A>).</P>

<P><I>nIndex</I></P>

<P>Specifies the object information to be retrieved. The parameter must be one of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=43%><B>Value</B></TD>
<TD width=57%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=43%>UOI_FLAGS</TD>
<TD width=57%>Returns handle flags. The <I>pvInfo</I> parameter must point to a <A HREF="znlxbt.htm"><B>USEROBJECTFLAGS</B></A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>UOI_NAME</TD>
<TD width=57%>Returns a string containing the name of the object.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>UOI_TYPE</TD>
<TD width=57%>Returns a string containing the type name of the object.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>pvInfo</I></P>

<P>Points to a buffer to receive the object information.</P>

<P><I>nLength</I></P>

<P>Specifies the size, in bytes, of the buffer pointed to by the <I>pvInfo </I>parameter.</P>

<P><I>lpnLengthNeeded</I></P>

<P>Points to a variable receiving the number of bytes required to store the requested information. If this variable's value is greater than the value of the <I>nLength</I> parameter when the function returns, the function returns FALSE, and none of the information is copied to the <I>pvInfo</I> buffer. If the value of the variable pointed to by <I>lpnLengthNeeded</I> is less than or equal to the value of <I>nLength</I>, the entire information block is copied.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>.</P>

<P><B>See Also</B></P>

<P><A HREF="mih.i.htm"><B>CreateDesktop</B></A>, <A HREF="1_i7s06.htm"><B>CreateWindowStation</B></A>, <A HREF="btmesv.htm"><B>GetUserObjectSecurity</B></A>, <A HREF="6lunhd.htm"><B>OpenDesktop</B></A>, <A HREF="3o8ycvo.htm"><B>OpenWindowStation</B></A>, <A HREF="_g0.3j.htm"><B>SetUserObjectInformation</B></A>, <A HREF="pyktva.htm"><B>SetUserObjectSecurity</B></A>, <A HREF="znlxbt.htm"><B>USEROBJECTFLAGS</B></A> </P>

</BODY>
</HTML>
