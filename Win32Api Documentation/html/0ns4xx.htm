<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WM_PSD_PAGESETUPDLG</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="0ns4xx"></A><B>WM_PSD_PAGESETUPDLG  <A HREF="1bh81h5.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="y3i0nj.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1lhvm4l.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The WM_PSD_PAGESETUPDLG message notifies a <A HREF="1y2j3f.htm"><B>PagePaintHook</B></A> hook procedure that the Page Setup dialog box is about to draw the contents of the sample page. The hook procedure can use this message to carry out initialization tasks related to drawing the contents of the sample page.</P>

<P>WM_PSD_PAGESETUPDLG  </P>

<P>wPaper = LOWORD(wParam);         // paper-size flag </P>

<P>wFlags = HIWORD(wParam);         // paper-orientation flag </P>

<P>lppsd = (LPPAGESETUPDLG) lParam; // dialog box information </P>

<P></P>

<P><B>Parameters</B></P>

<P><I>wPaper</I></P>

<P>Value of the low-order word of <I>wParam</I>. Specifies a value that indicates the paper size. This value can be one of the DMPAPER_ values listed in the description of the <A HREF="1bkrzj1.htm"><B>DEVMODE</B></A> structure. </P>

<P><I>wFlags</I></P>

<P>Value of the high-order word of <I>wParam</I>. Indicates the orientation of the paper or envelope, and whether the printer is a dot matrix or HPPCL (Hewlett Packard Printer Control Language) device. This parameter can be one of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=12%>0x0001</TD>
<TD width=88%>Paper in landscape mode (dot matrix)</TD>
</TR>

<TR VALIGN="top">
<TD width=12%>0x0003</TD>
<TD width=88%>Paper in landscape mode (HPPCL)</TD>
</TR>

<TR VALIGN="top">
<TD width=12%>0x0005</TD>
<TD width=88%>Paper in portrait mode (dot matrix)</TD>
</TR>

<TR VALIGN="top">
<TD width=12%>0x0007</TD>
<TD width=88%>Paper in portrait mode (HPPCL)</TD>
</TR>

<TR VALIGN="top">
<TD width=12%>0x000b</TD>
<TD width=88%>Envelope in landscape mode (HPPCL)</TD>
</TR>

<TR VALIGN="top">
<TD width=12%>0x000d</TD>
<TD width=88%>Envelope in portrait mode (dot matrix)</TD>
</TR>

<TR VALIGN="top">
<TD width=12%>0x0019</TD>
<TD width=88%>Envelope in landscape mode (dot matrix)</TD>
</TR>

<TR VALIGN="top">
<TD width=12%>0x001f</TD>
<TD width=88%>Envelope in portrait mode (HPPCL)</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lppsd</I></P>

<P>Value of <I>lParam</I>. Points to a <A HREF="j2m70p.htm"><B>PAGESETUPDLG</B></A> structure that contains information used to initialize the Page Setup dialog box.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the hook procedure returns TRUE, the dialog box sends no more WM_PSD* messages and does not draw in the sample page until the next time the system needs to redraw the sample page. </P>

<P>If the hook procedure returns FALSE, the dialog box sends the remaining messages of the drawing sequence.</P>

<P><B>Remarks</B></P>

<P>The Page Setup dialog box includes an image of a sample page that shows how the user's selections affect the appearance of the printed output. When you call the <A HREF="5xtuyi.htm"><B>PageSetupDlg</B></A> function, you can provide a <A HREF="1y2j3f.htm"><B>PagePaintHook</B></A> hook procedure to customize the appearance of the sample page. Whenever the dialog box is about to draw the contents of the sample page, the dialog box sends a sequence of WM_PSD* messages to the hook procedure.</P>

<P>The first three messages of a drawing sequence (WM_PSD_PAGESETUPDLG, WM_PSD_FULLPAGERECT, or WM_PSD_MINMARGINRECT) provide information that the hook procedure can use to draw the contents of the sample page. The remaining messages (WM_PSD_MARGINRECT, WM_PSD_GREEKTEXTRECT, WM_PSD_ENVSTAMPRECT, WM_PSD_YAFULLPAGERECT) notify the hook procedure that the dialog box is about to draw a specific portion of the sample page. This allows the hook procedure to selectively draw portions of the sample page. </P>

<P><B>See Also</B></P>

<P><A HREF="1bkrzj1.htm"><B>DEVMODE</B></A>, <A HREF="1y2j3f.htm"><B>PagePaintHook</B></A>, <A HREF="5xtuyi.htm"><B>PageSetupDlg</B></A>, <A HREF="j2m70p.htm"><B>PAGESETUPDLG</B></A>, <A HREF="ldupd3.htm">WM_PSD_ENVSTAMPRECT</A>, <A HREF="7nvsuk.htm">WM_PSD_FULLPAGERECT</A>, <A HREF="fhkkon.htm">WM_PSD_GREEKTEXTRECT</A>, <A HREF="bjmhmh.htm">WM_PSD_MARGINRECT</A>, <A HREF="uc62s_.htm">WM_PSD_MINMARGINRECT</A>, <A HREF="2f0yny.htm">WM_PSD_YAFULLPAGERECT</A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
