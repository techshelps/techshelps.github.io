<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>CreatePrivateObjectSecurity</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="50zhjz"></A><B>CreatePrivateObjectSecurity  <A HREF="1x000cg.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1966ja.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="afqqmm.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>CreatePrivateObjectSecurity</B> function allocates and initializes a self-relative security descriptor for a new protected server's object. This function is called when a new protected server object is being created. </P>

<P><B>BOOL CreatePrivateObjectSecurity(</B></P>

<TABLE cols=2 width=570>

<TR VALIGN="top">
<TD width=58%><B>PSECURITY_DESCRIPTOR</B> <I>ParentDescriptor</I><B>,</B></TD>
<TD width=42%>// pointer to parent directory SD</TD>
</TR>

<TR VALIGN="top">
<TD width=58%><B>    PSECURITY_DESCRIPTOR</B> <I>CreatorDescriptor</I><B>,</B></TD>
<TD width=42%>// pointer to creator SD</TD>
</TR>

<TR VALIGN="top">
<TD width=58%><B>    PSECURITY_DESCRIPTOR </B><I>*</I><B>NewDescriptor,</B></TD>
<TD width=42%>// pointer to pointer to new SD</TD>
</TR>

<TR VALIGN="top">
<TD width=58%><B>    BOOL</B> <I>IsDirectoryObject</I><B>,</B></TD>
<TD width=42%>// container flag for new SD</TD>
</TR>

<TR VALIGN="top">
<TD width=58%><B>    HANDLE</B> <I>Token</I><B>,</B></TD>
<TD width=42%>// handle to client's access token</TD>
</TR>

<TR VALIGN="top">
<TD width=58%><B>    PGENERIC_MAPPING</B> <I>GenericMapping</I> </TD>
<TD width=42%>// pointer to access-rights structure</TD>
</TR>

<TR VALIGN="top">
<TD width=58%><B>   );</B></TD>
<TD width=42%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>ParentDescriptor</I></P>

<P>Points to the security descriptor for the parent directory in which a new object is being created. If there is no parent directory, this parameter can be NULL. </P>

<P><I>CreatorDescriptor</I></P>

<P>Points to a security descriptor provided by the creator of the object. If the object's creator does not explicitly pass security information for the new object, this parameter is intended to be NULL. </P>

<P><I>lppsdNew</I></P>

<P>Points to a pointer to the newly allocated security descriptor created when the function returns. </P>

<P><I>IsDirectoryObject</I></P>

<P>Specifies whether the new object is a container. A value of TRUE indicates the object contains other objects, such as a directory. </P>

<P><I>Token</I></P>

<P>Identifies the access token for the client process on whose behalf the object is being created. If this is an impersonation token, it must be at SecurityIdentification level or higher. For a full description of the SecurityIdentification impersonation level, see the <A HREF="7c9aq0.htm"><B>SECURITY_IMPERSONATION_LEVEL</B></A> enumerated type  </P>

<P>A client token is used to retrieve default security information for the new object, such as its default owner, primary group, and discretionary access-control list. The token must be open for TOKEN_QUERY access. </P>

<P><I>GenericMapping</I></P>

<P>Points to a <A HREF="il_uxb.htm"><B>GENERIC_MAPPING</B></A> structure that specifies the mapping from each generic right to specific rights for the object. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>If a system access-control list, or <B>SACL</B>, is specified in the <A HREF="188mr8k.htm"><B>SECURITY_DESCRIPTOR</B></A> specified by <I>CreatorDescriptor</I>, <I>Token</I> must have the SE_SECURITY_NAME privilege enabled, and the caller's token must have the SE_AUDIT_NAME privilege enabled. The <B>CreatePrivateObjectSecurity</B> function performs access/privilege checks to ensure this, and may generate audits during the process. </P>

<P><B>See Also</B></P>

<P><A HREF="epparm.htm"><B>DestroyPrivateObjectSecurity</B></A>, <A HREF="il_uxb.htm"><B>GENERIC_MAPPING</B></A>, <A HREF="3ykw.ub.htm"><B>GetPrivateObjectSecurity</B></A>, <A HREF="kt5z95.htm"><B>GetTokenInformation</B></A>, <A HREF="1r9su.q.htm"><B>OpenProcessToken</B></A>, <A HREF="188mr8k.htm"><B>SECURITY_DESCRIPTOR</B></A>, <A HREF="7c9aq0.htm"><B>SECURITY_IMPERSONATION_LEVEL</B></A>, <A HREF="3bdo3bt.htm"><B>SetPrivateObjectSecurity</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
