<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NDdeGetShareSecurity</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1v.knt5"></A><B>NDdeGetShareSecurity  <A HREF="1mdnk0l.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="g0og1h.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="vyjzi3.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>NDdeGetShareSecurity</B> function is called to get the <A HREF="8_8u2z.htm"><B>SECURITY_DESCRIPTOR</B></A> associated with the DDE share. This is done usually for editing. </P>

<P><B>UINT NDdeGetShareSecurity(</B></P>

<TABLE cols=2 width=519>

<TR VALIGN="top">
<TD width=48%><B>LPTSTR</B> <I>lpszServer</I><B>,</B></TD>
<TD width=52%>// server to execute on</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    LPTSTR</B> <I>lpszShareName</I><B>,</B></TD>
<TD width=52%>// name of share to delete</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    SECURITY_INFORMATION</B> <I>si</I><B>,</B></TD>
<TD width=52%>// requested information</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    PSECURITY_DESCRIPTOR</B> <I>pSD</I><B>,</B></TD>
<TD width=52%>// address of SD buffer</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    DWORD</B> <I>cbSD</I><B>,</B></TD>
<TD width=52%>// size of SD buffer</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    LPDWORD</B> <I>lpcbsdRequired</I> </TD>
<TD width=52%>// address of required size for SD buffer</TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>   );</B></TD>
<TD width=52%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpszServer</I></P>

<P>Address of the server name on which the DSDM resides. </P>

<P><I>lpszShareName</I></P>

<P>Address of the share name whose security descriptor is to be retrieved from the DSDM. This parameter must not be NULL. </P>

<P><I>si</I></P>

<P>Identifies the <A HREF="1iejnc4.htm"><B>SECURITY_INFORMATION</B></A> to be retrieved from the <B>SECURITY_DESCRIPTOR</B> associated with the share. </P>

<P><I>pSD</I></P>

<P>Address of a buffer that will accept the retrieved self-relative <B>SECURITY_DESCRIPTOR</B>. This parameter can be NULL. If this parameter is NULL, the DSDM determines the size of the requested security information and returns the number of bytes needed in the <I>lpcbsdRequired</I> parameter along with the NDDE_BUF_TOO_SMALL error code. </P>

<P><I>cbSD</I></P>

<P>Specifies the size of the buffer provided and referenced by the <I>pSD</I> parameter to accept the retrieved security descriptor. It must be 0 if <I>pSD</I> is NULL. </P>

<P><I>lpcbsdRequired</I></P>

<P>Address of the variable into which the actual size of the retrieved security descriptor is stored. This paramter must not be NULL. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is NDDE_NO_ERROR. </P>

<P>If the function fails, the return value is an error code, which can be translated into a text error message by calling <A HREF="i0y5fj.htm"><B>NDdeGetErrorString</B></A>. If the <I>pSD</I> parameter was NULL, it returns NDDE_BUF_TOO_SMALL. </P>

<P><B>See Also</B></P>

<P><A HREF="1iejnc4.htm"><B>SECURITY_INFORMATION</B></A>, <A HREF="9paaqa.htm"><B>NDdeSetShareSecurity</B></A></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
