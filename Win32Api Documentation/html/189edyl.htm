<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>DdeNameService</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="189edyl"></A><B>DdeNameService  <A HREF="u7jkiv.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="7m.xby.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="11k0r86.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>DdeNameService</B> function registers or unregisters the service names a dynamic data exchange (DDE) server supports. This function causes the system to send <A HREF="1pexhrn.htm">XTYP_REGISTER</A> or <A HREF="kyual1.htm">XTYP_UNREGISTER</A> transactions to other running <A HREF="7m.xby.htm">Dynamic Data Exchange Management Library</A> (DDEML) client applications. </P>

<P>A server application should call this function to register each service name that it supports and to unregister names it previously registered but no longer supports. A server should also call this function to unregister its service names just before terminating. </P>

<P><B>HDDEDATA DdeNameService(</B></P>

<TABLE cols=2 width=359>

<TR VALIGN="top">
<TD width=39%><B>DWORD</B> <I>idInst</I><B>,</B></TD>
<TD width=61%>// instance identifier</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    HSZ</B> <I>hsz1</I><B>,</B></TD>
<TD width=61%>// handle to service name string</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    HSZ</B> <I>hsz2</I><B>,</B></TD>
<TD width=61%>// reserved</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    UINT</B> <I>afCmd</I> </TD>
<TD width=61%>// service name flags</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>   );</B></TD>
<TD width=61%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>idInst</I></P>

<P>Specifies the application instance identifier obtained by a previous call to the <A HREF="1_pfuxk.htm"><B>DdeInitialize</B></A> function. </P>

<P><I>hsz1</I></P>

<P>Identifies the string that specifies the service name the server is registering or unregistering. An application that is unregistering all of its service names should set this parameter to 0L. </P>

<P><I>hsz2</I></P>

<P>Reserved; should be set to 0L. </P>

<P><I>afCmd</I></P>

<P>Specifies the service name flags. This parameter can be one of the following flags: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%><B>Flag</B></TD>
<TD width=67%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DNS_REGISTER</TD>
<TD width=67%>Registers the error code service name.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DNS_UNREGISTER</TD>
<TD width=67%>Unregisters the error code service name. If the <I>hsz1</I> parameter is 0L, all service names registered by the server will be unregistered.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DNS_FILTERON</TD>
<TD width=67%>Turns on service name initiation filtering. The filter prevents a server from receiving XTYP_CONNECT transactions for service names it has not registered. This is the default setting for this filter.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>&nbsp;</TD>
<TD width=67%>If a server application does not register any service names, the application cannot receive XTYP_WILDCONNECT transactions.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DNS_FILTEROFF</TD>
<TD width=67%>Turns off service name initiation filtering. If this flag is specified, the server receives an XTYP_CONNECT transaction whenever another DDE application calls the <A HREF="1_izsoe.htm"><B>DdeConnect</B></A> function, regardless of the service name.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>If the funcion succeeds, it returns a nonzero value. That value is not a true HDDEDATA value, merely a Boolean indicator of success. The function is typed HDDEDATA to allow for possible future expansion of the function and a more sophisticated return value. </P>

<P>If the function fails, the return value is 0L. </P>

<P><B>Errors</B></P>

<P>The <A HREF="aa7fa.htm"><B>DdeGetLastError</B></A> function can be used to get the error code, which may be one of the following values: </P>

<P>DMLERR_DLL_NOT_INITIALIZED<BR>
DMLERR_DLL_USAGE<BR>
DMLERR_INVALIDPARAMETER<BR>
DMLERR_NO_ERROR</P>

<P><B>Remarks</B></P>

<P>The service name identified by the <I>hsz1</I> parameter should be a base name (that is, the name should contain no instance-specific information). The system generates an instance-specific name and sends it along with the base name during the XTYP_REGISTER and XTYP_UNREGISTER transactions. The receiving applications can then connect to the specific application instance. </P>

<P><B>See Also</B></P>

<P><A HREF="1_izsoe.htm"><B>DdeConnect</B></A>, <A HREF="g2v2ut.htm"><B>DdeConnectList</B></A>, <A HREF="1_pfuxk.htm"><B>DdeInitialize</B></A>, <A HREF="1pexhrn.htm">XTYP_REGISTER</A>, <A HREF="kyual1.htm">XTYP_UNREGISTER</A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
