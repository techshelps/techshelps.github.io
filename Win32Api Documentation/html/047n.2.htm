<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Memory and the Clipboard</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="047n.2"></A><B>Memory and the Clipboard</B></P>

<P>A memory object that is to be placed on the clipboard should be allocated by using the <A HREF="f12w9..htm"><B>GlobalAlloc</B></A> function with the GMEM_DDESHARE and GMEM_MOVEABLE flags. </P>

<P>Once a memory object is placed on the clipboard, ownership of that memory handle is transferred to the system. When the clipboard is emptied and the memory object has one of the following clipboard formats, the system frees the memory object by calling the indicated Win32 function: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=39%><B>Function called to free object</B></TD>
<TD width=61%><B>Clipboard format</B></TD>
</TR>

<TR VALIGN="top">
<TD width=39%><A HREF=".s_c_s.htm"><B>DeleteMetaFile</B></A></TD>
<TD width=61%>CF_DSPENHMETAFILE</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>&nbsp;</TD>
<TD width=61%>CF_DSPMETAFILEPICT</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>&nbsp;</TD>
<TD width=61%>CF_ENHMETAFILE</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>&nbsp;</TD>
<TD width=61%>CF_METAFILEPICT</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><A HREF="y31ava.htm"><B>DeleteObject</B></A></TD>
<TD width=61%>CF_BITMAP</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>&nbsp;</TD>
<TD width=61%>CF_DSPBITMAP</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>&nbsp;</TD>
<TD width=61%>CF_PALETTE</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><A HREF="dvjhb..htm"><B>GlobalFree</B></A></TD>
<TD width=61%>CF_DIB</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>&nbsp;</TD>
<TD width=61%>CF_DSPTEXT</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>&nbsp;</TD>
<TD width=61%>CF_OEMTEXT</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>&nbsp;</TD>
<TD width=61%>CF_TEXT</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>&nbsp;</TD>
<TD width=61%>CF_UNICODETEXT</TD>
</TR>
</TABLE><BR>

<P></P>

<P>When the clipboard is emptied of a memory object whose clipboard format is not shown in the preceding list, the application itself must free the memory object. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
