<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>RegSetValue</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="10hyuh_"></A><B>RegSetValue  <A HREF="1_r02x6.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1y7hnby.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="vm.h_d.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>RegSetValue</B> function associates a value with a specified key. This value must be a text string and cannot have a name. This function is provided for compatibility with Windows version 3.1. Win32-based applications should use the <A HREF="43bp0ka.htm"><B>RegSetValueEx</B></A> function, which allows an application to set any number of named values of any data type. </P>

<P><B>LONG RegSetValue(</B></P>

<TABLE cols=2 width=391>

<TR VALIGN="top">
<TD width=44%><B>HKEY</B> <I>hKey</I><B>,</B></TD>
<TD width=56%>// handle of key to set value for </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    LPCTSTR</B> <I>lpSubKey</I><B>,</B></TD>
<TD width=56%>// address of subkey name </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    DWORD</B> <I>dwType</I><B>,</B></TD>
<TD width=56%>// type of value </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    LPCTSTR</B> <I>lpData</I><B>,</B></TD>
<TD width=56%>// address of value data </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    DWORD</B> <I>cbData</I> </TD>
<TD width=56%>// size of value data </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>   );</B></TD>
<TD width=56%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hKey</I></P>

<P>Identifies a currently open key or any of the following predefined reserved handle values: </P>

<P><B>HKEY_CLASSES_ROOT</B><BR>
<B>HKEY_CURRENT_USER</B><BR>
<B>HKEY_LOCAL_MACHINE</B><BR>
<B>HKEY_USERS</B></P>

<P><I>lpSubKey</I></P>

<P>Points to a null-terminated string containing the name of the subkey with which a value is associated. This parameter can be null or a pointer to an empty string. In this case, the value will be added to the key identified by the <I>hKey</I> parameter. </P>

<P><I>dwType</I></P>

<P>Specifies the type of information to be stored. This parameter must be the REG_SZ type. To store other data types, use the <B>RegSetValueEx</B> function. </P>

<P><I>lpData</I></P>

<P>Points to a null-terminated string containing the value to set for the specified key. </P>

<P><I>cbData</I></P>

<P>Specifies the length, in bytes, of the string pointed to by the <I>lpData</I> parameter, not including the terminating null character. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is ERROR_SUCCESS.</P>

<P>If the function fails, the return value is a nonzero error code defined in WINERROR.H. You can use the <A HREF="n7qrmp.htm"><B>FormatMessage</B></A> function with the FORMAT_MESSAGE_FROM_SYSTEM flag to get a generic description of the error.</P>

<P><B>Remarks</B></P>

<P>If the key specified by the <I>lpSubKey</I> parameter does not exist, the <B>RegSetValue</B> function creates it. </P>

<P>Value lengths are limited by available memory. Long values (more than 2048 bytes) should be stored as files with the filenames stored in the registry. This helps the registry perform efficiently. </P>

<P>The key identified by the <I>hKey</I> parameter must have been opened with KEY_SET_VALUE access. To open the key, use the <B>RegCreateKeyEx</B> or <B>RegOpenKeyEx</B> function. If the ANSI version of this function is used (either by explicitly calling <B>RegSetValue</B> or by not defining Unicode before including the WINDOWS.H file), the <I>lpData</I> parameter must be an ANSI character string. The string is converted to Unicode before it is stored in the registry. </P>

<P><B>See Also</B></P>

<P><A HREF=".5u9k7.htm"><B>RegCreateKeyEx</B></A>, <A HREF="yog9gw.htm"><B>RegFlushKey</B></A>, <A HREF="rz_3fo.htm"><B>RegOpenKeyEx</B></A>, <A HREF="bwg6c_.htm"><B>RegQueryValue</B></A>, <A HREF="1j.0zz..htm"><B>RegQueryValueEx</B></A>, <A HREF="43bp0ka.htm"><B>RegSetValueEx</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
