<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetPrivateObjectSecurity</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="3ykw.ub"></A><B>GetPrivateObjectSecurity  <A HREF="2cfhzbn.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1966ja.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="afqqmm.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetPrivateObjectSecurity</B> retrieves information from a protected server object's security descriptor. </P>

<P><B>BOOL GetPrivateObjectSecurity(</B></P>

<TABLE cols=2 width=613>

<TR VALIGN="top">
<TD width=56%><B>PSECURITY_DESCRIPTOR</B> <I>ObjectDescriptor</I><B>,</B></TD>
<TD width=44%>// address of SD to query</TD>
</TR>

<TR VALIGN="top">
<TD width=56%><B>    SECURITY_INFORMATION</B> <I>SecurityInformation</I><B>,</B></TD>
<TD width=44%>// requested information</TD>
</TR>

<TR VALIGN="top">
<TD width=56%><B>    PSECURITY_DESCRIPTOR</B> <I>ResultantDescriptor</I><B>,</B></TD>
<TD width=44%>// address of retrieved SD</TD>
</TR>

<TR VALIGN="top">
<TD width=56%><B>    DWORD</B> <I>DescriptorLength</I><B>,</B></TD>
<TD width=44%>// size of buffer for retrieved SD</TD>
</TR>

<TR VALIGN="top">
<TD width=56%><B>    PDWORD</B> <I>ReturnLength</I> </TD>
<TD width=44%>// address of buffer size required for SD</TD>
</TR>

<TR VALIGN="top">
<TD width=56%><B>   );</B></TD>
<TD width=44%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>ObjectDescriptor</I></P>

<P>Points to a <A HREF="188mr8k.htm"><B>SECURITY_DESCRIPTOR</B></A> structure. This is the security descriptor to be queried. </P>

<P><I>SecurityInformation</I></P>

<P>Specifies a <A HREF="1iejnc4.htm"><B>SECURITY_INFORMATION</B></A> structure that identifies the security information being requested. </P>

<P><I>ResultantDescriptor</I></P>

<P>Points to a buffer receiving a copy of the requested information from the specified security descriptor. The <A HREF="188mr8k.htm"><B>SECURITY_DESCRIPTOR</B></A> structure is returned in self-relative format. </P>

<P><I>DescriptorLength</I></P>

<P>Specifies the size, in bytes, of the buffer pointed to by the <I>ResultantDescriptor</I> parameter. </P>

<P><I>ReturnLength</I></P>

<P>Points to a variable the function sets to zero if the descriptor is copied successfully. If the buffer is too small for the security descriptor, this variable receives the number of bytes required. If this variable's value is greater than the value of the <I>DescriptorLength</I> parameter when the function returns, the function returns FALSE and none of the security descriptor is copied to the buffer. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>An application must perform appropriate access/privilege checks and audits before calling this function. </P>

<P><B>See Also</B></P>

<P><A HREF="50zhjz.htm"><B>CreatePrivateObjectSecurity</B></A>, <A HREF="epparm.htm"><B>DestroyPrivateObjectSecurity</B></A>, <A HREF="10dmpkl.htm"><B>GetFileSecurity</B></A>, <A HREF="b8qwja.htm"><B>GetKernelObjectSecurity</B></A>, <A HREF="btmesv.htm"><B>GetUserObjectSecurity</B></A>, <A HREF="188mr8k.htm"><B>SECURITY_DESCRIPTOR</B></A>, <A HREF="1iejnc4.htm"><B>SECURITY_INFORMATION</B></A>, <A HREF="3bdo3bt.htm"><B>SetPrivateObjectSecurity</B></A> </P>

</BODY>
</HTML>
