<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>MapAndLoad</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="c5hjc3"></A><B>MapAndLoad  <A HREF="1_ttjgy.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>MapAndLoad</B> function maps an image and preloads data from the mapped file.</P>

<P><B>BOOL MapAndLoad(</B></P>

<TABLE cols=2 width=315>

<TR VALIGN="top">
<TD width=89%><B>IN LPSTR </B><I>ImageName</I><B>,</B></TD>
<TD width=11%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=89%><B>    IN LPSTR </B><I>DllPath</I><B>,</B></TD>
<TD width=11%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=89%><B>    OUT PLOADED_IMAGE </B><I>LoadedImage</I><B>,</B></TD>
<TD width=11%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=89%><B>    IN BOOL </B><I>DotDll</I><B>,</B></TD>
<TD width=11%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=89%><B>    IN BOOL </B><I>ReadOnly</I></TD>
<TD width=11%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=89%><B>   );</B></TD>
<TD width=11%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>ImageName</I></P>

<P>The name of the image that is loaded.</P>

<P><I>DllPath</I></P>

<P>The path used to locate the image if the name provided cannot be found. If NULL is used, then the search path rules set forth in the <B>SearchPath</B> function will apply.</P>

<P><I>LoadedImage</I></P>

<P>A pointer to a LOADED_IMAGE structure. This structure receives information about the image after it is loaded.</P>

<P><I>DotDll</I></P>

<P>If the image needs to be located and the image name does not contain a file extension, this parameter controls the default extension used for the search process. If the value is TRUE, a .dll extension is used. If the value is FALSE, then a .exe extension is used.</P>

<P><I>ReadOnly</I></P>

<P>If this value is TRUE, the file is mapped for read-access only. If the value is FALSE, the file is mapped for read and write access.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is TRUE.</P>

<P>If the function fails, then the return value is FALSE. To retrieve extended error information, call <B>GetLastError</B>.</P>

<P><B>Remarks</B></P>

<P>The <B>MapAndLoad</B> function maps an image and preloads data from the mapped file. The corresponding function, <B>UnMapAndLoad</B>, <I>must</I> be used to deallocate all resources that are allocated by the <B>MapAndLoad<I> </I></B>function<I>.</I></P>

</BODY>
</HTML>
