<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>RasAdminGetIpAddressForUser [New - Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="88e4a9"></A><B>RasAdminGetIpAddressForUser  <A HREF="599mdg.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="35kj_0r.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1mpuhlc.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>[New - Windows NT]</P>

<P>The <B>RasAdminGetIpAddressForUser</B> function is an application-defined function that is exported by a third-party RAS server administration DLL. RAS calls this function to get an IP address for the dialed-in remote client.</P>

<P><B>DWORD RasAdminGetIpAddressForUser(</B></P>

<TABLE cols=2 width=615>

<TR VALIGN="top">
<TD width=32%><B>WCHAR</B> *<I>lpszUserName</I><B>,</B></TD>
<TD width=68%>// pointer to the name of the remote user</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    WCHAR</B> *<I>lpszPortName</I><B>,</B></TD>
<TD width=68%>// pointer to the name of the port</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    IPADDR</B> *<I>pipAddress</I><B>,</B></TD>
<TD width=68%>// pointer to the IP address</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    BOOL</B> *<I>bNotifyRelease</I></TD>
<TD width=68%>// indicates whether RAS should call RasAdminReleaseIpAddress</TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>   );</B></TD>
<TD width=68%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpszUserName</I></P>

<P>Pointer to a null-terminated Unicode string that contains the name of the remote user for whom an IP address is required. </P>

<P><I>lpszPortName</I></P>

<P>Pointer to a null-terminated Unicode string that contains the name of the port on which the user specified by <I>lpszUserName</I> is attempting to connect.</P>

<P><I>pipAddress</I></P>

<P>Pointer to an <B>IPADDR</B> variable. On input, *<I>pipAddress</I> contains either zero or the IP address that the RAS server proposes to use for the dialed-in remote client. The function can set *<I>pipAddress</I> to a different IP address, or accept the passed-in IP address. If *<I>pipAddress</I> is zero on input, the function must provide an IP address; otherwise, the client will be unable to connect to this server using IP.</P>

<P><I>bNotifyRelease</I></P>

<P>Pointer to a <B>BOOL</B> variable. Set this variable to TRUE if you want RAS to call your <A HREF="2biw0dt.htm"><B>RasAdminReleaseIpAddress</B></A> function when the user disconnects from this port; otherwise, set it to FALSE.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If <I>pipAddress</I> points to an IP address that the client can use to connect to this RAS server, the function should return NO_ERROR. This can occur if the function accepts the IP address that was passed by the RAS server, or if the function provides a different IP address.</P>

<P>If <I>pipAddress</I> does not point to an IP address, the function should return a nonzero error code. This can occur if no IP address is available, or if the passed in IP address is unacceptable. In this case, the client will be unable to connect to this server using IP.</P>

<P><B>Remarks</B></P>

<P>The setup program for a third-party RAS administration DLL must register the DLL with RAS by providing information under the following key in the registry: </P>

<P><B>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\RAS\AdminDll</B></P>

<P></P>

<P>To register the DLL, set the following values under this key.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=27%><B>Value Name</B></TD>
<TD width=73%><B>Value Data</B></TD>
</TR>

<TR VALIGN="top">
<TD width=27%>DisplayName</TD>
<TD width=73%>A REG_SZ string that contains the user-friendly display name of the DLL.</TD>
</TR>

<TR VALIGN="top">
<TD width=27%>DLLPath</TD>
<TD width=73%>A REG_SZ string that contains the full path of the DLL.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>For example, the registry entry for a RAS Administration DLL from a fictional company named Netwerks Corporation might be:</P>

<P><B>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\RAS\AdminDll</B></P>

<P>DisplayName  :  REG_SZ  :  Netwerks RAS Admin DLL</P>

<P>DLLPath      :  REG_SZ  :  C:\nt\system32\ntwkadm.dll</P>

<P></P>

<P>The setup program for a RAS Administration DLL should also provide remove/uninstall functionality. If a user removes the DLL, the setup program should delete the DLL's registry entries.</P>

<P><B>See Also</B></P>

<P><A HREF="2biw0dt.htm"><B>RasAdminReleaseIpAddress</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
