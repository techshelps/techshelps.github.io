<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CallNamedPipe</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="6xlg_2"></A><B>CallNamedPipe  <A HREF="42ankm3.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="qxj_so.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1p87g2.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>CallNamedPipe</B> function connects to a message-type pipe (and waits if an instance of the pipe is not available), writes to and reads from the pipe, and then closes the pipe. </P>

<P><B>BOOL CallNamedPipe(</B></P>

<TABLE cols=2 width=465>

<TR VALIGN="top">
<TD width=49%><B>LPCTSTR</B> <I>lpNamedPipeName</I><B>,</B></TD>
<TD width=51%>// pointer to pipe name </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    LPVOID</B> <I>lpInBuffer</I><B>,</B></TD>
<TD width=51%>// pointer to write buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    DWORD</B> <I>nInBufferSize</I><B>,</B></TD>
<TD width=51%>// size, in bytes, of write buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    LPVOID</B> <I>lpOutBuffer</I><B>,</B></TD>
<TD width=51%>// pointer to read buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    DWORD</B> <I>nOutBufferSize</I><B>,</B></TD>
<TD width=51%>// size, in bytes, of read buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    LPDWORD</B> <I>lpBytesRead</I><B>,</B></TD>
<TD width=51%>// pointer to number of bytes read </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    DWORD</B> <I>nTimeOut</I> </TD>
<TD width=51%>// time-out time, in milliseconds </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>   );</B></TD>
<TD width=51%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpNamedPipeName</I></P>

<P>Pointer to a null-terminated string specifying the pipe name. </P>

<P><I>lpInBuffer</I></P>

<P>Pointer to the buffer containing the data written to the pipe. </P>

<P><I>nInBufferSize</I></P>

<P>Specifies the size, in bytes, of the write buffer. </P>

<P><I>lpOutBuffer</I></P>

<P>Pointer to the buffer that receives the data read from the pipe. </P>

<P><I>nOutBufferSize</I></P>

<P>Specifies the size, in bytes, of the read buffer. </P>

<P><I>lpBytesRead</I></P>

<P>Pointer to a 32-bit variable that receives the number of bytes read from the pipe. </P>

<P><I>nTimeOut</I></P>

<P>Specifies the number of milliseconds to wait for the named pipe to be available. In addition to numeric values, the following special values can be specified: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=53%><B>Value</B></TD>
<TD width=47%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=53%>NMPWAIT_NOWAIT</TD>
<TD width=47%>Does not wait for the named pipe. If the named pipe is not available, the function returns an error.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>NMPWAIT_WAIT_FOREVER</TD>
<TD width=47%>Waits indefinitely.</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>NMPWAIT_USE_DEFAULT_WAIT</TD>
<TD width=47%>Uses the default time-out specified in a call to the <A HREF="21dzyt.htm"><B>CreateNamedPipe</B></A><B> </B>function.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>Calling <B>CallNamedPipe</B> is equivalent to calling the <B>CreateFile</B> (or <B>WaitNamedPipe</B>, if <B>CreateFile</B> cannot open the pipe immediately), <B>TransactNamedPipe</B>, and <B>CloseHandle </B>functions. <B>CreateFile</B> is called with an access flag of GENERIC_READ | GENERIC_WRITE, an inherit handle flag of FALSE, and a share mode of zero (indicating no sharing of this pipe instance). </P>

<P>If the message written to the pipe by the server process is longer than <I>nOutBufferSize</I>, <B>CallNamedPipe</B> returns FALSE, and <B>GetLastError</B> returns ERROR_MORE_DATA. The remainder of the message is discarded, because <B>CallNamedPipe</B> closes the handle to the pipe before returning. </P>

<P><B>CallNamedPipe</B> fails if the pipe is a byte-type pipe. </P>

<P><B>See Also</B></P>

<P><A HREF="ngwwie.htm"><B>CloseHandle</B></A>, <A HREF="xn35yd.htm"><B>CreateFile</B></A>, <A HREF="21dzyt.htm"><B>CreateNamedPipe</B></A>, <A HREF="1nuxhmk.htm"><B>TransactNamedPipe</B></A>, <A HREF="1xsezn8.htm"><B>WaitNamedPipe</B></A> </P>

<P></P>

<P></P>

</BODY>
</HTML>
