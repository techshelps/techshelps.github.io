<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Loading the Extension</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME=".zxfa4"></A><B>Loading the Extension</B></P>

<P>File Manager first sends the FMEVENT_LOAD message to the <B>FMExtensionProc</B> function. The <I>lParam</I> parameter accompanying the FMEVENT_LOAD message points to an <A HREF="5_9vwv0.htm"><B>FMS_LOAD</B></A> structure that File Manager uses to obtain information about the extension-supplied menu, including the menu name and menu handle.  </P>

<P>File Manager also uses the <B>FMS_LOAD</B> structure to pass the menu-item delta value to the extension. To avoid conflicts with its own menu-item identifiers, File Manager renumbers the menu-item identifiers in an extension-supplied menu by adding the delta value to each identifier. An extension DLL that must modify its menu after File Manager has loaded it must use the delta value. For example, to delete a menu item, the extension DLL finds the sum of the delta value and the menu-item identifier and passes it as the <I>idItem</I> parameter to the <B>DeleteMenu</B> function. </P>

<P>If an extension returns FALSE in response to this message, File Manager calls the <B>FreeLibrary</B> function and ends any communication with the extension DLL. This is the only place where an extension can notify File Manager of initialization problems and thus prevent the extension from being loaded. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
