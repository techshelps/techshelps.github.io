<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>InitiateSystemShutdown</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="uh63q6"></A><B>InitiateSystemShutdown  <A HREF="f1bpgc.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="advft.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="16i2tfw.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>InitiateSystemShutdown</B> function initiates a shutdown and optional restart of the specified computer. </P>

<P><B>BOOL InitiateSystemShutdown(</B></P>

<TABLE cols=2 width=542>

<TR VALIGN="top">
<TD width=42%><B>LPTSTR</B> <I>lpMachineName</I><B>,</B></TD>
<TD width=58%>// address of name of computer to shut down  </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    LPTSTR</B> <I>lpMessage</I><B>,</B></TD>
<TD width=58%>// address of message to display in dialog box </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    DWORD</B> <I>dwTimeout</I><B>,</B></TD>
<TD width=58%>// time to display dialog box </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    BOOL</B> <I>bForceAppsClosed</I><B>,</B></TD>
<TD width=58%>// force applications with unsaved changes flag </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    BOOL</B> <I>bRebootAfterShutdown</I> </TD>
<TD width=58%>// reboot flag </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>   );</B></TD>
<TD width=58%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpMachineName</I></P>

<P>Points to the null-terminated string that specifies the network name of the computer to shut down. If <I>lpMachineName</I> is NULL or points to an empty string, the function shuts down the local computer. </P>

<P><I>lpMessage</I></P>

<P>Points to a null-terminated string that specifies a message to display in the shutdown dialog box. This parameter can be NULL if no message is required. </P>

<P><I>dwTimeout</I></P>

<P>Specifies the time (in seconds) that the dialog box should be displayed. While this dialog box is displayed, the shutdown can be stopped by the <A HREF="62j7xm.htm"><B>AbortSystemShutdown</B></A> function. </P>

<P>If <I>dwTimeout</I> is not zero, <B>InitiateSystemShutdown</B> displays a dialog box on the specified computer. The dialog box displays the name of the user who called the function, displays the message specified by the <I>lpMessage</I> parameter, and prompts the user to log off. The dialog box beeps when it is created and remains on top of other windows in the system. The dialog box can be moved but not closed. A timer counts down the remaining time before a forced shutdown. If the user logs off, the system shuts down immediately. Otherwise, the computer is shut down when the timer expires. </P>

<P>If <I>dwTimeout</I> is zero, the computer shuts down without displaying the dialog box, and the shutdown cannot be stopped by <B>AbortSystemShutdown</B>. </P>

<P><I>bForceAppsClosed</I></P>

<P>Specifies whether applications with unsaved changes are to be forcibly closed. If this parameter is TRUE, such applications are closed. If this parameter is FALSE, a dialog box is displayed prompting the user to close the applications. </P>

<P><I>bRebootAfterShutdown</I></P>

<P>Specifies whether the computer is to restart immediately after shutting down. If this parameter is TRUE, the computer is to restart. If this parameter is FALSE, the system flushes all caches to disk, clears the screen, and displays a message indicating that it is safe to power down. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>To shut down the local computer, the calling process must have the SE_SHUTDOWN_NAME privilege. To shut down a remote computer, the calling process must have the SE_REMOTE_SHUTDOWN_NAME privilege on the remote computer. By default, users can enable the SE_SHUTDOWN_NAME privilege on the computer they are logged onto, and administrators can enable the SE_REMOTE_SHUTDOWN_NAME privilege on remote computers. </P>

<P>Common failures include an invalid or inaccessible computer name or insufficient privilege. </P>

<P><B>See Also</B></P>

<P><A HREF="62j7xm.htm"><B>AbortSystemShutdown</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
