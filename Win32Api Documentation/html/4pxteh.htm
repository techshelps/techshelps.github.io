<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>OpenInputDesktop</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="4pxteh"></A><B>OpenInputDesktop  <A HREF="kvfc94.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="3ocly5.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="2ggw8w5.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>OpenInputDesktop</B> function returns a handle to the desktop that receives user input. The input desktop is a desktop on the window station associated with the logged-on user. </P>

<P><B>HDESK OpenInputDesktop(</B></P>

<TABLE cols=2 width=542>

<TR VALIGN="top">
<TD width=39%><B>DWORD</B> <I>dwFlags</I><B>,</B></TD>
<TD width=61%>// flags to control interaction with other applications</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    BOOL</B> <I>fInherit</I><B>,</B></TD>
<TD width=61%>// specifies whether returned handle is inheritable</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    DWORD</B> <I>dwDesiredAccess</I></TD>
<TD width=61%>// specifies access of returned handle</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>   );</B></TD>
<TD width=61%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>dwFlags</I></P>

<P>A bit flag parameter that controls how the calling application will cooperate with other applications on the desktop. This parameter can specify zero or the following value:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=50%><B>Value</B></TD>
<TD width=50%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>DF_ALLOWOTHERACCOUNTHOOK</TD>
<TD width=50%>Allows processes running in other accounts on the desktop to set hooks in this process.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>fInherit</P>

<P>Specifies whether the returned handle is inherited when a new process is created. If this value is TRUE, new processes will inherit the handle.</P>

<P><I>dwDesiredAccess</I></P>

<P>Specifies the type of access to the desktop. This parameter can be one or more of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=43%><B>Value</B></TD>
<TD width=57%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DESKTOP_CREATEMENU</TD>
<TD width=57%>Required to create a menu on the desktop.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DESKTOP_CREATEWINDOW</TD>
<TD width=57%>Required to create a window on the desktop.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DESKTOP_ENUMERATE</TD>
<TD width=57%>Required for the desktop to be enumerated.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DESKTOP_HOOKCONTROL</TD>
<TD width=57%>Required to establish any of the window hooks.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DESKTOP_JOURNALPLAYBACK</TD>
<TD width=57%>Required to perform journal playback on the desktop.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DESKTOP_JOURNALRECORD</TD>
<TD width=57%>Required to perform journal recording on the desktop.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DESKTOP_READOBJECTS</TD>
<TD width=57%>Required to read objects on the desktop.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DESKTOP_SWITCHDESKTOP</TD>
<TD width=57%>Required to activate the desktop using <A HREF="iilwpz.htm"><B>SwitchDesktop</B></A>.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>DESKTOP_WRITEOBJECTS</TD>
<TD width=57%>Required to write objects on the desktop.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is a handle of the desktop that receives user input.</P>

<P>If the function fails, the return value is NULL. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>.</P>

<P><B>Remarks</B></P>

<P>The calling process must have an associated window station, either assigned by the system at process creation time or set by <A HREF="j98t3h.htm"><B>SetProcessWindowStation</B></A> The window station associated with the calling process must be capable of receiving input.</P>

<P>An application can use the <B>SwitchDesktop</B> function to change the input desktop.</P>

<P><B>See Also</B></P>

<P><A HREF="j98t3h.htm"><B>SetProcessWindowStation</B></A>, <A HREF="iilwpz.htm"><B>SwitchDesktop</B></A> </P>

</BODY>
</HTML>
