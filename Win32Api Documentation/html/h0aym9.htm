<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>String Functions</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="h0aym9"></A><B>String Functions</B></P>

<P>All of the string functions listed in this section exist in ANSI and Unicode implementations to support ANSI and Unicode arguments. There are, however, subtle differences among some of them. </P>

<P>The following string functions do not require special comment; their ANSI and Unicode implementations work identically. </P>

<P><A HREF="2hf9_pt.htm"><B>CharNext</B></A><BR>
<A HREF="fubkmq.htm"><B>CharPrev</B></A><BR>
<A HREF="e8v46s.htm"><B>lstrcat</B></A><BR>
<A HREF="e8v4ex.htm"><B>lstrcpy</B></A><BR>
<A HREF="e8v_0m.htm"><B>lstrlen</B></A></P>

<P>The value returned by the <B>lstrlen</B> function is always the number of characters, regardless of whether the ANSI or Unicode form is used. </P>

<P>The following string functions are sensitive to the locale of the current thread (as derived from the locale the user selects in Control Panel). The <B>lstrcmp</B> and <B>lstrcmpi</B> functions do not perform byte comparisons like their ANSI C namesakes; they compare strings according to the rules of the selected locale. </P>

<P><A HREF="15blbzv.htm"><B>CharLower</B></A><BR>
<A HREF="hihru5.htm"><B>CharLowerBuff</B></A><BR>
<A HREF="cba.cf.htm"><B>CharUpper</B></A><BR>
<A HREF="3eyz_wi.htm"><B>CharUpperBuff</B></A><BR>
<A HREF="e8v4bo.htm"><B>lstrcmp</B></A><BR>
<A HREF="68cpv2.htm"><B>lstrcmpi</B></A></P>

<P>The following functions convert between the OEM character set and either ANSI or Unicode, depending on which version is used. </P>

<P><A HREF="15jl0zq.htm"><B>CharToOem</B></A><BR>
<A HREF="n7lr1p.htm"><B>CharToOemBuff</B></A><BR>
<A HREF="llrx4c.htm"><B>OemToChar</B></A><BR>
<A HREF="pkjxv5.htm"><B>OemToCharBuff</B></A></P>

<P>The print function <A HREF="1fc46pp.htm"><B>wsprintf</B></A> supports Unicode by providing the following new and changed data types in its format specifications. These format specifications affect the way the <B>wsprintf</B> function interprets the corresponding passed-in parameter. </P>

<TABLE cols=3>

<TR VALIGN="top">
<TD width=30%><B>Format specification</B></TD>
<TD width=22%><B>ANSI version</B></TD>
<TD width=48%><B>Unicode version</B></TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>c</B></TD>
<TD width=22%><B>CHAR</B></TD>
<TD width=48%><B>WCHAR</B> </TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>C</B></TD>
<TD width=22%><B>WCHAR</B></TD>
<TD width=48%><B>CHAR</B> </TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>hc</B>, <B>hC</B></TD>
<TD width=22%><B>CHAR</B></TD>
<TD width=48%><B>CHAR</B> </TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>hs</B>, <B>hS</B></TD>
<TD width=22%><B>LPSTR</B></TD>
<TD width=48%><B>LPSTR</B> </TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>lc</B>, <B>lC</B></TD>
<TD width=22%><B>WCHAR</B></TD>
<TD width=48%><B>WCHAR</B> </TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>ls</B>, <B>lS</B></TD>
<TD width=22%><B>LPWSTR</B></TD>
<TD width=48%><B>LPWSTR</B> </TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>s</B></TD>
<TD width=22%><B>LPSTR</B></TD>
<TD width=48%><B>LPWSTR</B> </TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>S</B></TD>
<TD width=22%><B>LPWSTR</B></TD>
<TD width=48%><B>LPSTR</B> </TD>
</TR>
</TABLE><BR>

<P></P>

<P>The data type for the output text always depends on the version of the function. Where the data type of the passed-in parameter and of the output text do not agree, <B>wsprintf</B> will perform a conversion from Unicode to ANSI, or vice versa, as required. </P>

<P>For the Unicode version of <B>wsprintf</B>, the format string is Unicode, as is the output text. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
