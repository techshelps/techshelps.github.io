<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>BroadcastSystemMessage [Now Supported on Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="mk.ky2"></A><B>BroadcastSystemMessage  <A HREF="4asb5gp.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="21n71oj.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="hpo6s6.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>[Now Supported on Windows NT]</P>

<P>The <B>BroadcastSystemMessage</B> function sends a message to the specified recipients. The recipients can be applications, installable drivers, Windows-based network drivers, system-level device drivers, or any combination of these system components. </P>

<P><B>long BroadcastSystemMessage</B>(</P>

<TABLE cols=2 width=255>

<TR VALIGN="top">
<TD width=86%><B>DWORD</B> <I>dwFlags</I><B>,</B> </TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=86%><B>    LPDWORD</B> <I>lpdwRecipients</I><B>,</B> </TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=86%><B>    UINT</B> <I>uiMessage</I><B>,</B> </TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=86%><B>    WPARAM</B> <I>wParam</I><B>,</B> </TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=86%><B>    LPARAM</B> <I>lParam</I> </TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=86%><B>   );</B></TD>
<TD width=14%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>dwFlags</I></P>

<P>Option flags. Can be a combination of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=47%><B>Value</B></TD>
<TD width=53%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=47%>BSF_FLUSHDISK</TD>
<TD width=53%>Flush the disk after each recipient processes the message.</TD>
</TR>

<TR VALIGN="top">
<TD width=47%>BSF_FORCEIFHUNG</TD>
<TD width=53%>Continue to broadcast the message, even if the time-out period elapses or one of the recipients is hung.. </TD>
</TR>

<TR VALIGN="top">
<TD width=47%>BSF_IGNORECURRENTTASK</TD>
<TD width=53%>Do not send the message to windows that belong to the current task. This prevents an application from receiving its own message. </TD>
</TR>

<TR VALIGN="top">
<TD width=47%>BSF_NOHANG</TD>
<TD width=53%>Force a hung application to time out. If one of the recipients times out, do not continue broadcasting the message. </TD>
</TR>

<TR VALIGN="top">
<TD width=47%>BSF_NOTIMEOUTIFNOTHUNG</TD>
<TD width=53%>Wait for a response to the message, as long as the recipient is not hung. Do not time out. </TD>
</TR>

<TR VALIGN="top">
<TD width=47%>BSF_POSTMESSAGE</TD>
<TD width=53%>Post the message. Do not use in combination with BSF_QUERY. </TD>
</TR>

<TR VALIGN="top">
<TD width=47%>BSF_QUERY</TD>
<TD width=53%>Send the message to one recipient at a time, sending to a subsequent recipient only if the current recipient returns TRUE. </TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lpdwRecipients</I></P>

<P>Pointer to a variable that contains and receives information about the recipients of the message. The variable can be a combination of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=45%><B>Value</B></TD>
<TD width=55%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%>BSM_ALLCOMPONENTS</TD>
<TD width=55%>Broadcast to all system components.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>BSM_ALLDESKTOPS</TD>
<TD width=55%><B>Windows NT only:</B> Broadcast to all desktops. Requires the SE_TCB_NAME privilege.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>BSM_APPLICATIONS</TD>
<TD width=55%>Broadcast to applications.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>BSM_INSTALLABLEDRIVERS</TD>
<TD width=55%><B>Windows 95:</B> Broadcast to installable drivers.
<P><B>Windows NT:</B> This value is not meaningful. </P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>BSM_NETDRIVER</TD>
<TD width=55%><B>Windows 95:</B> Broadcast to Windows-based network drivers.
<P><B>Windows NT:</B> This value is not meaningful.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>BSM_VXDS</TD>
<TD width=55%><B>Windows 95:</B> Broadcast to all system-level device drivers.
<P><B>Windows NT:</B> This value is not meaningful.</P>
</TD>
</TR>
</TABLE><BR>

<P></P>

<P>When the function returns, this variable receives a combination of these values identifying which recipients actually received the message. </P>

<P>If this parameter is NULL, the function broadcasts to all components.</P>

<P><I>uiMessage</I></P>

<P>Identifier of the system message. </P>

<P><I>wParam</I></P>

<P>32-bit message-specific value.</P>

<P><I>lParam</I></P>

<P>32-bit message-specific value. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is a positive value.</P>

<P>If the function is unable to broadcast the message, the return value is -1. </P>

<P>If the <I>dwFlags</I> parameter is BSF_QUERY and at least one recipient returned BROADCAST_QUERY_DENY to the corresponding message, the return value is zero.</P>

<P><B>Remarks</B></P>

<P>If BSF_QUERY is not specified, the function sends the specified message to all requested recipients, ignoring values returned by those recipients.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
