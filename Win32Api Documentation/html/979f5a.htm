<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Terminating a Data Link</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="979f5a"></A><B>Terminating a Data Link</B></P>

<P>If the client requests that a specific data link be terminated, the client sends the server a <A HREF="227e00g.htm">WM_DDE_UNADVISE</A> message, as shown in the following example. </P>

<P>if ((atomItem = GlobalAddAtom(szItemName)) != 0) {  </P>

<P>if (!PostMessage(hwndServerDDE, </P>

<P>WM_DDE_UNADVISE, </P>

<P>(WPARAM) hwndClientDDE, </P>

<P>PackDDElParam(WM_DDE_UNADVISE, 0, atomItem))) { </P>

<P>GlobalDeleteAtom(atomItem); </P>

<P>FreeDDElParam(WM_DDE_UNADVISE, lParam); </P>

<P>} </P>

<P>} </P>

<P></P>

<P>if (atomItem == 0) { </P>

<P></P>

<P>. </P>

<P>. /* error handling */ </P>

<P>. </P>

<P></P>

<P>} </P>

<P></P>

<P>The server checks whether the client currently has a link to the specific item in this conversation. If a link exists, the server sends the client a positive <A HREF="9k0..a.htm">WM_DDE_ACK</A> message; the server is then no longer required to send updates about the item. If no link exists, the server sends the client a negative WM_DDE_ACK message. </P>

<P>The <A HREF="227e00g.htm">WM_DDE_UNADVISE</A> message specifies a data format. A format of zero informs the server to stop all links for the specified item, even if several hot links are established and each uses a different format. </P>

<P>To terminate all links for a conversation, the client application sends the server a WM_DDE_UNADVISE message with a null item atom. The server determines whether the conversation has at least one link currently established. If a link exists, the server sends the client a positive WM_DDE_ACK message; the server then no longer has to send any updates in the conversation. If no link exists, the server sends the client a negative WM_DDE_ACK message. </P>

</BODY>
</HTML>
