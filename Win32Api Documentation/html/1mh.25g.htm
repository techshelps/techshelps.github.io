<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>AddMonitor</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1mh.25g"></A><B>AddMonitor  <A HREF="dpaxf7.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="joiq6.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="yhp8x..htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>AddMonitor</B> function installs a local printer monitor and links the configuration, data, and monitor files. Future releases of Windows NT may allow remote installation of printer monitors. </P>

<P><B>BOOL AddMonitor (</B></P>

<TABLE cols=2 width=407>

<TR VALIGN="top">
<TD width=41%><B>LPTSTR</B> <I>pName</I><B>,</B></TD>
<TD width=59%>// pointer to server name </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    DWORD</B> <I>Level</I><B>,</B></TD>
<TD width=59%>// monitor info. structure level </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    LPBYTE</B> <I>pMonitors</I> </TD>
<TD width=59%>// pointer to monitor info. structure  </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>   );</B></TD>
<TD width=59%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>pName</I></P>

<P>Pointer to a null-terminated string that specifies the name of the server on which the monitor should be installed. For this release of Windows NT, monitors may only be installed locally, so this string should be NULL. </P>

<P><I>Level</I></P>

<P>Specifies the version of the structure to which <I>pMonitors</I> points. This value must be 2. </P>

<P><I>pMonitors</I></P>

<P>Pointer to a <A HREF="4jt5wy.htm"><B>MONITOR_INFO_2</B></A> structure.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>Before an application calls the <B>AddMonitor </B>function, all files required by the monitor must be copied to the SYSTEM32 directory. </P>

<P>An application can determine which printer monitors are currently installed by calling the <B>EnumMonitors</B> function. </P>

<P>A monitor added by <B>AddMonitor</B> may be removed by calling <B>DeleteMonitor</B>. </P>

<P><B>See Also</B></P>

<P><A HREF="ksjv_i.htm"><B>DeleteMonitor</B></A>, <A HREF="74sp09.htm"><B>EnumMonitors</B></A>, <A HREF="4jt5wy.htm"><B>MONITOR_INFO_2</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
