<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>WM_DDE_INITIATE</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1x_rzry"></A><B>WM_DDE_INITIATE  <A HREF="2_kjrx5.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="w3rlry.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="00i2ql.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>A DDE client application sends a WM_DDE_INITIATE message to initiate a conversation with a server application responding to the specified application and topic names. Upon receiving this message, all server applications with names that match the specified application and that support the specified topic are expected to acknowledge it. (For more information, see the <A HREF="9k0..a.htm">WM_DDE_ACK</A> message.) </P>

<P>WM_DDE_INITIATE  </P>

<P>wParam = (WPARAM) hwnd;             // handle of posting appl. </P>

<P>lParam = MAKELPARAM(aApp, aTopic);  // appl. and topic atoms </P>

<P></P>

<P><B>Parameters</B></P>

<P><I>hwnd</I></P>

<P>Value of <I>wParam</I>. Identifies the client window sending the message. </P>

<P><I>aApp</I></P>

<P>Value of the low-order word of <I>lParam</I>. Contains an atom that identifies the application with which a conversation is requested. The application name cannot contain slashes (/) or backslashes (\). These characters are reserved for network implementations. If <I>aApp</I> is NULL, a conversation with all applications is requested. </P>

<P><I>aTopic</I></P>

<P>Value of the high-order word of <I>lParam</I>. Contains an atom that identifies the topic for which a conversation is requested. If the topic is NULL, conversations for all available topics are requested. </P>

<P></P>

<P><B>Remarks</B></P>

<P>If <I>aApp</I> is NULL, any server application can respond. If <I>aTopic</I> is NULL, any topic is valid. Upon receiving a WM_DDE_INITIATE request with the <I>aTopic</I> parameter set to NULL, a server must send a <A HREF="9k0..a.htm">WM_DDE_ACK</A> message for each of the topics it supports. </P>

<P><B>Sending</B> </P>

<P>The client application sends WM_DDE_INITIATE by calling the <A HREF="1724msn.htm"><B>SendMessage</B></A> function, not the <A HREF="fixdt_.htm"><B>PostMessage</B></A> function. The client broadcasts the message to all top-level windows by setting the first parameter of <B>SendMessage</B> to -1. </P>

<P>If the client application has already obtained the window handle of the desired server, it can send WM_DDE_INITIATE directly to the server window by passing the server's window handle as the first parameter of <B>SendMessage</B>. </P>

<P>The client application allocates <I>aApp</I> and <I>aTopic</I> by calling <A HREF="1qh2cm4.htm"><B>GlobalAddAtom</B></A>. </P>

<P>When <B>SendMessage</B> returns, the client application must delete the <I>aApp</I> and <I>aTopic</I> atoms. </P>

<P><B>Receiving</B> </P>

<P>To complete the initiation of a conversation, the server application must respond with one or more WM_DDE_ACK messages, where each message is for a separate topic. When sending WM_DDE_ACK message, the server should create new <I>aApp</I> and <I>aTopic</I> atoms; it should not reuse the atoms sent with WM_DDE_INITIATE. </P>

<P><B>See Also</B></P>

<P><A HREF="1qh2cm4.htm"><B>GlobalAddAtom</B></A>, <A HREF="f12w9..htm"><B>GlobalAlloc</B></A>, <A HREF="fixdt_.htm"><B>PostMessage</B></A>, <A HREF="1724msn.htm"><B>SendMessage</B></A>, <A HREF="9k0..a.htm">WM_DDE_ACK</A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
