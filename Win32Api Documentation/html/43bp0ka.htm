<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>RegSetValueEx</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="43bp0ka"></A><B>RegSetValueEx  <A HREF="18wn.rs.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1y7hnby.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="vm.h_d.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>RegSetValueEx</B> function stores data in the value field of an open registry key. It can also set additional value and type information for the specified key. </P>

<P><B>LONG RegSetValueEx(</B></P>

<TABLE cols=2 width=418>

<TR VALIGN="top">
<TD width=47%><B>HKEY</B> <I>hKey</I><B>,</B></TD>
<TD width=53%>// handle of key to set value for  </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    LPCTSTR</B> <I>lpValueName</I><B>,</B></TD>
<TD width=53%>// address of value to set </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    DWORD</B> <I>Reserved</I><B>,</B></TD>
<TD width=53%>// reserved </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    DWORD</B> <I>dwType</I><B>,</B></TD>
<TD width=53%>// flag for value type </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    CONST BYTE *</B><I>lpData</I><B>,</B></TD>
<TD width=53%>// address of value data </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    DWORD</B> <I>cbData</I> </TD>
<TD width=53%>// size of value data </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>   );</B></TD>
<TD width=53%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hKey</I></P>

<P>Identifies a currently open key or any of the following predefined reserved handle values: </P>

<P><B>HKEY_CLASSES_ROOT</B><BR>
<B>HKEY_CURRENT_USER</B><BR>
<B>HKEY_LOCAL_MACHINE</B><BR>
<B>HKEY_USERS</B></P>

<P><I>lpValueName</I></P>

<P>Points to a string containing the name of the value to set. If a value with this name is not already present in the key, the function adds it to the key. </P>

<P>If this parameter is NULL or points to an empty string and the <I>dwType</I> parameter is the REG_SZ type, this function sets the same value the <A HREF="10hyuh_.htm"><B>RegSetValue</B></A> function would set. </P>

<P><I>Reserved</I></P>

<P>Reserved; must be zero. </P>

<P><I>dwType</I></P>

<P>Specifies the type of information to be stored as the value's data. This parameter can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=49%><B>Value</B></TD>
<TD width=51%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=49%>REG_BINARY</TD>
<TD width=51%>Binary data in any form.</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>REG_DWORD</TD>
<TD width=51%>A 32-bit number.</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>REG_DWORD_LITTLE_ENDIAN</TD>
<TD width=51%>A 32-bit number in little-endian format (same as REG_DWORD). In little-endian format, the most significant byte of a word is the high-order byte. This is the most common format for computers running Windows NT and Windows 95.</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>REG_DWORD_BIG_ENDIAN</TD>
<TD width=51%>A 32-bit number in big-endian format. In big-endian format, the most significant byte of a word is the low-order byte.</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>REG_EXPAND_SZ</TD>
<TD width=51%>A null-terminated string that contains unexpanded references to environment variables (for example, "%PATH%"). It will be a Unicode or ANSI string depending on whether you use the Unicode or ANSI functions.</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>REG_LINK</TD>
<TD width=51%>A Unicode symbolic link.</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>REG_MULTI_SZ</TD>
<TD width=51%>An array of null-terminated strings, terminated by two null characters.</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>REG_NONE</TD>
<TD width=51%>No defined value type.</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>REG_RESOURCE_LIST</TD>
<TD width=51%>A device-driver resource list.</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>REG_SZ</TD>
<TD width=51%>A null-terminated string. It will be a Unicode or ANSI string depending on whether you use the Unicode or ANSI functions.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lpData</I></P>

<P>Points to a buffer containing the data to be stored with the specified value name. </P>

<P><I>cbData</I></P>

<P>Specifies the size, in bytes, of the information pointed to by the <I>lpData</I> parameter. If the data is of type REG_SZ, REG_EXPAND_SZ, or REG_MULTI_SZ, <I>cbData</I> must include the size of the terminating null character. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is ERROR_SUCCESS.</P>

<P>If the function fails, the return value is a nonzero error code defined in WINERROR.H. You can use the <A HREF="n7qrmp.htm"><B>FormatMessage</B></A> function with the FORMAT_MESSAGE_FROM_SYSTEM flag to get a generic description of the error.</P>

<P><B>Remarks</B></P>

<P>Value lengths are limited by available memory. Long values (more than 2048 bytes) should be stored as files with the filenames stored in the registry. This helps the registry perform efficiently. Application elements such as icons, bitmaps, and executable files should be stored as files and not be placed in the registry. </P>

<P>The key identified by the <I>hKey</I> parameter must have been opened with KEY_SET_VALUE access. To open the key, use the <A HREF=".5u9k7.htm"><B>RegCreateKeyEx</B></A> or <A HREF="rz_3fo.htm"><B>RegOpenKeyEx</B></A> function. </P>

<P>If <I>dwType</I> is the REG_SZ, REG_MULTI_SZ or REG_EXPAND_SZ type and the ANSI version of this function is used (either by explicitly calling <B>RegSetValueEx</B> or by <I>not</I> defining Unicode before including the WINDOWS.H file), the data pointed to by the <I>lpData</I> parameter must be an ANSI character string. The string is converted to Unicode before it is stored in the registry. </P>

<P><B>See Also</B></P>

<P><A HREF=".5u9k7.htm"><B>RegCreateKeyEx</B></A>, <A HREF="yog9gw.htm"><B>RegFlushKey</B></A>, <A HREF="rz_3fo.htm"><B>RegOpenKeyEx</B></A>, <A HREF="bwg6c_.htm"><B>RegQueryValue</B></A>, <A HREF="1j.0zz..htm"><B>RegQueryValueEx</B></A>, <A HREF="10hyuh_.htm"><B>RegSetValue</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
