<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>SetWindowsHookEx</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="2d7__i2"></A><B>SetWindowsHookEx  <A HREF="6oyloe.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="qpp.yo.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="rnpdgc.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>SetWindowsHookEx</B> function installs an application-defined hook procedure into a hook chain. An application installs a hook procedure to monitor the system for certain types of events. A hook procedure can monitor events associated either with a specific thread or with all threads in the system. This function supersedes the <B>SetWindowsHook</B> function. </P>

<P><B>HHOOK SetWindowsHookEx(</B></P>

<TABLE cols=2 width=429>

<TR VALIGN="top">
<TD width=41%><B>int</B> <I>idHook</I><B>,</B></TD>
<TD width=59%>// type of hook to install</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    HOOKPROC</B> <I>lpfn</I><B>,</B></TD>
<TD width=59%>// address of hook procedure</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    HINSTANCE</B> <I>hMod</I><B>,</B></TD>
<TD width=59%>// handle of application instance</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    DWORD</B> <I>dwThreadId</I> </TD>
<TD width=59%>// identity of thread to install hook for </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>   );</B></TD>
<TD width=59%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>idHook</I></P>

<P>Specifies the type of hook procedure to be installed. This parameter can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=43%><B>Value</B></TD>
<TD width=57%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WH_CALLWNDPROC</TD>
<TD width=57%>Installs a hook procedure that monitors messages before the system sends them to the destination window procedure. For more information, see the <A HREF="nejvze.htm"><B>CallWndProc</B></A> hook procedure.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WH_CALLWNDPROCRET</TD>
<TD width=57%>Installs a hook procedure that monitors messages after they have been processed by the destination window procedure. For more information, see the <A HREF="4xp4xbu.htm"><B>CallWndRetProc</B></A> hook procedure.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WH_CBT</TD>
<TD width=57%>Installs a hook procedure that receives notifications useful to a computer-based training (CBT) application. For more information, see the <A HREF="j9p_3k.htm"><B>CBTProc</B></A> hook procedure.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WH_DEBUG</TD>
<TD width=57%>Installs a hook procedure useful for debugging other hook procedures. For more information, see the <A HREF="ef69vl.htm"><B>DebugProc</B></A> hook procedure.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WH_GETMESSAGE</TD>
<TD width=57%>Installs a hook procedure that monitors messages posted to a message queue. For more information, see the <A HREF="wlhv1n.htm"><B>GetMsgProc</B></A> hook procedure.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WH_JOURNALPLAYBACK</TD>
<TD width=57%>Installs a hook procedure that posts messages previously recorded by a WH_JOURNALRECORD hook procedure. For more information, see the <A HREF="lesnkt.htm"><B>JournalPlaybackProc</B></A> hook procedure.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WH_JOURNALRECORD</TD>
<TD width=57%>Installs a hook procedure that records input messages posted to the system message queue. This hook is useful for recording macros. For more information, see the <A HREF="32huo95.htm"><B>JournalRecordProc</B></A> hook procedure.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WH_KEYBOARD</TD>
<TD width=57%>Installs a hook procedure that monitors keystroke messages. For more information, see the <A HREF="2qr7.co.htm"><B>KeyboardProc</B></A> hook procedure.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WH_MOUSE</TD>
<TD width=57%>Installs a hook procedure that monitors mouse messages. For more information, see the <A HREF="hqw0_a.htm"><B>MouseProc</B></A> hook procedure.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WH_MSGFILTER</TD>
<TD width=57%>Installs a hook procedure that monitors messages generated as a result of an input event in a dialog box, message box, menu, or scroll bar. For more information, see the <A HREF="tn9es3.htm"><B>MessageProc</B></A> hook procedure.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WH_SHELL</TD>
<TD width=57%>Installs a hook procedure that receives notifications useful to shell applications. For more information, see the <A HREF="3i9jhc5.htm"><B>ShellProc</B></A> hook procedure.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WH_SYSMSGFILTER</TD>
<TD width=57%>Installs a hook procedure that monitors messages generated as a result of an input event in a dialog box, message box, menu, or scroll bar. The hook procedure monitors these messages for all applications in the system. For more information, see the <A HREF="uccnb.htm"><B>SysMsgProc</B></A> hook procedure.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lpfn</I></P>

<P>Points to the hook procedure. If the <I>dwThreadId</I> parameter is zero or specifies the identifier of a thread created by a different process, the <I>lpfn</I> parameter must point to a hook procedure in a dynamic-link library (DLL). Otherwise, <I>lpfn</I> can point to a hook procedure in the code associated with the current process. </P>

<P><I>hMod</I></P>

<P>Identifies the DLL containing the hook procedure pointed to by the <I>lpfn</I> parameter. The <I>hMod</I> parameter must be set to NULL if the <I>dwThreadId</I> parameter specifies a thread created by the current process and if the hook procedure is within the code associated with the current process. </P>

<P><I>dwThreadId</I></P>

<P>Specifies the identifier of the thread with which the hook procedure is to be associated. If this parameter is zero, the hook procedure is associated with all existing threads. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is the handle of the hook procedure. </P>

<P>If the function fails, the return value is NULL. </P>

<P><B>Remarks</B></P>

<P>An error may occur if the <I>hMod</I> parameter is NULL and the <I>dwThreadId</I> parameter is zero or specifies the identifier of a thread created by another process. </P>

<P>Chaining to the next hook procedure (that is, calling the <A HREF="2ebdbc.htm"><B>CallNextHookEx</B></A> function) is optional. An application or library can call the next hook procedure either before or after any processing in its own hook procedure. Although chaining to the next hook is optional, it is highly recommended; otherwise, the other applications that have installed hooks will not receive hook notifications and may behave incorrectly as a result.</P>

<P>Before terminating, an application must call the <A HREF="kjrpns.htm"><B>UnhookWindowsHookEx</B></A> function to free system resources associated with the hook. </P>

<P>The scope of a hook depends on the hook type. Some hooks can be set only with system scope; others can also be set for only a specific thread, as shown in the following list: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=39%><B>Hook</B></TD>
<TD width=61%><B>Scope</B></TD>
</TR>

<TR VALIGN="top">
<TD width=39%>WH_CALLWNDPROC</TD>
<TD width=61%>Thread or system</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>WH_CBT</TD>
<TD width=61%>Thread or system</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>WH_DEBUG</TD>
<TD width=61%>Thread or system</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>WH_GETMESSAGE</TD>
<TD width=61%>Thread or system</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>WH_JOURNALPLAYBACK</TD>
<TD width=61%>System only</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>WH_JOURNALRECORD</TD>
<TD width=61%>System only</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>WH_KEYBOARD</TD>
<TD width=61%>Thread or system</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>WH_MOUSE</TD>
<TD width=61%>Thread or system</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>WH_MSGFILTER</TD>
<TD width=61%>Thread or system</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>WH_SHELL</TD>
<TD width=61%>Thread or system</TD>
</TR>

<TR VALIGN="top">
<TD width=39%>WH_SYSMSGFILTER</TD>
<TD width=61%>System only</TD>
</TR>
</TABLE><BR>

<P></P>

<P>For a specified hook type, thread hooks are called first, then system hooks. </P>

<P>The system hooks are a shared resource, and installing one affects all applications. All system hook functions must be in libraries. System hooks should be restricted to special-purpose applications or to use as a development aid during application debugging. Libraries that no longer need a hook should remove the hook procedure. </P>

<P><B>See Also</B></P>

<P><A HREF="2ebdbc.htm"><B>CallNextHookEx</B></A>, <A HREF="nejvze.htm"><B>CallWndProc</B></A>, <A HREF="4xp4xbu.htm"><B>CallWndRetProc</B></A>, <A HREF="j9p_3k.htm"><B>CBTProc</B></A>, <A HREF="ef69vl.htm"><B>DebugProc</B></A>, <A HREF="wlhv1n.htm"><B>GetMsgProc</B></A>, <A HREF="lesnkt.htm"><B>JournalPlaybackProc</B></A>, <A HREF="32huo95.htm"><B>JournalRecordProc</B></A>, <A HREF="2qr7.co.htm"><B>KeyboardProc</B></A>, <A HREF="hqw0_a.htm"><B>MouseProc</B></A>, <A HREF="tn9es3.htm"><B>MessageProc</B></A>, <A HREF="3i9jhc5.htm"><B>ShellProc</B></A>, <A HREF="uccnb.htm"><B>SysMsgProc</B></A>, <A HREF="kjrpns.htm"><B>UnhookWindowsHookEx</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
