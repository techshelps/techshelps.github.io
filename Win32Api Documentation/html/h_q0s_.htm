<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Using Named Objects</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="h_q0s_"></A><B>Using Named Objects</B></P>

<P>The following examples illustrate the use of object names by creating and opening named objects.</P>

<P><B>Mutex</B></P>

<P>The first process uses the <A HREF="jeyqaz.htm"><B>CreateMutex</B></A> function to create the mutex object. Note that the function succeeds even if there is an existing object with the same name. </P>

<P>// One process creates the mutex object.</P>

<P></P>

<P>HANDLE hMutex; </P>

<P>DWORD dwErr; </P>

<P>hMutex = CreateMutex( </P>

<P>NULL,                  // no security descriptor</P>

<P>FALSE,                 // mutex not owned</P>

<P>"NameOfMutexObject");  // object name</P>

<P>if (hMutex == NULL) </P>

<P>printf("CreateMutex error: %d\n", GetLastError() ); </P>

<P>else </P>

<P>if ( GetLastError() == ERROR_ALREADY_EXISTS ) </P>

<P>printf("CreateMutex opened existing mutex\n"); </P>

<P>else </P>

<P>printf("CreateMutex created new mutex\n"); </P>

<P>The second process uses the <A HREF="4s0dun.htm"><B>OpenMutex</B></A> function to open a handle of the existing mutex. This function fails if a mutex object with the specified name does not exist. The access parameter requests full access to the mutex object, which is necessary for the handle to be used in any of the wait functions. </P>

<P>// Another process opens a handle of the existing mutex.</P>

<P></P>

<P>HANDLE hMutex; </P>

<P>hMutex = OpenMutex( </P>

<P>MUTEX_ALL_ACCESS,      // request full access</P>

<P>FALSE,                 // handle not inheritable</P>

<P>"NameOfMutexObject");  // object name</P>

<P>if (hMutex == NULL) </P>

<P>printf("OpenMutex error: %d\n", GetLastError() ); </P>

<P></P>

<P><B>Semaphore</B></P>

<P>The following example uses the <A HREF="41re8tu.htm"><B>CreateSemaphore</B></A> function to illustrate a named-object creation operation that fails if the object already exists. </P>

<P>HANDLE CreateNewSemaphore(LPSECURITY_ATTRIBUTES lpsa,  </P>

<P>LONG cInitial, LONG cMax, LPTSTR lpszName) </P>

<P>{ </P>

<P>HANDLE hSem; </P>

<P>// Create or open a named semaphore.</P>

<P>hSem = CreateSemaphore( </P>

<P>lpsa,         // security attributes</P>

<P>cInitial,     // initial count</P>

<P>cMax,         // maximum count</P>

<P>lpszName);    // semaphore name</P>

<P>// Close handle, and return NULL if existing semaphore opened.</P>

<P>if (hSem != NULL &amp;&amp; GetLastError() == ERROR_ALREADY_EXISTS) </P>

<P>{ </P>

<P>CloseHandle(hSem); </P>

<P>return NULL; </P>

<P>}</P>

<P>// If new semaphore was created, return the handle.</P>

<P>return hSem; </P>

<P>}</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
