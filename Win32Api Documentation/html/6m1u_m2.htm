<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>AdjustTokenGroups</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="6m1u_m2"></A><B>AdjustTokenGroups  <A HREF="nhwi29.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1966ja.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="afqqmm.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>AdjustTokenGroups</B> function adjusts groups in the specified access token. TOKEN_ADJUST_GROUPS access is required to enable or disable groups in an access token. </P>

<P><B>BOOL AdjustTokenGroups(</B></P>

<TABLE cols=2 width=567>

<TR VALIGN="top">
<TD width=45%><B>HANDLE</B> <I>TokenHandle</I><B>,</B></TD>
<TD width=55%>// handle to token that contains groups</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    BOOL</B> <I>ResetToDefault</I><B>,</B></TD>
<TD width=55%>// flag for default settings</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    PTOKEN_GROUPS</B> <I>NewState</I><B>,</B></TD>
<TD width=55%>// address of address of new group information</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    DWORD</B> <I>BufferLength</I><B>,</B></TD>
<TD width=55%>// size of buffer for previous information</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    PTOKEN_GROUPS</B> <I>PreviousState</I><B>,</B></TD>
<TD width=55%>// address of previous group information</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    PDWORD</B> <I>ReturnLength</I> </TD>
<TD width=55%>// address of required buffer size</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>   );</B></TD>
<TD width=55%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>TokenHandle</I></P>

<P>Identifies the access token containing the groups to be modified. </P>

<P><I>ResetToDefault</I></P>

<P>Specifies whether the groups are to be set to their default enabled and disabled states. If this value is TRUE, the groups are set to their default states and the <I>NewState</I> parameter is ignored. If this value is FALSE, the groups are set according to the information pointed to by the <I>NewState</I> parameter. </P>

<P><I>NewState</I></P>

<P>Points to a <A HREF="qokoo8.htm"><B>TOKEN_GROUPS</B></A> structure containing the groups whose states are to be set. If the <I>ResetToDefault</I> parameter is FALSE, the function sets each of the groups to the value of that group's SE_GROUP_ENABLED flag in the <B>TOKEN_GROUPS</B> structure. If <I>ResetToDefault</I> is TRUE, this parameter is ignored. </P>

<P><I>BufferLength</I></P>

<P>Specifies the size, in bytes, of the buffer pointed to by the <I>PreviousState</I> parameter. This parameter can be NULL if the <I>PreviousState</I> parameter is NULL. </P>

<P><I>PreviousState</I></P>

<P>Points to a buffer receiving a <A HREF="qokoo8.htm"><B>TOKEN_GROUPS</B></A> structure containing the previous state of any groups the function modifies. The token must be open for TOKEN_QUERY access to use this parameter. This parameter can be NULL. </P>

<P>If a buffer is specified but it does not contain enough space to receive the complete list of modified groups, no group states are changed and the function fails. In this case, the function sets the variable pointed to by the <I>ReturnLength</I> parameter to the number of bytes required to hold the complete list of modified groups. </P>

<P><I>ReturnLength</I></P>

<P>Points to a variable set by the function that contains the actual number of bytes needed for the buffer pointed to by the <I>PreviousState</I> parameter. This parameter can be NULL and is ignored if <I>PreviousState</I> is NULL. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>The information retrieved in the <I>PreviousState</I> parameter is formatted as a <B>TOKEN_GROUPS</B> structure. This means a pointer to the buffer can be passed as the <I>NewState</I> parameter in a subsequent call to the <B>AdjustTokenGroups</B> function, restoring the original state of the groups. </P>

<P>The <I>NewState</I> parameter can list groups to be changed that are not present in the access token. This does not affect the successful modification of the groups in the token. </P>

<P>Mandatory groups cannot be disabled. They are identified by the SE_GROUP_MANDATORY flag in the <B>TOKEN_GROUPS</B> structure. If an attempt is made to disable any mandatory groups, <B>AdjustTokenGroups</B> fails and leaves the state of all groups unchanged. </P>

<P><B>See Also</B></P>

<P><A HREF="1e0u7w4.htm"><B>AdjustTokenPrivileges</B></A>, <A HREF="kt5z95.htm"><B>GetTokenInformation</B></A>, <A HREF="1r9su.q.htm"><B>OpenProcessToken</B></A>, <A HREF="bsqiuv.htm"><B>OpenThreadToken</B></A>, <A HREF="2ido0z..htm"><B>SetTokenInformation</B></A>, <A HREF="qokoo8.htm"><B>TOKEN_GROUPS</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
