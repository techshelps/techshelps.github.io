<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SHARE_INFO_502</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="210h.3o"></A><B>SHARE_INFO_502  <A HREF="19srj0.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="l.g6mo.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="v9hkzc.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>SHARE_INFO_502 </B>structure contains information about the shared resource, including name of the resource, type and permissions, and number of connections.</P>

<P>typedef struct _SHARE_INFO_502 {<BR>
    LPTSTR    shi502_netname;<BR>
    DWORD     shi502_type;<BR>
    LPTSTR    shi502_remark;<BR>
    DWORD     shi502_permissions;<BR>
    DWORD     shi502_max_uses;<BR>
    DWORD     shi502_current_uses;<BR>
    LPTSTR    shi502_path;<BR>
    LPTSTR    shi502_passwd;<BR>
    DWORD     shi502_reserved;<BR>
    PSECURITY_DESCRIPTOR  shi502_security_descriptor;<BR>
} SHARE_INFO_502, *PSHARE_INFO_502, *LPSHARE_INFO_502;</P>

<P></P>

<P><B>Members</B></P>

<P><B>shi502_netname</B></P>

<P>A Unicode string containing the sharename of a resource. </P>

<P><B>shi502_type</B></P>

<P>One of the following four values specifying the type of share:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=45%><B>Value</B></TD>
<TD width=55%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%>STYPE_DISKTREE</TD>
<TD width=55%>Disk Drive</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>STYPE_PRINTQ</TD>
<TD width=55%>Print Queue</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>STYPE_DEVICE</TD>
<TD width=55%>Communication device</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>STYPE_IPC</TD>
<TD width=55%>Interprocess Communication (IPC)</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>shi502_remark</B></P>

<P>Points to a Unicode string containing an optional comment about the shared resource.</P>

<P><B>shi502_permissions</B></P>

<P>Specifies the shared resource's permissions for servers running with share-level security.This member is ignored on a server running user-level security. This member can be any of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%><B>Value</B></TD>
<TD width=67%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ACCESS_READ</TD>
<TD width=67%>Permission to read data from a resource and, by default, to execute the resource.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ACCESS_WRITE</TD>
<TD width=67%>Permission to write data to the resource.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ACCESS_CREATE</TD>
<TD width=67%>Permission to create an instance of the resource (such as a file); data can be written to the resource as the resource is created.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ACCESS_EXEC</TD>
<TD width=67%>Permission to execute the resource.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ACCESS_DELETE</TD>
<TD width=67%>Permission to delete the resource.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ACCESS_ATRIB</TD>
<TD width=67%>Permission to modify the resource's attributes (such as the date and time when a file was last modified).</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ACCESS_PERM</TD>
<TD width=67%>Permission to modify the permissions (read, write, create, execute, and delete) assigned to a resource for a user or application.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ACCESS_ALL</TD>
<TD width=67%>Permission to read, write, create, execute, and delete resources, and to modify their attributes and permissions.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>shi502_max_uses</B></P>

<P>Indicates the maximum number of concurrent connections that the shared resource can accommodate (unlimited if the value specified in <B>shi502_max_uses</B> is -1).</P>

<P><B>shi502_current_uses</B></P>

<P>Specifies the number of current connections to the resource.</P>

<P><B>shi502_path</B></P>

<P>Points to a Unicode string that contains the local path for the shared resource. For disks, <B>shi502_path</B> is the path being shared. For print queues, <B>shi502_path</B> is the name of the print queue being shared.</P>

<P><B>shi502_passwd</B></P>

<P>Specifies the share's password (when the server is running with share-level security). If the server is running with user-level security, <B>shi502_passwd</B> is ignored. The <B>shi502_passwd</B> member can be no longer than SHPWLEN+1 bytes (including a terminating null character).</P>

<P><B>shi502_reserved</B></P>

<P>Must be zero.</P>

<P><B>shi502_security_descriptor</B></P>

<P>Specifies the Windows NT security descriptor associated with this share.</P>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="24mx8w.htm"><B>NetShareAdd</B></A>, <A HREF="328dmh.htm"><B>NetShareEnum</B></A>, <A HREF="ggtuce.htm"><B>NetShareGetInfo</B></A>, <A HREF="_lt2lr.htm"><B>NetShareSetInfo</B></A></P>

</BODY>
</HTML>
