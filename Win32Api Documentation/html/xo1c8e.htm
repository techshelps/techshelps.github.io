<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NetWkstaSetInfo</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="xo1c8e"></A><B>NetWkstaSetInfo  <A HREF="32h9bl4.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="l.g6mo.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="pdpsg.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>NetWkstaSetInfo</B> function configures a workstation. This information remains in effect after the system has been reinitialized.</P>

<P><B>Security Requirements</B></P>

<P>Only members of the Administrators local group can successfully execute <B>NetWkstaSetInfo</B> on a remote server.</P>

<P><B>NET_API_STATUS NetWkstaSetInfo(</B></P>

<TABLE cols=2 width=215>

<TR VALIGN="top">
<TD width=84%><B>LPTSTR </B><I>servername</I><B>,</B></TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=84%><B>    DWORD </B><I>level</I><B>,</B></TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=84%><B>    LPBYTE </B><I>buffer</I><B>,</B></TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=84%><B>    LPDWORD </B><I>parm_err </I></TD>
<TD width=16%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=84%><B>   );</B></TD>
<TD width=16%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>servername</I></P>

<P>Pointer to a Unicode string containing the name of the remote server on which the function is to execute. A NULL pointer or string specifies the local computer.</P>

<P><I>level</I></P>

<P>Specifies one of the following values to set the level of information provided.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=21%><B>Value</B></TD>
<TD width=79%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=21%>100</TD>
<TD width=79%>The <I>buffer</I> parameter points to a <A HREF="1ngooii.htm"><B>WKSTA_INFO_100</B></A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=21%>101</TD>
<TD width=79%>The <I>buffer</I> parameter points to a <A HREF="115cp29.htm"><B>WKSTA_INFO_101</B></A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=21%>102</TD>
<TD width=79%>The <I>buffer</I> parameter points to a <A HREF="116cp29.htm"><B>WKSTA_INFO_102</B></A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=21%>302</TD>
<TD width=79%>The <I>buffer</I> parameter points to a <A HREF="zejqb4.htm"><B>WKSTA_INFO_302</B></A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=21%>402</TD>
<TD width=79%>The <I>buffer</I> parameter points to a <A HREF="1zejqb4.htm"><B>WKSTA_INFO_402</B></A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=21%>1101</TD>
<TD width=79%>The <I>buffer</I> parameter points to a <A HREF="1q9ugd1.htm"><B>WKSTA_USER_INFO_1101</B></A> structure.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>In addition, the structures <B>WKSTA_USER_INFO_502</B>, <B>WKSTA_USER_INFO_1010-1013</B>, <B>WKSTA_USER_INFO_1018</B>, <B>WKSTA_USER_INFO_1023</B>, <B>WKSTA_USER_INFO_1027</B>, <B>WKSTA_USER_INFO_1028</B>, <B>WKSTA_USER_INFO_1032</B>, <B>WKSTA_USER_INFO_1033</B>, <B>WKSTA_USER_INFO_1035</B>, and <B>WKSTA_USER_INFO_1041</B><I>-</I><B>1062 </B>should not be set by the user.</P>

<P><I>buffer</I></P>

<P>Pointer to the buffer in which the data set with the <I>level</I> parameter is stored. </P>

<P><I>parm_num</I></P>

<P>Determines whether the <I>buffer</I> parameter contains a complete <B>WKSTA</B>_<B>INFO</B>_<B><I>X</I></B> (where <I>X</I>is the level) structure or a single structure component. If <I>parm_num</I> is set to PARMNUM_ALL, <I>buffer</I> must point to a <B>WKSTA</B>_<B>INFO_X</B> structure. Otherwise, only one element is changed, and <I>parm_num</I> must point to the single element to change.</P>

<P>Not all elements can be changed. Only those elements that have a specific PARMNUM constant value defined can be set. The following possible values are defined.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=60%><B>Value</B></TD>
<TD width=40%><B>Component to Set</B></TD>
</TR>

<TR VALIGN="top">
<TD width=60%>PARMNUM_ALL</TD>
<TD width=40%>All elements</TD>
</TR>

<TR VALIGN="top">
<TD width=60%>WKSTA_CHARWAIT_PARMNUM</TD>
<TD width=40%><B>wki0_charwait</B></TD>
</TR>

<TR VALIGN="top">
<TD width=60%>WKSTA_CHARTIME_PARMNUM</TD>
<TD width=40%><B>wki0_chartime</B></TD>
</TR>

<TR VALIGN="top">
<TD width=60%>WKSTA_CHARCOUNT_PARMNUM</TD>
<TD width=40%><B>wki0_charcount</B></TD>
</TR>

<TR VALIGN="top">
<TD width=60%>WKSTA_ERRLOGSZ_PARMNUM</TD>
<TD width=40%><B>wki0_errlogsz</B></TD>
</TR>

<TR VALIGN="top">
<TD width=60%>WKSTA_PRINTBUFTIME_PARMNUM</TD>
<TD width=40%><B>wki0_printbuftime</B></TD>
</TR>

<TR VALIGN="top">
<TD width=60%>WKSTA_WRKHEURISTICS_PARMNUM</TD>
<TD width=40%><B>wki0_wrkheuristics</B></TD>
</TR>

<TR VALIGN="top">
<TD width=60%>WKSTA_OTHDOMAINS_PARMNUM</TD>
<TD width=40%><B>wki1_oth_domains</B></TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>parm_err</I></P>

<P>Optional pointer to a <B>DWORD</B> that contains the index of the first parameter that causes ERROR_INVALID_PARAMETER. If NULL, the parameter is not returned on error.</P>

<P></P>

<P><B>Remarks</B></P>

<P>You must be a member of the Administrators local group to successfully execute <B>NetWkstaSetInfo</B> on a remote server or on a computer that has local security enabled. <B>NetWkstaSetInfo</B> does not change values in the LANMAN.INI file. Values set by previous calls to <B>NetWkstaSetInfo</B> can be overwritten when workstation parameters are reset. When the Workstation service is stopped and restarted, parameters are reset to the default values specified in the LANMAN.INI file unless overwritten by command-line parameters.</P>

<P>Domain names in the <B>wki1_oth_domains</B> member of the <A HREF="1q9ugd1.htm"><B>WKSTA_USER_INFO_1101</B></A> structure are separated by spaces. An empty list is valid. A null pointer means to leave the member unmodified. The <B>wki1_oth_domains</B> member cannot be set with MS-DOS. When setting this element, <B>NetWkstaSetInfo</B> rejects the request if the name list was invalid or if a name could not be added to one or more of the network adapters managed by LAN Manager.</P>

<P><B>See Also</B></P>

<P><A HREF="17j20z8.htm"><B>NetWkstaGetInfo</B></A></P>

</BODY>
</HTML>
