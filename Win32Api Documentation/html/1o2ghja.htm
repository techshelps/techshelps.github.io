<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>SHGetFileInfo [Now Supported on Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1o2ghja"></A><B>SHGetFileInfo  <A HREF="e85gf9.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="b2.3c..htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="2ac30z9.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>[Now Supported on Windows NT]</P>

<P>Retrieves information about an object in the file system, such as a file, a folder, a directory, or a drive root.</P>

<P><B>WINSHELLAPI DWORD WINAPI SHGetFileInfo(</B></P>

<TABLE cols=2 width=243>

<TR VALIGN="top">
<TD width=86%><B>LPCTSTR</B> <I>pszPath</I><B>, </B></TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=86%><B>    DWORD</B> <I>dwFileAttributes</I><B>, </B></TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=86%><B>    SHFILEINFO FAR</B> <I>*psfi</I><B>, </B></TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=86%><B>    UINT</B> <I>cbFileInfo</I><B>, </B></TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=86%><B>    UINT</B> <I>uFlags</I></TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=86%><B>   );</B></TD>
<TD width=14%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>pszPath</I></P>

<P>Pointer to a buffer that contains the path and filename. Both absolute and relative paths are valid. If <I>uFlags</I> includes the SHGFI_PIDL, value <I>pszPath</I> must be the address of an <B>ITEMIDLIST</B> structure that contains the list of item identifiers that uniquely identifies the file within the shell's name space. </P>

<P>This string can use either short (the 8.3 form) or long filenames.</P>

<P><I>dwFileAttributes</I></P>

<P>Array of file attribute flags (FILE_ATTRIBUTE_ values). If <I>uFlags</I> does not include the SHGFI_USEFILEATTRIBUTES value, this parameter is ignored.</P>

<P><I>psfi</I> and <I>cbFileInfo</I></P>

<P>Address and size, in bytes, of the <B>SHFILEINFO</B> structure that receives the file information. </P>

<P><I>uFlags</I></P>

<P>Flag that specifies the file information to retrieve. This parameter can be a combination of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=44%>SHGFI_ATTRIBUTES</TD>
<TD width=56%>Retrieves the file attribute flags. The flags are copied to the <B>dwAttributes</B> member of the structure specified by <I>psfi</I>. </TD>
</TR>

<TR VALIGN="top">
<TD width=44%>SHGFI_DISPLAYNAME</TD>
<TD width=56%>Retrieves the display name for the file. The name is copied to the <B>szDisplayName</B> member of the structure specified by <I>psfi</I>.
<P>The returned display name uses the long filename, if any, rather than the 8.3 form of the filename.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>SHGFI_EXETYPE</TD>
<TD width=56%>Returns the type of the executable file if <I>pszPath</I> identifies an executable file. For more information, see the comments below.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>SHGFI_ICON</TD>
<TD width=56%>Retrieves the handle of the icon that represents the file and the index of the icon within the system image list. The handle is copied to the <B>hIcon</B> member of the structure specified by <I>psfi</I>, and the index is copied to the <B>iIcon</B> member. The return value is the handle of the system image list.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>SHGFI_ICONLOCATION</TD>
<TD width=56%>Retrieves the name of the file that contains the icon representing the file. The name is copied to the <B>szDisplayName</B> member of the structure specified by <I>psfi</I>. </TD>
</TR>

<TR VALIGN="top">
<TD width=44%>SHGFI_LARGEICON</TD>
<TD width=56%>Modifies SHGFI_ICON, causing the function to retrieve the file's large icon. </TD>
</TR>

<TR VALIGN="top">
<TD width=44%>SHGFI_LINKOVERLAY</TD>
<TD width=56%>Modifies SHGFI_ICON, causing the function to add the link overlay to the file's icon.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>SHGFI_OPENICON</TD>
<TD width=56%>Modifies SHGFI_ICON, causing the function to retrieve the file's open icon. A container object displays an open icon to indicate that the container is open. </TD>
</TR>

<TR VALIGN="top">
<TD width=44%>SHGFI_PIDL</TD>
<TD width=56%>Indicates that <I>pszPath</I> is the address of an <B>ITEMIDLIST</B> structure rather than a path name. </TD>
</TR>

<TR VALIGN="top">
<TD width=44%>SHGFI_SELECTED</TD>
<TD width=56%>Modifies SHGFI_ICON, causing the function to blend the file's icon with the system highlight color. </TD>
</TR>

<TR VALIGN="top">
<TD width=44%>SHGFI_SHELLICONSIZE</TD>
<TD width=56%>Modifies SHGFI_ICON, causing the function to retrieve a shell-sized icon. If this flag is not specified, the function sizes the icon according to the system metric values. </TD>
</TR>

<TR VALIGN="top">
<TD width=44%>SHGFI_SMALLICON</TD>
<TD width=56%>Modifies SHGFI_ICON, causing the function to retrieve the file's small icon. </TD>
</TR>

<TR VALIGN="top">
<TD width=44%>SHGFI_SYSICONINDEX</TD>
<TD width=56%>Retrieves the index of the icon within the system image list. The index is copied to the <B>iIcon</B> member of the structure specified by <I>psfi</I>. The return value is the handle of the system image list.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>SHGFI_TYPENAME</TD>
<TD width=56%>Retrieves the string that describes the file's type. The string is copied to the <B>szTypeName</B> member of the structure specified by <I>psfi</I>.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>SHGFI_USEFILEATTRIBUTES</TD>
<TD width=56%>Indicates that the function should use the <I>dwFileAttributes</I> parameter.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>To retrieve the executable file type, <I>uFlags</I> must specify only SHGFI_EXETYPE. The return value specifies the type of the executable file: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=41%>0</TD>
<TD width=59%>Nonexecutable file or an error condition.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>LOWORD = NE or PE<BR>
HIWORD = 3.0, 3.5, or 4.0</TD>
<TD width=59%>Windows application</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>LOWORD = MZ<BR>
HIWORD = 0</TD>
<TD width=59%>MS-DOS .EXE, .COM or .BAT file</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>LOWORD = PE<BR>
HIWORD = 0</TD>
<TD width=59%>Win32 console application</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>·Returns a value whose meaning depends on the <I>uFlags</I> parameter. If <I>uFlags</I> specifies the SHGFI_EXETYPE value, the return value indicates the type of the executable file. For more information, see the comments below.</P>

<P>·If <I>uFlags</I> includes the SHGFI_ICON or SHGFI_SYSICONINDEX value, the return value is the handle of the system image list that contains the large icon images. If the SHGFI_SMALLICON value is also included, the return value is the handle of the image list that contains the small icon images. </P>

<P>·If <I>uFlags</I> does not include SHGFI_EXETYPE, SHGFI_ICON, SHGFI_SYSICONINDEX, or SHGFI_SMALLICON, the return value is nonzero the function succeeds, or zero otherwise.</P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
