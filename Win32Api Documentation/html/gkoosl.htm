<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>FindFirstPrinterChangeNotification</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="gkoosl"></A><B>FindFirstPrinterChangeNotification  <A HREF="1.clq95.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="joiq6.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="yhp8x..htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>FindFirstPrinterChangeNotification</B> function creates a change notification object and returns a handle to the object. You can then use this handle in a call to one of the wait functions to monitor changes to the printer or print server. </P>

<P>The <B>FindFirstPrinterChangeNotification</B> call specifies the type of changes to be monitored. You can specify a set of conditions to monitor for changes, a set of printer information fields to monitor, or both.</P>

<P>A wait operation on the change notification handle succeeds when one of the specified changes occurs in the specified printer or print server. You then call the <A HREF="g8frw4.htm"><B>FindNextPrinterChangeNotification</B></A> function to retrieve information about the change, and to reset the change notification object for use in the next wait operation.</P>

<P><B>HANDLE FindFirstPrinterChangeNotification(</B></P>

<TABLE cols=2 width=622>

<TR VALIGN="top">
<TD width=37%><B>HANDLE</B> <I>hPrinter</I><B>,</B></TD>
<TD width=63%>// handle to printer or print server to monitor for changes</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    DWORD</B> <I>fdwFlags</I><B>,</B></TD>
<TD width=63%>// flags that specify the conditions to monitor</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    DWORD</B> <I>fdwOptions</I><B>,</B></TD>
<TD width=63%>// reserved, must be zero</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    LPVOID</B> <I>pPrinterNotifyOptions</I></TD>
<TD width=63%>// pointer to structure specifying printer information to monitor</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>   );</B></TD>
<TD width=63%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hPrinter</I></P>

<P>Handle to the printer or print server that you want to monitor. This handle is obtained by calling the <A HREF="9gwvgs.htm"><B>OpenPrinter</B></A> function.</P>

<P><I>fdwFlags</I></P>

<P>A set of bit flags that specify the conditions that will cause the change notification object to enter a signaled state. A change notification occurs when one or more of the specified conditions are met. The <I>fdwFlags</I> parameter can be zero if <I>pPrinterNotifyOptions</I> is non-NULL. </P>

<P>You can set one or more of the following change notification constants: </P>

<TABLE cols=3>

<TR VALIGN="top">
<TD width=18%><B>Value</B></TD>
<TD width=69%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>PRINTER_CHANGE_FORM</TD>
<TD colspan=20 width=1798478739%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=18%>&nbsp;</TD>
<TD width=69%>Notify of any changes to a form. You can set this general flag or one or more of the following specific flags:<BR>
PRINTER_CHANGE_ADD_FORM PRINTER_CHANGE_SET_FORM PRINTER_CHANGE_DELETE_FORM</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>PRINTER_CHANGE_JOB</TD>
<TD colspan=20 width=1798478739%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=18%>&nbsp;</TD>
<TD width=69%>Notify of any changes to a job. You can set this general flag or one or more of the following specific flags:<BR>
PRINTER_CHANGE_ADD_JOB PRINTER_CHANGE_SET_JOB PRINTER_CHANGE_DELETE_JOB PRINTER_CHANGE_WRITE_JOB</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>PRINTER_CHANGE_PORT</TD>
<TD colspan=20 width=1798478739%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=18%>&nbsp;</TD>
<TD width=69%>Notify of any changes to a port. You can set this general flag or one or more of the following specific flags:<BR>
PRINTER_CHANGE_ADD_PORT PRINTER_CHANGE_CONFIGURE_PORT PRINTER_CHANGE_DELETE_PORT</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>PRINTER_CHANGE_PRINT_PROCESSOR</TD>
<TD colspan=20 width=1798478739%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=18%>&nbsp;</TD>
<TD width=69%>Notify of any changes to a print processor. You can set this general flag or one or more of the following specific flags: PRINTER_CHANGE_ADD_PRINT_PROCESSOR PRINTER_CHANGE_DELETE_PRINT_PROCESSOR </TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>PRINTER_CHANGE_PRINTER</TD>
<TD colspan=20 width=1798478739%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=18%>&nbsp;</TD>
<TD width=69%>Notify of any changes to a printer. You can set this general flag or one or more of the following specific flags: <BR>
PRINTER_CHANGE_ADD_PRINTER PRINTER_CHANGE_SET_PRINTER PRINTER_CHANGE_DELETE_PRINTER PRINTER_CHANGE_FAILED_CONNECTION_PRINTER</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>PRINTER_CHANGE_PRINTER_DRIVER</TD>
<TD colspan=20 width=1798478739%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=18%>&nbsp;</TD>
<TD width=69%>Notify of any changes to a printer driver. You can set this general flag or one or more of the following specific flags:<BR>
PRINTER_CHANGE_ADD_PRINTER_DRIVER PRINTER_CHANGE_SET_PRINTER_DRIVER PRINTER_CHANGE_DELETE_PRINTER_DRIVER</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>PRINTER_CHANGE_ALL</TD>
<TD colspan=20 width=1798478739%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=18%>&nbsp;</TD>
<TD width=69%>Notify if any of the preceding changes occur.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>For descriptions of the more specific flags in the preceding table, see the <A HREF="g8frw4.htm"><B>FindNextPrinterChangeNotification</B></A> function.</P>

<P><I>fdwOptions</I></P>

<P>Reserved; must be zero.</P>

<P><I>pPrinterNotifyOptions</I></P>

<P>Pointer to a <A HREF="lqsae6.htm"><B>PRINTER_NOTIFY_OPTIONS</B></A> structure. The <B>pTypes</B> member of this structure points to an array of one or more <B>PRINTER_NOTIFY_OPTIONS_TYPE</B> structures, each of which specifies a printer information field to monitor. A change notification occurs when one or more of the specified fields changes. When a change occurs, the <B>FindNextPrinterChangeNotification</B> function can retrieve the new printer information. This parameter can be NULL if <I>fdwFlags</I> is nonzero. </P>

<P>For a list of fields that can be monitored, see <A HREF="18b96ve.htm"><B>PRINTER_NOTIFY_OPTIONS_TYPE</B></A>.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is a handle to a change notification object associated with the specified printer or print server.</P>

<P>If the function fails, the return value is INVALID_HANDLE_VALUE. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>.</P>

<P><B>Remarks</B></P>

<P>To monitor a printer or print server, call the <B>FindFirstPrinterChangeNotification </B>function, then use the returned change notification object handle in a call to one of the <A HREF="y2tc_3.htm">wait functions</A>.<B> </B>A wait operation on a change notification object is satisfied when the change notification object enters the signaled state. The system signals the object when one or more of the changes specified by <I>fdwFlags</I> or <I>pPrinterNotifyOptions</I> occurs in the monitored printer or print server.</P>

<P>When you call <B>FindFirstPrinterChangeNotification</B>, either <I>fdwFlags</I> must be nonzero or <I>pPrinterNotifyOptions</I> must be non-NULL. If both are specified, notifications will occur for both.</P>

<P>When a wait operation on a printer change notification object is satisfied, call the <A HREF="g8frw4.htm"><B>FindNextPrinterChangeNotification</B></A> function to determine the cause of the notification. For a condition specified by <I>fdwFlags</I>, <B>FindNextPrinterChangeNotification</B> reports the condition or conditions that changed. For a printer information field specified by <I>pPrinterNotifyOptions</I> , <B>FindNextPrinterChangeNotification</B> reports the field or fields that changed as well as the new information for these fields. <B>FindNextPrinterChangeNotification</B> also resets the change notification object to the nonsignaled state so you can use it in another wait operation to continue monitoring the printer or print server.</P>

<P>Do not call the <B>FindNextPrinterChangeNotification</B> function if the change notification object is not in the signaled state. If the wait function returns the value WAIT_TIMEOUT, the change object is not in the signaled state. Call the <B>FindNextPrinterChangeNotification</B> function only if the wait function succeeds without timing out.</P>

<P>When you no longer need the change notification object, close it by calling the <A HREF="cs79c2.htm"><B>FindClosePrinterChangeNotification</B></A> function.</P>

<P>The three <B>Find*PrinterChangeNotification </B>functions, in combination with the wait functions, provide an asynchronous and resource-efficient alternative to the <A HREF="1n73lvh.htm"><B>WaitForPrinterChange</B></A> function.</P>

<P><B>See Also</B></P>

<P><A HREF="cs79c2.htm"><B>FindClosePrinterChangeNotification</B></A>, <A HREF="g8frw4.htm"><B>FindNextPrinterChangeNotification</B></A>, <A HREF="9gwvgs.htm"><B>OpenPrinter</B></A>, <A HREF="lqsae6.htm"><B>PRINTER_NOTIFY_OPTIONS</B></A>, <A HREF="18b96ve.htm"><B>PRINTER_NOTIFY_OPTIONS_TYPE</B></A>, <A HREF="1n73lvh.htm"><B>WaitForPrinterChange</B></A> </P>

</BODY>
</HTML>
