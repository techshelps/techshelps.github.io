<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<title>MoreResults Method Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="rdpromoreresultsx"></a>MoreResults Method Example</h1>
<p>
The following example illustrates use of the <b>MoreResults</b> method. In this example, an SQL query containing three separate SELECT queries is executed. The first query simply returns the number of publishers in the <i>Publishers</i> table. The next two queries each return two columns resulting from more complex join operations. All of this information is displayed in a <b>ListBox</b> control.</p>
<pre><code>Option Explicit
Dim Cn As New rdoConnection
Dim Rs As rdoResultset
Dim SQL As String

Private Sub Test_Click()
SQL = "Select Count(*) From Publishers" _
   &amp; " Select Pub_Name, Title&nbsp; " _
   &amp; " From Publishers P, Titles T" _
   &amp; " Where P.Pub_ID = T.Pub_ID" _
   &amp; " Select Au_Lname, Title " _
   &amp; " From Titles T, TitleAuthor Ta, Authors A" _
   &amp; " Where T.title_ID = ta.Title_ID " _
   &amp; " and Ta.Au_ID = A.Au_ID"
Set Rs = Cn.OpenResultset(SQL, rdOpenForwardOnly, _
   rdConcurReadOnly)
' From the first set of results
List1.AddItem "Publishers: " &amp; Rs(0)&nbsp; 
'
'&nbsp;&nbsp; Loop through all of the remaining result sets
'
Do While Rs.MoreResults
   List1.AddItem Rs(0).Name &amp; " - " &amp; Rs(1).Name
   Do Until Rs.EOF
      List1.AddItem Rs(0) &amp; "&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp; " &amp; Rs(1)
      Rs.MoveNext
   Loop
Loop
End Sub

Private Sub Form_Load()
On Error GoTo CnEh
With Cn
   .Connect = "UID=;PWD=;Database=Pubs;" _
   &amp; "Server=SEQUEL;Driver={SQL Server}" _
   &amp; "DSN='';"
   .LoginTimeout = 5
   .CursorDriver = rdUseOdbc
   .EstablishConnection rdDriverNoPrompt, True
End With
Exit Sub

CnEh:
Dim er As rdoError
Debug.Print Err, Error
For Each er In rdoErrors
   Debug.Print er.Description, er.Number
Next er
Resume Next
End Sub
</code></pre>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
