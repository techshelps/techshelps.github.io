<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<title>RowsAffected Property Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="rdprorowsaffectedx"></a>RowsAffected Property Example</h1>
<p>
This example illustrates use of the <b>RowsAffected</b> property to determine the number of rows changed by an ambiguous update statement. In this case we do not know how many authors live in Salt Lake City, but once the update takes place, we can determine how many rows were updated by checking the <b>RowsAffected</b> property of the <b>rdoQuery</b> object.</p>
<pre><code>Option Explicit
Dim SQL As String
Dim cn as rdoConnection
Dim qd as rdoQuery

Private Sub Form_Load()
Set cn = rdoEnvironments(0).OpenConnection( _
  dsname:="WorkDB", _
  Prompt:=rdDriverNoPrompt, _
  Connect:="uid=;pwd=;database=pubs")
  
SQL = "Update Authors Set Zip = ?" _
  &amp; " Where City = ?"
Set qd = cn.CreateQuery("FixZip", SQL)
End Sub

Private Sub UpdateButton_Click()
qd(0) = NewZip      ' From a TextBox 
qd(1) = CityToFind   ' From a TextBox
ps.Execute
NumberChanged = qd.<span class=cfe><b>RowsAffected</b></span>
End Sub</code></pre>
</BODY>
</HTML>
