<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<title>rdoResultset Object, rdoResultsets Collection Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="rdobjrdoresultsetobjectx"></a>rdoResultset Object, rdoResultsets Collection Example</h1>
<p>
The following example illustrates execution of a multiple result set query. While this query uses three SELECT statements, only two return rows to your application. The subquery used instead of a join does not pass rows outside the scope of the query itself. This is also an example of a simple parameter query that concatenates the arguments instead of using an <b>rdoQuery</b> to manage the query. The <b>OpenResultset</b> also runs asynchronously – the code checks for completion of the operation by polling the <b>StillExecuting</b> property.</p>
<pre><code>Private Sub ShowResultset_Click()
Dim rs As rdoResultset
Dim cn As New rdoConnection
Dim cl As rdoColumn
Dim SQL As String
Const None As String = ""

cn.Connect = "uid=;pwd=;server=SEQUEL;" _
 &nbsp;&nbsp; &amp; "driver={SQL Server};database=pubs;" _
 &nbsp;&nbsp; &amp; "DSN='';"
 &nbsp;&nbsp; 
cn.CursorDriver = rdUseOdbc
cn.EstablishConnection rdDriverNoPrompt

SQL = "Select Au_Lname, Au_Fname" _
 &nbsp;&nbsp; &amp; " From Authors A" _
 &nbsp;&nbsp; &amp; " Where Au_ID in " _
 &nbsp;&nbsp; &amp; " (Select Au_ID" _
 &nbsp;&nbsp; &amp; "&nbsp;&nbsp;&nbsp;&nbsp; from TitleAuthor TA, Titles T" _
 &nbsp;&nbsp; &amp; "&nbsp;&nbsp;&nbsp;&nbsp; Where TA.Au_ID = A.Au_ID" _
 &nbsp;&nbsp; &amp; "&nbsp;&nbsp;&nbsp;&nbsp; And TA.Title_ID = T.Title_ID " _
 &nbsp;&nbsp; &amp; "&nbsp;&nbsp;&nbsp;&nbsp; And T.Title Like '" _
 &nbsp;&nbsp; &amp; InputBox("Enter search string", , "C") &amp; "%')" _
 &nbsp;&nbsp; &amp; "Select * From Titles Where price &gt; 10"

Set rs = cn.OpenResultset(SQL, rdOpenKeyset, _
 &nbsp;&nbsp; rdConcurReadOnly, rdAsyncEnable + rdExecDirect)
 &nbsp;&nbsp; 
Debug.Print "Executing ";
While rs.StillExecuting
 &nbsp;&nbsp; Debug.Print ".";
 &nbsp;&nbsp; DoEvents
Wend

Do
 &nbsp;&nbsp; Debug.Print String(50, "-")&nbsp; _
   &amp; "Processing Result Set " &amp; String(50, "-")
 &nbsp;&nbsp; For Each cl In rs.rdoColumns
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print cl.Name,
 &nbsp;&nbsp; Next
 &nbsp;&nbsp; Debug.Print
 &nbsp;&nbsp; 
 &nbsp;&nbsp; Do Until rs.EOF
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each cl In rs.rdoColumns
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print cl.Value,
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rs.MoveNext
 &nbsp;&nbsp; Debug.Print
 &nbsp;&nbsp; Loop
 &nbsp;&nbsp; Debug.Print "Row count="; rs.RowCount
 &nbsp;&nbsp; 
Loop Until rs.MoreResults = False
End Sub
</code></pre>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
