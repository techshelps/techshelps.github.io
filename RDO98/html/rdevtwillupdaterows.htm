<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>WillUpdateRows Event</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="rdevtwillupdaterows"></a>WillUpdateRows Event</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="rdevtWillUpdateRows_C;rdevtWillUpdateRowsC;vbproBooksOnlineJumpTopic">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="rdevtWillUpdateRows_X;rdevtWillUpdateRowsX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="rdevtWillUpdateRows_A;rdevtWillUpdateRowsA">
</object></p>
<p>
Occurs before an update to the database occurs.</p>
<p>
<b>Private Sub</b> <i>object</i><b>.WillUpdateRows</b>(<i>ReturnCode </i>as <b>Integer</b>)</p>
<p>
The WillUpdateRows event syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=30%><b>Part</b></td>
<td class=label width=70%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=30%><i>object</i></td>
<td width=70%>An <a href="rddefobjectexpression.htm">object expression</a> that evaluates to an object in the Applies To list.</td>
</tr>
<tr valign=top>
<td width=30%><i>ReturnCode</i></td>
<td width=70%>An Integer expression or constant indicating whether the developer handled the update or not as described in Settings.</td>
</tr>
</table><br>
<p>
The <b><i>ReturnCode</i></b> argument is used to notify RDO about what your code did during the event handling. The possible values for this argument are as follows:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=41%><b>Setting</b></td>
<td class=label width=59%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=41%><b>rdUpdateSuccessful</b></td>
<td width=59%>Your code handled the update and was successful in doing so.</td>
</tr>
<tr valign=top>
<td width=41%><b>rdUpdateWithCollisions</b></td>
<td width=59%>Your code handled the update successfully, but some rows produced collisions (batch mode only).</td>
</tr>
<tr valign=top>
<td width=41%><b>rdUpdateFailed</b></td>
<td width=59%>Your code attempted to handle the update, but encountered an error when doing so.</td>
</tr>
<tr valign=top>
<td width=41%><b>rdUpdateNotHandled</b></td>
<td width=59%>Your code did not handle the update. RDO should continue notifying and if no one handles the update, RDO should update the data itself.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
The WillUpdateRows event is raised before updated, new and deleted rows are committed to the server. You can override the update behavior of the cursor by responding to this event and perform your own updates using stored procedures or any other mechanism you choose.</p>
<p>
If the result set is using batch optimistic concurrency, this event is only raised when the <b>BatchUpdate</b> method is called. In this case, the&nbsp; entire set of changes is about to be transmitted to the server.</p>
<p>
If the result set is not in a batch mode, the WillUpdateRows event is raised for each call to the <b>Update</b> method, since the changes for that row are immediately sent to the server.</p>
<p>
To summarize, no matter what mode the result set is in, this event is only raised before data is actually sent to the server.</p>
<p>
If you set the <b><i>ReturnCode</i></b> argument to <b>rdUpdateSuccessful</b>, RDO assumes that your code successfully handled the update. RDO will not send this event to any additional clients (if there is more than one handler of this event) and the status for the row(s) and their columns is set to <b>rdRowUnmodified</b> and <b>rdColUnmodified</b> respectively.</p>
<p>
If you set the <b><i>ReturnCode</i></b> parameter to <b>rdUpdateWithCollisions</b>, RDO&nbsp; assumes that you have successfully handled the update, but some rows caused collisions. RDO will not send this event to any additional clients (if there was more than one handler of this event) and the status for the rows and their columns is not changed. It is your code's responsibility to set the column status flags during the handling of this event. The <b>rdUpdateWithCollisions</b> would only be used if you are using batch optimistic concurrency and you wanted to check for and handle collisions in code.</p>
<p>
If the developer sets the <b><i>ReturnCode</i></b> parameter to <b>rdUpdateFailed</b>, RDO assumes that your code attempted to handle the update, but encountered an error while doing so. RDO will not send this event to any additional clients (if there was more than one handler of this event) and the status for the row(s) and their columns remains unchanged. Finally, RDO generates a runtime error to be trapped by the <b>Update</b> method causing the WillUpdate event to fire.</p>
<p>
If you set the <b><i>ReturnCode</i></b> parameter to <b>rdUpdateNotHandled</b>, RDO will assume that the developer did not handle the update, and RDO will continue to raise this event to all remaining clients (if there was more than one handler of this event). If all clients return rdUpdateNotHandled, RDO will perform the update itself, according the normal rules.</p>
<p>
The default value for the <b><i>ReturnCode</i></b> parameter is <b>rdUpdateNotHandled</b>, so if no client sinks the event, or no client changes the value of <b><i>ReturnCode</i></b>, RDO will perform the update.</p>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
