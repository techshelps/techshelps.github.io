<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<title>OpenConnection Method (Remote Data)</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="rdmthopenconnection"></a>OpenConnection Method (Remote Data)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="rdmthOpenConnection_C;rdmthOpenConnectionC;vbproBooksOnlineJumpTopic">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="rdmthOpenConnection_X;rdmthOpenConnectionX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="rdmthOpenConnection_A;rdmthOpenConnectionA">
</object></p>
<p>
Opens a connection to an <a href="rddefodbcdatasource.htm">ODBC data source</a> and returns a reference to the <b>rdoConnection</b> object that represents a specific <a href="rddefdatabase.htm">database</a>.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>Set</b> <i>connection</i> = <i>environment</i><b>.OpenConnection(</b><i>dsName</i>[, <i>prompt</i>[, <i>readonly</i>[, <i>connect</i>[, <i>options</i>]]]]<b>)</b></p>
<p>
The <b>OpenConnection</b> method syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=30%><b>Part</b></td>
<td class=label width=70%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=30%><i>connection</i></td>
<td width=70%>An <a href="rddefobjectexpression.htm">object expression</a> that evaluates to an <b>rdoConnection</b> object that you’re opening.</td>
</tr>
<tr valign=top>
<td width=30%><i>environment</i></td>
<td width=70%>An object expression<b> </b>that evaluates to an existing <b>rdoEnvironment</b> object. You must provide an <b>rdoEnvironment</b> object. </td>
</tr>
<tr valign=top>
<td width=30%><i>dsName</i></td>
<td width=70%>A <a href="rddefstringexpression.htm">string expression</a> that is the name of a registered <a href="rddefodbcdatasource.htm">ODBC data source</a> name or a zero-length <a href="rddefzerolengthstring.htm">string</a> (“”) as described in Settings.</td>
</tr>
<tr valign=top>
<td width=30%><i>prompt</i></td>
<td width=70%>A <a href="rddefvariantdatatype.htm">Variant</a> or constant that determines how the operation is carried out, as specified in Settings.</td>
</tr>
<tr valign=top>
<td width=30%><i>readonly</i></td>
<td width=70%>A <a href="rddefboolean.htm">Boolean</a> value that is <b>True</b> if the connection is to be opened for read-only access, and <b>False</b> if the connection is to be opened for read/write access. If you omit this argument, the connection is opened for read/write access.</td>
</tr>
<tr valign=top>
<td width=30%><i>connect</i></td>
<td width=70%>A string expression used to pass arguments to the ODBC driver manager for opening the database — the <i>connect string</i> as described in Settings.</td>
</tr>
<tr valign=top>
<td width=30%><i>options</i></td>
<td width=70%>A <a href="rddefvariantdatatype.htm">Variant</a> or constant that determines how the operation is carried out, as specified in Settings.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
The <b><i>connect</i></b> argument constitutes the ODBC connect arguments, and is dependent on the ODBC driver. See the <b>Connect</b> property for syntax and typical settings. If the <b><i>connect</i></b> argument is an empty string (“”), the user name and password are taken from the <b>rdoEnvironment</b> object’s <b>UserName</b> and <b>Password</b> properties, and a <b><i>dsName</i></b> argument <i>must</i> be provided.</p>
<p>
If the provided <b><i>dsName</i></b> doesn’t refer to a valid ODBC data source name, and the Data Source Name (DSN) parameter does not appear in the <b><i>connect</i></b> argument an error occurs if <i>prompt</i> is <b>rdDriverNoPrompt</b>; otherwise, the user is prompted to select from a list of registered data source names. If <b><i>dsName</i></b> is a zero-length string, the connect string must indicate the driver and server names.</p>
<p>
Based on the <b><i>prompt</i></b> value, the <a href="rddefodbcdrivermanager.htm">ODBC driver manager</a> exposes a dialog which prompts the user for connection information such as DSN, user name, and password. Use one of the following constants that defines how the user should be prompted:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=28%><i><b>prompt</b> </i><b>Constant</b></td>
<td class=label width=11%><b>Value</b></td>
<td class=label width=61%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=28%><b>rdDriverPrompt</b></td>
<td width=11%>0</td>
<td width=61%>The driver manager displays the ODBC Data Sources dialog box. The connection string used to establish the connection is constructed from the DSN selected and completed by the user via the dialog boxes, or, if no DSN is chosen and the <b>DataSourceName</b> property is empty (in the case of the <a href="rddefdata.htm">RemoteData control</a>), the default DSN is used.</td>
</tr>
<tr valign=top>
<td width=28%><b>rdDriverNoPrompt</b></td>
<td width=11%>1</td>
<td width=61%>The driver manager uses the connection string provided in <i>dsName</i> and <i>connect</i>. If sufficient information is not provided, the <b>OpenConnection</b> method returns a trappable error.</td>
</tr>
<tr valign=top>
<td width=28%><b>rdDriverComplete</b></td>
<td width=11%>2</td>
<td width=61%>(Default) If the connection string provided includes the DSN keyword, the driver manager uses the string as provided in <i>connect</i>. Otherwise it behaves as it does when <b>rdDriverPrompt</b> is specified.</td>
</tr>
<tr valign=top>
<td width=28%><b>rdDriverCompleteRequired</b></td>
<td width=11%>3</td>
<td width=61%>Behaves like <b>rdDriverComplete</b> except the driver disables the controls for any information not required to complete the connection. If the controls are disabled, users cannot select or specify missing arguments.</td>
</tr>
</table><br>
<p>
You can use the following constant for the <b><i>options</i></b> argument:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=33%><b><i>options</i> Constant</b></td>
<td class=label width=33%><b>Value</b></td>
<td class=label width=34%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=33%><b>rdAsyncEnable</b></td>
<td width=33%>32</td>
<td width=34%>Execute operation <a href="rddefasynchronous.htm">asynchronously</a>.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
When you successfully execute the <b>OpenConnection</b> method, a new <b>rdoConnection</b> object is instantiated and added to the <b>rdoConnections </b>collection, and a network connection is established to the remote server. If the connection cannot be established, no object is created and a trappable error is fired.</p>
<p class=indent>
<B><b>Note</b></B> &nbsp; RDO 2.0 behaves differently than RDO 1.0 in how it handles orphaned references to <b>rdoConnection</b> objects. When you Set a variable already assigned to an <b>rdoConnection</b> object with another <b>rdoConnection</b> object using the <b>OpenConnection</b> method, the existing <b>rdoConnection</b> object is closed and dropped from the <b>rdoConnections</b> collection. In RDO 1.0, the existing object remained open and was left in the <b>rdoConnections</b> collection.</p>
<p>
If you set the <b><i>options</i></b> argument to <b>rdAsyncEnable</b>, the connection operation is executed asynchronously. That is, control returns to your application before the connection has been established to prevent your application from blocking while the connection is being made. You can check for completion of the connection by polling the <b>rdoConnection</b> object’s <b>StillConnecting</b> property, which returns <b>False</b> when the connection operation is complete. You can also code an event procedure for the Connect event which is fired when the connect operation is complete. If you use the <b>Cancel</b> method while waiting for an asynchronous connection to be established, the connection attempt is abandoned.</p>
<p>
Before the process of establishing a connection is started, the BeforeConnect event is fired. This event procedure permits you to examine and modify the connect string and prompt levels as needed.</p>
<p>
There are a variety of reasons why a connection might not be made. These include but are not limited to the following:
<ul type=disc>
<li>
Lack of proper user ID and password.<br><br></li>
<li>
Incorrect driver or options configuration.<br><br></li>
<li>
Lack of correct network or server permissions.<br><br></li>
<li>
The remote server could not be found on the network, or is not operating.<br><br></li>
<li>
The remote server did not have sufficient resources or connections to permit another user to connect.</li>
</ul>
<p class=label>
<b>DSN-Less Connections</b></p>
<p>
In some cases, it might not be necessary to create and register a Data Source Name (DSN) before attempting to open a connection to a data source. If your remote server uses the named pipes LAN protocol and the default OEMTOANSI settings, you can simply provide the name of the server and ODBC driver in the connect string. You must provide an empty DSN entry in the connect string, or in the dsName parameter as the <b><i>last</i></b> argument. If the ODBC driver manager finds a null DSN entry, it attempts to locate it unless it has already determined the driver and server values. The connect string shown below is used to establish a DSN-less connection to a SQL Server named “BETAV486”:</p>
<pre><code>Connect = "UID=;PWD=;Database=WorkDB;" _
&amp; "Server=BETAV486;Driver={SQL Server}" _
&amp; "DSN='';"
</code></pre>
<p class=label>
<b>Other Connect String Options</b></p>
<p>
Establishing an <b>rdoConnection</b> may require that the user specified by the <b>UserName</b> property, or UID connect string argument have <a href="rddefpermission.htm">permission</a> to access the network, the specific data source server, and the chosen database on that server. Failure to meet these qualifications might result in failure to connect.</p>
<p>
If you do not specify a database either through the DATABASE parameter of the <b><i>connect</i></b> argument or through the data source entry, the database opened when you establish a connection is determined by the default database assigned to the user by the database administrator. In some cases, you can change the default database by executing an <a href="rddefactionquery.htm">action query</a> containing an <a href="rddefstructuredquerylanguagesql.htm">SQL</a> command such as the Transact SQL USE <i>database</i> statement.</p>
<p class=indent>
<B><b>Note</b></B> &nbsp; The <i>connect</i> part of the <b>OpenConnection</b> method is coded differently than the <i>source</i> part of the <b>OpenDatabase</b> method as used with <a href="rddefdao.htm">DAO</a>. The <i>connect</i> part neither requires nor supports use of the “ODBC;” keyword at the beginning of the connect string. In addition, the <i>connect</i> part does not support use of the LOGINTIMEOUT argument &nbsp;– use the <b>LoginTimeout</b> property of the <b>rdoEnvironment</b> object instead.</p>
<p>
Use the <b>Close</b> method on the object to close a database associated with an <b>rdoConnection</b>, remove the connection from the <b>rdoConnections</b> collection, and disconnect from the data source.</p>
<p>
You can also declare a new <b>rdoConnection</b> object using the <b>Dim</b> statement as follows:</p>
<pre><code>Dim myCn as New rdoConnection
</code></pre>
<p>
Once instantiated in this manner, you can set the <b>rdoConnection</b> properties as required, and use the <b>EstablishConnection</b> method to open the connection.</p>
<p>
For more information about <a href="rddefodbcdriver.htm">ODBC drivers</a> and the specific connect string arguments they require, see the Help file provided with the driver.</p>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
