<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>LastModified Property Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="rdprolastmodifiedx"></a>LastModified, Bookmark Properties Example</h1>
<p>
This example illustrates use of the <b>LastModified</b> property to reposition the current row pointer to the row most recently modified by RDO. The code opens a connection against SQL Server and creates a keyset cursor-based query on the Authors table. The query expects a single parameter to pass in the name of the Author to edit. Once selected, edited and updated, the row pointer is repositioned to the last row modified by setting the bookmark property of the <b>rdoResultset</b> to the <b>LastModified</b> property.</p>
<pre><code>Option Explicit
Dim er As rdoError
Dim cn As New rdoConnection
Dim qy As New rdoQuery
Dim rs As rdoResultset
Dim col As rdoColumn

Private Sub TestLM_Click()
qy(0) = LookFor.Text

rs.Edit
rs!City = NewCity.Text   ' a TextBox control
rs.Update

rs.<span class=cfe><b>Bookmark</b></span> = rs.<span class=cfe><b>LastModified</b></span>

'Simply show data in picture control
Pic.Cls   'Clear the picture control.

For Each col In rs.rdoColumns
 &nbsp;&nbsp; Pic.Print col.Name,   
Next
Pic.Print String(80, "-")
For Each col In rs.rdoColumns
 &nbsp;&nbsp; Pic.Print col,
Next

End Sub

Private Sub Form_Load()
cn.CursorDriver = rdUseOdbc
cn.Connect = "uid=;pwd=;server=sequel;" _
   &amp; "driver={SQL Server};database=pubs;dsn='';"
cn.EstablishConnection

With qy
 &nbsp;&nbsp; .Name = "ShowWhite"
 &nbsp;&nbsp; .SQL = "Select * from Authors " _
      &amp; " where Au_LName like ?"
 &nbsp;&nbsp; .LockType = rdConcurReadOnly
 &nbsp;&nbsp; .CursorType = rdOpenForwardOnly
 &nbsp;&nbsp; .RowsetSize = 1
 &nbsp;&nbsp; Set .ActiveConnection = cn
End With

qy(0) = LookFor.Text      ' a textbox control
Set rs = qy.OpenResultset(rdOpenKeyset, rdConcurRowver)

Exit Sub
End Sub
</code></pre>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
