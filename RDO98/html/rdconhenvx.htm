<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<title>hEnv, hDbc, hStmt Property Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="rdconhenvx"></a>hEnv Property Example</h1>
<p>
The following example illustrates use of the <b>hEnv</b> property when accessing an ODBC API function. This code displays all registered data source names (DSNs) in a <b>ListBox</b> control.</p>
<pre><code>Private Sub ShowDSNs_Click()
Dim fDirection As Integer
Dim szDSN As String * 1024
Dim cbDSNMax As Integer
Dim pcbDSN As Integer
Dim szDescription As String * 1024
Dim cbDescriptionMax As Integer
Dim pcbDescription As Integer
Dim Item As String
Set En = rdoEnvironments(0)
fDirection = SQL_FETCH_NEXT
cbDSNMax = 1023
cbDescriptionMax = 1023
List1.Clear
I = SQL_SUCCESS
 While I = SQL_SUCCESS
 &nbsp;&nbsp;&nbsp; szDSN = String(1024, " ")
 &nbsp;&nbsp;&nbsp; szDescription = String(1024, " ")
 &nbsp;&nbsp;&nbsp; I = SQLDataSources(En.<span class=cfe><b>hEnv</b></span>, fDirection, szDSN, _
 &nbsp;&nbsp;&nbsp; cbDSNMax, pcbDSN, szDescription, _
 &nbsp;&nbsp;&nbsp; cbDescriptionMax, pcbDescription)
 &nbsp;&nbsp;&nbsp; Item = Left(szDSN, pcbDSN) &amp; " - "&nbsp; _
      &amp; Left(szDescription, pcbDescription)
 &nbsp;&nbsp;&nbsp; Debug.Print Item
 &nbsp;&nbsp;&nbsp; List1.AddItem Item
 Wend

End Sub
</code></pre>
</BODY>
</HTML>
