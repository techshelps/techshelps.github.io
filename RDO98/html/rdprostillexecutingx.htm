<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>StillExecuting Property Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="rdprostillexecutingx"></a>StillExecuting Property Example</h1>
<p>
This example illustrates use of the <b>StillExecuting</b> property to monitor the progress of a query that is expected to take more than a few seconds. By enabling RDO's asynchronous mode, control returns to the application long before the query is complete. While waiting for the <b>StillExecuting</b> property to return <b>False</b>, we display a progress bar that has been programmed to reflect the length of time that the query is expected to take. Note that if this time is exceeded, the progress bar is re-calibrated to reflect the longer duration.</p>
<pre><code>Dim rdoCn As New rdoConnection
Dim rdoRs As rdoResultset
Dim SQL As String
Dim TimeExpected As Single
Dim Ts As Single, Tn As Single

With rdoCn
 &nbsp;&nbsp; .Connect = "UID=;PWD=;Database=WorkDB;" _
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp; "Server=SEQUEL;Driver={SQL Server}" _
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp; "DSN='';"
 &nbsp;&nbsp; .LoginTimeout = 5
 &nbsp;&nbsp; .EstablishConnection rdDriverNoPrompt, True
 &nbsp;&nbsp; 
 &nbsp;&nbsp; SQL = "Execute VeryLongProcedure"
 &nbsp;&nbsp; TimeExpected = 20 ' We expect this to take 60 sec.
 &nbsp;&nbsp; 
    Set rdoRs = .OpenResultset(Name:=SQL, _
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type:=rdOpenForwardOnly, _
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LockType:=rdConcurReadOnly, _
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Option:=rdAsyncEnable)
 &nbsp;&nbsp; Ts = Timer
 &nbsp;&nbsp; ProgressBar1.Max = TimeExpected 
 &nbsp;&nbsp; While rdoRs.<span class=cfe><b>StillExecuting</b></span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Tn = Int(Timer - Ts)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Tn &lt; TimeExpected Then
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProgressBar1 = Tn
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProgressBar1.Max = ProgressBar1.Max + 10
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TimeExpected = ProgressBar1.Max
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DoEvents
 &nbsp;&nbsp; Wend
 &nbsp;&nbsp; Status = "Query done. Duration:" &amp; Int(Timer - Ts)
 &nbsp;&nbsp; 
End With
rdoRs.Close
rdoCn.Close
</code></pre>
</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
