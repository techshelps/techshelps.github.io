<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<title>CursorType Property Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="rdprocursortypex"></a>CursorType Property Example</h1>
<pre><code>Option Explicit
Dim er As rdoError
Dim cn As New rdoConnection
Dim qy As New rdoQuery
Dim rs As rdoResultset
Dim col As rdoColumn

Private Sub Form_Load()

cn.CursorDriver = rdUseClientBatch
cn.Connect = "uid=;pwd=;server=sequel;" _
   &amp; "driver={SQL Server};database=pubs;dsn='';"
cn.EstablishConnection

'
'   Setup the query
'
With qy
 &nbsp;&nbsp; .Name = "ShowAuthor"
 &nbsp;&nbsp; .SQL = "Select * from Authors " _
      &amp; "where Au_LName = ? "
 &nbsp;&nbsp; .LockType = rdConcurReadOnly
 &nbsp;&nbsp; .<span class=cfe><b>CursorType</b></span> = rdOpenForwardOnly
 &nbsp;&nbsp; .RowsetSize = 1
 &nbsp;&nbsp; Set .ActiveConnection = cn
End With

'
'   Execute the Query by Name
'   Pass in a parameter to the query
'
cn.ShowAuthor "White"
'
'   Process the resulting rows
'

If cn.LastQueryResults is Nothing then 
Else 
   Set rs = cn.LastQueryResult
   For Each col In rs.rdoColumns
 &nbsp;&nbsp;    Print col.Name,
   Next
   Print String(80, "-")

   Do Until rs.EOF
 &nbsp;&nbsp;    For Each col In rs.rdoColumns
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    Print col,
 &nbsp;&nbsp;    Next
 &nbsp;&nbsp;    Print
 &nbsp;&nbsp;    rs.MoveNext
   Loop
End if

End Sub
</code></pre>
</BODY>
</HTML>
