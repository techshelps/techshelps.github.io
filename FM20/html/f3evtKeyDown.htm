<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META Version='1' >
<META App='Office'
Project='fm20.chm'
FileName='f3evtKeyDown'
Feature='f3evt'
Handoff='1'
SourceFile='fm20_evt.doc'
Tnum='224944'
Piece='963'
Recycle='N'
>

<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>KeyDown, KeyUp Events</TITLE>
<style>@import url(/Office.css);</style>
<link disabled rel="stylesheet" type="text/css" href="/MSOffice.css"></HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="CancelProperty">
	<PARAM NAME="Item3" VALUE="DefaultProperty">
	<PARAM NAME="Item4" VALUE="KeyPressEvent">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="vastmSendKeys">
</OBJECT>
</TD></TR></TABLE>



<H1 class=RH1><A NAME="f3evtkeydown"></A>KeyDown, KeyUp Events</H1>

<P class=ALNSR>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Font" VALUE="Verdana,8,1">
	<PARAM NAME="Text" VALUE="Text:See Also">
	<PARAM NAME="Flags" VALUE="1,,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="CancelProperty">
	<PARAM NAME="Item2" VALUE="DefaultProperty">
	<PARAM NAME="Item2" VALUE="KeyPressEvent">
</OBJECT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Font" VALUE="Verdana,8,1">
	<PARAM NAME="Text" VALUE="Text:Example">
	<PARAM NAME="Flags" VALUE=",,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="f3smpCurLineCurTargetXCurX">
</OBJECT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Font" VALUE="Verdana,8,1">
	<PARAM NAME="Text" VALUE="Text:Applies To">
	<PARAM NAME="Flags" VALUE="1,,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="CheckBoxControl">
	<PARAM NAME="Item3" VALUE="ComboBoxControl">
	<PARAM NAME="Item4" VALUE="CommandButtonControl">
	<PARAM NAME="Item5" VALUE="FrameControl">
	<PARAM NAME="Item6" VALUE="ListBoxControl">
	<PARAM NAME="Item7" VALUE="MultiPageControl">
	<PARAM NAME="Item8" VALUE="OptionButtonControl">
	<PARAM NAME="Item9" VALUE="ScrollBarControl">
	<PARAM NAME="Item10" VALUE="SpinButtonControl">
	<PARAM NAME="Item11" VALUE="TabStripControl">
	<PARAM NAME="Item12" VALUE="TextBoxControl">
	<PARAM NAME="Item13" VALUE="ToggleButtonControl">

</OBJECT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Font" VALUE="Verdana,8,1">
	<PARAM NAME="Text" VALUE="Text:Specifics">
	<PARAM NAME="Flags" VALUE="1,,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="f3evtKeyDownS">
</OBJECT> </P>



<P class=T>Occur in sequence when a user presses and releases a key. KeyDown occurs when the user presses a key. KeyUp occurs when the user releases a key.</P>

<P class=RL><B>Syntax</B></P>

<P class=SYN><B>Private Sub</B> <I>object</I>_<B>KeyDown( ByVal</B> <I>KeyCode</I> <B>As MSForms.ReturnInteger</B>, <B>ByVal</B> <I>Shift</I> <B>As fmShiftState)</B></P>

<P class=SYN><B>Private Sub</B> <I>object</I>_<B>KeyUp( ByVal</B> <I>KeyCode</I> <B>As MSForms.ReturnInteger</B>, <B>ByVal</B> <I>Shift</I> <B>As fmShiftState)</B></P>



<P class=T>The <B>KeyDown</B> and <B>KeyUp</B> event syntaxes have these parts:</P>

<TABLE cellpadding=4 cellspacing=4 cols=3>

<TR VALIGN="top">
<TH width=17%>Part</TH>
<TH width=79%>Description</TH>
</TR>

<TR VALIGN="top">
<TD class=TT width=17%><I>object</I></TD>
<TD class=TT width=79%>Required. A valid object name.</TD>
</TR>

<TR VALIGN="top">
<TD class=TT width=17%><I>KeyCode</I></TD>
<TD class=TT width=79%>Required. An integer that represents the key code of the key that was pressed or released.</TD>
</TR>

<TR VALIGN="top">
<TD class=TT width=17%><I>Shift</I></TD>
<TD class=TT width=79%>Required. The state of SHIFT, CTRL, and ALT<SMALL>.</SMALL></TD>
</TR>
</TABLE><BR>



<P class=RL><B>Settings</B></P>

<P class=T>The settings for <I>Shift</I> are:</P>

<TABLE cellpadding=4 cellspacing=4 cols=3>

<TR VALIGN="top">
<TH width=22%>Constant</TH>
<TH width=16%>Value</TH>
<TH width=62%>Description</TH>
</TR>

<TR VALIGN="top">
<TD class=TT width=22%><I>fmShiftMask</I></TD>
<TD class=TT width=16%>1</TD>
<TD class=TT width=62%>SHIFT was pressed.</TD>
</TR>

<TR VALIGN="top">
<TD class=TT width=22%><I>fmCtrlMask</I></TD>
<TD class=TT width=16%>2</TD>
<TD class=TT width=62%>CTRL was pressed.</TD>
</TR>

<TR VALIGN="top">
<TD class=TT width=22%>  <I>fmAltMask</I></TD>
<TD class=TT width=16%>4</TD>
<TD class=TT width=62%>ALT was pressed.</TD>
</TR>
</TABLE><BR>



<P class=RL><B>Remarks</B></P>

<P class=T>The KeyDown event occurs when the user presses a key on a running form while that form or a control on it has the <A HREF="JavaScript:hhobj_5.Click()">focus</A>. The KeyDown and KeyPress events alternate repeatedly until the user releases the key, at which time the KeyUp event occurs. The form or control with the focus receives all keystrokes. A form can have the focus only if it has no controls or all its visible controls are disabled.</P>

<P class=T>These events also occur if you send a keystroke to a form or control using either the SendKeys action in a macro or the <A HREF="JavaScript:hhobj_6.Click()">SendKeys Statement</A> in Visual Basic.</P>

<P class=T>The KeyDown and KeyUp events are typically used to recognize or distinguish between:

<UL>
	<LI class=LB1>Extended character keys, such as function keys.<BR><BR></LI>

	<LI class=LB1>Navigation keys, such as HOME, END, PAGEUP, PAGEDOWN, UP ARROW, DOWN ARROW, RIGHT ARROW, LEFT ARROW, and TAB.<BR><BR></LI>

	<LI class=LB1>Combinations of keys and standard keyboard modifiers (SHIFT, CTRL, or ALT).<BR><BR></LI>

	<LI class=LB1>The numeric keypad and keyboard number keys.</LI>
</UL>

<P class=T>The KeyDown and KeyUp events do not occur under the following circumstances: 

<UL>
	<LI class=LB1>The user presses enter on a form with a command button whose <B>Default</B> property is set to <B>True</B>.<BR><BR></LI>

	<LI class=LB1>The user presses esc on a form with a command button whose <B>Cancel</B> property is set to <B>True</B>.</LI>
</UL>

<P class=T>The KeyDown and KeyPress events occur when you press or send an ANSI key. The KeyUp event occurs after any event for a control caused by pressing or sending the key. If a keystroke causes the focus to move from one control to another control, the KeyDown event occurs for the first control, while the KeyPress and KeyUp events occur for the second control.</P>

<P class=T>The sequence of keyboard-related events is:

<OL>
	<LI class=LS>KeyDown<BR><BR></LI>

	<LI class=LS>KeyPress<BR><BR></LI>

	<LI class=LS>KeyUp</LI>
</OL>

<P class=NT><B>Note</B>  The KeyDown and KeyUp events apply only to forms and controls on a form. To interpret ANSI characters or to find out the ANSI character corresponding to the key pressed, use the KeyPress event.</P>


<SCRIPT language="VBScript" src="ShowMe_Code.vbs"></SCRIPT>
<SCRIPT language="VBSCRIPT">
Sub HelpPopup (sFile, sID)
Call InitConstants() 
On Error Resume Next
r=oua.HelpPopup(sFile,sID)
If Err<>0 Then Msgbox L_SECURITY_MSG,48,L_TITLE
End Sub
</SCRIPT>

</BODY>
</HTML>
