<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>LastDLLError Property Example</TITLE>
<style>@import url(office.css);</style>
	<link disabled rel="stylesheet" href="msoffice.css"></HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H2><A NAME="vaprolastdllerrorx"></A>LastDLLError Property Example</H2>

<P class=T>When pasted into a <B>UserForm</B> module, the following code causes an attempt to call a DLL function. The call fails because the argument that is passed in (a null pointer) generates an error, and in any event, SQL can’t be cancelled if it isn’t running. The code following the call checks the return of the call, and then prints at the <B>LastDLLError</B> property of the <B>Err</B> object to reveal the error code. On systems without DLLs, <B>LastDLLError</B> always returns zero.</P>

<PRE class=CT><CODE> Private Declare Function SQLCancel Lib "ODBC32.dll" _
 (ByVal hstmt As Long) As Integer

Private Sub UserForm_Click()
    Dim RetVal
    ' Call with invalid argument.
    RetVal = SQLCancel(myhandle&amp;)
    ' Check for SQL error code.    
    If RetVal = -2 Then
        'Display the information code.
        MsgBox "Error code is :" &amp; Err.<B>LastDllError</B> 
    End If
End Sub
</CODE></PRE>

</BODY>
</HTML>
