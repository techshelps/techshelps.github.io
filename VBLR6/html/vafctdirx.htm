<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Dir Function Example</TITLE>
<style>@import url(office.css);</style>
	<link disabled rel="stylesheet" href="msoffice.css"></HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H2><A NAME="vafctdirx"></A>Dir Function Example</H2>

<P class=T>This example uses the <B>Dir</B> function to check if certain files and directories exist. On the Macintosh, “HD:” is the default drive name and portions of the pathname are separated by colons instead of backslashes. Also, the Microsoft Windows wildcard characters are treated as valid file-name characters on the Mac. However, you can use the <B>MacID</B> function to specify file groups.</P>

<PRE class=CT><CODE>Dim MyFile, MyPath, MyName
' Returns "WIN.INI" (on Microsoft Windows) if it exists.
MyFile = <B>Dir(</B>"C:\WINDOWS\WIN.INI"<B>)</B>    

' Returns filename with specified extension. If more than one *.ini
' file exists, the first file found is returned.
MyFile = <B>Dir(</B>"C:\WINDOWS\*.INI"<B>)</B>

' Call Dir again without arguments to return the next *.INI file in the 
' same directory.
MyFile = Dir

' Return first *.TXT file with a set hidden attribute.
MyFile = <B>Dir(</B>"*.TXT"<B>,</B> vbHidden<B>)</B>

' Display the names in C:\ that represent directories.
MyPath = "c:\"    ' Set the path.
MyName = <B>Dir(</B>MyPath<B>,</B> vbDirectory<B>)</B>    ' Retrieve the first entry.
Do While MyName &lt;&gt; ""    ' Start the loop.
    ' Ignore the current directory and the encompassing directory.
    If MyName &lt;&gt; "." And MyName &lt;&gt; ".." Then
        ' Use bitwise comparison to make sure MyName is a directory.
        If (GetAttr(MyPath &amp; MyName) And vbDirectory) = vbDirectory Then
            Debug.Print MyName    ' Display entry only if it
        End If    ' it represents a directory.
    End If
    MyName = <B>Dir</B>    ' Get next entry.
Loop
</CODE></PRE>

</BODY>
</HTML>
