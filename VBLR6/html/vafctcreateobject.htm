<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CreateObject Function</TITLE>
<style>@import url(office.css);</style>
	<link disabled rel="stylesheet" href="msoffice.css"></HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defactivexobject">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defarg">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defclass">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defobjectvariable">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defproperty">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defmethod">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defclass">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defdeclaration">
</OBJECT>
</TD></TR></TABLE>



<H1><A NAME="vafctcreateobject"></A>CreateObject Function</H1>

<P class=ALNSR>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Text" VALUE="Text:See Also">
	<PARAM NAME="Flags" VALUE=",,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="FileSystemObjectObject;GetObjectFunction;SetStatement">
</OBJECT>&nbsp;&nbsp;&nbsp;
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Text" VALUE="Text:Example">
	<PARAM NAME="Flags" VALUE=",,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="vafctcreateobjectx">
</OBJECT>&nbsp;&nbsp;&nbsp;
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Text" VALUE="Text:Specifics">
	<PARAM NAME="Flags" VALUE=",,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="vafctCreateObjectS">
</OBJECT></P>

<P class=T>Creates and returns a reference to an <A HREF="JavaScript:hhobj_4.Click()">ActiveX object</A>.</P>

<P><B>Syntax</B></P>

<P class=SYN><B>CreateObject(</B><I>class,[servername]</I><B>)</B></P>

<P class=T>The <B>CreateObject</B> function syntax has these parts:</P>

<TABLE cellpadding=4 cellspacing=4 cols=2>

<TR VALIGN="top">
<TH width=16%>Part</TH>
<TH width=84%>Description</TH>
</TR>

<TR VALIGN="top">
<TD class=T width=16%><I>class</I></TD>
<TD class=T width=84%>Required;<B> Variant</B> (<B>String</B>). The application name and class of the object to create.</TD>
</TR>

<TR VALIGN="top">
<TD class=T width=16%><I>servername</I></TD>
<TD class=T width=84%>Optional;<B> Variant</B> (<B>String</B>). The name of the network server where the object will be created. If <I>servername</I> is an empty string (""), the local machine is used.</TD>
</TR>
</TABLE><BR>

<P class=FIXP></P>

<P class=T>The <I>class</I> <A HREF="JavaScript:hhobj_5.Click()">argument</A> uses the syntax <I>appname</I><B>.</B><I>objecttype</I> and has these parts:</P>

<TABLE cellpadding=4 cellspacing=4 cols=2>

<TR VALIGN="top">
<TH width=16%>Part</TH>
<TH width=84%>Description</TH>
</TR>

<TR VALIGN="top">
<TD class=T width=16%><I>appname</I></TD>
<TD class=T width=84%>Required;<B> Variant</B> (<B>String</B>). The name of the application providing the object.</TD>
</TR>

<TR VALIGN="top">
<TD class=T width=16%><I>objecttype</I></TD>
<TD class=T width=84%>Required;<B> Variant</B> (<B>String</B>). The type or <A HREF="JavaScript:hhobj_6.Click()">class</A> of object to create.</TD>
</TR>
</TABLE><BR>

<P class=FIXP></P>

<P><B>Remarks</B></P>

<P class=T>Every application that supports Automation provides at least one type of object. For example, a word processing application may provide an <B>Application</B> object, a <B>Document</B> object, and a <B>Toolbar</B> object.</P>

<P class=T>To create an ActiveX object, assign the object returned by <B>CreateObject</B> to an <A HREF="JavaScript:hhobj_7.Click()">object variable</A>:</P>

<PRE class=CT><CODE>' Declare an object variable to hold the object 
' reference. Dim as Object causes late binding. 
Dim ExcelSheet As Object
Set ExcelSheet = CreateObject("Excel.Sheet")
</CODE></PRE>

<P class=T>This code starts the application creating the object, in this case, a Microsoft Excel spreadsheet. Once an object is created, you reference it in code using the object variable you defined. In the following example, you access <A HREF="JavaScript:hhobj_8.Click()">properties</A> and <A HREF="JavaScript:hhobj_9.Click()">methods</A> of the new object using the object variable, <CODE>ExcelSheet</CODE>, and other Microsoft Excel objects, including the <CODE>Application</CODE> object and the <CODE>Cells</CODE> collection.</P>

<PRE class=CT><CODE>' Make Excel visible through the Application object.
ExcelSheet.Application.Visible = True
' Place some text in the first cell of the sheet.
ExcelSheet.Application.Cells(1, 1).Value = "This is column A, row 1"
' Save the sheet to C:\test.xls directory.
ExcelSheet.SaveAs "C:\TEST.XLS"
' Close Excel with the Quit method on the Application object.
ExcelSheet.Application.Quit
' Release the object variable.
Set ExcelSheet = Nothing
</CODE></PRE>

<P class=T>Declaring an object variable with the <CODE>As Object</CODE> clause creates a variable that can contain a reference to any type of object. However, access to the object through that variable is late bound; that is, the binding occurs when your program is run. To create an object variable that results in early binding, that is, binding when the program is compiled, declare the object variable with a specific class ID. For example, you can declare and create the following Microsoft Excel references:</P>

<PRE class=CT><CODE>Dim xlApp As Excel.Application 
Dim xlBook As Excel.Workbook
Dim xlSheet As Excel.WorkSheet
Set xlApp = CreateObject("Excel.Application")
Set xlBook = xlApp.Workbooks.Add
Set xlSheet = xlBook.Worksheets(1)
</CODE></PRE>

<P class=T>The reference through an early-bound variable can give better performance, but can only contain a reference to the <A HREF="JavaScript:hhobj_10.Click()">class</A> specified in the <A HREF="JavaScript:hhobj_11.Click()">declaration</A>.</P>

<P class=T>You can pass an object returned by the <B>CreateObject</B> function to a function expecting an object as an argument. For example, the following code creates and passes a reference to a Excel.Application object:</P>

<PRE class=CT><CODE>Call MySub (CreateObject("Excel.Application"))
</CODE></PRE>

<P class=T>You can create an object on a remote networked computer by passing the name of the computer to the <I>servername</I> argument of <B>CreateObject</B>. That name is the same as the Machine Name portion of a share name: for a share named "\\MyServer\Public," <I>servername</I> is "MyServer."</P>

<P class=NT><B>Note</B>&nbsp;&nbsp;&nbsp;Refer to COM documentation (see <I>Microsoft Developer Network</I>) for additional information on making an application visible on a remote networked computer. You may have to add a registry key for your application.</P>

<P class=T>The following code returns the version number of an instance of Excel running on a remote computer named <CODE>MyServer</CODE>:</P>

<PRE class=CT><CODE>Dim xlApp As Object
Set xlApp = CreateObject("Excel.Application", "MyServer")
Debug.Print xlApp.Version
</CODE></PRE>

<P class=T>If the remote server doesn’t exist or is unavailable, a run-time error occurs.</P>

<P class=NT><B>Note</B>&nbsp;&nbsp;&nbsp;Use <B>CreateObject</B> when there is no current instance of the object. If an instance of the object is already running, a new instance is started, and an object of the specified type is created. To use the current instance, or to start the application and have it load a file, use the <B>GetObject</B> function.</P>

<P class=NT>If an object has registered itself as a single-instance object, only one instance of the object is created, no matter how many times <B>CreateObject</B> is executed.</P>

</BODY>
</HTML>
