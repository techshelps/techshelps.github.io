<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Seek Function Example</TITLE>
<style>@import url(office.css);</style>
	<link disabled rel="stylesheet" href="msoffice.css"></HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H2><A NAME="vafctseekx"></A>Seek Function Example</H2>

<P class=T>This example uses the <B>Seek</B> function to return the current file position. The example assumes <CODE>TESTFILE</CODE> is a file containing records of the user-defined type <CODE>Record</CODE>.</P>

<PRE class=CT><CODE>Type Record    ' Define user-defined type.
    ID As Integer
    Name As String * 20
End Type
</CODE></PRE>

<P class=T>For files opened in Random mode, <B>Seek</B> returns number of next record.</P>

<PRE class=CT><CODE>Dim MyRecord As Record    ' Declare variable.
Open "TESTFILE" For Random As #1 Len = Len(MyRecord)
Do While Not EOF(1)    ' Loop until end of file.
    Get #1, , MyRecord    ' Read next record.
    Debug.Print <B>Seek(</B>1<B>)</B>    ' Print record number to the 
            ' Immediate window.
Loop
Close #1    ' Close file.
</CODE></PRE>

<P class=T>For files opened in modes other than Random mode, <B>Seek</B> returns the byte position at which the next operation takes place. Assume <CODE>TESTFILE</CODE> is a file containing a few lines of text.</P>

<PRE class=CT><CODE>Dim MyChar
Open "TESTFILE" For Input As #1    ' Open file for reading.
Do While Not EOF(1)    ' Loop until end of file.
    MyChar = Input(1, #1)    ' Read next character of data.
    Debug.Print <B>Seek(</B>1<B>)</B>    ' Print byte position to the
            ' Immediate window.
Loop
Close #1    ' Close file.
</CODE></PRE>

</BODY>
</HTML>
