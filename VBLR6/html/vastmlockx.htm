<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Lock, Unlock Statements Example</TITLE>
<style>@import url(office.css);</style>
	<link disabled rel="stylesheet" href="msoffice.css"></HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H2><A NAME="vastmlockx"></A>Lock, Unlock Statements Example</H2>

<P class=T>This example illustrates the use of the <B>Lock</B> and <B>Unlock</B> statements. While a record is being modified, access by other processes to the record is denied. This example assumes that <CODE>TESTFILE</CODE> is a file containing five records of the user-defined type <CODE>Record</CODE>.</P>

<PRE class=CT><CODE>Type Record    ' Define user-defined type.
    ID As Integer
    Name As String * 20
End Type

Dim MyRecord As Record, RecordNumber    ' Declare variables.
' Open sample file for random access.
Open "TESTFILE" For Random Shared As #1 Len = Len(MyRecord)
RecordNumber = 4    ' Define record number.
<B>Lock #</B>1<B>,</B> RecordNumber    ' Lock record.
Get #1, RecordNumber, MyRecord    ' Read record.
MyRecord.ID = 234    ' Modify record.
MyRecord.Name = "John Smith"
Put #1, RecordNumber, MyRecord    ' Write modified record.
<B>Unlock #</B>1<B>,</B> RecordNumber    ' Unlock current record.
Close #1    ' Close file.
</CODE></PRE>

</BODY>
</HTML>
