<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>AddressOf Operator</TITLE>
<style>@import url(office.css);</style>
	<link disabled rel="stylesheet" href="msoffice.css"></HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defprocedure">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defarg">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defstandardmodule">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defproject">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defdll">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defclass">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defparameter">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defdevelopmentenvironment">
</OBJECT>
</TD></TR></TABLE>



<H1><A NAME="vaopraddressof"></A>AddressOf Operator</H1>

<P class=ALNSR>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Text" VALUE="Text:See Also">
	<PARAM NAME="Flags" VALUE=",,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="DeclareStatement;FunctionStatement;PropertyGetStatement;PropertyLetStatement;PropertySetStatement;SubStatement">
</OBJECT>&nbsp;&nbsp;&nbsp;
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Text" VALUE="Text:Example">
	<PARAM NAME="Flags" VALUE=",,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="vaoprAddressOfX">
</OBJECT>&nbsp;&nbsp;&nbsp;
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Text" VALUE="Text:Specifics">
	<PARAM NAME="Flags" VALUE=",,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="vaoprAddressOfS">
</OBJECT></P>

<P class=T>A unary operator that causes the address of the <A HREF="JavaScript:hhobj_4.Click()">procedure</A> it precedes to be passed to an API procedure that expects a function pointer at that position in the <A HREF="JavaScript:hhobj_5.Click()">argument</A> list.</P>

<P><B>Syntax</B></P>

<P class=SYN><B>AddressOf </B><I>procedurename</I></P>

<P class=T>The required <I>procedurename</I> specifies the procedure whose address is to be passed. It must represent a procedure in a <A HREF="JavaScript:hhobj_6.Click()">standard module</A> module in the <A HREF="JavaScript:hhobj_7.Click()">project</A> in which the call is made.</P>

<P><B>Remarks</B></P>

<P class=T>When a procedure name appears in an argument list, usually the procedure is evaluated, and the address of the procedure’s return value is passed. <B>AddressOf</B> permits the address of the procedure to be passed to a Windows API function in a <A HREF="JavaScript:hhobj_8.Click()">dynamic-link library (DLL)</A>, rather passing the procedure's return value. The API function can then use the address to call the Basic procedure, a process known as a callback. The <B>AddressOf</B> operator appears only in the call to the API procedure.</P>

<P class=T>Although you can use <B>AddressOf</B> to pass procedure pointers among Basic procedures, you can't call a function through such a pointer from within Basic. This means, for example, that a <A HREF="JavaScript:hhobj_9.Click()">class</A> written in Basic can't make a callback to its controller using such a pointer. When using <B>AddressOf</B> to pass a procedure pointer among procedures within Basic, the <A HREF="JavaScript:hhobj_10.Click()">parameter</A> of the called procedure must be typed <B>As Long</B>.</P>

<P class=NT><B>Warning</B>&nbsp;&nbsp;&nbsp;Using <B>AddressOf</B> may cause unpredictable results if you don't completely understand the concept of function callbacks. You must understand how the Basic portion of the callback works, and also the code of the DLL into which you are passing your function address. Debugging such interactions is difficult since the program runs in the same process as the <A HREF="JavaScript:hhobj_11.Click()">development environment</A>. In some cases, systematic debugging may not be possible.</P>

<P class=NT><B>Note</B>&nbsp;&nbsp;&nbsp;You can create your own call-back function prototypes in DLLs compiled with Microsoft Visual C++ (or similar tools). To work with <B>AddressOf</B>, your prototype must use the __stdcall calling convention. The default calling convention (__cdecl) will not work with <B>AddressOf</B>.</P>

<P class=T>Since the caller of a callback is not within your program, it is important that an error in the callback procedure not be propagated back to the caller. You can accomplish this by placing the <B>On Error Resume Next</B> statement at the beginning of the callback procedure.</P>

</BODY>
</HTML>
