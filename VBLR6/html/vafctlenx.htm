<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Len Function Example</TITLE>
<style>@import url(office.css);</style>
	<link disabled rel="stylesheet" href="msoffice.css"></HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H2><A NAME="vafctlenx"></A>Len Function Example</H2>

<P class=T>The first example uses <B>Len</B> to return the number of characters in a string or the number of bytes required to store a variable. The <B>Type...End Type</B> block defining <CODE>CustomerRecord</CODE> must be preceded by the keyword <B>Private</B> if it appears in a class module. In a standard module, a <B>Type</B> statement can be <B>Public</B>.</P>

<PRE class=CT><CODE>Type CustomerRecord    ' Define user-defined type.
    ID As Integer    ' Place this definition in a 
    Name As String * 10    ' standard module.
    Address As String * 30
End Type

Dim Customer As CustomerRecord    ' Declare variables.
Dim MyInt As Integer, MyCur As Currency
Dim MyString, MyLen
MyString = "Hello World"    ' Initialize variable.
MyLen = <B>Len(</B>MyInt<B>)</B>    ' Returns 2.
MyLen = <B>Len(</B>Customer<B>)</B>    ' Returns 42.
MyLen = <B>Len(</B>MyString<B>)</B>    ' Returns 11.
MyLen = <B>Len(</B>MyCur<B>)</B>    ' Returns 8.
</CODE></PRE>

<P class=T>The second example uses <B>LenB</B> and a user-defined function (<B>LenMbcs</B>) to return the number of byte characters in a string if ANSI is used to represent the string. </P>

<PRE class=CT><CODE>Function LenMbcs (ByVal str as String)
    LenMbcs = <B>LenB(</B>StrConv(str, vbFromUnicode)<B>)</B>
End Function

Dim MyString, MyLen
MyString = "ABc"
' Where "A" and "B" are DBCS and "c" is SBCS.
MyLen = Len(MyString)
' Returns 3 - 3 characters in the string.
MyLen = <B>LenB(</B>MyString<B>)</B>
' Returns 6 - 6 bytes used for Unicode.
MyLen = LenMbcs(MyString)
' Returns 5 - 5 bytes used for ANSI.
</CODE></PRE>

</BODY>
</HTML>
