<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CVErr Function Example</TITLE>
<style>@import url(office.css);</style>
	<link disabled rel="stylesheet" href="msoffice.css"></HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H2><A NAME="vafctcverrx"></A>CVErr Function Example</H2>

<P class=T>This example uses the <B>CVErr</B> function to return a <B>Variant </B>whose <B>VarType </B>is <B>vbError</B> (10). The user-defined function <CODE>CalculateDouble</CODE> returns an error if the argument passed to it isn't a number. You can use <B>CVErr</B> to return user-defined errors from user-defined procedures or to defer handling of a run-time error. Use the <B>IsError</B> function to test if the value represents an error.</P>

<PRE class=CT><CODE>' Call CalculateDouble with an error-producing argument.
Sub Test()
    Debug.Print CalculateDouble("345.45robert")
End Sub
' Define CalculateDouble Function procedure.
Function CalculateDouble(Number)
    If IsNumeric(Number) Then
        CalculateDouble = Number * 2    ' Return result.
    Else
        CalculateDouble = <B>CVErr(</B>2001<B>)</B>    ' Return a user-defined error 
    End If    ' number.
End Function
</CODE></PRE>

</BODY>
</HTML>
