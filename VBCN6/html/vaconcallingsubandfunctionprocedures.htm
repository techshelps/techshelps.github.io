<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Calling Sub and Function Procedures</TITLE>
<style>@import url(office.css);</style>
	<link disabled rel="stylesheet" href="msoffice.css"></HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defprocedure">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defarg">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defvariable">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defnamedarguments">
</OBJECT>
</TD></TR></TABLE>



<H1><A NAME="vaconcallingsubandfunctionprocedures"></A>Calling Sub and Function Procedures</H1>

<P class=ALNSR>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Text" VALUE="Text:See Also">
	<PARAM NAME="Flags" VALUE=",,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="3;4;14">
</OBJECT>&nbsp;&nbsp;&nbsp;
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Text" VALUE="Text:Specifics">
	<PARAM NAME="Flags" VALUE=",,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="vaconCallingSubandFunctionproceduresS">
</OBJECT></P>

<P class=T>To call a <B>Sub</B> procedure from another <A HREF="JavaScript:hhobj_3.Click()">procedure</A>, type the name of the procedure and include values for any required <A HREF="JavaScript:hhobj_4.Click()">arguments</A>. The <B>Call</B> statement is not required, but if you use it, you must enclose any arguments in parentheses.</P>

<P class=T>You can use a <B>Sub</B> procedure to organize other procedures so they are easier to understand and debug. In the following example, the <B>Sub</B> procedure <CODE>Main</CODE> calls the <B>Sub</B> procedure <CODE>MultiBeep</CODE>, passing the value 56 for its argument. After <CODE>MultiBeep</CODE> runs, control returns to <CODE>Main</CODE>, and <CODE>Main</CODE> calls the <B>Sub</B> procedure <CODE>Message</CODE>. <CODE>Message</CODE> displays a message box; when the user clicks <B>OK</B>, control returns to <CODE>Main</CODE>, and <CODE>Main</CODE> finishes.</P>

<PRE class=CT><CODE>Sub Main()
    MultiBeep 56
    Message
End Sub

Sub MultiBeep(numbeeps)
    For counter = 1 To numbeeps
        Beep
    Next counter
End Sub

Sub Message()
    MsgBox "Time to take a break!"
End Sub
</CODE></PRE>

<H4>Calling Sub Procedures with More than One Argument</H4>

<P class=T>The following example shows two ways to call a <B>Sub</B> procedure with more than one argument. The second time <CODE>HouseCalc</CODE> is called, parentheses are required around the arguments because the <B>Call</B> statement is used.</P>

<PRE class=CT><CODE>Sub Main()
    HouseCalc 99800, 43100
    Call HouseCalc(380950, 49500)
End Sub

Sub HouseCalc(price As Single, wage As Single)
    If 2.5 * wage &lt;= 0.8 * price Then
        MsgBox "You cannot afford this house."
    Else
        MsgBox "This house is affordable."
    End If
End Sub
</CODE></PRE>

<H4>Using Parentheses when Calling Function Procedures</H4>

<P class=T>To use the return value of a function, assign the function to a <A HREF="JavaScript:hhobj_5.Click()">variable</A> and enclose the arguments in parentheses, as shown in the following example.</P>

<PRE class=CT><CODE>Answer3 = MsgBox("Are you happy with your salary?", 4, "Question 3")
</CODE></PRE>

<P class=T>If you're not interested in the return value of a function, you can call a function the same way you call a <B>Sub</B> procedure. Omit the parentheses, list the arguments, and do not assign the function to a variable, as shown in the following example.</P>

<PRE class=CT><CODE>MsgBox "Task Completed!", 0, "Task Box"
</CODE></PRE>

<P class=NT><B>Caution</B>&nbsp;&nbsp;&nbsp;If you include parentheses in the preceding example, the statement causes a syntax error.</P>

<H4>Passing Named Arguments</H4>

<P class=T>A statement in a <B>Sub</B> or <B>Function</B> procedure can pass values to called procedures using <A HREF="JavaScript:hhobj_6.Click()">named arguments</A>. You can list named arguments in any order. A named argument consists of the name of the argument followed by a colon and an equal sign (<B>:=</B>), and the value assigned to the argument.</P>

<P class=T>The following example calls the <B>MsgBox</B> function using named arguments with no return value.</P>

<PRE class=CT><CODE>MsgBox Title:="Task Box", Prompt:="Task Completed!"
</CODE></PRE>

<P class=T>The following example calls the <B>MsgBox</B> function using named arguments. The return value is assigned to the variable <CODE>answer3</CODE>.</P>

<PRE class=CT><CODE>answer3 = MsgBox(Title:="Question 3", _
Prompt:="Are you happy with your salary?", Buttons:=4)
</CODE></PRE>

</BODY>
</HTML>
