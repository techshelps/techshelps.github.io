<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Creating Recursive Procedures</TITLE>
<style>@import url(office.css);</style>
	<link disabled rel="stylesheet" href="msoffice.css"></HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defprocedure">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defvariable">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defdatatype">
</OBJECT>
</TD></TR></TABLE>



<H1><A NAME="vaconcreatingrecursiveprocedures"></A>Creating Recursive Procedures</H1>

<P class=ALNSR>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Text" VALUE="Text:See Also">
	<PARAM NAME="Flags" VALUE=",,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="28;38">
</OBJECT>&nbsp;&nbsp;&nbsp;
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Text" VALUE="Text:Specifics">
	<PARAM NAME="Flags" VALUE=",,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="vaconCreatingRecursiveProceduresS">
</OBJECT></P>

<P class=T><A HREF="JavaScript:hhobj_3.Click()">Procedures</A> have a limited amount of space for <A HREF="JavaScript:hhobj_4.Click()">variables</A>. Each time a procedure calls itself, more of that space is used. A procedure that calls itself is a recursive procedure. A recursive procedure that continuously calls itself eventually causes an error. For example:</P>

<PRE class=CT><CODE>Function RunOut(Maximum)
    RunOut = RunOut(Maximum)
End Function
</CODE></PRE>

<P class=T>This error may be less obvious when two procedures call each other indefinitely, or when some condition that limits the recursion is never met. Recursion does have its uses. For example, the following procedure uses a recursive function to calculate factorials:</P>

<PRE class=CT><CODE>Function Factorial (N)
    If N &lt;= 1 Then    ' Reached end of recursive calls.
        Factorial = 1    ' (N = 0) so climb back out of calls.
    Else    ' Call Factorial again if N &gt; 0.
        Factorial = Factorial(N - 1) * N
    End If
End Function
</CODE></PRE>

<P class=T>You should test your recursive procedure to make sure it does not call itself so many times that you run out of memory. If you get an error, make sure your procedure is not calling itself indefinitely. After that, try to conserve memory by:

<UL>
	<LI class=LB1>Eliminating unnecessary variables.<BR><BR></LI>

	<LI class=LB1>Using <A HREF="JavaScript:hhobj_5.Click()">data types</A> other than <B>Variant</B>.<BR><BR></LI>

	<LI class=LB1>Re-evaluating the logic of the procedure. You can often substitute nested loops for recursion.</LI>
</UL>

</BODY>
</HTML>
