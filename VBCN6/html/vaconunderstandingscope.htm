<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Understanding Scope and Visibility</TITLE>
<style>@import url(office.css);</style>
	<link disabled rel="stylesheet" href="msoffice.css"></HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defvariable">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defconstant">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defprocedure">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defproclevel">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defmodulelevel">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defproject">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defstandardmodule">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defclassmodule">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defreferencingproject">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defkeyword">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="defformmodule">
</OBJECT>
</TD></TR></TABLE>



<H1><A NAME="vaconunderstandingscope"></A>Understanding Scope and Visibility</H1>

<P class=ALNSR>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Text" VALUE="Text:See Also">
	<PARAM NAME="Flags" VALUE=",,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="2;6;8;9;10;23">
</OBJECT>&nbsp;&nbsp;&nbsp;
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Text" VALUE="Text:Specifics">
	<PARAM NAME="Flags" VALUE=",,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="vaconUnderstandingScopeS">
</OBJECT></P>

<P class=T>Scope refers to the availability of a <A HREF="JavaScript:hhobj_3.Click()">variable</A>, <A HREF="JavaScript:hhobj_4.Click()">constant</A>, or <A HREF="JavaScript:hhobj_5.Click()">procedure</A> for use by another procedure. There are three scoping levels: <A HREF="JavaScript:hhobj_6.Click()">procedure-level</A>, private <A HREF="JavaScript:hhobj_7.Click()">module-level</A>, and public module-level.</P>

<P class=T>You determine the scope of a variable when you declare it. It's a good idea to declare all variables explicitly to avoid naming-conflict errors between variables with different scopes.</P>

<H4>Defining Procedure-Level Scope</H4>

<P class=T>A variable or constant defined within a procedure is not visible outside that procedure. Only the procedure that contains the variable declaration can use it. In the following example, the first procedure displays a message box that contains a string. The second procedure displays a blank message box because the variable <CODE>strMsg</CODE> is local to the first procedure.</P>

<PRE class=CT><CODE>Sub LocalVariable()
    Dim strMsg As String
    strMsg = "This variable can't be used outside this procedure."
    MsgBox strMsg
End Sub

Sub OutsideScope()
    MsgBox strMsg
End Sub
</CODE></PRE>

<H4>Defining Private Module-Level Scope</H4>

<P class=T>You can define module-level variables and constants in the Declarations section of a module. Module-level variables can be either public or private. Public variables are available to all procedures in all modules in a <A HREF="JavaScript:hhobj_8.Click()">project</A>; private variables are available only to procedures in that module. By default, variables declared with the <B>Dim</B> statement in the Declarations section are scoped as private. However, by preceding the variable with the <B>Private</B> keyword, the scope is obvious in your code.</P>

<P class=T>In the following example, the string variable <CODE>strMsg</CODE> is available to any procedures defined in the module. When the second procedure is called, it displays the contents of the string variable <CODE>strMsg</CODE> in a dialog box.</P>

<PRE class=CT><CODE>' Add following to Declarations section of module.
Private strMsg sAs String

Sub InitializePrivateVariable()
    strMsg = "This variable can't be used outside this module."
End Sub

Sub UsePrivateVariable()
    MsgBox strMsg
End Sub
</CODE></PRE>

<P class=NT><B>Note</B>&nbsp;&nbsp;&nbsp;Public procedures in a <A HREF="JavaScript:hhobj_9.Click()">standard module</A> or <A HREF="JavaScript:hhobj_10.Click()">class module</A> are available to any <A HREF="JavaScript:hhobj_11.Click()">referencing project</A>. To limit the scope of all procedures in a module to the current project, add an <B>Option Private Module</B> statement to the Declarations section of the module. Public variables and procedures will still be available to other procedures in the current project, but not to referencing projects.</P>

<H4>Defining Public Module-Level Scope</H4>

<P class=T>If you declare a module-level variable as public, it's available to all procedures in the project. In the following example, the string variable <CODE>strMsg</CODE> can be used by any procedure in any module in the project.</P>

<PRE class=CT><CODE>' Include in Declarations section of module.
Public strMsg As String
</CODE></PRE>

<P class=T>All procedures are public by default, except for event procedures. When Visual Basic creates an event procedure, the <B>Private</B> <A HREF="JavaScript:hhobj_12.Click()">keyword</A> is automatically inserted before the procedure declaration. For all other procedures, you must explicitly declare the procedure with the <B>Private</B> keyword if you do not want it to be public.</P>

<P class=T>You can use public procedures, variables, and constants defined in standard modules or class modules from referencing projects. However, you must first set a reference to the project in which they are defined.</P>

<P class=T>Public procedures, variables, and constants defined in other than standard or class modules, such as <A HREF="JavaScript:hhobj_13.Click()">form module</A>s or report modules, are not available to referencing projects, because these modules are private to the project in which they reside.</P>

</BODY>
</HTML>
