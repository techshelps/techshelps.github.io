<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>OemKeyScan</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1qnxax1"></A><B>OemKeyScan  <A HREF="2ro6rg.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1xtfdy5.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="fkf.jh.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>OemKeyScan</B> function maps OEM ASCII codes 0 through 0x0FF into the OEM scan codes and shift states. The function provides information that allows a program to send OEM text to another program by simulating keyboard input. </P>

<P><B>DWORD OemKeyScan(</B></P>

<TABLE cols=2 width=390>

<TR VALIGN="top">
<TD width=42%><B>WORD</B> <I>wOemChar</I> </TD>
<TD width=58%>// ASCII value of OEM character</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>   );</B></TD>
<TD width=58%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>wOemChar</I></P>

<P>Specifies the ASCII value of the OEM character. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the low-order word of the return value contains the scan code of the given OEM character, and the high-order word contains the shift state, which can be a combination of the following flag bits: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=10%><B>Bit</B></TD>
<TD width=90%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=10%>1</TD>
<TD width=90%>Either SHIFT key is pressed.</TD>
</TR>

<TR VALIGN="top">
<TD width=10%>2</TD>
<TD width=90%>Either CTRL key is pressed.</TD>
</TR>

<TR VALIGN="top">
<TD width=10%>4</TD>
<TD width=90%>Either ALT key is pressed.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>If the character cannot be produced by a single keystroke using the current keyboard layout, the return value is 0xFFFFFFFF. </P>

<P><B>Remarks</B></P>

<P>This function does not provide translations for characters that require CTRL+ALT or dead keys. Characters not translated by this function must be copied by simulating input using the ALT+ keypad mechanism. The NUMLOCK key must be off. </P>

<P>This function does not provide translations for characters that cannot be typed with one keystroke using the current keyboard layout, such as characters with diacritics requiring dead keys. Characters not translated by this function may be simulated using the ALT+ keypad mechanism. The NUMLOCK key must be on. </P>

<P>This function is implemented using the <B>VkKeyScan</B> function. </P>

<P><B>See Also</B></P>

<P><A HREF="2jmizz8.htm"><B>VkKeyScan</B></A> </P>

</BODY>
</HTML>
