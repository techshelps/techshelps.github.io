<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SetLastError</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="34n8_rg"></A><B>SetLastError  <A HREF="asz.61.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="a0ni3i.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="j_xnxj.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>SetLastError</B> function sets the last-error code for the calling thread. </P>

<P><B>VOID SetLastError(</B></P>

<TABLE cols=2 width=357>

<TR VALIGN="top">
<TD width=49%><B>DWORD</B> <I>dwErrCode</I> </TD>
<TD width=51%>// per-thread error code  </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>   );</B></TD>
<TD width=51%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>dwErrCode</I></P>

<P>Specifies the last-error code for the thread. </P>

<P></P>

<P><B>Remarks</B></P>

<P>Error codes are 32-bit values (bit 31 is the most significant bit). Bit 29 is reserved for application-defined error codes; no Win32 API error code has this bit set. If you are defining an error code for your application, set this bit to indicate that the error code has been defined by your application and to ensure that your error code does not conflict with any system-defined error codes. </P>

<P>This function is intended primarily for dynamic-link libraries (DLLs). Calling this function after an error occurs lets the DLL emulate the behavior of a Win32 function. </P>

<P>Most Win32 functions call <B>SetLastError </B>when they fail. Function failure is typically indicated by a return value error code such as FALSE, NULL, 0xFFFFFFFF, or -1. Some functions call <B>SetLastError </B>under conditions of success; those cases are noted in each function's reference page.</P>

<P>Applications can retrieve the value saved by this function by using the <A HREF="11c2vs7.htm"><B>GetLastError</B></A> function. The use of <B>GetLastError</B> is optional; an application can call it to find out the specific reason for a function failure. </P>

<P>The last-error code is kept in thread local storage so that multiple threads do not overwrite each other's values. </P>

<P><B>See Also</B></P>

<P><A HREF="11c2vs7.htm"><B>GetLastError</B></A>, <A HREF="38ar_s6.htm"><B>SetLastErrorEx</B></A>, <A HREF="t9hgy4.htm"><B>TlsGetValue</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
