<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Processing the WM_COMMAND Message in a Simple Dialog Box</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="kmtgkw"></A><B>Processing the WM_COMMAND Message in a Simple Dialog Box</B></P>

<P>When an event occurs in a dialog box control, the control sends a <A HREF="71v.3j.htm">WM_COMMAND</A> message to the dialog box procedure. The high-order word of the <I>wParam</I> parameter is a notification code, indicating the type of event that occurred. The low-order word of <I>wParam</I> is a constant identifying the control. The <I>lParam</I> parameter is the window handle for the control.</P>

<P>When processing the WM_COMMAND message, the spelling checker example examines the control identifier in the low-order word of <I>wParam</I> to determine the origin of the message. The constants IDCOMBO, IDOK, IDIGNORE, and IDCANCEL identify the combo box, the Change button, the Ignore button, and the Cancel button controls, respectively. </P>

<P>A combo box may send a WM_COMMAND message for a number of different reasons. To determine the type of event, the dialog box procedure examines the notification code in the high-order word of <I>wParam</I>. The example processes only the <A HREF="ancq4b.htm">CBN_DBLCLK</A> notification message, which is sent when the user double-clicks a list item. The dialog box procedure processes this notification message in the same way as a Change button click.</P>

<P>The buttons in this example send <A HREF="71v.3j.htm">WM_COMMAND</A> messages only when they are chosen by the user. When the user chooses the Change button, the dialog box procedure replaces the current selection in the application's edit control with the content of the selection field in the combo box. The selection field may contain either the selected list item or text the user has typed. The dialog box procedure then selects the next misspelled word in the same way it processes an Ignore button click.</P>

<P>When the user chooses the Ignore button, the dialog box procedure calls the application-defined SelectNextWord and InitSpellList functions to select the next misspelled word in the application's edit control. InitSpellList places the misspelled word in the selection field of the combo box and adds suggested spellings to the combo box list.</P>

<P>When the user chooses the Cancel button, the dialog box procedure calls the <A HREF="nyk21c.htm"><B>EndDialog</B></A> function to close the dialog box.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
