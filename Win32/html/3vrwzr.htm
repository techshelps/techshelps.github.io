<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>WinTrustSubjectCheckContentInfo [New - Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="3vrwzr"></A><B>WinTrustSubjectCheckContentInfo  <A HREF="bipiqm.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A></B></P>

<P>[New - Windows NT]</P>

<P>The <B>WinTrustSubjectCheckContentInfo</B> function verifies that a specified certificate adequately represents the contents of the specified subject. </P>

<P><B>BOOL WinTrustSubjectCheckContentInfo(</B></P>

<TABLE cols=2 width=573>

<TR VALIGN="top">
<TD width=54%><B>LPWIN_TRUST_SIP_SUBJECT</B>  <I>lpSubject</I><B>,</B></TD>
<TD width=46%>// pointer to description of the subject </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><B>    LPWIN_CERTIFICATE</B> <I>lpSignedData</I></TD>
<TD width=46%>// pointer to a certificate for the subject</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><B>   );</B></TD>
<TD width=46%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpSubject</I></P>

<P>Pointer to a <A HREF="1mtbf8..htm"><B>WIN_TRUST_SIP_SUBJECT</B></A> structure that describes the subject to compare to the certificate.</P>

<P><I>lpSignedData</I></P>

<P>Pointer to a WIN_CERT_TYPE_PKCS_SIGNED_DATA type of <A HREF="fhzn96.htm"><B>WIN_CERTIFICATE</B></A> structure. The data in the <B>bCertificate</B> member of this structure is in the format of a PKCS #7 Signed Data structure. For details on this data format, see <I>The Public-Key Cryptography Standards (PKCS)</I>, published by RSA Data Security, Inc. </P>

<P>The SIP can use information from the ContentInfo member of this PKCS #7 structure to determine what must be verified about the subject. For example, a Portable Executable (PE) image may include resource information and debug information in a digest of the image. If it does, the SIP can find that information in the ContentInfo member of the corresponding PKCS #7 Signed Data structure. The SIP should not depend on the contents of the PKCS #7 structure other than the ContentInfo member.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the information in <I>lpSignedData</I> adequately represents the subject, the return value is nonzero. Otherwise, the return value is zero.</P>

<P><B>Remarks</B></P>

<P>A trust provider calls the <B>WinTrustSubjectCheckContentInfo</B> function to verify that the signature in a certificate matches the contents of a specified subject. The trust provider calls the WinTrust implementation of this function. WinTrust then calls the <B>WinTrustSubjectCheckContentInfo</B> implementation of the appropriate Subject Interface Package (SIP). The appropriate SIP is the one registered to handle the type of subject specified by the <I>lpSubject</I> parameter.</P>

<P>To verify a signature, the trust provider first calls the <A HREF="bh8k2k.htm"><B>WinTrustSubjectEnumCertificates</B></A> function to enumerate the types of certificates contained in the subject. Next, the trust provider calls the <A HREF="2n0i3uc.htm"><B>WinTrustSubjectGetCertificate</B></A> function to get the certificate needed to authenticate the subject. Typically, this is a certificate that contains a PKCS #7 Signed Data structure from the subject. Then the trust provider calls <B>WinTrustSubjectCheckContentInfo</B> to determine whether the ContentInfo member of the PKCS #7 Signed Data structure matches the subject. If the return value indicates that the SIP has verified the ContentInfo member, the trust provider must also check the signature of the PKCS #7 Signed Data structure. To do this, the trust provider must digest the PKCS structure and compare it to the signature value in that structure.</P>

<P>Each Subject Interface Package (SIP) DLL must implement the <B>WinTrustSubjectCheckContentInfo</B> function. WinTrust gets a pointer to the SIP's <B>WinTrustSubjectCheckContentInfo</B> implementation when WinTrust calls the SIP's <A HREF="2mjrwza.htm"><B>WinTrustSipInitialize</B></A> initialization function. </P>

<P>The SIP implementation of <B>WinTrustSubjectCheckContentInfo</B> compares the information in the PKCS #7's ContentInfo member to information that it retrieves from the subject identified by the <I>lpSubject</I> parameter. To do this, the SIP generates new ContentInfo information from the subject, which it then compares to the ContentInfo member of the PKCS #7 Signed Data structure. The ContentInfo member contains a message digest of the subject that is important in verifying the validity of the subject. Note that other information in the ContentInfo member may not match the subject. For example, the name of the file is not important because the name can change without affecting the integrity of the subject.</P>

<P>The LPWINTRUST_SUBJECT_CHECK_CONTENT_INFO type is a pointer to a <B>WinTrustSubjectCheckContentInfo</B> function.</P>

<P><B>See Also</B></P>

<P><A HREF="fhzn96.htm"><B>WIN_CERTIFICATE</B></A>, <A HREF="1mtbf8..htm"><B>WIN_TRUST_SIP_SUBJECT</B></A>, <A HREF="2mjrwza.htm"><B>WinTrustSipInitialize</B></A>, <A HREF="bh8k2k.htm"><B>WinTrustSubjectEnumCertificates</B></A>, <A HREF="2n0i3uc.htm"><B>WinTrustSubjectGetCertificate</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
