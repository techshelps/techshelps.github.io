<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Simple Key Blob Format</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1jw2ygo"></A><B>Simple Key Blob Format</B></P>

<P>Simple key blobs (type SIMPLEBLOB) are used to store and transport session keys. These are always encrypted with a key exchange public key. They have the following format:</P>

<P>BLOBHEADER blobheader;</P>

<P>ALG_ID algid;</P>

<P>BYTE encryptedkey[rsapubkey.bitlen/8];</P>

<P></P>

<P>The algorithm identifier that immediately follows the <B>BLOBHEADER</B> structure specifies the encryption algorithm that was used to encrypt the session key data. This typically has a value of CALG_RSA_KEYX, indicating that the session key data was encrypted with a key exchange public key, using the RSA Public-Key algorithm.</P>

<P>The encrypted session key data is in the form of a PKCS #1, type 2 encryption block. For details on this data format, see <I>The Public-Key Cryptography Standards (PKCS)</I>, published by RSA Data Security, Inc.</P>

<P>This data is always the same size as the public key's modulus. For example, public keys generated by the Microsoft RSA Base Provider are always 512 bits (64 bytes) in length, so the encrypted session key data is also always 64 bytes.</P>

</BODY>
</HTML>
