<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>QueryServiceStatus</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="jps..c"></A><B>QueryServiceStatus  <A HREF="uz9z4.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="12c8zrk.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="we4jtq.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>QueryServiceStatus</B> function retrieves the current status of the specified service. </P>

<P><B>BOOL QueryServiceStatus(</B></P>

<TABLE cols=2 width=538>

<TR VALIGN="top">
<TD width=52%><B>SC_HANDLE</B> <I>hService</I><B>,</B></TD>
<TD width=48%>// handle of service </TD>
</TR>

<TR VALIGN="top">
<TD width=52%><B>    LPSERVICE_STATUS</B> <I>lpServiceStatus</I> </TD>
<TD width=48%>// address of service status structure  </TD>
</TR>

<TR VALIGN="top">
<TD width=52%><B>   );</B></TD>
<TD width=48%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hService</I></P>

<P>Identifies the service. This handle is returned by the <A HREF="20gsky6.htm"><B>OpenService</B></A> or the <A HREF="2wng26.htm"><B>CreateService</B></A> function, and it must have SERVICE_QUERY_STATUS access. </P>

<P><I>lpServiceStatus</I></P>

<P>Points to a <A HREF="25uoeu.htm"><B>SERVICE_STATUS</B></A> structure in which the status information is returned. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Errors</B></P>

<P>The following error codes may be set by the service control manager. Other error codes may be set by the registry functions that are called by the service control manager. </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=40%><B>Value</B></TD>
<TD width=60%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=40%>ERROR_ACCESS_DENIED</TD>
<TD width=60%>The specified handle was not opened with SERVICE_QUERY_STATUS access.</TD>
</TR>

<TR VALIGN="top">
<TD width=40%>ERROR_INVALID_HANDLE</TD>
<TD width=60%>The specified handle is invalid.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>The <B>QueryServiceStatus</B> function returns the most recent service status information reported to the service control manager. The service may have just changed its status and may not have updated the service control manager yet. Applications can find out the absolutely latest service status by interrogating the service directly by using the <A HREF="2nu_3f.htm"><B>ControlService</B></A> function with the SERVICE_CONTROL_INTERROGATE control code. </P>

<P><B>See Also</B></P>

<P><A HREF="2nu_3f.htm"><B>ControlService</B></A>, <A HREF="2wng26.htm"><B>CreateService</B></A>, <A HREF="20gsky6.htm"><B>OpenService</B></A>, <A HREF="25uoeu.htm"><B>SERVICE_STATUS</B></A>, <A HREF="u71xdk.htm"><B>SetServiceStatus</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
