<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>CompareString</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="7s0y95"></A><B>CompareString  <A HREF="7bol54.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1r0c_vq.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="21act6p.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>CompareString</B> function compares two character strings, using the locale specified by the given identifier as the basis for the comparison. </P>

<P><B>int CompareString(</B></P>

<TABLE cols=2 width=501>

<TR VALIGN="top">
<TD width=37%><B>LCID</B> <I>Locale</I><B>,</B></TD>
<TD width=63%>// locale identifier </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    DWORD</B> <I>dwCmpFlags</I><B>,</B></TD>
<TD width=63%>// comparison-style options </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    LPCTSTR</B> <I>lpString1</I><B>,</B></TD>
<TD width=63%>// pointer to first string </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    int</B> <I>cchCount1</I><B>,</B></TD>
<TD width=63%>// size, in bytes or characters, of first string </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    LPCTSTR</B> <I>lpString2</I><B>,</B></TD>
<TD width=63%>// pointer to second string </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    int</B> <I>cchCount2</I> </TD>
<TD width=63%>// size, in bytes or characters, of second string  </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>   );</B></TD>
<TD width=63%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>Locale</I></P>

<P>Specifies the locale used for the comparison. This parameter can be one of the following predefined locale identifiers:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=44%><B>Value</B></TD>
<TD width=56%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LOCALE_SYSTEM_DEFAULT</TD>
<TD width=56%>The system's default locale.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LOCALE_USER_DEFAULT</TD>
<TD width=56%>The current user's default locale.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>This parameter can also be a locale identifier created by the <A HREF="d5jw6g.htm"><B>MAKELCID</B></A> macro.</P>

<P><I>dwCmpFlags</I></P>

<P>A set of flags that indicate how the function compares the two strings. By default, these flags are not set. This parameter can specify zero to get the default behavior, or it can be any combination of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=44%><B>Value</B></TD>
<TD width=56%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=44%>NORM_IGNORECASE</TD>
<TD width=56%>Ignore case.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>NORM_IGNOREKANATYPE</TD>
<TD width=56%>Do not differentiate between Hiragana and Katakana characters. Corresponding Hiragana and Katakana characters compare as equal.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>NORM_IGNORENONSPACE</TD>
<TD width=56%>Ignore nonspacing characters.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>NORM_IGNORESYMBOLS</TD>
<TD width=56%>Ignore symbols.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>NORM_IGNOREWIDTH</TD>
<TD width=56%>Do not differentiate between a single-byte character and the same character as a double-byte character.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>SORT_STRINGSORT</TD>
<TD width=56%>Treat punctuation the same as symbols.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lpString1</I></P>

<P>Points to the first string to be compared. </P>

<P><I>cchCount1</I></P>

<P>Specifies the size, in bytes (ANSI version) or characters (Unicode version), of the string pointed to by the <I>lpString1</I> parameter. If this parameter is  - 1, the string is assumed to be null terminated and the length is calculated automatically. </P>

<P><I>lpString2</I></P>

<P>Points to the second string to be compared. </P>

<P><I>cchCount2</I></P>

<P>Specifies the size, in bytes (ANSI version) or characters (Unicode version), of the string pointed to by the <I>lpString2</I> parameter. If this parameter is  - 1, the string is assumed to be null terminated and the length is calculated automatically. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=13%><B>Value</B></TD>
<TD width=87%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=13%>1</TD>
<TD width=87%>The string pointed to by the <I>lpString1</I> parameter is less in lexical value than the string pointed to by the <I>lpString2</I> parameter.</TD>
</TR>

<TR VALIGN="top">
<TD width=13%>2</TD>
<TD width=87%>The string pointed to by <I>lpString1</I> is equal in lexical value to the string pointed to by <I>lpString2</I>.</TD>
</TR>

<TR VALIGN="top">
<TD width=13%>3</TD>
<TD width=87%>The string pointed to by <I>lpString1</I> is greater in lexical value than the string pointed to by <I>lpString2</I>.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. <B>GetLastError</B> may return one of the following error codes:</P>

<TABLE cols=1>

<TR VALIGN="top">
<TD width=100%>ERROR_INVALID_FLAGS</TD>
</TR>

<TR VALIGN="top">
<TD width=100%>ERROR_INVALID_PARAMETER</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>Notice that if the return value is 2, the two strings are "equal" in the collation sense, though not necessarily identical. </P>

<P>To maintain the C run-time convention of comparing strings, the value 2 can be subtracted from a nonzero return value. The meaning of &lt; <I>0, ==0 and &gt; </I>0 is then consistent with the C run times. </P>

<P>If the two strings are of different lengths, they are compared up to the length of the shortest one. If they are equal to that point, then the return value will indicate that the longer string is greater. For more information about locale identifiers, see <A HREF="cxvwq5.htm">Locale Identifiers</A>. </P>

<P>Typically, strings are compared using what is called a "word sort" technique. In a word sort, all punctuation marks and other nonalphanumeric characters, except for the hyphen and the apostrophe, come before any alphanumeric character. The hyphen and the apostrophe are treated differently than the other nonalphanumeric symbols, in order to ensure that words such as "coop" and "co-op" stay together within a sorted list. </P>

<P>If the SORT_STRINGSORT flag is specified, strings are compared using what is called a "string sort" technique. In a string sort, the hyphen and apostrophe are treated just like any other nonalphanumeric symbols: they come before the alphanumeric symbols. </P>

<P>The following table shows a list of words sorted both ways: </P>

<TABLE cols=5>

<TR VALIGN="top">
<TD width=19%><B>Word Sort</B></TD>
<TD width=19%><B>String Sort</B></TD>
<TD width=6%><B>     </B></TD>
<TD width=18%><B>Word Sort</B></TD>
<TD width=38%><B>String Sort</B></TD>
</TR>

<TR VALIGN="top">
<TD width=19%>billet</TD>
<TD width=19%>bill's</TD>
<TD width=6%> </TD>
<TD width=18%>t-ant</TD>
<TD width=38%>t-ant </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>bills</TD>
<TD width=19%>billet</TD>
<TD width=6%> </TD>
<TD width=18%>tanya</TD>
<TD width=38%>t-aria </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>bill's</TD>
<TD width=19%>bills</TD>
<TD width=6%> </TD>
<TD width=18%>t-aria</TD>
<TD width=38%>tanya </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>cannot</TD>
<TD width=19%>can't</TD>
<TD width=6%> </TD>
<TD width=18%>sued</TD>
<TD width=38%>sue's </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>cant</TD>
<TD width=19%>cannot</TD>
<TD width=6%> </TD>
<TD width=18%>sues</TD>
<TD width=38%>sued </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>can't</TD>
<TD width=19%>cant</TD>
<TD width=6%> </TD>
<TD width=18%>sue's</TD>
<TD width=38%>sues </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>con</TD>
<TD width=19%>co-op</TD>
<TD width=6%> </TD>
<TD width=18%>went</TD>
<TD width=38%>we're </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>coop</TD>
<TD width=19%>con</TD>
<TD width=6%> </TD>
<TD width=18%>were</TD>
<TD width=38%>went </TD>
</TR>

<TR VALIGN="top">
<TD width=19%>co-op</TD>
<TD width=19%>coop</TD>
<TD width=6%> </TD>
<TD width=18%>we're</TD>
<TD width=38%>were </TD>
</TR>
</TABLE><BR>

<P></P>

<P>The <B>lstrcmp</B> and <B>lstrcmpi</B> functions use a word sort. The <B>CompareString</B> and <B>LCMapString</B> functions default to using a word sort, but use a string sort if their caller sets the SORT_STRINGSORT flag. </P>

<P>The <B>CompareString</B> function is optimized to run at the highest speed when <I>dwCmpFlags</I> is set to 0 or NORM_IGNORECASE, and <I>cchCount1</I> and <I>cchCount2</I> have the value -1.</P>

<P>The <B>CompareString </B>function ignores Arabic Kashidas during the comparison. Thus, if two strings are identical save for the presence of Kashidas, <B>CompareString</B> returns a value of 2; the strings are considered "equal" in the collation sense, though they are not necessarily identical.</P>

<P><B>See Also</B></P>

<P><A HREF="1p4hsgd.htm"><B>FoldString</B></A>, <A HREF="4vlf_ld.htm"><B>GetSystemDefaultLCID</B></A>, <A HREF="15wlns7.htm"><B>GetUserDefaultLCID</B></A>, <A HREF="2kbvc5.htm"><B>LCMapString</B></A>, <A HREF="e8v4bo.htm"><B>lstrcmp</B></A>, <A HREF="68cpv2.htm"><B>lstrcmpi</B></A>, <A HREF="d5jw6g.htm"><B>MAKELCID</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
