<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WinHelp</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1p1p.rf"></A><B>WinHelp  <A HREF="11binsn.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="udahlb.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="xcf2tg.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>WinHelp</B> function starts Windows Help (WINHELP.EXE) and passes additional data indicating the nature of the help requested by the application. The application specifies the name and, where required, the directory path of the help file to display. </P>

<P><B>BOOL WinHelp(</B></P>

<TABLE cols=2 width=417>

<TR VALIGN="top">
<TD width=40%><B>HWND</B> <I>hWndMain</I><B>,</B></TD>
<TD width=60%>// handle of window requesting Help </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    LPCTSTR</B> <I>lpszHelp</I><B>,</B></TD>
<TD width=60%>// address of directory-path string </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    UINT</B> <I>uCommand</I><B>,</B></TD>
<TD width=60%>// type of Help </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    DWORD</B> <I>dwData</I> </TD>
<TD width=60%>// additional data </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>   );</B></TD>
<TD width=60%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hWndMain</I></P>

<P>Identifies the window requesting Help. The <B>WinHelp</B> function uses this handle to keep track of which applications have requested Help. </P>

<P><I>lpszHelp</I></P>

<P>Points to a null-terminated string containing the path, if necessary, and the name of the Help file that the Help application is to display. </P>

<P>The filename may be followed by an angle bracket (&gt;) and the name of a secondary window if the topic is to be displayed in a secondary window rather than in the primary window. The name of the secondary window must have been defined in the [WINDOWS] section of the Help project (.HPJ) file. </P>

<P><I>uCommand</I></P>

<P>Specifies the type of help requested. For a list of possible values and how they affect the value to place in the <I>dwData</I> parameter, see the Remarks section. </P>

<P><I>dwData</I></P>

<P>Specifies additional data. The value used depends on the value of the <I>uCommand</I> parameter. For a list of possible values, see the Remarks section. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. </P>

<P><B>Remarks</B></P>

<P>Before closing the window that requested Help, the application must call <B>WinHelp</B> with the <I>uCommand</I> parameter set to HELP_QUIT. Until all applications have done this, Windows Help will not terminate. Note that calling WinHelp with the HELP_QUIT command is not necessary if you used the HELP_CONTEXTPOPUP command to start Help</P>

<P>The following table shows the possible values for the <I>uCommand</I> parameter and the corresponding formats of the <I>dwData</I> parameter: </P>

<TABLE cols=3>

<TR VALIGN="top">
<TD width=42%><B>uCommand</B></TD>
<TD width=29%><B>Action</B></TD>
<TD width=29%><B>dwData</B></TD>
</TR>

<TR VALIGN="top">
<TD width=42%>HELP_COMMAND</TD>
<TD width=29%>Executes a Help macro or macro string. </TD>
<TD width=29%>Address of a string that specifies the name of the Help macro(s) to execute. If the string specifies multiple macros names, the names must be separated by semicolons. You must use the short form of the macro name for some macros because Help does not support the long name.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>HELP_CONTENTS</TD>
<TD width=29%>Displays the topic specified by the Contents option in the [OPTIONS] section of the .HPJ file. This is for backward compatibility. New applications should provide a .CNT file and use the HELP_FINDER command.</TD>
<TD width=29%>Ignored, set to 0.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>HELP_CONTEXT</TD>
<TD width=29%>Displays the topic identified by the specified context identifier defined in the [MAP] section of the .HPJ file. </TD>
<TD width=29%>Unsigned long integer containing the context identifier for the topic.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>HELP_CONTEXTPOPUP</TD>
<TD width=29%>Displays, in a pop-up window, the topic identified by the specified context identifier defined in the [MAP] section of the .HPJ file. </TD>
<TD width=29%>Unsigned long integer containing the context identifier for a topic.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>HELP_FORCEFILE</TD>
<TD width=29%>Ensures that <B>WinHelp</B> is displaying the correct help file. If the incorrect help file is being displayed, <B>WinHelp</B> opens the correct one; otherwise, there is no action. </TD>
<TD width=29%>Ignored, set to 0.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>HELP_HELPONHELP</TD>
<TD width=29%>Displays help on how to use Windows Help, if the <B>WINHELP.HLP</B> file is available.</TD>
<TD width=29%>Ignored, set to 0.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>HELP_INDEX</TD>
<TD width=29%>Displays the Index in the Help Topics dialog box. This command is for backward compatibility. New applications should use the HELP_FINDER command.</TD>
<TD width=29%>Ignored, set to 0.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>HELP_KEY</TD>
<TD width=29%>Displays the topic in the keyword table that matches the specified keyword, if there is an exact match. If there is more than one match, displays the Index with the topics listed in the Topics Found list box. </TD>
<TD width=29%>Address of a keyword string.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>HELP_MULTIKEY</TD>
<TD width=29%>Displays the topic specified by a keyword in an alternative keyword table. </TD>
<TD width=29%>Address of a <A HREF="1ldcpx.htm"><B>MULTIKEYHELP</B></A> structure that specifies a table footnote character and a keyword. </TD>
</TR>

<TR VALIGN="top">
<TD width=42%>HELP_PARTIALKEY</TD>
<TD width=29%>Displays the topic in the keyword table that matches the specified keyword, if there is an exact match. If there is more than one match, displays the Index tab. To display the Index without passing a keyword (the third result), you should use a pointer to an empty string. </TD>
<TD width=29%>Address of a keyword  string.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>HELP_QUIT</TD>
<TD width=29%>Informs the Help application that it is no longer needed. If no other applications have asked for Help, Windows closes the Help application. </TD>
<TD width=29%>Ignored, set to 0.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>HELP_SETCONTENTS</TD>
<TD width=29%>Specifies the Contents topic. The Help application displays this topic when the user clicks the Contents button. </TD>
<TD width=29%>Unsigned long integer containing the context identifier for the Contents topic.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>HELP_SETINDEX</TD>
<TD width=29%>Specifies a keyword table to be displayed in the Index of the Help Topics dialog box. </TD>
<TD width=29%>Unsigned long integer containing the context identifier for the Index topic.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>HELP_SETWINPOS</TD>
<TD width=29%>Displays the Help window, if it is minimized or in memory, and sets its size and position as specified. </TD>
<TD width=29%>Address of a <A HREF="1xwu4m4.htm"><B>HELPWININFO</B></A> structure that specifies the size and position of either a primary or secondary Help window. </TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="1xwu4m4.htm"><B>HELPWININFO</B></A>, <A HREF="1ldcpx.htm"><B>MULTIKEYHELP</B></A> </P>

</BODY>
</HTML>
