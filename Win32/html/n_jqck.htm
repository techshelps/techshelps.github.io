<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Using the Keyboard to Move the Cursor</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="n_jqck"></A><B>Using the Keyboard to Move the Cursor</B></P>

<P>Because Windows does not require a mouse, an application should be able to simulate mouse actions with the keyboard. The following example shows how to achieve this, by using the <A HREF=".p..gr.htm"><B>GetCursorPos</B></A> and <A HREF="1mr5nzr.htm"><B>SetCursorPos</B></A> functions, and by processing input from the arrow keys. </P>

<P>HCURSOR hCurs1, hCurs2;    // cursor handles  </P>

<P></P>

<P>POINT pt;                  // cursor location  </P>

<P>RECT rc;                   // client area coordinates </P>

<P>static int repeat = 1;     // repeat key counter </P>

<P></P>

<P>// </P>

<P>// Other declarations and initialization. </P>

<P>// </P>

<P></P>

<P>switch (message) </P>

<P>{ </P>

<P>// </P>

<P>// Process other messages. </P>

<P>// </P>

<P></P>

<P>case WM_KEYDOWN: </P>

<P></P>

<P>if (wParam != VK_LEFT &amp;&amp; wParam != VK_RIGHT &amp;&amp; </P>

<P>wParam != VK_UP &amp;&amp; wParam != VK_DOWN) </P>

<P>{ </P>

<P>break; </P>

<P>} </P>

<P></P>

<P>GetCursorPos(&amp;pt); </P>

<P></P>

<P>// Convert screen coordinates to client coordinates. </P>

<P></P>

<P>ScreenToClient(hwnd, &amp;pt); </P>

<P></P>

<P>switch (wParam) </P>

<P>{ </P>

<P>// Move the cursor to reflect which </P>

<P>// arrow keys are pressed. </P>

<P></P>

<P>case VK_LEFT:               // left arrow </P>

<P>pt.x -= repeat; </P>

<P>break; </P>

<P></P>

<P>case VK_RIGHT:              // right arrow </P>

<P>pt.x += repeat; </P>

<P>break; </P>

<P></P>

<P>case VK_UP:                 // up arrow </P>

<P>pt.y -= repeat; </P>

<P>break; </P>

<P></P>

<P>case VK_DOWN:               // down arrow </P>

<P>pt.y += repeat; </P>

<P>break; </P>

<P></P>

<P>default: </P>

<P>return NULL; </P>

<P></P>

<P>} </P>

<P></P>

<P>repeat++;           // increment repeat count </P>

<P></P>

<P>// Keep the cursor in the client area. </P>

<P></P>

<P>GetClientRect(hwnd, &amp;rc); </P>

<P></P>

<P>if (pt.x &gt;= rc.right) </P>

<P>{ </P>

<P>pt.x = rc.right - 1; </P>

<P>} </P>

<P>else </P>

<P>{ </P>

<P>if (pt.x &lt; rc.left) </P>

<P>{ </P>

<P>pt.x = rc.left; </P>

<P>} </P>

<P>} </P>

<P></P>

<P>if (pt.y &gt;= rc.bottom) </P>

<P>pt.y = rc.bottom - 1; </P>

<P>else </P>

<P>if (pt.y &lt; rc.top) </P>

<P>pt.y = rc.top; </P>

<P></P>

<P>// Convert client coordinates to screen coordinates. </P>

<P></P>

<P>ClientToScreen(hwnd, &amp;pt); </P>

<P>SetCursorPos(pt.x, pt.y); </P>

<P>break; </P>

<P></P>

<P>case WM_KEYUP: </P>

<P></P>

<P>repeat = 1;            // clear repeat count </P>

<P>break; </P>

<P></P>

<P>} </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
