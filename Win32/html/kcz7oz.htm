<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetOverlappedResult</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="kcz7oz"></A><B>GetOverlappedResult  <A HREF="1moie7h.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="36dp5f5.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="24h9od3.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetOverlappedResult</B> function returns the results of an overlapped operation on the specified file, named pipe, or communications device. </P>

<P><B>Windows 95:</B> This function works only on serial devices or on files opened by using the <B>DeviceIoControl</B> function.</P>

<P><B>BOOL GetOverlappedResult(</B></P>

<TABLE cols=2 width=623>

<TR VALIGN="top">
<TD width=48%><B>HANDLE</B> <I>hFile</I><B>,</B></TD>
<TD width=52%>// handle of file, pipe, or communications device  </TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    LPOVERLAPPED</B> <I>lpOverlapped</I><B>,</B></TD>
<TD width=52%>// address of overlapped structure </TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    LPDWORD</B> <I>lpNumberOfBytesTransferred</I><B>,</B></TD>
<TD width=52%>// address of actual bytes count </TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>    BOOL</B> <I>bWait</I> </TD>
<TD width=52%>// wait flag </TD>
</TR>

<TR VALIGN="top">
<TD width=48%><B>   );</B></TD>
<TD width=52%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hFile</I></P>

<P>Identifies the file, named pipe, or communications device. This is the same handle that was specified when the overlapped operation was started by a call to the <B>ReadFile</B>, <B>WriteFile</B>, <B>ConnectNamedPipe</B>, <B>TransactNamedPipe</B>, <B>DeviceIoControl</B>, or <B>WaitCommEvent</B> function. </P>

<P><I>lpOverlapped</I></P>

<P>Points to an <A HREF="1n286m5.htm"><B>OVERLAPPED</B></A> structure that was specified when the overlapped operation was started. </P>

<P><I>lpNumberOfBytesTransferred</I></P>

<P>Points to a 32-bit variable that receives the number of bytes that were actually transferred by a read or write operation. For a <A HREF="1nuxhmk.htm"><B>TransactNamedPipe</B></A> operation, this is the number of bytes that were read from the pipe. For a <A HREF="64ie_y8.htm"><B>DeviceIoControl</B></A> operation, this is the number of bytes of output data returned by the device driver. For a <A HREF="ksa3sm.htm"><B>ConnectNamedPipe</B></A> or <A HREF="orjgqo.htm"><B>WaitCommEvent</B></A> operation, this value is undefined. </P>

<P><I>bWait</I></P>

<P>Specifies whether the function should wait for the pending overlapped operation to be completed. If TRUE, the function does not return until the operation has been completed. If FALSE and the operation is still pending, the function returns FALSE and the <B>GetLastError</B> function returns ERROR_IO_INCOMPLETE. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>The results reported by the <B>GetOverlappedResult</B> function are those of the specified handle's last overlapped operation to which the specified <A HREF="1n286m5.htm"><B>OVERLAPPED</B></A> structure was provided, and for which the operation's results were pending. A pending operation is indicated when the function that started the operation returns FALSE, and the <B>GetLastError</B> function returns ERROR_IO_PENDING. When an I/O operation is pending, the function that started the operation resets the <B>hEvent</B> member of the <B>OVERLAPPED</B> structure to the nonsignaled state. Then when the pending operation has been completed, the system sets the event object to the signaled state. </P>

<P>If the <I>bWait</I> parameter is TRUE, <B>GetOverlappedResult</B> determines whether the pending operation has been completed by waiting for the event object to be in the signaled state. </P>

<P>If the <B>hEvent</B> member of the <A HREF="1n286m5.htm"><B>OVERLAPPED</B></A> structure is NULL, the system uses the state of the <I>hFile</I> handle to signal when the operation has been completed. Use of file, named pipe, or communications-device handles for this purpose is discouraged. It is safer to use an event object because of the confusion that can occur when multiple simultaneous overlapped operations are performed on the same file, named pipe, or communications device. In this situation, there is no way to know which operation caused the object's state to be signaled. </P>

<P>Specify a manual-reset event object in the <B>OVERLAPPED</B> structure. If an auto-reset event object is used, the event handle must not be specified in any other wait operation in the interval between starting the overlapped operation and the call to <B>GetOverlappedResult</B>. For example, the event object is sometimes specified in one of the wait functions to wait for the operation's completion. When the wait function returns, the system sets an auto-reset event's state to nonsignaled, and a subsequent call to <B>GetOverlappedResult</B> with the <I>bWait</I> parameter set to TRUE causes the function to be blocked indefinitely. </P>

<P><B>See Also</B></P>

<P><A HREF="62a8_h_.htm"><B>CancelIo</B></A>, <A HREF="ksa3sm.htm"><B>ConnectNamedPipe</B></A>, <A HREF="j_zbjv.htm"><B>CreateEvent</B></A>, <A HREF="64ie_y8.htm"><B>DeviceIoControl</B></A>, <A HREF="11c2vs7.htm"><B>GetLastError</B></A>, <A HREF="1n286m5.htm"><B>OVERLAPPED</B></A>, <A HREF="cjnd8p.htm"><B>ReadFile</B></A>, <A HREF="1nuxhmk.htm"><B>TransactNamedPipe</B></A>, <A HREF="orjgqo.htm"><B>WaitCommEvent</B></A>, <A HREF="g0sox_.htm"><B>WriteFile</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
