<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetCurrencyFormat</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="hzj7em"></A><B>GetCurrencyFormat  <A HREF="5d5i4h.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1r0c_vq.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="21act6p.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetCurrencyFormat</B> function formats a number string as a currency string for a specified locale.</P>

<P><B>int GetCurrencyFormat(</B></P>

<TABLE cols=2 width=605>

<TR VALIGN="top">
<TD width=44%><B>LCID</B> <I>Locale</I><B>,</B></TD>
<TD width=56%>// locale for which currency string is to be formatted </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    DWORD</B> <I>dwFlags</I><B>,</B></TD>
<TD width=56%>// bit flag that controls the function's operation</TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    LPCTSTR</B> <I>lpValue</I><B>,</B></TD>
<TD width=56%>// pointer to input number string</TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    CONST CURRENCYFMT </B><I>*lpFormat</I><B>,</B></TD>
<TD width=56%>// pointer to a formatting information structure</TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    LPTSTR</B> <I>lpCurrencyStr</I><B>,</B></TD>
<TD width=56%>// pointer to output buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    int</B> <I>cchCurrency</I> </TD>
<TD width=56%>// size of output buffer</TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>   );</B></TD>
<TD width=56%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>Locale</I></P>

<P>Specifies the locale for which the currency string is to be formatted. If <I>lpFormat</I> is NULL, the function formats the string according to the currency format for this locale. If <I>lpFormat</I> is not NULL, the function uses the locale only for formatting information not specified in the <A HREF="38xoeb.htm"><B>CURRENCYFMT</B></A> structure (for example, the locale's string value for the negative sign).</P>

<P>This parameter can be a locale identifier created by the <A HREF="d5jw6g.htm"><B>MAKELCID</B></A> macro, or one of the following predefined values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=50%>LOCALE_SYSTEM_DEFAULT</TD>
<TD width=50%>Default system locale.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>LOCALE_USER_DEFAULT</TD>
<TD width=50%>Default user locale.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>dwFlags</I></P>

<P>A bit flag that controls the operation of the function. If <I>lpFormat</I> is non-NULL, this parameter must be zero.</P>

<P>If <I>lpFormat</I> is NULL, you can specify the LOCALE_NOUSEROVERRIDE flag to format the string using the system default currency format for the specified locale; or you can specify zero to format the string using any user overrides to the locale's default currency format.</P>

<P><I>lpValue</I></P>

<P>Points to a null-terminated string containing the number string to format. </P>

<P>This string can contain only the following characters:</P>

<P>·Characters '0' through '9'</P>

<P>·One decimal point (dot) if the number is a floating-point value</P>

<P>·A minus sign in the first character position if the number is a negative value</P>

<P></P>

<P>All other characters are invalid. The function returns an error if the string pointed to by <I>lpValue</I> deviates from these rules.</P>

<P><I>lpFormat</I></P>

<P>Pointer to a <A HREF="38xoeb.htm"><B>CURRENCYFMT</B></A> structure that contains currency formatting information. All members in the structure pointed to by <I>lpFormat</I> must contain appropriate values.</P>

<P>If <I>lpFormat</I> is NULL, the function uses the currency format of the specified locale.</P>

<P><I>lpCurrencyStr</I></P>

<P>Points to a buffer to receive the formatted currency string.</P>

<P><I>cchCurrency</I></P>

<P>Specifies the size, in bytes (ANSI version) or characters (Unicode version), of the <I>lpCurrencyStr</I> buffer. If <I>cchCurrency </I>is zero, the function returns the number of bytes or characters required to hold the formatted currency string, and the buffer pointed to by <I>lpCurrencyStr</I> is not used.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is the number of bytes (ANSI version) or characters (Unicode version) written to the buffer pointed to by <I>lpCurrencyStr</I>, or if the <I>cchCurrency </I>parameter is zero, the number of bytes or characters required to hold the formatted currency string. </P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. <B>GetLastError</B> may return one of the following error codes: </P>

<P>ERROR_INSUFFICIENT_BUFFER<BR>
ERROR_INVALID FLAGS<BR>
ERROR_INVALID_PARAMETER</P>

<P><B>See Also</B></P>

<P><A HREF="2muy_5z.htm"><B>GetNumberFormat</B></A>,<B> <A HREF="38xoeb.htm">CURRENCYFMT</A></B></P>

</BODY>
</HTML>
