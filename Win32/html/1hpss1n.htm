<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DdeEnableCallback</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1hpss1n"></A><B>DdeEnableCallback  <A HREF="k5mzed.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="7m.xby.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="11k0r86.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>DdeEnableCallback</B> function enables or disables transactions for a specific conversation or for all conversations currently established by the calling application. </P>

<P>After disabling transactions for a conversation, the operating system places the transactions for that conversation in a transaction queue associated with the application. The application should reenable the conversation as soon as possible to avoid losing queued transactions. </P>

<P><B>BOOL DdeEnableCallback(</B></P>

<TABLE cols=2 width=371>

<TR VALIGN="top">
<TD width=38%><B>DWORD</B> <I>idInst</I><B>,</B></TD>
<TD width=62%>// instance identifier</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    HCONV</B> <I>hConv</I><B>,</B></TD>
<TD width=62%>// handle to conversation</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    UINT</B> <I>wCmd</I> </TD>
<TD width=62%>// enable or disable function code</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>   );</B></TD>
<TD width=62%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>idInst</I></P>

<P>Specifies the application-instance identifier obtained by a previous call to the <A HREF="1_pfuxk.htm"><B>DdeInitialize</B></A> function. </P>

<P><I>hConv</I></P>

<P>Identifies the conversation to enable or disable. If this parameter is NULL, the function affects all conversations. </P>

<P><I>wCmd</I></P>

<P>Specifies the function code. This parameter can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=36%><B>Value</B></TD>
<TD width=64%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=36%>EC_ENABLEALL</TD>
<TD width=64%>Enables all transactions for the specified conversation.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>EC_ENABLEONE</TD>
<TD width=64%>Enables one transaction for the specified conversation.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>EC_DISABLE</TD>
<TD width=64%>Disables all blockable transactions for the specified conversation.
<P>A server application can disable the following transactions:</P>

<P>XTYP_ADVSTART<BR>
XTYP_ADVSTOP<BR>
XTYP_EXECUTE<BR>
XTYP_POKE<BR>
XTYP_REQUEST</P>

<P>A client application can disable the following transactions:</P>

<P>XTYP_ADVDATA<BR>
XTYP_XACT_COMPLETE</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>EC_QUERYWAITING</TD>
<TD width=64%>Determines whether any transactions are in the queue for the specified conversation.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. </P>

<P>If the <I>wCmd</I> parameter is EC_QUERYWAITING, and the application transaction queue contains one or more unprocessed transactions that are not being processed, the return value is TRUE; otherwise, it is FALSE.</P>

<P><B>Errors</B></P>

<P>Use the <A HREF="aa7fa.htm"><B>DdeGetLastError</B></A> function to retrieve the error code, which may be one of the following: </P>

<P>DMLERR_DLL_NOT_INITIALIZED<BR>
DMLERR_NO_ERROR<BR>
DMLERR_INVALIDPARAMETER</P>

<P><B>Remarks</B></P>

<P>An application can disable transactions for a specific conversation by returning the CBR_BLOCK return code from its dynamic data exchange (DDE) callback function. When you reenable the conversation by using the <B>DdeEnableCallback</B> function, the operating system generates the same transaction that was in process when the conversation was disabled. </P>

<P>Using the EC_QUERYWAITING flag does not change the enable state of the conversation and does not cause transactions to be issued within the context of the call to <B>DdeEnableCallback</B>. </P>

<P>If <B>DdeEnableCallback</B> is called with EC_QUERYWAITING and the return value is TRUE, an application should try to quickly allow message processing, return from its callback, or enable callbacks. Such a result does not guarantee that subsequent callbacks will be made. Calling <B>DdeEnableCallback</B> with EC_QUERYWAITING lets an application with blocked callbacks determine whether there are any transactions pending on the blocked conversation. Of course, even if such a call returns false, an application should always process messages in a timely manner.</P>

<P><B>See Also</B></P>

<P><A HREF="1_izsoe.htm"><B>DdeConnect</B></A>, <A HREF="g2v2ut.htm"><B>DdeConnectList</B></A>, <A HREF="0._qht.htm"><B>DdeDisconnect</B></A>, <A HREF="1_pfuxk.htm"><B>DdeInitialize</B></A> </P>

</BODY>
</HTML>
