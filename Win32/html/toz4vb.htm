<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>RegEnumKey</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="toz4vb"></A><B>RegEnumKey  <A HREF="xwzyj1.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1y7hnby.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="vm.h_d.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>RegEnumKey</B> function enumerates subkeys of the specified open registry key. The function retrieves the name of one subkey each time it is called. This function is provided for compatibility with Windows version 3.1. Win32-based applications should use the <A HREF=".ak4qs.htm"><B>RegEnumKeyEx</B></A> function. </P>

<P><B>LONG RegEnumKey(</B></P>

<TABLE cols=2 width=415>

<TR VALIGN="top">
<TD width=38%><B>HKEY</B> <I>hKey</I><B>,</B></TD>
<TD width=62%>// handle of key to query </TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    DWORD</B> <I>dwIndex</I><B>,</B></TD>
<TD width=62%>// index of subkey to query </TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    LPTSTR</B> <I>lpName</I><B>,</B></TD>
<TD width=62%>// address of buffer for subkey name  </TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    DWORD</B> <I>cbName</I> </TD>
<TD width=62%>// size of subkey buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>   );</B></TD>
<TD width=62%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hKey</I></P>

<P>Identifies a currently open key or any of the following predefined reserved handle values: </P>

<P><B>HKEY_CLASSES_ROOT</B><BR>
<B>HKEY_CURRENT_USER</B><BR>
<B>HKEY_LOCAL_MACHINE</B><BR>
<B>HKEY_USERS</B></P>

<P>The keys returned are relative to the key identified by <I>hKey</I>. </P>

<P><I>dwIndex</I></P>

<P>Specifies the index of the subkey to retrieve. This value should be zero for the first call to the <B>RegEnumKey</B> function and then incremented for subsequent calls. </P>

<P>Because subkeys are not ordered, any new subkey will have an arbitrary index. This means that the function may return subkeys in any order. </P>

<P><I>lpName</I></P>

<P>Points to a buffer that receives the name of the subkey, including the terminating null character. This function copies only the name of the subkey, not the full key hierarchy, to the buffer. </P>

<P><I>cbName</I></P>

<P>Specifies the size, in characters, of the buffer pointed to by the <I>lpName</I> parameter, in characters. To determine the required buffer size, use the <A HREF="crty9k.htm"><B>RegQueryInfoKey</B></A> function to determine the size of the largest subkey for the key identified by the <I>hKey</I> parameter. The maximum required buffer size is (MAX_PATH + 1) characters. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is ERROR_SUCCESS.</P>

<P>If the function fails, the return value is a nonzero error code defined in WINERROR.H. You can use the <A HREF="n7qrmp.htm"><B>FormatMessage</B></A> function with the FORMAT_MESSAGE_FROM_SYSTEM flag to get a generic description of the error.</P>

<P><B>Remarks</B></P>

<P>To enumerate subkeys, an application should initially call the <B>RegEnumKey</B> function with the <I>dwIndex</I> parameter set to zero. The application should then increment the <I>dwIndex</I> parameter and call the <B>RegEnumKey</B> function until there are no more subkeys (until the function returns ERROR_NO_MORE_ITEMS). </P>

<P>The application can also set <I>dwIndex</I> to the index of the last key on the first call to the function and decrement the index until the subkey with index 0 is enumerated. To retrieve the index of the last subkey, use the <A HREF="crty9k.htm"><B>RegQueryInfoKey</B></A>. </P>

<P>While an application is using the <B>RegEnumKey</B> function, it should not make calls to any registration functions that might change the key being queried. </P>

<P>The key identitied by the <I>hKey</I> parameter must have been opened with KEY_ENUMERATE_SUB_KEYS access (KEY_READ access includes KEY_ENUMERATE_SUB_KEYS access). To open the key, use the <B>RegCreateKeyEx</B> or <B>RegOpenKeyEx</B> function. </P>

<P><B>See Also</B></P>

<P><A HREF="0f79.0.htm"><B>RegCloseKey</B></A>, <A HREF=".5u9k7.htm"><B>RegCreateKeyEx</B></A>, <A HREF="kr5n7j.htm"><B>RegDeleteKey</B></A>, <A HREF=".ak4qs.htm"><B>RegEnumKeyEx</B></A>, <A HREF="rz_3fo.htm"><B>RegOpenKeyEx</B></A>, <A HREF="crty9k.htm"><B>RegQueryInfoKey</B></A>, <A HREF="bwg6c_.htm"><B>RegQueryValue</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
