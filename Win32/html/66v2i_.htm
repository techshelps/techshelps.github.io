<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Opening a File</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="66v2i_"></A><B>Opening a File</B></P>

<P>This topic describes sample code that displays an Open dialog box so a user can specify the drive, directory, and name of a file to open. The sample code first initializes an <A HREF="2wivnae.htm"><B>OPENFILENAME</B></A> structure, and then calls the <A HREF="fzgrjg.htm"><B>GetOpenFileName</B></A> function to display the dialog box. </P>

<P>In this example, the <B>lpstrFilter</B> member points to a buffer that specifies two filename filters that the user can select to limit the filenames that are displayed. The buffer contains a double-null terminated array of strings in which each pair of strings specifies a filter. The <B>nFilterIndex</B> member specifies that the first pattern is used when the dialog box is created. </P>

<P>This example sets the OFN_PATHMUSTEXIST and OFN_FILEMUSTEXIST flags in the <B>Flags</B> member. These flags cause the dialog box to verify, before returning, that the path and filename specified by the user actually exist.</P>

<P>The <A HREF="fzgrjg.htm"><B>GetOpenFileName</B></A> function returns TRUE if the user clicks the OK button and the specified path and filename exist. In this case, the buffer pointed to by the <B>lpstrFile</B> member contains the path and filename. The sample code uses this information in a call to the <A HREF="xn35yd.htm"><B>CreateFile</B></A> function to open the file.</P>

<P>Although this example does not set the OFN_EXPLORER flag, it still displays the default Explorer-style Open dialog box. However, if you want to provide a hook procedure or a custom template and you want the Explorer user interface, you must set the OFN_EXPLORER flag.</P>

<P>OPENFILENAME ofn;       // common dialog box structure<BR>
char szFile[260];       // buffer for filename<BR>
HWND hwnd;              // owner window<BR>
HANDLE hf;              // file handle<BR>
<BR>
// Initialize OPENFILENAME<BR>
ZeroMemory(&amp;ofn, sizeof(OPENFILENAME));</P>

<P>ofn.lStructSize = sizeof(OPENFILENAME);<BR>
ofn.hwndOwner = hwnd;<BR>
ofn.lpstrFile = szFile;<BR>
ofn.nMaxFile = sizeof(szFile);</P>

<P>ofn.lpstrFilter = "All\0*.*\0Text\0*.TXT\0";<BR>
ofn.nFilterIndex = 1;<BR>
ofn.lpstrFileTitle = NULL;<BR>
ofn.nMaxFileTitle = 0;<BR>
ofn.lpstrInitialDir = NULL;<BR>
ofn.Flags = OFN_PATHMUSTEXIST | OFN_FILEMUSTEXIST;<BR>
<BR>
// Display the Open dialog box. <BR>
<BR>
if (GetOpenFileName(&amp;ofn)==TRUE) <BR>
    hf = CreateFile(ofn.lpstrFile, GENERIC_READ,<BR>
        0, (LPSECURITY_ATTRIBUTES) NULL,<BR>
        OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL,<BR>
        (HANDLE) NULL);<BR>
  </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
