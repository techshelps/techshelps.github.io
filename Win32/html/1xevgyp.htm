<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>RasGetProjectionInfo</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1xevgyp"></A><B>RasGetProjectionInfo  <A HREF="2hzk_.h.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="35kj_0r.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="lrsi7i.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>RasGetProjectionInfo</B> function obtains information about a remote access projection operation for a specified remote access component protocol.</P>

<P><B>DWORD RasGetProjectionInfo(</B></P>

<TABLE cols=2 width=637>

<TR VALIGN="top">
<TD width=38%><B>HRASCONN</B> <I>hrasconn</I><B>,</B></TD>
<TD width=62%>// handle that specifies remote access connection of interest</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    RASPROJECTION</B> <I>rasprojection</I><B>,</B></TD>
<TD width=62%>// specifies type of projection information to obtain</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    LPVOID</B> <I>lpprojection</I><B>,</B></TD>
<TD width=62%>// points to buffer that receives projection information</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    LPDWORD</B> <I>lpcb</I> </TD>
<TD width=62%>// points to variable that specifies buffer size</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>   );</B></TD>
<TD width=62%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hrasconn</I></P>

<P>Handle to the remote access connection of interest. An application obtains a RAS connection handle from the <A HREF="1zuv.va.htm"><B>RasDial</B></A> or <A HREF="lydo7.htm"><B>RasEnumConnections</B></A> function.</P>

<P><I>rasprojection</I></P>

<P>A <A HREF="1t8g.35.htm"><B>RASPROJECTION</B></A><B> </B>enumerated type value that specifies the protocol of interest. </P>

<P><I>lpprojection</I></P>

<P>Points to a buffer that will receive the information specified by the <I>rasprojection</I> parameter. The information will be in a structure appropriate to the <I>rasprojection </I>value:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=43%><B><I>rasprojection</I> value</B></TD>
<TD width=57%><B>Data structure</B></TD>
</TR>

<TR VALIGN="top">
<TD width=43%>RASP_Amb</TD>
<TD width=57%><A HREF="1gtwovm.htm"><B>RASAMB</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=43%>RASP_PppNbf</TD>
<TD width=57%><A HREF="9tfmbw.htm"><B>RASPPPNBF</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=43%>RASP_PppIpx</TD>
<TD width=57%><A HREF="_qdj0f.htm"><B>RASPPPIPX</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=43%>RASP_PppIp</TD>
<TD width=57%><A HREF="fo.8.5.htm"><B>RASPPPIP</B></A></TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lpcb</I></P>

<P>Points to a variable that, on entry, specifies the size in bytes of the buffer pointed to by <I>lpprojection</I>. On exit, this variable contains the size of buffer needed to contain the specified projection information.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is zero.</P>

<P>If the function fails, the return value is an error code. The function may return a nonzero RAS error code, or one of the following error codes:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=62%><B>Value</B></TD>
<TD width=38%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=62%>ERROR_BUFFER_TOO_SMALL</TD>
<TD width=38%>The buffer pointed to by <I>lpprojection</I> is not large enough to contain the requested information.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>ERROR_INVALID_HANDLE</TD>
<TD width=38%>The <I>hrasconn</I> parameter is not a valid handle.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>ERROR_INVALID_PARAMETER</TD>
<TD width=38%>One of the parameters is invalid.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>ERROR_INVALID_SIZE</TD>
<TD width=38%>The <B>dwSize</B> member of the structure pointed to by <I>lpprojection</I> specifies an invalid size.</TD>
</TR>

<TR VALIGN="top">
<TD width=62%>ERROR_PROTOCOL_NOT_CONFIGURED</TD>
<TD width=38%>The control protocol for which information was requested neither succeeded nor failed, because the connection's phone-book entry did not require that an attempt to negotiate the protocol be made. This is a RAS error code.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>Remote access projection is the process whereby a remote access server and a remote client negotiate network protocol-specific information. A remote access server uses this network protocol-specific information to represent a remote client on the network. </P>

<P><B>Windows NT:</B> Remote access projection information is not available until the operating system has executed the <A HREF="1zuv.va.htm"><B>RasDial</B></A><B> </B>RASCS_Projected state on the remote access connection. If <B>RasGetProjectionInfo</B> is called prior to the RASCS_Projected state, it returns ERROR_PROJECTION_NOT_COMPLETE. </P>

<P><B>Windows 95:</B> Windows 95 Dial-Up Networking does not support the RASCS_Projected state. The projection phase may be done during the RASCS_Authenticate state. If the authentication is successful, the connection operation proceeds to the RASCS_Authenticated state, and projection information is available for successfully configured protocols. If <B>RasGetProjectionInfo</B> is called prior to the RASCS_Authenticated state, it returns ERROR_PROTOCOL_NOT_CONFIGURED.</P>

<P><B>See Also</B></P>

<P><A HREF="1gtwovm.htm"><B>RASAMB</B></A>, <A HREF="1zuv.va.htm"><B>RasDial</B></A>, <A HREF="lydo7.htm"><B>RasEnumConnections</B></A>, <A HREF="9tfmbw.htm"><B>RASPPPNBF</B></A>, <A HREF="_qdj0f.htm"><B>RASPPPIPX</B></A>, <A HREF="fo.8.5.htm"><B>RASPPPIP</B></A>, <A HREF="1t8g.35.htm"><B>RASPROJECTION</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
