<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Adding Property Sheet Pages</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="2a3l8dg"></A><B>Adding Property Sheet Pages</B></P>

<P>The property sheet handler uses the <B>AddPages</B> member function in addition to the usual <B>IUnknown</B> member functions. The system calls the <B>AddPages</B> member function when it is about to display a property sheet. The system calls each property sheet handler registered to the file type to allow the handlers to add pages to the property sheets. The following example shows how to implement the <B>AddPages</B> member function.</P>

<P>STDMETHODIMP CSamplePageExt::AddPages(LPFNADDPROPSHEETPAGE lpfnAddPage,  </P>

<P>LPARAM lParam) </P>

<P>{ </P>

<P>PROPSHEETPAGE psp; </P>

<P>HPROPSHEETPAGE hpage; </P>

<P></P>

<P>psp.dwSize      = sizeof(psp);   // no extra data </P>

<P>psp.dwFlags     = PSP_USEREFPARENT | PSP_USERELEASEFUNC; </P>

<P>psp.hInstance   = (HINSTANCE)g_hmodThisDll; </P>

<P>psp.pszTemplate = MAKEINTRESOURCE(DLG_FSPAGE); </P>

<P>psp.pfnDlgProc  = FSPage_DlgProc; </P>

<P>psp.pcRefParent = &amp;g_cRefThisDll; </P>

<P>psp.pfnRelease  = FSPage_ReleasePage; </P>

<P>psp.lParam      = (LPARAM)hdrop; </P>

<P></P>

<P>hpage = CreatePropertySheetPage(&amp;psp); </P>

<P>if (hpage) { </P>

<P>if (!lpfnAddPage(hpage, lParam)) </P>

<P>DestroyPropertySheetPage(hpage); </P>

<P>} </P>

<P>return NOERROR; </P>

<P>} </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
