<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IShellBrowser::GetViewStateStream [Now Supported on Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1282ewf"></A><B>IShellBrowser::GetViewStateStream  <A HREF="o5jq_y.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A></B></P>

<P>[Now Supported on Windows NT]</P>

<P>The browser provides an <B>IStream</B> interface as the storage for view-specific state information.</P>

<P><B>HRESULT GetViewStateStream(</B></P>

<TABLE cols=2 width=413>

<TR VALIGN="top">
<TD width=41%><B>DWORD</B> <I>grfMode</I><B>,</B></TD>
<TD width=59%>// Specifies the mode</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    LPSTREAM</B> *<I>ppStrm</I></TD>
<TD width=59%>// Points to the LPSTREAM variable</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>   );</B></TD>
<TD width=59%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>grfMode</I></P>

<P>Specifiies the read-write access. This may be set to STGM_READ, STGM_WRITE, or STGM_READWRITE. For more information about these values see the STGM enumeration.</P>

<P><I>ppStrm</I></P>

<P>Pointer to the address of  the LPSTREAM variable to be filled.</P>

<P></P>

<P><B>Return Values</B></P>

<P>Returns NOERROR if successful or an OLE-defined error value otherwise.</P>

<P><B>Remarks</B></P>

<P>Used to save and restore the persistent state for a view. For example, the icon positions the column widths, and the current scroll position.</P>

<P><B>Notes to Callers:</B></P>

<P>Use <B>GetViewStateStream</B> when the view is being created to read in the saved view state and when the view is being closed to save any changes to the view state. Typically, the view calls this member with STGM_READ when creating a view window and with STGM_WRITE when the <B>SaveViewState</B> method of its <B>IShellView</B> interface is called.</P>

<P><B>Notes to Implementors:</B></P>

<P>Each shell view should have its own view stream. The Explorer implements an MRU (most recently used) list of view streams that are stored on a per-user basis in the registry.</P>

<P><B>See Also</B></P>

<P><A HREF="pgetm9.htm"><B>IShellBrowser</B></A> </P>

</BODY>
</HTML>
