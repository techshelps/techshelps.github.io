<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Using a Print Dialog Box and Retrieving a Printer Device Context</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="42cv0a2"></A><B>Using a Print Dialog Box and Retrieving a Printer Device Context</B></P>

<P>The first step in printing involves setting up the printer and obtaining a printer DC. In the sample application, the File menu contains two options, Print and Print Setup. By selecting either option, the user can configure the printer. When the user selects the Print Setup option, the Print Setup dialog box is displayed and the user can select a printer, a page orientation, a paper size, and so on. When the user selects the Print option, the Print dialog box is displayed and the user can select a range of pages, a print quality, a number of copies, and so on. The user can also display the Print Setup dialog box by clicking the Setup push button.</P>

<P>The Print and Print Setup dialog boxes are both displayed by initializing the members of a <A HREF="17iw9wo.htm"><B>PRINTDLG</B></A> structure and calling the <A HREF="11768vz.htm"><B>PrintDlg</B></A> function. (For more information about displaying the Print Setup dialog box, see <A HREF="y3i0nj.htm">Common Dialog Box Library</A>). In addition to retrieving user-specified data, <B>PrintDlg</B> can be used to obtain a printer DC by specifying the PD_RETURNDC value in the <B>Flags</B> member of the <B>PRINTDLG</B> structure. The following code sample shows how to intialize the members of the structure and to display the Print dialog box. </P>

<P>/* Initialize the PRINTDLG members. */  </P>

<P></P>

<P>pd.lStructSize = sizeof(PRINTDLG); </P>

<P>pd.hDevMode = (HANDLE) NULL; </P>

<P>pd.hDevNames = (HANDLE) NULL; </P>

<P>pd.Flags = PD_RETURNDC; </P>

<P>pd.hwndOwner = hwnd; </P>

<P>pd.hDC = (HDC) NULL; </P>

<P>pd.nFromPage = 1; </P>

<P>pd.nToPage = 1; </P>

<P>pd.nMinPage = 0; </P>

<P>pd.nMaxPage = 0; </P>

<P>pd.nCopies = 1; </P>

<P>pd.hInstance = (HANDLE) NULL; </P>

<P>pd.lCustData = 0L; </P>

<P>pd.lpfnPrintHook = (LPPRINTHOOKPROC) NULL; </P>

<P>pd.lpfnSetupHook = (LPSETUPHOOKPROC) NULL; </P>

<P>pd.lpPrintTemplateName = (LPSTR) NULL; </P>

<P>pd.lpSetupTemplateName = (LPSTR)  NULL; </P>

<P>pd.hPrintTemplate = (HANDLE) NULL; </P>

<P>pd.hSetupTemplate = (HANDLE) NULL; </P>

<P></P>

<P>/* Display the PRINT dialog box. */ </P>

<P></P>

<P>PrintDlg(&amp;pd); </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
