<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>File Times</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1s6ji7"></A><B>File Times</B></P>

<P>A <I>file time</I> represents the specific date and time at which a given file was created, last accessed, or last written to. Windows records file times whenever applications create, access, and write to files. Windows records the times using a 64-bit value specifying the number of 100-nanosecond intervals that have elapsed since 12:00 A.M. January 1, 1601 (UTC). Writing to a file changes the last write time; writing to or reading from the file (including running an executable file) changes the last access time.</P>

<P></P>

<P><B>Note</B>  Not all file systems can record creation and last access time. In particular, the file allocation table (FAT) file system records only last-write times.</P>

<P></P>

<P>You can retrieve the file times for a given file by using the <A HREF="19tokvn.htm"><B>GetFileTime</B></A> function. <B>GetFileTime</B> copies the creation, last access, and last write times to individual <A HREF="a44m8h.htm"><B>FILETIME</B></A> structures. Each structure consists of two 32-bit values that combine to form the single 64-bit value. You can also retrieve the file times by using the <A HREF="2a0z0q6.htm"><B>FindFirstFile</B></A> and <A HREF="jkcucc.htm"><B>FindNextFile</B></A> functions. These functions copy the times to <B>FILETIME</B> structures in a <A HREF="4tj_4n.htm"><B>WIN32_FIND_DATA</B></A> structure.</P>

<P>You can set the file times for a file by using the <A HREF="i1eeqq.htm"><B>SetFileTime</B></A> function. This function lets you modify creation, last access, and last write times without changing the content of the file. You can compare the times of different files by using the <A HREF="f_gf8u.htm"><B>CompareFileTime</B></A> function. The function compares two file times and returns a value indicating which time is greater or returns zero if the times are equal.</P>

<P>To make a file time more meaningful to a user, you can extract the month, day, year, and time of day from a file time by using the <A HREF="hxp8r1.htm"><B>FileTimeToSystemTime</B></A> function. <B>FileTimeToSystemTime</B> converts the file time and copies the individual values for date and time of day to a <A HREF="537fnx.htm"><B>SYSTEMTIME</B></A> structure.</P>

<P>Windows records all file times in UTC-based times, but you can convert a file time to the local time for your time zone by using the <A HREF="dv17jo.htm"><B>FileTimeToLocalFileTime</B></A> function. Before displaying a file time to a user, applications typically convert the file time to local time, then extract the month, day, year and time of day using <B>FileTimeToSystemTime</B>.</P>

<P>If you plan to modify file times for given files, you can convert a date and time of day to a file time by using the <A HREF="7kbv2_.htm"><B>SystemTimeToFileTime</B></A> function. You can also obtain the system time <A HREF="a44m8h.htm"><B>FILETIME</B></A> structure by calling the <A HREF="ebsuh3.htm"><B>GetSystemTimeAsFileTime</B></A> function.</P>

<P>If the original date and time of day are given in the local time for your time zone, you can convert the resulting file time to UTC by using the <A HREF="18ey13n.htm"><B>LocalFileTimeToFileTime</B></A> function. Always make sure the file times you set using <B>SetFileTime</B> are valid UTC-based times.</P>

</BODY>
</HTML>
