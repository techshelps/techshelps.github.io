<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Using Status Windows</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="7fojoi"></A><B>Using Status Windows</B></P>

<P>The following example creates a status window that has a sizing grip and divides the window into four equal parts based on the width of the parent window's client area.</P>

<P>// DoCreateStatusWindow - creates a status window and divides it into  </P>

<P>//     the specified number of parts. </P>

<P>// Returns the handle to the status window. </P>

<P>// hwndParent - parent window for the status window </P>

<P>// nStatusID - child window identifier </P>

<P>// hinst - handle to the application instance </P>

<P>// nParts - number of parts into which to divide the status window </P>

<P>HWND DoCreateStatusWindow(HWND hwndParent, int nStatusID, </P>

<P>HINSTANCE hinst, int nParts) </P>

<P>{ </P>

<P>HWND hwndStatus; </P>

<P>RECT rcClient; </P>

<P>HLOCAL hloc; </P>

<P>LPINT lpParts; </P>

<P>int i, nWidth; </P>

<P></P>

<P>// Ensure that the common control DLL is loaded. </P>

<P>InitCommonControls(); </P>

<P></P>

<P>// Create the status window. </P>

<P>hwndStatus = CreateWindowEx( </P>

<P>0,                       // no extended styles </P>

<P>STATUSCLASSNAME,         // name of status window class </P>

<P>(LPCTSTR) NULL,          // no text when first created </P>

<P>SBARS_SIZEGRIP |         // includes a sizing grip </P>

<P>WS_CHILD,                // creates a child window </P>

<P>0, 0, 0, 0,              // ignores size and position </P>

<P>hwndParent,              // handle to parent window </P>

<P>(HMENU) nStatusID,       // child window identifier </P>

<P>hinst,                   // handle to application instance </P>

<P>NULL);                   // no window creation data </P>

<P></P>

<P>// Get the coordinates of the parent window's client area. </P>

<P>GetClientRect(hwndParent, &amp;rcClient); </P>

<P></P>

<P>// Allocate an array for holding the right edge coordinates. </P>

<P>hloc = LocalAlloc(LHND, sizeof(int) * nParts); </P>

<P>lpParts = LocalLock(hloc); </P>

<P></P>

<P>// Calculate the right edge coordinate for each part, and </P>

<P>// copy the coordinates to the array. </P>

<P>nWidth = rcClient.right / nParts; </P>

<P>for (i = 0; i &lt; nParts; i++) { </P>

<P>lpParts[i] = nWidth; </P>

<P>nWidth += nWidth; </P>

<P>} </P>

<P></P>

<P>// Tell the status window to create the window parts. </P>

<P>SendMessage(hwndStatus, SB_SETPARTS, (WPARAM) nParts, </P>

<P>(LPARAM) lpParts); </P>

<P></P>

<P>// Free the array, and return. </P>

<P>LocalUnlock(hloc); </P>

<P>LocalFree(hloc); </P>

<P>return hwndStatus; </P>

<P>} </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
