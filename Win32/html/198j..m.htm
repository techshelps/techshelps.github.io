<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>The Help Button</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="198j..m"></A><B>The Help Button</B></P>

<P>You can display a Help button in any of the common dialog boxes by setting a SHOWHELP value in the <B>Flags</B> member of the initialization structure for the dialog box. If you display the Help button, you must process the user's request for help. The processing can be done either in one of your application's window procedures or in a hook procedure for the dialog box. Typically, you would process the request for help by calling the <A HREF="1p1p.rf.htm"><B>WinHelp</B></A> function.</P>

<P>To process help messages in one of your window procedures, you must get a message identifier for the string defined by the <A HREF="1n5cg6.htm">HELPMSGSTRING</A> value and identify the window to receive messages. To get the message identifier, specify HELPMSGSTRING as the parameter in a call to the <A HREF="xkgsv4.htm"><B>RegisterWindowMessage</B></A> function. When you create the common dialog box, use the <B>hwndOwner</B> member of the dialog box initialization structure to identify the window that is to receive the messages. The dialog box procedure sends the message to the window procedure whenever the user chooses the Help button. </P>

<P>To process help messages in a hook procedure, you should process the <A HREF="71v.3j.htm">WM_COMMAND</A> message. The hook procedure provides help if the <I>wParam</I> parameter of this message indicates that the user pressed the Help button. The identifier of the Help button is the <B>pshHelp</B> constant defined in the DLGS.H file. </P>

<P>Hook procedures for the Explorer-style Open and Save As common dialog boxes do not receive WM_COMMAND messages for the Help button. Instead, the dialog box sends a <A HREF="9ck.he.htm">CDN_HELP</A> notification message to the hook procedure when the Help button is clicked. </P>

<P></P>

</BODY>
</HTML>
