<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Creating a Header Control</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="_1uwoo"></A><B>Creating a Header Control</B></P>

<P>The following example creates a header control and positions it along the top of the parent window's client area. The control is initially hidden. The example uses the <A HREF="25pl6w5.htm">HDM_LAYOUT</A> message to determine the appropriate size and position of the control given the bounding rectangle of the parent window. Then the example sets the size and position of the control and makes it visible.</P>

<P>// DoCreateHeader - creates a header control that is positioned along  </P>

<P>//     the top of the parent window's client area. </P>

<P>// Returns the handle of the header control. </P>

<P>// hwndParent - handle of the parent window </P>

<P>// </P>

<P>// Global variable </P>

<P>//    g_hinst - handle of the application instance </P>

<P>extern HINSTANCE g_hinst; </P>

<P></P>

<P>HWND DoCreateHeader(HWND hwndParent) </P>

<P>{ </P>

<P>HWND hwndHeader; </P>

<P>RECT rcParent; </P>

<P>HD_LAYOUT hdl; </P>

<P>WINDOWPOS wp; </P>

<P></P>

<P>// Ensure that the common control DLL is loaded, and then create </P>

<P>// the header control. </P>

<P>InitCommonControls(); </P>

<P></P>

<P>if ((hwndHeader = CreateWindowEx(0, WC_HEADER, (LPCTSTR) NULL, </P>

<P>WS_CHILD | WS_BORDER | HDS_BUTTONS | HDS_HORZ, </P>

<P>0, 0, 0, 0, hwndParent, (HMENU) ID_HEADER, g_hinst, </P>

<P>(LPVOID) NULL)) == NULL) </P>

<P>return (HWND) NULL; </P>

<P></P>

<P>// Retrieve the bounding rectangle of the parent window's </P>

<P>// client area, and then request size and position values </P>

<P>// from the header control. </P>

<P>GetClientRect(hwndParent, &amp;rcParent); </P>

<P></P>

<P>hdl.prc = &amp;rcParent; </P>

<P>hdl.pwpos = &amp;wp; </P>

<P>if (!SendMessage(hwndHeader, HDM_LAYOUT, 0, (LPARAM) &amp;hdl)) </P>

<P>return (HWND) NULL; </P>

<P></P>

<P>// Set the size, position, and visibility of the header control. </P>

<P>SetWindowPos(hwndHeader, wp.hwndInsertAfter, wp.x, wp.y, </P>

<P>wp.cx, wp.cy, wp.flags | SWP_SHOWWINDOW); </P>

<P></P>

<P>return hwndHeader; </P>

<P>} </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
