<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NDdeShareAdd</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="2dm59g"></A><B>NDdeShareAdd  <A HREF="0yrei7.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="g0og1h.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="vyjzi3.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>NDdeShareAdd</B> function is called to create and add a new DDE share to the DDE Share Database Manager (DSDM). </P>

<P><B>UINT NDdeShareAdd(</B></P>

<TABLE cols=2 width=473>

<TR VALIGN="top">
<TD width=53%><B>LPTSTR</B> <I>lpszServer</I><B>,</B></TD>
<TD width=47%>// server to execute on</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>    UINT</B> <I>nLevel</I><B>,</B></TD>
<TD width=47%>// info level must be 2</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>    PSECURITY_DESCRIPTOR</B> <I>pSD</I><B>,</B></TD>
<TD width=47%>// initial security descriptor</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>    LPBYTE</B> <I>lpBuffer</I><B>,</B></TD>
<TD width=47%>// address of NDDESHAREINFO</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>    DWORD</B> <I>cBufSize</I> </TD>
<TD width=47%>// size of supplied buffer</TD>
</TR>

<TR VALIGN="top">
<TD width=53%><B>   );</B></TD>
<TD width=47%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpszServer</I></P>

<P>Address of the server name on which the DSDM will be modified. </P>

<P><I>nLevel</I></P>

<P>Must always be 2. </P>

<P><I>pSD</I></P>

<P>Address of the <A HREF="8_8u2z.htm"><B>SECURITY_DESCRIPTOR</B></A> that will be associated with this share and against which access checks will be performed on subsequent initiates to this share. This parameter can optionally be NULL, in which case the DSDM creates a default <B>SECURITY_DESCRIPTOR</B> that grants "Full Control" to the CREATOR_OWNER and "Read and Link" to everyone. </P>

<P><I>lpBuffer</I></P>

<P>Address of the <A HREF="4wt._8i.htm"><B>NDDESHAREINFO</B></A> structure that defines the ApplicationTopic list associated with the DDE share being created as well as other parameters. This parameter must not be NULL. </P>

<P><I>cBufSize</I></P>

<P>Size of the structure identified by lpBuffer. This parameter must not be 0. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is NDDE_NO_ERROR.</P>

<P>If the function fails, the return value is an error code, which can be translated into a text error message by calling <A HREF="i0y5fj.htm"><B>NDdeGetErrorString</B></A>. </P>

<P><B>Remarks</B></P>

<P>Before a client can connect to the DDE share, it must be trusted with <B>NDdeSetTrustedShare</B>.</P>

<P><B>See Also</B></P>

<P><A HREF="4wt._8i.htm"><B>NDDESHAREINFO</B></A>, <A HREF="dkuq2s.htm"><B>NDdeSetTrustedShare</B></A></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
