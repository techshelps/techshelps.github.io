<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Owner-Drawn Menus and the WM_DRAWITEM Message</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="hq202z"></A><B>Owner-Drawn Menus and the WM_DRAWITEM Message</B></P>

<P>Whenever the item must be drawn (for example, when it is first displayed or when the user selects it), Windows sends the <A HREF="70lqx9p.htm">WM_DRAWITEM</A> message to the window procedure of the menu's owner window. This message contains a pointer to a <A HREF="1sswtgp.htm"><B>DRAWITEMSTRUCT</B></A> structure, which contains information about the item, including the item data that an application may have assigned to it. In addition, <B>DRAWITEMSTRUCT</B> contains flags that indicate the state of the item (such as whether it is grayed or checked) as well as a bounding rectangle and a device context that the application uses to draw the item. </P>

<P>An application must do the following while processing the WM_DRAWITEM message:</P>

<P>1.Determine the type of drawing that is necessary. To do so, check the <B>itemAction</B> member of the <B>DRAWITEMSTRUCT</B> structure. </P>

<P>2.Draw the menu item appropriately, using the bounding rectangle and device context obtained from the <B>DRAWITEMSTRUCT</B> structure. The application must draw only within the bounding rectangle. For performance reasons, Windows does not clip portions of the image that are drawn outside the rectangle. </P>

<P>3.Restore all GDI objects selected for the menu item's device context. </P>

<P></P>

<P>If the user selects the menu item, Windows sets the <B>itemAction</B> member of the <A HREF="1sswtgp.htm"><B>DRAWITEMSTRUCT</B></A> structure to the ODA_SELECT value and sets the ODS_SELECTED value in the <B>itemState</B> member. This is an application's cue to redraw the menu item to indicate that it is selected.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
