<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WinTrustSubjectGetName [New - Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="44s7sk"></A><B>WinTrustSubjectGetName  <A HREF="1_6kp_r.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A></B></P>

<P>[New - Windows NT]</P>

<P>The <B>WinTrustSubjectGetName</B> function retrieves the name of a subject from a PKCS #7 Signed Data certificate that represents the subject. A trust provider can use the name to store and retrieve certificates associated with the subject.</P>

<P><B>BOOL WinTrustSubjectGetName(</B></P>

<TABLE cols=2 width=647>

<TR VALIGN="top">
<TD width=47%><B>LPWIN_TRUST_SIP_SUBJECT</B>  <I>lpSubject</I><B>,</B></TD>
<TD width=53%>// pointer to description of the subject </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    LPWIN_CERTIFICATE</B> <I>lpSignedData</I><B>,</B></TD>
<TD width=53%>// pointer to a signed data certificate</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    LPWSTR</B> <I>lpBuffer</I><B>,</B></TD>
<TD width=53%>// pointer to a buffer that receives the subject name</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    LPDWORD</B> <I>lpRequiredLength</I></TD>
<TD width=53%>// pointer to the size, in bytes, of the buffer</TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>   );</B></TD>
<TD width=53%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpSubject</I></P>

<P>Pointer to a <A HREF="1mtbf8..htm"><B>WIN_TRUST_SIP_SUBJECT</B></A> structure that identifies the type of subject. Note that the function retrieves the subject's name from the <I>lpSignedData</I> structure, not from the subject.</P>

<P><I>lpSignedData</I></P>

<P>Pointer to a <A HREF="fhzn96.htm"><B>WIN_CERTIFICATE</B></A> structure that contains a PKCS #7 Signed Data structure. The function retrieves the subject name from the data associated with this structure.</P>

<P><I>lpBuffer</I></P>

<P>Pointer to a buffer that receives a null-terminated, Unicode string that names the subject. </P>

<P><I>lpRequiredLength</I></P>

<P>Pointer to a <B>DWORD</B>. On input, it specifies the size, in bytes, of the <I>lpBuffer</I> buffer. On output, it receives the size, in bytes, of the returned string, including the terminating null character. If the buffer is not large enough to hold the string, the function fails, and <I>lpRequiredLength</I> returns the required buffer size. </P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is a nonzero value.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>A trust provider calls the WinTrust implementation of the <B>WinTrustSubjectGetName</B> function. WinTrust then calls the <B>WinTrustSubjectGetName</B> implementation of the appropriate Subject Interface Package (SIP). The appropriate SIP is the one registered to handle the type of subject specified by the <I>lpSubject</I> parameter.</P>

<P>Each Subject Interface Package (SIP) DLL must implement the <B>WinTrustSubjectGetName</B> function. WinTrust gets a pointer to the SIP's <B>WinTrustSubjectGetName</B> implementation when WinTrust calls the SIP's <A HREF="2mjrwza.htm"><B>WinTrustSipInitialize</B></A> initialization function. </P>

<P>A SIP's implementation of <B>WinTrustSubjectGetName</B> returns a name associated with the subject. This may be a filename, if the subject is a file, or some other string that identifies the subject. The purpose of this function is to provide a string that a trust provider can use to store and retrieve certificates associated with the subject. The name does not need to be unique, but it should identify the subject and be the same each time it is retrieved.</P>

<P>The LPWINTRUST_SUBJECT_GET_NAME type is a pointer to a <B>WinTrustSubjectGetName</B> function. </P>

<P><B>See Also</B></P>

<P><A HREF="fhzn96.htm"><B>WIN_CERTIFICATE</B></A>, <A HREF="1mtbf8..htm"><B>WIN_TRUST_SIP_SUBJECT</B></A>, <A HREF="2mjrwza.htm"><B>WinTrustSipInitialize</B></A> </P>

</BODY>
</HTML>
