<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CreateScalableFontResource</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="84kz7_"></A><B>CreateScalableFontResource  <A HREF="me8oz..htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="4jd_z5i.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1xkvu5n.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>CreateScalableFontResource</B> function creates a font resource file for a scalable font. </P>

<P><B>BOOL CreateScalableFontResource(</B></P>

<TABLE cols=2 width=473>

<TR VALIGN="top">
<TD width=45%><B>DWORD</B> <I>fdwHidden</I><B>,</B></TD>
<TD width=55%>// flag for read-only embedded font </TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    LPCTSTR</B> <I>lpszFontRes</I><B>,</B></TD>
<TD width=55%>// pointer to filename for font resource </TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    LPCTSTR</B> <I>lpszFontFile</I><B>,</B></TD>
<TD width=55%>// pointer to filename for scalable font </TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    LPCTSTR</B> <I>lpszCurrentPath</I> </TD>
<TD width=55%>// pointer to path to font file </TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>   );</B></TD>
<TD width=55%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>fdwHidden</I></P>

<P>Specifies whether the font is a read-only embedded font. This parameter can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=17%><B>Value</B></TD>
<TD width=83%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=17%>0</TD>
<TD width=83%>The font has read-write permission.</TD>
</TR>

<TR VALIGN="top">
<TD width=17%>1</TD>
<TD width=83%>The font has read-only permission and should be hidden from other applications in the system. When this flag is set, the font is not enumerated by the <A HREF="8av20gf.htm"><B>EnumFonts</B></A> or <A HREF="zxznx3.htm"><B>EnumFontFamilies</B></A> function.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lpszFontRes</I></P>

<P>Points to a null-terminated string specifying the name of the font resource file that this function creates. </P>

<P><I>lpszFontFile</I></P>

<P>Points to a null-terminated string specifying the name of the scalable font file that this function uses to create the font resource file. </P>

<P><I>lpszCurrentPath</I></P>

<P>Points to a null-terminated string specifying the path to the scalable font file. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>The <B>CreateScalableFontResource</B> function is used by applications that install TrueType fonts. An application uses the <B>CreateScalableFontResource</B> function to create a font resource file (typically with a .FOT filename extension) and then uses the <A HREF="hv76l6.htm"><B>AddFontResource</B></A> function to install the font. The TrueType font file (typically with a .TTF filename extension) must be in the SYSTEM subdirectory of the WINDOWS directory to be used by the <B>AddFontResource</B> function. </P>

<P>The <B>CreateScalableFontResource</B> function currently supports only TrueType-technology scalable fonts. </P>

<P>When the <I>lpszFontFile</I> parameter specifies only a filename and extension, the <I>lpszCurrentPath</I> parameter must specify a path. When the <I>lpszFontFile</I> parameter specifies a full path, the <I>lpszCurrentPath</I> parameter must be NULL or a pointer to NULL. </P>

<P>When only a filename and extension are specified in the <I>lpszFontFile</I> parameter and a path is specified in the <I>lpszCurrentPath</I> parameter, the string in <I>lpszFontFile</I> is copied into the .FOT file as the .TTF file that belongs to this resource. When the <A HREF="hv76l6.htm"><B>AddFontResource</B></A> function is called, the operating system assumes that the .TTF file has been copied into the SYSTEM directory (or into the main Windows directory in the case of a network installation). The .TTF file need not be in this directory when the <B>CreateScalableFontResource</B> function is called, because the <I>lpszCurrentPath</I> parameter contains the directory information. A resource created in this manner does not contain absolute path information and can be used in any Windows installation. </P>

<P>When a path is specified in the <I>lpszFontFile</I> parameter and NULL is specified in the <I>lpszCurrentPath</I> parameter, the string in <I>lpszFontFile</I> is copied into the .FOT file. In this case, when the <B>AddFontResource</B> function is called, the .TTF file must be at the location specified in the <I>lpszFontFile</I> parameter when the <B>CreateScalableFontResource</B> function was called; the <I>lpszCurrentPath</I> parameter is not needed. A resource created in this manner contains absolute references to paths and drives and does not work if the .TTF file is moved to a different location. </P>

<P><B>See Also</B></P>

<P><A HREF="hv76l6.htm"><B>AddFontResource</B></A>, <A HREF="8av20gf.htm"><B>EnumFonts</B></A>, <A HREF="zxznx3.htm"><B>EnumFontFamilies</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
