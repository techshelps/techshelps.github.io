<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Installable Policy Downloaders</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="10rz7s"></A><B>Installable Policy Downloaders</B></P>

<P>An installable policy downloader must be a Win32 dynamic-link library (DLL). It should export a named function that has the following form.</P>

<P><B>VOID FAR PASCAL</B> <B>ProcessPolicies(HWND</B> <I>hwndOwner</I><B>,</B> <BR>
<B>LPSTR</B> <I>lpszPolicyFilePath</I><B>,</B> <B>LPSTR</B> <I>lpszUserName</I><B>,</B> <BR>
<B>LPSTR</B> <I>lpszComputerName</I><B>,</B> <B>DWORD</B> <I>dwFlags</I><B>);</B></P>

<P><I>hwndOwner</I></P>

<P>Handle of the parent window.</P>

<P><I>lpszPolicyFilePath</I></P>

<P>Address of the full path and filename that MPR would have used to look for the policy file. The downloader may use this parameter, or ignore it and use a different path.</P>

<P><I>lpszUserName</I></P>

<P>Address of the user name for the user who is logged on.</P>

<P><I>lpszComputerName</I></P>

<P>Address of the local computer name.</P>

<P><I>dwFlags</I></P>

<P>Flags. This parameter can be this value:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=35%>PP_DISPLAYERRORS</TD>
<TD width=65%>Displays error messages about errors encountered during downloading (including the file is not found, the network resource is not found, and so on). Otherwise, the function should fail silently if there is an error.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>In addition to defining and exporting this function, an application must record it in the registry. The following entry should be added under the <B>HKEY_LOCAL_MACHINE</B>\<B>Network</B>\<B>Logon</B> key.</P>

<P>PolicyHandler = "<I>dll name</I>, <I>function name</I>"</P>

<P>In this example, <I>dll name</I> is the name of the DLL containing the function, and <I>function name</I> is the exported function name.</P>

<P></P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
