<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Creating a Tree-View Control</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="2x8mzkw"></A><B>Creating a Tree-View Control</B></P>

<P>To create a tree-view control, use the <A HREF="rpk.pc.htm"><B>CreateWindowEx</B></A> function, specifying the WC_TREEVIEW value for the window class. The tree-view window class is registered in the application's address space when the common control dynamic-link library (DLL) is loaded. To ensure that the DLL is loaded, use the <A HREF="h262.j.htm"><B>InitCommonControls</B></A> function.</P>

<P>The following example creates a tree-view control that is sized to fit the client area of the parent window. It also uses application-defined functions to associate an image list with the control and add items to the control. </P>

<P>// CreateATreeView - creates a tree-view control.  </P>

<P>// Returns the handle of the new control if successful or NULL<BR>
//     otherwise. </P>

<P>// hwndParent - handle of the control's parent window </P>

<P>// lpszFileName - name of the file to parse for tree-view items </P>

<P>HWND CreateATreeView(HWND hwndParent, LPSTR lpszFileName) </P>

<P>{ </P>

<P>RECT rcClient;  // dimensions of client area </P>

<P>HWND hwndTV;    // handle of tree-view control </P>

<P></P>

<P>// Ensure that the common control DLL is loaded. </P>

<P>InitCommonControls(); </P>

<P></P>

<P>// Get the dimensions of the parent window's client area, and create </P>

<P>// the tree-view control. </P>

<P>GetClientRect(hwndParent, &amp;rcClient); </P>

<P>hwndTV = CreateWindowEx(0, WC_TREEVIEW, "Tree View", </P>

<P>WS_VISIBLE | WS_CHILD | WS_BORDER | TVS_HASLINES, </P>

<P>0, 0, rcClient.right, rcClient.bottom, </P>

<P>hwndParent, (HMENU) ID_TREEVIEW, g_hinst, NULL); </P>

<P></P>

<P>// Initialize the image list, and add items to the control. </P>

<P>// InitTreeViewImageLists and InitTreeViewItems are application- </P>

<P>// defined functions. </P>

<P>if (!InitTreeViewImageLists(hwndTV) || </P>

<P>!InitTreeViewItems(hwndTV, lpszFileName)) { </P>

<P>DestroyWindow(hwndTV); </P>

<P>return FALSE; </P>

<P>} </P>

<P>return hwndTV; </P>

<P>} </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
