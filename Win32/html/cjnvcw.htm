<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetVolumeInformation</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="cjnvcw"></A><B>GetVolumeInformation  <A HREF="4j6f3p.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="qnj9so.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1f83g2.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetVolumeInformation</B> function returns information about a file system and volume whose root directory is specified. </P>

<P><B>BOOL GetVolumeInformation(</B></P>

<TABLE cols=2 width=614>

<TR VALIGN="top">
<TD width=49%><B>LPCTSTR</B> <I>lpRootPathName</I><B>,</B></TD>
<TD width=51%>// address of root directory of the file system </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    LPTSTR</B> <I>lpVolumeNameBuffer</I><B>,</B></TD>
<TD width=51%>// address of name of the volume </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    DWORD</B> <I>nVolumeNameSize</I><B>,</B></TD>
<TD width=51%>// length of <I>lpVolumeNameBuffer</I> </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    LPDWORD</B> <I>lpVolumeSerialNumber</I><B>,</B></TD>
<TD width=51%>// address of volume serial number </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    LPDWORD</B> <I>lpMaximumComponentLength</I><B>,</B></TD>
<TD width=51%>// address of system's maximum filename length</TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    LPDWORD</B> <I>lpFileSystemFlags</I><B>,</B></TD>
<TD width=51%>// address of file system flags </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    LPTSTR</B> <I>lpFileSystemNameBuffer</I><B>,</B></TD>
<TD width=51%>// address of name of file system </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    DWORD</B> <I>nFileSystemNameSize</I> </TD>
<TD width=51%>// length of <I>lpFileSystemNameBuffer</I> </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>   );</B></TD>
<TD width=51%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpRootPathName</I></P>

<P>Points to a string that contains the root directory of the volume to be described. If this parameter is NULL, the root of the current directory is used. If this parameter is a UNC name, you must follow it with an additional backslash. For example, you would specify \\MyServer\MyShare as \\MyServer\MyShare\.</P>

<P><I>lpVolumeNameBuffer</I></P>

<P>Points to a buffer that receives the name of the specified volume. </P>

<P><I>nVolumeNameSize</I></P>

<P>Specifies the length, in characters, of the volume name buffer. This parameter is ignored if the volume name buffer is not supplied. </P>

<P><I>lpVolumeSerialNumber</I></P>

<P>Points to a variable that receives the volume serial number. This parameter can be NULL if the serial number is not required. </P>

<P><I>lpMaximumComponentLength</I></P>

<P>Points to a doubleword value that receives the maximum length, in characters, of a filename component supported by the specified file system. A filename component is that portion of a filename between backslashes. </P>

<P>The value stored in variable pointed to by <B>*</B><I>lpMaximumComponentLength</I> is used to indicate that long names are supported by the specified file system. For example, for a FAT file system supporting long names, the function stores the value 255, rather than the previous 8.3 indicator. Long names can also be supported on systems that use the New Technology file system.</P>

<P><I>lpFileSystemFlags</I></P>

<P>Points to a doubleword that receives flags associated with the specified file system. This parameter can be any combination of the following flags, with one exception: FS_FILE_COMPRESSION and FS_VOL_IS_COMPRESSED are mutually exclusive. </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=50%><B>Value</B></TD>
<TD width=50%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>FS_CASE_IS_PRESERVED</TD>
<TD width=50%>If this flag is set, the file system preserves the case of filenames when it places a name on disk.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>FS_CASE_SENSITIVE</TD>
<TD width=50%>If this flag is set, the file system supports case-sensitive filenames.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>FS_UNICODE_STORED_ON_DISK</TD>
<TD width=50%>If this flag is set, the file system supports Unicode in filenames as they appear on disk.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>FS_PERSISTENT_ACLS</TD>
<TD width=50%>If this flag is set, the file system preserves and enforces ACLs. For example, NTFS preserves and enforces ACLs, and FAT does not. </TD>
</TR>

<TR VALIGN="top">
<TD width=50%>FS_FILE_COMPRESSION</TD>
<TD width=50%>The file system supports file-based compression.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>FS_VOL_IS_COMPRESSED</TD>
<TD width=50%>The specified volume is a compressed volume; for example, a DoubleSpace volume.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lpFileSystemNameBuffer</I></P>

<P>Points to a buffer that receives the name of the file system (such as FAT or NTFS). </P>

<P><I>nFileSystemNameSize</I></P>

<P>Specifies the length, in characters, of the file system name buffer. This parameter is ignored if the file system name buffer is not supplied. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If all the requested information is retrieved, the return value is nonzero.</P>

<P>If not all the requested information is retrieved, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>If you are attempting to obtain information about a floppy drive that does not have a floppy disk or a CD-ROM drive that does not have a compact disc, the system displays a message box asking the user to insert a floppy disk or a compact disc, respectively. To prevent the system from displaying this message box, call the <A HREF="6vrdc5.htm"><B>SetErrorMode</B></A> function with SEM_FAILCRITICALERRORS.</P>

<P>The FS_VOL_IS_COMPRESSED flag is the only indicator of volume-based compression. The file system name is not altered to indicate compression. This flag comes back set on a DoubleSpace volume, for example. With volume-based compression, an entire volume is either compressed or not compressed.</P>

<P>The FS_FILE_COMPRESSION flag indicates whether a file system supports file-based compression. With file-based compression, individual files can be compressed or not compressed.</P>

<P>The FS_FILE_COMPRESSION and FS_VOL_IS_COMPRESSED flags are mutually exclusive; both bits cannot come back set.</P>

<P>The maximum component length value, stored in the <B>DWORD</B> variable pointed to by <I>lpMaximumComponentLength</I>, is the only indicator that a volume supports longer-than-normal FAT (or other file system) file names. The file system name is not altered to indicate support for long file names.</P>

<P>The <A HREF="4onlz_a.htm"><B>GetCompressedFileSize</B></A> function obtains the compressed size of a file. The <A HREF="3pqdmo.htm"><B>GetFileAttributes</B></A> function can determine whether an individual file is compressed.</P>

<P><B>See Also</B></P>

<P><A HREF="4onlz_a.htm"><B>GetCompressedFileSize</B></A>, <A HREF="3pqdmo.htm"><B>GetFileAttributes</B></A>, <A HREF="6vrdc5.htm"><B>SetErrorMode</B></A>, <A HREF="1od.jqh.htm"><B>SetVolumeLabel</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
