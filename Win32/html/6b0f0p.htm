<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IRichEditOleCallback::QueryAcceptData Beta]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="6b0f0p"></A><B>IRichEditOleCallback::QueryAcceptData  <A HREF="27_26j.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A></B></P>

<P>Called on a paste or drag to determine if the data pasted/dragged should be accepted.</P>

<P><B>HRESULT QueryAcceptData(</B></P>

<TABLE cols=2 width=279>

<TR VALIGN="top">
<TD width=88%><B>LPDATAOBJECT </B><I>lpdataobj</I><B>,</B></TD>
<TD width=12%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=88%><B>    CLIPFORMAT FAR * </B><I>lpcfFormat</I><B>,</B></TD>
<TD width=12%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=88%><B>    DWORD </B><I>reco</I><B>,</B></TD>
<TD width=12%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=88%><B>    BOOL </B><I>fReally</I><B>,</B></TD>
<TD width=12%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=88%><B>    HGLOBAL </B><I>hMetaPict</I></TD>
<TD width=12%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=88%><B>   );</B></TD>
<TD width=12%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpdataobj</I></P>

<P>Pointer to the <B>DATAOBJECT</B> structure specifying the data object being pasted or dragged.</P>

<P><I>lpcfFormat</I></P>

<P>Pointer to the clipboard format that will be used for the paste or drop operation. If the value pointed to by <I>lpcfFormat</I> is zero, the best available format will be used. If the callback changes the value pointed to by <I>lpcfFormat</I>, the rich edit control only uses that format and the operation will fail if the format is not available.</P>

<P><I>reco</I></P>

<P>Clipboard operation flag. Can be one of these values.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=37%>RECO_DROP</TD>
<TD width=63%>Drop operation (drag and drop).</TD>
</TR>

<TR VALIGN="top">
<TD width=37%>RECO_PASTE</TD>
<TD width=63%>Paste from the clipboard.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>fReally</I></P>

<P>Nonzero if the paste or drop is actually happening, zero if this is just a query, such as for EM_CANPASTE.</P>

<P><I>hMetaPict</I></P>

<P>Handle to a metafile containing the icon view of an object if DVASPECT_ICON is being imposed on a object by Paste Special.</P>

<P></P>

<P><B>Return Values</B></P>

<P>Returns success status. If the SCODE of the result is a failure SCODE, the rich edit control refuses the data and terminates the operation. If the SCODE of the result is S_OK, the control checks the data itself for acceptable formats. A return of a successful SCODE other than S_OK means that the callback either checked the data itself (if <I>fReally</I> is FALSE) or imported the data itself (if <I>fReally</I> is TRUE).</P>

<P>If the application returns a successful result other than S_OK, a rich edit control will not check the read-only state of the edit control.</P>

<P><B>See Also</B></P>

<P><A HREF="ulbhv.htm"><B>IRichEditOleCallback</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
