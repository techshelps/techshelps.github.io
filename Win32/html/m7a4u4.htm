<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>ExpandEnvironmentStrings</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="m7a4u4"></A><B>ExpandEnvironmentStrings  <A HREF="11gvaku.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="2asgu6i.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="bogapi.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>ExpandEnvironmentStrings</B> function expands environment-variable strings and replaces them with their defined values. </P>

<P><B>DWORD ExpandEnvironmentStrings(</B></P>

<TABLE cols=2 width=509>

<TR VALIGN="top">
<TD width=29%><B>LPCTSTR</B> <I>lpSrc</I><B>,</B></TD>
<TD width=71%>// pointer to string with environment variables </TD>
</TR>

<TR VALIGN="top">
<TD width=29%><B>    LPTSTR</B> <I>lpDst</I><B>,</B></TD>
<TD width=71%>// pointer to string with expanded environment variables  </TD>
</TR>

<TR VALIGN="top">
<TD width=29%><B>    DWORD</B> <I>nSize</I> </TD>
<TD width=71%>// maximum characters in expanded string </TD>
</TR>

<TR VALIGN="top">
<TD width=29%><B>   );</B></TD>
<TD width=71%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpSrc</I></P>

<P>Points to a null-terminated string that might contain references to environment-variable strings of the form:</P>

<P>%variableName%  </P>

<P></P>

<P>For each such reference, the <B>%</B><I>variableName</I><B>%</B> portion is replaced with the current value of that environment variable. </P>

<P>The replacement rules are the same as those used by the command interpreter. Case is ignored when looking up the environment-variable name. If the name is not found, the <B>%</B><I>variableName</I><B>%</B> portion is left undisturbed. </P>

<P><I>lpDst</I></P>

<P>Points to a buffer to receive a copy of the source buffer, after all environment-variable name substitutions have been performed. </P>

<P><I>nSize</I></P>

<P>Specifies the maximum number of characters that can be stored in the buffer pointed to by the <I>lpDst</I> parameter, including the terminating null character. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is the number of characters stored in the destination buffer. If the number of characters is greater than the size of the destination buffer, the return value is the size of the buffer required to hold the expanded strings. </P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
