<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Processing the WM_DRAWITEM Message</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="_s7ttz"></A><B>Processing the WM_DRAWITEM Message</B></P>

<P>An owner-drawn combo box sends the <A HREF="70lqx9p.htm">WM_DRAWITEM</A> message to its parent window or dialog box procedure each time the application must repaint a list item. The <I>lParam</I> parameter points to a <A HREF="1sswtgp.htm"><B>DRAWITEMSTRUCT</B></A> structure that identifies the control and list item. It also contains information needed to paint the item. </P>

<P>The example in <A HREF="5po2_hz.htm">Creating a Square Meal Dialog Box</A> displays the list-item text and the bitmap associated with the food group. If the item has the focus, it also draws a focus rectangle. Before displaying the text, the example sets the foreground and background colors, based on the item selected. Because the combo box has the CBS_HASSTRINGS style, the combo box maintains the text for each list item that can be retrieved using the <A HREF="ibsg8m.htm">CB_GETLBTEXT</A> message. </P>

<P>The bitmaps used for the list item depend on the food group. InitGroupList uses the <A HREF="23ic_r.htm">CB_SETITEMDATA</A> message to associate a constant with each list item, identifying the corresponding food group. The window procedure uses this value, contained in the <B>itemData</B> member of the <A HREF="1sswtgp.htm"><B>DRAWITEMSTRUCT</B></A> structure, to determine which bitmaps to display. The system uses two bitmaps for each food group symbol: a monochrome bitmap with the SRCAND raster operation to erase the irregular region behind the image, and a color bitmap with the SRCPAINT raster operation to paint the image. </P>

</BODY>
</HTML>
