<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Using Single-Line Edit Controls</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="hq_ri."></A><B>Using Single-Line Edit Controls</B></P>

<P>The example in this section demonstrates how to use a window procedure to produce a dialog box that prompts the user to enter a password.</P>

<P>The single-line edit control in the Password dialog box has the ES_PASSWORD style. By default, edit controls with this style display an asterisk for each character the user types. This example, however, uses the <A HREF="33ngk7.htm">EM_SETPASSWORDCHAR</A> message to change the default character from an asterisk to a plus sign (+). </P>

<P>This window procedure changes the default push button from Cancel to OK as soon as the user enters text in the edit control. If the user presses the OK button, the window procedure uses the <A HREF="2n03eae.htm">EM_LINELENGTH</A> and <A HREF="1mm5rs_.htm">EM_GETLINE</A> messages to retrieve the text. </P>

<P>LRESULT CALLBACK PassProc(hDlg, message, wParam, lParam)  </P>

<P>HWND hDlg;                /* window handle of the dialog box */ </P>

<P>UINT message;             /* type of message                 */ </P>

<P>UINT wParam;              /* message-specific information    */ </P>

<P>LONG lParam; </P>

<P>{ </P>

<P>CHAR lpszPassword[16]; </P>

<P>WORD cchPassword; </P>

<P></P>

<P>switch (message) { </P>

<P>case WM_INITDIALOG: </P>

<P></P>

<P>/* Set password character to a plus sign (+) */ </P>

<P></P>

<P>SendDlgItemMessage(hDlg, </P>

<P>IDE_PASSWORDEDIT, </P>

<P>EM_SETPASSWORDCHAR, </P>

<P>(WPARAM) '+', </P>

<P>(LPARAM) 0); </P>

<P></P>

<P>/* Set the default push button to "Cancel." */ </P>

<P></P>

<P>SendMessage(hDlg, </P>

<P>DM_SETDEFID, </P>

<P>(WPARAM) IDCANCEL, </P>

<P>(LPARAM) 0); </P>

<P></P>

<P>return TRUE; </P>

<P></P>

<P>case WM_COMMAND: </P>

<P></P>

<P>/* </P>

<P>* Set the default push button to "OK" when the user </P>

<P>* enters text. </P>

<P>*/ </P>

<P></P>

<P>if(HIWORD (wParam) == EN_CHANGE &amp;&amp; </P>

<P>LOWORD(wParam) == IDE_PASSWORDEDIT) </P>

<P>SendMessage(hDlg, </P>

<P>DM_SETDEFID, </P>

<P>(WPARAM) IDOK, </P>

<P>(LPARAM) 0); </P>

<P></P>

<P>switch(wParam) { </P>

<P>case IDOK: </P>

<P></P>

<P>/* Get number of characters. */ </P>

<P></P>

<P>cchPassword = (WORD) SendDlgItemMessage(hDlg, </P>

<P>IDE_PASSWORDEDIT, </P>

<P>EM_LINELENGTH, </P>

<P>(WPARAM) 0, </P>

<P>(LPARAM) 0); </P>

<P></P>

<P>if (cchPassword &gt;= 16) { </P>

<P>MessageBox(hDlg, </P>

<P>"Too many characters.", </P>

<P>"Error", </P>

<P>MB_OK); </P>

<P>EndDialog(hDlg, TRUE); </P>

<P>return FALSE; </P>

<P>} </P>

<P>else if (cchPassword == 0) { </P>

<P>MessageBox(hDlg, </P>

<P>"No characters entered.", </P>

<P>"Error", </P>

<P>MB_OK); </P>

<P>EndDialog(hDlg, TRUE); </P>

<P>return FALSE; </P>

<P>} </P>

<P></P>

<P>/* </P>

<P>* Put the number of characters into first word </P>

<P>* of buffer. </P>

<P>*/ </P>

<P></P>

<P>*((LPWORD)lpszPassword) = cchPassword; </P>

<P></P>

<P>/* Get the characters. */ </P>

<P></P>

<P>SendDlgItemMessage(hDlg, </P>

<P>IDE_PASSWORDEDIT, </P>

<P>EM_GETLINE, </P>

<P>(WPARAM) 0,       /* line 0 */ </P>

<P>(LPARAM) lpszPassword); </P>

<P></P>

<P>/* Null-terminate the string. */ </P>

<P></P>

<P>lpszPassword[cchPassword] = 0; </P>

<P></P>

<P>MessageBox(hDlg, </P>

<P>lpszPassword, </P>

<P>"Did it work?", </P>

<P>MB_OK); </P>

<P></P>

<P>/* Call a local password-parsing function. */ </P>

<P></P>

<P>ParsePassword(lpszPassword); </P>

<P></P>

<P>EndDialog(hDlg, TRUE); </P>

<P>return TRUE; </P>

<P></P>

<P>case IDCANCEL: </P>

<P>EndDialog(hDlg, TRUE); </P>

<P>return TRUE; </P>

<P>} </P>

<P>return 0; </P>

<P>} </P>

<P>return FALSE; </P>

<P>UNREFERENCED_PARAMETER(lParam); </P>

<P>} </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
