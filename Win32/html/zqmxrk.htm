<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Deleting a Service</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="zqmxrk"></A><B>Deleting a Service</B></P>

<P>In the following example, a service configuration program uses the <A HREF="20gsky6.htm"><B>OpenService</B></A> function to get a handle with DELETE access to an installed service object. The program then uses the service object handle in the <A HREF=".zao5x.htm"><B>DeleteService</B></A> function to remove the service from the SCM database. </P>

<P>VOID DeleteSampleService()  </P>

<P>{ </P>

<P>schService = OpenService( </P>

<P>schSCManager,       // SCManager database </P>

<P>TEXT("Sample_Srv"), // name of service </P>

<P>DELETE);            // only need DELETE access </P>

<P></P>

<P>if (schService == NULL) </P>

<P>MyErrorExit("OpenService"); </P>

<P></P>

<P>if (! DeleteService(schService) ) </P>

<P>MyErrorExit("DeleteService"); </P>

<P>else </P>

<P>printf("DeleteService SUCCESS\n"); </P>

<P></P>

<P>CloseServiceHandle(schService); </P>

<P>} </P>

<P></P>

</BODY>
</HTML>
