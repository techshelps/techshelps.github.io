<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SHGetDataFromIDList [Now Supported on Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="f.uy0s"></A><B>SHGetDataFromIDList  <A HREF="l5xba_.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="b2.3c..htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="2ac30z9.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>[Now Supported on Windows NT]</P>

<P>The <B>ShGetDataFromIDList</B> function retrieves extended property data from a relative IDList. </P>

<P><B>HRESULT ShGetDataFromIDList(</B></P>

<TABLE cols=2 width=497>

<TR VALIGN="top">
<TD width=46%><B>LPSHELLFOLDER</B> <I>psf</I><B>,</B></TD>
<TD width=54%>//Points to the parent folder</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    LPCITEMIDLIST </B><I>pidl</I><B>,</B></TD>
<TD width=54%>//Points to an item identifier struct</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    int</B> <I>nFormat</I><B>,</B></TD>
<TD width=54%>//Specifies a format</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    PVOID</B> <I>pv</I><B>,</B></TD>
<TD width=54%>//Points to a buffer for a structure</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    int</B> <I>cb</I> </TD>
<TD width=54%>//Size of the buffer passed in</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>   );</B></TD>
<TD width=54%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>psf</I></P>

<P>Pointer to the parent folder.</P>

<P><I>pidl</I></P>

<P>Pointer to an <A HREF="16gub2n.htm"><B>ITEMIDLIST</B></A> structure that identifies the subfolder relative to its parent folder.</P>

<P><I>nFormat</I></P>

<P>Specifies one of the following formats:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=46%>SHGDFIL_FINDDATA</TD>
<TD width=54%>Format used for file system objects.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%>SHGDFIL_NETRESOURCE</TD>
<TD width=54%>Format used for network resources.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>pv</I></P>

<P>Pointer to a buffer for either a WIN32_FIND_DATA or NET_RESOURCE structure, depending on the value of the <I>nFormat</I> parameter. For more information, see the Remarks section below.</P>

<P><I>cb</I></P>

<P>Size of the buffer passed in. This value should be either sizeof(WIN32_FIND_DATA) for SHGDFIL_FINDDATA or, sizeof(NETRESOURCE) + 1024 to retrieve a SHGDFIL_NETRESOURCE structure.</P>

<P></P>

<P><B>Return Values</B></P>

<P>The return value is NOERROR if the format is supported and the function succeeds. If the <I>psf</I>, <I>pidl</I>, <I>pv</I>, or <I>cb</I> parameters do not match the <I>nFormat</I> parameter, or if <I>nFormat</I> is not one of the specific SHGDFIL_ values shown, E_INVALIDARG is also returned.</P>

<P><B>Remarks</B></P>

<P>If <I>nFormat </I>is SHGDFIL_NETRESURCE, there are two possible cases. If the buffer is large enough, the net resource's string information (fields for the network name, local name, provider, and comments) will be placed into the buffer. If the buffer is not large enough, only the net resource structure will be placed into the buffer and the string information pointers will be NULL. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
