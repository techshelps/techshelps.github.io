<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Appbar Size and Position</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="12pw5ek"></A><B>Appbar Size and Position</B></P>

<P>An application should set an appbar's size and position so that it does not interfere with any other appbars or the taskbar. Every appbar must be anchored to a particular edge of the screen, and multiple appbars can be anchored to an edge. However, if an appbar is anchored to the same edge as the taskbar, the system ensures that the taskbar is always on the outermost edge. </P>

<P>To set the size and position of an appbar, an application first proposes a screen edge and bounding rectangle for the appbar by sending the <A HREF="6lumu7.htm">ABM_QUERYPOS</A> message. The system determines whether any part of the screen area within the proposed rectangle is occupied by the taskbar or another appbar, adjusts the rectangle (if necessary), and returns the adjusted rectangle to the application. </P>

<P>Next, the application sends the <A HREF="1z2wysn.htm">ABM_SETPOS</A> message to set the new bounding rectangle for the appbar. Again, the system may adjust the rectangle before returning it to the application. For this reason, the application should use the adjusted rectangle returned by ABM_SETPOS to set the final size and position. The application can use the <A HREF="fn4vpf.htm"><B>MoveWindow</B></A> function to move the appbar into position. </P>

<P>By using a two-step process to set the size and position, the system allows the application to provide intermediate feedback to the user during the move operation. For example, if the user drags an appbar, the application might display a shaded rectangle indicating the new position before the appbar actually moves. </P>

<P>An application should set the size and position of its appbar after registering it and whenever the appbar receives the <A HREF="j.l.9j.htm">ABN_POSCHANGED</A> notification message. An appbar receives this notification message whenever a change occurs in the taskbar's size, position, or visibility state and whenever another appbar on the same side of the screen is resized, added, or removed. </P>

<P>Whenever an appbar receives the <A HREF="2yi0_zt.htm">WM_ACTIVATE</A> message, it should send the <A HREF="ble_nc.htm">ABM_ACTIVATE</A> message. Similarly, when an appbar receives a <A HREF="4d1zvu.htm">WM_WINDOWPOSCHANGED</A> message, it must call <A HREF="1c2hwx9.htm">ABM_WINDOWPOSCHANGED</A>. Sending these messages ensures that the system properly sets the Z order of any autohide appbars on the same edge.</P>

</BODY>
</HTML>
