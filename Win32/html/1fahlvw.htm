<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WM_DDE_EXECUTE</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1fahlvw"></A><B>WM_DDE_EXECUTE  <A HREF="75yq8g.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="w3rlry.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="00i2ql.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>A DDE client application posts a WM_DDE_EXECUTE message to a DDE server application to send a string to the server to be processed as a series of commands. The server application is expected to post a <A HREF="9k0..a.htm">WM_DDE_ACK</A> message in response. </P>

<P>WM_DDE_EXECUTE  </P>

<P>wParam = (WPARAM) hwnd;        // handle of posting application </P>

<P>lParam = (LPARAM) hCommands;   // handle to global object </P>

<P></P>

<P><B>Parameters</B></P>

<P><I>hwnd</I></P>

<P>Value of <I>wParam</I>. Identifies the client window posting the message. </P>

<P><I>hCommands</I></P>

<P>Value of <I>lParam</I>. Contains a global memory object that references an ANSI or Unicode command string, depending on the types of windows involved in the conversation. </P>

<P></P>

<P><B>Remarks</B></P>

<P>The command string is a null-terminated string consisting of one or more <I>opcode</I> strings enclosed in single brackets ([ ]). </P>

<P>Each <I>opcode</I> string has the following syntax, where the <I>parameters</I> list is optional: </P>

<P><I>opcode parameters</I> </P>

<P>The <I>opcode</I> is any application-defined single token. It cannot include spaces, commas, parentheses, brackets, or quotation marks. </P>

<P>The <I>parameters</I> list can contain any application-defined value or values. Multiple parameters are separated by commas, and the entire parameter list is enclosed in parentheses. Parameters cannot include commas or parentheses except inside a quoted string. If a bracket or parenthesis character is to appear in a quoted string, it need not be doubled, as was the case under the old rules. </P>

<P>Following are some valid command strings: </P>

<P>[connect][download(query1,results.txt)][disconnect]  </P>

<P>[query("sales per employee for each district")] </P>

<P>[open("sample.xlm")][run("r1c1")] </P>

<P>[quote_case("This is a "" character")] </P>

<P>[bracket_or_paren_case("()s or []s should be no problem.")] </P>

<P></P>

<P>Note that, under the old rules, parentheses and brackets had to be doubled, as follows: </P>

<P>[bracket_or_paren_case("(())s or [[]]s should be no problem.")]  </P>

<P></P>

<P>Servers should be able to parse commands in either form. </P>

<P>Unicode execute strings should be used only when both the client and server window handles cause the <A HREF="no.k4p.htm"><B>IsWindowUnicode</B></A> function to return TRUE. </P>

<P><B>Posting</B> </P>

<P>The client application posts the WM_DDE_EXECUTE message by calling the <A HREF="fixdt_.htm"><B>PostMessage</B></A> function, not the <A HREF="1724msn.htm"><B>SendMessage</B></A> function. </P>

<P>The client application allocates <I>hCommands</I> by calling the <A HREF="f12w9..htm"><B>GlobalAlloc</B></A> function with the GMEM_DDESHARE option. </P>

<P>When processing the <A HREF="9k0..a.htm">WM_DDE_ACK</A> message that the server posts in reply to a WM_DDE_EXECUTE message, the client application must delete the <I>hCommands</I> object sent back in the WM_DDE_ACK message. </P>

<P><B>Receiving</B> </P>

<P>The server application posts the WM_DDE_ACK message to respond positively or negatively. The server should reuse the <I>hCommands</I> object. </P>

<P>Unless specified otherwise by a sub-protocol, the server should not post the WM_DDE_ACK message until all the actions specified by the execute command string are completed. The one exception to this rule is when the string causes the server to terminate the conversation. </P>

<P><B>See Also</B></P>

<P><A HREF="f12w9..htm"><B>GlobalAlloc</B></A>, <A HREF="no.k4p.htm"><B>IsWindowUnicode</B></A>, <A HREF="1_gbv6y.htm"><B>PackDDElParam</B></A>, <A HREF="fixdt_.htm"><B>PostMessage</B></A>, <A HREF="14dc0a.htm"><B>ReuseDDElParam</B></A>, <A HREF="1724msn.htm"><B>SendMessage</B></A>, <A HREF="51wgiv.htm"><B>UnpackDDElParam</B></A>, <A HREF="9k0..a.htm">WM_DDE_ACK</A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
