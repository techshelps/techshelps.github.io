<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Subclassed Combo Boxes</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="4ak16.p"></A><B>Subclassed Combo Boxes</B></P>

<P><I>Subclassing</I> is a procedure that allows an application to intercept and process messages sent or posted to a window. By using subclassing, an application can substitute its own processing for certain messages, while leaving most message processing to the class-defined window procedure. </P>

<P>When the operating system creates a window, it saves information about it in an internal data structure that includes the address of the window procedure. To subclass a window, an application calls the <A HREF="61hh_k6.htm"><B>SetClassLong</B></A> function to replace the address of that procedure with the instance address of an application-defined subclass procedure. Thereafter, all messages to the window are sent to the subclass procedure. This procedure then uses the <A HREF="ncd2vj.htm"><B>CallWindowProc</B></A> function to pass unprocessed messages to the original window procedure. For a description of the message processing performed by the COMBOBOX class window procedure, see <A HREF="odqd.0.htm">Default Combo Box Behavior</A>. </P>

<P>When the combo box is outside a dialog box, an application cannot process the TAB, ENTER, and ESCAPE keys unless it uses a subclass procedure. When a simple or drop-down combo box receives the input focus, it immediately sets the focus to its child edit control. Therefore, an application must subclass the edit control to intercept keyboard input for a simple or drop-down combo box. For an example of this, see <A HREF="12uxwwr.htm">Subclassing a Combo Box</A>. </P>

<P>If a subclass procedure processes the <A HREF="f55xz2.htm">WM_PAINT</A> message, it must use the <A HREF="f7ytuy.htm"><B>BeginPaint</B></A> function to prepare for painting. Before calling the <A HREF="8d6uz5.htm"><B>EndPaint</B></A> function, it passes the device-context (DC) handle as the <I>wParam</I> parameter for the window procedure. If <B>EndPaint</B> is called first, the class window procedure does no painting because <B>EndPaint</B> validates the entire window. </P>

<P>A technique related to subclassing is <I>superclassing</I>. A superclass resembles any other class except that its window procedure does not call <A HREF="32d1nbh.htm"><B>DefWindowProc</B></A> to handle unprocessed messages. Instead, it passes unprocessed messages to the window procedure for the parent window class. Follow the guidelines in <A HREF="1k62v6p.htm">Window Procedures</A> to avoid problems that can occur with subclassing and superclassing. </P>

</BODY>
</HTML>
