<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CPL_INQUIRE</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1oj4cxw"></A><B>CPL_INQUIRE  <A HREF="8wd1jh.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="111rqy..htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="z22aw8.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The CPL_INQUIRE message is sent to the <A HREF="1p4ans3.htm"><B>CPlApplet</B></A> function of a Control Panel application to request information about a dialog box that the application supports. </P>

<P>CPL_INQUIRE  </P>

<P>uAppNum = (UINT) lParam1;     // application number </P>

<P>lpcpli = (LPCPLINFO) lParam2; // structure for application info. </P>

<P></P>

<P><B>Parameters</B></P>

<P><I>uAppNum</I></P>

<P>Value of <I>lParam1</I>. Specifies the dialog box number. This number must be in the range zero through one less than the value returned in response to the <A HREF="1aifmfp.htm">CPL_GETCOUNT</A> message (CPL_GETCOUNT - 1). </P>

<P><I>lpcpli</I></P>

<P>Value of <I>lParam2</I>. Points to a <A HREF="2j5u13.htm"><B>CPLINFO</B></A> structure. The application must fill this structure with resource identifiers for the icon, short name, description, and any user-defined value associated with the dialog box. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the <B>CPlApplet</B> function processes this message successfully, it should return zero. </P>

<P><B>Remarks</B></P>

<P>The Control Panel sends the CPL_INQUIRE message once for each dialog box supported by your application. The Control Panel also sends a <A HREF="6b6pi7.htm">CPL_NEWINQUIRE</A> message for each dialog box. These messages are sent immediately after the <A HREF="1aifmfp.htm">CPL_GETCOUNT</A> message. However, the system does not guarantee the order in which the CPL_INQUIRE and CPL_NEWINQUIRE messages are sent.</P>

<P>You can perform initialization for the dialog box when you receive CPL_INQUIRE. If you must allocate memory, do so in response to the CPL_INIT message. </P>

<P>On Windows 95 and Windows NT version 4.0, the system caches the information returned in the <A HREF="2j5u13.htm"><B>CPLINFO</B></A> structure used by CPL_INQUIRE. This provides significantly better performance because the system only needs to load your application the first time the Control Panel starts up. On the other hand, the CPL_NEWINQUIRE message returns information in a form that the system cannot cache. For this reason, most <B>CPlApplet</B> functions should process CPL_INQUIRE and ignore CPL_NEWINQUIRE.</P>

<P>The only applications that should use CPL_NEWINQUIRE are those that need to change their icon or display strings based on the state of the computer. In this case, your CPL_INQUIRE handler should specify the CPL_DYNAMIC_RES value for the <B>idIcon</B>, <B>idName</B>, or <B>idInfo</B> members of the <B>CPLINFO</B> structure, rather than specifying a valid resource identifier. This causes the Control Panel to send the CPL_NEWINQUIRE message each time it needs the icon and display strings, allowing you to specify information based on the current state of the computer. Of course, this is significantly slower than using cached information.</P>

<P><B>See Also</B></P>

<P><A HREF="1aifmfp.htm">CPL_GETCOUNT</A>, <A HREF="4n3ijfe.htm">CPL_INIT</A>, <A HREF="6b6pi7.htm">CPL_NEWINQUIRE</A>, <A HREF="1p4ans3.htm"><B>CPlApplet</B></A>, <A HREF="2j5u13.htm"><B>CPLINFO</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
