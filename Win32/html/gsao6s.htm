<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CreateDIBSection</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="gsao6s"></A><B>CreateDIBSection  <A HREF="hwcdby.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="15l9v8p.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1z.4d3.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>CreateDIBSection</B> function creates a device-independent bitmap (DIB) that applications can write to directly. The function gives you a pointer to the location of the bitmap's bit values. You can supply a handle to a file mapping object that the function will use to create the bitmap, or you can let the operating system allocate the memory for the bitmap.</P>

<P></P>

<P><B>HBITMAP CreateDIBSection(</B></P>

<TABLE cols=2 width=647>

<TR VALIGN="top">
<TD width=34%><B>HDC</B> <I>hdc</I><B>,</B></TD>
<TD width=66%>// handle to device context</TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>    CONST</B> <B>BITMAPINFO *</B><I>pbmi</I><B>,</B></TD>
<TD width=66%>// pointer to structure containing bitmap size, format, and color data</TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>    UINT</B> <I>iUsage</I><B>,</B></TD>
<TD width=66%>// color data type indicator: RGB values or palette indices</TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>    VOID</B> <B>*</B><I>ppvBits</I><B>,</B></TD>
<TD width=66%>// pointer to variable to receive a pointer to the bitmap's bit values</TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>    HANDLE</B> <I>hSection</I><B>,</B></TD>
<TD width=66%>// optional handle to a file mapping object</TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>    DWORD</B> <I>dwOffset</I></TD>
<TD width=66%>// offset to the bitmap bit values within the file mapping object</TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>   );</B></TD>
<TD width=66%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hdc</I></P>

<P>Handle to a device context. If the value of <I>iUsage</I> is DIB_PAL_COLORS, the function uses this device context's logical palette to initialize the device-independent bitmap's colors.</P>

<P><I>pbmi</I></P>

<P>Points to a <A HREF=".2pxnh.htm"><B>BITMAPINFO</B></A> structure that specifies various attributes of the device-independent bitmap, including the bitmap's dimensions and colors. </P>

<P><I>iUsage</I></P>

<P>Specifies the type of data contained in the <B>bmiColors</B> array member of the <B>BITMAPINFO</B> structure pointed to by <I>pbmi</I>: logical palette indices or literal RGB values. The following values are defined:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=48%><B>Value</B></TD>
<TD width=52%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=48%>DIB_PAL_COLORS</TD>
<TD width=52%>The <B>bmiColors</B> member is an array of 16-bit indices into the logical palette of the device context specified by <I>hdc</I>.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>DIB_RGB_COLORS</TD>
<TD width=52%>The <B>BITMAPINFO</B> structure contains an array of literal RGB values.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>ppvBits</I></P>

<P>Points to a variable that receives a pointer to the location of the device-independent bitmap's bit values.</P>

<P><I>hSection</I></P>

<P>Handle to a file mapping object that the function will use to create the device-independent bitmap. This parameter can be NULL.</P>

<P>If <I>hSection</I> is not NULL, it must be a handle to a file mapping object created by calling the <A HREF="3lck_3.htm"><B>CreateFileMapping</B></A> function. Handles created by other means will cause <B>CreateDIBSection</B> to fail. </P>

<P>If <I>hSection</I> is not NULL, the <B>CreateDIBSection</B> function locates the bitmap's bit values at offset <I>dwOffset</I> in the file mapping object referred to by <I>hSection</I>. An application can later retrieve the <I>hSection </I>handle by calling the <A HREF="3v6uf0.htm"><B>GetObject</B></A> function with the <A HREF="14lg1og.htm"><B>HBITMAP</B></A> returned by <B>CreateDIBSection</B>.</P>

<P>If <I>hSection</I> is NULL, the operating system allocates memory for the device-independent bitmap. In this case, the <B>CreateDIBSection </B>function ignores the <I>dwOffset</I> parameter. An application cannot later obtain a handle to this memory: the <B>dshSection</B> member of the <A HREF="1mh7ktg.htm"><B>DIBSECTION</B></A> structure filled in by calling the <B>GetObject</B> function will be NULL.</P>

<P><I>dwOffset</I></P>

<P>Specifies the offset from the beginning of the file mapping object referenced by <I>hSection</I> where storage for the bitmap's bit values is to begin. This value is ignored if <I>hSection</I> is NULL. The bitmap's bit values are aligned on doubleword boundaries, so <I>dwOffset</I> must be a multiple of the size of a <B>DWORD</B>.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is a handle to the newly created device-independent bitmap, and *<I>ppvBits</I> points to the bitmap's bit values. </P>

<P>If the function fails, the return value is NULL, and *<I>ppvBits</I> is NULL. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>.</P>

<P><B>Remarks</B></P>

<P>As noted above, if <I>hSection</I> is NULL, the operating system allocates memory for the device-independent bitmap. The operating system closes the handle to that memory when you later delete the device-independent bitmap by calling the <B>DeleteObject</B> function. If <I>hSection</I> is not NULL, you must close the <I>hSection</I> memory handle yourself after calling <B>DeleteObject </B>to delete the bitmap.  </P>

<P><B>Windows NT:</B> You need to guarantee that the <B>GDI</B> subsystem has completed any drawing to a bitmap created by <B>CreateDIBSection </B>before you draw to the bitmap yourself. Access to the bitmap must be synchronized. Do this by calling the <B>GdiFlush</B> function. This applies to any use of the pointer to the bitmap's bit values, including passing the pointer in calls to functions such as <B>SetDIBits</B>. </P>

<P><B>See Also</B></P>

<P><A HREF=".2pxnh.htm"><B>BITMAPINFO</B></A>, <A HREF="3lck_3.htm"><B>CreateFileMapping</B></A>, <A HREF="y31ava.htm"><B>DeleteObject</B></A>, <A HREF="1mh7ktg.htm"><B>DIBSECTION</B></A>, <A HREF="pej1.e.htm"><B>GetDIBColorTable</B></A>, <A HREF="3v6uf0.htm"><B>GetObject</B></A>, <A HREF="20o1_t..htm"><B>GdiFlush</B></A>, <A HREF="14lg1og.htm"><B>HBITMAP</B></A>, <A HREF="6_ok76.htm"><B>SetDIBits</B></A>, <A HREF="15j8mtv.htm"><B>SetDIBColorTable</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
