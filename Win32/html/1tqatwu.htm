<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>IReconcilableObject::Reconcile [Now Supported on Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1tqatwu"></A><B>IReconcilableObject::Reconcile  <A HREF="3mr09q5.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A></B></P>

<P>[Now Supported on Windows NT]</P>

<P>Reconciles the state of an object with one or more other objects. The reconciliation updates the internal state of the object by merging the states of all objects to form a combined state.</P>

<P><B>HRESULT IReconcilableObject::Reconcile(</B></P>

<TABLE cols=2 width=277>

<TR VALIGN="top">
<TD width=87%><B>IreconcileInitiator</B> <I>*pInitiator</I><B>,</B></TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=87%><B>    DWORD</B> <I>dwFlags</I><B>,</B></TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=87%><B>    HWND</B> <I>hwndOwner</I><B>,</B></TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=87%><B>    HWND</B> <I>hwndProgressFeedback</I><B>,</B></TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=87%><B>    ULONG</B> <I>ulcInput</I><B>,</B></TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=87%><B>    IMoniker</B> <I>**rgpmkOtherInput</I><B>,</B></TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=87%><B>    LONG</B> <I>*plOutIndex</I><B>,</B></TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=87%><B>    IStorage</B> <I>*pstgNewResidues</I><B>,</B></TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=87%><B>    void</B> <I>*pvReserved</I></TD>
<TD width=13%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=87%><B>   );</B></TD>
<TD width=13%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>pInitiator</I></P>

<P>Address of the <A HREF="1prkwhd.htm"><B>IReconcileInitiator</B></A> interface for the initiator of the reconciliation process. This parameter must not be NULL.</P>

<P><I>dwFlags</I></P>

<P>Control flags for the reconciliation. This parameter may be zero or a combination of these values:</P>

<TABLE cols=3>

<TR VALIGN="top">
<TD colspan=3 width=100%>RECONCILEF_FEEDBACKWINDOWVALID</TD>
<TD colspan=20 width=1798528615%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%><I>hwndProgressFeedback</I> is valid.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>RECONCILEF_MAYBOTHERUSER</TD>
<TD colspan=20 width=1798528615%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>The briefcase reconciler can prompt for user interaction if it is needed. Without this value, user interaction is not permitted. <I>hwndOwner</I> is valid.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>RECONCILEF_NORESIDUESOK</TD>
<TD colspan=20 width=1798528615%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>The briefcase reconciler can ignore requests for residues and carry out reconciliation. Reconcilers that do not support residues should check for this value whenever an initiator requests residues. Without this value, a reconciler that does not support residues must immediately return REC_E_NORESIDUES.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>RECONCILEF_OMITSELFRESIDUE</TD>
<TD colspan=20 width=1798528615%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>The briefcase reconciler can discard any residue associated with this object. Initiators typically use this value for reconciliations that loop from generation to generation.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>RECONCILEF_ONLYYOUWERECHANGED</TD>
<TD colspan=20 width=1798528615%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>The <B>Reconcile</B> member function is being called to propagate changes in the changed object to other unchanged objects. This value will only be set if the <B>HKEY_CLASSES_ROOT</B>\<B>CLSID</B>\<I>clsid_of_reconciler</I>\<B>SingleChangeHook</B> key exists in the registry. If that key is not present in the registry, the initiator carries out reconciliation by making the other unchanged objects binary identical copies of the changed object. The <I>rgpmkOtherInput</I> monikers identify the other objects. This value will only be set in <I>dwFlags</I> if RECONCILEF_YOUMAYDOTHEUPDATES is also set. If the briefcase reconciler completes the updates itself successfully, REC_S_IDIDTHEUPDATES should be returned and the variable pointed to by <I>plOutIndex</I> should be set to  - 1L. Note that S_OK should not be returned on success if this value is set in <I>dwFlags</I>. The initiator will not save the source object's storage if <B>Reconcile</B> returns REC_S_IDIDTHEUPDATES. If the reconciler wishes to fall back to the initiator's bit copy implementation, it may return S_FALSE.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>RECONCILEF_RESUMEDRECONCILIATION</TD>
<TD colspan=20 width=1798528615%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>The briefcase reconciler should resume reconciliation, using the partial residues provided. Without this value, the reconciler should ignore any "considered but rejected" information in any of the input versions.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>RECONCILEF_YOUMAYDOTHEUPDATES</TD>
<TD colspan=20 width=1798528615%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>The briefcase reconciler may do the updates itself. Without this value, the reconciler may not do the updates itself. If reconciliation is completed successfully, the reconciler should return REC_S_IDIDTHEUPDATES if it did the updates itself or S_OK if it did not do the updates itself.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>hwndOwner</I></P>

<P>Handle of the parent window to use for child windows that the briefcase reconciler creates. This parameter is valid only if RECONCILEF_MAYBOTHERUSER is specified in <I>dwFlags</I>.</P>

<P><I>hwndProgressFeedback</I></P>

<P>Handle of the progress feedback window displayed by the initiator. This parameter is valid only if RECONCILEF_FEEDBACKWINDOWVALID is specified in <I>dwFlags</I>. The briefcase reconciler may call the <A HREF="d2wat4.htm"><B>SetWindowText</B></A> function using this window handle to display additional reconciliation status information to the user.</P>

<P><I>ulcInput</I></P>

<P>Number of versions or partial residues specified in <I>dwFlags</I>. This parameter must not be zero.</P>

<P><I>rgpmkOtherInput</I></P>

<P>Address of an array that contains the addresses of the monikers to use to access the versions or partial residues to be reconciled.</P>

<P><I>plOutIndex</I></P>

<P>Address of the variable that receives an index value indicating whether the result of the reconciliation is identical to one of the initial versions. The variable is set to  - 1L if the reconciliation result is a combination of two or more versions. Otherwise, it is a zero-based index, with 0 indicating this object, 1 indicating the first version, 2 indicating the second version, and so on.</P>

<P><I>pstgNewResidues</I></P>

<P>Address of the <B>IStorage</B> interface used to store newly created residues. This parameter may be NULL to indicate that residues should not be saved.</P>

<P><I>pvReserved</I></P>

<P>Reserved; must be NULL.</P>

<P></P>

<P><B>Return Values</B></P>

<P>Returns one of the following success values if successful:</P>

<TABLE cols=3>

<TR VALIGN="top">
<TD colspan=3 width=100%>S_OK</TD>
<TD colspan=20 width=1798526119%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>Reconciliation was completed successfully, and the changes must be propagated to the other objects.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>S_FALSE</TD>
<TD colspan=20 width=1798526119%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>No reconciliation actions were performed. The briefcase reconciler wishes to fall back to the initiator's bit copy implementation. This value may only be returned if RECONCILEF_ONLYYOUWERECHANGED is set in <I>dwFlags</I>.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>REC_S_IDIDTHEUPDATES</TD>
<TD colspan=20 width=1798526119%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>Reconciliation was completed successfully, and all the objects involved (the object implementing the <B>Reconcile</B> member function and all the other objects described by the passed-in monikers) have been updated appropriately. The initiator does not need, therefore, to do anything further to propagate the changes. The variable pointed to by <I>plOutIndex</I> should be set to  - 1L if <B>Reconcile</B> returns this value. The initiator will not save the source object's storage if <B>Reconcile</B> returns this value. This value may only be returned if RECONCILEF_YOUMAYDOTHEUPDATES was set in <I>dwFlags</I>.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>REC_S_NOTCOMPLETE</TD>
<TD colspan=20 width=1798526119%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>The briefcase reconciler completed some, but not all, of the reconciliation. It may need user interaction. The changes will not be propagated to other objects.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>REC_S_NOTCOMPLETEBUTPROPAGATE</TD>
<TD colspan=20 width=1798526119%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>The briefcase reconciler completed some, but not all, of the reconciliation. It may need user interaction. The changes will be propagated to the other objects.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>Otherwise, the member function returns one of the following error values:</P>

<TABLE cols=3>

<TR VALIGN="top">
<TD colspan=3 width=100%>REC_E_NORESIDUES</TD>
<TD colspan=20 width=1798529771%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>The briefcase reconciler does not support the generation of residues, so the request for residues is denied. The state of the object is unchanged.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>REC_E_ABORTED</TD>
<TD colspan=20 width=1798529771%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>The briefcase reconciler terminated reconciliation in response to a termination request from the initiator (for more information, see <A HREF="12pp9qf.htm"><B>IReconcileInitiator::SetAbortCallback</B></A>). The state of the object is unspecified.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>REC_E_TOODIFFERENT</TD>
<TD colspan=20 width=1798529771%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>Reconciliation cannot be carried out because the provided document versions are too dissimilar.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>REC_E_INEEDTODOTHEUPDATES</TD>
<TD colspan=20 width=1798529771%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>The object's <B>Reconcile</B> implementation was called with RECONCILEF_YOUMAYDOTHEUPDATES clear in <I>dwFlags</I>; the object's <B>Reconcile</B> implementation requires that value to be set in <I>dwFlags</I>.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>OLE_E_NOTRUNNING</TD>
<TD colspan=20 width=1798529771%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>The object is an OLE embedded object that must be run before this operation can be carried out. The state of the object is unchanged.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=100%>E_UNEXPECTED</TD>
<TD colspan=20 width=1798529771%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=9%>&nbsp;</TD>
<TD width=77%>Unspecified error. </TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="32s446h.htm"><B>IReconcilableObject</B></A></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
