<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetUserName</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="35qklh5"></A><B>GetUserName  <A HREF="ids60u.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="2asgu6i.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="bogapi.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetUserName</B> function retrieves the user name of the current thread. This is the name of the user currently logged onto the system. </P>

<P><B>BOOL GetUserName(</B></P>

<TABLE cols=2 width=387>

<TR VALIGN="top">
<TD width=41%><B>LPTSTR</B> <I>lpBuffer</I><B>,</B></TD>
<TD width=59%>// address of name buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    LPDWORD</B> <I>nSize</I> </TD>
<TD width=59%>// address of size of name buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>   );</B></TD>
<TD width=59%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpBuffer</I></P>

<P>Points to the buffer to receive the null-terminated string containing the user's logon name. If this buffer is not large enough to contain the entire user name, the function fails. </P>

<P><I>nSize</I></P>

<P>Pointer to a <B>DWORD</B> that, on input, specifies the maximum size, in characters, of the buffer specified by the <I>lpBuffer</I> parameter. If this buffer is not large enough to contain the entire user name, the function fails. If the function succeeds, it will place the number of characters copied to the buffer into the <B>DWORD</B> that <I>nSize</I> points to. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero, and the variable pointed to by <I>nSize</I> contains the number of characters copied to the buffer specified by <I>lpBuffer</I>, including the terminating null character. </P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>If the current thread is impersonating another client, the <B>GetUserName</B> function returns the user name of the client that the thread is impersonating. </P>

<P><B>See Also</B></P>

<P><A HREF="1qc.l77.htm"><B>LookupAccountName</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
