<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>OK, Cancel, and Apply Now Buttons</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="71xdhb"></A><B>OK, Cancel, and Apply Now Buttons</B></P>

<P>The OK and Apply Now buttons are similar; both direct a property sheet's pages to validate and apply the property changes that the user has made. The only difference is that choosing the OK button causes the property sheet to be destroyed after the changes are applied, but choosing the Apply Now button does not. </P>

<P>When the user chooses the OK or Apply Now button, the property sheet sends the <A HREF="16h.1kh.htm">PSN_KILLACTIVE</A> notification message to the active page, giving it an opportunity to validate the user's changes. If the page determines that the changes are valid, it should call the <A HREF="d2okir.htm"><B>SetWindowLong</B></A><B> </B>function to set the DWL_MSGRESULT value for the page to FALSE. In this case, the property sheet sends the <A HREF="1htboo.htm">PSN_APPLY</A> notification message to each page, directing them to apply the new properties to the corresponding item. If the page determines that the user's changes are not valid, it should set DWL_MSGRESULT to TRUE and display a dialog box informing the user of the problem. The page remains active until it sets DWL_MSGRESULT to FALSE in response to a PSN_KILLACTIVE message. An application can use the <A HREF="6exw_ns.htm">PSM_APPLY</A> message to simulate the choice of the Apply Now button.</P>

<P>The Apply Now button is initially disabled when a page becomes active, indicating that there are not yet any property changes to apply. When the page receives user input through one of its controls indicating that the user has edited a property, the page should send the <A HREF="1clhe4o.htm">PSM_CHANGED</A> message to the property sheet. The message causes the property sheet to enable the Apply Now button. If the user subsequently chooses the Apply Now or Cancel button, the page should reinitialize its controls and then send the <A HREF="rty1k.htm">PSM_UNCHANGED</A> message to disable again the Apply Now button.</P>

<P>Sometimes the Apply Now button causes a page to make a change to a property sheet, and the change cannot be undone. When this happens, the page should send the <A HREF="1odbtx5.htm">PSM_CANCELTOCLOSE</A> message to the property sheet. The message causes the property sheet to change the text of the OK button to "Close," indicating that the applied changes cannot be canceled.</P>

<P>Sometimes a page makes a change to the system configuration that requires Windows to be to restarted or the system rebooted before the change can take effect. After making such a change, a page should send either the <A HREF="m9jw9v.htm">PSM_RESTARTWINDOWS</A> or <A HREF="125bfbh.htm">PSM_REBOOTSYSTEM</A> message to the property sheet. These messages cause the <A HREF="uokv08.htm"><B>PropertySheet</B></A><B> </B>function to return the ID_PSRESTARTWINDOWS or ID_PSREBOOTSYSTEM value after the property sheet is destroyed. </P>

<P>The property sheet sends the the <A HREF="1yiehj.htm">PSN_RESET</A> notification message to all pages when the user chooses the Cancel button, indicating that the property sheet is about to be destroyed. A page should use the notification to perform cleanup operations.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
