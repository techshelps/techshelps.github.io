<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IExtractIcon</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="5338sx"></A><B>IExtractIcon  <A HREF="aezfl..htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1erm.gm.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>IExtractIcon</B> interface is used by the shell to retrieve icons for objects it displays. </P>

<P>The operating system provides default icons for file objects but you can specify custom icons by making appropriate registry entries and, in some cases, by using <B>IExtractIcon</B>.</P>

<P><B>When to Implement </B></P>

<P>You implement <B>IExtractIcon</B> to provide either instance-specific icons for objects in a particular class, or icons for subfolders that extend the Explorer's name space. These implementations are accomplished by writing handler code in an OLE in-process server COM DLL.</P>

<P>In addition, if you implement <A HREF="113z9we.htm"><B>IShellFolder</B></A>, you will need to provide an implementation of <B>IExtractIcon</B> that callers can obtain by using <B>IShellFolder::GetUIObjectOf</B>. </P>

<P>Shell extensions based on <B>IExtractIcon</B> must be initialized by using <B>IPersistFile::Load</B>. You should also note that shell extensions do not work unless all appropriate registry entries are made.</P>

<P><B>When to Use</B></P>

<P>In most cases, you don't call this interface directly. It is usually called by the shell when an icon has been made available by a properly registered handler. However, you can call <B>IExtractIcon</B> directly if you want to delegate the task of icon extracting to another object.</P>

<P><B>Methods in Vtable Order</B></P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=46%><B>IUnknown Methods</B></TD>
<TD width=54%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>QueryInterface</B></TD>
<TD width=54%>Returns pointers to supported interfaces.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>AddRef</B></TD>
<TD width=54%>Increments reference count.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>Release</B></TD>
<TD width=54%>Decrements reference count.</TD>
</TR>
</TABLE><BR>

<P></P>

<TABLE cols=3>

<TR VALIGN="top">
<TD width=45%><B>IExtractIcon Methods</B></TD>
<TD width=54%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%><A HREF="dudl04.htm"><B>GetIconLocation</B></A></TD>
<TD colspan=2 width=55%>Retrieves the icon location for an object.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><A HREF="hdx87o.htm"><B>Extract</B></A></TD>
<TD colspan=2 width=55%>Extracts an icon from the specified location.</TD>
</TR>
</TABLE><BR>

<P></P>

</BODY>
</HTML>
