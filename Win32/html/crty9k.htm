<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>RegQueryInfoKey</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="crty9k"></A><B>RegQueryInfoKey  <A HREF="jr4mha.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1y7hnby.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="vm.h_d.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>RegQueryInfoKey</B> function retrieves information about a specified registry key. </P>

<P><B>LONG RegQueryInfoKey (</B></P>

<TABLE cols=2 width=606>

<TR VALIGN="top">
<TD width=44%><B>HKEY</B> <I>hKey</I><B>,</B></TD>
<TD width=56%>// handle of key to query </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    LPTSTR</B> <I>lpClass</I><B>,</B></TD>
<TD width=56%>// address of buffer for class string </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    LPDWORD</B> <I>lpcbClass</I><B>,</B></TD>
<TD width=56%>// address of size of class string buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    LPDWORD</B> <I>lpReserved</I><B>,</B></TD>
<TD width=56%>// reserved </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    LPDWORD</B> <I>lpcSubKeys</I><B>,</B></TD>
<TD width=56%>// address of buffer for number of subkeys </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    LPDWORD</B> <I>lpcbMaxSubKeyLen</I><B>,</B></TD>
<TD width=56%>// address of buffer for longest subkey name length  </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    LPDWORD</B> <I>lpcbMaxClassLen</I><B>,</B></TD>
<TD width=56%>// address of buffer for longest class string length </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    LPDWORD</B> <I>lpcValues</I><B>,</B></TD>
<TD width=56%>// address of buffer for number of value entries </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    LPDWORD</B> <I>lpcbMaxValueNameLen</I><B>,</B></TD>
<TD width=56%>// address of buffer for longest value name length </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    LPDWORD</B> <I>lpcbMaxValueLen</I><B>,</B></TD>
<TD width=56%>// address of buffer for longest value data length </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    LPDWORD</B> <I>lpcbSecurityDescriptor</I><B>,</B></TD>
<TD width=56%>// address of buffer for security descriptor length </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>    PFILETIME</B> <I>lpftLastWriteTime</I> </TD>
<TD width=56%>// address of buffer for last write time </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>   );</B></TD>
<TD width=56%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hKey</I></P>

<P>Identifies a currently open key or any of the following predefined reserved handle values: </P>

<P><B>HKEY_CLASSES_ROOT</B><BR>
<B>HKEY_CURRENT_USER</B><BR>
<B>HKEY_LOCAL_MACHINE</B><BR>
<B>HKEY_USERS</B></P>

<P><I>lpClass</I></P>

<P>Points to a buffer that receives the key's class name. This parameter can be NULL.</P>

<P><I>lpcbClass</I></P>

<P>Points to a variable that specifies the size, in characters, of the buffer pointed to by the <I>lpClass</I> parameter. This size should include the terminating null character. When the function returns, this variable contains the length of the class string stored in the buffer. The count returned does not include the terminating null character. If the buffer is not big enough, the function returns ERROR_MORE_DATA, and the variable contains the size of the string, in characters, without counting the null character. </P>

<P>If <I>lpClass</I> is NULL, <I>lpcbClass</I> can be NULL. </P>

<P><B>Windows NT:</B> If the <I>lpClass</I> parameter is a valid address, but the <I>lpcbClass</I> parameter is not (for example, it is NULL), the function returns ERROR_INVALID_PARAMETER. </P>

<P><B>Windows 95:</B> If the <I>lpClass</I> parameter is a valid address, but the <I>lpcbClass</I> parameter is not (for example, it is NULL), the function returns ERROR_SUCCESS instead of ERROR_INVALID_PARAMETER. To ensure compatibility with other platforms, verify that <I>lpcbClass</I> is valid before calling the function.</P>

<P><I>lpReserved</I></P>

<P>Reserved; must be NULL. </P>

<P><I>lpcSubKeys</I></P>

<P>Points to a variable that receives the number of subkeys contained by the specified key. This parameter can be NULL. </P>

<P><I>lpcbMaxSubKeyLen</I></P>

<P>Points to a variable that receives the length, in characters, of the key's subkey with the longest name. The count returned does not include the terminating null character. This parameter can be NULL. </P>

<P><I>lpcbMaxClassLen</I></P>

<P>Points to a variable that receives the length, in characters, of the longest string specifying a subkey class. The count returned does not include the terminating null character. This parameter can be NULL. </P>

<P><I>lpcValues</I></P>

<P>Points to a variable that receives the number of values associated with the key. This parameter can be NULL. </P>

<P><I>lpcbMaxValueNameLen</I></P>

<P>Points to a variable that receives the length, in characters, of the key's longest value name. The count returned does not include the terminating null character. This parameter can be NULL. </P>

<P><I>lpcbMaxValueLen</I></P>

<P>Points to a variable that receives the length, in bytes, of the longest data component among the key's values. This parameter can be NULL. </P>

<P><I>lpcbSecurityDescriptor</I></P>

<P>Points to a variable that receives the length, in bytes, of the key's security descriptor. This parameter can be NULL. </P>

<P><I>lpftLastWriteTime</I></P>

<P>Pointer to a <A HREF="a44m8h.htm"><B>FILETIME</B></A> structure. This parameter can be NULL. </P>

<P>If you are querying the registry on a computer running Windows NT, the function sets the members of the <B>FILETIME</B> structure to indicate the last time that the key or any of its value entries was modified.</P>

<P>If you are querying the registry on a computer running Windows 95, the function sets the members of the <B>FILETIME</B> structure to zero. This is because the Windows 95 operating system does not keep track of registry key last write time information.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is ERROR_SUCCESS.</P>

<P>If the function fails, the return value is a nonzero error code defined in WINERROR.H. You can use the <A HREF="n7qrmp.htm"><B>FormatMessage</B></A> function with the FORMAT_MESSAGE_FROM_SYSTEM flag to get a generic description of the error.</P>

<P><B>Remarks</B></P>

<P>The key identified by the <I>hKey</I> parameter must have been opened with KEY_QUERY_VALUE access (KEY_READ access includes KEY_QUERY_VALUE access). </P>

<P><B>See Also</B></P>

<P><A HREF="a44m8h.htm"><B>FILETIME</B></A>, <A HREF="kr5n7j.htm"><B>RegDeleteKey</B></A>, <A HREF="toz4vb.htm"><B>RegEnumKey</B></A>, <A HREF=".ak4qs.htm"><B>RegEnumKeyEx</B></A>, <A HREF="yurrmp.htm"><B>RegEnumValue</B></A>, <A HREF="bwg6c_.htm"><B>RegQueryValue</B></A>, <A HREF="1j.0zz..htm"><B>RegQueryValueEx</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
