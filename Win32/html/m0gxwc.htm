<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Adding a Network Connection</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="m0gxwc"></A><B>Adding a Network Connection</B></P>

<P>To make a connection to a network resource described by a <A HREF="1e2f7kp.htm"><B>NETRESOURCE</B></A> structure, an application can call the <A HREF="xgb4k0.htm"><B>WNetAddConnection2</B></A> function, as shown in the following example. </P>

<P>DWORD dwResult;  </P>

<P>NETRESOURCE nr; </P>

<P></P>

<P>dwResult = WNetAddConnection2(&amp;nr, // NETRESOURCE from enumeration </P>

<P>(LPSTR) NULL,             // no password </P>

<P>(LPSTR) NULL,             // logged-in user </P>

<P>CONNECT_UPDATE_PROFILE);  // update profile with connect info </P>

<P></P>

<P>if (dwResult == ERROR_ALREADY_ASSIGNED) </P>

<P>{ </P>

<P>TextOut(hdc, 10, 10, "Already connected to specified resource.", 40); </P>

<P>return FALSE; </P>

<P>} </P>

<P></P>

<P>else if (dwResult == ERROR_DEVICE_ALREADY_REMEMBERED) </P>

<P>{ </P>

<P>TextOut(hdc, 10, 10, </P>

<P>"Attempted reassignment of remembered device.", 44); </P>

<P>return FALSE; </P>

<P>} </P>

<P>else if(dwResult != NO_ERROR) </P>

<P>{ </P>

<P>// An application-defined error handler is demonstrated in the </P>

<P>// section titled "Retrieving Network Errors." </P>

<P>NetErrorHandler(hwnd, dwResult, (LPSTR)"WNetAddConnection2"); </P>

<P>return FALSE; </P>

<P>} </P>

<P></P>

<P>TextOut(hdc, 10, 10, "Connected to specified resource.", 32); </P>

<P>The <A HREF="1nkk0yr.htm"><B>WNetAddConnection</B></A> function is supported for compatibility with earlier versions of Windows for Workgroups. For new applications, use <A HREF="xgb4k0.htm"><B>WNetAddConnection2</B></A> or <A HREF="1jpn47k.htm"><B>WNetAddConnection3</B></A>.</P>

</BODY>
</HTML>
