<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Displaying the Print Dialog Box</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="26f7uck"></A><B>Displaying the Print Dialog Box</B></P>

<P>This topic describes sample code that displays a Print dialog box so a user can select options for printing a document. The sample code first initializes a <A HREF="17iw9wo.htm"><B>PRINTDLG</B></A> structure, and then calls the <A HREF="11768vz.htm"><B>PrintDlg</B></A> function to display the dialog box. </P>

<P>This example sets the PD_RETURNDC flag in the <B>Flags</B> member of the <B>PRINTDLG</B> structure. This causes <B>PrintDlg</B> to return a device context handle for the selected printer in the <B>hDC</B> member. You can use the handle to render output on the printer. </P>

<P>On input, the sample code sets the <B>hDevMode</B> and <B>hDevNames</B> members to NULL. If the function returns TRUE, these members return handles to <A HREF="1bkrzj1.htm"><B>DEVMODE</B></A> and <A HREF="9vt77_.htm"><B>DEVNAMES</B></A> structures containing the user's input and information about the printer. You can use this information to prepare the output to be sent to the selected printer. </P>

<P>PRINTDLG pd;<BR>
HWND hwnd;<BR>
<BR>
// Initialize PRINTDLG<BR>
ZeroMemory(&amp;pd, sizeof(PRINTDLG));</P>

<P>pd.lStructSize = sizeof(PRINTDLG);<BR>
pd.hwndOwner   = hwnd;<BR>
pd.hDevMode    = NULL;      // Don't forget to free or store hDevMode.<BR>
pd.hDevNames   = NULL;      // Don't forget to free or store hDevNames.<BR>
pd.Flags       = PD_USEDEVMODECOPIESANDCOLLATE | PD_RETURNDC; <BR>
pd.nCopies     = 1;<BR>
pd.nFromPage   = 0xFFFF;  </P>

<P>pd.nToPage     = 0xFFFF; </P>

<P>pd.nMinPage    = 1; </P>

<P>pd.nMaxPage    = 0xFFFF; </P>

<P><BR>
if (PrintDlg(&amp;pd)==TRUE) {<BR>
<BR>
    // GDI calls to render output. <BR>
<BR>
    // Delete DC when done.<BR>
    DeleteDC(pd.hDC);<BR>
}<BR>
 </P>

</BODY>
</HTML>
