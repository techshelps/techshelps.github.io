<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Tool Text</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="0rx31q"></A><B>Tool Text</B></P>

<P>When you add a tool to a tooltip control, the <B>lpszText</B> member of the <A HREF="3cq6jv.htm"><B>TOOLINFO</B></A> structure must specify the address of the string to display for the tool. You can change the text any time after adding the tool by using the TTM_UPDATETIPTEXT message. </P>

<P>If the high-order word of <B>lpszText</B> is zero, the low-order word must be the identifier of a string resource. When the tooltip control needs the text, the system loads the specified string resource from the application instance identified by the <B>hinst</B> member of <B>TOOLINFO</B>.</P>

<P>If you specify the LPSTR_TEXTCALLBACK value in the <B>lpszText</B> member, the tooltip control notifies the window specified in the <B>hwnd</B> member of <A HREF="3cq6jv.htm"><B>TOOLINFO</B></A> whenever the tooltip control needs to display text for the tool. The tooltip control sends the <A HREF="ykpj1n.htm">TTN_NEEDTEXT</A> notification message to the window. The message includes the address of a <A HREF="0z56cs.htm"><B>TOOLTIPTEXT</B></A> structure, which contains the window handle as well as the application-defined identifier for the tool. The window examines the structure to determine the tool for which text is needed, and it fills the appropriate structure members with information that the tooltip control needs to display the string. </P>

<P>Many applications create toolbars containing tools that correspond to menu commands. For such tools, it is convenient for the tooltip control to display the same text as the corresponding menu item. The system automatically strips the ampersand (&amp;) accelerator characters from all strings passed to a tooltip control, unless the control has the TTS_NOPREFIX style.</P>

<P>To retrieve the text for a tool, use the <A HREF="7cm11q.htm">TTM_GETTEXT</A> message. </P>

</BODY>
</HTML>
