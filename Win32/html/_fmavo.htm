<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GCP_RESULTS</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="_fmavo"></A><B>GCP_RESULTS  <A HREF="0_rogm.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="4jd_z5i.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="v_l0t2.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GCP_RESULTS</B> structure contains information about characters in a string. This structure receives the results of the <A HREF="_hoyjx.htm"><B>GetCharacterPlacement</B></A> function. For some languages, the first element in the arrays may contain more, language-dependent information.</P>

<P>typedef struct tagGCP_RESULTS {<BR>
    DWORD  lStructSize;<BR>
    LPTSTR  lpOutString;<BR>
    UINT  *lpOrder;<BR>
    INT  *lpDx;<BR>
    INT  *lpCaretPos;<BR>
    LPTSTR lpClass;<BR>
    UINT  *lpGlyphs;<BR>
    UINT  nGlyphs;<BR>
    UINT  nMaxFit;<BR>
} GCP_RESULTS;<BR>
  </P>

<P><B>Members</B></P>

<P><B>lStructSize</B></P>

<P>Specifies the size, in bytes, of the structure.</P>

<P><B>lpOutString</B></P>

<P>Pointer to the buffer that receives the output string or is NULL if the output string is not needed. The output string is a version of the original string that is in the order that will be displayed on a given device. Typically the output string is identical to the original string, but may be different if the string needs reordering and the GCP_REORDER flag is set or if the the original string exceeds the maximum extent and the GCP_MAXEXTENT flag is set.</P>

<P><B>lpOrder</B></P>

<P>Address of the array that receives the ordering indices for the characters in the output string or is NULL if the ordering indices are not needed. The original string needs reordering if the <A HREF="1_h0udu.htm"><B>GetFontLanguageInfo</B></A> function returns the GCP_REORDER value. This is typically used when <B>GetFontLanguageInfo</B> returns the GCP_REORDER flag. For example, in Hebrew, in which the text runs from right to left, the <B>lpOrder</B> array gives the exact locations of each element in the original string.</P>

<P><B>lpDx</B></P>

<P>Pointer to the array that receives the distances between adjacent character cells or is NULL if these distances are not needed. If glyph rendering is done, the distances are for the glyphs not the characters, so the resulting array can be used with the <A HREF="9dxaad.htm"><B>ExtTextOut</B></A> function. </P>

<P>The distances in this array are in display order. To find the distance for the <I>i</I>th character in the original string, use the <B>lpOrder</B> array as follows:</P>

<P>width = lpDx[lpOrder[i]];<BR>
  </P>

<P>On input, this member may contain justification weight values if the GCP_JUSTIFYIN value is given with the <A HREF="_hoyjx.htm"><B>GetCharacterPlacement</B></A> function.</P>

<P><B>lpCaretPos</B></P>

<P>Pointer to the array that receives the caret position values or is NULL if caret positions are not needed. Each value specifies the caret position immediately before the corresponding character. In some languages the position of the caret for each character may not be immediately to the left of the character. For example, in Hebrew, in which the text runs from right to left, the caret position is to the right of the character. If glyph ordering is done, <B>lpCaretPos</B> matches the original string <I>not</I> the output string. This means that some adjacent values may be the same. </P>

<P>The values in this array are in input order. To find the caret position value for the <I>i</I>th character in the original string, use the array as follows:</P>

<P>position = lpCaretPos[i];<BR>
  </P>

<P><B>lpClass</B></P>

<P>Pointer to the array that contains and/or receives character classifications. The values indicate how to lay out characters in the string and are similar (but not identical) to the CT_CTYPE2 values returned by the <B>GetStringTypeEx</B> function. Each element of the array can be set to zero or one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=52%><B>Value</B></TD>
<TD width=48%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=52%>GCPCLASS_ARABIC</TD>
<TD width=48%>Arabic character.</TD>
</TR>

<TR VALIGN="top">
<TD width=52%>GCPCLASS_HEBREW</TD>
<TD width=48%>Hebrew character.</TD>
</TR>

<TR VALIGN="top">
<TD width=52%>GCPCLASS_LATIN</TD>
<TD width=48%>Character from a Latin or other single-byte character set for a left-to-right language.</TD>
</TR>

<TR VALIGN="top">
<TD width=52%>GCPCLASS_LATINNUMBER</TD>
<TD width=48%>Digit from a Latin or other single-byte character set for a left-to-right language.</TD>
</TR>

<TR VALIGN="top">
<TD width=52%>GCPCLASS_LOCALNUMBER</TD>
<TD width=48%>Digit from the character set associated with the current font.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>In addition, the following can be used when supplying values in the <B>lpClass</B> array with the GCP_CLASSIN flag.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=59%><B>Value</B></TD>
<TD width=41%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=59%>GCPCLASS_LATINNUMERICSEPARATOR</TD>
<TD width=41%>Input only. Character used to separate Latin digits, such as acomma or decimal point.</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>GCPCLASS_LATINNUMERICTERMINATOR</TD>
<TD width=41%>Input only. Character used to terminate Latin digits, such as a plus or minus sign.</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>GCPCLASS_NEUTRAL</TD>
<TD width=41%>Input only. character has no specific classification.</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>GCPCLASS_NUMERICSEPARATOR</TD>
<TD width=41%>Input only. Character used to separate digits, such as a comma or decimal point.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>For languages that use the GCP_REORDER flag, the following values can also be used with the GCP_CLASSIN flag. Unlike the preceding values, which can be used anywhere in the <B>lpClass</B> array, all of the following values are used only in the first location in the array. All combine with other classifications. Note that GCPCLASS_PREBOUNDLTR and GCPCLASS_PREBOUNDRTL are mutually exclusive, as are GCPCLASSPOSTBOUNDLTR and GCPCLASSPOSTBOUNDRTL.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=52%><B>Value</B></TD>
<TD width=48%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=52%>GCPCLASS_PREBOUNDLTR</TD>
<TD width=48%>Set <I>lpClass</I>[0] to GCP_CLASS_PREBOUNDLTR to bind the string to left-to-right reading order before the string.</TD>
</TR>

<TR VALIGN="top">
<TD width=52%>GCPCLASS_PREBOUNDRTL</TD>
<TD width=48%>Set <I>lpClass</I>[0] to GCP_CLASS_PREBOUNDRTL to bind the string to right-to-left reading order before the string.</TD>
</TR>

<TR VALIGN="top">
<TD width=52%>GCPCLASS_POSTBOUNDLTR</TD>
<TD width=48%>Set <I>lpClass</I>[0] to GCP_CLASS_POSTBOUNDLTR to bind the string to left-to-right reading order after the string.</TD>
</TR>

<TR VALIGN="top">
<TD width=52%>GCPCLASS_POSTBOUNDRTL</TD>
<TD width=48%>Set <I>lpClass</I>[0] to GCP_CLASS_POSTBOUNDRTL to bind the string to right-to-left reading order after the string.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>To force the layout of a character to be carried out in a specific way, preset the classification for the corresponding array element; the function leaves such preset classifications unchanged and computes classifications only for array elements that have been set to zero. Preset classifications are used only if the GCP_CLASSIN flag is set and the <B>lpclass</B> array is supplied.</P>

<P>If <B>getFontLanguageInfo</B> does not return GCP_REORDER for the current font, only the GCPCLASS_LATIN value is meaningful.</P>

<P><B>lpGlyphs</B></P>

<P>Pointer to the array that receives the values identifying the glyphs used for rendering the string or is NULL if glyph rendering is not needed. The number of glyphs in the array may be less than the number of characters in the original string if the string contains ligated glyphs. Also if reordering is required, the order of the glyphs may not be sequential. </P>

<P>This array is useful if more than one operation is being done on a string which has any form of ligation, kerning or order-switching. Using the values in this array for subsequent operations saves the time otherwise required to generate the glyph indices each time. </P>

<P>This array always contains glyph indices and the ETO_GLYPH_INDEX value must always be used when this array is used with the <A HREF="9dxaad.htm"><B>ExtTextOut</B></A> function.</P>

<P>When GCP_LIGATE is used, you can limit the number of characters that will be ligated together. (In Arabic for example, three-character ligations are common). This is done by setting the maximum required in lpGcpResults-&gt;lpGlyphs[0]. If no maximum is required, you should set this field to zero. </P>

<P>For languages such as Arabic, where <A HREF="1_h0udu.htm"><B>GetFontLanguageInfo</B></A> returns the GCP_GLYPHSHAPE flag, the glyphs for a character will be different depending on whether the character is at the beginning, middle, or end of a word. Typically, the first character in the input string will also be the first character in a word, and the last character in the input string will be treated as the last character in a word. However, if the displayed string is a subset of the complete string, such as when displaying a section of scrolled text, this may not be true. In these cases, it is desirable to force the first or last characters to be shaped as not being initial or final forms. To do this, again, the first location in the <B>lpGlyphs</B> array is used by performing an OR operation of the ligation value above with the values GCPGLYPH_LINKBEFORE and/or GCPGLYPH_LINKAFTER. For example, a value of GCPGLYPH_LINKBEFORE | 2 means that two-character ligatures are the maximum required, and the first character in the string should be treated as if it is in the middle of a word.</P>

<P><B>nGlyphs</B></P>

<P>On input, this member must be set to the size of the arrays pointed to by the array pointer members. On output, this is set to the number of glyphs filled in, in the output arrays. If glyph substitution is <I>not</I> required (that is, each input character maps to exactly one glyph), this member is the same as it is on input.</P>

<P><B>nMaxFit</B></P>

<P>Number of characters that fit within the extents specified by the <I>nMaxExtent</I> parameter of the <B>GetCharacterPlacement</B> function. If the GCP_MAXEXTENT or GCP_JUSTIFY value is set, this value may be less than the number of characters in the original string. This member is set regardless of whether the GCP_MAXEXTENT or GCP_JUSTIFY value is given. Unlike <B>nGlyphs</B>, which specifies the number of output glyphs, <B>nMaxFit</B> refers to the number of characters from the input string. For Latin SBCS languages, this will be the same.</P>

<P></P>

<P><B>Remarks</B></P>

<P>Whether the <B>lpGlyphs</B>, <B>lpOutString</B>, or neither is required depends on the results of the <A HREF="1_h0udu.htm"><B>GetFontLanguageInfo</B></A> call.</P>

<P>In the case of a font for a language such as English, in which none of the GCP_DBCS, GCP_REORDER, GCP_GLYPHSHAPE, GCP_LIGATE, GCP_DIACRITIC, or GCP_KASHIDA flags are returned, neither of the arrays is required for proper operation. (Though not required, they can still be used. If the <B>lpOutString</B> array is used, it will be exactly the same as the <I>lpInputString</I> passed to <A HREF="_hoyjx.htm"><B>GetCharacterPlacement</B></A>.) Note, however, that if GCP_MAXEXTENT is used, then <B>lpOutString</B> will contain the truncated string if it is used, NOT an exact copy of the original.</P>

<P>In the case of fonts for languages such as Hebrew, which DO have reordering but do not typically have extra glyph shapes, <B>lpOutString</B> should be used. This will give the string on the screen-readable order. However, the <B>lpGlyphs</B> array is not typically needed. (Hebrew <I>can</I> have extra glyphs, if the font is a TrueType/Open font.)</P>

<P>In the case of languages such as Thai or Arabic, in which <B>GetFontLanguageInfo</B> returns the GCP_GLYPHSHAPE flag, the <B>lpOutString</B> will give the display-readable order of the string passed to <B>GetCharacterPlacement</B>, but the values will still be the unshaped characters. For proper display, the <B>lpGlyphs</B> array must be used.</P>

<P><B>See Also</B></P>

<P><A HREF="9dxaad.htm"><B>ExtTextOut</B></A>, <A HREF="_hoyjx.htm"><B>GetCharacterPlacement</B></A>, <A HREF="1_h0udu.htm"><B>GetFontLanguageInfo</B></A> </P>

</BODY>
</HTML>
