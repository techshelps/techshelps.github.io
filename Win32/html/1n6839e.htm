<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CreateConsoleScreenBuffer</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1n6839e"></A><B>CreateConsoleScreenBuffer  <A HREF="_1ydxi.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="7re1xz.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF=".hu4wz.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>CreateConsoleScreenBuffer</B> function creates a console screen buffer and returns a handle of it. </P>

<P><B>HANDLE CreateConsoleScreenBuffer(</B></P>

<TABLE cols=2 width=567>

<TR VALIGN="top">
<TD width=62%><B>DWORD</B> <I>dwDesiredAccess</I><B>,</B></TD>
<TD width=38%>// access flag</TD>
</TR>

<TR VALIGN="top">
<TD width=62%><B>    DWORD</B> <I>dwShareMode</I><B>,</B></TD>
<TD width=38%>// buffer share mode</TD>
</TR>

<TR VALIGN="top">
<TD width=62%><B>    LPSECURITY_ATTRIBUTES</B> <I>*lpSecurityAttributes</I><B>,</B></TD>
<TD width=38%>// pointer to security attributes  </TD>
</TR>

<TR VALIGN="top">
<TD width=62%><B>    DWORD</B> <I>dwFlags</I><B>,</B></TD>
<TD width=38%>// type of buffer to create </TD>
</TR>

<TR VALIGN="top">
<TD width=62%><B>    LPVOID</B> <I>lpScreenBufferData</I> </TD>
<TD width=38%>// reserved</TD>
</TR>

<TR VALIGN="top">
<TD width=62%><B>   );</B></TD>
<TD width=38%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>dwDesiredAccess</I></P>

<P>Specifies the desired access to the console screen buffer. This parameter can be one or both of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=31%><B>Value</B></TD>
<TD width=69%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>GENERIC_READ</TD>
<TD width=69%>Requests read access to the console screen buffer, enabling the process to read data from the buffer.</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>GENERIC_WRITE</TD>
<TD width=69%>Requests write access to the console screen buffer, enabling the process to write data to the buffer.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>dwShareMode</I></P>

<P>Specifies how this console screen buffer can be shared. This parameter can be zero, indicating that the buffer cannot be shared, or it can be one or both of the following two values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=36%><B>Value</B></TD>
<TD width=64%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=36%>FILE_SHARE_READ</TD>
<TD width=64%>Other open operations can be performed on the console screen buffer for read access.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>FILE_SHARE_WRITE</TD>
<TD width=64%>Other open operations can be performed on the console screen buffer for write access.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lpSecurityAttributes</I></P>

<P>Pointer to a <A HREF="be53kg.htm"><B>SECURITY_ATTRIBUTES</B></A> structure that determines whether the returned handle can be inherited by child processes. If <I>lpSecurityAttributes</I> is NULL, the handle cannot be inherited. </P>

<P><B>Windows NT:</B> The <B>lpSecurityDescriptor</B> member of the structure specifies a security descriptor for the new console screen buffer. If <I>lpSecurityAttributes</I> is NULL, the console screen buffer gets a default security descriptor. </P>

<P><B>Windows 95:</B> The <B>lpSecurityDescriptor</B> member of the structure is ignored.</P>

<P><I>dwFlags</I></P>

<P>Specifies the type of console screen buffer to create. The only currently supported screen buffer type is CONSOLE_TEXTMODE_BUFFER. </P>

<P><I>lpScreenBufferData</I></P>

<P>Reserved for possible future use; should be NULL. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is a handle to the new console screen buffer.</P>

<P>If the function fails, the return value is INVALID_HANDLE_VALUE. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>A console can have multiple screen buffers but only one active screen buffer. Inactive screen buffers can be accessed for reading and writing, but only the active screen buffer is displayed. To make the new screen buffer the active screen buffer, use the <A HREF="4n5s_56.htm"><B>SetConsoleActiveScreenBuffer</B></A> function. </P>

<P>The calling process can use the returned handle in any function that requires a handle of a console screen buffer, subject to the limitations of access specified by the <I>dwDesiredAccess</I> parameter. </P>

<P>The calling process can use the <B>DuplicateHandle</B> function to create a duplicate screen buffer handle that has different access or inheritability from the original handle. However, <B>DuplicateHandle</B> cannot be used to create a duplicate that is valid for a different process (except through inheritance). </P>

<P>To close the screen buffer handle, use the <B>CloseHandle</B> function. </P>

<P><B>See Also</B></P>

<P><A HREF="ngwwie.htm"><B>CloseHandle</B></A>, <A HREF="1ojqkwy.htm"><B>DuplicateHandle</B></A>, <A HREF="h61zfu.htm"><B>GetConsoleScreenBufferInfo</B></A>, <A HREF="be53kg.htm"><B>SECURITY_ATTRIBUTES</B></A>, <A HREF="4n5s_56.htm"><B>SetConsoleActiveScreenBuffer</B></A>, <A HREF="1qn6nvu.htm"><B>SetConsoleScreenBufferSize</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
