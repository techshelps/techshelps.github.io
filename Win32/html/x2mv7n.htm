<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Writing the Frame Window Procedure</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="x2mv7n"></A><B>Writing the Frame Window Procedure</B></P>

<P>The window procedure for an MDI frame window is similar to that of a non-MDI application's main window. The difference is that a frame window procedure passes all messages it does not handle to the <A HREF="1md1ycp.htm"><B>DefFrameProc</B></A> function rather than to the <A HREF="32d1nbh.htm"><B>DefWindowProc</B></A> function. In addition, the frame window procedure must also pass some messages that it does handle, including those listed in the following table.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=29%><B>Message</B></TD>
<TD width=71%><B>Response</B></TD>
</TR>

<TR VALIGN="top">
<TD width=29%><A HREF="71v.3j.htm">WM_COMMAND</A></TD>
<TD width=71%>Activates the MDI child window that the user chooses. This message is sent when the user chooses an MDI child window from the Window menu of the MDI frame window. The window identifier accompanying this message identifies the MDI child window to be activated.</TD>
</TR>

<TR VALIGN="top">
<TD width=29%><A HREF="12qeipe.htm">WM_MENUCHAR</A></TD>
<TD width=71%>Opens the <B>window</B> menu of the active MDI child window when the user presses the ALT+ - (minus) key combination.</TD>
</TR>

<TR VALIGN="top">
<TD width=29%><A HREF="1ml4f9e.htm">WM_SETFOCUS</A></TD>
<TD width=71%>Passes the keyboard focus to the MDI client window, which in turn passes it to the active MDI child window.</TD>
</TR>

<TR VALIGN="top">
<TD width=29%><A HREF="d9cb1f.htm">WM_SIZE</A></TD>
<TD width=71%>Resizes the MDI client window to fit in the new frame window's client area. If the frame window procedure sizes the MDI client window to a different size, it should not pass the message to the <A HREF="32d1nbh.htm"><B>DefWindowProc</B></A> function.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>The frame window procedure in Multipad is called MPFrameWndProc. The handling of other messages by MPFrameWndProc is similar to that of non-MDI applications. <A HREF="71v.3j.htm">WM_COMMAND</A> messages in Multipad are handled by the locally defined CommandHandler function. For command messages Multipad does not handle, CommandHandler calls the <A HREF="1md1ycp.htm"><B>DefFrameProc</B></A> function. If Multipad doesn't use <B>DefFrameProc</B> by default, the user can't activate a child window from the Window menu, because the WM_COMMAND message sent by choosing the window's menu item (command) would be lost.</P>

</BODY>
</HTML>
