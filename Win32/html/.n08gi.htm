<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetTapePosition</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME=".n08gi"></A><B>GetTapePosition  <A HREF="q1cntk.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="3qn63vs.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="a7m4zq.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetTapePosition</B> function retrieves the current address of the tape, in logical or absolute blocks. </P>

<P><B>DWORD GetTapePosition(</B></P>

<TABLE cols=2 width=533>

<TR VALIGN="top">
<TD width=40%><B>HANDLE</B> <I>hDevice</I><B>,</B></TD>
<TD width=60%>// handle of open device </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    DWORD</B> <I>dwPositionType</I><B>,</B></TD>
<TD width=60%>// type of address to obtain </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    LPDWORD</B> <I>lpdwPartition</I><B>,</B></TD>
<TD width=60%>// address of current tape partition </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    LPDWORD</B> <I>lpdwOffsetLow</I><B>,</B></TD>
<TD width=60%>// address of low-order 32 bits of tape position  </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    LPDWORD</B> <I>lpdwOffsetHigh</I> </TD>
<TD width=60%>// address of high-order 32 bits of tape position  </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>   );</B></TD>
<TD width=60%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hDevice</I></P>

<P>Identifies the device on which to get the tape position. This handle is created by using <A HREF="xn35yd.htm"><B>CreateFile</B></A>. </P>

<P><I>dwPositionType</I></P>

<P>Specifies the type of address to obtain. This parameter can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=46%><B>Value</B></TD>
<TD width=54%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=46%>TAPE_ABSOLUTE_POSITION</TD>
<TD width=54%>The <I>lpdwOffsetLow</I> and <I>lpdwOffsetHigh</I> parameters receive the device-specific block address. The <I>dwPartition</I> parameter receives zero.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%>TAPE_LOGICAL_POSITION</TD>
<TD width=54%>The <I>lpdwOffsetLow</I> and <I>lpdwOffsetHigh</I> parameters receive the logical block address. The <I>dwPartition</I> parameter receives the logical tape partition.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lpdwPartition</I></P>

<P>Points to a variable that receives the number of the current tape partition. Partitions are numbered logically from 1 through <I>n</I>, where 1 is the first partition on the tape and <I>n</I> is the last. When a device-specific block address is retrieved, or if the device supports only one partition, this parameter receives zero. </P>

<P><I>lpdwOffsetLow</I></P>

<P>Points to a variable that receives the low-order 32 bits of the current tape position. </P>

<P><I>lpdwOffsetHigh</I></P>

<P>Points to a variable that receives the high-order 32 bits of the current tape position. This parameter can be NULL if the high-order 32 bits are not required. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is NO_ERROR.</P>

<P>If the function fails, the return value is one of the following error codes: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=56%><B>Error code</B></TD>
<TD width=44%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_BEGINNING_OF_MEDIA</TD>
<TD width=44%>An attempt to access data before the beginning-of-medium marker failed.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_BUS_RESET</TD>
<TD width=44%>A reset condition was detected on the bus.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_END_OF_MEDIA</TD>
<TD width=44%>The end-of-tape marker was reached during an operation.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_FILEMARK_DETECTED</TD>
<TD width=44%>A filemark was reached during an operation.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_SETMARK_DETECTED</TD>
<TD width=44%>A setmark was reached during an operation.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_NO_DATA_DETECTED</TD>
<TD width=44%>The end-of-data marker was reached during an operation.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_PARTITION_FAILURE</TD>
<TD width=44%>The tape could not be partitioned.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_INVALID_BLOCK_LENGTH</TD>
<TD width=44%>The block size is incorrect on a new tape in a multivolume partition.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_DEVICE_NOT_PARTITIONED</TD>
<TD width=44%>The partition information could not be found when a tape was being loaded.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_MEDIA_CHANGED</TD>
<TD width=44%>The tape that was in the drive has been replaced or removed.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_NO_MEDIA_IN_DRIVE</TD>
<TD width=44%>There is no media in the drive.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_NOT_SUPPORTED</TD>
<TD width=44%>The tape driver does not support a requested function.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_UNABLE_TO_LOCK_MEDIA</TD>
<TD width=44%>An attempt to lock the ejection mechanism failed.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_UNABLE_TO_UNLOAD_MEDIA</TD>
<TD width=44%>An attempt to unload the tape failed.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_WRITE_PROTECT</TD>
<TD width=44%>The media is write protected.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>A logical block address is relative to a partition. The first logical block address on each partition is zero. </P>

<P>Call the <B>GetTapeParameters</B> function to obtain information about the status, capabilities, and capacities of tape drives and media. </P>

<P><B>See Also</B></P>

<P><A HREF="xn35yd.htm"><B>CreateFile</B></A>, <A HREF="zdslum.htm"><B>GetTapeParameters</B></A>, <A HREF="astp5y.htm"><B>SetTapePosition</B></A> </P>

</BODY>
</HTML>
