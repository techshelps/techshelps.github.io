<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Creating a Trackbar</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="0dpze2"></A><B>Creating a Trackbar</B></P>

<P>The following example shows how to create a trackbar with the TBS_AUTOTICKS and TBS_ENABLESELRANGE styles. When the trackbar is created, both its range and its selection range are initialized. The page size is also set at this time. </P>

<P>// CreateTrackbar - creates and initializes a trackbar.  </P>

<P>// </P>

<P>// Global variable </P>

<P>//     g_hinst - instance handle </P>

<P>HWND WINAPI CreateTrackbar( </P>

<P>HWND hwndDlg,  // handle of dialog box (parent window) </P>

<P>UINT iMin,     // minimum value in trackbar range </P>

<P>UINT iMax,     // maximum value in trackbar range </P>

<P>UINT iSelMin,  // minimum value in trackbar selection </P>

<P>UINT iSelMax)  // maximum value in trackbar selection </P>

<P>{ </P>

<P></P>

<P>InitCommonControls(); // loads common control's DLL </P>

<P></P>

<P>hwndTrack = CreateWindowEx( </P>

<P>0,                             // no extended styles </P>

<P>TRACKBAR_CLASS,                // class name </P>

<P>"Trackbar Control",            // title (caption) </P>

<P>WS_CHILD | WS_VISIBLE | </P>

<P>TBS_AUTOTICKS | TBS_ENABLESELRANGE,  // style </P>

<P>10, 10,                        // position </P>

<P>200, 30,                       // size </P>

<P>hwndDlg,                       // parent window </P>

<P>ID_TRACKBAR,             // control identifier </P>

<P>g_hinst,                       // instance </P>

<P>NULL                           // no WM_CREATE parameter </P>

<P>); </P>

<P></P>

<P>SendMessage(hwndTrack, TBM_SETRANGE, </P>

<P>(WPARAM) TRUE,                   // redraw flag </P>

<P>(LPARAM) MAKELONG(iMin, iMax));  // min. &amp; max. positions </P>

<P>SendMessage(hwndTrack, TBM_SETPAGESIZE, </P>

<P>0, (LPARAM) 4);                  // new page size </P>

<P></P>

<P>SendMessage(hwndTrack, TBM_SETSEL, </P>

<P>(WPARAM) FALSE,                  // redraw flag </P>

<P>(LPARAM) MAKELONG(iSelMin, iSelMax); </P>

<P>SendMessage(hwndTrack, TBM_SETPOS, </P>

<P>(WPARAM) TRUE,                   // redraw flag </P>

<P>(LPARAM) iSelMin); </P>

<P></P>

<P>SetFocus(hwndTrack); </P>

<P></P>

<P>return hwndTrack; </P>

<P>} </P>

</BODY>
</HTML>
