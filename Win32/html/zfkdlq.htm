<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IContextMenu2</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="zfkdlq"></A><B>IContextMenu2  <A HREF="aezfl..htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1erm.gm.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>IContextMenu2</B> interface is used to either create or merge a context menu associated with a certain object when a client of <A HREF="gakt5j.htm"><B>IContextMenu</B></A> is supposed to handle messages associated with owner-drawn menu items.</P>

<P><B>When to Implement</B></P>

<P>Implement <B>IContexMenu2</B> if your object is a client of <B>IContextMenu</B> when owner-drawn messages are an issue: Do so if it is possible to receive one of the following messages while calling <B>TrackPopupMenu</B> in the window procedure of the menu's owner window:</P>

<P>WM_INITPOPUP</P>

<P>WM_DRAWITEM</P>

<P>WM_MEASUREITEM</P>

<P></P>

<P>These messages are sent only if a <B>QueryInterface</B> call for an <B>IContextMenu2</B> interface pointer is successful, indicating that the object supports this interface.</P>

<P><B>When to Use</B></P>

<P>You do not call this interface directly. <B>IContextMenu2</B> is used by the operating system only when it has confirmed that the application is aware of this interface.</P>

<P><B>Methods in Vtable Order</B></P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=46%><B>IUnknown Methods</B></TD>
<TD width=54%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>QueryInterface</B></TD>
<TD width=54%>Returns pointers to supported interfaces.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>AddRef</B></TD>
<TD width=54%>Increments reference count.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>Release</B></TD>
<TD width=54%>Decrements reference count.</TD>
</TR>
</TABLE><BR>

<P></P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=46%><B>IContextMenu2 Methods</B></TD>
<TD width=54%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=46%><A HREF="25teij.htm"><B>QueryContextMenu</B></A></TD>
<TD width=54%>Adds commands to a context menu.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><A HREF="17hmxyc.htm"><B>HandleMenuMsg</B></A></TD>
<TD width=54%>Handles messages related to drawing owner-drawn menu items.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><A HREF="119kgxk.htm"><B>InvokeCommand</B></A></TD>
<TD width=54%>Carries out a menu command, either in response to user input or otherwise. For an example, see <A HREF="5338sx.htm"><B>IExtractIcon</B></A>.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><A HREF=".miojd.htm"><B>GetCommandString</B></A></TD>
<TD width=54%>Retrieves the language-independent name of a menu command or the help text for a menu command.</TD>
</TR>
</TABLE><BR>

<P></P>

</BODY>
</HTML>
