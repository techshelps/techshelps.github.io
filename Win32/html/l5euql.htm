<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>File Parser Requirements</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="l5euql"></A><B>File Parser Requirements</B></P>

<P>Every file parser must implement the following functions.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=48%><A HREF="iu4gzk.htm"><B>VwStreamCloseFunc</B></A></TD>
<TD width=52%><A HREF="1mwr7s8.htm"><B>VwStreamSectionFunc</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=48%><A HREF="1n4mac0.htm"><B>VwStreamOpenFunc</B></A></TD>
<TD width=52%><A HREF="_d1xg_.htm"><B>VwStreamSeekFunc</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=48%><A HREF="22gc0au.htm"><B>VwStreamReadFunc</B></A></TD>
<TD width=52%><A HREF="lvdj.u.htm"><B>VwStreamTellFunc</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=48%><A HREF="f0yv3y.htm"><B>VwStreamReadRecordFunc</B></A></TD>
<TD width=52%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P>The display engine calls these functions to display a file of the type supported by the file parser. </P>

<P>The display engine starts the file viewing process by calling <A HREF="1n4mac0.htm"><B>VwStreamOpenFunc</B></A>, sending the name of a file to the file parser. The first responsibility of any parser is to verify that the given file has the proper format and can be processed. If the file is viewable, the file parser returns a value to the display engine acknowledging the request. </P>

<P>Once the parser completes verification, the display engine calls <A HREF="1mwr7s8.htm"><B>VwStreamSectionFunc</B></A>, directing the file parser to identify the type and name of the first section of the file to be processed. A <I>section</I> is a portion of the file in which all the data is of one type; it forms a logical breaking point for the processing of the file. The standard section types are word processing, spreadsheet, database, bitmapped graphics, and vector graphics. A file can consist of a single section, multiple sections of the same type, or a combination of sections of different types. The actions that the display engine takes to display the file depend on the type of section currently being processed. The file parser must call the <A HREF="425agci.htm"><B>SOPutSectionType</B></A> and <A HREF="l1u1lo.htm"><B>SOPutSectionName</B></A> functions to output the section type and to set the section name. </P>

<P>Before the file parser returns from <B>VwStreamSectionFunc</B>, it may need to provide the display engine with additional information. If the portion to be processed is a word processing section, the file parser must set entries for the font table by using the <A HREF="hzkdm_.htm"><B>SOPutFontTableEntry</B></A> function. If it is a spreadsheet section, the file parser must set the column width by calling the <A HREF="y91t7d.htm"><B>SOPutColumnInfo</B></A> function. If it is a database section, the file parser must set the field format by calling the <A HREF="1uex3tp.htm"><B>SOPutFieldInfo</B></A> function. The file parser can also set the date base used by spreadsheets and databases to calculate dates by using the <A HREF="2ozol8p.htm"><B>SOSetDateBase</B></A> function. In addition, the file parser can set header entries by calling the <A HREF="1.mhlyo.htm"><B>SOPutHdrEntry</B></A> function.</P>

<P>After the section type and general information is set, the display engine requests data for the section by calling <A HREF="22gc0au.htm"><B>VwStreamReadFunc</B></A>. The file parser fulfills this request by calling the stream output functions. These functions pass the data to the display engine in a form that is easiest for the engine to display, copy to the clipboard, or write to disk. </P>

<P>The stream output functions used by the file parser depend on the section type. For word processing sections, the file parser uses the <A HREF="kk_ldh.htm"><B>SOPutParaSpacing</B></A>, <A HREF="5yix.tv.htm"><B>SOPutCharAttr</B></A>, and <A HREF="19e90d8.htm"><B>SOPutChar</B></A> functions to set the spacing for paragraphs, set the style attributes for characters, and output characters. For spreadsheet sections, the parser uses the <A HREF="y1yif2.htm"><B>SOPutDataCell</B></A> and <A HREF="nitakv.htm"><B>SOPutTextCell</B></A> functions to output the content (data or text) of cells. For database sections, it uses the <A HREF="3hp8_wm.htm"><B>SOPutField</B></A> and <A HREF="1nirlyb.htm"><B>SOPutVarField</B></A> functions to output the data of fields. The parser uses the <A HREF="esx875.htm"><B>SOPutBitmapHeader</B></A> and <A HREF="3ny5_iz.htm"><B>SOPutScanLineData</B></A> functions for bitmapped graphics sections and the <A HREF="qv96x9.htm"><B>SOVectorAttr</B></A> and <A HREF="5ujmhn.htm"><B>SOVectorObject</B></A> functions for vector graphics sections.</P>

<P>To set a break for a paragraph, cell, or field, the file parser calls the <A HREF="3hla_lt.htm"><B>SOPutBreak</B></A> function with an appropriate value, either SO_PARABREAK, SO_CELLBREAK, or SO_RECORDBREAK. The return value from <B>SOPutBreak</B> tells the file parser how to proceed. If it is the SO_STOP value, the file parser stops all processing and returns from <A HREF="22gc0au.htm"><B>VwStreamReadFunc</B></A>. </P>

<P>The file parser continues to output data until it reaches the end of the section. The parser must end a section by calling <A HREF="3hla_lt.htm"><B>SOPutBreak</B></A> with the SO_SECTIONBREAK value. If this is the last section in the file, the file parser indicates that the end of the file has been reached by using the SO_EOFBREAK value instead.</P>

<P>If there are subsequent sections in the file, the display engine calls <A HREF="1mwr7s8.htm"><B>VwStreamSectionFunc</B></A> again to request the type and name of the next section, and processing continues just as it did for the first section. </P>

<P>After the last section, the display engine calls <A HREF="iu4gzk.htm"><B>VwStreamCloseFunc</B></A> to indicate that processing is complete and that no further requests for data will be made. The file parser must close the file and any related files it has opened and clean up resources, such as freeing memory.</P>

<P>If an error occurs while a file is parsed, the file parser should call the <A HREF="1mzh7vb.htm"><B>SOBailOut</B></A> function to notify the display engine of the error condition. The parser must immediately return from <A HREF="22gc0au.htm"><B>VwStreamReadFunc</B></A> after calling the <B>SOBailOut</B> function.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
