<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>keybd_event</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="2nixdyc"></A><B>keybd_event  <A HREF="qs1y6o.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1xtfdy5.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="fkf.jh.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>keybd_event</B> function synthesizes a keystroke. The system can use such a synthesized keystroke to generate a <A HREF="1ubr_9n.htm">WM_KEYUP</A> or <A HREF="cxjo_p.htm">WM_KEYDOWN</A> message. The keyboard driver's interrupt handler calls the <B>keybd_event</B> function. </P>

<P><B>VOID keybd_event(</B></P>

<TABLE cols=2 width=463>

<TR VALIGN="top">
<TD width=39%><B>BYTE</B> <I>bVk</I><B>,</B></TD>
<TD width=61%>// virtual-key code</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    BYTE</B> <I>bScan</I><B>,</B></TD>
<TD width=61%>// hardware scan code</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    DWORD</B> <I>dwFlags</I><B>,</B></TD>
<TD width=61%>// flags specifying various function options</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>    DWORD</B> <I>dwExtraInfo</I> </TD>
<TD width=61%>// additional data associated with keystroke</TD>
</TR>

<TR VALIGN="top">
<TD width=39%><B>   );</B></TD>
<TD width=61%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>bVk</I></P>

<P>Specifies a virtual-key code. The code must be a value in the range 1 to 254. </P>

<P><I>bScan</I></P>

<P>Specifies a hardware scan code for the key. </P>

<P><I>dwFlags</I></P>

<P>A set of flag bits that specify various aspects of function operation. An application can use any combination of the following predefined constant values to set the flags: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=46%><B>Value</B></TD>
<TD width=54%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=46%>KEYEVENTF_EXTENDEDKEY</TD>
<TD width=54%>If specified, the scan code was preceded by a prefix byte having the value 0xE0 (224).</TD>
</TR>

<TR VALIGN="top">
<TD width=46%>KEYEVENTF_KEYUP</TD>
<TD width=54%>If specified, the key is being released. If not specified, the key is being depressed.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>dwExtraInfo</I></P>

<P>Specifies an additional 32-bit value associated with the key stroke. </P>

<P></P>

<P><B>Return Values</B></P>

<P>This function has no return value. </P>

<P><B>Remarks</B></P>

<P>Although <B>keybd_event</B> passes an OEM-dependent hardware scan code to Windows, applications should not use the scan code. Windows converts scan codes to virtual-key codes internally and clears the up/down bit in the scan code before passing it to applications. </P>

<P>An application can simulate a press of the PRINTSCREEN key in order to obtain a screen snapshot and save it to the Windows clipboard. To do this, call <B>keybd_event</B> with the <I>bVk</I> parameter set to VK_SNAPSHOT, and the <I>bScan</I> parameter set to 0 for a snapshot of the full screen or set <I>bScan</I> to 1 for a snapshot of the active window. </P>

<P><B>See Also</B></P>

<P><A HREF="581c6d.htm"><B>GetAsyncKeyState</B></A>, <A HREF="gtoqdj.htm"><B>GetKeyState</B></A>, <A HREF="1opldc.htm"><B>MapVirtualKey</B></A>, <A HREF="2snaz5.htm"><B>SetKeyboardState</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
