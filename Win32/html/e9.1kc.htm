<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SetServiceObjectSecurity</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="e9.1kc"></A><B>SetServiceObjectSecurity  <A HREF="3lge455.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="12c8zrk.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="we4jtq.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>SetServiceObjectSecurity</B> function sets the security descriptor of a service object. </P>

<P><B>BOOL SetServiceObjectSecurity(</B></P>

<TABLE cols=2 width=629>

<TR VALIGN="top">
<TD width=56%><B>SC_HANDLE</B> <I>hService</I><B>,</B></TD>
<TD width=44%>// handle of service </TD>
</TR>

<TR VALIGN="top">
<TD width=56%><B>    SECURITY_INFORMATION</B> <I>dwSecurityInformation</I><B>,</B></TD>
<TD width=44%>// type of security information requested  </TD>
</TR>

<TR VALIGN="top">
<TD width=56%><B>    PSECURITY_DESCRIPTOR</B> <I>lpSecurityDescriptor</I> </TD>
<TD width=44%>// address of security descriptor </TD>
</TR>

<TR VALIGN="top">
<TD width=56%><B>   );</B></TD>
<TD width=44%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hService</I></P>

<P>Identifies the service. This handle is returned by the <A HREF="20gsky6.htm"><B>OpenService</B></A> or <A HREF="2wng26.htm"><B>CreateService</B></A> function. The access required for this handle depends on the security information specified in the <I>dwSecurityInformation</I> parameter. </P>

<P><I>dwSecurityInformation</I></P>

<P>Specifies the security information to be set. Any or all of the following flags can be specified: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=57%><B>Value</B></TD>
<TD width=43%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=57%>OWNER_SECURITY_INFORMATION</TD>
<TD width=43%>Sets the object's owner security identifier (SID). The <I>hService</I> handle must have WRITE_OWNER access, or the calling process must be the object's owner.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>GROUP_SECURITY_INFORMATION</TD>
<TD width=43%>Sets the object's primary group SID. The <I>hService</I> handle must have WRITE_OWNER access, or the calling process must be the object's owner.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>DACL_SECURITY_INFORMATION</TD>
<TD width=43%>Sets the object's discretionary access control list (ACL). The <I>hService</I> handle must have WRITE_DAC access, or the calling process must be the object's owner.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>SACL_SECURITY_INFORMATION</TD>
<TD width=43%>Sets the object's system ACL. The calling process must have the SE_SECURITY_NAME privilege. For more information about security privileges, see <A HREF="134kpv4.htm">Privileges</A>. </TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lpSecurityDescriptor</I></P>

<P>Points to a <A HREF="188mr8k.htm"><B>SECURITY_DESCRIPTOR</B></A> structure containing the new security information. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Errors</B></P>

<P>The following error codes may be set by the service control manager. Other error codes may be set by the registry functions that are called by the service control manager. </P>

<TABLE cols=6>

<TR VALIGN="top">
<TD colspan=2 width=11%><B>Value</B></TD>
<TD colspan=3 width=76%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=12%>ERROR_ACCESS_DENIED</TD>
<TD colspan=3 width=88%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=10%>&nbsp;</TD>
<TD colspan=3 width=66%>The specified handle was not opened with the required access, or the calling process is not the owner of the object.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=12%>ERROR_INVALID_HANDLE</TD>
<TD colspan=3 width=88%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=10%>&nbsp;</TD>
<TD colspan=3 width=66%>The specified handle is invalid.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=12%>ERROR_INVALID_PARAMETER</TD>
<TD colspan=3 width=88%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=10%>&nbsp;</TD>
<TD colspan=3 width=66%>The specified security information or security descriptor is invalid.</TD>
</TR>

<TR VALIGN="top">
<TD colspan=3 width=12%>ERROR_SERVICE_MARKED_FOR_DELETE</TD>
<TD colspan=3 width=88%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=10%>&nbsp;</TD>
<TD colspan=3 width=66%>The specified service has been marked for deletion.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>The <B>SetServiceObjectSecurity</B> function sets the specified portions of the service object's security descriptor, based on the information specified in the <I>lpSecurityDescriptor</I> buffer. This function replaces any or all of the security information associated with the service object, according to the flags set in the <I>dwSecurityInformation</I> parameter and subject to the calling process's access rights. </P>

<P>The initial security descriptor of a service object is created by the service control manager, based on the security descriptor of the process that called the <B>CreateService</B> function to create the service. The security descriptor can be changed by calling the <B>SetServiceObjectSecurity</B> function. </P>

<P><B>See Also</B></P>

<P><A HREF="2wng26.htm"><B>CreateService</B></A>, <A HREF="20gsky6.htm"><B>OpenService</B></A>, <A HREF="1f_vgrd.htm"><B>QueryServiceObjectSecurity</B></A>, <A HREF="188mr8k.htm"><B>SECURITY_DESCRIPTOR</B></A> </P>

</BODY>
</HTML>
