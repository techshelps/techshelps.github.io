<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>GetAsyncKeyState</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="581c6d"></A><B>GetAsyncKeyState  <A HREF="7.ru5..htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1xtfdy5.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="fkf.jh.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetAsyncKeyState</B> function determines whether a key is up or down at the time the function is called, and whether the key was pressed after a previous call to <B>GetAsyncKeyState</B>. </P>

<P><B>SHORT GetAsyncKeyState(</B></P>

<TABLE cols=2 width=241>

<TR VALIGN="top">
<TD width=42%><B>int</B> <I>vKey</I> </TD>
<TD width=58%>// virtual-key code</TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>   );</B></TD>
<TD width=58%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>vKey</I></P>

<P>Specifies one of 256 possible virtual-key codes.  </P>

<P><B>Windows NT:</B> You can use left- and right-distinguishing constants to specify certain keys. See the <B>Remarks</B> section for further information.</P>

<P><B>Windows 95:</B> Windows 95 does not support the left- and right-distinguishing constants available on Windows NT.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value specifies whether the key was pressed since the last call to <B>GetAsyncKeyState</B>, and whether the key is currently up or down. If the most significant bit is set, the key is down, and if the least significant bit is set, the key was pressed after the previous call to <B>GetAsyncKeyState</B>. The return value is zero if a window in another thread or process currently has the keyboard focus. </P>

<P><B>Windows 95:</B> Windows 95 does not support the left- and right-distinguishing constants. If you call <B>GetAsyncKeyState</B> on the Windows 95 platform with these constants, the return value is zero. </P>

<P><B>Remarks</B></P>

<P>You can use the virtual-key code constants VK_SHIFT, VK_CONTROL, and VK_MENU as values for the <I>vKey</I> parameter. This gives the state of the SHIFT, CTRL, or ALT keys without distinguishing between left and right. </P>

<P><B>Windows NT:</B> You can use the following virtual-key code constants as values for <I>vKey</I> to distinguish between the left and right instances of those keys: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=25%>VK_LSHIFT</TD>
<TD width=75%>VK_RSHIFT</TD>
</TR>

<TR VALIGN="top">
<TD width=25%>VK_LCONTROL</TD>
<TD width=75%>VK_RCONTROL</TD>
</TR>

<TR VALIGN="top">
<TD width=25%>VK_LMENU</TD>
<TD width=75%>VK_RMENU</TD>
</TR>
</TABLE><BR>

<P></P>

<P>These left- and right-distinguishing constants are only available when you call the <A HREF="126loed.htm"><B>GetKeyboardState</B></A>, <A HREF="2snaz5.htm"><B>SetKeyboardState</B></A>, <B>GetAsyncKeyState</B>, <A HREF="gtoqdj.htm"><B>GetKeyState</B></A>, and <A HREF="1opldc.htm"><B>MapVirtualKey</B></A> functions. </P>

<P><B>Windows 95:</B> Windows 95 does not support the left- and right-distinguishing constants, and returns 0 when you use these constants.</P>

<P>The <B>GetAsyncKeyState</B> function works with mouse buttons. However, it checks on the state of the physical mouse buttons, not on the logical mouse buttons that the physical buttons are mapped to. For example, the call <B>GetAsyncKeyState</B>(VK_LBUTTON) always returns the state of the left physical mouse button, which may mapped to the left or right logical mouse button. You can determine the system's current mapping of physical mouse buttons to logical mouse buttons by calling </P>

<P>GetSystemMetrics(SM_SWAPBUTTON)  </P>

<P></P>

<P>which returns TRUE if the mouse buttons have been swapped.</P>

<P><B>See Also</B></P>

<P><A HREF="126loed.htm"><B>GetKeyboardState</B></A>, <A HREF="gtoqdj.htm"><B>GetKeyState</B></A>, <A HREF="jolchi.htm"><B>GetSystemMetrics</B></A>, <A HREF="1opldc.htm"><B>MapVirtualKey</B></A>, <A HREF="2snaz5.htm"><B>SetKeyboardState</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
