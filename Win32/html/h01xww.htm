<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetClassLong</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="h01xww"></A><B>GetClassLong  <A HREF="1he5ts3.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="2lm.0ad.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="14dadmj.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetClassLong</B> function retrieves the specified 32-bit (long) value from the <A HREF="1onjoi2.htm"><B>WNDCLASS</B></A> structure associated with the specified window. </P>

<P><B>DWORD GetClassLong(</B></P>

<TABLE cols=2 width=327>

<TR VALIGN="top">
<TD width=41%><B>HWND</B> <I>hWnd</I><B>,</B></TD>
<TD width=59%>// handle of window</TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    int</B> <I>nIndex</I> </TD>
<TD width=59%>// offset of value to retrieve </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>   );</B></TD>
<TD width=59%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hWnd</I></P>

<P>Identifies the window and, indirectly, the class to which the window belongs. </P>

<P><I>nIndex</I></P>

<P>Specifies the 32-bit value to retrieve. To retrieve a 32-bit value from the extra class memory, specify the positive, zero-based byte offset of the value to be retrieved. Valid values are in the range zero through the number of bytes of extra class memory, minus four; for example, if you specified 12 or more bytes of extra class memory, a value of 8 would be an index to the third 32-bit integer. To retrieve any other value from the <B>WNDCLASS</B> structure, specify one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=41%><B>Value</B></TD>
<TD width=59%><B>Action</B></TD>
</TR>

<TR VALIGN="top">
<TD width=41%>GCW_ATOM</TD>
<TD width=59%>Retrieves an <B>ATOM</B> value that uniquely identifies the window class. This is the same atom that the <B>RegisterClass</B> function returns.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>GCL_CBCLSEXTRA</TD>
<TD width=59%>Retrieves the size, in bytes, of the extra memory associated with the class.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>GCL_CBWNDEXTRA</TD>
<TD width=59%>Retrieves the size, in bytes, of the extra window memory associated with each window in the class. For information on how to access this memory, see  <A HREF="vb50yw.htm"><B>GetWindowLong</B></A> and <A HREF="1hkl0j9.htm"><B>GetWindowWord</B></A> .</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>GCL_HBRBACKGROUND</TD>
<TD width=59%>Retrieves the handle of the background brush associated with the class.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>GCL_HCURSOR</TD>
<TD width=59%>Retrieves the handle of the cursor associated with the class.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>GCL_HICON</TD>
<TD width=59%>Retrieves the handle of the icon associated with the class.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>GCL_HICONSM</TD>
<TD width=59%>Retrieves the handle of the small icon associated with the class.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>GCL_HMODULE</TD>
<TD width=59%>Retrieves the handle of the module that registered the class.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>GCL_MENUNAME</TD>
<TD width=59%>Retrieves the address of the menu name string. The string identifies the menu resource associated with the class.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>GCL_STYLE</TD>
<TD width=59%>Retrieves the window-class style bits.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>GCL_WNDPROC</TD>
<TD width=59%>Retrieves the address of the window procedure associated with the class.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is the requested 32-bit value.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>Reserve extra class memory by specifying a nonzero value in the <B>cbClsExtra</B> member of the <B>WNDCLASS</B> structure used with the <B>RegisterClass</B> function. </P>

<P><B>See Also</B></P>

<P><A HREF="10chxh9.htm"><B>GetClassWord</B></A>, <A HREF="vb50yw.htm"><B>GetWindowLong</B></A>, <A HREF="1hkl0j9.htm"><B>GetWindowWord</B></A>, <A HREF="6v_00hu.htm"><B>RegisterClass</B></A>, <A HREF="61hh_k6.htm"><B>SetClassLong</B></A>, <A HREF="61hs_o3.htm"><B>SetClassWord</B></A>, <A HREF="1onjoi2.htm"><B>WNDCLASS</B></A> </P>

</BODY>
</HTML>
