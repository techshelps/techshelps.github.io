<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SleepEx</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="fmres8"></A><B>SleepEx  <A HREF="gjg90..htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="glns2h.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="7wnz9r.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>SleepEx</B> function causes the current thread to enter a wait state until one of the following occurs: </P>

<P>·An I/O completion callback function is called</P>

<P>·An asynchronous procedure call (APC) is queued to the thread.</P>

<P>·The time-out interval elapses</P>

<P></P>

<P><B>DWORD SleepEx(</B></P>

<TABLE cols=2 width=435>

<TR VALIGN="top">
<TD width=46%><B>DWORD</B> <I>dwMilliseconds</I><B>,</B></TD>
<TD width=54%>// time-out interval in milliseconds  </TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    BOOL</B> <I>bAlertable</I> </TD>
<TD width=54%>// early completion flag </TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>   );</B></TD>
<TD width=54%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>dwMilliseconds</I></P>

<P>Specifies the time, in milliseconds, that the delay is to occur. A value of zero causes the function to return immediately. A value of INFINITE causes an infinite delay. </P>

<P><I>bAlertable</I></P>

<P>Specifies whether the function may terminate early due to an I/O completion callback function or an APC. If <I>bAlertable</I> is FALSE, the function does not return until the time-out period has elapsed. If an I/O completion callback occurs, the function does not return and the I/O completion function is not executed. If an APC is queued to the thread, the function does not return and the APC function is not executed.</P>

<P>If <I>bAlertable</I> is TRUE and the thread that called this function is the same thread that called the extended I/O function (<A HREF="fm7wz7.htm"><B>ReadFileEx</B></A> or <A HREF="12g2wey.htm"><B>WriteFileEx</B></A>), the function returns when either the time-out period has elapsed or when an I/O completion callback function occurs. If an I/O completion callback occurs, the I/O completion function is called. If an APC is queued to the thread (<A HREF="kja6pw.htm"><B>QueueUserAPC</B></A>), the function returns when either the timer-out period has elapsed or when the APC function is called.</P>

<P></P>

<P><B>Return Values</B></P>

<P>The return value is zero if the specified time interval expired. </P>

<P>The return value is WAIT_IO_COMPLETION if the function returned due to one or more I/O completion callback functions. This can happen only if <I>bAlertable</I> is TRUE, and if the thread that called the <B>SleepEx</B> function is the same thread that called the extended I/O function. </P>

<P><B>Remarks</B></P>

<P>This function can be used with the <B>ReadFileEx</B> or <B>WriteFileEx</B> functions to suspend a thread until an I/O operation has been completed. These functions specify a completion routine that is to be executed when the I/O operation has been completed. For the completion routine to be executed, the thread that called the I/O function must be in an alertable wait state when the completion callback function occurs. A thread goes into an alertable wait state by calling either <B>SleepEx</B>, <A HREF="14gl8uz.htm"><B>MsgWaitForMultipleObjectsEx</B></A>, <A HREF="aqe6qk.htm"><B>WaitForSingleObjectEx</B></A>, or <A HREF="1xsv84l.htm"><B>WaitForMultipleObjectsEx</B></A>, with the function's <I>bAlertable</I> parameter set to TRUE. </P>

<P>A thread can relinquish the remainder of its time slice by calling this function with a sleep time of zero milliseconds. </P>

<P>You have to be careful when using <B>SleepEx</B> and DDE. If a thread creates any windows, it must process messages. DDE sends messages to all windows in the system. If you have a thread that uses a wait function with no time-out interval, the system will deadlock. Therefore, if you have a thread that creates windows, use <B>MsgWaitForMultipleObjects</B> or <B>MsgWaitForMultipleObjectsEx</B>, rather than <B>SleepEx</B>.</P>

<P><B>See Also</B></P>

<P><A HREF="12rbmac.htm"><B>MsgWaitForMultipleObjects</B></A>, <A HREF="14gl8uz.htm"><B>MsgWaitForMultipleObjectsEx</B></A>, <A HREF="kja6pw.htm"><B>QueueUserAPC</B></A>, <A HREF="fm7wz7.htm"><B>ReadFileEx</B></A>, <A HREF="4ra3...htm"><B>Sleep</B></A>, <A HREF="1xsv84l.htm"><B>WaitForMultipleObjectsEx</B></A>, <A HREF="aqe6qk.htm"><B>WaitForSingleObjectEx</B></A>, <A HREF="12g2wey.htm"><B>WriteFileEx</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
