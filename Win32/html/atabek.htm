<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Spreadsheet Sections</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="atabek"></A><B>Spreadsheet<I> </I>Sections</B></P>

<P>The file parser outputs content (data or text) for cells in a spreadsheet by using the <A HREF="y1yif2.htm"><B>SOPutDataCell</B></A> and <A HREF="nitakv.htm"><B>SOPutTextCell</B></A> functions. Before outputting cell data, the file parser must get the range of columns to be output by using the <A HREF="m.z0ky.htm"><B>SOGetInfo</B></A> function with the SOINFO_COLUMNRANGE value. When <B>SOGetInfo</B> returns, the low-order word of its <I>pInfo</I> parameter identifies the first column of data to generate output for, and the high-order word identifies the last column. The file parser should only call <B>SOPutDataCell</B> or <B>SOPutTextCell</B> for cells within the range indicated by a call to <B>SOGetInfo</B>. When there is no more data within a range of columns, the file parser must call the <A HREF="3hla_lt.htm"><B>SOPutBreak</B></A> function with either the SO_EOFBREAK or SO_SECTIONBREAK value, whichever applies. This must be done for each range of columns in the document.</P>

<P>For example, if the first column is 10 and the last column is 19, the filter reads the file from its current position, but it only calls <B>SOPutDataCell</B> or <B>SOPutTextCell</B> for cells that belong in columns 10 through column 19, inclusively. (Column numbers are zero based.) The parser skips over cells that belong in columns outside of this range. The filter must produce cells for <I>all</I> columns in the range, filling in with empty cells, if necessary. As before, the filter continues until <B>SOPutBreak</B> returns the SO_STOP value.</P>

<P>In general, the file parser should carry out the following steps:</P>

<P>1.Determine the desired range of columns.</P>

<P>2.Determine the next cell available from the input file.</P>

<P>3.If the cell is not in the given range of columns, jump to step 2. </P>

<P>4.If the cell is not empty, call <A HREF="y1yif2.htm"><B>SOPutDataCell</B></A> or <A HREF="nitakv.htm"><B>SOPutTextCell</B></A> with the current data. Otherwise, call <B>SOPutDataCell</B> for a cell of the SO_CELLEMPTY type.</P>

<P>5.Update local variables, such as row and column numbers.</P>

<P>6.Call <A HREF="3hla_lt.htm"><B>SOPutBreak</B></A> with the SO_CELLBREAK value. </P>

<P>7.If <B>SOPutBreak</B> returns the SO_STOP value, return from the <A HREF="22gc0au.htm"><B>VwStreamReadFunc</B></A> function.</P>

<P>8.If at the beginning of the next section, call <A HREF="3hla_lt.htm"><B>SOPutBreak</B></A> with the SO_SECTIONBREAK value and return.</P>

<P>9.If at the end of the file, call <B>SOPutBreak</B> with the SO_EOFBREAK value and return.</P>

<P>10.Repeat steps 2 through 10.</P>

<P></P>

<P>When the chunker saves local data for various seek positions in a document, it does so within <A HREF="3hla_lt.htm"><B>SOPutBreak</B></A>, when the break is of the SO_CELLBREAK type. Thus, when a file parser has its local data restored for a random seek position, the data will reflect the state of the file parser during its call to <B>SOPutBreak</B> for the last cell of the previous chunk in the current range of cells. Any tracking done by the parser, such as the current row number, should be updated before <B>SOPutBreak</B> is called for each cell.</P>

<P>Every horizontal range of columns, specified by <I>dwExtraData</I> in each call to your <A HREF="22gc0au.htm"><B>VwStreamReadFunc</B></A> function, must eventually be terminated by a call to <B>SOPutBreak</B> with SO_EOFBREAK or SO_SECTIONBREAK value, whichever is applicable. The type of break depends on the input file. A file parser must not put a section break at the end of the file, and an end-of-file (EOF) break, of course, cannot occur anywhere but at the actual end of the file.</P>

<P>For example, if the input document contains a single spreadsheet that is 30 columns wide, the display engine can call the parser with three different ranges of columns: 0 to 11, 12 to 23, and 24 to 29. The file parser calls <A HREF="3hla_lt.htm"><B>SOPutBreak</B></A> with an EOF break three times, once for each time it reaches the end of the file while processing a given range.</P>

<P>When calling <B>SOPutBreak</B> with a section break, the file parser must be sure that the seek position is at the beginning of the next section ¾ that is, the file position where the file parser needs to be when <A HREF="1mwr7s8.htm"><B>VwStreamSectionFunc</B></A> is next called. Any one of the calls to <B>SOPutBreak</B> for a section break may be the one that sets the seek position for the top of the next section.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
