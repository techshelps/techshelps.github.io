<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>SnmpMgrOpen</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1nc72.p"></A><B>SnmpMgrOpen  <A HREF="2cuo_kz.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="3ol8_pd.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="qj0.0j.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>SnmpMgrOpen</B> function initializes communications sockets and data structures, allowing communications with the specified agent.</P>

<P><B>LPSNMP_MGR_SESSION SnmpMgrOpen(</B></P>

<TABLE cols=2 width=515>

<TR VALIGN="top">
<TD width=45%><B>LPSTR</B> <I>lpAgentAddress</I><B>,</B> </TD>
<TD width=55%>// name and address of target SNMP agent</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    LPSTR</B> <I>lpAgentCommunity</I><B>,</B> </TD>
<TD width=55%>// community for target SNMP agent</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    INT</B> <I>nTimeOut</I><B>,</B> </TD>
<TD width=55%>// communication time-out in milliseconds</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    INT</B> <I>nRetries</I></TD>
<TD width=55%>// communication time-out or retry count</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>   );</B></TD>
<TD width=55%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpAgentAddress</I></P>

<P>[in] Points to a null-terminated string specifying either a dotted-decimal IP address or a host name that can be resolved to an IP address, an IPX address (in 8.12 notation), or an ethernet address.</P>

<P><I>lpAgentCommunity</I></P>

<P>[in] Points to a null-terminated string specifying the SNMP community name used when communicating with the agent specified in the <I>lpAgentAddress</I> parameter.</P>

<P><I>nTimeOut</I></P>

<P>[in] Specifies the communications time-out in milliseconds.</P>

<P><I>nRetries</I></P>

<P>[in] Specifies the communications retry count. The time-out specified in the <I>nTimeOut</I> parameter is doubled each time a retry attempt is transmitted.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is a pointer to an <B>LPSNMP_MGR_SESSION</B> structure. This structure is used internally and the programmer should not alter it. </P>

<P>If the function fails, the return value is NULL. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. <B>GetLastError</B> may return the SNMP_MEM_ALLOC_ERROR error code, which indicates a memory allocation error.</P>

<P>This function may also return Windows Sockets error codes.</P>

<P>The name and address of the SNMP target, or the string pointed to by the <I>lpAgentAddress </I>parameter, should conform to one of the following forms:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=49%><B>Name/Address</B></TD>
<TD width=51%><B>Form (example)</B></TD>
</TR>

<TR VALIGN="top">
<TD width=49%>IP Address</TD>
<TD width=51%>157.57.8.160</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>IP Hostname</TD>
<TD width=51%>merlin.microsoft.com</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>Ethernet Address</TD>
<TD width=51%>00aa00bbccdd</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>IPX Address</TD>
<TD width=51%>00006112.00aa00bbccdd</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>Names can be provided for agents only if TCP/IP is loaded and the names are TCP/IP host names. NetBIOS names cannot be supplied for IPX hosts.</P>

<P><B>See Also </B></P>

<P><A HREF="2htm7_.htm"><B>SnmpMgrClose</B></A>, <A HREF="21cd0w5.htm"><B>SnmpMgrRequest</B></A></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
