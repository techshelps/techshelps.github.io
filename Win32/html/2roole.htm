<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetGlyphOutline</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="2roole"></A><B>GetGlyphOutline  <A HREF="1tkn61.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="4jd_z5i.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1xkvu5n.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetGlyphOutline</B> function retrieves the outline or bitmap for a character in the TrueType font that is selected into the specified device context. </P>

<P><B>DWORD GetGlyphOutline(</B></P>

<TABLE cols=2 width=501>

<TR VALIGN="top">
<TD width=40%><B>HDC</B> <I>hdc</I><B>,</B></TD>
<TD width=60%>// handle of device context </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    UINT</B> <I>uChar</I><B>,</B></TD>
<TD width=60%>// character to query </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    UINT</B> <I>uFormat</I><B>,</B></TD>
<TD width=60%>// format of data to return </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    LPGLYPHMETRICS</B> <I>lpgm</I><B>,</B></TD>
<TD width=60%>// address of structure for metrics </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    DWORD</B> <I>cbBuffer</I><B>,</B></TD>
<TD width=60%>// size of buffer for data </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    LPVOID</B> <I>lpvBuffer</I><B>,</B></TD>
<TD width=60%>// address of buffer for data </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    CONST MAT2</B> <I>*lpmat2</I> </TD>
<TD width=60%>// address of transformation matrix structure  </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>   );</B></TD>
<TD width=60%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hdc</I></P>

<P>Identifies the device context. </P>

<P><I>uChar</I></P>

<P>Specifies the character for which data is to be returned. </P>

<P><I>uFormat</I></P>

<P>Specifies the format of the data that the function retrieves. Use one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%><B>Value</B></TD>
<TD width=67%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=33%>GGO_BITMAP</TD>
<TD width=67%>The function retrieves the glyph bitmap. For information about memory allocation, see the following Remarks section.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>GGO_NATIVE</TD>
<TD width=67%>The function retrieves the curve data points in the rasterizer's native format and uses the font's design units. When this value is specified, any transformation specified in the <I>lpMatrix</I> parameter is ignored.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>GGO_METRICS</TD>
<TD width=67%>The function only retrieves the <A HREF="1iyvxs0.htm"><B>GLYPHMETRICS</B></A> structure specified by <I>lpgm</I>. The other buffers are ignored. This value affects the meaning of the function's return value upon failure; see the following Return Value section.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>GGO_GRAY2_BITMAP</TD>
<TD width=67%>The function retrieves a glyph bitmap that contains 5 levels of gray.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>GGO_GRAY4_BITMAP</TD>
<TD width=67%>The function retrieves a glyph bitmap that contains 17 levels of gray.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>GGO_GRAY8_BITMAP</TD>
<TD width=67%>The function retrieves a glyph bitmap that contains 65 levels of gray.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>Note that, for the GGO_GRAYn_BITMAP values, the function retrieves a glyph bitmap that contains n^2+1 (n squared plus one) levels of gray. </P>

<P><I>lpgm</I></P>

<P>Points to the <A HREF="1iyvxs0.htm"><B>GLYPHMETRICS</B></A> structure describing the placement of the glyph in the character cell.</P>

<P><I>cbBuffer</I></P>

<P>Specifies the size of the buffer where the function is to copy information about the outline character. If this value is zero, the function returns the required size of the buffer. </P>

<P><I>lpvBuffer</I></P>

<P>Points to the buffer where the function is to copy information about the outline character. If this value is NULL, the function returns the required size of the buffer. </P>

<P><I>lpmat2</I></P>

<P>Points to a <A HREF="lm..au.htm"><B>MAT2</B></A> structure specifying a transformation matrix for the character.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If GGO_BITMAP, GGO_GRAY2_BITMAP, GGO_GRAY4_BITMAP, GGO_GRAY8_BITMAP, or GGO_NATIVE is specified and the function succeeds, the return value is greater than zero; otherwise, the return value is GDI_ERROR. If one of these flags is specified and the buffer size or address is zero, the return value specifies the required buffer size, in bytes. </P>

<P>If GGO_METRICS is specified and the function fails, the return value is GDI_ERROR. </P>

<P><B>Remarks</B></P>

<P>The glyph outline returned by the <B>GetGlyphOutline</B> function is for a grid-fitted glyph. (A grid-fitted glyph is a glyph that has been modified so that its bitmapped image conforms as closely as possible to the original design of the glyph.) If an application needs an unmodified glyph outline, it can request the glyph outline for a character in a font whose size is equal to the font's em unit. The value for a font's em unit is stored in the <B>otmEMSquare</B> member of the <B>OUTLINETEXTMETRIC</B> structure. </P>

<P>The glyph bitmap returned by <B>GetGlyphOutline</B> when GGO_BITMAP is specified is a doubleword-aligned, row-oriented, monochrome bitmap. When GGO_GRAY2_BITMAP is specified, the bitmap returned is a doubleword-aligned, row-oriented array of bytes whose values range from 0 to 4. When GGO_GRAY4_BITMAP is specified, the bitmap returned is a doubleword-aligned, row-oriented array of bytes whose values range from 0 to 16. When GGO_GRAY8_BITMAP is specified, the bitmap returned is a doubleword-aligned, row-oriented array of bytes whose values range from 0 to 255.</P>

<P>An application can rotate characters retrieved in bitmap format by specifying a 2-by-2 transformation matrix in the <I>lpMatrix</I> parameter. </P>

<P><B>See Also</B></P>

<P><A HREF="51w_g_.htm"><B>FORM_INFO_1</B></A>, <A HREF="31gl__r.htm"><B>GetOutlineTextMetrics</B></A>, <A HREF="1iyvxs0.htm"><B>GLYPHMETRICS</B></A>, <A HREF="lm..au.htm"><B>MAT2</B></A>, <A HREF="ca9ocg.htm"><B>OUTLINETEXTMETRIC</B></A>, <A HREF="44vp0_.htm"><B>POINT</B></A> </P>

</BODY>
</HTML>
