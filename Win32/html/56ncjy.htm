<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ImmGetProperty [Now Supported on Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="56ncjy"></A><B>ImmGetProperty  <A HREF="1oh3gp7.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="f6b9jb.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1dp6_6o.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>[Now Supported on Windows NT]</P>

<P>The <B>ImmGetProperty</B> function gets the property and capabilities of the IME associated with the specified keyboard layout.</P>

<P><B>BOOL ImmGetProperty(</B></P>

<TABLE cols=2 width=193>

<TR VALIGN="top">
<TD width=82%><B>HKL</B> <I>hKL</I><B>, </B></TD>
<TD width=18%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=82%><B>    DWORD</B> <I>fdwIndex</I></TD>
<TD width=18%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=82%><B>   );</B></TD>
<TD width=18%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hKL</I></P>

<P>Handle to the keyboard layout. </P>

<P><I>fdwIndex</I></P>

<P>Type of property information to retrieve. This parameter can be one of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=38%><B>Value</B></TD>
<TD width=62%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=38%>IGP_PROPERTY</TD>
<TD width=62%>Property information. </TD>
</TR>

<TR VALIGN="top">
<TD width=38%>IGP_CONVERSION</TD>
<TD width=62%>Conversion capabilities.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>IGP_SENTENCE</TD>
<TD width=62%>Sentence mode capabilities.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>IGP_UI</TD>
<TD width=62%>User interface capabilities.  </TD>
</TR>

<TR VALIGN="top">
<TD width=38%>IGP_SETCOMPSTR</TD>
<TD width=62%>Composition string capabilities.  </TD>
</TR>

<TR VALIGN="top">
<TD width=38%>IGP_SELECT</TD>
<TD width=62%>Selection inheritance capabilities.  </TD>
</TR>

<TR VALIGN="top">
<TD width=38%>IGP_GETIMEVERSION</TD>
<TD width=62%>Retrieves the Windows version number for which the specified IME was created.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>Returns the property or capability value, depending on the value of the <I>dwIndex</I> parameter. If <I>dwIndex</I> is IGP_PROPERTY, returns a combination of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=56%><B>Value</B></TD>
<TD width=44%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=56%>IME_PROP_AT_CARET</TD>
<TD width=44%>If set, conversion window is at the caret position. If clear, the window is near caret position.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>IME_PROP_SPECIAL_UI</TD>
<TD width=44%>If set, IME has a nonstandard user interface. The application should not draw in the IME window.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>IME_PROP_CANDLIST_START_FROM_1</TD>
<TD width=44%>If set, strings in the candidate list are numbered starting at 1. If clear, strings start at 0.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>IME_PROP_UNICODE</TD>
<TD width=44%>If set, strings for the input context have Unicode characters. If clear, strings have single and double-byte characters.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>If <I>dwIndex</I> is IGP_UI, the return value is a combination of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=30%><B>Value</B></TD>
<TD width=70%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=30%>UI_CAP_2700</TD>
<TD width=70%>Supports text escapement values of 0 or 2700.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>UI_CAP_ROT90</TD>
<TD width=70%>Supports text escapement values of 0, 900, 1800, or 2700.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>UI_CAP_ROTANY</TD>
<TD width=70%>Supports any text escapement value.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>If <I>dwIndex</I> is IGP_SETCOMPSTR, the return value is a combination of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=35%><B>Value</B></TD>
<TD width=65%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SCS_CAP_COMPSTR</TD>
<TD width=65%>Can create the composition string by using the SCS_SETSTR value of the <A HREF="97p6ps.htm"><B>ImmSetCompositionString</B></A> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>SCS_CAP_MAKEREAD</TD>
<TD width=65%>Can create the reading string from corresponding composition string when using the SCS_SETSTR value of the <B>ImmSetCompositionString</B> function. </TD>
</TR>
</TABLE><BR>

<P></P>

<P>If <I>dwIndex</I> is IGP_SELECT, the return value is a combination of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=41%><B>Value</B></TD>
<TD width=59%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=41%>SELECT_CAP_CONVMODE</TD>
<TD width=59%>Inherits conversion mode when a new IME is selected.</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>SELECT_CAP_SENTENCE</TD>
<TD width=59%>Inherits sentence mode when a new IME is selected.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>If <I>dwIndex</I> is IGP_GETIMEVERSION, the return value is one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=40%><B>Value</B></TD>
<TD width=60%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=40%>IMEVER_0310</TD>
<TD width=60%>The IME was created for Windows 3.1</TD>
</TR>

<TR VALIGN="top">
<TD width=40%>IMEVER_0400</TD>
<TD width=60%>The IME was created for Windows 95.</TD>
</TR>
</TABLE><BR>

<P></P>

<P></P>

<P></P>

</BODY>
</HTML>
