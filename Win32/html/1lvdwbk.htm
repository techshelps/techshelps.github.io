<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>LB_INITSTORAGE</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1lvdwbk"></A><B>LB_INITSTORAGE  <A HREF="4cb5zk.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="jed1ar.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="lbmspj.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>Allocates memory for storing list box items. An application sends this message before adding a large number of items to a list box.</P>

<P>LB_INITSTORAGE  </P>

<P>wParam = (WPARAM) (int) cItems;  // number of items to add  </P>

<P>lParam = (LPARAM) (DWORD) cb;   // amount of memory to allocate, in bytes  </P>

<P></P>

<P><B>Parameters</B></P>

<P><I>cItems</I></P>

<P>Specifies the number of items to add.</P>

<P><B>Windows 95:</B> The <I>wParam</I> parameter is limited to 16-bit values. This means list boxes cannot contain more than 32,767 items. Although the number of items is restricted, the total size in bytes of the items in a listbox is limited only by available memory.</P>

<P><I>cb</I></P>

<P>Specifies the amount of memory, in bytes, to allocate for item strings.</P>

<P></P>

<P><B>Return Values</B></P>

<P>The return value is the maximum number of items that the memory object can store before another memory reallocation is needed, if successful. It is LB_ERRSPACE if not enough memory is available.</P>

<P><B>Remarks</B></P>

<P><B>Windows 95:</B> This message helps speed up the initialization of list boxes that have a large number of items (more than 100). It reserves the specified amount of memory so that subsequent LB_ADDSTRING, LB_INSERTSTRING, LB_DIR, and LB_ADDFILE messages take the shortest possible time. You can use estimates for the <I>cItems</I> and <I>cb</I> parameters. If you overestimate, the extra memory is allocated; if you underestimate, the normal allocation is used for items that exceed the requested amount. </P>

<P><B>Windows NT:</B> This message is not needed on Windows NT. It does not reserve the specified amount of memory, because available memory is virtually unlimited. The return value is always the value specified in the <I>cItems</I> parameter. </P>

<P><B>See Also</B></P>

<P><A HREF="7dda9t.htm">LB_ADDFILE</A>, <A HREF="aidyjg.htm">LB_ADDSTRING</A>, <A HREF="gu9_uh.htm">LB_DIR</A>, <A HREF="drll5i.htm">LB_INSERTSTRING</A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
