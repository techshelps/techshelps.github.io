<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Sharing Files and Memory</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="18g.yrv"></A><B>Sharing Files and Memory</B></P>

<P>File mapping can be used to share a file or memory between two or more processes. To share a file or memory, all of the processes must use the name or the handle of the <I>same</I> file-mapping object. </P>

<P>To share a file, the first process creates or opens a file by using the <A HREF="xn35yd.htm"><B>CreateFile</B></A> function. Next, it creates a file-mapping object by using the <A HREF="3lck_3.htm"><B>CreateFileMapping</B></A> function, specifying the file handle and a name for the file-mapping object. The names of event, semaphore, mutex, and file-mapping objects share the same name space. Therefore, the <B>CreateFileMapping </B>and <A HREF="68g5u2.htm"><B>OpenFileMapping</B></A> functions fail if they specify a name that is in use by an object of another type.</P>

<P>To share memory that is not associated with a file, a process must use the <B>CreateFileMapping</B> function and specify (HANDLE)0xFFFFFFFF as the <I>hfile</I> parameter instead of an existing file handle. The corresponding file-mapping object accesses memory backed by the system paging file. You must specify a size greater than zero when you specify an <I>hfile</I> of (HANDLE)0xFFFFFFFF in a call to <B>CreateFileMapping</B>. </P>

<P>The easiest way for other processes to obtain a handle of the file-mapping object created by the first process is to use the <A HREF="68g5u2.htm"><B>OpenFileMapping</B></A> function and specify the object's name. This is referred to as <I>named shared memory</I>. If the file-mapping object does not have a name, the process must obtain a handle to it through inheritance or duplication. For more information on inheritance and duplication, see <A HREF="glns2h.htm">Processes and Threads</A> and <A HREF="20rnkvp.htm">Handles and Objects</A>. </P>

<P>Processes that share files or memory must create file views by using the <A HREF="2a9rvat.htm"><B>MapViewOfFile</B></A> or <A HREF="26u8i2.htm"><B>MapViewOfFileEx</B></A> function. They must coordinate their access using semaphores, mutexes, events, or some other mutual exclusion technique. For more information, see <A HREF="36dp5f5.htm">Synchronization</A>. </P>

<P>A shared file-mapping object will not be destroyed until all processes that use it close their handles to it by using the <A HREF="ngwwie.htm"><B>CloseHandle</B></A> function.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
