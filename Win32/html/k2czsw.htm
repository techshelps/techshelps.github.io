<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>GetWindowTextLength</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="k2czsw"></A><B>GetWindowTextLength  <A HREF="1eh0dy5.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1p1lg2i.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="3fix.ad.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetWindowTextLength</B> function retrieves the length, in characters, of the specified window's title bar text (if the window has a title bar). If the specified window is a control, the function retrieves the length of the text within the control. </P>

<P><B>int GetWindowTextLength(</B></P>

<TABLE cols=2 width=389>

<TR VALIGN="top">
<TD width=34%><B>HWND</B> <I>hWnd</I> </TD>
<TD width=66%>// handle of window or control with text</TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>   );</B></TD>
<TD width=66%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hWnd</I></P>

<P>Identifies the window or control. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is the length, in characters, of the text. Under certain conditions, this value may actually be greater than the length of the text. For more information, see the following Remarks section.</P>

<P>If the window has no text, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>This function causes a <A HREF="16t.gdk.htm">WM_GETTEXTLENGTH</A> message to be sent to the specified window or control. </P>

<P>Under certain conditions, the <B>GetWindowTextLength </B>function may return a value that is larger than the actual length of the text. This occurs with certain mixtures of ANSI and Unicode, and is due to the operating system allowing for the possible existence of DBCS characters within the text. The return value, however, will always be at least as large as the actual length of the text; you can thus always use it to guide buffer allocation. This behavior can occur when an application uses both ANSI functions and common dialogs, which use Unicode. It can also occur when an application uses the ANSI flavor of <B>GetWindowTextLength</B> with a window whose window procedure is Unicode, or the Unicode flavor with a window whose window procedure is ANSI. </P>

<P>To obtain the exact length of the text, use the <B>WM_GETTEXT</B>, <B>LB_GETTEXT</B>, or <B>CB_GETLBTEXT</B> messages, or the <B>GetWindowText</B> function.</P>

<P><B>See Also</B></P>

<P><A HREF="ibsg8m.htm">CB_GETLBTEXT</A>, <A HREF="9911lt.htm"><B>GetWindowText</B></A>, <A HREF="3w.ajt.htm">LB_GETTEXT</A>, <A HREF="d2wat4.htm"><B>SetWindowText</B></A>, <A HREF="g5lbj5.htm">WM_GETTEXT</A>, <A HREF="16t.gdk.htm">WM_GETTEXTLENGTH</A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
