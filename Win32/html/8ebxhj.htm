<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CONVINFO</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="8ebxhj"></A><B>CONVINFO  <A HREF="x.eq9z.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="7m.xby.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1.7pmrk.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>CONVINFO</B> structure contains information about a DDE conversation. </P>

<P>typedef struct tagCONVINFO {  // ci  </P>

<P>DWORD       cb; </P>

<P>DWORD       hUser; </P>

<P>HCONV       hConvPartner; </P>

<P>HSZ         hszSvcPartner; </P>

<P>HSZ         hszServiceReq; </P>

<P>HSZ         hszTopic; </P>

<P>HSZ         hszItem; </P>

<P>UINT        wFmt; </P>

<P>UINT        wType; </P>

<P>UINT        wStatus; </P>

<P>UINT        wConvst; </P>

<P>UINT        wLastError; </P>

<P>HCONVLIST   hConvList; </P>

<P>CONVCONTEXT ConvCtxt; </P>

<P>HWND        hwnd; </P>

<P>HWND        hwndPartner; </P>

<P>} CONVINFO; </P>

<P></P>

<P><B>Members</B></P>

<P><B>cb</B></P>

<P>Specifies the structure's size, in bytes. </P>

<P><B>hUser</B></P>

<P>Identifies application-defined data. </P>

<P><B>hConvPartner</B></P>

<P>Identifies the partner application in the DDE conversation. This member is zero if the partner has not registered itself (using the <A HREF="1_pfuxk.htm"><B>DdeInitialize</B></A> function) to make DDE Management Library (DDEML) function calls. An application should not pass this member to any DDEML function except <A HREF="14336h1.htm"><B>DdeQueryConvInfo</B></A>. </P>

<P><B>hszSvcPartner</B></P>

<P>Identifies the service name of the partner application. </P>

<P><B>hszServiceReq</B></P>

<P>Identifies the service name of the server application that was requested for connection. </P>

<P><B>hszTopic</B></P>

<P>Identifies the name of the requested topic. </P>

<P><B>hszItem</B></P>

<P>Identifies the name of the requested item. This member is transaction specific. </P>

<P><B>wFmt</B></P>

<P>Specifies the format of the data being exchanged. This member is transaction specific. </P>

<P><B>wType</B></P>

<P>Specifies the type of the current transaction. This member is transaction specific; it can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=45%><B>Value</B></TD>
<TD width=55%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%>XTYP_ADVDATA</TD>
<TD width=55%>Informs a client that advise data from a server has arrived.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>XTYP_ADVREQ</TD>
<TD width=55%>Requests a server to send updated data to the client during an advise loop. This transaction results when the server calls <A HREF="157gwjy.htm"><B>DdePostAdvise</B></A>.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>XTYP_ADVSTART</TD>
<TD width=55%>Requests a server to begin an advise loop with a client.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>XTYP_ADVSTOP</TD>
<TD width=55%>Notifies a server that an advise loop is stopping.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>XTYP_CONNECT</TD>
<TD width=55%>Requests a server to establish a conversation with a client.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>XTYP_CONNECT_CONFIRM</TD>
<TD width=55%>Notifies a server that a conversation with a client has been established.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>XTYP_DISCONNECT</TD>
<TD width=55%>Notifies a server that a conversation has terminated.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>XTYP_EXECUTE</TD>
<TD width=55%>Requests a server to execute a command sent by a client.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>XTYP_MONITOR</TD>
<TD width=55%>Notifies an application registered as APPCMD_MONITOR that DDE data is being transmitted.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>XTYP_POKE</TD>
<TD width=55%>Requests a server to accept unsolicited data from a client.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>XTYP_REGISTER</TD>
<TD width=55%>Notifies other DDEML applications that a server has registered a service name.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>XTYP_REQUEST</TD>
<TD width=55%>Requests a server to send data to a client.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>XTYP_UNREGISTER</TD>
<TD width=55%>Notifies other DDEML applications that a server has unregistered a service name.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>XTYP_WILDCONNECT</TD>
<TD width=55%>Requests a server to establish multiple conversations with the same client.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>XTYP_XACT_COMPLETE</TD>
<TD width=55%>Notifies a client that an asynchronous data transaction has been completed.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>wStatus</B></P>

<P>Specifies the status of the current conversation. This member can be a combination of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%><B>Value</B></TD>
<TD width=67%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ST_ADVISE</TD>
<TD width=67%>One or more links are in progress.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ST_BLOCKED</TD>
<TD width=67%>The conversation is blocked.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ST_BLOCKNEXT</TD>
<TD width=67%>The conversation will block after calling the next callback.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ST_CLIENT</TD>
<TD width=67%>The conversation handle passed to the <A HREF="14336h1.htm"><B>DdeQueryConvInfo</B></A> function is a client-side handle. If the handle is zero, the conversation handle passed to the <B>DdeQueryConvInfo</B> function is a server-side handle.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ST_CONNECTED</TD>
<TD width=67%>The conversation is connected.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ST_INLIST</TD>
<TD width=67%>The conversation is a member of a conversation list.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ST_ISLOCAL</TD>
<TD width=67%>Both sides of the conversation are using the DDEML.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ST_ISSELF</TD>
<TD width=67%>Both sides of the conversation are using the same instance of the DDEML.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>ST_TERMINATED</TD>
<TD width=67%>The conversation has been terminated by the partner.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>wConvst</B></P>

<P>Specifies the conversation state. This member can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=44%><B>Value</B></TD>
<TD width=56%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_ADVACKRCVD</TD>
<TD width=56%>The advise transaction has just been completed.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_ADVDATAACKRCVD</TD>
<TD width=56%>The advise data transaction has just been completed.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_ADVDATASENT</TD>
<TD width=56%>Advise data has been sent and is awaiting an acknowledgement.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_ADVSENT</TD>
<TD width=56%>An advise transaction is awaiting an acknowledgement.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_CONNECTED</TD>
<TD width=56%>The conversation has no active transactions.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_DATARCVD</TD>
<TD width=56%>The requested data has just been received.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_EXECACKRCVD</TD>
<TD width=56%>An execute transaction has just been completed.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_EXECSENT</TD>
<TD width=56%>An execute transaction is awaiting an acknowledgement.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_INCOMPLETE</TD>
<TD width=56%>The last transaction failed.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_INIT1</TD>
<TD width=56%>Mid-initiate state 1.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_INIT2</TD>
<TD width=56%>Mid-initiate state 2.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_NULL</TD>
<TD width=56%>Pre-initiate state.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_POKEACKRCVD</TD>
<TD width=56%>A poke transaction has just been completed.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_POKESENT</TD>
<TD width=56%>A poke transaction is awaiting an acknowledgement.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_REQSENT</TD>
<TD width=56%>A request transaction is awaiting an acknowledgement.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_UNADVACKRCVD</TD>
<TD width=56%>An unadvise transaction has just been completed.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>XST_UNADVSENT</TD>
<TD width=56%>An unadvise transaction is awaiting an acknowledgement.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>wLastError</B></P>

<P>Specifies the error value associated with the last transaction. </P>

<P><B>hConvList</B></P>

<P>Identifies the conversation list if the handle of the current conversation is in a conversation list. This member is NULL if the conversation is not in a conversation list. </P>

<P><B>ConvCtxt</B></P>

<P>Specifies the conversation context. </P>

<P><B>hwnd</B></P>

<P>Identifies the window of the calling application involved in the conversation. </P>

<P><B>hwndPartner</B></P>

<P>Identifies the window of the partner application involved in the current conversation. </P>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="rhe8yt.htm"><B>CONVCONTEXT</B></A>, <A HREF="1_pfuxk.htm"><B>DdeInitialize</B></A>, <A HREF="157gwjy.htm"><B>DdePostAdvise</B></A>, <A HREF="14336h1.htm"><B>DdeQueryConvInfo</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
