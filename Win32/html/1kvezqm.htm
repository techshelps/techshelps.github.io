<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>WNetGetLastError</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1kvezqm"></A><B>WNetGetLastError  <A HREF="y7_kol.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="mzc0i..htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="jc0l02.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>WNetGetLastError</B> function retrieves the most recent extended error code set by a Windows network function. </P>

<P><B>DWORD WNetGetLastError(</B></P>

<TABLE cols=2 width=477>

<TR VALIGN="top">
<TD width=41%><B>LPDWORD</B> <I>lpError</I><B>,</B></TD>
<TD width=59%>// pointer to error code </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    LPTSTR</B> <I>lpErrorBuf</I><B>,</B></TD>
<TD width=59%>// pointer to string describing error </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    DWORD</B> <I>nErrorBufSize</I><B>,</B></TD>
<TD width=59%>// size of description buffer, in characters </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    LPTSTR</B> <I>lpNameBuf</I><B>,</B></TD>
<TD width=59%>// pointer to buffer for provider name </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>    DWORD</B> <I>nNameBufSize</I> </TD>
<TD width=59%>// size of provider name buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=41%><B>   );</B></TD>
<TD width=59%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpError</I></P>

<P>Points to the variable that receives the error code reported by the network provider. The error code is specific to the network provider. </P>

<P><I>lpErrorBuf</I></P>

<P>Points to the buffer that receives the null-terminated string describing the error. </P>

<P><I>nErrorBufSize</I></P>

<P>Specifies the size, in characters, of the buffer pointed to by the <I>lpErrorBuf</I> parameter. If the buffer is too small for the error string, the string is truncated but still null-terminated. A buffer of at least 256 characters is recommended. </P>

<P><I>lpNameBuf</I></P>

<P>Points to the buffer that receives the null-terminated string identifying the network provider that raised the error. </P>

<P><I>nNameBufSize</I></P>

<P>Specifies the size, in characters, of the buffer pointed to by the <I>lpNameBuf</I> parameter. If the buffer is too small for the error string, the string is truncated but still null-terminated. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function successfully obtains the last error reported by the provider, the return value is NO_ERROR. If the caller supplies an invalid buffer, it is ERROR_INVALID_ADDRESS. </P>

<P><B>Remarks</B></P>

<P><B>WNetGetLastError</B> is used to obtain errors that are specific to a network provider. It should be used when a Windows network function (or the <B>GetLastError</B> function) returns ERROR_EXTENDED_ERROR. Like <B>GetLastError</B>, the function returns extended error information, which is maintained on a per-thread basis. Unlike <B>GetLastError</B>, the <B>WNetGetLastError</B> function can also return a string for reporting errors that are not described by any existing error code. </P>

<P><B>See Also</B></P>

<P><A HREF="11c2vs7.htm"><B>GetLastError</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
