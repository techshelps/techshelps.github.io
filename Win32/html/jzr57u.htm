<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ObjectPrivilegeAuditAlarm</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="jzr57u"></A><B>ObjectPrivilegeAuditAlarm  <A HREF="2nnt.gz.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1966ja.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="afqqmm.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>ObjectPrivilegeAuditAlarm</B> function generates audit messages as a result of a client's attempt to perform a privileged operation on a server application object using an already opened handle of that object. Alarms are not supported in the current version of Windows NT. </P>

<P><B>BOOL ObjectPrivilegeAuditAlarm(</B></P>

<TABLE cols=2 width=483>

<TR VALIGN="top">
<TD width=46%><B>LPCTSTR</B> <I>SubsystemName</I><B>,</B></TD>
<TD width=54%>// pointer to string for subsystem name</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    LPVOID</B> <I>HandleId</I><B>,</B></TD>
<TD width=54%>// pointer to handle identifier</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    HANDLE</B> <I>ClientToken</I><B>,</B></TD>
<TD width=54%>// handle to client's access token</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    DWORD</B> <I>DesiredAccess</I><B>,</B></TD>
<TD width=54%>// mask for desired access rights</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    PPRIVILEGE_SET</B> <I>Privileges</I><B>,</B></TD>
<TD width=54%>// pointer to privileges</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    BOOL</B> <I>AccessGranted</I> </TD>
<TD width=54%>// flag for results</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>   );</B></TD>
<TD width=54%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>SubsystemName</I></P>

<P>Points to a null-terminated string specifying the name of the subsystem calling the function; for example, "DEBUG" or "WIN32". </P>

<P><I>HandleId</I></P>

<P>Points to a unique 32-bit value representing the client's handle to the object. </P>

<P><I>ClientToken</I></P>

<P>Identifies an access token representing the client requesting the operation. This handle must be obtained by opening the token of a thread impersonating the client. The token must be open for TOKEN_QUERY access. </P>

<P><I>DesiredAccess</I></P>

<P>Specifies an access mask indicating the privileged access types being used or whose use is being attempted. The access mask can be mapped by the <A HREF="16rli2z.htm"><B>MapGenericMask</B></A> function so it does not contain any generic access types. </P>

<P><I>Privileges</I></P>

<P>Points to a <A HREF="4venv2.htm"><B>PRIVILEGE_SET</B></A> structure specifying the set of privileges required for the requested operation. The information in this structure is supplied by a call to the <B>PrivilegeCheck</B> function. This parameter can be NULL. </P>

<P><I>AccessGranted</I></P>

<P>Specifies a flag indicating whether access was granted or denied in a previous call to an access-checking function such as <B>PrivilegeCheck</B>. If access was granted, this flag is TRUE. If not, it is FALSE. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>The <B>ObjectPrivilegeAuditAlarm</B> function requires the calling process to have SE_AUDIT_NAME privilege. The test for this privilege is always performed against the primary token of the calling process, not the impersonation token of the thread. This allows the calling process to impersonate a client during the call. </P>

<P>The <B>ObjectPrivilegeAuditAlarm</B> function can send many messages to port objects. This can result in a significant delay before the function returns. The design of applications calling <B>ObjectPrivilegeAuditAlarm</B> can take this potential delay into account. For example, this consideration may affect the design of an application using mutexes to lock structures. </P>

<P><B>See Also</B></P>

<P><A HREF="6bujdl.htm"><B>AccessCheck</B></A>, <A HREF="42cfuj6.htm"><B>AccessCheckAndAuditAlarm</B></A>, <A HREF="12w7mz7.htm"><B>AreAllAccessesGranted</B></A>, <A HREF="3ebe6c.htm"><B>AreAnyAccessesGranted</B></A>, <A HREF="16rli2z.htm"><B>MapGenericMask</B></A>, <A HREF="2rh2_le.htm"><B>ObjectCloseAuditAlarm</B></A>, <A HREF="3bm2_wx.htm"><B>ObjectOpenAuditAlarm</B></A>, <A HREF="i9o5nf.htm"><B>PrivilegeCheck</B></A>, <A HREF="lk0uwj.htm"><B>PrivilegedServiceAuditAlarm</B></A>, <A HREF="4venv2.htm"><B>PRIVILEGE_SET</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
