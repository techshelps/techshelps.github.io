<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetTextExtentExPoint</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="4868_tp"></A><B>GetTextExtentExPoint  <A HREF="l28ild.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="4jd_z5i.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1xkvu5n.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetTextExtentExPoint</B> function retrieves the number of characters in a specified string that will fit within a specified space and fills an array with the text extent for each of those characters. (A text extent is the distance between the beginning of the space and a character that will fit in the space.) This information is useful for word-wrapping calculations. </P>

<P><B>BOOL GetTextExtentExPoint(</B></P>

<TABLE cols=2 width=507>

<TR VALIGN="top">
<TD width=31%><B>HDC</B> <I>hdc</I><B>,</B></TD>
<TD width=69%>// handle of device context </TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>    LPCTSTR</B> <I>lpszStr</I><B>,</B></TD>
<TD width=69%>// address of character string </TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>    int</B> <I>cchString</I><B>,</B></TD>
<TD width=69%>// number of characters in string </TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>    int</B> <I>nMaxExtent</I><B>,</B></TD>
<TD width=69%>// maximum width for formatted string </TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>    LPINT</B> <I>lpnFit</I><B>,</B></TD>
<TD width=69%>// address of value specifying max. number of chars.  </TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>    LPINT</B> <I>alpDx</I><B>,</B></TD>
<TD width=69%>// address of array for partial string widths </TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>    LPSIZE</B> <I>lpSize</I> </TD>
<TD width=69%>// address of structure with string dimensions </TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>   );</B></TD>
<TD width=69%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hdc</I></P>

<P>Identifies the device context. </P>

<P><I>lpszStr</I></P>

<P>Points to the null-terminated string for which extents are to be retrieved. </P>

<P><I>cchString</I></P>

<P>Specifies the number of bytes in the string pointed to by the <I>lpszStr</I> parameter. </P>

<P><I>nMaxExtent</I></P>

<P>Specifies the maximum allowable width, in logical units, of the formatted string. </P>

<P><I>lpnFit</I></P>

<P>Points to an integer to receive a count of the maximum number of characters that will fit in the space specified by the <I>nMaxExtent</I> parameter. When the <I>lpnFit</I> parameter is NULL, the <I>nMaxExtent</I> parameter is ignored. </P>

<P><I>alpDx</I></P>

<P>Points to an array of integers to receive partial string extents. Each element in the array gives the distance, in logical units, between the beginning of the string and one of the characters that fits in the space specified by the <I>nMaxExtent</I> parameter. Although this array should have at least as many elements as characters specified by the <I>cchString</I> parameter, the function fills the array with extents only for as many characters as are given by the <I>lpnFit</I> parameter. If <I>alpDx</I> is NULL, the function does not compute partial string widths. </P>

<P><I>lpSize</I></P>

<P>Points to a <A HREF="1sygbbp.htm"><B>SIZE</B></A> structure that contains the dimensions of the string, in logical units when the function returns. This value cannot be NULL. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>If both the <I>lpnFit</I> and <I>alpDx</I> parameters are NULL, calling the <B>GetTextExtentExPoint</B> function is equivalent to calling the <B>GetTextExtentPoint</B> function. </P>

<P><B>See Also</B></P>

<P><A HREF="kn3es8.htm"><B>GetTextExtentPoint</B></A>, <A HREF="1sygbbp.htm"><B>SIZE</B></A> </P>

</BODY>
</HTML>
