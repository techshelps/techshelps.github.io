<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>CopyImage</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="lrlup8"></A><B>CopyImage  <A HREF="4ca4ty.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="18ajhao.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1u_ybcp.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>CopyImage</B> function creates a new image (icon, cursor, or bitmap) and copies the attributes of the specified image to the new one. If necessary, the function stretches the bits to fit the desired size of the new image.</P>

<P><B>HANDLE CopyImage(</B></P>

<TABLE cols=2 width=369>

<TR VALIGN="top">
<TD width=43%><B>HANDLE</B> <I>hImage</I><B>,</B> </TD>
<TD width=57%>// handle to the image to copy</TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>    UINT</B> <I>uType</I><B>,</B></TD>
<TD width=57%>// type of image to copy</TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>    int</B> <I>cxDesired</I><B>,</B></TD>
<TD width=57%>// desired width of new image</TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>    int</B> <I>cyDesired</I><B>,</B></TD>
<TD width=57%>// desired height of new image</TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>    UINT</B> <I>fuFlags</I></TD>
<TD width=57%><B>//</B> copy flags</TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>   );</B></TD>
<TD width=57%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hinst</I></P>

<P>Identifies an instance of the module that contains the image to be copied. </P>

<P><I>uType</I></P>

<P>Specifies the type of image to be copied. This parameter can be one of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=28%><B>Value</B></TD>
<TD width=72%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=28%>IMAGE_BITMAP</TD>
<TD width=72%>Copies a bitmap.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%>IMAGE_CURSOR</TD>
<TD width=72%>Copies a cursor.</TD>
</TR>

<TR VALIGN="top">
<TD width=28%>IMAGE_ICON</TD>
<TD width=72%>Copies an icon.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>cxDesired</I></P>

<P>Specifies the desired width, in pixels, of the image. </P>

<P><I>cyDesired</I></P>

<P>Specifies the desired height, in pixels, of the image. </P>

<P><I>fuFlags</I></P>

<P>Specifies a combination of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=44%><B>Value</B></TD>
<TD width=56%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LR_COPYDELETEORG</TD>
<TD width=56%>Deletes the original image after creating the copy.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LR_COPYRETURNORG</TD>
<TD width=56%>Creates an exact copy of the image, ignoring the <I>cxDesired</I> and <I>cyDesired</I> parameters.</TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LR_MONOCHROME</TD>
<TD width=56%>Creates a new monochrome image. </TD>
</TR>

<TR VALIGN="top">
<TD width=44%>LR_COPYFROMRESOURCE</TD>
<TD width=56%>Tries to reload an icon or cursor resource from the original resource file rather than simply copying the current image. This is useful for creating a different-sized copy when the resource file contains multiple sizes of the resource. Without this flag, <B>CopyImage</B> stretches the original image to the new size. If this flag is set, <B>CopyImage</B> uses the size in the resource file closest to the desired size.
<P>This will succeed only if <I>hImage</I> was loaded by <B>LoadIcon</B> or <B>LoadCursor</B>, or by <B>LoadImage</B> with the LR_SHARED flag.</P>
</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is the handle to the newly created image.</P>

<P>If the function fails, the return value is NULL. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>See Also</B></P>

<P><A HREF="11o6jxc.htm"><B>LoadImage</B></A></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
