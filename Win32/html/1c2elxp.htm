<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ActivateKeyboardLayout</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1c2elxp"></A><B>ActivateKeyboardLayout  <A HREF="lzerm_.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1xtfdy5.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="fkf.jh.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The implementations of <B>ActivateKeyboardLayout</B> in Windows 95 and Windows NT are substantially different. To accommodate these differences, this reference page first presents the Windows 95 implementation in its entirety, followed by the Windows NT version.</P>

<P><IMG SRC="../images/bm4.gif" ALT="" BORDER=0><B>Windows 95:</B></P>

<P>The <B>ActivateKeyboardLayout</B> function sets the input language for the current thread. This function accepts a keyboard layout handle that identifies a locale as well as the physical layout of the keyboard.</P>

<P><B>HKL ActivateKeyboardLayout(</B></P>

<TABLE cols=2 width=315>

<TR VALIGN="top">
<TD width=38%><B>HKL</B> <I>hkl</I><B>,</B></TD>
<TD width=62%>// handle to keyboard layout</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    UINT</B> <I>Flags</I> </TD>
<TD width=62%>// keyboard layout flags</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>   );</B></TD>
<TD width=62%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hkl</I></P>

<P>Handle to a keyboard layout or a zero-extended locale identifier. This parameter can be any valid keyboard layout handle obtained using the <A HREF="kivx9c.htm"><B>LoadKeyboardLayout</B></A> or <A HREF="5jwfvt.htm"><B>GetKeyboardLayoutList</B></A> function or one of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=31%><B>Value</B></TD>
<TD width=69%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>HKL_NEXT</TD>
<TD width=69%>Selects the next layout in the keyboard layouts list maintained by the system.</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>HKL_PREV</TD>
<TD width=69%>Selects the previous layout in the keyboards layout list maintained by the system.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>Flags</I></P>

<P>Specifies the keyboard layout flags. The value of this parameter can be: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=41%><B>Value</B></TD>
<TD width=59%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=41%>KLF_REORDER</TD>
<TD width=59%>Reorders the keyboard layouts list by moving the given keyboard layout handle to the head of the list. If this value is not given, the list is rotated without a change of order. For example, if a user had an English layout active, as well as having French, German and Spanish layouts loaded (in that order), then activating the German layout with the KLF_REORDER bit set would produce the following order: German, English, French, Spanish. Activating the German layout without the KLF_REORDER value set would produce the following order: German, Spanish, English, French.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is the previous keyboard layout handle. Otherwise, it is zero. To get extended error information, use the <A HREF="11c2vs7.htm"><B>GetLastError</B></A> function.</P>

<P><B>Remarks</B></P>

<P>Several keyboard layouts can be loaded at any one time, but only one is active at a time. Loading multiple keyboard layouts makes it possible to rapidly switch between layouts. </P>

<P>An application can create a valid keyboard layout handle by setting the high word to zero and the low word to a locale identifier. Using such keyboard layout handles changes the input language without affecting the physical layout.</P>

<P>When multiple input method editors (IMEs) are allowed for each locale, passing in a keyboard layout handle in which the high word (the device handle) is zero activates the first IME in the list "belonging" to the locale.</P>

<P><B>See Also</B></P>

<P><A HREF="kivx9c.htm"><B>LoadKeyboardLayout</B></A>, <A HREF="1e2f_t0.htm"><B>GetKeyboardLayoutName</B></A>, <A HREF="1_e1bp5.htm"><B>UnloadKeyboardLayout</B></A> </P>

<P><IMG SRC="../images/bm4.gif" ALT="" BORDER=0><B>Windows NT:</B></P>

<P>The <B>ActivateKeyboardLayout</B> function activates a different keyboard layout and sets the active keyboard layout for the entire system rather than the calling thread.</P>

<P><B>BOOL ActivateKeyboardLayout(</B></P>

<TABLE cols=2 width=315>

<TR VALIGN="top">
<TD width=38%><B>HKL</B> <I>hkl</I><B>,</B></TD>
<TD width=62%>// handle to keyboard layout</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    UINT</B> <I>Flags</I> </TD>
<TD width=62%>// keyboard layout flags</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>   );</B></TD>
<TD width=62%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hkl</I></P>

<P>Identifies the keyboard layout to be activated. The layout must have been loaded by a previous call to the <A HREF="kivx9c.htm"><B>LoadKeyboardLayout</B></A> function. This parameter must be either the handle to a keyboard layout or one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=31%><B>Value</B></TD>
<TD width=69%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>HKL_NEXT</TD>
<TD width=69%>Selects the next layout in the circular list of loaded layouts maintained by the system.</TD>
</TR>

<TR VALIGN="top">
<TD width=31%>HKL_PREV</TD>
<TD width=69%>Selects the previous layout in the circular list of loaded layouts maintained by the system.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>Flags</I></P>

<P>Specifies how the keyboard layout is to be activated. This parameter can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=41%><B>Value</B></TD>
<TD width=59%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=41%>KLF_REORDER</TD>
<TD width=59%>If this bit is set, the system's circular list of loaded keyboard layouts is reordered. If this bit is not set, the list is rotated without a change of order. For example, if a user had an English layout active, as well as having French, German and Spanish layouts loaded (in that order), then activating the German layout with the KLF_REORDER bit set would produce the following order: German, English, French, Spanish. Activating the German layout without the KLF_REORDER bit set would produce the following order: German, Spanish, English, French.
<P>If less than three keyboard layouts are loaded, the value of this flag is irrelevant. </P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>KLF_UNLOADPREVIOUS</TD>
<TD width=59%>The previously active layout is unloaded.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is TRUE. </P>

<P>If the function fails, the return value is FALSE. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>Several keyboard layouts can be loaded at any one time, but only one is active at a time. Loading multiple keyboard layouts makes it possible to rapidly switch between layouts. </P>

<P><B>See Also</B></P>

<P><A HREF="kivx9c.htm"><B>LoadKeyboardLayout</B></A>, <A HREF="1e2f_t0.htm"><B>GetKeyboardLayoutName</B></A>, <A HREF="1_e1bp5.htm"><B>UnloadKeyboardLayout</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
