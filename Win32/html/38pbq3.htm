<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Callback Function</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="38pbq3"></A><B>Callback Function</B></P>

<P>An application that uses the DDEML must provide a callback function that processes the DDE events affecting the application. The DDEML notifies an application of such events by sending transactions to the application's DDE callback function. The transactions a callback function receives depend on which callback filter flags the application specified in <A HREF="1_pfuxk.htm"><B>DdeInitialize</B></A> and whether the application is a client, a server, or both. For more information, please see <A HREF="14qp_xx.htm"><B>DdeCallback</B></A>.</P>

<P>The following example shows the general structure of a callback function for a typical client application. </P>

<P>HDDEDATA CALLBACK DdeCallback(uType, uFmt, hconv, hsz1,  </P>

<P>hsz2, hdata, dwData1, dwData2)  </P>

<P>UINT uType;       /* transaction type                 */ </P>

<P>UINT uFmt;        /* clipboard data format            */ </P>

<P>HCONV hconv;      /* handle of conversation           */ </P>

<P>HSZ hsz1;         /* handle of string                 */ </P>

<P>HSZ hsz2;         /* handle of string                 */ </P>

<P>HDDEDATA hdata;   /* handle of global memory object   */ </P>

<P>DWORD dwData1;    /* transaction-specific data        */ </P>

<P>DWORD dwData2;    /* transaction-specific data        */ </P>

<P>{ </P>

<P>switch (uType) { </P>

<P>case XTYP_REGISTER: </P>

<P>case XTYP_UNREGISTER: </P>

<P>. </P>

<P>. </P>

<P>. </P>

<P>return (HDDEDATA) NULL; </P>

<P></P>

<P>case XTYP_ADVDATA: </P>

<P>. </P>

<P>. </P>

<P>. </P>

<P>return (HDDEDATA) DDE_FACK; </P>

<P></P>

<P>case XTYP_XACT_COMPLETE: </P>

<P>. </P>

<P>. </P>

<P>. </P>

<P>return (HDDEDATA) NULL; </P>

<P></P>

<P>case XTYP_DISCONNECT: </P>

<P>. </P>

<P>. </P>

<P>. </P>

<P>return (HDDEDATA) NULL; </P>

<P></P>

<P>default: </P>

<P>return (HDDEDATA) NULL; </P>

<P>} </P>

<P>} </P>

<P></P>

<P>The <I>uType</I> parameter specifies the transaction type sent to the callback function by the DDEML. The values of the remaining parameters depend on the transaction type. The transaction types and the events that generate them are described in the following topics. For detailed information about each transaction type, see <A HREF="cb55_c.htm">Transaction Management</A>. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
