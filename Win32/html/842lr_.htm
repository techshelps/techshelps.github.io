<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetNamedPipeHandleState</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="842lr_"></A><B>GetNamedPipeHandleState  <A HREF="25jbns5.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="qxj_so.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1p87g2.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetNamedPipeHandleState</B> function retrieves information about a specified named pipe. The information returned can vary during the lifetime of an instance of the named pipe. </P>

<P><B>BOOL GetNamedPipeHandleState(</B></P>

<TABLE cols=2 width=601>

<TR VALIGN="top">
<TD width=42%><B>HANDLE</B> <I>hNamedPipe</I><B>,</B></TD>
<TD width=58%>// handle of named pipe </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    LPDWORD</B> <I>lpState</I><B>,</B></TD>
<TD width=58%>// address of flags indicating pipe state </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    LPDWORD</B> <I>lpCurInstances</I><B>,</B></TD>
<TD width=58%>// address of number of current pipe instances </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    LPDWORD</B> <I>lpMaxCollectionCount</I><B>,</B></TD>
<TD width=58%>// address of max. bytes before remote transmission  </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    LPDWORD</B> <I>lpCollectDataTimeout</I><B>,</B></TD>
<TD width=58%>// address of max. time before remote transmission </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    LPTSTR</B> <I>lpUserName</I><B>,</B></TD>
<TD width=58%>// address of user name of client process </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    DWORD</B> <I>nMaxUserNameSize</I> </TD>
<TD width=58%>// size, in characters, of user name buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>   );</B></TD>
<TD width=58%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hNamedPipe</I></P>

<P>Identifies the named pipe for which information is wanted. The handle must have GENERIC_READ access to the named pipe. </P>

<P><I>lpState</I></P>

<P>Points to a 32-bit variable that indicates the current state of the handle. This parameter can be NULL if this information is not needed. Either or both of the following values can be specified: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=46%><B>Value</B></TD>
<TD width=54%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=46%>PIPE_NOWAIT</TD>
<TD width=54%>The pipe handle is in nonblocking mode. If this flag is not specified, the pipe handle is in blocking mode.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%>PIPE_READMODE_MESSAGE</TD>
<TD width=54%>The pipe handle is in message-read mode. If this flag is not specified, the pipe handle is in byte-read mode.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lpCurInstances</I></P>

<P>Points to a 32-bit variable that receives the number of current pipe instances. This parameter can be NULL if this information is not required. </P>

<P><I>lpMaxCollectionCount</I></P>

<P>Points to a 32-bit variable that receives the maximum number of bytes to be collected on the client's computer before transmission to the server. This parameter must be NULL if the specified pipe handle is to the server end of a named pipe or if client and server processes are on the same computer. This parameter can be NULL if this information is not required. </P>

<P><I>lpCollectDataTimeout</I></P>

<P>Points to a 32-bit variable that receives the maximum time, in milliseconds, that can pass before a remote named pipe transfers information over the network. This parameter must be NULL if the specified pipe handle is to the server end of a named pipe or if client and server processes are on the same computer. This parameter can be NULL if this information is not required. </P>

<P><I>lpUserName</I></P>

<P>Points to a buffer that receives the null-terminated string containing the user name string of the client application. This parameter must be NULL if the specified pipe handle is to the client end of a named pipe. This parameter can be NULL if this information is not required. </P>

<P><I>nMaxUserNameSize</I></P>

<P>Specifies the size, in characters, of the buffer specified by the <I>lpUserName</I> parameter. This parameter is ignored if <I>lpUserName</I> is NULL. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>The <B>GetNamedPipeHandleState</B> function returns successfully even if all of the pointers passed to it are NULL. </P>

<P>To set the pipe handle state, use the <B>SetNamedPipeHandleState</B> function. </P>

<P><B>See Also</B></P>

<P><A HREF="ap5lb1.htm"><B>SetNamedPipeHandleState</B></A> </P>

</BODY>
</HTML>
