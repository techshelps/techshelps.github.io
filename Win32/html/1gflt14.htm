<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Creating an Image List</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1gflt14"></A><B>Creating an Image List</B></P>

<P>To create an image list, use the <A HREF="ctydoz.htm"><B>ImageList_Create</B></A> function, specifying the type of image list to create (unmasked or masked); the width and height, in pixels, of the images; the number of images you intend to add to the image list; and the amount of images by which the list can grow when it is resized to accommodate additional images. The common control DLL contains the executable code for the image list functions. You must ensure that the library is loaded by using the <A HREF="h262.j.htm"><B>InitCommonControls</B></A> function before making any calls to image list functions. </P>

<P>The following example creates a masked image list and uses the <A HREF="ggmjka.htm"><B>ImageList_AddIcon</B></A> function to add two icons to the list.</P>

<P>// AddIconsToImageList - creates a masked image list and adds some  </P>

<P>//     icons to it. </P>

<P>// Returns the handle of the new image list. </P>

<P>// hinst - handle of the application instance </P>

<P>// </P>

<P>// Global variables and constants </P>

<P>//     g_nBird and g_nTree - indexes of the images </P>

<P>//     CX_ICON and CY_ICON - width and height of the icon </P>

<P>//     NUM_ICONS - number of icons to add to the image list </P>

<P>extern int g_nBird, g_nTree; </P>

<P></P>

<P>#define CX_ICON  32 </P>

<P>#define CY_ICON  32 </P>

<P>#define NUM_ICONS 3 </P>

<P></P>

<P>HIMAGELIST AddIconsToImageList(HINSTANCE hinst) </P>

<P>{ </P>

<P>HIMAGELIST himlIcons;  // handle of new image list </P>

<P>HICON hicon;           // handle of icon </P>

<P></P>

<P>// Ensure that the common control DLL is loaded. </P>

<P>InitCommonControls(); </P>

<P></P>

<P>// Create a masked image list large enough to hold the icons. </P>

<P>himlIcons = ImageList_Create(CX_ICON, CY_ICON, TRUE, NUM_ICONS, 0); </P>

<P></P>

<P>// Load the icon resources, and add the icons to the image list. </P>

<P>hicon = LoadIcon(hinst, MAKEINTRESOURCE(IDI_BIRD)); </P>

<P>g_nBird = ImageList_AddIcon(himlIcons, hicon); </P>

<P></P>

<P>hicon = LoadIcon(hinst, MAKEINTRESOURCE(IDI_TREE)); </P>

<P>g_nTree = ImageList_AddIcon(himlIcons, hicon); </P>

<P></P>

<P>return himlIcons; </P>

<P>} </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
