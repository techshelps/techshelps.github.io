<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DlgDirList</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="eyoakl"></A><B>DlgDirList  <A HREF="8h0iko.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="jed1ar.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="2mrksz4.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>DlgDirList</B> function fills the specified list box with the names of all files matching the specified path or filename. </P>

<P><B>int DlgDirList(</B></P>

<TABLE cols=2 width=418>

<TR VALIGN="top">
<TD width=42%><B>HWND</B> <I>hDlg</I><B>,</B></TD>
<TD width=58%>// handle to dialog box with list box  </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    LPTSTR</B> <I>lpPathSpec</I><B>,</B></TD>
<TD width=58%>// pointer to path or filename string  </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    int</B> <I>nIDListBox</I><B>,</B></TD>
<TD width=58%>// identifier of list box </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    int</B> <I>nIDStaticPath</I><B>,</B></TD>
<TD width=58%>// identifier of static control </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>    UINT</B> <I>uFileType</I> </TD>
<TD width=58%>// file attributes to display </TD>
</TR>

<TR VALIGN="top">
<TD width=42%><B>   );</B></TD>
<TD width=58%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hDlg</I></P>

<P>Identifies the dialog box that contains the list box. </P>

<P><I>lpPathSpec</I></P>

<P>Points to a null-terminated string that contains the path or filename. <B>DlgDirList</B> modifies this string, which should be long enough to contain the modifications. For more information about this parameter, see the Remarks section. </P>

<P><I>nIDListBox</I></P>

<P>Specifies the identifier of a list box. If this parameter is zero, <B>DlgDirList</B> assumes that no list box exists and does not attempt to fill one. </P>

<P><I>nIDStaticPath</I></P>

<P>Specifies the identifier of the static control used for displaying the current drive and directory. If this parameter is zero, <B>DlgDirList</B> assumes that no such control is present. </P>

<P><I>uFileType</I></P>

<P>Specifies attributes of the filenames to be displayed. This parameter must be one or more of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%><B>Value</B></TD>
<TD width=67%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_ARCHIVE</TD>
<TD width=67%>Includes archived files.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_DIRECTORY</TD>
<TD width=67%>Includes subdirectories. Subdirectory names are enclosed in square brackets ([ ]).</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_DRIVES</TD>
<TD width=67%>Includes drives. Drives are listed in the form [-<I>x</I>-], where <I>x</I> is the drive letter.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_EXCLUSIVE</TD>
<TD width=67%>Includes only files with the specified attributes. By default, read-write files are listed even if DDL_READWRITE is not specified.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_HIDDEN</TD>
<TD width=67%>Includes hidden files.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_READONLY</TD>
<TD width=67%>Includes read-only files.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_READWRITE</TD>
<TD width=67%>Includes read-write files with no additional attributes.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_SYSTEM</TD>
<TD width=67%>Includes system files.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%>DDL_POSTMSGS</TD>
<TD width=67%>Posts messages to the application's message queue. By default, <B>DlgDirList</B> sends messages directly to the dialog box procedure.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>If a listing is made ¾ even an empty listing ¾ the return value is nonzero. If the input string does not contain a valid search path, the return value is zero. </P>

<P><B>Remarks</B></P>

<P>If you specify a zero-length string for the <I>lpPathSpec</I> parameter or if you specify only a directory name with no filename, the string will be changed to *.* </P>

<P>The <I>lpPathSpec</I> parameter has the following form: </P>

<P><B>[</B><I>drive</I><B>:] [[\u]</B><I>directory</I><B>[\i</B><I>directory</I><B>]\u] [</B><I>filename</I><B>]</B> </P>

<P>In this example, <I>drive</I> is a drive letter, <I>directory</I> is a valid directory name, and <I>filename</I> is a valid filename that must contain at least one wildcard (? or *). </P>

<P>If <I>lpPathSpec</I> includes a drive or directory name, or both, the current drive and directory are changed to the specified drive and directory before the list box is filled. The static control identified by the <I>nIDStaticPath</I> parameter is also updated with the new drive or directory name, or both. </P>

<P>After the list box is filled, <B>DlgDirList</B> updates <I>lpPathSpec</I> by removing the drive or directory portion, or both, of the path and filename. </P>

<P><B>DlgDirList</B> sends the LB_RESETCONTENT and LB_DIR messages to the list box. </P>

<P><B>See Also</B></P>

<P><A HREF="1jzneui.htm"><B>DlgDirListComboBox</B></A>, <A HREF="1e7xwyp.htm"><B>DlgDirSelectComboBoxEx</B></A>, <A HREF="4wg_v_.htm"><B>DlgDirSelectEx</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
