<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Share Functions</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="spq2so"></A><B>Share Functions</B></P>

<P>The share functions control shared resources. A shared resource is a local resource on a server (for example, a disk directory, print device, or named pipe) that can be accessed by users and applications on the network. The share functions are:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=50%><A HREF="24mx8w.htm"><B>NetShareAdd</B></A></TD>
<TD width=50%>Shares a resource on a server.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="7rl.060.htm"><B>NetShareCheck</B></A></TD>
<TD width=50%>Queries whether a server is sharing a device.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="o_yzqd.htm"><B>NetShareDel</B></A></TD>
<TD width=50%>Deletes a share name from a server's list of shared resources.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="328dmh.htm"><B>NetShareEnum</B></A></TD>
<TD width=50%>Retrieves share information about each shared resource on a server.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="ggtuce.htm"><B>NetShareGetInfo</B></A></TD>
<TD width=50%>Retrieves information about a specified shared resource on a server.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="_lt2lr.htm"><B>NetShareSetInfo</B></A></TD>
<TD width=50%>Sets a shared resource's parameters.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>The <A HREF="1_s56l.htm"><B>WNetEnumResource</B></A> function should be used instead of the <B>NetShareEnum</B> function, which is obsolete. </P>

<P>The <A HREF="24mx8w.htm"><B>NetShareAdd</B></A> function allows a user or application to share a resource of a specific type using the specified share name. The<B> NetShareAdd</B> function requires the share name and local device name to share the resource. A user or application must have an account on the server to access the resource.</P>

<P>You may also specify a Security Descriptor to be associated with a share, which specifies which users will be allowed to access files through this share, and with what type of access.</P>

<P>LAN Manager defines three types of special share names for interprocess communication (IPC) and remote administration of the server:</P>

<P>·IPC$, reserved for interprocess communication.</P>

<P>·ADMIN$, reserved for remote administration.</P>

<P>·A$, B$, C$ (and other local disk names followed by a dollar sign), assigned to local disk devices.</P>

<P></P>

<P>Share functions are available at four information levels:</P>

<P><A HREF="3o5okvq.htm"><B>SHARE_INFO_0</B></A> <BR>
<A HREF="3nwokvq.htm"><B>SHARE_INFO_1</B></A> <BR>
<A HREF="3nxokvq.htm"><B>SHARE_INFO_2</B></A> <BR>
<A HREF="210h.3o.htm"><B>SHARE_INFO_502</B></A> </P>

<P>The following information levels are valid only for <A HREF="_lt2lr.htm"><B>NetShareSetInfo</B></A>:</P>

<P><A HREF="1np7ns2.htm"><B>SHARE_INFO_1004</B></A> <B><BR>
<A HREF="1nr7ns2.htm">SHARE_INFO_1006</A></B> </P>

<P>The following is supported only on Windows NT: </P>

<P><A HREF="4phlfw.htm"><B>SHARE_INFO_1501</B></A> </P>

<P>For <A HREF="_lt2lr.htm"><B>NetShareSetInfo</B></A><B>,</B> <I>parmnum</I> values refer to the members of the SHARE_INFO structure, as follows. These values are used when indicating an error in a specific parameter through <I>parm_err.</I></P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=53%><B><I>parmnum</I> value</B></TD>
<TD width=47%><B>Member of SHARE_INFO structure</B></TD>
</TR>

<TR VALIGN="top">
<TD width=53%>SHARE_NETNAME_PARMNUM</TD>
<TD width=47%>shi_netname</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>SHARE_TYPE_PARMNUM</TD>
<TD width=47%>shi_type</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>SHARE_REMARK_PARMNUM</TD>
<TD width=47%>shi_remark</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>SHARE_PERMISSIONS_PARMNUM</TD>
<TD width=47%>shi_permissions</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>SHARE_MAX_USES_PARMNUM</TD>
<TD width=47%>shi_max_uses</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>SHARE_CURRENT_USES_PARMNUM</TD>
<TD width=47%>shi_current_uses</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>SHARE_PATH_PARMNUM</TD>
<TD width=47%>shi_path</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>SHARE_PASSWD_PARMNUM</TD>
<TD width=47%>shi_passwd</TD>
</TR>

<TR VALIGN="top">
<TD width=53%>SHARE_FILE_SD_PARMNUM</TD>
<TD width=47%>shi_security_descriptor</TD>
</TR>
</TABLE><BR>

<P></P>

</BODY>
</HTML>
