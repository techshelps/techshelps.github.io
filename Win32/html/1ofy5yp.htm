<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Metrics for Portable Documents</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1ofy5yp"></A><B>Metrics for Portable Documents</B></P>

<P>The following table specifies the most important font metrics for applications that require portable documents and the functions that allow an application to retrieve them. </P>

<TABLE cols=3>

<TR VALIGN="top">
<TD width=34%><B>Function</B></TD>
<TD width=29%><B>Metric</B></TD>
<TD width=37%><B>Use</B></TD>
</TR>

<TR VALIGN="top">
<TD width=34%><A HREF="zxznx3.htm"><B>EnumFontFamilies</B></A></TD>
<TD width=29%><B>ntmSizeEM</B></TD>
<TD width=37%>Retrieval of design metrics; conversion to device metrics </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><A HREF="ydun.6.htm"><B>GetCharABCWidths</B></A></TD>
<TD width=29%><B>ABCWidths</B></TD>
<TD width=37%>Accurate placement of characters at the start and end of margins, picture boundaries, and other text breaks </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><A HREF="9nsqcl.htm"><B>GetCharWidth32</B></A></TD>
<TD width=29%><B>AdvanceWidths</B></TD>
<TD width=37%>Placement of characters on a line </TD>
</TR>

<TR VALIGN="top">
<TD width=34%><A HREF="31gl__r.htm"><B>GetOutlineTextMetrics</B></A></TD>
<TD width=29%><B>otmfsType</B></TD>
<TD width=37%>Font-embedding bits </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>&nbsp;</TD>
<TD width=29%><B>otmsCharSlopeRise</B></TD>
<TD width=37%>Y-component for slope of cursor for italic fonts </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>&nbsp;</TD>
<TD width=29%><B>otmsCharSlopeRun</B></TD>
<TD width=37%>X-component for slope of cursor for italic fonts </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>&nbsp;</TD>
<TD width=29%><B>otmAscent</B></TD>
<TD width=37%>Line spacing </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>&nbsp;</TD>
<TD width=29%><B>otmDescent</B></TD>
<TD width=37%>Line spacing </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>&nbsp;</TD>
<TD width=29%><B>otmLineGap</B></TD>
<TD width=37%>Line spacing </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>&nbsp;</TD>
<TD width=29%><B>otmpFamilyName</B></TD>
<TD width=37%>Font identification </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>&nbsp;</TD>
<TD width=29%><B>otmpStyleName</B></TD>
<TD width=37%>Font identification </TD>
</TR>

<TR VALIGN="top">
<TD width=34%>&nbsp;</TD>
<TD width=29%><B>otmpFullName</B></TD>
<TD width=37%>Font identification (typically, family and style name) </TD>
</TR>
</TABLE><BR>

<P></P>

<P>The <B>otmsCharSlopeRise</B>, <B>otmsCharSlopeRun</B>, <B>otmAscent</B>, <B>otmDescent</B>, and <B>otmLineGap</B> members of the <A HREF="ca9ocg.htm"><B>OUTLINETEXTMETRIC</B></A> structure are scaled or transformed to correspond to the current device mode and physical height (as given in the <B>tmHeight</B> member of the <A HREF="k_sjw.htm"><B>NEWTEXTMETRIC</B></A> structure). </P>

<P>Font identification is important in those instances when an application must select the same font ¾ for example, when a document is reopened or moved to a different operating system. The font mapper always selects the correct font when an application requests a font by full name. The family and style names provide input to the standard font dialog box, which ensures that the selection bars are properly placed. </P>

<P>The <B>otmsCharSlopeRise</B> and <B>otmsCharSlopeRun</B> values are used to produce a close approximation of the main italic angle of the font. For typical roman fonts, <B>otmsCharSlopeRise</B> is 1 and <B>otmsCharSlopeRun</B> is 0. For italic fonts, the values attempt to approximate the sine and cosine of the main italic angle of the font (in counterclockwise degrees past vertical); note that the italic angle for upright fonts is 0. Because these values are not expressed in design units, they should not be converted into device units. </P>

<P>The character placement and line spacing metrics enable an application to compute device-independent line breaks that are portable across screens, printers, typesetters, and even platforms. </P>

<P>Device-independent page layout requires the following seven basic steps: </P>

<P>1.Normalize all design metrics to a common ultra-high resolution (UHR) value (for example, 65,536 DPI); this prevents round-off errors. </P>

<P>2.Compute line breaks based on UHR metrics and physical page width; this yields a starting point and an ending point of a line within the text stream. </P>

<P>3.Compute the device page width in device units (for example, pixels). </P>

<P>4.Fit each line of text into the device page width, using the line breaks computed in step 2. </P>

<P>5.Compute page breaks by using UHR metrics and the physical page length; this yields the number of lines per page. </P>

<P>6.Compute the line heights in device units. </P>

<P>7.Fit the lines of text onto the page, using the lines per page from step 5 and the line heights from step 6. </P>

<P></P>

<P>If all applications adopt these techniques, developers can virtually guarantee that documents moved from one application to another will retain their original appearance and format. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
