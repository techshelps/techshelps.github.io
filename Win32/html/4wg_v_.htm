<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DlgDirSelectEx</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="4wg_v_"></A><B>DlgDirSelectEx  <A HREF="xbbv6p.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="blmy52.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="53fr_hx.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>DlgDirSelectEx</B> function retrieves the current selection from a single-selection list box. It assumes that the list box has been filled by the <A HREF="eyoakl.htm"><B>DlgDirList</B></A> function and that the selection is a drive letter, filename, or directory name. </P>

<P><B>BOOL DlgDirSelectEx(</B></P>

<TABLE cols=2 width=407>

<TR VALIGN="top">
<TD width=37%><B>HWND</B> <I>hDlg</I><B>,</B></TD>
<TD width=63%>// handle to dialog box with list box </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    LPTSTR</B> <I>lpString</I><B>,</B></TD>
<TD width=63%>// pointer to buffer for path string </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    int</B> <I>nCount</I><B>,</B></TD>
<TD width=63%>// number of characters in path string </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    int</B> <I>nIDListBox</I> </TD>
<TD width=63%>// identifier of list box </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>   );</B></TD>
<TD width=63%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hDlg</I></P>

<P>Identifies the dialog box that contains the list box. </P>

<P><I>lpString</I></P>

<P>Points to a buffer that is to receive the selected path. </P>

<P><I>nCount</I></P>

<P>Specifies the length, in characters, of the buffer pointed to by <I>lpString</I>. </P>

<P><I>nIDListBox</I></P>

<P>Specifies the integer identifier of a list box in the dialog box. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the current selection is a directory name, the return value is nonzero.</P>

<P>If the current selection is not a directory name, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>The <B>DlgDirSelectEx</B> function copies the selection to the buffer pointed to by the <I>lpString</I> parameter. If the current selection is a directory name or drive letter, <B>DlgDirSelectEx</B> removes the enclosing square brackets (and hyphens, for drive letters), so that the name or letter is ready to be inserted into a new path. If there is no selection, <I>lpString</I> does not change. </P>

<P><B>DlgDirSelectEx</B> sends <A HREF="3djc0p.htm">LB_GETCURSEL</A> and <A HREF="3w.ajt.htm">LB_GETTEXT</A> messages to the list box. The function does not allow more than one filename to be returned from a list box. The list box must not be a multiple-selection list box. If it is, this function does not return a zero value and <I>lpString</I> remains unchanged. </P>

<P><B>See Also</B></P>

<P><A HREF="eyoakl.htm"><B>DlgDirList</B></A>, <A HREF="1jzneui.htm"><B>DlgDirListComboBox</B></A>, <A HREF="1e7xwyp.htm"><B>DlgDirSelectComboBoxEx</B></A>, <A HREF="3djc0p.htm">LB_GETCURSEL</A>, <A HREF="3w.ajt.htm">LB_GETTEXT</A> </P>

</BODY>
</HTML>
