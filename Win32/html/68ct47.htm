<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>lstrcpyn</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="68ct47"></A><B>lstrcpyn  <A HREF="9mmb.9.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1r0c_vq.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="21act6p.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>lstrcpyn</B> function copies a specified number of characters from a source string into a buffer. </P>

<P><B>LPTSTR lstrcpyn(</B></P>

<TABLE cols=2 width=439>

<TR VALIGN="top">
<TD width=38%><B>LPTSTR</B> <I>lpString1</I><B>,</B></TD>
<TD width=62%>// address of target buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    LPCTSTR</B> <I>lpString2</I><B>,</B></TD>
<TD width=62%>// address of source string</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    int </B><I>iMaxLength</I><B> </B></TD>
<TD width=62%>// number of bytes or characters to copy</TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>   );</B></TD>
<TD width=62%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpString1</I></P>

<P>Points to a buffer into which the function copies characters. The buffer must be large enough to contain the number of bytes (ANSI version) or characters (Unicode version) specified by <I>iMaxLength</I>, including room for a terminating null character. </P>

<P><I>lpString2</I></P>

<P>Points to a null-terminated string from which the function copies characters.</P>

<P><I>iMaxLength</I></P>

<P>Specifies the number bytes (ANSI version) or characters (Unicode version) to be copied from the string pointed to by <I>lpString2</I> into the buffer pointed to by <I>lpString1</I>, including a terminating null character.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is a pointer to the buffer.</P>

<P>If the function fails, the return value is NULL. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>Note that the buffer pointed to by <I>lpString1</I> must be large enough to include a terminating null character, and the string length value specified by <I>iMaxLength </I>includes room for a terminating null character. Thus, the following code</P>

<P></P>

<P>TCHAR chBuffer[512] ;</P>

<P><BR>
lstrcpyn(chBuffer, "abcdefghijklmnop", 4) ;</P>

<P></P>

<P>... copies the string "abc", followed by a terminating null character, to chBuffer.</P>

<P><B>See Also</B></P>

<P><A HREF="e8v46s.htm"><B>lstrcat</B></A>, <A HREF="e8v4bo.htm"><B>lstrcmp</B></A>, <A HREF="68cpv2.htm"><B>lstrcmpi</B></A>, <A HREF="e8v4ex.htm"><B>lstrcpy</B></A>, <A HREF="e8v_0m.htm"><B>lstrlen</B></A> </P>

</BODY>
</HTML>
