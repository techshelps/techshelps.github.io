<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Customizing the Print Dialog Box</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="q46cn"></A><B>Customizing the Print Dialog Box</B></P>

<P>You can provide a custom template for the Print dialog box, for example, if you want to include additional controls that are unique to your application. The <A HREF="11768vz.htm"><B>PrintDlg</B></A> function uses your custom template in place of the default template. </P>

<P><B><IMG SRC="../images/bm4.gif" ALT="" BORDER=0>To provide a custom template for the Print dialog box</B></P>

<P>1.Create the custom template by modifying the default template specified in the PRNSETUP.DLG file. The control identifiers used in the default Print dialog template are defined in the DLGS.H file.</P>

<P>2.Use the <A HREF="17iw9wo.htm"><B>PRINTDLG</B></A> structure to enable the template as follows:</P>

<P>·If your custom template is a resource in an application or dynamic-link library, set the PD_ENABLEPRINTTEMPLATE flag in the <B>Flags</B> member. Use the <B>hInstance</B> and <B>lpPrintTemplateName</B> members of the structure to identify the module and resource name. </P>

<P><B>-Or-</B></P>

<P>·If your custom template is already in memory, set the PD_ENABLEPRINTTEMPLATEHANDLE flag. Use the <B>hPrintTemplate</B> member to identify the memory object that contains the template.</P>

<P></P>

<P>You can provide a <A HREF="9iia8w.htm"><B>PrintHookProc</B></A> hook procedure for the Print dialog box. The hook procedure can process messages sent to the dialog box. It can also send messages to the dialog box. If you use a custom template to define additional controls, you must provide a hook procedure to process input for your controls. </P>

<P><B><IMG SRC="../images/bm4.gif" ALT="" BORDER=0>To enable a hook procedure for the Print dialog box</B></P>

<P>1.Set the PD_ENABLEPRINTHOOK flag in the <B>Flags</B> member of the <A HREF="17iw9wo.htm"><B>PRINTDLG</B></A> structure.</P>

<P>2.Specify the address of the hook procedure in the <B>lpfnPrintHook</B> member.</P>

<P></P>

<P>After processing its <A HREF="ii1w.b.htm">WM_INITDIALOG</A> message, the dialog box procedure sends a WM_INITDIALOG message to the hook procedure. The <I>lParam</I> parameter of this message is a pointer to the <B>PRINTDLG</B> structure used to initialize the dialog box. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
