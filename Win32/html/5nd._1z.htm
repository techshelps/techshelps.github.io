<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Relaying Mouse Messages to the Tooltip</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="5nd._1z"></A><B>Relaying Mouse Messages to the Tooltip</B></P>

<P>A tooltip control needs to receive mouse messages to determine when to display the tooltip window. Because Windows sends mouse messages only to the window that contains the cursor, you must use the <A HREF="f9xfkr.htm">TTM_RELAYEVENT</A> message to relay mouse messages to the tooltip control. </P>

<P>If a tool is implemented as a rectangular area in an application-defined window, the window procedure receives mouse messages and can relay them to the tooltip control. However, if a tool is implemented as a system-defined window, the mouse messages are sent to the window and are not readily available to the application. You must use a message hook to access and relay the mouse messages, or you must subclass the window. </P>

<P>When a tooltip control receives a relayed <A HREF="1mq_iq2.htm">WM_MOUSEMOVE</A> message, it determines whether the cursor is in the bounding rectangle of a tool. If the cursor is there, the tooltip control sets a timer. At the end of the time-out duration, the tooltip control checks the position of the cursor to see whether it has moved. If the cursor has not, the tooltip control retrieves the text for the tool, copies the text into the tooltip window, and shows the window. The tooltip control continues to show the window until it receives a relayed button-up or button-down message or until a relayed WM_MOUSEMOVE message indicates that the cursor has moved outside the bounding rectangle of the tool. </P>

<P>A tooltip control actually has three time-out durations associated with it. The <I>initial duration</I> is the length of time that the cursor must remain stationary within the bounding rectangle of a tool before the tooltip window is displayed. The <I>reshow duration</I> is the length of the delay before subsequent tooltip windows are displayed when the cursor moves from one tool to another. The <I>autopopup duration</I> is the length of time that the tooltip window remains displayed before it is hidden. That is, if the cursor remains stationary within the bounding rectangle after the tooltip window is displayed, the tooltip window is automatically hidden at the end of the autopopup duration. You can adjust all of the time-out durations by using the <A HREF="pkxoh3.htm">TTM_SETDELAYTIME</A> message. </P>

<P>If an application includes a tool implemented as a rectangular area and the size or position of the control changes, it can use the <A HREF="11viu32.htm">TTM_NEWTOOLRECT</A> message to report the change to the tooltip control. An application does not need to report size and position changes for a tool implemented as a window. Reporting that is not necessary because the tooltip control uses the window handle of a tool to determine if the cursor is on the tool, not the tool's bounding rectangle. </P>

<P>When it is about to be displayed, a tootip control sends the <A HREF="f_d1.o.htm">TTN_SHOW</A> notification to the owner window. A tooltip control sends the <A HREF="3pgcdm5.htm">TTN_POP</A> notification when it is about to be hidden. Each notification is sent in the context of a <A HREF="1mzt7br.htm">WM_NOTIFY</A> message.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
