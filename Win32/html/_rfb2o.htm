<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Processing a Request to Remove a Device</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="_rfb2o"></A><B>Processing a Request to Remove a Device</B></P>

<P>An application receives a <A HREF="_omnvs.htm">DBT_DEVICEQUERYREMOVE</A> message when a component in the system has decided to remove a given device. When the application receives this message, it should determine whether it is using the given device and either cancel or prepare for the removal. In the following example, the application processes the message by checking the type of device that is to be removed. </P>

<P>PDEV_BROADCAST_HDR pdbch;<BR>
PDEV_BROADCAST_VOLUME pdbcv;<BR>
<BR>
case WM_DEVICECHANGE:<BR>
    pdbch = (PDEV_BROADCAST_HDR) lParam;<BR>
    switch (pdbch-&gt;dbch_devicetype) {<BR>
    case DBT_DEVTYP_VOLUME:<BR>
        pdbcv = (PDEV_BROADCAST_VOLUME) pdbch;<BR>
        if (pdbcv-&gt;dbcv_flags == DBTF_MEDIA) <BR>
            // pdbcv-&gt;dbcv_unitmask identifies which logical drive<BR>
        }<BR>
        return TRUE;<BR>
    default:<BR>
        return TRUE;<BR>
    }<BR>
  </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
