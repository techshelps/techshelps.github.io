<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Drawing the Image</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1zcapxp"></A><B>Drawing the Image</B></P>

<P>The following function draws an image and saves the client coordinates of the image's bounding rectangle. A subsequent function uses the bounding rectangle to determine whether the user has clicked the image. </P>

<P>// DrawTheImage - draws an image transparently and saves  </P>

<P>//     the bounding rectangle of the drawn image </P>

<P>// Returns TRUE if successful or FALSE otherwise. </P>

<P>// hwnd - handle of the window in which to draw the image </P>

<P>// himl - handle of the image list that contains the image </P>

<P>// cx and cy - client coordinates for the upper-left corner of the image </P>

<P>// </P>

<P>// Global variables and constants </P>

<P>//     g_nImage - index of the image to draw </P>

<P>//     g_rcImage - bounding rectangle of the image </P>

<P>//     CX_IMAGE and CY_IMAGE - width and height of the image </P>

<P>extern int g_nImage; </P>

<P>extern RECT g_rcImage; </P>

<P></P>

<P>#define CX_IMAGE 32 </P>

<P>#define CY_IMAGE 32 </P>

<P></P>

<P>BOOL DrawTheImage(HWND hwnd, HIMAGELIST himl, int cx, int cy) </P>

<P>{ </P>

<P>HDC hdc; </P>

<P></P>

<P>if ((hdc = GetDC(hwnd)) == NULL) </P>

<P>return FALSE; </P>

<P>if (!ImageList_Draw(himl, g_nImage, hdc, cx, cy, ILD_TRANSPARENT)) </P>

<P>return FALSE; </P>

<P>ReleaseDC(hwnd, hdc); </P>

<P></P>

<P>SetRect(&amp;g_rcImage, cx, cy, CX_IMAGE + cx, CY_IMAGE + cy); </P>

<P></P>

<P>return TRUE; </P>

<P>} </P>

<P></P>

</BODY>
</HTML>
