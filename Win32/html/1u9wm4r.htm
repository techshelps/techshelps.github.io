<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>DdeClientTransaction</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1u9wm4r"></A><B>DdeClientTransaction  <A HREF="97ys.y.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="7m.xby.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="11k0r86.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>DdeClientTransaction</B> function begins a data transaction between a client and a server. Only a dynamic data exchange (DDE) client application can call this function, and the application can use it only after establishing a conversation with the server. </P>

<P><B>HDDEDATA DdeClientTransaction(</B></P>

<TABLE cols=2 width=418>

<TR VALIGN="top">
<TD width=45%><B>LPBYTE</B> <I>pData</I><B>,</B></TD>
<TD width=55%>// pointer to data to pass to server</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    DWORD</B> <I>cbData</I><B>,</B></TD>
<TD width=55%>// length of data</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    HCONV</B> <I>hConv</I><B>,</B></TD>
<TD width=55%>// handle to conversation</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    HSZ</B> <I>hszItem</I><B>,</B></TD>
<TD width=55%>// handle to item name string</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    UINT</B> <I>wFmt</I><B>,</B></TD>
<TD width=55%>// clipboard data format</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    UINT</B> <I>wType</I><B>,</B></TD>
<TD width=55%>// transaction type</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    DWORD</B> <I>dwTimeout</I><B>,</B></TD>
<TD width=55%>// time-out duration</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>    LPDWORD</B> <I>pdwResult</I> </TD>
<TD width=55%>// pointer to transaction result</TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>   );</B></TD>
<TD width=55%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>pData</I></P>

<P>Points to the beginning of the data the client must pass to the server. </P>

<P>Optionally, an application can specify the data handle (HDDEDATA) to pass to the server and in that case the <I>cbData</I> parameter should be set to 0xFFFFFFFF. This parameter is required only if the <I>wType</I> parameter is <A HREF="h.1tqt.htm">XTYP_EXECUTE</A> or <A HREF="3eam_if.htm">XTYP_POKE</A>. Otherwise, this parameter should be NULL. </P>

<P>For the optional usage of this parameter, XTYP_POKE transactions where <I>pData</I> is a data handle, the handle must have been created by a previous call to the <A HREF="hlu46s.htm"><B>DdeCreateDataHandle</B></A> function, employing the same data format specified in the <I>wFmt</I> parameter. </P>

<P><I>cbData</I></P>

<P>Specifies the length, in bytes, of the data pointed to by the <I>pData</I> parameter. A value of 0xFFFFFFFF indicates that <I>pData</I> is a data handle that identifies the data being sent. </P>

<P><I>hConv</I></P>

<P>Identifies the conversation in which the transaction is to take place. </P>

<P><I>hszItem</I></P>

<P>Identifies the data item for which data is being exchanged during the transaction. This handle must have been created by a previous call to the <A HREF="f7z406.htm"><B>DdeCreateStringHandle</B></A> function. This parameter is ignored (and should be set to 0L) if the <I>wType</I> parameter is XTYP_EXECUTE. </P>

<P><I>wFmt</I></P>

<P>Specifies the standard clipboard format in which the data item is being submitted or requested. </P>

<P>If the transaction specified by the <I>wType</I> parameter does not pass data or is XTYP_EXECUTE, this parameter should be zero. </P>

<P>If the transaction specified by the <I>wType</I> parameter references non-execute DDE data (XTYP_POKE, XTYP_ADVSTART, XTYP_ADVSTOP, XTYP_REQUEST), the <I>wFmt</I> value must be either a valid predefined (CF_) DDE format or a valid registered clipboard format. </P>

<P><I>wType</I></P>

<P>Specifies the transaction type. This parameter can be one of the following types: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=33%><B>Type</B></TD>
<TD width=67%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=33%><A HREF="enmoap.htm">XTYP_ADVSTART</A></TD>
<TD width=67%>Begins an advise loop. Any number of distinct advise loops can exist within a conversation. An application can alter the advise loop type by combining the XTYP_ADVSTART transaction type with one or more of the following flags:</TD>
</TR>
</TABLE><BR>

<P></P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=64%><B>Flag</B></TD>
<TD width=36%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=64%>XTYPF_NODATA</TD>
<TD width=36%>Instructs the server to notify the client of any data changes without actually sending the data. This flag gives the client the option of ignoring the notification or requesting the changed data from the server.</TD>
</TR>

<TR VALIGN="top">
<TD width=64%>XTYPF_ACKREQ</TD>
<TD width=36%>Instructs the server to wait until the client acknowledges that it received the previous data item before sending the next data item. This flag prevents a fast server from sending data faster than the client can process it.</TD>
</TR>

<TR VALIGN="top">
<TD width=64%><A HREF="1gakp13.htm">XTYP_ADVSTOP</A></TD>
<TD width=36%>Ends an advise loop.</TD>
</TR>

<TR VALIGN="top">
<TD width=64%><A HREF="h.1tqt.htm">XTYP_EXECUTE</A></TD>
<TD width=36%>Begins an execute transaction.</TD>
</TR>

<TR VALIGN="top">
<TD width=64%><A HREF="3eam_if.htm">XTYP_POKE</A></TD>
<TD width=36%>Begins a poke transaction.</TD>
</TR>

<TR VALIGN="top">
<TD width=64%><A HREF="9d6mc5.htm">XTYP_REQUEST</A></TD>
<TD width=36%>Begins a request transaction.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>dwTimeout</I></P>

<P>Specifies the maximum length of time, in milliseconds, that the client will wait for a response from the server application in a synchronous transaction. This parameter should be TIMEOUT_ASYNC for asynchronous transactions. </P>

<P><I>pdwResult</I></P>

<P>Points to a variable that receives the result of the transaction. An application that does not check the result can use NULL for this value. For synchronous transactions, the low-order word of this variable contains any applicable DDE_ flags resulting from the transaction. This provides support for applications dependent on DDE_APPSTATUS bits. It is, however, recommended that applications no longer use these bits because they may not be supported in future versions of the <A HREF="7m.xby.htm">Dynamic Data Exchange Management Library</A> (DDEML). For asynchronous transactions, this variable is filled with a unique transaction identifier for use with the <A HREF="pem5gi.htm"><B>DdeAbandonTransaction</B></A> function and the XTYP_XACT_COMPLETE transaction. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is a data handle that identifies the data for successful synchronous transactions in which the client expects data from the server. The return value is nonzero for successful asynchronous transactions and for synchronous transactions in which the client does not expect data. The return value is zero for all unsuccessful transactions. </P>

<P><B>Errors</B></P>

<P>The <A HREF="aa7fa.htm"><B>DdeGetLastError</B></A> function can be used to get the error code, which may be one of the following values: </P>

<P>DMLERR_ADVACKTIMEOUT<BR>
DMLERR_BUSY<BR>
DMLERR_DATAACKTIMEOUT<BR>
DMLERR_DLL_NOT_INITIALIZED<BR>
DMLERR_EXECACKTIMEOUT<BR>
DMLERR_INVALIDPARAMETER<BR>
DMLERR_MEMORY_ERROR<BR>
DMLERR_NO_CONV_ESTABLISHED<BR>
DMLERR_NO_ERROR<BR>
DMLERR_NOTPROCESSED<BR>
DMLERR_POKEACKTIMEOUT<BR>
DMLERR_POSTMSG_FAILED<BR>
DMLERR_REENTRANCY<BR>
DMLERR_SERVER_DIED<BR>
DMLERR_UNADVACKTIMEOUT</P>

<P><B>Remarks</B></P>

<P>When an application has finished using the data handle returned by <B>DdeClientTransaction</B>, the application should free the handle by calling the <A HREF="16wlv6r.htm"><B>DdeFreeDataHandle</B></A> function. </P>

<P>Transactions can be synchronous or asynchronous. During a synchronous transaction, <B>DdeClientTransaction</B> does not return until the transaction either completes successfully or fails. Synchronous transactions cause a client to enter a modal loop while waiting for various asynchronous events. Because of this, a client application can still respond to user input while waiting on a synchronous transaction, but the application cannot begin a second synchronous transaction because of the activity associated with the first. <B>DdeClientTransaction</B> fails if any instance of the same task has a synchronous transaction already in progress. </P>

<P>During an asynchronous transaction, <B>DdeClientTransaction</B> returns after the transaction has begun, passing a transaction identifier for reference. When the server's DDE callback function finishes processing an asynchronous transaction, the system sends an XTYP_XACT_COMPLETE transaction to the client. This transaction provides the client with the results of the asynchronous transaction that it initiated by calling <B>DdeClientTransaction</B>. A client application can choose to abandon an asynchronous transaction by calling the <B>DdeAbandonTransaction</B> function. </P>

<P><B>See Also</B></P>

<P><A HREF="pem5gi.htm"><B>DdeAbandonTransaction</B></A>, <A HREF="e421.j.htm"><B>DdeAccessData</B></A>, <A HREF="1_izsoe.htm"><B>DdeConnect</B></A>, <A HREF="g2v2ut.htm"><B>DdeConnectList</B></A>, <A HREF="hlu46s.htm"><B>DdeCreateDataHandle</B></A>, <A HREF="f7z406.htm"><B>DdeCreateStringHandle</B></A>, <A HREF="16wlv6r.htm"><B>DdeFreeDataHandle</B></A>, <A HREF="enmoap.htm">XTYP_ADVSTART</A>, <A HREF="1gakp13.htm">XTYP_ADVSTOP</A>, <A HREF="h.1tqt.htm">XTYP_EXECUTE</A>, <A HREF="3eam_if.htm">XTYP_POKE</A>, <A HREF="9d6mc5.htm">XTYP_REQUEST</A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
