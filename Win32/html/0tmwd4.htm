<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>TerminateThread</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="0tmwd4"></A><B>TerminateThread  <A HREF="2zqttip.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="glns2h.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="7wnz9r.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>TerminateThread</B> function terminates a thread. </P>

<P><B>BOOL TerminateThread(</B></P>

<TABLE cols=2 width=364>

<TR VALIGN="top">
<TD width=49%><B>HANDLE</B> <I>hThread</I><B>,</B></TD>
<TD width=51%>// handle to the thread </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>    DWORD</B> <I>dwExitCode</I> </TD>
<TD width=51%>// exit code for the thread </TD>
</TR>

<TR VALIGN="top">
<TD width=49%><B>   );</B></TD>
<TD width=51%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hThread</I></P>

<P>Identifies the thread to terminate. </P>

<P><B>Windows NT:</B> The handle must have THREAD_TERMINATE access. For more information, see <A HREF="xzntt..htm">Thread Objects</A>.</P>

<P><I>dwExitCode</I></P>

<P>Specifies the exit code for the thread. Use the <A HREF="3yyt_hx.htm"><B>GetExitCodeThread</B></A> function to retrieve a thread's exit value. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P><B>TerminateThread</B> is used to cause a thread to exit. When this occurs, the target thread has no chance to execute any user-mode code and its initial stack is not deallocated. DLLs attached to the thread are not notified that the thread is terminating. </P>

<P><B>TerminateThread</B> is a dangerous function that should only be used in the most extreme cases. You should call <B>TerminateThread</B> only if you know exactly what the target thread is doing, and you control all of the code that the target thread could possibly be running at the time of the termination. For example, <B>TerminateThread</B> can result in the following problems:</P>

<P>·If the target thread owns a critical section, the critical section will not be released. </P>

<P>·If the target thread is executing certain kernel32 calls when it is terminated, the kernel32 state for the thread's process could be inconsistent. </P>

<P>·If the target thread is manipulating the global state of a shared DLL, the state of the DLL could be destroyed, affecting other users of the DLL.</P>

<P></P>

<P>A thread cannot protect itself against <B>TerminateThread</B>, other than by controlling access to its handles. The thread handle returned by the <B>CreateThread</B> and <B>CreateProcess</B> functions has THREAD_TERMINATE access, so any caller holding one of these handles can terminate your thread.</P>

<P>If the target thread is the last thread of a process when this function is called, the thread's process is also terminated. </P>

<P>The state of the thread object becomes signaled, releasing any other threads that had been waiting for the thread to terminate. The thread's termination status changes from STILL_ACTIVE to the value of the <I>dwExitCode</I> parameter. </P>

<P>Terminating a thread does not necessarily remove the thread object from the system. A thread object is deleted when the last thread handle is closed. </P>

<P><B>See Also</B></P>

<P><A HREF="5fbj_xx.htm"><B>CreateProcess</B></A>, <A HREF="70ts0y.htm"><B>CreateThread</B></A>, <A HREF="c.xq03.htm"><B>ExitThread</B></A>, <A HREF="3yyt_hx.htm"><B>GetExitCodeThread</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
