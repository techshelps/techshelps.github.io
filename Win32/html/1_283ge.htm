<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Messages Used with Menus</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1_283ge"></A><B>Messages Used with Menus</B></P>

<P>Windows reports menu-related activity by sending messages to the window procedure of the window that owns the menu. Windows sends a series of messages when the user selects items on the menu bar or clicks the right mouse button to display a shortcut menu.</P>

<P>When the user activates an item on the menu bar, the owner window first receives a <A HREF="3xmtv4t.htm">WM_SYSCOMMAND</A> message. This message includes a flag that indicates whether the user activated the menu by using the keyboard (SC_KEYMENU) or the mouse (SC_MOUSEMENU). For more information about the keyboard interface for menus, see <A HREF="brh.ck.htm">Keyboard Access to Menus</A>.</P>

<P>Next, before displaying any menus, Windows sends the <A HREF="1mpwz20.htm">WM_INITMENU</A> message to the window procedure so that an application can modify the menus before the user sees them. Windows sends the WM_INITMENU message only once per menu activation. </P>

<P>When the user points to a menu item that opens a submenu, Windows sends the owner window the <A HREF="jwh_0q.htm">WM_INITMENUPOPUP</A> message before displaying the submenu. This message gives the application an opportunity to modify the submenu before it is displayed. </P>

<P>Each time the user moves the highlighting from one item to another, Windows sends a <A HREF="ga0xsv.htm">WM_MENUSELECT</A> message to the window procedure of the menu's owner window. This message identifies the currently selected menu item. Many applications provide an information area at the bottom of their main windows and use this message to display additional information about the selected menu item. </P>

<P>When the user chooses a command item from a menu, Windows sends a <A HREF="71v.3j.htm">WM_COMMAND</A> message to the window procedure. The low-order word of the WM_COMMAND message's <I>wParam</I> parameter contains the identifier of the chosen item. The window procedure should examine the identifier and process the message accordingly.</P>

<P>Not all menus are accessible through a window's menu bar. Many applications display shortcut menus when the user clicks the right mouse button at a specific location. Such applications should process the <A HREF="_1f8jj.htm">WM_CONTEXTMENU</A> message and display a shortcut menu, if appropriate. If an application does not display a shortcut menu, it should pass the WM_CONTEXTMENU message to the <A HREF="32d1nbh.htm"><B>DefWindowProc</B></A> function for default processing.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
