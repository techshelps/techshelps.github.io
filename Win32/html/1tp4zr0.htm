<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetMenuState</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1tp4zr0"></A><B>GetMenuState  <A HREF="l4pozz.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="quf.8o.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1agh94..htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetMenuState</B> function retrieves the menu flags associated with the specified menu item. If the menu item opens a submenu, this function also returns the number of items in the submenu. </P>

<P>The <B>GetMenuState</B> function has been superseded by the <A HREF="q9mp7k.htm"><B>GetMenuItemInfo</B></A> function. You can still use <B>GetMenuState</B>, however, if you do not need any of the extended features of <B>GetMenuItemInfo</B>.</P>

<P><B>UINT</B> <B>GetMenuState(</B></P>

<TABLE cols=2 width=307>

<TR VALIGN="top">
<TD width=47%><B>HMENU</B> <I>hMenu</I><B>,</B></TD>
<TD width=53%>// handle of menu </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    UINT</B> <I>uId</I><B>,</B></TD>
<TD width=53%>// menu item to query </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    UINT</B> <I>uFlags</I></TD>
<TD width=53%>// menu flags </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>   );</B></TD>
<TD width=53%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hMenu</I></P>

<P>Identifies the menu that contains the menu item whose flags are to be retrieved. </P>

<P><I>uId</I></P>

<P>Specifies the menu item for which the menu flags are to be retrieved, as determined by the <I>uFlags</I> parameter. </P>

<P><I>uFlags</I></P>

<P>Specifies how the <I>uId</I> parameter is interpreted. This parameter can be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=32%><B>Value</B></TD>
<TD width=68%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=32%>MF_BYCOMMAND</TD>
<TD width=68%>Indicates that the <I>uId</I> parameter gives the identifier of the menu item. The MF_BYCOMMAND flag is the default if neither the MF_BYCOMMAND nor MF_BYPOSITION flag is specified. </TD>
</TR>

<TR VALIGN="top">
<TD width=32%>MF_BYPOSITION</TD>
<TD width=68%>Indicates that the <I>uId</I> parameter gives the zero-based relative position of the menu item. </TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>If the specified item does not exist, the return value is 0xFFFFFFFF. </P>

<P>If the menu item opens a submenu, the low-order byte of the return value contains the menu flags associated with the item, and the high-order byte contains the number of items in the submenu opened by the item. </P>

<P>Otherwise, the return value is a mask (Boolean OR) of the menu flags. Following are the menu flags associated with the menu item. </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=35%><B>Value</B></TD>
<TD width=65%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=35%>MF_CHECKED</TD>
<TD width=65%>Places a check mark next to the item (for drop-down menus, submenus, and shortcut menus only). </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>MF_DISABLED</TD>
<TD width=65%>Disables the item. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>MF_GRAYED</TD>
<TD width=65%>Disables and grays the item. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>MF_HILITE</TD>
<TD width=65%>Highlights the item. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>MF_MENUBARBREAK</TD>
<TD width=65%>Functions the same as the MF_MENUBREAK flag, except for drop-down menus, submenus, and shortcut menus, where the new column is separated from the old column by a vertical line. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>MF_MENUBREAK</TD>
<TD width=65%>Places the item on a new line (for menu bars) or in a new column (for drop-down menus, submenus, and shortcut menus) without separating columns. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>MF_SEPARATOR</TD>
<TD width=65%>Creates a horizontal dividing line (for drop-down menus, submenus, and shortcut menus only). </TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="2kht1bx.htm"><B>GetMenu</B></A>, <A HREF="j8a1fz.htm"><B>GetMenuItemCount</B></A>, <A HREF="ucuox.htm"><B>GetMenuItemID</B></A>, <A HREF="q9mp7k.htm"><B>GetMenuItemInfo</B></A>, <A HREF="1j__pxp.htm"><B>GetMenuString</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
