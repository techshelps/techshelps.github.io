<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>SetTapePosition</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="astp5y"></A><B>SetTapePosition  <A HREF="2nm1zjr.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="3qn63vs.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="a7m4zq.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>SetTapePosition</B> sets the tape position on the specified device. </P>

<P><B>DWORD SetTapePosition(</B></P>

<TABLE cols=2 width=465>

<TR VALIGN="top">
<TD width=47%><B>HANDLE</B> <I>hDevice</I><B>,</B></TD>
<TD width=53%>// handle of open device </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    DWORD</B> <I>dwPositionMethod</I><B>,</B></TD>
<TD width=53%>// type of positioning to perform </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    DWORD</B> <I>dwPartition</I><B>,</B></TD>
<TD width=53%>// new tape partition </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    DWORD</B> <I>dwOffsetLow</I><B>,</B></TD>
<TD width=53%>// low-order 32 bits of tape position </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    DWORD</B> <I>dwOffsetHigh</I><B>,</B></TD>
<TD width=53%>// high-order 32 bits of tape position </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>    BOOL</B> <I>bImmediate</I> </TD>
<TD width=53%>// return after operation begins </TD>
</TR>

<TR VALIGN="top">
<TD width=47%><B>   );</B></TD>
<TD width=53%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hDevice</I></P>

<P>Identifies the device on which to set the tape position. This handle is created by using the <A HREF="xn35yd.htm"><B>CreateFile</B></A> function. </P>

<P><I>dwPositionMethod</I></P>

<P>Specifies the type of positioning to perform. This parameter must be one of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=54%><B>Value</B></TD>
<TD width=46%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=54%>TAPE_ABSOLUTE_BLOCK</TD>
<TD width=46%>Moves the tape to the device-specific block address specified by the <I>dwOffsetLow</I> and <I>dwOffsetHigh</I> parameters. The <I>dwPartition</I> parameter is ignored.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%>TAPE_LOGICAL_BLOCK</TD>
<TD width=46%>Moves the tape to the block address specified by <I>dwOffsetLow</I> and <I>dwOffsetHigh</I> in the partition specified by <I>dwPartition</I>.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%>TAPE_REWIND</TD>
<TD width=46%>Moves the tape to the beginning of the current partition. The <I>dwPartition</I>, <I>dwOffsetLow</I>, and <I>dwOffsetHigh</I> parameters are ignored.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%>TAPE_SPACE_END_OF_DATA</TD>
<TD width=46%>Moves the tape to the end of the data on the partition specified by <I>dwPartition</I>.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%>TAPE_SPACE_FILEMARKS</TD>
<TD width=46%>Moves the tape forward (or backward) the number of filemarks specified by <I>dwOffsetLow</I> and <I>dwOffsetHigh</I> in the current partition. The <I>dwPartition</I> parameter is ignored.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%>TAPE_SPACE_RELATIVE_BLOCKS</TD>
<TD width=46%>Moves the tape forward (or backward) the number of blocks specified by <I>dwOffsetLow</I> and <I>dwOffsetHigh</I> in the current partition. The <I>dwPartition</I> parameter is ignored.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%>TAPE_SPACE_SEQUENTIAL_FMKS</TD>
<TD width=46%>Moves the tape forward (or backward) to the first occurrence of <I>n</I> filemarks in the current partition, where <I>n</I> is the number specified by <I>dwOffsetLow</I> and <I>dwOffsetHigh</I>. The <I>dwPartition</I> parameter is ignored.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%>TAPE_SPACE_SEQUENTIAL_SMKS</TD>
<TD width=46%>Moves the tape forward (or backward) to the first occurrence of <I>n</I> setmarks in the current partition, where <I>n</I> is the number specified by <I>dwOffsetLow</I> and <I>dwOffsetHigh</I>. The <I>dwPartition</I> parameter is ignored.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%> TAPE_SPACE_SETMARKS</TD>
<TD width=46%>Moves the tape forward (or backward) the number of setmarks specified by <I>dwOffsetLow</I> and <I>dwOffsetHigh</I> in the current partition. The <I>dwPartition</I> parameter is ignored.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>dwPartition</I></P>

<P>Specifies the partition to position within. If <I>dwPartition</I> is zero, the current partition is used. Partitions are numbered logically from 1 through <I>n</I>, where 1 is the first partition on the tape and <I>n</I> is the last. </P>

<P><I>dwOffsetLow</I></P>

<P>Specifies the low-order 32 bits of the block address or count for the position operation specified by the <I>dwPositionMethod</I> parameter. </P>

<P><I>dwOffsetHigh</I></P>

<P>Specifies the high-order 32 bits of the block address or count for the position operation specified by the <I>dwPositionMethod</I> parameter. If the high-order 32 bits are not required, this parameter should be zero. </P>

<P><I>bImmediate</I></P>

<P>Indicates whether to return as soon as the move operation begins. If this parameter is TRUE, the function returns immediately; if FALSE, the function does not return until the move operation has been completed. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is NO_ERROR.</P>

<P>If the function fails, the return value is one of the following error codes: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=56%><B>Error</B></TD>
<TD width=44%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_BEGINNING_OF_MEDIA</TD>
<TD width=44%>An attempt to access data before the beginning-of-medium marker failed.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_BUS_RESET</TD>
<TD width=44%>A reset condition was detected on the bus.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_END_OF_MEDIA</TD>
<TD width=44%>The end-of-tape marker was reached during an operation.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_FILEMARK_DETECTED</TD>
<TD width=44%>A filemark was reached during an operation.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_SETMARK_DETECTED</TD>
<TD width=44%>A setmark was reached during an operation.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_NO_DATA_DETECTED</TD>
<TD width=44%>The end-of-data marker was reached during an operation.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_PARTITION_FAILURE</TD>
<TD width=44%>The tape could not be partitioned.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_INVALID_BLOCK_LENGTH</TD>
<TD width=44%>The block size is incorrect on a new tape in a multivolume partition.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_DEVICE_NOT_PARTITIONED</TD>
<TD width=44%>The partition information could not be found when a tape was being loaded.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_MEDIA_CHANGED</TD>
<TD width=44%>The tape that was in the drive has been replaced or removed.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_NO_MEDIA_IN_DRIVE</TD>
<TD width=44%>There is no media in the drive.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_NOT_SUPPORTED</TD>
<TD width=44%>The tape driver does not support a requested function.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_UNABLE_TO_LOCK_MEDIA</TD>
<TD width=44%>An attempt to lock the ejection mechanism failed.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_UNABLE_TO_UNLOAD_MEDIA</TD>
<TD width=44%>An attempt to unload the tape failed.</TD>
</TR>

<TR VALIGN="top">
<TD width=56%>ERROR_WRITE_PROTECT</TD>
<TD width=44%>The media is write protected.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>If the offset specified by <I>dwOffsetLow</I> and <I>dwOffsetHigh</I> specifies the number of blocks, filemarks, or setmarks to move, a positive offset moves the tape forward to the end of the last block, filemark, or setmark. A negative offset moves the tape backward to the beginning of the last block, filemark, or setmark. If the offset is zero, the tape does not move. </P>

<P>To obtain information about the status, capabilities, and capacities of tape drives and media, call the <B>GetTapeParameters</B> function. </P>

<P><B>See Also</B></P>

<P><A HREF="xn35yd.htm"><B>CreateFile</B></A>, <A HREF="zdslum.htm"><B>GetTapeParameters</B></A>, <A HREF=".n08gi.htm"><B>GetTapePosition</B></A> </P>

</BODY>
</HTML>
