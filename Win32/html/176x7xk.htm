<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NetLocalGroupAddMembers</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="176x7xk"></A><B>NetLocalGroupAddMembers  <A HREF="1mvx_or.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="l.g6mo.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="pdpsg.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>NetLocalGroupAddMembers</B> function adds membership of one or more existing user accounts or global groups to an existing local group. The function does not change the membership status of users or global groups that are currently members of the local group.</P>

<P><B>Security Requirements</B></P>

<P>Only members of the Administrators or Account Operators local group can successfully execute <B>NetLocalGroupAddMembers</B> on a remote server.</P>

<P><B>NET_API_STATUS NetLocalGroupAddMembers(</B></P>

<TABLE cols=2 width=377>

<TR VALIGN="top">
<TD width=95%><B>LPWSTR</B> <I>servername</I><B>,</B></TD>
<TD width=5%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=95%><B>    LPWSTR</B> <I>LocalGroupName</I><B>,</B></TD>
<TD width=5%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=95%><B>    DWORD</B> <I>level</I><B>,</B></TD>
<TD width=5%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=95%><B>    LPBYTE</B> <I>buf</I><B>,</B></TD>
<TD width=5%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=95%><B>    DWORD</B> <I>membercount</I></TD>
<TD width=5%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=95%><B>   );</B></TD>
<TD width=5%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>servername</I></P>

<P>Pointer to a null-terminated Unicode string containing the name of the remote server on which the function is to execute. A NULL pointer or string specifies the local computer.</P>

<P><I>LocalGroupName</I></P>

<P>Pointer to a null-terminated Unicode string containing the name of the local group to which the specified users or global groups will be added.</P>

<P><I>level</I></P>

<P>Specifies one of the following values to set the level of information provided.</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=21%><B>Value</B></TD>
<TD width=79%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=21%>0</TD>
<TD width=79%>The <I>buf</I> parameter points to an array of <A HREF="16mgk9f.htm"><B>LOCALGROUP_MEMBERS_INFO_0</B></A> structures.</TD>
</TR>

<TR VALIGN="top">
<TD width=21%>3</TD>
<TD width=79%>The <I>buf</I> parameter points to an array of <A HREF="16fgk9f.htm"><B>LOCALGROUP_MEMBERS_INFO_3</B></A> structures.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>buf</I></P>

<P>Pointer to a buffer containing the data for the new members. </P>

<P><I>membercount</I></P>

<P>Specifies the number of entries in the buffer pointed to by the <I>buf</I> parameter.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is NERR_Success.</P>

<P>If the function fails, the return value is one of the following error codes. </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=45%><B>Value</B></TD>
<TD width=55%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%>NERR_GroupNotFound </TD>
<TD width=55%>The local group specified by the <I>groupname</I> parameter does not exist.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>ERROR_NO_SUCH_MEMBER </TD>
<TD width=55%>One or more of the new members do not exist. Therefore, no new members were added.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>ERROR_MEMBER_IN_ALIAS </TD>
<TD width=55%>One or more of the members specified were already members of the local group. Therefore, no new members were added.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>ERROR_INVALID_MEMBER </TD>
<TD width=55%>One or more of the members cannot be added because their account type is invalid. Therefore, no new members were added.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="sjhnwm.htm"><B>NetLocalGroupAdd</B></A>, <A HREF="u972wl.htm"><B>NetLocalGroupDelMembers</B></A>, <A HREF="_b32u6.htm"><B>NetLocalGroupGetMembers</B></A> </P>

</BODY>
</HTML>
