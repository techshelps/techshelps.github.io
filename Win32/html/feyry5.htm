<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Editing an Enhanced Metafile</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="feyry5"></A><B>Editing an Enhanced Metafile</B></P>

<P>To edit a picture stored in an enhanced metafile, an application must perform the following tasks.</P>

<P>1.Use hit-testing to capture the cursor coordinates and retrieve the position of the object (line, arc, rectangle, ellipse, polygon, or irregular shape) that the user wants to alter. </P>

<P>2.Convert these coordinates to logical (or world) units. </P>

<P>3.Call the <A HREF="16y4a3n.htm"><B>EnumEnhMetaFile</B></A> function and examine each metafile record. </P>

<P>4.Determine whether a given record corresponds to a GDI drawing function. </P>

<P>5.If it does, determine whether the coordinates stored in the record correspond to the line, arc, ellipse, or other graphics element that intersects the coordinates specified by the user. </P>

<P>6.Upon finding the record that corresponds to the output that the user wants to alter, erase the object on the screen that corresponds to the original record. </P>

<P>7.Delete the corresponding record from the metafile, saving a pointer to its location. </P>

<P>8.Permit the user to redraw or replace the object. </P>

<P>9.Convert the GDI functions used to draw the new object into one or more enhanced-metafile records. </P>

<P>10.Store these records in the enhanced metafile. </P>

<P></P>

</BODY>
</HTML>
