<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>LoadModule</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="l7hy._"></A><B>LoadModule  <A HREF="5bje5f.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="ad.gsp.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="14bc1rp.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>LoadModule</B> function loads and executes a Windows-based application or creates a new instance of an existing Windows-based application. </P>

<P>This function is provided for compatibility with earlier versions of Windows. Win32-based applications should use the <A HREF="5fbj_xx.htm"><B>CreateProcess</B></A> function. </P>

<P><B>DWORD LoadModule(</B></P>

<TABLE cols=2 width=518>

<TR VALIGN="top">
<TD width=40%><B>LPCSTR</B> <I>lpModuleName</I><B>,</B></TD>
<TD width=60%>// address of filename to load </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    LPVOID</B> <I>lpParameterBlock</I> </TD>
<TD width=60%>// address of parameter block for new module  </TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>   );</B></TD>
<TD width=60%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpModuleName</I></P>

<P>Points to a null-terminated string that contains the filename of the application to run. If the <I>lpModuleName</I> parameter does not contain a directory path, Windows searches for the executable file in this order: </P>

<P>1.The directory from which the application loaded. </P>

<P>2.The current directory. </P>

<P>3.<B>Windows 95:</B> The Windows system directory. Use the <A HREF="3oj42sv.htm"><B>GetSystemDirectory</B></A> function to get the path of this directory.</P>

<P><B>Windows NT:</B> The 32-bit Windows system directory. Use the <B>GetSystemDirectory</B> function to get the path of this directory. The name of this directory is SYSTEM32.</P>

<P>4.<B>Windows NT:</B> The 16-bit Windows system directory. There is no Win32 function that obtains the path of this directory, but it is searched. The name of this directory is SYSTEM.</P>

<P>5.The Windows directory. Use the <A HREF="1b6tycn.htm"><B>GetWindowsDirectory</B></A> function to get the path of this directory. </P>

<P>6.The directories that are listed in the PATH environment variable. </P>

<P></P>

<P><I>lpParameterBlock</I></P>

<P>Points to an application-defined <B>LOADPARMS32</B> structure that defines the new application's parameter block. </P>

<P>The <B>LOADPARMS32</B> structure has the following form: </P>

<P>typedef struct tagLOADPARMS32 {  </P>

<P>LPSTR lpEnvAddress;  // address of environment strings </P>

<P>LPSTR lpCmdLine;     // address of command line </P>

<P>LPSTR lpCmdShow;     // how to show new program </P>

<P>DWORD dwReserved;    // must be zero </P>

<P>} LOADPARMS32; </P>

<P></P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=26%><B>Member</B></TD>
<TD width=74%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=26%><B>lpEnvAddress</B></TD>
<TD width=74%>Points to an array of null-terminated strings that supply the environment strings for the new process. The array has a value of NULL as its last entry. A value of NULL for this parameter causes the new process to start with the same environment as the calling process.</TD>
</TR>

<TR VALIGN="top">
<TD width=26%><B>lpCmdLine</B></TD>
<TD width=74%>Points to a Pascal-style string that contains a correctly formed command line. The first byte of the string contains the number of bytes in the string. The remainder of the string contains the command line arguments, excluding the name of the child process. If there are no command line arguments, this parameter must point to a zero length string; it cannot be NULL.</TD>
</TR>

<TR VALIGN="top">
<TD width=26%><B>lpCmdShow</B></TD>
<TD width=74%>Points to a structure containing two <B>WORD</B> values. The first value must always be set to two. The second value specifies how the application window is to be shown and is used to supply the <B>wShowWindow</B> member of the <A HREF="d.kh8s.htm"><B>STARTUPINFO</B></A> structure to the <A HREF="5fbj_xx.htm"><B>CreateProcess</B></A><B> </B>function. See the description of the <I>nCmdShow</I> parameter of the <A HREF="3mejbzs.htm"><B>ShowWindow</B></A> function for a list of acceptable values.</TD>
</TR>

<TR VALIGN="top">
<TD width=26%><B>dwReserved</B></TD>
<TD width=74%>This parameter is reserved; it must be zero.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>Set all unused members to NULL, except for <B>lpCmdLine</B>, which must point to a null-terminated string if it is not used. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is greater than 31.</P>

<P>If the function fails, the return value is an error value, which may be one of the following: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=42%><B>Value</B></TD>
<TD width=58%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=42%>0</TD>
<TD width=58%>The system is out of memory or resources.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>ERROR_BAD_FORMAT</TD>
<TD width=58%>The .EXE file is invalid (non-Win32 .EXE or error in .EXE image).</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>ERROR_FILE_NOT_FOUND</TD>
<TD width=58%>The specified file was not found.</TD>
</TR>

<TR VALIGN="top">
<TD width=42%>ERROR_PATH_NOT_FOUND</TD>
<TD width=58%>The specified path was not found.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>Win32-based applications should use the <A HREF="5fbj_xx.htm"><B>CreateProcess</B></A> function. In the Win32 API, the implementation of the <B>LoadModule</B> function calls <B>CreateProcess</B>. The following section describes how each parameter for <B>CreateProcess</B> is formed: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=37%><B>CreateProcess parameter</B></TD>
<TD width=63%><B>Value</B></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><I>lpszImageName</I></TD>
<TD width=63%><B>LoadModule</B> <I>lpModuleName</I> parameter.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><I>lpszCommandLine</I></TD>
<TD width=63%><B>LoadModule</B> <I>lpParameterBlock-&gt;lpCmdLine.</I></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><I>lpsaProcess</I></TD>
<TD width=63%>NULL.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><I>lpsaThread</I></TD>
<TD width=63%>NULL.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><I>fInheritHandles</I></TD>
<TD width=63%>FALSE.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><I>fdwCreate</I></TD>
<TD width=63%>0.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><I>lpvEnvironment</I></TD>
<TD width=63%><B>LoadModule</B> <I>lpParameterBlock-&gt;lpEnvAddress.</I></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><I>lpszCurDir</I></TD>
<TD width=63%>NULL.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><I>lpsiStartInfo</I></TD>
<TD width=63%>The structure is initialized to zero. The <B>cb</B> member is set to the size of the structure, and the <B>wShowWindow</B> member is set to the value of the second word of the <B>LoadModule</B> <I>lpParameterBlock-&gt;lpCmdShow</I> parameter.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><I>lppiProcInfo.hProcess</I></TD>
<TD width=63%>The handle is immediately closed.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><I>lppiProcInfo.hThread</I></TD>
<TD width=63%>The handle is immediately closed.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="5fbj_xx.htm"><B>CreateProcess</B></A>, <A HREF="3oj42sv.htm"><B>GetSystemDirectory</B></A>, <A HREF="1b6tycn.htm"><B>GetWindowsDirectory</B></A>, <A HREF="3mejbzs.htm"><B>ShowWindow</B></A>, <A HREF="d.kh8s.htm"><B>STARTUPINFO</B></A>, <A HREF="12sap3t.htm"><B>WinExec</B></A> </P>

</BODY>
</HTML>
