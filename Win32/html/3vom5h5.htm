<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Using Static Controls</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="3vom5h5"></A><B>Using Static Controls</B></P>

<P>The following example uses a timer and the <A HREF="4n1g_jr.htm">STM_SETIMAGE</A> message to animate an icon in a dialog box. The icon handles and the icon identifier (IDI_ICON) are defined in a global header file. </P>

<P>LRESULT APIENTRY StaticProc(hDlg, message, wParam, lParam)  </P>

<P>HWND hDlg;      /* window handle of dialog box           */ </P>

<P>UINT message;   /* type of message                       */ </P>

<P>UINT wParam;    /* message-specific information          */ </P>

<P>LONG lParam; </P>

<P>{ </P>

<P>UINT idTimer = 1; </P>

<P>static UINT i; </P>

<P></P>

<P>static HICON aIcons[11]; </P>

<P></P>

<P>switch (message) { </P>

<P>case WM_INITDIALOG:             /* initialize dialog box */ </P>

<P>i = 0; </P>

<P></P>

<P>/* Load icons("hinst" is defined globally). */ </P>

<P></P>

<P>hiconOne    = LoadIcon(hinst, "OneIco"); </P>

<P>aIcons[i]   = hiconOne; </P>

<P>hiconTwo    = LoadIcon(hinst, "TwoIco"); </P>

<P>aIcons[++i] = hiconTwo; </P>

<P></P>

<P>. </P>

<P>. /* Continue with the remaining icons. */ </P>

<P>. </P>

<P></P>

<P>i = 0; </P>

<P></P>

<P>/* </P>

<P>* Use STM_SETIMAGE to associate an icon with the </P>

<P>* IDI_ICON identifier. </P>

<P>*/ </P>

<P></P>

<P>SendDlgItemMessage(hDlg,  /* dialog box window handle */ </P>

<P>IDI_ICON,              /* icon identifier          */ </P>

<P>STM_SETIMAGE,          /* message to send          */ </P>

<P>(WPARAM) IMAGE_ICON,   /* image type               */ </P>

<P>(LPARAM) aIcons[i++]); /* icon handle              */ </P>

<P></P>

<P>/* Set a timer for 50-millisecond intervals. */ </P>

<P></P>

<P>SetTimer(hDlg, idTimer, 50, (TIMERPROC) NULL); </P>

<P>return TRUE; </P>

<P></P>

<P>case WM_TIMER: </P>

<P></P>

<P>/* </P>

<P>* Use STM_SETIMAGE to associate a new icon with </P>

<P>* the IDI_ICON identifier whenever a WM_TIMER </P>

<P>* message is received. </P>

<P>*/ </P>

<P></P>

<P>SendDlgItemMessage(hDlg,  /* dialog box window handle */ </P>

<P>IDI_ICON,              /* icon identifier          */ </P>

<P>STM_SETIMAGE,          /* message to send          */ </P>

<P>(WPARAM) IMAGE_ICON,   /* image type               */ </P>

<P>(LPARAM) aIcons[i++]); /* new icon handle          */ </P>

<P>if (i == 10) </P>

<P>i = 0; </P>

<P></P>

<P>break; </P>

<P></P>

<P>case WM_COMMAND: </P>

<P>if (wParam == IDOK </P>

<P>|| wParam == IDCANCEL) { </P>

<P>EndDialog(hDlg, TRUE); </P>

<P>return TRUE; </P>

<P>} </P>

<P>return 0; </P>

<P></P>

<P>case WM_DESTROY: /* clean up  */ </P>

<P>KillTimer(hDlg, idTimer); </P>

<P>DeleteObject(hiconOne); </P>

<P>DeleteObject(hiconTwo); </P>

<P>. </P>

<P>. /* Continue with the remaining icons. */ </P>

<P>. </P>

<P></P>

<P>return 0; </P>

<P>} </P>

<P>return FALSE; </P>

<P>UNREFERENCED_PARAMETER(lParam); </P>

<P>} </P>

<P></P>

</BODY>
</HTML>
