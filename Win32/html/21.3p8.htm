<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Digital Signature Mechanics</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="21.3p8"></A><B>Digital Signature Mechanics</B></P>

<P>Applications sign/verify hash values by using the <A HREF="bod3zd.htm"><B>CryptSignHash</B></A> and <A HREF="dgovgy.htm"><B>CryptVerifySignature</B></A> functions. The application often specifies a description string, which must added to the hash object before it is signed/verified.</P>

<P>The signature process typically goes something like this:</P>

<P>1.The application creates a hash object using <A HREF="4hq3.7.htm"><B>CryptCreateHash</B></A>.</P>

<P>2.The application adds data to the hash object using <A HREF="46c7fgj.htm"><B>CryptHashData</B></A> and/or <A HREF="21hhdd_.htm"><B>CryptHashSessionKey</B></A>.</P>

<P>3.The application calls the <A HREF="bod3zd.htm"><B>CryptSignHash</B></A> function to sign the hash value, specifying a description string.</P>

<P>4.The operating system layer accepts the <B>CryptSignHash</B> invocation, converts the description string to Unicode (if it isn't Unicode already) and then hands off the task to the CSP via the <B>CPSignHash</B> function.</P>

<P>5.The CSP adds the Unicode description string to the hash object, via the <B>CPHashData</B> function. The terminating null character is <I>not</I> hashed in.</P>

<P>6.The CSP completes the hash and obtains the hash value to be signed using the <B>CPGetHashParam</B> function.</P>

<P>7.The CSP takes the hash value, pads it out to the size of the public key modulus, and encrypts it using the signature private key.</P>

<P>The padding around the hash value must be in the format specified by the Public-Key Cryptography Standards (PKCS), available from RSA Data Security. The hash algorithm used must be encoded as described in PKCS #1, section 6.3.</P>

<P>8.The signature block is then returned to the application, via the operating system layer.</P>

<P></P>

</BODY>
</HTML>
