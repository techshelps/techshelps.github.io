<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Writing to a Mailslot</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="0jd_oy"></A><B>Writing to a Mailslot</B></P>

<P>Writing to a mailslot is similar to writing to a standard disk file. The following code uses the <A HREF="xn35yd.htm"><B>CreateFile</B></A>, <A HREF="g0sox_.htm"><B>WriteFile</B></A>, and <A HREF="ngwwie.htm"><B>CloseHandle</B></A> functions to put a short message in a mailslot. The message is broadcast to every computer in the primary domain of the system. </P>

<P>LPSTR lpszMessage = "Message for sample_mailslot in primary domain.";  </P>

<P>BOOL fResult; </P>

<P>HANDLE hFile; </P>

<P>DWORD cbWritten; </P>

<P></P>

<P>hFile = CreateFile("\\\\*\\mailslot\\sample_mailslot", </P>

<P>GENERIC_WRITE, </P>

<P>FILE_SHARE_READ, /* required to write to a mailslot */ </P>

<P>(LPSECURITY_ATTRIBUTES) NULL, </P>

<P>OPEN_EXISTING, </P>

<P>FILE_ATTRIBUTE_NORMAL, </P>

<P>(HANDLE) NULL); </P>

<P></P>

<P>if (hFile == INVALID_HANDLE_VALUE) { </P>

<P>ErrorHandler(hwnd, "Primary domain"); /* local error handler */ </P>

<P>return FALSE; </P>

<P>} </P>

<P></P>

<P>fResult = WriteFile(hFile, </P>

<P>lpszMessage, </P>

<P>(DWORD) lstrlen(lpszMessage) + 1, /* include terminat. null char. */ </P>

<P>&amp;cbWritten, </P>

<P>(LPOVERLAPPED) NULL); </P>

<P></P>

<P>if (!fResult) { </P>

<P>ErrorHandler(hwnd, "WriteFile"); </P>

<P>return FALSE; </P>

<P>} </P>

<P></P>

<P>TextOut(hdc, 10, 10, "WriteFile successful.", 21); </P>

<P></P>

<P>fResult = CloseHandle(hFile); </P>

<P></P>

<P>if (!fResult) { </P>

<P>ErrorHandler(hwnd, "CloseHandle"); </P>

<P>return FALSE; </P>

<P>} </P>

<P></P>

<P>TextOut(hdc, 10, 30, "CloseHandle successful.", 23); </P>

<P>return TRUE; </P>

<P></P>

<P>Messages broadcast to a domain must be no longer than 400 bytes. Messages that are not broadcast should be smaller than 64 kilobytes. There is no limit to the number of messages that can be sent to a mailslot. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
