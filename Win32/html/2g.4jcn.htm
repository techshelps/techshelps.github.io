<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Processing the WM_CHANGECBCHAIN Message</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="2g.4jcn"></A><B>Processing the WM_CHANGECBCHAIN Message</B></P>

<P>A clipboard viewer window receives the <A HREF="4qhort.htm">WM_CHANGECBCHAIN</A> message when another window is removing itself from the clipboard viewer chain. If the window being removed is the next window in the chain, the window receiving the message must unlink the next window from the chain. Otherwise, this message should be passed to the next window in the chain. </P>

<P>The following example shows the processing of the WM_CHANGECBCHAIN message. </P>

<P>case WM_CHANGECBCHAIN:  </P>

<P></P>

<P>// If the next window is closing, repair the chain. </P>

<P></P>

<P>if ((HWND) wParam == hwndNextViewer) </P>

<P>hwndNextViewer = (HWND) lParam; </P>

<P></P>

<P>// Otherwise, pass the message to the next link. </P>

<P></P>

<P>else if (hwndNextViewer != NULL) </P>

<P>SendMessage(hwndNextViewer, uMsg, wParam, lParam); </P>

<P></P>

<P>break; </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
