<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Subclassing and Automatic Message Translation</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="47sgw4e"></A><B>Subclassing and Automatic Message Translation</B></P>

<P>Subclassing is a technique that allows an application to intercept and process messages sent or posted to a particular window before the window has a chance to process them. The system automatically translates messages into ANSI or Unicode form, depending on the form of the function that subclassed the window procedure. </P>

<P>The following call to the <A HREF="d2okir.htm"><B>SetWindowLongA</B></A> function subclasses the current window procedure associated with the window identified by the <I>hwnd</I> parameter. The new window procedure, NewWndProc, will receive messages with text in ANSI format. </P>

<P>OldWndProc = (WNDPROC) SetWindowLongA(hwnd,  </P>

<P>GWL_WNDPROC, (LONG)NewWndProc); </P>

<P></P>

<P>When NewWndProc has finished processing a message, it uses the <A HREF="ncd2vj.htm"><B>CallWindowProc</B></A> function as follows to pass the message to OldWndProc. </P>

<P>CallWindowProc(OldWndProc, hwnd, uMessage, wParam, lParam);  </P>

<P></P>

<P>If OldWndProc was created with a class style of UNICODE, messages will be translated from the ANSI form received by NewWndProc into Unicode. </P>

<P>Similarly, a call to the <A HREF="d2okir.htm"><B>SetWindowLongW</B></A> function would subclass the current window procedure with a window procedure that expects Unicode text messages. Message translation, if necessary, is performed during the processing of the <B>CallWindowProc</B> function. </P>

<P>For more information about subclassing, see <A HREF="1k62v6p.htm">Window Procedures</A>. </P>

</BODY>
</HTML>
