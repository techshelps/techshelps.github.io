<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Creating a Property Sheet</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="m8ths."></A><B>Creating a Property Sheet</B></P>

<P>The example in this section creates a property sheet that contains two pages ¾ one for setting the font properties of a cell in a spreadsheet and another for setting the border properties of the cell. The example defines the pages by filling a pair of <A HREF="xtwnjo.htm"><B>PROPSHEETPAGE</B></A> structures and specifying the address in the <A HREF="e2w30o.htm"><B>PROPSHEETHEADER</B></A> structure that is passed to the <A HREF="uokv08.htm"><B>PropertySheet</B></A> function. The dialog box templates, icons, and labels for the pages are loaded from the resources contained in the application's executable file. The icon for the property sheet is also loaded from the application's resources.</P>

<P>// DoPropertySheet - creates a property sheet that contains two pages.<BR>
// hwndOwner - handle of the owner window of the property sheet<BR>
//<BR>
// Global variables<BR>
//     g_hinst - instance handle<BR>
extern HINSTANCE g_hinst;<BR>
<BR>
VOID DoPropertySheet(HWND hwndOwner)<BR>
{<BR>
    PROPSHEETPAGE psp[2];<BR>
    PROPSHEETHEADER psh;<BR>
<BR>
    psp[0].dwSize = sizeof(PROPSHEETPAGE);<BR>
    psp[0].dwFlags = PSP_USEICONID | PSP_USETITLE;<BR>
    psp[0].hInstance = g_hinst;<BR>
    psp[0].pszTemplate = MAKEINTRESOURCE(DLG_FONT);<BR>
    psp[0].pszIcon = MAKEINTRESOURCE(IDI_FONT);<BR>
    psp[0].pfnDlgProc = FontDialogProc;<BR>
    psp[0].pszTitle = MAKEINTRESOURCE(IDS_FONT)<BR>
    psp[0].lParam = 0;<BR>
    psp[0].pfnCallback = NULL;<BR>
<BR>
    psp[1].dwSize = sizeof(PROPSHEETPAGE);<BR>
    psp[1].dwFlags = PSP_USEICONID | PSP_USETITLE;<BR>
    psp[1].hInstance = g_hinst;<BR>
    psp[1].pszTemplate = MAKEINTRESOURCE(DLG_BORDER);<BR>
    psp[1].pszIcon = MAKEINTRESOURCE(IDI_BORDER);<BR>
    psp[1].pfnDlgProc = BorderDialogProc;<BR>
    psp[1].pszTitle = MAKEINTRESOURCE(IDS_BORDER);<BR>
    psp[1].lParam = 0;<BR>
    psp[1].pfnCallback = NULL;<BR>
<BR>
    psh.dwSize = sizeof(PROPSHEETHEADER);<BR>
    psh.dwFlags = PSH_USEICONID | PSH_PROPSHEETPAGE;<BR>
    psh.hwndParent = hwndOwner;<BR>
    psh.hInstance = g_hinst;<BR>
    psh.pszIcon = MAKEINTRESOURCE(IDI_CELL_PROPERTIES);<BR>
    psh.pszCaption = (LPSTR) "Cell Properties";<BR>
    psh.nPages = sizeof(psp) / sizeof(PROPSHEETPAGE);<BR>
    psh.nStartPage = 0;<BR>
    psh.ppsp = (LPCPROPSHEETPAGE) &amp;psp;<BR>
    psh.pfnCallback = NULL;<BR>
<BR>
    PropertySheet(&amp;psh);<BR>
    return;<BR>
}<BR>
  </P>

</BODY>
</HTML>
