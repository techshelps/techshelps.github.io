<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>ClearEventLog</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="17vs5zp"></A><B>ClearEventLog  <A HREF="456z_wk.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="ejmiui.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="gw7e2k.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>ClearEventLog</B> function clears the specified event log, and optionally saves the current copy of the logfile to a backup file. </P>

<P><B>BOOL ClearEventLog(</B></P>

<TABLE cols=2 width=398>

<TR VALIGN="top">
<TD width=57%><B>HANDLE</B> <I>hEventLog</I><B>,</B></TD>
<TD width=43%>// handle to event log </TD>
</TR>

<TR VALIGN="top">
<TD width=57%><B>    LPCTSTR</B> <I>lpBackupFileName</I> </TD>
<TD width=43%>// name of backup file  </TD>
</TR>

<TR VALIGN="top">
<TD width=57%><B>   );</B></TD>
<TD width=43%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hEventLog</I></P>

<P>Identifies the event log to be cleared. This handle is returned by the <A HREF="1rc9es8.htm"><B>OpenEventLog</B></A> function. </P>

<P><I>lpBackupFileName</I></P>

<P>Points to the null-terminated string specifying the name of a file in which a current copy of the event logfile will be placed. If this file already exists, the function fails. </P>

<P>The backup filename may contain a server name to save the backup file on a remote server. </P>

<P>If the <I>lpBackupFileName</I> parameter is NULL, the current event logfile is not backed up. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero. The specified event log has been backed up (if <I>lpBackupFileName</I> is not NULL) and then cleared.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>The <B>ClearEventLog</B> function fails if the event log is empty. </P>

<P>After this function returns, any handles that reference the cleared event log cannot be used to read the log. </P>

<P>If the backup filename specifies a remote server, the event log handle must identify a log on the local computer. You cannot back up an event logfile from a remote server to a file on a remote server (even if the backup file and the original log are on the same server). </P>

<P>The <B>ClearEventLog</B> function is used to optionally back up an existing logfile of the module represented by <I>hEventLog</I>. The function backs up the logfile to another file, and then clears the existing logfile. The caller must have write permission for the path specified, and must also have permission to move the current logfile. If a file already exists with the same name as <I>lpBackupFileName</I>, <B>ClearEventLog</B> fails. </P>

<P><B>See Also</B></P>

<P><A HREF="1rc9es8.htm"><B>OpenEventLog</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
