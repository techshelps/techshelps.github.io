<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Private Display Device Contexts</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1m9zug"></A><B>Private Display Device Contexts</B></P>

<P>A <I>private DC</I> enables an application to avoid retrieving and initializing a display DC each time the application must draw in a window. Private DCs are useful for windows that require many changes to the values of the attributes of the DC to prepare it for drawing. Private DCs reduce the time required to prepare the DC and therefore the time needed to carry out drawing in the window. </P>

<P>An application directs Windows to create a private DC for a window by specifying the CS_OWNDC style in the window class. Windows creates a unique private DC each time it creates a new window belonging to the class. Initially, the private DC has the same default values for attributes as a common DC, but the application can modify these at any time. Windows preserves changes to the DC for the life of the window or until the application makes additional changes. </P>

<P>An application can retrieve the handle of the private DC by using the <A HREF="4f0b0z.htm"><B>GetDC</B></A> function any time after the window is created. The application must retrieve the handle only once. Thereafter, it can keep and use the handle any number of times. Because a private DC is not part of the display DC cache, an application need never release the DC by using the <A HREF="p4bes3.htm"><B>ReleaseDC</B></A> function. </P>

<P>Windows automatically adjusts the DC to reflect changes to the window, such as moving or sizing. This ensures that any overlapping windows are always properly clipped; that is, no action is required by the application to ensure clipping. However, Windows does not revise the DC to include the update region. Therefore, when processing a <A HREF="f55xz2.htm">WM_PAINT</A> message, the application must incorporate the update region either by calling <A HREF="f7ytuy.htm"><B>BeginPaint</B></A> or by retrieving the update region and intersecting it with the current clipping region. If the application does not call <B>BeginPaint</B>, it must explicitly validate the update region by using the <A HREF="8yy2ru.htm"><B>ValidateRect</B></A> or <A HREF="5kn81a.htm"><B>ValidateRgn</B></A> function. If the application does not validate the update region, the window receives an endless series of WM_PAINT messages. </P>

<P>Because <B>BeginPaint</B> hides the caret if a window is showing it, an application that calls <B>BeginPaint</B> should also call the <A HREF="8d6uz5.htm"><B>EndPaint</B></A> function to restore the caret. <B>EndPaint </B>has no other effect on a private DC. </P>

<P>Although a private DC is convenient to use, it is expensive in terms of system resources, requiring 800 or more bytes to store. Private DCs are recommended when performance considerations outweigh storage costs. </P>

<P>Windows includes the private DC when sending the <A HREF="fey63i.htm">WM_ERASEBKGND</A> message to the application. The current selections of the private DC, including mapping mode, are in effect when the application or Windows processes these messages. To avoid undesirable effects, Windows uses logical coordinates when erasing the background; for example, it uses the <A HREF="2zii_sv.htm"><B>GetClipBox</B></A> function to retrieve the logical coordinates of the area to erase and passes these coordinates to the <A HREF="4aij_gf.htm"><B>FillRect</B></A> function. Applications that process these messages can use similar techniques. Windows supplies a window DC with the <A HREF="223p0.j.htm">WM_ICONERASEBKGND</A> message regardless of whether the corresponding window has a private DC. </P>

<P>An application can use the <A HREF="4m9cxu5.htm"><B>GetDCEx</B></A> function to force Windows to return a common DC for the window that has a private DC. This is useful for carrying out quick touch-ups to a window without changing the current values of the attributes of the private DC. </P>

</BODY>
</HTML>
