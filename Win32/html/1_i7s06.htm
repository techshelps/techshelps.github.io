<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>CreateWindowStation</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1_i7s06"></A><B>CreateWindowStation  <A HREF="2ng0lvb.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="3ocly5.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="2ggw8w5.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>CreateWindowStation</B> function creates a window station object. It returns a handle that can be used to access the window station. A window station is a secure object that contains a set of global atoms, a clipboard, and a set of desktop objects.</P>

<P><B>HWINSTA CreateWindowStation(</B></P>

<TABLE cols=2 width=583>

<TR VALIGN="top">
<TD width=43%><B>LPTSTR</B> <I>lpwinsta</I><B>,</B></TD>
<TD width=57%>// name of the new window station</TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>    DWORD </B><I>dwReserved</I><B>,</B></TD>
<TD width=57%>// reserved; must be NULL</TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>    DWORD</B> <I>dwDesiredAccess</I><B>,</B></TD>
<TD width=57%>// specifies access of returned handle</TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>    LPSECURITY_ATTRIBUTES</B> <I>lpsa</I></TD>
<TD width=57%>// specifies security attributes of the window station</TD>
</TR>

<TR VALIGN="top">
<TD width=43%><B>   );</B></TD>
<TD width=57%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpwinsta</I></P>

<P>Optionally points to a null-terminated string specifying the name of the window station to be created. Window station names are case-insensitive and cannot contain backslash characters (\). Only members of the Administrators group are allowed to specify a name. If <I>lpwinsta </I>is NULL, the system forms a window station name using the logon session identifier for the calling process. To get this name, call the <A HREF="7e6eys.htm"><B>GetUserObjectInformation</B></A> function.</P>

<P><I>dwReserved</I></P>

<P>Reserved; must be NULL.</P>

<P><I>dwDesiredAccess</I></P>

<P>Specifies the type of access to the window station. This parameter can be one or more of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=43%><B>Value</B></TD>
<TD width=57%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WINSTA_ACCESSCLIPBOARD</TD>
<TD width=57%>Required to use the clipboard.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WINSTA_ACCESSGLOBALATOMS</TD>
<TD width=57%>Required to manipulate global atoms.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WINSTA_CREATEDESKTOP</TD>
<TD width=57%>Required to create new desktop objects on the window station.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WINSTA_ENUMDESKTOPS</TD>
<TD width=57%>Required to enumerate existing desktop objects.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WINSTA_ENUMERATE</TD>
<TD width=57%>Required for the window station to be enumerated.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WINSTA_EXITWINDOWS</TD>
<TD width=57%>Required to successfully call the <A HREF="hxsw5w.htm"><B>ExitWindows</B></A> or <A HREF="ma6lrq.htm"><B>ExitWindowsEx</B></A> functions.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WINSTA_READATTRIBUTES</TD>
<TD width=57%>Required to read the attributes of a window station object.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WINSTA_READSCREEN</TD>
<TD width=57%>Required to access screen contents.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>WINSTA_WRITEATTRIBUTES</TD>
<TD width=57%>Required to modify the attributes of a window station object.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lpsa</I></P>

<P>Pointer to a <A HREF="be53kg.htm"><B>SECURITY_ATTRIBUTES</B></A> structure that determines whether the returned handle can be inherited by child processes. If <I>lpsa</I> is NULL, the handle cannot be inherited. </P>

<P><B>Windows NT:</B> The <B>lpSecurityDescriptor</B> member of the structure specifies a security descriptor for the new window station. If <I>lpsa</I> is NULL, the window station (and any desktops created within the window) gets a security descriptor that grants GENERIC_ALL access to all users. </P>

<P><B>Windows 95:</B> The <B>lpSecurityDescriptor</B> member of the structure is ignored.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is the handle to the newly created window station.</P>

<P>If the function fails, the return value is NULL. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>.</P>

<P><B>See Also</B></P>

<P><A HREF="7e6eys.htm"><B>GetUserObjectInformation</B></A>, <A HREF="3o8ycvo.htm"><B>OpenWindowStation</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
