<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>UpdateResource</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="pi90pd"></A><B>UpdateResource  <A HREF="_dip5y.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="18ajhao.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1u_ybcp.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>UpdateResource</B> function adds, deletes, or replaces a resource in an executable file. </P>

<P><B>BOOL UpdateResource(</B></P>

<TABLE cols=2 width=431>

<TR VALIGN="top">
<TD width=38%><B>HANDLE</B> <I>hUpdate</I><B>,</B></TD>
<TD width=62%>// update-file handle </TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    LPCTSTR</B> <I>lpType</I><B>,</B></TD>
<TD width=62%>// address of resource type to update </TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    LPCTSTR</B> <I>lpName</I><B>,</B></TD>
<TD width=62%>// address of resource name to update  </TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    WORD</B> <I>wLanguage</I><B>,</B></TD>
<TD width=62%>// language identifier of resource </TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    LPVOID</B> <I>lpData</I><B>,</B></TD>
<TD width=62%>// address of resource data </TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>    DWORD</B> <I>cbData</I> </TD>
<TD width=62%>// length of resource data, in bytes </TD>
</TR>

<TR VALIGN="top">
<TD width=38%><B>   );</B></TD>
<TD width=62%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hUpdate</I></P>

<P>Specifies an update-file handle. This handle is returned by the <A HREF="1k2mpik.htm"><B>BeginUpdateResource</B></A> function. </P>

<P><I>lpType</I></P>

<P>Points to a null-terminated string specifying the resource type to be updated. This parameter can also be an integer value passed to the <A HREF="xfoy9_.htm"><B>MAKEINTRESOURCE</B></A> macro, or it can be one of the following predefined resource types: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=36%><B>Value</B></TD>
<TD width=64%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_ACCELERATOR</TD>
<TD width=64%>Accelerator table</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_ANICURSOR</TD>
<TD width=64%>Animated cursor</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_ANIICON</TD>
<TD width=64%>Animated icon</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_BITMAP</TD>
<TD width=64%>Bitmap resource</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_CURSOR</TD>
<TD width=64%>Hardware-dependent cursor resource</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_DIALOG</TD>
<TD width=64%>Dialog box</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_FONT</TD>
<TD width=64%>Font resource</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_FONTDIR</TD>
<TD width=64%>Font directory resource</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_GROUP_CURSOR</TD>
<TD width=64%>Hardware-independent cursor resource</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_GROUP_ICON</TD>
<TD width=64%>Hardware-independent icon resource</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_ICON</TD>
<TD width=64%>Hardware-dependent icon resource</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_MENU</TD>
<TD width=64%>Menu resource</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_MESSAGETABLE</TD>
<TD width=64%>Message-table entry</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_RCDATA</TD>
<TD width=64%>Application-defined resource (raw data)</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_STRING</TD>
<TD width=64%>String-table entry</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>RT_VERSION</TD>
<TD width=64%>Version resource</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lpName</I></P>

<P>Points to a null-terminated string specifying the name of the resource to be updated. This parameter can also be an integer value passed to the <A HREF="xfoy9_.htm"><B>MAKEINTRESOURCE</B></A> macro.  </P>

<P><I>wLanguage</I></P>

<P>Specifies the language identifier of the resource to be updated. For a list of the primary language identifiers and sublanguage identifiers that make up a language identifier, see the <A HREF="y265b.htm"><B>MAKELANGID</B></A> macro </P>

<P><I>lpData</I></P>

<P>Points to the resource data to be inserted into the executable file. If the resource is one of the predefined types, the data must be valid and properly aligned. Note that this is the raw binary data stored in the executable file, not the data provided by <A HREF="15isc96.htm"><B>LoadIcon</B></A>, <A HREF="53jmqz.htm"><B>LoadString</B></A>, or other resource-specific load functions. All data containing strings or text must be in Unicode format; <I>lpData</I> must not point to ANSI data. </P>

<P>If <I>lpData</I> is NULL, the specified resource is deleted from the executable file. </P>

<P><I>cbData</I></P>

<P>Specifies the size, in bytes, of the resource data at <I>lpData</I>. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>An application can use <B>UpdateResource</B> repeatedly to make changes to the resource data. Each call to <B>UpdateResource</B> contributes to an internal list of additions, deletions, and replacements but does not actually write the data to the executable file. The application must use the <B>EndUpdateResource</B> function to write the accumulated changes to the executable file. </P>

<P><B>See Also</B></P>

<P><A HREF="1k2mpik.htm"><B>BeginUpdateResource</B></A>, <A HREF="1n7znk..htm"><B>EndUpdateResource</B></A>, <A HREF="15isc96.htm"><B>LoadIcon</B></A>, <A HREF="53jmqz.htm"><B>LoadString</B></A>, <A HREF="4294_ok.htm"><B>LockResource</B></A>, <A HREF="xfoy9_.htm"><B>MAKEINTRESOURCE</B></A>, <A HREF="y265b.htm"><B>MAKELANGID</B></A>, <A HREF="7_3qrs.htm"><B>SizeofResource</B></A> </P>

</BODY>
</HTML>
