<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WriteProcessMemory</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="_4c4hp"></A><B>WriteProcessMemory  <A HREF="3fb5ps5.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1txdzye.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="19cj0x..htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>WriteProcessMemory</B> function writes memory in a specified process. The entire area to be written to must be accessible, or the operation fails. </P>

<P><B>BOOL WriteProcessMemory(</B></P>

<TABLE cols=2 width=595>

<TR VALIGN="top">
<TD width=46%><B>HANDLE</B> <I>hProcess</I><B>,</B></TD>
<TD width=54%>// handle to process whose memory is written to  </TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    LPVOID</B> <I>lpBaseAddress</I><B>,</B></TD>
<TD width=54%>// address to start writing to </TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    LPVOID</B> <I>lpBuffer</I><B>,</B></TD>
<TD width=54%>// pointer to buffer to write data to</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    DWORD</B> <I>nSize</I><B>,</B></TD>
<TD width=54%>// number of bytes to write</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    LPDWORD</B> <I>lpNumberOfBytesWritten</I> </TD>
<TD width=54%>// actual number of bytes written </TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>   );</B></TD>
<TD width=54%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hProcess</I></P>

<P>Identifies an open handle to a process whose memory is to be written to. The handle must have PROCESS_VM_WRITE and PROCESS_VM_OPERATION access to the process. </P>

<P><I>lpBaseAddress</I></P>

<P>Points to the base address in the specified process to be written to. Before any data transfer occurs, the system verifies that all data in the base address and memory of the specified size is accessible for write access. If this is the case, the function proceeds; otherwise, the function fails. </P>

<P><I>lpBuffer</I></P>

<P>Points to the buffer that supplies data to be written into the address space of the specified process. </P>

<P><I>nSize</I></P>

<P>Specifies the requested number of bytes to write into the specified process. </P>

<P><I>lpNumberOfBytesWritten</I></P>

<P>Points to the actual number of bytes transferred into the specified process. This parameter is optional. If <I>lpNumberOfBytesWritten</I> is NULL, the parameter is ignored. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. The function will fail if the requested write operation crosses into an area of the process that is inaccessible. </P>

<P><B>Remarks</B></P>

<P><B>WriteProcessMemory</B> copies the data from the specified buffer in the current process to the address range of the specified process. Any process that has a handle with PROCESS_VM_WRITE and PROCESS_VM_OPERATION access to the process to be written to can call the function. The process whose address space is being written to is typically, but not necessarily, being debugged. </P>

<P>The entire area to be written to must be accessible. If it is not, the function fails as noted previously. </P>

<P><B>See Also</B></P>

<P><A HREF="2rlm_kf.htm"><B>ReadProcessMemory</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
