<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ColorMatchToTarget</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1vs412p"></A><B>ColorMatchToTarget  <A HREF="2be6615.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="4rpr8h.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="g4w1cv.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>ColorMatchToTarget</B> function enables or disables preview for the specified device context. When preview is enabled, colors in subsequent output to the specified device context are displayed as they would appear on the target device. This is useful for checking how well the target maps the specified colors in an image. To enable preview, image color matching must be enabled for both the target and the preview device context. </P>

<P><B>BOOL ColorMatchToTarget(</B></P>

<TABLE cols=2 width=195>

<TR VALIGN="top">
<TD width=80%><B>HDC</B> <I>hdc</I><B>,</B> </TD>
<TD width=20%> </TD>
</TR>

<TR VALIGN="top">
<TD width=80%><B>    HDC</B> <I>hdcTarget</I><B>,</B><I> </I></TD>
<TD width=20%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=80%><B>    DWORD</B> <I>uiAction</I> </TD>
<TD width=20%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=80%><B>   );</B></TD>
<TD width=20%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hdc</I></P>

<P>Handle to the device context to use for preview, typically the display.</P>

<P><I>hdcTarget</I></P>

<P>Handle to the target device context, typically a printer.</P>

<P><I>uiAction</I></P>

<P>This parameter can have one of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=43%><B>Value</B></TD>
<TD width=57%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=43%>CS_ENABLE</TD>
<TD width=57%>Enable preview; start matching colors through the target before displaying.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>CS_DISABLE</TD>
<TD width=57%>Disable preview; stop matching colors through the target and restore the previous method for the preview device.</TD>
</TR>

<TR VALIGN="top">
<TD width=43%>CS_DELETE_TRANSFORM</TD>
<TD width=57%>Disable preview and delete the color transformation used for previewing.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. </P>

<P><B>Remarks</B></P>

<P>If you use the <B>ColorMatchToTarget</B> function to enable preview, your next call to this function must be to disable preview; you must <I>not</I> nest calls to enable preview. While preview is enabled, any changes you make to the color space or gamut matching method are temporarily ignored, but take effect when preview is disabled. </P>

<P>This function creates a color transformation that translates colors for the target device first, then translates colors for the preview device. You need not delete the color transformation using CS_DELETE_TRANSFORM because the system deletes the transformation when either of the devices is removed from the system, or when the color space is deleted. However, if the transform is not going to be used again, an application can free up the space taken by it.</P>

</BODY>
</HTML>
