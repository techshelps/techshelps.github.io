<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Service Startup</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="ig_1xt"></A><B>Service Startup</B></P>

<P>To start a service or driver service, the service control program uses the <A HREF="1osmk1p.htm"><B>StartService</B></A> function. The <B>StartService</B> function fails if the database is locked. If this occurs, the service control program should wait a few seconds and call <B>StartService</B> again. It can check the current lock status of the database by calling the <A HREF="dkgkou.htm"><B>QueryServiceLockStatus</B></A> function. </P>

<P>If the service control program is starting a service, it can use the <B>StartService</B> function to specify an array of arguments to be passed to the service's <A HREF="y7r.4o.htm"><B>ServiceMain</B></A> function. The <B>StartService</B> function returns after a new thread has been created to execute the <B>ServiceMain</B> function. The service control program can retrieve the status of the newly started service in a <A HREF="25uoeu.htm"><B>SERVICE_STATUS</B></A> structure by calling the <A HREF="jps..c.htm"><B>QueryServiceStatus</B></A> function. During initialization, the <B>dwCurrentState</B> member should be SERVICE_START_PENDING. The <B>dwWaitHint</B> member is a time interval, in milliseconds, that indicates how long the service control program should wait before calling <B>QueryServiceStatus</B> again. When the initialization is complete, the service changes <B>dwCurrentState</B> to SERVICE_RUNNING. </P>

<P>If the program is starting a driver service, <B>StartService</B> returns after the device driver has completed its initialization. </P>

<P>For more information, see <A HREF="2l9wfvk.htm">Starting a Service</A>. </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
