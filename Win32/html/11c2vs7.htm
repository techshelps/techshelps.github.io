<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetLastError</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="11c2vs7"></A><B>GetLastError  <A HREF="2piehp5.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="a0ni3i.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="j_xnxj.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetLastError</B> function returns the calling thread's last-error code value. The last-error code is maintained on a per-thread basis. Multiple threads do not overwrite each other's last-error code. </P>

<P><B>DWORD GetLastError(VOID)</B><BR>
 </P>

<P><B>Parameters</B></P>

<P>This function has no parameters. </P>

<P><B>Return Values</B></P>

<P>The return value is the calling thread's last-error code value. Functions set this value by calling the <A HREF="34n8_rg.htm"><B>SetLastError</B></A> function. The <B>Return Value</B> section of each reference page notes the conditions under which the function sets the last-error code. </P>

<P><B>Remarks</B></P>

<P>You should call the <B>GetLastError </B>function immediately when a function's return value indicates that such a call will return useful data. That is because some functions call <B>SetLastError</B>(0) when they succeed, wiping out the error code set by the most recently failed function. </P>

<P>Most functions in the Win32 API that set the thread's last error code value set it when they fail; a few functions set it when they succeed. Function failure is typically indicated by a return value error code such as FALSE, NULL, 0xFFFFFFFF, or -1. Some functions call <B>SetLastError </B>under conditions of success; those cases are noted in each function's reference page.</P>

<P>Error codes are 32-bit values (bit 31 is the most significant bit). Bit 29 is reserved for application-defined error codes; no system error code has this bit set. If you are defining an error code for your application, set this bit to one. That indicates that the error code has been defined by an application, and ensures that your error code does not conflict with any error codes defined by the operating system. </P>

<P>To obtain an error string for operating system error codes, use the <B>FormatMessage</B> function. For a complete list of error codes, see the WINNT.H header file in the Win32 SDK.</P>

<P><B>See Also</B></P>

<P><A HREF="n7qrmp.htm"><B>FormatMessage</B></A><B>, <A HREF="34n8_rg.htm">SetLastError</A></B>, <A HREF="38ar_s6.htm"><B>SetLastErrorEx</B></A> </P>

</BODY>
</HTML>
