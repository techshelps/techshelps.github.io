<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IExtractIcon::Extract [Now Supported on Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="hdx87o"></A><B>IExtractIcon::Extract  <A HREF="10xcgo.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A></B></P>

<P>[Now Supported on Windows NT]</P>

<P>Extracts an icon image from the specified location.</P>

<P><B>HRESULT Extract(</B></P>

<TABLE cols=2 width=474>

<TR VALIGN="top">
<TD width=37%><B>LPCSTR </B><I>pszFile</I><B>,</B></TD>
<TD width=63%>//Points to the icon location specifier</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    UINT</B> <I>nIconIndex</I><B>,</B></TD>
<TD width=63%>//Icon index</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    HICON</B> *<I>phiconLarge</I><B>,</B></TD>
<TD width=63%>//Points to variable for large icon handle</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    HICON</B> *<I>phiconSmall</I><B>,</B></TD>
<TD width=63%>//Points to variable for small icon handle</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    UINT</B> <I>nIconSize</I></TD>
<TD width=63%>//Specifies the size of the large icon required</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>   );</B></TD>
<TD width=63%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>pszFile</I></P>

<P>Pointer to a null-terminated string specifying the icon location.</P>

<P><I>nIconIndex</I></P>

<P>Icon index.</P>

<P><I>phiconLarge</I> and <I>phiconSmall</I></P>

<P>Pointer to the variable that receives the handle of the large icon.</P>

<P><I>phiconSmall</I></P>

<P>Pointer to the variable that receives the handle of the small icon.</P>

<P><I>nIconSize</I></P>

<P>Value specifying the size, in pixels, of the icon required. The LOWORD and HIWORD specify the size of the large and small icons, respectively. The size specified can be the width or height. The width of an icon always equals its height.</P>

<P></P>

<P><B>Return Values</B></P>

<P>Returns NOERROR if the function extracted the icon or S_FALSE if the calling application should extract the icon.</P>

<P><B>Remarks</B></P>

<P>The icon location and index are the same values returned by the <A HREF="dudl04.htm"><B>IExtractIcon::GetIconLocation</B></A> method. If this function returns S_FALSE, these values must specify an icon filename and index that form legal parameters for a call to <B>ExtractIcon</B>. If this function does not return S_FALSE, the calling application should make no assumptions about the meanings of the <I>pszFile</I> and <I>nIconIndex</I> parameters.</P>

<P><B>See Also</B></P>

<P><A HREF="5338sx.htm"><B>IExtractIcon</B></A>, <A HREF="dudl04.htm"><B>IExtractIcon::GetIconLocation</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
