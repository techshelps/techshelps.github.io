<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>WNetGetUniversalName</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="fxhg7w"></A><B>WNetGetUniversalName  <A HREF="nk.v4.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="mzc0i..htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="jc0l02.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>WNetGetUniversalName</B> function takes a drive-based path for a network resource and obtains a data structure that contains a more universal form of the name. </P>

<P><B>DWORD WNetGetUniversalName(</B></P>

<TABLE cols=2 width=590>

<TR VALIGN="top">
<TD width=33%><B>LPCTSTR</B> <I>lpLocalPath</I><B>,</B></TD>
<TD width=67%>// pointer to drive-based path for a network resource</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>    DWORD</B> <I>dwInfoLevel</I><B>,</B></TD>
<TD width=67%>// specifies form of universal name to be obtained</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>    LPVOID</B> <I>lpBuffer</I><B>,</B></TD>
<TD width=67%>// pointer to buffer that receives universal name data structure</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>    LPDWORD</B> <I>lpBufferSize</I> </TD>
<TD width=67%>// pointer to variable that specifies size of buffer</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>   );</B></TD>
<TD width=67%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpLocalPath</I></P>

<P>Points to a null-terminated string that is a drive-based path for a network resource.</P>

<P>For example, if drive H has been mapped to a network drive share, and the network resource of interest is a file named SAMPLE.DOC in the directory \WIN32\EXAMPLES on that share, the drive-based path is H:\WIN32\EXAMPLES\SAMPLE.DOC.</P>

<P><I>dwInfoLevel</I></P>

<P>Specifies the type of data structure that the function will store in the buffer pointed to by <I>lpBuffer</I>. This parameter can be one of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=47%><B>Value</B></TD>
<TD width=53%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=47%>UNIVERSAL_NAME_INFO_LEVEL</TD>
<TD width=53%>The function will store a <B>UNIVERSAL_NAME_INFO</B> data structure in the buffer.</TD>
</TR>

<TR VALIGN="top">
<TD width=47%>REMOTE_NAME_INFO_LEVEL_</TD>
<TD width=53%>The function will store a <B>REMOTE_NAME_INFO</B> data structure in the buffer.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>The <A HREF="k6d.sk.htm"><B>UNIVERSAL_NAME_INFO</B></A> data structure points to a Universal Naming Convention (UNC) name string. </P>

<P><I>lpBuffer</I></P>

<P>Points to a buffer that receives the type of data structure specified by the <I>dwInfoLevel</I> parameter.</P>

<P><I>lpBufferSize</I></P>

<P>Points to a variable that specifies the size in bytes of the buffer pointed to by <I>lpBuffer</I>.</P>

<P>If the function succeeds, it sets the variable pointed to by <I>lpBufferSize</I> to the size in bytes of the data structure stored in the buffer. If the function fails because the buffer is too small, indicated by the ERROR_MORE_DATA error code, it sets the variable pointed to by <I>lpBufferSize </I>to the required buffer size.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is NO_ERROR.</P>

<P>If the function fails, the return value is an error code. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. <B>GetLastError</B> may return one of the following error codes: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=48%><B>Value</B></TD>
<TD width=52%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=48%>ERROR_BAD_DEVICE</TD>
<TD width=52%>The string pointed to by <I>lpLocalPath</I> is invalid.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>ERROR_CONNECTION_UNAVAIL</TD>
<TD width=52%>There is no current connection to the remote device, but there is a remembered (persistent) connection to it.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>ERROR_EXTENDED_ERROR</TD>
<TD width=52%>A network-specific error occurred. Use the <A HREF="1kvezqm.htm"><B>WNetGetLastError</B></A><B> </B>function to obtain a description of the error.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>ERROR_MORE_DATA</TD>
<TD width=52%>The buffer pointed to by <I>lpBuffer</I> is too small. The function sets the variable pointed to by <I>lpBufferSize</I> to the required buffer size. More entries are available with subsequent calls.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>ERROR_NOT_SUPPORTED</TD>
<TD width=52%>The <I>dwInfoLevel</I> parameter was set to UNIVERSAL_NAME_INFO_LEVEL, but the network provider does not support UNC  names. This function is not supported by any of the network providers. </TD>
</TR>

<TR VALIGN="top">
<TD width=48%>ERROR_NO_NET_OR_BAD_PATH</TD>
<TD width=52%>None of the providers recognized this local name as having a connection. However, the network is not available for at least one provider to whom the connection may belong. </TD>
</TR>

<TR VALIGN="top">
<TD width=48%>ERROR_NO_NETWORK</TD>
<TD width=52%>There is no network present.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>ERROR_NOT_CONNECTED</TD>
<TD width=52%>The device specified by <I>lpLocalPath</I> is not redirected. </TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>A universal form of a local drive-based path identifies a network resource in an unambiguous, computer-independent manner. The name can then be passed to processes on other computers, allowing those processes to obtain access to the resource.</P>

<P>The <B>WNetGetUniversalName</B> function currently supports one universal name form: universal naming convention (UNC) names, which look like the following:</P>

<P>\\servername\sharename\path\file  </P>

<P></P>

<P>Using the example from the preceding description of the <I>lpLocalPath</I> parameter, if the shared network drive is on a server named COOLSERVER, and the share name is HOTSHARE, the UNC name for the network resource whose drive-based name is H:\WIN32\EXAMPLES\SAMPLE.DOC would be</P>

<P>\\coolserver\hotshare\win32\examples\sample.doc  </P>

<P></P>

<P>The <B>UNIVERSAL_NAME_INFO</B> data structure contains a pointer to a UNC name string. The <B>REMOTE_NAME_INFO</B> data structure contains a pointer to a UNC name string. It also includes pointers to two other useful strings. A process can pass the <B>REMOTE_NAME_INFO</B> structure's <B>lpszConnectionInfo</B> member into the <B>WNetAddConnection2</B> function to connect a local device to the network resource, and then append the string pointed to by the <B>lpszRemainingPath</B> member to the local device string. The resulting string can be passed to Win32 functions that use a drive-based path.</P>

<P><B>See Also</B></P>

<P><A HREF="32c3vhe.htm"><B>REMOTE_NAME_INFO</B></A>, <A HREF="k6d.sk.htm"><B>UNIVERSAL_NAME_INFO</B></A>, <A HREF="xgb4k0.htm"><B>WNetAddConnection2</B></A>, <A HREF="1kvezqm.htm"><B>WNetGetLastError</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
