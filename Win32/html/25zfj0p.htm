<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>VerQueryValue</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="25zfj0p"></A><B>VerQueryValue  <A HREF="122x8f.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="13zskj.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="hdit7h.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>VerQueryValue</B> function returns selected version information from the specified version-information resource. To retrieve the appropriate resource, the <A HREF="272vywb.htm"><B>GetFileVersionInfo</B></A> function must be called before <B>VerQueryValue</B>. </P>

<P>As with the other file installation functions, <B>VerQueryValue</B> will only work with Win32 file images. 16-bit Windows file images are not supported. </P>

<P><B>BOOL VerQueryValue(</B></P>

<TABLE cols=2 width=453>

<TR VALIGN="top">
<TD width=40%><B>const LPVOID</B> <I>pBlock</I><B>,</B></TD>
<TD width=60%>// address of buffer for version resource</TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    LPTSTR</B> <I>lpSubBlock</I><B>,</B></TD>
<TD width=60%>// address of value to retrieve</TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    LPVOID</B> <B>*</B><I>lplpBuffer</I><B>,</B></TD>
<TD width=60%>// address of buffer for version pointer</TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>    PUINT</B> <I>puLen</I> </TD>
<TD width=60%>// address of version-value length buffer</TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>   );</B></TD>
<TD width=60%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>pBlock</I></P>

<P>Points to the buffer containing the version-information resource returned by <B>GetFileVersionInfo</B>. </P>

<P><I>lpSubBlock</I></P>

<P>Points to a zero-terminated string specifying which version-information value to retrieve. The string consists of names separated by backslashes (\) and can have one of the following forms: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=58%><B>Form</B></TD>
<TD width=42%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=58%><B>\</B></TD>
<TD width=42%>Specifies the root block. The function retrieves a pointer to the <A HREF="0icgl.htm"><B>VS_FIXEDFILEINFO</B></A> structure for the version-information resource.</TD>
</TR>

<TR VALIGN="top">
<TD width=58%>\VarFileInfo\Translation</TD>
<TD width=42%>Specifies the translation table in the variable information structure. The function retrieves a pointer to an array of language and character-set identifiers. An application uses these identifiers to create the name of a language-specific structure in the version-information resource.</TD>
</TR>

<TR VALIGN="top">
<TD width=58%><B>\StringFileInfo\</B>lang-charset<B>\</B>string-name</TD>
<TD width=42%>Specifies a value in a language-specific structure. The <I>lang-charset</I> name is a concatenation of a language and character-set identifier pair found in the translation table for the resource. The <I>lang-charset</I> name must be specified as a hexadecimal string. The <I>string-name</I> name is one of the predefined strings described in the following Remarks section.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>lplpBuffer</I></P>

<P>Points to a buffer that receives a pointer to the version-information value. </P>

<P><I>puLen</I></P>

<P>Points to a buffer that receives the length, in characters, of the version-information value. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the specified structure exists and version information is available, the return value is nonzero. If the address of the length buffer is zero, no value is available for the specified version-information name.</P>

<P>If the specified name does not exist or the specified resource is not valid, the return value is zero. </P>

<P><B>Remarks</B></P>

<P>The Win32 API contains the following predefined version information strings: </P>

<P>CompanyName FileDescription FileVersion InternalName LegalCopyright OriginalFilename ProductName ProductVersion </P>

<P>The following example shows how to retrieve the FileDescription string-value from a block of version information: </P>

<P>VerQueryValue(pBlock,  </P>

<P>TEXT("\\StringFileInfo\\040904E4\\FileDescription"), </P>

<P>&amp;lpBuffer, </P>

<P>&amp;dwBytes); </P>

<P></P>

<P>Call the <B>GetFileVersionInfoSize</B> and <B>GetFileVersionInfo</B> functions to properly initialize the <I>pBlock</I> buffer before calling the <B>VerQueryValue</B> function. </P>

<P><B>See Also</B></P>

<P><A HREF="272vywb.htm"><B>GetFileVersionInfo</B></A>, <A HREF="fi4k.b.htm"><B>GetFileVersionInfoSize</B></A>, <A HREF="0icgl.htm"><B>VS_FIXEDFILEINFO</B></A>, <A HREF="dpv_1j.htm"><B>VS_VERSION_INFO</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
