<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ExtractIconEx</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="j4ymkk"></A><B>ExtractIconEx  <A HREF="ja3ksf.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="9ymza7.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="k0wmjb.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>ExtractIconEx</B> function retrieves the handle of an icon from the specified executable file, dynamic-link library (DLL), or icon file. </P>

<P><B>HICON ExtractIconEx(</B></P>

<TABLE cols=2 width=408>

<TR VALIGN="top">
<TD width=54%><B>LPCSTR</B> <I>lpszFile</I><B>,</B></TD>
<TD width=46%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><B>    int </B><I>nIconIndex</I><B>,</B></TD>
<TD width=46%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><B>    HICON FAR *</B> <I>phiconLarge</I><B>,</B></TD>
<TD width=46%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><B>    HICON FAR *</B> <I>phiconSmall</I><B>,</B></TD>
<TD width=46%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><B>    UINT</B> <I>nIcons</I> </TD>
<TD width=46%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><B>   );</B></TD>
<TD width=46%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpszFile</I></P>

<P>Pointer to a null-terminated string specifying the name of an executable file, DLL, or icon file.</P>

<P><I>nIconIndex</I></P>

<P>Specifies the index of the icon to retrieve. If this value is 0, the function returns the handle of the first icon in the specified file. If this value is -1 and <I>phIconLarge</I>and <I>phiconSmall</I> are both NULL, the function returns the total number of icons in the specified file.</P>

<P><I>phiconLarge</I></P>

<P>Pointer to an array of handles of large icons returned. This parameter can be NULL.</P>

<P><I>phiconSmall</I></P>

<P>Pointer to an array of handles of small icons returned. This parameter can be NULL.</P>

<P><I>nIcons</I></P>

<P>Specifies the count of the number of icons to extract.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is the handle to an icon. If the file specified was not an executable file, DLL, or icon file, the return value is 1. If no icons were found in the file, the return value is NULL.</P>

<P><B>See Also</B></P>

<P><A HREF="191zn5o.htm"><B>ExtractIcon</B></A></P>

</BODY>
</HTML>
