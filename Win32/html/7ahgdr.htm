<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>NDdeShareGetInfo</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="7ahgdr"></A><B>NDdeShareGetInfo  <A HREF="3owdogx.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="g0og1h.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="vyjzi3.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>NDdeShareGetInfo</B> function is called to retrieve DDE share information from the DSDM. This is usually done for editing. </P>

<P><B>UINT NDdeShareGetInfo(</B></P>

<TABLE cols=2 width=487>

<TR VALIGN="top">
<TD width=46%><B>LPTSTR</B> <I>lpszServer</I><B>,</B></TD>
<TD width=54%>// server to execute on</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    LPTSTR</B> <I>lpszShareName</I><B>,</B></TD>
<TD width=54%>// name of share</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    UINT</B> <I>nLevel</I><B>,</B></TD>
<TD width=54%>// info level must be 2</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    LPBYTE</B> <I>lpBuffer</I><B>,</B></TD>
<TD width=54%>// contains (NDDESHAREINFO) + data</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    DWORD</B> <I>cBufSize</I><B>,</B></TD>
<TD width=54%>// size of buffer</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    LPDWORD</B> <I>lpnTotalAvailable</I><B>,</B></TD>
<TD width=54%>// number of bytes available</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    LPWORD</B> <I>lpnItems</I> </TD>
<TD width=54%>// item mask for partial getinfo</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>   );</B></TD>
<TD width=54%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpszServer</I></P>

<P>Address of the server name on which the DSDM resides. </P>

<P><I>lpszShareName</I></P>

<P>Address of the share name whose information is to be retrieved from the DSDM. This parameter must not be NULL. </P>

<P><I>nLevel</I></P>

<P>Must be 2. </P>

<P><I>lpBuffer</I></P>

<P>Address of a buffer that is to accept the <A HREF="4wt._8i.htm"><B>NDDESHAREINFO</B></A> structure and associated data pointed to by <B>NDDESHAREINFO</B> pointer fields. This field can be NULL. If <I>lpBuffer</I> is NULL, then the DSDM calculates the number of bytes required to store the requested share information and returns that value in the <I>lpnTotalAvailable</I> field along with the NDDE_BUF_TOO_SMALL error. </P>

<P><I>cBufSize</I></P>

<P>Defines the size of the buffer addressed by the <I>lpBuffer</I> field. If <I>lpBuffer</I> is NULL, then <I>cBufSize</I> should be 0. </P>

<P><I>lpnTotalAvailable</I></P>

<P>Address of a varaible that receives the count of the total number of bytes needed to store the requested share information. This parameter must not be NULL. </P>

<P><I>lpnItems</I></P>

<P>Address of an item selection mask for partial share information retrieval. For the first release of Windows NT, the item selection mask must be 0. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is NDDE_NO_ERROR.</P>

<P>If the function fails, the return value is an error code, which can be translated into a text error message by calling <A HREF="i0y5fj.htm"><B>NDdeGetErrorString</B></A>. If the <I>lpBuffer</I> parameter is NULL, it returns NDDE_BUF_TOO_SMALL. </P>

<P><B>See Also</B></P>

<P><A HREF="4wt._8i.htm"><B>NDDESHAREINFO</B></A>, <A HREF="joso0d.htm"><B>NDdeShareSetInfo</B></A></P>

</BODY>
</HTML>
