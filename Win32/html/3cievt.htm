<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WM_MOUSEWHEEL [New - Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="3cievt"></A><B>WM_MOUSEWHEEL  <A HREF="5mbz_8u.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="2sg9_qv.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="1ln96v..htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>[New - Windows NT]</P>

<P>The WM_MOUSEWHEEL message is sent to the focus window when the mouse wheel is rotated. The DefWindowProc function propagates the message to the window's parent. There should be no internal forwarding of the message, since DefWindowProc propagates it up the parent chain until it finds a window that processes it.</P>

<P>WM_MOUSEWHEEL</P>

<P>fwKeys = LOWORD(wParam);    // key flags</P>

<P>zDelta = (short) HIWORD(wParam);    // wheel rotation</P>

<P>xPos = (short) LOWORD(lParam);    // horizontal position of pointer</P>

<P>yPos = (short) HIWORD(lParam);    // vertical position of pointer</P>

<P></P>

<P><B>Parameters</B></P>

<P><I>fwKeys</I></P>

<P>Value of the low-order word of <I>wParam</I>. Indicates whether various virtual keys are down. This parameter can be any combination of the following values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=30%><B>Value</B></TD>
<TD width=70%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=30%>MK_CONTROL</TD>
<TD width=70%>Set if the CTRL key is down.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>MK_LBUTTON</TD>
<TD width=70%>Set if the left mouse button is down.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>MK_MBUTTON</TD>
<TD width=70%>Set if the middle mouse button is down.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>MK_RBUTTON</TD>
<TD width=70%>Set if the right mouse button is down.</TD>
</TR>

<TR VALIGN="top">
<TD width=30%>MK_SHIFT</TD>
<TD width=70%>Set if the SHIFT key is down.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>zDelta</I></P>

<P>The value of the high-order word of <I>wParam</I>. Indicates the distance that the wheel is rotated, expressed in multiples or divisions of WHEEL_DELTA, which is 120. A positive value indicates that the wheel was rotated forward, away from the user; a negative value indicates that the wheel was rotated backward, toward the user.</P>

<P><I>xPos</I></P>

<P>Value of the low-order word of <I>lParam</I>. Specifies the x-coordinate of the pointer, relative to the upper-left corner of the screen.</P>

<P><I>yPos</I></P>

<P>Value of the high-order word of <I>lParam</I>. Specifies the y-coordinate of the pointer, relative to the upper-left corner of the screen.</P>

<P></P>

<P><B>Remarks</B></P>

<P>The zDelta parameter will be a multiple of WHEEL_DELTA, which is set at 120. This is the threshold for action to be taken, and one such action (for example, scrolling one increment) should occur for each delta.</P>

<P>The delta was set to 120 to allow Microsoft or other vendors to build finer-resolution wheels in the future, including perhaps a freely-rotating wheel with no notches. The expectation is that such a device would send more messages per rotation, but with a smaller value in each message. To support this possibility, you should either add the incoming delta values until WHEEL_DELTA is reached (so for a given delta-rotation you get the same response), or scroll partial lines in response to the more frequent messages. You could also choose your scroll granularity and accumulate deltas until it is reached.</P>

<P><B>See Also</B></P>

<P><A HREF="jolchi.htm"><B>GetSystemMetrics</B></A>, <A HREF="4i.4ca.htm"><B>mouse_event</B></A>, <A HREF="flzd_g.htm"><B>SystemParametersInfo</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
