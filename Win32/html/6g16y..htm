<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>WNetCancelConnection2</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="6g16y."></A><B>WNetCancelConnection2  <A HREF="hcn8h8.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="mzc0i..htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="jc0l02.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>WNetCancelConnection2</B> function breaks an existing network connection. It can also be used to remove remembered network connections that are not currently connected. This function supersedes <B>WNetCancelConnection</B>.</P>

<P><B>DWORD WNetCancelConnection2(</B></P>

<TABLE cols=2 width=437>

<TR VALIGN="top">
<TD width=36%><B>LPTSTR</B> <I>lpName</I><B>,</B></TD>
<TD width=64%>// pointer to resource name to disconnect </TD>
</TR>

<TR VALIGN="top">
<TD width=36%><B>    DWORD</B> <I>dwFlags</I><B>,</B></TD>
<TD width=64%>// connection type flags </TD>
</TR>

<TR VALIGN="top">
<TD width=36%><B>    BOOL</B> <I>fForce</I> </TD>
<TD width=64%>// flag for unconditional disconnect </TD>
</TR>

<TR VALIGN="top">
<TD width=36%><B>   );</B></TD>
<TD width=64%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpName</I></P>

<P>Points to a null-terminated string that specifies the name of either the redirected local device or the remote network resource to disconnect from. If this parameter specifies a redirected local resource, only the specified redirection is broken; otherwise, all connections to the remote network resource are broken. </P>

<P><I>dwFlags</I></P>

<P>Specifies a bitmask for the connection type. The following values are defined: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=47%><B>Value</B></TD>
<TD width=53%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=47%>0</TD>
<TD width=53%>No stored information about the connection is updated. If the connection was marked as persistent in the registry, Windows will still restore the connection at the next logon. If the connection was not marked as persistent, the function ignores the setting of the CONNECT_UPDATE_PROFILE flag.</TD>
</TR>

<TR VALIGN="top">
<TD width=47%>CONNECT_UPDATE_PROFILE</TD>
<TD width=53%>The user profile is updated with the information that this is no longer a persistent connection. Windows will not restore this connection during subsequent logon operations. Disconnecting resources using remote names has no effect on persistent connections.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><I>fForce</I></P>

<P>Specifies whether the disconnection should occur even if there are open files or jobs on the connection. If this parameter is FALSE, the function fails if there are open files or jobs. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is NO_ERROR. </P>

<P>If the function fails, the return value is an error code. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. <B>GetLastError</B> may return one of the following error codes: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=52%><B>Value</B></TD>
<TD width=48%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=52%>ERROR_BAD_PROFILE</TD>
<TD width=48%>The user profile is in an incorrect format.</TD>
</TR>

<TR VALIGN="top">
<TD width=52%>ERROR_CANNOT_OPEN_PROFILE</TD>
<TD width=48%>The system is unable to open the user profile to process persistent connections.</TD>
</TR>

<TR VALIGN="top">
<TD width=52%>ERROR_DEVICE_IN_USE</TD>
<TD width=48%>The device is in use by an active process and cannot be disconnected.</TD>
</TR>

<TR VALIGN="top">
<TD width=52%>ERROR_EXTENDED_ERROR</TD>
<TD width=48%>A network-specific error occurred. To get a description of the error, use the <A HREF="1kvezqm.htm"><B>WNetGetLastError</B></A> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=52%>ERROR_NOT_CONNECTED</TD>
<TD width=48%>The name specified by the <I>lpName</I> parameter is not a redirected device, or the system is not currently connected to the device specified by the parameter.</TD>
</TR>

<TR VALIGN="top">
<TD width=52%>ERROR_OPEN_FILES</TD>
<TD width=48%>There are open files, and the <I>fForce</I> parameter is FALSE.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="1nkk0yr.htm"><B>WNetAddConnection</B></A>, <A HREF="xgb4k0.htm"><B>WNetAddConnection2</B></A>, <A HREF="1jpn47k.htm"><B>WNetAddConnection3</B></A>, <A HREF="1xo3_ts.htm"><B>WNetCancelConnection</B></A>, <A HREF="apyuz6.htm"><B>WNetGetConnection</B></A>, <A HREF="1kvezqm.htm"><B>WNetGetLastError</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
