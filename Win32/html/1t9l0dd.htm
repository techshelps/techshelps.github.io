<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ImageEnumerateCertificates [Now Supported on Windows NT]</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1t9l0dd"></A><B>ImageEnumerateCertificates  <A HREF="f9awz_.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A></B></P>

<P>[Now Supported on Windows NT]</P>

<P>The <B>ImageEnumerateCertificates</B> function is used to return information about the certificates currently contained in an image file.</P>

<P><B>BOOL ImageEnumerateCertificates(</B></P>

<TABLE cols=2 width=327>

<TR VALIGN="top">
<TD width=89%><B>IN HANDLE </B><I>FileHandle</I><B>,</B></TD>
<TD width=11%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=89%><B>    IN DWORD </B><I>TypeFilter</I><B>,</B></TD>
<TD width=11%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=89%><B>    OUT PDWORD </B><I>CertificateCount</I><B>,</B></TD>
<TD width=11%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=89%><B>    IN OUT PDWORD </B><I>Indices</I><B> OPTIONAL,</B></TD>
<TD width=11%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=89%><B>    IN OUT DWORD </B><I>IndexCount</I><B> OPTIONAL</B></TD>
<TD width=11%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=89%><B>   );</B></TD>
<TD width=11%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>FileHandle</I></P>

<P>This supplies a handle to the image file to be examined. This handle must be opened for FILE_READ_DATA access.</P>

<P><I>TypeFilter</I> </P>

<P>This supplies a DICE certificate section type to be used as a filter when returning certificate information. DICE_SECTION_TYPE_ANY should be passed for information on all section types present in the image.</P>

<P><I>CertificateCount</I></P>

<P>This is filled in with the number of certificates in the image containing sections of the type specified by the <I>TypeFilter </I>parameter. If none are found, this parameter will return zero .</P>

<P><I>Indices</I></P>

<P>This optionally provides a buffer to use to return an array of indices to the certificates containing sections of the specified type. No ordering should be assumed for the index values, nor are they guaranteed to be contiguous when DICE_SECTION_TYPE_ANY is queried.</P>

<P><I>IndexCount</I></P>

<P>This supplies the length in DWORDs of the <I>Indices </I>buffer. This parameter will be examined whenever <I>Indices</I> is present. If <I>CertificateCount</I> is greater than <I>IndexCount</I>, <I>Indices</I> will be filled in with the first <I>IndexCount</I> sections found in the image and an appropriate warning will be returned.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is TRUE.</P>

<P>If the function fails, then the return value is FALSE. To retrieve extended error information, call <B>GetLastError</B>.</P>

<P><B>Remarks</B></P>

<P>The <B>ImageEnumerateCertificates</B> function returns information about the certificates currently contained in an image file. It has filtering capabilities which allow certificates containing sections of any single type (or of any type) to be returned.</P>

<P>Once the indices of interesting certificates are discovered, they can be passed into <B>ImageGetCertificateData</B> to obtain the actual bodies of the certificates.</P>

<P><B>Windows NT:</B> This function is not available under Windows NT 3.51; it was introduced in Windows NT 4.0.</P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
