<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Scrolling a Screen Buffer's Contents</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="kwwuha"></A><B>Scrolling a Screen Buffer's Contents</B></P>

<P>The <A HREF="0m6cbe.htm"><B>ScrollConsoleScreenBuffer</B></A> function moves a block of character cells from one part of a screen buffer to another part of the same screen buffer. The function specifies the upper left and lower right cells of the source rectangle to be moved and the destination coordinates of the new location for the upper left cell. The character and color data in the source cells is moved to the new location, and any cells left empty by the move are filled in with a specified character and color. If a clipping rectangle is specified, the cells outside of it are left unchanged. </P>

<P><B>ScrollConsoleScreenBuffer</B> can be used to delete a line by specifying coordinates of the first cell in the line as the destination coordinates and specifying a scrolling rectangle that includes all the rows below the line. </P>

<P>The following example shows the use of a clipping rectangle to scroll only the bottom 15 rows of the screen buffer. The rows in the specified rectangle are scrolled up one line at a time, and the top row of the block is discarded. The contents of the screen buffer outside the clipping rectangle are left unchanged. </P>

<P>HANDLE hStdout;  </P>

<P>BOOL fSuccess; </P>

<P>CONSOLE_SCREEN_BUFFER_INFO csbiInfo; </P>

<P>SMALL_RECT srctScrollRect, srctClipRect; </P>

<P>CHAR_INFO chiFill; </P>

<P>COORD coordDest; </P>

<P></P>

<P>hStdout = GetStdHandle(STD_OUTPUT_HANDLE); </P>

<P>if (hStdout == INVALID_HANDLE_VALUE) </P>

<P>MyErrorExit("GetStdHandle"); </P>

<P></P>

<P>/* Get the screen buffer size. */ </P>

<P></P>

<P>fSuccess = GetConsoleScreenBufferInfo(hStdout, &amp;csbiInfo); </P>

<P>if (! fSuccess) </P>

<P>MyErrorExit("GetConsoleScreenBufferInfo"); </P>

<P></P>

<P>/* </P>

<P>* The scrolling rectangle is the bottom 15 rows of the </P>

<P>* screen buffer. </P>

<P>*/ </P>

<P></P>

<P>srctScrollRect.Top = csbiInfo.dwSize.Y - 16; </P>

<P>srctScrollRect.Bottom = csbiInfo.dwSize.Y - 1; </P>

<P>srctScrollRect.Left = 0; </P>

<P>srctScrollRect.Right = csbiInfo.dwSize.X - 1; </P>

<P></P>

<P>/* The destination for the scroll rectangle is one row up. */ </P>

<P></P>

<P>coordDest.X = 0; </P>

<P>coordDest.Y = csbiInfo.dwSize.Y - 17; </P>

<P></P>

<P>/* </P>

<P>* The clipping rectangle is the same as the scrolling rectangle. </P>

<P>* The destination row is left unchanged. </P>

<P>*/ </P>

<P></P>

<P>srctClipRect = srctScrollRect; </P>

<P></P>

<P>/* Fill the bottom row with green blanks. */ </P>

<P></P>

<P>chiFill.Attributes = BACKGROUND_GREEN | FOREGROUND_RED; </P>

<P>chiFill.Char.AsciiChar = ' '; </P>

<P></P>

<P>/* Scroll up one line. */ </P>

<P></P>

<P>fSuccess = ScrollConsoleScreenBuffer( </P>

<P>hStdout,         /* screen buffer handle     */ </P>

<P>&amp;srctScrollRect, /* scrolling rectangle      */ </P>

<P>&amp;srctClipRect,   /* clipping rectangle       */ </P>

<P>coordDest,       /* top left destination cell*/ </P>

<P>&amp;chiFill);       /* fill character and color */ </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
