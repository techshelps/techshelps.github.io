<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>RegSaveKey</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="2_uq_4o"></A><B>RegSaveKey  <A HREF="16g8.wr.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1y7hnby.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="vm.h_d.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>RegSaveKey</B> function saves the specified key and all of its subkeys and values to a new file. </P>

<P><B>LONG RegSaveKey(</B></P>

<TABLE cols=2 width=591>

<TR VALIGN="top">
<TD width=58%><B>HKEY</B> <I>hKey</I><B>,</B></TD>
<TD width=42%>// handle of key where save begins  </TD>
</TR>

<TR VALIGN="top">
<TD width=58%><B>    LPCTSTR</B> <I>lpFile</I><B>,</B></TD>
<TD width=42%>// address of filename to save to </TD>
</TR>

<TR VALIGN="top">
<TD width=58%><B>    LPSECURITY_ATTRIBUTES</B> <I>lpSecurityAttributes</I> </TD>
<TD width=42%>// address of security structure </TD>
</TR>

<TR VALIGN="top">
<TD width=58%><B>   );</B></TD>
<TD width=42%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hKey</I></P>

<P>Specifies a handle of the key where the save operation is to begin, or any of the following predefined reserved handle values: </P>

<P><B>HKEY_CLASSES_ROOT</B><BR>
<B>HKEY_CURRENT_USER</B><BR>
<B>HKEY_LOCAL_MACHINE</B><BR>
<B>HKEY_USERS</B></P>

<P><I>lpFile</I></P>

<P>Points to a null-terminated string containing the name of the file in which the specified key and subkeys are saved. This file cannot already exist. If this filename includes an extension, it cannot be used on file allocation table (FAT) file systems by the <A HREF="134z9cn.htm"><B>RegLoadKey</B></A>, <A HREF="5gj0_gt.htm"><B>RegReplaceKey</B></A>, or <A HREF="8kmgan.htm"><B>RegRestoreKey</B></A> function. </P>

<P><I>lpSecurityAttributes</I></P>

<P><B>Windows NT: </B>Pointer to a <A HREF="be53kg.htm"><B>SECURITY_ATTRIBUTES</B></A> structure that specifies a security descriptor for the new file. If <I>lpSecurityAttributes</I> is NULL, the file gets a default security descriptor.</P>

<P><B>Windows 95: </B>This parameter is ignored. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is ERROR_SUCCESS.</P>

<P>If the function fails, the return value is a nonzero error code defined in WINERROR.H. You can use the <A HREF="n7qrmp.htm"><B>FormatMessage</B></A> function with the FORMAT_MESSAGE_FROM_SYSTEM flag to get a generic description of the error.</P>

<P><B>Remarks</B></P>

<P>If <I>hKey</I> represents a key on a remote computer, the path described by <I>lpFile</I> is relative to the remote computer. </P>

<P>The <B>RegSaveKey</B> function saves only nonvolatile keys. It does not save volatile keys. A key is made volatile or nonvolatile at its creation; see <A HREF=".5u9k7.htm"><B>RegCreateKeyEx</B></A>. </P>

<P><B>Windows NT: </B>The calling process must have the SE_BACKUP_NAME privilege. For more information about privileges, see <A HREF="134kpv4.htm">Privileges</A>. </P>

<P><B>Windows 95: </B>Security privileges are not supported or required.</P>

<P><B>See Also</B></P>

<P><A HREF=".5u9k7.htm"><B>RegCreateKeyEx</B></A>, <A HREF="kr5n7j.htm"><B>RegDeleteKey</B></A>, <A HREF="134z9cn.htm"><B>RegLoadKey</B></A>, <A HREF="5gj0_gt.htm"><B>RegReplaceKey</B></A>, <A HREF="8kmgan.htm"><B>RegRestoreKey</B></A>, <A HREF="be53kg.htm"><B>SECURITY_ATTRIBUTES</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
