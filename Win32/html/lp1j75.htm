<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetProfileSection</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="lp1j75"></A><B>GetProfileSection  <A HREF="1pqszh0.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetProfileSection</B> function retrieves all of the keys and values for the specified section of the WIN.INI file. This function is provided for compatibility with 16-bit Windows-based applications. Win32-based applications should store initialization information in the registry. </P>

<P><B>Windows 95:</B></P>

<P>The specified profile section must not exceed 32K.</P>

<P><B>Windows NT:</B></P>

<P>The specified profile section has no size limit.</P>

<P><B>DWORD GetProfileSection(</B></P>

<TABLE cols=2 width=405>

<TR VALIGN="top">
<TD width=51%><B>LPCTSTR</B> <I>lpAppName</I><B>,</B></TD>
<TD width=49%>// address of section name  </TD>
</TR>

<TR VALIGN="top">
<TD width=51%><B>    LPTSTR</B> <I>lpReturnedString</I><B>,</B></TD>
<TD width=49%>// address of return buffer  </TD>
</TR>

<TR VALIGN="top">
<TD width=51%><B>    DWORD</B> <I>nSize</I> </TD>
<TD width=49%>// size of return buffer </TD>
</TR>

<TR VALIGN="top">
<TD width=51%><B>   );</B></TD>
<TD width=49%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpAppName</I></P>

<P>Points to a null-terminated string containing the section name in the WIN.INI file. </P>

<P><I>lpReturnedString</I></P>

<P>Points to a buffer that receives the keys and values associated with the named section. The buffer is filled with one or more null-terminated strings; the last string is followed by a second null character. </P>

<P><I>nSize</I></P>

<P>Specifies the size, in characters, of the buffer pointed to by the <I>lpReturnedString</I> parameter. </P>

<P></P>

<P><B>Windows 95:</B></P>

<P>The maximum buffer size is 32,767 characters.</P>

<P><B>Windows NT:</B></P>

<P>There is no maximum buffer size.</P>

<P></P>

<P><B>Return Values</B></P>

<P>The return value specifies the number of characters copied to the specified buffer, not including the terminating null character. If the buffer is not large enough to contain all the keys and values associated with the named section, the return value is equal to the length specified by <I>nSize</I> minus two. </P>

<P><B>Remarks</B></P>

<P>The format of the returned keys and values is one or more null-terminated strings, followed by a final null character. Each string has the following form: </P>

<P><I>key</I><B>=</B><I>string</I></P>

<P>The <B>GetProfileSection</B> function is not case-sensitive; the strings can be a combination of uppercase and lowercase letters. </P>

<P>This operation is atomic; no updates to the WIN.INI file are allowed while the keys and values for the section are being copied to the buffer. </P>

<P><B>Windows NT:</B></P>

<P>Calls to profile functions may be mapped to the registry instead of to the initialization files. This mapping occurs when the initialization file and section are specified in the registry under the following keys: </P>

<P><B>HKEY_LOCAL_MACHINE</B>\<B>Software</B>\<B>Microsoft</B>\<BR>
        <B>Windows NT</B>\<B>CurrentVersion</B>\<B>IniFileMapping</B></P>

<P>When the operation has been mapped, the <B>GetProfileSection</B> function retrieves information from the registry, not from the initialization file; the change in the storage location has no effect on the function's behavior. </P>

<P>The Win32 Profile functions (<B>Get/WriteProfile*</B>, <B>Get/WritePrivateProfile*</B>) use the following steps to locate initialization information:</P>

<P>1.Look in the registry for the name of the initialization file, say myfile.ini, under IniFileMapping: </P>

<P><B>HKEY_LOCAL_MACHINE</B>\<B>Software</B>\<B>Microsoft</B>\<BR>
        <B>Windows NT</B>\<B>CurrentVersion</B>\<B>IniFileMapping\myfile.ini</B></P>

<P>2.Look for the section name specified by <I>lpAppName</I>. This will be a named value under myfile.ini, or a subkey of myfile.ini, or will not exist.</P>

<P>3.If the section name specified by <I>lpAppName </I>is a named value under myfile.ini, then that value specifies where in the registry you will find the keys for the section.</P>

<P>4.If the section name specified by <I>lpAppName </I>is a subkey of myfile.ini, then named values under that subkey specify where in the registry you will find the keys for the section. If the key you are looking for does not exist as a named value, then there will be an unnamed value (shown as "&lt;No Name&gt;") that specifies the default location in the registry where you will find the key.</P>

<P>5.If the section name specified by <I>lpAppName </I>does not exist as a named value or as a subkey under myfile.ini, then there will be an unnamed value (shown as "&lt;No Name&gt;") under myfile.ini that specifies the default location in the registry where you will find the keys for the section.</P>

<P>6.If there is no subkey for myfile.ini, or if there is no entry for the section name, then look for the actual myfile.ini on the disk and read its contents.</P>

<P>When looking at values in the registry that specify other registry locations, there are several prefixes that change the behavior of the ini file mapping:</P>

<P>! - this character forces all writes to go both to the registry and to the .INI file on disk.</P>

<P># - this character causes the registry value to be set to the value in the Windows 3.1 .INI file when a new user logs in for the first time after setup.</P>

<P>@ - this character prevents any reads from going to the .INI file on disk if the requested data is not found in the registry.</P>

<P>USR: - this prefix stands for HKEY_CURRENT_USER, and the text after the prefix is relative to that key.</P>

<P>SYS: - this prefix stands for HKEY_LOCAL_MACHINE\SOFTWARE, and the text after the prefix is relative to that key.</P>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="8fr3li.htm"><B>GetPrivateProfileSection</B></A>, <A HREF="4_9a0oj.htm"><B>WriteProfileSection</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
