<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>Setting the Appbar Size and Position</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="9wca.4"></A><B>Setting the Appbar Size and Position</B></P>

<P>An application should set an appbar's size and position after registering the appbar, after the user user moves or sizes the appbar, and whenever the appbar receives the <A HREF="j.l.9j.htm">ABN_POSCHANGED</A> notification message. Before setting the size and position of the appbar, the application queries the system for an approved bounding rectangle by sending the <A HREF="6lumu7.htm">ABM_QUERYPOS</A> message. The system returns a bounding rectangle that does not interfere with the taskbar or any other appbar. The system adjusts the rectangle purely by rectangle subtraction; it makes no effort to preserve the rectangle's initial size. For this reason, the appbar should readjust the rectangle, as necessary, after sending ABM_QUERYPOS.</P>

<P>Next, the application passes the bounding rectangle back to the system by using the <A HREF="1z2wysn.htm">ABM_SETPOS</A> message. Then it calls the <A HREF="fn4vpf.htm"><B>MoveWindow</B></A> function to move the appbar into position. </P>

<P>The following example shows how to set an appbar's size and position.</P>

<P>// AppBarQuerySetPos - sets the size and position of an appbar.  </P>

<P>// uEdge - screen edge to which the appbar is to be anchored  </P>

<P>// lprc - current bounding rectangle of the appbar </P>

<P>// pabd - address of APPBARDATA structure with the hWnd and </P>

<P>//     cbSize members filled </P>

<P>void PASCAL AppBarQuerySetPos(UINT uEdge, LPRECT lprc, PAPPBARDATA pabd)  </P>

<P>{  </P>

<P>int iHeight = 0; </P>

<P>int iWidth = 0; </P>

<P></P>

<P>pabd-&gt;rc = *lprc; </P>

<P>pabd-&gt;uEdge = uEdge; </P>

<P></P>

<P>// Copy the screen coordinates of the appbar's bounding </P>

<P>// rectangle into the APPBARDATA structure. </P>

<P>if ((uEdge == ABE_LEFT) || </P>

<P>(uEdge == ABE_RIGHT)) { </P>

<P>iWidth = pabd-&gt;rc.right - pabd-&gt;rc.left; </P>

<P>pabd-&gt;rc.top = 0; </P>

<P>pabd-&gt;rc.bottom = GetSystemMetrics(SM_CYSCREEN); </P>

<P>} else { </P>

<P>iHeight = pabd-&gt;rc.bottom - pabd-&gt;rc.top; </P>

<P>pabd-&gt;rc.left = 0; </P>

<P>pabd-&gt;rc.right = GetSystemMetrics(SM_CXSCREEN); </P>

<P>} </P>

<P></P>

<P>// Query the system for an approved size and position. </P>

<P>SHAppBarMessage(ABM_QUERYPOS, pabd); </P>

<P></P>

<P>// Adjust the rectangle, depending on the edge to which the </P>

<P>// appbar is anchored. </P>

<P>switch (uEdge) { </P>

<P>case ABE_LEFT: </P>

<P>pabd-&gt;rc.right = pabd-&gt;rc.left + iWidth; </P>

<P>break; </P>

<P></P>

<P>case ABE_RIGHT: </P>

<P>pabd-&gt;rc.left = pabd-&gt;rc.right - iWidth; </P>

<P>break; </P>

<P></P>

<P>case ABE_TOP: </P>

<P>pabd-&gt;rc.bottom = pabd-&gt;rc.top + iHeight; </P>

<P>break; </P>

<P></P>

<P>case ABE_BOTTOM: </P>

<P>pabd-&gt;rc.top = pabd-&gt;rc.bottom - iHeight; </P>

<P>break; </P>

<P>} </P>

<P></P>

<P>// Pass the final bounding rectangle to the system. </P>

<P>SHAppBarMessage(ABM_SETPOS, pabd); </P>

<P></P>

<P>// Move and size the appbar so that it conforms to the </P>

<P>// bounding rectangle passed to the system. </P>

<P>MoveWindow(pabd-&gt;hWnd, pabd-&gt;rc.left, pabd-&gt;rc.top, </P>

<P>pabd-&gt;rc.right - pabd-&gt;rc.left, </P>

<P>pabd-&gt;rc.bottom - pabd-&gt;rc.top, TRUE); </P>

<P>} </P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
