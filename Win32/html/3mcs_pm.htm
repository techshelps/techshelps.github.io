<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>FreeLibrary</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="3mcs_pm"></A><B>FreeLibrary  <A HREF="ty7q2k.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="ad.gsp.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="14bc1rp.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>FreeLibrary</B> function decrements the reference count of the loaded dynamic-link library (DLL) module. When the reference count reaches zero, the module is unmapped from the address space of the calling process and the handle is no longer valid. This function supersedes the<B> <A HREF="1_cw3pp.htm">FreeModule</A></B> function. </P>

<P><B>BOOL FreeLibrary(</B></P>

<TABLE cols=2 width=427>

<TR VALIGN="top">
<TD width=44%><B>HMODULE</B> <I>hLibModule</I> </TD>
<TD width=56%>// handle to loaded library module  </TD>
</TR>

<TR VALIGN="top">
<TD width=44%><B>   );</B></TD>
<TD width=56%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hLibModule</I></P>

<P>Identifies the loaded library module. The <A HREF="1vghbf8.htm"><B>LoadLibrary</B></A> or <A HREF="18vfc_p.htm"><B>GetModuleHandle</B></A> function returns this handle. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>Each process maintains a reference count for each loaded library module. This reference count is incremented each time <A HREF="1vghbf8.htm"><B>LoadLibrary</B></A> is called and is decremented each time <B>FreeLibrary</B> is called. A DLL module loaded at process initialization due to load-time dynamic linking has a reference count of one. This count is incremented if the same module is loaded by a call to <B>LoadLibrary</B>. </P>

<P>Before unmapping a library module, the system enables the DLL to detach from the process by calling the DLL's <A HREF="82sdq5.htm"><B>DllEntryPoint</B></A> function, if it has one, with the DLL_PROCESS_DETACH value. Doing so gives the DLL an opportunity to clean up resources allocated on behalf of the current process. After the entry-point function returns, the library module is removed from the address space of the current process. </P>

<P>Calling <B>FreeLibrary</B> does not affect other processes using the same library module. </P>

<P><B>See Also</B></P>

<P><A HREF="82sdq5.htm"><B>DllEntryPoint</B></A>, <A HREF="5190.pp.htm"><B>FreeLibraryAndExitThread</B></A>, <A HREF="1_cw3pp.htm"><B>FreeModule</B></A>, <A HREF="18vfc_p.htm"><B>GetModuleHandle</B></A>, <A HREF="1vghbf8.htm"><B>LoadLibrary</B></A> </P>

<P></P>

<P></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
