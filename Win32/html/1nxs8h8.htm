<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>NDdeGetTrustedShare</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1nxs8h8"></A><B>NDdeGetTrustedShare  <A HREF="16i5vwr.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="g0og1h.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="vyjzi3.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>NDdeGetTrustedShare</B> function is called to retrieve the options associated with a DDE share that is in the server user's list of trusted shares. </P>

<P><B>UINT NDdeGetTrustedShare(</B></P>

<TABLE cols=2 width=503>

<TR VALIGN="top">
<TD width=46%><B>LPTSTR</B> <I>lpszServer</I><B>,</B></TD>
<TD width=54%>// server to execute on</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    LPTSTR</B> <I>lpszShareName</I><B>,</B></TD>
<TD width=54%>// name of share to query</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    LPDWORD</B> <I>lpdwTrustOptions</I><B>,</B></TD>
<TD width=54%>// trust options in effect</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    LPDWORD</B> <I>lpdwShareModId0</I><B>,</B></TD>
<TD width=54%>// first word of share modify identifier</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>    LPDWORD</B> <I>lpdwShareModId1</I> </TD>
<TD width=54%>// second word of share modify identifier</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>   );</B></TD>
<TD width=54%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpszServer</I></P>

<P>Address of the server name on which the DSDM resides. </P>

<P><I>lpszShareName</I></P>

<P>Address of the share name whose trusted status is being queried. This parameter must not be NULL. </P>

<P><I>lpdwTrustOptions</I></P>

<P>Address of a variable into which the TRUST_SHARE_OPTIONS will be stored. This parameter must not be NULL. </P>

<P><I>lpdwShareModId0</I></P>

<P>Address of a variable into which the first word of the trusted share modify identifier will be stored. This parameter must not be NULL. </P>

<P><I>lpdwShareModId1</I></P>

<P>Address of a variable into which the second word of the trusted share modify identifier will be stored. This parameter must not be NULL. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is NDDE_NO_ERROR.</P>

<P>If the function fails, the return value is an error code, which can be translated into a text error message by calling <A HREF="i0y5fj.htm"><B>NDdeGetErrorString</B></A>. </P>

<P><B>Remarks</B></P>

<P>The trusted share modify identifier reflects the version of the DDE share in the DSDM at the time the DDE share was initially granted trusted status. The trusted share modify identifier is primarily used to purge obsolete trusted shares. However, the user does not need to purge obsolete trusted shares. The network DDE agent purges obsolete shares on the user's behalf. </P>

<P><B>See also</B></P>

<P><A HREF="dkuq2s.htm"><B>NDdeSetTrustedShare</B></A></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
