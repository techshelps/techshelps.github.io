<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>RegRestoreKey</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="8kmgan"></A><B>RegRestoreKey  <A HREF="119r9kq.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="1y7hnby.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="vm.h_d.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>RegRestoreKey</B> function reads the registry information in a specified file and copies it over the specified key. This registry information may be in the form of a key and multiple levels of subkeys. </P>

<P><B>LONG RegRestoreKey(</B></P>

<TABLE cols=2 width=451>

<TR VALIGN="top">
<TD width=35%><B>HKEY</B> <I>hKey</I><B>,</B></TD>
<TD width=65%>// handle of key where restore begins </TD>
</TR>

<TR VALIGN="top">
<TD width=35%><B>    LPCTSTR</B> <I>lpFile</I><B>,</B></TD>
<TD width=65%>// address of filename containing saved tree </TD>
</TR>

<TR VALIGN="top">
<TD width=35%><B>    DWORD</B> <I>dwFlags</I> </TD>
<TD width=65%>// optional flags </TD>
</TR>

<TR VALIGN="top">
<TD width=35%><B>   );</B></TD>
<TD width=65%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hKey</I></P>

<P>Identifies a currently open key or any of the following predefined reserved handle values: </P>

<P><B>HKEY_CLASSES_ROOT</B><BR>
<B>HKEY_CURRENT_USER</B><BR>
<B>HKEY_LOCAL_MACHINE</B><BR>
<B>HKEY_USERS</B></P>

<P>Any information contained in this key and its descendent keys is overwritten by the information in the file pointed to by the <I>lpFile</I> parameter. </P>

<P><I>lpFile</I></P>

<P>Points to a null-terminated string containing the name of the file with registry information. This file is typically created by using the <A HREF="2_uq_4o.htm"><B>RegSaveKey</B></A> function. Under the file allocation table (FAT) file system, the filename may not have an extension. </P>

<P><I>dwFlags</I></P>

<P>Specifies a flag indicating whether the key is volatile. (A volatile key is valid only until the next time the system is started.) This parameter is optional; if no value is specified, the key is not volatile. </P>

<P>This parameter can be the REG_WHOLE_HIVE_VOLATILE flag set. Instead of restoring the given key, this flag causes a new, volatile (memory only) set of registry information to be created. (A hive is a large set of registry information, typically containing all of the pertinent information for part of the system. For example, <B>HKEY_LOCAL_MACHINE</B>\<B>Hardware</B> is a volatile hive.) </P>

<P>If REG_WHOLE_HIVE_VOLATILE is specified, the key identified by the <I>hKey</I> parameter must be either the <B>HKEY_USERS</B> or <B>HKEY_LOCAL_MACHINE</B> value. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is ERROR_SUCCESS.</P>

<P>If the function fails, the return value is a nonzero error code defined in WINERROR.H. You can use the <A HREF="n7qrmp.htm"><B>FormatMessage</B></A> function with the FORMAT_MESSAGE_FROM_SYSTEM flag to get a generic description of the error.</P>

<P><B>Remarks</B></P>

<P>If any subkeys of the <I>hKey</I> parameter are open, <B>RegRestoreKey</B> fails. The function also fails if the calling process does not have the SE_RESTORE_NAME privilege. For more information about privileges, see <A HREF="134kpv4.htm">Privileges</A>. </P>

<P>This function replaces the keys and values below the specified key with the keys and values that are subsidiary to the top-level key in the file, no matter what the name of the top-level key in the file might be. For example, <I>hKey</I> might identify a key <B>A</B> with subkeys <B>B</B> and <B>C</B>, while the <I>lpFile</I> parameter specifies a file containing key <B>X</B> with subkeys <B>Y</B> and <B>Z</B>. After a call to <B>RegRestoreKey</B>, the registry would contain key <B>A</B> with subkeys <B>Y</B> and <B>Z</B>. The value entries of <B>A</B> would be replaced by the value entries of <B>X</B>. </P>

<P>The new information in the file specified by <I>lpFile</I> overwrites the contents of the key specified by the <I>hKey</I> parameter, except for the key name. </P>

<P>If <I>hKey</I> represents a key in a remote computer, the path described by <I>lpFile</I> is relative to the remote computer. </P>

<P><B>See Also</B></P>

<P><A HREF="kr5n7j.htm"><B>RegDeleteKey</B></A>, <A HREF="134z9cn.htm"><B>RegLoadKey</B></A>, <A HREF="5gj0_gt.htm"><B>RegReplaceKey</B></A>, <A HREF="2_uq_4o.htm"><B>RegSaveKey</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
