<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>NCB</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="35heyl"></A><B>NCB  <A HREF="21110xs.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="5sr2mp.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="lrdczu.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>NCB</B> structure describes a network control block. A pointer to this structure is passed to the <A HREF="1dz00xb.htm"><B>Netbios</B></A> function. </P>

<P>typedef struct _NCB { // ncb  </P>

<P>UCHAR  ncb_command; </P>

<P>UCHAR  ncb_retcode; </P>

<P>UCHAR  ncb_lsn; </P>

<P>UCHAR  ncb_num; </P>

<P>PUCHAR ncb_buffer; </P>

<P>WORD   ncb_length; </P>

<P>UCHAR  ncb_callname[NCBNAMSZ]; </P>

<P>UCHAR  ncb_name[NCBNAMSZ]; </P>

<P>UCHAR  ncb_rto; </P>

<P>UCHAR  ncb_sto; </P>

<P>void (*ncb_post) (struct _NCB *); </P>

<P>UCHAR  ncb_lana_num; </P>

<P>UCHAR  ncb_cmd_cplt; </P>

<P>UCHAR  ncb_reserve[10]; </P>

<P>HANDLE ncb_event; </P>

<P>} NCB; </P>

<P></P>

<P><B>Members</B></P>

<P><B>ncb_command</B></P>

<P>Specifies the command code and a flag that indicates whether the <B>NCB</B> structure is processed asynchronously. The most significant bit contains the flag. If the ASYNCH constant is combined with a command code (by using the OR operator), the <B>NCB</B> structure is processed asynchronously. The following command codes are supported: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=35%><B>Code</B></TD>
<TD width=65%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBACTION</TD>
<TD width=65%>Enables extensions to the transport interface. NCBACTION commands are mapped to TdiAction. When this code is specified, the <B>ncb_buffer</B> member points to a buffer to be filled with an <A HREF="36hw_5g.htm"><B>ACTION_HEADER</B></A> structure, which is optionally followed by data. NCBACTION commands cannot be canceled by using NCBCANCEL.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBADDGRNAME</TD>
<TD width=65%>Adds a group name to the local name table.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBADDNAME</TD>
<TD width=65%>Adds a unique name to the local name table.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBASTAT</TD>
<TD width=65%>Retrieves the status of the adapter. When this code is specified, the <B>ncb_buffer</B> member points to a buffer to be filled with an <A HREF="avxv7s.htm"><B>ADAPTER_STATUS</B></A> structure, followed by an array of <A HREF="ndo5ls.htm"><B>NAME_BUFFER</B></A> structures.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBCALL</TD>
<TD width=65%>Opens a session with another name.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBCANCEL</TD>
<TD width=65%>Cancels a previous command.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBCHAINSEND</TD>
<TD width=65%>Sends the contents of two data buffers to the specified session partner.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBCHAINSENDNA</TD>
<TD width=65%>Sends the contents of two data buffers to the specified session partner and does not wait for acknowledgment. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBDELNAME</TD>
<TD width=65%>Deletes a name from the local name table.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBDGRECV</TD>
<TD width=65%>Receives a datagram from any name.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBDGRECVBC</TD>
<TD width=65%>Receives broadcast datagram from any host.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBDGSEND</TD>
<TD width=65%>Sends datagram to a specified name.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBDGSENDBC</TD>
<TD width=65%>Sends a broadcast datagram to every host on the local area network (LAN).</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBENUM</TD>
<TD width=65%>Enumerates LAN adapter (LANA) numbers. When this code is specified, the <B>ncb_buffer</B> member points to a buffer to be filled with a <A HREF="1mgk17a.htm"><B>LANA_ENUM</B></A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBFINDNAME</TD>
<TD width=65%>Determines the location of a name on the network. When this code is specified, the <B>ncb_buffer</B> member points to a buffer to be filled with a <A HREF="ases5s.htm"><B>FIND_NAME_HEADER</B></A> structure followed by one or more <A HREF="4q08dr.htm"><B>FIND_NAME_BUFFER</B></A> structures.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBHANGUP</TD>
<TD width=65%>Closes a specified session.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBLANSTALERT</TD>
<TD width=65%>Notifies the user of LAN failures that last for more than one minute.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBLISTEN</TD>
<TD width=65%>Enables a session to be opened with another name.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBRECV</TD>
<TD width=65%>Receives data from the specified session partner.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBRECVANY</TD>
<TD width=65%>Receives data from any session corresponding to a specified name.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBRESET</TD>
<TD width=65%>Resets a LAN adapter. An adapter must be reset before any other NCB command that specifies the same number in the <B>ncb_lana_num</B> member will be accepted.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>&nbsp;</TD>
<TD width=65%>The IBM NetBIOS 3.0 specification documents several NCB_RESET NCB's. Win32 implements the NCB.RESET using the dynamic link routine interface. Particular values can be passed in specific bytes of the NCB, more specifically:</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>&nbsp;</TD>
<TD width=65%>·If <B>ncb_lsn</B> is not 0x00, all resources associated with <B>ncb_lana_num</B> are to be freed. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>&nbsp;</TD>
<TD width=65%>·If <B>ncb_lsn</B> is 0x00, all resources associated with <B>ncb_lana_num</B> are to be freed, and new resources are to be allocated. The <B>ncb_callname</B>[0] byte specifies the maximum number of sessions, and the <B>ncb_callname</B>[2] byte specifies the maximum number of names. A nonzero value for the <B>ncb_callname</B>[3] byte requests that the application use NAME_NUMBER_1.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBSEND</TD>
<TD width=65%>Sends data to the specified session partner. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBSENDNA</TD>
<TD width=65%>Sends data to specified session partner and does not wait for an acknowledgment. </TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBSSTAT</TD>
<TD width=65%>Retrieves the status of the session. When this value is specified, the <B>ncb_buffer</B> member points to a buffer to be filled with a <A HREF="21ikzwu.htm"><B>SESSION_HEADER</B></A> structure, followed by one or more <A HREF="55jq_zn.htm"><B>SESSION_BUFFER</B></A> structures.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBTRACE</TD>
<TD width=65%>Activates or deactivates NCB tracing. Support for this command in the system is optional and system-specific.</TD>
</TR>

<TR VALIGN="top">
<TD width=35%>NCBUNLINK</TD>
<TD width=65%>Unlinks the adapter.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>ncb_retcode</B></P>

<P>Specifies the return code. This value is set to NRC_PENDING while an asynchronous operation is in progress. One of the following return code values can be specified: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=36%><B>Value</B></TD>
<TD width=64%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_GOODRET</TD>
<TD width=64%>The operation succeeded.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_BUFLEN</TD>
<TD width=64%>An illegal buffer length was supplied.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_ILLCMD</TD>
<TD width=64%>An illegal command was supplied.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_CMDTMO</TD>
<TD width=64%>The command was timed out.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_INCOMP</TD>
<TD width=64%>The message was incomplete. The application is to issue another command.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_BADDR</TD>
<TD width=64%>The buffer address was illegal.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_SNUMOUT</TD>
<TD width=64%>The session number was out of range.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_NORES</TD>
<TD width=64%>No resource was available.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_SCLOSED</TD>
<TD width=64%>The session was closed.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_CMDCAN</TD>
<TD width=64%>The command was canceled.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_DUPNAME</TD>
<TD width=64%>A duplicate name existed in the local name table.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_NAMTFUL</TD>
<TD width=64%>The name table was full.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_ACTSES</TD>
<TD width=64%>The command finished; the name has active sessions and is no longer registered.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_LOCTFUL</TD>
<TD width=64%>The local session table was full.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_REMTFUL</TD>
<TD width=64%>The remote session table was full. The request to open a session was rejected.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_ILLNN</TD>
<TD width=64%>An illegal name number was specified.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_NOCALL</TD>
<TD width=64%>The system did not find the name that was called.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_NOWILD</TD>
<TD width=64%>Wildcards are not permitted in the <B>ncb_name</B> member.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_INUSE</TD>
<TD width=64%>The name was already in use on the remote adapter.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_NAMERR</TD>
<TD width=64%>The name was deleted.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_SABORT</TD>
<TD width=64%>The session ended abnormally.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_NAMCONF</TD>
<TD width=64%>A name conflict was detected.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_IFBUSY</TD>
<TD width=64%>The interface was busy.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_TOOMANY</TD>
<TD width=64%>Too many commands were outstanding; the application can retry the command later.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_BRIDGE</TD>
<TD width=64%>The <B>ncb_lana_num</B> member did not specify a valid network number.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_CANOCCR</TD>
<TD width=64%>The command finished while a cancel operation was occurring.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_CANCEL</TD>
<TD width=64%>The NCBCANCEL command was not valid; the command was not canceled.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_DUPENV</TD>
<TD width=64%>The name was defined by another local process.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_ENVNOTDEF</TD>
<TD width=64%>The environment was not defined. A reset command must be issued.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_OSRESNOTAV</TD>
<TD width=64%>Operating system resources were exhausted. The application can retry the command later.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_MAXAPPS</TD>
<TD width=64%>The maximum number of applications was exceeded.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_NOSAPS</TD>
<TD width=64%>No service access points (SAPs) were available for NetBIOS.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_NORESOURCES</TD>
<TD width=64%>The requested resources were not available.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_INVADDRESS</TD>
<TD width=64%>The NCB address was not valid.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>&nbsp;</TD>
<TD width=64%>This return code is not part of the IBM NetBIOS 3.0 specification and is not returned in the <B>NCB </B>structure. Instead, it is returned by the <B>Netbios</B> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_INVDDID</TD>
<TD width=64%>The NCB DDID was invalid.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_LOCKFAIL</TD>
<TD width=64%>The attempt to lock the user area failed.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_OPENERR</TD>
<TD width=64%>An error occurred during an open operation being performed by the device driver. This return code is not part of the IBM NetBIOS 3.0 specification.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_SYSTEM</TD>
<TD width=64%>A system error occurred.</TD>
</TR>

<TR VALIGN="top">
<TD width=36%>NRC_PENDING</TD>
<TD width=64%>An asynchronous operation is not yet finished.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>ncb_lsn</B></P>

<P>Specifies the local session number. This number uniquely identifies a session within an environment. </P>

<P><B>ncb_num</B></P>

<P>Specifies the number for the local network name. This number is returned by <B>Netbios</B> after a successful NCBADDNAME or NCBADDGRNAME command. This number, not the name, must be used with all datagram commands and for NCBRECVANY commands. </P>

<P>The number for NAME_NUMBER_1 (see NCBRESET) is always 0x01. <B>Netbios</B> assigns values in the range 0x02 to 0xFE for the remaining names.</P>

<P><B>ncb_buffer</B></P>

<P>Points to the message buffer. </P>

<P><B>ncb_length</B></P>

<P>Specifies the size, in bytes, of the message buffer. </P>

<P><B>ncb_callname</B></P>

<P>Specifies the string that contains the remote name. Trailing space characters should be supplied to make the length of the string equal to NCBNAMSZ. </P>

<P><B>ncb_name</B></P>

<P>Specifies the string that contains the local name. Trailing space characters should be supplied to make the length of the string equal to NCBNAMSZ. </P>

<P><B>ncb_rto</B></P>

<P>Specifies the receive time-out period, in 500-millisecond units, for the session. A value of zero implies no time-out. Specified with the NCBCALL or NCBLISTEN command. Affects subsequent NCBRECV commands. </P>

<P><B>ncb_sto</B></P>

<P>Specifies the send time-out period, in 500-millisecond units, for the session. A value of zero implies no time-out. Specified with the NCBCALL or NCBLISTEN command. Affects subsequent NCBSEND and NCBCHAINSEND commands. </P>

<P><B>ncb_post</B></P>

<P>Specifies the address of the routine to call when the asynchronous NCB finishes. The completion routine is passed a pointer to the completed network control block. </P>

<P><B>ncb_lana_num</B></P>

<P>Specifies the LAN adapter number. This zero-based number corresponds to a particular transport provider using a particular LAN adapter board. </P>

<P><B>ncb_cmd_cplt</B></P>

<P>Specifies the command complete flag. This value is the same as the <B>ncb_retcode</B> member. </P>

<P><B>ncb_reserve</B></P>

<P>Reserved; must be zero. </P>

<P><B>ncb_event</B></P>

<P>Specifies a handle to a Windows event that is set to the signaled state when the asynchronous network control block finishes. The event is signaled if the <B>Netbios</B> function returns a nonzero value. </P>

<P>The <B>ncb_event</B> member must be zero if the <B>ncb_command</B> member does not have the ASYNCH value set or if <B>ncb_post</B> is nonzero. Otherwise, NRC_ILLCMD is returned. </P>

<P>The event specified by <B>ncb_event</B> is set to the nonsignaled state by the system when an asynchronous NetBIOS command is accepted, and it is set to the signaled state when the asynchronous NetBIOS command finishes. </P>

<P>Using <B>ncb_event</B> to submit asynchronous requests requires fewer system resources than using <B>ncb_post</B>. Also, when <B>ncb_event</B> is nonzero, the pending request is canceled if the thread terminates before the request is processed. This is not true for requests sent by using <B>ncb_post</B>. </P>

<P>Only manual reset events should be used with <B>Netbios</B>. A given event should not be associated with more than one active asynchronous NetBIOS command. </P>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="36hw_5g.htm"><B>ACTION_HEADER</B></A>, <A HREF="avxv7s.htm"><B>ADAPTER_STATUS</B></A>, <A HREF="4q08dr.htm"><B>FIND_NAME_BUFFER</B></A>, <A HREF="ases5s.htm"><B>FIND_NAME_HEADER</B></A>, <A HREF="1mgk17a.htm"><B>LANA_ENUM</B></A>, <A HREF="ndo5ls.htm"><B>NAME_BUFFER</B></A>, <A HREF="1dz00xb.htm"><B>Netbios</B></A>, <A HREF="55jq_zn.htm"><B>SESSION_BUFFER</B></A>, <A HREF="21ikzwu.htm"><B>SESSION_HEADER</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
