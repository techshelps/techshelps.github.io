<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetPrinterDriverDirectory</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="166k1_h"></A><B>GetPrinterDriverDirectory  <A HREF="12x_1i.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="joiq6.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="yhp8x..htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetPrinterDriverDirectory</B> function retrieves the path of the printer-driver directory. </P>

<P><B>BOOL GetPrinterDriverDirectory(</B></P>

<TABLE cols=2 width=625>

<TR VALIGN="top">
<TD width=33%><B>LPTSTR</B> <I>pName</I><B>,</B></TD>
<TD width=67%>// address of server name </TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>    LPTSTR</B> <I>pEnvironment</I><B>,</B></TD>
<TD width=67%>// address of environment </TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>    DWORD</B> <I>Level</I><B>,</B></TD>
<TD width=67%>// address of structure </TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>    LPBYTE</B> <I>pDriverDirectory</I><B>,</B></TD>
<TD width=67%>// address of structure array that receives path </TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>    DWORD</B> <I>cbBuf</I><B>,</B></TD>
<TD width=67%>// size, in bytes, of array </TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>    LPDWORD</B> <I>pcbNeeded</I> </TD>
<TD width=67%>// address of variable with number of bytes retrieved (or required) </TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>   );</B></TD>
<TD width=67%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>pName</I></P>

<P>Points to a null-terminated string that specifies the name of the server on which the printer driver resides. If this parameter is NULL, the local driver-directory path is retrieved. </P>

<P><I>pEnvironment</I></P>

<P>Points to a null-terminated string that specifies the environment. For example, "Windows NT x86" specifies Windows NT running on an Intel 80386 or 80486 processor. If this parameter is NULL, the current environment of the calling application and client machine (not of the destination application and print server) is used. </P>

<P><I>Level</I></P>

<P>Specifies the structure level. This value must be 1. </P>

<P><I>pDriverDirectory</I></P>

<P>Points to an array of bytes that receives the path. </P>

<P><I>cbBuf</I></P>

<P>Specifies the size of the array to which <I>pDriverDirectory</I> points. </P>

<P><I>pcbNeeded</I></P>

<P>Points to a value that specifies the number of bytes copied if the function succeeds, or the number of bytes required if <I>cbBuf</I> is too small. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>See Also</B></P>

<P><A HREF="12dsaat.htm"><B>AddPrinterDriver</B></A> </P>

</BODY>
</HTML>
