<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>EnumPrinterDrivers</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="1dibzdw"></A><B>EnumPrinterDrivers  <A HREF="1ojrjx_.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="joiq6.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="yhp8x..htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>EnumPrinterDrivers</B> function enumerates all of the printer drivers installed on the specified printer server. </P>

<P><B>BOOL EnumPrinterDrivers(</B></P>

<TABLE cols=2 width=519>

<TR VALIGN="top">
<TD width=37%><B>LPTSTR</B> <I>pName</I><B>,</B></TD>
<TD width=63%>// pointer to server name </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    LPTSTR</B> <I>pEnvironment</I><B>,</B></TD>
<TD width=63%>// pointer to environment name</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    DWORD</B> <I>Level</I><B>,</B></TD>
<TD width=63%>// structure level </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    LPBYTE</B> <I>pDriverInfo</I><B>,</B></TD>
<TD width=63%>// pointer to an array of structures </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    DWORD</B> <I>cbBuf</I><B>,</B></TD>
<TD width=63%>// size, in bytes, of array </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    LPDWORD</B> <I>pcbNeeded</I><B>,</B></TD>
<TD width=63%>// pointer to number of bytes copied (or required) </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>    LPDWORD</B> <I>pcReturned</I> </TD>
<TD width=63%>// pointer to number of DRIVER_INFO. structures </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>   );</B></TD>
<TD width=63%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>pName</I></P>

<P>Pointer to a null-terminated string that specifies the name of the server on which the printer drivers should be enumerated. </P>

<P>If <I>pName</I> is NULL, the function enumerates the local machine's printer drivers. </P>

<P><I>pEnvironment</I></P>

<P>Pointer to a null-terminated string that specifies the environment. For example, "Windows NT x86" specifies Windows NT running on an Intel 80386 or 80486 processor. If this parameter is NULL, the function uses the current environment of the caller/client (not of the destination/server).  </P>

<P><I>Level</I></P>

<P>Specifies the type of structures pointed to by <I>pDriverInfo</I>. This value must be 1, 2, or 3. </P>

<P><I>pDriverInfo</I></P>

<P>Pointer to a buffer that receives an array of <A HREF="15iyypc.htm"><B>DRIVER_INFO_1</B></A>, <A HREF="camz93.htm"><B>DRIVER_INFO_2</B></A>, or <A HREF="cbmz93.htm"><B>DRIVER_INFO_3</B></A> structures. Each structure contains data that describes an available printer driver.</P>

<P><I>cbBuf</I></P>

<P>Specifies the size, in bytes, of the buffer pointed to by <I>pDriverInfo.</I> </P>

<P><I>pcbNeeded</I></P>

<P>Pointer to a value that the function sets to the size in bytes of the data that enumerates the printer drivers. If <I>cbBuf</I> is smaller than this value, <B>EnumPrinterDrivers</B> fails, and the variable pointed to by <I>pcbNeeded</I> represents the required buffer size. If <I>cbBuf</I> is equal to or greater than this value, the variable pointed to by <I>pcbNeeded</I> represents the number of bytes stored into the buffer.  </P>

<P><I>pcReturned</I></P>

<P>Pointer to a value that specifies the number of structures that it stores into the buffer pointed to by <I>pDriverInfo.</I> This is the number of printer drivers installed on the specified print server. </P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>See Also</B></P>

<P><A HREF="12dsaat.htm"><B>AddPrinterDriver</B></A>, <A HREF="15iyypc.htm"><B>DRIVER_INFO_1</B></A>, <A HREF="camz93.htm"><B>DRIVER_INFO_2</B></A>, <A HREF="cbmz93.htm"><B>DRIVER_INFO_3</B></A>, <A HREF="ehb0hh.htm"><B>GetPrinterDriver</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
