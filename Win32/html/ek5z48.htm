<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>GetPrinter</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="ek5z48"></A><B>GetPrinter  <A HREF="aq12y7.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="joiq6.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="yhp8x..htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>GetPrinter</B> function retrieves information about a specified printer. </P>

<P><B>BOOL GetPrinter(</B></P>

<TABLE cols=2 width=593>

<TR VALIGN="top">
<TD width=32%><B>HANDLE</B> <I>hPrinter</I><B>,</B></TD>
<TD width=68%>// handle to printer of interest </TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    DWORD</B> <I>Level</I><B>,</B></TD>
<TD width=68%>// version of printer info data structure </TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    LPBYTE</B> <I>pPrinter</I><B>,</B></TD>
<TD width=68%>// pointer to array of bytes that receives printer info. structure </TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    DWORD</B> <I>cbBuf</I><B>,</B></TD>
<TD width=68%>// size, in bytes, of array of bytes </TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>    LPDWORD</B> <I>pcbNeeded</I> </TD>
<TD width=68%>// pointer to variable with count of bytes retrieved (or required) </TD>
</TR>

<TR VALIGN="top">
<TD width=32%><B>   );</B></TD>
<TD width=68%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>hPrinter</I></P>

<P>Handle to the printer of interest. </P>

<P><I>Level</I></P>

<P>Specifies the level, or type, of <B>PRINTER_INFO_*</B> structure that the function stores into the buffer pointed to by <I>pPrinter</I>. </P>

<P><B>Windows 95:</B> This value can be 1, 2, or 5.</P>

<P><B>Windows NT:</B> This value can be 1, 2, 3, 4, or 5. </P>

<P><I>pPrinter</I></P>

<P>Pointer to a buffer that receives a <B>PRINTER_INFO_*</B> structure. This structure contains information about the specified printer. The type of structure is determined by the value of <I>Level</I>. </P>

<P><B>Windows 95:</B> The buffer can receive a <A HREF="x9ethp.htm"><B>PRINTER_INFO_1</B></A>, <A HREF="x0ethp.htm"><B>PRINTER_INFO_2</B></A>, <A HREF="x_ethp.htm"><B>PRINTER_INFO_5</B></A> structure.</P>

<P><B>Windows NT:</B> The buffer can receive a <A HREF="x9ethp.htm"><B>PRINTER_INFO_1</B></A>, <A HREF="x0ethp.htm"><B>PRINTER_INFO_2</B></A>, <A HREF="1jdqt55.htm"><B>PRINTER_INFO_3</B></A>, <A HREF="x.ethp.htm"><B>PRINTER_INFO_4</B></A>, or <A HREF="x_ethp.htm"><B>PRINTER_INFO_5</B></A> structure.</P>

<P><I>cbBuf</I></P>

<P>Specifies the size, in bytes, of the buffer pointed to by <I>pPrinter</I>. </P>

<P><I>pcbNeeded</I></P>

<P>Pointer to a variable that the function sets to the size in bytes of the printer information. If <I>cbBuf</I> is smaller than this value, <B>GetPrinter</B> fails, and the value represents the required buffer size. If <I>cbBuf</I> is equal to or greater than this value, <B>GetPrinter</B> succeeds, and the value represents the number of bytes stored into the buffer.</P>

<P></P>

<P><B>Return Values</B></P>

<P>If the function succeeds, the return value is nonzero.</P>

<P>If the function fails, the return value is zero. To get extended error information, call <A HREF="11c2vs7.htm"><B>GetLastError</B></A>. </P>

<P><B>Remarks</B></P>

<P>If the structure returned in the buffer pointed to by the <I>pPrinter</I> parameter contains a pointer to a security descriptor, only those components of the security descriptor that the caller has permission to read will be present. An application that wants to retrieve particular security descriptor components must open the printer with sufficient access permission. The following table shows the security descriptor components that are retrieved for particular access permission values: </P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=47%><B><BR>
Access Permission</B></TD>
<TD width=53%><B>Security Descriptor Components Retrieved</B></TD>
</TR>

<TR VALIGN="top">
<TD width=47%>READ_CONTROL</TD>
<TD width=53%>Owner, Primary Group, Discretionary access-control list (ACL)</TD>
</TR>

<TR VALIGN="top">
<TD width=47%>ACCESS_SYSTEM_SECURITY</TD>
<TD width=53%>System ACL</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="2ki4pav.htm"><B>AbortPrinter</B></A>, <A HREF="m6o4k_.htm"><B>AddPrinter</B></A>, <A HREF="4.rx_qs.htm"><B>ClosePrinter</B></A>, <A HREF="ztjww4.htm"><B>DeletePrinter</B></A>, <A HREF="1ir.guq.htm"><B>EnumPrinters</B></A>, <A HREF="x9ethp.htm"><B>PRINTER_INFO_1</B></A>, <A HREF="x0ethp.htm"><B>PRINTER_INFO_2</B></A>, <A HREF="1jdqt55.htm"><B>PRINTER_INFO_3</B></A>, <A HREF="1jdqt55.htm"><B>PRINTER_INFO_4</B></A>, <A HREF="x_ethp.htm"><B>PRINTER_INFO_5</B></A>, <A HREF="9gwvgs.htm"><B>OpenPrinter</B></A>, <A HREF="839c6p.htm"><B>SetPrinter</B></A></P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
