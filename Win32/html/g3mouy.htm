<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><TITLE>ChangeDisplaySettings</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFC8" TEXT="#341717">



<P><A NAME="g3mouy"></A><B>ChangeDisplaySettings  <A HREF="53w01zp.htm"><IMG SRC="../images/bm1.gif" ALT="" BORDER=0></A>  <A HREF="2fduzal.htm"><IMG SRC="../images/bm3.gif" ALT="" BORDER=0></A>  <A HREF="de09ns.htm"><IMG SRC="../images/bm2.gif" ALT="" BORDER=0></A></B></P>

<P>The <B>ChangeDisplaySettings</B> function changes the display settings to the specified graphics mode. </P>

<P><B>LONG ChangeDisplaySettings(</B></P>

<TABLE cols=2 width=241>

<TR VALIGN="top">
<TD width=86%><B>LPDEVMODE</B> <I>lpDevMode</I><B>,</B></TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=86%><B>    DWORD</B> <I>dwflags</I></TD>
<TD width=14%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=86%><B>   );</B></TD>
<TD width=14%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Parameters</B></P>

<P><I>lpDevMode</I></P>

<P>Pointer to a <A HREF="1bkrzj1.htm"><B>DEVMODE</B></A> structure that describes the graphics mode to switch to. The <B>dmSize</B> member must be initialized to the size, in bytes, of the <B>DEVMODE</B> structure. The following fields in the <B>DEVMODE</B> structure are used:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=46%><B>Member</B></TD>
<TD width=54%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>dmBitsPerPel</B></TD>
<TD width=54%>Bits per pixel</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>dmPelsWidth</B></TD>
<TD width=54%>Pixel width</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>dmPelsHeight</B></TD>
<TD width=54%>Pixel height</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>dmDisplayFlags</B></TD>
<TD width=54%>Mode flags</TD>
</TR>

<TR VALIGN="top">
<TD width=46%><B>dmDisplayFrequency</B></TD>
<TD width=54%>Mode frequency</TD>
</TR>
</TABLE><BR>

<P></P>

<P>In addition to setting a value in one or more of the preceding <B>DEVMODE</B> members, you must also set the appropriate flags in the <B>dmFields</B> member. The flags indicate which members of the <B>DEVMODE</B> structure are used for the display settings change. If the appropriate bit is not set in <B>dmFields</B>, the display setting will not be changed. Set one or more of the following flags:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=46%><B>Flag</B></TD>
<TD width=54%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=46%>DM_BITSPERPEL</TD>
<TD width=54%>Use the <B>dmBitsPerPel</B> value.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%>DM_PELSWIDTH</TD>
<TD width=54%>Use the <B>dmPelsWidth</B> value.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%>DM_PELSHEIGHT</TD>
<TD width=54%>Use the <B>dmPelsHeight</B> value.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%>DM_DISPLAYFLAGS</TD>
<TD width=54%>Use the <B>dmDisplayFlags</B> value.</TD>
</TR>

<TR VALIGN="top">
<TD width=46%>DM_DISPLAYFREQENCY</TD>
<TD width=54%>Use the <B>dmDisplayFrequency</B> value.</TD>
</TR>
</TABLE><BR>

<P></P>

<P>If <I>lpDevMode</I> is NULL, all the values currently in the registry will be used for the display setting. Passing NULL for the <I>lpDevMode</I> parameter is the easiest way to return to the default mode after a dynamic mode change.</P>

<P><I>dwflags</I></P>

<P>Indicates how the graphics mode should be changed. May be one of the following:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=48%><B>Flag</B></TD>
<TD width=52%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=48%>0</TD>
<TD width=52%>The graphics mode for the current screen will be changed dynamically.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>CDS_UPDATEREGISTRY</TD>
<TD width=52%>The graphics mode for the current screen will be changed dynamically and the graphics mode will be updated in the registry. The mode information is stored in the USER profile.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>CDS_TEST</TD>
<TD width=52%>The system tests if the requested graphics mode could be set. </TD>
</TR>
</TABLE><BR>

<P></P>

<P>If CDS_UPDATEREGISTRY is specified and it is possible to change the graphics mode dynamically, the information is stored in the registry and DISP_CHANGE_SUCCESSFUL is returned. If it is not possible to change the graphics mode dynamically, the information is stored in the registry and DISP_CHANGE_RESTART is returned. </P>

<P><B>Windows NT:</B> If the information could not be stored in the registry, the graphics mode is not changed and DISP_CHANGE_NOTUPDATED is returned.</P>

<P>Specifying CDS_TEST allows an application to determine which graphics modes are actually valid, without causing the system to change to that graphics mode.</P>

<P></P>

<P><B>Return Values</B></P>

<P>Returns one of the following values:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=49%><B>Value</B></TD>
<TD width=51%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=49%>DISP_CHANGE_SUCCESSFUL</TD>
<TD width=51%>The settings change was successful.</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>DISP_CHANGE_RESTART</TD>
<TD width=51%>The computer must be restarted in order for the graphics mode to work.</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>DISP_CHANGE_BADFLAGS</TD>
<TD width=51%>An invalid set of flags was passed in.</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>DISP_CHANGE_FAILED</TD>
<TD width=51%>The display driver failed the specified graphics mode.</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>DISP_CHANGE_BADMODE</TD>
<TD width=51%>The graphics mode is not supported.</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>DISP_CHANGE_NOTUPDATED</TD>
<TD width=51%><B>Windows NT only:</B> Unable to write settings to the registry.</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>Remarks</B></P>

<P>Using the <A HREF="1bkrzj1.htm"><B>DEVMODE</B></A> returned by the <A HREF="22g7dn3.htm"><B>EnumDisplaySettings</B></A> function ensures that the <B>DEVMODE</B> passed to <B>ChangeDisplaySettings</B> is valid and contains only values supported by the display driver.</P>

<P>When the display mode is changed dynamically, the WM_DISPLAYCHANGE message is sent to all running applications with the following message parameters:</P>

<TABLE cols=2>

<TR VALIGN="top">
<TD width=49%><B>Parameters</B></TD>
<TD width=51%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=49%>wParam</TD>
<TD width=51%>New bits per pixel</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>LOWORD(lParam)</TD>
<TD width=51%>New pixel width</TD>
</TR>

<TR VALIGN="top">
<TD width=49%>HIWORD(lParam)</TD>
<TD width=51%>New pixel height</TD>
</TR>
</TABLE><BR>

<P></P>

<P><B>See Also</B></P>

<P><A HREF="14cje25.htm"><B>CreateDC</B></A>, <A HREF="1bkrzj1.htm"><B>DEVMODE</B></A>, <A HREF="22g7dn3.htm"><B>EnumDisplaySettings</B></A>, <A HREF="1mgjxta.htm"><B>WM_DISPLAYCHANGE</B></A> </P>

</BODY>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-1');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script></html>
