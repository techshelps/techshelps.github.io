<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="11.9 Use Statement Permissions"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">11.9 Use Statement Permissions</H3>
<P>SQL Server databases can become quite large and complex. It is important to control the number and type of objects that are added to a SQL Server database so that its structure contains only those objects that are actually required for the database's operation.</P>
<P>If object creation were not controlled, users could build temporary tables, views, stored procedures, and other database objects that would become permanent additions to the database. There's no easy way to tell whether a particular database object is required by some front-end applications, making it difficult to remove these objects.</P>
<P>I want to control unwanted and unneeded object proliferation in my databases. Without some kind of control, users might unnecessarily complicate the database's structure by adding unwarranted objects.</P>
<H4 class="docSection2Title"> Technique</H4>
<P>You will employ <span class="docEmphasis">statement permissions</span> to permit or disallow users to execute SQL statements that modify the database structure. There are also statement permissions controlling SQL statements that back up the database and its log file. These statements include the following:</P>
<UL>
<LI><p>
<span class="docEmphRoman">CREATE DATABASE.</span> 
Creates a new database (applicable only in the master database).</p>
</LI>
<LI><p>
<span class="docEmphRoman">CREATE DEFAULT.</span> 
Establishes default values for columns in tables.</p>
</LI>
<LI><p>
<span class="docEmphRoman">CREATE FUNCTION.</span> 
Creates a user-defined function that is saved as a Transact-SQL routine.</p>
</LI>
<LI><p>
<span class="docEmphRoman">CREATE PROCEDURE.</span> 
Creates a stored procedure.</p>
</LI>
<LI><p>
<span class="docEmphRoman">CREATE RULE.</span> 
Adds a rule to a column in a table. A rule specifies the acceptable values for the column.</p>
</LI>
<LI><p>
<span class="docEmphRoman">CREATE TABLE.</span> 
Creates a new table within the database.</p>
</LI>
<LI><p>
<span class="docEmphRoman">CREATE VIEW.</span> 
Adds a view to the database.</p>
</LI>
<LI><p>
<span class="docEmphRoman">BACKUP DATABASE.</span> 
Backs up the entire database to removable media.</p>
</LI>
<LI><p>
<span class="docEmphRoman">BACKUP LOG.</span> 
Backs up the database's log file to removable media.</p>
</LI>
</UL>
<P>Although this security task has been discussed only from the perspective of limiting the user's ability to create database objects, statement permissions are also a way to ensure that users who really need to modify the database structure are able to do so.</P>
<P>Statement permissions are applied at the database level. There are no global SQL Server statement permissions.</P>
<H4 class="docSection2Title"> Steps</H4>
<P>Logging in to SQL Server does not mean that a user is actually able to access and use the data and other objects that are stored in SQL Server. Each user account has certain permissions assigned to it that specify the account's ability to use the database and its objects.</P>
<P>Statement permissions are one category of database permissions. Statement permissions specify which types of SQL DDL (data definition language) statements a user is allowed to execute against the database. DLL statements are frequently used to create and modify tables, add indexes to tables, and perform other data structure operations on the database. Statement permissions limit a user's ability to perform operations that could be dangerous to the database.</P>
<P>After statement permissions have been established, the user is able to execute object creation statements (such as CREATE TABLE) only if the statements permission has been granted.</P>
<P>By default, SQL Server does not grant statement permissions. As the SQL Server system administrator, you should grant these permissions only to users who require object creation ability.</P>



<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1"><P>Open Enterprise Manager and expand the Northwind database's icon.</P></span></LI><LI><span style="font-weight:normal" value="2"><P>Right-click on the Northwind database's icon and select Properties from the shortcut menu. This action opens the database's Properties dialog box (see Figure 11.16).</P>
<CENTER><H5 class="docFigureTitle">Figure 11.16. The database Properties dialog box includes settings for statement permissions.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="475" src="FILES/11fig16.jpg" ALT="graphics/11fig16.jpg"></p>
</CENTER></span></LI><LI><span style="font-weight:normal" value="3"><P>Click on the Permissions tab. Notice that the leftmost column contains the roles and logins that you have created within the database. Select a role or login, and check the statement permissions you want to assign.</P></span></LI></OL></span>
<H4 class="docSection2Title"> Comments</H4>
<P>Each statement permission has three different states:</P>
<UL>
<LI><p>
<span class="docEmphRoman">Revoke.</span> 
The user is not given the statement permission unless he is a member of a role that has been given the permission. The graphic to depict this state is blank.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Grant.</span> 
The user is given permission to run the statement. The graphic to depict this state is the check.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Deny.</span> 
The user is denied the statement permission and cannot run the SQL Statement. The red X depicts this state.</p>
</LI>
</UL>
<P>Statement permissions are a great way to permit assistants the ability to add tables, views, stored procedures, and other objects as needed. Because the default setting is to deny these permissions, you do not have to worry about unwarranted object proliferation in your databases.</P>
<ul></ul>
</body></html>
