<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="1.3 Bind and View Individual Text Boxes Based Off a Selected List Box Item"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">1.3 Bind and View Individual Text Boxes Based Off a Selected List Box Item</H3>
<P>Using a list box similar to the one in the previous How-To, in this How-To, you will learn how to create additional <TT>OleDbDataAdapter</TT>s and <TT>DataSets</TT> and bind them to individual text boxes for viewing data.</P>
<P>Although the list box is nice for displaying a couple of fields in my form and limiting the rows displayed, how do you list the detail in individual text boxes by clicking on an item in the list box?</P>
<H4 class="docSection2Title"> Technique</H4>
<P>You are going to enhance the form that you created in How-To 1.2 to use additional data controls, specifically another data adapter and dataset. You will set up the select statement in the new data adapter to take the selected list box item as a parameter. The dataset will then be filled with data, and some text boxes with the dataset set as the data source will display the current record. You can see an example of this in Figure 1.7.</P>
<CENTER><H5 class="docFigureTitle">Figure 1.7. You can bind text boxes to datasets as well as list boxes.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="284" src="FILES/01fig07.jpg" ALT="graphics/01fig07.jpg"></p>
</CENTER>
<H4 class="docSection2Title"> Steps</H4>
<P>To go further with the form with which you have been working, you will want to rename the data adapter, dataset, and list box currently on the form to something more meaningful. You can see this in Table 1.4.</P>
<P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<CAPTION><h5 class="docTableTitle">Table 1.4. Changes to Current Objects on the Form</h5></CAPTION><COLGROUP span="4">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Object</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Property</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Old Setting</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>New Setting</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>ListBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>ListBox1</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>lstCustomers</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>OleDbDataAdapter</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>OleDbDataAdapter1</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>odaCustomerList</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>DataSet</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>DataSet1</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsCustomerList</TT></P>
</TD>
</TR>
</COLGROUP>
</TABLE></P>
<div class="docNote"><p class="docNoteTitle">Tip</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/tip_icon.gif" ALT="graphics/tip_icon.gif"></td>
<td valign="top"><P>Name your objects at the time you first create them. This is true of your solutions, projects, and forms, as well as controls used on forms. With the .NET languages being so class and code driven, some items take multiple steps to rename. Visual Studio doesn't seem to catch all the places in code that need to be changed. Renaming a form is a good example. Remember that you had to change the Public Class statement in the code to have it match the new name of the form.</P>
</td>
</tr></table></p>
</div><br>




<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1"><P>Drop another Data Adapter control on the form from the Data group of the toolbox. Use the existing data connection, specify that you will use SQL statements, and assign the following select statement that will use a parameter supplied at runtime by using the selected list box item.</P>
<pre>
SELECT CustomerID, CompanyName, ContactName, ContactTitle, Address, City, Region, 
<IMG BORDER="0" ALIGN="left" WIDTH="18" HEIGHT="11" src="FILES/ccc.gif" ALT="graphics/ccc.gif">PostalCode, Country, Phone, Fax FROM Customers WHERE (CustomerID = ?)
</pre>
<P>You can click the Advanced Options button on the select statement page and deselect creating the Insert, Update, and Delete commands. Finish the Data Adapter Wizard and rename the control <TT>odaCustomerIndividual</TT>.</P></span></LI><LI><span style="font-weight:normal" value="2"><P>Right-click <TT>odaCustomerIndividual</TT> and choose Generate Dataset from the pop-up menu. Create a new dataset called <TT>dsCustomerIndividual</TT>. Click OK. As of this writing, VS places a 1 at the end of name of the dataset you specified. Clean up the name by removing the 1. Now you should have two data adapters: <TT>odaCustomerList</TT> and <TT>odaCustomerIndividual</TT>, and two datasets: <TT>dsCustomerList</TT> and <TT>dsCustomerIndividual</TT>.</P></span></LI><LI><span style="font-weight:normal" value="3"><P>Now it's time to add the text boxes. Resize the form so that it allows you to add a column of text boxes with labels beside them. You will then add the labels and text boxes, setting the Text property of the text boxes to the column names in the Customers table as supplied by dsCustomerIndividual. The Text property of text boxes falls under the Data Binding category in the property sheet. Table 1.5 describes the controls and their property settings. Refer to Figure 1.8 for an example of where to place them.</P>
<CENTER><H5 class="docFigureTitle">Figure 1.8. Letting users know when they can edit data is helpful.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="282" src="FILES/01fig08.jpg" ALT="graphics/01fig08.jpg"></p>
</CENTER><P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<CAPTION><h5 class="docTableTitle">Table 1.5. New Label and TextBox Control Property Settings for the Form <TT>frmHowTo1_3</TT></h5></CAPTION><COLGROUP span="3">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Object</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Property</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Setting</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>Label</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Text</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Customer ID</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Company Name</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Contact</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Contact Title</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Address</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>City</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Region</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Country</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Phone</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Fax</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtCustomerID</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsCustomerIndividual</TT> - <TT>Customers.CustomerID</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtCompanyName</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsCustomerIndividual - Customers.CompanyName</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtContact</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsCustomerIndividual - Customers.Contact</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtContactTitle</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsCustomerIndividual - Customers.ContactTitle</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtAddress</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsCustomerIndividual - Customers.Address</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtCity</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsCustomerIndividual - Customers.City</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtRegion</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsCustomerIndividual - Customers.Region</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtPostalCode</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsCustomerIndividual - Customers.PostalCode</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtCountry</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsCustomerIndividual - Customers.Country</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT> </P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtPhone</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsCustomerIndividual - Customers.Phone</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT> </P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtFax</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsCustomerIndividual - Customers.Fax</TT></P>
</TD>
</TR>
</COLGROUP>
</TABLE></P></span></LI><LI><span style="font-weight:normal" value="4"><P>Now it's time for the code. To start off, you will change the Click event code for the button called btnLoadList. The first three lines of code are basically the same as in the last How-To, except that the name was changed as needed, and some lines were added to comment the code.</P>
<H5 class="docExampleTitle">Listing 1.3 <TT>frmHowTo1_3.vb</TT>: Adding the Call to the <TT>RefreshIndividual</TT> Subroutine</H5>
<PRE>
Private Sub btnLoadList_Click(ByVal sender As System.Object, _
                ByVal e As System.EventArgs) Handles btnLoadList.Click

      '- Store the text entered to limit the list box to the
       '  data adapter's parameter
      Me.odaCustomerList.SelectCommand.Parameters(0).Value = _
                                                Me.txtCustLimit.Text
      '- Clear the current data in the dataset
      Me.dsCustomerList.Clear()

      '- Fill the customer list dataset
      Me.odaCustomerList.Fill(Me.dsCustomerList)

      '- Fill the initial entry's individual dataset
      RefreshIndividual()

   End Sub
</PRE>
<P>The only new line of code is the one just before the <TT>End Sub</TT>, which calls the subroutine <TT>RefreshIndividual</TT> for the first item in the newly populated list box. This subroutine first handles clearing the dataset called <TT>dsCustomerIndividual</TT>. It ensures that a customer is chosen in the list box and then places the selected item into the parameter value for <TT>odaCustomerIndividual</TT>. The dataset called <TT>dsCustomerIndividual</TT> is then filled, displaying the data in the text boxes bound to the dataset.</P>
<H5 class="docExampleTitle">Listing 1.4 <TT>frmHowTo1_3.vb</TT>: Refreshing the Dataset on Which the Text Boxes Are Based</H5>
<PRE>
Private Sub RefreshIndividual()

      '- Clear individual customer dataset
      Me.dsCustomerIndividual.Clear()

      '- Check to see if an item was selected
      If lstCustomers.SelectedIndex &lt;&gt; -1 Then

         '- Store the selected customer ID into the
       '  parameter of the SQL data adapter
         Me.odaCustomerIndividual.SelectCommand.Parameters(0).Value = _
Me.lstCustomers.SelectedItem(0)

         '- Fill the dataset
         Me.odaCustomerIndividual.Fill(Me.dsCustomerIndividual)

      End If

   End Sub
</PRE>
<P>The only other code is required when a new item is selected in the list box. You want to refresh the text boxes with the new data. This code is on the <TT>SelectedIndexChanged</TT> event for the <TT>lstCustomers</TT> list box.</P>
<H5 class="docExampleTitle">Listing 1.5 <TT>frmHowTo1_3.vb</TT>: Call the RefreshIndividual Routine</H5>
<PRE>
Private Sub lstCustomers_SelectedIndexChanged(ByVal sender As System.Object,
                ByVal e As System.EventArgs) _
                Handles lstCustomers.SelectedIndexChanged
        '- Fill the current list item's individual dataset
        RefreshIndividual()

    End Sub
</PRE></span></LI></OL></span>
<H4 class="docSection2Title"> How It Works</H4>
<P>After the user types a letter into the <TT>txtCustLimit</TT> text box and clicks <TT>btnLoadList</TT>, the list box is populated with the items that match the text in the text box. After <TT>lstCustomers</TT> is populated, the user sees the details for the first item in the list box that is displayed in the text boxes. This occurs within the routine called <TT>RefreshIndividual</TT>. The selected item is used for the parameter for the data adapter called <TT>odaCustomerIndividual</TT>, then filling the dataset called <TT>dsCustomerIndividual</TT>. As the user selects new items in the list box, the data that corresponds to the selected item is displayed.</P>
<div class="docNote"><p class="docNoteTitle">Tip</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/tip_icon.gif" ALT="graphics/tip_icon.gif"></td>
<td valign="top"><P>Always try to break your code into specific routines such as the subroutine <TT>RefreshIndividual</TT>. That way when someone tries to read the code, the code is easy to read, you don't make mistakes by typing the same code two or more times, and you only have to change the code in one place if necessary.</P>
</td>
</tr></table></p>
</div><br>
<H4 class="docSection2Title"> Comments</H4>
<P>Binding text boxes to datasets saves work when switching from one record to another because you don't have to specifically load each text box with data each time. It also gets easier every time you use a data adapter and dataset in combination when manipulating data on your forms.</P>
<P>Bound datasets are particularly useful as you edit, add, and delete data on your forms, as you will see in the following How-Tos.</P>
<img src="FILES/pixel.gif" width="1" height="1" border="0"><ul></ul>
</body></html>
