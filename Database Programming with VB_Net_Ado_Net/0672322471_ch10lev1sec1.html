<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="10.1 Create a Report Using Crystal Reports Report Expert"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">10.1 Create a Report Using Crystal Reports Report Expert</H3>
<P>I have created quite a few applications that allow the users to manipulate data in various ways. Now I need to create some reports so that I can present information for my clients and users. How do I create a report with Crystal Reports using one of these Experts I have heard about?</P>
<H4 class="docSection2Title"> Technique</H4>
<P>You can create a report and include it in your projects as needed.</P>
<H5 class="docSection3Title"> Getting Started Creating a Crystal Report</H5>
<P>After right-clicking on your project in the Solution Explorer, you need to choose Add New Item from the Add menu item. You then can pick Crystal Report from the templates and name it appropriately.</P>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>If you name your reports with the prefix of rpt<span class="docEmphasis">ReportName</span>, you will be able to find all your reports in one location.</P>
</td>
</tr></table></p>
</div><br>
<P>After you have clicked the Open button on the dialog box, you are presented with the Crystal Report Gallery dialog box, shown here in Figure 10.1.</P>
<CENTER><H5 class="docFigureTitle">Figure 10.1. These Experts can save you time when you're creating reports.</H5><p><IMG BORDER="0" WIDTH="365" HEIGHT="431" src="FILES/10fig01.jpg" ALT="graphics/10fig01.jpg"></p>
</CENTER>
<P>Crystal Reports includes wizards called Experts. These Experts assist you in performing certain tasks, from creating a whole report to creating an individual formula for a field. Experts are actually made up of other Experts. For instance, the Report Expert utilizes the Formula Expert within itself; however, you also can take advantage of the Formula Expert from within the Report Designer.</P>
<H5 class="docSection3Title"> Types of Reports You Can Create with the Report Expert</H5>
<P>This How-To will discuss the Report Expert. This Expert creates various types of reports, listed in Table 10.1, in alphabetical order.</P>
<P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<CAPTION><h5 class="docTableTitle">Table 10.1. Types of Reports Created by the Report Expert</h5></CAPTION><COLGROUP span="2">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Report Type</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Description</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>Crosstab</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Crosstab reports give you a cross-tabulation of your data, such as sales of customers by years.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>Drill Down</P>
</TD>
<TD class="docTableCell" valign="top">
<P>This report is broken down into sections that start out as hidden, and then allow the user to "drill down" further into the information. An example of this would be a report that lists customers. When the user clicks on a particular customer, the invoices for that customer are displayed. Next, when you click on a particular invoice, its line items (or details) can be displayed.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>Form</P>
</TD>
<TD class="docTableCell" valign="top">
<P>This report helps to create preprinted forms that use company logos and forms. Examples of this type include invoices.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>Form Letter</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Forms letters, such as late notices and sales letters, are created using this expert.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>Mail Labels</P>
</TD>
<TD class="docTableCell" valign="top">
<P>This expert allows you to create mailing labels that are any size and any number of columns.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>Standard</P>
</TD>
<TD class="docTableCell" valign="top">
<P>The standard report is just that-a standard list report that lists your information. It allows you to group and sort information, include formulas, and set an overall format for the report. This is the report that will be demonstrated for this How-To.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>SubReport</P>
</TD>
<TD class="docTableCell" valign="top">
<P>This report helps you to create main reports that utilize subreports. An example is invoices for customers.</P>
</TD>
</TR>
</COLGROUP>
</TABLE></P>
<P>If the Standard report type is highlighted, click OK, and the Standard Report Expert dialog opens, as shown in Figure 10.2.</P>
<CENTER><H5 class="docFigureTitle">Figure 10.2. The tabs on this dialog box are actually experts in their own rights.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="379" src="FILES/10fig02.jpg" ALT="graphics/10fig02.jpg"></p>
</CENTER>
<H5 class="docSection3Title"> Tabs Included in the Standard Report Wizard</H5>
<P>Included on the Standard Report Wizard are the following tabs:</P>
<UL>
<LI><p>
<span class="docEmphRoman">Data.</span> 
Specify the database and table that you will be using for this report. You will have a number of different choices from datasets within the current application to OLEDB connections. For this chapter, you will be creating an OLEDB connection to the Northwind database.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Fields.</span> 
After you have selected your record source, you then get a list of the fields from within your record source (see Figure 10.3).</p>
<CENTER><H5 class="docFigureTitle">Figure 10.3. Besides fields from your table, you can create formulas (expressions) as well.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="379" src="FILES/10fig03.jpg" ALT="graphics/10fig03.jpg"></p>
</CENTER>
<P>In addition to creating formulas, you can view the data using the Browse Data option and locate fields using the Find Field option.</P></LI>
<LI><p>
<span class="docEmphRoman">Group.</span> 
This tab allows you to specify the group levels you want to include. An example you will see here groups the customer by region (see Figure 10.4).</p>
<CENTER><H5 class="docFigureTitle">Figure 10.4. It is often useful to be able to organize your reports based on groupings, such as the Region field in this report.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="379" src="FILES/10fig04.jpg" ALT="graphics/10fig04.jpg"></p>
</CENTER><div class="docNote"><p class="docNoteTitle">Tip</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" WIDTH="100" HEIGHT="100" src="FILES/tip_icon.gif" ALT="graphics/tip_icon.gif"></td>
<td valign="top"><P>If you want to have a field used for grouping, then you will most likely not want to have it listed in the detail section. It is important that you do not choose it back on the Field tab; just choose it from the Group tab.</P>
<P>Of course, if you accidentally include it in the detail section after the report is created, you can always delete it later from the report while you're in the Design view.</P>
</td>
</tr></table></p>
</div><br></LI>
<LI><p>
<span class="docEmphRoman">Total.</span> 
This tab allows you to specify which fields you want to summarize in the group footers and report footer.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Top N.</span> 
You can set how you want the groups sorted, based on the totals set by the last tab, Total.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Chart.</span> 
Create a chart of your data.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Select.</span> 
Filter which records you want to have reported based on field values. You will see how to do this at runtime in How-To 10.5.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Style.</span> 
You can give your report a number of different looks. You also can specify the title of your report (see Figure 10.5.)</p>
<CENTER><H5 class="docFigureTitle">Figure 10.5. This chapter will stick to using the Red/Blue border style.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="379" src="FILES/10fig05.jpg" ALT="graphics/10fig05.jpg"></p>
</CENTER>
</LI>
</UL>
<P>After you have finished specifying your report features, click Finish. Your report will now be displayed in Design view (see Figure 10.6).</P>
<CENTER><H5 class="docFigureTitle">Figure 10.6. The finished product.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="375" src="FILES/10fig06.jpg" ALT="graphics/10fig06.jpg"></p>
</CENTER>
<P>For this How-To, you want to get to the point where you have the report created. The next How-To describes how to actually view the report on a Windows Form.</P>
<P>You can find all the examples in this chapter in the Solution called Visual Basic .NET-Chapter 10 on the Web site.</P>
<H4 class="docSection2Title"> Steps</H4>
<P>Open the Visual Basic .NET-Chapter 10 solution. In the Solution Explorer, you see the report rptHowTo10_3.rpt. You then see a report that looks similar to the one in Figure 10.7.</P>







<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1"><P>Right-click on your project in the Solution Explorer, and choose Add New Item menu item from the Add menu item. Type a name for the report in the Name field, and click Open. The Crystal Report Gallery dialog box opens.</P></span></LI><LI><span style="font-weight:normal" value="2"><P>Leaving the defaults as they are, which is to use the Report Export and create a Standard report, click the OK button. You are taken to the Report Expert, with the Data tab displayed.</P></span></LI><LI><span style="font-weight:normal" value="3"><P>Double-click on the OLE DB (ADO) node in the Available Data Sources tree if you haven't chosen a data source before. The OLE DB (ADO) dialog box opens the option and asks you to choose an OLE DB provider. Choose Microsoft OLE DB Data Provider for SQL Server (see Figure 10.7) and click Next.</P>
<P>You are requested to enter connection information. For this page, type <TT>(Local)</TT> for the server, check Integrated Security, and type <TT>Northwind</TT> for the database (see Figure 10.8). Click Finish. Your Available Data Sources will now include (Local) under the OLE DB (ADO) node and Northwind under the local connection.</P>
<CENTER><H5 class="docFigureTitle">Figure 10.8. Information that is needed to create the Northwind connection.</H5><p><IMG BORDER="0" WIDTH="467" HEIGHT="398" src="FILES/10fig08.jpg" ALT="graphics/10fig08.jpg"></p>
</CENTER></span></LI><LI><span style="font-weight:normal" value="3"><P>Expand the tree under Northwind to get to the first DBO, and then expand Tables. You then see the tables listed, including the Customers table. Highlight the Customers table, and click Insert Table. The table is displayed in the Tables in Report list (see Figure 10.9.) Click Next.</P>
<CENTER><H5 class="docFigureTitle">Figure 10.9. After you have the Tables node expanded, it is easy to tell where your record sources come from.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="379" src="FILES/10fig09.jpg" ALT="graphics/10fig09.jpg"></p>
</CENTER></span></LI><LI><span style="font-weight:normal" value="4"><P>From the Fields tab, add the fields as displayed in Figure 10.10, and then click Next. You are taken to the Group tab.</P>
<CENTER><H5 class="docFigureTitle">Figure 10.10. These fields will be displayed in the Details section of the report.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="379" src="FILES/10fig10.jpg" ALT="graphics/10fig10.jpg"></p>
</CENTER></span></LI><LI><span style="font-weight:normal" value="5"><P>Under the (local) node in the field tree, select Region from the Customers table, and click Add. Now you're ready to choose the style. Skip over to the Style tab by clicking on it directly.</P></span></LI><LI><span style="font-weight:normal" value="6"><P>Type <TT>My First Report</TT> for the title of the report, and then select Red/Blue Border for the style. Click Finish, and your report is displayed in Design mode.</P></span></LI></OL></span>
<CENTER><H5 class="docFigureTitle">Figure 10.7. Choosing the OLE DB (ADO) Data provider.</H5><p><IMG BORDER="0" WIDTH="467" HEIGHT="398" src="FILES/10fig07.jpg" ALT="graphics/10fig07.jpg"></p>
</CENTER>
<H4 class="docSection2Title"> Comments</H4>
<P>The next How-To explains how to display your report.</P>
<P>You can modify your report by both clicking on controls and changing them in the Design mode, or right-clicking on one of the section bodies (not the gray bands), and choosing Report, Report Expert. This takes you right back into the Report Expert to let you make some tweaks when you have to.</P>
<P>You will also see the various tabs of the Report Expert as you right-click and choose some of the individual Experts to give you a hand. Try these right now. Take some time to right-click on some of the section bodies, and select some of the choices from the pop-up menu to play with, such as Report, then Style Expert.</P>
<ul></ul>
</body></html>
