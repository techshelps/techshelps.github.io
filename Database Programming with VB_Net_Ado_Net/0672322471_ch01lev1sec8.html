<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="1.8 Bind Data to ComboBox and DataGrid Controls"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">1.8 Bind Data to ComboBox and DataGrid Controls</H3>
<P>Sometimes you might want to use a <TT>ComboBox</TT> control instead of a <TT>ListBox</TT> control to display a list of choices. You also might want to display information in a grid style based on the item chosen in that combo box. This How-To describes how to bind data to both <TT>ComboBox</TT> and <TT>DataGrid</TT> controls.</P>
<P>Instead of using a <TT>ListBox</TT> control to display customers, you would like to use a <TT>ComboBox</TT> control to display them. After you choose a customer, you would like to display information about the orders that belong to that customer. How do you bind data to the <TT>ComboBox</TT> and then bind the <TT>DataGrid</TT> control as well?</P>
<H4 class="docSection2Title"> Technique</H4>
<P>To bind both the <TT>ComboBox</TT> and the <TT>DataGrid</TT> controls, you will use the same properties and coding techniques that you have used for the <TT>ListBox</TT> control. You will first create <TT>DataAdapter</TT> and <TT>DataSet</TT> controls to which to set the <TT>DataSource</TT> properties. The <TT>DataAdapter</TT> for the <TT>DataGrid</TT> will include a parameter that will use the value selected in the <TT>ComboBox</TT> control.</P>
<P>You will set the <TT>DataSource</TT> properties of the controls to the <TT>DataSet</TT> created. That is all you really have to set for the <TT>DataGrid</TT> control. For the <TT>ComboBox</TT> control, you will also set the <TT>ValueMember</TT> and <TT>DisplayMember</TT> properties.</P>
<P>You will then add code to fill the <TT>DataSet</TT> control to which the <TT>DataSource</TT> property is set for the <TT>ComboBox</TT> control. Finally, you will create a subroutine to store the selected value in the <TT>ComboBox</TT> in the <TT>DataAdapter</TT> that was created for filling the DataSet on which the <TT>DataGrid</TT> control is based.</P>
<P>After the user has selected a value in the <TT>ComboBox</TT> that contains the customers, the <TT>DataGrid</TT> control displays the orders for that customer, as can be seen in Figure 1.14.</P>
<CENTER><H5 class="docFigureTitle">Figure 1.14. Users can display the header information for customer orders using these two controls.</H5><p><IMG BORDER="0" WIDTH="424" HEIGHT="300" src="FILES/01fig14.jpg" ALT="graphics/01fig14.jpg"></p>
</CENTER>
<H4 class="docSection2Title"> Steps</H4>
<P>You will be starting with a fresh form.</P>





<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1"><P>Add a new Windows Form called <TT>frmHowTo1_8</TT>.</P></span></LI><LI><span style="font-weight:normal" value="2"><P>Add the <TT>OleDbDataAdapter</TT> and <TT>DataSet</TT> controls with the properties set forth in Table 1.7.</P>
<P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<CAPTION><h5 class="docTableTitle">Table 1.7. <TT>OleDataAdapter</TT> and <TT>DataSet</TT> Controls</h5></CAPTION><COLGROUP span="3">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Object</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Property</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Setting</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>OleDataAdapter</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>odaCustomerList</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>SelectCommand</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>OleDbSelectCommand1</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>CommandText</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>SELECT CustomerID</TT>, <TT>CompanyName FROM Customers</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>DataSet</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsCustomerList</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>DataSetName</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsCustomerList</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>OleDataAdapter</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>odaOrdersForCustomer</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>SelectCommand</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>OleDbSelectCommand2</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>CommandText</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>SELECT OrderID</TT>, <TT>OrderDate</TT>, <TT>RequiredDate</TT>, <TT>ShippedDate FROM Orders WHERE</TT> (CustomerID = ?) <TT>ORDER BY OrderDate</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>DataSet</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsOrdersForCustomer</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>DataSetName</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsOrdersForCustomer</TT></P>
</TD>
</TR>
</COLGROUP>
</TABLE></P>
<div class="docNote"><p class="docNoteTitle">Tip</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/tip_icon.gif" ALT="graphics/tip_icon.gif"></td>
<td valign="top"><P>You will want to create the <TT>OleDbDataAdapter</TT> controls using the Data Adapter Configuration Wizard, and then set the name after the DataAdapter has been created. You will want to create the <TT>DataSet</TT> controls by right-clicking on the appropriate <TT>OleDbDataAdapter</TT> and choosing Generate Dataset. If you have questions about creating these controls, reread How-To 1.1.</P>
<P>Also, remember that when generating the DataSet, VS always changes the name by adding a 1 on the end and capitalizing the first letter. You might want to change it to what you really want in the properties directly.</P>
</td>
</tr></table></p>
</div></span></LI><LI><span style="font-weight:normal" value="3"><P>Add the <TT>ComboBox</TT> and <TT>DataGrid</TT> controls, as well as the Label for the ComboBox, setting the properties as shown in Table 1.8.</P>
<P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<CAPTION><h5 class="docTableTitle">Table 1.8. <TT>Label</TT>, <TT>ComboBox</TT>, and <TT>DataGrid</TT> Controls Property Settings</h5></CAPTION><COLGROUP span="3">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Object</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Property</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Setting</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Label1</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>"Customers to List Orders For:"</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>ComboBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>cboCustomers</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>DataSource</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsCustomerList.Customers</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>DisplayMember</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>CompanyName</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>ValueMember</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>CustomerID</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>DataGrid</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dgOrders</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>DataSource</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dgOrdersForCustomer.Orders</TT></P>
</TD>
</TR>
</COLGROUP>
</TABLE></P></span></LI><LI><span style="font-weight:normal" value="4"><P>Add code shown in Listing 1.23 to the <TT>Load</TT> event of the form. This code fills the <TT>dsCustomerList</TT> DataSet control based off the select statement used in the <TT>odaCustomerList OleDbDataAdapter</TT> control. After this occurs, the <TT>RefreshOrders</TT> subroutine is called, displayed in Listing 1.24.</P>
<H5 class="docExampleTitle">Listing 1.23 <TT>frmHowTo1_8.vb</TT>: Filling the Dataset Used by the <TT>ComboBox</TT> Control</H5>
<PRE>
Private Sub frmHowTo1_8_Load(ByVal sender As Object, _
                    ByVal e As System.EventArgs) Handles MyBase.Load

        Me.odaCustomerList.Fill(Me.dsCustomerList)
        RefreshOrders()

    End Sub
</PRE>
<H5 class="docExampleTitle">Listing 1.24 <TT>frmHowTo1_8.vb</TT>: Filling the Dataset Used by the DataGrid Control, Based on the Item Selected in the <TT>ComboBox</TT> Control</H5>
<PRE>
Private Sub RefreshOrders()

        '- Clear Orders for customer dataset
        Me.dsOrdersForCustomer.Clear()

        '- Check to see if an item was selected
        If Me.cboCustomers.SelectedIndex &lt;&gt; -1 Then

            '- Store the selected customer ID into the parameter
       '    the SQL data adapter
            Me.odaOrdersForCustomer.SelectCommand.Parameters(0).Value = _
                        Me.cboCustomers.SelectedItem(0)

            '- Fill the dataset
            Me.odaOrdersForCustomer.Fill(Me.dsOrdersForCustomer)

        End If

    End Sub
</PRE></span></LI><LI><span style="font-weight:normal" value="5"><P>Add the code in Listing 1.25 to the SelectedIndexChanged event of the <TT>cboCustomers</TT> ComboBox controls.</P>
<H5 class="docExampleTitle">Listing 1.25 <TT>frmHowTo1_8.vb</TT>: Refreshing the <TT>DataGrid</TT> Control Based on Selected Item</H5>
<PRE>
Private Sub cboCustomers_SelectedIndexChanged(ByVal sender
                    As System.Object, ByVal e As System.EventArgs)
                    Handles cboCustomers.SelectedIndexChanged

        RefreshOrders()

    End Sub
</PRE></span></LI></OL></span>
<H4 class="docSection2Title"> How It Works</H4>
<P>When the form is first loaded or a new item is selected in the <TT>ComboBox</TT> control, the <TT>DataGrid</TT> control is filled with order information for the selected customer.</P>
<H4 class="docSection2Title"> Comments</H4>
<P>As you can see from this How-To, using the <TT>ComboBox</TT> control and <TT>DataGrid</TT> controls are not much tougher than using the ListBox control. The <TT>DataGrid</TT> control does offer quite a bit more power to let you create Main/Subform type forms such as invoices. You will see an example of this in the next How-To. The <TT>DataGrid</TT> control also lets you edit data.</P>
<img src="FILES/pixel.gif" width="1" height="1" border="0"><ul></ul>
</body></html>
