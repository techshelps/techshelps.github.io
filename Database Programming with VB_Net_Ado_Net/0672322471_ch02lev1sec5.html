<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="2.3 Define a Primary Key and Other Indexes"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">2.3 Define a Primary Key and Other Indexes</H3>
<P>Indexes are used to improve performance when querying data, such as searching on fields and sorting information. The <span class="docEmphasis">primary key</span> is an index that ensures that you have at least one unique value in each record, such as a Customer ID. This How-To discusses what the best candidates are for primary keys, as well as how to create them and other indexes.</P>
<P>You have created a base table and have even entered data into it. How do you make sure that you have a way of finding specific records? LastName and FirstName fields won't work because you can have duplicates of those. You also want to make sure that when you search on fields, you get the best possible performance from SQL Server. Indexes can be created to help performance. How do you define a primary key field to make sure that you have unique records and can create other indexes as well?</P>
<H4 class="docSection2Title"> Technique</H4>
<P>Within the Server Explorer, you can use a field, such as a Social Security Number, and make that into a primary key field. By making a field the primary key field, you will need to make that field unique and prohibit null values there. The alternative to a current unique field is to create a field that is automatically incremented, called an <span class="docEmphasis">identity field</span>. This identity field can also be set as the primary key field, again so that the record is made unique. The primary key field will also be indexed.</P>
<P>Besides creating the special primary key field, you can create indexes that perform two main functions:</P>
<UL>
<LI><p>
<span class="docEmphRoman">Performance.</span> 
Used to increase performance when the column is used for search criteria and sorting and when you're loading ranges of records.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Constraints.</span> 
This is one of the jobs that the primary key field performs-constraining the data that users can put into the table.</p>
</LI>
</UL>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>When creating indexes for performance purposes only, take care that you don't go overboard. Although indexes help performance when searching and sorting, they can hurt performance when adding and updating data. This is mainly true when importing or adding large amounts of data.</P>
<P>The other point is that when the table is small, you can over-index as well.</P>
</td>
</tr></table></p>
</div><br>
<P>While you're in the table designer, you can get to Indexes, located on the Property Pages dialog box, by choosing Indexes/Keys from the View menu. You can see the Property Pages dialog box in Figure 2.4.</P>
<CENTER><H5 class="docFigureTitle">Figure 2.4. You can create all the necessary indexes using this dialog box.</H5><p><IMG BORDER="0" WIDTH="401" HEIGHT="500" src="FILES/02fig04.jpg" ALT="graphics/02fig04.jpg"></p>
</CENTER>
<P>Within Indexes, you have some options to specify, such as whether you would like to have the values in the index be unique You will want to have tables where you have a lot of data and you will be deleting or updating large amounts of records at a time. You also will use a field in a range situation, such as using <TT>BETWEEN</TT>, <TT>&gt;</TT>, <TT>&gt;=</TT>, <TT>&lt;</TT>, and <TT>&lt;=</TT> for operators.</P>
<H4 class="docSection2Title"> Steps</H4>
<P>Using the Server Explorer, open the Chapter2 database and right-click on the tblCustomers that you created in the last How-To. Then select Design Table from the right-click menu.</P>




<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1"><P>Place the cursor in the first row, if it isn't already there. Click the right mouse button, and choose Insert Column from the menu. Next, fill in the properties of the field as follows:</P>
<P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<COLGROUP span="2">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Property</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Value</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Column Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>CustomerID</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>DataType</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>int</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Length</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>4</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Allow Nulls</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Unchecked</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Identity</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Yes</TT></P>
</TD>
</TR>
</COLGROUP>
</TABLE></P>
<P>When you specify that you want to make this an identity field, the next two properties will be used. The first, Identity Seed, is what the column's values will be started at. The next property, Identity Increment, will be how records that are added will be incremented.</P></span></LI><LI><span style="font-weight:normal" value="2"><P>Right-click in the Column Name property of the CustomerID column, and then choose Set Primary Key from the menu. You have now set the CustomerID to be the primary key, and the screen should look similar to Figure 2.5. The index that you just created when you specified CustomerID to be the primary key falls into the constraint category of indexes.</P>
<CENTER><H5 class="docFigureTitle">Figure 2.5. You need to have one primary key field per table.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="375" src="FILES/02fig05.jpg" ALT="graphics/02fig05.jpg"></p>
</CENTER></span></LI><LI><span style="font-weight:normal" value="3"><P>To create other indexes that will help performance, choose Indexes/Keys from the View menu to open the Property Pages dialog box.</P></span></LI><LI><span style="font-weight:normal" value="4"><P>On the Indexes page, click the New button, and then fill in the following properties to add an index for the LastName field: Index Name with "IX_LastName" and Column Name with "LastName."</P>
</span></LI></OL></span>
<div class="docNote"><p class="docNoteTitle">Tip</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/tip_icon.gif" ALT="graphics/tip_icon.gif"></td>
<td valign="top"><P>If you sort on multiple columns such as LastName and FirstName together, which is quite common, you could add the FirstName column underneath the LastName column in the last step. This is called a <span class="docEmphasis">compound index</span>.</P>
</td>
</tr></table></p>
</div><br>
<H4 class="docSection2Title"> How It Works</H4>
<P>When you create tables, you create your primary key columns and indexes at the same time. You can come up with indexes at a later date as well.</P>
<H4 class="docSection2Title"> Comments</H4>
<P>Be sure to create a primary key column for each of your tables, and use identity columns for primary columns whenever possible.</P>
<P>SQL Server will take advantage of indexes you have created, but just be careful not to over-index. Remember to examine what columns you will be sorting and querying on. With particularly large tables, indexes become more important than ever.</P>
<ul></ul>
</body></html>
