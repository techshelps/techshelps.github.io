<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="Dealing with Stateless Programming"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title"> Dealing with Stateless Programming</H3>
<P>One of the big differences lies in the fact that Web pages are still inherently stateless. This means that when you move from page to page, you tend to lose the data that the pages use. Although this is not a big problem when you are creating simple Web pages that perform easy tasks, when you begin creating real applications, especially dealing with databases or data that users input, this factor can be a big hassle.</P>
<H4 class="docSection2Title"> State Management on the Client</H4>
<P>In the past, the statelessness of Web pages was dealt with to an extent in a number of ways on the client side:</P>
<UL>
<LI><p>
<span class="docEmphRoman">Cookies.</span> 
Small files that a Web application creates. Cookies store data on the local machines of those who are accessing the Web application. A couple of problems exist with just using cookies. First, cookies are stored on the local machine, so the machine (or browser) must allow them. Second, the type of data that can be stored in cookies is limited.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Query strings.</span> 
Information that is appended to the end of a page's URL. You will see examples of this when you're creating hyperlinks and calling new Web pages.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Hidden fields.</span> 
An HTML field that is hidden to the user. These are not visible to the class module either.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Control.ViewState property.</span> 
Provides a dictionary object for retaining values between multiple requests for the same page. Note that this is the method that the page uses to preserve page and control property values between round trips.</p>
</LI>
</UL>
<P>Although some of these management techniques have been used in ASP, they are still valid in .NET, and they are useful given the correct circumstances. When you're developing in ASP.NET, some additional solutions are available for state management. Those solutions are handled on the server side.</P>
<H4 class="docSection2Title"> Server-Side Solution to State Management</H4>
<P>Depending on the information that you want to retain, .NET has a number of ways to handle state management. Although you could use the methods just mentioned, a few other options are available as well:</P>
<UL>
<LI><p>
<span class="docEmphRoman">Application state.</span> 
You can save values to this object <TT>Application("ItemName") = value</TT> by using an instance of the HttpApplicationState class, but all those people who are in the application at that time will be able to see it.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Session state.</span> 
This option allows you to maintain state for the individual session. This is discussed further in the next section.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Database support.</span> 
SQL Server helps you to maintain state by adding values to the Temp database on the server.</p>
</LI>
</UL>
<H5 class="docSection3Title"> Using the <TT>Session</TT> Object</H5>
<P>The <TT>Session</TT> object is pretty straightforward to work with. When you assign the variable, you will use the following syntax:</P>
<pre>
Session("<span class="docEmphasis">SessionVariableName</span>") = Value
</pre>
<P><TT>SessionVariableName</TT> is in fact used inside the quotes. It can be whatever you want to call it.</P>
<P><TT>Value</TT> can be any type of variable, including a <TT>DataTable</TT> object, as you will see in the steps that follow.</P>
<P>Sometimes, you can stash the data table and a Boolean variable to the <TT>Session</TT> object. Following is one of the lines of code that stores the data table:</P>
<pre>
Session("<span class="docEmphasis">MyLookupData</span>") = <span class="docEmphasis">mdtLookupData</span>
</pre>
<P><TT>MyLookupData</TT> is the name of the entry that is created in the <TT>Session</TT> object. <TT>mdtLookupData</TT> is the variable name of the <TT>DataTable</TT> object, declared at the module level.</P>
<P>When you're reading a variable, you will turn the statement around and add a <TT>CType() </TT>function to convert the value to the desired type.</P>
<pre>
Variable = CType(Session("SessionVariableName",Type)
</pre>
<P>In the instance of a data table, such as the one used in this How-To, you would see something like this:</P>
<pre>
mdtLookupData = CType(Session("MyLookupData"), DataTable)
</pre>
<P>Note that you can use other conversion functions besides <TT>CType()</TT>. If you don't convert the value, then the <TT>Object</TT> type will be returned.</P>
<P>Another task that is necessary to perform is testing whether the entry in the <TT>Session</TT> object has been made. You do this by testing the <TT>Session</TT> entry against the <TT>Nothing</TT> keyword, as seen here:</P>
<pre>
'Put user code to initialize the page here
If Not (Session("MyLookupData") Is Nothing) Then

    mdtLookupData = CType(Session("MyLookupData"), DataTable)

End If
</pre>
<P>This code is used in the <TT>Load</TT> event of the page. If the entry has been created in the <TT>Session</TT> object, then the data is loaded into the variable. You can also use the opposite as well. If the entry in the <TT>Session</TT> object is <TT>Nothing</TT>, then create the entry.</P>
<P>This is just a quick and simple way of taking advantage of the Session object. There are probably hundreds of other ways to take advantage of the Session object. For more information on this, check out Session State in the <span class="docEmphasis">.NET Framework Developer's Guide</span>, which is part of the help provided by Visual Studio. Type in "state management in ASP.NET" for the index to locate the Session object topic.</P>
<P>You can find all of the examples in this chapter in the Solution called Visual Basic .NET-Chapter 5 on the Web site.</P>
<ul></ul>
</body></html>
