<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="11.10 Use Object Permissions"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">11.10 Use Object Permissions</H3>
<P>At this point, you have added SQL Server logins and established user accounts in each database within SQL Server. In most situations, you want to restrict the user's access to tables, views, stored procedures, and other objects within this database. This is done by setting permissions on these database objects.</P>
<P>I do not want every user to have read, write, and update permissions on every table within the database. Otherwise, unauthorized users are able to view data that they are not permitted to see. Often, only certain users are permitted to add new records or to delete existing records in a database table. Without object permissions, I have no way of controlling individual user access to the data within a database.</P>
<H4 class="docSection2Title"> Technique</H4>
<P>You'll use the Enterprise Manager dialog boxes to assign permissions on the objects within a database. SQL Server provides the following object permissions for tables, views, and stored procedures:</P>
<UL START=""><LI><p>
<span class="docEmphRoman">Select.</span> 
Permission to issue SELECT statements against a table or view to retrieve data.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Insert.</span> 
Permission that allows the user to execute the INSERT statement to add new records to a table or view.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Update.</span> 
Permission that allows the UPDATE statement to run, changing the data in a row of a table or view.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Delete.</span> 
Permission to run the DELETE statement and remove rows from a table or view.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Execute.</span> 
Permission that allows the user to run stored procedures and functions within the database.</p>
</LI>
</UL>
<H4 class="docSection2Title"> Steps</H4>
<P>A SQL Server database contains a wide variety of database objects, such as tables, views, and stored procedures. A user account can be assigned specific permissions on each object in a SQL Server database. These permissions direct SQL Server to allow an account to run stored procedures, view and update data that is contained in tables, and perform other database operations.</P>
<P>As you click on the individual object permissions, the check box changes from empty to a green check mark to a red X, as mentioned in the previous How-To.</P>





<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1"><P>Open Enterprise Manager and expand the Northwind database's icon.</P></span></LI><LI><span style="font-weight:normal" value="2"><P>Expand the Northwind database's Tables icon to display all the tables in Enterprise Manager's right pane.</P></span></LI><LI><span style="font-weight:normal" value="3"><P>Right-click on a table in the Tables list, and select Properties from the shortcut menu to open the Table Properties dialog box (see Figure 11.17).</P>
<CENTER><H5 class="docFigureTitle">Figure 11.17. The Table Properties dialog box displays important information about the table.</H5><p><IMG BORDER="0" WIDTH="404" HEIGHT="448" src="FILES/11fig17.jpg" ALT="graphics/11fig17.jpg"></p>
</CENTER></span></LI><LI><span style="font-weight:normal" value="4"><P>Select the Permissions button in the upper-right corner of the Table Properties dialog box to displaythe Permissions tab (see Figure 11.18).</P>
<CENTER><H5 class="docFigureTitle">Figure 11.18. The Permissions tab contains all the object permission settings for the table.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="401" src="FILES/11fig18.jpg" ALT="graphics/11fig18.jpg"></p>
</CENTER></span></LI><LI><span style="font-weight:normal" value="5"><P>Select a user or role from the leftmost column, and then click on the check box in any of the Permissions columns.</P></span></LI></OL></span>
<H4 class="docSection2Title"> Comments</H4>
<P>Each permission on an object has three levels of access:</P>
<UL>
<LI><p>
<span class="docEmphRoman">Grant.</span> 
SQL Server permits all operations whose permission is set to Grant.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Revoke.</span> 
The user is unable to perform the operation unless he's been implicitly granted permission through membership in some role (discussed in How-To 11.11) or through a group. Revoke is the default setting for all permissions.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Deny.</span> 
The user cannot perform a denied operation, even if permission is implicitly granted by role or group membership.</p>
</LI>
</UL>
<P>Most often, unless the user has a specific need to be granted or denied permission on an object, you'll leave the permission set to Revoke. This means that the permission is not provided unless the user is given permission through a database role (discussed in the next section). Generally speaking, it is better to provide too little access to database objects than to grant too much access that could lead to confidentiality or data integrity problems. This is why the default permission on SQL Server objects is set to Revoke by default.</P>
<ul></ul>
</body></html>
