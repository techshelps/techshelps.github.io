<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="Creating SQL Server Objects with ActiveX Data Objects"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title"> Creating SQL Server Objects with ActiveX Data Objects</H3>
<P>It is worthwhile to mention an example of creating a new table object with fields and primary key specified, even though the majority of the work of creating objects using ADO and SQL Server is done in the T-SQL Statement that you create. You will execute this statement using the <TT>Command</TT> object, as shown in Listing A.10.</P>
<H5 class="docExampleTitle">Listing A.10 <TT>basStoredProcedureExamples.vb</TT>: Creating SQL Server Objects with ADO and T-SQL</H5>
<PRE>
Sub CreatingASQLServerObjectFromADO(ByVal txtResults As TextBox)

   Dim cnn As New ADODB.Connection()
   Dim cmd As New ADODB.Command()
   Dim prm As ADODB.Parameter
   Dim rstOld As New ADODB.Recordset()
   Dim rstNew As New ADODB.Recordset()

   '-- In .NET, we can assign values as we declare variables.
       '  This is where the hard work is.
   Dim strSQL As String = "CREATE TABLE Test (PrimaryIntFld Integer
       IDENTITY(1,1) PRIMARY KEY, Field2 Text)"

   '-- Open the connection
   OpenNorthwindADOConnection(cnn)

   '-- Set up the Command object to use the SQL string.
   cmd.ActiveConnection = cnn
   cmd.CommandText = strSQL
   cmd.CommandType = ADODB.CommandTypeEnum.adCmdText

   '-- Execute the command
   cmd.Execute()

End Sub
</PRE>
<P>This routine is a lot like the previous example except for the SQL statement and the fact that results aren't displayed. You can see the results by going to the Visual Studio .NET Server Explorer, zeroing in on the tables for the Northwind database, and opening the new Test table in Design mode, as shown in Figure A.7.</P>
<CENTER><H5 class="docFigureTitle">Figure A.7. Creating objects such as this table is just a matter of learning the correct SQL syntax.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="375" src="FILES/afig07.jpg" ALT="graphics/afig07.jpg"></p>
</CENTER>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>If you already had the tables displayed for Northwind, you might need to right-click on the Tables node and choose Refresh.</P>
</td>
</tr></table></p>
</div><br>
<ul></ul>
</body></html>
