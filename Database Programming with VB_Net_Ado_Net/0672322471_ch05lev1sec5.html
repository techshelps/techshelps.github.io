<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="5.4 Display Data Using the Table Control"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">5.4 Display Data Using the Table Control</H3>
<P>.NET has a number of controls available for displaying data. How do I know which control to use to display data, and how do I use the Table control to display data?</P>
<H4 class="docSection2Title"> Technique</H4>
<P>When you're first deciding to list data on your Web forms, you have a few Web server controls to choose from:</P>
<UL>
<LI><p>
<span class="docEmphRoman">Table.</span> 
This Web server control allows you to create a read-only table type display of data. This control is not data bound, and it uses the TableColumn and TableRow objects for creation.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Repeater.</span> 
This control is used to display read-only lists. You can use hyperlinks and program the ItemCommand event so that you can perform actions when items are selected. You must use templates to format the display. Templates are discussed in How-To 5.5, as is the Repeater control. This is a great control for quick lists.</p>
</LI>
<LI><p>
<span class="docEmphRoman">DataList.</span> 
Using this control, you will use templates not only to display, but also to select and edit data in the list.</p>
</LI>
<LI><p>
<span class="docEmphRoman">DataGrid.</span> 
By far, this is the most powerful of the controls. In addition, it gives you the most control over manipulating data. You display, sort, edit, and use various types of controls in each column. The last three How-Tos in this chapter thoroughly cover the DataGrid control.</p>
</LI>
</UL>
<H5 class="docSection3Title"> Anatomy of the Table Web Server Control</H5>
<P>You can create the Table Web server control at design time, or as shown in this How-To, at runtime. The control is created by adding the TableRows and TableCells to the Table control. The TableRows and TableCells are controls in their own right. You can see the objects, properties, and methods that you will use to create the Table Web server control in Table 5.6.</P>
<P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<CAPTION><h5 class="docTableTitle">Table 5.6. Using a Standard Method of Creating Objects Within Objects to Construct a Table Web Server Control</h5></CAPTION><COLGROUP span="3">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Object</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Property</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Description</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TableCell</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Controls</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Controls are added to an individual TableCell object using the Add method of the Controls collection. In this example, a <TT>LiteralControl</TT> object is used to display information.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TableRow</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Cells</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>The <TT>Add</TT> method of the <TT>TableRow</TT>.<TT>Cells</TT> collection adds a new cell to the <TT>TableRow</TT>.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Table</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Rows</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>The <TT>Add</TT> method of the <TT>Table.Rows</TT> adds the <TT>TableRow</TT> object to the collection of rows for the Table control.</P>
</TD>
</TR>
</COLGROUP>
</TABLE></P>
<P>You will see these objects and methods used in step 4.</P>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>One of the issues with using the Table control is that it does not persist in trips to the server and back. Therefore, you need to reconstruct the control in the page Load event, checking with the IsPostBack property. If you are tracking a lot of changes with the Table control, this is another good reason to use one of the other controls listed at the beginning of this technique.</P>
</td>
</tr></table></p>
</div><br>
<H4 class="docSection2Title"> Steps</H4>
<P>Open and run the Visual Basic .NET-Chapter 5 solution. From the main page, click on the hyperlink with the caption How-To 5.4: Display Data Using the Table Control. When the Web Form loads, you will see a <TT>DropDown</TT> control displaying the list of categories. Below the <TT>DropDown</TT> control, you will see a Table control with the products for the selected category (see Figure 5.4).</P>




<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1"><P>Create a Web Form. Then place the controls listed in Table 5.7 and seen in Figure 5.4 with the following properties set.</P><P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<CAPTION><h5 class="docTableTitle">Table 5.7. Property Settings for Label, DropDown, and Table Controls</h5></CAPTION><COLGROUP span="3">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Object</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Property</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Setting</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Categories</TT>:</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>DropDown</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>ID</TT></PRE></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>ddCategories</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>AutoPostBack</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>True</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Table</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>ID</TT></PRE></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>tblProducts</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>GridLines</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Both</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>HyperLink</TT> </P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>ID</TT></PRE></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>hplReturnToMain</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>NavigateURL</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>wfrmMain.aspx</TT></P>
</TD>
</TR>
</COLGROUP>
</TABLE></P></span></LI><LI><span style="font-weight:normal" value="2"><P>Add the code in Listing 5.10 to the Load event of the page. If the page is first being loaded, then the dtCategories is filled and bound to the ddCategories dropdown. Last, the LoadProducts routine is called, which is described in the next step.</P>
<H5 class="docExampleTitle">Listing 5.10 <TT>wfrmHowTo5_4.aspx.vb</TT>: Loading the Categories DropDown and Product Table Controls</H5>
<PRE>
Private Sub Page_Load(ByVal sender As System.Object, _
                ByVal e As System.EventArgs) Handles MyBase.Load

        'Put user code to initialize the page here
        If Not Me.IsPostBack Then

            Dim dtCategories As New DataTable()
            Dim odaCategories As _
                        New OleDb.OleDbDataAdapter( _
                       "Select CategoryID, CategoryName From Categories",
                        BuildCnnStr("(local)", "Northwind"))

            '-- Fill the data table, and bind it to the dropdown.
            odaCategories.Fill(dtCategories)

            ddCategories.DataValueField = "CategoryID"
            ddCategories.DataTextField = "CategoryName"
            ddCategories.DataSource = dtCategories
            ddCategories.DataBind()

            LoadProducts()

        End If

End Sub
</PRE></span></LI><LI><span style="font-weight:normal" value="3"><P>In the page's class module, create the LoadProducts routine shown in Listing 5.11. After creating a DataTable object called dtProducts and filling it with a DataAdapter object, the number of columns in the dtProducts is stored in <TT>intNumCols</TT>.</P>
<P>A <TT>TableRow</TT> object is then created, which will be used for the heading row of the table. It displays the column heads. Then, for each of the columns, a <TT>TableCell</TT> object called tcHead is created. A LiteralControl is added to it, which is derived from the ColumnName property of the data table for each column. Each <TT>TableCell</TT> object is then added to the <TT>TableRow</TT> object. After all the columns have been added, the <TT>TableRow</TT> object called trHead is added to the tblProducts Table control.</P>
<P>After the table headings have been created, the same commands are created for each row in the <TT>DataTable</TT> object.</P>
<H5 class="docExampleTitle">Listing 5.11 <TT>wfrmHowTo5_4.aspx.vb:</TT> Loading the Categories DropDown and Product Table Controls</H5>
<PRE>
Private Sub LoadProducts()

    Dim dtProducts As New DataTable()
    Dim drCurr As DataRow
    Dim intCurrRow As Integer
    Dim intCurrCell As Integer
    Dim intNumCols As Integer

    Dim odaProducts As New OleDb.OleDbDataAdapter( _
                    "Select * From Products Where CategoryID = "
                    &amp; ddCategories.SelectedItem.Value, _
                    BuildCnnStr("(local)", "Northwind"))

    odaProducts.Fill(dtProducts)

    intNumCols = dtProducts.Columns.Count

    '-- Create the headings for the displayed table
    Dim trHead As New TableRow()

    For intCurrCell = 0 To intNumCols - 1

        Dim tcHead As New TableCell()
        tcHead.Controls.Add(New LiteralControl(dtProducts. _
                                    Columns(intCurrCell).ColumnName))
        trHead.Cells.Add(tcHead)

    Next

    tblProducts.Rows.Add(trHead)

    '-- Add the rows and cells
    For intCurrRow = 0 To dtProducts.Rows.Count - 1

        drCurr = dtProducts.Rows(intCurrRow)

        Dim trNew As New TableRow()

        For intCurrCell = 0 To intNumCols - 1

            Dim tcNew As New TableCell()
            tcNew.Controls.Add(New LiteralControl(drCurr.Item(intCurrCell)))
            trNew.Cells.Add(tcNew)

        Next intCurrCell

        tblProducts.Rows.Add(trNew)

    Next intCurrRow

End Sub
</PRE></span></LI><LI><span style="font-weight:normal" value="4"><P>Add the code in Listing 5.12 to the <TT>SelectedIndexChanged</TT> event of ddCategories.</P>
<H5 class="docExampleTitle">Listing 5.12 <TT>wfrmHowTo5_4.aspx.vb:</TT> Loading the Categories DropDown and Product Table Control</H5>
<PRE>
Private Sub ddCategories_SelectedIndexChanged(ByVal sender As Object,
                    ByVal e As System.EventArgs) _
                          Handles ddCategories.SelectedIndexChanged

    LoadProducts()

End Sub
</PRE></span></LI></OL></span>
<CENTER><H5 class="docFigureTitle">Figure 5.4. Using the Table control to display tables takes a lot of work.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="375" src="FILES/05fig04.jpg" ALT="graphics/05fig04.jpg"></p>
</CENTER>
<H4 class="docSection2Title"> Comments</H4>
<P>You can see from this example that using the Table Web server control takes a bit of work, and if you have a lot of data to display, it could take quite a while to build. Also, remember that you can't edit the data that is built into the control.</P>
<P>If you have just a small amount of data to display, the Table Web server control could work out nicely.</P>
<img src="FILES/pixel.gif" width="1" height="1" border="0"><ul></ul>
</body></html>
