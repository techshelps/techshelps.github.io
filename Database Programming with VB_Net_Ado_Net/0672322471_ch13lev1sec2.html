<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="13.1 Get Started with XML Web Services"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">13.1 Get Started with XML Web Services</H3>
<P>I have heard some great things about XML Web Services, but I don't know how to get started. What do I do to get started working with XML Web Services?</P>
<H4 class="docSection2Title"> Technique</H4>
<P>The best way to get started with XML Web Services is to simply create your own XML Web Service and start playing with it. Visual Studio .NET makes it extremely easy to do just that. To achieve this task, you will be creating your first Web Service, which, of course, will be Hello World. Now, before you start groaning, this example will show you the basics of creating a Web Service without a lot of other fluff that gets in the way and confuses things.</P>
<H5 class="docSection3Title"> Creating a Web Service</H5>
<P>The way you start to create a Web Service is to choose ASP.NET Web Service for a new project. When you have done this, VS will create the Web Service project, and you will be brought to what looks like a blank Web Form, as displayed in Figure 13.3.</P>
<CENTER><H5 class="docFigureTitle">Figure 13.3. Here is a newly created Web Service project.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="375" src="FILES/13fig03.jpg" ALT="graphics/13fig03.jpg"></p>
</CENTER>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>Remember: Web Services can be created in various ways. Because you are creating this one using Visual Studio .NET, you will be using ASP.NET to create it.</P>
</td>
</tr></table></p>
</div><br>
<P>For the most part, you will be using Web Services to provide central processes or functionality that you want to be consistent regardless of where you consume it from. This means that you will not be creating a user interface that users will see; you are basically creating a class-like interface that will provide methods (hence the use of Service1.asmx instead of *.aspx). You will use *.asmx as an entry point for your Web Service.</P>
<P>To really get going with working with your first Web Service, you will click on the View Code icon in the Solution Explorer. When you do so, you will see the first method to create. That's right-it is Hello World. The first thing you should do now is uncomment the lines of code that read as follows:</P>
<pre>
'&lt;WebMethod()&gt; Public Function HelloWorld() As String
'    HelloWorld = "Hello World"
'End Function
</pre>
<P>The screen should look like Figure 13.4.</P>
<CENTER><H5 class="docFigureTitle">Figure 13.4. Your first Web Service method.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="375" src="FILES/13fig04.jpg" ALT="graphics/13fig04.jpg"></p>
</CENTER>
<P>That's it! You have created your first Web Service method. Now it's time to test it.</P>
<H5 class="docSection3Title"> Testing the Web Service</H5>
<P>After you have created your Web Service, click the Start toolbar button. Visual Studio will then compile and build your Web Service. After which, Visual Studio will create a test page for your Web Service, as shown in Figure 13.5.</P>
<CENTER><H5 class="docFigureTitle">Figure 13.5. This page that Visual Studio created gives you instructions on how to specify a namespace for your Web Service within the calling application.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="375" src="FILES/13fig05.jpg" ALT="graphics/13fig05.jpg"></p>
</CENTER>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>As mentioned on this Web page, when you are developing your Web Service, Visual Basic uses a temporary namespace called <TT>http://tempuri.org/</TT>.</P>
<P>When you are going to make the Web service public, you will want to create different namespace for the Web Service. I would recommend just using the examples they give on your test Web page.</P>
</td>
</tr></table></p>
</div><br>
<P>One of the items you see on this test Web page is the list of operations, otherwise known as methods you created. If you click on the Hello World method, you will see another page that you will use to invoke the actual method (see Figure 13.6.)</P>
<CENTER><H5 class="docFigureTitle">Figure 13.6. This page allows you to test your Hello World method.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="375" src="FILES/13fig06.jpg" ALT="graphics/13fig06.jpg"></p>
</CENTER>
<P>You also will see example code for calling the method using SOAP, HTTP GET, and HTTP POST. However, you will just be using this test page to check out the Hello World example, and you will be learning how to call methods from Visual Basic behind Web Forms in How-To 3.3.</P>
<P>If you click on the Invoke button, you will see the following:</P>
<pre>
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;string xmlns="http://tempuri.org/"&gt;Hello World&lt;/string&gt;
</pre>
<P>This is the value that the method you created returns. That's it! That's all there is to the test page.</P>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>Before telling yourself that this test page doesn't do much, remember that if you did have a problem with the code in your Web Service, the problem would have shown up here. This quick testing saves a lot of hassle of writing code that actually calls the methods and then making sure the calling code wasn't causing errors.</P>
<P>Using the test page allows you to debug your Web Service before you integrate it. Okay, I am now off my SOAPbox. Pun intended.</P>
</td>
</tr></table></p>
</div><br>
<H5 class="docSection3Title"> Looking at the Description of the Web Service</H5>
<P>Visual Studio .NET saves you from a lot of work. If you click the Back button and go to the main test page, you will see a link to Description in the top sentence. If you click on this link, you will see the SOAP code shown in Listing 13.1.</P>
<H5 class="docExampleTitle">Listing 13.1 <TT>http://localhost/WebService1/Service1.asmx?WSDL</TT>: Soap Definition for Your First Web Service</H5>
<PRE>
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
<span class="docEmphStrong">-</span> &lt;definitions xmlns:http=
"<span class="docEmphStrong">http://schemas.xmlsoap.org/wsdl/http/</span>"
xmlns:soap="<span class="docEmphStrong">http://schemas.xmlsoap.org/wsdl/soap/</span>"
xmlns:s="<span class="docEmphStrong">http://www.w3.org/2001/XMLSchema</span>"
xmlns:s0="<span class="docEmphStrong">http://tempuri.org/</span>"
xmlns:soapenc="<span class="docEmphStrong">http://schemas.xmlsoap.org/soap/encoding/</span>"
xmlns:tm="<span class="docEmphStrong">http://microsoft.com/wsdl/mime/textMatching/</span>"
xmlns:mime="<span class="docEmphStrong">http://schemas.xmlsoap.org/wsdl/mime/</span>"
targetNamespace="<span class="docEmphStrong">http://tempuri.org/</span>"
xmlns="<span class="docEmphStrong">http://schemas.xmlsoap.org/wsdl/</span>"&gt;
<span class="docEmphStrong">-</span> &lt;types&gt;
<span class="docEmphStrong">-</span> &lt;s:schema elementFormDefault="<span class="docEmphStrong">qualified</span>" targetNamespace="<span class="docEmphStrong">http://tempuri.org/</span>"&gt;
<span class="docEmphStrong">-</span> &lt;s:element name="<span class="docEmphStrong">HelloWorld</span>"&gt;
  &lt;s:complexType /&gt;
  &lt;/s:element&gt;
<span class="docEmphStrong">-</span> &lt;s:element name="<span class="docEmphStrong">HelloWorldResponse</span>"&gt;
<span class="docEmphStrong">-</span> &lt;s:complexType&gt;
<span class="docEmphStrong">-</span> &lt;s:sequence&gt;
  &lt;s:element minOccurs="<span class="docEmphStrong">0</span>" maxOccurs="<span class="docEmphStrong">1</span>"
name="<span class="docEmphStrong">HelloWorldResult</span>" type="<span class="docEmphStrong">s:string</span>" /&gt;
  &lt;/s:sequence&gt;
  &lt;/s:complexType&gt;
  &lt;/s:element&gt;
  &lt;s:element name="<span class="docEmphStrong">string</span>" nillable="<span class="docEmphStrong">true</span>" type="<span class="docEmphStrong">s:string</span>" /&gt;
  &lt;/s:schema&gt;
  &lt;/types&gt;
<span class="docEmphStrong">-</span> &lt;message name="<span class="docEmphStrong">HelloWorldSoapIn</span>"&gt;
  &lt;part name="<span class="docEmphStrong">parameters</span>" element="<span class="docEmphStrong">s0:HelloWorld</span>" /&gt;
  &lt;/message&gt;
<span class="docEmphStrong">-</span> &lt;message name="<span class="docEmphStrong">HelloWorldSoapOut</span>"&gt;
  &lt;part name="<span class="docEmphStrong">parameters</span>" element="<span class="docEmphStrong">s0:HelloWorldResponse</span>" /&gt;
  &lt;/message&gt;
  &lt;message name="<span class="docEmphStrong">HelloWorldHttpGetIn</span>" /&gt;
<span class="docEmphStrong">-</span> &lt;message name="<span class="docEmphStrong">HelloWorldHttpGetOut</span>"&gt;
  &lt;part name="<span class="docEmphStrong">Body</span>" element="<span class="docEmphStrong">s0:string</span>" /&gt;
  &lt;/message&gt;
  &lt;message name="<span class="docEmphStrong">HelloWorldHttpPostIn</span>" /&gt;
<span class="docEmphStrong">-</span> &lt;message name="<span class="docEmphStrong">HelloWorldHttpPostOut</span>"&gt;
  &lt;part name="<span class="docEmphStrong">Body</span>" element="<span class="docEmphStrong">s0:string</span>" /&gt;
  &lt;/message&gt;
<span class="docEmphStrong">-</span> &lt;portType name="<span class="docEmphStrong">Service1Soap</span>"&gt;
<span class="docEmphStrong">-</span> &lt;operation name="<span class="docEmphStrong">HelloWorld</span>"&gt;
  &lt;input message="<span class="docEmphStrong">s0:HelloWorldSoapIn</span>" /&gt;
  &lt;output message="<span class="docEmphStrong">s0:HelloWorldSoapOut</span>" /&gt;
  &lt;/operation&gt;
  &lt;/portType&gt;
<span class="docEmphStrong">-</span> &lt;portType name="<span class="docEmphStrong">Service1HttpGet</span>"&gt;
<span class="docEmphStrong">-</span> &lt;operation name="<span class="docEmphStrong">HelloWorld</span>"&gt;
  &lt;input message="<span class="docEmphStrong">s0:HelloWorldHttpGetIn</span>" /&gt;
  &lt;output message="<span class="docEmphStrong">s0:HelloWorldHttpGetOut</span>" /&gt;
  &lt;/operation&gt;
  &lt;/portType&gt;
<span class="docEmphStrong">-</span> &lt;portType name="<span class="docEmphStrong">Service1HttpPost</span>"&gt;
<span class="docEmphStrong">-</span> &lt;operation name="<span class="docEmphStrong">HelloWorld</span>"&gt;
  &lt;input message="<span class="docEmphStrong">s0:HelloWorldHttpPostIn</span>" /&gt;
  &lt;output message="<span class="docEmphStrong">s0:HelloWorldHttpPostOut</span>" /&gt;
  &lt;/operation&gt;
  &lt;/portType&gt;
<span class="docEmphStrong">-</span> &lt;binding name="<span class="docEmphStrong">Service1Soap</span>" type="<span class="docEmphStrong">s0:Service1Soap</span>"&gt;
  &lt;soap:binding transport="<span class="docEmphStrong">http://schemas.xmlsoap.org/soap/http</span>"
style="<span class="docEmphStrong">document</span>" /&gt;
<span class="docEmphStrong">-</span> &lt;operation name="<span class="docEmphStrong">HelloWorld</span>"&gt;
  &lt;soap:operation soapAction="<span class="docEmphStrong">http://tempuri.org/HelloWorld</span>" style="<span class="docEmphStrong">document</span>" /&gt;
<span class="docEmphStrong">-</span> &lt;input&gt;
  &lt;soap:body use="<span class="docEmphStrong">literal</span>" /&gt;
  &lt;/input&gt;
<span class="docEmphStrong">-</span> &lt;output&gt;
  &lt;soap:body use="<span class="docEmphStrong">literal</span>" /&gt;
  &lt;/output&gt;
 &lt;/operation&gt;
  &lt;/binding&gt;
<span class="docEmphStrong">-</span> &lt;binding name="<span class="docEmphStrong">Service1HttpGet</span>" type="<span class="docEmphStrong">s0:Service1HttpGet</span>"&gt;
  &lt;http:binding verb="<span class="docEmphStrong">GET</span>" /&gt;
<span class="docEmphStrong">-</span> &lt;operation name="<span class="docEmphStrong">HelloWorld</span>"&gt;
  &lt;http:operation location="<span class="docEmphStrong">/HelloWorld</span>" /&gt;
<span class="docEmphStrong">-</span> &lt;input&gt;
  &lt;http:urlEncoded /&gt;
  &lt;/input&gt;
<span class="docEmphStrong">-</span> &lt;output&gt;
  &lt;mime:mimeXml part="<span class="docEmphStrong">Body</span>" /&gt;
  &lt;/output&gt;
  &lt;/operation&gt;
  &lt;/binding&gt;
<span class="docEmphStrong">-</span> &lt;binding name="<span class="docEmphStrong">Service1HttpPost</span>" type="<span class="docEmphStrong">s0:Service1HttpPost</span>"&gt;
  &lt;http:binding verb="<span class="docEmphStrong">POST</span>" /&gt;
<span class="docEmphStrong">-</span> &lt;operation name="<span class="docEmphStrong">HelloWorld</span>"&gt;
  &lt;http:operation location="<span class="docEmphStrong">/HelloWorld</span>" /&gt;
<span class="docEmphStrong">-</span> &lt;input&gt;
  &lt;mime:content type="<span class="docEmphStrong">application/x-www-form-urlencoded</span>" /&gt;
  &lt;/input&gt;
<span class="docEmphStrong">-</span> &lt;output&gt;
  &lt;mime:mimeXml part="<span class="docEmphStrong">Body</span>" /&gt;
  &lt;/output&gt;
  &lt;/operation&gt;
  &lt;/binding&gt;
<span class="docEmphStrong">-</span> &lt;service name="<span class="docEmphStrong">Service1</span>"&gt;
<span class="docEmphStrong">-</span> &lt;port name="<span class="docEmphStrong">Service1Soap</span>" binding="<span class="docEmphStrong">s0:Service1Soap</span>"&gt;
 &lt;soap:address location="<span class="docEmphStrong">http://localhost/WebService1/Service1.asmx</span>" /&gt;
  &lt;/port&gt;
<span class="docEmphStrong">-</span> &lt;port name="<span class="docEmphStrong">Service1HttpGet</span>" binding="<span class="docEmphStrong">s0:Service1HttpGet</span>"&gt;
  &lt;http:address location="<span class="docEmphStrong">http://localhost/WebService1/Service1.asmx</span>" /&gt;
  &lt;/port&gt;
<span class="docEmphStrong">-</span> &lt;port name="<span class="docEmphStrong">Service1HttpPost</span>" binding="<span class="docEmphStrong">s0:Service1HttpPost</span>"&gt;
  &lt;http:address location="<span class="docEmphStrong">http://localhost/WebService1/Service1.asmx</span>" /&gt;
  &lt;/port&gt;
  &lt;/service&gt;
 &lt;/definitions&gt;
</PRE>
<P>The really nice thing to remember is that Visual Studio .NET generates all this code for you, so you don't have to.</P>
<H4 class="docSection2Title"> Steps</H4>
<P>For this How-To, you will create the example Web Service that was discussed in the "Technique" section.</P>




<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1"><P>Open up Visual Studio .NET to the Start Page, with no projects or solutions opened.</P></span></LI><LI><span style="font-weight:normal" value="2"><P>From the File menu, choose New, Project. You will see the New Project dialog box. Highlight the ASP.NET Web Service template (see Figure 13.7.) Then click OK. You will then be given a blank *.asmx file.</P>
<CENTER><H5 class="docFigureTitle">Figure 13.7. You will be using the ASP.NET Web Service template for this project.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="342" src="FILES/13fig07.jpg" ALT="graphics/13fig07.jpg"></p>
</CENTER></span></LI><LI><span style="font-weight:normal" value="3"><P>Click on the in the Solution Explorer. You will see the commented out method called Hello World. Uncomment the lines of code that read as follows:</P>
<pre>
'&lt;WebMethod()&gt; Public Function HelloWorld() As String
'    HelloWorld = "Hello World"
'End Function
</pre></span></LI><LI><span style="font-weight:normal" value="4"><P>Click the Start button. You are shown the test page as described in the "Technique" ssection.</P></span></LI></OL></span>
<H4 class="docSection2Title"> Comments</H4>
<P>Although this is definitely the simplest example to be given while creating a Web Service, if you look at the description of even this simple Web Service and you see all the SOAP that is generated, you can appreciate all the work Microsoft has done to make the generation of Web Services using Visual Studio as painless as possible.</P>
<img src="FILES/pixel.gif" width="1" height="1" border="0"><ul></ul>
</body></html>
