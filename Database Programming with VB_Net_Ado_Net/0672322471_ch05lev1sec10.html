<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="5.8 Hyperlink from a Row in the Data Grid to a Detail Page"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">5.8 Hyperlink from a Row in the Data Grid to a Detail Page</H3>
<P>Often, I need to zero in and display data based on a record in the DataGrid control. How do I display detail information in a separate page from a DataGrid control?</P>
<H4 class="docSection2Title"> Technique</H4>
<P>One of the types of columns that you can use in the data grid is the HyperLink column. This column makes it fairly easy to link pages based on data. To see how the HyperLink type column is used in this How-To, take a look at Figure 5.14.</P>
<CENTER><H5 class="docFigureTitle">Figure 5.14. No code is required for link pages based on data.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="430" src="FILES/05fig14.jpg" ALT="graphics/05fig14.jpg"></p>
</CENTER>
<P>By your specifying the URL Field to be <TT>ProductID</TT> and URL Format String to be <TT>wfrmHowTo5_8b.aspx?ID={0}</TT>, the data grid automatically calls the <TT>wfrmHowTo5_8b.aspx</TT> and passes the ProductID to the form when you click on a product.</P>
<H4 class="docSection2Title"> Steps</H4>
<P>Open and run the Visual Basic .NET-Chapter 5 solution. From the main page, click on the hyperlink with the caption How-To 5.8: Hyperlink From a Row in the Data Grid to a Detail Page. You then see all the products loaded into a data grid. Notice that the products are actually hyperlinks (see Figure 5.15).</P>
<CENTER><H5 class="docFigureTitle">Figure 5.15. These hyperlinks require no code to call a detail page.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="375" src="FILES/05fig15.jpg" ALT="graphics/05fig15.jpg"></p>
</CENTER>
<P>When you click on a product, another page is displayed, with detail information supplied (see Figure 5.16).</P>





<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1"><P>Create a Web Form. Then place the controls in Table 5.12 and Figure 5.15 with the following properties set.</P><P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<CAPTION><h5 class="docTableTitle">Table 5.12. Property Settings for the Controls Used on the First Page of This How-To</h5></CAPTION><COLGROUP span="3">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Object</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Property</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Setting</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>OleDbDataAdapter</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>ID</TT></PRE></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>odaProducts</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>SelectCommand</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>SELECT ProductID</TT>, <TT>ProductName FROM Products</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>DataSet</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>ID</TT></PRE></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsProducts</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>DataGrid</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>ID</TT></PRE></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dgProducts</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>DataSource</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dsProducts</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>DataKeyField</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>ProductID</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>DataMember</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Products</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>HyperLink</TT> </P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>ID</TT></PRE></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>hplReturnToMain</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>NavigateURL</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>wfrmMain.aspx</TT></P>
</TD>
</TR>
</COLGROUP>
</TABLE></P></span></LI><LI><span style="font-weight:normal" value="2"><P>Right-click on the <TT>DataGrid</TT> control and choose Property Builder. Click on the Columns tab and set the properties as displayed in Figure 5.14. Be sure to note the name of the form you are calling in the URL Format String so that you can name it the same in step 4.</P></span></LI><LI><span style="font-weight:normal" value="3"><P>Add the code in Listing 5.30 to the Load event of the page.</P>
<H5 class="docExampleTitle">Listing 5.30 <TT>wfrmHowTo5_8a.aspx.vb:</TT> Filling and Binding the Products to the <TT>DataGrid</TT> Object</H5>
<PRE>
Private Sub Page_Load(ByVal sender As System.Object,
                ByVal e As System.EventArgs) Handles MyBase.Load

        'Put user code to initialize the page here
        odaProducts.Fill(DsProducts)
        dgProducts.DataBind()

End Sub
</PRE></span></LI><LI><span style="font-weight:normal" value="4"><P>Create another Web Form. Then place the controls in Table 5.13 and Figure 5.16 with the following properties set.</P>
<P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<CAPTION><h5 class="docTableTitle">Table 5.13. Property Settings for the Controls Used on the Second Page of This How-To</h5></CAPTION><COLGROUP span="3">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Object</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Property</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Setting</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>Label</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Text</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Product Name</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>Label</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Text</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Unit Price</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>TextBox</P>
</TD>
<TD class="docTableCell" valign="top">
<P>ID</P>
</TD>
<TD class="docTableCell" valign="top">
<P>txtProductName</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>TextBox</P>
</TD>
<TD class="docTableCell" valign="top">
<P>ID</P>
</TD>
<TD class="docTableCell" valign="top">
<P>txtUnitPrice</P>
</TD>
</TR>
</COLGROUP>
</TABLE></P></span></LI><LI><span style="font-weight:normal" value="5"><P>Add the code in Listing 5.31 to the Load event of the page. In the SQL select statement created in this listing, the <TT>Request.Item</TT> is used to grab the productID that was passed from the first form. The dtProdIndiv data table is filled, and the individual column information is loaded into the text boxes.</P>
<H5 class="docExampleTitle">Listing 5.31 <TT>wfrmHowTo5_8b.aspx.vb:</TT> Loading the Detail Information Based on the ProductID</H5>
<PRE>
Private Sub Page_Load(ByVal sender As System.Object,
                ByVal e As System.EventArgs) Handles MyBase.Load

        'Put user code to initialize the page here

        Dim odaProdIndiv As OleDb.OleDbDataAdapter
        odaProdIndiv = New _
                    OleDb.OleDbDataAdapter(_
          "Select * From Products Where ProductID = " &amp;
                    Request.Item("ID"), BuildCnnStr("(local)", "Northwind"))

        Dim dtProdIndiv As New DataTable()
        odaProdIndiv.Fill(dtProdIndiv)

        With dtProdIndiv.Rows(0)
            Me.txtProductName.Text = .Item("ProductName")
            Me.txtUnitPrice.Text = .Item("UnitPrice")
        End With

    End Sub
</PRE></span></LI></OL></span>
<CENTER><H5 class="docFigureTitle">Figure 5.16. You will use the request object in code on this page to retrieve detail data.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="375" src="FILES/05fig16.jpg" ALT="graphics/05fig16.jpg"></p>
</CENTER>
<H4 class="docSection2Title"> Comments</H4>
<P>That's it! A good way to expand this example is to add the coding technique learned in the previous How-To for editing data.</P>
<P>Using data with your Web Forms is not much harder than using Windows Forms. Just remember to stash some variables for round trips to the server and to bind your data.</P>
<ul></ul>
</body></html>
