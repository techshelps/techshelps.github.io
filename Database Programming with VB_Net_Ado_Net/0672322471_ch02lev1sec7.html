<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="2.5 Define Defaults and Constraints"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">2.5 Define Defaults and Constraints</H3>
<P>One of the main concepts to keep in mind when you're creating databases is that you need to provide a means to keep garbage (bad data) out of your tables. Default values make sure that each new record begins with valid data. An example of this is if you want to make sure that a date is entered for the order date of an invoice. You could set up a default value of today's date for new records.</P>
<P>Constraints allow you to specify what business rules you want to use with your tables, such as if you want to allow dates that are entered into the Order Date field to come after today's date. This How-To explains how to use defaults and constraints to their full potential and how to create them in Visual Studio .NET.</P>
<P>You have started down the path of handling your business rules by creating tables and setting the data types of the columns in the tables. You have even set up relationships between tables. Now you want to make life easier for your users and suggest what values they could use, and more importantly, what values are acceptable. How do you do this by defining defaults and constraints?</P>
<H4 class="docSection2Title"> Technique</H4>
<P>By using default values, you can guide your users and save them time. For example, perhaps you have a mailing list application, and the user is entering addresses. If the majority of the entries are from Washington (or WA), then you could set the default property of the State field to be WA.</P>
<P>Check constraints, not to be confused with the constraint type of index, allow you to create validation clauses that can control data that goes into the tables. An example of this would be if you didn't want someone from California (CA) entered into the addresses table from the last paragraph. You could then enter a constraint check that would read something like <TT>State &lt;&gt; 'CA</TT>'.</P>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>The rest of this chapter will use the Northwind database because it has a great structure that makes it easy to show how to use necessary techniques.</P>
</td>
</tr></table></p>
</div><br>
<P>For this How-To, in Northwind's Orders table, you are going to add a default value to the OrderDate column and a check constraint that validates the ShipDate to make sure it occurs on or after the OrderDate.</P>
<H4 class="docSection2Title"> Steps</H4>
<P>Using the Server Explorer, expand the tables branch in the Northwind database, right-click on the Orders table, and choose Design Table.</P>






<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1"><P>Place the cursor in the OrderDate column.</P></span></LI><LI><span style="font-weight:normal" value="2"><P>Type <TT>GetDate()</TT> in the Default Value property. The <TT>GetDate()</TT> function returns the current system date and time. This squares away the default value.</P></span></LI><LI><span style="font-weight:normal" value="3"><P>To enter the check constraint, open the Property Pages dialog box by right-clicking on the column and choosing Check Contraints from the menu.</P></span></LI><LI><span style="font-weight:normal" value="4"><P>Click New on the Property Page dialog box.</P></span></LI><LI><span style="font-weight:normal" value="5"><P>Enter <TT>([ShippedDate] &gt;= [OrderDate])</TT> into the Constraint Expression. You can see the completed constraint in Figure 2.9. Notice that you can also specify when the constraint will be checked by selecting the options located at the bottom of the Check Constraints page.</P>
<CENTER><H5 class="docFigureTitle">Figure 2.9. Constraints can be used to verify that data falls within business rules that you specify.</H5><p><IMG BORDER="0" WIDTH="401" HEIGHT="500" src="FILES/02fig09.jpg" ALT="graphics/02fig09.jpg"></p>
</CENTER></span></LI><LI><span style="font-weight:normal" value="6"><P>Click OK to accept the new constraint.</P></span></LI></OL></span>
<H4 class="docSection2Title"> How It Works</H4>
<P>When a new record is saved to the Orders table, if no OrderDate is added, then the <TT>GetDate()</TT> will add the system date. After that, the constraint that was added will check to see that the ShippedDate entered falls on or after the OrderDate. If this is the case, then an error message will be displayed.</P>
<H4 class="docSection2Title"> Comments</H4>
<P>Default values make users' lives easier when they can be used. You can also use default values so that users will be less tempted to leave values blank, or NULL.</P>
<P>Check constraints allow you to further control how data is entered into your database. They can be used both when modifying data and when adding new records. Be sure to set up what you need for constraints when you are creating the database.</P>
<img src="FILES/pixel.gif" width="1" height="1" border="0"><ul></ul>
</body></html>
