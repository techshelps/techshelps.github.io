<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="2.2 Define Tables and Fields"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">2.2 Define Tables and Fields</H3>
<P>A SQL Server database doesn't do much good unless you have tables in it. This tutorial not only gives you information on how to create tables and fields, but also teaches you how to name them and what to look out for when creating them. Databases by themselves don't do much for you, but you need to be able to store data in them at the very least. To do this, you need to be able to create tables, which are made up of fields. How do you go about defining tables and fields in VS .NET?</P>
<H4 class="docSection2Title"> Technique</H4>
<P>Using the Server Explorer and accessing the Table designer, you are going to create a table called tblCustomers in the database that you created in the previous How-To. You will then add columns to the database that will store various pieces of information having to do with individual customers.</P>
<P>Last, you will create another table called tblPhones and also create the necessary columns that will contain information about phone information for your customers.</P>
<H4 class="docSection2Title"> Steps</H4>
<P>After Visual Studio .NET is opened, expand the Server Explorer and locate your new database called Chapter2, created in How-To 2.1. Click on the plus sign by the database names so that the database object categories are listed.</P>




<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1">
<P>Right-click on the Tables node under the Chapter2 database and choose New Table. You will then be presented with the Table Designer. Now you are ready to add the columns.</P></span></LI><LI><span style="font-weight:normal" value="2"><P>To add a column, you need to set four immediate properties:</P>

<UL>
<LI><p>
<span class="docEmphRoman">Column Name.</span> 
This is the name of the column. Don't use spaces or special characters, but do use proper case, and make sure that the name you give the column makes sense for what it contains. For instance, if the column is for the last name of a customer, put LastName for the Name property of the column.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Data Type.</span> 
Depending on the type of data that will be entered into the column, this will be one of the many valid data types for SQL Server, shown here in Table 2.1.</p><P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<CAPTION><h5 class="docTableTitle">Table 2.1. SQL Server Data Types</h5></CAPTION><COLGROUP span="2">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Data Type</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Description</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>bigint</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Integer (whole number) data from -2<SUP>63</SUP> (-9,223,372,036,854,775,808) through 2<SUP>63</SUP>\up6 - 1\up6 (9,223,372,036,854,775,807).</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>int</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Integer (whole number) data from -2^31 (-2,147,483,648) through 2<SUP>31</SUP> - 1 (2,147,483,647).</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>smallint</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Integer data from 2<SUP>15</SUP> (-32,768) through 2<SUP>15</SUP> - 1 (32,767).</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>tinyint</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Integer data from 0 through 255.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>bit</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Integer data with either a 1 or 0 value.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>decimal</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Fixed precision and scale numeric data from -10<SUP>38</SUP> + 1 through 10<SUP>38</SUP> - 1.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>numeric</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Functionally equivalent to decimal.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>money</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Monetary data values from -2<SUP>63</SUP> (-922,337,203,685,477.5808) through 2<SUP>63</SUP> - 1 (+922,337,203,685,477.5807), with accuracy to a ten-thousandth of a monetary unit.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>smallmoney</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Monetary data values from -214,748.3648 through +214,748.3647, with accuracy to a ten-thousandth of a monetary unit.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>float</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Floating precision number data from -1.79E + 308 through 1.79E + 308.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>real</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Floating precision number data from -3.40E + 38 through 3.40E + 38.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>datetime</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Date and time data from January 1, 1753, through December 31, 9999, with an accuracy of three-hundredths of a second, or 3.33 milliseconds.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>smalldatetime</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Date and time data from January 1, 1900, through June 6, 2079, with an accuracy of one minute.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>char</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Fixed-length non-Unicode character data with a maximum length of 8,000 characters.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>varchar</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Variable-length non-Unicode data with a maximum length of 8,000 characters.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Variable-length non-Unicode data with a maximum length of 2<SUP>31</SUP> - 1 (2,147,483,647) characters.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>nchar</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Fixed-length Unicode data with a maximum length of 4,000 characters.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>nvarchar</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Variable-length Unicode data with a maximum length of 4,000 characters.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>ntext</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Variable-length Unicode data with a maximum length of 2<SUP>30</SUP> - 1 (1,073,741,823) characters.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>binary</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Fixed-length binary data with a maximum length of 8,000 bytes.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Varbinary</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Variable-length binary data with a maximum length of 8,000 bytes.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>image</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Variable-length binary data with a maximum length of 2<SUP>31</SUP> - 1 (2,147,483,647) bytes.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>cursor</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>A reference to a cursor.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>sql</TT>_<TT>variant</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>A data type that stores values of various SQL Server-supported data types, except text, ntext, timestamp, and sql_variant.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>table</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>A special data type that stores a result set for later processing.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>timestamp</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>A database-wide unique number that is updated every time a row is updated.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>uniqueidentifier</TT> </P>
</TD>
<TD class="docTableCell" valign="top">
<P>A globally unique identifier (GUID).</P>
</TD>
</TR>
</COLGROUP>
</TABLE></P><div class="docNote"><p class="docNoteTitle">Tip</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" WIDTH="100" HEIGHT="100" src="FILES/tip_icon.gif" ALT="graphics/tip_icon.gif"></td>
<td valign="top"><P>Unicode is a character-encoding standard that uses 16-bit code values. This standard is used worldwide to represent all the characters that are used in modern computing. Traditional character sets are the previous character-encoding standards-such as the Windows ANSI character set-that use 8-bit code values or combinations of 8-bit values to represent the characters used in a specific language or geographical region.</P>
<P>It is recommended that you use Unicode data types-<TT>nchar</TT>, <TT>nvarchar</TT>, and <TT>ntext</TT>-rather than their non-Unicode counterparts.</P>
<P>Also, use the variant length type data types whenever possible. Doing so will save disk space and save you from having to trim your values when you want to display the data in the fields.</P>
</td>
</tr></table></p>
</div>
</LI>
<LI><p>
<span class="docEmphRoman">Length.</span> 
This varies depending on which data type you choose. For text data types, this will be the maximum length you expect to be entered into the column.</p>
</LI>
<LI><p>
<span class="docEmphRoman">Allow Nulls.</span> 
This specifies whether you will allow null values to be saved in the record for the column. This means that the user doesn't have to enter a value at all. This is sometimes a bad idea, such as when you have specific data that has to be entered, like Social Security Numbers.</p>
</LI>
</UL>
<P>For the first few columns in the table, enter the following data. You can see how the table will look in Figure 2.3.</P>
<CENTER><H5 class="docFigureTitle">Figure 2.3. Fields for your first table.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="375" src="FILES/02fig03.jpg" ALT="graphics/02fig03.jpg"></p>
</CENTER>
<P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<COLGROUP span="4">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Column Name</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Data Type</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Length</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Allow Nulls</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>LastName</P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>nvarchar</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>50</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Unchecked</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>FirstName</P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>nvarchar</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>50</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Unchecked</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>Address</P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>nvarchar</TT> </P>
</TD>
<TD class="docTableCell" valign="top">
<P>50</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Checked</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>City</P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>nvarchar</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>50</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Checked</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>State</P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>nvarchar</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>2</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Checked</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>ZipCode</P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>nvarchar</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>9</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Checked</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>BirthDate</P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>datetime</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>8</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Checked</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>MailingList</P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>bit</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>1</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Checked</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P>EstimatedSales</P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>money</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>8</P>
</TD>
<TD class="docTableCell" valign="top">
<P>Checked</P>
</TD>
</TR>
</COLGROUP>
</TABLE></P></span></LI><LI><span style="font-weight:normal" value="3"><P>Save the table by clicking on the X in the top-right corner of the Table Designer, and name the table tblCustomers when prompted. After you click the X, you are asked if you want to save the table. Then you are prompted for the name to save the table as.</P></span></LI></OL></span>
<H4 class="docSection2Title"> How It Works</H4>
<P>By entering the information in the various properties for each column, you are specifying how you want the data in your database to be treated. Generally, your users won't create tables; you will create the tables for the users, and they will fill the data into the tables using your applications.</P>
<P>When the user fills in the data, the application and SQL Server control what type of data goes into the table, starting with what the data type of the data is and what the allowed length is. The <TT>Allow Nulls</TT> property determines whether the user even has to enter data.</P>
<H4 class="docSection2Title"> Comments</H4>
<P>Creating the tables, made up of columns and rows, is the basis for the database's purpose: storing information. Making sure that you use logical, descriptive names for columns, along with data types that help control how the data gets entered into the database, is key to a successful database. Plan out your tables ahead of time, examining each real-world object, and transfer those properties to the columns that make up the tables that represent your objects.</P>
<img src="FILES/pixel.gif" width="1" height="1" border="0"><ul></ul>
</body></html>
