<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="9.2 Create a Class That Implements the Interface You Defined"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">9.2 Create a Class That Implements the Interface You Defined</H3>
<P>Now that you have defined the public interface of your class, you need to create a class that will implement that interface, along with all of its methods and properties.</P>
<P>The place to start is with the properties of your class. You'll also need to create some code to test your class, so you'll need to create a form that interacts with the instances of the class.</P>
<H4 class="docSection2Title"> Technique</H4>
<P>This section uses a form with text boxes that mirror the properties of the <TT>CCustomer</TT> class. Visual Basic .NET allows you to have classes and forms within the same .vb file, so this section will have both in one file to make editing and debugging easier.</P>
<P>After setting up the form, you need to implement the class properties. If you have worked with Property statements before, this technique will be old hat (although the syntax will be new). If you have not worked with properties and classes, you will need the following:</P>
<UL>
<LI><P>A private variable for each property to store class data</P></LI>
<LI><P>Code to modify and return that data</P></LI>
</UL>
<H4 class="docSection2Title"> Steps</H4>











<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1"><P>Create a Windows Form and name it frmHowTo9_2. Then place text boxes for each of the properties of the class, naming the text boxes with the property name, prefaced by txt. For example, the postal code text box should be named txtPostalCode. Next add command buttons called cmdDelete, cmdSave, cmdRetrieve, and cmdNew. Finally, add a RichTextBox control called rtbToString to contain the output of the ToString method. (This enables you to see how the Form maps to the data of the class. See Figure 9.1)</P>
<CENTER><H5 class="docFigureTitle">Figure 9.1. Arrange the controls on the form you created to look like this form.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="253" src="FILES/09fig01.jpg" ALT="graphics/09fig01.jpg"></p>
</CENTER></span></LI><LI><span style="font-weight:normal" value="2"><P>Add a class declaration block to frmHowTo9_2 and name the class CCustomer. After the line <TT>Public Class CCustomer</TT>, type <TT>Implements ICustomer</TT>. This tells Visual Basic that the <TT>CCustomer</TT> class includes all of the properties and methods of the ICustomer interface as shown in Listing 9.9.</P>
<H5 class="docExampleTitle">Listing 9.9 <TT>frmHowTo9_2.vb</TT>: The Empty Customer Class</H5>
<PRE>
Public Class CCustomer
Implements ICustomer

End Class
</PRE></span></LI><LI><span style="font-weight:normal" value="3"><P>Copy all of the property and method declarations in the ICustomer interface, and paste them within the CCustomer class block.</P></span></LI><LI><span style="font-weight:normal" value="4"><P>Visual Basic .NET requires that you specify which property or method in your class implements which public member of your interface. After each property or method declaration that you just pasted into the CCustomer class block, you must add <TT>Implements ICustomer.[Property/Method Name]</TT>.</P>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>Visual Basic .NET allows you to have property and method names in your class that differ from the public member names listed in your interface. This feature exists because one class can implement many interfaces, and those interfaces can have public members of the same name. Although typing <TT>Implements ICustomer.[Property/Method Name]</TT> after a property and method with the same name-as in our example-might seem frustrating, it will come in handy when you write more complex code.</P>
</td>
</tr></table></p>
</div></span></LI><LI><span style="font-weight:normal" value="5"><P>By default, all methods, properties, and module-level variables are Public unless an access modifier, such as Private or Protected, is used (see Table 9.2). It is, however, good programming practice to use the Public access modifier, so be explicit and add Public before each member.</P>
<P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<CAPTION><h5 class="docTableTitle">Table 9.2. Visual Basic .NET Access Modifiers</h5></CAPTION><COLGROUP span="2">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Object</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Purpose</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Private</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>You can only access the member within the class.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Protected</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>You can only access the member from classes that are derived from (inherit from) the member's class.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Friend</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>You can only access the member by objects within the same project.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Protected Friend</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>You can only access the member by derived classes within the same project.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Public</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>You can access the member by any object.</P>
</TD>
</TR>
</COLGROUP>
</TABLE></P>
<P>When you are finished, your code should look like Listing 9.10.</P>
<H5 class="docExampleTitle">Listing 9.10 <TT>frmHowTo9_2.vb</TT>: The Empty <TT>CCustomer</TT> Class</H5>
<PRE>
Public Class Customer
    Implements ICustomer

    Public ReadOnly Property CustomerID() As String _
     Implements ICustomerData.CustomerID
    Public Property CompanyName() As String Implements ICustomerData.CompanyName
    Public Property ContactName() As String Implements ICustomerData.ContactName
    Public Property ContactTitle() As String _
     Implements ICustomerData.ContactTitle
    Public Function Delete() As Boolean Implements ICustomerData.Delete
</PRE>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>Copying and pasting the code from the interface will result in code with an invalid syntax because of the lack of End Property and End Function/Sub lines. Although this doesn't matter for the moment, it does disable Intellisense, which normally appears after typing both <TT>Implements</TT> and the period after the Interface name. If you want to enable Intellisense, press Enter at the end of each property and method declaration. Doing so inserts the appropriate End tag. When all the tags are in the class, Intellisense is reenabled.</P>
</td>
</tr></table></p>
</div></span></LI><LI><span style="font-weight:normal" value="6"><P>Add private variables directly below the class declaration to store class data, as shown in Listing 9.11. You should have one variable for each property. As mentioned in Chapter 3, "Viewing Data with ADO.NET," prefacing class-level variables with "m" is a Visual Basic programming convention.</P>
<H5 class="docExampleTitle">Listing 9.11 <TT>frmHowTo9_2.vb</TT>: Class Variable Declarations</H5>
<PRE>
Public Class CCustomer
    Implements ICustomer
#Region "Class Variables"
    Private mstrCustomerID As String
    Private mstrCompanyName As String
    Private mstrContactName As String
    Private mstrContactTitle As String
    Private mstrAddress As String
    Private mstrCity As String
    Private mstrRegion As String
    Private mstrCountry As String
    Private mstrPostalCode As String
    Private mstrPhone As String
    Private mstrFax As String
#End Region
</PRE></span></LI><LI><span style="font-weight:normal" value="7"><P>Write code to set and return data for the properties. Place your cursor at the end of a property declaration line, and press Enter. Visual Studio .NET automatically inserts code blocks for setting and getting your property. If you have worked with properties before, you might notice that Microsoft has changed the syntax. Listing 9.12 shows Visual Basic 6 property <TT>get</TT> and <TT>let</TT> declarations, each with its own separate block.</P>
<H5 class="docExampleTitle">Listing 9.12 Property Declarations in Visual Basic 6</H5>
<PRE>
Public Property Get PropertyName() As String
    PropertyName = mstrClassVariable
End Property

Public Property Let PropertyName(ByVal strValue As String)
    mstrClassVariable = strValue
End Property
</PRE>
<P>In Visual Basic .NET, the property declaration has been combined in the format shown in Listing 9.13.</P>
<H5 class="docExampleTitle">Listing 9.13 Property Declarations in Visual Basic .NET</H5>
<PRE>
Public Property PropertyName() As String
    Get
        Return mstrClassVariable
    End Get
    Set(ByVal Value As String)
        mstrClassVariable = Value
    End Set
End Property
</PRE>
<P>For each of your properties, add <TT>Return</TT> and the variable you declared in step 1 in the Get block. In the Set block, type the name of a variable from step 1 and <TT>= Value</TT>. All of your property declarations should now look like Listing 9.14.</P>
<H5 class="docExampleTitle">Listing 9.14 <TT>frmHowTo9_2.vb</TT>: Some Property Declarations for the <TT>CCustomer</TT> Class</H5>
<PRE>
Public ReadOnly Property CustomerID() As Customers.CCustomerID
 Implements ICustomer.CustomerID
    Get
        Return mCustomerID
    End Get
End Property

Public Property CompanyName() As String Implements ICustomer.CompanyName
    Get
        Return mstrCompanyName
    End Get
    Set(ByVal Value As String)
        mstrCompanyName = Value
    End Set
End Property
</PRE></span></LI><LI><span style="font-weight:normal" value="8"><P>To test your properties, you need to write a bit more code. First, you might want to implement the <TT>ToString</TT> method that returns all the object's properties as a string. Also, you will want a method that clears the form for use with a new object. Listing 9.15 shows one way to implement <TT>ToString</TT>, with each property printing on a separate line, as well as a <TT>ClearAllTextBoxes</TT> method.</P>
<H5 class="docExampleTitle">Listing 9.15 <TT>frmHowTo9_2.vb</TT>: The <TT>ToString</TT> Method Outputting Property Information</H5>
<PRE>
Public Overrides Function toString() As String Implements ICustomer.ToString
    Dim strReturn As String
    strReturn = Me.CustomerID &amp; vbCrLf
    strReturn = strReturn &amp; "Company:     " &amp; Me.CompanyName &amp; vbCrLf
    strReturn = strReturn &amp; "Contact:     " &amp; Me.ContactName &amp; vbCrLf
    strReturn = strReturn &amp; "Title:       " &amp; Me.ContactTitle &amp; vbCrLf
    strReturn = strReturn &amp; "Address:     " &amp; Me.Address &amp; vbCrLf
    strReturn = strReturn &amp; "City:        " &amp; Me.City &amp; vbCrLf
    strReturn = strReturn &amp; "Postal Code: " &amp; Me.PostalCode &amp; vbCrLf
    strReturn = strReturn &amp; "Country:     " &amp; Me.Country &amp; vbCrLf
    strReturn = strReturn &amp; "Phone:       " &amp; Me.Phone &amp; vbCrLf
    strReturn = strReturn &amp; "Fax:         " &amp; Me.Fax &amp; vbCrLf
    strReturn = strReturn &amp; "Region       " &amp; Me.Region &amp; vbCrLf
    Return strReturn
End Function

Protected Sub ClearAllTextBoxes()

    Me.txtAddress.Text = ""
    Me.txtCity.Text = ""
    Me.txtCompanyName.Text = ""
    Me.txtContactName.Text = ""
    Me.txtContactTitle.Text = ""
    Me.txtCountry.Text = ""
    Me.txtCustomerID.Text = ""
    Me.txtFax.Text = ""
    Me.txtPhone.Text = ""
    Me.txtRegion.Text = ""
    Me.txtPostalCode.Text = ""
    Me.rtbToString.Text = ""
End Sub
</PRE>
<P>The Overrides keyword is necessary because your class already has a <TT>ToString</TT> method. You didn't write that method, but it's there. This is because every class inherits from the <TT>Object</TT> class, which defines a <TT>ToString</TT> method. Don't worry about this: You'll learn about inheritance and overriding methods later in this chapter.</P>
<P>Now you need to add three pieces of code to the form that will instantiate the <TT>CCustomer</TT> class, and you need to allow its properties to be modified through the text boxes.</P></span></LI><LI><span style="font-weight:normal" value="9"><P>First, add a form-level variable called mCustomer of type CCustomer to the form. Use the new keyword in the declaration to create a new instance of CCustomer.</P></span></LI><LI><span style="font-weight:normal" value="10"><P>Next, add code to each <TT>TextBox</TT> control's <TT>TextChanged</TT> event that updates property values in mCustomer. Note that Listing 9.16 does not actually refer to mCustomer. Instead, Listing 9.16 calls an as-yet-undefined method called <TT>TextBoxChange</TT> that handles changes to mCustomer. This method is defined and explained in step 11.</P>
<H5 class="docExampleTitle">Listing 9.16 <TT>frmHowTo9_2.vb</TT>: The <TT>TextChanged</TT> Event of the txtPostalCode Text Box That Calls the <TT>TextBoxChange</TT> Method</H5>
<PRE>
Protected Sub txtPostalCode_TextChanged(ByVal sender As System.Object,
 ByVal e As System.EventArgs) Handles txtPostalCode.TextChanged
    TextBoxChange("PostalCode", txtPostalCode.Text)
End Sub
</PRE></span></LI><LI><span style="font-weight:normal" value="11"><P>Finally, add the <TT>TextBoxChange</TT> method that takes the value passed from each text box's <TT>TextChanged</TT> event and writes it to the appropriate property of the <TT>mCustomer</TT> object. Listing 9.17 shows a sample of this code, although it does not list a case for each text box. Centralizing all access to the <TT>mCustomer</TT> object in one method allows you to have one exception-handling area.</P>
<H5 class="docExampleTitle">Listing 9.17 <TT>frmHowTo9_2.vb</TT>: An Excerpt of the <TT>TextBoxChange</TT> Method That Writes Values in Text Boxes to Object Properties</H5>
<PRE>
Protected Sub TextBoxChange(ByVal pstrProperty As String, _
 ByVal pstrValue As String)

    Try

        Select Case pstrProperty

            Case "Address"
                mCustomer.Address = pstrValue

            Case "CompanyName"
                mCustomer.CompanyName = pstrValue

            Case "PostalCode"
                mCustomer.PostalCode = pstrValue

        End Select

        ' Write the class' properties to the RichTextBox
        ' to aid debugging.
        Me.rtbToString.Text = mCustomer.ToString()

    Catch ex As Exception
        MsgBox(ex.Message)
    End Try

End Sub
</PRE></span></LI></OL></span>
<H4 class="docSection2Title"> How It Works</H4>
<P>An instance of the <TT>CCustomer</TT> class is created when frmHowTo9_2 is created. When the user types in a text box, the <TT>TextChanged</TT> event fires, calling the <TT>TextBoxChange</TT> method. The <TT>TextBoxChange</TT> method sets the corresponding property of the class handles any exceptions, and then writes the output of the <TT>CCustomer.ToString</TT> method to the RichTextBox.</P>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>In the samples for this chapter, I want to use the same form for each section's code samples without having to re-create the form each time. To this end, I have used frmHowTo9xBase as a base form class, and all the frmHowTo9_x forms inherit from this class. Some common methods, including the TextChanged events, are defined in frmHowTo9xBase rather than in each child form.</P>
</td>
</tr></table></p>
</div><br>
<H4 class="docSection2Title"> Comments</H4>
<P>Microsoft has made several changes to property declarations, and it's worth enumerating them here.</P>
<P>First, the <TT>Get</TT> and <TT>Set</TT> code blocks are wrapped up in one Property declaration, making neater and easier-to-read code.</P>
<P>Second, the <TT>Return</TT> keyword is now used instead of the Property name in the <TT>Get</TT> block. Remember that no code is executed after the <TT>Return</TT> keyword.</P>
<P>Third, there is no longer a distinction between <TT>Set</TT> and <TT>Let</TT>. In Visual Basic 6, <TT>Set</TT> was used for Object properties, and <TT>Let</TT> was used for base datatypes, such as Strings and Integers. Microsoft has eliminated this confusing distinction, and now Set is used in all cases.</P>
<P>Just like Visual Basic 6, however, read-only properties will have only a <TT>Get</TT> block, whereas write-only properties will have only a <TT>Set</TT> block.</P>
<ul></ul>
</body></html>
