<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="10.2 Display a Report That Was Created"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">10.2 Display a Report That Was Created</H3>
<P>The report doesn't do me much good in Design mode. How do I go about viewing the report?</P>
<H4 class="docSection2Title"> Technique</H4>
<P>You can review a report in a couple of ways. You can view a report either using a Windows Form or a Web Form. Either way, you will also use a control called the Crystal Report Viewer.</P>
<H5 class="docSection3Title"> Introducing the Crystal Report Viewer</H5>
<P>The Crystal Report Viewer is a control that is available in the Toolbox. It is the last control by default. Crystal Report Viewer does far more than just let you view your document on the form. With the Viewer, you can do any of the following:</P>
<UL>
<LI><P>View the report on the form.</P></LI>
<LI><P>Zoom in and out on the document.</P></LI>
<LI><P>Expand and collapse groupings on the document.</P></LI>
<LI><P>Print from the Viewer.</P></LI>
<LI><P>Export from the Viewer.</P></LI>
<LI><P>Move around in the document</P></LI>
<LI><P>Search for text within the report.</P></LI>
</UL>
<P>You can see an example of the Crystal Report Viewer on a Windows Form in Figure 10.11, where the example form from this How-To is displayed.</P>
<CENTER><H5 class="docFigureTitle">Figure 10.11. The Crystal Report Viewer provides the user with several features, but most of the features can be disabled if necessary.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="388" src="FILES/10fig11.jpg" ALT="graphics/10fig11.jpg"></p>
</CENTER>
<P>Sometimes you might not want the user to have all the features that come with the Viewer. The good news is that the Viewer actually has its own object model whereby you can set some of the properties at design time or runtime. The Viewer even has an event model that you can program. You can see the object model for the Windows Form CrystalReportViewer in Figure 10.12.</P>
<CENTER><H5 class="docFigureTitle">Figure 10.12. Using the object model displayed here, you have almost complete control over the Viewer behavior.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="419" src="FILES/10fig12.gif" ALT="graphics/10fig12.gif"></p>
</CENTER>
<P>Although you can make the Viewer stand on its head using the object model, to get started, you really only have to set one property: the <TT>ReportSource</TT>.</P>
<P>Just as it sounds, the <TT>ReportSource</TT> tells the Viewer which report to display. You can set the <TT>ReportSource</TT> in a variety of ways. You can set the <TT>ReportSource</TT> property to the file path and name of a report, or you can create what is called a strongly typed report document.</P>
<H5 class="docSection3Title"> Specifying the <TT>ReportSource</TT> by Using the Report</H5>
<P>To specify a report file, click on the down arrow in the <TT>ReportSource</TT> property, and choose (Browse). The Open an Existing Crystal Report dialog box opens. There, you can look for the report that you want to assign within your project folder.</P>
<P>The bad part about assigning the report file directly is that when you move the application, the file path is not updated. A better way to assign the <TT>ReportSource</TT> is to use a Report Document to strongly type the report.</P>
<H5 class="docSection3Title"> Specifying the <TT>ReportSource</TT> Using a Strong Typed Report</H5>
<P>When you're using strong typed reports, you can move your application and the report file without having to re-establish the file path to the report. To accomplish this, you use what is called a Report document. You can find the Report document in the Component list. In there, it is called ReportDocument.</P>
<P>When you pull the ReportDocument component onto your form, you are asked to supply a report to be strong typed. After you have chosen your report, the ReportDocument appears in your Component tray. When you assign the ReportSource, the ReportDocument appears first in the list (see Figure 10.13).</P>
<CENTER><H5 class="docFigureTitle">Figure 10.13. Using the ReportDocument is the way to go when you're assigning reports to Viewers.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="375" src="FILES/10fig13.jpg" ALT="graphics/10fig13.jpg"></p>
</CENTER>
<H4 class="docSection2Title"> Steps</H4>
<P>Open and run the Visual Basic .NET-Chapter 10 solution. Click on the button labeled How-To 10.2. You immediately see the report show up that was created in the last How-To. Play with the toolbar buttons on the Viewer to see how they work. When you maximize the form, you the Viewer expands as well. That is because the Viewer is anchored (see Figure 10.14).</P>





<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1"><P>Create a Windows Form.</P></span></LI><LI><span style="font-weight:normal" value="2"><P>Drag a CrystalReportViewer control from the toolbox onto the form.</P></span></LI><LI><span style="font-weight:normal" value="3"><P>Drag a Report document from the Component list onto the form. Type the report name you created in the first How-To (see Figure 10.15).</P>
<CENTER><H5 class="docFigureTitle">Figure 10.15. This report is strongly typed.</H5><p><IMG BORDER="0" WIDTH="380" HEIGHT="205" src="FILES/10fig15.jpg" ALT="graphics/10fig15.jpg"></p>
</CENTER>
<div class="docNote"><p class="docNoteTitle">Tip</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/tip_icon.gif" ALT="graphics/tip_icon.gif"></td>
<td valign="top"><P>After you have clicked OK to accept the Report document, you might want to set the Name property of the control to a name with an rd prefix. I named mine rdHowTo10_2. That way, in later code, I know I am dealing with a <TT>ReportDocument</TT> control.</P>
</td>
</tr></table></p>
</div></span></LI><LI><span style="font-weight:normal" value="4"><P>Set the <TT>ReportSource</TT> property of the <TT>CrystalReportViewer</TT> control to the name of your Report document.</P></span></LI><LI><span style="font-weight:normal" value="5"><P>Set the Anchor property of the Viewer to be Top, Bottom, Left, Right. This ensures that the Viewer fills the form, regardless of the size of the form.</P></span></LI></OL></span>
<CENTER><H5 class="docFigureTitle">Figure 10.14. The report displayed in the Crystal Report Viewer.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="389" src="FILES/10fig14.jpg" ALT="graphics/10fig14.jpg"></p>
</CENTER>
<H4 class="docSection2Title"> Comments</H4>
<P>That's it, if you open the form now, you will see the report displayed in the form. You get so many features with the Crystal Report Viewer just by dumping it on the form with no code.</P>
<ul></ul>
</body></html>
