<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="8.5 Work with Data-Bound Multi-Select List Boxes Using Web Forms"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">8.5 Work with Data-Bound Multi-Select List Boxes Using Web Forms</H3>
<P>As with How-to 8.1, this example will show you how to take advantage of multi-select list boxes, only with a Web Form instead of a Windows Form.</P>
<P>You need to be able to manipulate multi-select list boxes in your Web applications using ASP.NET as well as in your Visual Basic .NET desktop applications. This How-To shows you how to use just about the same coding techniques as in How-To 8.1, but with the change of using the Web Form.</P>
<H4 class="docSection2Title"> Technique</H4>
<P>When you are performing a task in a Web Form that you have created in a Windows Form, you would think it would take the same effort-if not more-to accomplish the task. However, this is not the case for this How-To. The commands available to the Windows Form <TT>ListBox</TT> control will give better performance because you have a <TT>SelectedIndexes</TT> collection to work with, and in the Web Form you iterate through all the items in the <TT>ListBox</TT> control and check the <TT>Selected</TT> property. Nonetheless, coding on the Web Form is simpler.</P>
<P>Unlike the Windows Form version of the <TT>ListBox</TT> Control, which has four different settings for the <TT>SelectionMode</TT> property, the Web Form version has two: Single or Multiple.</P>
<P>Another thing to keep in mind when developing with data and the Web Form is that you will need to use the <TT>DataBind</TT> method off the ListBox control to bind the data at runtime. In the Load event of the page, you will want to use the <TT>IsPostBack</TT> method of the page to ensure that you perform certain tasks only when the page is initially loaded, and not on a round trip that pages take back to the server.</P>
<H4 class="docSection2Title"> Steps</H4>
<P>Open and run the VB.NET -Chapter 8 solution. From the main Web Form, click on the hyperlink with the caption How-To 8.5: Work with Data-Bound Multi-Select List Boxes Using a Web Form. You will then see the page displayed in Figure 8.8.</P>
<CENTER><H5 class="docFigureTitle">Figure 8.8. This Web Form uses controls bound at runtime and takes advantage of multi-select list boxes.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="375" src="FILES/08fig08.gif" ALT="graphics/08fig08.gif"></p>
</CENTER>
<P>When the page loads, you will see the Beverages category chosen in the top combo box. The Selected and Unselected Products ListBox controls are filled in with the appropriate products.</P>
<P>If you click on a product in the Unselected Products list box and then click on the arrow button pointing to the right (&gt;), the item is moved to the Selected Products list box. If you select items in the Selected Products list box and click on the arrow button pointing to the left (&lt;), those items are moved to the Unselected Products list box.</P>
<P>If you click on the Unassigned Products Only check box at the bottom of the form, the Unselected Products list box is filled with products that are not assigned to any category.</P>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>If you check the Unassigned Products Only check box when you are first getting into Northwind and running this example, you probably won't see unassigned items. You will need to unselect products from a category.</P>
</td>
</tr></table></p>
</div><br>









<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1"><P>Create a Web Form. Then place the controls shown in Figure 8.8 with the properties set as seen in Table 8.7.</P>
<P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<CAPTION><h5 class="docTableTitle">Table 8.7. Label, ComboBox, ListBox, and Command Button Control Property Settings</h5></CAPTION><COLGROUP span="3">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Object</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Property</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Setting</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>DOCUMENT</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>bgColor</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>buttonface</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Label1</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Category:</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>DropDown</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>ddCategories</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Label2</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Unselected Products</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>ListBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>lstUnSelected</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>SelectionMode</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Multiple</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Label3</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Selected Products</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>ListBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>lstSelected</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>SelectionMode</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Multiple</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Command Button</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>btnSelect</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT> </P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>&gt;</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Command Button</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>btnUnSelect</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>&lt;</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>CheckBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>chkUnAssignedOnly</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Label4</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>UnAssigned Products Only</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>HyperLink</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>hplReturnToMain</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Return To Main</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top" colspan="3">
<P><TT>NavigateURL wfrmMain.aspx</TT></P>
</TD>
</TR>
</COLGROUP>
</TABLE></P>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P><TT>HyperLink</TT> is optional. It is just used to get back to the main sample page for this chapter.</P>
</td>
</tr></table></p>
</div></span></LI><LI><span style="font-weight:normal" value="2"><P>As with some of the other chapters' projects, before creating the code that will be attached to the Load event of the form, you need to build a support routine to create the Connection string. Called <TT>BuildCnnStr</TT>, the function can be seen in Listing 8.24. This function takes a server and database names that are passed to it and creates a Connection string.</P>
<H5 class="docExampleTitle">Listing 8.24 <TT>modGeneralRoutines.vb</TT>: Creating a Connection String</H5>
<PRE>
Function BuildCnnStr(ByVal strServer As String, _
                  ByVal strDatabase As String) As String

        Dim strTemp As String
        strTemp = "Provider=SQLOleDB; Data Source=" &amp; strServer &amp; ";"
        strTemp &amp;= "Initial Catalog=" &amp; strDatabase &amp; ";"
        strTemp &amp;= "Integrated Security=SSPI"

        Return strTemp
    End Function
</PRE>
<P>Although you could create a routine that would pass back a <TT>Connection</TT> object, a more versatile method would be to pass back a string. Some objects ask you for a <TT>Connection</TT> object, but others just want a string. You will see <TT>BuildCnnStr</TT> called in the next step.</P></span></LI><LI><span style="font-weight:normal" value="3"><P>On the form, add the code in Listing 8.25 to the Load event. In this code, the first task is to make sure the code is run only once in the page, when it is first loading. The <TT>Not IsPostBack</TT> check performs this task. Next, you will create a data adapter called <TT>odaCategories</TT> and load the categories SQL Statement into it. The dtCategories data table is filled and set as the <TT>DataSource</TT> property of <TT>ddCategories</TT>. The <TT>DataTextField</TT> and <TT>DataValueField</TT> of <TT>ddCategories</TT> are then set. After that, the <TT>DataBind</TT> method of the <TT>DropDown</TT> is called. This is necessary for binding data to the server controls on Web Forms. Finally, two new subroutines called <TT>LoadUnSelectedProducts</TT> and <TT>LoadSelectedProducts</TT> are called to populate the appropriate list boxes. These routines are discussed in the next two steps.</P>
<H5 class="docExampleTitle">Listing 8.25 <TT>wfrmHowTo8_5.aspx</TT>: Loading Categories into a List Box</H5>
<PRE>
Private Sub Page_Load(ByVal sender As System.Object,
                    ByVal e As System.EventArgs) Handles MyBase.Load
        'Put user code to initialize the page here

        Dim odaCategories As OleDb.OleDbDataAdapter
        Dim dtCategories As New DataTable()

        '-- Make sure this code is only executed when the page is first loaded.
        If Not Page.IsPostBack Then

            '-- Load up the Categories DropDown control

            odaCategories = New _
                  OleDb.OleDbDataAdapter("Select CategoryID, CategoryName " &amp; _
                  " From Categories",
                  BuildCnnStr("(local)", "Northwind"))

            odaCategories.Fill(dtCategories)

            Me.ddCategories.DataSource = dtCategories
            Me.ddCategories.DataTextField = "CategoryName"
            Me.ddCategories.DataValueField = "CategoryID"

            '-- This is necessary for Web Forms, but not used on Windows Forms.
            Me.ddCategories.DataBind()

            LoadUnSelectedProducts()
            LoadSelectedProducts()

        End If

    End Sub
</PRE></span></LI><LI><span style="font-weight:normal" value="4"><P>Create the <TT>LoadUnSelectedProducts</TT> routine, shown in Listing 8.26, by entering the following code in the Web Form that you created for this How-To. This routine starts off by testing the check box called chkUnAssignedOnly. Based on that value, a SQL string is created that grabs the products that are either not assigned to any product, if <TT>chkUnAssignedOnly</TT> = <TT>True</TT>, or all products that are not assigned to the chosen category are retrieved. The SQL String is stored in the variable called strSQL. Next, the <TT>DataAdapter</TT> object called <TT>odaUnselected</TT> is set to strSQL and the SQL Server connection string. The <TT>DataTable</TT> object called dtUnSelected is then filled.</P>
<P>The Dispose method of the ListBox control is called to remove current items, and <TT>dtUnSelected</TT> is assigned to the <TT>DataSource</TT> property of lstUnSelected. Then the DataTextField and DataValueField properties are set. Last, the <TT>DataBind</TT> and <TT>ClearSelected</TT> methods are called to bind the lstUnSelected and ensure that no entries are left selected.</P>
<H5 class="docExampleTitle">Listing 8.26 <TT>wfrmHowTo8_5.aspx</TT>: Populating the List Box That Displays Unselected Products</H5>
<PRE>
Sub LoadUnSelectedProducts()

        Dim odaUnSelected As OleDb.OleDbDataAdapter
        Dim dtUnSelected As New DataTable()
        Dim strSQL As String

        '-- If the check box for unassigned only is checked, then
        '   grab the product items where the category is null; otherwise, load
        '   it up with those products not assigned to the current category.

        If chkUnAssignedOnly.Checked Then
            strSQL = "Select ProductID, ProductName From Products " &amp;
"Where CategoryID IS NULL Order By ProductName"
        Else
            strSQL = "Select ProductID, ProductName From Products " &amp; _
 Where CategoryID &lt;&gt; " &amp;  ddCategories.SelectedItem.Value &amp; _
" Or CategoryID IS NULL Order By ProductName"
        End If

        '-- Load up the lstUnselected based off the SQL string.

        odaUnSelected = New OleDb.OleDbDataAdapter(strSQL,
BuildCnnStr("(local)", "Northwind"))

        odaUnSelected.Fill(dtUnSelected)

        Me.lstUnSelected.Dispose()
        Me.lstUnSelected.DataSource = dtUnSelected
        Me.lstUnSelected.DataTextField = "ProductName"
        Me.lstUnSelected.DataValueField = "ProductID"

        '-- Needed on Web Forms.
        Me.lstUnSelected.DataBind()

        Me.lstUnSelected.ClearSelection()

    End Sub
</PRE></span></LI><LI><span style="font-weight:normal" value="5"><P>Create the <TT>LoadSelectedProducts</TT> routine by entering the code in Listing 8.27 into the form you created for this How-To. This routine basically performs the same tasks that the routine listed in the previous step does, except that it performs the tasks using the <TT>lstSelected ListBox</TT> control. This routine also doesn't need to test the <TT>CheckBox</TT> control.</P>
<H5 class="docExampleTitle">Listing 8.27 <TT>wfrmHowTo8_5.aspx</TT>: Populating the List Box That Displays Selected Products</H5>
<PRE>
Sub LoadSelectedProducts()

        Dim odaSelected As OleDb.OleDbDataAdapter
        Dim dtSelected As New DataTable()
        Dim strSQL As String

        '-- Create the SQL string for the category chosen in the
'  ddCategories dropdown. Then load the data table with the data
        '  and bind the lstSelected list box.

        strSQL = "Select ProductID, ProductName From Products " &amp; _
          "Where CategoryID = " &amp; _
                ddCategories.SelectedItem.Value &amp; " Order By ProductName"

        odaSelected = New _
                OleDb.OleDbDataAdapter(strSQL, _
          BuildCnnStr("(local)", "Northwind"))

        odaSelected.Fill(dtSelected)

        Me.lstSelected.Dispose()
        Me.lstSelected.DataSource = dtSelected
        Me.lstSelected.DataTextField = "ProductName"
        Me.lstSelected.DataValueField = "ProductID"

        Me.lstSelected.DataBind()
        Me.lstSelected.ClearSelection()

End Sub
</PRE></span></LI><LI><span style="font-weight:normal" value="6"><P>Add the code in Listing 8.28 to the <TT>SelectedIndexChanged</TT> event of the ddCategories drop-down.</P>
<H5 class="docExampleTitle">Listing 8.28 <TT>wfrmHowTo8_5.aspx</TT>: Repopulating the List Boxes Based on the Current Category That Is Selected</H5>
<PRE>
Private Sub ddCategories_SelectedIndexChanged(ByVal sender As System.Object,
              ByVal e As System.EventArgs) _
          Handles ddCategories.SelectedIndexChanged

        LoadUnSelectedProducts()
        LoadSelectedProducts()

End Sub
</PRE></span></LI><LI><span style="font-weight:normal" value="7"><P>Add the code in Listing 8.29 to the <TT>CheckChanged</TT> event of the <TT>chkUnAssignedOnly</TT> check box.</P>
<H5 class="docExampleTitle">Listing 8.29 <TT>wfrmHowTo8_5.aspx</TT>: Calling the Routine to Reload the lstUnSelected List Box If This Check box Is Changed</H5>
<PRE>
Private Sub chkUnAssignedOnly_CheckedChanged(ByVal sender As System.Object,
         ByVal e As System.EventArgs) Handles chkUnAssignedOnly.CheckedChanged

        LoadUnSelectedProducts()

End Sub
</PRE></span></LI><LI><span style="font-weight:normal" value="8"><P>Add the code in Listing 8.30 to the <TT>Click</TT> event of the <TT>btnSelect</TT> command button. This and the next step contain the most code as well as some new objects and properties. First, the number of highlighted items (<TT>SelectedIndices.Count</TT>) is stored to an Integer variable called <TT>intItemsNum</TT>. A 1 is subtracted off the figure because the collections in .NET are zero based.</P>
<P>Next, the code iterates through the <TT>Items</TT> collection of the lstUnSelected list box, testing the Selected property for selected items. The <TT>Value</TT> property of the item is converted to a string and added to a string variable called strItems. <TT>strItems</TT> is then used to create the criteria for an <TT>IN</TT> clause of a SQL <TT>Update</TT> statement, which is passed to the <TT>Command</TT> object called <TT>ocmdSelect</TT>. This <TT>Command</TT> object is executed, and the selected products are updated to reflect the category chosen. Last, both the list boxes are reloaded to reflect the changes.</P>
<H5 class="docExampleTitle">Listing 8.30 <TT>wfrmHowTo8_5.aspx</TT>: Updating the Server with Products That Are Selected for the Given Category</H5>
<PRE>
Private Sub btnSelect_Click(ByVal sender As System.Object,
                           ByVal e As System.EventArgs) Handles btnSelect.Click

        Dim intItemsNum As Integer
        Dim strItems As String
        Dim oCurr As Object

        '-- Iterate through each of the items in lstUnSelected
        '   and check the Selected property.
        '   If selected, store into a string with other selected product IDs.

        For Each oCurr In Me.lstUnSelected.Items

            If oCurr.Selected() = True Then

                If Len(strItems) &gt; 0 Then
                    strItems = strItems &amp; ", "
                End If
                strItems = strItems &amp; CType(oCurr.Value, String)

            End If

        Next

        '-- Run an update query to assign the category to the desired products,
        '   using an IN clause in the SQL statement.

        Try
            Dim ocnn As New OleDb.OleDbConnection(BuildCnnStr("(local)", _
                          "Northwind"))
            Dim ocmdSelect As New _
                       OleDb.OleDbCommand("Update Products Set CategoryID = " &amp;
                       Me.ddCategories.SelectedItem.Value &amp; _
" Where ProductID IN (" &amp; strItems &amp; ")", ocnn)

            ocmdSelect.CommandType = CommandType.Text
            ocnn.Open()
            ocmdSelect.ExecuteNonQuery()

        Catch excpCommand As Exception

        End Try

        LoadUnSelectedProducts()
        LoadSelectedProducts()

End Sub
</PRE></span></LI><LI><span style="font-weight:normal" value="9"><P>Add the code in Listing 8.31 to the <TT>Click</TT> event of the btnUnSelect command button. Again, this code is similar to the previous step, but it is used to set the CategoryID column to null if the product was highlighted in the lstSelected list box and btnUnSelect was clicked.</P>
<H5 class="docExampleTitle">Listing 8.31 <TT>frmHowTo8_5.aspx</TT>: Updating the Server with Products That Are Unselected for the Given Category</H5>
<PRE>
Private Sub btnUnSelect_Click(ByVal sender As System.Object,
                        ByVal e As System.EventArgs) Handles btnUnSelect.Click

        Dim intItemsNum As Integer
        Dim strItems As String
        Dim oCurr As Object

        '-- Iterate through each of the items in lstSelected
        '   and check the Selected property.
        '   If selected, store into a string with other selected product IDs.

        For Each oCurr In Me.lstSelected.Items

            If oCurr.Selected() = True Then

                If Len(strItems) &gt; 0 Then
                    strItems = strItems &amp; ", "
                End If

                strItems = strItems &amp; CType(oCurr.Value, String)

            End If

        Next

        Try

            Dim ocnn As New OleDb.OleDbConnection(BuildCnnStr("(local)", _
"Northwind"))
            Dim ocmdUnSelect As New _
              OleDb.OleDbCommand("Update Products Set CategoryID = Null " &amp; _\\
"Where ProductID IN (" &amp; _
                    strItems &amp; ")", ocnn)

            ocmdUnSelect.CommandType = CommandType.Text
            ocnn.Open()
            ocmdUnSelect.ExecuteNonQuery()

        Catch excpCommand As Exception
        End Try

        LoadUnSelectedProducts()
        LoadSelectedProducts()

End Sub
</PRE></span></LI></OL></span>
<H4 class="docSection2Title"> How It Works</H4>
<P>When the user chooses a category, the appropriate items are loaded into the two list boxes. Unselected items are in the list box on the left, and the selected items are in the list box on the right.</P>
<P>If the check box is selected, then those only those items that are not currently assigned to categories are displayed in the list box on the left, which is titled Unselected Products.</P>
<P>When the btnSelect button is clicked, any items that are highlighted in the lstUnSelected list box are used in a query that updates the server with the new category they now belong to. Similarly, when the btnUnSelect is clicked, items that are listed in the lstSelected list box are used in a query that updates the CategoryID of the products to null.</P>
<H4 class="docSection2Title"> Comments</H4>
<P>As mentioned in How-To 8.1, this example is not the smartest to create in real life because you want products to be assigned to a category. However, this example does a good job of showing the properties and methods you can use to work with the multi-select features of the ListBox control.</P>
<ul></ul>
</body></html>
