<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="5.2 Validate Data Using Validation Controls"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">5.2 Validate Data Using Validation Controls</H3>
<P>I want to be able to validate various types of data entry without having to wait for an error to come back from the server. Can I validate my data on my Web Form?</P>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>A note of caution: Through the writing and tech editing of this chapter, there have been some inconsistencies noted in the reaction of some of the validator controls. The tech editor and I both contend that this area might have some .NET bugs. This is also the reason for the lack of coverage in the <TT>CustomValidator</TT>.</P>
</td>
</tr></table></p>
</div><br>
<H4 class="docSection2Title"> Technique</H4>
<P>One new feature found in ASP.NET is the inclusion of Validation Web server controls. These validation controls allow you to specify other controls of which you want to validate based on data entered into the controls. You can then do the following:</P>
<UL>
<LI><P>Have the Validation control display an error message.</P></LI>
<LI><P>Test at a page level to see if all controls that are being validated are valid.</P></LI>
<LI><P>Display a list of error messages for all the controls that are being validated.</P></LI>
</UL>
<H5 class="docSection3Title"> Available Validation Web Server Controls</H5>
<P>You will find the controls for validation in the toolbox, and can see them listed in Table 5.2, with a description of what they validate.</P>
<P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<CAPTION><h5 class="docTableTitle">Table 5.2. Validation Web Server Controls</h5></CAPTION><COLGROUP span="2">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Control</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Description</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>RequiredFieldValidator</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Validates whether the specified control has been left blank.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>CompareValidator</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Compares the values in two controls and validates whether they are equal.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>RangeValidator</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Checks to see if the value entered into a control falls within a range that is specified.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>RegularExpressionValidator</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Compares a value entered into a control to see if it matches an entered mask, such as 999-99-9999, which is the U.S. Social Security Number.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>CustomValidator</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Allows you to create custom functions on both the client and server side for validation.</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>ValidationSummary</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Used to consolidate the messages that all validation controls return on a page into a list-like format.</P>
</TD>
</TR>
</COLGROUP>
</TABLE></P>
<P>The main properties you will set on a validation control are <TT>FieldToValidate</TT> and <TT>ErrorMessage</TT>.</P>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>The <TT>CustomValidator</TT> control is different in that you will create functions to perform the validation. Other than these, the validation controls require no coding unless you want to validate the whole page.</P>
</td>
</tr></table></p>
</div><br>
<H5 class="docSection3Title"> Testing Page Validation in Code</H5>
<P>Depending on what is required, you can test for validation at the page level using the <TT>Page.Validate</TT> method. When you call this method, all the Validation controls are retested, and the <TT>Page.IsValid</TT> property is set. You can use the <TT>IsValid</TT> property in a condition statement to perform tasks based on the value of the <TT>IsValid</TT> property, as shown in the last step of this How-To.</P>
<H4 class="docSection2Title"> Steps</H4>
<P>Open and run the Visual Basic .NET-Chapter 5 solution. From the main page, click on the hyperlink with the caption How-To 5.2: Validate Data Using Validation Controls. When the Web Form loads, you will see a number of text boxes with instructions on how to see the various validation checks. Here is the Web Form in Design view (see Figure 5.2).</P>


<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1"><P>Create a Web Form. Then place the controls listed in Table 5.3 and shown in Figure 5.2 with the following properties set.</P>
<P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<CAPTION><h5 class="docTableTitle">Table 5.3. Control Property Settings for Validation Controls Web Form</h5></CAPTION><COLGROUP span="3">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Object</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Property</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Setting</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Required Field Validator Example (Leave Blank to Test)</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>ID</TT></PRE></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtRequiredExample</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Compare Validator Example (Enter Two Different Values in These Text Boxes)</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>ID</TT></PRE></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtCompareFirst</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>ID</TT></PRE></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtCompareSecond</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Range Validator Example (Enter a Number Outside the Range 1 and 10)</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>ID</TT></PRE></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtRangeExample</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Regular Expression Validator Example (Enter a SSN not matching 999-99-9999)</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>ID</TT></PRE></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtRegularExprExample</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Custom Validator Example (Enter a State Other Than WA or CA)</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>ID</TT></PRE></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtCustomExample</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Button</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>ID</TT></PRE></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>btnTestValidators</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Test Validators</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Page Validation Errors</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>RequiredFieldValidator Control</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>ToValidate</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtRequiredExample</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>ErrorMessage</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Here is the message for the Required Field Validator</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>CompareValidator</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>ControlToCompare</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtCompareFirst</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>ControlToValidate</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtCompareSecond</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>ErrorMessage</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Here is the message for the Compare Validator</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>RangeValidator</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>ControlToValidate</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtRangeExample</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>MaximumValue</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>10</TT></PRE></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>MinimumValue</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>1</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>ErrorMessage</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Here is the message for the Range Validator</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>RegularExpressionValidator</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>ControlToValidate</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtRegularExprExample</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>ValidationExpression</TT> </P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>\d{3}-\d{2}-\d{4}</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>ErrorMessage</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P>Here is the message for the Regular Expression Validator</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>ValidationSummary</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>HeaderText</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Error</TT> Summary List</P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>HyperLink</TT> </P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>ID</TT></PRE></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>hplReturnToMain</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>NavigateURL</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>wfrmMain.aspx</TT></P>
</TD>
</TR>
</COLGROUP>
</TABLE></P>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>For the <TT>ValidationExpression</TT> property of the <TT>RegularExpressionValidator</TT>, you will want to click the builder button beside the property and choose the SSN from the list of expressions.</P>
</td>
</tr></table></p>
</div></span></LI><LI><span style="font-weight:normal" value="2"><P>Add the code in Listing 5.4 to the Click event of <TT>btnTestValidator</TT>. You can see an example here of how you might use the Validate method for the page, and act based on when the IsValid property is set.</P>
<H5 class="docExampleTitle">Listing 5.4 <TT>wfrmHowTo5_2.aspx.vbs</TT> Testing to See If All Controls That the Validation Controls Handle Are Valid</H5>
<PRE>
Private Sub btnTestValidators_Click(ByVal sender As System.Object,
                ByVal e As System.EventArgs) Handles btnTestValidators.Click

        '-- Forces the Validation controls to validate
        Page.Validate()

        If Page.IsValid Then

            '-- Code if all controls are valid

        Else

            '-- Code if even one of the controls isn't valid

        End If

End Sub
</PRE></span></LI></OL></span>
<CENTER><H5 class="docFigureTitle">Figure 5.2. These controls aren't seen on your Web forms unless a validation error occurs.</H5><p><IMG BORDER="0" WIDTH="500" HEIGHT="375" src="FILES/05fig02.jpg" ALT="graphics/05fig02.jpg"></p>
</CENTER>
<H4 class="docSection2Title"> Comments</H4>
<P>You normally wouldn't have the <TT>ValidationSummary</TT> control on the same page if you were listing the individual error messages using the Validation controls. It is nice to be able to have all the errors show up in a list sometimes.</P>
<div class="docNote"><p class="docNoteTitle">Tip</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/tip_icon.gif" ALT="graphics/tip_icon.gif"></td>
<td valign="top"><P>You can affect the way the list looks in the ValidationSummary control by setting the DisplayMode property. You have the choice of using a list, a bulleted list, or a paragraph.</P>
<P>You can also display a message box instead of a list by setting the ShowMessageBox property to <TT>True</TT> and the ShowSummary property to <TT>False</TT>.</P>
</td>
</tr></table></p>
</div><br>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>You can display one message in the individual validation controls and another in the ValidationSummary control. The <TT>ErrorMessage</TT> property is reflected in the ValidationSummary list, whereas the <TT>Text</TT> property of the individual validation controls displays something different if it's set.</P>
</td>
</tr></table></p>
</div><br>
<img src="FILES/pixel.gif" width="1" height="1" border="0"><ul></ul>
</body></html>
