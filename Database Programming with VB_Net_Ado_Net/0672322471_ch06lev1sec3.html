<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="6.3 Use Wildcards and Ranges of Values in a SQL Query"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body><H3 class="docSection1Title">6.3 Use Wildcards and Ranges of Values in a SQL Query</H3>
<P>I need to be able to either search for a range of values, or at least be able to use wild cards with my query. How do I do this using T-SQL?</P>
<H4 class="docSection2Title"> Technique</H4>
<P>This is one of those fairly simple but necessary How-Tos. You will learn how to use a combination of both wild cards and a range of values. Here is the T-SQL routine that you will use for this How-To:</P>
<pre>
SELECT Customers.CompanyName, Orders.OrderID, Orders.OrderDate FROM Orders
INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID
WHERE Customers.CustomerID LIKE 'A%'
AND Orders.OrderDate BETWEEN '11/01/1996' AND '12/01/1996'
</pre>
<div class="docNote"><p class="docNoteTitle">Note</p>
<p><table border="0" align="center" cellpadding="6" cellspacing="0"><tr>
<td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="100" HEIGHT="100" src="FILES/note_icon.gif" ALT="graphics/note_icon.gif"></td>
<td valign="top"><P>The literal values have been used here, rather than the text box values that will be used in the How-To.</P>
</td>
</tr></table></p>
</div><br>
<H5 class="docSection3Title"> Using Wild Cards</H5>
<P>Fairly similar to the wild cards of the old DOS days, wild cards in T-SQL are fairly straightforward to use. It is just a matter of knowing which one to use for which task. When using wild cards, you will use the <TT>LIKE</TT> operator, as seen in the SQL string for this How-To.</P>
<P>You can see where the <TT>LIKE</TT> operator is used with <TT>A%</TT>. The <TT>%</TT> is used to specify anything after the given letter. In this case, it's used for anything starting with the letter <span class="docEmphasis">A</span>. (This operator will, of course, have to have the OrderDate fall between the dates specified, but we'll talk about this in a moment. You can use other wild cards as well, such as the following:</P>
<UL>
<LI><p>
<span class="docEmphRoman"><TT>%</TT> (Percent sign).</span> 
You use this to specify any given group of characters. If used before a letter or group of letters, you are then specifying that you want values ending with those letters. For instance, if you specify %ing, you get skiing, flying, and so on.</p>
</LI>
<LI><p>
<span class="docEmphRoman"><TT>_</TT> (Underscore).</span> 
You use this to specify a single character. For instance, if you type <TT>_ake</TT>, then you would get four-letters words, such as lake, bake, and sake.</p>
</LI>
<LI><p>
<span class="docEmphRoman"><TT>[]</TT> (Square brackets)</span> 
This is a range or group of characters to compare against. For example, if you type <TT>[B-D]ake</TT>, you would get bake and cake. Another way to use it, with a group of letters, would be to type <TT>[BF]ake</TT>. In this case, you would get bake and fake, but not the other letter that fall inbetween.</p>
</LI>
<LI><p>
<span class="docEmphRoman"><TT>[^]</TT> (Caret).</span> 
This is not within the given range or group. Opposite of the last entry, if you typed <TT>[^B-D]ake</TT>, you would get those words ending in ake, where the first letter doesn't fall within B-D. The same works for the group of letters as well.</p>
</LI>
</UL>
<H5 class="docSection3Title"> Using BETWEEN</H5>
<P>When you need to look at a range of values, whether it be numbers or dates, you use the BETWEEN operator. The syntax for BETWEEN is as follows:</P>
<pre>
table.column BETWEEN startingvalue AND endingvalue
</pre>
<P>This returns all records where the given column falls between the two values, including the two values. Because the <TT>BETWEEN</TT> statement mentioned a moment ago was Orders.OrderDate <TT>BETWEEN</TT> '11/01/1996' AND '12/01/1996', then those records with the OrderDate falling between 11/1/1996 and 12/1/1996 inclusively will be displayed.</P>
<H4 class="docSection2Title"> Steps</H4>
<P>Open and run the Visual Basic .NET-Chapter 6 solution. From the main form, click on the button with the caption How-To 6.3. When the form loads, you will see a form that allows you to specify letter(s) for the company name to fill the data grid for, along with a range to specify for order dates (see Figure 6.4).</P>




<span style="font-weight:bold"><OL class="docList" START="1">
<LI><span style="font-weight:normal" value="1"><P>Create a Windows Form. Then place the controls listed in Table 6.3 with the following properties set, as displayed in Figure 6.4.</P>
<P><TABLE BORDER="1" align="center" CELLPADDING="6" CELLSPACING="0">
<CAPTION><h5 class="docTableTitle">Table 6.3. Control Property Settings for This How-To</h5></CAPTION><COLGROUP span="3">
<TR>
<TH class="docTableHeader" align="left" valign="top">
<P>Object</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Property</P>
</TH>
<TH class="docTableHeader" align="left" valign="top">
<P>Setting</P>
</TH>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Customer ID</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtCustomerID</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>A%</TT></PRE></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Order Date: From</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><PRE><TT>To</TT></PRE></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtFromDate</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>11/01/1996</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>TextBox</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>txtToDate</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">&nbsp;</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>12/01/1996</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>SQL String</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>lblSQLString</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>Label</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Text</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Results</TT></P>
</TD>
</TR>
<TR>
<TD class="docTableCell" valign="top">
<P><TT>DataGrid</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>Name</TT></P>
</TD>
<TD class="docTableCell" valign="top">
<P><TT>dgResults</TT></P>
</TD>
</TR>
</COLGROUP>
</TABLE></P></span></LI><LI><span style="font-weight:normal" value="2"><P>Add the following code in Listing 6.6 to the Load event of the form. (Double-click on the form to bring up the code.)</P>
<H5 class="docExampleTitle">Listing 6.6 <TT>frmHowTo6_3.vb</TT>: Calling GenerateData When Loading the Form</H5>
<PRE>
Private Sub frmHowTo6_3_Load(ByVal sender As System.Object,
                    ByVal e As System.EventArgs) Handles MyBase.Load

        GenerateData()

    End Sub
</PRE></span></LI><LI><span style="font-weight:normal" value="3"><P>In the class module for the form, add the code in Listing 6.7 to create the <TT>GenerateData</TT> routine. After creating the SQL statement, this routine assigns it to the Text property of <TT>lblSQLString</TT>. Then the string is used in a data adapter that was created to fill the <TT>dtResults data table</TT>. Last, the data table is set as the data source for dgResults.</P>
<H5 class="docExampleTitle">Listing 6.7 <TT>frmHowTo6_3.vb</TT>: Generating Data Using LIKE and BETWEEN Statements</H5>
<PRE>
    Sub GenerateData()

        '-- Build the SQL String
        Dim strSQL As String

        strSQL &amp;= "SELECT Customers.CompanyName, " &amp; _
                  "Orders.OrderID, Orders.OrderDate "
        strSQL &amp;= "FROM Orders INNER JOIN Customers "
        strSQL &amp;= "ON Orders.CustomerID = Customers.CustomerID" &amp; vbCrLf
        strSQL &amp;= "WHERE Customers.CustomerID LIKE '" &amp; _
                  Me.txtCustomerID.Text &amp; "' AND "
        strSQL &amp;= "Orders.OrderDate BETWEEN '" &amp; Me.txtFromDate.Text
        strSQL &amp;= "' AND '" &amp; Me.txtToDate.Text &amp; "'"

        '-- Store the SQL String
        Me.lblSQLString.Text = strSQL

        '-- Use the SQL String to build the data adapter and fill the data table.
        Dim odaResults As New OleDb.OleDbDataAdapter(Me.lblSQLString.Text,
                                  BuildCnnStr("(local)", "Northwind"))
        Dim dtResults As New DataTable()

        Try
            odaResults.Fill(dtResults)
        Catch excp As Exception
            MessageBox.Show(excp.Message)
            Exit Sub
        End Try

        '-- Assign the data table to the data grid's DataSource property
        Me.dgResults.DataSource = dtResults

End Sub
</PRE></span></LI><LI><span style="font-weight:normal" value="2"><P>Add the code in Listing 6.8 to the <TT>TextChanged</TT> events of txtCustomerID, txtFromDate, and txtToDate, respectively. These routines call GenerateDate when the values change.</P>
<H5 class="docExampleTitle">Listing 6.8 <TT>frmHowTo6_3.vb</TT>: Calling the GenerateData Routine When Text Is Updated</H5>
<PRE>
Private Sub txtCustomerID_TextChanged(ByVal sender As System.Object,
        ByVal e As System.EventArgs) Handles txtCustomerID.TextChanged
    GenerateData()
End Sub

Private Sub txtFromDate_TextChanged(ByVal sender As System.Object,
        ByVal e As System.EventArgs) Handles txtFromDate.TextChanged
    GenerateData()
End Sub

Private Sub txtToDate_TextChanged(ByVal sender As System.Object,
        ByVal e As System.EventArgs) Handles txtToDate.TextChanged
    GenerateData()
End Sub
</PRE></span></LI></OL></span>
<CENTER><H5 class="docFigureTitle">Figure 6.4. A common problem with inner joins is retrieving multiple records when you just want to see one per occurrence.</H5><p><IMG BORDER="0" WIDTH="496" HEIGHT="368" src="FILES/06fig04.jpg" ALT="graphics/06fig04.jpg"></p>
</CENTER>
<H4 class="docSection2Title"> Comments</H4>
<P>By placing your use of wild cards and allowing for ranges of values, you can make your applications and the querying of data more versatile than ever!</P>
<ul></ul>
</body></html>
