<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Services, Interfaces, and Object Identity</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H3>Services, Interfaces, and Object Identity</H3><P><B>QueryService </B>identifies an object that supports the requested service, with the returned pointer already set to the specified interface.  </P>
<P>It's important to keep in mind the following:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Some of the interfaces in the service may be optional. The returned object may not support every interface defined in the service description.</LI><LI CLASS="ULI1">The returned object may have additional interfaces that are not part of the definition of the service. </LI><LI CLASS="ULI1">Two services may be implemented on the same object. As a result, passing different SIDs to <B>QueryService</B> does not necessarily mean that you'll receive different objects in return.</LI><LI CLASS="ULI1">An interface with the same name and IID may be part of two different services.</LI></UL></SPAN><P></P>
<P>Two different services (SID_SIdaho and SID_SMontana, for example) can both specify the use of a single interface (for example, <B>IDispatch</B>), even though the implementation of the interface may have nothing in common between the two services. This works because the following two hypothetical calls can return different objects:</P>

<PRE><FONT FACE="COURIER, COURIER NEW" SIZE="2">hr = QueryService (SID_SMontana, IID_IDispatch, &amp;pDisp) 
hr = QueryService (SID_SIdaho, IID_IDispatch, &amp;pDisp)
</font></pre>
<P>Remember that object identity is not assumed if you ask for a different service identifier.</P></FONT>
</BODY>
</HTML>
