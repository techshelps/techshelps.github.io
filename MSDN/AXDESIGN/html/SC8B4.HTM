<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IServiceProvider::QueryService</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H3>IServiceProvider::QueryService</H3><P>Returns an interface that is part of a requested service.</P>
<P><B>HRESULT QueryService(</B><BR><B>    REFGUID </B><I>rsid</I>,<BR>    <B>REFIID </B> <I>iid</I>,<BR><B>    VOID ** </B><I>ppvObj</I><BR><B>)</B>;</P>
<P><B>Parameters</B></P>
<P><I>rsid</I></P>
<P>[in] Pointer to a service identifier (SID).</P>
<P><I>iid</I></P>
<P>[in] Identifier of the interface the caller needs to gain access to.</P>
<P><I>ppvObj</I></P>
<P>[out] Indirect pointer to the requested interface.</P>
<P></P>
<P><B>Return Values</B></P>
<P>The return value obtained from the returned HRESULT is one of the following:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="150pt" VALIGN="TOP"><COL WIDTH="198pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Return Value</B></P></TD><TD VALIGN="TOP"><P><B>Meaning</B></P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>S_OK</P></TD><TD VALIGN="TOP"><P>Success.</P></TD></TR><TR><TD VALIGN="TOP"><P>E_INVALIDARG</P></TD><TD VALIGN="TOP"><P>One or more of the arguments is invalid.</P></TD></TR><TR><TD VALIGN="TOP"><P>E_NOINTERFACE</P></TD><TD VALIGN="TOP"><P>The requested interface is not part of this service, or the service is unknown.</P></TD></TR><TR><TD VALIGN="TOP"><P>E_OUTOFMEMORY</P></TD><TD VALIGN="TOP"><P>Out of memory.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><B>Comments</B></P>
<P><B>QueryService</B> returns an indirect pointer to the requested interface in the specified service. The caller is responsible for releasing this pointer when it is no longer needed.</P>
<P><B>QueryService</B> is similar to the <B>QueryInterface </B>method of <B>IUnknown</B>.  The key difference is that <B>QueryInterface</B> on an object returns an interface on the same object, whereas <B>QueryService</B> makes no such guarantee. <B>QueryService</B> on an object may return an interface on the same object or on a different object.</P>
<P>When you call <B>QueryService</B>, you pass both a service identifier (<I>rsid</I>) and an interface identifier (<I>iid</I>).  The <I>rsid</I> specifies the service to which you want access, and the <I>iid</I> identifies an interface that is part of the service.  In return, you receive an indirect pointer to the interface. </P>
<P>The object that implements the interface may also implement interfaces that are part of other services. Keep in mind the following:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Some of these interfaces may be optional. Not all the interfaces defined in the service description are necessarily present on every implementation of the service (or on every returned object).</LI><LI CLASS="ULI1">Unlike calls to <B>QueryInterface</B>, passing a different service identifier does not necessarily mean that a different COM object will be returned.</LI><LI CLASS="ULI1">The returned object may have additional interfaces that are not part of the definition of the service. </LI></UL></SPAN><P></P>
<P>Two different services (SID_SMyService and SID_SYourService, for example) can both specify the use of the same interface, even though the implementation of the interface may have nothing in common between the two services.  This works because a call to <B>QueryService</B> (SID_SMyService, IID_IDispatch) can return a different object than <B>QueryService</B> (SID_SYourService, IID_IDispatch).  Remember that object identity is not assumed when you specify a different service identifier.</P>
<P><B>Example</B></P>
<P>The following example requests the <B>ITrackSelection</B> interface, which is part of the <B>STrackSelection</B> service:</P>

<PRE><FONT FACE="COURIER, COURIER NEW" SIZE="2">hr = QueryService (SID_STrackSelection, IID_ITrackSelection, &amp;pITS);
</font></pre>
<P>For additional information, see Chapter 6, "<A class="normal" href="SC840.HTM">Services</A>."</P>
<P><B></B></P>
<P></P>
<P></P>
<P></P>
<P></P></FONT>
</BODY>
</HTML>
