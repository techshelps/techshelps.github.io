<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IActiveDesigner::GetExtensibilityObject</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H3>IActiveDesigner::GetExtensibilityObject</H3><P>Returns the extensibility object for the ActiveX designer. </P>
<P><B>HRESULT GetExtensibilityObject(</B><BR><B>    IDispatch **</B><I>ppvObjOut<BR></I><B>);</B></P>
<P><B>Parameter</B></P>
<P><I>ppvObjOut</I></P>
<P>[out] Pointer to an <B>IDispatch</B> interface. </P>
<P></P>
<P></P>
<P><B>Return Values</B></P>
<P>The return value obtained from the returned HRESULT is one of the following:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="150pt" VALIGN="TOP"><COL WIDTH="198pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Return Value</B></P></TD><TD VALIGN="TOP"><P><B>Meaning</B></P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>S_OK</P></TD><TD VALIGN="TOP"><P>Success.</P></TD></TR><TR><TD VALIGN="TOP"><P>E_FAIL</P></TD><TD VALIGN="TOP"><P>The method failed for an unknown reason.</P></TD></TR><TR><TD VALIGN="TOP"><P>E_NOTIMPL</P></TD><TD VALIGN="TOP"><P>The run-time and design-time objects are the same, or the designer does not support programmatic manipulation.</P></TD></TR><TR><TD VALIGN="TOP"><P>E_OUTOFMEMORY</P></TD><TD VALIGN="TOP"><P>Not enough memory to complete the operation.</P></TD></TR><TR><TD VALIGN="TOP"><P>E_POINTER</P></TD><TD VALIGN="TOP"><P>The <I>ppvObjOut</I> parameter is not a valid pointer.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><B>Comments</B></P>
<P>If the ActiveX designer can be programmatically manipulated, its<B> IDispatch</B> interface is available in two ways. If the visual designer implements <B>IActiveDesigner</B>, the <B>IDispatch</B> interface is available through <B>GetExtensibilityObject</B>. If the visual designer does not implement <B>IActiveDesigner</B>, objects must call <B>QueryInterface </B>to get the <B>IDispatch</B> interface.</P>
<P>In Visual Basic 5.0, the extensibility object for the visual designer is available to add-ins (servers that extend the integrated development environment (IDE)) through the extensibility object of the IDE. </P>
<P>You may implement this method without implementing the other methods of the interface. </P>
<P><B>Example</B></P>
<P>The following example creates a new extensibility object and returns its address to the caller:</P>

<PRE><FONT FACE="COURIER, COURIER NEW" SIZE="2">STDMETHODIMP CMyDesigner::GetExtensibilityObject
(
    IDispatch **ppExtensibilityObject
)
{
    if (!ppExtensibilityObject) return E_POINTER;

    *ppExtensibilityObject = new CMyAddInTopLevelAutomationObject;
    return (*ppExtensibilityObject) ? S_OK : E_OUTOFMEMORY;
}
</font></pre>
<P></P></FONT>
</BODY>
</HTML>
