<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Service Definitions</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H2>Service Definitions</H2><P>Services useful for ActiveX designers are defined in the Designer.h header file provided by Microsoft. The following code, taken from Designer.h, defines the <B>SCodeNavigate</B> service, which allows an extended object to display the code module attached to it.</P>

<PRE><FONT FACE="COURIER, COURIER NEW" SIZE="2">// { 6d5140c4-7436-11ce-8034-00aa006009fa }
DEFINE_GUID(IID_ICodeNavigate, 0x6d5140c4, 0x7436, 0x11ce, 0x80, 0x34, 
0x00, 0xaa, 0x00, 0x60, 0x09, 0xfa);
#define SID_SCodeNavigate IID_ICodeNavigate

#undef  INTERFACE
#define INTERFACE  ICodeNavigate
DECLARE_INTERFACE_(ICodeNavigate, IUnknown)
{
    BEGIN_INTERFACE
    // *** IUnknown methods ***
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID FAR* ppvObj) 
            PURE;
    STDMETHOD_(ULONG, AddRef)(THIS) PURE;
    STDMETHOD_(ULONG, Release)(THIS) PURE;

    // *** ICodeNavigate methods ***
    STDMETHOD(DisplayDefaultEventHandler)(
                        THIS_ /* [in] */ LPCOLESTR lpstrObjectName
                        ) PURE;
};
</font></pre>
<P>Every service is associated with an SID. Components that need to use a service pass the SID to <B>IServiceProvider::QueryService</B>. In the example, the SID for <B>SCodeNavigate</B> is SID_SCodeNavigate. Often, the SID is the same as the IID for one of the interfaces that belongs to the service. Here, SID_SCodeNavigate is defined to equal IID_ICodeNavigate. </P>
<P>The service includes the standard <B>IUnknown</B> interface and one or more additional interfaces. In the example, only one additional interface, <B>ICodeNavigate</B>, is defined. This interface contains one method, <B>DisplayDefaultEventHandler</B>. </P></FONT>
</BODY>
</HTML>
