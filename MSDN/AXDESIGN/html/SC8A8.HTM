<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Implementing the Licensing Interfaces</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H3>Implementing the Licensing Interfaces</H3><P>To support licensing, your ActiveX designer needs to implement the <B>IClassFactory2 </B>interface, which derives from <B>IClassFactory</B>. The interface includes three methods for licensing:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1"><B>GetLicInfo</B></LI><LI CLASS="ULI1"><B>RequestLicKey</B></LI><LI CLASS="ULI1"><B>CreateInstanceLic</B></LI></UL></SPAN><P>The interface is defined in the header file Olectl.h It uses the <B>LICINFO</B> structure, which includes the following fields:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="108pt" VALIGN="TOP"><COL WIDTH="120pt" VALIGN="TOP"><COL WIDTH="120pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Field</B></P></TD><TD VALIGN="TOP"><P><B>Type</B></P></TD><TD VALIGN="TOP"><P><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P><B></B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>cbLicInfo</I></P></TD><TD VALIGN="TOP"><P><B>long</B></P></TD><TD VALIGN="TOP"><P>Size of <B>LICINFO</B> structure.</P></TD></TR><TR><TD VALIGN="TOP"><P><I>FRuntimeKeyAvail</I></P></TD><TD VALIGN="TOP"><P><B>BOOL</B></P></TD><TD VALIGN="TOP"><P>True if the class provides a run-time key.</P></TD></TR><TR><TD VALIGN="TOP"><P><I>FLicVerified</I></P></TD><TD VALIGN="TOP"><P><B>BOOL</B></P></TD><TD VALIGN="TOP"><P>True if the license has been verified.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>The structure provides information about the licensing key. The first member, <I>cbLicInfo</I>, gives the size of the structure. The <I>fRuntimeKeyAvail</I> member is a Boolean that is True if the class provides a run-time key that can be built into an application. </P>
<P>The Boolean <I>fLicVerified</I> flag is set to True when the ActiveX designer has verified that it is licensed for this machine. If the designer can determine that a valid license is present before it receives a key, it sets this flag. If the current user or machine license is supposed to override the application license corresponding to a key, the designer can use <I>fLicVerified</I> to avoid passing the key unnecessarily.</P>
<P>To provide maximum flexibility, license keys are defined as <B>BSTR</B>, which can be any length and can include Null characters. </P></FONT>
</BODY>
</HTML>
