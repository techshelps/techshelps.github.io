<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Handling Design-Time Changes</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H3>Handling Design-Time Changes</H3><P>At design time, an end user can add properties and methods to an ActiveX designer or remove them from the designer. When this occurs, your code has to change the existing type information and lay out the new type information.</P>
<P>The action you have to take depends on the kind of object you're working with. When you change the type information for a VTBL interface, you treat properties and methods as functions. Use the <B>AddFuncDesc</B> method of the <B>ICreateTypeInfo</B> interface to add a property or method, and <B>DeleteFuncDesc</B> (or <B>DeleteFuncDescByMemId</B>) in the <B>ICreateTypeInfo2</B> interface to remove a property or method.</P>
<P>When you change the type information for a dispatch interface, you treat properties as variables and methods as functions. To add and remove properties, you use the <B>AddVarDesc</B> and <B>DeleteVarDesc</B> (or <B>DeleteVarDescByMemId</B>) methods. To add and remove methods you use the <B>AddFuncDesc</B> and <B>DeleteFuncDesc</B> (or <B>DeleteFuncDescByMemId</B>) methods. </P>
<P>Afterwards, you call <B>ITypeInfo::LayOut</B>, which assigns a dispatch identifier (DISPID) and a VTBL offset to the new subobject. A brief discussion of these methods follows; refer to the&nbsp;<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"
	width=0 height=0 hspace=0>
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_oa96_introduction">
</object><a href=JavaScript:alink_1.Click()>Automation Programmer's Reference</A> for complete details.</P>
<P>Whenever your code adds or deletes a function or variable descriptor, Automation triggers an <B>ITypeChangeEvents </B>notification to the host. This notification makes the host aware that it should call the ActiveX designer's<B> GetDynamicClassInfo</B> method to get the new type information. </P></FONT>
</BODY>
</HTML>
