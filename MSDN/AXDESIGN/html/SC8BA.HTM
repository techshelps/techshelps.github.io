<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ISelectionContainer::SelectObjects</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H3>ISelectionContainer::SelectObjects</H3><P>Selects a single object from a group of objects.</P>
<P><B>HRESULT</B> <B>SelectObjects(</B><BR>    <B>ULONG</B> <I>cSelect</I>,<I><BR></I>    <B>IUnknown</B> ** <I>apUnkSelec</I>t,<I><BR></I><B>    DWORD</B> <I>dwFlags<BR></I><B>);</B></P>
<P><B>Parameters</B></P>
<P><I>cSelect</I></P>
<P>[in] Index into the array of objects returned by <B>ISelectionContainer::GetObjects</B>.</P>
<P><I>apUnkSelect</I></P>
<P>[in] Pointer to the selected object.</P>
<P><I>dwFlags</I></P>
<P>[in] Flags modifying the selection. Set to SELOBJS_ACTIVATEWINDOW to activate the window that displays the selected objects.</P>
<P></P>
<P><B>Return Values</B></P>
<P>The return value obtained from HRESULT is one of the following:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="150pt" VALIGN="TOP"><COL WIDTH="198pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Return Value</B></P></TD><TD VALIGN="TOP"><P><B>Meaning</B></P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>S_OK</P></TD><TD VALIGN="TOP"><P>Success.</P></TD></TR><TR><TD VALIGN="TOP"><P>E_INVALIDARG</P></TD><TD VALIGN="TOP"><P>One or more of the arguments is invalid.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><B>Comments</B></P>
<P>The ActiveX designer implements this method.</P>
<P>The <B>GetObjects</B> method returns either all selectable objects or all selected objects, depending on the flags passed. The <B>SelectObjects </B>method allows any of these objects to be selected.</P>
<P>Because the returned objects support <B>IDispatch</B>, the host can obtain information directly from them. For example, to get the name of an object, the host can call <B>IDispatch::Invoke</B> (or <B>ITypeInfo::Invoke</B>) with a predefined DISPID that signifies the name. The predeclared DISPIDs are negative to ensure that they don't conflict with user-defined identifiers. The table that follows describes some of this information and how it is obtained. These DISPIDs are defined in the header file Typelib2.h. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="157pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Item</B></P></TD><TD VALIGN="TOP"><P><B>How it is Obtained</B></P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>The name of the object.</P></TD><TD VALIGN="TOP"><P>DISPID_NAME</P></TD></TR><TR><TD VALIGN="TOP"><P>The index of the object.</P></TD><TD VALIGN="TOP"><P>DISPID_OBJECT</P></TD></TR><TR><TD VALIGN="TOP"><P>The type of the object.</P></TD><TD VALIGN="TOP"><P>IProvideClassInfo::QueryInterface</P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><B>Example</B></P>
<P>The following example implements <B>SelectObjects</B> using the array returned by <B>GetObjects</B>.</P>

<PRE><FONT FACE="COURIER, COURIER NEW" SIZE="2">STDMETHODIMP CMySelectionContainer::SelectObjects
(
    ULONG cSelect,   
    IUnknown **apUnkSelect, 
    DWORD dwFlags
)
{
    // Select the first thing given.
    int index = -1;
    if (cSelect &gt; 0) {
        // See what the selected object is. Default is the main
        // object.
        for (int i = 0; i &lt; MAXOBJECTS; i++) {
                if (m_state.rgObjects[i].bHaveIt &amp;&amp; 
                apUnkSelect[0] == m_state.rgObjects[i].pObject) {
                index = i;
            break;
            }
    }
    
    MaybeSelectionChanged(index, FALSE);
    }
    return S_OK;
}</font></pre>
<P>Although calling MaybeSelectionChanged results in a call to the host's <B>ITrackSelection </B>mechanism, it's necessary because the host has to display the main control window differently (with stretch bars) if its selection is selected, which is always the case.</P>
<P></P></FONT>
</BODY>
</HTML>
