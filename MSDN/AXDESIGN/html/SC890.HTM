<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How the Host Obtains Type Information</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H3>How the Host Obtains Type Information</H3><P>When the end user inserts an ActiveX designer into the host environment, the host takes the following steps to create an instance of the visual designer and obtain type information:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Calls <B>CoCreateInstance</B> to create an instance of the visual designer.</LI><LI CLASS="ULI1">Calls <B>QueryInterface</B> on the created instance to find its persistence interface.</LI><LI CLASS="ULI1">Calls the <B>InitNew</B> or <B>Load</B> method of the persistence interface, as appropriate, to load the persistent state of the visual designer.</LI><LI CLASS="ULI1">Calls the <B>GetDynamicClassInfo</B> method of the <B>IProvideDynamicClassInfo</B> interface to get the visual designer's type information. If this interface is not implemented, the host calls the <B>GetClassInfo</B> method of the <B>IProvideClassInfo</B> interface. </LI><LI CLASS="ULI1">Calls <B>InPlaceActivate</B> to activate the created instance.</LI></UL></SPAN><P>If the type information changes dynamically, the host is notified via <B>ITypeChangeEvents</B>, triggered by Automation. It can then call <B>GetDynamicClassInfo</B> to retrieve the new information for property browsers, event handlers, and other features that require up-to-date type information. </P></FONT>
</BODY>
</HTML>
