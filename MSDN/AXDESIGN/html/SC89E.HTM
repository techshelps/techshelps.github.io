<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Differences between QueryService and QueryInterface</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<H3>Differences between QueryService and QueryInterface</H3><P>Although it might seem logical to call <B>QueryInterface</B> to find the interface you want to use, services are a more efficient means of getting the same capabilities. </P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">When related interfaces are grouped into a service, a single call to <B>IServiceProvider</B> returns a pointer to the requested interface, regardless of the object it's implemented on.</LI><LI CLASS="ULI1">The container need not delegate calls to individual interfaces, as is done with <B>QueryInterface</B>. Instead, the ActiveX designer can invoke them directly.</LI><LI CLASS="ULI1">The interfaces need not be implemented by the object that is queried; they may be implemented as part of any object that the container is aware of.</LI></UL></SPAN><P>The key difference between the <B>QueryService</B> and <B>QueryInterface</B> methods is that <B>QueryInterface</B> on an object returns an interface on the same object, whereas <B>QueryService</B> makes no such guarantee. <B>QueryService</B> on an object may return an interface on the same object or on a different object.</P>
<P>Because services need not be implemented on the site object, calling <B>QueryInterface</B> on the site to look for interfaces in a service is not guaranteed to succeed. </P>
<P>In addition, calling <B>QueryInterface </B>on an object you receive from <B>QueryService</B> is valid only for interfaces that are part of the service. Querying for any other interfaces results in an error status.</P></FONT>
</BODY>
</HTML>
