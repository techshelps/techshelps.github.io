<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetVersionEx</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_getversionex"></a>GetVersionEx</h1>
<p>
The <b>GetVersionEx</b> function obtains extended information about the version of the operating system that is currently running.</p>
<pre><code><b>BOOL GetVersionEx(
  LPOSVERSIONINFO</b><i> lpVersionInformation</i>   // pointer to version 
                                         // information structure
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpVersionInformation</i></dt>
<dd>
Pointer to an <a href="sysinfo_3a0i.htm"><b>OSVERSIONINFO</b></a> data structure that the function fills with operating system version information.
<p>
Before calling the <b>GetVersionEx</b> function, set the <b>dwOSVersionInfoSize</b> member of the <b>OSVERSIONINFO</b> data structure to <code>sizeof<b>(OSVERSIONINFO)</b></code>.

<p>
<b>Windows NT 5.0 and later:</b> This member can be a pointer to an <a href="sysinfo_1o1e.htm"><b>OSVERSIONINFOEX</b></a> structure. Set the <b>dwOSVersionInfoSize</b> member to <code>sizeof<b>(OSVERSIONINFOEX)</b></code> to identify the type of structure.

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. The function fails if you specify an invalid value for the <b>dwOSVersionInfoSize</b> member of the <a href="sysinfo_3a0i.htm"><b>OSVERSIONINFO</b></a> or <a href="sysinfo_1o1e.htm"><b>OSVERSIONINFOEX</b></a> structure. </p>
<h4>Remarks</h4>
<p>
When using the <b>GetVersionEx</b> function to determine whether your application is running on a particular version of the operating system, check for version numbers that are greater than or equal to the desired version numbers. This ensures that the test succeeds for later versions of the operating system. For example, if your application requires Windows 98, use the following test:</p>
<pre><code>GetVersionEx (&amp;osvi);
bIsWindows98orLater = 
   (osvi.dwPlatformId == VER_PLATFORM_WIN32_WINDOWS) &amp;&amp;
   ( (osvi.dwMajorVersion &gt; 4) ||
   ( (osvi.dwMajorVersion == 4) &amp;&amp; (osvi.dwMinorVersion &gt; 0) ) );
 </code></pre>
<p>
Identifying the current operating system is usually not the best way to determine whether a particular operating system feature is present. This is because the operating system may have had new features added in a redistributable DLL. Rather than using <b>GetVersionEx</b> to determine the operating system platform or version number, test for the presence of the feature itself.</p>
<p>
To determine the best way to test for a feature, refer to the documentation for the feature of interest. The following list discusses some common techniques for feature detection: 
<ul>
<li>
You can test for the presence of the functions associated with a feature. To test for the presence of a function in a system DLL, call the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_loadlibrary">
</object><a href=JavaScript:alink_2.Click()><b>LoadLibrary</b></a> function to load the DLL. Then call the <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getprocaddress">
</object><a href=JavaScript:alink_3.Click()><b>GetProcAddress</b></a> function to determine whether the function of interest is present in the DLL. Use the pointer returned by <b>GetProcAddress</b> to call the function. Note that even if the function is present, it may be a stub that just returns an error code such as ERROR_CALL_NOT_IMPLEMENTED.</li>
<li>
You can determine the presence of some features by using the <a href="sysinfo_8fjn.htm"><b>GetSystemMetrics</b></a> function. For example, you can detect multiple display monitors by calling <b>GetSystemMetrics</b>(SM_CMONITORS).</li>
<li>
There are several versions of the redistributable DLLs that implement shell and common control features. For information about determining which versions are present on the system your application is running on, see the topic <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_shell_versions">
</object><a href=JavaScript:alink_4.Click()>Shell Versions</a>.  </li>
</ul>
<p>
<b>Windows CE:</b> The value of the <b>dwPlatformID</b> member of the <b>OSVERSIONINFO</b> structure will be VER_PLATFORM_WIN32_CE.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.5 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="sysinfo_2jam.htm">System Information Overview</a>, <a href="sysinfo_8stv.htm">System Information Functions</a>, <a href="sysinfo_3a0i.htm"><b>OSVERSIONINFO</b></a>, <a href="sysinfo_1o1e.htm"><b>OSVERSIONINFOEX</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
