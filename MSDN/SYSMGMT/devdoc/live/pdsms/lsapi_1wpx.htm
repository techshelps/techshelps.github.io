<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LSUpdate</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_lsupdate"></a>LSUpdate</h1>
<p>
<b>Notice:</b>This is preliminary documentation for technology that will be supported in future releases of Microsoft Windows.</p>
<p>
The <b>LSUpdate</b> function updates the synchronization between the licensed application software and the license system. </p>
<pre><code><b>LS_STATUS_CODE LS_API_ENTRY LSUpdate(
  LS_HANDLE</b><i> LicenseHandle</i><b>,    </b>// handle to the license context
<b>  LS_ULONG</b><i> TotUnitsConsumed</i><b>,  </b>// units consumed in this handle 
                              // context
<b>  LS_ULONG</b><i> TotUnitsReserved</i><b>,  </b>// units required to run the 
                              // application
<b>  LS_STR</b><i> *LogComment</i><b>,         </b>// pointer to optional comment 
                              // associated with the request
<b>  LS_CHALLENGE</b><i> *Challenge</i><b>,    </b>// pointer to a challenge structure
<b>  LS_ULONG</b><i> *TotUnitsGranted   </i>// pointer to total number of units 
                              // granted
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>LicenseHandle</i></dt>
<dd>
[in] Specifies the handle to the license context. This parameter must be a handle created with the <a href="lsapi_36lw.htm"><b>LSRequest</b></a><b> </b>function. </dd>
<dt>
<i>TotUnitsConsumed</i></dt>
<dd>
[in] Specifies the total number of units consumed in this handle context since the initial call to the <b>LSRequest</b> function. You can specify this license policy attribute within the application. A value of LS_DEFAULT_UNITS indicates that the license system should determine the appropriate value using its own license policy mechanisms. If an error is returned, no units are consumed. 
<p>
If the <i>TotUnitsConsumed</i> exceeds the number of units reserved, the error LS_INSUFFICIENT_UNITS is returned and the remaining units are consumed. 
</dd>
<dt>
<i>TotUnitsReserved</i></dt>
<dd>
[in] Specifies the total number of units to be reserved. If no additional units are required since the initial call to the <b>LSRequest</b> function or the last call to the <b>LSUpdate </b>function, then this parameter should be the current total returned in the <i>TotUnitsGranted </i>parameter. The total reserved includes the units consumed. That is, if an application requests 100 units, and then consumes 20 units, there are still 100 units reserved but only 80 available for consumption. 
<p>
If additional units are required, the application must calculate a new total for <i>TotUnitsReserved</i>. You can specify the constant LS_DEFAULT_UNITS, but this does not allocate any additional units. 

<p>
The license system verifies that the requested number of units exist, and it may reserve those units, but these units are not consumed at this time. This value may be smaller than the original number requested by <b>LSRequest</b> to indicate that fewer units are needed than originally anticipated. 
</dd>
<dt>
<i>LogComment</i></dt>
<dd>
[in] Points to an optional string indicating a comment that the license system will associate with the request. The license system can log the comment if logging is supported and enabled. If an error is returned, the license system can log both the error and the comment, but this is not guaranteed. If you do not specify a string, the value must be LS_NULL. </dd>
<dt>
<i>Challenge</i></dt>
<dd>
[in/out] Points to a challenge structure. The challenge response will also be returned in this structure. </dd>
<dt>
<i>TotUnitsGranted</i></dt>
<dd>
[out] Points to an LS_ULONG value that returns the total number of units granted since the initial license request. The following table describes the <i>TotUnitsGranted</i> return value, given the <i>TotUnitsReserved</i> parameter input value, and the status code returned:
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=35%></td>
<td width=65%><b><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TotUnitsReserved</i></b></td>
</tr>
<tr valign=top>
<td width=35%><b>Status code returned</b></td>
<td width=65%><b>LS_DEFAULT_UNITS&nbsp;&nbsp;&nbsp;Other&nbsp;(specific&nbsp;count)</b></td>
</tr>
<tr valign=top>
<td width=35%>LS_SUCCESS</td>
<td width=65%>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(A)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(C)</td>
</tr>
<tr valign=top>
<td width=35%>LS_INSUFFICIENT_UNITS</td>
<td width=65%>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(B)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(D)</td>
</tr>
<tr valign=top>
<td width=35%>Other errors</td>
<td width=65%>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(E)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(E)</td>
</tr>
</table><br>


<p>
<i>TotUnitsGranted </i>return values:

<p class=indent1>
(A) The default number of units commensurate with the license granted. </p>

<p class=indent1>
(B) The maximum number of units available to the requesting software. This can be less than the normal default. </p>

<p class=indent1>
(C) The number of units used to grant the request. This value can differ from the actual units requested. For example, the license policy may only allow only increments of five units; therefore, a request of seven units would result in a grant of 10 units. </p>

<p class=indent1>
(D) The maximum number of units available to the requesting software. This can be more or less than the units requested. </p>

<p class=indent1>
(E) Zero is returned. </p>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is LS_SUCCESS. </p>
<p>
If the function fails, the return value is a status code. For extended error information, call <a href="lsapi_38h1.htm"><b>LSGetMessage</b></a><b> </b>to return the status <i>text</i> corresponding to the status <i>code</i>. The <b>LSGetMessage </b>function<b> </b>may return one of the following status codes: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=57%>Value</th>
<th align=left width=43%>Meaning</th>
</tr>
<tr valign=top>
<td width=57%>LS_BAD_HANDLE</td>
<td width=43%>The handle used on the call does not describe a valid licensing system context.</td>
</tr>
<tr valign=top>
<td width=57%>LS_INSUFFICIENT_UNITS</td>
<td width=43%>The licensing system cannot locate enough available licensing resources to complete the request.</td>
</tr>
<tr valign=top>
<td width=57%>LS_LICENSE_TERMINATED</td>
<td width=43%>The licensing system has determined that the resources used to satisfy a previous request are no longer granted to the calling software.</td>
</tr>
<tr valign=top>
<td width=57%>LS_AUTHORIZATION_UNAVAILABLE</td>
<td width=43%>The licensing system has no licensing resources to complete the request.</td>
</tr>
<tr valign=top>
<td width=57%>LS_LICENSE_UNAVAILABLE</td>
<td width=43%>The licensing system has licensing resources that could satisfy the request, but they are not available at the time of the request.</td>
</tr>
<tr valign=top>
<td width=57%>LS_RESOURCES_UNAVAILABLE</td>
<td width=43%>The request cannot be completed because of insufficient resources, such as memory.</td>
</tr>
<tr valign=top>
<td width=57%>LS_NETWORK_UNAVAILABLE</td>
<td width=43%>The network is unavailable.</td>
</tr>
<tr valign=top>
<td width=57%>LS_LICENSE_EXPIRED</td>
<td width=43%>The license associated with the current context has expired. This may be due to a time-restriction on the license.</td>
</tr>
<tr valign=top>
<td width=57%>LS_BAD_ARG</td>
<td width=43%>One or more of the arguments is incorrect.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
Your application should periodically call the <b>LSUpdate</b> function to verify that the current license is still valid. The application can use the <a href="lsapi_4pa1.htm"><b>LSQuery</b></a> function to determine the proper time interval for the current licensing context. A guideline of once an hour may be appropriate, with a minimum interval of 15 minutes. Consult your license system vendor for more information. </p>
<p>
The <b>LSUpdate</b> function verifies that the license system context has not changed from the one expected by the licensed software. The <b>LSUpdate</b> function can determine if the licensing resources granted to the specified handle are still reserved for this application. In a distributed license system, an error might indicate a temporary network interruption. It can also determine if the license system has released the licensing resources granted to the specified handle. An error indicates the software no longer has authorization to execute in a typical manner. </p>
<p>
The call to the <b>LSUpdate</b> function can also indicate that the current licensing context has expired. For example, in the case of a time-restricted license policy, it returns the warning status LS_LICENSE_EXPIRED. </p>
<p>
If the number of new units requested in the <i>TotUnitsReserved</i> parameter is greater than the number available, then the update request fails and it returns the error LS_INSUFFICIENT_UNITS. </p>
<p>
If the call completes successfully, the value returned in the <i>TotUnitsGranted</i> parameter indicates the current total of units granted. </p>
<p>
If <b>LSUpdate</b> returns an error, it does not return a challenge response. Application software should be prepared to handle vendor-specific error conditions if they arise. If any error is returned, a call to the <b>LSRelease</b> function is still required. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.51 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in lsapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use lsapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="lsapi_8co5.htm">License Service Application Programming Interface Overview</a>, <a href="lsapi_55kj.htm">LSAPI Functions</a>, <a href="lsapi_416a.htm"><b>LS_CHALLENGE</b></a>,<b> <a href="lsapi_38h1.htm">LSGetMessage</a></b>,<b> <a href="lsapi_4pa1.htm">LSQuery</a></b>,<b> <a href="lsapi_4yp1.htm">LSRelease</a></b>,<b> <a href="lsapi_36lw.htm">LSRequest</a></b> </p>
<p>&nbsp;</p></body>
</HTML>
