<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>InitiateSystemShutdown</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_initiatesystemshutdown"></a>InitiateSystemShutdown</h1>
<p>
The <b>InitiateSystemShutdown</b> function initiates a shutdown and optional restart of the specified computer. </p>
<pre><code><b>BOOL InitiateSystemShutdown(
  LPTSTR</b><i> lpMachineName</i><b>,   </b>// pointer to name of computer to shut down
<b>  LPTSTR</b><i> lpMessage</i><b>,          </b>// pointer to message to display in 
                             // dialog box
<b>  DWORD</b><i> dwTimeout</i><b>,           </b>// time to display dialog box
<b>  BOOL</b><i> bForceAppsClosed</i><b>,     </b>// force applications closed flag
<b>  BOOL</b><i> bRebootAfterShutdown</i>  // reboot flag
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpMachineName</i></dt>
<dd>
Pointer to the null-terminated string that specifies the network name of the computer to shut down. If <i>lpMachineName</i> is NULL or points to an empty string, the function shuts down the local computer. </dd>
<dt>
<i>lpMessage</i></dt>
<dd>
Pointer to a null-terminated string that specifies a message to display in the shutdown dialog box. This parameter can be NULL if no message is required. </dd>
<dt>
<i>dwTimeout</i></dt>
<dd>
Specifies the time (in seconds) that the dialog box should be displayed. While this dialog box is displayed, the shutdown can be stopped by the <a href="shutdown_5vou.htm"><b>AbortSystemShutdown</b></a> function. 
<p>
If <i>dwTimeout</i> is not zero, <b>InitiateSystemShutdown</b> displays a dialog box on the specified computer. The dialog box displays the name of the user who called the function, displays the message specified by the <i>lpMessage</i> parameter, and prompts the user to log off. The dialog box beeps when it is created and remains on top of other windows in the system. The dialog box can be moved but not closed. A timer counts down the remaining time before a forced shutdown. If the user logs off, the system shuts down immediately. Otherwise, the computer is shut down when the timer expires. 

<p>
If <i>dwTimeout</i> is zero, the computer shuts down without displaying the dialog box, and the shutdown cannot be stopped by <b>AbortSystemShutdown</b>. 
</dd>
<dt>
<i>bForceAppsClosed</i></dt>
<dd>
Specifies whether applications with unsaved changes are to be forcibly closed. If this parameter is TRUE, such applications are closed. If this parameter is FALSE, a dialog box is displayed prompting the user to close the applications. </dd>
<dt>
<i>bRebootAfterShutdown</i></dt>
<dd>
Specifies whether the computer is to restart immediately after shutting down. If this parameter is TRUE, the computer is to restart. If this parameter is FALSE, the system flushes all caches to disk, clears the screen, and displays a message indicating that it is safe to power down. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
To shut down the local computer, the calling process must have the SE_SHUTDOWN_NAME privilege. To shut down a remote computer, the calling process must have the SE_REMOTE_SHUTDOWN_NAME privilege on the remote computer. By default, users can enable the SE_SHUTDOWN_NAME privilege on the computer they are logged onto, and administrators can enable the SE_REMOTE_SHUTDOWN_NAME privilege on remote computers. </p>
<p>
Common reasons for failure include an invalid or inaccessible computer name or insufficient privilege. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winreg.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use advapi32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="shutdown_29wu.htm">System Shutdown Overview</a>, <a href="shutdown_4cc3.htm">System Shutdown Functions</a>, <a href="shutdown_5vou.htm"><b>AbortSystemShutdown</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
