<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Getting the System Version</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_getting_the_system_version"></a>Getting the System Version</h2>
<p>
The following example uses the <a href="sysinfo_49iw.htm"><b>GetVersionEx</b></a> function to retrieve version information about the currently running operating system. </p>
<pre><code>OSVERSIONINFOEX osvi;
BOOL bOsVersionInfoEx;

// Try calling GetVersionEx using the OSVERSIONINFOEX structure,
// which is supported on Windows NT versions 5.0 and later.
// If that fails, try using the OSVERSIONINFO structure,
// which is supported on earlier versions of Windows and Windows NT

ZeroMemory(&amp;osvi, sizeof(OSVERSIONINFOEX));
osvi.dwOSVersionInfoSize = sizeof(OSVERSIONINFOEX);

if (! (bOsVersionInfoEx = GetVersionEx ( (OSVERSIONINFO *) &amp;osvi) ) ) {

   // If OSVERSIONINFOEX doesn't work, try OSVERSIONINFO.

   osvi.dwOSVersionInfoSize = sizeof (OSVERSIONINFO);
   if (! GetVersionEx ( (OSVERSIONINFO *) &amp;osvi) ) 
      return 0;
}

switch (osvi.dwPlatformId) {

   case VER_PLATFORM_WIN32_NT:

      printf ("Microsoft Windows NT ");
      break;

   case VER_PLATFORM_WIN32_WINDOWS:

      if ((osvi.dwMajorVersion &gt; 4) || 
         ((osvi.dwMajorVersion == 4) &amp;&amp; (osvi.dwMinorVersion &gt; 0)))
             printf ("Microsoft Windows 98 ");
      else
             printf ("Microsoft Windows 95 ");
      break;

   case VER_PLATFORM_WIN32s:

      printf ("Microsoft Win32s ");
      break;
}

printf ("version %d.%d (Build %d)\n",
            osvi.dwMajorVersion, 
            osvi.dwMinorVersion, 
            osvi.dwBuildNumber &amp; 0xFFFF);

if (bOsVersionInfoEx)
    printf ("Service Pack %d.%d\n", 
                osvi.wServicePackMajor, 
                osvi.wServicePackMinor);
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
