<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ENUMPRT.H</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context3433"></a>ENUMPRT.H</h2>
<pre><code><br>/******************************************************************************\ <br>*       This is a part of the Microsoft Source Code Samples.  <br>*       Copyright 1993 - 1998 Microsoft Corporation. <br>*       All rights reserved.  <br>*       This source code is only intended as a supplement to  <br>*       Microsoft Development Tools and/or WinHelp documentation. <br>*       See these sources for detailed information regarding the  <br>*       Microsoft samples programs. <br>\******************************************************************************/ <br> <br>/******************************************************************************\ <br>* <br>*                                  ENUMPRT.H <br>* <br>\******************************************************************************/ <br> <br>/******************************************************************************\ <br>*                             SYMBOLIC CONSTANTS <br>\******************************************************************************/ <br> <br>#define MAX_ATTRIBUTES     4   // # of elements in gaAttributes <br>#define MAX_PRIORITIES     4   // # of elements in gaPriorities <br>#define MAX_STATUS         3   // # of elements in gaStatus <br>#define MAX_FIELDS         15  // # of elements in gaFields <br>#define MAX_ORIENTATION    2   // # of elements in gaOrientation <br>#define MAX_PAPERSIZE      41  // # of elements in gaPaperSize <br>#define MAX_DEFAULTSOURCE  16  // # of elements in gaDefaultSource <br>#define MAX_PRINTQUALITY   4   // # of elements in gaPrintQuality <br>#define MAX_COLOR          2   // # of elements in gaColor <br>#define MAX_DUPLEX         3   // # of elements in gaDuplex <br> <br>#define ERR_MOD_NAME       IDS_ERR_ENUMPRT <br> <br>#define BLANKS             "\t\t\t" <br> <br>/******************************************************************************\ <br>*                                  TYPEDEFS <br>\******************************************************************************/ <br> <br>typedef struct tagENUMPRTLOOKUP <br>{ <br>  DWORD   dwValue; <br>  LPCSTR  szValue; <br> <br>} ENUMPRTLOOKUP; <br> <br> <br> <br>/******************************************************************************\ <br>*                              GLOBAL VARIABLES <br>\******************************************************************************/ <br> <br>HWND  ghwndEnumPrt; <br>DWORD gdwEnumFlags; <br>char  gszEnumName[BUFSIZE]; <br> <br>LPSTR gaEnumPrt[] = <br> <br>      { "PRINTER_INFO_1"  , <br>        "  pDescription:      \t%s", <br>        "  pName:             \t%s", <br>        "  pComment:          \t%s", <br>        "PRINTER_INFO_2"  , <br>        "  pServerName:       \t%s",  // 5 <br>        "  pPrinterName:      \t%s", <br>        "  pShareName:        \t%s", <br>        "  pPortName:         \t%s", <br>        "  pDriverName:       \t%s", <br>        "  pComment:          \t%s",  // 10 <br>        "  pLocation:         \t%s", <br>        "  pDevMode           \t%s", <br>        "     dmDeviceName:     \t%s", <br>        "     dmSpecVersion:    \t%d", <br>        "     dmDriverVersion:  \t%d",  // 15 <br>        "     dmSize:           \t%d", <br>        "     dmDriverExtra:    \t%d", <br>        "     dmFields:         \t", <br>        "     dmOrientation:    \t", <br>        "     dmPaperSize:      \t",  // 20 <br>        "     dmPaperLength:    \t%d", <br>        "     dmPaperWidth:     \t%d", <br>        "     dmScale:          \t%d", <br>        "     dmCopies:         \t%d", <br>        "     dmDefaultSource:  \t",  // 25 <br>        "     dmPrintQuality:   \t%s", <br>        "     dmColor:          \t", <br>        "     dmDuplex:         \t", <br>        "     dmYResolution:    \t%d", <br>        "     dmTTOption:       \t%d",  // 30 <br>        "     dmCollate:        \t&amp;d", <br>        "     dmFormName:       \t%s", <br>        "  pSepFile:          \t%s", <br>        "  pPrintProcessor:   \t%s", <br>        "  pDatatype:         \t%s",  // 35 <br>        "  pParameters:       \t%s", <br>        "  Attributes:        \t", <br>        "  Priority:          \t%s", <br>        "  Priority:          \t%ld", <br>        "  DefaultPriority:   \t%ld",  // 40 <br>        "  StartTime:         \t%ld", <br>        "  UntilTime:         \t%ld", <br>        "  Status:            \t", <br>        "  cJobs:             \t%ld", <br>        "  AveragePPM:        \t%ld"    }; <br> <br>ENUMPRTLOOKUP gaAttributes[] = <br> <br>    { { PRINTER_ATTRIBUTE_QUEUED       , "PRINTER_ATTRIBUTE_QUEUED  " }, <br>      { PRINTER_ATTRIBUTE_DIRECT       , "PRINTER_ATTRIBUTE_DIRECT  " }, <br>      { PRINTER_ATTRIBUTE_DEFAULT      , "PRINTER_ATTRIBUTE_DEFAULT " }, <br>      { PRINTER_ATTRIBUTE_SHARED       , "PRINTER_ATTRIBUTE_SHARED  " } }; <br> <br>ENUMPRTLOOKUP gaPriorities[] = <br> <br>    { { NO_PRIORITY                    , "NO_PRIORITY  " }, <br>      { MAX_PRIORITY                   , "MAX_PRIORITY " }, <br>      { MIN_PRIORITY                   , "MIN_PRIORITY " }, <br>      { DEF_PRIORITY                   , "DEF_PRIORITY " } }; <br> <br>ENUMPRTLOOKUP gaStatus[] = <br> <br>    { { PRINTER_STATUS_PAUSED          , "PRINTER_STATUS_PAUSED "          }, <br>      { PRINTER_STATUS_ERROR           , "PRINTER_STATUS_ERROR  "          }, <br>      { PRINTER_STATUS_PENDING_DELETION, "PRINTER_STATUS_PENDING_DELETION "}, <br>      { 0                              , ""                                }}; <br> <br>ENUMPRTLOOKUP gaFields[] = <br> <br>    { { DM_ORIENTATION  , "DM_ORIENTATION  " }, <br>      { DM_PAPERSIZE    , "DM_PAPERSIZE    " }, <br>      { DM_PAPERLENGTH  , "DM_PAPERLENGTH  " }, <br>      { DM_PAPERWIDTH   , "DM_PAPERWIDTH   " }, <br>      { DM_SCALE        , "DM_SCALE        " }, <br>      { DM_COPIES       , "DM_COPIES       " }, <br>      { DM_DEFAULTSOURCE, "DM_DEFAULTSOURCE" }, <br>      { DM_PRINTQUALITY , "DM_PRINTQUALITY " }, <br>      { DM_COLOR        , "DM_COLOR        " }, <br>      { DM_DUPLEX       , "DM_DUPLEX       " }, <br>      { DM_YRESOLUTION  , "DM_YRESOLUTION  " }, <br>      { DM_TTOPTION     , "DM_TTOPTION     " }, <br>      { DM_COLLATE      , "DM_COLLATE      " }, <br>      { DM_FORMNAME     , "DM_FORMNAME     " }, <br>      { 0               , "0               " } }; <br> <br>ENUMPRTLOOKUP gaOrientation[] = <br> <br>    { { DMORIENT_PORTRAIT , "DMORIENT_PORTRAIT " }, <br>      { DMORIENT_LANDSCAPE, "DMORIENT_LANDSCAPE" } }; <br> <br>ENUMPRTLOOKUP gaPaperSize[] = <br> <br>    { { DMPAPER_FIRST             , "DMPAPER_FIRST             " }, <br>      { DMPAPER_LETTER            , "DMPAPER_LETTER            " }, <br>      { DMPAPER_LETTERSMALL       , "DMPAPER_LETTERSMALL       " }, <br>      { DMPAPER_TABLOID           , "DMPAPER_TABLOID           " }, <br>      { DMPAPER_LEDGER            , "DMPAPER_LEDGER            " }, <br>      { DMPAPER_LEGAL             , "DMPAPER_LEGAL             " }, <br>      { DMPAPER_STATEMENT         , "DMPAPER_STATEMENT         " }, <br>      { DMPAPER_EXECUTIVE         , "DMPAPER_EXECUTIVE         " }, <br>      { DMPAPER_A3                , "DMPAPER_A3                " }, <br>      { DMPAPER_A4                , "DMPAPER_A4                " }, <br>      { DMPAPER_A4SMALL           , "DMPAPER_A4SMALL           " }, <br>      { DMPAPER_A5                , "DMPAPER_A5                " }, <br>      { DMPAPER_B4                , "DMPAPER_B4                " }, <br>      { DMPAPER_B5                , "DMPAPER_B5                " }, <br>      { DMPAPER_FOLIO             , "DMPAPER_FOLIO             " }, <br>      { DMPAPER_QUARTO            , "DMPAPER_QUARTO            " }, <br>      { DMPAPER_10X14             , "DMPAPER_10X14             " }, <br>      { DMPAPER_11X17             , "DMPAPER_11X17             " }, <br>      { DMPAPER_NOTE              , "DMPAPER_NOTE              " }, <br>      { DMPAPER_ENV_9             , "DMPAPER_ENV_9             " }, <br>      { DMPAPER_ENV_10            , "DMPAPER_ENV_10            " }, <br>      { DMPAPER_ENV_11            , "DMPAPER_ENV_11            " }, <br>      { DMPAPER_ENV_12            , "DMPAPER_ENV_12            " }, <br>      { DMPAPER_ENV_14            , "DMPAPER_ENV_14            " }, <br>      { DMPAPER_CSHEET            , "DMPAPER_CSHEET            " }, <br>      { DMPAPER_DSHEET            , "DMPAPER_DSHEET            " }, <br>      { DMPAPER_ESHEET            , "DMPAPER_ESHEET            " }, <br>      { DMPAPER_ENV_DL            , "DMPAPER_ENV_DL            " }, <br>      { DMPAPER_ENV_C5            , "DMPAPER_ENV_C5            " }, <br>      { DMPAPER_ENV_C3            , "DMPAPER_ENV_C3            " }, <br>      { DMPAPER_ENV_C4            , "DMPAPER_ENV_C4            " }, <br>      { DMPAPER_ENV_C6            , "DMPAPER_ENV_C6            " }, <br>      { DMPAPER_ENV_C65           , "DMPAPER_ENV_C65           " }, <br>      { DMPAPER_ENV_B4            , "DMPAPER_ENV_B4            " }, <br>      { DMPAPER_ENV_B5            , "DMPAPER_ENV_B5            " }, <br>      { DMPAPER_ENV_B6            , "DMPAPER_ENV_B6            " }, <br>      { DMPAPER_ENV_ITALY         , "DMPAPER_ENV_ITALY         " }, <br>      { DMPAPER_ENV_MONARCH       , "DMPAPER_ENV_MONARCH       " }, <br>      { DMPAPER_ENV_PERSONAL      , "DMPAPER_ENV_PERSONAL      " }, <br>      { DMPAPER_FANFOLD_STD_GERMAN, "DMPAPER_FANFOLD_STD_GERMAN" }, <br>      { DMPAPER_FANFOLD_LGL_GERMAN, "DMPAPER_FANFOLD_LGL_GERMAN" } }; <br> <br>ENUMPRTLOOKUP gaDefaultSource[] = <br> <br>    { { DMBIN_FIRST        , "DMBIN_FIRST        " }, <br>      { DMBIN_UPPER        , "DMBIN_UPPER        " }, <br>      { DMBIN_ONLYONE      , "DMBIN_ONLYONE      " }, <br>      { DMBIN_LOWER        , "DMBIN_LOWER        " }, <br>      { DMBIN_MIDDLE       , "DMBIN_MIDDLE       " }, <br>      { DMBIN_MANUAL       , "DMBIN_MANUAL       " }, <br>      { DMBIN_ENVELOPE     , "DMBIN_ENVELOPE     " }, <br>      { DMBIN_ENVMANUAL    , "DMBIN_ENVMANUAL    " }, <br>      { DMBIN_AUTO         , "DMBIN_AUTO         " }, <br>      { DMBIN_TRACTOR      , "DMBIN_TRACTOR      " }, <br>      { DMBIN_SMALLFMT     , "DMBIN_SMALLFMT     " }, <br>      { DMBIN_LARGEFMT     , "DMBIN_LARGEFMT     " }, <br>      { DMBIN_LARGECAPACITY, "DMBIN_LARGECAPACITY" }, <br>      { DMBIN_CASSETTE     , "DMBIN_CASSETTE     " }, <br>      { DMBIN_LAST         , "DMBIN_LAST         " }, <br>      { DMBIN_USER         , "DMBIN_USER         " } }; <br> <br>ENUMPRTLOOKUP gaPrintQuality[] = <br> <br>    { { (DWORD)DMRES_DRAFT , "DMRES_DRAFT " }, <br>      { (DWORD)DMRES_LOW   , "DMRES_LOW   " }, <br>      { (DWORD)DMRES_MEDIUM, "DMRES_MEDIUM" }, <br>      { (DWORD)DMRES_HIGH  , "DMRES_HIGH  " } }; <br> <br>ENUMPRTLOOKUP gaColor[] = <br> <br>    { { DMCOLOR_MONOCHROME, "DMCOLOR_MONOCHROME" }, <br>      { DMCOLOR_COLOR     , "DMCOLOR_COLOR     " } }; <br> <br>ENUMPRTLOOKUP gaDuplex[] = <br> <br>    { { DMDUP_SIMPLEX   , "DMDUP_SIMPLEX   " }, <br>      { DMDUP_VERTICAL  , "DMDUP_VERTICAL  " }, <br>      { DMDUP_HORIZONTAL, "DMDUP_HORIZONTAL" } }; <br> <br>char *gaDriverInfo[] = <br> <br>    {   "DRIVER_INFO_1", <br>        "  pName\t\t%s", <br> <br>        "DRIVER_INFO_2", <br>        "  cVersion\t%ld", <br>        "  pName\t\t%s", <br>        "  pEnvironment\t%s", <br>        "  pDriverPath\t%s", <br>        "  pDataFile\t%s", <br>        "  pConfigFile\t%s" }; <br> <br> <br> <br>/******************************************************************************\ <br>*                              EXTERNAL VARIABLES <br>\******************************************************************************/ <br> <br>extern HWND ghwndMain; <br> <br> <br> <br>/******************************************************************************\ <br>*                                  MACROS <br>\******************************************************************************/ <br> <br>#define outstr(fmt,arg)  { wsprintf (buf,fmt,arg?arg:"(null)");           \ <br>                           SendDlgItemMessage (hwnd, DID_LISTBOX,         \ <br>                                               LB_INSERTSTRING, (UINT)-1, \ <br>                                               (LONG) buf); } <br> <br>#define outstr2(buf)     SendDlgItemMessage (hwnd, DID_LISTBOX,         \ <br>                                             LB_INSERTSTRING, (UINT)-1, \ <br>                                             (LONG) buf); <br> <br>#define outstr3()        SendDlgItemMessage (hwnd, DID_LISTBOX,         \ <br>                                             LB_INSERTSTRING,           \ <br>                                             (UINT)-1, (LONG) buf); <br> <br>#define outnum(fmt,arg)  { wsprintf(buf,fmt,arg);                         \ <br>                           SendDlgItemMessage (hwnd, DID_LISTBOX,         \ <br>                                               LB_INSERTSTRING, (UINT)-1, \ <br>                                               (LONG) buf); } <br> <br> <br> <br>/******************************************************************************\ <br>*                            FUNCTION PROTOTYPES <br>\******************************************************************************/ <br> <br>LRESULT CALLBACK EnumPrintersOptionsDlgProc (HWND, UINT, WPARAM, LPARAM); <br> <br>BOOL DisplayEnumPrintersInfo   (HWND); <br>void SetEnumPrintersDlgFields  (HWND, DWORD, LPPRINTER_INFO_1, <br>                                LPPRINTER_INFO_2); <br>void ComplexEnumPrintersLine   (HWND, char *, ENUMPRTLOOKUP *, int, DWORD); <br>BOOL DisplayPrinterDriversInfo (HWND); </code></pre>
<p>&nbsp;</p></body>
</HTML>
