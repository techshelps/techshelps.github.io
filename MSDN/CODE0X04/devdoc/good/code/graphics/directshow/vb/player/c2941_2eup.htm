<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PLAYER.FRM</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2941"></a>PLAYER.FRM</h2>
<pre><code>VERSION 5.00 <br>Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.1#0"; "COMDLG32.OCX" <br>Object = "{6B7E6392-850A-101B-AFC0-4210102A8DA7}#1.1#0"; "COMCTL32.OCX" <br>Begin VB.Form Form1  <br>   Caption         =   "Form1" <br>   ClientHeight    =   1545 <br>   ClientLeft      =   3915 <br>   ClientTop       =   1530 <br>   ClientWidth     =   4515 <br>   LinkTopic       =   "Form1" <br>   PaletteMode     =   1  'UseZOrder <br>   ScaleHeight     =   1545 <br>   ScaleWidth      =   4515 <br>   Begin VB.Timer Timer1  <br>      Interval        =   200 <br>      Left            =   3720 <br>      Top             =   1200 <br>   End <br>   Begin VB.CommandButton StopButton  <br>      Caption         =   "&amp;Stop" <br>      Height          =   495 <br>      Left            =   2160 <br>      TabIndex        =   3 <br>      Top             =   120 <br>      Width           =   735 <br>   End <br>   Begin VB.CommandButton PlayButton  <br>      Caption         =   "&amp;Play" <br>      Height          =   495 <br>      Left            =   1200 <br>      TabIndex        =   2 <br>      Top             =   120 <br>      Width           =   735 <br>   End <br>   Begin VB.CommandButton OpenButton  <br>      Caption         =   "&amp;Open" <br>      Height          =   495 <br>      Left            =   240 <br>      TabIndex        =   0 <br>      Top             =   120 <br>      Width           =   735 <br>   End <br>   Begin ComctlLib.Slider Slider1  <br>      Height          =   375 <br>      Left            =   240 <br>      TabIndex        =   1 <br>      Top             =   840 <br>      Width           =   3735 <br>      _ExtentX        =   6588 <br>      _ExtentY        =   661 <br>      _Version        =   327680 <br>   End <br>   Begin MSComDlg.CommonDialog CommonDialog1  <br>      Left            =   3240 <br>      Top             =   1200 <br>      _ExtentX        =   847 <br>      _ExtentY        =   847 <br>      _Version        =   327680 <br>   End <br>End <br>Attribute VB_Name = "Form1" <br>Attribute VB_GlobalNameSpace = False <br>Attribute VB_Creatable = False <br>Attribute VB_PredeclaredId = True <br>Attribute VB_Exposed = False <br>Dim pMC As Object <br>Dim bOpen As Boolean <br>Dim bPlay As Boolean <br>Dim bSeeking As Boolean <br> <br>Private Sub Form_Load() <br> <br>Set pMC = Nothing <br>bOpen = False <br>bPlay = False <br>bSeeking = False <br> <br>End Sub <br> <br> <br> <br> <br>Private Sub OpenButton_Click() <br>    If bPlay Then pMC.Stop <br>    If bOpen Then Set pMC = Nothing <br>    bOpen = False <br> <br>    Set pMC = New FilgraphManager <br> <br>    CommonDialog1.ShowOpen <br>    pMC.RenderFile CommonDialog1.filename <br> <br>    Rem make window appear <br>    Dim pVW As IVideoWindow <br>    Set pVW = pMC <br>    pVW.Visible = True <br>    Set pVW = Nothing <br> <br>    bOpen = True <br> <br> <br>End Sub <br> <br>Private Sub PlayButton_Click() <br>    If Not bOpen Then Exit Sub <br>    If bPlay Then Exit Sub <br> <br>    pMC.Run <br>    bPlay = True <br>    OpenButton.Enabled = False <br>    PlayButton.Enabled = False <br> <br>End Sub <br> <br> <br> <br>Private Sub Slider1_Change() <br> <br>bSeeking = False <br>If Not bPlay Then <br>pMC.Stop <br>End If <br> <br>End Sub <br> <br>Private Sub Slider1_Scroll() <br> <br>If Not bOpen Then Exit Sub <br> <br>bSeeking = True <br>pMC.Pause <br> <br>Dim pMP As IMediaPosition <br>Set pMP = pMC <br> <br>Dim v As Double <br>v = Slider1.Value - Slider1.Min <br>v = v / Slider1.Max * pMP.Duration <br>pMP.CurrentPosition = v <br>Set pMP = Nothing <br> <br> <br>End Sub <br> <br>Private Sub StopButton_Click() <br>    If Not bOpen Then Exit Sub <br>    pMC.Stop <br>    bPlay = False <br>    OpenButton.Enabled = True <br>    PlayButton.Enabled = True <br> <br>End Sub <br> <br>Private Sub Timer1_Timer() <br> <br>    If Not bOpen Then Exit Sub <br> <br>    If bSeeking Then Exit Sub <br> <br>    Dim pMP As IMediaPosition <br>    Set pMP = pMC <br> <br>    Dim curpos As Double <br>    Dim length As Double <br>    Dim mark As Long <br> <br>    curpos = pMP.CurrentPosition <br>    length = pMP.Duration <br>    mark = (curpos / length) * 10 <br> <br>    If Slider1.Value &lt;&gt; mark Then <br>        Slider1.Value = mark <br>    End If <br> <br>    Set pMP = Nothing <br> <br>    If Not bPlay Then Exit Sub <br> <br>    Dim pME As IMediaEvent <br>    Dim EventCode As Long <br>    Set pME = pMC <br> <br>    On Error Resume Next <br>    pME.WaitForCompletion 0, EventCode <br> <br>    Set pME = Nothing <br> <br>    If EventCode = 0 Then Exit Sub <br> <br>    pMC.Stop <br>    bPlay = False <br>    OpenButton.Enabled = True <br>    PlayButton.Enabled = True <br> <br>End Sub <br> <br> <br> <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
