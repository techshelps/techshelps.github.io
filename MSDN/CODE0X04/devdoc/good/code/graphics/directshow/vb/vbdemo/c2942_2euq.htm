<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>VBDEMO.FRM</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2942"></a>VBDEMO.FRM</h2>
<pre><code>VERSION 5.00 <br>Object = "{6B7E6392-850A-101B-AFC0-4210102A8DA7}#1.1#0"; "COMCTL32.OCX" <br>Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.1#0"; "COMDLG32.OCX" <br>Begin VB.Form frmMain  <br>   Caption         =   "ActiveMovie VB Sample" <br>   ClientHeight    =   6465 <br>   ClientLeft      =   1830 <br>   ClientTop       =   2880 <br>   ClientWidth     =   5850 <br>   ClipControls    =   0   'False <br>   LinkTopic       =   "frmMain" <br>   PaletteMode     =   1  'UseZOrder <br>   ScaleHeight     =   6465 <br>   ScaleWidth      =   5850 <br>   Begin VB.Frame frameBalance  <br>      Caption         =   "Balance" <br>      Height          =   1215 <br>      Left            =   2880 <br>      TabIndex        =   13 <br>      Top             =   1560 <br>      Width           =   2295 <br>      Begin ComctlLib.Slider slBalance  <br>         Height          =   504 <br>         Left            =   120 <br>         TabIndex        =   14 <br>         Top             =   240 <br>         Width           =   2052 <br>         _ExtentX        =   3625 <br>         _ExtentY        =   900 <br>         _Version        =   327680 <br>         Min             =   -10000 <br>         Max             =   10000 <br>         TickStyle       =   2 <br>         TickFrequency   =   2000 <br>      End <br>      Begin VB.Label lblRight  <br>         Caption         =   "Right" <br>         Height          =   255 <br>         Left            =   1680 <br>         TabIndex        =   16 <br>         Top             =   840 <br>         Width           =   495 <br>      End <br>      Begin VB.Label lblLeft  <br>         Caption         =   "Left" <br>         Height          =   255 <br>         Left            =   120 <br>         TabIndex        =   15 <br>         Top             =   840 <br>         Width           =   495 <br>      End <br>   End <br>   Begin VB.Frame frameVideoControls  <br>      Caption         =   "Video" <br>      Height          =   1335 <br>      Left            =   240 <br>      TabIndex        =   10 <br>      Top             =   0 <br>      Width           =   2295 <br>      Begin ComctlLib.Toolbar Toolbar1  <br>         Height          =   600 <br>         Left            =   240 <br>         TabIndex        =   12 <br>         Top             =   360 <br>         Width           =   1935 <br>         _ExtentX        =   3413 <br>         _ExtentY        =   1058 <br>         ButtonWidth     =   979 <br>         ButtonHeight    =   953 <br>         ImageList       =   "ImageList1" <br>         _Version        =   327680 <br>         BeginProperty Buttons {0713E452-850A-101B-AFC0-4210102A8DA7}  <br>            NumButtons      =   5 <br>            BeginProperty Button1 {0713F354-850A-101B-AFC0-4210102A8DA7}  <br>               Caption         =   "Play" <br>               Object.Tag             =   "" <br>               ImageIndex      =   1 <br>            EndProperty <br>            BeginProperty Button2 {0713F354-850A-101B-AFC0-4210102A8DA7}  <br>               Object.Tag             =   "" <br>               Style           =   3 <br>            EndProperty <br>            BeginProperty Button3 {0713F354-850A-101B-AFC0-4210102A8DA7}  <br>               Caption         =   "Pause" <br>               Object.Tag             =   "" <br>               ImageIndex      =   2 <br>            EndProperty <br>            BeginProperty Button4 {0713F354-850A-101B-AFC0-4210102A8DA7}  <br>               Object.Tag             =   "" <br>               Style           =   3 <br>            EndProperty <br>            BeginProperty Button5 {0713F354-850A-101B-AFC0-4210102A8DA7}  <br>               Caption         =   "Stop" <br>               Object.Tag             =   "" <br>               ImageIndex      =   3 <br>            EndProperty <br>         EndProperty <br>      End <br>   End <br>   Begin VB.TextBox txtRate  <br>      BackColor       =   &amp;H00000000&amp; <br>      BeginProperty Font  <br>         Name            =   "Terminal" <br>         Size            =   9 <br>         Charset         =   255 <br>         Weight          =   700 <br>         Underline       =   0   'False <br>         Italic          =   0   'False <br>         Strikethrough   =   0   'False <br>      EndProperty <br>      ForeColor       =   &amp;H00FFFFFF&amp; <br>      Height          =   270 <br>      Left            =   4440 <br>      TabIndex        =   7 <br>      Top             =   1200 <br>      Width           =   855 <br>   End <br>   Begin VB.TextBox txtStart  <br>      BackColor       =   &amp;H00000000&amp; <br>      BeginProperty Font  <br>         Name            =   "Terminal" <br>         Size            =   9 <br>         Charset         =   255 <br>         Weight          =   700 <br>         Underline       =   0   'False <br>         Italic          =   0   'False <br>         Strikethrough   =   0   'False <br>      EndProperty <br>      ForeColor       =   &amp;H00FFFFFF&amp; <br>      Height          =   270 <br>      Left            =   4440 <br>      TabIndex        =   6 <br>      Top             =   840 <br>      Width           =   855 <br>   End <br>   Begin VB.TextBox txtElapsed  <br>      Alignment       =   2  'Center <br>      BackColor       =   &amp;H00000000&amp; <br>      BeginProperty Font  <br>         Name            =   "Terminal" <br>         Size            =   9 <br>         Charset         =   255 <br>         Weight          =   700 <br>         Underline       =   0   'False <br>         Italic          =   0   'False <br>         Strikethrough   =   0   'False <br>      EndProperty <br>      ForeColor       =   &amp;H00FFFFFF&amp; <br>      Height          =   270 <br>      Left            =   4440 <br>      TabIndex        =   4 <br>      Top             =   480 <br>      Width           =   855 <br>   End <br>   Begin VB.Timer Timer1  <br>      Left            =   5160 <br>      Top             =   4680 <br>   End <br>   Begin VB.TextBox txtDuration  <br>      Alignment       =   2  'Center <br>      BackColor       =   &amp;H00000000&amp; <br>      BeginProperty Font  <br>         Name            =   "Terminal" <br>         Size            =   9 <br>         Charset         =   255 <br>         Weight          =   700 <br>         Underline       =   0   'False <br>         Italic          =   0   'False <br>         Strikethrough   =   0   'False <br>      EndProperty <br>      ForeColor       =   &amp;H00FFFFFF&amp; <br>      Height          =   270 <br>      Left            =   4440 <br>      TabIndex        =   3 <br>      Top             =   120 <br>      Width           =   855 <br>   End <br>   Begin VB.Frame frameVolume  <br>      Caption         =   "Volume" <br>      Height          =   1215 <br>      Left            =   360 <br>      TabIndex        =   0 <br>      Top             =   1560 <br>      Width           =   2295 <br>      Begin ComctlLib.Slider slVolume  <br>         Height          =   504 <br>         Left            =   120 <br>         TabIndex        =   11 <br>         Top             =   240 <br>         Width           =   2052 <br>         _ExtentX        =   3625 <br>         _ExtentY        =   900 <br>         _Version        =   327680 <br>         Min             =   -10000 <br>         Max             =   0 <br>         TickStyle       =   2 <br>         TickFrequency   =   1000 <br>      End <br>      Begin VB.Label lblMax  <br>         Caption         =   "Max" <br>         Height          =   255 <br>         Left            =   1800 <br>         TabIndex        =   2 <br>         Top             =   840 <br>         Width           =   375 <br>      End <br>      Begin VB.Label lblMin  <br>         Caption         =   "Min" <br>         Height          =   255 <br>         Left            =   120 <br>         TabIndex        =   1 <br>         Top             =   840 <br>         Width           =   495 <br>      End <br>   End <br>   Begin MSComDlg.CommonDialog CommonDialog1  <br>      Left            =   4920 <br>      Top             =   3120 <br>      _ExtentX        =   847 <br>      _ExtentY        =   847 <br>      _Version        =   327680 <br>   End <br>   Begin VB.Label lblDuration  <br>      Caption         =   "Length (Sec):" <br>      Height          =   255 <br>      Left            =   2760 <br>      TabIndex        =   17 <br>      Top             =   120 <br>      Width           =   1455 <br>   End <br>   Begin ComctlLib.ImageList ImageList1  <br>      Left            =   5040 <br>      Top             =   3840 <br>      _ExtentX        =   1005 <br>      _ExtentY        =   1005 <br>      BackColor       =   -2147483643 <br>      ImageWidth      =   16 <br>      ImageHeight     =   16 <br>      MaskColor       =   12632256 <br>      _Version        =   327680 <br>      BeginProperty Images {0713E8C2-850A-101B-AFC0-4210102A8DA7}  <br>         NumListImages   =   3 <br>         BeginProperty ListImage1 {0713E8C3-850A-101B-AFC0-4210102A8DA7}  <br>            Picture         =   "vbdemo.frx":0000 <br>            Key             =   "" <br>         EndProperty <br>         BeginProperty ListImage2 {0713E8C3-850A-101B-AFC0-4210102A8DA7}  <br>            Picture         =   "vbdemo.frx":0112 <br>            Key             =   "" <br>         EndProperty <br>         BeginProperty ListImage3 {0713E8C3-850A-101B-AFC0-4210102A8DA7}  <br>            Picture         =   "vbdemo.frx":0224 <br>            Key             =   "" <br>         EndProperty <br>      EndProperty <br>   End <br>   Begin VB.Label lblRate  <br>      Caption         =   "Playback speed:" <br>      Height          =   255 <br>      Left            =   2760 <br>      TabIndex        =   9 <br>      Top             =   1200 <br>      Width           =   1335 <br>   End <br>   Begin VB.Label lblStart  <br>      Caption         =   "Start position (Sec):" <br>      Height          =   255 <br>      Left            =   2760 <br>      TabIndex        =   8 <br>      Top             =   840 <br>      Width           =   1455 <br>   End <br>   Begin VB.Label lblElapsed  <br>      Caption         =   "Elapsed Time (Sec):" <br>      Height          =   252 <br>      Left            =   2760 <br>      TabIndex        =   5 <br>      Top             =   480 <br>      Width           =   1572 <br>   End <br>   Begin VB.Shape Shape1  <br>      BackStyle       =   1  'Opaque <br>      BorderColor     =   &amp;H00808080&amp; <br>      BorderWidth     =   4 <br>      Height          =   3135 <br>      Left            =   240 <br>      Top             =   3000 <br>      Width           =   4095 <br>   End <br>   Begin VB.Menu mnu_File  <br>      Caption         =   "&amp;File" <br>      Begin VB.Menu mnu_FileOpen  <br>         Caption         =   "&amp;Open" <br>      End <br>      Begin VB.Menu mnu_FileExit  <br>         Caption         =   "E&amp;xit" <br>      End <br>   End <br>End <br>Attribute VB_Name = "frmMain" <br>Attribute VB_GlobalNameSpace = False <br>Attribute VB_Creatable = False <br>Attribute VB_PredeclaredId = True <br>Attribute VB_Exposed = False <br>' ActiveMovie SDK - VB4 interface sample <br>' Copyright 1996 - 1997 Microsoft Corporation <br>' This sample demonstrates Visual Basic 4.0 use of the <br>' ActiveMovie interfaces that are in FilgraphManager. <br> <br>' This sample defines the following variable prefixes: <br>'  g_dbl - global double; <br>'  g_f   - global flag (Boolean); <br>'  g_obj - object; <br>'  g_str - string <br> <br>Dim g_objVideoWindow As IVideoWindow       'VideoWindow Object <br>Dim g_objMediaControl As IMediaControl     'MediaControl Object <br>Dim g_objMediaPosition As IMediaPosition   'MediaPosition Object <br>Dim g_objBasicAudio  As IBasicAudio        'Basic Audio Object <br>Dim g_objBasicVideo As IBasicVideo         'Basic Video Object <br> <br>Dim g_strFileName As String      'Name retrieved with FileOpenDlg <br>Dim g_dblRunLength As Double     'Global duration in seconds <br>Dim g_dblStartPosition As Double 'Global start position in seconds <br>Dim g_dblRate As Double          'Global rate <br>Dim g_fVideoRun As Boolean       'Flag used to trigger clock <br> <br>Private Sub Form_Load() <br>    'Alter the coordinate system so that we work <br>    'in pixels (instead of the default twips) <br>     <br>    frmMain.ScaleMode = 3   ' pixels <br>     <br>    'Set the granularity for the timer control <br>    'so that we can display the duration for <br>    'given video sequence. <br>     <br>    Timer1.Interval = 1000 '1 second intervals <br> <br>End Sub <br> <br>Private Sub Form_Unload(Cancel As Integer) <br>    mnu_FileExit_Click <br>End Sub <br> <br>Private Sub mnu_FileExit_Click() <br>    cleanup <br>    End <br>End Sub <br> <br>Private Sub mnu_FileOpen_Click() <br>' Use the common file dialog to select an ActiveMovie file <br>' (has the extension .AVI or .MPG.) <br>' Initialize global variables based on the <br>' contents of the file: <br>'   g_strFileName - name of file name selected by the user <br>'   g_dblRunLength = length of the file; duration <br>'   g_dblStartPosition - point at which to start playing clip <br>'   g_objMediaControl, g_objMediaEvent, g_objMediaPosition, <br>'   g_objBasicAudio, g_objVideoWindow - programmable objects <br> <br>    'clean up memory (in case a file is already open) <br>    cleanup <br>     <br>    'Retrieve the name of an .avi or an .mpg <br>    'file that the user wishes to view. <br>    CommonDialog1.Filter = "ActiveMovie files (*.mpg;*.avi;*.mov)|*.mpg;*.avi;*.mov" <br>    CommonDialog1.ShowOpen <br>    g_strFileName = CommonDialog1.filename <br>     <br>    'Verify that correct filename was selected <br>     <br>    If (InStr(1, g_strFileName, ".avi", 1)) Or (InStr(1, g_strFileName, ".mpg", 1) Or (InStr(1, g_strFileName, ".mov", 1))) Then <br>    Else <br>        MsgBox "Invalid Filename Selected!", , "ActiveMovie sample" <br>        Exit Sub <br>    End If <br>     <br>    'Instantiate a filter graph for the requested <br>    'file format. <br>     <br>    Set g_objMediaControl = New FilgraphManager <br>    If g_objMediaControl Is Nothing Then <br>        MsgBox "Cannot create the IMediaControl object" <br>        Exit Sub <br>    End If <br>         <br>    g_objMediaControl.RenderFile (g_strFileName) <br>     <br>    'Setup the IBasicAudio object (this <br>    'is equivalent to calling QueryInterface() <br>    'on IFilterGraphManager). Initialize the volume <br>    'to the maximum value. <br>     <br>    ' Some filter graphs don't render audio <br>    ' In this sample, skip setting volume property <br>    Set g_objBasicAudio = g_objMediaControl <br>    On Error Resume Next <br>    g_objBasicAudio.Volume = slVolume.Value <br>   <br>    'Setup the IVideoWindow object. Remove the <br>    'caption, border, dialog frame, and scrollbars <br>    'from the default window. Position the window. <br>    'Set the parent to the app's form. <br>     <br>    Set g_objVideoWindow = g_objMediaControl <br>    g_objVideoWindow.WindowStyle = CLng(&amp;H6000000) <br>    g_objVideoWindow.Left = CLng(Shape1.Left) <br>    g_objVideoWindow.Top = CLng(Shape1.Top) <br>    Shape1.Width = g_objVideoWindow.Width <br>    Shape1.Height = g_objVideoWindow.Height <br>    g_objVideoWindow.Owner = frmMain.hWnd <br>          <br>    'Setup the IMediaEvent object for the <br>    'sample toolbar (run, pause, play). <br>     <br>    Set g_objMediaEvent = g_objMediaControl <br>     <br>    'Setup the IMediaPosition object so that we <br>    'can display the duration of the selected <br>    'video as well as the elapsed time. <br>     <br>    Set g_objMediaPosition = g_objMediaControl <br>    g_dblRunLength = g_objMediaPosition.Duration <br>    txtDuration.Text = CStr(g_dblRunLength) <br>     <br>    ' reset start position to 0 <br>    g_dblStartPosition = 0# <br>    txtStart.Text = CDbl(g_dblStartPosition) <br>    ' use user-established playback rate <br>    g_dblRate = g_objMediaPosition.Rate <br>    txtRate.Text = CStr(g_dblRate) <br> <br>End Sub <br> <br>Private Sub slVolume_Change() <br>     <br>    'Set the volume on the slider <br>    If Not g_objMediaControl Is Nothing Then <br>        g_objBasicAudio.Volume = slVolume.Value <br>    End If <br>     <br>End Sub <br> <br>Private Sub slBalance_Change() <br>   <br>    'Set the balance using the slider <br>    If Not g_objMediaControl Is Nothing Then <br>        g_objBasicAudio.Balance = (slBalance.Value * -1) <br>    End If <br>     <br>End Sub <br> <br>Private Sub txtStart_KeyDown(KeyCode As Integer, Shift As Integer) <br> <br>    ' handle user input to change the start position <br>    If KeyCode = vbKeyReturn Then <br>        If g_objMediaPosition Is Nothing Then <br>            Exit Sub <br>        ElseIf CDbl(txtStart.Text) &gt; g_dblRunLength Then <br>            MsgBox "Specified position invalid: re-enter new position." <br>        ElseIf CDbl(txtStart.Text) &lt; 0 Then <br>            MsgBox "Specified position invalid: re-enter new position." <br>        ElseIf CStr(txtStart.Text) &lt;&gt; "" Then <br>            g_dblStartPosition = CDbl(txtStart.Text) <br>            g_objMediaPosition.CurrentPosition = g_dblStartPosition <br>        End If <br>    End If <br> <br>End Sub <br> <br>Private Sub txtRate_KeyDown(KeyCode As Integer, Shift As Integer) <br>     <br>    ' ActiveMovie VB sample <br>    ' handle user updates to the Rate value <br>    If KeyCode = vbKeyReturn Then <br>        If g_objMediaPosition Is Nothing Then <br>            Exit Sub <br>        ElseIf CDbl(txtRate.Text) &lt; 0# Then <br>            MsgBox "Negative values invalid: re-enter value between 0 and 2.0" <br>        ElseIf CStr(txtRate.Text) &lt;&gt; "" Then <br>            g_dblRate = CDbl(txtRate.Text) <br>            g_objMediaPosition.Rate = g_dblRate <br>        End If <br>    End If <br>     <br>End Sub <br> <br>Private Sub Timer1_Timer() <br>    'Retrieve the Elapsed Time and <br>    'display it in the corresponding <br>    'textbox. <br>    Dim Dbl As Double <br> <br>    If g_fVideoRun = True Then <br>        Dbl = g_objMediaPosition.CurrentPosition <br>        If Dbl &lt; g_dblRunLength Then <br>            txtElapsed.Text = CStr(Dbl) <br>        Else <br>            txtElapsed.Text = CStr(g_dblRunLength) <br>        End If <br>    End If <br> <br>End Sub <br> <br>Private Sub Toolbar1_ButtonClick(ByVal Button As Button) <br>' handle buttons on the toolbar <br>' buttons 1, 3 and 5 are defined; 2 and 4 are separators <br>' all ActiveMovie objects are defined only if the user <br>' has already selected a filename and initialized the objects <br> <br>    ' if the objects aren't defined, avoid errors <br>    If g_objMediaControl Is Nothing Then <br>        Exit Sub <br>    End If <br>     <br>    If Button.Index = 1 Then 'PLAY <br>        'Invoke the MediaControl Run() method <br>        'and play the video through the predefined <br>        'filter graph. <br>         <br>        ' Use specified starting position <br>        If g_objMediaPosition.CurrentPosition &lt; g_dblStartPosition Then <br>            g_objMediaPosition.CurrentPosition = g_dblStartPosition <br>        End If <br>     <br>        g_objMediaControl.Run <br>        g_fVideoRun = True <br>             <br>    ElseIf Button.Index = 3 Then  'PAUSE <br>        'Invoke the MediaControl Pause() method <br>        'and pause the video that is being <br>        'displayed through the predefined <br>        'filter graph. <br>     <br>        g_objMediaControl.Pause <br>        g_fVideoRun = False <br>         <br>    ElseIf Button.Index = 5 Then  'STOP <br>     <br>        'Invoke the MediaControl Stop() method <br>        'and stop the video that is being <br>        'displayed through the predefined <br>        'filter graph. <br>     <br>        g_objMediaControl.Stop <br>        g_fVideoRun = False <br>        ' reset to the beginning of the video <br>        g_objMediaPosition.CurrentPosition = 0 <br>        txtElapsed.Text = "0.0" <br>         <br>    End If <br>End Sub <br> <br>Private Sub cleanup() <br>     <br>    ' clean up memory <br>    If Not g_objMediaControl Is Nothing Then <br>        g_objMediaControl.Stop <br>        Debug.Print "Setting owner to NULL" + Chr(13) <br>        g_objVideoWindow.Owner = 0          'sets the Owner to NULL <br>    End If <br>    Set g_objVideoWindow = Nothing <br>    Set g_objMediaControl = Nothing <br>    Set g_objMediaPosition = Nothing <br>    Set g_objBasicAudio = Nothing <br>    Set g_objBasicVideo = Nothing <br> <br>End Sub <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
