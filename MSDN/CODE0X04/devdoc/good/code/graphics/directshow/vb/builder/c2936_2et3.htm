<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SELPIN.FRM</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2937"></a>SELPIN.FRM</h2>
<pre><code>VERSION 5.00 <br>Begin VB.Form frmSelectPin  <br>   Caption         =   "Connect to Pin" <br>   ClientHeight    =   3210 <br>   ClientLeft      =   4890 <br>   ClientTop       =   4920 <br>   ClientWidth     =   6270 <br>   LinkTopic       =   "Form2" <br>   PaletteMode     =   1  'UseZOrder <br>   ScaleHeight     =   3210 <br>   ScaleWidth      =   6270 <br>   Begin VB.ListBox listPins  <br>      Height          =   1425 <br>      Left            =   3360 <br>      TabIndex        =   7 <br>      Top             =   360 <br>      Width           =   2655 <br>   End <br>   Begin VB.ListBox listFilters  <br>      Height          =   1425 <br>      Left            =   240 <br>      TabIndex        =   5 <br>      Top             =   360 <br>      Width           =   2655 <br>   End <br>   Begin VB.CommandButton Cancel  <br>      Cancel          =   -1  'True <br>      Caption         =   "Cancel" <br>      Height          =   375 <br>      Left            =   3360 <br>      TabIndex        =   4 <br>      Top             =   2640 <br>      Width           =   975 <br>   End <br>   Begin VB.CommandButton OK  <br>      Caption         =   "OK" <br>      Default         =   -1  'True <br>      Height          =   375 <br>      Left            =   1920 <br>      TabIndex        =   3 <br>      Top             =   2640 <br>      Width           =   975 <br>   End <br>   Begin VB.Label Label2  <br>      Caption         =   "Pins" <br>      Height          =   252 <br>      Left            =   3240 <br>      TabIndex        =   6 <br>      Top             =   120 <br>      Width           =   492 <br>   End <br>   Begin VB.Label VendorInfoLabel  <br>      Caption         =   "Vendor Info:" <br>      Height          =   252 <br>      Left            =   120 <br>      TabIndex        =   2 <br>      Top             =   2160 <br>      Width           =   972 <br>   End <br>   Begin VB.Label VendorInfo  <br>      Height          =   252 <br>      Left            =   1320 <br>      TabIndex        =   1 <br>      Top             =   2160 <br>      Visible         =   0   'False <br>      Width           =   2772 <br>   End <br>   Begin VB.Label Label1  <br>      Caption         =   "Filters" <br>      Height          =   255 <br>      Left            =   120 <br>      TabIndex        =   0 <br>      Top             =   120 <br>      Width           =   495 <br>   End <br>End <br>Attribute VB_Name = "frmSelectPin" <br>Attribute VB_GlobalNameSpace = False <br>Attribute VB_Creatable = False <br>Attribute VB_PredeclaredId = True <br>Attribute VB_Exposed = False <br>' create filter components to connect filter pins <br>Public OtherDir As Long <br>Public g_objFI As IFilterInfo <br>Public g_objPI As IPinInfo <br>Public g_objMC As IMediaControl <br>Public bOK As Boolean <br> <br>Private Sub Cancel_Click() <br>' cancel was clicked, so no pin connection is made <br>    bOK = False <br>    Hide <br>End Sub <br> <br>Private Sub listFilters_Click() <br>' when the user clicks on a specific filter in the filter graph, this creates the <br>' list of pins for that filter in the pin listbox <br>    Dim pfilter As IFilterInfo <br>    For Each pfilter In g_objMC.FilterCollection <br>        If pfilter.Name = listFilters.Text Then <br>            ' display the information and pins for the selected filter <br>            Set g_objFI = pfilter  ' global FilterInfo object <br>            VendorInfo.Caption = pfilter.VendorInfo <br>            listPins.Clear <br>            Dim pin As IPinInfo <br>            For Each pin In pfilter.Pins <br>                Dim pinOther As IPinInfo <br>                On Error Resume Next <br>                Set pinOther = pin.ConnectedTo <br>                If Err.Number &lt;&gt; 0 Then <br>                    If pin.Direction &lt;&gt; OtherDir Then <br>                        listPins.AddItem pin.Name <br>                    End If <br>                End If <br>            Next pin <br>        End If <br>    Next pfilter <br>    listPins.ListIndex = 0 <br>End Sub <br> <br> <br>Private Sub Form_Load() <br>' fill the filters listbox with all filters in the current filter graph <br>    RefreshFilters <br>End Sub <br> <br> <br> <br>Public Sub RefreshFilters() <br>' fill the filters listbox with all filters in the current filter graph <br>    listFilters.Clear <br>    Dim filter As IFilterInfo <br>    For Each filter In g_objMC.FilterCollection <br>        Dim pin As IPinInfo <br>        Dim pinOther As IPinInfo <br>        For Each pin In filter.Pins <br>            On Error Resume Next <br>            Set pinOther = pin.ConnectedTo <br>            If Err.Number &lt;&gt; 0 Then <br>                If pin.Direction &lt;&gt; OtherDir Then <br>                    listFilters.AddItem filter.Name <br>                    Exit For <br>                End If <br>            End If <br>        Next pin <br>    Next filter <br>    listFilters.ListIndex = 0 <br>End Sub <br> <br>Private Sub OK_Click() <br>' connect the selected pins, if possible. if no connection is possible, the pin <br>' selection box closes and the program continues normally. <br>    Dim pin As IPinInfo <br>    For Each pin In g_objFI.Pins <br>        If pin.Name = listPins.Text Then <br>            Set g_objPI = pin <br>            bOK = True <br>            Exit For <br>        End If <br>    Next pin <br>    Hide <br>End Sub <br> <br>Private Sub listPins_Click() <br>' when a pin is selected, store it in the global pin object <br>  Dim pPin As IPinInfo <br>  For Each pPin In g_objFI.Pins <br>    If pPin.Name = listPins.Text Then <br>      Set SelPin = pPin <br>    End If <br>  Next pPin <br>End Sub <br> <br> <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
