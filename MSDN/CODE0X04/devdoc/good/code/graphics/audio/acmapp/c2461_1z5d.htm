<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACMAPP.H</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2461"></a>ACMAPP.H</h2>
<pre><code>//==========================================================================; <br>// <br>//  THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY <br>//  KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE <br>//  IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR <br>//  PURPOSE. <br>// <br>//  Copyright 1992 - 1998 Microsoft Corporation.  All Rights Reserved. <br>// <br>//--------------------------------------------------------------------------; <br>// <br>//  acmapp.h <br>// <br>//  Description: <br>//      This is a sample application that demonstrates how to use the  <br>//      Audio Compression Manager API's in Windows. This application is <br>//      also useful as an ACM CODEC driver test. <br>// <br>// <br>//==========================================================================; <br> <br>#ifndef _INC_ACMAPP <br>#define _INC_ACMAPP                 // #defined if file has been included <br> <br>#ifndef RC_INVOKED <br>#pragma pack(1)                     // assume byte packing throughout <br>#endif <br> <br>#ifndef EXTERN_C <br>#ifdef __cplusplus <br>    #define EXTERN_C extern "C" <br>#else <br>    #define EXTERN_C extern  <br>#endif <br>#endif <br> <br>#ifdef __cplusplus <br>extern "C"                          // assume C declarations for C++ <br>{ <br>#endif <br> <br> <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br>// <br>//  Application Version Information: <br>// <br>// <br>// <br>// <br>//  NOTE! all string resources that will be used in app.rcv for the <br>//  version resource information *MUST* have an explicit \0 terminator! <br>// <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br> <br>#if WINVER &lt; 0x0400 <br> <br>#define APP_VERSION_MAJOR           3 <br>#define APP_VERSION_MINOR           50 <br>#define APP_VERSION_BUILD           0 <br> <br>#ifdef DEBUG <br>#define APP_ABOUTBOX_DESCRIPTION    "ACM Sample Application version 3.50 (debug)" <br>#else <br>#define APP_ABOUTBOX_DESCRIPTION    "ACM Sample Application version 3.50" <br>#endif <br>#define APP_ABOUTBOX_PRODUCTNAME    "Microsoft Windows NT" <br> <br>#define APP_VERSION_STRING_RC       "Version 3.50\0" <br>#define APP_VERSION_PRODUCTNAME_RC  "Microsoft Windows NT\0" <br> <br>#else <br> <br>#define APP_VERSION_MAJOR           4 <br>#define APP_VERSION_MINOR           0 <br>#define APP_VERSION_BUILD           0 <br> <br>#ifdef DEBUG <br>#define APP_ABOUTBOX_DESCRIPTION    "ACM Sample Application version 4.00 (debug)" <br>#else <br>#define APP_ABOUTBOX_DESCRIPTION    "ACM Sample Application version 4.00" <br>#endif <br>#define APP_ABOUTBOX_PRODUCTNAME    "Microsoft Windows" <br> <br>#define APP_VERSION_STRING_RC       "Version 4.00\0" <br>#define APP_VERSION_PRODUCTNAME_RC  "Microsoft Windows\0" <br> <br>#endif  // WINVER <br> <br> <br>#define APP_VERSION_COMPANYNAME_RC  "Microsoft Corporation\0" <br>#define APP_VERSION_DESCRIPTION_RC  "ACM Sample Application\0" <br>#ifdef WIN32 <br>#define APP_VERSION_NAME_RC         "acmapp32.exe\0" <br>#else <br>#define APP_VERSION_NAME_RC         "acmapp16.exe\0" <br>#endif <br>#define APP_VERSION_COPYRIGHT_RC    "Copyright 1992 - 1998 Microsoft Corp.\0" <br> <br> <br> <br>// <br>// <br>// <br>#ifndef SIZEOF_WAVEFORMATEX <br>#define SIZEOF_WAVEFORMATEX(pwfx)   ((WAVE_FORMAT_PCM==(pwfx)-&gt;wFormatTag)?sizeof(PCMWAVEFORMAT):(sizeof(WAVEFORMATEX)+(pwfx)-&gt;cbSize)) <br>#endif <br> <br> <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br>// <br>//  misc defines for misc sizes and things... <br>// <br>// <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br> <br>// <br>//  bilingual. this allows the same identifier to be used in resource files <br>//  and code without having to decorate the id in your code. <br>// <br>#ifdef RC_INVOKED <br>    #define RCID(id)    id <br>#else <br>    #define RCID(id)    MAKEINTRESOURCE(id) <br>#endif <br> <br> <br>// <br>//  misc. defines <br>// <br>#define APP_MAX_APP_NAME_CHARS      30 <br>#define APP_MAX_APP_NAME_BYTES      (APP_MAX_APP_NAME_CHARS * sizeof(TCHAR)) <br>#define APP_MAX_STRING_RC_CHARS     512 <br>#define APP_MAX_STRING_RC_BYTES     (APP_MAX_STRING_RC_CHARS * sizeof(TCHAR)) <br>#define APP_MAX_STRING_ERROR_CHARS  512 <br>#define APP_MAX_STRING_ERROR_BYTES  (APP_MAX_STRING_ERROR_CHARS * sizeof(TCHAR)) <br> <br>#define APP_MAX_STRING_CHARS        128 <br>#define APP_MAX_STRING_BYTES        (APP_MAX_STRING_CHARS * sizeof(TCHAR)) <br>#define APP_MAX_NUMBER_CHARS        144 <br>#define APP_MAX_NUMBER_BYTES        (APP_MAX_NUMBER_CHARS * sizeof(TCHAR)) <br> <br>#define APP_MAX_FILE_PATH_CHARS     144 <br>#define APP_MAX_FILE_PATH_BYTES     (APP_MAX_FILE_PATH_CHARS * sizeof(TCHAR)) <br>#define APP_MAX_FILE_TITLE_CHARS    APP_MAX_FILE_PATH_CHARS <br>#define APP_MAX_FILE_TITLE_BYTES    (APP_MAX_FILE_TITLE_CHARS * sizeof(TCHAR)) <br> <br>#define APP_MAX_STRING_INT_CHARS    18 <br>#define APP_MAX_STRING_INT_BYTES    (APP_MAX_STRING_INT_CHARS * sizeof(TCHAR)) <br> <br>#define APP_MAX_EXT_DEFAULT_CHARS   4 <br>#define APP_MAX_EXT_DEFAULT_BYTES   (APP_MAX_EXT_DEFAULT_CHARS * sizeof(TCHAR)) <br>#define APP_MAX_EXT_FILTER_CHARS    256 <br>#define APP_MAX_EXT_FILTER_BYTES    (APP_MAX_EXT_FILTER_CHARS * sizeof(TCHAR)) <br> <br>#define APP_WINDOW_XOFFSET          CW_USEDEFAULT <br>#define APP_WINDOW_YOFFSET          CW_USEDEFAULT <br>#define APP_WINDOW_WIDTH            460             // CW_USEDEFAULT <br>#define APP_WINDOW_HEIGHT           400             // CW_USEDEFAULT <br> <br> <br>// <br>//  resource defines... <br>// <br>#define ICON_APP                    RCID(10) <br>#define ACCEL_APP                   RCID(15) <br> <br> <br>// <br>//  the application menu... <br>// <br>//  NOTE! for our Edit menu, we use the following defines from windows.h-- <br>//  so don't reuse these defines for menu items! <br>// <br>//      #define WM_CUT      0x0300 <br>//      #define WM_COPY     0x0301 <br>//      #define WM_PASTE    0x0302 <br>//      #define WM_CLEAR    0x0303 <br>//      #define WM_UNDO     0x0304 <br>// <br>#define MENU_APP                        RCID(20) <br>#define APP_MENU_ITEM_FILE              0 <br>#define IDM_FILE_NEW                    1100 <br>#define IDM_FILE_OPEN                   1101 <br>#define IDM_FILE_SAVE                   1102 <br>#define IDM_FILE_SAVEAS                 1103 <br>#define IDM_FILE_SNDPLAYSOUND_PLAY      1104 <br>#define IDM_FILE_SNDPLAYSOUND_STOP      1105 <br>#define IDM_FILE_CONVERT                1106 <br>#define IDM_FILE_CONVERT_ALL            1107 <br>#define IDM_FILE_ABOUT                  1109 <br>#define IDM_FILE_EXIT                   1110 <br> <br>#define APP_MENU_ITEM_EDIT              1 <br>#define IDM_EDIT_SELECTALL              1200 <br> <br>#define APP_MENU_ITEM_VIEW              2 <br>#define IDM_VIEW_SYSTEMINFO             1300 <br>#define IDM_VIEW_ACM_DRIVERS            1301 <br> <br>#define APP_MENU_ITEM_PLAYER            3 <br>#define IDM_PLAYRECORD                  1400 <br> <br>#define APP_MENU_ITEM_OPTIONS           4 <br>#define IDM_OPTIONS_WAVEINDEVICE        1500 <br>#define IDM_OPTIONS_WAVEOUTDEVICE       1501 <br>#define IDM_OPTIONS_AUTOOPEN            1505 <br>#define IDM_OPTIONS_DEBUGLOG            1506 <br>#define IDM_OPTIONS_FONT                1509 <br> <br>#define IDM_UPDATE                      1600 <br> <br> <br>// <br>//  the main window control id's... <br>// <br>#define IDD_ACMAPP_EDIT_DISPLAY                 200 <br> <br> <br>// <br>//  misc dlg boxes... <br>// <br>#define DLG_ABOUT                               RCID(50) <br>#define IDC_STATIC                              -1 <br>#define IDD_ABOUT_VERSION_OS                    100 <br>#define IDD_ABOUT_VERSION_PLATFORM              101 <br> <br>#define DLG_AADRAGDROP                          RCID(55) <br> <br>#define DLG_AADETAILS                           RCID(70) <br>#define IDD_AADETAILS_EDIT_DETAILS              100 <br> <br>#define DLG_AADRIVERS                           RCID(75) <br>#define IDD_AADRIVERS_STATIC_POSITION           100 <br>#define IDD_AADRIVERS_LIST_DRIVERS              101 <br>#define IDD_AADRIVERS_BTN_DETAILS               102 <br>#define IDD_AADRIVERS_BTN_FORMATS               103 <br>#define IDD_AADRIVERS_BTN_FILTERS               104 <br>#define IDD_AADRIVERS_BTN_ABOUT                 105 <br>#define IDD_AADRIVERS_BTN_CONFIG                106 <br>#define IDD_AADRIVERS_BTN_ABLE                  107 <br>#define IDD_AADRIVERS_BTN_TOTOP                 108 <br> <br>#define DLG_AADRIVERFORMATS                     RCID(80) <br>#define IDD_AADRIVERFORMATS_STATIC_POSITION     100 <br>#define IDD_AADRIVERFORMATS_LIST_FORMATS        101 <br>#define IDD_AADRIVERFORMATS_BTN_DETAILS         102 <br> <br> <br>#define DLG_AAWAVEDEVICE                        RCID(85) <br>#define IDD_AAWAVEDEVICE_COMBO_DEVICE           100 <br>#define IDD_AAWAVEDEVICE_EDIT_CAPABILITIES      101 <br> <br> <br>#define DLG_AACHOOSER                           RCID(90) <br>#define IDD_AACHOOSER_TXT_FILE_INPUT            100 <br>#define IDD_AACHOOSER_TXT_FORMAT_INPUT          101 <br>#define IDD_AACHOOSER_EDIT_FILE_OUTPUT          110 <br>#define IDD_AACHOOSER_BTN_BROWSE                111 <br>#define IDD_AACHOOSER_COMBO_DRIVER              120 <br>#define IDD_AACHOOSER_BTN_PROPERTIES            121 <br>#define IDD_AACHOOSER_TXT_FORMAT                130 <br>#define IDD_AACHOOSER_BTN_FORMAT                131 <br>#define IDD_AACHOOSER_BTN_FORMAT_OPTIONS        132 <br>#define IDD_AACHOOSER_CHECK_FILTER              140 <br>#define IDD_AACHOOSER_TXT_FILTER                141 <br>#define IDD_AACHOOSER_BTN_FILTER                142 <br>#define IDD_AACHOOSER_BTN_FILTER_OPTIONS        143 <br>#define IDD_AACHOOSER_CHECK_NONREALTIME         150 <br>#define IDD_AACHOOSER_CHECK_ASYNC               151 <br>#define IDD_AACHOOSER_TXT_TIME                  160 <br>#define IDD_AACHOOSER_SCROLL_TIME               161 <br>#define IDD_AACHOOSER_EDIT_DETAILS              170 <br> <br> <br>#define DLG_AAFORMATENUM                        RCID(91) <br>#define IDD_AAFORMATENUM_CHECK_CONVERT          100 <br>#define IDD_AAFORMATENUM_CHECK_SUGGEST          101 <br>#define IDD_AAFORMATENUM_CHECK_HARDWARE         102 <br>#define IDD_AAFORMATENUM_CHECK_INPUT            103 <br>#define IDD_AAFORMATENUM_CHECK_OUTPUT           104 <br>#define IDD_AAFORMATENUM_CHECK_WFORMATTAG       105 <br>#define IDD_AAFORMATENUM_EDIT_WFORMATTAG        106 <br>#define IDD_AAFORMATENUM_CHECK_NCHANNELS        107 <br>#define IDD_AAFORMATENUM_EDIT_NCHANNELS         108 <br>#define IDD_AAFORMATENUM_CHECK_NSAMPLESPERSEC   109 <br>#define IDD_AAFORMATENUM_EDIT_NSAMPLESPERSEC    110 <br>#define IDD_AAFORMATENUM_CHECK_WBITSPERSAMPLE   111 <br>#define IDD_AAFORMATENUM_EDIT_WBITSPERSAMPLE    112 <br>#define IDD_AAFORMATENUM_EDIT_NAVGBYTESPERSEC   113 <br>#define IDD_AAFORMATENUM_EDIT_NBLOCKALIGN       114 <br>#define IDD_AAFORMATENUM_EDIT_EXTRA             115 <br> <br>#define DLG_AAFILTERENUM                        RCID(92) <br>#define IDD_AAFILTERENUM_CHECK_DWFILTERTAG      100 <br>#define IDD_AAFILTERENUM_EDIT_DWFILTERTAG       101 <br> <br> <br>#define DLG_AAPROPERTIES                        RCID(93) <br>#define IDD_AAPROPERTIES_COMBO_SOURCE           100 <br>#define IDD_AAPROPERTIES_BTN_SOURCE             101 <br>#define IDD_AAPROPERTIES_COMBO_DESTINATION      102 <br>#define IDD_AAPROPERTIES_BTN_DESTINATION        103 <br> <br> <br>#define DLG_AAFORMATSTYLE                               RCID(94) <br>#define IDD_AAFORMATSTYLE_CHECK_SHOWHELP                100 <br>#define IDD_AAFORMATSTYLE_CHECK_ENABLEHOOK              101 <br>#define IDD_AAFORMATSTYLE_CHECK_ENABLETEMPLATE          102 <br>#define IDD_AAFORMATSTYLE_CHECK_ENABLETEMPLATEHANDLE    103 <br>#define IDD_AAFORMATSTYLE_CHECK_INITTOWFXSTRUCT         104 <br> <br>#define DLG_AAFILTERSTYLE                               RCID(95) <br>#define IDD_AAFILTERSTYLE_CHECK_SHOWHELP                100 <br>#define IDD_AAFILTERSTYLE_CHECK_ENABLEHOOK              101 <br>#define IDD_AAFILTERSTYLE_CHECK_ENABLETEMPLATE          102 <br>#define IDD_AAFILTERSTYLE_CHECK_ENABLETEMPLATEHANDLE    103 <br>#define IDD_AAFILTERSTYLE_CHECK_INITTOFILTERSTRUCT      104 <br> <br> <br>#define DLG_AAFORMATCHOOSE_TEMPLATE             RCID(98) <br>#define DLG_AAFILTERCHOOSE_TEMPLATE             RCID(99) <br> <br> <br> <br>#define DLG_AACONVERT                           RCID(100) <br>#define IDD_AACONVERT_TXT_INFILEPATH            100 <br>#define IDD_AACONVERT_TXT_OUTFILEPATH           101 <br>#define IDD_AACONVERT_TXT_STATUS                102 <br> <br>#define DLG_AAPLAYRECORD                        RCID(110) <br>#define IDD_AAPLAYRECORD_BTN_PLAY               100 <br>#define IDD_AAPLAYRECORD_BTN_PAUSE              101 <br>#define IDD_AAPLAYRECORD_BTN_STOP               102 <br>#define IDD_AAPLAYRECORD_BTN_START              103 <br>#define IDD_AAPLAYRECORD_BTN_END                104 <br>#define IDD_AAPLAYRECORD_BTN_RECORD             105 <br>#define IDD_AAPLAYRECORD_SCROLL_POSITION        110 <br>#define IDD_AAPLAYRECORD_TXT_POSITION           115 <br>#define IDD_AAPLAYRECORD_EDIT_COMMAND           120 <br>#define IDD_AAPLAYRECORD_EDIT_RESULT            121 <br> <br> <br> <br> <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br>// <br>//  string resources <br>// <br>// <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br> <br>#define IDS_APP_NAME                100 <br>#define IDS_FILE_UNTITLED           101 <br> <br>#define IDS_OFN_EXT_DEF             125 <br>#define IDS_OFN_EXT_FILTER          126 <br> <br>#define IDS_ERROR_ACM_NOT_PRESENT   500 <br>#define IDS_ERROR_ACM_TOO_OLD       501 <br> <br>#define IDS_ERROR_OPEN_FAILED       550 <br> <br> <br> <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br>// <br>// <br>// <br>// <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br> <br>// <br>// <br>// <br>// <br>typedef struct tACMAPPFILEDESC <br>{ <br>    DWORD           fdwState; <br> <br>    TCHAR           szFileTitle[APP_MAX_FILE_TITLE_CHARS]; <br>    TCHAR           szFilePath[APP_MAX_FILE_PATH_CHARS]; <br>     <br>    DWORD           cbFileSize; <br>    UINT            uDosChangeDate; <br>    UINT            uDosChangeTime; <br>    DWORD           fdwFileAttributes; <br> <br>    LPWAVEFORMATEX  pwfx; <br>    UINT            cbwfx; <br> <br>    DWORD           dwDataBytes; <br>    DWORD           dwDataSamples; <br> <br>} ACMAPPFILEDESC, *PACMAPPFILEDESC; <br> <br>// <br>//  ACMAPPINST.fdwState flags <br>// <br>#define ACMAPPFILEDESC_STATEF_MODIFIED  0x80000000L <br> <br> <br> <br> <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br>// <br>//  APPINIT.C -- Public helper functions <br>// <br>// <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br> <br>LRESULT FNGLOBAL AppCreate <br>( <br>    HWND                    hwnd, <br>    LPCREATESTRUCT          pcs <br>); <br> <br>LRESULT FNGLOBAL AppQueryEndSession <br>( <br>    HWND                    hwnd <br>); <br> <br>LRESULT FNGLOBAL AppEndSession <br>( <br>    HWND                    hwnd, <br>    BOOL                    fEndSession <br>); <br> <br>LRESULT FNGLOBAL AppClose <br>( <br>    HWND                    hwnd <br>); <br> <br>HWND FNGLOBAL AppInit <br>( <br>    HINSTANCE               hinst, <br>    HINSTANCE               hinstPrev, <br>    LPTSTR                  pszCmdLine, <br>    int                     nCmdShow <br>); <br> <br>int FNGLOBAL AppExit <br>( <br>    HINSTANCE               hinst, <br>    int                     nResult <br>); <br> <br> <br>LRESULT FNGLOBAL AppGetWindowsVersion <br>( <br>    PTSTR                   pszEnvironment, <br>    PTSTR                   pszPlatform <br>); <br> <br>LRESULT FNGLOBAL AppWinIniChange <br>( <br>    HWND                    hwnd, <br>    LPCTSTR                 pszSection <br>); <br> <br>HFONT FNGLOBAL AppChooseFont <br>( <br>    HWND                    hwnd, <br>    HFONT                   hFont, <br>    PLOGFONT                plf <br>); <br> <br> <br>BOOL FNEXPORT AboutDlgProc <br>( <br>    HWND                    hwnd, <br>    UINT                    uMsg, <br>    WPARAM                  wParam, <br>    LPARAM                  lParam <br>); <br> <br> <br>BOOL FNGLOBAL AppProfileWriteBytes <br>( <br>    PTSTR                   pszSection, <br>    PTSTR                   pszKey, <br>    LPBYTE                  pbStruct, <br>    UINT                    cbStruct <br>); <br> <br>BOOL FNGLOBAL AppProfileReadBytes <br>( <br>    PTSTR                   pszSection, <br>    PTSTR                   pszKey, <br>    LPBYTE                  pbStruct, <br>    UINT                    cbStruct <br>); <br> <br> <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br>// <br>//  APP.C -- Public helper functions <br>// <br>// <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br> <br>int FNCGLOBAL AppMsgBox <br>( <br>    HWND                    hwnd, <br>    UINT                    fuStyle, <br>    PTSTR                   pszFormat, <br>    ... <br>); <br> <br>int FNCGLOBAL AppMsgBoxId <br>( <br>    HWND                    hwnd, <br>    UINT                    fuStyle, <br>    UINT                    uIdsFormat, <br>    ... <br>); <br> <br>void FNGLOBAL AppHourGlass <br>( <br>    BOOL                    fHourGlass <br>); <br> <br>BOOL FNGLOBAL AppYield <br>( <br>    HWND                    hwnd, <br>    BOOL                    fIsDialog <br>); <br> <br>BOOL FNGLOBAL AppTitle <br>( <br>    HWND                    hwnd, <br>    PTSTR                   pszFileTitle <br>); <br> <br>int FNCGLOBAL AppSetWindowText <br>( <br>    HWND                    hwnd, <br>    PTSTR                   pszFormat, <br>    ... <br>); <br> <br>int FNCGLOBAL AppSetWindowTextId <br>( <br>    HWND                    hwnd, <br>    UINT                    uIdsFormat, <br>    ... <br>); <br> <br>BOOL FNGLOBAL AppFormatBigNumber <br>( <br>    LPTSTR                  pszNumber, <br>    DWORD                   dw <br>); <br> <br>BOOL FNGLOBAL AppFormatDosDateTime <br>( <br>    LPTSTR                  pszDateTime, <br>    UINT                    uDosDate, <br>    UINT                    uDosTime <br>); <br> <br>void FNCGLOBAL AcmAppDebugLog <br>( <br>    PTSTR                   pszFormat, <br>    ... <br>); <br> <br>int FNCGLOBAL MEditPrintF <br>( <br>    HWND                    hedit, <br>    PTSTR                   pszFormat, <br>    ... <br>); <br> <br>BOOL FNGLOBAL AppGetFileTitle <br>( <br>    PTSTR                   pszFilePath, <br>    PTSTR                   pszFileTitle <br>); <br> <br>BOOL FNGLOBAL AppGetFileName <br>( <br>    HWND                    hwnd, <br>    PTSTR                   pszFilePath, <br>    PTSTR                   pszFileTitle, <br>    UINT                    fuFlags <br>); <br> <br>BOOL FNGLOBAL AppFileNew <br>( <br>    HWND                    hwnd, <br>    PACMAPPFILEDESC         paafd, <br>    BOOL                    fCreate <br>); <br> <br> <br>// <br>//  fuFlags for AppGetFileName()... <br>// <br>#define APP_GETFILENAMEF_OPEN       0x0000 <br>#define APP_GETFILENAMEF_SAVE       0x0001 <br> <br> <br>BOOL FNGLOBAL AppFileSave <br>( <br>    HWND                    hwnd, <br>    PACMAPPFILEDESC         paafd, <br>    BOOL                    fSaveAs <br>); <br> <br> <br>LRESULT FNEXPORT AppWndProc <br>( <br>    HWND                    hwnd, <br>    UINT                    uMsg, <br>    WPARAM                  wParam, <br>    LPARAM                  lParam <br>); <br> <br> <br> <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br>// <br>//  file manipulation functions <br>// <br>// <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br> <br>// <br>// <br>// <br>// <br>#ifndef WIN32 <br>DWORD FNGLOBAL DosGetFileAttributes <br>( <br>    LPTSTR                  pszFilePath <br>); <br> <br>#ifndef FILE_ATTRIBUTE_READONLY <br>#define FILE_ATTRIBUTE_READONLY         0x00000001   <br>#define FILE_ATTRIBUTE_HIDDEN           0x00000002   <br>#define FILE_ATTRIBUTE_SYSTEM           0x00000004   <br>#define FILE_ATTRIBUTE_DIRECTORY        0x00000010   <br>#define FILE_ATTRIBUTE_ARCHIVE          0x00000020   <br>#define FILE_ATTRIBUTE_NORMAL           0x00000080   <br>#define FILE_ATTRIBUTE_TEMPORARY        0x00000100   <br>#define FILE_ATTRIBUTE_ATOMIC_WRITE     0x00000200   <br>#define FILE_ATTRIBUTE_XACTION_WRITE    0x00000400   <br>#endif <br>#endif <br> <br>MMRESULT FNGLOBAL AcmAppFormatChoose <br>( <br>    HWND                    hwnd, <br>    LPWAVEFORMATEX          pwfx, <br>    UINT                    cbwfx, <br>    DWORD                   fdwStyle <br>); <br> <br>BOOL FNGLOBAL AcmAppFileSaveModified <br>( <br>    HWND                    hwnd, <br>    PACMAPPFILEDESC         paafd <br>); <br> <br>BOOL FNGLOBAL AcmAppFileNew <br>( <br>    HWND                    hwnd, <br>    PACMAPPFILEDESC         paafd <br>); <br> <br>BOOL FNGLOBAL AcmAppFileOpen <br>( <br>    HWND                    hwnd, <br>    PACMAPPFILEDESC         paafd <br>); <br> <br>BOOL FNGLOBAL AcmAppFileSave <br>( <br>    HWND                    hwnd, <br>    PACMAPPFILEDESC         paafd, <br>    PTSTR                   pszFilePath, <br>    PTSTR                   pszFileTitle, <br>    UINT                    fuSave <br>); <br> <br> <br> <br>BOOL FNGLOBAL AcmAppFileConvert <br>( <br>    HWND                    hwnd, <br>    PACMAPPFILEDESC         paafd <br>); <br> <br>BOOL FNGLOBAL AcmAppMultiThreadedConvertAll <br>( <br>    HWND                    hwnd, <br>    PACMAPPFILEDESC         paafd <br>); <br> <br>BOOL FNGLOBAL AcmAppFileFilter <br>( <br>    HWND                    hwnd, <br>    PACMAPPFILEDESC         paafd <br>); <br> <br> <br>BOOL FNGLOBAL AcmAppDisplayFileProperties <br>( <br>    HWND                    hedit, <br>    PACMAPPFILEDESC         paafd <br>); <br> <br> <br> <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br>// <br>// <br>// <br>// <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br> <br>BOOL FNEXPORT AcmAppDriversDlgProc <br>( <br>    HWND                    hwnd, <br>    UINT                    uMsg, <br>    WPARAM                  wParam, <br>    LPARAM                  lParam <br>); <br> <br> <br>BOOL FNGLOBAL AcmAppGetFormatDescription <br>( <br>    LPWAVEFORMATEX          pwfx, <br>    LPTSTR                  pszFormatTag, <br>    LPTSTR                  pszFormat <br>); <br> <br>BOOL FNGLOBAL AcmAppGetFilterDescription <br>( <br>    LPWAVEFILTER            pwfltr, <br>    LPTSTR                  pszFilterTag, <br>    LPTSTR                  pszFilter <br>); <br> <br> <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br>// <br>// <br>// <br>// <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br> <br>BOOL FNEXPORT AcmAppSystemInfoDlgProc <br>( <br>    HWND                    hwnd, <br>    UINT                    uMsg, <br>    WPARAM                  wParam, <br>    LPARAM                  lParam <br>); <br> <br> <br> <br> <br>BOOL FNEXPORT AcmAppPlayRecord <br>( <br>    HWND                    hwnd, <br>    UINT                    uMsg, <br>    WPARAM                  wParam, <br>    LPARAM                  lParam <br>); <br> <br> <br>BOOL FNEXPORT AcmAppWaveDeviceDlgProc <br>( <br>    HWND                    hwnd, <br>    UINT                    uMsg, <br>    WPARAM                  wParam, <br>    LPARAM                  lParam <br>); <br> <br> <br>BOOL FNGLOBAL AcmAppGetErrorString <br>( <br>    MMRESULT                mmr, <br>    LPTSTR                  pszError <br>); <br> <br>// <br>// <br>// <br>#define WM_ACMAPP_ACM_NOTIFY        (WM_USER + 100) <br> <br> <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br>// <br>//  misc functions <br>// <br>// <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br> <br>BOOL FNGLOBAL AcmAppChooseFont <br>( <br>    HWND                    hwnd <br>); <br> <br> <br> <br>// <br>// <br>// <br>// <br>typedef struct tAACONVERTDESC <br>{ <br>    HACMDRIVERID        hadid; <br>    HACMDRIVER          had; <br>    HACMSTREAM          has; <br>    DWORD               fdwOpen; <br> <br>    HMMIO               hmmioSrc; <br>    HMMIO               hmmioDst; <br> <br>    MMCKINFO            ckDst; <br>    MMCKINFO            ckDstRIFF; <br> <br>    UINT                uBufferTimePerConvert; <br> <br>    TCHAR               szFilePathSrc[APP_MAX_FILE_PATH_CHARS]; <br>    LPWAVEFORMATEX      pwfxSrc; <br>    LPBYTE              pbSrc; <br>    DWORD               dwSrcSamples; <br>    DWORD               cbSrcData; <br>    DWORD               cbSrcReadSize; <br>    TCHAR               szSrcFormatTag[ACMFORMATTAGDETAILS_FORMATTAG_CHARS]; <br>    TCHAR               szSrcFormat[ACMFORMATDETAILS_FORMAT_CHARS]; <br> <br>    TCHAR               szFilePathDst[APP_MAX_FILE_PATH_CHARS]; <br>    LPWAVEFORMATEX      pwfxDst; <br>    LPBYTE              pbDst; <br>    DWORD               cbDstBufSize; <br>    TCHAR               szDstFormatTag[ACMFORMATTAGDETAILS_FORMATTAG_CHARS]; <br>    TCHAR               szDstFormat[ACMFORMATDETAILS_FORMAT_CHARS]; <br> <br>    BOOL                fApplyFilter; <br>    LPWAVEFILTER        pwfltr; <br>    TCHAR               szFilterTag[ACMFILTERTAGDETAILS_FILTERTAG_CHARS]; <br>    TCHAR               szFilter[ACMFILTERDETAILS_FILTER_CHARS]; <br> <br>    ACMSTREAMHEADER     ash; <br> <br>    DWORD               cTotalConverts; <br>    DWORD               dwTimeTotal; <br>    DWORD               dwTimeShortest; <br>    DWORD               dwShortestConvert; <br>    DWORD               dwTimeLongest; <br>    DWORD               dwLongestConvert; <br> <br>} AACONVERTDESC, *PAACONVERTDESC; <br> <br> <br> <br>BOOL FNEXPORT AcmAppDlgProcChooser <br>( <br>    HWND                    hwnd, <br>    UINT                    uMsg, <br>    WPARAM                  wParam, <br>    LPARAM                  lParam <br>); <br> <br> <br> <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br>// <br>//  global variables, etc. <br>// <br>// <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ; <br> <br>// <br>//  flags for gfuAppOptions <br>// <br>#define APP_OPTIONSF_AUTOOPEN   0x0001 <br>#define APP_OPTIONSF_DEBUGLOG   0x0004 <br> <br>extern HINSTANCE            ghinst; <br>extern BOOL                 gfAcmAvailable; <br>extern UINT                 gfuAppOptions; <br>extern HFONT                ghfontApp; <br>extern HACMDRIVERID         ghadidNotify; <br> <br>extern UINT                 guWaveInId; <br>extern UINT                 guWaveOutId; <br> <br>extern TCHAR                gszNull[]; <br>extern TCHAR                gszAppProfile[]; <br>extern TCHAR                gszYes[]; <br>extern TCHAR                gszNo[]; <br> <br>extern TCHAR                gszAppName[APP_MAX_APP_NAME_CHARS]; <br>extern TCHAR                gszFileUntitled[APP_MAX_FILE_TITLE_CHARS]; <br> <br>extern TCHAR                gszInitialDirOpen[APP_MAX_FILE_PATH_CHARS]; <br>extern TCHAR                gszInitialDirSave[APP_MAX_FILE_PATH_CHARS]; <br> <br>extern TCHAR                gszLastSaveFile[APP_MAX_FILE_PATH_CHARS]; <br> <br> <br>extern ACMAPPFILEDESC       gaafd; <br> <br> <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ;  <br>// <br>// <br>// <br>//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ;  <br> <br>#ifndef RC_INVOKED <br>#pragma pack()                      // revert to default packing <br>#endif <br> <br>#ifdef __cplusplus <br>}                                   // end of extern "C" {  <br>#endif <br> <br>#endif // _INC_ACMAPP </code></pre>
<p>&nbsp;</p></body>
</HTML>
