<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MSCUBES.FRM</title>
<link disabled rel=stylesheet href=../../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2711"></a>MSCUBES.FRM</h2>
<pre><code>VERSION 5.00 <br>Object = "{34F681D0-3640-11CF-9294-00AA00B8A733}#1.0#0"; "danim.dll" <br>Begin VB.Form mscubes  <br>   BorderStyle     =   1  'Fixed Single <br>   Caption         =   "Mscubes" <br>   ClientHeight    =   4080 <br>   ClientLeft      =   45 <br>   ClientTop       =   330 <br>   ClientWidth     =   8505 <br>   LinkTopic       =   "Form1" <br>   MaxButton       =   0   'False <br>   MinButton       =   0   'False <br>   ScaleHeight     =   4080 <br>   ScaleWidth      =   8505 <br>   StartUpPosition =   3  'Windows Default <br>   Begin DirectAnimationCtl.DAViewerControlWindowed DAViewerControlWindowed  <br>      Height          =   3855 <br>      Left            =   120 <br>      OleObjectBlob   =   "mscubes.frx":0000 <br>      TabIndex        =   0 <br>      Top             =   120 <br>      Width           =   8295 <br>   End <br>End <br>Attribute VB_Name = "mscubes" <br>Attribute VB_GlobalNameSpace = False <br>Attribute VB_Creatable = False <br>Attribute VB_PredeclaredId = True <br>Attribute VB_Exposed = False <br>' Visual Basic verion of Mscubes <br>Private Sub Form_Load() <br>  Set changingRate = CreateObject("DirectAnimation.DANumber") <br>    changingRate.Init DAStatics.Until(DANumber(0.2), LeftButtonDown, _ <br>      DAStatics.Until(DANumber(0), LeftButtonDown, changingRate)) <br>       <br>  ' Set up relative paths for media imports.  Does not work in VB <br>  ' debug.  Create executable. <br>  Dim mediaBase, geoBase, imgBase, midiBase As String <br>  mediaBase = CurDir + "\..\..\..\..\..\Media\" <br>  geoBase = mediaBase + "geometry\" <br>  imgBase = mediaBase + "image\" <br>  midiBase = mediaBase + "midi\" <br>   <br>  'Import the needed geometry &amp; images &amp; sound. <br>  Set geo = ImportGeometry(geoBase + "cube.x") <br>  Set importSnd = ImportSound(midiBase + "circus.mid") <br>  Set backgroundSnd = importSnd.Sound.RepeatForever() <br> <br>  Dim IELogos(8) <br>  Set IELogos(0) = ImportImage(imgBase + "clogo1.gif") <br>  Set IELogos(1) = ImportImage(imgBase + "clogo2.gif") <br>  Set IELogos(2) = ImportImage(imgBase + "clogo3.gif") <br>  Set IELogos(3) = ImportImage(imgBase + "clogo4.gif") <br>  Set IELogos(4) = ImportImage(imgBase + "clogo5.gif") <br>  Set IELogos(5) = ImportImage(imgBase + "clogo6.gif") <br>  Set IELogos(6) = ImportImage(imgBase + "clogo7.gif") <br>  Set IELogos(7) = ImportImage(imgBase + "clogo8.gif") <br>  Set IELogos(8) = ImportImage(imgBase + "clogo9.gif") <br> <br>  'Call the Movie(), which cycles through the IELogos images every second. <br>  Set imageCube = Movie(IELogos) <br>   <br>  'Set lights. <br>  Set pLight = PointLight.Transform(Translate3(0, 0, 4)) <br>  Set dLight = DirectionalLight.Transform(Rotate3(YVector3, 0.5)) <br>     <br>  'Manipulate the geometry. <br>  Set geo = geo.Transform(Scale3Uniform(0.5)).Texture(imageCube.MapToUnitSquare()) <br> <br>  'Create the four cubes and set them to rotate. <br>  Set srate = Mul(LocalTime, DANumber(9)) <br>  Set cube1 = geo.Transform(Compose3(Translate3(0, 0, 2), _ <br>    Rotate3Anim(Vector3(0, 1, 0), Mul(DANumber(0.04), srate)))) <br>  Set cube2 = geo.Transform(Compose3(Translate3(0, 0, -2), _ <br>    Rotate3Anim(Vector3(0, 1, 1), Mul(DANumber(0.03), srate)))) <br>  Set cube3 = geo.Transform(Compose3(Translate3(2, 0, 0), _ <br>    Rotate3Anim(Vector3(0, 0, 1), Mul(DANumber(0.02), srate)))) <br>  Set cube4 = geo.Transform(Compose3(Translate3(-2, 0, 0), _ <br>    Rotate3Anim(Vector3(1, 1, 1), Mul(DANumber(0.03), srate)))) <br>     <br>  'Do the final prep work on the model. <br>  Set finalgeo = UnionGeometry(cube1, UnionGeometry(cube2, UnionGeometry(cube3, cube4))) <br>  Set Camera = PerspectiveCamera(5.5, 4.5).Transform(Scale3(45, 45, 1)) <br>     <br>  'Make the complete image rotate. <br>  Set finalgeo = finalgeo.Transform(Rotate3Anim(YVector3, Integral(changingRate))) <br>  Set finalgeo = UnionGeometry(finalgeo, pLight) <br>     <br>  'Render and display the image. <br>  Set rendered_geo = finalgeo.Render(Camera) <br>   <br>  DAViewerControlWindowed.UpdateInterval = 0.2 <br>   <br>  'Set the image. <br>  DAViewerControlWindowed.Image = Overlay(rendered_geo, DAStatics.SolidColorImage(White)) <br>   <br>  'Set the sound. <br>  DAViewerControlWindowed.Sound = backgroundSnd <br>   <br>  'Start the animation. <br>  DAViewerControlWindowed.Start <br>End Sub <br> <br>Function Movie(IELogos) <br>  Set movieArray = DAStatics.DAArray(IELogos) <br>  Set Movie = movieArray.NthAnim(DAStatics.Mod(LocalTime, DANumber(9))) <br>End Function <br> <br> <br> <br> <br> <br> <br> <br> <br> <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
