<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>COFFEE.FRM</title>
<link disabled rel=stylesheet href=../../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2710"></a>COFFEE.FRM</h2>
<pre><code>VERSION 5.00 <br>Object = "{34F681D0-3640-11CF-9294-00AA00B8A733}#1.0#0"; "danim.dll" <br>Begin VB.Form coffee  <br>   BorderStyle     =   1  'Fixed Single <br>   Caption         =   "Coffee" <br>   ClientHeight    =   3585 <br>   ClientLeft      =   45 <br>   ClientTop       =   330 <br>   ClientWidth     =   7260 <br>   LinkTopic       =   "Form1" <br>   MaxButton       =   0   'False <br>   MinButton       =   0   'False <br>   ScaleHeight     =   3585 <br>   ScaleWidth      =   7260 <br>   StartUpPosition =   3  'Windows Default <br>   Begin DirectAnimationCtl.DAViewerControlWindowed DAViewerControlWindowed  <br>      Height          =   3375 <br>      Left            =   120 <br>      OleObjectBlob   =   "coffee.frx":0000 <br>      TabIndex        =   0 <br>      Top             =   120 <br>      Width           =   7095 <br>   End <br>End <br>Attribute VB_Name = "coffee" <br>Attribute VB_GlobalNameSpace = False <br>Attribute VB_Creatable = False <br>Attribute VB_PredeclaredId = True <br>Attribute VB_Exposed = False <br>' Visual Basic verion of Coffee <br>Dim mediaBase, geoBase, imgBase, sndBase As String <br>Private Sub Form_Load() <br>  mediaBase = CurDir + "\" <br>  geoBase = mediaBase <br>  imgBase = mediaBase <br>  sndBase = mediaBase <br>   <br>  'Set the background <br>  Set imgBackGround = ImportImage(imgBase + "clouds_coffee.gif") <br> <br>  'Create the final montage by layering the espresso machine, the cups and the steam <br>  'on top of each other. <br>  Set finalMtg = UnionMontage(UnionMontage(steamMontage(), _ <br>    montage()), machineMontage()) <br> <br>  'Create the final image. <br>  Set finalImage = Overlay(finalMtg.Render(), Overlay(beans(), imgBackGround)) <br>  Set finalImage = Overlay(finalImage, SolidColorImage(White)) <br>   <br>  DAViewerControlWindowed.UpdateInterval = 0.2 <br>   <br>  'Display the final image. <br>  DAViewerControlWindowed.Image = finalImage <br>   <br>  'Set the sound. <br>  DAViewerControlWindowed.sound = Mix(sound().Pan(-1), sound().Pan(1)) <br> <br>  'Start the animation. <br>  DAViewerControlWindowed.Start <br>End Sub <br>Function sound() <br>  'This function creates the sound, which starts out as silence, and then <br>  'changes to steam.mp2 when the image is clicked. <br>  Set steamDurationConst = DANumber(7.25) <br>  Set steamSound = ImportSound(sndBase + "steam.mp2").sound <br> <br>  Set s0 = CreateObject("DirectAnimation.DASound") <br>    s0.Init DAStatics.Until(Silence, LeftButtonDown, _ <br>      DAStatics.Until(steamSound.Gain(0.85), TimerAnim(steamDurationConst), s0)) <br> <br>  Set sound = s0 <br>End Function <br>Function montage() <br>  'This function creates a montage of five cups, which rotate around the espresso <br>  'machine.  The orbit is constructed by the orbitCup function. <br>  pi = 3.14159265359 <br>  total = 5 <br>  Set cupImageX = EmptyMontage <br> <br>  For i = 0 To total <br>    Set cupImageX = UnionMontage(cupImageX, orbitCup(Add(Mul(DANumber(i), _ <br>      Mul(DANumber(2), Div(DANumber(pi), DANumber(total)))), LocalTime))) <br>  Next <br>  Set montage = cupImageX <br>End Function <br>Function beans() <br>  'This function creates the beans you see in the background.  Two images, <br>  'bean1.gif and bean2.gif are imported, and then moved across the screen <br>  'while being rotated. <br>  Set delay = DANumber(0.5) <br>  Set Size = DANumber(0.5) <br>  Set initBean1 = ImportImage(imgBase + "bean1.gif") <br>  Set initBean2 = ImportImage(imgBase + "bean2.gif") <br> <br>  Set image0 = CreateObject("DirectAnimation.DAImage") <br>  Set image1 = CreateObject("DirectAnimation.DAImage") <br>  image0.Init DAStatics.Until(initBean1, TimerAnim(delay), image1) <br>  image1.Init DAStatics.Until(initBean2, TimerAnim(delay), image0) <br> <br>  Set bean1 = image0.Transform(Scale2UniformAnim(Size)) <br>  Set bean2 = image1.Transform(Scale2UniformAnim(Size)) <br> <br>  Set beans = Overlay(bean1.Transform(Translate2(-0.01, -0.01)), _ <br>    bean2.Transform(Translate2(0.01, 0))) <br> <br>  Set rain = beans.Tile() <br> <br>  Set motion = Mul(LocalTime, Mul(DANumber(2), _ <br>    Div(DANumber(0.03), DANumber(4)))) <br> <br>  Set beans = rain.Transform(Translate2Anim(Neg(motion), Neg(motion))) <br>End Function <br>Function machineMontage() <br>  'This function displays the espresso machine. <br>  Set steamDurationConst = DANumber(7.25) <br>  Set espreso1 = ImportImage(imgBase + "espreso1.gif") <br>  Set espreso2 = ImportImage(imgBase + "espreso2.gif") <br> <br>  Set image5 = CreateObject("DirectAnimation.DAImage") <br>    image5.Init DAStatics.Until(espreso1, LeftButtonDown, _ <br>      DAStatics.Until(espreso2, TimerAnim(steamDurationConst), image5)) <br> <br>  Set machineMontage = ImageMontage(image5, 0) <br>End Function <br>Function steamMontage() <br>  'This function displays the steam you see when you click on the image. <br>  Set steamDurationConst = DANumber(7.25) <br>  Dim steamImages(4) <br>  Set steamImages(0) = ImportImage(imgBase + "steam_1.gif") <br>  Set steamImages(1) = ImportImage(imgBase + "steam_2.gif") <br>  Set steamImages(2) = ImportImage(imgBase + "steam_3.gif") <br>  Set steamImages(3) = ImportImage(imgBase + "steam_4.gif") <br>  Set steamImages(4) = ImportImage(imgBase + "steam_5.gif") <br> <br>  Set steamLen = DANumber(4) <br> <br>  Set condition = GT(Add(Div(Mul(LocalTime, steamLen), _ <br>    steamDurationConst), DANumber(1)), steamLen) <br> <br>  Set result2 = Add(Div(Mul(LocalTime, steamLen), _ <br>    steamDurationConst), DANumber(1)) <br> <br>  Set Index = Cond(condition, steamLen, result2) <br> <br>  Set a = DAStatics.Array(steamImages) <br> <br>  Set s0 = CreateObject("DirectAnimation.DAImage") <br>    s0.Init DAStatics.Until(EmptyImage, LeftButtonDown, _ <br>      DAStatics.Until(a.NthAnim(Index), TimerAnim(steamDurationConst), s0)) <br> <br>  Set image1 = s0.Transform(Translate2(-0.0085, 0.002)) <br> <br>  Set steamMontage = ImageMontage(image1, -0.0001) <br>  End Function <br>Function orbitCup(angle) <br>  pi = 3.14159265359 <br>  Set pos = Point3(0, 0.05, 0) <br>  Set pos = pos.Transform(Compose3(Rotate3Anim(XVector3, Mul(DANumber(7), _ <br>    Div(DANumber(pi), DANumber(16)))), Rotate3Anim(ZVector3, angle))) <br> <br>  Set cupAngle = LocalTime <br> <br>  Set imageXX = cupImage(cupAngle).Transform(Compose2(Translate2Anim(pos.X, pos.Y), _ <br>    Scale2UniformAnim(DAStatics.Sub(DANumber(1), _ <br>      Mul(DAStatics.Abs(DAStatics.Cos(Div(angle, _ <br>        DANumber(2)))), DANumber(0.5)))))) <br> <br>  Set orbitCup = ImageMontageAnim(imageXX, Neg(pos.Z)) <br>End Function <br>Function cupImage(cupAngle) <br>  pi = 3.14159265359 <br>  Dim cupImages <br>  cupImages = Array(ImportImage(imgBase + "cup1.gif"), _ <br>    ImportImage(imgBase + "cup2.gif"), ImportImage(imgBase + "cup3.gif"), _ <br>      ImportImage(imgBase + "cup4.gif"), ImportImage(imgBase + "cup5.gif"), _ <br>        ImportImage(imgBase + "cup6.gif"), ImportImage(imgBase + "cup7.gif"), _ <br>          ImportImage(imgBase + "cup8.gif")) <br> <br>  Set Number = DANumber(7) <br>  Set Index = Add(DAStatics.Mod(Mul(Number, Div(cupAngle, _ <br>    Mul(DANumber(2), DANumber(pi)))), Number), DANumber(1)) <br> <br>  Set a = DAStatics.Array(cupImages) <br> <br>  Set cupImage = a.NthAnim(Index) <br>End Function <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
