<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Supporting AutoPlay</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY bgcolor="#FFFFFF" >

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<H2>Supporting AutoPlay</H2><P>  </P>
<P>Windows supports the ability to automatically run a file when the user inserts removable media that support insertion notification, such as CD-ROM, PCMCIA hard disks, or flash ROM cards. To support this feature, include a file named Autorun.inf in the root directory of the removable media. In this file, include the filename of the file to run, using the following syntax.</P>
<P CLASS="syn">[autorun]<BR>open = <I>filename</I></P>
<P>Unless you specify a path, the system looks for the file in the root of the inserted media. If you want to run a file located in a subdirectory, include a path relative to the root; include that path with the file as in the following example.</P>
<P CLASS="syn">open = My Directory\My File.exe</P>
<P>Running the file from a subdirectory does not change the current directory setting. The command-line string you supply can also include parameters or switches.</P>
<P>Because the autoplay feature is intended to provide automatic operation, design the file you specify in the Autorun.inf file to provide visual feedback quickly to confirm the successful insertion of the media. Consider using a startup up window with a graphic or animated sequence. If the process you are automating requires a long load time or requires user input, offer the user the option to cancel the process.</P>
<P>Although you can use this feature to install an application, avoid writing files to the user's local disk without the user's confirmation. Even when you get the user's confirmation, minimize the file storage requirements, particularly for CD-ROM games or educational applications. Consuming a large amount of local file space defeats some of the benefits of the turnkey operation that the autoplay feature provides. Also, because a network administrator or the user can disable this feature, avoid depending on it for any required operations.</P>
<P>You can define the icon that the system displays for the media by including an entry in the Autorun.inf file that includes the filename (and optionally the path) including the icon using the following form.</P>
<P CLASS="syn">icon = <I>filename</I></P>
<P>The filename can specify an icon, a bitmap, an executable, or a dynamic-link library file. If the file contains more than one icon resource, specify the resource with a number after the filename — for example, My File.exe, 1. The numbering follows the same conventions as the registry. The default path for the file will be relative to the Autorun.inf file. If you want to specify an absolute path for an icon, use the following form.</P>
<P CLASS="syn">defaulticon = <I>path</I></P>
<P>The system automatically provides a pop-up menu for the icon and includes AutoPlay as the default command on that menu, so that double-clicking the icon will run the Open = line. You can include additional commands on the menu for the icon by adding entries for them in the Autorun.inf file, using the following form.</P>
<P CLASS="syn">shell\verb\command = <I>filename</I>shell\verb = <I>Menu Item Name</I></P>
<P CLASS="syn"></P>
<P>To define an access key assignment for the command, precede the character with an ampersand (&amp;). For example, to add the command Read Me First to the menu of the icon, include the following in the Autorun.inf file.</P>
<P CLASS="syn">shell\readme\command = Notepad.exe My Directory\Readme.txtshell\readme = Read &amp;Me First</P>
<P CLASS="syn"></P>
<P>Although AutoPlay is typically the default menu item, you can define a different command to be the default by including the following line.</P>
<P CLASS="syn">shell = verb</P>
<P>When the user double-clicks on the icon, the command associated with this entry will be carried out.</P>
<P> </P></FONT>
	</BODY>

</HTML>
