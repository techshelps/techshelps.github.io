<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Voice and Adaptive Connection Technologies for Modems</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF"><font face="verdana,arial,helvetica" size="2">

<H3 CLASS="h2">Voice and Adaptive Connection Technologies for Modems</H3><P CLASS="t">This section provides requirements and recommendations related to voice, voice/data integration, and adaptive connection.</P>
<P CLASS="t">If any feature is implemented in a modem, if must meet the standards for the feature as defined here to qualify for the "Designed for Microsoft Windows" logo.</P>
<P CLASS="h4"><B>7. TIA-695 (AT+V); Speakerphone, if voice modem capabilities </B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="5"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><I>Basic PC 97</I></TD><TD VALIGN="TOP"><I>Workstation PC 97</I></TD><TD VALIGN="TOP"><I>Entertainment PC 97</I></TD></TR><TR><TD VALIGN="TOP">Recommended</TD><TD VALIGN="TOP">Recommended</TD><TD VALIGN="TOP">Required</TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">Voice features in a modem are valuable for telephone answering functions, supporting applications such as MS-Phone. The current version of the Universal Modem Driver in Windows 95 (Unimodem/V) supports voice modems. The Unimodem driver in Windows NT 4.0 does not support voice; it is planned that future versions will.</P>
<P CLASS="t">The two significant components of the voice command sets are:</P>
<UL><LI>Voice recording and playback features, with associated commands for formatting and volume control, and so on.</LI><LI>Call progress and call control signaling.</LI></UL><P CLASS="t"><B>Note </B> By late 1996, IS-101 will be superseded by TIA-695, the complete standard. Manufacturers are encouraged to migrate their products to TIA-695.</P>
<P CLASS="t">The industry standard command set for voice modems is the AT+V command set, currently specified in TIA-695. This consists of Hayes AT (ATTENTION) prefixed commands, +V (Voice) prefixed commands, and DLE-shielded in-band commands. Most voice modems currently are compliant with either AT+V or an equivalent (for example, Rockwell AT#V). Microsoft requires the command set for new modems to follow the syntax and functions of AT+V. </P>
<P CLASS="t">Some of the features discussed are based upon Bellcore Custom Local Area Signaling Services (CLASS) that are widely offered by local exchange carriers in North America. These services convey to the customer's premise equipment (CPE) information made available through interoffice signaling between CO switches. For more details about CLASS features, see the related Bellcore documents listed later in this section.</P>
<P CLASS="t">Speakerphones can be either half-duplex or full-duplex. In a full-duplex speakerphone, avoid using user-initiated training sequences for either electrical or acoustical echo canceller taps. Also, avoid using long downloads or uploads of data for loading of speakerphone filter taps. Speakerphone control should be achieved by way of AT commands that provide the ability to enable and disable the speakerphone and to adjust the output volume and input microphone level.</P>
<P CLASS="t">Unimodem supports the telephone line audio path using a Windows waveform driver. This architecture is described in the <I>Microsoft</I> <I>Windows Programmer's Guide</I>. The wave-in and wave-out devices connected to the phone line must support 8 kHz, monaural, 16-bit PCM format wave data. Additional waveform driver requirements are described in the MDK. The current implementation of Unimodem can support IMA ADPCM at three sample rates (8000 Hz, 7200&nbsp;Hz, or 4800 Hz) and Rockwell ADPCM.</P>
<P CLASS="t">An alternative Unimodem implementation is acceptable if it achieves similar or better performance.</P>
<P CLASS="h4"><B>8. Voice-coding: real-time wave encoder/decoder</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Recommended</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">This can be an ADPCM, such as IMA or Rockwell, or a device with a Windows&nbsp;waveform driver.</P>
<P CLASS="h4"><B>9. Adaptive connection support, V.25, V.8, and V.8bis call control signaling, with V.25ter Annex A modem commands</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Recommended</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">V.25, V.8, and V.8bis call mode discrimination signaling, with V.25 call mode discrimination commands and responses, and V.8 or V.8bis call mode discrimination command set (V.25ter Annex A).</P>
<P CLASS="t">For PC 97, all modems must support V.34 modulation. V.34 in turn requires V.8 call control signaling. To support PC-controlled adaptive connection, modems must support V.25ter Annex A commands, so that the PC and modem driver can adaptively recognize and sort data calls from voice calls.</P>
<P CLASS="t">Further, to support videophone or voice/data integration, modems must support V.8bis call modality signaling, with the corresponding V.25ter Annex A commands.</P>
<P CLASS="t">Call Modality Discrimination issues arise when a telephone line expects calls of either voice, fax, or data modes. For example, this situation arises when data mode devices such as a fax machine or a data modem are attached to a line that also handles voice calls. VoiceView, fax, SVD, videophone, and data calls are examples of the potential for shared use on a voice line. Problems arise when the two ends of a call determine how the call will be handled; for example: </P>
<UL><LI>A data modem dials a voice-only number.</LI><LI>A voice caller calls a data-only line.</LI><LI>A multimode device answers or calls to communicate by either voice or data mode but cannot determine which mode is appropriate.</LI></UL><P CLASS="t">Examples of problems are the following: </P>
<UL><LI>Voice caller hangs up upon hearing "machine tones" even though voice mode is supported by an IVR application.</LI><LI>A call terminates abnormally because devices cannot agree on an appropriate connection modulation and protocol.</LI></UL><P CLASS="t">ITU V.25 defines calling and answering tones for fax and data calls. These are commonly used in faxes worldwide but not commonly used for data calls (although it is mandatory in some countries). It is recommended that data modems contain features to enable generation and detection of these signals, for affirmative detection of incoming fax and data calls. For standard AT commands and responses for these features, see TIA IS-101 and V.25ter Annex A.</P>
<P CLASS="t">ITU V.8 defines means for the calling or originating modem to communicate the selected call types to the answering or responding modem at the beginning of the call. V.8 Call Indication (CI) signal allows a calling modem to announce the desired call type to the answering modem, so the answering modem can do clean voice/data/fax switching. V.25ter Annex A commands allow the PC to enable CI on the calling side and to detect and respond to it with the appropriate application on the answering side. V.8 is required for all V.34 modems. Proprietary and standard AT commands are available for control of V.8 negotiation; see V.25ter Annex A. </P>
<P CLASS="t">Several vendors implement a market standard for DSVD (Digital Simultaneous Voice and Data). These devices use V.8 for call negotiation.</P>
<P CLASS="t">ITU V.8bis supports automatic determination of the appropriate mode of interoperating by means of an unobtrusive, brief, dual-tone mechanism to establish that both ends of a call support V.8bis. These can be used at the beginning of the call or at a later time. Such a brief DTMF burst can easily be dismissed by the voice caller as a remnant of network signaling, unlike a repetitive train of V.21 modulation that might be interpreted as "fax machine tones" when two data modems negotiate. The brevity and user-friendliness of the dual-tone mechanism addresses the first problem described above. </P>
<P CLASS="t">V.8bis call discrimination is required for ITU Simultaneous Voice/Data technologies such as the new V.70 suite, and including PSTN Videophones (H.324). Standard commands for PC control of V.8bis negotiation are defined in V.25ter Annex A (1996).</P>
<P CLASS="t">Modems that support IS-101 (predecessor to TIA-695) can also support automatic attendant applications that use a voice outgoing message to prompt callers to identify themselves (by speech recognition or DTMF) and specify the desired call type.</P>
<P CLASS="h4"><B>References:<BR>Call Modality Discrimination (ITU/T V.8bis)</B></P>
<P>V.8bis combines Call Modality Discrimination, Terminal Selection, and Capability Exchange and Selection to provide automatic call termination on <BR>a multimode line. V.8bis seeks to make these connections both temporally efficient as well as "listener friendly" to the voice mode caller. </P>
<P CLASS="h4"><B>ITU-T V.25ter or TIA-602</B></P>
<P>This lists the AT command set, with standard extensions for modem ID, local port control, modulation control, and so on. Annex A covers adaptive call control using V.25 calling tones, V.8 and V.8bis negotiations, and some fax signals.</P>
<P CLASS="h4"><B>TIA Standard TIA-695 (AT+V Modem)</B></P>
<P>TIA-695 is the ANSI/TIA/EIA standard for voice modems, entitled the "Facsimile Digital Interfaces—Voice Control Standard for Asynchronous DCE."</P>
<P>The standard includes a voice control-and-response interface definition, a collection of basic functions that allow the DTE to implement a call discrimination algorithm, and a control structure that includes data, fax, voice, and other future modes. This standard is currently the most complete statement of voice modem requirements. This standard defines the +V subcommands for the AT command set. </P>
<P>Eventually, TIA-695 will be partial basis for an ITU recommendation.</P>
<P CLASS="h4"><B>10. Support existing CPE, local telset, extension off-hook detection, and loop sensing, if voice modem capabilities present</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Recommended</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">The following capabilities of the local telset attached to the modem should be supported:</P>
<UL><LI>Detection of hook-switch state of the local telset at all times</LI><LI>Ability to perform wave input and wave output to the local handset device</LI><LI>Detection of loop current reversal on the local loop (remote disconnect)</LI><LI>Detection of loop-voltage change (local extension on-/off-hook)</LI></UL><P CLASS="h4"><B>References: <BR>Bellcore TR-NWT-000030</B></P>
<P>"Voiceband Data Transmission Interface Generic Requirements."</P>
<P CLASS="h4"><B>Bellcore SR-TSV-002476</B></P>
<P>"CPE Compatibility Considerations for the Voiceband Data Transmission Interface."</P>
<P CLASS="h4"><B>Bellcore TR-NWT-001401</B></P>
<P>"Visual Message Waiting Indicator Generic Requirements."</P>
<P CLASS="h4"><B>11. Simultaneous voice/data integration capabilities</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Recommended</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">The following technologies can be used to support simultaneous voice/data:</P>
<UL><LI>Analog Simultaneous Voice and Data (ASVD) —that is, ITU V.61, proposed "V.34Q," VoiceSpan, MediaLink.</LI><LI>Digital Simultaneous Voice and Data (DSVD) —that is, MultiTech PCS, market standard DSVD, ITU V.70 suite, ITU H.324 (Video Telephony).</LI><LI>Alternating Voice and Data (AVD) — that is, VoiceView (discussed in the following optional item).</LI></UL><P CLASS="t">In recent years, there has been a profusion of incompatible choices for Voice Data technology. In the short term, the confusion over multiple DSVD technologies has opened the door for the simpler but useful ASVD techniques. ("V.34Q" standardization should be completed in ITU.) However, the recent completion of V.70 and H.324 should converge the market. Future versions of Windows will attempt to allow IHVs and ISVs to accommodate all of them, so that manufacturers and customers can choose based on their needs.</P>
<P CLASS="t">Microsoft is an active member of the International Multimedia Telecommunications Consortium (IMTC). Currently, the IMTC appears to be backing ITU H.324 for voice/data integration, as a substrate for ITU T.120 conferencing. Interested parties are invited to join and participate in the work of the IMTC, and in related ITU study groups.</P>
<P CLASS="t">It is recommended for PC 97 to include the new ITU V.80 recommendation in the modem control function. (See the recommendation for Synchronous Access Mode for data modems earlier in this chapter). V.80 allows complex modem functions (that is, V.42, the V.75 DSVD multiplexor, the H.223 videophone multiplexor) to be implemented in Windows drivers. The advantages are that the resulting system is more powerful and more flexible, data processing is uploaded to the PC where it belongs, and the modems can remain cost competitive.</P>
<P CLASS="t">V.8bis is required for standard DSVD (V.70) or video telephony (H.324) calls.<BR>It allows mutual capabilities exchange between PCs during a voice call, and transition from pure voice to voice/data/video.</P>
<P CLASS="t">V.25ter Annex A commands allows the PC to initiate V.8bis negotiation with the remote PC/terminal, respond to V.8bis signals from the remote PC, and then launch the appropriate application.</P>
<P CLASS="t"><B>Note</B>  PC manufacturers who supply POTS-based video conferencing solutions must supply H.324 – compatible modems with their PC systems. ISDN-based video conferencing solutions should be H-320-compatible.</P>
<P CLASS="h4"><B>12. VoiceView as alternating voice/data integration capabilities</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Optional</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">VoiceView is a useful but obsolete means for voice/data integration. It is not recommended for new designs.</P>
<P CLASS="t">A voice modem might be able to switch a call from voice to data and back to voice using the VoiceView AVD protocol. Modem firmware and hardware features, such as detecting VoiceView-specific tones and muting the earpiece during data transfer, are necessary for optimal VoiceView AVD modem design. </P>
<P CLASS="t">To facilitate automatic switching from AT+V mode (service class 8) to other service classes, a modem should allow detection of VoiceView start sequences while in AT+V mode. The modem should monitor the line for VoiceView events in addition to the normal AT+V monitoring.</P>
<P CLASS="t">When a VoiceView event is detected on the phone line, the modem mutes the local handset and issues a &lt;DLE&gt;-extended packet to the application (usually the TSP). The extended packet corresponds to one of eight possible VoiceView event responses. After a VoiceView data mode start sequence, the modem should start the data pump to receive VoiceView data and wait for the application to request a switch to VoiceView data mode, as described in the VoiceView Protocol Specification. </P>
<P CLASS="t">For all other event types, the modem simply completes the necessary responses and acknowledgments, unmutes the local handset, and resumes normal AT+V operation.</P>
<P CLASS="h4"><B>Reference:<BR>Alternating Voice or Data (VoiceView) Modem, FCLASS=80;<BR>VoiceView Tone Detection by Voice Modems, FCLASS=8</B></P>
<P>Details of the VoiceView alternating voice/data protocol are available from Radish Communications, Boulder, Colorado, USA; (303) 443-2237.</P></BODY></HTML>
