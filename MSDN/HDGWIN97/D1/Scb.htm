<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Keyboard Ports and Peripherals</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF"><font face="verdana,arial,helvetica" size="2">

<H2 CLASS="h1">Keyboard Ports and Peripherals </H2><P CLASS="t">The primary input component for a PC is the keyboard. The keyboard connection on the system board has traditionally been controlled by an 8042 microcontroller or the equivalent. However, for PC 97, USB connections and wireless connections are important design considerations for PC keyboard connections. Also, these design requirements do not exclude (but do not encourage) implementing a legacy AT-style keyboard port.</P>
<P CLASS="t">This section summarizes the specific hardware features required for PC&nbsp;97 keyboard ports and peripherals. Some keyboard port requirements differ, depending on what type of port is being used. </P>
<P CLASS="h4"><B>16. General device requirements</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Required</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">These include the standard requirements for a Plug and Play device identifier, automated software-only settings for device configuration, standard device drivers and Windows-based installation, and icons for external connectors. For more information, see the "Basic PC&nbsp;97" chapter of this guide.</P>
<P CLASS="h4"><B>17. PS/2 specifications by IBM and 8042 chip (or equivalent), if PS/2 used</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Required</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">If a PS/2-style keyboard port is designed into the system, it must meet the following requirements:</P>
<UL><LI>Support IRQ&nbsp;1 to ensure the proper functioning of software written for legacy systems that expect to use this IRQ signal.</LI><LI>Map the I/O address ports to 60h and 64h.</LI></UL><P CLASS="h4"><B>18. USB Specification and USB device class specification, if USB is used</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Required</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">This device must comply with the Universal Serial Bus Specification (v. 1.0 or higher) and the related USB device class specification. This ensures that all Plug and Play requirements are met and Microsoft drivers support this device. For information, see the "USB" chapter in Part 3 of this guide. The keyboard must also support the USB Human Input Device Class Specification.</P>
<P CLASS="t">If a USB keyboard is the sole keyboard implementation in the system, it must support the USB Boot Device specification, and the system BIOS must provide boot support, as specified in "Basic PC 97" in Part 2 of this guide and defined in "Universal Serial Bus PC Legacy Compatibility Specification," v. 1.0 or higher, available from http://www.teleport.com/~usb/data/usb_le9.pdf.</P>
<P CLASS="h4"><B>19. Wireless specifications, if wireless device is used </B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Required</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">An IR device must support IrDA codes and all other requirements specified in the IrDA specification.</P>
<P CLASS="h4"><B>20. PS/2- style keyboard returns expected scan codes</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Required</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">This includes send identifier (0F2h), response: ACK (0FAh) + 2-byte ID.</P>
<P CLASS="h4"><B>21. No interference between keyboards for multiple devices</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Required</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">For example, when a mobile PC is connected to a docking station, more than one keyboard can be attached to the system simultaneously. The keyboard ports on a mobile PC and the docking station must be able to resolve conflicts between the two ports when the mobile unit is docked. Windows&nbsp;supports multiple configurations through the registry and will determine which keyboard to enable.</P>
<P CLASS="t">For more information about managing resources and devices for a mobile PC and docking station pair, see the "Basic PC&nbsp;97" chapter in Part&nbsp;2 of this guide.</P>
<P CLASS="h4"><B>22. Windows and Application Logo keys </B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Recommended</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">If the keyboard includes any Windows Logo keys, it must meet the following requirements:</P>
<UL><LI>The keyboard must be developed according to technical requirements in <I>New Key Support for Microsoft Windows Operating Systems and Applications</I>.</LI><LI>The keyboard must be compatible at the Windows virtual key code level.</LI><LI>The keyboard must pass the requirements in the Windows Logo Key Testing Software before being submitted to Microsoft WHQL for testing.</LI><LI>The Windows Logo key must function as a modifier key (Ctrl, Shift, or Alt).</LI><LI>The Windows Flag trademark must be clearly distinguished on the keytop per the guidelines provided in <I>New Key Support for Microsoft Windows Operating Systems and Applications</I>.</LI></UL><P CLASS="t">The following are recommendations if a keyboard design includes any Windows Logo keys:</P>
<UL><LI>Both Left and Right Windows Logo keys are not required in order to have full functionality under the Windows&nbsp;operating system.</LI><LI>The Application key can be a dual-function key and can be used to replace the Fn key. In this case, a single press-and-release action sends the scan code for the Application key, and holding this key down while pressing another key will modify it and perform the Fn function.</LI><LI>Given the crowded nature of compact keyboards on mobile PCs and keyboards that support double-byte characters (such as Japanese language keyboards), it might be difficult to add three new keys. For mobile PCs, minimal implementation of the new keys includes the addition of one Windows Logo key and one Application key.</LI></UL><P></P></BODY></HTML>
