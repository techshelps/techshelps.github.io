<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Plug and Play for ISA Devices</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF"><font face="verdana,arial,helvetica" size="2">

<H2 CLASS="h1">Plug and Play for ISA Devices</H2><P CLASS="t">This section summarizes the Plug and Play requirements for ISA cards. For more complete details, see the Plug and Play ISA specification and also <I>Hardware Design Guide for Microsoft Windows&nbsp;95</I> (Microsoft Press, 1994). This section includes additional requirements for ISA cards to ensure that such cards will perform correctly under Windows&nbsp;95, including requirements for design implementations that appear only as recommendations in the ISA specification.</P>
<P CLASS="h4"><B>4. ISA device complies with Plug and Play ISA standards</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Required</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">Any card or bus that implements Plug and Play ISA must fully implement the standards defined in the Plug and Play ISA Specification v. 1.0a. This specification also defines the requirements for a unique ID for each ISA device, which is used to identify the device for Plug and Play configuration.</P>
<P CLASS="h4"><B>5. Option ROMs used only on cards with boot devices</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Required</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">This requirement applies only for x86-based systems. Option ROMs must be used only on cards that contain boot devices.</P>
<P CLASS="t">Cards with option ROMs must not hook the primary boot interrupts (Int 9h, Int 10h, Int 13h, Int 18h, and Int 19h) until the system calls the boot connection vector in the selected option ROM expansion header.</P>
<P CLASS="t">On cards with option ROMs, the default configuration must be able to be disabled after the card has been isolated.</P>
<P CLASS="h4"><B>6. Implement full 16-bit I/O address decode logic</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Required</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">This can be a simple circuit limiting I/O addresses to the 0h to 3FFh range, or can be flexible enough to use the upper address regions. For more information, see the "Basic PC&nbsp;97" chapter in Part&nbsp;2 of this guide.</P>
<P CLASS="h4"><B>7. ISA device and driver support IRQ sharing if resource requirements cannot&nbsp;be&nbsp;met</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Required</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">This is a requirement only if the device cannot meet the PC&nbsp;97 resource requirements (as defined for the particular device class in the related chapter in Part&nbsp;4 of this guide). This requirement for sharing IRQs applies for devices of the same class, not across device classes.</P>
<P CLASS="t">To share IRQs, the following requirements must be met:</P>
<UL><LI>The IRQ line must be pulled high by the system board.</LI><LI>Devices must never drive the IRQ line high.</LI><LI>To signal an interrupt, devices must pull the IRQ line low for a minimum of 100 nanoseconds and then release it. The interrupt is signaled by the rising edge that occurs as a result of the pull-up on the IRQ line.</LI><LI>The drivers for all devices connected to the IRQ line must correctly support the interrupt-sharing services of the virtual programmable interrupt controller device (VpicD). This means that after being dispatched an interrupt from VpicD, the drivers must respond to VpicD and indicate correctly whether they actually processed an interrupt for their devices. VpicD will ensure that all devices with pending interrupts have been serviced before returning from the interrupt.</LI><LI>IRQ sharing support implemented in the device driver for servicing interrupts.</LI></UL><P CLASS="h4"><B>8. Unimplemented registers return a deterministic value when read</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Required</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">Any unimplemented registers in the range 00h through 2Fh must return a deterministic value when they are read. Unimplemented configuration registers must return the "disabled" or "unused" value (not necessarily 0) when they are read.</P>
<P CLASS="h4"><B>9. Correct IDs for each ISA card</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Required</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">In the Plug and Play ISA specification, it is required that a Plug and Play card have both an industry-unique Vendor ID (acquired by sending e-mail to pnpid@microsoft.com) and a company-unique Product Identifier (assigned by the manufacturer). The specification requires that this product identifier be unique among all Plug and Play ISA cards manufactured by that company. This means each product (for example, fax card, display adapter, sound adapter, and so on) and every model (for example, 14.4 fax, 28.8 fax, and so on) from the same manufacturer must have different product identifiers.</P>
<P CLASS="t">This is a PC 97 requirement, because it allows the operating system to isolate and identify these different cards. The user must never have a Plug and Play card that cannot be identified because it cannot be distinguished from other models of cards from the same manufacturer. The use of a unique Product ID does not solve the problems that occur when a user installs two of the same cards in a PC system.</P>
<P CLASS="t">In these cases, the user might install a Plug and Play card but will get no indication that it was installed and the card will not work. For this purpose, the Plug and Play ISA specification defines a unique serial number field that can be added to the Vendor and Product IDs to make the card completely unique. A board-unique number in the serial number field is required for ISA devices included on a PC&nbsp;97 system.</P>
<P CLASS="h4"><B>10. ISA system board devices report through BIOS or use unique Serial ID</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Required</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">A peripheral ISA device implemented on the system board can use a fixed Serial IDs (which is not unique) if the device is reported through the BIOS.</P>
<P CLASS="t">If the system board device participates in the Plug and Play ISA isolation scheme (rather than being reported through the BIOS), then it must meet the same requirement for a unique Serial ID as required for an add-on card.</P>
<P CLASS="t">Notice that it is possible that an add-on card containing an ISA chip might be added to a PC system that contains the same chip on the system board. In such a case, the add-on device will be found only if it has a different Serial ID.</P>
<P CLASS="h4"><B>11. IDs using PNP suffix allowed only in Compatible Device ID field</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Required</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">Device IDs that use the three-character PNP suffix are allowed only in the Compatible Device ID field and cannot be used as Device IDs or Logical Device&nbsp;Ids (except, of course, for the device to which the PNP-based ID was originally assigned).</P>
<P CLASS="t">Resource data describes what resources must be available for each logical device on the card (for example, number of available IRQ numbers, address ranges of memory, and so on). Resource data can be stored in the same nonvolatile storage device (such as a serial ROM) that contains the serial identifier. The resource data in the nonvolatile storage device must be sequentially loaded into the resource data register (04h).</P>
<P CLASS="t">The contents of the nonvolatile storage device must be programmed with the information the system needs to interpret which resources the card requires. The structure of the data contained in the storage device is variable, depending on what resources are needed.</P>
<P CLASS="t">The resource data for a Plug and Play ISA card can be read while the card is in the Config state. This card can enter the Config state either after it has been isolated during the isolation sequence, or whenever it receives a Wake[CSN] software command in which the CSN matches the CSN assigned to the card. Only one card at a time can be in the Config state.</P>
<P CLASS="h4"><B>12. Correct support for boot devices</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"><COL WIDTH="25%" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Required</TD><TD VALIGN="TOP"></TD><TD VALIGN="TOP"></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">Plug and Play ISA expansion cards that contain boot devices require some special considerations to properly boot the system. For PC 97, the system must implement support for Plug and Play ISA boot devices and option ROMs as described in the Plug and Play BIOS Specification v. 1.0a.</P>
<P CLASS="t">The types of devices required for the boot process include the primary input device (usually a keyboard), the primary output device (usually a display adapter and a monitor), and any IPL devices.</P>
<P CLASS="t">Any Plug and Play ISA expansion card that provides a boot function must be active when the system powers up. This gives non-Plug and Play systems the means for using Plug and Play ISA devices during a "legacy" boot process. In this case, a non-Plug and Play system BIOS will not perform the isolation sequence but will instead perform a ROM scan to detect the presence of a boot device. After the ROM scan detects the presence of an option ROM on the boot device, the system ROM will jump to the option ROM to initialize the device. The Plug and Play option ROM on the card will detect that the system BIOS is not Plug and Play compatible and will respond accordingly. Although an initial set of static resources must be provided during this "legacy" boot, the Plug and Play ISA card must be capable of changing these resources using the standard Plug and Play ISA isolation and configuration process.</P>
<P CLASS="t">As required in the Plug and Play ISA specification, resource usage of a card is always reflected in the card's configuration registers. This information allows Windows 95 to easily determine the default settings of a Plug and Play boot device. The default settings can then be overridden by the operating system with full cooperation of the device driver.</P></BODY></HTML>
