<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<HEAD>
<meta name="PREMIUM" content="MSDN">
<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">
<meta name="MS.LOCALE" content="EN-US">
<meta name="DESCRIPTION" content="This page is from the Microsoft Proxy Server book, found in the Tools and Technologies Section in the MSDN Library">



<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CHAPTER 8, Setting Up Clients</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>


<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<p align="left"><a name="Top"><font size="2"
face="Verdana, Arial, Helvetica"><img src="onepix.gif" alt="Space"
align="top" width="1" height="1"></font></a></p>

<hr>

<h1><a name="SettingUpClients"><font size="6"
face="Verdana, Arial, Helvetica">Setting Up Clients</font></a></h1>

<blockquote>
    <p><a href="#9h1"><font size="2" face="Verdana, Arial, Helvetica">Configuring
    the Client Setup Program</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#8h1"><font size="2" face="Verdana, Arial, Helvetica">Installing
    Clients</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#08stp700"><font size="2"
    face="Verdana, Arial, Helvetica">Removing Clients<br>
    </font></a><a href="#08cs100"><font size="2"
    face="Verdana, Arial, Helvetica">Reviewing the Client Setup Log</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#3h1"><font size="2" face="Verdana, Arial, Helvetica">Web
    Proxy Clients</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#7h1"><font size="2" face="Verdana, Arial, Helvetica">WinSock
    Proxy Clients</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#301h2"><font size="2"
    face="Verdana, Arial, Helvetica">Using the WSP Client Application</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#888h1"><font size="2"
    face="Verdana, Arial, Helvetica">Creating a Local LAT File </font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#6161h1"><font size="2"
    face="Verdana, Arial, Helvetica">Editing the Mspclnt.ini File </font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#winsockapps"><font size="2"
    face="Verdana, Arial, Helvetica">Configuring Windows Sockets
    Applications</font></a></p>
</blockquote>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="9h1"><font size="2"
face="Verdana, Arial, Helvetica">Configuring the Client Setup Program</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">During Microsoft Proxy
Server setup, you are asked to complete a <strong>Client
Configuration</strong> dialog box. The options in this dialog box
are used to create an Mspclnt.ini file, which is installed on the
server, along with a client Setup program. Later, when a client
connects to the server and runs the client Setup program, the
Mspclnt.ini file is copied to the client, and determines its
client configuration parameters. For information about using the
Microsoft Proxy Server Setup program and completing the <strong>Client
Configuration</strong> dialog box, see </font><a
href="03_msp.HTM#Top"><font size="2" face="Verdana, Arial, Helvetica">&#147;Server Installation.&#148;</font></a></p>

<p><font size="2" face="Verdana, Arial, Helvetica">If you need to change
the server&#146;s copy of the Mspclnt.ini file after a server has
been installed, you can:</font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Use
        a text editor to modify the server&#146;s Mspclnt.ini
        file, which is installed into the Msp\Clients folder on
        the server. (See </font><a href="#6161h1"><font size="2"
        face="Verdana, Arial, Helvetica">Editing the Mspclnt.ini File,</font></a><font
        size="2" face="Verdana, Arial, Helvetica"> later in this chapter.)
        </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Run Microsoft
        Proxy Server Setup and reinstall the server, specifying
        the new information in the <strong>Client Configuration </strong>dialog
        box.</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">If you need to change a
client&#146;s copy of the Mspclnt.ini file after a client has
been installed, you can:</font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Refresh
        the client&#146;s copy of the file by downloading the
        current version from the server, as described in </font><a
        href="#301h2"><font size="2" face="Verdana, Arial, Helvetica">Using
        the WSP Client Control Panel Application,</font></a><font
        size="2" face="Verdana, Arial, Helvetica"> later in this chapter. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Use a text editor
        to modify the client&#146;s copy of the Mspclnt.ini file,
        as described in </font><a href="#6161h1"><font size="2"
        face="Verdana, Arial, Helvetica">Editing the Mspclnt.ini File,</font></a><font
        size="2" face="Verdana, Arial, Helvetica"> later in this chapter.</font></li>
</ul>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="8h1"><font size="2"
face="Verdana, Arial, Helvetica">Installing Clients</font></a></h1>

<blockquote>
    <p><a href="#08stp800"><font size="2" face="Verdana, Arial, Helvetica">Running
    Client Setup<br>
    </font></a><a href="#08stp900"><font size="2"
    face="Verdana, Arial, Helvetica">Reinstalling a Client</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#08stp300"><font size="2"
    face="Verdana, Arial, Helvetica">Installing on a Dual-Boot Client<br>
    </font></a><a href="#08_999"><font size="2"
    face="Verdana, Arial, Helvetica">Running Client Setup from the Command
    Line</font></a></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">For information about
upgrading a client from a preliminary release of Microsoft Proxy
Server, see the Readme.txt file provided on the Microsoft Proxy
Server compact disc.</font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="08stp800"><font size="2"
face="Verdana, Arial, Helvetica">Running Client Setup</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">You can set up a client
computer by using either the Setup program or a Web browser.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>To set up a
client computer using the Setup program</strong></font></p>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the client
        computer, connect to the server&#146;s Mspclnt share.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">For example, for the
        server Wolfhound, you would connect to
        \\Wolfhound\Mspclnt. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the Mspclnt
        share, run Setup and follow the on-screen instructions.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">The client components
        will be installed, and the client computer will be
        configured according to the settings of the Mspclnt.ini
        file. </font></p>
    </li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>To set up a
client computer using the client&#146;s Web browser</strong></font></p>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From a browser on
        the client computer, connect to the server's installation
        page by typing the URL http://<em>servername</em>/Msproxy,
        where <em>servername</em> is the name of the server.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">For example, for the
        server Delaney, you would type http://Delaney/Msproxy. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Once the client
        installation Web page is loaded, follow the on-screen
        instructions to run Setup and install client components.</font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">If the browser proxy
settings configured by client Setup are not appropriate for a
particular client, or if a client&#146;s Web browser is not
Microsoft Internet Explorer or Netscape Navigator, then you must
use the Web browser&#146;s own configuration interface to specify
the name of the computer running Microsoft Proxy Server and the
protocol port number. For more information see </font><a
href="#3h1"><font size="2" face="Verdana, Arial, Helvetica">Web Proxy
Clients,</font></a><font size="2" face="Verdana, Arial, Helvetica"> later
in this chapter.</font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="08stp900"><font size="2"
face="Verdana, Arial, Helvetica">Reinstalling a Client</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">After installing a
client, if you need to reinstall you can rerun Setup.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>To use Setup to
reinstall a client</strong></font></p>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">At the client
        computer, open the <strong>Microsoft Proxy Client</strong>
        program group, and click <strong>Setup</strong>.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">&#150;Or&#150; </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">Connect to the
        Mspclnt share on the server and rerun client Setup from
        there, as described in </font><a href="#08stp800"><font
        size="2" face="Verdana, Arial, Helvetica">Running Client Setup.</font></a><font
        size="2" face="Verdana, Arial, Helvetica"> </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">When the <strong>Client
        Setup</strong> dialog box appears, select <strong>Reinstall</strong>
        and follow the on-screen instructions.</font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">For computers running
Windows&nbsp;95 or Windows&nbsp;NT&nbsp;4.0, you can also
reinstall client software by using Control Panel.</font></p>

<h4><a name="TouseControlPaneltoreinstallaclient"><font size="2"
face="Verdana, Arial, Helvetica"><strong>To use Control Panel to reinstall
a client</strong></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">At the client
        computer, open Control Panel and click <strong>Add/Remove
        Programs.</strong></font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">The <strong>Add/Remove
        Programs Properties</strong> dialog box appears.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Make sure the <strong>Install/Uninstall</strong>
        tab is selected.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select <strong>Microsoft
        Proxy Client</strong>, click <strong>Add/Remove</strong>,
        and follow the on-screen instructions.</font></li>
</ol>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="08stp300"><font size="2"
face="Verdana, Arial, Helvetica">Installing on a Dual-Boot Client</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">It is possible to run
client Setup and install the WinSock Proxy client software on a
dual-boot computer. Client Setup should be run twice (once for
each operating system). After the first installation, you must
specify a different client directory. For example, install client
software on the Windows&nbsp;NT operating system, then install
client software on the Windows&nbsp;95 operating system in a
different directory.</font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="08_999"><font size="2"
face="Verdana, Arial, Helvetica">Running Client Setup from the Command
Line</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Optionally, you can run
client Setup from the command line and take advantage of the
command-line options. The client Setup syntax is as follows:</font></p>

<h3><a name="Syntax"><font size="2" face="Verdana, Arial, Helvetica"><strong>Syntax</strong></font></a></h3>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica"><strong>setup [/r]
    [/u] [/q[1,t]] </strong></font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">where</font></p>

<blockquote>
    <dl>
        <dt><font size="2" face="Verdana, Arial, Helvetica"><strong>/r</strong></font></dt>
        <dd><p align="left"><font size="2"
            face="Verdana, Arial, Helvetica">Reinstalls the client. </font></p>
        </dd>
        <dd><p align="left"><font size="2"
            face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;The
            <strong>/r</strong> switch cannot be used with 16-bit
            clients (computers running Microsoft Windows&nbsp;3.1
            or Microsoft Windows for Workgroups). </font></p>
        </dd>
        <dt><font size="2" face="Verdana, Arial, Helvetica"><strong>/u</strong></font></dt>
        <dd><p align="left"><font size="2"
            face="Verdana, Arial, Helvetica">Removes the client
            application but leaves shared components. </font></p>
        </dd>
        <dd><p align="left"><font size="2"
            face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;The
            <strong>/u</strong> switch cannot be used with 16-bit
            clients (computers running Microsoft Windows&nbsp;3.1
            or Microsoft Windows for Workgroups). </font></p>
        </dd>
        <dt><font size="2" face="Verdana, Arial, Helvetica"><strong>/q</strong></font></dt>
        <dd><p align="left"><font size="2"
            face="Verdana, Arial, Helvetica">Runs client Setup in
            &#147;quiet&#148; setup mode. The screen displays
            progress windows and a Setup completion dialog box,
            but does not prompt the user to approve or modify
            installation settings. Quiet setup will always
            install the client software into the default
            directory (<strong>Mspclnt</strong>). </font></p>
        </dd>
        <dd><p align="left"><font size="2"
            face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;You
            can only use quiet mode for an initial setup. If a
            client is already installed, you cannot reinstall or
            remove it by using the <strong>/q</strong> option. </font></p>
        </dd>
    </dl>
    <dl>
        <dt><font size="2" face="Verdana, Arial, Helvetica"><strong>/q1</strong></font></dt>
        <dd><p align="left"><font size="2"
            face="Verdana, Arial, Helvetica">Same as <strong>/q</strong>,
            but also hides the Setup completion dialog box. </font></p>
        </dd>
        <dt><font size="2" face="Verdana, Arial, Helvetica"><strong>/qt</strong></font></dt>
        <dd><font size="2" face="Verdana, Arial, Helvetica">Same as <strong>/q</strong>,
            but also hides the progress windows and completion
            dialog box. (After installation completes, the client
            computer will be restarted if a restart is required
            by the Setup program.)</font></dd>
    </dl>
</blockquote>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="08stp700"><font size="2"
face="Verdana, Arial, Helvetica">Removing Clients</font></a></h1>

<h4><a name="Toremovetheclientsoftwarefromacomputer"><font
size="2" face="Verdana, Arial, Helvetica"><b>To remove the client software
from a computer</b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the <strong>Microsoft
        Proxy Client</strong> program group, click <strong>Uninstall.</strong></font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <b>Uninstall Proxy
        Client </b>dialog box appears. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <b>Yes</b>. </font><p><font
        size="2" face="Verdana, Arial, Helvetica">All installed client
        components are removed from the computer. </font></p>
    </li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">You can also remove the
client software by using the Setup program, but you must be
connected to the Mspclnt share on the server.</font></p>

<h4><a name="TousetheSetupprogramtoremoveaclient"><font size="2"
face="Verdana, Arial, Helvetica"><b>To use the Setup program to remove a
client</b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the <strong>Microsoft
        Proxy Client</strong> program group, click <strong>Setup.</strong></font><p><font
        size="2" face="Verdana, Arial, Helvetica">&#150;Or&#150; </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">Connect to the
        Mspclnt share on the server and run client Setup from
        there, as described in </font><a href="#08stp800"><font
        size="2" face="Verdana, Arial, Helvetica">Running Setup.</font></a><font
        size="2" face="Verdana, Arial, Helvetica"> </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <b>Remove
        All</b> and follow the on-screen instructions.</font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">You can also remove
client software by using Control Panel.</font></p>

<h4><a name="TouseControlPaneltoremoveaclient"><font size="2"
face="Verdana, Arial, Helvetica"><strong>To use Control Panel to remove a
client</strong></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the client,
        open Control Panel and click <strong>Add/Remove Programs.</strong></font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">The <strong>Add/Remove
        Programs Properties</strong> dialog box appears.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Make sure the <strong>Install/Uninstall</strong>
        tab is selected.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select <strong>Microsoft
        Proxy Client</strong>, click <strong>Add/Remove</strong>,
        and follow the on-screen instructions.</font></li>
</ol>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="08cs100"><font size="2"
face="Verdana, Arial, Helvetica">Reviewing the Client Setup Log</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">During client
installation, the client Setup program creates a log,
Mpcsetup.log, and places it in the root directory of the drive
where the client is installed. (This location is
C:\Mpcsetup.log.) If you encounter problems with client Setup,
review this log by using any text editor (such as Microsoft
WordPad or Microsoft Notepad). </font></p>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="3h1"><font size="2"
face="Verdana, Arial, Helvetica">Web Proxy Clients</font></a></h1>

<blockquote>
    <p><a href="#100h2"><font size="2" face="Verdana, Arial, Helvetica">About
    Web Proxy Clients</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#1h2"><font size="2" face="Verdana, Arial, Helvetica">Configuring
    the Internet Application in Control Panel<br>
    </font></a><a href="#08_mymy"><font size="2"
    face="Verdana, Arial, Helvetica">Configuring Microsoft Internet
    Explorer&nbsp;3.0 Clients</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#3h2"><font size="2" face="Verdana, Arial, Helvetica">Configuring
    Microsoft Internet Explorer&nbsp;1.5 Clients</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#4h2"><font size="2" face="Verdana, Arial, Helvetica">Configuring
    Netscape Navigator Clients</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#5h2"><font size="2" face="Verdana, Arial, Helvetica">Configuring
    Apple Macintosh Clients</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#6h2"><font size="2" face="Verdana, Arial, Helvetica">Configuring
    UNIX Clients<br>
    </font></a><a href="#08100h2"><font size="2"
    face="Verdana, Arial, Helvetica">Configuring the Server&#146;s Browser<br>
    </font></a><a href="#9191h2"><font size="2"
    face="Verdana, Arial, Helvetica">Web Proxy Client Considerations</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="100h2"><font size="2"
face="Verdana, Arial, Helvetica">About Web Proxy Clients</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">The term <em>Web Proxy
client</em> refers to a client computer whose Web browser is
configured to use the Web Proxy service on a Microsoft Proxy
Server. Usually, this is accomplished by running the client Setup
program, as described in </font><a href="#8h1"><font size="2"
face="Verdana, Arial, Helvetica">Installing Clients</font></a><font
size="2" face="Verdana, Arial, Helvetica"> earlier in this chapter.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">If the browser proxy
settings configured by client Setup are not appropriate for a
particular client, you can reconfigure that client&#146;s Web
browser (by using the Web browser&#146;s own configuration
interface) after installing the client software. Also, if a
client&#146;s Web browser is not Microsoft Internet Explorer or
Netscape Navigator, or if client Setup does not successfully
configure a client&#146;s Web browser to use the Web Proxy
service, then you must use the Web browser&#146;s own
configuration interface to specify the name of the appropriate
Microsoft Proxy Server and the protocol port number
(usually&nbsp;80). </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Each browser is
configured through its own user interface. Typically, an
application&#146;s relevant settings are found in menu items
called &#147;Options,&#148; &#147;Preferences,&#148; or
&#147;Settings.&#148; You can configure Internet Explorer by
using the Internet application in Control Panel. </font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="1h2"><font size="2"
face="Verdana, Arial, Helvetica">Configuring the Internet Application in
Control Panel</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">When you run client
Setup, it will configure Microsoft Internet Explorer&nbsp;2.0 as
a client of Microsoft Proxy Server. However, you can also use the
Internet application in Control Panel to specify the name of the
Microsoft Proxy Server and the protocol port number. Internet
Explorer&nbsp;2.0 uses the settings from the Internet
application, but other client applications may have their own
property sheets or dialog boxes for their proxy service settings.
</font></p>

<h4><a
name="ToconfiguretheInternetapplicationwithaMicrosoftProxyServernameandprotocolportnumber"><font
size="2" face="Verdana, Arial, Helvetica"><b>To configure the Internet
application with a Microsoft Proxy Server name and protocol port
number</b></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Open
        Control Panel and click the Internet icon. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Select
        the <strong>Advanced</strong> tab. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Select
        the <strong>Use Proxy Server</strong> check box. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">In
        the <strong>Proxy Server</strong> box, type the protocol,
        proxy server name, and port number (for example,
        http://myproxy:80.) </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Optionally,
        in the <strong>Bypass Proxy On</strong> box, type the
        name of computers, domains, and ports through which
        client applications can request objects without going
        through the Web Proxy service. For example, type <em>domainname</em>.com:80
        to gain access to computers inside <em>domainname</em>
        and to services running on port&nbsp;80 without using the
        Web Proxy service. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">This option is
        useful if you want to access Internet servers within your
        private network. </font></p>
    </li>
</ol>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="08_mymy"><font size="2"
face="Verdana, Arial, Helvetica">Configuring Microsoft Internet
Explorer&nbsp;3.0 Clients</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">When you run the client
Setup program, it will configure Microsoft Internet
Explorer&nbsp;3.0 as a client of Microsoft Proxy Server. However,
you can also use the browser&#146;s own configuration interface
to set this up.</font></p>

<h4><a
name="ToconfigureInternetExplorer&nbsp;3.0asaMicrosoftProxyServerclient"><font
size="2" face="Verdana, Arial, Helvetica"><strong>To configure Internet
Explorer&nbsp;3.0 as a Microsoft Proxy Server client</strong></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">Obtain the proxy
        system address from the network administrator.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the Windows
        desktop, right-click the Internet icon.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select <strong>Properties</strong>
        from the drop-down menu that appears.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <strong>Connection</strong>
        tab.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">In the <strong>Proxy
        Server</strong> area, select the <strong>Connect Through
        A Proxy Server</strong> check box, then click the <strong>Settings</strong>
        box.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">In the protocol <strong>Type</strong>
        box, type the appropriate proxy system address or
        addresses, then type the connection port number
        (usually&nbsp;80) in the adjacent <strong>Port</strong>
        box.</font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">You can also configure
the browser while it is running</font></p>

<h4><a
name="ToconfigureInternetExplorer&nbsp;3.0whileitisrunning"><font
size="2" face="Verdana, Arial, Helvetica"><strong>To configure Internet
Explorer&nbsp;3.0 while it is running</strong></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">Start Internet
        Explorer&nbsp;3.0.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Obtain the proxy
        system address from the network administrator.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">In the <strong>View</strong>
        menu, click <strong>Options</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <strong>Connection</strong>
        tab.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">In the <strong>Proxy
        Server</strong> area, select the <strong>Connect Through
        a Proxy Server</strong> check box, then click the <strong>Settings</strong>
        box.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">In the protocol <strong>Type</strong>
        box, type the appropriate proxy system address or
        addresses, then type the connection port number
        (usually&nbsp;80) in the adjacent <strong>Port</strong>
        box.<br>
        <br>
        </font></li>
</ol>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="3h2"><font size="2"
face="Verdana, Arial, Helvetica">Configuring Microsoft Internet
Explorer&nbsp;1.5 Clients</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Internet
Explorer&nbsp;1.5 is available for computers running the
Windows&nbsp;NT&nbsp;3.51 and Windows&nbsp;3.<em>x</em> operating
systems. </font></p>

<h4><a
name="ToconfigureInternetExplorer&nbsp;1.5asaWebProxyclient"><font
size="2" face="Verdana, Arial, Helvetica"><b>To configure Internet
Explorer&nbsp;1.5 as a Web Proxy client</b></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Start
        Internet Explorer, click the <strong>Tools</strong> menu,
        and click<strong> Set Proxy Server</strong>. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        <strong>Set Proxy Server</strong> dialog box appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Select
        the <b>Use Proxy Server</b> check box. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">In
        the <b>Proxy Server</b> box, type the name of the server.
        </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">In
        the box after the colon, type the protocol port number
        (for example,&nbsp;80). </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Optionally, in the
        <b>Bypass Proxy On</b> box, type the IP addresses of
        sites that should be accessed without using Microsoft
        Proxy Server. These can be Internet or private network
        sites running HTTP, FTP, or Gopher. <br>
        <br>
        </font></li>
</ol>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="4h2"><font size="2"
face="Verdana, Arial, Helvetica">Configuring Netscape Navigator Clients</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">When you run the client
Setup program, it will configure Netscape Navigator as a client
of Microsoft Proxy Server. However, you can also use the
browser&#146;s own configuration interface to set this up.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">In Netscape
Navigator&nbsp;2.01 for Windows&nbsp;NT and for Windows&nbsp;95,
you define the name of the computer running Microsoft Proxy
Server and the port number for each protocol. </font></p>

<h4><a
name="ToconfigureNetscapeNavigator&nbsp;2.01touseWebProxyserviceforHTTPprotocolrequests"><font
size="2" face="Verdana, Arial, Helvetica"><b>To configure Netscape
Navigator&nbsp;2.01 to use Web Proxy service for HTTP protocol
requests</b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">Open Netscape
        Navigator. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select the <b>Options</b>
        menu. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">In the <b>Proxies</b>
        property sheet, select <b>Network Preferences</b>. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select <b>Manual
        Proxy Configuration</b>. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <b>View</b>.
        </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">In <b>HTTP Proxy</b>,
        type the name of the computer running Microsoft Proxy
        Server. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">In the <strong>Port</strong>
        box adjacent to <strong>HTTP Proxy</strong>, type the
        port number used on the Microsoft Proxy Server for HTTP
        protocol requests. </font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">For each protocol you
use with the Web Proxy service, you define a Microsoft Proxy
Server name and port number in the <b>Proxies</b> property sheet.
</font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="5h2"><font size="2"
face="Verdana, Arial, Helvetica">Configuring Apple Macintosh Clients</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">To configure an Apple
Macintosh client application running under UNIX, you need to
specify the name of the computer running Web Proxy service and
the Microsoft Proxy Server port number for the client protocol. </font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="6h2"><font size="2"
face="Verdana, Arial, Helvetica">Configuring UNIX Clients</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">To configure a UNIX
client application running under UNIX, you need to specify the
name of the computer running Web Proxy service and the Microsoft
Proxy Server port number for the client protocol. </font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="08100h2"><font size="2"
face="Verdana, Arial, Helvetica">Configuring the Server&#146;s Browser</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">If you use a browser
from the server computer that is running Microsoft Proxy Server,
and if that browser is configured as a client, you must configure
that browser to use as its proxy the IP address of the
server&#146;s network adapter card that is connected to the
private network. Do not use the server&#146;s computer name or
DNS name.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">If you configure the
server&#146;s browser to use the computer or DNS name, this name
can be resolved to the IP address of a network adapter card
connected to the Internet. When this occurs, requests from that
browser will be filtered (because the LAT should not contain that
IP address) and an &#147;Access is denied&#148; error will be
returned.</font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="9191h2"><font size="2"
face="Verdana, Arial, Helvetica">Web Proxy Client Considerations</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Following are some
considerations about Web Proxy clients:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">Do not configure
        Helper applications (such as RealAudio clients) as Web
        Proxy clients.</font><p><font size="2"
        face="Verdana, Arial, Helvetica">Do not configure Helper
        applications to use the Web Proxy service. For example,
        the RealAudio player is used with the WinSock Proxy
        service. Do not configure the RealAudio client to use
        Microsoft Proxy Server. When configuring the RealAudio
        player, in the <strong>Proxy</strong> tab of the <strong>Preferences</strong>
        dialog box, specify no proxy. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Proxy
        Configuration on IPX-only Clients</font><p><font size="2"
        face="Verdana, Arial, Helvetica">The Web browser of a client
        running only IPX (not running TCP) will not be able to
        connect to the Web Proxy service on Microsoft Proxy
        Server if Microsoft Proxy Server is defined in the
        browser by using a domain or computer name. This can be
        remedied by editing the client&#146;s Web browser
        configuration to specify an IP address (not a computer or
        domain name) for the proxy. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">&#150;Or&#150; </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">When installing
        Microsoft Proxy Server, in the server Setup
        program&#146;s <strong>Client Installation/Configuration</strong>
        dialog box, for <strong>Web Proxy Client</strong> type an
        IP address instead of a computer or domain name. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">Then, when a
        client computer runs client Setup from the server&#146;s
        share, if the client browser is Microsoft Internet
        Explorer or Netscape Navigator, client Setup attempts to
        configure that browser to use the IP address of the
        specified Microsoft Proxy Server. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">Note that when
        assigning multiple computers running Microsoft Proxy
        Server to clients in this manner, balance the load
        between Microsoft Proxy Servers by appropriately
        adjusting the number of IPX-only clients assigned to each
        computer running Microsoft Proxy Server. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Logons with 16-bit
        client software</font><p><font size="2"
        face="Verdana, Arial, Helvetica">A <strong>Domain Credentials</strong>
        dialog box may appear when you attempt to establish a
        connection using 16-bit client software from computers
        running the Microsoft Windows&nbsp;95 or Microsoft
        Windows for Workgroups operating systems. To complete
        this dialog box and complete the connection request,
        supply a valid domain name, user name and password. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Gopher and Gopher
        Plus</font><p><font size="2" face="Verdana, Arial, Helvetica">When
        a client sends a Gopher request, if the Gopher server
        supports Gopher Plus, then Gopher Plus tags are returned
        to the client by the Web Proxy service. </font></p>
    </li>
</ul>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="7h1"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Clients</font></a></h1>

<blockquote>
    <p><a href="#8181h2"><font size="2" face="Verdana, Arial, Helvetica">About
    WinSock Proxy Clients<br>
    </font></a><a href="#8282h2"><font size="2"
    face="Verdana, Arial, Helvetica">WinSock Proxy Client Considerations<br>
    </font></a></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="8181h2"><font size="2"
face="Verdana, Arial, Helvetica">About WinSock Proxy Clients</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">The term <em>WinSock
Proxy</em> <em>client</em> refers to a client computer that is
configured to use the Web Proxy service on a Microsoft Proxy
Server. The WinSock Proxy client components are installed by
running the client Setup program, as described in </font><a
href="#8h1"><font size="2" face="Verdana, Arial, Helvetica">Installing
Clients</font></a><font size="2" face="Verdana, Arial, Helvetica"> earlier
in this chapter. The client Setup program does not configure
individual Windows Sockets applications. Instead, the client
computer is configured to use the WinSock Proxy service on a
server. All Windows Sockets applications on that computer access
the Internet through the WinSock Proxy service on Microsoft Proxy
Server.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The WinSock Proxy
service supports Windows Sockets version&nbsp;1.1 applications.
Before a Windows Sockets application can access the Internet
through Microsoft Proxy Server, the server must be configured to
permit access for the required protocol on the required outbound
and inbound ports. For details on configuring server support for
particular Windows Sockets client applications, see </font><a
href="07_msp.htm"><font size="2" face="Verdana, Arial, Helvetica">&#147;Configuring the WinSock Proxy Service.&#148;</font></a></p>

<p><font size="2" face="Verdana, Arial, Helvetica">In a private network
with multiple Microsoft Proxy Server gateways, install an equal
number of WinSock Proxy clients from each gateway to balance
Internet traffic across all the gateways. For information about
configuring multiple Microsoft Proxy Server gateways, see </font><a
href="05_msp.htm"><font size="2" face="Verdana, Arial, Helvetica">&#147;Server Administration.&#148;</font></a></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="8282h2"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Client Considerations</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Following are some
considerations for WinSock Proxy client computers:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">Do not set Windows
        Sockets client applications to use Microsoft Proxy Server</font><p><font
        size="2" face="Verdana, Arial, Helvetica">Even if the
        configuration parameters for the application allow it, do
        not set a Windows Sockets application on a computer
        configured as a WinSock Proxy client to use Microsoft
        Proxy Server. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Do not install
        Microsoft Exchange Server on WinSock Proxy clients</font><p><font
        size="2" face="Verdana, Arial, Helvetica">Microsoft Exchange
        client software and WinSock Proxy client software can be
        installed on the same computer. However, do not install
        Microsoft Exchange Server software and WinSock Proxy
        client software on the same computer. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Logon procedure
        with 16-bit client software</font><p><font size="2"
        face="Verdana, Arial, Helvetica">A <strong>Domain Credentials</strong>
        dialog box may appear when you attempt to establish a
        connection by using 16-bit client software from computers
        running the Microsoft Windows&nbsp;95 or Microsoft
        Windows for Workgroups operating systems. To complete
        this dialog box and complete the connection request,
        supply a valid domain name, user name, and password. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Upgrading the
        operating system on Windows&nbsp;NT clients</font><p><font
        size="2" face="Verdana, Arial, Helvetica">If the Microsoft Proxy
        Server client software is installed on a computer that
        runs the Windows&nbsp;NT operating system, and the
        operating system is later upgraded, the WinSock Proxy
        client software will be disabled. To re-enable the
        computer as an WinSock Proxy client, reinstall the client
        software by running the client Setup program as described
        in </font><a href="#8h1"><font size="2"
        face="Verdana, Arial, Helvetica">Installing Clients,</font></a><font
        size="2" face="Verdana, Arial, Helvetica"> earlier in this
        chapter. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">This could
        occur, for example, if you install the Microsoft Proxy
        Server client software on a computer running the
        Windows&nbsp;NT Workstation&nbsp;3.51 operating system,
        and then upgrade that computer to Windows&nbsp;NT
        Workstation version&nbsp;4.0. </font></p>
    </li>
</ul>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="301h2"><font size="2"
face="Verdana, Arial, Helvetica">Using the WSP Client Application</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">Use the WSP Client
application in Control Panel to enable or disable the WinSock
Proxy client software, change the server from which client
configuration files are downloaded, and download fresh copies of
the WinSock Proxy client configuration files from that server. </font></p>

<blockquote>
    <p><a href="#7070h2"><font size="2" face="Verdana, Arial, Helvetica">Turning
    the WinSock Proxy Client On or Off<br>
    </font></a><a href="#7171h2"><font size="2"
    face="Verdana, Arial, Helvetica">Changing the Server Used to Download
    Client Configuration Files<br>
    </font></a><a href="#7272h2"><font size="2"
    face="Verdana, Arial, Helvetica">Updating the WinSock Proxy Client
    Configuration Files</font></a></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="7070h2"><font size="2"
face="Verdana, Arial, Helvetica">Turning the WinSock Proxy Client On or
Off</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">After a computer has
the WinSock Proxy client software installed, it is able to use
Windows Sockets applications to access Internet sites through
Microsoft Proxy Server on the corporate network. However, unless
the WinSock Proxy client is turned off, the computer will be
unable to use Windows Sockets applications to access any Internet
sites through a dial-up connection to a private Internet service
provider (ISP). This might occur, for example, if a user has a
home computer that is sometimes used to connect to the corporate
network, and other times to a private ISP. You can turn the
WinSock Proxy client on and off by using the WSP Client
application in the Control Panel.</font></p>

<h4><a name="ToturntheWinSockProxyclientonoroff"><font size="2"
face="Verdana, Arial, Helvetica"><strong>To turn the WinSock Proxy client
on or off</strong></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the client computer, open Control Panel and double-click
        the WSP Client icon. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        <strong>Microsoft WinSock Proxy Client </strong>dialog
        box appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Select
        or clear the<strong> Enable WinSock Proxy Client</strong>
        check box. </font></p>
        <ul>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">To turn on the WinSock
                Proxy client software and use Windows Sockets
                applications with Microsoft Proxy Server, select
                the<strong> Enable WinSock Proxy Client</strong>
                check box. </font></p>
            </li>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">To turn off the WinSock
                Proxy client software and use Windows Sockets
                applications with a private ISP, clear the <strong>Enable
                WinSock Proxy Client </strong>check box. </font></p>
            </li>
        </ul>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        <strong>OK</strong>, then reboot the computer.<br>
        <br>
        </font></p>
    </li>
</ol>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="7171h2"><font size="2"
face="Verdana, Arial, Helvetica">Changing the Server Used to Download
Client Configuration Files</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">The WSP Client
application can be used to change the server from which a
computer downloads client configuration files. (Note that this is
not necessarily the same server that the computer uses to access
the Internet. That server is defined in the downloaded
Mspclnt.ini file.)</font></p>

<h4><a
name="TochangetheWinSockProxyServerfromwhichaclientdownloadsclientconfigurationfiles"><font
size="2" face="Verdana, Arial, Helvetica"><strong>To change the WinSock
Proxy Server from which a client downloads client configuration
files</strong></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">At the client
        computer, open Control Panel and double-click the WSP
        Client icon.</font><p><font size="2"
        face="Verdana, Arial, Helvetica">The <strong>Microsoft WinSock
        Proxy Client </strong>dialog box appears. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Type a server name
        in the <strong>Configuration Location </strong>box.</font><p><font
        size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;The
        entry in the <strong>Configuration</strong> <strong>Location</strong>
        box must be a computer name. It cannot be a DNS name that
        resolves to multiple IP addresses. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>OK</strong>,
        then reboot the computer. </font><p><font size="2"
        face="Verdana, Arial, Helvetica">The client is set to use the new
        server as the source of its client configuration files,
        and those files are downloaded to the client. <br>
        <br>
        </font></p>
    </li>
</ol>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="7272h2"><font size="2"
face="Verdana, Arial, Helvetica">Updating the WinSock Proxy Client
Configuration Files</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">To update client
configuration files, you can force an immediate download of
client configuration files from the server to the client.</font></p>

<h4><a name="Toupdatetheclientconfigurationfiles"><font size="2"
face="Verdana, Arial, Helvetica"><strong>To update the client
configuration files</strong></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">At the client
        computer, open Control Panel and double-click the WSP
        Client icon.</font><p><font size="2"
        face="Verdana, Arial, Helvetica">The <strong>Microsoft WinSock
        Proxy Client </strong>dialog box appears. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Update
        Now</strong>.</font><p><font size="2"
        face="Verdana, Arial, Helvetica">Fresh copies of the client
        configuration files are downloaded from the server to the
        client. </font></p>
    </li>
</ol>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="888h1"><font size="2"
face="Verdana, Arial, Helvetica">Creating a Local LAT File</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">When the client Setup
program runs, it installs a file named Msplat.txt into the
Mspclnt directory on the client computer. The Msplat.txt file
contains the Local Address Table (LAT), which defines the IP
addresses of the private network.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">In some situations the
LAT table downloaded by the server may not completely define some
addresses that a particular client needs to access in the private
network. To correct this condition, you can edit the LAT on the
server (which would propagate the updated LAT to all its clients)
or you can create a local LAT for a particular client. You might
create a local LAT, for example, to allow client access to a
private subnet inside a private network.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">To create a custom LAT
table for a particular client, do not edit the client&#146;s copy
of the Msplat.txt file, because each client&#146;s Msplat.txt
file is overwritten at regular intervals by a fresh version
downloaded from the server. Any changes you make locally are lost
each time the server updates the file.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Instead, to create a
custom LAT file for a client, use a text editor to create a file
named Locallat.txt, and place it in the client&#146;s Mspclnt
directory. In this way you can add additional IP address ranges
that the client recognizes as part of the private network. The
client will use both the Msplat.txt and Locallat.txt files to
determine which IP addresses are part of the private network (and
can be directly communicated with) and which IP addresses are on
the Internet (and must be communicated with through Microsoft
Proxy Server). </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">When creating a
Locallat.txt table, enter IP address pairs in the file. Each
address pair defines either a range of IP addresses (from the
first, lower-number address to the second, higher-number
address), or a single IP address (if both addresses of the pair
are identical). The following is an example of a Locallat.txt
file that has two entries. The first entry is an IP address
range, and the second is a single IP address.</font></p>

<blockquote>
    <table border="0" width="35%">
        <tr>
            <td width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">10.51.0.0</font></td>
            <td width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">10.51.255.255</font></td>
        </tr>
        <tr>
            <td width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">10.52.144.103</font></td>
            <td width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">10.52.144.103</font></td>
        </tr>
    </table>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">Note that the second
entry is an IP address (not a subnet mask).</font></p>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="6161h1"><font size="2"
face="Verdana, Arial, Helvetica">Editing the Mspclnt.ini File</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">The Mspclnt.ini file
contains client configuration information. The master copy of the
Mspclnt.ini file is created by the Microsoft Proxy Server Setup
program and is stored in the Msp\Clients folder on the server.
Each instance of client software that is installed from a server
receives a copy of the Mspclnt.ini file, which is stored in the
Mspclnt folder on the client. The Mspclnt.ini file can be
modified by using a text editor (such as Microsoft WordPad). </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The following is a
sample Mspclnt.ini file.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica"></font>&nbsp;</p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">[Master Config]<br>
    Path1=\\COLLIE2\Mspclnt\<br>
    [Servers Ip Addresses]<br>
    Name=COLLIE<br>
    [Servers Ipx Addresses]<br>
    Addr1=00002610-0080d830525f<br>
    [Common]<br>
    Port=1745<br>
    Configuration Refresh Time (Hours)=6<br>
    Set Browsers to use Proxy=1<br>
    WWW-Proxy=COLLIE<br>
    WebProxyPort=80</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">The following table
describes the entries in the Mspclnt.ini file.</font></p>

<table border="1" cellpadding="5" cellspacing="0" width="100%">
    <tr>
        <th align="left" valign="bottom" width="15%"><font
        size="2" face="Verdana, Arial, Helvetica">Section</font></th>
        <th align="left" valign="bottom" width="15%"><font
        size="2" face="Verdana, Arial, Helvetica"><strong>Entry</strong></font></th>
        <th align="left" valign="bottom" width="70%"><font
        size="2" face="Verdana, Arial, Helvetica">Description</font></th>
    </tr>
    <tr>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">[Master Config]</font></td>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">Path1</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">A UNC path to the shared network
        directory on the server, containing the master copy of
        the client configuration files.</font></td>
    </tr>
    <tr>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">[Servers IP addresses]</font></td>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">Name</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">The computer or DNS name for the
        WinSock Proxy server used by the client. (This entry will
        not appear if an IP address is used.)</font></td>
    </tr>
    <tr>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">[Servers IP addresses]</font></td>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">Addr1</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">The IP address of the WinSock
        Proxy server used by the client. (This entry will not
        appear if a computer or DNS name is used.) Additional
        entries are shown as Addr2, Addr3, and so on.</font></td>
    </tr>
    <tr>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">[Servers Ipx Addresses]</font></td>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">Addr1</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">The IPX address of the WinSock
        Proxy server. Additional entries are shown as Addr2,
        Addr3, and so on.</font></td>
    </tr>
    <tr>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">[Common]</font></td>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">Port</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">The port Microsoft Proxy Server
        uses for the control channel.</font><p><font size="2"
        face="Verdana, Arial, Helvetica">This value will rarely be
        changed. It should be changed by the administrator on the
        server&#146;s master copy of the Mspclnt.ini file only if
        there is a conflict with another service on the server.
        This value should never be edited in the client&#146;s
        copy of the Mspclnt.ini file. </font></p>
        </td>
    </tr>
    <tr>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">[Common]</font></td>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">Configuration Refresh Time
        (Hours)</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">At this interval, specified in
        hours, the client will ask the server to download a fresh
        copy of the Local Address Table (Msplat.txt).</font></td>
    </tr>
    <tr>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">[Common]</font></td>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">Set Browsers to use Proxy</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">In the server&#146;s file, set
        this value to <strong>1</strong> to have the client Setup
        program configure the client computer&#146;s browser to
        use the proxy server defined in the <strong>WWW Proxy </strong>field.
        Set the value to <strong>0</strong> to prevent the client
        Setup program from configuring clients to use a proxy
        server. This field has no effect on the client&#146;s
        version of the file.</font></td>
    </tr>
    <tr>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">[Common]</font></td>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">LocalDomains</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">A list of suffixes for names that
        will be resolved locally, separated by commas (,). Domain
        names that end in the listed strings are resolved at the
        client.</font></td>
    </tr>
    <tr>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">[Common]</font></td>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">WWW-Proxy</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">In the server&#146;s file, if <strong>Set
        Browsers to Use Proxy</strong> is set to <strong>1</strong>,
        the client Setup program will configure client browsers
        to use the proxy server named here. This field has no
        effect on the client&#146;s version of the file.</font></td>
    </tr>
    <tr>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">[Common]</font></td>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">WebProxyPort</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">The listen-on port used by the
        Web Proxy service. In the server&#146;s file, if <strong>Set
        Browsers to Use Proxy</strong> is set to <strong>1</strong>,
        the client Setup program will configure client browsers
        to use the port named in that box. This should be the
        same port number that is set for the WWW service of
        Internet Information Server.</font></td>
    </tr>
</table>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="winsockapps"><font size="2"
face="Verdana, Arial, Helvetica">Configuring Windows Sockets Applications</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">Advanced options for
configuring individual Windows Sockets applications are not
required for most applications to work with the WinSock Proxy
service. In most cases, the default WinSock Proxy configuration
will work with no need for further modification. However, in some
situations the advanced options discussed in this section may be
necessary.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Configuration
information can be set for all WinSock Proxy applications in two
ways:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Global
        configuration</strong> These settings are stored by
        adding a new section in the Mspclnt.ini file. Settings
        made in this way will be used for all applications if no
        further settings information is available.</font></li>
</ul>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Application-specific
        configuration</strong> These settings are individualized
        for each specific Windows Sockets application and are
        stored by creating an additional file named Wspcfg.ini
        for each application that uses specific settings
        information. This file should be located in the same file
        directory that the application is installed in. Having
        this file in the application directory allows support of
        multiple applications with same name (for example,
        different versions of the same application). </font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">WinSock Proxy service
will first look for an Wspcfg.ini file in a client Windows
Sockets application directory. If one is not found, WinSock Proxy
service will use the settings found in the Mspclnt.ini file under
the <tt>[Wsp client]</tt> section. The settings used for a
particular Windows Sockets application are taken from one of
these two files only.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The following is a
sample <tt>[Wsp client]</tt> section in an Mspclnt.ini file. Keep
in mind that where shared settings exist in both a Wspcfg.ini
file and the Mspclnt.ini file located in the WinSock Proxy Client
directory (C:\Mspclnt), application-specific settings made in
Wspcfg.ini will override global settings in Mspclnt.ini. </font></p>

<blockquote>
    <pre><font size="2" face="Verdana, Arial, Helvetica">[Wsp client]
Disable=0 
NameResolution=R
LocalBindTcpPorts=7777
LocalBindUdpPorts=7000-7022, 7100-7170
RemoteBindTcpPorts=30
RemoteBindUdpPorts=3000-3050
MultipleAccessTcpPorts=100-300
MultipleAccessUdpPorts=500-900, 1000-2000
ProxyBindIp=80:10.52.144.103, 82:10.51.0.0</font></pre>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">The following table
describes the possible entries that can be placed in a
configuration file.</font></p>

<table border="1" cellpadding="5" cellspacing="0" width="100%">
    <tr>
        <th align="left" valign="bottom" width="30%"><font
        size="2" face="Verdana, Arial, Helvetica"><strong>Entry</strong></font></th>
        <th align="left" valign="bottom" width="70%"><font
        size="2" face="Verdana, Arial, Helvetica"><strong>Description</strong></font></th>
    </tr>
    <tr>
        <td valign="top" width="30%"><font size="2"
        face="Verdana, Arial, Helvetica">Disable</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">Disables WinSock Proxy service
        functionality; all functions are directly forwarded to
        the system. Note if the Disable value is set to <strong>0</strong>,
        all following file entries are ignored.</font></td>
    </tr>
    <tr>
        <td valign="top" width="30%"><font size="2"
        face="Verdana, Arial, Helvetica">NameResolution</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">By default, resolution for all
        dot-convention names is redirected. Forces name
        resolution to local (<strong>L</strong>) or redirected (<strong>R</strong>),
        as specified.</font></td>
    </tr>
    <tr>
        <td valign="top" width="30%"><font size="2"
        face="Verdana, Arial, Helvetica">LocalBindTcpPorts</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">Specifies a TCP port, list, or
        range that will be bound locally.</font></td>
    </tr>
    <tr>
        <td valign="top" width="30%"><font size="2"
        face="Verdana, Arial, Helvetica">LocalBindUdpPorts</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">Specifies a UDP port, list, or
        range that will be bound locally.</font></td>
    </tr>
    <tr>
        <td valign="top" width="30%"><font size="2"
        face="Verdana, Arial, Helvetica">RemoteBindTcpPorts</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">Specifies a TCP port, list, or
        range that will be bound remotely.</font></td>
    </tr>
    <tr>
        <td valign="top" width="30%"><font size="2"
        face="Verdana, Arial, Helvetica">RemoteBindUdpPorts</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">Specifies a UDP port, list, or
        range that will be bound remotely. By default, this is
        set to 6970-7170 to support client computers running
        RealAudio player version&nbsp;2.1 or newer. If this entry
        does not appear in the Mspclnt.ini file, when RealAudio
        player version&nbsp;2.1 or newer is used with Microsoft
        Proxy Server it will display &#147;Buffering 18&#148; in
        the status bar, and will not play sound. To resolve this
        condition, click the <strong>Stop</strong> button, and
        then click the <strong>Play</strong> button. </font></td>
    </tr>
    <tr>
        <td valign="top" width="30%"><font size="2"
        face="Verdana, Arial, Helvetica">MultipleAccessTcpPorts</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">Specifies a TCP port, list, or
        range used by a server application, so an accept
        operation on these ports is intended to serve clients
        both locally and on the Internet. By default, the socket
        is considered of client process with one connection, so
        the listening socket is reused. Requires that the port
        will be available both on the client and Microsoft Proxy
        Server.</font></td>
    </tr>
    <tr>
        <td valign="top" width="30%"><font size="2"
        face="Verdana, Arial, Helvetica">MultipleAccessUdpPorts</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">Specifies a UDP port, list, or
        range used by a server application, so an accept
        operation on these ports is intended to serve clients
        both locally and on the Internet. By default, the socket
        is considered of client process with one connection, so
        the listening socket is reused. Requires that the port
        will be available both on the client and Microsoft Proxy
        Server. </font></td>
    </tr>
    <tr>
        <td valign="top" width="30%"><font size="2"
        face="Verdana, Arial, Helvetica">ProxyBindIp</font></td>
        <td valign="top" width="70%"><font size="2"
        face="Verdana, Arial, Helvetica">Specifies an IP address or list
        that will be used when binding with a corresponding port.
        Used by multiple servers that use the same port and need
        to bind to different ports on Microsoft Proxy Server.</font></td>
    </tr>
</table>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;A
port can appear in only one of the entries, either as Local,
Remote (redirected), or MultipleAccess. There is no provision for
client applications that require connections both on the private
network and on the Internet. For such applications, incoming
connections from the private network will be directed through
Microsoft Proxy Server as well.</font></p>

<hr>

<p align="center"><font size="2" face="Verdana, Arial, Helvetica"><i>
1996 by Microsoft Corporation. All rights reserved.</i> </font></p>
</FONT>
</FONT>
</BODY>
</html>
