<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<HEAD>
<meta name="PREMIUM" content="MSDN">
<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">
<meta name="MS.LOCALE" content="EN-US">
<meta name="DESCRIPTION" content="This page is from the Microsoft Proxy Server book, found in the Tools and Technologies Section in the MSDN Library">



<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Appendix C, Troubleshooting</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>


<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<p align="left"><a name="Top"><font size="2"
face="Verdana, Arial, Helvetica"><img src="onepix.gif" alt="Space"
align="top" width="1" height="1"></font></a></p>

<hr>

<h3><a name="AppendixC"><font size="2" face="Verdana, Arial, Helvetica"><br>
Appendix C</font></a></h3>

<h1><a name="1h1"><font size="6" face="Verdana, Arial, Helvetica">Troubleshooting</font></a></h1>

<blockquote>
    <p align="left"><a href="#2h1"><font size="2"
    face="Verdana, Arial, Helvetica">Web Proxy Service Troubleshooting</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#3h1"><font size="2" face="Verdana, Arial, Helvetica">WinSock
    Proxy Service Troubleshooting<br>
    </font></a><a href="#4h1"><font size="2"
    face="Verdana, Arial, Helvetica">Performance Troubleshooting<br>
    </font></a><a href="#5h1"><font size="2"
    face="Verdana, Arial, Helvetica">RAS Troubleshooting</font></a></p>
</blockquote>

<hr>

<h1 align="left"><a href="#Top"><font size="2"
face="Verdana, Arial, Helvetica"><img src="up.gif" alt="To Top"
align="middle" border="0" width="14" height="11"></font></a><a
name="2h1"><font size="2" face="Verdana, Arial, Helvetica">Web Proxy
Service Troubleshooting</font></a></h1>

<blockquote>
    <p align="left"><a href="#1h2"><font size="2"
    face="Verdana, Arial, Helvetica">Web Proxy Server Problems</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#2h2"><font size="2" face="Verdana, Arial, Helvetica">Web
    Proxy Client Problems</font></a></p>
</blockquote>

<h2 align="left"><a href="#Top"><font size="2"
face="Verdana, Arial, Helvetica"><img src="up.gif" alt="To Top"
align="middle" border="0" width="14" height="11"></font></a><a
name="1h2"><font size="2" face="Verdana, Arial, Helvetica">Web Proxy
Server Problems</font></a></h2>

<p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>HTTP/1.0
500 Server Error (An attempt has been made to operate on an
impersonation token by a thread that is not currently
impersonating a client.)</strong></font></p>

<blockquote>
    <p align="left"><font size="2" face="Verdana, Arial, Helvetica">This
    error occurs when changes are made to the home directory
    properties for the WWW service and Web Proxy service is also
    in use. If the home directory setting is changed to specify a
    remote UNC path name (i.e. \\servername\sharename) and not a
    currently mapped local drive path (such as
    D:\InetPub\Wwwroot), all requests that are made through the
    Web Proxy service will fail.</font></p>
    <p align="left"><font size="2" face="Verdana, Arial, Helvetica">To
    correct the problem, stop and restart the WWW and Web Proxy
    services using Internet Service Manager. As an alternative,
    create a virtual directory entry instead of altering the
    default local drive path for the home directory when adding
    directory names that use remote UNC path names.</font></p>
</blockquote>

<p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>HTTP/1.0
500 Server Error (-</strong><em><strong>number</strong></em><strong>)
</strong></font></p>

<blockquote>
    <p align="left"><font size="2" face="Verdana, Arial, Helvetica">This
    error occurs when Windows&nbsp;NT Challenge/Response
    authentication is used on Microsoft Proxy Server to validate
    proxy clients. Microsoft Proxy Server uses the password
    authentication specified in the WWW service properties to
    validate Web Proxy clients. Examine the form of password
    authentication in use for WWW services by using Internet
    Service Manager. As a temporary alternative, select basic
    (clear-text) authentication and report the error to your
    support provider.</font></p>
</blockquote>

<p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>HTTP/1.0
500 Server Error (The specified module could not be found.)</strong></font></p>

<blockquote>
    <p align="left"><font size="2" face="Verdana, Arial, Helvetica">This
    error occurs when certain proxy binaries are not installed in
    the correct directory for proxy scripts. Verify the location
    of your IIS scripts directory. Make sure there is a Proxy
    subdirectory under this directory location.</font></p>
</blockquote>

<h2 align="left"><a href="#Top"><font size="2"
face="Verdana, Arial, Helvetica"><img src="up.gif" alt="To Top"
align="middle" border="0" width="14" height="11"></font></a><a
name="2h2"><font size="2" face="Verdana, Arial, Helvetica">Web Proxy
Client Problems</font></a></h2>

<p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>RealAudio
does not work when set to use a proxy.</strong></font></p>

<blockquote>
    <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
    WinSock Proxy service included with Microsoft Proxy Server
    handles all Windows Sockets-based applications transparently.
    Therefore, it is not necessary to configure RealAudio to use
    a proxy. Disable the proxy option in RealAudio&#146;s <strong>View</strong>|<strong>Preferences</strong>
    dialog box.</font></p>
</blockquote>

<p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>FTP
using Netscape Navigator shows all files as plain text when
attempting to download.</strong></font></p>

<blockquote>
    <p align="left"><font size="2" face="Verdana, Arial, Helvetica">This
    problem occurs for some versions of Netscape Navigator
    configured to use the Web Proxy service of Microsoft Proxy
    Server. When Netscape navigator sees the HTTP document-type
    header, it attempts to display the FTP contents on screen
    without examining it. To work around this problem, hold the
    SHIFT key when clicking a link to download a file.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>HTTP error 5
occurred.</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">Connection was
    refused for a proxy-configured client browser. If anonymous
    logon is allowed for IIS, then the IUSR_<em>computername</em>
    account will be used by Microsoft Proxy Server to
    authenticate clients. Microsoft Proxy Server will check that
    proxy client users have access to a requested service. Check
    that the IUSR_<em>computername</em> account is listed on the
    Web Proxy service <strong>Permissions</strong> property sheet
    for the requested service (FTP, HTTP and so on) that is being
    affected. </font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>HTTP error 18
occurred.</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">This error can
    occur when attempting to use a browser configured for the Web
    Proxy service for FPT service. It is caused by the FTP
    directory on the remote computer being empty. (Note: WinSock
    Proxy FTP does not return this error if the directory is
    empty.)</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>HTTP error 12
occurred. </strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">If the private
    network is running TCP/IP, the Local Address Table (LAT) is
    configured to specify that the server&#146;s internal IP
    address is located on the local network. Check that the IP
    address assigned for the server&#146;s internal network
    adapter is included in the LAT.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>HTTP error
10060 occurred.</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">This error
    indicates a time out occurred in attempting to reach the URL
    targeted server . The most common reasons for this are:</font></p>
</blockquote>

<blockquote>
    <ul>
        <li><font size="2" face="Verdana, Arial, Helvetica">The
            destination host is too busy.</font></li>
        <li><font size="2" face="Verdana, Arial, Helvetica">The
            destination host (on the Internet) is currently not
            available.</font></li>
        <li><font size="2" face="Verdana, Arial, Helvetica">A network link
            in the path to the destination host is not available.</font></li>
    </ul>
</blockquote>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="3h1"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Service Troubleshooting</font></a></h1>

<blockquote>
    <p align="left"><a href="#cc_diag"><font size="2"
    face="Verdana, Arial, Helvetica">WinSock Proxy Diagnostic Utility</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#3h2"><font size="2" face="Verdana, Arial, Helvetica">WinSock
    Proxy Server Problems</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#4h2"><font size="2" face="Verdana, Arial, Helvetica">WinSock
    Proxy Client Problems</font></a></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="cc_diag"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Diagnostic Utility</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">When the client Setup
program is run and the client software is installed on a
computer, a WinSock Proxy diagnostic utility is installed into
the Mspclnt directory on the client. This utility presents
configuration information that is useful when troubleshooting
WinSock Proxy conditions.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For computers running
32-bit operating systems, the utility is named Chkwsp32.exe. For
computers running 16-bit operating systems the utility is named
Chkwsp16.exe.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>To run the
WinSock Proxy diagnostic utility</strong></font></p>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">On
        the client computer, open the <strong>MS-DOS
        command-prompt</strong> window and change to the <strong>Mspclnt</strong>
        directory. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Run the utility
        with the <strong>-f</strong> option. </font><p><font
        size="2" face="Verdana, Arial, Helvetica">For example, on a client
        computer running the Windows&nbsp;95 operating system,
        type: </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica"><strong>chkwsp32
        -f</strong> </font></p>
    </li>
</ol>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="3h2"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Server Problems</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Inability for
user to access or administrate different protocols for WinSock
Proxy service.</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">By default, the
    Administrator user logon account is the only account allowed
    to access any port regardless of port configuration. To allow
    other users to access or administrate protocols or assigned
    ports:</font></p>
    <ol>
        <li><font size="2" face="Verdana, Arial, Helvetica">Check the LAT
            to make sure that the user computer&#146;s IP address
            is included.</font></li>
        <li><font size="2" face="Verdana, Arial, Helvetica">Use Internet
            Service Manager to check that the protocol has been
            added. </font></li>
        <li><font size="2" face="Verdana, Arial, Helvetica">Use Internet
            Service Manager to check that the user (or a group
            the user belongs to) has been granted permission to
            use the protocol.</font></li>
    </ol>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Ping fails to
work with WinSock Proxy.</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">Ping.exe uses
    Winsock.dll only when looking up the domain host name of the
    server you are trying to ping. Once the DNS name lookup has
    completed, Ping.exe uses ICMP for connection. If you have an
    internal DNS server, make sure its IP address is contained in
    the Local Address Table (LAT), C:\Msp\Msplat.txt, that is
    configured during Setup. Also, check your Ping utility
    program. If you are using an application to ping with that
    requires use of a third-party Windows Sockets DLL, ICMP ping
    results may be unpredictable.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>WinSock Proxy
service problems with other third-party TCP/IP stacks.</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">Currently,
    Microsoft Proxy Server has not been tested with other
    third-party TCP/IP implementations. Use of a third-party
    stack may produce unpredictable results.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Server domain
name look-ups failing on local network.</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">The WinSock Proxy
    service redirects all DNS look-ups to the computer running
    Microsoft Proxy Server. If you have an internal DNS server,
    make sure its IP address is contained in the Local Address
    Table (LAT), C:\Msp\Msplat.txt, that is configured during
    Setup. Domain names that do not contain dots are considered
    internal names to Microsoft Proxy Server. </font></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="4h2"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Client Problems</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Internal
subnetwork is not reachable through a WinSock Proxy client
application.</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">Check that the
    subnetwork address ranges are included in the Local Address
    Table (LAT), C:\Msplat.txt. If there are internal subnet
    addresses missing from the LAT, add the missing IP address
    pairs to the server LAT file (C:\Msp\Msplat.txt) so that
    these address changes will be propagated to all clients when
    the next table update cycle is performed by Microsoft Proxy
    Server.</font></p>
</blockquote>

<p><font color="#000000" size="2" face="Verdana, Arial, Helvetica"><strong>Cannot
connect to other ISP after installing WinSock Proxy client. </strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">The WinSock Proxy
    client is set up for use with the internal network. When you
    connect to another Internet Service Provider, you are now on
    a different network, and the WinSock Proxy client must be
    disabled. </font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">After a computer
    has the WinSock Proxy client software installed, it is able
    to use Windows Sockets applications to access Internet sites
    through Microsoft Proxy Server on the corporate network.
    However, the computer will be unable to use Windows Sockets
    applications to access any Internet sites through a dial-up
    connection to a private Internet service provider (ISP). This
    might occur, for example, if a user has a home computer that
    is sometimes used to connect to the corporate network, and
    sometimes to a private ISP. To correct this condition, you
    can turn the WinSock Proxy client on and off using the
    WinSock Proxy Client application in the Control Panel.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>WinSock Proxy
service problems with other third-party TCP/IP stacks.</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">Currently,
    Microsoft Proxy Server has not been tested with other
    third-party TCP/IP implementations. Use of a third-party
    stack may produce unpredictable results.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Windows For
Workgroups clients using IPX not able to access WinSock Proxy
Service for Proxy Server.</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">IPX is currently
    supported only for Windows&nbsp;95 and Windows&nbsp;NT
    clients.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Prompting to
&#147;Enter domain credentials&#148; each time a new Windows
Sockets application is launched.</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">Domain credentials
    are required each time a new Windows Sockets application is
    launched and another Windows Sockets application is not
    currently active. If the first Windows Sockets application is
    left open and minimized, there is no need to resupply domain
    credentials for successive Windows Sockets applications that
    are loaded for the same domain. </font></p>
</blockquote>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="4h1"><font size="2"
face="Verdana, Arial, Helvetica">Performance Troubleshooting</font></a></h1>

<p><font color="#000000" size="2" face="Verdana, Arial, Helvetica"><strong>Browsing
internal Web sites works, but external WWW sites do not appear in
user browse lists.</strong></font></p>

<blockquote>
    <p><font color="#000000" size="2" face="Verdana, Arial, Helvetica">Try
    to ping the server IP address for </font><font size="2"
    face="Verdana, Arial, Helvetica">Microsoft Proxy</font><font
    color="#000000" size="2" face="Verdana, Arial, Helvetica"> Server from
    the client computer&#146;s command prompt. </font></p>
    <p><font color="#000000" size="2" face="Verdana, Arial, Helvetica">If
    the response is &#147;Bad IP address,&#148; check to see if
    you have any local WINS or DNS servers used for client
    address resolution. Verify that any active name servers used
    for your client TCP/IP protocol configuration are configured
    correctly. For further assistance, contact your network
    administrator. </font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Private network
performance is slow for all clients accessing the same server.</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">If performance is
    slow for WinSock Proxy client requests to particular servers
    on the private network, check that the IP addresses of those
    servers are included in the Local Address Table (LAT). The
    information in the LAT identifies the range of IP addresses
    of your private network. If an internal server is not listed
    in the LAT, WinSock Proxy clients will redirect their
    connections to it through Microsoft Proxy Server.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">To check or correct
    this condition, use Microsoft Internet Service Manager and,
    for each computer running Microsoft Proxy Server in your
    network, review the IP address ranges listed in the <strong>Construct
    Local Address Table </strong>dialog box. (This dialog box is
    accessible from the <strong>Edit Local Address Table (LAT)</strong>
    button, on the <strong>Services</strong> property sheet of
    both the WinSock Proxy and Web Proxy services.) </font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">Add IP address
    ranges or individual IP addresses as necessary.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">&#150;Or&#150;</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">You can directly
    read and edit the Msplat.txt file, located by default in the
    C:\Msp\clients directory of each computer running Microsoft
    Proxy Server.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Slow connection
from a client using a Windows Sockets connected application on a
local network.</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">If certain local
    addresses are slow, the problem may be caused by WinSock
    Proxy attempting to redirect a local connection. To prevent
    this, check that the local computer you are attempting to
    establish connection to is defined in the Local Address Table
    (LAT). The client LAT is contained in C:\Mspclnt\Msplat.txt.</font></p>
</blockquote>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="5h1"><font size="2"
face="Verdana, Arial, Helvetica">RAS Troubleshooting</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>RAS does not
hang up calls or disconnect properly after dialing</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">To ensure that RAS
    always disconnects after each dialing attempt, a value in
    seconds for <strong>Idle seconds before hanging up</strong>
    must be set in Logon Preferences for the RAS phonebook entry
    that is used by Microsoft Proxy Server for dial-out. Dialing
    settings made in User Preferences are not observed when a
    non-user service (such as Microsoft Proxy Server) dials.
    Logon preferences are accessed by selecting <strong>More</strong>
    from within Dial-Up Networking. For more information on
    configuring RAS preferences, see RAS online Help or your
    Windows NT product documentation. </font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"></font>&nbsp;</p>

<hr>

<p align="center"><font size="2" face="Verdana, Arial, Helvetica"><i>©
1996 by Microsoft Corporation. All rights reserved.</i> </font></p>
</FONT>
</FONT>
</BODY>
</html>
