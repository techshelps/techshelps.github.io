<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<HEAD>
<meta name="PREMIUM" content="MSDN">
<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">
<meta name="MS.LOCALE" content="EN-US">
<meta name="DESCRIPTION" content="This page is from the Microsoft Proxy Server book, found in the Tools and Technologies Section in the MSDN Library">



<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Appendix F: WinSock Proxy Service Reference</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>


<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<p align="left"><a name="Top"><img src="onepix.gif" alt="Space"
align="top" border="0" width="1" height="1"></A></p>

<hr>

<h3><a name="AppendixF"><font size="2" face="Verdana, Arial, Helvetica"><br>
Appendix F</font></a></h3>

<h1><a name="WSPServiceReference"><font size="6"
face="Verdana, Arial, Helvetica">WinSock Proxy Service Reference</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">This appendix provides
a reference to the property sheets and dialog boxes displayed in
Internet Service Manager for the WinSock Proxy service of
Microsoft Proxy Server.</font></p>

<blockquote>
    <p><a href="#900h2"><font size="2" face="Verdana, Arial, Helvetica">Opening
    the Administrative Interface for the WinSock Proxy Service</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#6h2"><font size="2" face="Verdana, Arial, Helvetica">WinSock
    Proxy Service Properties</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#99h2"><font size="2" face="Verdana, Arial, Helvetica">WinSock
    Proxy Protocols Properties</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#7h2"><font size="2" face="Verdana, Arial, Helvetica">WinSock
    Proxy Permissions Properties</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#8h2"><font size="2" face="Verdana, Arial, Helvetica">WinSock
    Proxy Logging Properties</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#9h2"><font size="2" face="Verdana, Arial, Helvetica">WinSock
    Proxy Filters Properties</font></a></p>
</blockquote>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="900h2"><font size="2"
face="Verdana, Arial, Helvetica">Opening the Administrative Interface for
the WinSock Proxy Service</font></a></h1>

<h4><a
name="ToopentheadministrativeinterfacefortheWinSockProxyservice"><font
size="2" face="Verdana, Arial, Helvetica"><b>To open the administrative
interface for the WinSock Proxy service</b></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the server&#146;s desktop, click <b>Start, </b>select <b>Programs,</b>
        and then select the <b>Microsoft Proxy Server</b> program
        group. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        <b>Internet Service Manager.</b> </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        Microsoft Internet Service Manager window is displayed </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">If
        necessary, connect to the server to be administered. From
        the <strong>Properties</strong> menu click <strong>Connect
        to Server</strong> and complete the dialog box that
        appears. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">This
        step is unnecessary if you are administering the local
        server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">In
        the Microsoft Internet Service Manager window, click the
        server name next to the WinSock Proxy service. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        <b>WinSock Proxy Service Properties</b> window appears.
        It contains tabs labeled <strong>Service, Protocols,
        Permissions, Logging, </strong>and <strong>Filters</strong>.
        </font></p>
    </li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">The following table
summarizes each WinSock Proxy service property tab.</font></p>

<table border="1" cellpadding="5" cellspacing="0" width="100%">
    <tr>
        <th align="left" valign="bottom" width="15%"><font
        size="2" face="Verdana, Arial, Helvetica">Property</font></th>
        <th align="left" valign="bottom" width="85%"><font
        size="2" face="Verdana, Arial, Helvetica">Description</font></th>
    </tr>
    <tr>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">Service</font></td>
        <td valign="top" width="85%"><font size="2"
        face="Verdana, Arial, Helvetica">Use the WinSock Proxy <strong>Service</strong>
        property sheet to display the product ID, to add a
        comment about the server or the WinSock Proxy service,
        and to edit the Local Address Table (LAT). </font></td>
    </tr>
    <tr>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">Protocols</font></td>
        <td valign="top" width="85%"><font size="2"
        face="Verdana, Arial, Helvetica">Use the WinSock Proxy <strong>Protocols</strong>
        property sheet to determine which Windows Sockets
        applications can be used to access the Internet through
        the WinSock Proxy service on this server, and for each
        protocol configuration, which ports can be used for
        outbound and inbound connections.</font></td>
    </tr>
    <tr>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">Permissions</font></td>
        <td valign="top" width="85%"><font size="2"
        face="Verdana, Arial, Helvetica">Use the WinSock Proxy <strong>Permissions</strong>
        property sheet to determine which users or groups of
        users can access the Internet by using a particular
        protocol configuration through the WinSock Proxy service
        on this server. Permissions are granted separately for
        each protocol configuration. </font></td>
    </tr>
    <tr>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">Logging</font></td>
        <td valign="top" width="85%"><font size="2"
        face="Verdana, Arial, Helvetica">Use the WinSock Proxy <strong>Logging</strong>
        property sheet to set the logging options for the WinSock
        Proxy service. Microsoft Proxy Server can log information
        about all Internet requests made by clients. It can log
        to a text file or to a table in an ODBC-compliant
        database (such as Microsoft Access or Microsoft SQL
        Server). </font></td>
    </tr>
    <tr>
        <td valign="top" width="15%"><font size="2"
        face="Verdana, Arial, Helvetica">Filters</font></td>
        <td valign="top" width="85%"><font size="2"
        face="Verdana, Arial, Helvetica">Use the WinSock Proxy <strong>Filters</strong>
        property sheet to grant or deny client access to Internet
        sites. The filtering set here is common to both services.
        It applies to all users who access the Internet using the
        Web Proxy or WinSock Proxy services on a server. </font></td>
    </tr>
</table>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="6h2"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Service Properties</font></a></h1>

<blockquote>
    <p><a href="#6700h2"><font size="2" face="Verdana, Arial, Helvetica">WinSock
    Proxy Service Property Sheet<br>
    </font></a><a href="#6800h2"><font size="2"
    face="Verdana, Arial, Helvetica">Local Address Table Configuration
    Dialog Box<br>
    </font></a><a href="#6900h2"><font size="2"
    face="Verdana, Arial, Helvetica">Construct Local Address Table Dialog
    Box</font></a></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="6700h2"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Service Property Sheet</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Use the WinSock Proxy <strong>Service</strong>
property sheet to display the product ID, to add a comment about
the server or the WinSock Proxy service, and to edit the Local
Address Table (LAT). </font></p>

<h4><a name="ToopentheWinSockProxy"><font size="2"
face="Verdana, Arial, Helvetica"><b>To open the WinSock Proxy</b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">In Internet
        Service Manager, open the WinSock Proxy service for the
        appropriate server, as described in </font><a
        href="#900h2"><font size="2" face="Verdana, Arial, Helvetica">Opening
        the Administrative Interface for the WinSock Proxy
        service.</font></a><p><font size="2"
        face="Verdana, Arial, Helvetica">By default, the <b>Service</b>
        tab should be selected. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">If it is not
        already selected, click the <b>Service</b> tab. </font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">The WinSock Proxy <b>Service</b>
property sheet has the following elements: </font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Product
        ID&nbsp;&nbsp;&nbsp;</b>This is the product
        identification number (product ID) for this copy of
        Microsoft Proxy Server. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">The product
        identification number is provided on the Certificate of
        Authenticity included with each copy of Microsoft Proxy
        Server. During installation it must be typed into a
        dialog box of the Setup program. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Comment&nbsp;&nbsp;&nbsp;</b>To
        add or change a comment, in the <strong>Comment</strong>
        box type a remark about the server or the WinSock Proxy
        service. When Internet Service Manager is set to display
        Report view, the text entered here will appear in the <strong>Comments</strong>
        column, next to the WinSock Proxy service for this
        server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Edit
        Local Address Table (LAT)&nbsp;&nbsp;&nbsp;</b>Click the <strong>Edit
        Local Address Table (LAT)</strong> button to modify the
        Local Address Table on the server. This table defines the
        IP addresses of your network, and is used by WinSock
        Proxy clients to determine whether Windows Sockets
        connections should be established directly with a server
        on the private network, or should be redirected to the
        Internet through the WinSock Proxy service on the server.
        <br>
        <br>
        </font></p>
    </li>
</ul>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="6800h2"><font size="2"
face="Verdana, Arial, Helvetica">Local Address Table Configuration Dialog
Box</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Use the <strong>Local
Address Table Configuration </strong>dialog box to create a list
of the IP addresses that constitute your private network. The
information you provide is used to create a table, called the
Local Address Table (LAT), that defines your private network.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Each time a Windows
Sockets application on a client attempts to establish a
connection to an IP address, the LAT is used to determine whether
the IP address is on the private network, or is external. If the
address is internal, the connection is made directly. If the
address is external, the connection is made remotely, through the
WinSock Proxy service of Microsoft Proxy Server.</font></p>

<h4><a name="ToopentheLocalAddressTableConfiguration"><font
size="2" face="Verdana, Arial, Helvetica"><b>To open the Local Address
Table Configuration </b></font></a></h4>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the WinSock
        Proxy <b>Service</b> property sheet, click <b>Edit Local
        Address Table (LAT)</b>.</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">The <b>Local Address
Table Configuration </b>dialog box has the following elements: </font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Edit&nbsp;&nbsp;&nbsp;</strong>Use
        the boxes under <strong>Edit</strong> to enter a pair of
        IP addresses to be added to the <strong>Internal IP
        Ranges</strong> list. You can add a single IP address by
        typing the same address in both boxes, or a range of IP
        addresses by typing the first IP address of the range in
        the <strong>From</strong> box, and the last IP address of
        the range in the <strong>To</strong> box. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>From&nbsp;&nbsp;&nbsp;</strong>Use
        the <strong>From</strong> box to enter the first address
        of a pair of IP addresses to be added to the <strong>Internal
        IP Ranges</strong> list. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">If you are
        adding a single IP address, enter it here. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">If you are
        adding a range of IP addresses, enter the first IP
        address of the range. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>To&nbsp;&nbsp;&nbsp;</strong>Use
        the <strong>To</strong> box to enter the second address
        of a pair of IP addresses to be added to the <strong>Internal
        IP Ranges</strong> list. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">If you are
        adding a single IP address, enter the same address that
        was entered in the <strong>From</strong> box. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">If you are
        adding a range of IP addresses, enter the last IP address
        of the range. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Add&nbsp;&nbsp;&nbsp;</strong>Use
        the <strong>Add</strong> button to move pairs of IP
        addresses from the <strong>From</strong> and <strong>To</strong>
        boxes to the <strong>Internal IP Ranges</strong> list. To
        add a range of IP addresses to the list, under <strong>Edit</strong>
        type a pair of addresses in the <strong>From</strong> and
        <strong>To</strong> boxes, and then click <strong>Add</strong>.
        To add a single IP address to the list, under <strong>Edit</strong>
        type the same address in both the <strong>From</strong>
        and <strong>To</strong> boxes, and then click <strong>Add</strong>.
        </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Remove&nbsp;&nbsp;&nbsp;</strong>Use
        the <strong>Remove</strong> button to delete pairs of IP
        addresses from the <strong>Internal IP Ranges</strong>
        list. To remove an IP address or address pair from the
        list, select it from the <strong>Internal IP Ranges</strong>
        box, and then click <strong>Remove</strong>. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Internal
        IP Ranges&nbsp;&nbsp;&nbsp;</strong>Each IP address pair
        in the <strong>Internal IP Ranges</strong> list
        identifies a range of addresses that are part of your
        private network. Addresses can be added to the list by
        clicking the <strong>Construct Table</strong> button, or
        by typing IP address pairs in the <strong>From</strong>
        and <strong>To</strong> boxes and then clicking <strong>Add</strong>.
        </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note&nbsp;&nbsp;&nbsp;</strong>Each
        IP address pair identifies either a range of addresses,
        or a single IP address. The second entry is not a subnet
        mask. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Construct
        Table&nbsp;&nbsp;&nbsp;</strong>To generate the list of
        IP address pairs from internal routing tables used by
        Windows&nbsp;NT Server, click <strong>Construct Table</strong>
        and complete the <strong>Construct Local Address Table</strong>
        dialog box that appears. <br>
        <br>
        </font></p>
    </li>
</ul>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="6900h2"><font size="2"
face="Verdana, Arial, Helvetica">Construct Local Address Table Dialog Box</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Use the <strong>Construct
Local Address Table</strong> dialog box to determine which IP
addresses will be added to the Local Address Table (LAT). </font></p>

<h4><font size="2" face="Verdana, Arial, Helvetica"><b>To open the
Construct Local Address Table dialog box</b></font></h4>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the <strong>Local
        Address Table Configuration</strong> dialog box, click <strong>Construct
        Table</strong>.</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">The <strong>Construct
Local Address Table</strong><b> </b>dialog box has the following
elements: </font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Add
        the private ranges&nbsp;&nbsp;&nbsp;</strong>To add to
        the LAT three ranges of IP addresses defined by IANA as
        private address ranges that can be used in a private IP
        network that is not connected to the Internet, select the
        <strong>Add the private ranges</strong> check box. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Load
        from NT Internal Routing Table&nbsp;&nbsp;&nbsp;</strong>Click
        this option to load IP addresses accessible through some
        or all of the server&#146;s network adapter cards. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Load
        known address ranges from all IP interface
        cards&nbsp;&nbsp;&nbsp;</strong>If you do not know which
        of the server&#146;s cards are connected to the private
        network and which are connected to the Internet, select
        this option. IP addresses accessible through any of the
        server&#146;s network adapter cards will be added to the
        LAT. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">However, if you
        choose this option, after you complete the <strong>Construct
        Local Address Table</strong> dialog box and return to the
        <strong>Local Address Table Configuration</strong> dialog
        box you will need to review the generated list of IP
        ranges. Use the edit controls in the <strong>Local
        Address Table Configuration</strong> dialog box to remove
        any IP address pairs that define external (Internet)
        addresses. Also add any needed IP address pairs until all
        addresses of your internal network are defined. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Load
        known address ranges from the following IP interface
        cards&nbsp;&nbsp;&nbsp;</strong>If you know which of the
        server&#146;s network adapter cards are connected to the
        private network and which are connected to the Internet,
        select this option. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">Then, in the
        list of network adapter cards, select the check box for
        each of the internally connected cards, and clear the
        check box for each of the externally connected cards. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Network
        Adapter Cards&nbsp;&nbsp;&nbsp;</strong>The server&#146;s
        network adapter cards are listed below the <strong>Load
        known address ranges from the following IP interface
        cards</strong> option. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">If a network
        adapter card is connected to the private network, select
        its check box. The IP addresses accessible through that
        card will be added to the Local Address Table (LAT). If a
        network adapter card is connected to the Internet, clear
        its check box. The IP addresses accessible through that
        card will be excluded from the LAT. </font></p>
    </li>
</ul>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="99h2"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Protocols Properties</font></a></h1>

<blockquote>
    <p><a href="#9030h3"><font size="2" face="Verdana, Arial, Helvetica">WinSock
    Proxy Protocols Property Sheet</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#311h3"><font size="2"
    face="Verdana, Arial, Helvetica">Protocol Definition Dialog Box</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#391h3"><font size="2"
    face="Verdana, Arial, Helvetica">Port Range Definition Dialog Box</font></a></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="9030h3"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Protocols Property Sheet</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Use the WinSock Proxy <strong>Protocols</strong>
property sheet to determine which Windows Sockets applications
can be used to access the Internet through the WinSock Proxy
service on this server, and for each protocol configuration,
which ports can be used for outbound and inbound connections.</font></p>

<h4><a name="ToopentheWinSockProxyProtocols"><font size="2"
face="Verdana, Arial, Helvetica"><b>To open the WinSock Proxy Protocols </b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">In Internet
        Service Manager, open the WinSock Proxy service for the
        appropriate server, as described in </font><a
        href="#900h2"><font size="2" face="Verdana, Arial, Helvetica">Opening
        the Administrative Interface for the WinSock Proxy
        service</font></a><font size="2" face="Verdana, Arial, Helvetica">,
        earlier in this appendix.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <b>Protocols</b>
        tab. </font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">The WinSock Proxy <b>Protocols</b>
property sheet has the following elements: </font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica"><b>Protocol
        Definitions&nbsp;&nbsp;&nbsp;</b>This box lists the
        protocol configurations (supporting Windows Sockets
        applications) that can be used to access the Internet
        through the WinSock Proxy service on this server. </font><p><font
        size="2" face="Verdana, Arial, Helvetica">When Microsoft Proxy
        Server is installed, a default set of protocol
        configurations are created and will appear in this list.
        Use the <strong>Add</strong>, <strong>Edit</strong>, and <strong>Remove</strong>
        buttons to modify the list. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Add&nbsp;&nbsp;&nbsp;</b>To
        configure a protocol and add it to the list of protocols
        that can be used to access the Internet through the
        WinSock Proxy service on the server, click <strong>Add</strong>
        and complete the <strong>Protocol Definition</strong>
        dialog box that appears. The protocol is added to the <strong>Protocol
        Definitions</strong> list. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Edit&nbsp;&nbsp;&nbsp;</b>To
        modify the settings for a configured protocol, select a
        protocol from the <strong>Protocol Definitions</strong>
        list, click <strong>Edit</strong>, and complete the <strong>Protocol
        Definition</strong> dialog box that appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Remove&nbsp;&nbsp;&nbsp;</b>To
        delete a protocol configuration, select it from the <strong>Protocol
        Definitions</strong> list and click <strong>Remove</strong>.<br>
        <br>
        </font></p>
    </li>
</ul>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="311h3"><font size="2"
face="Verdana, Arial, Helvetica">Protocol Definition Dialog Box</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Use the <strong>Protocol
Definition</strong> dialog box to configure protocols for use
with the WinSock Proxy service on this computer. </font></p>

<h4><font size="2" face="Verdana, Arial, Helvetica"><b>To open the
Protocol Definition dialog box</b></font></h4>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the WinSock
        Proxy <b>Protocols</b> property sheet, click <b>Add</b>. </font><p><font
        size="2" face="Verdana, Arial, Helvetica">&#150;Or&#150; </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">Select an item
        from the <b>Service Definitions</b> list and click <b>Edit.</b>
        </font></p>
    </li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">The <b>Protocol
Definition</b> dialog box has the following elements: </font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Protocol
        Name&nbsp;&nbsp;&nbsp;</strong>Type the name of a
        protocol definition to be added to the WinSock Proxy
        service for this server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Initial
        Connection&nbsp;&nbsp;&nbsp;</strong>Use the<strong>
        Initial Connections </strong>options to define how each
        initial connection using this protocol definition will be
        handled. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Port&nbsp;&nbsp;&nbsp;</strong>Type
        the port number that will be used for initial connections
        by this protocol definition. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Type&nbsp;&nbsp;&nbsp;</strong>Specify
        the protocol type that will be used for initial
        connections. Select <strong>TCP</strong> (for
        Transmission Control Protocol) or <strong>UDP</strong>
        (for User Datagram Protocol). </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>TCP&nbsp;&nbsp;&nbsp;</strong>Select
        <strong>TCP</strong> when Transmission Control Protocol
        should be used for initial connections. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>UDP&nbsp;&nbsp;&nbsp;</strong>Select
        <strong>UDP</strong> when the User Datagram Protocol
        should be used for initial connections. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Direction&nbsp;&nbsp;&nbsp;</strong>Specify
        whether the initial connection port will be configured
        for <strong>Outbound</strong> or <strong>Inbound</strong>.
        </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Inbound&nbsp;&nbsp;&nbsp;</strong>If
        you selected <strong>TCP</strong>, select <strong>Inbound</strong>
        to allow external sites to initiate connections to
        clients through the port. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">If you selected
        <strong>UDP</strong>, select <strong>Inbound</strong> to
        allow the port to pass packets sent from an external site
        to a client. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Outbound&nbsp;&nbsp;&nbsp;</strong>If
        you selected <strong>TCP</strong>, select <strong>Outbound</strong>
        to allow clients to initiate connections to external
        sites through the port. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">If you selected
        <strong>UDP</strong>, select <strong>Outbound</strong> to
        allow the port to pass packets sent from a client to an
        external site. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Port
        Ranges for Subsequent Connections&nbsp;&nbsp;&nbsp;</strong>Use
        the <strong>Port Ranges for Subsequent Connections</strong>
        options to define how to handle connections or packets
        that originate as a result of requests or packets sent on
        the initial connection&#146;s port number. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">The list under <strong>Port
        Ranges for Subsequent Connections</strong> displays the
        port, packet type, and direction for each existing
        subsequent connection configuration. (Note that a port
        range of 0 indicates <strong>Any</strong>, which permits
        connections to ports 1024-5000.) </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Add&nbsp;&nbsp;&nbsp;</strong>To
        specify a port or port range that will be used for
        subsequent connections, click <strong>Add</strong>, and
        complete the <strong>Port Range Definition</strong>
        dialog box that appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Edit&nbsp;&nbsp;&nbsp;</strong>To
        modify the settings for a port range for a subsequent
        connection, select the port range from the <strong>Port
        Ranges for Subsequent Connections</strong> list, click <strong>Edit</strong>,
        and complete the <strong>Port Range Definition</strong>
        dialog box that appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Remove&nbsp;&nbsp;&nbsp;</strong>To
        remove a port or port range from the list of those that
        will be used for subsequent connections, select the port
        range from the <strong>Port Ranges for Subsequent
        Connections</strong> list and click <strong>Remove</strong>.
        <br>
        <br>
        </font></p>
    </li>
</ul>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="391h3"><font size="2"
face="Verdana, Arial, Helvetica">Port Range Definition Dialog Box</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Use the<strong> Port
Range Definition </strong>dialog box to set the parameters for
subsequent connections. Subsequent connections are those that
originate as a result of requests or packets sent on the initial
connection&#146;s port number. The subsequent connection
parameters include the port number or range, the protocol type,
and the direction.</font></p>

<h4><a name="ToopenthePortRange"><font size="2"
face="Verdana, Arial, Helvetica"><b>To open the Port Range </b></font></a></h4>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the WinSock
        Proxy <b>Protocol Definition </b>dialog box, click <b>Add</b>.
        </font><p><font size="2" face="Verdana, Arial, Helvetica">&#150;Or&#150;
        </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">Select an item
        from the <b>Port Ranges for Subsequent Connections </b>list
        and click <b>Edit.</b> </font></p>
    </li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">The <b>Port Range
Definition</b> dialog box has the following elements: </font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Port
        or Range&nbsp;&nbsp;&nbsp;</strong>In the <strong>Port or
        Range</strong> boxes, enter a single port or a range of
        port numbers to use for subsequent connections. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">Note that you
        can enter 0 to indicate <strong>Any</strong>, which
        allows connections to ports 1024-5000. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Type&nbsp;&nbsp;&nbsp;</strong>Specify
        the protocol type that will be used for subsequent
        connections. Select <strong>TCP</strong> (for
        Transmission Control Protocol) or <strong>UDP</strong>
        (for User Datagram Protocol). </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>TCP&nbsp;&nbsp;&nbsp;</strong>Select
        <strong>TCP</strong> when the Transmission Control
        Protocol should be used for subsequent connections. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>UDP&nbsp;&nbsp;&nbsp;</strong>Select
        <strong>UDP</strong> when the User Datagram Protocol
        should be used for subsequent connections. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Direction&nbsp;&nbsp;&nbsp;</strong>Specify
        whether subsequent connection ports will be configured
        for <strong>Inbound</strong> or <strong>Outbound</strong>.
        </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Inbound&nbsp;&nbsp;&nbsp;</strong>If
        you selected <strong>TCP</strong>, select <strong>Inbound</strong>
        to allow external sites to initiate connections to
        clients through the port. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">If you selected
        <strong>UDP</strong>, select <strong>Inbound</strong> to
        allow the ports to pass packets sent from an external
        site to a client. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Outbound&nbsp;&nbsp;&nbsp;</strong>If
        you selected <strong>TCP</strong>, select <strong>Outbound</strong>
        to allow clients to initiate connections to external
        sites through the port. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">If you selected
        <strong>UDP</strong>, select <strong>Outbound</strong> to
        allow the ports to pass packets sent from a client to an
        external site. </font></p>
    </li>
</ul>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="7h2"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Permissions Properties</font></a></h1>

<blockquote>
    <p><a href="#700h3"><font size="2" face="Verdana, Arial, Helvetica">WinSock
    Proxy Permissions Property Sheet</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#920h3"><font size="2"
    face="Verdana, Arial, Helvetica">WinSock Proxy Add Users and Groups
    Dialog Box<br>
    </font></a><a href="#6850h2"><font size="2"
    face="Verdana, Arial, Helvetica">Protocol Selection Dialog Box</font></a></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="700h3"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Permissions Property Sheet</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Use the WinSock Proxy <strong>Permissions</strong>
property sheet to determine which users or groups of users can
access the Internet using a particular protocol configuration
through the WinSock Proxy service on this server. </font></p>

<h4><a name="ToopentheWinSockProxyPermissionspropertysheet"><font
size="2" face="Verdana, Arial, Helvetica"><b>To open the WinSock Proxy
Permissions property sheet</b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">In Internet
        Service Manager, open the WinSock Proxy service for the
        appropriate server, as described in </font><a
        href="#900h2"><font size="2" face="Verdana, Arial, Helvetica">Opening
        the Administrative Interface for the WinSock Proxy
        service</font></a><font size="2" face="Verdana, Arial, Helvetica">,
        earlier in this appendix.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <b>Permissions</b>
        tab. </font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">The WinSock Proxy <b>Permissions</b>
property sheet has the following elements: </font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Enable
        Access Control&nbsp;&nbsp;&nbsp;</strong>Select this
        check box to enable access control. With access control,
        only users who are granted WinSock Proxy permissions can
        use WinSock Proxy protocols to access the Internet
        through the WinSock Proxy service. By default this check
        box is selected. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">Clear this
        check box to disable access control. Without access
        control, any WinSock client can access the Internet
        through the WinSock Proxy service (the WinSock Proxy
        equivalent of Anonymous access). </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Protocol&nbsp;&nbsp;&nbsp;</b>This
        box lists the protocol configurations that have been
        created for this server and are available to users of the
        WinSock Proxy service. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">A special
        selection in the this list, <strong>Unlimited Access</strong>,
        allows access to all protocols and all ports of this
        server. This includes ports not defined in any protocol
        configuration. Also, users granted <strong>Unlimited
        Access</strong> are not affected by WinSock Proxy domain
        filtering. Grant permission to <strong>Unlimited Access</strong>
        only to users who should have such access. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;The
        protocol definitions that appear in the list are added,
        removed, and modified by using the <strong>Protocols</strong>
        property sheet. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><b>Grant Access
        To&nbsp;&nbsp;&nbsp;</b>This box lists the users and
        groups permitted to use the protocol that is selected in
        the <strong>Protocol</strong> box. </font></li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Add&nbsp;&nbsp;&nbsp;</b>To
        grant a user or group permission to use a WinSock Proxy
        protocol to access the Internet, select the protocol from
        the list in the <strong>Protocol</strong> box, choose <strong>Add</strong>,
        and complete the <strong>Add Users and Groups</strong>
        dialog box that appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Remove&nbsp;&nbsp;&nbsp;</b>To
        revoke permission to use a protocol, select the protocol
        from the <strong>Protocol</strong> list, select one or
        more users and groups from the list in the box below, and
        choose <strong>Remove</strong>. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Copy
        To&nbsp;&nbsp;&nbsp;</b>This button allows you to grant
        permissions for more than one protocol at a time. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">To grant users
        access permission for several protocols, select a
        protocol from the <strong>Protocol</strong> list, select
        one or more users and groups from the <strong>Grant
        Access To</strong> list, click <strong>Copy To</strong>,
        and complete the <strong>Protocol Selection</strong>
        dialog box that appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Remove
        From&nbsp;&nbsp;&nbsp;</b>This button allows you to
        revoke permissions for more than one protocol at a time. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">To deny users
        permission for several protocols, select a protocol from
        the <strong>Protocol</strong> list, select one or more
        users and groups from <strong>Grant Access To</strong>
        list, click <strong>Remove From,</strong> and complete
        the <strong>Protocol Selection</strong> dialog box that
        appears. <br>
        <br>
        </font></p>
    </li>
</ul>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="920h3"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Add Users and Groups Dialog
Box</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Use the <b>Add Users
and Groups</b> dialog box to grant a user or to a group
permission to use the selected protocol configuration to access
the Internet through the WinSock Proxy service on the server. You
can grant access to users and groups from this server, from the
local Windows&nbsp;NT domain, and from trusted Windows&nbsp;NT
domains. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica"><b>Tip&nbsp;&nbsp;&nbsp;</b>It
is a good idea to use User Manager for Domains to create a user
group containing the user accounts of all users who need access
to WWW, FTP, or Gopher. Then, for each protocol, you only have to
apply permissions once for the entire group, rather than for each
individual member. For more information about user groups and
about User Manager for Domains, see your documentation for
Windows&nbsp;NT. </font></p>

<h4><a name="ToopentheAddUsersandGroupsdialogbox"><font size="2"
face="Verdana, Arial, Helvetica"><b>To open the Add Users and Groups
dialog box</b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">In the WinSock
        Proxy <b>Permissions</b> property sheet, select a
        protocol from the <strong>Protocols</strong> box. </font></li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        <b>Add.</b> </font></p>
    </li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">The <b>Add Users and
Groups</b> dialog box has the following elements: </font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>List
        Names From&nbsp;&nbsp;&nbsp;</b>Select a computer or
        domain. The groups of that domain will be listed in the <b>Names</b>
        box. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Names&nbsp;&nbsp;&nbsp;</b>Lists
        the groups of the selected computer or domain. If <b>Show
        Users</b> has been clicked, also lists user accounts. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">Local groups
        (as distinct from global groups) are a special case. When
        an asterisk (*) appears next to a domain or computer name
        in the <b>List Names From</b> box, it indicates that the
        local groups of that domain or computer can be listed in <b>Names.</b>
        When the asterisk is absent, it indicates that local
        groups cannot be listed. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Add&nbsp;&nbsp;&nbsp;</b>After
        selecting users or groups in <b>Names,</b> click <b>Add</b>
        to move the names to the <b>Add Names</b> list. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Show
        Users&nbsp;&nbsp;&nbsp;</b>By default, only groups are
        listed in <b>Names.</b> Select <b>Show Users</b> to also
        display user accounts in <b>Names.</b> </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Members&nbsp;&nbsp;&nbsp;</b>To
        view the members of a listed group, select the group in <b>Names</b>
        and then click <b>Members.</b> The <b>Group Membership</b>
        dialog box will appear. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Search&nbsp;&nbsp;&nbsp;</b>To
        search for a particular user or group, click <b>Search</b>
        and complete the <b>Find Account</b> dialog box that
        appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Add
        Names&nbsp;&nbsp;&nbsp;</b>When you click <b>OK,</b> the
        list of users and groups in <b>Add Names</b> is added to
        the list in the <b>Permissions</b> property sheet. You
        choose which users or groups to add to this list. You can
        add users and groups to the <b>Add Names</b> list by
        typing the account names (separated by colons); by
        selecting the names from the <b>Names</b> list and
        clicking <b>Add;</b> by clicking <b>Search</b> and
        completing the <b>Find Account</b> dialog box; or by
        selecting a group from <b>Names,</b> clicking <b>Members,</b>
        and completing the <b>Group Membership</b> dialog box. <br>
        <br>
        </font></p>
    </li>
</ul>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="6850h2"><font size="2"
face="Verdana, Arial, Helvetica">Protocol Selection Dialog Box</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Use the <b>Protoc</b><strong>ol
Selection</strong> dialog box to grant or remove user access
permissions for several WinSock Proxy protocols.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">In the <strong>Permissions</strong>
property sheet (the window described in the preceding section)
you selected one or more users and groups. Now, in the <strong>Protocol
Selection</strong> dialog box:</font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">If
        you clicked <strong>Copy To</strong> in <strong>Permissions</strong>,
        then the protocols you select in this dialog box are the
        protocols for which those users will have access
        permissions added. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">If you clicked <strong>Remove
        From</strong> in <strong>Permissions</strong>, then the
        protocols you select in this dialog box are the protocols
        for which those users will have their access permissions
        revoked.<br>
        <br>
        </font></li>
</ul>

<h4><a name="ToopentheProtocolSelectiondialogbox"><font size="2"
face="Verdana, Arial, Helvetica"><b>To open the Protocol Selection dialog
box</b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">In the <b>Permissions</b>
        property sheet, select a protocol from the <strong>Protocols</strong>
        box.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the <strong>Grant
        Access To</strong> list, select one or more users and
        groups.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click either <b>Copy
        To</b> or <b>Remove From.</b></font></li>
</ol>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="8h2"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Logging Properties</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">Use the WinSock Proxy <strong>Logging</strong>
property sheet to set the logging options for the WinSock Proxy
service. Microsoft Proxy Server can log information about all
Internet requests made by clients. It can log to a text file or
to a table in an ODBC-compliant database (such as Microsoft
Access or Microsoft SQL Server). </font></p>

<h4><a name="ToopentheWinSockProxyLoggingpropertysheet"><font
size="2" face="Verdana, Arial, Helvetica"><b>To open the WinSock Proxy
Logging property sheet</b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">In Internet
        Service Manager, open the WinSock Proxy service for the
        appropriate server, as described in </font><a
        href="#900h2"><font size="2" face="Verdana, Arial, Helvetica">Opening
        the Administrative Interface for the WinSock Proxy
        service.</font></a><font size="2" face="Verdana, Arial, Helvetica">
        </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <b>Logging</b>
        tab. </font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">The WinSock Proxy <b>Logging</b>
property sheet has the following elements: </font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Enable
        Logging&nbsp;&nbsp;&nbsp;</b>Select <b>Enable Logging</b>
        to log Internet accesses to a text file, or to a table in
        a SQL or ODBC-compliant database. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Regular
        Logging&nbsp;&nbsp;&nbsp;</b>Records only a subset of all
        available information for each Internet access. This
        option reduces the disk space needed for a log file. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Verbose
        Logging</b>&nbsp;&nbsp;&nbsp;Records all available
        information for each Internet access. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><b>Log To File</b>
        </font><p><font size="2" face="Verdana, Arial, Helvetica">Saves
        log information to a text file. This text file can be
        viewed with a text editor, such as Notepad. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Automatically
        open new log file&nbsp;&nbsp;&nbsp;</b>When selected,
        periodically begins a new log file, using the interval
        specified by the <b>Daily,</b> <b>Weekly,</b> <b>Monthly,</b>
        or <b>When File Size Reaches</b> options. When a new log
        file is started, the old log file is closed (and can
        optionally be archived on other storage media). </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">When cleared,
        the same WinSock Proxy log file is used continuously. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Daily,
        Weekly, or Monthly&nbsp;&nbsp;&nbsp;</b>Selecting one of
        these options specifies that a new log file should be
        started at daily, weekly, or monthly intervals. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>When
        file size reaches&nbsp;&nbsp;&nbsp;</b>Starts a new file
        each time the log file reaches the specified size. The
        log file will be closed when it reaches this size. Closed
        log files can then be stored on disk or other media. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>MB&nbsp;&nbsp;&nbsp;</b>The
        value in this box determines the file size that, when
        reached in the current log files, causes a new log file
        to be started. To change this value, type a number or
        click the arrows. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Log
        file directory&nbsp;&nbsp;&nbsp;</b>Displays the path
        where WinSock Proxy log files are written and stored. To
        change this location, type a new path. Although it is
        possible to write a log file to another computer on your
        network, it is recommended that you write your WinSock
        Proxy log file to the local hard disk of the computer
        running Microsoft Proxy Server. To help prevent the disk
        filling up, it is a good idea to store the logs and the
        Web Proxy cache on different volumes. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">The default is
        to place WinSock Proxy service text file logs under this
        path: </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica"><b>C:\Winnt\System32\Wsplogs</b>.
        </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Browse&nbsp;&nbsp;&nbsp;</b>If
        you want to change the <b>Log file directory</b> but are
        not sure of the new path, you can click <b>Browse</b> and
        complete the <b>Select Directory</b> dialog box. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Log
        file name&nbsp;&nbsp;&nbsp;</b>Microsoft Proxy Server
        generates the WinSock Proxy log file name for you. When
        WinSock Proxy logs files are opened daily the file name
        takes the format WS<em>yymmdd</em>.log, where <em>yy</em>
        is a number representing the year, <em>mm</em> is a
        number representing the month, and <em>dd</em> is a
        number representing the day of the month. For weekly logs
        the format is WSW<em>yymmw</em>.log, where <em>w</em> is
        a number between 1 and 5. For monthly logs, the format is
        WSM<em>yymm</em>.log. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">When the <strong>Automatically
        open new log</strong> option is selected and a new
        WinSock Proxy log file is opened each time the log file
        reaches a specified size, the file name takes the format
        WSB<em>nnnn</em>.log, where <em>nnnn</em> is a number
        that increments with each new log. For example,
        WSB0007.log. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Log
        to SQL/ODBC Database&nbsp;&nbsp;&nbsp;</b>Choose this
        option to write all Internet accesses to a table in an
        SQL or ODBC-compliant database. Writing log data to a
        database is slower than writing to a text file, but data
        querying and reporting are enhanced by using an SQL or
        ODBC-compliant database (such as Microsoft SQL Server or
        Microsoft Access). </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">Log files are
        stored in one table. Each Internet transaction generates
        one record in the table. The database can exist on the
        computer running Microsoft Proxy Server or on another
        computer on your private network. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>ODBC
        data source name (DSN)&nbsp;&nbsp;&nbsp;</b>Type the ODBC
        Data Source Name (DSN) for the database that the WinSock
        Proxy service will be logging to. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Table&nbsp;&nbsp;&nbsp;</b>Type
        the name of a table in the database. Microsoft Proxy
        Server will log WinSock Proxy service information to this
        table. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>User
        Name&nbsp;&nbsp;&nbsp;</b>Type a valid user name for the
        database table. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Password&nbsp;&nbsp;&nbsp;</b>If
        the table is password protected, type the password. </font></p>
    </li>
</ul>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="9h2"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Filters Properties</font></a></h1>

<blockquote>
    <p><a href="#710h2"><font size="2" face="Verdana, Arial, Helvetica">WinSock
    Proxy Filters Property Sheet</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#701h3"><font size="2"
    face="Verdana, Arial, Helvetica">WinSock Proxy Deny or Grant Access To
    Dialog Box</font></a></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="710h2"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Filters Property Sheet</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Use the WinSock Proxy <strong>Filters</strong>
property sheet to grant or deny client access to Internet sites.
The filtering set here is common to both services. It applies to
all users who access the Internet using the Web Proxy or WinSock
Proxy services on a server. </font></p>

<h4><a name="ToopentheWinSockProxyFilterspropertysheet"><font
size="2" face="Verdana, Arial, Helvetica"><b>To open the WinSock Proxy
Filters property sheet</b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">In Internet
        Service Manager, open the WinSock Proxy service for the
        appropriate server, as described in </font><a
        href="#900h2"><font size="2" face="Verdana, Arial, Helvetica">Opening
        the Administrative Interface for the WinSock Proxy
        service</font></a><font size="2" face="Verdana, Arial, Helvetica">,
        earlier in this appendix.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <b>Filters</b>
        tab. </font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">The WinSock Proxy <b>Filters</b>
property sheet has the following elements: </font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Enable
        Filtering&nbsp;&nbsp;&nbsp;</b>Select this option to
        implement access filtering, which controls client access
        to Internet sites. You can use access filtering to
        prohibit access to specified sites or to allow access to
        only the sites specified. The filtering applies to all
        users who access the Internet through this server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Granted&nbsp;&nbsp;&nbsp;</b>When
        this option is selected, users who access the Internet
        through this server are granted access to all Internet
        sites, except for those that are listed. (Access is
        denied only for the listed sites.) </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Denied&nbsp;&nbsp;&nbsp;</b>When
        this option is selected, users who access the Internet
        through this server are denied access to all Internet
        sites, except for those that are listed. (Access is
        granted only for the listed sites.) </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Except
        to those listed below&nbsp;&nbsp;&nbsp;</b>The list
        displays the exceptions to the selected option (<b>Granted</b>
        or <b>Denied</b>). To change the list, use the <b>Add,</b>
        <b>Edit,</b> or <b>Remove</b> buttons. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Add&nbsp;&nbsp;&nbsp;</b>To
        add an item to the list of exceptions, choose <b>Add</b>
        and complete the dialog box that appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Edit&nbsp;&nbsp;&nbsp;</b>To
        alter a listed item, select it, choose <b>Edit,</b> and
        complete the dialog box that appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Remove&nbsp;&nbsp;&nbsp;</b>To
        remove an item from the list of exceptions, select the
        item and click <b>Remove.</b> <br>
        <br>
        </font></p>
    </li>
</ul>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="701h3"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Deny or Grant Access To
Dialog Box</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">If the <b>Granted</b>
option in the <b>Filters</b> property sheet is selected, use the <b>Deny
Access To</b> dialog box to specify an Internet site that all
users of a server will not be allowed to access. If the <b>Denied</b>
option in the <b>Filters</b> property sheet is selected, use the <b>Grant
Access To</b> dialog box to specify an Internet site that all
users of a server will be allowed to access. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Note that for the
WinSock Proxy service, filtering by domain name does not affect
Internet requests where the client application accesses a site
using an IP address. To effectively filter a site you may find it
useful to create filters both on the domain name and the IP
address.</font></p>

<h4><a name="ToopentheDenyAccessToorGrantAccessTodialogbox"><font
size="2" face="Verdana, Arial, Helvetica"><b>To open the Deny Access To or
Grant Access To dialog box</b></font></a></h4>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the WinSock
        Proxy <b>Filters</b> property sheet, click <b>Add.</b> </font><p><font
        size="2" face="Verdana, Arial, Helvetica">&#150;Or&#150; </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">From the
        WinSock Proxy <b>Filters</b> property sheet, select an
        item from the <b>Except to those listed below</b> list
        and click <b>Edit.</b> </font></p>
    </li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">The WinSock Proxy <b>Deny
Access To</b> or <b>Grant Access To</b> dialog box has the
following elements: </font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Single
        Computer&nbsp;&nbsp;&nbsp;</b>Select this option to grant
        or deny access to a single computer. If you select this
        option, you must also enter the computer&#146;s IP
        address. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Group
        of Computers&nbsp;&nbsp;&nbsp;</b>Select this option to
        grant or deny access to a group of computers. If you
        select this option you must enter an IP address and a
        subnet mask. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Domain&nbsp;&nbsp;&nbsp;</b>Select
        this option to grant or deny access to a domain or to
        multiple sites with similar domain names. If you select
        this option, you must enter a domain name in the <b>Domain
        Name</b> box. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>IP
        Address&nbsp;&nbsp;&nbsp;</b>If you have selected <b>Single
        Computer</b> or <b>Group of Computers,</b> enter the
        appropriate IP address in this box. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Subnet
        Mask&nbsp;&nbsp;&nbsp;</b>If you selected the <b>Group of
        Computers</b> option, enter the appropriate subnet mask
        in this box. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Domain&nbsp;&nbsp;&nbsp;</b>If
        you selected the <b>Domain</b> option, enter the domain
        name in this box. You can include a path within the
        domain. </font></p>
    </li>
</ul>

<hr>

<p align="center"><font size="2" face="Verdana, Arial, Helvetica"><i>
1996 by Microsoft Corporation. All rights reserved.</i> </font></p>
</FONT>
</FONT>
</BODY>
</html>
