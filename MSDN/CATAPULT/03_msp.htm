<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<HEAD>
<meta name="PREMIUM" content="MSDN">
<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">
<meta name="MS.LOCALE" content="EN-US">
<meta name="DESCRIPTION" content="This page is from the Microsoft Proxy Server book, found in the Tools and Technologies Section in the MSDN Library">



<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CHAPTER 3, Server Installation</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>


<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<p align="left"><a name="Top"><font size="2"
face="Verdana, Arial, Helvetica"><img src="onepix.gif" alt="Space"
align="top" width="1" height="1"></font></a></p>

<hr>

<h1><a name="ServerInstallation"><font size="6"
face="Verdana, Arial, Helvetica">Server Installation</font></a></h1>

<blockquote>
    <p><a href="#1h1"><font size="2" face="Verdana, Arial, Helvetica">Installation
    Overview</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#202h1"><font size="2"
    face="Verdana, Arial, Helvetica">What You Need to Know About the LAT</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#03_Port"><font size="2"
    face="Verdana, Arial, Helvetica">Setting the Web Proxy Listen-On Port</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#2h1"><font size="2" face="Verdana, Arial, Helvetica">Installing
    Microsoft Proxy Server</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#5h1"><font size="2" face="Verdana, Arial, Helvetica">Reviewing
    the Server Setup Log</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#4h1"><font size="2" face="Verdana, Arial, Helvetica">Reinstalling
    Microsoft Proxy Server</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#03rmv100"><font size="2"
    face="Verdana, Arial, Helvetica">Removing Microsoft Proxy Server</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#999h1"><font size="2"
    face="Verdana, Arial, Helvetica">Installing Only the Administration
    Tool</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#3h1"><font size="2" face="Verdana, Arial, Helvetica">Installing
    and Accessing the Documentation</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#3030h1"><font size="2"
    face="Verdana, Arial, Helvetica">Searching the Documentation</font></a></p>
</blockquote>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="1h1"><font size="2"
face="Verdana, Arial, Helvetica">Installation Overview</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">When you install
Microsoft Proxy Server: </font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">The Web Proxy
        service is installed on the server.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">The WinSock Proxy
        service is installed on the server.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">A shared network
        directory is created on the server, and a client setup
        program is placed there.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">The online
        documentation is installed.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">The administrative
        components are added to Internet Service Manager.</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">Before installing
Microsoft Proxy Server, be sure to read </font><a
href="02_msp.HTM#Top"><font size="2" face="Verdana, Arial, Helvetica">&#147;Preinstallation Requirements.&#148;</font></a><font
size="2" face="Verdana, Arial, Helvetica"> It contains important
information about installation. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For information about
upgrading from a preliminary release of Microsoft Proxy Server,
see the Readme.txt file provided on the Microsoft Proxy Server
compact disc.</font></p>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="202h1"><font size="2"
face="Verdana, Arial, Helvetica">What You Need to Know About the LAT</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">During Microsoft Proxy
Server installation you are asked to complete the <strong>Local
Address Table Configuration</strong> dialog box. The information
you provide is used to create a Local Address Table (LAT). This
section describes the LAT, tells you what the LAT does, and shows
you how the LAT is defined.</font></p>

<p><a href="#2021h2"><font size="2" face="Verdana, Arial, Helvetica">What
is the LAT?</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
</font><a href="#2022h2"><font size="2" face="Verdana, Arial, Helvetica">What
is a Local LAT?</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
</font><a href="#2023h2"><font size="2" face="Verdana, Arial, Helvetica">How
is the LAT Defined?</font></a><font size="2"
face="Verdana, Arial, Helvetica"><br>
</font><a href="#2024h2"><font size="2" face="Verdana, Arial, Helvetica">LAT
Configuration Considerations</font></a></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="2021h2"><font size="2"
face="Verdana, Arial, Helvetica">What is the LAT?</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">During Microsoft Proxy
Server installation, the Setup program helps you create a list of
the IP addresses that constitute your private network. The
information you provide is used to create a table, called the
Local Address Table (LAT), that defines your private network. IP
addresses that are external to your private network are
specifically excluded from this table. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The Setup program
installs the LAT on the server. The file containing the LAT is
named Msplat.txt and on the server its default location is
C:\Msp\Clients (if you install Microsoft Proxy Server in a
different location on the server, the Msplat.txt file is
relocated accordingly). The Microsoft Proxy Server Setup program
also installs a client Setup program into this directory.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The Microsoft Proxy
Server Setup program configures the \Clients subdirectory on the
server to be a network share named Mspclnt. Clients can connect
to this share by connecting to \\<em>Servername</em>\Mspclnt and
then running the client Setup program. The client Setup program
configures the client computer as a client of the WinSock Proxy
service, and also attempts to configure the client
computer&#146;s Internet browser as a client of the Web Proxy
service. (The exact client configuration that client Setup
implements depends on configuration choices you make during
Microsoft Proxy Server Setup.) </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">During client Setup,
the LAT file (Msplat.txt) is copied to the client. In order to
keep client LAT files current, the Msplat.txt file is regularly
updated from the server. Each time a Windows Sockets application
on that client attempts to establish a connection to an IP
address, the LAT is used to determine whether the IP address is
on the private network, or is external. If the address is
internal, the connection is made directly. If the address is
external, the connection is made remotely, through the WinSock
Proxy service on Microsoft Proxy Server.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Note that this is only
a basic overview of the LAT. For more information, see </font><a
href="DD_msp.HTM#Top"><font size="2" face="Verdana, Arial, Helvetica">Appendix
D, &#147;Architecture.&#148;</font></a></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="2022h2"><font size="2"
face="Verdana, Arial, Helvetica">What is a Local LAT?</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">In some situations, you
may need to provide access to additional internal IP addresses
for selected client computers. One way to accomplish this is to
create a custom LAT file for a client by editing its copy of the
Msplat.txt file. However, this would only be temporarily
effective, because each client&#146;s Msplat.txt file is
overwritten at regular intervals by a fresh version downloaded
from the server. Any changes you make locally are lost each time
the server updates the client&#146;s Msplat.txt file.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Instead, you can create
a permanent local LAT file for a client by creating a file named
Locallat.txt and placing it in the client&#146;s Mspclnt
directory. The client will use both the Msplat.txt and
Locallat.txt files if present. In this way, you can add
additional IP address ranges that the client recognizes as part
of the private network. This is useful, for example, to allow
client access to a private subnet inside a corporation&#146;s
network.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For more information
about the local LAT file, including information about how to
create and edit a Locallat.txt file by using a text editor, see </font><a
href="08_msp.HTM#Top"><font size="2" face="Verdana, Arial, Helvetica">&#147;Setting Up Clients.&#148;</font></a></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="2023h2"><font size="2"
face="Verdana, Arial, Helvetica">How is the LAT Defined?</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">The LAT is defined
during Microsoft Proxy Server installation, when you complete the
<strong>Local Address Table Configuration</strong> dialog box.
The LAT consists of a series of IP address pairs. Each address
pair defines either a range of IP addresses (from the first,
lower address to the second, higher address), or a single IP
address (if both addresses of the pair are identical).</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica"><b>Note</b>&nbsp;&nbsp;&nbsp;Each
IP address pair identifies either a range of addresses, or a
single IP address. The second entry is not a subnet mask. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">To add addresses to the
LAT, you can:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <strong>Construct
        Table</strong> button in the <strong>Local Address Table
        Configuration</strong> dialog box. This generates the
        list of IP address pairs from internal routing tables
        used by Windows&nbsp;NT Server.</font></li>
</ul>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">Use the edit
        controls in the <strong>Local Address Table Configuration</strong>
        dialog box to manually enter pairs of IP addresses.</font></li>
</ul>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">Use a combination
        of both techniques (generate a list of IP address pairs,
        then use the edit controls to manually add and remove
        addresses).</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">During Microsoft Proxy
Server installation, when you click the <strong>Construct Table</strong>
button in the <strong>Local Address Table Configuration</strong>
dialog box that generates the list of IP address pairs from
internal routing tables used by Windows&nbsp;NT Server, in some
cases the generated addresses might not completely define your
private network. For example, the generated addresses could omit
a subnet of your private network, or could include addresses
external to your private network. It is important that you review
the generated list of IP addresses. Use the edit controls to add
any needed IP address pairs until all addresses of your internal
network are defined. Remove any IP address pairs that define
external (Internet) addresses.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;If
you find that a subnet of your private network is omitted when
the list of IP pairs is generated, you need to add the IP address
pairs as described above, but you also need to review and correct
the server or network configuration to ensure that the missing
subnet becomes accessible for TCP/IP connections.</font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="2024h2"><font size="2"
face="Verdana, Arial, Helvetica">LAT Configuration Considerations</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Following are some
considerations to keep in mind when administering the <strong>Local
Address Table Configuration</strong> dialog box and defining the
LAT:</font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">If
        you generate the list of internal addresses by clicking
        the <strong>Construct Table</strong> button, and then
        remove an address from the <b>Internal IP Ranges</b>
        list, you can introduce redundant load on the server.
        Clients will redirect the connections to that address
        through Microsoft Proxy Server, when they are already
        connected to that computer on the internal network. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Make
        sure that external (Internet) addresses are not entered
        in the <b>Internal IP Ranges</b> list. Doing so will add
        them to the LAT and will therefore identify them as
        internal addresses. This is a security breach and can
        provide unwanted external access to your private network
        computers. Also, an attempt by a client to connect to
        such an address is not redirected through Microsoft Proxy
        Server, and therefore that address is not reachable from
        the private network. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        IP addresses of the server&#146;s internally connected
        network adapter cards must be defined as internal
        addresses (by including them in the <b>Internal IP Ranges</b>
        list), and the IP addresses of its externally connected
        cards should be defined as external IP addresses (by
        excluding them from the <b>Internal IP Ranges</b> list). </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Regardless
        of the addresses entered in the <strong>Internal IP
        Ranges</strong> list, if the client is running only
        IPX/SPX, then any attempt to communicate over IP will be
        redirected through Microsoft Proxy Server, even if the
        destination is on the private network. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">After
        Microsoft Proxy Server has been installed, if the LAT
        needs to be modified it can be edited by using Internet
        Service Manager, or by using a text editor to edit the
        Msplat.txt file (located by default in the C:\Msp\Clients
        directory). For more information see </font><a
        href="05_msp.HTM#Top"><font size="2"
        face="Verdana, Arial, Helvetica">&#147;Server
        Administration.&#148;</font></a><font size="2"
        face="Verdana, Arial, Helvetica"> </font></p>
    </li>
</ul>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="03_Port"><font size="2"
face="Verdana, Arial, Helvetica">Setting the Web Proxy Listen-On Port</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">The Web Proxy service
uses the port set for the WWW service as its listen-on port. The
default is port 80. If you want to use a different port, before
installing Microsoft Proxy Server use Internet Service Manager to
change the WWW service port number.</font></p>

<h4><a name="Tochangetheport"><font size="2"
face="Verdana, Arial, Helvetica"><strong>To change the port</strong></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From Internet
        Service Manager, double-click the computer name next to
        the <strong>WWW</strong> Service.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">In the <strong>Service</strong>
        tab of the <strong>WWW Service Properties</strong>
        window, type the port number in the <strong>TCP Port</strong>
        box, and then click <strong>OK</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">From Internet
        Service Manager, stop and restart the <strong>WWW</strong>
        service.</font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">During Microsoft Proxy
Server setup, the Setup program reads this port number from the
Windows&nbsp;NT registry and adds it to the WebProxyPort field of
the Mspclnt.ini client configuration file that Setup adds to the
server&#146;s Mspclnt client installation share. When a client
computer installs the client software from that share (and if the
option to configure client browsers has been set), the
client&#146;s browser is configured to use this port on the
proxy.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">If you change the WWW
service port number after installing Microsoft Proxy Server, you
must edit the WebProxyPort value in the Mspclnt.ini file in the
server&#146;s Mspclnt share. If browser clients of that server
are not already configured to use that port, also use each
browser&#146;s configuration interface to configure the browser
to use the new port number.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For more information
about client computer configuration, the Mspclnt.ini file, and
browser configuration, see </font><a href="08_msp.htm#Top"><font
size="2" face="Verdana, Arial, Helvetica">&#147;Setting Up
Clients.&#148;</font></a></p>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="2h1"><font size="2"
face="Verdana, Arial, Helvetica">Installing Microsoft Proxy Server</font></a></h1>

<blockquote>
    <p><a href="#03_0101"><font size="2" face="Verdana, Arial, Helvetica">Running
    Server Setup</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#03_9191"><font size="2"
    face="Verdana, Arial, Helvetica">Running Server Setup from the Command
    Line</font></a></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="03_0101"><font size="2"
face="Verdana, Arial, Helvetica">Running Server Setup</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Follow these
instructions to perform a fresh installation of Microsoft Proxy
Server. For information about upgrading from a preliminary
release of Microsoft Proxy Server, see the Readme.txt file
provided on the Microsoft Proxy Server compact disc.</font></p>

<h4><a name="ToinstallMicrosoftProxyServer"><font size="2"
face="Verdana, Arial, Helvetica"><b>To install Microsoft Proxy Server</b></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Verify
        that the prerequisites listed in </font><a
        href="02_msp.htm#Top"><font size="2"
        face="Verdana, Arial, Helvetica">&#147;Preinstallation
        Requirements,&#148;</font></a><font size="2"
        face="Verdana, Arial, Helvetica"> have been satisfied. Also verify
        that the server has Windows&nbsp;NT Server
        version&nbsp;4.0 and Microsoft Internet Information
        Server (IIS) version&nbsp;2.0 installed, and then log on
        using a user account that has administrative privileges
        on the server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the Ntupdate directory on the Microsoft Proxy Server
        compact disc, open the subdirectory that is appropriate
        to the server's processor architecture, and run
        Update.exe to install the Windows NT Server 4.0 Service
        Pack. After the Service Pack is installed, reboot the
        server computer and log on again using a user account
        that has administrative privileges on the server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the root directory of the Microsoft Proxy Server compact
        disc, run <b>Setup</b>. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">&#150;Or&#150;
        </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">Copy
        the contents of the compact disc to a shared folder,
        connect the server to that share, and run <b>Setup</b>. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        <b>Welcome</b> dialog box appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        <b>Continue</b>. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        <b>CD Key Number </b>dialog box appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">To
        record the product identification number (displayed on
        the Certificate of Authenticity provided with the
        product), type the number in the<strong> CD Key </strong>box,
        click <b>OK</b>, and then click <strong>OK</strong> in
        the confirmation dialog box that appears. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        <b>Change Folder </b>dialog box appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">To
        change the folder into which Microsoft Proxy Server is
        installed, click <b>Change Folder</b> and complete the
        dialog box that appears. To accept the default folder,
        skip this step. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        <strong>OK</strong>. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        <b>Installation Options</b> dialog box appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">To
        determine which Microsoft Proxy Server components are
        installed, select or clear the check box for each option.
        The <b>Installation Options</b> dialog box contains check
        boxes for the following items: </font></p>
        <ul>
            <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Install
                Proxy Server</strong></font></li>
            <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Install
                the Administration Tool</strong></font></li>
            <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Install
                Documentation</strong> </font></li>
        </ul>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">By
        default, all components are selected. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">When
        the installation options are set appropriately, click <b>Continue</b>.
        </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        <b>Microsoft Proxy Server Cache Drives </b>dialog box
        appears. The server&#146;s local drives are listed. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">To
        assign a disk to store cached data, select the drive from
        the list, type a number in the <strong>Maximum Size (MB)</strong>
        box, and click <strong>Set.</strong> </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">Repeat as
        necessary to assign additional drives to store cached
        data. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">When
        configuring the cache drives you must, at a minimum,
        allocate at least one drive and 5&nbsp;MB for caching.
        However, the recommended minimum allocation is higher. It
        is suggested you allocate at least 100&nbsp;MB plus
        0.5&nbsp;MB for each Web Proxy service client (and round
        up to the nearest full megabyte). For example, if a
        server will be servicing 79&nbsp;Web Proxy service
        clients, it is recommended you allocate 140&nbsp;MB or
        more to the cache. For each server the optimal cache
        allocation varies depending on load and configuration,
        but in general, increasing the disk space allocation
        benefits the cache. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">Allocate space
        from a drive to the cache in increments of 5&nbsp;MB. If
        you assign a number to the cache that cannot be evenly
        divided by 5, the allocation is rounded down to the next
        lowest 5&nbsp;MB increment. For example, if you assign
        194&nbsp;MB to the C drive, 190&nbsp;MB is actually
        allocated from that drive to the cache. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note&nbsp;&nbsp;&nbsp;</strong>It
        is strongly recommended that you use only NTFS volumes
        for caching. Also, do not assign a read-only drive (for
        example, a CD-ROM drive) to the cache. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">See
        </font><a href="04_msp.HTM#Top"><font size="2"
        face="Verdana, Arial, Helvetica">&#147;Server
        Features,&#148;</font></a><font size="2"
        face="Verdana, Arial, Helvetica"> and </font><a
        href="DD_msp.HTM#Top"><font size="2"
        face="Verdana, Arial, Helvetica">Appendix D,
        &#147;Architecture,&#148;</font></a><font size="2"
        face="Verdana, Arial, Helvetica"> for more information about
        caching. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        <b>OK</b>. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        <strong>Local Address Table Configuration</strong> dialog
        box appears. Use this dialog box to define all the
        internal IP addresses of your network, and to exclude all
        external IP addresses. For important information about
        his dialog box, see </font><a href="#202h1"><font
        size="2" face="Verdana, Arial, Helvetica">What You Need to Know
        About the LAT</font></a><font size="2"
        face="Verdana, Arial, Helvetica">, earlier in this chapter. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">To
        create a table of the IP addresses of your internal
        network, click the <strong>Construct Table</strong>
        button. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        <strong>Construct Local Address Table</strong> dialog box
        appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">To
        add to the LAT three ranges of IP addresses defined by
        IANA as private address ranges that can be used in a
        private IP network that is not connected to the Internet,
        select the <strong>Add the private ranges</strong> check
        box. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">To
        choose the network adapter cards on the server whose IP
        addresses are included in the LAT, select <strong>Load
        from NT Internal Routing Table</strong> and complete its
        options. </font></p>
        <ul>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">If you do not know which
                of the server&#146;s network adapter cards are
                connected to the private network, select <strong>Load
                known address ranges from all IP interface cards.</strong>
                </font></p>
            </li>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">If you know which of the
                server&#146;s network adapter cards are connected
                to the private (internal) network and which are
                connected to the Internet, select <strong>Load
                known address ranges from the following IP
                interface cards</strong> to load only those IP
                addresses associated with the server&#146;s
                internally connected cards. Then, in the list of
                network adapter cards, select the check box for
                each of the internally connected cards, and clear
                the check box for each of the externally
                connected cards. </font></p>
            </li>
        </ul>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">When you have
        completed the <strong>Construct Local Address Table</strong>
        dialog box, click <strong>OK</strong>.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <strong>Local
        Address Table Configuration</strong> dialog box returns.
        A list of IP address pairs is displayed in the <b>Internal
        IP Ranges</b> box. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Verify
        that the entries in the <strong>Internal IP Ranges</strong>
        box correctly identify your internal network. Add any
        needed IP address pairs until all addresses of your
        internal network are defined. Remove any IP address pairs
        that define external (Internet) addresses. </font></p>
        <ul>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">To add a range of IP
                addresses to the list, under <b>Edit</b> type a
                pair of addresses in the <b>From</b> and <b>To</b>
                boxes, and then click the <strong>Add</strong>
                button. </font></p>
            </li>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">To add a single IP
                address to the list, under <b>Edit</b> type the
                same address in both the <b>From</b> and <b>To</b>
                boxes, and then click the <strong>Add</strong>
                button. </font></p>
            </li>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">To remove an IP address
                or address pair from the list, select it from the
                <b>Internal IP Ranges</b> box, and then click the
                <strong>Remove</strong> button. </font></p>
            </li>
        </ul>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">When
        the LAT configuration is properly set, click <b>OK</b>. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        <b>Client Installation/Configuration</b> dialog box
        appears. Use this dialog box to enter information that is
        used by the client Setup program that Microsoft Proxy
        Server Setup installs into the Mspclnt share. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Use
        the choices under <strong>WinSock Proxy Client</strong>
        to specify how the client Setup program will configure
        WinSock Proxy clients that install from this server. </font></p>
        <ul>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">Select either <b>Machine
                or DNS Name</b> or <b>IP Addresses</b>. If you
                select <b>Machine or DNS Name</b>, verify that
                the name is correct. If necessary type the
                appropriate name. </font></p>
            </li>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">When the <strong>Enable
                Access Control</strong> check box is selected,
                WinSock Proxy service security is enabled, and
                only those clients that have been assigned
                permissions are able to use the WinSock Proxy
                service on this server. If you clear this check
                box, all internal clients will be able to use the
                WinSock Proxy service on this server. By default,
                this check box is selected. </font></p>
            </li>
        </ul>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">See
        </font><a href="05_msp.HTM#Top"><font size="2"
        face="Verdana, Arial, Helvetica">&#147;Server
        Administration&#148;</font></a><font size="2"
        face="Verdana, Arial, Helvetica"> for information about using
        Microsoft Proxy Server with DNS, and </font><a
        href="07_msp.HTM#Top"><font size="2"
        face="Verdana, Arial, Helvetica">&#147;Configuring the
        WinSock Proxy Service&#148;</font></a><font size="2"
        face="Verdana, Arial, Helvetica"> for information about setting
        WinSock Proxy client permissions. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Use
        the choices under <strong>Web Proxy Client</strong> to
        specify how the client <b>Setup</b> program configures
        Web Proxy clients that install from this server. </font></p>
        <ul>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">Under <b>Web Proxy Client</b>
                select <b>Set Client Setup to Configure Browser
                Proxy Settings</b> to have the client Setup
                program configure client browsers as a Web Proxy
                client (if the browser is Netscape Navigator or
                Microsoft Internet Explorer). </font></p>
                <p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">If you select this
                option, verify that the name shown in the <b>Proxy
                to be Used by Client</b> box is correct. If
                necessary type the correct name. </font></p>
                <p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">Also, if you select this
                option the <strong>Client Connects to Proxy Via
                Port</strong> value displays the port number that
                Web Proxy clients will be configured to use. The
                value in this box cannot be changed here. It is
                the TCP port number that is set for Internet
                Information Server, and is changed using Internet
                Service Manager to administer the WWW service.
                For more information see </font><a
                href="#03_Port"><font size="2"
                face="Verdana, Arial, Helvetica">Setting the Web Proxy
                Listen-On Port,</font></a><font size="2"
                face="Verdana, Arial, Helvetica"> earlier in this chapter.
                </font></p>
            </li>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">When the <strong>Enable
                Access Control </strong>check box is selected,
                Web Proxy service security is enabled. When this
                check box is cleared, the Web Proxy service will
                not attempt to validate connections from clients.
                By default, this check box is selected. For
                information about configuring Web Proxy security,
                see </font><a href="06_msp.htm#Top"><font
                size="2" face="Verdana, Arial, Helvetica">&#147;Configuring the Web Proxy Service.&#148;</font></a><font
                size="2" face="Verdana, Arial, Helvetica"> </font></p>
            </li>
        </ul>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">When
        the <b>Client Installation/Configuration</b> dialog box
        is complete, click <b>OK</b>. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">Setup
        installs Microsoft Proxy Server. </font></p>
    </li>
</ol>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="03_9191"><font size="2"
face="Verdana, Arial, Helvetica">Running Server Setup from the Command
Line</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Optionally, you can
start Setup from the command line and take advantage of the
command-line options. For server installations, the syntax is as
follows.</font></p>

<h3><a name="Syntax"><font size="2" face="Verdana, Arial, Helvetica"><strong>Syntax</strong></font></a></h3>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica"><strong>setup [/r]
    [/u] [/k] </strong></font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">where</font></p>

<blockquote>
    <dl>
        <dt><font size="2" face="Verdana, Arial, Helvetica"><strong>/r</strong></font></dt>
        <dd><p align="left"><font size="2"
            face="Verdana, Arial, Helvetica">Reinstalls Microsoft Proxy
            Server. </font></p>
        </dd>
        <dt><font size="2" face="Verdana, Arial, Helvetica"><strong>/u</strong></font></dt>
        <dd><p align="left"><font size="2"
            face="Verdana, Arial, Helvetica">Removes Microsoft Proxy
            Server but leaves shared components. </font></p>
        </dd>
        <dt><font size="2" face="Verdana, Arial, Helvetica"><strong>/k</strong>
            &#147;<em>keynumber</em>&#148;</font></dt>
        <dd><p align="left"><font size="2"
            face="Verdana, Arial, Helvetica">Provides the compact disc key
            number, where <em>keynumber</em> is enclosed in
            quotes. The <em>keynumber</em> is the product
            identification number displayed on the Certificate of
            Authenticity provided with the product. </font></p>
        </dd>
        <dd><p align="left"><font size="2"
            face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;When
            entering the <em>keynumber</em>, do not enter a dash
            or a space. For example, 123-4567890 is entered as: </font></p>
        </dd>
        <dd><p align="left"><font size="2"
            face="Verdana, Arial, Helvetica"><strong>/k
            &#147;1234567890&#148;</strong> </font></p>
        </dd>
    </dl>
</blockquote>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="5h1"><font size="2"
face="Verdana, Arial, Helvetica">Reviewing the Server Setup Log</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">During Microsoft Proxy
Server installation, the Setup program creates a log,
Mpssetup.log, and places it in the root directory of drive C.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">If you encounter
problems with Setup, review this log by using any text editor
(such as Microsoft WordPad or Microsoft Notepad). For more
information about logging, see </font><a href="10_msp.HTM#Top"><font
size="2" face="Verdana, Arial, Helvetica">&#147;Monitoring.&#148;</font></a></p>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="4h1"><font size="2"
face="Verdana, Arial, Helvetica">Reinstalling Microsoft Proxy Server</font></a></h1>

<h4><a name="ToaddorremoveselectedMicrosoftProxyServercomponents"><font
size="2" face="Verdana, Arial, Helvetica"><b>To add or remove selected
Microsoft Proxy Server components</b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the root
        directory of the Microsoft Proxy Server compact disc or
        from a shared network folder, run Setup. </font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <b>Setup</b> dialog
        box appears. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <b>Add/Remove</b>,
        and then follow the on-screen instructions. </font></li>
</ol>

<h4><a name="TorestoremissingfilesorchangeSetupprogramsettings"><font
size="2" face="Verdana, Arial, Helvetica"><b>To restore missing files or
change Setup program settings</b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the root
        directory of the Microsoft Proxy Server compact disc or
        from a shared network folder, run <b>Setup</b>. </font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <b>Setup</b> dialog
        box appears. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <b>Reinstall</b>,
        and then follow the on-screen instructions. </font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">You can also reinstall
Microsoft Proxy Server using the Control Panel.</font></p>

<h4><a
name="TousetheAdd/RemoveProgramsapplicationinControlPaneltoreinstallMicrosoftProxyServer"><font
size="2" face="Verdana, Arial, Helvetica"><strong>To use the Add/Remove
Programs application in Control Panel to reinstall Microsoft
Proxy Server</strong></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the server,
        open Control Panel and click <strong>Add/Remove Programs</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">The <strong>Add/Remove
        Programs Properties</strong> dialog box appears.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Make sure the <strong>Install/Uninstall</strong>
        tab is selected.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select <strong>Microsoft
        Proxy Server</strong>, click <strong>Add/Remove</strong>,
        and follow the on-screen instructions.</font></li>
</ol>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="03rmv100"><font size="2"
face="Verdana, Arial, Helvetica">Removing Microsoft Proxy Server</font></a></h1>

<h4><a name="ToremoveMicrosoftProxyServer"><font size="2"
face="Verdana, Arial, Helvetica"><b>To remove Microsoft Proxy Server</b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the <strong>Microsoft
        Proxy Server</strong> program group, click <strong>Uninstall.</strong></font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <b>Uninstall Proxy
        Server </b>dialog box appears. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <b>Yes</b>. </font><p><font
        size="2" face="Verdana, Arial, Helvetica">All installed components
        (Microsoft Proxy Server, the Proxy Server documentation,
        and the administration components) are removed from the
        computer. </font></p>
    </li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">You can also remove
Microsoft Proxy Server by using the Setup program, but you must
have the Microsoft Proxy Server compact disc or be connected to a
network share containing that software.</font></p>

<h4><a name="ToremoveMicrosoftProxyServerbyusingtheSetupprogram"><font
size="2" face="Verdana, Arial, Helvetica"><b>To remove Microsoft Proxy
Server by using the Setup program</b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the root
        directory of the Microsoft Proxy Server compact disc or
        from a shared network folder, run Setup. </font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <b>Setup</b> dialog
        box appears. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <b>Remove
        All</b>. </font><p><font size="2" face="Verdana, Arial, Helvetica">A
        message appears, asking you to confirm that Microsoft
        Proxy Server should be removed. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <b>Yes</b>. </font><p><font
        size="2" face="Verdana, Arial, Helvetica">All installed components
        (Microsoft Proxy Server, the Proxy Server documentation,
        and the administration components) are removed from the
        computer. </font></p>
    </li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">You can also remove
Microsoft Proxy Server by using Control Panel.</font></p>

<h4><a
name="TousetheAdd/RemoveProgramsapplicationinControlPaneltoremoveMicrosoftProxyServer"><font
size="2" face="Verdana, Arial, Helvetica"><strong>To use the Add/Remove
Programs application in Control Panel to remove Microsoft Proxy
Server</strong></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the server,
        open Control Panel and click <strong>Add/Remove Programs.</strong></font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">The <strong>Add/Remove
        Programs Properties</strong> dialog box appears.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Make sure the <strong>Install/Uninstall</strong>
        tab is selected.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select <strong>Microsoft
        Proxy Server</strong>, click <strong>Add/Remove</strong>,
        and follow the on-screen instructions.</font></li>
</ol>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="999h1"><font size="2"
face="Verdana, Arial, Helvetica">Installing Only the Administration Tool</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">To set up a workstation
for remote administration of Microsoft Proxy Server, you can
install the administration tool for the Web Proxy and WinSock
Proxy services without installing Microsoft Proxy Server. The
administration tool can be installed on computers running these
operating systems:</font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Windows&nbsp;NT
        Server 4.0&nbsp;&nbsp;&nbsp;</strong>At a minimum, the
        Internet Service Manager component of Microsoft Internet
        Information Server 2.0 must be installed on the server
        before the Microsoft Proxy Server administration
        components can be installed. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Windows&nbsp;NT
        Workstation 4.0&nbsp;&nbsp;&nbsp;</strong>At a minimum,
        the Internet Service Manager component of Microsoft Peer
        Web Services must be installed on the workstation before
        the Microsoft Proxy Server administration components can
        be installed. </font></li>
</ul>

<h4><a name="Toinstallonlytheadministrationtool"><font size="2"
face="Verdana, Arial, Helvetica"><b>To install only the administration
tool</b></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the root directory of the Microsoft Proxy Server compact
        disc or from a shared network folder, run Setup. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">When
        the <b>Installation Options</b> dialog box appears,
        select the <b>Install Administration Tool</b> check box,
        but clear the <strong>Install Proxy Server</strong> check
        box. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">Optionally,
        to also install the online <em>Installation and
        Administration Guide</em>, select the <strong>Install
        Documentation </strong>check box. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        <b>OK,</b> and then follow the on-screen instructions. </font></p>
    </li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">After installation, you
can open the administration tool from the <strong>Microsoft Proxy
Serv</strong><b>er</b> program group. </font></p>

<h4><a name="Toopenandusetheadministrationtool"><font size="2"
face="Verdana, Arial, Helvetica"><b>To open and use the administration
tool</b></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the desktop click <b>Start</b>, select <b>Programs,</b>
        and then select <strong>Microsoft Proxy Ser</strong><b>ver.</b>
        </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        <strong>Internet Service Manager</strong><b>.</b> </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        <strong>Microsoft Internet Service Manager</strong>
        window is displayed. It lists the Internet services
        available on the local computer. Because Microsoft Proxy
        Server is not installed on this computer, the Web Proxy
        and WinSock Proxy services are not included in the list. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the <strong>Properties</strong> menu choose <strong>Connect
        to Server</strong>. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        <strong>Connect to Server</strong> dialog box appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Type
        a server name in the <strong>Server Name</strong> box,
        then click <strong>OK</strong>. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        Internet services available on that server are listed in
        Internet Service Manager. If that server has already had
        Microsoft Proxy Server installed, the Web Proxy and
        WinSock Proxy services appear in the list. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">As
        necessary, administer the Web Proxy and WinSock Proxy
        services on that server. </font></p>
    </li>
</ol>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="3h1"><font size="2"
face="Verdana, Arial, Helvetica">Installing and Accessing the
Documentation</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">The <i>Installation and
Administration Guide</i> for Microsoft Proxy Server is installed
with Microsoft Proxy Server (unless you change the default
settings of the Setup program). It is provided in HTML format and
is available online. Once it is installed, you can access the<em>
Installation and Administration Guide </em>from two locations:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the <strong>Help</strong>
        menu of Internet Service Manager</font></li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the <strong>Microsoft Proxy Server</strong> program group
        </font></p>
    </li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note&nbsp;&nbsp;&nbsp;</strong>A
Web browser (such as Microsoft Internet Explorer) must be
installed on the computer in order for the documentation to be
displayed.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Open the <i>Installation
and Administration Guide</i> directly from Internet Service
Manager to refer to the documentation while you are administering
a server.</font></p>

<h4><a
name="ToopentheonlinedocumentationfromInternetServiceManager"><font
size="2" face="Verdana, Arial, Helvetica"><b>To open the online
documentation from Internet Service Manager</b></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the server&#146;s desktop click <b>Start</b>, select <b>Programs,</b>
        and then select <strong>Microsoft Proxy Ser</strong><b>ver.</b>
        </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        <strong>Internet Service Manager</strong><b>.</b> </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        Microsoft Internet Service Manager window is displayed. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the <strong>Help</strong> menu, click <strong>Microsoft
        Proxy Server Documentation</strong>. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        server&#146;s browser starts and the table of contents
        for the <i>Installation and Administration Guide</i> is
        displayed<i>.</i> </font></p>
    </li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">You can also open the <i>Installation
and Administration Guide</i> from the <strong>Microsoft Proxy
Serv</strong><b>er</b> program group.</font></p>

<h4><a name="Toopentheonlinedocumentationfromtheprogramgroup"><font
size="2" face="Verdana, Arial, Helvetica"><strong>To open the online
documentation from the program group</strong></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the server&#146;s desktop click <b>Start</b>, select <b>Programs,</b>
        and then select <strong>Microsoft Proxy Ser</strong><b>ver.</b>
        </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        <strong>Microsoft Proxy Server Do</strong><b>cumentation.</b>
        </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        server&#146;s browser starts and the table of contents
        for the <i>Installation and Administration Guide</i> is
        displayed<i>.</i> </font></p>
    </li>
</ol>

<p align="left"><font size="2" face="Verdana, Arial, Helvetica">If
Microsoft Proxy Server has not yet been installed on a computer,
you have the option of installing only the documentation. You can
then read or print out the documentation before installing
Microsoft Proxy Server. </font></p>

<h4><a name="Toinstallonlythedocumentation"><font size="2"
face="Verdana, Arial, Helvetica"><b>To install only the documentation</b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the root
        directory of the Microsoft Proxy Server compact disc or
        from a shared network folder, run Setup.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">When the <b>Installation
        Options</b> dialog box appears, clear all check boxes
        except the <b>Install Documentation</b> check box.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <b>OK,</b>
        and then follow the on-screen instructions.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">The documentation
        will be installed. After installation it can be accessed
        by clicking the <strong>Microsoft Proxy Server
        Documentation </strong>icon from the <strong>Microsoft
        Proxy Server</strong> program group.</font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">As another option,
without installing any components you can open the <i>Installation
and Administration Guide</i> directly from the Microsoft Proxy
Server compact disc. You can then read or print out the
documentation before performing any installation tasks. </font></p>

<h4><a
name="Beforeinstallation,toopentheonlinedocumentationdirectlyfromtheMicrosoftProxyServercompactdisc"><font
size="2" face="Verdana, Arial, Helvetica"><b>Before installation, to open
the online documentation directly from the Microsoft Proxy Server
compact disc</b></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Start
        an Internet browser. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the Docs folder on the Microsoft Proxy Server compact
        disc, open the file Toc_msp.htm. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">For
        example, if the compact disc drive is the computer&#146;s
        D: drive, you would have the browser open the following
        address: </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>file:D:\Docs\Toc_msp.htm</b>
        </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        browser loads the Table of Contents for the <i>Installation
        and Administration Guide.</i> </font></p>
    </li>
</ol>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="3030h1"><font size="2"
face="Verdana, Arial, Helvetica">Searching the Documentation</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">With Microsoft Index
Server, users can query an entire site with a click of a button.
It automatically indexes the full text and properties of various
files (including HTML) on your server, whether it is an intranet,
an Internet, or a file-and-print server.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">You can use Microsoft
Index Server to perform full text searches of the Microsoft Proxy
Server <em>Installation and Administration Guide</em>. The </font><font size="2" face="Verdana, Arial, Helvetica"><I>Search</I></font></a><font
size="2" face="Verdana, Arial, Helvetica"> buttons at the top and bottom
of every page in the <em>Installation and Administration Guide</em>
take you to a query form, from which you perform your search. A
search results page provides you with links to search hits. (Note
that this query form intentionally restricts searches to only the<em>
Installation and Administration Guide</em>.) </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Before you can use the
query form to search the <em>Installation and Administration
Guide</em>, the following prerequisites must be satisfied:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">You must use the
        Microsoft Proxy Server Setup program to install Microsoft
        Proxy Server and its documentation on a server that
        already has Windows&nbsp;NT Server version&nbsp;4.0 and
        Internet Information Server 2.0 installed. </font></li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">You
        must install Microsoft Index Server on the server. </font></p>
    </li>
</ul>

<h4><a name="ToinstallMicrosoftIndexServer"><font size="2"
face="Verdana, Arial, Helvetica"><strong>To install Microsoft Index Server</strong></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Open
        the Microsoft Proxy Server <em>Installation and
        Administration Guide</em>. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the server&#146;s desktop click <b>Start</b>, select <b>Programs,</b>
        select <strong>Microsoft Proxy Ser</strong><b>ver, </b>and
        then click <strong>Microsoft Proxy Documentation</strong>.
        The server&#146;s browser starts and loads the table of
        contents for the <i>Installation and Administration
        Guide.</i> </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the table of contents, click </font><a
        href="cii_msp.htm#Top"><font size="2"
        face="Verdana, Arial, Helvetica">Installing the Search Components</font></a><font
        size="2" face="Verdana, Arial, Helvetica">. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        </font><a href="cii_msp.htm#Top"><font size="2"
        face="Verdana, Arial, Helvetica">Installing the Search Components</font></a><font
        size="2" face="Verdana, Arial, Helvetica"> page appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Follow
        the instructions displayed on the </font><a
        href="cii_msp.htm#Top"><font size="2"
        face="Verdana, Arial, Helvetica">Installing the Search Components</font></a><font
        size="2" face="Verdana, Arial, Helvetica"> page. <br>
        <br>
        </font></p>
    </li>
</ol>

<h4><a name="TosearchtheMicrosoftProxyServer"><font size="2"
face="Verdana, Arial, Helvetica"><strong>To search the Microsoft Proxy
Server </strong></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        any page of the Microsoft Proxy Server <em>Installation
        and Administration Guide</em>, scroll to the top or
        bottom of the page. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        the </font><font size="2"
        face="Verdana, Arial, Helvetica"><I>Search</I></font><font size="2"
        face="Verdana, Arial, Helvetica"> button. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        </font><font size="2"
        face="Verdana, Arial, Helvetica"><I>Search</I></font><font size="2"
        face="Verdana, Arial, Helvetica"> page appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Compose
        and issue a query, following the instructions displayed
        on the </font><font size="2"
        face="Verdana, Arial, Helvetica"><I>Search</I></font><font size="2"
        face="Verdana, Arial, Helvetica"> page. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">For information on
        how to compose effective queries, from the </font><font size="2" face="Verdana, Arial, Helvetica"><I>Search</I></font><font
        size="2" face="Verdana, Arial, Helvetica"> page click the </font><font size="2"
        face="Verdana, Arial, Helvetica"><i>Tips</i></font><font size="2"
        face="Verdana, Arial, Helvetica"> button.<br>
        <br>
        </font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;If
the prerequisites above are not satisfied, or if Microsoft Index
Server has not been installed, when you click the <strong>Search</strong>
button an error will be displayed.</font></p>

<hr>

<p align="center"><font size="2" face="Verdana, Arial, Helvetica"><i>
1996 by Microsoft Corporation. All rights reserved.</i> </font></p>
</FONT>
</FONT>
</BODY>
</html>
