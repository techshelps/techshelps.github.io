<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<HEAD>
<meta name="PREMIUM" content="MSDN">
<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">
<meta name="MS.LOCALE" content="EN-US">
<meta name="DESCRIPTION" content="This page is from the Microsoft Proxy Server book, found in the Tools and Technologies Section in the MSDN Library">



<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CHAPTER 10, Monitoring</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>


<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<p align="left"><a name="Top"><font size="2"
face="Verdana, Arial, Helvetica"><img src="onepix.gif" alt="Space"
align="top" width="1" height="1"></font></a></p>

<hr>

<h1><a name="Monitoring"><font size="6" face="Verdana, Arial, Helvetica">Monitoring</font></a></h1>

<blockquote>
    <p><a href="#45454"><font size="2" face="Verdana, Arial, Helvetica">Setup
    Logs<br>
    </font></a><a href="#2h2"><font size="2"
    face="Verdana, Arial, Helvetica">Microsoft Proxy Server Logs</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#8h2"><font size="2" face="Verdana, Arial, Helvetica">Windows&nbsp;NT
    Logs</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#2h1"><font size="2" face="Verdana, Arial, Helvetica">Performance
    Monitor Counters</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#3h1"><font size="2" face="Verdana, Arial, Helvetica">SNMP
    MIBs</font></a><font size="2" face="Verdana, Arial, Helvetica"> </font></p>
</blockquote>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="45454"><font size="2"
face="Verdana, Arial, Helvetica">Setup Logs</font></a></h1>

<blockquote>
    <p><a href="#1h2"><font size="2" face="Verdana, Arial, Helvetica">The
    Server Setup Log </font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#12h2"><font size="2" face="Verdana, Arial, Helvetica">The
    Client Setup Log</font></a></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="1h2"><font size="2"
face="Verdana, Arial, Helvetica">The Server Setup Log</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">The Microsoft Proxy
Server Setup program creates a log file, C:\Mpssetup.log.
Customers calling Microsoft for assistance should have this file
available when calling. It contains valuable information beyond
any error messages that are displayed to the user. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The Setup log is
overwritten each time Microsoft Proxy Server is installed.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Following is an example
of a Microsoft Proxy Server Setup log:</font></p>

<pre><font size="2" face="Verdana, Arial, Helvetica">Microsoft Proxy Server Setup Log
--------------------------------

MSP Setup: VerifyServerCondition camf=0 ois=0 or=1110 DstDir=NULL
MSP Setup: NT build 1381
MSP Setup: open file C:\WINNT\System32\w3pmon.dll returned 2
MSP Setup: VerifyServerCondition returnd OK!!! camf=0 ois=0 or=1110 DstDir=NULL
MSP Setup: FindVirtualRoot camf=10 ois=0 or=1120 DstDir=NULL
MSP Setup: FindVirtualRoot returnd OK!!! camf=10 ois=0 or=1120 DstDir=C:\InetPub\scripts\
MSP Setup: FindGibraltarDir camf=10 ois=0 or=4010 DstDir=NULL
MSP Setup: FindGibraltarDir returnd OK!!! camf=10 ois=0 or=4010 DstDir=C:\WINNT\System32\inetsrv\
MSP Setup: FindVirtualRoot camf=10 ois=0 or=1120 DstDir=C:\InetPub\scripts\
MSP Setup: FindVirtualRoot returnd OK!!! camf=10 ois=0 or=1120 DstDir=C:\InetPub\scripts\
MSP Setup: FindGibraltarDir camf=10 ois=0 or=4010 DstDir=C:\WINNT\System32\inetsrv\
MSP Setup: FindGibraltarDir returnd OK!!! camf=10 ois=0 or=4010 DstDir=C:\WINNT\System32\inetsrv\
MSP Setup: NetStop camf=15 ois=4 or=1130 DstDir=C:\msp\
MSP Setup: NetStoping wspsrv
MSP Setup: NetStop returnd OK!!! camf=15 ois=4 or=1130 DstDir=C:\msp\
MSP Setup: NetStop camf=15 ois=4 or=1140 DstDir=C:\msp\
MSP Setup: NetStoping w3svc
MSP Setup: NetStop returnd OK!!! camf=15 ois=4 or=1140 DstDir=C:\msp\
MSP Setup: NetStop camf=15 ois=4 or=1150 DstDir=C:\msp\
MSP Setup: NetStoping mspadmin
MSP Setup: NetStop returnd OK!!! camf=15 ois=4 or=1150 DstDir=C:\msp\
MSP Setup: NetStop camf=15 ois=4 or=1160 DstDir=C:\msp\
MSP Setup: NetStoping snmp
MSP Setup: NetStop returnd OK!!! camf=15 ois=4 or=1160 DstDir=C:\msp\
MSP Setup: SetCacheDir camf=15 ois=4 or=1170 DstDir=C:\msp\
MSP Setup: SetCacheDir returnd OK!!! camf=15 ois=4 or=1170 DstDir=C:\msp\
MSP Setup: SetNetConfig camf=15 ois=4 or=1180 DstDir=C:\msp\
MSP Setup: SetNetConfig returnd OK!!! camf=15 ois=4 or=1180 DstDir=C:\msp\
MSP Setup: NetShare camf=15 ois=4 or=1250 DstDir=C:\msp\
MSP Setup: Net stop Sharing mspclnt
MSP Setup: NetShare returnd OK!!! camf=15 ois=4 or=1250 DstDir=C:\msp\
MSP Setup: SetNetConfig camf=22 ois=4 or=1180 DstDir=C:\msp\
MSP Setup: SetNetConfig returnd OK!!! camf=22 ois=4 or=1180 DstDir=C:\msp\
MSP Setup: CreateLink camf=22 ois=4 or=1400 DstDir=C:\msp\
MSP Setup: CreateLink - szData is msp.pmc
MSP Setup: CreateLink returnd OK!!! camf=22 ois=4 or=1400 DstDir=C:\msp\
MSP Setup: CreateLink camf=22 ois=4 or=4050 DstDir=C:\WINNT\System32\inetsrv\
MSP Setup: CreateLink - szData is inetmgr.exe
MSP Setup: CreateLink returnd OK!!! camf=22 ois=4 or=4050 DstDir=C:\WINNT\System32\inetsrv\
MSP Setup: CreateLink camf=22 ois=4 or=5020 DstDir=C:\msp\docs\
MSP Setup: CreateLink - szData is toc_msp.htm
MSP Setup: CreateLink returnd OK!!! camf=22 ois=4 or=5020 DstDir=C:\msp\docs\
MSP Setup: AddVirtualIISRoot camf=22 ois=4 or=5030 DstDir=C:\msp\docs\
MSP Setup: AddInetmgrHelpAddOn camf=22 ois=4 or=5040 DstDir=C:\msp\docs\
MSP Setup: SetMspRegistry camf=24 ois=4 or=1230 DstDir=C:\msp\
MSP Setup: did not find snmp root registry
MSP Setup: InstallWspService returnd OK!!! camf=24 ois=4 or=1230 DstDir=C:\msp\
MSP Setup: NetShare camf=24 ois=4 or=1250 DstDir=C:\msp\
MSP Setup: NetShare returnd OK!!! camf=24 ois=4 or=1250 DstDir=C:\msp\
MSP Setup: InstallWspService camf=24 ois=4 or=1260 DstDir=C:\msp\
MSP Setup: InstallWspService returnd OK!!! camf=24 ois=4 or=1260 DstDir=C:\msp\
MSP Setup: NetStart camf=24 ois=4 or=1270 DstDir=C:\msp\
MSP Setup: NetStarting w3svc
MSP Setup: NetStart returnd OK!!! camf=24 ois=4 or=1270 DstDir=C:\msp\
MSP Setup: NetStart camf=24 ois=4 or=1280 DstDir=C:\msp\
MSP Setup: NetStarting wspsrv
MSP Setup: NetStart returnd OK!!! camf=24 ois=4 or=1280 DstDir=C:\msp\
MSP Setup: NetStart camf=24 ois=4 or=1290 DstDir=C:\msp\
MSP Setup: NetStarting mspadmin
MSP Setup: NetStart returnd OK!!! camf=24 ois=4 or=1290 DstDir=C:\msp\
MSP Setup: NetStart camf=24 ois=4 or=1300 DstDir=C:\msp\
MSP Setup: NetStarting snmp
MSP Setup: NetStart returnd OK!!! camf=24 ois=4 or=1300 DstDir=C:\msp\
MSP Setup: InstPerfmon camf=24 ois=4 or=3221 DstDir=C:\msp\
MSP Setup: InstPerfmon returnd OK!!! camf=24 ois=4 or=3221 DstDir=C:\msp\</font></pre>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="12h2"><font size="2"
face="Verdana, Arial, Helvetica">The Client Setup Log</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">The client Setup
program creates a log file, Mpcsetup.log, and places it in the
root directory of the client computer&#146;s hard disk. Customers
calling Microsoft for assistance should have this file available
when calling. It contains valuable information beyond any error
messages that are displayed to the user. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The client Setup log is
overwritten each time the client software is installed. Following
is an example of a client Setup log:</font></p>

<pre><font size="2" face="Verdana, Arial, Helvetica">Microsoft Proxy Server Setup Log
--------------------------------

MSP Setup: IsWinsockInWinDir camf=1 ois=0 or=90 DstDir=NULL
MSP Setup: winsock found in windir=1 in sysdir=0
MSP Setup: IsWinsockInWinDir returned DEFAULT!!! camf=1 ois=0 or=90 DstDir=NULL
MSP Setup: CheckFixInconsistency camf=0 ois=0 or=600 DstDir=NULL
MSP Setup: cleaning temp files
MSP Setup: IsCurrentDllRwsWin95_16 returned 1 result=1
MSP Setup: cleaning temp files
MSP Setup: wsock32.dll - Description: Microsoft Remote Windows Socket 32-Bit DLL
MSP Setup: wsock32.dll IsCurrentDllRws = yes
MSP Setup: CheckFixInconsistency returnd OK!!! camf=0 ois=0 or=600 DstDir=NULL
MSP Setup: IsWinsockInWinDir camf=13 ois=0 or=90 DstDir=NULL
MSP Setup: IsWinsockInWinDir returnd OK!!! camf=13 ois=2 or=90 DstDir=NULL
MSP Setup: IsWinsockInWinDir camf=13 ois=2 or=90 DstDir=NULL
MSP Setup: IsWinsockInWinDir returnd OK!!! camf=13 ois=4 or=90 DstDir=NULL
MSP Setup: IsWinsockInWinDir camf=5 ois=4 or=90 DstDir=NULL
MSP Setup: IsWinsockInWinDir returnd OK!!! camf=5 ois=4 or=90 DstDir=NULL
MSP Setup: CheckWinsockApps camf=15 ois=4 or=700 DstDir=C:\mspclnt\
MSP Setup: CheckWinsockApps returned DEFAULT!!! camf=15 ois=4 or=700 DstDir=C:\mspclnt\
MSP Setup: CheckFixInconsistency camf=24 ois=4 or=600 DstDir=C:\mspclnt\
MSP Setup: warning - RemoveBeta2Wsock Delete file returned 2
MSP Setup: CheckFixInconsistency returned DEFAULT!!! camf=24 ois=4 or=600 DstDir=C:\mspclnt\
MSP Setup: SetReg camf=24 ois=4 or=800 DstDir=C:\mspclnt\
MSP Setup: SetReg returnd OK!!! camf=24 ois=4 or=800 DstDir=C:\mspclnt\
MSP Setup: SwithWsockdll camf=24 ois=4 or=1000 DstDir=C:\mspclnt\
MSP Setup: wsock32.dll - Description: Microsoft Remote Windows Socket 32-Bit DLL
MSP Setup: wsock32.dll IsCurrentDllRws = yes
MSP Setup: rws32.dll Version=1.0.163.2
MSP Setup: wsock32.dll Version=1.0.157.2
MSP Setup: HigherVersion rws32.dll = yes
MSP Setup: call _mktemp with __XXXXXX
MSP Setup: Added for post-reboot list : rename wsock32.dll to __a53287.tmp
MSP Setup: Added for post-reboot list : rename rws32.dll to wsock32.dll
MSP Setup: IsWinsock16Loaded_w95 returned 1 result=0
MSP Setup: LazyRename=0
MSP Setup: IsCurrentDllRwsWin95_16 returned 1 result=1
MSP Setup: rws.dll Version=1.0.163.2
MSP Setup: winsock.dll Version=1.0.157.2
MSP Setup: HigherVersion rws.dll = yes
MSP Setup: call _mktemp with __XXXXXX
MSP Setup: succeeded - rename winsock.dll To __a53287.tmp
MSP Setup: succeeded - rename rws.dll To winsock.dll
MSP Setup: SwitchWsockDll returnd OK!!! camf=24 ois=4 or=1000 DstDir=C:\mspclnt\</font></pre>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="2h2"><font size="2"
face="Verdana, Arial, Helvetica">Microsoft Proxy Server Logs</font></a></h1>

<blockquote>
    <p><a href="#78788"><font size="2" face="Verdana, Arial, Helvetica">Logging
    Overview<br>
    </font></a><a href="#4h2"><font size="2"
    face="Verdana, Arial, Helvetica">Logging to a File<br>
    </font></a><a href="#5h2"><font size="2"
    face="Verdana, Arial, Helvetica">Logging to a Database</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#3h3"><font size="2" face="Verdana, Arial, Helvetica">Log
    Fields</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#9h2"><font size="2" face="Verdana, Arial, Helvetica">Logging
    Issues</font></a></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="78788"><font size="2"
face="Verdana, Arial, Helvetica">Logging Overview</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Microsoft Proxy Server
supports logging for the Web Proxy and WinSock Proxy services.
You can log to:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">A comma-delimited
        text file.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">A table in an
        ODBC-compliant database, such as Microsoft SQL Server
        version&nbsp;6.5 or Microsoft Access&nbsp;7.0.</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">Logging can be
configured separately for each of the two service logs, which
are:</font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>WinSock
        Proxy service log&nbsp;&nbsp;&nbsp;</strong>This file
        contains connection-specific log information for
        redirected Windows Sockets-based connections. <br>
        <strong><br>
        Note</strong>&nbsp;&nbsp;&nbsp;Entries to the WinSock
        Proxy service log appear under the source name of <strong>WinSockProxyLog</strong>
        in the Windows&nbsp;NT system log. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Web
        Proxy service log&nbsp;&nbsp;&nbsp;</strong>This file
        contains connection-specific log information for proxy
        connections between the Microsoft Proxy Server and its
        Web Proxy clients.<br>
        <strong><br>
        Note</strong>&nbsp;&nbsp;&nbsp;Entries to the Web Proxy
        service log appear under the source name of <strong>WebProxyLog</strong>
        in the Windows&nbsp;NT system log. </font></p>
    </li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;See
</font><a href="#8h2"><font size="2" face="Verdana, Arial, Helvetica">Windows&nbsp;NT
Logs</font></a><font size="2" face="Verdana, Arial, Helvetica"> later in
this chapter for source names of all event types that can be
logged.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The available logging
options for each service include support for two log formats:</font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Regular
        Logging&nbsp;&nbsp;&nbsp;</strong>For smaller log sizes,
        this format supports a reduced number of information
        fields for log entries. Fields not supported are denoted
        with a hyphen&nbsp;(-). </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Verbose
        Logging&nbsp;&nbsp;&nbsp;</strong>For a fuller level of
        detail in logging, all available information for each
        service is logged. Selecting this format increases the
        size of log files and requires more disk space for
        logging. </font></p>
    </li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">If you are uncertain
about which format to use, you can use the following general
guidelines:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">If available disk
        space is limited on the volume assigned for logging,
        consider using the regular logging format.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">If disk space is
        not limited or is not an issue, or you are planning to
        log service information to a database for further
        analysis, consider using the verbose logging format for
        the full reporting.</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Tip</strong>&nbsp;&nbsp;&nbsp;Turn
off Internet Information Server (IIS) logging when Web Proxy
service logging is enabled. The IIS log is a subset of the
information stored in the Web Proxy service log, so you can
improve performance by turning off IIS logging. To turn off IIS
logging, use Internet Service Manager to open the <strong>Logging</strong>
property sheet for the WWW service. Clear the <strong>Enable
Logging</strong> check box.</font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="4h2"><font size="2"
face="Verdana, Arial, Helvetica">Logging to a File</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Microsoft Proxy Server
can log to comma-delimited text files (ASCII files), or to a
table in an ODBC-compliant database (such as Microsoft SQL Server
or Microsoft Access). This section discusses the location and
other format conventions used for text file logs.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">When logging to a text
file, log fields are separated by the use of a single comma (,).
If you are using a parsing tool to parse text file logs into
database format, each comma in a log file entry should be used to
force a field break to occur.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The default locations
when logging to a text file are: </font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>C:\Winnt\System32\W3plogs\</strong><i>Filename</i><b>.log</b>
        for Web Proxy service</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>C:\Winnt\System32\Wsplogs\</strong><i>Filename</i><b>.log</b>
        for WinSock Proxy service</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">The name given to
text-file logs depends on how logging is configured. Logging can
be configured to create a new log each day, week, month, or when
the current log file reaches a specified size.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The Web Proxy service
text file logs take the following form:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">Daily logs are
        named W3<em>yymmdd</em>.log</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Weekly logs are
        named W3W<em>yymmw</em>.log</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Monthly logs are
        named W3M<em>yymm</em>.log</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Logs based on file
        size are named W3B<em>nnnn</em>.log</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">The WinSock Proxy
service text file logs take the following form:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">Daily logs are
        named WS<em>yymmdd</em>.log</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Weekly logs are
        named WSW<em>yymmw</em>.log</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Monthly logs are
        named WSM<em>yymm</em>.log</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Logs based on file
        size are named WSB<em>nnnn</em>.log</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">Where:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica"><em>yy</em> is a
        number between 00 and 99 indicating the year.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><em>mm</em> is a
        number between 01 and 12 indicating the month.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><em>dd</em> is a
        number between 01 and 31 indicating the day of the month.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><em>w</em> is a
        number between 1 and 5 indicating the week of the month.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><em>nnnn</em> is a
        number that increments with each new log that is opened.</font></li>
</ul>

<h4><a name="Tologtoatextfileandsettheloggingparameters"><font
size="2" face="Verdana, Arial, Helvetica"><strong>To log to a text file
and set the logging parameters</strong></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        Internet Service Manager, double-click the computer name
        next to the <strong>WinSock Proxy </strong>or <strong>Web
        Proxy</strong> service, and then click the <strong>Logging</strong>
        tab. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Make
        sure the <strong>Enable Logging</strong> option is
        selected. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Select
        either <strong>Regular Logging</strong> or <strong>Verbose
        Logging</strong>. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">Regular
        logging records only a subset of all available
        information for each Internet access. This option reduces
        the disk space needed for a log file. Verbose logging
        records all available information for each Internet
        access. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Make
        sure the <strong>Log to File</strong> option is selected.
        </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Select
        or clear the <strong>Automatically open new log</strong>
        option. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">Select
        this option to periodically create a new log file, using
        the interval specified by the <strong>Daily, Weekly,
        Monthly,</strong> or <strong>When File Size Reaches</strong>
        options. When a new log file is started, the old log file
        is closed (and can optionally be archived on other
        storage media). </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">Clear
        this option to use the same log file continuously. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">If
        you select the <strong>Automatically Open New Log</strong>
        option, specify the interval used to determine when to
        open a new log file. Select <strong>Daily, Weekly,
        Monthly,</strong> or <strong>When File Size Reaches</strong>.
        If you select <strong>When File Size Reaches</strong>,
        also enter a value for maximum allowed file size in the <strong>MB</strong>
        box. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Review,
        and if appropriate, change the log file directory. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">To
        change this location, type a new path in the <strong>Log
        File Directory</strong> box, or click <strong>Browse</strong>
        and complete the dialog box that appears. It is possible
        to log to a local or remote drive, but in general it is
        recommended that you store your log file on a local disk.
        </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;To
        help prevent the disk from filling up, it is a good idea
        to store the logs and the Web Proxy cache on different
        volumes. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        <strong>OK</strong>. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">The
        log settings are saved.<br>
        </font></p>
    </li>
</ol>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="5h2"><font size="2"
face="Verdana, Arial, Helvetica">Logging to a Database</font></a></h2>

<blockquote>
    <p><a href="#12h3"><font size="2" face="Verdana, Arial, Helvetica">Database
    Logging Overview</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#11h3"><font size="2" face="Verdana, Arial, Helvetica">Installing
    ODBC Drivers</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#8h3"><font size="2" face="Verdana, Arial, Helvetica">Defining
    a System Data Source Name</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#954h3"><font size="2"
    face="Verdana, Arial, Helvetica">Setting Up Database Tables </font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#6h3"><font size="2" face="Verdana, Arial, Helvetica">Configuring
    the Service to Log to a Database</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font></p>
</blockquote>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="12h3"><font size="2"
face="Verdana, Arial, Helvetica">Database Logging Overview</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">When you install
Microsoft Proxy Server, logging to a file is the default logging
method. If you prefer to save logs in a database, you can
configure the Web Proxy and WinSock Proxy services to do so.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Logging to any Open
Database Connectivity (ODBC) version&nbsp;2.5-compliant database,
such as Microsoft SQL Server version&nbsp;6.5 or Microsoft
Access&nbsp;7.0, is possible with Microsoft Proxy Server. ODBC is
a standard API used for generic cross-platform connectivity
across Windows-based database platforms. It is designed to be a
general-purpose Call-Level Interface (CLI) for any database,
including nonrelational Database Management Systems (DBMS).
Microsoft Proxy Server supports ODBC for logging service
information to databases. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Database logging
increases the amount of time and resources needed by Microsoft
Proxy Server to service Internet requests. Therefore, if your
site has heavy Internet traffic, you should consider logging to a
file to maximize performance. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The following procedure
describes the basic steps for setting up logging to an
ODBC-compliant database.</font></p>

<h4><a
name="ToprepareaSQL/ODBCdatabaseforMicrosoftProxyServerservicelogging"><font
size="2" face="Verdana, Arial, Helvetica"><strong>To prepare a SQL/ODBC
database for Microsoft Proxy Server service logging</strong></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">Install the
        database.</font><p><font size="2" face="Verdana, Arial, Helvetica">If
        you are using either Microsoft SQL Server or Microsoft
        Access for your preferred database, refer to your product
        documentation for more information on installation
        procedures. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Install the ODBC
        driver for the database you are using. </font><p><font
        size="2" face="Verdana, Arial, Helvetica">For more information,
        see </font><a href="#11h3"><font size="2"
        face="Verdana, Arial, Helvetica">Installing ODBC Drivers,</font></a><font
        size="2" face="Verdana, Arial, Helvetica"> later in this chapter. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Create a system
        Data Source Name (system DSN) for the database. </font><p><font
        size="2" face="Verdana, Arial, Helvetica">For more information,
        see </font><a href="#8h3"><font size="2"
        face="Verdana, Arial, Helvetica">Defining a System Data Source
        Name,</font></a><font size="2" face="Verdana, Arial, Helvetica">
        later in this chapter. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Create a table in
        your database application with the necessary fields.
        Table elements, such as data types and field names, must
        be defined appropriately for the database application you
        are using.</font><p><font size="2"
        face="Verdana, Arial, Helvetica">For more information on specific
        database table formats for Microsoft SQL or Microsoft
        Access databases and tools for creating a table for
        service logging, see </font><a href="#954h3"><font
        size="2" face="Verdana, Arial, Helvetica">Setting Up Database
        Tables,</font></a><font size="2" face="Verdana, Arial, Helvetica">
        later in this chapter. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Enable database
        logging using Internet Service Manager for each Microsoft
        Proxy Server service that will be using database logging.
        For more information on enabling service logging, see </font><a
        href="#6h3"><font size="2" face="Verdana, Arial, Helvetica">Configuring
        the Service to Log to a Database,</font></a><font
        size="2" face="Verdana, Arial, Helvetica"> later in this chapter.</font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;Before
configuring a server to log to a Microsoft Access database, be
sure to check the latest information posted on the Microsoft
Proxy Server home page on the Internet, at </font><a
href="http://www.microsoft.com/proxy/"><font size="2"
face="Verdana, Arial, Helvetica">http://www.microsoft.com/proxy/</font></a><font
size="2" face="Verdana, Arial, Helvetica">. This site provides important
information you need to know in order to configure Microsoft
Proxy Server to log to a Microsoft Access database.</font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="11h3"><font size="2"
face="Verdana, Arial, Helvetica">Installing ODBC Drivers</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">An ODBC driver must be
installed before using ODBC logging options with Microsoft Proxy
Server. ODBC drivers must be ODBC version&nbsp;2.5 components.
This version of ODBC supports system Data Source Names (DSNs),
which allows Windows&nbsp;NT services to use ODBC. </font></p>

<h4><a name="ToinstalltheODBCdrivers"><font size="2"
face="Verdana, Arial, Helvetica">To install the ODBC drivers</font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">If an ODBC Driver
        is not already installed, run Internet Information Server
        Setup again from the Microsoft Internet Server program
        group. You will need to have access to the
        Windows&nbsp;NT Server compact disc, or to a network
        installation directory containing the complete contents
        of the compact disc.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <strong>OK</strong>
        button.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <strong>Add/Remove</strong>
        button.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <strong>OK</strong>
        button.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select the <strong>ODBC
        Drivers and Administration</strong> option. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <strong>OK</strong>
        button. The Install Drivers dialog box appears.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">To install the SQL
        Server driver, select the <strong>SQL Server</strong>
        driver from the Available ODBC Drivers list box. </font></li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        the <strong>OK</strong> button. Setup will complete
        copying the necessary files. </font></p>
    </li>
</ol>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;Use
    Microsoft Access to install the Microsoft Access ODBC driver.
    To log to an Access database, Microsoft Proxy Server requires
    the 32-bit ODBC drivers shipped with Microsoft® Office95 and
    Microsoft® Access95. The ODBC driver for Microsoft
    Access&nbsp;2.0 will not work with Microsoft Proxy Server. </font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">Once ODBC drivers have
been installed, you can use them to create and set system DSNs.
For more information, see </font><a href="#8h3"><font size="2"
face="Verdana, Arial, Helvetica">Defining a System Data Source Name</font></a><font
size="2" face="Verdana, Arial, Helvetica"> later in this chapter.</font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="8h3"><font size="2"
face="Verdana, Arial, Helvetica">Defining a System Data Source Name</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">The system DSN is a
logical name used by ODBC to refer to the driver and any other
information required to access the data, such as the name of the
server where the database is located. Once the ODBC driver for
your database is installed, a system DSN must be added for
database logging. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">When adding a DSN for
your database, choose a unique name that is not likely to be
repeated elsewhere in configuring the database. Avoid any types
of names that could be repeated or assigned for database users.
You may also use the default DSN, &#147;Proxy Server SQL.&#148;
Also, the DSN you decide to use will need to match the DSN
setting in the SQL or Access database to be used for logging.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For Microsoft SQL
Server, the server name, network address, and network library
displayed in this dialog box are specific to your installation.
You must enter a server name, but if you do not know what to
enter in the network address and network library fields you can
accept the defaults.</font></p>

<h4><a name="TosetasystemDataSourceName"><font size="2"
face="Verdana, Arial, Helvetica"><strong>To set a system Data Source Name </strong></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the desktop of the server, click the <strong>Start</strong>
        button. Select <strong>Settings</strong> and click <strong>Control
        Panel</strong>. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Double-click the
        ODBC icon.</font><p><font size="2"
        face="Verdana, Arial, Helvetica">The <strong>ODBC Data Sources</strong>
        dialog box appears. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <strong>System
        DSN</strong> button.</font><hr>
        <p><font color="#FF0000" size="2" face="Verdana, Arial, Helvetica"><strong>Important</strong></font><font
        size="2" face="Verdana, Arial, Helvetica">&nbsp;&nbsp;&nbsp;Be
        sure to click the <strong>System DSN </strong>button.
        Logging to a database will only work with system DSNs. </font></p>
        <hr>
        <p><font size="2" face="Verdana, Arial, Helvetica">The <strong>System
        Data Sources</strong> dialog box appears. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <strong>Add</strong>
        button.</font><p><font size="2" face="Verdana, Arial, Helvetica">The
        <strong>Add Data Source</strong> dialog box appears. The
        installed ODBC drivers are listed. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Select
        an ODBC driver and click <strong>OK</strong>. A dialog
        box specific to your driver appears. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Enter the Data
        Source Name and configure the DSN parameters.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">Use a unique name for
        the DSN. For Microsoft SQL Server, the server name,
        network address, and network library displayed in this
        dialog box are specific to your installation. You must
        enter a server name, but if you do not know what to enter
        in the network address and network library fields you can
        accept the defaults. For Microsoft Access, the system DSN
        is the file name of the database. For example, if the
        Microsoft Access database you are logging to is named
        Proxylog.mdb, the system DSN would be Proxylog. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        the <strong>Option</strong> button and specify a database
        name in the <strong>Database Name</strong> field. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>OK</strong>.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <strong>System Data
        Sources</strong> dialog box returns, with the new system
        data source name added. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Close</strong>,
        then click <strong>Close</strong> again.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <strong>System Data
        Sources</strong> dialog box returns. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Close</strong>.<br>
        <br>
        </font></li>
</ol>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="954h3"><font size="2"
face="Verdana, Arial, Helvetica">Setting Up Database Tables</font></a></h3>

<blockquote>
    <p><a href="#3h4"><font size="2" face="Verdana, Arial, Helvetica">Using
    the SQL Logging Table Tool</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#2h4"><font size="2" face="Verdana, Arial, Helvetica">Microsoft
    SQL Server Table Format</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#1h4"><font size="2" face="Verdana, Arial, Helvetica">Microsoft
    Access Table Format</font></a></p>
</blockquote>

<h4><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="3h4"><font size="2"
face="Verdana, Arial, Helvetica">Using the SQL Logging Table Tool</font></a></h4>

<p><font size="2" face="Verdana, Arial, Helvetica">When installed,
Microsoft Proxy Server provides an additional form-based tool
that can be used to generate a single Microsoft SQL table with
the required field names, data type, and field length settings
(as described in </font><a href="#2h4"><font size="2"
face="Verdana, Arial, Helvetica">Microsoft SQL Server Table Format</font></a><font
size="2" face="Verdana, Arial, Helvetica"> below). </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;The
same table format is used for regular and verbose logging
formats. When regular logging format is selected, some fields are
not used and will remain empty. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The SQL logging table
tool, Mkplog.exe, should be executed as a URL from within a Web
browser application on the same computer used for Microsoft SQL
Server. Mkplog.exe is located in the IIS scripts directory
(C:\Inetpub\Scripts\Tools) on the computer running Microsoft
Proxy Server. </font></p>

<h4><a
name="TocreateatableforloggingwithMicrosoftProxyServerbyusingMkplog.exe"><font
size="2" face="Verdana, Arial, Helvetica">To create a table for logging
with Microsoft Proxy Server by using Mkplog.exe</font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Open
        the Web browser application, such as Internet Explorer,
        on the computer running Microsoft SQL Server. This
        computer must be located on the same internal network
        segment as the computer running Microsoft Proxy Server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Enter
        the correct URL to retrieve and load the form-based tool
        page in your browser. For example, if the server name for
        your Microsoft Proxy Server computer were Myproxyserver,
        you would type the URL as
        http://myproxyserver/scripts/tools/mkplog.exe. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Follow
        the on-screen instructions. </font></p>
    </li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;Mkplog.exe
will work only for Microsoft SQL Server databases. Microsoft®
Access tables must be created manually for use with logging.</font></p>

<h4><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="2h4"><font size="2"
face="Verdana, Arial, Helvetica">Microsoft SQL Server Table Format</font></a></h4>

<p><font size="2" face="Verdana, Arial, Helvetica">For a Microsoft SQL
Server database table to be used for the WinSock Proxy or Web
Proxy service log, refer to the following table when defining the
required fields and data types.</font></p>

<p><font size="3" face="Verdana, Arial, Helvetica"><strong>SQL Table
Structure</strong></font></p>

<table border="1" cellpadding="5" cellspacing="0" width="60%">
    <tr>
        <th valign="bottom" width="33%"><font size="2"
        face="Verdana, Arial, Helvetica">Field name</font></th>
        <th valign="bottom" width="33%"><font size="2"
        face="Verdana, Arial, Helvetica">Data type</font></th>
        <th valign="bottom" width="34%"><font size="2"
        face="Verdana, Arial, Helvetica">Length</font></th>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">ClientIP </font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">varchar</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">50</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">ClientUserName</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">varchar</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">50</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">ClientAgent</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">varchar</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">100</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">ClientAuthenticate</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">char</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">5</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">logTime</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">datetime</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">&#151;</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">service</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">varchar</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">25</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">servername</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">varchar</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">50</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">referredserver</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">varchar</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">100</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">DestHost</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">varchar</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">255</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">DestHostIP</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">varchar</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">50</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">DestHostPort</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">int</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">&#151;</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">processingtime</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">int</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">&#151;</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">bytessent</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">int</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">&#151;</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">bytesrecvd</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">int</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">&#151;</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">protocol</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">varchar</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">25</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">transport</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">varchar</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">25</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">operation</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">varchar</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">255</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">uri</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">varchar</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">255</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">mimetype</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">varchar</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">25</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">objectsource</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">varchar</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">25</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">resultcode</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">int</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">&#151;</font></td>
    </tr>
</table>

<h4><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="1h4"><font size="2"
face="Verdana, Arial, Helvetica">Microsoft Access Table Format</font></a></h4>

<p><font size="2" face="Verdana, Arial, Helvetica">For a Microsoft Access
database table to be used for the WinSock Proxy or Web Proxy
service log, refer to the following table when defining the
required fields and data types.</font></p>

<p><font size="3" face="Verdana, Arial, Helvetica"><strong>Microsoft
Access Table Structure</strong></font></p>

<table border="1" cellpadding="5" cellspacing="0" width="60%">
    <tr>
        <th valign="bottom" width="33%"><font size="2"
        face="Verdana, Arial, Helvetica">Field name</font></th>
        <th valign="bottom" width="33%"><font size="2"
        face="Verdana, Arial, Helvetica">Data type</font></th>
        <th valign="bottom" width="34%"><font size="2"
        face="Verdana, Arial, Helvetica">Length</font></th>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">ClientIP </font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">text</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">50</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">ClientUserName</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">text</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">50</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">ClientAgent</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">text</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">100</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">ClientAuthenticate</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">text</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">5</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">logTime</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">datetime</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">&#151;</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">service</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">text</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">25</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">servername</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">text</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">50</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">referredserver</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">text</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">100</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">DestHost</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">text</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">255</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">DestHostIP</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">text</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">50</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">DestHostPort</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">Long Integer</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">&#151;</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">processingtime</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">Long Integer</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">&#151;</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">bytessent</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">Long Integer</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">&#151;</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">bytesrecvd</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">Long Integer</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">&#151;</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">protocol</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">text</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">25</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">transport</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">text</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">25</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">operation</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">text</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">255</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">uri</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">text</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">255</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">mimetype</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">text</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">25</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">objectsource</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">text</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">25</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">resultcode</font></td>
        <td align="center" valign="top" width="33%"><font
        size="2" face="Verdana, Arial, Helvetica">Long Integer</font></td>
        <td align="center" valign="top" width="34%"><font
        size="2" face="Verdana, Arial, Helvetica">&#151;</font></td>
    </tr>
</table>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="6h3"><font size="2"
face="Verdana, Arial, Helvetica">Configuring the Service to Log to a
Database</font></a></h3>

<h4><a name="Toenabletheservicetologtoadatabase"><font size="2"
face="Verdana, Arial, Helvetica"><strong>To enable the service to log to a
database</strong></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        Internet Service Manager, double-click the computer name
        next to the <strong>WinSock Proxy </strong>or <strong>Web
        Proxy</strong> service, then click the <strong>Logging</strong>
        tab. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Select
        the <strong>Enable Logging</strong> check box. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Select
        either <strong>Regular Logging</strong> (to record only a
        subset of the available information) or <strong>Verbose
        Logging </strong>(to record all available information). </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Select
        <strong>Log to SQL/ODBC Database</strong>. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">In
        the <strong>ODBC Data Source Name (DSN)</strong> box,
        type the exact system DSN that you created for the
        database that you will be logging to. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">In
        the <strong>Table</strong> field, type the name of the
        table that you will be logging to. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">In
        the <strong>User Name</strong> and <strong>Password</strong>
        fields, type a user name and password that is valid for
        that database and table. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        <strong>Apply</strong>, then click <strong>OK</strong>. </font></p>
    </li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">For more information
about the Web Proxy and WinSock Proxy service logs, see </font><a
href="06_msp.htm#Top"><font size="2" face="Verdana, Arial, Helvetica">&#147;Configuring the Web Proxy service,&#148;</font></a><font
size="2" face="Verdana, Arial, Helvetica"> and </font><a
href="07_msp.htm#Top"><font size="2" face="Verdana, Arial, Helvetica">&#147;Configuring the WinSock Proxy Service.&#148;</font></a><font
size="2" face="Verdana, Arial, Helvetica"> For more information about
Event Viewer and the Application and System logs, see your
documentation for Windows&nbsp;NT. </font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="3h3"><font size="2"
face="Verdana, Arial, Helvetica">Log Fields</font></a></h2>

<blockquote>
    <p><a href="#11111"><font size="2" face="Verdana, Arial, Helvetica">Log
    Field Summary<br>
    </font></a><a href="#11112"><font size="2"
    face="Verdana, Arial, Helvetica">Client Information Fields<br>
    </font></a><a href="#11113"><font size="2"
    face="Verdana, Arial, Helvetica">Server Information Fields<br>
    </font></a><a href="#11114"><font size="2"
    face="Verdana, Arial, Helvetica">Connection Information Fields<br>
    </font></a><a href="#11115"><font size="2"
    face="Verdana, Arial, Helvetica">Object Information Fields</font></a></p>
</blockquote>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="11111"><font size="2"
face="Verdana, Arial, Helvetica">Log Field Summary</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">The Web Proxy and
WinSock Proxy service logs contain information related to the
following areas:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">Client Information</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Server Information</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Connection
        Information</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Object Information
        </font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">When verbose logging is
selected, the following fields appear in log entries:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">Client Computer
        Name</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Client User Name</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Client Agent</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Client Platform</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Authentication
        Status</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Log Date</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Log Time</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Service Name</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Proxy Name</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Referring Server
        Name</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Destination Name</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Destination
        Address</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Destination Port</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Processing Time</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Bytes Sent</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Bytes Received</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Protocol Name</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Transport</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Operation</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Object Name</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Object MIME</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Object Source</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Result Code</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">When regular logging is
selected, only the following elements appear in log entries:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">Client Computer
        Name</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Client User Name</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Authentication
        Status</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Log Date</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Log Time</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Service Name</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Destination Name</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Destination Port</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Protocol Name</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Object Name</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Object Source</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Result Code</font></li>
</ul>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="11112"><font size="2"
face="Verdana, Arial, Helvetica">Client Information Fields</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Client Computer
Name</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">Typically, this is
    the network IP address for the client computer initiating a
    Web Proxy or WinSock Proxy request. In cases where active
    caching is occurring, this field is the IP address for the
    computer running Microsoft Proxy Server.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Client User
Name</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">The Windows&nbsp;NT
    logon account name for the current user on the client
    computer initiating the Web Proxy or WinSock Proxy request.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Client Agent</strong></font></p>

<blockquote>
    <ul>
        <li><font size="2" face="Verdana, Arial, Helvetica">For the Web
            Proxy service, indicates specialized header
            information from the client browser to use when
            processing the proxy request. </font></li>
        <li><font size="2" face="Verdana, Arial, Helvetica">For the
            WinSock Proxy service, indicates the name of the
            client application that is generating the Windows
            Socket process request. </font></li>
    </ul>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Client Platform</strong></font></p>

<blockquote>
    <ul>
        <li><font size="2" face="Verdana, Arial, Helvetica">For the Web
            Proxy service, this field is not used. </font></li>
        <li><font size="2" face="Verdana, Arial, Helvetica">For the
            WinSock Proxy service, indicates the client operating
            system, as shown in the following table:</font></li>
    </ul>
    <blockquote>
        <table border="1" cellpadding="5" cellspacing="0"
        width="50%">
            <tr>
                <th valign="bottom" width="50%"><font size="2"
                face="Verdana, Arial, Helvetica">Field Entry</font></th>
                <th valign="bottom" width="50%"><font size="2"
                face="Verdana, Arial, Helvetica"><strong>Client Operating
                System</strong></font></th>
            </tr>
            <tr>
                <td align="center" valign="top" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica">0:3.1</font></td>
                <td align="center" valign="top" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica">Windows&nbsp;3.1</font></td>
            </tr>
            <tr>
                <td align="center" valign="top" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica">0:3.11</font></td>
                <td align="center" valign="top" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica">Windows for
                Workgroups</font></td>
            </tr>
            <tr>
                <td align="center" valign="top" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica">0:3.95</font></td>
                <td align="center" valign="top" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica">Windows&nbsp;95
                (16-bit)</font></td>
            </tr>
            <tr>
                <td align="center" valign="top" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica">1:3.11</font></td>
                <td align="center" valign="top" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica">Win32s</font></td>
            </tr>
            <tr>
                <td align="center" valign="top" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica">2:4.0</font></td>
                <td align="center" valign="top" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica">Windows&nbsp;95
                (32-bit)</font></td>
            </tr>
            <tr>
                <td align="center" valign="top" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica">3:3.51</font></td>
                <td align="center" valign="top" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica">Windows&nbsp;NT
                3.51</font></td>
            </tr>
            <tr>
                <td align="center" valign="top" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica">3:4.0</font></td>
                <td align="center" valign="top" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica">Windows&nbsp;NT
                4.0</font></td>
            </tr>
        </table>
    </blockquote>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Authentication
Status</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">This indicates
    whether or not the Web Proxy or WinSock Proxy request is
    using an authenticated connection to the Microsoft Proxy
    Server.</font></p>
</blockquote>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="11113"><font size="2"
face="Verdana, Arial, Helvetica">Server Information Fields</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Log Date</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">The date on
    Microsoft Proxy Server when the logged event occurred. </font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Log Time</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">The time on
    Microsoft Proxy Server when the logged event occurred. </font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Service Name</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">The name of the
    active service being logged. In verbose logging,
    &#147;W3Proxy&#148; indicates Web Proxy service logging, or
    &#147;WSProxy&#148; indicates WinSock Proxy service logging. </font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">In regular logging,
    this field uses numbers. A value of &#147;1&#148; indicates
    Web Proxy service logging; a value of &#147;2&#148; indicates
    WinSock Proxy service logging.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Proxy Name</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">The name of the
    computer running Microsoft Proxy Server. This is the name
    assigned in Windows&nbsp;NT&nbsp;4.0 Server for the computer.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Referring
Server Name</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">The name of a
    downstream Microsoft Proxy Server that referred the proxy
    request to the current Microsoft Proxy Server. This field is
    not used in the current version of Microsoft Proxy Server and
    is reserved for later versions which will include support for
    cascading (multiple) proxy servers.</font></p>
</blockquote>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="11114"><font size="2"
face="Verdana, Arial, Helvetica">Connection Information Fields</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Destination
Name</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">The domain name for
    the remote computer servicing the current Web Proxy or
    WinSock Proxy connection. For Web Proxy service, a hyphen (-)
    in this field may indicate that an object was sourced from
    the Web Proxy Server cache and not from the destination. (One
    exception is negative caching. In that case, this field will
    indicate a destination name for which a negative cached
    object was returned.)</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Destination
Address</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">The network IP
    address for the remote computer servicing the current Web
    Proxy or WinSock Proxy connection. For Web Proxy service, a
    hyphen (-) in this field may indicate that an object was
    sourced from the Web Proxy Server cache and not from the
    destination. (One exception is negative caching. In that
    case, this field will indicate a destination IP address for
    which a negative cached object was returned.)</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Destination
Port</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">The reserved port
    number on the remote computer servicing the current Web Proxy
    or WinSock Proxy connection. This is used by the client
    application initiating the request.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Processing Time</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">This indicates the
    total time in milliseconds needed by Microsoft Proxy Server
    to process the current Web Proxy or WinSock Proxy connection.
    It measures elapsed server time from when the server first
    received the request to the time when final processing
    occurred on the server (results were returned to client and
    connection closed).</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;For
    cache requests processed through the Web Proxy service,
    processing time measures the elapsed server time needed to
    fully process a client request and return an object from the
    server&#146;s cache to the client.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Bytes Sent</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">For the Web Proxy
    service, the number of bytes sent to the remote computer
    during the current connection. The use of a hyphen (-) or the
    use of a zero or negative number in this field indicates that
    this information was not provided by the remote computer, or
    that no bytes were sent to the remote computer.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">The WinSock Proxy
    service does not enter data in this field.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Bytes Received</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">For the Web Proxy
    service, the number of bytes received from the remote
    computer during the current connection. The use of a hyphen
    (-) or the use of a zero or negative number in this field
    indicates that this information was not provided by the
    remote computer, or that no bytes were received from the
    remote computer.</font></p>
    <p><font size="2" face="Verdana, Arial, Helvetica">The WinSock Proxy
    service does not enter data in this field.</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Protocol Name</strong></font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">For the Web Proxy
        service, specifies the protocol used for transfer (such
        as HTTP, FTP, or Gopher).</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">For the WinSock
        Proxy service, specifies a well-known destination port
        number for the socketed application (such as
        port&nbsp;1070 for RealAudio).</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Transport</strong></font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">For the Web Proxy
        Service, specifies the transport protocol. For the Web
        Proxy service, this is always TCP.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">For the WinSock
        Proxy service, specifies the transport protocol. For the
        WinSock Proxy service, this can be TCP, UDP, or IPX/SPX.</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Operation</strong></font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">For the Web Proxy
        service, specifies the current HTTP method used. Possible
        values can include GET, PUT, POST, and HEAD.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">For the WinSock
        Proxy service, specifies the current socket API call in
        use. Possible values can include Connect, Accept, SendTo,
        RecvFrom, GetHostByName.</font></li>
</ul>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="11115"><font size="2"
face="Verdana, Arial, Helvetica">Object Information Fields</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Object Name</strong></font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">For the Web Proxy
        service, this field shows the contents of the URL
        request.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">For the WinSock
        Proxy service, this field is not used.</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Object MIME</strong></font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">For the Web Proxy
        service, the Multi-purpose Internet Mail Extensions
        (MIME) type for the current object. The following table
        provides a partial listing of MIME types supported by
        most Web browsers. This field may also be filled with a
        hyphen (-) to indicate that this field is not used, or
        that a valid MIME type was not defined or supported by
        the remote computer.<br>
        </font></li>
</ul>

<blockquote>
    <div align="left"><table border="1" cellpadding="5"
    cellspacing="0" width="45%">
        <tr>
            <td align="center" valign="bottom" width="40%"><font
            size="2" face="Verdana, Arial, Helvetica"><strong>MIME Type</strong></font></td>
            <th align="left" valign="bottom" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica"><strong>Description</strong></font></th>
        </tr>
        <tr>
            <td align="center" valign="top" width="40%"><font
                size="2" face="Verdana, Arial, Helvetica">application/x-msdownload</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Application (executable).</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="40%"><font
            size="2" face="Verdana, Arial, Helvetica">image/gif</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">GIF image file.</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="40%"><font
            size="2" face="Verdana, Arial, Helvetica">image/jpeg</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">JPEG image file.</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="40%"><font
            size="2" face="Verdana, Arial, Helvetica">multipart/x-zip</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">PKZIP archive file.</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="40%"><font
            size="2" face="Verdana, Arial, Helvetica">text/plain</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Plain text file.</font></td>
        </tr>
    </table>
    </div>
</blockquote>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">For the WinSock
        Proxy service, this field is not used.</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Object Source</strong></font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">For the Web Proxy
        service, indicates the source used to retrieve the
        current object, as shown in the following table:</font></li>
</ul>

<blockquote>
    <div align="left"><table border="1" cellpadding="5"
    cellspacing="0" width="45%">
        <tr>
            <td align="center" valign="bottom" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica"><strong>Source
            Values</strong></font></td>
            <th align="left" valign="bottom" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica"><strong>Source</strong></font></th>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
                size="2" face="Verdana, Arial, Helvetica">Unknown</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">No source information
            available. </font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">Cache</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Source is cache. Object
            returned from cache.</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">RCache</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Source is Internet. Object
            added to cache.</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">VCache</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Source is cache. Object was
            verified to source and passed.</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">NVCache</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Source is cache. Object could
            not be verified to source.</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">VFInet</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Source is Internet. Cached
            object was verified to source and failed.</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">PragNoCacheInet</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Source is Internet. HTTP
            header field indicated &#147;Do not cache.&#148;</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">Inet</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Source is Internet. Object
            not cached. </font></td>
        </tr>
    </table>
    </div>
</blockquote>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">For the WinSock
        Proxy service, this field is not used.</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Result Code</strong></font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">For the Web Proxy
    service, this field can be used to indicate either a Windows
    error code (for values less than 100), an HTTP status code
    (values between 100 and 1000), or a Wininet or WinSock error
    code value (for values over 10000). A partial listing of some
    of the supported values for this field is listed below. For
    more information on other values, contact your technical
    support provider or see Microsoft TechNet for more
    information on specific values not listed here.</font></p>
    <div align="left"><table border="1" cellpadding="5"
    cellspacing="0" width="45%">
        <tr>
            <td align="center" valign="bottom" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica"><strong>Values</strong></font></td>
            <th align="left" valign="bottom" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica"><strong>Description</strong></font></th>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
                size="2" face="Verdana, Arial, Helvetica">200</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Successful connection</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">10060</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Connection timed out. </font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">10061</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Connection refused by
            destination.</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">10065</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Host unreachable.</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">11001</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Host not found.</font></td>
        </tr>
    </table>
    </div><p><font size="2" face="Verdana, Arial, Helvetica">For the
    WinSock Proxy service, this field indicates status
    information about the connection as shown in the following
    table:</font></p>
    <div align="left"><table border="1" cellpadding="5"
    cellspacing="0" width="45%">
        <tr>
            <td align="center" valign="bottom" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica"><strong>Source
            Values</strong></font></td>
            <th align="left" valign="bottom" width="50%"><font
                size="2" face="Verdana, Arial, Helvetica"><strong>Source</strong></font></th>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
                size="2" face="Verdana, Arial, Helvetica">0</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Successful connection.</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">1</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Server failure.</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">2</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Rejection by proxy
            (filtering).</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">3</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Network unreachable (no DNS
            service available).</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">4</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Host unreachable (no DNS
            entry for host).</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">5</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Connection refused by
            destination.</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">6</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Unsupported client request.</font></td>
        </tr>
        <tr>
            <td align="center" valign="top" width="20%"><font
            size="2" face="Verdana, Arial, Helvetica">7</font></td>
            <td valign="top" width="50%"><font size="2"
            face="Verdana, Arial, Helvetica">Unsupported address type.</font></td>
        </tr>
    </table>
    </div>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="9h2"><font size="2"
face="Verdana, Arial, Helvetica">Logging Issues</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">In most cases, normal
event logging for Web Proxy or WinSock Proxy services will not
cause serious problems for Microsoft Proxy Server service
performance. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Problems that can
result from logging are most likely to be caused by filling up a
disk drive that is being used for both logging and caching. For
this reason, it is recommended that you monitor available disk
space and service-log file size on a regular basis. This is
particularly important if you are using a single disk drive for
storing cache files and log files. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">If a hard disk on the
server becomes full, the Web Proxy and WinSock Proxy services
will continue to operate, but logging may be affected for both
services, and caching may be affected for the Web Proxy service.
If all disks configured to store the logs are full, the services
will continue to run but no new log entries will be saved. </font></p>

<hr>

<p><font color="#FF0000" size="2" face="Verdana, Arial, Helvetica"><strong>Important</strong></font><font
size="2" face="Verdana, Arial, Helvetica"><strong>&nbsp;&nbsp;&nbsp;</strong>Running
Microsoft Proxy Server without logging should be considered a
nonsecure condition.</font></p>

<hr>

<p><font size="2" face="Verdana, Arial, Helvetica">If all disks configured
to store the cache become full, the Web Proxy service can stop
functioning, and will return error 112 (disk full) for many
queries. To help prevent the disk from filling up, it is a good
idea to store the logs and the cache on different volumes.</font></p>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="8h2"><font size="2"
face="Verdana, Arial, Helvetica">Windows&nbsp;NT Logs</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">Microsoft Proxy Server
uses the Windows&nbsp;NT system log to register events for active
services. When a service event is logged, each log entry lists a
source name to indicate the service that logged the event to the
system log. This information can be useful when monitoring server
performance or troubleshooting problems with the server.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The following table
lists event log source names and the services that correspond to
each source name. </font></p>
<div align="left">

<table border="1" cellpadding="5" cellspacing="0" width="45%">
    <tr>
        <td align="center" valign="bottom" width="30%"><font
        size="2" face="Verdana, Arial, Helvetica"><strong>Source Name</strong></font></td>
        <th align="left" valign="bottom" width="50%"><font
        size="2" face="Verdana, Arial, Helvetica"><strong>Description </strong></font></th>
    </tr>
    <tr>
        <td align="center" valign="top" width="30%"><font
        size="2" face="Verdana, Arial, Helvetica">WebProxyServer</font></td>
        <td valign="top" width="50%"><font size="2"
        face="Verdana, Arial, Helvetica">Web Proxy service events</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="30%"><font
        size="2" face="Verdana, Arial, Helvetica">WebProxyLog</font></td>
        <td valign="top" width="50%"><font size="2"
        face="Verdana, Arial, Helvetica">Web Proxy logging events</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="30%"><font
        size="2" face="Verdana, Arial, Helvetica">WebProxyCache</font></td>
        <td valign="top" width="50%"><font size="2"
        face="Verdana, Arial, Helvetica">Web Proxy caching events</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="30%"><font
        size="2" face="Verdana, Arial, Helvetica">WinSockProxy</font></td>
        <td valign="top" width="50%"><font size="2"
        face="Verdana, Arial, Helvetica">WinSock Proxy service events</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="30%"><font
        size="2" face="Verdana, Arial, Helvetica">WinSockProxyLog</font></td>
        <td valign="top" width="50%"><font size="2"
        face="Verdana, Arial, Helvetica">WinSock Proxy logging events</font></td>
    </tr>
    <tr>
        <td align="center" valign="top" width="30%"><font
        size="2" face="Verdana, Arial, Helvetica">MSProxyAdmin</font></td>
        <td valign="top" width="50%"><font size="2"
        face="Verdana, Arial, Helvetica">Microsoft Proxy Server
        administrative events</font></td>
    </tr>
</table>
</div>

<h4><a name="TovieweventmessagesfromEventViewer"><font size="2"
face="Verdana, Arial, Helvetica"><strong>To view event messages from Event
Viewer</strong></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the Start menu, select <strong>Programs. </strong>Then,<strong>
        </strong>select <strong>Administrative Tools</strong> and
        click <strong>Event Viewer</strong>. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the Log menu, select <strong>System</strong> for the
        current view. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">To
        view source details about a message or a description of
        the message, select a message from the event listing and
        double-click it. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">The <strong>Event
        Detail</strong> window for the selected message appears.
        &nbsp; </font></p>
    </li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">For information about
individual messages logged to the Windows&nbsp;NT system log, see
</font><a href="hh_msp.htm#Top"><font size="2"
face="Verdana, Arial, Helvetica">Appendix H, &#147;Setup Messages,&#148;</font></a><font
size="2" face="Verdana, Arial, Helvetica"> </font><a href="ii_msp.htm#Top"><font
size="2" face="Verdana, Arial, Helvetica">Appendix I, &#147;Web Proxy
Messages,&#148;</font></a><font size="2" face="Verdana, Arial, Helvetica">
and </font><a href="j2_msp.htm#Top"><font size="2"
face="Verdana, Arial, Helvetica">Appendix J, &#147;WinSock Proxy
Messages.&#148;</font></a><font size="2" face="Verdana, Arial, Helvetica">
For more information about using Event Viewer, see your
documentation provided for Windows&nbsp;NT Server or refer to the
online Help.</font></p>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="2h1"><font size="2"
face="Verdana, Arial, Helvetica">Performance Monitor Counters</font></a></h1>

<blockquote>
    <p><a href="#6h2"><font size="2" face="Verdana, Arial, Helvetica">Using
    Performance Monitor</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#7h2"><font size="2" face="Verdana, Arial, Helvetica">Microsoft
    Proxy Server Counters</font></a><font size="2"
    face="Verdana, Arial, Helvetica"> <br>
    </font></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="6h2"><font size="2"
face="Verdana, Arial, Helvetica">Using Performance Monitor</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Windows&nbsp;NT
includes a tool called Performance Monitor for tracking computer
performance. When you monitor a system, you actually monitor the
behavior of its parts. A set of counters exists for the
processor, memory, cache, hard disk, processes, and other parts
that produce statistical information. Certain counters are
standard; others are configured or added with the installation of
new software. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">When Microsoft Proxy
Server is installed on a new installation of Windows&nbsp;NT
Server, three additional Performance Monitor objects are created.</font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Web
        Proxy Server Cache&nbsp;&nbsp;&nbsp;</strong>This object
        type includes counters specific to URL caching performed
        by the Web Proxy service. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Web
        Proxy Server Service&nbsp;&nbsp;&nbsp;</strong>This
        object type includes counters specific to the Web Proxy
        Server service. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>WinSock
        Proxy Server&nbsp;&nbsp;&nbsp;</strong>This object type
        includes counters specific to the WinSock Proxy Server
        service. </font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">You do not need special
privileges to open Performance Monitor. However, you do need to
be logged on as a member of the Administrators group to use the <b>diskperf</b>
command. For performance monitoring of Microsoft Proxy Server,
you can select counters directly in Performance Monitor. There is
also a <strong>Start</strong> menu option for quick access to
WinSock Proxy performance monitoring. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;Activating
object counters for performance monitoring can increase disk
access time.</font></p>

<h4><a name="TomonitorMicrosoftProxyServerperformance"><font
size="2" face="Verdana, Arial, Helvetica"><strong>To monitor Microsoft
Proxy Server performance</strong></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the desktop, click <strong>Start</strong>. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Select
        <b>Programs</b>, and then select the<b> Microsoft Proxy
        Server </b>program group. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        <b>Monitor Microsoft Proxy Server Performance</b>. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">Performance
        Monitor starts, and loads a set of Microsoft Proxy Server
        counters.<br>
        <br>
        </font></p>
    </li>
</ol>

<h4><font size="2" face="Verdana, Arial, Helvetica">To start Performance
Monitor without loading Proxy Server counters</font></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica"><b>From the
        desktop, click Start</b>. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select <b>Programs</b>,
        then select the <b>Administrative Tools</b> program
        group. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <b>Performance
        Monitor</b>.<br>
        <br>
        </font></li>
</ol>

<h4><a name="Toviewcounters"><font size="2"
face="Verdana, Arial, Helvetica"><b>To view counters</b></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the <b>File</b> menu, click <b>New Chart</b>. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the <b>Edit</b>
        menu, click <b>Add to Chart</b>.</font><p><font size="2"
        face="Verdana, Arial, Helvetica">The <b>Add to Chart</b> dialog
        box appears. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select an object
        from the <b>Object</b> list. For example, you might
        select <b>WinSock Proxy Server.</b> </font><p><font
        size="2" face="Verdana, Arial, Helvetica">The counters for that
        object appear in the <b>Counter</b> list. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Select
        a counter from the <b>Counter</b> list. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        <b>Add</b>. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Repeat
        steps 3, 4, and 5 to add additional counters. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">When
        all counters have been added, click <b>Done</b>. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">The <strong>Performance
        Monitor</strong> window returns. Information from the
        selected counters is displayed. </font></p>
    </li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica">For more information
about using Performance Monitor, see its online Help. Also see
your documentation for Windows&nbsp;NT. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The <b>diskperf</b>
command turns the counters for disk activity on and off. <b>Diskperf</b>
works for a local or a remote computer. After restarting the
computer, you can use Performance Monitor to view disk
performance data. </font></p>

<h4><a name="Toactivatethephysicalandlogicaldiskcounters"><font
size="2" face="Verdana, Arial, Helvetica"><b>To activate the physical and
logical disk counters</b></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Log
        on as a member of the Administrators group. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">At
        the command prompt, type <strong>diskperf</strong> to
        view Help information on how to turn diskperf on and off
        and how to specify a remote computer&#146;s name. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Follow
        the instructions to turn diskperf on or off. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">To
        activate the disk performance counters, reboot the
        server.<br>
        <br>
        </font></p>
    </li>
</ol>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="7h2"><font size="2"
face="Verdana, Arial, Helvetica">Microsoft Proxy Server Counters</font></a></h2>

<blockquote>
    <p><a href="#950h3"><font size="2" face="Verdana, Arial, Helvetica">About
    the Microsoft Proxy Server Objects</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#951h3"><font size="2"
    face="Verdana, Arial, Helvetica">Web Proxy Server Cache Counters</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#952h3"><font size="2"
    face="Verdana, Arial, Helvetica">Web Proxy Server Service Counters</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#953h3"><font size="2"
    face="Verdana, Arial, Helvetica">WinSock Proxy Server Counters</font></a></p>
</blockquote>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="950h3"><font size="2"
face="Verdana, Arial, Helvetica">About the Microsoft Proxy Server Objects</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">When Microsoft Proxy
Server is installed, the following objects are installed into
Performance Monitor: <b>Web Proxy Server Cache,</b> <b>Web Proxy
Server Service,</b> and <strong>WinSock Proxy Server. </strong>These
three Performance Monitor objects contain all additional
performance counters that are added for monitoring Microsoft
Proxy Server. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Statistics from each
Microsoft Proxy Server counters can be displayed in the
Performance Monitor window and added to charts, logs, or reports
created for service monitoring. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Also, you can set
system alerts for any specific counters. By setting alerts, you
can choose to have any of the following responses occur when a
counter reaches a predefined limit.</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">The active
        monitoring view for Performance Monitor changes to the
        Alert view and the Alert window displays information
        about the reason for the alert. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">The event that
        caused the alert status is logged in the Application log
        of the Event Viewer.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">An alert message
        is broadcast over the network by the server.</font></li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;When
the Web Proxy or WinSock Proxy services are stopped and
restarted, most counter values are reset and previous counter
data is cleared. Some Web Proxy Server Cache counter values for
URLs or bytes stored in the cache are recalculated according to
the persistent cache contents.</font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="951h3"><font size="2"
face="Verdana, Arial, Helvetica">Web Proxy Server Cache Counters</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">The counters in the <b>Web
Proxy Server Cache</b> object include counters specific to URL
caching performed by the Web Proxy service. The following list
describes those counters. </font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Active
        Refresh Bytes Rate&nbsp;&nbsp;&nbsp;</b>The number of
        bytes of data per second retrieved from the Internet to
        proactively refresh popular URLs in the URL cache. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Active
        URL Refresh Rate&nbsp;&nbsp;&nbsp;</b>The number of
        popular URLs per second that are preemptively refreshed
        in the URL cache from remote URL sources on the Internet.
        </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Bytes
        Committed Rate&nbsp;&nbsp;&nbsp;</b>The number of bytes
        of data per second committed to disk storage in the URL
        cache </font></p>
    </li>
</ul>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Bytes
        in Cache</b>&nbsp;&nbsp;&nbsp;The total number of bytes
        currently contained in the URL cache (stored on disk). </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Bytes
        Retrieved Rate</b>&nbsp;&nbsp;&nbsp;The number of bytes
        of data per second retrieved from disk storage in the URL
        cache. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Max
        Bytes Cached&nbsp;&nbsp;&nbsp;</b>The maximum number of
        bytes that have been stored in the URL cache. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Max
        URLs Cached&nbsp;&nbsp;&nbsp;</b>The maximum number of
        URLs that have been stored in the URL cache. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Total
        Actively Refreshed URLs&nbsp;&nbsp;&nbsp;</b>The
        cumulative number of popular URLs in the URL cache that
        have been preemptively refreshed from the Internet. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Total
        Bytes Actively Refreshed&nbsp;&nbsp;&nbsp;</b>The
        cumulative number of bytes retrieved from the Internet to
        preemptively refresh popular URLs in the URL cache. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Total
        Bytes Cached&nbsp;&nbsp;&nbsp;</b>The cumulative number
        of bytes that have been stored in the URL cache. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Total
        Bytes Retrieved&nbsp;&nbsp;&nbsp;</b>The cumulative
        number of bytes that have been retrieved from the URL
        cache. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Total
        URLs Cached&nbsp;&nbsp;&nbsp;</b>The cumulative number of
        URLs that have been stored in the URL cache. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Total
        URLs Retrieved&nbsp;&nbsp;&nbsp;</b>The cumulative number
        of URLs that have been retrieved from the URL cache. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>URL
        Commit Rate&nbsp;&nbsp;&nbsp;</b>The number of URLs per
        second committed to the URL cache. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>URL
        Retrieve Rate&nbsp;&nbsp;&nbsp;</b>The number of URLs per
        second retrieved from the URL cache. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>URLs
        in Cache&nbsp;&nbsp;&nbsp;</b>The current number of URLs
        in the URL cache.<br>
        <br>
        </font></p>
    </li>
</ul>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="952h3"><font size="2"
face="Verdana, Arial, Helvetica">Web Proxy Server Service Counters</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">The counters in the <b>Web
Proxy Server Service </b>object include counters specific to the
Web Proxy service. The following list describes those counters. </font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Cache
        Hit Ratio (%)&nbsp;&nbsp;&nbsp;</b>The percentage of
        requests that have been served by using cached data, out
        of the total number of requests to Web Proxy Server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Client
        Bytes Received/sec&nbsp;&nbsp;&nbsp;</b>The rate at which
        data bytes are received by Web Proxy Server from Web
        Proxy clients. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Client
        Bytes Sent/sec&nbsp;&nbsp;&nbsp;</b>The rate at which
        data bytes are sent by Web Proxy Server to the Web Proxy
        clients. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Client
        Bytes Total/sec&nbsp;&nbsp;&nbsp;</b>The sum of <b>Client
        Bytes Sent/sec</b> and <b>Client Bytes Received/sec.</b>
        This is the total rate of all bytes transferred between
        Web Proxy Server and Web Proxy clients. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Current
        Users&nbsp;&nbsp;&nbsp;</strong>The number of users
        currently connected to Web Proxy Server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>DNS
        Cache Entries&nbsp;&nbsp;&nbsp;</b>The current number of
        DNS domain name entries cached by Web Proxy Server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>DNS
        Cache Flushes&nbsp;&nbsp;&nbsp;</b>The total number of
        times that the DNS domain name cache has been flushed or
        cleared by Web Proxy Server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>DNS
        Cache Hits&nbsp;&nbsp;&nbsp;</b>The total number of times
        a DNS domain name was found within the DNS cache. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>DNS
        Cache Hits (%)&nbsp;&nbsp;&nbsp;</b>The percentage of DNS
        domain names served by the Web Proxy Server cache, out of
        the total of all DNS entries that have been retrieved by
        Web Proxy Server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>DNS
        Cache Retrievals&nbsp;&nbsp;&nbsp;</b>The total number of
        DNS domain names that have been retrieved by Web Proxy
        Server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>FTP
        Requests&nbsp;&nbsp;&nbsp;</b>The number of FTP requests
        that have been made to Web Proxy Server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Gopher
        Requests&nbsp;&nbsp;&nbsp;</b>The number of Gopher
        requests that have been made to Web Proxy Server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>HTTP
        Requests&nbsp;&nbsp;&nbsp;</b>The number of HTTP requests
        that have been made to Web Proxy Server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>HTTPS
        sessions&nbsp;&nbsp;&nbsp;</b>The total number of secure
        HTTP sessions serviced by the Secure Sockets Layer (SSL)
        tunnel. </font></p>
    </li>
</ul>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Inet
        Bytes Received/sec&nbsp;&nbsp;&nbsp;</b>The rate at which
        data bytes are received by Web Proxy Server from remote
        servers on the Internet. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Inet
        Bytes Sent/sec&nbsp;&nbsp;&nbsp;</b>The rate at which
        data bytes are sent by Web Proxy Server to remote servers
        on the Internet. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Inet
        Bytes Total/sec&nbsp;&nbsp;&nbsp;</b>The sum of <b>Inet
        Bytes Sent/sec</b> and <b>Inet Bytes Received/sec.</b>
        This is the total rate for all bytes transferred between
        Web Proxy Server and servers on the Internet. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Maximum
        Users&nbsp;&nbsp;&nbsp;</b>The maximum number of users
        that have connected to Web Proxy Server simultaneously. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Sites
        Denied&nbsp;&nbsp;&nbsp;</b>The total number of Internet
        sites to which Web Proxy Server has denied access. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Sites
        Granted&nbsp;&nbsp;&nbsp;</b>The total number of Internet
        sites to which Web Proxy Server has granted access. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>SNEWS
        Sessions&nbsp;&nbsp;&nbsp;</b>The total number of SNEWS
        sessions serviced by the Secure Sockets Layer (SSL)
        tunnel. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>SSL
        Client Bytes Received/sec&nbsp;&nbsp;&nbsp;</b>The rate
        at which that Secure Sockets Layer (SSL) data bytes are
        received by Web Proxy Server from secured Web Proxy
        clients. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>SSL
        Client Bytes Sent/sec&nbsp;&nbsp;&nbsp;</b>The rate at
        which Secure Sockets Layer (SSL) data bytes are sent by
        Proxy Server to secured Web Proxy clients. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>SSL
        Client Bytes Total/sec&nbsp;&nbsp;&nbsp;</b>The sum of <b>SSL
        Client Bytes Sent/sec </b>and<strong> </strong><b>SSL
        Client Bytes Received/sec</b>. This is the total rate for
        all bytes transferred between Web Proxy Server and
        secured Web Proxy clients. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>SSL
        Sessions Scavenged&nbsp;&nbsp;&nbsp;</b>The number of
        Secure Sockets Layer (SSL) sessions closed because of
        idle timeout and excessive SSL demand. </font></p>
    </li>
</ul>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Thread
        Pool Active Sessions&nbsp;&nbsp;&nbsp;</b>The number of
        sessions being actively serviced by thread pool threads. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Thread
        Pool Failures&nbsp;&nbsp;&nbsp;</b>The number of requests
        rejected because the thread pool was overcommitted. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Thread
        Pool Size&nbsp;&nbsp;&nbsp;</strong>The number of threads
        in the thread pool. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Total
        Cache Fetches&nbsp;&nbsp;&nbsp;</b>The total number of
        requests that have been served by using cached data from
        Web Proxy Server cache. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Total
        Failing Requests&nbsp;&nbsp;&nbsp;</strong>The total
        number of Internet service requests that have failed to
        be processed by Web Proxy Server due to errors. Errors
        can be the result of Web Proxy Server failing to locate a
        requested server URL on the Internet, or because of the
        client being denied access to the requested URL. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Total
        Internet Fetches&nbsp;&nbsp;&nbsp;</strong>The total
        number of requests that have been served by using data
        retrieved from servers on the Internet. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Total
        Requests&nbsp;&nbsp;&nbsp;</strong>The total number of
        Internet requests that have ever been made to Web Proxy
        Server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Total
        SSL Sessions&nbsp;&nbsp;&nbsp;</strong>The total number
        of Secure Sockets Layer (SSL) sessions serviced by the
        SSL tunnel. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Total
        Successful Requests&nbsp;&nbsp;&nbsp;</strong>The total
        number of Internet requests that have been successfully
        processed by Web Proxy Server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Total
        Users&nbsp;&nbsp;&nbsp;</strong>The total number of users
        that have ever connected to Web Proxy Server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>Unknown
        SSL Sessions&nbsp;&nbsp;&nbsp;</strong>The total number
        of unknown Secure Sockets Layer (SSL) sessions serviced
        by the SSL tunnel.<br>
        <br>
        </font></p>
    </li>
</ul>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="953h3"><font size="2"
face="Verdana, Arial, Helvetica">WinSock Proxy Server Counters</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">The counters in the <b>WinSock
Proxy Server</b> object provide statistics about the WinSock
Proxy service. The following list describes those counters. </font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Accepting
        TCP Connections&nbsp;&nbsp;&nbsp;</b>The number of
        connection objects that wait for TCP connection from the
        client after a successful remote connection. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Active
        Sessions&nbsp;&nbsp;&nbsp;</b>The number of active
        sessions. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Active
        TCP Connections&nbsp;&nbsp;&nbsp;</b>The number of active
        TCP connections. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Active
        UDP Connections&nbsp;&nbsp;&nbsp;</b>Total number of
        active UDP connections. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Available
        Control Worker Threads&nbsp;&nbsp;&nbsp;</b>The number of
        control channel worker threads that are available or
        waiting in the completion port queue. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Available
        Data Worker Threads&nbsp;&nbsp;&nbsp;</b>The number of
        data-pump worker threads that are available or waiting in
        the completion port queue. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Back-Connecting
        TCP Connections&nbsp;&nbsp;&nbsp;</b>Total number of
        connections that are waiting for an inbound <code>connect
        ()</code> call to finish. These are connections from the
        WinSock Proxy service to a client after the WinSock Proxy
        service accepted a connection from the Internet on a
        listening socket. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Bytes
        Read/sec&nbsp;&nbsp;&nbsp;</b>Number of bytes read by the
        data-pump per second. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Bytes
        Written/sec&nbsp;&nbsp;&nbsp;</b>Number of bytes written
        by the data-pump per second. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Connecting
        TCP Connections&nbsp;&nbsp;&nbsp;</b>Total number of
        connections that are waiting for a remote <code>connect()</code>
        call to finish. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Control
        Worker Threads&nbsp;&nbsp;&nbsp;</b>The number of control
        channel worker threads that are alive. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Data
        Worker Threads&nbsp;&nbsp;&nbsp;</b>The number of
        data-pump worker threads that are alive. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Failed
        GetXByY&nbsp;&nbsp;&nbsp;</b>Number of calls to <b>gethostname/gethostbyaddr</b>
        that have failed. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Listening
        TCP Connections&nbsp;&nbsp;&nbsp;</b>Number of connection
        objects that wait for TCP connections from the Internet
        (after a successful listen). </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Non-connected
        UDP mappings&nbsp;&nbsp;&nbsp;</b>The number of mappings
        for UDP connections. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><b>Pending
        GetXByY&nbsp;&nbsp;&nbsp;</b>Number of calls to <b>gethostname/gethostbyaddr</b>
        that have not yet returned </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><b>Successful
        GetXByY&nbsp;&nbsp;&nbsp;</b>Number of calls to <b>gethostname/gethostbyaddr</b>
        that have returned successfully. </font></li>
</ul>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="3h1"><font size="2"
face="Verdana, Arial, Helvetica">SNMP MIBs</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">If you monitor your
network using Simple Network Management Protocol (SNMP) software,
you can use the SNMP Management Information Base (MIB) files
provided with Microsoft Proxy server to enable SNMP monitoring of
the Web Proxy and WinSock Proxy services. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The MIB file for Web
Proxy service monitoring is W3p.mib. The MIB file for WinSock
Proxy Service monitoring is Wsp.mib. These files are not
installed on the server by the Setup program. They are on the
Microsoft Proxy Server compact disc, and can be copied from the
Perfctrs directory in the appropriate processor architecture
directory (Alpha\Perfctrs for Alpha AXP, I386\Perfctrs for Intel,
Mips\Perfctrs for MIPS, and Ppc\Perfctrs for PowerPC). Be sure to
use the correct MIB file for the server&#146;s processor
architecture.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">To use these MIB files
with the Windows&nbsp;NT SNMP service, you must first compile
them by using the MIB compiler that comes with your SNMP
software. If you are using the Microsoft Software Development Kit
(SDK), you can use the MIB compiler tool, Mibcc.exe, which is
included to compile MIB files. For more information on compiling
MIB files with this tool, see your Microsoft SDK documentation.
For other MIB compiling tools, see the documentation for the
product.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The SNMP service uses
Object Identifiers (OIDs) for MIB processing. The OID for the
W3p.mib is 11. The OID for the Wsp.mib is 12. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">In addition to
compiling the MIB files, you must also start the Web Proxy
service and the WinSock Proxy service before configuring and
starting the Windows&nbsp;NT SNMP service on the computer running
Microsoft Proxy Server. Once the SNMP service has been started on
both the remote SNMP monitoring computer and the local Microsoft
Proxy Server computer, you can use your SNMP monitoring software
to monitor Microsoft Proxy Server services. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica"><b>Note</b>&nbsp;&nbsp;&nbsp;Using
SNMP on a gateway that is not secure can expose network routing
information to unauthorized users. </font></p>

<hr>


<p align="center"><font size="2" face="Verdana, Arial, Helvetica"><i>©
1996 by Microsoft Corporation. All rights reserved.</i> </font></p>
</FONT>
</FONT>
</BODY>
</html>
