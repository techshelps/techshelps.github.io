<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<HEAD>
<meta name="PREMIUM" content="MSDN">
<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">
<meta name="MS.LOCALE" content="EN-US">
<meta name="DESCRIPTION" content="This page is from the Microsoft Proxy Server book, found in the Tools and Technologies Section in the MSDN Library">



<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CHAPTER 5, Server Administration</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>


<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>


<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<p align="left"><a name="Top"><font size="2"
face="Verdana, Arial, Helvetica"><img src="onepix.gif" alt="Space"
align="top" width="1" height="1"></font></a></p>

<hr>

<h1><a name="ServerAdministration"><font size="6"
face="Verdana, Arial, Helvetica">Server Administration</font></a></h1>

<blockquote>
    <p><a href="#2h1"><font size="2" face="Verdana, Arial, Helvetica">Server
    Administration Overview</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#3h1"><font size="2" face="Verdana, Arial, Helvetica">Using
    Internet Service Manager</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#4h1"><font size="2" face="Verdana, Arial, Helvetica">Putting
    Users in Windows&nbsp;NT Groups</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#6h1"><font size="2" face="Verdana, Arial, Helvetica">Network
    Configuration</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    <a href="#7h1">LAT Configuration</a><br>
    </font><font size="2" face="Verdana, Arial, Helvetica"><a href="#9h1">Dial-Up
    Support</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
    </font><font size="2" face="Verdana, Arial, Helvetica"><a href="#8h1">Other
    Server Configuration Issues</font></a></p>
</blockquote>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="2h1"><font size="2"
face="Verdana, Arial, Helvetica">Server Administration Overview</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">Microsoft Proxy Server
can be administered by using administrative tools provided with
the product. It also interacts closely with Internet Information
Server (IIS) and Windows&nbsp;NT Server settings. Together, using
the tools provided with each of these Microsoft server products,
you can develop an appropriate administrative configuration for
Microsoft Proxy Server on your private network.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">This chapter covers the
following topics, which discuss how to administer Microsoft Proxy
Server, as well as further considerations for administering the
server to operate appropriately with other services on your
network.</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Using
        Internet Service Manager </strong></font><p><font
        size="2" face="Verdana, Arial, Helvetica">Internet Service Manager
        is an administrative tool provided by IIS. Internet
        Service Manager can be used to administer properties for
        two services provided by Microsoft Proxy Server: the Web
        Proxy and WinSock Proxy services. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Putting
        users in Windows&nbsp;NT groups</strong></font><p><font
        size="2" face="Verdana, Arial, Helvetica">For administering access
        to Web Proxy and WinSock Proxy services, it is
        recommended that you add users to groups, and then assign
        permissions to those groups. By using group assignments,
        you can simplify the administrative tasks needed to grant
        or revoke user permissions for Microsoft Proxy Server. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Considerations
        for configuring Microsoft Proxy Server on your network</strong></font><p><font
        size="2" face="Verdana, Arial, Helvetica">A number of
        considerations can affect how you choose to configure or
        install Microsoft Proxy Server on your private network.
        Configuring server network adapter cards and TCP/IP ports
        correctly is an important consideration. Also, for
        networks that use other TCP/IP services such as DNS,
        WINS, DHCP, or multiple gateways, further considerations
        apply when using Microsoft Proxy Server on your network. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Configuring
        the LAT</strong></font><p><font size="2"
        face="Verdana, Arial, Helvetica">The Local Address Table (LAT) is
        used by Microsoft Proxy Server to define your private
        network. It is used actively by both the Web Proxy and
        WinSock Proxy services when processing client requests.
        Because the LAT is a critical component for correct
        functioning of the proxy service, any discrepancies
        between addresses recorded in the LAT and the actual
        addresses used on your network must be monitored and
        corrected as they occur. You can modify or replace the
        LAT that is stored on the server as necessary. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Configuring
        dial-out support</strong> </font><p><font size="2"
        face="Verdana, Arial, Helvetica">On-demand dial-out is a supported
        feature of Microsoft Proxy Server. Dial-out uses a Remote
        Access Service (RAS) compatible tool that supports RAS
        phone book entries. These entries can be used to schedule
        automated dial-out connections to the Internet through
        your Internet service provider. </font></p>
    </li>
</ul>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="3h1"><font size="2"
face="Verdana, Arial, Helvetica">Using Internet Service Manager</font></a></h1>

<p><font size="2" face="Verdana, Arial, Helvetica">Use Internet Service
Manager, provided with Microsoft Internet Information Server, to
administer the Microsoft Proxy Server services. </font></p>

<h4><a
name="ToconfigureMicrosoftProxyServerserviceswithInternetServiceManager"><font
size="2" face="Verdana, Arial, Helvetica"><b>To configure Microsoft Proxy
Server services with Internet Service Manager</b></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <b>Start</b>,
        select <b>Programs</b>, select <b>Microsoft Proxy Server</b>,
        and click <b>Internet Service Manager</b>.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <strong>Microsoft
        Internet Service Manager</strong> window is displayed.
        All installed Internet services for the current server
        are listed. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">If
        you will be managing a remote server, connect to that
        server. </font></p>
        <ul>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">To connect to a specific
                server, from the <strong>Properties</strong> menu
                click <strong>Connect to Server</strong> and
                complete the <strong>Connect to Server</strong>
                dialog box that appears. </font></p>
            </li>
            <li><font size="2" face="Verdana, Arial, Helvetica">To connect
                to all Microsoft Proxy Servers on your network,
                from the <strong>Properties</strong> menu click <strong>Find
                All Servers</strong>.</font><p><font size="2"
                face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;The
                WinSock Proxy service on other server computers
                is not detected when <strong>Find All Servers</strong>
                is used. To connect to WinSock Proxy service for
                different computers, use <strong>Connect to
                Server</strong> and specify the server name for
                connection. </font></p>
            </li>
        </ul>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">To
        administer a server&#146;s Internet service, double-click
        the computer name next to the service name. </font></p>
        <ul>
            <li><font size="2" face="Verdana, Arial, Helvetica">To
                administer a server&#146;s <strong>Web Proxy</strong>
                service, double-click the computer name next to
                that service.</font></li>
            <li><font size="2" face="Verdana, Arial, Helvetica">To
                administer a server&#146;s <strong>WinSock Proxy</strong>
                service, double-click the computer name next to
                that service.</font></li>
        </ul>
        <p><font size="2" face="Verdana, Arial, Helvetica">The <strong>Service
        Properties</strong> window for the selected service
        appears. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Use the <strong>Service
        Properties</strong> window to configure the service. </font><p><font
        size="2" face="Verdana, Arial, Helvetica">For more information
        about administering the Microsoft Proxy Server services,
        see </font><a href="06_msp.htm#Top"><font size="2"
        face="Verdana, Arial, Helvetica">&#147;Configuring
        the Web Proxy Service,&#148;</font></a><font size="2"
        face="Verdana, Arial, Helvetica"> and </font><a
        href="07_msp.htm#Top"><font size="2"
        face="Verdana, Arial, Helvetica">&#147;Configuring
        the WinSock Proxy Service.&#148;</font></a><font size="2"
        face="Verdana, Arial, Helvetica"> </font></p>
    </li>
</ol>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="4h1"><font size="2"
face="Verdana, Arial, Helvetica">Putting Users in Windows&nbsp;NT Groups</font></a></h1>

<blockquote>
    <p><a href="#16h2"><font size="2" face="Verdana, Arial, Helvetica">Considerations
    For Planning Windows&nbsp;NT Groups</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#17h2"><font size="2" face="Verdana, Arial, Helvetica">Creating
    New Groups For Proxy Users</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#18h2"><font size="2" face="Verdana, Arial, Helvetica">Assigning
    Groups to Service Permissions</font></a></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="16h2"><font size="2"
face="Verdana, Arial, Helvetica">Considerations For Planning
Windows&nbsp;NT Groups</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">The Microsoft Proxy
Server allows several possibilities for assigning permission
rights for users to the Web Proxy and WinSock Proxy services.
These permissions can be configured or enabled by using the
Internet Service Manager. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For each of the service
options that allow user permissions to be assigned, it is
recommended that you create and use groups of users to simplify
management of permissions for each user. You can use User Manager
for Domains to create groups, which can be local groups on the
server, or groups on the domain. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">By separating your
users into groups, you can simplify the process of modifying,
adding, and removing user permissions Microsoft Proxy Server as
your network service needs change. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The following are some
guidelines for how to simplify managing user permissions for
Microsoft Proxy Server by creating new local groups for this
purpose.</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">Determine the
        default proxy services that will be needed by all (or the
        majority) of your users.</font><p><font size="2"
        face="Verdana, Arial, Helvetica">For example, if you have a very
        small network, you could decide to manage all proxy users
        within a single group. This group could then be granted
        all Web Proxy and WinSock Proxy service permissions you
        choose to enable. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Determine any
        special cases for proxy users who need special
        permissions for selected services.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">If your network has more
        than a few users, you might want to create separate
        permissions for some services on your network. To do
        this, you can create additional user groups so that you
        can limit these special permissions to only a certain
        group of proxy users. </font></p>
    </li>
</ul>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="17h2"><font size="2"
face="Verdana, Arial, Helvetica">Creating New Groups For Proxy Users</font></a></h2>

<h4><a
name="ToadministerusersandgroupsbyusingUserManagerforDomains"><font
size="2" face="Verdana, Arial, Helvetica"><strong>To administer users and
groups by using User Manager for Domains</strong></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the desktop, click <strong>Start, </strong>select <strong>Programs</strong>,
        and then select <strong>Administrative Tools (Common)</strong>.
        </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        <strong>User Manager for Domains</strong>. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Connect
        to the domain or server to be administered. </font></p>
        <p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the <strong>User</strong> menu choose <strong>Select
        Domain</strong> and complete the <strong>Select Domain </strong>dialog
        box that appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">As
        necessary add users and groups, and add users to groups. </font></p>
    </li>
</ol>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">For instructions
    see the online Help for User Manager for Domains. Also see
    your documentation for Windows&nbsp;NT. </font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">For further examples of
how to use groups effectively to restrict access permissions on
your internal network using groups, see </font><a
href="09_msp.htm"><font size="2" face="Verdana, Arial, Helvetica">
&#147;Security.&#148;</font></a></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="18h2"><font size="2"
face="Verdana, Arial, Helvetica">Assigning Groups to Service Permissions</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Once groups have been
created, you can use Internet Service Manager to assign
appropriate service permissions to each of the new groups.</font></p>

<h4><a
name="ToassignpermissionsforWebProxyorWinSockProxyservices"><font
size="2" face="Verdana, Arial, Helvetica"><strong>To assign permissions
for Web Proxy or WinSock Proxy services</strong></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From Internet
        Service Manager, double-click the computer name next to
        the Web Proxy or WinSock Proxy service.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">The <strong>Service
        Properties</strong> window for that service is displayed.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <strong>Permissions</strong>
        tab.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select a protocol,
        and grant or revoke permissions for groups or users to
        use that protocol.</font><p><font size="2"
        face="Verdana, Arial, Helvetica">For more information about
        administering service permissions, see </font><a
        href="06_msp.htm#Top"><font size="2"
        face="Verdana, Arial, Helvetica">&#147;Configuring
        the Web Proxy Service,&#148;</font></a><font size="2"
        face="Verdana, Arial, Helvetica"> and </font><a
        href="07_msp.htm#Top"><font size="2"
        face="Verdana, Arial, Helvetica">&#147;Configuring
        the WinSock Proxy Service.&#148;</font></a><font size="2"
        face="Verdana, Arial, Helvetica"> </font></p>
    </li>
</ol>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="6h1"><font size="2"
face="Verdana, Arial, Helvetica">Network Configuration</font></a></h1>

<blockquote>
    <p><a href="#13h2"><font size="2" face="Verdana, Arial, Helvetica">Setting
    up Network Adapter Cards</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#1h2"><font size="2" face="Verdana, Arial, Helvetica">Using
    TCP/IP Ports </font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#8888h2"><font size="2"
    face="Verdana, Arial, Helvetica">Using DNS, WINS, and DHCP with
    Microsoft Proxy Server</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#3h2"><font size="2" face="Verdana, Arial, Helvetica">Using
    Multiple Microsoft Proxy Server Gateways</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#2h2"><font size="2" face="Verdana, Arial, Helvetica">More
    About DNS, WINS, and DHCP</font></a></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="13h2"><font size="2"
face="Verdana, Arial, Helvetica">Setting up Network Adapter Cards</font></a></h2>

<blockquote>
    <p><a href="#19h3"><font size="2" face="Verdana, Arial, Helvetica">Setup
    Considerations When Using Two Adapters</font></a><a
    href="#16h3"><font size="2" face="Verdana, Arial, Helvetica"><br>
    Configuring the External Network Adapter Card<br>
    </font></a><a href="#18h3"><font size="2"
    face="Verdana, Arial, Helvetica">Configuring the Internal Network
    Adapter Card</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#15h3"><font size="2" face="Verdana, Arial, Helvetica">Setup
    Considerations When Using a Single Adapter</font></a></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">The following section
outlines some considerations to be followed when installing
network adapter cards for use with Microsoft Proxy Server. In
most installations, two network adapter cards will need to be
installed on the server; one network adapter card for connecting
to the internal private network, and the other adapter card to be
used for external connection to the Internet or another external
network. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">In some circumstances,
Microsoft Proxy Server may also be used with only a single
adapter card as a way to provide limited use for caching services
on a local network. When only one server adapter card is
installed, gateway services are not in effect and the server can
be configured similarly to other internal servers or clients on
your network.</font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="19h3"><font size="2"
face="Verdana, Arial, Helvetica">Setup Considerations When Using Two
Adapters</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">When setting up two
network adapter cards for gateway operation, first install both
network adapter cards in the server computer. Comply with any
special manufacturer instructions for configuring the multiple
network adapters for use in the same computer.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">In most cases, device
conflicts are possible where hardware settings are preconfigured
for memory base I/O addresses or IRQ levels on each of the
adapter cards. Check that base I/O and IRQ settings are set
differently for each card and use settings that do not conflict
with other devices that are currently installed on your system. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Make note of the
configured settings used for each network adapter card as the
card is installed and update these notes if changes are made
while you are installing. Keeping notes can help reduce the
amount of time required to troubleshoot any hardware device
conflicts later.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Verify that both
adapter cards are installed and configured correctly by using the
<strong>Adapters</strong> property sheet in the Network
application of Control Panel. Check for unique I/O base address
and IRQ values for each adapter. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Tip</strong>&nbsp;&nbsp;&nbsp;If
the hardware description for both server adapter cards is
identical, it may be confusing to keep track of which adapter you
are configuring. Windows&nbsp;NT identifies each adapter added to
the system with a leading number, such as [1] for the first
adapter installed and [2] for the second adapter installed. Refer
to these numbers when you are attempting to verify or change
settings for a specific hardware adapter. </font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="16h3"><font size="2"
face="Verdana, Arial, Helvetica">Configuring the External Network Adapter
Card</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">The following
considerations must be complied with when setting up the network
adapter card that will be connected to the Internet.</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">Set protocol
        bindings appropriately for the external adapter card.
        This is done by using the Bindings property sheet in the
        Network application of Control Panel.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">Disable bindings for <strong>SMB
        Server, NWLink IPX/SPX Compatible Transport</strong>, <strong>WINS
        Client (TCP/IP)</strong>, and the <strong>NetBEUI
        Protocol</strong>. For the <strong>WINS Client</strong>
        listing, disable bindings for all interfaces (Server,
        Workstation and NetBIOS interface). The only binding to
        be enabled for the external network adapter card should
        be <strong>TCP/IP Protocol</strong>. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Verify TCP/IP
        properties are configured properly for the external
        adapter card. This can be done from the Protocols
        property sheet in the Network application of Control
        Panel. </font><p><font size="2" face="Verdana, Arial, Helvetica">For
        external TCP/IP connection to the Internet, you should
        check with your Internet Service Provider (ISP) to obtain
        correct information to enter for TCP/IP settings. In
        particular, you will need to know the IP address, subnet
        mask, default gateway, Domain Name System (DNS) domain
        name, and IP addresses for DNS servers to be used in DNS
        name searches. In some cases, your ISP may be using
        dynamic host configuration protocol (DHCP) or Bootstrap
        Protocol (BOOTP) to enable dynamic assignment of client
        addresses. Contact your ISP for further information about
        configuring the external adapter card where these
        services are active. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Perform initial
        communications testing for the external network adapter
        card. </font><p><font size="2" face="Verdana, Arial, Helvetica">Use
        the Ping.exe (or similar utilities) provided with
        Windows&nbsp;NT and Windows&nbsp;95 on another internal
        IP client computer to verify the server external adapter
        card is set correctly. You will need to use another
        computer located on the external segment when using Ping
        or other echo-reply type testing. <br>
        <br>
        </font></p>
    </li>
</ul>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="18h3"><font size="2"
face="Verdana, Arial, Helvetica">Configuring the Internal Network Adapter
Card</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">The following process
details considerations for setting up the network adapter card
that will be used to connect Microsoft Proxy Server internally to
your private network.</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">Set protocol
        bindings appropriately for each network adapter card.
        This is done using the Bindings property sheet in the
        Network application of Control Panel.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">Disable any bindings
        that are not needed or currently used on your internal
        network, such as <strong>NetBEUI Protocol </strong>or <strong>WINS
        Client (TCP/IP)</strong>. You must enable bindings for
        either <strong>NWLink IPX/SPX Compatible Transport</strong>,
        or<strong> TCP/IP Protocol</strong> on this adapter card.
        </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Verify that NWLink
        IPX/SPX Compatible Transport and/or TCP/IP Protocol are
        installed and properties configured properly. This can be
        done from the Protocols property sheet in the Network
        application of Control Panel. </font><p><font size="2"
        face="Verdana, Arial, Helvetica">For NWLink IPX/SPX Compatible
        Transport protocol properties on the internal network
        adapter, enter the same network number for Internal
        Network Number that is used by other Novell-based servers
        and clients on your private network. In most cases, you
        can use Auto Frame Type Detection to have Windows&nbsp;NT
        automatically detect the correct frame type that is in
        use on your internal network. In some cases, you may need
        to enter the frame type manually by using Manual Frame
        Type Detection. If you manually enter a frame type, be
        sure it is the same frame type supported by other
        Novell-based servers and clients on your network. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">If your private
        network uses RIP/SAP routing internally, you may also
        choose to enable RIP routing on the Routing tab as well.
        (Because RIP routing adds a considerable amount of
        traffic to your network, enable this only where it is
        needed for devices to communicate on your network.) </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">Although TCP/IP
        Protocol Properties must be set for both network adapter
        cards, for internal TCP/IP connection, <em>all address
        settings should be specified manually</em>. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">Do not use the <strong>Obtain
        an IP address from a DHCP server </strong>option for
        obtaining an IP address for use on the internal network.
        In particular, you should enter a permanent reserved IP
        address for the Microsoft Proxy Server and an appropriate
        subnet mask for your local network. Also, do not enter an
        address for <strong>Default Gateway</strong> for the
        internal network adapter<em>.</em> </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;If
        your private network uses DNS, Windows Internet Name
        Service (WINS), or DHCP services, you will need to
        consider how to configure the internal network adapter
        for the Microsoft Proxy Server to work with these
        services. For more information on using Microsoft Proxy
        Server with DNS, WINS, or DHCP services, see the </font><a
        href="#8888h2"><font size="2" face="Verdana, Arial, Helvetica">&#147;Using
        DNS, WINS, and DHCP Services&#148; </font></a><font
        size="2" face="Verdana, Arial, Helvetica">section later in this
        chapter. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Perform
        initial communications testing for both server network
        adapter cards. </strong></font><p><font size="2"
        face="Verdana, Arial, Helvetica">Use the Ping.exe (or similar
        utilities) provided with Windows&nbsp;NT and
        Windows&nbsp;95 on another internal IP client computer to
        verify the server internal adapter card is set correctly.
        Also, if you are using IPX/SPX exclusively on your
        internal network, you can use an IPX-based utility that
        does pinging or echo-reply type testing. <br>
        <br>
        </font></p>
    </li>
</ul>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="15h3"><font size="2"
face="Verdana, Arial, Helvetica">Setup Considerations When Using a Single
Adapter</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">In some cases, the
Microsoft Proxy Server can be used with a single network adapter
on a private network. In this type of installation, no gateway
services for Internet access are configured and the Microsoft
Proxy Server is used primarily to provide a document caching
service for local network users. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For configuring a
Microsoft Proxy Server for a single network adapter connection to
the internal network, you can use IP and DNS settings that are
appropriate for servers and clients on your local TCP/IP network.
There are no special considerations for TCP/IP network settings
for this type of installation.</font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="1h2"><font size="2"
face="Verdana, Arial, Helvetica">Using TCP/IP Ports</font></a></h2>

<blockquote>
    <p><a href="#12h3"><font size="2" face="Verdana, Arial, Helvetica">What
    are TCP/IP ports?</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#13h3"><font size="2" face="Verdana, Arial, Helvetica">Setting
    WinSock Proxy Port Permissions</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#14h3"><font size="2" face="Verdana, Arial, Helvetica">Advanced
    TCP/IP Security with Windows&nbsp;NT</font></a></p>
</blockquote>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="12h3"><font size="2"
face="Verdana, Arial, Helvetica">What are TCP/IP ports?</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">Ports are used in
TCP/IP to name the ends of logical connections that carry
long-term conversations. A port is an abstraction to allow
transport protocols such as User Datagram Protocol (UDP) and
Transmission Control Protocol (TCP) the capability of handling
communications between multiple hosts. It allows a communication
to be uniquely identified. The WinSock Proxy service uses ports
extensively to provide a way of redirecting applications.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For the purpose of
providing services to unknown callers, a service contact port is
defined. Each WinSock Proxy-enabled application specifies a port
to be used as the contact port on the server for TCP or UDP. The
contact port is sometimes called the &#147;well-known port.&#148;
To some extent, these same port assignments are used with UDP. In
order to use UDP, the application must supply the IP address and
port number of the destination application. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Ports are identified by
a positive integer. Originally, the assigned ports available were
in the range 0 &#150; 255. Currently, the range for assigned
ports has been expanded to the range allow 4-digit port numbers
up to 9999. The assigned ports use a small portion of the range
of possible port numbers, allowing other unassigned port numbers
to be designated as alternatives if the initial port is not
available or to be used for new custom server applications.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Ports can be designated
to use either TCP or UDP as the transport-level protocol
specifying how ports send and receive data. In addition, port
assignments are enabled separately for inbound ports and outbound
ports on Microsoft Proxy Server. Inbound ports are used to listen
for client requests from Internet clients, and outbound ports are
used to listen for requests from clients on the internal private
network. </font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="13h3"><font size="2"
face="Verdana, Arial, Helvetica">Setting WinSock Proxy Port Permissions</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">The Microsoft Proxy
Server uses application service ports for the WinSock Proxy
service. In order for each Windows Sockets-based application to
work through a network connection, ports are used in combination
with IP addressing to form a &#147;socketed&#148; connection. For
information on how Windows Sockets works, see </font><a
href="dd_msp.htm#Top"><font size="2" face="Verdana, Arial, Helvetica">Appendix
D, &#147;Architecture.&#148;</font></a></p>

<p><font size="2" face="Verdana, Arial, Helvetica">When ports are defined
for the WinSock Proxy service, port permissions can be assigned
to users for each application defined on the Microsoft Proxy
Server gateway. For example, VDOLive is a supported application
for the WinSock Proxy service. It uses outbound TCP port 7000 and
inbound UDP port 0 as its &#147;well-known ports&#148; for
defining service on the Microsoft Proxy Server. Users can then be
granted permission to use VDOLive with WinSock Proxy. Once
permissions are granted by using the Permissions property sheet
in WinSock Proxy Properties, users have access to those ports
(both inbound and outbound) that are assigned.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">If you want to enable
access to inbound and outbound service ports separately for users
on your network, you can create additional protocol definitions
in WinSock Proxy service properties for that purpose. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For example, suppose
you wanted to permit both outbound and inbound port access for
FTP service to all internal users on your network, but allow only
inbound FTP logon for a single Internet client user called
FTPClient1.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">In this example, you
might use the predefined protocol, FTP, and assign all of the
internal users permissions to this protocol because it enables
inbound and outbound port access. Then, to allow only inbound
port access for the FTPClient1 user account <em>only</em>, you
could create a new protocol definition called &#147;FTP (inbound
only)&#148; and define only the inbound TCP port 0 for it. The
FTPClient1 account could then be assigned permissions to the
&#147;FTP (inbound only)&#148; protocol permissions list.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For more information on
how to add WinSock Proxy protocol definitions and set access
permissions, see </font><a href="07_msp.htm"><font size="2"
face="Verdana, Arial, Helvetica">&#147;Configuring the
WinSock Proxy Service.&#148;</font></a></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="14h3"><font size="2"
face="Verdana, Arial, Helvetica">Advanced TCP/IP Security with
Windows&nbsp;NT</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">In addition to
port-access permissions and protocol definitions created by using
the Microsoft Proxy Server properties, Windows&nbsp;NT Server 4.0
provides additional settings for advanced TCP/IP security. This
feature can be useful in instances where you want to selectively
enable and disable TCP/IP ports or protocols globally for all
users of that server on your network. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Some examples of cases
where this feature might be useful include the following
scenarios: </font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">You
        are conducting testing of a new application that uses UDP
        ports on your local network. While testing is occurring,
        you need a way to quickly enable and disable selected UDP
        ports on your computer running Microsoft Proxy Server. In
        this case, you could remove and recreate user permission
        assignments or UDP protocol service definitions by using
        the Web Proxy and WinSock Proxy service properties, but
        these steps become much too involved to be repeated
        numerous times. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">You are setting up
        a firewall server on your private network to the
        Internet. For this purpose, you want to thoroughly limit
        all default enabling of TCP ports, UDP ports, and IP
        Protocols on the computer running Windows&nbsp;NT Server.<br>
        <br>
        </font></li>
</ul>

<h4><a name="ToenableadvancedTCP/IPsecuritywithWindows&nbsp;NT"><font
size="2" face="Verdana, Arial, Helvetica"><strong>To enable advanced
TCP/IP security with Windows&nbsp;NT </strong></font></a></h4>

<ol>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the desktop, click the <strong>Start</strong> button. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Select
        <strong>Settings</strong> and click <strong>Control Panel</strong>.
        </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Double-click the <strong>Network</strong>
        icon.</font><p><font size="2" face="Verdana, Arial, Helvetica">The
        <strong>Network</strong> properties window is displayed. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        the <strong>Protocols</strong> tab. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select the <strong>TCP/IP
        Protocol</strong>. Click <strong>Properties</strong>.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <strong>Microsoft
        TCP/IP Properties</strong> sheet is displayed. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Advanced</strong>.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <strong>Advanced IP
        Addressing</strong> property sheet is displayed. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select the <strong>Enable
        Security</strong> option.</font><p><font size="2"
        face="Verdana, Arial, Helvetica">The <strong>Configure</strong>
        button located beneath <strong>Enable Security</strong>
        is enabled. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Configure</strong>.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <strong>TCP/IP
        Security</strong> dialog box is displayed. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select <strong>Permit
        Only</strong> for one of the three listed options
        available (<strong>TCP Ports, UDP Ports, IP Protocols</strong>).</font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <strong>Add</strong>
        button is enabled. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Enable
        ports or protocols. </font></p>
        <ul>
            <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Add</strong>.
                The <strong>Security Add </strong>dialog box is
                displayed. </font></li>
            <li><font size="2" face="Verdana, Arial, Helvetica">Enter a
                port or protocol number for the option you are
                specifying permissions for. </font></li>
            <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Add</strong>
                in the <strong>Security Add</strong> dialog box
                after entering a port or protocol number. The
                port or protocol number appears in the<strong>
                Permit Only</strong> list in the<strong> TCP/IP
                Security</strong> property sheet. </font></li>
        </ul>
        <p><font size="2" face="Verdana, Arial, Helvetica">Repeat this
        step for all ports or protocols that require enabling. </font></p>
    </li>
</ol>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="8888h2"><font size="2"
face="Verdana, Arial, Helvetica">Using DNS, WINS and DHCP with Microsoft
Proxy Server</font></a></h2>

<blockquote>
    <p><a href="#9h3"><font size="2" face="Verdana, Arial, Helvetica">Considerations
    for Using DNS</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#10h3"><font size="2" face="Verdana, Arial, Helvetica">Considerations
    for Using WINS</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#11h3"><font size="2" face="Verdana, Arial, Helvetica">Considerations
    for Using DHCP</font></a></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">The following section
details further considerations for using the Microsoft Proxy
Server with DNS, WINS, or DHCP services on your private network.
For an overview of these services, see </font><a href="#2h2"><font
size="2" face="Verdana, Arial, Helvetica">More About DNS, WINS, and DHCP,</font></a><font
size="2" face="Verdana, Arial, Helvetica"> later in this chapter.</font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="9h3"><font size="2"
face="Verdana, Arial, Helvetica">Considerations for Using DNS</font></a></h3>

<blockquote>
    <p><a href="#h404"><font size="2" face="Verdana, Arial, Helvetica">Microsoft
    Proxy Server as a DNS Server</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#h405"><font size="2" face="Verdana, Arial, Helvetica">Microsoft
    Proxy Server as DNS Client</font></a></p>
</blockquote>

<h4><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="h404"><font size="2"
face="Verdana, Arial, Helvetica">Microsoft Proxy Server as a DNS Server</font></a></h4>

<p><font size="2" face="Verdana, Arial, Helvetica">When DNS services are
used on the internal network, a computer running Windows&nbsp;NT
Server and Microsoft Proxy Server can also be used as a DNS
server for the internal network. The internal server adapter card
must use static IP addressing (a permanent address on the local
network) and no default gateway should be specified. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">If you use the same
server for Internet gateway access with Microsoft Proxy Server
and for DNS servicing, be sure that the Windows&nbsp;NT DNS
service and all internal hosts file information is accessible
only to internal network clients. Set file system security
appropriately to deny Internet users access, and disable <strong>DNS
Server</strong> for the external network adapter.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For more information on
configuring Windows&nbsp;NT Server for use as a DNS server, see
your documentation for Windows&nbsp;NT Server.</font></p>

<h4><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="h405"><font size="2"
face="Verdana, Arial, Helvetica">Microsoft Proxy Server as a DNS Client</font></a></h4>

<p><font size="2" face="Verdana, Arial, Helvetica">There are no special
considerations for Microsoft Proxy Server as a DNS client on the
internal network. This is a recommended configuration for
networks already using DNS service. Also, a HOSTS file can be
used as an alternative when no DNS services are available on the
internal network.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For more information on
configuring Windows&nbsp;NT Server for use as a DNS client, see
your documentation for Windows&nbsp;NT Server.</font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="10h3"><font size="2"
face="Verdana, Arial, Helvetica">Considerations for Using WINS</font></a></h3>

<blockquote>
    <p><a href="#h406"><font size="2" face="Verdana, Arial, Helvetica">Microsoft
    Proxy Server as a WINS Server</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#h407"><font size="2" face="Verdana, Arial, Helvetica">Microsoft
    Proxy Server as a WINS Client</font></a></p>
</blockquote>

<h4><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="h406"><font size="2"
face="Verdana, Arial, Helvetica">Microsoft Proxy Server as a WINS Server</font></a></h4>

<p><font size="2" face="Verdana, Arial, Helvetica">When WINS services are
used on the internal network, the computer running Microsoft
Proxy Server can also be used as a WINS server. The internal
server adapter card must use a permanent IP address on the local
network, with no default gateway specified. To be sure that the
internal WINS database information cannot be seen by Internet
users, deny these users file access to WINS service and LMHOSTS
files and disable all WINS services for the external network
adapter.</font></p>

<h4><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="h407"><font size="2"
face="Verdana, Arial, Helvetica">Microsoft Proxy Server as a WINS Client</font></a></h4>

<p><font size="2" face="Verdana, Arial, Helvetica">There are no special
considerations for Microsoft Proxy Server as a WINS client on the
internal network. This is a recommended configuration for
networks already using WINS service. Also, an LMHOSTS file can be
used as a WINS alternative when no WINS services are available on
the internal network.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For more information on
configuring Windows&nbsp;NT Server for use as either a WINS
server or a WINS client, see your documentation for
Windows&nbsp;NT Server.</font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="11h3"><font size="2"
face="Verdana, Arial, Helvetica">Considerations for Using DHCP</font></a></h3>

<blockquote>
    <p><a href="#h401"><font size="2" face="Verdana, Arial, Helvetica">Microsoft
    Proxy Server as a DHCP Server<br>
    </font></a><a href="#h402"><font size="2"
    face="Verdana, Arial, Helvetica">Microsoft Proxy Server as a DHCP
    Client<br>
    </font></a><a href="#h403"><font size="2"
    face="Verdana, Arial, Helvetica">Microsoft Proxy Server as a DHCP
    Relay Agent</font></a></p>
</blockquote>

<h4><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="h401"><font size="2"
face="Verdana, Arial, Helvetica">Microsoft Proxy Server as a DHCP Server</font></a></h4>

<p><font size="2" face="Verdana, Arial, Helvetica">When DHCP services are
used on the internal network, the computer running Microsoft
Proxy Server can be used as a DHCP server. However, The server
must use a permanent address on the local network and no default
gateway should be specified on the internal server adapter card.
Also, be careful to enable DHCP Server<em> for the internal
network adapter only </em>and to disable DHCP Server for the
external network adapter.</font></p>

<h4><a
name="TosetMicrosoftDHCPServerbindingsforusewithMicrosoftProxyServer"><font
size="2" face="Verdana, Arial, Helvetica"><strong>To set Microsoft DHCP
Server bindings for use with Microsoft Proxy Server</strong></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">Install and
        configure <strong>Microsoft DHCP Server</strong>.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">For information on
        installing and configuring Microsoft DHCP Server, see
        your documentation for Windows&nbsp;NT Server. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the desktop, click <strong>Start</strong>, select <strong>Settings</strong>,
        click <strong>Control Panel</strong>. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Double-click
        the <strong>Network</strong> icon. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Click
        the <strong>Bindings</strong> tab. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">From
        the <strong>Show Bindings for</strong> list box, select <strong>all
        services</strong>. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Double-click <strong>Microsoft
        DHCP Server</strong>.</font><p><font size="2"
        face="Verdana, Arial, Helvetica">The service listing expands to
        show protocols supported for this service. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the<strong>
        service view</strong> window, double-click <strong>TCP/IP
        Protocol</strong>.</font><p><font size="2"
        face="Verdana, Arial, Helvetica">The service listing expands to
        show all adapters that are bound for this protocol and
        service. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select the
        external network adapter, click <strong>Disable,</strong>
        and then click <strong>OK</strong>. <br>
        <br>
        </font></li>
</ol>

<h4><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="h402"><font size="2"
face="Verdana, Arial, Helvetica">Microsoft Proxy Server as a DHCP Client</font></a></h4>

<p><font size="2" face="Verdana, Arial, Helvetica">It is recommended that
the Microsoft Proxy Server <em>not be enabled</em> as a DHCP
client on the internal network. Instead use static IP addressing
and assign a permanent IP address for the internal network on the
server adapter card. Do not specify a default gateway when
assigning IP addressing for this card.</font></p>

<h4><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="h403"><font size="2"
face="Verdana, Arial, Helvetica">Microsoft Proxy Server as a DHCP Relay
Agent</font></a></h4>

<p><font size="2" face="Verdana, Arial, Helvetica">There are no special
considerations for using Microsoft Proxy Server as DHCP relay
agent on the private network between another DHCP server and DHCP
clients. Use the Network application in Control Panel to set
TCP/IP properties to enable DHCP relay. This option can be
enabled by adding DHCP server addresses to the search list on the
DHCP Relay property sheet.</font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="3h2"><font size="2"
face="Verdana, Arial, Helvetica">Using Multiple Microsoft Proxy Server
Gateways</font></a></h2>

<blockquote>
    <p><a href="#17h3"><font size="2" face="Verdana, Arial, Helvetica">Multiple
    Gateway Overview</font></a><a href="#1h3"><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    Using Multiple Proxy Gateways in a DNS Environment</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#2h3"><font size="2" face="Verdana, Arial, Helvetica">Using
    Multiple Proxy Gateways in a WINS Environment</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#3h3"><font size="2" face="Verdana, Arial, Helvetica">Using
    Multiple WinSock Proxy Service Gateways</font></a></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">For an overview of the
DNS, WINS, and DHCP services, see </font><a href="#2h2"><font
size="2" face="Verdana, Arial, Helvetica">More About DNS, WINS, and DHCP,</font></a><font
size="2" face="Verdana, Arial, Helvetica"> later in this chapter.</font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="17h3"><font size="2"
face="Verdana, Arial, Helvetica">Multiple Gateway Overview</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">A private network can
have more than one Microsoft Proxy Server gateway in use. Where
multiple server computers are configured for Microsoft Proxy
Server, Internet traffic loads can be balanced across each
separate gateway by configuring clients to use all gateways
evenly. For example, if you have two Microsoft Proxy Server
gateways, one named PROXY1 and the other PROXY2, you would
specify either PROXY1 or PROXY2 in the proxy connection settings
for each client browser and the valid port to be used (typically,
port 80 is used for HTTP proxy service). Load balancing is
managed in this manner when multiple proxy gateways are added.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Another option with
multiple proxy gateways is to separate loads by service type
across different servers. For example, you can enable HTTP proxy
service for server (such as PROXY1) for a client and specify a
second server (such as PROXY2) for enabling FTP proxy service. </font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="1h3"><font size="2"
face="Verdana, Arial, Helvetica">Using Multiple Proxy Gateways in a DNS
Environment</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">When you use multiple
gateways on a private network with DNS services, you must
configure at least one entry for each gateway that indicates an
IP address to be searched for on the local network to provide DNS
name resolution. The DNS server address specified will be used to
forward all domain name requests. In some cases, you may also
have a secondary DNS server address to be searched for and used
if the first DNS server is not available. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;When
working with DNS environments that are located on the Internet,
it is not unusual for companies to make mutual arrangements to
host each other&#146;s DNS entries. This ensures that, if a
primary DNS server becomes unavailable, there is a backup domain
server for the domain. This backup domain server is listed with
the domain record that is registered with the Internet Network
Information Center (InterNIC). Both DNS servers are mutually
configured to provide secondary DNS service to the complimentary
domain. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">You can also use DNS
&#147;round-robin,&#148; a feature that offers load balancing for
multiple DNS servers on a network. Round-robin involves assigning
a single DNS domain name to be serviced by multiple DNS servers,
each with its own IP address on the local network. The round
robin configuration assures that for all DNS name lookup
requests, any server assigned for round-robin can that is
currently available can respond to a DNS request.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For more information
about configuring Windows&nbsp;NT Server as a DNS server, see
your documentation Windows&nbsp;NT Server.</font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="2h3"><font size="2"
face="Verdana, Arial, Helvetica">Using Multiple Proxy Gateways in a WINS
Environment</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">In a WINS environment,
you use the WINS Server to configure a multi-homed environment.
This is similar to the DNS environment in that you create one
entry, which contains the list of IP addresses for all the
Microsoft Proxy Server gateways. In a WINS environment, there are
three levels of name resolution. At first the WINS Server matches
a client&#146;s request with the client&#146;s IP address. The
WINS Server seeks a Proxy Server with the same subnet as the
client. The WINS Server then seeks a Microsoft Proxy Server
gateway with the same net as the client. If WINS cannot match a
client to a gateway in this fashion, it picks a gateway from the
WINS list at random. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For more information
about configuring Windows&nbsp;NT Server as a WINS server, see
your documentation for Windows&nbsp;NT Server.</font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="3h3"><font size="2"
face="Verdana, Arial, Helvetica">Using Multiple WinSock Proxy Service
Gateways</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">WinSock Proxy clients
use the WinSock Proxy service on the server they were configured
to use by the client Setup program.. This information is
preconfigured during Proxy Client Setup, in the Mspclnt.ini file.
To balance the load across each of your Microsoft Proxy Server
gateways configure the Microsoft Proxy Server client
initialization files appropriately (for example, to use DNS
round-robin).</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For information about
configuring WinSock Proxy clients and the Mspclnt.ini file, see </font><a
href="08_msp.htm"><font size="2" face="Verdana, Arial, Helvetica">
&#147;Setting Up Clients.&#148;</font></a></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="2h2"><font size="2"
face="Verdana, Arial, Helvetica">More About DNS, WINS, and DHCP</font></a></h2>

<blockquote>
    <p><a href="#4h3"><font size="2" face="Verdana, Arial, Helvetica">Background
    on Internet Naming and Addressing</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#5h3"><font size="2" face="Verdana, Arial, Helvetica">What
    is DNS?</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#6h3"><font size="2" face="Verdana, Arial, Helvetica">What
    is WINS?</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#7h3"><font size="2" face="Verdana, Arial, Helvetica">What
    is DHCP?</font></a></p>
</blockquote>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="4h3"><font size="2"
face="Verdana, Arial, Helvetica">Background on Internet Naming and
Addressing</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">As the Internet
continues to increase grow in size and numbers, the use of TCP/IP
for private internetworking increases along with it as well. The
primary reason for this increase is that TCP/IP offers the
benefit of a widely deployed set of open protocol standards that
are well suited to forming wide area networks (WANs). </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">In order for each
computer to identify itself on the TCP/IP network, each host must
be uniquely identified by the following information: </font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>An
        IP address&nbsp;&nbsp;&nbsp;</strong>This is a 32-bit
        field that is composed of four octets (8-bit numbers from
        0 to 255). Each address has decimal notation to separate
        octet numbers, such as 10.10.100.201. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>A
        subnet mask&nbsp;&nbsp;&nbsp;</strong>This indicates how
        the IP address is to be read. It indicates how to
        separate the network identifying information from the
        host identifying information, and interprets the IP
        address correctly. For example, if a subnet mask of
        255.255.255.0 is applied for an address 10.85.189.24, it
        indicates that the host number is 24 located on the
        10.85.189 subnetwork. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>A
        default gateway&nbsp;&nbsp;&nbsp;</strong>This is used to
        specify the address for the nearest routing device that
        will be used by the host device to forward addressed
        packets onto the network. </font></p>
    </li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">One way to configure
this address information is to have a network administrator or
technician manually enter these settings on each computer before
it is joined to the local network. For small networks, this does
not present an overly difficult problem, but as networks become
larger or further divide into multiple subnetworks, integrating
new devices onto existing networks becomes a significant chore
for network administrators to manage. In addition, this chore
might need to be repeated each time a device is relocated to a
different subnetwork. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">This type of manually
applied configuration is referred to as <em>static IP addressing</em>.
It requires that all addresses be recorded and centrally
maintained by a network administrator. This is to provide an
orderly procedure for adding new devices and avoid problems that
can arise from duplicating address assignments on the network.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Another limitation of
IP addressing is that users find it awkward to deal with numbers
when locating devices on the network. Although IP addressing is
an efficient scheme that works optimally for computers and
routers, in practice it is true that network users find common
names for hosts(such as myserver.mycompany.com) much easier to
remember than IP addresses (such as 10.100.206.195). Further
solutions for mapping user-friendly names to assigned IP
addresses simplify user access, but compound the existing
administrative problems already inherent in TCP/IP.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The following section
covers some of the accepted and proposed standards that have been
drafted to provide solutions for all of these TCP/IP
shortcomings. Standards for mapping IP addresses to common names
through the use of the Domain Naming System (DNS) and for
maintaining dynamic storage of network names and IP addresses by
use of the Windows Internet Name Service (WINS) are discussed
first. Protocols developed to automate the process of assigning
IP addresses and configuring clients, such as the Dynamic Host
Configuration Protocol (DHCP) are also discussed.</font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="5h3"><font size="2"
face="Verdana, Arial, Helvetica">What is DNS?</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">The Domain Naming
System (DNS) was developed by the Internet Engineering Task Force
(IETF) as an attempt to standardize a way to map pairings of
logical host names to actual IP addresses on a TCP/IP network. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">DNS is an acceptable
method for resolving names to addresses, but it requires the use
of host files, and DNS servers must be overseen and updated
manually as names and addresses are modified. This furthers the
administrative chores that a TCP/IP network administrator must
perform, although it does simplify network access for users.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For DNS to work
properly it requires the use of a <em>name space</em>. The DNS
name space is hierarchical in nature and allows host names to be
stated in absolute or relative terms. Absolute names, or Fully
Qualified Domain Names (FQDNs) are defined from the root of the
name space and uniquely identify a node in the hierarchy. FQDNs
end with a trailing dot. Relative names are represented relative
to a name in the hierarchy. For example, server.microsoft.com is
a relative DNS name of a host defined from the com part of the
DNS name space hierarchy, which contains domain names of
commercial organizations.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">If the domain name of a
company is:</font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">mycompany.com</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">then the following
domain names:</font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">sales.mycompany.com</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">and:</font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica">marketing.mycompany.com</font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">are known as <em>subdomains</em>
of the mycompany.com domain. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">In addition to planning
for domain hierarchies, DNS services use <em>host files</em>,
which are flat text files that pair DNS domain names and IP
address pairings for hosts on the local network. Host files are
used by the DNS server to process and resolve name query requests
forwarded by DNS clients initiating communications on the local
network. In nearly all cases where DNS is used, host files must
be created and updated manually for DNS service to work properly
for all hosts.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Because DNS is a
supported standard for all TCP/IP networks, there are typically
no restrictions to using DNS services on most private networks
that support TCP/IP network. Although other TCP/IP servers that
are not Windows-based can be made to function as DNS servers,
Windows&nbsp;NT Server provides the option of acting as a DNS
server as well. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For more information on
setting up Windows&nbsp;NT Server for use as a DNS Server, see
your documentation for Windows&nbsp;NT Server. Also see </font><a
href="#8888h2"><font size="2" face="Verdana, Arial, Helvetica">Using DNS,
WINS, and DHCP with Microsoft Proxy Server,</font></a><font
size="2" face="Verdana, Arial, Helvetica"> earlier in this chapter.</font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="6h3"><font size="2"
face="Verdana, Arial, Helvetica">What is WINS?</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">Windows Internet Naming
Service (WINS) is another option for resolving host names on
networks that use Microsoft TCP/IP. It provides a distributed
database for registering and querying dynamic computer name-to-IP
address mappings in a routed network environment. WINS uses the
NetBIOS computer name for any Microsoft-based network client to
register each client in the WINS database on a computer running
Windows&nbsp;NT Server.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">A WINS system consists
of the following:</font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>WINS
        server&nbsp;&nbsp;&nbsp;</strong>Runs on a
        Windows&nbsp;NT Server and handles name registration
        requests from WINS clients and registers their names and
        IP addresses. The server also responds to name queries
        from WINS clients by returning the IP address of the name
        being queried (assuming the name is registered with the
        WINS server). </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>WINS
        client&nbsp;&nbsp;&nbsp;</strong>Registers its name with
        the WINS server when it joins or leaves the network. It
        also queries the WINS server for remote name resolution. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>WINS
        proxy&nbsp;&nbsp;&nbsp;</strong>Helps resolve names on
        behalf of non-WINS clients. The proxy communicates with
        the WINS server to resolve names (rather than maintaining
        its own database) and then caches the names for a certain
        amount of time. The proxy serves as an intermediary
        between the WINS server and the non-WINS client, either
        by communicating with the WINS server or by supplying a
        name-to-IP address mapping from its cache. The presence
        of a WINS proxy in a WINS system is dictated solely by
        the presence of non-WINS clients. </font></p>
    </li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">If you are
administering a routed internetwork, WINS is the best choice for
NetBIOS name resolution, because it is designed to solve the
problems that occur with name resolution in a complex
internetwork. WINS goes beyond eliminating the need for an
LMHOSTS file (a hosts file of NetBIOS names&#150;to&#150;IP
address pairs) by reducing the use of local broadcasts for name
resolution and allowing users to easily locate systems on remote
networks. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Using WINS provides
several benefits. In a dynamic network environment where host IP
addresses can change frequently, WINS provides an excellent way
to dynamically register these changes as they occur. It
centralizes management of the NetBIOS names&#150;to&#150;IP
addresses mapping database, so that there is no need to manage
multiple LMHOSTS files on across several servers on a network. It
also reduces IP broadcast traffic in a NetBIOS-based
internetwork, while allowing the clients to locate remote systems
across local or wide area networks easily. Finally, with WINS,
users on a Windows&nbsp;NT network can browse transparently
across routers (for Windows&nbsp;NT domains that span multiple
subnets). Browsing without WINS is complicated and involves
manual procedures.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For more information,
see </font><a href="#8888h2"><font size="2"
face="Verdana, Arial, Helvetica">Using DNS, WINS, and DHCP with Microsoft
Proxy Server,</font></a><font size="2" face="Verdana, Arial, Helvetica">
earlier in this chapter.</font></p>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="7h3"><font size="2"
face="Verdana, Arial, Helvetica">What is DHCP?</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">The Dynamic Host
Configuration Protocol (DHCP) was established to relieve the
administrative burden of manual configuration of TCP/IP hosts on
the network. DHCP provides an alternative to static IP addressing
by enabling automatic configuration of the TCP/IP-related
parameters when a DHCP client becomes active on the local
network.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;DHCP
provides a way of passing configuration information to hosts that
is based on an earlier protocol standard, known as the Bootstrap
Protocol (BOOTP). BOOTP was conceived as a way to allow diskless
workstations to obtain TCP/IP configuration settings and perform
a network &#147;boot.&#148; DHCP uses some of the same concepts
as BOOTP, such as a shared message format, which allows existing
BOOTP clients to interoperate with DHCP Servers. However, there
are further additions to DHCP that distinguish it from BOOTP and
the two protocols are not identical in all respects.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">DHCP provides safe,
reliable, and simple TCP/IP network configuration. It ensures
that address conflicts do not occur, and helps conserve the use
of IP addresses by use of centralized management of address
allocation. DHCP conserves addresses that are not in use by
having the DHCP server reclaim an address after the address <em>lease
period</em> has elapsed. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The system
administrator controls how IP addresses are dynamically assigned
by the DHCP server. To establish DHCP service, you set several
parameters that are used to manage dynamic assignment of IP
addresses. First, a lease period for each address is set. A <em>lease</em>
specifies how long a computer can use an assigned IP address
before having to renew the lease with the DHCP server. Another
parameter that must be set for DHCP service is a <em>scope</em>.
A scope indicates the available range of addresses that can be
used within DHCP assignment. The scope provides for an available
pool of addresses for the DHCP server to use when assigning and
configuring clients. The scope exists only once for an entire
subnetwork, but it can be further defined by excluding reserved
subranges of addresses from the pool of assignable addresses
allowed by the scope. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">There are three major
benefits to setting up a DHCP environment. First, it requires no
additional address configuration for the workstation. This is
useful because users do not need to know or maintain their
computer&#146;s TCP/IP address configuration. This can be useful
for mobile computer users who use portable computers that are
moved to different offices or subnets frequently. Second, DHCP
clients can be configured with additional TCP/IP parameters, such
as the DNS server address or WINS server addresses that are
essential for successful name-to-IP-address resolution by a host.
Third, DHCP gives you better control of IP address assignment and
management. For example, if the IP address for a router in a
network changes and 250 client computers have to be updated with
the new address, with DHCP you do not have to visit every
workstation to reconfigure the default gateway manually.</font></p>

<h4><a name="HowdoesDHCPwork?"><font size="2"
face="Verdana, Arial, Helvetica"><strong>How does DHCP work? </strong></font></a></h4>

<p><font size="2" face="Verdana, Arial, Helvetica">DHCP is based on a
client/server model. The DHCP server runs on a server, such as a
Windows&nbsp;NT Server. The DHCP client runs on a network client
such as a Windows&nbsp;95 or Windows&nbsp;NT Workstation. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">During system startup
(the initializing state), a DHCP client computer sends a DHCP
&#147;discover&#148; message that is broadcast on the local
network and can be forwarded to all the DHCP servers on the
private internetwork. Each DHCP server that receives the discover
message responds with an &#147;offer&#148; message containing an
IP address and valid configuration information for the DHCP
client computer that sent the request.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The DHCP client then
collects the configuration and enters a selecting state, where it
chooses one of the address &#147;offers&#148; provided by the
DHCP servers. The client selects one of the offered
configurations and enters a requesting state. It then sends a
&#147;request&#148; message to specify a request from that DHCP
server. The selected DHCP server sends an
&#147;acknowledgment&#148; message that contains the address
requested, a valid lease for the address, and TCP/IP network
configuration parameters for the client. The client enters a
bound state after receiving the acknowledgment from the server
and can now participate on the TCP/IP network.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Client computers with
local disk storage save the received address for use during
subsequent system startup. As the lease approaches its expiration
date, the client attempts to renew its lease with the DHCP
server. If the DHCP server that initially offered the lease is
not available or the lease has expired, the client repeats the
process and gets a new configuration from any of the DHCP servers
available. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The following three
types of hosts can be active in a DHCP configuration process.</font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>DHCP
        Server&nbsp;&nbsp;&nbsp;</strong>Contains IP addresses,
        lease duration, and associated TCP/IP configuration
        information. The DHCP server listens for client requests
        and processes them. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>DHCP
        Client&nbsp;&nbsp;&nbsp;</strong>Gets its IP address and
        related TCP/IP configuration parameters from the DHCP
        server during the initialization stage. The client also
        extends the lease on the IP address by renewing the lease
        before it expires. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica"><strong>DHCP
        Relay Agent&nbsp;&nbsp;&nbsp;</strong>A relay agent
        software (compliant with RFC 1542) assists in forwarding
        the DHCP packets between subnets in a routed
        internetwork. Usually, this component runs on the
        routers. </font></p>
    </li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">For more information
about setting up DHCP services, see your documentation for
Windows&nbsp;NT Server. Also see </font><a href="#8888h2"><font
size="2" face="Verdana, Arial, Helvetica">Using DNS, WINS, and DHCP with
Microsoft Proxy Server,</font></a><font size="2"
face="Verdana, Arial, Helvetica"> earlier in this chapter.</font></p>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="7h1"><font size="2" face="Verdana, Arial, Helvetica">LAT
Configuration</font></a></h1>

<blockquote>
    <p><a href="#7h2"><font size="2" face="Verdana, Arial, Helvetica">Overview
    of LAT Configuration</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#8h2"><font size="2" face="Verdana, Arial, Helvetica">Modifying
    the LAT</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#9h2"><font size="2" face="Verdana, Arial, Helvetica">Replacing
    the LAT</font></a></p>
</blockquote>

<h2><a name="7h2"><font size="2" face="Verdana, Arial, Helvetica">Overview
of LAT Configuration</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">During Microsoft Proxy
Server installation the Setup program helps you create a list of
the IP addresses that constitute your private network. The
information you provide is used to create a table, called the
Local Address Table (LAT), that defines your private network. IP
addresses that are external to your private network are
specifically excluded from this table. The server maintains the
master copy of the LAT, and a copy is downloaded to client
computers.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">The Setup program
creates the original copy of the LAT. After installation, the
server&#146;s copy of the LAT can be modified by using Internet
Service Manager.</font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="8h2"><font size="2"
face="Verdana, Arial, Helvetica">Modifying the LAT</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">You can modify the
existing LAT, adding or removing to the IP address pairs provided
by the Windows&nbsp;NT Server internal routing tables.</font></p>

<h4><a name="TomodifytheLAT"><font size="2"
face="Verdana, Arial, Helvetica"><strong>To modify the LAT</strong></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From Internet
        Service Manager, double-click the computer name next to
        the <strong>Web Proxy</strong> or <strong>WinSock Proxy </strong>service<strong>.</strong></font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <strong>Service
        Properties</strong> window appears. Make sure the <strong>Service</strong>
        tab is selected. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <strong>Edit
        Local Address Table (LAT)</strong> button.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <strong>Local
        Address Table Configuration</strong> dialog box appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Verify
        that the entries in the <strong>Internal IP Ranges</strong>
        box correctly identify your internal network. Add any
        needed IP address pairs until all addresses of your
        internal network are defined. Remove any IP address pairs
        that define external (Internet) addresses. </font></p>
        <ul>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">To add a range of IP
                addresses to the list, under <b>Edit</b> type a
                pair of addresses in the <b>From</b> and <b>To</b>
                boxes, and then click the <strong>Add</strong>
                button. </font></p>
            </li>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">To add a single IP
                address to the list, under <b>Edit</b> type the
                same address in both the <b>From</b> and <b>To</b>
                boxes, and then click the <strong>Add</strong>
                button. </font></p>
            </li>
            <li><font size="2" face="Verdana, Arial, Helvetica">To remove
                an IP address or address pair from the list,
                select it from the <b>Internal IP Ranges</b> box,
                and then click the <strong>Remove</strong>
                button.</font></li>
        </ul>
        <p><font size="2" face="Verdana, Arial, Helvetica">Be sure to
        exclude from the LAT any IP addresses associated with
        Internet-connected network adapter cards on servers
        running Microsoft Proxy Server. These are external IP
        addresses and should not be included in the LAT. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">When
        the configuration is properly set, click <b>OK</b>, and
        click <strong>OK</strong> again. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Stop
        and start the WinSock Proxy and Web Proxy services. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">The LAT changes
        do not take effect on the server until the services are
        restarted.&nbsp; <br>
        <br>
        </font></p>
    </li>
</ol>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="9h2"><font size="2"
face="Verdana, Arial, Helvetica">Replacing the LAT</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">You can also completely
replace the LAT, generating a new list of IP address pairs from
internal routing tables used by Windows&nbsp;NT Server.</font></p>

<h4><a name="ToreplacetheLATandgenerateanewlistofaddresses"><font
size="2" face="Verdana, Arial, Helvetica"><strong>To replace the LAT and
generate a new list of addresses</strong></font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From Internet
        Service Manager, double-click the computer name next to
        the <strong>Web Proxy</strong> or <strong>WinSock Proxy </strong>service<strong>.</strong></font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <strong>Service
        Properties</strong> window appears. Make sure the <strong>Service</strong>
        tab is selected. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <strong>Edit
        Local Address Table (LAT)</strong> button.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <strong>Local
        Address Table Configuration</strong> dialog box appears. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">To completely
        replace the addresses shown in the Internal IP Ranges
        list and generate a new table of IP addresses, click the <b>Construct
        Table</b> button.</font><p><font size="2"
        face="Verdana, Arial, Helvetica">The <strong>Construct Local
        Address Table</strong> dialog box appears. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">To
        add to the LAT three ranges of IP addresses defined by
        IANA as private address ranges that can be used in a
        private IP network that is not connected to the Internet,
        select the <strong>Add the private ranges</strong> check
        box. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">To
        choose the network adapter cards on the server whose IP
        addresses will be included in the LAT, select <strong>Load
        from NT Internal Routing Table</strong> and complete its
        options. </font></p>
        <ul>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">If you do not know which
                of the server&#146;s network adapter cards are
                connected to the private network, select <strong>Load
                known address ranges from all IP interface cards</strong>.
                </font></p>
            </li>
            <li><p align="left"><font size="2"
                face="Verdana, Arial, Helvetica">If you know which of the
                server&#146;s network adapter cards are connected
                to the private (internal) network and which are
                connected to the Internet, load only those IP
                addresses associated with the server&#146;s
                internally connected cards. Select <strong>Load
                known address ranges from the following IP
                interface cards</strong>. Then, in the list of
                network adapter cards, select the check box for
                each of the internally connected cards, and clear
                the check box for each of the externally
                connected cards. </font></p>
            </li>
        </ul>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">When you have
        completed the <strong>Construct Local Address Table</strong>
        dialog box click <strong>OK</strong>.</font><p><font
        size="2" face="Verdana, Arial, Helvetica">The <strong>Local
        Address Table Configuration</strong> dialog box returns.
        A list of IP address pairs is displayed in the <b>Internal
        IP Ranges</b> box. </font></p>
    </li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Verify that the
        entries in the <strong>Internal IP Ranges</strong> box
        correctly identify your internal network. Use the <strong>Add</strong>
        button to add any needed IP address pairs until all
        addresses of your internal network are defined. Use the <strong>Remove</strong>
        button to remove any IP address pairs that define
        external (Internet) addresses. </font><p><font size="2"
        face="Verdana, Arial, Helvetica">Be sure to exclude from the LAT
        any IP addresses associated with Internet-connected
        network adapter cards on servers running Microsoft Proxy
        Server. These are external IP addresses and should not be
        included in the LAT. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">When
        the LAT configuration is properly set, click <b>OK</b>,
        and then click <strong>OK</strong> again. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Stop
        and start the WinSock Proxy and Web Proxy services. </font></p>
        <p><font size="2" face="Verdana, Arial, Helvetica">The LAT changes
        do not take effect on the server until the services are
        restarted. </font></p>
    </li>
</ol>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="9h1"><font size="2"
face="Verdana, Arial, Helvetica">Dial-Up Support</font></a></h1>

<blockquote>
    <p><a href="#15h2"><font size="2" face="Verdana, Arial, Helvetica">How
    Dial-Up Support Works</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#19h2"><font size="2" face="Verdana, Arial, Helvetica">Using
    RAS with Microsoft Proxy Server</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#14h2"><font size="2" face="Verdana, Arial, Helvetica">Using
    Microsoft Proxy Auto Dial</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#4h2"><font size="2" face="Verdana, Arial, Helvetica">Restarting
    Services After a Dial-Up Connection<br>
    </font></a></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="15h2"><font size="2"
face="Verdana, Arial, Helvetica">How Dial-Up Support Works</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">For Microsoft Proxy
Server, dial-up support for connecting to an Internet service
provider (ISP) is managed by using the Microsoft Proxy Auto Dial
utility, Adialcfg.exe. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Microsoft Proxy Auto
Dial uses Remote Access Service (RAS) phone book entries to
perform on-demand dial-up connections as a RAS client. Once a RAS
client is installed and configured on the server computer,
Dial-Up Networking can be used to create RAS phone book entries
for service dialing with Microsoft Proxy Server. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">For dial-up support,
connections are made by Microsoft Proxy Server when the following
service demands occur:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">For the Web Proxy
        service, a dial-up connection is used when a requested
        object cannot be located and returned by the Web Proxy
        caching service. </font></li>
</ul>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica">For the WinSock
        Proxy service, all client requests are processed by using
        a dial-up connection.</font></li>
</ul>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="19h2"><font size="2"
face="Verdana, Arial, Helvetica">Using RAS with Microsoft Proxy Server</font></a></h2>

<blockquote>
    <p><a href="#20h3"><font size="2" face="Verdana, Arial, Helvetica">Configuring
    RAS Options</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#21h3"><font size="2" face="Verdana, Arial, Helvetica">Creating
    RAS Phone Book Entries</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#22h3"><font size="2" face="Verdana, Arial, Helvetica">Other
    RAS-Related Issues</font></a></p>
</blockquote>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="20h3"><font size="2"
face="Verdana, Arial, Helvetica">Configuring RAS Options</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">To configure dial-up
support for Microsoft Proxy Server, first verify that RAS has
been installed and configured properly. (If RAS is not currently
installed, refer to your Windows&nbsp;NT product documentation
for more information on installing and configuring RAS.) Once RAS
is installed, you must configure port usage for dial-out only (to
support dial-up service). </font></p>

<h4><a name="TosetorverifyaRASclientfordial-upsupport"><font
size="2" face="Verdana, Arial, Helvetica">To set or verify a RAS client
for dial-up support</font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the
        server&#146;s desktop, select <strong>Settings</strong>,
        then select <strong>Control Panel</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select the Network
        icon and double-click it. The <strong>Network Properties</strong>
        dialog box appears.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <strong>Services</strong>
        tab, then select <strong>Remote Access Service</strong>
        from the list of network services.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Properties</strong>.
        The <strong>Remote Access Setup</strong> dialog box
        appears. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">If necessary,
        select a port from the list. If only a single port has
        been set up for RAS use, this port will be selected by
        default.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Configure</strong>.
        The<strong> Configure Port Usage </strong>dialog box
        appears.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the Port
        Usage options, select <strong>Dial out only</strong>,<strong>
        </strong>then click <strong>OK</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">From Remote Access
        Setup, click <strong>Network</strong>. The <strong>Network
        Configuration</strong> dialog box appears.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select <strong>TCP/IP</strong>
        from the list of dial-out protocols, then click <strong>OK</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">From Remote Access
        Setup, click <strong>Continue</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Close</strong>
        from the <strong>Network Properties</strong> dialog box,
        then select <strong>Yes</strong> when prompted to restart
        the computer.</font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;If
RAS was installed and ports were configured initially as a RAS
server (to receive calls) and not as a RAS client (to dial out
only), port usage must be changed. For more information on
changing from RAS server to RAS client settings, see </font><a
href="#2h4"><font size="2" face="Verdana, Arial, Helvetica">Using RAS
Server and Microsoft Proxy Server</font></a><font size="2"
face="Verdana, Arial, Helvetica">.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Once the RAS client is
installed, you must reconfigure Remote Access Autodial Manager
and Remote Access Connection Manager services to use Microsoft
Proxy Auto Dial to manage dial-up support.</font></p>

<h4><a name="ToreconfigureRemoteAccessServicefordial-upsupport"><font
size="2" face="Verdana, Arial, Helvetica">To reconfigure Remote Access
Service for dial-up support</font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the
        server&#146;s desktop, select <strong>Settings</strong>,
        then select <strong>Control Panel</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select the <strong>Services
        </strong>icon and double-click it. The <strong>Services
        Properties</strong> dialog box appears.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select <strong>Remote
        Access Autodial Manager</strong> from the listed
        services.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Startup</strong>.
        The <strong>Service</strong> dialog box appears. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Disabled</strong>
        from the <strong>Startup Type</strong> dialog box, then
        click <strong>OK</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select <strong>Remote
        Access Connection Manager</strong> from the listed
        services.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Startup</strong>.
        The <strong>Service</strong> dialog box appears. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Automatic</strong>
        from the <strong>Startup Type</strong> dialog box, then
        click <strong>OK</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Close</strong>.</font></li>
</ol>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="21h3"><font size="2"
face="Verdana, Arial, Helvetica">Creating RAS Phone Book Entries</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">Once a RAS client has
been configured, an initial dialing entry must be created by
using the Dial-Up Networking program. This entry will be used to
dial your ISP&#146;s phone number. Before creating a dialing
entry, first check with your ISP for any specific connection
settings that you will need to use when creating your dialing
entry. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;When
creating a RAS phone book entry for use with Microsoft Proxy
Server, you must first log on by using an account with
Administrator privileges. </font></p>

<h4><a name="TocreateadefaultRASphonebookentryfordial-upsupport"><font
size="2" face="Verdana, Arial, Helvetica">To create a default RAS phone
book entry for dial-up support </font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the
        server&#146;s desktop, select <strong>Programs</strong>,
        select <strong>Accessories</strong>, then click <strong>Dial-Up
        Networking</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">If the phone book
        is empty, click <strong>OK</strong> to add a new entry.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Enter a name for
        the new phone book entry, then click <strong>Next</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Follow the
        on-screen instructions for creating a phone book entry.
        Click <strong>Finish </strong>when you have completed the
        entry.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select the new
        phone book entry to dial from the drop-down list box.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>More</strong>,
        then click <strong>Logon Preferences</strong>. The <strong>Logon
        Preferences </strong>dialog box appears</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the <strong>Dialing</strong>
        tab, click the arrow next to <strong>Idle seconds before
        hanging up</strong> to change the default value from 0 to
        1. This will ensure that RAS always disconnects after
        each dialing attempt. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>OK</strong>,
        then click <strong>Close</strong>.</font></li>
</ol>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="22h3"><font size="2"
face="Verdana, Arial, Helvetica">Other RAS-Related Issues</font></a></h3>

<blockquote>
    <p><a href="#2h4"><font size="2" face="Verdana, Arial, Helvetica">Using
    RAS Server and Microsoft Proxy Server<br>
    </font></a><a href="#1h4"><font size="2"
    face="Verdana, Arial, Helvetica">Using PPTP and Microsoft Proxy Server
    </font></a></p>
</blockquote>

<h4><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="2h4"><font size="2"
face="Verdana, Arial, Helvetica">Using RAS Server and Microsoft Proxy
Server</font></a></h4>

<hr>

<p><font color="#FF0000" size="2" face="Verdana, Arial, Helvetica"><strong>Warning</strong></font><font
size="2" face="Verdana, Arial, Helvetica">&nbsp;&nbsp;&nbsp;Enabling a RAS
Server with Microsoft Proxy Server is not a recommended
configuration. If you are considering using RAS dialup, or if you
configured a RAS server during installation of RAS, read the
following section carefully for more information on issues
related to RAS server usage and Microsoft Proxy Server.</font></p>

<hr>

<p><font size="2" face="Verdana, Arial, Helvetica">If you have installed
RAS and configured an initial port for dial-out use after
Microsoft Proxy Server was installed, check that port usage is
set for <strong>Dial Out Only</strong>. If <strong>Dial Out and
Receive Calls</strong> or <strong>Receive Calls Only</strong> is
selected, the server is configured as a RAS server. In almost all
cases, RAS should be reconfigured for RAS client use (to dial out
only). </font></p>

<h4><a name="TochangefromaRASservertoaRASclient"><font size="2"
face="Verdana, Arial, Helvetica">To change from a RAS server to a RAS
client</font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the
        server&#146;s desktop, select <strong>Settings</strong>,
        then select <strong>Control Panel</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select the Network
        icon and double-click it. The <strong>Network Properties</strong>
        dialog box appears.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <strong>Services</strong>
        tab, then select <strong>Remote Access Service</strong>
        from the list of network services.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Properties</strong>.
        The Remote Access Setup dialog box appears. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">If necessary,
        select a port from the list. If only a single port has
        been set up for RAS use, this port will be selected by
        default.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Configure</strong>.
        The <strong>Configure Port Usage</strong> dialog box
        appears.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the <strong>Port
        Usage</strong> options, select <strong>Dial Out Only</strong>,<strong>
        </strong>then click <strong>OK</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">From Remote Access
        Setup, click <strong>Continue</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the <strong>Protocols</strong>
        tab, then select <strong>TCP/IP Protocol</strong> from
        the list of network protocols.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Properties</strong>.
        The <strong>Microsoft TCP/IP Properties </strong>dialog
        box appears.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click on the <strong>Routing</strong>
        tab. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Clear <strong>Enable
        IP Forwarding</strong>, then click <strong>Apply</strong>,
        and then click <strong>OK</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Close</strong>
        from the <strong>Network Properties</strong> dialog box,
        then select <strong>Yes</strong> when prompted to restart
        the computer.</font></li>
</ol>

<h4><a name="TouseaRASserverwithMicrosoftProxyServer"><font
size="2" face="Verdana, Arial, Helvetica"><strong>To use a RAS server with
Microsoft Proxy Server</strong></font></a></h4>

<p><font size="2" face="Verdana, Arial, Helvetica">There is one
exceptional case where a RAS server can be installed and used: if
an additional separate port is configured to receive calls only.
For example, if dial-up support is configured on the COM2 port of
the server, a dial-in server could be allowed on the
server&#146;s COM1 port. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">When configuring any
additional ports for RAS server usage, limit dial-in clients by
selecting <strong>This Computer Only</strong> and clear <strong>Entire
Network</strong> access during Remote Access Service setup. (If
access to the entire network is allowed, IP forwarding will be
also be enabled. IP forwarding is not allowed with Microsoft
Proxy Server.)</font></p>

<h4><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="1h4"><font size="2"
face="Verdana, Arial, Helvetica">Using PPTP and Microsoft Proxy Server</font></a><font
size="2" face="Verdana, Arial, Helvetica"> </font></h4>

<p><font size="2" face="Verdana, Arial, Helvetica">Point-to-Point
Tunneling Protocol (PPTP) is a networking protocol that supports
multiprotocol virtual private networks (VPNs), enabling secure
network access over the Internet between remote computers. </font></p>

<hr>

<p><font color="#FF0000" size="2" face="Verdana, Arial, Helvetica"><strong>Warning</strong></font><font
size="2" face="Verdana, Arial, Helvetica">&nbsp;&nbsp;&nbsp;Using PPTP
with Microsoft Proxy Server is not recommended. If PPTP is
installed, read the following section carefully for information
on issues related to PPTP usage with Microsoft Proxy Server.</font></p>

<hr>

<p><font size="2" face="Verdana, Arial, Helvetica">If PPTP is installed on
the same computer used for Microsoft Proxy Server, the following
configuration changes must be made after installation:</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Change
        PPTP-configured port usage settings in Remote Access
        Service setup from RAS server (to receive calls only) to
        a RAS client (to dial out only). </strong><br>
        <br>
        By default, PPTP installs and enables RAS server. In most
        cases, RAS server will also be configured to allow IP
        forwarding on the server computer. For more information
        on changing from RAS server to RAS client settings, see </font><a
        href="#2h4"><font size="2" face="Verdana, Arial, Helvetica">Using
        RAS Server and Microsoft Proxy Server</font></a><font
        size="2" face="Verdana, Arial, Helvetica">.</font></li>
</ul>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Do not
        enable PPTP filtering.</strong><br>
        <br>
        If PPTP filtering is selected, network adapters on the
        server computer are effectively disabled for all other
        network protocols. When filtering is applied, only PPTP
        packets will be sent and received. </font></li>
</ul>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="14h2"><font size="2"
face="Verdana, Arial, Helvetica">Using Microsoft Proxy Auto Dial</font></a></h2>

<blockquote>
    <p><a href="#23h3"><font size="2" face="Verdana, Arial, Helvetica">About
    Microsoft Proxy Auto Dial</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font><a href="#24h3"><font size="2" face="Verdana, Arial, Helvetica">Setting
    Credentials</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#25h3"><font size="2" face="Verdana, Arial, Helvetica">Setting
    Dialing Hours</font></a></p>
</blockquote>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="23h3"><font size="2"
face="Verdana, Arial, Helvetica">About Microsoft Proxy Auto Dial</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">Microsoft Proxy Auto
Dial is an additional tool that can be used to manage dial-up
support for connecting Microsoft Proxy Server to your ISP. You
can use the Auto Dial tool to configure the following options for
any configured RAS phone book entry.</font></p>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Credentials
        </strong>These can include additional logon information
        used when connecting, such as user name, password, and
        domain name credentials required for logging on to your
        ISP.</font></li>
</ul>

<ul>
    <li><font size="2" face="Verdana, Arial, Helvetica"><strong>Dialing
        Hours</strong> Although service dialing is only performed
        on demand, dialing hours can be set to enable or disable
        dialing during selected hours of the day, or for selected
        days of the week. </font></li>
</ul>

<h4><a name="ToopenMicrosoftProxyAutoDial"><font size="2"
face="Verdana, Arial, Helvetica">To open Microsoft Proxy Auto Dial</font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">From the
        server&#146;s desktop click <strong>Start</strong>,
        select <strong>Programs</strong>, and then select <strong>Microsoft
        Proxy Server</strong>.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Select <strong>Dialup
        Tool</strong>. </font></li>
</ol>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="24h3"><font size="2"
face="Verdana, Arial, Helvetica">Setting Credentials</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">You can use the
Credentials property sheet if your ISP requires additional user
and password information to be entered when a dial-up connection
is made. This information can be stored for use by Microsoft
Proxy Auto Dial and used each time when dialing a specific phone
book entry.</font></p>

<h4><a
name="TosetcredentialstobeusedwhendialingaRASphonebookentry"><font
size="2" face="Verdana, Arial, Helvetica">To set credentials to be used
when dialing a RAS phone book entry</font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">Open Microsoft
        Proxy Auto Dial as described in the previous procedure. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Make sure the <strong>Credentials</strong>
        property sheet is selected. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click the arrow to
        display the <strong>Entry Name</strong> list box. Select
        the name of the RAS phone book entry to be used when
        dialing with Microsoft Proxy Server. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Under <strong>User
        Name</strong>,<strong> </strong>specify the user name to
        be used when logging on to a service provider&#146;s
        dial-in server. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Under <strong>Password</strong>,
        specify a user password (if one is required) to be used
        when logging on. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Under <strong>Domain</strong>,
        </font><font size="3" face="Verdana, Arial, Helvetica">specify a
        domain if the dial-in server requires one be provided
        when logging on. (This parameter is not usually required
        and can be left blank in most cases.) </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click <strong>Apply</strong>,
        then <strong>OK</strong>. Credentials entered will be
        used each time Microsoft Proxy Server initiates a dial-up
        connection by using this RAS phone book entry.</font></li>
</ol>

<h3><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="25h3"><font size="2"
face="Verdana, Arial, Helvetica">Setting Dialing Hours</font></a></h3>

<p><font size="2" face="Verdana, Arial, Helvetica">You can use the Dialing
Hours property sheet to specify selected hours or days during the
week when service dialing is to be allowed. When dialing hours
are selected, Microsoft Proxy Server will allow on-demand dialing
to occur. When dialing hours are cleared, service dialing will
not occur. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">This feature can be
used to prevent service dial-up connections from being made
during certain selected hours during the day, or for selected
days of the week. In some cases, limiting dialing to certain
specified hours can be useful where Internet access is billed by
connection time or where there are toll charges applied each time
an ISP&#146;s access number is dialed.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">When dialing hours are
set for a specific phone book entry, this information stored by
Microsoft Proxy Auto Dial and used each time when dialing the
entry.</font></p>

<h4><a
name="TosetdialinghoursforusewhendialingaRASphonebookentry"><font
size="2" face="Verdana, Arial, Helvetica">To set dialing hours for use
when dialing a RAS phone book entry </font></a></h4>

<ol>
    <li><font size="2" face="Verdana, Arial, Helvetica">Open Microsoft
        Proxy Auto Dial as described previously. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Make sure the <strong>Credentials</strong>
        property sheet is selected. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click on the arrow
        to display the <strong>Entry Name</strong> list box.
        Select the name of the RAS phone book entry to be used
        when dialing with Microsoft Proxy Server. </font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">Click on the <strong>Dialing
        Hours</strong> property sheet.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">To disable service
        dialing during specified hours of the day or for
        specified days of the week, type the appropriate hours
        and days. By default, service dialing is set to be
        enabled for all hours and is not restricted.</font></li>
    <li><font size="2" face="Verdana, Arial, Helvetica">When dialing hours
        have been set or modified, click <strong>Apply</strong>,
        then <strong>OK</strong>. The dialing hours entered will
        be used each time Microsoft Proxy Server initiates a
        dial-up connection by using this RAS phone book entry.</font></li>
</ol>

<p><font size="2" face="Verdana, Arial, Helvetica"><strong>Note</strong>&nbsp;&nbsp;&nbsp;Microsoft
Proxy Auto Dial does not provide an option for automated dial-up
connections. To automate dial-up connections, use RAS dial-out
scripting options, which can be set within the designated RAS
scripting file, Switch.inf. For more information on RAS
scripting, see your documentation provided with Windows&nbsp;NT
Server 4.0 or RAS online Help.</font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="4h2"><font size="2"
face="Verdana, Arial, Helvetica">Restarting Services After a Dial-Up
Connection</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">When Microsoft Proxy
Auto Dial is used to establish a dial-up connection to an ISP,
the WWW, Web Proxy, and WinSock Proxy services must be restarted
if:</font></p>

<ul>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Microsoft
        Proxy Auto Dial is being used for the first
        time.&nbsp;&nbsp;&nbsp;To initialize use with Microsoft
        Proxy Auto Dial, services must be restarted. </font></p>
    </li>
    <li><p align="left"><font size="2" face="Verdana, Arial, Helvetica">Settings
        made using Microsoft Proxy Auto Dial are later
        cleared.&nbsp;&nbsp;&nbsp;When settings are cleared,
        services must be restarted for new parameters to take
        effect. </font></p>
    </li>
</ul>

<p><font size="2" face="Verdana, Arial, Helvetica">Once Microsoft Proxy
Auto Dial has been used at least once (click <strong>Apply</strong>
and <strong>OK</strong> to store settings), further changes to
Auto Dial settings will be used by Web Proxy and WinSock Proxy
services for subsequent dial-out connections without requiring
services to be stopped and started each time.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">You can stop and
restart all services (WWW, Web Proxy, and WinSock Proxy) by using
Internet Service Manager. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Also, you can stop and
start the WWW, Web Proxy, and WinSock Proxy services from the
command prompt by issuing the following set of commands:</font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica"><strong>net stop
    w3svc<br>
    net stop wspsrv<br>
    net start w3svc<br>
    net start wspsrv</strong></font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">It is not necessary to
issue a separate command to stop and start the Web Proxy service.
Stopping and starting the WWW Service also stops and starts the
Web Proxy service.</font></p>

<hr>

<h1><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="8h1"><font size="2"
face="Verdana, Arial, Helvetica">Other Server Configuration Issues</font></a></h1>

<blockquote>
    <p><a href="#6h2"><font size="2" face="Verdana, Arial, Helvetica">Web
    Proxy Support for Anonymous FTP Clients</font></a><font
    size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#5h2"><font size="2" face="Verdana, Arial, Helvetica">Ping
    and Tracert</font></a><font size="2" face="Verdana, Arial, Helvetica"><br>
    </font><a href="#77h2"><font size="2" face="Verdana, Arial, Helvetica">Microsoft
    Exchange and Internet Mail Connector</font></a><font size="2"
    face="Verdana, Arial, Helvetica"><br>
    </font></p>
</blockquote>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="6h2"><font size="2"
face="Verdana, Arial, Helvetica">Web Proxy Support for Anonymous FTP
Clients</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Some FTP sites require
an e-mail user name as the password to be entered for anonymous
FTP client access. Where a password is required for anonymous
access, the e-mail name to be sent by Web Proxy is:</font></p>

<blockquote>
    <p><font size="2" face="Verdana, Arial, Helvetica"><strong>proxyuser@</strong><em>domain</em></font></p>
</blockquote>

<p><font size="2" face="Verdana, Arial, Helvetica">where <em>domain</em>
is the current Internet DNS domain setting in use on for TCP/IP
properties on Microsoft Proxy Server, such as mycompany.com. </font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="5h2"><font size="2"
face="Verdana, Arial, Helvetica">Ping and Tracert</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">Ping and Tracert are
two standard utilities used to assist in troubleshooting
TCP/IP-related problems on your network.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Ping is a utility that
helps to verify IP-level connectivity. When troubleshooting, the
Ping command is used to send an Internet Control Message Protocol
(ICMP) echo request to a targeted DNS domain name or IP address.
Tracert is a route-tracing utility. Tracert uses the IP TTL field
and ICMP error messages to determine the route followed from one
host to another through a network. </font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Because the Ping and
Tracert utilities operate at the transport layer by using ICMP
(which does not use Windows Sockets), these utilities can not be
redirected by Microsoft Proxy Server. Results obtained through
proxy connections using the Ping and Tracert utilities to test
connections between remote and local hosts will be invalid.</font></p>

<h2><a href="#Top"><font size="2" face="Verdana, Arial, Helvetica"><img
src="up.gif" alt="To Top" align="middle" border="0" width="14"
height="11"></font></a><a name="77h2"><font size="2"
face="Verdana, Arial, Helvetica">Microsoft Exchange and Internet Mail
Connector</font></a></h2>

<p><font size="2" face="Verdana, Arial, Helvetica">The Internet Mail
Connector is used to provide message exchange between Microsoft
Exchange Server and systems that use Simple Mail Transfer
Protocol (SMTP) for Internet e-mail.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">Microsoft Proxy Server
cannot support proxy forwarding of SMTP-based requests when
Exchange Server is installed on another server computer on the
internal network. This prevents another computer running Exchange
on your private network from using Internet Mail Connector to
service Internet e-mail messaging.</font></p>

<p><font size="2" face="Verdana, Arial, Helvetica">However, Exchange
Server can be installed together with Microsoft Proxy Server on
the same server and communicate normally to both internal and
external SMTP clients.</font></p>

<hr>

<p align="center"><font size="2" face="Verdana, Arial, Helvetica"><i>
1996 by Microsoft Corporation. All rights reserved.</i> </font></p>
</FONT>
</FONT>
</BODY>
</html>
