<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ListChannels Method</TITLE>
<META NAME=MS-HKWD CONTENT="ListChannels Method">
<META NAME="Keywords" CONTENT="Component Library">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="ListChannels"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="ListChannels Method"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="ListChannels Method"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../VB_ref.htm#ch_mschatpr_vb">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="KillChannel.htm">KillChannel Method</A>
<IMG SRC="../../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="ListUsers.htm">ListUsers Method</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>ListChannels Method<BR CLEAR=ALL>
<HR></H1>
<P>Lists channels on the chat server.

<P class=ref>Syntax
<BLOCKQUOTE>
<PRE><I>object</I><B>.ListChannels</B> <I>ChannelQueryItems</I><BR>
</PRE>
</BLOCKQUOTE>

<P class=ref>Parameters
<BLOCKQUOTE>
<TABLE WIDTH=87%>
<TR><TD><I>object</I></TD><TD>Required. An object expression that evaluates to an <A HREF="mschatpr.htm#MsChatPr">MsChatPr</A> control.</TD></TR>
<TR><TD><I>ChannelQueryItems</I></TD><TD>Required. An object expression that evaluates to a <A HREF="items.htm#ChatItems">ChatItems</A> object.</TD></TR>
</TABLE>
</BLOCKQUOTE>

<P class=ref>Remarks
<BLOCKQUOTE>
<P>The <I>ChannelQueryItems</I> parameter can restrict the listing to a subset of channels. 
<P>The IRC protocol is limited to listing all the server channels or only one specific channel. On an IRC server, the valid item name for <I>ChannelQueryItems</I> is "Name".
<P>For an IRCX server, the valid item names are listed in the following table.
<P>See <A HREF="chatchl_prop.htm#note">Note</A> for an explanation of the "Op" endings.
<TABLE BORDER=0>
<TR><TD><B>Item name </B></TD>
<TD><B> </B></TD>
<TD><B>Type </B></TD>
<TD><B>Usage
 </B></TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#channame">Name</A></TD>
<TD></TD>
<TD>String</TD>
<TD>Sets listing criteria based on the name of the channel.</TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#NameOp">NameOp</A></TD>
<TD></TD>
<TD>String</TD>
<TD>Sets listing criteria based on the name of the channel.</TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#Topic">Topic</A></TD>
<TD></TD>
<TD>String</TD>
<TD>Sets listing criteria based on the topic of the channel.</TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#TopicOp">TopicOp</A></TD>
<TD></TD>
<TD>String</TD>
<TD>Sets listing criteria based on the topic of the channel.</TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#Language">Language</A></TD>
<TD></TD>
<TD>String</TD>
<TD>Sets listing criteria based on the language of the channel.</TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#LanguageOp">LanguageOp</A></TD>
<TD></TD>
<TD>String</TD>
<TD>Sets listing criteria based on the language of the channel.</TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#Subject">Subject</A></TD>
<TD></TD>
<TD>String</TD>
<TD>Sets listing criteria based on the subject of the channel.</TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#SubjectOp">SubjectOp</A></TD>
<TD></TD>
<TD>String</TD>
<TD>Sets listing criteria based on the subject of the channel.</TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#ChannelAgeMax">ChannelAgeMax</A></TD>
<TD></TD>
<TD>Long</TD>
<TD>Sets listing criteria based on the creation time of the channel.</TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#ChannelAgeMin">ChannelAgeMin</A></TD>
<TD></TD>
<TD>Long</TD>
<TD>Sets listing criteria based on the creation time of the channel.</TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#ListCount">ListCount</A></TD>
<TD></TD>
<TD>Long</TD>
<TD>Limits the number of listed channels to a certain value.</TD>
</TR>
<TR><TD><A HREF="MemberCount.htm#MemberCount">MemberCount</A></TD>
<TD></TD>
<TD>Long</TD>
<TD>Sets listing criteria based on the member count of the channel.</TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#MemberCountMax">MemberCountMax</A></TD>
<TD></TD>
<TD>Long</TD>
<TD>Sets listing criteria based on the member count of the channel.</TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#MemberCountMin">MemberCountMin</A></TD>
<TD></TD>
<TD>Long</TD>
<TD>Sets listing criteria based on the member count of the channel.</TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#TopicAgeMax">TopicAgeMax</A></TD>
<TD></TD>
<TD>Long</TD>
<TD>Sets listing criteria based on the latest topic change of the channel.</TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#TopicAgeMin">TopicAgeMin</A></TD>
<TD></TD>
<TD>Long</TD>
<TD>Sets listing criteria based on the latest topic change of the channel.</TD>
</TR>
<TR><TD><A HREF="chatchl_prop.htm#Registered">Registered</A></TD>
<TD></TD>
<TD>Boolean&nbsp;&nbsp;</TD>
<TD>Limits the listed channels to registered channels only.</TD>
</TR>
</TABLE>
<P>The channels are filtered depending on their
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Internet_Ratings>
</object><A HREF=JavaScript:hhal_3.Click()>PICS rating</A> and the user's ratings settings. For example, if the user cannot view unrated content, the <B>ListChannels</B> call fails on an IRC connection or shows only the rated channels on an IRCX connection. If the user has some specific PICS ratings settings, only the channels that are appropriately rated are exposed to the user.
<P>A successful <B>ListChannels</B> call results in a succession of events. First, an <A HREF="OnBeginEnumeration.htm#OnBeginEnumeration">OnBeginEnumeration</A> event to mark the beginning of the channel listing is fired. Then, one <A HREF="OnChannelProperty.htm#OnChannelProperty">OnChannelProperty</A> event for each channel listed transpires and the <I>ChannelItems</I> parameter exposes all the known channel properties. Finally, an <A HREF="OnEndEnumeration.htm#OnEndEnumeration">OnEndEnumeration</A> with the <A HREF="enumEnumType.htm#etChannels">etChannels</A> parameter event is fired to mark the end of the channel listing. 
<P>If a listing is stopped because of a limitation set by the <A HREF="chatchl_prop.htm#ListCount">ListCount</A> item, an <A HREF="OnEndEnumeration.htm#OnEndEnumeration">OnEndEnumeration</A> with the <A HREF="enumEnumType.htm#etChannelsTruncated">etChannelsTruncated</A> parameter event is fired instead.
<P>The IRC protocol is limited to listing all the server channels or only one specific channel.
</BLOCKQUOTE>

<P class=ref>Examples
<BLOCKQUOTE>
<P>1. On an IRC/IRCX server:
<PRE>'List all the channels:
Dim chatitemobj As ChatItems
Set chatitemobj = New ChatItems
chatitemobj.AssociatedType = "Query"
MsChatPr1.ListChannels chatitemobj
Set chatitemobj = Nothing
'List one specific channel:
Dim chatitemobj As ChatItems
Set chatitemobj = New ChatItems
chatitemobj.AssociatedType = "Query"
chatitemobj.Item("Name") = "#Comic_Chat"
MsChatPr1.ListChannels chatitemobj
Set chatitemobj = Nothing
</PRE>
<P>2. On an IRCX server, list all the channels that have been created in the last hour, and limit the listing to 100 channels:
<PRE>Dim chatitemobj As ChatItems
Set chatitemobj = New ChatItems
chatitemobj.AssociatedType = "Query"
chatitemobj.Item("ChannelAgeMax") = 60
chatitemobj.Item("ListCount") = 100
MsChatPr1.ListChannels chatitemobj
Set chatitemobj = Nothing
</PRE>
<P>3. On an IRCX server, list all the channels that have between 10 and 50 members, in which the <A HREF="chatchl_prop.htm#Topic">Topic</A> includes the word "Corvette":
<PRE>Dim chatitemobj As ChatItems
Set chatitemobj = New ChatItems
chatitemobj.AssociatedType = "Query"
chatitemobj.Item("MemberCountMin") = 10
chatitemobj.Item("MemberCountMax") = 50
chatitemobj.Item("TopicOp") = "Contains"
chatitemobj.Item("Topic") = "Corvette"
MsChatPr1.ListChannels chatitemobj
Set chatitemobj = Nothing
</PRE>
<P>4. On an IRCX server, list all the registered channels that start with "#F" and have a <A HREF="chatchl_prop.htm#Language">Language</A> property that contains "FR":
<PRE>Dim chatitemobj As ChatItems
Set chatitemobj = New ChatItems
chatitemobj.AssociatedType = "Query"
chatitemobj.Item("Registered") = True
chatitemobj.Item("NameOp") = "StartsWith"
chatitemobj.Item("Name") = "#F"
chatitemobj.Item("LanguageOp") = "Contains"
chatitemobj.Item("Language") = "FR"
MsChatPr1.ListChannels chatitemobj
Set chatitemobj = Nothing
</PRE>
<P>5. On an IRCX server, list all the channels that have "real estate" in their <A HREF="chatchl_prop.htm#Subject">Subject</A> property:
<PRE>Dim chatitemobj As ChatItems
Set chatitemobj = New ChatItems
chatitemobj.AssociatedType = "Query"
chatitemobj.Item("SubjectOp") = "Contains"
chatitemobj.Item("Subject") = "real estate"
MsChatPr1.ListChannels chatitemobj
Set chatitemobj = Nothing
</PRE>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>
