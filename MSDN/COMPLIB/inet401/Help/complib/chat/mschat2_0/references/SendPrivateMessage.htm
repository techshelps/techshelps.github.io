<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SendPrivateMessage Method</TITLE>
<META NAME=MS-HKWD CONTENT="SendPrivateMessage Method">
<META NAME="Keywords" CONTENT="Component Library">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="SendPrivateMessage"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="SendPrivateMessage Method"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../../art/headbare.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="SendPrivateMessage Method"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../VB_ref.htm#ch_mschatpr_vb">Topic Contents</A>
</PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="SendInvitation.htm">SendInvitation Method</A>
<IMG SRC="../../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="SendProtocolMessage.htm">SendProtocolMessage Method</A>
</PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>SendPrivateMessage Method<BR CLEAR=ALL>
<HR></H1>
<P>Sends a private text or data message to one or several users.

<P class=ref>Syntax
<BLOCKQUOTE>
<PRE><I>object</I><B>.SendPrivateMessage</B> <I>PrivateMessageType</I><B>,</B> <I>Message</I><B>,</B> <I>RecipientNicknames</I>[<B>,</B> <I>DataMessageTag</I>] <BR>
</PRE>
</BLOCKQUOTE>

<P class=ref>Parameters
<BLOCKQUOTE>
<TABLE WIDTH=87%>
<TR><TD><I>object</I></TD><TD>Required. An object expression that evaluates to an <A HREF="mschatpr.htm#MsChatPr">MsChatPr</A> control.</TD></TR>
<TR><TD><I>PrivateMessageType</I></TD><TD>Required. A long value that is a combination of some of the <A HREF="enumPrivateMessageType.htm#enumPrivateMessageType">enumPrivateMessageType</A> enumeration values. The values that can be used are:
<TABLE BORDER=0>
<TR><TD><A HREF="enumPrivateMessageType.htm#pmtNormal">pmtNormal</A></TD><TD>&amp;H0.</TD></TR>
<TR><TD><A HREF="enumPrivateMessageType.htm#pmtNotice">pmtNotice</A></TD><TD>&amp;H1.</TD></TR>
<TR><TD><A HREF="enumPrivateMessageType.htm#pmtData">pmtData</A></TD><TD>&amp;H2.</TD></TR>
<TR><TD><A HREF="enumPrivateMessageType.htm#pmtDataRequest">pmtDataRequest</A>&nbsp;&nbsp;&nbsp;</TD><TD>&amp;H4.</TD></TR>
<TR><TD><A HREF="enumPrivateMessageType.htm#pmtDataReply">pmtDataReply</A></TD><TD>&amp;H8.</TD></TR>
<TR><TD><A HREF="enumPrivateMessageType.htm#pmtDataRaw">pmtDataRaw</A></TD><TD>&amp;H10.</TD></TR>
<TR><TD><A HREF="enumPrivateMessageType.htm#pmtVersion">pmtVersion</A></TD><TD>&amp;H40.</TD></TR>
<TR><TD><A HREF="enumPrivateMessageType.htm#pmtLagTime">pmtLagTime</A></TD><TD>&amp;H80.</TD></TR>
<TR><TD><A HREF="enumPrivateMessageType.htm#pmtLocalTime">pmtLocalTime</A></TD><TD>&amp;H100.</TD></TR>
<TR><TD><A HREF="enumPrivateMessageType.htm#pmtAction">pmtAction</A></TD><TD>&amp;H200.</TD></TR>
<TR><TD><A HREF="enumPrivateMessageType.htm#pmtSound">pmtSound</A></TD><TD>&amp;H400.</TD></TR>
<TR><TD><A HREF="enumPrivateMessageType.htm#pmtCTCP">pmtCTCP</A></TD><TD>&amp;H800.</TD></TR>
</TABLE>
<P>Except for <A HREF="enumPrivateMessageType.htm#pmtNormal">pmtNormal</A>, all the above values are mutually exclusive.
 

<P>The valid <I>PrivateMessageType</I> values are:
<TABLE BORDER=0>
<TR><TD>pmtNormal</TD></TR>
<TR><TD>pmtNotice</TD></TR>
<TR><TD>pmtData</TD></TR>
<TR><TD>pmtDataRequest</TD></TR>
<TR><TD>pmtDataReply</TD></TR>
<TR><TD>pmtData + pmtDataRaw</TD></TR>
<TR><TD>pmtDataRequest + pmtDataRaw</TD></TR>
<TR><TD>pmtDataReply + pmtDataRaw</TD></TR>
<TR><TD>pmtVersion + pmtNormal</TD></TR>
<TR><TD>pmtLagTime + pmtNormal</TD></TR>
<TR><TD>pmtLocalTime + pmtNormal</TD></TR>
<TR><TD>pmtAction + pmtNormal</TD></TR>
<TR><TD>pmtSound + pmtNormal</TD></TR>
<TR><TD>pmtCTCP + pmtNormal</TD></TR>
<TR><TD>pmtVersion + pmtNotice</TD></TR>
<TR><TD>pmtLagTime + pmtNotice</TD></TR>
<TR><TD>pmtLocalTime + pmtNotice</TD></TR>
<TR><TD>pmtAction + pmtNotice</TD></TR>
<TR><TD>pmtSound + pmtNotice</TD></TR>
<TR><TD>pmtCTCP + pmtNotice</TD></TABLE></TD></TR>
<TR><TD><I>Message</I></TD><TD>Required. A variant that can be a string, a number, an array of strings, an array of numbers, or an array of variants that can be strings and numbers. The variant types allowed for these numbers are:
<TABLE BORDER=0>
<TR><TD>VT_UI1</TD></TR>
<TR><TD>VT_I2</TD></TR>
<TR><TD>VT_I4</TD></TR>
<TR><TD>VT_R4</TD></TR>
<TR><TD>VT_R8</TD></TR>
<TR><TD>VT_BOOL</TD></TR>
<TR><TD>VT_ERROR</TD></TR>
<TR><TD>VT_CY</TD></TR>
<TR><TD>VT_DATE</TD></TABLE>
<P><I>Message</I> is the actual message to send.</TD></TR>
<TR><TD><I>RecipientNicknames</I></TD><TD>Required. A variant that can be a string, an array of strings, or an array of variants that are strings that represent the recipients' nicknames.</TD></TR>
<TR><TD><I>DataMessageTag</I></TD><TD>Optional. This variant will be a non-empty string when sending data (that is, the <A HREF="enumPrivateMessageType.htm#pmtData">pmtData</A>, <A HREF="enumPrivateMessageType.htm#pmtDataRequest">pmtDataRequest</A>, or <A HREF="enumPrivateMessageType.htm#pmtDataReply">pmtDataReply</A> flag is set). This parameter must be empty or missing in all other cases.</TD></TR>
</TABLE>
</BLOCKQUOTE>

<P class=ref>Remarks
<BLOCKQUOTE>
<P>When sending data and the <A HREF="enumPrivateMessageType.htm#pmtDataRaw">pmtDataRaw</A> flag is not set, the control packages the <I>Message</I> parameter into an array of bytes and uses an internal header to tell the recipients that the message comes from an <A HREF="mschatpr.htm#MsChatPr">MsChatPr</A> control. However, when the <B>pmtDataRaw</B> flag is also set, the <I>Message</I> parameter can only be a postprocessed string, a byte, an array of bytes, or an array of variants that are bytes. A postprocessed string is a string that was modified using the regular conversion scheme.
<TABLE BORDER=0>
<TR><TD><B>Character&nbsp;&nbsp;&nbsp; </B></TD>
<TD><B>Becomes string
 </B></TD>
</TR>
<TR><TD>'\0'</TD>
<TD>"\0"</TD>
</TR>
<TR><TD>'\'</TD>
<TD>"\\"</TD>
</TR>
<TR><TD>'\n'</TD>
<TD>"\n"</TD>
</TR>
<TR><TD>'\r'</TD>
<TD>"\r"</TD>
</TR>
<TR><TD>'\t'</TD>
<TD>"\t"</TD>
</TR>
<TR><TD>' '</TD>
<TD>"\b"</TD>
</TR>
<TR><TD>','</TD>
<TD>"\c"</TD>
</TR>
</TABLE>
<P>When sending raw data, the control simply converts the <I>Message</I> parameter into a 
postprocessed string without using an internal header. This way all clients can handle the data message.
</BLOCKQUOTE>

<P class=ref>Examples
<BLOCKQUOTE>
<P>1. Send a regular string to a user:
<PRE>MsChatPr1.SendPrivateMessage pmtNormal, "Hi there!", "Mila"
</PRE>
<P>2. Send a notice to a user:
<PRE>MsChatPr1.SendPrivateMessage pmtNotice, "Bye now!", "Zorg"
</PRE>
<P>3. Request version information:
<PRE>MsChatPr1.SendPrivateMessage pmtVersion, " ", "Mila"
</PRE>
<P>4. Send version information:
<PRE>MsChatPr1.SendPrivateMessage pmtVersion,"MsChatPr ActiveX Control V2.0 
    used in VB 5.0 Application Chat-oh", "Mila"
</PRE>
<P>5. Request lag time:
<PRE>MsChatPr1.SendPrivateMessage pmtLagTime, CStr(Timer), "Mila"
</PRE>
<P>6. Request local time:
<PRE>MsChatPr1.SendPrivateMessage pmtLocalTime, " ", "Mila"
</PRE>
<P>7. Send an action to a user (CTCP action):
<PRE>MsChatPr1.SendPrivateMessage pmtAction, "is eating couscous....", "Kimmy"
</PRE>
<P>8. Send a sound to a user (CTCP sound):
<PRE>MsChatPr1.SendPrivateMessage pmtSound, "couscous.wav Isn't that cool?", "Kimmy"
</PRE>
<P>9. Send a CTCP message to a user:
<PRE>MsChatPr1.SendPrivateMessage pmtCTCP, "FINGER", "Mila"
</PRE>
<P>10. Send text to several users:
<PRE>Dim strRecipients(1 To 3) As String
strRecipients(1) = "Charlotte"
strRecipients(2) = "Zorg"
strRecipients(3) = "Arthur"
MsChatPr1.SendPrivateMessage pmtNormal, "I'm a cook too...", strRecipients&#009;
'or
Dim vRecipients(1 To 3) As Variant
vRecipients(1) = "Charlotte"
vRecipients(2) = "Zorg"
vRecipients(3) = "Arthur"
MsChatPr1.SendPrivateMessage pmtNormal, "I'm a cook too...", vRecipients
</PRE>
<P>11. Send a string as data to a user:
<PRE>MsChatPr1.SendPrivateMessage pmtData, "And a painter as well.", "Mila", "_FOO_"
</PRE>
<P>12. Send a number to a user:
<PRE>MsChatPr1.SendPrivateMessage pmtData, 1156, "Charlotte", "X"
</PRE>
<P>13. Send an array of numbers to users:
<PRE>Dim iValues(1 To 4) As Integer
iValues(1) = 10
iValues(2) = -22
iValues(3) = 123
iValues(4) = 0
Dim strRecipients(1 To 3) As String
strRecipients(1) = "Charlotte"
strRecipients(2) = "Zorg"
strRecipients(3) = "Arthur"
MsChatPr1.SendPrivateMessage pmtData, iValues, strRecipients, "COORD"
'or 
Dim vValues(1 To 4) As Variant
vValues(1) = 10
vValues(2) = -22
vValues(3) = 123
vValues(4) = 0
Dim vRecipients(1 To 3) As Variant
vRecipients(1) = "Charlotte"
vRecipients(2) = "Zorg"
vRecipients(3) = "Arthur"
MsChatPr1.SendPrivateMessage pmtData, vValues, vRecipients, "COORD"
</PRE>
<P>14. Send an array of strings to a user:
<PRE>Dim strValues(1 To 4) As String
strValues(1) = "Blue"
strValues(2) = "Green"
strValues(3) = "Red"
strValues(4) = "White"
MsChatPr1.SendPrivateMessage pmtData, strValues, "Prout", "COLORS"
'or 
Dim vValues(1 To 4) As Variant
vValues(1) = "Blue"
vValues(2) = "Green"
vValues(3) = "Red"
vValues(4) = "White"
MsChatPr1.SendPrivateMessage pmtData, vValues, "Prout", "COLORS"
</PRE>
<P>15. Send an array of variants to a user:
<PRE>Dim vValues(5 To 10) As Variant
vVariant(5) = Now
vVariant(6) = "Your turn to play...."
vVariant(7) = -10
vVariant(8) = 5
vVariant(9) = -12.689
vVariant(10) = 9876582146
MsChatPr1.SendPrivateMessage pmtData, vValues, "Zoulou", "TheHugeOne"
</PRE>
<P>16. Send raw data to a user:
<PRE>'A postprocessed string
MsChatPr1.SendPrivateMessage pmtData + pmtDataRaw, "dhe\rotk\\nsk\0k45v\0zxa\\v", 
    "Arthur", "ProcessedString"
'One byte
Dim byt As Byte
byt = 56
MsChatPr1.SendPrivateMessage pmtData + pmtDataRaw,byt, "Arthur", "OneByte"
'An array of bytes
Dim rgBytes(1 To 3) As Byte
rgBytes(1) = 15
rgBytes(2) = 98
rgBytes(3) = 2
MsChatPr1.SendPrivateMessage pmtData + pmtDataRaw,
    rgBytes, "Arthur", "ArrayOfBytes"
'An array of Variants that are bytes
Dim vByt(1 To 3) As Variant
vByt(1) = CByte(15)
vByt(2) = CByte(98)
vByt(3) = CByte(2)
MsChatPr1.SendPrivateMessage pmtData + pmtDataRaw, vByt, "Arthur", 
    "ArrayOfVariants"
</PRE>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>
