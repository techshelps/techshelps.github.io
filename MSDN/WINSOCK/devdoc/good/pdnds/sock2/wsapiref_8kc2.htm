<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WSAConnect</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_wsaconnect_2"></a>WSAConnect</h1>
<p>
The Windows Sockets <b>WSAConnect</b> function establishes a connection to another socket application, exchanges connect data, and specifies needed quality of service based on the supplied <b>FLOWSPEC</b> structure.</p>
<pre><code><b>int  WSAConnect (
  SOCKET</b><i> s</i><b>,                          </b>
<b>  const struct sockaddr FAR *</b><i> name</i><b>,  </b>
<b>  int</b><i> namelen</i><b>,                       </b>
<b>  LPWSABUF</b><i> lpCallerData</i><b>,             </b>
<b>  LPWSABUF</b><i> lpCalleeData</i><b>,             </b>
<b>  LPQOS</b><i> lpSQOS</i><b>,                      </b>
<b>  LPQOS</b><i> lpGQOS                       </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>s</i></dt>
<dd>
[in] A descriptor identifying an unconnected socket.</dd>
<dt>
<i>name</i></dt>
<dd>
[in] The name of the socket in the other application to which to connect.</dd>
<dt>
<i>namelen</i></dt>
<dd>
[in] The length of the <i>name</i>.</dd>
<dt>
<i>lpCallerData</i></dt>
<dd>
[in] A pointer to the user data that is to be transferred to the other socket during connection establishment.</dd>
<dt>
<i>lpCalleeData</i></dt>
<dd>
[out] A pointer to the user data that is to be transferred back from the other socket during connection establishment.</dd>
<dt>
<i>lpSQOS</i></dt>
<dd>
[in] A pointer to the <b>FLOWSPEC</b> structures for socket <i>s</i>, one for each direction.</dd>
<dt>
<i>lpGQOS</i></dt>
<dd>
[in] Reserved for future use with socket groups. A pointer to the <b>FLOWSPEC</b> structures for the socket group (if applicable).
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>WSAConnect</b> function is used to create a connection to the specified destination, and to perform a number of other ancillary operations that occur at connect time. If the socket, <i>s</i>, is unbound, unique values are assigned to the local association by the system, and the socket is marked as bound.</p>
<p>
For connection-oriented sockets (for example, type SOCK_STREAM), an active connection is initiated to the foreign host using <i>name</i> (an address in the name space of the socket; for a detailed description, please see <a href="wsapiref_6vzm.htm"><b>bind</b></a>). When this call completes successfully, the socket is ready to send/receive data. If the address field of the <i>name</i> structure is all zeroes, <b>WSAConnect</b> will return the error WSAEADDRNOTAVAIL. Any attempt to reconnect an active connection will fail with the error code WSAEISCONN.</p>
<p>
For connection-oriented, nonblocking sockets, it is often not possible to complete the connection immediately. In such cases, this function returns the error WSAEWOULDBLOCK. However, the operation proceeds.  When the success or failure outcome becomes known, it may be reported in one of several ways depending on how the client registers for notification.  If the client uses <a href="wsapiref_1ab6.htm"><b>select</b></a>, success is reported in the <i>writefds</i> set and failure is reported in the <i>exceptfds</i> set. If the client uses <a href="wsapiref_6jn6.htm"><b>WSAAsyncSelect</b></a> or <a href="wsapiref_34aa.htm"><b>WSAEventSelect</b></a>, the notification is announced with FD_CONNECT and the error code associated with the FD_CONNECT indicates either success or a specific reason for failure.</p>
<p>
For a connectionless socket (for example, type SOCK_DGRAM), the operation erformed by <b>WSAConnect</b> is merely to establish a default destination address so that the socket can be used on subsequent connection-oriented send and receive operations (<a href="wsapiref_6quq.htm"><b>send</b></a><b>, <a href="wsapiref_97n6.htm">WSASend</a>, <a href="wsapiref_2i9e.htm">recv</a>, </b>and <a href="wsapiref_4z1u.htm"><b>WSARecv</b></a>). Any datagrams received from an address other than the destination address specified will be discarded. If the address field of the <i>name</i> structure is all zeroes, the socket will be disconnected. Then, the default remote address will be indeterminate, so <b>send/WSASend</b> and <b>recv/WSARecv</b> calls will return the error code WSAENOTCONN. However, <b>sendto/WSASendTo</b> and <b>recvfrom/WSARecvFrom</b> can still be used. The default destination can be changed by simply calling <b>WSAConnect</b> again, even if the socket is already "connected". Any datagrams queued for receipt are discarded if <i>name</i> is different from the previous <b>WSAConnect</b>.</p>
<p>
For connectionless sockets, <i>name</i> can indicate any valid address, including a broadcast address. However, to connect to a broadcast address, a socket must have <a href="wsapiref_94aa.htm"><b>setsockopt</b></a> SO_BROADCAST enabled. Otherwise, <b>WSAConnect</b> will fail with the error code WSAEACCES.</p>
<p>
On connectionless sockets, exchange of user-to-user data is not possible and the corresponding parameters will be silently ignored.</p>
<p>
The application is responsible for allocating any memory space pointed to directly or indirectly by any of the parameters it specifies.</p>
<p>
The <i>lpCallerData</i> is a value parameter that contains any user data that is to be sent along with the connection request. If <i>lpCallerData</i> is NULL, no user data will be passed to the peer. The <i>lpCalleeData</i> is a result parameter that will contain any user data passed back from the other socket as part of the connection establishment in a <a href="strucetc_5ape.htm"><b>WSABUF</b></a> structure. The member <i>lpCalleeData-&gt;len</i> initially contains the length of the buffer allocated by the application and pointed to by <i>lpCalleeData-&gt;buf</i>. <i>lpCalleeData-&gt;len</i> will be set to zero if no user data has been passed back. The <i>lpCalleeData </i>information will be valid when the connection operation is complete. For blocking sockets, the connection operation completes when the <b>WSAConnect</b> function returns. For nonblocking sockets, completion will be after the FD_CONNECT notification has occurred. If <i>lpCalleeData</i> is NULL, no user data will be passed back. The exact format of the user data is specific to the address family to which the socket belongs.</p>
<p>
At connect time, an application can use the <i>lpSQOS</i> and <i>lpGQOS</i> parameters to override any previous quality of service specification made for the socket through <a href="wsapiref_6ik2.htm"><b>WSAIoctl</b></a> with either the SIO_SET_QOS or SIO_SET_GROUP_QOS opcodes.</p>
<p>
<i>lpSQOS</i> specifies the <b>FLOWSPEC</b> structures for socket <i>s</i>, one for each direction, followed by any additional provider-specific parameters. If either the associated transport provider in general or the specific type of socket in particular cannot honor the quality of service request, an error will be returned as indicated below. The sending or receiving flow specification values will be ignored, respectively, for any unidirectional sockets. If no provider-specific parameters are supplied, the <i>buf</i> and <i>len</i> fields of <i>lpSQOS-&gt;ProviderSpecific</i> should be set to NULL and zero, respectively. A NULL value for <i>lpSQOS</i> indicates no application supplied quaility of service.</p>
<p>
Reserved for future use with socket groups<i>, lpGQOS</i> specifies the <b>FLOWSPEC</b> structures for the socket group (if applicable), one for each direction, followed by any additional provider-specific parameters. If no provider-specific parameters are supplied, the <i>buf</i> and <i>len</i> fields of <i>lpGQOS-&gt;ProviderSpecific</i> should be set to NULL and zero, respectively. A NULL value for <i>lpGQOS</i> indicates no application-supplied group quality of service. This parameter will be ignored if <i>s</i> is not the creator of the socket group.</p>
<p>
When connected sockets become closed for whatever reason, they should be discarded and recreated. It is safest to assume that when things go awry for any reason on a connected socket, the application must discard and recreate the needed sockets in order to return to a stable point.</p>
<h4>Return Values</h4>
<p>
If no error occurs, <b>WSAConnect</b> returns zero. Otherwise, it returns SOCKET_ERROR, and a specific error code can be retrieved by calling <a href="wsapiref_2tiq.htm"><b>WSAGetLastError</b></a>. On a blocking socket, the return value indicates success or failure of the connection attempt.</p>
<p>
With a nonblocking socket, the connection attempt can not be completed immediately. In this case, <b>WSAConnect</b> will return SOCKET_ERROR, and <b>WSAGetLastError</b> will return WSAEWOULDBLOCK. In this case, the application can:
<ol>
<li>
Use <a href="wsapiref_1ab6.htm"><b>select</b></a> to determine the completion of the connection request by checking if the socket is writeable.</li>
<li>
If your application is using <a href="wsapiref_6jn6.htm"><b>WSAAsyncSelect</b></a> to indicate interest in connection events, then your application will receive an FD_CONNECT notification when the connect operation is complete(successful or not).</li>
<li>
If your application is using <a href="wsapiref_34aa.htm"><b>WSAEventSelect</b></a> to indicate interest in connection events, then the associated event object will be signaled when the connect operation is complete (successful or not).</li>
</ol>
<p>
For a nonblocking socket, until the connection attempt completes all subsequent calls to <b>WSAConnect</b> on the same socket will fail with the error code WSAEALREADY.</p>
<p>
If the return error code indicates the connection attempt failed (that is, WSAECONNREFUSED, WSAENETUNREACH, WSAETIMEDOUT) the application can call <b>WSAConnect</b> again for the same socket.</p>
<h4>Error Codes</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=46%>WSANOTINITIALISED</td>
<td width=54%>A successful <a href="wsapiref_1v8y.htm"><b>WSAStartup</b></a> must occur before using this function.</td>
</tr>
<tr valign=top>
<td width=46%>WSAENETDOWN</td>
<td width=54%>The network subsystem has failed.</td>
</tr>
<tr valign=top>
<td width=46%>WSAEADDRINUSE</td>
<td width=54%>The local address of the socket is already in use and the socket was not marked to allow address reuse with SO_REUSEADDR. This error usually occurs during the execution of <a href="wsapiref_6vzm.htm"><b>bind</b></a>, but could be delayed until this function if the <b>bind</b> function operates on a partially wild-card address (involving ADDR_ANY) and if a specific address needs to be "committed" at the time of this function.</td>
</tr>
<tr valign=top>
<td width=46%>WSAEINTR</td>
<td width=54%>The (blocking) Windows Socket 1.1 call was canceled through <a href="wsapiref_704y.htm"><b>WSACancelBlockingCall</b></a>.</td>
</tr>
<tr valign=top>
<td width=46%>WSAEINPROGRESS</td>
<td width=54%>A blocking Windows Sockets 1.1 call is in progress, or the service provider is still processing a callback function.</td>
</tr>
<tr valign=top>
<td width=46%>WSAEALREADY</td>
<td width=54%>A nonblocking <a href="wsapiref_8m7m.htm"><b>connect</b></a><b>/<a href="#_win32_wsaconnect_2">WSAConnect</a></b> call is in progress on the specified socket.</td>
</tr>
<tr valign=top>
<td width=46%>WSAEADDRNOTAVAIL</td>
<td width=54%>The remote address is not a valid address (such as ADDR_ANY).</td>
</tr>
<tr valign=top>
<td width=46%>WSAEAFNOSUPPORT</td>
<td width=54%>Addresses in the specified family cannot be used with this socket.</td>
</tr>
<tr valign=top>
<td width=46%>WSAECONNREFUSED</td>
<td width=54%>The attempt to connect was rejected.</td>
</tr>
<tr valign=top>
<td width=46%>WSAEFAULT</td>
<td width=54%>The <i>name </i>or the <i>namelen </i>parameter is not a valid part of the user address space, the <i>namelen</i> parameter is too small, the buffer length for <i>lpCalleeData</i>, <i>lpSQOS</i>, and <i>lpGQOS</i> are too small, or the buffer length for <i>lpCallerData</i> is too large.</td>
</tr>
<tr valign=top>
<td width=46%>WSAEINVAL</td>
<td width=54%>The parameter <i>s</i> is a listening socket, or the destination address specified is not consistent with that of the constrained group the socket belongs to.</td>
</tr>
<tr valign=top>
<td width=46%>WSAEISCONN</td>
<td width=54%>The socket is already connected (connection-oriented sockets only).</td>
</tr>
<tr valign=top>
<td width=46%>WSAENETUNREACH</td>
<td width=54%>The network cannot be reached from this host at this time.</td>
</tr>
<tr valign=top>
<td width=46%>WSAENOBUFS</td>
<td width=54%>No buffer space is available. The socket cannot be connected.</td>
</tr>
<tr valign=top>
<td width=46%>WSAENOTSOCK</td>
<td width=54%>The descriptor is not a socket.</td>
</tr>
<tr valign=top>
<td width=46%>WSAEOPNOTSUPP</td>
<td width=54%>The <a href="strucetc_77qq.htm"><b>FLOWSPEC</b></a> structures specified in <i>lpSQOS</i> and <i>lpGQOS</i> cannot be satisfied.</td>
</tr>
<tr valign=top>
<td width=46%>WSAEPROTONOSUPPORT</td>
<td width=54%>The <i>lpCallerData</i> argument is not supported by the service provider.</td>
</tr>
<tr valign=top>
<td width=46%>WSAETIMEDOUT</td>
<td width=54%>Attempt to connect timed out without establishing a connection.</td>
</tr>
<tr valign=top>
<td width=46%>WSAEWOULDBLOCK </td>
<td width=54%>The socket is marked as nonblocking and the connection cannot be completed immediately.</td>
</tr>
<tr valign=top>
<td width=46%>WSAEACCES</td>
<td width=54%>Attempt to connect datagram socket to broadcast address failed because <a href="wsapiref_94aa.htm"><b>setsockopt</b></a> SO_BROADCAST is not enabled.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Yes<br>
&nbsp;&nbsp;<b>Windows:</b> Yes<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in winsock2.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with ws2_32.lib.</p>
<h4>See Also</h4>
<p>
<a href="wsapiref_13aq.htm"><b>accept</b></a>, <a href="wsapiref_6vzm.htm"><b>bind</b></a>, <a href="wsapiref_8m7m.htm"><b>connect</b></a>, <a href="wsapiref_273m.htm"><b>getsockname</b></a>, <a href="wsapiref_8qcy.htm"><b>getsockopt</b></a>, <a href="wsapiref_1ab6.htm"><b>select</b></a>, <a href="wsapiref_2qr6.htm"><b>socket</b></a>, <a href="wsapiref_6jn6.htm"><b>WSAAsyncSelect</b></a>, <a href="wsapiref_34aa.htm"><b>WSAEventSelect</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
