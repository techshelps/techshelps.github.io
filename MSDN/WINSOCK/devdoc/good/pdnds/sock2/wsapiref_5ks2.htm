<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetAddressByName</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_getaddressbyname_2"></a>GetAddressByName</h1>
<p>
<b>Important</b>  The <b>GetAddressByName</b> function is a Microsoft-specific extension to the Windows Sockets 1.1 specification. This function is obsolete. For the convenience of Windows Sockets 1.1 developers, the reference material is below.</p>
<p>
The functions detailed in <a href="ovrvw4_6po2.htm"><i>Protocol-Independent Name Resolution</i></a> provide equivalent functionality in Windows Sockets 2.</p>
<p>
The <b>GetAddressByName</b> function queries a name space, or a set of default name spaces, in order to obtain network address information for a specified network service. This process is known as service name resolution. A network service can also use the function to obtain local address information that it can use with the <b>bind</b> function. </p>
<pre><code><b>INT GetAddressByName(
  DWORD</b><i> dwNameSpace</i><b>,     </b>// name space to query for service address 
                         // information
<b>  LPGUID</b><i> lpServiceType</i><b>,  </b>// the type of the service
<b>  LPTSTR</b><i> lpServiceName</i><b>,  </b>// the name of the service
<b>  LPINT</b><i> lpiProtocols</i><b>,    </b>// points to array of protocol identifiers
<b>  DWORD</b><i> dwResolution</i><b>,    </b>// set of bit flags that specify aspects of 
                         // name resolution
<b>  LPSERVICE_ASYNC_INFO</b><i> lpServiceAsyncInfo</i><b>,</b>
<b>                         </b>// reserved for future use, must be NULL
<b>  LPVOID</b><i> lpCsaddrBuffer</i><b>, </b>// points to buffer to receive address 
                         // information
<b>  LPDWORD</b><i> lpdwBufferLength</i><b>,  </b>// points to variable with address 
                             // buffer size information
<b>  LPTSTR</b><i> lpAliasBuffer</i><b>,  </b>// points to buffer to receive alias 
                         // information
<b>  LPDWORD</b><i> lpdwAliasBufferLength</i> 
                         // points to variable with alias buffer 
                         // size information
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwNameSpace</i></dt>
<dd>
Specifies the name space, or a set of default name spaces, that the operating system will query for network address information. 
<p>
Use one of the following constants to specify a name space:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Value</th>
<th align=left width=64%>Name Space</th>
</tr>
<tr valign=top>
<td width=36%>NS_DEFAULT</td>
<td width=64%>A set of default name spaces. The function queries each name space within this set. The set of default name spaces typically includes all the name spaces installed on the system. System administrators, however, can exclude particular name spaces from the set. This is the value that most applications should use for <i>dwNameSpace</i>.</td>
</tr>
<tr valign=top>
<td width=36%>NS_DNS</td>
<td width=64%>The Domain Name System used in the Internet for host name resolution.</td>
</tr>
<tr valign=top>
<td width=36%>NS_NETBT</td>
<td width=64%>The NetBIOS over TCP/IP layer. All Windows NT systems register their computer names with NetBIOS. This name space is used to convert a computer name to an IP address that uses this registration. Note that NS_NETBT can access a WINS server to perform the resolution.</td>
</tr>
<tr valign=top>
<td width=36%>NS_SAP</td>
<td width=64%>The Netware Service Advertising Protocol. This can access the Netware bindery if appropriate. NS_SAP is a dynamic name space that allows registration of services.</td>
</tr>
<tr valign=top>
<td width=36%>NS_TCPIP_HOSTS</td>
<td width=64%>Lookup value in the &lt;systemroot&gt;\system32\drivers\etc\hosts file.</td>
</tr>
<tr valign=top>
<td width=36%>NS_TCPIP_LOCAL</td>
<td width=64%>Local TCP/IP name resolution mechanisms, including comparisons against the local host name and looks up host names and IP addresses in cache of host to IP address mappings.</td>
</tr>
</table><br>


<p>
Most calls to <b>GetAddressByName</b> should use the special value NS_DEFAULT. This lets a client get by with no knowledge of which name spaces are available on an internetwork. The system administrator determines name space access. Name spaces can come and go without the client having to be aware of the changes.
</dd>
<dt>
<i>lpServiceType</i></dt>
<dd>
Points to a globally unique identifier (<b>GUID</b>) that specifies the type of the network service. The header file SVCGUID.H includes definitions of several <b>GUID </b>service types, and macros for working with them.</dd>
<dt>
<i>lpServiceName</i></dt>
<dd>
Points to a zero-terminated string that uniquely represents the service name. For example, "MY SNA SERVER".
<p>
Setting <i>lpServiceName</i> to NULL is the equivalent of setting <i>dwResolution</i> to RES_SERVICE. The function operates in its second mode, obtaining the local address to which a service of the specified type should bind. The function stores the local address within the <b>LocalAddr</b> member of the <a href="strucetc_4zua.htm"><b>CSADDR_INFO</b></a> structures stored into *<i>lpCsaddrBuffer</i>.

<p>
If <i>dwResolution</i> is set to RES_SERVICE, the function ignores the <i>lpServiceName</i> parameter.

<p>
If <i>dwNameSpace</i> is set to NS_DNS, *<i>lpServiceName</i> is the name of the host. 
</dd>
<dt>
<i>lpiProtocols</i></dt>
<dd>
Points to a zero-terminated array of protocol identifiers. The function restricts a name resolution attempt to name space providers that offer these protocols. This lets the caller limit the scope of the search.
<p>
If <i>lpiProtocols</i> is NULL, the function obtains information on all available protocols.
</dd>
<dt>
<i>dwResolution</i></dt>
<dd>
A set of bit flags that specify aspects of the service name resolution process. The following bit flags are defined:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=37%>Value</th>
<th align=left width=63%>Meaning</th>
</tr>
<tr valign=top>
<td width=37%>RES_SERVICE</td>
<td width=63%>If this flag is set, the function obtains the address to which a service of the specified type should bind. This is the equivalent of setting <i>lpServiceName</i> to NULL.<p>
If this flag is clear, normal name resolution occurs. </p>
</td>
</tr>
<tr valign=top>
<td width=37%>RES_FIND_MULTIPLE</td>
<td width=63%>If this flag is set, the operating system performs an extensive search of all name spaces for the service. It will ask every appropriate name space to resolve the service name. If this flag is clear, the operating system stops looking for service addresses as soon as one is found. </td>
</tr>
<tr valign=top>
<td width=37%>RES_SOFT_SEARCH</td>
<td width=63%>This flag is valid if the name space supports multiple levels of searching.<p>
If this flag is valid and set, the operating system performs a simple and quick search of the name space. This is useful if an application only needs to obtain easy-to-find addresses for the service.</p>
<p>
If this flag is valid and clear, the operating system performs a more extensive search of the name space. </p>
</td>
</tr>
</table><br>

</dd>
<dt>
<i>lplpServiceAsyncInfo</i></dt>
<dd>
Reserved for future use; must be set to NULL. </dd>
<dt>
<i>lpCsaddrBuffer</i></dt>
<dd>
Points to a buffer to receive one or more <a href="strucetc_4zua.htm"><b>CSADDR_INFO</b></a><b> </b>data structures. The number of structures written to the buffer depends on the amount of information found in the resolution attempt. You should assume that multiple structures will be written, although in many cases there will only be one. </dd>
<dt>
<i>lpdwBufferLength</i></dt>
<dd>
Points to a variable that, upon input, specifies the size, in bytes, of the buffer pointed to by <i>lpCsaddrBuffer</i>. 
<p>
Upon output, this variable contains the total number of bytes required to store the array of <b>CSADDR_INFO</b> structures. If this value is less than or equal to the input value of *<i>lpdwBufferLength</i>, and the function is successful, this is the number of bytes actually stored in the buffer. If this value is greater than the input value of *<i>lpdwBufferLength</i>, the buffer was too small, and the output value of *<i>lpdwBufferLength</i> is the minimal required buffer size.
</dd>
<dt>
<i>lpAliasBuffer</i></dt>
<dd>
Points to a buffer to receive alias information for the network service. 
<p>
If a name space supports aliases, the function stores an array of zero-terminated name strings into the buffer pointed to by <i>lpAliasBuffer</i>. There is a double zero-terminator at the end of the list. The first name in the array is the service's primary name. Names that follow are aliases. An example of a name space that supports aliases is DNS.

<p>
If a name space does not support aliases, it stores a double zero-terminator into the buffer.

<p>
This parameter is optional, and can be set to NULL.
</dd>
<dt>
<i>lpdwAliasBufferLength</i></dt>
<dd>
Points to a variable that, upon input, specifies the size, in bytes, of the buffer pointed to by <i>lpAliasBuffer</i>. 
<p>
Upon output, this variable contains the total number of bytes required to store the array of name strings. If this value is less than or equal to the input value of *<i>lpdwAliasBufferLength</i>, and the function is successful, this is the number of bytes actually stored in the buffer. If this value is greater than the input value of *<i>lpdwAliasBufferLength</i>, the buffer was too small, and the output value of *<i>lpdwAliasBufferLength</i> is the minimal required buffer size.

<p>
If <i>lpAliasBuffer</i> is NULL, <i>lpdwAliasBufferLength</i> is meaningless and can also be NULL.

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the number of <b>CSADDR_INFO </b>data structures written to the buffer pointed to by <i>lpCsaddrBuffer</i>.</p>
<p>
If the function fails, the return value is SOCKET_ERROR( – 1). To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. <b>GetLastError </b>can return the following extended error value:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=49%>Value</th>
<th align=left width=51%>Meaning</th>
</tr>
<tr valign=top>
<td width=49%>ERROR_INSUFFICIENT_BUFFER</td>
<td width=51%>The buffer pointed to by <i>lpCsaddrBuffer</i> was too small to receive all of the relevant <b>CSADDR_INFO</b> structures. Call the function with a buffer at least as large as the value returned in *<i>lpdwBufferLength</i>.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
This function is a more powerful version of the Windows Sockets function <a href="wsapiref_0q5u.htm"><b>gethostbyname</b></a> The <b>GetAddressByName</b> function works with multiple name services. </p>
<p>
The <b>GetAddressByName</b> function lets a client obtain a Windows Sockets address for a network service. The client specifies the service of interest by its service type and service name.</p>
<p>
Many name services support a default prefix or suffix that the name service provider considers when resolving service names. For example, in the DNS name space, if a domain is named "nt.microsoft.com", and "ftp millikan" is provided as input, the DNS software fails to resolve "millikan", but successfully resolves "millikan.nt.microsoft.com". </p>
<p>
Note that the <b>GetAddressByName</b> function can search for a service address in two ways: within a particular name space, or within a set of default name spaces. Using a default name space, an administrator can specify that certain name spaces will be searched for service addresses only if specified by name. An administrator or name space setup program can also control the ordering of name space searches. </p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Yes<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in nspapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with wsock32.lib.</p>
<h4>See Also</h4>
<p>
<a href="wsapiref_0q5u.htm"><b>gethostbyname</b></a>, <a href="strucetc_4zua.htm"><b>CSADDR_INFO</b></a></p>
<p>&nbsp;</p></body>
</HTML>
