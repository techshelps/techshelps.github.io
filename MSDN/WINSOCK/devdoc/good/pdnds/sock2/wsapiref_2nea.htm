<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetService</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_setservice_2"></a>SetService</h1>
<p>
<b>Important</b>  The <b>SetService</b> function is obsolete. For the convenience of Windows Sockets 1.1 developers, the reference material is below.</p>
<p>
The functions detailed in <a href="ovrvw4_6po2.htm"><i>Protocol-Independent Name Resolution</i></a> provide equivalent functionality in Windows Sockets 2.</p>
<p>
The <b>SetService</b> function registers or deregisters a network service within one or more name spaces. The function can also add or remove a network service type within one or more name spaces.</p>
<pre><code><b>INT SetService(
  DWORD</b><i> dwNameSpace</i><b>,  </b>// specifies name space(s) to operate within
<b>  DWORD</b><i> dwOperation</i><b>,  </b>// specifies operation to perform
<b>  DWORD</b><i> dwFlags</i><b>,      </b>// set of bit flags that modify function 
                      // operation
<b>  LPSERVICE_INFO</b><i> lpServiceInfo</i><b>,</b>
<b>                      </b>// points to structure containing service 
                      // information
<b>  LPSERVICE_ASYNC_INFO</b><i> lpServiceAsyncInfo</i><b>,</b>
<b>                      </b>// reserved for future use, must be NULL
<b>  LPDWORD</b><i> lpdwStatusFlags</i> 
                      // points to set of status bit flags
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwNameSpace</i></dt>
<dd>
The name space, or a set of default name spaces, within which the function will operate. 
<p>
Use one of the following constants to specify a name space:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=39%>Value</th>
<th align=left width=61%>Name Space</th>
</tr>
<tr valign=top>
<td width=39%>NS_DEFAULT</td>
<td width=61%>A set of default name spaces. The function queries each name space within this set. The set of default name spaces typically includes all the name spaces installed on the system. System administrators, however, can exclude particular name spaces from the set. NS_DEFAULT is the value that most applications should use for <i>dwNameSpace</i>.  </td>
</tr>
<tr valign=top>
<td width=39%>NS_DNS</td>
<td width=61%>The Domain Name System used in the Internet to resolve the name of the host.</td>
</tr>
<tr valign=top>
<td width=39%>NS_NDS</td>
<td width=61%>The NetWare 4 provider.</td>
</tr>
<tr valign=top>
<td width=39%>NS_NETBT</td>
<td width=61%>The NetBIOS over TCP/IP layer. All Windows NT and Windows 95 systems register their computer names with NetBIOS. This name space is used to convert a computer name to an IP address that uses this registration.</td>
</tr>
<tr valign=top>
<td width=39%>NS_SAP</td>
<td width=61%>The NetWare Service Advertising Protocol. This can access the Netware bindery, if appropriate. NS_SAP is a dynamic name space that enables the registration of services. </td>
</tr>
<tr valign=top>
<td width=39%>NS_TCPIP_HOSTS</td>
<td width=61%>Lookup value in the &lt;systemroot&gt;\system32\drivers\etc\posts file.</td>
</tr>
<tr valign=top>
<td width=39%>NS_TCPIP_LOCAL</td>
<td width=61%>Local TCP/IP name resolution mechanisms, including comparisons against the local host name and lookup value in the cache of host to IP address mappings.</td>
</tr>
</table><br>

</dd>
<dt>
<i>dwOperation</i></dt>
<dd>
Specifies the operation that the function will perform. Use one of the following values to specify an operation: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=39%>Value</th>
<th align=left width=61%>Meaning</th>
</tr>
<tr valign=top>
<td width=39%>SERVICE_REGISTER</td>
<td width=61%>Register the network service with the name space. This operation can be used with the SERVICE_FLAG_DEFER and SERVICE_FLAG_HARD bit flags.</td>
</tr>
<tr valign=top>
<td width=39%>SERVICE_DEREGISTER</td>
<td width=61%>Deregister the network service from the name space. This operation can be used with the SERVICE_FLAG_DEFER and SERVICE_FLAG_HARD bit flags.</td>
</tr>
<tr valign=top>
<td width=39%>SERVICE_FLUSH</td>
<td width=61%>Perform any operation that was called with the SERVICE_FLAG_DEFER bit flag set to one.  </td>
</tr>
<tr valign=top>
<td width=39%>SERVICE_ADD_TYPE</td>
<td width=61%>Add a service type to the name space. <p>
For this operation, use the <b>ServiceSpecificInfo</b> member of the <a href="strucetc_822a.htm"><b>SERVICE_INFO</b></a> structure pointed to by <i>lpServiceInfo</i> to pass a <a href="strucetc_1pf6.htm"><b>SERVICE_TYPE_INFO_ABS</b></a> structure. You must also set the <b>ServiceType</b> member of the <b>SERVICE_INFO </b>structure. Other <b>SERVICE_INFO </b>members are ignored.</p>
</td>
</tr>
<tr valign=top>
<td width=39%>SERVICE_DELETE_TYPE</td>
<td width=61%>Remove a service type, added by a previous call specifying the SERVICE_ADD_TYPE operation, from the name space. </td>
</tr>
</table><br>

</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
A set of bit flags that modify the function's operation. You can set one or more of the following bit flags:  
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=39%>Value</th>
<th align=left width=61%>Name Space</th>
</tr>
<tr valign=top>
<td width=39%>SERVICE_FLAG_DEFER</td>
<td width=61%>This bit flag is valid only if the operation is SERVICE_REGISTER or SERVICE_DEREGISTER.<p>
If this bit flag is one, and it is valid, the name-space provider should defer the registration or deregistration operation until a SERVICE_FLUSH operation is requested.</p>
</td>
</tr>
<tr valign=top>
<td width=39%>SERVICE_FLAG_HARD</td>
<td width=61%>This bit flag is valid only if the operation is SERVICE_REGISTER or SERVICE_DEREGISTER.<p>
If this bit flag is one, and it is valid, the name-space provider updates any relevant persistent store information when the operation is performed. </p>
<p>
For example: If the operation involves deregistration in a name space that uses a persistent store, the name-space provider would remove the relevant persistent store information. </p>
</td>
</tr>
</table><br>

</dd>
<dt>
<i>lpService_Info</i></dt>
<dd>
Points to a <a href="strucetc_822a.htm"><b>SERVICE_INFO</b></a> structure that contains information about the network service or service type.</dd>
<dt>
<i>lpServiceAsyncInfo</i></dt>
<dd>
This parameter is reserved for future use. It must be set to NULL.</dd>
<dt>
<i>lpdwStatusFlags</i></dt>
<dd>
A set of bit flags that receive function status information. The following bit flag is defined:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=51%>Value</th>
<th align=left width=49%>Meaning</th>
</tr>
<tr valign=top>
<td width=51%>SET_SERVICE_PARTIAL_SUCCESS</td>
<td width=49%>One or more name-space providers were unable to successfully perform the requested operation.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is not SOCKET_ERROR.  </p>
<p>
If the function fails, the return value is SOCKET_ERROR. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. <b>GetLastError</b> can return the following extended error value:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=53%>Value</th>
<th align=left width=47%>Meaning</th>
</tr>
<tr valign=top>
<td width=53%>ERROR_ALREADY_REGISTERED</td>
<td width=47%>The function tried to register a service that was already registered.   </td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Yes<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in nspapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with wsock32.lib.</p>
<h4>See Also</h4>
<p>
<a href="wsapiref_29gy.htm"><b>GetService</b></a>, <a href="strucetc_822a.htm"><b>SERVICE_INFO</b></a>, <a href="strucetc_1pf6.htm"><b>SERVICE_TYPE_INFO_ABS</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
