<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>select</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_select_2"></a>select</h1>
<p>
The Windows Sockets <b>select</b> function determines the status of one or more sockets, waiting if necessary, to perform synchronous I/O.</p>
<pre><code><b>int select (
  int</b><i> nfds</i><b>,                           </b>
<b>  fd_set FAR *</b><i> readfds</i><b>,               </b>
<b>  fd_set FAR *</b><i> writefds</i><b>,              </b>
<b>  fd_set FAR *</b><i> exceptfds</i><b>,             </b>
<b>  const struct timeval FAR *</b><i> timeout  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>nfds</i></dt>
<dd>
[in] This parameter is ignored; it is included only for compatibility with Berkeley sockets.</dd>
<dt>
<i>readfds</i></dt>
<dd>
[in/out] An optional pointer to a set of sockets to be checked for readability.</dd>
<dt>
<i>writefds</i></dt>
<dd>
[in/out] An optional pointer to a set of sockets to be checked for writability</dd>
<dt>
<i>exceptfds</i></dt>
<dd>
[in/out] An optional pointer to a set of sockets to be checked for errors.</dd>
<dt>
<i>timeout</i></dt>
<dd>
[in] The maximum time for <b>select</b> to wait, or NULL for blocking operation.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>select</b> function is used to determine the status of one or more sockets. For each socket, the caller can request information on read, write or error status. The set of sockets for which a given status is requested is indicated by an <a href="strucetc_5cvm.htm"><b>FD_SET</b></a> structure. The sockets contained within the <b>FD_SET</b> structures must be associated with a single service provider. For the purpose of this restriction, sockets are considered to be from the same service provider if the <a href="strucetc_4cfm.htm">WSAPROTOCOL_INFO</a> structures describing their protocols have the same <i>providerId</i> value. Upon return, the structures are updated to reflect the subset of these sockets that meet the specified condition. The <b>select</b> function returns the number of sockets meeting the conditions. A set of macros is provided for manipulating an <b>FD_SET </b>structure. These macros are compatible with those used in the Berkeley software, but the underlying representation is completely different.</p>
<p>
The parameter <i>readfds</i> identifies the sockets that are to be checked for readability. If the socket is currently in the <a href="wsapiref_07hu.htm"><b>listen</b></a> state, it will be marked as readable if an incoming connection request has been received such that an <a href="wsapiref_13aq.htm"><b>accept</b></a> is guaranteed to complete without blocking. For other sockets, readability means that queued data is available for reading such that a call to <a href="wsapiref_2i9e.htm"><b>recv</b></a>, <a href="wsapiref_4z1u.htm"><b>WSARecv</b></a>, <a href="wsapiref_4wky.htm"><b>WSARecvFrom</b></a>, or <a href="wsapiref_88oi.htm"><b>recvfrom</b></a> is guaranteed not to block.</p>
<p>
For connection-oriented sockets, readability can also indicate that a request to close the socket has been received from the peer. If the virtual circuit was closed gracefully, and all data was received, then a <a href="wsapiref_2i9e.htm"><b>recv</b></a> will return immediately with zero bytes read. If the virtual circuit was reset, then a <b>recv</b> will complete immediately with an error code such as <a href="errors_0oaa.htm#_win32_wsaeconnreset_2">WSAECONNRESET</a>. The presence of out-of-band data will be checked if the socket option SO_OOBINLINE has been enabled (see <a href="wsapiref_94aa.htm"><b>setsockopt</b></a>).</p>
<p>
The parameter <i>writefds</i> identifies the sockets that are to be checked for writability. If a socket is processing a <a href="wsapiref_8m7m.htm"><b>connect</b></a> call (nonblocking), a socket is writable if the connection establishment successfully completes. If the socket is not processing a <a href="wsapiref_8m7m.htm"><b>connect</b></a> call, writability means a <b>send</b>, <b>sendto, </b>or<b> WSASendto</b> are guaranteed to succeed. However, they can block on a blocking socket if the <i>len</i> parameter exceeds the amount of outgoing system buffer space available. It is not specified how long these guarantees can be assumed to be valid, particularly in a multithreaded environment.</p>
<p>
The parameter <i>exceptfds</i> identifies the sockets that are to be checked for the presence of out-of-band data (see section <a href="../../../live/pdnds/sockspi/wsanxref_9fqq.htm">DECnet Out-Of-band data</a> for a discussion of this topic) or any exceptional error conditions. </p>
<p>
<b>Important</b>  Out-of-band data will only be reported in this way if the option SO_OOBINLINE is FALSE. If a socket is processing a <a href="wsapiref_8m7m.htm"><b>connect</b></a><b> </b>call<b> </b>(nonblocking), failure of the connect attempt is indicated in <i>exceptfds </i>(application must then call <a href="wsapiref_8qcy.htm"><b>getsockopt</b></a> SO_ERROR to determine the error value to describe why the failure occurred). This document does not define which other errors will be included.</p>
<p>
Any two of the parameters, <i>readfds</i>, <i>writefds</i>, or <i>exceptfds</i>, can be given as NULL. At least one must be non-NULL, and any non-NULL descriptor set must contain at least one handle to a socket.</p>
<p>
Summary: A socket will be identified in a particular set when <b>select</b> returns if:</p>
<p>
<i>readfds</i>:
<ul>
<li>
If <b>listen</b> has been called and a connection is pending, <b>accept</b> will succeed</li>
<li>
Data is available for reading (includes OOB data if SO_OOBINLINE is enabled)</li>
<li>
Connection has been closed/reset/terminated</li>
</ul>
<p>
<i>writefds</i>:
<ul>
<li>
If processing a <b>connect</b> call (nonblocking), connection has succeeded</li>
<li>
Data can be sent</li>
</ul>
<p>
<i>exceptfds</i>:
<ul>
<li>
If processing a <b>connect</b> call (nonblocking), connection attempt failed</li>
<li>
OOB data is available for reading (only if SO_OOBINLINE is disabled)</li>
</ul>
<p>
Four macros are defined in the header file WINSOCK2.H for manipulating and checking the descriptor sets. The variable FD_SETSIZE determines the maximum number of descriptors in a set. (The default value of FD_SETSIZE is 64, which can be modified by defining FD_SETSIZE to another value before including WINSOCK2.H.) Internally, socket handles in an <b>FD_SET</b> structure are not represented as bit flags as in Berkeley Unix. Their data representation is opaque. Use of these macros will maintain software portability between different socket environments. The macros to manipulate and check <b>FD_SET</b> contents are:
<dl>
<dt>
<b>FD_CLR(</b><i>s</i><b>, *</b><i>set</i><b>)</b></dt>
<dd>
Removes the descriptor <i>s</i> from <i>set</i>.</dd>
<dt>
<b>FD_ISSET(</b><i>s</i><b>, *</b><i>set</i><b>)</b></dt>
<dd>
Nonzero if <i>s</i> is a member of the <i>set</i>. Otherwise, zero.</dd>
<dt>
<b>FD_SET(</b><i>s</i><b>, *</b><i>set</i><b>)</b></dt>
<dd>
Adds descriptor <i>s</i> to <i>set</i>.</dd>
<dt>
<b>FD_ZERO(*</b><i>set</i><b>)</b></dt>
<dd>
Initializes the <i>set</i> to the NULL set.
</dd>
</dl>
<p>
The parameter <i>timeout</i> controls how long the <b>select</b> can take to complete. If <i>timeout</i> is a null pointer, <b>select</b> will block indefinitely until at least one descriptor meets the specified criteria. Otherwise, <i>timeout</i> points to a <b>TIMEVAL</b> structure that specifies the maximum time that <b>select</b> should wait before returning. When <b>select</b> returns, the contents of the <b>TIMEVAL</b> structure are not altered. If <b>TIMEVAL</b> is initialized to {0, 0}, <b>select</b> will return immediately; this is used to "poll" the state of the selected sockets. If <b>select</b> returns immediately, then the <b>select</b> call is considered nonblocking and the standard assumptions for nonblocking calls apply. For example, the blocking hook will<i> not</i> be called, and Windows Sockets will <i>not</i> yield.</p>
<p>
<b>Note</b>  The <b>select</b> function has no effect on the persistence of socket events registered with <a href="wsapiref_6jn6.htm"><b>WSAAsyncSelect</b></a> or <a href="wsapiref_34aa.htm"><b>WSAEventSelect</b></a>.</p>
<h4>Return Values</h4>
<p>
The <b>select</b> function returns the total number of socket handles that are ready and contained in the <b>FD_SET</b> structures, zero if the time limit expired, or SOCKET_ERROR if an error occurred. If the return value is SOCKET_ERROR, <a href="wsapiref_2tiq.htm"><b>WSAGetLastError</b></a> can be used to retrieve a specific error code.</p>
<h4>Error Codes</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=41%>WSANOTINITIALISED</td>
<td width=59%>A successful <a href="wsapiref_1v8y.htm"><b>WSAStartup</b></a> must occur before using this function.</td>
</tr>
<tr valign=top>
<td width=41%>WSAEFAULT</td>
<td width=59%>The Windows Sockets implementation was unable to allocate needed resources for its internal operations, or the <i>readfds</i>, <i>writefds</i>, <i>exceptfds</i>, or <i>timeval</i> parameters are not part of the user address space.</td>
</tr>
<tr valign=top>
<td width=41%>WSAENETDOWN</td>
<td width=59%>The network subsystem has failed.</td>
</tr>
<tr valign=top>
<td width=41%>WSAEINVAL</td>
<td width=59%>The <i>timeout</i> value is not valid, or all three descriptor parameters were NULL.</td>
</tr>
<tr valign=top>
<td width=41%>WSAEINTR</td>
<td width=59%>A blocking Windows Socket 1.1 call was canceled through <a href="wsapiref_704y.htm"><b>WSACancelBlockingCall</b></a>.</td>
</tr>
<tr valign=top>
<td width=41%>WSAEINPROGRESS</td>
<td width=59%>A blocking Windows Sockets 1.1 call is in progress, or the service provider is still processing a callback function.</td>
</tr>
<tr valign=top>
<td width=41%>WSAENOTSOCK</td>
<td width=59%>One of the descriptor sets contains an entry that  is not a socket.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Yes<br>
&nbsp;&nbsp;<b>Windows:</b> Yes<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Use version 1.0 and later.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in winsock2.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with ws2_32.lib.</p>
<h4>See Also</h4>
<p>
<a href="wsapiref_13aq.htm"><b>accept</b></a>, <a href="wsapiref_8m7m.htm"><b>connect</b></a>, <a href="wsapiref_2i9e.htm"><b>recv</b></a>, <a href="wsapiref_88oi.htm"><b>recvfrom</b></a>, <a href="wsapiref_6quq.htm"><b>send</b></a>, <a href="wsapiref_6jn6.htm"><b>WSAAsyncSelect</b></a>, <a href="wsapiref_34aa.htm"><b>WSAEventSelect</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
