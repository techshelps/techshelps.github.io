<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WSPShutdown</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_wspshutdown_2"></a>WSPShutdown</h1>
<p>
The <b>WSPShutdown</b> function disables sends and/or receives on a socket.</p>
<pre><code><b>int WSPShutdown (
  SOCKET</b><i> s</i><b>,</b>      
<b>  int</b><i> how</i><b>,</b>       
<b>  LPINT</b><i> lpErrno  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>s</i></dt>
<dd>
[in] A descriptor identifying a socket.</dd>
<dt>
<i>how</i></dt>
<dd>
[in] A flag that describes what types of operation will no longer be allowed.</dd>
<dt>
<i>lpErrno</i></dt>
<dd>
[out] A pointer to the error code.
</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>WSPShutdown</b> is used on all types of sockets to disable reception, transmission, or both.</p>
<p>
If <i>how</i> is SD_RECEIVE, subsequent receives on the socket will be disallowed. This has no effect on the lower protocol layers. For TCP sockets, if there is still data queued on the socket waiting to be received, or data arrives subsequently, the connection is reset, since the data cannot be delivered to the user. For UDP sockets, incoming datagrams are accepted and queued. In no case will an ICMP error packet be generated.</p>
<p>
If <i>how</i> is SD_SEND, subsequent sends on the socket are disallowed. For TCP sockets, a FIN will be sent. Setting <i>how</i> to SD_BOTH disables both sends and receives as described above.</p>
<p>
Note that <b>WSPShutdown</b> does not close the socket, and resources attached to the socket will <i>not</i> be freed until <b>WSPCloseSocket</b> is invoked.</p>
<h4>Comments</h4>
<p>
<b>WSPShutdown</b> does not block regardless of the SO_LINGER setting on the socket. A Windows Sockets SPI client should not rely on being able to re-use a socket after it has been shut down. In particular, a Windows Sockets service provider is not required to support the use of <b>WSPConnect</b> on such a socket.</p>
<h4>Return Values</h4>
<p>
If no error occurs, <b>WSPShutdown</b> returns zero. Otherwise, a value of SOCKET_ERROR is returned, and a specific error code is available in <i>lpErrno</i>.</p>
<h4>Error Codes</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=35%>WSAENETDOWN</td>
<td width=65%>The network subsystem has failed.</td>
</tr>
<tr valign=top>
<td width=35%>WSAEINVAL</td>
<td width=65%><i>how</i> is not valid, or is not consistent with the socket type. For example, SD_SEND is used with a UNI_RECV socket type.</td>
</tr>
<tr valign=top>
<td width=35%>WSAEINPROGRESS</td>
<td width=65%>The function is invoked when a callback is in progress.</td>
</tr>
<tr valign=top>
<td width=35%>WSAENOTCONN</td>
<td width=65%>The socket is not connected (connection-oriented sockets only).</td>
</tr>
<tr valign=top>
<td width=35%>WSAENOTSOCK</td>
<td width=65%>The descriptor is not a socket.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Yes<br>
&nbsp;&nbsp;<b>Windows:</b> Yes<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in ws2spi.h.</p>
<h4>See Also</h4>
<p>
<a href="wsspiref_0meq.htm"><b>WSPConnect</b></a>, <a href="wsspiref_46ia.htm"><b>WSPSocket</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
