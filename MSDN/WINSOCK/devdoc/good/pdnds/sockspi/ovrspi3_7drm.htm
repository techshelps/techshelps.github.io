<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Closing Sockets</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_closing_sockets_2"></a>Closing Sockets </h3>
<p>
<a href="wsspiref_533m.htm"><b>WSPCloseSocket</b></a> releases the socket descriptor so that any pending operations in any threads of the same process will be aborted, and any further reference to it will fail. Note that a reference count should be employed for shared sockets, and only if this is the last reference to an underlying socket, should the information associated with this socket be discarded, provided graceful close is not requested (i.e., SO_DONTLINGER is not set). In the case of SO_DONTLINGER being set, any data queued for transmission will be sent if possible before information associated with the socket is released. See <b>WSPCloseSocket</b> for more information. </p>
<p>
For non-IFS service providers, <a href="wsspiref_2z5e.htm"><b>WPUCloseSocketHandle</b></a> must be invoked to release the socket handle back to the WinSock 2 DLL. </p>
<p>&nbsp;</p></body>
</HTML>
