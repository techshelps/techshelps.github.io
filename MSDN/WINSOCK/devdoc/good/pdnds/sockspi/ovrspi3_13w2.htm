<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Cleanup</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_cleanup_2"></a>Cleanup</h3>
<p>
The WS2_32.DLL(and layered protocols) will call <a href="wsspiref_3436.htm"><b>WSPCleanup</b></a> once for each invocation of <a href="wsspiref_3xbm.htm"><b>WSPStartup</b></a>. On each invocation, <b>WSPCleanup</b> should decrement a per-process reference counter, and when the counter reaches zero the service provider must prepare itself to be unloaded from memory. The first order of business is to finish transmitting any unsent data on sockets that are configured for a graceful close. Thereafter, any and all resources held by the provider are to be freed. The service provider must be left in a state where it can be immediately re-initialized by a call to <b>WSPStartup</b>. </p>
<p>&nbsp;</p></body>
</HTML>
