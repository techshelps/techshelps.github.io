<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WSPGetOverlappedResult</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_wspgetoverlappedresult_2"></a>WSPGetOverlappedResult</h1>
<p>
The <b>WSPGetOverlappedResult</b> function returns the results of an overlapped operation on the specified socket.</p>
<pre><code><b>BOOL WSPGetOverlappedResult (
  SOCKET</b><i> s</i><b>,</b>                       
<b>  LPWSAOVERLAPPED</b><i> lpOverlapped</i><b>,</b>   
<b>  LPDWORD</b><i> lpcbTransfer</i><b>,</b>           
<b>  BOOL</b><i> fWait</i><b>,</b>                     
<b>  LPDWORD</b><i> lpdwFlags</i><b>,</b>              
<b>  LPINT</b><i> lpErrno</i>                   
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>s</i></dt>
<dd>
[in] Identifies the socket. This is the same socket that was specified when the overlapped operation was started by a call to <b>WSPRecv</b>, <b>WSPRecvFrom</b>, <b>WSPSend</b>, <b>WSPSendTo</b>, or <b>WSPIoctl</b>.</dd>
<dt>
<i>lpOverlapped</i></dt>
<dd>
[in] Points to a WSAOVERLAPPED structure that was specified when the overlapped operation was started.</dd>
<dt>
<i>lpcbTransfer</i></dt>
<dd>
[out] Points to a 32-bit variable that receives the number of bytes that were actually transferred by a send or receive operation, or by <b>WSPIoctl</b>.</dd>
<dt>
<i>fWait</i></dt>
<dd>
[in] Specifies whether the function should wait for the pending overlapped operation to complete. If TRUE, the function does not return until the operation has been completed. If FALSE and the operation is still pending, the function returns FALSE and <i>lpErrno</i> is WSA_IO_INCOMPLETE. The <i>fWait</i> parameter may be set to TRUE only if the overlapped operation selected event-based completion notification.</dd>
<dt>
<i>lpdwFlags</i></dt>
<dd>
[out] Points to a 32-bit variable that will receive one or more flags that supplement the completion status. If the overlapped operation was initiated through <b>WSPRecv</b> or <b>WSPRecvFrom</b>, this parameter will contain the results value for <i>lpFlags </i>parameter.</dd>
<dt>
<i>lpErrno</i></dt>
<dd>
[out] A pointer to the error code.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The results reported by the <b>WSPGetOverlappedResult</b> function are those of the specified socket's last overlapped operation to which the specified <a href="../sock2/strucetc_0gz6.htm"><b>WSAOVERLAPPED</b></a> structure was provided, and for which the operation's results were pending. A pending operation is indicated when the function that started the operation returns SOCKET_ERROR, and the <i>lpErrno</i> is WSA_IO_PENDING. When an I/O operation is pending, the function that started the operation resets the <i>hEvent</i> member of the <b>WSAOVERLAPPED</b> structure to the nonsignaled state. Then when the pending operation has been completed, the system sets the event object to the signaled state.</p>
<p>
If the <i>fWait</i> parameter is TRUE, <b>WSPGetOverlappedResult</b> determines whether the pending operation has been completed by blocking and waiting for the event object to be in the signaled state. A client may set <i>fWait</i> parameter to TRUE only if it selected event-based completion notification when the IO operation was requested. If another form of notification was selected, the usage of the <i>hEvent</i> member of the <b>WSAOVERLAPPED</b> structure is different, and setting <i>fWait</i> to TRUE causes unpredictable results.</p>
<h4>Interaction with WPUCompleteOverlappedRequest</h4>
<p>
The behavior of <a href="wsspiref_32ia.htm"><b>WPUCompleteOverlappedRequest</b></a> places some constraints on how a service provider implements <b>WSPGetOverlappedResult</b> since only the <i>Offset</i> and <i>OffsetHigh</i> members of the <b>WSAOVERLAPPED</b> structure are exclusively controlled by the service provider even though three values (byte count, flags, and error) must be retrieved from the structure by <b>WSPGetOverlappedResult</b>. A service provider may accomplish this any way it chooses as long as it interacts with the behavior of <b>WPUCompleteOverlappedRequest</b> properly. The following description present s a typical typical implementation:</p>
<p>
At the start of overlapped processing, the service provider sets <i>Internal</i> to WSS_OPERATION_IN_PROGRESS.</p>
<p>
When the IO operation is complete, the provider sets <i>OffsetHigh</i> to the Windows Sockets 2 error code resulting from the operation, sets <i>Offset</i> to the flags resulting from the IO operation, and calls <b>WPUCompleteOverlappedRequest</b>, passing the transfer byte count as one of the parameters. <b>WPUCompleteOverlappedRequest</b> eventually sets <i>InternalHigh</i> to the transfer byte count, then sets <i>Internal</i> to a value other than WSS_OPERATION_IN_PROGRESS.</p>
<p>
When <b>WSPGetOverlappedResult</b> is called, the service provider checks Internal. If it is WSS_OPERATION_IN_PROGRESS, the provider waits on the event handle in the <i>hEvent</i> member or returns an error, based on the setting of the <i>fWait</i> flag of <b>WSPGetOverlappedResult</b>. If not in progress, or after completion of waiting, the provider returns the values from <i>InternalHigh</i>, <i>OffsetHigh</i>, and <i>Offset</i> as the transfer count, operation result error code, and flags respectively.</p>
<h4>Return Values</h4>
<p>
If <b>WSPGetOverlappedResult</b> succeeds, the return value is TRUE. This means that the overlapped operation has completed successfully and that the value pointed to by <i>lpcbTransfer</i> has been updated. If <b>WSPGetOverlappedResult</b> returns FALSE, this means that either the overlapped operation has not completed or the overlapped operation completed but with errors, or that completion status could not be determined due to errors in one or more parameters to <b>WSPGetOverlappedResult</b>. On failure, the value pointed to by <i>lpcbTransfer</i> will <i>not</i> be updated. <i>lpErrno</i> indicates the cause of the failure (either of <b>WSPGetOverlappedResult</b> or of the associated overlapped operation).</p>
<h4>Error Codes</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=41%>WSAENETDOWN</td>
<td width=59%>The network subsystem has failed.</td>
</tr>
<tr valign=top>
<td width=41%>WSAENOTSOCK</td>
<td width=59%>The descriptor is not a socket.</td>
</tr>
<tr valign=top>
<td width=41%>WSA_INVALID_HANDLE</td>
<td width=59%>The <i>hEvent</i> field of the WSAOVERLAPPED structure does not contain a valid event object handle.</td>
</tr>
<tr valign=top>
<td width=41%>WSA_EINVAL</td>
<td width=59%>One of the parameters is unacceptable.</td>
</tr>
<tr valign=top>
<td width=41%>WSA_IO_INCOMPLETE</td>
<td width=59%><i>fWait</i> is FALSE and the I/O operation has not yet completed.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Yes<br>
&nbsp;&nbsp;<b>Windows:</b> Yes<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in ws2spi.h.</p>
<h4>See Also</h4>
<p>
<a href="wsspiref_854i.htm"><b>WSPRecv</b></a>, <a href="wsspiref_6lbm.htm"><b>WSPRecvFrom</b></a>, <a href="wsspiref_2dpu.htm"><b>WSPSend</b></a>, <a href="wsspiref_68he.htm"><b>WSPSendTo</b></a>, <a href="wsspiref_0meq.htm"><b>WSPConnect</b></a>, <a href="wsspiref_2j1u.htm"><b>WSPAccept</b></a>, <a href="wsspiref_9baq.htm"><b>WSPIoctl</b></a>, <a href="wsspiref_32ia.htm"><b>WPUCompleteOverlappedRequest</b></a></p>
<p>&nbsp;</p></body>
</HTML>
