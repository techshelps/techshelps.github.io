<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SO_SSL_RSA_DECRYPT_HOOK</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_so_ssl_rsa_decrypt_hook_2"></a>SO_SSL_RSA_DECRYPT_HOOK</h3>
<p>
This <a href="../../../good/pdnds/sock2/wsapiref_6ik2.htm"><b>WSAIoctl</b></a> command is used to get/set the RSA decryption hook that SSL will use for the socket. The <i>lpvInBuffer</i> points to the following structure:</p>
<pre><code>struct sslrsadecrypthook {
    int (*func)(void *arg, int blockType, char *dest, int *destlen,
    char *src, int srclen);
    void *arg;
};
 </code></pre>
<p>
This hook is used when the SSL implementation requires an RSA private or public key decryption. The <i>blockType</i> determines if the operation is a private or public key operation (only block types 0x01 and 0x02 are used by SSL; see PKCS#1 for more information). The <i>dest</i> and <i>destlen</i> values are used to return the decryption results. <i>destlen</i> is an input/output parameter with the input value defining the maximum storage area available at <i>dest</i>, and the output value containing the actual stored length of the decryption results. The <i>src</i> and <i>srclen</i> values define the input data. The following values are returned by the hook:</p>
<pre><code>#define SSL_RDH_OK           0
    #define SSL_RDH_BAD_TYPE     1
    #define SSL_RDH_BAD_LEN      2
 </code></pre>
<p>
<b>SSL_RDH_OK</b> is returned if the decryption succeeded. <b>SSL_RDH_BAD_TYPE</b> is returned if the <i>blockType</i> value is unacceptable. <b>SSL_RDH_BAD_LEN</b> is returned if the <i>srclen</i> doesn't match the key's modulus length, or if the <i>dstlen</i> value is too small to hold the decryption results.</p>
<p>&nbsp;</p></body>
</HTML>
