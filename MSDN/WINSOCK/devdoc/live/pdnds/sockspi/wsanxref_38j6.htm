<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SO_SSL_GET_AUTH_CERT_HOOK/SO_SSL_SET_AUTH_CERT_HOOK</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_so_ssl_get_auth_cert_hook_so_ssl_set_auth_cert_hook_2"></a>SO_SSL_GET_AUTH_CERT_HOOK/SO_SSL_SET_AUTH_CERT_HOOK</h3>
<p>
This <a href="../../../good/pdnds/sock2/wsapiref_6ik2.htm"><b>WSAIoctl</b></a> command is used to get/set the certificate authentication hook that SSL will use for the socket. The <i>lpvInBuffer </i>points to the following structure:</p>
<pre><code>struct sslauthcertopts {
    int type;
    int (*func)(void *arg, char *cert, int len);
    void *arg;
};
 </code></pre>
<p>
The SSL implementation will invoke the function with the supplied argument when a certificate arrives (either for server or client authentication). Only certificates of <i>type</i> will be authenticated using this function (see the SSL specification for a list of the supported certificate types). If no function exists for a given certificate type presented to the SSL implementation, the connection/handshake attempt will fail. Otherwise, the function authenticates the certificate and returns one of the following values: </p>
<pre><code>#define SSL_ACH_OK                 0
    #define SSL_ACH_WEAK_OK            1
    #define SSL_ACH_SHORT_DATA         2
    #define SSL_ACH_LONG_DATA          3
    #define SSL_ACH_BAD_DATA           4
     #define SSL_ACH_BAD_SIG           5
    #define SSL_ACH_CERT_EXPIRED       6
 </code></pre>
<p>
The <b>SSL_ACH_OK</b> value is returned when the certificate is good (the signature and validity periods are acceptable) and when the certificate has been verified through some external mechanism (for example, an online check with a certificate authority). The <b>SSL_ACH_WEAK_OK</b> value is returned under the same circumstances, except that no online verification has been performed. </p>
<p>
The remaining values represent the kind of error conditions that might occur during certificate verification. <b>SSL_ACH_BAD_DATA</b> is returned when the data presented is improperly formatted. <b>SSL_ACH_BAD_SIG</b> is returned if the signature check fails.  <b>SSL_ACH_CERT_EXPIRED</b> is returned if the certificate has expired. </p>
<p>&nbsp;</p></body>
</HTML>
