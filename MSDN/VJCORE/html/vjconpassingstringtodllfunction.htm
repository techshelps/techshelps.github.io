<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Passing a String to a DLL Function</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="vjconpassingstringtodllfunction"></a>Passing a String to a DLL Function</h2>
<p>
To pass a standard null-terminated string to a DLL function, just pass a Java String.</p>
<p>
For example, to change the current directory, you can access the Kernel32 function CopyFile as follows:</p>
<pre><code>class ShowCopyFile
{
  public static void main(String args[])
  {
 &nbsp;&nbsp; CopyFile("old.txt", "new.txt", true);
  }
  /** @dll.import("KERNEL32") */
  private native static boolean CopyFile(String existingFile, 
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String newFile, boolean f);
} 
</code></pre>
<p>
Strings are read-only in Java, so the Microsoft VM will only convert the String object as an input. To allow virtual machine implementations to marshal Strings without copying the characters, String object parameters should not be passed to DLL functions that can modify the string. If the DLL function might modify the string, pass a StringBuffer object. </p>
<p>
Strings are converted to ANSI unless the <i>unicode</i> or <i>ole</i> modifier is used, in which case the string is passed in Unicode format. </p>
<p>
Strings cannot be declared as return types of a DLL function except in <i>ole</i> mode, where the native return type is assumed to be a LPWSTR allocated using the CoTaskMemAlloc function.</p>
</BODY>
</HTML>
