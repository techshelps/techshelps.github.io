<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Control</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vjhowcreatingcomcontrol"></a>Creating a Control</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vjhowCreatingCOMControl_C">
</object></p>
<p>
Using WFC, you can create your own controls. A control created with WFC extends com.ms.wfc.ui.UserControl, which in turn extends com.ms.wfc.ui.Form; this allows you to use the Forms Designer to create the control's user interface.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Before you use the following procedure to create a control, close any projects that you may already have open. (On the <b>File</b> menu, click <b>Close All</b>.)</p>
<p class=label>
<b>To create a control</b>
<ol>
<li>
On the <b>File </b>menu, click <b>New Project</b>.<br><br></li>
<li>
On the <b>New</b> tab, expand the <b>Visual J++ Projects</b> folder and click <b>Components</b>. Then select the <b>Control</b> icon.<br><br></li>
<li>
In the <b>Name</b> box, enter a name for your project.<br><br></li>
<li>
In the <b>Location</b> box, enter the path where you want to save your project, or click <b>Browse</b> to navigate to the folder.<br><br></li>
<li>
Click <b>Open</b>. A collapsed view of your project appears in <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vjhowUsingProjectExplorer">
</object><a href=JavaScript:alink_2.Click()>Project Explorer</a>.<br><br></li>
<li>
In Project Explorer, expand the project node. A file with the default name of <b>Control1.java</b> has been added to your project.</li>
</ol>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Renaming this file does not rename the associated class in the source code, and vice versa. You must manually change all instances of the old name. (Note that you can create an <a href="vjhowcreatingemptyproject.htm">empty project</a> and then add a control class with the Control template. This two-step process allows you to name the control before it is created.)</p>
<h3>Viewing Code in the Text Editor</h3>
<p>
To view the source code that was generated, right-click <b>Control1.java</b> in Project Explorer and click <b>View Code</b> on the shortcut menu. The code in the <code>initForm</code> method represents the modifications you make in the Forms Designer. The nested class <code>ClassInfo</code> specifies the properties and events of your control. (To modify the <code>ClassInfo</code>, you can use the <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vjhowModifyingWFCComponentsWithComponentBuilder">
</object><a href=JavaScript:alink_3.Click()>WFC Component Builder</a>.)</p>
<p>
Note that the Javadoc comments for the Control1 class provide information about how to expose your class as an ActiveX control. For more information, see <a href="vjhowsettingcomclasses.htm">Setting COM Classes</a>. </p>
<h3>Modifying the Control in the Forms Designer</h3>
<p>
The following procedures show how to use the existing WFC controls to design your control. This example adds an edit box and a horizontal scroll bar to your control; whenever the scroll bar is scrolled, the edit box displays the scroll bar's current position.</p>
<p class=label>
<b>To add existing controls to your control</b>
<ol>
<li>
To open your control in the Forms Designer, double-click <b>Control1.java</b> in Project Explorer. <br><br></li>
<li>
In the Toolbox, select the <b>WFC Controls</b> tab. (If the Toolbox is not displayed, click <b>Toolbox</b> on the <b>View</b> menu.) <br><br></li>
<li>
To add an edit box to your control, click the <b>Edit</b> control in the Toolbox and then click your control's design surface.<br><br></li>
<li>
To add a horizontal scroll bar to your control, click the <b>HScrollBar</b> control in the Toolbox and then click your control's design surface.<br><br></li>
<li>
Position the edit box in the upper-left corner of your control's design surface, and move the scroll bar below the edit box. (To reposition an item, select and drag it with the mouse.)<br><br></li>
<li>
Resize your control's design surface around the edit box and scroll bar to eliminate extra space. (To resize the design surface, select it and drag the resize handles.)</li>
</ol>
<p class=label>
<b>To add an event handler</b>
<ol>
<li>
Click the <b>Events</b> toolbar button in the Properties window. (If the Properties window is not displayed, click <b>Properties Window</b> on the <b>View</b> menu.) <br><br></li>
<li>
To display the events of the scroll bar, either select the scroll bar on your control's design surface or select the name of the scroll bar object from the drop-down list in the Properties window.<br><br></li>
<li>
Find the <b>scroll</b> event and enter <b>displayPosition</b> for the name of the method that will handle the event. When you press ENTER, the Text editor opens to an empty event handler named <code>displayPosition</code>. <br><br></li>
<li>
Inside the definition of the <code>displayPosition</code> event handler, add the following line of code:<p class=tl>
<code>edit1.setText("Position = " + HScrollBar1.getValue());</code></P></li>
</ol>
<p>
For more information about modifying your code in the development environment, see <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vjhowEditingCode">
</object><a href=JavaScript:alink_4.Click()>Editing Code</a>.</p>
<h3>Building the Control</h3>
<p>
When you build your project, your control is automatically made available to the Toolbox.</p>
<p class=label>
<b>To build the control</b>
<ul type=disc>
<li>
On the <b>Build</b> menu, click <b>Build</b>. Any compilation errors or messages appear in the <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="csrgnTasklistWindow">
</object><a href=JavaScript:alink_5.Click()>Task List</a>. (Double-clicking an error in the Task List moves the insertion point in the Text editor to the error.) Correct the errors and rebuild your control. </li>
</ul>
<p class=label>
<b>To add the control to the Toolbox</b>
<ol>
<li>
Right-click the Toolbox and click <b>Customize Toolbox</b> on the shortcut menu.<br><br></li>
<li>
Click the <b>WFC Controls</b> tab and select the name of your control.<br><br></li>
<li>
Click <b>OK</b>.</li>
</ol>
<h3>Adding the Control to a Form</h3>
<p>
To use your control, you can add it to a WFC form.</p>
<p class=label>
<b>To add a form to your project</b>
<ol>
<li>
In Project Explorer, right-click the name of your project. Point to <b>Add</b> on the shortcut menu and then click <b>Add Form</b>.<br><br></li>
<li>
Select the <b>Form</b> icon. <br><br></li>
<li>
In the <b>Name</b> box, enter a name for the Java class. <br><br></li>
<li>
Click <b>Open</b>. A file with the default name of <b>Form1.java</b> has been added to your project and is opened in the Forms Designer.</li>
</ol>
<p class=label>
<b>To add your control to the form</b>
<ol>
<li>
Find your control in the Toolbox. To scroll through the list of controls, you can click the up and down arrows on the Toolbox tabs.<br><br></li>
<li>
Click your control in the Toolbox and then click the form to add the control.</li>
</ol>
<p class=label>
<b>To build and run the form</b>
<ol>
<li>
On the <b>Build</b> menu, click <b>Build</b>. (If you receive any compilation errors or messages, correct the errors and rebuild your project.) <br><br></li>
<li>
To run the form, click <b>Start</b> on the <b>Debug</b> menu. <p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Because you are running your project for the first time, and because your project contains two .java files, the <b>Project Properties</b> dialog box is displayed. On the <b>Launch</b> tab, select the <b>Default</b> option and specify that Form1 should load when the project runs. Click <b>OK</b>. (For more information about project properties, see <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vjhowBuildingProject">
</object><a href=JavaScript:alink_6.Click()>Setting Project Options</a>.)</p></li>
<li>
Click the ends of the scroll bar in your control. The edit box displays the current scroll position.<br><br></li>
<li>
To close the form, click the Windows Close button located in the upper-right corner of the form.</li>
</ol>
<p>
For more information about creating WFC controls and applications, see <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vjhowWFCControlDevelopment">
</object><a href=JavaScript:alink_7.Click()>WFC Control Development</a> and <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vjconIntroductionToWFCProgramming">
</object><a href=JavaScript:alink_8.Click()>Introduction to WFC Programming</a>. </p>
</BODY>
</HTML>
