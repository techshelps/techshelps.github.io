<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Setups to Install COM Components</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="veconautomaticallyregisteringcomcomponents"></a>Using Setups to Install COM Components</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="veconAutomaticallyRegisteringCOMComponents_C">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Tasks">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="veconAutomaticallyRegisteringCOMComponents_T">
</object></p>
<p>
COM components such as ActiveX controls must be registered when they are installed to allow applications to use them. The Microsoft development environment will do this automatically for any ActiveX components you include in your setup distribution unit. When the component is uninstalled with the setup distribution unit, the setup removes the component from the registry.</p>
<p>
Windows keeps track of the number of setup programs that have installed the same component. The component is only removed when all the applications using it are uninstalled. The counting of these applications per shared COM component is based on the absolute path of the file. It is important for such components to be installed in the same folder by all applications that include them. </p>
<p>
The Microsoft development environment provides a means of installing such COM components in the Windows System folder through a setup distribution unit so they can be shared between applications. For step-by-step instructions, see <a href="vehowinstallingsharedfilesinsystemfolder.htm">Installing Shared Files in the System Folder</a>.</p>
<p>
The count of the applications using the component is based solely on the location of the file (the absolute path of the file) and not the CLSID (class ID) of the component. It is good practice to change the name of the file if the CLSID of the component ever changes, or it is possible to leave entries for the old CLSID in the registry that point at a file that can no longer create that component.</p>
<p>
For DCOM components, the Microsoft development environment setup distribution unit provides a means to install references to remote DCOM servers by including the .vbr and .tlb files (created by Visual Basic and Visual J++ when they build remote servers). You would want to do this if your application used a central server — for example a bank account server that provided access to a user's bank account details. Centralizing the access to sensitive information like this behind a server provides a more secure system, because the only access to the data is through the server.</p>
</BODY>
</HTML>
