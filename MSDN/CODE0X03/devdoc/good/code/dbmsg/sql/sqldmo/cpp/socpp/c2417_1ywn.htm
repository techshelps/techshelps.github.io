<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SOCPP.CPP</title>
<link disabled rel=stylesheet href=../../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2417"></a>SOCPP.CPP</h2>
<pre><code>#define UNICODE <br>#define _UNICODE <br>#include &lt;windows.h&gt; <br>#include &lt;initguid.h&gt; <br>#include &lt;tchar.h&gt; <br>#include &lt;sqloleid.h&gt; <br>#include &lt;sqlole.h&gt; <br> <br>int main (void) <br>{ <br>HRESULT hr; <br>if FAILED(hr = CoInitialize (NULL)) <br>{ <br>_tprintf(TEXT("CoInitialize Failed\n")); <br>return (0); <br>} <br> <br>LPSQLOLESERVER pSQLServer = NULL; <br>if FAILED(hr = CoCreateInstance(CLSID_SQLOLEServer, NULL, CLSCTX_INPROC_SERVER, <br>IID_ISQLOLEServer, (LPVOID*)&amp;pSQLServer)) <br>{ <br>_tprintf(TEXT("CoCreateInstance Failed\n")); <br>return (0); <br>} <br> <br>pSQLServer-&gt;SetLoginTimeout(10); <br> <br>if FAILED(hr = pSQLServer-&gt;Connect(TEXT(""),TEXT("sa"),TEXT(""))) <br>{ <br>_tprintf(TEXT("Connect failed\n")); <br>LPSUPPORTERRORINFO pSEI = NULL; <br>if SUCCEEDED(pSQLServer-&gt;QueryInterface(IID_ISupportErrorInfo, (LPVOID*)&amp;pSEI)) <br>{ <br>if SUCCEEDED(pSEI-&gt;InterfaceSupportsErrorInfo(IID_ISQLOLEServer)) <br>{ <br>LPERRORINFO pEI = NULL; <br>GetErrorInfo (0, &amp;pEI); <br>SQLOLE_BSTR strDescription, strSource; <br>pEI-&gt;GetDescription (&amp;strDescription); <br>pEI-&gt;GetSource (&amp;strSource); <br>_tprintf(TEXT("%s returned error %d: %s\n"), <br>strSource, <br>SCODE_CODE(hr), <br>strDescription); <br>pEI-&gt;Release (); <br>} <br>} <br>else <br>{ <br>_tprintf(TEXT("Error %d\n"), HRESULT_CODE(hr)); <br>} <br>pSEI-&gt;Release (); <br>}  <br>else <br>{ <br>SQLOLE_BSTR str; <br>pSQLServer-&gt;GetVersionString(&amp;str); <br>_tprintf(TEXT("%s\n"),str); <br>LPSQLOLEAPPLICATION pApp = NULL; <br>pSQLServer-&gt;GetApplication(&amp;pApp); <br>pApp-&gt;GetName(&amp;str); <br>_tprintf(TEXT("%s\n"),str); <br>SysFreeString((BSTR)str); <br> <br>LONG ver; <br>pSQLServer-&gt;GetVersionMajor(&amp;ver); <br>_tprintf(TEXT("%d\n"),ver); <br> <br>} <br> <br>pSQLServer-&gt;Release (); <br> <br>CoUninitialize (); <br>return (0); <br>} <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
