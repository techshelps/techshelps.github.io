<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>EXPLORE.FRM</title>
<link disabled rel=stylesheet href=../../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2419"></a>EXPLORE.FRM</h2>
<pre><code>VERSION 4.00 <br>Begin VB.Form frmMain  <br>   Caption         =   "SQL-DMO Explorer" <br>   ClientHeight    =   6705 <br>   ClientLeft      =   180 <br>   ClientTop       =   390 <br>   ClientWidth     =   9240 <br>   BeginProperty Font  <br>      name            =   "MS Sans Serif" <br>      charset         =   1 <br>      weight          =   700 <br>      size            =   8.25 <br>      underline       =   0   'False <br>      italic          =   0   'False <br>      strikethrough   =   0   'False <br>   EndProperty <br>   Height          =   7110 <br>   Left            =   120 <br>   LinkTopic       =   "Form1" <br>   ScaleHeight     =   6705 <br>   ScaleWidth      =   9240 <br>   Top             =   45 <br>   Width           =   9360 <br>   Begin VB.TextBox txtProperties  <br>      Height          =   2535 <br>      Left            =   120 <br>      MultiLine       =   -1  'True <br>      ScrollBars      =   3  'Both <br>      TabIndex        =   13 <br>      Top             =   4080 <br>      Width           =   9015 <br>   End <br>   Begin VB.CommandButton cmdExit  <br>      Caption         =   "E&amp;xit" <br>      Height          =   375 <br>      Left            =   8640 <br>      TabIndex        =   4 <br>      Top             =   120 <br>      Width           =   495 <br>   End <br>   Begin VB.ComboBox cboFour  <br>      Height          =   315 <br>      Left            =   6960 <br>      Sorted          =   -1  'True <br>      Style           =   2  'Dropdown List <br>      TabIndex        =   11 <br>      Top             =   600 <br>      Width           =   2175 <br>   End <br>   Begin VB.ListBox lstFour  <br>      Height          =   2985 <br>      Left            =   6960 <br>      Sorted          =   -1  'True <br>      TabIndex        =   12 <br>      Top             =   960 <br>      Width           =   2175 <br>   End <br>   Begin VB.CommandButton cmdConnect  <br>      Caption         =   "&amp;Connect" <br>      Height          =   375 <br>      Left            =   7560 <br>      TabIndex        =   3 <br>      Top             =   120 <br>      Width           =   975 <br>   End <br>   Begin VB.TextBox txtPassword  <br>      Height          =   285 <br>      Left            =   5880 <br>      PasswordChar    =   "*" <br>      TabIndex        =   2 <br>      Top             =   120 <br>      Width           =   1455 <br>   End <br>   Begin VB.TextBox txtLogin  <br>      Height          =   285 <br>      Left            =   3360 <br>      TabIndex        =   1 <br>      Top             =   120 <br>      Width           =   1455 <br>   End <br>   Begin VB.TextBox txtServer  <br>      Height          =   285 <br>      Left            =   1200 <br>      TabIndex        =   0 <br>      Top             =   120 <br>      Width           =   1455 <br>   End <br>   Begin VB.ListBox lstThree  <br>      Height          =   2985 <br>      Left            =   4680 <br>      Sorted          =   -1  'True <br>      TabIndex        =   10 <br>      Top             =   960 <br>      Width           =   2175 <br>   End <br>   Begin VB.ListBox lstTwo  <br>      Height          =   2985 <br>      Left            =   2400 <br>      Sorted          =   -1  'True <br>      TabIndex        =   8 <br>      Top             =   960 <br>      Width           =   2175 <br>   End <br>   Begin VB.ListBox lstOne  <br>      Height          =   2985 <br>      Left            =   120 <br>      Sorted          =   -1  'True <br>      TabIndex        =   6 <br>      Top             =   960 <br>      Width           =   2175 <br>   End <br>   Begin VB.ComboBox cboThree  <br>      Height          =   315 <br>      Left            =   4680 <br>      Sorted          =   -1  'True <br>      Style           =   2  'Dropdown List <br>      TabIndex        =   9 <br>      Top             =   600 <br>      Width           =   2175 <br>   End <br>   Begin VB.ComboBox cboTwo  <br>      Height          =   315 <br>      Left            =   2400 <br>      Sorted          =   -1  'True <br>      Style           =   2  'Dropdown List <br>      TabIndex        =   7 <br>      Top             =   600 <br>      Width           =   2175 <br>   End <br>   Begin VB.ComboBox cboOne  <br>      Height          =   315 <br>      Left            =   120 <br>      Sorted          =   -1  'True <br>      Style           =   2  'Dropdown List <br>      TabIndex        =   5 <br>      Top             =   600 <br>      Width           =   2175 <br>   End <br>   Begin VB.Label lblPassword  <br>      Caption         =   "Password:" <br>      Height          =   255 <br>      Left            =   4920 <br>      TabIndex        =   16 <br>      Top             =   120 <br>      Width           =   855 <br>   End <br>   Begin VB.Label lblLogin  <br>      Caption         =   "Login:" <br>      Height          =   255 <br>      Left            =   2760 <br>      TabIndex        =   15 <br>      Top             =   120 <br>      Width           =   615 <br>   End <br>   Begin VB.Label lblServer  <br>      Caption         =   "SQL Server:" <br>      Height          =   255 <br>      Left            =   120 <br>      TabIndex        =   14 <br>      Top             =   120 <br>      Width           =   1095 <br>   End <br>End <br>Attribute VB_Name = "frmMain" <br>Attribute VB_Creatable = False <br>Attribute VB_Exposed = False <br>Option Explicit <br>Private Sub FillProperties(oObject As Object, txtText As Object) <br>    On Error Resume Next <br>    Dim oProperty As Object <br> <br>    frmMain.MousePointer = 11 <br>    With txtText <br>        Select Case oObject.TypeOf <br>        Case SQLOLEObj_Subscription <br>            .Text = "Properties for " &amp; oObject.ServerName &amp; NL <br>        Case Else <br>            .Text = "Properties for " &amp; oObject.Name &amp; NL <br>        End Select <br>        For Each oProperty In oObject.Properties <br>            .Text = .Text &amp; oProperty.Name &amp; ": " &amp; oProperty.Value &amp; NL <br>        Next <br>    End With <br>    frmMain.MousePointer = 0 <br> <br>End Sub <br> <br>Private Sub cboFour_Click() <br> <br>    If oCurrentThree Is Nothing Then Exit Sub <br> <br>    FillFour <br> <br>End Sub <br> <br> <br>Private Sub cboOne_Click() <br> <br>    cboTwo.Clear <br>    lstTwo.Clear <br>    cboThree.Clear <br>    lstThree.Clear <br>    cboFour.Clear <br>    lstFour.Clear <br> <br>    Set oCurrentOne = Nothing <br> <br>    Select Case cboOne.Text <br>    Case "Databases" <br>        cboTwo.AddItem "Defaults" <br>        cboTwo.AddItem "Groups" <br>        cboTwo.AddItem "Publications" <br>        cboTwo.AddItem "Rules" <br>        cboTwo.AddItem "StoredProcedures" <br>        cboTwo.AddItem "SystemDataTypes" <br>        cboTwo.AddItem "Tables" <br>        cboTwo.AddItem "UserDefinedDataTypes" <br>        cboTwo.AddItem "Users" <br>        cboTwo.AddItem "Views" <br>    Case "RemoteServers" <br>        cboTwo.AddItem "RemoteLogins" <br>    End Select <br> <br>    FillOne <br> <br>End Sub <br> <br>Private Sub cboThree_Click() <br> <br>    cboFour.Clear <br>    lstFour.Clear <br>     <br>    Set oCurrentThree = Nothing <br>     <br>    Select Case cboThree.Text <br>    Case "Articles" <br>        cboFour.AddItem "Subscriptions" <br>    End Select <br> <br>    If oCurrentTwo Is Nothing Then Exit Sub <br> <br>    FillThree <br> <br>End Sub <br> <br>Private Sub cboTwo_Click() <br> <br>    cboThree.Clear <br>    lstThree.Clear <br>    cboFour.Clear <br>    lstFour.Clear <br> <br>    Set oCurrentTwo = Nothing <br> <br>    Select Case cboTwo.Text <br>    Case "Tables" <br>        cboThree.AddItem "Checks" <br>        cboThree.AddItem "Columns" <br>        cboThree.AddItem "Indexes" <br>        cboThree.AddItem "Keys" <br>        cboThree.AddItem "Triggers" <br>    Case "Publications" <br>        cboThree.AddItem "Articles" <br>    End Select <br> <br>    If oCurrentOne Is Nothing Then Exit Sub <br> <br>    FillTwo <br> <br>End Sub <br> <br>Private Sub FillOne() <br>    On Error Resume Next <br> <br>    lstOne.Clear <br>    If cboOne.ListIndex = -1 Then Exit Sub <br> <br>    ReDim oCollection(0) As Object <br>    GetCollection oSQLServer, (cboOne.Text), oCollection() <br> <br>    Dim i As Integer <br>    For i = 1 To oCollection(0).Count <br>        lstOne.AddItem oCollection(0)(i).Name <br>    Next i <br> <br>End Sub <br> <br>Private Sub FillThree() <br>    On Error Resume Next <br> <br>    lstThree.Clear <br>    If cboThree.ListIndex = -1 Then Exit Sub <br> <br>    ReDim oCollection(0) As Object <br>    GetCollection oCurrentTwo, (cboThree.Text), oCollection() <br>     <br>    Dim i As Integer <br>    For i = 1 To oCollection(0).Count <br>        lstThree.AddItem oCollection(0)(i).Name <br>    Next i <br> <br>End Sub <br> <br>Private Sub FillFour() <br>    On Error Resume Next <br> <br>    lstFour.Clear <br>    If cboFour.ListIndex = -1 Then Exit Sub <br> <br>    ReDim oCollection(0) As Object <br>    GetCollection oCurrentThree, (cboFour.Text), oCollection() <br> <br>    Dim i As Integer <br>    For i = 1 To oCollection(0).Count <br>    Select Case oCollection(0)(i).TypeOf <br>    Case SQLOLEObj_Subscription <br>        lstFour.AddItem oCollection(0)(i).ServerName <br>    Case Else <br>        lstFour.AddItem oCollection(0)(i).Name <br>    End Select <br>    Next i <br> <br>End Sub <br> <br> <br>Private Sub FillTwo() <br>    On Error Resume Next <br> <br>    lstTwo.Clear <br>    If cboTwo.ListIndex = -1 Then Exit Sub <br> <br>    ReDim oCollection(0) As Object <br>    GetCollection oCurrentOne, (cboTwo.Text), oCollection() <br> <br>    Dim i As Integer <br>    For i = 1 To oCollection(0).Count <br>        lstTwo.AddItem oCollection(0)(i).Name <br>    Next i <br> <br>End Sub <br> <br> <br>Private Sub cmdConnect_Click() <br>    On Error Resume Next <br>         <br>    frmMain.MousePointer = 11 <br>    oSQLServer.DisConnect <br>    oSQLServer.Connect txtServer.Text, txtLogin.Text, txtPassword.Text <br>    With txtProperties <br>        If Err.Number = 0 Then <br>            .Text = "Properties for SQL Server " &amp; oSQLServer.TrueName &amp; NL <br>            FillProperties oSQLServer, txtProperties <br>        Else <br>            .Text = Err.Source &amp; " Error " &amp; Err.Number - vbObjectError &amp; ":" &amp; NL <br>            .Text = .Text &amp; "    " &amp; Err.Description <br>        End If <br>    End With <br>     <br>    frmMain.MousePointer = 0 <br>         <br>    lstOne.Clear <br>    lstTwo.Clear <br>    lstThree.Clear <br>    lstFour.Clear <br>     <br>End Sub <br> <br> <br>Private Sub cmdExit_Click() <br>    Unload frmMain <br>End Sub <br> <br>Private Sub Form_Load() <br>    On Error Resume Next <br>    NL = Chr$(13) &amp; Chr$(10) <br>     <br>    Set oSQLServer = New SQLOLE.SQLServer <br>    oSQLServer.LoginTimeout = 10 <br>     <br>    With cboOne <br>        .Clear <br>        .AddItem "Alerts" <br>        .AddItem "Databases" <br>        .AddItem "Devices" <br>        .AddItem "Languages" <br>        .AddItem "Logins" <br>        .AddItem "Operators" <br>        .AddItem "RemoteServers" <br>    End With <br> <br>End Sub <br> <br> <br>Private Sub Form_Unload(Cancel As Integer) <br>    On Error Resume Next <br>     <br>    oSQLServer.DisConnect <br>    oSQLServer.Close <br> <br>End Sub <br> <br> <br> <br>Private Sub lstFour_Click() <br>    On Error Resume Next <br> <br>    Select Case cboFour.Text <br>    Case "Subscriptions" <br>        Set oCurrentFour = oCurrentThree.Subscriptions(lstFour.Text) <br>    End Select <br> <br>    FillProperties oCurrentFour, txtProperties <br> <br>End Sub <br> <br>Private Sub lstOne_Click() <br>    On Error Resume Next <br>     <br>    Select Case cboOne.Text <br>    Case "Databases" <br>        Set oCurrentOne = oSQLServer.Databases(lstOne.Text) <br>    Case "Devices" <br>        Set oCurrentOne = oSQLServer.Devices(lstOne.Text) <br>    Case "Languages" <br>        Set oCurrentOne = oSQLServer.Languages(lstOne.Text) <br>    Case "Logins" <br>        Set oCurrentOne = oSQLServer.Logins(lstOne.Text) <br>    Case "RemoteServers" <br>        Set oCurrentOne = oSQLServer.RemoteServers(lstOne.Text) <br>    Case "Alerts" <br>        Set oCurrentOne = oSQLServer.Alerts(lstOne.Text) <br>    Case "Operators" <br>        Set oCurrentOne = oSQLServer.Operators(lstOne.Text) <br>    End Select <br> <br>    lstTwo.Clear <br>    lstThree.Clear <br>    lstFour.Clear <br> <br>    FillTwo <br> <br>    FillProperties oCurrentOne, txtProperties <br> <br>End Sub <br> <br> <br> <br>Private Sub lstThree_Click() <br>    On Error Resume Next <br> <br>    Select Case cboThree.Text <br>    Case "Columns" <br>        Set oCurrentThree = oCurrentTwo.Columns(lstThree.Text) <br>    Case "Indexes" <br>        Set oCurrentThree = oCurrentTwo.Indexes(lstThree.Text) <br>    Case "Triggers" <br>        Set oCurrentThree = oCurrentTwo.Triggers(lstThree.Text) <br>    Case "Keys" <br>        Set oCurrentThree = oCurrentTwo.Keys(lstThree.Text) <br>    Case "Checks" <br>        Set oCurrentThree = oCurrentTwo.Checks(lstThree.Text) <br>    Case "Articles" <br>        Set oCurrentThree = oCurrentTwo.Articles(lstThree.Text) <br>    End Select <br> <br>    lstFour.Clear <br> <br>    FillFour <br> <br>    FillProperties oCurrentThree, txtProperties <br> <br>End Sub <br> <br>Private Sub lstTwo_Click() <br>    On Error Resume Next <br> <br>    Select Case cboTwo.Text <br>    Case "Defaults" <br>        Set oCurrentTwo = oCurrentOne.Defaults(lstTwo.Text) <br>    Case "Groups" <br>        Set oCurrentTwo = oCurrentOne.Groups(lstTwo.Text) <br>    Case "Rules" <br>        Set oCurrentTwo = oCurrentOne.Rules(lstTwo.Text) <br>    Case "StoredProcedures" <br>        Set oCurrentTwo = oCurrentOne.StoredProcedures(lstTwo.Text) <br>    Case "SystemDataTypes" <br>        Set oCurrentTwo = oCurrentOne.SystemDatatypes(lstTwo.Text) <br>    Case "Tables" <br>        Set oCurrentTwo = oCurrentOne.Tables(lstTwo.Text) <br>    Case "UserDefinedDataTypes" <br>        Set oCurrentTwo = oCurrentOne.UserDefinedDatatypes(lstTwo.Text) <br>    Case "Users" <br>        Set oCurrentTwo = oCurrentOne.Users(lstTwo.Text) <br>    Case "Views" <br>        Set oCurrentTwo = oCurrentOne.Views(lstTwo.Text) <br>    Case "RemoteLogins" <br>        Set oCurrentTwo = oCurrentOne.RemoteLogins(lstTwo.Text) <br>    Case "Publications" <br>        Set oCurrentTwo = oCurrentOne.Publications(lstTwo.Text) <br>    End Select <br>     <br>    lstThree.Clear <br>    lstFour.Clear <br> <br>    FillThree <br> <br>    FillProperties oCurrentTwo, txtProperties <br> <br>End Sub <br> <br> <br> <br> <br> <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
