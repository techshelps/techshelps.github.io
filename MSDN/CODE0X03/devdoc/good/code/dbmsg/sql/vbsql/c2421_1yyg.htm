<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AUTHORS.FRM</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2428"></a>AUTHORS.FRM</h2>
<pre><code>VERSION 2.00 <br>Begin Form fAuthors  <br>   BackColor       =   &amp;H00C0C0C0&amp; <br>   Caption         =   "Authors" <br>   ForeColor       =   &amp;H00C0C0C0&amp; <br>   Height          =   5655 <br>   Icon            =   AUTHORS.FRX:0000 <br>   Left            =   270 <br>   LinkTopic       =   "Form1" <br>   MDIChild        =   -1  'True <br>   ScaleHeight     =   4965 <br>   ScaleWidth      =   9135 <br>   Top             =   1695 <br>   Width           =   9255 <br>   Begin SSFrame frmTitles  <br>      Caption         =   "Titles" <br>      FontBold        =   0   'False <br>      FontItalic      =   0   'False <br>      FontName        =   "MS Sans Serif" <br>      FontSize        =   8.25 <br>      FontStrikethru  =   0   'False <br>      FontUnderline   =   0   'False <br>      ForeColor       =   &amp;H00000000&amp; <br>      Height          =   2535 <br>      Left            =   75 <br>      TabIndex        =   41 <br>      Top             =   2325 <br>      Visible         =   0   'False <br>      Width           =   8970 <br>      Begin SSPanel panGrid  <br>         AutoSize        =   3  'AutoSize Child To Panel <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         BevelInner      =   1  'Inset <br>         BevelOuter      =   0  'None <br>         BorderWidth     =   0 <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   2055 <br>         Left            =   120 <br>         TabIndex        =   42 <br>         Top             =   330 <br>         Width           =   8730 <br>         Begin Grid grdTitles  <br>            Cols            =   9 <br>            FixedCols       =   0 <br>            FontBold        =   0   'False <br>            FontItalic      =   0   'False <br>            FontName        =   "MS Sans Serif" <br>            FontSize        =   8.25 <br>            FontStrikethru  =   0   'False <br>            FontUnderline   =   0   'False <br>            Height          =   2025 <br>            Left            =   15 <br>            Rows            =   10 <br>            TabIndex        =   43 <br>            Top             =   15 <br>            Width           =   8700 <br>         End <br>      End <br>   End <br>   Begin SSRibbon cmdDown  <br>      AutoSize        =   0  'None <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      BevelWidth      =   1 <br>      Height          =   420 <br>      Left            =   8670 <br>      PictureUp       =   AUTHORS.FRX:0302 <br>      Top             =   75 <br>      Width           =   420 <br>   End <br>   Begin SSPanel Panel3D9  <br>      AutoSize        =   3  'AutoSize Child To Panel <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      BevelInner      =   1  'Inset <br>      BevelOuter      =   0  'None <br>      BorderWidth     =   0 <br>      ForeColor       =   &amp;H00000000&amp; <br>      Height          =   375 <br>      Left            =   75 <br>      TabIndex        =   38 <br>      Top             =   1530 <br>      Width           =   2625 <br>      Begin SSCommand cmdMoreRows  <br>         BevelWidth      =   1 <br>         Caption         =   "&amp;More rows" <br>         Enabled         =   0   'False <br>         FontBold        =   0   'False <br>         FontItalic      =   0   'False <br>         FontName        =   "MS Sans Serif" <br>         FontSize        =   8.25 <br>         FontStrikethru  =   0   'False <br>         FontUnderline   =   0   'False <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   345 <br>         Left            =   15 <br>         TabIndex        =   39 <br>         Top             =   15 <br>         Width           =   2595 <br>      End <br>   End <br>   Begin SSPanel Panel3D1  <br>      Alignment       =   8  'Center - BOTTOM <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      BevelInner      =   1  'Inset <br>      BevelOuter      =   0  'None <br>      BorderWidth     =   0 <br>      ForeColor       =   &amp;H00000000&amp; <br>      Height          =   2190 <br>      Left            =   2775 <br>      TabIndex        =   29 <br>      Top             =   75 <br>      Width           =   5850 <br>      Begin SSPanel panAuthors  <br>         AutoSize        =   3  'AutoSize Child To Panel <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         BevelInner      =   1  'Inset <br>         BevelOuter      =   0  'None <br>         BorderWidth     =   0 <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   315 <br>         Index           =   1 <br>         Left            =   105 <br>         TabIndex        =   37 <br>         Top             =   315 <br>         Width           =   1140 <br>         Begin TextBox txtAuthors  <br>            FontBold        =   0   'False <br>            FontItalic      =   0   'False <br>            FontName        =   "MS Sans Serif" <br>            FontSize        =   8.25 <br>            FontStrikethru  =   0   'False <br>            FontUnderline   =   0   'False <br>            Height          =   285 <br>            Index           =   1 <br>            Left            =   15 <br>            TabIndex        =   1 <br>            Top             =   15 <br>            Width           =   1110 <br>         End <br>      End <br>      Begin SSPanel Panel3D8  <br>         AutoSize        =   3  'AutoSize Child To Panel <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         BevelInner      =   1  'Inset <br>         BevelOuter      =   0  'None <br>         BorderWidth     =   0 <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   315 <br>         Left            =   3450 <br>         TabIndex        =   36 <br>         Top             =   1020 <br>         Width           =   1695 <br>         Begin TextBox txtAuthors  <br>            FontBold        =   0   'False <br>            FontItalic      =   0   'False <br>            FontName        =   "MS Sans Serif" <br>            FontSize        =   8.25 <br>            FontStrikethru  =   0   'False <br>            FontUnderline   =   0   'False <br>            Height          =   285 <br>            Index           =   6 <br>            Left            =   15 <br>            TabIndex        =   6 <br>            Top             =   15 <br>            Width           =   1665 <br>         End <br>      End <br>      Begin SSPanel Panel3D2  <br>         AutoSize        =   3  'AutoSize Child To Panel <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         BevelInner      =   1  'Inset <br>         BevelOuter      =   0  'None <br>         BorderWidth     =   0 <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   315 <br>         Left            =   5190 <br>         TabIndex        =   35 <br>         Top             =   1020 <br>         Width           =   570 <br>         Begin TextBox txtAuthors  <br>            FontBold        =   0   'False <br>            FontItalic      =   0   'False <br>            FontName        =   "MS Sans Serif" <br>            FontSize        =   8.25 <br>            FontStrikethru  =   0   'False <br>            FontUnderline   =   0   'False <br>            Height          =   285 <br>            Index           =   7 <br>            Left            =   15 <br>            TabIndex        =   7 <br>            Top             =   15 <br>            Width           =   540 <br>         End <br>      End <br>      Begin SSPanel Panel3D3  <br>         AutoSize        =   3  'AutoSize Child To Panel <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         BevelInner      =   1  'Inset <br>         BevelOuter      =   0  'None <br>         BorderWidth     =   0 <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   315 <br>         Left            =   2235 <br>         TabIndex        =   34 <br>         Top             =   1020 <br>         Width           =   1170 <br>         Begin TextBox txtAuthors  <br>            FontBold        =   0   'False <br>            FontItalic      =   0   'False <br>            FontName        =   "MS Sans Serif" <br>            FontSize        =   8.25 <br>            FontStrikethru  =   0   'False <br>            FontUnderline   =   0   'False <br>            Height          =   285 <br>            Index           =   5 <br>            Left            =   15 <br>            TabIndex        =   5 <br>            Top             =   15 <br>            Width           =   1140 <br>         End <br>      End <br>      Begin SSPanel Panel3D4  <br>         AutoSize        =   3  'AutoSize Child To Panel <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         BevelInner      =   1  'Inset <br>         BevelOuter      =   0  'None <br>         BorderWidth     =   0 <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   315 <br>         Left            =   90 <br>         TabIndex        =   33 <br>         Top             =   1020 <br>         Width           =   2100 <br>         Begin TextBox txtAuthors  <br>            FontBold        =   0   'False <br>            FontItalic      =   0   'False <br>            FontName        =   "MS Sans Serif" <br>            FontSize        =   8.25 <br>            FontStrikethru  =   0   'False <br>            FontUnderline   =   0   'False <br>            Height          =   285 <br>            Index           =   4 <br>            Left            =   15 <br>            TabIndex        =   4 <br>            Top             =   15 <br>            Width           =   2070 <br>         End <br>      End <br>      Begin SSPanel Panel3D5  <br>         AutoSize        =   3  'AutoSize Child To Panel <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         BevelInner      =   1  'Inset <br>         BevelOuter      =   0  'None <br>         BorderWidth     =   0 <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   315 <br>         Left            =   3180 <br>         TabIndex        =   32 <br>         Top             =   315 <br>         Width           =   2580 <br>         Begin TextBox txtAuthors  <br>            FontBold        =   0   'False <br>            FontItalic      =   0   'False <br>            FontName        =   "MS Sans Serif" <br>            FontSize        =   8.25 <br>            FontStrikethru  =   0   'False <br>            FontUnderline   =   0   'False <br>            Height          =   285 <br>            Index           =   3 <br>            Left            =   15 <br>            TabIndex        =   3 <br>            Top             =   15 <br>            Width           =   2550 <br>         End <br>      End <br>      Begin SSPanel Panel3D6  <br>         AutoSize        =   3  'AutoSize Child To Panel <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         BevelInner      =   1  'Inset <br>         BevelOuter      =   0  'None <br>         BorderWidth     =   0 <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   315 <br>         Left            =   1290 <br>         TabIndex        =   31 <br>         Top             =   315 <br>         Width           =   1845 <br>         Begin TextBox txtAuthors  <br>            FontBold        =   0   'False <br>            FontItalic      =   0   'False <br>            FontName        =   "MS Sans Serif" <br>            FontSize        =   8.25 <br>            FontStrikethru  =   0   'False <br>            FontUnderline   =   0   'False <br>            Height          =   285 <br>            Index           =   2 <br>            Left            =   15 <br>            TabIndex        =   2 <br>            Top             =   15 <br>            Width           =   1815 <br>         End <br>      End <br>      Begin SSPanel Panel3D7  <br>         AutoSize        =   3  'AutoSize Child To Panel <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         BevelInner      =   1  'Inset <br>         BevelOuter      =   0  'None <br>         BorderWidth     =   0 <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   315 <br>         Left            =   105 <br>         TabIndex        =   30 <br>         Top             =   1695 <br>         Width           =   1635 <br>         Begin TextBox txtAuthors  <br>            FontBold        =   0   'False <br>            FontItalic      =   0   'False <br>            FontName        =   "MS Sans Serif" <br>            FontSize        =   8.25 <br>            FontStrikethru  =   0   'False <br>            FontUnderline   =   0   'False <br>            Height          =   285 <br>            Index           =   8 <br>            Left            =   15 <br>            TabIndex        =   8 <br>            Top             =   15 <br>            Width           =   1605 <br>         End <br>      End <br>      Begin SSCheck chkContract  <br>         Caption         =   "Contract" <br>         FontBold        =   0   'False <br>         FontItalic      =   0   'False <br>         FontName        =   "MS Sans Serif" <br>         FontSize        =   8.25 <br>         FontStrikethru  =   0   'False <br>         FontUnderline   =   0   'False <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   240 <br>         Left            =   2235 <br>         TabIndex        =   9 <br>         Top             =   1725 <br>         Width           =   930 <br>      End <br>      Begin Label lblAuthors  <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         Caption         =   "Id" <br>         FontBold        =   0   'False <br>         FontItalic      =   0   'False <br>         FontName        =   "MS Sans Serif" <br>         FontSize        =   8.25 <br>         FontStrikethru  =   0   'False <br>         FontUnderline   =   0   'False <br>         Height          =   195 <br>         Index           =   1 <br>         Left            =   120 <br>         TabIndex        =   10 <br>         Top             =   120 <br>         Width           =   150 <br>      End <br>      Begin Label lblAuthors  <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         Caption         =   "First" <br>         FontBold        =   0   'False <br>         FontItalic      =   0   'False <br>         FontName        =   "MS Sans Serif" <br>         FontSize        =   8.25 <br>         FontStrikethru  =   0   'False <br>         FontUnderline   =   0   'False <br>         Height          =   195 <br>         Index           =   2 <br>         Left            =   1320 <br>         TabIndex        =   11 <br>         Top             =   120 <br>         Width           =   285 <br>      End <br>      Begin Label lblAuthors  <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         Caption         =   "Last" <br>         FontBold        =   0   'False <br>         FontItalic      =   0   'False <br>         FontName        =   "MS Sans Serif" <br>         FontSize        =   8.25 <br>         FontStrikethru  =   0   'False <br>         FontUnderline   =   0   'False <br>         Height          =   195 <br>         Index           =   3 <br>         Left            =   3195 <br>         TabIndex        =   12 <br>         Top             =   120 <br>         Width           =   300 <br>      End <br>      Begin Label lblAuthors  <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         Caption         =   "Address" <br>         FontBold        =   0   'False <br>         FontItalic      =   0   'False <br>         FontName        =   "MS Sans Serif" <br>         FontSize        =   8.25 <br>         FontStrikethru  =   0   'False <br>         FontUnderline   =   0   'False <br>         Height          =   195 <br>         Index           =   4 <br>         Left            =   120 <br>         TabIndex        =   13 <br>         Top             =   825 <br>         Width           =   570 <br>      End <br>      Begin Label lblAuthors  <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         Caption         =   "Zip Code" <br>         FontBold        =   0   'False <br>         FontItalic      =   0   'False <br>         FontName        =   "MS Sans Serif" <br>         FontSize        =   8.25 <br>         FontStrikethru  =   0   'False <br>         FontUnderline   =   0   'False <br>         Height          =   195 <br>         Index           =   5 <br>         Left            =   2295 <br>         TabIndex        =   14 <br>         Top             =   825 <br>         Width           =   645 <br>      End <br>      Begin Label lblAuthors  <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         Caption         =   "City" <br>         FontBold        =   0   'False <br>         FontItalic      =   0   'False <br>         FontName        =   "MS Sans Serif" <br>         FontSize        =   8.25 <br>         FontStrikethru  =   0   'False <br>         FontUnderline   =   0   'False <br>         Height          =   195 <br>         Index           =   6 <br>         Left            =   3480 <br>         TabIndex        =   15 <br>         Top             =   825 <br>         Width           =   270 <br>      End <br>      Begin Label lblAuthors  <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         Caption         =   "State" <br>         FontBold        =   0   'False <br>         FontItalic      =   0   'False <br>         FontName        =   "MS Sans Serif" <br>         FontSize        =   8.25 <br>         FontStrikethru  =   0   'False <br>         FontUnderline   =   0   'False <br>         Height          =   195 <br>         Index           =   7 <br>         Left            =   5205 <br>         TabIndex        =   16 <br>         Top             =   825 <br>         Width           =   375 <br>      End <br>      Begin Label lblAuthors  <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         Caption         =   "Phone" <br>         FontBold        =   0   'False <br>         FontItalic      =   0   'False <br>         FontName        =   "MS Sans Serif" <br>         FontSize        =   8.25 <br>         FontStrikethru  =   0   'False <br>         FontUnderline   =   0   'False <br>         Height          =   195 <br>         Index           =   8 <br>         Left            =   120 <br>         TabIndex        =   17 <br>         Top             =   1500 <br>         Width           =   465 <br>      End <br>   End <br>   Begin SSPanel panItemsRemoved  <br>      Alignment       =   8  'Center - BOTTOM <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      BevelInner      =   1  'Inset <br>      BevelOuter      =   0  'None <br>      BorderWidth     =   0 <br>      FontBold        =   0   'False <br>      FontItalic      =   0   'False <br>      FontName        =   "MS Sans Serif" <br>      FontSize        =   8.25 <br>      FontStrikethru  =   0   'False <br>      FontUnderline   =   0   'False <br>      ForeColor       =   &amp;H00000000&amp; <br>      Height          =   300 <br>      Left            =   75 <br>      TabIndex        =   28 <br>      Top             =   75 <br>      Width           =   2625 <br>   End <br>   Begin SSPanel panItemsRead  <br>      Alignment       =   8  'Center - BOTTOM <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      BevelInner      =   1  'Inset <br>      BevelOuter      =   0  'None <br>      BorderWidth     =   0 <br>      FontBold        =   0   'False <br>      FontItalic      =   0   'False <br>      FontName        =   "MS Sans Serif" <br>      FontSize        =   8.25 <br>      FontStrikethru  =   0   'False <br>      FontUnderline   =   0   'False <br>      ForeColor       =   &amp;H00000000&amp; <br>      Height          =   300 <br>      Left            =   75 <br>      TabIndex        =   27 <br>      Top             =   1965 <br>      Width           =   2625 <br>   End <br>   Begin SSPanel panAuthors  <br>      AutoSize        =   3  'AutoSize Child To Panel <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      BevelInner      =   1  'Inset <br>      BevelOuter      =   0  'None <br>      BorderWidth     =   0 <br>      ForeColor       =   &amp;H00000000&amp; <br>      Height          =   1035 <br>      Index           =   0 <br>      Left            =   75 <br>      TabIndex        =   26 <br>      Top             =   450 <br>      Width           =   2625 <br>      Begin ListBox lstPrim  <br>         FontBold        =   0   'False <br>         FontItalic      =   0   'False <br>         FontName        =   "MS Sans Serif" <br>         FontSize        =   8.25 <br>         FontStrikethru  =   0   'False <br>         FontUnderline   =   0   'False <br>         Height          =   1005 <br>         Left            =   15 <br>         TabIndex        =   0 <br>         Top             =   15 <br>         Width           =   2595 <br>      End <br>   End <br>   Begin Frame Frame1  <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      Caption         =   "Invisibles" <br>      FontBold        =   0   'False <br>      FontItalic      =   0   'False <br>      FontName        =   "MS Sans Serif" <br>      FontSize        =   8.25 <br>      FontStrikethru  =   0   'False <br>      FontUnderline   =   0   'False <br>      Height          =   825 <br>      Left            =   9300 <br>      TabIndex        =   18 <br>      Top             =   555 <br>      Visible         =   0   'False <br>      Width           =   5700 <br>      Begin SSCommand cmdSubGridDetail  <br>         Caption         =   "SubGridDetail" <br>         Font3D          =   1  'Raised w/light shading <br>         FontBold        =   0   'False <br>         FontItalic      =   0   'False <br>         FontName        =   "MS Sans Serif" <br>         FontSize        =   8.25 <br>         FontStrikethru  =   0   'False <br>         FontUnderline   =   0   'False <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   495 <br>         Left            =   3570 <br>         TabIndex        =   40 <br>         Top             =   240 <br>         Visible         =   0   'False <br>         Width           =   1215 <br>      End <br>      Begin SSCommand MainButton  <br>         BevelWidth      =   1 <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   345 <br>         Index           =   7 <br>         Left            =   2850 <br>         Picture         =   AUTHORS.FRX:049C <br>         TabIndex        =   25 <br>         Top             =   300 <br>         Width           =   345 <br>      End <br>      Begin SSCommand MainButton  <br>         BevelWidth      =   1 <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   345 <br>         Index           =   6 <br>         Left            =   2325 <br>         Picture         =   AUTHORS.FRX:0636 <br>         TabIndex        =   24 <br>         Top             =   300 <br>         Width           =   345 <br>      End <br>      Begin SSCommand MainButton  <br>         BevelWidth      =   1 <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   345 <br>         Index           =   5 <br>         Left            =   1935 <br>         Picture         =   AUTHORS.FRX:07A0 <br>         TabIndex        =   23 <br>         Top             =   300 <br>         Width           =   345 <br>      End <br>      Begin SSCommand MainButton  <br>         BevelWidth      =   1 <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   345 <br>         Index           =   4 <br>         Left            =   1410 <br>         Picture         =   AUTHORS.FRX:093A <br>         TabIndex        =   22 <br>         Top             =   300 <br>         Width           =   345 <br>      End <br>      Begin SSCommand MainButton  <br>         BevelWidth      =   1 <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   345 <br>         Index           =   3 <br>         Left            =   885 <br>         Picture         =   AUTHORS.FRX:0AA4 <br>         TabIndex        =   21 <br>         Top             =   300 <br>         Width           =   345 <br>      End <br>      Begin SSCommand MainButton  <br>         BevelWidth      =   1 <br>         Enabled         =   0   'False <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   345 <br>         Index           =   2 <br>         Left            =   495 <br>         Picture         =   AUTHORS.FRX:0C0E <br>         TabIndex        =   20 <br>         Top             =   300 <br>         Width           =   345 <br>      End <br>      Begin SSCommand MainButton  <br>         BevelWidth      =   1 <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   345 <br>         Index           =   1 <br>         Left            =   105 <br>         Picture         =   AUTHORS.FRX:0D78 <br>         TabIndex        =   19 <br>         Top             =   300 <br>         Width           =   345 <br>      End <br>   End <br>   Begin Menu menFile  <br>      Caption         =   "&amp;File" <br>      Begin Menu altClose  <br>         Caption         =   "&amp;Close Form" <br>      End <br>      Begin Menu altDummy1  <br>         Caption         =   "-" <br>      End <br>      Begin Menu altExit  <br>         Caption         =   "&amp;Exit" <br>      End <br>   End <br>   Begin Menu menEdit  <br>      Caption         =   "&amp;Edit" <br>      Begin Menu altNew  <br>         Caption         =   "&amp;New" <br>         Shortcut        =   ^N <br>      End <br>      Begin Menu altSave  <br>         Caption         =   "&amp;Save" <br>         Shortcut        =   ^S <br>      End <br>      Begin Menu altDelete  <br>         Caption         =   "&amp;Delete" <br>      End <br>      Begin Menu altClear  <br>         Caption         =   "Clear &amp;Form" <br>         Shortcut        =   ^C <br>      End <br>      Begin Menu altRefresh  <br>         Caption         =   "&amp;Refresh" <br>         Shortcut        =   ^R <br>      End <br>      Begin Menu altQuery  <br>         Caption         =   "&amp;Query" <br>         Shortcut        =   ^Q <br>      End <br>      Begin Menu altCancel  <br>         Caption         =   "&amp;Cancel" <br>      End <br>      Begin Menu altDummy2  <br>         Caption         =   "-" <br>      End <br>      Begin Menu altCopy  <br>         Caption         =   "Copy &amp;to new" <br>      End <br>      Begin Menu altRelease  <br>         Caption         =   "&amp;Release" <br>      End <br>   End <br>   Begin Menu menForms  <br>      Caption         =   "Fo&amp;rms" <br>      Begin Menu altAuthors  <br>         Caption         =   "&amp;Authors" <br>         Shortcut        =   ^A <br>      End <br>   End <br>   Begin Menu menWindow  <br>      Caption         =   "&amp;Window" <br>      WindowList      =   -1  'True <br>      Begin Menu altCascade  <br>         Caption         =   "&amp;Cascade" <br>      End <br>      Begin Menu altTile  <br>         Caption         =   "&amp;Tile" <br>      End <br>      Begin Menu altArrangeIcons  <br>         Caption         =   "&amp;Arrange Icons" <br>      End <br>      Begin Menu altDummy4  <br>         Caption         =   "-" <br>      End <br>      Begin Menu altNormalSize  <br>         Caption         =   "&amp;Normal Size" <br>      End <br>   End <br>   Begin Menu menSettings  <br>      Caption         =   "&amp;Options" <br>      Begin Menu altShowSQL  <br>         Caption         =   "&amp;Show SQL" <br>      End <br>   End <br>   Begin Menu menHelp  <br>      Caption         =   "&amp;Help" <br>      Begin Menu altContents  <br>         Caption         =   "&amp;Contents" <br>      End <br>      Begin Menu altDummy3  <br>         Caption         =   "-" <br>      End <br>      Begin Menu altAbout  <br>         Caption         =   "&amp;About..." <br>      End <br>   End <br>End <br>' <br>' The AUTHORS form <br>' ================= <br>' Used for maintenance of information on authors <br>' including selecting, inserting, updating and deleting <br>' authors <br>' <br>' Constant definitions: <br>' -------------------- <br>' The nominal Width and Height of the form are saved <br>' as constants to allow the form to be properly opened <br>' as a MDI Child and to regain its normal size when <br>' that option is chosen in the menu system (Window - <br>' Normal Size): <br>Const DEFWIDTH% = 9255 <br>Const DEFMINHEIGHT% = 3060 - 280 <br>Const DEFMAXHEIGHT% = 5650 - 280 <br> <br>' The value of the constant CHUNKSIZE% determins the number of <br>' rows that will be read from the result set <br>' per chunk and added to the listbox. <br>' The value of the constant LSTPRIMMAX% is the max number of <br>' rows that will be held in the listbox lstPrim. When the <br>' number has been exeeded the application will start to remove <br>' the top row for each new row added to the listbox. <br>' <br>' NOTE! Both of these constants are indeed changeble to match <br>' your specific needs and thoughts. <br>Const CHUNKSIZE% = 100 <br>Const LSTPRIMMAX% = 500 <br>     <br> <br>' The list box shows authors names. To help locate an <br>' author whose name is selected in the list box his or <br>' her AU_ID is also stored in the list box invisible <br>' to the user. The LISTWIDTH constant is used to determine <br>' exactly where in the list box text string the AU_ID is <br>' stored. It begins on the position of LISTWIDTH + 1 (71): <br>Const LISTWIDTH% = 70 <br> <br>' Declare variables for a select channel and an update <br>' channel to SQL Server, known all over but not outside <br>' the form: <br>Dim SelChannel As Integer <br>Dim UpdChannel As Integer <br> <br>' Declare a variable to store the last used Where clause. <br>' This allows a refresh operation, sending the same SQL <br>' select clause once again to the server using the refresh <br>' tool (shower) in the tool bar: <br>Dim LastWhereClause As String <br> <br>' Declare a MODE variable to store the different modes <br>' of the form. Mode could take up either of the following <br>' values: SQLNEW, SQLSHOW or SQLREST. Those values are <br>' declared as symbolic constants in the module ADBGLOB.BAS. <br>' SQLNEW is the mode when a new author is being entered. <br>' SQLSHOW is the mode when an existing author is shown <br>' in the form for possible modification or deletion. <br>' SQLREST is the mode when the form is resting, i.e. when <br>' a selection is being made or when the form is waiting for <br>' examples to use for QBE. <br> <br>Dim Mode As Integer <br> <br>' The variable QualString save the qualification string <br>' returned from the call to SQLQUAL(). It containts references <br>' to the unique key and to the timestamp column. <br>' This is essential for Browse Mode. <br>Dim QualString As String <br> <br> <br>' The variable FormMaxOpen is TRUE if the subgrid is showned. <br>' The user brings it up by clicking on the push button for <br>' titles. To close the subgrid just click on the push button <br>' again and FormMaxOpen will be set to FALSE. <br> <br>Dim FormMaxOpen As Integer <br> <br>Sub altAbout_Click () <br>' <br>' Show the about box <br>' <br> <br>    fAbout.Show MODAL <br> <br>End Sub <br> <br>Sub altArrangeIcons_Click () <br>' <br>' Arrange the icons of the MDI application <br>' <br> <br>    MDIMA.Arrange ARRANGE_ICONS <br> <br>End Sub <br> <br>Sub altAuthors_click () <br>' <br>' Show another instance of the authors form <br>' Try opening several instances showing different <br>' sets of authors in each separate form, for instance <br>' Utah authors in one form and Michigan authors in <br>' another. Tile the forms for better overview. <br>' <br> <br>' Declare a new instance of the Authors form: <br>Dim newAuthors As New fAuthors <br> <br>    ' Open the new instance: <br>    screen.MousePointer = 11 <br>    newAuthors.Show </code></pre>
<p>
</p>
<pre><code>screen.MousePointer = 0 <br> <br>End Sub <br> <br>Sub altCancel_Click () <br>' <br>' Cancels the ongoing operation; for instance modification <br>' of data about an author. If there is any operation <br>' to cancel, the cancel push button (with the X, like <br>' in Excel) will be enabled and then automatically pushed. <br>' If it is not enable there will be a beep: <br> <br>    If MainButton(7).Enabled Then <br>        MainButton(7).Value = True <br>    Else <br>        Beep <br>    End If <br> <br>End Sub <br> <br>Sub altCascade_Click () <br>' <br>' Cascade the icons of the MDI application <br>' <br> <br> <br>    MDIMA.Arrange CASCADE <br> <br>End Sub <br> <br>Sub altClear_Click () <br>' <br>' Clears the content of the form by automatically <br>' pressing the Clear button in the main tool bar: <br> <br>    If MainButton(4).Enabled Then <br>        MainButton(4).Value = True <br>    Else <br>        Beep <br>    End If <br> <br>End Sub <br> <br>Sub altClose_Click () <br>' <br>' Closes the form by unloading it, thus securing <br>' that any unload procedure will be carried out: <br> <br>    Unload Me <br> <br>End Sub <br> <br>Sub altContents_Click () <br>Dim x%, lHelpPath As String <br>' <br>' Activate the help system <br>' <br>     <br>    lHelpPath = App.Path + "\pubs1.hlp" <br>    x% = WinHelp(MDIMA.hWnd, lHelpPath, HELP_INDEX, 0) <br> <br>End Sub <br> <br>Sub altCopy_Click () <br>' <br>' Sets the mode to SQLNEW, thus allowing the record <br>' in the form to be modified and then inserted, then <br>' sets focus to the first text field in the form. This <br>' function can save some typing: <br> <br>    Mode = SQLNEW <br>    txtAuthors(1).SetFocus <br> <br>End Sub <br> <br>Sub altDelete_Click () <br>' <br>' Starts a delete procedure by pressing the delete <br>' button in the main tool bar. If it is enabled, the <br>' process controlled by the button will be started, <br>' otherwise there will be a beep, telling that there <br>' is nothing to delete at present: <br> <br>    If MainButton(3).Enabled Then <br>        MainButton(3).Value = True <br>    Else <br>        Beep <br>    End If <br> <br>End Sub <br> <br>Sub altExit_Click () <br>' <br>' Exit the entire application by unloading the MDI <br>' form. The result will be that any opened MDI child <br>' window will be unloaded, their respective unload <br>' procedures automatically carried out: <br> <br>    Unload MDIMA <br> <br>End Sub <br> <br>Sub altNew_Click () <br>' <br>' Start the NEW procedure to enter and insert information <br>' about a new author. If the corresponding button in the <br>' main tool bar is enabled, it is pushed, otherwise a new <br>' author could not be entered at this state of the form, <br>' and a beep is heard: <br> <br>    If MainButton(1).Enabled Then <br>        MainButton(1).Value = True <br>    Else <br>        Beep <br>    End If <br> <br>End Sub <br> <br>Sub altNormalSize_Click () <br>' <br>' Reinstate the normal size of the form, if changed <br>' <br> <br>    If Me.WindowState &lt;&gt; 0 Then Me.WindowState = 0  ' normal size <br>    Me.Width = DEFWIDTH% <br>    If FormMaxOpen Then <br>        Me.Height = DEFMAXHEIGHT% <br>    Else <br>        Me.Height = DEFMINHEIGHT% <br>    End If <br>    CenterForm <br> <br>End Sub <br> <br>Sub altQuery_Click () <br>' <br>' Send a query to SQL Server by pushing the corresponding <br>' push button in the tool bar, if it is enabled. If not, <br>' there is no query to send and a beep is heard: <br> <br>    If MainButton(6).Enabled Then <br>        MainButton(6).Value = True <br>    Else <br>        Beep <br>    End If <br>     <br> <br>End Sub <br> <br>Sub altRefresh_Click () <br>' <br>' Send the same query as was last sent to SQL Server, <br>' thereby refreshing the result set to include any <br>' changes made by other users since the data was last <br>' selected: <br>' Pushes the corresponding button in the main tool bar <br>' if it is enabled. If not, a beep is heard, signalling <br>' that refresh is an inappropriate operation at this time: <br> <br>    If MainButton(5).Enabled Then <br>        MainButton(5).Value = True <br>    Else <br>        Beep <br>    End If <br> <br>End Sub <br> <br>Sub altRelease_Click () <br>' <br>' Releases the record in the form from its connection <br>' with the database, allowing the user to make changes <br>' and then use the result as an example for a query. <br>' <br>' Sets the MODE variable to SQLREST, indicating that the <br>' form is "resting" (will not allow saving the info) <br> <br>    Mode = SQLREST <br> <br>End Sub <br> <br>Sub altSave_Click () <br>' <br>' Saves the content of the form to SQL Server by issuing <br>' an UPDATE or INSERT statement. Uses the corresponding <br>' push button in the main tool bar if it is enabled. <br>' Otherwise a beep is heard, indicating that there is <br>' nothing to save right now: <br> <br>    If MainButton(2).Enabled Then <br>        MainButton(2).Value = True <br>    Else <br>        Beep <br>    End If <br> <br>End Sub <br> <br>Sub altShowSQL_Click () <br>' <br>' Controls wether SQL statements are shown in a message <br>' box or not. When this menu option is checked, all <br>' SQL statements are shown before sent to the server: <br> <br>    If altShowSQL.Checked Then <br>        altShowSQL.Checked = False <br>        ShowSQL = False <br>    Else <br>        altShowSQL.Checked = True <br>        ShowSQL = True <br>    End If <br> <br>End Sub <br> <br>Sub AltTile_Click () <br>' <br>' Tile the icons of the MDI application <br>' <br> <br> <br>    MDIMA.Arrange TILE_HORIZONTAL <br> <br>End Sub <br> <br>Sub CenterForm () <br> <br>    Me.Top = screen.Height / 2 - Me.Height / 2 - 710 <br> <br>End Sub <br> <br>Sub chkContract_Click (Value As Integer) <br>' <br>' If the form is not resting (MODE &lt;&gt; SQLREST), the <br>' SAVE and CANCEL buttons are enabled, indicating that <br>' some information that should be saved has been entered: <br> <br>    If Mode &lt;&gt; SQLREST Then <br>        MainButton(2).Enabled = True        ' save button <br>        MainButton(7).Enabled = True        ' cancel button <br>    End If <br> <br>End Sub <br> <br>Sub ClearFields () <br>' <br>' Clear the contents of any field in the form <br>' <br> <br>Dim x As Integer, lMODE As Integer <br> <br>    lMODE = Mode        ' Save actual Mode value <br>    Mode = SQLREST      ' Set Mode to resting <br>    For x = 1 To 8 <br>        txtAuthors(x).Text = "" <br>    Next <br>    chkContract.Value = False <br>    Mode = lMODE        ' Reset initial mode <br> <br>End Sub <br> <br>Sub ClearForm () <br>Dim lMODE As Integer <br> <br>    lMODE = Mode        ' Save actual mode <br>    Mode = SQLREST      ' Set mode to resting <br>    lstPrim.Clear       ' Clear primary list box <br>    ClearFields         ' Clear all fields <br>    If FormMaxOpen Then ClearGrid grdTitles ' clear the grid <br>    panItemsRead.Caption = "" <br>    panItemsRemoved.Caption = "" <br>    Mode = lMODE        ' Reset initial mode <br>    SetMainButtons Mode ' Enable/Disable buttons in toolbar <br>    txtAuthors(1).SetFocus <br> <br>End Sub <br> <br>Sub ClearGrid (pGrid As Control) <br>' <br>' Clear the grid <br>' <br> <br>Dim x As Integer, y As Integer <br> <br>    For x = 1 To pGrid.Rows - 1 <br>        pGrid.Row = x <br>        For y = 0 To pGrid.Cols - 1 <br>            pGrid.Col = y <br>            pGrid.Text = "" <br>        Next <br>    Next <br> <br>End Sub <br> <br>Sub cmdDown_Click (Value As Integer) <br>' <br>' Shows the sub grid with titles for an author <br>' <br> <br>    If cmdDown.Value = False Then <br>        SubGridClose <br>        Exit Sub <br>    End If <br>    If Me.WindowState &lt;&gt; 2 Then <br>        Me.Height = DEFMAXHEIGHT% <br>        CenterForm <br>    End If <br>    FormMaxOpen = True <br>    frmTitles.Visible = True <br>    If Len(RTrim$(txtAuthors(1).Text)) &gt; 0 Then <br>        cmdSubGridDetail.Value = True <br>    Else <br>        HighlightGridRow grdTitles, 1 <br>    End If <br>     <br> <br>End Sub <br> <br>Sub cmdMoreRows_Click () <br>' <br>' This button is enabled whenever the result set <br>' contains rows that has not yet been read and <br>' transferred to the lstPrim listbox. When the <br>' user presses this button another chunk of <br>' CHUNKSIZE% rows are read. When all the rows of <br>' the result set has been read (NO_MORE_ROWS) this <br>' button is disabled. <br> <br>    SQLGetRows <br> <br>End Sub <br> <br>Sub cmdSubGridDetail_Click () <br>' <br>' Sending a SQL statement and filling the sub grid <br>' with titles for a specific author <br>' <br> <br>Dim lCmd$, lId$, res% <br> <br>    lId$ = txtAuthors(1).Text <br>    lCmd$ = "select t.title_id, title, type, price, " <br>    lCmd$ = lCmd$ + "advance, royalty, ytd_sales, " <br>    lCmd$ = lCmd$ + "notes, pubdate " <br>    lCmd$ = lCmd$ + "from titles t, titleauthor ta " <br>    lCmd$ = lCmd$ + "where t.title_id = ta.title_id " <br>    lCmd$ = lCmd$ + "and ta.au_id = " + Chr$(34) + lId$ + Chr$(34) <br>    ClearGrid grdTitles <br>    res% = SQLComm(UpdChannel%, lCmd$) <br>    If res% = SUCCEED Then SQLFillGrid grdTitles, UpdChannel% <br>    HighlightGridRow grdTitles, 1 <br> <br>End Sub <br> <br>Function EvaluateForm () <br>' <br>' Evaluate each field in the form and create a where clause <br>' for the Select statement <br>' <br> <br>Dim lRetStr$, x As Integer <br> <br>    ' Initialize return string. <br>    ' (Not neccessary but neater.) <br>    lRetStr$ = "" <br>    For x = 1 To 8      ' Loop through each text box in form <br>        If Len(RTrim$(txtAuthors(x).Text)) &gt; 0 Then <br>            If Len(Trim$(lRetStr$)) Then lRetStr$ = lRetStr$ + " and " <br>            Select Case x <br>                ' Build condition for each field: <br>                Case 1 <br>                    lRetStr$ = lRetStr$ + "au_id like " + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) <br>                Case 2 <br>                    lRetStr$ = lRetStr$ + "au_fname like " + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) <br>                Case 3 <br>                    lRetStr$ = lRetStr$ + "au_lname like " + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) <br>                Case 4 <br>                    lRetStr$ = lRetStr$ + "address like " + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) <br>                Case 5 <br>                    lRetStr$ = lRetStr$ + "zip like " + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) <br>                Case 6 <br>                    lRetStr$ = lRetStr$ + "city like " + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) <br>                Case 7 <br>                    lRetStr$ = lRetStr$ + "state like " + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) <br>                Case 8 <br>                    lRetStr$ = lRetStr$ + "phone like " + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) <br>            End Select <br>        End If <br>    Next <br>    ' Check check box content, build upon the where clause: <br>    If chkContract.Value = True Then        ' checked <br>        If Len(Trim$(lRetStr$)) Then lRetStr$ = lRetStr$ + " and " <br>        lRetStr$ = lRetStr$ + "contract = 1" <br>    End If <br>    LastWhereClause = lRetStr$      ' Save as last used clause <br>    EvaluateForm = lRetStr$         ' Return where clause <br> <br>End Function <br> <br>Sub Form_Activate () <br> <br>    If ShowSQL Then <br>        altShowSQL.Checked = True <br>    Else <br>        altShowSQL.Checked = False <br>    End If <br>     <br>End Sub <br> <br>Sub Form_Load () <br>' <br>' Set up the form at load time <br>' <br> <br>Dim res%, lMsg$ <br> <br>    ' Set The Width and Height properties of the form <br>    ' to their predefined values. Setting the Top and <br>    ' Left properties to center the form within the <br>    ' MDI form: <br>    Me.Width = DEFWIDTH% <br>    Me.Height = DEFMINHEIGHT% <br>    CenterForm <br>    Me.Left = screen.Width / 2 - Me.Width / 2 <br>     <br>    ' Opening two connections to SQL Server, one for selecting <br>    ' sets of authors, another for updating purposes. <br>    ' Putting the pubs database (Database$) in use: <br>    SelChannel = Logon%(Server$, LoginId$, Password$, WorkSta$, AppName$) <br>    UpdChannel = Logon%(Server$, LoginId$, Password$, WorkSta$, AppName$) <br>    res% = SqlUse(SelChannel, Database$) <br>    res% = SqlUse(UpdChannel, Database$) <br>     <br>    ' Check the status of the TIMESTAMP column in the Authors table <br>    res% = CheckifTimestamp(SelChannel) <br>    If res% = False Then <br>        res% = AskifAlter() <br>        If res% Then <br>            res% = AlterAuthors(SelChannel) <br>            Beep <br>            If res% Then <br>                lMsg$ = "The Authors table has been successfully altered with a TIMESTAMP column." <br>                MsgBox lMsg$, 64 <br>            Else <br>                lMsg$ = "There was some problem altering and updating the Authors table." + NEWLINE$ + NEWLINE$ <br>                lMsg$ = lMsg$ + "The sample application will terminate." <br>                MsgBox lMsg$, 48 <br>                Unload MDIMA <br>            End If <br>        Else <br>            Beep <br>            MsgBox "Sorry, the sample application will terminate.", 48 <br>            Unload MDIMA            ' this will terminate the application <br>        End If <br>    End If <br>     <br>    ' Specify the sub grid for titles <br>    SpecifyGrid <br> <br>End Sub <br> <br>Sub Form_Unload (Cancel As Integer) <br> <br>    SqlClose SelChannel <br>    SqlClose UpdChannel <br> <br>End Sub <br> <br>Sub grdTitles_Click () <br> <br>    HighlightGridRow grdTitles, (grdTitles.Row) <br> <br>End Sub <br> <br>Sub HandleEmptyQual () <br>Dim lMsg$ <br> <br>    Beep <br>    lMsg$ = EmptyQualString() <br>    MsgBox lMsg$, 16, "Empty qual string" <br>    RefreshFormFields <br> <br>End Sub <br> <br>Sub HighlightGridRow (pGrid As Control, pRowNmbr As Integer) <br>' <br>' Highlights the selected row in the grid <br>' <br> <br>    If pRowNmbr = 0 Then pRowNmbr = 1       ' to avoide VB error <br>    pGrid.Row = pRowNmbr <br>    pGrid.SelStartRow = pRowNmbr <br>    pGrid.SelEndRow = pRowNmbr <br>    pGrid.Col = pGrid.Cols - 1 <br>    pGrid.SelStartCol = 0 <br>    pGrid.SelEndCol = pGrid.Cols - 1 <br> <br>End Sub <br> <br>Sub lstPrim_Click () <br>' <br>' If there are any items in the primary list box when <br>' a click event occurs, then SQLGetDetailRow is called <br>' to get all information on the selected author and put <br>' it in the form fields. MODE is set to SQLREST in order <br>' to prevent some change actions on the different fields. <br>' After the author is shown, MODE is set to SQLSHOW, <br>' indicating that the form is active (an author in it) <br> <br>    If lstPrim.ListIndex &lt;&gt; -1 Then <br>        Mode = SQLREST <br>        SQLGetDetailRow <br>        Mode = SQLSHOW <br>    End If <br>     <br>End Sub <br> <br>Sub MainButton_Click (index As Integer) <br>Dim x As Integer <br>' <br>' MainButton is a control array of push buttons. <br>' They may be clicked by the user directly or by <br>' menu choices where the users select a menu item <br>' and the menu item pushes a button by setting its <br>' Value property True. <br> <br> <br>    Select Case index <br>        Case 1              ' new <br>            ' Click button 4 to clear the fields: <br>            MainButton(4).Value = True <br>            ' Enable the cancel button: <br>            MainButton(7).Enabled = True <br>            ' Set MODE to SQLNEW to allow saving: <br>            Mode = SQLNEW <br>        Case 2              ' save <br>            ' Call the SAVE routine, who knows how <br>            ' to do inserts and updates: <br>            SQLSave <br>        Case 3              ' delete <br>            ' Call the SQLDelete routine: <br>            SQLDelete <br>        Case 4              ' clear form <br>            ClearForm <br>        Case 5              ' refresh <br>            ' Send the same Select statement as last was sent: <br>            SQLQuery "REFRESH" <br>        Case 6              ' query <br>            ' Send a Select statement based on examples given <br>            ' by filling in parts of the form: <br>            SQLQuery "" <br>        Case 7              ' cancel <br>            ' Reset to same as before any changes were made: <br>            If Mode = SQLSHOW Then <br>                Mode = SQLREST <br>                x = lstPrim.ListIndex <br>                lstPrim.ListIndex = -1 <br>                lstPrim.ListIndex = x <br>                Mode = SQLSHOW <br>            Else <br>                ClearForm <br>                Mode = SQLREST <br>            End If <br>    End Select <br> <br>End Sub <br> <br>Sub RefreshFormFields () <br>Dim x As Integer <br> <br>    x = lstPrim.ListIndex <br>    lstPrim.ListIndex = -1 <br>    lstPrim.ListIndex = x <br> <br>End Sub <br> <br>Function RowToListbox () <br>' <br>' Building a string to be added to the listbox: <br> <br>Dim lBoxString As String <br> <br>    ' Last and First Name: <br>    lBoxString = RTrim$(SQLData(SelChannel, 1)) + ", " + SQLData(SelChannel, 2) <br>    ' Id: <br>    lBoxString = Left$(lBoxString + Space$(LISTWIDTH%), LISTWIDTH%) + SQLData(SelChannel, 3) <br>    RowToListbox = lBoxString <br> <br>End Function <br> <br>Sub SetMainButtons (pMode As Integer) <br>' <br>' Enable/Disable buttons in tool bar based on <br>' actual Mode: <br> <br>    MainButton(1).Enabled = True <br>    MainButton(2).Enabled = False <br>    MainButton(4).Enabled = True <br>    MainButton(7).Enabled = False <br>    If pMode = SQLSHOW Then <br>        MainButton(3).Enabled = True <br>    Else <br>        MainButton(3).Enabled = False <br>    End If <br> <br>End Sub <br> <br>Sub SetNmbrofRowsPanels (pNmbrRows, pRemoved) <br>' <br>' Sets the right information for how many <br>' rows that have been read from the result <br>' set, and how many rows that have been <br>' removed from the listbox: <br> <br>    If Len(panItemsRead.Caption) &gt; 0 Then <br>        pNmbrRows = pNmbrRows + Val(panItemsRead.Caption) <br>    End If <br>    If Len(panItemsRemoved.Caption) &gt; 0 Then <br>        pRemoved = Val(panItemsRemoved.Caption) + pRemoved <br>    End If <br>    panItemsRead.Caption = Str$(pNmbrRows) + " rows read" <br>    If pRemoved &gt; 0 Then <br>        panItemsRemoved.Caption = Str$(pRemoved) + " rows removed" <br>    Else <br>        panItemsRemoved.Caption = "" <br>    End If <br> <br>End Sub <br> <br>Sub SpecifyGrid () <br>' <br>' Specify the sub grid for titles <br>' <br> <br>    grdTitles.Rows = 10 <br>    grdTitles.Cols = 9 <br>    grdTitles.Row = 0 <br>    grdTitles.Col = 0 <br>    grdTitles.Text = "Title id" <br>    grdTitles.ColWidth(0) = 750 <br>    grdTitles.Col = 1 <br>    grdTitles.Text = "Title" <br>    grdTitles.ColWidth(1) = 3500 <br>    grdTitles.Col = 2 <br>    grdTitles.Text = "Type" <br>    grdTitles.ColWidth(2) = 855 <br>    grdTitles.Col = 3 <br>    grdTitles.Text = "Price" <br>    grdTitles.ColWidth(3) = 645 <br>    grdTitles.Col = 4 <br>    grdTitles.Text = "Advance" <br>    grdTitles.ColWidth(4) = 960 <br>    grdTitles.Col = 5 <br>    grdTitles.Text = "Royalty" <br>    grdTitles.ColWidth(5) = 645 <br>    grdTitles.Col = 6 <br>    grdTitles.Text = "YTD sales" <br>    grdTitles.ColWidth(6) = 840 <br>    grdTitles.Col = 7 <br>    grdTitles.Text = "Notes" <br>    grdTitles.ColWidth(7) = 4050 <br>    grdTitles.Col = 8 <br>    grdTitles.Text = "Pub. date" <br>    grdTitles.ColWidth(8) = 1050 <br>     <br>End Sub <br> <br>Sub SQLDelete () <br>' <br>' Create an appropriate delete statement, based on the actual <br>' record shown in the form. Ask the user to confirm the delete. <br>' If all is well: Send the delete statement: <br> <br>Dim lCmd$, x As Integer, res% <br> <br>    If Len(RTrim$(txtAuthors(1).Text)) = 0 Or Mode &lt;&gt; SQLSHOW Then <br>        Beep <br>        Exit Sub            ' Nothing to delete <br>    End If <br>    If Len(RTrim$(txtAuthors(1).Text)) &gt; 0 Then <br>        lCmd$ = "Delete authors " + QualString <br>        ' Check if the variable QualString is blank - if so we can <br>        ' not allow any deletions <br>        If Len(RTrim$(QualString)) = 0 Then <br>            HandleEmptyQual <br>            screen.MousePointer = 0 <br>            Exit Sub <br>        End If <br>         <br>        If MsgBox("Do you really want to delete this row?", 36, "Delete") = 6 Then <br>            ' Use the SQLComm function to perform the delete: <br>            screen.MousePointer = 11 <br>            res% = SQLComm%(UpdChannel, lCmd$) <br>            If res% = SUCCEED% Then <br>                ' Remove record from form and set up form for continuation: <br>                Mode = SQLREST <br>                x = lstPrim.ListIndex <br>                ClearFields <br>                If x &lt;&gt; -1 Then lstPrim.RemoveItem x <br>                ClearGrid grdTitles <br>            End If <br>            screen.MousePointer = 0 <br>        End If <br>    End If <br> <br>End Sub <br> <br>Sub SQLFillGrid (pGrid As Control, pChannel%) <br>' <br>' Filling then grid with data <br>' <br> <br>Dim x As Integer <br> <br>    pGrid.Row = 0: pGrid.Rows = 10 <br>    Do <br>        res% = SQLNextRow(pChannel%) <br>        Select Case res% <br>        Case REGROW <br>            If pGrid.Row &gt;= pGrid.Rows - 1 Then pGrid.Rows = pGrid.Rows + 1 <br>            pGrid.Row = pGrid.Row + 1 <br>            For x = 0 To pGrid.Cols - 1 <br>                pGrid.Col = x <br>                pGrid.Text = SQLData(pChannel%, x + 1) <br>            Next <br>        Case NOMOREROWS <br>            pGrid.Col = 0 <br>            pGrid.Row = 1 <br>            Exit Do <br>        Case Else <br>            Exit Do        ' error message by ordinary VBSQL-error routine <br>        End Select <br>    Loop Until 1 = 0 <br>' ------------------------------------------------ <br> <br>End Sub <br> <br>Sub SQLGetDetailRow () <br>' <br>' The user has selected an item in the primary list box. <br>' This routine creates and sends a SQL statement to <br>' retrieve all information on the selected author: <br> <br>Dim lAu_Id$, lCmd$, res%, x As Integer <br> <br>    screen.MousePointer = 11 <br>    ' The AU_ID field is positioned beyond LISTWIDTH% in the list box item: <br>    lAu_Id$ = Mid$(lstPrim.List(lstPrim.ListIndex), LISTWIDTH% + 1) <br> <br>    lCmd$ = "select au_id, au_fname, au_lname, address, zip, city, " <br>    lCmd$ = lCmd$ + "state, phone, contract " <br>    lCmd$ = lCmd$ + "from authors " <br>    lCmd$ = lCmd$ + "where au_id = " + Chr$(34) + lAu_Id$ + Chr$(34) <br>    lCmd$ = lCmd$ + " FOR BROWSE" <br>     <br>    ' Send the select statement and check the result: <br>    res% = SQLComm(UpdChannel, lCmd$) <br>    If res% = SUCCEED% Then <br>        res% = SQLNextRow(UpdChannel) <br>        QualString = sqlqual(UpdChannel, 1, "") <br>        If res% = REGROW Then <br>            ' Show each separate field: <br>            For x = 1 To 8 <br>                txtAuthors(x).Text = SQLData(UpdChannel, x) <br>            Next <br>            chkContract.Value = SQLData(UpdChannel, 9) <br>        End If <br>    End If <br>    ' Check to see if the sub grid is showned - if so we will <br>    ' refresh it with data from the selected author <br>    If FormMaxOpen Then cmdSubGridDetail.Value = True <br>    screen.MousePointer = 0 <br> <br>End Sub <br> <br>Sub SQLGetRows () <br>' <br>' This routine loops through the result set and <br>' add rows to the listbox: <br> <br> <br>Dim lNmbrRows As Integer, lItems%, res% <br>Dim lNoMoreRowsToRead  As Integer, lRemoved As Integer <br> <br>    lNoMoreRowsToRead = False <br>    For lNmbrRows = 1 To CHUNKSIZE% <br>        res% = SQLNextRow(SelChannel) <br>        If res% = REGROW Then <br>            lstPrim.AddItem RowToListbox() <br>        ElseIf res% = NOMOREROWS Then <br>            lNoMoreRowsToRead = True <br>            Exit For <br>        Else <br>            Exit For            ' error message by ordinary VBSQL-error routine <br>        End If <br>        If lstPrim.ListCount &gt; LSTPRIMMAX% Then <br>            lstPrim.RemoveItem 0 <br>            lRemoved = lRemoved + 1 <br>        End If <br>    Next <br>    lNmbrRows = lNmbrRows - 1 <br>     <br>    If lNoMoreRowsToRead Then          'no more rows to read from the result set <br>        cmdMoreRows.Enabled = False <br>    Else <br>        cmdMoreRows.Enabled = True <br>    End If <br>     <br>    SetNmbrofRowsPanels lNmbrRows, lRemoved <br> <br>End Sub <br> <br>Sub SQLInsert () <br>' <br>' Create an Insert statement and send it to SQL Server: <br>' <br> <br>Dim lCmd$, x As Integer, res%, lKey$ <br> <br>    screen.MousePointer = 11 <br>    lCmd$ = "Insert authors (" <br>    lCmd$ = lCmd$ + "au_id, au_fname, au_lname, address, " <br>    lCmd$ = lCmd$ + "zip, city, state, phone, contract) " <br>    lCmd$ = lCmd$ + "values (" <br>    For x = 1 To 8      ' Evaluate the content of each field <br>        lCmd$ = lCmd$ + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) + ", " <br>    Next <br>    lCmd$ = lCmd$ + Abs(chkContract.Value) + ")" <br>     <br>    ' Send to SQL Server and check result; Set up form after success: <br>    res% = SQLComm%(SelChannel, lCmd$) <br>    If res% = SUCCEED% Then <br>        Mode = SQLREST <br>        lKey$ = txtAuthors(1).Text <br>        MainButton(4).Value = True      ' Clear form <br>        txtAuthors(1).Text = lKey$      ' Set up query for inserted Author <br>        MainButton(6).Value = True      ' Send query <br>        Mode = SQLSHOW <br>    Else <br>        Mode = SQLREST <br>    End If <br>    lstPrim.SetFocus <br>    screen.MousePointer = 0 <br>     <br>End Sub <br> <br>Sub SQLQuery (pMode As String) <br>' <br>' Evaluate the form content for a QBE Select statement <br>' Send it to SQL Server. Read the result set and use it <br>' to populate the primary list box: <br> <br>Dim lCmd$, lWhereClause$, res% <br> <br>    screen.MousePointer = 11 <br>    Mode = SQLREST <br>    panItemsRead.Caption = "" <br>    panItemsRemoved.Caption = "" <br>    If pMode = "REFRESH" Then <br>        lWhereClause$ = LastWhereClause$ <br>    Else <br>        lWhereClause$ = EvaluateForm() <br>    End If <br>    lstPrim.Clear <br>    lCmd$ = "select au_lname, au_fname, au_id " <br>    lCmd$ = lCmd$ + "from authors " <br>    If Len(RTrim$(lWhereClause$)) Then <br>        lCmd$ = lCmd$ + "where " + lWhereClause$ + " " <br>    End If <br>    lCmd$ = lCmd$ + "order by au_lname, au_fname" <br>     <br>    res% = SQLComm(SelChannel, lCmd$) <br>     <br>    If res% = SUCCEED% Then <br>        SQLGetRows <br>    End If <br>    If lstPrim.ListCount &gt; 0 Then <br>        lstPrim.ListIndex = 0           ' Autoclick on first in list box <br>        Mode = SQLSHOW <br>        SetMainButtons Mode <br>    Else <br>        Mode = SQLREST <br>    End If <br>    screen.MousePointer = 0 <br> <br>End Sub <br> <br>Sub SQLSave () <br>' <br>' Choose wether to create an insert or update statement based <br>' on the actual Mode: <br> <br>    If Mode = SQLNEW Then <br>        SQLInsert <br>    Else <br>        SQLUpdate <br>    End If <br>    ' NOTE: Mode will be changed by SQLInsert/SQLUpdate <br>    SetMainButtons Mode <br> <br>End Sub <br> <br>Sub SQLUpdate () <br>' <br>' Create an Update statement and send it to SQL Server: <br> <br>Dim lCmd$, lRow$, x As Integer, res% <br> <br>    screen.MousePointer = 11 <br>    If Len(RTrim$(txtAuthors(1).Text)) &gt; 0 Then <br>        lCmd$ = "Update authors set " <br>        For x = 2 To 8      ' Evaluate the content of each non key field <br>            Select Case x <br>                Case 2 <br>                    lCmd$ = lCmd$ + "au_fname = " + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) + ", " <br>                Case 3 <br>                    lCmd$ = lCmd$ + "au_lname = " + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) + ", " <br>                Case 4 <br>                    lCmd$ = lCmd$ + "address = " + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) + ", " <br>                Case 5 <br>                    lCmd$ = lCmd$ + "zip = " + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) + ", " <br>                Case 6 <br>                    lCmd$ = lCmd$ + "city = " + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) + ", " <br>                Case 7 <br>                    lCmd$ = lCmd$ + "state = " + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) + ", " <br>                Case 8 <br>                    lCmd$ = lCmd$ + "phone = " + Chr$(34) + RTrim$(txtAuthors(x).Text) + Chr$(34) + ", " <br>            End Select <br>        Next <br>        lCmd$ = lCmd$ + "contract = " + Abs(chkContract.Value) <br>        lCmd$ = lCmd$ + " " + QualString <br>        ' Control to see if the variable QualString is blank - if so we can not allow any update <br>        If Len(RTrim$(QualString)) = 0 Then <br>            HandleEmptyQual <br>            screen.MousePointer = 0 <br>            Exit Sub <br>        End If <br>        ' Send to SQL Server and check result; Set up form after success: <br>        res% = SQLComm%(UpdChannel, lCmd$) <br>        If res% = SUCCEED% Then <br>            Mode = SQLREST <br>            lRow$ = Left$(RTrim$(txtAuthors(3).Text) + ", " + txtAuthors(2).Text + Space$(LISTWIDTH%), LISTWIDTH%) + txtAuthors(1).Text <br>            ' Modify list box item to reflect possible changes from update: <br>            If lstPrim.ListIndex &lt;&gt; -1 Then     ' to prevent a VB error <br>                x = lstPrim.ListIndex <br>                lstPrim.RemoveItem x <br>                lstPrim.AddItem lRow$, x <br>                lstPrim.ListIndex = x <br>                Mode = SQLSHOW <br>            End If <br>        Else <br>            RefreshFormFields <br>        End If <br>    Else <br>        Beep <br>        MsgBox "The update operation was not successful.", 16 <br>    End If <br>    screen.MousePointer = 0 <br> <br>End Sub <br> <br>Sub SubGridClose () <br>' <br>' Clears the grid and makes it invisible <br>' <br> <br>    If Me.WindowState &lt;&gt; 2 Then <br>        Me.Height = DEFMINHEIGHT% <br>        CenterForm <br>    End If <br>    FormMaxOpen = False <br>    ClearGrid grdTitles <br>    frmTitles.Visible = False <br>     <br>End Sub <br> <br>Sub txtAuthors_Change (index As Integer) <br>' <br>' If changes are made to any text field included in the <br>' control array of text boxes, and if MODE is anything <br>' else than SQLREST, then enable the save button and <br>' the cancel button. This makes it possible to save or <br>' cancel any modifications made: <br> <br>    If Mode &lt;&gt; SQLREST Then <br>        MainButton(2).Enabled = True        ' save button <br>        MainButton(7).Enabled = True        ' cancel button <br>    End If <br> <br>End Sub <br> <br>Sub txtAuthors_GotFocus (index As Integer) <br> <br>    ' Modification of key field prevented <br>    If Mode = SQLSHOW And index = 1 Then txtAuthors(index + 1).SetFocus <br>    ' Highlight existing entry <br>    txtAuthors(index).SelStart = 0 <br>    txtAuthors(index).SelLength = Len(RTrim$(txtAuthors(index).Text)) <br> <br>End Sub <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
