<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MDIMA.FRM</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2440"></a>MDIMA.FRM</h2>
<pre><code>VERSION 2.00 <br>Begin MDIForm MDIMa  <br>   Caption         =   "Demo ADBPubs" <br>   Height          =   4755 <br>   Icon            =   MDIMA.FRX:0000 <br>   Left            =   75 <br>   LinkTopic       =   "MDIForm1" <br>   Top             =   555 <br>   Width           =   7740 <br>   WindowState     =   2  'Maximized <br>   Begin SSPanel panStatusbar  <br>      Align           =   2  'Align Bottom <br>      Alignment       =   2  'Left Justify - BOTTOM <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      BevelInner      =   2  'Raised <br>      BevelOuter      =   0  'None <br>      BorderWidth     =   0 <br>      FontBold        =   0   'False <br>      FontItalic      =   0   'False <br>      FontName        =   "MS Sans Serif" <br>      FontSize        =   8.25 <br>      FontStrikethru  =   0   'False <br>      FontUnderline   =   0   'False <br>      ForeColor       =   &amp;H00000000&amp; <br>      Height          =   420 <br>      Left            =   0 <br>      Outline         =   -1  'True <br>      TabIndex        =   8 <br>      Top             =   3645 <br>      Width           =   7620 <br>      Begin SSPanel panInfo  <br>         Alignment       =   2  'Left Justify - BOTTOM <br>         AutoSize        =   3  'AutoSize Child To Panel <br>         BackColor       =   &amp;H00C0C0C0&amp; <br>         BevelInner      =   1  'Inset <br>         BevelOuter      =   0  'None <br>         BorderWidth     =   0 <br>         Caption         =   " Server: [Not logged in]" <br>         FontBold        =   0   'False <br>         FontItalic      =   0   'False <br>         FontName        =   "MS Sans Serif" <br>         FontSize        =   8.25 <br>         FontStrikethru  =   0   'False <br>         FontUnderline   =   0   'False <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   300 <br>         Left            =   120 <br>         TabIndex        =   11 <br>         Top             =   60 <br>         Width           =   12930 <br>      End <br>      Begin VBSQL VBSQL1  <br>         Caption         =   "VBSQL1" <br>         Height          =   210 <br>         Left            =   12555 <br>         Top             =   105 <br>         Visible         =   0   'False <br>         Width           =   525 <br>      End <br>   End <br>   Begin SSPanel panToolbar  <br>      Align           =   1  'Align Top <br>      AutoSize        =   3  'AutoSize Child To Panel <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      BorderWidth     =   4 <br>      ForeColor       =   &amp;H00000000&amp; <br>      Height          =   435 <br>      Left            =   0 <br>      Outline         =   -1  'True <br>      TabIndex        =   0 <br>      Top             =   0 <br>      Width           =   7620 <br>      Begin CommandButton cmdUnloadActForms  <br>         Caption         =   "Unload Forms" <br>         Height          =   270 <br>         Left            =   9570 <br>         TabIndex        =   12 <br>         Top             =   75 <br>         Visible         =   0   'False <br>         Width           =   1455 <br>      End <br>      Begin SSCommand cmdLogin  <br>         BevelWidth      =   1 <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   345 <br>         Left            =   8610 <br>         Picture         =   MDIMA.FRX:0302 <br>         TabIndex        =   10 <br>         TabStop         =   0   'False <br>         Top             =   45 <br>         Width           =   345 <br>      End <br>      Begin SSCommand cmdLogout  <br>         BevelWidth      =   1 <br>         Enabled         =   0   'False <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   345 <br>         Left            =   9000 <br>         Picture         =   MDIMA.FRX:0604 <br>         TabIndex        =   9 <br>         TabStop         =   0   'False <br>         Top             =   45 <br>         Width           =   345 <br>      End <br>      Begin SSCommand MainButton  <br>         BevelWidth      =   1 <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   340 <br>         Index           =   1 <br>         Left            =   75 <br>         Picture         =   MDIMA.FRX:0906 <br>         TabIndex        =   7 <br>         Top             =   45 <br>         Width           =   340 <br>      End <br>      Begin SSCommand MainButton  <br>         BevelWidth      =   1 <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   340 <br>         Index           =   2 <br>         Left            =   465 <br>         Picture         =   MDIMA.FRX:0A70 <br>         TabIndex        =   6 <br>         Top             =   45 <br>         Width           =   340 <br>      End <br>      Begin SSCommand MainButton  <br>         BevelWidth      =   1 <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   340 <br>         Index           =   3 <br>         Left            =   855 <br>         Picture         =   MDIMA.FRX:0BDA <br>         TabIndex        =   5 <br>         Top             =   45 <br>         Width           =   340 <br>      End <br>      Begin SSCommand MainButton  <br>         BevelWidth      =   1 <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   340 <br>         Index           =   4 <br>         Left            =   1380 <br>         Picture         =   MDIMA.FRX:0D44 <br>         TabIndex        =   4 <br>         Top             =   45 <br>         Width           =   340 <br>      End <br>      Begin SSCommand MainButton  <br>         BevelWidth      =   1 <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   340 <br>         Index           =   5 <br>         Left            =   1905 <br>         Picture         =   MDIMA.FRX:0EAE <br>         TabIndex        =   3 <br>         Top             =   45 <br>         Width           =   340 <br>      End <br>      Begin SSCommand MainButton  <br>         BevelWidth      =   1 <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   340 <br>         Index           =   6 <br>         Left            =   2295 <br>         Picture         =   MDIMA.FRX:1048 <br>         TabIndex        =   2 <br>         Top             =   45 <br>         Width           =   340 <br>      End <br>      Begin SSCommand MainButton  <br>         BevelWidth      =   1 <br>         Font3D          =   1  'Raised w/light shading <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   340 <br>         Index           =   7 <br>         Left            =   2820 <br>         Picture         =   MDIMA.FRX:11B2 <br>         TabIndex        =   1 <br>         Top             =   45 <br>         Width           =   340 <br>      End <br>   End <br>   Begin Menu MenFile  <br>      Caption         =   "&amp;File" <br>      Begin Menu altLogin  <br>         Caption         =   "&amp;Login" <br>         Shortcut        =   ^L <br>      End <br>      Begin Menu altLogout  <br>         Caption         =   "Log&amp;out" <br>         Enabled         =   0   'False <br>      End <br>      Begin Menu altDummy  <br>         Caption         =   "-" <br>      End <br>      Begin Menu AltExit  <br>         Caption         =   "&amp;Exit" <br>      End <br>   End <br>   Begin Menu MenForms  <br>      Caption         =   "F&amp;orms" <br>      WindowList      =   -1  'True <br>      Begin Menu altAuthors  <br>         Caption         =   "&amp;Authors" <br>         Enabled         =   0   'False <br>         Shortcut        =   ^A <br>      End <br>   End <br>   Begin Menu menHelp  <br>      Caption         =   "&amp;Help" <br>      Begin Menu altContents  <br>         Caption         =   "&amp;Contents" <br>      End <br>      Begin Menu altDummy2  <br>         Caption         =   "-" <br>      End <br>      Begin Menu altAbout  <br>         Caption         =   "&amp;About..." <br>      End <br>   End <br>End <br> <br>Sub altAbout_Click () <br>' <br>' Show the About box <br>' <br> <br>    fAbout.Show MODAL <br> <br>End Sub <br> <br>Sub altAuthors_click () <br>' <br>' Open the Authors form <br>' The menu in the Authors form allows opening <br>' of several simultaneous instances of the Authors form <br>' <br> <br>    screen.MousePointer = 11 <br>    fAuthors.Show <br>    screen.MousePointer = 0 <br> <br>End Sub <br> <br>Sub altContents_Click () <br>Dim X%, lHelpPath As String <br>' <br>' Activate the help system <br>' <br>     <br>    lHelpPath = App.Path + "\pubs1.hlp" <br>    X% = WinHelp(MDIMA.hWnd, lHelpPath, HELP_INDEX, 0) <br> <br>End Sub <br> <br>Sub altExit_Click () <br>' <br>' Exit the application <br>' <br>    Unload Me       ' Unload the MDI form and so exit the app. <br>    ' Better then end, since unload will call <br>    ' the MDIForm_Unload procedure <br> <br>End Sub <br> <br>Sub altLogin_Click () <br>' <br>' Call the log in procedure <br>' <br> <br>    ' Auto press the cmdLogin push button if it is enabled: <br>    If cmdLogin.Enabled Then <br>        cmdLogin.Value = True <br>    Else <br>        Beep <br>    End If <br>     <br>End Sub <br> <br>Sub altLogout_Click () <br>' <br>' Call the log out procedure <br>' <br> <br>    ' Auto press the cmdLogout push button if it is enabled: <br>    If cmdLogout.Enabled Then <br>        cmdLogout.Value = True <br>    Else <br>        Beep <br>    End If <br> <br>End Sub <br> <br>Sub cmdLogin_Click () <br>' <br>' Show the login form <br>' <br> <br>    fLogin.Show <br> <br>End Sub <br> <br>Sub cmdLogout_Click () <br>' <br>' Log out from SQL Server and do neccessary maintaneance <br>' <br> <br>    ' Set caption of panel to show "not logged in": <br>    panInfo.Caption = " Server: [Not logged in]" <br> <br>    SqlExit             ' close all connections to SQL Server <br>     <br>    ' Press invisible push button to unload all active forms: <br>    cmdUnloadActForms.Value = True <br>     <br>    ' Disable objects inappropriate when not logged in: <br>    altAuthors.Enabled = False <br>    altLogout.Enabled = False <br>    cmdLogout.Enabled = False <br> <br>End Sub <br> <br>Sub cmdUnloadActForms_Click () <br>' <br>' Unload all forms. <br>' Normally called when logging out. <br>' Thus no qualified info will be shown on the screen <br>' after the user with permissions has logged out <br>' <br> <br>On Error GoTo cmdActFormError <br> <br>    ' In a loop: unload all forms: <br>    Do <br>        ' Unload the active form; make another active: <br>        Unload ActiveForm <br>    Loop <br> <br>cmdActFormExit: <br>    Exit Sub <br> <br>cmdActFormError: <br>    ' Presume no more active forms; go to exit: <br>    Resume cmdActFormExit: <br> <br>End Sub <br> <br>Sub MainButton_Click (index As Integer) <br>' <br>' The main buttons are organized as a button array, <br>' where each button has a corresponding button in <br>' each (or most) forms. When the users click on a <br>' button in the MDI form tool bar the corresponding <br>' button in the active form will be automatically <br>' clicked if it is enabled. Each form will have its <br>' own specialized procedure connected to each separate <br>' button. If you will, study the MainButton procedure <br>' in the authors form. <br>' <br>' This technique could be claimed to offer some sort <br>' of polymorphism to the app. <br>' <br>On Error GoTo MainButtonError <br> <br>    If ActiveForm.MainButton(index).Enabled Then <br>        ActiveForm.MainButton(index).Value = True <br>    Else <br>        Beep <br>    End If <br> <br>MainButtonExit: <br>    Exit Sub <br> <br>MainButtonError: <br> <br>    Beep <br>    Resume MainButtonExit <br> <br>End Sub <br> <br>Sub MDIForm_Load () <br>' <br>' Set up the MDI form for processing. <br>' Call the log in procedure <br>' <br> <br>    ' Set global variable AppName$ for log in purposes <br>    AppName$ = "Demo Authors 1"              'Global variable <br>     <br>    ' Initialize the global variable NEWLINE$ <br>    NEWLINE$ = Chr$(13) + Chr$(10) <br>     <br>    ' When global variable ShowSQL is set to false <br>    ' SQL statements will not be shown. Set to true <br>    ' by means of the Option menu. <br>    ShowSQL = False <br> <br>    ' Setting the width of the Info Panel <br>    SetPanelWidth <br> <br>    'Initialize VBSQL before log in: <br>    msg$ = SQLInit$() <br>    If msg$ = "" Then <br>        Beep <br>        MsgBox "Couldn't initialize VBSQL. Sorry. Must terminate.", 16 <br>        End <br>    End If <br>     <br>    fLogin.Show         ' Open login form <br> <br>End Sub <br> <br>Sub MDIForm_Resize () <br> <br>    SetPanelWidth <br> <br>End Sub <br> <br>Sub MDIForm_Unload (Cancel As Integer) <br>' <br>' Clean up any connection with SQL Server and close <br>' the help system, then exit the application (End). <br>' <br> <br>Dim X% <br> <br>    SqlExit <br>    SqlWinExit <br>    X% = WinHelp(MDIMA.hWnd, "pubs1.hlp", HELP_QUIT, 0) <br>    End <br> <br>End Sub <br> <br>Sub SetPanelWidth () <br>Dim lWidth As Integer <br> <br>    lWidth = MDIMA.Width - 350 <br>    If lWidth &gt;= 5500 Then panInfo.Width = MDIMA.Width - 350 <br> <br>End Sub <br> <br>Sub VBSQL1_Error (SqlConn As Integer, Severity As Integer, ErrorNum As Integer, ErrorStr As String, RetCode As Integer) <br>' <br>' Minimal error management. <br>' Show the severity of the error, the error number <br>' and the error message in a message box. <br> <br>Dim lMsg$ <br> <br>    lMsg$ = "Severity: " &amp; Severity &amp; Chr$(13) + Chr$(13) <br>    lMsg$ = lMsg$ + Str$(ErrorNum) + " " + ErrorStr + Chr$(13) + Chr$(13) <br>    MsgBox lMsg$, 16, "SQL-Error" <br> <br>End Sub <br> <br>Sub VBSQL1_Message (SqlConn As Integer, Message As Long, State As Integer, Severity As Integer, MsgStr As String) <br>' <br>' Minimal SQL Server message management. <br>' Filter out very trivial messages (5701 and 5703) <br>' Show the others with message number and message <br>' string in a message box. <br>' <br>    If Message &lt;&gt; 5701 And Message &lt;&gt; 5703 Then <br>        MsgBox "MSG: " + Str$(Message) + ": " + MsgStr, 0, "SQL Message" <br>    End If <br>     <br>End Sub <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
