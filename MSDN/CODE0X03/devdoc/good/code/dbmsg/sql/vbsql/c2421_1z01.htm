<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BROWSE.FRM</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2431"></a>BROWSE.FRM</h2>
<pre><code>VERSION 2.00 <br>Begin Form PrimaryWindow  <br>   BackColor       =   &amp;H00FFFF00&amp; <br>   Caption         =   "Browse Mode Example" <br>   Height          =   5190 <br>   Icon            =   BROWSE.FRX:0000 <br>   Left            =   1515 <br>   LinkMode        =   1  'Source <br>   LinkTopic       =   "Form1" <br>   MaxButton       =   0   'False <br>   ScaleHeight     =   4665 <br>   ScaleWidth      =   6105 <br>   Top             =   930 <br>   Width           =   6225 <br>   Begin VBSQL VBSQL1  <br>      Caption         =   "SQL Msg/Err" <br>      Height          =   255 <br>      Left            =   3840 <br>      Top             =   4440 <br>      Visible         =   0   'False <br>      Width           =   1935 <br>   End <br>   Begin TextBox Contract_Edit  <br>      Height          =   285 <br>      Left            =   3840 <br>      TabIndex        =   19 <br>      Top             =   4200 <br>      Width           =   1935 <br>   End <br>   Begin CommandButton Command3  <br>      Caption         =   "Exit" <br>      Height          =   495 <br>      Left            =   1200 <br>      TabIndex        =   1 <br>      Top             =   3960 <br>      Width           =   855 <br>   End <br>   Begin CommandButton Command1  <br>      Caption         =   "About" <br>      Height          =   495 <br>      Left            =   240 <br>      TabIndex        =   13 <br>      Top             =   3960 <br>      Width           =   855 <br>   End <br>   Begin TextBox Zip_Code_Edit  <br>      Height          =   285 <br>      Left            =   3840 <br>      TabIndex        =   18 <br>      Top             =   3720 <br>      Width           =   1935 <br>   End <br>   Begin TextBox State_Edit  <br>      Height          =   285 <br>      Left            =   3840 <br>      TabIndex        =   17 <br>      Top             =   3240 <br>      Width           =   1935 <br>   End <br>   Begin CommandButton Cancel_Query_Button  <br>      Caption         =   "Cancel Query" <br>      Height          =   615 <br>      Left            =   240 <br>      TabIndex        =   8 <br>      Top             =   3000 <br>      Width           =   1815 <br>   End <br>   Begin TextBox City_Edit  <br>      Height          =   285 <br>      Left            =   3840 <br>      TabIndex        =   20 <br>      Top             =   2760 <br>      Width           =   1935 <br>   End <br>   Begin TextBox Address_Edit  <br>      Height          =   285 <br>      Left            =   3840 <br>      TabIndex        =   16 <br>      Top             =   2280 <br>      Width           =   1935 <br>   End <br>   Begin CommandButton Update_Button  <br>      Caption         =   "Update Row" <br>      Height          =   615 <br>      Left            =   240 <br>      TabIndex        =   11 <br>      Top             =   2040 <br>      Width           =   1815 <br>   End <br>   Begin TextBox Phone_Edit  <br>      Height          =   285 <br>      Left            =   3840 <br>      TabIndex        =   15 <br>      Top             =   1800 <br>      Width           =   1935 <br>   End <br>   Begin TextBox First_Name_Edit  <br>      Height          =   285 <br>      Left            =   3840 <br>      TabIndex        =   14 <br>      Top             =   1320 <br>      Width           =   1935 <br>   End <br>   Begin CommandButton Next_Button  <br>      Caption         =   "Next Row" <br>      Height          =   615 <br>      Left            =   240 <br>      TabIndex        =   12 <br>      Top             =   1200 <br>      Width           =   1815 <br>   End <br>   Begin TextBox Last_Name_Edit  <br>      Height          =   285 <br>      Left            =   3840 <br>      TabIndex        =   22 <br>      Top             =   840 <br>      Width           =   1935 <br>   End <br>   Begin CommandButton Select_Button  <br>      Caption         =   "Select for Browse" <br>      Height          =   615 <br>      Left            =   240 <br>      TabIndex        =   0 <br>      Top             =   360 <br>      Width           =   1815 <br>   End <br>   Begin Label Label9  <br>      BackColor       =   &amp;H00FFFF00&amp; <br>      Caption         =   "Contract:" <br>      Height          =   255 <br>      Left            =   2640 <br>      TabIndex        =   10 <br>      Top             =   4200 <br>      Width           =   825 <br>   End <br>   Begin Label Label6  <br>      BackColor       =   &amp;H00FFFF00&amp; <br>      Caption         =   "Zip Code:" <br>      Height          =   255 <br>      Left            =   2640 <br>      TabIndex        =   6 <br>      Top             =   3720 <br>      Width           =   975 <br>   End <br>   Begin Label Label5  <br>      BackColor       =   &amp;H00FFFF00&amp; <br>      Caption         =   "State:" <br>      Height          =   255 <br>      Left            =   2640 <br>      TabIndex        =   5 <br>      Top             =   3240 <br>      Width           =   555 <br>   End <br>   Begin Label Label4  <br>      BackColor       =   &amp;H00FFFF00&amp; <br>      Caption         =   "City:" <br>      Height          =   285 <br>      Left            =   2640 <br>      TabIndex        =   4 <br>      Top             =   2760 <br>      Width           =   420 <br>   End <br>   Begin Label Label8  <br>      BackColor       =   &amp;H00FFFF00&amp; <br>      Caption         =   "Address:" <br>      Height          =   255 <br>      Left            =   2640 <br>      TabIndex        =   9 <br>      Top             =   2280 <br>      Width           =   780 <br>   End <br>   Begin Label Label3  <br>      BackColor       =   &amp;H00FFFF00&amp; <br>      Caption         =   "Phone:" <br>      Height          =   255 <br>      Left            =   2640 <br>      TabIndex        =   3 <br>      Top             =   1800 <br>      Width           =   630 <br>   End <br>   Begin Label Label7  <br>      BackColor       =   &amp;H00FFFF00&amp; <br>      Caption         =   "First Name:" <br>      Height          =   255 <br>      Left            =   2655 <br>      TabIndex        =   23 <br>      Top             =   1365 <br>      Width           =   1095 <br>   End <br>   Begin Label Label2  <br>      BackColor       =   &amp;H00FFFF00&amp; <br>      Caption         =   "Last Name:" <br>      Height          =   255 <br>      Left            =   2670 <br>      TabIndex        =   7 <br>      Top             =   870 <br>      Width           =   1095 <br>   End <br>   Begin Label Author_ID_Label  <br>      BackColor       =   &amp;H00FFFF00&amp; <br>      Height          =   255 <br>      Left            =   3840 <br>      TabIndex        =   21 <br>      Top             =   405 <br>      Width           =   1935 <br>   End <br>   Begin Label Label1  <br>      BackColor       =   &amp;H00FFFF00&amp; <br>      Caption         =   "Author ID:" <br>      Height          =   195 <br>      Left            =   2640 <br>      TabIndex        =   2 <br>      Top             =   360 <br>      Width           =   915 <br>   End <br>End <br>Dim Qual$ <br> <br>Dim UpdateValueArray(8) As String <br>Dim TableNameArray(8) As String <br> <br> <br> <br> <br>Sub Address_Edit_Change () <br> <br>    If Address_Edit.Text &lt;&gt; "not changed" Then <br>        Update_Button.Enabled = True <br>        UpdateValueArray(3) = Address_Edit.Text <br>    End If <br> <br>End Sub <br> <br>Sub Cancel_Query_Button_Click () <br>     <br>    Rem Cancel Query <br>    PrimaryWindow.MousePointer = 11 <br>    Results% = SQLCanQuery(SqlConn%) <br>    ClearAuthorInformation <br>    Select_Button.Enabled = True <br>    Cancel_Query_Button.Enabled = False <br>    Update_Button.Enabled = False <br>    Next_Button.Enabled = False <br>    PrimaryWindow.MousePointer = 0 <br> <br>End Sub <br> <br>Sub CheckForTimestampColumn () <br> <br>     <br>    Rem Change context to pubs sample database <br>    Results% = SqlUse(SqlConn%, "pubs") <br>    Results% = SqlUse(SqlUpdConn%, "pubs") <br>    If Results% = FAIL Then <br>        Beep <br>        Msg$ = "The SQL Server you have logged" + Chr$(13) + Chr$(10) <br>        Msg$ = Msg$ + "into (" + Servername$ + ") does not contain the" + Chr$(13) + Chr$(10) <br>        Msg$ = Msg$ + "Pubs sample database." <br>        MsgBox Msg$ <br>        ExitApplication <br>    Else <br>        Rem Check to see if sample authors table has a timestamp column <br>        Cmd$ = "If 'timestamp' in (select c.name from syscolumns c, " <br>        Cmd$ = Cmd$ + "sysobjects o where c.id = o.id and o.name = 'authors') " <br>        Cmd$ = Cmd$ + "select -1 else select 0 " <br>        Results% = ExecuteSQLCommand(Cmd$) <br>        Do While (SqlResults%(SqlConn%) &lt;&gt; NOMORERESULTS) <br>            Do While (SqlNextRow(SqlConn%) &lt;&gt; NOMOREROWS) <br>                Timestamp_Found% = Val(Sqldata(SqlConn%, 1)) <br>            Loop <br>        Loop <br>        If Not Timestamp_Found% Then <br>            Rem Add timestamp column <br>            Cmd$ = "alter table authors add timestamp timestamp null " <br>            Results% = ExecuteSQLCommand(Cmd$) <br>            Do While (SqlResults%(SqlConn%) &lt;&gt; NOMORERESULTS) <br>                Do While (SqlNextRow(SqlConn%) &lt;&gt; NOMOREROWS) <br>                Loop <br>            Loop <br>            Rem Now initialize the timestamp values <br>            Cmd$ = "update authors set au_id = au_id" <br>            Results% = ExecuteSQLCommand(Cmd$) <br>            Do While (SqlResults%(SqlConn%) &lt;&gt; NOMORERESULTS) <br>                Do While (SqlNextRow(SqlConn%) &lt;&gt; NOMOREROWS) <br>                Loop <br>            Loop <br>        End If <br>    End If <br>End Sub <br> <br>Sub City_Edit_Change () <br>     <br>    If City_Edit.Text &lt;&gt; "not changed" Then <br>        Update_Button.Enabled = True <br>        UpdateValueArray(4) = City_Edit.Text <br>    End If <br> <br>End Sub <br> <br>Sub ClearAuthorInformation () <br> <br>    Author_ID_Label.Caption = "" <br>    First_Name_Edit.Text = "" <br>    Last_Name_Edit.Text = "" <br>    Phone_Edit.Text = "" <br>    Address_Edit.Text = "" <br>    City_Edit.Text = "" <br>    State_Edit.Text = "" <br>    Zip_Code_Edit.Text = "" <br>    Contract_Edit.Text = "" <br> <br>End Sub <br> <br>Sub Command1_Click () <br> <br>    About_Form.Show 1 <br> <br>End Sub <br> <br>Sub Command3_Click () <br> <br>    ExitApplication <br> <br>End Sub <br> <br>Sub Contract_Edit_Change () <br> <br>    If Contract_Edit.Text &lt;&gt; "not changed" Then <br>        Update_Button.Enabled = True <br>        UpdateValueArray(7) = Contract_Edit.Text <br>    End If <br> <br>End Sub <br> <br>Sub First_Name_Edit_Change () <br>     <br>    If First_Name_Edit.Text &lt;&gt; "not changed" Then <br>        Update_Button.Enabled = True <br>        UpdateValueArray(1) = First_Name_Edit.Text <br>    End If <br> <br>End Sub <br> <br>Sub Form_Load () <br>         <br>    LoadTableNameArray <br>    PrimaryWindowTitle$ = "Browse Mode Example" <br>    InitializeApplication <br>    Login.Show 1 <br>    CheckForTimestampColumn <br>    DatabaseName = SqlName(SqlConn%) <br>    ChangePrimaryWindowCaption <br>    Cancel_Query_Button.Enabled = False <br>    Next_Button.Enabled = False <br>    Update_Button.Enabled = False <br> <br>End Sub <br> <br>Sub Form_Unload (Cancel As Integer) <br> <br>    ExitApplication <br> <br>End Sub <br> <br>Sub InitializeUpdateArray () <br>    Dim count As Integer <br> <br>    For count = 0 To 7 <br>        UpdateValueArray(count) = "not changed" <br>    Next <br> <br>End Sub <br> <br>Sub Last_Name_Edit_Change () <br>     <br>    If Last_Name_Edit.Text &lt;&gt; "not changed" Then <br>        Update_Button.Enabled = True <br>        UpdateValueArray(0) = Last_Name_Edit.Text <br>    End If <br> <br>End Sub <br> <br>Sub LoadTableNameArray () <br> <br>    TableNameArray(0) = "au_lname" <br>    TableNameArray(1) = "au_fname" <br>    TableNameArray(2) = "phone" <br>    TableNameArray(3) = "address" <br>    TableNameArray(4) = "city" <br>    TableNameArray(5) = "state" <br>    TableNameArray(6) = "zip" <br>    TableNameArray(7) = "contract" <br> <br>End Sub <br> <br>Sub Next_Button_Click () <br>     <br>    PrimaryWindow.MousePointer = 11 <br>    If SqlNextRow%(SqlConn%) &lt;&gt; NOMOREROWS Then <br>        ProcessResultRow <br>    Else <br>        Next_Button.Enabled = False <br>        Cancel_Query_Button.Enabled = False <br>        Select_Button.Enabled = True <br>        ClearAuthorInformation <br>        Beep <br>        MsgBox "No more rows in table." <br>    End If <br>    InitializeUpdateArray <br>    Update_Button.Enabled = False <br>    PrimaryWindow.MousePointer = 0 <br> <br>End Sub <br> <br>Sub Phone_Edit_Change () <br> <br>    If Phone_Edit.Text &lt;&gt; "not changed" Then <br>        Update_Button.Enabled = True <br>        UpdateValueArray(2) = Phone_Edit.Text <br>    End If <br> <br>End Sub <br> <br>Sub ProcessResultRow () <br>     <br>    Author_ID_Label.Caption = Sqldata(SqlConn%, 1) <br>    Last_Name_Edit.Text = Sqldata(SqlConn%, 2) <br>    First_Name_Edit.Text = Sqldata(SqlConn%, 3) <br>    Phone_Edit.Text = Sqldata(SqlConn%, 4) <br>    Address_Edit.Text = Sqldata(SqlConn%, 5) <br>    City_Edit.Text = Sqldata(SqlConn%, 6) <br>    State_Edit.Text = Sqldata(SqlConn%, 7) <br>    Zip_Code_Edit.Text = Sqldata(SqlConn%, 8) <br>    Contract_Edit.Text = Sqldata(SqlConn%, 9) <br>    Rem Get Qual String <br>    Qual$ = SqlQual$(SqlConn%, -1, "authors") <br> <br>End Sub <br> <br>Sub Select_Button_Click () <br> <br>    Rem Send Query to SQL Server <br>    PrimaryWindow.MousePointer = 11 <br>    Results% = ExecuteSQLCommand("Select * from authors for browse") <br>    Results% = SqlResults%(SqlConn%) <br>    If SqlNextRow%(SqlConn%) &lt;&gt; NOMOREROWS Then <br>        ProcessResultRow <br>    End If <br>    Cancel_Query_Button.Enabled = True <br>    Next_Button.Enabled = True <br>    Update_Button.Enabled = False <br>    Select_Button.Enabled = False <br>    InitializeUpdateArray <br>    PrimaryWindow.MousePointer = 0 <br>         <br>End Sub <br> <br>Sub State_Edit_Change () <br> <br>    If State_Edit.Text &lt;&gt; "not changed" Then <br>        Update_Button.Enabled = True <br>        UpdateValueArray(5) = State_Edit.Text <br>    End If <br> <br>End Sub <br> <br>Sub Update_Button_Click () <br>    Dim count As Integer <br> <br>    PrimaryWindow.MousePointer = 11 <br> <br>    Cmd$ = "update authors set " <br>    For count = 0 To 7 <br>        If UpdateValueArray(count) &lt;&gt; "not changed" Then <br>            Cmd$ = Cmd$ + TableNameArray(count) + " = '" <br>            Cmd$ = Cmd$ + UpdateValueArray(count) + "'," <br>        End If <br>    Next <br>    Rem Replace final comma with space before adding qual string <br>    Cmd$ = Left$(Cmd$, Len(Cmd$) - 1) + " " <br>    Rem Now add qual string <br>    Cmd$ = Cmd$ + Qual$ <br>    Results% = SqlCmd(SqlUpdConn%, Cmd$) <br>    Results% = SqlExec(SqlUpdConn%) <br>    Do While (SqlResults%(SqlUpdConn%) &lt;&gt; NOMORERESULTS) <br>        Do While (SqlNextRow(SqlUpdConn%) &lt;&gt; NOMOREROWS) <br>        Loop <br>    Loop <br>    Update_Button.Enabled = False <br>    PrimaryWindow.MousePointer = 0 <br> <br>End Sub <br> <br>Sub VBSQL1_Error (SqlConn As Integer, Severity As Integer, ErrorNum As Integer, ErrorStr As String, RetCode As Integer) <br>' Call the required VBSQL error-handling function <br>' OSErr and OSErrStr not used in VBSQL for Windows, but DOS interprets <br>' anything other than -1 as an OS error <br>    OsErr% = -1 <br> <br>    RetCode% = UserSqlErrorHandler%(SqlConn, Severity%, ErrorNum%, OsErr%, ErrorStr$, OsErrStr$) <br> <br>End Sub <br> <br>Sub VBSQL1_Message (SqlConn As Integer, Message As Long, State As Integer, Severity As Integer, MsgStr As String) <br>    UserSqlMsgHandler SqlConn, Message&amp;, State%, Severity%, MsgStr$ <br>End Sub <br> <br>Sub Zip_Code_Edit_Change () <br> <br>    If Zip_Code_Edit.Text &lt;&gt; "not changed" Then <br>        Update_Button.Enabled = True <br>        UpdateValueArray(6) = Zip_Code_Edit.Text <br>    End If <br> <br>End Sub <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
