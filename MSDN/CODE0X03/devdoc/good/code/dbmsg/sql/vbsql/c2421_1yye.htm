<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ADBSQL.BAS</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2426"></a>ADBSQL.BAS</h2>
<pre><code><br>Function Logon% (pServer$, pLoginId$, pPassword$, pWorkSta$, pAppName$) <br>' <br>' Open connection to SQL Server. Returns channel number <br>' to use in further communication with SQL Server through <br>' this channel. <br>' <br>' This function can be called one or several times from <br>' each form. <br> <br>    Logon% = SqlOpenConnection(pServer$, pLoginId$, pPassword$, pWorkSta$, pAppName$) <br> <br>End Function <br> <br>Function SQLComm% (pChannel%, pCmd$) <br>' <br>' Generalized function to send SQL statements to SQL <br>' Server. If global variable ShowSql is set to True, <br>' the SQL statement is shown in a messagebox before <br>' it is sent to SQL Server <br> <br>Dim Res% <br> <br>    If ShowSql Then <br>        MsgBox pCmd$ <br>    End If <br>    Do <br>        Res% = SqlCancel(pChannel%) <br>        If Res% &lt;&gt; SUCCEED% Then <br>            Exit Do <br>        End If <br>        Res% = SQLCmd(pChannel%, pCmd$) <br>        If Res% &lt;&gt; SUCCEED% Then <br>            Exit Do <br>        End If <br>        Res% = SqlExec(pChannel%) <br>        If Res% &lt;&gt; SUCCEED% Then <br>            Exit Do <br>        End If <br>        Res% = SqlResults%(pChannel%) <br>        If Res% &lt;&gt; SUCCEED% Then <br>            Exit Do <br>        End If <br>    Loop Until True <br>    SQLComm% = Res% <br> <br>End Function <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
