<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ADBLOGON.FRM</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2425"></a>ADBLOGON.FRM</h2>
<pre><code>VERSION 2.00 <br>Begin Form fLogin  <br>   BackColor       =   &amp;H00C0C0C0&amp; <br>   BorderStyle     =   3  'Fixed Double <br>   Caption         =   "Logon to SQL Server" <br>   ControlBox      =   0   'False <br>   ForeColor       =   &amp;H00C0C0C0&amp; <br>   Height          =   2850 <br>   Left            =   2100 <br>   LinkMode        =   1  'Source <br>   LinkTopic       =   "Form2" <br>   MaxButton       =   0   'False <br>   MDIChild        =   -1  'True <br>   MinButton       =   0   'False <br>   ScaleHeight     =   2445 <br>   ScaleWidth      =   3480 <br>   Top             =   1875 <br>   Width           =   3600 <br>   Begin SSPanel Panel3D4  <br>      AutoSize        =   3  'AutoSize Child To Panel <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      BevelInner      =   1  'Inset <br>      BevelOuter      =   0  'None <br>      BorderWidth     =   0 <br>      Font3D          =   0  'None <br>      ForeColor       =   &amp;H00000000&amp; <br>      Height          =   330 <br>      Left            =   1110 <br>      TabIndex        =   12 <br>      Top             =   1410 <br>      Width           =   2145 <br>      Begin TextBox txtDatabase  <br>         BackColor       =   &amp;H00FFFFFF&amp; <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   300 <br>         Left            =   15 <br>         TabIndex        =   13 <br>         Top             =   15 <br>         Width           =   2115 <br>      End <br>   End <br>   Begin SSPanel Panel3D3  <br>      AutoSize        =   3  'AutoSize Child To Panel <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      BevelInner      =   1  'Inset <br>      BevelOuter      =   0  'None <br>      BorderWidth     =   0 <br>      Font3D          =   0  'None <br>      ForeColor       =   &amp;H00000000&amp; <br>      Height          =   330 <br>      Left            =   1110 <br>      TabIndex        =   10 <br>      Top             =   975 <br>      Width           =   2145 <br>      Begin TextBox txtPassword  <br>         BackColor       =   &amp;H00FFFFFF&amp; <br>         ForeColor       =   &amp;H00000000&amp; <br>         Height          =   300 <br>         Left            =   15 <br>         PasswordChar    =   "*" <br>         TabIndex        =   11 <br>         Top             =   15 <br>         Width           =   2115 <br>      End <br>   End <br>   Begin SSPanel Panel3D2  <br>      AutoSize        =   3  'AutoSize Child To Panel <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      BevelInner      =   1  'Inset <br>      BevelOuter      =   0  'None <br>      BorderWidth     =   0 <br>      Font3D          =   0  'None <br>      ForeColor       =   &amp;H00000000&amp; <br>      Height          =   330 <br>      Left            =   1110 <br>      TabIndex        =   8 <br>      Top             =   555 <br>      Width           =   2145 <br>      Begin TextBox txtLoginId  <br>         BackColor       =   &amp;H00FFFFFF&amp; <br>         Height          =   300 <br>         Left            =   15 <br>         TabIndex        =   9 <br>         Top             =   15 <br>         Width           =   2115 <br>      End <br>   End <br>   Begin SSPanel Panel3D1  <br>      AutoSize        =   3  'AutoSize Child To Panel <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      BevelInner      =   1  'Inset <br>      BevelOuter      =   0  'None <br>      BorderWidth     =   0 <br>      Font3D          =   0  'None <br>      ForeColor       =   &amp;H00000000&amp; <br>      Height          =   330 <br>      Left            =   1110 <br>      TabIndex        =   6 <br>      Top             =   135 <br>      Width           =   2145 <br>      Begin ComboBox cboServer  <br>         BackColor       =   &amp;H00FFFFFF&amp; <br>         Height          =   300 <br>         Left            =   15 <br>         TabIndex        =   7 <br>         Text            =   "Combo1" <br>         Top             =   15 <br>         Width           =   2115 <br>      End <br>   End <br>   Begin CommandButton cmdLogin  <br>      Caption         =   "&amp;Login" <br>      Default         =   -1  'True <br>      Height          =   390 <br>      Left            =   225 <br>      TabIndex        =   0 <br>      Top             =   1920 <br>      Width           =   1335 <br>   End <br>   Begin CommandButton cmdCancel  <br>      Caption         =   "&amp;Cancel" <br>      Height          =   390 <br>      Left            =   1875 <br>      TabIndex        =   2 <br>      Top             =   1920 <br>      Width           =   1335 <br>   End <br>   Begin Label lblLogin  <br>      AutoSize        =   -1  'True <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      Caption         =   "Database" <br>      Height          =   195 <br>      Index           =   3 <br>      Left            =   165 <br>      TabIndex        =   5 <br>      Top             =   1515 <br>      Width           =   825 <br>   End <br>   Begin Label lblLogin  <br>      AutoSize        =   -1  'True <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      Caption         =   "Password" <br>      Height          =   195 <br>      Index           =   2 <br>      Left            =   165 <br>      TabIndex        =   4 <br>      Top             =   1080 <br>      Width           =   825 <br>   End <br>   Begin Label lblLogin  <br>      AutoSize        =   -1  'True <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      Caption         =   "Login Id" <br>      Height          =   195 <br>      Index           =   0 <br>      Left            =   165 <br>      TabIndex        =   3 <br>      Top             =   660 <br>      Width           =   705 <br>   End <br>   Begin Label lblLogin  <br>      AutoSize        =   -1  'True <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      Caption         =   "Server" <br>      Height          =   195 <br>      Index           =   1 <br>      Left            =   165 <br>      TabIndex        =   1 <br>      Top             =   255 <br>      Width           =   570 <br>   End <br>End <br> <br>Sub cmdCancel_Click () <br>     <br>    Unload Me <br>     <br>End Sub <br> <br>Sub cmdLogin_Click () <br>Dim Channel% <br>On Error GoTo LoginError <br> <br>    screen.MousePointer = 11 <br>    Server$ = cboServer.Text <br>    LoginId$ = txtLoginId.Text <br>    Password$ = txtPassword.Text <br>    Database$ = txtDatabase.Text <br>    WorkSta$ = "" <br>    Res% = SQLSetLogintime(30) <br>    Res% = SQLSettime(30) <br> <br>    Channel% = Logon%(Server$, LoginId$, Password$, WorkSta$, AppName$) <br> <br>    If (Channel% = FAIL%) Then <br>        Beep <br>        txtPassword.SetFocus <br>    Else <br>        Results% = SqlUse(Channel%, Database$) <br>        If (Results% = FAIL%) Then <br>            Beep <br>            MsgBox "Could not access database " + Database$ <br>            GoTo LoginError <br>        Else <br>            MDIMA.altAuthors.Enabled = True <br>            MDIMA.altLogout.Enabled = True <br>            MDIMA.cmdLogout.Enabled = True <br> <br>            ' Get info on who is logged in for panel display: <br>            Res% = SQLComm(Channel%, "select User_Name()") <br>            If Res% = SUCCEED% Then <br>                Res% = SQLNextRow(Channel%) <br>                If REGROW Then <br>                    SQLUser$ = SQLData(Channel%, 1) <br>                Else <br>                    SQLUser$ = "" <br>                End If <br>            Else <br>                SQLUser$ = "" <br>            End If <br>            Sqlclose (Channel%) <br> <br>            'Save login info in local log file for next time: <br>            Open "c:\adbpubs.log" For Output As #1 <br>            Print #1, Server$ <br>            Print #1, Database$ <br>            Print #1, LoginId$ <br>            Close #1 <br>            screen.MousePointer = 0 <br>            MDIMA.cmdUnloadActForms.Value = True <br>        End If <br>    End If <br> <br>LoginExit: <br>    SetLoginInfo Server$, LoginId$, Database$, SQLUser$ <br>    screen.MousePointer = 0 <br>    Exit Sub <br> <br>LoginError: <br>    Resume Next <br> <br>End Sub <br> <br>Sub Form_Load () <br>Dim Srvr$, Db$, Usr$ <br>     <br>On Error GoTo FormLoadError <br> <br>    cboServer.Text = "" <br>    txtLoginId.Text = "" <br>    txtPassword.Text = "" <br>    txtDatabase.Text = "" <br>    Me.Width = 3600 <br>    Me.Height = 2850 <br>    Me.Top = screen.Height / 2 - Me.Height / 2 - 710 <br>    Me.Left = screen.Width / 2 - Me.Width / 2 <br>    Open "c:\adbpubs.log" For Input As #1 <br>    Input #1, Srvr$ <br>    Input #1, Db$ <br>    Input #1, Usr$ <br>    Close #1 <br>    cboServer.Text = Srvr$ <br>    txtDatabase.Text = Db$ <br>    txtLoginId.Text = Usr$ <br>    Me.Show <br>    If Len(RTrim$(cboServer.Text)) Then txtPassword.SetFocus <br>     <br>FormLoadExit: <br>    Exit Sub <br> <br>FormLoadError: <br>    Resume FormLoadExit <br> <br>End Sub <br> <br>Sub SetLoginInfo (pServer$, pLoginId$, pDatabase$, pUser$) <br>Dim lInfo$ <br> <br>    lInfo$ = " Server: " + pServer$ <br>    lInfo$ = lInfo$ + "    Login: " + pLoginId$ <br>    lInfo$ = lInfo$ + "    Database: " + pDatabase$ <br>    lInfo$ = lInfo$ + "    User: " + pUser$ <br>    MDIMA.panInfo.Caption = lInfo$ <br> <br>End Sub <br> <br>Sub txtDatabase_GotFocus () <br> <br>    txtDatabase.SelStart = 0 <br>    txtDatabase.SelLength = Len(txtDatabase.Text) <br> <br>End Sub <br> <br>Sub txtLoginId_GotFocus () <br> <br>    txtLoginId.SelStart = 0 <br>    txtLoginId.SelLength = Len(txtLoginId.Text) <br> <br>End Sub <br> <br>Sub txtPassword_GotFocus () <br>  <br>    txtPassword.SelStart = 0 <br>    txtPassword.SelLength = Len(txtPassword.Text) <br> <br>End Sub <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
