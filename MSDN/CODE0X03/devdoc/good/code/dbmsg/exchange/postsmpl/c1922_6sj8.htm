<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>POSTVIEW.CPP</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context1934"></a>POSTVIEW.CPP</h2>
<pre><code>//========================================================================= <br>//  PostView.cpp <br>// <br>// Copyright (C) 1986-1996.  Microsoft Corp.  All Rights Reserved. <br>//  <br>// <br>// Purpose: <br>//    implementation of the CPostSmplView class <br>//========================================================================= <br> <br> <br>#include "stdafx.h" <br>#include "PostSmpl.h" <br> <br>#include "PostDoc.h" <br>#include "PostView.h" <br>#include "PostData.h" <br>#include "freedoc.h" <br> <br>#ifdef _DEBUG <br>#define new DEBUG_NEW <br>#undef THIS_FILE <br>static char THIS_FILE[] = __FILE__; <br>#endif <br> <br>///////////////////////////////////////////////////////////////////////////// <br>// CPostSmplView <br> <br>IMPLEMENT_DYNCREATE(CPostSmplView, CEditView) <br> <br>BEGIN_MESSAGE_MAP(CPostSmplView, CEditView) <br>//{{AFX_MSG_MAP(CPostSmplView) <br>ON_COMMAND(ID_FILE_SAVE, OnFileSave) <br>ON_COMMAND(ID_FILE_SAVE_AS, OnFileSaveAs) <br>ON_COMMAND(ID_FILE_OPEN, OnFileOpen) <br>ON_COMMAND(ID_FILE_NEW, OnFileNew) <br>ON_COMMAND(ID_FILE_POSTDOC, OnFilePostdoc) <br>ON_UPDATE_COMMAND_UI(ID_FILE_POSTDOC, OnUpdateFilePostdoc) <br>//}}AFX_MSG_MAP <br>// Standard printing commands <br>ON_COMMAND(ID_FILE_PRINT, CEditView::OnFilePrint) <br>ON_COMMAND(ID_FILE_PRINT_DIRECT, CEditView::OnFilePrint) <br>ON_COMMAND(ID_FILE_PRINT_PREVIEW, CEditView::OnFilePrintPreview) <br>END_MESSAGE_MAP() <br> <br>///////////////////////////////////////////////////////////////////////////// <br>// CPostSmplView construction/destruction <br> <br>CPostSmplView::CPostSmplView() <br>{ <br>//  add construction code here <br> <br>} <br> <br>CPostSmplView::~CPostSmplView() <br>{ <br>} <br> <br>BOOL CPostSmplView::PreCreateWindow(CREATESTRUCT&amp; cs) <br>{ <br>//  Modify the Window class or styles here by modifying <br>//  the CREATESTRUCT cs <br> <br>return CEditView::PreCreateWindow(cs); <br>} <br> <br>///////////////////////////////////////////////////////////////////////////// <br>// CPostSmplView drawing <br> <br>void CPostSmplView::OnDraw(CDC* pDC) <br>{ <br>CPostSmplDoc* pDoc = GetDocument(); <br>ASSERT_VALID(pDoc); <br> <br>//  add draw code for native data here <br>} <br> <br>///////////////////////////////////////////////////////////////////////////// <br>// CPostSmplView printing <br> <br>BOOL CPostSmplView::OnPreparePrinting(CPrintInfo* pInfo) <br>{ <br>// default preparation <br>return DoPreparePrinting(pInfo); <br>} <br> <br>void CPostSmplView::OnBeginPrinting(CDC* /*pDC*/, CPrintInfo* /*pInfo*/) <br>{ <br>//  add extra initialization before printing <br>} <br> <br>void CPostSmplView::OnEndPrinting(CDC* /*pDC*/, CPrintInfo* /*pInfo*/) <br>{ <br>//  add cleanup after printing <br>} <br> <br>///////////////////////////////////////////////////////////////////////////// <br>// CPostSmplView diagnostics <br> <br>#ifdef _DEBUG <br>void CPostSmplView::AssertValid() const <br>{ <br>CEditView::AssertValid(); <br>} <br> <br>void CPostSmplView::Dump(CDumpContext&amp; dc) const <br>{ <br>CEditView::Dump(dc); <br>} <br> <br>CPostSmplDoc* CPostSmplView::GetDocument() // non-debug version is inline <br>{ <br>ASSERT(m_pDocument-&gt;IsKindOf(RUNTIME_CLASS(CPostSmplDoc))); <br>return (CPostSmplDoc*)m_pDocument; <br>} <br>#endif //_DEBUG <br> <br>///////////////////////////////////////////////////////////////////////////// <br>// CPostSmplView message handlers <br> <br>void CPostSmplView::OnFileSave()  <br>{ <br>CPostSmplDoc* pDoc = GetDocument(); <br> <br>//Get the text body from edit box <br>GetDataFromEdit(); <br> <br>if (pDoc) <br>{ <br>//Save text to the file <br>pDoc-&gt;OnFileSave(); <br> <br>//Get the name of the saved file <br>PostData.szFile = pDoc-&gt;GetPathName(); <br>PostData.szFileTitle = pDoc-&gt;GetTitle(); <br>} <br>} <br> <br>void CPostSmplView::OnFileSaveAs()  <br>{ <br>CPostSmplDoc* pDoc = GetDocument(); <br> <br>//Get the text body from edit box <br>GetDataFromEdit(); <br> <br>if (pDoc) <br>{ <br>//Save text to the file <br>pDoc-&gt;OnFileSaveAs(); <br> <br>//Get the name of the saved file <br>PostData.szFile = pDoc-&gt;GetPathName(); <br>PostData.szFileTitle = pDoc-&gt;GetTitle(); <br>} <br>} <br> <br> <br>void CPostSmplView::OnFileOpen()  <br>{ <br>CPostSmplDoc* pDoc = GetDocument(); <br> <br>//Open the document file specified by user <br>theApp.OnFileOpen(); <br> <br>if (pDoc) <br>{ <br>//Get the filename <br>PostData.szFile = pDoc-&gt;GetPathName(); <br>PostData.szFileTitle = pDoc-&gt;GetTitle(); <br> <br>//Get the summary property set <br>GetSummaryInfo( pDoc-&gt;GetStorage(),  <br>&amp;PostData.m_psTitle,  <br>&amp;PostData.m_psSubject,  <br>&amp;PostData.m_psAuthor,  <br>&amp;PostData.m_psKeywords,  <br>&amp;PostData.m_psComments); <br>} <br> <br>//Update the editbox with document text <br>PutDataToEdit(); <br>} <br> <br>void CPostSmplView::OnFileNew()  <br>{  <br> <br>//Create a new document <br>theApp.OnFileNew(); <br> <br>//clear the editbox <br>PutDataToEdit(); <br>} <br> <br>void CPostSmplView::GetDataFromEdit() <br>{ <br>//Get data from edit box window <br>CEdit &amp;EdtCtrl = GetEditCtrl(); <br>UINT cLen = GetBufferLength(); <br>EdtCtrl.GetWindowText(theApp.m_lpBuffer); <br> <br>} <br> <br>void CPostSmplView::PutDataToEdit() <br>{ <br>//Put data to edit box window <br>CEdit &amp;EdtCtrl = GetEditCtrl(); <br>EdtCtrl.SetWindowText(theApp.m_lpBuffer); <br>} <br> <br> <br>void CPostSmplView::OnFilePostdoc()  <br>{ <br>CPostSmplDoc* pDoc = GetDocument(); <br> <br>if (pDoc) <br>//Post the document <br>PostData.FilePost(pDoc-&gt;GetStorage()); <br>} <br> <br>void CPostSmplView::OnUpdate(CView* pSender, LPARAM lHint, CObject* pHint)  <br>{ <br>CPostSmplDoc* pDoc = GetDocument(); <br>if (pDoc) <br>{ <br>//Get the filename <br>PostData.szFile = pDoc-&gt;GetPathName(); <br>PostData.szFileTitle = pDoc-&gt;GetTitle(); <br> <br>//Update the editbox with document text <br>PutDataToEdit(); <br> <br>//Get the summary property set <br>GetSummaryInfo( pDoc-&gt;GetStorage(),  <br>&amp;PostData.m_psTitle,  <br>&amp;PostData.m_psSubject,  <br>&amp;PostData.m_psAuthor,  <br>&amp;PostData.m_psKeywords,  <br>&amp;PostData.m_psComments); <br> <br>} <br>CView::OnUpdate(pSender, lHint, pHint); <br>} <br> <br>void CPostSmplView::OnUpdateFilePostdoc(CCmdUI* pCmdUI)  <br>{ <br>if (theApp.m_bEmbedded) <br>pCmdUI-&gt;Enable( FALSE ); <br>} <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
