<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SROWLST.H</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context1884"></a>SROWLST.H</h2>
<pre><code>// --srowlst.h----------------------------------------------------------------- <br>// <br>// Header file for classes CSROWNODE and CSROWLST. <br>//   <br>// Copyright (C) Microsoft Corp, 1986-1996.  All rights reserved. <br>// <br>//----------------------------------------------------------------------------- <br> <br>#ifndef_SROWLST_H <br>#define _SROWLST_H <br> <br>#include "llmacro.h" <br> <br>// ROWLIST allocation helper macro for IExchangeModifyTable interface. <br> <br>#defineCbNewROWLIST(_centries)(offsetof(ROWLIST,aEntries) + \ <br>(_centries)*sizeof(ROWENTRY)) <br> <br>// Count of properties supported by rule object. <br> <br>#defineC_RULEPROPS7 <br> <br>// Indices of rule properties in the SRow associated with a rule object. <br> <br>#defineI_RULE_SEQUENCE0 <br>#defineI_RULE_STATE1 <br>#defineI_RULE_CONDITION2 <br>#defineI_RULE_ACTIONS3 <br>#defineI_RULE_PROVIDER4 <br>#defineI_RULE_LEVEL5 <br>#defineI_RULE_NAME6 <br> <br>class CSROWNODE// srn <br>{ <br>friend class CIExchangeFolderRules; <br>friend class CSROWLST; <br> <br>    public: <br> <br>        // constructor &amp; destructor <br> <br>CSROWNODE( <br>INLPSRowlpSRow <br>    ); <br> <br>~CSROWNODE(); <br> <br>protected: <br> <br>CSROWNODE *m_pNxt; <br>CSROWNODE *m_pPrv; <br>SRowm_SRow; <br>}; <br> <br>class CSROWLST// srl <br>{ <br>    public: <br> <br>CSROWLST();     // constructor <br> <br>~CSROWLST();    // destructor <br>         <br>        // standard C++ Get and Set member functions <br> <br>CSROWNODE * GetCurrentNode(VOID); <br> <br>LONG GetCursor(VOID) const; <br> <br>LONG GetNodeCount(VOID) const; <br> <br>LONG GetOtherProvNodeCount(VOID) const; <br> <br>LONG SetCursor( <br>INLONGlPos <br>); <br> <br>HRESULT HrInitialize( <br>INLPSTRlpszProvider, <br>IN OUTLPSRowSetlpRows <br>); <br> <br>HRESULT HrDelete(VOID); <br> <br>HRESULTHrGetProviders( <br>OUTLPULONGlpcProviders, <br>OUTLPSTR FAR * FAR *lpppszProviders <br>); <br> <br>HRESULT HrInsert( <br>INLPSRowlpSRow <br>); <br> <br>HRESULT HrRemoveFromLst( <br>OUTCSROWNODE * *ppRemovedNode <br>); <br> <br>HRESULT HrWriteToTable( <br>INLPEXCHANGEMODIFYTABLElpExchTbl <br>); <br> <br>private: <br> <br>VOID ReSequence(VOID); <br> <br>ULONGm_cNodes; <br>ULONGm_cOtherProvNodes; <br>LONGm_lPos; <br>LPSTRm_lpszProvider; <br>CSROWNODE *m_pCurNode; <br>CSROWNODE *m_pLstHd; <br>CSROWNODE *m_pOtherProvLstHd; <br>}; <br> <br>// $--CSROWNODE::GetCurrentNode------------------------------------------------ <br>// <br>// DESCRIPTION:Return a pointer to the current node. <br>// <br>// INPUT:   None. <br>// <br>// RETURNS:A pointer to the current node. <br>// <br>//----------------------------------------------------------------------------- <br> <br>inline CSROWNODE * CSROWLST::GetCurrentNode(VOID) <br>{ <br>    return m_pCurNode; <br>} <br> <br>// $--CSROWLST::GetCursor------------------------------------------------------ <br>// <br>// DESCRIPTION:Return the current cursor position. <br>// <br>// INPUT:   None. <br>// <br>// RETURNS:The current cursor position. <br>// <br>//----------------------------------------------------------------------------- <br> <br>inline LONG CSROWLST::GetCursor(VOID) const <br>{ <br>    return m_lPos; <br>} <br> <br>// $--CSROWLST::GetNodeCount--------------------------------------------------- <br>// <br>// DESCRIPTION:Return the count of nodes in the list. <br>// <br>// INPUT:   None. <br>// <br>// RETURNS:The count of nodes in the list. <br>// <br>//----------------------------------------------------------------------------- <br> <br>inline LONG CSROWLST::GetNodeCount(VOID) const <br>{ <br>    return m_cNodes; <br>} <br> <br>// $--CSROWLST::GetOtherProvNodeCount------------------------------------------ <br>// <br>// DESCRIPTION:Return the count of nodes in the other provider list. <br>// <br>// INPUT:   None. <br>// <br>// RETURNS:The count of nodes in the other provider list. <br>// <br>//----------------------------------------------------------------------------- <br> <br>inline LONG CSROWLST::GetOtherProvNodeCount(VOID) const <br>{ <br>    return m_cOtherProvNodes; <br>} <br> <br>#endif // _SROWLSTH_ </code></pre>
<p>&nbsp;</p></body>
</HTML>
