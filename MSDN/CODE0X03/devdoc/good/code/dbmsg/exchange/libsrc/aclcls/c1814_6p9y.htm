<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACLCLSF.H</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context1816"></a>ACLCLSF.H</h2>
<pre><code>// --aclclsf.h--------------------------------------------------------------- <br>// <br>// Header file for the CFolderACLs class and its class factory. <br>// <br>// The CFolderACLs class is a controlling class.  It controls the <br>// CIExchangeFolderACLs class (which implements the IExchangeFolderACLs  <br>// programatic interface defined in aclcls.h). <br>// <br>// Copyright (C) Microsoft Corp. 1986-1996.  All rights reserved. <br>// <br>// --------------------------------------------------------------------------- <br> <br>#if !defined(_ACLCLSF_H) <br>#define _ACLCLSF_H <br> <br>// $$--CFolderACLs-------------------------------------------------------- <br>// <br>// The CFolderACLs class. <br>// <br>// --------------------------------------------------------------------------- <br> <br>class FAR CFolderACLs : public IUnknown <br>{ <br>friend class CIExchangeFolderACLs; <br> <br>public: <br> <br>    CFolderACLs(); <br> <br>~CFolderACLs(); <br> <br>// Standard OLE stuff. <br> <br>STDMETHOD(QueryInterface)( <br>INREFIIDriid, <br>OUTVOID FAR * FAR *ppv <br>); <br> <br>STDMETHOD_(ULONG, AddRef)(VOID); <br> <br>STDMETHOD_(ULONG, Release)(VOID); <br> <br>static <br>CFolderACLs FAR * <br>Create(); <br> <br>HRESULT <br>HrGetTableEntry( <br>INULONGcbentryid, <br>INLPENTRYIDlpentryid, <br>OUTLPSTR FAR *lppszDisplayName, <br>OUTLPLONGlplRights <br>); <br> <br>HRESULT <br>HrOpen( <br>            IN      LPMAPISESSION lpSession, <br>INLPMDBlpMDB, <br>INULONGcbentryid, <br>INLPENTRYIDlpentryid <br>); <br> <br>protected: <br> <br>        HRESULT                 m_hr;       // constructor "return" code <br> <br>LPEXCHANGEMODIFYTABLEm_lpExchTbl; <br>     <br>LPMAPIFOLDERm_lpFolder;// Ptr to MAPI folder object. <br> <br>LPMAPITABLEm_lpMapiTbl; <br> <br>CSROWLSTm_SRowLst;// Table info stored here. <br> <br>ULONGm_refs;// Reference count. <br> <br>// This is a ptr to the CIExchangeFolderACLs class, which implements <br>// the IFolderACLs interface exported to the user. <br> <br>class FAR CIExchangeFolderACLs FAR *m_prog_interface; <br> <br>        LPMAPISESSION           m_lpSession; <br>}; <br> <br> <br>// $$--CIExchangeFolderACLs--------------------------------------------------- <br>// <br>// Class CIExchangeFolderACLs.  This class implements the IExchangeFolderACLs <br>// interface which is exposed to the use via the aclcls.h header file. <br>// <br>// --------------------------------------------------------------------------- <br> <br>class FAR CIExchangeFolderACLs : public IExchangeFolderACLs <br>{ <br>public: <br> <br>// Standard OLE stuff. <br> <br>STDMETHOD(QueryInterface)( <br>THIS_ <br>REFIIDriid, <br>LPVOID FAR *ppvObj <br>); <br> <br>STDMETHOD_(ULONG, AddRef)( <br>THIS <br>); <br> <br>STDMETHOD_(ULONG, Release)( <br>THIS <br>); <br> <br>// Methods unique to the IExchangeFolderACLs interface. <br> <br>STDMETHOD(HrDelete)( <br>THIS <br>); <br> <br>STDMETHOD(HrGet)( <br>THIS_ <br>LPLONGlplRights, <br>LPSTR FAR *lppszDisplayName, <br>ULONG FAR *lpcbentryid, <br>LPENTRYID FAR *lppentryid <br>); <br> <br>STDMETHOD(HrInsert)( <br>THIS_ <br>LONGlRights, <br>LPSTRlpszDisplayName, <br>ULONGcbentryid, <br>LPENTRYIDlpentryid, <br>LPLONGlplRights <br>); <br> <br>STDMETHOD(HrModify)( <br>THIS_ <br>LONGlRights, <br>LPLONGlplRights <br>); <br> <br>STDMETHOD(HrSeek)( <br>THIS_ <br>LONGlPos <br>); <br> <br>STDMETHOD(HrTell)( <br>THIS_ <br>LPLONGlplPos <br>); <br> <br>    private: <br> <br>        friend CFolderACLs; // so can access m_pFA <br> <br>// Ptr to the controlling CFolderACLs object (shouldn't be <br>        // available to the user). <br> <br>CFolderACLs FAR *m_pFA; <br>}; <br> <br>#endif </code></pre>
<p>&nbsp;</p></body>
</HTML>
