<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RULECLSF.H</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context1881"></a>RULECLSF.H</h2>
<pre><code>// --ruleclsf.h--------------------------------------------------------------- <br>// <br>// Header file for the CFolderRules class and its class factory. <br>// <br>// The CFolderRules class is a controlling class.  It controls the <br>// CIExchangeFolderRules class (which implements the IExchangeFolderRules  <br>// programatic interface defined in rulecls.h).  When we add automation <br>// capabilities, it will also control the standard OLE dispatch interface <br>// for this class. <br>// <br>// Copyright (C) Microsoft Corp. 1986-1996.  All rights reserved. <br>// <br>// --------------------------------------------------------------------------- <br> <br>#if !defined(_RULECLSF_H) <br>#define _RULECLSF_H <br> <br>// $$--CFolderRules----------------------------------------------------------- <br>// <br>// The CFolderRules class. <br>// <br>// --------------------------------------------------------------------------- <br> <br>class FAR CFolderRules : public IUnknown <br>{ <br>friend class CIExchangeFolderRules; <br> <br>public: <br> <br>    CFolderRules(); <br> <br>~CFolderRules(); <br> <br>// Standard OLE stuff. <br> <br>STDMETHOD(QueryInterface)( <br>INREFIIDriid, <br>OUTVOID FAR * FAR *ppv <br>); <br> <br>STDMETHOD_(ULONG, AddRef)(VOID); <br> <br>STDMETHOD_(ULONG, Release)(VOID); <br> <br>static <br>CFolderRules FAR * <br>Create(); <br> <br>HRESULT <br>HrGetProviders( <br>OUTLPULONGlpcProviders, <br>OUTLPSTR FAR * FAR *lpppszProviders <br>); <br> <br>HRESULT <br>HrOpen( <br>INLPMDBlpMDB, <br>INULONGcbentryid, <br>INLPENTRYIDlpentryid, <br>INLPSTRlpszProvider <br>); <br> <br>protected: <br> <br>        HRESULT                 m_hr;       // constructor "return" code <br> <br>LPEXCHANGEMODIFYTABLEm_lpExchTbl; <br>     <br>LPMAPIFOLDERm_lpFolder;// Ptr to MAPI folder object. <br> <br>LPMAPITABLEm_lpMapiTbl; <br> <br>CSROWLSTm_SRowLst;// Table info stored here. <br> <br>ULONGm_refs;// Reference count. <br> <br>// This is a pointer to the CIExchangeFolderRules class, which implements <br>// the IExchangeFolderRules interface exported to the user. <br> <br>class FAR CIExchangeFolderRules FAR *m_prog_interface; <br>}; <br> <br> <br>// $$--CIExchangeFolderRules--------------------------------------------------- <br>// <br>// Class CIExchangeFolderRules.  This class implements the IExchangeFolderRules <br>// interface which is exposed to the use via the rulecls.h header file. <br>// <br>// ---------------------------------------------------------------------------- <br> <br>class FAR CIExchangeFolderRules : public IExchangeFolderRules <br>{ <br>public: <br> <br>// Standard OLE stuff. <br> <br>STDMETHOD(QueryInterface)( <br>THIS_ <br>REFIIDriid, <br>LPVOID FAR *ppvObj <br>); <br> <br>STDMETHOD_(ULONG, AddRef)( <br>THIS <br>); <br> <br>STDMETHOD_(ULONG, Release)( <br>THIS <br>); <br> <br>// Methods unique to the IExchangeFolderRules interface. <br> <br>STDMETHOD(HrDelete)( <br>THIS <br>); <br> <br>STDMETHOD(HrDisable)( <br>THIS <br>); <br> <br>STDMETHOD(HrEnable)( <br>THIS <br>); <br> <br>STDMETHOD(HrGet)( <br>THIS_ <br>LPLONGplState, <br>LPSRestriction FAR *ppRestriction, <br>LPACTIONS FAR *ppActions, <br>LPLONGplLevel, <br>LPSTR FAR *ppszName <br>); <br> <br>STDMETHOD(HrInsert)( <br>THIS_ <br>LONGlState, <br>LPSRestrictionpRestriction, <br>LPACTIONSpActions, <br>LONGlLevel, <br>LPSTRpszName <br>); <br> <br>STDMETHOD(HrSeek)( <br>THIS_ <br>LONGlPos <br>); <br> <br>STDMETHOD(HrTell)( <br>THIS_ <br>LPLONGplPos <br>); <br> <br>    private: <br> <br>        friend CFolderRules; // so can access m_pFR <br> <br>// Pointer to the controlling CFolderRules object (shouldn't be <br>        // available to the user). <br> <br>CFolderRules FAR *m_pFR; <br>}; <br> <br>#endif </code></pre>
<p>&nbsp;</p></body>
</HTML>
