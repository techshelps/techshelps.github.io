<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MBXADMIN.CPP</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context1897"></a>MBXADMIN.CPP</h2>
<pre><code>//--mbxadmin.cpp-------------------------------------------------------------- <br>// <br>// Implements an Exchange Administration property sheet dialog. <br>// <br>// This file is the class that display's the property sheet in Exchange's  <br>// Admin program.  It also modify's the extension-data for a mailbox. <br>// <br>// Copyright (C) Microsoft Corp. 1986-1996.  All Rights Reserved. <br>//---------------------------------------------------------------------------- <br> <br>#include "edkafx.h" <br> <br>#include "exadmin.h" <br>#include "resource.h" <br>#include "mbxdata.h" <br>#include "mbxadmin.h" <br> <br>#ifdef _DEBUG <br>#undef THIS_FILE <br>static char BASED_CODE THIS_FILE[] = __FILE__; <br>#endif <br> <br>CMbxAdminDlg::CMbxAdminDlg() <br>    : CAdminDialog( IDD_MBXADMIN, IDS_MBXADMIN, MBXBLOBNAME) <br>{ <br>    m_strPassword  = _T(""); <br>    m_strPassword2 = _T(""); <br>} <br> <br>BEGIN_MESSAGE_MAP(CMbxAdminDlg, CAdminDialog) <br>//{{AFX_MSG_MAP(CMbxAdminDlg) <br>    ON_EN_CHANGE(IDC_PASSWORD, OnChange) <br>    ON_EN_CHANGE(IDC_PASSWORD2, OnChange) <br>//}}AFX_MSG_MAP <br>END_MESSAGE_MAP() <br> <br>void CMbxAdminDlg::DoDataExchange(CDataExchange* pDX) <br>{ <br>CAdminDialog::DoDataExchange(pDX); <br>//{{AFX_DATA_MAP(CMbxAdminDlg) <br>DDX_Text(pDX, IDC_PASSWORD, m_strPassword); <br>    DDX_Text(pDX, IDC_PASSWORD2, m_strPassword2); <br>//}}AFX_DATA_MAP <br>} <br> <br>//$--CMbxAdminDlg::OnInitDialog()--------------------------------------------- <br>// Initialize the dialog with extension data. <br>// Create extension data if necessary. <br>// --------------------------------------------------------------------------- <br> <br>BOOL CMbxAdminDlg::OnInitDialog()  <br>{ <br>    CAdminDialog::OnInitDialog(); <br> <br>    m_strPassword = m_strPassword2 = GetExtString(IDX_PASSWORD); <br> <br>    UpdateData(FALSE);  // Send to the window <br> <br>    // If there are no properties in our blob... <br>    if( GetExtCount() == 0) <br>    {   // NO, extension data is not available so set the memory copy of this <br>        // to the defaults. <br> <br>        // The following text string pointers are cast as LONGLONG here <br>        // because  a bug in the MIPS C++ compiler causes problems if we try <br>        // to do the cast inside the ExtensionProps structure. <br> <br>        static const LONGLONG llszPassword    = (LONGLONG) TEXT(""); <br> <br>        static SInitPropValue ExtensionProps[] = <br>        { <br>            { PT_STRING8, 0, llszPassword }, <br>        }; <br>     <br>        // Initialize the property value array used to create the extension <br>        // data blob. <br>        if( FAILED( HrSetExtProps( ARRAY_CNT( ExtensionProps), ExtensionProps))) <br>            return( TRUE); <br> <br>        // Save it in Admin's memory buffer as well. <br>        CAdminDialog::bSaveData(); <br>    } <br>     <br>    return( TRUE);  // return TRUE unless you set the focus to a control <br>} <br> <br> <br>//$--CMbxAdminDlg::bSaveData()------------------------------------------------ <br>// Called when a different property sheet has been selected or when either the  <br>// OK or APPLY NOW button is pressed.  Returns TRUE if data has been validated <br>// and saved. <br>// --------------------------------------------------------------------------- <br> <br>BOOL CMbxAdminDlg::bSaveData() <br>{ <br>    HRESULT hr; <br>    UpdateData (TRUE); <br> <br>if (m_strPassword != m_strPassword2) <br>return (FALSE); <br> <br>    hr = HrModExtString( IDX_PASSWORD, m_strPassword); <br>    if( FAILED( hr)) <br>        return( FALSE); <br> <br>    return( CAdminDialog::bSaveData()); <br>} <br> <br>//$--CMbxAdminDlg::OnChange()------------------------------------------------- <br>// Called when either edit box changes <br>// --------------------------------------------------------------------------- <br> <br>void CMbxAdminDlg::OnChange() <br>{ <br>    DataHasChanged(); <br>} </code></pre>
<p>&nbsp;</p></body>
</HTML>
