<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CLIENT.H</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2233"></a>CLIENT.H</h2>
<pre><code>/* <br> -  C L I E N T . H <br> - <br> *  Purpose: <br> *      Header file for the sample mail client based on Simple MAPI. <br> * <br> *  Copyright 1993-1995 Microsoft Corporation. All Rights Reserved. <br> */ <br> <br> <br>#include "smapi.h" <br> <br>/* Menu Item IDs */ <br> <br>#define IDM_LOGON       100 <br>#define IDM_LOGOFF      101 <br>#define IDM_EXIT        102 <br>#define IDM_COMPOSE     103 <br>#define IDM_READ        104 <br>#define IDM_SEND        105 <br>#define IDM_ADDRBOOK    106 <br>#define IDM_DETAILS     107 <br>#define IDM_ABOUT       108 <br> <br>/* Resource IDs */ <br> <br>#define ICON_NOMAIL     200 <br>#define ICON_MAIL       201 <br>#define IDB_ENVELOPE    300 <br> <br> <br>/* Address Book Control IDs */ <br> <br>#define IDT_ADDRESS     101 <br>#define IDC_ADDRESS     102 <br>#define IDT_LIST        103 <br>#define IDC_LIST        104 <br>#define IDC_ADD         105 <br>#define IDC_REMOVE      106 <br> <br> <br>/* Compose Note Control IDs */ <br> <br>#define IDC_SEND        101 <br>#define IDC_RESOLVE     102 <br>#define IDC_ATTACH      103 <br>#define IDC_OPTIONS     104 <br>#define IDC_ADDRBOOK    105 <br>#define IDT_TO          106 <br>#define IDC_TO          107 <br>#define IDT_CC          108 <br>#define IDC_CC          109 <br>#define IDT_SUBJECT     110 <br>#define IDC_SUBJECT     111 <br>#define IDC_NOTE        112 <br>#define IDC_CATTACHMENT 113 <br>#define IDT_CATTACHMENT 114 <br>#define IDC_LINE1       -1 <br>#define IDC_LINE2       -1 <br> <br> <br>/* InBox Control IDs */ <br> <br>#define IDT_MSG         101 <br>#define IDC_MSG         102 <br>#define IDC_NEW         103 <br>#define IDC_READ        104 <br>#define IDC_DELETE      105 <br>#define IDC_CLOSE       106 <br> <br> <br>/* ReadNote Control IDs */ <br> <br>#define IDC_SAVECHANGES 101 <br>#define IDC_SAVEATTACH  102 <br>#define IDC_REPLY       103 <br>#define IDC_REPLYALL    104 <br>#define IDC_FORWARD     105 <br>#define IDT_RFROM       106 <br>#define IDT_RDATE       107 <br>#define IDT_RTO         108 <br>#define IDT_RCC         109 <br>#define IDT_RSUBJECT    110 <br>#define IDC_RFROM       111 <br>#define IDC_RDATE       112 <br>#define IDC_RTO         113 <br>#define IDC_RCC         114 <br>#define IDC_RSUBJECT    115 <br>#define IDC_READNOTE    116 <br>#define IDT_ATTACHMENT  117 <br>#define IDC_ATTACHMENT  118 <br> <br> <br>/* Options Control IDs */ <br> <br>#define IDC_RETURN      101 <br> <br> <br>/* Details Control IDs */ <br> <br>#define IDT_NAME        100 <br>#define IDC_NAME        101 <br>#define IDT_TYPE        102 <br>#define IDC_TYPE        103 <br>#define IDT_ADDR        104 <br>#define IDC_ADDR        105 <br> <br>/* About Box Control IDs */ <br> <br>#define IDC_VERSION     101 <br> <br> <br>/* String Table IDs */ <br> <br>#define MAPI_ERROR_MAX          30 <br> <br>#define IDS_LOGONFAIL           (MAPI_ERROR_MAX + 1) <br>#define IDS_ADDRBOOKFAIL        (MAPI_ERROR_MAX + 2) <br>#define IDS_RESOLVEFAIL         (MAPI_ERROR_MAX + 3) <br>#define IDS_UNRESOLVEDNAMES     (MAPI_ERROR_MAX + 4) <br>#define IDS_SENDERROR           (MAPI_ERROR_MAX + 5) <br>#define IDS_DETAILS_TOO_MANY    (MAPI_ERROR_MAX + 6) <br>#define IDS_DETAILSFAIL         (MAPI_ERROR_MAX + 7) <br>#define IDS_NORECIPS            (MAPI_ERROR_MAX + 8) <br>#define IDS_SAVEATTACHERROR     (MAPI_ERROR_MAX + 9) <br>#define IDS_READFAIL            (MAPI_ERROR_MAX + 10) <br>#define IDS_DIALOGACTIVE        (MAPI_ERROR_MAX + 11) <br> <br>#define IDS_FILTER              (MAPI_ERROR_MAX + 50) <br> <br>/* Manifest Constants */ <br> <br>#define ADDR_MAX            128 <br>#define MAXUSERS            10 <br>#define TO_EDIT_MAX         512 <br>#define CC_EDIT_MAX         512 <br>#define SUBJECT_EDIT_MAX    128 <br>#define NOTE_LINE_MAX       1024 <br>#define FILE_ATTACH_MAX     32 <br> <br>/* Message Box styles */ <br> <br>#define MBS_ERROR           (MB_ICONSTOP | MB_OK) <br>#define MBS_INFO            (MB_ICONINFORMATION | MB_OK) <br>#define MBS_OOPS            (MB_ICONEXCLAMATION | MB_OK) <br> <br>/* Structure Definitions */ <br> <br>typedef struct _msgid *LPMSGID; <br> <br>typedef struct _msgid <br>{ <br>    LPSTR       lpszMsgID; <br>    BOOL        fHasAttach; <br>    BOOL        fUnRead; <br>    LPSTR       lpszFrom; <br>    LPSTR       lpszSubject; <br>    LPSTR       lpszDateRec; <br>    LPMSGID     lpPrev; <br>    LPMSGID     lpNext; <br>} MSGID; <br> <br> <br> <br>/* Function Prototypes */ <br> <br>int  PASCAL WinMain(HINSTANCE, HINSTANCE, LPSTR, int); <br>BOOL InitApplication(HANDLE); <br>BOOL InitInstance(HANDLE, int); <br>void DeinitApplication(void); <br>long FAR PASCAL MainWndProc(HWND, UINT, UINT, LPARAM); <br>BOOL FAR PASCAL AboutDlgProc(HWND, UINT, UINT, LONG); <br>BOOL FAR PASCAL ComposeDlgProc(HWND, UINT, UINT, LONG); <br>BOOL FAR PASCAL InBoxDlgProc(HWND, UINT, UINT, LONG); <br>BOOL FAR PASCAL ReadMailDlgProc(HWND, UINT, UINT, LONG); <br>BOOL FAR PASCAL OptionsDlgProc(HWND, UINT, UINT, LONG); <br>BOOL FAR PASCAL DetailsDlgProc(HWND, UINT, UINT, LONG); <br>void    MakeMessageBox(HWND, ULONG, UINT, UINT); <br>ULONG   ResolveFriendlyNames(HWND, LPSTR, ULONG, ULONG *, lpMapiRecipDesc *); <br>ULONG   CopyRecipient(lpMapiRecipDesc, lpMapiRecipDesc, lpMapiRecipDesc); <br>ULONG   GetNextFile(HWND, ULONG, ULONG *, lpMapiFileDesc *); <br>ULONG   CopyAttachment(lpMapiFileDesc, lpMapiFileDesc, lpMapiFileDesc); <br>BOOL    FNameInList(LPSTR, ULONG, lpMapiRecipDesc); <br>LPMSGID MakeMsgNode(lpMapiMessage, LPSTR); <br>LPMSGID FindNode(LPMSGID, LPSTR); <br>void    InsertMsgNode(LPMSGID, LPMSGID *); <br>void    DeleteMsgNode(LPMSGID, LPMSGID *); <br>void    FreeMsgList(LPMSGID); <br>void    MakeDisplayNameStr(LPSTR, ULONG, ULONG, lpMapiRecipDesc); <br>ULONG   SaveMsgChanges(HWND, lpMapiMessage, LPSTR); <br>ULONG   MakeNewMessage(lpMapiMessage, UINT); <br>void    LogSendMail(ULONG); <br>void    SaveFileAttachments(HWND, lpMapiFileDesc); <br>void    ToggleMenuState(HWND, BOOL);    <br>BOOL    fSMAPIInstalled(void); <br>void SecureMenu(HWND hWnd, BOOL fBeforeLogon); </code></pre>
<p>&nbsp;</p></body>
</HTML>
