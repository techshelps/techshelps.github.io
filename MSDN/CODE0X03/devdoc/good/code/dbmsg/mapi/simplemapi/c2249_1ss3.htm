<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MAPINIT.C</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2253"></a>MAPINIT.C</h2>
<pre><code>#include &lt;windows.h&gt; <br>#include "mapi.h" <br>#include "mapinit.h" <br> <br> <br>extern HANDLE hLibrary; <br> <br>int FAR PASCAL InitMAPI() <br>{ <br> <br>  if ((hLibrary = LoadLibrary(MAPIDLL)) &lt; (HANDLE)32) <br>    return(ERR_LOAD_LIB); <br> <br>  if ((lpfnMAPILogon = (PFNMAPILOGON)GetProcAddress(hLibrary,SZ_MAPILOGON)) == NULL) <br>    return(ERR_LOAD_FUNC); <br> <br>  if ((lpfnMAPILogoff= (PFNMAPILOGOFF)GetProcAddress(hLibrary,SZ_MAPILOGOFF)) == NULL) <br>    return(ERR_LOAD_FUNC); <br> <br>  if ((lpfnMAPISendMail= (PFNMAPISENDMAIL)GetProcAddress(hLibrary,SZ_MAPISENDMAIL)) == NULL) <br>    return(ERR_LOAD_FUNC); <br> <br>  if ((lpfnMAPISendDocuments= (PFNMAPISENDDOCUMENTS)GetProcAddress(hLibrary,SZ_MAPISENDDOC)) == NULL) <br>    return(ERR_LOAD_FUNC); <br> <br>  if ((lpfnMAPIFindNext= (PFNMAPIFINDNEXT)GetProcAddress(hLibrary,SZ_MAPIFINDNEXT)) == NULL) <br>    return(ERR_LOAD_FUNC); <br> <br>  if ((lpfnMAPIReadMail= (PFNMAPIREADMAIL)GetProcAddress(hLibrary,SZ_MAPIREADMAIL)) == NULL) <br>    return(ERR_LOAD_FUNC); <br> <br>  if ((lpfnMAPISaveMail= (PFNMAPISAVEMAIL)GetProcAddress(hLibrary,SZ_MAPISAVEMAIL)) == NULL) <br>    return(ERR_LOAD_FUNC); <br> <br>  if ((lpfnMAPIDeleteMail= (PFNMAPIDELETEMAIL)GetProcAddress(hLibrary,SZ_MAPIDELMAIL)) == NULL) <br>    return(ERR_LOAD_FUNC); <br> <br>  if ((lpfnMAPIFreeBuffer= (PFNMAPIFREEBUFFER)GetProcAddress(hLibrary,SZ_MAPIFREEBUFFER)) == NULL) <br>    return(ERR_LOAD_FUNC); <br> <br>  if ((lpfnMAPIAddress= (PFNMAPIADDRESS)GetProcAddress(hLibrary,SZ_MAPIADDRESS)) == NULL) <br>    return(ERR_LOAD_FUNC); <br> <br>  if ((lpfnMAPIDetails= (PFNMAPIDETAILS)GetProcAddress(hLibrary,SZ_MAPIDETAILS)) == NULL) <br>    return(ERR_LOAD_FUNC); <br> <br>  if ((lpfnMAPIResolveName= (PFNMAPIRESOLVENAME)GetProcAddress(hLibrary,SZ_MAPIRESOLVENAME)) == NULL) <br>    return(ERR_LOAD_FUNC); <br> <br>  return(0); <br>} <br> <br> <br>int FAR PASCAL DeInitMAPI() <br>{ <br> <br>  lpfnMAPILogon = NULL; <br>  lpfnMAPILogoff= NULL; <br>  lpfnMAPISendMail= NULL; <br>  lpfnMAPISendDocuments= NULL; <br>  lpfnMAPIFindNext= NULL; <br>  lpfnMAPIReadMail= NULL; <br>  lpfnMAPISaveMail= NULL; <br>  lpfnMAPIDeleteMail= NULL; <br>  lpfnMAPIFreeBuffer = NULL; <br>  lpfnMAPIAddress= NULL; <br>  lpfnMAPIDetails = NULL; <br>  lpfnMAPIResolveName; <br> <br>  FreeLibrary(hLibrary); <br> <br>  return(0); <br>} </code></pre>
<p>&nbsp;</p></body>
</HTML>
