<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MAPI.H</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2250"></a>MAPI.H</h2>
<pre><code>/* <br> *  m a p i . h <br> *     <br> *  Messaging Applications Programming Interface. <br> *     <br> *  Copyright 1992 - 1998 Microsoft Corporation.  All rights reserved. <br> *     <br> *  Purpose: <br> *    This file defines the structures and constants used by <br> *    that subset of the messaging applications programming <br> *    interface which will be supported under Windows by <br> *    Microsoft Mail for PC Networks vesion 3.0. <br> */ <br> <br> <br> <br>/* <br> *  Types. <br> */ <br> <br>#ifdef __cplusplus <br>extern "C" { <br>#endif <br> <br>typedef unsigned long       ULONG; <br>typedef unsigned long FAR * LPULONG; <br>typedef unsigned long       FLAGS; <br>typedef unsigned longLHANDLE, FAR *LPLHANDLE; <br>#define lhSessionNull   ((LHANDLE)0) <br> <br> <br>#define MAPI_MESSAGEID_LENGTH   64 <br> <br>typedef struct <br>  { <br>    ULONG ulReserved;    // Reserved for future use (must be 0) <br>ULONG flFlags; // Flags <br>    ULONG nPosition;     // character in text to be replaced by attachment <br>    LPSTR lpszPathName;  // Full path name of attachment file <br>    LPSTR lpszFileName;  // Original file name (optional) <br>    LPVOID  UNALIGNED lpFileType;   // Attachment file type (optional) <br>  } UNALIGNED MapiFileDesc, UNALIGNED FAR * lpMapiFileDesc; <br> <br>#defineMAPI_OLE0x00000001 <br>#defineMAPI_OLE_STATIC0x00000002 <br> <br> <br> <br> <br>typedef struct <br>  { <br>    ULONG ulReserved;           // Reserved for future use <br>    ULONG ulRecipClass;         // Recipient class <br>                                // MAPI_TO, MAPI_CC, MAPI_BCC, MAPI_ORIG <br>    LPSTR lpszName;             // Recipient name <br>    LPSTR lpszAddress;          // Recipient address (optional) <br>    ULONG ulEIDSize;        // Count in bytes of size of pEntryID <br>    LPVOID lpEntryID;           // System-specific recipient reference <br>  } UNALIGNED MapiRecipDesc, UNALIGNED FAR * lpMapiRecipDesc; <br> <br>#define MAPI_ORIG   0           // Recipient is message originator <br>#define MAPI_TO     1           // Recipient is a primary recipient <br>#define MAPI_CC     2           // Recipient is a copy recipient <br>#define MAPI_BCC    3           // Recipient is blind copy recipient <br> <br> <br> <br>typedef struct <br>  { <br>    ULONG ulReserved;                   // Reserved for future use (M.B. 0) <br>    LPSTR lpszSubject;                  // Message Subject <br>    LPSTR lpszNoteText;                 // Message Text <br>    LPSTR lpszMessageType;              // Message Class <br>    LPSTR lpszDateReceived;             // in YYYY/MM/DD HH:MM format    <br>LPSTR lpszConversationID;// conversation thread ID <br>    FLAGS flFlags;                      // unread,return receipt <br>    lpMapiRecipDesc lpOriginator;       // Originator descriptor <br>    ULONG nRecipCount;                  // Number of recipients <br>    lpMapiRecipDesc lpRecips;           // Recipient descriptors <br>    ULONG nFileCount;                   // # of file attachments <br>    lpMapiFileDesc lpFiles;             // Attachment descriptors <br>  } UNALIGNED MapiMessage, UNALIGNED FAR * lpMapiMessage; <br> <br>#define MAPI_UNREAD             0x00000001 <br>#define MAPI_RECEIPT_REQUESTED  0x00000002 <br>#define MAPI_SENT               0x00000004 <br> <br> <br> <br>/* <br> *  Entry points. <br> */ <br> <br> <br> <br>#define MAPI_LOGON_UI                   0x00000001  // Display logon UI <br>#define MAPI_NEW_SESSION                0x00000002  // Do not use default. <br>#define MAPI_DIALOG                     0x00000008  // Display a send note UI <br>#define MAPI_UNREAD_ONLY                0x00000020  // Only unread messages <br>#define MAPI_ENVELOPE_ONLY              0x00000040  // Only header information <br>#define MAPI_PEEK                       0x00000080  // Do not mark as read. <br>#define MAPI_GUARANTEE_FIFO0x00000100// use date order <br>#defineMAPI_BODY_AS_FILE0x00000200 <br>#define MAPI_AB_NOMODIFY0x00000400// Don't allow mods of AB entries <br>#defineMAPI_SUPPRESS_ATTACH0x00000800// header + body, no files <br>#defineMAPI_FORCE_DOWNLOAD0x00001000// force download of new mail during MAPILogon <br> <br>ULONG FAR PASCAL MAPILogon(ULONG ulUIParam, LPSTR lpszName, LPSTR lpszPassword, <br>                           FLAGS flFlags, ULONG ulReserved, <br>                           LPLHANDLE lplhSession); <br> <br>ULONG FAR PASCAL MAPILogoff(LHANDLE lhSession, ULONG ulUIParam, FLAGS flFlags, <br>                            ULONG ulReserved); <br> <br>ULONG FAR PASCAL MAPISendMail(LHANDLE lhSession, ULONG ulUIParam, <br>                              lpMapiMessage lpMessage, FLAGS flFlags, <br>                              ULONG ulReserved); <br> <br>ULONG FAR PASCAL MAPISendDocuments(ULONG ulUIParam, LPSTR lpszDelimChar, <br>                                   LPSTR lpszFilePaths, LPSTR lpszFileNames, <br>                                   ULONG ulReserved); <br> <br>ULONG FAR PASCAL MAPIFindNext(LHANDLE lhSession, ULONG ulUIParam, <br>                              LPSTR lpszMessageType, LPSTR lpszSeedMessageID, <br>                              FLAGS flFlags, ULONG ulReserved, <br>                              LPSTR lpszMessageID); <br> <br>ULONG FAR PASCAL MAPIReadMail(LHANDLE lhSession, ULONG ulUIParam, <br>                              LPSTR lpszMessageID, FLAGS flFlags, <br>                              ULONG ulReserved, lpMapiMessage FAR *lppMessageOut); <br> <br>ULONG FAR PASCAL MAPISaveMail(LHANDLE lhSession, ULONG ulUIParam, <br>                              lpMapiMessage pMessage, FLAGS flFlags, <br>                              ULONG ulReserved, LPSTR lpszMessageID); <br> <br>ULONG FAR PASCAL MAPIDeleteMail(LHANDLE lhSession, ULONG ulUIParam, <br>                                LPSTR lpszMessageID, FLAGS flFlags, <br>                                ULONG ulReserved); <br> <br>ULONG FAR PASCAL MAPIFreeBuffer( LPVOID pv ); <br> <br>ULONG FAR PASCAL MAPIAddress(LHANDLE lhSession, ULONG ulUIParam, <br>LPSTR plszCaption, ULONG nEditFields, <br>LPSTR lpszLabels, ULONG nRecips, <br>lpMapiRecipDesc lpRecips, FLAGS flFlags, ULONG ulReserved,  <br>LPULONG lpnNewRecips, lpMapiRecipDesc FAR *lppNewRecips); <br> <br>ULONG FAR PASCAL MAPIDetails(LHANDLE lhSession, ULONG ulUIParam, <br>lpMapiRecipDesc lpRecip, FLAGS flFlags, ULONG ulReserved); <br> <br>ULONG FAR PASCAL MAPIResolveName(LHANDLE lhSession, ULONG ulUIParam, <br>LPSTR lpszName, FLAGS flFlags, <br>ULONG ulReserved, lpMapiRecipDesc FAR *lppRecip); <br> <br> <br> <br>#define SUCCESS_SUCCESS                     0 <br>#define MAPI_USER_ABORT                     1 <br>#define MAPI_E_FAILURE                      2 <br>#define MAPI_E_LOGIN_FAILURE                3 <br>#define MAPI_E_DISK_FULL                    4 <br>#define MAPI_E_INSUFFICIENT_MEMORY          5 <br>#define MAPI_E_ACCESS_DENIED6 <br>#define MAPI_E_TOO_MANY_SESSIONS            8 <br>#define MAPI_E_TOO_MANY_FILES               9 <br>#define MAPI_E_TOO_MANY_RECIPIENTS          10 <br>#define MAPI_E_ATTACHMENT_NOT_FOUND         11 <br>#define MAPI_E_ATTACHMENT_OPEN_FAILURE      12 <br>#define MAPI_E_ATTACHMENT_WRITE_FAILURE     13 <br>#define MAPI_E_UNKNOWN_RECIPIENT            14 <br>#define MAPI_E_BAD_RECIPTYPE                15 <br>#define MAPI_E_NO_MESSAGES                  16 <br>#define MAPI_E_INVALID_MESSAGE              17 <br>#define MAPI_E_TEXT_TOO_LARGE               18 <br>#defineMAPI_E_INVALID_SESSION19 <br>#defineMAPI_E_TYPE_NOT_SUPPORTED20 <br>#defineMAPI_E_AMBIGUOUS_RECIPIENT21 <br>#define MAPI_E_MESSAGE_IN_USE22 <br>#define MAPI_E_NETWORK_FAILURE23 <br>#defineMAPI_E_INVALID_EDITFIELDS24 <br>#defineMAPI_E_INVALID_RECIPS25 <br>#defineMAPI_E_NOT_SUPPORTED26 <br> <br>#ifdef __cplusplus <br>} <br>#endif </code></pre>
<p>&nbsp;</p></body>
</HTML>
