<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>README.TXT</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2123"></a>README.TXT</h2>
<pre><code>Sample Message Hook <br> <br> <br>The Manager.Sh sample is a sample spooler message hook provider (SMH32.DLL). <br>The sample spooler hook is an example of a reasonably clever extension to <br>MAPI which uses the documented MAPI spooler message hook interfaces to <br>categorize and archive sent and received mail. <br> <br>Installation <br>------------ <br> <br>The sample spooler hook is shipped in source form for 32-bit platforms only. <br>You must build SMH32.DLL first. For the DLL to build successfully, you must <br>have an SDK that includes the import libraries for the Windows 95 common <br>controls installed. For the DLL to run successfully on Windows NT 3.5, the <br>Windows 95 compatible common controls must be installed. Windows NT 3.51 <br>includes these controls. <br> <br>After building SMH32.DLL, copy it to the system directory of the target <br>machine, then use the mergeini utility to merge smh.inf into mapisvc.inf. <br> <br>For example: <br> <br>    copy smh32.dll c:\windows\system <br>    mergeini.exe -m .\smh.inf <br> <br>Start the control panel and start the Mail and Fax applet. Select "Add..." <br>on the Services page of Profile Properties and double-click Sample Mail <br>Handler. <br> <br>Configuration <br>------------- <br> <br>The sample message hook has a three-page property sheet interface for <br>interactive configuration, which is accessible through service provider <br>logon, through the ServiceEntry call, and through the <br>IMAPIStatus::SettingsDialog method. <br> <br>When you first add the sample message hook to the profile configuration, <br>you will need to log off the profile if you are already logged in, and <br>then log in again before the change will take effect. <br> <br>General Page <br>------------ <br> <br>Incoming mail -- Use the "Enable filtering of inbound messages" checkbox <br>to start inbound/outbound mail "filter"ing. Use the "Add unread messages <br>folder to hierarchy" checkbox to create a search folder containing all <br>unread messages for easier access. <br> <br>Sent mail -- Use the "Archive sent mail into monthly subfolders" checkbox <br>to instruct the hook processor to categorize sent mail by date and to use <br>and create subfolders based on the month of submission to contain these <br>messages. Use the "Archive sent mail monthly folders by year" checkbox to <br>further organize the archives by year (e.g. sent mail\year\month folder <br>hierarchy). <br> <br>Deleted mail -- Use the "Archive deleted mail into monthly subfolders" <br>checkbox to instruct the hook processor to categorize deleted mail by date <br>and to use and create subfolders based on the month of creation to contain <br>these messages. Use the "Archive deleted mail monthly folders by year" <br>checkbox to further organize the archives by year <br>(e.g. deleted mail\year\month folder hierarchy). <br> <br>Filters Page <br>------------ <br> <br>This page displays a listbox containing all the filters/actions which have <br>been defined for this profile. The sample hook processor traverses this <br>list from top to bottom in determining the disposition of a newly <br>sent/received message. The first rule that "fires" will be the only one <br>which is applied to the message in question. <br> <br>To add a filter rule, use the "New" button. To change a rule, select it <br>and use the "Edit" button. To delete a rule, select it and use the "Delete" <br>button. To arrange the ordering of rules, select the rule whose position in <br>the list needs changing and use the up/down arrow buttons to make the <br>appropriate change. <br> <br>When you select "New" or "Edit", the filter description dialog will be <br>presented to you. In this dialog you should enter a display name for the <br>filter rule that can be used for the listbox, select one of the filtering <br>criteria (self-explanatory). Enter the appropriate string in "Value contains" <br>(in the case of recipients, the filter compares both the display name and <br>the email address), the display name (as shown in the left-hand pane of the <br>Exchange mail client) of the target store in the "Target Store" field, and <br>the display name (again as shown in the Exchange mail client) of the folder <br>to which you want mail matching this filter rule to be copied in the "Target <br>Folder" field. The hook provider will create folders if need be; to specify <br>folders in a hierarchy, use a backslash character (e.g. My Mail\Clever <br>Sayings). To get the negative effect (ie this rule fires for a message not <br>matching the criteria), set the "Filter messages that do not match this <br>criteria" checkbox. To disable a filter without deleting it, you set the <br>"Discontinue the filtering of messages matching this criteria" checkbox. To <br>choose archiving options for the filter (like in the Sent Mail / Deleted Mail <br>option above) you may set the appropriate checkboxes for the rule. <br> <br>Exclusions Page <br>--------------- <br> <br>This page displays a listbox containing all the message classes for which <br>filtering is disabled. The sample hook processor traverses this list from top <br>to bottom in determining whether it should filter a newly sent/received <br>message. If any message class matches, rules processing will not occur for <br>that message. <br> <br>To add a message class, use the New button. To delete a rule, select it and <br>use the Delete button. To arrange the ordering of rules, select the rule <br>whose position in the list needs changing and use the up/down arrow buttons <br>to make the appropriate change. <br> <br>Known Problems <br>-------------- <br> <br>Some of the sample hook's features will not work if you use a tightly-coupled <br>store and transport as your default message store. The archiving of sent and <br>received mail will not work, because the hook entry points are never called <br>when the message store server receives mail. Other features, such as archiving <br>of deleted messages and auto-reply, will work normally. <br> <br>The hook only can be built on/for 32-bit platforms (this is a limitation of <br>the sample provider, not of the hook interface itself). The Unread Messages <br>folder doesn't always seem to be accessable from the Exchange client. The <br>"Filter messages that do not match this criteria" checkbox doesn't always <br>seem to work. </code></pre>
<p>&nbsp;</p></body>
</HTML>
