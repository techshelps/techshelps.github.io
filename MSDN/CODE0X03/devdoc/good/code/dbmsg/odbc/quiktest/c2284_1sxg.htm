<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AUTOTEST.H</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context2284"></a>AUTOTEST.H</h2>
<pre><code>//*--------------------------------------------------------------------------------- <br>//|  Title:AUTOTEST.H <br>//| <br>//|This file contains constants and prototypes required to compile an  <br>//|Auto Test DLL. <br>//*--------------------------------------------------------------------------------- <br>#ifndef AUTOTEST_DEFS <br>#define AUTOTEST_DEFS <br> <br>#include &lt;windows.h&gt; <br>#include &lt;stdlib.h&gt; <br>#include &lt;string.h&gt; <br>#include "sql.h" <br>#include "sqlext.h" <br> <br>#ifdef __cplusplus <br>extern "C" {  <br>#endif/* __cplusplus */ <br> <br> <br>extern HINSTANCEhLoadedInst; <br> <br> <br>//---------------------------------------------------------------------------------- <br>//Defines and Macros <br>//---------------------------------------------------------------------------------- <br>#define TEST_ABORTED(-1) <br> <br>#define AUTO_MAX_TEST_NAME35 <br>#define AUTO_MAX_TESTCASE_NAME35 <br>#define AUTO_MAX_TESTDESC_NAME75 <br> <br>#define MAXFLUSH    300 <br>#define MAX_USER_INFO  50 <br>#define MAX_KEYWORD_LEN   149 <br> <br>#ifdef WIN32 <br>#define EXTFUNCDECL_stdcall <br>#define EXTFUN_stdcall <br>#else <br>#define EXTFUNCDECL <br>#define EXTFUN__export FAR PASCAL <br>#endif <br> <br> <br>#define InitTest(lps)\ <br>{ lps-&gt;cErrors=0; } <br>#define AbortTest(lps)\ <br>{ lps-&gt;cErrors=TEST_ABORTED; } <br> <br>#define     AllocateMemory(cb)\ <br>                (GlobalLock(GlobalAlloc((GMEM_FIXED | GMEM_ZEROINIT), (cb)))) <br>#ifdef WIN32 <br>#define     ReleaseMemory(lp)\ <br> (GlobalUnlock((HGLOBAL)GlobalHandle(lp)), (BOOL)GlobalFree((HGLOBAL)GlobalHandle(lp))) <br>#else <br>#define     ReleaseMemory(lp)\ <br>                (GlobalUnlock(((HGLOBAL)LOWORD(GlobalHandle(SELECTOROF(lp))))), \ <br>                (BOOL)GlobalFree(((HGLOBAL)LOWORD(GlobalHandle(SELECTOROF(lp)))))) <br>#endif <br> <br>#define NumItems(s) (sizeof(s) / sizeof(s[0])) <br> <br>// Following will access bit number pos in a bit array and return <br>//TRUE if it is set, FALSE if it is not <br>#define CQBITS (sizeof(UINT) * 8) <br>#define getqbit(lpa, pos)\ <br>(lpa[((pos) / CQBITS)] &amp; (1 &lt;&lt; ((pos) - (CQBITS * ((pos) / CQBITS))))) <br>#define GETBIT(p1,p2) getqbit(p1,(p2)-1) <br> <br> <br> <br>// <br>// This structure contains the information found in the .INI file for a  <br>//data source.  The filled out structure is in turn passed to AutoTestFunc <br>//to drive the individual tests. <br>// <br>typedef struct tagSERVERINFO { <br>HWND hwnd;// Output edit window <br>TCHAR   szLogFile[_MAX_PATH];// Output log file <br>HENV henv;// .EXE's henv <br>HDBC hdbc;// .EXE's hdbc <br>HSTMThstmt;// .EXE's hstmt <br> <br>// The following items are gathered from the .INI file and may be defined <br>//via the "Manage Test Sources" menu item from ODBC Test <br>TCHAR szSource[SQL_MAX_DSN_LENGTH+1]; <br>TCHAR szValidServer0[SQL_MAX_DSN_LENGTH+1]; <br>TCHAR szValidLogin0[MAX_USER_INFO+1]; <br>TCHAR szValidPassword0[MAX_USER_INFO+1]; <br>TCHARszKeywords[MAX_KEYWORD_LEN+1]; <br> <br>// Following are used for run-time <br>UINT FAR * rglMask;  // Run test mask <br>int  failed;// Track failures on a test case basis <br>int  cErrors;// Count of errors <br>BOOL fDebug;// TRUE if debugging is to be enabled <br>BOOL fScreen;// TRUE if test output goes to screen <br>BOOL fLog;// TRUE if test output goes to log <br>BOOL fIsolate;// TRUE to isolate output <br>UDWORDvCursorLib;// Value for SQL_ODBC_CURSOR on SQLSetConnectOption <br>HINSTANCEhLoadedInst;// Instance handle of loaded test <br> <br>// Following are used for buffering output to edit window <br>TCHARszBuff[MAXFLUSH];// Hold temporary results <br>UINTcBuff;// Number of TCHARs in szBuff <br>} SERVERINFO; <br>typedef SERVERINFO FAR * lpSERVERINFO; <br> <br> <br>//---------------------------------------------------------------------------------- <br>// Function prototypes <br>//---------------------------------------------------------------------------------- <br>BOOL EXTFUNCDECL FAR szLogPrintf(lpSERVERINFO lps, BOOL fForce, LPTSTR szFmt, ...); <br>int EXTFUNCDECL FAR szMessageBox(HWND hwnd, UINT style, LPTSTR szTitle, LPTSTR szFmt, ...); <br>LPTSTR EXTFUN GetRCString(HINSTANCE hInst, LPTSTR buf, int cbbuf, UINT ids); <br> <br> <br>#ifdef __cplusplus <br>} <br>#endif <br> <br>#endif <br> <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
