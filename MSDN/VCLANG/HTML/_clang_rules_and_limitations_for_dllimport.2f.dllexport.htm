<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Rules and Limitations for dllimport/dllexport</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_clang_rules_and_limitations_for_dllimport.2f.dllexport"></a><sup></sup>Rules and Limitations for dllimport/dllexport</h1>
<p>
<b>Microsoft Specific —&gt;</b>
<ul type=disc>
<li>
If you declare a function without the <b>dllimport</b> or <b>dllexport</b> attribute, the function is not considered part of the DLL interface. Therefore, the definition of the function must be present in that module or in another module of the same program. To make the function part of the DLL interface, you must declare the definition of the function in the other module as <b>dllexport</b>. Otherwise, a linker error is generated when the client is built.<br><br></li>
<li>
If a single module in your program contains <b>dllimport</b> and <b>dllexport</b> declarations for the same function, the <b>dllexport</b> attribute takes precedence over the <b>dllimport</b> attribute. However, a compiler warning is generated. For example:<pre><code>#define DllImport    __declspec( dllimport )
#define DllExport    __declspec( dllexport )

DllImport void func1( void );
DllExport void func1( void );&nbsp;&nbsp; /* Warning; dllexport */
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* takes precedence. */
</code></pre>
</li>
<li>
You cannot initialize a static data pointer with the address of a data object declared with the <b>dllimport</b> attribute. For example, the following code generates errors:<pre><code>#define DllImport    __declspec( dllimport )
#define DllExport    __declspec( dllexport )

DllImport int i;
.
.
.
int *pi = &amp;i;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* Error */

void func2()
{
static int *pi = &amp;i;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* Error */
}
</code></pre>
</li>
<li>
Initializing a static function pointer with the address of a function declared with <b>dllimport</b> sets the pointer to the address of the DLL import thunk (a code stub that transfers control to the function) rather than the address of the function. This assignment does not generate an error message:<pre><code>#define DllImport    __declspec( dllimport )
#define DllExport    __declspec( dllexport )

DllImport void func1( void 
.
.
.
static void ( *pf )( void ) = &amp;func1;&nbsp;&nbsp; /* No Error */

void func2()
{
static void ( *pf )( void ) = &amp;func1;&nbsp; /* No Error */
}
</code></pre>
</li>
<li>
Because a program that includes the <b>dllexport</b> attribute in the declaration of an object must provide the definition for that object, you can initialize a global or local static function pointer with the address of a <b>dllexport</b> function. Similarly, you can initialize a global or local static data pointer with the address of a <b>dllexport</b> data object. For example:<pre><code>#define DllImport    __declspec( dllimport )
#define DllExport    __declspec( dllexport )

DllImport void func1( void );
DllImport int i;

DllExport void func1( void );
DllExport int i;
.
.
.
int *pi = &amp;i;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* Okay */
static void ( *pf )( void ) = &amp;func1;&nbsp;&nbsp;&nbsp; /* Okay */

void func2()
{
static int *pi = i;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* Okay */
static void ( *pf )( void ) = &amp;func1;&nbsp;&nbsp; /* Okay */
}&nbsp;&nbsp;&nbsp;&nbsp; 
</code></pre>
</li>
</ul>
<p>
<b>END Microsoft Specific</b></p>
</font></BODY>
</HTML>
