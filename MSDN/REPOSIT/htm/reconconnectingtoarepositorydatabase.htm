<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Connecting to a Repository Database</title>
<style>@import url(/stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/stylesheets/msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="reconconnectingtoarepositorydatabase"></a>Connecting to a Repository Database</h1>
<p>
Microsoft<sup>®</sup> Repository can access Repository databases that are managed by either Microsoft Jet or Microsoft SQL Server. The ODBC connection string that is used to specify the location of the Repository database varies, depending upon which database server is managing the Repository database.</p>
<p>
The ODBC connection string contains <i>keyword=keyValue</i> pairs, separated by semicolons.</p>
<h2>Connecting to a Jet Repository Database</h2>
<p>
To connect to a Jet Repository database, use the DBQ keyword to specify the path to the database file. The DBQ keyword must be the first keyword in the connection string, if it is present. If the DBQ keyword is not present, the connection string is assumed to contain only a database path specification. In this case, the Repository will add the DBQ keyword to the front of the ODBC connection string before passing it on to the database server. If the JET database file specified by the DBQ keyword does not exist, Microsoft Repository will create it.</p>
<h2>Connecting to a SQL Server Repository Database</h2>
<p>
To connect to a SQL Server Repository database, use the SERVER keyword to specify the SQL Server name and (optionally) the database name. To specify the database name, use this syntax:</p>
<pre><code>    SERVER=<i>serverName</i><b>;</b>DATABASE=<i>databaseName</i>
</code></pre>
<p>
If the database name is not specified, the default database for the user performing the open is used.</p>
<p>
<b>Note&nbsp;&nbsp;&nbsp;</b>If you choose to use a SQL Server Repository database, you must either use an existing database, or create an empty database and specify which users can access the database. The Repository engine will not automatically create this database for you. If you create a new SQL Server database, be sure to create the necessary "Login" and "User" accounts for people who will be accessing the database, and assign the appropriate permissions to these accounts. If everyone will be granted full permissions, then you can use this SQL command to set database access permissions: "Grant all to public".</p>
<h2>Connecting via a Data Source Name</h2>
<p>
You can use the DSN keyword to specify a Data Source Name (DSN) to connect to an existing Jet or SQL Server Repository database. The DSN keyword specifies a Data Source Name that has been configured via the ODBC Data Source Administrator.</p>
<h2>The Default Repository Database</h2>
<p>
If you do not specify the Repository database via any of the mechanisms described above, a connection will be established to the <i>default Repository database</i>. The location of the default Repository database is stored in the system registry in this registry key:</p>
<pre><code>    HKEY_LOCAL_MACHINE\
        Software\
            Microsoft\
                Repository\
                    Current Location
</code></pre>
<p>
This registry key must contain either a DBQ keyword-value pair, SERVER keyword-value pair, DSN keyword-value pair, or just the path to a Jet Repository database. The default value for this registry key is:</p>
<pre><code>    <i>windowsDirectory</i>\MsApps\Repostry\Repostry.mdb
</code></pre>
<p>
where <i>windowsDirectory</i> is the path specification for the directory that contains either the Windows NT or Windows 95 installation. Unless you change this registry key value after installing Microsoft Repository, your default database server will be Microsoft Jet.</p>
<p>
<b>Note</b>&nbsp;&nbsp;&nbsp;Microsoft Repository will create a default Repository database for you when it is installed. This database is managed by Microsoft Jet. It's location is determined by the default value of the <i>Current Location</i> registry key.</p>
</BODY>
</HTML>
