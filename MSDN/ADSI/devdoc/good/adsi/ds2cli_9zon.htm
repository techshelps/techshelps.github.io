<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using ADO for Querying</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_ds_using_ado_for_querying"></a>Using ADO for Querying</h3>
<p>
The following example shows how Automation clients can use ActiveX Data Objects (ADO) to query directory services using ADSI and its OLE DB implementation. The ADO object model consists of the following objects:
<dl>
<dt>
Connection</dt>
<dd>
An open connection to an OLE DB data source such as ADSI.</dd>
<dt>
Command</dt>
<dd>
Defines a specific command to execute against the data source. </dd>
<dt>
Parameters</dt>
<dd>
An optional collection for any parameters to provide to the command object. </dd>
<dt>
Recordset</dt>
<dd>
A set of records from a table, command object, or SQL syntax. A recordset can be created without any underlying Connection object. </dd>
<dt>
Field</dt>
<dd>
A single column of data in a recordset.</dd>
<dt>
Property</dt>
<dd>
A collection of values supplied by the provider for ADO.</dd>
<dt>
Error</dt>
<dd>
Contains details about data access errors, refreshed for each time an error occurs in a single operation. 
</dd>
</dl>
<p>
For more information, see the Microsoft Platform SDK under ActiveX Data Objects. </p>

<p>
<a name="_ds_user_accounts_on_an_ldap_server"></a>The following example disables the user accounts on an ldap server. </p>
<pre><code>Dim X as IADs
Dim con As New Connection, rs As New Recordset
Dim MyUser As IADsUser
    
con.Provider = "ADsDSOObject"
con.Open "Active Directory Provider", "CN=Foobar,CN=Users,DC=MICROSOFT,DC=COM,O=INTERNET", "Password"
Set rs = con.Execute("&lt;LDAP://ldapserver.microsoft.com/O=Internet/DC=COM/DC=MICROSOFT/OU=MyOrg&gt;;(objectClass=User);ADsPath;onelevel")
    
While Not rs.EOF
    MyUser = GetObject(rs.Fields(0).Value)
    MyUser.AccountDisabled = True
    rs.MoveNext
Wend
</code></pre>
<p>&nbsp;</p></body>
</HTML>
