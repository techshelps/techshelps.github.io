<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Supplying Credentials</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_ds_supplying_credentials"></a>Supplying Credentials</h3>
<p>
Microsoft's LDAP implementation uses the <i>lnFlags </i>parameter in <a href="ds2_if_3uic.htm"><b>IADsOpenDSObject::OpenDSObject</b></a> and the function <a href="ds2_func_0bp0.htm"><b>ADsOpenObject</b></a> to allow clients to request specific binding options when opening an object. These flags are described below:
<dl>
<dt>
<i>lnFlags</i></dt>
<dd>
[in] Flags that define the binding options. 
<p>
In the following table, SSPI is the Microsoft® Security Support Provider Interface, an API set designed to support security services across a network. SSL is the Secure Sockets Layer, an public domain protocol for authenticating private communications over the Internet. 

<p>
There are two flags defined for <i>lnFlags</i>: 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=63%>FLAG</th>
<th align=left width=37%>Value</th>
</tr>
<tr valign=top>
<td width=63%>ADSI_USE_SECURE_AUTHENTICATION</td>
<td width=37%>0x00000001</td>
</tr>
<tr valign=top>
<td width=63%>ADSI_USE_ENCRYPTION</td>
<td width=37%>0x00000010</td>
</tr>
</table><br>


<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=21%>Case</th>
<th align=left width=31%>Flags</th>
<th align=left width=48%>Action</th>
</tr>
<tr valign=top>
<td width=21%>UserName and Password Specified.</td>
<td width=31%>SECURE_<p>
AUTHENTICATION = 1</p>
<p>
ENCRYPTION = 1</p>
</td>
<td width=48%>Simple bind over SSL (secure authentication over a secure channel).</td>
</tr>
<tr valign=top>
<td width=21%>UserName and Password Specified.</td>
<td width=31%>SECURE_<p>
AUTHENTICATION = 1</p>
<p>
ENCRYPTION = 0</p>
</td>
<td width=48%>As above, except that if the ldap_open call to the SSL port fails, it calls SSPI with the user name and password.</td>
</tr>
<tr valign=top>
<td width=21%>UserName and Password Specified.</td>
<td width=31%>SECURE_<p>
AUTHENTICATION = 0</p>
<p>
ENCRYPTION = 1</p>
</td>
<td width=48%>Simple bind over SSL.</td>
</tr>
<tr valign=top>
<td width=21%>UserName and Password Specified.</td>
<td width=31%>SECURE_<p>
AUTHENTICATION = 0</p>
<p>
ENCRYPTION = 0</p>
</td>
<td width=48%>Simple bind.</td>
</tr>
<tr valign=top>
<td width=21%>Default Credentials (UserName and Password NULL).</td>
<td width=31%>SECURE_<p>
AUTHENTICATION = </p>
<p>
0 or 1</p>
<p>
ENCRYPTION = 1</p>
</td>
<td width=48%>Fail.</td>
</tr>
<tr valign=top>
<td width=21%>Default Credentials (UserName and Password NULL).</td>
<td width=31%>SECURE_<p>
AUTHENTICATION = 1</p>
<p>
ENCRYPTION = 0</p>
</td>
<td width=48%>Use SSPI. If that fails, fail.</td>
</tr>
<tr valign=top>
<td width=21%>Default Credentials (UserName and Password NULL).</td>
<td width=31%>SECURE_<p>
AUTHENTICATION = 0</p>
<p>
ENCRYPTION = 0</p>
</td>
<td width=48%>Use SSPI. If that fails, do a simple bind with NULL, NULL.</td>
</tr>
</table><br>

</dd>
</dl>
<p>
If possible, ADSI uses existing connections. Therefore, ADSI client applications should always keep one object open to prevent having to do binds and rebinds on subsequent calls. Any attempt to bind following the first must, like the first, supply a new password.</p>
<p>
<b>Note</b>&nbsp;&nbsp;ADSI maintains the schema cache in memory on the server until the reference count on the cache = zero. To update the schema, </p>
<p>&nbsp;</p></body>
</HTML>
