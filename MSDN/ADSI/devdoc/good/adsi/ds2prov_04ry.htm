<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ADSI Component Interaction</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_ds_adsi_component_interaction"></a>ADSI Component Interaction</h2>
<p>
The Active Directory router component populates an ADSI provider table from the installed ADSI providers listed in the registry when it receives its first request from the client application. Registry information can be found in <a href="ds2samp_2ovo.htm"><b>Installing the Example Provider Component</b></a>. </p>
<p>
Operations that make a request from a directory for a pointer to an interface on an Active Directory object come through a function (<b>GetObject</b> in Visual Basic or Java or <a href="ds2_func_0bp0.htm"><b>ADsOpenObject</b></a> or <a href="ds2_func_1a2c.htm"><b>ADsGetObject</b></a> in C or C++), or an interface method (<a href="ds2_if_8zhw.htm"><b>IADsContainer::GetObject</b></a>). In the following figure, the ADSI client application passes such a bind request to the ADSI router component (1). The router component identifies the ProgID for the provider from the first part of the ADsPath and uses <b>CLSIDFromProgID</b> to find the matching CLSID in the registry(2) and loads the proper provider component (3). </p>
<p>
<img src="images/dscspr.gif" border=0></p>
<p>
<b>ADSI Component Interactions in the Example Provider.</b></p>
<p>
In the preceding figure, the provider component creates an Active Directory object representing the named directory element. The ADSI support component does a <b>QueryInterface</b> on the requested interface identifier. Once a pointer to that interface is retrieved (4), as with all COM client/server implementations, it is then passed back to the client (5), and from then on the client application works directly with the provider component (6).</p>
<p>&nbsp;</p></body>
</HTML>
