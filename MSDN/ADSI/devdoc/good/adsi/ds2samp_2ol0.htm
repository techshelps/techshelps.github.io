<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Schema Management</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_ds_schema_management"></a>Schema Management</h1>
<p>
The ADSI example provider component defines the schema classes "Organizational Unit" and "User" and manages these schema classes in the following way. </p>
<p>
The "Organizational Unit" schema class is represented by an ADs container object and can contain other "Organizational Units" and "Users". The container object automatically supports the interfaces <b>IUnknown</b>, <b>IDispatch</b>, <a href="ds2_if_74s3.htm"><b>IADs</b></a>, and <a href="ds2_if_325u.htm"><b>IADsContainer</b></a>. The "User" schema class is represented by a generic Active Directory object<b> </b>and does not contain any other types of objects. In the example provider component, the User object is implemented as a generic Active Directory object that supports the interfaces <b>IUnknown</b>, <b>IDispatch</b>, and <a href="ds2_if_74s3.htm"><b>IADs</b></a><b>. </b>Note that the User object in this case does not support the <a href="ds2_if_488i.htm"><b>IADsUser</b></a> interface. </p>
<p>
The example provider component must also implement the ADs namespace object, which supports the interfaces <b>IUnknown</b>, <b>IADs</b>, <a href="ds2_if_325u.htm"><b>IADsContainer</b></a>, <a href="ds2_if_0e5w.htm"><b>IADsOpenDSObject</b></a>, and <b>IDispatch</b>. </p>
<p>
The details of the schema representing the two example provider component schema classes are shown in the following figure.</p>
<p>
<img src="images/dssmsch.gif" border=0></p>
<p>
<b>ADSI Example Provider Component Schema</b></p>
<p>
Note that in the preceding figure the "Organizational Unit" schema class defines three properties: "Description," "Headcounts," and "ID." The "User" schema class defines four properties: "ID," "Name," "PhoneNumber," and "Title." The "ID" property is shared by both schema classes. Each property is defined by either the "String" or the "Integer" syntax object.</p>
<p>
<b>Note</b>&nbsp;&nbsp;Syntax objects are not present in the first release of the example provider component. However, in most Microsoft ADSI schema implementations, the syntax objects are included in the schema container object, just as the schema class and property objects are. For this reason, they are shown here. </p>
<p>
This provider component makes the schema information accessible to the ADSI client application in the form of ADs class objects, ADs property objects, and ADs syntax objects all within a schema class container object, so that schema information can be retrieved at run-time.</p>
<p>
The ADsPaths for the schema class container objects defined for the example provider component are "Sample://Seattle/schema" and "Sample://Toronto/schema.". In this example, the contents of the schemas are identical. </p>
<p>&nbsp;</p></body>
</HTML>
