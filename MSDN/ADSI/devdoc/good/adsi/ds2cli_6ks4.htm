<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Automation - Retrieving a Property From an ADSI Object</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_ds_automation_retrieving_a_property_from_an_adsi_object"></a>Automation - Retrieving a Property From an ADSI object</h3>
<p>
The following example retrieves a property directly from an ADSI object using the standard <a href="ds2_if_488i.htm"><b>IADsUser</b></a> interface and the <b>Fullname</b> property it supports.</p>
<pre><code>Dim MyUser as IADsUser
Dim MyName as String
 
Set MyUser = GetObject("NDS://O=MyOrg/OU=SomeOU/CN=JamesSmith")
MyName = MyUser.Fullname
 </code></pre>
<p>
The following example retrieves a property by name from an object using <a href="ds2_if_9kc4.htm"><b>IADs::Get</b></a>.<b> </b>If the property is multivalued, <a href="ds2_if_7z20.htm"><b>IADs::GetEx</b></a> must be used. Note that because <a href="ds2_if_488i.htm"><b>IADsUser</b></a> inherits from <a href="ds2_if_74s3.htm"><b>IADs</b></a>, the methods supported by <b>IADs</b> are automatically accessible. </p>
<pre><code>Dim MyUser as IADsUser
Dim MyName as String
 
set MyUser = GetObject("NDS://O=MyOrg/OU=SomeOU/CN=JamesSmith")
MyName = MyUser.Get("Fullname")
 </code></pre>
<p>
The following example uses <b>IADsPropertyList</b> using the <b>Next</b> method to retrieve all the properties on a given object from an LDAP server. </p>
<pre><code>Dim MyVar As Variant
Dim MyADsPropList As IADsPropertyList
Dim MyADsObj As IADsOpenDSObject
Dim DN As String
Dim UserName As String
Dim Password As String
Dim propcount As Integer
 
'Bind to specific object
DN = "LDAP://MyServer/dc=Mydomain,dc=microsoft,dc=com,o=internet"
UserName = "cn=Administrator,cn=Users,dc=Mydomain,dc=microsoft,dc=com,o=internet"
Password = "password"
Set MyADsObj = GetObject("LDAP:")
Set MyADsPropList = MyADsObj.OpenDSObject(DN, UserName, Password, 0)
 
' Get the properties into the cache !
MyADsPropList.GetInfo
 
'Get the Number of Properties in the list and walk the list
propcount = MyADsPropList.PropertyCount
 
Debug.Print "There are ", propcount, " properties."
 
For i = 1 To propcount
    Set MyVar = MyADsPropList.Next
    Debug.Print "The property Name from Variant is "; MyVar.Name
Next
 
On Error Resume Next
' This call will fail !
Set MyVar = MyADsPropList.Next
If Err.Number Then
    Debug.Print Err.Number; " Occurred "
    Err.Clear
End If
 
' Now Reset the property Index and and then call next
' This will return the first value
MyADsPropList.Reset
Set MyVar = MyADsPropList.Next
Debug.Print "The first element in the list has the name ", MyVar.Name
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
