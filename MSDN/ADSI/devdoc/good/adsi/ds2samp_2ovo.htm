<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing the Example Provider Component</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_ds_installing_the_example_provider_component"></a>Installing the Example Provider Component</h1>
<p>
After installing the ADSI SDK, and starting from the installation directory, move to samples\activeds\sampprov\setup. Run install.bat as described in the README.TXT instructions.</p>
<p>
For registry settings, under the HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ADs\Providers subkey, the ADSI example provider component has the following subkeys and values:</p>
<p class=indent1>
ProgIDNamespace = SampleNamespace</p>
<p>
Under the HKEY_CLASSES_ROOT\CLSID subkey, provider namespace objects must have the following subkeys and values:</p>
<p class=indent1>
SampleNamespaceCLSID= Sample Namespace Object</p>
<p class=indent1>
SampleNamespaceCLSID\InProcServer32 = adssmp.dll</p>
<p class=indent1>
SampleNamespaceCLSID\InProcServer32\ThreadingModel=Both</p>
<p class=indent1>
SampleNamespaceCLSID\ProgID= Sample</p>
<p class=indent1>
SampleNamespaceCLSID\TypeLib=ProviderTypeLibCLSID</p>
<p class=indent1>
SampleNamespaceCLSID\Version = 0.0</p>
<p>
Under the HKEY_CLASSES_ROOT\CLSID subkey, provider top-level objects must have the following subkeys and values:</p>
<p class=indent1>
SampleCLSID = Sample Provider Object</p>
<p class=indent1>
SampleCLSID\InProcServer32 = adssmp.dll</p>
<p class=indent1>
SampleCLSID\InProcServer32\ThreadingModel=Both</p>
<p class=indent1>
SampleCLSID\ProgID= Sample</p>
<p class=indent1>
SampleCLSID\TypeLib=ProviderTypeLibCLSID</p>
<p class=indent1>
SampleCLSID\Version = 0.0</p>
<p>
For the specific example of the example provider component dll, the following registry entries are needed: </p>
<pre><code>HKEY_LOCAL_MACHINE
    SOFTWARE
        +CLSID
        Sample
            Clsid          &lt;No Name&gt;:REG_SZ{323991f0-…}
        SampleNAMESPACE
            Clsid          &lt;No Name&gt;:REG_SZ{51d11c90--…}
 </code></pre>
<p>
Other entries in the registry under concerning the example provider component exist because the example provider component happened to implement its directory hierarchy in the registry. This in no way implies other providers would want to or should do the same.</p>
<p>&nbsp;</p></body>
</HTML>
