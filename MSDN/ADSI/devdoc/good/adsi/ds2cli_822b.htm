<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ADSI Errors</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_ds_adsi_errors"></a>ADSI Errors</h2>
<p>
ADSI error codes are returned in the standard COM HRESULT status variable using facility code 5 with the severity bit set TRUE. This results in errors of the form 0x80005xxx. The following 32-bit error codes are listed here and defined in adserr.h. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=24%>Error/Value</th>
<th align=left width=76%>Message</th>
</tr>
<tr valign=top>
<td width=24%>0x80005000L</td>
<td width=76%><b>E_ADS_BAD_PATHNAME: </b>An invalid ADSI pathname was passed. </td>
</tr>
<tr valign=top>
<td width=24%>0x80005001L</td>
<td width=76%><b>E_ADS_INVALID_DOMAIN_OBJECT: </b>An unknown ADSI domain object was requested. </td>
</tr>
<tr valign=top>
<td width=24%>0x80005002L</td>
<td width=76%><b>E_ADS_INVALID_USER_OBJECT: </b>An unknown ADSI user object was requested.</td>
</tr>
<tr valign=top>
<td width=24%>0x80005003L</td>
<td width=76%><b>E_ADS_INVALID_COMPUTER_OBJECT: </b>An unknown ADSI computer object was requested.</td>
</tr>
<tr valign=top>
<td width=24%>0x80005004L</td>
<td width=76%><b>E_ADS_UNKNOWN_OBJECT: </b>An unknown ADSI object was requested.</td>
</tr>
<tr valign=top>
<td width=24%>0x80005005L</td>
<td width=76%><b>E_ADS_PROPERTY_NOT_SET: </b>The specified ADSI property was not set.</td>
</tr>
<tr valign=top>
<td width=24%>0x80005006L</td>
<td width=76%><b>E_ADS_PROPERTY_NOT_SUPPORTED: </b>The specified ADSI property is not supported.</td>
</tr>
<tr valign=top>
<td width=24%>0x80005007L</td>
<td width=76%><b>E_ADS_PROPERTY_INVALID: </b>The specified ADSI property is invalid.</td>
</tr>
<tr valign=top>
<td width=24%>0x80005008L</td>
<td width=76%><b>E_ADS_BAD_PARAMETER: </b>One or more input parameters are invalid.</td>
</tr>
<tr valign=top>
<td width=24%>0x80005009L</td>
<td width=76%><b>E_ADS_OBJECT_UNBOUND: </b>The specified ADSI object is not bound to a remote resource.</td>
</tr>
<tr valign=top>
<td width=24%>0x8000500AL</td>
<td width=76%><b>E_ADS_PROPERTY_NOT_MODIFIED: </b>The specified property for an ADSI object has not been modified.</td>
</tr>
<tr valign=top>
<td width=24%>0x8000500BL</td>
<td width=76%><b>E_ADS_PROPERTY_MODIFIED: </b>The specified property for an ADSI has been modified.</td>
</tr>
<tr valign=top>
<td width=24%>0x8000500CL</td>
<td width=76%><b>E_ADS_CANT_CONVERT_DATATYPE: </b>The ADSI datatype cannot be converted to or from a native DS datatype.</td>
</tr>
<tr valign=top>
<td width=24%>0x8000500DL</td>
<td width=76%><b>E_ADS_PROPERTY_NOT_FOUND: </b>The ADSI property cannot be found in the property cache.</td>
</tr>
<tr valign=top>
<td width=24%>0x8000500EL</td>
<td width=76%><b>E_ADS_OBJECT_EXISTS: </b>The ADSI object exists.</td>
</tr>
<tr valign=top>
<td width=24%>0x8000500FL</td>
<td width=76%><b>E_ADS_SCHEMA_VIOLATION: </b>The attempted action violates the DS schema rules.</td>
</tr>
<tr valign=top>
<td width=24%>0x80005010L</td>
<td width=76%><b>E_ADS_COLUMN_NOT_SET: </b>During a query, the specified column in the Active Directory was not set.</td>
</tr>
<tr valign=top>
<td width=24%>0x80005011L</td>
<td width=76%><b>S_ADS_ERRORSOCCURRED: </b>During a query, one or more errors occurred. </td>
</tr>
<tr valign=top>
<td width=24%>0x80005012L</td>
<td width=76%><b>S_ADS_NOMORE_ROWS: </b>During a query, there are no more rows to be obtained by the search result. </td>
</tr>
<tr valign=top>
<td width=24%>0x80005013L</td>
<td width=76%><b>S_ADS_NOMORE_COLUMNS: </b>During a query, there are no more columns to be obtained by the search result. </td>
</tr>
<tr valign=top>
<td width=24%>0x80005014L</td>
<td width=76%><b>E_ADS_INVALID_FILTER: </b>During a query, the specified search filter is invalid. </td>
</tr>
</table><br>
<p>
Error codes beginning with 0x8007xxxx are standard Win32® error codes. Within the Visual Basic® environment, the function <b>error(#)</b> gives you a friendly help message. Outside the Visual Basic environment, do the following. Take the last 3 digits of the error number and convert them from hex to decimal, using the Microsoft® Calculator if you choose. Type</p>
<p>
net helpmsg #</p>
<p>
where # is the decimal number. A description of the error message is then displayed. </p>
<p>
If an error code is 0x8005<i>XXXX</i>, the error is listed above and defined in adserr.h. </p>
<p>
Two common errors are 0x80004005, E_FAIL and 0x000041E4 MK_E_SYNTAX. The former is the generic COM fail message; the latter indicates the object was not found and probably indicates an error in the ADsPath name.</p>
<p>
More information can be found in adserr.h and in Platform SDK, COM and ActiveX Object Services, COM, Error Handling. Error codes returned from the ADSI OLE DB provider implementation can be found in oledberr.h.</p>
<p>
ADSI provides extended error handling so that providers may supply their own error messages and add context information to system errors. </p>
<p>
The ADSI functions <b>ADsGetLastError</b> and <b>ADsSetLastError</b> are C-language wrappers provided for applications that receive an ERROR_EXTENDED_ERROR return in response to any ADSI helper function in the <a href="ds2_func_9v04.htm"><b>ADSI Function List</b></a>. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=31%>Functions</th>
<th align=left width=69%>Value</th>
</tr>
<tr valign=top>
<td width=31%><a href="ds2_func_7yk2.htm"><b>ADsGetLastError</b></a></td>
<td width=69%>Returns the last-error code value for the calling thread. </td>
</tr>
<tr valign=top>
<td width=31%><a href="ds2_func_8che.htm"><b>ADsSetLastError</b></a></td>
<td width=69%>Sets the last-error code value for the calling thread. </td>
</tr>
</table><br>
<p>
These two functions follow the same rules as the Win32 functions <b>GetLastError</b> and <b>SetLastError </b>described in the Microsoft Platform SDK. </p>
<p>&nbsp;</p></body>
</HTML>
