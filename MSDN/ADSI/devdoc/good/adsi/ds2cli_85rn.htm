<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Directory Service Queries</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_ds_using_directory_service_queries"></a>Using Directory Service Queries</h2>
<p>
Querying a directory service using ADSI is similar to querying a database. Because the potential amount of information to be searched could be millions of data elements (or more), a good query strategy allows you to limit your search in various ways. ADSI uses the following concepts in defining a search:
<dl>
<dt>
<b>Base DN</b></dt>
<dd>
The root node of a search. The base DN (distinguished name) must be a fully qualified name in the form: "WinNT://MyDomain/MyServer/User" or "WinNT://MyDomain/MyServer/MyPrintQueue". (DNs are not case sensitive. The use of capital letters in the preceding examples is for clarity only.)</dd>
<dt>
<b>Filter</b></dt>
<dd>
A string that specifies the criteria to be met by the objects to be returned in a query. This string is in LDAP search filter format, as described in RFC 1960. More information about this can be found in the document ftp://ds.internic.net/rfc/rfc1960.txt. For more information on using a search filter, see <a href="ds2cli_9tpu.htm"><b>Using a Search Filter</b></a>. </dd>
<dt>
<b>Attribute or Property List</b></dt>
<dd>
Identifying those attributes of interest allows the search to ignore all other attributes of the object. </dd>
<dt>
<b>Scope</b></dt>
<dd>
In a directory hierarchy, you need to choose the beginning entry of the search and decide if you want to search recursively through all branches of that node. Scope is one of the values "Base", "OneLevel", or "SubTree", which are defined in <a href="ds2_con_4bqr.htm"><b>ADS_SCOPE_* constants</b></a>. </dd>
<dt>
<b>Preference</b></dt>
<dd>
Search preference includes other ways to limit a query. A search preference set allows you to indicate limits such as the size of the query result, time limits, whether or not to dereference aliases during the search, whether to use secure authentication and other limits.
</dd>
</dl>
<p>
To use ADSI to query a directory service, you can use <a href="ds2_if_5qco.htm"><b>IDirectorySearch</b></a> or the ADSI OLE DB provider. For more information, see <a href="ds2cli_72gj.htm"><b>Using the ADSI OLE DB Provider for Searches</b></a> or <a href="ds2cli_3tnr.htm"><b>Using IDirectorySearch for Querying</b></a>. </p>
<p>&nbsp;</p></body>
</HTML>
