<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Security Descriptor Object</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_ds_creating_a_security_descriptor_object"></a>Creating a Security Descriptor Object</h3>

<p>
<a name="_ds_how_to_create_a_security_descriptor_object"></a>The following Visual Basic example shows how to create a security descriptor object for an ADSI object.</p>
<pre><code>' Assume you have the credentials to create objects
Dim MyObject As IADs
Dim MySecDes As IADsSecurityDescriptor
Dim Var As Variant
Dim SecDes As New SecurityDescriptor
Dim Dacl As New AccessControlList
Dim Ace As New AccessControlEntry
 
'Create an Access Control Entry (ACE) for Group objects at Microsoft
'     on an LDAP namespace. 
Ace.AccessMask = 0
Ace.AceType = 1
Ace.AceFlags = 1
Ace.Trustee = "cn=Groups,o=Microsoft"
 
' Add the newly created ACE object as the only ACE 
'     in a new Access Control List (ACL)
Dacl.AceCount = 1
Dacl.AclRevision = 4
Dacl.AddAce Ace
 
' Use this ACL as the discretionary ACL (DACL) for
'     this Security Descriptor object and use
'     this DACL instead of the default. 
SecDes.Revision = 1
SecDes.OwnerDefaulted = True
SecDes.GroupDefaulted = True
SecDes.DaclDefaulted = False
SecDes.SaclDefaulted = True
SecDes.DiscretionaryAcl = Dacl
' Attach <b> </b>this security descriptor
'     to the ADSI object
MyObject.Put "ntSecurityDescriptor", SecDes
' Commit the changes to the underlying DS
MyObject.SetInfo
' Read the properties back in to the property cache
MyObject.GetInfo
' Retrieve the SecurityDescriptor object
Set MySecDes = MyObject.Get("ntSecurityDescriptor")
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
