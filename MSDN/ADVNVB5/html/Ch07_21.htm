<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Beware of Boolean coercion weirdness</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="2">
<h1><a name="bewareofbooleancoercionweirdness"></a>Beware of Boolean coercion weirdness</h1>
<p>
The final issue with <i>Debug.Assert</i> is Boolean type coercion. Later in this chapter, we’ll look at Visual Basic’s automatic type coercion rules and where they can lay nasty traps for you. For now, you can be content with studying the following little enigma:</p>
<pre><code>Dim nTest As Integer
nTest = 50
Debug.Assert nTest
Debug.Assert Not nTest</code></pre>
<p>
You will find that neither of these assertions fire! Strange, but true. The reason has to do with Visual Basic coercing the integer to a Boolean. The first assertion says that <i>nTest = 50</i>, which, because nTest is nonzero, is evaluated to TRUE. The second assertion calculates <i>Not nTest</i> to be -51, which is also nonzero and again evaluated to TRUE.</p>
<p>
However, if you compare <i>nTest</i> and <i>Not nTest</i> to the actual value of TRUE (which is -1) as in the following code, only the first assertion fires:</p>
<pre><code>Debug.Assert nTest = True
Debug.Assert Not nTest = True</code></pre>
<p>
<b>Some Final Thoughts</b> <i>Debug.Assert</i> is a very powerful tool for bug detection. Used properly, it can catch many bugs automatically, without any human intervention. (See the discussion of an Assertion Sourcerer on page 314 for a utility that supplements <i>Debug.Assert</i>.)</p>
<h1></h1>
</BODY>
</HTML>
