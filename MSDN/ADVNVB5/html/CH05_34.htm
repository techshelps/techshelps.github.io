<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>A New Style of Coding</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="2">
<h1><a name="anewstyleofcoding"></a>A New Style of Coding</h1>
<p>
I have extolled the virtues of using Variants and the flexibility that they give. To be more precise, they allow the <i>interface</i> to be flexible. By declaring the number of biscuits to be a Variant, you make it unlikely that the data type of that parameter will need to be modified again.</p>
<p>
This flexibility of Variants has a cost to it. What happens if we call the function with an input that does not make sense?</p>
<pre><code>N = EatBiscuits("Ugh")</code></pre>
<p>
Inside the function, we are expecting a number—so what will it make of this? You must assert your preconditions for the function to work. If, as is the case here, the input must be numeric, be sure that this is the case:</p>
<pre><code>Function EatBiscuits(ByVal input As Variant) As Variant
    If IsNumeric(input) Then
        ' Do stuff...
    Else
        ' Return error.
    End If
End Function</code></pre>
<p>
You might think about using <i>Debug.Assert </i>in this instance, but it is no help at run time because all the calls to the <i>Assert</i> method are stripped out in compilation. So you would still need to implement your own checks anyway.</p>
<p>
To use Variants safely, you need to modify your coding style to this more defensive style. If you do this, you can take advantage of their flexibility and write robust code at the same time.</p>
<h1></h1>
</BODY>
</HTML>
