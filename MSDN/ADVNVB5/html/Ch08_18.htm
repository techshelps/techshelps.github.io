<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>"Borrowing" Code</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="2">
<h1><a name="borrowingcode"></a>“Borrowing” Code</h1>
<p>
Steal code whenever possible. Why write the code yourself if you can source it from elsewhere? Have you checked out MSDN and all the sample code it provides for an answer? The samples in particular contain some great (and some not so great) pieces of code. Unfortunately, some programmers have never discovered the VisData sample (VB\samples\VisData) let alone looked through its source code. Let’s see if I can tempt you to browse this valuable resource. VISDATA.BAS contains the following routines. Could they be useful?</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=296><i>ActionQueryType</i></td>
<td width=296><i>MsgBar</i></td>
</tr>
<tr valign=top>
<td width=296><i>AddBrackets</i></td>
<td width=296><i>NewLocalISAM</i></td>
</tr>
<tr valign=top>
<td width=296><i>AddMRU</i></td>
<td width=296><i>NewMDB</i></td>
</tr>
<tr valign=top>
<td width=296><i>CheckTransPending</i></td>
<td width=296><i>ObjectExists</i></td>
</tr>
<tr valign=top>
<td width=296><i>ClearDataFields</i></td>
<td width=296><i>OpenLocalDB</i></td>
</tr>
<tr valign=top>
<td width=296><i>CloseAllRecordsets</i></td>
<td width=296><i>OpenQuery</i></td>
</tr>
<tr valign=top>
<td width=296><i>CloseCurrentDB</i></td>
<td width=296><i>OpenTable</i></td>
</tr>
<tr valign=top>
<td width=296><i>CompactDB</i></td>
<td width=296><i>RefreshErrors</i></td>
</tr>
<tr valign=top>
<td width=296><i>CopyData</i></td>
<td width=296><i>RefreshTables</i></td>
</tr>
<tr valign=top>
<td width=296><i>CopyStruct</i></td>
<td width=296><i>SaveINISettings</i></td>
</tr>
<tr valign=top>
<td width=296><i>DisplayCurrentRecord</i></td>
<td width=296><i>SetFldProperties</i></td>
</tr>
<tr valign=top>
<td width=296><i>DupeTableName</i></td>
<td width=296><i>SetQDFParams</i></td>
</tr>
<tr valign=top>
<td width=296><i>Export</i></td>
<td width=296><i>ShowDBTools</i></td>
</tr>
<tr valign=top>
<td width=296><i>GetFieldType</i></td>
<td width=296><i>ShowError</i></td>
</tr>
<tr valign=top>
<td width=296><i>GetFieldWidth</i></td>
<td width=296><i>ShutDownVisData</i></td>
</tr>
<tr valign=top>
<td width=296><i>GetINIString</i></td>
<td width=296><i>StripBrackets</i></td>
</tr>
<tr valign=top>
<td width=296><i>GetODBCConnectParts</i></td>
<td width=296><i>StripConnect</i></td>
</tr>
<tr valign=top>
<td width=296><i>GetTableList</i></td>
<td width=296><i>StripFileName</i></td>
</tr>
<tr valign=top>
<td width=296><i>HideDBTools</i></td>
<td width=296><i>StripNonAscii</i></td>
</tr>
<tr valign=top>
<td width=296><i>Import</i></td>
<td width=296><i>StripOwner</i></td>
</tr>
<tr valign=top>
<td width=296><i>ListItemNames</i></td>
<td width=296><i>stTrueFalse</i></td>
</tr>
<tr valign=top>
<td width=296><i>LoadINISettings</i></td>
<td width=296><i>UnloadAllForms</i></td>
</tr>
<tr valign=top>
<td width=296><i>MakeTableName</i></td>
<td width=296><i>vFieldVal</i></td>
</tr>
</table><br>
<p>
There’s more! The BAS files in the SETUP1 project (VB\setupKit\setup1) contain these routines anything useful in here?</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=296><i>AbortAction</i></td>
<td width=296><i>DllEnableLogging</i></td>
</tr>
<tr valign=top>
<td width=296><i>AddActionNote</i></td>
<td width=296><i>DllLogError</i></td>
</tr>
<tr valign=top>
<td width=296><i>AddDirSep</i></td>
<td width=296><i>DllLogNote</i></td>
</tr>
<tr valign=top>
<td width=296><i>AddHkeyToCache</i></td>
<td width=296><i>DllLogWarning</i></td>
</tr>
<tr valign=top>
<td width=296><i>AddPerAppPath</i></td>
<td width=296><i>DllNewAction</i></td>
</tr>
<tr valign=top>
<td width=296><i>AddQuotesToFN</i></td>
<td width=296><i>DLLSelfRegister</i></td>
</tr>
<tr valign=top>
<td width=296><i>AddURLDirSep</i></td>
<td width=296><i>EnableLogging</i></td>
</tr>
<tr valign=top>
<td width=296><i>AllocUnit</i></td>
<td width=296><i>EtchedLine</i></td>
</tr>
<tr valign=top>
<td width=296><i>CalcDiskSpace</i></td>
<td width=296><i>ExeSelfRegister</i></td>
</tr>
<tr valign=top>
<td width=296><i>CalcFinalSize</i></td>
<td width=296><i>ExitSetup</i></td>
</tr>
<tr valign=top>
<td width=296><i>CenterForm</i></td>
<td width=296><i>Extension</i></td>
</tr>
<tr valign=top>
<td width=296><i>ChangeActionKey</i></td>
<td width=296><i>fCheckFNLength</i></td>
</tr>
<tr valign=top>
<td width=296><i>CheckDiskSpace</i></td>
<td width=296><i>fCreateOSProgramGroup</i></td>
</tr>
<tr valign=top>
<td width=296><i>CheckDrive</i></td>
<td width=296><i>fCreateShellGroup</i></td>
</tr>
<tr valign=top>
<td width=296><i>CheckOverwritePrivateFile</i></td>
<td width=296><i>fDllWithinAction</i></td>
</tr>
<tr valign=top>
<td width=296><i>CommitAction</i></td>
<td width=296><i>FileExists</i></td>
</tr>
<tr valign=top>
<td width=296><i>ConcatSplitFile</i></td>
<td width=296><i>fIsDepFile</i></td>
</tr>
<tr valign=top>
<td width=296><i>CopyFile</i></td>
<td width=296><i>fNTWithShell</i></td>
</tr>
<tr valign=top>
<td width=296><i>CopySection</i></td>
<td width=296><i>FSyncShell</i></td>
</tr>
<tr valign=top>
<td width=296><i>CountIcons</i></td>
<td width=296><i>fValidFilename</i></td>
</tr>
<tr valign=top>
<td width=296><i>CreateIcons</i></td>
<td width=296><i>fValidNTGroupName</i></td>
</tr>
<tr valign=top>
<td width=296><i>CreateOSLink</i></td>
<td width=296><i>fWithinAction</i></td>
</tr>
<tr valign=top>
<td width=296><i>CreateProgManGroup</i></td>
<td width=296><i>GetAppRemovalCmdLine</i></td>
</tr>
<tr valign=top>
<td width=296><i>CreateProgManItem</i></td>
<td width=296><i>GetClsidFromActXFile</i></td>
</tr>
<tr valign=top>
<td width=296><i>CreateShellLink</i></td>
<td width=296><i>GetDefMsgBoxButton</i></td>
</tr>
<tr valign=top>
<td width=296><i>DecideIncrementRefCount</i></td>
<td width=296><i>GetDepFileVerStruct</i></td>
</tr>
<tr valign=top>
<td width=296><i>DetectFile</i></td>
<td width=296><i>GetDiskSpaceFree</i></td>
</tr>
<tr valign=top>
<td width=296><i>DirExists</i></td>
<td width=296><i>GetDrivesAllocUnit</i></td>
</tr>
<tr valign=top>
<td width=296><i>DisableLogging</i></td>
<td width=296><i>GetDriveType</i></td>
</tr>
<tr valign=top>
<td width=296><i>DiskSpaceFree</i></td>
<td width=296><i>GetFileName</i></td>
</tr>
<tr valign=top>
<td width=296><i>DllAbortAction</i></td>
<td width=296><i>GetFileSize</i></td>
</tr>
<tr valign=top>
<td width=296><i>DllAddActionNote</i></td>
<td width=296><i>GetFileVersion</i></td>
</tr>
<tr valign=top>
<td width=296><i>DllChangeActionKey</i></td>
<td width=296><i>GetFileVerStruct</i></td>
</tr>
<tr valign=top>
<td width=296><i>DllCommitAction</i></td>
<td width=296><i>GetLicInfoFromVBL</i></td>
</tr>
<tr valign=top>
<td width=296><i>DllDisableLogging</i></td>
<td width=296><i>GetLongPathName</i></td>
</tr>
</table><br>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows><i>
<tr valign=top>
<td width=296><i>GetPathName</i></td>
<td width=296><i>PackVerInfo</i></td>
</tr>
<tr valign=top>
<td width=296><i>GetRemoteSupportFileVerStruct</i></td>
<td width=296><i>ParseDateTime</i></td>
</tr>
<tr valign=top>
<td width=296><i>GetShortPathName</i></td>
<td width=296><i>PerformDDE</i></td>
</tr>
<tr valign=top>
<td width=296><i>GetTempFilename</i></td>
<td width=296><i>ProcessCommandLine</i></td>
</tr>
<tr valign=top>
<td width=296><i>GetUNCShareName</i></td>
<td width=296><i>PromptForNextDisk</i></td>
</tr>
<tr valign=top>
<td width=296><i>GetWindowsDir</i></td>
<td width=296><i>ReadIniFile</i></td>
</tr>
<tr valign=top>
<td width=296><i>GetWindowsSysDir</i></td>
<td width=296><i>ReadProtocols</i></td>
</tr>
<tr valign=top>
<td width=296><i>GetWinPlatform</i></td>
<td width=296><i>ReadSetupFileLine</i></td>
</tr>
<tr valign=top>
<td width=296><i>IncrementRefCount</i></td>
<td width=296><i>ReadSetupRemoteLine</i></td>
</tr>
<tr valign=top>
<td width=296><i>InitDiskInfo</i></td>
<td width=296><i>RegCloseKey</i></td>
</tr>
<tr valign=top>
<td width=296><i>intGetHKEYIndex</i></td>
<td width=296><i>RegCreateKey</i></td>
</tr>
<tr valign=top>
<td width=296><i>intGetNextFldOffset</i></td>
<td width=296><i>RegDeleteKey</i></td>
</tr>
<tr valign=top>
<td width=296><i>IsDisplayNameUnique</i></td>
<td width=296><i>RegEdit</i></td>
</tr>
<tr valign=top>
<td width=296><i>IsNewerVer</i></td>
<td width=296><i>RegEnumKey</i></td>
</tr>
<tr valign=top>
<td width=296><i>IsUNCName</i></td>
<td width=296><i>RegisterAppRemovalEXE</i></td>
</tr>
<tr valign=top>
<td width=296><i>IsValidDestDir</i></td>
<td width=296><i>RegisterDAO</i></td>
</tr>
<tr valign=top>
<td width=296><i>IsWin32</i></td>
<td width=296><i>RegisterFiles</i></td>
</tr>
<tr valign=top>
<td width=296><i>IsWindows95</i></td>
<td width=296><i>RegisterLicense</i></td>
</tr>
<tr valign=top>
<td width=296><i>IsWindowsNT</i></td>
<td width=296><i>RegisterLicenses</i></td>
</tr>
<tr valign=top>
<td width=296><i>IsWindowsNT4WithoutSP2</i></td>
<td width=296><i>RegisterTLB</i></td>
</tr>
<tr valign=top>
<td width=296><i>lmemcpy</i></td>
<td width=296><i>RegisterVBLFile</i></td>
</tr>
<tr valign=top>
<td width=296><i>LogError</i></td>
<td width=296><i>RegOpenKey</i></td>
</tr>
<tr valign=top>
<td width=296><i>LogNote</i></td>
<td width=296><i>RegPathWinCurrentVersion</i></td>
</tr>
<tr valign=top>
<td width=296><i>LogSilentMsg</i></td>
<td width=296><i>RegPathWinPrograms</i></td>
</tr>
<tr valign=top>
<td width=296><i>LogSMSMsg</i></td>
<td width=296><i>RegQueryNumericValue</i></td>
</tr>
<tr valign=top>
<td width=296><i>LogWarning</i></td>
<td width=296><i>RegQueryRefCount</i></td>
</tr>
<tr valign=top>
<td width=296><i>MakePath</i></td>
<td width=296><i>RegQueryStringValue</i></td>
</tr>
<tr valign=top>
<td width=296><i>MakePathAux</i></td>
<td width=296><i>RegSetNumericValue</i></td>
</tr>
<tr valign=top>
<td width=296><i>MoveAppRemovalFiles</i></td>
<td width=296><i>RegSetStringValue</i></td>
</tr>
<tr valign=top>
<td width=296><i>MsgError</i></td>
<td width=296><i>RemoteRegister</i></td>
</tr>
<tr valign=top>
<td width=296><i>MsgFunc</i></td>
<td width=296><i>RemoveShellLink</i></td>
</tr>
<tr valign=top>
<td width=296><i>MsgWarning</i></td>
<td width=296><i>ReplaceDoubleQuotes</i></td>
</tr>
<tr valign=top>
<td width=296><i>NewAction</i></td>
<td width=296><i>ResolveDestDir</i></td>
</tr>
<tr valign=top>
<td width=296><i>OpenConcatFile</i></td>
<td width=296><i>ResolveDestDirs</i></td>
</tr>
<tr valign=top>
<td width=296><i>OSfCreateShellGroup</i></td>
<td width=296><i>ResolveDir</i></td>
</tr>
<tr valign=top>
<td width=296><i>OSfCreateShellLink</i></td>
<td width=296><i>ResolveResString</i></td>
</tr>
<tr valign=top>
<td width=296><i>OSfRemoveShellLink</i></td>
<td width=296><i>RestoreProgMan</i></td>
</tr>
<tr valign=top>
<td width=296><i>OSGetLongPathName</i></td>
<td width=296><i>SetFileDateTime</i></td>
</tr>
</i></table><br>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=296><i>SetFormFont</i></td>
<td width=296><i>strGetPredefinedHKEYString</i></td>
</tr>
<tr valign=top>
<td width=296><i>SetMousePtr</i></td>
<td width=296><i>strGetProgramsFilesPath</i></td>
</tr>
<tr valign=top>
<td width=296><i>SetTime</i></td>
<td width=296><i>StripTerminator</i></td>
</tr>
<tr valign=top>
<td width=296><i>ShowLoggingError</i></td>
<td width=296><i>strQuoteString</i></td>
</tr>
<tr valign=top>
<td width=296><i>ShowPathDialog</i></td>
<td width=296><i>strRootDrive</i></td>
</tr>
<tr valign=top>
<td width=296><i>SrcFileMissing</i></td>
<td width=296><i>strUnQuoteString</i></td>
</tr>
<tr valign=top>
<td width=296><i>strExtractFilenameArg</i></td>
<td width=296><i>TreatAsWin95</i></td>
</tr>
<tr valign=top>
<td width=296><i>strExtractFilenameItem</i></td>
<td width=296><i>UCase16</i></td>
</tr>
<tr valign=top>
<td width=296><i>strGetCommonFilesPath</i></td>
<td width=296><i>UpdateStatus</i></td>
</tr>
<tr valign=top>
<td width=296><i>StrGetDAOPath</i></td>
<td width=296><i>WriteAccess</i></td>
</tr>
<tr valign=top>
<td width=296><i>strGetDriveFromPath</i></td>
<td width=296><i>WriteMIF</i></td>
</tr>
<tr valign=top>
<td width=296><i>strGetHKEYString</i></td>
<td width=296><i></i></td>
</tr>
</table><br>
<p>
VB5STKIT.DLL, which contains some of the routines in the preceding list, is used by SETUP1.EXE, which the setup wizard includes for you on your distribution disks. It seems reasonable to me, then, to include it in your list of dependencies so that it gets installed on your customer’s machine. (It’s actually in the bootstrap, so it gets copied across anyway.) This all means that you can use the routines in this DLL in your own applications. (Keep in mind, however, that they’re documented only through their use in the SETUP1 source.)</p>
<h1></h1>
</BODY>
</HTML>
