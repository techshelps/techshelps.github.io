<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Validation and Protection</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="2">
<h1><a name="validationprotection"></a>Validation and Protection</h1>
<p>
Property <i>Let</i>/<i>Get</i> allows you to validate the property in a way that would not be possible with a UDT. In this example, we have a property that can have a discrete set of values. The traffic light can be red, green, or yellow. The constants are defined using an <i>Enum</i>, but this is not sufficient to ensure that the traffic light values fall into this range. You can perform the validation using a Property <i>Let</i> instead.</p>
<pre><code>Public Enum TrafficLight
    RedLight
    GreenLight
    YellowLight
End Enum</code></pre>
<h2>Class TLight</h2>
<pre><code>Private m_TopLight As TrafficLight
Public Property Let TopLight(newValue As TrafficLight)
    ' You can validate the assignment to TopLight.
    ' Note that Enum will NOT do any checking for you.
    Select Case newValue
        Case RedLight, GreenLight, YellowLight
            m_TopLight = newValue
        Case Else
            ' Raise type mismatch.
            Err.Raise 13
        End Select
End Property
Public Property Get TopLight() As TrafficLight
    TopLight = m_TopLight
End Property</code></pre>
<p>
With the following code, only the last line will generate an error:</p>
<pre><code>Dim tl As New TLight
Dim col As TrafficLight
   
 col = RedLight
tl.TopLight = col
    
' Enums do not validate...
col = 1234     ' This works.
' ...but classes do validate.
tl.TopLight = col ' This gets an error.</code></pre>
<h1></h1>
</BODY>
</HTML>
