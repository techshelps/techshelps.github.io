<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>StateChanged Event</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="2">
<h1><i><a name="statechangedevent"></a>StateChanged</i> Event</h1>
<p>
After a command has been sent to a remote computer by means of the <i>Execute </i>method, any response from the remote computer is via the <i>StateChanged </i>event. The <i>StateChanged </i>event indicates what action the remote computer has performed via the <i>State</i> event parameter.</p>
<pre><code>Private Sub icMain_StateChanged(ByVal State As Integer)</code></pre>
<p>
Depending on the value of the <i>State</i> variable, your application can perform tasks such as displaying status messages, updating progress meters, and handling any error information that comes back from the remote computer.</p>
<p>
Most of the actions that the <i>StateChanged </i>event indicates via the <i>State </i>variable are simple status messages. In most messages, those actions can be ignored by your program. All of the values for the <i>StateChanged </i>status variable are defined in the Internet Transfer Control online help.</p>
<p>
The actions indicating that data is present to be retrieved from the remote computer are <i>icResponseReceived </i>and <i>icResponseCompleted</i>. The <i>icResponseReceived </i>state indicates that data has been returned from the remote computer but the command is still executing. The <i>icResponseCompleted </i>state occurs after the entire command has completed. In practice, the <i>icResponseCompleted </i>command is used to initiate any pending data transfer.</p>
<p>
Triggering of the <i>StateChanged </i>event does <i>not</i> mean that any information has been transferred from the remote computer to the Internet Transfer Control. It simply indicates that data is ready to be transferred. The actual transfer of the data is performed by using the <i>GetChunk </i>method, which is covered later in this chapter.</p>
<p>
The <i>icResponseReceived </i>state also occurs when the action does not involve any data being returned. When you’re in the process of connecting to a remote computer, certain information is received from the remote computer as part of the connection process. These <i>icResponseReceived </i>states do not result in any data being ready to be transferred.</p>
<p>
The <i>icResponseComplete </i>state indicates that the operation is finished. If the operation was an FTP <i>send</i>,<i> </i>the <i>icResponseCompleted </i>state will indicate that the file has been transferred to the remote computer.</p>
<p>
The other important state that can be returned is <i>icError</i>. In this case, the properties <i>ResponseCode</i> and <i>ResponseInfo</i> will contain further information about the error that has occurred.</p>
<h1></h1>
</BODY>
</HTML>
