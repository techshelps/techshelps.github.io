<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Useful Stored Procedures</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="2">
<h1><a name="usefulstoredprocedures"></a>Useful Stored Procedures</h1>
<p>
Several stored procedures are available for you to use in maintaining user groups and permissions. Some of them will return useful information, for example, sp_helpgroup, which lists all of the groups in your database or all of the users in a particular group. Sometimes, however, no stored procedure is available that will return the specific information you require. There’s no stored procedure, for example, for listing logins that don’t have user names in your database. For these cases, I’ve provided an SQL SELECT statement that should do the job. My goal was to build a simple form (see Figure 12-4) that you could incorporate into your application to manage the database security. Assuming you’ve analyzed the user roles for the database, created the appropriate groups for these roles, and assigned permissions to the groups, the only day-to-day maintenance you’ll have to do is add and delete users and assign users to groups.</p>
<p>
<img src="f12rf04.gif" border=0></p>
<p class=blue>
<b>Figure 12-4  Simple administration using drag and drop </b></p>
<p>
The form you incorporated into your application will have a ListView control that shows all logins in the database that don’t have a user name. These logins can be dragged and dropped into a TreeView control that shows all of the groups and the users in the groups. Users can also be dragged and dropped between the groups in the TreeView control or dragged back to the ListView control to revoke their access to the database.</p>
<h1></h1>
</BODY>
</HTML>
