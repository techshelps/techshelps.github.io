<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Retrieving the Contents of a Directory</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="2">
<h1><a name="retrievingcontentsofdirectory"></a>Retrieving the Contents of a Directory</h1>
<p>
If the URL you have specified is not a file but a directory, the data returned by <i>OpenURL </i>will be the contents of the directory. For instance, requesting <i>http:<br>
//www.mycompany.com/files/</i> or <i>ftp://ftp.mycompany.com/files</i> will return the contents of the files directory.</p>
<p>
The format of the returned directory is determined by the protocol of the transfer. In both of the preceding cases, the directory is returned in HTML format. For an HTTP transfer, the directory will be bare-bones HTML, simply listing the directory’s contents. An FTP transfer will return the directory structure with additional FTP server information such as welcome messages.</p>
<p>
In practice, this means that you can’t just grab the real contents of a directory structure using <i>OpenURL</i>. Any data that is returned as a directory listing is wrapped in all the HTML formatting codes. If you want to display the directory entries—say, in a text box—you’ll have to parse the returned text for the individual directory entries.</p>
<p>
It seems strange that an FTP operation will return results in HTML, but it does. An alternative to retrieving the HTML-wrapped directory entries from an FTP or HTTP server is the use of the <i>Execute </i>method of the Internet Transfer Control, as described later in this chapter.</p>
<p class=blue>
<b>Styles of Directory Structure Returned by <i>OpenURL</i></b></p>
<p class=indent>
Two types of directory content are returned by the <i>OpenURL </i>call: HTTP style and FTP style. In both cases, extra processing of the returned text is required to strip away the extraneous HTML information and retrieve the actual directory names.</p>
<p class=blue>
<b>HTTP Style</b></p>
<pre><code>&lt;head&gt;
&lt;title&gt;/test1/ - &lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;H1&gt;/test1/ - &lt;/H1&gt;
&lt;hr&gt;
&lt;pre&gt;  21/01/97    22:19            5
&lt;A HREF="/test1/hello.txt"&gt;hello.txt&lt;/A&gt;&lt;br&gt;&lt;/body&gt;</code></pre>
<p class=blue>
<b>FTP Style</b></p>
<pre><code>&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;FTP root at www.mycompany.com&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;H2&gt;FTP root at www.mycompany.com&lt;/H2&gt;
&lt;HR&gt;
&lt;H4&gt;&lt;PRE&gt;
Windows 95 FTP Service.
&lt;/PRE&gt;&lt;/H4&gt;
&lt;HR&gt;
&lt;PRE&gt;
07/02/96 06:31             43 &lt;A HREF="/~FTPSVC~.CKM"&gt;~FTPSVC~.CKM&lt;/A&gt;
01/08/97 08:04             15 &lt;A HREF="/hello.txt"&gt;hello.txt&lt;/A&gt;
&lt;/PRE&gt;
&lt;HR&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;</code></pre>
<p class=indent>
Notice the extra information provided by the FTP server (in this case, Microsoft Personal Web Server), such as FTP server name (“www.mycompany.com”) and welcome message “Windows 95 FTP Service.”</p>
<h1></h1>
</BODY>
</HTML>
