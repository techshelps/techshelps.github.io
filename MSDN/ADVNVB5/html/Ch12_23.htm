<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a new user</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="2">
<h1><a name="creatingnewuser"></a>Creating a new user</h1>
<p>
The sp_adduser stored procedure shown below can be run by the database owner or anyone else who has been given an alias as the database owner. The syntax allows you to specify a user name other than the login name, but I can’t find anything to recommend your doing so. You also get to specify a group to which this user will belong. If you don’t specify a group, the user will belong only to public. Remember, all users are members of public, although each user can also be a member of one other group.</p>
<pre><code>sp_adduser&nbsp;login_id&nbsp;[,&nbsp;username&nbsp;[,&nbsp;groupname]]</code></pre>
<p>
This stored procedure doesn’t return any results, so you will execute it differently, as shown here:</p>
<pre><code>Private&nbsp;Sub&nbsp;AddUser(ByVal&nbsp;strLogin&nbsp;As&nbsp;String,&nbsp;_
&nbsp;&nbsp;&nbsp;&nbsp;ByVal&nbsp;strGroup&nbsp;As&nbsp;String)
&nbsp;&nbsp;&nbsp;&nbsp;Static&nbsp;qryAddUser&nbsp;As&nbsp;rdoQuery

&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;qryAddUser&nbsp;Is&nbsp;Nothing&nbsp;Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set&nbsp;qryAddUser&nbsp;=&nbsp;conPiConnection.CreateQuery("AddUser",&nbsp;_
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"sp_adduser&nbsp;?,&nbsp;?,&nbsp;?")
&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If

&nbsp;&nbsp;&nbsp;&nbsp;qryAddUser.rdoParameters(0)&nbsp;=&nbsp;strLogin&nbsp;'&nbsp;Login&nbsp;ID
&nbsp;&nbsp;&nbsp;&nbsp;qryAddUser.rdoParameters(1)&nbsp;=&nbsp;strLogin&nbsp;'&nbsp;User&nbsp;name
&nbsp;&nbsp;&nbsp;&nbsp;qryAddUser.rdoParameters(2)&nbsp;=&nbsp;strGroup&nbsp;'&nbsp;Groupname

&nbsp;&nbsp;&nbsp;&nbsp;qryAddUser.Execute
End&nbsp;Sub</code></pre>
<p>
Here we are creating a parameter query, setting the parameters, and executing the query. Parameters can be input or output parameters (or both). But the default direction is input, so we don’t have to explicitly specify the direction. The next time we need to execute the query, we will already have it and will only have to set the parameters and execute it. This shortens the execution time considerably.</p>
<h1></h1>
</BODY>
</HTML>
