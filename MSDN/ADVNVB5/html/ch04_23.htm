<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Technical Details</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>
<FONT FACE="Verdana,Arial,Helvetica" SIZE="2">
<h1><a name="technicaldetails"></a>Technical Details</h1>
<p>
Let’s have a look at some of the technical details of the <i>OpenURL </i>example. The code that does the transfer is quite simple. The only thing that needs special attention is writing the received file to disk. The core transfer routine is as follows. The database recordset containing site information is named <i>m_rstSites</i>.</p>
<pre><code>Do Until m_rstSites.EOF

    ' Get file information.
    sURL = m_rstSites("URL")
    sFile = m_rstSites("SaveAs")

    ' Retrieve file as byte array.
    bFile() = icMain.OpenURL(sURL, icByteArray)

    ' Delete any previously existing files.
    If Dir$(sFile) &lt;&gt; "" Then
        Kill sFile
    End If

' Try to open file.
    iFileHandle = FreeFile
    Open sFile For Binary Access Write As iFileHandle

    Put iFileHandle, , bFile()
    Close iFileHandle

    m_rstSites.MoveNext

Loop</code></pre>
<h1></h1>
</BODY>
</HTML>
