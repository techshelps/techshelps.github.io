<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating the Directory Object</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_creating_the_directory_object"></a>Creating the Directory Object</h2>
<p>
Your <a href="glossary_1ooj.htm#_edk_server_application">server application</a> needs to be recognized by other programs such as the <a href="glossary_1ood.htm#_edk_microsoft_exchange_server_administrator_program">Microsoft Exchange Server Administrator program</a>. Therefore, the setup program must create a new <a href="glossary_1oof.htm#_edk_object">object</a> for your application in the Microsoft Exchange Server <a href="glossary_1oo4.htm#_edk_directory">directory</a> and provide initial object attribute values. The setup program can set most of these values as defaults, while others (such as the server name) can be specified by the user through a setup dialog box. When you add a new Mail-Gateway object or a new Mailbox-Agent object to the directory, an associated <a href="glossary_1ood.htm#_edk_mailbox">mailbox</a> and <a href="glossary_1oo6.htm#_edk_folder">folder</a> hierarchy is created in the <a href="glossary_1oo9.htm#_edk_information_store">information store</a>. </p>
<p>
To create the object that represents the application in the directory, your setup program calls the <a href="function_1v1w.htm"><b>BatchImport</b></a> and <a href="function_1q79.htm"><b>DAPIWrite</b></a> functions. The setup program also uses these functions to set the object's attribute values. <a href="glossary_1oo4.htm#_edk_directory_access_functions">Directory access functions</a> are described in <a href="directry_6qyb.htm">Directory Operations</a>.</p>
<p>
To know how to import a directory object, the setup program first gathers configuration information by reading default data from the application's header files and using default values that correspond to the type of application being installed. It also copies <a href="glossary_1oo5.htm#_edk_extension_data">extension data</a> from the extension data file on the distribution medium. For more information about extension data, see <a href="setups_59b9.htm">Initializing the Extension-Data Attribute</a>.</p>
<p>
The setup program presents dialog boxes to the administrator for entering attribute values. For example, a gateway's setup program would prompt the administrator for the address space serviced by the gateway. For an example of code that prompts administrators for information, see the <b>ShowInstallDlg</b> function call in GWSETUP.C. It requests, for example, a display name to use for the application being installed. </p>
<p>&nbsp;</p></body>
</HTML>
