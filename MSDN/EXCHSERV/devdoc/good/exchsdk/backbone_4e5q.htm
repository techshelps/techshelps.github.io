<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Encapsulation</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_gdk_encapsulation"></a>Encapsulation</h2>
<p>
A gateway can handle the transfer of Microsoft Exchange Server special properties across a backbone by encapsulating the message so that these properties pass through the <a href="gwgloss_0vfq.htm#_gdk_foreign_system">foreign system</a> and remain intact at its destination. Microsoft Exchange Server encapsulates message parts by encoding them in TNEF. For more information, see <a href="msgxfer_01x0.htm">Transport Neutral Encoding Format</a>.</p>
<p>
The gateway should determine which recipients of the message are MAPI-Recipients, and then encapsulate MAPI message parts for transfer to those recipients. The gateway maps the message to the foreign system’s format and stores the message’s content in a TNEF encapsulated attachment in the foreign system’s attachment format.</p>
<p>
The following figure shows how addresses and message content are backboned using encapsulation.</p>
<p>
<img src="images/gpg06_06.gif" border=0></p>
<p>
<b>Encapsulating a message for backboning</b></p>
<p>
The <a href="gwgloss_0vfx.htm#_gdk_message_transfer_envelope_mte_">message transfer envelope (MTE)</a> contains information that is necessary for a message to pass through the foreign system. Envelope information must be preserved during the backboning process so a backboned message can be delivered intact to the destination Microsoft Exchange Server system by the receiving gateway.</p>
<p>
Your gateway can encapsulate message attachments in two ways:
<ul>
<li>
The message text and its attachments can be encapsulated as a single TNEF attachment in the backboned message. The sample gateway provided with this SDK performs this type of encapsulation. It is illustrated in the preceding diagram.</li>
<li>
The message text and its attachments can be encapsulated separately and tags can be placed inside the message text to indicate where the attachments need to be inserted when they are reconstructed. TNEF provides a mechanism for creating tagged message bodies that your gateway can use to encapsulate attachments separately from the message text.</li>
</ul>
<p>
See <a href="msgxfer_72gi.htm">Message Transfer</a> for more information about message transfer envelopes and transferring message properties.</p>
<p>&nbsp;</p></body>
</HTML>
