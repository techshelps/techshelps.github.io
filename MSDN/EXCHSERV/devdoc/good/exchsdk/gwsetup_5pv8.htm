<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating the Directory Object</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_gdk_creating_the_directory_object"></a>Creating the Directory Object</h2>
<p>
Your gateway must be recognized by other programs such as the Microsoft Exchange Server Administrator program. Therefore, the setup program must create a new object for your gateway in the Microsoft Exchange Server directory and provide initial object attribute values. The setup program can set most of these values as defaults, while others (such as the server name) can be specified by the user through a setup dialog box. When you add a new Mail-Gateway object to the directory, an associated mailbox and folder hierarchy is created in the server’s information store. </p>
<p>
A gateway setup program calls the Microsoft Exchange Server directory access functions to create the object that represents the gateway in the directory and to write the object’s attributes to the directory. It presents dialog boxes to the administrator for entering attribute values, such as the address space serviced by the gateway. The directory access functions are described in <a href="directry_6qyb.htm">Directory Operations</a>. Setup programs can use the <a href="function_1v1w.htm"><b>BatchImport</b></a> or <a href="function_1q79.htm"><b>DAPIWrite</b></a> directory access functions to create the directory object. The sample gateway installation program GWINST.C in the \BKOFFICE\SAMPLES\EXCHANGE\EDKINSTU directory prepares for and calls <b>BatchImport</b>.</p>
<p>
To import a directory object, a gateway setup program first obtains all necessary configuration information from several sources. It reads default data from the gateway’s header files and uses some of the default values that correspond to gateway applications. It also copies extension data from the extension data file on the distribution medium. For more information, see <a href="gwsetup_1cyt.htm">Initializing the Extension-Data Attribute</a>. </p>
<p>
<b>Note</b>  Your gateway setup program should always set the gateway object’s Computer-Name attribute with the name of the Microsoft Exchange Server computer. This attribute is required for the Administrator extension interface to work correctly. The GWSETUP program provides an example of setting Computer-Name, using the <b>GetComputerName</b> function.</p>
<p>&nbsp;</p></body>
</HTML>
