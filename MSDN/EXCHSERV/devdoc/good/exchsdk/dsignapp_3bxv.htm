<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How a Voice Mail Server Works</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_edk_how_a_voice_mail_server_works"></a>How a Voice Mail Server Works</h3>
<p>
A voice mail server stores messages and makes them available when the user dials into the system. The user communicates with this application in the following manner:</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To use a voice mail server</h5>
<ol>
<li>
User calls the voice mail access number.</li>
<li>
Voice mail server application answers and plays the welcome message.</li>
<li>
User keys in an ID number (an office telephone extension number) and a PIN.</li>
<li>
When the user is identified, the voice mail system reports the number of unread messages in the user's mailbox.</li>
<li>
User keys in a request to hear the sender and subject line of each message, or a subset of messages.</li>
<li>
User has the option of listening to the complete message or sending it to a fax gateway.</li>
</ol>
<p>
</p>
<p>
The Windows NT account of the voice mail application is assigned read-only access to mailboxes. In other words, an administrator grants the privilege of reading all the messages in the mailboxes to this account. When the voice mail application logs on as the Windows NT account, it can read all the mailboxes on the messaging site. (Applications of this type are granted some of the rights normally reserved only for administrators.)</p>
<p>
The following diagram shows interactions of this voice mail system.</p>
<p>
<img src="images/edg09_02.gif" border=0></p>
<p>
<b>Architecture of a voice mail application</b></p>
<p>
If a user chooses to send a message by fax, the application must forward the message to a fax server. First, MAPI creates the message, then assigns a destination address to the message, using FAX as the address type (FAX:xxxxx). The phone number of the destination fax machine is supplied as the address value. The message is submitted by calling the MAPI <b>IMessage::SubmitMessage </b>method.</p>
<p>
After the message is submitted, Microsoft Exchange Server routes it to the FAX gateway, which puts the message into FAX format and sends it to the destination fax machine.</p>
<p>
This voice mail application shares several other characteristics with common types of server applications. </p>
<p>&nbsp;</p></body>
</HTML>
