<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Up Counters</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_gdk_setting_up_counters"></a>Setting Up Counters</h3>
<p>
The Windows NT Performance Monitor uses a set of counters to monitor gateway performance. The Microsoft Exchange Server SDK performance monitoring functions provide several counter types and counter periods. You can select the appropriate counters and periods for your gateway.</p>
<p>
For more information on the performance monitor functions supplied in the Microsoft Exchange Server SDK, see <a href="function_5x9q.htm"><b>HrInstallServicePerfMon</b></a>, <a href="function_9m7o.htm"><b>HrMonInit</b></a>, <a href="function_9ar2.htm"><b>HrRemoveServicePerfMon</b></a>, <a href="function_073n.htm"><b>HrMonLockCounters</b></a> and <a href="structs_1bmu.htm"><b>COUNTERDEF</b></a>.</p>
<h4>Gateway Counters</h4>
<p>
Gateway counters are used for statistics that apply to the entire gateway. They are:
<ul>
<li>
The number of messages entering Microsoft Exchange Server through the gateway.</li>
<li>
The number of bytes entering Microsoft Exchange Server through the gateway.</li>
<li>
The number of messages leaving Microsoft Exchange Server through the gateway.</li>
<li>
The number of bytes leaving Microsoft Exchange Server through the gateway.</li>
<li>
The number of nondeliverable receipts on messages entering Microsoft Exchange Server through the gateway.</li>
<li>
The number of nondeliverable receipts on messages leaving Microsoft Exchange Server through the gateway.</li>
<li>
The number of connections the gateway has made to the foreign mail system.</li>
</ul>
<h4>Folder Counters</h4>
<p>
Folder counters are used for statistics that apply to a single MAPI folder. MAPI folders are frequently used as queues, such as MTS_OUT. You can set up counters for several different folders. The folder counters are:
<ul>
<li>
The number of messages in the folder.</li>
<li>
The number of bytes in the folder.</li>
<li>
The number of messages entering the folder.</li>
<li>
The number of bytes entering the folder.</li>
<li>
The number of messages leaving the folder.</li>
<li>
The number of bytes leaving the folder.</li>
</ul>
<h4>User-Defined Counters</h4>
<p>
The Microsoft Exchange Server performance monitor functions let you set up and directly manipulate counters used by the Windows NT Performance Monitor. The following table shows counters that are typically required for a gateway and which are not provided through STATS.LIB. You can also define additional counters.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Counter</th>
<th align=left width=64%>Counter definition</th>
</tr>
<tr valign=top>
<td width=36%>Foreign Logical Connections&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td width=64%>The number of logical connections this gateway currently has to foreign systems.</td>
</tr>
<tr valign=top>
<td width=36%>Messages/Unit Time&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td width=64%>The number of messages processed per unit time.</td>
</tr>
<tr valign=top>
<td width=36%>Message Bytes/Unit Time</td>
<td width=64%>The number of message bytes processed per unit time.</td>
</tr>
<tr valign=top>
<td width=36%>Nondelivery Reports/Unit Time</td>
<td width=64%>The number of nondelivery reports processed per unit time.</td>
</tr>
<tr valign=top>
<td width=36%>Threads in Use</td>
<td width=64%>The number of threads in use by the gateway.</td>
</tr>
<tr valign=top>
<td width=36%>Work Queue Size</td>
<td width=64%>The number of items in the gateway work queue, which is the total number of messages in the gateway’s MTS-IN and MTS-OUT folders.</td>
</tr>
</table><br>
<h4>Counter Period Types</h4>
<p>
For many of the counters, you can use the period type to specify how data is displayed. The period types are show in the following table.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=26%>Period type</th>
<th align=left width=74%>Data displayed</th>
</tr>
<tr valign=top>
<td width=26%>None</td>
<td width=74%>A current value (snapshot statistic) such as the number of associations or the number of messages in a folder. Also used for user-defined counters.</td>
</tr>
<tr valign=top>
<td width=26%>Continuous</td>
<td width=74%>Total number of events during the past Performance Monitor sampling period.</td>
</tr>
<tr valign=top>
<td width=26%>Last N Minutes</td>
<td width=74%>Total number of events during the last N one-minute intervals.</td>
</tr>
<tr valign=top>
<td width=26%>Total</td>
<td width=74%>Total number of events since the gateway started running.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
