<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SMBAGENT Operation</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_edk_smbagent_operation"></a>SMBAGENT Operation</h3>
<p>
All messages submitted to SMBAGENT are placed in the Inbox folder by the <a href="glossary_1ood.htm#_edk_message_transfer_agent_mta_">message transfer agent (MTA)</a>. SMBAGENT receives notification of each new message from Microsoft Exchange Server through <a href="glossary_1ood.htm#_edk_mapi">MAPI</a>. When notification is received, the Inbox is searched for new messages. SMBAGENT also implements a polling mechanism that checks the Inbox, even if it has not received notifications. This polling allows messages to be found if problems such as server outages have prevented notification. The default polling frequency is set to one minute, but this can be modified by SMBADMIN. The value NONE turns polling off.</p>
<p>
Commands such as JOIN or LEAVE cause SMBAGENT to update information in the existing introduction message for the appropriate topic. Other commands, such as POST, cause the mail agent to generate a message for storage in one of the topic subfolders. </p>
<p>
The relationship between SMBAGENT, Microsoft Exchange Server, and a Microsoft Exchange Client is shown in the following figure.</p>
<p>
<img src="images/edg20_03.gif" border=0></p>
<p>
<b>SMBAGENT application architecture</b></p>
<p>
This figure shows Microsoft Exchange Server and SMBAGENT on a single server computer. SMBAGENT uses MAPI to communicate with Microsoft Exchange Server and send and receive information. Microsoft Exchange Client users send commands to SMBAGENT by sending mail messages.</p>
<p>
When a message arrives at the SMBAGENT mailbox on Microsoft Exchange Server, SMBAGENT reads the message's Subject property to determine which command to execute. SMBAGENT responds by posting mail messages to Microsoft Exchange Server, which forwards the messages to appropriate recipients. </p>
<p>
A user who registers interest in a topic becomes a member of that topic. As messages from members are received, SMBAGENT archives them according to their discussion topic. SMBAGENT can also connect to and store postings in public folders.</p>
<p>
The Sample Mailbox Agent will return a General Error message when an attempt is made to create a new topic with an Intro message that includes a link.  </p>
<p>&nbsp;</p></body>
</HTML>
