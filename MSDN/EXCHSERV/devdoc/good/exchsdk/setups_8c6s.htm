<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing an Admin-Extension Object</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_installing_an_admin_extension_object"></a>Installing an Admin-Extension Object</h2>
<p>
If your application is to present data to administrators on custom property pages, its setup program should install this functionality. This means installing the Admin-Extension object in the directory and copying the <a href="glossary_1oo1.htm#_edk_administrator_extension_dll">Administrator extension DLL</a> and any other necessary files to specific disk locations. For information about copying files, see <a href="setups_0697.htm">Copying Files Onto Disk</a>.</p>
<p>
For each Admin-Extension object to be installed, perform the following steps. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To install an Admin-Extension object</h5>
<ol>
<li>
Verify whether the Admin-Extension object already exists in the directory, using MAPI functions or the <a href="function_1cac.htm"><b>BatchExport</b></a> function. See <a href="directry_28zd.htm">Finding an Object in the Directory</a>.</li>
<li>
If the Admin-Extension object does exist, check its version. This is a multistep procedure that uses calls to the <b>HrGetFileVersionInfo</b>, <b>VerQueryValue</b>, <a href="function_49yr.htm"><b>HrAdminExtensionExists</b></a>, and <a href="function_1zxq.htm"><b>HrGetAdminExtensionVersion</b></a> functions. To see how this is done, refer to the <b>HrVerifyAdminExtensionVersion</b> function in the GWSETUP.C file. If no Admin-Extension object by this name exists in the directory, skip to step 4.</li>
<li>
If the installed Admin-Extension object is newer than the one to be installed, use a dialog box to require the administrator to choose whether to overwrite the installed Admin-Extension object with the older one on the distribution medium. If the user answers <b>No</b>, end the installation of this Admin-Extension object; if other Admin-Extension objects are to be installed, begin their installation at step 1. </li>
<li>
Call the Win32 <b>CoCreateGuid</b> function to create a GUID. Convert this GUID into a string, and then use that string as a unique extension name for the Admin-Extension object. This is accomplished in the following sample code from the GWSETUP.C file:<pre><code>CoCreateGuid(&amp;guid);

sprintf(
    szGatewayName,
    "%08lX-%04X-%04X-%02X%02X-%02X%02X%02X%02X%02X%02X",
    guid.Data1,
    guid.Data2,
    guid.Data3,
    guid.Data4[0],guid.Data4[1],guid.Data4[2],guid.Data4[3],
    guid.Data4[4],guid.Data4[5],guid.Data4[6],guid.Data4[7]);
 </code></pre>
</li>
<li>
If an Admin-Extension object with the same name as the one you are installing already exists, remove the installed object by calling the <b>HrRemoveAdminExtension</b> function, and passing the extension name of the Admin-Extension object.</li>
<li>
Copy the files associated with the Admin-Extension object to the server computer. See <a href="setups_7ckz.htm">Files Used with Directory Objects</a>.</li>
<li>
Create the new Admin-Extension object in the directory with the <a href="function_1v1w.htm"><b>BatchImport</b></a> or <a href="function_1q79.htm"><b>DAPIWrite</b></a> function. Use the GUID created in step 4 for the extension name of the object.</li>
</ol>
<p>
</p>
<p>
For sample code that performs these steps, see the GWSETUP.C file in the \BKOFFICE\SAMPLES\EXCHANGE\GWSETUP directory.</p>
<p>
For general information about working with Administrator extensions, see <a href="admin_4nsj.htm">Administrator Program Extensions</a>. For information about setting the attribute values of the Extension-Data attribute, see <a href="setups_59b9.htm">Initializing the Extension-Data Attribute</a>.</p>
<p>&nbsp;</p></body>
</HTML>
