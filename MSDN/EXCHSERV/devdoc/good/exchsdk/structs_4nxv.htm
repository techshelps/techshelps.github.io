<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BEXPORT_PARMS</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_edk_bexport_parms"></a>BEXPORT_PARMS</h1>
<p>
The <b>BEXPORT_PARMS</b> structure contains information for the <a href="function_1cac.htm"><b>BatchExport</b></a> function.</p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=23%>Header file:</td>
<td width=77%>DAPI.H</td>
</tr>
<tr valign=top>
<td width=23%>Unicode:</td>
<td width=77%>Yes</td>
</tr>
</table><br>
<pre><code>typedef struct
{
  DWORD             dwDAPISignature;
  DWORD             dwFlags;
  HWND              hwndParent;
  LPTSTR            pszExportFile;
  UINT              uCodePage;
  LPTSTR            pszDSAName;
  LPTSTR            pszBasePoint;
  LPTSTR            pszContainer;
  TCHAR             chColSep;
  TCHAR             chQuote;
  TCHAR             chMVSep;
  TCHAR             cReserved; 
  CALLBACKPROGRESS  ProgressCallBacks;
  ERROR_CALLBACK    ErrorCallback;
  EXPORT_CALLBACK   ExportCallback;
  PDAPI_ENTRY       pAttributes;
  LPTSTR            pszHomeServer;
  LPTSTR *          rgpszClasses;
  ULONG             ulUSNBase; 
  LPVOID            pReserved;
}  BEXPORT_PARMS, *PBEXPORT_PARMS, *LPBEXPORT_PARMS;
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>dwDAPISignature</b></dt>
<dd>
Must be set to the defined value DAPI_SIGNATURE (see DAPI.H). Verifies that the parameter sequence used by the calling application is the same as that expected by the directory functions.</dd>
<dt>
<b>dwFlags</b></dt>
<dd>
Defined values that control the directory export operation (see <a href="function_1cac.htm"><b>BatchExport</b></a>). Use the bitwise OR operator (|) to enable multiple operations:
<dl>
<dt>
DAPI_EXPORT_MAILBOX</dt>
<dd>
Exports mailbox recipient objects.</dd>
<dt>
DAPI_EXPORT_CUSTOM</dt>
<dd>
Exports remote address recipient objects.</dd>
<dt>
DAPI_EXPORT_DIST_LIST</dt>
<dd>
Exports distribution list objects.</dd>
<dt>
DAPI_EXPORT_RECIPIENTS</dt>
<dd>
Exports all recipient objects.</dd>
<dt>
DAPI_EXPORT_ALL_CLASSES</dt>
<dd>
Exports all object classes.</dd>
<dt>
DAPI_EXPORT_HIDDEN</dt>
<dd>
Exports any hidden objects. By default, if the Hide-From-Address-Book attribute is set, hidden objects are not exported.</dd>
<dt>
DAPI_EXPORT_SUBTREE</dt>
<dd>
Exports the directory object and any directory objects beneath it in the DIT.</dd>
<dt>
DAPI_EXPORT_BASEPOINT_ONLY</dt>
<dd>
Exports only the requested attributes from the object identified by <b>pszBasePoint</b>.</dd>
<dt>
DAPI_EVENT_MIN</dt>
<dd>
Logs start and stop messages; does not log warning or error messages.</dd>
<dt>
DAPI_EVENT_SOME</dt>
<dd>
Logs start, stop, and error messages; does not log warning messages.</dd>
<dt>
DAPI_EVENT_ALL</dt>
<dd>
Logs all messages (start, stop, error, and warning).</dd>
<dt>
DAPI_FORCE_SCHEMA_LOAD</dt>
<dd>
Unloads a previously loaded schema and reads the schema again. The default action is to reuse the previously loaded schema if it is read from the same messaging domain.</dd>
<dt>
DAPI_RAW_MODE</dt>
<dd>
Exports data in raw mode (export lines are taken literally). No properties are inherited or constructed. Aliases for property and class names are not recognized.</dd>
<dt>
DAPI_SUPPRESS_PROGRESS</dt>
<dd>
Suppresses the progress thermometer that normally appears during batch operations.</dd>
<dt>
DAPI_SUPPRESS_COMPLETION</dt>
<dd>
Suppresses the notification message window that normally appears following the completion of a batch operation.</dd>
<dt>
DAPI_SUPPRESS_ARCHIVES</dt>
<dd>
Suppresses the creation of an archive copy of any output files that normally are created during batch operations.</dd>
</dl>
</dd>
<dt>
<b>hwndParent</b></dt>
<dd>
The window handle to use when displaying message boxes. Set this member to NULL to use the handle of the main window of the calling application.</dd>
<dt>
<b>pszExportFile</b></dt>
<dd>
The fully qualified path of the file where the directory information tree objects are exported. <b>BatchExport</b> ignores this member if the <b>ExportCallback</b> member is specified.</dd>
<dt>
<b>uCodePage</b></dt>
<dd>
The code-page specification (text format) for the export file:
<dl>
<dt>
DAPI_UNICODE_FILE</dt>
<dd>
The export file is created in Unicode format.</dd>
<dt>
<b>0</b></dt>
<dd>
If the export files exists, the data is exported in the format of the existing export file. Otherwise, the export file is created in ANSI format.</dd>
<dt>
<i>other</i></dt>
<dd>
The export file is created in this ANSI code-page format. This ANSI code-page format must already be installed on the system.</dd>
</dl>

<p>
If this member is DAPI_UNICODE_FILE (which specifies that the DIT object is in Unicode format), but the DIT object is in ANSI format, <b>BatchExport</b> fails and emits a diagnostic error message in the Windows NT Application event log.

<p>
<b>BatchExport</b> also fails and emits a diagnostic error message in the Windows NT Application event log if this member is a format other than DAPI_UNICODE_FILE or <b>0</b> (zero, which is autodetect) and either of the following conditions is true:
</dd>
</dl>
<ul>
<li>
The format is not supported by the system.</li>
<li>
The output file exists and is in Unicode format.</li>
</ul>
<dl>
<dt>
<b>pszDSAName</b></dt>
<dd>
The directory service agent to use when exporting objects. If this member is NULL, <a href="function_1cac.htm"><b>BatchExport</b></a> attempts to find a directory service agent on the local computer. Otherwise, <b>BatchExport</b> broadcasts for a directory service agent to the servers on its network and uses the name that is returned as a result of the broadcast.
<p>
If this member is NULL, <b>BatchExport</b> searches for a DSA in the following order:

<ol>
<li>
If a DSA exists on the local computer, use it.</li>
<li>
Otherwise, broadcast for a DSA and use one of the DSAs that replies.</li>
</ol>

<p>
Use MAPI function calls to determine the DSA. See the <i>MAPI Programmer’s Reference</i> for more information.
</dd>
<dt>
<b>pszBasePoint</b></dt>
<dd>
The distinguished name of the messaging site or container that serves as the directory information tree basepoint for bulk operations. A distinguished name is the combination of an object’s path and name in the Xopen hierarchical naming structure.
<p>
If this member is NULL, the basepoint is the current site object where the DSA resides (as specified by the <i>lpBexportParms</i><b>-&gt;pszDSAName</b> parameter member); if <i>lpBexportParms</i><b>-&gt;pszBasePoint</b> is ““ (an empty string), the basepoint is the current organization object. The basepoint is the point in the DIT where <b>BatchExport</b> performs its bulk object creation or bulk object manipulation operations.
</dd>
<dt>
<b>pszContainer</b></dt>
<dd>
The distinguished name or relative distinguished name of the default container where objects are exported. If this member is NULL, <b>BatchExport</b> assumes that the container is below the level indicated by the <b>pszBasePoint</b> member. If this member is a relative distinguished name, <a href="function_1cac.htm"><b>BatchExport</b></a> assumes that the container is relative to the level indicated by the <b>pszBasePoint</b> member. The container name in the import file can override this value.
<p>
If this member is NULL, <b>BatchExport</b> exports the contents of all containers below the point specified by the <b>pszBasePoint</b> member.
</dd>
<dt>
<b>chColSep</b></dt>
<dd>
The column separator that is used within the export file. Specify your preferred column separator, even if it is the same as the default.
<p>
If this member is NULL, <b>BatchExport</b> uses the default separator, which is defined as DEFAULT_DELIM (see DAPI.H).

<p>
The default column separator used by the directory functions is unrelated to the default column separator specified within the Administrator program.
</dd>
<dt>
<b>chQuote</b></dt>
<dd>
The character that is used to enclose strings within the export file. Do not use the ~, #, or = characters. Specify your preferred string enclosure separator, even if it is the same as the default.
<p>
If this member is NULL, <b>BatchExport</b> uses the default string enclosure character, which is defined as DEFAULT_QUOTE (see DAPI.H).
</dd>
<dt>
<b>chMVSep</b></dt>
<dd>
The value separator for multivalued properties within the export file. A separator character is required, for example, by the members of a distribution list. A percent sign inside a quoted string is interpreted as a literal character. Specify your preferred value separator, even if it is the same as the default.
<p>
If this member is NULL, <b>BatchExport</b> uses the default multivalue separator character, which is defined as DEFAULT_MV_SEP (see DAPI.H).
</dd>
<dt>
<b>cReserved</b></dt>
<dd>
Unused and reserved for future use.</dd>
<dt>
<b>ProgressCallBacks</b></dt>
<dd>
A structure that contains pointers to functions that display the progress of the operation.
<p>
If this member is NULL, <b>BatchExport</b> displays a default modeless dialog to show progress.
</dd>
<dt>
<b>ErrorCallback</b></dt>
<dd>
A structure that contains a pointer to a function that is to be called on each error encountered.
<p>
If this member is NULL, <b>BatchExport</b> calls the default error handler, which displays an error dialog window and writes the error into the Windows NT Application event log.
</dd>
<dt>
<b>ExportCallback</b></dt>
<dd>
A structure that contains a pointer to a function that is to be called on each exported item.
<p>
If this member is NULL, <b>BatchExport</b> writes to the file specified by the <b>pszExportFile</b> parameter member.
</dd>
<dt>
<b>pAttributes</b></dt>
<dd>
Points to a <a href="structs_7n5l.htm"><b>DAPI_ENTRY</b></a> structure containing the names of attributes to export.
<p>
If you specify export attributes in this member, the first attribute in <b>pAttributes</b> must be NM_OBJECT_CLASS; otherwise, <b>BatchExport</b> fails.

<p>
Normally, <b>BatchExport</b> does not export deleted objects. You can export directory objects that are deleted, but not purged, by including the NM_IS_DELETED attribute.  

<p>
The <b>pAttributes</b> member is required if the <b>ExportCallback</b> member is specified; it is optional if the <b>pszExportFile</b> member is specified.
</dd>
<dt>
<b>pszHomeServer</b></dt>
<dd>
Only objects that reside on this server are exported. If this member is not NULL, only mailboxes are exported, as they are the only objects that reside on a server.
<p>
This member specifies that the mailboxes from only the specified server are exported. If <b>pszHomeServer </b>is NULL, <b>BatchExport</b> exports the mailboxes from all servers.
</dd>
<dt>
<b>rgpszClasses</b></dt>
<dd>
An array of pointers to zero-terminated strings specifying the object classes to export. The last entry must be NULL. The object classes can also be specified in <b>dwFlags</b>, but the values in this member take precedence over any class settings in <b>dwFlags</b>.
<p>
<b>BatchExport</b> queries the directory for objects of the specified classes in the order that you specify the classes in this member.
</dd>
<dt>
<b>ulUSNBase</b></dt>
<dd>
Update sequence number (USN). If this member is nonzero, only objects whose USN-Changed attribute is greater than this value are exported.
<p>
<b>BatchExport</b> exports only objects with USN-Changed greater than or equal to this member when EXPORT_USE_USN_BASE is set.  
</dd>
<dt>
<b>pReserved</b></dt>
<dd>
Reserved. Must be zero.
</dd>
</dl>
<h4>Remarks</h4>
<p>
For additional information on this structure, see <a href="directry_5d2r.htm">Exporting Objects</a>.</p>
<h4>See Also</h4>
<p>
<a href="function_1cac.htm"><b>BatchExport</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
