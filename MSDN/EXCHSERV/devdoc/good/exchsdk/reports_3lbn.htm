<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Nondelivery Report Failed Recipient List Properties</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_gdk_nondelivery_report_failed_recipient_list_properties"></a>Nondelivery Report Failed Recipient List Properties</h3>
<p>
The failed recipient list is a MAPI address list containing information about recipients to whom the gateway could not deliver the message. It contains the following properties:</p>
<h4>PR_RECIPIENT_TYPE</h4>
<p>
This property should be copied from the PR_RECIPIENT_PROPERTY of the appropriate recipient on the original message, if available. Allowed values are MAPI_TO, MAPI_CC, and MAPI_BCC.</p>
<h4>PR_RECIPIENT_NUMBER</h4>
<p>
This property contains the offset of the recipient in the original message. For example, the first recipient has a PR_RECIPIENT_NUMBER value of 1. If this recipient is a member of a distribution list, then the offset of the distribution list in the original message is used.</p>
<h4>PR_DISPLAY_NAME</h4>
<p>
This property contains values from the original message.</p>
<h4>PR_ADDRTYPE</h4>
<p>
This property contains values from the original message.</p>
<h4>PR_EMAIL_ADDRESS</h4>
<p>
This property contains values from the original message.</p>
<h4>PR_ENTRYID</h4>
<p>
This property contains values from the original message.</p>
<h4>PR_NDR_REASON_CODE</h4>
<p>
These codes are enumerated in the MAPITAGS.H file.</p>
<h4>PR_NDR_DIAG_CODE</h4>
<p>
These codes are enumerated in the MAPITAGS.H file. For a list of allowed values, see the documentation for the PR_NDR_DIAG_CODE property in the <i>MAPI Programmer’s Reference</i>.</p>
<h4>PR_REPORT_TIME</h4>
<p>
PR_REPORT_TIME is the time at which a per-recipient report was generated. Ideally this should be the time at which the message was found to be undeliverable. The X.400 standard requires the Arrival Time attribute on reports. However, the Microsoft Exchange Server information store requires PR_REPORT_TIME as a mandatory element on delivery reports and nondelivery reports.</p>
<h4>PR_ARRIVAL_TIME</h4>
<p>
PR_ARRIVAL_TIME is the MAPI equivalent of the X.400 per-recipient report attribute Arrival Time. This is defined as “The date and time at which the communique entered the Management Domain (MD) that produced the per-recipient report.” The MAPI property PR_ARRIVAL_TIME is used in two different contexts; it is a message envelope property associated with the original message, and it is also a per-recipient property on the nondelivery report.</p>
<p>
The appropriate values to set for PR_ARRIVAL_TIME and PR_REPORT_TIME depend on where the nondelivery report was generated and on the amount of information known to the gateway and the foreign system.</p>
<h4>PR_ORIGINATOR_NON_DELIVERY_REPORT_REQUESTED</h4>
<p>
This code must be set to TRUE for a nondelivery report.</p>
<h4>PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED</h4>
<p>
This code must be set to FALSE for a nondelivery report.</p>
<p>&nbsp;</p></body>
</HTML>
