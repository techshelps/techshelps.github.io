<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>COUNTERDEF</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_edk_counterdef"></a>COUNTERDEF</h1>
<p>
The <b>COUNTERDEF</b> structure contains descriptions of performance counters that are used by the <a href="function_9m7o.htm"><b>HrMonInit</b></a> function. A table of COUNTERs is created, and Microsoft Exchange Server guarantees that the counters are contiguous and in the same order as they are described in this table.</p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=23%>Header file:</td>
<td width=77%>MONITOR.H</td>
</tr>
</table><br>
<pre><code>typedef struct  // cd
{
  DWORD         iCounterTitleOffset;
  COUNTERTYPE   ctStatistic;
  LPMAPIFOLDER  lpFolder;
  PERIODTYPE    perPeriod;
  DWORD         cMinutes;
  LPCOUNTER *   lppcntUserCounter;
  DWORD         dwUserCounterType;
  DWORD         dwDetailLevel
  DWORD         dwDefaultScale
}  COUNTERDEF, * LPCOUNTERDEF;
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>iCounterTitleOffset</b></dt>
<dd>
Index of counter name, offset from the first counter, where the value of <b>iCounterTitleOffset</b> for the first counter is 0 (zero).</dd>
<dt>
<b>ctStatistic</b></dt>
<dd>
The type of statistic monitored by this counter:
<dl>
<dt>
COUNTERTYPE_MESSAGES_IN_FOLDER</dt>
<dd>
Total number of messages in folder</dd>
<dt>
COUNTERTYPE_BYTES_IN_FOLDER</dt>
<dd>
Total number of bytes in folder</dd>
<dt>
COUNTERTYPE_MESSAGES_ENTERING_FOLDER</dt>
<dd>
Number of messages entering folder</dd>
<dt>
COUNTERTYPE_BYTES_ENTERING_FOLDER</dt>
<dd>
Number of bytes entering folder</dd>
<dt>
COUNTERTYPE_MESSAGES_LEAVING_FOLDER</dt>
<dd>
Number of messages leaving folder</dd>
<dt>
COUNTERTYPE_MESSAGES_TRANSFERRED_IN</dt>
<dd>
Number of messages transferred into Microsoft Exchange Server</dd>
<dt>
COUNTERTYPE_BYTES_TRANSFERRED_IN</dt>
<dd>
Number of bytes transferred into Microsoft Exchange Server</dd>
<dt>
COUNTERTYPE_MESSAGES_TRANSFERRED_OUT</dt>
<dd>
Number of messages transferred out of Microsoft Exchange Server</dd>
<dt>
COUNTERTYPE_BYTES_TRANSFERRED_OUT</dt>
<dd>
Number of bytes transferred out of Microsoft Exchange Server</dd>
<dt>
COUNTERTYPE_NDRS_IN</dt>
<dd>
Number of NDRs into Microsoft Exchange Server</dd>
<dt>
COUNTERTYPE_NDRS_OUT</dt>
<dd>
Number of NDRs out of Microsoft Exchange Server</dd>
<dt>
COUNTERTYPE_ASSOCIATIONS</dt>
<dd>
Total number of associations</dd>
<dt>
COUNTERTYPE_USER_DEFINED</dt>
<dd>
User-defined counter</dd>
</dl>
</dd>
<dt>
<b>lpFolder</b></dt>
<dd>
Points to an <b>IMapiFolder</b> interface, which is the folder where the counter is from, if applicable.</dd>
<dt>
<b>perPeriod</b></dt>
<dd>
Period over which the statistics are totalled, if applicable:
<dl>
<dt>
PERIODTYPE_NONE</dt>
<dd>
Not a period statistic.</dd>
<dt>
PERIODTYPE_CONTINUOUS</dt>
<dd>
Most-recent performance monitor sampling period.</dd>
<dt>
PERIODTYPE_LAST_N_MINUTES</dt>
<dd>
The past <i>N</i> one-minute intervals, where <i>cMinutes</i> is the value for <i>N</i>.</dd>
<dt>
PERIODTYPE_TOTAL</dt>
<dd>
Everything since the gateway started.</dd>
</dl>
</dd>
<dt>
<b>cMinutes</b></dt>
<dd>
The value for N when <b>perPeriod</b> is PERIODTYPE_LAST_N_MINUTES.</dd>
<dt>
<b>lppcntlUserCounter</b></dt>
<dd>
Address to return a pointer to user-defined counter; otherwise NULL.</dd>
<dt>
<b>dwUserCounterType</b></dt>
<dd>
Points to a COUNTER, which is a user-defined counter.</dd>
<dt>
<b>dwDetailLevel</b></dt>
<dd>
Counter complexity as defined in WINPERF.H:
<dl>
<dt>
PERF_DETAIL_NOVICE</dt>
<dt>
PERF_DETAIL_ADVANCED</dt>
<dt>
PERF_DETAIL_EXPERT</dt>
<dt>
PERF_DETAIL_WIZARD</dt>
<dd>
</dd>
</dl>
</dd>
<dt>
<b>dwDefaultScale</b></dt>
<dd>
Default scale as defined in WINPERF.H.
</dd>
</dl>
<h4>Remarks</h4>
<p>
When an array of <b>COUNTERDEF </b>objects is used, standard counters must come before any user-defined counters in the array (counters whose <b>ctStatistic </b>member has the value COUNTERTYPE_USER_DEFINED). Otherwise, the Performance Monitor can display erroneous counter information.</p>
<p>
For additional information on this structure, see <a href="samplgw_1x5x.htm">Monitoring Performance with PERFTEST</a>. For information on the <b>IMapiFolder</b> interface, see the <i>MAPI Programmer’s Reference.</i></p>
<h4>See Also</h4>
<p>
<a href="function_073n.htm"><b>HrMonLockCounters</b></a>, <a href="function_9377.htm"><b>HrMonUnlockCounters</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
