<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>XLATDRIV: Translating Messages</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_gdk_xlatdriv_translating_messages"></a>XLATDRIV: Translating Messages</h2>
<p>
The XLATDRIV sample application enables you to:
<ul>
<li>
Set up a conversion in the gateway to translate messages.</li>
<li>
Send messages to the gateway.</li>
<li>
Open a text file to check that the messages you sent were translated correctly.</li>
</ul>
<p>
</p>
<p>
Before you run XLATDRIV, you must install the sample gateway as described in <a href="samplgw_5pyx.htm">Installing the Sample_Gateway</a>.</p>
<p>
Source code for IPM_IN and IPM_OUT is in the corresponding directories under \BKOFFICE\SAMPLES\EXCHANGE. Source code for the remaining conversions is in the \BKOFFICE\SAMPLES\EXCHANGE\XLATCONV directory. You can choose a conversion from those described in the following table:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=23%>Conversion DLL </th>
<th align=left width=77%>Description</th>
</tr>
<tr valign=top>
<td width=23%>IPM_IN.DLL</td>
<td width=77%>Translates a message from RFC 822 format to MAPI format.</td>
</tr>
<tr valign=top>
<td width=23%>IPM_OUT.DLL</td>
<td width=77%>Translates a message from MAPI format to RFC 822 format.</td>
</tr>
<tr valign=top>
<td width=23%>TNEFDEC.DLL</td>
<td width=77%>Decodes a TNEF copy of the message as an embedded message.</td>
</tr>
<tr valign=top>
<td width=23%>TNEFENC.DLL</td>
<td width=77%>Adds an attachment containing an encoding of the entire content of the original message in TNEF format.</td>
</tr>
<tr valign=top>
<td width=23%>TOUPPER.DLL</td>
<td width=77%>Adds an attachment containing the message text converted to uppercase.</td>
</tr>
<tr valign=top>
<td width=23%>TRIVIAL.DLL</td>
<td width=77%>Adds an attachment with no changes.</td>
</tr>
</table><br>
<p>
<b>Note</b>  Do not run multiple instances of XLATDRIV against the same gateway profile.</p>
<p>
To run XLATDRIV, you must have a conversion point of SAMPLEGW.OUTBOUND for outbound conversion DLLs, and a conversion point of SAMPLEGW.INBOUND for inbound conversion DLLs.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To build XLATDRIV</h5>
<ol>
<li>
Change to the directory containing the RPTDRIV source files:<p>
<b>\BKOFFICE\SAMPLES\EXCHANGE\XLATDRIV directory.</b>
</li>
<li>
Type <b>NMAKE</b>.</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To run XLATDRIV</h5>
<ol>
<li>
From the \BKOFFICE\BIN directory, copy the following into a directory that is on your path:<p>
IPM_IN.DLL
<p>
IPM_OUT.DLL
<p>
TNEFDEC.DLL
<p>
TNEFENC.DLL
<p>
TOUPPER.DLL
<p>
TRIVIAL.DLL 
<p>
Windows NT Server searches the directories listed in the path environment variable when attempting to locate a DLL, and searches directories in the path before it searches the current directory.
</li>
<li>
Run <a href="samplgw_12y6.htm">XLATINST</a> to install the conversion DLLs you need. The parameter values for XLATINST are shown in the following table.</li>
</ol>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=49%>Conversion DLL</th>
<th align=left width=51%>Values</th>
</tr>
<tr valign=top>
<td width=49%>IPM_IN.DLL</td>
<td width=51%>Classes : REG_MULTI_SZ : ENVELOPE.IPM REPORT.IPM</td>
</tr>
<tr valign=top>
<td width=49%></td>
<td width=51%>Options : REG_SZ</td>
</tr>
<tr valign=top>
<td width=49%></td>
<td width=51%>Conversion Point : REG_SZ : SAMPLEGW.INBOUND</td>
</tr>
<tr valign=top>
<td width=49%>IPM_OUT.DLL</td>
<td width=51%>Classes : REG_MULTI_SZ : ENVELOPE.IPM REPORT.IPM</td>
</tr>
<tr valign=top>
<td width=49%></td>
<td width=51%>Options : REG_SZ:</td>
</tr>
<tr valign=top>
<td width=49%></td>
<td width=51%>Conversion Point : REG_SZ : SAMPLEGW.OUTBOUND</td>
</tr>
<tr valign=top>
<td width=49%>TNEFDEC.DLL</td>
<td width=51%>Classes : REG_MULTI_SZ : ENVELOPE.IPM</td>
</tr>
<tr valign=top>
<td width=49%></td>
<td width=51%>Options : REG_SZ : </td>
</tr>
<tr valign=top>
<td width=49%></td>
<td width=51%>Conversion Point : REG_SZ : SAMPLEGW.INBOUND</td>
</tr>
<tr valign=top>
<td width=49%>TNEFENC.DLL</td>
<td width=51%>Classes : REG_MULTI_SZ : ENVELOPE.IPM</td>
</tr>
<tr valign=top>
<td width=49%></td>
<td width=51%>Options : REG_SZ : </td>
</tr>
<tr valign=top>
<td width=49%></td>
<td width=51%>Conversion Point : REG_SZ : SAMPLEGW.OUTBOUND</td>
</tr>
<tr valign=top>
<td width=49%>TOUPPER.DLL</td>
<td width=51%>Classes : REG_MULTI_SZ : ENVELOPE.IPM</td>
</tr>
<tr valign=top>
<td width=49%></td>
<td width=51%>Options : REG_SZ :</td>
</tr>
<tr valign=top>
<td width=49%></td>
<td width=51%>Conversion Point : REG_SZ : SAMPLEGW.OUTBOUND</td>
</tr>
<tr valign=top>
<td width=49%>TRIVIAL.DLL</td>
<td width=51%>Classes : REG_MULTI_SZ : ENVELOPE.IPM</td>
</tr>
<tr valign=top>
<td width=49%></td>
<td width=51%>Options : REG_SZ :</td>
</tr>
<tr valign=top>
<td width=49%></td>
<td width=51%>Conversion Point : REG_SZ : SAMPLEGW.OUTBOUND</td>
</tr>
</table><br>
<ol start=3>
<li>
Start the Microsoft Exchange Client. Sign on as a user and compose and send mail messages to one or two recipients on the gateway. These are the messages that XLATDRIV will translate. </li>
<li>
To start XLATDRIV, change to the \BKOFFICE\BIN directory. At the command prompt, type <b>XLATDRIV NOTSERV &lt;<i>gateway</i>&gt;</b><i> </i>where <i>gateway </i>is the name of the gateway's MAPI profile. To see all the options supported by XLATDRIV, type <b>XLATDRIV NOTSERV &lt;<i>gateway</i>&gt;<i> </i>/?</b>".<p>
XLATDRIV supports the following three options:
<dl>
<dt>
/DIRECTION</dt>
<dd>
For /DIRECTION = INBOUND, XLATDRIV reads text files that were created with the Outbound conversion from the current directory and translates them into MAPI messages in the gateway's MTS-IN directory.
<p>
For /DIRECTION = OUTBOUND, XLATDRIV reads messages from the gateway's MTS-OUT folder and converts them into XLT*.TMP text files in either the current directory or the directory specified by the /LOCATION option.

<p>
The default for /DIRECTION is OUTBOUND.

<p>
TNEFDEC.DLL only works with the /DIRECTION = INBOUND option. All other conversion DLLs in XLATCONV only work with the /DIRECTION = OUTBOUND option.
</dd>
<dt>
/LOCATION</dt>
<dd>
Specifies the directory into which to write or read the text files. If it is not provided, the current directory is used.</dd>
<dt>
/ENCODE</dt>
<dd>
Enables TNEF encoding and decoding of messages. This option only works on outbound processing. The default is no TNEF encoding and decoding.</dd>
</dl>
</li>
<li>
Start the Microsoft Exchange Client again. Sign on as <i>gateway</i>. Access the directory where XLATDRIV placed the translated messages. Open the messages and check the translation. The message translation program uses the first conversion it encounters in the Windows NT Registry. </li>
<li>
To disable or enable a conversion you have loaded, run the <b>Regedt32</b> program in the WINNT35\SYSTEM32 directory. In the <b>HKEY_LOCAL_MACHINE\Software\Classes</b> key, in the conversion subkeys: <ul>
<li>
To enable a conversion, in its conversion subkey, for the Point value, type <b>SAMPLEGW.OUTBOUND </b>for outbound conversion DLLs or <b>SAMPLEGW.INBOUND</b> for inbound conversion DLLs.</li>
<li>
To disable a conversion, in its conversion subkey, for its Point value, type <b>zSAMPLEGW.OUTBOUND</b> for outbound conversion DLLs or <b>zSAMPLEGW.INBOUND</b> for inbound conversion DLLs.</li>
</ul>
</li>
<li>
To use a new conversion, start the Microsoft Exchange Client as a user, send more mail to the gateway, and type:<p>
<b>XLATDRIV NOTSERV &lt;<i>gateway</i>&gt; /DIRECTION=OUTBOUND</b>
<p>
You can also add more XLT*.TMP files to your current directory and type:
<p>
<b>XLATDRIV NOTSERV &lt;<i>gateway</i>&gt; /DIRECTION=INBOUND</b>
<p>
See <a href="gwmesg_741g.htm">Sample Gateway Message Format</a> for the format of the XLT*.TMP text files.
</li>
</ol>
<p>
</p>
<p>
IPM_OUT.DLL writes the first line of a textized message as X-Tnef-Attach:&lt;<i>TNEF data filename, if any</i>&gt;. Therefore, files with TNEF attachments have the first line "X-Tnef-Attach:MAPIMAIL.DAT", and files without TNEF attachments have the first line "X-Tnef-Attach:".</p>
<p>
This way, IPM_IN.DLL can easily determine if an input file has TNEF data by examining the first line of the file.</p>
<p>&nbsp;</p></body>
</HTML>
