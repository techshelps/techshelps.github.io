<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HrTextFromCompressedRTFStreamEx</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_edk_hrtextfromcompressedrtfstreamex"></a>HrTextFromCompressedRTFStreamEx</h1>
<p>
The <b>HrTextFromCompressedRTFStreamEx</b> function converts RTF-compressed text to ANSI text.</p>
<h4>Quick Info </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=23%>Header file: </td>
<td width=77%>RTFLIB.H</td>
</tr>
<tr valign=top>
<td width=23%>Library: </td>
<td width=77%>RTFLIB.LIB</td>
</tr>
</table><br>
<pre><code><b>HRESULT HrTextFromCompressedRTFStreamEx(
  LPSTREAM</b><i> pstmCompressed</i><b>,  </b>
<b>  LPSTREAM&nbsp;FAR&nbsp;*</b><i>&nbsp;ppstmText</i><b>,  </b>
<b>  RTFSYNCINFO&nbsp;FAR&nbsp;*</b><i>&nbsp;psi</i><b>,  </b>
<b>  ULONG</b><i>&nbsp;cpid</i><b>,             </b>
<b>  ULONG</b><i>&nbsp;cAttach</i><b>,          </b>
<b>  ULONG&nbsp;FAR&nbsp;*</b><i>&nbsp;rgAttachPos  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pstmCompressed</i></dt>
<dd>
Input parameter. Points to the compressed RTF stream.</dd>
<dt>
<i>ppstmText</i></dt>
<dd>
Output parameter. Points to the address where the ANSI text is stored.</dd>
<dt>
<i>psi</i></dt>
<dd>
Output parameter. Points to an <a href="structs_4dtb.htm"><b>RTFSYNCINFO</b></a> structure containing the operations that must be done to synchronize the text.</dd>
<dt>
<i>cpid</i></dt>
<dd>
Input parameter. The code page for the text stream. It can be any code page including UNICODE. If <i>cpid</i> is zero (0), <b>HrTextFromCompressedRTFStreamEx</b> uses the current system code page. If the requested code page is not supported, <b>HrTextFromCompressedRTFStreamEx</b> can return S_FALSE during a read or copy operation.</dd>
<dt>
<i>cAttach</i></dt>
<dd>
Input parameter. The number of attachments in the array where <i>rgAttachPos</i> points.</dd>
<dt>
<i>rgAttachPos</i></dt>
<dd>
Input/output parameter. An array containing the current rendering position for each attachment in the message. The number of elements in the array must match <i>cAttach</i>. The caller must fill in this array with the current attachment positions to guarantee proper handling of position 0xFFFFFFFF attachments. The values in <i>rgAttachPos</i> are updated while the stream is processed and are only accurate when the stream has been exhausted. Attachments with initial position 0xFFFFFFFF are not updated. If there are more attachments than RTF attachment tags, remaining attachments are updated to position 0xFFFFFFFF. If there are fewer attachments than RTF tags, the extra RTF tags are ignored.
</dd>
</dl>
<h4>Return Values</h4>
<p>
See <a href="function_3odv.htm">Return Values</a>.</p>
<h4>Remarks</h4>
<p>
For information about the <b>RTFSync</b> function, see the <i>MAPI Programmer's Reference.</i></p>
<h4>See Also</h4>
<p>
<a href="function_0vzo.htm"><b>HrRTFCompressedToText</b></a>, <a href="function_65no.htm"><b>HrTextToRTFCompressed</b></a>, <a href="structs_4dtb.htm"><b>RTFSYNCINFO</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
