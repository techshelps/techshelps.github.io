<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Formatting DIRSYNC Import and Export Files</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_formatting_dirsync_import_and_export_files"></a>Formatting DIRSYNC Import and Export Files</h2>
<p>
The DIRSYNC sample application writes exported data to files and reads imported data from files. Although DIRSYNC communicates with the directory service using <a href="glossary_1oo4.htm#_edk_directory_access_functions">directory access functions</a>, the file format it requires for import operations (and generates during export operations) differs from that used by the directory access functions.</p>
<h4>Example: DIRSYNC File Format</h4>
<p>
The following is a sample of the DIRSYNC file format, which is based on the Microsoft Mail 3.2 IMPORT utility file format:</p>
<pre><code># Sample DIRSYNC import/export file

A /o=Microsoft/ou=WGA/cn=Recipients/cn=JerryWh
- Display-Name:Jerry Wheeler

M /o=Microsoft/ou=WGA/cn=Recipients/cn=West Coast/cn=KevinY
- Display-Name:Kevin Yim

D /o=Microsoft/ou=WGA/cn=Recipients/cn=KevinY
 </code></pre>
<p>
Each line is prefixed by a character that indicates how the line should be processed.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=11%>Prefix</th>
<th align=left width=19%>Type</th>
<th align=left width=70%>Notes</th>
</tr>
<tr valign=top>
<td width=11%>A</td>
<td width=19%>Add</td>
<td width=70%>Export: New directory entry. <br>
Import: Add new directory entry.</td>
</tr>
<tr valign=top>
<td width=11%>M</td>
<td width=19%>Modify</td>
<td width=70%>Export: Modified directory entry. <br>
Import: Modify directory entry.</td>
</tr>
<tr valign=top>
<td width=11%>D</td>
<td width=19%>Delete</td>
<td width=70%>Export: Deleted directory entry. <br>
Import: Delete directory entry.</td>
</tr>
<tr valign=top>
<td width=11%>-</td>
<td width=19%>Attribute</td>
<td width=70%>Directory object attribute.</td>
</tr>
<tr valign=top>
<td width=11%>#</td>
<td width=19%>Comment</td>
<td width=70%>Comment line. The rest of the line after the hash character is ignored.</td>
</tr>
</table><br>

<h4><a name="_example_syntax_of_export_or_import_file"></a>EXAMPLE: Syntax of Export or Import File</h4>
<p>
Here is an example of the import/export file syntax used by the DIRSYNC sample application:</p>
<pre><code>data-list :
data-section
data-section data-list

data-section :
add-section
modify-section
delete-section
comment-line

add-section :
add-line attribute-section

modify-section :
modify-line attribute-section

delete-section :
delete-line

attribute-section :
attribute-line
attribute-line attribute-section

add-line :
<b><i>A</i></b> space-character RDN EOL

modify-line :
<b><i>M</i></b> space-character RDN EOL

delete-line :
<b><i>D</i></b> space-character RDN EOL

attribute-line :
<b><i>-</i></b> space-character attribute-label <b><i>:</i></b> attribute-value (opt)  EOL

comment-line :
<b><i>#</i></b> string EOL

EOL :
CR LF

attribute-value :
constant
string
hex-string
quoted-string

quoted-string :
<b><i>"</i></b> string <b><i>"</i></b>

hex-string :
<b><i>\x</i></b> hex-string-data

hex-string-data :
hex-character
hex-character hex-string-data

hex-character : <i>one of</i>
0 1 2 3 4 5 6 7 8 9 A B C D E F a b c d e f
 </code></pre>
<p>
<b>Important</b>  Do not enter spaces between attribute names, the colon delimiter, and attribute values. </p>
<p>&nbsp;</p></body>
</HTML>
