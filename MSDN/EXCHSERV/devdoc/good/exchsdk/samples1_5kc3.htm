<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DIRSYNC: Importing and Exporting Mailboxes</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_edk_dirsync_importing_and_exporting_mailboxes"></a>DIRSYNC: Importing and Exporting Mailboxes</h1>
<p>
The DIRSYNC sample application demonstrates how to transfer <a href="glossary_1ood.htm#_edk_mailbox">mailboxes</a> and custom recipient information between foreign systems and a <a href="glossary_1oo3.htm#_edk_container">container</a> on Microsoft Exchange Server. It also shows how to use the <a href="glossary_1oo4.htm#_edk_directory_access_functions">directory access functions</a> to build a transfer agent. Microsoft Exchange Server software includes a <a href="glossary_1oo4.htm#_edk_directory_replication">directory replication</a> process for transferring <a href="glossary_1oo4.htm#_edk_directory">directory</a> information between <a href="glossary_1ooj.htm#_edk_server">servers</a> at a site, and a directory replication connector to extend that automatic process between sites. There is also a <a href="glossary_1oo4.htm#_edk_directory_synchronization">directory synchronization</a> process to transfer information between Microsoft Exchange Server and Microsoft Mail 3.X systems. DIRSYNC can be used to transfer information between Microsoft Exchange Server and other foreign mail systems.</p>
<p>
DIRSYNC can be manually called to perform the following actions:
<ul>
<li>
Export incremental updates of mailbox attributes from a container on Microsoft Exchange Server to a foreign system.</li>
<li>
Export attributes of all mailboxes from a container on Microsoft Exchange Server to a foreign system.</li>
<li>
Import incremental updates about mailbox changes or custom recipient changes from a foreign system to a container on Microsoft Exchange Server.</li>
<li>
Import attributes of all mailboxes or custom recipients from a foreign system to a container on Microsoft Exchange Server.</li>
</ul>
<p>
</p>
<p>
DIRSYNC uses <a href="glossary_1oon.htm#_edk_windows_nt_registry">Windows NT Registry</a> key values and directory attributes to determine which information to export or import. Each time DIRSYNC is called for export, it uses the USNChanged directory attribute to determine whether any changes have been made since the last export. For more information, see <a href="compnent_4qnn.htm">Exporting and Importing Changed Objects</a>.</p>
<p>
When the DIRSYNC sample application is used for export, the parameters specified can change the basic DIRSYNC operation. When the /EXPFULL flag is specified, the attributes for the entire set of mailboxes in that container are exported. If the /SUBS flag is specified, attributes for mailboxes in subcontainers of the selected container will also be exported. The /EXPLIST command-line flag allows you to specify which directory attributes you want to export. If /EXPLIST is not used, only the distinguished name (the name plus the full path, called the DN) of the mailbox is exported. For more information, see <a href="samples1_7btx.htm">Building a New DIRSYNC Instance</a>.</p>
<p>
When the DIRSYNC sample application is used for import, DIRSYNC accepts a file created by the foreign system or database. This file must be in the exact format expected by DIRSYNC. An explanation of this syntax and an example of a DIRSYNC import file are included in <a href="samples1_0d9v.htm">Formatting DIRSYNC Import and Export Files</a>. </p>
<p>
When changes are imported by DIRSYNC into the directory, the state parameters for DIRSYNC are updated. DIRSYNC keeps a list of all the imported changes to assure that these changes will not be exported back to the foreign system. This list is used at the next export session and at that time is automatically erased. </p>
<p>
<b>Note</b>  For reliable <a href="glossary_1oo1.htm#_edk_ambiguous_name_resolution_anr_">ambiguous name resolution (ANR)</a> when creating custom recipients, separate fields are required for last name, first name, and display names.</p>
<p>&nbsp;</p></body>
</HTML>
