<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using MAPI Call Traces</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_edk_using_mapi_call_traces"></a>Using MAPI Call Traces</h1>
<p>
Performance information can be gathered from your application by using the MAPI call trace provided as part of the MAPI package.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To get MAPI call traces from the personal information store</h5>
<ol>
<li>
Copy MSPST.INI from the MAPI SDK to the root of your Windows NT Server directory.<ul>
<li>
Type <b>COPY MSPST.INI C:\WINNT</b></li>
</ul>
</li>
<li>
Change every value in MSPST.INI that starts with Perf from 0 to 1.</li>
<li>
Change the following values in MSPST.INI:<pre><code>TraceGetProps=1
TraceSetProps=1
TraceDeleteProps=1
TraceSetColumns=1
TraceSortTable=1
TraceRestrict=1
TraceFindRow=1
 </code></pre>
</li>
<li>
Edit or create the MAPIDBG.INI file in your Windows NT Server directory to contain the following lines:<pre><code>[General]
DebugTrace=1
 </code></pre>
</li>
<li>
Install a debug version of the Microsoft Exchange Client.</li>
<li>
Start the Microsoft Exchange Client. Output from the PST will print to the print destination of <b>OutputDebugString</b>.<ul>
<li>
On Windows NT Server, the easiest way is to start the Microsoft Exchange Client in WINDBG mode. The output appears in the <b>Command</b> window.</li>
<li>
On a 16-bit client, use DBWIN to capture the output from the Microsoft Exchange Client.</li>
</ul>
</li>
<li>
Mark the area before the test. When the test is complete, cut and paste the text to the Windows Notepad application to save the trace for further analysis.</li>
</ol>
<p>
</p>
<p>
If you receive a <b>First Chance Exception</b> notification when starting the client, stop WINDBG, restart WINDBG, and then execute the following steps:
<ol>
<li>
From the <b>Options</b> menu, choose <b>Exceptions</b>.</li>
<li>
For <b>Except #</b>, enter 000006ba.</li>
<li>
Make sure <b>Action</b> is set to <b>Ignore</b>.</li>
<li>
Click <b>Add</b>.</li>
<li>
Click <b>OK</b>.</li>
<li>
Press F5 to start Microsoft Exchange Server and log on. </li>
</ol>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
