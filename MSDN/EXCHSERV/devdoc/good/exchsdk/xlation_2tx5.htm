<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HrCnvQueryCapability</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_gdk_hrcnvquerycapability"></a>HrCnvQueryCapability</h2>
<p>
The <b>HrCnvQueryCapability</b> function returns an HResult indicating whether the translation DLL’s <b>HrCnvConvert</b> function can handle a particular message. The function receives a pointer to the message to be translated, a pointer to the message class of the message, and a pointer to the environment of the translation. The function returns a BOOL indicating whether it can or cannot translate the message.</p>
<p>
For outgoing messages, the important factor is usually the message class of the outgoing message. For incoming messages, this function may need to analyze some or all of the input message’s header or other delivery information to determine whether the message can be translated by the DLL’s <b>HrCnvConvert</b> function.</p>
<p>
The environment of the translation is a string of the form <i>GatewayName.PhaseName</i>, such as “<i>fax.phase2</i>”. This allows for gateways whose requirements demand that translation take place in more than one phase. Most gateways will only need one phase and will thus have a constant string for their environment. If your gateway requires multiple phases to translate some particular message class, you must provide separate translation DLLs for each combination of message class and translation phase; consequently, <b>HrCnvQueryCapability</b> should return FALSE if the DLL’s environment or the message class does not match the input message or environment.</p>
<p>
The IPM_IN and IPM_OUT sample translation DLLs, located in the \BKOFFICE\SAMPLES\EXCHANGE directory, contain examples of <b>HrCnvQueryCapability</b> functions both for incoming RFC-822 messages, and for outgoing MAPI messages.</p>
<p>&nbsp;</p></body>
</HTML>
