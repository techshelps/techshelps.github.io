<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SchemaPreload</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_edk_schemapreload"></a>SchemaPreload</h1>
<p>
The <b>SchemaPreload</b> function initializes the attribute and class tables for import and export operations. Microsoft Exchange Server executes the <b>SchemaPreload</b> function in the background as a separate thread.</p>
<h4>Quick Info </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=23%>Header file: </td>
<td width=77%>DAPI.H</td>
</tr>
<tr valign=top>
<td width=23%>Library: </td>
<td width=77%>DAPI.LIB</td>
</tr>
<tr valign=top>
<td width=23%>Unicode: </td>
<td width=77%>Yes</td>
</tr>
</table><br>
<pre><code><b>VOID SchemaPreload(
  DWORD</b><i> dwFlags</i><b>, </b>
<b>  LPTSTR</b><i> pszDSA  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwFlag</i></dt>
<dd>
Accepts defined values that control the directory schema operations. Use the bitwise OR operator (|) to enable multiple operations:
<dl>
<dt>
DAPI_FORCE_SCHEMA_LOAD</dt>
<dd>
Unloads a previously loaded schema and reads the schema again. The default action is to reuse the previously loaded schema if read from the same messaging domain.</dd>
<dt>
DAPI_RAW_MODE</dt>
<dd>
Imports and exports in raw mode, where import lines are taken literally. Attributes are neither inherited nor constructed, and aliases for attribute and class names are not recognized.</dd>
<dt>
<b>Flags That Control Event Filtering:</b></dt>
<dd>
</dd>
<dt>
DAPI_EVENT_MIN </dt>
<dd>
Logs start and stop messages. Provides no warning or error logging. </dd>
<dt>
DAPI_EVENT_SOME </dt>
<dd>
Logs Start, Stop, and Error messages.</dd>
<dt>
DAPI_EVENT_ALL </dt>
<dd>
Logs Start, Stop, Error, and Warning messages.</dd>
</dl>
</dd>
<dt>
<i>pszDSA</i></dt>
<dd>
The name of the directory service agent where the schema is read.</dd>
</dl>
<h4>Return Values</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
The <b>SchemaPreload</b> function is optional. It allows an image of the directory schema to be loaded by a separate Windows NT Server thread while the directory access process is being initialized. For example, your program can load the schema while a user is entering import or export parameters in a dialog.</p>
<p>
Microsoft Exchange Server uses the schema that was loaded into the schema cache for all subsequent directory access operations, until one of the following events occurs:
<ul>
<li>
DAPI.DLL is unloaded from memory.</li>
<li>
<b>SchemaPreload</b> is called with the DAPI_FORCE_SCHEMA_LOAD flag, which flushes current schema values in the cache and reloads a new copy of the schema.</li>
<li>
A directory access or export operation is specified with a different messaging site.</li>
</ul>
<p>
</p>
<p>
For more information on this function, see <a href="directry_6pkj.htm">Using Directory Access Functions</a>.</p>
<h4>See Also</h4>
<p>
<a href="function_1cac.htm"><b>BatchExport</b></a>,<b> <a href="function_1v1w.htm">BatchImport</a></b>, <a href="function_26qs.htm"><b>DAPIRead</b></a>,<b> <a href="function_1q79.htm">DAPIWrite</a></b></p>
<p>&nbsp;</p></body>
</HTML>
