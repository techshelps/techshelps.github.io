<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Opening the Favorites Folder</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_edk_opening_the_favorites_folder"></a>Opening the Favorites Folder</h3>
<p>
The visibility of the All Public Folders folder and the Favorites folder differs according to the way they are sought. When an application opens the IPM_SUBTREE folder by first obtaining the MAPI PR_IPM_SUBTREE_ENTRYID property and then obtaining the hierarchy table at this level, the Favorites and All Public Folders folders appear in the hierarchy table. </p>
<p>
But when an application directly traverses the hierarchy table beginning with the root folder of the <a href="glossary_1oog.htm#_edk_public_information_store">public information store</a>, the Favorites folder and the All Public Folders folder do not appear in the hierarchy table. The subfolders of the All Public Folders folder appear in the hierarchy directly under the IPM_SUBTREE folder.</p>
<p>
To open the Favorites folder or the All Public Folders folder directly, use the <a href="props4_22hw.htm">PR_IPM_PUBLIC_FOLDERS_ENTRYID</a> and <a href="props4_34mc.htm">PR_IPM_FAVORITES_ENTRYID</a> properties on the public information store object. This method for opening the Favorites folder is described in the following procedure. For more information, see <a href="compnent_9nsi.htm">About the Favorites Folder</a>. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To open the Favorites folder using HrOpenExchangePublicStore</h5>
<ol>
<li>
Open the public information store by calling the <a href="function_91id.htm"><b>HrOpenExchangePublicStore</b></a> function. This function call returns an lpMDB pointer to the open store, which also gives you access to the MAPI <b>IMsgStore </b>interface.</li>
<li>
Use the <b>IMAPIProp::GetProps</b> method to read the PR_IPM_FAVORITES_ENTRYID property, which contains the entry identifier of the Favorites folder. </li>
<li>
Open the Favorites folder within the public information store by calling the MAPI <b>IMsgStore::OpenEntry</b> method. In this function call, pass the entry identifier of the folder in the <i>lpEntryID</i> parameter. </li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To open the Favorites folder using HrMAPIOpenFolderEx </h5>
<p class=indent1>
Open the Favorites folder by calling the <a href="function_88u0.htm"><b>HrMAPIOpenFolderEx</b></a> function. In this function call, pass the entry identifier of the Favorites folder as follows: @PR_IPM_FAVORITES_ENTRYID. </p>
<p class=indent1>
For a list of other entry identifiers for special folders, see <a href="infostor_4a5v.htm">Entry Identifiers of Special Folders</a>.</p>
<p>&nbsp;</p></body>
</HTML>
