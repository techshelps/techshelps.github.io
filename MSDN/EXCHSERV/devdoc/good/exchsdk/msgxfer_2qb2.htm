<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Gateway Trace Information</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_gdk_gateway_trace_information"></a>Gateway Trace Information</h2>
<p>
The PR_TRACE_INFO property stores a <a href="structs_5ucv.htm"><b>TRACEINFO</b></a> structure containing gateway’s external trace information for a message. PR_TRACE_INFO helps a gateway or message transfer agent determine the path that a message has traveled. This information is critical for preventing message delivery loops. A <a href="structs_5ucv.htm"><b>TRACEINFO</b></a> structure contains a set of <a href="structs_6ttl.htm"><b>TRACEENTRY</b></a> structures in chronological order.</p>
<p>
<b>TRACEINFO Structure Members</b></p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=22%>Member</th>
<th align=left width=25%>Type</th>
<th align=left width=53%>Description</th>
</tr>
<tr valign=top>
<td width=22%>cEntries</td>
<td width=25%>Long</td>
<td width=53%>Number of <b>TRACEENTRY </b>structures.</td>
</tr>
<tr valign=top>
<td width=22%>rgtraceentry[ ]</td>
<td width=25%>TRACEENTRY</td>
<td width=53%>Array of <b>TRACEENTRY </b>structures</td>
</tr>
</table><br>
<p>
Each <b>TRACEENTRY</b> structure in the <b>TRACEINFO</b> structure contains the following members.</p>
<p>
<b>TRACEENTRY Structure Members</b></p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=31%>Member</th>
<th align=left width=21%>Type</th>
<th align=left width=48%>Description</th>
</tr>
<tr valign=top>
<td width=31%>lAction</td>
<td width=21%>Long</td>
<td width=48%>Routing action taken by the tracing domain. Possible actions are: expanded, redirected, relayed, and rerouted.</td>
</tr>
<tr valign=top>
<td width=31%>ftArrivalTime</td>
<td width=21%>Filetime</td>
<td width=48%>Time at which the message entered the tracing domain.</td>
</tr>
<tr valign=top>
<td width=31%>ftDeferredTime</td>
<td width=21%>Filetime</td>
<td width=48%>Time at which the tracing domain released the message.</td>
</tr>
<tr valign=top>
<td width=31%>rgchADMDName[17]</td>
<td width=21%>Char</td>
<td width=48%>ADMD name of tracing domain.</td>
</tr>
<tr valign=top>
<td width=31%>rgchCountryName[4]</td>
<td width=21%>Char</td>
<td width=48%>Country name of tracing domain.</td>
</tr>
<tr valign=top>
<td width=31%>rgchPRMDId[17]</td>
<td width=21%>Char</td>
<td width=48%>PRMD Identifier of tracing domain.</td>
</tr>
<tr valign=top>
<td width=31%>rgchAttADMDName[17]</td>
<td width=21%>Char</td>
<td width=48%>Attempted domain ADMD name. Contains information if attempt to send failed and message was rerouted.</td>
</tr>
<tr valign=top>
<td width=31%>rgchAttCountryName[4]</td>
<td width=21%>Char</td>
<td width=48%>Attempted domain country name. Contains information if attempt to send failed and message was rerouted.</td>
</tr>
<tr valign=top>
<td width=31%>rgchAttPRMDId[17]</td>
<td width=21%>Char</td>
<td width=48%>Attempted domain PRMD Identifier. Contains information if attempt to send failed and message was rerouted.</td>
</tr>
</table><br>
<p>
As a minimum requirement, each time a gateway submits an incoming message to Microsoft Exchange Server, it should create a <b>TRACEENTRY</b> containing an action, arrival time, and deferred time, as well as the country code, the Administration Management Domain (ADMD), and the Private Management Domain (PRMD) for the local domain.</p>
<p>
If the foreign system supports similar trace information, the gateway can either translate the trace information or drop it when transferring outgoing messages to the foreign domain.</p>
<p>
The Microsoft Exchange Server SDK provides the utility functions listed in the following table. You can use these functions to manipulate message tracing information.</p>
<p>
<b>TRACEINFO Utility Functions</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=37%>Function</th>
<th align=left width=63%>Action</th>
</tr>
<tr valign=top>
<td width=37%><a href="function_23tx.htm"><b>HrTraceGetEntryListSize</b></a></td>
<td width=63%>Retrieves the size of <b>TRACEINFO</b> in memory, in bytes.</td>
</tr>
<tr valign=top>
<td width=37%><a href="function_9644.htm"><b>HrTraceGetEntryList</b></a></td>
<td width=63%>Retrieves the <b>TRACEINFO</b> for the given message.</td>
</tr>
<tr valign=top>
<td width=37%><a href="function_0z3o.htm"><b>HrTraceCreateEntryList</b></a></td>
<td width=63%>Creates a <b>TRACEENTRY</b> for the given message.</td>
</tr>
<tr valign=top>
<td width=37%><a href="function_2nqs.htm"><b>HrTraceAppendEntryList</b></a></td>
<td width=63%>Appends a <b>TRACEENTRY</b> to an existing <b>TRACEINFO</b>.</td>
</tr>
<tr valign=top>
<td width=37%><a href="function_9k1g.htm"><b>HrTraceSetEntryList</b></a></td>
<td width=63%>Sets the <b>TRACEINFO</b> for the given message.</td>
</tr>
</table><br>
<p>
The MAPI utility functions use the following structures.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=33%>Structure</th>
<th align=left width=67%>Description</th>
</tr>
<tr valign=top>
<td width=33%><b>TRACEENTRY</b></td>
<td width=67%>Information for one trace.</td>
</tr>
<tr valign=top>
<td width=33%><b>TRACEINFO</b></td>
<td width=67%>Array of all <b>TRACEENTRY</b>s for one message.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
