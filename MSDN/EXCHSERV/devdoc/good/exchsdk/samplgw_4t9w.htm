<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Monitoring Performance with PERFTEST</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_gdk_monitoring_performance_with_perftest"></a>Monitoring Performance with PERFTEST</h3>
<p>
PERFTEST is used to monitor the performance of a gateway. Standard counters are available, or you can add your own counters by modifying the sample code.</p>
<p>
If you want to add additional counters, you may want to modify the COUNTERDEF array in the source code. Refer to <a href="structs_1bmu.htm">COUNTERDEF</a> for more information about this structure because the counters must be added in the correct sequence.</p>
<p>
The following procedures describe how to run PERFTEST as either a standalone application or as a service of Windows NT Server.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To run PERFTEST as a standalone application</h5>
<ol>
<li>
At a command prompt, change to the \BKOFFICE\BIN directory.</li>
<li>
Verify that a gateway has been installed. See <a href="samplgw_5pyx.htm">Installing the Sample Gateway</a>. For a simple procedure for setting up and verifying a gateway, see <a href="samples1_5h7n.htm">Importing and Exporting with DIRSYNC</a>.</li>
<li>
Set up the <a href="glossary_1oon.htm#_edk_windows_nt_registry">Windows NT Registry</a> information for PERFTEST by typing the following command:<p>
<b>PERFINST /SERVICE=&lt;<i>gateway-name</i>&gt; /CLASS=PerfTestType /DLL=C:\BKOFFICE\BIN\GWPERF.DLL /OPEN=OpenGatewayPerformanceData /COLLECT= CollectGatewayPerformanceData /CLOSE=CloseGatewayPerformanceData</b>
<p>
The following new registry key is created for PERFTEST: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\PerfTestType\Performance and Linkage.
<p>
The Library value in this new registry key is configured to search for GWPERF.DLL in the \BKOFFICE\BIN directory.
</li>
<li>
Change to the BKOFFICE\SAMPLES\EXCHANGE\PERFTEST directory.</li>
<li>
Type <b>LODCTR PRFCOUNT.INI</b>. This step loads the counter information into the PERFTEST registry entry.</li>
<li>
Run PERFTEST by typing <b>PERFTEST NOTSERV <i>&lt;gateway-name&gt;</i></b><p>
An icon labeled <b>Performance Monitoring Sample</b> is displayed at this point. It indicates that PERFTEST is running as an application.
</li>
<li>
Start the Windows NT Performance Monitor and add the counters to be monitored. </li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To run PERFTEST as a service of Windows NT Server</h5>
<ol>
<li>
At a command prompt, change to the \BKOFFICE\BIN directory.</li>
<li>
Install a gateway if one is not installed. See <a href="samplgw_0rxv.htm">Sample Gateway and Applications</a> for more information. Do not use GWSETUP to install the gateway when you are using PERFTEST to monitor the gateway because GWSETUP creates objects and pointers that conflict with PERFTEST. If GWSETUP has been used to install the gateway, you should completely remove and reinstall the gateway prior to using PERFTEST. See <a href="gwsetup_8309.htm">Removing a Gateway</a> and <a href="samplgw_5pyx.htm">Installing the Sample Gateway</a>.</li>
<li>
Set up the Windows NT Registry information for PERFTEST by typing the following command:<p>
<b>PERFINST /SERVICE=&lt;<i>gateway-name</i>&gt; /CLASS=PerfTestType <br>
/DLL=c:\BKOFFICE\BIN\GWPERF.DLL <br>
/OPEN=OpenGatewayPerformanceData /COLLECT=CollectGatewayPerformanceData /CLOSE=CloseGatewayPerformanceData</b>
<p>
A new registry key is created for PERFTEST: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\<br>
PerfTestType\Performance and Linkage.
</li>
<li>
Change directory to \BKOFFICE\SAMPLES\EXCHANGE\PERFTEST</li>
<li>
Type <b>LODCTR PRFCOUNT.INI</b>.</li>
<li>
Now you can run PERFTEST by typing <b>PERFTEST</b> <b>&lt;<i>gateway-name</i>&gt;</b>.</li>
<li>
Start the Windows NT Performance Monitor and add the counters that you want to monitor. <ul>
<li>
Select <b>NT PERFMON</b> from the <b>Administrative Tools</b> menu.</li>
<li>
Click <b>Add</b> <b>Counters</b>.</li>
</ul>
</li>
<li>
Select <b>PERFTEST</b> from the <b>Object</b> drop-down combo box.</li>
<li>
Select the counter you want to monitor for the gateway.</li>
<li>
Log on to a mailbox with the Microsoft Exchange Client.</li>
<li>
Submit a message to a custom recipient associated with the gateway that you are monitoring. The message will be returned to you and the counter on Windows NT Performance Monitor will reflect the message's effect on the gateway.</li>
</ol>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
