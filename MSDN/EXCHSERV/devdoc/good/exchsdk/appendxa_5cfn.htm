<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Formatting the Secondary Files</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_formatting_the_secondary_files"></a>Formatting the Secondary Files</h2>
<p>
A secondary file is a collection of one or more sections that each contain a description of the data, followed by the actual data. A message body and its attachments are in separate sections. </p>
<p>
The offset in the primary file specifies the first section in the secondary file for messages with multiple sections. Sections are separated by blank lines. The following example shows the format of secondary files:</p>
<p>
<code>Type,Length,Encoding,Islast,Name,Position,Format<br>
Body,91,,TRUE,,,<br>
Do you want to play a game of racquetball after work tonight?<br>
<br>
Pat<br>
<br>
Body,70,,FALSE,,,<br>
I saw this short review of Microsoft Back Office products.<br>
<br>
Pat <br>
<br>
Attachment,205,,TRUE,backoffi.txt,0,<br>
Microsoft BackOffice package includes Windows NT Server, Microsoft Exchange Server, SQL Server, and System Management Server.<br>
<br>
Other,51,,TRUE,,,<br>
leslied;sallys;marck;louisej;robinh;bobbyq;gregoryc</code></p>
<p>
The following table describes the fields in the header line of secondary files.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=18%>Heading</th>
<th align=left width=38%>Description</th>
<th align=left width=44%>Values</th>
</tr>
<tr valign=top>
<td width=18%>Type  </td>
<td width=38%>Required. Type of data.</td>
<td width=44%>Body, Attachment, Schedule, Document, or Other.</td>
</tr>
<tr valign=top>
<td width=18%>Length <i> </i></td>
<td width=38%>Required. Length of data in bytes, including end-of-line characters. </td>
<td width=44%>Integer. If message is body part of a free document, the length must = 0. </td>
</tr>
<tr valign=top>
<td width=18%>Encoding</td>
<td width=38%>Reserved field.</td>
<td width=44%>Leave blank.</td>
</tr>
<tr valign=top>
<td width=18%>Islast</td>
<td width=38%>If TRUE, body or attachment is the last in the file for this message. If FALSE, the next section in file is either body or attachment for this message. </td>
<td width=44%>TRUE or FALSE.</td>
</tr>
<tr valign=top>
<td width=18%>Name</td>
<td width=38%>File name of attachment.</td>
<td width=44%>Required for sections that are attachments and documents, and ignored otherwise.</td>
</tr>
<tr valign=top>
<td width=18%>Position </td>
<td width=38%>Optional. Location, in bytes, where icon for attachment should be placed. Valid only for attachments. </td>
<td width=44%>Default is to end of the body. Required for sections that are attachments and ignored otherwise. Must be between -1 and the number of bytes in the body.</td>
</tr>
<tr valign=top>
<td width=18%>Format</td>
<td width=38%>File format of attachment.</td>
<td width=44%>None or Macbinary. Defaults to None. Required for sections that are attachments and ignored otherwise.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
