<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Flag Settings for Privileged Access</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_edk_flag_settings_for_privileged_access"></a>Flag Settings for Privileged Access</h3>
<p>
The preceding sample code contains calls to the <b>IExchangeManageStore::CreateStoreEntryID</b> and <b>IMAPISession::OpenMsgStore</b> methods. The following flags should be passed in these function calls.</p>

<h4><a name="_edk_flags_used_with_iexchangemanagestore_createstoreentryid"></a>Flags Used with IExchangeManageStore::CreateStoreEntryID</h4>
<p>
<b>OPENSTORE_USE_ADMIN_PRIVILEGE</b>  Grants temporary user rights to an application for the specified information store if the application already has Admin privilege on the information store. It allows the application to act as owner of the store, but it does not log on to the mailbox under the mailbox owner identity. Passing this flag causes a security event to be written to the event log. It is normally used in conjunction with OPENSTORE_TAKE_OWNERSHIP.</p>
<p>
<b>OPENSTORE_TAKE_OWNERSHIP</b>  Opens the store with Ownership privilege. When an application specifies this flag, it accesses the store under the identity of the store’s owner. Passing this flag causes a security event to be written to the event log. </p>

<h4><a name="_edk_flags_used_with_imapisession_openmsgstore"></a>Flags Used with IMAPISession::OpenMsgStore</h4>
<p>
<b>MDB_NO_DIALOG</b>  Prevents display of logon dialog boxes. If this flag is set, the error value MAPI_E_LOGON_FAILED is returned when logon is unsuccessful. If this flag is not set, the information store provider can prompt the user to correct a name or password, insert a disk, or perform other actions necessary to establish connection to the store. Pass this flag to avoid these prompts during an automated process.</p>
<p>
<b>MDB_NO_MAIL</b>  Indicates the information store should not be used for sending or receiving mail. The flag signals MAPI not to notify the <a href="glossary_1ood.htm#_edk_mapi_spooler">MAPI spooler</a> that this information store is being opened. </p>
<p>
<b>Important</b>  Because an active spooler can cause unexpected results in a mailbox you have opened with privileged access, it is very important to pass the MDB_NO_MAIL flag when you call <b>IMAPISession::OpenMsgStore</b>.</p>
<p>
<b>MDB_TEMPORARY</b>  Instructs MAPI that the store is not to be added to the message-store information table and that the store cannot be made permanent.  </p>
<p>
<b>MAPI_BEST_ACCESS</b>  Indicates the object should be opened with the maximum network permissions allowed for the user and the maximum client application access. For example, if the client has read/write access, the object is opened with read/write access; if the client has read-only access, the object is opened with read-only access. The client can retrieve the access level by getting the PR_ACCESS_LEVEL property.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
