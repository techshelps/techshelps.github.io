<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Accessing Messages in the MTS-IN and MTS-OUT Folders</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_gdk_accessing_messages_in_the_mts_in_and_mts_out_folders"></a>Accessing Messages in the MTS-IN and MTS-OUT Folders</h2>
<p>
To put incoming messages into the MTS-IN folder, you need to call the following MAPI methods:
<ul>
<li>
<b>IMAPIFolder::CreateMessage</b>, to create a new MAPI message that will hold the data from the incoming message.</li>
<li>
<b>IMessage::CreateAttach</b>, to hold any attachments on the incoming message.</li>
<li>
<b>IMAPIProp::OpenProperty</b>, to open various message properties that your gateway will need to modify.</li>
<li>
<b>IMAPIProp::SetProps</b>, to modify one or more property values.</li>
<li>
<b>IMessage::ModifyRecipients</b>, to modify the recipient list on the new MAPI message.</li>
<li>
<b>IMAPIProp::SaveChanges</b>, to make the above changes permanent in the new message.</li>
<li>
<b>IMessage::SubmitMessage</b>, to save the message to the folder and mark it as ready to be delivered.</li>
</ul>
<p>
To read outgoing messages from the MTS-OUT folder, you need to call the <b>IMAPIFolder::GetContentsTable</b>, to access the table of messages (MTEs) present in the folder.
<ul>
<li>
<b>IMAPITable::QueryRows </b>(or the Microsoft Exchange Server function<b> HrQueryAllRows</b>), to retrieve one or more rows from the table.</li>
<li>
<b>IMAPIContainer::OpenEntry</b>, to access a particular MTE in the folder.</li>
<li>
<b>IMessage::GetRecipientTable</b>, to find out what addresses the message attached to the MTE should be delivered to.</li>
<li>
<b>IMessage::GetAttachmentTable</b>, to find the message attached to the MTE.</li>
<li>
<b>IMAPIProp::GetProps</b>, to read the subject, message class, contents, etc., of the outgoing message.</li>
</ul>
<p>
For details about these functions, see the <i>MAPI Programmer’s Reference</i>. For examples of calling these functions, see the sample code for GWSAMPLE.C in the \BKOFFICE\SAMPLES\EXCHANGE\GWSAMPLE directory.</p>
<p>&nbsp;</p></body>
</HTML>
