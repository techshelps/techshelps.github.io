<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PROXYGEN: Generating a Proxy Address</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_gdk_proxygen_generating_a_proxy_address"></a>PROXYGEN: Generating a Proxy Address</h2>
<p>
PROXYGEN is a DLL that generates a proxy address of type EDK for the sample gateway. It creates the address from a combination of site and recipient attributes as determined by the site level proxy.</p>
<p>
PROXYGEN demonstrates the use of the following functions: </p>
<p class=indent1>
<b><u>RcInitProxies</u></b>_edk_RcInitProxies</p>
<p class=indent1>
<b><u>RcGenerateProxy</u></b>_edk_RcGenerateProxy</p>
<p class=indent1>
<b><u>RcValidateProxy</u></b>_edk_RcValidateProxy</p>
<p class=indent1>
<b><u>FreeProxy</u></b>_edk_FreeProxy</p>
<p>
To use it, you must first install the EDK address type by running the sample gateway setup program. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To build PROXYGEN</h5>
<ol>
<li>
Change to the \BKOFFICE\SAMPLES\EXCHANGE\PROXYGEN directory.</li>
<li>
Type <b>NMAKE</b>.</li>
</ol>
<p>
</p>
<p>
When you modify an existing proxy address, Microsoft Exchange Server automatically calls the proxy generation DLL to validate the changes. If the modified address contains invalid characters or other errors, Microsoft Exchange Server displays an error message and the DLL writes an error message to the Windows NT Application event log. The <b>RcValidateProxy</b> routine in PROXYGEN verifies that a manually entered proxy is valid.</p>
<p>
The PROXYGEN DLL demonstrates several features for creating and modifying proxy addresses. You can use these features or similar ones in your gateway. For complete information, see the PROXYGEN sample code. The following is a summary of PROXYGEN features:
<ul>
<li>
When the gateway is installed, the setup program installs a site address. You can insert special characters in the site address to tell PROXYGEN how to create individual proxy addresses. This feature appears in the <b>RcGenerateProxy</b> function. The <b>RcGenerateProxy </b>function creates proxy addresses based on the site proxy address string, which has the following format:<p>
EDK: <i>format</i>@domain
<p>
Domain is uninterpreted and is written exactly as is.
<p>
Format is optional; if specified it must contain only valid EDK address characters plus the following special symbols:
</li>
</ul>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=19%>%s</td>
<td width=81%>Substitute the user's surname.</td>
</tr>
<tr valign=top>
<td width=19%>%g</td>
<td width=81%>Substitute the user's given name.</td>
</tr>
<tr valign=top>
<td width=19%>%d</td>
<td width=81%>Substitute the user's display name. </td>
</tr>
<tr valign=top>
<td width=19%>%m</td>
<td width=81%>Substitute the user's mailbox (alias) name.</td>
</tr>
<tr valign=top>
<td width=19%>%%</td>
<td width=81%>Substitute a single %.</td>
</tr>
<tr valign=top>
<td width=19%>%r</td>
<td width=81%>Substitute characters within a format string. See the following paragraph for details.</td>
</tr>
</table><br>
<p class=indent1>
In all the substitutions listed in the table, spaces and illegal characters will be removed from the field before the substitution is made. If there is no format field, the site proxy address format is equivalent to:</p>
<p class=indent1>
EDK: %m@domain </p>
<p class=indent1>
Use the %r symbol to specify replacing one character with another in subsequent substitutions in the format string. For example, the format</p>
<p class=indent2>
%g%r <i>ch1 ch2</i> %s</p>
<p class=indent1>
means that all instances of the character <i>ch1</i> will be replaced by <i>ch2</i> in all surnames as the proxy addresses are generated. In this case, since the %r symbol follows %g, given names are inserted in the proxy address with no character replacements.</p>
<ul>
<li>
PROXYGEN performs automatic character translation if a name contains extended characters. In the EDK type, you can use only 7-bit ASCII characters. See the table in the <b>RcGenerateProxy</b> code that performs the translation.</li>
</ul>
<p>
</p>
<p>
You can use the path that is set up for PROXYGEN to test your own proxy generation DLL. The <b>Address Types</b> property page in the Microsoft Exchange Server Administrator program shows the display name and path of the proxy generation DLL. For testing, you can edit the proxy address path to point to your own proxy generation DLL. This way you can check if the DLL is generating the correct proxy address without having to install a new address type. </p>
<p>
If you use this method, however, your DLL must produce addresses that begin with "EDK."</p>
<p>&nbsp;</p></body>
</HTML>
