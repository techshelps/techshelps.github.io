<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing Forms into the Organization Forms Library</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_edk_installing_forms_into_the_organization_forms_library"></a>Installing Forms into the Organization Forms Library</h1>
<p>
Administrators usually install new <a href="glossary_1oo6.htm#_edk_form">forms</a> into the organization forms library if users throughout the <a href="glossary_1oof.htm#_edk_organization">organization</a> need access. You can also install forms into this library programmatically, subject to the access rights under which your program is running.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To install a form into the organization forms library</h5>
<ol>
<li>
Obtain a <a href="glossary_1ood.htm#_edk_mapi">MAPI</a> session. Do this by initializing MAPI with the <b>MAPIInitialize</b> function and logging on to a MAPI <a href="glossary_1oog.htm#_edk_profile">profile</a> with the <b>MAPILogonEx</b> function. For more information, see the first steps of <a href="infostor_6ehx.htm">Opening an Information Store</a>. To install forms, this MAPI profile needs Create permission on the organization forms library. </li>
<li>
Open the MAPI form manager interface by calling the <b>MAPIOpenFormMgr</b> function and passing a pointer to the MAPI <b>LPMAPISESSION</b> session. This call opens an <b>IMAPIFormMgr</b> interface on a forms-library provider object.</li>
<li>
Open the organization forms library by calling the MAPI <b>IMAPIFormMgr::OpenFormContainer</b> method . Pass the HFRMREG_ENTERPRISE constant for the <i>hfrmreg</i> parameter. This denotes the organization's Microsoft Exchange Server library in the <a href="glossary_1oog.htm#_edk_public_information_store">public information store</a>.<p>
When <b>IMAPIFormMgr::OpenFormContainer</b> detects HFRMREG_ENTERPRISE, it returns an interface pointer to the organization forms library. You can then call any of the MAPI-defined forms container methods. 
</li>
<li>
Install the form with a call to the <b>IMAPIFormContainer::InstallForm</b> function, passing a pointer to the name of the configuration file for the form.</li>
</ol>
<p>
The INSTFORM.EXE sample application is a command-line utility that installs or removes a Microsoft Exchange Server form. You can run it to study the installation of forms, and you can look at its source files (in particular INSTFORM.CPP), which are located in the \BKOFFICE\SAMPLES\EXCHANGE\INSTFORM directory. Some of the code from INSTFORM.CPP is reproduced here:</p>
<pre><code>hr = MAPILogonEx( 
        NULL, lpszProfile, lpszPassword, 
        MAPI_LOGON_UI|MAPI_EXTENDED|MAPI_NEW_SESSION, 
        &amp;lpMAPISession);

// Open form manager interface.
hr = MAPIOpenFormMgr( lpMAPISession, &amp;lpFormMgr);

// Open appropriate form container.
hr = lpFormMgr-&gt;OpenFormContainer( hFrmReg, lpFolder, &amp;lpFormContainer);

hr = lpFormContainer-&gt;InstallForm( NULL, ulUIFlags, UserParams.m_pszCfgFile);
 </code></pre>
<p>
For more information about MAPI form libraries, see the <i>MAPI Programmer's Reference</i>.</p>
<p>&nbsp;</p></body>
</HTML>
