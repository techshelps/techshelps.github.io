<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MBXSERV: Viewing Messages in a Mailbox</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_edk_mbxserv_viewing_messages_in_a_mailbox"></a>MBXSERV: Viewing Messages in a Mailbox</h1>
<p>
The MBXSERV sample application demonstrates how to create a <a href="glossary_1oog.htm#_edk_property_page">property page</a> attached to <a href="glossary_1ood.htm#_edk_mailbox">mailboxes</a> that allows you to view the titles of all the messages in the mailbox, using a password for security. It can be used as an example of one component in a voice mail server application. For more information on this topic, see <a href="dsignapp_3bxv.htm">How a Voice Mail Server Works</a>. </p>
<p>
MBXADMIN.DLL is an Administrator program extension that adds a property page to a mailbox's <a href="glossary_1oog.htm#_edk_property_sheet">property sheet</a>. To use it, the <a href="glossary_1oo1.htm#_edk_administrator_extension_dll">Administrator extension DLL</a> must be installed with <a href="samplgw_2pta.htm">EXTNINST: Installing an Administrator Extension</a> installation program. After installation, MBXADMIN must be attached to the mailboxes, which adds the <b>MBX Sample</b> property page to the property sheets of all the mailboxes. To view the titles of all the messages in the mailbox, a user must run the MBXSERV application and access the mailbox by typing a password. For more information about installing the extension DLL, see <a href="admin_1ai4.htm">Installing the Administrator Extension DLL</a>. For general information about Administrator extensions, see <a href="admin_4nsj.htm">Administrator Program Extensions</a>.</p>
<p>
</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To build MBXSERV </h5>
<ol>
<li>
Change to the directory containing the MBXSERV source files:<p>
\BKOFFICE\SAMPLES\EXCHANGE\MBXSERV 
</li>
<li>
Compile MBXSERV by typing <b>NMAKE</b>.</li>
<li>
Change to the directory containing the MBXADMIN.DLL Administrator extension DLL source files:<p>
\BKOFFICE\SAMPLES\EXCHANGE\MBXADMIN
</li>
<li>
Compile MBXADMIN.DLL by typing <b>NMAKE</b>.<p>
Install the Administrator extension DLL by using the compiled EXTNINST sample application found in the \EXCHSDK\BIN directory.
</li>
</ol>
<p>
</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To install MBXAdmin using EXTNINST</h5>
<ol>
<li>
Copy the Administrator extension DLL (MBXADMIN.DLL) to the appropriate ADD-INS directory on the Microsoft Exchange Server computer. Each server has a top-level shared directory called \\&lt;<i>server name</i>&gt;\ADD_INS. The directory path is composed of the path to the ADD-INS directory, a directory called MBX, and a directory whose name matches the computer type. For example:<p>
<b>CD C:\EXCHSRVR\ADD-INS</b>
<p>
<b>MD MBX</b>
<p>
<b>CD MBX</b>
<p>
<b>MD I386</b>
<p>
<b>CD I386</b>
<p>
<b>COPY C:\BKOFFICE\SAMPLES\EXCHANGE\MBXADMIN\WIN32\&lt;<i>build type</i>&gt;\MBXAdmin.DLL</b>
</li>
<li>
To use EXTNINST to install the mailbox, type a command similar to the following:<p>
<b>EXTNINST /SITEDN=/O=MICROSOFT/OU=EDKUE DISPLAY_NAME=MBX /MACHINE=I386 /NAME=MBX /EXTDLL=C:\EXCHSRVR\ADD-INS\MBX\I386\MBXADMIN.DLL /SERVER=EDKDOCS20</b>
<p>
You should receive the message:
<pre><code>Admin Extension installed successfully
 </code></pre>
</li>
<li>
Verify that the Administrator extension has been installed by checking the Add-Ins <a href="glossary_1oo3.htm#_edk_container">container</a> within the Configuration container in the Administrator program. You should see an icon for the Administrator extension DLL.</li>
<li>
Start the Administrator program using the /RAW switch. </li>
<li>
Select the Recipients directory object in the left pane, and then choose the <b>Raw Properties</b> option from the <b>File</b> menu. </li>
<li>
Check <b>All</b> in the <b>List Attributes of Type</b> box. </li>
<li>
In the <b>Object Attributes</b> list box, click the <b>Extension-Name-Inherited</b> property.</li>
<li>
In the <b>Edit Value</b> text box, type your object's name with the /NAME parameter. For example: <b>MBX</b> </li>
<li>
Click <b>Add</b> and then click <b>OK</b>.<p>
Once MBXAdmin is installed, you can view the new property page called <b>MBX Sample</b> on any mailbox property sheet. You must enter and then use a password to view the messages from any mailbox.
<p>
<img src="images/edkmbxv1.gif" border=0>
</li>
<li>
Enable a password. To do this, double-click on the mailbox containing the messages you want to view. Select the <b>MBX Sample</b> property page. Type the password in the <b>Password</b> and <b>Verify Password</b> fields. This password need not be the same as the account password.</li>
</ol>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
