<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Restoring Directory or Information Store Data</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_restoring_directory_or_information_store_data"></a>Restoring Directory or Information Store Data</h2>
<p>
Because of directory addressing constraints, a directory can be restored only to the server from which it was backed up. An information store can be restored to an alternate server. The backup application should be capable of selecting the appropriate paths to restore the files to the appropriate paths because they may have been reconfigured since the backup, or, in the case of the information store, the server may be different.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To restore data</h5>
<ol>
<li>
Shut down the service that is being restored. The directory service is MSExchangeDS, the information store is MSExchangeIS. The application can also have the user stop the services manually through the Services applet of the Windows NT Control Panel.</li>
<li>
Call <a href="function_517p.htm"><b>HrRestorePrepare</b></a> to obtain a restore context. </li>
<li>
Call <a href="function_5auq.htm"><b>HrRestoreRegister</b></a> to interlock subsequent restore operations and prevent the service from being started until you have completed the restore.</li>
<li>
Copy the files off the backup medium onto the destination server. To find out the location where the files should be restored, call <a href="function_4l4j.htm"><b>HrRestoreGetDatabaseLocations</b></a>. Match the tokens that were returned by <a href="function_0qpf.htm"><b>HrBackupGetBackupLogs</b></a> and <b>HrBackupGetDatabaseNames</b> at backup time with the tokens preceding the directories returned by <b>HrRestoreGetDatabaseLocations</b>. The programmer requires no knowledge of what type of files are backing up and where they are being restored beyond this token matching technique. For examples of the data returned by these functions, see <a href="infostor_1khf.htm">Backup File Locations</a>.</li>
<li>
Before the service starts, you must call <b>HrRestoreRegisterComplete</b> and specify the status of the restore operation. If the status is <i>not</i> successful, the service will not start until a valid database has been restored. This completes the restore operation and allows the service to start.</li>
<li>
Start the service or allow the user to start the service manually.</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
