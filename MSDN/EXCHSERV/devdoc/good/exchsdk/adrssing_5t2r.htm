<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing Addressing Objects</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_gdk_installing_addressing_objects"></a>Installing Addressing Objects</h2>
<p>
Installing the new address type for your gateway on Microsoft Exchange Server requires the creation of two objects on the server: the Address-Template object and the Addr-Type object. The Address-Template object includes the display table that describes the controls appearing on the dialog box for entering a new custom address. The display table is generated by the binary template file described in <a href="adrssing_2ctd.htm">Address Entry Template Binary Data</a>. The Addr-Type object has an attribute, Proxy-Generator-DLL, set to the file name of the proxy generation DLL. The Addr-Type object must be installed in order for the gateway to support its address type. The custom address template is optional for the gateway’s execution; however, it provides a friendly interface for the Administrator program user to create custom recipients for the foreign system.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To install a new address type</h5>
<ol>
<li>
Create the Address-Template object in the Addressing directory container.</li>
<li>
Create the Addr-Type object in the Addressing directory container.</li>
<li>
Copy the proxy generation DLL file to the Microsoft Exchange Server Address directory.</li>
</ol>
<p>
The addressing objects can be installed by using the TMPLINST.EXE and ADDRINST.EXE utilities supplied with the Microsoft Exchange Server SDK. These utilities create .CSV files necessary for batch imports to create the addressing objects.</p>
<p>
The following example uses TMPLINST.EXE to create the Address-Template object using the PROFSADT.BLT and PROFSADT.OEL files, as described in <a href="adrssing_2ctd.htm">Address Entry Template Binary Data</a>.</p>
<p>
TMPLINST /SITEDN=/o=microsoft/ou=apps-wga <br>
/DISPLAY_NAME=proftmp /NAME=PROFS Address <br>
/TYPE=PROFS /SYNTAX=c:\temp\profsadt.oel /SERVER=myserver <br>
/MESSAGE_DT=c:\temp\profspmt.blt /RECIPIENT_DT=c:\temp\profsprt.blt <br>
/ADDRESS_DT=c:\temp\profsadt.blt /LANGUAGE=409 <br>
/DATA16=profs16.hlp /DATA32=profs32.hlp /FILE=profs.hlp</p>
<p>
This operation creates the directory object and uses the information in PROFSADT.OEL and PROFSADT.BLT to fill in the address syntax and address display table attributes for the Address-Template object. An installation program does not need to copy the .OEL and .BLT files into the Microsoft Exchange Server directory on the file system.</p>
<p>
The following example uses ADDRINST to create the PROFS Addr-Type object:</p>
<p>
ADDRINST /SITEDN=/o=microsoft/ou=apps-wga <br>
/NAME=PROFS Proxy Generator /MACHINE=i386 /TYPE=PROFS <br>
/PROXYDLL=\\myserver\address\PROFS\i386\proxygen.dll <br>
/SERVER=myserver /GWPROXY=PROFS:</p>
<p>
This utility does not copy the PROXYGEN.DLL file into the appropriate place in the Microsoft Exchange Server directory. A setup program must do that separately. For the preceding example, the directory for the DLL is</p>
<p>
\MYSERVER\ADDRESS\PROFS\I386</p>
<p>
The \PROFS\I386 directory will probably not exist yet on the server; the installation program creates the directory before copying the PROXYGEN.DLL file to it.</p>
<p>
Keep in mind the following points when installing an Addr-Type object:
<ul>
<li>
The Addr-Type object needs to be installed only once on each Microsoft Exchange Server site. The address type information is available to all servers on the site.</li>
<li>
The <a href="gwgloss_0vfr.htm#_gdk_gateway_address_routing_table_gwart_">gateway address routing table (GWART)</a> must be rebuilt any time you add, change, or delete addressing information. This includes adding a new Addr-Type object and generating proxy addresses. Your setup program should rebuild the GWART if necessary, using the <a href="function_85no.htm"><b>SAD_ScRunRID</b></a> function.</li>
<li>
It is possible to install an Addr-Type object without an associated gateway. The following diagram illustrates how this might occur.</li>
</ul>
<p>
<img src="images/gpg02_05.gif" border=0></p>
<p class=indent1>
In this scenario, both the gateway and its XXX Addr-Type object are installed at site A and are associated by the GWART at site A. Address templates and a proxy generation DLL are also associated with the XXX address type at site A. Clients at site A can see in their address books that addresses of type XXX are allowed, and they can use the address templates to create addresses of type XXX. New users on site A automatically receive proxy addresses of type XXX.</p>
<p class=indent1>
The XXX gateway is not installed at site B, so there are no address entry templates and no proxy generation DLL there. However, replication occurs between the sites, and users at site B can send mail to a type XXX address. In this case, the message will be replicated at site A and sent through the gateway to the intended recipient. A problem occurs when a new user is added at site B. This user will not receive an XXX proxy address and therefore cannot receive mail from XXX addresses. You need to install the Addr-Type object at site B so that new users there will receive type XXX proxy addresses.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
