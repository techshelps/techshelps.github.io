<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Properties Set at Message Creation</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h4><a name="_edk_properties_set_at_message_creation"></a>Properties Set at Message Creation</h4>
<p>
A client application can create a message with <b>IMAPIFolder::CreateMessage</b>, set its properties with<b> IMAPIProp::SetProps</b>, and add attachments to it. It can then call <b>IMAPIProp::SaveChanges</b> to save the message to a folder, or send the message immediately by calling <b>IMessage::SubmitMessage</b>. (Calling the <b>SubmitMessage</b> method also saves changes.) This step is message submission, which requests that copies of the message be placed in the recipients’ mailboxes. </p>
<p>
If you call the <b>IMAPIFolder::CreateMessage</b> method in a folder, the message properties in the following two tables will be set automatically. This occurs even if you have not called <b>IMAPIProp::SetProps</b>, <b>IMAPIProps::DeleteProps</b>, or <b>IMessage::ModifyRecipients</b>. Some of values for these properties (such as PR_CREATOR_ENTRYID) are assigned by the information store provider, some are default values (such as PR_ACCESS_LEVEL) inherited from the folder the message was created in, and some are derived from other values. In other words, values for these properties are assigned automatically, so you need not set them explicitly.</p>
<p>
The properties in the following table are defined in the EDKMDB.H file. </p>
<p>
<b>Initial Message Properties Defined by Microsoft Exchange Server</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=55%>Property Designation</th>
<th align=left width=45%>Description</th>
</tr>
<tr valign=top>
<td width=55%><a href="props1_0s6c.htm">PR_CREATOR_ENTRYID</a></td>
<td width=45%>Contains the address book entry identifier of the user who created the message.</td>
</tr>
<tr valign=top>
<td width=55%><a href="props1_0jad.htm">PR_CREATOR_NAME</a></td>
<td width=45%>Specifies the display name of the user who created the message. </td>
</tr>
<tr valign=top>
<td width=55%><a href="props4_32n8.htm">PR_LAST_MODIFIER_ENTRYID</a></td>
<td width=45%>Specifies the entry identifier of the last person to modify the message.</td>
</tr>
<tr valign=top>
<td width=55%><a href="props4_3739.htm">PR_LAST_MODIFIER_NAME</a></td>
<td width=45%>Contains the display name of the last person to modify the message. </td>
</tr>
</table><br>
<p>
</p>
<p>
The following message properties are declared by MAPI in MAPITAGS.H. In their Microsoft Exchange Server implementation, most of these properties are read-only because they are derived or computed values.</p>
<p>
<b>Initial Message Properties Defined by MAPI</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=46%>Property Designation</th>
<th align=left width=54%>Description</th>
</tr>
<tr valign=top>
<td width=46%></td>
<td width=54%></td>
</tr>
<tr valign=top>
<td width=46%>PR_ACCESS</td>
<td width=54%>Contains a bitmask of flags indicating the operations the client application can perform on the open object. </td>
</tr>
<tr valign=top>
<td width=46%>PR_ACCESS_LEVEL</td>
<td width=54%>Contains a bitmask of flags indicating the level at which the client application can access the open object. </td>
</tr>
<tr valign=top>
<td width=46%>PR_CREATION_TIME</td>
<td width=54%>Contains the creation date and time for a message. </td>
</tr>
<tr valign=top>
<td width=46%>PR_DISPLAY_BCC</td>
<td width=54%>Contains an ASCII list of the display names of any blind copy (BCC) message recipients, each separated by a semicolon (;). </td>
</tr>
<tr valign=top>
<td width=46%>PR_DISPLAY_CC</td>
<td width=54%>Contains an ASCII list of the display names of any carbon copy (CC) message recipients, each separated by a semicolon (;).</td>
</tr>
<tr valign=top>
<td width=46%>PR_DISPLAY_TO</td>
<td width=54%>Contains an ASCII list of the display names of the primary (To) message recipients, each separated by a semicolon (;). </td>
</tr>
<tr valign=top>
<td width=46%>PR_HASATTACH</td>
<td width=54%>Contains TRUE if a message contains at least one attachment. </td>
</tr>
<tr valign=top>
<td width=46%>PR_IMPORTANCE</td>
<td width=54%>Contains a value indicating the message sender's opinion of the importance of a message. </td>
</tr>
<tr valign=top>
<td width=46%>PR_LAST_MODIFICATION_TIME</td>
<td width=54%>Contains the date and time the object was last modified.</td>
</tr>
<tr valign=top>
<td width=46%>PR_MAPPING_SIGNATURE</td>
<td width=54%>Contains the mapping signature for named properties of a particular MAPI object. </td>
</tr>
<tr valign=top>
<td width=46%>PR_MDB_PROVIDER</td>
<td width=54%>Contains a provider-defined identifier that indicates the type of information store. </td>
</tr>
<tr valign=top>
<td width=46%>PR_MESSAGE_CLASS</td>
<td width=54%>Contains a text string that identifies the sender-defined message class, such as IPM. </td>
</tr>
<tr valign=top>
<td width=46%>PR_MESSAGE_FLAGS</td>
<td width=54%>Contains a bitmask of flags indicating the current state of a message object. </td>
</tr>
<tr valign=top>
<td width=46%>PR_MESSAGE_SIZE</td>
<td width=54%>Contains the sum (in bytes) of the sizes of all properties on a message object. </td>
</tr>
<tr valign=top>
<td width=46%>PR_OBJECT_TYPE</td>
<td width=54%>Contains the type of an object. </td>
</tr>
<tr valign=top>
<td width=46%>PR_PARENT_ENTRYID</td>
<td width=54%>Contains the entry identifier of the folder containing a folder or message.</td>
</tr>
<tr valign=top>
<td width=46%>PR_SEARCH_KEY</td>
<td width=54%>Contains a binary-comparable key that identifies correlated objects for a search. </td>
</tr>
<tr valign=top>
<td width=46%>PR_SENSITIVITY</td>
<td width=54%>Contains a value indicating the message sender's opinion of the sensitivity of a message.</td>
</tr>
<tr valign=top>
<td width=46%>PR_STORE_ENTRYID</td>
<td width=54%>Contains the unique entry identifier of the information store in which an object resides. </td>
</tr>
<tr valign=top>
<td width=46%>PR_STORE_RECORD_KEY</td>
<td width=54%>Contains the unique binary-comparable identifier (record key) of the information store in which an object resides. </td>
</tr>
</table><br>
<p>
</p>
<p>
In addition to the properties listed in the preceding table, the following properties are present on a message if you call <b>IMAPIFolder::CreateMessage</b> in a public folder: PR_CONVERSATION_INDEX, and PR_REPLICA_SERVER, and PR_CONVERSATION_TOPIC. </p>
<p>
If you immediately call <b>IMAPIProp::SaveChanges</b> after creating a message, two more read-only MAPI properties are added: PR_ENTRYID and PR_RECORD_KEY.</p>
<p>&nbsp;</p></body>
</HTML>
