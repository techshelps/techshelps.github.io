<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Removing a Server Application</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_removing_a_server_application"></a>Removing a Server Application</h2>
<p>
The <b>DoRemove</b> function in GWSETUP.C removes a <a href="glossary_1oo7.htm#_edk_gateway">gateway</a> service's entire configuration. To write a custom application-removal routine, decide which steps are relevant for removing your own <a href="glossary_1ooj.htm#_edk_server_application">server application</a>. The following procedure lists these steps in the order that <b>DoRemove</b> performs them:</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To remove a server application</h5>
<ol>
<li>
Present a dialog box that lets the administrator select an application to remove. The <b>ShowChooseServiceDlg</b> function displays this type of dialog box.</li>
<li>
Determine whether the application's service is running by calling the <b>FServiceRunning</b> function. If it is running, attempt to stop the service. </li>
<li>
Remove the directory object. Call the <a href="function_9fw9.htm"><b>HrRemoveGateway</b></a> function to remove a gateway object and the <a href="function_2kj8.htm"><b>HrRemoveMailboxAgent</b></a> function to remove a mailbox agent from a given site. Both functions are defined in EXCHINST.C.</li>
<li>
Remove performance monitoring for the service by calling the <a href="function_9ar2.htm"><b>HrRemoveServicePerfMon</b></a> function. If the <i>lpfUnloadCounters</i> parameter returned from this function call is TRUE, continue with step 5. If it is FALSE, multiple instances of the application are installed. In this case, perform steps 7 and 8, and then begin again at step 1.</li>
<li>
Call the <b>FUnloadCounters</b> function to unload the counters used in performance monitoring.</li>
<li>
Remove the server application's keys from the <a href="glossary_1oon.htm#_edk_windows_nt_registry">Windows NT Registry</a>. Do this by calling the <a href="function_97g9.htm"><b>HrRemoveRegistry</b></a> function.</li>
<li>
Remove the service from service control manager of Windows NT. Do this by calling the <a href="function_34th.htm"><b>HrRemoveService</b></a> function. </li>
<li>
Delete the files belonging to the service using the <b>EDKDeleteNode </b>function.</li>
</ol>
<p>
</p>
<p>
The<b> DoRemove</b> function removes components from the local computer. Server components in the Microsoft Exchange Server <a href="glossary_1oo4.htm#_edk_directory">directory</a> must be removed in a separate step using <a href="glossary_1oo4.htm#_edk_directory_access_functions">directory access functions</a>. For example, address types and Administrator extensions are not removed because they may be needed by other applications. </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
