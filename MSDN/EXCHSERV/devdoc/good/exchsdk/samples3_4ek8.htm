<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SMBAGENT Command Syntax</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_edk_smbagent_command_syntax"></a>SMBAGENT Command Syntax</h3>
<p>
Each message submitted to SMBAGENT must contain only one command keyword, followed by the &lt;<i>topic name</i>&gt;. Commands and topic names are specified in the subject field of the message. The message body is ignored except in the case of the <b>NEW</b> and <b>POST </b>commands, where it contains information to be copied to the specified area. </p>
<p>
The maximum length of a topic used with SMBAGENT is 100 characters.  </p>
<p>
<b>Recognized SMBAGENT Commands and Actions</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=31%>Command</th>
<th align=left width=69%>SMBAGENT Actions</th>
</tr>
<tr valign=top>
<td width=31%><b>NEW</b> &lt;<i>topic name</i>&gt;<p>
[Introductory Note]</p>
</td>
<td width=69%>Creates a new topic by creating a topic <a href="glossary_1oo6.htm#_edk_folder">folder</a> and copying the message body into the folder's associated data area. This hidden message becomes the topic's introduction and will contain the complete list of topic subscribers.<p>
</p>
</td>
</tr>
<tr valign=top>
<td width=31%><b>JOIN</b> &lt;<i>topic name</i>&gt;</td>
<td width=69%>Adds the sender's e-mail address to the subscriber list of the topic and sends the introductory note back as part of the confirmation message.</td>
</tr>
<tr valign=top>
<td width=31%><b>POST</b> &lt;<i>topic name</i>&gt;<p>
[Posting]</p>
</td>
<td width=69%>Verifies the subscriber against the subscriber-list and, if verified, saves the posting (entire message body) as a message in the topic folder. This posting is then redistributed to the current subscribers of the topic.</td>
</tr>
<tr valign=top>
<td width=31%><b>LEAVE</b> &lt;<i>topic name</i>&gt;</td>
<td width=69%>Deletes the sender from the current subscriber list of the specified topic and, if the last subscriber, deletes the topic.</td>
</tr>
<tr valign=top>
<td width=31%><b>INTRO</b> &lt;<i>topic name</i>&gt;</td>
<td width=69%>Returns the introductory message for the specified topic.</td>
</tr>
<tr valign=top>
<td width=31%><b>TOPICS</b></td>
<td width=69%>Returns a list of all topics to which the sender is currently subscribed.</td>
</tr>
<tr valign=top>
<td width=31%><b>MEMBERS</b> &lt;<i>topic name</i>&gt;</td>
<td width=69%>Returns a list of the member for the specified topic.</td>
</tr>
</table><br>
<p>
SMBAGENT confirms each message by returning the requested information with an explicit confirmation message to the sender. In cases where SMBAGENT cannot return the information, an error message is returned to the sender.</p>
<p>
<b>Confirmation Messages</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=22%>Action</th>
<th align=left width=78%>Response</th>
</tr>
<tr valign=top>
<td width=22%><b>NEW</b></td>
<td width=78%>The requested topic has been created.</td>
</tr>
<tr valign=top>
<td width=22%><b>JOIN</b></td>
<td width=78%>You have been enlisted in the requested topic. Attached is the introduction message.</td>
</tr>
<tr valign=top>
<td width=22%><b>POST</b></td>
<td width=78%>The message has been successfully posted for the requested topic.</td>
</tr>
<tr valign=top>
<td width=22%><b>INTRO</b></td>
<td width=78%>Attached is the introduction for the requested topic.</td>
</tr>
<tr valign=top>
<td width=22%><b>LEAVE</b></td>
<td width=78%>You have been removed from the subscriber list for the requested topic.</td>
</tr>
<tr valign=top>
<td width=22%><b>TOPICS</b></td>
<td width=78%>The message body contains a list of all topics.</td>
</tr>
<tr valign=top>
<td width=22%><b>MEMBERS</b></td>
<td width=78%>The message body contains the membership for the requested topic.</td>
</tr>
</table><br>
<p>
For all messages, the original message is included at the top of each confirmation message. An additional message (the topic introduction) is attached at the end of the Join and Intro confirmation messages. Error messages contain only one attachment, the original message, at the top of the message.</p>
<p>
<b>Error Messages from SMBAGENT Commands</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=22%>Error type</th>
<th align=left width=78%>Error Message</th>
</tr>
<tr valign=top>
<td width=22%><b>No command</b></td>
<td width=78%>ERROR: Missing the command keyword.</td>
</tr>
<tr valign=top>
<td width=22%><b>Bad command</b></td>
<td width=78%>ERROR: Unrecognized command keyword.</td>
</tr>
<tr valign=top>
<td width=22%><b>Command only</b></td>
<td width=78%>ERROR: Missing the topic name.</td>
</tr>
<tr valign=top>
<td width=22%><b>Create attempt</b></td>
<td width=78%>ERROR: The topic already exists.</td>
</tr>
<tr valign=top>
<td width=22%><b>Nonexistent</b></td>
<td width=78%>ERROR: The topic does not exist.</td>
</tr>
<tr valign=top>
<td width=22%><b>Nonsubscriber</b></td>
<td width=78%>ERROR: You are not a subscriber of the specified topic.</td>
</tr>
<tr valign=top>
<td width=22%><b>Join attempt</b></td>
<td width=78%>ERROR: You are already a subscriber of the specified topic.</td>
</tr>
<tr valign=top>
<td width=22%><b>Corrupt topic</b></td>
<td width=78%>ERROR: Can't open the topic folder. (May be missing associated data.)</td>
</tr>
<tr valign=top>
<td width=22%><b>Topic too long</b></td>
<td width=78%>ERROR: Topic name too long. (Topic names must be less than 100 characters.)</td>
</tr>
<tr valign=top>
<td width=22%><b>Init Failure</b></td>
<td width=78%>ERROR: Can't initialize the root topic folder. Contact your administrator.</td>
</tr>
<tr valign=top>
<td width=22%><b>General Error</b></td>
<td width=78%>ERROR: General Sample Mailbox Agent Error. Contact your administrator.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
