<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Connecting the Debugger to a Running Service</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_connecting_the_debugger_to_a_running_service"></a>Connecting the Debugger to a Running Service</h2>
<p>
Running your service as a console application will not be useful if problems appear only when the application is run as a <a href="glossary_1ooj.htm#_edk_service">service</a>. In this case, the best way to debug it is to start the application as a service and attach to the Visual C++ debugger while the service is running. To do this, start the service, obtain the process identifier, and then connect the debugger to the running process.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To find the process identifier and connect to the Visual C++ debugger</h5>
<ol>
<li>
Install PVIEW.EXE from the <i>Windows NT Resource Kit</i>. <p>
<b>Caution</b>  This utility is not identical with the utility of the same name distributed with Microsoft Visual C++ and the Platform SDK. It is an extended version with more functionality. The correct version displays the window title <b>Process Explode</b>, rather than <b>Process Viewer</b>.
</li>
<li>
Start the service to be debugged. The service must be running before you can find its process identifier.</li>
<li>
Start a command prompt or open an existing command prompt. Be sure that it is the only command prompt currently active.</li>
<li>
Change directory to the installed location of PVIEW.EXE.</li>
<li>
Type <b>PVIEW</b>.</li>
<li>
In the drop-down list box near the top left of the PVIEW screen, find and select the process IDENTIFIER corresponding to CMD.EXE. </li>
<li>
In the <b>PVIEW</b> dialog box, select <b>Token</b>. Click <b>Process</b>.</li>
<li>
In <b>Privileges</b>, move <b>SetDebugPrivilege</b> from the <b>Disabled</b> box to the <b>Enabled</b> box. Click <b>OK</b>.</li>
<li>
Connect Visual C++ to the running service. Note that when you use the process identifier from the Windows NT Server version of PVIEW.EXE, the process identifier is in decimal not hexadecimal. Start Visual C++ with the command line:<p>
<b>START MSDEV /P nnn</b>
<p>
where nnn is the process identifier in decimal or hexadecimal notation.
</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
