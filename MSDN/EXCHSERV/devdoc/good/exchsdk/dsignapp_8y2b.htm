<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using WINWRAP Functions</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_edk_using_winwrap_functions"></a>Using WINWRAP Functions</h3>
<p>
The WINWRAP library (WINWRAP.LIB, with the WINWRAP.H header file) contains functions used to create a service from a Windows application without writing your own <b>WinMain</b> function and window message loop. The resulting application will be a Windows NT Server (32-bit) service.</p>
<p>
WINWRAP defines a <b>WinMain</b> function that performs the following tasks:
<ul>
<li>
Optionally creates a minimized service application icon on the desktop. To implement this function, pass NOTSERV and the name of the service from the <a href="glossary_1oon.htm#_edk_windows_nt_registry">Windows NT Registry</a>.</li>
<li>
Creates an <i>hServiceStopEvent </i>event object used to signal a shutdown of the service. This event object is initialized to FALSE (not signaled). You can get a copy of this event handle by calling the <b>GetServiceStopEvent</b> function.</li>
<li>
Calls <b>HrServiceStartup </b>if the minimized window and <i>hServiceStopEvent </i>are created successfully. Otherwise it terminates the program.</li>
<li>
Creates a new thread to run <b>ServiceMain</b> if <b>HrServiceStartup</b> returns TRUE.</li>
<li>
Processes messages with the message loop.</li>
<li>
Signals the <i>hServiceStopEvent </i>event object when the service is stopped or <b>Close</b> is selected from the system menu of the minimized service application icon.</li>
</ul>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
