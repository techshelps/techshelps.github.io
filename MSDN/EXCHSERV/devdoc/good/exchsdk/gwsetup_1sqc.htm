<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing an Admin-Extension Object</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_gdk_installing_an_admin_extension_object"></a>Installing an Admin-Extension Object</h2>
<p>
If your gateway uses custom property sheets to present data to administrators, its setup program must install them. This means that it must install the Admin-Extension object in the directory and copy the Administrator extension DLL and any other necessary files to specific locations on the server. For information about copying files, see <a href="gwsetup_55wr.htm">Copying Files Onto Disk</a>.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To install an Admin-Extension object</h5>
<ol>
<li>
Verify whether the Admin-Extension object already exists in the directory, using MAPI functions or the <a href="function_1cac.htm"><b>BatchExport</b></a> function. See <a href="directry_28zd.htm">Finding an Object in the Directory</a>.</li>
<li>
If the Admin-Extension object does not exist, skip to step 4. If the object does exist, check its version. This is a multistep procedure that uses calls to the <a href="function_14rz.htm"><b>HrGetFileVersionInfo</b></a>, <a href="function_49yr.htm"><b>HrAdminExtensionExists</b></a>, and <a href="function_1zxq.htm"><b>HrGetAdminExtensionVersion</b></a><b> </b>functions and to the Win32 <b>VerQueryValue</b> function.</li>
<li>
If the installed Admin-Extension object is newer than the one to be installed, use a dialog box to ask the user whether to overwrite the installed object with the older one on the distribution medium. If the user answers Yes, proceed with step 4. If the user answers No, end the installation of this Admin-Extension object. If other Admin-Extension objects need to be installed, begin again at step 1.</li>
<li>
Call GUIDGEN.EXE to generate an extension name, or make up a unique extension name for the Admin-Extension object.</li>
<li>
If there is already an Admin-Extension object with the same name as the one you are installing, remove the installed one by calling the <a href="function_5ovi.htm"><b>HrRemoveAdminExtension</b></a><b> </b>function and passing the extension name of the Admin-Extension object.</li>
<li>
Copy the files associated with the Admin-Extension object to the Microsoft Exchange Server computer. See <a href="gwsetup_6agj.htm">Files Used with Directory Objects</a>.</li>
<li>
Create the new Admin-Extension object with the <a href="function_1v1w.htm"><b>BatchImport</b></a> function or <a href="function_1q79.htm"><b>DAPIWrite</b></a> function. Use the GUID created in step 4 for the extension name of the object. If other Admin-Extension objects need to be installed, begin again at step 1.</li>
</ol>
<p>
For sample code that performs these steps, see the GWSETUP.C file in the \BKOFFICE\SAMPLES\EXCHANGE\GWSETUP directory.</p>
<p>
For general information about working with Administrator extensions, see <a href="admin_4nsj.htm">Administrator Program Extensions</a>. For information about setting the attribute values of the Extension-Data attribute, see <a href="setups_59b9.htm">Initializing the Extension-Data Attribute</a>.</p>
<p>&nbsp;</p></body>
</HTML>
