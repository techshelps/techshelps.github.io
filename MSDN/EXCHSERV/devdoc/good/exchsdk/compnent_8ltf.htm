<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Relationship to MAPI Service Providers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_edk_relationship_to_mapi_service_providers"></a>Relationship to MAPI Service Providers</h1>
<p>
When Microsoft Exchange Server sends a message, it relies on the <a href="glossary_1ood.htm#_edk_mapi">MAPI</a> subsystem to direct client requests to one or more transport-service providers. Windows DLLs serve as drivers for each transport provider. They also provide the interface between the <a href="glossary_1ood.htm#_edk_mapi_spooler">MAPI spooler</a> and the underlying messaging system or services. </p>
<p>
MAPI defines three types of service providers:
<ul>
<li>
<b>Message store providers</b>  Supply message storage, organization, and retrieval facilities for a messaging system.</li>
<li>
<b>Address book providers</b>  Supply message addressing and distribution list facilities to the messaging client.</li>
<li>
<b>Messaging transport providers</b>  Move messages between messaging clients.</li>
</ul>
<p>
When a message is sent from a client application, MAPI.DLL responds to the common mail call (CMC) or MAPI call. MAPI then routes the messages to the appropriate message store and address book service provider. If a particular message is marked for sending, the message spooler checks the message’s address to determine which transport provider must be used to send the message. Depending on the designated message recipient, the message spooler may call upon more than one transport provider.</p>
<p>
The spooler performs other message-management functions. It directs inbound messages to a message store and handles messages that are undeliverable because no transport provider can carry them. The spooler also provides an important store-and-forward function. The spooler holds the message in a store if the required messaging service is currently unavailable. When MAPI reestablishes connection to that messaging service, the spooler automatically forwards the message to its destination. </p>
<p>
The Microsoft Exchange server <a href="glossary_1oo9.htm#_edk_information_store">information store</a> offers more functionality than many other MAPI message stores. For instance, <a href="glossary_1ooi.htm#_edk_replication">replication</a> services are part of the Microsoft Exchange server information store. The replicated storage model allows the Microsoft Exchange server information store to distribute information within an <a href="glossary_1oof.htm#_edk_organization">organization</a> without requiring users to know the location of the <a href="glossary_1oo6.htm#_edk_folder">folders</a> containing the information. </p>
<p>&nbsp;</p></body>
</HTML>
