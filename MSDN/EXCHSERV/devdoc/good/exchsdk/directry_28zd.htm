<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Finding an Object in the Directory</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_finding_an_object_in_the_directory"></a>Finding an Object in the Directory</h2>
<p>
To find an <a href="glossary_1oof.htm#_edk_object">object</a> in the <a href="glossary_1oo4.htm#_edk_directory">directory</a>, you can either use the <a href="function_1q79.htm"><b>DAPIWrite</b></a> or <a href="function_1v1w.htm"><b>BatchImport</b></a> <a href="glossary_1oo4.htm#_edk_directory_access_functions">directory access function</a>, or you can use the MAPI address book interface.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To add a directory object using DAPIWrite</h5>
<p class=indent1>
Call the <b>DAPIWrite</b> directory access function. Pass DAPI_WRITE_CREATE in the <b>dwFlags</b> parameter to indicate you want to create an object. (If the object already exists, the call to <b>DAPIWrite</b> fails.) In the <b>pAttributes</b> and <b>pValues</b> parameters, pass pointers to <a href="structs_7n5l.htm"><b>DAPI_ENTRY</b></a> structures that contain the names of attributes to be written to the directory and the values for those attributes, respectively. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To add a directory object using BatchImport</h5>
<p class=indent1>
Call the <b>BatchImport</b> directory access function and specify an import file in the <b>pszImportFile</b> member of the <a href="structs_5k1f.htm"><b>BIMPORT_PARMS</b></a> structure.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To find a directory object using MAPI functions</h5>
<ol>
<li>
<a href="directry_586s.htm">Find the Global Address List</a>. </li>
<li>
Call <b>IMAPITable::Restrict</b> on the Global Address List. To do this, you first build a restriction structure, specifying the properties you know about the object you want to find. You could, for example, include the Display-Name of the object in this restriction structure. This call returns a handle to a table, and an <b>IMAPITable</b> interface. </li>
<li>
Call <b>IMAPITable::FindRows</b> to find the specific row representing the object you want to find. The columns in the table correspond to the properties of the object, one of which is its entry identifier. You can then read this entry identifier and use it later to open the object.</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
