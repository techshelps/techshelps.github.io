<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Profile through MAPI</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_creating_a_profile_through_mapi"></a>Creating a Profile through MAPI</h2>
<p>
This quick start procedure explains how to tailor profiles created to work with Microsoft Exchange Server. It is based on information about creating and configuring MAPI profiles in the <i>Microsoft Exchange Client Extensions Programmer's Reference</i>. </p>
<h4>Design Tasks</h4>
<p>
In addition to the design tasks described in <b>Creating and Configuring a Profile</b> in the <i>MAPI Programmer's Reference</i>, you need to configure your new profile to be able to communicate with Microsoft Exchange Server. To do this, you need to know the name of the Home-Server and the mailbox name of your application. You also need to know whether the application for which the profile is being created will run as a service of Windows NT. </p>
<h4>Implementation Tasks</h4>
<p>
Follow the steps in <b>Creating and Configuring a Profile</b> in the <i>MAPI Programmer's Reference</i> until you reach the step in which the MAPI <b>IMsgServiceAdmin::ConfigureMsgService</b> method is called. In this function call, specify the following information in the <i>lpProps</i> parameter. This parameter is a pointer to an <b>SPropValue</b> structure containing the values of the properties to display to the user in the property sheet.
<ul>
<li>
Home Server of the application's mailbox. Use the property tag PR_PROFILE_HOME_SERVER. This property is defined in EDKMDB.H.</li>
<li>
Name of the application's mailbox, using the property tag PR_PROFILE_MAILBOX. This property is defined in EDKMDB.H.</li>
<li>
If the application is to run as a service, set the profile property PR_CONVERSION_PROHIBITED (in MAPITAGS.H) to TRUE. Doing so keeps MAPI from displaying dialog boxes — in particular the <b>Enter Password</b> dialog box — at times when they cannot be responded to, such as when your application must run unattended. (Windows NT services, for example, are an important class of unattended applications.)</li>
</ul>
<p>
After this, finish the remaining steps in <b>Creating and Configuring a Profile</b>. </p>
<h4>About Sample Source Code</h4>
<p>
None available at this time.</p>
<p>&nbsp;</p></body>
</HTML>
