<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Handling Message Classes</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_gdk_handling_message_classes"></a>Handling Message Classes</h1>
<p>
A message’s <a href="gwgloss_0vfx.htm#_gdk_message_class_gly">message class</a> tells a messaging application which properties a message contains, the type of information the message conveys, and how the message can be handled. Message classes are identified by the MAPI property PR_MESSAGE_CLASS on the message, and each message class has an associated set of properties. You can also create new message properties to meet your gateway’s requirements.</p>
<p>
When Microsoft Exchange Server delivers a message to a gateway’s MTS-OUT folder, it encloses the message’s message class string in the message class string of the message transfer envelope (MTE). Gateways must always be able to handle the following message classes. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Message class</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%>ENVELOPE.{Message Class}</td>
<td width=52%>The MTE that contains the message. The standard message class enclosed in the MTE is IPM.NOTE.</td>
</tr>
<tr valign=top>
<td width=48%>REPORT.{Message Class}.NDR</td>
<td width=52%>Nondelivery report.</td>
</tr>
<tr valign=top>
<td width=48%>REPORT.{Message Class}.DR</td>
<td width=52%>Delivery report.</td>
</tr>
<tr valign=top>
<td width=48%>REPORT.{Message Class}.IPNRN</td>
<td width=52%>Interpersonal note receipt notification.</td>
</tr>
<tr valign=top>
<td width=48%>REPORT.{Message Class}.IPNNRN</td>
<td width=52%>Interpersonal note nonreceipt notification.</td>
</tr>
</table><br>
<p>
Handling a message class means being able to convert outgoing messages into an appropriate format when the foreign system has an analagous message class, and converting incoming messages to an appropriate MAPI message class. It also means being able to generate the various REPORT message classes when an incoming or outgoing message requires them.</p>
<p>
The following figure shows an MTE and its embedded message. Note that the MTE recipient table contains the recipient address in Microsoft Exchange Server format, while the recipient table for the message contains it in SMTP format.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To deliver a report about an outgoing message</h5>
<ol>
<li>
The gateway creates the report message.</li>
<li>
The gateway places the report message in its MTS-IN folder.</li>
<li>
Microsoft Exchange Server delivers it to the recipient.</li>
</ol>
<p>
The details of delivering reports concerning inbound messages are clearly dependant on the foreign system’s requirements for reports.</p>
<p>&nbsp;</p></body>
</HTML>
