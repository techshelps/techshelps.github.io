<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MAPI Recipient Property</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_gdk_mapi_recipient_property"></a>MAPI Recipient Property</h3>
<p>
A gateway uses the MAPI-Recipient property (PR_SEND_RICH_INFO) to determine whether to backbone an individual message to a given recipient. The PR_SEND_RICH_INFO property is exposed in the recipient table of a message and denotes whether a recipient has a MAPI-capable system. If this property is TRUE for a recipient, the gateway should encapsulate Microsoft Exchange Server special properties in messages being backboned to that recipient.</p>
<h4>Setting the Property</h4>
<p>
The originator of a message can set whether a recipient is MAPI-capable on individual messages. This feature must be designed into the Addr-Type object and associated address entry template that you provide with your gateway. If the property is present on a recipient in a message, it will be stored in the <a href="gwgloss_0vg0.htm#_gdk_personal_address_book">personal address book</a> (PAB) with an address. This MAPI-Recipient property is set in different ways for different object types, as described in the following sections.</p>
<h4>Microsoft Exchange Server Directory Object</h4>
<p>
The MAPI-Recipient attribute on the recipient object in the Microsoft Exchange Server directory is set by default to TRUE for <a href="gwgloss_0vfx.htm#_gdk_mailbox">mailbox</a> objects and FALSE for <a href="gwgloss_0vfn.htm#_gdk_custom_recipient">custom recipient</a> objects. The administrator can change the setting in the advanced <a href="gwgloss_0vg0.htm#_gdk_property_page">property page</a> for a particular user. This enables the administrator to specify that a particular recipient in a <a href="gwgloss_0vfq.htm#_gdk_foreign_system">foreign system</a> uses a MAPI-based client and that messages to that recipient should be encapsulated.</p>
<p>
If <a href="glossary_1oo4.htm#_edk_directory_replication">directory replication</a> is performed within an <a href="gwgloss_0vfz.htm#_gdk_organization">organization</a>, you can also use this property to identify users who are in another <a href="gwgloss_0vg3.htm#_gdk_site">site</a> in the same organization. They are represented as mailbox objects in the <a href="gwgloss_0vfo.htm#_gdk_directory">directory</a> and will have the property set to TRUE by default.</p>
<h4>Custom Recipient Object</h4>
<p>
The directory of another Microsoft Exchange Server organization can be imported to the organization on which the gateway is configured. In this case, the mailbox objects in the original organization become custom recipient objects in the gateway’s organization. The MAPI-Recipient property of each original mailbox object retains its value of TRUE as a custom recipient object. The gateway can thus use the MAPI-Recipient property to determine whether messages to a recipient need to be backboned.</p>
<h4>Originator</h4>
<p>
The MAPI-Recipient property may also be present on the originator of a message. A gateway should check for this and transfer the property to the Microsoft Exchange Server if it is present because the property will be needed if a recipient replies to a message and the gateway needs to return the reply to the originator.</p>
<p>&nbsp;</p></body>
</HTML>
