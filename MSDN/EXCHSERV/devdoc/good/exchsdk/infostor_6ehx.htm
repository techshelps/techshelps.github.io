<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Opening an Information Store</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_opening_an_information_store"></a>Opening an Information Store</h2>
<p>
An application that needs to access an <a href="glossary_1oo9.htm#_edk_information_store">information store</a> must first open it. This action serves as the basis for opening <a href="glossary_1oog.htm#_edk_public_information_store">public information stores</a>, working with <a href="glossary_1oo6.htm#_edk_folder">folders</a> and messages, and other related tasks.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To open an information store</h5>
<ol>
<li>
Initialize <a href="glossary_1ood.htm#_edk_mapi">MAPI</a>, using the <b>MAPIInitialize</b> function. This step loads the MAPI DLLs and sets up entry points into them so that your application can call MAPI functions and methods.</li>
<li>
Log on to a MAPI <a href="glossary_1oog.htm#_edk_profile">profile</a>, using the <b>MAPILogonEx</b> function. This function call returns an LPSESSION pointer to an <b>IMAPISession</b> object (also know as a session handle). The MAPI profile contains information on <a href="glossary_1ooj.htm#_edk_service">services</a>, each of which implements one information store. One of the information stores for the profile is its default information store, which is often the information store you want your application to open.</li>
<li>
Select an information store to open. To open the default information store, call the <b>HrMAPIFindDefaultMsgStore</b> function, passing the session handle. This function call returns the entry identifier of the default information store. To select a different information store, see <a href="infostor_9s6d.htm">Locating an Information Store</a>.</li>
<li>
Open the information store by passing its entry identifier in a call to the <b>IMAPISession::OpenMsgStore</b> method. This call creates the information store object (an LPMDB) and returns a pointer to it. </li>
</ol>
<p>
<b>Note</b>  When making multithreaded <b>IMAPISession::OpenMsgStore</b> calls, the MDB_NO_DIALOG flag should be set.</p>
<p>&nbsp;</p></body>
</HTML>
