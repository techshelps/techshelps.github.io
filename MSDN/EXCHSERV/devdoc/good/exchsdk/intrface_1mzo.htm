<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IExchangeManageStore::CreateStoreEntryID</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_iexchangemanagestore_createstoreentryid"></a>IExchangeManageStore::CreateStoreEntryID</h2>
<p>
The <b>CreateStoreEntryID</b> method allows applications or services that run with Administrator privileges to manage multiple mailboxes.</p>
<pre><code><b>HRESULT CreateStoreEntryID(
  LPTSTR</b><i>&nbsp;lpszMsgStoreDN</i><b>, </b>
<b>  LPTSTR</b><i>&nbsp;lpszMailboxDN</i><b>,  </b>
<b>  ULONG</b><i>&nbsp;ulFlags</i><b>,         </b>
<b>  ULONG&nbsp;*</b><i>&nbsp;lpcbEntryID</i><b>,   </b>
<b>  LPRENTRYID&nbsp;*</b><i>&nbsp;lppEntryID</i>   
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszMsgStoreDN</i></dt>
<dd>
Input parameter. Specifies the distinguished name of the information store where the mailbox is located. For example:
<pre><code>/o=ORG/ou=SITE/cn=Configuration/cn=Servers/cn=ThisServer
/cn=Microsoft Private MDB</code></pre>
</dd>
</dl>
<p>

<dl>
<dt>
<i>lpszMailboxDN</i></dt>
<dd>
Input parameter. Specifies the distinguished name of the mailbox your service is attempting to access.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
Input parameter. Defined values that control what gets opened. Use the bitwise OR operator (|) to enable multiple operations:
<dl>
<dt>
OPENSTORE _HOME_LOGON</dt>
<dd>
Opens the home logon of the user's information store. Should be used when a separate logon to the user's information store is required. For example, if your application tracks the Read status of messages in a public folder on a per-user basis, it must logon to the user's mailbox in addition to the public folder to mark certain items as Read.</dd>
<dt>
OPENSTORE _OVERRIDE_HOME_MDB</dt>
<dd>
Ignores the current home information store for the user. Use OPENSTORE_OVERRIDE_HOME_MDB to implement methods that move a mailbox or copy a mailbox to a server other than the home server of the user. You cannot create multiple mailboxes on different servers for a single user, unless you specify this flag.</dd>
<dt>
OPENSTORE_PUBLIC</dt>
<dd>
Opens the public information store.</dd>
<dt>
OPENSTORE _TAKE_OWNERSHIP</dt>
<dd>
Opens the information store as the owner of the store, using the identity of the owner of the store. Posts a security event to the event log.</dd>
<dt>
OPENSTORE _USE_ADMIN_PRIVILEGE</dt>
<dd>
Opens the information store of another user, if you have administration rights on the other information store. Allows your application to own the information store while it's running, but does not log you on the mailbox under the identity of the owner of the mailbox. Posts a security event to the event log. OPENSTORE_USE_ADMIN_PRIVILEGE is normally used in conjunction with OPENSTORE_TAKE_OWNERSHIP.</dd>
</dl>
</dd>
<dt>
<i>lpcbEntryID</i></dt>
<dd>
Output parameter. The number of bytes returned in the entry identifier that is pointed to by <i>lppEntryID</i>.</dd>
<dt>
<i>lppEntryID</i></dt>
<dd>
Output parameter. A pointer to the entry identifier.

<p>
<b>Note</b>  If a user can use your application to browse their own folders, you must set the MDB_TEMPORARY and MDB_NO_MAIL bits in the <i>ulFlags</i> parameter to the MAPI <b>IMAPISession::OpenMsgStore</b> method.

</dd>
</dl>
<h4>Return Values</h4>
<p>
See <a href="function_3odv.htm">Return Values</a>.</p>
<h4>Remarks</h4>
<p>
This method creates and returns an entry identifier that can be used to access a server mailbox using the MAPI <b>IMAPISession::OpenMsgStore</b> method. For more information, see the <i>MAPI Programmer's Reference</i>.</p>
<p>
In addition, this method formats the entry identifier and does not access the information store or require any resources on the server. As a result, this method call is a relatively inexpensive operation. Your application should free the entry identifier after it has finished using it.</p>
<h4>See Also</h4>
<p>
<a href="intrface_6f6t.htm"><b>IExchangeManageStore</b></a></p>
<p>&nbsp;</p></body>
</HTML>
