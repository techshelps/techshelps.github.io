<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DIRSYNC Registry and Command-Line Flags</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_dirsync_registry_and_command_line_flags"></a>DIRSYNC Registry and Command-Line Flags</h2>
<p>
Most DIRSYNC command-line flags correspond to values in the <a href="glossary_1oon.htm#_edk_windows_nt_registry">Windows NT Registry</a>. When an instance is selected, the key values found in the registry are used to perform the DIRSYNC function. Command-line parameters override the registry (instance) values. Command-line flags can also be used to change the registry values if the /SET flag is used. The following table shows the corresponding registry values for DIRSYNC command-line flags. Any value listed as mandatory is required and can be supplied either from the registry or on a command line. Values listed as optional are not required and must be supplied from the registry.</p>
<p>
The following command-line flags can be stored as part of the Windows NT Registry key. This key has the following path: HKEY_LOCAL_MACHINE\SOFTWARE\MS Exchange SDK Samples\DIRSYNC\&lt;<i>Instance</i>&gt; </p>
<p>
</p>
<p>
<b>Command-Line Flags Corresponding to the Instance Registry Key </b></p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=20%>Key Value</th>
<th align=left width=27%>Command-Line Flag</th>
<th align=left width=53%>Setting</th>
</tr>
<tr valign=top>
<td width=20%>Basepoint</td>
<td width=27%><b>/BASEPOINT</b>=</td>
<td width=53%>Mandatory. <a href="glossary_1oo4.htm#_edk_distinguished_name_dn_">Distinguished name (DN)</a> of place in <a href="glossary_1oo4.htm#_edk_directory_information_tree_dit_">directory information tree (DIT)</a> from which to start export—usually the DN of the Microsoft Exchange Server <a href="glossary_1ooj.htm#_edk_site">site</a>. Example: /o=Organization/ou=Site.</td>
</tr>
<tr valign=top>
<td width=20%>Container</td>
<td width=27%><b>/CONTAINER=</b></td>
<td width=53%>Mandatory. <a href="glossary_1ooi.htm#_edk_relative_distinguished_name_rdn_">Relative distinguished name (RDN)</a> of <a href="glossary_1oo3.htm#_edk_container">container</a> below the Basepoint from which to start the export. For example: Recipients.</td>
</tr>
<tr valign=top>
<td width=20%>DSA</td>
<td width=27%><b>/DSA=</b></td>
<td width=53%>Mandatory. <a href="glossary_1oo4.htm#_edk_directory_service_agent_dsa_">Directory service agent (DSA)</a> to which DIRSYNC should connect for import or export. Usually same as Microsoft Exchange Server name.</td>
</tr>
<tr valign=top>
<td width=20%>Export File</td>
<td width=27%><b>/EXPFILE=</b></td>
<td width=53%>Mandatory for export. Fully qualified name of file to which export information is written.</td>
</tr>
<tr valign=top>
<td width=20%>Export List</td>
<td width=27%><b>/EXPLIST=</b></td>
<td width=53%>Optional. Schema attributes to be exported, expressed as a comma-separated list. Example: Obj-Class,Common-Name,Display-Name. If this flag is not specified, only the DN for an object is exported.</td>
</tr>
<tr valign=top>
<td width=20%>Full Export</td>
<td width=27%><b>/EXPFULL</b><p>
<b>/NOEXPFULL</b></p>
</td>
<td width=53%>Optional. Boolean flag indicating that the entire set of recipients should be exported, regardless of when objects were last changed.<br>
/NOEXPFULL = Exports changed objects (default)<br>
/EXPFULL = Exports all objects</td>
</tr>
<tr valign=top>
<td width=20%>Home Server</td>
<td width=27%><b>/HOMESERVER=</b></td>
<td width=53%>Optional. Specifies the default server to which imported mailbox information is to be added.</td>
</tr>
<tr valign=top>
<td width=20%>Import File</td>
<td width=27%><b>/IMPFILE=</b></td>
<td width=53%>Mandatory for import. Fully qualified name of file from which import information is read.</td>
</tr>
<tr valign=top>
<td width=20%>MV Append</td>
<td width=27%><b>/MVAPPEND</b><p>
<b>/NOMVAPPEND</b></p>
</td>
<td width=53%>Optional. Boolean flag indicating that newly imported values for multivalued properties are to be appended to the existing properties.<p>
/NOMVAPPEND = Overwrites existing multivalued properties with new values. Default,</p>
<p>
/MVAPPEND = Appends new multivalued properties to existing ones.</p>
</td>
</tr>
<tr valign=top>
<td width=20%>NT Create</td>
<td width=27%><b>/NTCREATE</b><p>
<b>/NONTCREATE</b></p>
</td>
<td width=53%>Optional. /NTCREATE creates a new Windows NT account for each added mailbox. If the Assoc-NT-Account attribute is specified, then that name is used. Otherwise, a default name is generated. The password is the same as the account name, padded with x if necessary to bring the length to the minimum required by the system. If no domain is given, the logon domain is used. /NONTCREATE negates /NTCREATE.</td>
</tr>
<tr valign=top>
<td width=20%>NT Delete</td>
<td width=27%><b>/NTDELETE</b><p>
<b>/NONTDELETE</b></p>
</td>
<td width=53%>Optional. /NTDELETE deletes the associated Windows NT account of every mailbox that is being deleted. If the mailbox has no associated account, no account is deleted but the mailbox is still deleted. /NONTDELETE does not delete the mailboxes. Default.</td>
</tr>
<tr valign=top>
<td width=20%>Object Type</td>
<td width=27%><b>/OBJCLASS=</b></td>
<td width=53%>Optional. Type of directory objects created by import operations.<p>
Remote = Creates custom recipients (default)</p>
<p>
Mailbox = Creates a mailbox object </p>
</td>
</tr>
<tr valign=top>
<td width=20%>Progress Dialog</td>
<td width=27%><b>/PROGRESS</b><p>
<b>/NOPROGRESS</b></p>
</td>
<td width=53%>Optional. Boolean flag indicating that a progress dialog should be displayed. Affects export only because import operations do not support a progress dialog<br>
/NOPROGRESS = No progress dialog (default)<br>
/PROGRESS = Display progress dialog</td>
</tr>
<tr valign=top>
<td width=20%>Server</td>
<td width=27%><b>/SERVER=</b></td>
<td width=53%>Optional. If set, server from which mailboxes will be exported.</td>
</tr>
<tr valign=top>
<td width=20%>Sub-containers</td>
<td width=27%><b>/SUBS</b><p>
<b>/NOSUBS</b></p>
</td>
<td width=53%>Optional. Boolean flag indicating that export operations should recursively include subcontainers. <p>
/NOSUBS = Only exports specified container (default)</p>
<p>
/SUBS = Recursively exports all subcontainers starting with specified container</p>
</td>
</tr>
<tr valign=top>
<td width=20%>Type</td>
<td width=27%><b>/EXPORT /IMPORT /BOTH</b></td>
<td width=53%>Mandatory. Indicates instance type. <p>
No type specified (default)<br>
/EXPORT  Exports instance <br>
/IMPORT = Imports instance <br>
/BOTH = Exports and imports instance</p>
</td>
</tr>
</table><br>
<p>
The following command-line flags can be stored as part of the instance <a href="glossary_1oon.htm#_edk_windows_nt_registry">Windows NT Registry</a> key. This key has the following path: HKEY_LOCAL_MACHINE\SOFTWARE\MS Exchange SDK Samples\DIRSYNC\&lt;<i>Instance</i>&gt;\State.</p>
<p>
</p>
<p>
<b>Command-Line Flags Corresponding to the State Registry Key </b></p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=20%>Value</th>
<th align=left width=27%>Command-Line Flag</th>
<th align=left width=53%>Setting</th>
</tr>
<tr valign=top>
<td width=20%>Imported Object List</td>
<td width=27%></td>
<td width=53%>Binary table of imported USNs used to coordinate incremental imports and exports. This table is cleared after every export.</td>
</tr>
<tr valign=top>
<td width=20%>Last USN</td>
<td width=27%><b>/USN</b></td>
<td width=53%>Value of the most recent USN-Changed attribute exported. Setting this value to zero before running DIRSYNC forces the entire <a href="glossary_1oo3.htm#_edk_container">container</a> to be exported (as will setting the Full Export flag).</td>
</tr>
</table><br>
<p>
The following command-line flags can only be entered from the command line.</p>
<p>
</p>
<p>
<b>DIRSYNC Command-Line Flags with No Windows NT Registry Equivalent</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=30%>Command-Line Flag</th>
<th align=left width=70%>Setting</th>
</tr>
<tr valign=top>
<td width=30%><b>/SET</b></td>
<td width=70%>Creates a new instance or modifies an existing instance. The Windows NT Registry is updated, but no export operation is performed. </td>
</tr>
<tr valign=top>
<td width=30%><b>/KEY=&lt;Registry key&gt;</b></td>
<td width=70%>Specifies an instance with an alternate registry location. Used instead of an instance name.</td>
</tr>
<tr valign=top>
<td width=30%><b>/DISPLAY</b></td>
<td width=70%>Displays the current registry settings for the instance or /KEY.</td>
</tr>
<tr valign=top>
<td width=30%><b>/?</b><p>
<b>/HELP</b></p>
</td>
<td width=70%>Displays full Help information.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
