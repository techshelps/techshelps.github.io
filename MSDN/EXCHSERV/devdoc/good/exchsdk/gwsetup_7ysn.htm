<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing Event Logging</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_gdk_installing_event_logging"></a>Installing Event Logging</h2>
<p>
To enable diagnostic event logging for your gateway to be controlled from the Microsoft Exchange Server Administrator progam, your installation program must create a <b>Diagnostics</b> key for the gateway service in the Windows NT Registry. This key must appear as a subkey of the gateway service’s registry entry. The following figure shows the registry entry for the MSExchangeDS service. </p>
<p>
<img src="images/gpg08_01.gif" border=0></p>
<p>
The path to the <b>Diagnostics</b> registry entry is </p>
<p>
<b>HKEY_LOCAL_MACHINE\ SYSTEM\CurrentControlSet\Services\<i>Service Name</i>\Diagnostics</b></p>
<p>
where <b><i>Service Name</i></b> is the name of your gateway’s Windows NT Server service. To activate the Administrator program’s <b>Diagnostics Logging</b> property page for your gateway, the Diagnostic-reg-key attribute of your gateway’s Mail-Gateway object must be set to <b><i>Service Name</i></b>.</p>
<p>
Subkeys of the <b>Diagnostics</b> key represent loggable events. The preceding figure shows 15 such events defined. Each event description consists of a resource identifier number followed by a string. The value associated with each subkey represents the significance level for logged events of that type. </p>
<p>
Significance levels range from from 0 to 5, with 0 being the most significant (such as critical errors) and 5 the least significant (such as debugging output). The Microsoft Exchange Server administrator uses the <b>Diagnostics Logging</b> property page to set a diagnostic logging level that determines which events are written to the Windows NT Application event log. This level is typically set to 0 (critical errors), 1 (minimal), 3 (medium), or 5 (maximum). Events with a value less than or equal to the logging level are written to the event log. For more information about how the diagnostic logging level is used, see the <i>Microsoft Exchange Server Administrator’s Guide</i>.</p>
<p>
To localize the registry key names to other languages, you must provide a resource DLL that contains the localized version of the event description strings for each language. An event description’s resource identifier number is the same in all languages. The resource DLL is placed in the server’s RES directory, which is shared as \\<i>ServerName</i>\RESOURCES. You must also create a <b>DiagnosticsMessageFile</b> registry key under the gateway service, containing the name of the DLL. The resource DLL is built from an .MC file so that it is in the correct format for the Windows NT Application event Log.</p>
<p>&nbsp;</p></body>
</HTML>
