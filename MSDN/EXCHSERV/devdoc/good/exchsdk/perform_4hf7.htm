<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Selecting MAPI Methods That Use Fewer RPCs</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_selecting_mapi_methods_that_use_fewer_rpcs"></a>Selecting MAPI Methods That Use Fewer RPCs</h2>
<p>
The following table lists a number of commonly used MAPI methods and the circumstances under which they cause RPCs. To optimize your application’s performance, use the MAPI methods that cause the fewest RPCs. </p>
<p>
<b>Commonly Used MAPI Methods and RPCs</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>MAPI Method</th>
<th align=left width=68%>Causes RPC?</th>
</tr>
<tr valign=top>
<td width=32%><b>Advise</b></td>
<td width=68%>Never causes an RPC.</td>
</tr>
<tr valign=top>
<td width=32%><b>CompareEntryIDs</b></td>
<td width=68%>Very rarely causes an RPC.</td>
</tr>
<tr valign=top>
<td width=32%><b>CopyTo</b></td>
<td width=68%>Always causes an RPC.</td>
</tr>
<tr valign=top>
<td width=32%><b>CreateAttachment</b></td>
<td width=68%>Causes an RPC except when creating the first message and the MAPI_DEFERRED_ERRORS flag is set.</td>
</tr>
<tr valign=top>
<td width=32%><b>CreateBookmark</b></td>
<td width=68%>Causes an RPC except when creating a bookmark for the beginning or end of a table.</td>
</tr>
<tr valign=top>
<td width=32%><b>CreateFolder</b></td>
<td width=68%>Always causes an RPC.</td>
</tr>
<tr valign=top>
<td width=32%><b>CreateMessage</b></td>
<td width=68%>Causes an RPC except when MAPI_DEFERRED_ERRORS is is set.</td>
</tr>
<tr valign=top>
<td width=32%><b>DeleteProps</b></td>
<td width=68%>Causes an RPC for information store and folder objects, rarely for most other objects.</td>
</tr>
<tr valign=top>
<td width=32%><b>FindRow</b></td>
<td width=68%>Always causes an RPC, but retrieves extra information to save for subsequent calls of the <b>QueryRows</b> method, which can minimize future RPCs.</td>
</tr>
<tr valign=top>
<td width=32%><b>DeleteMessages</b></td>
<td width=68%>Always causes an RPC.</td>
</tr>
<tr valign=top>
<td width=32%><b>FreeBookmark</b></td>
<td width=68%>Never causes an RPC.</td>
</tr>
<tr valign=top>
<td width=32%><b>GetAttachmentTable</b></td>
<td width=68%>Causes an RPC except when MAPI_DEFERRED_ERRORS is set.</td>
</tr>
<tr valign=top>
<td width=32%><b>GetContentsTable</b></td>
<td width=68%>Causes an RPC except when MAPI_DEFERRED_ERRORS is set.</td>
</tr>
<tr valign=top>
<td width=32%><b>GetHierarchyTable</b></td>
<td width=68%>Causes an RPC except when MAPI_DEFERRED_ERRORS is set.</td>
</tr>
<tr valign=top>
<td width=32%><b>GetIDsFromNames</b></td>
<td width=68%>Usually causes an RPC unless the identifier is already in the cache (identifiers are cached locally after the first call). </td>
</tr>
<tr valign=top>
<td width=32%><b>GetNamesFromIDs</b></td>
<td width=68%>Usually causes an RPC, unless the name is already in the cache (names are cached locally after the first call). </td>
</tr>
<tr valign=top>
<td width=32%><b>GetProps</b></td>
<td width=68%>Causes an RPC unless properties are stored locally </td>
</tr>
<tr valign=top>
<td width=32%><b>GetRecipientTable</b></td>
<td width=68%>Causes an RPC except with MAPI_DEFERRED_ERRORS set.</td>
</tr>
<tr valign=top>
<td width=32%><b>GetRowCount</b></td>
<td width=68%>Usually causes an RPC, except when table properties are cached by provider.</td>
</tr>
<tr valign=top>
<td width=32%><b>OpenEntry</b></td>
<td width=68%>Causes an RPC except with MAPI_DEFERRED_ERRORS set.</td>
</tr>
<tr valign=top>
<td width=32%><b>OpenMsgStore</b></td>
<td width=68%>Always causes an RPC.</td>
</tr>
<tr valign=top>
<td width=32%><b>OpenProperty</b></td>
<td width=68%>Depends on the property. Never causes an RPC if MAPI_DEFERRED_ERRORS is set.</td>
</tr>
<tr valign=top>
<td width=32%><b>QueryColumnsAll</b></td>
<td width=68%>Causes an RPC for contents, attachment, and recipient tables. Never causes an RPC for all other tables.</td>
</tr>
<tr valign=top>
<td width=32%><b>QueryPosition</b></td>
<td width=68%>Usually causes an RPC, with a few exceptions (such as at the beginning and end of a table).</td>
</tr>
<tr valign=top>
<td width=32%><b>QueryRows</b></td>
<td width=68%>Usually causes an RPC. Never causes an RPC when used after FindRow (on same row) or when already at end of table.</td>
</tr>
<tr valign=top>
<td width=32%><b>QuerySortOrder</b></td>
<td width=68%>Never causes an RPC.</td>
</tr>
<tr valign=top>
<td width=32%><b>Release</b></td>
<td width=68%>Causes an RPC only for an information store object. Never causes an RPC for all other objects.</td>
</tr>
<tr valign=top>
<td width=32%><b>Restrict</b></td>
<td width=68%>Causes an RPC only if called before data is in the cache. Does not when passed NULL on already nonrestricted table.</td>
</tr>
<tr valign=top>
<td width=32%><b>SaveChanges</b></td>
<td width=68%>Causes an RPC except with MAPI_DEFERRED_ERRORS set, although using MAPI_DEFERRED_ERRORS is not usually recommended.</td>
</tr>
<tr valign=top>
<td width=32%><b>SeekRow</b></td>
<td width=68%>Usually causes an RPC except when already at the row, seeking to the end, or seeking to the beginning. </td>
</tr>
<tr valign=top>
<td width=32%><b>SetColumns</b></td>
<td width=68%>Causes an RPC only if called before data is in cache.</td>
</tr>
<tr valign=top>
<td width=32%><b>SetProps</b></td>
<td width=68%>Causes an RPC for information store and folder objects, rarely for most other objects.</td>
</tr>
<tr valign=top>
<td width=32%><b>SortTable</b></td>
<td width=68%>Causes an RPC only if called before data is in the cache.</td>
</tr>
<tr valign=top>
<td width=32%><b>SubmitMessage</b></td>
<td width=68%>Always causes an RPC.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
