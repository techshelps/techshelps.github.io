<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Address Lookup Functions</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_gdk_using_the_address_lookup_functions"></a>Using the Address Lookup Functions</h2>
<p>
The Microsoft Exchange Server SDK provides functions that convert between foreign addresses and native Microsoft Exchange Server addresses. These functions are based on the standard MAPI methods <b>IAddrBook::PrepareRecipients</b> and <b>IABContainer::ResolveNames</b>, applied to the Microsoft Exchange Server global address list.</p>
<p>
<b>Address Lookup Functions from the Microsoft Exchange Server SDK</b></p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=47%>Function</th>
<th align=left width=27%>Action</th>
<th align=left width=26%>When called</th>
</tr>
<tr valign=top>
<td width=47%><a href="function_2dv8.htm"><b>HrFindExchangeGlobalAddressList</b></a></td>
<td width=27%>Returns the entry identifier of the global address list (GAL) container in the address book. The MAPI <b>OpenEntry</b> method is then used to open the GAL.</td>
<td width=26%>As the gateway starts.</td>
</tr>
<tr valign=top>
<td width=47%><a href="function_1dir.htm"><b>HrGWResolveAddress</b></a> (based on <b>IABContainer::ResolveNames</b>)</td>
<td width=27%>Converts a recipient’s proxy address into the entry identifier for a Microsoft Exchange Server recipient, by looking up the proxy address in the GAL.</td>
<td width=26%>For addresses in incoming messages to Microsoft Exchange Server.</td>
</tr>
<tr valign=top>
<td width=47%><a href="function_4nsp.htm"><b>HrGWResolveProxy</b></a> (based on <b>IAddrBook::PrepareRecipients</b>)</td>
<td width=27%>Looks up a recipient’s proxy address.</td>
<td width=26%>For addresses in outgoing messages from Microsoft Exchange Server. </td>
</tr>
</table><br>
<p>
For outgoing messages, gateways call the <b>HrGWResolveProxy</b> function to convert all the native Microsoft Exchange Server addresses in a message into their corresponding proxy addresses for the foreign system that the gateway serves. For incoming messages, gateways call <b>HrGWResolveAddress</b> to convert the proxy addresses in the message into native Microsoft Exchange Server addresses. Both of these functions reference the native Microsoft Exchange Server addresses with the MAPI entry identifiers for those addresses.</p>
<p>
The <a href="samplgw_83oz.htm">LOOKUP</a> sample application illustrates simple address mapping using the address lookup functions.</p>
<p>&nbsp;</p></body>
</HTML>
