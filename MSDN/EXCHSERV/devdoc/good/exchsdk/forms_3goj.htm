<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Resolving Message Conflicts with Forms</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_edk_resolving_message_conflicts_with_forms"></a>Resolving Message Conflicts with Forms</h1>
<p>
Although custom <a href="glossary_1oo6.htm#_edk_form">forms</a> are commonly used for composing or reading messages, they can also be used for resolving message conflicts. Such a form must contain code that checks the message status every time the form is launched. If the MSGSTATUS_IN_CONFLICT flag is set, the form knows to invoke its conflict resolution functionality (which includes a conflict-resolution user interface) instead of its compose or read functionality.</p>
<p>
<b>Note</b>&nbsp;&nbsp;Microsoft Exchange Server can handle message conflicts in one of three ways, depending on the value of the <a href="props4_64ys.htm">PR_RESOLVE_METHOD</a> property. If this property is set to invoke default behavior, one of the actions taken by Microsoft Exchange Server is to set the MSGSTATUS_IN_CONFLICT bit in the MAPI PR_MSG_STATUS property of the winning message. For more information, see <a href="infostor_6144.htm">Specifying the Resolution Method with PR_RESOLVE_METHOD</a>.</p>
<p>
To register a form for conflict resolution, set the GUID for one of the form's extension properties in the [Extensions] section of the form's .CFG file. For this GUID, use the value given in the following example in the line starting with <code>NmidPropset=</code>. The [Extension.1] section indicates that the form can handle its own conflicts. This prevents the Microsoft Exchange Client from displaying its conflict-resolution user interface for forms of this message's class.</p>
<pre><code>[Extensions]
Extensions1=1

[Extension.1]
Type=11
NmidPropset={77f69534-6b7d-101b-9f0d-00aa003ba905}
NmidInteger=0
Value=1
 </code></pre>
<p>
If these lines are detected in the form's .CFG file, Microsoft Exchange Server starts the forms server when a conflict occurs. </p>
<p>
If a forms server checks a message's PR_MSG_STATUS property and finds the MSGSTATUS_IN_CONFLICT bit set, it can try to resolve the conflict detected by Microsoft Exchange Server. To do this, the forms server opens the attachment table and searches for attachments that have the <a href="props4_5kj8.htm">PR_IN_CONFLICT</a> property set to TRUE. For more information, see <a href="infostor_5o6m.htm">Automatic Conflict Resolution</a>. For general information on conflict resolution, see <a href="infostor_9jar.htm">Handling Message Conflicts</a>.</p>
<p>&nbsp;</p></body>
</HTML>
