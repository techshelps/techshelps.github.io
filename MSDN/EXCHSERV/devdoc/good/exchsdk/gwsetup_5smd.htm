<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing the Gateway as a Service</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_gdk_installing_the_gateway_as_a_service"></a>Installing the Gateway as a Service</h2>
<p>
If your gateway runs as a service of Windows NT Server, you must install it in the Windows NT service control manager (SCM). Making your gateway a service of Windows NT Server enables it to start up automatically when the computer is turned on and to run in its own security context. Users also gain the ability to control the gateway through the operating system, instead of requiring a custom user interface.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To register a gateway as a service of Windows NT Server</h5>
<ol>
<li>
Connect to the SCM by calling the Win32 <b>OpenSCManager</b> function.</li>
<li>
Create the service by calling the Win32 <b>CreateService</b> function and passing information such as the service name and type, and the ways the service should be switched to and started.</li>
<li>
In the local Windows NT Registry, open the <b>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services</b> key. Do this by calling the Win32 <b>RegOpenKeyEx</b> function.</li>
<li>
Under this key, create other necessary keys for the service, such as the <b>Object</b> key, the <b>Parameters</b> key, and the <b>Diagnostics</b> key. Registry keys are created by calling the Win32 <b>RegCreateKeyEx</b> function.</li>
<li>
Write the configuration information that your application needs into these Registry keys.</li>
</ol>
<p>
For an example of this procedure, see the <b>HrInstallService</b> function in \BKOFFICE\SAMPLES\EXCHANGE\LIBSRC\EXCHINST.C. See <a href="gwsetup_7ysn.htm">Installing Event Logging</a> for specifics on creating the <b>Diagnostics</b> key.</p>
<p>&nbsp;</p></body>
</HTML>
