<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Folder</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_creating_a_folder"></a>Creating a Folder</h2>
<p>
This procedure can be used for creating a <a href="glossary_1oo6.htm#_edk_folder">folder</a> in the public, private, or personal <a href="glossary_1oo9.htm#_edk_information_store">information stores</a>. You cannot create subfolders in the Favorites <a href="glossary_1oo3.htm#_edk_container">container</a> of the <a href="glossary_1oog.htm#_edk_public_information_store">public information store</a>.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create a folder</h5>
<ol>
<li>
Open the information store. This returns an LPMDB pointer to the open information store. See <a href="infostor_6ehx.htm">Opening an Information Store</a>.</li>
<li>
Open the folder in which you want to create a new folder by calling the <b>IMsgStore::OpenEntry</b> method, with the MAPI_MODIFY flag set. This folder will be the container of the folder you are creating.</li>
<li>
Create the folder with a call to the <b>IMAPIFolder::CreateFolder</b> method. This creates the subfolder object and returns an LPMAPIFOLDER pointer to it, which gives access to the <b>IMAPIFolder</b> interface on the new object.</li>
<li>
Optionally, set the folder’s PR_STATUS property to indicate a user-defined value. Use <b>IMAPProp::SetProps</b> to set this property.</li>
</ol>
<p>
The following sample code illustrates this procedure:</p>
<pre><code>// Open the parent (or root) folder...
hr = lpMsgStore-&gt;OpenEntry(
    cbEID,    // use 0L for root folder
    lpEID,    // use NULL for root folder
    NULL,     // use NULL for interface ID
    MAPI_MODIFY | MAPI_DEFERRED_ERRORS, // use MAPI_MODIFY if 
    you plan to make changes
    &amp;ulObjType,
    (LPUNKNOWN*)&amp;lpParentFolder);

//  Create folder with MAPI call...
hr = lpParentFolder-&gt;CreateFolder(
    FOLDER_GENERIC,
    TEXT("Folder Name"),
    TEXT("Folder Comment"),
    NULL,        // Interface ID, must be NULL for client apps
    fMapiUnicode,
    &amp;lpNewFolder);

// At this point you may set the folder's PR_STATUS property.
// It is purely optional, and may be any value you find meaningful.
static SPropValue PropStatus = { PR_STATUS, 0L, {0L}};
SPropProblemArray lpProblems = NULL;

hr = lpNewFolder-&gt;SetProps( 1, &amp;PropStatus, &amp;lpProblems);
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
