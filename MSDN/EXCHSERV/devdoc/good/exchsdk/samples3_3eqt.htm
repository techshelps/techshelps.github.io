<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Formatting the POPPST.INI File</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_formatting_the_poppst.ini_file"></a>Formatting the POPPST.INI File</h2>
<p>
POPPST is used to create a new <a href="glossary_1oog.htm#_edk_personal_folder_store_pst_">personal folder store (PST)</a> and to populate it with messages. Alternately, you can use it to add test messages to a new PST if the NEWPST section is commented out and the PROFILE section is activated.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To replace the NEWPST section with the PROFILE section</h5>
<ol>
<li>
Remove the comment symbols (;) from the beginning of each line in the PROFILE section.</li>
<li>
Replace the name of the profile with an existing <a href="glossary_1oog.htm#_edk_profile">profile</a>.</li>
<li>
Add comment symbols to the beginning of each line in the NEWPST section.</li>
</ol>
<p>
The POPPST.INI file below will create a new PST and populate it with one message:</p>
<pre><code>;  poppst.ini
;  Sample INI input file forthe POPPST.EXE sample application
;  
;  Notes: The [profile] and [newpst] sections are mutually exclusive.
;      See the poppst.cpp file for more .INI file syntax information
;  [profile]
;  NAME=User Twenty-two 
;  PASSWORD=

[newpst]
NAME=Mailbox - Personal
ENCRYPTION=OFF
PASSWORD=
PATH=POPPST.PST

[message 1]
FROM=Jerry Wheeler
TO=None Two
BCC=Jerry Wheeler
FOLDER=Top of Information Store\Inbox
SUBJECT=POPPST Test Message 02/21/95-1
XTEXT=Body.Text
DATE=1996-02-01
TIME=10:25
PRIORITY=Normal
XATTACH=POPPST.INI
 </code></pre>
<p class=indent1>
The default rights value for mail messages created with POPPST is set to READ. To create unread messages, you can modify the source code. Assuming you have just opened the message, you can use the MAPI <b>IMessage::SetReadFlag</b> method by adding code such as the following:</p>
<pre><code>ASSERTERROR( lpMessage != NULL, "Invalid lpMessage!");
hr = MAPICALL(lpMessage)-&gt;SetReadFlag(lpMessage,
    CLEAR_READ_FLAG | MAPI_DEFERRED_ERRORS);
if( FAILED( hr))
    goto cleanup;
This will mark the message as unread.
 </code></pre>
<p class=indent1>
You can also add additional messages. To view the new PST from the client, it must be associated with an active profile. See <a href="samples3_1xbo.htm">Running SMBAGENT</a>.</p>
<p>&nbsp;</p></body>
</HTML>
