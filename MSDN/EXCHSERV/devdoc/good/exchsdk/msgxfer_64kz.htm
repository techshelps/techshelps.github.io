<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Submitted Message Properties</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_gdk_submitted_message_properties"></a>Submitted Message Properties</h3>
<p>
Messages passing through your gateway may have properties in addition to the common message properties. The following table shows optional properties for a submitted message and indicates actions that your gateway should take when handling messages with these properties.</p>
<p>
<b>Optional Submitted Message Properties</b></p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=39%>Property name</th>
<th align=left width=20%>Type</th>
<th align=left width=41%>Description</th>
</tr>
<tr valign=top>
<td width=39%>PR_DELETE_AFTER_SUBMIT</td>
<td width=20%>Boolean</td>
<td width=41%>If present and set, indicates that the server should delete the message after submission.</td>
</tr>
<tr valign=top>
<td width=39%>PR_SENTMAIL_ENTRYID</td>
<td width=20%>Binary</td>
<td width=41%>Entry identifier of the folder where a copy of the message should be placed after it has been successfully submitted to an underlying messaging system. If zero-length, it indicates that no sent mail copy should be made. If this property does not exist, sent mail behavior is governed by the profile configuration.</td>
</tr>
</table><br>
<p>
A gateway uses the MAPI <b>IMessage::SubmitMessage</b> method to submit a message to Microsoft Exchange Server. When Microsoft Exchange Server takes responsibility, the following actions will occur:
<ul>
<li>
If the PR_DELETE_AFTER_SUBMIT property is set, the information store deletes the message. Gateways typically set this property so that their MTS-IN folders do not accumulate large numbers of messages.</li>
<li>
If the PR_SENTMAIL_ENTRYID property is set, the information store copies the message to the indicated folder. Gateways can use this property to implement archiving features.</li>
</ul>
<p>
A gateway uses the MAPI <b>IMessage::SetReadFlag</b> method when it accepts responsibility for delivering a message to the foreign system. After the gateway has called this function, Microsoft Exchange Server cannot time-out the message.</p>
<p>&nbsp;</p></body>
</HTML>
