<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BIMPORT_PARMS</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_edk_bimport_parms"></a>BIMPORT_PARMS</h1>
<p>
The <b>BIMPORT_PARMS</b> structure contains information for the <a href="function_1v1w.htm"><b>BatchImport</b></a> function.</p>
<h4>Quick Info</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=23%>Header file:</td>
<td width=77%>DAPI.H</td>
</tr>
<tr valign=top>
<td width=23%>Unicode:</td>
<td width=77%>Yes</td>
</tr>
</table><br>
<pre><code>typedef struct
{
  DWORD             dwDAPISignature;
  DWORD             dwFlags;
  HWND              hwndParent;
  LPTSTR            pszImportFile;
  UINT              uCodePage;
  LPTSTR            pszDSAName;
  LPTSTR            pszBasePoint;
  LPTSTR            pszContainer;
  TCHAR             chColSep;
  TCHAR             chQuote;
  TCHAR             chMVSep;
  TCHAR             creserved;
  CALLBACKPROGRESS  ProgressCallBacks;
  ERROR_CALLBACK    ErrorCallback;
  LPTSTR            pszNTDomain;
  LPTSTR            pszCreateTemplate;
}  BIMPORT_PARMS, *PBIMPORT_PARMS, *LPBIMPORT_PARMS;
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>dwDAPISignature</b></dt>
<dd>
Verifies that the parameter sequence used by the calling application is the same as expected by the directory functions. The value should be set to DAPI_SIGNATURE, which is defined in DAPI.H.</dd>
<dt>
<b>dwFlags</b></dt>
<dd>
Defined values that control the directory import operation (see <a href="function_1v1w.htm"><b>BatchImport</b></a>). Use the bitwise OR operator (|) to enable multiple operations:
<dl>
<dt>
DAPI_EVENT_MIN</dt>
<dd>
Logs start and stop messages; does not log warning or error messages.</dd>
<dt>
DAPI_EVENT_SOME</dt>
<dd>
Logs start, stop, and error messages; does not log warning messages.</dd>
<dt>
DAPI_EVENT_ALL</dt>
<dd>
Logs all messages (start, stop, error, and warning).</dd>
<dt>
DAPI_FORCE_SCHEMA_LOAD</dt>
<dd>
Unloads a previously loaded schema and reads the schema again. The default action is to reuse the previously loaded schema if it is read from the same messaging domain.</dd>
<dt>
DAPI_RAW_MODE</dt>
<dd>
Imports data in raw mode (import lines are taken literally). No properties are inherited or constructed. Aliases for property and class names are not recognized.</dd>
<dt>
DAPI_SUPPRESS_PROGRESS</dt>
<dd>
Suppresses the progress thermometer that normally appears during batch operations.</dd>
<dt>
DAPI_SUPPRESS_COMPLETION</dt>
<dd>
Suppresses the notification window that normally appears following the completion of a batch operation.</dd>
<dt>
DAPI_SUPPRESS_ARCHIVES</dt>
<dd>
Suppresses the creation of an archive copy of any output files that normally are created during batch operations.</dd>
<dt>
DAPI_OVERRIDE_CONTAINER</dt>
<dd>
The container specified in the parameter block overrides the contents of the container column. The default behavior is for the value specifed in the Obj-Container column to override the value specified in the parameter block.</dd>
<dt>
DAPI_IMPORT_NO_ERR_FILE</dt>
<dd>
Does not create an error file.</dd>
<dt>
DAPI_IMPORT_WRITE_THROUGH</dt>
<dd>
Commits write operations immediately.</dd>
<dt>
DAPI_RESTRICT_ACCESS</dt>
<dd>
Applies the Windows NT Security Descriptor to created objects.</dd>
<dt>
DAPI_MODIFY_REPLACE_PROPERTIES</dt>
<dd>
Overwrites any existing properties when modifying.</dd>
<dt>
DAPI_CREATE_NT_ACCOUNT</dt>
<dd>
Creates Windows NT accounts as required.</dd>
<dt>
DAPI_CREATE_RANDOM_PASSWORD</dt>
<dd>
Generates a random password for newly created Windows NT accounts. This flag is ignored if DAPI_CREATE_NT_ACCOUNT is not set.</dd>
<dt>
DAPI_DELETE_NT_ACCOUNT</dt>
<dd>
Deletes ASSOC_NT_ACCOUNT when deleting a mailbox.</dd>
</dl>
</dd>
<dt>
<b>hwndParent</b></dt>
<dd>
The window handle to use when displaying message boxes. Set this member to NULL to use the handle of the main window of the calling application.</dd>
<dt>
<b>pszImportFile</b></dt>
<dd>
The fully qualified path of the import file.
<p>
<a href="function_1v1w.htm"><b>BatchImport</b></a> imports objects from the file specified by this member into the directory information tree (DIT).
</dd>
<dt>
<b>uCodePage</b></dt>
<dd>
The code-page specification (text format) for the import file:
<dl>
<dt>
DAPI_UNICODE_FILE</dt>
<dd>
The import file is created in Unicode format.</dd>
<dt>
<b>0</b></dt>
<dd>
If the import files exists, the data is imported in the format of the existing import file. Otherwise, the import file is created in ANSI format.</dd>
<dt>
<i>other</i></dt>
<dd>
The import file is created in this ANSI codepage format. This ANSI codepage format must already be installed on the system.</dd>
</dl>

<p>
If this member is DAPI_UNICODE_FILE (export the DIT object in Unicode format) and the DIT object is in ANSI format, <b>BatchImport</b> fails and emits a diagnostic error message in the Windows NT Application event log.

<p>
<b>BatchImport</b> also fails and emits a diagnostic error message in the Windows NT Application event log if the <b>uCodePage</b> member is a format other than DAPI_UNICODE_FILE or <b>0</b> (zero, which is autodetect) and either of the following conditions is true:
</dd>
</dl>
<ul>
<li>
The format is not supported by the system</li>
<li>
The output file exists and is in Unicode format.</li>
</ul>
<dl>
<dt>
<b>pszDSAName</b></dt>
<dd>
The directory service agent (DSA) to use when importing objects. If this member is NULL, <a href="function_1v1w.htm"><b>BatchImport</b></a> attempts to find a DSA on the local computer. Otherwise, <b>BatchImport</b> broadcasts for a DSA to the servers on its network and uses the name that is returned as a result of the broadcast.
<p>
If this member is NULL, <b>BatchImport</b> searches for a DSA in the following order:

<ol>
<li>
If a DSA exists on the local computer, use it.</li>
<li>
Otherwise, broadcast for a DSA and use one of the DSAs that replies.</li>
</ol>

<p>
Use MAPI function calls to determine the DSA. See the <i>MAPI Programmer’s Reference</i> for more information.
</dd>
<dt>
<b>pszBasePoint</b></dt>
<dd>
The distinguished name (DN) of the messaging site or container that serves as the directory information tree basepoint for bulk operations. A DN is the combination of an object’s path and name in the Xopen hierarchical naming structure.
<p>
If this member is NULL, the basepoint is the current site object where the DSA, as specified by the <b>pszDSAName</b> parameter member, resides; if <b>pszBasePoint</b> is ““ (an empty string), the basepoint is the current organization object. The basepoint is the point in the DIT where <b>BatchImport</b> performs its bulk object creation or bulk object manipulation operations.
</dd>
<dt>
<b>pszContainer</b></dt>
<dd>
The DN or relative distinguished name (RDN) of the default container where objects are imported. If this member is NULL, <a href="function_1v1w.htm"><b>BatchImport</b></a> assumes that the container is below the level indicated by the <b>pszBasePoint</b> member. If this member is an RDN, <b>BatchImport</b> assumes that the container is relative to the level indicated by the <b>pszBasePoint</b> member. The container name in the export file can override this value.
<p>
If this member is NULL, <b>BatchImport</b> exports the contents of all containers below the point specified by the <b>pszBasePoint</b> member.
</dd>
<dt>
<b>chColSep</b></dt>
<dd>
The column separator that is used within the export file. Specify your preferred column separator, even if it is the same as the default.
<p>
If this member is NULL, <b>Batchimport</b> uses the default separator, which is defined as DEFAULT_DELIM (see DAPI.H).

<p>
The default column separator used by the directory functions is unrelated to the default column separator specified within the Administrator program.
</dd>
<dt>
<b>chQuote</b></dt>
<dd>
The character that is used to enclose strings within the export file. Do not use the ~, #, or = characters. Specify your preferred string enclosure separator, even if it is the same as the default.
<p>
If this member is NULL, <b>BatchImport</b> uses the default string enclosure character, which is defined as DEFAULT_QUOTE (see DAPI.H).
</dd>
<dt>
<b>chMVSep</b></dt>
<dd>
The value separator for multivalued properties within the export file. A separator character is required, for example, by the members of a distribution list. A percent sign inside a quoted string is interpreted as a literal character. Specify your preferred value separator, even if it is the same as the default.
<p>
If this member is NULL, <b>BatchImport</b> uses the default multivalue separator character, which is defined as DEFAULT_MV_SEP (see DAPI.H).
</dd>
<dt>
<b>creserved</b></dt>
<dd>
Unused and reserved for future use.</dd>
<dt>
<b>ProgressCallBacks</b></dt>
<dd>
A structure that contains pointers to functions that display the progress of the operation.
<p>
If this member is NULL, <b>BatchImport</b> displays a default modeless dialog to show progress.
</dd>
<dt>
<b>ErrorCallback</b></dt>
<dd>
A structure that contains a pointer to a function that is to be called on each error encountered.
<p>
If this member is NULL, <b>BatchImport</b> calls the default error handler, which displays an error dialog window and posts the error into the Windows NT Application event log.
</dd>
<dt>
<b>pszNTDomain</b></dt>
<dd>
Name of the primary Windows NT Server domain in which to create or find Windows NT accounts. If this parameter is NULL, the function uses the primary Windows NT Server domain name (the domain on which the executing process computer’s account is logged on).
<p>
If this member is NULL, <b>BatchImport</b> uses the primary Windows NT Server domain name (the domain where the executing process computer’s account is logged on).
</dd>
<dt>
<b>pszCreateTemplate</b></dt>
<dd>
A DN or RDN of the user object that serves as the template for creating new user objects. If this member is an RDN, <a href="function_1v1w.htm"><b>BatchImport</b></a> uses the <b>pszBasePoint</b> and <b>pszContainer</b> members to determine the path to the template. If this member is NULL, <b>BatchImport</b> does not use a template when creating new user objects.
<p>
<b>BatchImport</b> reads the properties associated with the default user’s mailbox and uses this information as a standard configuration that all imported user objects inherit. <b>BatchImport</b> caches this information and only updates those properties applicable to the given import object. Set this member to NULL if there is no default template object. See the <i>Microsoft Exchange Server Administrator’s Guide</i> for more information about formatting the template object.

</dd>
</dl>
<h4>Remarks</h4>
<p>
For additional information on this structure, see <a href="directry_2hdf.htm">Importing and Manipulating Objects</a>.</p>
<h4>See Also</h4>
<p>
<a href="function_1v1w.htm"><b>BatchImport</b></a></p>
<p>&nbsp;</p></body>
</HTML>
