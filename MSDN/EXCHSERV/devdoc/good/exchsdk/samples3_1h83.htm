<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Building Mailbox Agent Elements</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_edk_building_mailbox_agent_elements"></a>Building Mailbox Agent Elements</h3>
<p>
Files necessary to create the mailbox agent can be built as a set by executing the makefile under \BKOFFICE\SAMPLES\EXCHANGE, or each individual sample application can be built.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To build all the files necessary to create a mailbox agent </h5>
<ol>
<li>
Change to the directory that contains the source code for the sample applications:<p>
\BKOFFICE\SAMPLES\EXCHANGE
</li>
<li>
Type <b>NMAKE</b>.<p>
This process takes 45 minutes or more, depending on the performance of your computer. At least 12 MB of disk space is required.
</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To build SMBAGENT.EXE</h5>
<ol>
<li>
Change to the directory containing the SMBAGENT source files:<p>
\BKOFFICE\SAMPLES\EXCHANGE\SMBAGENT
</li>
<li>
Type <b>NMAKE</b>.</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To build SMBADMIN.DLL</h5>
<ol>
<li>
Change to the directory containing the SMBADMIN source files:<p>
\BKOFFICE\SAMPLES\EXCHANGE\SMBADMIN
</li>
<li>
Type <b>NMAKE</b>.<p>
If you have not changed the SMBAGENT or SMBADMIN source files, you can prepare your files for the MBSETUP install program by executing the makefile in the MBSETUP directory.
</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To prepare files for MBSETUP install using MBSETUP makefile </h5>
<ol>
<li>
Change to the MBSETUP directory:<p>
\BKOFFICE\SAMPLES\EXCHANGE\MBSETUP
</li>
<li>
Run the NMAKE command using the /F flag and the MBSETUP.MAK input file:<p>
<b>NMAKE /F MBSETUP.MAK </b>
</li>
</ol>
<p>
The process will use the default settings for the BLDTYPE and TARGETDIR environment variables unless you include these parameters on the command line. To view the environment variables, type <b>SET</b> at the command prompt. </p>
<p>
Executing this makefile will automatically change the MBSETUP.INF file and move your files from their present directory location to the directory from which they are to be installed.</p>
<p>
If you have changed any of the files or if your directory structure is not standard, you may want to move the files to the target directory individually and edit the MBSETUP.INF file. In that case, change the MBSETUP.INF file by following the steps in the following procedure.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To change file sizes and move files for the MBSETUP setup utility</h5>
<ol>
<li>
Examine the MBSETUP.INF file. <p>
\BKOFFICE\BIN\SAMPLEMB\MBSETUP.INF contains the following lines:
<pre><code>[Local] 
1, smbagent.exe,,,, 1996-06-29, !DECOMPRESS,,, !READONLY,,,,,, 
876444,,,,, !VITAL

[Server] 
1, smbadmin.dll,,,, 1996-06-29, !DECOMPRESS,,, !READONLY,,,,,, 
23484184,,,, !VITAL
 </code></pre>
<p>
The numbers 876444 and 23484184 are the file sizes of SMBAGENT.EXE and SMBADMIN.DLL, respectively, in this example file. The numbers will vary for different versions of the MBSETUP.INF file. If these numbers do not match the actual sizes of the files on disk, errors will occur when you attempt to install SMBAGENT.
</li>
<li>
Find the actual file sizes. Change to the directory containing the file:<p>
\BKOFFICE\SAMPLES\SMBAGENT\WIN32\DEBUG
<p>
Type <b>DIR</b> to list the files in this directory. Check the size of SMBAGENT.EXE and change the MBSETUP.INF file if the numbers do not match. Then find the actual file size for the SMBADMIN.DLL file by changing to the directory containing the file:
<p>
\BKOFFICE\SAMPLES\SMBADMIN\WIN32\DEBUG
<p>
Type <b>DIR</b>. Note the file's size and change the size in the MBSETUP.INF file if needed. If the numbers in the MBSETUP.INF file do not match the actual sizes of the files on disk, errors will occur when you try to install SMBAGENT.
</li>
<li>
Move the SMBADMIN.DLL and SMBAGENT.EXE files to the \BKOFFICE\BIN\SAMPLEMB directory. Replace files of the same name located in the directory. You may wish to keep a copy of the replaced file in case you need to build and run it later.</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
