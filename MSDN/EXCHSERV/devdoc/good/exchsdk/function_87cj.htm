<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HrGetFolderMetrics</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_edk_hrgetfoldermetrics"></a>HrGetFolderMetrics</h1>
<p>
The <b>HrGetFolderMetrics</b> function retrieves folder statistics.</p>
<h4>Quick Info </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=23%>Header file: </td>
<td width=77%>STATS.H</td>
</tr>
<tr valign=top>
<td width=23%>Library: </td>
<td width=77%>STATS.LIB</td>
</tr>
</table><br>
<pre><code><b>HRESULT HrGetFolderMetrics(
  HFLDMTRC</b><i>&nbsp;hFolderMetric</i><b>,  </b>
<b>  FILETIME&nbsp;*</b><i>&nbsp;pftNow</i><b>,       </b>
<b>  DWORD</b><i>&nbsp;fMetric</i><b>,           </b>
<b>  DWORD&nbsp;*</b><i>&nbsp;pcMessages</i><b>,      </b>
<b>  FILETIME&nbsp;*</b><i>&nbsp;pftLongestWait</i><b>,  </b>
<b>  FILETIME&nbsp;*</b><i>&nbsp;pftTotalWait  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hFolderMetric</i></dt>
<dd>
Input parameter. Specifies the handle to the calculations for this folder.</dd>
<dt>
<i>pftNow</i></dt>
<dd>
Input parameter. Points to the current time.</dd>
<dt>
<i>fMetric</i></dt>
<dd>
Input parameter. Specifies the calculations to make:
<dl>
<dt>
FM_CMESSAGES</dt>
<dd>
Returns a value in <i>pcMessages</i>.</dd>
<dt>
FM_LONGEST_WAIT</dt>
<dd>
Returns a value in <i>pftLongestWait</i>.</dd>
<dt>
FM_TOTAL_WAIT</dt>
<dd>
Returns a value in <i>pftTotalWait</i>.
</dd>
</dl>
</dd>
<dt>
<i>pcMessages</i></dt>
<dd>
Output parameter. Points to the number of messages in the folder (calculated if FM_CMESSAGES is specified in <i>fMetric</i>).</dd>
<dt>
<i>pftLongestWait</i></dt>
<dd>
Output parameter. Points to the duration of the longest wait in the current message list (calculated if FM_LONGEST_WAIT is specified in <i>fMetric</i>).</dd>
<dt>
<i>pftTotalWait</i></dt>
<dd>
Output parameter. Points to the total of the wait durations of all messages in the folder (calculated if FM_TOTAL_WAIT is specified in <i>fMetric</i>).
</dd>
</dl>
<h4>Return Values</h4>
<p>
See <a href="function_3odv.htm">Return Values</a>.</p>
<h4>Remarks</h4>
<p>
Three statistics are available: 
<ul>
<li>
Number of messages in the folder.</li>
<li>
Duration of wait for the message that has been in the folder for the longest period of time.</li>
<li>
Total wait duration for all messages in the folder.</li>
</ul>
<p>
One, two, or all three calculations can be requested in the same call. </p>
<p>
The statistics require different amounts of overhead to calculate. Calculating the number of messages in a folder is the least expensive statistic. Calculating the total of the wait durations is the most expensive. To optimize performance, request only the statistics you need.</p>
<p>
All parameters in the call are mandatory, even if fewer than three calculations are requested. For example, if you do not request the number of messages calculation, you must still provide a value for <i>pcMessages.</i></p>
<p>
For more information on this function, see <a href="admnfunc_59bn.htm">Folder Snapshot Functions</a> in the <i>Gateway Programmer's Reference</i>.</p>
<h4>See Also</h4>
<p>
<a href="function_3kxf.htm"><b>CloseFolderMetrics</b></a>, <a href="function_40j7.htm"><b>HrOpenFolderMetrics</b></a></p>
<p>&nbsp;</p></body>
</HTML>
