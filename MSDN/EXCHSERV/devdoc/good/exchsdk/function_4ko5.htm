<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HrInstallService</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_edk_hrinstallservice"></a>HrInstallService</h1>
<p>
The <b>HrInstallService</b> function loads a service for a server object.</p>
<h4>Quick Info </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=23%>Header file: </td>
<td width=77%>EXCHINST.H</td>
</tr>
<tr valign=top>
<td width=23%>Library: </td>
<td width=77%>EXCHINST.LIB</td>
</tr>
</table><br>
<pre><code><b>HRESULT HrInstallService(
  LPSTR</b><i>&nbsp;lpszServer</i><b>,              </b>
<b>  LPSTR</b><i>&nbsp;lpszSiteDN</i><b>,              </b>
<b>  LPSTR</b><i>&nbsp;lpszServiceDisplayName</i><b>,  </b>
<b>  LPSTR</b><i>&nbsp;lpszServiceName</i><b>,         </b>
<b>  LPSTR</b><i>&nbsp;lpszCommonName</i><b>,          </b>
<b>  LPSTR</b><i>&nbsp;lpszObjectGuid</i><b>,          </b>
<b>  LPSTR</b><i>&nbsp;lpszProductGuid</i><b>,         </b>
<b>  LPSTR</b><i>&nbsp;lpszExeName</i><b>,             </b>
<b>  LPCSTR</b><i>&nbsp;lpszDependencies</i><b>,       </b>
<b>  LPSTR</b><i>&nbsp;lpszAccount</i><b>,             </b>
<b>  LPSTR</b><i>&nbsp;lpszPassword             </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszServer</i></dt>
<dd>
Input parameter. Points to a null-terminated string (with a maximum length of 256 characters) that contains the name of the server where the service is installed.</dd>
<dt>
<i>lpszSiteDN</i></dt>
<dd>
Input parameter. Points to a null-terminated string (with a maximum length of 256 characters), containing the distinguished name (DN) of the site where the service is installed.</dd>
<dt>
<i>lpszServiceDisplayName</i></dt>
<dd>
Input parameter. Points to a null-terminated string (with a maximum length of 256 characters) that contains the name of the service as displayed by the Microsoft Exchange Server Administrator program.
<p>
Although the service control manager preserves the case of the name that is displayed, comparisons between display names are case-insensitive.
</dd>
<dt>
<i>lpszServiceName</i></dt>
<dd>
Input parameter. Points to a null-terminated string (with a maximum length of 256 characters) that contains the name of the service which is installed. You cannot use either the forward slash (<b>/</b>) or back slash (<b>\</b>) character in a service name.</dd>
<dt>
<i>lpszCommonName</i></dt>
<dd>
Input parameter. Points to a null-terminated string (with a maximum length of 256 characters) that contains the relative distinguished name (RDN) of the service object. Common names have the following format:
<p>
<i>extension-name</i>:<i>hardware-platform</i>

<p>
For example, suppose you have a service called NetLink with an Extension-Name attribute of NetLink. If your platform is Intel, set <i>lpszCommonName</i> to NetLink:i386.  
</dd>
<dt>
<i>lpszObjectGuid</i></dt>
<dd>
Input parameter. Points to a null-terminated string (with a maximum length of 256 characters) that contains the service object GUID.</dd>
<dt>
<i>lpszProductGuid</i></dt>
<dd>
Input parameter. Points to a null-terminated string (with a maximum length of 256 characters) that contains the product object GUID.</dd>
<dt>
<i>lpszExeName</i></dt>
<dd>
Input parameter. Points to a null-terminated string (with a maximum length of 256 characters) that contains the full path to the service program.</dd>
<dt>
<i>lpszDependencies</i></dt>
<dd>
Input parameter. Points to an array of NULL-separated strings (with a maximum length of 256 characters) that is terminated by two NULL entries. This array contains the names of services or load ordering groups that must start before this service can start.
<p>
If the entry is the name of a service, this service will not start unless this <i>lpszDependencies</i> service is running. If the entry is a group name, this service will not start unless at least one of the <i>lpszDependencies</i> group members is running. Groups names must contain the SC_GROUP_IDENTIFIER prefix character, which is defined in WINSVC.H. Note that this also means that service names cannot begin with the SC_GROUP_IDENTIFIER prefix character.

<p>
If this parameter is NULL or the string is an empty string, this service has no dependencies.
</dd>
<dt>
<i>lpszAccount</i></dt>
<dd>
Input parameter. Points to a null-terminated string (with a maximum length of 256 characters) that contains the Windows NT user account of the person who administers the service.
<p>
The account name has the following format:

<p>
<i>DomainName</i>\<i>UserName</i>

<p>
If the account belongs to the built-in domain, you can use .\<i>UserName</i>. If this parameter is NULL, the service is logged in under the <b>LocalSystem</b> account and <i>lpszPassword</i> must be NULL.
</dd>
<dt>
<i>lpszPassword</i></dt>
<dd>
Input parameter. Points to a null-terminated string (with a maximum length of 256 characters) that contains the user account password. If this parameter is NULL or points to an empty string, the service has no password.
</dd>
</dl>
<h4>Return Values</h4>
<p>
See <a href="function_3odv.htm">Return Values</a>.</p>
<h4>Remarks</h4>
<p>
For more information on <b>HrInstallService</b>, see <a href="setups_8gf9.htm">Installing an Application as a Service</a>.</p>
<h4>See Also</h4>
<p>
<a href="function_34th.htm"><b>HrRemoveService</b></a></p>
<p>&nbsp;</p></body>
</HTML>
