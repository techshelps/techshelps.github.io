<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Determining the Type of Information Store</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_determining_the_type_of_information_store"></a>Determining the Type of Information Store</h2>
<p>
In some cases, your application may not know if a store is a Microsoft Exchange Server <a href="glossary_1oog.htm#_edk_public_information_store">public information store</a> or <a href="glossary_1oog.htm#_edk_private_information_store">private information store</a>, even though it has already obtained a pointer to it. To determine the type of <a href="glossary_1oo9.htm#_edk_information_store">information store</a>, check the value of the store’s PR_MDB_PROVIDER property. This procedure is performed within the <a href="function_5b39.htm"><b>FIsPublicStore</b></a> function.  </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To determine the type of information store</h5>
<ol>
<li>
Open the information store as described in <a href="infostor_6ehx.htm">Opening an Information Store</a>. The call to the <b>IMAPISession::OpenMsgStore</b> method creates the information store object and returns an LPMDB pointer to it. </li>
<li>
Call the <b>FIsPublicStore</b> function, passing the LPMDB pointer to the information store. This function checks the information store’s PR_MDB_PROVIDER property. If the value of this property is pbExchangeProviderPublicGuid, the store is a public information store and the function sets its output parameter <i>lpIsPublicStore</i> to TRUE. Other values for this property correspond to other types of information stores; for more information, see the following section.</li>
</ol>

<h4><a name="_edk_identifying_providers_by_provider_guids"></a>Identifying Providers by Provider GUIDs</h4>
<p>
Microsoft Exchange Server defines several <a href="glossary_1oo7.htm#_edk_globally_unique_identifier_guid_">GUIDs</a> in the EDKMDB.H file. The MAPI PR_MDB_PROVIDER property can have these values in the store table and when returned from a call to the <b>IMAPIProp::GetProps</b> method on the <a href="glossary_1oo9.htm#_edk_information_store">information store</a>, on a <a href="glossary_1oo6.htm#_edk_folder">folder</a>, or on message <a href="glossary_1oof.htm#_edk_object">objects</a>. The value returned identifies the type of information store provider.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=49%>GUID</th>
<th align=left width=51%>Information Store Provider</th>
</tr>
<tr valign=top>
<td width=49%>pbExchangeProviderPrimaryUserGuid</td>
<td width=51%><a href="glossary_1oog.htm#_edk_private_information_store">Private information store</a>. Calling application is the owner</td>
</tr>
<tr valign=top>
<td width=49%>pbExchangeProviderDelegateGuid</td>
<td width=51%>Private information store. Calling application has delegate access</td>
</tr>
<tr valign=top>
<td width=49%>pbExchangeProviderPublicGuid</td>
<td width=51%>Microsoft Exchange Server <a href="glossary_1oog.htm#_edk_public_information_store">public information store</a> </td>
</tr>
</table><br>
<p>
Another GUID is also used to recognize the Microsoft Exchange Server transport provider in the transports table.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=50%>GUID</th>
<th align=left width=50%>Type of Provider</th>
</tr>
<tr valign=top>
<td width=50%>pbExchangeProviderXportGuid</td>
<td width=50%>Microsoft Exchange Server transport provider </td>
</tr>
</table><br>
<p>
If a provider GUID does not match any of the entries in the preceding tables, it is not a provider specific to Microsoft Exchange Server.  </p>
<p>&nbsp;</p></body>
</HTML>
