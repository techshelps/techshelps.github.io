<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Removing a Gateway</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_gdk_removing_a_gateway"></a>Removing a Gateway</h2>
<p>
The <b>DoRemove</b> function in GWSETUP.C shows how to remove a gateway service’s entire installation. The following procedure lists the steps for removing a gateway in the order in which <b>DoRemove</b> performs them. You can use the steps that are relevant for removing your gateway.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To remove a gateway</h5>
<ol>
<li>
Present a dialog box in which the administrator can select an application to remove. The <b>ShowChooseServiceDlg</b> function displays such a dialog box.</li>
<li>
Determine whether the gateway service is running by calling the <b>FServiceRunning</b> function. If it is running, attempt to stop the service. </li>
<li>
Remove the directory object. Call the <a href="function_9fw9.htm"><b>HrRemoveGateway</b></a> function to remove a gateway object from a given site. This function is defined in EXCHINST.C.</li>
<li>
Remove performance monitoring for the service by calling the <a href="function_9ar2.htm"><b>HrRemoveServicePerfMon</b></a> function. If the <i>lpfUnloadCounters</i> parameter returned from this function call is TRUE, continue with step 5. If it is FALSE, multiple instances of the gateway are installed. In this case, perform steps 7 and 8, and then begin again at step 1.<p>
<b>Note</b>  The performance counters are unloaded and the registry entries are deleted only after all instances of the gateway have been removed.
</li>
<li>
Call the <b>FUnloadCounters</b> function to unload the counters used in performance monitoring.</li>
<li>
Remove the gateway’s keys from the Windows NT Registry by calling the <a href="function_97g9.htm"><b>HrRemoveRegistry</b></a> function.</li>
<li>
Remove the gateway service from the Windows NT service control manager by calling the <a href="function_34th.htm"><b>HrRemoveService</b></a> function. </li>
<li>
Delete the files belonging to the gateway using the <b>EDKDeleteNode</b> function.</li>
</ol>
<p>
The <b>DoRemove</b> function removes gateway components from the local computer. Server components in the Microsoft Exchange Server directory must be removed in a separate step using directory access functions. For example, address types and Administrator extensions are not removed because they may be needed by other applications. </p>
<p>
When removing a gateway, your program should not remove address templates and extension DLLs and their associated objects. This is because these components may still be in the process of being used by other applications.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
