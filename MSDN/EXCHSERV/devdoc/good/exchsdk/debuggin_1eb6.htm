<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Message Store Viewer</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_using_the_message_store_viewer"></a>Using the Message Store Viewer</h2>
<p>
The message store viewer (MDBVU32.EXE) is a <a href="glossary_1ood.htm#_edk_mapi">MAPI</a> client application that helps you debug your application by providing a view of information in a <a href="glossary_1ood.htm#_edk_mailbox">mailbox</a> or any other <a href="glossary_1oof.htm#_edk_object">object</a> in an <a href="glossary_1oo9.htm#_edk_information_store">information store</a>. This application displays the following information:
<ul>
<li>
A message or any other object in the exact format you will use in your application. </li>
<li>
A message as a set of properties and a collection of calls that can be performed on that object. </li>
<li>
A log of each MAPI action that has been performed against this object. </li>
<li>
Nested elements, such as attachments, and allows you to view them separately. </li>
</ul>
<p>
The message store viewer can be used to set and change properties, as well as view them. This is useful if you are writing a message-processing application. The message store viewer shows which properties are available on each message, how you can use them, and in what format they will appear. </p>
<p>
The message store viewer can also be used to debug messages. If you can successfully save a message but submitting it fails, you can save the message and look at all its properties with the message store viewer. This is far more efficient than writing code to dump the message's properties. </p>
<h4>Displaying a Folder Using the Message Store Viewer </h4>
<p>
Follow these steps from the message store viewer menu to display a <a href="glossary_1oo6.htm#_edk_folder">folder</a> in a <a href="glossary_1ood.htm#_edk_mailbox">mailbox</a>. The example displays the root folder of a gateway's mailbox:</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To display a folder using the message store viewer </h5>
<ol>
<li>
From the <b>Session</b> menu, choose <b>MAPILogonEx</b> if this option has not been chosen for you automatically.</li>
<li>
Choose <b>Profile</b>. Unless you specified the MAPI_NEW_SESSION flag, select the profile your application uses to log on. If you are already logged on, this step is unnecessary.</li>
<li>
From the <b>MDB</b> menu, choose <b>OpenMessageStore</b>. Use this option to select the store provider to be opened from among those configured in your profile. Although a user's profile may contain the public store, the private store, and zero or more personal folders, only one choice may be available for a server application that uses only the Microsoft Exchange Server private server. Choose <b>Open</b> from the <b>Public Folders</b> menu to view the public information store.</li>
<li>
From the <b>MDB</b> menu, choose <b>Open Root Folder</b> or <b>Open IPM Subtree</b>. The <b>Open IPM Subtree</b> option is not available for gateways because a gateway object does not contain an IPM Subtree. Once you have opened the Root Folder, a screen such as the following is displayed:</li>
</ol>
<p>
<img src="images/edg19_01.gif" border=0></p>
<p>
<b>View of a gateway's root folder using the message store viewer</b></p>
<p>
The preceding screen shows the root folder of a gateway's mailbox. You can now view the contents of other folders in the gateway's mailbox. For example, to view the gateway's inbox, double-click <b>MTS-IN</b> in the <b>Child Folders</b> list box.</p>
<p>
The <b>Properties</b> window shows which properties are set on the object. At the top of the <b>Properties</b> window, you may see properties that are numbered instead of labeled with property tags. These properties are customized by each provider, which in this case is the Microsoft Exchange Server store provider. Look in the header file for specific information on these properties. Custom properties for the Microsoft Exchange Server information store are defined in the EDKMDB.H file. Custom properties for the Microsoft Exchange Server directory are defined in the EMSABTAG.H file. Standard MAPI properties are identified by name rather than number.</p>
<p>
If you're processing messages, the message store viewer displays the message's exact appearance and properties. For instance, the utility will show you that a delivery report or nondelivery report differ in appearance and, therefore, have a different set of properties than a regular message. </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
