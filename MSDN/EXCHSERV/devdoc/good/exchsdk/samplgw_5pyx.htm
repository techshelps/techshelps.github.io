<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing the Sample Gateway</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_gdk_installing_the_sample_gateway"></a>Installing the Sample Gateway</h2>
<p>
If you are installing the sample gateway for the first time, or if you have changed any of the files listed here since your previous installation, you need to create a new GWSETUP.INF file before proceeding. Files referenced in GWSETUP.INF are:
<ul>
<li>
EDKADT.HLP</li>
<li>
GWPERF.DLL</li>
<li>
GWSAMPLE.EXE</li>
<li>
IPM_IN.DLL</li>
<li>
IPM_OUT.DLL</li>
<li>
PROXYGEN.DLL</li>
<li>
SGWADMIN.DLL</li>
<li>
SGWADMIN.HLP</li>
</ul>
<p>
</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create the GWSETUP.INF file</h5>
<ol>
<li>
Change to the \BKOFFICE\SAMPLES\EXCHANGE\GWSETUP directory.</li>
<li>
Type the following command:<p>
<b>NMAKE - F GWSETUP.MAK</b>
<p>
This process uses the default settings for the BLDTYPE and TARGETDIR environment variables unless you manually change them. You can view the environment variables by typing <b>SET</b> at the command prompt.
</li>
</ol>
<p>
</p>
<p>
You can install the sample gateway either by using the GWSETUP.EXE program to automatically install all the gateway components, or by installing individual gateway components. See <a href="samplgw_8cvn.htm">Installation Programs</a> for information on how to install components.</p>
<p>
The gateway setup program GWSETUP.EXE performs the following actions:
<ul>
<li>
Obtains information about the gateway environment and the Mail-Gateway object.</li>
<li>
Installs the Admin-Extension object for the gateway.</li>
<li>
Installs the Addr-Type object associated with the gateway.</li>
<li>
Copies the necessary files to the server.</li>
<li>
Creates the gateway site proxy address for the address type.</li>
<li>
Creates proxy addresses of the new address type for existing recipients in the Microsoft Exchange Server directory.</li>
<li>
Installs the Mail-Gateway object in the directory.</li>
<li>
Rebuilds the gateway address routing table (GWART).</li>
<li>
Installs the message conversion DLLs used by the gateway.</li>
<li>
Installs performance monitoring counters for the gateway service. (Note that GWSETUP.EXE only loads the counters; it doesn't actually install the performance monitor.)</li>
</ul>
<p>
</p>
<p>
These functions are discussed in <a href="gwsetup_78od.htm">Writing the Setup Program</a>.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To install the sample gateway using GWSETUP</h5>
<ol>
<li>
Select <b>Sample Gateway Setup</b> in the Microsoft Exchange Server SDK program group </li>
</ol>
<p>
– Or –</p>
<p class=indent1>
Change to the command prompt and run SETUP.EXE from the \BKOFFICE\BIN\GWSETUP directory.</p>
<ol start=2>
<li>
Click <b>Continue</b>.</li>
<li>
Click <b>Install</b>.</li>
<li>
In the <b>Choose Server</b> dialog box, enter the name of the computer running Microsoft Exchange Server on which you want to install the gateway, and click <b>Continue</b>.</li>
<li>
In the <b>Choose Site</b> dialog box, select the site name for the gateway (for example, /o=Microsoft/ou=site) and click <b>Continue</b>.</li>
<li>
In the <b>Directory Display Name</b> field of the <b>Install</b> dialog box, type the name of the gateway to be used by the Microsoft Exchange Server Administrator program (for example, <b>samplegw</b>).</li>
<li>
In the <b>Service Display Name</b> field, enter the name to be displayed for the gateway when it is listed as a service. This name can be the same as the <b>Directory Display Name</b>.</li>
<li>
For <b>Service Account</b>, enter the Windows NT Server account that has been created for the gateway. The account must have "Log On as Service" rights. This should be specified as domain\account (for example, operations\gwuser).</li>
<li>
For <b>Service Password</b>, enter the password for the Windows NT Server account.</li>
<li>
For <b>Service Directory</b>, enter the directory for the gateway executable file, including the drive name. (C:\GW is the default directory.)</li>
<li>
Click <b>Continue</b>.</li>
</ol>
<p>
</p>
<p>
The setup program performs the following tasks:
<ul>
<li>
Creates a directory with the path and name specified as <b>Service Directory</b> in step 10 above.</li>
<li>
Copies the gateway's executable file, GWSAMPLE.EXE, to the service directory.</li>
<li>
Creates two subdirectories, IN and OUT, under the service directory. The sample gateway uses these subdirectories for message processing.</li>
<li>
Displays a message when the gateway object is installed.</li>
</ul>
<p>
</p>
<p>
You can verify that the gateway object is installed by looking in the <b>Connections</b> container inside the Microsoft Exchange Administrator program for the gateway name. This is the <b>Directory Display Name</b> entered in step 6 above. If the gateway name is not there, click <b>Refresh</b> on the <b>Window</b> menu in the Administrator program. The name should then appear.</p>
<p>
The sample gateway uses the account and password information entered in steps 8 and 9 above. After the gateway service is installed, its associated account information can be changed through the Windows NT service control manager.</p>
<p>&nbsp;</p></body>
</HTML>
