<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Building a New DIRSYNC Instance</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_edk_building_a_new_dirsync_instance"></a>Building a New DIRSYNC Instance</h2>
<p>
The information used by DIRSYNC to execute its commands comes from one or both of the following sources:
<ul>
<li>
<a href="glossary_1oon.htm#_edk_windows_nt_registry">Windows NT Registry</a></li>
<li>
Command-line settings</li>
</ul>
<p>
</p>
<p>
Because DIRSYNC stores its configuration information in the registry, an instance name is generally used to give access to all the parameters in that instance. This instance name points to a location in the registry where the DIRSYNC configuration information is stored. If you specify an instance by its name only, DIRSYNC will look for its data in the following registry key:</p>
<p>
HKEY-LOCAL-MACHINE\SOFTWARE\MS EXCHANGE SAMPLES\DIRSYNC\&lt;<i>instance-name</i>&gt;</p>
<p>
The instance name is not necessary if all required information is supplied on the command line, or if the /KEY command-line flag is used to point to a registry key where instance data is stored.</p>
<p>
You can use the the Windows NT Registry to create and view instances, or you can run DIRSYNC with the /SET command-line flag. If you use the /SET flag, parameters entered from the command line are copied into the registry, but the requested operation is not performed. Without the /SET flag, DIRSYNC creates a transient instance that uses command-line flags, but does not update the registry.</p>
<p>
If you have not used the /SET flag, have not included all the information on the command line, and type an instance name that does not exist in the registry, DIRSYNC prompts you to create a new instance. If you answer <b>Y</b>, DIRSYNC writes to the registry key, but performs no operation — as if you had used the /SET flag. Answering <b>N</b> to this question exits the program. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To build DIRSYNC</h5>
<ol>
<li>
Change to the directory containing the DIRSYNC source files: <p>
\BKOFFICE\SAMPLES\EXCHANGE\DIRSYNC
</li>
<li>
Type <b>NMAKE</b>.</li>
</ol>
<p>
</p>
<p>
The following procedure shows how to set up a new instance of DIRSYNC without using the /SET command-line flag and with /SET.</p>
<p>
</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To set up a new DIRSYNC instance in the Registry</h5>
<ol>
<li>
Choose a name for your new instance. </li>
<li>
Type <b>DIRSYNC</b> and the instance name:<p>
<b>DirSync</b> &lt;<i>instance name</i>&gt;
<p>
If you type the following command and use an unknown instance name, DIRSYNC displays this message:
<pre><code>The instance &lt;<i>Instance-Name</i>&gt; is unknown. Create a new instance? (Y/N)
 </code></pre>
</li>
<li>
Type <b>Y</b> in response.<p>
If you type <b>N</b>, DIRSYNC terminates immediately. If you type <b>Y</b>, DIRSYNC creates the new registry keys and all the default values, exits, and displays the following message:
<pre><code>New NT Registry key created for instance HR-Database:
HKEY_LOCAL_MACHINE\SOFTWARE\EDK Samples\DIRSYNC\&lt;<i>Instance-Name</i>&gt; 
 </code></pre>
</li>
<li>
Display and change the required and optional parameters for this instance as you prefer by editing the registry keys as shown below. Spaces are allowed within instance names, as long as the command-line parameter is surrounded by quotes. For example: DIRSYNC "Instance Name With Spaces." </li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To set up a new DIRSYNC instance with the /SET command</h5>
<ol>
<li>
Type in all parameters to be set for the new instance and the /SET parameter. For example:<p>
<b>DIRSYNC &lt;<i>instance name</i>&gt; /SET /EXPORT /SITEDN=/O=ORGANIZATION/OU=SITE<br>
/CONTAINER=Recipients /DSA=server1 /EXPLIST=<br>
Obj-Class,Common-Name,Display-Name,<br>
USN-Changed/EXPFILE=C:\EXPORT.OUT</b>
</li>
<li>
Verify that the instance has been created by editing the Windows NT Registry as shown in the next procedure.</li>
</ol>
<p>
</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To display and edit the new DIRSYNC instance</h5>
<ol>
<li>
Choose <b>Windows NT Diagnostics</b> from the Administrative Tools group.</li>
<li>
Choose <b>Registry Editor </b>from the <b>Tools</b> menu in the dialog box. Several windows representing Windows NT Registry keys appear.</li>
<li>
From the HKEY_LOCAL_MACHINE on <b>Local Machine</b> window, choose <b>SOFTWARE</b>. Choose Microsoft Exchange Server SDK Samples\DIRSYNC and click once. </li>
<li>
Click the directory icon for your new instance. All registry keys with their current values appear. Check that all the keys are correctly set.</li>
</ol>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
