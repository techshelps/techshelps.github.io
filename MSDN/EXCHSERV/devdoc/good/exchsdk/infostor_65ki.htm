<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Opening an Existing Public Folder</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_edk_opening_an_existing_public_folder"></a>Opening an Existing Public Folder</h3>
<p>
<a href="glossary_1oog.htm#_edk_public_folder">Public folders</a> are located in the Microsoft Exchange Server <a href="glossary_1oog.htm#_edk_public_information_store">public information store</a>, which is a portion of the information store. Therefore, before you can access public folders, you must locate and open the public information store. </p>
<p>
You can open an existing folder if you know either its entry identifier or a path to the folder, including the value of its Display-Name property. It is faster if you use the entry identifier to open the folder, if you know it. Also, folder paths or names may change, so reusing a path to a folder that once worked may fail. A folder’s entry identifier remains the same, so using it should work reliably.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To open an existing public folder using the HrOpenExchangePublicFolders function</h5>
<ol>
<li>
Open the public information store by calling the <a href="function_91id.htm"><b>HrOpenExchangePublicStore</b></a> function. For more information, see <a href="infostor_8u79.htm">Opening a Public Information Store</a>.</li>
<li>
Open the All Public Folders <a href="glossary_1oo3.htm#_edk_container">container</a> by calling the <a href="function_91ir.htm"><b>HrOpenExchangePublicFolders</b></a> function and passing the LPMDB pointer to the public information store. This returns an LPMAPIFOLDER pointer to the open folder. </li>
<li>
Call either the <a href="function_8zeg.htm"><b>HrMAPIFindSubfolderEx</b></a> function or the <a href="function_0soo.htm"><b>HrMAPIOpenSubfolderEx</b></a> function. In each case, pass both the pointer returned in step 2 and the path to the folder, as described in <a href="infostor_2esz.htm">Expressing Paths to Folders</a>. <p>
The <b>HrMAPIFindSubfolderEx</b> function returns the entry identifier of the folder, which you can use to open it later. The <b>HrMAPIOpenSubfolderEx</b> function locates the folder and opens it for you.
</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To open an existing public folder using the HrMAPIOpenFolderEx function</h5>
<ol>
<li>
Open the public information store by calling the <a href="function_91id.htm"><b>HrOpenExchangePublicStore</b></a> function. For more information, see <a href="infostor_8u79.htm">Opening a Public Information Store</a>.</li>
<li>
Open the IPM_SUBTREE folder by calling the <a href="function_88u0.htm"><b>HrMAPIOpenFolderEx</b></a> function, and passing either a folder path or folder name. For more information, see <a href="infostor_2esz.htm">Expressing Paths to Folders</a>.<p>
This call returns an LPMAPIFOLDER pointer to the open folder. At this point, you have opened the All Public Folders container. 
</li>
<li>
Call either the <b>HrMAPIFindSubfolderEx</b> function or the <b>HrMAPIOpenSubfolderEx</b> function. In each case, pass both the pointer returned in step 2 and the path to the folder. <p>
The <b>HrMAPIFindSubfolderEx</b> function returns the entry identifier of the folder, which you can use to open it later. The <b>HrMAPIOpenSubfolderEx</b> function locates the folder and opens it for you.
</li>
</ol>
<p>
<b>Note</b>  The Favorites folder can contain only one level of subfolders. These subfolders can contain messages, but not other subfolders.</p>
<p>&nbsp;</p></body>
</HTML>
