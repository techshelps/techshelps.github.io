<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Exceptions to Recurring Events</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_splus_creating_exceptions_to_recurring_events"></a>Creating Exceptions to Recurring Events</h2>
<p>
After creating a recurring event, you can specify exceptions to the recurrence pattern. For example, you can define an event that recurs on Monday of every week, except for those weeks in which Monday is a holiday. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create an exception to a recurring event</h5>
<ol>
<li>
Use the <a href="spchap6_6a47.htm"><b>New</b></a> method to create a new item in the Exceptions table.</li>
<li>
Set the desired properties on the item.</li>
<li>
Release the objects.</li>
</ol>
<p>
The following sample code creates an exception to a recurring event:</p>
<pre><code>Public Sub AddException2(objItem As Object)
    Dim objException As Object
    Dim dt As Date
    
    'Note: objItem is a RecurringEvent object.
    
    'Create an exception that deletes an instance of the recurrence pattern.
    dt = #11/16/95#
    Set objException = objItem.Exceptions.New
    
    'Set the desired properties on the item.
    objException.SetProperties InstanceDate:=LConvertTo32bitDate(dt), Deleted:=True
    
    'Release the object.
    objException = Nothing
    
    'Create an exception that modifies an instance of the recurrence pattern.
    dt = DateAdd("w", 1, dt)
    Set objException = objItem.Exceptions.New
    
    'Set the desired properties on the item.
    objException.SetProperties InstanceDate:=LConvertTo32bitDate(dt), Deleted:=False
    Text:="Exception"
    
    'Release the object.
    objException = Nothing
End Sub
 </code></pre>
<p>
You can also create exceptions to recurring events by deleting or modifying specific instances in the merged tables.</p>
<p>
After you delete an instance of the recurring event, Schedule+ automatically removes that instance from the Events table and creates a new item in the Exceptions table. To determine which items are exceptions, an application can scan the Exceptions table and examine the properties of each Exception item. For example, the <a href="spchap4b_06lh.htm"><b>InstanceDate</b></a> property indicates the date on which the item would have occurred if it had not been deleted.</p>
<p>
The series of steps for creating a recurring appointment or task is similar, but you must delete instances of the recurring appointment from the Appointments table and instances of the recurring task from the Tasks table.</p>
<p>&nbsp;</p></body>
</HTML>
