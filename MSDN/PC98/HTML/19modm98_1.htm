<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PC 98 Modem Design Issues</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<font face="verdana,arial,helvetica" size="2"><form name=x><object name=iv classid="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016">
</object></form>
<h1><a name="pc98modemdesignissues"></a>PC 98 Modem Design Issues</h1>
<p>
This section presents the key design issues for modems. The Windows and Windows&nbsp;NT operating systems and Win32-based applications use data, fax, voice, and voice/data integration features in modems.</p>
<p>
<b>Note:</b> Communications standards mentioned in this chapter are available through ITU Sales, Bellcore, ETSI, or Global Engineering Documents, as described in the “Modem References” section at the end of this chapter.</p>
<p>
<b>Basic PC 98 Modem. </b>The fundamental design principle for compatibility with Windows is for the device to be supported by the Universal Modem Driver (Unimodem), which uses INF files to characterize the behavior of a device. A&nbsp;detailed definition of Unimodem requirements is contained in the MDK, available at ftp://ftp.microsoft.com/developr/drg/modem/modemdev.exe.</p>
<p>
The new PC&nbsp;98 requirements and recommendations are directed at the following issues:
<ul>
<li>
Migrating to even higher speeds of dial-up access based on pulse-code modulation (PCM) modems (that is, ITU V.pcm, X2, and K56Flex).<br><br></li>
<li>
Addressing persistent cost-of-ownership problems, particularly modem detection and installation and Internet Service Provider (ISP) call failures.<br><br></li>
<li>
Migrating modem functions into the operating system to save costs and to provide upgrade flexibility.<br><br></li>
<li>
Addressing the failure of many voice modems to meet the needs of ISVs who&nbsp;are implementing computer-based telephony and need new features to be&nbsp;successful.</li>
</ul><p>
<b>Migrating to Higher Speeds with PCM Modems. </b>V.34, as advanced as it is, is not the end of the line for telephone-line modems. ISP access is the driving force for modem use. ISPs use high-density modem pools, which connect to the Public Switched Telephone Network (PSTN) using T1 or ISDN primary rate interface (PRI) links. This creates an opportunity, because the ISP-side modem has direct access to the inside of the digital telephone network, so it can directly modulate the PCM B-channel data.</p>
<p>
PCM means that the impairments on the ISP-side analog loop have disappeared; there is no quantization noise or echo. The symbol rate on the remaining loop jumps from 3429 to 8000 per second from the ISP to the end user. The number of&nbsp;bits per symbol is limited by the channel’s remaining frequency limitations and&nbsp;the signal power limits imposed by regulatory agencies (to limit cross talk in&nbsp;phone-wire trunks).</p>
<p>
This opportunity has spawned diverse approaches. In early 1997, two similar but&nbsp;incompatible proprietary specifications exist: X2 and K56flex. Work is proceeding toward a first-stage international standard: V.pcm. This work will be&nbsp;completed early in 1998.</p>
<p>
<b>Addressing Cost of Ownership for Modems. </b>The two largest cost-of-ownership issues for modems are installation problems and operations problems related to creating connections. Plug and Play minimizes installation problems when correctly implemented. However, the explosion in ISP usage has highlighted operations problems. According to public studies, 16.2 percent of ISP access calls fail to connect, and ISPs are commonly spending $6 per subscriber per month in technical support.</p>
<p>
A smaller percentage of access calls fail after the connection is made. This failure rate is not acceptable. Three elements needed to change this are:
</p>
<ul><li>
Modem and PSTN diagnostics.<br><br></li>
<li>
Modems that can easily be upgraded.<br><br></li>
<li>
Deterministic modem identification so that upgraded modems still work.</li>
</ul><p>
In consultation with leading ISPs and modem manufacturers, Microsoft is developing a standard method for modems to report last-call statistics: the Unimodem Diagnostics command, or AT#UD, as described in the specification on&nbsp;http://www.microsoft.com/hwdev/specs/. This command will be used by Windows and ISP software. The reported last-call information is essential to illuminate problems in user modems, local phone loops, local offices, and ISP-side modems so that they can be diagnosed and fixed.</p>
<p>
After a problem has been found, requiring users to replace their modems to fix&nbsp;that problem is too costly for both the user and the manufacturer. Some manufacturers already make their modems with upgradable memory, allowing painless feature or bug-fix upgrades for their customers. The makers of Windows-based modems have also offered this advantage. It is time to make easy&nbsp;user upgradability an industry-wide standard.</p>
<p>
But even upgrades can pose hazards. For modems that do not support Plug and Play, the Windows Modem class installer reads a series of AT commands, implements a proprietary algorithm to generate a 32-bit ID, and uses that ID to match to the modem driver. Manufacturers might inadvertently change responses that Unimodem depends on for computing the unique Unimodem ID (ATI and other commands), leaving the user with a modem that is recognized as a “Standard Modem” instead of the actual modem name.</p>
<p>
To address the detection problem, modem vendors are required to use bus-specific Plug and Play means to deliver the CompatibleID command, and they are encouraged to use standard methods to report accurate manufacturer and modem names. For information, see specifications for new Unimodem commands and related articles at http://www.microsoft.com/hwdev/hwdev/devdes/.</p>
<p>
<b>Migrating Functions to the Operating System with Windows Modems. </b>A traditional modem has several functions implemented in hardware or firmware:
</p>
<ul><li>
Telephone network connection—connectors, transformers, relays, codec<br><br></li>
<li>
Digital signal processing—V.34, V.32bis, V.8bis, dual tone multifrequency (DTMF), voice processing, speakerphone echo cancellation, and so on<br><br></li>
<li>
Modem controller—AT command interpreter (for example, V.25ter)<br><br></li>
<li>
Protocol stacks—V.42 error control, V.42bis data compression</li>
</ul><p>
A Windows modem moves some of these functions into Windows drivers. A controllerless modem (also known as a host-based controller) is a modem that consists of a digital signal processor (DSP) without the usual microcontroller. The&nbsp;host CPU provides the AT command interpreter, modem control functions, V.42, and V.42bis implementation.</p>
<p>
A software modem (also known as host-based signal-processing modem or pumpless modem) performs signal processing on the host Pentium processor or&nbsp;compatible microprocessor and implements the controller as described in the&nbsp;previous paragraph. The modem hardware consists only of a telephone-line interface and DAC and ADC circuitry such as a PCM codec, plus a little bit more.&nbsp;However, the hardware does not contain DSP or a microcontroller.</p>
<p>
Advantages of software modems include the following:
</p>
<ul><li>
Cost savings<br><br></li>
<li>
Flexibility for upgrading to V.pcm, fixing bugs, and so on<br><br></li>
<li>
Data processing occurs in the CPU, where it fits<br><br></li>
<li>
Separate data and control paths to the hardware are available</li>
</ul><p>
Disadvantages of software modems include the following:</p>
<ul>
<li>
CPU-based functions compete for resources with other uses, such as the operating system, applications, multimedia codecs, and so on<br><br></li>
<li>
Difficult to support multiple platforms, including Windows 3.1, Windows&nbsp;95, Windows&nbsp;NT 3.<i>x</i>, and Windows&nbsp;NT 4.0, in addition to current and future versions of the Windows and Windows&nbsp;NT operating systems<br><br></li>
<li>
Difficult for users to install retail versions<br><br></li>
<li>
Difficult for automatic upgrade during operating system upgrade</li>
</ul><p>
Controllerless and software modems are built as custom VxD drivers for Windows and as custom system (.Sys) drivers for Windows&nbsp;NT; each platform&nbsp;requires a different driver. For PC&nbsp;98, WDM Modem support will provide a common interface so that one driver runs on both Windows&nbsp;98 and&nbsp;Windows&nbsp;NT&nbsp;5.0.</p>
<p>
<b>Missing Features in Voice Modems. </b>Voice modems are devices that allow a PC&nbsp;to communicate with a speaking and listening human at the other end of a&nbsp;telephone line. These modems digitize the incoming voice for recording; play back digitized audio; and detect various signals such as DTMF, call progress tones, and so on.</p>
<p>
Voice capabilities started appearing in modems in the early 1990s, aided by the completion and publication of TIA IS-101 in 1993—the interim standard for Voice Data Communications Equipment (DCE).  Now the trial period is over and the TIA-695 standard is complete. In mid-1997, at least 30 percent of modems provided for retail sales were voice capable, with a larger percentage in OEM sales. The following trends are important:</p>
<ul>
<li>
Computer Telephony (CT). ISVs are figuring out what voice modems need.<br><br></li>
<li>
Voice-only devices emerging as a separate category (that is, CT telephones).<br><br></li>
<li>
Local handset or telset audio.<br><br></li>
<li>
Full-duplex audio for a number of applications.</li>
</ul><p>
The first applications for voice modems were focused on telephone answering machine (TAM) functions, such as Microsoft Phone. Some applications, such as Microsoft Operator, use voice modems for adaptive incoming-call selection. Now that the software community has had a chance to experiment, the interest in voice modems has expanded to include the following:
</p>
<ul><li>
Speakerphone capabilities, either through the PC or outside of it<br><br></li>
<li>
Low-end interactive voice response (IVR) equipment (for example, play voice while performing speech recognition and speaker recognition)<br><br></li>
<li>
IP telephony bridging<br><br></li>
<li>
Voice-only modems, some of which are integrated with a PC-connected telephone instrument (telset)</li>
</ul>
</font></BODY>
</HTML>
