<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Device Drivers and Installation for Printers</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<font face="verdana,arial,helvetica" size="2"><form name=x><object name=iv classid="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016">
</object></form>
<h1><a name="devicedriversinstallationforprinters"></a>Device Drivers and Installation for Printers</h1>
<p>
This section summarizes device driver requirements for printers. The items in this section are requirements for all PC 98 systems.</p>
<p>
<b>9. Printer INF file and installation meet PC 98 requirements</h1>
<table border=1 cols=3 frame=void rules=rows>
<tr valign=top>
<td width=30%><b>Required</b></td>
<td width=30%></td>
<td width=30%></td>
</tr>
</table><br>
<p>
Each device requires a printer INF file for both Windows and Windows&nbsp;NT operating systems. The manufacturer does not need to supply a printer INF file if&nbsp;a standard printer INF file provided with the operating system can be used.</p>
<p>
If the manufacturer provides an INF file, it must be complete and free of errors. This INF file must comply with the printer-specific extensions listed in the Windows and Windows&nbsp;NT DDKs.</p>
<p>
If the manufacturer supplies an INF file or another file, the requirements for printer INF files and installation include the following:
<ul>
<li>
All devices and files must pass PC 98 compliance testing<br><br></li>
<li>
All configuration settings are stored in the registry<br><br></li>
<li>
The correct files specified in the device’s INF file must be installed in the correct locations<br><br></li>
<li>
Driver installation and removal use Windows-based methods as defined in the Windows and Windows&nbsp;NT DDKs<br><br></li>
<li>
Files provided by the vendor must not use the same file names used by files included in Windows operating systems unless specifically agreed upon with&nbsp;Microsoft</li></ul>
<p>
For complete details about standard installation requirements for device drivers, see the “Basic PC&nbsp;98” chapter in Part 2 of this guide.</p>
<p>
<b>10. Driver correctly reports device capabilities</b>
</p>
<table border=1 cols=3 frame=void rules=rows>
<tr valign=top>
<td width=30%><b>Required</b></td>
<td width=30%></td>
<td width=30%></td>
</tr>
</table><br>
<p>
For Windows, this means that the driver correctly supports the DEVMODE structure as defined in the Windows and Windows&nbsp;NT DDKs.</p>
<p>
<b>11. Driver supports error notification</h1>
<table border=1 cols=3 frame=void rules=rows>
<tr valign=top>
<td width=30%><b>Required</b></td>
<td width=30%></td>
<td width=30%></td>
</tr>
</table><br>
<p>
At a minimum, the device driver must support notifying the user of errors reported by the hardware.</p>
<p>
<b>12. Driver supports ICC color matching</h1>
<table border=1 cols=3 frame=void rules=rows>
<tr valign=top>
<td width=30%><b>Required</b></td>
<td width=30%></td>
<td width=30%></td>
</tr>
</table><br>
<p>
Windows and Windows&nbsp;NT support using color profiles that comply with the ICC&nbsp;Profile Format specification. For contact information on device profiles, see&nbsp;the references at the end of this chapter. The ICM APIs and functionality for&nbsp;Windows and Windows&nbsp;NT are described in the Win32 SDK and the Windows&nbsp;NT 5.0 DDK.</p>
<p>
For PC&nbsp;98, color-capable devices such as desktop monitors, printers, scanners, still-image cameras, LCDs, color plasma displays, or other flat-panel devices are required to install one or more ICC profiles for ICM. Providing a monitor color-calibration utility is recommended for generating, editing, and installing ICC profiles. The sRGB profile will be distributed in Windows and Windows&nbsp;NT.</p>
<p>
<b>13. Port monitor software meets DDK guidelines</h1>
<table border=1 cols=3 frame=void rules=rows>
<tr valign=top>
<td width=30%><b>Required</b></td>
<td width=30%></td>
<td width=30%></td>
</tr>
</table><br>
<p>
If the device includes bi-directional port monitor software that replaces the default Windows port monitor, then this software must accurately report errors. For information about implementing port monitor software, see the Windows and Windows&nbsp;NT DDKs.</p>
<p>
<b>14. Driver supports point-and-print network installation</h1>
<table border=1 cols=3 frame=void rules=rows>
<tr valign=top>
<td width=30%><b>Required</b></td>
<td width=30%></td>
<td width=30%></td>
</tr>
</table><br>
<p>
This means that the user is not required to provide disks or files when installing a&nbsp;new printer of the same type as another printer already on the network.</p>
<p>
<b>15. Device available immediately following installation</h1>
<table border=1 cols=3 frame=void rules=rows>
<tr valign=top>
<td width=30%><b>Required</b></td>
<td width=30%></td>
<td width=30%></td>
</tr>
</table><br>
<p>
The user should not have to restart the system immediately after device installation in order to print.</p>
<p>
<b>16. Device supports accurate printable regions</h1>
<table border=1 cols=3 frame=void rules=rows>
<tr valign=top>
<td width=30%><b>Required</b></td>
<td width=30%></td>
<td width=30%></td>
</tr>
</table><br>
<p>
The printable regions that can be selected in the user interface must be accurately supported in the actual print output.</p>
<p>
<b>17. Driver supports required DDIs</h1>
<table border=1 cols=3 frame=void rules=rows>
<tr valign=top>
<td width=30%><b>Required</b></td>
<td width=30%></td>
<td width=30%></td>
</tr>
</table><br>
<p>
For Windows&nbsp;NT drivers, the device driver interfaces (DDIs) are defined in the Windows&nbsp;NT DDK. Win32-based printer drivers ensure that print commands from Windows&nbsp;NT-based applications are executed correctly on the specified printer or plotter. Because Win32 APIs are not hardware-specific, it is the job of&nbsp;each printer driver to interpret the commands for its specific hardware.</p>
<p>
For Windows drivers, this requirement includes correct support of all features advertised for the device, plus required support for Windows features. The DDIs that must be supported are listed in the “Printer Driver Overview” section of the Windows DDK. This includes the following support, in addition to other support defined in the DDK:
<ul>
<li>
TrueType glyph indexes<br><br></li>
<li>
Big fonts (those that require more than 64K to express)<br><br></li>
<li>
Enhanced metafile (EMF) spooling<br><br></li>
<li>
Bezier curve output<br><br></li>
<li>
Services from the Windows device-independent bitmap (DIB) engine</li>
</ul>
<p>
<b>18. Driver based on unidriver</b></p>
<table border=1 cols=3 frame=void rules=rows>
<tr valign=top>
<td width=30%><b>Recommended</b></td>
<td width=30%></td>
<td width=30%></td>
</tr>
</table><br>
<p>
Microsoft provides a universal printer driver (unidriver), which is capable of carrying out requests (such as printing text, rendering bitmaps, or advancing a page) on most printer types. To build a driver for a particular printer, a developer builds a minidriver. This minidriver accepts requests from the GDI and then, in&nbsp;most cases, passes the request to the unidriver along with information that describes the capabilities, commands, and resident fonts of the particular printer. For more information, see the Windows&nbsp;NT and Windows DDKs.</p>
</font></BODY>
</HTML>
