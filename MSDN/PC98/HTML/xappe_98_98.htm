<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Clock Sequence</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<font face="verdana, arial, helvetica" size="2"><h1>
Clock Sequence</h1>
<p>
The clock sequence value must be changed whenever:
<ul>
<li>
The UUID generator detects that the local value of UTC has gone backward.<br><br></li>
<li>
The UUID generator has lost its state of the last value of UTC used, indicating that time <i>may</i> have gone backward; this is typically the case on reboot.<p>
While a node is operational, the UUID service always saves the last UTC used to create a UUID. Each time a new UUID is created, the current <i>UTC</i> is compared to the saved value and if either the current value is less (the non-monotonic clock case) or the saved value was lost, then the <i>clock sequence</i> is incremented modulo 16,384, thus avoiding production of duplicate UUIDs.
<p>
The <i>clock sequence</i> must be initialized to a random number to minimize the correlation across systems. This provides maximum protection against <i>node</i> identifiers that may move or switch from system to system rapidly. The initial value MUST NOT be correlated to the node identifier.
<p>
The rule of initializing the <i>clock sequence</i> to a random value is waived if, and only if all of the following are true:
</li>
<li>
The <i>clock sequence</i> value is stored in non-volatile storage.<br><br></li>
<li>
The system is manufactured such that the IEEE address ROM is designed to be inseparable from the system by either the user or field service, so that it cannot be moved to another system.<br><br></li>
<li>
The manufacturing process guarantees that only new IEEE address ROMs are used.<br><br></li>
<li>
Any field service, remanufacturing or rebuilding process that could change the value of the clock sequence must reinitialise it to a random value.<p>
In other words, the system constraints prevent duplicates caused by possible migration of the IEEE address, while the operational system itself can protect against non-monotonic clocks, except in the case of field service intervention. At manufacturing time, such a system may initialise the clock sequence to any convenient value.
</li>
</ul>
</font></BODY>
</HTML>
