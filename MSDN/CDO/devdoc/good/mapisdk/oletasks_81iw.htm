<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Reading a Message from the Inbox</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_reading_a_message_from_the_inbox"></a>Reading a Message from the Inbox  <a href="oletasks_4ofn.htm"><img src="images/group.gif" border=0></a></h1>
<p>
After establishing a Session object and successfully logging on to the system, a user can access the <i>Inbox</i>. The Inbox is the default folder for mail received by the user. </p>
<p>
As described in <a href="oleoview_7vvy.htm">CDO Library Object Design</a>, the CDO Library objects are organized in a hierarchy. The Session object at the topmost level allows access to a Folder object. Each folder contains a Messages collection, which contains individual Message objects. The text of the message appears in its <b>Text</b> property. </p>
<p>
<a href="oleobjis_57w4.htm">Session</a> object <br>
&nbsp;  &nbsp;  <a href="oleobjaf_4u2c.htm">Folder</a> object <br>
&nbsp;  &nbsp;  &nbsp;  &nbsp;  <a href="oleobjis_1qd0.htm">Messages</a> collection <br>
&nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  <a href="oleobjis_2p10.htm">Message</a> object <br>
&nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  <a href="oleobjis_0e5h.htm"><b>Text</b></a> property </p>
<p>
To obtain an individual message, the application must move down through this object hierarchy to the <b>Text</b> property. The following example uses the Session object's <a href="oleobjis_7jqm.htm"><b>Inbox</b></a> property to obtain a Folder object, then uses the folder's <a href="oleobjaf_2jsi.htm"><b>Messages</b></a> property to obtain a Messages collection object, and calls the collection's methods to get a specific message. </p>
<p>
This code fragment assumes that the application has already created the Session object variable <i>objSession</i> and successfully called the Session object's <a href="oleobjis_31ym.htm"><b>Logon</b></a> method, as described in <a href="oletasks_6q7i.htm">Starting a CDO Session</a>: </p>
<pre><code>Dim objSession As MAPI.Session ' Session object 
Dim objInboxFolder As Folder   ' Folder object 
Dim objInMessages As Messages  ' Messages collection 
Dim objOneMsg As Message       ' Message object 
' ... 
' move down through the hierarchy 
Set objInboxFolder = objSession.Inbox 
Set objInMessages = objInboxFolder.Messages 
Set objOneMsg = objInMessages.GetFirst 
MsgBox "The message text: " &amp; objOneMsg.Text 
 </code></pre>
<p>
<b>Note</b>  Use the Microsoft® Visual Basic® keyword <b>Set</b> whenever you initialize a variable that represents an object. When you attempt to set an object variable without using the <b>Set</b> keyword, Visual Basic generates an error message. </p>
<p>
The preceding code fragment declares several object variables. However, it is also possible to access the message with fewer variables. The following code fragment is equivalent to the preceding code, and is preferable if you have no subsequent need for the Inbox folder or its <a href="oleobjis_1qd0.htm">Messages</a> collection: </p>
<pre><code>Set objOneMsg = objSession.Inbox.Messages.GetFirst 
MsgBox "The message text: " &amp; objOneMsg.Text 
 </code></pre>
<p>
You should declare an individual variable when the application needs to access an object more than once. When an object is accessed repeatedly, variables can help make your code efficient. For more information, see <a href="oletasks_1gv9.htm">Improving Application Performance</a>. </p>
<h4>See Also</h4>
<p>
<a href="oletasks_7nz9.htm">Creating and Sending a Message</a>, <a href="oletasks_9vad.htm">Searching for a Message</a> </p>
<p>&nbsp;</p></body>
</HTML>
