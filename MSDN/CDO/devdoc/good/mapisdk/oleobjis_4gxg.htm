<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MessageFilter Object</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_messagefilter_object"></a>MessageFilter Object</h1>
<p>
The MessageFilter object specifies criteria for restricting a search on a <a href="oleobjis_1qd0.htm">Messages</a> collection. </p>
<h4>At a Glance </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Specified in type library: </td>
<td width=52%>CDO.DLL </td>
</tr>
<tr valign=top>
<td width=48%>First available in: </td>
<td width=52%>CDO Library version 1.1 </td>
</tr>
<tr valign=top>
<td width=48%>Parent objects: </td>
<td width=52%><a href="oleobjis_1qd0.htm">Messages</a> collection </td>
</tr>
<tr valign=top>
<td width=48%>Child objects: </td>
<td width=52%><a href="oleobjaf_0yt0.htm">Fields</a> collection </td>
</tr>
<tr valign=top>
<td width=48%>Default property: </td>
<td width=52%><a href="oleobjis_6l7j.htm"><b>Subject</b></a> </td>
</tr>
</table><br>
<h4>Properties </h4>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=32%><br>
Name </th>
<th align=left width=18%>Available since version </th>
<th align=left width=32%> <br>
Type </th>
<th align=left width=18%> <br>
Access </th>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjaf_1bbz.htm"><b>Application</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>String </td>
<td width=18%>Read-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjaf_3a1r.htm"><b>Class</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Long </td>
<td width=18%>Read-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_0bq7.htm"><b>Conversation</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>String </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_110f.htm"><b>Fields</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Field object or Fields collection object </td>
<td width=18%>Read-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_453z.htm"><b>Importance</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Long </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_4p5r.htm"><b>Not</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Boolean </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_7tun.htm"><b>Or</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Boolean </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjaf_03rz.htm"><b>Parent</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Messages collection object </td>
<td width=18%>Read-only </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=18%></td>
<td width=32%></td>
<td width=18%></td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_3en3.htm"><b>Recipients</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>String </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_3gm7.htm"><b>Sender</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>String </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_00kf.htm"><b>Sent</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Boolean </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjaf_6o0v.htm"><b>Session</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Session object </td>
<td width=18%>Read-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_1467.htm"><b>Size</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Long </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=18%></td>
<td width=32%></td>
<td width=18%></td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_6l7j.htm"><b>Subject</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>String </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_907z.htm"><b>Text</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>String </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_4cm7.htm"><b>TimeFirst</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Variant (<b>vbDate</b> format) </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_047z.htm"><b>TimeLast</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Variant (<b>vbDate</b> format) </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_4jmn.htm"><b>Type</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>String </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_1s2n.htm"><b>Unread</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Boolean </td>
<td width=18%>Read/write </td>
</tr>
</table><br>
<h4>Methods </h4>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=32%><br>
Name </th>
<th align=left width=18%>Available since version </th>
<th align=left width=50%> <br>
Parameters </th>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjis_41un.htm"><b>IsSameAs</b></a> </td>
<td width=18%>1.1 </td>
<td width=50%><i>objMsgFilter2</i> as <b>Object</b> </td>
</tr>
</table><br>
<h4>Remarks </h4>
<p>
A MessageFilter object with no criteria is created by default for every <a href="oleobjis_1qd0.htm">Messages</a> collection. This means that initially the filter's properties are unset and its child <a href="oleobjaf_0yt0.htm">Fields</a> collection is empty. You specify the filter by setting values for its properties or for fields in its Fields collection. You do not need to call any <b>Update</b> method when setting filter criteria. </p>
<p>
The filter is invoked when the Messages collection is traversed with the <b>Get</b> methods or the Microsoft® Visual Basic® <b>For Each</b> construction. Each field participates in a MAPI search restriction comparing the field's <a href="oleobjaf_92zo.htm"><b>Value</b></a> property against the value of the Message object's property specified by the field's <a href="oleobjaf_0kmc.htm"><b>ID</b></a> property. </p>
<p>
When you are traversing a Messages collection instantiated by a CDO rendering application, you should declare the Visual Basic variable to be an <b>Object</b> instead of a Message. This is because the collection may be from a calendar folder, and also because a rendering may have applied a grouped view to the folder. Therefore you can get <a href="oleobjaf_5flg.htm">AppointmentItem</a>, <a href="oleobjis_852s.htm">GroupHeader</a>, and <a href="oleobjis_4kac.htm">MeetingItem</a> objects returned as well as <a href="oleobjis_2p10.htm">Message</a> objects. You should also test the <a href="oleobjaf_3a1r.htm"><b>Class</b></a> property of each returned object to see if it is an appointment, a group header, a meeting, or a message: </p>
<pre><code>Dim objMember As Object ' could get one of several classes 
  ' collMessages is instantiated from a rendering application 
  ' assume collMessages valid 
  ' ... 
  For Each objMember in collMessages ' collection from a rendering 
    If objMember.Class = CdoMsg ' exclude other classes 
      ' we have a Message object 
    End If 
  Next 
 </code></pre>
<p>
For fields of data type other than <b>String</b>, the MAPI search restriction type is RES_PROPERTY with relational operator RELOP_EQ. For fields of data type <b>String</b>, the restriction type is RES_CONTENT with fuzzy level options FL_SUBSTRING, FL_IGNORECASE, and FL_LOOSE. However, the following MAPI properties are compared using FL_PREFIX instead of FL_SUBSTRING: </p>
<p class=indent1>
PR_ACCOUNT </p>
<p class=indent1>
PR_BUSINESS_ADDRESS_CITY </p>
<p class=indent1>
PR_COMPANY_NAME </p>
<p class=indent1>
PR_DEPARTMENT_NAME </p>
<p class=indent1>
PR_DISPLAY_NAME </p>
<p class=indent1>
PR_GIVEN_NAME </p>
<p class=indent1>
PR_OFFICE_LOCATION </p>
<p class=indent1>
PR_SURNAME </p>
<p class=indent1>
PR_TITLE </p>
<p>
If the underlying messaging system does not support the search criteria specified by the filter fields, the <b>Get</b> methods return <b>CdoE_TOO_COMPLEX</b>. In particular, a given field may not be supported by a particular message store. </p>
<p>
You can apply a MessageFilter object to a <a href="oleobjis_1qd0.htm">Messages</a> collection containing <a href="oleobjaf_5flg.htm">AppointmentItem</a> objects. However, the current version of CDO only supports filtering on the <a href="oleobjaf_8ndr.htm"><b>EndTime</b></a> and <a href="oleobjaf_10wv.htm"><b>StartTime</b></a> properties. An attempt to filter on any other properties, including the inherited <a href="oleobjis_2p10.htm">Message</a> object properties, returns <b>CdoE_TOO_COMPLEX</b>. <a href="oleobjis_4kac.htm">MeetingItem</a> objects are members of a Messages collection belonging to a messaging user's Inbox, and they can be filtered on any properties, including the inherited Message object properties. </p>
<p>
The MAPI search restrictions for appointment properties are as follows: </p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=41%>Property tag </th>
<th align=left width=27%>Restriction type </th>
<th align=left width=32%>Relational operator </th>
</tr>
<tr valign=top>
<td width=41%><b>CdoPR_END_DATE </b></td>
<td width=27%>RES_PROPERTY </td>
<td width=32%>RELOP_GE </td>
</tr>
<tr valign=top>
<td width=41%><b>CdoPR_START_DATE </b></td>
<td width=27%>RES_PROPERTY </td>
<td width=32%>RELOP_LE </td>
</tr>
</table><br>
<p>
The comparison order is <i>(property value)</i> <i>(relational operator)</i> <i>(constant value)</i>. For example, the message filter passes appointments with a starting date earlier than or equal to the date you indicate. To specify this restriction, you use the filter's <a href="oleobjis_110f.htm"><b>Fields</b></a> property to obtain its <a href="oleobjaf_0yt0.htm">Fields</a> collection, <a href="oleobjaf_1qy6.htm"><b>Add</b></a> a new <a href="oleobjaf_8lh0.htm">Field</a> with <b>CdoPR_START_DATE</b> in the <i>PropTag</i> parameter, and set the new field's <a href="oleobjaf_92zo.htm"><b>Value</b></a> property to the last admissible starting date. </p>
<p>
The results of the individual restrictions are normally <b>AND</b>ed together to form the final filter value. You can change this by setting the <a href="oleobjis_7tun.htm"><b>Or</b></a> property, which causes all the results to be <b>OR</b>ed instead of <b>AND</b>ed. You can also set the <a href="oleobjis_4p5r.htm"><b>Not</b></a> property to specify that the result of each individual restriction is to be negated before being <b>AND</b>ed or <b>OR</b>ed into the final filter value. </p>
<p>
The message filter affects traversals of the Messages collection using the Visual Basic <b>For Each</b> statement, the <b>Get</b> methods, or the Visual Basic <b>For  Next</b> construction. These accesses normally return a <a href="oleobjis_2p10.htm">Message</a> object but can also return a <a href="oleobjis_852s.htm">GroupHeader</a> object if the collection is instantiated by a CDO rendering application. </p>
<p>
The MessageFilter object is persistent within its parent <a href="oleobjis_1qd0.htm">Messages</a> collection. It is not deleted even when it is released, and it remains attached to the Messages collection until the collection's <a href="oleobjis_1p3z.htm"><b>Filter</b></a> property is set to <b>Nothing</b> or the collection is itself released. You can use the following code to clear a message filter of all of its previous settings and reset it to its default state of no criteria: </p>
<pre><code>objMessagesColl.Filter = Nothing ' filter now invalidated and cleared 
Set objMessageFilt = objMessagesColl.Filter ' new valid empty filter 
 </code></pre>
<p>
If a folder is being rendered with a CDO rendering application, the Messages collection and the message filter are instantiated according to the specifications in the <a href="renobj_7kfo.htm">TableView</a> object being applied to the folder. The MessageFilter object inherits the restriction specified in the view. An inherited filter can be used without modification, but it cannot be read or changed by the rendering application. Writing any property on an inherited filter disinherits it and refreshes the Messages collection. This means that the collection is reinstantiated with a new message filter specifying only the property just written. This new filter, however, is no longer inherited, and the application can read its properties and set additional restrictions within it. </p>
<h4>Example </h4>
<p>
This code fragment specifies that the message filter on the Inbox should pass only Message objects that are <b>Unread</b> <b>AND</b> <b>Not</b> of message class IPM.Note: </p>
<pre><code>Dim objMsgFilt As MessageFilter 
 
Set objMsgFilt = objSession.Inbox.Messages.Filter 
' ... validate MessageFilter object ... 
objMsgFilt.Not = True ' negate all results before ANDing 
objMsgFilt.Type = "IPM.Note" ' MAPI message class 
objMsgFilt.Unread = False ' .Not setting negates True to False! 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
