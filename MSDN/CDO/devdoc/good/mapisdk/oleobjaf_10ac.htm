<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AddressEntryFilter Object</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_addressentryfilter_object"></a>AddressEntryFilter Object</h1>
<p>
The AddressEntryFilter object specifies criteria for restricting a search on an <a href="oleobjaf_7qd0.htm">AddressEntries</a> collection. </p>
<h4>At a Glance </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Specified in type library: </td>
<td width=52%>CDO.DLL </td>
</tr>
<tr valign=top>
<td width=48%>First available in: </td>
<td width=52%>CDO Library version 1.1 </td>
</tr>
<tr valign=top>
<td width=48%>Parent objects: </td>
<td width=52%><a href="oleobjaf_7qd0.htm">AddressEntries</a> collection </td>
</tr>
<tr valign=top>
<td width=48%>Child objects: </td>
<td width=52%><a href="oleobjaf_0yt0.htm">Fields</a> collection </td>
</tr>
<tr valign=top>
<td width=48%>Default property: </td>
<td width=52%><a href="oleobjaf_180v.htm"><b>Name</b></a> </td>
</tr>
</table><br>
<h4>Properties </h4>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=32%><br>
Name </th>
<th align=left width=18%>Available since version </th>
<th align=left width=32%> <br>
Type </th>
<th align=left width=18%> <br>
Access </th>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjaf_9gin.htm"><b>Address</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>String </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjaf_1bbz.htm"><b>Application</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>String </td>
<td width=18%>Read-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjaf_3a1r.htm"><b>Class</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Long </td>
<td width=18%>Read-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjaf_3qlb.htm"><b>Fields</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Field object or Fields collection object </td>
<td width=18%>Read-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjaf_180v.htm"><b>Name</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>String </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjaf_91en.htm"><b>Not</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Boolean </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjaf_4fvj.htm"><b>Or</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Boolean </td>
<td width=18%>Read/write </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjaf_03rz.htm"><b>Parent</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>AddressEntries collection object </td>
<td width=18%>Read-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjaf_6o0v.htm"><b>Session</b></a> </td>
<td width=18%>1.1 </td>
<td width=32%>Session object </td>
<td width=18%>Read-only </td>
</tr>
</table><br>
<h4>Methods </h4>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=32%><br>
Name </th>
<th align=left width=18%>Available since version </th>
<th align=left width=50%> <br>
Parameters </th>
</tr>
<tr valign=top>
<td width=32%><a href="oleobjaf_2nvj.htm"><b>IsSameAs</b></a> </td>
<td width=18%>1.1 </td>
<td width=50%><i>objAddrEntryFilter2</i> as <b>Object</b> </td>
</tr>
</table><br>
<h4>Remarks </h4>
<p>
An AddressEntryFilter object with no criteria is created by default for every <a href="oleobjaf_7qd0.htm">AddressEntries</a> collection. This means that initially the filter's properties are unset and its child <a href="oleobjaf_0yt0.htm">Fields</a> collection is empty. You specify the filter by setting values for its properties, and by adding fields to its Fields collection and setting a value for each added field. You do not need to call any <b>Update</b> method when setting filter criteria. </p>
<p>
The filter is invoked when the AddressEntries collection is traversed with the <b>Get</b> methods or the Microsoft® Visual Basic® <b>For Each</b> construction. Each field participates in a MAPI search restriction comparing the field's <a href="oleobjaf_92zo.htm"><b>Value</b></a> property against the value of the AddressEntry object's property specified by the field's <a href="oleobjaf_0kmc.htm"><b>ID</b></a> property. </p>
<p>
For fields of data type other than <b>String</b>, the MAPI search restriction type is RES_PROPERTY with relational operator RELOP_EQ. For fields of data type <b>String</b>, the restriction type is RES_CONTENT with fuzzy level options FL_SUBSTRING, FL_IGNORECASE, and FL_LOOSE. However, the following MAPI properties are compared using FL_PREFIX instead of FL_SUBSTRING: </p>
<p class=indent1>
PR_ACCOUNT </p>
<p class=indent1>
PR_BUSINESS_ADDRESS_CITY </p>
<p class=indent1>
PR_COMPANY_NAME </p>
<p class=indent1>
PR_DEPARTMENT_NAME </p>
<p class=indent1>
PR_DISPLAY_NAME </p>
<p class=indent1>
PR_GIVEN_NAME </p>
<p class=indent1>
PR_OFFICE_LOCATION </p>
<p class=indent1>
PR_SURNAME </p>
<p class=indent1>
PR_TITLE </p>
<p>
If the underlying messaging system does not support the search criteria specified by the filter fields, the <b>Get</b> methods return <b>CdoE_TOO_COMPLEX</b>. In particular, a given field may not be supported by a particular address book container. </p>
<p>
The results of the individual restrictions are normally <b>AND</b>ed together to form the final filter value. You can change this by setting the <a href="oleobjaf_4fvj.htm"><b>Or</b></a> property, which causes all the results to be <b>OR</b>ed instead of <b>AND</b>ed. You can also set the <a href="oleobjaf_91en.htm"><b>Not</b></a> property to specify that the result of each individual restriction is to be negated before being <b>AND</b>ed or <b>OR</b>ed into the final filter value. </p>
<p>
The address entry filter affects traversals of the AddressEntries collection using the Visual Basic <b>For Each</b> statement, the <b>Get</b> methods, or the Visual Basic <b>For ... Next</b> construction. These accesses return an <a href="oleobjaf_6n1w.htm">AddressEntry</a>. </p>
<p>
The AddressEntryFilter object is persistent within its parent AddressEntries collection. It is not deleted even when it is released, and it remains attached to the AddressEntries collection until the collection's <a href="oleobjaf_4d3z.htm"><b>Filter</b></a> property is set to <b>Nothing</b> or the collection is itself released. You can use the following code to clear an address entry filter of all of its previous settings and reset it to its default state of no criteria: </p>
<pre><code>objAddrEntsColl.Filter = Nothing ' filter now invalidated and cleared 
Set objAddrEntFilt = objAddrEntsColl.Filter ' new valid empty filter 
 </code></pre>
<p>
If an address book container is being rendered with a CDO rendering application, the <a href="oleobjaf_7qd0.htm">AddressEntries</a> collection and the address entry filter are instantiated according to the specifications in the <a href="renobj_7kfo.htm">TableView</a> object being applied to the address book container. The AddressEntryFilter object inherits the restriction specified in the view. An inherited filter can be used without modification, but it cannot be read or changed by the rendering application. Writing any property on an inherited filter disinherits it and refreshes the AddressEntries collection. This means that the collection is reinstantiated with a new address entry filter specifying only the property just written. This new filter, however, is no longer inherited, and the application can read its properties and set additional restrictions within it. </p>
<h4>Example </h4>
<p>
This code fragment specifies that the address entry filter on the personal address book (PAB) should pass only AddressEntry objects that are remote users <b>OR</b> that have a fax address: </p>
<pre><code>Dim objThisPAB As AddressList           ' Personal address book 
Dim objAddrEntFilt As AddressEntryFilter 
Dim propTag As Long                     ' MAPI property tag 
Dim dispType As Long                    ' MAPI display type 
 
Set objThisPAB = objSession.AddressLists("Personal Address Book") 
' ... validate AddressList object ... 
Set objAddrEntFilt = objThisPAB.AddressEntries.Filter 
' ... validate AddressEntryFilter object ... 
propTag = &amp;H39000003 ' VB4.0: propTag = CdoPR_DISPLAY_TYPE 
dispType = 6         ' VB4.0: dispType = CdoRemoteUser 
objAddrEntFilt.Fields(propTag) = dispType 
objAddrEntFilt.Address = "fax:" ' case-insensitive substring match 
objAddrEntFilt.Or = True ' OR results together instead of AND 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
