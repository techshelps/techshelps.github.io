<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sequence of Events</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_sequence_of_events"></a>Sequence of Events</h1>
<p>
The following procedures describe the events that take place and the flow of data as selected messaging tasks are performed. To see a diagram showing how the elements mentioned in these descriptions relate to one another, see <a href="kluaover_8uud.htm">The Active Server Components of Microsoft Exchange</a>.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;An authenticated user opens a mailbox</h5>
<ol>
<li>
A user clicks the logon URL or follows a link (http://&lt;server&gt;/exchange, a virtual root) to the logon page for Active Server components.</li>
<li>
The user enters a mailbox name, domain account name, and password. The script for the logon interaction is contained in the logon.asp file.</li>
<li>
If the user is authenticated through the Microsoft® Windows NT® domain controller, an Active Server Pages session is started, which maintains session information until the user logs off or the session times out. (After authentication, the session timer starts when the first page is sent to the browser, and is restarted when each subsequent page is sent to the browser.)<p>
A CDO Session object is created and stored as a state variable in the Active Server Pages session. This lets the CDO Library and CDO Rendering Library make messaging calls to retrieve information store data from Microsoft® Exchange Server. 
</li>
<li>
The Inbox for this Session object is opened. This becomes visible to the user as the script file root.asp is executed. The Inbox is displayed in four frames from the \inbox directory. (Anonymous users are directed to the file \anon\root.asp.) For more information, see <a href="msowa_32hx.htm">Directory Structure</a>.</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;An unauthenticated user accesses a public folder</h5>
<ol>
<li>
A user clicks the logon URL or follows a link (http://&lt;server&gt;/exchange, a virtual root) to the logon page. (Alternatively, a user may have followed a URL to the public folder, in which case the user is logged on transparently, and sees no logon page.)</li>
<li>
The user clicks <b>Public Access</b> (or the appropriate <b>Click here</b>) on the logon screen.</li>
<li>
A CDO session is started for the unauthenticated user.</li>
<li>
The root folder of the public folder tree is displayed as the file \anon\root.asp is rendered. Only certain public folders are visible. The administrator determines which folders are available to unauthenticated users, using the HTTP Protocol object in the Protocols container on the site. </li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;An unauthenticated user posts a message to a public folder</h5>
<ol>
<li>
The user opens the public folder, as described in the previous procedure.</li>
<li>
The user clicks <b>Post New Item</b>. The browser supplies the name "Anonymous" (or a suitable equivalent in the user's language, if not English) to be displayed on messages posted to public folders. Unauthenticated users can post messages, but they cannot send e-mail messages. </li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;A user reads a document or message in a public folder</h5>
<p class=indent1>
– Or –</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;An authenticated user reads a message in a mailbox or public folder</h5>
<ol>
<li>
The user opens the mailbox or public folder, as in one of the previous procedures. </li>
<li>
The user clicks a message in the mailbox or public folder.</li>
<li>
If the user is opening a message in a mailbox, the file \forms\ipm\note\read.asp is loaded into Microsoft® Active Server Pages, which renders the message using the CDO Rendering Library. (The file \forms\ipm\post\read.asp is used to render a message in a public folder.)</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
