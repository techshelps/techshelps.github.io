<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting virtroot and classpath</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_olemsg_setting_virtroot_and_classpath"></a>Setting virtroot and classpath</h3>
<p>
When the RenderingApplication object is created, it contains a <a href="renobj_1nlg.htm">Formats</a> collection object as well as two named formats: the virtroot object and the classpath object. To configure these objects, you set the <a href="renobj_35cv.htm"><b>VirtualRoot</b></a> property (to set the virtroot format) and <a href="renobj_2kin.htm"><b>FormsRoot</b></a> property (to set the classpath format) as a part of RenderingApplication object configuration. It is good to make these settings right after the first <a href="renobj_8uhr.htm"><b>LoadConfiguration</b></a> command. </p>
<p>
As formats in the formats collection of the RenderingApplication object, the virtroot object and the classpath object are global to the application.</p>
<h4>The virtroot Format Object</h4>
<p>
The virtroot format functions like a symbol in a table in that it lets you provide a link that will resolve to the correct location of the current Web application. You can use virtroot as the substitution token %virtroot% in substitution patterns. For more information, see <a href="renobj_35cv.htm">VirtualRoot Property (RenderingApplication Object)</a>. </p>
<p>
In <a href="msowa_0ppv.htm">Microsoft Outlook Web Access</a>, the <b>VirtualRoot</b> property is set during configuration of the RenderingApplication object, in the <b>Application_OnStart</b> procedure in global.asa:</p>
<pre><code>bstrVirtRoot = "/exchange"
objRenderApp.VirtualRoot = bstrVirtRoot
 </code></pre>
<h4>The classpath Format Object</h4>
<p>
The classpath format is used to create links to forms. If you use the classpath format without having set the <a href="renobj_2kin.htm"><b>FormsRoot</b></a> property of the RenderingApplication object, classpath functions as a substitution token, returning the message class of the current object. </p>
<p>
The classpath format object obtains a new value when you set the <b>FormsRoot</b> property. In Microsoft Outlook Web Access, this property is set during configuration of the RenderingApplication object, in the <b>Application_OnStart</b> procedure in global.asa:</p>
<pre><code>bstrVirtRoot = "/exchange"
objRenderApp.FormsRoot = Server.MapPath(bstrVirtRoot) &amp; "\usa\forms"
 </code></pre>
<p>
In this example, the Server.MapPath method expands the string bstrVirtRoot to the <a href="olegloss_48ja.htm#_olemsg_virtual_root_gly">virtual root</a> of /exchange, namely c:\exchsrvr\webdata. This <b>FormsRoot</b> call also performs the following actions:
<ul>
<li>
The objRenderApp.FormsRoot property is set to a value such as c:\exchsrvr\webdata\usa\forms.</li>
<li>
The directory tree starting with the specified physical directory (…\usa\forms) is searched for installed forms—that is, directories containing <a href="kluaover_4eur.htm">ASP Files</a>.</li>
<li>
A <a href="olegloss_48j4.htm#_olemsg_pattern_gly">pattern</a> for each form found in this directory tree is added to the classpath format object. </li>
</ul>
<p>
Optionally, to store information about additional forms directories, you can add more patterns to the classpath format object. Because the classpath contains only the beginning of the path to the forms directories, it is best to place all forms under the same virtual root, such as /exchange. </p>
<p>
For more information, see <a href="renobj_1333.htm">RenderUsing Property (Column Object)</a> and <a href="renobj_2kin.htm">FormsRoot Property (RenderingApplication Object)</a>. </p>
<p>&nbsp;</p></body>
</HTML>
