<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Web Page Support</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_web_page_support"></a>Web Page Support</h1>
<p>
The CDO libraries offer programmatic support for Hypertext Markup Language (HTML) script on a Web page. Script can be server-side, which is decoded and run at the Web server, or client-side, which is decoded and run at the browser. The CDO Rendering Library supports server-side script, and the CDO Library supports client-side script. For more information on server-side script support, see <a href="renoview_4b8n.htm">HTML Rendering</a>. </p>
<p>
The language used for the script subroutine can be Microsoft® Visual Basic® Scripting Edition (VBScript), Microsoft® JScript™, or JavaScript. For simplicity of browser implementation, and also for security reasons, not all Visual Basic functionality is available in VBScript. In particular, you cannot use: 
<ul>
<li>
File input/output or direct operating system access. </li>
<li>
Early binding, for example <code>Dim objRecip As Recipient</code>. </li>
<li>
Type library constants, such as <b>CdoPR_DISPLAY_TYPE</b>. </li>
<li>
Named parameters in calls to methods. </li>
<li>
Dialog boxes, for example in the <a href="oleobjis_31ym.htm"><b>Logon</b></a> method. </li>
</ul>
<p>
For more information on VBScript and its feature restrictions, see the <i>Microsoft Visual Basic Scripting Edition Language Reference</i>. </p>
<p>
To use the CDO Library in client-side script, you instantiate a CDO <a href="oleobjis_57w4.htm">Session</a> object in the body of a Web page, and then log on to this session from a script subroutine. Following logon, you can instantiate and use other objects subsidiary to the session object. </p>
<p>
During logon, a MAPI client can only reference a profile that is stored in its own local MAPISVC.INF configuration file. A browser is not likely to be able to access a profile defined and stored at the Web server. Therefore, script running at a browser should create a profile dynamically so that it is local to the browser. This can be done by using the <i>ProfileInfo</i> parameter of the <a href="oleobjis_31ym.htm"><b>Logon</b></a> method, or, as in the following example, by calling <b>Logon</b> without parameters and letting the browser user choose a profile. </p>
<p>
Dynamic profile creation is only possible on a message service that is tightly coupled with MAPI, such as the Microsoft® Exchange server. Loosely coupled message services cause the MAPI spooler to be started, and if another message service or user tries to access MAPI, serious errors result. </p>
<p>
This client-side script fragment sends a feedback message to the Customer Support department when the user clicks the <b>Send Feedback</b> button. It demonstrates a script subroutine in VBScript showing instantiation of a Session object with an HTML &lt;OBJECT&gt; tag. It also shows the subsequent instantiation of a <a href="oleobjis_2p10.htm">Message</a> object and its <a href="oleobjis_3xro.htm">Recipients</a> collection, and the preparation and submission of an e-mail message. </p>
<pre><code>&lt;HTML&gt; 
&lt;BODY LANGUAGE=VBS&gt; 
 ... 
&lt;SCRIPT LANGUAGE=VBS&gt; 
Sub Send_Feedback 
    Dim objFBMess ' feedback message from Web page 
    Dim objRecips ' can't do "Dim As" (early binding) in VBScript 
' ... validate objWebSession object instantiated by HTML, then ... 
    objWebSession.Logon ' let user choose profile if not logged on 
    Set objFBMess = objWebSession.Outbox.Messages.Add 
    objFBMess.Subject = "Feedback from Web page" 
    objFBMess.Text = Feedback.Value 
    Set objRecips = objFBMess.Recipients 
    objRecips.Add "custsupp" ' send to Customer Support 
    objRecips.Resolve 
    objFBMess.Send ' defaults to save copy and no user dialog 
    objWebSession.Logoff 
End Sub 
&lt;/SCRIPT&gt; 
 ... 
&lt;H1&gt;&lt;CENTER&gt;CUSTOMER FEEDBACK WEB PAGE&lt;/H1&gt; 
&lt;B&gt;&lt;P&gt;Welcome to the Customer Support Feedback Web page. 
&lt;P&gt;If you have any additional suggestions or requests, 
&lt;P&gt;please send 
&lt;A HREF=MAILTO:custsupp@mycompany.com&gt;Customer Support&lt;/A&gt; 
some e-mail. 
&lt;P&gt;Please enter your feedback here: 
&lt;INPUT NAME=Feedback TYPE=Text SIZE=80&gt; 
&lt;INPUT ONCLICK=Send_Feedback TYPE=Button VALUE="Send Feedback"&gt; 
&lt;OBJECT CLASSID="clsid:3FA7DEB3-6438-101B-ACC1-00AA00423326" ID=objWebSession&gt; 
&lt;! The OBJECT tag instantiates the CDO Session object&gt; 
&lt;/OBJECT&gt; 
&lt;/BODY&gt; 
&lt;/HTML&gt; 
 </code></pre>
<p>
<b>Note</b>&nbsp;&nbsp;The &lt;OBJECT&gt; and &lt;SCRIPT&gt; tags and the &lt;LANGUAGE&gt; and &lt;ONCLICK&gt; attributes are defined in the HTML 3.2 specification of the World Wide Web Consortium (W3C). Not all Internet browsers support HTML 3.2 or all of its elements. For more information on HTML 3.2, see the Web page <i>HTML 3.2 Reference Specification</i> at http://www.w3.org/pub/WWW/TR/REC-html32.html. </p>
<p>
For more information on the programming elements in the script fragment, see the <a href="oleobjis_57w4.htm">Session</a> object's <a href="oleobjis_31ym.htm"><b>Logon</b></a> and <a href="oleobjis_7h9q.htm"><b>Logoff</b></a> methods, the <a href="oleobjis_1qd0.htm">Messages</a> collection's <a href="oleobjis_2l66.htm"><b>Add</b></a> method, the <a href="oleobjis_2p10.htm">Message</a> object's <a href="oleobjis_46cl.htm"><b>Recipients</b></a> property and <a href="oleobjis_2un9.htm"><b>Send</b></a> method, and the <a href="oleobjis_3xro.htm">Recipients</a> collection's <a href="oleobjis_9oku.htm"><b>Add</b></a> and <a href="oleobjis_1zu6.htm"><b>Resolve</b></a> methods. </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
