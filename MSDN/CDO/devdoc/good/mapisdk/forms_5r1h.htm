<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating the Default Message</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_olemsg_creating_the_default_message"></a>Creating the Default Message</h3>
<p>
For the creation of a classified ad form, Read.asp is opened as the default file. In this script, the first step is the creation of a standard message. This happens in the following line of code, by the addition of a message to the current profile's (the session's) Outbox:</p>
<pre><code>Set oNewMessage = objAMSession.Outbox.Messages.Add
 </code></pre>
<p>
In this call, <i>objAMSession</i> is the handle to the current session, and <i>oNewMessage</i> is the handle to the new message object. This new message contains the default fields of a standard message. The message handle is used later in this script when the message is sent with the command <i>oNewMessage</i>.<b>Send</b>. The <b>Send</b> command can include various flags, such as for requesting a delivery receipt or saving a copy in the Sent Items folder. </p>
<p>
Because this call requests memory for a message object, it can fail if the computer is currently low on memory. For this reason, it may be good to check the return value from this call. In VBScript, if the object creation fails in a given call, the return value is set to <b>Nothing</b>. (In this code, rather than checking if the new message is set to <b>Nothing</b>, the creation of child objects is checked a few lines of code later.) </p>
<p>&nbsp;</p></body>
</HTML>
