<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Rendering Objects, Formats, and Patterns</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_creating_rendering_objects_formats_and_patterns"></a>Creating Rendering Objects, Formats, and Patterns </h1>
<p>
The following code shows how to create an ObjectRenderer object for a message. It also adds the following:
<ul>
<li>
One property-only format object to be used by the column object to render the MAPI property PR_IMPORTANCE. The RenderUsing string contains a reference to a named format that will be used to display language-specific strings.</li>
<li>
The named format object referenced in the <a href="rendering_2beb.htm">RenderUsing string</a>.</li>
<li>
A pattern for each possible value of PR_IMPORTANCE. </li>
<li>
A LinkPattern string to enable the use of the <a href="renobj_7j6n.htm">RenderLink Method (ObjectRenderer Object)</a>, which renders a link to the DataSource object. </li>
</ul>
<pre><code>' Assume Rendering application is stored in 
' Active Server Pages Application object
Set objRenderApp = Application ("RenderingApp")

' Create a renderer object using class object renderer
Set objRenderer = objRenderApp.CreateRenderer (AMHTML_Class_ObjectRenderer)
If (Not objRenderer Is Nothing) Then

   ' Add a property-only Format object (for PR_IMPORTANCE)
   ' (The named format will contain language specific strings.)
   Set objFormat = objRenderer.Formats.Add(CdoPR_IMPORTANCE, Null)
   objFormat.Patterns.Add "*", "%langImportance%"

   ' Add a named Format object to the renderer object
   Set objFormat = objRenderer.Formats.Add(0, "langImportance")

   ' Add patterns to Format object (possible property 
   ' values and corresponding RenderUsing strings) 
   objFormat.Patterns.Add 0, "Low" 
   objFormat.Patterns.Add 1, "Normal"
   objFormat.Patterns.Add 2, "High"

   ' Add LinkPattern string (creates "message_Link" named format)
   objRenderer.LinkPattern = "%virtroot%/forms/%classpath%frmroot.asp?obj=%obj%&amp;command=open"

   ' Store new renderer object in Session for later use
   Set Session("ObjectRenderer") = objRenderer
End If 
</code></pre>
<p>&nbsp;</p></body>
</HTML>
