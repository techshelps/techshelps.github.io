<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Delete Method (Attachment Object)</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_delete_method_attachment"></a>Delete Method (Attachment Object)  <a href="oleobjaf_0x10.htm"><img src="images/group.gif" border=0></a></h1>
<p>
The <b>Delete</b> method removes the Attachment object from the <a href="oleobjaf_9yd0.htm">Attachments</a> collection. </p>
<h4>Syntax </h4>
<p>
<i>objAttachment</i>.<b>Delete( ) </b></p>
<h4>Remarks </h4>
<p>
The <b>Delete</b> method performs an irreversible operation on the collection. It calls <b>Release</b> on the collection's reference to the Attachment object. If you have another reference to the attachment, you can still access its properties and methods, but you can never again associate it with any collection because the <a href="oleobjaf_1966.htm"><b>Add</b></a> method always creates a new object. You should <b>Set</b> your reference variable either to <b>Nothing</b> or to another attachment. </p>
<p>
The final <b>Release</b> on the Attachment object takes place when you assign your reference variable to <b>Nothing</b>, or when you call <b>Delete</b> if you had no other reference. At this point the object is removed from memory. Attempted access to a released object results in an error return of <b>CdoE_INVALID_OBJECT</b>. </p>
<p>
When you delete a member of a collection, the collection is immediately refreshed, meaning that its <b>Count</b> property is reduced by one and its members are reindexed. To access a member following the deleted member, you must use its new index value. For more information, see <a href="olemistk_7ini.htm">Looping Through a Collection</a>. </p>
<p>
The effect of the <b>Delete</b> operation is not permanent until you use the <a href="oleobjis_3wh1.htm"><b>Update</b></a>, <a href="oleobjis_2un9.htm"><b>Send</b></a>, or <a href="oleobjis_410l.htm"><b>Delete</b></a> method on the <a href="oleobjis_2p10.htm">Message</a> object to which this attachment belongs. </p>
<p>
The immediate parent of this Attachment object is an <a href="oleobjaf_9yd0.htm">Attachments</a> collection, which is a child of the message. You can delete all the message's attachments by calling the collection's <a href="oleobjaf_3dwu.htm"><b>Delete</b></a> method. </p>
<h4>Example </h4>
<p>
This code fragment illustrates the two situations previously explained. The <b>Set</b> statement calls <b>AddRef</b> on the first Attachment object. That reference survives the call to <b>Delete</b> and has to be reassigned. The second Attachment object is deleted without creating another reference, and no other action is necessary. </p>
<pre><code>' assume valid Message object 
Set objAttachment = objMessage.Attachments.Item(1) 
objAttachment.Delete ' still have a reference from Set statement 
' ... other operations on objAttachment possible but pointless ... 
Set objAttachment = Nothing ' necessary to remove reference 
' ... 
objMessage.Attachments.Item(2).Delete ' no reference to remove 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
