<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CreateConversationIndex Method (Session Object)</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_createconversationindex_method_session_object_"></a>CreateConversationIndex Method (Session Object)  <a href="oleobjis_57w4.htm"><img src="images/group.gif" border=0></a></h1>
<p>
The <b>CreateConversationIndex</b> method creates or updates an index for a conversation thread. </p>
<h4>Syntax </h4>
<p>
<i>newIndex = objSession</i>.<b>CreateConversationIndex( [</b><i>ParentIndex</i><b>] ) </b>
<dl>
<dt>
<i>newIndex </i></dt>
<dd>
String. The conversation index to be assigned to the first or next message in the thread. </dd>
<dt>
<i>objSession </i></dt>
<dd>
Required. The Session object. </dd>
<dt>
<i>ParentIndex </i></dt>
<dd>
Optional. String. The conversation index of a received message for which a reply is being generated. 
</dd>
</dl>
<h4>Remarks </h4>
<p>
The <b>CreateConversationIndex</b> method takes the current value of a conversation index and returns a new value suitable for an outgoing message. If the message to be sent represents the beginning of a new thread, there is no current index, and the <i>ParentIndex</i> parameter is not passed in. If the outgoing message is a reply to a received message, the <a href="oleobjis_99gl.htm">ConversationIndex</a> property of the received message is passed in as the <i>ParentIndex</i> parameter. </p>
<p>
The <b>CreateConversationIndex</b> method ultimately calls the MAPI <b>ScCreateConversationIndex</b> function. </p>
<h4>Example </h4>
<p>
This code fragment responds to the first message in the Inbox: </p>
<pre><code>Dim objInMsgColl As Messages ' messages in Inbox 
Dim objRecMsg As Message     ' received message 
Dim objNewMsg As Message     ' outgoing reply message 
Dim objRcpColl As Recipients ' recipients for outgoing message 
Dim strSenderID As String    ' unique ID of original sender 
Dim strCnvIndx As String     ' conversation index 
 
If objSession Is Nothing Then 
    MsgBox "Must first create MAPI session and log on" 
    Exit Function 
End If 
Set objInMsgColl = objSession.Inbox.Messages 
' ... error handling ... 
If objInMsgColl Is Nothing Then 
    MsgBox "Could not successfully access Inbox messages" 
    Exit Function 
End If 
Set objRecMsg = objInMsgColl.GetFirst() 
If objRecMsg Is Nothing Then 
    MsgBox "No messages in Inbox" 
    Exit Function 
End If 
' make new conversation index from old 
strCnvIndx = objSession.CreateConversationIndex _ 
                        (objRecMsg.ConversationIndex) 
strSenderID = objRecMsg.Sender.ID ' save sender's unique ID 
Set objNewMsg = objSession.Outbox.Messages.Add ' generate reply 
' ... error handling ... 
Set objRcpColl = objNewMsg.Recipients 
' ... error handling ... 
objRcpColl.Add entryID:=strSenderID ' add sender as recipient 
' ... error handling ... 
With objNewMsg 
    .ConversationIndex = strCnvIndx 
    .ConversationTopic = objRecMsg.ConversationTopic 
    .Subject = "RE: " &amp; objRecMsg.Subject 
    .Text = "Please consider this a reply to your message." 
    .Update' save everything in the MAPI system 
    .Send showDialog:=False 
End With 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
