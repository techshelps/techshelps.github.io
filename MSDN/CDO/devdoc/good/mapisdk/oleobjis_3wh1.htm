<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Update Method (Message Object)</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_update_method_message"></a>Update Method (Message Object)  <a href="oleobjis_2p10.htm"><img src="images/group.gif" border=0></a></h1>
<p>
The <b>Update</b> method saves the message in the MAPI system. </p>
<h4>Syntax </h4>
<p>
<i>objMessage</i>.<b>Update( [</b><i>makePermanent</i><b>] [</b>, <i>refreshObject</i><b>] ) </b>
<dl>
<dt>
<i>objMessage </i></dt>
<dd>
Required. The Message object. </dd>
<dt>
<i>makePermanent </i></dt>
<dd>
Optional. Boolean. A value of <b>True</b> indicates that the property cache is flushed and all changes are committed in the underlying message store. <b>False</b> indicates that the property cache is flushed but not committed to persistent storage. The default value is <b>True</b>. </dd>
<dt>
<i>refreshObject </i></dt>
<dd>
Optional. Boolean. A value of <b>True</b> indicates that the property cache is reloaded from the values in the underlying message store. <b>False</b> indicates that the property cache is not reloaded. The default value is <b>False</b>. 
</dd>
</dl>
<h4>Remarks </h4>
<p>
Changes to a Message object are not permanently saved in the MAPI system until you either call the <b>Update</b> method with the <i>makePermanent</i> parameter set to <b>True</b> or call the <a href="oleobjis_2un9.htm"><b>Send</b></a> method. </p>
<p>
For improved performance, CDO caches property changes in private storage and updates either the object or the underlying persistent storage only when you explicitly request such an update. For efficiency, you should make only one call to <b>Update</b> with its <i>makePermanent</i> parameter set to <b>True</b>. </p>
<p>
The <i>makePermanent</i> and <i>refreshObject</i> parameters combine to cause the following changes: </p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=31%></th>
<th align=left width=34%>refreshObject = True </th>
<th align=left width=35%>refreshObject = False </th>
</tr>
<tr valign=top>
<td width=31%><b>makePermanent = True </b></td>
<td width=34%>Commit all changes, flush the cache, and reload the cache from the message store. </td>
<td width=35%>Commit all changes and flush the cache (default combination). </td>
</tr>
<tr valign=top>
<td width=31%><b>makePermanent = False </b></td>
<td width=34%>Flush the cache and reload the cache from the message store. </td>
<td width=35%>Flush the cache. </td>
</tr>
</table><br>
<p>
Call <b>Update(False, True)</b> to flush the cache and then reload the values from the message store. </p>
<h4>Example </h4>
<p>
This code fragment changes the subject of the first message in the Inbox: </p>
<pre><code>Set objMessage = objSession.Inbox.GetFirst 
' ... verify message 
objMessage.Subject = "This is the new subject" 
objMessage.Update ' commit changes to MAPI system 
 </code></pre>
<p>
To add a new Message object, use the <a href="oleobjis_1qd0.htm">Messages</a> collection's <a href="oleobjis_2l66.htm"><b>Add</b></a> method followed by the message's <b>Update</b> method. This code fragment saves a new message in the Outbox: </p>
<pre><code>Dim objMessage As Message ' Message object 
' 
Set objMessage = objSession.Outbox.Messages.Add 
objMessage.Subject = "Microsoft CDO Library" 
objMessage.Text = "The new version is now available." 
objMessage.Update makePermanent:=True ' redundant parameter (default) 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
