<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RootFolder Property (InfoStore Object)</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_rootfolder_property_infostore"></a>RootFolder Property (InfoStore Object)  <a href="oleobjis_4k6s.htm"><img src="images/group.gif" border=0></a></h1>
<p>
The <b>RootFolder</b> property returns a <a href="oleobjaf_4u2c.htm">Folder</a> object representing the root of the IPM subtree for the InfoStore object. Read-only. </p>
<h4>Syntax </h4>
<p>
<b>Set</b><i> objFolder</i><b> = </b><i>objInfoStore</i>.<b>RootFolder </b></p>
<h4>Data Type </h4>
<p>
Object (Folder) </p>
<h4>Remarks </h4>
<p>
The <b>RootFolder</b> property provides a convenient way to get to this commonly used Folder object. </p>
<p>
In addition to the general ability to navigate through the formal collection and object hierarchy, CDO supports properties that allow your application to directly access the most common <a href="oleobjaf_4u2c.htm">Folder</a> objects: 
<ul>
<li>
The InfoStore object's <b>RootFolder</b> property for the IPM subtree root folder </li>
<li>
The <a href="oleobjis_57w4.htm">Session</a> object's <a href="oleobjis_7jqm.htm"><b>Inbox</b></a> property for the Inbox folder </li>
<li>
The Session object's <a href="oleobjis_0vfy.htm"><b>Outbox</b></a> property for the Outbox folder </li>
</ul>
<p>
Some message stores also support a direct way to obtain the root folder of the message store. For more information, see the Session object's <a href="oleobjis_9hgu.htm"><b>GetFolder</b></a> method. </p>
<p>
If your application is running as a Microsoft® Windows NT® service, you cannot access the Microsoft Exchange Public Folders through the normal hierarchy because of a notification conflict. You must use the InfoStore's <a href="oleobjis_9s9r.htm"><b>Fields</b></a> property to obtain the Microsoft Exchange property PR_IPM_PUBLIC_FOLDERS_ENTRYID, property tag &amp;H66310102. This represents the top-level public folder and allows you to access all other public folders through its <a href="oleobjaf_2u5u.htm"><b>Folders</b></a> property. For more information on Windows NT services, see the Win32® Web page <i>Using MAPI from a Windows NT Service</i> at http://www.microsoft.com/win32dev/mapi/mapiserv.htm. </p>
<h4>Example </h4>
<pre><code>' from InfoStores_RootFolder 
    If objInfoStore Is Nothing Then 
        MsgBox "must first select an InfoStore object" 
        Exit Function 
    End If 
    Set objFolder = objInfoStore.RootFolder 
    If objFolder Is Nothing Then 
        MsgBox "Unable to retrieve IPM root folder" 
        Set objMessages = Nothing 
        Exit Function 
    End If 
    If objFolder.Name = "" Then 
        MsgBox "Folder set to folder with no name, ID = " _ 
                                                   &amp; objFolder.ID 
    Else 
        MsgBox "Folder set to: " &amp; objFolder.Name 
    End If 
    Set objMessages = objFolder.Messages 
    Exit Function 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
