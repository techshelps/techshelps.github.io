<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Add Method (Attachments Collection)</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_add_method_attachments_collection"></a>Add Method (Attachments Collection)  <a href="oleobjaf_9yd0.htm"><img src="images/group.gif" border=0></a></h1>
<p>
The <b>Add</b> method creates and returns a new <a href="oleobjaf_0x10.htm">Attachment</a> object in the Attachments collection. </p>
<h4>Syntax </h4>
<p>
<b>Set</b><i> objAttachment = objAttachColl</i>.<b>Add( [</b> <i>name</i><b>] [</b><i>, position</i><b>] [</b><i>, type</i><b>] [</b><i>, source </i><b>] ) </b>
<dl>
<dt>
<i>objAttachment </i></dt>
<dd>
On successful return, contains the new Attachment object. </dd>
<dt>
<i>objAttachColl </i></dt>
<dd>
Required. The Attachments collection object. </dd>
<dt>
<i>name </i></dt>
<dd>
Optional. String. The display name of the attachment. The default value is an empty string. To allow a user to click on the attachment that appears in the message and activate an associated application, supply the full file name, including the file extension. </dd>
<dt>
<i>position </i></dt>
<dd>
Optional. Long. The position of the attachment within the body text of the message. The default value is zero. </dd>
<dt>
<i>type </i></dt>
<dd>
Optional. Long. The type of attachment; either <b>CdoFileData</b>, <b>CdoFileLink</b>, <b>CdoOLE</b>, or <b>CdoEmbeddedMessage</b>. The default value is <b>CdoFileData</b>. </dd>
<dt>
<i>source </i></dt>
<dd>
Optional. String. The path and file name of the file containing the data for the attachment, or the unique identifier of the message to be embedded. The path and file name must be in the appropriate format for the attachment type, specified by the <i>type</i> parameter. The default value is an empty string. 
</dd>
</dl>
<h4>Remarks </h4>
<p>
The <b>Add</b> method parameters correspond to the <a href="oleobjaf_3lv8.htm"><b>Name</b></a>, <a href="oleobjaf_9vn8.htm"><b>Position</b></a>, <a href="oleobjaf_84tw.htm"><b>Type</b></a>, and <a href="oleobjaf_2elw.htm"><b>Source</b></a> properties of the <a href="oleobjaf_0x10.htm">Attachment</a> object. The <i>source</i> parameter is also closely related to the <a href="oleobjaf_612s.htm"><b>ReadFromFile</b></a> method's <i>fileName</i> parameter. </p>
<p>
You can supply the data for the attachment at the same time that you add the attachment to the collection. The <b>Add</b> method operates differently, depending on the value of the <i>type</i> parameter. The following table describes its operation. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=37%>Value of <i>type</i> parameter </th>
<th align=left width=63%>Value of <i>source</i> parameter </th>
</tr>
<tr valign=top>
<td width=37%><b>CdoFileData </b></td>
<td width=63%>Specifies a full path and file name that contains the data for the attachment, for example C:\DOCUMENT\BUDGET.XLS. The data is read into the attachment. </td>
</tr>
<tr valign=top>
<td width=37%><b>CdoFileLink </b></td>
<td width=63%>Specifies a full path and file name in a universal naming convention (UNC) format, such as \\SALES\INFO\PRODUCTS\NEWS.DOC. The attachment is a link, so the <b>Add</b> method does not read the data. </td>
</tr>
<tr valign=top>
<td width=37%><b>CdoOLE </b></td>
<td width=63%>Specifies a full path and file name to a valid OLE docfile, for example C:\DOCUMENT\BUDGET2.XLS. The data is read into the attachment. </td>
</tr>
<tr valign=top>
<td width=37%><b>CdoEmbeddedMessage </b></td>
<td width=63%>Specifies the <a href="oleobjis_1r8l.htm"><b>ID</b></a> property of the message to be embedded. The message is copied into the attachment. </td>
</tr>
</table><br>
<p>
When the <i>type</i> parameter has the value <b>CdoFileLink</b>, the <i>source</i> parameter is a full path and file name in a UNC format. This is suitable for sending attachments to recipients who have access to a common file server. Note that when you use the <i>type</i> <b>CdoFileLink</b>, CDO does not validate the file name. </p>
<p>
If you do not specify the <i>name</i>, <i>type</i>, and <i>source</i> parameters when you call the <b>Add</b> method, you must later explicitly set these properties. In this case you must set <a href="oleobjaf_84tw.htm"><b>Type</b></a> before you set <a href="oleobjaf_2elw.htm"><b>Source</b></a>. Failure to do this can result in a return of <b>CdoE_NOT_FOUND</b> from the <a href="oleobjaf_612s.htm"><b>ReadFromFile</b></a> or <a href="oleobjaf_7f5g.htm"><b>WriteToFile</b></a> method. If the type is <b>CdoOLE</b>, you must also call <b>ReadFromFile</b> on the new <a href="oleobjaf_0x10.htm">Attachment</a> object to load the attachment's content. </p>
<p>
If you do not set the <a href="oleobjaf_3lv8.htm"><b>Name</b></a>, <a href="oleobjaf_84tw.htm"><b>Type</b></a>, and <a href="oleobjaf_2elw.htm"><b>Source</b></a> properties on an attachment, some calendaring clients may not successfully display the <a href="oleobjaf_5flg.htm">AppointmentItem</a>, <a href="oleobjis_4kac.htm">MeetingItem</a>, or <a href="oleobjis_2p10.htm">Message</a> object. Microsoft® Outlook™, for example, returns an error message when an attachment is empty, that is, has no properties set. </p>
<p>
The <a href="oleobjaf_66es.htm"><b>Index</b></a> property of the new Attachment object equals the new <a href="oleobjaf_93ji.htm"><b>Count</b></a> property of the Attachments collection. </p>
<p>
<b>Note</b>  Microsoft Outlook supports attachments on <a href="oleobjaf_5flg.htm">AppointmentItem</a> objects, but Microsoft® Schedule+ does not. For consistency of interface, the <b>Add</b> method always accepts a new attachment on an appointment, but if the appointment is associated with Schedule+, the attachment is ignored and discarded when you commit the appointment to storage with <a href="oleobjis_2un9.htm"><b>Send</b></a> or <a href="oleobjis_3wh1.htm"><b>Update</b></a>. </p>
<p>
The attachment is saved in the MAPI system when you <a href="oleobjis_3wh1.htm"><b>Update</b></a> or <a href="oleobjis_2un9.htm"><b>Send</b></a> the parent <a href="oleobjis_2p10.htm">Message</a> object. </p>
<p>&nbsp;</p></body>
</HTML>
