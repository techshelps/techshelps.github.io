<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a New Address Book Entry</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_creating_a_new_address_book_entry"></a>Creating a New Address Book Entry  <a href="oletasks_4ofn.htm"><img src="images/group.gif" border=0></a></h1>
<p>
You can create new address entries in a collection with the CDO Library version 1.1 and later. </p>
<p>
You need permission to <a href="oleobjaf_0j1b.htm"><b>Add</b></a> a new entry to an address book container. Usually you only have this permission for your personal address book (PAB). </p>
<p>
For address entries in an address book container, the hierarchy of objects is as follows: </p>
<p>
<a href="oleobjis_57w4.htm">Session</a> object <br>
&nbsp;  &nbsp;  <a href="oleobjaf_5fw4.htm">AddressLists</a> collection <br>
&nbsp;  &nbsp;  &nbsp;  &nbsp;  <a href="oleobjaf_4x84.htm">AddressList</a> object <br>
&nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  <a href="oleobjaf_7qd0.htm">AddressEntries</a> collection <br>
&nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  <a href="oleobjaf_6n1w.htm">AddressEntry</a> object <br>
&nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  <a href="oleobjaf_0yt0.htm">Fields</a> collection <br>
&nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  <a href="oleobjaf_8lh0.htm">Field</a> object </p>
<p>
The procedure is basically to work down the hierarchy. After a session is established and logged on, you use the Session object's <a href="oleobjis_0iu7.htm"><b>AddressLists</b></a> property to obtain the AddressLists collection, select the AddressList object corresponding to the desired address book container, and use the address list's <a href="oleobjaf_00v3.htm"><b>AddressEntries</b></a> property to call the AddressEntries collection's <a href="oleobjaf_0j1b.htm"><b>Add</b></a> method. </p>
<p>
If you have not specified all the parameters in the call to the <b>Add</b> method, you can then supply the missing values by setting AddressEntry object properties such as <a href="oleobjaf_9ed5.htm"><b>Address</b></a>, <a href="oleobjaf_6lfd.htm"><b>Name</b></a>, and <a href="oleobjaf_85q1.htm"><b>Type</b></a>. You can also set MAPI properties and custom properties using the new address entry's <a href="oleobjaf_8v3t.htm"><b>Fields</b></a> property. To create a custom property you call the Fields collection's <a href="oleobjaf_1qy6.htm"><b>Add</b></a> method. </p>
<p>
Finally, you commit all the new data to the address book container and to the MAPI system by calling the new address entry's <a href="oleobjaf_6zqx.htm"><b>Update</b></a> method. </p>
<p>
This code fragment adds a new entry to a user's PAB. Note the use of early binding and of default properties. The objects are declared using early binding to force matching of object types, and to distinguish a MAPI session from other types of sessions available to a Microsoft® Visual Basic® program through other object libraries. The <b>Item</b> property is the default property of all collections and so does not need to be specifically referenced in the statements selecting items from the <a href="oleobjaf_5fw4.htm">AddressLists</a> and <a href="oleobjaf_0yt0.htm">Fields</a> collections. </p>
<pre><code>' we assume we have add permission for our PAB 
Function AddEntry() 
 
Dim objSession As MAPI.Session   ' Session object 
Dim objMyPAB As AddressList      ' personal address book object 
Dim objNewEntry As AddressEntry  ' new address entry object 
Dim propTag As Long              ' MAPI property tag for new field 
 
On Error GoTo error_olemsg 
Set objSession = CreateObject("MAPI.Session") 
 
' log on to session, supplying username and password 
objSession.Logon 'profileName:="MyProfile", _ 
                 'profilePassword:="my_password" 
 
' get PAB AddressList from AddressLists collection of Session 
Set objMyPAB = objSession.AddressLists("Personal Address Book") 
If objMyPAB Is Nothing Then 
    MsgBox "Invalid PAB from session" 
    Exit Function 
End If 
 
' add new AddressEntry to AddressEntries collection of AddressList 
Set objNewEntry = objMyPAB.AddressEntries.Add("SMTP", "Jane Doe") 
objNewEntry.Address = "janed@exchange.microsoft.com" 
 
' set MAPI property in new AddressEntry (don't need to Add it) 
propTag = &amp;H3A08001E ' VB4.0: CdoPR_BUSINESS_TELEPHONE_NUMBER 
objNewEntry.Fields(propTag) = "+1-206-555-9901" 
 
' add custom property to new AddressEntry and set its value 
objNewEntry.Fields.Add "CellularPhone", vbString 
objNewEntry.Fields("CellularPhone") = "+1-206-555-9902" 
 
' commit new entry, properties, fields, and values to PAB AddressList 
objNewEntry.Update 
MsgBox "New address book entry successfully added" 
Exit Function 
 
error_olemsg: 
MsgBox "Error " &amp; Str(Err) &amp; ": " &amp; Error$(Err) 
Exit Function ' so many steps to succeed; just exit on error 
 
End Function 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
