<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating and Sending a Message</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_creating_and_sending_a_message"></a>Creating and Sending a Message  <a href="oletasks_4ofn.htm"><img src="images/group.gif" border=0></a></h1>
<p>
Creating and sending a message is easy when you use the CDO Library. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create and send a message </h5>
<ol>
<li>
Establish a session with the MAPI system. </li>
<li>
Call the <a href="oleobjis_1qd0.htm">Messages</a> collection's <a href="oleobjis_2l66.htm"><b>Add</b></a> method to create a <a href="oleobjis_2p10.htm">Message</a> object. </li>
<li>
Supply values for the Message object's <a href="oleobjis_7411.htm"><b>Subject</b></a>, <a href="oleobjis_0e5h.htm"><b>Text</b></a>, and other properties. </li>
<li>
Call the <a href="oleobjis_3xro.htm">Recipients</a> collection's <a href="oleobjis_9oku.htm"><b>Add</b></a> method for each recipient, or copy the <a href="oleobjis_46cl.htm"><b>Recipients</b></a> property from an existing message to the new message. </li>
<li>
If necessary, set each <a href="oleobjis_9cfo.htm">Recipient</a> object's <a href="oleobjis_0ino.htm"><b>Address</b></a>, <a href="oleobjis_9gms.htm"><b>AddressEntry</b></a>, and <a href="oleobjis_8z1w.htm"><b>Name</b></a> properties. </li>
<li>
Call each Recipient object's <a href="oleobjis_7cvo.htm"><b>Resolve</b></a> method to validate the address information. </li>
<li>
Call the Message object's <a href="oleobjis_2un9.htm"><b>Send</b></a> method. </li>
</ol>
<p>
The following code fragment demonstrates each of these steps for a message sent to a single recipient: </p>
<pre><code>' This also appears as the "QuickStart" example in "Overview" 
Function QuickStart() 
Dim objSession As Object  ' or Dim objSession As MAPI.Session 
Dim objMessage As Object  ' or Dim objMessage As Message 
Dim objOneRecip As Object ' or Dim objOneRecip As Recipient 
 
    On Error GoTo error_olemsg 
 
' create a session then log on, supplying username and password 
Set objSession = CreateObject("MAPI.Session") 
' change the parameters to valid values for your configuration 
objSession.Logon 'profileName:="Jane Doe", _ 
                 'profilePassword:="my_pword" 
 
' create a message and fill in its properties 
Set objMessage = objSession.Outbox.Messages.Add 
objMessage.Subject = "Sample Message" 
objMessage.Text = "This is some sample message text." 
 
' create the recipient 
Set objOneRecip = objMessage.Recipients.Add 
objOneRecip.Name = "John Doe" 
objOneRecip.Type = CdoTo 
objOneRecip.Resolve 
 
' send the message and log off 
objMessage.Update 
objMessage.Send showDialog:=False 
MsgBox "The message has been sent" 
objSession.Logoff 
Exit Function 
 
error_olemsg: 
MsgBox "Error " &amp; Str(Err) &amp; ": " &amp; Error$(Err) 
Resume Next 
 
End Function 
 </code></pre>
<p>
<b>Note</b>  When you edit an object other than the <a href="oleobjis_2p10.htm">Message</a> object, save your changes using the <a href="oleobjis_3wh1.htm"><b>Update</b></a> method before you clear or reuse the variable that refers to the object. If you do not use the <b>Update</b> method, your changes can be lost without warning. </p>
<p>
After calling the Message object's <a href="oleobjis_2un9.htm"><b>Send</b></a> method, you should not try to access the Message object again. The <b>Send</b> method invalidates the Message object. </p>
<h4>See Also </h4>
<p>
<a href="oletasks_9pr9.htm">Adding Attachments to a Message</a>, <a href="oletasks_0hlx.htm">Customizing a Folder or Message</a> </p>
<p>&nbsp;</p></body>
</HTML>
