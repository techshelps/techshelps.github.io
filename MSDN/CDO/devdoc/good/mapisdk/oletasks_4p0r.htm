<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Selecting Recipients from the Address Book</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_selecting_recipients_from_the_address_book"></a>Selecting Recipients from the Address Book  <a href="oletasks_4ofn.htm"><img src="images/group.gif" border=0></a></h1>
<p>
After establishing a <a href="oleobjis_57w4.htm">Session</a> object and successfully logging on to the system, the user can access the address book to select recipients. You can select recipients from any address book, such as the global address list (GAL) or your personal address book (PAB). </p>
<p>
As described in <a href="oleoview_7vvy.htm">CDO Library Object Design</a>, the CDO Library objects are organized in a hierarchy. The Session object at the topmost level contains an <a href="oleobjis_8dri.htm"><b>AddressBook</b></a> method that lets your application users select recipients from an address book. The method returns a Recipients collection, which contains individual Recipient objects. The Recipient object in turn specifies an AddressEntry object. This hierarchy is shown in the following diagram. </p>
<p>
<a href="oleobjis_3xro.htm">Recipients</a> collection <br>
&nbsp;  &nbsp;  <a href="oleobjis_9cfo.htm">Recipient</a> object <br>
&nbsp;  &nbsp;  &nbsp;  &nbsp;  <a href="oleobjis_0ino.htm"><b>Address</b></a> property (full address) <br>
&nbsp;  &nbsp;  &nbsp;  &nbsp;  <a href="oleobjaf_6n1w.htm">AddressEntry</a> object <br>
&nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  <a href="oleobjaf_9ed5.htm"><b>Address</b></a> property (e-mail address, no type) <br>
&nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  <a href="oleobjaf_85q1.htm"><b>Type</b></a> property </p>
<p>
To obtain an individual <b>Address</b> property that can be used to address and send messages, the application must move down through this object hierarchy. The following code fragment uses the Recipients collection returned by the Session object's <b>AddressBook</b> method. </p>
<p>
This code fragment assumes that the application has already created the Session object variable <i>objSession</i> and successfully called the Session object's <a href="oleobjis_31ym.htm"><b>Logon</b></a> method, as described in <a href="oletasks_6q7i.htm">Starting a CDO Session</a>: </p>
<pre><code>' Function: Session_AddressBook 
' Purpose: Set the global variable that contains the current recipients 
'        collection to that returned by the Session AddressBook method 
' See documentation topic: AddressBook method (Session object) 
Function Session_AddressBook() 
    On Error GoTo err_Session_AddressBook 
 
    If objSession Is Nothing Then 
        MsgBox "Must first create MAPI session and logon" 
        Exit Function 
    End If 
    Set objRecipColl = objSession.AddressBook( _ 
                       Title:="Select Attendees", _ 
                       forceResolution:=True, _ 
                       recipLists:=1, _ 
                       toLabel:="&amp;Cdo") ' appears on button 
    ' Note: first parameter ("recipients") not used in this call 
    ' recipients:=objInitRecipColl initializes recipients for dialog 
    MsgBox "Name of first recipient = " &amp; objRecipColl.Item(1).Name 
    Exit Function 
 
err_Session_AddressBook: 
    If (Err = 91) Then ' MAPI dlg-related function that sets an object 
        MsgBox "No recipients selected" 
    Else 
        MsgBox "Unrecoverable Error:" &amp; Err 
    End If 
    Exit Function 
End Function 
 </code></pre>
<h4>See Also </h4>
<p>
<a href="oletasks_86ex.htm">Changing an Existing Address Entry</a>, <a href="oletasks_44oj.htm">Using Addresses</a> </p>
<p>&nbsp;</p></body>
</HTML>
