<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CheckAMSession</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_olemsg_checkamsession"></a>CheckAMSession</h3>
<p>
The <b>CheckAMSession</b> function checks for a valid CDO session (a connection to the server), and returns the CDO session in the Session object. It should be at the beginning of the script. It is important to call <b>CheckAMSession</b> before sending any HTML to the browser; otherwise, any redirects, authentication, and so on, may not work. </p>
<p>
If no session is found, <b>CheckAMSession </b>calls the <b>NoSession</b> function. If the CDO session does not exist and the URL does not contain server and mailbox data, a logon form will be sent to the user to fill out.</p>
<p>
The <b>CheckAMSession</b> function returns <b>True</b> if a session exists or can be created.</p>
<p>
The following call to the Session object retrieves the "AMSession" named property.</p>
<pre><code>Set amSession= Session( "AMSession")
</code></pre>
<p>
Previously, in the global.asa file, Session( "AMSession") was set to <b>Nothing</b>. Now, in the first call to the <b>CheckAMSession</b> function, it still is <b>Nothing</b>. When it is <b>Nothing</b>, the <a href="amsamples_66ar.htm"><b>NoSession</b></a> function is called to create a session. Upon return, the existence of a session is checked once more, again in the call</p>
<pre><code>Set amSession= Session( "AMSession")
</code></pre>
<p>
After this, <b>CheckAMSession</b> is set to <b>True</b> if a session has been successfully recognized or started.</p>
<p>&nbsp;</p></body>
</HTML>
