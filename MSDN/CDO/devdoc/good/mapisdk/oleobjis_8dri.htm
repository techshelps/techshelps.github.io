<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AddressBook Method (Session Object)</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_addressbook_method_session"></a>AddressBook Method (Session Object)  <a href="oleobjis_57w4.htm"><img src="images/group.gif" border=0></a></h1>
<p>
The <b>AddressBook</b> method displays a modal dialog box that allows the user to select entries from the address book. The selections are returned in a <a href="oleobjis_3xro.htm">Recipients</a> collection object. </p>
<h4>Syntax </h4>
<p>
<b>Set </b><i>objRecipients</i> = <i>objSession</i>.<b>AddressBook( [</b><i>recipients</i><b>] [</b>,<i> title</i><b>] [</b><i>, oneAddress</i><b>] [</b><i>, forceResolution</i><b>] [</b><i>, recipLists</i><b>] [</b><i>, toLabel</i><b>] [</b><i>, ccLabel</i><b>] [</b><i>, bccLabel</i><b>] [</b><i>, parentWindow </i><b>] ) </b>
<dl>
<dt>
<i>objRecipients </i></dt>
<dd>
On successful return, the Recipients collection object. When the user does not select any names from the dialog box, <b>AddressBook</b> returns <b>Nothing</b>. </dd>
<dt>
<i>objSession </i></dt>
<dd>
Required. The Session object. </dd>
<dt>
<i>recipients </i></dt>
<dd>
Optional. Object. A <a href="oleobjis_3xro.htm">Recipients</a> collection object that provides initial values for the recipient list boxes in the address book dialog box. During the dialog, the user can select recipients from this collection and add other recipients. </dd>
<dt>
<i>title </i></dt>
<dd>
Optional. String. The title or caption of the address book dialog box. The default value is an empty string. </dd>
<dt>
<i>oneAddress </i></dt>
<dd>
Optional. Boolean. Allows the user to enter or select only one address entry at a time. The default value is <b>False</b>. </dd>
<dt>
<i>forceResolution</i></dt>
<dd>
Optional. Boolean. If <b>True</b>, attempts to resolve all names before closing the address book. Prompts the user to resolve any ambiguous names. The default value is <b>True</b>. </dd>
<dt>
<i>recipLists </i></dt>
<dd>
Optional. Long. The number of recipient list boxes to display in the address book dialog box: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=25%><i>recipLists</i> <br>
setting </th>
<th align=left width=75%> <br>
Action </th>
</tr>
<tr valign=top>
<td width=25%>–1 </td>
<td width=75%>Displays three list boxes with default captions and without resolution, that is, acts as a shortcut for <i>forceResolution=False, recipLists=3</i> with no setting of <i>toLabel</i>, <i>ccLabel</i>, or <i>bccLabel</i>. </td>
</tr>
<tr valign=top>
<td width=25%>0 </td>
<td width=75%>Displays no list boxes. The user can interact with the address book dialog box but no recipients are returned by this method. </td>
</tr>
<tr valign=top>
<td width=25%>1 </td>
<td width=75%>Displays one list box for <b>CdoTo</b> recipients (default). </td>
</tr>
<tr valign=top>
<td width=25%>2 </td>
<td width=75%>Displays two list boxes for <b>CdoTo</b> and <b>CdoCc</b> recipients. </td>
</tr>
<tr valign=top>
<td width=25%>3 </td>
<td width=75%>Displays three list boxes for <b>CdoTo</b>, <b>CdoCc</b>, and <b>CdoBcc</b> recipients. </td>
</tr>
</table><br>

</dd>
<dt>
<i>toLabel </i></dt>
<dd>
Optional. String. The caption for the button associated with the first recipient list box. Ignored if <i>recipLists</i> is less than 1. If omitted, the default value "To:" is displayed. </dd>
<dt>
<i>ccLabel </i></dt>
<dd>
Optional. String. The caption for the button associated with the second recipient list box. Ignored if <i>recipLists</i> is less than 2. If omitted, the default value "Cc:" is displayed. </dd>
<dt>
<i>bccLabel </i></dt>
<dd>
Optional. String. The caption for the button associated with the third recipient list box. Ignored if <i>recipLists</i> is less than 3. If omitted, the default value "Bcc:" is displayed. </dd>
<dt>
<i>parentWindow </i></dt>
<dd>
Optional. Long. The parent window handle for the address book dialog box. A value of zero (the default) specifies that the dialog box should be application-modal. 
</dd>
</dl>
<h4>Remarks </h4>
<p>
The <b>AddressBook</b> method returns <b>CdoE_USER_CANCEL</b> if the user cancels the dialog box. </p>
<p>
The <i>recipients</i> parameter provides initial values for the recipient list boxes. These values expedite the user's recipient selection process. A common use of this parameter is to set it to the <a href="oleobjis_3xro.htm">Recipients</a> collection of a message to which you are generating a reply. </p>
<p>
When you use <b>AddressBook</b> to let the user select recipients for a new message, you use either two or three different Recipients collections, depending on whether you furnish the <i>recipients</i> parameter. Use the following procedure: 
<ol>
<li>
Optionally, prepare an initial Recipients collection to be submitted in the <i>recipients</i> parameter to the <b>AddressBook</b> method. </li>
<li>
Call <b>AddressBook</b>, which returns the user-selected Recipients collection. </li>
<li>
Call the <a href="oleobjis_2l66.htm"><b>Add</b></a> method on a <a href="oleobjis_1qd0.htm">Messages</a> collection to create a new message. </li>
<li>
Copy the Recipients collection returned by <b>AddressBook</b> to the <a href="oleobjis_46cl.htm">Recipients</a> property of the new message: </li>
</ol>
<pre><code>Set objNewMessage.Recipients = objRecipients 
    objNewMessage.Recipients.Resolve ' also updates everything 
 </code></pre>
<p>
The <i>oneAddress</i> parameter indicates whether only one address entry at a time can be selected before being added to the recipients list. If <i>oneAddress</i> is set to <b>False</b>, the user can select multiple recipients by using the <small>ctrl</small> or <small>shift</small> key during the selection. If <i>oneAddress</i> is set to <b>True</b>, multiple selection is disabled. </p>
<p>
To provide an access key for the recipient list boxes, include an ampersand (&amp;) character in the label argument string, immediately before the character that serves as the access key. For example, if <i>toLabel</i> is "Local &amp;Attendees:", users can press <small>alt+a</small> to move the focus to the first recipient list box. </p>
<p>
The address book dialog box is always modal, meaning the parent window is disabled while the dialog box is active. If the <i>parentWindow</i> parameter is set to zero or is not set, all windows belonging to the application are disabled while the dialog box is active. If the <i>parentWindow</i> parameter is supplied but is not valid, the call returns <b>CdoE_INVALID_PARAMETER</b>. </p>
<p>
The following methods can invoke dialog boxes: 
<ul>
<li>
<a href="oleobjaf_092x.htm"><b>Details</b></a> method (<a href="oleobjaf_6n1w.htm">AddressEntry</a> object) </li>
<li>
<a href="oleobjis_51gl.htm"><b>Options</b></a> and <a href="oleobjis_2un9.htm"><b>Send</b></a> methods (<a href="oleobjis_2p10.htm">Message</a> object) </li>
<li>
<a href="oleobjis_7cvo.htm"><b>Resolve</b></a> method (<a href="oleobjis_9cfo.htm">Recipient</a> object) </li>
<li>
<a href="oleobjis_1zu6.htm"><b>Resolve</b></a> method (<a href="oleobjis_3xro.htm">Recipients</a> collection) </li>
<li>
<b>AddressBook</b> and <a href="oleobjis_31ym.htm"><b>Logon</b></a> methods (Session object) </li>
</ul>
<p>
However, if your application is running as a Microsoft® Windows NT® service, for example from Active Server Pages (ASP) script on a Microsoft® Internet Information Server (IIS), no user interface is allowed. </p>
<p>
For more information on Windows NT services, see the Win32® Web page <i>Using MAPI from a Windows NT Service</i> at http://www.microsoft.com/win32dev/mapi/mapiserv.htm. For more information on running as a service, see "Windows NT Service Client Applications" in the <i>MAPI Programmer's Reference</i>. </p>
<h4>Example </h4>
<p>
This code fragment displays an address book dialog box labeled "Select Attendees" with three recipient lists: </p>
<pre><code>If objSession Is Nothing Then 
    MsgBox "Must first create MAPI session and log on" 
    Exit Function 
End If 
Set objRecipColl = objSession.AddressBook( _ 
                      Title:="Select Attendees", _ 
                      forceResolution:=True, _ 
                      recipLists:=3, _ 
                      toLabel:="&amp;Very Important People", _ ' on button 
                      ccLabel:="&amp;Fairly Important People", _ 
                      bccLabel:="&amp;Secret Important People") 
' "recipients:=" parameter not used in preceding call 
MsgBox "Name of first recipient = " &amp; objRecipColl.Item(1).Name 
' could be objRecipColl(1) since Item and Name are default properties 
Exit Function 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
