<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetFolder Method (Session Object)</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_getfolder_method_session"></a>GetFolder Method (Session Object)  <a href="oleobjis_57w4.htm"><img src="images/group.gif" border=0></a></h1>
<p>
The <b>GetFolder</b> method returns a <a href="oleobjaf_4u2c.htm">Folder</a> object from a MAPI message store. </p>
<h4>Syntax </h4>
<p>
<b>Set </b><i>objFolder = objSession</i>.<b>GetFolder(</b><i>folderID </i><b>[</b>, <i>storeID</i><b>] ) </b>
<dl>
<dt>
<i>objFolder </i></dt>
<dd>
On successful return, contains the Folder object with the specified identifier. When the folder does not exist, <b>GetFolder</b> returns <b>Nothing</b>. </dd>
<dt>
<i>objSession </i></dt>
<dd>
Required. The Session object. </dd>
<dt>
<i>folderID </i></dt>
<dd>
Required. String that specifies the unique identifier of the folder. When you provide an empty string, some providers return the root folder. </dd>
<dt>
<i>storeID </i></dt>
<dd>
Optional. String that specifies the unique identifier of the message store containing the folder. The default value is an empty string, which corresponds to the default message store. 
</dd>
</dl>
<h4>Remarks </h4>
<p>
The <b>GetFolder</b> method allows you to obtain any <a href="oleobjaf_4u2c.htm">Folder</a> object for which you know the identifier, that is, the folder's <a href="oleobjaf_2ur6.htm"><b>ID</b></a> property. </p>
<p>
For some message stores, you can obtain the store's root folder by supplying an empty string as the value for <i>folderID</i>. If the message store does not support returning its root folder, the call returns the error value <b>CdoE_NOT_FOUND</b>. </p>
<p>
Note that the store's root folder differs from the IPM root folder. The store's root folder is the parent of the root folder of the the IPM subtree. The IPM subtree contains all interpersonal messages in a hierarchy of folders. Interpersonal messages are those whose message class starts with IPM, such as IPM.Note. </p>
<p>
You can obtain the IPM root folder with the <a href="oleobjis_4k6s.htm">InfoStore</a> object's <a href="oleobjis_3vc5.htm"><b>RootFolder</b></a> property. You can obtain the store's root folder through the IPM root folder's <a href="oleobjaf_0vxu.htm"><b>FolderID</b></a> property. </p>
<p>
If your application is running as a Microsoft® Windows NT® service, you cannot access the Microsoft Exchange Public Folders through the normal hierarchy because of a notification conflict. You must use the <a href="oleobjis_4k6s.htm">InfoStore</a> object's <a href="oleobjis_9s9r.htm"><b>Fields</b></a> property to obtain the Microsoft Exchange property PR_IPM_PUBLIC_FOLDERS_ENTRYID, property tag &amp;H66310102. This represents the top-level public folder and allows you to access all other public folders through its <a href="oleobjaf_2u5u.htm"><b>Folders</b></a> property. For more information on Windows NT services, see the Win32® Web page <i>Using MAPI from a Windows NT Service</i> at http://www.microsoft.com/win32dev/mapi/mapiserv.htm. </p>
<h4>Example </h4>
<p>
This code fragment uses the <b>GetFolder</b> method to obtain a specific folder from a MAPI message store: </p>
<pre><code>' from the function Session_GetFolder 
' requires a global variable that contains the folder ID 
' uses a global variable that contains the message store ID if present 
    If strFolderID = "" Then 
        MsgBox ("Must first set string variable to folder ID") 
        Exit Function 
    End If 
    If strFolderStoreID = "" Then ' maybe get root folder 
        Set objFolder = objSession.GetFolder(strFolderID) 
    Else 
        Set objFolder = objSession.GetFolder(folderID:=strFolderID, _ 
                                            storeID:=strFolderStoreID) 
    End If 
    If objFolder Is Nothing Then 
        Set objMessages = Nothing 
        MsgBox "Unable to retrieve folder with specified ID" 
        Exit Function 
    Else 
        Set objMessages = objFolder.Messages 
        MsgBox "Folder set to " &amp; objFolder.Name 
    End If 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
