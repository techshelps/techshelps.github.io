<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Classified Ad Files</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_olemsg_classified_ad_files"></a>Classified Ad Files</h2>
<p>
This sample contains two sets of files. The first set, in the folder NewClassifiedAd, stores the ASP files necessary to create and view a classified ad form. The second set, in the folder Purchoffr, stores the files needed to create and view purchase offers and responses. </p>
<p>
The root folder holds the include files needed by both samples and the base code for the discussion application. Also see the section on the <a href="amsamples_0zzi.htm">Discussion Forum sample application</a> for descriptions of some of these files:</p>
<p>
<b>Root Folder (Discussion) Files</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=25%>File</th>
<td width=75%><b>Purpose</b></td>
</tr>
<tr valign=top>
<td width=25%>amprops.inc</td>
<td width=75%>Definitions of common CDO constants and properties.</td>
</tr>
<tr valign=top>
<td width=25%>default.htm</td>
<td width=75%>Takes the user to root.asp.</td>
</tr>
<tr valign=top>
<td width=25%>discroot.asp</td>
<td width=75%>The root frame for the discussion. Called from root.htm, this file calls title.asp and folder.asp to display the discussion content. This file also contains several JavaScript functions called by the browser on events in title.asp and folder.asp.</td>
</tr>
<tr valign=top>
<td width=25%>existing.htm</td>
<td width=75%>This is a placeholder for your existing Web site. It is displayed at the top of your browser window. It shows how to link to the discussion/classified ad scripts and how to set them to open a specific folder or message.</td>
</tr>
<tr valign=top>
<td width=25%>folder.asp</td>
<td width=75%>Folder.asp calls functions in folder.inc to set the renderer and render views of folders. It displays a page of messages (25 lines at a time). The format depends on the view selected. </td>
</tr>
<tr valign=top>
<td width=25%>folder.inc</td>
<td width=75%>This include file contains most of the code specific to the CDO Rendering Library. Rendering objects are created and set up here; folder views, current folder, and the current page are set here. Folder.inc contains functions for generating a renderer.</td>
</tr>
<tr valign=top>
<td width=25%>getrend.inc</td>
<td width=75%>Contains functions for opening information stores and messages.</td>
</tr>
<tr valign=top>
<td width=25%><a href="amsamples_43vl.htm">global.asa</a></td>
<td width=75%>Performs Active Server startup and shutdown functions, including impersonation to validate the user.  </td>
</tr>
<tr valign=top>
<td width=25%>item.asp</td>
<td width=75%>This script processes next/previous message requests.</td>
</tr>
<tr valign=top>
<td width=25%>lang.inc</td>
<td width=75%>Sets strings and error messages. Concentrating these in a single include file eases localization.</td>
</tr>
<tr valign=top>
<td width=25%>root.asp</td>
<td width=75%>Logs you onto the Microsoft Exchange site. Creates a frameset and launches existing.htm, folder.inc, and discroot.asp.</td>
</tr>
<tr valign=top>
<td width=25%>title.asp</td>
<td width=75%>This is a control bar containing JavaScript controls for setting views, refreshing the screen, paging through messages, and launching \newclassad\compose.asp to write a new ad. </td>
</tr>
</table><br>
<p>
<b>NewClassifiedAd Files</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=25%><b>File</b></td>
<td width=75%><b>Purpose</b></td>
</tr>
<tr valign=top>
<td width=25%>rootcomp.asp</td>
<td width=75%>Used for rendering the frameset of the new classified ad. This page also holds several JavaScript functions that validate data in compose.asp before allowing resolve.asp to send the custom message or form.</td>
</tr>
<tr valign=top>
<td width=25%>compose.asp</td>
<td width=75%>Displays an input form that the client uses to place an ad to buy or to sell items. Data is passed to resolve.asp after it has been verified by rootcomp.asp </td>
</tr>
<tr valign=top>
<td width=25%>resolve.asp</td>
<td width=75%>Retrieves the data entered by the client in compose.asp and attempts to send mail to the public folder called Classified Ads.</td>
</tr>
<tr valign=top>
<td width=25%>category.asp and subcat.asp</td>
<td width=75%>Used to display the many categories and subcategories of items to be sold or purchased. </td>
</tr>
<tr valign=top>
<td width=25%>read.asp</td>
<td width=75%>Displays the contents of a previously generated classified ad and lets users create responses known as purchase offers. </td>
</tr>
<tr valign=top>
<td width=25%>amprops.inc</td>
<td width=75%>Sets constants.</td>
</tr>
</table><br>
<p>
<b>Purchoffr Files</b></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=25%><b>File</b></td>
<td width=75%><b>Purpose</b></td>
</tr>
<tr valign=top>
<td width=25%>rootcomp.asp</td>
<td width=75%>Used for rendering the frameset of the purchase offer. This page also holds several JavaScript functions that validate data in compose.asp before allowing resolve.asp to send the custom message or form.</td>
</tr>
<tr valign=top>
<td width=25%>compose.asp</td>
<td width=75%>Displays an input form that the client uses to respond to an ad to buy or sell items. Data is passed to resolve.asp after it has been verified by rootcomp.asp. This form is not posted to the Classified Ad folder; rather, it is sent to the creator of the classified ad.</td>
</tr>
<tr valign=top>
<td width=25%>resolve.asp</td>
<td width=75%>Retrieves the data entered by the client in compose.asp and attempts to send mail to the individual who initially posted the classified ad.</td>
</tr>
<tr valign=top>
<td width=25%>read.asp</td>
<td width=75%>Displays the purchase offer generated by another user. Viewers of this form can respond to the offer using the standard reply note.</td>
</tr>
<tr valign=top>
<td width=25%>amprops.inc</td>
<td width=75%>Sets constants.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
