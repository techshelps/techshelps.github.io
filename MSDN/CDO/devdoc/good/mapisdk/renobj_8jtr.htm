<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ListComposeForms Method (RenderingApplication Object)</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_olemsg_listcomposeforms_method_renderingapplication_object_"></a>ListComposeForms Method (RenderingApplication Object)  <a href="renobj_8kac.htm"><img src="images/group.gif" border=0></a></h1>
<p>
The <b>ListComposeForms</b> method returns an array of compose form strings. </p>
<h4>Syntax </h4>
<p>
<i>strArrayFormList = objRendApp</i>.<b>ListComposeForms(</b><i>bstrLinkPattern</i><b>) </b>
<dl>
<dt>
<i>strArrayFormList </i></dt>
<dd>
On successful return, contains a string array of designated compose form strings. </dd>
<dt>
<i>objRendApp </i></dt>
<dd>
Required. The RenderingApplication object. </dd>
<dt>
<i>bstrLinkPattern </i></dt>
<dd>
Required. String. The pattern string used to generate the designated form strings. 
</dd>
</dl>
<h4>Remarks </h4>
<p>
The <b>ListComposeForms</b> method can be used to support launching custom forms from Web clients. </p>
<p>
The <i>bstrLinkPattern</i> parameter can include any or all of the following substitution tokens: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Substitution token </th>
<th align=left width=52%>Attribute substituted for token </th>
</tr>
<tr valign=top>
<td width=48%>%class% </td>
<td width=52%>The message class </td>
</tr>
<tr valign=top>
<td width=48%>%classpath% </td>
<td width=52%>The partial URL path for the form </td>
</tr>
<tr valign=top>
<td width=48%>%formname% </td>
<td width=52%>The form's name from FORM.INI </td>
</tr>
</table><br>
<p>
Each returned string is a copy of the <i>bstrLinkPattern</i> string with any substitution tokens replaced with the values appropriate for the corresponding form. </p>
<p>
For example, Microsoft® Outlook™ Web Access might set <i>bstrLinkPattern</i> to </p>
<pre><code>rgForms = objRA.ListComposeForms("&lt;A HREF='JavaScript:openNewWindow 
            (""/Exchange/forms/%classpath%/frmroot.asp?command=new"", 
            ""New message"", 640, 500)'&gt;%formname%&lt;/A&gt;") 
 </code></pre>
<p>
In order for a form to be reflected in the returned list, there must be a file named FORM.INI in the form directory, as well as frmroot.asp. FORM.INI may have the following contents: </p>
<p>
&nbsp;  &nbsp;  [Description] <br>
&nbsp;  &nbsp;  DisplayName=<i>&lt;form name&gt;</i> <br>
&nbsp;  &nbsp;  Hidden=0/1 </p>
<p>
If FORM.INI files have been added to or deleted from the form directory since you called <b>ListComposeForms</b>, you can refresh the list of designated compose forms by setting the <a href="renobj_2kin.htm"><b>FormsRoot</b></a> property to its current value. </p>
<h4>Example </h4>
<p>
This script demonstrates the <b>ListComposeForms</b> method as it might be used from Microsoft® Outlook™ Web Access: </p>
<pre><code>&lt;HTML&gt; 
&lt;!-- 
 This script tests RenderingApplication.ListComposeForms 
 First it writes out a table listing all the %tokens% for each form. 
 Next it writes out a table using an Outlook Web Access link pattern; 
      these links should bring up a form when followed. 
--&gt; 
&lt;HEAD&gt; 
&lt;META NAME="GENERATOR" Content="Microsoft Developer Studio"&gt; 
&lt;META HTTP-EQUIV="Content-Type" content="text/html; charset=iso-8859-1"&gt; 
&lt;TITLE&gt;Test RenderingApplication.ListComposeForms&lt;/TITLE&gt; 
&lt;script language="Javascript"&gt; 
 
function openNewWindow(fileName,windowName,theWidth,theHeight) { 
&nbsp; if (windowName == "newMessageWindow") 
&nbsp; { 
&nbsp; &nbsp; //generate random window ID 
&nbsp; &nbsp;  windowName = new String(Math.round(Math.random() * 100000)); 
&nbsp; } 
&nbsp; window.open(fileName,windowName,"toolbar=0,location=0,directories=0, 
&nbsp; status=1,menubar=1,scrollbars=1,resizable=1,width="+theWidth+", 
&nbsp; height="+theHeight) 
} 
&lt;/script&gt; 
&lt;/HEAD&gt; 
&lt;BODY&gt; 
&lt;% 
set objRA = Application("RenderApplication") 
szCommand = Request.QueryString("command") 
%&gt; 
&lt;% if szCommand = "refresh" then %&gt; 
&lt;% 
Err.Clear 
objRA.FormsRoot = Server.MapPath("/Exchange") &amp; "\usa" 
if err &lt;&gt; 0 then 
Response.Write err.number &amp; " : " &amp; err.description &amp; "&lt;br&gt;" 
else 
Response.Write "Forms list successfully refreshed." &amp; "&lt;br&gt;" 
end if 
%&gt; 
&lt;center&gt; 
&lt;P&gt;Click &lt;A HREF=f.asp&gt;here&lt;/A&gt; to view the forms list. 
&lt;/center&gt; 
&lt;% else %&gt; 
&lt;% 
rgNames = objRA.ListComposeForms("%formname%") 
rgPaths = objRA.ListComposeForms("%classpath%") 
rgClasses = objRA.ListComposeForms("%class%") 
rgForms = objRA.ListComposeForms("&lt;A HREF='JavaScript:openNewWindow 
          (""/Exchange/forms/%classpath%/frmroot.asp?command=new"", 
          ""New message"", 640, 500)'&gt;%formname%&lt;/A&gt;") 
%&gt; 
&lt;% if isempty(rgnames) then %&gt; 
&lt;P&gt; 
&lt;% else %&gt; 
&lt;P&gt;This table enumerates all the variables accessible through ListComposeForms. 
&lt;table border=1 columns=3 width=100%&gt; 
&lt;tr&gt;&lt;td&gt;&lt;b&gt;Name&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;Path&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;Class&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt; 
&lt;% 
for i = 1 to UBound(rgNames) 
&nbsp; Response.Write "&lt;tr&gt;" 
&nbsp; Response.Write "&lt;td&gt;" &amp; rgNames(i) &amp; "&lt;/td&gt;&lt;td&gt;" &amp; rgPaths(i) &amp; 
&nbsp;   "&lt;/td&gt;&lt;td&gt;" &amp; rgClasses(i) &amp; "&lt;/td&gt;" 
&nbsp; Response.Write "&lt;/tr&gt;" 
next 
%&gt; 
&lt;/table&gt; 
&lt;% end if %&gt; 
&lt;% if isempty(rgForms) then %&gt; 
&lt;P&gt;There are no composable forms on this server. 
&lt;% else %&gt; 
&lt;P&gt;This table contains working links to forms. 
&lt;center&gt; 
&lt;table border=1 width=50%&gt; 
&lt;% 
&nbsp; for each szForm in rgForms 
&nbsp; &nbsp; Response.Write "&lt;tr&gt;&lt;td align=center&gt;" 
&nbsp; &nbsp; Response.Write szForm 
&nbsp; &nbsp; Response.Write "&lt;/td&gt;&lt;/tr&gt;" 
&nbsp; next 
%&gt; 
&lt;/table&gt; 
&lt;/center&gt; 
&lt;% end if %&gt; 
&lt;center&gt; 
&lt;P&gt;Click &lt;A HREF=f.asp?command=refresh&gt;here&lt;/A&gt; to refresh the forms list. 
&lt;/center&gt; 
&lt;% end if %&gt; 
&lt;/BODY&gt; 
&lt;/HTML&gt; 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
