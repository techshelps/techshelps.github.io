<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AuthenticateUser</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_olemsg_authenticateuser"></a>AuthenticateUser</h3>
<p>
The <b>AuthenticateUser</b> function ensures that the user is already authenticated. Note that this implies that Basic Authentication or NTLM Authentication is enabled on the <a href="olegloss_48ix.htm#_olemsg_iis_gly">IIS</a> server. <b>AuthenticateUser</b> determines this by checking whether the AUTH_TYPE server variable of the Active Server Pages Request object contains the string "basic" or the string "NTLM".</p>
<p>
This function should be called at the beginning of an .asp file, before any command that may cause text to be sent to the browser.</p>
<p>
The following cases cause text to be sent to the browser and will cause the <b>AuthenticateUser</b> function to fail if they occur before the<b> AuthenticateUser</b> function call:
<ul>
<li>
HTML is sent on a page before user authentication is attempted.</li>
<li>
HTML comments (other than <b>&lt;!--#include </b>statements) are encountered.</li>
<li>
<b>Response.Write</b> is called.</li>
</ul>
<p>
If authentication fails, the following commands are executed:</p>
<pre><code>'Hold information coming from the server and do not send it to the browser until after Response.End
Response.Buffer = TRUE

'Say "Access denied"
Response.Status = ("401 Unauthorized")

'Failed to authenticate user. Send responses and stop executing the script
Response.End
</code></pre>
<p>
This file sets the access status with the <b>Response.Status</b> command, so that if the user is not already authenticated, this function returns error 401 (Access denied) and prompts the user for credentials.</p>
<p>
If the user is not authenticated, script execution stops and the browser request is not fulfilled. The user is notified that access is denied in the current unauthenticated state.</p>
<p>
Active Server Pages and IIS handle the next attempt at authentication and impersonation, if necessary. After a user is authenticated, this script runs in the user's security context. That is, it runs on the server as the user. This means that the script has access to exactly those network resources that the user can access.</p>
<p>&nbsp;</p></body>
</HTML>
