<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Customizing the Page Setup Dialog Box</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_customizing_the_page_setup_dialog_box"></a>Customizing the Page Setup Dialog Box</h3>
<p>
You can provide a custom template for the <b>Page Setup</b> dialog box, for example, if you want to include additional controls that are unique to your application. The <a href="commdlg3_89rb.htm"><b>PageSetupDlg</b></a> function uses your custom template in place of the default template. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To provide a custom template for the Page Setup dialog box</h5>
<ol>
<li>
Create the custom template by modifying the default template specified in the PRNSETUP.DLG file. The control identifiers used in the default Page Setup dialog template are defined in the DLGS.H file.</li>
<li>
Use the <a href="commdlg3_6waa.htm"><b>PAGESETUPDLG</b></a> structure to enable the template as follows:<ul>
<li>
If your custom template is a resource in an application or dynamic-link library, set the PSD_ENABLEPAGESETUPTEMPLATE flag in the <b>Flags</b> member. Use the <b>hInstance</b> and <b>lpPageSetupTemplateName</b> members of the structure to identify the module and resource name. <p>
<b>-Or-</b>
</li>
<li>
If your custom template is already in memory, set the PSD_ENABLEPAGESETUPTEMPLATEHANDLE flag. Use the <b>hPageSetupTemplate</b> member to identify the memory object that contains the template. </li>
</ul>
</li>
</ol>
<p>
To filter messages sent to the dialog box procedure, you can provide a <a href="commdlg3_23l7.htm"><b>PageSetupHook</b></a> hook procedure. If you use a custom template to define additional controls, you must provide a <a href="commdlg3_23l7.htm"><b>PageSetupHook</b></a> hook procedure to process input for your controls. In addition, you can provide a <b>PagePaintHook</b> hook procedure to customize the contents of the sample page displayed by the <b>Page Setup</b> dialog box. For more information about the <b>PagePaintHook</b> hook procedure, see <a href="commdlg3_8ftx.htm">Customizing the Sample Page</a>.<b> </b></p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To enable a PageSetupHook hook procedure</h5>
<ol>
<li>
Set the PSD_ENABLEPAGESETUPHOOK flag in the <b>Flags</b> member of the <a href="commdlg3_6waa.htm"><b>PAGESETUPDLG</b></a> structure.</li>
<li>
Specify the address of the hook procedure in the <b>lpfnPageSetupHook</b> member.</li>
</ol>
<p>
After processing its <a href="dlgboxes_4n1j.htm">WM_INITDIALOG</a> message, the dialog box procedure sends a WM_INITDIALOG message to the <a href="commdlg3_23l7.htm"><b>PageSetupHook</b></a> hook procedure. The <i>lParam</i> parameter of this message is a pointer to the <b>PAGESETUPDLG</b> structure used to initialize the dialog box. </p>
<p>&nbsp;</p></body>
</HTML>
