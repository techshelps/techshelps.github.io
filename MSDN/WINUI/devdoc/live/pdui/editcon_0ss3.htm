<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>EM_CHARFROMPOS</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_em_charfrompos"></a>EM_CHARFROMPOS</h1>
<p>
The EM_CHARFROMPOS message retrieves the character index and line index of the character nearest a specified point in the client area of an edit control. The application can send this message to either an edit control or a rich edit control.</p>
<p>
Rich edit controls use the following syntax:</p>
<pre><code>EM_CHARFROMPOS
wParam = 0;                        // not used
lParam = (LPARAM) (POINTL *) <i>lpPoint</i>;
     // pointer to a POINTL structure with the point coordinates
 </code></pre>
<p>
Edit controls use the following syntax:</p>
<pre><code>EM_CHARFROMPOS
wParam = 0;                        // not used
lParam = MAKELPARAM(<i>xPos</i>, <i>yPos</i>);   // coordinates of a point
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lParam</i></dt>
<dd>
Specifies the coordinates of a point in the control's client area. The coordinates are in screen units and are relative to the upper-left corner of the control's client area. 
<p>
<b>Rich edit controls:</b> <i>lParam</i> is a pointer to a <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_pointl_str">
</object><a href=JavaScript:alink_1.Click()><b>POINTL</b></a> structure that contains the horizontal and vertical coordinates. 

<p>
<b>Edit controls:</b> The low word of <i>lParam</i> contains the horizontal coordinate. The high word contains the vertical coordinate. 

</dd>
</dl>
<h4>Return Values</h4>
<p>
The low word of the return value specifies the zero-based index of the character nearest the specified point. This index is relative to the beginning of the control, not the beginning of the line. If the specified point is beyond the last character in the edit control, the return value indicates the last character in the control. </p>
<p>
The high word of the return value specifies the zero-based index of the line that contains the character. For single-line edit controls, this value is zero. The index indicates the line delimiter if the specified point is beyond the last visible character in a line.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winuser.h.</p>
<h4>See Also</h4>
<p>
<a href="editcon_4uwj.htm">Edit Controls Overview</a>, <a href="editcon_3xyr.htm">Edit Control Messages</a>, <a href="editcon_8ylu.htm">EM_POSFROMCHAR</a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_pointl_str">
</object><a href=JavaScript:alink_2.Click()><b>POINTL</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
