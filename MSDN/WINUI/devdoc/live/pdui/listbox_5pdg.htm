<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DlgDirList</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_dlgdirlist"></a>DlgDirList</h1>
<p>
The <b>DlgDirList</b> function fills the specified list box with the names of all files matching the specified path or filename. </p>
<pre><code><b>int DlgDirList(
  HWND</b><i> hDlg</i><b>,          </b>// handle to dialog box with list box
<b>  LPTSTR</b><i> lpPathSpec</i><b>,  </b>// pointer to path or filename string
<b>  int</b><i> nIDListBox</i><b>,     </b>// identifier of list box
<b>  int</b><i> nIDStaticPath</i><b>,  </b>// identifier of static control
<b>  UINT</b><i> uFileType</i>      // file attributes to display
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hDlg</i></dt>
<dd>
Handle to the dialog box that contains the list box. </dd>
<dt>
<i>lpPathSpec</i></dt>
<dd>
Pointer to a null-terminated string that contains the path or filename. <b>DlgDirList</b> modifies this string, which should be long enough to contain the modifications. For more information about this parameter, see the Remarks section. </dd>
<dt>
<i>nIDListBox</i></dt>
<dd>
Specifies the identifier of a list box. If this parameter is zero, <b>DlgDirList</b> assumes that no list box exists and does not attempt to fill one. </dd>
<dt>
<i>nIDStaticPath</i></dt>
<dd>
Specifies the identifier of the static control used for displaying the current drive and directory. If this parameter is zero, <b>DlgDirList</b> assumes that no such control is present. </dd>
<dt>
<i>uFileType</i></dt>
<dd>
Specifies attributes of the filenames to be displayed. This parameter must be one or more of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Value</th>
<th align=left width=68%>Description</th>
</tr>
<tr valign=top>
<td width=32%>DDL_ARCHIVE</td>
<td width=68%>Includes archived files.</td>
</tr>
<tr valign=top>
<td width=32%>DDL_DIRECTORY</td>
<td width=68%>Includes subdirectories. Subdirectory names are enclosed in square brackets ([ ]).</td>
</tr>
<tr valign=top>
<td width=32%>DDL_DRIVES</td>
<td width=68%>Includes drives. Drives are listed in the form [-<i>x</i>-], where <i>x</i> is the drive letter.</td>
</tr>
<tr valign=top>
<td width=32%>DDL_EXCLUSIVE</td>
<td width=68%>Includes only files with the specified attributes. By default, read-write files are listed even if DDL_READWRITE is not specified.</td>
</tr>
<tr valign=top>
<td width=32%>DDL_HIDDEN</td>
<td width=68%>Includes hidden files.</td>
</tr>
<tr valign=top>
<td width=32%>DDL_READONLY</td>
<td width=68%>Includes read-only files.</td>
</tr>
<tr valign=top>
<td width=32%>DDL_READWRITE</td>
<td width=68%>Includes read-write files with no additional attributes.</td>
</tr>
<tr valign=top>
<td width=32%>DDL_SYSTEM</td>
<td width=68%>Includes system files.</td>
</tr>
<tr valign=top>
<td width=32%>DDL_POSTMSGS</td>
<td width=68%>Posts messages to the application's message queue. By default, <b>DlgDirList</b> sends messages directly to the dialog box procedure.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. For example, if the string specified by <i>lpPathSpec</i> is not a valid path, the function fails. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
If you specify a zero-length string for the <i>lpPathSpec</i> parameter or if you specify only a directory name with no filename, the string will be changed to *.* </p>
<p>
The <i>lpPathSpec</i> parameter has the following form: </p>
<p>
<b>[</b><i>drive</i><b>:] [[\u]</b><i>directory</i><b>[\i</b><i>directory</i><b>]\u] [</b><i>filename</i><b>]</b> </p>
<p>
In this example, <i>drive</i> is a drive letter, <i>directory</i> is a valid directory name, and <i>filename</i> is a valid filename that must contain at least one wildcard (? or *). </p>
<p>
If <i>lpPathSpec</i> includes a drive or directory name, or both, the current drive and directory are changed to the specified drive and directory before the list box is filled. The static control identified by the <i>nIDStaticPath</i> parameter is also updated with the new drive or directory name, or both. </p>
<p>
After the list box is filled, <b>DlgDirList</b> updates <i>lpPathSpec</i> by removing the drive or directory portion, or both, of the path and filename. </p>
<p>
<b>DlgDirList</b> sends the LB_RESETCONTENT and LB_DIR messages to the list box. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winuser.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="listbox_9s4z.htm">List Boxes Overview</a>, <a href="listbox_5g4z.htm">List Box Functions</a>, <a href="combobox_5a60.htm"><b>DlgDirListComboBox</b></a>, <a href="combobox_5lfc.htm"><b>DlgDirSelectComboBoxEx</b></a>, <a href="combobox_6a7s.htm"><b>DlgDirSelectEx</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
