<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Hook Procedures for Common Dialog Boxes</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_hook_procedures_for_common_dialog_boxes"></a>Hook Procedures for Common Dialog Boxes</h3>
<p>
For each of the common dialog boxes, you can enable a hook procedure to process messages from the default dialog box procedure. There are two general types of common dialog hook procedures: 
<ul>
<li>
The standard hook procedure used with most common dialog boxes</li>
<li>
The Explorer-style hook procedure supported by the <b>Open</b> and <b>Save As </b>dialog boxes </li>
</ul>
<p>
When you provide a standard hook procedure for one of the common dialog boxes, the default dialog box procedure handles its messages as follows.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Message</th>
<th align=left width=68%>Handling</th>
</tr>
<tr valign=top>
<td width=32%><a href="dlgboxes_4n1j.htm">WM_INITDIALOG</a> </td>
<td width=68%>The default dialog box procedure processes the message before passing it to the hook procedure. The message's <i>lParam</i> parameter is a pointer to the initialization structure specified when the dialog was created.</td>
</tr>
<tr valign=top>
<td width=32%>All other messages</td>
<td width=68%>The hook procedure receives the message first. Then, the return value of the hook procedure determines whether the default dialog procedure processes the message or ignores it.</td>
</tr>
</table><br>
<p>
For the Explorer-style <b>Open</b> and <b>Save As </b>dialog boxes, the hook procedure does not receive messages intended for the standard controls in the common dialog box. Instead, it receives notification messages from the dialog box and messages for any additional controls that you defined in a custom template. For more information, see <a href="commdlg3_39gz.htm">Explorer-Style Hook Procedures</a>. </p>
<p>
To enable a hook procedure, set an ENABLEHOOK value in the <b>Flags</b> member of the corresponding structure for the dialog box. If an ENABLEHOOK flag is set, an <b>lpfnHook</b> member of the structure must specify the address of the hook procedure. </p>
<p>
The following table shows the type of hook procedure to provide for each of the common dialog boxes.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Common dialog box type</th>
<th align=left width=68%>Hook procedure</th>
</tr>
<tr valign=top>
<td width=32%><b>Color</b></td>
<td width=68%><a href="commdlg3_04yr.htm"><b>CCHookProc</b></a> </td>
</tr>
<tr valign=top>
<td width=32%><b>Find</b> or <b>Replace</b></td>
<td width=68%><a href="commdlg3_1n6r.htm"><b>FRHookProc</b></a> </td>
</tr>
<tr valign=top>
<td width=32%><b>Font</b></td>
<td width=68%><a href="commdlg3_5yg3.htm"><b>CFHookProc</b></a> </td>
</tr>
<tr valign=top>
<td width=32%><b>Open</b> or <b>Save As</b> <br>
(Explorer-style)</td>
<td width=68%><a href="commdlg3_61sz.htm"><b>OFNHookProc</b></a> </td>
</tr>
<tr valign=top>
<td width=32%><b>Open</b> or <b>Save As</b><br>
(Old-style)</td>
<td width=68%><a href="commdlg3_3k9x.htm"><b>OFNHookProcOldStyle</b></a> </td>
</tr>
<tr valign=top>
<td width=32%><b>Print</b></td>
<td width=68%><a href="commdlg3_9vkz.htm"><b>PrintHookProc</b></a> </td>
</tr>
<tr valign=top>
<td width=32%><b>Page Setup</b></td>
<td width=68%><a href="commdlg3_23l7.htm"><b>PageSetupHook</b></a> </td>
</tr>
</table><br>
<p>
For the <b>Page Setup</b> dialog box, you can also specify a <a href="commdlg3_05nv.htm"><b>PagePaintHook</b></a> hook procedure. This is a special hook procedure that you can use to customize the appearance of the sample page displayed by the <b>Page Setup </b>dialog box.</p>
<p>
<b>Note</b>&nbsp;&nbsp;The <b>Print Setup </b>dialog box has been superseded by the <b>Page Setup </b>dialog box, which should be used by new applications written for Windows 95 or for Windows NT versions 3.51 or later. However, for compatibility, the <a href="commdlg3_8kpz.htm"><b>PrintDlg</b></a> function continues to support display of the <b>Print Setup </b>dialog box. You can provide a <a href="commdlg3_3l43.htm"><b>SetupHookProc</b></a> hook procedure for the <b>Print Setup </b>dialog box. </p>
<p>&nbsp;</p></body>
</HTML>
