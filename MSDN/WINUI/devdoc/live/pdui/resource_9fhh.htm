<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CopyImage</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_copyimage"></a>CopyImage</h1>
<p>
The <b>CopyImage</b> function creates a new image (icon, cursor, or bitmap) and copies the attributes of the specified image to the new one. If necessary, the function stretches the bits to fit the desired size of the new image.</p>
<pre><code><b>HANDLE CopyImage(
  HANDLE</b><i> hImage</i><b>,</b>  // handle to the image to copy
<b>  UINT</b><i> uType</i><b>,     </b>// type of image to copy
<b>  int</b><i> cxDesired</i><b>,  </b>// desired width of new image
<b>  int</b><i> cyDesired</i><b>,  </b>// desired height of new image
<b>  UINT</b><i> fuFlags    </i>// copy flags
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hinst</i></dt>
<dd>
Handle to an instance of the module that contains the image to be copied. </dd>
<dt>
<i>uType</i></dt>
<dd>
Specifies the type of image to be copied. This parameter can be one of the following values:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=28%>Value</th>
<th align=left width=72%>Meaning</th>
</tr>
<tr valign=top>
<td width=28%>IMAGE_BITMAP</td>
<td width=72%>Copies a bitmap.</td>
</tr>
<tr valign=top>
<td width=28%>IMAGE_CURSOR</td>
<td width=72%>Copies a cursor.</td>
</tr>
<tr valign=top>
<td width=28%>IMAGE_ICON</td>
<td width=72%>Copies an icon.</td>
</tr>
</table><br>

</dd>
<dt>
<i>cxDesired</i></dt>
<dd>
Specifies the desired width, in pixels, of the image. </dd>
<dt>
<i>cyDesired</i></dt>
<dd>
Specifies the desired height, in pixels, of the image. </dd>
<dt>
<i>fuFlags</i></dt>
<dd>
Specifies a combination of the following values:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=44%>Value</th>
<th align=left width=56%>Meaning</th>
</tr>
<tr valign=top>
<td width=44%>LR_COPYDELETEORG</td>
<td width=56%>Deletes the original image after creating the copy.</td>
</tr>
<tr valign=top>
<td width=44%>LR_COPYRETURNORG</td>
<td width=56%>Creates an exact copy of the image, ignoring the <i>cxDesired</i> and <i>cyDesired</i> parameters.</td>
</tr>
<tr valign=top>
<td width=44%>LR_MONOCHROME</td>
<td width=56%>Creates a new monochrome image. </td>
</tr>
<tr valign=top>
<td width=44%>LR_COPYFROMRESOURCE</td>
<td width=56%>Tries to reload an icon or cursor resource from the original resource file rather than simply copying the current image. This is useful for creating a different-sized copy when the resource file contains multiple sizes of the resource. Without this flag, <b>CopyImage</b> stretches the original image to the new size. If this flag is set, <b>CopyImage</b> uses the size in the resource file closest to the desired size.<p>
This will succeed only if <i>hImage</i> was loaded by <b>LoadIcon</b> or <b>LoadCursor</b>, or by <b>LoadImage</b> with the LR_SHARED flag.</p>
</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the handle to the newly created image.</p>
<p>
If the function fails, the return value is NULL. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
When you are finished using the resource, you can release its associated memory by calling one of the functions in the following table. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=25%>Resource</th>
<th align=left width=75%>Release function</th>
</tr>
<tr valign=top>
<td width=25%>Bitmap</td>
<td width=75%><object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_deleteobject">
</object><a href=JavaScript:alink_2.Click()><b>DeleteObject</b></a></td>
</tr>
<tr valign=top>
<td width=25%>Cursor</td>
<td width=75%><a href="cursors_6sdu.htm"><b>DestroyCursor</b></a></td>
</tr>
<tr valign=top>
<td width=25%>Icon</td>
<td width=75%><a href="icons_5kxa.htm"><b>DestroyIcon</b></a></td>
</tr>
</table><br>
<p>
The system automatically deletes the resource when its process terminates, however, calling the appropriate function saves memory and decreases the size of the process's working set. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.5 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winuser.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.</p>
<h4>See Also</h4>
<p>
<a href="resource_0jsj.htm">Resources Overview</a>, <a href="resource_69o3.htm">Resource Functions</a>, <a href="resource_9fhi.htm"><b>LoadImage</b></a></p>
<p>&nbsp;</p></body>
</HTML>
