<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetFileTitle</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_getfiletitle"></a>GetFileTitle</h1>
<p>
The <b>GetFileTitle</b> function returns the name of the file identified by the <i>lpszFile</i> parameter. </p>
<pre><code><b>short GetFileTitle(
  LPCTSTR</b><i> lpszFile</i><b>,  </b>// pointer to full path and filename for file
<b>  LPTSTR</b><i> lpszTitle</i><b>,  </b>// pointer to buffer that receives filename
<b>  WORD</b><i> cbBuf</i>         // length of buffer
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszFile</i></dt>
<dd>
Pointer to the name and location of a file. </dd>
<dt>
<i>lpszTitle</i></dt>
<dd>
Pointer to a buffer into which the function is to copy the name of the file. </dd>
<dt>
<i>cbBuf</i></dt>
<dd>
Specifies the length, in characters, of the buffer pointed to by the <i>lpszTitle</i> parameter. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is zero. </p>
<p>
If the filename is invalid, the return value is a negative number. </p>
<p>
If the buffer pointed to by the <i>lpszTitle</i> parameter is too small, the return value is a positive integer that specifies the required buffer size, in bytes (ANSI version) or 16-bit characters (Unicode version). The required buffer size includes the terminating null character. </p>
<h4>Remarks</h4>
<p>
The <b>GetFileTitle</b> function returns an error value if the buffer pointed to by the <i>lpszFile</i> parameter contains any of the following elements: 
<ul>
<li>
An empty string </li>
<li>
A string containing a wildcard (*), opening bracket ([), or closing bracket (]) </li>
<li>
A string that ends with a colon (:), slash mark (/), or backslash (\) </li>
<li>
A string whose length exceeded the length of the buffer </li>
<li>
An invalid character (for example, a space or an unprintable character)</li>
</ul>
<p>
To get the buffer size needed for the name of a file, call the function with <i>lpszTitle</i> set to NULL and <i>cbBuf</i> set to zero. The function will return the required size. </p>
<p>
<b>GetFileTitle</b> returns the string that the system would use to display the filename to the user. The display name includes an extension only if that is the user's preference for displaying filenames. This means that the returned string may not accurately identify the file if it is used in calls to file system functions.</p>
<p>
If the <i>lpszTitle</i> buffer is too small, <b>GetFileTitle</b> returns the size required to hold the display name. There is no guaranteed connection between the required size and the characters originally specified in the <i>lpszFile</i> buffer. In porting 16-bit Windows-based applications to Win32, you will need to update any code that relies on such behavior in previous versions of the system. The most common case is code that deliberately calls <b>GetFileTitle</b> with <i>lpszTitle</i> set to NULL and <i>cbBuf</i> set to zero, and then uses the return value as an index into the <i>lpszFile</i> string. This technique is no longer supported. You can usually achieve similar results (and superior performance) with run-time library functions such as <b>strrchr</b>, <b>wcsrchr</b>, and <b>_mbsrchr</b>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in commdlg.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use comdlg32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="commdlg3_04ft.htm">Common Dialog Box Library Overview</a>, <a href="commdlg3_8zjn.htm">Common Dialog Box Functions</a>, <a href="commdlg3_3cbp.htm"><b>GetOpenFileName</b></a>, <a href="commdlg3_7zqd.htm"><b>GetSaveFileName</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
