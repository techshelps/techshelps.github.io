<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CHARFORMAT2</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_charformat2_str"></a>CHARFORMAT2</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>CHARFORMAT2 </b>structure contains information about character formatting in a rich edit control. <b>CHARFORMAT2</b> is a rich edit 2.0 extension of the <a href="richedit_4v3m.htm"><b>CHARFORMAT</b></a> structure. Rich edit 2.0 allows you to use either structure with the <a href="richedit_7dx0.htm">EM_GETCHARFORMAT</a> and <a href="richedit_256c.htm">EM_SETCHARFORMAT</a> messages. </p>
<pre><code>typedef struct _charformat2 {
    UINT        cbSize;
    _WPAD       _wPad1;
    DWORD       dwMask;
    DWORD       dwEffects;
    LONG        yHeight;
    LONG        yOffset;
    COLORREF    crTextColor;
    BYTE        bCharSet;
    BYTE        bPitchAndFamily;
    WCHAR       szFaceName[LF_FACESIZE];
    _WPAD       _wPad2;
    WORD        wWeight;
    SHORT       sSpacing;
    COLORREF    crBackColor;
    LCID        lcid;
    DWORD       dwReserved;
    SHORT       sStyle;
    WORD        wKerning;
    BYTE        bUnderlineType;
    BYTE        bAnimation;
    BYTE        bRevAuthor;
    BYTE        bReserved1;
} CHARFORMAT2;
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>cbSize</b></dt>
<dd>
Specifies the size, in bytes, of this structure. Before passing this structure to a rich edit control, set <b>cbSize</b> to the size of the <a href="richedit_4v3m.htm"><b>CHARFORMAT</b></a> or <b>CHARFORMAT2</b> structure. If <b>cbSize</b> equals the size of a <b>CHARFORMAT</b> structure, the control uses only the <b>CHARFORMAT</b> members.</dd>
<dt>
<b>dwMask</b></dt>
<dd>
Specifies the parts of the <b>CHARFORMAT2</b> structure that contain valid information. The <b>dwMask</b> member can be a combination of the values from two sets of bit flags. One set indicates the structure members that are valid. Another set indicates the valid attributes in the <b>dwEffects</b> member. 
<p>
Set the following values to indicate the valid structure members.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Value</th>
<th align=left width=64%>Meaning</th>
</tr>
<tr valign=top>
<td width=36%>CFM_ANIMATION</td>
<td width=64%>The <b>bAnimation</b> member is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_BACKCOLOR</td>
<td width=64%>The <b>crBackColor</b> member is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_CHARSET</td>
<td width=64%>The <b>bCharSet</b> member is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_COLOR</td>
<td width=64%>The <b>crTextColor</b> member is valid unless the CFE_AUTOCOLOR flag is set in the <b>dwEffects</b> member.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_FACE</td>
<td width=64%>The <b>szFaceName</b> member is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_KERNING</td>
<td width=64%>The <b>wKerning</b> member is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_LCID</td>
<td width=64%>The <b>lcid</b> member is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_OFFSET</td>
<td width=64%>The <b>yOffset</b> member is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_REVAUTHOR</td>
<td width=64%>The <b>bRevAuthor</b> member is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_SIZE</td>
<td width=64%>The <b>yHeight</b> member is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_SPACING</td>
<td width=64%>The <b>sSpacing</b> member is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_STYLE</td>
<td width=64%>The <b>sStyle</b> member is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_UNDERLINETYPE</td>
<td width=64%>The <b>bUnderlineType</b> member is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_WEIGHT</td>
<td width=64%>The <b>wWeight</b> member is valid.</td>
</tr>
</table><br>


<p>
Set the following values to indicate the valid attributes of the <b>dwEffects</b> member:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Value</th>
<th align=left width=64%>Meaning</th>
</tr>
<tr valign=top>
<td width=36%>CFM_ALLCAPS</td>
<td width=64%>The CFE_ALLCAPS value is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_BOLD</td>
<td width=64%>The CFE_BOLD value is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_COLOR</td>
<td width=64%>The CFE_AUTOCOLOR value is valid, or the <b>crTextColor</b> member is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_DISABLED</td>
<td width=64%>The CFE_DISABLED value is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_EMBOSS</td>
<td width=64%>The CFE_EMBOSS value is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_HIDDEN</td>
<td width=64%>The CFE_HIDDEN value is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_IMPRINT</td>
<td width=64%>The CFE_IMPRINT value is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_ITALIC</td>
<td width=64%>The CFE_ITALIC value is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_LINK</td>
<td width=64%>The CFE_LINK value is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_OUTLINE</td>
<td width=64%>The CFE_OUTLINE value is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_PROTECTED</td>
<td width=64%>The CFE_PROTECTED value is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_REVISED</td>
<td width=64%>The CFE_REVISION value is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_SHADOW</td>
<td width=64%>The CFE_SHADOW value is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_SMALLCAPS</td>
<td width=64%>The CFE_SMALLCAPS value is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_STRIKEOUT</td>
<td width=64%>The CFE_STRIKEOUT value is valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_SUBSCRIPT</td>
<td width=64%>The CFE_SUBSCRIPT and CFE_SUPERSCRIPT values are valid.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_SUPERSCRIPT</td>
<td width=64%>Same as CFM_SUBSCRIPT.</td>
</tr>
<tr valign=top>
<td width=36%>CFM_UNDERLINE.</td>
<td width=64%>The CFE_UNDERLINE value is valid.</td>
</tr>
</table><br>

</dd>
<dt>
<b>dwEffects</b></dt>
<dd>
A set of bit flags that specify character effects. Some of the flags are included only for compatibility with Microsoft Text Object Model (TOM) interfaces; the rich edit control stores the value but does not use it to display text. 
<p>
This member can be a combination of the following values.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=33%>Value</th>
<th align=left width=67%>Meaning</th>
</tr>
<tr valign=top>
<td width=33%>CFE_ALLCAPS</td>
<td width=67%>Characters are all capital letters. Does not affect the way the control displays the text. </td>
</tr>
<tr valign=top>
<td width=33%>CFE_AUTOCOLOR</td>
<td width=67%>The text color is the return value of <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getsyscolor">
</object><a href=JavaScript:alink_1.Click()><b>GetSysColor</b></a> (COLOR_WINDOWTEXT). If this flag is set, the <b>crTextColor</b> member is ignored.</td>
</tr>
<tr valign=top>
<td width=33%>CFE_BOLD</td>
<td width=67%>Characters are bold.</td>
</tr>
<tr valign=top>
<td width=33%>CFE_DELETED</td>
<td width=67%>Marks the characters as deleted.</td>
</tr>
<tr valign=top>
<td width=33%>CFE_EMBOSS</td>
<td width=67%>Characters are embossed. Does not affect how the control displays the text. </td>
</tr>
<tr valign=top>
<td width=33%>CFE_HIDDEN</td>
<td width=67%>Characters are not displayed. Does not affect how the control displays the text. </td>
</tr>
<tr valign=top>
<td width=33%>CFE_IMPRINT</td>
<td width=67%>Characters are displayed as imprinted characters. Does not affect how the control displays the text. </td>
</tr>
<tr valign=top>
<td width=33%>CFE_ITALIC</td>
<td width=67%>Characters are italic.</td>
</tr>
<tr valign=top>
<td width=33%>CFE_LINK</td>
<td width=67%>A rich edit control can send <a href="richedit_3kob.htm">EN_LINK</a> notification messages when it receives mouse messages while the mouse pointer is over text with the CFE_LINK effect.</td>
</tr>
<tr valign=top>
<td width=33%>CFE_OUTLINE</td>
<td width=67%>Characters are displayed as outlined characters. Does not affect how the control displays the text. </td>
</tr>
<tr valign=top>
<td width=33%>CFE_PROTECTED</td>
<td width=67%>Characters are protected; an attempt to modify them will cause an <a href="richedit_7k4k.htm">EN_PROTECTED</a> notification message.</td>
</tr>
<tr valign=top>
<td width=33%>CFE_REVISION</td>
<td width=67%>Marks the characters as revised.</td>
</tr>
<tr valign=top>
<td width=33%>CFE_SHADOW</td>
<td width=67%>Characters are displayed as shadowed characters. Does not affect how the control displays the text. </td>
</tr>
<tr valign=top>
<td width=33%>CFE_SMALLCAPS</td>
<td width=67%>Characters are in small capital letters. Does not affect how the control displays the text. </td>
</tr>
<tr valign=top>
<td width=33%>CFE_STRIKEOUT</td>
<td width=67%>Characters are struck out.</td>
</tr>
<tr valign=top>
<td width=33%>CFE_SUBSCRIPT</td>
<td width=67%>Characters are subscript. The CFE_SUPERSCRIPT and CFE_SUBSCRIPT values are mutually exclusive. For both values, the control automatically calculates an offset and a smaller font size. Alternatively, you can use the <b>yHeight</b> and <b>yOffset</b> members to explicitly specify font size and offset for subscript and superscript characters.</td>
</tr>
<tr valign=top>
<td width=33%>CFE_SUPERSCRIPT</td>
<td width=67%>Characters are superscript. </td>
</tr>
<tr valign=top>
<td width=33%>CFE_UNDERLINE</td>
<td width=67%>Characters are underlined.</td>
</tr>
</table><br>

</dd>
<dt>
<b>yHeight</b></dt>
<dd>
Specifies the character height, in twips. A twip is 1/1440 of an inch, or 1/20 of a printer's point. To use this member, set the CFM_SIZE flag in the <b>dwMask</b> member.</dd>
<dt>
<b>yOffset</b></dt>
<dd>
Specifies the character offset, in twips, from the baseline. If this member is positive, the character is a superscript; if it is negative, the character is a subscript. To use this member, set the CFM_OFFSET flag in the <b>dwMask</b> member.</dd>
<dt>
<b>crTextColor</b></dt>
<dd>
Specifies the text color. To use this member, set the CFM_COLOR flag in the <b>dwMask</b> member. This member is ignored if the CFE_AUTOCOLOR character effect is specified.</dd>
<dt>
<b>bCharSet</b></dt>
<dd>
Specifies the character set value, which can be one of the values specified for the <b>lfCharSet </b>member of the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_logfont_str">
</object><a href=JavaScript:alink_2.Click()><b>LOGFONT</b></a> structure. To use this member, set the CFM_CHARSET flag in the <b>dwMask</b> member. </dd>
<dt>
<b>bPitchAndFamily</b></dt>
<dd>
Specifies the font family and pitch. This member is the same as the <b>lfPitchAndFamily</b> member of the <b>LOGFONT </b>structure.</dd>
<dt>
<b>szFaceName</b></dt>
<dd>
A null-terminated character array specifying the font face name. To use this member, set the CFM_FACE flag in the <b>dwMask</b> member. </dd>
<dt>
<b>wWeight</b></dt>
<dd>
Specifies the font weight. This member is the same as the <b>lfWeight</b> member of the <b>LOGFONT </b>structure. To use this member, set the CFM_WEIGHT flag in the <b>dwMask</b> member. </dd>
<dt>
<b>sSpacing</b></dt>
<dd>
Specifies the horizontal space, in twips, between letters. This value has no effect on the text displayed by a rich edit control; it is included for compatibility with Microsoft Text Object Model (TOM) interfaces.  To use this member, set the CFM_SPACING flag in the <b>dwMask</b> member. </dd>
<dt>
<b>crBackColor</b></dt>
<dd>
Specifies the background color. To use this member, set the CFM_BACKCOLOR flag in the <b>dwMask</b> member. </dd>
<dt>
<b>lcid</b></dt>
<dd>
Specifies a 32-bit locale identifier that contains a language identifier in the lower word, and a sorting identifier and reserved value in the upper word. This member has no effect on the text displayed by a rich edit control, but spelling and grammar checkers can use it to deal with language-dependent problems. You can use the <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_makelcid">
</object><a href=JavaScript:alink_3.Click()><b>MAKELCID</b></a> macro to create an LCID value. To use this member, set the CFM_LCID flag in the <b>dwMask</b> member. </dd>
<dt>
<b>dwReserved</b></dt>
<dd>
Reserved; must be zero.</dd>
<dt>
<b>sStyle</b></dt>
<dd>
Specifies a style handle. This value has no effect on the text displayed by a rich edit control; it is included for compatibility with Microsoft Text Object Model (TOM) interfaces. To use this member, set the CFM_STYLE flag in the <b>dwMask</b> member. </dd>
<dt>
<b>wKerning</b></dt>
<dd>
Specifies the twip size above which to kern the character. This value has no effect on the text displayed by a rich edit control; it is included for compatibility with TOM interfaces. To use this member, set the CFM_KERNING flag in the <b>dwMask</b> member. </dd>
<dt>
<b>bUnderlineType</b></dt>
<dd>
Specifies the underline type. To use this member, set the CFM_UNDERLINETYPE flag in the <b>dwMask</b> member. This member can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=41%>Value</th>
<th align=left width=59%>Meaning</th>
</tr>
<tr valign=top>
<td width=41%>CFU_CF1UNDERLINE</td>
<td width=59%>Map <b>CHARFORMAT</b>'s bit underline to <b>CHARFORMAT2</b>.  </td>
</tr>
<tr valign=top>
<td width=41%>CFU_INVERT</td>
<td width=59%>For IME composition fake a selection.  </td>
</tr>
<tr valign=top>
<td width=41%>CFU_UNDERLINE</td>
<td width=59%>Solid underline.</td>
</tr>
<tr valign=top>
<td width=41%>CFU_UNDERLINEDOTTED</td>
<td width=59%>Dotted underlined text. The rich edit control displays the text with a solid underline.</td>
</tr>
<tr valign=top>
<td width=41%>CFU_UNDERLINEDOUBLE</td>
<td width=59%>Double-underlined text. The rich edit control displays the text with a solid underline.</td>
</tr>
<tr valign=top>
<td width=41%>CFU_UNDERLINENONE</td>
<td width=59%>No underline. This is the default.</td>
</tr>
<tr valign=top>
<td width=41%>CFU_UNDERLINEWORD</td>
<td width=59%>Underline words only. The rich edit control displays the text with a solid underline.</td>
</tr>
</table><br>

</dd>
<dt>
<b>bAnimation</b></dt>
<dd>
Specifies the text animation. This value has no effect on the text displayed by a rich edit control; it is included for compatibility with TOM interfaces. To use this member, set the CFM_ANIMATION flag in the <b>dwMask</b> member. </dd>
<dt>
<b>bRevAuthor</b></dt>
<dd>
Specifies an index that identifies the author making a revision. The rich edit control uses different text colors for each different author index. To use this member, set the CFM_REVAUTHOR flag in the <b>dwMask</b> member. </dd>
<dt>
<b>bReserved1</b></dt>
<dd>
Reserved; must be zero.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in richedit.h.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined as Unicode and ANSI structures.</p>
<h4>See Also</h4>
<p>
<a href="richedit_5a7n.htm">Rich Edit Controls Overview</a>, <a href="richedit_3tmb.htm">Rich Edit Structures</a>, <a href="richedit_4v3m.htm"><b>CHARFORMAT</b></a>, <a href="richedit_7dx0.htm">EM_GETCHARFORMAT</a>, <a href="richedit_256c.htm">EM_SETCHARFORMAT</a>, <a href="richedit_7k4k.htm">EN_PROTECTED</a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getsyscolor">
</object><a href=JavaScript:alink_4.Click()><b>GetSysColor</b></a>, <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_logfont_str">
</object><a href=JavaScript:alink_5.Click()><b>LOGFONT</b></a>, <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_makelcid">
</object><a href=JavaScript:alink_6.Click()><b>MAKELCID</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
