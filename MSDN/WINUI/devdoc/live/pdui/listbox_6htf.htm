<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Owner-Drawn List Boxes</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_owner_drawn_list_boxes"></a>Owner-Drawn List Boxes</h2>
<p>
An application can create an <i>owner-drawn</i> list box to take responsibility for painting list items. The parent window or dialog box of an owner-drawn list box (its <i>owner</i>) receives <a href="combobox_3sx9.htm">WM_DRAWITEM</a> messages when a portion of the list box needs to be painted. An owner-drawn list box can list information other than, or in addition to, text strings. </p>
<p>
The owner of an owner-drawn list box must process the WM_DRAWITEM message. This message is sent whenever a portion of the list box must be redrawn. The owner may need to process other messages, depending on the styles specified for the list box. </p>
<p>
An application can create an owner-drawn list box by specifying the LBS_OWNERDRAWFIXED or LBS_OWNERDRAWVARIABLE style. If all list items in the list box are the same height, such as strings or icons, an application can use the LBS_OWNERDRAWFIXED style. If list items are of varying height, bitmaps of different size, for example, an application can use the LBS_OWNERDRAWVARIABLE style. </p>
<p>
The owner of an owner-drawn list box can process a <a href="combobox_85d9.htm">WM_MEASUREITEM</a> message to specify the dimensions of list items. If the application creates the list box by using the LBS_OWNERDRAWFIXED style, the system sends the WM_MEASUREITEM message only once. The dimensions specified by the owner are used for all list items. If the LBS_OWNERDRAWVARIABLE style is used, the system sends a WM_MEASUREITEM message for each list item added to the list box. The owner can determine or set the height of a list item at any time by using the L<a href="listbox_9q7o.htm">B_GETITEMHEIGHT</a> and L<a href="listbox_4hh0.htm">B_SETITEMHEIGHT</a> messages, respectively. </p>
<p>
If the information displayed in an owner-drawn list box includes text, an application can keep track of the text for each list item by specifying the LBS_HASSTRINGS style. List boxes with the LBS_SORT style are sorted based on this text. If a list box is sorted, but is not of the LBS_HASSTRINGS style, the owner must process the <a href="combobox_6vxp.htm">WM_COMPAREITEM</a> message. </p>
<p>
In an owner-drawn list box, the owner must keep track of list items containing information other than or in addition to text. One convenient way to do this is to save the handle to the information as item data using the <a href="listbox_1bdt.htm">LB_SETITEMDATA</a> message. To free data objects associated with items in a list box, the owner can process the <a href="listbox_5dbh.htm">WM_DELETEITEM</a> message. </p>
<p>
For an example of an owner-drawn list box, see <a href="listbox_4a0o.htm">Creating an Owner-Drawn List Box</a>. </p>
<p>&nbsp;</p></body>
</HTML>
