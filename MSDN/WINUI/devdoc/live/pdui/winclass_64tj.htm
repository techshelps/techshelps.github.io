<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetWindowLong</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_setwindowlong"></a>SetWindowLong</h1>
<p>
The <b>SetWindowLong</b> function changes an attribute of the specified window. The function also sets a 32-bit (long) value at the specified offset into the extra window memory of a window. </p>
<pre><code><b>LONG SetWindowLong(
  HWND</b><i> hWnd</i><b>,       </b>// handle of window
<b>  int</b><i> nIndex</i><b>,      </b>// offset of value to set
<b>  LONG</b><i> dwNewLong</i>   // new value
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hWnd</i></dt>
<dd>
Handle to the window and, indirectly, the class to which the window belongs. </dd>
<dt>
<i>nIndex</i></dt>
<dd>
Specifies the zero-based offset to the value to be set. Valid values are in the range zero through the number of bytes of extra window memory, minus 4; for example, if you specified 12 or more bytes of extra memory, a value of 8 would be an index to the third 32-bit integer. To set any other value, specify one of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Value</th>
<th align=left width=68%>Action</th>
</tr>
<tr valign=top>
<td width=32%>GWL_EXSTYLE</td>
<td width=68%>Sets a new extended window style.</td>
</tr>
<tr valign=top>
<td width=32%>GWL_STYLE</td>
<td width=68%>Sets a new window style.</td>
</tr>
<tr valign=top>
<td width=32%>GWL_WNDPROC</td>
<td width=68%>Sets a new address for the window procedure.</td>
</tr>
<tr valign=top>
<td width=32%>GWL_HINSTANCE</td>
<td width=68%>Sets a new application instance handle.</td>
</tr>
<tr valign=top>
<td width=32%>GWL_ID</td>
<td width=68%>Sets a new identifier of the window.</td>
</tr>
<tr valign=top>
<td width=32%>GWL_USERDATA</td>
<td width=68%>Sets the 32-bit value associated with the window. Each window has a corresponding 32-bit value intended for use by the application that created the window.</td>
</tr>
</table><br>


<p>
The following values are also available when the <i>hWnd</i> parameter identifies a dialog box: 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=33%>Value</th>
<th align=left width=67%>Action</th>
</tr>
<tr valign=top>
<td width=33%>DWL_DLGPROC</td>
<td width=67%>Sets the new address of the dialog box procedure.</td>
</tr>
<tr valign=top>
<td width=33%>DWL_MSGRESULT</td>
<td width=67%>Sets the return value of a message processed in the dialog box procedure.</td>
</tr>
<tr valign=top>
<td width=33%>DWL_USER</td>
<td width=67%>Sets new extra information that is private to the application, such as handles or pointers.</td>
</tr>
</table><br>

</dd>
<dt>
<i>dwNewLong</i></dt>
<dd>
Specifies the replacement value. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the previous value of the specified 32-bit integer.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. </p>
<p>
If the previous value of the specified 32-bit integer is zero, and the function succeeds, the return value is zero, but the function does not clear the last error information. This makes it difficult to determine success or failure. To deal with this, you should clear the last error information by calling <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_setlasterror">
</object><a href=JavaScript:alink_2.Click()><b>SetLastError</b></a>(0) before calling <b>SetWindowLong</b>. Then, function failure will be indicated by a return value of zero and a <b>GetLastError</b> result that is nonzero.</p>
<h4>Remarks</h4>
<p>
The <b>SetWindowLong</b> function fails if the window specified by the <i>hWnd</i> parameter does not belong to the same process as the calling thread.</p>
<p>
Certain window data is cached, so changes you make using <b>SetWindowLong</b> will not take effect until you call the <a href="windows_2blf.htm"><b>SetWindowPos</b></a> function.</p>
<p>
If you use <b>SetWindowLong</b> with the GWL_WNDPROC index to replace the window procedure, the window procedure must conform to the guidelines specified in the description of the <a href="winprocs_53xf.htm"><b>WindowProc</b></a> callback function. </p>
<p>
If you use <b>SetWindowLong</b> with the DWL_MSGRESULT index to set the return value for a message processed by a dialog procedure, you should return TRUE directly afterwards. Otherwise, if you call any function that results in your dialog procedure receiving a window message, the nested window message could overwrite the return value you set using DWL_MSGRESULT. </p>
<p>
Calling <b>SetWindowLong</b> with the GWL_WNDPROC index creates a subclass of the window class used to create the window. An application can subclass a system class, but should not subclass a window class created by another process. The <b>SetWindowLong</b> function creates the window subclass by changing the window procedure associated with a particular window class, causing the system to call the new window procedure instead of the previous one. An application must pass any messages not processed by the new window procedure to the previous window procedure by calling <a href="winprocs_9dlv.htm"><b>CallWindowProc</b></a>. This allows the application to create a chain of window procedures. </p>
<p>
Reserve extra window memory by specifying a nonzero value in the <b>cbWndExtra</b> member of the <a href="winclass_450y.htm"><b>WNDCLASSEX</b></a> structure used with the <b>RegisterClassEx</b> function. </p>
<p>
You must not call <b>SetWindowLong</b> with the GWL_HWNDPARENT index to change the parent of a child window. Instead, use the <b>SetParent</b> function. </p>
<p>
<b>Windows CE:</b> The <i>nIndex</i> parameter must be a multiple of 4 bytes. </p>
<p>
Unaligned access is not supported. </p>
<p>
The following <i>nIndex</i> parameter values are not supported: </p>
<p class=indent1>
GWL_HINSTANCE </p>
<p class=indent1>
GWL_HWNDPARENT </p>
<p class=indent1>
GWL_USERDATA </p>
<p>
Windows CE versions 2.0 and later support the DWL_DLGPROC value in the <i>nIndex</i> parameter, but Windows CE 1.0 does not.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winuser.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="winclass_1ooj.htm">Window Classes Overview</a>, <a href="winclass_7ugj.htm">Window Class Functions</a>, <a href="winprocs_9dlv.htm"><b>CallWindowProc</b></a>, <a href="winclass_1dk7.htm"><b>GetWindowLong</b></a>, <a href="winclass_0wc8.htm"><b>RegisterClassEx</b></a>, <a href="windows_1otw.htm"><b>SetParent</b></a>, <a href="winprocs_53xf.htm"><b>WindowProc</b></a>, <a href="winclass_450y.htm"><b>WNDCLASSEX</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
