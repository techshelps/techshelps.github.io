<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Current Selection</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_current_selection"></a>Current Selection</h3>
<p>
The <i>current selection</i> is a list item the user has selected; the selected text appears in the selection field of the combo box. However, in the case of a simple combo box or a drop down combo box, the current selection is only one form of possible user input in a combo box. The user can also type text in the selection field. </p>
<p>
The current selection is identified by the zero-based index of the selected list item. An application can set and retrieve it at any time. The parent window or dialog box procedure receives notifications when user changes the current selection for a combo box. The parent window or dialog box is not notified when the application changes the selection. </p>
<p>
When a combo box is created, there is no current selection. This is also true for a simple or drop-down combo box, if the user has edited the contents of the selection field. To set the current selection, an application sends the <a href="combobox_5q24.htm">CB_SETCURSEL</a> message to the combo box. An application can also use the <a href="combobox_1euf.htm">CB_SELECTSTRING</a> message to set the current selection to a list item whose string begins with a specified string. To determine the current selection, an application sends the <a href="combobox_2g4s.htm">CB_GETCURSEL</a> message to the combo box. If there is no current selection, this message returns CB_ERR. </p>
<p>
When the user changes the current selection in a combo box, the parent window or dialog-box procedure receives a <a href="editcon_8wh0.htm">WM_COMMAND</a> message with the notification message <a href="combobox_2zol.htm">CBN_SELCHANGE</a> in the high-order word of the <i>wParam</i> parameter. This notification message is not sent when the current selection is set using the CB_SETCURSEL message. </p>
<p>
A drop-down combo box or drop-down list box sends the <a href="combobox_9zu8.htm">CBN_CLOSEUP</a> notification to the parent window or dialog-box procedure when the drop-down list closes. If the user changed the current selection, the combo box also sends the CBN_SELCHANGE notification when the drop-down list closes. To execute a specific process each time the user selects a list item, you can handle either the CBN_SELCHANGE or CBN_CLOSEUP notification message. Typically, you would wait for the CBN_CLOSEUP notification before processing a change in the current selection. This can be particularly important if a significant amount of processing is required. </p>
<p>
An application could also process the notification messages <a href="combobox_79uz.htm">CBN_SELENDOK</a> and <a href="combobox_61t8.htm">CBN_SELENDCANCEL</a>. The system sends CBN_SELENDOK when the user selects a list item, or selects an item and then closes the list. This indicates the user has finished, and the selection should be processed. CBN_SELENDCANCEL is sent when the user selects an item, but then selects another control, presses the escape key while the drop-down list is open, or closes the dialog box. This indicates the user's selection should be ignored. In a simple combo box, CBN_SELENDOK is sent before every CBN_SELCHANGE message. If the WS_EX_NOPARENTNOTIFY window style is specified for the combo box, the system does not send CBN_SELENDOK and CBN_SELENDCANCEL messages. </p>
<p>
In a simple combo box, the system sends the <a href="combobox_4z8r.htm">CBN_DBLCLK</a> notification message when the user double-clicks a list item. In a drop-down combo box or drop-down list, a single click hides the list so it is not possible to double-click an item. </p>
<p>&nbsp;</p></body>
</HTML>
