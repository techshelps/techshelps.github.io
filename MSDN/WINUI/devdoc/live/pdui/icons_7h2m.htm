<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ExtractIcon</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_extracticon"></a>ExtractIcon</h1>
<p>
The <b>ExtractIcon</b> function retrieves a handle to an icon from the specified executable file, dynamic-link library (DLL), or icon file. </p>
<p>
To retrieve an array of handles to large or small icons, use the <a href="icons_4m60.htm"><b>ExtractIconEx</b></a> function. </p>
<pre><code><b>HICON ExtractIcon(
  HINSTANCE</b><i> hInst</i><b>,          </b>// instance handle
<b>  LPCTSTR</b><i> lpszExeFileName</i><b>,  </b>// filename of file with icon
<b>  UINT</b><i> nIconIndex</i>           // index of icon to extract
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hInst</i></dt>
<dd>
Handle to the instance of the application calling the function. </dd>
<dt>
<i>lpszExeFileName</i></dt>
<dd>
Pointer to a null-terminated string specifying the name of an executable file, DLL, or icon file. </dd>
<dt>
<i>nIconIndex</i></dt>
<dd>
Specifies the zero-based index of the icon to retrieve. For example, if this value is 0, the function returns a handle to the first icon in the specified file. 
<p>
If this value is –1, the function returns the total number of icons in the specified file. If the file is an executable file or DLL, the return value is the number of RT_GROUP_ICON resources. If the file is an .ICO file, the return value is 1. 

<p>
<b>Windows 95, Windows NT 4.0, and later:</b> If this value is a negative number not equal to -1, the function returns a handle to the icon in the specified file whose resource identifier is equal to the absolute value of <i>nIconIndex</i>. For example, use -3 to extract the icon whose resource identifier is 3. To extract the icon whose resource identifier is 1, use the <a href="icons_4m60.htm"><b>ExtractIconEx</b></a> function. 

</dd>
</dl>
<h4>Return Values</h4>
<p>
The return value is a handle to an icon. If the file specified was not an executable file, DLL, or icon file, the return is 1. If no icons were found in the file, the return value is NULL. </p>
<h4>Remarks</h4>
<p>
You must destroy the icon handle returned by <b>ExtractIcon</b> by calling the <a href="icons_5kxa.htm"><b>DestroyIcon</b></a> function. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in shellapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use shell32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="icons_1xpv.htm">Icons Overview</a>, <a href="icons_7zlf.htm">Icon Functions</a>,  <a href="icons_5kxa.htm"><b>DestroyIcon</b></a>, <a href="icons_4m60.htm"><b>ExtractIconEx</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
