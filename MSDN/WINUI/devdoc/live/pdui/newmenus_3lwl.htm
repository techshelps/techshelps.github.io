<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Owner-Drawn Menus and the WM_MENUCHAR Message</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_owner_drawn_menus_and_the_wm_menuchar_message"></a>Owner-Drawn Menus and the WM_MENUCHAR Message</h3>
<p>
Menus other than owner-drawn menus can specify a menu mnemonic by inserting an underscore next to a character in the menu string. This allows the user to select the menu by typing <small>alt</small> and the menu mnemonic character. In owner-drawn menus, however, you cannot specify a menu mnemonic in this manner. Instead, your application must process the <a href="keybacel_4aeq.htm">WM_MENUCHAR</a> message to provide owner-drawn menus with menu mnemonics. </p>
<p>
The WM_MENUCHAR message is sent when the user types a menu mnemonic that does not match any of the predefined mnemonics of the current menu. The value contained in <i>wParam</i> specifies the ASCII character that corresponds to the key the user pressed with the <small>alt</small> key. The low-order word of <i>lParam</i> specifies the type of the selected menu and can be on of the following values: 
<ul>
<li>
MF_POPUP if the current menu is a submenu.</li>
<li>
MF_SYSMENU if the menu is the system menu. </li>
</ul>
<p>
The high-order word of <i>lParam</i> contains the menu handle to the current menu. The window with the owner-drawn menus can process WM_MENUCHAR as follows: </p>
<pre><code>case WM_MENUCHAR:
      nIndex = Determine index of menu item to be selected from
               character that was typed and handle to the current
               menu.
      return MAKELRESULT(nIndex, 2);
 </code></pre>
<p>
The two in the high-order word of the return value informs the system that the low-order word of the return value contains the zero-based index of the menu item to be selected. </p>
<p>
The following constants (defined starting with Windows 95 and Windows NT version 4.0) correspond to the possible return values from the WM_MENUCHAR message: </p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=31%>Constant</th>
<th align=left width=14%>Value</th>
<th align=left width=55%>Meaning</th>
</tr>
<tr valign=top>
<td width=31%>MNC_IGNORE</td>
<td width=14%>0</td>
<td width=55%>The system should discard the character the user pressed and create a short beep on the system speaker.</td>
</tr>
<tr valign=top>
<td width=31%>MNC_CLOSE</td>
<td width=14%>1</td>
<td width=55%>The system should close the active menu.</td>
</tr>
<tr valign=top>
<td width=31%>MNC_EXECUTE</td>
<td width=14%>2</td>
<td width=55%>The system should choose the item specified in the low-order word of the return value. The owner window receives a <a href="editcon_8wh0.htm">WM_COMMAND</a> message.</td>
</tr>
<tr valign=top>
<td width=31%>MNC_SELECT</td>
<td width=14%>3</td>
<td width=55%>The system should select the item specified in the low-order word of the return value.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
