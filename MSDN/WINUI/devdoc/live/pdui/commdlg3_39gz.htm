<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Explorer-Style Hook Procedures</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_explorer_style_hook_procedures"></a>Explorer-Style Hook Procedures</h3>
<p>
You can customize an Explorer-style <b>Open</b> or <b>Save As</b> dialog box by providing a hook procedure, a custom template, or both. If you provide a hook procedure for an Explorer-style dialog box, the system creates a dialog box that is a child of the default dialog box. The hook procedure acts as the dialog procedure for the child dialog box. This child dialog box is based on the custom template, or on a default template if none is provided. For more information, see <a href="commdlg3_1yr7.htm">Explorer-Style Custom Templates</a>.</p>
<p>
To enable a hook procedure for an Explorer-style <b>Open</b> or <b>Save As</b> dialog box, use the <a href="commdlg3_1hma.htm"><b>OPENFILENAME</b></a> structure when you create the dialog box. Set the OFN_ENABLEHOOK and OFN_EXPLORER flags in the <b>Flags</b> member and specify the address of an <b>OFNHookProc</b> hook procedure in the <b>lpfnHook</b> member. If you provide a hook procedure and omit the OFN_EXPLORER flag, you must use an <b>OFNHookProcOldStyle</b> hook procedure and you will get the old-style user-interface. For more information, see <a href="commdlg3_3hyr.htm">Customizing Old-Style Dialog Boxes</a>. </p>
<p>
An Explorer-style hook procedure receives a variety of messages while the dialog box is open. These include the following:
<ul>
<li>
The <a href="dlgboxes_4n1j.htm">WM_INITDIALOG</a> message and other standard dialog box messages such as the <a href="dlgboxes_0j1j.htm">WM_CTLCOLORDLG</a> control color message.</li>
<li>
A set of <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_wm_notify">
</object><a href=JavaScript:alink_1.Click()>WM_NOTIFY</a> notification messages indicating actions taken by the user or other dialog box events.</li>
<li>
Messages for any additional controls that you defined by specifying a child dialog template.</li>
</ul>
<p>
In addition, there is a set of messages that you can send to an Explorer-style dialog box to get information or to control the behavior and appearance of the dialog box.</p>
<p>
If you provide a hook procedure for an Explorer-style dialog box, the default dialog box procedure creates a child dialog box when the default dialog procedure is processing its <a href="dlgboxes_4n1j.htm">WM_INITDIALOG</a> message. The hook procedure acts as the dialog procedure for the child dialog box. At this time, the hook procedure receives its own WM_INITDIALOG message with the <i>lParam</i> parameter set to the address of the <a href="commdlg3_1hma.htm"><b>OPENFILENAME</b></a> structure used to initialize the dialog box. After the child dialog finishes processing its own WM_INITDIALOG message, the default dialog procedure moves the standard controls, if necessary, to make room for any additional controls of the child dialog box. The default dialog procedure then sends the <a href="commdlg3_3ihx.htm">CDN_INITDONE</a> notification message to the hook procedure. </p>
<p>
The hook procedure receives <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_wm_notify">
</object><a href=JavaScript:alink_2.Click()>WM_NOTIFY</a> notification messages indicating actions taken by the user in the dialog box. You can use some of these messages to control the behavior of the dialog box. For example, the hook procedure receives the CDN_FILEOK message when the user chooses a filename and clicks the <b>OK</b> button. In response to this message, the hook procedure can use the <a href="winclass_64tj.htm"><b>SetWindowLong</b></a> function to reject the selected name and force the dialog box to remain open.</p>
<p>
The <i>lParam</i> parameter for each WM_NOTIFY message is a pointer to an <a href="commdlg3_0cmq.htm"><b>OFNOTIFY</b></a> structure that defines the action. The <b>code</b> member in the header for the <b>OFNOTIFY</b> structure contains one of the following notification codes.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=32%><a href="commdlg3_4817.htm">CDN_FILEOK</a></td>
<td width=68%>The user clicked the <b>OK</b> button; the dialog box is about to close. </td>
</tr>
<tr valign=top>
<td width=32%><a href="commdlg3_2xet.htm">CDN_FOLDERCHANGE</a></td>
<td width=68%>The user opened a new folder or directory.</td>
</tr>
<tr valign=top>
<td width=32%><a href="commdlg3_8okw.htm">CDN_HELP</a></td>
<td width=68%>The user clicked the <b>Help</b> button.</td>
</tr>
<tr valign=top>
<td width=32%><a href="commdlg3_3ihx.htm">CDN_INITDONE</a></td>
<td width=68%>The system has finished initializing the dialog box, and the dialog box has finished processing the <a href="dlgboxes_4n1j.htm">WM_INITDIALOG</a> message. Also, the system has finished arranging controls in the common dialog box to make room for the controls of the child dialog box (if any).</td>
</tr>
<tr valign=top>
<td width=32%><a href="commdlg3_4q05.htm">CDN_SELCHANGE</a></td>
<td width=68%>The user selected a new file or folder from the file list.</td>
</tr>
<tr valign=top>
<td width=32%><a href="commdlg3_7wku.htm">CDN_SHAREVIOLATION</a></td>
<td width=68%>The common dialog box encountered a sharing violation on the file about to be returned.</td>
</tr>
<tr valign=top>
<td width=32%><a href="commdlg3_4bs5.htm">CDN_TYPECHANGE</a></td>
<td width=68%>The user selected a new file type from the list of file types.</td>
</tr>
</table><br>
<p>
These WM_NOTIFY messages supersede the <a href="commdlg3_74kn.htm">FILEOKSTRING</a>, <a href="commdlg3_390n.htm">LBSELCHSTRING</a>, <a href="commdlg3_0tlz.htm">SHAREVISTRING</a>, and <a href="commdlg3_9d2f.htm">HELPMSGSTRING</a> registered messages used by previous versions of the <b>Open</b> and <b>Save As</b> dialog boxes. However, the hook procedure also receives the superseded message after the WM_NOTIFY message if the WM_NOTIFY processing does not use <a href="winclass_64tj.htm"><b>SetWindowLong</b></a> to set a nonzero DWL_MSGRESULT value.</p>
<p>
To retrieve information about the status of the dialog box or to control the behavior and appearance of the dialog box, the hook procedure can send the following messages to the dialog box.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=34%><a href="commdlg3_11wo.htm">CDM_GETFILEPATH</a></td>
<td width=66%>Retrieves the path and filename of the selected file.</td>
</tr>
<tr valign=top>
<td width=34%><a href="commdlg3_7jxw.htm">CDM_GETFOLDERIDLIST</a></td>
<td width=66%>Retrieves the item identifier list corresponding to the current folder that the dialog box has open. For more information about item identifier lists, see <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_shell_links">
</object><a href=JavaScript:alink_3.Click()>Item Identifiers and Identifier Lists</a>. </td>
</tr>
<tr valign=top>
<td width=34%><a href="commdlg3_3srs.htm">CDM_GETFOLDERPATH</a></td>
<td width=66%>Retrieves the path of the current folder or directory for the dialog box.</td>
</tr>
<tr valign=top>
<td width=34%><a href="commdlg3_4nqb.htm">CDM_GETSPEC</a></td>
<td width=66%>Retrieves the filename (not including the path) of the file currently selected in the dialog box. </td>
</tr>
<tr valign=top>
<td width=34%><a href="commdlg3_28mk.htm">CDM_HIDECONTROL</a></td>
<td width=66%>Hides the specified control.</td>
</tr>
<tr valign=top>
<td width=34%><a href="commdlg3_4lf8.htm">CDM_SETCONTROLTEXT</a></td>
<td width=66%>Sets the text in the specified control.</td>
</tr>
<tr valign=top>
<td width=34%><a href="commdlg3_7iwk.htm">CDM_SETDEFEXT</a></td>
<td width=66%>Sets the default filename extension for the dialog box.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
