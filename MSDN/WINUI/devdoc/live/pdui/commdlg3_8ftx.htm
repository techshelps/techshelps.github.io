<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Customizing the Sample Page</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_customizing_the_sample_page"></a>Customizing the Sample Page</h3>
<p>
The <b>Page Setup</b> dialog box includes an image of a sample page that shows how the user's selections affect the appearance of the printed output. The image consists of a rectangle that represents the selected paper or envelope type, with a dotted-line rectangle representing the current margins, and partial (greek text) characters to show how text looks on the printed page. </p>
<p>
When you call the <a href="commdlg3_89rb.htm"><b>PageSetupDlg</b></a> function, you can provide a <a href="commdlg3_05nv.htm"><b>PagePaintHook</b></a> hook procedure to customize the appearance of the sample page. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To enable a PagePaintHook hook procedure</h5>
<ol>
<li>
Set the PSD_ENABLEPAGEPAINTHOOK flag in the <b>Flags</b> member of the <a href="commdlg3_6waa.htm"><b>PAGESETUPDLG</b></a> structure.</li>
<li>
Specify the address of the hook procedure in the <b>lpfnPagePaintHook</b> member.</li>
</ol>
<p>
Whenever the dialog box is about to draw the contents of the sample page, the hook procedure receives the following messages in the order in which they are listed.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%><b>Message</b></td>
<td width=52%><b>Meaning</b></td>
</tr>
<tr valign=top>
<td width=48%><a href="commdlg3_38br.htm">WM_PSD_PAGESETUPDLG</a></td>
<td width=52%>The dialog box is about to draw the sample page. The hook procedure can use this message to prepare to draw the contents of the sample page.</td>
</tr>
<tr valign=top>
<td width=48%><a href="commdlg3_1zck.htm">WM_PSD_FULLPAGERECT</a></td>
<td width=52%>The dialog box is about to draw the sample page. This message specifies the bounding rectangle of the sample page.</td>
</tr>
<tr valign=top>
<td width=48%><a href="commdlg3_2vn8.htm">WM_PSD_MINMARGINRECT</a></td>
<td width=52%>The dialog box is about to draw the sample page. This message specifies the margin rectangle.</td>
</tr>
<tr valign=top>
<td width=48%><a href="commdlg3_6k38.htm">WM_PSD_MARGINRECT</a></td>
<td width=52%>The dialog box is about to draw the margin rectangle.</td>
</tr>
<tr valign=top>
<td width=48%><a href="commdlg3_0ypg.htm">WM_PSD_GREEKTEXTRECT</a></td>
<td width=52%>The dialog box is about to draw the Greek text inside the margin rectangle. </td>
</tr>
<tr valign=top>
<td width=48%><a href="commdlg3_7z1w.htm">WM_PSD_ENVSTAMPRECT</a></td>
<td width=52%>The dialog box is about to draw in the envelope-stamp rectangle of an envelope sample page. This message is sent for envelopes only.</td>
</tr>
<tr valign=top>
<td width=48%><a href="commdlg3_7rg4.htm">WM_PSD_YAFULLPAGERECT</a></td>
<td width=52%>The dialog box is about to draw the return address portion of an envelope sample page. This message is sent for envelopes and other paper sizes.</td>
</tr>
</table><br>
<p>
If the hook procedure returns TRUE for any of the first three messages of a drawing sequence (<a href="commdlg3_38br.htm">WM_PSD_PAGESETUPDLG</a>, <a href="commdlg3_1zck.htm">WM_PSD_FULLPAGERECT</a>, or <a href="commdlg3_2vn8.htm">WM_PSD_MINMARGINRECT</a>) the dialog box sends no more messages and does not draw in the sample page until the next time the system needs to redraw the sample page. If the hook procedure returns FALSE for all three messages, the dialog box sends the remaining messages of the drawing sequence.</p>
<p>
If the hook procedure returns TRUE for any of the remaining messages in a drawing sequence, the dialog box does not draw the corresponding portion of the sample page. If the hook procedure returns FALSE for any of these messages, the dialog box draws that portion of the sample page.</p>
<p>
To prevent the dialog box from drawing the contents of the sample page, you can set the PSD_DISABLEPAGEPAINTING flag. This flag does not affect your <a href="commdlg3_05nv.htm"><b>PagePaintHook</b></a> hook procedure, which still receives all the WM_PSD_* messages and can draw the sample page contents.</p>
<p>&nbsp;</p></body>
</HTML>
