<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Instance Subclassing</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_instance_subclassing"></a>Instance Subclassing</h3>
<p>
An application subclasses an instance of a window by using the <a href="winclass_64tj.htm"><b>SetWindowLong</b></a> function. The application passes the GWL_WNDPROC flag, the handle to the window to subclass, and the address of the subclass procedure to <b>SetWindowLong</b>. The subclass procedure can reside in either the application's executable or a dynamic-link library (DLL). </p>
<p>
<b>SetWindowLong</b> returns the address of the window's original window procedure. The application must save the address, using it in subsequent calls to the <a href="winprocs_9dlv.htm"><b>CallWindowProc</b></a> function, to pass intercepted messages to the original window procedure. The application must also have the original window procedure address to remove the subclass from the window. To remove the subclass, the application calls <b>SetWindowLong</b> again, passing the address of the original window procedure with the GWL_WNDPROC flag and the handle to the window. </p>
<p>
The system owns the system global classes, and aspects of the controls might change from one version of the system to the next. If the application must subclass a window that belongs to a system global class, the developer may need to update the application when a new version of the system is released. </p>
<p>
Because instance subclassing occurs after a window is created, you cannot add any extra bytes to the window. Applications that subclass a window should use the window's property list to store any data needed for an instance of the subclassed window. For more information, see <a href="winprops_8ugj.htm">Window Properties</a>. </p>
<p>
When an application subclasses a subclassed window, it must remove the subclasses in the reverse order they were performed. If the removal order is not reversed, an unrecoverable system error may occur. </p>
<p>&nbsp;</p></body>
</HTML>
