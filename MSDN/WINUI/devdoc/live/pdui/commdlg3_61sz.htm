<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OFNHookProc</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_ofnhookproc"></a>OFNHookProc</h1>
<p>
The <b>OFNHookProc</b> hook procedure is an application-defined or library-defined callback function that is used with the Explorer-style <b>Open</b> and <b>Save As</b> common dialog boxes. The function receives notification messages sent from the common dialog box. The function also receives messages for any additional controls that you defined by specifying a child dialog template.</p>
<p>
The <b>LPOFNHOOKPROC</b> type defines a pointer to this callback function. <b>OFNHookProc</b> is a placeholder for the application-defined or library-defined function name. </p>
<p>
If you do not specify the OFN_EXPLORER flag when you create an <b>Open</b> or <b>Save As</b> common dialog box, and you want a hook procedure, you must use an old-style <a href="commdlg3_3k9x.htm"><b>OFNHookProcOldStyle</b></a> hook procedure. In this case, the dialog box will have the old-style user interface.</p>
<pre><code><b>UINT CALLBACK OFNHookProc(
  HWND</b><i> hdlg</i><b>,      </b>// handle to child dialog window
<b>  UINT</b><i> uiMsg</i><b>,     </b>// message identifier
<b>  WPARAM</b><i> wParam</i><b>,  </b>// message parameter
<b>  LPARAM</b><i> lParam</i>   // message parameter
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hdlg</i></dt>
<dd>
Handle to the child dialog box of the <b>Open</b> or <b>Save As</b> dialog box. Use the <a href="windows_8ewk.htm"><b>GetParent</b></a> function to get the handle to the <b>Open</b> or <b>Save As</b> dialog box window. </dd>
<dt>
<i>uiMsg</i></dt>
<dd>
Identifies the message being received.</dd>
<dt>
<i>wParam</i></dt>
<dd>
Specifies additional information about the message. The exact meaning depends on the value of the <i>uiMsg</i> parameter.</dd>
<dt>
<i>lParam</i></dt>
<dd>
Specifies additional information about the message. The exact meaning depends on the value of the <i>uiMsg</i> parameter.
<p>
If the <i>uiMsg</i> parameter indicates the <a href="dlgboxes_4n1j.htm">WM_INITDIALOG</a> message, <i>lParam</i> is a pointer to an <a href="commdlg3_1hma.htm"><b>OPENFILENAME</b></a> structure containing the values specified when the dialog box was created.

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the hook procedure returns zero, the default dialog box procedure processes the message.</p>
<p>
If the hook procedure returns a nonzero value, the default dialog box procedure ignores the message.</p>
<p>
For the <a href="commdlg3_7wku.htm">CDN_SHAREVIOLATION</a> and <a href="commdlg3_4817.htm">CDN_FILEOK</a> notification messages, the hook procedure should return a nonzero value to indicate that it has used the <a href="winclass_64tj.htm"><b>SetWindowLong</b></a> function to set a nonzero DWL_MSGRESULT value.</p>
<h4>Remarks</h4>
<p>
When you use the <a href="commdlg3_3cbp.htm"><b>GetOpenFileName</b></a> or <a href="commdlg3_7zqd.htm"><b>GetSaveFileName</b></a> functions to create an Explorer-style <b>Open</b> or <b>Save As</b> common dialog box, you can provide an <b>OFNHookProc</b> hook procedure. To enable the hook procedure, use the <a href="commdlg3_1hma.htm"><b>OPENFILENAME</b></a> structure that you passed to the dialog creation function. Specify the pointer to the hook procedure in the <b>lpfnHook</b> member and specify the OFN_ENABLEHOOK flag in the <b>Flags</b> member.</p>
<p>
If you provide a hook procedure for an Explorer-style common dialog box, the system creates a dialog box that is a child of the default dialog box. The hook procedure acts as the dialog procedure for the child dialog. This child dialog is based on the template you specified in the <b>OPENFILENAME</b> structure, or it is a default child dialog if no template is specified. The child dialog is created when the default dialog procedure is processing its <a href="dlgboxes_4n1j.htm">WM_INITDIALOG</a> message. After the child dialog processes its own WM_INITDIALOG message, the default dialog procedure moves the standard controls, if necessary, to make room for any additional controls of the child dialog. The system then sends the <a href="commdlg3_3ihx.htm">CDN_INITDONE</a> notification message to the hook procedure.</p>
<p>
The hook procedure does not receive messages intended for the standard controls of the default dialog box. You can subclass the standard controls, but this is discouraged because it may make your application incompatible with future versions of the common dialog box. However, the Explorer-style common dialogs provide a set of messages that the hook procedure can use to monitor and control the dialog. These include a set of notification messages sent from the dialog, as well as messages that you can send to retrieve information from the dialog. For a complete list of these messages, see <a href="commdlg3_39gz.htm">Explorer-Style Hook Procedures</a>.</p>
<p>
If the hook procedure processes the <a href="dlgboxes_0j1j.htm">WM_CTLCOLORDLG</a> message, it must return a valid brush handle for painting the background of the dialog box. In general, if it processes any WM_CTLCOLOR* message, it must return a valid brush handle for painting the background of the specified control.</p>
<p>
Do not call the <a href="dlgboxes_9up3.htm"><b>EndDialog</b></a> function from the hook procedure. Instead, the hook procedure can call the <a href="messques_87mt.htm"><b>PostMessage</b></a> function to post a WM_COMMAND message with the IDABORT value to the dialog box procedure. Posting IDABORT closes the dialog box and causes the dialog box function to return FALSE. If you need to know why the hook procedure closed the dialog box, you must provide your own communication mechanism between the hook procedure and your application.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in commdlg.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>User-defined.</p>
<h4>See Also</h4>
<p>
<a href="commdlg3_04ft.htm">Common Dialog Box Library Overview</a>, <a href="commdlg3_8zjn.htm">Common Dialog Box Functions</a>, <a href="commdlg3_3cbp.htm"><b>GetOpenFileName</b></a>, <a href="commdlg3_7zqd.htm"><b>GetSaveFileName</b></a>, <a href="commdlg3_3k9x.htm"><b>OFNHookProcOldStyle</b></a>, <a href="commdlg3_1hma.htm"><b>OPENFILENAME</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
