<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PagePaintHook</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_pagepainthook"></a>PagePaintHook</h1>
<p>
The <b>PagePaintHook</b> hook procedure is an application-defined or library-defined callback function used with the <a href="commdlg3_89rb.htm"><b>PageSetupDlg</b></a> function. This function receives messages that allow you to customize drawing of the sample page in the <b>Page Setup</b> dialog box. </p>
<p>
The <b>LPPAGEPAINTHOOK</b> type defines a pointer to this callback function. <b>PagePaintHook</b> is a placeholder for the application-defined or library-defined function name. </p>
<pre><code><b>UINT CALLBACK PagePaintHook(
  HWND</b><i> hdlg</i><b>,      </b>// handle to the dialog box window
<b>  UINT</b><i> uiMsg</i><b>,     </b>// message identifier
<b>  WPARAM</b><i> wParam</i><b>,  </b>// message parameter
<b>  LPARAM</b><i> lParam</i>   // message parameter
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hdlg</i></dt>
<dd>
Handle to the <b>Page Setup</b> dialog box window. </dd>
<dt>
<i>uiMsg</i></dt>
<dd>
Identifies the message being received.</dd>
<dt>
<i>wParam</i></dt>
<dd>
Specifies additional information about the message. The exact meaning depends on the value of the <i>uiMsg</i> parameter.</dd>
<dt>
<i>lParam</i></dt>
<dd>
Specifies additional information about the message. The exact meaning depends on the value of the <i>uiMsg</i> parameter.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the hook procedure returns TRUE for any of the first three messages of a drawing sequence (WM_PSD_PAGESETUPDLG, WM_PSD_FULLPAGERECT, or WM_PSD_MINMARGINRECT), the dialog box sends no more messages and does not draw in the sample page until the next time the system needs to redraw the sample page. If the hook procedure returns FALSE for all three messages, the dialog box sends the remaining messages of the drawing sequence.</p>
<p>
If the hook procedure returns TRUE for any of the remaining messages in a drawing sequence, the dialog box does not draw the corresponding portion of the sample page. If the hook procedure returns FALSE for any of these messages, the dialog box draws that portion of the sample page.</p>
<h4>Remarks</h4>
<p>
The <b>Page Setup</b> dialog box includes an image of a sample page that shows how the user's selections affect the appearance of the printed output. The image consists of a rectangle that represents the selected paper or envelope type, with a dotted-line rectangle representing the current margins, and partial (Greek text) characters to show how text looks on the printed page. When you use the <a href="commdlg3_89rb.htm"><b>PageSetupDlg</b></a> function to create a <b>Page Setup</b> dialog box, you can provide a <b>PagePaintHook</b> hook procedure to customize the appearance of the sample page. </p>
<p>
To enable the hook procedure, use the <a href="commdlg3_6waa.htm"><b>PAGESETUPDLG</b></a> structure that you passed to the dialog creation function. Specify the pointer to the hook procedure in the <b>lpfnPagePaintHook</b> member and specify the PSD_ENABLEPAGEPAINTHOOK flag in the <b>Flags</b> member.</p>
<p>
Whenever the dialog box is about to draw the contents of the sample page, the hook procedure receives the following messages in the order in which they are listed: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%><b><u>Message</u></b></td>
<td width=52%><b>Meaning</b></td>
</tr>
<tr valign=top>
<td width=48%><a href="commdlg3_38br.htm">WM_PSD_PAGESETUPDLG</a></td>
<td width=52%>The dialog box is about to draw the sample page. The hook procedure can use this message to prepare to draw the contents of the sample page.</td>
</tr>
<tr valign=top>
<td width=48%><a href="commdlg3_1zck.htm">WM_PSD_FULLPAGERECT</a></td>
<td width=52%>The dialog box is about to draw the sample page. This message specifies the bounding rectangle of the sample page.</td>
</tr>
<tr valign=top>
<td width=48%><a href="commdlg3_2vn8.htm">WM_PSD_MINMARGINRECT</a></td>
<td width=52%>The dialog box is about to draw the sample page. This message specifies the margin rectangle.</td>
</tr>
<tr valign=top>
<td width=48%><a href="commdlg3_6k38.htm">WM_PSD_MARGINRECT</a></td>
<td width=52%>The dialog box is about to draw the margin rectangle.</td>
</tr>
<tr valign=top>
<td width=48%><a href="commdlg3_0ypg.htm">WM_PSD_GREEKTEXTRECT</a></td>
<td width=52%>The dialog box is about to draw the Greek text inside the margin rectangle. </td>
</tr>
<tr valign=top>
<td width=48%><a href="commdlg3_7z1w.htm">WM_PSD_ENVSTAMPRECT</a></td>
<td width=52%>The dialog box is about to draw in the envelope-stamp rectangle of an envelope sample page. This message is sent for envelopes only.</td>
</tr>
<tr valign=top>
<td width=48%><a href="commdlg3_7rg4.htm">WM_PSD_YAFULLPAGERECT</a></td>
<td width=52%>The dialog box is about to draw the return address portion of an envelope sample page. This message is sent for envelopes and other paper sizes.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in commdlg.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>User-defined.</p>
<h4>See Also</h4>
<p>
<a href="commdlg3_04ft.htm">Common Dialog Box Library Overview</a>, <a href="commdlg3_8zjn.htm">Common Dialog Box Functions</a>, <a href="commdlg3_89rb.htm"><b>PageSetupDlg</b></a>, <a href="commdlg3_6waa.htm"><b>PAGESETUPDLG</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
