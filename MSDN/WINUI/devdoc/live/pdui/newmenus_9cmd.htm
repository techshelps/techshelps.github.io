<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Owner-Drawn Menus and the WM_DRAWITEM Message</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_owner_drawn_menus_and_the_wm_drawitem_message"></a>Owner-Drawn Menus and the WM_DRAWITEM Message</h3>
<p>
Whenever the item must be drawn (for example, when it is first displayed or when the user selects it), the system sends the <a href="combobox_3sx9.htm">WM_DRAWITEM</a> message to the window procedure of the menu's owner window. This message contains a pointer to a <a href="combobox_88s2.htm"><b>DRAWITEMSTRUCT</b></a> structure, which contains information about the item, including the item data that an application may have assigned to it. In addition, <b>DRAWITEMSTRUCT</b> contains flags that indicate the state of the item (such as whether it is grayed or checked) as well as a bounding rectangle and a device context that the application uses to draw the item. </p>
<p>
An application must do the following while processing the WM_DRAWITEM message:
<ol>
<li>
Determine the type of drawing that is necessary. To do so, check the <b>itemAction</b> member of the <b>DRAWITEMSTRUCT</b> structure. </li>
<li>
Draw the menu item appropriately, using the bounding rectangle and device context obtained from the <b>DRAWITEMSTRUCT</b> structure. The application must draw only within the bounding rectangle. For performance reasons, the system does not clip portions of the image that are drawn outside the rectangle. </li>
<li>
Restore all GDI objects selected for the menu item's device context. </li>
</ol>
<p>
If the user selects the menu item, the system sets the <b>itemAction</b> member of the <a href="combobox_88s2.htm"><b>DRAWITEMSTRUCT</b></a> structure to the ODA_SELECT value and sets the ODS_SELECTED value in the <b>itemState</b> member. This is an application's cue to redraw the menu item to indicate that it is selected.</p>
<p>&nbsp;</p></body>
</HTML>
