<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>EM_STREAMOUT</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_em_streamout"></a>EM_STREAMOUT</h1>
<p>
The EM_STREAMOUT message causes a rich edit control to pass its contents to an application-defined <a href="richedit_4aej.htm"><i>EditStreamCallback</i></a> callback function. The callback function can then write the stream of data to a file or any other location that it chooses. </p>
<pre><code>EM_STREAMOUT 
wParam = (WPARAM) (UINT) uFormat; 
lParam = (LPARAM) (EDITSTREAM FAR *) lpStream; 
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>uFormat</i></dt>
<dd>
Value specifying one of the following data formats:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=28%>Value</th>
<th align=left width=72%>Meaning</th>
</tr>
<tr valign=top>
<td width=28%>SF_TEXT</td>
<td width=72%>Text with spaces in place of OLE objects</td>
</tr>
<tr valign=top>
<td width=28%>SF_RTF</td>
<td width=72%>Rich Text Format (RTF)</td>
</tr>
<tr valign=top>
<td width=28%>SF_RTFNOOBJS</td>
<td width=72%>RTF with spaces in place of OLE object.</td>
</tr>
<tr valign=top>
<td width=28%>SF_TEXTIZED</td>
<td width=72%>Text with a text representation of OLE objects.</td>
</tr>
</table><br>


<p>
The SF_RTFNOOBJS option is useful if an application stores OLE objects itself, as RTF representation of OLE objects is not very compact. The control word "\objattph" followed by a space denotes the object position.

<p>
You can combine any of the data format values with the SFF_SELECTION flag. If you specify SFF_SELECTION, the rich edit control streams out only the contents of the current selection. Otherwise, the control streams out its entire contents.

<p>
You can combine the SF_RTF and SF_RTFNOOBJS values with the SFF_PLAINRTF flag. If you specify SFF_PLAINRTF, the rich edit control streams out only keywords common to all languages; it ignores language-specific RTF keywords.
</dd>
<dt>
<i>lpStream</i></dt>
<dd>
Pointer to an <b>EDITSTREAM</b> structure. On input, the <b>pfnCallback</b> member of this structure must point to an application-defined <i>EditStreamCallback</i> function. On output, the <b>dwError</b> member can contain a nonzero error code if an error occurred. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns the number of characters written to the data stream.</p>
<h4>Remarks</h4>
<p>
When you send an EM_STREAMOUT message, the rich edit control makes repeated calls to the <i>EditStreamCallback</i> function specified by the <b>pfnCallback</b> member of the <b>EDITSTREAM</b> structure. Each time it calls the callback function, the control passes a buffer containing a portion of the contents of the control. This process continues until the control has passed all its contents to the callback function, or until an error occurs.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.51 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in richedit.h.</p>
<h4>See Also</h4>
<p>
<a href="richedit_5a7n.htm">Rich Edit Controls Overview</a>, <a href="richedit_2m5v.htm">Rich Edit Messages</a>, <a href="richedit_1sz6.htm"><b>EDITSTREAM</b></a>, <a href="richedit_4aej.htm"><b>EditStreamCallback</b></a>, <a href="richedit_4be6.htm">EM_STREAMIN</a> </p>
<p>&nbsp;</p></body>
</HTML>
