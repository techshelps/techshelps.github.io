<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Customizing the Print Property Sheet</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_customizing_the_print_property_sheet"></a>Customizing the Print Property Sheet</h3>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
You can customize the <b>Print</b> property sheet in the following ways:
<ul>
<li>
Provide a custom template for the lower portion of the <b>General</b> page. This allows you to include additional controls that are unique to your application. The <a href="commdlg3_5s54.htm"><b>PrintDlgEx</b></a> function uses your custom template in place of the default template. </li>
<li>
Provide additional property pages to follow the <b>General</b> page. </li>
<li>
Provide a callback object. For more information, see <a href="commdlg3_5lf8.htm">Callback Object for the Print Property Sheet</a>. </li>
</ul>
<p>
You cannot change the upper portion of the <b>General</b> page. You cannot change property pages provided by the printer driver.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To provide a custom template for the General page</h5>
<ol>
<li>
Create a custom template for the lower portion of the <b>General</b> page by modifying the PRINTDLGEXORD template specified in the PRNSETUP.DLG file. The custom template must be the same size as the default template. The control identifiers used in the default <b>Print</b> dialog template are defined in the DLGS.H file.</li>
<li>
Use the <a href="commdlg3_53hu.htm"><b>PRINTDLGEX</b></a> structure to enable the template as follows:<ul>
<li>
If your custom template is a resource in an application or dynamic-link library, set the PD_ENABLEPRINTTEMPLATE flag in the <b>Flags</b> member. Use the <b>hInstance</b> and <b>lpPrintTemplateName</b> members of the structure to identify the module and resource name. <p>
<b>-Or-</b>
</li>
<li>
If your custom template is already in memory, set the PD_ENABLEPRINTTEMPLATEHANDLE flag. Use the <b>hInstance</b> member to identify the memory object that contains the template.</li>
</ul>
</li>
<li>
If you use a custom template to define additional controls, you must provide a callback object to process input for your controls. The callback object implements a <a href="commdlg3_55id.htm"><b>IPrintDialogCallback::HandleMessage</b></a> method which receives messages sent to the custom dialog box. </li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To provide additional property pages</h5>
<ol>
<li>
Use the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_createpropertysheetpage">
</object><a href=JavaScript:alink_1.Click()><b>CreatePropertySheetPage</b></a> function to create the additional pages.</li>
<li>
Use the <b>lphPropertyPages</b> member of the <a href="commdlg3_53hu.htm"><b>PRINTDLGEX</b></a> structure to specify an array of handles to the additional pages.<p>
The dialog box procedures specified when you created each page process messages sent to the pages.
</li>
<li>
You might want to provide a callback object that implements the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_com_iobjectwithsite">
</object><a href=JavaScript:alink_2.Click()><b>IObjectWithSite</b></a> interface. The <a href="commdlg3_5s54.htm"><b>PrintDlgEx</b></a> function uses this interface to pass to the application a pointer to an <a href="commdlg3_8cz7.htm"><b>IPrintDialogServices</b></a> interface. The dialog box procedures for the additional property pages can use this interface to retrieve information about the currently selected printer.</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
