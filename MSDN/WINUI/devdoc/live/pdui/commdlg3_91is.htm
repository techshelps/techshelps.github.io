<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FindText</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_findtext"></a>FindText</h1>
<p>
The <b>FindText</b> function creates a system-defined modeless <b>Find</b> dialog box that lets the user specify a string to search for and options to use when searching for text in a document. </p>
<pre><code><b>HWND FindText(
  LPFINDREPLACE</b><i> lpfr</i>   // pointer to structure with initialization 
                       // data
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpfr</i></dt>
<dd>
Pointer to a <a href="commdlg3_4uwi.htm"><b>FINDREPLACE</b></a> structure that contains information used to initialize the dialog box. The dialog box uses this structure to send information about the user's input to your application. For more information, see the following Remarks section.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the window handle to the dialog box. You can use the window handle to communicate with or to close the dialog box. </p>
<p>
If the function fails, the return value is NULL. To get extended error information, call the <a href="commdlg3_567m.htm"><b>CommDlgExtendedError</b></a> function. <b>CommDlgExtendedError</b> may return one of the following error codes: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>CDERR_FINDRESFAILURE</td>
<td width=52%>CDERR_MEMLOCKFAILURE</td>
</tr>
<tr valign=top>
<td width=48%>CDERR_INITIALIZATION</td>
<td width=52%>CDERR_NOHINSTANCE</td>
</tr>
<tr valign=top>
<td width=48%>CDERR_LOCKRESFAILURE</td>
<td width=52%>CDERR_NOHOOK</td>
</tr>
<tr valign=top>
<td width=48%>CDERR_LOADRESFAILURE</td>
<td width=52%>CDERR_NOTEMPLATE</td>
</tr>
<tr valign=top>
<td width=48%>CDERR_LOADSTRFAILURE</td>
<td width=52%>CDERR_STRUCTSIZE</td>
</tr>
<tr valign=top>
<td width=48%>CDERR_MEMALLOCFAILURE</td>
<td width=52%>FRERR_BUFFERLENGTHZERO</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The <b>FindText</b> function does not perform a search operation. Instead, the dialog box sends <a href="commdlg3_1y07.htm">FINDMSGSTRING</a> registered messages to the window procedure of the owner window of the dialog box. When you create the dialog box, the <b>hwndOwner</b> member of the <b>FINDREPLACE</b> structure identifies the owner window. </p>
<p>
Before calling <b>FindText</b>, you must call the <b>RegisterWindowMessage</b> function to get the identifier for the FINDMSGSTRING message. The dialog box procedure uses this identifier to send messages when the user clicks the <b>Find</b> <b>Next</b> button, or when the dialog box is closing. The <i>lParam</i> parameter of the FINDMSGSTRING message contains a pointer to a <b>FINDREPLACE</b> structure. The <b>Flags</b> member of this structure indicates the event that caused the message. Other members of the structure indicate the user's input.</p>
<p>
If you create a <b>Find</b> dialog box, you must also use the <b>IsDialogMessage</b> function in the main message loop of your application to ensure that the dialog box correctly processes keyboard input, such as the tab and esc keys. <b>IsDialogMessage</b> returns a value that indicates whether the <b>Find</b> dialog box processed the message. </p>
<p>
You can provide an <a href="commdlg3_1n6r.htm"><b>FRHookProc</b></a> hook procedure for a <b>Find</b> dialog box. The hook procedure can process messages sent to the dialog box. To enable a hook procedure, set the FR_ENABLEHOOK flag in the <b>Flags</b> member of the <b>FINDREPLACE</b> structure and specify the address of the hook procedure in the <b>lpfnHook</b> member. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in commdlg.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use comdlg32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="commdlg3_04ft.htm">Common Dialog Box Library Overview</a>, <a href="commdlg3_8zjn.htm">Common Dialog Box Functions</a>, <a href="commdlg3_567m.htm"><b>CommDlgExtendedError</b></a>, <a href="commdlg3_1y07.htm">FINDMSGSTRING</a>, <a href="commdlg3_4uwi.htm"><b>FINDREPLACE</b></a>, <a href="commdlg3_1n6r.htm"><b>FRHookProc</b></a>, <a href="dlgboxes_5t45.htm"><b>IsDialogMessage</b></a>, <a href="messques_10h1.htm"><b>RegisterWindowMessage</b></a>, <a href="commdlg3_07as.htm"><b>ReplaceText</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
