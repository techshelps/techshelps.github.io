<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Updating Resources</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_updating_resources"></a>Updating Resources</h2>
<p>
The following example copies a dialog box resource from one executable file, HAND.EXE, to another, FOOT.EXE, by following these steps: 
<ol>
<li>
Use the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_loadlibrary">
</object><a href=JavaScript:alink_1.Click()><b>LoadLibrary</b></a> function to load the executable file HAND.EXE. </li>
<li>
Use the <a href="resource_2exx.htm"><b>FindResource</b></a> and <a href="resource_2i05.htm"><b>LoadResource</b></a> functions to locate and load the dialog box resource. </li>
<li>
Use the <a href="resource_4co5.htm"><b>LockResource</b></a> function to retrieve a pointer to the dialog box resource data. </li>
<li>
Use the <a href="resource_5g2t.htm"><b>BeginUpdateResource</b></a> function to open an update handle to FOOT.EXE. </li>
<li>
Use the <a href="resource_2crp.htm"><b>UpdateResource</b></a> function to copy the dialog box resource from HAND.EXE to FOOT.EXE. </li>
<li>
Use the <a href="resource_9qcl.htm"><b>EndUpdateResource</b></a> function to complete the update. </li>
</ol>
<p>
The following code implements these steps. </p>
<pre><code>HRSRC hResLoad;     // handle to loaded resource 
HANDLE hExe;        // handle to existing .EXE file 
HRSRC hRes;         // handle/ptr. to res. info. in hExe 
HANDLE hUpdateRes;  // update resource handle 
char *lpResLock;    // pointer to resource data 
BOOL result; 
 
// Load the .EXE file that contains the dialog box you want to copy. 
hExe = LoadLibrary("hand.exe"); 
 
if (hExe == NULL) 
{ 
    ErrorHandler("Could not load exe."); 
} 
 
// Locate the dialog box resource in the .EXE file. 
hRes = FindResource(hExe, "AboutBox", RT_DIALOG); 
 
if (hRes == NULL) 
{ 
    ErrorHandler("Could not locate dialog box."); 
} 
 
// Load the dialog box into global memory. 
hResLoad = LoadResource(hExe, hRes); 
 
if (hResLoad == NULL) 
{ 
    ErrorHandler("Could not load dialog box."); 
} 
 
// Lock the dialog box into global memory. 
lpResLock = LockResource(hRes); 
 
if (lpResLock == NULL) 
{ 
    ErrorHandler("Could not lock dialog box."); 
} 
 
// Open the file to which you want to add the dialog box resource. 
hUpdateRes = BeginUpdateResource("foot.exe", FALSE); 
 
if (hUpdateRes == NULL) 
{ 
    ErrorHandler("Could not open file for writing."); 
} 
 
// Add the dialog box resource to the update list. 
result = UpdateResource(hUpdateRes,       // update resource handle 
     RT_DIALOG,                   // change dialog box resource 
     "AboutBox",                  // dialog box name 
     MAKELANGID(LANG_NEUTRAL, SUBLANG_NEUTRAL),  // neutral language
     lpResLock,                   // ptr to resource info 
     SizeofResource(hExe, hRes)); // size of resource info. 
 
if (result == FALSE) 
{ 
    ErrorHandler("Could not add resource."); 
} 
 
// Write changes to FOOT.EXE and then close it. 
if (!EndUpdateResource(hUpdateRes, FALSE)) 
{ 
    ErrorHandler("Could not write changes to file."); 
} 
 
// Clean up. 
if (!FreeLibrary(hExe)) 
{ 
    ErrorHandler("Could not free executable."); 
} 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
