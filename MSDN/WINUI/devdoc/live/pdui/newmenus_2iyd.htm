<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Shortcut Menu</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_creating_a_shortcut_menu"></a>Creating a Shortcut Menu</h2>
<p>
To use a shortcut menu in an application, pass its handle to the <a href="newmenus_6xx4.htm"><b>TrackPopupMenuEx</b></a> function. An application typically calls <b>TrackPopupMenuEx</b> in a window procedure in response to a user-generated message, such as <a href="mousinpt_8uum.htm">WM_LBUTTONDOWN</a> or <a href="keybinpt_9l7y.htm">WM_KEYDOWN</a>. </p>
<p>
In addition to the pop-up menu handle, <b>TrackPopupMenuEx</b> requires that you specify the handle to the owner window, the position of the shortcut menu (in screen coordinates), and the mouse button that the user can use to choose an item. </p>
<p>
The older <a href="newmenus_0hdi.htm"><b>TrackPopupMenu</b></a> function is still supported, but new applications should use the <b>TrackPopupMenuEx</b> function. The <b>TrackPopupMenuEx</b> function requires the same parameters as <b>TrackPopupMenu,</b> but also lets you specify a portion of the screen that the menu should not obscure. An application typically calls these functions in a window procedure when processing the <a href="newmenus_68vp.htm">WM_CONTEXTMENU</a> message.</p>
<p>
You can specify the position of a shortcut menu by providing x- and y-coordinates along with the TPM_CENTERALIGN, TPM_LEFTALIGN, or TPM_RIGHTALIGN flag. The flag specifies the position of the shortcut menu relative to the x- and y-coordinates. </p>
<p>
You should permit the user to choose an item from a shortcut menu by using the same mouse button used to display the menu. To do this, specify either TPM_LEFTBUTTON or TPM_RIGHTBUTTON flag to indicate which mouse button the user can use to choose a menu item. </p>
<p>&nbsp;</p></body>
</HTML>
