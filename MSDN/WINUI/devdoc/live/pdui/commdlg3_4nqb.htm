<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CDM_GETSPEC</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_cdm_getspec"></a>CDM_GETSPEC</h1>
<p>
The <b>CDM_GETSPEC</b> message retrieves the filename (not including the path) of the currently selected file in an Explorer-style <b>Open</b> or <b>Save</b> <b>As</b> common dialog box. The dialog box must have been created with the OFN_EXPLORER flag; otherwise, the message fails.</p>
<pre><code>CDM_GETSPEC 
wParam = (WPARAM) cbmax; 
lParam = (LPARAM) (LPTSTR) psz; 
 
// Corresponding macro 
int CommDlg_OpenSave_GetSpec(hdlg, psz, cbmax); 
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hdlg</i></dt>
<dd>
Handle of the common dialog box window to receive the message.</dd>
<dt>
<i>psz</i></dt>
<dd>
Address of the buffer that receives the filename. </dd>
<dt>
<i>cbmax</i></dt>
<dd>
Size, in bytes (ANSI version) or 16-bit characters (Unicode version), of the <i>psz</i> buffer. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the message succeeds, the return value is the size, in bytes or characters, of the filename string, including the terminating NULL character. This is either the number of bytes or characters copied to the <i>psz</i> buffer, or the required buffer size if the buffer is too small.</p>
<p>
If an error occurs, the return value is less than zero.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in commdlg.h.</p>
<h4>See Also</h4>
<p>
<a href="commdlg3_04ft.htm">Common Dialog Box Library Overview</a>, <a href="commdlg3_7eib.htm">Common Dialog Box Messages</a>, <a href="commdlg3_3cbp.htm"><b>GetOpenFileName</b></a>, <a href="commdlg3_7zqd.htm"><b>GetSaveFileName</b></a>, <a href="commdlg3_1hma.htm"><b>OPENFILENAME</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
