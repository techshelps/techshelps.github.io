<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Customizing Old-Style Dialog Boxes</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_customizing_old_style_dialog_boxes"></a>Customizing Old-Style Dialog Boxes</h3>
<p>
You can customize an old-style <b>Open</b> or <b>Save As</b> dialog box by providing an <a href="commdlg3_3k9x.htm"><b>OFNHookProcOldStyle</b></a> hook procedure that receives messages or notifications intended for the default dialog box procedure. You can also provide a custom template to use in place of the default template. The hook procedures and templates used with the old-style dialog boxes are similar to those used with the other common dialog boxes. For more information, see <a href="commdlg3_8lkj.htm">Hook Procedures for Common Dialog Boxes</a> and <a href="commdlg3_4qlv.htm">Custom Templates</a>. </p>
<p>
To enable a hook procedure for an old-style <b>Open</b> or <b>Save As</b> dialog box, use the <a href="commdlg3_1hma.htm"><b>OPENFILENAME</b></a> structure when you create the dialog box. Set the OFN_ENABLEHOOK flag in the <b>Flags</b> member and specify the address of an <b>OFNHookProcOldStyle</b> hook procedure in the <b>lpfnHook</b> member. The dialog box procedure sends a <a href="dlgboxes_4n1j.htm">WM_INITDIALOG</a> message to the hook procedure with the <i>lParam</i> parameter set to the address of the <b>OPENFILENAME</b> structure used to initialize the dialog box. </p>
<p>
You can use the <b>OPENFILENAME</b> structure to specify a custom template for the <b>Open</b> or <b>Save As</b> dialog box to use in place of the default template. If your custom template is a resource in an application or dynamic-link library, set the OFN_ENABLETEMPLATE flag in the <b>Flags</b> member and use the <b>hInstance</b> and <b>lpTemplateName</b> members of the structure to identify the module and resource name. If your custom template is already in memory, set the OFN_ENABLETEMPLATEHANDLE flag and use the <b>hInstance</b> member to identify the memory object that contains the template. Create the custom template by modifying the default template specified in the FILEOPEN.DLG file. The control identifiers used in the default Find and Replace dialog templates are defined in the DLGS.H file.</p>
<p>
By default, the <a href="commdlg3_3cbp.htm"><b>GetOpenFileName</b></a> and <a href="commdlg3_7zqd.htm"><b>GetSaveFileName</b></a> functions display the Explorer-style dialog boxes. If you want to display an old-style dialog box, you must provide an <a href="commdlg3_3k9x.htm"><b>OFNHookProcOldStyle</b></a> hook procedure and ensure that the OFN_EXPLORER flag is not set in the <b>Flags</b> member of the <b>OPENFILENAME</b> structure. </p>
<p>
If you set the OFN_EXPLORER flag, the system treats a hook procedure or custom template as an Explorer-style customization. For information about customizing an Explorer-style dialog box, see <a href="commdlg3_1yr7.htm">Explorer-Style Custom Templates</a>. </p>
<p>&nbsp;</p></body>
</HTML>
