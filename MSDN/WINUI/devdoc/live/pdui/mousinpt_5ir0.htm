<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WM_MOUSEWHEEL</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_wm_mousewheel"></a>WM_MOUSEWHEEL</h1>
<p>
The WM_MOUSEWHEEL message is sent to the focus window when the mouse wheel is rotated. The DefWindowProc function propagates the message to the window's parent. There should be no internal forwarding of the message, since DefWindowProc propagates it up the parent chain until it finds a window that processes it.</p>
<pre><code>WM_MOUSEWHEEL
fwKeys = LOWORD(wParam);    // key flags
zDelta = (short) HIWORD(wParam);    // wheel rotation
xPos = (short) LOWORD(lParam);    // horizontal position of pointer
yPos = (short) HIWORD(lParam);    // vertical position of pointer
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>fwKeys</i></dt>
<dd>
Value of the low-order word of <i>wParam</i>. Indicates whether various virtual keys are down. This parameter can be any combination of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=29%><b>Value</b></td>
<th align=left width=71%>Description</th>
</tr>
<tr valign=top>
<td width=29%>MK_CONTROL</td>
<td width=71%>Set if the ctrl key is down.</td>
</tr>
<tr valign=top>
<td width=29%>MK_LBUTTON</td>
<td width=71%>Set if the left mouse button is down.</td>
</tr>
<tr valign=top>
<td width=29%>MK_MBUTTON</td>
<td width=71%>Set if the middle mouse button is down.</td>
</tr>
<tr valign=top>
<td width=29%>MK_RBUTTON</td>
<td width=71%>Set if the right mouse button is down.</td>
</tr>
<tr valign=top>
<td width=29%>MK_SHIFT</td>
<td width=71%>Set if the shift key is down.</td>
</tr>
</table><br>

</dd>
<dt>
<i>zDelta</i></dt>
<dd>
The value of the high-order word of <i>wParam</i>. Indicates the distance that the wheel is rotated, expressed in multiples or divisions of WHEEL_DELTA, which is 120. A positive value indicates that the wheel was rotated forward, away from the user; a negative value indicates that the wheel was rotated backward, toward the user.</dd>
<dt>
<i>xPos</i></dt>
<dd>
Value of the low-order word of <i>lParam</i>. Specifies the x-coordinate of the pointer, relative to the upper-left corner of the screen.</dd>
<dt>
<i>yPos</i></dt>
<dd>
Value of the high-order word of <i>lParam</i>. Specifies the y-coordinate of the pointer, relative to the upper-left corner of the screen.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The zDelta parameter will be a multiple of WHEEL_DELTA, which is set at 120. This is the threshold for action to be taken, and one such action (for example, scrolling one increment) should occur for each delta.</p>
<p>
The delta was set to 120 to allow Microsoft or other vendors to build finer-resolution wheels in the future, including perhaps a freely-rotating wheel with no notches. The expectation is that such a device would send more messages per rotation, but with a smaller value in each message. To support this possibility, you should either add the incoming delta values until WHEEL_DELTA is reached (so for a given delta-rotation you get the same response), or scroll partial lines in response to the more frequent messages. You could also choose your scroll granularity and accumulate deltas until it is reached.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 98.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winuser.h.</p>
<h4>See Also</h4>
<p>
<a href="mousinpt_5rjo.htm">Mouse Input Overview</a>, <a href="mousinpt_5gs3.htm">Mouse Input Messages</a>, <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getsystemmetrics">
</object><a href=JavaScript:alink_1.Click()><b>GetSystemMetrics</b></a>, <a href="mousinpt_1d2s.htm"><b>mouse_event</b></a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_systemparametersinfo">
</object><a href=JavaScript:alink_2.Click()><b>SystemParametersInfo</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
