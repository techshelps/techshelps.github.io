<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>UpdateResource</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_updateresource"></a>UpdateResource</h1>
<p>
The <b>UpdateResource</b> function adds, deletes, or replaces a resource in an executable file. </p>
<pre><code><b>BOOL UpdateResource(
  HANDLE</b><i> hUpdate</i><b>, </b>// update-file handle
<b>  LPCTSTR</b><i> lpType</i><b>, </b>// address of resource type to update
<b>  LPCTSTR</b><i> lpName</i><b>, </b>// address of resource name to update
<b>  WORD</b><i> wLanguage</i><b>, </b>// language identifier of resource
<b>  LPVOID</b><i> lpData</i><b>,  </b>// address of resource data
<b>  DWORD</b><i> cbData</i>    // length of resource data, in bytes
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hUpdate</i></dt>
<dd>
Specifies an update-file handle. This handle is returned by the <a href="resource_5g2t.htm"><b>BeginUpdateResource</b></a> function. </dd>
<dt>
<i>lpType</i></dt>
<dd>
Pointer to a null-terminated string specifying the resource type to be updated. This parameter can also be an integer value passed to the <a href="resource_2dd1.htm"><b>MAKEINTRESOURCE</b></a> macro, or it can be one of the following predefined resource types: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Value</th>
<th align=left width=64%>Meaning</th>
</tr>
<tr valign=top>
<td width=36%>RT_ACCELERATOR</td>
<td width=64%>Accelerator table</td>
</tr>
<tr valign=top>
<td width=36%>RT_ANICURSOR</td>
<td width=64%>Animated cursor</td>
</tr>
<tr valign=top>
<td width=36%>RT_ANIICON</td>
<td width=64%>Animated icon</td>
</tr>
<tr valign=top>
<td width=36%>RT_BITMAP</td>
<td width=64%>Bitmap resource</td>
</tr>
<tr valign=top>
<td width=36%>RT_CURSOR</td>
<td width=64%>Hardware-dependent cursor resource</td>
</tr>
<tr valign=top>
<td width=36%>RT_DIALOG</td>
<td width=64%>Dialog box</td>
</tr>
<tr valign=top>
<td width=36%>RT_FONT</td>
<td width=64%>Font resource</td>
</tr>
<tr valign=top>
<td width=36%>RT_FONTDIR</td>
<td width=64%>Font directory resource</td>
</tr>
<tr valign=top>
<td width=36%>RT_GROUP_CURSOR</td>
<td width=64%>Hardware-independent cursor resource</td>
</tr>
<tr valign=top>
<td width=36%>RT_GROUP_ICON</td>
<td width=64%>Hardware-independent icon resource</td>
</tr>
<tr valign=top>
<td width=36%>RT_HTML</td>
<td width=64%>HTML document</td>
</tr>
<tr valign=top>
<td width=36%>RT_ICON</td>
<td width=64%>Hardware-dependent icon resource</td>
</tr>
<tr valign=top>
<td width=36%>RT_MENU</td>
<td width=64%>Menu resource</td>
</tr>
<tr valign=top>
<td width=36%>RT_MESSAGETABLE</td>
<td width=64%>Message-table entry</td>
</tr>
<tr valign=top>
<td width=36%>RT_RCDATA</td>
<td width=64%>Application-defined resource (raw data)</td>
</tr>
<tr valign=top>
<td width=36%>RT_STRING</td>
<td width=64%>String-table entry</td>
</tr>
<tr valign=top>
<td width=36%>RT_VERSION</td>
<td width=64%>Version resource</td>
</tr>
</table><br>

</dd>
<dt>
<i>lpName</i></dt>
<dd>
Pointer to a null-terminated string specifying the name of the resource to be updated. This parameter can also be an integer value passed to the <a href="resource_2dd1.htm"><b>MAKEINTRESOURCE</b></a> macro. </dd>
<dt>
<i>wLanguage</i></dt>
<dd>
Specifies the language identifier of the resource to be updated. For a list of the primary language identifiers and sublanguage identifiers that make up a language identifier, see the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_makelangid">
</object><a href=JavaScript:alink_1.Click()><b>MAKELANGID</b></a> macro. </dd>
<dt>
<i>lpData</i></dt>
<dd>
Pointer to the resource data to be inserted into the executable file. If the resource is one of the predefined types, the data must be valid and properly aligned. Note that this is the raw binary data stored in the executable file, not the data provided by <a href="icons_799r.htm"><b>LoadIcon</b></a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_loadstring">
</object><a href=JavaScript:alink_2.Click()><b>LoadString</b></a>, or other resource-specific load functions. All data containing strings or text must be in Unicode format; <i>lpData</i> must not point to ANSI data. 
<p>
If <i>lpData</i> is NULL, the specified resource is deleted from the executable file. 
</dd>
<dt>
<i>cbData</i></dt>
<dd>
Specifies the size, in bytes, of the resource data at <i>lpData</i>. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_3.Click()><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
An application can use <b>UpdateResource</b> repeatedly to make changes to the resource data. Each call to <b>UpdateResource</b> contributes to an internal list of additions, deletions, and replacements but does not actually write the data to the executable file. The application must use the <b>EndUpdateResource</b> function to write the accumulated changes to the executable file. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winbase.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use kernel32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="resource_0jsj.htm">Resources Overview</a>, <a href="resource_69o3.htm">Resource Functions</a>, <a href="resource_5g2t.htm"><b>BeginUpdateResource</b></a>, <a href="resource_9qcl.htm"><b>EndUpdateResource</b></a>, <a href="icons_799r.htm"><b>LoadIcon</b></a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_loadstring">
</object><a href=JavaScript:alink_4.Click()><b>LoadString</b></a>, <a href="resource_4co5.htm"><b>LockResource</b></a>, <a href="resource_2dd1.htm"><b>MAKEINTRESOURCE</b></a>, <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_makelangid">
</object><a href=JavaScript:alink_5.Click()><b>MAKELANGID</b></a>, <a href="resource_38yt.htm"><b>SizeofResource</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
