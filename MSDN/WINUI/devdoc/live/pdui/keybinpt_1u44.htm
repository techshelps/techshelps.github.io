<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LoadKeyboardLayout</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_loadkeyboardlayout"></a>LoadKeyboardLayout</h1>
<p>
The <b>LoadKeyboardLayout</b> function loads a new keyboard layout into the system. Several keyboard layouts can be loaded at a time, but only one per process is active at a time. Loading multiple keyboard layouts makes it possible to rapidly switch between layouts.</p>
<pre><code><b>HKL LoadKeyboardLayout(
  LPCTSTR</b><i> pwszKLID</i><b>,  </b>// name of layout to load
<b>  UINT</b><i> Flags</i>         // keyboard layout flags
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pwszKLID</i></dt>
<dd>
Pointer to the buffer that specifies the name of the keyboard layout to load. This name is a string composed of the hexadecimal value of the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_language_identifiers">
</object><a href=JavaScript:alink_1.Click()>language identifier</a> (low word) and a device identifier (high word). For example, U.S. English has a language identifier of 0x0409, so the primary U.S. English layout is named "00000409". Variants of U.S. English layout (such as the Dvorak layout) are named "00010409", "00020409", and so on. </dd>
<dt>
<i>Flags</i></dt>
<dd>
Specifies how the keyboard layout is to be loaded. This parameter can be one of the following values. 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=41%>Value</th>
<th align=left width=59%>Meaning</th>
</tr>
<tr valign=top>
<td width=41%>KLF_ACTIVATE</td>
<td width=59%>If the specified layout is not already loaded, the function loads and activates the layout for the current thread.</td>
</tr>
<tr valign=top>
<td width=41%>KLF_NOTELLSHELL</td>
<td width=59%>Prevents a <b>ShellProc</b> hook procedure from receiving an HSHELL_LANGUAGE hook code when the new layout is loaded. This value is typically used when an application loads multiple layouts one after another. Applying this value to all but the last layout delays the shell's processing until all layouts have been added.</td>
</tr>
<tr valign=top>
<td width=41%>KLF_REORDER</td>
<td width=59%>Moves the specified layout to the head of the keyboard layouts list, making that layout the active layout for the current thread. This value reorders the keyboard layouts list even if KLF_ACTIVATE is not provided.</td>
</tr>
<tr valign=top>
<td width=41%>KLF_REPLACELANG</td>
<td width=59%><b>Windows NT 4.0, Windows 95, and later: </b>If the new layout has the same language identifier as a current layout, the new layout replaces the current one as the layout for that language. If this value is not provided and the layouts have the same language identifiers, the current layout is not replaced and the function returns NULL. </td>
</tr>
<tr valign=top>
<td width=41%>KLF_SUBSTITUTE_OK</td>
<td width=59%>Substitutes the specified keyboard layout with another layout preferred by the user. The system starts with this flag set, and it is recommended that your application always use this flag. The substitution occurs only if the registry key <b>HKEY_CURRENT_USER\Keyboard Layout\Substitutes</b> explicitly defines a substitution layout. For example, if the key includes the value name "00000409" with value "00010409", loading the U.S. English layout ("00000409") causes the Dvorak U.S. English layout ("00010409") to be loaded instead. The system uses KLF_SUBSTITUTE_OK when booting, and it is recommended that all applications use this value when loading layouts to ensure that the user's preference is selected.</td>
</tr>
<tr valign=top>
<td width=41%>KLF_SETFORPROCESS</td>
<td width=59%><b>Windows NT 5.0 and later:</b>: This flag is valid only with KLF_ACTIVATE. Activates the specified keyboard layout for the entire process and sends the WM_INPUTLANGCHANGE message to all threads in the current process. Typically, <b>LoadKeyboardLayout</b> activates a layout only for the current thread.</td>
</tr>
<tr valign=top>
<td width=41%>KLF_UNLOADPREVIOUS</td>
<td width=59%><b>Unsupported in Windows NT 5.0, Windows 95, and Windows 98: </b>This flag is only valid with KLF_ACTIVATE. Unloads the previous layout only if loading and activating the specified layout succeeds. It is recommended that your application use the <b>UnloadKeyboardLayout</b> function instead.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the keyboard layout handle to the layout matched with the requested name. If no matching keyboard layout is available, the return value is NULL. To get extended error information, call <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_2.Click()><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
An application can and will typically load the default layout or IME for a language and can do so by specifying only a string version of the language identifier. If an application wants to load a specific layout or IME, it should read the registry to determine the specific layout identifier to pass to <b>LoadKeyboardLayout</b>. In this case, a request to activate the default keyboard layout handle for a locale will activate the first matching one. A specific IME should be activated using an explicit keyboard layout handle returned from <b>GetKeyboardLayout</b>, <b>GetKeyboardLayoutList</b>, or <b>LoadKeyboardLayout</b>.</p>
<p>
<b>Windows 95 and Windows 98:</b> If a layout is to be loaded with the same language as a previously loaded layout and the KLF_REPLACELANG flag is <i>not</i> set, the call fails. Only one loaded layout may be associated with a given language. (It is acceptable for multiple IMEs to be loaded with associations to the same language.)</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winuser.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="keybinpt_4l9w.htm">Keyboard Input Overview</a>, <a href="keybinpt_43jn.htm">Keyboard Input Functions</a>, <a href="keybinpt_0alw.htm"><b>ActivateKeyboardLayout</b></a>, <a href="keybinpt_3mp1.htm"><b>GetKeyboardLayoutName</b></a>, <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_makelangid">
</object><a href=JavaScript:alink_3.Click()><b>MAKELANGID</b></a>,<b> <a href="keybinpt_17zo.htm">UnloadKeyboardLayout</a></b> </p>
<p>&nbsp;</p></body>
</HTML>
