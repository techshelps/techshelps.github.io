<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Current Selection in a Rich Edit Control</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_current_selection_in_a_rich_edit_control"></a>Current Selection in a Rich Edit Control</h2>
<p>
The user can select text in a rich edit control by using the mouse or the keyboard. The <i>current selection</i> is the range of selected characters, or the position of the insertion point if no characters are selected. An application can get information about the current selection, set the current selection, determine when the current selection changes, and show or hide the selection highlight.</p>
<p>
To determine the current selection in a rich edit control, use the <a href="richedit_2ca4.htm">EM_EXGETSEL</a> message. To set the current selection, use the <a href="richedit_0i7g.htm">EM_EXSETSEL</a> message. The <a href="richedit_2836.htm"><b>CHARRANGE</b></a> structure is used with both messages and specifies a range of characters. To retrieve information about the contents of the current selection, you can use the <a href="richedit_2yxx.htm">EM_SELECTIONTYPE</a> message.</p>
<p>
An application can detect when the current selection changes by processing the <a href="richedit_93tx.htm">EN_SELCHANGE</a> notification message. The notification message specifies a <a href="richedit_235e.htm"><b>SELCHANGE</b></a> structure containing information about the new selection. A rich edit control sends this notification message only if you enable it by using the <a href="richedit_2p7v.htm">EM_SETEVENTMASK</a> message.</p>
<p>
By default, a rich edit control shows and hides the selection highlight when it gains and loses the focus. You can show or hide the selection highlight at any time by using the <a href="richedit_0mr2.htm">EM_HIDESELECTION</a> message. For example, an application might provide a Search dialog box to find text in a rich edit control. The application might select matching text without closing the dialog box, in which case it must use the EM_HIDESELECTION message to highlight the selection.</p>
<p>
As with edit controls, you can specify the ES_NOHIDESEL window style to prevent a rich edit control from hiding the selection highlight when it loses the focus. You can also use the EM_HIDESELECTION message to change the ES_NOHIDESEL window style after a rich edit control is created.</p>
<p>
Instead of using the <a href="richedit_2ca4.htm">EM_EXGETSEL</a> and <a href="richedit_0i7g.htm">EM_EXSETSEL</a> messages, you retrieve and set the current selection by using the <a href="editcon_6ap8.htm">EM_GETSEL</a> and <a href="editcon_4gmk.htm">EM_SETSEL</a> edit control messages. The EM_GETSEL message packs two 16-bit character indexes into its 32-bit return value and, therefore, works only for selections that fall entirely within the first 64K. However, a rich edit control will never contain more than 32K of text, unless you extend this limit by using the <a href="richedit_4ktw.htm">EM_EXLIMITTEXT</a> message. For selections that extend beyond the first 64K of text, the EM_GETSEL message returns  – 1. </p>
<p>&nbsp;</p></body>
</HTML>
