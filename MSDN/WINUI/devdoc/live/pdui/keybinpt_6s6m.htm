<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OemKeyScan</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_oemkeyscan"></a>OemKeyScan</h1>
<p>
The <b>OemKeyScan</b> function maps OEM ASCII codes 0 through 0x0FF into the OEM scan codes and shift states. The function provides information that allows a program to send OEM text to another program by simulating keyboard input. </p>
<pre><code><b>DWORD OemKeyScan(
  WORD</b><i> wOemChar</i>   // ASCII value of OEM character
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>wOemChar</i></dt>
<dd>
Specifies the ASCII value of the OEM character. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
The low-order word of the return value contains the scan code of the given OEM character, and the high-order word contains the shift state, which can be a combination of the following flag bits. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=9%>Bit</th>
<th align=left width=91%>Meaning</th>
</tr>
<tr valign=top>
<td width=9%>1</td>
<td width=91%>Either shift key is pressed.</td>
</tr>
<tr valign=top>
<td width=9%>2</td>
<td width=91%>Either ctrl key is pressed.</td>
</tr>
<tr valign=top>
<td width=9%>4</td>
<td width=91%>Either alt key is pressed.</td>
</tr>
<tr valign=top>
<td width=9%>8</td>
<td width=91%>The Hankaku key is pressed</td>
</tr>
<tr valign=top>
<td width=9%>16</td>
<td width=91%>Reserved (defined by the keyboard layout driver).</td>
</tr>
<tr valign=top>
<td width=9%>32</td>
<td width=91%>Reserved (defined by the keyboard layout driver).</td>
</tr>
</table><br>
<p>
If the character cannot be produced by a single keystroke using the current keyboard layout, the return value is 0xFFFFFFFF. </p>
<h4>Remarks</h4>
<p>
This function does not provide translations for characters that require ctrl+alt or dead keys. Characters not translated by this function must be copied by simulating input using the alt+ keypad mechanism. The numlock key must be off. </p>
<p>
This function does not provide translations for characters that cannot be typed with one keystroke using the current keyboard layout, such as characters with diacritics requiring dead keys. Characters not translated by this function may be simulated using the alt+ keypad mechanism. The numlock key must be on. </p>
<p>
This function is implemented using the <b>VkKeyScan</b> function. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winuser.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.</p>
<h4>See Also</h4>
<p>
<a href="keybinpt_4l9w.htm">Keyboard Input Overview</a>, <a href="keybinpt_43jn.htm">Keyboard Input Functions</a>, <a href="keybinpt_897y.htm"><b>VkKeyScan</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
