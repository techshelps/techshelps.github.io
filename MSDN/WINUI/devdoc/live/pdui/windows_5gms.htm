<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetWindowText</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_getwindowtext"></a>GetWindowText</h1>
<p>
The <b>GetWindowText</b> function copies the text of the specified window's title bar (if it has one) into a buffer. If the specified window is a control, the text of the control is copied. However, <b>GetWindowText</b> cannot retrieve the text of a control in another application.</p>
<pre><code><b>int GetWindowText(
  HWND</b><i> hWnd</i><b>,        </b>// handle to window or control with text
<b>  LPTSTR</b><i> lpString</i><b>,  </b>// address of buffer for text
<b>  int</b><i> nMaxCount</i>     // maximum number of characters to copy
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hWnd</i></dt>
<dd>
Handle to the window or control containing the text. </dd>
<dt>
<i>lpString</i></dt>
<dd>
Pointer to the buffer that will receive the text. </dd>
<dt>
<i>nMaxCount</i></dt>
<dd>
Specifies the maximum number of characters to copy to the buffer, including the NULL character. If the text exceeds this limit, it is truncated. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the length, in characters, of the copied string, not including the terminating null character. If the window has no title bar or text, if the title bar is empty, or if the window or control handle is invalid, the return value is zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. </p>
<p>
This function cannot retrieve the text of an edit control in another application.</p>
<h4>Remarks</h4>
<p>
If the target window is owned by the current process, <b>GetWindowText</b> causes a <a href="windows_34ok.htm">WM_GETTEXT</a> message to be sent to the specified window or control. If the target window is owned by another process and has a caption, <b>GetWindowText</b> retrieves the window caption text. If the window does not have a caption, the return value is a null string. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winuser.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="windows_6t2r.htm">Windows Overview</a>, <a href="windows_8qyb.htm">Window Functions</a>, <a href="windows_0294.htm"><b>GetWindowTextLength</b></a>, <a href="windows_07w4.htm"><b>SetWindowText</b></a>, <a href="windows_34ok.htm">WM_GETTEXT</a> </p>
<p>&nbsp;</p></body>
</HTML>
