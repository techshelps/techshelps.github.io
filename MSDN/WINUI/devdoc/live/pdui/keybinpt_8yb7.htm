<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetFocus</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_setfocus"></a>SetFocus</h1>
<p>
The <b>SetFocus</b> function sets the keyboard focus to the specified window. The window must be associated with the calling thread's message queue. </p>
<pre><code><b>HWND SetFocus(
  HWND</b><i> hWnd</i>   // handle to window to receive focus
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hWnd</i></dt>
<dd>
Handle to the window that will receive the keyboard input. If this parameter is NULL, keystrokes are ignored. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the handle to the window that previously had the keyboard focus. If the <i>hWnd</i> parameter is invalid or the window is not associated with the calling thread's message queue, the return value is NULL. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
The <b>SetFocus</b> function sends a WM_KILLFOCUS message to the window that loses the keyboard focus and a WM_SETFOCUS message to the window that receives the keyboard focus. It also activates either the window that receives the focus or the parent of the window that receives the focus. </p>
<p>
If a window is active but does not have the focus, any key pressed will produce the WM_SYSCHAR, WM_SYSKEYDOWN, or WM_SYSKEYUP message. If the VK_MENU key is also pressed, the <i>lParam</i> parameter of the message will have bit 30 set. Otherwise, the messages produced do not have this bit set. </p>
<p>
By using the <b>AttachThreadInput</b> function, a thread can attach its input processing to another thread. This allows a thread to call <b>SetFocus</b> to set the keyboard focus to a window associated with another thread's message queue. </p>
<p>
<b>Windows CE:</b> Do not use the <b>SetFocus</b> function to set the keyboard focus to a window associated with another thread's message queue. There is one exception. If a window on one thread is the child of the window on the other thread, or if the windows are siblings of the same parent, the thread associated with one window can set the focus to the other window even though it belongs to a different thread. In this case, there is no need to call <b>AttachThreadInput</b> first.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winuser.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.</p>
<h4>See Also</h4>
<p>
<a href="keybinpt_4l9w.htm">Keyboard Input Overview</a>, <a href="keybinpt_43jn.htm">Keyboard Input Functions</a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_attachthreadinput">
</object><a href=JavaScript:alink_2.Click()><b>AttachThreadInput</b></a>, <a href="keybinpt_6ppv.htm"><b>GetFocus</b></a>, <a href="keybinpt_9sc3.htm">WM_KILLFOCUS</a>, <a href="keybinpt_2ldf.htm">WM_SETFOCUS</a>, <a href="keybacel_125u.htm">WM_SYSCHAR</a>, <a href="keybinpt_1yjy.htm">WM_SYSKEYDOWN</a>, <a href="keybinpt_9upc.htm">WM_SYSKEYUP</a> </p>
<p>&nbsp;</p></body>
</HTML>
