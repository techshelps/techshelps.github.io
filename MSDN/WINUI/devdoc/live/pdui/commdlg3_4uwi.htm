<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FINDREPLACE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_findreplace_str"></a>FINDREPLACE</h1>
<p>
The <b>FINDREPLACE</b> structure contains information that the <a href="commdlg3_91is.htm"><b>FindText</b></a> and <a href="commdlg3_07as.htm"><b>ReplaceText</b></a> functions use to initialize the <b>Find</b> and <b>Replace</b> common dialog boxes. The <a href="commdlg3_1y07.htm">FINDMSGSTRING</a> registered message uses this structure to pass the user's search or replacement input to the owner window of a <b>Find</b> or <b>Replace</b> common dialog box.</p>
<pre><code>typedef struct {    // fr 
    DWORD        lStructSize; 
    HWND         hwndOwner; 
    HINSTANCE    hInstance; 
    DWORD        Flags; 
    LPTSTR        lpstrFindWhat; 
    LPTSTR        lpstrReplaceWith; 
    WORD         wFindWhatLen; 
    WORD         wReplaceWithLen; 
    LPARAM        lCustData; 
    LPFRHOOKPROC lpfnHook; 
    LPCTSTR       lpTemplateName; 
} FINDREPLACE; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>lStructSize</b></dt>
<dd>
Specifies the length, in bytes, of the structure. </dd>
<dt>
<b>hwndOwner</b></dt>
<dd>
Identifies the window that owns the dialog box. The window procedure of the specified window receives FINDMSGSTRING messages from the dialog box. This member can be any valid window handle, but it must not be NULL. </dd>
<dt>
<b>hInstance</b></dt>
<dd>
If the FR_ENABLETEMPLATEHANDLE flag is set in the <b>Flags</b> member, <b>hInstance</b> is the handle of a memory object containing a dialog box template. If the FR_ENABLETEMPLATE flag is set, <b>hInstance</b> identifies a module that contains a dialog box template named by the <b>lpTemplateName</b> member. If neither flag is set, this member is ignored.</dd>
<dt>
<b>Flags</b></dt>
<dd>
A set of bit flags that you can use to initialize the dialog box. The dialog box sets these flags when it sends the FINDMSGSTRING registered message to indicate the user's input. This member can be a combination of the following flags: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=16%>Flag</th>
<th align=left width=84%>Meaning</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_DIALOGTERM</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>If set in a FINDMSGSTRING message, indicates that the dialog box is closing. When you receive a message with this flag set, the dialog box window handle returned by the <a href="commdlg3_91is.htm"><b>FindText</b></a> or <a href="commdlg3_07as.htm"><b>ReplaceText</b></a> function is no longer valid.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_DOWN</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>If set, the <b>Down</b> button of the direction radio buttons in a <b>Find</b> dialog box is selected indicating that you should search from the current location to the end of the document. If not set, the <b>Up</b> button is selected so you should search to the beginning of the document. You can set this flag to initialize the dialog box. If set in a FINDMSGSTRING message, indicates the user's selection.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_ENABLEHOOK</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>Enables the hook function specified in the <b>lpfnHook</b> member. This flag is used only to initialize the dialog box.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_ENABLETEMPLATE</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>Indicates that the <b>hInstance</b> and <b>lpTemplateName</b> members specify a dialog box template to use in place of the default template. This flag is used only to initialize the dialog box.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_ENABLETEMPLATEHANDLE</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>Indicates that the <b>hInstance</b> member identifies a data block that contains a preloaded dialog box template. The system ignores the <b>lpTemplateName</b> member if this flag is specified.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_FINDNEXT</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>If set in a FINDMSGSTRING message, indicates that the user clicked the <b>Find</b> <b>Next</b> button in a <b>Find</b> or <b>Replace</b> dialog box. The <b>lpstrFindWhat</b> member specifies the string to search for.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_HIDEUPDOWN</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>If set when initializing a <b>Find</b> dialog box, hides the search direction radio buttons.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_HIDEMATCHCASE</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>If set when initializing a <b>Find</b> or <b>Replace</b> dialog box, hides the <b>Match</b> <b>Case</b> check box.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_HIDEWHOLEWORD</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>If set when initializing a <b>Find</b> or <b>Replace</b> dialog box, hides the <b>Match</b> <b>Whole</b> <b>Word</b> <b>Only</b> check box.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_MATCHCASE</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>If set, the <b>Match</b> <b>Case</b> check box is checked indicating that the search should be case-sensitive. If not set, the check box is unchecked so the search should be case-insensitive. You can set this flag to initialize the dialog box. If set in a FINDMSGSTRING message, indicates the user's selection.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_NOMATCHCASE</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>If set when initializing a <b>Find</b> or <b>Replace</b> dialog box, disables the <b>Match</b> <b>Case</b> check box.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_NOUPDOWN</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>If set when initializing a <b>Find</b> dialog box, disables the search direction radio buttons.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_NOWHOLEWORD</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>If set when initializing a <b>Find</b> or <b>Replace</b> dialog box, disables the <b>Whole</b> <b>Word</b> check box.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_REPLACE</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>If set in a FINDMSGSTRING message, indicates that the user clicked the <b>Replace</b> button in a <b>Replace</b> dialog box. The <b>lpstrFindWhat</b> member specifies the string to be replaced and the <b>lpstrReplaceWith</b> member specifies the replacement string.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_REPLACEALL</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>If set in a FINDMSGSTRING message, indicates that the user clicked the <b>Replace</b> <b>All</b> button in a <b>Replace</b> dialog box. The <b>lpstrFindWhat</b> member specifies the string to be replaced and the <b>lpstrReplaceWith</b> member specifies the replacement string.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_SHOWHELP</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>Causes the dialog box to display the <b>Help</b> button. The <b>hwndOwner</b> member must specify the window to receive the <a href="commdlg3_9d2f.htm">HELPMSGSTRING</a> registered messages that the dialog box sends when the user clicks the <b>Help</b> button.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>FR_WHOLEWORD</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=84%>If set, the <b>Match</b> <b>Whole</b> <b>Word</b> <b>Only</b> check box is checked indicating that you should search only for whole words that match the search string. If not set, the check box is unchecked so you should also search for word fragments that match the search string. You can set this flag to initialize the dialog box. If set in a FINDMSGSTRING message, indicates the user's selection.</td>
</tr>
</table><br>

</dd>
<dt>
<b>lpstrFindWhat</b></dt>
<dd>
Pointer to a buffer that a <a href="commdlg3_1y07.htm">FINDMSGSTRING</a> message uses to pass the null terminated search string that the user typed in the <b>Find</b> <b>What</b> edit control. You must dynamically allocate the buffer or use a global or static array so it does not go out of scope before the dialog box closes. The buffer should be at least 80 characters long. If the buffer contains a string when you initialize the dialog box, the string is displayed in the <b>Find</b> <b>What</b> edit control. 
<p>
If a FINDMSGSTRING message specifies the FR_FINDNEXT flag, <b>lpstrFindWhat</b> contains the string to search for. The FR_DOWN, FR_WHOLEWORD, and FR_MATCHCASE flags indicate the direction and type of search. If a FINDMSGSTRING message specifies the FR_REPLACE or FR_REPLACE flags, <b>lpstrFindWhat</b> contains the string to be replaced. 
</dd>
<dt>
<b>lpstrReplaceWith</b></dt>
<dd>
Pointer to a buffer that a FINDMSGSTRING message uses to pass the null terminated replacement string that the user typed in the <b>Replace</b> <b>With</b> edit control. You must dynamically allocate the buffer or use a global or static array so it does not go out of scope before the dialog box closes. If the buffer contains a string when you initialize the dialog box, the string is displayed in the <b>Replace</b> <b>With</b> edit control. 
<p>
If a FINDMSGSTRING message specifies the FR_REPLACE or FR_REPLACEALL flags, <b>lpstrReplaceWith</b> contains the replacement string . 

<p>
The <a href="commdlg3_91is.htm"><b>FindText</b></a> function ignores this member. 
</dd>
<dt>
<b>wFindWhatLen</b></dt>
<dd>
Specifies the length, in bytes, of the buffer pointed to by the <b>lpstrFindWhat</b> member. </dd>
<dt>
<b>wReplaceWithLen</b></dt>
<dd>
Specifies the length, in bytes, of the buffer pointed to by the <b>lpstrReplaceWith</b> member. </dd>
<dt>
<b>lCustData</b></dt>
<dd>
Specifies application-defined data that the system passes to the hook procedure identified by the <b>lpfnHook</b> member. When the system sends the <a href="dlgboxes_4n1j.htm">WM_INITDIALOG</a> message to the hook procedure, the message's <i>lParam</i> parameter is a pointer to the <b>FINDREPLACE</b> structure specified when the dialog was created. The hook procedure can use this pointer to get the <b>lCustData</b> value.</dd>
<dt>
<b>lpfnHook</b></dt>
<dd>
Pointer to an <b>FRHookProc</b> hook procedure that can process messages intended for the dialog box. This member is ignored unless the FR_ENABLEHOOK flag is set in the <b>Flags</b> member. 
<p>
If the hook procedure returns FALSE in response to the WM_INITDIALOG message, the hook procedure must display the dialog box or else the dialog box will not be shown. To do this, first perform any other paint operations, and then call the <b>ShowWindow</b> and <b>UpdateWindow</b> functions.
</dd>
<dt>
<b>lpTemplateName</b></dt>
<dd>
Pointer to a null-terminated string that names the dialog box template resource in the module identified by the <b>hInstance</b> member. This template is substituted for the standard dialog box template. For numbered dialog box resources, this can be a value returned by the <b>MAKEINTRESOURCE</b> macro. This member is ignored unless the FR_ENABLETEMPLATE flag is set in the <b>Flags</b> member.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in commdlg.h.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined as Unicode and ANSI structures.</p>
<h4>See Also</h4>
<p>
<a href="commdlg3_04ft.htm">Common Dialog Box Library Overview</a>, <a href="commdlg3_2xir.htm">Common Dialog Box Structures</a>, <a href="commdlg3_91is.htm"><b>FindText</b></a>, <a href="commdlg3_1n6r.htm"><b>FRHookProc</b></a>, <a href="resource_2dd1.htm"><b>MAKEINTRESOURCE</b></a>, <a href="commdlg3_07as.htm"><b>ReplaceText</b></a>, <a href="windows_2tdj.htm"><b>ShowWindow</b></a>, <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_updatewindow">
</object><a href=JavaScript:alink_1.Click()><b>UpdateWindow</b></a>, <a href="dlgboxes_4n1j.htm">WM_INITDIALOG</a> </p>
<p>&nbsp;</p></body>
</HTML>
