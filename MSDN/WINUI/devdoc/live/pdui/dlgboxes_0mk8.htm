<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MessageBoxEx</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_messageboxex"></a>MessageBoxEx</h1>
<p>
The <b>MessageBoxEx</b> function creates, displays, and operates a message box. The message box contains an application-defined message and title, plus any combination of predefined icons and push buttons. The <i>wLanguageId</i> parameter specifies which set of language resources is used for the predefined push buttons. For full descriptions of the other parameters of <b>MessageBoxEx</b>, see <a href="dlgboxes_76bc.htm"><b>MessageBox</b></a>. </p>
<pre><code><b>int MessageBoxEx(
  HWND</b><i> hWnd</i><b>,         </b>// handle of owner window
<b>  LPCTSTR</b><i> lpText</i><b>,    </b>// address of text in message box
<b>  LPCTSTR</b><i> lpCaption</i><b>, </b>// address of title of message box
<b>  UINT</b><i> uType</i><b>,        </b>// style of message box
<b>  WORD</b><i> wLanguageId</i>   // language identifier
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hWnd</i></dt>
<dd>
Identifies the owner window of the message box to be created. If this parameter is NULL, the message box has no owner window. </dd>
<dt>
<i>lpCaption</i></dt>
<dd>
Pointer to a null-terminated string containing the message to be displayed. </dd>
<dt>
<i>lpszTitle</i></dt>
<dd>
Pointer to a null-terminated string used for the dialog box title. If this parameter is NULL, the default title Error is used. </dd>
<dt>
<i>uType</i></dt>
<dd>
Specifies a set of bit flags that determine the contents and behavior of the dialog box. This parameter can be a combination of flags from the following groups of flags. 
<p>
Specify one of the following flags to indicate the buttons contained in the message box:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=40%>Flag</th>
<th align=left width=60%>Meaning</th>
</tr>
<tr valign=top>
<td width=40%>MB_ABORTRETRYIGNORE</td>
<td width=60%>The message box contains three push buttons: Abort, Retry, and Ignore.</td>
</tr>
<tr valign=top>
<td width=40%>MB_OK</td>
<td width=60%>The message box contains one push button: OK. This is the default.</td>
</tr>
<tr valign=top>
<td width=40%>MB_OKCANCEL</td>
<td width=60%>The message box contains two push buttons: OK and Cancel.</td>
</tr>
<tr valign=top>
<td width=40%>MB_RETRYCANCEL</td>
<td width=60%>The message box contains two push buttons: Retry and Cancel.</td>
</tr>
<tr valign=top>
<td width=40%>MB_YESNO</td>
<td width=60%>The message box contains two push buttons: Yes and No.</td>
</tr>
<tr valign=top>
<td width=40%>MB_YESNOCANCEL</td>
<td width=60%>The message box contains three push buttons: Yes, No, and Cancel.</td>
</tr>
</table><br>


<p>
Specify one of the following flags to display an icon in the message box:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=37%>Flag</th>
<th align=left width=63%>Meaning</th>
</tr>
<tr valign=top>
<td width=37%>MB_ICONEXCLAMATION, <br>
MB_ICONWARNING<br>
</td>
<td width=63%>An exclamation-point icon appears in the message box.</td>
</tr>
<tr valign=top>
<td width=37%>MB_ICONINFORMATION, MB_ICONASTERISK<br>
</td>
<td width=63%>An icon consisting of a lowercase letter <i>i</i> in a circle appears in the message box.</td>
</tr>
<tr valign=top>
<td width=37%>MB_ICONQUESTION</td>
<td width=63%>A question-mark icon appears in the message box.</td>
</tr>
<tr valign=top>
<td width=37%>MB_ICONSTOP, <br>
MB_ICONERROR, <br>
MB_ICONHAND<br>
</td>
<td width=63%>A stop-sign icon appears in the message box.</td>
</tr>
</table><br>


<p>
Specify one of the following flags to indicate the default button:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=37%>Flag</th>
<th align=left width=63%>Meaning</th>
</tr>
<tr valign=top>
<td width=37%>MB_DEFBUTTON1</td>
<td width=63%>The first button is the default button. <p>
MB_DEFBUTTON1 is the default unless MB_DEFBUTTON2, MB_DEFBUTTON3, or MB_DEFBUTTON4 is specified.</p>
</td>
</tr>
<tr valign=top>
<td width=37%>MB_DEFBUTTON2</td>
<td width=63%>The second button is the default button.</td>
</tr>
<tr valign=top>
<td width=37%>MB_DEFBUTTON3</td>
<td width=63%>The third button is the default button.</td>
</tr>
<tr valign=top>
<td width=37%>MB_DEFBUTTON4</td>
<td width=63%>The fourth button is the default button.</td>
</tr>
</table><br>


<p>
Specify one of the following flags to indicate the modality of the dialog box:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=37%>Flag</th>
<th align=left width=63%>Meaning</th>
</tr>
<tr valign=top>
<td width=37%>MB_APPLMODAL</td>
<td width=63%>The user must respond to the message box before continuing work in the window identified by the <i>hWnd</i> parameter. However, the user can move to the windows of other threads and work in those windows. <p>
Depending on the hierarchy of windows in the application, the user may be able to move to other windows within the thread. All child windows of the parent of the message box are automatically disabled, but popup windows are not.</p>
<p>
MB_APPLMODAL is the default if neither MB_SYSTEMMODAL nor MB_TASKMODAL is specified.</p>
</td>
</tr>
<tr valign=top>
<td width=37%>MB_SYSTEMMODAL</td>
<td width=63%>Same as MB_APPLMODAL except that the message box has the WS_EX_TOPMOST style. Use system-modal message boxes to notify the user of serious, potentially damaging errors that require immediate attention (for example, running out of memory). This flag has no effect on the user's ability to interact with windows other than those associated with <i>hWnd</i>.</td>
</tr>
<tr valign=top>
<td width=37%>MB_TASKMODAL</td>
<td width=63%>Same as MB_APPLMODAL except that all the top-level windows belonging to the current thread are disabled if the <i>hWnd</i> parameter is NULL. Use this flag when the calling application or library does not have a window handle available but still needs to prevent input to other windows in the calling thread without suspending other threads.</td>
</tr>
</table><br>


<p>
In addition, you can specify the following flags: 

<dl>
<dt>
MB_DEFAULT_DESKTOP_ONLY</dt>
<dd>
The desktop currently receiving input must be a default desktop; otherwise, the function fails. A default desktop is one an application runs on after the user has logged on.</dd>
<dt>
MB_HELP</dt>
<dd>
Adds a Help button to the message box. Choosing the Help button or pressing F1 generates a Help event.</dd>
<dt>
MB_RIGHT</dt>
<dd>
The text is right-justified.</dd>
<dt>
MB_RTLREADING</dt>
<dd>
Displays message and caption text using right-to-left reading order on Hebrew and Arabic systems. </dd>
<dt>
MB_SETFOREGROUND</dt>
<dd>
The message box becomes the foreground window. Internally, the system calls the <a href="windows_1eev.htm"><b>SetForegroundWindow</b></a> function for the message box.</dd>
<dt>
MB_TOPMOST</dt>
<dd>
The message box is created with the WS_EX_TOPMOST window style.</dd>
<dt>
MB_SERVICE_NOTIFICATION</dt>
<dd>
<b>Windows NT:</b> The caller is a service notifying the user of an event. The function displays a message box on the current active desktop, even if there is no user logged on to the computer.
<p>
If this flag is set, the <i>hWnd</i> parameter must be NULL. This is so the message box can appear on a desktop other than the desktop corresponding to the <i>hWnd</i>.

<p>
For Windows NT version 4.0, the value of MB_SERVICE_NOTIFICATION has changed. See WINUSER.H for the old and new values. Windows NT 4.0 provides backward compatibility for pre-existing services by mapping the old value to the new value in the implementation of <b>MessageBox</b> and <b>MessageBoxEx</b>. This mapping is only done for executables that have a version number, as set by the linker, less than 4.0.

<p>
To build a service that uses MB_SERVICE_NOTIFICATION, and can run on both Windows NT 3.x and Windows NT 4.0, you have two choices.

<table cellspacing=4 cols=1>
<tr valign=top>
<td width=100%><ol>
<li>
At link-time, specify a version number less than 4.0; or</li>
</ol>
</td>
</tr>
<tr valign=top>
<td width=100%>&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;&nbsp;&nbsp;&nbsp;At link-time, specify version 4.0. At run-time, use the <b>GetVersionEx</b> function to check the system version. Then when running on Windows NT 3.x, use MB_SERVICE_NOTIFICATION_NT3X; and on Windows NT 4.0, use MB_SERVICE_NOTIFICATION. </td>
</tr>
</table><br>

</dd>
<dt>
MB_SERVICE_NOTIFICATION_NT3X</dt>
<dd>
<b>Windows NT:</b> This value corresponds to the value defined for MB_SERVICE_NOTIFICATION for Windows NT version 3.51. </dd>
</dl>
</dd>
<dt>
<i>wLanguageId</i></dt>
<dd>
Specifies the language in which to display the text contained in the predefined push buttons. This value must be in the form returned by the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_makelangid">
</object><a href=JavaScript:alink_1.Click()><b>MAKELANGID</b></a> macro. 
<p>
For a list of the language identifiers supported by Win32, see <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_language_identifiers">
</object><a href=JavaScript:alink_2.Click()>Language Identifiers</a>. Note that each localized release of Windows and Windows NT typically contains resources only for a limited set of languages. Thus, for example, the U.S. version offers LANG_ENGLISH, the French version offers LANG_FRENCH, the German version offers LANG_GERMAN, and the Japanese version offers LANG_JAPANESE. Each version offers LANG_NEUTRAL. This limits the set of values that can be used with the <i>wLanguageId</i> parameter. Before specifying a language identifier, you should enumerate the locales that are installed on a system. 

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a nonzero menu-item value returned by the dialog box. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=19%>Value</th>
<th align=left width=81%>Meaning</th>
</tr>
<tr valign=top>
<td width=19%>IDABORT</td>
<td width=81%>Abort button was selected.</td>
</tr>
<tr valign=top>
<td width=19%>IDCANCEL</td>
<td width=81%>Cancel button was selected.</td>
</tr>
<tr valign=top>
<td width=19%>IDIGNORE</td>
<td width=81%>Ignore button was selected.</td>
</tr>
<tr valign=top>
<td width=19%>IDNO</td>
<td width=81%>No button was selected.</td>
</tr>
<tr valign=top>
<td width=19%>IDOK</td>
<td width=81%>OK button was selected.</td>
</tr>
<tr valign=top>
<td width=19%>IDRETRY</td>
<td width=81%>Retry button was selected.</td>
</tr>
<tr valign=top>
<td width=19%>IDYES</td>
<td width=81%>Yes button was selected.</td>
</tr>
</table><br>
<p>
If a message box has a Cancel button, the function returns the IDCANCEL value when either the esc key or Cancel button is pressed. If the message box has no Cancel button, pressing the esc key has no effect. </p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_3.Click()><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
When you create a system-modal message box to indicate that the system is low on memory, the strings passed as the <i>lpText</i> and <i>lpCaption</i> parameters should not be taken from a resource file, because an attempt to load the resource may fail. </p>
<p>
When an application calls the <b>MessageBoxEx</b> function and specifies the MB_ICONHAND and MB_SYSTEMMODAL flags for the <i>uType</i> parameter, the Win32 API displays the resulting message box regardless of available memory. When you specify these flags, the system limits the length of the message-box text to one line. </p>
<p>
If you create a message box while a dialog box is present, use the handle of the dialog box as the <i>hWnd</i> parameter. The <i>hWnd</i> parameter should not identify a child window, such as a dialog box. </p>
<p>
<b>Windows 95: </b>The system can support a maximum of 16,364 window handles.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winuser.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows and Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="dlgboxes_7foz.htm">Dialog Boxes Overview</a>, <a href="dlgboxes_0voz.htm">Dialog Box Functions</a>, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_makelangid">
</object><a href=JavaScript:alink_4.Click()><b>MAKELANGID</b></a>, <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_messagebeep">
</object><a href=JavaScript:alink_5.Click()><b>MessageBeep</b></a>,<b> <a href="dlgboxes_76bc.htm">MessageBox</a></b>, <a href="dlgboxes_0gxg.htm"><b>MessageBoxIndirect</b></a>, <a href="windows_1eev.htm"><b>SetForegroundWindow</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
