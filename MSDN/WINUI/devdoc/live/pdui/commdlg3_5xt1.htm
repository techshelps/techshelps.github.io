<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Opening a File</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_opening_a_file"></a>Opening a File</h2>
<p>
This topic describes sample code that displays an <b>Open</b> dialog box so a user can specify the drive, directory, and name of a file to open. The sample code first initializes an <a href="commdlg3_1hma.htm"><b>OPENFILENAME</b></a> structure, and then calls the <a href="commdlg3_3cbp.htm"><b>GetOpenFileName</b></a> function to display the dialog box. </p>
<p>
In this example, the <b>lpstrFilter</b> member points to a buffer that specifies two filename filters that the user can select to limit the filenames that are displayed. The buffer contains a double-null terminated array of strings in which each pair of strings specifies a filter. The <b>nFilterIndex</b> member specifies that the first pattern is used when the dialog box is created. </p>
<p>
This example sets the OFN_PATHMUSTEXIST and OFN_FILEMUSTEXIST flags in the <b>Flags</b> member. These flags cause the dialog box to verify, before returning, that the path and filename specified by the user actually exist.</p>
<p>
The <a href="commdlg3_3cbp.htm"><b>GetOpenFileName</b></a> function returns TRUE if the user clicks the <b>OK</b> button and the specified path and filename exist. In this case, the buffer pointed to by the <b>lpstrFile</b> member contains the path and filename. The sample code uses this information in a call to the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_createfile">
</object><a href=JavaScript:alink_1.Click()><b>CreateFile</b></a> function to open the file.</p>
<p>
Although this example does not set the OFN_EXPLORER flag, it still displays the default Explorer-style <b>Open</b> dialog box. However, if you want to provide a hook procedure or a custom template and you want the Explorer user interface, you must set the OFN_EXPLORER flag.</p>
<pre><code>OPENFILENAME ofn;       // common dialog box structure
char szFile[260];       // buffer for filename
HWND hwnd;              // owner window
HANDLE hf;              // file handle

// Initialize OPENFILENAME
ZeroMemory(&amp;ofn, sizeof(OPENFILENAME));
ofn.lStructSize = sizeof(OPENFILENAME);
ofn.hwndOwner = hwnd;
ofn.lpstrFile = szFile;
ofn.nMaxFile = sizeof(szFile);
ofn.lpstrFilter = "All\0*.*\0Text\0*.TXT\0";
ofn.nFilterIndex = 1;
ofn.lpstrFileTitle = NULL;
ofn.nMaxFileTitle = 0;
ofn.lpstrInitialDir = NULL;
ofn.Flags = OFN_PATHMUSTEXIST | OFN_FILEMUSTEXIST;

// Display the Open dialog box. 

if (GetOpenFileName(&amp;ofn)==TRUE) 
    hf = CreateFile(ofn.lpstrFile, GENERIC_READ,
        0, (LPSECURITY_ATTRIBUTES) NULL,
        OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL,
        (HANDLE) NULL);
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
