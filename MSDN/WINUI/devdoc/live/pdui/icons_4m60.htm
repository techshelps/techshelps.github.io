<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ExtractIconEx</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_extracticonex"></a>ExtractIconEx</h1>
<p>
The <b>ExtractIconEx</b> function creates an array of handles to large or small icons extracted from the specified executable file, dynamic-link library (DLL), or icon file. </p>
<pre><code><b>UINT ExtractIconEx(
  LPCTSTR</b><i> lpszFile</i><b>,          </b>
<b>  int</b><i> nIconIndex</i><b>,           </b>
<b>  HICON FAR </b><i>*phiconLarge</i><b>,  </b>
<b>  HICON FAR </b><i>*phiconSmall</i><b>,  </b>
<b>  UINT</b><i> nIcons</i>               
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszFile</i></dt>
<dd>
Pointer to a null-terminated string specifying the name of an executable file, DLL, or icon file from which icons will be extracted.</dd>
<dt>
<i>nIconIndex</i></dt>
<dd>
Specifies the zero-based index of the first icon to extract. For example, if this value is zero, the function extracts the first icon in the specified file. 
<p>
If this value is –1 and <i>phIconLarge </i>and <i>phiconSmall</i> are both NULL, the function returns the total number of icons in the specified file. If the file is an executable file or DLL, the return value is the number of RT_GROUP_ICON resources. If the file is an .ICO file, the return value is 1. 

<p>
<b>Windows 95, Windows NT 4.0, and later:</b> If this value is a negative number and either <i>phIconLarge </i>or <i>phiconSmall</i> is not NULL, the function begins by extracting the icon whose resource identifier is equal to the absolute value of <i>nIconIndex</i>. For example, use -3 to extract the icon whose resource identifier is 3. 
</dd>
<dt>
<i>phiconLarge</i></dt>
<dd>
Pointer to an array of icon handles which receives handles to the large icons extracted from the file. If this parameter is NULL, no large icons are extracted from the file.</dd>
<dt>
<i>phiconSmall</i></dt>
<dd>
Pointer to an array of icon handles which receives handles to the small icons extracted from the file. If this parameter is NULL, no small icons are extracted from the file.</dd>
<dt>
<i>nIcons</i></dt>
<dd>
Specifies the number of icons to extract from the file.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the <i>nIconIndex</i> parameter is -1, the <i>phiconLarge</i> parameter is NULL, and the <i>phiconSmall</i> parameter is NULL, then the return value is the number of icons contained in the specified file. Otherwise, the return value is the number of icons successfully extracted from the file. </p>
<h4>Remarks</h4>
<p>
You must destroy all icons extracted by <b>ExtractIconEx</b> by calling the <a href="icons_5kxa.htm"><b>DestroyIcon</b></a> function. </p>
<p>
To retrieve the dimensions of the large and small icons, use the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getsystemmetrics">
</object><a href=JavaScript:alink_1.Click()><b>GetSystemMetrics</b></a> function with the SM_CXICON, SM_CYICON, SM_CXSMICON, and SM_CYSMICON flags. </p>
<p>
<b>Windows CE:</b> The <i>nIconIndex</i> parameter must be zero or –N where N is a specified resource identifier. The <i>nIcons</i> parameter must be 1.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.5 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in shellapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use shell32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="icons_1xpv.htm">Icons Overview</a>, <a href="icons_7zlf.htm">Icon Functions</a>, <a href="icons_5kxa.htm"><b>DestroyIcon</b></a>, <a href="icons_7h2m.htm"><b>ExtractIcon</b></a></p>
<p>&nbsp;</p></body>
</HTML>
