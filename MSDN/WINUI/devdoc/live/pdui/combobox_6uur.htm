<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Owner-Drawn Combo Boxes</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_owner_drawn_combo_boxes"></a>Owner-Drawn Combo Boxes</h2>
<p>
An application can create an <i>owner-drawn</i> combo box to take responsibility for painting list items. The parent window or dialog box of an owner-drawn combo box (its <i>owner</i>) receives <a href="combobox_3sx9.htm">WM_DRAWITEM</a> messages when a portion of the combo box needs to be painted. An owner-drawn combo box can list information other than, or in addition to, text strings. Owner-drawn combo boxes can be of any type. However, the edit control in a simple or drop-down combo box can only display text, while the owner paints the selection field in a drop-down list box. </p>
<p>
The owner of an owner-drawn combo box must process the WM_DRAWITEM message. This message is sent whenever a portion of the combo box must be redrawn. The owner may need to process other messages, depending on the styles specified for the combo box. </p>
<p>
An application can create an owner-drawn combo box by specifying the CBS_OWNERDRAWFIXED or CBS_OWNERDRAWVARIABLE style. If all list items in the combo box are the same height, such as strings or icons, an application can use the CBS_OWNERDRAWFIXED style. If list items are of varying height, bitmaps of different size, for example, an application can use the CBS_OWNERDRAWVARIABLE style. </p>
<p>
The owner of an owner-drawn combo box can process a <a href="combobox_85d9.htm">WM_MEASUREITEM</a> message to specify the dimensions of list items in the combo box. If the application creates the combo box by using the CBS_OWNERDRAWFIXED style, the system sends the WM_MEASUREITEM message only once. The dimensions specified by the owner are used for all list items. If the CBS_OWNERDRAWVARIABLE style is used, the system sends a WM_MEASUREITEM message for each list item added to the combo box. The owner can determine or set the height of a list item at any time by using the <a href="combobox_5tro.htm">CB_GETITEMHEIGHT</a> and <a href="combobox_0l10.htm">CB_SETITEMHEIGHT</a> messages, respectively. </p>
<p>
If the information displayed in an owner-drawn combo box includes text, an application can keep track of the text for each list item by specifying the CBS_HASSTRINGS style. Combo boxes with the CBS_SORT style are sorted based on this text. If a combo box is sorted and not of the CBS_HASSTRINGS style, the owner must process the <a href="combobox_6vxp.htm">WM_COMPAREITEM</a> message. </p>
<p>
In an owner-drawn combo box, the owner must keep track of list items containing information other than or in addition to text. One convenient way to do this is to save the handle to the information as item data. For more information about item data, see <a href="combobox_5d0z.htm">Data Associated with List Items</a>. To free data objects associated with items in a combo box, the owner can process the <a href="listbox_5dbh.htm">WM_DELETEITEM</a> message. </p>
<p>
For an example of an owner-drawn combo box, see <a href="combobox_9ge0.htm">Creating an Owner-Drawn Combo Box</a>. </p>
<p>&nbsp;</p></body>
</HTML>
