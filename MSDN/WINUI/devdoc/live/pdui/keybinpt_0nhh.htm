<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetKeyboardState</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_getkeyboardstate"></a>GetKeyboardState</h1>
<p>
The <b>GetKeyboardState</b> function copies the status of the 256 virtual keys to the specified buffer. </p>
<pre><code><b>BOOL GetKeyboardState(
  PBYTE</b><i> lpKeyState</i>   // pointer to array to receive status data
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpKeyState</i></dt>
<dd>
Pointer to the 256-byte array that will receive the status data for each virtual key. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
An application can call this function to retrieve the current status of all the virtual keys. The status changes as a thread removes keyboard messages from its message queue. The status does not change as keyboard messages are posted to the thread's message queue, nor does it change as keyboard messages are posted to or retrieved from message queues of other threads. (Exception: Threads that are connected via <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_attachthreadinput">
</object><a href=JavaScript:alink_2.Click()><b>AttachThreadInput</b></a> share the same keyboard state.)</p>
<p>
When the function returns, each member of the array pointed to by the <i>lpKeyState</i> parameter contains status data for a virtual key. If the high-order bit is 1, the key is down; otherwise, it is up. If the low-order bit is 1, the key is toggled. A key, such as the caps lock key, is toggled if it is turned on. The key is off and untoggled if the low-order bit is 0. A toggle key's indicator light (if any) on the keyboard will be on when the key is toggled, and off when the key is untoggled. </p>
<p>
To retrieve status information for an individual key, use the <a href="keybinpt_4z51.htm"><b>GetKeyState</b></a> function. To retrieve the current state for an individual key regardless of whether the corresponding keyboard message has been retrieved from the message queue, use the <a href="keybinpt_1x0l.htm"><b>GetAsyncKeyState</b></a> function</p>
<p>
An application can use the virtual-key code constants VK_SHIFT, VK_CONTROL and VK_MENU as indices into the array pointed to by <i>lpKeyState</i>. This gives the status of the shift, ctrl, or alt keys without distinguishing between left and right. An application can also use the following virtual-key code constants as indices to distinguish between the left and right instances of those keys. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=25%>VK_LSHIFT</td>
<td width=75%>VK_RSHIFT</td>
</tr>
<tr valign=top>
<td width=25%>VK_LCONTROL</td>
<td width=75%>VK_RCONTROL</td>
</tr>
<tr valign=top>
<td width=25%>VK_LMENU</td>
<td width=75%>VK_RMENU</td>
</tr>
</table><br>
<p>
These left- and right-distinguishing constants are available to an application only through the <b>GetKeyboardState</b>, <b>SetKeyboardState</b>, <b>GetAsyncKeyState</b>, <b>GetKeyState</b>, and <b>MapVirtualKey</b> functions. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winuser.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.</p>
<h4>See Also</h4>
<p>
<a href="keybinpt_4l9w.htm">Keyboard Input Overview</a>, <a href="keybinpt_43jn.htm">Keyboard Input Functions</a>, <a href="keybinpt_4z51.htm"><b>GetKeyState</b></a>, <a href="keybinpt_1x0l.htm"><b>GetAsyncKeyState</b></a>, <a href="keybinpt_0hfd.htm"><b>MapVirtualKey</b></a>, <a href="keybinpt_2iqt.htm"><b>SetKeyboardState</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
