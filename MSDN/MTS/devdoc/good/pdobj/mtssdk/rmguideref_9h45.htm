<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IResourceManagerFactory::Create</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<p>
<a name="asiresourcemanagerfactorycreate"></a>IResourceManagerFactory::Create</p>
<p>
This method is used to create a resource manager object.</p>
<pre><b>HRESULT Create (</b></pre>
<table cellspacing=5 cols=2>
<tr valign=top>
<td width=46%><pre><b>GUID *</b></pre>
</td>
<td width=54%><pre><i>pguidRM</i><b>,</b></pre>
</td>
</tr>
<tr valign=top>
<td width=46%><pre><b>TCHAR *</b></pre>
</td>
<td width=54%><pre><i>pszRMName</i><b>,</b></pre>
</td>
</tr>
<tr valign=top>
<td width=46%><pre><b>IResourceManagerSink *</b></pre>
</td>
<td width=54%><pre><i>pIResMgrSink</i><b>,</b></pre>
</td>
</tr>
<tr valign=top>
<td width=46%><pre><b>IResourceManager **</b></pre>
</td>
<td width=54%><pre><i>ppResMgr</i><b>);</b></pre>
</td>
</tr>
</table><br>
<p>
<b>Parameters</b></p>
<p>
<i>pguidRM</i> [in]<br>
A UUID that uniquely identifies this resource manager.</p>
<p>
<i>pszName</i> [in]<br>
A string name that identifies this resource manager.</p>
<p>
<i>pIResMgrSink</i> [in]<br>
Pointer to the resource manager’s <b>IResourceManagerSink</b> interface. The resource manager developer must implement the <b>TMDown</b> method on this interface.</p>
<p>
<i>ppResMgr</i> [out]<br>
Pointer to the pointer to the <b>IResourceManager</b> interface on the resource manager object.</p>
<p>
<b>Return Values</b></p>
<p>
S_OK<br>
Success.</p>
<p>
E_NOINTERFACE<br>
Requested interface is not available.</p>
<p>
E_OUTOFMEMORY<br>
Unable to allocate memory.</p>
<p>
XACT_E_TMNOTAVAILABLE<br>
Unable to connect to the transaction manager.</p>
<p>
XACT_E_CONNECTION_DOWN<br>
Connection with the transaction manager was lost.</p>
<p>
XACT_E_CONNECTION_REQUEST_DENIED<br>
The transaction manager refused to accept a connection.</p>
<p>
XACT_E_DUPLICATE_GUID<br>
There is already a resource manager connected to the transaction manager with the same GUID as was passed in <i>pguidRM</i>.</p>
<p>
E_UNEXPECTED<br>
An unexpected error has occurred.</p>
<p>
<b>Comments</b></p>
<p>
The resource manager object represents the connection between the resource manager and the transaction manager. The resource manager object supports the <b>IResourceManager</b> interface that resource manager use to enlist in transactions and to perform transaction recovery.</p>
<p>
A resource manager typically invokes the <b>IResourceManager::Create </b>method when the resource manager first starts. By doing this the resource manager registers itself with the transaction manager. The resource manager retains the resource manager object until it no longer needs the services of the transaction manager. It then releases <b>IResourceManager</b> interface. This ends the connection with the transaction manager. A resource manager typically retains the transaction manager connection until the resource manager stops.</p>
<p>
If the connection between the transaction manager and the resource manager fails, the MS DTC proxy invokes the resource manager’s <b>IResourceManagerSink::TMDown</b> method. This callback informs the resource manager that its transaction manager connection has failed. The resource manager must invoke the <b>IResourceManagerFactory::Create</b> method again to reregister with the transaction manager.</p>
<p>&nbsp; </p></body>
</HTML>
