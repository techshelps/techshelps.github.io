<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPrepareInfo Interface</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="asiprepareinfointerface"></a>IPrepareInfo Interface</h1>
<p>
The resource manager uses this interface to retrieve <i>prepare information</i> from the transaction manager. The resource manager writes this prepare information to its log file when preparing at phase one. The prepare information is only needed if failure recovery is necessary. During recovery, the resource manager identifies the transactions that were prepared but not yet committed or aborted at the time of the failure. The resource manager is in-doubt about the outcome of these transactions. The resource manager provides the prepare information for these in-doubt transactions to the transaction manager. The transaction manager uses the prepare information to locate the in-doubt transactions, determine their outcomes, and return the their outcomes to the resource manager. This permits the resource manager to resolve its in-doubt transactions.</p>
<table cellspacing=5 cols=2>
<tr valign=top>
<td width=27%>Implemented by:</td>
<td width=73%>MS DTC proxy</td>
</tr>
<tr valign=top>
<td width=27%>Object</td>
<td width=73%>Enlistment object</td>
</tr>
<tr valign=top>
<td width=27%>Interface Source</td>
<td width=73%>Call <b>QueryInterface</b> on the <b>ITransactionEnlistmentAsync</b> interface on the enlistment object with a <i>riid</i> of IID_IPrepareInfo</td>
</tr>
<tr valign=top>
<td width=27%>Called by:</td>
<td width=73%>Resource manager</td>
</tr>
</table><br>
<pre><code>interface IPrepareInfo : IUnknown
{
HRESULT GetPrepareInfoSize (
    [out] ULONG * pcbPrepInfo) ;

HRESULT GetPrepareInfo (
    [out] unsigned char * pPrepInfo) ;
}<b>;</b></code></pre>
<p>&nbsp; </p></body>
</HTML>
