<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Life of a Transaction: Creating an Export Object I (Phases)</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="aslifeofatransactioncreatinganexportobjectiphases"></a>Life of a Transaction: Creating an Export Object I (Phases)</h1>
<table cellspacing=5 cols=2>
<tr valign=top>
<td width=9%>g1</td>
<td width=91%>The RM proxy sends a "Get Whereabouts" message to its resource manager asking for the whereabouts of the resource manager's transaction manager. The form of the "Get Whereabouts" message is proprietary to the RM proxy and the resource manager.</td>
</tr>
<tr valign=top>
<td width=9%>g2.1</td>
<td width=91%>The resource manager responds to the "Get Whereabouts" message by invoking the <b>IUnknown::QueryInterface</b> method on the MS DTC proxy core object to obtain the <b>ITransactionImportWhereabouts</b> interface<b>.</b></td>
</tr>
<tr valign=top>
<td width=9%>g2.2</td>
<td width=91%>The resource manager invokes the <b>ITransactionImportWhereabouts::GetWhereaboutsSize</b> method to determine the size of the whereabouts.</td>
</tr>
<tr valign=top>
<td width=9%>g3</td>
<td width=91%>The MS DTC proxy returns the byte length of the whereabouts to the resource manager.</td>
</tr>
<tr valign=top>
<td width=9%>g4</td>
<td width=91%>The resource manager invokes the <b>ITransactionImportWhereabouts::GetWhereabouts </b>method to obtain the whereabouts.</td>
</tr>
<tr valign=top>
<td width=9%>g5</td>
<td width=91%>The MS DTC proxy returns the whereabouts that it obtains from its cache. The whereabouts is an opaque data structure that represents the address of the resource manager’s transaction manager. Other transaction managers can use the information in the whereabouts to locate and communicate with the resource manager’s transaction manager.</td>
</tr>
<tr valign=top>
<td width=9%>g6</td>
<td width=91%>The resource manager inserts the whereabouts in a "Return Whereabouts" message and returns this message to the RM proxy on the client’s system. The form of the "Return Whereabouts" message is proprietary to the RM proxy and the resource manager.</td>
</tr>
</table><br>
<p>&nbsp; </p></body>
</HTML>
