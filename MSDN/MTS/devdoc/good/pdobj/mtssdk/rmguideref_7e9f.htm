<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ITransactionOptions::SetOptions</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<p>
<a name="asitransactionoptionssetoptions"></a>ITransactionOptions::SetOptions</p>
<p>
The <b>SetOptions</b> method is used to alter transaction attributes in a transaction options object.</p>
<pre><b>HRESULT SetOptions(</b></pre>
<table cellspacing=5 cols=2>
<tr valign=top>
<td width=27%><pre><b>XACTOPT *</b></pre>
</td>
<td width=73%><pre><i>pOptions</i><b>)</b></pre>
</td>
</tr>
</table><br>
<p>
<b>Parameters</b></p>
<p>
<i>pOptions</i> [in]<br>
Pointer to the XACTOPT structure. This structure contains attribute information for a transaction options object.</p>
<pre><code>typedef struct XACTOPT {
ULONG         ulTimeout;
unsigned char szDescription[ MAX_TRAN_DESC ];
} XACTOPT;</code></pre>
<table cellspacing=5 cols=2>
<tr valign=top>
<th align=left width=42%>Element</th>
<th align=left width=58%>Description</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%></td>
</tr>
<tr valign=top>
<td width=42%><i>ulTimeout</i></td>
<td width=58%>The time-out limits the duration of the transaction and therefore bounds the amount of time locks are held on database records and system resources. If the time-out period expires before the transaction commits, MS&nbsp;DTC automatically aborts the transaction.<p>
The time-out is specified in milliseconds. A time-out value of zero indicates an infinite time-out.</p>
</td>
</tr>
<tr valign=top>
<td width=42%><i>szDescription</i></td>
<td width=58%><i>szDescription</i> provide a textual description for a transaction. The description is displayed by the MS DTC administration tool in the MS DTC Transactions window. The description is only meaningful to the MS DTC administrator and is not processed or interpreted by MS DTC itself. The string cannot be longer than MAX_TRAN_DESC bytes in length.</td>
</tr>
</table><br>
<p>
<b>Return Values</b></p>
<p>
S_OK<br>
Success.</p>
<p>
E_OUTOFMEMORY<br>
Unable to allocate memory.</p>
<p>
E_INVALIDARG<br>
The value of <i>pOptions</i> is NULL.</p>
<p>
<b>Comments</b></p>
<p>
<b>SetOptions</b> must not be invoked on a transaction options object which is currently in use by the <b>ITransactionDispenser::BeginTransaction </b>method.</p>
<p>&nbsp; </p></body>
</HTML>
