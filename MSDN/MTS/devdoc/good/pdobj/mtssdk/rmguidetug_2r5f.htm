<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Resource Manager Implicitly Initiated Transactions</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="asresourcemanagerimplicitlyinitiatedtransactions"></a>Resource Manager Implicitly Initiated Transactions</h1>
<p>
Some OLE Transactions resource managers may want to implicitly initiate MS DTC transactions on behalf of an application. For example, Microsoft SQL Server implicitly initiates MS DTC transactions when needed by a stored procedure.</p>
<p>
There may be other uses for implicitly initiated MS DTC transactions. For example, a database system might automatically initiate an MS DTC transaction when no distributed transaction is in force and a stored procedure in one database system invokes a remote stored procedure in another database system. By doing this, the database system protects the work done in both databases using a single distributed transaction.</p>
<p>
Resource manager implicitly initiated transactions are advantageous for four reasons:
<ol>
<li>
Simplifies application programming—resource managers automatically initiate distributed transactions when required.</li>
<li>
Permits existing stored procedures to exploit MS DTC transactions. For example, Microsoft SQL Server starts an MS DTC transaction when a stored procedure calls the existing Transact-SQL BEGIN TRANSACTION statement and the database administrator has enabled the <b>Remote Procedure Transactions</b> option.</li>
</ol>
<p>
The <b>Remote Procedure Transactions</b> option controls whether SQL Server initiates an MS DTC distributed transaction or an existing SQL Server local transaction. The option is present for compatibility. When the option is reset, which it is by default, the old behavior is preserved and no MS DTC transaction is initiated. When the option is set, SQL Server starts an MS DTC transaction.
<ol>
<li>
Lowers the cost of committing a transaction when the resource manager begins and commits the transaction. When the resource manager initiates the MS DTC transaction, the transaction manager on the resource manager’s system always acts as the transaction coordinator. This can reduce the cost of committing the transaction because the transaction manager on the client application's system need not participate in the two-phase commit protocol.</li>
<li>
Minimizes setup and administration because there is no need to install MS DTC on client machines.</li>
</ol>
<p>&nbsp; </p></body>
</HTML>
