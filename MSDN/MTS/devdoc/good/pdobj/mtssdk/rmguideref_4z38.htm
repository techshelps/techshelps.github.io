<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ITransactionExportFactory::GetRemoteClassId</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<p>
<a name="asitransactionexportfactorygetremoteclassid"></a>ITransactionExportFactory::GetRemoteClassId</p>
<p>
<b>GetRemoteClassId</b> returns the class identifier of the local transaction manager. The class identifier can be used to ensure that a transaction manager of the proper type is present on the remote system. Having compatible transaction managers on the two systems makes it possible to propagate transactions between the systems.</p>
<pre><b>HRESULT GetRemoteClassId (</b></pre>
<table cellspacing=5 cols=2>
<tr valign=top>
<td width=27%><pre><b>CLSID *</b></pre>
</td>
<td width=73%><pre><i>pclsid</i><b>);</b></pre>
</td>
</tr>
</table><br>
<p>
<b>Parameters</b></p>
<p>
<i>pclsid</i> [out]<br>
Pointer to the class identifier of the local transaction manager.</p>
<p>
<b>Return Values</b></p>
<p>
S_OK<br>
Success.</p>
<p>
E_INVALIDARG<br>
The value of <i>pclsid</i> is NULL.</p>
<p>
<b>Comments</b></p>
<p>
This method is not needed when MS DTC is the only transaction manager being used. This method is present so that vendors other than Microsoft can provide OLE Transactions compliant transaction managers. These transaction managers could be used in place of MS DTC or in conjunction with it.</p>
<p>
Resource managers that wish to work with a variety of transaction manager should have their RM proxy call this method. The RM proxy should examine the value returned in <i>pclsid</i>. If <i>pclsid</i> is CLSID_M01_MSDtcTmProxy, then MS DTC is being used as the local transaction manager. In this case, the remote resource manager can call the <b>DtcGetTransactionManager</b> helper function on the remote system. This will connect the remote resource manager to the MS DTC proxy Core Object<i> </i>on its system<i>.</i> If some other <i>pclsid</i> is returned, then the remote resource manager should call <b>CoCreateInstance</b> on the remote system with a class identifier of <i>*pclsid</i>. This will connect the remote resource manager to the appropriate transaction manager on that system.</p>
<p>&nbsp; </p></body>
</HTML>
