<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Mapping OLE Transactions to the XA Protocol</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<p>
<a name="asmappingoletransactionstothexaprotocol"></a>Mapping OLE Transactions to the XA Protocol</p>
<p>
Microsoft Distributed Transaction Coordinator (MS DTC) provides a transaction coordination facility via the OLE Transactions protocol. This document describes how the OLE Transactions protocol can be mapped to the X/Open (XA) protocol.</p>
<p>
<b>OLE Transactions to XA Mapping via an XA TM</b></p>
<p>
<img src="images/virm42.gif" border=0></p>
<p>
The shaded components in the previous illustration represent parts of MS DTC: the DTC Proxy, the XA transaction manager (TM), and the distributed transaction coordinator (DTC). The components marked as solid represent the resource manager (RM): the ODBC driver, and the RM itself.</p>
<p>
An application gets new transactions by invoking the <b>ITransactionDispenser</b> interface offered by the DTC Proxy DLL, and it uses an ODBC driver to communicate with an RM such as SQL Server, DB2, Informix, and Oracle, among others. To get an ODBC connection to enlist on a DTC transaction, the application sets an attribute called SQL_ATTR_ENLIST_IN_DTC on that connection. An ODBC driver is DTC-compliant only if it accepts this attribute. Some resource managers are natively OLE Transactions-compliant, in which case the ODBC driver performs all necessary work for OLE Transactions. See the <i>Resource Manager Implementation Guide </i>for information about what ODBC drivers need to do to map the OLE Transactions protocol to the XA protocol.</p>
<p>&nbsp; </p></body>
</HTML>
