<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IDtcToXaMapper::RequestNewResourceManager</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<p>
<a name="asidtctoxamapperrequestnewresourcemanager"></a>IDtcToXaMapper::RequestNewResourceManager</p>
<p>
Used to obtain a RM cookie which is stored in the connection object.</p>
<pre><b>HRESULT RequestNewResourceManager (
char</b>                <i>pszDSN</i><b>,</b>
<b>char</b>                <i>pszClientDllName</i><b>,</b>
<b>DWORD *</b>        <i>pdwRMCookie</i><b>);</b></pre>
<p>
<b>Parameters</b></p>
<p>
<i>pszDSN </i>[in]<i><br>
</i>A string containing the Data Source Name (DSN).</p>
<p>
<i>pszClientDllName</i> [in]<i><br>
</i>A string containing the name of the client DLL.</p>
<p>
<i>pdwRMCookie</i> [in/out]<i><br>
</i>A cookie representing the RM corresponding to the DSN is returned via this parameter.</p>
<p>
<b>Return Values</b></p>
<p>
S_OK<br>
Success.</p>
<p>
E_FAIL<br>
The attempt to create the resource manager failed due to a bad installation of the XA TM or the DTC TM.</p>
<p>
E_INVALIDARG<br>
One or more of the parameters are not valid.</p>
<p>
E_OUTOFMEMORY<br>
Unable to allocate resources for a new resource manager.</p>
<p>
E_UNEXPECTED<br>
An unexpected error occurred.</p>
<p>
XACT_E_CONNECTIONDOWN<br>
Lost connection with DTC TM.</p>
<p>
XACT_E_TMNOTAVAILABLE<br>
Unable to establish a connection with DTC service.</p>
<p>
<b>Comments</b></p>
<p>
The <b>RequestNewResourceManager</b> method is typically invoked only once per ODBC connection. It is not required after the connection transitions from the <i>local transaction state</i> to the <i>distributed transaction state</i>.</p>
<p>
An ODBC connection can be in one of two states, <i>distributed transaction state</i>, or <i>non-distributed transaction state</i> as shown in the <a href="oletxtoxaref_7vsj.htm">Transaction States</a> topic.</p>
<p>&nbsp; </p></body>
</HTML>
