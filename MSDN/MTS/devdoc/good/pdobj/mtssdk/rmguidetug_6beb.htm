<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Life of a Transaction: Exporting a Transaction (Phases)</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="aslifeofatransactionexportingatransactionphases"></a>Life of a Transaction: Exporting a Transaction (Phases)</h1>
<table cellspacing=5 cols=2>
<tr valign=top>
<td width=9%>h1</td>
<td width=91%>The RM proxy invokes the <b>ITransactionExport::Export</b> method on the export object, passing the pointer to the transaction object that the client specified when it asked the resource manager to enlist in the transaction at step "f1".</td>
</tr>
<tr valign=top>
<td width=9%>h2</td>
<td width=91%>The MS DTC proxy sends the transaction identifier GUID of the exported transaction to the client’s transaction manager.</td>
</tr>
<tr valign=top>
<td width=9%>h3.1</td>
<td width=91%>The client’s transaction manager checks its internal export object<i> </i>to see whether a Connection Manager connection has been established with the resource manager's transaction manager. If not, the client’s transaction manager obtains the whereabouts from the internal export object and passes the<b> </b>whereabouts to the Connection Manager. The Connection Manager establishes a connection to the resource manager’s transaction manager.</td>
</tr>
<tr valign=top>
<td width=9%>h3.2</td>
<td width=91%>The client's transaction manager sends the transaction identifier GUID of the exported transaction to the resource manager’s transaction manager.</td>
</tr>
<tr valign=top>
<td width=9%>h4</td>
<td width=91%>The resource manager’s transaction manager creates a internal transaction object for the exported transaction. It then stores the transaction identifier GUID in the transaction object. It marks the transaction object to indicate that it was received from the client’s transaction manager. The resource manager’s transaction manager then replies to the client’s transaction manager.</td>
</tr>
<tr valign=top>
<td width=9%>h5</td>
<td width=91%>The client’s transaction manager returns the transaction identifier GUID to the MS DTC proxy,</td>
</tr>
<tr valign=top>
<td width=9%>h6</td>
<td width=91%>The MS DTC proxy constructs a transaction cookie that represents the transaction. The transaction cookie is an opaque marshaled form of the transaction object. The MS DTC proxy responds to the <b>ITransactionExport::Export</b> method invocation by returning the byte length of the transaction cookie to the RM proxy.</td>
</tr>
<tr valign=top>
<td width=9%>h7</td>
<td width=91%>The RM proxy invokes the <b>ITransactionExport::GetTransactionCookie</b> method on the export object, passing three input parameters. The first is the pointer to the transaction object to be exported. The second is the length of the buffer into which the transaction cookie is to be placed. The third is a pointer to the buffer where the transaction cookie will be returned.</td>
</tr>
<tr valign=top>
<td width=9%>h8</td>
<td width=91%>The MS DTC proxy returns the transaction cookie and its actual length to the RM proxy.</td>
</tr>
</table>
<p>&nbsp; </p></body>
</HTML>
