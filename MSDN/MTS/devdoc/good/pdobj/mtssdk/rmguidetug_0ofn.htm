<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Life of a Transaction: Exporting a Transaction II (Phases)</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="aslifeofatransactionexportingatransactioniiphases"></a>Life of a Transaction: Exporting a Transaction II (Phases)</h1>
<table cellspacing=5 cols=2>
<tr valign=top>
<td width=12%>h9</td>
<td width=88%>The RM proxy passes the transaction cookie to the resource manager by means of an "Export Request" message. The format of the "Export Request" message is proprietary to the RM proxy and the resource manager.</td>
</tr>
<tr valign=top>
<td width=12%>h10.1</td>
<td width=88%>The resource manager responds to the "Export Request" message by invoking the <b>IUnknown::QueryInterface</b> method on the MS DTC proxy core object to obtain the <b>ITransactionImport</b> interface.</td>
</tr>
<tr valign=top>
<td width=12%>h10.2</td>
<td width=88%>The resource manager invokes the <b>ITransactionImport::Import</b> method, passing the transaction cookie it received from the RM proxy.</td>
</tr>
<tr valign=top>
<td width=12%>h11</td>
<td width=88%>The MS DTC proxy converts the transaction cookie into the appropriate transaction identifier GUID and passes the transaction identifier to the resource manager’s transaction manager.</td>
</tr>
<tr valign=top>
<td width=12%>h12</td>
<td width=88%>The transaction manager uses the transaction identifier to locate the internal transaction object for the imported transaction. It updates the internal transaction object to indicate that this resource manager is participating in this transaction. It then returns to the MS DTC proxy.</td>
</tr>
<tr valign=top>
<td width=12%>h13</td>
<td width=88%>The MS DTC proxy creates a transaction object for the imported transaction and returns a pointer to the <b>ITransaction</b> interface of the transaction object to the resource manager.</td>
</tr>
<tr valign=top>
<td width=12%>h14</td>
<td width=88%>The resource manager associates the transaction object with the RM proxy-to-resource manager session on which the transaction was exported. The resource manager then replies to the RM proxy, indicating that the transaction has been exported.</td>
</tr>
<tr valign=top>
<td width=12%>h15</td>
<td width=88%>The RM proxy responds to the resource manager enlistment call that the client made at step "f1". The response indicates that a successful enlistment has occurred.</td>
</tr>
</table><br>
<p>&nbsp; </p></body>
</HTML>
