<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DtcGetTransactionManager Function</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<p>
<a name="asdtcgettransactionmanagerfunction"></a>DtcGetTransactionManager Function</p>
<p>
This is typically the first MS DTC call that application programs and resource managers make when using MS DTC. This helper function establishes the initial connection to MS DTC. It returns an interface pointer to one of the interfaces on the MS DTC proxy core object.</p>
<table cellspacing=5 cols=2>
<tr valign=top>
<td width=27%>Implemented by:</td>
<td width=73%>MS DTC proxy</td>
</tr>
<tr valign=top>
<td width=27%>Object</td>
<td width=73%>This is a helper function, not a method on an object</td>
</tr>
<tr valign=top>
<td width=27%>Interface Source</td>
<td width=73%>N/A</td>
</tr>
<tr valign=top>
<td width=27%>Called by:</td>
<td width=73%>Application programs and resource managers</td>
</tr>
</table><br>
<pre><b>HRESULT __cdecl DtcGetTransactionManager (</b></pre>
<table cellspacing=5 cols=2>
<tr valign=top>
<td width=24%><pre><b>char *</b></pre>
</td>
<td width=76%><pre><i>pszHost</i><b>,</b></pre>
</td>
</tr>
<tr valign=top>
<td width=24%><pre><b>char *</b></pre>
</td>
<td width=76%><pre><i>pszTmName</i><b>,</b></pre>
</td>
</tr>
<tr valign=top>
<td width=24%><pre><b>REFIID</b></pre>
</td>
<td width=76%><pre><i>riid</i><b>,</b></pre>
</td>
</tr>
<tr valign=top>
<td width=24%><pre><b>DWORD</b></pre>
</td>
<td width=76%><pre><i>dwReserved1</i><b>,</b></pre>
</td>
</tr>
<tr valign=top>
<td width=24%><pre><b>WORD</b></pre>
</td>
<td width=76%><pre><i>wcbVarLenReserved2</i><b>,</b></pre>
</td>
</tr>
<tr valign=top>
<td width=24%><pre><b>void *</b></pre>
</td>
<td width=76%><pre><i>pvVarDataReserved2</i><b>,</b></pre>
</td>
</tr>
<tr valign=top>
<td width=24%><pre><b>void **</b></pre>
</td>
<td width=76%><pre><i>ppv</i><b>);</b></pre>
</td>
</tr>
</table><br>
<p>
<b>Parameters</b></p>
<p>
<i>pszHost</i> [in]<br>
Name of the host system which will serve as the transaction commit coordinator.</p>
<p>
<i>pszTmName</i> [in]<br>
String Name of the transaction manager which will serve as the transaction commit coordinator. Must be NULL.</p>
<p>
<i>riid</i> [in]<br>
IID of the requested interface.</p>
<p>
<i>dwReserved1</i> [in]<br>
Reserved parameter. Must be zero.</p>
<p>
<i>wcbVarLenReserved2</i> [in]<br>
Reserved parameter. Must be zero.</p>
<p>
<i>pvVarDataReserved2</i> [in]<br>
Reserved parameter. Must be NULL.</p>
<p>
<i>ppv</i> [out]<br>
Pointer to the pointer to the requested interface.</p>
<p>
<b>Comments</b></p>
<p>
Calls to <b>DtcGetTransactionManager</b> can specify a server host name in the <i>pszHost</i> parameter. This lets the transaction to be started and coordinated on a specific computer on the network. If a value of NULL is supplied, the following rules determine where the transaction is started and coordinated:
<ol>
<li>
If the workstation making the call has a locally installed MS DTC, the local MS DTC is used.</li>
<li>
If the workstation making the call is a Windows 95 computer or a Windows NT computer which does not have a local MS DTC installed, the default MS DTC is used. The default MS DTC is defined using the DTCCFG control panel application. See the <i>Guide to Microsoft Distributed Transaction Coordinator</i> for more information on DTCCFG.</li>
</ol>
<p>
<b>Return Values</b></p>
<p>
S_OK<br>
Success.</p>
<p>
E_NOINTERFACE<br>
Unable to provide the requested interface.</p>
<p>
E_UNEXPECTED<br>
Unexpected error encountered.</p>
<p>
E_INVALIDARG<br>
One or more arguments are invalid.</p>
<p>
E_FAIL<br>
Failed to carry out the operation.</p>
<p>&nbsp; </p></body>
</HTML>
