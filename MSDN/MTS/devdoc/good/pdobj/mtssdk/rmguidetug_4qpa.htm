<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How an Application Program Initiates a Transaction</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="ashowanapplicationprograminitiatesatransaction"></a>How an Application Program Initiates a Transaction</h1>
<p>
An application program initiates a transaction by:
<ol>
<li>
Connecting to MS DTC and obtaining a transaction dispenser interface that it uses to initiate transactions.</li>
<li>
Opening the appropriate resource managers, for example, by connecting to a relational database using ODBC.</li>
<li>
Initiating the MS DTC transaction by calling BeginTransaction and obtaining a transaction object that represents the transaction.</li>
<li>
Propagating the transaction to each resource manager by invoking the resource manager’s transaction enlistment interface.</li>
</ol>
<p>
For example, the application program uses the ODBC <b>SQLSetConnectOption</b> to propagate the MS DTC transaction object to resource managers that support ODBC. All subsequent work done on the ODBC connection is performed as part of the transaction. When the resource manager becomes aware of the MS DTC transaction, it enlists in the transaction with its local MS DTC transaction manager.  This permits the resource manager to participate in the two-phase commit protocol and to receive transaction commit or abort notifications from MS DTC.
<ol>
<li>
Invoking the normal resource manager functions that update transaction-protected resource manager data.</li>
</ol>
<p>
For example, the application might insert, delete, or update records in a relational database, or it might invoke a database stored procedure that modifies the relational database.
<ol>
<li>
Calling <b>Commit</b> when the work of the transaction is complete. In response to the <b>Commit</b> call, MS DTC uses the two-phase commit protocol to coordinate commitment of the transaction with all of the resource managers enlisted in the transaction. Alternatively, the application program could call <b>Abort</b> to undo the effects of the transaction. The application may then go on to perform more MS DTC transactions.</li>
<li>
Releasing the transaction dispenser object and closing the ODBC connections when the application program completes.</li>
</ol>
<p>
Application programs that initiate MS DTC transactions must reside on a system on which either the Complete MS DTC Service or the MS DTC Client Utilities has been installed. The resource manager must reside on a system on which the Complete MS DTC Service has been installed. For information on installation and configuration of MS DTC, refer to "Setting Up an MS DTC System" in the <i>MS DTC Administrator's Guide and Programmer’s Reference.</i></p>
<p>&nbsp; </p></body>
</HTML>
