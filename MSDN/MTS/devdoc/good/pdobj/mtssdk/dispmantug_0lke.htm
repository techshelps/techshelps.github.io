<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Enlisting In a Transaction</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<p>
<a name="asenlistinginatransaction"></a>Enlisting In a Transaction</p>
<p>
After a resource is allocated, but just before returning the resource to the resource dispenser, DispMan checks with the MTS Executive to see if the calling object is running within a transaction. If the calling object is running within a transaction, then DispMan calls back to the resource dispenser and asks it to enlist the resource in the transaction. Then the resource is returned to the resource dispenser, which then returns it to the calling instance.</p>
<p>
The resource dispenser must be able to enlist in an OLE Transactions transaction with the Microsoft Distributed Transaction Coordinator (MS DTC). For more information, see the <i>Resource Manager's Guide</i>.</p>
<p>
Transaction enlistment is optional when a resource dispenser dispenses non-transactional resources, such as memory or threads.</p>
<p>
The MTS Executive notifies DispMan when a transaction is complete, whether it committed or aborted. Then DispMan notifies each resource dispenser's holder that any resources enlisted in this transaction can now be moved to general inventory.</p>
<p>&nbsp; </p></body>
</HTML>
