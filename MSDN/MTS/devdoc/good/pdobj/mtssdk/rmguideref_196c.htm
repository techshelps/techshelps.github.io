<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ITransactionResourceAsync::PrepareRequest</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<p>
<a name="asitransactionresourceasyncpreparerequest"></a>ITransactionResourceAsync::PrepareRequest</p>
<p>
The MS DTC proxy calls this method to prepare a transaction (phase one of the two-phase commit protocol).</p>
<pre><b>HRESULT PrepareRequest (</b></pre>
<table cellspacing=5 cols=2>
<tr valign=top>
<td width=27%><pre><b>BOOL</b></pre>
</td>
<td width=73%><pre><i>fRetaining</i><b>,</b></pre>
</td>
</tr>
<tr valign=top>
<td width=27%><pre><b>DWORD</b></pre>
</td>
<td width=73%><pre><i>grfRM</i><b>,</b></pre>
</td>
</tr>
<tr valign=top>
<td width=27%><pre><b>BOOL</b></pre>
</td>
<td width=73%><pre><i>fWantMoniker</i><b>,</b></pre>
</td>
</tr>
<tr valign=top>
<td width=27%><pre><b>BOOL</b></pre>
</td>
<td width=73%><pre><i>fSinglePhase</i><b>);</b></pre>
</td>
</tr>
</table><br>
<p>
<b>Parameters</b></p>
<p>
<i>fRetaining</i> [in]<br>
FALSE for MS DTC version 1.0.</p>
<p>
<i>grfRM</i> [in]<br>
Values from XACTRM.</p>
<p>
<i>fWantMoniker</i> [in]<br>
FALSE for MS DTC version 1.0.</p>
<p>
<i>fSinglePhase</i> [in]<br>
If TRUE, it indicates that the RM is the only resource manager enlisted on the transaction.</p>
<p>
<b>Return Values</b></p>
<p>
S_OK<br>
Success. The resource manager’s <i>transaction object</i> has started preparing.</p>
<p>
<b>Comments</b></p>
<p>
The resource manager needs to return from this call as soon as the <i>transaction object</i> starts preparing. After the transaction object is prepared the resource manager needs to call <b>ITransactionEnlistmentAsync::PrepareRequestDone</b>.</p>
<p>
If <i>fSinglePhase</i> flag is TRUE, it indicates that the RM is the only resource manager enlisted on the transaction. and therefore it has the option to perform the single phase optimization. If the RM does choose to perform the single phase optimization, then it lets the Transaction Coordinator know of this optimization by providing XACT_S_SINGLEPHASE flag to the <b>ITransactionEnlsitementAsync::PrepareRequestDone</b>.</p>
<p>&nbsp; </p></body>
</HTML>
