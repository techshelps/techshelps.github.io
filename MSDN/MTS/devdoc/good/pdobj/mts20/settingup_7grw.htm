<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Up the MTS Sample Bank Application</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="asvalidatingsql"></a>Setting Up the MTS Sample Bank Application</h1>
<p>
The Sample Bank application is a banking services application that credits, debits, and transfers money between accounts. Running the Sample Bank application allows you to test your installation of MTS with SQL Server 6.5 as well as practice package deployment and administration. Sample Bank has components written in Visual Basic, Visual C++, and Visual J++, and is located in the \MTS\Samples subdirectory. In addition, MTS provides an Active Server Page (ASP) that calls the Sample Bank components. This sample is called Bank.asp and is located in the \MTS\Samples\asp sub-directory.</p>
<p>
The <i>MTS Programmer’s Guide</i> provides an extensive tutorial describing how to build Sample Bank components.</p>
<p>
To run the Sample Bank application, you must:
<ul>
<li>
Select the <b>Custom</b> setup option and choose all MTS sub-components. See the <a href="settingup_93u6.htm">Installing MTS Development Samples and Documentation</a> topic for more information.</li>
<li>
Set up the DSN.</li>
<li>
Install the <b>Sample Bank</b> package.</li>
<li>
Set up the MTS Explorer to monitor the <b>Sample Bank</b> package.</li>
<li>
Run the Bank Client.</li>
</ul>
<h3>Setting Up the Sample Bank Application</h3>
<p>
MTS automatically configures the ODBC data source for Sample Bank during setup. Since the local machine is used by default, you must have SQL Server 6.5 installed on your local machine. </p>
<p>
By default, the MTS DSN points to SQL Server 6.5. If you are using a database other than SQL Server 6.5, you must delete the DSN and add a new DSN called MTSSamples that points to your database.</p>
<p>
If you want to use a SQL Server installation on another machine, use the ODBC service icon in the Control Panel to modify your data source as follows:
<ul>
<li>
In the <b>Data Sources</b> dialog box, click the <b>File DSN</b> tab, and select the MTSSamples data source.</li>
<li>
Click <b>Configure</b> and enter the name of the server you want to use.</li>
</ul>
<p>
Note that the Login ID and Password specified by the MTSSamples DSN are not used by Sample Bank. Sample Bank uses the "sa" account and null password. If your system administrator password is non-null or you want to specify a different login ID, you will have to modify the ODBC connection string in the Sample Bank source code.</p>
<p>
<b><img src="images/prcarrow.gif" border=0>To monitor the Sample Bank package components and transactions</b>
<ol>
<li>
Double-click the <b>Sample Bank</b> package icon in the right pane of the MTS Explorer. </li>
<li>
Double-click the Components<b> </b>folder.</li>
<li>
On the <b>View</b> menu, click <b>Status View</b> to display usage information for the various components in the package.</li>
<li>
On the <b>Window</b> menu, click <b>New Window</b>. </li>
<li>
Re-arrange the new window so the two windows do not overlap. You can stack different windows by selecting either the <b>Cascade</b> or <b>Tile</b> <b>Horizontally</b> options from the Window menu.</li>
<li>
Click <b>Transaction Statistics</b> in the left pane of the new window.</li>
<li>
On the <b>Action</b> menu, click <b>Scope</b> to clear the check mark and hide the left pane. Now transactions statistics are displayed when transactional components are used.</li>
</ol>
<p>
<b><img src="images/prcarrow.gif" border=0>To run the Bank client</b>
<ol>
<li>
Make sure that Microsoft Distributed Transaction Coordinator (MS DTC) is running. Select <b>My Computer</b> in the left pane of the Transaction Server Explorer. Open the <b>Action</b> menu and click <b>Start MS DTC</b> if that option is enabled.</li>
<li>
Make sure that SQL Server is running. You can start SQL Server from Control Panel.</li>
<li>
On the <b>Start</b> menu, point to <b>Programs</b>, point to <b>Microsoft Transaction Server</b>, point to <b>Samples</b>, and click <b>Bank Client</b>. Arrange the Bank Client window so that it does not overlap the MTS Explorer windows.</li>
<li>
The form will default to credit $1 to account number 1. Click <b>Submit</b>. You should see a response with the new balance.</li>
<li>
Observe the MTS Explorer windows. You will notice that the component usage and transaction statistics windows have been updated.</li>
<li>
Experiment with the bank client and observe the statistics using different transaction types, servers, and iterations. The first transaction takes longer than subsequent transaction for the following reasons:<ul>
<li>
The first transaction is creating the sample bank database tables and inserting temporary records.</li>
<li>
Beginning the server process consumes system resources.</li>
<li>
Opening database connections for the first time is a costly server operation.</li>
</ul>
</li>
</ol>
<p>
<img src="images/vigs01.gif" border=0></p>
<p>&nbsp; </p></body>
</HTML>
