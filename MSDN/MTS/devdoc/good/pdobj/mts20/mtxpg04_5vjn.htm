<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Transaction Context Objects</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="astransactioncontextobjects"></a>Transaction Context Objects</h1>
<p>
The <i>transaction context object</i> allows base clients to combine the work of multiple MTS objects into a single transaction, without having to develop a new component specifically for that purpose.</p>
<p>
The transaction context object's methods use its context object as follows:
<ul>
<li>
<b>CreateInstance</b>&nbsp;— Calls <b>CreateInstance</b> and returns a reference to the newly created object.</li>
</ul>
<p>
<img src="images/context1.gif" border=0>
<ul>
<li>
<b>Commit</b>&nbsp;— Calls <b>SetComplete</b> and returns.</li>
</ul>
<p>
<img src="images/context2.gif" border=0>
<ul>
<li>
<b>Abort</b>&nbsp;— Calls <b>SetAbort</b> and returns.</li>
</ul>
<p>
<img src="images/context3.gif" border=0></p>
<p>
The transaction context component is defined as <b>Requires a New Transaction</b>. You cannot use the transaction context object to enlist in an existing transaction.</p>
<p>
For example, suppose you have two components, Walk and ChewGum. Each component is defined as <b>Supports Transactions</b> and calls <b>SetComplete</b> when it is finished with its work. A base client could compose the work done by each component in a single transaction.</p>
<pre><code>Dim objTxCtx As TransactionContext
Dim objWalk As MyApp.Walk
Dim objChewGum As MyApp.ChewGum

' Get TransactionContext
Set objTxCtx = _
    CreateObject("TxCtx.TransactionContext")

' Create instances of Walk and ChewGum
Set objWalk = _
    objTxCtx.CreateInstance("MyApp.Walk")
Set objChewGum = _
    objTxCtx.CreateInstance("MyApp.ChewGum")

' Both components do work
objWalk.Walk
objChewGum.ChewGum

' Commit the transaction
objTxCtx.Commit</code></pre>
<p>
Transaction Context Object Limitations</p>
<p>
Note the following limitations when using a transaction context object:
<ul>
<li>
Transaction composition</li>
<li>
Location transparency</li>
<li>
Base client does not have context</li>
</ul>
<h6>Transaction Composition</h6>
<p>
When using a transaction context object, the application logic that composes the work into a single transaction is tied to a specific base client implementation and the advantages of using MTS components are lost. These implementations include:
<ul>
<li>
Ability to reuse the application logic as part of an even larger transaction</li>
<li>
Imposition of declarative security</li>
<li>
Flexibility to run the logic remotely from the client</li>
</ul>
<h6>Location Transparency</h6>
<p>
The transaction context object runs <i>in-process</i> with the base client, which means that MTS must exist on the base client computer. This may not be a problem, for example when the transaction context object is used from an Active Server Page (ASP) that is running on the same server as MTS.</p>
<h6>Base Client Does Not Have Context</h6>
<p>
You do not get a context for the base client when you create a transaction context object. Transactional work can only be done indirectly, through MTS objects created by using the transaction context object. In particular, the base client cannot use MTS <i>resource dispensers </i>(such as ODBC) and have the work included in of the transaction. For example, developers may be familiar with the following syntax for doing transactional work on relational database systems:</p>
<pre><code>BEGIN TRANSACTION
    DoWork
COMMIT TRANSACTION</code></pre>
<p>
Using the transaction context object in a similar way does not yield the desired result:</p>
<pre><code>Set objTxCtx = CreateObject("TxCtx.TransactionContext")
    DoWork
    objTxCtx.Commit
Set objTxCtx = Nothing</code></pre>
<p>
The call to DoWork in this example will not be enlisted in a transaction. You must build an MTS component that calls DoWork, create an object instance of that component using the transaction context object, then call that object from the base client in order for the work to be part of the client-controlled transaction.</p>
<h6>See Also</h6>
<p>
<a href="mtxpg04_5soj.htm">Transactions</a>, <a href="disamb01_66lw.htm"><b>TransactionContext</b> Object</a></p>
<p>&nbsp; </p></body>
</HTML>
