<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ITransactionContextEx::Commit Method (Visual C++)</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="asmthcommitvc"></a>ITransactionContextEx::Commit Method</h1>
<p>
Attempts to commit the current <a href="vipdef01_1yih.htm#asdeftransaction">transaction</a>.</p>
<p>
<b>Provided By</b></p>
<p>
<a href="transctxvc_7un7.htm"><b>ITransactionContextEx</b> Interface</a></p>
<pre><b>HRESULT ITransactionContextEx::Commit ( );</b></pre>
<p>
<b>Return Values</b></p>
<p>
S_OK<br>
The transaction was committed.</p>
<p>
E_FAIL<br>
The <b>TransactionContextEx</b> object isn't running under a MTS process. This could happen if the <b>TransactionContextEx</b> component's Registry entry has been corrupted.</p>
<p>
E_UNEXPECTED<br>
An unexpected error occurred.</p>
<p>
CONTEXT_E_ABORTED<br>
The transaction was aborted.</p>
<p>
<b>Remarks</b></p>
<p>
Calling <b>Commit</b> doesn't guarantee that a transaction will be committed. If any <a href="vipdef01_1yih.htm#asdefmicrosofttransactionserverobject">MTS object</a> that was part of the transaction has returned from a method after calling <b>SetAbort</b>, the transaction will be aborted. If any object that was part of the transaction has called <b>DisableCommit</b> and hasn't yet called <b>EnableCommit</b> or <b>SetComplete</b>, the transaction will also be aborted. Any error that causes <a href="vipdef01_1yih.htm#asdefdtc">Microsoft Distributed Transaction Coordinator</a> to abort a transaction will also abort an MTS transaction.</p>
<p>
When a <a href="vipdef01_1yih.htm#asdefbaseclient">base client</a> calls <b>Commit</b>, regardless of whether the transaction commits or aborts, the transaction is completed on return from this method and all objects that participated in the transaction are automatically deactivated. If another call comes in after the <b>TransactionContextEx</b> object has returned from a call in which it called the <b>Commit</b> method, a new transaction is started.</p>
<p>
<a href="transctxvc_46ns.htm"><b>Example</b></a></p>
<p>
<b>See Also</b></p>
<p>
<a href="mtxpg04_5vjn.htm">Transaction Context Objects</a>, <a href="mtxpg04_09rn.htm">Base Clients</a>, <a href="mtxpg04_5soj.htm">Transactions</a>, <a href="objctxvc_8mw3.htm"><b>SetComplete</b></a></p>
<p>&nbsp; </p></body>
</HTML>
