<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Configuring MTS with Microsoft Cluster Server</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="asconfiguringmtswithmicrosoftclusterserver"></a>Configuring MTS with Microsoft Cluster Server</h1>
<p>
Microsoft Cluster Server (MSCS) is the clustering solution for computers running Windows&nbsp;NT Server. MSCS version 1.0 supports clusters of two specially linked servers running Windows&nbsp;NT Server. If one server in a cluster fails or is taken offline, the other server takes over the failed server's operations. </p>
<p>
If you wish to use Microsoft Transaction Server with MSCS, first install Windows NT Server 4.0 Enterprise. Then install Microsoft Cluster Server 1.0. Finally, install Microsoft Transaction Server 2.0 as described below.</p>
<p>
<b>Note</b>   MTS 2.0 cluster support does not work with pre-release versions of Microsoft Cluster Server 1.0. Installing MTS 2.0 with a pre-release version of Microsoft Cluster Server will prevent MSCS from functioning properly. </p>
<p>
For more information on MSCS, see Windows NT Books Online.</p>
<p>
<b><img src="images/prcarrow.gif" border=0> To install Microsoft Transaction Server 2.0 with Microsoft Cluster Server 1.0</b>
<ol>
<li>
Install Windows NT Server 4.0 Enterprise.</li>
<li>
Install MSCS 1.0 on all computers in the cluster.</li>
<li>
Use the MSCS Cluster Administrator to configure a Group to contain a Network Name Resource and a Shared Disk Resource. </li>
<li>
Install Microsoft Transaction Server 2.0 on the node that owns the Group configured above. See <a href="settingup_9b1s.htm">Setting Up Microsoft Transaction Server</a> for more information.</li>
<li>
When MTS setup detects that MSCS is present on the system, it will display a dialog box asking you to specify the name of the Virtual Server on which Microsoft Distributed Transaction Coordinator should be installed. Specify the name of the Network Name Resource configured in step 3.</li>
<li>
In the same dialog box, specify the location for the MS DTC log file on the shared disk configured in step 3.</li>
<li>
Click <b>NEXT </b>to continue MTS setup.</li>
<li>
Install MTS on the second computer in the cluster. You will not be prompted for the virtual server and log file location during setup.</li>
</ol>
<p>
Do not run MTS setup in parallel on cluster nodes. Completely install MTS on one node, then install MTS on the second node without rebooting the first node. When both nodes have MTS installed, reboot them.</p>
<p>
<b>Note</b>  You do not not need to uninstall Microsoft Transaction Server 1.0 before Microsoft Transaction Server 2.0 with Microsoft Cluster Server 1.0. Follow the instructions for installing MTS 2.0 with MCS 1.0.</p>
<p>
<b><img src="images/prcarrow.gif" border=0> To upgrade from Microsoft Transaction Server 1.1 to Microsoft Transaction Server 2.0 with Microsoft Cluster Server</b>
<ol>
<li>
Delete all Microsoft Transaction Server package resources that you created when using Microsoft Transaction Server 1.1 with Microsoft Cluster Server.</li>
<li>
Run the Microsoft Transaction Server 2.0 setup program on the cluster node that owns the Microsoft Distributed Transaction Coordinator resource. This will automatically perform the upgrade on this node.  Ensure that Microsoft Transaction Server setup runs to completion before starting the next step.</li>
<li>
Run the Microsoft Transaction Server 2.0 setup program on the second node of the cluster.</li>
<li>
Reboot both cluster nodes.</li>
</ol>
<h3>Uninstalling Microsoft Cluster Server on an MTS Server</h3>
<p>
If you want to uninstall Microsoft Cluster Server from one of the nodes in a  cluster, follow these steps:
<ol>
<li>
Using the Cluster Administrator to take the Microsoft Distributed Transaction Coordinator resource offline.</li>
<li>
Uninstall Microsoft Cluster Server from the node and reboot the node.</li>
<li>
Change the location of the Microsoft Distributed Transaction Coordinator log file using the Transaction Server Explorer. The log file must be placed on a non-shared disk. Failing to do this may result in a corrupted log file or access violations in Microsoft Distributed Transaction Coordinator. </li>
</ol>
<h3>Resetting the MS DTC Log File on Clustered Servers</h3>
<p>
To reset the MS DTC log file on a clustered server, you must run the MTS Explorer on the node that currently owns the shared disk containing the log file.</p>
<h3>Starting and Stopping MS DTC on Clustered Servers</h3>
<p>
On a clustered server, you can start and stop MS DTC by either using the MTS Explorer or using the MSCS administrative utility. Using the "net start msdtc" or "net stop msdtc" command does not work. To start and stop MS DTC on an MSCS cluster from the command line, use "msdtc -start" and "msdtc -stop", respectively.</p>
<h3>Calling MTS Objects after MSCS Failover</h3>
<p>
Microsoft Transaction Server client applications must always release all references to MTS components on the failing node, and re-instantiate the components. The components are instantiated on the second node. </p>
<h3>Using the Remote Components Folder with Clustered Servers</h3>
<p>
You can use the Remote Components folder to pull components from a Microsoft Cluster Server (MSCS) node by following these steps:
<ol>
<li>
On the server computer from which you will pull components, right-click on My Computer and select <b>Properties</b>. </li>
<li>
Click the <b>Options</b> tab and enter the name of the virtual server in the <b>Remote Server Name</b> field. Click <b>OK</b>. </li>
<li>
On the client computer to which you will pull components, add the MSCS computer to the Computers folder using the physical name of the server.</li>
<li>
Select the Remote Components folder and choose <b>New</b> from the <b>Action</b> menu. You can also right-click the Remote Components folder, select <b>New</b> and then <b>Component</b>.</li>
<li>
Follow the instructions in the remote component installation wizard. Note that during the installation of remote components, the physical name of the server will be displayed rather than the virtual name (as specified in the <b>Remote</b> <b>Server</b> <b>Name</b> field of the server computer).</li>
<li>
Select the Remote Components folder and click the Property View button on the MTS Explorer toolbar. The Server column in the Property View window displays the virtual server name.</li>
</ol>
<p>
<b>Note</b>   If you change the remote server name on the MSCS computer, you must also reinstall the remote components on client computers.</p>
<h3>Replicating Empty Packages</h3>
<p>
MTS replication does not replicate empty packages.</p>
<p>&nbsp; </p></body>
</HTML>
