<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Scenario: Storing Receipt Numbers in a Database (Visual Basic)</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="asconscenariostoringrecieptnumbersinadatabase"></a>Scenario: Storing Receipt Numbers in a Database</h1>
<p>
In <a href="mtxpg08vb_4hnp.htm">Sharing State</a>, you added the Receipt <a href="vipdef01_1yih.htm#asdefcomponent">component</a>, which assigns a unique receipt number to each monetary transaction. The Shared Property Manager maintains these values, so they exist for the duration of the <a href="vipdef01_1yih.htm#asdefasp">server process</a>. In this section, you will add code to store a maximum receipt number in a database. Storing them makes receipt numbers unique beyond the life of the server process.</p>
<p>
You will create the UpdateReceipt component, which stores a maximum receipt number in a database. When this maximum is reached, which happens on every one-hundredth transaction, UpdateReceipt adds 100 to the maximum receipt value and updates the database.</p>
<p>
You will install the UpdateReceipt component so that it creates a new <a href="vipdef01_1yih.htm#asdeftransaction">transaction</a>, separate from those of the Account objects. The section will then discuss the advantages of using multiple transactions in this scenario. The application looks like the following figure (the Shared Property Manager and its associated objects are omitted for clarity):</p>
<p>
<img src="images/vi1001.gif" border=0></p>
<h5>See Also</h5>
<p>
<a href="mtxpg04_5soj.htm">Transactions</a>, <a href="mtxpg04_8ier.htm">Transaction Attributes</a>, <a href="mtxpg04_5tf7.htm">Activities</a>, <a href="mtxpg08vb_4hnp.htm">Sharing State</a></p>
<p>&nbsp; </p></body>
</HTML>
