<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Database Access Interfaces with MTS</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="asdatabaseaccessinterfaceswithmts"></a>Database Access Interfaces with MTS</h1>
<p>
This topic describes the database access interface options for MTS applications. You can use the Open Database Connectivity (ODBC) Application Programming Interface (API) to access a <i>resource manager</i> (which is a system service that manages durable data), or a data access model that functions over the ODBC layer. Because the ODBC version 3.0 Driver Manager is an MTS resource dispenser, data accessed via ODBC is automatically protected by your object's transaction. For object transactions, an ODBC-compliant database must support the following:
<ul>
<li>
The database's ODBC driver must be thread safe. It also must be able to connect to the driver from one thread, use the connection from another thread, and disconnect from another thread.</li>
<li>
If ODBC is used from within a transactional component, then the ODBC driver must also support the SQL_ATTR_ENLIST_IN_DTC connection attribute. This is how the ODBC Driver Manager asks the ODBC driver to enlist a connection on a transaction. You can make your component transactional by setting the transaction property for your component in the MTS Explorer. If you are using a database without a resource dispenser that can recognize MTS transactions, contact your database vendor to obtain the required support.</li>
</ul>
<p>
The following table summarizes database requirements for full MTS support.</p>
<table cellspacing=5 cols=3>
<tr valign=top>
<th align=left width=27%>Requirements</th>
<th align=left width=34%>Description</th>
<th align=left width=39%>Resources (if applicable)</th>
</tr>
<tr valign=top>
<td colspan=3 width=100%><b> </b></td>
</tr>
<tr valign=top>
<td width=27%>Support for the OLE transactions specification, or support for XA protocol</td>
<td width=34%>Enables direct interaction with Distributed Transaction Coordinator (DTC). Use the XA Mapper to interact with DTC</td>
<td width=39%>MTS Beta SDK</td>
</tr>
<tr valign=top>
<td width=27%>ODBC driver </td>
<td width=34%>Platform requirement for MTS server components</td>
<td width=39%>ODBC version 3.0 SDK</td>
</tr>
<tr valign=top>
<td width=27%>ODBC driver support for the ODBC version 3.0 SetConnectAttr SQL_ATTR_ENLIST_<br>
IN_DTC call.</td>
<td width=34%>MTS uses this call to pass the transaction identifier to the ODBC driver. The ODBC driver then passes the transaction identifier to the database engine.</td>
<td width=39%>ODBC version 3.0 SDK</td>
</tr>
<tr valign=top>
<td width=27%>Fully thread-safe ODBC driver</td>
<td width=34%>ODBC driver must be able to handle concurrent calls from any thread at any time.</td>
<td width=39%>ODBC version 3.0 SDK</td>
</tr>
<tr valign=top>
<td width=27%>ODBC driver must not require thread affinity</td>
<td width=34%>ODBC driver must be able to connect to the driver from one thread, use the connection from another thread, and disconnect from another thread.</td>
<td width=39%>ODBC version 3.0 SDK</td>
</tr>
</table><br>
<p>
If a memory access violation in the mtx.exe process occurs within the driver after 60 seconds of inactivity, you may be using an ODBC driver that is not thread safe or requires thread affinity. The fault occurs in the driver when the inactive connections are being disconnected. </p>
<p>
MTS Distributed Transaction Coordinator</p>
<p>
MTS uses the services of the Microsoft Distributed Transaction Coordinator (DTC) for transaction coordination. DTC is a system service that coordinates transactions that span multiple resource managers. Work can be committed as a single transaction, even if it spans multiple resource managers, potentially on separate computers. DTC was initially released as part of Microsoft SQL Server version 6.5, and is included as part of MTS. DTC implements a <i>two-phase commit protocol</i> that ensures that the transaction outcome (either <i>commit</i> or <i>abort</i>) is consistent across all resource managers involved in a transaction. DTC supports resource managers that implement OLE Transactions, X/Open XA protocols, and LU 6.2 Sync Level 2.</p>
<p>
Choosing your Data Access Model</p>
<p>
The following table summarizes commonly used data access models supported by MTS.</p>
<table cellspacing=5 cols=2>
<tr valign=top>
<th align=left width=23%>Interface</th>
<th align=left width=77%>Description</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%></td>
</tr>
<tr valign=top>
<td width=23%>Microsoft ActiveX Data Objects (ADO), Remote Data Service (RDS) </td>
<td width=77%>ADO offers one common yet extensible programming model for accessing data. ADO includes the ability to pass query results (<i>Recordsets</i>) between server and client, and the ability to pass updated Recordsets from client to server using RDS.</td>
</tr>
<tr valign=top>
<td width=23%>OLE DB</td>
<td width=77%>OLE DB is a low-level interface that provides uniform access to any tabular data source. You cannot call OLE DB interfaces directly from Microsoft® Visual Basic® because OLE DB is a pointer-based interface. A Visual Basic client can access an OLE DB data source through ADO.</td>
</tr>
<tr valign=top>
<td width=23%>Open DataBase Connectivity (ODBC)</td>
<td width=77%>ODBC is a recognized standard interface to relational data sources. ODBC is fast and provides a universal interface that is not optimized for any specific data source.</td>
</tr>
<tr valign=top>
<td width=23%>Remote Data Objects (RDO)</td>
<td width=77%>RDO is a thin object layer interface to the ODBC API. It is specifically designed to access remote ODBC relational data sources. </td>
</tr>
</table><br>
<p>
The diagram below illustrates how MTS components interact with the different data access interfaces:</p>
<p>
<img src="images/datahei.gif" border=0></p>
<p>
ADO is not specifically designed for relational or ISAM databases, but as an object interface to <i>any</i> data source. ADO can access relational databases, ISAM, text, hierarchical, or any type of data source, as long as a data access provider exists. ADO is built around a set of core functions that all data sources are expected to implement. ADO can access native OLE DB data sources, including a specific OLE DB provider that provides access to ODBC drivers. ADO ships with the OLE DB Software Development Kit (SDK).</p>
<p>
RDO does have some functionality that is not currently implemented in ADO, including the following:
<ul>
<li>
Events on the Engine, Connection, Resultset, and Column objects</li>
<li>
Asynchronous operations</li>
<li>
Queries as methods</li>
<li>
Enhanced batch-mode error and contingency handling</li>
<li>
Tight integration with Visual Basic, as in the Query Connection designer and TSQL debugger.</li>
</ul>
<p>
Future versions of ADO will provide a superset of RDO version 2.0 functionality and provide a far more sophisticated interface, in addition to an easier programming model. Because ADO is an Automation-based component, any application or language capable of working with Automation objects can use it.</p>
<p>&nbsp; </p></body>
</HTML>
