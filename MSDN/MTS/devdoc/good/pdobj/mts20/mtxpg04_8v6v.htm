<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Object Pooling and Recycling</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="asconobjectpoolingandrecycling"></a>Object Pooling and Recycling</h1>
<p>
Objects that support the <b>IObjectControl </b>interface can participate in <a href="vipdef01_1yih.htm#asdefobject">object</a> recycling and <a href="vipdef01_1yih.htm#asdefpooling">pooling</a>, which can increase the efficiency of activation and deactivation. After MTS calls the <b>Deactivate</b> method, it calls the <b>CanBePooled</b> method, allowing the object to be pooled for reuse. If the object returns TRUE, the object is added to the object pool. Objects that return FALSE or that do notsupport the <b>IObjectControl</b> interface are destroyed.</p>
<p>
On activation, MTS uses an object from the pool if one is available. Only if the pool is empty will it use the component's <a href="vipdef01_1yih.htm#asdefclassfactory">class factory</a> to create a new object.</p>
<p>
<a href="vipdef01_1yih.htm#asdefvipercomponent">Components</a> that support object pooling must ensure that an object activated using an object from the pool is indistinguishable to the client from an object that is activated by creating a new object. Component developers must provide the appropriate code in the <b>Activate</b> and <b>Deactivate</b> method implementations to ensure this behavior.</p>
<p>
The following table summarizes MTS run-time actions for client call processing.</p>
<table cellspacing=5 cols=3>
<tr valign=top>
<td width=27%></td>
<td colspan=2 width=73%><b>IObjectControl implemented by component</b></td>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=35%><b>No</b></td>
<td width=38%><b>Yes</b></td>
</tr>
<tr valign=top>
<td colspan=3 width=100%></td>
</tr>
<tr valign=top>
<td width=27%><b>Step 1</b><p>
Activate the object if needed (<a href="vipdef01_1yih.htm#asdefinstancestream">just-in-time activation</a>).</p>
</td>
<td width=35%><p>
Use the component <a href="vipdef01_1yih.htm#asdefclassfactory">class factory</a> to create an object.</p>
</td>
<td width=38%><p>
Allocate an object from the pool. If pooling is not supported or the pool is empty, then use the component class factory to create an object.</p>
</td>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=35%></td>
<td width=38%>Call the object's <b>Activate</b> method.</td>
</tr>
<tr valign=top>
<td width=27%><b>Step 2</b><p>
Execute the call. </p>
</td>
<td width=35%><p>
Call the object method.</p>
</td>
<td width=38%><p>
Call the object method.</p>
</td>
</tr>
<tr valign=top>
<td width=27%><b>Step 3</b><p>
Deactivate the object if requested (<b>SetComplete</b> or <b>SetAbort</b> called before return).</p>
</td>
<td width=35%></td>
<td width=38%><p>
Call object's <b>Deactivate</b> method</p>
</td>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=35%>Release the last reference held by the MTS run-time environment.</td>
<td width=38%>If the system supports pooling, then call <b>CanBePooled</b>. If it returns TRUE, then add the object to the pool. Otherwise, release the last reference held by the MTS run-time environment.</td>
</tr>
</table><br>
<p>
<b>Important</b>   Object pooling and recycling is not available in this release. MTS calls <b>CanBePooled</b> as described here, but no pooling takes place. This forward-compatibility encourages developers to use <b>CanBePooled</b> in their applications now in order to benefit from a future release without having to modify their applications later.</p>
<h6>See Also</h6>
<p>
<a href="mtxpg04_5s37.htm">Deactivating Objects</a>, <a href="disamb01_7f70.htm"><b>IObjectControl</b></a></p>
<p>&nbsp; </p></body>
</HTML>
