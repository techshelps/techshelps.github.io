<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Scenario: A Receipt Number Generator That Uses the Shared Property Manager (Visual Basic)</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="asconscenarioordercountcomponent"></a>Scenario: A Receipt Number Generator That Uses the Shared Property Manager</h1>
<p>
This chapter introduces the Receipt <a href="vipdef01_1yih.htm#asdefvipercomponent">component</a>, which dispenses unique receipt numbers for fund transfers. When a bank transaction takes place, the MoveMoney object creates a Receipt <a href="vipdef01_1yih.htm#asdefobject">object</a>. The Receipt component contains a single <a href="vipdef01_1yih.htm#asdefmethod">method</a>, GetNextReceipt.</p>
<p>
GetNextReceipt uses the Shared Property Manager to get a unique receipt number. The Shared Property Manager has an object hierarchy as shown in the following figure:</p>
<p>
<img src="images/vi0801.gif" border=0></p>
<p>
Within a <a href="vipdef01_1yih.htm#asdefasp">server process</a>, there is only one <a href="vipdef01_1yih.htm#asdefinstance">instance</a> of the <b>SharedPropertyGroupManager</b> object. The value of the receipt number is maintained by a <b>SharedProperty </b>object, which provides locking mechanisms to ensure that no two calls to GetNextReceipt retrieve the same value.</p>
<h5>See Also</h5>
<p>
<a href="mtxpg03_09gz.htm">Resource Dispensers</a>, <a href="mtxpg08vb_7o37.htm">Creating the Receipt Component</a>, <a href="mtxpg08vb_5o55.htm">Application Design Notes: Sharing State by Using the Shared Property Manager</a>, <a href="spamrefvb_4g2q.htm"><b>SharedPropertyGroupManager</b> object</a>, <a href="spamrefvb_9q76.htm"><b>SharedPropertyGroup</b> object</a>, <a href="spamrefvb_20gy.htm"><b>SharedProperty</b> object</a></p>
<p>&nbsp; </p></body>
</HTML>
