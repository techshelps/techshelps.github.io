<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ITransactionContextEx.CreateInstance Method (Visual J++)</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="asmthcreateinstancetransactionvj"></a>ITransactionContextEx.CreateInstance Method</h1>
<p>
Instantiates an <a href="vipdef01_1yih.htm#asdefmicrosofttransactionserverobject">MTS object</a> that will execute within the scope of the <a href="vipdef01_1yih.htm#asdeftransaction">transaction</a> that was initiated with the creation of the <b>TransactionContextEx</b> object.</p>
<p>
<b>Provided By</b></p>
<p>
<a href="transctxvj_7une.htm"><b>ITransactionContextEx</b> Interface</a></p>
<pre><b>IUnknown CreateInstance (
</b>    <b>_Guid </b><i>clsid</i>,
    <b>_Guid </b> <i>iid</i>,
<b>);</b></pre>
<p>
<b>Parameter</b></p>
<p>
<i>clsid</i><br>
[in] A reference to the <a href="vipdef01_1yih.htm#asdefclassid">CLSID</a> of the type of object to instantiate.</p>
<p>
<i>iid</i><br>
[in] Any interface that's implemented by the object you want to instantiate.</p>
<p>
<b>Return Value</b></p>
<p>
A reference to the <b>IUnknown</b> interface on a new instance of the <a href="vipdef01_1yih.htm#asdefvipercomponent">MTS component</a> specified in the <i>clsid </i>parameter.</p>
<p>
<b>Remarks</b></p>
<p>
When a <a href="vipdef01_1yih.htm#asdefbaseclient">base client</a> uses the <b>ITransactionContextEx.CreateInstance</b> method to instantiate an MTS object, the new object executes within the <a href="vipdef01_1yih.htm#asdeftransactioncontext">transaction context object</a>'s <a href="vipdef01_1yih.htm#asdefactivity">activity</a>. If the transaction attribute of the new object's component is set to either <b>Supports transactions</b> or <b>Requires a transaction</b>, the new object also inherits the <a href="vipdef01_1yih.htm#asdeftransaction">transaction</a> initiated with the creation of the <b>TransactionContextEx</b> object. However, if the component that provides the new object has its transaction attribute set to <b>Does not support transactions</b>, the object neither inherits the transaction nor passes it on to objects it subsequently creates. If the component that provides the new object has its transaction attribute set to <b>Requires a new transaction</b>, the MTS run-time environment initiates a new transaction for the new object, and that transaction is the one that's inherited by objects it subsequently creates.</p>
<p>
<b>CreateInstance</b> always returns the <b>IUnknown</b> interface on the newly instantiated object. You should immediately cast the returned value to the interface with which you want to communicate with the new object. The interface ID you pass in the <i>iid </i>parameter doesn't have to be the same interface to which you cast the returned value, but it must be an interface that's implemented by the object you want to instantiate.</p>
<p>
MTS always uses standard <a href="vipdef01_1yih.htm#asdefmarshaling">marshaling</a>. Even if a component exposes the <b>IMarshal</b> interface, its <b>IMarshal</b> methods will never be called by the MTS run-time environment.</p>
<p>
<b>Note</b>   You can't create MTS objects as part of an <a href="vipdef01_1yih.htm#asdefaggregation">aggregation</a>.</p>
<p>
<a href="transctxvj_7svs.htm"><b>Example</b></a></p>
<p>
<b>See Also</b></p>
<p>
<a href="mtxpg04_5vjn.htm">Transaction Context Objects</a>, <a href="mtxpg04_09rn.htm">Base Clients</a>, <a href="mtxpg04_5soj.htm">Transactions</a>, <a href="objctxvj_60ve.htm"><b>CreateInstance</b></a></p>
<p>&nbsp; </p></body>
</HTML>
