<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IObjectContext::SetComplete Method (Visual C++)</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="asmthsetcompletevc"></a>IObjectContext::SetComplete Method</h1>
<p>
Declares that the current object has completed its work and should be deactivated when the currently executing method returns to the client. For objects that are executing within the scope of a <a href="vipdef01_1yih.htm#asdeftransaction">transaction</a>, it also indicates that the object's transactional updates can be committed.</p>
<p>
<b>Provided By</b></p>
<p>
<a href="objctxvc_24tf.htm"><b>IObjectContext</b></a></p>
<pre><b>HRESULT IObjectContext::SetComplete ( );</b></pre>
<p>
<b>Return Values</b></p>
<p>
S_OK<br>
The call to <b>SetComplete</b> succeeded.</p>
<p>
E_UNEXPECTED<br>
An unexpected error occurred. This can happen if one object passes its <b>IObjectContext</b> pointer to another object and the other object calls <b>SetComplete</b> using this pointer. An <b>IObjectContext</b> pointer is not valid outside the <a href="vipdef01_1yih.htm#asdefcontext">context</a> of the object that originally obtained it.</p>
<p>
<b>Remarks</b></p>
<p>
The object is deactivated automatically on return from the method in which it called <b>SetComplete</b>. If the object is the root of an <a href="vipdef01_1yih.htm#asdefautomatictransaction">automatic transaction</a>, MTS attempts to commit the transaction. However, if any object that was participating in the transaction has called <b>SetAbort</b>, or has called <b>DisableCommit</b> and has not subsequently called <b>EnableCommit</b> or <b>SetComplete</b>, the transaction will be aborted. (An object is the root of a transaction if the MTS run-time environment has to initiate a new transaction for it. This is the case when the component that provides the object is configured to require a transaction and the object's <a href="vipdef01_1yih.htm#asdefcreator">creator</a> doesn't have one, or when the component is configured to require a new transaction.)</p>
<p>
If an object doesn't need to maintain its state after it returns from a method call, it should call <b>SetComplete</b> so that it can be automatically deactivated as soon as it returns and its resources can be reclaimed.</p>
<p>
<a href="objctxvc_18e0.htm"><b>Example</b></a></p>
<p>
<b>See Also</b></p>
<p>
<a href="mtxpg04_5soj.htm">Transactions</a>, <a href="mtxpg04_8b8z.htm">Context Objects</a>, <a href="mtxpg04_5s37.htm">Deactivating Objects</a></p>
<p>&nbsp; </p></body>
</HTML>
