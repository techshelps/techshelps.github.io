<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Visual Basic Script Samples for Automating MTS Administration</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="asusingscriptableobjectswithwindowsscriptinghost"></a>Visual Basic Script Samples for Automating MTS Administration</h1>
<p>
You can use an OLE-Automation compatible language (such as VBScript) to call the scriptable administration objects. MTS provides administrative sample scripts to demonstrate how to use the scriptable objects to automate MTS Explorer procedures.</p>
<p>
In order to run an Automation script outside of an HTML page, you must have the Windows Scripting Host (WSH) installed on your computer. WSH is a command-line scripting utility that can be installed by the Window NT 4.0 Option Pack for Windows NT computers. WSH enables scripts to be executed directly on the Windows desktop or command console. You do not need to embed those scripts in an HTML document; instead, scripts can be run directly from the desktop by clicking a script file, or from the command console. For more detailed information, see the Windows Scripting Host documentation. </p>
<p>
To demonstrate how to use the administration objects in a script, run the sample scripts contained in the \program files\mtx\samples\WSH sub-directory. The WSH sub-directory contains the following five sample scripts written in VB Script:
<ul>
<li>
InstDLL.vbs</li>
<li>
InstPak.vbs</li>
<li>
Uninst.vbs</li>
<li>
InstDllCLI.vbs</li>
<li>
InstPakCLI.vbs</li>
</ul>
<p>
These scripts automate administrative procedures for Sample Bank. For example, the InstDLL.vbs script calls scriptable objects to first delete existing versions of Sample Bank, create a new package named Sample Bank, install <a href="vipdef01_1yih.htm#asdefcomponent">components</a> from the Sample Bank Visual Basic, Visual C++, and Visual J++ DLLs into the new package, change transaction attributes, and add a new role. The InstPak.vbs script also uses the scriptable objects to install Sample Bank, while Uninst.vbs automates uninstalling the Sample Bank package from MTS. After running a script, you can see the results of the script in the MTS Explorer after clicking the <b>Refresh</b> toolbar button.</p>
<p>
In order to use the InstDLL.vbs, InstPak.vbs, and Uninst.vbs scripts, you must modify the file path in the script to point to the location of the required files on your computer. For example, the file path in the InstPak.vbs script is the default location for the Sample Bank package, which is:</p>
<pre><code>path="C:\Program Files\Samples\Packages\"</code></pre>
<p>
If you have the Sample Bank package installed in a difference location, modify that line in the script to point to the current location of the package.</p>
<p>
The InstDllCLI.vbs and InstPakCLI.vbs scripts support command line parameters so you can include the file location as a parameter when running your script in a console window. At the command prompt, open the directory containing the script you want to use, and type the name of the script and the location of the package or DLLs. For example, to install the Sample Bank package located in the default directory, open the directory containing the samples scripts and use the following command at the command prompt:</p>
<pre><code>InstPakCLI.vbs "C:\Program Files\MTX\Samples\Packages\"</code></pre>
<p>
To use the InstDLL.vbs script, you must first do one of the following to register the Java components in the vjacct.dll file:
<ul>
<li>
Install the package by running the InstDLL.vbs script</li>
<li>
Register the Java components using the Microsoft Visual Studio 97 ActiveX Wizard. </li>
</ul>
<p>
<b>See Also</b></p>
<p>
<a href="settingup_1l6b.htm">Setting Up the MTS Administrative Sample Scripts</a></p>
<p>&nbsp; </p></body>
</HTML>
