<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WNetCancelConnection2</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_wnetcancelconnection2"></a>WNetCancelConnection2</h1>
<p>
The <b>WNetCancelConnection2</b> function breaks an existing network connection. It can also be used to remove remembered network connections that are not currently connected. This function supersedes <b>WNetCancelConnection</b>.</p>
<pre><code><b>DWORD WNetCancelConnection2(
  LPTSTR</b><i> lpName</i><b>,  </b>// pointer to resource name to disconnect
<b>  DWORD</b><i> dwFlags</i><b>,  </b>// connection type flags
<b>  BOOL</b><i> fForce</i>     // flag for unconditional disconnect
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpName</i></dt>
<dd>
Points to a null-terminated string that specifies the name of either the redirected local device or the remote network resource to disconnect from. If this parameter specifies a redirected local resource, only the specified redirection is broken; otherwise, all connections to the remote network resource are broken. </dd>
<dt>
<i>dwFlags</i></dt>
<dd>
Specifies a bitmask for the connection type. The following values are defined: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=46%>Value</th>
<th align=left width=54%>Meaning</th>
</tr>
<tr valign=top>
<td width=46%>0</td>
<td width=54%>No stored information about the connection is updated. If the connection was marked as persistent in the registry, Windows will still restore the connection at the next logon. If the connection was not marked as persistent, the function ignores the setting of the CONNECT_UPDATE_PROFILE flag.</td>
</tr>
<tr valign=top>
<td width=46%>CONNECT_UPDATE_PROFILE</td>
<td width=54%>The user profile is updated with the information that this is no longer a persistent connection. Windows will not restore this connection during subsequent logon operations. Disconnecting resources using remote names has no effect on persistent connections.</td>
</tr>
</table><br>

</dd>
<dt>
<i>fForce</i></dt>
<dd>
Specifies whether the disconnection should occur even if there are open files or jobs on the connection. If this parameter is FALSE, the function fails if there are open files or jobs. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is NO_ERROR. </p>
<p>
If the function fails, the return value is an error code. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. <b>GetLastError</b> may return one of the following error codes: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=51%>Value</th>
<th align=left width=49%>Meaning</th>
</tr>
<tr valign=top>
<td width=51%>ERROR_BAD_PROFILE</td>
<td width=49%>The user profile is in an incorrect format.</td>
</tr>
<tr valign=top>
<td width=51%>ERROR_CANNOT_OPEN_PROFILE</td>
<td width=49%>The system is unable to open the user profile to process persistent connections.</td>
</tr>
<tr valign=top>
<td width=51%>ERROR_DEVICE_IN_USE</td>
<td width=49%>The device is in use by an active process and cannot be disconnected.</td>
</tr>
<tr valign=top>
<td width=51%>ERROR_EXTENDED_ERROR</td>
<td width=49%>A network-specific error occurred. To get a description of the error, use the <a href="networks_735e.htm"><b>WNetGetLastError</b></a> function.</td>
</tr>
<tr valign=top>
<td width=51%>ERROR_NOT_CONNECTED</td>
<td width=49%>The name specified by the <i>lpName</i> parameter is not a redirected device, or the system is not currently connected to the device specified by the parameter.</td>
</tr>
<tr valign=top>
<td width=51%>ERROR_OPEN_FILES</td>
<td width=49%>There are open files, and the <i>fForce</i> parameter is FALSE.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Use version 2.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winnetwk.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mpr.lib.</p>
<h4>See Also</h4>
<p>
<a href="networks_7t5r.htm">Windows Networking (WNet) Overview</a>, <a href="networks_0u43.htm">Windows Networking Functions</a>, <a href="networks_3epa.htm"><b>WNetAddConnection</b></a>, <a href="networks_84z6.htm"><b>WNetAddConnection2</b></a>, <a href="networks_84z7.htm"><b>WNetAddConnection3</b></a>, <a href="networks_5vou.htm"><b>WNetCancelConnection</b></a>, <a href="networks_84a6.htm"><b>WNetGetConnection</b></a>, <a href="networks_735e.htm"><b>WNetGetLastError</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
