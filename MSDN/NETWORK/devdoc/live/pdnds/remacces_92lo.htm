<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RAS Administration DLL</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_ras_administration_dll"></a>RAS Administration DLL</h3>
<p>
Windows NT version 4.0 enables you to install a RAS administration DLL on a Windows NT RAS server. The DLL exports functions that the RAS server calls whenever a user tries to connect or disconnect. You can use the DLL to perform the following administrative functions: 
<ul>
<li>
Decide whether to allow a user to connect to the server. This can provide a security check in addition to the standard RAS user authentication.</li>
<li>
Record the time that each user connects to and disconnects from the server. This can be useful for billing or auditing purposes. </li>
<li>
Assign an IP address to each user. This can be useful for security purposes to map a user's connection to a specific computer. </li>
</ul>
<p>
The <a href="remacces_00q6.htm"><b>RasAdminAcceptNewConnection</b></a> and <a href="remacces_4apa.htm"><b>RasAdminConnectionHangupNotification</b></a> functions enable the DLL to audit user connections to the server. A Windows NT RAS server calls the DLL's <b>RasAdminAcceptNewConnection</b> function whenever a user tries to connect. The function can prevent the user from connecting. You can also use the function to generate an entry in a log for billing or auditing. When the user disconnects, the RAS server calls the DLL's <b>RasAdminConnectionHangupNotification</b> function, which can log the time at which the user disconnected. </p>
<p>
After the RAS server has authenticated a caller, it calls the DLL's <a href="remacces_5n76.htm"><b>RasAdminGetIpAddressForUser</b></a> function to get an IP address for the dialed-in remote client. The DLL can use this function to provide an alternate scheme for mapping an IP address to a dial-in user. By default, a RAS server connects a remote user to an IP address selected from a static pool of IP addresses, or one selected by a Dynamic Host Configuration Protocol (DHCP) server. The <b>RasAdminGetIpAddressForUser</b> function allows the DLL to override the default IP address and specify a particular IP address for each user. The <b>RasAdminGetIpAddressForUser</b> function can set a flag that causes RAS to call the DLL's <a href="remacces_2fqr.htm"><b>RasAdminReleaseIPAddress</b></a> function when the user disconnects. The DLL can use <b>RasAdminReleaseIPAddress</b> to update its user-to-IP-address map.</p>
<p>
Note that RAS executes the functions for assigning IP addresses in one process, and executes the functions for connection and disconnection notifications in another process. Consequently, the DLL should not depend on shared data between the two sets of functions.</p>
<p>
The RAS server logs an error in the system event log if an error occurs when it tries to load a RAS administration DLL or when it calls one of the DLL's functions. This can happen, for example, if the DLL specified the wrong name for an exported function, or if it did not include the function name in the .DEF file. The entry in the event log indicates the reason for the failure.</p>
<p>&nbsp;</p></body>
</HTML>
