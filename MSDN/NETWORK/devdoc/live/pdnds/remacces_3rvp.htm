<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RasSecurityDialogReceive</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_rassecuritydialogreceive"></a>RasSecurityDialogReceive</h1>
<p>
The <b>RasSecurityDialogReceive</b> function starts an asynchronous operation that receives a remote user's response to a security challenge. The response is the input that the user typed in a terminal window on the remote computer. A third-party RAS security DLL calls this function as part of its authentication of the remote user.</p>
<p>
To call this function, you must first call the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_loadlibrary">
</object><a href=JavaScript:alink_1.Click()><b>LoadLibrary</b></a> function to load RASMAN.DLL. Then call the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getprocaddress">
</object><a href=JavaScript:alink_2.Click()><b>GetProcAddress</b></a> function to get the DLL's <b>RasSecurityDialogReceive</b> entry point. </p>
<pre><code><b>DWORD WINAPI RasSecurityDialogReceive(
  HPORT</b><i> hPort</i><b>,   </b>// RAS handle to the port
<b>  PBYTE</b><i> pBuffer</i><b>, </b>// pointer to buffer that receives the user's 
                 // response
<b>  PWORD</b><i> pBufferLength</i><b>,</b>
<b>                 </b>// returns size, in bytes, of the data received
<b>  DWORD</b><i> Timeout</i><b>, </b>// time-out period, in seconds
<b>  HANDLE</b><i> hEvent  </i>// event that is signaled when operation is finished
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hPort</i></dt>
<dd>
Specifies the port handle that the RAS server passed to the security DLL in the <a href="remacces_45da.htm"><b>RasSecurityDialogBegin</b></a> call for this authentication transaction. </dd>
<dt>
<i>pBuffer</i></dt>
<dd>
Pointer to the receive buffer that was passed to the security DLL in the <b>RasSecurityDialogBegin</b> call. When the asynchronous receive operation has been completed successfully, this buffer contains the response from the remote user.</dd>
<dt>
<i>pBufferLength</i></dt>
<dd>
Pointer to a <b>WORD</b> variable. On input, this variable must specify the size, in bytes, of the <i>pBuffer</i> buffer. When the receive operation has been completed, the variable indicates the number of bytes returned in the <i>pBuffer</i> buffer.</dd>
<dt>
<i>Timeout</i></dt>
<dd>
Specifies a time-out period, in seconds, after which the RAS server sets the <i>hEvent</i> event object to the signaled state. 
<p>
If this value is zero, there is no time-out period; that is, the RAS server does not signal the event object until the receive operation has been completed. 
</dd>
<dt>
<i>hEvent</i></dt>
<dd>
Specifies the handle of an event object created by the <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_createevent">
</object><a href=JavaScript:alink_3.Click()><b>CreateEvent</b></a> function. The RAS server sets the event object to the signaled state when the receive operation has been completed or when the time-out period has elapsed.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function is successful, the return value is PENDING (defined in RASERROR.H). This indicates that the receive operation is in progress.</p>
<p>
If an error occurs, the return value is one of the error codes defined in RASERROR.H or WINERROR.H. <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_4.Click()><b>GetLastError</b></a> does not provide extended error information.</p>
<h4>Remarks</h4>
<p>
After calling the <a href="remacces_38x0.htm"><b>RasSecurityDialogSend</b></a> function to send a security challenge to the remote user, the security DLL must call the <b>RasSecurityDialogReceive</b> function to get the user's response. </p>
<p>
The <b>RasSecurityDialogReceive</b> function is asynchronous. When the function returns, the security DLL must use one of the wait functions, such as <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_waitforsingleobject">
</object><a href=JavaScript:alink_5.Click()><b>WaitForSingleObject</b></a>, to wait for the <i>hEvent</i> event object to be signaled. The RAS server signals the event object when the receive operation has been completed or when the time-out interval has elapsed. If the receive operation is successful, the <i>pBuffer</i> buffer contains the response from the remote user, and the <i>pBufferLength</i> parameter indicates the number of bytes received. If the remote user sends more bytes than will fit in the buffer, the RAS server buffers the excess bytes and returns them in the next <b>RasSecurityDialogReceive</b> call.</p>
<p>
You can use the <i>Timeout</i> parameter to specify a time-out interval. If the time-out elapses, the RAS server signals the event object, and the <i>pBufferLength</i> parameter indicates that zero bytes were transferred. Alternatively, you can set <i>Timeout</i> to zero, and specify a time-out interval in the wait function that you use to wait for the event object to be signaled.</p>
<p>
When a security DLL is authenticating a remote user, the connection operation on the remote computer enters a RASCS_Interactive paused state. The message sent by <b>RasSecurityDialogSend</b> is displayed as output in a terminal window on the remote computer. The response received by <b>RasSecurityDialogReceive</b> is the input that the remote user types in the terminal window. The RASCS_Interactive value is defined in the <b>RASCONNSTATE</b> enumeration.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in rasshost.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Included as a resource in rasman.dll.</p>
<h4>See Also</h4>
<p>
<a href="remacces_5aqt.htm">Remote Access Service Overview</a>, <a href="remacces_7sab.htm">RAS Server Administration Functions</a>, <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_createevent">
</object><a href=JavaScript:alink_6.Click()><b>CreateEvent</b></a>, <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getprocaddress">
</object><a href=JavaScript:alink_7.Click()><b>GetProcAddress</b></a>, <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_loadlibrary">
</object><a href=JavaScript:alink_8.Click()><b>LoadLibrary</b></a>, <a href="remacces_9raq.htm"><b>RASCONNSTATE</b></a>,<b> </b> <a href="remacces_38x0.htm"><b>RasSecurityDialogSend</b></a>,<b> </b> <object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_waitforsingleobject">
</object><a href=JavaScript:alink_9.Click()><b>WaitForSingleObject</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
