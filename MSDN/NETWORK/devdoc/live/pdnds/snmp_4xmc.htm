<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SnmpExtensionInit</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_snmpextensioninit"></a>SnmpExtensionInit</h1>
<p>
The Microsoft SNMP service calls the <b>SnmpExtensionInit</b> function to initialize the SNMP extension agent DLL. This function is an element of the SNMP Extension Agent API. </p>
<pre><code><b>BOOL SnmpExtensionInit(
  DWORD</b><i> dwUptimeReference</i><b>,                    // </b>see NOTE below
<b>  HANDLE</b><i> *phSubagentTrapEvent</i><b>,                // </b>trap event handle
<b>  AsnObjectIdentifier</b><i> *pFirstSupportedRegion  </i>// first MIB subtree
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwUptimeReference </i></dt>
<dd>
[in] Specifies a time-zero reference for the extension agent. 

<p>
<b>Note</b>&nbsp;&nbsp;Extension agents should ignore this parameter. The SNMP extension agent DLL should use the <a href="snmp_72jp.htm"><b>SnmpSvcGetUptime</b></a> function to retrieve the number of centiseconds the SNMP service has been running. For more information, see the following Remarks section. 

</dd>
<dt>
<i>phSubagentTrapEvent </i></dt>
<dd>
[out] Pointer to an event handle the extension agent passes back to the SNMP service. This handle is used to notify the service that the extension agent has one or more traps to send. For additional information about allocating and deallocating the event handle, see the following Remarks section. </dd>
<dt>
<i>pFirstSupportedRegion</i> </dt>
<dd>
[out] Pointer to an <a href="snmp_8bqq.htm"><b>AsnObjectIdentifier</b></a> structure to receive the first MIB subtree that the extension agent supports. For additional information about allocating and deallocating resources for this structure, see the following Remarks section. 
<p>
The extension agent can register additional MIB subtrees by implementing the <a href="snmp_9e48.htm"><b>SnmpExtensionInitEx</b></a> entry point function. 

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is TRUE. </p>
<p>
If the function fails, the return value is FALSE.</p>
<h4>Remarks</h4>
<p>
Extension agents should ignore the <i>dwUptimeReference</i> parameter. Instead, they should call the <a href="snmp_72jp.htm"><b>SnmpSvcGetUptime</b></a> function to retrieve the number of centiseconds that the Microsoft SNMP service has been running. Because the <i>dwUptimeReference</i> parameter stores the elapsed time as a <b>DWORD</b> value in milliseconds, the time can wrap to zero and reflect an inaccurate time interval. </p>
<p>
The extension agent notifies the SNMP service that it needs to send one or more traps by setting the event handle passed back in the <i>phSubagentTrapEvent</i> parameter to the signaled state. After this event has been signaled, the SNMP service repeatedly calls the extension agent's <a href="snmp_72uo.htm"><b>SnmpExtensionTrap</b></a> entry point until the function returns a value of FALSE. This indicates that the extension agent has no more traps to send. If the extension agent does not generate traps, the <i>phSubagentTrapEvent </i>parameter should return a value of NULL. </p>
<p>
The SNMP extension agent must allocate and deallocate resources for the trap event handle. When the SNMP service calls the <b>SnmpExtensionInit</b> function, the extension agent must call the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_createevent">
</object><a href=JavaScript:alink_1.Click()><b>CreateEvent</b></a> function to allocate the event handle. The extension agent passes the handle to the SNMP service in the <i>phSubagentTrapEvent </i>parameter. When the SNMP service calls the <a href="snmp_7hut.htm"><b>SnmpExtensionClose</b></a> function, the extension agent must deallocate resources for the trap event handle. </p>
<p>
The SNMP service makes a copy of the <a href="snmp_8bqq.htm"><b>AsnObjectIdentifier</b></a> structure the extension agent returns in the <i>pFirstSupportedRegion</i> parameter. The extension agent must allocate and deallocate the resources associated with the original structure. It can do this when the SNMP service calls the <a href="snmp_7hut.htm"><b>SnmpExtensionClose</b></a> function. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in snmp.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>User-defined.</p>
<h4>See Also </h4>
<p>
<a href="snmp_7yov.htm">Simple Network Management Protocol (SNMP) Overview</a>, <a href="snmp_8w6r.htm">SNMP Functions</a>, <a href="snmp_8bqq.htm"><b>AsnObjectIdentifier</b></a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_createevent">
</object><a href=JavaScript:alink_2.Click()><b>CreateEvent</b></a>, <a href="snmp_72uo.htm"><b>SnmpExtensionTrap</b></a>, <a href="snmp_72jp.htm"><b>SnmpSvcGetUptime</b></a>, <a href="snmp_7hut.htm"><b>SnmpExtensionClose</b></a></p>
<p>&nbsp;</p></body>
</HTML>
