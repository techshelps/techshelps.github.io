<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Share Functions</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_share_functions"></a>Share Functions</h3>
<p>
The share functions control shared resources. A shared resource is a local resource on a server (for example, a disk directory, print device, or named pipe) that can be accessed by users and applications on the network. The share functions are:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=50%><a href="ntlmapi_0bxg.htm"><b>NetShareAdd</b></a></td>
<td width=50%>Shares a resource on a server.</td>
</tr>
<tr valign=top>
<td width=50%><a href="ntlmapi_957v.htm"><b>NetShareCheck</b></a></td>
<td width=50%>Queries whether a server is sharing a device.</td>
</tr>
<tr valign=top>
<td width=50%><a href="ntlmapi_0lgs.htm"><b>NetShareDel</b></a></td>
<td width=50%>Deletes a share name from a server's list of shared resources.</td>
</tr>
<tr valign=top>
<td width=50%><a href="ntlmapi_4l2l.htm"><b>NetShareEnum</b></a></td>
<td width=50%>Retrieves share information about each shared resource on a server.</td>
</tr>
<tr valign=top>
<td width=50%><a href="ntlmapi_18bz.htm"><b>NetShareGetInfo</b></a></td>
<td width=50%>Retrieves information about a specified shared resource on a server.</td>
</tr>
<tr valign=top>
<td width=50%><a href="ntlmapi_3rlb.htm"><b>NetShareSetInfo</b></a></td>
<td width=50%>Sets a shared resource's parameters.</td>
</tr>
</table><br>
<p>
The <a href="networks_03ad.htm"><b>WNetEnumResource</b></a> function should be used instead of the <b>NetShareEnum</b> function, which is obsolete. </p>
<p>
The <a href="ntlmapi_0bxg.htm"><b>NetShareAdd</b></a> function allows a user or application to share a resource of a specific type using the specified share name. The<b> NetShareAdd</b> function requires the share name and local device name to share the resource. A user or application must have an account on the server to access the resource.</p>
<p>
You may also specify a Security Descriptor to be associated with a share, which specifies which users will be allowed to access files through this share, and with what type of access.</p>
<p>
Net functions  define three types of special share names for interprocess communication (IPC) and remote administration of the server:
<ul>
<li>
IPC$, reserved for interprocess communication.</li>
<li>
ADMIN$, reserved for remote administration.</li>
<li>
A$, B$, C$ (and other local disk names followed by a dollar sign), assigned to local disk devices.</li>
</ul>
<p>
Share functions are available at four information levels:</p>
<p>
<a href="ntlmapi_3e5u.htm"><b>SHARE_INFO_0</b></a> <br>
<a href="ntlmapi_2zjm.htm"><b>SHARE_INFO_1</b></a> <br>
<a href="ntlmapi_2kxe.htm"><b>SHARE_INFO_2</b></a> <br>
<a href="ntlmapi_3pwy.htm"><b>SHARE_INFO_502</b></a> </p>
<p>
The following information levels are valid only for <a href="ntlmapi_3rlb.htm"><b>NetShareSetInfo</b></a>:</p>
<p>
<a href="ntlmapi_4auq.htm"><b>SHARE_INFO_1004</b></a> <b><br>
<a href="ntlmapi_3hma.htm">SHARE_INFO_1006</a></b> </p>
<p>
The following is supported only on Windows NT: </p>
<p>
<a href="ntlmapi_9wqa.htm"><b>SHARE_INFO_1501</b></a> </p>
<p>
For <a href="ntlmapi_3rlb.htm"><b>NetShareSetInfo</b></a><b>,</b> <i>parmnum</i> values refer to the members of the SHARE_INFO structure, as follows. These values are used when indicating an error in a specific parameter through <i>parm_err.</i></p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=52%><i>parmnum</i> value</th>
<th align=left width=48%>Member of SHARE_INFO structure</th>
</tr>
<tr valign=top>
<td width=52%>SHARE_NETNAME_PARMNUM</td>
<td width=48%>shi_netname</td>
</tr>
<tr valign=top>
<td width=52%>SHARE_TYPE_PARMNUM</td>
<td width=48%>shi_type</td>
</tr>
<tr valign=top>
<td width=52%>SHARE_REMARK_PARMNUM</td>
<td width=48%>shi_remark</td>
</tr>
<tr valign=top>
<td width=52%>SHARE_PERMISSIONS_PARMNUM</td>
<td width=48%>shi_permissions</td>
</tr>
<tr valign=top>
<td width=52%>SHARE_MAX_USES_PARMNUM</td>
<td width=48%>shi_max_uses</td>
</tr>
<tr valign=top>
<td width=52%>SHARE_CURRENT_USES_PARMNUM</td>
<td width=48%>shi_current_uses</td>
</tr>
<tr valign=top>
<td width=52%>SHARE_PATH_PARMNUM</td>
<td width=48%>shi_path</td>
</tr>
<tr valign=top>
<td width=52%>SHARE_PASSWD_PARMNUM</td>
<td width=48%>shi_passwd</td>
</tr>
<tr valign=top>
<td width=52%>SHARE_FILE_SD_PARMNUM</td>
<td width=48%>shi_security_descriptor</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
