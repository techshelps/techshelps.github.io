<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WNetGetResourceParent</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_wnetgetresourceparent"></a>WNetGetResourceParent</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>WNetGetResourceParent</b> function determines the parent of a network resource in the network browse hierarchy. Browsing begins at the location of the specified network resource. Use the <a href="networks_8wtp.htm"><b>WNetOpenEnum</b></a> function to move down the browse hierarchy. Conversely, use the <a href="networks_6l66.htm"><b>WNetGetResourceInformation</b></a> and <b>WNetGetResourceParent</b> functions to move up the tree.</p>
<pre><code><b>DWORD WNetGetResourceParent(
  LPNETRESOURCE </b><i>lpNetResource</i><b>,  </b>//<b> </b>Specifies a network resource 
                                // for the parent name
<b>  LPVOID </b><i>lpBuffer</i><b>,              </b>// Specifies a pointer containing 
                                // the parent source
<b>  LPDWORD </b><i>lpBufferSize</i><b>,         </b>// Specifies size of location 
                                // pointed to by lpbuffer
<b>  );</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpNetResource</i></dt>
<dd>
Specifies the network resource for which the parent name is required. Use the <a href="networks_03ad.htm"><b>WNetEnumResource</b></a>, <b>WNetGetResourceInformation</b> or <b>WNetGetResourceParent</b> functions to return information from the <b>NETRESOURCE</b> structure. You can also construct network resource information using the parameters in the <b>NETRESOURCE</b> structure.
<p>
The <i>lpRemoteName</i> parameter specifies the remote name of the network resource whose parent is required. The <i>lpProvider</i> parameter specifies the network provider that owns the resource. This must be supplied; otherwise, the function could produce incorrect results. The <i>dwType</i> field should be filled in if known; otherwise, it should be set to NULL.

<p>
Note that the caller typically knows the values for <i>lpProvider</i> and <i>dwType</i> after previous calls to <b>WNetGetResourceInformation</b> or <b>WNetGetResourceParent</b>. All other parameters in the <b>NETRESOURCE</b> structure are ignored.
</dd>
<dt>
<i>lpBuffer</i></dt>
<dd>
Pointer to a buffer to receive the result, which is a single <b>NETRESOURCE</b> structure representing the parent resource. 
<p>
The <i>lpRemoteName</i>, <i>lpProvider</i>, <i>dwType</i>, <i>dwDisplayType, </i>and <i>dwUsage</i> parameters of <b>NETRESOURCE</b> are returned; all other fields are set to NULL.

<p>
The <i>lpRemoteName</i> parameter points to the remote name for the parent resource. This name uses the same syntax as that returned from an enumeration by <b>WNetEnumResource</b>. The caller can perform a string comparison to determine whether the <b>WNetGetResourceParent</b> resource is the same as that returned by <b>WNetEnumResource</b>. If the input resource has no parent on any of the networks, the <i>lpRemoteName</i> parameter is returned as NULL. The <i>lpProvider</i> parameter is always returned when the function call is successful. In the <i>dwUsage</i> parameter, the presence of the RESOURCEUSAGE_CONNECTABLE bit means that the parent resource can be connected to, but only when it is available on the network.
</dd>
<dt>
<i>lpBufferSize</i></dt>
<dd>
Points to a location that specifies the size, in bytes, of the buffer pointed to by <i>lpBuffer</i>. If the buffer is too small for the result, the function places the required buffer size at this location and returns ERROR_MORE_DATA.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is NO_ERROR.</p>
<p>
If the function fails, the return value is one of the following error codes.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=47%>Value</th>
<th align=left width=53%>Meaning</th>
</tr>
<tr valign=top>
<td width=47%>ERROR_ACCESS_DENIED</td>
<td width=53%>The user is authenticated to the network, but does not have sufficient permissions (access rights).</td>
</tr>
<tr valign=top>
<td width=47%>ERROR_BAD_NET_NAME</td>
<td width=53%>The <i>lpRemoteName</i> parameter is not an existing network resource for any network.</td>
</tr>
<tr valign=top>
<td width=47%>ERROR_BAD_PROVIDER </td>
<td width=53%>The <i>lpProvider</i> parameter does not match any installed network provider.</td>
</tr>
<tr valign=top>
<td width=47%>ERROR_MORE_DATA</td>
<td width=53%>The buffer pointed to by <i>lpBuffer</i> is too small.</td>
</tr>
<tr valign=top>
<td width=47%>ERROR_NOT_AUTHENTICATED</td>
<td width=53%>The caller does not have the necessary permissions to obtain the name of the parent.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
Unlike<b> WNetGetResourceInformation</b>, if the resource includes a parent in its syntax, <b>WNetGetResourceParent</b> returns the parent, whether or not the resource actually exists. The <b>WNetGetResourceParent</b> function should typically be used only by applications that display network resources to the user in a hierarchical fashion. The Windows Explorer and the <b>File Open</b> dialog box are two well-known examples of such applications. No assumptions should be made about the type of resource that will be returned. An example of an inappropriate use of <b>WNetGetResourceParent</b> is to determine the name of the domain to which a specified server belongs. The function may happen to return the correct domain name for some networks in which domains appear directly above servers in the browse hierarchy, but it will give wrong results for other networks.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.5 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Use version 2.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winnetwk.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mpr.lib.</p>
<h4>See Also</h4>
<p>
<a href="networks_7t5r.htm">Windows Networking (WNet) Overview</a>, <a href="networks_0u43.htm">Windows Networking Functions</a>, <a href="networks_6l66.htm"><b>WNetGetResourceInformation</b></a></p>
<p>&nbsp;</p></body>
</HTML>
