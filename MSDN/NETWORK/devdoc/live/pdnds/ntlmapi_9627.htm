<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NetWkstaSetInfo</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_netwkstasetinfo"></a>NetWkstaSetInfo</h1>
<p>
The <b>NetWkstaSetInfo</b> function configures a workstation. This information remains in effect after the system has been reinitialized.</p>
<h4>Security Requirements</h4>
<p>
Only members of the Administrators local group can successfully execute <b>NetWkstaSetInfo</b> on a remote server.</p>
<pre><code><b>NET_API_STATUS NetWkstaSetInfo(
  LPWSTR</b><i> servername</i><b>, </b>
<b>  DWORD</b><i> level</i><b>,       </b>
<b>  LPBYTE</b><i> buffer</i><b>,     </b>
<b>  LPDWORD</b><i> parm_err</i>   
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>servername</i></dt>
<dd>
Pointer to a Unicode string containing the name of the remote server on which the function is to execute. A NULL pointer or string specifies the local computer.</dd>
<dt>
<i>level</i></dt>
<dd>
Specifies one of the following values to set the level of information provided.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=21%>Value</th>
<th align=left width=79%>Meaning</th>
</tr>
<tr valign=top>
<td width=21%>100</td>
<td width=79%>The <i>buffer</i> parameter points to a <a href="ntlmapi_1oj6.htm"><b>WKSTA_INFO_100</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>101</td>
<td width=79%>The <i>buffer</i> parameter points to a <a href="ntlmapi_19wy.htm"><b>WKSTA_INFO_101</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>102</td>
<td width=79%>The <i>buffer</i> parameter points to a <a href="ntlmapi_0vaq.htm"><b>WKSTA_INFO_102</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>302</td>
<td width=79%>The <i>buffer</i> parameter points to a <a href="ntlmapi_4mia.htm"><b>WKSTA_INFO_302</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>402</td>
<td width=79%>The <i>buffer</i> parameter points to a <a href="ntlmapi_1i42.htm"><b>WKSTA_INFO_402</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1101</td>
<td width=79%>The <i>buffer</i> parameter points to a <a href="ntlmapi_25bm.htm"><b>WKSTA_USER_INFO_1101</b></a> structure.</td>
</tr>
</table><br>


<p>
In addition, the structures <b>WKSTA_USER_INFO_502</b>, <b>WKSTA_USER_INFO_1010-1013</b>, <b>WKSTA_USER_INFO_1018</b>, <b>WKSTA_USER_INFO_1023</b>, <b>WKSTA_USER_INFO_1027</b>, <b>WKSTA_USER_INFO_1028</b>, <b>WKSTA_USER_INFO_1032</b>, <b>WKSTA_USER_INFO_1033</b>, <b>WKSTA_USER_INFO_1035</b>, and <b>WKSTA_USER_INFO_1041</b><i>-</i><b>1062 </b>should not be set by the user.
</dd>
<dt>
<i>buffer</i></dt>
<dd>
Pointer to the buffer in which the data set with the <i>level</i> parameter is stored. </dd>
<dt>
<i>parm_num</i></dt>
<dd>
Determines whether the <i>buffer</i> parameter contains a complete <b>WKSTA</b>_<b>INFO</b>_<b><i>X</i></b> (where <i>X</i>is the level) structure or a single structure component. If <i>parm_num</i> is set to PARMNUM_ALL, <i>buffer</i> must point to a <b>WKSTA</b>_<b>INFO_X</b> structure. Otherwise, only one element is changed, and <i>parm_num</i> must point to the single element to change.
<p>
Not all elements can be changed. Only those elements that have a specific PARMNUM constant value defined can be set. The following possible values are defined.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=60%>Value</th>
<th align=left width=40%>Component to Set</th>
</tr>
<tr valign=top>
<td width=60%>PARMNUM_ALL</td>
<td width=40%>All elements</td>
</tr>
<tr valign=top>
<td width=60%>WKSTA_CHARWAIT_PARMNUM</td>
<td width=40%><b>wki0_charwait</b></td>
</tr>
<tr valign=top>
<td width=60%>WKSTA_CHARTIME_PARMNUM</td>
<td width=40%><b>wki0_chartime</b></td>
</tr>
<tr valign=top>
<td width=60%>WKSTA_CHARCOUNT_PARMNUM</td>
<td width=40%><b>wki0_charcount</b></td>
</tr>
<tr valign=top>
<td width=60%>WKSTA_ERRLOGSZ_PARMNUM</td>
<td width=40%><b>wki0_errlogsz</b></td>
</tr>
<tr valign=top>
<td width=60%>WKSTA_PRINTBUFTIME_PARMNUM</td>
<td width=40%><b>wki0_printbuftime</b></td>
</tr>
<tr valign=top>
<td width=60%>WKSTA_WRKHEURISTICS_PARMNUM</td>
<td width=40%><b>wki0_wrkheuristics</b></td>
</tr>
<tr valign=top>
<td width=60%>WKSTA_OTHDOMAINS_PARMNUM</td>
<td width=40%><b>wki1_oth_domains</b></td>
</tr>
</table><br>

</dd>
<dt>
<i>parm_err</i></dt>
<dd>
Optional pointer to a <b>DWORD</b> that contains the index of the first parameter that causes ERROR_INVALID_PARAMETER. If NULL, the parameter is not returned on error.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function is successful, it returns NERR_SUCCESS.</p>
<p>
If the function fails, the return value is one of the following error codes.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=53%>Value</th>
<th align=left width=47%>Meaning</th>
</tr>
<tr valign=top>
<td width=53%>ERROR_ACCESS_DENIED</td>
<td width=47%>The user does not have access to the requested information.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_INVALID_PARAMETER</td>
<td width=47%>One of the function parameters is invalid.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
You must be a member of the Administrators local group to successfully execute <b>NetWkstaSetInfo</b> on a remote server or on a computer that has local security enabled. <b>NetWkstaSetInfo</b> does not change values in the LANMAN.INI file. Values set by previous calls to <b>NetWkstaSetInfo</b> can be overwritten when workstation parameters are reset. When the Workstation service is stopped and restarted, parameters are reset to the default values specified in the LANMAN.INI file unless overwritten by command-line parameters.</p>
<p>
Domain names in the <b>wki1_oth_domains</b> member of the <a href="ntlmapi_25bm.htm"><b>WKSTA_USER_INFO_1101</b></a> structure are separated by spaces. An empty list is valid. A null pointer means to leave the member unmodified. The <b>wki1_oth_domains</b> member cannot be set with MS-DOS. When setting this element, <b>NetWkstaSetInfo</b> rejects the request if the name list was invalid or if a name could not be added to one or more of the network adapters managed by Net.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in lmwksta.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use netapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="ntlmapi_7o4f.htm">Networking (Net) Overview</a>, <a href="ntlmapi_0bn7.htm">Net Functions</a>, <a href="ntlmapi_6msv.htm"><b>NetWkstaGetInfo</b></a></p>
<p>&nbsp;</p></body>
</HTML>
