<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RasSetSubEntryProperties</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_rassetsubentryproperties"></a>RasSetSubEntryProperties</h1>
<p>
The <b>RasSetSubEntryProperties</b> function creates a new subentry or modifies an existing subentry of a specified phone-book entry. </p>
<pre><code><b>DWORD RasSetSubEntryProperties(
  LPCTSTR</b><i> lpszPhonebook</i><b>,    </b>// pointer to full path and filename of 
                            // the phone-book file
<b>  LPCTSTR</b><i> lpszEntry</i><b>,        </b>// pointer to an entry name
<b>  DWORD</b><i> dwSubEntry</i><b>,         </b>// index of the subentry
<b>  LPRASSUBENTRY</b><i> lpRasSubEntry</i><b>,</b>
<b>                            </b>// pointer to structure containing 
                            // information about subentry
<b>  DWORD</b><i> dwcbRasSubEntry     </i>// size, in bytes, of the structure
  <b>LPBYTE</b> <i>lpbDeviceConfig</i>,   // pointer to TAPI device configuration 
  <b>DWORD</b> <i>dwcbDeviceConfig</i>    // size of TAPI device configuration 
<b>); </b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszPhonebook</i></dt>
<dd>
<b>Windows NT: </b>Pointer to a null-terminated string that specifies the full path and filename of a phone-book (.PBK) file. If this parameter is NULL, the function uses the current default phone-book file. The default phone-book file is the one selected by the user in the <b>User Preferences</b> property sheet of the <b>Dial-Up Networking</b> dialog box.</dd>
<dt>
<i>lpszEntry</i></dt>
<dd>
Pointer to a null-terminated string containing the name of an existing entry in the phone book.</dd>
<dt>
<i>dwSubEntry</i></dt>
<dd>
Specifies the one-based index of the subentry. If the index matches an existing subentry index, the function changes the properties of that subentry. If the index does not match an existing index, the function creates a new subentry.</dd>
<dt>
<i>lpRasSubEntry</i></dt>
<dd>
Pointer to a <a href="remacces_62r6.htm"><b>RASSUBENTRY</b></a> structure that contains the data for the subentry. 
<p>
The structure might be followed by an array of null-terminated alternate phone number strings. The last string is terminated by two consecutive null characters. The <b>dwAlternateOffset</b> member of the <b>RASSUBENTRY</b> structure contains the offset to the first string.
</dd>
<dt>
<i>dwcbRasSubEntry</i></dt>
<dd>
Specifies the size, in bytes, of the <i>lpRasSubEntry</i> buffer.</dd>
<dt>
<i>lpbDeviceConfig</i></dt>
<dd>
Pointer to a TAPI device configuration block. This parameter is currently unused. The caller should pass NULL for this parameter. For more information about TAPI device configuration blocks, see the function <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_linegetdevconfig">
</object><a href=JavaScript:alink_1.Click()><b>lineGetDevConfig</b></a>.</dd>
<dt>
<i>dwcbDeviceConfig</i></dt>
<dd>
Specifies the size of the TAPI device configuration block. This parameter is currently unused. The caller should pass zero for this parameter.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is zero.</p>
<p>
If the function fails, the return value can be one of the following error codes. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=64%>Value</th>
<th align=left width=36%>Meaning</th>
</tr>
<tr valign=top>
<td width=64%>ERROR_BUFFER_INVALID</td>
<td width=36%>The address or buffer specified by <i>lpRasEntry </i>is invalid.</td>
</tr>
<tr valign=top>
<td width=64%>ERROR_CANNOT_FIND_PHONEBOOK_ENTRY</td>
<td width=36%>The phone-book entry does not exist.</td>
</tr>
<tr valign=top>
<td width=64%>ERROR_CANNOT_OPEN_PHONEBOOK</td>
<td width=36%>The phone book is corrupted or missing components.</td>
</tr>
<tr valign=top>
<td width=64%>ERROR_INVALID_PARAMETER </td>
<td width=36%>The function was called with an invalid parameter.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
A RAS phone-book entry can have zero or more subentries, each minimally consisting of a device and a phone number. A phone-book entry with multiple subentries can be configured to dial either the first available subentry or all subentries when the entry is dialed.</p>
<p>
Use the <b>RasGetEntryProperties</b> function to retrieve a <b>RASENTRY</b> structure containing information about the subentries of a phone-book entry. The <b>dwSubEntries</b> member indicates the number of subentries and the <b>dwDialMode</b> member indicates the dialing configuration.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in ras.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use rasapi32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="remacces_5aqt.htm">Remote Access Service Overview</a>, <a href="remacces_7sab.htm">RAS Server Administration Functions</a>, <a href="remacces_9uer.htm"><b>RasGetEntryProperties</b></a>, <a href="remacces_81ki.htm"><b>RASENTRY</b></a>, <a href="remacces_62r6.htm"><b>RASSUBENTRY</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
