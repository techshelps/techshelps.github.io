<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NDdeShareAdd</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_nddeshareadd"></a>NDdeShareAdd</h1>
<p>
The <b>NDdeShareAdd</b> function is called to create and add a new DDE share to the DDE Share Database Manager (DSDM). </p>
<pre><code><b>UINT NDdeShareAdd(
  LPTSTR</b><i> lpszServer</i><b>,         </b>// server to execute on
<b>  UINT</b><i> nLevel</i><b>,               </b>// info level must be 2
<b>  PSECURITY_DESCRIPTOR</b><i> pSD</i><b>,  </b>// initial security descriptor
<b>  LPBYTE</b><i> lpBuffer</i><b>,           </b>// address of NDDESHAREINFO
<b>  DWORD</b><i> cBufSize</i>             // size of supplied buffer
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszServer</i></dt>
<dd>
Address of the server name on which the DSDM will be modified. </dd>
<dt>
<i>nLevel</i></dt>
<dd>
Must always be 2. </dd>
<dt>
<i>pSD</i></dt>
<dd>
Address of the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_security_descriptors">
</object><a href=JavaScript:alink_1.Click()><b>SECURITY_DESCRIPTOR</b></a> that will be associated with this share and against which access checks will be performed on subsequent initiates to this share. This parameter can optionally be NULL, in which case the DSDM creates a default <b>SECURITY_DESCRIPTOR</b> that grants "Full Control" to the CREATOR_OWNER and "Read and Link" to everyone. </dd>
<dt>
<i>lpBuffer</i></dt>
<dd>
Address of the <a href="netdde_2tte.htm"><b>NDDESHAREINFO</b></a> structure that defines the ApplicationTopic list associated with the DDE share being created as well as other parameters. This parameter must not be NULL. </dd>
<dt>
<i>cBufSize</i></dt>
<dd>
Size of the structure identified by lpBuffer. This parameter must not be 0. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is NDDE_NO_ERROR.</p>
<p>
If the function fails, the return value is an error code, which can be translated into a text error message by calling <a href="netdde_4kpz.htm"><b>NDdeGetErrorString</b></a>. </p>
<h4>Remarks</h4>
<p>
Before a client can connect to the DDE share, it must be trusted with <b>NDdeSetTrustedShare</b>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in nddeapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use nddeapi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="netdde_4fmt.htm">Network Dynamic Data Exchange Overview</a>, <a href="netdde_304z.htm">Network DDE Functions</a>, <a href="netdde_2tte.htm"><b>NDDESHAREINFO</b></a>, <a href="netdde_97c5.htm"><b>NDdeSetTrustedShare</b></a></p>
<p>&nbsp;</p></body>
</HTML>
