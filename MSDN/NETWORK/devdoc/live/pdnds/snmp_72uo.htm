<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SnmpExtensionTrap</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_snmpextensiontrap"></a>SnmpExtensionTrap</h1>
<p>
The Microsoft SNMP service calls the <b>SnmpExtensionTrap</b> function to retrieve information the service needs to generate traps for the SNMP extension agent. The service calls this function only after the extension agent sets the trap event handle to the signaled state during a call to the <a href="snmp_4xmc.htm"><b>SnmpExtensionInit</b></a> function. The <b>SnmpExtensionTrap</b> function is an element of the SNMP Extension Agent API. </p>
<pre><code><b>BOOL SnmpExtensionTrap(
  AsnObjectIdentifier</b><i> *pEnterpriseOid</i><b>,  </b>// generating enterprise
<b>  AsnInteger32</b><i> *pGenericTrapId</i><b>,         </b>// generating trap type
<b>  AsnInteger32</b><i> *pSpecificTrapId</i><b>,        </b>// enterprise-specific type
<b>  AsnTimeticks</b><i> *pTimeStamp</i><b>,             </b>// time stamp
<b>  SnmpVarBindList</b><i> *pVarBindList         </i>// variable bindings
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pEnterpriseOid</i></dt>
<dd>
[out] Pointer to an <a href="snmp_8bqq.htm"><b>AsnObjectIdentifier</b></a> structure to receive the object identifier of the enterprise that generated the trap. The SNMP service does not free the memory for this variable.</dd>
<dt>
<i>pGenericTrapId</i></dt>
<dd>
[out] Pointer to a variable to receive an indication of the generic trap. This parameter can be one of the following values. 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=61%>Value</th>
<th align=left width=39%>Meaning</th>
</tr>
<tr valign=top>
<td width=61%>SNMP_GENERICTRAP_COLDSTART</td>
<td width=39%>The agent is initializing protocol entities on the managed mode. It may alter objects in its view.</td>
</tr>
<tr valign=top>
<td width=61%>SNMP_GENERICTRAP_WARMSTART</td>
<td width=39%>The agent is re-initializing itself but will not alter objects within its view.</td>
</tr>
<tr valign=top>
<td width=61%>SNMP_GENERICTRAP_LINKDOWN</td>
<td width=39%>An attached interface has changed from the <b>up</b> state to the <b>down</b> state. The first variable identifies the interface.</td>
</tr>
<tr valign=top>
<td width=61%>SNMP_GENERICTRAP_LINKUP</td>
<td width=39%>An attached interface has changed from the <b>down</b> state to the <b>up</b> state. The first variable identifies the interface.</td>
</tr>
<tr valign=top>
<td width=61%>SNMP_GENERICTRAP_AUTHFAILURE</td>
<td width=39%>An SNMP entity has sent an SNMP message, but has falsely claimed to belong to a known community.</td>
</tr>
<tr valign=top>
<td width=61%>SNMP_GENERICTRAP_EGPNEIGHLOSS</td>
<td width=39%>An EGP peer has changed to the <b>down</b> state. The first variable identifies the IP address of the EGP peer.</td>
</tr>
<tr valign=top>
<td width=61%>SNMP_GENERICTRAP_ENTERSPECIFIC</td>
<td width=39%>Signals an extraordinary event that is identified in the <i>pSpecificTrapId </i>parameter. </td>
</tr>
</table><br>

</dd>
<dt>
<i>pSpecificTrapId</i></dt>
<dd>
[out] Pointer to a variable to receive an indication of the specific trap generated.</dd>
<dt>
<i>pTimeStamp</i></dt>
<dd>
[out] Pointer to a variable to receive the time stamp. It is recommended that you initialize this parameter with the value returned by a call to the <a href="snmp_72jp.htm"><b>SnmpSvcGetUptime</b></a> function. </dd>
<dt>
<i>pVarBindList</i></dt>
<dd>
[out] Pointer to the variable bindings list. The extension agent must allocate the memory for this parameter. The SNMP service frees the memory with a call to the <a href="snmp_58rp.htm"><b>SnmpUtilVarBindListFree</b></a> function.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the <b>SnmpExtensionTrap</b> function returns a trap, the return value is TRUE. The SNMP service repeatedly calls the function until it returns a value of FALSE. For additional information, see the following Remarks section. </p>
<h4>Remarks</h4>
<p>
The SNMP service repeatedly calls the <b>SnmpExtensionTrap</b> function when the <i>phSubagentTrapEvent </i>event handle is set to the signaled state. This handle is passed back during the call to the <a href="snmp_4xmc.htm"><b>SnmpExtensionInit</b></a> entry point function. The <b>SnmpExtensionTrap</b> function must return TRUE to indicate that the parameters contain valid data for a single trap. The function must return FALSE to indicate that the parameters do not represent valid trap data, and to stop the service's repeated calls.</p>
<p>
Note that after the SNMP service sends a trap, it frees the memory associated with the variable binding list. </p>
<p>
It is important to note that earlier documentation stated that the extension agent should dynamically allocate memory for the enterprise object identifier because the SNMP service would attempt to release the memory after sending a trap. The service will not release the memory associated with the enterprise object identifier. It is recommended that you return a pointer to a static <a href="snmp_8bqq.htm"><b>AsnObjectIdentifier</b></a> structure instead.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in snmp.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>User-defined.</p>
<h4>See Also </h4>
<p>
<a href="snmp_7yov.htm">Simple Network Management Protocol (SNMP) Overview</a>, <a href="snmp_8w6r.htm">SNMP Functions</a>, <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_setevent">
</object><a href=JavaScript:alink_1.Click()><b>SetEvent</b></a>, <a href="snmp_1dwj.htm"><b>SnmpUtilMemAlloc</b></a>, <a href="snmp_58rp.htm"><b>SnmpUtilVarBindListFree</b></a>, <a href="snmp_44j6.htm"><b>SnmpVarBindList</b></a>, <a href="snmp_72jp.htm"><b>SnmpSvcGetUptime</b></a>, <a href="snmp_4xmc.htm"><b>SnmpExtensionInit</b></a></p>
<p>&nbsp;</p></body>
</HTML>
