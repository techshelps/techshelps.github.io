<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WNetAddConnection3</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_wnetaddconnection3"></a>WNetAddConnection3</h1>
<p>
The <b>WNetAddConnection3</b> function makes a connection to a network resource. The function can redirect a local device to the network resource.</p>
<p>
The <b>WNetAddConnection3</b> function is similar to the <a href="networks_84z6.htm"><b>WNetAddConnection2</b></a> function. The main difference is that <b>WNetAddConnection3</b> has an additional parameter, a handle to a window that the provider of network resources can use as an owner window for dialog boxes.</p>
<pre><code><b>DWORD WNetAddConnection3(
  HWND</b><i> hwndOwner</i><b>,               </b>// handle to an owner window for 
                                // network provider dialog boxes
<b>  LPNETRESOURCE</b><i> lpNetResource</i><b>,  </b>// pointer to structure that 
                                // specifies connection details
<b>  LPTSTR</b><i> lpPassword</i><b>,            </b>// pointer to password string
<b>  LPTSTR</b><i> lpUserName</i><b>,            </b>// pointer to user name string
<b>  DWORD</b><i> dwFlags</i>                 // set of bit flags that specify 
                                // connection options
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hwndOwner</i></dt>
<dd>
Specifies a window that the provider of network resources can use as an owner window for dialog boxes. 
<p>
The <i>hwndOwner</i> parameter may be NULL. If it is, a call to <b>WNetAddConnection3</b> is equivalent to calling the <b>WNetAddConnection2</b> function.
</dd>
<dt>
<i>lpNetResource</i></dt>
<dd>
Points to a <a href="networks_0nle.htm"><b>NETRESOURCE</b></a> data structure that specifies details of the proposed connection: information about the network resource, the local device, and the network resource provider. 
<p>
You must specify the following members of the <b>NETRESOURCE</b> structure: 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=25%>Member</th>
<th align=left width=75%>Description</th>
</tr>
<tr valign=top>
<td width=25%><b>dwType</b></td>
<td width=75%>Specifies the type of network resource to connect to. If <b>lpLocalName</b> points to a non-empty string, this member can be RESOURCETYPE_DISK or RESOURCETYPE_PRINT. If <b>lpLocalName</b> is NULL or points to an empty string, <b>dwType</b> can be RESOURCETYPE_DISK, RESOURCETYPE_PRINT, or RESOURCETYPE_ANY.</td>
</tr>
<tr valign=top>
<td width=25%><b>lpLocalName</b></td>
<td width=75%>Points to a null-terminated string that specifies the name of a local device to be redirected, such as "F:" or "LPT1". The string is treated in a case-insensitive manner. If the string is empty or <b>lpLocalName</b> is NULL, the function makes a connection to the network resource without redirecting a local device.</td>
</tr>
<tr valign=top>
<td width=25%><b>lpRemoteName</b></td>
<td width=75%>Points to a null-terminated string that specifies the network resource to connect to. The string can be up to MAX_PATH characters in length . The string must follow the network provider's naming conventions.  </td>
</tr>
<tr valign=top>
<td width=25%><b>lpProvider</b></td>
<td width=75%>Points to a null-terminated string that specifies the network provider to connect to. If <b>lpProvider</b> is NULL or points to an empty string, the operating system attempts to determine the correct provider by parsing the string pointed to by <b>lpRemoteName</b>.</td>
</tr>
<tr valign=top>
<td width=25%></td>
<td width=75%>You should set this member only if you know for sure which network provider you want to use. Otherwise, let the operating system determine which network provider the network name maps to.</td>
</tr>
<tr valign=top>
<td width=25%></td>
<td width=75%>If this member is not NULL, the operating system attempts to make a connection only to the named network provider.</td>
</tr>
</table><br>


<p>
The <b>WNetAddConnection3 </b>function ignores the other members of the <b>NETRESOURCE</b> structure.
</dd>
<dt>
<i>lpPassword</i></dt>
<dd>
Points to a null-terminated string that specifies a password to be used in making the network connection.
<p>
If <i>lpPassword</i> is NULL, the function uses the current default password associated with the user specified by <i>lpUserName.</i>

<p>
If <i>lpPassword</i> points to an empty string, the function does not use a password.
</dd>
<dt>
<i>lpUserName</i></dt>
<dd>
Points to a null-terminated string that specifies a user name to be used in making the connection. 
<p>
If <i>lpUserName</i> is NULL, the function uses the default user name. The user context for the process provides the default user name. 

<p>
The <i>lpUserName</i> parameter is specified when users want to connect to a network resource for which they have been assigned a user name or account other than the default user name or account. 

<p>
The user-name string represents a security context. It may be specific to a network provider.
</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
A set of bit flags that specify connection options. The following bit flag constants are currently defined:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=43%>Value</th>
<th align=left width=57%>Meaning</th>
</tr>
<tr valign=top>
<td width=43%>CONNECT_UPDATE_PROFILE</td>
<td width=57%>The network resource connection should be remembered. <p>
If this bit flag is set, the operating system automatically attempts to restore the connection when the user logs on.</p>
<p>
The operating system remembers only successful connections that redirect local devices. It does not remember unsuccessful connections and deviceless connections. A deviceless connection occurs when <b>lpLocalName </b>is NULL or points to an empty string.</p>
<p>
If this bit flag is clear, the operating system will not automatically restore the connection at logon.</p>
</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is NO_ERROR.</p>
<p>
If the function fails, the return value is an error code. Returning an error code provides compatibility with the behavior of the Windows 3.1 function <b>WNetAddConnection</b>. You can also call the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a><b> </b>function to obtain the (same) error code. One of the following error codes may be returned when <b>WNetAddConnection3</b> fails:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=53%>Value</th>
<th align=left width=47%>Meaning</th>
</tr>
<tr valign=top>
<td width=53%>ERROR_ACCESS_DENIED</td>
<td width=47%>Access to the network resource was denied.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_ALREADY_ASSIGNED</td>
<td width=47%>The local device specified by<b> lpLocalName</b> is already connected to a network resource.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_BAD_DEV_TYPE</td>
<td width=47%>The type of local device and the type of network resource do not match.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_BAD_DEVICE</td>
<td width=47%>The value specified by <b>lpLocalName</b> is invalid.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_BAD_NET_NAME</td>
<td width=47%>The value specified by<b> lpRemoteName</b> is not acceptable to any network resource provider. The resource name is invalid, or the named resource cannot be located.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_BAD_PROFILE</td>
<td width=47%>The user profile is in an incorrect format.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_BAD_PROVIDER</td>
<td width=47%>The value specified by <b>lpProvider</b> does not match any provider.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_BUSY</td>
<td width=47%>The router or provider is busy, possibly initializing. The caller should retry.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_CANCELLED</td>
<td width=47%>The attempt to make the connection was cancelled by the user through a dialog box from one of the network resource providers or by a called resource.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_CANNOT_OPEN_PROFILE</td>
<td width=47%>The system is unable to open the user profile to process persistent connections.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_DEVICE_ALREADY_REMEMBERED</td>
<td width=47%>An entry for the device specified in <b>lpLocalName</b> is already in the user profile.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_EXTENDED_ERROR</td>
<td width=47%>A network-specific error occured. Call the <a href="networks_735e.htm"><b>WNetGetLastError</b></a> function to get a description of the error.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_INVALID_PASSWORD</td>
<td width=47%>The specified password is invalid.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_NO_NET_OR_BAD_PATH</td>
<td width=47%>A network component has not started, or the specified name could not be handled.</td>
</tr>
<tr valign=top>
<td width=53%>ERROR_NO_NETWORK</td>
<td width=47%>There is no network present.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
<b>Windows CE:</b> Windows CE does not support "drive-letters" (for example, "F:") as local names of redirected resources. The <i>lpLocalName</i> field of the <b>NETRESOURCE</b> structure can contain any string of up to 64 characters long. If the local name is NULL or empty, the resource is connected without a local name. If it is "*", the default name will be constructed as "&lt;share&gt; on &lt;server&gt;" extracted from the remote name of "\\server\share". </p>
<p>
Except for nameless connections, the connected resource will appear as a subfolder under the \NETWORK directory. The subfolder is named after the <i>lpLocalName </i>string.</p>
<p>
Windows CE supports only the "Microsoft Windows Network" provider. Persistent connections are stored in the registry and not automatically restored when the user logs in.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.5 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Use version 2.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winnetwk.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mpr.lib.</p>
<h4>See Also</h4>
<p>
<a href="networks_7t5r.htm">Windows Networking (WNet) Overview</a>, <a href="networks_0u43.htm">Windows Networking Functions</a>, <a href="networks_0nle.htm"><b>NETRESOURCE</b></a>, <a href="networks_84z6.htm"><b>WNetAddConnection2</b></a>,<b> <a href="networks_6c6q.htm">WNetCancelConnection2</a></b>,<b> <a href="networks_84a6.htm">WNetGetConnection</a></b>, <a href="networks_735e.htm"><b>WNetGetLastError</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
