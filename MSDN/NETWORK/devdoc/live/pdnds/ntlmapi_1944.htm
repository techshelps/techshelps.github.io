<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NetUserAdd</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_netuseradd"></a>NetUserAdd</h1>
<p>
The <b>NetUserAdd</b> function adds a user account and assigns a password and privilege level.</p>
<h4>Security Requirements</h4>
<p>
Only members of the Administrators or Account Operators local group can successfully execute <b>NetUserAdd</b>. Only members of the Administrators local group can add an Administrators privilege account.</p>
<pre><code><b>NET_API_STATUS NetUserAdd(
  LPWSTR</b><i> servername</i><b>, </b>
<b>  DWORD</b><i> level</i><b>,       </b>
<b>  LPBYTE</b><i> buf</i><b>,        </b>
<b>  LPDWORD</b><i> parm_err</i>   
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>servername</i></dt>
<dd>
Pointer to a Unicode string containing the name of the remote server on which the function is to execute. A NULL pointer or string specifies the local computer.</dd>
<dt>
<i>level</i></dt>
<dd>
Specifies one of the following values to set the level of information provided.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=21%>Value</th>
<th align=left width=79%>Meaning</th>
</tr>
<tr valign=top>
<td width=21%>1</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_13ea.htm"><b>USER_INFO_1</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>2</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_0os2.htm"><b>USER_INFO_2</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>3</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_0a5u.htm"><b>USER_INFO_3</b></a> structure.</td>
</tr>
</table><br>

</dd>
<dt>
<i>buf</i></dt>
<dd>
Pointer to the buffer in which the data set with the <i>level</i> parameter is stored. </dd>
<dt>
<i>parm_err</i></dt>
<dd>
Optional pointer to a <b>DWORD</b> that contains the index of the first parameter that causes ERROR_INVALID_PARAMETER. If NULL, the parameter is not returned on error.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function returns account information, the return value is NERR_Success.</p>
<p>
If the function fails, the return value is one of the following error codes.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=40%>Value</th>
<th align=left width=60%>Meaning</th>
</tr>
<tr valign=top>
<td width=40%>ERROR_ACCESS_DENIED</td>
<td width=60%>The user does not have access to the requested information.</td>
</tr>
<tr valign=top>
<td width=40%>NERR_InvalidComputer</td>
<td width=60%>Thiecomputer name is invalid.</td>
</tr>
<tr valign=top>
<td width=40%>NERR_NotPrimary</td>
<td width=60%>The operation is allowed only on the primary domain controller of the domain.</td>
</tr>
<tr valign=top>
<td width=40%>NERR_GroupExists</td>
<td width=60%>The group already exists.</td>
</tr>
<tr valign=top>
<td width=40%>NERR_UserExists</td>
<td width=60%>The user account already exists.</td>
</tr>
<tr valign=top>
<td width=40%>NERR_PasswordTooShort </td>
<td width=60%>The password is shorter than required. The password could also have been too long, too recent in its change history, not enough unique characters, or some other faulty indication of password restrictions.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
Server users must use a system in which the server creates a WINDOWS NT system account for the new user. The creation of this account is controlled by several parameters in the server's LANMAN.INI file.</p>
<p>
If the newly added server user name already exists as a Windows NT system user, the <b>useril_home_dir</b> member of the <b>USER_INFO_1</b> structure is ignored. The <b>NetUserAdd</b> function supports <b>USER_INFO_1</b> and <b>USER_INFO_2</b> structures. Using members of <b>USER_INFO_1</b> initializes default values in <b>USER_INFO_2</b> and <b>USER_INFO_3</b> structures.</p>
<p>
Subsequent <a href="ntlmapi_0zfz.htm"><b>NetUserSetInfo</b></a> calls can change the default values. The following are possible default values.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%>Member</th>
<td width=64%><b>Default Value</b></td>
</tr>
<tr valign=top>
<td width=36%><b>usriX_auth_flags</b></td>
<td width=64%>None (0)</td>
</tr>
<tr valign=top>
<td width=36%><b>usriX_full_name</b></td>
<td width=64%><b>usri1_name</b></td>
</tr>
<tr valign=top>
<td width=36%><b>usriX_usr_comment</b></td>
<td width=64%>None (null string)</td>
</tr>
<tr valign=top>
<td width=36%><b>usriX_parms</b></td>
<td width=64%>None (null string)</td>
</tr>
<tr valign=top>
<td width=36%><b>usriX_workstations</b></td>
<td width=64%>All (null string)</td>
</tr>
<tr valign=top>
<td width=36%><b>usriX_acct_expires</b></td>
<td width=64%>Never (TIMEQ_FOREVER)</td>
</tr>
<tr valign=top>
<td width=36%><b>usriX_max_storage</b></td>
<td width=64%>Unlimited (USER_MAXSTORAGE_UNLIMITED)</td>
</tr>
<tr valign=top>
<td width=36%><b>usriX_logon_hours</b></td>
<td width=64%>Logon allowed at any time (each element 0xFF; all bits set to 1)</td>
</tr>
<tr valign=top>
<td width=36%><b>usriX_logon_server</b></td>
<td width=64%>Any domain controller (\\*)</td>
</tr>
<tr valign=top>
<td width=36%><b>usriX_country_code</b></td>
<td width=64%>Current (country_code on the server</td>
</tr>
<tr valign=top>
<td width=36%><b>usriX_code_page</b></td>
<td width=64%>0</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in lmaccess.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use netapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="ntlmapi_7o4f.htm">Networking (Net) Overview</a>, <a href="ntlmapi_0bn7.htm">Net Functions</a>, <a href="ntlmapi_3kx9.htm"><b>NetUserEnum</b></a>, <a href="ntlmapi_0zfz.htm"><b>NetUserSetInfo</b></a>, <a href="ntlmapi_1ing.htm"><b>NetUserDel</b></a></p>
<p>&nbsp;</p></body>
</HTML>
