<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SnmpMgrGetTrap</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_snmpmgrgettrap"></a>SnmpMgrGetTrap</h1>
<p>
The <b>SnmpMgrGetTrap</b> function returns outstanding trap data that the caller has not received if trap reception is enabled. This function is an element of the SNMP Management API. </p>
<pre><code><b>BOOL SnmpMgrGetTrap(
  AsnObjectIdentifier</b><i> *enterprise</i><b>,</b>   // generating enterprise
  <b>AsnNetworkAddress</b> <i>*IPAddress</i><b>,</b>      // generating IP address
<b>  AsnInteger</b><i> *genericTrap</i><b>,</b>           // generic trap type
<b>  AsnInteger</b><i> *specificTrap</i><b>,</b>          // enterprise-specific type
<b>  AsnTimeticks</b><i> *timeStamp</i><b>,</b>           // time stamp
<b>  SnmpVarBindList</b><i> *variableBindings  </i>// variable bindings
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>enterprise</i></dt>
<dd>
[out] Pointer to an object identifier to receive the enterprise that generated the SNMP trap.</dd>
<dt>
<i>IPAddress</i></dt>
<dd>
[out] Pointer to a variable to receive the IP address of the enterprise that generated the SNMP trap. </dd>
<dt>
<i>genericTrap</i></dt>
<dd>
[out] Pointer to a variable to receive an indicator of the generic trap. This parameter can be one of the following values. 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=59%>Value</th>
<th align=left width=41%>Meaning</th>
</tr>
<tr valign=top>
<td width=59%>SNMP_GENERICTRAP_COLDSTART</td>
<td width=41%>The agent is initializing protocol entities on the managed mode. It may alter objects in its view.</td>
</tr>
<tr valign=top>
<td width=59%>SNMP_GENERICTRAP_WARMSTART</td>
<td width=41%>The agent is re-initializing itself but it will not alter objects in its view.</td>
</tr>
<tr valign=top>
<td width=59%>SNMP_GENERICTRAP_LINKDOWN</td>
<td width=41%>An attached interface has changed from the <b>up</b> state to the <b>down</b> state. The first variable in the variable bindings list identifies the interface.</td>
</tr>
<tr valign=top>
<td width=59%>SNMP_GENERICTRAP_LINKUP</td>
<td width=41%>An attached interface has changed from the <b>down</b> state to the <b>up</b> state. The first variable in the variable bindings list identifies the interface.</td>
</tr>
<tr valign=top>
<td width=59%>SNMP_GENERICTRAP_AUTHFAILURE</td>
<td width=41%>An SNMP entity has sent an SNMP message, but it has falsely claimed to belong to a known community.</td>
</tr>
<tr valign=top>
<td width=59%>SNMP_GENERICTRAP_EGPNEIGHLOSS</td>
<td width=41%>An EGP peer has changed to the <b>down</b> state. The first variable in the variable bindings list identifies the IP address of the EGP peer.</td>
</tr>
<tr valign=top>
<td width=59%>SNMP_GENERICTRAP_ENTERSPECIFIC</td>
<td width=41%>An extraordinary event has occurred and it is identified in the <i>specificTrap</i> parameter with an enterprise-specific value.</td>
</tr>
</table><br>

</dd>
<dt>
<i>specificTrap</i></dt>
<dd>
[out] Pointer to a variable to receive an indication of the specific trap generated.</dd>
<dt>
<i>timeStamp</i></dt>
<dd>
[out] Pointer to a variable to receive the time stamp.</dd>
<dt>
<i>variableBindings</i></dt>
<dd>
[out] Pointer to an <a href="snmp_44j6.htm"><b>SnmpVarBindList</b></a><i> </i>structure to receive the variable bindings list. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function returns a trap, the return value is nonzero.</p>
<p>
You should call the <b>SnmpMgrGetTrap</b> function repeatedly until <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a><b> </b>returns zero. <b>GetLastError</b> may also return the following error codes. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=57%>Error Code</th>
<th align=left width=43%>Meaning</th>
</tr>
<tr valign=top>
<td width=57%>SNMP_MGMTAPI_TRAP_ERRORS</td>
<td width=43%>Indicates errors were encountered; traps are not accessible.</td>
</tr>
<tr valign=top>
<td width=57%>SNMP_MGMTAPI_NOTRAPS</td>
<td width=43%>Indicates no traps are available.</td>
</tr>
<tr valign=top>
<td width=57%>SNMP_MEM_ALLOC_ERROR</td>
<td width=43%>Indicates a memory allocation error.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The application must always call the <a href="snmp_04ry.htm"><b>SnmpMgrTrapListen</b></a> function before calling the <b>SnmpMgrGetTrap</b> function. This is because the event handle pointed to by the <i>phTrapAvailable</i> parameter of the <a href="snmp_04ry.htm"><b>SnmpMgrTrapListen</b></a> function enables the event-driven acquisition of SNMP traps. The SNMP Management API signals an application's event when the SNMP Trap Service delivers a trap. </p>
<p>
The application can also poll the <b>SnmpMgrGetTrap</b> function for traps at regular intervals. In this case, the application should repeatedly call <b>SnmpMgrGetTrap</b> until the function returns zero.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in mgmtapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mgmtapi.lib.</p>
<h4>See Also </h4>
<p>
<a href="snmp_7yov.htm">Simple Network Management Protocol (SNMP) Overview</a>, <a href="snmp_8w6r.htm">SNMP Functions</a>, <a href="snmp_04ry.htm"><b>SnmpMgrTrapListen</b></a>, <a href="snmp_44j6.htm"><b>SnmpVarBindList</b></a></p>
<p>&nbsp;</p></body>
</HTML>
