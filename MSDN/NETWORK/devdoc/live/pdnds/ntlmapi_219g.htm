<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NetUserChangePassword</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_netuserchangepassword"></a>NetUserChangePassword</h1>
<p>
The <b>NetUserChangePassword</b> function changes a user's password for a specified network server or domain.</p>
<h4>Security Requirements</h4>
<p>
A server or domain can be configured to require a user to log on before changing the password on a user account. In that case, only members of the Administrators or Account Operators local group or the user himself can change the password for a user account. If logging on is not required, the user can change the password for any user account, as long as the user knows the current password.</p>
<pre><code><b>NET_API_STATUS NetUserChangePassword(
  LPWSTR</b><i> domainname</i><b>,  </b>
<b>  LPWSTR</b><i> username</i><b>,    </b>
<b>  LPWSTR</b><i> oldpassword</i><b>, </b>
<b>  LPWSTR</b><i> newpassword  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>domainname</i></dt>
<dd>
Pointer to a null-terminated Unicode string that specifies the name of a remote server or domain. The <b>NetUserChangePassword</b> function changes the user's password on that remote server or domain. 
<p>
A value of NULL in the <i>domainname </i>parameter specifies the logon domain of the caller.
</dd>
<dt>
<i>username</i></dt>
<dd>
Pointer to a null-terminated Unicode string that specifies a user name. The <b>NetUserChangePassword</b> function changes the password for that user.
<p>
A value of NULL in the <i>username</i> parameter specifies the logon user name of the caller.
</dd>
<dt>
<i>oldpassword</i></dt>
<dd>
Pointer to a null-terminated Unicode string that specifies the user's old password on the server or domain. </dd>
<dt>
<i>newpassword</i></dt>
<dd>
Pointer to a null-terminated Unicode string that specifies the user's new password on the server or domain.  
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function is successful, it returns account information and the return value is NERR_Success.</p>
<p>
If the function fails, the return value is one of the following error codes.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=46%>Value</th>
<th align=left width=54%>Meaning</th>
</tr>
<tr valign=top>
<td width=46%>ERROR_ACCESS_DENIED</td>
<td width=54%>The user does not have access to the requested information.</td>
</tr>
<tr valign=top>
<td width=46%>ERROR_INVALID_PASSWORD </td>
<td width=54%>The user has entered an invalid password.</td>
</tr>
<tr valign=top>
<td width=46%>NERR_InvalidComputer</td>
<td width=54%>The computer name is invalid.</td>
</tr>
<tr valign=top>
<td width=46%>NERR_NotPrimary</td>
<td width=54%>The operation is allowed only on the primary domain controller of the domain.</td>
</tr>
<tr valign=top>
<td width=46%>NERR_UserNotFound</td>
<td width=54%>The user name could not be found.</td>
</tr>
<tr valign=top>
<td width=46%>NERR_PasswordTooShort </td>
<td width=54%>The password is shorter than required. The password could also have been too long, too recent in its change history, not enough unique characters, or some other faulty indication of password restrictions.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in lmaccess.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use netapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="ntlmapi_7o4f.htm">Networking (Net) Overview</a>, <a href="ntlmapi_0bn7.htm">Net Functions</a>, <a href="ntlmapi_0zfz.htm"><b>NetUserSetInfo</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
