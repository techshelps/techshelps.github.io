<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WNetGetResourceInformation</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_wnetgetresourceinformation"></a>WNetGetResourceInformation</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
When provided with a remote path to a network resource, the <b>WNetGetResourceInformation</b> function identifies the network provider that owns the resource and obtains information about the type of the resource. The function is typically used in conjunction with <a href="networks_8nzo.htm"><b>WNetGetResourceParent</b></a> to parse and interpret a network path typed in by a user.</p>
<pre><code><b>DWORD WNetGetResourceInformation (
  LPNETRESOURCE </b><i>lpNetResource</i><b>,  </b>//<b> </b>Specifies the network resource 
                                // for which information is required
<b>  LPVOID </b><i>lpBuffer</i><b>,              </b>// Species a buffer to contain 
                                // the information
<b>  LPDWORD </b><i>lpcbBuffer</i><b>,           </b>// Specifies the size of the buffer
                                // pointed to by lpBuffer
<b>  LPTSTR *</b><i>lplpSystem            </i>// Pointer to a string in the 
                                // output buffer
<b>  );</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpNetResource</i></dt>
<dd>
Specifies the network resource for which information is required. The <i>lpRemoteName</i> parameter specifies the remote path name of the resource, typically typed in by a user. The <i>lpProvider</i> and <i>dwType</i> fields should be filled in if known, because this operation can be expensive, especially without <i>dwType</i>. Otherwise, they should be set to NULL. All other fields of <i>lpNetResource</i> are ignored.</dd>
<dt>
<i>lpBuffer</i></dt>
<dd>
Pointer to the buffer to receive the result. On a successful return, the first field in the buffer is a <b>NETRESOURCE</b> structure representing that portion of the input resource path that is accessed through Windows networking functions, rather than system functions specific to the input resource type. For example, if the input remote resource path was \\server\share\dir1\dir2, then the output <b>NETRESOURCE</b> contains information about the resource \\server\share. The \dir1\dir2 portion of the path is accessed through file functions. The <i>lpRemoteName</i>, <i>lpProvider</i>, <i>dwType</i>, <i>dwDisplayType</i>, and <i>dwUsage</i> fields of <b>NETRESOURCE</b> are returned, with all other fields being set to NULL.
<p>
The <i>lpRemoteName</i> parameter is returned in the same syntax as that returned from an enumeration by the <a href="networks_03ad.htm"><b>WNetEnumResource</b></a> function. This allows the caller to perform a string comparison to determine whether the resource passed to <b>WNetGetResourceInformation</b> is the same as the resource returned by a separate call to <b>WNetEnumResource</b>.
</dd>
<dt>
<i>lpcbBuffer</i></dt>
<dd>
Pointer to a location that, on entry, specifies the size, in bytes, of the buffer pointed to by <i>lpBuffer</i>. If the buffer is too small for the result, the function places the required buffer size at this location and returns the error ERROR_MORE_DATA.</dd>
<dt>
<i>lplpSystem</i></dt>
<dd>
If the function returns successfully, <i>lplpSystem</i> points to a string in the output buffer that specifies the part of the resource that is accessed through system functions. This applies only to functions specific to the resource type rather than Windows networking functions.
<p>
For example, if the input remote resource name was \\server\share\dir1\dir2, the <i>lpRemoteName</i> parameter of the output <b>NETRESOURCE</b> structure points to \\server\share. Also, the <i>lplpSystem</i> parameter points to \dir1\dir2. Both strings are stored in the buffer pointed to by <i>lpBuffer</i>.

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is NO_ERROR.</p>
<p>
If the function fails, the return value is one of the following error codes </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=47%>Value</th>
<th align=left width=53%>Meaning</th>
</tr>
<tr valign=top>
<td width=47%>ERROR_BAD_NET_NAME</td>
<td width=53%>The <i>lpRemoteName</i> parameter is not an existing network resource for any network.</td>
</tr>
<tr valign=top>
<td width=47%>ERROR_BAD_DEV_TYPE</td>
<td width=53%>The <i>dwType</i> parameter does not match the type of the resource specified by <i>lpRemoteName</i>.</td>
</tr>
<tr valign=top>
<td width=47%>ERROR_EXTENDED_ERROR</td>
<td width=53%>A network-specific error occurred. Call <a href="networks_735e.htm"><b>WNetGetLastError</b></a> to obtain a description of the error.</td>
</tr>
<tr valign=top>
<td width=47%>ERROR_MORE_DATA</td>
<td width=53%>The buffer pointed to by <i>lpBuffer</i> is too small.</td>
</tr>
<tr valign=top>
<td width=47%>ERROR_NO_NETWORK</td>
<td width=53%>The network is not present.</td>
</tr>
</table><br>
<p>
&nbsp;&nbsp;<b>Header:</b> Declared in winnetwk.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with mpr.lib.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.5 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Use version 2.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winnetwk.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mpr.lib.</p>
<h4>See Also</h4>
<p>
<a href="networks_7t5r.htm">Windows Networking (WNet) Overview</a>, <a href="networks_0u43.htm">Windows Networking Functions</a>, <a href="networks_8nzo.htm"><b>WNetGetResourceParent</b></a></p>
<p>&nbsp;</p></body>
</HTML>
