<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NetServerEnum</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_netserverenum"></a>NetServerEnum</h1>
<p>
The <b>NetServerEnum</b> function lists all servers of the specified type that are visible in the specified domain. For example, an application can call<b> NetServerEnum</b> to list all domain controllers only or all SQL servers only.</p>
<p>
You can combine bit masks to list several types. For example, a value of 0x00000003 combines the bit masks for SV_TYPE_WORKSTATION (0x00000001) and SV_TYPE_SERVER (0x00000002).</p>
<p>
<b>Note</b>&nbsp;&nbsp;If you require more information on the type, name, and comment for a specific server, use the <a href="networks_03ad.htm"><b>WNetEnumResource</b></a> function.</p>
<h4>Security Requirements</h4>
<p>
No special group membership is required to successfully execute <b>NetServerEnum</b>.</p>
<pre><code><b>NET_API_STATUS NetServerEnum(
  LPWSTR</b><i> servername</i><b>,     </b>
<b>  DWORD</b><i> level</i><b>,           </b>
<b>  LPBYTE</b><i> *bufptr</i><b>,        </b>
<b>  DWORD</b><i> prefmaxlen</i><b>,      </b>
<b>  LPDWORD</b><i> entriesread</i><b>,   </b>
<b>  LPDWORD</b><i> totalentries</i><b>,  </b>
<b>  DWORD</b><i> servertype</i><b>,      </b>
<b>  LPWSTR</b><i> domain</i><b>,         </b>
<b>  LPDWORD</b><i> resume_handle</i>  
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>servername</i></dt>
<dd>
Pointer to a Unicode string containing the name of the remote server on which the function is to execute. A NULL pointer or string specifies the local computer.</dd>
<dt>
<i>level</i></dt>
<dd>
Specifies one of the following values to return the level of information provided.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=21%>Value</th>
<th align=left width=79%>Meaning</th>
</tr>
<tr valign=top>
<td width=21%>100</td>
<td width=79%>The <i>bufptr</i> parameter points to an array of <a href="ntlmapi_91wy.htm"><b>SERVER_INFO_100</b></a> structures.</td>
</tr>
<tr valign=top>
<td width=21%>101</td>
<td width=79%>The <i>bufptr</i> parameter points to an array of <a href="ntlmapi_8naq.htm"><b>SERVER_INFO_101</b></a> structures.</td>
</tr>
</table><br>

</dd>
<dt>
<i>bufptr</i></dt>
<dd>
Pointer to the buffer in which the data set with the <i>level</i> parameter is stored. </dd>
<dt>
<i>prefmaxlen</i></dt>
<dd>
Preferred maximum length, in 8-bit bytes of returned data.</dd>
<dt>
<i>entriesread</i></dt>
<dd>
On return, the actual enumerated element count is located in the doubleword pointed to by <i>entriesread</i>.</dd>
<dt>
<i>totalentries</i></dt>
<dd>
Returns the total number of visible servers and workstations on the network. </dd>
<dt>
<i>servertype</i></dt>
<dd>
A <b>DWORD</b> mask that filters server entries to return from the enumeration. The defined mask bits specify:
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=52%>Symbolic constant</th>
<th align=left width=22%>Value</th>
<th align=left width=26%>Meaning</th>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_WORKSTATION</td>
<td width=22%>0x00000001 </td>
<td width=26%>All Net workstations</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_SERVER</td>
<td width=22%>0x00000002 </td>
<td width=26%>All Net servers</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_SQLSERVER</td>
<td width=22%>0x00000004</td>
<td width=26%>Any server running with Microsoft SQL Server</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_DOMAIN_CTRL</td>
<td width=22%>0x00000008</td>
<td width=26%>Primary domain controller</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_DOMAIN_BAKCTRL</td>
<td width=22%>0x00000010</td>
<td width=26%>Backup domain controller</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_TIMESOURCE</td>
<td width=22%>0x00000020</td>
<td width=26%>Server running the Timesource service</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_AFP</td>
<td width=22%>0x00000040</td>
<td width=26%>Apple File Protocol servers</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_NOVELL</td>
<td width=22%>0x00000080</td>
<td width=26%>Novell servers</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_DOMAIN_MEMBER</td>
<td width=22%>0x00000100</td>
<td width=26%>LAN Manager 2.<i>x</i> Domain Member</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_LOCAL_LIST_ONLY</td>
<td width=22%>0x40000000</td>
<td width=26%>Servers maintained by the browser. See the following Remarks section.</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_PRINT</td>
<td width=22%>0x00000200</td>
<td width=26%>Server sharing print queue</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_DIALIN</td>
<td width=22%>0x00000400</td>
<td width=26%>Server running dial-in service</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_XENIX_SERVER</td>
<td width=22%>0x00000800</td>
<td width=26%>Xenix server</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_MFPN</td>
<td width=22%>0x00004000</td>
<td width=26%>Microsoft File and Print for Netware</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_NT</td>
<td width=22%>0x00001000</td>
<td width=26%>Windows NT (either Workstation or Server)</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_WFW</td>
<td width=22%>0x00002000</td>
<td width=26%>Server running Windows for Workgroups</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_SERVER_NT</td>
<td width=22%>0x00008000</td>
<td width=26%>Windows NT Non-DC server</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_POTENTIAL_BROWSER</td>
<td width=22%>0x00010000</td>
<td width=26%>Server that can run the Browser service</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_BACKUP_BROWSER </td>
<td width=22%>0x00020000</td>
<td width=26%>Server running a Browser service as backup</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_MASTER_BROWSER</td>
<td width=22%>0x00040000</td>
<td width=26%>Server running the master Browser service</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_DOMAIN_MASTER</td>
<td width=22%>0x00080000</td>
<td width=26%>Server running the domain master Browser</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_DOMAIN_ENUM</td>
<td width=22%>0x80000000</td>
<td width=26%>Primary Domain </td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_WINDOWS</td>
<td width=22%>0x00400000</td>
<td width=26%>Windows 95 or later</td>
</tr>
<tr valign=top>
<td width=52%>SV_TYPE_ALL</td>
<td width=22%>0xFFFFFFFF</td>
<td width=26%>All servers</td>
</tr>
</table><br>

</dd>
<dt>
<i>domain</i></dt>
<dd>
A pointer to a Unicode string containing the name of the domain for which a list of servers is to returned. If NULL is specified, the primary domain is implied.</dd>
<dt>
<i>resume_handle</i></dt>
<dd>
Reserved. Must be set to zero. Use the Wnet functions.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function returns account information, the return value is NERR_Success.</p>
<p>
If the function fails, the return value is one of the following error codes:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=52%>Value</th>
<th align=left width=48%>Meaning</th>
</tr>
<tr valign=top>
<td width=52%>ERROR_ACCESS_DENIED</td>
<td width=48%>The user does not have access to the requested information.</td>
</tr>
<tr valign=top>
<td width=52%>NERR_InvalidComputer</td>
<td width=48%>The computer name is invalid.</td>
</tr>
<tr valign=top>
<td width=52%>ERROR_NO_BROWSER_SERVERS_FOUND</td>
<td width=48%>No browser servers found.</td>
</tr>
<tr valign=top>
<td width=52%>ERROR_MORE_DATA </td>
<td width=48%>More entries are available with subsequent calls.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The SV_TYPE_LOCAL_LIST_ONLY flag returns the list of servers maintained by the browser internally. This has meaning only on the master browser (or on a computer that has been the master browser in the past). The master browser is the machine that currently has rights to determine which machines can be servers or workstations on the net.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in lmserver.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use netapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="ntlmapi_7o4f.htm">Networking (Net) Overview</a>, <a href="ntlmapi_0bn7.htm">Net Functions</a>, <a href="ntlmapi_808d.htm"><b>NetServerDiskEnum</b></a>, <a href="ntlmapi_2f5a.htm"><b>NetQueryDisplayInformation</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
