<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Replicator Functions</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_replicator_functions"></a>Replicator Functions</h3>
<p>
The Windows NT replicator service maintains identical sets of files and directories on different servers and workstations. When you update files on one server, the replicator service replaces the replicated files on other servers and workstations with the updated files. This replication process not only simplifies the task of updating and coordinating files, but it maintains the integrity of the replicated data.</p>
<p>
Replication is controlled by options you set in the LANMAN.INI file using  the following categories of replicator functions:
<ul>
<li>
<a href="#_win32_replicator_configuration_functions">Replicator configuration functions</a> </li>
<li>
<a href="#_win32_replicator_export_directory_functions">Replicator export directory functions</a> </li>
<li>
<a href="#_win32_replicator_import_directory_functions">Replicator import directory functions</a> </li>
</ul>
<p>
To replicate a set of files and directories on several computers, you place a master set of files and directories on a server that you designate as an <i>export server</i>. You then designate servers and workstations that receive the replicated files as <i>import servers</i>. The export servers keep the set of master files in an export directory tree of up to 32 levels. Each directory may contain as many as 1000 files. The import servers and workstations have corresponding import directories. When you change a file, or add or delete a directory or file in the export directory, the replicator service copies the same changes to the corresponding import directories on all import servers and workstations.</p>
<p>
A network can have any number of export and import servers. A server can be both an export and an import server. However, you can configure only workstations as import servers.</p>
<p>
If you are unable to replicate files, before using the replicator functions, check the Control Panel Services application to make sure the replicator service is configured to log on using a specific user account. This user account must be a member of the Replicator local group, and it must not be disabled or lacking permission to access the import and export trees on the respective servers. Failure specify the user account is the most common error in configuring the Replicator service.</p>
<p>
The Windows NT Replicator service is intended to copy relatively small directory trees. If you are attempting to replicate multimegabyte directory trees or trees containing thousands of directories and files, you should consider some other means of doing so.</p>
<p>
The change from the file system based control in LAN Manager 2.<i>x</i> to replicator function control in Windows NT has the following implications:
<ul>
<li>
Applications can no longer delete a directory in the import path of a client to stop receiving updates from its master.</li>
<li>
Applications can no longer use the REPL.INI file in each replicated directory on a master to control the method of replication.</li>
<li>
Applications can no longer lock or unlock a directory on a master from being replicated by creating or deleting the USERLOCK.* file(s).</li>
<li>
Applications can no longer lock or unlock a directory on a client from receiving updates from its master by creating or deleting USERLOCK.* files.</li>
<li>
Applications that depend on the LAN Manager 2.<i>x</i> behavior of ignoring locks for file integrity trees will need to be modified. (Windows NT policy differs from LAN Manager 2.<i>x</i> policy; under Windows NT the locks are always respected.)</li>
</ul>
<p>
Each of the intended operations listed preceding can be specified to the Windows NT replicator service through an appropriate function.</p>
<p>
Any user or application logged on as a member of the administration group or the server operator group on a local or remote export server can modify the parameters that control the replication service.</p>

<h4><a name="_win32_replicator_configuration_functions"></a>Replicator Configuration Functions</h4>
<p>
The configuration parameters of the replicator service can be examined and modified using the replicator configuration functions. The replicator configuration functions are:</p>
<p>
<a href="ntlmapi_6epb.htm"><b>NetReplGetInfo</b></a><br>
<a href="ntlmapi_8xyn.htm"><b>NetReplSetInfo</b></a></p>
<p>
The configuration parameters of the replictor can be examined using <a href="ntlmapi_6epb.htm"><b>NetReplGetInfo</b></a>. They can be modified using <a href="ntlmapi_8xyn.htm"><b>NetReplSetInfo</b></a>.</p>
<p>
The replicator configuration information structures are:</p>
<p>
<a href="ntlmapi_9376.htm"><b>REPL_INFO_0</b></a><br>
<a href="ntlmapi_02cy.htm"><b>REPL_INFO_1000</b></a><br>
<a href="ntlmapi_9nqq.htm"><b>REPL_INFO_1001</b></a><br>
<a href="ntlmapi_994i.htm"><b>REPL_INFO_1002</b></a><br>
<a href="ntlmapi_8uia.htm"><b>REPL_INFO_1003</b></a></p>

<h4><a name="_win32_replicator_export_directory_functions"></a>Replicator Export Directory Functions</h4>
<p>
The replicator export directory functions control top-level directories under the export path on the master. The replicator export directory functions are:</p>
<p>
<a href="ntlmapi_8zc4.htm"><b>NetReplExportDirAdd</b></a> <br>
<a href="ntlmapi_98vg.htm"><b>NetReplExportDirDel</b></a> <br>
<a href="ntlmapi_8759.htm"><b>NetReplExportDirEnum</b></a> <br>
<a href="ntlmapi_1qen.htm"><b>NetReplExportDirGetInfo</b></a> <br>
<a href="ntlmapi_7lbf.htm"><b>NetReplExportDirLock</b></a> <br>
<a href="ntlmapi_49nz.htm"><b>NetReplExportDirSetInfo</b></a> <br>
<a href="ntlmapi_502z.htm"><b>NetReplExportDirUnlock</b></a> </p>
<p>
A user can create a new directory under the export path and the Replicator service will automatically replicate that directory. Or, a directory under the export path can be registered using <a href="ntlmapi_8zc4.htm"><b>NetReplExportDirAdd</b></a>. When adding a directory to be replicated using these functions, the replication controls (<b>integrity</b> and <b>extent</b>) are specified using the <b>NetReplExportDirAdd</b> function. If the directory is created in the file system and no replicator functions are called, then the directory is treated as having file integrity and tree extent.</p>
<p>
The <b>integrity</b> control determines when a master updates a client. When <b>integrity</b> is REPL_INTEGRITY_FILE, the client gets a replica of a file within the directory when it is not in use (being changed or replicated). When <b>integrity </b>is set to REPL_INTEGRITY_TREE, every file and directory within the replicated directory must be stable for the amount of time specified by the <b>guardtime </b>parameter before the client is updated. The <b>extent</b> control determines whether the entire tree within the directory is replicated (REPL_EXTENT_TREE) or only the files in the first-level directory is replicated (REPL_EXTENT_FILE).</p>
<p>
The replication controls of each replicated directory can be examined using <a href="ntlmapi_1qen.htm"><b>NetReplExportDirGetInfo</b></a>, and dynamically modified using<b> <a href="ntlmapi_49nz.htm">NetReplExportDirSetInfo</a></b>. These control fields used to be specified in the REPL.INI file within each replicated directory on LAN Manager 2.<i>x</i>, and they could not be dynamically set. On Windows NT, the REPL.INI file is not used and will be ignored in the replication process.</p>
<p>
The <a href="ntlmapi_8759.htm"><b>NetReplExportDirEnum</b></a> function returns a list of directories that are currently replicated. The <a href="ntlmapi_98vg.htm"><b>NetReplExportDirDel</b></a> function removes registration from a directory so that it is no longer replicated.</p>
<p>
The lock status information is returned in two fields: <b>lockcount</b> and <b>locktime</b>. The <b>lockcount</b> field indicates the number of outstanding locks on a directory. The <b>locktime</b> field indicates the time (in seconds since 1970, GMT) when the directory was first locked, or is 0 if the directory is not locked at the present time.</p>
<p>
The <a href="ntlmapi_7lbf.htm"><b>NetReplExportDirLock</b></a> function locks a directory so that it is not replicated, by incrementing a lock reference count for the directory. A lock on a directory can be unlocked using <a href="ntlmapi_502z.htm"><b>NetReplExportDirUnlock</b></a><b>.</b> The replication does not resume unless all outstanding locks on that directory are released, and the lock reference count is returned to 0. (The <b>locktime</b> field is automatically set to 0 when <b>lockcount</b> is 0.)</p>
<p>
The replicator export directory functions can be called regardless of whether the Replicator service is running. If the Replicator service is running as a master, any modification to the directory controls takes effect immediately, and is persistent after the Replicator service has been stopped. If the Replicator service is not started, the controls for the directory is stored as persistent information and will take effect when the Replicator service starts up.</p>
<p>
The replicator export directory functions are available at the following information levels:</p>
<p>
<a href="ntlmapi_85iq.htm"><b>REPL_EDIR_INFO_0</b></a><br>
<a href="ntlmapi_7qwi.htm"><b>REPL_EDIR_INFO_1</b></a><br>
<a href="ntlmapi_7caa.htm"><b>REPL_EDIR_INFO_2</b></a><br>
<a href="ntlmapi_6zci.htm"><b>REPL_EDIR_INFO_1000</b></a><br>
<a href="ntlmapi_6kqa.htm"><b>REPL_EDIR_INFO_1001</b></a></p>

<h4><a name="_win32_replicator_import_directory_functions"></a>Replicator Import Directory Functions</h4>
<p>
The replicator import directory functions designate the top-level directories under the import path to receive updates on. They also return status information about a replicated directory on the client. On LAN Manager 2.<i>x</i>, a user must create a directory under the import path and the Replicator service automatically replicates to it. The replicator import directory functions are:</p>
<p>
<a href="ntlmapi_9vfo.htm"><b>NetReplImportDirAdd</b></a>  <br>
<a href="ntlmapi_04z0.htm"><b>NetReplImportDirDel</b></a> <br>
<a href="ntlmapi_59gt.htm"><b>NetReplImportDirEnum</b></a> <br>
<a href="ntlmapi_0ne7.htm"><b>NetReplImportDirGetInfo</b></a> <br>
<a href="ntlmapi_4nmz.htm"><b>NetReplImportDirLock</b></a> <br>
<a href="ntlmapi_12uj.htm"><b>NetReplImportDirUnlock</b></a></p>
<p>
On Windows NT, import directories are automatically added if they are exported by an export server from which importer is importing. Another way to register a directory in advance of it being exported, is to use the <a href="ntlmapi_9vfo.htm"><b>NetReplImportDirAdd</b></a> functions. This function does not create the directory itself. This is useful if you wish to modify some of the properties of the import directory (for example, to lock it) prior to it first beginning to import this directory.</p>
<p>
The <a href="ntlmapi_04z0.htm"><b>NetReplImportDirDel</b></a> function unregisters a directory. This is used to clean up a directory that is no longer being exported. It will not stop replication if there is an active exporter, since it will be re-registered the next time the exporter tells the importer what directories it is exporting. If you wish to prevent importing of an actively exported directory, use <a href="ntlmapi_4nmz.htm"><b>NetReplImportDirLock</b></a>.</p>
<p>
The<a href="ntlmapi_59gt.htm"> <b>NetReplImportDirEnum</b></a> function lists all the directories that are replicated to a client, and <a href="ntlmapi_0ne7.htm"><b>NetReplImportDirGetInfo</b></a><b> </b>returns the status of a specified directory.</p>
<p>
The status information of a directory consists of the<b> </b>replication <b>state</b>, the UNC computer name of the master (<b>mastername</b>), and the time (in seconds since 1970, GMT) when the directory was last updated (<b>last_update_time</b>). If the <b>state </b>is REPL_STATE_OK, the directory currently has a master, and is receiving regular update notices from it. If the <b>state</b> is REPL_STATE_NO_MASTER, the directory is not supported by any master, and it is typically empty. If the <b>state</b> is REPL_STATE_NO_SYNC, the directory has a master, but the master has not sent any update notices within the <b>interval</b> time period. This may be due to a communication failure, the master crashing, the directory being locked, files in the client directory being opened at update time, or an unstable REPL_INTEGRITY_TREE <b>integrity</b> directory on the master. If the client Replicator service is not started, the <b>state</b> is REPL_STATE_NEVER_REPLICATED, <b>mastername</b> is a NULL string, and <b>last_update_time</b> is 0. The <a href="ntlmapi_4nmz.htm"><b>NetReplImportDirLock</b></a> function locks a directory so that it does not receive updates, by incrementing a lock reference count for the directory. A lock on a directory can be unlocked using <a href="ntlmapi_12uj.htm"><b>NetReplImportDirUnlock</b></a><b>.</b> The directory is not updated unless all outstanding locks on that directory are released, and the lock reference count is returned to 0.</p>
<p>
The lock status information is returned in two fields: <b>lockcount</b> and <b>locktime</b>. The <b>lockcount</b> field indicates the number of outstanding locks on a directory. The <b>locktime</b> field indicates the time (in seconds since 1970, GMT) when the directory was first locked. (<b>locktime</b> is set to 0 whenever <b>lockcount</b> goes to 0.)</p>
<p>
The replicator import directory functions can be called whether the Replicator service is running or not. If the Replicator service is running as a client, directory adds or deletes take effect immediately, and is persistent after the Replicator service has been stopped. If the Replicator service is not started, any added directory will receive updates when the Replicator service starts up (if there exists a master that exports the directory).</p>
<p>
The replicator import directory function are available at the following information levels:</p>
<p>
<a href="ntlmapi_3bhu.htm"><b>REPL_IDIR_INFO_0</b></a><br>
<a href="ntlmapi_2wvm.htm"><b>REPL_IDIR_INFO_1</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
