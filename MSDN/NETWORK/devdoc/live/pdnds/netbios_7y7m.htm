<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NCB</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_ncb_str"></a>NCB</h1>
<p>
The <b>NCB</b> structure represents a network control block. It contains information about the command to perform, an optional post routine, an optional event handle, and a pointer to a buffer that is used for messages or other data. A pointer to this structure is passed to the <a href="netbios_4n1v.htm"><b>Netbios</b></a> function. </p>
<pre><code>typedef struct _NCB { // ncb 
    UCHAR  ncb_command; 
    UCHAR  ncb_retcode; 
    UCHAR  ncb_lsn; 
    UCHAR  ncb_num; 
    PUCHAR ncb_buffer; 
    WORD   ncb_length; 
    UCHAR  ncb_callname[NCBNAMSZ]; 
    UCHAR  ncb_name[NCBNAMSZ]; 
    UCHAR  ncb_rto; 
    UCHAR  ncb_sto; 
    void (*ncb_post) (struct _NCB *); 
    UCHAR  ncb_lana_num; 
    UCHAR  ncb_cmd_cplt; 
    UCHAR  ncb_reserve[10]; 
    HANDLE ncb_event; 
} NCB; 
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>ncb_command</b></dt>
<dd>
Specifies the command code and a flag that indicates whether the <b>NCB</b> structure is processed asynchronously. The most significant bit contains the flag. If the ASYNCH constant is combined with a command code (by using the OR operator), the <b>NCB</b> structure is processed asynchronously. The following command codes are supported. 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=31%>Code</th>
<th align=left width=69%>Meaning</th>
</tr>
<tr valign=top>
<td width=31%>NCBACTION</td>
<td width=69%><b>Windows NT:</b> Enables extensions to the transport interface. NCBACTION is mapped to <b>TdiAction</b>. When this code is specified, the <b>ncb_buffer</b> member points to a buffer to be filled with an <a href="netbios_9ylu.htm"><b>ACTION_HEADER</b></a> structure, which is optionally followed by data. NCBACTION commands cannot be canceled by using NCBCANCEL.<p>
NCBACTION is not a standard NetBIOS 3.0 command. </p>
</td>
</tr>
<tr valign=top>
<td width=31%>NCBADDGRNAME</td>
<td width=69%>Adds a group name to the local name table. This name cannot be used by another process on the network as a unique name, but it can be added by anyone as a group name. </td>
</tr>
<tr valign=top>
<td width=31%>NCBADDNAME</td>
<td width=69%>Adds a unique name to the local name table. The TDI driver ensures that the name is unique across the network. </td>
</tr>
<tr valign=top>
<td width=31%>NCBASTAT</td>
<td width=69%>Retrieves the status of either a local or remote adapter. When this code is specified, the <b>ncb_buffer</b> member points to a buffer to be filled with an <a href="netbios_952q.htm"><b>ADAPTER_STATUS</b></a> structure, followed by an array of <a href="netbios_56r6.htm"><b>NAME_BUFFER</b></a> structures.</td>
</tr>
<tr valign=top>
<td width=31%>NCBCALL</td>
<td width=69%>Opens a session with another name.</td>
</tr>
<tr valign=top>
<td width=31%>NCBCANCEL</td>
<td width=69%>Cancels a previous pending command.</td>
</tr>
<tr valign=top>
<td width=31%>NCBCHAINSEND</td>
<td width=69%>Sends the contents of two data buffers to the specified session partner.</td>
</tr>
<tr valign=top>
<td width=31%>NCBCHAINSENDNA</td>
<td width=69%>Sends the contents of two data buffers to the specified session partner and does not wait for acknowledgment. </td>
</tr>
<tr valign=top>
<td width=31%>NCBDELNAME</td>
<td width=69%>Deletes a name from the local name table.</td>
</tr>
<tr valign=top>
<td width=31%>NCBDGRECV</td>
<td width=69%>Receives a datagram from any name.</td>
</tr>
<tr valign=top>
<td width=31%>NCBDGRECVBC</td>
<td width=69%>Receives a broadcast datagram from any name.</td>
</tr>
<tr valign=top>
<td width=31%>NCBDGSEND</td>
<td width=69%>Sends datagram to a specified name.</td>
</tr>
<tr valign=top>
<td width=31%>NCBDGSENDBC</td>
<td width=69%>Sends a broadcast datagram to every host on the local area network (LAN).</td>
</tr>
<tr valign=top>
<td width=31%>NCBENUM</td>
<td width=69%><b>Windows NT:</b> Enumerates LAN adapter (LANA) numbers. When this code is specified, the <b>ncb_buffer</b> member points to a buffer to be filled with a <a href="netbios_8d82.htm"><b>LANA_ENUM</b></a> structure. <p>
NCBENUM is not a standard NetBIOS 3.0 command. </p>
</td>
</tr>
<tr valign=top>
<td width=31%>NCBFINDNAME</td>
<td width=69%>Determines the location of a name on the network. When this code is specified, the <b>ncb_buffer</b> member points to a buffer to be filled with a <a href="netbios_4f76.htm"><b>FIND_NAME_HEADER</b></a> structure followed by one or more <a href="netbios_5ble.htm"><b>FIND_NAME_BUFFER</b></a> structures.</td>
</tr>
<tr valign=top>
<td width=31%>NCBHANGUP</td>
<td width=69%>Closes a specified session.</td>
</tr>
<tr valign=top>
<td width=31%>NCBLANSTALERT</td>
<td width=69%><b>Windows NT:</b> Notifies the user of LAN failures that last for more than one minute.</td>
</tr>
<tr valign=top>
<td width=31%>NCBLISTEN</td>
<td width=69%>Enables a session to be opened with another name (local or remote).</td>
</tr>
<tr valign=top>
<td width=31%>NCBRECV</td>
<td width=69%>Receives data from the specified session partner.</td>
</tr>
<tr valign=top>
<td width=31%>NCBRECVANY</td>
<td width=69%>Receives data from any session corresponding to a specified name.</td>
</tr>
<tr valign=top>
<td width=31%>NCBRESET</td>
<td width=69%>Resets a LAN adapter. An adapter must be reset before it can accept any other NCB command that specifies the same number in the <b>ncb_lana_num</b> member.</td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=69%>Use the following values to specify how resources are to be freed: </td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=69%><ul>
<li>
If <b>ncb_lsn</b> is not 0x00, all resources associated with <b>ncb_lana_num</b> are to be freed. </li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=69%><ul>
<li>
If <b>ncb_lsn</b> is 0x00, all resources associated with <b>ncb_lana_num</b> are to be freed, and new resources are to be allocated. The <b>ncb_callname</b>[0] byte specifies the maximum number of sessions, and the <b>ncb_callname</b>[2] byte specifies the maximum number of names. A nonzero value for the <b>ncb_callname</b>[3] byte requests that the application use NAME_NUMBER_1.</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=31%>NCBSEND</td>
<td width=69%>Sends data to the specified session partner. </td>
</tr>
<tr valign=top>
<td width=31%>NCBSENDNA</td>
<td width=69%>Sends data to specified session partner and does not wait for acknowledgment. </td>
</tr>
<tr valign=top>
<td width=31%>NCBSSTAT</td>
<td width=69%>Retrieves the status of the session. When this value is specified, the <b>ncb_buffer</b> member points to a buffer to be filled with a <a href="netbios_0582.htm"><b>SESSION_HEADER</b></a> structure, followed by one or more <a href="netbios_11ma.htm"><b>SESSION_BUFFER</b></a> structures.</td>
</tr>
<tr valign=top>
<td width=31%>NCBTRACE</td>
<td width=69%>Activates or deactivates NCB tracing. <p>
This command is not supported. </p>
</td>
</tr>
<tr valign=top>
<td width=31%>NCBUNLINK</td>
<td width=69%>Unlinks the adapter. <p>
This command is provided for compatibility with earlier versions of NetBIOS. It has no effect in Win32. </p>
</td>
</tr>
</table><br>

</dd>
<dt>
<b>ncb_retcode</b></dt>
<dd>
Specifies the return code. This value is set to NRC_PENDING while an asynchronous operation is in progress. The system returns one of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=35%>Value</th>
<th align=left width=65%>Meaning</th>
</tr>
<tr valign=top>
<td width=35%>NRC_GOODRET</td>
<td width=65%>The operation succeeded.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_BUFLEN</td>
<td width=65%>An illegal buffer length was supplied.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_ILLCMD</td>
<td width=65%>An illegal command was supplied.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_CMDTMO</td>
<td width=65%>The command was timed out.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_INCOMP</td>
<td width=65%>The message was incomplete. The application is to issue another command.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_BADDR</td>
<td width=65%>The buffer address was illegal.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_SNUMOUT</td>
<td width=65%>The session number was out of range.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_NORES</td>
<td width=65%>No resource was available.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_SCLOSED</td>
<td width=65%>The session was closed.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_CMDCAN</td>
<td width=65%>The command was canceled.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_DUPNAME</td>
<td width=65%>A duplicate name existed in the local name table.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_NAMTFUL</td>
<td width=65%>The name table was full.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_ACTSES</td>
<td width=65%>The command finished; the name has active sessions and is no longer registered.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_LOCTFUL</td>
<td width=65%>The local session table was full.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_REMTFUL</td>
<td width=65%>The remote session table was full. The request to open a session was rejected.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_ILLNN</td>
<td width=65%>An illegal name number was specified.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_NOCALL</td>
<td width=65%>The system did not find the name that was called.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_NOWILD</td>
<td width=65%>Wildcards are not permitted in the <b>ncb_name</b> member.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_INUSE</td>
<td width=65%>The name was already in use on the remote adapter.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_NAMERR</td>
<td width=65%>The name was deleted.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_SABORT</td>
<td width=65%>The session ended abnormally.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_NAMCONF</td>
<td width=65%>A name conflict was detected.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_IFBUSY</td>
<td width=65%>The interface was busy.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_TOOMANY</td>
<td width=65%>Too many commands were outstanding; the application can retry the command later.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_BRIDGE</td>
<td width=65%>The <b>ncb_lana_num</b> member did not specify a valid network number.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_CANOCCR</td>
<td width=65%>The command finished while a cancel operation was occurring.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_CANCEL</td>
<td width=65%>The NCBCANCEL command was not valid; the command was not canceled.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_DUPENV</td>
<td width=65%>The name was defined by another local process.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_ENVNOTDEF</td>
<td width=65%>The environment was not defined. A reset command must be issued.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_OSRESNOTAV</td>
<td width=65%>Operating system resources were exhausted. The application can retry the command later.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_MAXAPPS</td>
<td width=65%>The maximum number of applications was exceeded.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_NOSAPS</td>
<td width=65%>No service access points (SAPs) were available for NetBIOS.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_NORESOURCES</td>
<td width=65%>The requested resources were not available.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_INVADDRESS</td>
<td width=65%>The NCB address was not valid.</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>This return code is not part of the IBM NetBIOS 3.0 specification and is not returned in the <b>NCB </b>structure. Instead, it is returned by <a href="netbios_4n1v.htm"><b>Netbios</b></a>.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_INVDDID</td>
<td width=65%>The NCB DDID was invalid.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_LOCKFAIL</td>
<td width=65%>The attempt to lock the user area failed.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_OPENERR</td>
<td width=65%>An error occurred during an open operation being performed by the device driver. This error code is not part of the NetBIOS 3.0 specification.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_SYSTEM</td>
<td width=65%>A system error occurred.</td>
</tr>
<tr valign=top>
<td width=35%>NRC_PENDING</td>
<td width=65%>An asynchronous operation is not yet finished.</td>
</tr>
</table><br>

</dd>
<dt>
<b>ncb_lsn</b></dt>
<dd>
Identifies the local session number. This number uniquely identifies a session within an environment. This number is returned by <a href="netbios_4n1v.htm"><b>Netbios</b></a> after a successful NCBCALL command. </dd>
<dt>
<b>ncb_num</b></dt>
<dd>
Specifies the number for the local network name. This number is returned by <b>Netbios</b> after a successful NCBADDNAME or NCBADDGRNAME command. This number, not the name, must be used with all datagram commands and for NCBRECVANY commands. 
<p>
The number for NAME_NUMBER_1 is always 0x01. <b>Netbios</b> assigns values in the range 0x02 to 0xFE for the remaining names.
</dd>
<dt>
<b>ncb_buffer</b></dt>
<dd>
Pointer to the message buffer. The buffer must have write access. Its uses are as follows: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=25%>Command</th>
<th align=left width=75%>Purpose</th>
</tr>
<tr valign=top>
<td width=25%>NCBSEND</td>
<td width=75%>Contains the message to be sent. </td>
</tr>
<tr valign=top>
<td width=25%>NCBRECV</td>
<td width=75%>Receives the message. </td>
</tr>
<tr valign=top>
<td width=25%>NCBSSTAT</td>
<td width=75%>Receives the requested status information.</td>
</tr>
</table><br>

</dd>
<dt>
<b>ncb_length</b></dt>
<dd>
Specifies the size, in bytes, of the message buffer. For receive commands, this member is set by the <a href="netbios_4n1v.htm"><b>Netbios</b></a> function to indicate the number of bytes received. 
<p>
If the buffer length is incorrect, the <b>Netbios</b> function returns the NRC_BUFLEN error code. 
</dd>
<dt>
<b>ncb_callname</b></dt>
<dd>
Specifies the name of the remote application. Trailing-space characters should be supplied to make the length of the string equal to NCBNAMSZ. </dd>
<dt>
<b>ncb_name</b></dt>
<dd>
Specifies the name by which the application is known. Trailing-space characters should be supplied to make the length of the string equal to NCBNAMSZ. </dd>
<dt>
<b>ncb_rto</b></dt>
<dd>
Specifies the time-out period for receive operations, in 500-millisecond units, for the session. A value of zero implies no time-out. Specify with the NCBCALL or NCBLISTEN command. Affects subsequent NCBRECV commands. </dd>
<dt>
<b>ncb_sto</b></dt>
<dd>
Specifies the time-out period for send operations, in 500-millisecond units, for the session. A value of zero implies no time-out. Specify with the NCBCALL or NCBLISTEN command. Affects subsequent NCBSEND and NCBCHAINSEND commands. </dd>
<dt>
<b>ncb_post</b></dt>
<dd>
Specifies the address of the post routine to call when the asynchronous command is completed. The post routine is defined as: 
<p>
<b>NCB_POST</b> <b>PostRoutine</b>( <b>PNCB</b> <i>pncb</i> );

<p>
where the <i>pncb</i> parameter is a pointer to the completed network control block. 
</dd>
<dt>
<b>ncb_lana_num</b></dt>
<dd>
Specifies the LAN adapter number. This zero-based number corresponds to a particular transport provider using a particular LAN adapter board. </dd>
<dt>
<b>ncb_cmd_cplt</b></dt>
<dd>
Specifies the command complete flag. This value is the same as the <b>ncb_retcode</b> member. </dd>
<dt>
<b>ncb_reserve</b></dt>
<dd>
Reserved; must be zero. </dd>
<dt>
<b>ncb_event</b></dt>
<dd>
Specifies a handle to an event object that is set to the nonsignaled state when an asynchronous command is accepted, and it is set to the signaled state when the asynchronous command is completed. The event is signaled if the <a href="netbios_4n1v.htm"><b>Netbios</b></a> function returns a nonzero value. Only manual reset events should be used for synchronization. A specified event should not be associated with more than one active asynchronous command. 
<p>
The <b>ncb_event</b> member must be zero if the <b>ncb_command</b> member does not have the ASYNCH flag set or if <b>ncb_post</b> is nonzero. Otherwise, <b>Netbios</b> returns the NRC_ILLCMD error code. 

</dd>
</dl>
<h4>Remarks</h4>
<p>
Using <b>ncb_event</b> to issue asynchronous requests requires fewer system resources than using <b>ncb_post</b>. In addition, when <b>ncb_event</b> is nonzero, the pending request is canceled if the thread terminates before the request is processed. This is not true for asynchronous requests sent using <b>ncb_post</b>. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in nb30.h.</p>
<h4>See Also</h4>
<p>
<a href="netbios_59ut.htm">The NetBIOS Interface Overview</a>, <a href="netbios_8g4z.htm">NetBIOS Structures</a>, <a href="netbios_9ylu.htm"><b>ACTION_HEADER</b></a>, <a href="netbios_952q.htm"><b>ADAPTER_STATUS</b></a>, <a href="netbios_5ble.htm"><b>FIND_NAME_BUFFER</b></a>, <a href="netbios_4f76.htm"><b>FIND_NAME_HEADER</b></a>, <a href="netbios_8d82.htm"><b>LANA_ENUM</b></a>, <a href="netbios_56r6.htm"><b>NAME_BUFFER</b></a>, <a href="netbios_4n1v.htm"><b>Netbios</b></a>, <a href="netbios_11ma.htm"><b>SESSION_BUFFER</b></a>, <a href="netbios_0582.htm"><b>SESSION_HEADER</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
