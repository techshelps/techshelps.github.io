<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Subentries and Multilink Connections</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_subentries_and_multilink_connections"></a>Subentries and Multilink Connections</h3>
<p>
Windows NT version 4.0 provides support for phone-book subentries, which enable multilink connections. A multilink connection combines the bandwidth of multiple connections to provide a single connection with higher bandwidth. </p>
<p>
A RAS phone-book entry can have zero or more subentries. The <a href="remacces_9uer.htm"><b>RasGetEntryProperties</b></a> function retrieves a <a href="remacces_81ki.htm"><b>RASENTRY</b></a> structure that includes information about the subentries of a phone-book entry. The <b>dwSubEntries</b> member of the <b>RASENTRY</b> structure indicates the number of subentries. Phone-book entries initially have no subentries. To add subentries to a phone-book entry, use the <a href="remacces_2c6r.htm"><b>RasSetSubEntryProperties</b></a> function.</p>
<p>
The properties for each subentry include a phone number and the name and type of the TAPI device to use when dialing the subentry. In addition, a subentry can include a list of alternate phone numbers to dial if RAS cannot make a connection using the primary number. The <b>RasSetSubEntryProperties</b> and <a href="remacces_4m9f.htm"><b>RasGetSubEntryProperties</b></a> functions use the <a href="remacces_62r6.htm"><b>RASSUBENTRY</b></a> structure to set and retrieve the properties of a specified phone-book subentry. Subentries are identified by a one-based index.</p>
<p>
You can call the <a href="remacces_2gc3.htm"><b>RasSetEntryProperties</b></a> function to configure a multilink RAS entry to connect all subentries when it is first dialed. Alternatively, you can configure an entry to provide variable bandwidth. In this case, RAS connects a single subentry initially, and then connects or disconnects additional subentries as needed. For a variable-bandwidth multilink connection, you can use the <a href="remacces_6gz6.htm"><b>RASDIALPARAMS</b></a> structure to specify the initial subentry to connect when you call the <a href="remacces_7pyk.htm"><b>RasDial</b></a> function. When using the <a href="remacces_0zc7.htm"><b>RasDialDlg</b></a> function to connect a multilink entry, you can use the <a href="remacces_8036.htm"><b>RASDIALDLG</b></a> structure to specify the initial subentry to connect. </p>
<p>
For a variable-bandwidth multilink connection, use the <a href="remacces_81ki.htm"><b>RASENTRY</b></a> structure with the <b>RasSetEntryProperties</b> function to specify the parameters for connecting and disconnecting the individual subentries. RAS connects an additional subentry when the bandwidth being used exceeds a specified percentage of the available bandwidth for a specified interval. </p>
<p>
If you call the <b>RasDial</b> function to establish a multilink connection, you can specify a <a href="remacces_19pu.htm"><b>RasDialFunc2</b></a> callback function to receive notifications about the connection. <b>RasDialFunc2</b> is similar to the <a href="remacces_19pt.htm"><b>RasDialFunc1</b></a> callback function, except that it provides additional information for a multilink connection, such as the index of the subentry that caused the notification. RAS calls your <b>RasDialFunc2</b> function when it connects or disconnects a subentry. </p>
<p>
You can use an <b>HRASCONN</b> connection handle to hang up or retrieve information about a multilink connection. You can get a connection handle for each of the subentry connections that make up the multilink, as well as for the combined multilink connection. When you call the <a href="remacces_7pyk.htm"><b>RasDial</b></a> function to establish a multilink connection, <b>RasDial</b> returns a handle to the combined multilink connection. Similarly, <a href="remacces_4ooj.htm"><b>RasEnumConnections</b></a> returns the combined multilink handle when you enumerate connections. To get a handle to one of the subentry connections in a multilink connection, call the <a href="remacces_1b6t.htm"><b>RasGetSubEntryHandle</b></a> function. </p>
<p>
You can use the combined multilink connection handle and the subentry connection handles in the <a href="remacces_7q5s.htm"><b>RasHangUp</b></a>, <a href="remacces_9tmb.htm"><b>RasGetConnectStatus</b></a>, and <a href="remacces_4v73.htm"><b>RasGetProjectionInfo</b></a> functions. Calling <b>RasHangUp</b> with a combined multilink handle terminates the entire connection; calling it with a subentry handle hangs up only that subentry connection. Similarly, <b>RasGetConnectStatus</b> returns information for the combined or individual connection, depending on the handle specified. The projection information returned by <b>RasGetProjectionInfo</b> for a multilink entry is the same for each of the subentry connection handles as it is for the main connection handle.</p>
<p>&nbsp;</p></body>
</HTML>
