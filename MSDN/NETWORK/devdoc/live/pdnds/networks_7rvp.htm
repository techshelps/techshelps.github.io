<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Assigning a Drive to a Share</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_assigning_a_drive_to_a_share"></a>Assigning a Drive to a Share</h2>
<p>
<b>Windows NT Only</b></p>
<p>
The following example demonstrates how to use the <a href="networks_84z6.htm"><b>WNetAddConnection2</b></a> function to connect a drive letter to a remote share on a server.</p>
<p>
To test the code sample, change the following lines to valid strings:</p>
<pre><code>szUserName[32]    = "myUserName",
szPassword[32]    = "myPassword",
szLocalName[32]    = "Q:",
szRemoteName[MAX_PATH] = "\\\\products2\\relsys";
</code></pre>
<p>
Add the file to a Windows Consol App project called AddConn2 and link the library MPR.LIB to the compiler list of libraries. Then, run the file AddConn2.EXE after you compile the following program.</p>
<pre><code>#include &lt;windows.h&gt;
#include &lt;stdio.h&gt;
#include &lt;winnetwk.h&gt;

void main()
{
NETRESOURCE nr;
DWORD res;
TCHAR szUserName[32] = "MyUserName",
    szPassword[32] = "MyPassword",
    szLocalName[32] = "Q:",
    szRemoteName[MAX_PATH] = "\\\\products2\\relsys";

nr.dwType = RESOURCETYPE_ANY;
nr.lpLocalName = (LPTSTR) &amp;szLocalName;
nr.lpRemoteName = (LPTSTR) &amp;szRemoteName;
nr.lpProvider = NULL;

res = WNetAddConnection2(&amp;nr, (LPTSTR) &amp;szPassword, (LPTSTR) &amp;szUserName, FALSE);

if(res == NO_ERROR)
  printf("Connection added \n", szRemoteName);
else
  printf("Error: %ld\n", res);
  return;
}
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
