<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RAS_PORT_0</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_ras_port_0_str"></a>RAS_PORT_0</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>RAS_PORT_0</b> structure contains information that describes a RAS port.</p>
<pre><code>typedef struct _RAS_PORT_0 {
    WCHAR wszPortName[RASSAPI_MAX_PORT_NAME];
    WCHAR wszDeviceType[RASSAPI_MAX_DEVICETYPE_NAME];
    WCHAR wszDeviceName[RASSAPI_MAX_DEVICE_NAME];
    WCHAR wszMediaName[RASSAPI_MAX_MEDIA_NAME];
    DWORD reserved;
    DWORD Flags;
    WCHAR wszUserName[UNLEN + 1];
    WCHAR wszComputer[NETBIOS_NAME_LEN];
    DWORD dwStartSessionTime;
    WCHAR wszLogonDomain[DNLEN + 1];
    BOOL fAdvancedServer;
} RAS_PORT_0, *PRAS_PORT_0;
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>wszPortName</b></dt>
<dd>
A null-terminated Unicode string that specifies the name of the port, such as "COM1".</dd>
<dt>
<b>wszDeviceType</b></dt>
<dd>
A null-terminated Unicode string that specifies the type of the device on which the connection was made, such as "Modem" or "ISDN". The list of device types that might be specified in this member includes all the device types installed on the server, including third-party devices. </dd>
<dt>
<b>wszDeviceName</b></dt>
<dd>
A null-terminated Unicode string that specifies the name of the device on which the connection was made, such as "Hayes 9600" or "PCIMACISDN1".</dd>
<dt>
<b>wszMediaName</b></dt>
<dd>
A null-terminated Unicode string that specifies the name of the media used for the connection, such as "rasser" or "rastapi".</dd>
<dt>
<b>reserved</b></dt>
<dd>
This member is reserved.</dd>
<dt>
<b>Flags</b></dt>
<dd>
A set of bit flags that specify the nature of the connection made on this port. This member can be a combination of the following flags.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>Value</th>
<th align=left width=55%>Meaning</th>
</tr>
<tr valign=top>
<td width=45%>GATEWAY_ACTIVE</td>
<td width=55%>If this flag is set, the NetBIOS gateway is active on the server.</td>
</tr>
<tr valign=top>
<td width=45%>MESSENGER_PRESENT</td>
<td width=55%>If this flag is set, the Windows NT messenger service is running on the remote client. </td>
</tr>
<tr valign=top>
<td width=45%>PORT_MULTILINKED</td>
<td width=55%>If this flag is set, the port is multilinked with other ports. You can use this information for displaying the connection status as a multilinked port. <p>
For a multilinked port, the <a href="remacces_5u2a.htm"><b>RAS_PORT_STATISTICS</b></a> structure contains two sets of statistics: one for the port alone, and another for the combined ports in the multilink connection.</p>
</td>
</tr>
<tr valign=top>
<td width=45%>PPP_CLIENT</td>
<td width=55%>If this flag is set, the remote client connected using PPP. If this flag is not set, the remote client connected using the AMB protocol. </td>
</tr>
<tr valign=top>
<td width=45%>REMOTE_LISTEN</td>
<td width=55%>If this flag is set, the RemoteListen parameter of the NetBIOS gateway is set to 1 on the server. </td>
</tr>
<tr valign=top>
<td width=45%>USER_AUTHENTICATED</td>
<td width=55%>If this flag is set, a remote client is connected to the server and the user has been authenticated. You can check this flag to ensure that a client is actually connected to a port.</td>
</tr>
</table><br>

</dd>
</dl>
<p>
If the MESSENGER_PRESENT, GATEWAY_ACTIVE, and REMOTE_LISTEN flags are set, you can use the Windows NT messenger service to send an administrative message to the remote client. If MESSENGER_PRESENT and REMOTE_LISTEN are set, but GATEWAY_ACTIVE is not, you can send a message to the client only if you send the message from the RAS server the client is dialed in to.</p>
<p>
If the MESSENGER_PRESENT, GATEWAY_ACTIVE, and REMOTE_LISTEN flags are set, you can use the Windows NT messenger service to send an administrative message to the remote client. If MESSENGER_PRESENT and REMOTE_LISTEN are set, but GATEWAY_ACTIVE is not, you can send a message to the client only if you send the message from the RAS server the client is dialed in to.
<dl>
<dt>
<b>wszUserName</b></dt>
<dd>
A null-terminated Unicode string that specifies the name of the remote user connected to this port. </dd>
<dt>
<b>wszComputer</b></dt>
<dd>
A null-terminated Unicode string that specifies the name of the remote client computer. </dd>
<dt>
<b>dwStartSessionTime</b></dt>
<dd>
Specifies the time, in seconds from January 1, 1970, that the client connected to the RAS server on this port. You can use the standard Win32 time routines to format this value for display.</dd>
<dt>
<b>wszLogonDomain</b></dt>
<dd>
A null-terminated Unicode string that specifies the name of the Windows NT domain on which the remote user was authenticated. This string is the domain name only, with no "\\" prefix.</dd>
<dt>
<b>fAdvancedServer</b></dt>
<dd>
A flag that is nonzero if the RAS server associated with this port is a Windows NT Advanced Server. You can use this information to determine the name of the server that has the user account database. If the RAS server is an Advanced Server, you can get the name of the user account server by concatenating the prefix "\\" to the name returned in the <b>wszLogonDomain</b> member. This is because for an Advanced Server the local logon domain name is the same as the server name. If the RAS server is a Windows NT Workstation, you can use the <b>RasAdminGetUserAccountServer</b> function to get the name of the user account server.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in rassapi.h.</p>
<h4>See Also</h4>
<p>
<a href="remacces_5aqt.htm">Remote Access Service Overview</a>, <a href="remacces_89f2.htm">RAS Server Administration Union</a>, <a href="remacces_14vm.htm"><b>RAS_PORT_1</b></a>, <a href="remacces_5u2a.htm"><b>RAS_PORT_STATISTICS</b></a>, <a href="remacces_5036.htm"><b>RasAdminGetUserAccountServer</b></a>, <a href="remacces_3zcd.htm"><b>RasAdminPortEnum</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
