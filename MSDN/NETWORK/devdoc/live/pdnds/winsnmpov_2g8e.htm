<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Opening and Closing a WinSNMP Session</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_opening_and_closing_a_winsnmp_session"></a>Opening and Closing a WinSNMP Session</h2>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
To open a session, a manager application calls the <a href="winsnmpfc_9tf2.htm"><b>SnmpOpen</b></a> function. If the function completes successfully, the Microsoft WinSNMP implementation opens a session, and the function returns a session identifier in the form of an <b>HSNMP_SESSION</b> handle. All WinSNMP functions that return handle variables include the session identifier as an input parameter. This enables the implementation to use the handle to efficiently manage resources at the session level. </p>
<p>
An application can have multiple sessions open at one time. Multiple sessions within an application can share handle variables. </p>
<p>
If the implementation cannot open a session because of resource limitations, it returns SNMPAPI_FAILURE when the application calls <a href="winsnmpfc_9tf2.htm"><b>SnmpOpen</b></a>. If the application then calls the <a href="winsnmpfc_7upe.htm"><b>SnmpGetLastError</b></a> function, it returns SNMPAPI_ALLOC_ERROR. </p>
<p>
A call to the <a href="winsnmpfc_1l0l.htm"><b>SnmpClose</b></a> function enables the implementation to free any remaining resources and to close the session. </p>
<p>
For additional information, see <a href="winsnmpov_5l6b.htm">Resource Handle Objects</a> and <a href="winsnmpov_556b.htm">WinSNMP Sessions</a>. </p>
<p>&nbsp;</p></body>
</HTML>
