<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NetLocalGroupAddMembers</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_netlocalgroupaddmembers"></a>NetLocalGroupAddMembers</h1>
<p>
The <b>NetLocalGroupAddMembers</b> function adds membership of one or more existing user accounts or global groups to an existing local group. The function does not change the membership status of users or global groups that are currently members of the local group.</p>
<h4>Security Requirements</h4>
<p>
Only members of the Administrators or Account Operators local group can successfully execute <b>NetLocalGroupAddMembers</b> on a remote server.</p>
<pre><code><b>NET_API_STATUS NetLocalGroupAddMembers(
  LPWSTR</b><i> servername</i><b>,      </b>
<b>  LPWSTR</b><i> LocalGroupName</i><b>,  </b>
<b>  DWORD</b><i> level</i><b>,            </b>
<b>  LPBYTE</b><i> buf</i><b>,             </b>
<b>  DWORD</b><i> membercount       </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>servername</i></dt>
<dd>
Pointer to a null-terminated Unicode string containing the name of the remote server on which the function is to execute. A NULL pointer or string specifies the local computer.</dd>
<dt>
<i>LocalGroupName</i></dt>
<dd>
Pointer to a null-terminated Unicode string containing the name of the local group to which the specified users or global groups will be added.</dd>
<dt>
<i>level</i></dt>
<dd>
Specifies one of the following values to set the level of information provided.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=21%>Value</th>
<th align=left width=79%>Meaning</th>
</tr>
<tr valign=top>
<td width=21%>0</td>
<td width=79%>The <i>buf</i> parameter points to an array of <a href="ntlmapi_0iuq.htm"><b>LOCALGROUP_MEMBERS_INFO_0</b></a> structures.</td>
</tr>
<tr valign=top>
<td width=21%>3</td>
<td width=79%>The <i>buf</i> parameter points to an array of <a href="ntlmapi_9b02.htm"><b>LOCALGROUP_MEMBERS_INFO_3</b></a> structures.</td>
</tr>
</table><br>

</dd>
<dt>
<i>buf</i></dt>
<dd>
Pointer to a buffer containing the data for the new members. </dd>
<dt>
<i>membercount</i></dt>
<dd>
Specifies the number of entries in the buffer pointed to by the <i>buf</i> parameter.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is NERR_Success.</p>
<p>
If the function fails, the return value is one of the following error codes. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=44%>Value</th>
<th align=left width=56%>Meaning</th>
</tr>
<tr valign=top>
<td width=44%>NERR_GroupNotFound </td>
<td width=56%>The local group specified by the <i>groupname</i> parameter does not exist.</td>
</tr>
<tr valign=top>
<td width=44%>ERROR_NO_SUCH_MEMBER </td>
<td width=56%>One or more of the new members do not exist. Therefore, no new members were added.</td>
</tr>
<tr valign=top>
<td width=44%>ERROR_MEMBER_IN_ALIAS </td>
<td width=56%>One or more of the members specified were already members of the local group. Therefore, no new members were added.</td>
</tr>
<tr valign=top>
<td width=44%>ERROR_INVALID_MEMBER </td>
<td width=56%>One or more of the members cannot be added because their account type is invalid. Therefore, no new members were added.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in lmaccess.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use netapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="ntlmapi_7o4f.htm">Networking (Net) Overview</a>, <a href="ntlmapi_0bn7.htm">Net Functions</a>, <a href="ntlmapi_05pg.htm"><b>NetLocalGroupAdd</b></a>, <a href="ntlmapi_63cj.htm"><b>NetLocalGroupDelMembers</b></a>, <a href="ntlmapi_9zw3.htm"><b>NetLocalGroupGetMembers</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
