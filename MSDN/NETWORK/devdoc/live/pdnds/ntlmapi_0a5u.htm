<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>USER_INFO_3</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_user_info_3_str"></a>USER_INFO_3</h1>
<p>
The level 3 data structure is valid only to Windows NT servers and not LAN Manager 2.<i>x</i> servers.</p>
<pre><code>typedef struct _USER_INFO_3 {
    LPWSTR    usri3_name;
    LPWSTR    usri3_password;
    DWORD     usri3_password_age;
    DWORD     usri3_priv;
    LPWSTR    usri3_home_dir;
    LPWSTR    usri3_comment;
    DWORD     usri3_flags;
    LPWSTR    usri3_script_path;
    DWORD     usri3_auth_flags;
    LPWSTR    usri3_full_name;
    LPWSTR    usri3_usr_comment;
    LPWSTR    usri3_parms;
    LPWSTR    usri3_workstations;
    DWORD     usri3_last_logon;
    DWORD     usri3_last_logoff;
    DWORD     usri3_acct_expires;
    DWORD     usri3_max_storage;
    DWORD     usri3_units_per_week;
    PBYTE     usri3_logon_hours;
    DWORD     usri3_bad_pw_count;
    DWORD     usri3_num_logons;
    LPWSTR    usri3_logon_server;
    DWORD     usri3_country_code;
    DWORD     usri3_code_page;
    DWORD     usri3_user_id;
    DWORD     usri3_primary_group_id;
    LPWSTR    usri3_profile;
    LPWSTR    usri3_home_dir_drive;
    DWORD     usri3_password_expired;
}USER_INFO_3, *PUSER_INFO_3, *LPUSER_INFO_3;
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>usri3_name</b></dt>
<dd>
Specifies the name of the user account. For <b>NetUserSetInfo</b>, this member is ignored. The number of characters in the name cannot exceed the value of UNLEN.</dd>
<dt>
<b>usri3_password</b></dt>
<dd>
The password for the user specified in the <b>usri3_name</b> member. The length cannot exceed PWLEN bytes. The <a href="ntlmapi_3kx9.htm"><b>NetUserEnum</b></a> and <a href="ntlmapi_8g6n.htm"><b>NetUserGetInfo</b></a> functions return a NULL pointer to maintain password security. By convention, Windows NT limits the length of passwords to LM20_PWLEN characters. This convention allows LAN Manager, Windows 3.<i>x</i>, Windows for Workgroups 3.<i>x</i>, Windows 95, and Windows 98 clients to access a Windows NT server using the account.</dd>
<dt>
<b>usri3_password_age</b></dt>
<dd>
Specifies the number of seconds elapsed since the <b>usri3_password</b> member was last changed. The <a href="ntlmapi_1944.htm"><b>NetUserAdd</b></a> and <a href="ntlmapi_0zfz.htm"><b>NetUserSetInfo</b></a> functions ignore this member.</dd>
<dt>
<b>usri3_priv</b></dt>
<dd>
One of three values to specify the level of privilege assigned the <b>usri3_name </b>member. The <a href="ntlmapi_1944.htm"><b>NetUserAdd</b></a> and <a href="ntlmapi_0zfz.htm"><b>NetUserSetInfo</b></a> functions ignore this member. This member can be one of the following values:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>USER_PRIV_GUEST</td>
<td width=52%>Guest </td>
</tr>
<tr valign=top>
<td width=48%>USER_PRIV_USER</td>
<td width=52%>User</td>
</tr>
<tr valign=top>
<td width=48%>USER_PRIV_ADMIN</td>
<td width=52%>Administrator</td>
</tr>
</table><br>

</dd>
<dt>
<b>usri3_home_dir</b></dt>
<dd>
Points to a Unicode string containing the path of the home directory of the user specified in <b>user_name</b>. The string can be null.</dd>
<dt>
<b>usri3_comment</b></dt>
<dd>
Points to a Unicode string that contains a comment. The string can be a null string, or it can have any number of characters before the terminating null character.</dd>
<dt>
<b>usri3_flags</b></dt>
<dd>
Contains values that determine several features. This member can be any of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>UF_SCRIPT</td>
<td width=52%>The logon script executed. This value must be set for LAN Manager 2.0 or Windows NT.</td>
</tr>
<tr valign=top>
<td width=48%>UF_ACCOUNTDISABLE</td>
<td width=52%>The user's account is disabled.</td>
</tr>
<tr valign=top>
<td width=48%>UF_HOMEDIR_REQUIRED</td>
<td width=52%>The home directory is required. This value is ignored in Windows NT.</td>
</tr>
<tr valign=top>
<td width=48%>UF_PASSWD_NOTREQD</td>
<td width=52%>No password is required.</td>
</tr>
<tr valign=top>
<td width=48%>UF_PASSWD_CANT_CHANGE </td>
<td width=52%>The user cannot change the password.</td>
</tr>
<tr valign=top>
<td width=48%>UF_LOCKOUT</td>
<td width=52%>The account is currently locked out. For <a href="ntlmapi_0zfz.htm"><b>NetUserSetInfo</b></a>, this value can be cleared to unlock a previously locked account. This value cannot be used to lock a previously unlocked account.</td>
</tr>
<tr valign=top>
<td width=48%>UF_DONT_EXPIRE_PASSWD</td>
<td width=52%><b>Windows NT:</b> Represents the password, which should never expire on the account. </td>
</tr>
</table><br>


<p>
The following values describe the account type. Only one value can be set. You cannot change the account type using the <a href="ntlmapi_0zfz.htm"><b>NetUserSetInfo</b></a> function.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=56%>Value</th>
<th align=left width=44%>Meaning</th>
</tr>
<tr valign=top>
<td width=56%>UF_NORMAL_ACCOUNT</td>
<td width=44%>This is a default account type that represents a typical user.</td>
</tr>
<tr valign=top>
<td width=56%>UF_TEMP_DUPLICATE_ACCOUNT</td>
<td width=44%>This is an account for users whose primary account is in another domain. This account provides user access to this domain, but not to any domain that trusts this domain. The User Manager refers to this account type as a <i>local</i> user account.</td>
</tr>
<tr valign=top>
<td width=56%>UF_WORKSTATION_TRUST_ACCOUNT</td>
<td width=44%>This is a computer account for a Windows NT Workstation or Windows NT Server that is a member of this domain.</td>
</tr>
<tr valign=top>
<td width=56%>UF_SERVER_TRUST_ACCOUNT</td>
<td width=44%>This is a computer account for a Windows NT Backup Domain Controller that is a member of this domain.</td>
</tr>
<tr valign=top>
<td width=56%>UF_INTERDOMAIN_TRUST_ACCOUNT</td>
<td width=44%>This is a <i>permit to trust</i> account for a Windows NT domain that <i>trusts</i> other domains.</td>
</tr>
</table><br>

</dd>
<dt>
<b>usri3_script_path</b></dt>
<dd>
Points to a Unicode string specifying the path of the user's logon script, .CMD, .EXE, or .BAT file. The string can be null.</dd>
<dt>
<b>usri3_auth_flags</b></dt>
<dd>
Specifies an unsigned long integer that contains values that specify the user's operator privileges. 
<p class=indent1>
<b>Windows NT:</b> For Windows NT servers, the <b>NetUserAdd</b> and <b>NetUserSetInfo</b> functions ignore this member.</p>

<p>
For <b>NetUserGetInfo</b> or <b>NetUserEnum</b>, the appropriate value is returned based on the local group membership. If the user is a member of <i>Print Operations</i>, AF_OP_PRINT is set. If the user is a member of <i>Server Operations</i>, AF_OP_SERVER is set. If the user is a member of the <i>Account Operations</i>, AF_OP_ACCOUNTS is set. AF_OP_COMM is never set.

<p>
The <a href="ntlmapi_1944.htm"><b>NetUserAdd</b></a> and <a href="ntlmapi_0zfz.htm"><b>NetUserSetInfo</b></a> functions ignore this member.

<p>
This member can be one of the following values:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>AF_OP_PRINT</td>
<td width=52%>The print operator privilege is enabled.</td>
</tr>
<tr valign=top>
<td width=48%>AF_OP_COMM</td>
<td width=52%>The communications operator privilege is enabled.</td>
</tr>
<tr valign=top>
<td width=48%>AF_OP_SERVER</td>
<td width=52%>The server operator privilege is enabled.</td>
</tr>
<tr valign=top>
<td width=48%>AF_OP_ACCOUNTS</td>
<td width=52%>The accounts operator privilege is enabled.</td>
</tr>
</table><br>

</dd>
<dt>
<b>usri3_full_name</b></dt>
<dd>
Points to a Unicode string that contains the full name of the user. This string can be a null string, or it can have any number of characters before the terminating null character.</dd>
<dt>
<b>usri3_usr_comment</b></dt>
<dd>
Points to a Unicode string that contains a user comment. This string can be a null string, or it can have any number of characters before the terminating null character. </dd>
<dt>
<b>usri3_parms</b></dt>
<dd>
Points to a Unicode string that is set aside for use by applications. This string can be a null string, or it can have any number of characters before the terminating null character. Microsoft products use this member to store user configuration information. Do not modify this information.</dd>
<dt>
<b>usri3_workstations</b></dt>
<dd>
Points to a Unicode string that contains the names of workstations from which the user can log on. As many as eight workstations can be specified; the names must be separated by commas (,). If you do not want to restrict the number of workstations, use a null string. To disable logons from all workstations to this account, set the UF_ACCOUNTDISABLE value in the <b>usri*_flags</b> member.</dd>
<dt>
<b>usri3_last_logon</b></dt>
<dd>
Specifies when the last logon occurred. This value is stored as the number of seconds elapsed since 00:00:00, January 1, 1970. This member is ignored in <a href="ntlmapi_1944.htm"><b>NetUserAdd</b></a> and <a href="ntlmapi_0zfz.htm"><b>NetUserSetInfo</b></a> calls. This member is maintained separately on each Backup Domain Controller (BDC) in the domain. To get an accurate value, each BDC in the domain must be queried, and the largest value is used. </dd>
<dt>
<b>usri3_last_logoff</b></dt>
<dd>
Specifies when the last logoff occurred. This value is stored as the number of seconds elapsed since 00:00:00, January 1, 1970. A value of zero means that the last logoff time is unknown. This member is maintained separately on each Backup Domain Controller (BDC) in the domain. To get an accurate value, each BDC in the domain must be queried, and the largest value is used.</dd>
<dt>
<b>usri3_acct_expires</b></dt>
<dd>
Specifies when the account will expire. This value is stored as the number of seconds elapsed since 00:00:00, January 1, 1970. A value of TIMEQ_FOREVER indicates that the account never expires.</dd>
<dt>
<b>usri3_max_storage</b></dt>
<dd>
Specifies the maximum amount of disk space the user can use. Use the value specified in USER_MAXSTORAGE_UNLIMITED to use all available disk space.</dd>
<dt>
<b>usri3_units_per_week</b></dt>
<dd>
Specifies the number of equal-length time units into which the week is divided in order to compute the length of the bit string in <b>usri3_logon_hours</b>. This value must be UNITS_PER_WEEK for LAN Manager 2.0. This element is ignored in <a href="ntlmapi_1944.htm"><b>NetUserAdd</b></a> and <a href="ntlmapi_0zfz.htm"><b>NetUserSetInfo</b></a> calls. For Windows NT services, the units must be one of the following: SAM_DAYS_PER_WEEK, SAM_HOURS_PER_WEEK, or SAM_MINUTES_PER_WEEK.</dd>
<dt>
<b>usri3_logon_hours</b></dt>
<dd>
Points to a 21-byte (168 bits) bit string that specifies the times during which the user can log on. Each bit represents a unique hour in the week. The first bit (bit 0, word 0) is Sunday, 0:00 to 0:59; the second bit (bit 1, word 0) is Sunday, 1:00 to 1:59; and so on. A null pointer in this member for <b>NetUserAdd</b> calls means there is no time restriction. A null pointer in this member for <b>NetUserSetInfo</b> calls means that no change is to be made.

<p>
<b>Note</b>&nbsp;&nbsp;Bit 0 in word 0 represents Sunday from 0:00 to 0:59 only if you are in the GMT time zone. In all other cases you must adjust the bits according to your time zone offset (for example, GMT minus 8 hours for PST).

</dd>
<dt>
<b>usri3_bad_pw_count</b></dt>
<dd>
Specifies the number of times the user tried to log on to the account using an incorrect password. A value of 0xFFFFFFFF indicates that the value is unknown. This member is ignored in <a href="ntlmapi_1944.htm"><b>NetUserAdd</b></a> and <a href="ntlmapi_0zfz.htm"><b>NetUserSetInfo</b></a> calls. This member is maintained separately on each Backup Domain Controller (BDC) in the domain. To get an accurate value, each BDC in the domain must be queried, and the largest value is used.</dd>
<dt>
<b>usri3_num_logons</b></dt>
<dd>
Counts the number of successful times the user tried to log on to this account. A value of 0xFFFFFFFF indicates that the value is unknown. This member is ignored in <b>NetUserAdd</b> and <b>NetUserSetInfo</b> calls. This member is maintained separately on each Backup Domain Controller (BDC) in the domain. To get an accurate value, each BDC in the domain must be queried, and the largest value is used.</dd>
<dt>
<b>usri3_logon_server</b></dt>
<dd>
Points to a Unicode string that contains the name of the server to which logon requests are sent. Servernames should be preceded by two backslashes (\\). A servername of an asterisk (\\*) indicates that the logon request can be handled by any logon server. A null string indicates that requests are sent to the domain controller. For Windows NT Servers, <a href="ntlmapi_8g6n.htm"><b>NetUserGetInfo</b></a> and <a href="ntlmapi_3kx9.htm"><b>NetUserEnum</b></a> return \\*. The <a href="ntlmapi_1944.htm"><b>NetUserAdd</b></a> and <a href="ntlmapi_0zfz.htm"><b>NetUserSetInfo</b></a> functions ignore this member.</dd>
<dt>
<b>usri3_country_code</b></dt>
<dd>
Specifies the country code for the user's language of choice.</dd>
<dt>
<b>usri3_code_page</b></dt>
<dd>
Specifies the code page for the user's language of choice.</dd>
<dt>
<b>usri3_user_id</b></dt>
<dd>
Specifies the relative ID (RID) of the user. The RID is determined by the SAM when the user is created. It uniquely defines this user account to SAM within the domain. The <a href="ntlmapi_1944.htm"><b>NetUserAdd</b></a> and <a href="ntlmapi_0zfz.htm"><b>NetUserSetInfo</b></a> functions ignore this member.</dd>
<dt>
<b>usri3_primary_group_id</b></dt>
<dd>
Specifies the relative ID (RID) of the Primary Global Group for this user. For <b>NetUserAdd</b>, this member must be DOMAIN_GROUP_RID_USERS (defined in NTSEAPI.H). For <b>NetUserSetInfo</b>, this member must be the RID of a global group in which the user is enrolled.</dd>
<dt>
<b>usri3_profile</b></dt>
<dd>
Specifies a path to the user's profile. This value can be a null string, a local absolute path, or a UNC path.</dd>
<dt>
<b>usri3_home_dir_drive</b></dt>
<dd>
Specifies the drive letter assigned to the user's home directory for logon purposes.</dd>
<dt>
<b>usri3_password_expired</b></dt>
<dd>
Determines whether the password of the user has expired. <b>NetUserGetInfo</b> and <b>NetUserEnum</b> return zero if the password has not expired (and nonzero if it has). For <b>NetUserAdd</b> or <b>NetUserSetInfo</b>, specify nonzero to indicate that the user must change password at next logon. For <b>NetUserSetInfo</b>, specify zero to turn off the message indicating that the user must change password at next logon . Note that you cannot specify zero to negate the expiration of a password that has already expired.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in lmaccess.h.</p>
<h4>See Also</h4>
<p>
<a href="ntlmapi_7o4f.htm">Networking (Net) Overview</a>, <a href="ntlmapi_8fub.htm">Net Structures</a>, <a href="ntlmapi_1944.htm"><b>NetUserAdd</b></a>, <a href="ntlmapi_3kx9.htm"><b>NetUserEnum</b></a>, <a href="ntlmapi_0zfz.htm"><b>NetUserSetInfo</b></a><b> </b></p>
<p>&nbsp;</p></body>
</HTML>
