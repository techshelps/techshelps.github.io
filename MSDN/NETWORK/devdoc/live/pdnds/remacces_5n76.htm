<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RasAdminGetIpAddressForUser</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_rasadmingetipaddressforuser"></a>RasAdminGetIpAddressForUser</h1>
<p>
The <b>RasAdminGetIpAddressForUser</b> function is an application-defined function that is exported by a third-party RAS server administration DLL. RAS calls this function to get an IP address for the dialed-in remote client.</p>
<pre><code><b>DWORD RasAdminGetIpAddressForUser(
  WCHAR</b><i> *lpszUserName</i><b>, </b>// pointer to the name of the remote user
<b>  WCHAR</b><i> *lpszPortName</i><b>, </b>// pointer to the name of the port
<b>  IPADDR</b><i> *pipAddress</i><b>,  </b>// pointer to the IP address
<b>  BOOL</b><i> *bNotifyRelease </i>// indicates whether RAS should call 
                       // RasAdminReleaseIpAddress
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszUserName</i></dt>
<dd>
Pointer to a null-terminated Unicode string that contains the name of the remote user for whom an IP address is required. </dd>
<dt>
<i>lpszPortName</i></dt>
<dd>
Pointer to a null-terminated Unicode string that contains the name of the port on which the user specified by <i>lpszUserName</i> is attempting to connect.</dd>
<dt>
<i>pipAddress</i></dt>
<dd>
Pointer to an <b>IPADDR</b> variable. On input, *<i>pipAddress</i> contains either zero or the IP address that the RAS server proposes to use for the dialed-in remote client. The function can set *<i>pipAddress</i> to a different IP address, or accept the passed-in IP address. If *<i>pipAddress</i> is zero on input, the function must provide an IP address; otherwise, the client will be unable to connect to this server using IP.</dd>
<dt>
<i>bNotifyRelease</i></dt>
<dd>
Pointer to a <b>BOOL</b> variable. Set this variable to TRUE if you want RAS to call your <a href="remacces_2fqr.htm"><b>RasAdminReleaseIpAddress</b></a> function when the user disconnects from this port; otherwise, set it to FALSE.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If <i>pipAddress</i> points to an IP address that the client can use to connect to this RAS server, the function should return NO_ERROR. This can occur if the function accepts the IP address that was passed by the RAS server, or if the function provides a different IP address.</p>
<p>
If <i>pipAddress</i> does not point to an IP address, the function should return a nonzero error code. This can occur if no IP address is available, or if the passed in IP address is unacceptable. In this case, the client will be unable to connect to this server using IP. There is no extended error information for this function; do not call <b>GetLastError</b>.</p>
<h4>Remarks</h4>
<p>
The setup program for a third-party RAS administration DLL must register the DLL with RAS by providing information under the following key in the registry: </p>
<pre><code><b>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\RAS\AdminDll</b>
 </code></pre>
<p>
To register the DLL, set the following values under this key.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=26%>Value Name</th>
<th align=left width=74%>Value Data</th>
</tr>
<tr valign=top>
<td width=26%>DisplayName</td>
<td width=74%>A REG_SZ string that contains the user-friendly display name of the DLL.</td>
</tr>
<tr valign=top>
<td width=26%>DLLPath</td>
<td width=74%>A REG_SZ string that contains the full path of the DLL.</td>
</tr>
</table><br>
<p>
For example, the registry entry for a RAS Administration DLL from a fictional company named Netwerks Corporation might be:</p>
<pre><code><b>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\RAS\AdminDll</b>
    DisplayName  :  REG_SZ  :  Netwerks RAS Admin DLL
    DLLPath      :  REG_SZ  :  C:\nt\system32\ntwkadm.dll
 </code></pre>
<p>
The setup program for a RAS Administration DLL should also provide remove/uninstall functionality. If a user removes the DLL, the setup program should delete the DLL's registry entries.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in rassapi.h.</p>
<h4>See Also</h4>
<p>
<a href="remacces_5aqt.htm">Remote Access Service Overview</a>, <a href="remacces_7sab.htm">RAS Server Administration Functions</a>, <a href="remacces_2fqr.htm"><b>RasAdminReleaseIpAddress</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
