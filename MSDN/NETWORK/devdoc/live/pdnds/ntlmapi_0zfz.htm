<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NetUserSetInfo</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_netusersetinfo"></a>NetUserSetInfo</h1>
<p>
The <b>NetUserSetInfo</b> function sets the parameters of a user account.</p>
<h4>Security Requirements</h4>
<p>
Only members of the Administrators or Account Operators local group can successfully execute <b>NetUserSetInfo </b>on a remote server or on a computer that has local security enabled. A user may call <b>NetUserSetInfo</b> to set certain information on his or her own account.</p>
<pre><code><b>NET_API_STATUS NetUserSetInfo(
  LPWSTR</b><i> servername</i><b>, </b>
<b>  LPWSTR</b><i> username</i><b>,   </b>
<b>  DWORD</b><i> level</i><b>,       </b>
<b>  LPBYTE</b><i> buf</i><b>,        </b>
<b>  LPDWORD</b><i> parm_err</i>   
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>servername</i></dt>
<dd>
Pointer to a Unicode string containing the name of the remote server on which the function is to execute. A NULL pointer or string specifies the local computer.</dd>
<dt>
<i>username</i></dt>
<dd>
Pointer to a Unicode string containing the name of the user account to set information.</dd>
<dt>
<i>level</i></dt>
<dd>
Specifies one of the following values to set the level of information provided.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=21%>Value</th>
<th align=left width=79%>Meaning</th>
</tr>
<tr valign=top>
<td width=21%>0</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_1i0i.htm"><b>USER_INFO_0</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_13ea.htm"><b>USER_INFO_1</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>2</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_0os2.htm"><b>USER_INFO_2</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>3</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_0a5u.htm"><b>USER_INFO_3</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>21</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_09v6.htm"><b>USER_INFO_21</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>22</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_9v8y.htm"><b>USER_INFO_22</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1003</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_51bm.htm"><b>USER_INFO_1003</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1005</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_4836.htm"><b>USER_INFO_1005</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1006</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_3tgy.htm"><b>USER_INFO_1006</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1007</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_3euq.htm"><b>USER_INFO_1007</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1008</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_308i.htm"><b>USER_INFO_1008</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1009</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_2lma.htm"><b>USER_INFO_1009</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1010</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_09o2.htm"><b>USER_INFO_1010</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1011</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_9v1u.htm"><b>USER_INFO_1011</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1012</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_9gfm.htm"><b>USER_INFO_1012</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1013</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_91te.htm"><b>USER_INFO_1013</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1014</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_8n76.htm"><b>USER_INFO_1014</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1017</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_7fci.htm"><b>USER_INFO_1017</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1020</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_4a5u.htm"><b>USER_INFO_1020</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1024</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_2noy.htm"><b>USER_INFO_1024</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1051</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_5x0y.htm"><b>USER_INFO_1051</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=21%>1053</td>
<td width=79%>The <i>buf</i> parameter points to a <a href="ntlmapi_53si.htm"><b>USER_INFO_1053</b></a> structure.</td>
</tr>
</table><br>

</dd>
<dt>
<i>buf</i></dt>
<dd>
Pointer to the buffer in which the data set with the <i>level</i> parameter is stored. The returned buffer should be deallocated using the <a href="ntlmapi_0lk5.htm"><b>NetApiBufferFree</b></a> function.<b> </b></dd>
<dt>
<i>parm_err</i></dt>
<dd>
Optional pointer to a <b>DWORD</b> that contains the index of the first parameter that causes ERROR_INVALID_PARAMETER. If NULL the parameter is not returned on error.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>NetUserSetInfo</b> function can be called to change a user's password only by users or applications having administrative privileges. However, the password can be changed by users or applications knowing the current password and calling <b>NetUserChangePassword</b>. When an administrator calls <b>NetUserSetInfo</b>, the only restriction applied is that the new password length must be consistent with system modals.</p>
<p>
Members of the Administrators local group can set any modifiable element. All users can set the <code>usri2_usr_comment</code>, u<code>sri2_parms</code>, and <code>usri2_country_code</code>, elements of the <code>user_info_2</code> data structure for their own accounts. To do this, the user must use the <code>ParmNum</code> parameter and cannot pass the whole structure.</p>
<p>
A member of the Account Operator's local group cannot set details for an Administrators class account, give an existing account Administrator privilege, or change the operator privilege of any account. If attempting to change the privilege level or disable the last account with Administrator privilege in the database, <b>NetUserSetInfo</b> fails and returns <code>NERR_LastAdmin</code>.</p>
<p>
You can call <b>NetUserSetInfo</b> with <a href="ntlmapi_13ea.htm"><b>USER_INFO_1</b></a> and specify a value using the <b>usri1_name</b> member. However, that value will be ignored. The correct way to specify the new name of the group is to call <b>NetUserSetInfo</b> with <a href="ntlmapi_1i0i.htm"><b>USER_INFO_0</b></a> and specify a value using the <b>usri0_name</b> member.</p>
<p>
The <b>NetUserSetInfo</b> function cannot be used to change the home directory for user accounts that were not created by the Net server.</p>
<h4>Return Values</h4>
<p>
If the function is successful, it returns NERR_SUCCESS.</p>
<p>
If the function fails, the return value is one of the following error codes.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=40%>Value</th>
<th align=left width=60%>Meaning</th>
</tr>
<tr valign=top>
<td width=40%>ERROR_ACCESS_DENIED</td>
<td width=60%>The user does not have access to the requested information.</td>
</tr>
<tr valign=top>
<td width=40%>NERR_InvalidComputer</td>
<td width=60%>The computer name is invalid.</td>
</tr>
<tr valign=top>
<td width=40%>NERR_NotPrimary</td>
<td width=60%>The operation is allowed only on the primary domain controller of the domain.</td>
</tr>
<tr valign=top>
<td width=40%>NERR_SpeGroupOp</td>
<td width=60%>The operation is not allowed on specified  special groups, which are user groups, admin groups, local groups, or guest groups.</td>
</tr>
<tr valign=top>
<td width=40%>NERR_LastAdmin</td>
<td width=60%>The operation is not allowed on the last administrative account.</td>
</tr>
<tr valign=top>
<td width=40%>NERR_BadPassword</td>
<td width=60%>The share name or password is invalid.</td>
</tr>
<tr valign=top>
<td width=40%>NERR_PasswordTooShort </td>
<td width=60%>The password is shorter than required.</td>
</tr>
<tr valign=top>
<td width=40%>NERR_UserNotFound</td>
<td width=60%>The user name could not be found.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in lmaccess.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use netapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="ntlmapi_7o4f.htm">Networking (Net) Overview</a>, <a href="ntlmapi_0bn7.htm">Net Functions</a>, <a href="ntlmapi_8g6n.htm"><b>NetUserGetInfo</b></a></p>
<p>&nbsp;</p></body>
</HTML>
