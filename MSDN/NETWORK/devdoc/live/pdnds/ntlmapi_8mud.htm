<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Looking Up a User's Full Name</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_looking_up_a_users_full_name"></a>Looking Up a User's Full Name</h2>
<p>
Computers running Windows NT can be organized into a domain, which is a collection of computers on a Windows NT Server network. The domain administrator maintains centralized user and group account information.</p>
<p>
To find the full name of a user, given the user name and domain name on Windows NT:
<ul>
<li>
Convert the user name and domain name to Unicode, if they are not already Unicode strings. </li>
<li>
Look up the computer name of the domain controller (DC) by calling <a href="ntlmapi_5grp.htm"><b>NetGetDCName</b></a>.</li>
<li>
Look up the user name on the DC computer by calling <a href="ntlmapi_8g6n.htm"><b>NetUserGetInfo</b></a>.</li>
<li>
Convert the full user name to ANSI, unless the program is expecting to work with Unicode strings.</li>
</ul>
<p>
The following sample code is a function that takes a user name and a domain name in the first two arguments and returns the user's full name in the third argument.</p>
<pre><code>#include &lt;windows.h&gt;
#include &lt;lm.h&gt;
#include &lt;stdio.h&gt;

BOOL GetFullName( char *UserName, char *Domain, char *dest )
{
    WCHAR wszUserName[256];          // Unicode user name
    WCHAR wszDomain[256]; 
    LPBYTE ComputerName;

    struct _SERVER_INFO_100 *si100;  // Server structure
    struct _USER_INFO_2 *ui;         // User structure

// Convert ANSI user name and domain to Unicode

    MultiByteToWideChar( CP_ACP, 0, UserName,
        strlen(UserName)+1, wszUserName,                          sizeof(wszUserName)/sizeof(wszUserName[0]) );
    MultiByteTOWideChar( CP_ACP, 0, Domain,
        strlen(Domain)+1, wszDomain, sizeof(wszDomain)/sizeof(wszDomain[0]) );

// Get the computer name of a DC for the domain.

    NetGetDCName( NULL, wszDomain, &amp;ComputerName );

// Look up the user on the DC.

    if( NetUserGetInfo( (LPWSTR) ComputerName,
        (LPWSTR) &amp;wszUserName, 2, (LPBYTE *) &amp;ui ) )
    {
        printf( "Error getting user information.\n" );
        return( FALSE );
    }

// Convert the Unicode full name to ANSI.

    WideCharToMultiByte( CP_ACP, 0, ui-&gt;usri2_full_name, -1,
        dest, 256, NULL, NULL );

    return (TRUE);
}
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
