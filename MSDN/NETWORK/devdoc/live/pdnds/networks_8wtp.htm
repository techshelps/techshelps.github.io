<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WNetOpenEnum</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_wnetopenenum"></a>WNetOpenEnum</h1>
<p>
The <b>WNetOpenEnum</b> function starts an enumeration of network resources or existing connections. </p>
<pre><code><b>DWORD WNetOpenEnum(
  DWORD</b><i> dwScope</i><b>,     </b>// scope of enumeration
<b>  DWORD</b><i> dwType</i><b>,      </b>// resource types to list
<b>  DWORD</b><i> dwUsage</i><b>,     </b>// resource usage to list
<b>  LPNETRESOURCE</b><i> lpNetResource</i><b>,</b>
<b>                     </b>// pointer to resource structure
<b>  LPHANDLE</b><i> lphEnum</i>   // pointer to enumeration handle buffer
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwScope</i></dt>
<dd>
Specifies the scope of the enumeration. This parameter can be one of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=43%>Value</th>
<th align=left width=57%>Meaning</th>
</tr>
<tr valign=top>
<td width=43%>RESOURCE_CONNECTED</td>
<td width=57%>All currently connected resources (the <i>dwUsage</i> parameter is ignored).</td>
</tr>
<tr valign=top>
<td width=43%>RESOURCE_CONTEXT</td>
<td width=57%>Only resources in the network context of the caller (used for a <i>Network Neighborhood</i> view). The <i>dwUsage</i> parameter is ignored.</td>
</tr>
<tr valign=top>
<td width=43%>RESOURCE_GLOBALNET</td>
<td width=57%>All resources on the network.</td>
</tr>
<tr valign=top>
<td width=43%>RESOURCE_REMEMBERED</td>
<td width=57%>All remembered (persistent) connections (the <i>dwUsage</i> parameter is ignored).</td>
</tr>
</table><br>

</dd>
<dt>
<i>dwType</i></dt>
<dd>
Specifies the resource types to enumerate. This parameter can be a combination of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=43%>Value</th>
<th align=left width=57%>Meaning</th>
</tr>
<tr valign=top>
<td width=43%>RESOURCETYPE_ANY</td>
<td width=57%>All resources (this value cannot be combined with RESOURCETYPE_DISK or RESOURCETYPE_PRINT).</td>
</tr>
<tr valign=top>
<td width=43%>RESOURCETYPE_DISK</td>
<td width=57%>All disk resources.</td>
</tr>
<tr valign=top>
<td width=43%>RESOURCETYPE_PRINT</td>
<td width=57%>All print resources.</td>
</tr>
</table><br>


<p>
If a network provider cannot distinguish between print and disk resources, it may enumerate all resources. 
</dd>
<dt>
<i>dwUsage</i></dt>
<dd>
Specifies the resource usage to be enumerated. This parameter can be a combination of the following values: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=53%>Value</th>
<th align=left width=47%>Meaning</th>
</tr>
<tr valign=top>
<td width=53%>0</td>
<td width=47%>All resources</td>
</tr>
<tr valign=top>
<td width=53%>RESOURCEUSAGE_CONNECTABLE</td>
<td width=47%>All connectable resources</td>
</tr>
<tr valign=top>
<td width=53%>RESOURCEUSAGE_CONTAINER</td>
<td width=47%>All container resources</td>
</tr>
</table><br>


<p>
This parameter is ignored if the <i>dwScope</i> parameter is not RESOURCE_GLOBALNET. 
</dd>
<dt>
<i>lpNetResource</i></dt>
<dd>
Points to a <a href="networks_0nle.htm"><b>NETRESOURCE</b></a> structure specifying the container to enumerate. 
<p>
If this parameter is NULL, the root of the network is assumed. Windows organizes a network as a hierarchy; the root is the topmost container in the network.

<p>
If this parameter is not NULL, it must point to a <b>NETRESOURCE</b> structure. This structure can be filled in by the application or be returned by a call to the <a href="networks_03ad.htm"><b>WNetEnumResource</b></a> function. The <b>NETRESOURCE</b> structure must specify a container resource; that is, the RESOURCEUSAGE_CONTAINER value must be specified in the <b>dwUsage</b> member. 

<p>
To enumerate all network resources, an application can begin the enumeration by calling <b>WNetOpenEnum</b> with <i>lpNetResource</i> set to NULL and then use the returned handle with <b>WNetEnumResource</b> to enumerate resources. If one of the resources in the <b>NETRESOURCE</b> array returned by the <b>WNetEnumResource</b> function is a container resource, <b>WNetOpenEnum</b> can be used to open the resource for further enumeration. 

<p>
If the <i>dwScope</i> parameter is not RESOURCE_GLOBALNET, this parameter must be NULL. 
</dd>
<dt>
<i>lphEnum</i></dt>
<dd>
Points to a variable filled with an enumeration handle that can be used in a subsequent call to <a href="networks_03ad.htm"><b>WNetEnumResource</b></a>. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is NO_ERROR. </p>
<p>
If the function fails, the return value is an error code. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. <b>GetLastError</b> may return one of the following error codes: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>Value</th>
<th align=left width=55%>Meaning</th>
</tr>
<tr valign=top>
<td width=45%>ERROR_NOT_CONTAINER</td>
<td width=55%>The <i>lpNetResource</i> parameter does not point to a container.</td>
</tr>
<tr valign=top>
<td width=45%>ERROR_INVALID_PARAMETER</td>
<td width=55%>Either the <i>dwScope</i> or <i>dwType</i> parameter is invalid, or there is a bad combination of parameters.</td>
</tr>
<tr valign=top>
<td width=45%>ERROR_NO_NETWORK</td>
<td width=55%>No network is present.</td>
</tr>
<tr valign=top>
<td width=45%>ERROR_EXTENDED_ERROR</td>
<td width=55%>A network-specific error occurred. To get a description of the error, use the <a href="networks_735e.htm"><b>WNetGetLastError</b></a> function.</td>
</tr>
</table><br>
<p>
The function returns error codes for compatibility with Windows version 3.1. For compatibility with Windows NT, the function also sets the error code value returned by <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_2.Click()><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
The exact interpretation of RESOURCE_CONTEXT in the <i>dwScope</i> parameter depends on the networks installed on the machine.</p>
<p>
The <b>WNetOpenEnum</b> function is used to begin enumeration of the resources in a single container. The following examples show the hierarchical structure of a Microsoft LAN Manager network and a Novell Netware network: </p>
<pre><code>LanMan (container, in this case the provider) 
  ACCOUNTING (container, in this case the domain) 
    \\ACCTSPAY (container, in this case the server) 
      PAYFILES (disk) 
      LASERJET (print) 
 
Netware (container, in this case the provider) 
  MARKETING (container, in this case the server) 
    SYS (disk, first one on any Netware server) 
    ANOTHERVOLUME (disk) 
    LASERJET (print) 
 </code></pre>
<p>
<b>Windows CE:</b> The <b>WNetOpenEnum</b> function is called by the network browser application to create lists of available resources on the network. </p>
<p>
Windows CE does not support the predefined value of RESOURCE_CONTEXT because a device cannot belong to a specific network context.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Use version 2.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winnetwk.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use mpr.lib.</p>
<h4>See Also</h4>
<p>
<a href="networks_7t5r.htm">Windows Networking (WNet) Overview</a>, <a href="networks_0u43.htm">Windows Networking Functions</a>, <a href="networks_0nle.htm"><b>NETRESOURCE</b></a>, <a href="networks_40fh.htm"><b>WNetCloseEnum</b></a>, <a href="networks_03ad.htm"><b>WNetEnumResource</b></a>, <a href="networks_735e.htm"><b>WNetGetLastError</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
