<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NDdeGetTrustedShare</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_nddegettrustedshare"></a>NDdeGetTrustedShare</h1>
<p>
The <b>NDdeGetTrustedShare</b> function is called to retrieve the options associated with a DDE share that is in the server user's list of trusted shares. </p>
<pre><code><b>UINT NDdeGetTrustedShare(
  LPTSTR</b><i> lpszServer</i><b>,        </b>// server to execute on
<b>  LPTSTR</b><i> lpszShareName</i><b>,     </b>// name of share to query
<b>  LPDWORD</b><i> lpdwTrustOptions</i><b>, </b>// trust options in effect
<b>  LPDWORD</b><i> lpdwShareModId0</i><b>,  </b>// first word of share modify identifier
<b>  LPDWORD</b><i> lpdwShareModId1</i>   // second word of share modify identifier
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszServer</i></dt>
<dd>
Address of the server name on which the DSDM resides. </dd>
<dt>
<i>lpszShareName</i></dt>
<dd>
Address of the share name whose trusted status is being queried. This parameter must not be NULL. </dd>
<dt>
<i>lpdwTrustOptions</i></dt>
<dd>
Address of a variable into which the TRUST_SHARE_OPTIONS will be stored. This parameter must not be NULL. </dd>
<dt>
<i>lpdwShareModId0</i></dt>
<dd>
Address of a variable into which the first word of the trusted share modify identifier will be stored. This parameter must not be NULL. </dd>
<dt>
<i>lpdwShareModId1</i></dt>
<dd>
Address of a variable into which the second word of the trusted share modify identifier will be stored. This parameter must not be NULL. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is NDDE_NO_ERROR.</p>
<p>
If the function fails, the return value is an error code, which can be translated into a text error message by calling <a href="netdde_4kpz.htm"><b>NDdeGetErrorString</b></a>. </p>
<h4>Remarks</h4>
<p>
The trusted share modify identifier reflects the version of the DDE share in the DSDM at the time the DDE share was initially granted trusted status. The trusted share modify identifier is primarily used to purge obsolete trusted shares. However, the user does not need to purge obsolete trusted shares. The network DDE agent purges obsolete shares on the user's behalf. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in nddeapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use nddeapi.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See also</h4>
<p>
<a href="netdde_4fmt.htm">Network Dynamic Data Exchange Overview</a>, <a href="netdde_304z.htm">Network DDE Functions</a>, <a href="netdde_97c5.htm"><b>NDdeSetTrustedShare</b></a></p>
<p>&nbsp;</p></body>
</HTML>
