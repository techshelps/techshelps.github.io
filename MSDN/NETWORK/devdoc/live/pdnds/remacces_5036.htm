<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RasAdminGetUserAccountServer</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_rasadmingetuseraccountserver"></a>RasAdminGetUserAccountServer</h1>
<p>
The <b>RasAdminGetUserAccountServer</b> function retrieves the name of the server that has the user account database. You can use the returned server name in the <a href="remacces_4qr3.htm"><b>RasAdminUserGetInfo</b></a> and <a href="remacces_7a0f.htm"><b>RasAdminUserSetInfo</b></a> functions to get or set information about a specified user.</p>
<pre><code><b>DWORD RasAdminGetUserAccountServer(
  const WCHAR</b><i> *lpszDomain</i><b>,  </b>// pointer to the name of the Windows NT 
                            // domain
<b>  const WCHAR</b><i> *lpszServer</i><b>,  </b>// pointer to the name of the RAS server
<b>  LPWSTR</b><i> lpszUserAccountServer  </i>// receives the name of the user 
                                // account server
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszDomain</i></dt>
<dd>
Pointer to a null-terminated Unicode string that contains the name of the domain to which the RAS server belongs. This parameter can be NULL if you are running your RAS administration application on a Windows NT Workstation or Server that is not participating in a Windows NT domain. If this parameter is NULL, the <i>lpszServer</i> parameter must be non-NULL.</dd>
<dt>
<i>lpszServer</i></dt>
<dd>
Pointer to a null-terminated Unicode string that contains the name of the Windows NT RAS server. Specify the name with leading "\\" characters, in the form: \\<i>servername</i>. This parameter can be NULL if the <i>lpszDomain</i> parameter is not NULL.</dd>
<dt>
<i>lpszUserAccountServer</i></dt>
<dd>
Pointer to a buffer that receives a null-terminated Unicode string containing the name of the primary domain controller (PDC) Windows NT server that has the user account database. The buffer should be big enough to hold the server name (UNCLEN +1). The function prefixes the returned server name with leading "\\" characters, in the form: \\<i>servername</i>. If the server name specified by <i>lpszServer</i> is a stand-alone Windows NT Server or Workstation (that is, the server or workstation does not participate in a Windows NT domain), then the server name itself is returned in the <i>lpszUserAccountServer</i> buffer. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is ERROR_SUCCESS.</p>
<p>
If the function fails, the return value can be the following error code. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>ERROR_INVALID_PARAMETER</td>
<td width=52%>Both <i>lpszDomain</i> and <i>lpszServer</i> are NULL.</td>
</tr>
</table><br>
<p>
There is no extended error information for this function; do not call <b>GetLastError</b>.</p>
<h4>Remarks</h4>
<p>
The <i>lpszDomain</i> parameter should specify a valid Windows NT domain name. If you are running your RAS administration application on a Windows NT Workstation or Server that is not participating in a Windows NT domain (for example, the workstation or server is in its own work group), then set <i>lpszDomain</i> to NULL. In this case, you must specify your server name in the <i>lpszServer</i> parameter. Be sure to prefix the server name with the "\\" characters. To get the server name, call the <b>GetComputerName</b> function.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 4.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in rassapi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use rassapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="remacces_5aqt.htm">Remote Access Service Overview</a>, <a href="remacces_7sab.htm">RAS Server Administration Functions</a>, <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getcomputername">
</object><a href=JavaScript:alink_1.Click()><b>GetComputerName</b></a>, <a href="remacces_4qr3.htm"><b>RasAdminUserGetInfo</b></a>, <a href="remacces_7a0f.htm"><b>RasAdminUserSetInfo</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
