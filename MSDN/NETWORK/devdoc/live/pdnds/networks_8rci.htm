<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CONNECTDLGSTRUCT</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_connectdlgstruct_str"></a>CONNECTDLGSTRUCT</h1>
<p>
The <b>CONNECTDLGSTRUCT</b> data structure is used in the <a href="networks_9y0h.htm"><b>WNetConnectionDialog1</b></a> function to specify the browsing dialog box parameters.</p>
<pre><code>typedef struct {
    DWORD cbStructure;
    HWND hwndOwner;
    LPNETRESOURCE lpConnRes;
    DWORD dwFlags;
    DWORD dwDevNum;
} CONNECTDLGSTRUCT, *LPCONNECTDLGSTRUCT;
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>cbStructure</b></dt>
<dd>
Specifies, in bytes, the size of this structure.</dd>
<dt>
<b>hwndOwner</b></dt>
<dd>
Specifies the handle of the owning window.</dd>
<dt>
<b>lpConnRes</b></dt>
<dd>
If <b>lpRemoteName</b> is specified, this member will be entered into the path field of the dialog box. All other members must be set to NULL except <b>dwType</b><i> </i>which specifies the type of resources of interest, and must be one of RESOURCETYPE_DISK. <br>
<b>Windows NT: </b>Windows NT does not support the RESOURCETYPE_PRINT flag for browsing and connecting to print resources. </dd>
<dt>
<b>dwFlags</b></dt>
<dd>
Specifies variations in the dialog display. To simulate <a href="networks_18yv.htm"><b>WNetConnectionDialog</b></a>, set this member to CONNDLG_USE_MRU. Currently, this may be a combination of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=39%>Value</th>
<th align=left width=61%>Meaning</th>
</tr>
<tr valign=top>
<td width=39%>SidTypeUser</td>
<td width=61%>The account is a user account.</td>
</tr>
<tr valign=top>
<td width=39%>CONNDLG_RO_PATH</td>
<td width=61%>Instead of allowing the user to type in a path, have a read-only path already inserted. This flag should be set only if <b>lpRemoteName</b> is not NULL (or an empty string), and CONNDLG_USE_MRU is not set. </td>
</tr>
<tr valign=top>
<td width=39%>CONNDLG_CONN_POINT</td>
<td width=61%>Internal flag. Do not use.<br>
<b>Windows NT: </b>Windows NT does not support the CONNDLG_CONN_POINT flag.</td>
</tr>
<tr valign=top>
<td width=39%>CONNDLG_USE_MRU   </td>
<td width=61%>Enter the most recently used paths into the combo box.</td>
</tr>
<tr valign=top>
<td width=39%>CONNDLG_HIDE_BOX</td>
<td width=61%>Show the check box allowing the user to restore the connection at logon. </td>
</tr>
<tr valign=top>
<td width=39%>CONNDLG_PERSIST</td>
<td width=61%>Set if the connection is to be restored at logon.</td>
</tr>
<tr valign=top>
<td width=39%>CONNDLG_NOT_PERSIST</td>
<td width=61%>Set if the connection is not to be restored at logon.</td>
</tr>
</table><br>

</dd>
<dt>
<b>dwDevNum</b></dt>
<dd>
If the call is successful, this member returns the number of the device connected to. The value is 1 for A:, 2 for B:, 3 for C:, and so on. If the user made a deviceless connection, the value is 0xFFFFFFFF.
</dd>
</dl>
<h4>Return Values</h4>
<p>
The function returns WN_SUCCESS if the call is successful and brings up the dialog. Typically this function will return an error only if the dialog box could not be displayed because errors that occur thereafter are reported to the user directly.  If the call is successful, <b>dwDevNum</b> contains the number of the device connected to. If the user cancels the dialog box, the function returns 0xFFFFFFFF. </p>
<p>
Error codes include one of the following.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=31%>Value</th>
<th align=left width=69%>Meaning</th>
</tr>
<tr valign=top>
<td width=31%>WN_BAD_VALUE</td>
<td width=69%>One of two meanings:<ol>
<li>
CONNDLG_RO_PATH is set and either CONNDLG_USE_MRU is set or <b>lpRemoteName</b> does not point to a remote name.</li>
<li>
Both CONNDLG_PERSIST and CONNDLG_NOT_PERSIST are set.</li>
</ol>
</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
If neither CONNDLG_RO_PATH nor CONNDLG_USE_MRU is set in <b>dwFlags</b>, then the request defaults to CONNDLG_RO_PATH if <b>lpRemoteName</b> does not specify a remote path to CONNDLG_USE_MRU. Otherwise, CONNDLG_PERSIST and CONNDLG_NOT_PERSIST cannot both be set. If neither is set, then the dialog defaults to the last option that was selected on this dialog for the particular type of device being connected.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Use version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Use Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Use version 2.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winnetwk.h.</p>
<h4>See Also</h4>
<p>
<a href="networks_7t5r.htm">Windows Networking (WNet) Overview</a>, <a href="networks_19v7.htm">Windows Networking Structures</a>, <a href="networks_9y0h.htm"><b>WNetConnectionDialog1</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
