<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ABOUT.C</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context5262"></a>ABOUT.C</h2>
<pre><code>// THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT WARRANTY OF <br>// ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO <br>// THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A <br>// PARTICULAR PURPOSE. <br>// <br>// Copyright 1993 - 1998 Microsoft Corporation.  All Rights Reserved. <br>// <br>//  MODULE:   about.c <br>// <br>//  PURPOSE:   Displays the "About" dialog box <br>// <br>//  FUNCTIONS: <br>//    CmdAbout        - Displays the "About" dialog box <br>//    About           - Processes messages for "About" dialog box. <br>//    MsgAboutInit    - To initialize the about box with version info <br>//                      from resources. <br>//    MsgAboutCommand - Process WM_COMMAND message sent to the about box. <br>//    CmdAboutDone    - Free the about box and related data. <br>// <br>//  COMMENTS: <br>// <br>// <br> <br>#include &lt;windows.h&gt;            // required for all Windows applications <br>#include &lt;windowsx.h&gt; <br>#include "globals.h"            // prototypes specific to this application <br> <br>LRESULT CALLBACK About(HWND, UINT, WPARAM, LPARAM); <br>LRESULT MsgAboutInit(HWND, UINT, WPARAM, LPARAM); <br>LRESULT MsgAboutCommand(HWND, UINT, WPARAM, LPARAM); <br>LRESULT CmdAboutDone(HWND, WORD, WORD, HWND); <br> <br>// About dialog message table definition. <br>MSD rgmsdAbout[] = <br>{ <br>    {WM_COMMAND,    MsgAboutCommand}, <br>    {WM_INITDIALOG, MsgAboutInit} <br>}; <br> <br>MSDI msdiAbout = <br>{ <br>    sizeof(rgmsdAbout) / sizeof(MSD), <br>    rgmsdAbout, <br>    edwpNone <br>}; <br> <br>// About dialog command table definition. <br>CMD rgcmdAbout[] = <br>{ <br>    {IDOK,     CmdAboutDone}, <br>    {IDCANCEL, CmdAboutDone} <br>}; <br> <br>CMDI cmdiAbout = <br>{ <br>    sizeof(rgcmdAbout) / sizeof(CMD), <br>    rgcmdAbout, <br>    edwpNone <br>}; <br> <br>// Module specific "globals"  Used when a variable needs to be <br>// accessed in more than on handler function. <br> <br>HFONT hFontCopyright; <br> <br>// <br>//  FUNCTION: CmdAbout(HWND, WORD, WORD, HWND) <br>// <br>//  PURPOSE: Displays the "About" dialog box <br>// <br>//  PARAMETERS: <br>//    hwnd      - Window handle <br>//    wCommand  - IDM_ABOUT (unused) <br>//    wNotify   - Notification number (unused) <br>//    hwndCtrl  - NULL (unused) <br>// <br>//  RETURN VALUE: <br>// <br>//    Always returns 0 - Message handled <br>// <br>//  COMMENTS: <br>//    To process the IDM_ABOUT message, call DialogBox() to display the <br>//    about dialog box. <br> <br>LRESULT CmdAbout(HWND hwnd, WORD wCommand, WORD wNotify, HWND hwndCtrl) <br>{ <br>    DialogBox(hInst, "AboutBox", hwnd, (DLGPROC)About); <br>    return 0; <br>} <br> <br> <br>// <br>//  FUNCTION: About(HWND, UINT, WPARAM, LPARAM) <br>// <br>//  PURPOSE:  Processes messages for "About" dialog box. <br>// <br>//  PARAMETERS: <br>//    hdlg - window handle of the dialog box <br>//    wMessage - type of message <br>//    wparam - message-specific information <br>//    lparam - message-specific information <br>// <br>//  RETURN VALUE: <br>//    TRUE - message handled <br>//    FALSE - message not handled <br>// <br>//  COMMENTS: <br>// <br>//     Display version information from the version section of the <br>//     application resource. <br>// <br>//     Wait for user to click on "Ok" button, then close the dialog box. <br>// <br> <br>LRESULT CALLBACK About(HWND hdlg, UINT uMessage, WPARAM wparam, LPARAM lparam) <br>{ <br>    return DispMessage(&amp;msdiAbout, hdlg, uMessage, wparam, lparam); <br>} <br> <br> <br>// <br>//  FUNCTION: MsgAboutInit(HWND, UINT, WPARAM, LPARAM) <br>// <br>//  PURPOSE: To initialize the about box with version info from resources. <br>// <br>//  PARAMETERS: <br>//    hwnd - The window handing the message. <br>//    uMessage - The message number. (unused). <br>//    wparam - Message specific data (unused). <br>//    lparam - Message specific data (unused). <br>// <br>//  RETURN VALUE: <br>//    Always returns 0 - message handled. <br>// <br>//  COMMENTS: <br>//    Uses the version apis to retrieve version information for <br>//    each of the static text boxes in the about box. <br>// <br> <br>LRESULT MsgAboutInit(HWND hdlg, UINT uMessage, WPARAM wparam, LPARAM lparam) <br>{ <br>    #define POINTSIZE 8 <br> <br>    char  szFullPath[256]; <br>    DWORD dwVerHnd; <br>    DWORD dwVerInfoSize; <br>    HDC   hDC; <br>    int   iLogPixelsY, iPointSize; <br> <br>    // Center the dialog over the application window <br>    CenterWindow(hdlg, GetWindow(hdlg, GW_OWNER)); <br> <br>    // Set the copyright font to something smaller than default <br>    hDC = GetDC(hdlg); <br>    iLogPixelsY = GetDeviceCaps(hDC, LOGPIXELSY); <br>    ReleaseDC(hdlg, hDC); <br>    iPointSize = MulDiv(iLogPixelsY, POINTSIZE, 72); <br>    iPointSize *= -1; <br> <br>    hFontCopyright = CreateFont(iPointSize, <br>                                0, 0, 0, <br>                                FW_BOLD, <br>                                0, 0, 0, 0, <br>                                0, 0, 0, 0, <br>                                "Arial"); <br> <br>    SendDlgItemMessage(hdlg, <br>                       IDD_VERLAST, <br>                       WM_SETFONT, <br>                       (WPARAM)hFontCopyright, <br>                       0L); <br> <br>    // Get version information from the application <br>    GetModuleFileName(hInst, szFullPath, sizeof(szFullPath)); <br>    dwVerInfoSize = GetFileVersionInfoSize(szFullPath, &amp;dwVerHnd); <br>    if (dwVerInfoSize) <br>    { <br>        // If we were able to get the information, process it: <br>        HANDLE  hMem; <br>        LPVOID  lpvMem; <br>        char    szGetName[256]; <br>        int     cchRoot; <br>        int     i; <br> <br>        hMem = GlobalAlloc(GMEM_MOVEABLE, dwVerInfoSize); <br>        lpvMem = GlobalLock(hMem); <br>        GetFileVersionInfo(szFullPath, dwVerHnd, dwVerInfoSize, lpvMem); <br> <br>        lstrcpy(szGetName, GetStringRes(IDS_LANGVERINFO)); <br> <br>        cchRoot = lstrlen(szGetName); <br> <br>        // Walk through the dialog items that we want to replace: <br>        for (i = IDD_VERFIRST; i &lt;= IDD_VERLAST; i++) <br>        { <br>            BOOL  fRet; <br>            UINT  cchVer = 0; <br>            LPSTR lszVer = NULL; <br>            char  szResult[256]; <br> <br>            GetDlgItemText(hdlg, i, szResult, sizeof(szResult)); <br>            lstrcpy(&amp;szGetName[cchRoot], szResult); <br>            fRet = VerQueryValue(lpvMem, szGetName, &amp;lszVer, &amp;cchVer); <br> <br>            if (fRet &amp;&amp; cchVer &amp;&amp; lszVer) <br>            { <br>                // Replace dialog item text with version info <br>                lstrcpy(szResult, lszVer); <br>                SetDlgItemText(hdlg, i, szResult); <br>            } <br>        } <br>        GlobalUnlock(hMem); <br>        GlobalFree(hMem); <br>    } <br>    return TRUE; <br>} <br> <br>// <br>//  FUNCTION: MsgAboutCommand(HWND, UINT, WPARAM, LPARAM) <br>// <br>//  PURPOSE: Process WM_COMMAND message sent to the about box. <br>// <br>//  PARAMETERS: <br>//    hwnd - The window handing the message. <br>//    uMessage - The message number. (unused). <br>//    wparam - Message specific data (unused). <br>//    lparam - Message specific data (unused). <br>// <br>//  RETURN VALUE: <br>//    Always returns 0 - message handled. <br>// <br>//  COMMENTS: <br>//    Uses this DipsCommand function defined in wndproc.c combined <br>//    with the cmdiAbout structure defined in this file to handle <br>//    the command messages for the about dialog box. <br>// <br> <br>LRESULT MsgAboutCommand(HWND   hwnd, <br>                        UINT   uMessage, <br>                        WPARAM wparam, <br>                        LPARAM lparam) <br>{ <br>    return DispCommand(&amp;cmdiAbout, hwnd, wparam, lparam); <br>} <br> <br>// <br>//  FUNCTION: CmdAboutDone(HWND, WORD, HWND) <br>// <br>//  PURPOSE: Free the about box and related data. <br>// <br>//  PARAMETERS: <br>//    hwnd - The window handling the command. <br>//    wCommand - The command to be handled (unused). <br>//    wNotify   - Notification number (unused) <br>//    hwndCtrl - NULL (unused). <br>// <br>//  RETURN VALUE: <br>//    Always returns TRUE. <br>// <br>//  COMMENTS: <br>//    Calls EndDialog to finish the dialog session. <br>// <br> <br>LRESULT CmdAboutDone(HWND hdlg, WORD wCommand, WORD wNotify, HWND hwndCtrl) <br>{ <br>    if (hFontCopyright) <br>       DeleteObject(hFontCopyright); <br> <br>    EndDialog(hdlg, TRUE);          // Exit the dialog <br>    return TRUE; <br>} <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
