<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>REPORT.ASP</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context5142"></a>REPORT.ASP</h2>
<pre><code>&lt;%@ LANGUAGE="VBSCRIPT" %&gt; <br> <br>&lt;HTML&gt; <br>&lt;HEAD&gt; <br> <br>&lt;META NAME="GENERATOR" Content="Microsoft Visual InterDev 1.0"&gt; <br>&lt;META HTTP-EQUIV="Content-Type" content="text/html; charset=iso-8859-1"&gt; <br> <br>&lt;TITLE&gt;Microsoft OLE DB Provider for AS/400 and VSAM - Active Server Pages Sample&lt;/TITLE&gt; <br> <br>&lt;/HEAD&gt; <br> <br>&lt;BODY BGCOLOR=#FFFFFF&gt;  <br> <br>&lt;H2&gt;Simple Example Retrieving All Results into an Array&lt;/H2&gt; <br> <br> <br>&lt;% <br>'This sample is based on host tables similar to those in the Microsoft SQL Server Pubs sample database <br> <br>On Error Resume Next <br> <br>Set Conn = Nothing <br> <br>Set Conn = Server.CreateObject("ADODB.Connection") <br> <br>Conn.Open "provider=SNAOLEDB;User ID=USERID;Password=PASSWORD;Data source=DATASOURCE" <br> <br>    Set RS = Nothing <br> <br>Set RS = Server.CreateObject("ADODB.Recordset") <br> <br>RS.Open "exec open PUBS/AUTHORS", Conn, 2, 3, 1 <br> <br>' Session.ScriptTimeOut = nMinutes <br> <br>%&gt; <br> <br>Here are the results from the query:&lt;BR&gt;&lt;I&gt;&lt;B&gt;  &lt;%=sql%&gt;&lt;/I&gt;&lt;/B&gt; <br> <br>&lt;P&gt; <br>&lt;P&gt; <br> <br>&lt;TABLE BORDER=1&gt; <br> <br>&lt;TR&gt; <br> <br>&lt;% For i = 0 to RS.Fields.Count - 1 %&gt; <br> <br>&lt;TD&gt;&lt;B&gt;&lt;% = RS(i).Name %&gt;&lt;/B&gt;&lt;/TD&gt; <br> <br>&lt;% Next %&gt; <br> <br>&lt;/TR&gt; <br> <br>&lt;% <br>' Put up to 10 rows in a 2d variant array <br>v=RS.GetRows(10)  <br> <br>RS.close <br> <br>set RS = nothing <br>%&gt; <br> <br>&lt;P&gt; <br> <br>&lt;% For row = 0 to UBound(v,2)  ' iterate through the rows in the variant array %&gt; <br> <br>&lt;TR&gt; <br> <br>&lt;% For col = 0 to UBound(v,1) %&gt;   <br> <br>&lt;TD&gt;&lt;% = v(col,row) %&gt; &lt;/TD&gt; <br> <br>&lt;% Next %&gt; <br> <br>&lt;/TR&gt; <br> <br>&lt;% Next %&gt; <br> <br>&lt;/TABLE&gt; <br> <br>&lt;BR&gt; <br> <br>&lt;BR&gt; <br> <br>&lt;/BODY&gt; <br>&lt;/HTML&gt; <br> <br>&lt;!-- <br>' Last updated on 11/18/97. <br>' Copyright 1997 Microsoft Corporation <br>--&gt; <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
