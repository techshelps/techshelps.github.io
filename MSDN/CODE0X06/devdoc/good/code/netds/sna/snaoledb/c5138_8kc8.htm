<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>README.TXT</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context5138"></a>README.TXT</h2>
<pre><code>PRODUCT NAME: Microsoft (R) SNA Server <br>FEATURE NAME: Microsoft(R) OLE DB Provider for AS/400 and VSAM <br>VERSION NUMBER: 4.0  <br> <br> <br>This document contains answers to the most commonly asked  <br>questions about using and building the sample applications <br>included with the Microsoft OLE DB Provider for AS/400 and <br>VSAM. Please take a few moments to read this document. <br> <br>*********************** <br>*IMPORTANT INFORMATION* <br>*********************** <br> <br>The \SAMPLES directory includes subdirectories <br>containing the following utilities and information: <br> <br> <br>The file named SAMPLE.HCD contains examples of the host <br>column definitions required to access host VSAM files. This file <br>is documented in the Microsoft SNA Server SDK, in the section <br>titled Microsoft OLE DB Provider for AS/400 and VSAM.  <br> <br> <br>OLE DB Sample <br>The OLEDB directory contains a modified Microsoft OLE DB Query  <br>Sample application. This application allows you to connect  <br>to the Microsoft OLE DB Provider for AS/400 and VSAM, open a table window, <br>type the host file name, return a rowset and browse the contents. <br>You can navigate the table, using seek and set range on  <br>indexed files. <br> <br>To open a rowset, type the following command in the comamnd window: <br>exec open library/file <br>You can use "/" or "." depending on whether you are accessing a host  <br>mainframe or AS/400 file.  <br> <br>This sample is written to access bookmarkable file types only. You will <br>not be able to access mainframe SAM, ESDS, PDS/PDSE because these data <br>set types do not support bookmarks. <br> <br>You may not be able to build this sample application. The SNA Server <br>CD-ROM does not include a copy of the OLE DB SDK version 1.5. If you  <br>do not have the OLE DB SDK version 1.5 installed, then you need to  <br>include or copy the following files, from the SDK\SAMPLES\OLEDB <br>directory on the SNA Server CD-ROM, into your project.  <br> <br>SDK\SAMPLES\OLEDB\INCLUDE <br>adoid.h <br>adoint.h <br>msdadc.h <br>msdaguid.h <br>msdasql.h <br>oledb.h <br>oledberr.h <br>transact.h <br> <br> <br>ADO Visual Basic Sample <br>The ADO_VB directory contains a Microsoft OLE DB Provider for <br>AS/400 and VSAM ADO Visual Basic version 5.0 sample application.  <br>This application allows you to open a connection through the  <br>Microsoft OLE DB Provider for AS/400 and VSAM, open a recordset  <br>and browse the records of a host file. This sample is built  <br>with ActiveX Data Objects version 1.5. Before building with  <br>Visual Basic sample, be sure to include the Microsoft ActiveX  <br>Data Objects 1.5 Library in your project. You can do this from  <br>inside the VB IDE by selecting References on the Project menu.  <br> <br>The sample application can be built with Microsoft Visual Basic <br>version 5.0.  <br> <br> <br>ADO VBScript Sample <br>The ADO_VBS directory contains a Microsoft OLE DB Provider for <br>AS/400 and VSAM ADO VBScript sample web client application.  <br>This web client application allows you to open a connection  <br>through the Microsoft OLE DB Provider for AS/400 and VSAM, <br>open a recordset and browse the records of a host file.  <br> <br> <br>Active Server Pages Sample <br>The ASP directory contains two Microsoft OLE DB Provider for <br>AS/400 and VSAM Active Server Pages sample web server applications.  <br>These applications require Microsoft Internet Information Server  <br>version 3.0 or higher with Active Server Pages installed.  <br> <br>1. REPORT.ASP will return and display the first ten (10) records in a host file  <br>to a client browser in a table view.  <br> <br>2. OLEDBDDM.ASP and GLOBAL.ASA combine to display columns of a host file <br>in a a form view.  <br> <br>You will need to edit the host table names in order to use these samples <br>in your environment.  <br> <br> <br>Off-Line Demo Link Service <br>The following are the steps necessary to test drive the OLE DB Provider for  <br>AS/400 and VSAM feature of SNA Server 4.0 using the demo host link services.  <br>To demonstrate the OLE DB Provider for AS/400 and VSAM with Visual Basic, all you  <br>need is the sample VB program that is installed with the provider. <br> <br>1. From the Microsoft SNA Server Manager, add a new Link Service, choosing the <br>"SNA OLE DB Demo" script file.  <br>2. From the Microsoft SNA Server Manager, select the AS/400 Wizard from the Tools menu. <br>Configure a new connection (using the above Link Service) as follows: <br>- Network Name: APPN <br>- Control Point Name: DDMDEMO <br>- SDLC settings: (leave as default) <br>- Connection Name: DDMDEMO <br>- Remote APPC LU Alias: DDMDEMO <br>- Local APPC LU Alias: LOCAL <br>3. From the Microsoft SNA Server Manager, start the SNA Server Service. The <br>newly-created "DDMDEMO" connection should go to "On Demand" status. <br>4. From the SNA OLE DB Management console, create a new Data Source as follows: <br>- Data Source Type: AS/400 <br>- Remote LU Alias: DDMDEMO <br>- Local LU Alias: LOCAL <br>- APPC Mode: QPCSUPP <br>- RDB Name: DDMDEMO <br>- Default Library: PUBS <br>- Host CCSID: 37 <br>- Host Column Description: (leave as default "unselected") <br>5. From the Run line of the Start menu, type "ado_vb" and click OK to load the ADO VB consumer sample application.  <br>- Click the Connect button to use the ADO Connection.Open method. This will establish an APPC session between the OLE DB Provider for AS/400 and VSAM computer and the demo AS/400. <br>- Enter "USERID" and "password", then click OK to log onto the demo host.  <br>- Click the Open button to use the ADO Recordset.Open method.  <br>- In the open dialog, enter "pubs/authors", then click OK  to continue. The recordset is composed of the records in the "authors" AS/400 physical data file in the AS/400 library "pubs". The sample AS/400 data is based on that in the authors table from the Microsoft SQL Server pubs sample database.  <br>- Click the Next button to view the next record in the recordset using the ADO Recordset.MoveNext method.  <br>- Click the Close button to close the host file using the ADO Recordset.Close method. <br>- Click the Disconnect button to end the APPC session using the ADO Connection.Close method. <br>- Exit the ADO consumer sample application. <br> <br> <br>Last updated on 11/21/97. (C) Microsoft Corporation <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
