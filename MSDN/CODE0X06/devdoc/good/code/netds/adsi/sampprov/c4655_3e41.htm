<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CPROPS.H</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context4681"></a>CPROPS.H</h2>
<pre><code>/*++ <br> <br>Copyright (c) 1996 Microsoft Corporation <br> <br>Module Name: <br> <br>    CProps.h <br> <br>Abstract: <br> <br>    Property Cache Object <br>     <br>Author: <br> <br>Environment: <br> <br>    User mode <br> <br>Revision History : <br> <br>--*/ <br>#ifndef _CPROPS_H_ <br>#define _CPROPS_H_ <br> <br> <br>typedef struct _property{ <br>    WCHAR   szPropertyName[MAX_PATH]; <br>    DWORD   dwFlags; <br>    DWORD   dwNumValues;         <br>    DWORD   dwSyntaxId;          <br>    PSampleDSOBJECT pSampleDSObject;      // Pointer to the SampleDS Object <br>}PROPERTY, *PPROPERTY; <br> <br>#define PROPERTY_NAME(pProperty)            pProperty-&gt;szPropertyName <br>#define PROPERTY_VALUES(pProperty)          pProperty-&gt;lpValues <br>#define PROPERTY_NUMVALUES(pProperty)       pProperty-&gt;dwNumValues <br>#define PROPERTY_SYNTAX(pProperty)          pProperty-&gt;dwSyntaxId <br>#define PROPERTY_SampleDSOBJECT(pProperty)  pProperty-&gt;pSampleDSObject <br>#define PROPERTY_FLAGS(pProperty)           pProperty-&gt;dwFlags <br> <br>#define CACHE_PROPERTY_MODIFIED        0x1 <br> <br>class CPropertyCache { <br> <br>public: <br> <br>    HRESULT <br>    CPropertyCache:: <br>    addproperty( <br>        LPWSTR szPropertyName, <br>        DWORD  dwSyntaxId, <br>        DWORD  dwNumValues, <br>        PSampleDSOBJECT pSampleDSObject <br>        ); <br> <br>    HRESULT <br>    CPropertyCache:: <br>    updateproperty( <br>        LPWSTR szPropertyName, <br>        DWORD  dwSyntaxId, <br>        DWORD  dwNumValues, <br>        PSampleDSOBJECT pSampleDSObject, <br>        BOOL fExplicit <br>        ); <br> <br>    HRESULT <br>    CPropertyCache:: <br>    findproperty( <br>        LPWSTR szPropertyName, <br>        PDWORD pdwIndex <br>        ); <br> <br>    HRESULT <br>    CPropertyCache:: <br>    getproperty( <br>        LPWSTR szPropertyName, <br>        PDWORD  pdwSyntaxId, <br>        PDWORD  pdwNumValues, <br>        PSampleDSOBJECT * ppSampleDSObject <br>        ); <br> <br>    HRESULT <br>    CPropertyCache:: <br>    unboundgetproperty( <br>        LPWSTR szPropertyName, <br>        PDWORD  pdwSyntaxId, <br>        PDWORD  pdwNumValues, <br>        PSampleDSOBJECT * ppSampleDSObject <br>        ); <br> <br>    HRESULT <br>    CPropertyCache:: <br>    putproperty( <br>        LPWSTR szPropertyName, <br>        DWORD  dwSyntaxId, <br>        DWORD  dwNumValues, <br>        PSampleDSOBJECT pSampleDSObject <br>        ); <br> <br>    CPropertyCache:: <br>    CPropertyCache(); <br> <br>    CPropertyCache:: <br>    ~CPropertyCache(); <br> <br>    static <br>    HRESULT <br>    CPropertyCache:: <br>    createpropertycache( <br>        CCoreADsObject FAR * pCoreADsObject, <br>        CPropertyCache FAR * FAR * ppPropertyCache <br>        ); <br> <br>    HRESULT <br>    CPropertyCache:: <br>    unmarshallproperty( <br>        LPWSTR szPropertyName, <br>        LPBYTE lpValue, <br>        DWORD  dwNumValues, <br>        DWORD  dwSyntaxId, <br>        BOOL fExplicit <br>        ); <br> <br>    HRESULT <br>    CPropertyCache:: <br>    SampleDSUnMarshallProperties( <br>        HANDLE hOperationData, <br>        BOOL fExplicit <br>        ); <br> <br> <br>    HRESULT <br>    CPropertyCache:: <br>    marshallproperty( <br>        LPSampleDS_ATTR_INFO pAttrInfo, <br>        LPWSTR szPropertyName, <br>        LPBYTE lpValues, <br>        DWORD  dwNumValues, <br>        DWORD  dwSyntaxId <br>        ); <br> <br>    HRESULT <br>    CPropertyCache:: <br>    SampleDSMarshallProperties( <br>       HANDLE hOperationData <br>    ); <br> <br> <br> <br>protected: <br> <br>    DWORD _dwMaxProperties; <br> <br> <br>    PPROPERTY _pProperties; <br>    DWORD   _cb; <br> <br>    CCoreADsObject FAR * _pCoreADsObject; <br>}; <br> <br>#endif <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
