<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MAIN.CXX</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context4636"></a>MAIN.CXX</h2>
<pre><code>//---------------------------------------------------------------------------- <br>// <br>//  Microsoft Active Directory 1.0 Sample Code <br>// <br>//  Copyright (C) Microsoft Corporation, 1996 <br>// <br>//  File:       main.cxx <br>// <br>//  Contents:   Main for adscmd <br>// <br>// <br>//---------------------------------------------------------------------------- <br> <br> <br>#include "main.hxx" <br> <br> <br>//------------------------------------------------------------------------- <br>// <br>// main <br>// <br>//------------------------------------------------------------------------- <br> <br>int __cdecl <br>main(int argc, char * argv[]) <br>{ <br>    HRESULT hr; <br>    int exitcode; <br> <br>    if (argc != 3) { <br>        PrintUsage() ; <br>        exit(1); <br>    } <br> <br>    hr = CoInitialize(NULL); <br> <br>    if (FAILED(hr)) { <br>        printf("CoInitialize failed\n"); <br>        exit(1); <br>    } <br> <br>    if (_stricmp(argv[1],"list") == 0) { <br> <br>        // <br>        // Call the List helper function <br>        // <br> <br>        exitcode = DoList(argv[2]) ; <br>    } <br>    else if (_stricmp(argv[1],"dump") == 0) { <br> <br>        // <br>        // Call the Dump helper function <br>        // <br> <br>        exitcode = DoDump(argv[2]) ; <br>    } <br>    else { <br> <br>        // <br>        // Unknown command <br>        // <br> <br>        PrintUsage() ; <br>        exitcode = 1 ; <br>    } <br> <br>    exit(exitcode) ; <br>    return 0; <br>} </code></pre>
<p>&nbsp;</p></body>
</HTML>
