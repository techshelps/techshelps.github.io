<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PROPERTY.FRM</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context4644"></a>PROPERTY.FRM</h2>
<pre><code>VERSION 4.00 <br>Begin VB.Form frmProp  <br>   BorderStyle     =   1  'Fixed Single <br>   Caption         =   "Properties" <br>   ClientHeight    =   4710 <br>   ClientLeft      =   5955 <br>   ClientTop       =   4245 <br>   ClientWidth     =   7080 <br>   Height          =   5115 <br>   Left            =   5895 <br>   LinkTopic       =   "Form1" <br>   MaxButton       =   0   'False <br>   MinButton       =   0   'False <br>   ScaleHeight     =   4710 <br>   ScaleWidth      =   7080 <br>   Top             =   3900 <br>   Width           =   7200 <br>   Begin VB.CommandButton cmdSet  <br>      Caption         =   "Set" <br>      Height          =   375 <br>      Left            =   5760 <br>      TabIndex        =   13 <br>      Top             =   4080 <br>      Width           =   1215 <br>   End <br>   Begin VB.TextBox txtValue  <br>      BeginProperty Font  <br>         name            =   "MS Sans Serif" <br>         charset         =   0 <br>         weight          =   400 <br>         size            =   9.75 <br>         underline       =   0   'False <br>         italic          =   0   'False <br>         strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   360 <br>      Left            =   840 <br>      TabIndex        =   12 <br>      Top             =   4080 <br>      Width           =   4815 <br>   End <br>   Begin VB.ListBox lstProperties  <br>      Appearance      =   0  'Flat <br>      BeginProperty Font  <br>         name            =   "MS Sans Serif" <br>         charset         =   0 <br>         weight          =   400 <br>         size            =   9.75 <br>         underline       =   0   'False <br>         italic          =   0   'False <br>         strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   1950 <br>      ItemData        =   "property.frx":0000 <br>      Left            =   120 <br>      List            =   "property.frx":0002 <br>      Sorted          =   -1  'True <br>      TabIndex        =   9 <br>      Top             =   1920 <br>      Width           =   6735 <br>   End <br>   Begin VB.CommandButton cmdOK  <br>      Caption         =   "Close" <br>      Height          =   375 <br>      Left            =   5760 <br>      TabIndex        =   8 <br>      Top             =   480 <br>      Width           =   975 <br>   End <br>   Begin VB.Label Label8  <br>      Caption         =   "Value:" <br>      BeginProperty Font  <br>         name            =   "MS Sans Serif" <br>         charset         =   0 <br>         weight          =   400 <br>         size            =   9.75 <br>         underline       =   0   'False <br>         italic          =   0   'False <br>         strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   255 <br>      Left            =   120 <br>      TabIndex        =   11 <br>      Top             =   4200 <br>      Width           =   735 <br>   End <br>   Begin VB.Label Label5  <br>      Caption         =   "Properties" <br>      BeginProperty Font  <br>         name            =   "MS Sans Serif" <br>         charset         =   0 <br>         weight          =   400 <br>         size            =   9.75 <br>         underline       =   0   'False <br>         italic          =   0   'False <br>         strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   255 <br>      Left            =   240 <br>      TabIndex        =   10 <br>      Top             =   1560 <br>      Width           =   3255 <br>   End <br>   Begin VB.Label lblIsContainer  <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      Height          =   255 <br>      Left            =   1200 <br>      TabIndex        =   7 <br>      Top             =   1200 <br>      Width           =   1935 <br>   End <br>   Begin VB.Label lblClass  <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      Height          =   255 <br>      Left            =   1200 <br>      TabIndex        =   6 <br>      Top             =   840 <br>      Width           =   4575 <br>   End <br>   Begin VB.Label lblPath  <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      Height          =   255 <br>      Left            =   1200 <br>      TabIndex        =   5 <br>      Top             =   480 <br>      Width           =   4575 <br>   End <br>   Begin VB.Label lblName  <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      Height          =   255 <br>      Left            =   1200 <br>      TabIndex        =   4 <br>      Top             =   120 <br>      Width           =   1935 <br>   End <br>   Begin VB.Label Label4  <br>      Alignment       =   1  'Right Justify <br>      Appearance      =   0  'Flat <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      Caption         =   "IsContainer:" <br>      ForeColor       =   &amp;H80000008&amp; <br>      Height          =   255 <br>      Left            =   120 <br>      TabIndex        =   3 <br>      Top             =   1200 <br>      Width           =   855 <br>   End <br>   Begin VB.Label Label3  <br>      Alignment       =   1  'Right Justify <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      Caption         =   "Class:" <br>      Height          =   255 <br>      Left            =   120 <br>      TabIndex        =   2 <br>      Top             =   840 <br>      Width           =   855 <br>   End <br>   Begin VB.Label Label2  <br>      Alignment       =   1  'Right Justify <br>      Appearance      =   0  'Flat <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      Caption         =   "ADsPath:" <br>      ForeColor       =   &amp;H80000008&amp; <br>      Height          =   255 <br>      Left            =   120 <br>      TabIndex        =   1 <br>      Top             =   480 <br>      Width           =   855 <br>   End <br>   Begin VB.Label Label1  <br>      Alignment       =   1  'Right Justify <br>      Appearance      =   0  'Flat <br>      BackColor       =   &amp;H00C0C0C0&amp; <br>      Caption         =   "Name:" <br>      ForeColor       =   &amp;H80000008&amp; <br>      Height          =   255 <br>      Left            =   120 <br>      TabIndex        =   0 <br>      Top             =   120 <br>      Width           =   855 <br>   End <br>End <br>Attribute VB_Name = "frmProp" <br>Attribute VB_Creatable = False <br>Attribute VB_Exposed = False <br>Option Explicit <br>Private Sub cmdCancel_Click() <br>' <br>' Allow user to cancel <br>' <br> <br>    Unload Me <br>End Sub <br> <br>Private Sub cmdOK_Click() <br>' <br>' Allow user to close form <br>' <br>     <br>    Unload Me <br>End Sub <br> <br> <br>Private Sub cmdSet_Click() <br>' <br>' Process Set Property command <br>' <br>    Dim strProp As String <br>    Dim strSyntax As String <br>    Dim strOld As String <br>    Dim Val As Variant <br>    Dim I As Integer <br>    Dim pos1 As Integer  'Finds "(" in string to locate syntax <br>    Dim pos2 As Integer  'Finds ")" in string to locate syntax <br>    ' <br>    ' Set error handling <br>    ' <br>    On Error Resume Next <br>     <br>    I = lstProperties.ListIndex <br>    If currentADsObj Is Nothing Then <br>        ' <br>        ' There is no object associated with this interface. <br>        ' Do nothing. <br>        ' <br>        GoTo finish <br>         <br>    End If <br>    ' <br>    'Need to strip Prop off Prop(SYNTAX):Value <br>    ' <br>    strOld = lstProperties.Text <br>    pos1 = InStr(strOld, "(") <br>    pos2 = InStr(pos1, strOld, ")") <br>    strSyntax = Right(strOld, (Len(strOld) - pos1)) <br>    strSyntax = Left(strSyntax, ((pos2 - pos1) - 1)) <br>    strProp = Left(strOld, (pos1 - 1)) <br>    If (strSyntax = "ADsPath") Or (strSyntax = "String") Or (strSyntax = "DirectoryString") Then <br>        Val = txtValue.Text <br>    ElseIf (strSyntax = "Counter") Or (strSyntax = "Integer") _ <br>            Or (strSyntax = "Interval") Then <br>        Val = CLng(txtValue.Text) <br>    ElseIf (strSyntax = "SmallInterval") Then <br>        Val = CLng(txtValue.Text) <br>    ElseIf (strSyntax = "List") Or (strSyntax = "OctetString") Then <br>        Val = CVar(txtValue.Text) <br>    ElseIf (strSyntax = "PhoneNumber") Or (strSyntax = "PostalAddress") Then <br>        Val = txtValue.Text <br>    ElseIf strSyntax = "Boolean" Then <br>        Val = CBool(txtValue.Text) <br>    ElseIf (strSyntax = "EmailAddress") Or (strSyntax = "FaxNumber") Then <br>        Val = txtValue.Text <br>    ElseIf strSyntax = "NetAddress" Or strSyntax = "Path" Then <br>        Val = txtValue.Text <br>    ElseIf strSyntax = "Time" Then <br>        Val = CDate(txtValue.Text) <br>    Else <br>        ' <br>        ' If none of the syntax cases above are found we bail out silently <br>        ' <br>        GoTo finish <br>    End If <br>    strOld = Left(strOld, (pos2 + 1)) &amp; txtValue.Text <br>    currentADsObj.Put strProp, Val <br>    Err = 0 <br>    currentADsObj.SetInfo <br>    If Err Then <br>        MsgBox "Could not Set Property, check access " <br>        GoTo finish <br>    End If <br>    lstProperties.RemoveItem I <br>    lstProperties.AddItem strOld, I <br>     <br>finish: <br>End Sub <br> <br>Private Sub Form_Load() <br>     <br>    ' <br>    ' User cannot bring up second properties dialog box <br>    ' <br>        frmBrwsTree.cmdProperties.Enabled = False <br>End Sub <br> <br>Private Sub Form_Unload(Cancel As Integer) <br> <br>    ' <br>    ' Enable properties command <br>    ' <br>    frmBrwsTree.cmdProperties.Enabled = True <br>End Sub <br> <br> <br>Private Sub lstProperties_Click() <br>' <br>'Do on Properties command <br>' <br>    Dim pos1 As Integer <br>    Dim pos2 As Integer <br>    Dim strVal As String <br>    Dim strTemp As String <br>     <br>    On Error GoTo finish <br>     <br>    strTemp = lstProperties.List(lstProperties.ListIndex) <br>    pos1 = InStr(strTemp, "(") <br>    pos2 = InStr(pos1, strTemp, ")") <br>    pos1 = InStr(pos2, strTemp, ":") <br>    strVal = Right(strTemp, (Len(strTemp) - pos1)) <br>     <br>    txtValue.Text = strVal <br>    frmProp.Refresh <br>finish: <br>End Sub </code></pre>
<p>&nbsp;</p></body>
</HTML>
