<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>COUNT/COUNTCTN</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="_vcce_count_countctn"></a>COUNT/COUNTCTN</h2>
<p>
The COUNT sample demonstrates how to create a full control and a simple object, within the same DLL, that communicate with each other. The COUNTCTN sample is a simple dialog box application that provides a container for the CCount control.</p>
<p>
The CCountCtnDlg dialog box class has two public variables, m_Counter, which is a CCounter object, and m_nMaxCounter which is an integer that's initialized to 10 in CCountCtnDlg's constructor.</p>
<p>
CCounter is a full control. In addition to <b>IUnknown</b> and <b>IDispatch,</b> it implements the ICounter interface, which exposes three methods. It supports a dual interface, so you can either access the ICounter methods through <b>IDispatch::Invoke</b> or call them directly by way of the vtable. These methods are SetMaxCounter, StartCounting, and GetInfoFromCounter. CCounter also has one protected data member, called m_pIObject, which is a pointer to the IObject1 interface on a CObject1 object. </p>
<p>
CObject1 is a simple object. It also supports a dual interface. In addition to <b>IUnknown</b> and <b>IDispatch,</b> it implements the IObject1 interface<b>,</b> which exposes three methods. These methods are Initialize, SetMax, and Start. CObject1 has two protected data members. The m_pICounter data member contains a back-pointer to the ICounter interface on the CCounter control that instantiates it. The m_nMax data member is an integer.</p>
<p>
The CCounter constructor instantiates a CObject1 object and queries for a pointer to its IObject1 interface, which the CCounter control assigns to its m_pIObject data member. It then calls IObject1::Initialize, passing a back-pointer to itself, which the IObject1 object assigns to its m_pICounter data member.</p>
<p>
When a user enters a number between 1 and 15 in the dialog box's edit control, the number is assigned to CCountCtnDlg::m_nMaxCounter. When the user taps the <b>Apply</b> button, CCountCtnDlg::OnSetMaxCounter invokes ICounter::SetMaxCounter on the CCounter control, passing the value of m_nMaxCounter as the argument. The ICounter::SetMaxCounter method invokes IObject1::SetMax on its m_pIObject member, passing along the value it was passed. IObject1::SetMax assigns this value to its m_nMax data member.</p>
<p>
When a user taps the <b>Start</b> button, CCountCtnDlg::OnStart invokes ICounter::StartCounting on the CCounter control. ICounter::StartCounting invokes IObject::Start on its m_pIObject member, which loops m_nMax times. Each time through the loop, it calls ICounter::GetInfoFromCounter, using the back-pointer stored in its m_pICounter member, passing in a text string that states the number of times it's been through the loop. ICounter::GetInfoFromCounter displays the text string in its window on the dialog box.</p>
<p>
This sample demonstrates the following keywords:</p>
<p class=indent1>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_wcesdk_com_IUnknown_QueryInterface">
</object><a href=JavaScript:alink_1.Click()><b>IUnknown::QueryInterface</b></a></p>
<p class=indent1>
<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_wcesdk_win32_DrawText">
</object><a href=JavaScript:alink_2.Click()><b>DrawText</b></a></p>
<p class=indent1>
<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_wcesdk_win32_GetClientRect">
</object><a href=JavaScript:alink_3.Click()><b>GetClientRect</b></a></p>
<p class=indent1>
<object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_wcesdk_win32_PatBlt">
</object><a href=JavaScript:alink_4.Click()><b>PatBlt</b></a></p>
<p class=indent1>
<object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_wcesdk_win32_Rectangle">
</object><a href=JavaScript:alink_5.Click()><b>Rectangle</b></a></p>
<p class=indent1>
<object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_wcesdk_win32_Sleep">
</object><a href=JavaScript:alink_6.Click()><b>Sleep</b></a></p>
<p class=indent1>
<object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_atl_CWindow.3a3a.ReleaseDC">
</object><a href=JavaScript:alink_7.Click()><b>ReleaseDC</b></a></p>
<p class=indent1>
<object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_wcesdk_win32_wsprintf">
</object><a href=JavaScript:alink_8.Click()><b>wsprintf</b></a></p>
<p>
You can find the COUNT project files in the Wce\Samples\Atl\COUNT directory.</p>
<p>
You can find the COUNTCTN project files in the Wce\Samples\Atl\COUNTCTN directory.</p>
<p>
To build the COUNT and COUNTCTN samples, follow the procedure described in <object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_wcesdk_Building_the_Sample_Applications">
</object><a href=JavaScript:alink_9.Click()>Building the Sample Applications</a>, selecting one or more of the following project configurations. </p>
<ul>
<li>
WCE x86em (Desktop PC Windows CE emulation)</li>
<li>
WCE x86</li>
<li>
WCE PPC</li>
<li>
WCE MIPS</li>
<li>
WCE SH</li>
</ul>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
