<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using ATL Global Functions and Macros in Windows CE</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="_vcce_using_atl_global_functions_and_macros_in_windows_ce"></a>Using ATL Global Functions and Macros in Windows CE</h2>
<p>
ATL for Windows CE supports most of the standard ATL global functions but there are a few that aren't relevant to the current implementation of Windows CE.</p>
<p>
In Windows CE, you can only use ATL to create in-process servers. Because you can't use it to create executables, ATL for Windows CE doesn't support the <b>RegisterClassObject</b> and <b>RevokeClassObject</b> global functions. There's no need for marshaling in an in-process server, so ATL for Windows CE also doesn't support the <b>AtlFreeMarshalStream</b>, <b>AtlMarshalPtrInProc</b>, or <b>AtlMarshalPtrInProc</b> global functions. </p>
<p>
In Windows CE, whenever an application blocks, waiting for a message or some other event, the kernel puts the CPU into low power mode. If an application loops for a long time without blocking, it defeats this power management feature. Because the <b>AtlWaitWithMessageLoop</b> function doesn't block while waiting for the object to be signaled, ATL for Windows CE doesn't support this function.  </p>
<p>
ATL for Windows CE 2.0 also doesn't support the <b>AtlCreateTargetDC</b> global function. In Windows CE, this function just returns the same device context handle you pass to it.  </p>
<p>
ATL for Windows CE supports all the macros defined in the standard Active Template Library exactly the same way they're supported on the desktop Windows platforms, except for one. It doesn't support the <b>DECLARE_CLASSFACTORY_AUTOTHREAD</b> macro because Windows CE doesn't support the apartment threading model.</p>
<p>
See <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="notopic.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_atl_ATL_Macros_and_Global_Functions">
</object><a href=JavaScript:alink_1.Click()>ATL Macros and Global Functions</a> in the standard ATL documentation for specific information about all the ATL global functions and macros.</p>
<p>&nbsp;</p></body>
</HTML>
