<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DeviceCapabilities</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_devicecapabilities"></a>DeviceCapabilities</h1>
<p>
The <b>DeviceCapabilities</b> function retrieves the capabilities of a printer device driver. </p>
<pre><code><b>DWORD DeviceCapabilities(
  LPCTSTR</b><i> pDevice</i><b>,    </b>// pointer to a printer-name string
<b>  LPCTSTR</b><i> pPort</i><b>,      </b>// pointer to a port-name string
<b>  WORD</b><i> fwCapability</i><b>,  </b>// device capability to query
<b>  LPTSTR</b><i> pOutput</i><b>,     </b>// pointer to the output
<b>  CONST DEVMODE</b><i> *pDevMode</i> 
                      // pointer to structure with device data
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pDevice</i></dt>
<dd>
Pointer to a null-terminated string that contains the name of the printer. Note that this is the name of the printer, not of the printer driver.</dd>
<dt>
<i>pPort</i></dt>
<dd>
Pointer to a null-terminated string that contains the name of the port to which the device is connected, such as "LPT1". </dd>
<dt>
<i>fwCapability</i></dt>
<dd>
Specifies the capabilities to query. This parameter can be one of the following values: 
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=41%>Value</th>
<th align=left colspan=3 width=59%>Meaning</th>
</tr>
<tr valign=top>
<td width=41%>DC_BINADJUST</td>
<td colspan=3 width=59%><b>Windows 95:</b> Retrieves the page positioning for the paper source specified in the <b>DEVMODE</b> structure pointed to by <i>pdevMode</i>. The return value can be one of the following:</td>
</tr>
<tr valign=top>
<td width=41%></td>
<td colspan=3 width=59%>DCBA_FACEUPNONE</td>
</tr>
<tr valign=top>
<td width=41%></td>
<td colspan=3 width=59%>DCBA_FACEUPCENTER</td>
</tr>
<tr valign=top>
<td width=41%></td>
<td colspan=3 width=59%>DCBA_FACEUPLEFT</td>
</tr>
<tr valign=top>
<td width=41%></td>
<td colspan=3 width=59%>DCBA_FACEUPRIGHT</td>
</tr>
<tr valign=top>
<td width=41%></td>
<td colspan=3 width=59%>DCBA_FACEDOWNNONE</td>
</tr>
<tr valign=top>
<td width=41%></td>
<td colspan=3 width=59%>DCBA_FACEDOWNCENTER</td>
</tr>
<tr valign=top>
<td width=41%></td>
<td colspan=3 width=59%>DCBA_FACEDOWNLEFT</td>
</tr>
<tr valign=top>
<td width=41%></td>
<td colspan=3 width=59%>DCBA_FACEDOWNRIGHT</td>
</tr>
<tr valign=top>
<td width=41%></td>
<td colspan=3 width=59%><b>Windows 98: </b>Not supported</td>
</tr>
<tr valign=top>
<td width=41%>DC_BINNAMES</td>
<td colspan=3 width=59%>Copies an array containing a list of the names of the paper bins. This array is in the form <b>char</b> <i>PaperNames</i>[<i>cBinMax</i>][<i>cchBinName</i>] where <i>cchBinName</i> is 24. If the <i>pOutput</i> parameter is NULL, the return value is the number of bin entries required. Otherwise, the return value is the number of bins copied.</td>
</tr>
<tr valign=top>
<td width=41%>DC_BINS</td>
<td colspan=3 width=59%>Retrieves a list of available bins. The function copies the list to the <i>pOutput</i> parameter as a <b>WORD</b> array. If <i>pOutput</i> is NULL, the function returns the number of supported bins to allow the application the opportunity to allocate a buffer with the correct size. For more information about these bins, see the description of the <b>dmDefaultSource</b> member of the <a href="prntspol_8nle.htm"><b>DEVMODE</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=41%>DC_COPIES</td>
<td colspan=3 width=59%>Returns the number of copies the device can print.</td>
</tr>
<tr valign=top>
<td width=41%>DC_DRIVER</td>
<td colspan=3 width=59%>Returns the version number of the printer driver.</td>
</tr>
<tr valign=top>
<td width=41%>DC_DATATYPE_PRODUCED</td>
<td colspan=3 width=59%><b>Windows 95:</b> The return value is the number of datatypes supported by the printer driver. If the function returns -1, the driver understands the "RAW" datatype only. The names of the supported datatypes are copied to an array. Use the names in the <a href="prntspol_9ilu.htm"><b>DOCINFO</b></a> structure when calling the <a href="prntspol_95sz.htm"><b>StartDoc</b></a> function to specify the datatype.<p>
<b>Windows 98: </b>Not supported.</p>
</td>
</tr>
<tr valign=top>
<td width=41%>DC_DUPLEX</td>
<td colspan=3 width=59%>Returns the level of duplex support. The function returns 1 if the printer is capable of duplex printing. Otherwise, the return value is zero.</td>
</tr>
<tr valign=top>
<td width=41%>DC_EMF_COMPLIANT</td>
<td colspan=3 width=59%><b>Windows 95:</b> Determines if a printer driver supports enhanced metafile (EMF). A return value of 1 means the driver supports EMF. A return value of -1 means that the driver does not support EMF.<p>
<b>Windows 98: </b>Not supported. </p>
</td>
</tr>
<tr valign=top>
<td width=41%>DC_ENUMRESOLUTIONS</td>
<td colspan=3 width=59%>Returns a list of available resolutions. If <i>pOutput</i> is NULL, the function returns the number of available resolution configurations. Resolutions are represented by pairs of <b>LONG</b> integers representing the horizontal and vertical resolutions (specified in dots per inch).</td>
</tr>
<tr valign=top>
<td width=41%>DC_EXTRA</td>
<td colspan=3 width=59%>Returns the number of bytes required for the device-specific portion of the <b>DEVMODE</b> structure for the printer driver.</td>
</tr>
<tr valign=top>
<td width=41%>DC_FIELDS</td>
<td colspan=3 width=59%>Returns the <b>dmFields</b> member of the printer driver's <a href="prntspol_8nle.htm"><b>DEVMODE</b></a> structure. The <b>dmFields</b> member indicates which members in the device-independent portion of the structure are supported by the printer driver.</td>
</tr>
<tr valign=top>
<td width=41%>DC_FILEDEPENDENCIES</td>
<td colspan=3 width=59%>Returns a list of files that also need to be loaded when a driver is installed. If the <i>pOutput</i> parameter is NULL, the function returns the number of files. Otherwise, <i>pOutput</i> points to an array of filenames in the form <b>char[</b><i>chFileName</i><b>, 64]</b>. Each filename is a null-terminated string.</td>
</tr>
<tr valign=top>
<td width=41%>DC_MAXEXTENT</td>
<td colspan=3 width=59%>Returns a <a href="rectangl_1wj6.htm"><b>POINTS</b></a> structure that contains the maximum paper size that the <b>dmPaperLength</b> and <b>dmPaperWidth</b> members of the printer driver's <b>DEVMODE</b> structure can specify. The <b>x</b> member of the <b>POINTS</b> structure contains the maximum <b>dmPaperWidth</b> value, and the <b>y</b> member contains the maximum <b>dmPaperLength</b> value. </td>
</tr>
<tr valign=top>
<td width=41%>DC_MINEXTENT</td>
<td colspan=3 width=59%>Returns a <b>POINTS</b> structure that contains the minimum paper size that the <b>dmPaperLength</b> and <b>dmPaperWidth</b> members of the printer driver's <a href="prntspol_8nle.htm"><b>DEVMODE</b></a> structure can specify. The <b>x</b> member of the <b>POINTS</b> structure contains the minimum <b>dmPaperWidth</b> value, and the <b>y</b> member contains the minimum <b>dmPaperLength</b> value.</td>
</tr>
<tr valign=top>
<td width=41%>DC_ORIENTATION</td>
<td colspan=3 width=59%>Returns the relationship between portrait and landscape orientations for a device, in terms of the number of degrees that portrait orientation is rotated counterclockwise to produce landscape orientation. The return value can be one of the following:</td>
</tr>
<tr valign=top>
<td width=41%></td>
<td width=11%>0</td>
<td colspan=2 width=48%>No landscape orientation.</td>
</tr>
<tr valign=top>
<td width=41%></td>
<td width=11%>90</td>
<td colspan=2 width=48%>Portrait is rotated 90 degrees to produce landscape. </td>
</tr>
<tr valign=top>
<td width=41%></td>
<td width=11%>270</td>
<td colspan=2 width=48%>Portrait is rotated 270 degrees to produce landscape.</td>
</tr>
<tr valign=top>
<td width=41%>DC_PAPERNAMES</td>
<td colspan=3 width=59%>Retrieves a list of supported paper names (for example, Letter or Legal). If the <i>pOutput</i> parameter is NULL, the function returns the number of paper sizes available. Otherwise, <i>pOutput</i> points to an array for the paper names in the form <b>char[</b><i>cPaperNames</i>,<b> 64]</b>. Each paper name is a null-terminated string.</td>
</tr>
<tr valign=top>
<td width=41%>DC_PAPERS</td>
<td colspan=3 width=59%>Retrieves a list of supported paper sizes. The function copies the list to <i>pOutput</i> as a <b>WORD</b> array and returns the number of entries in the array. If <i>pOutput</i> is NULL, the function returns the number of supported paper sizes to allow the application the opportunity to allocate a buffer with the correct size. For more information on paper sizes, see the description of the <b>dmPaperSize</b> member of the <a href="prntspol_8nle.htm"><b>DEVMODE</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=41%>DC_PAPERSIZE</td>
<td colspan=3 width=59%>Copies the dimensions of all supported paper sizes, in tenths of a millimeter, to an array of <b>POINT</b> structures pointed to by the <i>pOutput</i> parameter. The width (x-dimension) and length (y-dimension) of a paper size are returned as if the paper were in the DMORIENT_PORTRAIT orientation.</td>
</tr>
<tr valign=top>
<td width=41%>DC_SIZE</td>
<td colspan=3 width=59%>Returns the <b>dmSize</b> member of the printer driver's <a href="prntspol_8nle.htm"><b>DEVMODE</b></a> structure.</td>
</tr>
<tr valign=top>
<td width=41%>DC_TRUETYPE</td>
<td colspan=3 width=59%>Retrieves the abilities of the driver to use TrueType fonts. For DC_TRUETYPE, the <i>pOutput</i> parameter should be NULL. The return value can be one or more of the following:</td>
</tr>
<tr valign=top>
<td width=41%></td>
<td colspan=2 width=30%>DCTT_BITMAP</td>
<td width=29%>Device can print TrueType fonts as graphics. </td>
</tr>
<tr valign=top>
<td width=41%></td>
<td colspan=2 width=30%>DCTT_DOWNLOAD</td>
<td width=29%>Device can down-load TrueType fonts. </td>
</tr>
<tr valign=top>
<td width=41%></td>
<td colspan=2 width=30%>DCTT_DOWNLOAD_<br>
OUTLINE</td>
<td width=29%><b>Windows 95 and Windows 98:</b> Device can download outline TrueType fonts.</td>
</tr>
<tr valign=top>
<td width=41%></td>
<td colspan=2 width=30%>DCTT_SUBDEV</td>
<td width=29%>Device can substitute device fonts for TrueType fonts. </td>
</tr>
<tr valign=top>
<td width=41%>DC_VERSION</td>
<td colspan=3 width=59%>Returns the specification version to which the printer driver conforms.</td>
</tr>
</table><br>

</dd>
<dt>
<i>pOutput</i></dt>
<dd>
Pointer to an array of bytes. The format of the array depends on the setting of the <i>fwCapability</i> parameter. If <i>pOutput</i> is zero, <b>DeviceCapabilities</b> returns the number of bytes required for the output data. </dd>
<dt>
<i>pDevMode</i></dt>
<dd>
Pointer to a <a href="prntspol_8nle.htm"><b>DEVMODE</b></a> structure. If this parameter is NULL, <b>DeviceCapabilities</b> retrieves the current default initialization values for the specified printer driver. Otherwise, the function retrieves the values contained in the structure to which <i>pDevMode</i> points. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value depends on the setting of the <i>fwCapability</i> parameter. </p>
<p>
If the function fails, the return value is –1. </p>
<p>
<b>Windows NT:</b> To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
In 16-bit versions of Windows, the <b>DeviceCapabilities</b> function was implemented in the printer driver and you needed to call the <b>LoadLibrary</b> and <b>GetProcAddress</b> functions to get a pointer to the function. This is no longer necessary, because <b>DeviceCapabilities</b> is part of the Win32 API. You should not call <b>LoadLibrary</b> on the printer driver.</p>
<p>
The <a href="prntspol_8nle.htm"><b>DEVMODE</b></a> structure pointed to by the <i>pDevMode</i> parameter may be obtained by calling the <b>DocumentProperties</b> function. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in wingdi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use winspool.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="devcons_0g6r.htm">Device Contexts Overview</a>, <a href="devcons_7e2b.htm">Device Context Functions</a>, <a href="prntspol_8nle.htm"><b>DEVMODE</b></a>, <a href="prntspol_7k1f.htm"><b>DocumentProperties</b></a>, <a href="devcons_88s3.htm"><b>GetDeviceCaps</b></a>, <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getprocaddress">
</object><a href=JavaScript:alink_2.Click()><b>GetProcAddress</b></a>, <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_loadlibrary">
</object><a href=JavaScript:alink_3.Click()><b>LoadLibrary</b></a>, <a href="rectangl_0tiq.htm"><b>POINT</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
