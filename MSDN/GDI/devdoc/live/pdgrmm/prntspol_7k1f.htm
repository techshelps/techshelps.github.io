<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DocumentProperties</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_documentproperties"></a>DocumentProperties</h1>
<p>
The <b>DocumentProperties</b> function retrieves or modifies printer initialization information or displays a printer-configuration dialog box for the specified printer. </p>
<pre><code><b>LONG DocumentProperties(
  HWND</b><i> hWnd</i><b>,           </b>// handle to window that displays dialog box
<b>  HANDLE</b><i> hPrinter</i><b>,         </b>// handle to printer object
<b>  LPTSTR</b><i> pDeviceName</i><b>,      </b>// pointer to device name
<b>  PDEVMODE</b><i> pDevModeOutput</i><b>,</b>
<b>                       </b>// pointer to modified device mode structure
<b>  PDEVMODE</b><i> pDevModeInput</i><b>,  </b>// pointer to original device mode 
                           // structure
<b>  DWORD</b><i> fMode</i>              // mode flag
);
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hWnd</i></dt>
<dd>
Handle to the parent window of the printer-configuration dialog box. </dd>
<dt>
<i>hPrinter</i></dt>
<dd>
Handle to a printer object. </dd>
<dt>
<i>pDeviceName</i></dt>
<dd>
Pointer to a null-terminated string that specifies the name of the device for which the printer-configuration dialog box should be displayed. </dd>
<dt>
<i>pDevModeOutput</i></dt>
<dd>
Pointer to a <a href="prntspol_8nle.htm"><b>DEVMODE</b></a> structure that receives the printer configuration data specified by the user.</dd>
<dt>
<i>pDevModeInput</i></dt>
<dd>
Pointer to a <b>DEVMODE</b> structure that the operating system uses to initialize the dialog box controls. 
<p>
This parameter is only used if the DM_IN_BUFFER flag is set in the <i>fMode</i> parameter. If DM_IN_BUFFER is not set, the operating system uses the printer's default <b>DEVMODE</b>. 
</dd>
<dt>
<i>fMode</i></dt>
<dd>
Specifies a mask of values that determines the operations the function performs. If this parameter is zero, the <b>DocumentProperties</b> function returns the number of bytes required by the printer driver's <a href="prntspol_8nle.htm"><b>DEVMODE</b></a> data structure. Otherwise, use one or more of the following constants to construct a value for this parameter; note, however, that in order to change the print settings, an application must specify at least one input value and one output value: 
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=33%><b>Value</b></td>
<th align=left width=67%>Meaning</th>
</tr>
<tr valign=top>
<td width=33%>DM_IN_BUFFER</td>
<td width=67%>Input value. Before prompting, copying, or updating, the function merges the printer driver's current print settings with the settings in the <b>DEVMODE</b> structure specified by the <i>pDevModeInput</i> parameter. The function updates the structure only for those members specified by the <b>DEVMODE</b> structure's <b>dmFields</b> member. This value is also defined as DM_MODIFY. In cases of conflict during the merge, the settings in the <b>DEVMODE</b> structure specified by <i>pDevModeInput</i> override the printer driver's current print settings.</td>
</tr>
<tr valign=top>
<td width=33%>DM_IN_PROMPT</td>
<td width=67%>Input value. The function presents the printer driver's Print Setup dialog box and then changes the settings in the printer's <a href="prntspol_8nle.htm"><b>DEVMODE</b></a> data structure to those values specified by the user. This value is also defined as DM_PROMPT.</td>
</tr>
<tr valign=top>
<td width=33%>DM_OUT_BUFFER</td>
<td width=67%>Output value. The function writes the printer driver's current print settings, including private data, to the <b>DEVMODE</b> data structure specified by the <i>pDevModeOutput</i> parameter. The caller must allocate a buffer sufficiently large to contain the information. If the bit DM_OUT_BUFFER sets is clear, the <i>pDevModeOutput</i> parameter can be NULL. This value is also defined as DM_COPY.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the <i>fMode</i> parameter is zero, the return value is the size of the buffer required to contain the printer driver initialization data. Note that this buffer can be larger than a <b>DEVMODE</b> structure if the printer driver appends private data to the structure. </p>
<p>
If the function displays the initialization dialog box, the return value is either IDOK or IDCANCEL, depending on which button the user selects. </p>
<p>
If the function does not display the dialog box and is successful, the return value is IDOK. </p>
<p>
If the function fails, the return value is less than zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
The printer object handle identified by the <i>hPrinter</i> parameter can be obtained by calling the <a href="prntspol_9qnm.htm"><b>OpenPrinter</b></a> function. </p>
<p>
The string pointed to by the <i>pDeviceName</i> parameter can be obtained by calling the <a href="prntspol_1gky.htm"><b>GetPrinter</b></a> function. </p>
<p>
<b>Note</b>&nbsp;&nbsp;The <b>DEVMODE</b> structure actually used by a printer driver contains the device-independent part (as defined above) followed by a driver-specific part that varies in size and content with each driver and driver version. Because of this driver dependence, it is very important for applications to query the driver for the correct size of the <b>DEVMODE</b> structure before allocating a buffer for it.</p>
<p>
To make changes to print settings that are local to an application, an application should follow these steps: 
<ol>
<li>
Get the number of bytes required for the full <b>DEVMODE</b> structure by calling <b>DocumentProperties</b> and specifying zero in the <i>fMode </i>parameter.</li>
<li>
Allocate memory for the full <b>DEVMODE</b> structure.</li>
<li>
Get the current printer settings by calling <b>DocumentProperties</b>. Pass a pointer to the <b>DEVMODE</b> structure allocated in Step 2 as the <i>pDevModeOutput</i> parameter and specify the DM_OUT_BUFFER value.</li>
<li>
Modify the appropriate members of the returned <b>DEVMODE</b> structure and indicate which members were changed by setting the corresponding bits in the <b>dmFields</b> member of the <b>DEVMODE</b>.</li>
<li>
Call <b>DocumentProperties </b>and pass the modified <b>DEVMODE</b> structure back as both the <i>pDevModeInput</i> and <i>pDevModeOutput</i> parameters and specify both the DM_IN_BUFFER and DM_OUT_BUFFER values (which are combined using the OR operator).</li>
</ol>
<p>
The <b>DEVMODE</b> structure returned by the third call to <b>DocumentProperties</b> can be used as an argument in a call to the <b>CreateDC</b> function.</p>
<p>
To create a handle to a printer-device context using the current printer settings, you only need to call <b>DocumentProperties</b> twice, as described above. The first call gets the size of the full <b>DEVMODE</b> and the second call initializes the <b>DEVMODE</b> with the current printer settings. Pass the initialized <b>DEVMODE</b> to <b>CreateDC </b>to obtain the handle to the printer device context.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winspool.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use winspool.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="prntspol_62ia.htm">Printing and Print Spooler Overview</a>, <a href="prntspol_7mgj.htm">Printing and Print Spooler Functions</a>, <a href="prntspol_35ir.htm"><b>AdvancedDocumentProperties</b></a>, <a href="devcons_5g83.htm"><b>CreateDC</b></a>, <a href="prntspol_8nle.htm"><b>DEVMODE</b></a>, <a href="prntspol_1gky.htm"><b>GetPrinter</b></a>, <a href="prntspol_9qnm.htm"><b>OpenPrinter</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
