<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>EnumPrinters</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_enumprinters"></a>EnumPrinters</h1>
<p>
The <b>EnumPrinters</b> function enumerates available printers, print servers, domains, or print providers. </p>
<pre><code><b>BOOL EnumPrinters(
  DWORD</b><i> Flags</i><b>,         </b>// types of printer objects to enumerate
<b>  LPTSTR</b><i> Name</i><b>,         </b>// name of printer object
<b>  DWORD</b><i> Level</i><b>,         </b>// specifies type of printer info structure
<b>  LPBYTE</b><i> pPrinterEnum</i><b>, </b>// pointer to buffer to receive printer info 
                       // structures
<b>  DWORD</b><i> cbBuf</i><b>,         </b>// size, in bytes, of the buffer
<b>  LPDWORD</b><i> pcbNeeded</i><b>,   </b>// pointer to variable with no. of bytes 
                       // copied (or required)
<b>  LPDWORD</b><i> pcReturned</i>   // pointer to variable with no. of printer 
                       // info. structures copied
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>Flags</i></dt>
<dd>
Specifies the types of print objects that the function should enumerate. This value can be a combination of the following constants: 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=55%>Value</th>
<th align=left width=45%>Meaning</th>
</tr>
<tr valign=top>
<td width=55%>PRINTER_ENUM_LOCAL</td>
<td width=45%>The function ignores the <i>Name</i> parameter, and enumerates the locally installed printers.<p>
<b>Windows 95:</b> The function will also enumerate network printers because they are handled by the local print provider.</p>
</td>
</tr>
<tr valign=top>
<td width=55%>PRINTER_ENUM_NAME</td>
<td width=45%>The function enumerates the printer identified by <i>Name</i>. This can be a server, a domain, or a print provider. If <i>Name</i> is NULL, the function enumerates available print providers.</td>
</tr>
<tr valign=top>
<td width=55%>PRINTER_ENUM_SHARED</td>
<td width=45%>The function enumerates printers that have the shared attribute. Cannot be used in isolation; use an OR operation to combine with another PRINTER_ENUM type.</td>
</tr>
<tr valign=top>
<td width=55%>PRINTER_ENUM_DEFAULT</td>
<td width=45%><b>Windows 95:</b> The function returns information about the default printer.</td>
</tr>
<tr valign=top>
<td width=55%>PRINTER_ENUM_CONNECTIONS</td>
<td width=45%><b>Windows NT:</b> The function enumerates the list of printers to which the user has made previous connections.</td>
</tr>
<tr valign=top>
<td width=55%>PRINTER_ENUM_NETWORK</td>
<td width=45%><b>Windows NT:</b> The function enumerates network printers in the computer's domain. This value is valid only if <i>Level</i> is 1.</td>
</tr>
<tr valign=top>
<td width=55%>PRINTER_ENUM_REMOTE</td>
<td width=45%><b>Windows NT:</b> The function enumerates network printers and print servers in the computer's domain. This value is valid only if <i>Level</i> is 1.</td>
</tr>
</table><br>


<p>
If <i>Level</i> is 4, you can only use the PRINTER_ENUM_CONNECTIONS and PRINTER_ENUM_LOCAL constants.
</dd>
<dt>
<i>Name</i></dt>
<dd>
If <i>Level</i> is 1, <i>Flags</i> contains PRINTER_ENUM_NAME, and <i>Name</i> is non-NULL, <i>Name</i> points to a null-terminated string that specifies the name of the object to enumerate. This string can be the name of a server, a domain, or a print provider. 
<p>
If <i>Level</i> is 1, <i>Flags</i> contains PRINTER_ENUM_NAME, and <i>Name</i> is NULL, the function enumerates the available print providers. 

<p>
If <i>Level</i> is 1, <i>Flags</i> contains PRINTER_ENUM_REMOTE, and <i>Name</i> is NULL, the function enumerates the printers in the user's domain. 

<p>
If <i>Level is 2 or 5</i>, <i>Name</i> points to a null-terminated string that specifies the name of a server whose printers are to be enumerated. If this string is NULL, the function enumerates the printers installed on the local machine.

<p>
If <i>Level</i> is 4, <i>Name</i> should be NULL. The function always queries on the local machine.

<p>
When <i>Name</i> is NULL, it enumerates printers that are installed on the local machine. These printers include those that are physically attached to the local machine as well as remote printers to which it has a network connection.
</dd>
<dt>
<i>Level</i></dt>
<dd>
Specifies the type of data<b> </b>structures pointed to by <i>pPrinterEnum</i>. Valid values are 1, 2, 4, and 5, which correspond to the <a href="prntspol_03g2.htm"><b>PRINTER_INFO_1</b></a>,<b> <a href="prntspol_9otu.htm">PRINTER_INFO_2</a></b>, <a href="prntspol_8vle.htm"><b>PRINTER_INFO_4</b></a>, and <a href="prntspol_8gz6.htm"><b>PRINTER_INFO_5</b></a> data structures.
<p>
<b>Windows 95:</b> The value can be 1, 2, or 5.

<p>
<b>Windows NT:</b> This value can be 1, 2, 4, or 5.
</dd>
<dt>
<i>pPrinterEnum</i></dt>
<dd>
Pointer to a buffer that receives an array of <b>PRINTER_INFO_1</b>, <b>PRINTER_INFO_2</b>, <b>PRINTER_INFO_4</b>, or <b>PRINTER_INFO_5</b> structures. Each structure contains data that describes an available print object. 
<p>
If <i>Level</i> is 1, the array contains <b>PRINTER_INFO_1</b> structures. If <i>Level</i> is 2, the array contains <b>PRINTER_INFO_2</b> structures. If <i>Level</i> is 4, the array contains <b>PRINTER_INFO_4</b> structures. If <i>Level</i> is 5, the array contains <b>PRINTER_INFO_5</b> structures. 

<p>
The buffer must be large enough to receive the array of data structures and any strings or other data that the structure members point to. If the buffer is too small, the <i>pcbNeeded</i> parameter returns the required buffer size.

<p>
<b>Windows 95:</b> The buffer cannot receive <b>PRINTER_INFO_4</b> structures. It can receive any of the other types.
</dd>
<dt>
<i>cbBuf</i></dt>
<dd>
Specifies the size, in bytes, of the buffer pointed to by <i>pPrinterEnum.</i> </dd>
<dt>
<i>pcbNeeded</i></dt>
<dd>
Pointer to a value that receives the number of bytes copied if the function succeeds or the number of bytes required if <i>cbBuf</i> is too small. </dd>
<dt>
<i>pcReturned</i></dt>
<dd>
Pointer to a value that receives the number of <a href="prntspol_03g2.htm"><b>PRINTER_INFO_1</b></a>,<b> <a href="prntspol_9otu.htm">PRINTER_INFO_2</a></b>, <a href="prntspol_8vle.htm"><b>PRINTER_INFO_4</b></a>, or <a href="prntspol_8gz6.htm"><b>PRINTER_INFO_5</b></a> structures that the function returns in the array to which <i>pPrinterEnum</i> points. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
If <b>EnumPrinters</b> returns a <b>PRINTER_INFO_1</b> structure in which PRINTER_ENUM_CONTAINER is specified, this indicates that there is a hierarchy of printer objects. An application can enumerate the hierarchy by calling <b>EnumPrinters</b> again, setting <i>Name</i> to the value of the <b>PRINTER_INFO_1</b> structure's <b>pName</b> member. </p>
<p>
The <b>EnumPrinters</b> function does not retrieve security information. If <b>PRINTER_INFO_2</b> structures are returned in the array pointed to by <i>pPrinterEnum</i>, their <i>pSecurityDescriptor</i> members will be set to NULL. </p>
<p>
To get information about the default printer, call the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getprofilestring">
</object><a href=JavaScript:alink_2.Click()><b>GetProfileString</b></a> function with the section name string set to "windows" and the key name string set to "device". The returned string contains the name of the default printer, the name of the printer DRV file, and the port to which the printer is attached.</p>
<p>
<b>Windows NT:</b> The <b>PRINTER_INFO_4</b> structure provides an easy and extremely fast way to retrieve the names of the printers installed on a local machine, as well as the remote connections that a user has established. When <b>EnumPrinters</b> is called with a <b>PRINTER_INFO_4</b> data structure, that function queries the registry for the specified information, then returns immediately. This differs from the behavior of <b>EnumPrinters</b> when called with other levels of <b>PRINTER_INFO_*</b> data structures. In particular, when <b>EnumPrinters</b> is called with a level 2 (<b>PRINTER_INFO_2</b>) data structure, it performs an <b>OpenPrinter</b> call on each remote connection. If a remote connection is down, or the remote server no longer exists, or the remote printer no longer exists, the function must wait for RPC to time out and consequently fail the <b>OpenPrinter</b> call. This can take a while. Passing a <b>PRINTER_INFO_4</b> structure lets an application retrieve a bare minimium of required information; if more detailed information is desired, a subsequent <b>EnumPrinter</b> level 2 call can be made.</p>
<p>
<b>Windows 95: </b>To quickly enumerate local and network printers, use the <b>PRINTER_INFO_5</b> structure. This causes <b>EnumPrinters</b> to query the registry rather than make remote calls, and is similar to using the <b>PRINTER_INFO_4</b> structure on Windows NT as described in the preceding paragraph. </p>
<h4>Examples</h4>
<p>
The following table shows the <b>EnumPrinters</b> output for various <i>Flags</i> values when the <i>Level</i> parameter is set to 1. </p>
<p>
In the <i>Name</i> parameter column of the table, you should substitute an appropriate name for <i>Print Provider</i>, <i>Domain</i>, and <i>Machine</i>. For example, for <i>Print Provider</i>, you could use the name of the Windows NT network print provider: "Windows NT Remote Printers", or the name of the Windows 95 local print provider: "Windows 95 Local Print Provider". To get print provider names, call <b>EnumPrinters</b> with <i>Name</i> set to NULL. </p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=42%><i>Flags</i> parameter</th>
<th align=left width=34%><i>Name</i> parameter</th>
<th align=left width=24%>Result</th>
</tr>
<tr valign=top>
<td width=42%>PRINTER_ENUM_LOCAL</td>
<td width=34%>The <i>Name</i> parameter is ignored.</td>
<td width=24%>All local printers.<p>
<b>Windows 95:</b> Also enumerates network printers because they are installed locally.</p>
</td>
</tr>
<tr valign=top>
<td width=42%>PRINTER_ENUM_NAME</td>
<td width=34%>"<i>Print Provider</i>"</td>
<td width=24%>All domain names</td>
</tr>
<tr valign=top>
<td width=42%>PRINTER_ENUM_NAME</td>
<td width=34%><b>Windows NT:</b> <br>
"<i>Print Provider</i>!<i>Domain</i>"</td>
<td width=24%>All printers and print servers in the computer's domain</td>
</tr>
<tr valign=top>
<td width=42%>PRINTER_ENUM_NAME</td>
<td width=34%><b>Windows NT:</b> <br>
"<i>Print Provider</i>!!\\<i>Machine</i>"</td>
<td width=24%>All printers shared at \\Machine</td>
</tr>
<tr valign=top>
<td width=42%>PRINTER_ENUM_NAME</td>
<td width=34%><b>Windows NT:</b> An empty string, ""<p>
<b>Windows 95:</b> The name of the local machine or the local print provider.</p>
</td>
<td width=24%>All local printers.<p>
<b>Windows 95:</b> Also enumerates network printers because they are installed locally.</p>
</td>
</tr>
<tr valign=top>
<td width=42%>PRINTER_ENUM_NAME</td>
<td width=34%>NULL</td>
<td width=24%>All print providers in the computer's domain</td>
</tr>
<tr valign=top>
<td width=42%><b>Windows NT:</b> <br>
PRINTER_ENUM_CONNECTIONS </td>
<td width=34%>The <i>Name</i> parameter is ignored.</td>
<td width=24%>All connected remote printers</td>
</tr>
<tr valign=top>
<td width=42%><b>Windows NT:</b> <br>
PRINTER_ENUM_NETWORK </td>
<td width=34%>The <i>Name</i> parameter is ignored.</td>
<td width=24%>All printers in the computer's domain</td>
</tr>
<tr valign=top>
<td width=42%><b>Windows NT:</b> <br>
PRINTER_ENUM_REMOTE </td>
<td width=34%>An empty string, ""</td>
<td width=24%>All printers and print servers in the computer's domain</td>
</tr>
<tr valign=top>
<td width=42%><b>Windows NT:</b> <br>
PRINTER_ENUM_REMOTE </td>
<td width=34%>"<i>Print Provider</i>"</td>
<td width=24%>Same as PRINTER_ENUM_NAME</td>
</tr>
<tr valign=top>
<td width=42%><b>Windows NT:</b> <br>
PRINTER_ENUM_REMOTE </td>
<td width=34%>"<i>Print Provider</i>!<i>Domain</i>"</td>
<td width=24%>All printers and print servers in computer's domain, regardless of <i>Domain</i> specified.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winspool.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use winspool.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="prntspol_62ia.htm">Printing and Print Spooler Overview</a>, <a href="prntspol_7mgj.htm">Printing and Print Spooler Functions</a>, <a href="prntspol_1po2.htm"><b>AddPrinter</b></a>, <a href="prntspol_42eq.htm"><b>DeletePrinter</b></a>, <a href="prntspol_1gky.htm"><b>GetPrinter</b></a>, <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getprofilestring">
</object><a href=JavaScript:alink_3.Click()><b>GetProfileString</b></a>, <a href="prntspol_03g2.htm"><b>PRINTER_INFO_1</b></a>, <a href="prntspol_9otu.htm"><b>PRINTER_INFO_2</b></a>, <a href="prntspol_8vle.htm"><b>PRINTER_INFO_4</b></a>, <a href="prntspol_8gz6.htm"><b>PRINTER_INFO_5</b></a>, <a href="prntspol_13ua.htm"><b>SetPrinter</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
