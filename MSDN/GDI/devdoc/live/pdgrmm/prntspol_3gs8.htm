<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DeletePrinterDriverEx</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_deleteprinterdriverex"></a>DeletePrinterDriverEx</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>DeletePrinterDriverEx</b> is an extended version of the <b>DeletePrinterDriver</b> function. </p>
<p>
In addition to removing the specified printer-driver name from the list of names of supported drivers for a server, <b>DeletePrinterDriverEx</b> can also delete the files associated with the driver. </p>
<p>
The older <b>DeletePrinterDriver</b> deletes a driver only if no version of the driver is in use for the given environment. <b>DeletePrinterDriverEx</b> can delete specific versions of the driver.</p>
<pre><code><b>BOOL DeletePrinterDriverEx(
  LPTSTR</b><i> pName</i><b>,         </b>// pointer to server name
<b>  LPTSTR</b><i> pEnvironment</i><b>,  </b>// pointer to environment
<b>  LPTSTR</b><i> pDriverName</i><b>,</b>   // pointer to driver name
<b>  DWORD</b><i> dwDeleteFlag</i><b>,</b>   // options for deleting files and versions
<b>  DWORD</b><i> dwVersionFlag</i>   // version number to delete
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pName</i></dt>
<dd>
Pointer to a null-terminated string that specifies the name of the server from which the driver is to be deleted. If this parameter is NULL, the function deletes the printer-driver from the local computer. </dd>
<dt>
<i>pEnvironment</i></dt>
<dd>
Pointer to a null-terminated string that specifies the environment from which the driver is to be deleted (for example, "Windows NT x86", "Windows NT R4000", "Windows NT Alpha_AXP", or "Windows 4.0"). If this parameter is NULL, the driver name is deleted from the current environment of the calling application and client computer (not of the destination application and print server). </dd>
<dt>
<i>pDriverName</i></dt>
<dd>
Pointer to a null-terminated string specifying the name of the driver to delete. </dd>
<dt>
<i>dwDeleteFlag</i></dt>
<dd>
A set of bit flags that specify options for deleting files and versions of the driver. This parameter can be a combination of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=49%>Value</th>
<th align=left width=51%>Meaning</th>
</tr>
<tr valign=top>
<td width=49%>DPD_DELETE_SPECIFIC_VERSION</td>
<td width=51%>Deletes the version specified in <i>dwVersionFlag. </i>This does not ensure that the driver will be removed from the list of supported drivers for the server.</td>
</tr>
<tr valign=top>
<td width=49%>DPD_DELETE_UNUSED_FILES</td>
<td width=51%>Removes any unused driver files.</td>
</tr>
<tr valign=top>
<td width=49%>DPD_DELETE_ALL_FILES</td>
<td width=51%>Deletes the driver only if all its associated files can be removed. The delete operation fails if any of the driver's files are being used by some other installed driver. </td>
</tr>
</table><br>


<p>
If DPD_DELETE_SPECIFIC_VERSION is not specified, the function deletes all versions of the driver if none of them is in use. If neither DPD_DELETE_UNUSED_FILES nor DPD_DELETE_ALL_FILES is specified, the function does not delete driver files.
</dd>
<dt>
<i>dwVersionFlag</i></dt>
<dd>
Specifies the version of the driver to be deleted. This parameter can be 0, 1, 2 or 3. This parameter is used only if <i>dwDeleteFlag</i> includes the DPD_DELETE_SPECIFIC_VERSION flag.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
Before the function deletes the driver files, it calls the driver's <b>DrvDriverEvent</b> function, allowing the driver to remove any private files that are not used. For more information about <b>DrvDriverEvent</b>, see the Microsoft Windows NT Device Driver Kit documentation.</p>
<p>
If the driver files are currently loaded, the function moves them to a <i>temp</i> directory and marks them for deletion on reboot. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winspool.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use winspool.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="prntspol_62ia.htm">Printing and Print Spooler Overview</a>, <a href="prntspol_7mgj.htm">Printing and Print Spooler Functions</a>, <a href="prntspol_42pk.htm"><b>AddPrinterDriverEx</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
