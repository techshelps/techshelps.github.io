<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetFontData</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_getfontdata"></a>GetFontData</h1>
<p>
The <b>GetFontData</b> function retrieves font metric data for a TrueType font. </p>
<pre><code><b>DWORD GetFontData(
  HDC</b><i> hdc</i><b>,           </b>// handle to device context
<b>  DWORD</b><i> dwTable</i><b>,     </b>// metric table to query
<b>  DWORD</b><i> dwOffset</i><b>,    </b>// offset into table being queried
  <b>LPVOID</b> <i>lpvBuffer</i><b>,</b>  // pointer to buffer for returned data
<b>  DWORD</b><i> cbData</i>       // length of data to query
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hdc</i></dt>
<dd>
Handle to the device context. </dd>
<dt>
<i>dwTable</i></dt>
<dd>
Specifies the name of a font metric table from which the font data is to be retrieved. This parameter can identify one of the metric tables documented in the TrueType Font Files specification published by Microsoft Corporation. If this parameter is zero, the information is retrieved starting at the beginning of the font file. </dd>
<dt>
<i>dwOffset</i></dt>
<dd>
Specifies the offset from the beginning of the font metric table to the location where the function should begin retrieving information. If this parameter is zero, the information is retrieved starting at the beginning of the table specified by the <i>dwTable</i> parameter. If this value is greater than or equal to the size of the table, an error occurs. </dd>
<dt>
<i>lpvBuffer</i></dt>
<dd>
Pointer to a buffer to receive the font information. If this parameter is NULL, the function returns the size of the buffer required for the font data. </dd>
<dt>
<i>cbData</i></dt>
<dd>
Specifies the length, in bytes, of the information to be retrieved. If this parameter is zero, <b>GetFontData</b> returns the size of the data specified in the <i>dwTable</i> parameter. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the number of bytes returned.</p>
<p>
If the function fails, the return value is GDI_ERROR. </p>
<p>
<b>Windows NT:</b> To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
An application can sometimes use the <b>GetFontData</b> function to save a TrueType font with a document. To do this, the application determines whether the font can be embedded by checking the <b>otmfsType</b> member of the <b>OUTLINETEXTMETRIC</b> structure. If bit 1 of <b>otmfsType</b> is set, embedding is not permitted for the font. If bit 1 is clear, the font can be embedded. If bit 2 is set, the embedding is read-only. If embedding is permitted, the application can retrieve the entire font file, specifying zero for the <i>dwTable</i>, <i>dwOffset</i>, and <i>cbData</i> parameters. </p>
<p>
If an application attempts to use this function to retrieve information for a non-TrueType font, an error occurs. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in wingdi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use gdi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="fontext_8ctw.htm">Fonts and Text Overview</a>, <a href="fontext_9r77.htm">Font and Text Functions</a>, <a href="fontext_6rlf.htm"><b>GetTextMetrics</b></a>, <a href="fontext_569e.htm"><b>OUTLINETEXTMETRIC</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
