<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using a Print Dialog Box and Retrieving a Printer Device Context</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_using_a_print_dialog_box_and_retrieving_a_printer_device_context"></a>Using a Print Dialog Box and Retrieving a Printer Device Context</h2>
<p>
The first step in printing involves setting up the printer and obtaining a printer DC. In the sample application, the File menu contains two options, Print and Print Setup. By selecting either option, the user can configure the printer. When the user selects the Print Setup option, the Print Setup dialog box is displayed and the user can select a printer, a page orientation, a paper size, and so on. When the user selects the Print option, the Print dialog box is displayed and the user can select a range of pages, a print quality, a number of copies, and so on. The user can also display the Print Setup dialog box by clicking the Setup push button.</p>
<p>
The Print and Print Setup dialog boxes are both displayed by initializing the members of a <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_printdlg_str">
</object><a href=JavaScript:alink_1.Click()><b>PRINTDLG</b></a> structure and calling the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_printdlg">
</object><a href=JavaScript:alink_2.Click()><b>PrintDlg</b></a> function. (For more information about displaying the Print Setup dialog box, see <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_common_dialog_box_library">
</object><a href=JavaScript:alink_3.Click()>Common Dialog Box Library</a>). In addition to retrieving user-specified data, <b>PrintDlg</b> can be used to obtain a printer DC by specifying the PD_RETURNDC value in the <b>Flags</b> member of the <b>PRINTDLG</b> structure. The following code sample shows how to intialize the members of the structure and to display the Print dialog box. </p>
<pre><code>// Initialize the PRINTDLG members. 
 
pd.lStructSize = sizeof(PRINTDLG); 
pd.hDevMode = (HANDLE) NULL; 
pd.hDevNames = (HANDLE) NULL; 
pd.Flags = PD_RETURNDC; 
pd.hwndOwner = hwnd; 
pd.hDC = (HDC) NULL; 
pd.nFromPage = 1; 
pd.nToPage = 1; 
pd.nMinPage = 0; 
pd.nMaxPage = 0; 
pd.nCopies = 1; 
pd.hInstance = (HANDLE) NULL; 
pd.lCustData = 0L; 
pd.lpfnPrintHook = (LPPRINTHOOKPROC) NULL; 
pd.lpfnSetupHook = (LPSETUPHOOKPROC) NULL; 
pd.lpPrintTemplateName = (LPSTR) NULL; 
pd.lpSetupTemplateName = (LPSTR)  NULL; 
pd.hPrintTemplate = (HANDLE) NULL; 
pd.hSetupTemplate = (HANDLE) NULL; 
 
// Display the PRINT dialog box. 
 
PrintDlg(&amp;pd); 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
