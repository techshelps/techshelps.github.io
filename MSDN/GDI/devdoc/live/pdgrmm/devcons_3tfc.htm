<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ChangeDisplaySettingsEx</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_changedisplaysettingsex"></a>ChangeDisplaySettingsEx</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>ChangeDisplaySettingsEx</b> function changes the settings of the display device specified in the<i> lpszDeviceName</i> parameter to the graphics mode specified in the<i> lpDevMode</i> parameter. </p>
<pre><code><b>LONG ChangeDisplaySettingsEx(
  LPCSTR </b><i>lpszDeviceName</i><b>,</b>
<b>  LPDEVMODE</b><i> lpDevMode</i><b>,  </b>
<b>  HWND     </b><i>hwnd,</i>
<b>  DWORD</b><i> dwflags         </i>
<i>  </i><b>LPVOID</b><i> lParam</i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszDeviceNam</i>e</dt>
<dd>
Pointer to a null-terminated string that specifies the display device whose graphics mode the function will obtain information about. See <a href="devcons_2303.htm"><b>EnumDisplayDevices</b></a> for further information on the names associated with these display devices. 
<p>
The <i>lpszDeviceName </i>parameter can be NULL. A NULL value specifies the default display device. 
</dd>
<dt>
<i>lpDevMode</i></dt>
<dd>
Pointer to a <a href="prntspol_8nle.htm"><b>DEVMODE</b></a> structure that describes the graphics mode to switch to. The <b>dmSize</b> member must be initialized to the size, in bytes, of the <b>DEVMODE</b> structure. The <b>dmDriverExtra</b> member must be initialized to indicate the number of bytes of private driver data following the <b>DEVMODE</b> structure. 
<p>
You can use the following members of the <b>DEVMODE</b> structure.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>Member</th>
<th align=left width=55%>Meaning</th>
</tr>
<tr valign=top>
<td width=45%><b>dmBitsPerPel</b></td>
<td width=55%>Bits per pixel</td>
</tr>
<tr valign=top>
<td width=45%><b>dmPelsWidth</b></td>
<td width=55%>Pixel width</td>
</tr>
<tr valign=top>
<td width=45%><b>dmPelsHeight</b></td>
<td width=55%>Pixel height</td>
</tr>
<tr valign=top>
<td width=45%><b>dmDisplayFlags</b></td>
<td width=55%>Mode flags</td>
</tr>
<tr valign=top>
<td width=45%><b>dmDisplayFrequency</b></td>
<td width=55%>Mode frequency</td>
</tr>
<tr valign=top>
<td width=45%><b>dmPosition</b> </td>
<td width=55%><b>Windows 98, Windows NT 5.0 and later:</b> Position of the device in a multi-monitor configuration.</td>
</tr>
</table><br>


<p>
In addition to setting a value in one or more of the preceding <b>DEVMODE</b> members, you must also set the appropriate flags in the <b>dmFields</b> member. The flags indicate which members of the <b>DEVMODE</b> structure are used for the display settings change. If the appropriate bit is not set in <b>dmFields</b>, the display setting will not be changed. Set one or more of the following flags:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>Flag</th>
<th align=left width=55%>Meaning</th>
</tr>
<tr valign=top>
<td width=45%>DM_BITSPERPEL</td>
<td width=55%>Use the <b>dmBitsPerPel</b> value.</td>
</tr>
<tr valign=top>
<td width=45%>DM_PELSWIDTH</td>
<td width=55%>Use the <b>dmPelsWidth</b> value.</td>
</tr>
<tr valign=top>
<td width=45%>DM_PELSHEIGHT</td>
<td width=55%>Use the <b>dmPelsHeight</b> value.</td>
</tr>
<tr valign=top>
<td width=45%>DM_DISPLAYFLAGS</td>
<td width=55%>Use the <b>dmDisplayFlags</b> value.</td>
</tr>
<tr valign=top>
<td width=45%>DM_DISPLAYFREQUENCY</td>
<td width=55%>Use the <b>dmDisplayFrequency</b> value.</td>
</tr>
<tr valign=top>
<td width=45%>DM_POSITION </td>
<td width=55%><b>Windows 98, Windows NT 5.0 and later:</b> Use the <b>dmPosition</b> value.</td>
</tr>
</table><br>


<p>
If <i>lpDevMode</i> is NULL, all the values currently in the registry will be used for the display setting. Passing NULL for the <i>lpDevMode</i> parameter and 0 for the <i>dwFlags</i> parameter is the easiest way to return to the default mode after a dynamic mode change.
</dd>
<dt>
<i>hwnd</i></dt>
<dd>
Must be NULL.</dd>
<dt>
<i>dwflags</i></dt>
<dd>
Indicates how the graphics mode should be changed. The <i>dwflags</i> parameter can be one of the following.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Flag</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>0</td>
<td width=52%>The graphics mode for the current screen will be changed dynamically.</td>
</tr>
<tr valign=top>
<td width=48%>CDS_UPDATEREGISTRY</td>
<td width=52%>The graphics mode for the current screen will be changed dynamically and the graphics mode will be updated in the registry. The mode information is stored in the USER profile.</td>
</tr>
<tr valign=top>
<td width=48%>CDS_TEST</td>
<td width=52%>The system tests if the requested graphics mode could be set. </td>
</tr>
<tr valign=top>
<td width=48%>CDS_FULLSCREEN</td>
<td width=52%>The mode is temporary in nature. <p>
<b>Windows NT:</b> If you change to and from another desktop, this mode will not be reset. </p>
</td>
</tr>
<tr valign=top>
<td width=48%>CDS_GLOBAL</td>
<td width=52%>The settings will be saved in the global settings area so that they will affect all users on the machine. Otherwise, only the settings for the user are modified. This flag is only valid when specified with the CDS_UPDATEREGISTRY flag.</td>
</tr>
<tr valign=top>
<td width=48%>CDS_SET_PRIMARY</td>
<td width=52%>This device will become the primary device. </td>
</tr>
<tr valign=top>
<td width=48%>CDS_RESET</td>
<td width=52%>The settings should be changed, even if the requested settings are the same as the current settings. </td>
</tr>
<tr valign=top>
<td width=48%>CDS_SETRECT</td>
<td width=52%>The <i>lParam</i> message parameter specified in the <a href="pantdraw_2qzp.htm">WM_DISPLAYCHANGE</a> message sent to all applications should be treated as a pointer to a <a href="rectangl_6cqa.htm"><b>RECT</b></a> structure. This structure indicates the position of the display device in a multi-screen environment. An <i>lParam</i> of NULL means that the display device should be detached from the multi-screen environment. </td>
</tr>
<tr valign=top>
<td width=48%>CDS_NORESET</td>
<td width=52%>The settings will be saved in the registry, but will not take effect. This flag is only valid when specified with the CDS_UPDATEREGISTRY flag. </td>
</tr>
</table><br>


<p>
Specifying CDS_TEST allows an application to determine which graphics modes are actually valid, without causing the system to change to that graphics mode.

<p>
If CDS_UPDATEREGISTRY is specified and it is possible to change the graphics mode dynamically, the information is stored in the registry and DISP_CHANGE_SUCCESSFUL is returned. If it is not possible to change the graphics mode dynamically, the information is stored in the registry and DISP_CHANGE_RESTART is returned. 

<p>
<b>Windows NT:</b> If CDS_UPDATEREGISTRY is specified and the information could not be stored in the registry, the graphics mode is not changed and DISP_CHANGE_NOTUPDATED is returned.
</dd>
<dt>
<i>lParam</i></dt>
<dd>
Must be NULL.
</dd>
</dl>
<h4>Return Values</h4>
<p>
The <b>ChangeDisplaySettingsEx</b> function returns one of the following values.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Value</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>DISP_CHANGE_SUCCESSFUL</td>
<td width=52%>The settings change was successful.</td>
</tr>
<tr valign=top>
<td width=48%>DISP_CHANGE_RESTART</td>
<td width=52%>The computer must be restarted for the graphics mode to work.</td>
</tr>
<tr valign=top>
<td width=48%>DISP_CHANGE_BADFLAGS</td>
<td width=52%>An invalid set of flags was passed in.</td>
</tr>
<tr valign=top>
<td width=48%>DISP_CHANGE_BADPARAM</td>
<td width=52%>An invalid parameter was passed in. This can include an invalid flag or combination of flags.</td>
</tr>
<tr valign=top>
<td width=48%>DISP_CHANGE_FAILED</td>
<td width=52%>The display driver failed the specified graphics mode.</td>
</tr>
<tr valign=top>
<td width=48%>DISP_CHANGE_BADMODE</td>
<td width=52%>The graphics mode is not supported.</td>
</tr>
<tr valign=top>
<td width=48%>DISP_CHANGE_NOTUPDATED</td>
<td width=52%><b>Windows NT:</b> Unable to write settings to the registry.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
To ensure that the <a href="prntspol_8nle.htm"><b>DEVMODE</b></a> structure passed to <b>ChangeDisplaySettingsEx</b> is valid and contains only values supported by the display driver, use the <b>DEVMODE</b> returned by the <a href="devcons_84oj.htm"><b>EnumDisplaySettings</b></a> function.</p>
<p>
When the display mode is changed dynamically, the WM_DISPLAYCHANGE message is sent to all running applications with the following message parameters: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Parameters</th>
<th align=left width=52%>Meaning</th>
</tr>
<tr valign=top>
<td width=48%>wParam</td>
<td width=52%>New bits per pixel</td>
</tr>
<tr valign=top>
<td width=48%>LOWORD(lParam)</td>
<td width=52%>New pixel width</td>
</tr>
<tr valign=top>
<td width=48%>HIWORD(lParam)</td>
<td width=52%>New pixel height</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 98 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winuser.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use user32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="devcons_0g6r.htm">Device Contexts Overview</a>, <a href="devcons_7e2b.htm">Device Context Functions</a>, <a href="devcons_7gz7.htm"><b>ChangeDisplaySettings</b></a>, <a href="devcons_5g83.htm"><b>CreateDC</b></a>, <a href="prntspol_8nle.htm"><b>DEVMODE</b></a>, <a href="devcons_2303.htm"><b>EnumDisplayDevices</b></a>, <a href="devcons_84oj.htm"><b>EnumDisplaySettings</b></a>, <a href="pantdraw_2qzp.htm"><b>WM_DISPLAYCHANGE</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
