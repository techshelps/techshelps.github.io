<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Escape</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_escape_v3"></a>Escape</h1>
<p>
The <b>Escape</b> function allows applications to access capabilities of a particular device not directly available through GDI. Escape calls made by an application are translated and sent to the driver. </p>
<pre><code><b>int Escape(
  HDC</b><i> hdc</i><b>,           </b>// handle to device context
<b>  int</b><i> nEscape</i><b>,       </b>// escape function
<b>  int</b><i> cbInput</i><b>,       </b>// number of bytes in input structure
<b>  LPCSTR</b><i> lpvInData</i><b>,  </b>// pointer to input structure
<b>  LPVOID</b><i> lpvOutData</i>  // pointer to output structure
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hdc</i></dt>
<dd>
Handle to the device context. </dd>
<dt>
<i>nEscape</i></dt>
<dd>
Specifies the escape function to be performed. This parameter must be one of the predefined escape values. Use the <a href="prntspol_1zol.htm"><b>ExtEscape</b></a> function if your application defines a private escape value. </dd>
<dt>
<i>cbInput</i></dt>
<dd>
Specifies the number of bytes of data pointed to by the <i>lpvInData</i> parameter. </dd>
<dt>
<i>lpvInData</i></dt>
<dd>
Pointer to the input structure required for the specified escape. </dd>
<dt>
<i>lpvOutData</i></dt>
<dd>
Pointer to the structure that receives output from this escape. This parameter should be NULL if no data is returned. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is greater than zero, except with the QUERYESCSUPPORT printer escape, which checks for implementation only. If the escape is not implemented, the return value is zero. </p>
<p>
If the function fails, the return value is an error. </p>
<p>
<b>Windows NT:</b> To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. </p>
<h4>Errors</h4>
<p>
If the function fails, the return value is one of the following values. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=34%>Value</th>
<th align=left width=66%>Meaning</th>
</tr>
<tr valign=top>
<td width=34%>SP_ERROR</td>
<td width=66%>General error. If SP_ERROR is returned, <b>Escape </b>may set the last error code to:<p>
ERROR_INVALID_PARAMETER<br>
ERROR_DISK_FULL<br>
ERROR_NOT_ENOUGH_MEMORY<br>
ERROR_PRINT_CANCELLED</p>
</td>
</tr>
<tr valign=top>
<td width=34%>SP_OUTOFDISK</td>
<td width=66%>Not enough disk space is currently available for spooling, and no more space will become available.</td>
</tr>
<tr valign=top>
<td width=34%>SP_OUTOFMEMORY</td>
<td width=66%>Not enough memory is available for spooling.</td>
</tr>
<tr valign=top>
<td width=34%>SP_USERABORT</td>
<td width=66%>The user terminated the job through Print Manager.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The Win32 API provides six new functions that supersede some printer escapes: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=22%>Function</th>
<th align=left width=78%>Description</th>
</tr>
<tr valign=top>
<td width=22%><a href="prntspol_86xv.htm"><b>AbortDoc</b></a></td>
<td width=78%>Terminates a print job. Supersedes the ABORTDOC escape.</td>
</tr>
<tr valign=top>
<td width=22%><a href="prntspol_0qhv.htm"><b>EndDoc</b></a></td>
<td width=78%>Ends a print job. Supersedes the ENDDOC escape.</td>
</tr>
<tr valign=top>
<td width=22%><a href="prntspol_3b1h.htm"><b>EndPage</b></a></td>
<td width=78%>Ends a page. Supersedes the NEWFRAME escape. Unlike NEWFRAME, this function is always called after printing a page.</td>
</tr>
<tr valign=top>
<td width=22%><a href="prntspol_0883.htm"><b>SetAbortProc</b></a></td>
<td width=78%>Sets the abort function for a print job. Supersedes the SETABORTPROC escape.</td>
</tr>
<tr valign=top>
<td width=22%><a href="prntspol_95sz.htm"><b>StartDoc</b></a></td>
<td width=78%>Starts a print job. Supersedes the STARTDOC escape.</td>
</tr>
<tr valign=top>
<td width=22%><a href="prntspol_2isl.htm"><b>StartPage</b></a></td>
<td width=78%>Prepares printer driver to receive data.</td>
</tr>
</table><br>
<p>
The Win32 API provides six new indexes for the <b>GetDeviceCaps</b> function that supersede some printer escapes: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%>Index</th>
<th align=left width=68%>Description</th>
</tr>
<tr valign=top>
<td width=32%>PHYSICALWIDTH</td>
<td width=68%>For printing devices: the width of the physical page, in device units. For example, a printer set to print at 600 dpi on 8.5"x11" paper has a physical width value of 5100 device units. Note that the physical page is almost always greater than the printable area of the page, and never smaller. </td>
</tr>
<tr valign=top>
<td width=32%>PHYSICALHEIGHT</td>
<td width=68%>For printing devices: the height of the physical page, in device units. For example, a printer set to print at 600 dpi on 8.5"x11" paper has a physical height value of 6600 device units. Note that the physical page is almost always greater than the printable area of the page, and never smaller.</td>
</tr>
<tr valign=top>
<td width=32%>PHYSICALOFFSETX</td>
<td width=68%>For printing devices: the distance  from the left edge of the physical page to the left edge of the printable area, in device units. For example, a printer set to print at 600 dpi on 8.5"x11" paper, that cannot print on the leftmost 0.25" of paper, has a horizontal physical offset of 150 device  units.</td>
</tr>
<tr valign=top>
<td width=32%>PHYSICALOFFSETY</td>
<td width=68%>For printing devices: the distance from the top edge of the physical page to the top edge of the printable area, in device units. For example, a printer set to print at 600 dpi on 8.5"x11" paper, that cannot print on the topmost 0.5" of paper, has a vertical physical offset of 300 device units.</td>
</tr>
</table><br>
<p>
Of the original printer escapes, only the following can be used by Win32-based applications:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=34%>Escape</th>
<th align=left width=66%>Description</th>
</tr>
<tr valign=top>
<td width=34%>QUERYESCSUPPORT</td>
<td width=66%>Determines whether a particular escape is implemented by the device driver.</td>
</tr>
</table><br>
<p>
Following is a list of the obsolete printer escapes that are supported only for compatibility with 16-bit versions of Windows: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=34%>Escape</th>
<th align=left width=66%>Description</th>
</tr>
<tr valign=top>
<td width=34%>ABORTDOC</td>
<td width=66%>Stops the current print job and erases everything the application has written to the device since the last ENDDOC escape.</td>
</tr>
<tr valign=top>
<td width=34%>ENDDOC</td>
<td width=66%>Ends a print job started by the STARTDOC escape.</td>
</tr>
<tr valign=top>
<td width=34%>GETPHYSPAGESIZE</td>
<td width=66%>Retrieves the physical page size and copies it to the specified location.</td>
</tr>
<tr valign=top>
<td width=34%>GETPRINTINGOFFSET</td>
<td width=66%>Retrieves the offset from the upper-left corner of the physical page where the actual printing or drawing begins.</td>
</tr>
<tr valign=top>
<td width=34%>GETSCALINGFACTOR</td>
<td width=66%>Retrieves the scaling factors for the x-axis and the y-axis of a printer.</td>
</tr>
<tr valign=top>
<td width=34%>NEWFRAME</td>
<td width=66%>Informs the printer that the application has finished writing to a page.</td>
</tr>
<tr valign=top>
<td width=34%>NEXTBAND</td>
<td width=66%>Informs the printer that the application has finished writing to a band.</td>
</tr>
<tr valign=top>
<td width=34%>PASSTHROUGH</td>
<td width=66%>Allows the application to send data directly to a printer.</td>
</tr>
<tr valign=top>
<td width=34%>SETABORTPROC</td>
<td width=66%>Sets the Abort function for a print job.</td>
</tr>
<tr valign=top>
<td width=34%>STARTDOC</td>
<td width=66%>Informs a printer driver that a new print job is starting.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in wingdi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use gdi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="prntspol_62ia.htm">Printing and Print Spooler Overview</a>, <a href="prntspol_7mgj.htm">Printing and Print Spooler Functions</a>, <a href="prntspol_86xv.htm"><b>AbortDoc</b></a>, <a href="prntspol_0qhv.htm"><b>EndDoc</b></a>, <a href="prntspol_3b1h.htm"><b>EndPage</b></a>, <a href="prntspol_1zol.htm"><b>ExtEscape</b></a>, <a href="prntspol_0883.htm"><b>SetAbortProc</b></a>, <a href="prntspol_95sz.htm"><b>StartDoc</b></a>, <a href="prntspol_2isl.htm"><b>StartPage</b></a>, <a href="devcons_0d43.htm"><b>ResetDC</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
