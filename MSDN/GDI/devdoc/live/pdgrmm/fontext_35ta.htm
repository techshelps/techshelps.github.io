<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Font Creation and Selection</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_font_creation_and_selection"></a>Font Creation and Selection</h2>
<p>
The <b>Font</b> common dialog box simplifies the process of creating and selecting fonts. By initializing the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_choosefont_str">
</object><a href=JavaScript:alink_1.Click()><b>CHOOSEFONT</b></a> structure and calling the <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_choosefont">
</object><a href=JavaScript:alink_2.Click()><b>ChooseFont</b></a> function, an application can support the same font-selection interface that previously required many lines of custom code. (For more information about the <b>Font</b> common dialog box, see <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_common_dialog_box_library">
</object><a href=JavaScript:alink_3.Click()>Common Dialog Box Library</a>.)</p>
<h4>Selection by the User</h4>
<p>
Most font creation and selection operations involve the user. For example, word processing applications let the user select unique fonts for headings, footnotes, and body text. After the user selects a font by using the Font dialog box and presses the OK button, the <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_choosefont">
</object><a href=JavaScript:alink_4.Click()><b>ChooseFont</b></a> function initializes the members of a <a href="fontext_1wmq.htm"><b>LOGFONT</b></a> structure with the attributes of the requested font. To use this font for text-output operations, an application must first create a logical font and then select that font into its device context. A <i>logical font</i> is an application-supplied description of an ideal font. A developer can create a logical font by calling the <a href="fontext_8fp0.htm"><b>CreateFont</b></a> or the <a href="fontext_4rw4.htm"><b>CreateFontIndirect</b></a> functions. In this case, the application would call <b>CreateFontIndirect</b> and supply a pointer to the <b>LOGFONT</b> structure initialized by <b>ChooseFont</b>. In general, it is more efficient to call <b>CreateFontIndirect</b> because <b>CreateFont</b> requires several parameters while <b>CreateFontIndirect</b> requires only one — a pointer to <b>LOGFONT</b>. </p>
<p>
Before an application can actually begin drawing text with a logical font, it must find the closest match from the fonts stored internally on the device and the fonts whose resources have been loaded into the operating system. The fonts stored on the device or in the operating system are called <i>physical fonts</i>. The process of finding the physical font that most closely matches a specified logical font is called font mapping. This process occurs when an application calls the <a href="devcons_9v3o.htm"><b>SelectObject</b></a> function and supplies a handle identifying a logical font. Font mapping is performed by using an internal algorithm that compares the attributes of the requested logical font against the attributes of available physical fonts. When the font mapper algorithm completes its search and determines the closest possible match, the <b>SelectObject</b> function returns and the application can begin drawing text with the new font. </p>
<p>
The <a href="fontext_3e43.htm"><b>SetMapperFlags</b></a> function specifies whether or not the font mapper algorithm searches only for physical fonts with aspect ratios that match the physical device. The aspect ratio for a device is the ratio formed by the width and the height of a pixel on that device. </p>
<p>&nbsp;</p></body>
</HTML>
