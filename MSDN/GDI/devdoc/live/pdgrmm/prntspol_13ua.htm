<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetPrinter</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_setprinter"></a>SetPrinter</h1>
<p>
The <b>SetPrinter</b> function sets the data for a specified printer or sets the state of the specified printer by pausing printing, resuming printing, or clearing all print jobs. </p>
<pre><code><b>BOOL SetPrinter(
  HANDLE</b><i> hPrinter</i><b>,  </b>// handle to printer object
<b>  DWORD</b><i> Level</i><b>,      </b>// structure level
<b>  LPBYTE</b><i> pPrinter</i><b>,  </b>// pointer to array containing printer data
<b>  DWORD</b><i> Command</i>     // printer-state command
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hPrinter</i></dt>
<dd>
Handle to the printer. Use the <a href="prntspol_9qnm.htm"><b>OpenPrinter</b></a> function to retrieve a printer handle.</dd>
<dt>
<i>Level</i></dt>
<dd>
Specifies the type of data that the function stores into the buffer pointed to by <i>pPrinter</i>. If the <i>Command</i> parameter is not equal to zero, the <i>Level</i> parameter must be zero. 
<p>
<b>Windows 95:</b> This value can be 0, 1, 2, or 5.

<p>
<b>Windows NT:</b> This value can be 0, 1, 2, 3, 4, 5, or 7.
</dd>
<dt>
<i>pPrinter</i></dt>
<dd>
Pointer to a buffer containing data to set for the printer, or containing information for the command specified by the <i>Command</i> parameter. The type of data in the buffer is determined by the value of <i>Level</i>. 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=12%>Level</th>
<th align=left width=88%>Structure</th>
</tr>
<tr valign=top>
<td width=12%>0</td>
<td width=88%>If the <i>Command</i> parameter is PRINTER_CONTROL_SET_STATUS, <i>pPrinter</i> must contain a <b>DWORD</b> value that specifies the new printer status to set. For a list of the possible status values, see the <b>Status</b> member of the <a href="prntspol_9otu.htm"><b>PRINTER_INFO_2</b></a> structure. Note that PRINTER_STATUS_PAUSED and PRINTER_STATUS_PENDING_DELETION are not valid status values to set. <p>
If <i>Level</i> is 0, but the <i>Command</i> parameter is not PRINTER_CONTROL_SET_STATUS, <i>pPrinter</i> must be NULL. </p>
</td>
</tr>
<tr valign=top>
<td width=12%>1</td>
<td width=88%>A <a href="prntspol_03g2.htm"><b>PRINTER_INFO_1</b></a> structure containing general printer information.</td>
</tr>
<tr valign=top>
<td width=12%>2</td>
<td width=88%>A <a href="prntspol_9otu.htm"><b>PRINTER_INFO_2</b></a> structure containing detailed information about the printer.</td>
</tr>
<tr valign=top>
<td width=12%>3</td>
<td width=88%><b>Windows NT:</b> A <a href="prntspol_9a7m.htm"><b>PRINTER_INFO_3</b></a> structure containing the printer's security information. </td>
</tr>
<tr valign=top>
<td width=12%>4</td>
<td width=88%><b>Windows NT:</b> A <a href="prntspol_8vle.htm"><b>PRINTER_INFO_4</b></a> structure containing minimal printer information, including the name of the printer, the name of the server, and whether the printer is remote or local.</td>
</tr>
<tr valign=top>
<td width=12%>5</td>
<td width=88%>A <a href="prntspol_8gz6.htm"><b>PRINTER_INFO_5</b></a> structure containing printer information such as printer attributes and time-out settings.</td>
</tr>
<tr valign=top>
<td width=12%>7</td>
<td width=88%><b>Windows NT 5.0 and later:</b> A <a href="prntspol_7nqq.htm"><b>PRINTER_INFO_7</b></a> structure. The <b>dwAction</b> member of this structure indicates whether <b>SetPrinter</b> should publish, unpublish, or update the printer's data in the directory service.</td>
</tr>
</table><br>

</dd>
<dt>
<i>Command</i></dt>
<dd>
Specifies the action performed by the <b>SetPrinter</b> function. 
<p>
If the <i>Level</i> parameter is nonzero, <i>Command</i> must be zero. In this case, the printer retains its current state and the function reconfigures the printer data as specified by the <i>Level</i> and <i>pPrinter</i> parameters.

<p>
If the <i>Level</i> parameter is zero, <i>Command</i> can be one of the following values to set the state of the printer. 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=52%>Value</th>
<th align=left width=48%>Meaning</th>
</tr>
<tr valign=top>
<td width=52%>PRINTER_CONTROL_PAUSE</td>
<td width=48%>Pauses the printer.</td>
</tr>
<tr valign=top>
<td width=52%>PRINTER_CONTROL_PURGE</td>
<td width=48%>Deletes all print jobs in the printer.</td>
</tr>
<tr valign=top>
<td width=52%>PRINTER_CONTROL_RESUME</td>
<td width=48%>Resumes a paused printer.</td>
</tr>
<tr valign=top>
<td width=52%>PRINTER_CONTROL_SET_STATUS</td>
<td width=48%>Sets the printer status. The <i>pPrinter</i> parameter points to a <b>DWORD</b> that specifies the new printer status.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
To modify the current printer settings, call the <a href="prntspol_1gky.htm"><b>GetPrinter</b></a> function to retrieve the current settings into a <a href="prntspol_9otu.htm"><b>PRINTER_INFO_2</b></a> structure, modify the members of that structure as necessary, and then call <b>SetPrinter</b>. </p>
<p>
The <b>SetPrinter</b> function ignores the <b>pServerName</b>, <b>AveragePPM</b>, <b>Status</b>, and <b>cJobs</b> members of a <b>PRINTER_INFO_2</b> structure. </p>
<p>
Pausing a printer suspends scheduling of all print jobs for that printer, except for the one print job that may be currently printing. Print jobs can be submitted to a paused printer, but no jobs will be scheduled to print on that printer until printing is resumed. If a printer is cleared, all print jobs for that printer are deleted, except for the current print job. </p>
<p>
<b>Windows NT: </b>For the <a href="prntspol_9otu.htm"><b>PRINTER_INFO_2</b></a> and <a href="prntspol_9a7m.htm"><b>PRINTER_INFO_3</b></a> structures that contain a pointer to a security descriptor, the function can set only those components of the security descriptor that the caller has permission to modify. To set particular security descriptor components, you must specify the necessary access rights when you call the <a href="prntspol_9qnm.htm"><b>OpenPrinter</b></a> function to retrieve a handle to the printer. The following table shows the access rights required to modify the various security descriptor components.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>Access right</th>
<th align=left width=55%>Security Descriptor Component</th>
</tr>
<tr valign=top>
<td width=45%>WRITE_OWNER</td>
<td width=55%>Owner<br>
Primary proup</td>
</tr>
<tr valign=top>
<td width=45%>WRITE_DAC</td>
<td width=55%>Discretionary access-control list (DACL)</td>
</tr>
<tr valign=top>
<td width=45%>ACCESS_SYSTEM_SECURITY</td>
<td width=55%>System access-control list (SACL)</td>
</tr>
</table><br>
<p>
If the security descriptor contains a component that the caller does not have the access right to modify, <b>SetPrinter</b> fails. Those components of a security descriptor that you don't want to modify should be NULL or not be present, as appropriate. If you do not want to modify the security descriptor, and are calling <b>SetPrinter </b>with a <b>PRINTER_INFO_2 </b>structure, set the <b>pSecurityDescriptor</b> member of that structure to NULL. </p>
<p>
<b>Windows NT 5.0 and later: </b>You can use level 7 with the <a href="prntspol_7nqq.htm"><b>PRINTER_INFO_7</b></a> structure to publish, unpublish, or update directory service data for the printer. The directory service data for a printer includes all the data stored under the SPLDS_* keys by calls to the <a href="prntspol_6o1k.htm"><b>SetPrinterDataEx</b></a> function for the printer. Before calling <b>SetPrinter</b>, set the <b>pszObjectGUID</b> member of <b>PRINTER_INFO_7</b> to NULL and set the <b>dwAction</b> member to one of the following values.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=35%>Value</th>
<th align=left width=65%>Description</th>
</tr>
<tr valign=top>
<td width=35%>DSPRINT_PUBLISH</td>
<td width=65%>Publish the directory service data.</td>
</tr>
<tr valign=top>
<td width=35%>DSPRINT_UNPUBLISH</td>
<td width=65%>Unpublish the directory service data.</td>
</tr>
<tr valign=top>
<td width=35%>DSPRINT_UPDATE</td>
<td width=65%>Update the directory service data. This is the same as DSPRINT_PUBLISH, except that <b>SetPrinter</b> fails with ERROR_FILE_NOT_FOUND if the printer is not already published. <p>
Use DSPRINT_UPDATE to update published properties but not force publishing. Printer drivers should always use DSPRINT_UPDATE rather than DSPRINT_PUBLISH.</p>
</td>
</tr>
</table><br>
<p>
<b>Windows 95:</b> <b>SetPrinter</b> does not update the <b>pShareName</b> member in the <b>PRINTER_INFO_2</b> structure.</p>
<p>
You cannot call <b>SetPrinter</b> from a Windows 95 computer to set the data for a Windows NT printer using the printer's UNC name.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winspool.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use winspool.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="prntspol_62ia.htm">Printing and Print Spooler Overview</a>, <a href="prntspol_7mgj.htm">Printing and Print Spooler Functions</a>, <a href="prntspol_1po2.htm"><b>AddPrinter</b></a>, <a href="prntspol_1gky.htm"><b>GetPrinter</b></a>, <a href="prntspol_9qnm.htm"><b>OpenPrinter</b></a>, <a href="prntspol_9otu.htm"><b>PRINTER_INFO_2</b></a>, <a href="prntspol_9a7m.htm"><b>PRINTER_INFO_3</b></a>, <a href="prntspol_8vle.htm"><b>PRINTER_INFO_4</b></a>, <a href="prntspol_8gz6.htm"><b>PRINTER_INFO_5</b></a>, <a href="prntspol_7nqq.htm"><b>PRINTER_INFO_7</b></a>, <a href="prntspol_6o1k.htm"><b>SetPrinterDataEx</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
