<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AddMonitor</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_addmonitor"></a>AddMonitor</h1>
<p>
The <b>AddMonitor</b> function installs a local printer monitor and links the configuration, data, and monitor files. </p>
<pre><code><b>BOOL AddMonitor(
  LPTSTR</b><i> pName</i><b>,      </b>// pointer to server name
<b>  DWORD</b><i> Level</i><b>,       </b>// monitor info. structure level
<b>  LPBYTE</b><i> pMonitors</i>   // pointer to monitor info. structure
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pName</i></dt>
<dd>
Pointer to a null-terminated string that specifies the name of the server on which the monitor should be installed. For this release of Windows NT, monitors may only be installed locally, so this string should be NULL. </dd>
<dt>
<i>Level</i></dt>
<dd>
Specifies the version of the structure to which <i>pMonitors</i> points. This value must be 2. </dd>
<dt>
<i>pMonitors</i></dt>
<dd>
Pointer to a <a href="prntspol_4xgy.htm"><b>MONITOR_INFO_2</b></a> structure.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
Before an application calls the <b>AddMonitor </b>function, all files required by the monitor must be copied to the SYSTEM32 directory. </p>
<p>
An application can determine which printer monitors are currently installed by calling the <b>EnumMonitors</b> function. </p>
<p>
A monitor added by <b>AddMonitor</b> may be removed by calling <b>DeleteMonitor</b>. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winspool.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use winspool.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="prntspol_62ia.htm">Printing and Print Spooler Overview</a>, <a href="prntspol_7mgj.htm">Printing and Print Spooler Functions</a>, <a href="prntspol_1a5u.htm"><b>DeleteMonitor</b></a>, <a href="prntspol_17qr.htm"><b>EnumMonitors</b></a>, <a href="prntspol_4xgy.htm"><b>MONITOR_INFO_2</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
