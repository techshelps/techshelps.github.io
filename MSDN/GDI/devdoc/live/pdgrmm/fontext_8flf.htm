<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Metrics for Portable Documents</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_metrics_for_portable_documents"></a>Metrics for Portable Documents</h3>
<p>
The following table specifies the most important font metrics for applications that require portable documents and the functions that allow an application to retrieve them. </p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=33%>Function</th>
<th align=left width=30%>Metric</th>
<th align=left width=37%>Use</th>
</tr>
<tr valign=top>
<td width=33%><a href="fontext_2z03.htm"><b>EnumFontFamilies</b></a></td>
<td width=30%><b>ntmSizeEM</b></td>
<td width=37%>Retrieval of design metrics; conversion to device metrics </td>
</tr>
<tr valign=top>
<td width=33%><a href="fontext_8icz.htm"><b>GetCharABCWidths</b></a></td>
<td width=30%><b>ABCWidths</b></td>
<td width=37%>Accurate placement of characters at the start and end of margins, picture boundaries, and other text breaks </td>
</tr>
<tr valign=top>
<td width=33%><a href="fontext_5cz6.htm"><b>GetCharWidth32</b></a></td>
<td width=30%><b>AdvanceWidths</b></td>
<td width=37%>Placement of characters on a line </td>
</tr>
<tr valign=top>
<td width=33%><a href="fontext_6lyr.htm"><b>GetOutlineTextMetrics</b></a></td>
<td width=30%><b>otmfsType</b></td>
<td width=37%>Font-embedding bits </td>
</tr>
<tr valign=top>
<td width=33%></td>
<td width=30%><b>otmsCharSlopeRise</b></td>
<td width=37%>Y-component for slope of cursor for italic fonts </td>
</tr>
<tr valign=top>
<td width=33%></td>
<td width=30%><b>otmsCharSlopeRun</b></td>
<td width=37%>X-component for slope of cursor for italic fonts </td>
</tr>
<tr valign=top>
<td width=33%></td>
<td width=30%><b>otmAscent</b></td>
<td width=37%>Line spacing </td>
</tr>
<tr valign=top>
<td width=33%></td>
<td width=30%><b>otmDescent</b></td>
<td width=37%>Line spacing </td>
</tr>
<tr valign=top>
<td width=33%></td>
<td width=30%><b>otmLineGap</b></td>
<td width=37%>Line spacing </td>
</tr>
<tr valign=top>
<td width=33%></td>
<td width=30%><b>otmpFamilyName</b></td>
<td width=37%>Font identification </td>
</tr>
<tr valign=top>
<td width=33%></td>
<td width=30%><b>otmpStyleName</b></td>
<td width=37%>Font identification </td>
</tr>
<tr valign=top>
<td width=33%></td>
<td width=30%><b>otmpFullName</b></td>
<td width=37%>Font identification (typically, family and style name) </td>
</tr>
</table><br>
<p>
The <b>otmsCharSlopeRise</b>, <b>otmsCharSlopeRun</b>, <b>otmAscent</b>, <b>otmDescent</b>, and <b>otmLineGap</b> members of the <a href="fontext_569e.htm"><b>OUTLINETEXTMETRIC</b></a> structure are scaled or transformed to correspond to the current device mode and physical height (as given in the <b>tmHeight</b> member of the <a href="fontext_2zqq.htm"><b>NEWTEXTMETRIC</b></a> structure). </p>
<p>
Font identification is important in those instances when an application must select the same font — for example, when a document is reopened or moved to a different operating system. The font mapper always selects the correct font when an application requests a font by full name. The family and style names provide input to the standard font dialog box, which ensures that the selection bars are properly placed. </p>
<p>
The <b>otmsCharSlopeRise</b> and <b>otmsCharSlopeRun</b> values are used to produce a close approximation of the main italic angle of the font. For typical roman fonts, <b>otmsCharSlopeRise</b> is 1 and <b>otmsCharSlopeRun</b> is 0. For italic fonts, the values attempt to approximate the sine and cosine of the main italic angle of the font (in counterclockwise degrees past vertical); note that the italic angle for upright fonts is 0. Because these values are not expressed in design units, they should not be converted into device units. </p>
<p>
The character placement and line spacing metrics enable an application to compute device-independent line breaks that are portable across screens, printers, typesetters, and even platforms. </p>
<p>
Device-independent page layout requires the following seven basic steps: 
<ol>
<li>
Normalize all design metrics to a common ultra-high resolution (UHR) value (for example, 65,536 DPI); this prevents round-off errors. </li>
<li>
Compute line breaks based on UHR metrics and physical page width; this yields a starting point and an ending point of a line within the text stream. </li>
<li>
Compute the device page width in device units (for example, pixels). </li>
<li>
Fit each line of text into the device page width, using the line breaks computed in step 2. </li>
<li>
Compute page breaks by using UHR metrics and the physical page length; this yields the number of lines per page. </li>
<li>
Compute the line heights in device units. </li>
<li>
Fit the lines of text onto the page, using the lines per page from step 5 and the line heights from step 6. </li>
</ol>
<p>
If all applications adopt these techniques, developers can virtually guarantee that documents moved from one application to another will retain their original appearance and format. </p>
<p>&nbsp;</p></body>
</HTML>
