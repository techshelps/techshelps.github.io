<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>StretchDIBits</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_stretchdibits"></a>StretchDIBits</h1>
<p>
The <b>StretchDIBits</b> function copies the color data for a rectangle of pixels in a device-independent bitmap (DIB) to the specified destination rectangle. If the destination rectangle is larger than the source rectangle, this function stretches the rows and columns of color data to fit the destination rectangle. If the destination rectangle is smaller than the source rectangle, this function compresses the rows and columns by using the specified raster operation. </p>
<pre><code><b>int StretchDIBits(
  HDC</b><i> hdc</i><b>,                </b>// handle to device context
<b>  int</b><i> XDest</i><b>,              </b>// x-coordinate of upper-left corner of dest. rectangle
<b>  int</b><i> YDest</i><b>,              </b>// y-coordinate of upper-left corner of dest. rectangle
<b>  int</b><i> nDestWidth</i><b>,         </b>// width of destination rectangle
<b>  int</b><i> nDestHeight</i><b>,        </b>// height of destination rectangle
<b>  int</b><i> XSrc</i><b>,               </b>// x-coordinate of upper-left corner of source rectangle
<b>  int</b><i> YSrc</i><b>,               </b>// y-coordinate of upper-left corner of source rectangle
<b>  int</b><i> nSrcWidth</i><b>,          </b>// width of source rectangle
<b>  int</b><i> nSrcHeight</i><b>,         </b>// height of source rectangle
<b>  CONST VOID</b><i> *lpBits</i><b>,            </b>// address of bitmap bits
<b>  CONST BITMAPINFO</b><i> *lpBitsInfo</i><b>,  </b>// address of bitmap data
<b>  UINT</b><i> iUsage</i><b>,                   </b>// usage flags
<b>  DWORD</b><i> dwRop</i>                    // raster operation code
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hdc</i></dt>
<dd>
Handle to the destination device context. </dd>
<dt>
<i>XDest</i></dt>
<dd>
Specifies the x-coordinate, in logical units, of the upper-left corner of the destination rectangle. </dd>
<dt>
<i>YDest</i></dt>
<dd>
Specifies the y-coordinate, in logical units, of the upper-left corner of the destination rectangle. </dd>
<dt>
<i>nDestWidth</i></dt>
<dd>
Specifies the width, in logical units, of the destination rectangle. </dd>
<dt>
<i>nDestHeight</i></dt>
<dd>
Specifies the height, in logical units, of the destination rectangle. </dd>
<dt>
<i>XSrc</i></dt>
<dd>
Specifies the x-coordinate, in pixels, of the source rectangle in the DIB. </dd>
<dt>
<i>YSrc</i></dt>
<dd>
Specifies the y-coordinate, in pixels, of the source rectangle in the DIB. </dd>
<dt>
<i>nSrcWidth</i></dt>
<dd>
Specifies the width, in pixels, of the source rectangle in the DIB. </dd>
<dt>
<i>nSrcHeight</i></dt>
<dd>
Specifies the height, in pixels, of the source rectangle in the DIB. </dd>
<dt>
<i>lpBits</i></dt>
<dd>
Pointer to the DIB bits, which are stored as an array of bytes. For more information, see the following Remarks section.</dd>
<dt>
<i>lpBitsInfo</i></dt>
<dd>
Pointer to a <a href="bitmaps_0zn6.htm"><b>BITMAPINFO</b></a> structure that contains information about the DIB. </dd>
<dt>
<i>iUsage</i></dt>
<dd>
Specifies whether the <b>bmiColors</b> member of the <b>BITMAPINFO</b> structure was provided and, if so, whether <b>bmiColors</b> contains explicit red, green, blue (RGB) values or indexes. The <i>iUsage</i> parameter must be one of the following values. 
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=33%>Value</th>
<th align=left width=67%>Meaning</th>
</tr>
<tr valign=top>
<td width=33%>DIB_PAL_COLORS</td>
<td width=67%>The array contains 16-bit indexes into the logical palette of the source device context.</td>
</tr>
<tr valign=top>
<td width=33%>DIB_RGB_COLORS</td>
<td width=67%>The color table contains literal RGB values. </td>
</tr>
</table><br>


<p>
For more information, see the following Remarks section. 
</dd>
<dt>
<i>dwRop</i></dt>
<dd>
Specifies how the source pixels, the destination device context's current brush, and the destination pixels are to be combined to form the new image. For more information, see the following Remarks section. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is the number of scan lines copied.</p>
<p>
If the function fails, the return value is GDI_ERROR. </p>
<p>
<b>Windows NT:</b> To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. </p>
<p>
<b>Windows 98, Windows NT 5.0 and later:</b> If the driver cannot support the JPEG file image passed to <b>StretchDIBits</b>, the function will fail and return GDI_ERROR.</p>
<h4>Remarks</h4>
<p>
The origin of a bottom-up DIB is the bottom-left corner; the origin of a top-down DIB is the upper-left corner. </p>
<p>
<b>StretchDIBits</b> creates a mirror image of a bitmap if the signs of the <i>nSrcWidth</i> and <i>nDestWidth</i> parameters, or if the <i>nSrcHeight</i> and <i>nDestHeight</i> parameters differ. If <i>nSrcWidth</i> and <i>nDestWidth</i> have different signs, the function creates a mirror image of the bitmap along the x-axis. If <i>nSrcHeight</i> and <i>nDestHeight</i> have different signs, the function creates a mirror image of the bitmap along the y-axis. </p>
<p>
<b>Windows 98, Windows NT 5.0 and later: </b>This function allows a JPEG image to be passed as the source image. How each parameter is used remains the same.</p>
<p class=indent1>
If the <b>biCompression</b> member of <a href="bitmaps_1rw2.htm"><b>BITMAPINFOHEADER</b></a> is BI_JPEG, <i>lpBits</i> points to a buffer containing a JPEG image. The <b>BITMAPINFOHEADER</b>'s <i>biSizeImage</i> member specifies the size of the buffer. The <i>iUsage</i> parameter must be set to DIB_RGB_COLORS. The <i>dwRop parameter </i>must be set to SRCCOPY.</p>
<p class=indent1>
If the <b>bV4Compression</b> member of <a href="bitmaps_2k1e.htm"><b>BITMAPV4HEADER</b></a><b> </b>is BI_JPEG, <i>lpBits</i> points to a buffer containing a JPEG image. The <b>BITMAPV4HEADER</b>'s <b>bV4SizeImage</b> member specifies the size of the buffer. The <i>iUsage </i>parameter must be set to DIB_RGB_COLORS. The <i>dwRop </i>parameter<i> </i>must be set to SRCCOPY.</p>
<p class=indent1>
If the <b>bV5Compression</b> member of <a href="bitmaps_7c36.htm"><b>BITMAPV5HEADER</b></a> is BI_JPEG, <i>lpBits</i> points to a buffer containing a JPEG image. The <b>BITMAPV5HEADER</b>'s <b>bV5SizeImage</b> member specifies the size of the buffer. The <i>iUsage </i>parameter must be set to DIB_RGB_COLORS. The <i>dwRop </i>parameter must be set to SRCCOPY.</p>
<p class=indent1>
To ensure proper metafile spooling while printing, applications must call the CHECKJPEGFORMAT escape to verify that the printer recognizes the JPEG image before calling<b> StretchDIBits</b>. </p>
<p>
<b>ICM:</b> Color management is performed. If the specified <a href="bitmaps_0zn6.htm"><b>BITMAPINFO</b></a>'s <b>bmiHeader </b>does not<b> </b>contain <a href="bitmaps_2k1e.htm"><b>BITMAPV4HEADER</b></a> or <a href="bitmaps_7c36.htm"><b>BITMAPV5HEADER</b></a>, the color profile of the current device context is used as the source color space profile.  If it does not have a color profile, the sRGB space is used. If the specified <b>BITMAPINFO</b>'s <b>bmiHeader </b>contains <b>BITMAPV4HEADER</b> or <b>BITMAPV5HEADER</b>, the color space profile specified in the bitmap header is used as the source of color space profile.<b> </b></p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in wingdi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use gdi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="bitmaps_99ir.htm">Bitmaps Overview</a>, <a href="bitmaps_87eb.htm">Bitmap Functions</a>, <a href="cordspac_3c6d.htm"><b>SetMapMode</b></a>, <a href="bitmaps_6cth.htm"><b>SetStretchBltMode</b></a>, <a href="bitmaps_0zn6.htm"><b>BITMAPINFO</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
