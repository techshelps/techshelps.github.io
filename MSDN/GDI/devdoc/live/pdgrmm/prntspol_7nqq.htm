<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PRINTER_INFO_7</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_printer_info_7_str"></a>PRINTER_INFO_7</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>PRINTER_INFO_7</b> structure specifies directory services printer information. Use this structure with the <a href="prntspol_13ua.htm"><b>SetPrinter</b></a> function to publish a printer's data in the directory service (DS), or to update or remove a printer's published data from the DS. Use this structure with the <a href="prntspol_1gky.htm"><b>GetPrinter</b></a> function to determine whether a printer is published in the DS.</p>
<pre><code>typedef struct _PRINTER_INFO_7 {
    LPTSTR   pszObjectGUID;
    DWORD    dwAction;
} PRINTER_INFO_7, *PPRINTER_INFO_7, *LPPRINTER_INFO_7;
 </code></pre>
<h4>Members</h4>
<dl>
<dt>
<b>pszObjectGUID</b></dt>
<dd>
Pointer to a null-terminated string containing the GUID of the directory service print queue object associated with a published printer.</dd>
<dt>
<b>dwAction</b></dt>
<dd>
Indicates the action for the <a href="prntspol_13ua.htm"><b>SetPrinter</b></a> function to perform. For the <a href="prntspol_1gky.htm"><b>GetPrinter</b></a> function, this member indicates whether the specified printer is published. This member can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=35%>Value</th>
<th align=left width=65%>Description</th>
</tr>
<tr valign=top>
<td width=35%>DSPRINT_PUBLISH</td>
<td width=65%><b>SetPrinter:</b> Publishes the printer's data in the DS. <p>
<b>GetPrinter:</b> Indicates the printer is published.</p>
</td>
</tr>
<tr valign=top>
<td width=35%>DSPRINT_UNPUBLISH</td>
<td width=65%><b>SetPrinter:</b> Removes the printer's published data from the DS. <p>
<b>GetPrinter:</b> Indicates the printer is not published.</p>
</td>
</tr>
<tr valign=top>
<td width=35%>DSPRINT_UPDATE</td>
<td width=65%><b>SetPrinter:</b> Updates the printer's published data in the DS. <p>
<b>GetPrinter</b> never returns this value.</p>
</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>PRINTER_INFO_7</b> structure is used in a <a href="prntspol_13ua.htm"><b>SetPrinter</b></a> call to publish printer information to the directory service. The published data includes all values and data for the specified printer found under the SPLDS_SPOOLER_KEY, SPLDS_DRIVER_KEY, or SPLDS_USER_KEY keys created by <a href="prntspol_6o1k.htm"><b>SetPrinterDataEx</b></a>. Before calling <b>SetPrinter</b>, set <i>pszObjectGUID</i> to NULL. </p>
<p>
For <a href="prntspol_1gky.htm"><b>GetPrinter</b></a>, <i>pszObjectGUID</i> returns the GUID of the directory services print queue object associated with a published printer. You can use this GUID with Active Directory Services Interface (ADSI) methods to retrieve published data for the printer. However, the recommended method for retrieving published data is to call the <a href="prntspol_4ss8.htm"><b>GetPrinterDataEx</b></a> function. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winspool.h.<br>
<b>&nbsp;&nbsp;Unicode: </b>Defined as Unicode and ANSI structures.</p>
<h4>See Also</h4>
<p>
<a href="prntspol_62ia.htm">Printing and Print Spooler Overview</a>, <a href="prntspol_5nzn.htm">Printing and Print Spooler Structures</a>, <a href="prntspol_9fjn.htm"><b>EnumPrinters</b></a>, <a href="prntspol_1gky.htm"><b>GetPrinter</b></a>, <a href="prntspol_4ss8.htm"><b>GetPrinterDataEx</b></a>, <a href="prntspol_9qnm.htm"><b>OpenPrinter</b></a>, <a href="prntspol_03g2.htm"><b>PRINTER_INFO_1</b></a>, <a href="prntspol_9otu.htm"><b>PRINTER_INFO_2</b></a>, <a href="prntspol_9a7m.htm"><b>PRINTER_INFO_3</b></a>, <a href="prntspol_13ua.htm"><b>SetPrinter</b></a>, <a href="prntspol_6o1k.htm"><b>SetPrinterDataEx</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
