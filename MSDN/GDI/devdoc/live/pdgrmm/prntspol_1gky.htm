<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetPrinter</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_getprinter"></a>GetPrinter</h1>
<p>
The <b>GetPrinter</b> function retrieves information about a specified printer. </p>
<pre><code><b>BOOL GetPrinter(
  HANDLE</b><i> hPrinter</i><b>,    </b>// handle to printer of interest
<b>  DWORD</b><i> Level</i><b>,        </b>// version of printer info data structure
<b>  LPBYTE</b><i> pPrinter</i><b>,    </b>// pointer to array of bytes that receives 
                      // printer info structure
<b>  DWORD</b><i> cbBuf</i><b>,        </b>// size, in bytes, of the <i>pPrinter</i> buffer
<b>  LPDWORD</b><i> pcbNeeded</i>   // pointer to variable with count of bytes 
                      // retrieved (or required)
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hPrinter</i></dt>
<dd>
Handle to the printer for which the function retrieves information. Use the <a href="prntspol_9qnm.htm"><b>OpenPrinter</b></a> function to retrieve a printer handle.</dd>
<dt>
<i>Level</i></dt>
<dd>
Specifies the version of the structure that the function stores into the buffer pointed to by <i>pPrinter</i>. 
<p>
<b>Windows 95:</b> This value can be 1, 2, or 5.

<p>
<b>Windows NT:</b> This value can be 1, 2, 3, 4, 5, or 7.
</dd>
<dt>
<i>pPrinter</i></dt>
<dd>
Pointer to a buffer that receives a structure containing information about the specified printer. The buffer must be large enough to receive the structure and any strings or other data that the structure members point to. If the buffer is too small, the <i>pcbNeeded</i> parameter returns the required buffer size.
<p>
The type of structure is determined by the value of <i>Level</i>. 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=12%>Level</th>
<th align=left width=88%>Structure</th>
</tr>
<tr valign=top>
<td width=12%>1</td>
<td width=88%>A <a href="prntspol_03g2.htm"><b>PRINTER_INFO_1</b></a> structure containing general printer information.</td>
</tr>
<tr valign=top>
<td width=12%>2</td>
<td width=88%>A <a href="prntspol_9otu.htm"><b>PRINTER_INFO_2</b></a> structure containing detailed information about the printer.</td>
</tr>
<tr valign=top>
<td width=12%>3</td>
<td width=88%><b>Windows NT:</b> A <a href="prntspol_9a7m.htm"><b>PRINTER_INFO_3</b></a> structure containing the printer's security information. </td>
</tr>
<tr valign=top>
<td width=12%>4</td>
<td width=88%><b>Windows NT:</b> A <a href="prntspol_8vle.htm"><b>PRINTER_INFO_4</b></a> structure containing minimal printer information, including the name of the printer, the name of the server, and whether the printer is remote or local.</td>
</tr>
<tr valign=top>
<td width=12%>5</td>
<td width=88%>A <a href="prntspol_8gz6.htm"><b>PRINTER_INFO_5</b></a> structure containing printer information such as printer attributes and time-out settings.</td>
</tr>
<tr valign=top>
<td width=12%>7</td>
<td width=88%><b>Windows NT 5.0 and later:</b> A <a href="prntspol_7nqq.htm"><b>PRINTER_INFO_7</b></a> structure that indicates whether the printer is published in the directory service.</td>
</tr>
</table><br>

</dd>
<dt>
<i>cbBuf</i></dt>
<dd>
Specifies the size, in bytes, of the buffer pointed to by <i>pPrinter</i>. </dd>
<dt>
<i>pcbNeeded</i></dt>
<dd>
Pointer to a variable that the function sets to the size, in bytes, of the printer information. If <i>cbBuf</i> is smaller than this value, <b>GetPrinter</b> fails, and the value represents the required buffer size. If <i>cbBuf</i> is equal to or greater than this value, <b>GetPrinter</b> succeeds, and the value represents the number of bytes stored in the buffer.
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
<b>Windows NT: </b>For the <a href="prntspol_9otu.htm"><b>PRINTER_INFO_2</b></a> and <a href="prntspol_9a7m.htm"><b>PRINTER_INFO_3</b></a> structures that contain a pointer to a security descriptor, the function retrieves only those components of the security descriptor that the caller has permission to read. To retrieve particular security descriptor components, you must specify the necessary access rights when you call the <a href="prntspol_9qnm.htm"><b>OpenPrinter</b></a> function to retrieve a handle to the printer. The following table shows the access rights required to read the various security descriptor components.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>Access Right</th>
<th align=left width=55%>Security Descriptor Component</th>
</tr>
<tr valign=top>
<td width=45%>READ_CONTROL</td>
<td width=55%>Owner <br>
Primary group <br>
Discretionary access-control list (DACL)</td>
</tr>
<tr valign=top>
<td width=45%>ACCESS_SYSTEM_SECURITY</td>
<td width=55%>System access-control list (SACL)</td>
</tr>
</table><br>
<p>
<b>Windows NT 5.0 and later: </b>You can use level 7 with the <b>PRINTER_INFO_7</b> structure to determine whether the printer is published in the directory service. If the printer is published, the <b>dwAction</b> member of <b>PRINTER_INFO_7</b> is set to DSPRINT_PUBLISH and the <b>pszObjectGUID</b><i> </i>member contains the GUID of the directory services print queue object associated with the printer. If the printer is not published, <b>dwAction</b> is set to DSPRINT_UNPUBLISH.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winspool.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use winspool.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="prntspol_62ia.htm">Printing and Print Spooler Overview</a>, <a href="prntspol_7mgj.htm">Printing and Print Spooler Functions</a>, <a href="prntspol_684y.htm"><b>AbortPrinter</b></a>, <a href="prntspol_1po2.htm"><b>AddPrinter</b></a>, <a href="prntspol_4w1e.htm"><b>ClosePrinter</b></a>, <a href="prntspol_42eq.htm"><b>DeletePrinter</b></a>, <a href="prntspol_9fjn.htm"><b>EnumPrinters</b></a>, <a href="prntspol_03g2.htm"><b>PRINTER_INFO_1</b></a>, <a href="prntspol_9otu.htm"><b>PRINTER_INFO_2</b></a>, <a href="prntspol_9a7m.htm"><b>PRINTER_INFO_3</b></a>, <a href="prntspol_9a7m.htm"><b>PRINTER_INFO_4</b></a>, <a href="prntspol_8gz6.htm"><b>PRINTER_INFO_5</b></a>, <a href="prntspol_7nqq.htm"><b>PRINTER_INFO_7</b></a>, <a href="prntspol_9qnm.htm"><b>OpenPrinter</b></a>, <a href="prntspol_13ua.htm"><b>SetPrinter</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
