<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AddPrinterDriverEx</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_addprinterdriverex"></a>AddPrinterDriverEx</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>AddPrinterDriverEx</b> function installs a local or remote printer driver and links the configuration, data, and driver files. In contrast to the <b>AddPrinterDriver</b> function, <b>AddPrinterDriverEx</b> provides more flexibility in installing or upgrading printer drivers. The new options permit strict upgrade, strict downgrade, copying of newer files only and copying of all files (regardless of the file time stamps). </p>
<pre><code><b>BOOL AddPrinterDriverEx(
  LPTSTR</b><i> pName</i><b>,           </b>// pointer to server name
<b>  DWORD</b><i> Level</i><b>,            </b>// printer info. structure level
<b>  LPBYTE</b><i> pDriverInfo</i><b>,</b>     // pointer to printer info. structure
<b>  DWORD</b><i> dwFileCopyFlags</i>   // pointer to printer info. structure
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pName</i></dt>
<dd>
Pointer to a null-terminated string that specifies the name of the server on which the driver should be installed. If this parameter is NULL, the function installs the driver on the local computer. </dd>
<dt>
<i>Level</i></dt>
<dd>
Specifies the version of the structure to which <i>pDriverInfo</i> points. This value can be either 2 or 3.</dd>
<dt>
<i>pDriverInfo</i></dt>
<dd>
Pointer to a structure containing printer driver information. If <i>Level</i> is 2, <i>pDriverInfo</i> is a pointer to a <a href="prntspol_7egi.htm"><b>DRIVER_INFO_2</b></a> structure. If <i>Level</i> is 3, <i>pDriverInfo</i> is a pointer to a <a href="prntspol_6zua.htm"><b>DRIVER_INFO_3</b></a> structure. 
<p>
If the <b>pEnvironment</b> member of the structure pointed to by <i>pDriverInfo</i> is NULL, the function uses the current environment of the caller/client, not the environment of the destination/server.
</dd>
<dt>
<i>dwFileCopyFlags</i></dt>
<dd>
Specifies options for copying the driver files. This parameter can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=45%>Value</th>
<th align=left width=55%>Meaning</th>
</tr>
<tr valign=top>
<td width=45%>APD_COPY_ALL_FILES</td>
<td width=55%>Add the printer driver and copy all the files in the printer-driver directory. The file time stamps are ignored with this option.</td>
</tr>
<tr valign=top>
<td width=45%>APD_COPY_NEW_FILES</td>
<td width=55%>Add the printer driver and copy the files in the printer-driver directory that are newer than any corresponding files  that are currently in use. This flag emulates the behavior of <b>AddPrinterDriver</b>.</td>
</tr>
<tr valign=top>
<td width=45%>APD_STRICT_DOWNGRADE</td>
<td width=55%>Add the printer driver only if all the files in the printer-driver directory are older than any corresponding files  that are currently in use.</td>
</tr>
<tr valign=top>
<td width=45%>APD_STRICT_UPGRADE</td>
<td width=55%>Add the printer driver only if all the files in the printer-driver directory are newer than any corresponding files  that are currently in use.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
Before calling the <b>AddPrinterDriverEx</b> function, all files required by the driver must be copied to the system's printer-driver directory. To retrieve the name of this directory, call the <a href="prntspol_3y7t.htm"><b>GetPrinterDriverDirectory</b></a> function. </p>
<p>
To determine which printer drivers are currently installed, call the <a href="prntspol_752r.htm"><b>EnumPrinterDrivers</b></a> function. </p>
<p>
If the printer driver has been successfully added, the function calls the <b>DrvDriverEvent</b> (DRIVER_EVENT_INITIALIZE, <i>Level</i>, DRIVER_INFO_*, <i>lparam</i>) function to allow the driver to perform any initializations required during the installation of a printer driver. For more information about <b>DrvDriverEvent</b>, see the Microsoft Windows NT Device Driver Kit documentation.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in winspool.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use winspool.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="prntspol_62ia.htm">Printing and Print Spooler Overview</a>, <a href="prntspol_7mgj.htm">Printing and Print Spooler Functions</a>, <a href="prntspol_7egi.htm"><b>DRIVER_INFO_2</b></a>, <a href="prntspol_6zua.htm"><b>DRIVER_INFO_3</b></a>, <a href="prntspol_3gs8.htm"><b>DeletePrinterDriverEx</b></a>, <a href="prntspol_752r.htm"><b>EnumPrinterDrivers</b></a>, <a href="prntspol_3y7t.htm"><b>GetPrinterDriverDirectory</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
