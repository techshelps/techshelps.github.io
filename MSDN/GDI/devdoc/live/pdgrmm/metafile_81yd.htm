<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CreateEnhMetaFile</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_createenhmetafile"></a>CreateEnhMetaFile</h1>
<p>
The <b>CreateEnhMetaFile</b> function creates a device context for an enhanced-format metafile. This device context can be used to store a device-independent picture. </p>
<pre><code><b>HDC CreateEnhMetaFile(
  HDC</b><i> hdcRef</i><b>,           </b>// handle to a reference device context
<b>  LPCTSTR</b><i> lpFilename</i><b>,   </b>// pointer to a filename string
<b>  CONST RECT</b><i> *lpRect</i><b>,   </b>// pointer to a bounding rectangle
<b>  LPCTSTR</b><i> lpDescription</i> // pointer to an optional description string
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hdcRef</i></dt>
<dd>
Handle to a reference device for the enhanced metafile. </dd>
<dt>
<i>lpFilename</i></dt>
<dd>
Pointer to the filename for the enhanced metafile to be created. If this parameter is NULL, the enhanced metafile is memory based and its contents are lost when it is deleted by using the <a href="metafile_1isl.htm"><b>DeleteEnhMetaFile</b></a> function. </dd>
<dt>
<i>lpRect</i></dt>
<dd>
Pointer to a <a href="rectangl_6cqa.htm"><b>RECT</b></a> structure that specifies the dimensions (in .01-millimeter units) of the picture to be stored in the enhanced metafile.</dd>
<dt>
<i>lpDescription</i></dt>
<dd>
Pointer to a string that specifies the name of the application that created the picture, as well as the picture's title. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a handle to the device context for the enhanced metafile.</p>
<p>
If the function fails, the return value is NULL. </p>
<p>
<b>Windows NT:</b> To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
Where text arguments must use Unicode characters, use the <b>CreateEnhMetaFile</b> function as a wide-character function. Where text arguments must use characters from the Windows character set, use this function as an ANSI function. </p>
<p>
The system uses the reference device identified by the <i>hdcRef</i> parameter to record the resolution and units of the device on which a picture originally appeared. If the <i>hdcRef</i> parameter is NULL, it uses the current display device for reference. </p>
<p>
The <b>left</b> and <b>top</b> members of the <a href="rectangl_6cqa.htm"><b>RECT</b></a> structure pointed to by the <i>lpRect</i> parameter must be less than the <b>right</b> and <b>bottom</b> members, respectively. Points along the edges of the rectangle are included in the picture. If <i>lpRect</i> is NULL, the graphics device interface (GDI) computes the dimensions of the smallest rectangle that surrounds the picture drawn by the application. The <i>lpRect</i> parameter should be provided where possible. </p>
<p>
The string pointed to by the <i>lpDescription</i> parameter must contain a null character between the application name and the picture name and must terminate with two null characters — for example, "XYZ Graphics Editor\0Bald Eagle\0\0", where \0 represents the null character. If <i>lpDescription</i> is NULL, there is no corresponding entry in the enhanced-metafile header. </p>
<p>
Applications use the device context created by this function to store a graphics picture in an enhanced metafile. The handle identifying this device context can be passed to any GDI function. </p>
<p>
After an application stores a picture in an enhanced metafile, it can display the picture on any output device by calling the <b>PlayEnhMetaFile</b> function. When displaying the picture, the system uses the rectangle pointed to by the <i>lpRect</i> parameter and the resolution data from the reference device to position and scale the picture. </p>
<p>
The device context returned by this function contains the same default attributes associated with any new device context. </p>
<p>
Applications must use the <b>GetWinMetaFileBits</b> function to convert an enhanced metafile to the older Windows metafile format. </p>
<p>
The filename for the enhanced metafile should use the .EMF extension. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in wingdi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use gdi32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="metafile_7ulv.htm">Metafiles Overview</a>, <a href="metafile_0whf.htm">Metafile Functions</a>, <a href="metafile_9r39.htm"><b>CloseEnhMetaFile</b></a>, <a href="metafile_1isl.htm"><b>DeleteEnhMetaFile</b></a>, <a href="metafile_7wz2.htm"><b>GetEnhMetaFileDescription</b></a>, <a href="metafile_750y.htm"><b>GetEnhMetaFileHeader</b></a>, <a href="metafile_9bzn.htm"><b>GetWinMetaFileBits</b></a>, <a href="metafile_7hwl.htm"><b>PlayEnhMetaFile</b></a>, <a href="rectangl_6cqa.htm"><b>RECT</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
