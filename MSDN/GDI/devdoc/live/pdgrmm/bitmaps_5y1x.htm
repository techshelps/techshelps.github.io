<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Scaling an Image</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_scaling_an_image"></a>Scaling an Image</h2>
<p>
Some applications scale images — that is, they display zoomed or reduced views of an image. For example, a drawing application may provide a zoom feature that enables the user to view and edit a drawing on a pixel-by-pixel basis. </p>
<p>
Applications scale images by calling the <a href="bitmaps_9cok.htm"><b>StretchBlt</b></a> function. Like the <a href="bitmaps_0fzo.htm"><b>BitBlt</b></a> function, <b>StretchBlt</b> copies bitmap data from a bitmap in a source DC into a bitmap in a target DC. However, unlike the <b>BitBlt</b> function, <b>StretchBlt</b> scales the image based on the specified dimensions of the source and target rectangles. If the source rectangle is larger than the target rectangle, the resultant image will appear to have shrunk; if the source rectangle is smaller than the target rectangle, the resultant image will appear to have expanded. </p>
<p>
If the target rectangle is smaller than the source rectangle, <b>StretchBlt</b> removes color data from the image according to a specified stretch mode as shown in the following table. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=27%>Stretch Mode</th>
<th align=left width=73%>Method</th>
</tr>
<tr valign=top>
<td width=27%>BLACKONWHITE</td>
<td width=73%>Performs a logical AND operation on the color data for the eliminated pixels and the color data for the remaining pixels.</td>
</tr>
<tr valign=top>
<td width=27%>WHITEONBLACK</td>
<td width=73%>Performs a logical OR operation on the color data for the eliminated pixels and the color data for the remaining pixels.</td>
</tr>
<tr valign=top>
<td width=27%>COLORONCOLOR</td>
<td width=73%>Eliminates the color data of the deleted pixels completely.</td>
</tr>
<tr valign=top>
<td width=27%>HALFTONE</td>
<td width=73%>Approximates the original (source) color data in the destination.</td>
</tr>
</table><br>
<p>
You set the stretch mode by calling the <a href="bitmaps_6cth.htm"><b>SetStretchBltMode</b></a> function. </p>
<p>
The following example code is taken from an application that displays an image either at its original size or a twice the original size. (This application uses the default stretch mode.) </p>
<pre><code>hdcScaled = CreateCompatibleDC(hdcScreen); 
 
    hbmScaled = CreateCompatibleBitmap(hdcScreen, 
                    GetDeviceCaps(hdcScreen, HORZRES) * 2, 
                    GetDeviceCaps(hdcScreen, VERTRES) * 2); 
 
    if (hbmScaled == 0) 
        errhandler("hbmScaled", hwnd); 
 
    // Select the bitmaps into the compatible DC. 
 
    if (!SelectObject(hdcScaled, hbmScaled)) 
        errhandler("Scaled Bitmap Selection", hwnd); 
 
case WM_COMMAND:     // message: command from application menu 
    switch(wParam) 
    { 
        case IDM_SCALEX1: 
            if (fBlt)
            { 
                 fScaled = FALSE; 
                 hdcWin = GetDC(hwnd); 
                 BitBlt(hdcWin, 
                    0,0, 
                    bmp.bmWidth, bmp.bmHeight, 
                    hdcCompatible, 
                    0,0, 
                    SRCCOPY); 
                 ReleaseDC(hwnd, hdcWin); 
            } 
            break; 
 
        case IDM_SCALEX2: 
            if (fBlt)
            { 
                 fScaled = TRUE; 
                 StretchBlt(hdcScaled, 
                     0, 0, 
                     bmp.bmWidth * 2, bmp.bmHeight * 2, 
                     hdcCompatible, 
                     0, 0, 
                     bmp.bmWidth, bmp.bmHeight, 
                     SRCCOPY); 
 
                 hdcWin = GetDC(hwnd); 
                 BitBlt(hdcWin, 
                    0,0, 
                    bmp.bmWidth, bmp.bmHeight, 
                    hdcScaled, 
                    0,0, 
                    SRCCOPY); 
                 ReleaseDC(hwnd, hdcWin); 
            } 
            break; 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
