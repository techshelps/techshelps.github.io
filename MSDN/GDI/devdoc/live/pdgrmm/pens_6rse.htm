<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ExtCreatePen</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_extcreatepen"></a>ExtCreatePen</h1>
<p>
The <b>ExtCreatePen</b> function creates a logical cosmetic or geometric pen that has the specified style, width, and brush attributes. </p>
<pre><code><b>HPEN ExtCreatePen(
  DWORD</b><i> dwPenStyle</i><b>,      </b>// pen style
<b>  DWORD</b><i> dwWidth</i><b>,         </b>// pen width
<b>  CONST LOGBRUSH</b><i> *lplb</i><b>,  </b>// pointer to structure for brush attributes
<b>  DWORD</b><i> dwStyleCount</i><b>,    </b>// length of array containing custom style bits
<b>  CONST DWORD</b><i> *lpStyle</i>   // optional array of custom style bits
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwPenStyle</i></dt>
<dd>
Specifies a combination of type, style, end cap, and join attributes. The values from each category are combined by using the bitwise OR operator (|). 
<p>
The pen type can be one of the following values: 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=37%>Type</th>
<th align=left width=63%>Description</th>
</tr>
<tr valign=top>
<td width=37%>PS_GEOMETRIC</td>
<td width=63%>Pen is geometric.</td>
</tr>
<tr valign=top>
<td width=37%>PS_COSMETIC</td>
<td width=63%>Pen is cosmetic.</td>
</tr>
</table><br>


<p>
The pen style can be any one of the following values: 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=37%>Style</th>
<th align=left width=63%>Description</th>
</tr>
<tr valign=top>
<td width=37%>PS_ALTERNATE</td>
<td width=63%><b>Windows NT:</b> Pen sets every other pixel. (This style is applicable only for cosmetic pens.)</td>
</tr>
<tr valign=top>
<td width=37%>PS_SOLID</td>
<td width=63%>Pen is solid.</td>
</tr>
<tr valign=top>
<td width=37%>PS_DASH</td>
<td width=63%>Pen is dashed.<p>
<b>Windows 95 : </b>This style is not supported for geometric lines.</p>
<p>
<b>Windows 98: </b>Not supported<b>.</b></p>
</td>
</tr>
<tr valign=top>
<td width=37%>PS_DOT</td>
<td width=63%>Pen is dotted.<p>
<b>Windows 95 and Windows 98: </b>This style is not supported for geometric lines.</p>
</td>
</tr>
<tr valign=top>
<td width=37%>PS_DASHDOT</td>
<td width=63%>Pen has alternating dashes and dots.<p>
<b>Windows 95: </b>This style is not supported for geometric lines.</p>
<p>
<b>Windows 98: </b>Not supported<b>.</b></p>
</td>
</tr>
<tr valign=top>
<td width=37%>PS_DASHDOTDOT</td>
<td width=63%>Pen has alternating dashes and double dots.<p>
<b>Windows 95: </b>This style is not supported for geometric lines.</p>
<p>
<b>Windows 98: </b>Not supported<b>.</b></p>
</td>
</tr>
<tr valign=top>
<td width=37%>PS_NULL</td>
<td width=63%>Pen is invisible.</td>
</tr>
<tr valign=top>
<td width=37%>PS_USERSTYLE</td>
<td width=63%><b>Windows NT:</b> Pen uses a styling array supplied by the user.</td>
</tr>
<tr valign=top>
<td width=37%>PS_INSIDEFRAME</td>
<td width=63%>Pen is solid. When this pen is used in any graphics device interface (GDI) drawing function that takes a bounding rectangle, the dimensions of the figure are shrunk so that it fits entirely in the bounding rectangle, taking into account the width of the pen. This applies only to geometric pens.</td>
</tr>
</table><br>


<p>
The end cap is only specified for geometric pens. The end cap can be one of the following values: 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=37%>End cap</th>
<th align=left width=63%>Description</th>
</tr>
<tr valign=top>
<td width=37%>PS_ENDCAP_ROUND</td>
<td width=63%>End caps are round.</td>
</tr>
<tr valign=top>
<td width=37%>PS_ENDCAP_SQUARE</td>
<td width=63%>End caps are square.</td>
</tr>
<tr valign=top>
<td width=37%>PS_ENDCAP_FLAT</td>
<td width=63%>End caps are flat.</td>
</tr>
</table><br>


<p>
The join is only specified for geometric pens. The join can be one of the following values: 

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=37%>Line join</th>
<th align=left width=63%>Description</th>
</tr>
<tr valign=top>
<td width=37%>PS_JOIN_BEVEL</td>
<td width=63%>Joins are beveled.</td>
</tr>
<tr valign=top>
<td width=37%>PS_JOIN_MITER</td>
<td width=63%>Joins are mitered when they are within the current limit set by the <a href="paths_288k.htm"><b>SetMiterLimit</b></a> function. If it exceeds this limit, the join is beveled.</td>
</tr>
<tr valign=top>
<td width=37%>PS_JOIN_ROUND</td>
<td width=63%>Joins are round.</td>
</tr>
</table><br>


<p>
<b>Windows 95 and Windows 98: </b>The PS_ENDCAP_ROUND, PS_ENDCAP_SQUARE, PS_ENDCAP_FLAT, PS_JOIN_BEVEL, PS_JOIN_MITER, and PS_JOIN_ROUND styles are supported only for geometric pens when used to draw paths.
</dd>
<dt>
<i>dwWidth</i></dt>
<dd>
Specifies the width of the pen. If the <i>dwPenStyle</i> parameter is PS_GEOMETRIC, the width is given in logical units. If <i>dwPenStyle</i> is PS_COSMETIC, the width must be set to 1. </dd>
<dt>
<i>lplb</i></dt>
<dd>
Points to a <a href="brushes_2u0i.htm"><b>LOGBRUSH</b></a> structure. If <i>dwPenStyle</i> is PS_COSMETIC, the <b>lbColor</b> member specifies the color of the pen and the <b>lbStyle</b> member must be set to BS_SOLID. If <i>dwPenStyle</i> is PS_GEOMETRIC, all members must be used to specify the brush attributes of the pen.</dd>
<dt>
<i>dwStyleCount</i></dt>
<dd>
Specifies the length, in <b>DWORD</b> units, of the <i>lpStyle</i> array. This value must be zero if <i>dwPenStyle</i> is not PS_USERSTYLE. </dd>
<dt>
<i>lpStyle</i></dt>
<dd>
Points to an array of <b>DWORD</b> values. The first value specifies the length of the first dash in a user-defined style, the second value specifies the length of the first space, and so on. This pointer must be NULL if <i>dwPenStyle</i> is not PS_USERSTYLE. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is a handle that identifies a logical pen.</p>
<p>
If the function fails, the return value is zero. </p>
<p>
<b>Windows NT:</b> To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
A geometric pen can have any width and can have any of the attributes of a brush, such as dithers and patterns. A cosmetic pen can only be a single pixel wide and must be a solid color, but cosmetic pens are generally faster than geometric pens. </p>
<p>
The width of a geometric pen is always specified in world units. The width of a cosmetic pen is always 1. </p>
<p>
End cap and join are only specified for geometric pens. </p>
<p>
After an application creates a logical pen, it can select that pen into a device context by calling the <a href="devcons_9v3o.htm"><b>SelectObject</b></a> function. After a pen is selected into a device context, it can be used to draw lines and curves. </p>
<p>
If <i>dwPenStyle</i> is PS_COSMETIC and PS_USERSTYLE, the entries in the <i>lpStyle</i> array specify lengths of dashes and spaces in style units. A style unit is defined by the device where the pen is used to draw a line. </p>
<p>
If <i>dwPenStyle</i> is PS_GEOMETRIC and PS_USERSTYLE, the entries in the <i>lpStyle</i> array specify lengths of dashes and spaces in logical units. </p>
<p>
If <i>dwPenStyle</i> is PS_ALTERNATE, the style unit is ignored and every other pixel is set. </p>
<p>
If the <b>lbStyle</b> member of the <a href="brushes_2u0i.htm"><b>LOGBRUSH</b></a><b> </b>structure pointed to by <i>lplb</i> is BS_PATTERN, the bitmap pointed to by the <b>lbHatch </b>member of that structure cannot be a dib section. A dib section is a bitmap created by <a href="bitmaps_233i.htm"><b>CreateDibSection</b></a>. If that bitmap is a dib section, the <b>ExtCreatePen</b> function fails.</p>
<p>
When an application no longer requires a specified pen, it should call the <a href="devcons_1vsk.htm"><b>DeleteObject</b></a> function to delete the pen. </p>
<p>
<b>ICM:</b> No color management is done at pen creation. However, color management will be performed when the pen is selected into an ICM-enabled device context. </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in wingdi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use gdi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="pens_1q0j.htm">Pens Overview</a>, <a href="pens_2fw3.htm">Pen Functions</a>, <a href="pens_9wha.htm"><b>CreatePen</b></a>, <a href="bitmaps_233i.htm"><b>CreateDibSection</b></a>, <a href="pens_5rxw.htm"><b>CreatePenIndirect</b></a>, <a href="devcons_1vsk.htm"><b>DeleteObject</b></a>, <a href="devcons_912s.htm"><b>GetObject</b></a>, <a href="brushes_2u0i.htm"><b>LOGBRUSH</b></a>, <a href="devcons_9v3o.htm"><b>SelectObject</b></a>, <a href="paths_288k.htm"><b>SetMiterLimit</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
