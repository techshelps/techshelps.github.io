<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetEnhMetaFileDescription</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_getenhmetafiledescription"></a>GetEnhMetaFileDescription</h1>
<p>
The <b>GetEnhMetaFileDescription</b> function retrieves an optional text description from an enhanced-format metafile and copies the string to the specified buffer. </p>
<pre><code><b>UINT GetEnhMetaFileDescription(
  HENHMETAFILE</b><i> hemf</i><b>,       </b>// handle to enhanced metafile
<b>  UINT</b><i> cchBuffer</i><b>,          </b>// size of text buffer, in characters
<b>  LPTSTR</b><i> lpszDescription</i>   // pointer to text buffer
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hemf</i></dt>
<dd>
Handle to the enhanced metafile. </dd>
<dt>
<i>cchBuffer</i></dt>
<dd>
Specifies the size, in characters, of the buffer to receive the data. Only this many characters will be copied. </dd>
<dt>
<i>lpszDescription</i></dt>
<dd>
Pointer to the buffer to receive the optional text description. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the optional text description exists and the buffer pointer is NULL, the return value is the length of the text string, in characters.</p>
<p>
If the optional text description exists and the buffer pointer is a valid pointer, the return value is the number of characters copied into the buffer.</p>
<p>
If the optional text description does not exist, the return value is zero. </p>
<p>
If the function fails, the return value is GDI_ERROR. </p>
<p>
<b>Windows NT:</b> To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>.</p>
<h4>Remarks</h4>
<p>
The optional text description contains two strings, the first identifying the application that created the enhanced metafile and the second identifying the picture contained in the metafile. The strings are separated by a null character and terminated with two null characters — for example, "XYZ Graphics Editor\0Bald Eagle\0\0" where \0 represents the null character. </p>
<p>
Where text arguments must use Unicode characters, use this function as a wide-character function. Where text arguments must use characters from the Windows character set, use this function as an ANSI function. </p>
<p>
<b>Windows 95 and Windows 98: </b>The maximum length of the description string for an enhanced metafile is 16,384 bytes.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in wingdi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use gdi32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="metafile_7ulv.htm">Metafiles Overview</a>, <a href="metafile_0whf.htm">Metafile Functions</a>, <a href="metafile_81yd.htm"><b>CreateEnhMetaFile</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
