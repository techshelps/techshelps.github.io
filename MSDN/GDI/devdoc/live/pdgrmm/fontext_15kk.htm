<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetTextExtentExPoint</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_gettextextentexpoint"></a>GetTextExtentExPoint</h1>
<p>
The <b>GetTextExtentExPoint</b> function retrieves the number of characters in a specified string that will fit within a specified space and fills an array with the text extent for each of those characters. (A text extent is the distance between the beginning of the space and a character that will fit in the space.) This information is useful for word-wrapping calculations. </p>
<pre><code><b>BOOL GetTextExtentExPoint(
  HDC</b><i> hdc</i><b>,         </b>// handle to device context
<b>  LPCTSTR</b><i> lpszStr</i><b>, </b>// pointer to character string
<b>  int</b><i> cchString</i><b>,   </b>// number of characters in string
<b>  int</b><i> nMaxExtent</i><b>,  </b>// maximum width for formatted string
<b>  LPINT</b><i> lpnFit</i><b>,    </b>// pointer to value specifying max. number of 
                   // chars.
<b>  LPINT</b><i> alpDx</i><b>,     </b>// pointer to array for partial string widths
<b>  LPSIZE</b><i> lpSize</i>    // pointer to structure with string dimensions
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hdc</i></dt>
<dd>
Handle to the device context. </dd>
<dt>
<i>lpszStr</i></dt>
<dd>
Pointer to the null-terminated string for which extents are to be retrieved. </dd>
<dt>
<i>cchString</i></dt>
<dd>
Specifies the number of bytes in the string pointed to by the <i>lpszStr</i> parameter. </dd>
<dt>
<i>nMaxExtent</i></dt>
<dd>
Specifies the maximum allowable width, in logical units, of the formatted string. </dd>
<dt>
<i>lpnFit</i></dt>
<dd>
Pointer to an integer to receive a count of the maximum number of characters that will fit in the space specified by the <i>nMaxExtent</i> parameter. When the <i>lpnFit</i> parameter is NULL, the <i>nMaxExtent</i> parameter is ignored. </dd>
<dt>
<i>alpDx</i></dt>
<dd>
Pointer to an array of integers to receive partial string extents. Each element in the array gives the distance, in logical units, between the beginning of the string and one of the characters that fits in the space specified by the <i>nMaxExtent</i> parameter. Although this array should have at least as many elements as characters specified by the <i>cchString</i> parameter, the function fills the array with extents only for as many characters as are given by the <i>lpnFit</i> parameter. If <i>alpDx</i> is NULL, the function does not compute partial string widths. </dd>
<dt>
<i>lpSize</i></dt>
<dd>
Pointer to a <a href="bitmaps_2ghe.htm"><b>SIZE</b></a> structure that contains the dimensions of the string, in logical units when the function returns. This value cannot be NULL. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
If the function succeeds, the return value is nonzero.</p>
<p>
If the function fails, the return value is zero. </p>
<p>
<b>Windows NT:</b> To get extended error information, call <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_getlasterror">
</object><a href=JavaScript:alink_1.Click()><b>GetLastError</b></a>. </p>
<h4>Remarks</h4>
<p>
If both the <i>lpnFit</i> and <i>alpDx</i> parameters are NULL, calling the <b>GetTextExtentExPoint</b> function is equivalent to calling the <b>GetTextExtentPoint</b> function. </p>
<p>
<b>Windows CE:</b> The <i>cchString</i> parameter specifies the number of characters, not bytes, in the string pointed to by the <i>lpszStr</i> parameter. This is true in Windows desktop platforms as well as in Windows CE.  </p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 3.1 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Requires Windows 95 or later.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Requires version 1.0 or later.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in wingdi.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use gdi32.lib.<br>
<b>&nbsp;&nbsp;Unicode: </b>Implemented as Unicode and ANSI versions on Windows NT.</p>
<h4>See Also</h4>
<p>
<a href="fontext_8ctw.htm">Fonts and Text Overview</a>, <a href="fontext_9r77.htm">Font and Text Functions</a>, <a href="fontext_9rzo.htm"><b>GetTextExtentPoint</b></a>, <a href="bitmaps_2ghe.htm"><b>SIZE</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
