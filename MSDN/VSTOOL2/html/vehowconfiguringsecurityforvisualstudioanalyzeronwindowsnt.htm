<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Configuring Security for Visual Studio Analyzer on Windows NT</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="vehowconfiguringsecurityforvisualstudioanalyzeronwindowsnt"></a>Configuring Security for Visual Studio Analyzer on Windows NT</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vehowConfiguringSecurityForVisualStudioAnalyzerOnWindowsNT_C">
</object></p>
<p>
Visual Studio Analyzer ships with security open. You can increase the security settings to reflect your site's needs. To increase the security settings, you need to complete the following steps:
<ol>
<li>
Set the Visual Studio Analyzer server to run as a domain user.<br><br></li>
<li>
Restrict access to the Visual Studio Analyzer server to specific users.<br><br></li>
<li>
Restrict access to the Visual Studio Analyzer client.<br><br></li>
<li>
Edit the registry on the Visual Studio Analyzer server to enable security checking.<br><br></li>
<li>
Edit the registry on the Visual Studio Analyzer client to enable security checking.</li>
</ol>
<p>
These steps are described in the following procedures.</p>
<p class=indent>
<B><b>Note:</b></B>&nbsp;&nbsp;&nbsp;You need to configure security on a per-machine basis for any machine on which you are running the Visual Studio Analyzer server or client.</p>
<h3>Before You Begin</h3>
<p>
Before you begin configuring security, make sure you have a user account on your domain under which the Visual Studio Analyzer server can run. This user account can be your own user ID, a user ID shared by your group, or even a user ID you create specficially for Visual Studio Analyzer. In order to configure security, you will need to know the password for this user account as well as the user ID.</p>
<p>
The procedure for setting the Visual Studio Analyzer server to run as a domain user and the procedures for restricting access all use DCOMCNFG, a configuration utility intended for configuring DCOM-specific settings in the registry. DCOMCNFG is shipped with Windows NT but is not added to the Start menu or to any groups. You must start DCOMCNFG using the Run command on the Start menu.</p>
<p>
For more information on using DCOMCNFG to configure access and launch permissions, search for "DCOMCNFG" in <i>MSDN Library Visual Studio 6.0</i>.</p>
<p class=label>
<b>To set the Visual Studio Analyzer server to run as a domain user</b>
<ol>
<li>
Start DCOMCNFG.<br><br></li>
<li>
On the <b>Applications</b> tab, select <b>MSVSA Local Event Concentrator Class</b> (scroll down if necessary).<br><br></li>
<li>
Click <b>Properties</b>.<br><br></li>
<li>
Click the <b>Identity</b> tab.<br><br></li>
<li>
Select <b>This user</b> and complete the <b>User</b>, <b>Password</b>, and <b>Confirm Password</b> boxes. In the <b>User</b> box, specify the user ID for the account on your domain under which you want the Visual Studio Analyzer server to run. Use the form <i>domain name\user ID</i>.<br><br></li>
<li>
Click <b>Apply</b>.</li>
</ol>
<p class=label>
<b>To restrict access to the Visual Studio Analyzer server to specific users</b>
<ol>
<li>
Start DCOMCNFG, if necessary.<br><br></li>
<li>
On the <b>Applications</b> tab, select <b>MSVSA Local Event Concentrator Class</b> (scroll down if necessary).<br><br></li>
<li>
Click <b>Properties</b>.<br><br></li>
<li>
Click the <b>Security</b> tab.<br><br></li>
<li>
Select <b>Use custom access permissions</b> and click <b>Edit</b>.<p class=tl>
The Registry Value Permissions dialog box appears. This dialog box lists the known users who currently have (or are denied) access to the machine.</P></li>
<li>
Add the specific users to whom you want to allow access to the Visual Studio Analyzer server on this machine, and remove any users to whom you want to deny access.<ul type=disc>
<li>
Click <b>Add</b> to add users, one at a time. Make sure you add the SYSTEM account as a user. This is required in order to connect to the machine. Make sure you also add the user ID under which the Visual Studio Analyzer Server is running. This is required in order to see measured events from this machine.<p class=tl>
To add users, you can either select a name from the <b>Names</b> box, or type a specific name (in the form <i>domain name\user ID</i>) in the <b>Add Names</b> box. Use the <b>Type of Access</b> box to allow or deny access. Click <b>OK</b> to add the user to the list.</P></li>
<li>
Click <b>Remove</b> to remove users, one at a time. In the list, select the user you want to remove, then click <b>Remove</b>.</li>
</ul>
</li>
<li>
When you are satisfied with the list of users in the Registry Value Permissions dialog box, click <b>OK</b>.</li>
</ol>
<p class=label>
<b>To restrict access to the Visual Studio Analyzer client</b>
<ol>
<li>
Start DCOMCNFG, if necessary.<br><br></li>
<li>
On the <b>Applications</b> tab, select <b>Microsoft Development Environment</b> (scroll down if necessary).<br><br></li>
<li>
Click <b>Properties</b>.<br><br></li>
<li>
Click the <b>Security</b> tab.<br><br></li>
<li>
Select <b>Use custom access permissions</b> and click <b>Edit</b>.<br><br></li>
<li>
Make sure that the user ID you specified for the Visual Studio Analyzer server to run under is included in the list of users, as well as the SYSTEM account and any users you want to be able to run Visual Studio Analyzer. To add a user ID, click <b>Add</b> and then add the user ID. Repeat until all user IDs are added.<br><br></li>
<li>
Click <b>OK</b>, then click <b>OK</b> twice more to stop Dcomcnfg.exe.</li>
</ol>
<p class=label>
<b>To edit the registry to enable security checking on the Visual Studio Analyzer server</b>
<ol>
<li>
Navigate to HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\6.0\Analyzer and select Analyzer.<br><br></li>
<li>
Click <b>Edit</b>, point to <b>New</b>, and click <b>Key</b>.<br><br></li>
<li>
Replace the supplied name of the key with <b>Security</b> and press Enter.<br><br></li>
<li>
Click <b>Edit</b>, point to <b>New</b>, and click <b>DWORD Value</b>.<br><br></li>
<li>
Replace the supplied name of the value with <b>Enable</b>.<br><br></li>
<li>
Double-click <b>Enable</b> to display the Edit DWORD Value dialog box.<br><br></li>
<li>
Type 1 in the <b>Value data</b> box and click <b>OK</b>.</li>
</ol>
<p class=label>
<b>To edit the registry to enable security checking on the Visual Studio Analyzer client</b>
<ol>
<li>
Start regedit.<br><br></li>
<li>
Navigate to HKEY_LOCAL_MACHINE\Software\Microsoft\VisualStudio\6.0 and select the 6.0 key.<br><br></li>
<li>
Click <b>Edit</b>, point to <b>New</b>, and click <b>DWORD Value</b>.<br><br></li>
<li>
Replace the supplied name of the value with <b>EnableSecurity</b> and press Enter.<br><br></li>
<li>
Double-click <b>EnableSecurity</b> to display the Edit DWORD Value dialog box.<br><br></li>
<li>
Type 1 in the <b>Value data</b> box and click <b>OK</b>.</li>
</ol>
<h3>Troubleshooting Security Problems</h3>
<p>
If you are having problems seeing particular measured events in the Filter Editor, the user ID under which the Visual Studio Analyzer Server is running might not have the necessary permissions. These permissions vary depending on the type of measured event.</p>
</BODY>
</HTML>
