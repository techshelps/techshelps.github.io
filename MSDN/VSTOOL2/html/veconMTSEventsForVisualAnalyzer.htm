<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MTS Events for Visual Studio Analyzer</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="veconmtseventsforvisualanalyzer"></a>MTS Events for Visual Studio Analyzer</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="veconMTSEventsForVisualAnalyzer_C;veconMTSEventsForVisualAnalyzerC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Tasks">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="veconMTSEventsForVisualAnalyzer_T;veconMTSEventsForVisualAnalyzerT">
</object></p>
<p>
Microsoft Transaction Server (MTS) version 1.5 is capable of generating Visual Studio Analyzer events. You can use these events to trace transaction interactions within your application.</p>
<p>
Other Microsoft-supplied technologies are also capable of generating Visual Studio Analyzer events; see <a href="veconabouteventsources.htm">Microsoft Components That Generate Visual Studio Analyzer Events</a> for a complete list.</p>
<p class=label>
<b>Visual Studio Analyzer Events Generated by MTS</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=19%><b>Event</b></td>
<td class=label width=40%><b>Event description</b></td>
<td class=label width=41%><b>Event data</b></td>
</tr>
<tr valign=top>
<td width=19%>Begin Session</td>
<td width=40%>Indicates that MTS is present and ready to start generating events for a particular session.</td>
<td width=41%>Session name, where the name is the current process ID.</td>
</tr>
<tr valign=top>
<td width=19%>MTS Disable Commit</td>
<td width=40%>Indicates that DisableCommit has been called on an object.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the MTS object identity.</p>
<p>
Correlation ID.</p>
</td>
</tr>
<tr valign=top>
<td width=19%>MTS Enable Commit</td>
<td width=40%>Indicates that EnableCommit has been called on an object.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the MTS object identity.</p>
<p>
Correlation ID.</p>
</td>
</tr>
<tr valign=top>
<td width=19%>MTS Set Complete</td>
<td width=40%>Indicates that SetComplete has been called on an object, and the object is now ready to be deactivated by MTS.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the MTS object identity.</p>
<p>
Correlation ID.</p>
</td>
</tr>
<tr valign=top>
<td width=19%>MTS Transaction Aborted</td>
<td width=40%>Indicates that a transaction has aborted.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the transaction GUID.</p>
<p>
Correlation ID.</p>
</td>
</tr>
<tr valign=top>
<td width=19%>MTS Transaction Prepared</td>
<td width=40%>Indicates that a transaction is preparing to commit, but has not actually committed yet. The MTS event system tracks only phase-one notifications of the two-phase commit protocol, so there is no notification for transaction commit.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the transaction GUID.</p>
<p>
Correlation ID.</p>
</td>
</tr>
<tr valign=top>
<td width=19%>MTS Transaction Start</td>
<td width=40%>Indicates that a transactional component has been created. This event occurs only once, when the "root" object of the transaction is created. Objects that inherit transaction context from the root object do not generate this event.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the transaction GUID.</p>
<p>
Correlation ID.</p>
<p>
Transaction stream ID.</p>
</td>
</tr>
<tr valign=top>
<td width=19%>Object Activate</td>
<td width=40%>Indicates that the object has been activated by MTS. This event occurs only if the object implements the IObjectControl interface.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the MTS object identity.</p>
<p>
Correlation ID.</p>
</td>
</tr>
<tr valign=top>
<td width=19%>Object Create</td>
<td width=40%>Indicates that an object has been created. This event will be generated only for objects with context. This means that the component must be registered as an MTS component and the object must be created using the MTS CreateInstance method.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the MTS object identity.</p>
<p>
Correlation ID.</p>
</td>
</tr>
<tr valign=top>
<td width=19%>Object Deactivate</td>
<td width=40%>Indicates that the object has been deactivated by MTS. This event occurs only if the object implements the IObjectControl interface.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the MTS object identity.</p>
<p>
Correlation ID.</p>
</td>
</tr>
<tr valign=top>
<td width=19%>Object Release</td>
<td width=40%>Indicates that an object has been released by MTS.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the MTS object identity.</p>
<p>
Correlation ID.</p>
</td>
</tr>
<tr valign=top>
<td width=19%>Package Activation</td>
<td width=40%>Indicates that an MTS package has been activated.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the MTS package globally unique identifier (GUID).</p>
<p>
Correlation ID, for matching with Package Shutdown events.</p>
</td>
</tr>
<tr valign=top>
<td width=19%>Package Shutdown</td>
<td width=40%>Indicates that an MTS package has shut down.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the MTS package globally unique identifier (GUID).</p>
<p>
Correlation ID, for matching with Package Activation events.</p>
</td>
</tr>
<tr valign=top>
<td width=19%>Resource Allocate</td>
<td width=40%>Indicates that a new resource managed by a resource dispenser has been assigned from the pool.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the MTS resource ID.</p>
<p>
Correlation ID.</p>
<p>
Resource type.</p>
</td>
</tr>
<tr valign=top>
<td width=19%>Resource Create</td>
<td width=40%>Indicates that a new resource managed by a resource dispenser has been created.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the MTS resource ID.</p>
<p>
Correlation ID.</p>
<p>
Resource type.</p>
</td>
</tr>
<tr valign=top>
<td width=19%>Resource Destroy</td>
<td width=40%>Indicates that a resource managed by a resource dispenser has been destroyed.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the MTS resource ID.</p>
<p>
Correlation ID.</p>
<p>
Resource type.</p>
</td>
</tr>
<tr valign=top>
<td width=19%>Resource Recycle</td>
<td width=40%>Indicates that a resource managed by a resource dispenser has been placed into the pool.</td>
<td width=41%>Source machine, process, thread, component, and session.<p>
Handle to the component in the form of the MTS resource ID.</p>
<p>
Correlation ID.</p>
<p>
Resource type.</p>
</td>
</tr>
</table><br>
</BODY>
</HTML>
