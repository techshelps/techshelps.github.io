<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Flags Property (Open, Save As Dialogs)</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbproflagsfile"></a>Flags Property (Open, Save As Dialogs)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vastmConst;vbproBooksOnlineJumpTopic;vbproFlagsFile_C;vbproFlagsFileC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbproFlagsFile_X;vbproFlagsFileX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbproFlagsFile_A;vbproFlagsFileA">
</object></p>
<p>
Returns or sets the options for the Open and Save As dialog boxes.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<i>object</i><b>.Flags</b> [= <i>value</i>]</p>
<p>
The <b>Flags</b> property syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=29%><b>Part</b></td>
<td class=label width=71%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=29%><i>object</i></td>
<td width=71%>An <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectexpression">
</object><a href=JavaScript:alink_4.Click()>object expression</a> that evaluates to an object in the Applies To list.</td>
</tr>
<tr valign=top>
<td width=29%><i>value</i></td>
<td width=71%>A <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defconstant">
</object><a href=JavaScript:alink_5.Click()>constant</a> or value specifying the options for the Open and Save As dialog boxes, as described in Settings.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
The settings for <i>value</i> are:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=35%><b>Constant</b></td>
<td class=label width=16%><b>Value</b></td>
<td class=label width=49%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=35%><b>cdlOFNAllowMultiselect</b></td>
<td width=16%>&amp;H200</td>
<td width=49%>Specifies that the File Name <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbdeflistbox">
</object><a href=JavaScript:alink_6.Click()>list box</a> allows multiple selections.<p>
The user can select more than one file at <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defruntime">
</object><a href=JavaScript:alink_7.Click()>run time</a> by pressing the SHIFT key and using the UP ARROW and DOWN ARROW keys to select the desired files. When this is done, the <b>FileName</b> property returns a string containing the names of all selected files. The names in the string are delimited by spaces.</p>
</td>
</tr>
<tr valign=top>
<td width=35%><b>cdlOFNCreatePrompt</b></td>
<td width=16%>&amp;H2000</td>
<td width=49%>Specifies that the dialog box prompts the user to create a file that doesn't currently exist. This flag automatically sets the <b>cdlOFNPathMustExist</b> and <b>cdlOFNFileMustExist</b> flags.</td>
</tr>
<tr valign=top>
<td width=35%><b>cdlOFNExplorer</b></td>
<td width=16%>&amp;H80000</td>
<td width=49%>Use the Explorer-like Open A File dialog box template. Works with Windows 95 and Windows NT 4.0.</td>
</tr>
<tr valign=top>
<td width=35%><b>CdlOFNExtensionDifferent</b></td>
<td width=16%>&amp;H400</td>
<td width=49%>Indicates that the extension of the returned filename is different from the extension specified by the <b>DefaultExt</b> property. This flag isn't set if the <b>DefaultExt</b> property is <b>Null</b>, if the extensions match, or if the file has no extension. This flag value can be checked upon closing the dialog box.</td>
</tr>
<tr valign=top>
<td width=35%><b>cdlOFNFileMustExist</b></td>
<td width=16%>&amp;H1000</td>
<td width=49%>Specifies that the user can enter only names of existing files in the File Name text box. If this flag is set and the user enters an invalid filename, a warning is displayed. This flag automatically sets the <b>cdlOFNPathMustExist</b> flag.</td>
</tr>
<tr valign=top>
<td width=35%><b>cdlOFNHelpButton</b></td>
<td width=16%>&amp;H10</td>
<td width=49%>Causes the dialog box to display the Help button. </td>
</tr>
<tr valign=top>
<td width=35%><b>cdlOFNHideReadOnly</b></td>
<td width=16%>&amp;H4</td>
<td width=49%>Hides the Read Only <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbdefcheckbox">
</object><a href=JavaScript:alink_8.Click()>check box</a>.</td>
</tr>
<tr valign=top>
<td width=35%><b>cdlOFNLongNames</b></td>
<td width=16%>&amp;H200000</td>
<td width=49%>Use long filenames.</td>
</tr>
<tr valign=top>
<td width=35%><b>cdlOFNNoChangeDir</b></td>
<td width=16%>&amp;H8</td>
<td width=49%>Forces the dialog box to set the current directory to what it was when the dialog box was opened.</td>
</tr>
<tr valign=top>
<td width=35%><b>CdlOFNNoDereferenceLinks</b></td>
<td width=16%>&amp;H100000</td>
<td width=49%>Do not dereference shell links (also known as shortcuts). By default, choosing a shell link causes it to be dereferenced by the shell.</td>
</tr>
<tr valign=top>
<td width=35%><b>cdlOFNNoLongNames</b></td>
<td width=16%>&amp;H40000</td>
<td width=49%>No long file names.</td>
</tr>
<tr valign=top>
<td width=35%><b>CdlOFNNoReadOnlyReturn</b></td>
<td width=16%>&amp;H8000</td>
<td width=49%>Specifies that the returned file won't have the Read Only attribute set and won't be in a write-protected directory.</td>
</tr>
<tr valign=top>
<td width=35%><b>cdlOFNNoValidate</b></td>
<td width=16%>&amp;H100</td>
<td width=49%>Specifies that the common dialog box allows invalid characters in the returned filename.</td>
</tr>
<tr valign=top>
<td width=35%><b>cdlOFNOverwritePrompt</b></td>
<td width=16%>&amp;H2</td>
<td width=49%>Causes the Save As dialog box to generate a message box if the selected file already exists. The user must confirm whether to overwrite the file.</td>
</tr>
<tr valign=top>
<td width=35%><b>cdlOFNPathMustExist</b></td>
<td width=16%>&amp;H800</td>
<td width=49%>Specifies that the user can enter only valid paths. If this flag is set and the user enters an invalid path, a warning message is displayed.</td>
</tr>
<tr valign=top>
<td width=35%><b>cdlOFNReadOnly</b></td>
<td width=16%>&amp;H1</td>
<td width=49%>Causes the Read Only check box to be initially checked when the dialog box is created. This flag also indicates the state of the Read Only check box when the dialog box is closed.</td>
</tr>
<tr valign=top>
<td width=35%><b>cdlOFNShareAware</b></td>
<td width=16%>&amp;H4000</td>
<td width=49%>Specifies that sharing violation errors will be ignored.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
The <b>cdlOFNExplorer</b> and <b>cdlOFNNoDereferenceLinks</b> flags work only under Windows 95 and Windows NT 4.0. Multiselect common dialogs under Windows 95 using <b>cdlOFNExplorer</b> use null characters for delimiters, but under previous versions of Windows NT without the Windows 95 shell, the multiselect uses spaces for delimiters (thus no support for long filenames).</p>
<p>
Under both Windows NT 4.0 and Windows 95 if you do not choose the <b>cdlOFNAllowMultiselect</b> flag, then both the <b>cdlOFNExplorer</b> and <b>cdlOFNLongNames</b> flags have no effect and are essentially the default.</p>
<p>
If you use the <b>cdlOFNAllowMultiselect</b> flag by itself under both Windows NT 4.0 and Windows 95, you will not have support for long filenames. This is because the multiple filenames come back space delimited and long filenames could include spaces. You cannot avoid this behavior if you have Windows NT 3.5. If you use <b>cdlOFNAllowMultiselect</b>, you cannot see long filenames. If you add the <b>cdlOFNExplorer</b> flag under Windows 95, you will be able to both multiselect and see long filenames. But the filenames come back null character delimited and not space delimited. Thus, using <b>cdlOFNAllowMultiselect</b> with <b>cdlOFNExplorer</b> will require different parsing of the filename result under Windows 95 and Windows NT 4.0.</p>
<p>
These constants are listed in the Microsoft CommonDialog Control (MSComDlg) <object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectlibrary">
</object><a href=JavaScript:alink_9.Click()>object library</a> in the Object Browser.</p>
<p>
You can also define selected flags. Use the <b>Const</b> keyword in the Declarations section of the startup form to define the flags you want to use. For example:</p>
<pre><code>Const ReadOnly&nbsp; = &amp;H00000001&amp;
Const Effects&nbsp; = &amp;H00000100&amp;
CommonDialog1.Flags = &amp;H10&amp; Or &amp;H200&amp;
</code></pre>
<p>
Adding the desired constant values produces the same results. The following is equivalent to the preceding example:</p>
<pre><code>CommonDialog1.Flags = &amp;H210&amp; 
</code></pre>
<p class=label>
<b>Data Type</b></p>
<p>
Long</p>
</BODY>
</HTML>
