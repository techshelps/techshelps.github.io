<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IExchExtCallback::GetNewMessageSite</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iexchextcallback_getnewmessagesite"></a>IExchExtCallback::GetNewMessageSite</h2>
<p>
Returns interface pointers to the message, message site, and view context for a new message that is being composed. Using these interface pointers, an extension object can display a form for the new message.</p>
<h4>Quick Info</h4>
<p>
See <a href="ref-c01k_62lq.htm"><b>IExchExtCallback : IUnknown</b></a>.</p>
<pre><code><b>HRESULT GetNewMessageSite(
  ULONG</b><i> fComposeInFolder</i><b>,</b>          
<b>  LPMAPIFOLDER</b><i> pfldFocus</i><b>,</b>          
<b>  LPPERSISTMESSAGE</b><i> ppermsg</i><b>,</b>        
<b>  LPMESSAGE FAR *</b><i> ppmsg</i><b>,</b>           
<b>  LPMAPIMESSAGESITE FAR *</b><i> ppmms</i><b>,</b>   
<b>  LPMAPIVIEWCONTEXT FAR *</b><i> ppmvc</i><b>,</b>   
<b>  ULONG</b><i> ulFlags                    </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>fComposeInFolder</i></dt>
<dd>
[in] Indicates whether the message is being composed in the same folder from which it was activated. If this flag is TRUE, the message site supports default behavior for posting messages, which means that the message always remains in the same folder in which it was created. If this flag is FALSE, the message site supports default behavior for sending messages, which means that messages are automatically moved to the Outbox or Inbox when the user sends or saves the message.</dd>
<dt>
<i>pfldFocus</i></dt>
<dd>
[in] Pointer to the folder in which the message is to be composed.</dd>
<dt>
<i>ppermsg</i></dt>
<dd>
[in] Pointer to a pointer to the<b> IPersistMessage</b> interface on the form for which the new message site is being obtained.</dd>
<dt>
<i>ppmsg</i></dt>
<dd>
[out] Pointer to a pointer to the message being composed.</dd>
<dt>
<i>ppmms</i></dt>
<dd>
[out] Pointer to a pointer to the MAPI message site for the new message. </dd>
<dt>
<i>ppmvc</i></dt>
<dd>
[out] Pointer to a pointer to the MAPI view context for the new message.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags. The following flag can be set:
<dl>
<dt>
EECBGNMS_MODAL</dt>
<dd>
The new form should be modal.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
No error occurred.</dd>
<dt>
E_INVALIDARG</dt>
<dd>
No session is associated with the context where the extension is installed or the <i>ulFlags</i> parameter has EECBGNMS_MODAL set.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Extension objects call the <b>IExchExtCallback::GetNewMessageSite</b> method to display a form for a new message that the user has created. For example, an extension that performs scheduling functions might have a New Meeting menu command which results in the creation of a new message and the display of a custom form that enables users to fill in the fields of the message.  </p>
<p>&nbsp;</p></body>
</HTML>
