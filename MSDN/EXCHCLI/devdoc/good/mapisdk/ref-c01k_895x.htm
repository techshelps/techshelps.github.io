<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IExchExtAttachedFileEvents::OnWritePattToSzFile</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iexchextattachedfileevents_onwritepatttoszfile"></a>IExchExtAttachedFileEvents::OnWritePattToSzFile</h2>
<p>
Replaces or enhances the behavior of Microsoft Exchange when writing attachments from a message to a file.</p>
<h4>Quick Info</h4>
<p>
See <a href="ref-c01k_69im.htm"><b>IExchExtAttachedFileEvents : IUnknown</b></a>.</p>
<pre><code><b>HRESULT OnWritePattToSzFile(
  LPATTACH</b><i> lpAtt</i><b>,</b>   
<b>  LPTSTR</b><i> lpszFile</i><b>,</b>  
<b>  ULONG</b><i> ulFlags     </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpAtt</i></dt>
<dd>
[in] Pointer to the MAPI <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_mapi1book_iattach_imapiprop">
</object><a href=JavaScript:alink_1.Click()><b>IAttach : IMAPIProp</b></a> interface on the attachment.</dd>
<dt>
<i>lpszFile</i></dt>
<dd>
[in] Pointer to a string containing the name and path of the intermediate file being written.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags. The following flag can be set: 
<dl>
<dt>
EXCHEXT_UNICODE </dt>
<dd>
The <i>lpszFile</i> parameter is a unicode string.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The extension object replaced Microsoft Exchange behavior and wrote out the file on its own. Microsoft Exchange will consider the task handled.</dd>
<dt>
S_FALSE</dt>
<dd>
The extension object did nothing or added additional behavior. Microsoft Exchange will continue to call extension objects or complete the work itself.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Microsoft Exchange calls the <b>IExchExtAttachedFileEvents::OnWritePattToSzFile</b> method when it is about to write an attachment to a file, such as when the user chooses the <b>Save</b> or <b>Open</b> button. If an error occurs, <b>OnWritePattToSzFile</b> should display an error message and return an error. Microsoft Exchange will not continue to try and write out the file, nor will it display an error message, but will stop the user action that requested the file be written.</p>
<p>&nbsp;</p></body>
</HTML>
