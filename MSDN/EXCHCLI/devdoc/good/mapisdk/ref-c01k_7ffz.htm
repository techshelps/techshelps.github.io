<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IExchExtCommands::QueryButtonInfo</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iexchextcommands_querybuttoninfo"></a>IExchExtCommands::QueryButtonInfo</h2>
<p>
Provides information about the extension object's toolbar buttons.</p>
<h4>Quick Info</h4>
<p>
See <a href="ref-c01k_15bi.htm"><b>IExchExtCommands : IUnknown</b></a>.</p>
<pre><code><b>HRESULT QueryButtonInfo(
  ULONG</b><i> tbid</i><b>,</b>        
<b>  UINT</b><i> itbb</i><b>,</b>         
<b>  LPTBBUTTON</b><i> ptbb</i><b>,</b>   
<b>  LPTSTR</b><i> lpsz</i><b>,</b>       
<b>  UINT</b><i> cch</i><b>,</b>          
<b>  ULONG</b><i> ulFlags      </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>tbid</i></dt>
<dd>
[in] Toolbar identifier.</dd>
<dt>
<i>itbb</i></dt>
<dd>
[in] Index into the list of available buttons. </dd>
<dt>
<i>ptbb</i></dt>
<dd>
[in, out] Pointer to a <b>TBBUTTON</b> toolbar button structure, which can be found in the EXCHEXT.H header file.  </dd>
<dt>
<i>lpsz</i></dt>
<dd>
[in] Pointer to a buffer in which text describing the button should be returned. This description text appears in the Customize Toolbar dialog box. This parameter can be NULL to indicate that text is not required.</dd>
<dt>
<i>cch</i></dt>
<dd>
[in] Size of the buffer pointed to by the <i>lpsz </i>parameter. </dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags. The following flag can be set:
<dl>
<dt>
EXCHEXT_UNICODE </dt>
<dd>
The <i>lpsz</i> parameter is a unicode string.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The extension object recognized the <i>itbb</i> parameter and provided information.</dd>
<dt>
S_FALSE</dt>
<dd>
The extension object did not recognize the <i>itbb </i>parameter. Microsoft Exchange will continue to call extension objects, and if necessary, provide information itself.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Microsoft Exchange calls the <b>IExchExtCommands::QueryButtonInfo</b> method when it needs information about a toolbar button. Currently only one toolbar is defined, EETB_STANDARD.  </p>
<p>
If an error is returned, Microsoft Exchange will not call other extensions and will use default or null information.</p>
<p>&nbsp;</p></body>
</HTML>
