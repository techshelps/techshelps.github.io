<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IExchExtAttachedFileEvents::OnOpenPatt</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iexchextattachedfileevents_onopenpatt"></a>IExchExtAttachedFileEvents::OnOpenPatt</h2>
<p>
Replaces or enhances the behavior of Microsoft Exchange when opening a document file attachment directly from a message.</p>
<h4>Quick Info</h4>
<p>
See <a href="ref-c01k_69im.htm"><b>IExchExtAttachedFileEvents : IUnknown</b></a>.</p>
<pre><code><b>HRESULT OnOpenPatt(
  LPATTACH</b><i> lpAtt  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpAtt</i></dt>
<dd>
[in] Pointer to the MAPI <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_mapi1book_iattach_imapiprop">
</object><a href=JavaScript:alink_1.Click()><b>IAttach : IMAPIProp</b></a><b> </b>interface on the attachment.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The extension object replaced Microsoft Exchange behavior and opened the file on its own. Microsoft Exchange will consider the task handled.</dd>
<dt>
S_FALSE</dt>
<dd>
The extension object did nothing or added additional behavior. Microsoft Exchange will continue to call extensions or complete the work itself.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Microsoft Exchange calls the<b> IExchExtAttachedFileEvents::OnOpenPatt</b> method when it is about to open an attachment directly from the message. Before writing it to an intermediate file, Microsoft Exchange allows extension objects to open directly from the attachment. File viewers might use this method to display the content of the attachment without writing an intermediate file to the file system.</p>
<p>
Microsoft Exchange attempts to find an application that is registered to handle the attached file's class. If no such application can be found, Microsoft Exchange writes the attachment to a temporary file and prompts Microsoft® Windows® operating system to start the application that is registered to handle files with the given file extension (such as .XLS for Microsoft Excel). </p>
<p>
It then calls the <b>IExchExtAttachedFileEvents::OnOpenSzFile</b> method on extension objects instantiated in the context that supports the <b>IExchExtAttachedFileEvents : IUnknown </b>interface. Microsoft Exchange may try to open an attachment from a file after learning from <b>IExchExtAttachedFileEvents::QueryDisallowOpenPatt</b> that it is allowed to do so. At this point, Microsoft Exchange prompts the extension object if it wants to do special handling of the file, such as replacing the open-attachment behavior or by doing other work such as detecting viruses.</p>
<p>
If an error occurs, <b>OnOpenPatt</b> should display an error message and return an error. Microsoft Exchange will not continue to try and open the attachment, nor will it display an error message, but will stop the user action that requested the attachment be opened. </p>
<p>&nbsp;</p></body>
</HTML>
