<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IExchExtCommands::DoCommand</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iexchextcommands_docommand"></a>IExchExtCommands::DoCommand</h2>
<p>
Carries out a menu or toolbar command chosen by the user.</p>
<h4>Quick Info</h4>
<p>
See <a href="ref-c01k_15bi.htm"><b>IExchExtCommands : IUnknown</b></a>.</p>
<pre><code><b>HRESULT DoCommand(
  LPEXCHEXTCALLBACK</b><i> lpeecb</i><b>,</b>   
<b>  UINT</b><i> cmdid                  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpeecb</i></dt>
<dd>
[in] Pointer to an <a href="ref-c01k_62lq.htm"><b>IExchExtCallback</b></a> interface.</dd>
<dt>
<i>cmdid</i></dt>
<dd>
[in] Command identifier of the command to be carried out.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The extension object recognized the <i>cmdid</i> parameter and carried out the command. Microsoft Exchange will consider the task handled.</dd>
<dt>
S_FALSE</dt>
<dd>
The extension object did not recognize the <i>cmdid </i>parameter. Microsoft Exchange will continue prompting extension objects to carry out the command and, if necessary, carry out the command itself. In some cases, an extension object might perform some action but still return S_FALSE to give other extensions the opportunity to handle the command. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
Microsoft Exchange calls the <b>IExchExtCommands::DoCommand</b> method when it receives a WM_COMMAND or WM_SYSCOMMAND message corresponding to a menu command, system menu command, or toolbar button so that the extension object  can carry out any commands it implements or supersede the Microsoft Exchange implementation of a command. The command identifier passed to WM_COMMAND is mapped to the published set of Microsoft Exchange commands. It is this published command identifier that is passed to <b>DoCommand</b> in the <i>cmdid </i>parameter. The command identifier in WM_COMMAND maps to, but is different than, the command identifier specified in the <i>cmdid </i>parameter. Extension objects should therefore not rely on this mapping.</p>
<p>
If an error occurs, <b>DoCommand</b> should display a message and return an error value. Microsoft Exchange will not continue trying to perform the command nor will it display a message.</p>
<p>
The system command identifiers that extensions can override include:</p>
<p>
SC_CLOSE<br>
SC_MAXIMIZE<br>
SC_MINIMIZE<br>
SC_MOVE<br>
SC_RESTORE<br>
SC_SIZE<br>
SC_TASKLIST</p>
<p>
These commands are standard wparam values for the WM_SYSCOMMAND message.</p>
<p>&nbsp;</p></body>
</HTML>
