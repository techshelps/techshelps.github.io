<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Registering Extensions</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mapi1book_registering_extensions"></a>Registering Extensions</h1>
<p>
Before an extension can be used within the Microsoft Exchange client, it must be registered. Registering an extension lets Microsoft Exchange know about its existence and provides other information about the extension so that Microsoft Exchange can work with it in an efficient manner.</p>
<p>
On 16-bit versions of Windows, extensions are registered by adding entries to the [Extensions] section of the EXCHNG.INI file. These 16-bit clients include Windows 3.1 and Windows for Workgroups 3.x. Information on shared extensions is read from the [Extensions] section of the SHARED.INI file on 16-bit versions of Windows.  </p>
<p>
On 32-bit versions of Windows, Microsoft Exchange obtains extension-specific information from HKEY_LOCAL_MACHINE\Software\Microsoft\Exchange\Client\Extensions in the Windows NT or Windows 95 registry. </p>
<p>
Information on shared extensions is read from the SHARED32.INI file on these 32-bit versions of Windows. The location of the SHARED.INI file is specified by the SharedExtsDir entry in the [Exchange] section of the EXCHNG.INI file. The location of the SHARED32.INI file is specified in the SharedExtsDir entry in HKEY_LOCAL_MACHINE\Software\Microsoft\Exchange\Client\Extensions.</p>
<p>
If the directory is on a network drive, the SharedExtsServer entry can contain the name of the server and the SharedExtsPassword entry contains an unencrypted password. If this is the case, a connection to the server is made without redirecting a local device name.</p>
<p>
The 32-bit clients cannot use 16-bit extensions, nor can 16-bit clients use 32-bit extensions. </p>
<p>
When registering an extension, a specific syntax places your entry in the .INI file or registry. This syntax is as follows:</p>
<p>
Tag=Version;<b>&lt;ExtsDir&gt;</b>DllName;[Ordinal];[ContextMap];[InterfaceMap];[Provider]</p>
<p>
The following table shows the parameters used in the syntax line.</p>
<table cellspacing=4 cols=2 width=464>
<tr valign=top>
<th align=left width=18%>Parameter</th>
<th align=left width=82%>Description</th>
</tr>
<tr valign=top>
<td width=18%>Tag</td>
<td width=82%>An extension identifier that uniquely identifies the .INI entry from other .INI entries.</td>
</tr>
<tr valign=top>
<td width=18%>Version</td>
<td width=82%>The version number of the Microsoft Exchange client; for example '4.0'.</td>
</tr>
<tr valign=top>
<td width=18%>DLLName</td>
<td width=82%>The path to the DLL containing the extension.</td>
</tr>
<tr valign=top>
<td width=18%>Ordinal</td>
<td width=82%>An optional field that specifies the entry point in the DLL to retrieve the extension object. If this field is empty, the default value is 1.</td>
</tr>
<tr valign=top>
<td width=18%>ContextMap</td>
<td width=82%>An optional string made up of '0' and '1' characters which indicates the contexts in which the extension should be loaded. Any unspecified values after the end of the string are assumed to be zero. If no context map is provided, the extension will be loaded in all contexts. For more information on context map bit positions, see the table later in this section.</td>
</tr>
<tr valign=top>
<td width=18%>InterfaceMap</td>
<td width=82%>An optional string made up of '0' and '1' characters that indicates the interfaces the extension supports. Although supported interfaces can be obtained through <b>IUnknown::QueryInterface</b>, registering which interfaces your extension supports can increase system performance. For more information on interface map bit positions, see the table later in this section.</td>
</tr>
<tr valign=top>
<td width=18%>Message Service</td>
<td width=82%>An optional string containing the PR_SERVICE_NAME, not the display name, of a message service that your extension is designed to work with. For example, if your extension is designed to work with a custom address book, place the PR_SERVICE_NAME of the address book in this parameter. If your extension is not provider-specific, this parameter should be omitted.</td>
</tr>
</table><br>
<p>
An example of this syntax is:</p>
<pre><code>MyExtension=4.0;&lt;ExtsDir&gt;MYEXT.DLL;2;010001;1100000
 </code></pre>
<p>
In this example, EECONTEXT_VIEWER=0x00000002 and EECONTEXT_SENDNOTEMESSAGE =0x00000006 so the ContextMap string '010001' indicates that the extension located at MYEXT.DLL;2 should be loaded only for these two contexts. The interface map, specified by the string 1100000, indicates that the extension implements only the <b>IExchExtCommands : IUnknown</b> and <b>IExchExtUserEvents : IUnknown</b> interfaces.</p>
<p>
Throughout the string, all occurrences of the string '&lt;ExtsDir&gt;' are replaced with the value of the SharedExtsDir entry described below. Extensions that are not shared should not use this.</p>
<p>
The following tables indicate which positions in the Context Map and Interface Map correspond to which contexts and interfaces, respectively.</p>
<p>
<b>Context Map Bit Positions</b></p>
<table cellspacing=4 cols=2 width=464>
<tr valign=top>
<th align=left width=17%>Position</th>
<th align=left width=83%>Context</th>
</tr>
<tr valign=top>
<td width=17%>1</td>
<td width=83%>EECONTEXT_SESSION</td>
</tr>
<tr valign=top>
<td width=17%>2</td>
<td width=83%>EECONTEXT_VIEWER</td>
</tr>
<tr valign=top>
<td width=17%>3</td>
<td width=83%>EECONTEXT_REMOTEVIEWER</td>
</tr>
<tr valign=top>
<td width=17%>4</td>
<td width=83%>EECONTEXT_SEARCHVIEWER</td>
</tr>
<tr valign=top>
<td width=17%>5</td>
<td width=83%>EECONTEXT_ADDRBOOK</td>
</tr>
<tr valign=top>
<td width=17%>6</td>
<td width=83%>EECONTEXT_SENDNOTEMESSAGE</td>
</tr>
<tr valign=top>
<td width=17%>7</td>
<td width=83%>EECONTEXT_READNOTEMESSAGE</td>
</tr>
<tr valign=top>
<td width=17%>8</td>
<td width=83%>EECONTEXT_SENDPOSTMESSAGE</td>
</tr>
<tr valign=top>
<td width=17%>9</td>
<td width=83%>EECONTEXT_READPOSTMESSAGE</td>
</tr>
<tr valign=top>
<td width=17%>10</td>
<td width=83%>EECONTEXT_READREPORTMESSAGE</td>
</tr>
<tr valign=top>
<td width=17%>11</td>
<td width=83%>EECONTEXT_SENDRESENDMESSAGE</td>
</tr>
<tr valign=top>
<td width=17%>12</td>
<td width=83%>EECONTEXT_PROPERTYSHEETS</td>
</tr>
<tr valign=top>
<td width=17%>13</td>
<td width=83%>EECONTEXT_ADVANCEDCRITERIA</td>
</tr>
<tr valign=top>
<td width=17%>14</td>
<td width=83%>EECONTEXT_TASK</td>
</tr>
</table><br>
<p>
<b>Interface Map Bit Positions</b></p>
<table cellspacing=4 cols=2 width=464>
<tr valign=top>
<th align=left width=17%>Position</th>
<th align=left width=83%>Interface</th>
</tr>
<tr valign=top>
<td width=17%>1</td>
<td width=83%><a href="ref-c01k_15bi.htm"><b>IExchExtCommands</b></a></td>
</tr>
<tr valign=top>
<td width=17%>2 </td>
<td width=83%><a href="ref-c01k_8ka6.htm"><b>IExchExtUserEvents</b></a></td>
</tr>
<tr valign=top>
<td width=17%>3</td>
<td width=83%><a href="ref-c01k_25ny.htm"><b>IExchExtSessionEvents</b></a></td>
</tr>
<tr valign=top>
<td width=17%>4</td>
<td width=83%><a href="ref-c01k_9r8u.htm"><b>IExchExtMessageEvents</b></a></td>
</tr>
<tr valign=top>
<td width=17%>5</td>
<td width=83%><a href="ref-c01k_69im.htm"><b>IExchExtAttachedFileEvents</b></a></td>
</tr>
<tr valign=top>
<td width=17%>6</td>
<td width=83%><a href="ref-c01k_37la.htm"><b>IExchExtPropertySheets</b></a></td>
</tr>
<tr valign=top>
<td width=17%>7</td>
<td width=83%><a href="ref-c01k_8jam.htm"><b>IExchExtAdvancedCriteria</b></a></td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
