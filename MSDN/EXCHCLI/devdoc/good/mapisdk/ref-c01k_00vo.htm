<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IExchExtAttachedFileEvents::QueryDisallowOpenPatt</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iexchextattachedfileevents_querydisallowopenpatt"></a>IExchExtAttachedFileEvents::QueryDisallowOpenPatt</h2>
<p>
Prevents a file attachment from being opened directly without writing it first to an intermediate file.</p>
<h4>Quick Info</h4>
<p>
See <a href="ref-c01k_69im.htm"><b>IExchExtAttachedFileEvents : IUnknown</b></a>.</p>
<pre><code><b>HRESULT QueryDisallowOpenPatt(
  LPATTACH</b><i> lpAtt  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpAtt</i></dt>
<dd>
[in] Pointer to the MAPI <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_mapi1book_iattach_imapiprop">
</object><a href=JavaScript:alink_1.Click()><b>IAttach : IMAPIProp</b></a> interface on the attachment.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The extension object will prevent other extensions or Microsoft Exchange from opening the attachment directly without writing it to a file first.</dd>
<dt>
S_FALSE</dt>
<dd>
The extension object did nothing. Microsoft Exchange will call other extension objects if opening the attachment directly ought to be disallowed.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Microsoft Exchange calls the <b>IExchExtAttachedFileEvents::QueryDisallowOpenPatt</b> method when it is about to open the attachment directly without writing it first to an intermediate file. An extension object might elect to disallow opening attachments directly if it has encrypted or modified the attachment and should decrypt or restore it to an intermediate file.</p>
<p>
If an error occurs, <b>QueryDisallowOpenPatt </b>should display an error message and return an error. Microsoft Exchange will not continue to try to open the file, nor will it display an error message, but will stop the user action that requested the attachment be opened.</p>
<p>&nbsp;</p></body>
</HTML>
