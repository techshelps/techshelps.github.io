<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IExchExtAttachedFileEvents::OnOpenSzFile</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iexchextattachedfileevents_onopenszfile"></a>IExchExtAttachedFileEvents::OnOpenSzFile</h2>
<p>
Replaces or enhances the behavior of Microsoft Exchange when opening an attachment from a temporary file.</p>
<h4>Quick Info</h4>
<p>
See <a href="ref-c01k_69im.htm"><b>IExchExtAttachedFileEvents : IUnknown</b></a>.</p>
<pre><code><b>HRESULT OnOpenSzFile(
  LPTSTR</b><i> lpszFile</i><b>,</b>   
<b>  ULONG</b><i> ulFlags      </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszFile</i></dt>
<dd>
[in] Pointer to a string containing the name and path of the temporary file being opened.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags. Set this parameter to one of the following values:
<dl>
<dt>
EXCHEXT_UNICODE</dt>
<dd>
The <i>lpszFile</i> parameter is a unicode string.</dd>
<dt>
EEAFE_OPEN</dt>
<dd>
The attachment is being opened. </dd>
<dt>
EEAFE_PRINT </dt>
<dd>
The attachment is being printed.</dd>
<dt>
EEAFE_QUICKPREVIEW</dt>
<dd>
The attachment is being quickviewed.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The extension object replaced Microsoft Exchange behavior and opened the file on its own. Microsoft Exchange will consider the task handled.</dd>
<dt>
S_FALSE</dt>
<dd>
The extension object did nothing or added additional behavior. Microsoft Exchange will continue to call extensions or, if necessary, open the file attachment itself.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Microsoft Exchange calls the <b>IExchExtAttachedFileEvents::OnOpenSzFile</b> method when it is about to open an attachment, but was not able to open it directly from the data in the attachment in the message. When this occurs, the attachment data is written to an intermediate file. Microsoft Exchange attempts to find an application that is registered to handle the attached file's class. If it finds it, the application is started and prompted to open the attachment.</p>
<p>
If an error occurs, <b>OnOpenSzFile</b> should display an error message and return an error. Microsoft Exchange will not continue to try and open the attachment, nor will it display an error message, but will stop the user action that requested the attachment be opened.</p>
<p>&nbsp;</p></body>
</HTML>
