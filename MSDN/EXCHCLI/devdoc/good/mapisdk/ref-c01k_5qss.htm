<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IExchExt::Install</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iexchext_install"></a>IExchExt::Install</h2>
<p>
Enables an extension object to determine the context into which it is being loaded, along with information about that context. The MAPI and user interface information that can be retrieved by the extension includes session, store, viewer, note form, and address book information.</p>
<h4>Quick Info</h4>
<p>
See <a href="ref-c01k_2p4e.htm"><b>IExchExt : IUnknown</b></a>.</p>
<pre><code><b>HRESULT Install(
  LPEXCHEXTCALLBACK</b><i> lpeecb</i><b>,</b>   
<b>  ULONG</b><i> eecontext<b>,</b></i>            
<b>  ULONG</b><i> ulFlags               </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpeecb</i></dt>
<dd>
[in] Pointer to an <b>IExchExtCallback</b> interface. </dd>
<dt>
<i>eecontext</i></dt>
<dd>
[in] Indicates the currently active Microsoft Exchange context. This parameter can have the following values:
<dl>
<dt>
EECONTEXT_TASK</dt>
<dd>
The context where the Microsoft Exchange client application has started but has not yet logged in. This context begins when the Microsoft Exchange application starts, and ends when the Microsoft Exchange application exits. This context does not correspond to a window. This is the first context in which extensions are loaded.</dd>
<dt>
EECONTEXT_SESSION</dt>
<dd>
The duration of a Microsoft Exchange session. This context and EECONTEXT_TASK are the only contexts that do not correspond to a specific window.</dd>
<dt>
EECONTEXT_VIEWER</dt>
<dd>
The main Viewer window that displays the folder hierarchy in the left pane and folder contents in the right pane.</dd>
<dt>
EECONTEXT_REMOTEVIEWER</dt>
<dd>
The remote Viewer window that is displayed when the user chooses the <b>Remote Mail</b> command from the <b>Tools</b> menu in the Microsoft Exchange client.</dd>
<dt>
EECONTEXT_SEARCHVIEWER</dt>
<dd>
The search Viewer window that is displayed when the user chooses the <b>Find</b> button from the <b>Tools</b> menu in the Microsoft Exchange client. </dd>
<dt>
EECONTEXT_ADDRBOOK</dt>
<dd>
The Address Book dialog box that is displayed when the user chooses the <b>Address Book</b> button from the <b>Tools</b> menu in the Microsoft Exchange client.</dd>
<dt>
EECONTEXT_SENDNOTEMESSAGE</dt>
<dd>
The standard send note window in which messages of the IPM.Note class are composed. </dd>
<dt>
EECONTEXT_READNOTEMESSAGE</dt>
<dd>
The standard read note window in which messages of the IPM.Note class are read after they are received.</dd>
<dt>
EECONTEXT_SENDPOSTMESSAGE</dt>
<dd>
The standard posting window in which new IPM.Post posting messages are composed.</dd>
<dt>
EECONTEXT_READPOSTMESSAGE</dt>
<dd>
The standard posting window in which existing posting messages are read.</dd>
<dt>
EECONTEXT_READREPORTMESSAGE</dt>
<dd>
The read report message window in which the Read, Delivery, Non-Read, and Non-Delivery report messages are read after they are received.</dd>
<dt>
EECONTEXT_SENDRESENDMESSAGE</dt>
<dd>
The send-resend message window that is displayed when the user chooses the <b>Send Again</b> button from the nondelivery report.</dd>
<dt>
EECONTEXT_PROPERTYSHEETS</dt>
<dd>
A property sheet window.</dd>
<dt>
EECONTEXT_ADVANCEDCRITERIA</dt>
<dd>
Any window in which the user specifies advanced search criteria. In Microsoft Exchange, this is a window brought up by the <b>Find</b> button from the <b>Tools</b> menu, or the dialog box brought up by the <b>Filter</b> button.</dd>
</dl>
</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
[in] Bitmask of flags. The following flag can be set: 
<dl>
<dt>
EE_MODAL </dt>
<dd>
The extension is being installed into a context where modal windows are displayed. Extensions that are loaded into modal contexts should only display modal windows.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The extension object elects to run in this context.</dd>
<dt>
S_FALSE</dt>
<dd>
The extension object does not elect to run in this context and will be released immediately.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Microsoft Exchange calls the <b>IExchExt::Install</b> method to enable an extension object to determine the context into which it is being loaded, along with information about that context. The context is determined using the callback object returned in the <i>lpeecb</i> parameter. The user interface context is described by the value of the <i>eecontext </i>parameter.</p>
<p>
<b>IExchExtCallback::GetVersion</b> is often called during <b>Install</b> to ensure that the version of the Microsoft Exchange client is compatible with your extension object.</p>
<p>
<b>IExchExtCallback::GetObject</b> is often called during <b>Install</b> to determine whether the currently selected object in the Microsoft Exchange user interface is the type your extension object supports. When <b>Install</b> is called with the property sheet's context, your extension object should make sure the selected object matches the type of property sheet that is provided to the extension. </p>
<p>
HRESULT return values other than S_OK and S_FALSE indicate that the extension object has encountered an error and Microsoft Exchange will not load the extension object.</p>
<h4>See Also</h4>
<p>
<a href="ref-c01k_9kq6.htm"><b>IExchExtCallback::GetVersion</b></a>, <a href="ref-c01k_49tg.htm"><b>IExchExtCallback::GetObject</b></a></p>
<p>&nbsp;</p></body>
</HTML>
