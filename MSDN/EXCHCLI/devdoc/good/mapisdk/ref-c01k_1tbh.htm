<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IExchExtCallback::GetSelectionItem</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iexchextcallback_getselectionitem"></a>IExchExtCallback::GetSelectionItem</h2>
<p>
Returns the entry identifier and other information of the currently selected item in a Microsoft Exchange window.</p>
<h4>Quick Info</h4>
<p>
See <a href="ref-c01k_62lq.htm"><b>IExchExtCallback : IUnknown</b></a>.</p>
<pre><code><b>HRESULT GetSelectionItem(
  ULONG</b><i> ieid</i><b>,</b>             
<b>  ULONG FAR *</b><i> lpcbeid</i><b>,</b>    
<b>  LPENTRYID FAR *</b><i> lppeid</i><b>,</b>   
<b>  ULONG FAR *</b><i> lpulType</i><b>,</b>   
<b>  LPTSTR</b><i> lpszMsgClass</i><b>,</b>    
<b>  ULONG</b><i> cbMsgClass</i><b>,</b>       
<b>  ULONG FAR *</b><i> lpulMsgFlags</i><b>,</b>   
<b>  ULONG</b><i> ulFlags           </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ieid</i></dt>
<dd>
[in] Index of the entry identifier to be retrieved. Valid values for this parameter are 0 to <i>lpceid</i> -1 where <i>lpceid </i>is returned in the<b> IExchExtCallback::GetSelectionCount </b>method.</dd>
<dt>
<i>lpcbeid</i></dt>
<dd>
[out] Pointer to the number of bytes returned in the <i>lppeid</i> parameter.</dd>
<dt>
<i>lppeid</i></dt>
<dd>
[out] Pointer to a pointer to the entry identifier of the selection.</dd>
<dt>
<i>lpulType</i></dt>
<dd>
[out] Pointer to the type of entry identifier returned in the <i>lppeid </i>parameter. This parameter can have the following values:
<p>
MAPI_STORE = 1, if <i>lppeid</i> refers to a message store.

<p>
MAPI_ADDRBOOK = 2, if <i>lppeid</i> refers to an address book.

<p>
MAPI_FOLDER = 3, if <i>lppeid</i> refers to a folder.

<p>
MAPI_MESSAGE = 5, if <i>lppeid</i> refers to a message.
</dd>
<dt>
<i>lpszMsgClass</i></dt>
<dd>
[in, out] Pointer to a buffer into which Microsoft Exchange will copy the message class of the selected message.</dd>
<dt>
<i>cbMsgClass</i></dt>
<dd>
[out] Size of the message class.</dd>
<dt>
<i>lpulMsgFlags</i></dt>
<dd>
[out] Pointer to the message flags returned. See the MAPI <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_mapi1book_pr_message_flags">
</object><a href=JavaScript:alink_1.Click()>PR_MESSAGE_FLAGS</a> property.</dd>
<dt>
<i>ulFlags</i></dt>
<dd>
Reserved; must be zero.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
No errors occurred.</dd>
<dt>
S_FAIL</dt>
<dd>
Microsoft Exchange failed to access the selected item.</dd>
<dt>
E_INVALIDARG</dt>
<dt>
The <i>ulFlags</i> parameter is not fMapiUnicode or it is called from an invalid context that does not support the selected item.</dt>
<dd>
</dd>
</dl>
<h4>Remarks</h4>
<p>
The<b> IExchExtCallback::GetSelectionItem</b> method is used to return the entry identifier of the currently selected item in a Microsoft Exchange Window. For example, if a custom form is installed and the user selects this form, extension objects that implement the <b>IExchExtUserEvents::OnSelectionChange</b> method can use <b>GetSelectionItem</b> to determine the message class of the selected message. If the extension object is programmed to handle messages of this class, it might display or enable menu items specific to the message class.</p>
<p>
If a parameter is not used in this method, pass NULL for that parameter.</p>
<h4>See Also</h4>
<p>
<a href="ref-c01k_2rqt.htm"><b>IExchExtCommands::InitMenu</b></a></p>
<p>&nbsp;</p></body>
</HTML>
