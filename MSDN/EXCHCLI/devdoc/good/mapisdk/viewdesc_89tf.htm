<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Reading a View's Restriction Property Values</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_reading_a_views_restriction_property_values"></a>Reading a View's Restriction Property Values</h2>
<p>
When reading a restriction from the view description streams, there are cases where you must read the property values. For more information, see <a href="viewdesc_138u.htm">Reading a View's Row Restriction</a>.</p>
<p>
The procedure for reading the property values for a view restriction assumes that the following parameters were passed to this function:
<dl>
<dt>
<i>Pstm</i></dt>
<dd>
A stream on the PR_VD_BINARY property.</dd>
<dt>
<i>pstmSz</i></dt>
<dd>
A stream on the PR_VD_STRINGS property.</dd>
<dt>
<i>pib</i></dt>
<dd>
An input buffer.</dd>
<dt>
<i>presRoot</i></dt>
<dd>
The root of the restriction being read.</dd>
<dt>
<i>pcval</i></dt>
<dd>
Pointer to the number of property values to read.</dd>
<dt>
<i>ppval</i></dt>
<dd>
Pointer to an array of pointers to property values to read.
</dd>
</dl>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To read the property values for a view restriction</h5>
<ol>
<li>
Read a ULONG from the binary stream to get the count of the number of property values to read. If the count is zero, the view descriptor is invalid.</li>
<li>
Use <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_mapi1book_mapiallocatemore">
</object><a href=JavaScript:alink_1.Click()><b>MAPIAllocateMore</b></a> to enlarge the memory allocated to <i>presRoot</i> by the number of properties to be read times the size of <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_mapi1book_spropvalue">
</object><a href=JavaScript:alink_2.Click()><b>SPropValue</b></a>.</li>
<li>
Declare a pointer to a property value (<b>SPropValue</b> * <i>pval</i>)</li>
<li>
Read the properties into the end of the <i>presRoot</i>. This can be done all at once because they are packed in the binary stream and point <i>pval</i> to the first property read in.</li>
<li>
For each property value read in:<p>
If <i>pval</i>-&gt;<b>ulPropTag</b> == PT_BINARY, append the binary bytes onto the end of <i>presRoot</i> by using <b>MAPIAllocateMore</b> to allocate the number of bytes specified in <i>pval</i>-&gt;Value.bin.cb and then reading the bytes from the binary stream into the newly allocated space.
<p>
If <i>pval</i>-&gt;<b>ulPropTag</b> == PT_TSTRING, read the string from the string stream. Allocate sufficient memory to the end of <i>presRoot</i> by using <b>MAPIAllocateMore</b>, and then copy the string into the newly allocated space.
</li>
</ol>
<p>
For all other properties, there is no additional information to read.</p>
<p>&nbsp;</p></body>
</HTML>
