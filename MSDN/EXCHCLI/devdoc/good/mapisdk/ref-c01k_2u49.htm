<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IExchExtSessionEvents::OnDelivery</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iexchextsessionevents_ondelivery"></a>IExchExtSessionEvents::OnDelivery</h2>
<p>
Replaces or enhances the behavior of Microsoft Exchange when a new message arrives.</p>
<h4>Quick Info</h4>
<p>
See <a href="ref-c01k_25ny.htm"><b>IExchExtSessionEvents : IUnknown</b></a>.</p>
<pre><code><b>HRESULT OnDelivery(
  LPEXCHEXTCALLBACK</b><i> lpeecb  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpeecb</i></dt>
<dd>
[in] Pointer to the <a href="ref-c01k_62lq.htm"><b>IExchExtCallback</b></a> interface. The <i>lpeecb </i>parameter is used to determine information about the message or messages which have arrived.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The extension object replaced Microsoft Exchange default behavior with its own behavior. Microsoft Exchange will consider the task handled.</dd>
<dt>
S_FALSE</dt>
<dd>
The extension object did nothing or added additional behavior. Microsoft Exchange will continue to call extension objects or complete the work itself.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>IExchExtSessionEvents::OnDelivery</b> method is used to replace or enhance the behavior of Microsoft Exchange when a new message arrives. If an error occurs, <b>OnDelivery</b> should display an error message and return an error value. Microsoft Exchange will not notify the user about the new message, nor will it display an error message or continue to call extension objects in response to the new message.</p>
<p>
When a new message arrives, the extension object obtains its message identifier by calling the <b>IExchExtCallback::GetObject </b>method.</p>
<h4>See Also</h4>
<p>
<a href="ref-c01k_49tg.htm"><b>IExchExtCallback::GetObject</b></a></p>
<p>&nbsp;</p></body>
</HTML>
