<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Reading a View's Columns</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_reading_a_views_columns"></a>Reading a View's Columns</h2>
<p>
The columns are read from the binary stream immediately after the <a href="viewdesc_5xwk.htm"><b>VD</b></a> structure is read. The <b>VD</b> structure is the first block of data in this stream. </p>
<p>
The <i>cvcd</i> member of the VD structure contains the number of columns.  The number of columns in the view will be stored in <i>pvd</i>-&gt;<b>cvcd</b>, where <i>pvd</i> is a pointer to a <b>VD</b>. You will need to declare a pointer to the pvcd parameter in the  <a href="viewdesc_09wk.htm"><b>VCD</b></a> structure to hold the view column descriptors. With this information, the following steps are necessary to read in the view's column descriptors.
<ol>
<li>
Allocate memory for the array of <b>VCD</b> structures. The size of the allocation must be the number of the columns in the view (<i>cvcd</i>) plus one, times the size of the VCD structure. There is one extra element to hold the parent display column which is appended on the end.</li>
<li>
For each <b>VCD </b>structure,<ol type=a>
<li>
Read the structure from the stream.</li>
<li>
If the <b>VCD</b> structure has a named property (that is, VCDF_NAMEDPROP set in <i>pvcd</i>-&gt;<b>ulFlags</b>), you must read it in. To read the named property, allocate a pointer to hold a <b>GUID</b> structure, and read the <b>GUID</b> from the binary stream. The pointer to the <b>GUID</b> structure should be saved in </li>
<li value=16>
<i>pvcd</i>-&gt;<b>mnid</b>-&gt;<b>lpguid</b>.<p>
If the named property has a string (that is, <i>pvcd</i>-&gt;<b>mnid</b>-&gt;<b>ulKind</b> == MNID_STRING), read it from the binary stream. The first DWORD is the length of the string, the string immediately follows in the stream. The pointer to the string should be saved in 
<p>
<i>pvcd</i>-&gt;<b>mnid</b>-&gt; <b>lpwstrName</b>.
</li>
<li value=3>
Read the column display name from the string stream and store the pointer with the column descriptor.</li>
</ol>
</li>
</ol>
<p>
Because named property identifiers are imbedded between <b>VCD </b>structures in the stream, you cannot read all <b>VCD</b> structures at once.</p>
<p>
The 'drag column' must be the first column in the view descriptor. This column is used to drag-select a number of messages without invoking the move message operation. This column can be seen in the heading of the main viewer as a narrow rectangle. </p>
<p>
The 'action icon' column is added to a view column descriptor for the remote views. This column indicates whether the message is to be downloaded or not. </p>
<p>
The 'parent display' column is a column added to the end of views defined in the Finder. This column is labeled 'In Folder' in the finder's viewer.</p>
<p>&nbsp;</p></body>
</HTML>
