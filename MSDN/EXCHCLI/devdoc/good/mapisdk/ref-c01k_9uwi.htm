<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IExchExtCallback::ChooseFolder</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iexchextcallback_choosefolder"></a>IExchExtCallback::ChooseFolder</h2>
<p>
Displays a dialog box that enables users to choose a specific message store and folder.</p>
<h4>Quick Info</h4>
<p>
See <a href="ref-c01k_62lq.htm"><b>IExchExtCallback : IUnknown</b></a>.</p>
<pre><code><b>HRESULT ChooseFolder(
  LPEXCHEXTCHOOSEFOLDER</b><i> peecf  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>peecf</i></dt>
<dd>
[in] Pointer to a structure that describes the <b>Choose Folder</b> dialog box. The structure also includes output members that provide information about the selections made by the user when the user chooses the <b>OK</b> button. The structure has the following members:
<dl>
<dt>
<b>UINT cbLength</b></dt>
<dd>
Input member indicating the size of the structure.</dd>
<dt>
<b>HWND hwnd</b></dt>
<dd>
Input member indicating the parent window of the <b>Choose Folder</b> dialog box.</dd>
<dt>
<b>LPTSTR szCaption</b></dt>
<dd>
Input member indicating the caption that is displayed in the dialog box's title bar. </dd>
<dt>
<b>LPTSTR szLabel</b></dt>
<dd>
Input member indicating a label that is displayed at the top of the list box of folders.</dd>
<dt>
<b>LPTSTR szHelpFile</b></dt>
<dd>
Input member specifying which Help file should be launched when the user chooses the <b>Help</b> button.</dd>
<dt>
<b>ULONG ulHelpID</b></dt>
<dd>
Input member indicating the topic that should be referenced in the Help file.</dd>
<dt>
<b>HINSTANCE hinst</b></dt>
<dd>
Input member indicating the instance handle containing the resource of a custom dialog box. Set this value only if you want to supply your own dialog box template.</dd>
<dt>
<b>UINT uiDlgID</b></dt>
<dd>
Input member indicating the resource identifier of the instance of the custom dialog box template. Set this value only if you set the <i>hinst </i>parameter. </dd>
<dt>
<b>LPEECFHOOKPROC lpeecfhp</b></dt>
<dd>
Input member indicating a hook proc pointer. Set this value only if you want to do special processing of messages within the dialog box.</dd>
<dt>
<b>DWORD dwHookData</b></dt>
<dd>
Input member used to cache additional information about events that occur while the dialog box is displayed. Use this member if you are providing a hook process for handling dialog box messages.</dd>
<dt>
<b>ULONG ulFlags</b></dt>
<dd>
Input member containing a bitmask of flags. The following flags can be set:
<table cellspacing=4 cols=2 width=446>
<tr valign=top>
<td width=38%>&nbsp;&nbsp;&nbsp;&nbsp;EECBCF_GETNAME</td>
<td width=62%>The name of the folder selected by the user is returned. This name must be freed using the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_mapi1book_mapifreebuffer">
</object><a href=JavaScript:alink_1.Click()><b>MAPIFreeBuffer</b></a><b> </b>function.</td>
</tr>
<tr valign=top>
<td width=38%>&nbsp;&nbsp;&nbsp;&nbsp;EECBCF_HIDENEW</td>
<td width=62%>Hides the <b>New</b> button on <b>the Choose Folder</b> dialog box. This button enables users to create a new folder. </td>
</tr>
<tr valign=top>
<td width=38%>&nbsp;&nbsp;&nbsp;&nbsp;EECBCF_PREVENTROOT</td>
<td width=62%>Disables the <b>OK</b> button when the root is the currently selected folder. In most cases, this flag should be specified because the root folder is not a valid container of messages.</td>
</tr>
</table><br>

</dd>
<dt>
<b>LPMDB pmdb</b></dt>
<dd>
Output member that is an interface pointer to the message store object selected in the <b>Choose Folder</b> dialog box.</dd>
<dt>
<b>LPMAPIFOLDER pfld</b></dt>
<dd>
Output member that is an interface pointer to the folder object selected in the <b>Choose Folder</b> dialog box.</dd>
<dt>
<b>LPTSTR szName</b></dt>
<dd>
Output member indicating the name of the folder the user selected. This value enables you to get the name of the folder without using a MAPI <b>GetProps</b> method. This value is only provided if the EECBCF_GETNAME flag is set.</dd>
<dt>
<b>DWORD dwReserved1 - dwReserved3</b></dt>
<dd>
These three members are reserved for future use and should be set to NULL by extensions.
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
No errors occurred.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Extension objects call the <b>IExchExtCallback::ChooseFolder</b> method to enable users to select a specific message store or folder. For example, if your application provides a backup command, you might want to prompt the user to specify which folder in which message store should be backed up.</p>
<p>&nbsp;</p></body>
</HTML>
