<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IExchExtMessageEvents::OnSubmit</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_mapi1book_iexchextmessageevents_onsubmit"></a>IExchExtMessageEvents::OnSubmit</h2>
<p>
Replaces or enhances the behavior of Microsoft Exchange when a message has been submitted.</p>
<h4>Quick Info</h4>
<p>
See <a href="ref-c01k_9r8u.htm"><b>IExchExtMessageEvents : IUnknown</b></a>.</p>
<pre><code><b>HRESULT OnSubmit(
  LPEXCHEXTCALLBACK</b><i> lpeecb  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpeecb</i></dt>
<dd>
[in] Pointer to the <a href="ref-c01k_62lq.htm"><b>IExchExtCallback</b></a> interface. The <i>lpeecb</i> parameter is used to determine information about the message being submitted and the window whose controls were saved.
</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
S_OK</dt>
<dd>
The extension object replaced Microsoft Exchange behavior and handled the submission on its own. Microsoft Exchange will consider the task handled.</dd>
<dt>
S_FALSE</dt>
<dd>
The extension object did nothing or added additional behavior. Microsoft Exchange will continue to call extensions or complete the work itself.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Microsoft Exchange calls the <b>IExchExtMessageEvents::OnSubmit</b> method when it is about to submit an open message. At this point, the information will have been written to the message.</p>
<p>
If an error occurs, <b>OnSubmit</b> should display an error message and return an error. Microsoft Exchange will not submit the message, nor will it display an error message, but will stop the user action that caused the submit.</p>
<p>
This method should call the <b>IExchExtCallback::GetObject</b> method to determine the message identifier of the item being submitted and its container. The container is usually a folder, but it can also be a message or an information store. </p>
<h4>See Also</h4>
<p>
<a href="ref-c01k_49tg.htm"><b>IExchExtCallback::GetObject</b></a>, <a href="ref-c01k_9r8u.htm"><b>IExchExtMessageEvents : IUnknown</b></a></p>
<p>&nbsp;</p></body>
</HTML>
