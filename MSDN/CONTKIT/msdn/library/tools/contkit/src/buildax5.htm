<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Accessing Dynamic HTML </title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<p>&nbsp;</p>

<h2><font size="2" face="VERDANA,ARIAL,HELVETICA">Accessing
Dynamic HTML </font></h2>

<p><font size="2" face="VERDANA,ARIAL,HELVETICA">Internet
Explorer 4.0 makes a new capability available to
components&#151;to access the Dynamic HTML object model of the
document in which the control is hosted. This allows a control to
read the contents of the document and change it, because all the
capabilities of the object model are available. Accessing the
object model is very simple and consists of the following two
steps: </font></p>

<ol>
    <li><font size="2" face="VERDANA,ARIAL,HELVETICA">Call <b>IOleClientSite::GetContainer</b>.
        This returns the <b>IOleContainer</b> interface of the
        host of the control, and is an existing OLE interface
        method. </font></li>
    <li><font size="2" face="VERDANA,ARIAL,HELVETICA">Call <b>QueryInterface</b>
        on the <b>IOleContainer</b> interface for the <b>IHTMLDocument2</b>
        interface. </font></li>
</ol>

<p><font size="2" face="VERDANA,ARIAL,HELVETICA">The <b>IHTMLDocument2</b>
interface is the interface for the Document object, which is the
object that acts as the root of all access to the object model.
The following bit of code (written in ATL 2.0) shows accessing
the object model to set the background color of the document to
pink, and is equivalent to <b>document.body.bgcolor =
&quot;pink&quot;</b>. </font></p>

<blockquote>
    <pre><font size="2" face="VERDANA,ARIAL,HELVETICA">// Get the document
CComPtr&lt;IOleContainer&gt; spContainer; 
m_spClientSite-&gt;GetContainer(&amp;spContainer); 
CComQIPtr&lt;IHTMLDocument2, &amp;IID_IHTMLDocument2&gt; spDoc(spContainer); 
CComPtr&lt;IHTMLBodyElement&gt; spBody;
if (spDoc)
    hr = spDoc-&gt;get_body(&amp;spBody);
if (spBody)
    hr = spBody-&gt;put_bgColor(CComBSTR(_T(&quot;pink&quot;)));
</font></pre>
</blockquote>

<p><font size="2" face="VERDANA,ARIAL,HELVETICA">It is possible
to perform any of the manipulations available to script in
Internet Explorer 4.0, and some functions that aren't possible
from script due to security restrictions that do not apply to
ActiveX Controls. A recommendation for development here is to
first prove a concept by using script (JScript or VBScript,
whichever is your favorite) and then translate that to
interface-level manipulation. </font></p>

<p><font size="2" face="VERDANA,ARIAL,HELVETICA"><b>Note</b> One
of the steps in this example is likely to change in subsequent
preview releases of Internet Explorer 4.0. In the future, the <b>get_body</b>
method will produce an IHTMLElement* from which a <b>QueryInterface</b>
call will be necessary to get the IHTMLBODYElement. The reason
for this change is to allow for frames as well as a body element.
This change has not been made for the first preview release. </font></p>

<p><font size="2" face="VERDANA,ARIAL,HELVETICA">It is important
to note that any of the new interfaces introduced with Internet
Explorer 4.0 are still subject to change, and will not be frozen
until the final product is released. </font></p>
</body>
</html>
