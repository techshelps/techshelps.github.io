<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Apartment Model Awareness</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<p>&nbsp;</p>

<h2><font size="2" face="VERDANA,ARIAL,HELVETICA">Apartment Model
Awareness</font></h2>

<p><font size="2" face="VERDANA,ARIAL,HELVETICA">Although not a
new issue for Internet Explorer 4.0, apartment model awareness is
an important issue because of architectural changes in the
multithreaded nature of Internet Explorer, Active Desktop, and
Outlook Express, resulting in multiple instances of the container
being more prevalent. </font></p>

<p><font size="2" face="VERDANA,ARIAL,HELVETICA">If a control is
not apartment-model-aware, the control might not function
correctly. At the very least, it will suffer from degraded
performance because calls to the control will be marshaled. This
is due to the creation of the control being handled differently
by the system if the control marks itself as being
apartment-model-aware. </font></p>

<p><font size="2" face="VERDANA,ARIAL,HELVETICA">There are two
relatively simple steps involved in making a control
apartment-model-aware: </font></p>

<ul>
    <li><font size="2" face="VERDANA,ARIAL,HELVETICA">Mark the
        control in the registry as &quot;Apartment&quot;. This
        allows the system to recognize that the control
        understands the world of multithreading and to create it
        accordingly in its own apartment. </font></li>
    <li><font size="2" face="VERDANA,ARIAL,HELVETICA">Protect
        global resources. When a resource or data that is shared
        among instances of the control is being accessed, it
        should be protected so that other instances of the
        control do not attempt to access it at the same time. For
        example: </font><p><font size="3" face="Arial"><code>::EnterCriticalSection(&amp;g_cs);<br>
        // Access global data<br>
        // .... <br>
        ::LeaveCriticalSection( &amp;g_cs ); </code></font></p>
    </li>
</ul>
</body>
</html>
