<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Appendix A: Differences Between Versions, and Other Guidelines</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF">


<p>&nbsp;</p>

<h2><font size="2" face="VERDANA,ARIAL,HELVETICA">Appendix A:
Differences Between Versions, and Other Guidelines</font></h2>

<p><font size="2" face="VERDANA,ARIAL,HELVETICA">This section
details the known differences in control hosting between Internet
Explorer 3.0 and Internet Explorer 4.0, and presents other
guidelines for creating controls. Internet Explorer 3.0 hosted
controls in a slightly more relaxed fashion than Internet
Explorer 4.0; for Internet Explorer 4.0 the specifications for
controls and COM interfaces have been followed more stringently.
This allows Internet Explorer 4.0 to host a greater variety of
controls; however, it does mean that some controls that
functioned correctly in Internet Explorer 3.0 may no longer have
identical functionality in Internet Explorer 3.0. Wherever
possible, these differences have been minimized. </font></p>

<ul>
    <li><font size="2" face="VERDANA,ARIAL,HELVETICA">If a
        control fires an event from a thread that it creates,
        rather than from the thread in which it was created, the
        event will never make it. All calls from the control must
        be made on the creation thread. </font></li>
    <li><font size="2" face="VERDANA,ARIAL,HELVETICA">Internet
        Explorer 4.0 calls <b>FindConectionPoint</b> on a control
        to hook up events even if the control exposes no events.
        A control should be written to expect this call. </font></li>
    <li><font size="2" face="VERDANA,ARIAL,HELVETICA">As
        previously mentioned, non-apartment-model-aware controls
        might not function properly. </font></li>
    <li><font size="2" face="VERDANA,ARIAL,HELVETICA">The
        VBScript engine no longer passes parameters to controls <b>ByVal</b>;
        they are now usually passed <b>ByRef</b>. Standard
        practice when passing a variant is to check how it is
        being passed before retrieving the value. If a control
        relies on a parameter being passed <b>ByVal</b>, it might
        not work. </font></li>
    <li><font size="2" face="VERDANA,ARIAL,HELVETICA">Internet
        Explorer 3.0 sent <b>DoVerb</b> Show and Hide to controls
        in addition to <b>InPlaceActivate</b> and <b>InPlaceDeactivate</b>.
        Internet Explorer 4.0 no longer sends the verbs. </font></li>
    <li><font size="2" face="VERDANA,ARIAL,HELVETICA">A control
        should use the WM_CONTEXTMENU message to hook in for
        context menus and not trigger the right-mouse-up message.
        </font></li>
    <li><font size="2" face="VERDANA,ARIAL,HELVETICA">A control
        should not forcefully <b>UIActivate</b> itself, or assume
        itself to be <b>UIActive</b>. A control that needs the
        focus should have it set by the script of the document on
        which it is hosted. This is an area that the page author
        is in control of. In the case of multiple controls on a
        page, a <b>UIActivate</b> battle could cause strange
        results, and in the case of a control that is
        instantiated at the bottom of a large page, an ugly user
        experience might result as the control is forcefully
        scrolled into view. </font></li>
    <li><font size="2" face="VERDANA,ARIAL,HELVETICA">It is not
        good practice for a control to bring up modal dialog
        boxes unless in immediate response to some user
        interaction. For example, if a control is asynchronously
        downloading data in the background and the link fails, a
        control should fire an Error event for the script to be
        able to react to and/or show the error in its own
        rendering. Bringing up a dialog box under such
        circumstances creates a poor user experience and might
        upset applications hosting the Internet Explorer 4.0
        components. </font></li>
</ul>

<p><a href="http://www.microsoft.com/misc/cpyright.htm"><font size="1"
face="MS SANS SERIF">© 1997 Microsoft Corporation. All rights
reserved. Legal Notices.</font></a><font size="1"
face="MS SANS SERIF"> </font></p>
</body>
</html>
