<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The PROV_DSS_DH Provider Private-Key Blob</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_crypto2_the_prov_dss_dh_provider_private_key_blob"></a>The PROV_DSS_DH Provider Private-Key Blob</h2>
<p>
D-H private-key blobs (type PRIVATEKEYBLOB) are used to store the public/private information of a D-H key. They have the following format:</p>
<pre><code>BLOBHEADER blobheader; // As explained under "Data Structures"
DHPUBKEY dhpubkey;
BYTE prime[dhpubkey.bitlen/8];
BYTE generator[dhpubkey.bitlen/8];
BYTE secret[dhpubkey.bitlen/8];
 </code></pre>
<p>
The following table describes each component of the key blob.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=27%>Field</th>
<th align=left width=73%>Description</th>
</tr>
<tr valign=top>
<td width=27%>blobheader</td>
<td width=73%>A <a href="structs_7aya.htm"><b>BLOBHEADER</b></a> structure. The <b>bType</b> member must have a value of PRIVATEKEYBLOB.</td>
</tr>
<tr valign=top>
<td width=27%>dhpubkey</td>
<td width=73%>A <a href="structs_4b09.htm"><b>DHPUBKEY</b></a> structure. The <b>magic</b> member should be set to "DH2" (0x32484400) for private keys. <p>
Notice that the hex value is just an ASCII encoding of "DH2."</p>
</td>
</tr>
<tr valign=top>
<td width=27%>prime</td>
<td width=73%>The prime modulus P. This data must always have the most significant bit of the most significant byte set to 1.</td>
</tr>
<tr valign=top>
<td width=27%>generator</td>
<td width=73%>The generator G.</td>
</tr>
<tr valign=top>
<td width=27%>secret</td>
<td width=73%>The secret exponent X.</td>
</tr>
</table><br>
<p>
<b>Note</b>&nbsp;&nbsp;The generator and secret must always be the same length (in bytes). If either is one byte or more shorter than the other, then it must be padded with the necessary number of bytes (of zero value) to make them the same (little-endian format).</p>
<p>&nbsp;</p></body>
</HTML>
