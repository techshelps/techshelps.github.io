<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>System Certificate Stores as Logical Stores</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_crypto2_system_certificate_stores_as_logical_stores"></a>System Certificate Stores as Logical Stores</h3>
<p>
Default system stores, including MY, CA, and ROOT, are now implemented as logical stores with a number of pre-defined physical stores as their member stores. The member physical stores of a system store are opened automatically when the system store is opened. A user may add additional physical stores to any system store collection. The CryptoAPI function <a href="certstor_9skl.htm"><b>CertRegisterPhysicalStore</b></a> adds a new physical store to a system store collection. <a href="certstor_3so5.htm"><b>CertUnregisterPhysicalStore</b></a> disassociates a physical store from a logical system store. <a href="certstor_06lh.htm"><b>CertRegisterSystemStore</b></a> creates a new system store under a registry hKey, while <a href="certstor_8i91.htm"><b>CertUnregisterSystemStore</b></a> removes a system store from the registry. </p>
<p>
In earlier CryptoAPI versions, a system store was a single, physical store and not a logical store that used a set of physical stores. In the CryptoAPI  version initially supplied with Microsoft® Windows NT® 5.0, system stores have become logical stores with associated physical stores. All the certificates in an existing system store remain available, but the physical addition of new certificates will be made in the physical stores that make up the logical system store. </p>
<p>
Users who prefer to continue to use physical system stores and not convert to logical stores can open system stores with the CERT_STORE_PROV_SYSTEM_REGISTRY provider. This provider will continue to use each system store as a single, physical store.</p>
<p>
The functions <a href="certstor_1wha.htm"><b>CertEnumSystemStoreLocation</b></a>, <a href="certstor_419h.htm"><b>CertEnumSystemStore</b></a>, and <a href="certstor_6z8l.htm"><b>CertEnumPhysicalStore</b></a> list system store locations, available system stores, and all physical stores that are members of a system store.</p>
<p>
System stores are also relocatable. By default, a system store is opened relative to a registry subkey following a predefined pattern. See <a href="mancerts_53lf.htm">System Store Locations</a> for details. Setting CERT_SYSTEM_STORE_RELOCATE_FLAG in the <i>dwFlags</i> parameter passed to <a href="certstor_12sl.htm"><b>CertOpenStore</b></a> places a system store in the registry under a user specified registry subkey instead of the predefined one. </p>
<p>&nbsp;</p></body>
</HTML>
