<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CertEnumSystemStore</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_crypto2_certenumsystemstore"></a>CertEnumSystemStore</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>CertEnumSystemStore</b> function enumerates all available system stores.</p>
<pre><code><b>#include wincrypt.h
BOOL WINAPI CertEnumSystemStore(
</b>  <b>DWORD</b> <i>dwFlags</i>,                         // in
  <b>void </b><i>*pvSystemStoreLocationPara</i>,       // in optional
  <b>void </b><i>*pvArg</i>,                           // in
  <b>PFN_CERT_ENUM_SYSTEM_STORE</b> <i>pfnEnum     </i>// in
<b>)</b>;
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwflags</i></dt>
<dd>
Specifies the location of the system store. The following dwFlags are defined:
<p>
CERT_SYSTEM_STORE_CURRENT_USER <br>
CERT_SYSTEM_STORE_CURRENT_SERVICE <br>
CERT_SYSTEM_STORE_LOCAL_MACHINE<br>
CERT_SYSTEM_STORE_LOCAL_MACHINE_GROUP_POLICY<br>
CERT_SYSTEM_STORE_CURRENT_MACHINE_GROUP_POLICY<br>
CERT_SYSTEM_STORE_SERVICES <br>
CERT_SYSTEM_STORE_USERS

<p>
In addition CERT_SYSTEM_STORE_RELOCATE_FLAG may be combined with any location flags using a bitwise OR.
</dd>
<dt>
<i>pvSystemStoreLocationPara</i></dt>
<dd>
If CERT_SYSTEM_STORE_RELOCATE_FLAG is set in <i>dwFlags</i>, pvSystemStore points to a <a href="structs_9bvl.htm">CERT_SYSTEM_STORE_RELOCATE_PARA</a> that indicates both the name and the location of the system store. Otherwise it is a pointer to a unicode string that names the system store.
<p>
For CERT_SYSTEM_STORE_LOCAL_MACHINE or CERT_SYSTEM_STORE_LOCAL_MACHINE_GROUP_POLICY, <i>pvSystemStoreLocationPara</i> can optionally be set to a unicode computer name for enumerating local machine stores on a remote computer. For example, "\\ComputerName" or "ComputerName". The leading "\\" backslashes are optional in the ComputerName.

<p>
For CERT_SYSTEM_STORE_SERVICES or CERT_SYSTEM_STORE_USERS, if <i>pvSystemStoreLocationPara</i> is NULL, then, the function enumerates both the service/user names and the stores for each service/user name. Otherwise, <i>pvSystemStoreLocationPara</i> is a unicode string specifying a remote computer name and/or service/user name. For example: "ServiceName,""\\ComputerName," or "ComputerName\"

<p>
If only the ComputerName is specified, it must have either the leading "\\" backslashes or a trailing backslash. Otherwise, it is interpreted as the ServiceName or UserName.
</dd>
<dt>
<i>pvArg</i></dt>
<dd>
Pointer to a void which allows the application to declare, define, and initialize a data structure to hold any information to be passed to the callback enumeration function.</dd>
<dt>
<i>pfnEnum</i></dt>
<dd>
Pointer to the callback function used to show the details for each system store. This callback function determines the content and format for the presentation of information on each system store. The application must provide the callback function and must declare it with the following signature :
<pre><code>BOOL  WINAPI CertEnumSystemStoreCallback(
  const void *pvSystemStore,           // in
  DWORD dwFlags,                       // in
  PCERT_SYSTEM_STORE_INFO pStoreInfo,  // in
  void *pvReserved,                    // in, optional
  void *pvArg                          // in, optional
);
 </code></pre>

<p>
The <i>pvArg </i>passed by <b>CertEnumSystemStore</b> to the callback function is the <i>pvArg pointer</i> passed to <b>CertEnumSystemStore</b>.

</dd>
</dl>
<h4>Return Values</h4>
<p>
TRUE if the function succeeded. FALSE if the function failed.</p>
<p>
Call <b>GetLastError</b> to see the reason for any failures.</p>
<h4>Remarks</h4>
<p>
To use <b>CertEnumSystemStore</b>, the application must declare and define the ENUM_ARG data structure and an enumeration callback function.</p>
<p>
To access a remote store, the Security Permissions in the registry keys on that remote computer must be set to allow access. For more information on setting Security Permissions in an NT registry, see MDSN Article ID Q155363. For information on what to do to enable remote administration on a Win95 registry.</p>
<h4>Example</h4>
<p>
See <a href="mancerts_32r7.htm">Example Code for Listing System and Physical Stores</a>.</p>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in wincrypt.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use crypt32.lib.</p>
<h4>See Also</h4>
<p>
<a href="certstor_06lh.htm"><b>CertRegisterSystemStore</b></a>,<b> <a href="certstor_9skl.htm">CertRegisterPhysicalStore</a></b>,<b> <a href="certstor_8i91.htm">CertUnregisterSystemStore</a></b>,<b> <a href="certstor_3so5.htm">CertUnregisterPhysicalStore</a></b>,<b> <a href="certstor_1wha.htm">CertEnumSystemStoreLocation</a></b>,<b> <a href="certstor_6z8l.htm">CertEnumPhysicalStore</a></b></p>
<p>&nbsp;</p></body>
</HTML>
