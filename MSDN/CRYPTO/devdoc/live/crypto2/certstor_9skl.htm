<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CertRegisterPhysicalStore</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_crypto2_certregisterphysicalstore"></a>CertRegisterPhysicalStore</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>CertRegisterPhysicalStore</b> function adds a physical Store to a registry system store collection.</p>
<pre><code><b>#include &lt;wincrypt.h&gt;
BOOL WINAPI CertRegisterPhysicalStore(
  const void </b><i>*pvSystemStore,               </i> // in
  <b>DWORD</b> <i>dwFlags</i>,                            // in
  <b>LPCWSTR</b> <i>pwszStoreName</i>,                    // in
  <b>PCERT_PHYSICAL_STORE_INFO</b> <i>pStoreInfo</i>,     // in
  <b>void </b><i>*pvReserved</i>                          // in/optional
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pvSystemStore</i></dt>
<dd>
Identifies the system store collect to which the physical store will be added. It points to either a NULL terminated unicode string or to a CERT_SYSTEM_STORE_RELOCATE_PARA data structure. See <a href="certstor_06lh.htm"><b>CertRegisterSystemStore</b></a><b> </b>for details on using the data structure and on prepending a ServiceName or Computer name to the system store name string.</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
The HIWORD of the <i>dwFlags</i> parameter specifies the location of the system store. See <a href="certstor_06lh.htm"><b>CertRegisterSystemStore</b></a> for details on defined HIWORD <i>dwFlags</i> and prepending ServiceName, UserNames, and ComputerNames to the system store name.
<p>
The following LOWORD <i>dwFlags</i> are also defined and may be ORed with HIWORD flags.

<dl>
<dt>
CERT_SYSTEM_STORE_RELOCATE_FLAG </dt>
<dd>
When this flag is set, the system store is not in its default registry location and <i>pvSystemStore </i>must be a pointer to a CERT_SYSTEM_STORE_RELOCATE_PARA data structure.</dd>
<dt>
CERT_STORE_CREATE_NEW_FLAG </dt>
<dd>
When this flag is set, the function fails if the physical store already exists in the store location.</dd>
</dl>
</dd>
<dt>
<i>pwszStoreName</i></dt>
<dd>
Pointer to a unicode string that names the physical store to be added to the system store collection.</dd>
<dt>
<i>pStoreInfo</i></dt>
<dd>
Pointer to a CERT_PHYSICAL_STORE_INFO data structure that provides basic information about the physical store.</dd>
<dt>
<i>pvReserved</i></dt>
<dd>
This parameter is reserved for future use and must be set to NULL.
</dd>
</dl>
<h4>Return Values</h4>
<p>
TRUE if the function succeeded. FALSE if the function failed.</p>
<h4>Remarks</h4>
<p>
To access a remote store, the Security Permissions in the registry keys on that remote computer must be set to allow access. For more information on setting Security Permissions in an NT registry, see MDSN Article ID Q155363. For information on what to do to enable remote administration on a Win95 registry.</p>
<h4>Example</h4>
<pre><code>LPCWSTR pwszSystemStore = L"My";
LPcWSTR pwszStoreName = L"newstore";
CERT_PHYSICAL_STORE_INFO PhysicalStoreInfo
DWORD dwFlags= CERT_SYSTEM_STORE_CURRENT_USER;

// Initalize the PhysicalStoreInfo data structure.
PhysicalStoreInfo.cbSize=sizeof(CERT_PHYSICAL_STORE_INFO);
PhysicalStoreInfo.pszOpenStoreProvider=</code>CERT_STORE_PROV_FILENAME;
<code>PhysicalStoreInfo.dwFlags=CERT_PHYSICAL_STORE_ADD_ENABLE_FLAG;</code>
<code>PhysicalStoreInfo.dwPriority=1;</code>
<code>PhysicalStoreInfo.dwOpenEncodingType=PKCS_7_ASN_ENCODING | X509_ASN_ENCODING;</code>
<code>if(CertRegisterPhysicalStore(</code>
<code>     pwszSystemStoreName),</code>
<code>     dwFlags,</code>
<code>     pwszStoreName,</code>
<code>     &amp;PhyStoreInfo,</code>
<code>     NULL</code>
<code>              ))</code>
<code>       {</code>
<code>printf("Physical store %S is registered \n",pwszStoreName);</code>
<code>printf("As a store under %S \n",pvSystemStore);</code>
<code>       }</code>
<code>else</code>
<code>printf("The physical store was not registered. \n");</code>
<code> </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in wincrypt.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use crypt32.lib.</p>
<h4>See Also</h4>
<p>
<a href="certstor_06lh.htm"><b>CertRegisterSystemStore</b></a>,<b> <a href="certstor_3so5.htm">CertUnregisterPhysicalStore</a></b>,<b> <a href="certstor_1wha.htm">CertEnumSystemStoreLocation</a></b>,<b> <a href="certstor_419h.htm">CertEnumSystemStore</a></b>,<b> <a href="certstor_6z8l.htm">CertEnumPhysicalStore</a></b></p>
<p>&nbsp;</p></body>
</HTML>
