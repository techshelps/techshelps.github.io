<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The Base Provider Public-Key Blob</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_crypto2_the_base_provider_public_key_blob"></a>The Base Provider Public-Key Blob</h2>
<p>
Public-key blobs (type PUBLICKEYBLOB) are used to store public keys. They have the following format:</p>
<pre><code>BLOBHEADER blobheader;
RSAPUBKEY rsapubkey;
BYTE modulus[rsapubkey.bitlen/8];
 </code></pre>
<p>
The following table describes each public-key component. All values are in little-endian format.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=27%>Field</th>
<th align=left width=73%>Description</th>
</tr>
<tr valign=top>
<td width=27%>blobheader</td>
<td width=73%>A <a href="structs_7aya.htm"><b>BLOBHEADER</b></a> structure. The <b>bType</b> member must have a value of PUBLICKEYBLOB.</td>
</tr>
<tr valign=top>
<td width=27%>rsapubkey</td>
<td width=73%>A <a href="structs_3r95.htm"><b>RSAPUBKEY</b></a> structure. The <b>magic</b> member should be set to "RSA1" (0x31415352) for public keys and to "RSA2" (0x32415352) for private keys. <p>
Notice that the hex values are just an ASCII encoding of "RSA1" and "RSA2."</p>
</td>
</tr>
<tr valign=top>
<td width=27%>modulus</td>
<td width=73%>The public-key modulus data is located directly after the <a href="structs_3r95.htm"><b>RSAPUBKEY</b></a> structure. The size of this data will vary, depending on the size of the public key. The number of bytes can be determined by dividing the value of <b>RSAPUBKEY</b>'s<b> bitlen</b> field by eight.</td>
</tr>
</table><br>
<p>
Notice that public-key blobs are not encrypted, but contain public keys in plaintext form.</p>
<p>
For more detailed information on the Base Provider key blobs, see <a href="cryptcsp/interop_40hf.htm">Interoperability with RSA CSPs</a>.</p>
<p>&nbsp;</p></body>
</HTML>
