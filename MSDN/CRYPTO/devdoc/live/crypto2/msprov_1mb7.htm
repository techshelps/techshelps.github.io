<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Exporting DSS Keys</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_crypto2_exporting_dss_keys"></a>Exporting DSS Keys</h3>
<p>
When sending signed data to someone where the signature will need to be verified by the recipient, the signer's public key must be provided to the recipient; and is usually sent along with the signed data. Therefore, it is necessary to be able to export the DSS keys, and they are exported in a key blob format. </p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To export the DSS public key</h5>
<ol>
<li>
Call <a href="capifunc_0wvo.htm"><b>CryptAcquireContext</b></a> to get a pointer to the Microsoft DSS Cryptographic Provider.</li>
<li>
Call <a href="capifunc_0aex.htm"><b>CryptGetUserKey</b></a>, with the <i>dwKeySpec</i> argument set to either AT_SIGNATURE or CALG_DSS_SIGN.</li>
<li>
Call <a href="capifunc_9y9l.htm"><b>CryptExportKey</b></a> with <i>hKey</i> set to the handle retrieved in the previous step, <i>dwBlobType</i> set to PUBLICKEYBLOB, and <i>dwFlags</i> set to zero. The DSS public-key blob is returned in <i>pbData</i> and the length of the key blob is returned in <i>pdwDataLen</i>. A NULL pointer may be passed in <i>pbData</i>, and in this case just the length of the DSS key blob will be returned. The blob returned when making the call to <b>CryptExportKey</b> is in the format described in <a href="msprov_1l7m.htm">The DSS Provider Public-Key Blob</a>.</li>
</ol>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To export the DSS private key</h5>
<ol>
<li>
Follow the same procedure as for exporting a DSS public key, except that when making the call to <a href="capifunc_9y9l.htm"><b>CryptExportKey</b></a>, <i>dwBlobType</i> should be set to PRIVATEKEYBLOB. The blob returned when making the call to <b>CryptExportKey</b> is in the format described in <a href="msprov_0h42.htm">The DSS Provider Private-Key Blob</a>.</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
