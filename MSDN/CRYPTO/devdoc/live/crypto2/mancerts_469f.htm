<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Logical and Collection Certificate Stores</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_crypto2_logical_and_collection_certificate_stores"></a>Logical and Collection Certificate Stores</h3>
<p>
As the number of certificates, CRLs, and CTLs that a user collects grows, the organization of those certificates becomes an issue. One possible solution is  to create separate certificate stores to keep different kinds of certificates. This solution creates a new problem because an application may have to search several different stores to find a specific certificate. The use of logical or collection stores solves this problem. </p>
<p>
A logical or collection certificate store is a group of physical stores that appear to an application as a single store. All member stores of a logical, collection store can be searched or enumerated with a single function call to either <b>CertFindCertificateInStore</b> or <b>CertEnumCertificatesInStore</b>. </p>
<p>
The use of logical or collection stores also provides a flexibility that is difficult to achieve with paper records. A certificate in a single physical store may need to be a member of several different logical groups. Therefore, an individual physical store may be a member of more than one logical or collection store as shown in the following illustration.</p>
<p>
<img src="images/mancert.gif" border=0></p>
<p>
This illustration presents the following basic, logical certificate store concepts:
<ul>
<li>
A collection certificate store has a pointer to the first pointer block for that collection store.</li>
<li>
Each pointer block of a collection store has a pointer to a sibling store and a pointer to the next pointer block of the collection.</li>
<li>
Each sibling store in a collection is a simple physical certificate store</li>
<li>
A simple certificate store may be a member sibling store in many different collection stores.</li>
<li>
Certificates added to a collection store are physically added to one of the sibling stores in the collection.</li>
<li>
Certificates in a sibling store may be accessed by any collection store in which the sibling store is a member.</li>
</ul>
<p>
Collection stores are built within an application by opening a collection store using <a href="certstor_12sl.htm"><b>CertOpenStore</b></a> and then using <a href="certstor_2uni.htm"><b>CertAddStoreToCollection</b></a> to add an open sibling store to the collection store. A sibling store can be deleted from a collection store by calling <a href="certstor_5jxq.htm"><b>CertRemoveStoreFromCollection</b></a>.</p>
<p>&nbsp;</p></body>
</HTML>
