<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SSL3 Client Authentication Algorithm</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_crypto2_ssl3_client_authentication_algorithm"></a>SSL3 Client Authentication Algorithm</h2>
<p>
This algorithm is used for SSL3 client authentication. In the SSL3 protocol, a concatenation of an MD5 hash and an SHA hash is signed with an RSA private key. CryptoAPI and the Microsoft Base and Enhanced Cryptographic Providers support this with the hash type CALG_SSL3_SHAMD5.</p>
<h5><img src="../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create a CALG_SSL3_SHAMD5 hash</h5>
<ol>
<li>
Using standard CryptoAPI methodology, create MD5 and SHA hashes of the target data.</li>
<li>
Concatenate the two hashes, with the MD5 value leftmost and the SHA value rightmost. This results in a 36 byte value (16 bytes + 20 bytes).</li>
<li>
Get a handle to a hash object by calling <a href="capifunc_5kfc.htm"><b>CryptCreateHash</b></a> with CALG_SSL3_SHAMD5 passed in the <i>Algid</i> argument.</li>
<li>
Set the hash value with a call to <a href="capifunc_7wkt.htm"><b>CryptSetHashParam</b></a>. The concatenated hash values are passed as a BYTE* in the <i>pbData</i> argument, and the HP_HASHVAL value must be passed in the <i>dwParam</i> argument. Note that <a href="capifunc_8c81.htm"><b>CryptHashData</b></a> should <i>not</i> be called using the handle returned by <b>CryptCreateHash</b> in step 3. Such a call will fail.</li>
<li>
Call <a href="capifunc_7aco.htm"><b>CryptSignHash</b></a> to generate the signature.</li>
<li>
Call <a href="capifunc_5960.htm"><b>CryptDestroyHash</b></a> to destroy the hash object.</li>
</ol>
<p>
<a href="cryptcsp/signcsp_6rn7.htm">CSPs</a> that are intended to be compatible with the Microsoft RSA Providers, rsabase.dll and rsaenh.dll, must implement this functionality. This <a href="datatype_2td0.htm">ALG_ID</a> is used by the Microsoft schannel.dll when performing client authentication with SSL3 in the Microsoft Internet Explorer. </p>
<p>&nbsp;</p></body>
</HTML>
