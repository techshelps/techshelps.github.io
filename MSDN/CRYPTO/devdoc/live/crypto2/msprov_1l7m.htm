<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The DSS Provider Public-Key Blob</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_crypto2_the_dss_provider_public_key_blob"></a>The DSS Provider Public-Key Blob</h2>
<p>
When a DSS public key is exported, it is in a PUBLICKEYBLOB format, as follows:</p>
<pre><code>BLOBHEADER        blobheader;
DSSPUBKEY         dsspubkey;
BYTE              p[dsspubkey.bitlen/8];
BYTE              q[20];
BYTE              g[dsspubkey.bitlen/8];
BYTE              y[dsspubkey.bitlen/8];
DSSSEED           seedstruct;
 </code></pre>
<p>
The following table describes each public key component. All values are in little-endian format.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=27%>Field</th>
<th align=left width=73%>Description</th>
</tr>
<tr valign=top>
<td width=27%>blobheader</td>
<td width=73%>A <a href="structs_7aya.htm"><b>BLOBHEADER</b></a> structure The <b>bType</b> member must have a value of PUBLICKEYBLOB.</td>
</tr>
<tr valign=top>
<td width=27%>dsspubkey</td>
<td width=73%>A <a href="structs_0ek9.htm"><b>DSSPUBKEY</b></a> structure. The <b>magic</b> member must have a value of 0x31535344 (the ASCII encoding of "DSS1").</td>
</tr>
<tr valign=top>
<td width=27%>p</td>
<td width=73%>The prime modulus P. Must always have the most significant bit of the most significant byte set to 1. </td>
</tr>
<tr valign=top>
<td width=27%>q</td>
<td width=73%>The prime Q - 20 bytes in length. The most significant bit of the most significant byte must be set to 1.</td>
</tr>
<tr valign=top>
<td width=27%>g</td>
<td width=73%>The generator G. Must be the same length as p (must be padded with 0x00 bytes if it is less).</td>
</tr>
<tr valign=top>
<td width=27%>y</td>
<td width=73%>The public key Y. Must be same length as p, if smaller then it must be padded with 0x00.</td>
</tr>
<tr valign=top>
<td width=27%>seedstruct</td>
<td width=73%>Seed and counter values for verifying primes.</td>
</tr>
</table><br>
<p>
Notice that public-key blobs are not encrypted, but contain public keys in plaintext form.</p>
<p>&nbsp;</p></body>
</HTML>
