<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>System Store Locations</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_crypto2_system_store_locations"></a>System Store Locations</h3>
<p>
A system store is a collection consisting of one or more physical sibling stores. For each system store, there are predefined physical sibling stores. After opening a system store such as MY at CERT_SYSTEM_STORE_CURRENT_USER, the store provider calls <a href="certstor_12sl.htm"><b>CertOpenStore</b></a> to open each of the physical stores in the system store collection. In the open process, each of these physical stores is added to the system store collection using <a href="certstor_2uni.htm"><b>CertAddStoreToCollection</b></a>. All of the certificates in those physical stores are available through the logical system store collection.</p>
<p>
For each system store registry location, the predefined systems stores are:</p>
<p class=indent1>
MY<br>
Root<br>
Trust<br>
CA</p>
<p>
In registry location CERT_STORE_CURRENT_USER, there is also a predefined UserDS store. A smart card store is planned for this location.</p>
<p>
CERT_SYSTEM_STORE_CURRENT_USER system stores are at registry location HKEY_CURRENT_USER\Software\Microsoft\SystemCertificates.</p>
<p>
The pre-defined physical stores associated with those system stores are: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=35%>System Store</th>
<th align=left width=65%>Physical Store</th>
</tr>
<tr valign=top>
<td width=35%>MY</td>
<td width=65%>.Default</td>
</tr>
<tr valign=top>
<td width=35%>Root</td>
<td width=65%>.Default</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>.LocalMachine</td>
</tr>
<tr valign=top>
<td width=35%>Trust</td>
<td width=65%>.Default</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>.GroupPolicy</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>.LocalMachine</td>
</tr>
<tr valign=top>
<td width=35%>CA</td>
<td width=65%>.Default</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>.GroupPolicy</td>
</tr>
<tr valign=top>
<td width=35%></td>
<td width=65%>.LocalMachine</td>
</tr>
<tr valign=top>
<td width=35%>UserDS</td>
<td width=65%>.UserCertificate</td>
</tr>
</table><br>
<p>
CERT_SYSTEM_LOCAL_MACHINE system stores are at registry location HKEY_LOCAL_MACHINE\Software\Microsoft\SystemCertificates.</p>
<p>
The pre-defined physical stores are associated with those system stores are </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=26%>System Store</th>
<th align=left width=74%>Physical Store</th>
</tr>
<tr valign=top>
<td width=26%>MY</td>
<td width=74%>.Default</td>
</tr>
<tr valign=top>
<td width=26%>Root</td>
<td width=74%>.Default</td>
</tr>
<tr valign=top>
<td width=26%></td>
<td width=74%>.GroupPolicy</td>
</tr>
<tr valign=top>
<td width=26%>Trust</td>
<td width=74%>.Default</td>
</tr>
<tr valign=top>
<td width=26%></td>
<td width=74%>.GroupPolicy</td>
</tr>
<tr valign=top>
<td width=26%>CA</td>
<td width=74%>.Default</td>
</tr>
<tr valign=top>
<td width=26%></td>
<td width=74%>.GroupPolicy</td>
</tr>
</table><br>
<p>
CERT_SYSTEM_STORE_CURRENT_SERVICE are at registry location HKEY_LOCAL_MACHINE\Software\Microsoft\Crytography\Services\&lt;ServiceName&gt;\SystemCertificates.</p>
<p>
The pre-defined physical stores associated with those system stores are: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=26%>System Store</th>
<th align=left width=74%>Physical Store</th>
</tr>
<tr valign=top>
<td width=26%>MY</td>
<td width=74%>.Default</td>
</tr>
<tr valign=top>
<td width=26%>Root</td>
<td width=74%>.Default</td>
</tr>
<tr valign=top>
<td width=26%></td>
<td width=74%>.LocalMachine</td>
</tr>
<tr valign=top>
<td width=26%>Trust</td>
<td width=74%>.Default</td>
</tr>
<tr valign=top>
<td width=26%></td>
<td width=74%>.LocalMachine</td>
</tr>
<tr valign=top>
<td width=26%>CA</td>
<td width=74%>.Default</td>
</tr>
<tr valign=top>
<td width=26%></td>
<td width=74%>.LocalMachine</td>
</tr>
</table><br>
<p>
CERT_SYSTEM_STORE_SERVICES system stores are at registry location HKEY_LOCAL_MACHINE\Software\Microsoft\Cryptography\Services\&lt;ServiceName&gt;\SystemCertificates. </p>
<p>
The pre-defined physical stores associated with those system stores are:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=40%>System Store</th>
<th align=left width=60%>Physical Store</th>
</tr>
<tr valign=top>
<td width=40%>ServiceName\MY</td>
<td width=60%>.Default</td>
</tr>
<tr valign=top>
<td width=40%>ServiceName\Root</td>
<td width=60%>.Default</td>
</tr>
<tr valign=top>
<td width=40%></td>
<td width=60%>.LocalMachine</td>
</tr>
<tr valign=top>
<td width=40%>ServiceName\Trust</td>
<td width=60%>.Default</td>
</tr>
<tr valign=top>
<td width=40%></td>
<td width=60%>.LocalMachine</td>
</tr>
<tr valign=top>
<td width=40%>ServiceName\CA</td>
<td width=60%>.Default</td>
</tr>
<tr valign=top>
<td width=40%></td>
<td width=60%>.LocalMachine</td>
</tr>
</table><br>
<p>
CERT_SYSTEM_STORE_USERS system stores are at registry location HKEY_USERS\&lt;UserName&gt;\Software\Microsoft\SystemCertificates.</p>
<p>
The pre-defined physical stores associated with those system stores are: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=31%>System Store</th>
<th align=left width=69%>Physical Store</th>
</tr>
<tr valign=top>
<td width=31%>userid\MY</td>
<td width=69%>.Default</td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=69%>.LocalMachine</td>
</tr>
<tr valign=top>
<td width=31%>userid\Root</td>
<td width=69%>.Default</td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=69%>.LocalMachine</td>
</tr>
<tr valign=top>
<td width=31%>userid\Trust</td>
<td width=69%>.Default</td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=69%>.LocalMachine</td>
</tr>
<tr valign=top>
<td width=31%>userid\CA</td>
<td width=69%>.Default</td>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=69%>.LocalMachine</td>
</tr>
</table><br>
<p>
CERT_SYSTEM_CURRENT_USER_GROUP_POLICY system stores are at registry location HKEY_CURRENT_USER\Software\Policy\Microsoft\SystemCertificates.</p>
<p>
CERT_SYSTEM_LOCAL_MACHINE_GROUP_POLICY system stores are at registry location HKEY_LOCAL_MACHINE\Software\Policy\Microsoft\SystemCertificates.</p>
<p>
The pre-defined physical stores associated with those system stores are: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=26%>System Store</th>
<th align=left width=74%>Physical Store</th>
</tr>
<tr valign=top>
<td width=26%>MY</td>
<td width=74%>.Default</td>
</tr>
<tr valign=top>
<td width=26%>Root</td>
<td width=74%>.Default</td>
</tr>
<tr valign=top>
<td width=26%>Trust</td>
<td width=74%>.Default</td>
</tr>
<tr valign=top>
<td width=26%>CA</td>
<td width=74%>.Default</td>
</tr>
</table><br>
<p>
Additional physical stores can be associated with a system store using <a href="certstor_9skl.htm"><b>CertRegisterPhysicalStore</b></a>.</p>
<p>
CERT_SYSTEM_STORE_SERVICE and CERT_SYSTEM_STORE_USERS stores are opened by prefixing the name of the store in the string passed to <i>pvPara</i> with the service or user name such as "ServiceName\Trust" or ".Default\MY." For Microsoft® Windows NT®, the CERT_SYSTEM_STORE_SERVICES or CERT_SYSTEM_STORE_USERS location can open the same store in CERT_SYSTEM_CURRENT_SERVICE or CERT_SYSTEM_CURRENT_USER by using the textual SID of the current service or user. For Windows® 95, the string returned by <b>GetUserName</b> is used.</p>
<p>
Stores in CERT_SYSTEM_STORE_USER_GROUP_POLICY and CERT_SYSTEM_LOCAL_MACHINE_GROUP_POLICY in a network setting are downloaded to the client machine from the Group Policy Template (GPT) during machine startup or user logon. These stores may be updated on the client computer after startup or logon when the GPT is changed on the domain server by an administrator. The <a href="certstor_00o5.htm"><b>CertControlStore</b></a> function allows an application to be notified when stores in either of these locations have changed.</p>
<p>
The following system store locations can be opened remotely: </p>
<p class=indent1>
CERT_SYSTEM_STORE_LOCAL_MACHINE<br>
CERT_SYSTEM_STORE_SERVICES<br>
CERT_SYSTEM_STORE_USERS<br>
CERT_SYSTEM_STORE_LOCAL_MACHINE_GROUP_POLICY</p>
<p>
System store locations are opened remotely by prefixing the store name in the string passed to <i>pvPara</i> with the computer name. Examples of remote system store names are: </p>
<p class=indent1>
ComputerName\CA<br>
\\ComputerName\CA<br>
ComputerName\ServiceName\Trust<br>
\\ComputerName\ServiceName\Trust</p>
<p>&nbsp;</p></body>
</HTML>
