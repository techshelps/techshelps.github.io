<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CertRegisterSystemStore</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_crypto2_certregistersystemstore"></a>CertRegisterSystemStore</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>CertRegisterSystemStore</b> function registers a system store.</p>
<pre><code><b>#include &lt;wincrypt.h&gt;
BOOL WINAPI CertRegisterSystemStore(
  const void</b> *<i>pvSystemStore</i>,              // in
  <b>DWORD</b> <i>dwFlags</i>,                          // in
  <b>PCERT_SYSTEM_STORE_INFO</b> <i>pStoreInfo</i>,     // in
  <b>void </b><i>*pvReserved</i>                        // in/optional
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>pvSystemStore</i></dt>
<dd>
Identifier of the system store to be registered. If CERT_SYSTEM_STORE_RELOCATE_FLAG is set in <i>dwFlags</i>, <i>pvSystemStore</i> points to a CERT_SYSTEM_STORE_RELOCATE_PARA data structure; else it points to a NULL terminated unicode string that names the system store. With the appropriate settings of <i>dwFlags</i>, this may be a system store on a remote local machine. Stores on remote computers can be registered with the computer name as a prefix to the name of the system store. For example, a remote local machine store could be registered with <i>pvSystemStore</i> pointing to the string "\\ComputerName\Trust" or "ComputerName\Trust."
<p>
Leading "\\" backslashes are optional before a ComputerName.
</dd>
<dt>
<i>dwFlags</i></dt>
<dd>
The HIWORD of the <i>dwFlags</i> parameter is used to specify the location of the system store. 
<p>
The following HIWORD <i>dwFlags</i> are defined:

<p class=indent1>
CERT_SYSTEM_STORE_CURRENT_USER </p>

<p class=indent1>
CERT_SYSTEM_STORE_CURRENT_SERVICE </p>

<p class=indent1>
CERT_SYSTEM_STORE_SERVICES</p>

<p class=indent1>
CERT_SYSTEM_STORE_USERS</p>

<p class=indent1>
CERT_SYSTEM_STORE_LOCAL_MACHINE</p>

<p class=indent1>
CERT_SYSTEM_STORE_LOCAL_MACHINE_GROUP_POLICY</p>

<p>
When CERT_SYSTEM_STORE_CURRENT_USER is set,<i> pvSystemStore </i>may<i> </i>be<i> a </i>system store name that is prefixed with the UserName.

<p>
When CERT_SYSTEM_STORE_CURRENT_SERVICE is set, <i>pvSystemStore </i>may<i> </i>be<i> a </i>system store name that is prefixed with the ServiceName.

<p>
When CERT_SYSTEM_STORE_SERVICES or CERT_SYSTEM_STORE_USERS is set <i>pvSystemStore </i>must<i> </i>be<i> a </i>system store name that is prefixed with the ServiceName or UserName.

<p>
Stores on remote computers can be registered for CERT_SYSTEM_STORE_LOCAL_MACHINE, CERT_SYSTEM_STORE_SERVICES, CERT_SYSTEM_STORE_USERS or CERT_SYSTEM_STORE_LOCAL_MACHINE_GROUP_POLICY 

<p>
The following LOWORD <i>dwFlags</i> are also defined and may be ORed with HIWORD flags.

<dl>
<dt>
CERT_SYSTEM_STORE_RELOCATE_FLAG </dt>
<dd>
When this flag is set the system store is not in its default register location and <i>pvSystemStore </i>must be a pointer to a CERT_SYSTEM_STORE_RELOCATE_PARA data structure.</dd>
<dt>
CERT_STORE_CREATE_NEW_FLAG </dt>
<dd>
When this flag is set, the function fails if the system store already exists in the store location.</dd>
</dl>
</dd>
<dt>
<i>pStoreInfo</i></dt>
<dd>
This parameter is reserved for future use and must be set to NULL.</dd>
<dt>
<i>pvReserved</i></dt>
<dd>
This parameter is reserved for future use and must be set to NULL.
</dd>
</dl>
<h4>Return Values</h4>
<p>
TRUE if the function succeeded. FALSE if the function failed.</p>
<h4>Remarks</h4>
<p>
To access a remote store, the Security Permissions in the registry keys on that remote computer must be set to allow access. For more information on setting Security Permissions in an NT registry, see MDSN Article ID Q155363. For information on what to do to enable remote administration on a Win95 registry.</p>
<h4>Example</h4>
<pre><code>DWORD dwFlags= CERT_SYSTEM_STORE_CURRENT_USER;
LPCWSTR pySystemName= L"NEWSTORE";  // for this setting of 
                                    // dwFlags, the store name may 
                                    // be prefixed with a user name.
if(CertRegisterSystemStore(
pvSystemName,
dwFlags,
NULL,
NULL
       ))
   printf("System store %S is registered \n",pvSystemName);
else
   printf("The system store did not register. \n");
 </code></pre>
<h4>QuickInfo</h4>
<p>
<b>&nbsp;&nbsp;Windows NT: </b>Requires version 5.0 or later.<br>
<b>&nbsp;&nbsp;Windows: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Windows CE: </b>Unsupported.<br>
<b>&nbsp;&nbsp;Header: </b>Declared in wincrypt.h.<br>
<b>&nbsp;&nbsp;Import Library: </b>Use crypt32.lib.</p>
<h4>See Also</h4>
<p>
<a href="certstor_9skl.htm"><b>CertRegisterPhysicalStore</b></a>,<b> <a href="certstor_8i91.htm">CertUnregisterSystemStore</a></b>,<b> <a href="certstor_3so5.htm">CertUnregisterPhysicalStore</a></b>,<b> <a href="certstor_1wha.htm">CertEnumSystemStoreLocation</a></b>,<b> <a href="certstor_419h.htm">CertEnumSystemStore</a></b>,<b> <a href="certstor_6z8l.htm">CertEnumPhysicalStore</a></b></p>
<p>&nbsp;</p></body>
</HTML>
