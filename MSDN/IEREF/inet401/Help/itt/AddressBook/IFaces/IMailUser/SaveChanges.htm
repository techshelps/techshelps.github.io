<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMailUser::SaveChanges</TITLE>

<META NAME=MS-HKWD CONTENT="IMailUser::SaveChanges">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, interface">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="sec_IMailUser::SaveChanges"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="IMailUser::SaveChanges"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="IMailUser::SaveChanges"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../../../internet.htm#set_internet_tools">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="OpenProperty.htm">IMailUser::OpenProperty</A>
<IMG SRC="../../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="SetProps.htm">IMailUser::SetProps</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>IMailUser::SaveChanges</H1>

<PRE>HRESULT SaveChanges(
    ULONG  ulFlags
);
</PRE>
<P>Saves changes to the open mail user object. Note that the following properties may be calculated and changed at <B>SaveChanges</B>:
<TABLE>
<TR><TD>PR_DISPLAY_NAME</TD><TR><TD>PR_GIVEN_NAME</TD><TR><TD>PR_SURNAME</TD><TR><TD>PR_LAST_MODIFICATION_TIME</TD></TABLE>
<UL><LI>Returns one of the following values:
<TABLE>
<TR><TD>S_OK </TD><TD>The commitment of changes has been successful.</TD></TR>
<TR><TD>MAPI_E_NO_ACCESS </TD><TD><B>SaveChanges</B> cannot keep the object open for read-only access if KEEP_OPEN_READONLY is set, or read/write access if KEEP_OPEN_READWRITE is set. No changes are committed.</TD></TR>
<TR><TD>MAPI_E_OBJECT_CHANGED </TD><TD>The object has changed since it was opened.</TD></TR>
<TR><TD>MAPI_E_OBJECT_DELETED </TD><TD>The object has been deleted since it was opened.</TD></TR></TABLE>
</UL>
<DL>
<DT><I>ulFlags</I> </DT><DD>Bitmask of flags that control what happens to the object when the <B>SaveChanges</B> method is called. The following flags can be set:
<TABLE>
<TR><TD>FORCE_SAVE </TD><TD>Writes changes to the object and closes it. Read-write access must have been set for the operation to succeed. This flag forces saving only if MAPI_E_OBJECT_CHANGED was returned from a preceding <B>SaveChanges</B> call. FORCE_SAVE overrides the previous changes made to the object.</TD></TR>
<TR><TD>KEEP_OPEN_READONLY </TD><TD>Indicates the client requests changes be committed and the object be kept open for reading. This flag informs the provider that the object should not be modified and that the calling implementation will not call <B>SaveChanges</B> again. If the provider cannot keep the object open for read-only access, the entire call fails, changes are not saved, and MAPI_E_NO_ACCESS is returned.</TD></TR>
<TR><TD>KEEP_OPEN_READWRITE </TD><TD>Indicates the client requests changes be committed and the object be kept open for read-write access. This flag is usually set when the object was initially opened for read-write access. After calling <B>SaveChanges</B>, the client can make further changes to the object if this flag is passed. If the provider cannot keep the object open for read-write access, the entire call fails, changes are not saved, and MAPI_E_NO_ACCESS is returned.</TD></TR>
<TR><TD>MAPI_DEFERRED_ERRORS </TD><TD>Currently not supported by Internet Explorer Address Book.</TD></TR></TABLE>
</DD></DL>
<P><A HREF="IMailUser.htm#sec_IMailUser">Back to top</A><!-- ************************************************** --><!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>