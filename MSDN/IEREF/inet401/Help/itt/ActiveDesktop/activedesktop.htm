<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Active Desktop Interface</TITLE>

<META NAME=MS-HKWD CONTENT="Active Desktop Interface">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, Active Desktop">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="book_desktop_interface"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Active Desktop Interface"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Active Desktop Interface"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../internet.htm#set_internet_tools">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="../internet.htm">Internet Tools &amp; Technologies</A>
<IMG SRC="../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="objects/objects.htm">ActiveDesktop Object</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1><A NAME="ch_activedsktp_int">Active Desktop Interface</A></H1>
<P>This article contains information on the <A HREF="ifaces/iactivedesktop/IActiveDesktop.htm#IActiveDesktop">IActiveDesktop</A> interface that is part of the Microsoft&#174; Windows&#174; Shell API. This interface and its methods allow you to add, remove, and change items on the desktop.

<P><A CLASS=tctop HREF="activedesktop.htm#Overview_of_the_Acti"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Overview of the Active Desktop Interface</A><BR>
<P><A CLASS=tctop HREF="objects/objects.htm#ActiveDesktopObj_ref"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">ActiveDesktop Object</A><BR>
<P><A CLASS=tctop HREF="ifaces/interfaces.htm#IActiveDesktop_ref"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">IActiveDesktop Interface</A><BR>
<P><A CLASS=tctop HREF="ifaces/methods.htm#IActiveDesktop_methods"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Methods</A><BR>
<P><A CLASS=tctop HREF="structures/structures.htm#IActiveDesktop_structures"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Structures</A><BR>
<P><A CLASS=tctop HREF="constants/flags.htm#IActiveDesktop_flags"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Flags</A><BR>

<H2><A NAME="Overview_of_the_Acti">Overview of the Active Desktop Interface</A></H2>
<P>The Active Desktop is a feature of Microsoft Internet Explorer 4.0 that allows you to include HTML documents and items (such as ActiveX&#153; Controls and Java applets) directly to your desktop. The <A HREF="ifaces/iactivedesktop/IActiveDesktop.htm#IActiveDesktop">IActiveDesktop</A> interface, which is part of the Windows Shell API, is used to programmatically add, remove, and modify the items on the desktop. Active Desktop items can also be added using a Channel Definition Format (CDF) file. For information about creating Active Desktop items and adding them with a CDF file, see <A HREF="../../delivery/authoring/desktop_items.htm#ch_ad_components">Creating Active Desktop Items</A>. For more information on CDF files, see <A HREF="../../delivery/authoring/active_channels.htm#ch_channels">Creating Active Channels for Internet Explorer 4.0</A>.


<H3><A NAME="Accessing_the_Active">Accessing the Active Desktop</A></H3>
<P>To access the Active Desktop, a client application would need to create an instance of the <A HREF="objects/ActiveDesktop.htm#ActiveDesktopObj">Active Desktop</A> object with the
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>CoCreateInstance</A> function and get a pointer to its <A HREF="ifaces/iactivedesktop/IActiveDesktop.htm#IActiveDesktop">IActiveDesktop</A> interface.

<P>The following sample shows how to get a pointer to the <A HREF="ifaces/iactivedesktop/IActiveDesktop.htm#IActiveDesktop">IActiveDesktop</A> interface.

<PRE>HRESULT hr;
IActiveDesktop *pActiveDesktop;

//Create an instance of the Active Desktop
hr = CoCreateInstance(CLSID_ActiveDesktop, NULL, CLSCTX_INPROC_SERVER,
            IID_IActiveDesktop, (void**)&amp;pActiveDesktop);

//Insert code to call the IActiveDesktop methods

// Call the Release method
pActiveDesktop-&gt;Release();

</PRE>

<H3><A NAME="Adding_a_Desktop_Ite">Adding a Desktop Item</A></H3>
<P>There are three methods that can be used to add a desktop item: <A HREF="ifaces/iactivedesktop/AddDesktopItem.htm#IActiveDesktop__AddD">IActiveDesktop::AddDesktopItem</A>, <A HREF="ifaces/iactivedesktop/AddDesktopItemWithUI.htm#IActiveDesktop__AddD">IActiveDesktop::AddDesktopItemWithUI</A>, and <A HREF="ifaces/iactivedesktop/AddUrl.htm#IActiveDesktop__AddU">IActiveDesktop::AddUrl</A>. Each desktop item added to the Active Desktop must have a different source URL.

<P>The <A HREF="ifaces/iactivedesktop/AddDesktopItemWithUI.htm#IActiveDesktop__AddD">IActiveDesktop::AddDesktopItemWithUI</A> and <A HREF="ifaces/iactivedesktop/AddUrl.htm#IActiveDesktop__AddU">IActiveDesktop::AddUrl</A> both provide the option to display the various user interfaces that can be displayed before adding a desktop item to the Active Desktop. The interfaces will verify if the user really wants to add the desktop item to their Active Desktop, notify the user of any security risks that are warranted by the URL security zone settings, and ask the user if the user would like to create a subscription for this desktop item. Both methods also provide a way of suppressing the user interfaces. The <A HREF="ifaces/iactivedesktop/AddDesktopItem.htm#IActiveDesktop__AddD">IActiveDesktop::AddDesktopItem</A> method requires a call to <A HREF="ifaces/iactivedesktop/ApplyChanges.htm#IActiveDesktop__Appl">IActiveDesktop::ApplyChanges</A> in order to update the registry. For the <B>IActiveDesktop::AddDesktopItemWithUI</B>, the client application must immediately release the <A HREF="ifaces/iactivedesktop/IActiveDesktop.htm#IActiveDesktop">IActiveDesktop</A> interface and then use the
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>CoCreateInstance</A> function to get an interface to an instance of the <A HREF="objects/ActiveDesktop.htm#ActiveDesktopObj">Active Desktop</A> object that includes the newly added desktop item.

<P>The <A HREF="ifaces/iactivedesktop/AddDesktopItem.htm#IActiveDesktop__AddD">IActiveDesktop::AddDesktopItem</A> method will add the specified desktop item to the Active Desktop without any user interface, unless the URL security zone settings prevent it. If the URL security zone settings do not allow the desktop item to be added without prompting the user, the method will fail. <B>IActiveDesktop::AddDesktopItem</B> also requires a call to <A HREF="ifaces/iactivedesktop/ApplyChanges.htm#IActiveDesktop__Appl">IActiveDesktop::ApplyChanges</A> in order to update the registry.

<P>The following sample demonstrates how to add a desktop item with the <A HREF="ifaces/iactivedesktop/AddDesktopItem.htm#IActiveDesktop__AddD">IActiveDesktop::AddDesktopItem</A> method.

<PRE>HRESULT hr;
IActiveDesktop *pActiveDesktop;
COMPONENT compDesktopItem;

//Create an instance of the Active Desktop
hr = CoCreateInstance(CLSID_ActiveDesktop, NULL, CLSCTX_INPROC_SERVER,
            IID_IActiveDesktop, (void**)&amp;pActiveDesktop);

// Initialize the COMPONENT structure
compDesktopItem.dwSize = sizeof(COMPONENT);

// Insert code that adds the information about the desktop item to the COMPONENT structure

// Add the desktop item
pActiveDesktop-&gt;AddDesktopItem(&amp;compDesktopItem,0);

// Save the changes to the registry
pActiveDesktop-&gt;ApplyChanges(AD_APPLY_ALL);
</PRE>

<H3><A NAME="Enumerating_the_Desk">Enumerating the Desktop Items</A></H3>
<P>To enumerate the desktop items currently installed on the Active Desktop, the client application needs to get the total number of desktop items installed using the <A HREF="ifaces/iactivedesktop/GetDesktopItemCount.htm#IActiveDesktop__GetD">IActiveDesktop::GetDesktopItemCount</A> method and then creating a loop that retrieves the <A HREF="structures/COMPONENT.htm#COMPONENT">COMPONENT</A> structure for each desktop item by calling the <A HREF="ifaces/iactivedesktop/GetDesktopItem.htm#IActiveDesktop__GetD">IActiveDesktop::GetDesktopItem</A> method using the desktop item index.

<P>The following sample demonstrates one way to enumerate the desktop items.

<PRE>HRESULT hr;
IActiveDesktop *pActiveDesktop;
COMPONENT compDesktopItem;
int intCount;
int intIndex = 0;

//Create an instance of the Active Desktop
hr = CoCreateInstance(CLSID_ActiveDesktop, NULL, CLSCTX_INPROC_SERVER,
            IID_IActiveDesktop, (void**)&amp;pActiveDesktop);

pActiveDesktop-&gt;GetDesktopItemCount(&amp;intCount,0);

compDesktopItem.dwSize = sizeof(COMPONENT);

while(intIndex&lt;=(intCount-1))
{
    //get the COMPONENT structure for the current desktop item
    pActiveDesktop-&gt;GetDesktopItem(intIndex, &amp;compDesktopItem,0);

    //Insert code that processes the structure

    //Increment the index
    intIndex++;

    //Insert code to clean-up structure for next component
}

// Call the Release method
pActiveDesktop-&gt;Release();
</PRE>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>