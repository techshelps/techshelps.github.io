<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Overview</TITLE>

<META NAME=MS-HKWD CONTENT="Overview">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies, interface">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="intro_mshtml"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Overview"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Overview"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../../internet.htm#set_internet_tools">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="../mshtml.htm">Programming the Document Object Model from C/C++</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="icssfilter/ICSSFilter.htm">ICSSFilter</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Overview</H1>
<BR CLEAR=ALL>
<P>All interfaces for accessing the dynamic HTML object model are based on
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>IDispatch</A> and are the basis of access to the object model that is also used by scripts. It is therefore important that anyone using the interfaces to manipulate the object model also be familiar with the structure and functionality as defined in the <A HREF="../../../dhtml/dhtml.htm#dhtml_intro">Dynamic HTML overviews</A> and <A HREF="../mshtml.htm#ch_mshtml">Object Model references</A>.

<P>The <A HREF="interface.htm#sec_intf">Interfaces and Scripting Objects</A> section shows how objects within the Dynamic HTML object model map to the interfaces. For example, using this map, you can see that the <A HREF="document2/document2.htm#mshtml_document2">IHTMLDocument2</A> interface maps to the document object. Further examination of the interface shows how the properties of the document object are available through <B>get_</B> and <B>put_ methods</B>. The object's methods map to methods available in the interface, and events can be hooked up using standard OLE Automation connection points. 

<P>Examples of how to use the object model interfaces can be seen in the following samples in the Internet Client SDK:

<P><UL>
<LI>Driller 
<LI>colbtn 
<LI>WalkAll 
</UL>
<H2><A NAME="Recommendations_for_">Recommendations for Using the Interfaces</A></H2>
<P>Usually, anything that can be done using script within the document can also be performed using the interfaces to manipulate the object model. It is therefore recommended that before writing code to use the object model interfaces, developers should prototype the functionality using script within an HTML document.

<P>The following HTML example shows how to navigate the <A HREF="../../../dhtml/references/collections/all.htm#all">all</A> collection 
 
of the document and obtain the tag name of each element in the document using script. The equivalent C++ code is demonstrated in the Driller and WalkAll samples of the Internet Client SDK using the object model interfaces.

<PRE>&lt;HTML&gt;
&lt;HEAD&gt;
    &lt;TITLE&gt;Page Title&lt;/TITLE&gt;
&lt;/HEAD&gt;

&lt;SCRIPT LANGUAGE="JavaScript"&gt;
    function Loaded()
        {
        var c = document.all.length;
        var i;
        for(i=0; i &lt; c; i++)
            {
            spanTAGS.innerHTML = spanTAGS.innerHTML + document.all.item(i).tagName + "&lt;BR&gt;"; 
            } 
        }
&lt;/SCRIPT&gt;

&lt;BODY onload="Loaded()"&gt;

    &lt;SPAN id="spanTAGS"&gt;&lt;/SPAN&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>
<H2><A NAME="Obtaining_the_Docume">Obtaining the Document Interface</A></H2>
<P>To start using the object model interfaces, you need to obtain the <A HREF="document2/document2.htm#mshtml_document2">IHTMLDocument2</A> interface for the document. Once you have this interface, you can access all the elements within the document. How the document interface is obtained depends upon how your application is being implemented. Each scenario listed below requires that the document interface be obtained in a different manner.

<UL>
<LI>When hosting an MSHTML object.
<LI>When hosting an instance of the WebBrowser control.
<LI>From an ActiveX&#153; control contained in a page.
</UL>
<H3><A NAME="Obtaining_the_docume">Obtaining the document interface when hosting MSHTML</A></H3>
<P>When hosting an MSHTML object, you create the object using
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>CoCreateInstance</A>. Once the object is created, you can call its
<object id="hhal_5" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_5.Click()>QueryInterface</A> method, requesting IID_IHTMLDocument2. The WalkAll sample in the Internet Client SDK demonstrates how to do this.

 
<H3><A NAME="Obtaining_the_docume">Obtaining the document interface when hosting the WebBrowser control</A></H3>
<P>When hosting the WebBrowser control, you perform the following steps to obtain the document pointer:

<OL><LI>Call <A HREF="../../ieprog/wb/ifaces/iwebbrowser2/get_Document.htm#IWebBrowser2__get_Do">IWebBrowser2::get_Document</A> to obtain the document's
<object id="hhal_6" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_6.Click()>IDispatch</A> pointer.
<LI>Call
<object id="hhal_7" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_7.Click()>QueryInterface</A> on the
<object id="hhal_8" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_8.Click()>IDispatch</A> pointer obtained in the previous step, requesting IID_IHTMLDocument2.
</OL>
<H3><A NAME="Obtaining_the_docume">Obtaining the document interface from an ActiveX control</A></H3>
<P>The
<object id="hhal_9" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Building_ActiveX_Controls_for_Internet_Explorer_4.0>
</object><A HREF=JavaScript:hhal_9.Click()>Accessing Dynamic HTML</A> section of the ActiveX Controls documentation details how to obtain the document interface from an ActiveX control.

 
<H2><A NAME="Using_the_Document_I">Using the Document Interface</A></H2>
<P>Once you have obtained the document interface, you can use any of the <A HREF="document2/document2.htm#mshtml_document2">IHTMLDocument2</A> interfaces to obtain or modify the document's properties. This will most commonly involve getting some of the <A HREF="elementcollection/elementcollection.htm#mshtml_elementcollection">IHTMLElementCollection</A> interfaces for the different element collections contained in the document. 

<P>A very common collection is the <B>all</B> collection. The <B>all</B> collection is obtained using the <A HREF="document2/get_all.htm#IHTMLDocument2_get_all">IHTMLDocument2::get_all</A> method. This method returns an <A HREF="elementcollection/elementcollection.htm#mshtml_elementcollection">IHTMLElementCollection</A> interface that contains all the elements in the document. You can then enumerate the elements using the <A HREF="elementcollection/item_1.htm#item_1">IHTMLElementCollection::item</A> method. The <B>IHTMLElementCollection::item</B> method supplies you with an
<object id="hhal_10" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_10.Click()>IDispatch</A> pointer that you can call
<object id="hhal_11" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_11.Click()>QueryInterface</A> on, requesting IID_IHTMLElement. This will give you an <A HREF="ihtmlelement/element.htm#mshtml_element">IHTMLElement</A> interface pointer that you can use to obtain or set information for the individual element.

<P>Most elements provide an interface for working with that specific element. These element-specific interface names take the format of <B>IHTMLXXXXElement</B>, where <B>XXXX</B> is the name of the element. To obtain the element-specific interface, you simply call
<object id="hhal_12" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_12.Click()>QueryInterface</A> on the <A HREF="ihtmlelement/element.htm#mshtml_element">IHTMLElement</A> interface, requesting the element-specific interface that is desired. For example, the IMG element provides an <A HREF="imgelement/IHTMLImgElement.htm#sec_IHTMLImgElement">IHTMLImgElement</A> interface that can be used to work with the image element specifically. For a list of the element-specific interfaces that are available, see the interface listing in <A HREF="../mshtml.htm#ch_mshtml">Programming the Document Object Model from C/C++</A>.
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>