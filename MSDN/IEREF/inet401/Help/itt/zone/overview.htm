<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>URL Security Zones Overview</TITLE>

<META NAME=MS-HKWD CONTENT="URL Security Zones Overview">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="ch_urlzones_ovr"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="URL Security Zones Overview"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="URL Security Zones Overview"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="urlzones.htm#book_urlzones">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="urlzones.htm">URL Security Zones</A>
<IMG SRC="../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="appendix_a.htm">Appendix A: Header File Additions Required for ActiveX Controls</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>URL Security Zones Overview</H1>

<P>Monikers, URLs, security zones, and pluggable protocols provide capabilities that allow you to asynchronously bind objects, bind Uniform Resource Locators (URLs), manage URL security zones, and create custom URL protocols. This section covers the functionality exported by the Urlmon.dll dynamic-link library (DLL).

<P><A CLASS=tctop HREF="overview.htm#Introduction"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Introduction</A><BR>
<P><A CLASS=tctop HREF="overview.htm#About_URLs_and_Name_"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">About URLs and Name Spaces</A><BR>
<P><A CLASS=tctop HREF="overview.htm#SecurityZones"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">About URL Security Zones</A><BR>
<P><A CLASS=tctop HREF="overview.htm#Handling_URL_Securit"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Handling URL Security Zones</A><BR>
<P><A CLASS=tctop HREF="overview.htm#Creating_a_Customize"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Creating a Customized URL Security Manager</A><BR>
<P><A CLASS=tctop HREF="overview.htm#Accessing_the_Defaul"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Accessing the Default Managers</A><BR>
<P><A CLASS=tctop HREF="appendix_a.htm#urlzones_a"><IMG SRC="../../art/arrowy.gif" WIDTH="6" HEIGHT="11" BORDER=0 ALT="arrowy.gif">Appendix A: Header File Additions Required for ActiveX Controls</A><BR>
<H2><A NAME="Introduction">Introduction</A></H2>
<P>If you want to compile programs that use the functionality provided in Urlmon.dll, you must make sure the Urlmon.h header file is in the include directory, and the Urlmon.lib library file is in the library directory, of the C/C++ compiler you use.

<P>This documentation assumes that you have an understanding of Microsoft&#174; Win32&#174; programming. Also, for asynchronous monikers, asynchronous pluggable protocols, and URL monikers you should have an understanding of OLE and COM programming. For the Internet-related interfaces, methods, and functions, an understanding of the format and syntax of URLs is also required. For more information, see RFC 1738, <I>Uniform Resource Locators (URL)</I>. You can find this document at <A HREF="http://ds.internic.net/rfc/rfc1738.txt" TARGET="_top">http://ds.internic.net/rfc/rfc1738.txt</A>.<IMG SRC="../../art/external.gif" WIDTH="19" HEIGHT="8" ALT="External Link" >




<H2><A NAME="About_URLs_and_Name_">About URLs and Name Spaces</A></H2>
<P>A Uniform Resource Locator (URL) follows the syntax described in RFC 1738, which specifies a protocol scheme followed by a scheme-specific portion (&lt;scheme&gt;:&lt;scheme-specific portion&gt;). For example, in the URL http://www.microsoft.com/, "http" is the scheme and "//www.microsoft.com/" is the scheme-specific portion.

<P>The beginning portion of the scheme-specific portion of the URL contains the server name. This portion of the URL is often referred to as the URL name space.




<H2><A NAME="SecurityZones">About URL Security Zones</A></H2>
<P>To fully understand URL security zones, you need to understand a few terms:

<UL><LI><B>URL action</B> is an action that a browser can take that might pose a security risk to the local computer. These include actions such as running a Java applet (<A HREF="constants/urlaction.htm#URLACTION_JAVA_PERMI">URLACTION_JAVA_PERMISSIONS</A> in this case) or an ActiveX&#153; control (<A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_RU">URLACTION_ACTIVEX_RUN</A> in this case).
<LI><B>URL policy</B> is a policy that determines what permission or trust level is set for a particular URL action. These include setting the safety level for Java to high (<A HREF="constants/urlpolicy.htm#URLPOLICY_JAVA_HIGH">URLPOLICY_JAVA_HIGH</A> in this case).
<LI><B>URL security zone</B> is a group of URL name spaces that are assigned an equal level of permission (or trust). Each URL action for the zone has an appropriate URL policy assigned to it that reflects the level of trust given to the URL name spaces in that zone.
</UL>
<P>Previously, Microsoft Internet Explorer utilized the same security policy for all URL name spaces. Each URL action in a particular security level was handled by a predetermined URL policy, which could not be changed. In Internet Explorer 4.0, URL name spaces are divided into URL security zones, which have different levels of trust assigned to them. Users can easily customize the default URL security zones by changing the URL policy settings for each URL action with the user interface provided by Internet Explorer.



<H3><A NAME="Default_URL_Security">Default URL Security Zones</A></H3>
<P>The default URL security zones used by Internet Explorer 4.0 are:


<UL><LI>The Intranet
<LI>Trusted Web sites
<LI>Internet
<LI>Untrusted sites
</UL>
<P>The Intranet zone is used for content located on a company's intranet. Since the servers and information would be within a company's firewall, a user or company could assign a higher trust level to the content on their intranet.

<P>The following table contains the default settings for the intranet zone.

<TABLE>
<TR><TD><B>URL action
</B></TD>
<TD><B>URL policy
</B></TD>
<TD><B>Aggregates
</B></TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_RU">URLACTION_ACTIVEX_RUN</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_DOWNLOAD_S">URLACTION_DOWNLOAD_SIGNED_ACTIVEX</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_DOWNLOAD_U">URLACTION_DOWNLOAD_UNSIGNED_ACTIVEX</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_DISALLOW">URLPOLICY_DISALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_OV">URLACTION_ACTIVEX_OVERRIDE_OBJECT_SAFETY</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD><A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_OV">URLACTION_ACTIVEX_OVERRIDE_DATA_SAFETY</A> and <A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_OV">URLACTION_ACTIVEX_OVERRIDE_SCRIPT_SAFETY</A></TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SCRIPT_RUN">URLACTION_SCRIPT_RUN</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SCRIPT_JAV">URLACTION_SCRIPT_JAVA_USE</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_JAVA_PERMI">URLACTION_JAVA_PERMISSIONS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_JAVA_HIGH">URLPOLICY_JAVA_HIGH</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_HTML_FONT_">URLACTION_HTML_FONT_DOWNLOAD</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_FILE">URLACTION_SHELL_FILE_DOWNLOAD</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD><A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS_FROM</A> and <A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS_TO</A></TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_INST">URLACTION_SHELL_INSTALL_DTITEMS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_MOVE">URLACTION_SHELL_MOVE_OR_COPY</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_VERB">URLACTION_SHELL_VERB</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_CREDENTIAL">URLACTION_CREDENTIALS_USE</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_CREDENTIAL">URLPOLICY_CREDENTIALS_MUST_PROMPT_USER</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_CHANNEL_SO">URLACTION_CHANNEL_SOFTDIST_PERMISSIONS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_CHANNEL_SO">URLPOLICY_CHANNEL_SOFTDIST_PRECACHE</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_WEBV">URLACTION_SHELL_WEBVIEW_VERB</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
</TABLE>
<P>The Trusted Web sites zone is used for content located on Web sites that are considered more reputable and/or trustworthy than other sites on the Internet. Users can use this zone to assign a higher trust level to these sites to minimize the number of authentication requests. The URLs of these trusted Web sites would need to be mapped into this zone.

<P>The following table contains the default settings for the Trusted Web sites zone.

<TABLE>
<TR><TD><B>URL action
</B></TD>
<TD><B>URL policy
</B></TD>
<TD><B>Aggregates
</B></TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_RU">URLACTION_ACTIVEX_RUN</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_DOWNLOAD_S">URLACTION_DOWNLOAD_SIGNED_ACTIVEX</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_DOWNLOAD_U">URLACTION_DOWNLOAD_UNSIGNED_ACTIVEX</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_OV">URLACTION_ACTIVEX_OVERRIDE_OBJECT_SAFETY</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD><A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_OV">URLACTION_ACTIVEX_OVERRIDE_DATA_SAFETY</A> and <A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_OV">URLACTION_ACTIVEX_OVERRIDE_SCRIPT_SAFETY</A></TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SCRIPT_RUN">URLACTION_SCRIPT_RUN</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SCRIPT_JAV">URLACTION_SCRIPT_JAVA_USE</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_JAVA_PERMI">URLACTION_JAVA_PERMISSIONS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_JAVA_LOW">URLPOLICY_JAVA_LOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_HTML_FONT_">URLACTION_HTML_FONT_DOWNLOAD</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_FILE">URLACTION_SHELL_FILE_DOWNLOAD</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD><A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS_FROM</A> and <A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS_TO</A></TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_INST">URLACTION_SHELL_INSTALL_DTITEMS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_MOVE">URLACTION_SHELL_MOVE_OR_COPY</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_VERB">URLACTION_SHELL_VERB</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_CREDENTIAL">URLACTION_CREDENTIALS_USE</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_CREDENTIAL">URLPOLICY_CREDENTIALS_SILENT_LOGON_OK</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_CHANNEL_SO">URLACTION_CHANNEL_SOFTDIST_PERMISSIONS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_CHANNEL_SO">URLPOLICY_CHANNEL_SOFTDIST_AUTOINSTALL</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_WEBV">URLACTION_SHELL_WEBVIEW_VERB</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
</TABLE>
<P>The Internet zone is used for the Web sites on the Internet that do not belong to another zone. The default settings would cause the user to be prompted whenever potentially unsafe content was about to be downloaded. Web sites that are not mapped into other zones automatically fall into this zone.

<P>The following table contains the default settings for the Internet zone.

<TABLE>
<TR><TD><B>URL action
</B></TD>
<TD><B>URL policy
</B></TD>
<TD><B>Aggregates
</B></TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_RU">URLACTION_ACTIVEX_RUN</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_DOWNLOAD_S">URLACTION_DOWNLOAD_SIGNED_ACTIVEX</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_DOWNLOAD_U">URLACTION_DOWNLOAD_UNSIGNED_ACTIVEX</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_DISALLOW">URLPOLICY_DISALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_OV">URLACTION_ACTIVEX_OVERRIDE_OBJECT_SAFETY</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD><A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_OV">URLACTION_ACTIVEX_OVERRIDE_DATA_SAFETY</A> and <A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_OV">URLACTION_ACTIVEX_OVERRIDE_SCRIPT_SAFETY</A></TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SCRIPT_RUN">URLACTION_SCRIPT_RUN</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SCRIPT_JAV">URLACTION_SCRIPT_JAVA_USE</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_JAVA_PERMI">URLACTION_JAVA_PERMISSIONS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_JAVA_HIGH">URLPOLICY_JAVA_HIGH</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_HTML_FONT_">URLACTION_HTML_FONT_DOWNLOAD</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_FILE">URLACTION_SHELL_FILE_DOWNLOAD</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD><A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS_FROM</A> and <A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS_TO</A></TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_INST">URLACTION_SHELL_INSTALL_DTITEMS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_MOVE">URLACTION_SHELL_MOVE_OR_COPY</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_VERB">URLACTION_SHELL_VERB</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_CREDENTIAL">URLACTION_CREDENTIALS_USE</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_CREDENTIAL">URLPOLICY_CREDENTIALS_MUST_PROMPT_USER</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_CHANNEL_SO">URLACTION_CHANNEL_SOFTDIST_PERMISSIONS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_CHANNEL_SO">URLPOLICY_CHANNEL_SOFTDIST_PRECACHE</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_WEBV">URLACTION_SHELL_WEBVIEW_VERB</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD>none</TD>
</TR>
</TABLE>
<P>The Untrusted sites zone is used for Web sites that contain content that could cause, or have caused, problems when downloaded. This zone could be used to cause the user to be prompted every time potentially unsafe content was about to be downloaded or prevent that content from being downloaded. The URLs of these untrusted Web sites would need to be mapped into this zone.


<P>The following table contains the default settings for the Untrusted sites zone.

<TABLE>
<TR><TD><B>URL action
</B></TD>
<TD><B>URL policy
</B></TD>
<TD><B>Aggregates
</B></TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_RU">URLACTION_ACTIVEX_RUN</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_DISALLOW">URLPOLICY_DISALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_DOWNLOAD_S">URLACTION_DOWNLOAD_SIGNED_ACTIVEX</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_DISALLOW">URLPOLICY_DISALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_DOWNLOAD_U">URLACTION_DOWNLOAD_UNSIGNED_ACTIVEX</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_DISALLOW">URLPOLICY_DISALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_OV">URLACTION_ACTIVEX_OVERRIDE_OBJECT_SAFETY</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_DISALLOW">URLPOLICY_DISALLOW</A></TD>
<TD><A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_OV">URLACTION_ACTIVEX_OVERRIDE_DATA_SAFETY</A> and <A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_OV">URLACTION_ACTIVEX_OVERRIDE_SCRIPT_SAFETY</A></TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SCRIPT_RUN">URLACTION_SCRIPT_RUN</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SCRIPT_JAV">URLACTION_SCRIPT_JAVA_USE</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_DISALLOW">URLPOLICY_DISALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_JAVA_PERMI">URLACTION_JAVA_PERMISSIONS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_JAVA_HIGH">URLPOLICY_JAVA_HIGH</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_HTML_FONT_">URLACTION_HTML_FONT_DOWNLOAD</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_FILE">URLACTION_SHELL_FILE_DOWNLOAD</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_DISALLOW">URLPOLICY_DISALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_DISALLOW">URLPOLICY_DISALLOW</A></TD>
<TD><A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS_FROM</A> and <A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS_TO</A></TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_INST">URLACTION_SHELL_INSTALL_DTITEMS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_DISALLOW">URLPOLICY_DISALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_MOVE">URLACTION_SHELL_MOVE_OR_COPY</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_DISALLOW">URLPOLICY_DISALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_VERB">URLACTION_SHELL_VERB</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_DISALLOW">URLPOLICY_DISALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_CREDENTIAL">URLACTION_CREDENTIALS_USE</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_CREDENTIAL">URLPOLICY_CREDENTIALS_MUST_PROMPT_USER</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_CHANNEL_SO">URLACTION_CHANNEL_SOFTDIST_PERMISSIONS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_CHANNEL_SO">URLPOLICY_CHANNEL_SOFTDIST_PROHIBIT</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_WEBV">URLACTION_SHELL_WEBVIEW_VERB</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD>none</TD>
</TR>
</TABLE>
<P>There is also an implicit zone used for content that exists on the local computer. The content found on the local computer, except for content cached by Microsoft Internet Explorer on the local system, is treated with a high level of trust. Content that has been cached by Internet Explorer is accessed through the URL of origin and is assigned to the appropriate zone. 

<P>The following table contains the default settings for the local computer zone.

<TABLE>
<TR><TD><B>URL action
</B></TD>
<TD><B>URL policy
</B></TD>
<TD><B>Aggregates
</B></TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_RU">URLACTION_ACTIVEX_RUN</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_DOWNLOAD_S">URLACTION_DOWNLOAD_SIGNED_ACTIVEX</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_DOWNLOAD_U">URLACTION_DOWNLOAD_UNSIGNED_ACTIVEX</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_OV">URLACTION_ACTIVEX_OVERRIDE_OBJECT_SAFETY</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_QUERY">URLPOLICY_QUERY</A></TD>
<TD><A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_OV">URLACTION_ACTIVEX_OVERRIDE_DATA_SAFETY</A> and <A HREF="constants/urlaction.htm#URLACTION_ACTIVEX_OV">URLACTION_ACTIVEX_OVERRIDE_SCRIPT_SAFETY</A></TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SCRIPT_RUN">URLACTION_SCRIPT_RUN</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SCRIPT_JAV">URLACTION_SCRIPT_JAVA_USE</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_JAVA_PERMI">URLACTION_JAVA_PERMISSIONS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_JAVA_MEDIU">URLPOLICY_JAVA_MEDIUM</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_HTML_FONT_">URLACTION_HTML_FONT_DOWNLOAD</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_FILE">URLACTION_SHELL_FILE_DOWNLOAD</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD><A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS_FROM</A> and <A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS_TO</A></TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_INST">URLACTION_SHELL_INSTALL_DTITEMS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_MOVE">URLACTION_SHELL_MOVE_OR_COPY</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_VERB">URLACTION_SHELL_VERB</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_CREDENTIAL">URLACTION_CREDENTIALS_USE</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_CREDENTIAL">URLPOLICY_CREDENTIALS_SILENT_LOGON_OK</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_CHANNEL_SO">URLACTION_CHANNEL_SOFTDIST_PERMISSIONS</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_CHANNEL_SO">URLPOLICY_CHANNEL_SOFTDIST_PRECACHE</A></TD>
<TD>none</TD>
</TR>
<TR><TD><A HREF="constants/urlaction.htm#URLACTION_SHELL_WEBV">URLACTION_SHELL_WEBVIEW_VERB</A></TD>
<TD><A HREF="constants/urlpolicy.htm#URLPOLICY_ALLOW">URLPOLICY_ALLOW</A></TD>
<TD>none</TD>
</TR>
</TABLE>
<P>Asynchronous pluggable protocols can specify how their URLs should be assigned to a security zone. The <A HREF="../pluggable/ifaces/iinternetprotocolinfo/ParseUrl.htm#IInternetProtocolInf">IInternetProtocolInfo::ParseUrl</A> method using the <A HREF="../pluggable/enums/enums.htm#PARSE_SECURITY_URL">PARSE_SECURITY_URL</A> value should return a URL that the security manager can use to make decisions.



<H3><A NAME="URL_Actions_and_Poli">URL Actions and Policies</A></H3>
<P>Each URL security zone has a set of URL actions with a URL policy assigned to it. The URL actions cover all operations that have security implications. A URL policy is assigned to each URL action to determine how that URL action will be handled. For example, <A HREF="constants/urlaction.htm#URLACTION_JAVA_PERMI">URLACTION_JAVA_PERMISSIONS</A> would be checked for operations related to Java applets. To force all Java applets to run out of a sandbox (that is, prevent it from doing anything that would be a security risk to the local computer), the URL policy would be set to <A HREF="constants/urlpolicy.htm#URLPOLICY_JAVA_HIGH">URLPOLICY_JAVA_HIGH</A>.

<P>Some URL actions are an aggregate of two or more URL actions. The user interface for the default URL security zone manager would allow the user to set the aggregate value only (such as <A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS</A>). The browser would call the specific value (such as <A HREF="constants/urlaction.htm#URLACTION_HTML_SUBMI">URLACTION_HTML_SUBMIT_FORMS_FROM</A>) because it is reacting to that particular action. If the aggregate URL action has a URL policy set, that policy is used for the aggregate URL action and the specific URL actions it aggregated. All security zone managers must be designed to handle calls to the specific URL actions and know where to find the appropriate URL policy.




<H2><A NAME="Handling_URL_Securit">Handling URL Security Zones</A></H2>
<P>There are two scenarios where you would use the URL security zone interfaces:

<UL><LI>Applications that are hosting either the WebBrowser control or IE4/MSHTML and want to implement their own security manager to handle security zones.
<LI>Controls that are hosted by IE4/MSHTML and want to get information about a security setting.
</UL>
<P>In a few cases, an application might want to manage the default URL security zone settings by using the <A HREF="ifaces/iinternetzonemanager/IInternetZoneManager.htm#IInternetZoneManager">IInternetZoneManager</A> interface. The changes would not be static, because the user could override any changes by setting the URL security zone options in Internet Explorer 4.0. In most cases, applications that need to control the URL security zone settings should create an application that hosts the WebBrowser control or IE4/MSHTML and implement their own security manager.

<P><B>Interfaces related to URL security zones</B>
<UL><LI><A HREF="ifaces/iinternethostsecuritymanager/IInternetHostSecurityManager.htm#IInternetHostSecurit">IInternetHostSecurityManager</A>
<LI><A HREF="ifaces/iinternetsecuritymanager/IInternetSecurityManager.htm#IInternetSecurityMan">IInternetSecurityManager</A>
<LI><A HREF="ifaces/iinternetsecuritymgrsite/IInternetSecurityMgrSite.htm#IInternetSecurityMgr">IInternetSecurityMgrSite</A>
<LI><A HREF="ifaces/iinternetzonemanager/IInternetZoneManager.htm#IInternetZoneManager">IInternetZoneManager</A>
</UL>
<!-- ************************ BRADYA: BEGIN UPDATE ************************ --><H3><A NAME="Applications_Hosting">Applications Hosting the WebBrowser Control or IE4/MSHTML</A></H3>
<P>The WebBrowser control or IE4/MSHTML hosts could create a security manager (by implementing the <A HREF="ifaces/iinternetsecuritymanager/IInternetSecurityManager.htm#IInternetSecurityMan">IInternetSecurityManager</A> interface) that handles the URL actions and policies that are important to the host. Other URL actions and policies would be passed to the default security manager so it can handle them appropriately. The <A HREF="ifaces/iinternetsecuritymgrsite/IInternetSecurityMgrSite.htm#IInternetSecurityMgr">IInternetSecurityMgrSite</A> interface would be used to handle Windows&#174;-related information from the component so that the customized security manager can handle any user interface it needed.

<P>To create a customized security manager, the component must implement the <A HREF="ifaces/iinternetsecuritymanager/IInternetSecurityManager.htm#IInternetSecurityMan">IInternetSecurityManager</A> interface. Any methods or URL actions that the customized security manager wants the default security manager to act on should return <A HREF="../monikers/constants/errors.htm#INET_E_DEFAULT_ACTIO">INET_E_DEFAULT_ACTION</A>.

<P>The component must also implement a ClientSite object when embedding either the WebBrowser control or IE4/MSHTML. 



<P>The following steps occur for a URL action:

<OL><LI>IE4/MSHTML uses
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>CoCreateInstance</A> to create an instance of the <A HREF="objects/InternetSecurityManager.htm#InternetSecurityManager">Internet Security Manager</A>.

<P><IMG SRC="../../art/AX_SZM01.gif" WIDTH="425" HEIGHT="162" ALT="Creating an instance of the security manager" >

<LI>The <A HREF="objects/InternetSecurityManager.htm#InternetSecurityManager">Internet Security Manager</A> calls the
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>QueryInterface</A> method on IE4/MSHTML to get its
<object id="hhal_5" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_5.Click()>IServiceProvider</A> interface. IE4/MSHTML then calls the <B>QueryInterface</B> method on the
<object id="hhal_6" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_6.Click()>IOleClientSite</A> interface to get the <B>IServiceProvider</B> interface.

<P><IMG SRC="../../art/AX_SZM02.gif" WIDTH="425" HEIGHT="169" ALT="Finding the IServiceProvider interface" >

<LI><object id="hhal_7" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_7.Click()>IServiceProvider::QueryService</A> is called to get an <A HREF="ifaces/iinternetsecuritymanager/IInternetSecurityManager.htm#IInternetSecurityMan">IInternetSecurityManager</A> interface. The component then passes a pointer to its implementation of <B>IInternetSecurityManager</B> to the <A HREF="objects/InternetSecurityManager.htm#InternetSecurityManager">Internet Security Manager</A>.

<P><IMG SRC="../../art/AX_SZM03.gif" WIDTH="425" HEIGHT="162" ALT="Getting a reference to the custom security manager" >

<LI>Calls from IE4/MSHTML to the <A HREF="ifaces/iinternetsecuritymanager/IInternetSecurityManager.htm#IInternetSecurityMan">IInternetSecurityManager</A> methods are passed to the custom security manager from the default <A HREF="objects/InternetSecurityManager.htm#InternetSecurityManager">Internet Security Manager</A>. 

<P><IMG SRC="../../art/AX_SZM04.gif" WIDTH="425" HEIGHT="162" ALT="Passing a call to the custom security manager" >

<LI>If the method called returns <A HREF="../monikers/constants/errors.htm#INET_E_DEFAULT_ACTIO">INET_E_DEFAULT_ACTION</A>, the default implementation of <A HREF="ifaces/iinternetsecuritymanager/IInternetSecurityManager.htm#IInternetSecurityMan">IInternetSecurityManager</A> is used to resolve the call. Otherwise the result from the custom security manager is returned.

<P><IMG SRC="../../art/AX_SZM05.gif" WIDTH="425" HEIGHT="162" ALT="Returning back to the default security manager" >

<LI>The <A HREF="objects/InternetSecurityManager.htm#InternetSecurityManager">Internet Security Manager</A> returns the result back to IE4/MSHTML.

<P><IMG SRC="../../art/AX_SZM06.gif" WIDTH="425" HEIGHT="169" ALT="Returning back to IE4/MSHTML" >
</OL>
<P><B>Note</B>  The URL security zone API offers support only for a single, customized security manager to delegate URL actions back to the default security manager. If more than one customized security manager is implemented, the additional security managers must explicitly find and invoke the security manager above it to allow multiple delegations to operate correctly.
<H3><A NAME="Components_Hosted_by">Components Hosted by IE4/MSHTML</A></H3>
<P>Components hosted by the WebBrowser control or IE4/MSHTML might need to query the security manager for the URL policies being implemented in the URL security zone they are in. These components include script engines (JScript and VBScript), controls, Java applets, code download, and so on. For example, the code download component of Internet Explorer 4.0 needs to ask the security manager if it can download unsigned ActiveX Controls. The component calls the <A HREF="ifaces/iinternethostsecuritymanager/ProcessUrlAction.htm#IInternetHostSecurit">IInternetHostSecurityManager::ProcessUrlAction</A> method to check what the policy is on Java applets to help make its decision. 

<P>To query for URL policies, these components use the <A HREF="ifaces/iinternethostsecuritymanager/IInternetHostSecurityManager.htm#IInternetHostSecurit">IInternetHostSecurityManager</A> interface. The component must also have the address of a site interface implemented by the WebBrowser control or IE4/MSHTML. The exact site interface would depend on the type of component being hosted. For example, a script engine should have the
<object id="hhal_8" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_IActiveScriptSite>
</object><A HREF=JavaScript:hhal_8.Click()>IActiveScriptSite</A> interface implemented, while controls would implement an
<object id="hhal_9" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_9.Click()>IOleClientSite</A> interface. To get the address of this interface:

<OL><LI>The component calls the
<object id="hhal_10" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_10.Click()>QueryInterface</A> method on the site interface to get the
<object id="hhal_11" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_11.Click()>IServiceProvider</A> interface. The component then calls
<object id="hhal_12" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_12.Click()>IServiceProvider::QueryService</A> to get the <A HREF="ifaces/iinternethostsecuritymanager/IInternetHostSecurityManager.htm#IInternetHostSecurit">IInternetHostSecurityManager</A> interface.

<P><IMG SRC="../../art/AX_HSM01.gif" WIDTH="417" HEIGHT="162" ALT="Accessing the host security manager" >

<LI>The component calls the <A HREF="ifaces/iinternethostsecuritymanager/IInternetHostSecurityManager.htm#IInternetHostSecurit">IInternetHostSecurityManager</A> methods. The host security manager creates an instance of the <A HREF="objects/InternetSecurityManager.htm#InternetSecurityManager">Internet Security Manager</A>. The host security manager then adds the URL and calls the associated method on the <A HREF="ifaces/iinternetsecuritymanager/IInternetSecurityManager.htm#IInternetSecurityMan">IInternetSecurityManager</A> interface.

<P><IMG SRC="../../art/AX_HSM02.gif" WIDTH="417" HEIGHT="162" ALT="Getting security zone information" >

<P>If a custom security manager was implemented by a host application, the default <A HREF="objects/InternetSecurityManager.htm#InternetSecurityManager">Internet Security Manager</A> would pass the call up to the custom security manager's <A HREF="ifaces/iinternetsecuritymanager/IInternetSecurityManager.htm#IInternetSecurityMan">IInternetSecurityManager</A> interface.

<LI>The <A HREF="ifaces/iinternetsecuritymanager/IInternetSecurityManager.htm#IInternetSecurityMan">IInternetSecurityManager</A> method would return its results to <A HREF="ifaces/iinternethostsecuritymanager/IInternetHostSecurityManager.htm#IInternetHostSecurit">IInternetHostSecurityManager</A>, which would then pass the results to the component.

<P><IMG SRC="../../art/AX_HSM03.gif" WIDTH="417" HEIGHT="162" ALT="Returning results back from the security manager" >
</OL>
<H2><A NAME="Creating_a_Customize">Creating a Customized URL Security Manager</A></H2>
<P>A customized URL security manager can be created for applications that host either the WebBrowser control or IE4/MSHTML by implementing the <A HREF="ifaces/iinternetsecuritymanager/IInternetSecurityManager.htm#IInternetSecurityMan">IInternetSecurityManager</A> interface. Most of the <B>IInternetSecurityManager</B> methods, except <A HREF="ifaces/iinternetsecuritymanager/ProcessUrlAction.htm#IInternetSecurityMan">IInternetSecurityManager::ProcessUrlAction</A>, would only need to return <A HREF="../monikers/constants/errors.htm#INET_E_DEFAULT_ACTIO">INET_E_DEFAULT_ACTION</A> to defer the call to the default security manager.

<P>The following example shows an implementation of the <A HREF="ifaces/iinternetsecuritymanager/ProcessUrlAction.htm#IInternetSecurityMan">IInternetSecurityManager::ProcessUrlAction</A> method for a customized security manager that wants to require that data be encrypted.

<PRE>HRESULT MySecurityManager::ProcessUrlAction(
    LPWSTR pwszUrl, 
    DWORD dwAction,
    BYTE *pPolicy,
    DWORD cbPolicy,
    DWORD dwReserved
)
{
    DWORD dwPolicy = URLPOLICY_ENCRYPT_REQUIRED;

    if (dwAction == URLACTION_ENCRYPT_DATA)
    {
        if (cbPolicy &gt;= sizeof (DWORD))
         {   
                *(DWORD *)pPolicy = dwPolicy;
                return S_OK;
        }
        else
            return S_FALSE;
    }      
    else
        return INET_E_DEFAULT_ACTION;
}
</PRE>
<P><B>Note</B>  The Internet Explorer 4.0 default security manager cannot be replaced by a customized security manager.
<H2><A NAME="Accessing_the_Defaul">Accessing the Default Managers</A></H2>
<P>To access the default <A HREF="objects/InternetSecurityManager.htm#InternetSecurityManager">Internet Security Manager</A> and <A HREF="objects/InternetZoneManager.htm#InternetZoneManager">Internet Zone Manager</A> objects, the client application should use the
<object id="hhal_13" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_13.Click()>CoCreateInstance</A> function to create an instance of these objects.

<P>The following sample creates an instance of both the <A HREF="objects/InternetSecurityManager.htm#InternetSecurityManager">Internet Security Manager</A> and the <A HREF="objects/InternetZoneManager.htm#InternetZoneManager">Internet Zone Manager</A>.

<PRE>HRESULT hr;
IInternetSecurityManager *pSecurityMgr;
IInternetZoneManager *pZoneMgr;

hr = CoCreateInstance(CLSID_InternetSecurityManager, NULL, CLSCTX_INPROC_SERVER,
            IID_IInternetSecurityManager, (void**)&amp;pSecurityMgr);

hr = CoCreateInstance(CLSID_InternetZoneManager, NULL, CLSCTX_INPROC_SERVER,
            IID_IInternetZoneManager, (void**)&amp;pZoneMgr);
</PRE>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>