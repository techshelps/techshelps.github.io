<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Gopher Sessions</TITLE>

<META NAME=MS-HKWD CONTENT="Gopher Sessions">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="winineto_gopher"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Gopher Sessions"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Gopher Sessions"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="introduction.htm#ch_winineto">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="ftp.htm">FTP Sessions</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="http.htm">HTTP Sessions</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Gopher Sessions</H1>

<P>The Win32 Internet Gopher functions create and use Internet Gopher utilities to access information on Gopher servers worldwide.

<P>Gopher functions, like the FTP functions, cannot be used through a CERN type proxy because CERN proxies recognize only HTTP. Applications that need to access a Gopher server through a CERN proxy should use <A HREF="../functions/InternetOpenUrl.htm#InternetOpenUrl">InternetOpenUrl</A> to access the resource directly. For more information on direct resource access, see <A HREF="url_functions.htm#Direct_Access">Accessing URLs directly</A>.

<P>The following diagram shows the relationship of Win32 Internet functions used for the Gopher protocol. The shaded boxes represent functions that return HINTERNET handles, while the plain boxes represent functions that use the HINTERNET handle created by the function on which they depend.

<P>
<P><IMG SRC="../../../art/AX_WNT04.gif" WIDTH="528" HEIGHT="147" ALT="Win32 Internet functions used for Gopher protocol" >
<P>
<P>For more information on HINTERNET handles and the handle hierarchy, see <A HREF="appendix_a.htm#HINTERNET">Appendix A: HINTERNET Handles</A>.



<H2><A NAME="Using_the_Win32_Inte">Using the Win32 Internet Functions for Gopher Sessions</A></H2>
<P>The following Win32 Internet functions are used during Gopher sessions. These functions are not recognized by CERN proxies. Applications that must function through CERN type proxies should use <A HREF="../functions/InternetOpenUrl.htm#InternetOpenUrl">InternetOpenUrl</A> and access the resources directly. For more information on direct resource access, see <A HREF="url_functions.htm#Direct_Access">Accessing URLs directly</A>.

<TABLE>
<TR><TD><B>Function
 </B></TD><TD><B>Description
</B></TD></TR>
<TR><TD><A HREF="../functions/GopherAttributeEnumerator.htm#GopherAttributeEnume">GopherAttributeEnumerator</A> </TD><TD>Defines a callback function that processes attribute information from a Gopher server. </TD></TR>
<TR><TD><A HREF="../functions/GopherCreateLocator.htm#GopherCreateLocator">GopherCreateLocator</A> </TD><TD>Forms a Gopher locator for use in other Gopher function calls.</TD></TR>
<TR><TD><A HREF="../functions/GopherFindFirstFile.htm#GopherFindFirstFile">GopherFindFirstFile</A> </TD><TD>Starts enumerating a Gopher directory listing. This function requires a handle created by <A HREF="../functions/InternetConnect.htm#InternetConnect">InternetConnect</A>.</TD></TR>
<TR><TD><A HREF="../functions/GopherGetAttribute.htm#GopherGetAttribute">GopherGetAttribute</A> </TD><TD>Retrieves attribute information on the Gopher object. This function requires a handle created by <A HREF="../functions/InternetConnect.htm#InternetConnect">InternetConnect</A>.</TD></TR>
<TR><TD><A HREF="../functions/GopherGetLocatorType.htm#GopherGetLocatorType">GopherGetLocatorType</A> </TD><TD>Parses a Gopher locator and determines its attributes.</TD></TR>
<TR><TD><A HREF="../functions/GopherOpenFile.htm#GopherOpenFile">GopherOpenFile</A> </TD><TD>Starts retrieving a Gopher object. This function requires a handle created by <A HREF="../functions/InternetConnect.htm#InternetConnect">InternetConnect</A>.</TD></TR></TABLE>
<H3><A NAME="Creating_locators">Creating locators</A></H3>
<P>The Win32 Internet function <A HREF="../functions/GopherCreateLocator.htm#GopherCreateLocator">GopherCreateLocator</A> allows applications to create Gopher locators.

<P>This function accepts the host address, server port used by the host, display string, selector string, Gopher type, address of the buffer that stores the locator, and the buffer length. If the buffer address is set to NULL, the buffer length needed to store the locator is stored in the buffer length variable. If the buffer size is insufficient, the function fails. The
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>GetLastError</A> function returns ERROR_INSUFFICIENT_BUFFER and stores the necessary length in the buffer length variable.

<P>The display string contains the Gopher document or directory to be displayed. If this parameter is NULL, the function returns the default directory for the Gopher server.

<P>The selector string contains the information that the application is searching for in the Gopher server. This parameter can be set to NULL.


<P>Gopher types define the resource type the selector string is looking for; they can also define whether this is a Gopher or Gopher&#043; request. The following values are valid Gopher types:

<TABLE>
<TR><TD>GOPHER_TYPE_ASK </TD><TD>Ask&#043; item.</TD></TR>
<TR><TD>GOPHER_TYPE_BINARY </TD><TD>Binary file.</TD></TR>
<TR><TD>GOPHER_TYPE_BITMAP </TD><TD>Bitmap file.</TD></TR>
<TR><TD>GOPHER_TYPE_CALENDAR </TD><TD>Calendar file.</TD></TR>
<TR><TD>GOPHER_TYPE_CSO </TD><TD>CSO telephone book server.</TD></TR>
<TR><TD>GOPHER_TYPE_DIRECTORY </TD><TD>Directory of additional Gopher items.</TD></TR>
<TR><TD>GOPHER_TYPE_DOS_ARCHIVE </TD><TD>MS-DOS&#174; archive file.</TD></TR>
<TR><TD>GOPHER_TYPE_ERROR </TD><TD>Error condition indicator.</TD></TR>
<TR><TD>GOPHER_TYPE_GIF </TD><TD>GIF graphics file.</TD></TR>
<TR><TD>GOPHER_TYPE_GOPHER_PLUS </TD><TD>Gopher&#043; item.</TD></TR>
<TR><TD>GOPHER_TYPE_HTML </TD><TD>HTML document.</TD></TR>
<TR><TD>GOPHER_TYPE_IMAGE </TD><TD>Image file.</TD></TR>
<TR><TD>GOPHER_TYPE_INDEX_SERVER </TD><TD>Index server.</TD></TR>
<TR><TD>GOPHER_TYPE_INLINE </TD><TD>Inline file.</TD></TR>
<TR><TD>GOPHER_TYPE_MAC_BINHEX </TD><TD>Macintosh file in BINHEX format.</TD></TR>
<TR><TD>GOPHER_TYPE_MOVIE </TD><TD>Movie file.</TD></TR>
<TR><TD>GOPHER_TYPE_PDF </TD><TD>PDF file.</TD></TR>
<TR><TD>GOPHER_TYPE_REDUNDANT </TD><TD>Duplicated server indicator. The information contained within is a duplicate of the primary server. The primary server is defined as the last directory entry that did not have a GOPHER_TYPE_REDUNDANT type.</TD></TR>
<TR><TD>GOPHER_TYPE_SOUND </TD><TD>Sound file.</TD></TR>
<TR><TD>GOPHER_TYPE_TELNET </TD><TD>Telnet server.</TD></TR>
<TR><TD>GOPHER_TYPE_TEXT_FILE </TD><TD>ASCII text file.</TD></TR>
<TR><TD>GOPHER_TYPE_TN3270 </TD><TD>TN3270 server.</TD></TR>
<TR><TD>GOPHER_TYPE_UNIX_UUENCODED </TD><TD>UUENCODED file.</TD></TR>
<TR><TD>GOPHER_TYPE_UNKNOWN </TD><TD>Unknown item type.</TD></TR></TABLE>
<H3><A NAME="Enumerating_director">Enumerating directories</A></H3>
<P>Enumeration of a directory on a Gopher server requires the creation of an HINTERNET handle by <A HREF="../functions/GopherFindFirstFile.htm#GopherFindFirstFile">GopherFindFirstFile</A>. This handle is a branch of the Gopher session handle created by <A HREF="../functions/InternetConnect.htm#InternetConnect">InternetConnect</A>. <B>GopherFindFirstFile</B> locates the first file or directory on the server and returns it in a <A HREF="../structures/GOPHER_FIND_DATA.htm#GOPHER_FIND_DATA">GOPHER_FIND_DATA</A> structure. Use <A HREF="../functions/InternetFindNextFile.htm#InternetFindNextFile">InternetFindNextFile</A> until it fails, returning ERROR_NO_MORE_FILES. This method finds all subsequent files and directories on the server. For more information on <B>InternetFindNextFile</B>, see <A HREF="common.htm#Next_File">Finding the Next File</A>.

<P>To determine the resource type retrieved by <A HREF="../functions/GopherFindFirstFile.htm#GopherFindFirstFile">GopherFindFirstFile</A> or <A HREF="../functions/InternetFindNextFile.htm#InternetFindNextFile">InternetFindNextFile</A>, check the <B>GopherType</B> member of the <A HREF="../structures/GOPHER_FIND_DATA.htm#GOPHER_FIND_DATA">GOPHER_FIND_DATA</A> structure. The following values are valid Gopher types:




<TABLE>
<TR><TD>GOPHER_TYPE_ASK </TD><TD>Ask&#043; item.</TD></TR>
<TR><TD>GOPHER_TYPE_BINARY </TD><TD>Binary file.</TD></TR>
<TR><TD>GOPHER_TYPE_BITMAP </TD><TD>Bitmap file.</TD></TR>
<TR><TD>GOPHER_TYPE_CALENDAR </TD><TD>Calendar file.</TD></TR>
<TR><TD>GOPHER_TYPE_CSO </TD><TD>CSO telephone book server.</TD></TR>
<TR><TD>GOPHER_TYPE_DIRECTORY </TD><TD>Directory of additional Gopher items.</TD></TR>
<TR><TD>GOPHER_TYPE_DOS_ARCHIVE </TD><TD>MS-DOS&#174; archive file.</TD></TR>
<TR><TD>GOPHER_TYPE_ERROR </TD><TD>Error condition indicator.</TD></TR>
<TR><TD>GOPHER_TYPE_GIF </TD><TD>GIF graphics file.</TD></TR>
<TR><TD>GOPHER_TYPE_GOPHER_PLUS </TD><TD>Gopher&#043; item.</TD></TR>
<TR><TD>GOPHER_TYPE_HTML </TD><TD>HTML document.</TD></TR>
<TR><TD>GOPHER_TYPE_IMAGE </TD><TD>Image file.</TD></TR>
<TR><TD>GOPHER_TYPE_INDEX_SERVER </TD><TD>Index server.</TD></TR>
<TR><TD>GOPHER_TYPE_INLINE </TD><TD>Inline file.</TD></TR>
<TR><TD>GOPHER_TYPE_MAC_BINHEX </TD><TD>Macintosh file in BINHEX format.</TD></TR>
<TR><TD>GOPHER_TYPE_MOVIE </TD><TD>Movie file.</TD></TR>
<TR><TD>GOPHER_TYPE_PDF </TD><TD>PDF file.</TD></TR>
<TR><TD>GOPHER_TYPE_REDUNDANT </TD><TD>Duplicated server indicator. The information contained within is a duplicate of the primary server. The primary server is defined as the last directory entry that did not have a GOPHER_TYPE_REDUNDANT type.</TD></TR>
<TR><TD>GOPHER_TYPE_SOUND </TD><TD>Sound file.</TD></TR>
<TR><TD>GOPHER_TYPE_TELNET </TD><TD>Telnet server.</TD></TR>
<TR><TD>GOPHER_TYPE_TEXT_FILE </TD><TD>ASCII text file.</TD></TR>
<TR><TD>GOPHER_TYPE_TN3270 </TD><TD>TN3270 server.</TD></TR>
<TR><TD>GOPHER_TYPE_UNIX_UUENCODED </TD><TD>UUENCODED file.</TD></TR>
<TR><TD>GOPHER_TYPE_UNKNOWN </TD><TD>Unknown item type.</TD></TR></TABLE>
<H3><A NAME="Downloading_Gopher_r">Downloading Gopher resources</A></H3>
<P>The Win32 Internet functions <A HREF="../functions/GopherOpenFile.htm#GopherOpenFile">GopherOpenFile</A> and <A HREF="../functions/InternetReadFile.htm#InternetReadFile">InternetReadFile</A> allow applications to download a Gopher resource.

<P>To begin downloading a resource, <A HREF="../functions/GopherOpenFile.htm#GopherOpenFile">GopherOpenFile</A> must create an HINTERNET handle off the Gopher session handle returned by <A HREF="../functions/InternetConnect.htm#InternetConnect">InternetConnect</A>. After the handle is created, <A HREF="../functions/InternetReadFile.htm#InternetReadFile">InternetReadFile</A> can be used to download the resource. For more information on using <B>InternetReadFile</B>, see <A HREF="common.htm#Read_File">Reading files</A>.




<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>