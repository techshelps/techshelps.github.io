<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CommitUrlCacheEntry</TITLE>

<META NAME=MS-HKWD CONTENT="CommitUrlCacheEntry">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="CommitUrlCacheEntry"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="CommitUrlCacheEntry"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="CommitUrlCacheEntry"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../reference.htm#ch_wininet">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="cache.htm">Persistent URL Cache Functions</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="CreateUrlCacheEntry.htm">CreateUrlCacheEntry</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>CommitUrlCacheEntry</H1>

<PRE>BOOL CommitUrlCacheEntry(
    IN LPCSTR lpszUrlName,
    IN LPCSTR lpszLocalFileName,
    IN FILETIME ExpireTime,
    IN FILETIME LastModifiedTime,
    IN DWORD CacheEntryType,
    IN LPCBYTE lpHeaderInfo,
    IN DWORD dwHeaderSize,
    IN LPCSTR lpszFileExtension,
    IN DWORD dwReserved
    );
</PRE>
<P>Caches data in the specified file in the cache storage and associates it with the given URL. 

<UL><LI>Returns TRUE if successful, or FALSE otherwise. To get extended error information, call
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>GetLastError</A>. Possible error values include:
<TABLE>
<TR><TD>ERROR_DISK_FULL </TD><TD>The cache storage is full.</TD></TR>
<TR><TD>ERROR_FILE_NOT_FOUND </TD><TD>The specified local file is not found.</TD></TR></TABLE>
</UL>
<DL>
<DT><I>lpszUrlName</I>  </DT><DD>Address of a string that contains the source name of the cache entry. The name string must be unique, and should not contain any escape characters.
</DD><DT><I>lpszLocalFileName</I> </DT><DD>Address of a string that contains the name of the local file that is being cached. This should be the same name as that returned by <A HREF="CreateUrlCacheEntry.htm#CreateUrlCacheEntry">CreateUrlCacheEntry</A>. 
</DD><DT><I>ExpireTime</I>  </DT><DD><object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>FILETIME</A> structure that contains the expire date and time (GMT) of the file that is being cached. If the expire date and time is unknown, set this parameter to zero. 
</DD><DT><I>LastModifiedTime</I>  </DT><DD><object id="hhal_5" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_5.Click()>FILETIME</A> structure that contains the last modified date and time (GMT) of the URL that is being cached. If the last modified date and time is unknown, set this parameter to zero.
</DD><DT><I>CacheEntryType</I> </DT><DD>Cache type bitmask. Currently, the cache entry type values have not been finalized, so this value does not serve a real purpose at this point, except for STICK_CACHE_ENTRY. Can be a combination of the following values:
<TABLE>
<TR><TD>COOKIE_CACHE_ENTRY</TD><TR><TD>NORMAL_CACHE_ENTRY</TD><TR><TD>OCX_CACHE_ENTRY</TD><TR><TD>SPARSE_CACHE_ENTRY</TD><TR><TD>STABLE_CACHE_ENTRY</TD><TR><TD>STICKY_CACHE_ENTRY</TD><TR><TD>TRACK_CACHE_ENTRY</TD><TR><TD>TRACK_OFFLINE_CACHE_ENTRY</TD><TR><TD>TRACK_ONLINE_CACHE_ENTRY</TD><TR><TD>URLHISTORY_CACHE_ENTRY</TD></TABLE>
<!-- ************************ BRADYA: BEGIN UPDATE ************************ --><P>The STICKY_CACHE_ENTRY type is used to make cache entries exempt from scavenging. The default exempt time for entries set using <B>CommitUrlCacheEntry</B> is one day. The exempt time can be changed using the <A HREF="SetUrlCacheEntryInfo.htm#SetUrlCacheEntryInfo">SetUrlCacheEntryInfo</A> function.
<!-- ************************ BRADYA: END UPDATE ************************** -->

</DD><DT><I>lpHeaderInfo</I>  </DT><DD>Address of the header information. If this parameter is not NULL, the header information is treated as extended attributes of the URL and is returned in the <A HREF="../structures/INTERNET_CACHE_ENTRY_INFO.htm#INTERNET_CACHE_ENTRY">INTERNET_CACHE_ENTRY_INFO</A> structure. 
</DD><DT><I>dwHeaderSize</I> </DT><DD>Size of the header information. If <I>lpHeaderInfo</I> is not NULL, this value is assumed to indicate the size of the header information. An application can maintain headers as part of the data and provide <I>dwHeaderSize</I> together with a NULL value for <I>lpHeaderInfo</I>.
</DD><DT><I>lpszFileExtension</I>  </DT><DD>Address of a buffer that contains information maintained in the cache database for future use. In this version of Win32 Internet functions, this information is not used.
</DD><DT><I>dwReserved</I>  </DT><DD>Reserved.  If redirection has taken place, this parameter should contain the address of a string containing the original URL. Otherwise, must be set to zero.
</DD></DL>
<P>If the cache storage is full, <B>CommitUrlCacheEntry</B> invokes cache cleanup to make space for this new file. If the cache entry already exists, the function overwrites the entry if it is not in use. An entry is in use when it has been retrieved with either <A HREF="RetrieveUrlCacheEntryStream.htm#RetrieveUrlCacheEntr">RetrieveUrlCacheEntryStream</A> or <A HREF="RetrieveUrlCacheEntryFile.htm#RetrieveUrlCacheEntr">RetrieveUrlCacheEntryFile</A>. 

<P>Clients who add entries to the cache should set the headers to at least "HTTP/1.0 200 OK\r\n\r\n"; otherwise, Microsoft Internet Explorer and other WinInet clients will disregard the entry.
<!-- ************************ BRADYA: BEGIN UPDATE ************************ --><!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>