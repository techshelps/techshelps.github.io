<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FtpGetFile</TITLE>

<META NAME=MS-HKWD CONTENT="FtpGetFile">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="FtpGetFile"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="FtpGetFile"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="FtpGetFile"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../reference.htm#ch_wininet">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="FtpGetCurrentDirectory.htm">FtpGetCurrentDirectory</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="FtpOpenFile.htm">FtpOpenFile</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>FtpGetFile</H1>

<PRE>BOOL FtpGetFile(
    IN HINTERNET hFtpSession,
    IN LPCSTR lpszRemoteFile,
    IN LPCSTR lpszNewFile,
    IN BOOL fFailIfExists,
    IN DWORD dwLocalFlagsAndAttributes,
    IN DWORD dwInternetFlags,
    IN DWORD dwContext
);
</PRE>
<P>Retrieves a file from the FTP server and stores it under the specified file name, creating a new local file in the process.

<UL><LI>Returns TRUE if successful, or FALSE otherwise. To get a specific error message, call
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>GetLastError</A>.

</UL>
<DL>
<DT><I>hFtpSession</I> </DT><DD>Valid handle to an FTP session.
</DD><DT><I>lpszRemoteFile</I> </DT><DD>Address of a null-terminated string that contains the name of the file to retrieve from the remote system.
</DD><DT><I>lpszNewFile</I> </DT><DD>Address of a null-terminated string that contains the name of the file to create on the local system.
</DD><DT><I>fFailIfExists</I> </DT><DD>Boolean flag that indicates whether the function should proceed if a local file of the specified name already exists. If <I>fFailIfExists</I> is TRUE and the local file exists, <B>FtpGetFile</B> fails.
</DD><DT><I>dwLocalFlagsAndAttributes</I> </DT><DD>File attributes for the new file. Can be any combination of the FILE_ATTRIBUTE_* flags used by the
<object id="hhal_4" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_4.Click()>CreateFile</A> function. For more information on FILE_ATTRIBUTE_* attributes, see <B>CreateFile</B> in the Platform SDK.
</DD><DT><I>dwInternetFlags</I> </DT><DD>Flags that control how the function will handle the file download. The first set of flag values indicates the conditions under which the transfer occurs. These transfer type flags can be used in combination with the second set of flags that control caching. The application can select one of these transfer type values:
<DL>
<DT>FTP_TRANSFER_TYPE_ASCII </DT><DD>Transfers the file using FTP's ASCII (Type A) transfer method. Control and formatting information is converted to local equivalents.
</DD><DT>FTP_TRANSFER_TYPE_BINARY </DT><DD>Transfers the file using FTP's Image (Type I) transfer method. The file is transferred exactly as it exists with no changes. This is the default transfer method.
</DD><DT>FTP_TRANSFER_TYPE_UNKNOWN </DT><DD>Defaults to FTP_TRANSFER_TYPE_BINARY.
</DD><DT>INTERNET_FLAG_TRANSFER_ASCII </DT><DD>Transfers the file as ASCII. 
</DD><DT>INTERNET_FLAG_TRANSFER_BINARY </DT><DD>Transfers the file as binary. 
</DD></DL>
</DD><DD>The following flags determine how the caching of this file will be done. Any combination of the following flags can be used with the transfer type flag. The possible values are:
<DL>
<DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_DONT_C">INTERNET_FLAG_DONT_CACHE</A> </DT><DD>Does not add the returned entity to the cache. Identical to the preferred value, <A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NO_CAC">INTERNET_FLAG_NO_CACHE_WRITE</A>.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_HYPERL">INTERNET_FLAG_HYPERLINK</A> </DT><DD>Forces a reload if there was no Expires time and no Last-Modified time returned from the server when determining whether to reload the item from the network.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_MAKE_P">INTERNET_FLAG_MAKE_PERSISTENT</A> </DT><DD>No longer supported.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_MUST_C">INTERNET_FLAG_MUST_CACHE_REQUEST</A>
</DT><DD>Causes a temporary file to be created if the file cannot be cached. Identical to the preferred value, <A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NEED_F">INTERNET_FLAG_NEED_FILE</A>. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NEED_F">INTERNET_FLAG_NEED_FILE</A> </DT><DD>Causes a temporary file to be created if the file cannot be cached. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NO_CAC">INTERNET_FLAG_NO_CACHE_WRITE</A> </DT><DD>Does not add the returned entity to the cache.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_RELOAD">INTERNET_FLAG_RELOAD</A> </DT><DD>Forces a download of the requested file, object, or directory listing from the origin server, not from the cache. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_RESYNC">INTERNET_FLAG_RESYNCHRONIZE</A> </DT><DD>Causes the FTP resource to be reloaded from the server.
</DD></DL>
</DD><DT><I>dwContext</I> </DT><DD>Application-defined value that associates this search with any application data. This is used only if the application has already called <A HREF="InternetSetStatusCallback.htm#InternetSetStatusCal">InternetSetStatusCallback</A> to set up a status callback function.
</DD></DL>
<P><B>FtpGetFile</B> is a high-level routine that handles all the bookkeeping and overhead associated with reading a file from an FTP server and storing it locally. An application that needs to retrieve file data only or that requires close control over the file transfer should use the <A HREF="FtpOpenFile.htm#FtpOpenFile">FtpOpenFile</A> and <A HREF="InternetReadFile.htm#InternetReadFile">InternetReadFile</A> functions.

<P>If the <I>dwTransferType</I> parameter specifies FILE_TRANSFER_TYPE_ASCII, translation of the file data converts control and formatting characters to local equivalents. The default transfer is binary mode, where the file is downloaded in the same format as it is stored on the server.

<P>Both <I>lpszRemoteFile</I> and <I>lpszNewFile</I> can be either partially or fully qualified file names relative to the current directory. A backslash (\) or forward slash (/) can be used as the directory separator for either name. <B>FtpGetFile</B> translates the directory name separators to the appropriate character before they are used.
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>