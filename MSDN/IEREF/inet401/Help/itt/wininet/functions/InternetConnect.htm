<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>InternetConnect</TITLE>

<META NAME=MS-HKWD CONTENT="InternetConnect">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="InternetConnect"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="InternetConnect"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="InternetConnect"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../reference.htm#ch_wininet">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="InternetConfirmZoneCrossing.htm">InternetConfirmZoneCrossing</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="InternetErrorDlg.htm">InternetErrorDlg</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>InternetConnect</H1>

<PRE>HINTERNET InternetConnect(
    IN HINTERNET hInternetSession,
    IN LPCSTR lpszServerName,
    IN INTERNET_PORT nServerPort,
    IN LPCSTR lpszUsername,
    IN LPCSTR lpszPassword,
    IN DWORD dwService,
    IN DWORD dwFlags,
    IN DWORD dwContext
);
</PRE>
<P>Opens an FTP, Gopher, or HTTP session for a given site.

<UL><LI>Returns a valid handle to the FTP, Gopher, or HTTP session if the connection is successful, or NULL otherwise. To get extended error information, call
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>GetLastError</A>. An application can also use <A HREF="InternetGetLastResponseInfo.htm#InternetGetLastRespo">InternetGetLastResponseInfo</A> to determine why access to the service was denied.

</UL>
<DL>
<DT><I>hInternetSession</I> </DT><DD>Handle to the current Internet session. The handle must have been returned by a previous call to <A HREF="InternetOpen.htm#InternetOpen">InternetOpen</A>.
</DD><DT><I>lpszServerName</I> </DT><DD>Address of a null-terminated string that contains the host name of an Internet server. Alternately, the string can contain the IP number of the site in ASCII dotted-decimal format (for example, 11.0.1.45).
</DD><DT><I>nServerPort</I> </DT><DD>Number of the TCP/IP port on the server to connect to. Can be one of the values in the following list. These flags set only the port that will be used. The service is set by the value of <I>dwService</I>.
<TABLE>
<TR><TD>INTERNET_DEFAULT_FTP_PORT </TD><TD>Uses the default port for FTP servers (port 21).</TD></TR>
<TR><TD>INTERNET_DEFAULT_GOPHER_PORT </TD><TD>Uses the default port for Gopher servers (port 70).</TD></TR>
<TR><TD>INTERNET_DEFAULT_HTTP_PORT </TD><TD>Uses the default port for HTTP servers (port 80).</TD></TR>
<TR><TD>INTERNET_DEFAULT_HTTPS_PORT </TD><TD>Uses the default port for HTTPS servers (port 443).</TD></TR>
<TR><TD>INTERNET_DEFAULT_SOCKS_PORT </TD><TD>Uses the default port for SOCKS firewall servers (port 1080).</TD></TR>
<TR><TD>INTERNET_INVALID_PORT_NUMBER </TD><TD>Uses the default port for the service specified by <I>dwService</I>.</TD></TR></TABLE>
</DD><DT><I>lpszUsername</I> </DT><DD>Address of a null-terminated string that contains the name of the user to log on. If this parameter is NULL, the function uses an appropriate default, except for HTTP; a NULL parameter in HTTP causes the server to return an error. For the FTP protocol, the default is "anonymous". 
</DD><DT><I>lpszPassword</I> </DT><DD>Address of a null-terminated string that contains the password to use to log on. If both <I>lpszPassword</I> and <I>lpszUsername</I> are NULL, the function uses the default "anonymous" password. In the case of FTP, the default password is the user's e-mail name. If <I>lpszPassword</I> is NULL, but <I>lpszUsername</I> is not NULL, the function uses a blank password. The following table describes the behavior for the four possible settings of <I>lpszUsername</I> and <I>lpszPassword</I>. 

<TABLE>
<TR><TD><B><I>lpszUsername</I>
</B></TD>
<TD><B><I>lpszPassword</I>
</B></TD>
<TD><B>User name sent to FTP server
</B></TD>
<TD><B>Password sent to FTP server
</B></TD>
</TR>
<TR><TD>NULL</TD>
<TD>NULL</TD>
<TD>"anonymous"</TD>
<TD>User's e-mail name</TD>
</TR>
<TR><TD>Non-NULL string</TD>
<TD>NULL</TD>
<TD><I>lpszUsername</I></TD>
<TD>""</TD>
</TR>
<TR><TD>NULL</TD>
<TD>Non-NULL string</TD>
<TD>ERROR</TD>
<TD>ERROR</TD>
</TR>
<TR><TD>Non-NULL string</TD>
<TD>Non-NULL string</TD>
<TD><I>lpszUsername</I></TD>
<TD><I>lpszPassword</I></TD>
</TR>
</TABLE>
</DD><DT><I>dwService</I> </DT><DD>Type of service to access. Can be one of the following values:
<TABLE>
<TR><TD>INTERNET_SERVICE_FTP </TD><TD>FTP service.</TD></TR>
<TR><TD>INTERNET_SERVICE_GOPHER </TD><TD>Gopher service.</TD></TR>
<TR><TD>INTERNET_SERVICE_HTTP </TD><TD>HTTP service.</TD></TR></TABLE>
</DD><DT><I>dwFlags</I> </DT><DD>Flags specific to the service used. When the value of <I>dwService</I> is INTERNET_SERVICE_FTP, <A HREF="../constants/API_Flags.htm#INTERNET_FLAG_PASSIV">INTERNET_FLAG_PASSIVE</A> causes the application to use passive FTP semantics.
</DD><DT><I>dwContext</I>  </DT><DD>Application-defined value that is used to identify the application context for the returned handle in callbacks. 
</DD></DL>
<P>The <B>InternetConnect</B> function is required before communicating with any Internet service. 

<P>Having a connect function for all protocols, even those that do not use persistent connections, lets an application communicate common information about several requests by using a single function call. In addition, this allows for future versions of Internet protocols that do not require a connection to be established for every client request. 

<P>For FTP sites, <B>InternetConnect</B> actually establishes a connection with the server; for others, such as Gopher, the actual connection is not established until the application requests a specific transaction.

<P>For maximum efficiency, applications using the Gopher and HTTP protocols should try to minimize calls to <B>InternetConnect</B> and avoid calling this function for every transaction requested by the user. One way to accomplish this is to keep a small cache of handles returned from <B>InternetConnect</B>; when the user makes a request to a previously accessed server, that session handle is still available.

<P>An application that needs to display multiline text information sent by an FTP server can use <A HREF="InternetGetLastResponseInfo.htm#InternetGetLastRespo">InternetGetLastResponseInfo</A> to retrieve the text.

<P>For FTP connections, if <I>lpszUsername</I> is NULL, <B>InternetConnect</B> sends the string "anonymous" as the user name. If <I>lpszPassword</I> is NULL, <B>InternetConnect</B> attempts to use the user's e-mail name as the password.



<P>To close the handle returned from <B>InternetConnect</B>, the application should call <A HREF="InternetCloseHandle.htm#InternetCloseHandle">InternetCloseHandle</A>. This function disconnects the client from the server and frees all resources associated with the connection.
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>