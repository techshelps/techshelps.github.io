<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>HttpOpenRequest</TITLE>

<META NAME=MS-HKWD CONTENT="HttpOpenRequest">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="HttpOpenRequest"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="HttpOpenRequest"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="HttpOpenRequest"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../reference.htm#ch_wininet">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="HttpEndRequest.htm">HttpEndRequest</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="HttpQueryInfo.htm">HttpQueryInfo</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>HttpOpenRequest</H1>

<PRE>HINTERNET HttpOpenRequest(
    IN HINTERNET hHttpSession,
    IN LPCSTR lpszVerb,
    IN LPCSTR lpszObjectName,
    IN LPCSTR lpszVersion,
    IN LPCSTR lpszReferer,
    IN LPCSTR FAR * lpszAcceptTypes,
    IN DWORD dwFlags,
    IN DWORD dwContext
);
</PRE>
<P>Opens an HTTP request handle.

<UL><LI>Returns a valid (non-NULL) HTTP request handle if successful, or NULL otherwise. To get extended error information, call
<object id="hhal_3" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Further_Reading>
</object><A HREF=JavaScript:hhal_3.Click()>GetLastError</A>.

</UL>
<DL>
<DT><I>hHttpSession</I> </DT><DD>Handle to an HTTP session returned by <A HREF="InternetConnect.htm#InternetConnect">InternetConnect</A>.
</DD><DT><I>lpszVerb</I> </DT><DD>Address of a string that contains the verb to use in the request. If this parameter is NULL, the function uses "GET" as the verb.
</DD><DT><I>lpszObjectName</I> </DT><DD>Address of a string that contains the name of the target object of the specified verb. This is generally a file name, an executable module, or a search specifier.
</DD><DT><I>lpszVersion</I> </DT><DD>Address of a string that contains the HTTP version. If this parameter is NULL, the function uses "HTTP/1.0" as the version.
</DD><DT><I>lpszReferer</I> </DT><DD>Address of a string that specifies the address (URL) of the document from which the URL in the request (<I>lpszObjectName</I>) was obtained. If this parameter is NULL, no "referrer" is specified.
</DD><DT><I>lpszAcceptTypes</I> </DT><DD>Address of a null-terminated array of LPCSTR pointers indicating content types accepted by the client. If this parameter is NULL, no types are accepted by the client. Servers interpret a lack of accept types to indicate that the client accepts only documents of type "text/*" (that is, only text documents, and not pictures or other binary files).
</DD><DT><I>dwFlags</I> </DT><DD>Internet flag values. Can be any of the following values:
<DL>
<DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_CACHE_">INTERNET_FLAG_CACHE_IF_NET_FAIL</A> </DT><DD>Return the resource from the cache if the network request for the resource fails due to an <A HREF="../constants/errors.htm#ERROR_INTERNET_CONNE">ERROR_INTERNET_CONNECTION_RESET</A> or <A HREF="../constants/errors.htm#ERROR_INTERNET_CANNO">ERROR_INTERNET_CANNOT_CONNECT</A>.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_DONT_C">INTERNET_FLAG_DONT_CACHE</A> </DT><DD>Does not add the returned entity to the cache. Identical to the preferred value, <A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NO_CAC">INTERNET_FLAG_NO_CACHE_WRITE</A>.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_HYPERL">INTERNET_FLAG_HYPERLINK</A> </DT><DD>Forces a reload if there was no Expires time and no Last-Modified time returned from the server when determining whether to reload the item from the network.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_IGNORE">INTERNET_FLAG_IGNORE_CERT_CN_INVALID</A> </DT><DD>Disables Win32 Internet function checking of SSL/PCT-based certificates that are returned from the server against the host name given in the request. Win32 Internet functions use a simple check against certificates by comparing for matching host names and simple wildcarding rules.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_IGNORE">INTERNET_FLAG_IGNORE_CERT_DATE_INVALID</A> </DT><DD>Disables Win32 Internet function checking of SSL/PCT-based certificates for proper validity dates. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_IGNORE">INTERNET_FLAG_IGNORE_REDIRECT_TO_HTTP</A> </DT><DD>Disables the ability of the Win32 Internet functions to detect this special type of redirect. When this flag is used, Win32 Internet functions transparently allow redirects from HTTPS to HTTP URLs. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_IGNORE">INTERNET_FLAG_IGNORE_REDIRECT_TO_HTTPS</A> </DT><DD>Disables the ability of the Win32 Internet functions to detect this special type of redirect. When this flag is used, Win32 Internet functions transparently allow redirects from HTTP to HTTPS URLs. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_KEEP_C">INTERNET_FLAG_KEEP_CONNECTION</A> </DT><DD>Uses keep-alive semantics, if available, for the connection. This flag is required for Microsoft Network (MSN), NT LAN Manager (NTLM), and other types of authentication.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_MAKE_P">INTERNET_FLAG_MAKE_PERSISTENT</A> </DT><DD>No longer supported.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_MUST_C">INTERNET_FLAG_MUST_CACHE_REQUEST</A>
</DT><DD>Causes a temporary file to be created if the file cannot be cached. Identical to the preferred value, <A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NEED_F">INTERNET_FLAG_NEED_FILE</A>. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NEED_F">INTERNET_FLAG_NEED_FILE</A> </DT><DD>Causes a temporary file to be created if the file cannot be cached. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NO_AUT">INTERNET_FLAG_NO_AUTH</A> </DT><DD>Does not attempt authentication automatically. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NO_AUT">INTERNET_FLAG_NO_AUTO_REDIRECT</A> </DT><DD>Does not automatically handle redirection in <A HREF="HttpSendRequest.htm#HttpSendRequest">HttpSendRequest</A>. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NO_CAC">INTERNET_FLAG_NO_CACHE_WRITE</A> </DT><DD>Does not add the returned entity to the cache. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NO_COO">INTERNET_FLAG_NO_COOKIES</A> </DT><DD>Does not automatically add cookie headers to requests, and does not automatically add returned cookies to the cookie database. 
<!-- ************************ BRADYA: BEGIN UPDATE ************************ -->
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NO_UI">INTERNET_FLAG_NO_UI</A> </DT><DD>Disables the cookie dialog box.
<!-- ************************ BRADYA: END UPDATE ************************** -->
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_PRAGMA">INTERNET_FLAG_PRAGMA_NOCACHE</A> </DT><DD>Forces the request to be resolved by the origin server, even if a cached copy exists on the proxy. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_READ_P">INTERNET_FLAG_READ_PREFETCH</A>
 </DT><DD>This flag is currently disabled.
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_RELOAD">INTERNET_FLAG_RELOAD</A> </DT><DD>Forces a download of the requested file, object, or directory listing from the origin server, not from the cache. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_RESYNC">INTERNET_FLAG_RESYNCHRONIZE</A> </DT><DD>Reloads HTTP resources if the resource has been modified since the last time it was downloaded. 
</DD><DT><A HREF="../constants/API_Flags.htm#INTERNET_FLAG_SECURE">INTERNET_FLAG_SECURE</A> </DT><DD>Uses SSL/PCT transaction semantics. 
</DD></DL>
</DD><DT><I>dwContext</I> </DT><DD>Application-defined value that associates this operation with any application data.
</DD></DL>
<P><B>HttpOpenRequest</B> creates a new HTTP request handle and stores the specified parameters in that handle. An HTTP request handle holds a request to be sent to an HTTP server and contains all RFC822/MIME/HTTP headers to be sent as part of the request.

<P>Use the <A HREF="InternetCloseHandle.htm#InternetCloseHandle">InternetCloseHandle</A> function to close the handle returned by <B>HttpOpenRequest</B>. <B>InternetCloseHandle</B> cancels all outstanding I/O on the handle.

<P>The <I>lpszReferer</I> parameter to <A HREF="InternetOpen.htm#InternetOpen">InternetOpen</A> is used as the referrer for the HTTP request.

<P>See also <A HREF="HttpAddRequestHeaders.htm#HttpAddRequestHeader">HttpAddRequestHeaders</A>, <A HREF="HttpQueryInfo.htm#HttpQueryInfo">HttpQueryInfo</A>, <A HREF="InternetReadFile.htm#InternetReadFile">InternetReadFile</A>
<!-- ************************ BRADYA: END UPDATE ************************** --><!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>