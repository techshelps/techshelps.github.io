<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INTERNET_STATUS_CALLBACK</TITLE>

<META NAME=MS-HKWD CONTENT="INTERNET_STATUS_CALLBACK">
<META NAME="Keywords" CONTENT="Internet Tools & Technologies">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="INTERNET_STATUS_CALL"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="INTERNET_STATUS_CALLBACK"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="INTERNET_STATUS_CALLBACK"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../reference.htm#ch_wininet">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="datatypes.htm">Data Types</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="../structures/structures.htm">Structures</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>INTERNET_STATUS_CALLBACK</H1>

<PRE>VOID (CALLBACK * INTERNET_STATUS_CALLBACK)(
    IN HINTERNET hInternet,
    IN DWORD dwContext,
    IN DWORD dwInternetStatus,
    IN LPVOID lpvStatusInformation,
    IN DWORD dwStatusInformationLength
);
</PRE>
<P>Type used for an application-defined status callback function.



<DL>
<DT><I>hInternet</I> </DT><DD>Handle for which the callback function is being called.
</DD><DT><I>dwContext</I> </DT><DD>Application-defined context value associated with <I>hInternet</I>.
</DD><DT><I>dwInternetStatus</I> </DT><DD>Status code that indicates why the callback function is being called. Can be one of the following values:
<DL>
<DT>INTERNET_STATUS_CLOSING_CONNECTION </DT><DD>Closing the connection to the server. The <I>lpvStatusInformation</I> parameter is NULL.
</DD><DT>INTERNET_STATUS_CONNECTED_TO_SERVER </DT><DD>Successfully connected to the socket address (SOCKADDR) pointed to by <I>lpvStatusInformation</I>.
</DD><DT>INTERNET_STATUS_CONNECTING_TO_SERVER </DT><DD>Connecting to the socket address (SOCKADDR) pointed to by <I>lpvStatusInformation</I>.
</DD><DT>INTERNET_STATUS_CONNECTION_CLOSED </DT><DD>Successfully closed the connection to the server. The <I>lpvStatusInformation</I> parameter is NULL.
</DD><DT>INTERNET_STATUS_CTL_RESPONSE_RECEIVED </DT><DD>Not currently implemented.
</DD><DT>INTERNET_STATUS_HANDLE_CLOSING </DT><DD>This handle value is now terminated.
</DD><DT>INTERNET_STATUS_HANDLE_CREATED </DT><DD>Used by <A HREF="../functions/InternetConnect.htm#InternetConnect">InternetConnect</A> to indicate it has created the new handle. This lets the application call <A HREF="../functions/InternetCloseHandle.htm#InternetCloseHandle">InternetCloseHandle</A> from another thread, if the connect is taking too long.
<!-- ************************ BRADYA: BEGIN UPDATE ************************ -->
</DD><DT>INTERNET_STATUS_INTERMEDIATE_RESPONSE </DT><DD>Received an intermediate (100 level) status code message from the server.
<!-- ************************ BRADYA: END UPDATE ************************** -->
</DD><DT>INTERNET_STATUS_NAME_RESOLVED </DT><DD>Successfully found the IP address of the name contained in <I>lpvStatusInformation</I>.
</DD><DT>INTERNET_STATUS_PREFETCH </DT><DD>Not currently implemented.
</DD><DT>INTERNET_STATUS_RECEIVING_RESPONSE </DT><DD>Waiting for the server to respond to a request. The <I>lpvStatusInformation</I> parameter is NULL.
</DD><DT>INTERNET_STATUS_REDIRECT </DT><DD>An HTTP request is about to automatically redirect the request. The <I>lpvStatusInformation</I> parameter points to the new URL. At this point, the application can read any data returned by the server with the redirect response, and can query the response headers. It can also cancel the operation by closing the handle. This callback is not made if the original request specified <A HREF="../constants/API_Flags.htm#INTERNET_FLAG_NO_AUT">INTERNET_FLAG_NO_AUTO_REDIRECT</A>.
</DD><DT>INTERNET_STATUS_REQUEST_COMPLETE </DT><DD>An asynchronous operation has been completed. See <A HREF="../functions/InternetOpen.htm#InternetOpen">InternetOpen</A> for details on <A HREF="../constants/API_Flags.htm#INTERNET_FLAG_ASYNC">INTERNET_FLAG_ASYNC</A>.
</DD><DT>INTERNET_STATUS_REQUEST_SENT </DT><DD>Successfully sent the information request to the server. The <I>lpvStatusInformation</I> parameter points to a DWORD containing the number of bytes sent.
</DD><DT>INTERNET_STATUS_RESOLVING_NAME </DT><DD>Looking up the IP address of the name contained in <I>lpvStatusInformation</I>.
</DD><DT>INTERNET_STATUS_RESPONSE_RECEIVED </DT><DD>Successfully received a response from the server. The <I>lpvStatusInformation</I> parameter points to a DWORD containing the number of bytes received.
</DD><DT>INTERNET_STATUS_SENDING_REQUEST </DT><DD>Sending the information request to the server. The <I>lpvStatusInformation</I> parameter is NULL.
</DD><DT>INTERNET_STATUS_STATE_CHANGE </DT><DD>Moved between a secure (HTTPS) and a nonsecure (HTTP) site. Can be one of the following values:
<TABLE>
<TR><TD>INTERNET_STATE_ONLINE </TD><TD>Online state (mutually exclusive with offline).</TD></TR>
<TR><TD>INTERNET_STATE_OFFLINE </TD><TD>Offline because no network connection could be established. </TD></TR>
<TR><TD>INTERNET_STATE_OFFLINE_USER </TD><TD>Offline by user request.</TD></TR>
<TR><TD>INTERNET_STATE_IDLE </TD><TD>No network requests are being made by WinInet.</TD></TR>
<TR><TD>INTERNET_STATE_BUSY </TD><TD>Network requests are being made by WinInet. </TD></TR></TABLE>
</DD></DL>
</DD><DT><I>lpvStatusInformation</I> </DT><DD>Address of a buffer that contains information pertinent to this call to the callback function.
</DD><DT><I>dwStatusInformationLength</I> </DT><DD>Size of the <I>lpvStatusInformation</I> buffer.
</DD></DL>
<P>The <I>lpvStatusInformation</I> parameter points to an <A HREF="../structures/INTERNET_ASYNC_RESULT.htm#INTERNET_ASYNC_RESUL">INTERNET_ASYNC_RESULT</A> structure. The <I>dwStatusInformationLength</I> parameter contains the final completion status of the asynchronous function. If this is <A HREF="../constants/errors.htm#ERROR_INTERNET_EXTEN">ERROR_INTERNET_EXTENDED_ERROR</A>, the application can retrieve the server error information by using <A HREF="../functions/InternetGetLastResponseInfo.htm#InternetGetLastRespo">InternetGetLastResponseInfo</A>.

<P>In the case of INTERNET_STATUS_REQUEST_COMPLETE, <I>lpvStatusInformation</I> is the address of an <A HREF="../structures/INTERNET_ASYNC_RESULT.htm#INTERNET_ASYNC_RESUL">INTERNET_ASYNC_RESULT</A> structure.

<P>An application uses the callback function to indicate the progress of synchronous and asynchronous functions, and to indicate the completion of an asynchronous request.

<P>Because callbacks are made during processing of the request, the application should spend as little time as possible in the callback function to avoid degrading data throughput on the network. For example, displaying a dialog box in a callback function may be such a lengthy operation that the server terminates the request.

<P>The callback function can be called in a thread context different from the thread that initiated the request.
<!-- ************************ BRADYA: END UPDATE ************************** --><!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>