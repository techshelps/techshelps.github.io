<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How to Automatically Update an ActiveX Control</TITLE>

<META NAME=MS-HKWD CONTENT="How to Automatically Update an ActiveX Control">
<META NAME="Keywords" CONTENT="OSD, Open Software Description, Software Update Channels, Example, Sample">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="activex_example"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="How to Automatically Update an ActiveX Control"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbard.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="How to Automatically Update an ActiveX Control"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" ID="TOPIC_CONTENTS" HREF="overview.htm">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" ID="PRE_TOPIC" HREF="auto_update.htm">Automatically Updating ActiveX Controls</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" ID="NEXT_TOPIC" HREF="osdlang.htm">Setting Language Dependency Using OSD</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<h1>How to Automatically Update an ActiveX Control</h1>


<ol>
  <li>Create an \osd\GenericSample share off the root directory of your Web server. If you are using the Personal Web Server on your local computer, create a directory (\osd) under the \Webshare\Wwwroot directory and then create a subdirectory (\GenericSample) under the \osd directory. </li>
  <li>Copy the contents of the \samples\osd\GenericSample directory of the Internet Client SDK refresh package into the share.</li>
  <li>Update the <b>HREF</b> attribute of the  <a href="../../../delivery/references/channels/CHANNEL.htm">CHANNEL</a> element in circ3_orig.cdf, circ3_adv.cdf, and circ3_pc.cdf by replacing &lt;your server> with the name of your actual server.
  <li>Copy the updated version of circ3_orig.cdf as circ3.cdf in the same share.</li>
  <li>Open Microsoft&#174; Internet Explorer 4.01 or later and browse to circ3.htm (which
    will install the Circle ActiveX&#153; Control version 1).</li>
  <li>Subscribe to circ3.cdf by clicking the <img src="../../../art/ch_chbtn.gif" alt="addchannel.gif (1685 bytes)" WIDTH="136" HEIGHT="20"> link.</li> 
<ul>
<li>If you are subscribing a user to an automatic subscription, it is important to obtain
    the user's consent first.</li>
<li>Click Customize  to configure Internet Explorer to either send an e-mail notification upon new software availability, or choose a custom schedule to tell Internet Explorer when to check for new software. You can set schedules in the CDF file with the SCHEDULE tag under <B>CHANNEL</B>.</li> 
<li>The circ3.cdf file has a tag that specifies it should be displayed in Internet Explorer under the Favorites/Software Updates folder.</li>
</ul>
</ol>

<p>Now assume you have a new build, build 2, of Circle ready to roll out. You want to automatically upgrade all build 1 users as soon as they hit any page that uses the Circle control. 

<p><b>Note</b> This can also be used for a new version, but the control used in this example had only two builds of the same version available.

<ol>
<li>Copy circ3_pc.cdf on top of circ3.cdf. (Alternatively, use circ3_adv.cdf instead of circ3_pc.cdf if you don't want to automatically preload the user's cache with the bits. Preload does not mean    autoinstall; Microsoft Internet Explorer just caches the new bits so the user can later install the control <em>faster and even while offline</em>). The new CDF advertises version 2 of the Circle control.
<p><b>Note</b> To run this demonstration again, you must copy circ3_orig.cdf back on top of circ3.cdf. You will also have to copy circ3_v1.cab on top of circ3.cab.</li>
<li>Copy circ3_v2.cab on top of circ3.cab. This is exactly the same as the real-life situation where the external world sees only circ3.cab but you have circ3_v1.cab (version 1) and circ3_v2.cab    (version 2). When you update to version 2, you don't want version 1 available anymore, so you copy circ3_v2.cab over circ3.cab, the external distribution cabinet file.</li>
<li>On the client computer, first make sure that the zone you are in is set for Custom. Under ActiveX Controls And Plugins/Download Unsigned ActiveX Controls, select Enable. Note that this is needed only for the demonstration file because the CABs are not signed; if they were signed, this would not be needed. Then select Favorites/Update All Subscriptions, or right-click  the Circle channel (under Favorites/Software Updates) and select Update Now. Note that if the CDF had set an automatic schedule, this update would have happened automatically like any other    subscription in Internet Explorer.</li>
<li>The Circle channel icon will gleam (red gleam on upper-left corner of the icon). If you set up the e-mail notification during subscription, you will receive an e-mail notifying you of the updated software. When the user clicks the Circle channel, Internet Explorer will navigate to the home page of the channel. This page has instructions on how to download/install the new version of Circle (in this case just a link to an HTML page with the <B>OBJECT</B>  element for the new version of Circle). </li>
<li>Alternately, if you return to view circ3.htm (or any page that uses the Circle ActiveX Control version 1), the client will be automatically upgraded to version 2 because Internet Explorer knows that version 2 is available. In this simple example, note that the only way to see the version difference between the two Circle controls is to view the properties on the Circle control in the Downloaded Program Files directory.</li>
</ol>
<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>