<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Dynamic HTML with Active Channels</TITLE>

<META NAME=MS-HKWD CONTENT="Using Dynamic HTML with Active Channels">
<META NAME="Keywords" CONTENT="Active Channels, Active Desktop items, Software Update Channels">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="sec_channel_hide"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Using Dynamic HTML with Active Channels"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbarb.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Using Dynamic HTML with Active Channels"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../active_channels.htm#ch_channels">Topic Contents</A>

</PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="images.htm">Guidelines for Active Channel Logo Images</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="netcaster.htm">Netcaster CDF Compatibility Notes</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Using Dynamic HTML with Active Channels</H1>

<P>A variety of Dynamic HTML features can be used to modify the appearance of a Web page, including changing the text or images that are displayed. As an example, the following steps show how a publisher might use the window.external.<A HREF="../../../dhtml/references/methods/isSubscribed.htm#isSubscribed">isSubscribed</A> method to hide an Add Active Channel logo button if its associated channel is already subscribed.

<P>Assuming the Add Active Channel button was placed on a Web page as <A HREF="development.htm#sec_channel_link">previously described</A>, the page would include the following Add Active Channel button:

<PRE>&lt;a name="channelA"
href="http://www.microsoft.com/ie/ie40/download/?/ie/ie40/download/redirect.htm"&gt;
&lt;img src="IEAddChannel.gif" border=0 width=136 height=20&gt;&lt;/a&gt;
&lt;script language="JavaScript"&gt; 
    if ( isMsie4orGreater()) { channelA.href ="urlToCDF"; }
&lt;/script&gt; 

</PRE>

<P><B>Step 1.</B> Add the ID attribute to the anchor element. The value must be unique.

<PRE>&lt;a name="channelA" id="idA"
href="http://www.microsoft.com/ie/ie40/download/?/ie/ie40/download/redirect.htm"&gt;
&lt;img src="IEAddChannel.gif" border=0 width=136 height=20&gt;&lt;/a&gt;
&lt;script language="JavaScript"&gt; 
    if ( isMsie4orGreater()) { channelA.href ="urlToCDF"; }
&lt;/script&gt;

</PRE>

<P><B>Step 2.</B> Include the following script between the page's &lt;HEAD&gt; and &lt;/HEAD&gt; tags. Note that the isMsie4orGreater function should already exist in the HEAD section of this page. 

<PRE>&lt;SCRIPT LANGUAGE="JavaScript"&gt;
function HideIfSubscribed(elementID, urlToCDF){
if (window.external.isSubscribed(urlToCDF)) {ss.addRule("#"+ elementID,"visibility: hidden");}}

var ss = null;
ss = document.createStyleSheet()
if(isMsie4orGreater()){ //Test if the browser is IE
// For each element you want to conditionally hide, include the following line
// (uniqueID is the unique value for the ID attribute of the element and
// urlToCDF is the URL to the channel's CDF).
HideIfSubscribed("uniqueID","urlToCDF");
}
&lt;/SCRIPT&gt;

</PRE>

<P>When using these scripts, remember that the URLs of the channels must include the same protocol and secondary domain name as the page that contains the scripts. Also, any element in Dynamic HTML that has the visibility property can be hidden using the same code. 

<P>The following HTML page shows a full example of the scripting shown above.
<PRE>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;SCRIPT LANGUAGE="JavaScript"&gt;
    function isMsie4orGreater() { 
        var ua = window.navigator.userAgent;   var msie = ua.indexOf ( "MSIE " );
        if  (msie &gt; 0)
            {return (parseInt ( ua.substring ( msie+5, ua.indexOf ( ".", msie ) ) ) &gt;=4)
			&amp;&amp; (ua.indexOf("MSIE 4.0b") &lt;0) ;}
        else    {return false;}}

    function HideIfSubscribed(elementID, urlToCDF){
        if (window.external.isSubscribed(urlToCDF))
		{ss.addRule("#"+ elementID,"visibility: hidden");}}

    var ss = null;
    if(isMsie4orGreater()){ //Test if the browser is IE
        ss = document.createStyleSheet()
        HideIfSubscribed("idA","http://www.mycorp.com/channelA.cdf");
    }
&lt;/SCRIPT&gt;
&lt;/HEAD&gt;

&lt;BODY&gt;
&lt;a name="channelA" id="idA"
href="http://www.microsoft.com/ie/ie40/download/?/ie/ie40/download/redirect.htm"&gt;
&lt;img src="IEAddChannel.gif" border=0 width=136 height=20&gt;&lt;/a&gt;
&lt;script language="JavaScript"&gt; 
    if ( isMsie4orGreater()) { channelA.href ="urlToCDF"; }
&lt;/script&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;

</PRE>

<P>If the Web page contains more than one Add Active Channel or Add to Active Desktop logo button, the name and ID attributes must be unique.

<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>