<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Developing an Active Channel</TITLE>

<META NAME=MS-HKWD CONTENT="Developing an Active Channel">
<META NAME="Keywords" CONTENT="Active Channels, Active Desktop items, Software Update Channels">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="sec_channel_developing"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Developing an Active Channel"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../../art/headbarb.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Developing an Active Channel"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../active_channels.htm#ch_channels">Topic Contents</A>

</PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="features.htm">Active Channel Features</A>
<IMG SRC="../../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="optimization.htm">Optimizing Active Channels over HTTP</A></PRE></TD></TR>
</TABLE>
<!-- NAV_LINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Developing an Active Channel</H1>

<P>To create an Active Channel on an existing Web site, simply create a CDF file by following these steps:
<OL>
<LI><A HREF="development.htm#sec_channel_design">Design the channel.</A>
<LI><A HREF="development.htm#sec_channel_logo_create">Create the logo images.</A>
<LI><A HREF="development.htm#sec_channel_cdf_create">Create the CDF file.</A>
<LI><A HREF="development.htm#sec_channel_post">Post the CDF file.</A>
<LI><A HREF="development.htm#sec_channel_link">Offer the new channel to users.</A>
</OL>

<H2><A NAME="sec_channel_design">Design the Active Channel</A></H2>

<P>When creating a CDF file, the first step is to determine the structure of the channel. The channel can be designed to represent the structure of an existing Web site, or it can be a subset of a Web site's content with a completely different hierarchy. The structure of the channel is created in the CDF file with the use of the <A HREF="../../references/channels/CHANNEL.htm#CHANNEL">CHANNEL</A> and <A HREF="../../references/channels/ITEM.htm#ITEM">ITEM</A> elements to represent the subchannel hierarchy and HTML items (content). To prevent users from being overwhelmed with information and images, as well as to provide a uniform "look and feel" among channels, keep the following guidelines in mind:
<UL>
<LI>A channel should have no more than eight total subitems in the first level. <LI>Web publishers should provide all the images to be used with their channel. Images are needed for the desktop Channel Bar, Channels Explorer Bar, and items in the channel.
<LI>Design the channel to be one of the recommended <A HREF="types.htm#sec_channel_types">Active Channel Types</A>.
</UL>

<H2><A NAME="sec_channel_logo_create">Create the Logo Images</A></H2>

<P>There are several places in the user interface where images associated with an Active Channel are displayed: 
<UL>
<LI>Desktop Channel Bar (32H x 80W)
<LI>Channel Pane Explorer Bar in the browser (32H x 194W)
<LI>Icons for items within categories (16H x 16W)
</UL>

<P>When creating a channel, Web publishers should provide appropriate images for each of these categories, although Microsoft will provide default images wherever necessary. The top-level <A HREF="../../references/channels/CHANNEL.htm#CHANNEL">CHANNEL</A> element should include three <A HREF="../../references/channels/LOGO.htm#LOGO">LOGO</A> child elements, one for each type of <B>STYLE</B> attribute, as follows:

<PRE>
&lt;CHANNEL HREF="http://www.mysample.com/mainchannel.htm"&gt;
    &lt;LOGO HREF="http://www.mysample.com/widelogo.gif" STYLE="IMAGE-WIDE"/&gt;
	    &lt;!-- For Channels Explorer Bar --&gt;
    &lt;LOGO HREF="http://www.mysample.com/logo.gif" STYLE="IMAGE"/&gt;
	    &lt;!-- For desktop Channel Bar --&gt;
    &lt;LOGO HREF="http://www.mysample.com/icon.gif" STYLE="ICON"/&gt;
	    &lt;!-- For category folder --&gt;
    &lt;subitems omitted&gt;
    .
    .
    .
&lt;/CHANNEL&gt;

</PRE>

<P>The STYLE="ICON" attribute is included in case the user places an Active Channel in a category folder. When this occurs, the channel will appear in the list of available channels in the Channels Explorer Bar when that channel folder group is selected. All other <A HREF="../../references/channels/CHANNEL.htm#CHANNEL">CHANNEL</A> and <A HREF="../../references/channels/ITEM.htm#ITEM">ITEM</A> elements in the CDF file should include only one <A HREF="../../references/channels/LOGO.htm#LOGO">LOGO</A> child element with the STYLE="ICON" attribute. When creating your image files, be sure to make the background color transparent, if applicable. It's also recommended that your image be fairly simple so that it's easy to recognize at the 16H x 16W size. Additional information about image specifications is available in the <A HREF="images.htm#sec_channel_images">Guidelines for Active Channel Images</A>.



<H2><A NAME="sec_channel_cdf_create">Create the CDF file</A></H2>

<P>When the channel structure has been designed and the logos have been created, the CDF file can be written. The CDF file must include at least one <A HREF="../../references/channels/CHANNEL.htm#CHANNEL">CHANNEL</A> element and should include the <A HREF="../../references/channels/SCHEDULE.htm#SCHEDULE">SCHEDULE</A> and <A HREF="../../references/channels/LOGO.htm#LOGO">LOGO</A> elements. The <A HREF="../../references/channels/ITEM.htm#ITEM">ITEM</A> element must be used to include any Web pages as part of the channel's content. As the content contained in the channel is added, removed, or modified over time, Web publishers should update the CDF file to reflect the changes. For information about using a channel creation tool, see <A HREF="../../../cdfgen/cdfgen.htm">Microsoft CDF Generator</A>.

<P>The <A HREF="../../references/channels/CHANNEL.htm#CHANNEL">CHANNEL</A> element is used to define the top-level channel itself, along with any subitems nested within that channel. Thus, the occurrence of the &lt;CHANNEL&gt; and &lt;/CHANNEL&gt; tags defines the hierarchy of the channel. The <A HREF="../../references/channels/LOGO.htm#LOGO">LOGO</A> element is used to specify an image file that is displayed in the desktop Channel Bar. 

<H2><A NAME="sec_channel_post">Post the CDF file</A></H2>

<P>After creating the CDF file, it should be posted on the Web site it describes. Typically, the file would be placed in a public folder on the Web site's HTTP server.

<H2><A NAME="sec_channel_link">Offer the New Channel to Users</A></H2>

<P>Finally, Web publishers need to provide a method for users to install their Active Channel (or Active Desktop item). Users will be able to add channels from three primary sources:

<UL>
<LI>A button image placed on a Web page.
<LI>The Channel Guide.
<LI>The pre-installed set of channels in the Channel Bar.
</UL>

<P>Although a simple HREF in an anchor (&lt;A&gt;) element pointing to a CDF file will initiate the channel subscription process, your page should include the Add Active Channel or Add to Active Desktop logo button for consistency and maximum usability. These buttons should have scripts associated with them that, when clicked, perform the proper behavior in any browser. When using the scripts in the following example, clicking the button with Microsoft&#174; Internet Explorer 4.0  displays the Add Channel dialog box by linking to the CDF file. If users without Internet Explorer 4.0 click the button, they will be directed to download the new version. 

<P><B>Note</B>  To use the Microsoft Add Active Channel button logo image or the Add to Active Desktop button logo image, you must sign up and accept the terms of the Active Channel Logo Agreement at <A HREF="http://www.microsoft.com/sbnmember/ielogo/default.asp" TARGET="_top">http://www.microsoft.com/sbnmember/ielogo/default.asp</A>.

<P>Follow these steps to add the logos and scripts to your HTML page.

<P><B>Step 1.</B> Place these logo image buttons on your Web server. 

<P><IMG SRC="../../../art/ch_chbtn.gif" WIDTH="136" HEIGHT="20" ALT="Add Active Channel">

<P>Use this image to allow users to install your Active Channel.

<P><IMG SRC="../../../art/ch_adbtn.gif" WIDTH="136" HEIGHT="20" ALT="Add to Active Desktop">

<P>Use this image to allow users to add your item to their Active Desktop.

<P>Web publishers are encouraged to use these official Internet Explorer button logo images to provide users with a more visible, consistent, and easily recognizable method for adding Active Channels and Active Desktop items.

<P><B>Step 2.</B> Using Notepad or your favorite HTML editor, open the HTML page that will contain these logos.

<P><B>Step 3.</B> Copy and paste the following script between the &lt;HEAD&gt; and &lt;/HEAD&gt; tags in the HTML page you are editing:
<PRE>
&lt;!-- Begin Put this script into the head of the page --&gt;
&lt;script language="JavaScript"&gt;
    function isMsie4orGreater() { 
    var ua = window.navigator.userAgent;   var msie = ua.indexOf ( "MSIE " );
    if  (msie &gt; 0)
        {return (parseInt ( ua.substring ( msie+5, ua.indexOf ( ".", msie ) ) ) &gt;=4) &amp;&amp; 
        (ua.indexOf("MSIE 4.0b") &lt;0) ;}
    else {return false;}}
&lt;/script&gt;
&lt;!-- End   Put this script into the head of the page --&gt;

</PRE>

<P><B>Step 4.</B> For each individual Add logo included on the HTML page, copy and paste the following lines of HTML:

<PRE>&lt;a name="uniqueName" 
href="http://www.microsoft.com/ie/ie40/download/?/ie/ie40/download/redirect.htm"&gt; 
&lt;img src="urlOfLogoImage" border=0 width=136 height=20&gt;&lt;/a&gt;
&lt;script language="JavaScript"&gt;
    if ( isMsie4orGreater()) { uniqueName.href ="urlToCDF"; }
&lt;/script&gt;

</PRE>

<P>Edit the above script by making the following changes:

<UL>
<LI>Replace each occurrence of <I>uniqueName</I> with a unique name for each logo placed on the page. The unique name for each logo must not contain any spaces. 

<LI>Include the actual URL of the button image on your server in place of <I>urlOfLogoImage</I>. This should be one of the GIF files shown in Step 1.
<LI>Include the actual URL of the CDF file on your server in place of <I>urlToCDF</I>. This can be any URL that returns a CDF file, such as ASP or CGI pages.
</UL>

<P><B>Tip</B>  Web publishers might also want to use <A HREF="dhtml.htm#sec_channel_hide">Dynamic HTML</A> to conditionally display or hide content based on whether the user has a subscription to their Active Channel.
<H3><A NAME="sec_channel_changuide">The channel guide</A></H3>

<P>Web publishers can include their Active Channels in the Internet Explorer 4.0 channel guide. This acts as a primary resource for users to find channels that match their interests. The channel guide provides users with several channel listings that are separated into the following categories: 

<UL>
<LI>Business
<LI>Entertainment
<LI>Lifestyle and Travel
<LI>News and Technology 
<LI>Sports 
</UL>

<P>Microsoft Active Channel partners will be listed in the guide with a 32H x 80W GIF logo image. All other channels will be listed in the guide with the channel's title only. When a user places the mouse pointer over the publisher's logo or title, a ToolTip appears with the channel's description. When the user clicks the channel title or logo in the channel guide, a "Preview Page" is displayed. This page is a 365H x 460W-pixel HTML page located on the publisher's server that acts as an advertisement for all of the publisher's Webcasting offerings. The use of Dynamic HTML is strongly encouraged on this page to make the experience more interactive and engaging for the user. Similar to the "Webcasting Offerings Page" described above, the Preview Page should contain the official button and script for each Active Channel or Active Desktop item offered by the Web publisher. The logo image (where applicable), channel description, and Preview Page URL must be provided to Microsoft by the publisher to be placed in the Internet Explorer channel guide. For more information about placing your channel in the Internet Explorer 4.0 channel guide, see the Microsoft SiteBuilder Network Web site at <A HREF="http://www.microsoft.com/sitebuilder/" TARGET="_top">http://www.microsoft.com/sitebuilder</A>, or look in the channel guide itself.

<H2><A NAME="sec_channel_cdf_sample">CDF Sample and Explanation</A></H2>

<P>The following sample CDF file shows the syntax used in the CDF, with detailed explanations in the next section. This sample is included in the \samples\channel directory, which is installed in the c:\inetsdk directory by default. To subscribe to the sample channel, follow the instructions provided in the Readme.txt file located in that directory. To subscribe to a channel on a Web page, simply click one of the channel logos in the desktop Channel Bar, or click on the Channel Guide to find a list of additional channels. To subscribe to the Internet Client SDK channel, use Internet Explorer 4.0 to navigate to http://www.microsoft.com/msdn/sdk/inetsdk/help/default.htm, and click the Add Active Channel button. Following is the sample CDF file included in the SDK.

<PRE>
&lt;?XML version="1.0"?&gt;
&lt;CHANNEL HREF="http://www.mysite.com/Channel/homepage.htm"
     BASE="http://www.mysite.com/Channel/"&gt;
    &lt;TITLE&gt;Sample "Color" Channel&lt;/TITLE&gt;
    &lt;ABSTRACT&gt;The sample color channel contains a red, green, and blue page for viewing.&lt;/ABSTRACT&gt;
    &lt;LOGO HREF="logo_big.gif" STYLE="IMAGE-WIDE"/&gt;
    &lt;LOGO HREF="logo_med.gif" STYLE="IMAGE"/&gt;
    &lt;SCHEDULE STARTDATE="1997-09-23"&gt;
        &lt;INTERVALTIME DAY="1" /&gt;
        &lt;EARLIESTTIME HOUR="2" /&gt;
        &lt;LATESTTIME HOUR="6" /&gt;
    &lt;/SCHEDULE&gt;
       &lt;ITEM HREF="page1.htm"&gt;
        &lt;LOGO HREF="red.gif" STYLE="ICON"/&gt;
        &lt;TITLE&gt;The Red Page&lt;/TITLE&gt;
        &lt;ABSTRACT&gt;This is the abstract description for the red page.&lt;/ABSTRACT&gt;
    &lt;/ITEM&gt;
    &lt;ITEM HREF="page2.htm"&gt;
        &lt;LOGO HREF="green.gif" STYLE="ICON"/&gt;
         &lt;TITLE&gt;The Green Page&lt;/TITLE&gt;
        &lt;ABSTRACT&gt;This is the abstract description for the green page.&lt;/ABSTRACT&gt;
       &lt;/ITEM&gt;
    &lt;ITEM HREF="page3.htm"&gt;
        &lt;LOGO HREF="blue.gif" STYLE="ICON"/&gt;
        &lt;TITLE&gt;The Blue Page&lt;/TITLE&gt;
        &lt;ABSTRACT&gt;This is the abstract description for the blue page.&lt;/ABSTRACT&gt;
    &lt;/ITEM&gt;
    &lt;ITEM HREF="scrnsave.htm"&gt;
        &lt;USAGE VALUE="ScreenSaver"&gt;&lt;/USAGE&gt;
    &lt;/ITEM&gt;
&lt;/CHANNEL&gt;
</PRE>

<P>The following section lists portions of the CDF example file and then describes the function of the elements and their associated attributes. Where possible, the effect on the user is also indicated.

<PRE>&lt;CHANNEL HREF="http://www.mysite.com/Channel/homepage.htm"
     BASE="http://www.mysite.com/Channel/"&gt;

</PRE>

<P>In this case, the <A HREF="../../references/channels/CHANNEL.htm#CHANNEL">CHANNEL</A> element defines the top-level channel of the hierarchy. Every element that follows until the matching &lt;/CHANNEL&gt; element is subordinate to this channel. The <B>HREF</B> attribute defines the Web page to be displayed in the browser when the channel is selected either in the desktop Channel Bar or in the Channels Explorer Bar. The <B>BASE</B> attribute defines the URL of the location where the channel's resources exist. This allows Web publishers to specify other URLs in the CDF file using relative paths.

<PRE>&lt;TITLE&gt;Sample "Color" Channel&lt;/TITLE&gt;
&lt;ABSTRACT&gt;The sample color channel contains a red, green, and blue page for viewing.&lt;/ABSTRACT&gt;

</PRE>

<P>The <A HREF="../../references/channels/TITLE.htm#TITLE">TITLE</A> element defines the text that is associated with this channel in the browser's channel pane. The <A HREF="../../references/channels/ABSTRACT.htm#ABSTRACT">ABSTRACT</A> element defines a text string that is displayed in a ToolTip when the cursor is placed over the channel.

<PRE>&lt;LOGO HREF="logo_big.gif" STYLE="IMAGE-WIDE"/&gt;
&lt;LOGO HREF="logo_med.gif" STYLE="IMAGE"/&gt;

</PRE>

<P>The <A HREF="../../references/channels/LOGO.htm#LOGO">LOGO</A> element marked with the "IMAGE-WIDE" style attribute is displayed in the Channels Explorer Bar, while the "IMAGE" style is shown in the desktop Channel Bar. Clicking this image results in opening the URL specified in the top-level <A HREF="../../references/channels/CHANNEL.htm#CHANNEL">CHANNEL</A> element, or the channel hierarchy is shown, if applicable.

<PRE>&lt;SCHEDULE STARTDATE="1997-09-23" STOPDATE="1997-11-23"&gt;
    &lt;INTERVALTIME DAY="1" /&gt;
    &lt;EARLIESTTIME HOUR="2" /&gt;
    &lt;LATESTTIME HOUR="6" /&gt;
&lt;/SCHEDULE&gt;

</PRE>

<P>The <A HREF="../../references/channels/SCHEDULE.htm#SCHEDULE">SCHEDULE</A> element indicates how often, and during what time range, the channel should be updated. This is designed to help Web sites manage their server traffic. The preceding example is set to update the channel every day between 2 A.M. and 6 A.M. This schedule information is set to expire on November 23, 1997.

<PRE>&lt;ITEM HREF="page1.htm"&gt;
    &lt;LOGO HREF="red.gif" STYLE="ICON"/&gt;
    &lt;TITLE&gt;The Red Page&lt;/TITLE&gt;
    &lt;ABSTRACT&gt;This is the abstract description for the red page.&lt;/ABSTRACT&gt;
&lt;/ITEM&gt;

</PRE>

<P>The <A HREF="../../references/channels/ITEM.htm#ITEM">ITEM</A> element defines a Web page as a subitem in the sample CDF channel. This item will be displayed in the channel's hierarchy exposed in the Channels Explorer Bar, along with the "ICON" image specified in the <A HREF="../../references/channels/LOGO.htm#LOGO">LOGO</A> element. 

<PRE>&lt;ITEM HREF="scrnsave.htm"&gt;
    &lt;USAGE VALUE="ScreenSaver"&gt;&lt;/USAGE&gt;
&lt;/ITEM&gt;

</PRE>

<P>This occurrence of the <A HREF="../../references/channels/ITEM.htm#ITEM">ITEM</A> element (along with <A HREF="../../references/channels/USAGE.htm#USAGE">USAGE</A>) defines the URL of an HTML page to be displayed in the Channel Screen Saver page. The ITEM and USAGE elements can also be used to define an HTML page as an Active Desktop item. These items can contain any valid HTML elements, such as images, ActiveX&#153; Controls, Java applets, and so on, and can be placed directly on the desktop with Internet Explorer 4.0. For more information on Active Desktop items, review the documentation for <A HREF="../desktop_items.htm#ch_ad_components">Creating Items for the Active Desktop</A>.

<PRE>&lt;/Channel&gt;

</PRE>

<P>This end tag indicates that the definition of the sample CDF channel is complete.

<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>