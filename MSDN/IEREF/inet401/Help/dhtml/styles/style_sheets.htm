<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Managing Style Sheets</TITLE>

<META NAME=MS-HKWD CONTENT="Managing Style Sheets">
<META NAME="Keywords" CONTENT="Dynamic HTML, DHTML, IE4, Internet Explorer 4.0">
<META NAME="Platform" CONTENT="Windows, Win95, WinNT, Mac">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">


<SCRIPT>
//<!--
var g_isIE = false, g_isNav = false, g_iMaj = 0, g_sPlat = "";
// -->
</SCRIPT>
<SCRIPT SRC="../../code/ver.js"></SCRIPT>


<SCRIPT DEFER SRC="../../code/common.js"></SCRIPT>
<SCRIPT DEFER>
//<!--
function InitPage()
{
	if (g_isIE && g_iMaj >= 4)	
	{
		SetTOC();
	}
}
//-->
</SCRIPT>

<LINK REL="stylesheet" HREF="/msdn/sdk/inetsdk/help/basicsdkIE4.css" TYPE="text/css">
<!-- STYLE_START -->


<SCRIPT>
//<!--
   var sVR = '../../'	// Set root for the style sheet
   var sCSS = '<LINK REL="stylesheet" HREF="' + sVR;

   if(g_isIE)
   {
	   if (g_iMaj >= 4) // For MSIE 4.0 or later
	   {
		   sCSS += 'basicSDKIE4';
		   if (g_sPlat == "Win") // Windows only for now
		   {
			   document.createStyleSheet(sVR + 'advSDKIE4.css');
		   }
	   }
	   else // For MSIE 3.0 or earlier
	   {
		   sCSS += 'basicSDKIE3';
	   }
   }
   else if (g_isNav) // For all Nav versions
   {
	   sCSS += 'basicSDKNAV';
   }
   else
   {
	   sCSS += 'basicSDKIE3'; // default to IE3 sheet
   }

   sCSS += (sCSS == '' ? '' : '.css" TYPE="text/css">');

   document.write(sCSS);
//-->
</SCRIPT>
<!-- STYLE_END -->
</HEAD>
<BODY onload="InitPage()" BGCOLOR="#FFFFFF">

<A NAME="pagetop"></A><A NAME="dhtml_managing"></A>
<!-- NAV_LINKS_START -->
<TABLE class=main BORDER=0 CELLSPACING="0" CELLPADDING="0" WIDTH="10%"><TR><TD ROWSPAN="3" VALIGN="TOP" WIDTH="121"><IMG SRC="../../art/headbar2.gif" WIDTH="121" HEIGHT="82" BORDER=0 ALT="Managing Style Sheets"></TD><TD ROWSPAN="2" VALIGN="TOP" WIDTH="186"><IMG SRC="../../art/headbara.gif" WIDTH="186" HEIGHT="44" BORDER=0 ALT="Managing Style Sheets"></TD><TD VALIGN="TOP" WIDTH="470"><IMG SRC="../../art/replace1.gif" WIDTH="470" HEIGHT="17" BORDER=0 ALT="*"></TD></TR>
<TR><TD><PRE><IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_1" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Contents>
</object><A STYLE="color:black" ID=TOC HREF=JavaScript:hhal_1.Click()>Contents</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><object id="hhal_2" type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Item1" value="">
<PARAM name="Item2" value=_win32_Index_1sz1>
</object><A STYLE="color:black" HREF=JavaScript:hhal_2.Click()>Index</A>  <IMG SRC="../../art/arrowrht.gif" WIDTH="14" HEIGHT="14" ALIGN="MIDDLE" BORDER=0 ALT="*"><A STYLE="color:black" HREF="../dhtml.htm">Topic Contents</A></PRE></TD></TR>
<TR><TD COLSPAN="2"><PRE><IMG SRC="../../art/arrowlft.gif" WIDTH="17" HEIGHT="15" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Previous Topic:</B> <A STYLE="color:black" HREF="changing.htm">Changing Element Styles</A>
<IMG SRC="../../art/arrownxt.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER=0 ALT="*"><B>Next Topic:</B> <A  STYLE="color:black" HREF="printing.htm">Style Sheets and Printing</A></PRE></TD></TR>
</TABLE>
<!-- NAVLINKS_END -->
<BLOCKQUOTE class="body">
<!-- CONTENTS_START -->
<H1>Managing Style Sheets</H1>
<BR CLEAR=ALL>
<P>Dynamically changing cascading style sheet (CSS) styles that are applied to documents is not limited to the inline styles (styles defined with the <A HREF="../references/html/A.htm#STYLE_">STYLE=</A> attribute). Global style sheets defined with a <A HREF="../references/objects/LINK.htm#LINK">LINK</A> or <A HREF="../references/objects/STYLE.htm#STYLE">STYLE</A> tag in the <A HREF="../references/objects/HEAD.htm#HEAD">HEAD</A> section of the document can be manipulated through script. Manipulating the global style sheet is a powerful way to dynamically change the styles that apply to Web pages.

<H2><A NAME="styleSheets_Collecti">styleSheets Collection</A></H2>
<P>Global style sheets are made accessible to script through the <A HREF="../references/collections/styleSheets.htm#styleSheets">styleSheets</A> collection on the <I>document</I> object. This collection represents instances of STYLE and LINK elements in the HEAD section of the document with a type (or type attribute) of "text/css". Style sheets of other types are not supported. Imported style sheets are contained within a STYLE element, and are surfaced by the containing STYLE element as type styleSheet. STYLE and LINK elements can be added to the document through the <A HREF="../references/methods/createElement.htm#createElement">createElement</A> method on the window object. This method adds a new style sheet object to the <B>styleSheets</B> collection on the document. Style rules and imported style sheets can then be added to this style sheet with the <A HREF="../references/methods/addImport.htm#addImport">addImport</A> and <A HREF="../references/methods/addRule.htm#addRule">addRule</A> methods. 

<P>You can use identifiers to access style sheets in the document. You set an identifier for a style sheet by setting the ID attribute of the LINK or STYLE element.

<H3><A NAME="Disabling_Style_Shee">Disabling Style Sheets</A></H3>
<P>A powerful feature of the styleSheet object is that you can turn a style sheet off and on dynamically. The disabled property defaults to false, but can be set to "true" to remove the style sheet from being applied to the document. Toggling the application of style sheets is another technique for dynamically changing the style of a Web page.



<H3><A NAME="Replacing_Style_Shee">Replacing Style Sheets</A></H3>
<P>You can replace one style sheet with another by setting the <A HREF="../references/properties/href_0.htm#href_0">href</A> property of the style sheet to the URL of the replacement, as in the following example:

<PRE>if (document.styleSheets(0).href != null)
    document.styleSheets(0).href = "newstyle.css";
</PRE>

<P>When you replace a style sheet, the <A HREF="../references/collections/styleSheets.htm#styleSheets">styleSheets</A> collection is immediately updated to reflect the change. Replacing a style sheet in this way is available only for style sheets that have been included using the <A HREF="../references/objects/LINK.htm#LINK">LINK</A> element or the <A HREF="../references/css/import.htm#_import">@import</A> statement. The <A HREF="../references/properties/href_0.htm#href_0">href</A> property is null for style sheets defined using the <A HREF="../references/objects/STYLE.htm#STYLE">STYLE</A> element. 

<H3><A NAME="Dynamically_Changing">Dynamically Changing Style Sheet Rules</A></H3>
<P>Each style sheet is a collection of rules. The <A HREF="../references/collections/rules.htm#rules">rules</A> collection of the styleSheet object enumerates these rules. This collection can be accessed even if the style sheet is disabled. Rules are added and removed from the <B>rules</B> collection with add and remove methods on the individual style sheet. A rule that is added to a disabled style sheet will not apply to the document unless the style sheet's disabled property is changed to "false".

<P>The rules in the <A HREF="../references/collections/rules.htm#rules">rules</A> collection are in the source order of the document. Style rules linked in using the "@import" syntax of CSS are expanded in-place in the <B>rules</B> collection per the CSS1 specification. 

<P>As rules are added or deleted, a rule's absolute position in the rule collection may change, but its position relative to other rules will remain the same. The default location to add a new rule (without specifying an index) is at the end of the collection, which is the highest precedence (not accounting for selector specificity, as per the CSS specification) and is applied to the document last. If an index is supplied, the rule should be inserted before the rule currently in that ordinal position in the collection, or, if the index is larger than the number of rules in the collection, it should be added to the end . 

<P>The following is an example of using the addRule method. 

<PRE>&lt;HTML&gt;
&lt;HEAD&gt;
&lt;SCRIPT LANGUAGE="JScript"&gt;
function newRule() {
    document.styleSheets.MyStyles.addRule("P","color:blue");
}
&lt;/SCRIPT&gt;
&lt;STYLE ID="MyStyles"&gt;
H1 {color:red}
H2 {color:red;font-style:italic}
&lt;/STYLE&gt;
&lt;/HEAD&gt;
&lt;BODY onclick="newRule()"&gt;
&lt;H1&gt;Welcome!&lt;/H1&gt;
&lt;P&gt;This document uses style sheets.&lt;/P&gt;
&lt;H2&gt;Ways to Include Style Sheets&lt;/H2&gt;
&lt;UL&gt;
&lt;LI&gt;LINK
&lt;LI&gt;STYLE
&lt;LI&gt;@import
&lt;/UL&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;
</PRE>

<P><BUTTON onclick="if (CheckCAB(3)) {window.open('../../../samples/dhtml/overview/manag_01.htm')} else { ALink(3, 'comp3.htm') }">Show Me</BUTTON>
<BR CLEAR=ALL><P>Each rule has a selector, identifying the elements to apply the rule to, and a list of style assignments, identifying the style attributes to apply to these elements. The selector is typically the name of an element, class, or identifier, but can also be a combination of names, such as a comma-separated list of element names. Each style assignment consists of a style attribute name and a value separated by a colon. If there is more than one assignment, the assignments are separated by semicolons. The rule object has a <A HREF="../references/properties/readOnly_0.htm#readOnly_0">readOnly</A> property that indicates whether the particular rule is from an editable source. Imported and linked styles cannot be edited, so the <B>readOnly</B> property for the contained rule would return "true".

<P>As an example of manipulating style rules, consider the following simple style sheet:

<PRE>&lt;STYLE
ID="MyStyles"&gt;
H1 {color:red}
H2 {color:red;font-style:italic}
&lt;/STYLE&gt;
</PRE>

<P>The <A HREF="../references/collections/rules.htm#rules">rules</A> collection would contain two rules. Each rule has two parts (and corresponding properties): the selector and the style. The selector in the first rule in the above style sheet is "H1".

<PRE>alert(document.styleSheets[0].rules[0].selectorText); // this returns "H1"
</PRE>

<P>To change the style of the first rule in the first style sheet, use the following:

<PRE>document.styleSheets[0].rules[0].style.color = "blue";
</PRE>
<H3><A NAME="User_Defined_Style_S">User-Defined Style Sheets</A></H3>
<P>Through the Options dialog box of the browser, users can specify a style sheet that they want to have applied to all pages that they view. This style sheet will be applied to the document first, meaning the author has the final say of how a CSS attribute is defined. Style sheets defined in the document override the user-defined style sheet. The user-defined style sheet is simply a "preference" that will affect the page if the author has not defined a rule for that CSS attribute. User-defined style sheets specified by the user in the Options box dialog of the browser are not listed in the <A HREF="../references/collections/styleSheets.htm#styleSheets">styleSheets</A> collection. 

<!-- CONTENTS_END -->
<!-- START PAGE FOOTER -->
<H6><HR size=1></H6>
<P><A ID=line HREF="#pagetop"><IMG src="../../art/arrowup1.gif" WIDTH="17" HEIGHT="16" ALIGN="MIDDLE" BORDER="0" ALT="Up">&nbsp;Top of Page</A>
<BR><A ID=line HREF="http://www.microsoft.com/misc/cpyright.htm" TARGET="_top">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
<!-- END PAGE FOOTER -->
</BLOCKQUOTE>
</BODY>
</HTML>