<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>More Complex Filter Manipulation</TITLE>
<SCRIPT language="JavaScript">
	var Light_X = 20
	var Light_Y = 20
	var Light_Z = 40
	var xInc = 10;
	var yInc = 10;

	var r = 100;
	var deg = 0;
	var deg1;

	var rad;
	var PointAngle;
		
	var PlaneLight_X = 20
	var PlaneLight_Y = 120
	var PlaneLight_Z = 3
	var conversion = (2 * 3.1415917)/360


function movefilt()
{

	// Do some basic geometry to convert from Polar coordinates to cartesian

	Light_X = r + r * Math.cos(deg * conversion);
	Light_Y = r + r * Math.sin(deg * conversion);
	
	deg += 10;

	if (deg == 360) 
		deg = 0;

	// Rotate the cone
	Body1.filters[0].moveLight(0, Light_X, Light_Y, Light_Z, 1);

	// Figure out where the Plane is in relation to the cone
	PointAngle = Math.atan((PlaneLight_Y - r)/(PlaneLight_X - r))/conversion;
	
	// More basic geometry
	if ((PlaneLight_X < r) && (PlaneLight_Y < r))
		PointAngle += 180;

	if ((PlaneLight_X > r) && (PlaneLight_Y < r))
		PointAngle += 360 

	if ((PlaneLight_X < r) && (PlaneLight_Y > r))
		PointAngle += 180

	// If the plane is in the cone, update the planes position	
	if ((deg - 10 <= PointAngle) && (PointAngle <= deg))
		Body1.filters[0].moveLight(2, PlaneLight_X, PlaneLight_Y, PlaneLight_Z, 1);

	//Do it all again in about 1/10th of a second
	mytimeout=setTimeout('movefilt()', 100);

}

function movePlanes()
{
	// Increment the planes position
	PlaneLight_X++;
	PlaneLight_Y++;

	// Wrap the plane if it goes off the screen	
	if (PlaneLight_Y > 200) PlaneLight_Y = 0;
	if (PlaneLight_X > 200) PlaneLight_X = 0;

	timeout2 = setTimeout('movePlanes()', 500);
}

function go() {
	Body1.filters.light.addCone(100,100,0,Light_X, Light_Y, 0, 255, 0, 150, 10);
	Body1.filters.light.addAmbient(0,255,0,20)
	Body1.filters.light.addPoint(PlaneLight_X, PlaneLight_Y, 3, 0, 255, 0, 100);
	var x = 0;
	movefilt();
	movePlanes();
	
}
</SCRIPT>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
</HEAD>

<BODY TOPMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF"
LINK="#000000" VLINK="#808080" ALINK="#000000" onload="go()">

<img src="radar.jpg" id=Body1 style="height:200;width:200;filter:light()">
</BODY>
</HTML>