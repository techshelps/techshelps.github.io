<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<HTML>
<HEAD>
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Concentration</TITLE>
	
<STYLE>
	input.clsbtn {font-size:12;font-family:Verdana;color:yellow;background:black}
</STYLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">
	
</HEAD>

<BODY BGCOLOR=#003084 TEXT=yellow STYLE="font-family:verdana;font-size:18pt">

<P>Concentration
<br>

<OBJECT ID="Seq"
	CLASSID="CLSID:B0A6BAE2-AAF0-11d0-A152-00A0C908DB96">
</OBJECT>

<DIV ID="divMaster" STYLE="Position:Absolute;Top:60px;Left:10px;Height:203px;Width:203px;Visibility:Visible;Background-Color:White;filter:RevealTrans(Transition = 12, Duration=0.5) RevealTrans(Duration=1.0)">

<OBJECT ID="aniSprite00"
STYLE="Position:Absolute;Top:0;Left:0;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT>

<OBJECT ID="aniSprite01"
STYLE="Position:Absolute;Top:0;Left:51;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT> 

<OBJECT ID="aniSprite02"
STYLE="Position:Absolute;Top:0;Left:102;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT> 

<OBJECT ID="aniSprite03"
STYLE="Position:Absolute;Top:0;Left:153;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT> 

<OBJECT ID="aniSprite04"
STYLE="Position:Absolute;Top:51;Left:0;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT>

<OBJECT ID="aniSprite05"
STYLE="Position:Absolute;Top:51;Left:51;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT> 

<OBJECT ID="aniSprite06"
STYLE="Position:Absolute;Top:51;Left:102;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT> 

<OBJECT ID="aniSprite07"
STYLE="Position:Absolute;Top:51;Left:153;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT> 

<OBJECT ID="aniSprite08"
STYLE="Position:Absolute;Top:102;Left:0;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT>

<OBJECT ID="aniSprite09"
STYLE="Position:Absolute;Top:102;Left:51;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT> 

<OBJECT ID="aniSprite10"
STYLE="Position:Absolute;Top:102;Left:102;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT> 

<OBJECT ID="aniSprite11"
STYLE="Position:Absolute;Top:102;Left:153;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT> 

<OBJECT ID="aniSprite12"
STYLE="Position:Absolute;Top:153;Left:0;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT>

<OBJECT ID="aniSprite13"
STYLE="Position:Absolute;Top:153;Left:51;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT> 

<OBJECT ID="aniSprite14"
STYLE="Position:Absolute;Top:153;Left:102;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT> 

<OBJECT ID="aniSprite15"
STYLE="Position:Absolute;Top:153;Left:153;Height:50;Width:50;Visibility:Visible"
CLASSID="clsid:FD179533-D86E-11d0-89D6-00A0C90833E6">
<PARAM NAME="SourceURL" VALUE="aniConcentrate.png">
<PARAM NAME="NumFrames" VALUE="10">
<PARAM NAME="NumFramesAcross" VALUE="5">
<PARAM NAME="NumFramesDown" VALUE="2">
<PARAM NAME="ColorKey" VALUE="255,0,255">
<PARAM NAME="UseColorKey" VALUE="True">
<PARAM NAME="InitialFrame" VALUE="1">
<PARAM NAME="MouseEventsEnabled" VALUE="True">
</OBJECT> 

</DIV>

<DIV ID="divFeedback" STYLE="Position:Absolute;Top:280px;Left:10px;Width:400;font-size:14pt">
Moves: 0, Matches: 0
</DIV>

</BODY>

<SCRIPT LANGUAGE = "VBS">
'By Ken Stanfield // a-kenst@microsoft.com

'================
'GLOBAL VARIABLES
'================

dim aShowTrans
aShowTrans = Array(1,2,3,4,5,6,7,8,9,10,11,13,14,15,16,17,18,19,20,21,22)
dim aHideTrans
aHideTrans = Array(8,9,10,11,21,22)
dim iFltrCnt
dim rndFltr

'Note: This version of the game uses a hard-coded layout.
'A routine could be written to randomly shuffle the layout
'so that the solution is different each time the game is played.
dim aGameMap
aGameMap = Array(2,3,4,5,6,7,8,9,9,8,7,6,5,4,3,2)

dim gMoves
dim gMatches

dim gAni1
dim gAni2
dim gAniCnt

'===================
'INITIALIZATION SUBS
'===================

Sub Window_OnLoad()
	InitVars
	Shuffle
End Sub

Sub InitVars
	iFltrCnt = 0
	rndFltr = 0

	gMoves = 0
	gMatches = 0

	gAni1 = 0
	gAni2 = 0
	gAniCnt = 0
End Sub

'==============
'GAME TURN SUBS
'==============

Sub InitGameTurnVars()
	gAni1 = 0
	gAni2 = 0
	gAniCnt = 0	
End Sub

Sub IncrementMoves()
	gMoves = gMoves + 1	
	divFeedback.innerText = "Moves: " & gMoves & ", Matches: " & gMatches
End Sub

Sub IncrementMatches()
	gMatches = gMatches + 1
	divFeedback.innerText = "Moves: " & gMoves & ", Matches: " & gMatches
	if gMatches = 8 then
		MsgBox "You solved the puzzle in " & Trim(gMoves) & " moves."
		'TO DO: Ask about a new game; if yes, re-initialize everything.
	end if
End Sub

'==============
'SEQUENCER SUBS
'==============

Sub Seq_OnInit
	Call Seq("1").at(1.20, "NoMatch", 1, 0.000, 1)
End Sub

'=================
'RANDOMIZE ROUTINE
'=================

Sub Shuffle()
	aGameMap = Array(2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9)
	dim x, i, j
	dim Saved
	'I read somewhere that a fresh deck of cards needs
	'to be shuffled 7 times to be "truly" random, so
	'I always shuffle everything 7 times...
	For x = 1 To 7
		Randomize
		For i = 15 To 0 Step -1
			j = Int(Rnd * i)
			'In-line swap routine
			Saved = aGameMap(i)
			aGameMap(i) = aGameMap(j)
			aGameMap(j) = Saved
		Next
	Next
End Sub

'===================
'SPRITE ONCLICK SUBS
'===================

Sub aniSprite00_OnClick()
	Call RevealFrame(0,aGameMap(0))
End Sub

Sub aniSprite01_OnClick()
	Call RevealFrame(1,aGameMap(1))
End Sub

Sub aniSprite02_OnClick()
	Call RevealFrame(2,aGameMap(2))
End Sub

Sub aniSprite03_OnClick()
	Call RevealFrame(3,aGameMap(3))
End Sub

Sub aniSprite04_OnClick()
	Call RevealFrame(4,aGameMap(4))
End Sub

Sub aniSprite05_OnClick()
	Call RevealFrame(5,aGameMap(5))
End Sub

Sub aniSprite06_OnClick()
	Call RevealFrame(6,aGameMap(6))
End Sub

Sub aniSprite07_OnClick()
	Call RevealFrame(7,aGameMap(7))
End Sub

Sub aniSprite08_OnClick()
	Call RevealFrame(8,aGameMap(8))
End Sub

Sub aniSprite09_OnClick()
	Call RevealFrame(9,aGameMap(9))
End Sub

Sub aniSprite10_OnClick()
	Call RevealFrame(10,aGameMap(10))
End Sub

Sub aniSprite11_OnClick()
	Call RevealFrame(11,aGameMap(11))
End Sub

Sub aniSprite12_OnClick()
	Call RevealFrame(12,aGameMap(12))
End Sub

Sub aniSprite13_OnClick()
	Call RevealFrame(13,aGameMap(13))
End Sub

Sub aniSprite14_OnClick()
	Call RevealFrame(14,aGameMap(14))
End Sub

Sub aniSprite15_OnClick()
	Call RevealFrame(15,aGameMap(15))
End Sub

'===============================
'ENABLE/DISABLE MOUSEEVENTS SUBS
'===============================

Sub MouseEventsEnable()
	aniSprite00.MouseEventsEnabled = 1
	aniSprite01.MouseEventsEnabled = 1
	aniSprite02.MouseEventsEnabled = 1
	aniSprite03.MouseEventsEnabled = 1
	aniSprite04.MouseEventsEnabled = 1
	aniSprite05.MouseEventsEnabled = 1
	aniSprite06.MouseEventsEnabled = 1
	aniSprite07.MouseEventsEnabled = 1
	aniSprite08.MouseEventsEnabled = 1
	aniSprite09.MouseEventsEnabled = 1
	aniSprite10.MouseEventsEnabled = 1
	aniSprite11.MouseEventsEnabled = 1
	aniSprite12.MouseEventsEnabled = 1
	aniSprite13.MouseEventsEnabled = 1
	aniSprite14.MouseEventsEnabled = 1
	aniSprite15.MouseEventsEnabled = 1
End Sub

Sub MouseEventsDisable()
	aniSprite00.MouseEventsEnabled = 0
	aniSprite01.MouseEventsEnabled = 0
	aniSprite02.MouseEventsEnabled = 0
	aniSprite03.MouseEventsEnabled = 0
	aniSprite04.MouseEventsEnabled = 0
	aniSprite05.MouseEventsEnabled = 0
	aniSprite06.MouseEventsEnabled = 0
	aniSprite07.MouseEventsEnabled = 0
	aniSprite08.MouseEventsEnabled = 0
	aniSprite09.MouseEventsEnabled = 0
	aniSprite10.MouseEventsEnabled = 0
	aniSprite11.MouseEventsEnabled = 0
	aniSprite12.MouseEventsEnabled = 0
	aniSprite13.MouseEventsEnabled = 0
	aniSprite14.MouseEventsEnabled = 0
	aniSprite15.MouseEventsEnabled = 0
End Sub

'===============
'TRANSITION SUBS
'===============

Sub RevealFrame(theAni, theFrame)
	gAniCnt = gAniCnt + 1
	if gAniCnt = 1 then
		gAni1 = theAni
	else
		gAni2 = theAni
	end if
		
	MouseEventsDisable
	'Generate random number & assign to filters.item(1)
	rndFltr = Int((UBound(aShowTrans) - LBound(aShowTrans) + 1) * Rnd + LBound(aShowTrans))
	divMaster.Filters.Item(1).Transition = aShowTrans(rndFltr)
	'Lock painting to the div
	divMaster.Filters.Item(0).Apply()
	divMaster.Filters.Item(1).Apply()
	'Seek to theFrame for theAni
	Select Case theAni
		Case 0
			aniSprite00.FrameSeek(theFrame)
		Case 1
			aniSprite01.FrameSeek(theFrame)
		Case 2
			aniSprite02.FrameSeek(theFrame)
		Case 3
			aniSprite03.FrameSeek(theFrame)
		Case 4
			aniSprite04.FrameSeek(theFrame)
		Case 5
			aniSprite05.FrameSeek(theFrame)
		Case 6
			aniSprite06.FrameSeek(theFrame)
		Case 7
			aniSprite07.FrameSeek(theFrame)
		Case 8
			aniSprite08.FrameSeek(theFrame)
		Case 9
			aniSprite09.FrameSeek(theFrame)
		Case 10
			aniSprite10.FrameSeek(theFrame)
		Case 11
			aniSprite11.FrameSeek(theFrame)
		Case 12
			aniSprite12.FrameSeek(theFrame)
		Case 13
			aniSprite13.FrameSeek(theFrame)
		Case 14
			aniSprite14.FrameSeek(theFrame)
		Case 15
			aniSprite15.FrameSeek(theFrame)
	End Select
	'Unlock painting to the div
	divMaster.Filters.Item(0).Play()
	divMaster.Filters.Item(1).Play()	
End Sub

Sub NoMatch()	
	MouseEventsDisable
	'Determine relative placement of 2 cells to pick the most appropriate
	'transition effects.

	'Begin by assigning "standard" transition array
	'that works well for all cases
	aHideTrans = Array(8,9,10,11,21,22)

	'Now determine if cells are:
		'in same row;
		'in same column;
		'diagonal from bottom right/top left
		'diagonal from bottom left/top right
		
	Select Case Abs(gAni1 - gAni2)
		Case 1, 2, 3
			'Could be in same row; ignore if wrap-around to next row
			if (gAni1 \ 4) = (gAni2 \ 4) then
				'Set up same row transition array
				aHideTrans = Array(4,5)
			End If	
		Case 4, 8, 12
			'Set up same column transition array
			aHideTrans = Array(6,7)
		Case 5, 10
			'Set up Diag up right/down left transition array
			aHideTrans = Array(17,20)
		Case 6, 9
			'Set up diagonal down right/up left transition
			aHideTrans = Array(18,19)
	End Select
			
	'Generate random number & assign to filters.item(1)
	rndFltr = Int((UBound(aHideTrans) - LBound(aHideTrans) + 1) * Rnd + LBound(aHideTrans))
	divMaster.Filters.Item(1).Transition = aHideTrans(rndFltr)
	'Lock painting to the div
	divMaster.Filters.Item(0).Apply()
	divMaster.Filters.Item(1).Apply()
	
	'Seek changed sprites back to initial (empty) frame
	if gAni1 = 0 or gAni2 = 0 then aniSprite00.FrameSeek(1)
	if gAni1 = 1 or gAni2 = 1 then aniSprite01.FrameSeek(1)
	if gAni1 = 2 or gAni2 = 2 then aniSprite02.FrameSeek(1)
	if gAni1 = 3 or gAni2 = 3 then aniSprite03.FrameSeek(1)
	if gAni1 = 4 or gAni2 = 4 then aniSprite04.FrameSeek(1)
	if gAni1 = 5 or gAni2 = 5 then aniSprite05.FrameSeek(1)
	if gAni1 = 6 or gAni2 = 6 then aniSprite06.FrameSeek(1)
	if gAni1 = 7 or gAni2 = 7 then aniSprite07.FrameSeek(1)
	if gAni1 = 8 or gAni2 = 8 then aniSprite08.FrameSeek(1)
	if gAni1 = 9 or gAni2 = 9 then aniSprite09.FrameSeek(1)
	if gAni1 = 10 or gAni2 = 10 then aniSprite10.FrameSeek(1)
	if gAni1 = 11 or gAni2 = 11 then aniSprite11.FrameSeek(1)
	if gAni1 = 12 or gAni2 = 12 then aniSprite12.FrameSeek(1)
	if gAni1 = 13 or gAni2 = 13 then aniSprite13.FrameSeek(1)
	if gAni1 = 14 or gAni2 = 14 then aniSprite14.FrameSeek(1)
	if gAni1 = 15 or gAni2 = 15 then aniSprite15.FrameSeek(1)

	'Unlock painting to the div
	divMaster.Filters.Item(0).Play()
	divMaster.Filters.Item(1).Play()
	
	'Reinitialze GameTurn Variables
	Call InitGameTurnVars
End Sub

'FILTERCHANGE EVENT IS CONTROLLING EVENT FOR GAME

Sub divMaster_OnFilterChange
	Select Case Window.Event.srcElement.id
		Case "divMaster"
			If divMaster.filters.revealTrans.Status = 0 then
				iFltrCnt = iFltrCnt + 1
				If iFltrCnt = 2 then
					MouseEventsEnable
					iFltrCnt = 0
					If gAniCnt = 2 then
						'Check for match
						If aGameMap(gAni1) = aGameMap(gAni2) then
							'If match found, reset GameTurn variables
							'and increment moves.
							'TODO NOTE: Also need to disable mouse events for matching squares
							'when exposed...
							InitGameTurnVars
							IncrementMoves
							IncrementMatches
						Else					
							IncrementMoves
							'If no match found, call Seq("1") to hide both squares
							Call Seq("1").Play()											
						End If						
					End If
				End If
			End If
	End Select
End Sub

</SCRIPT>

</HTML>
