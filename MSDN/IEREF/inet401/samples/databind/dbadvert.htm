<HTML>
<HEAD>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DataFormatAs Demo</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<SCRIPT language="JavaScript">
var g_nTimerId;
var g_marker = null;
</SCRIPT>

<SCRIPT FOR=window EVENT=onload>
var nmsec = 5000; // swap the image every five seconds
g_nTimerId = window.setInterval("ChooseAdvertisement()", nmsec);
</SCRIPT>

<SCRIPT language="JavaScript">
function ChooseAdvertisement()
{
   // Select a record from the table based on a randomized calculation
    var n = Math.random();
	n = n*10;
	n = parseInt((n % tdcAdvertisements.recordset.recordCount) -1);
	if (g_marker == null)
	{
		g_marker = tdcAdvertisements.recordset.Bookmark;
	}
	tdcAdvertisements.recordset.Move(n,g_marker);
}
</SCRIPT>
</HEAD>

<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">

<H2>Data Binding and DATAFORMATAS</H2>
<OBJECT id=tdcAdvertisements WIDTH=0 HEIGHT=0
   CLASSID="clsid:333C7BC4-460F-11D0-BC04-0080C7055A83">
	<PARAM NAME="DataURL" VALUE="dbadvert.csv">								  
	<PARAM NAME="UseHeader" VALUE="True">
	<PARAM NAME="TextQualifier" VALUE="'">
</OBJECT>

<P><IMG SRC="art/arcadia.jpg">
<P><IMG STYLE="position:absolute;top:75;left:350" DATASRC=#tdcAdvertisements DATAFLD=article>
<P><MARQUEE STYLE="position:absolute;top:250;font-size:large" DATASRC=#tdcAdvertisements DATAFLD=banner DATAFORMATAS=HTML></MARQUEE>
<P><SPAN STYLE="position:absolute;top:300">
A random number is generated at a 10 second interval. The <strong>ADO</strong> object model 
exposed by all DSOs through the extended <strong>recordset</strong> property is used to 
select a record from the table. Note that the random number is ensured
to fall within the range of available records through the use of modulo arithmetic.</SPAN>

</FONT>
</BODY>
</HTML>