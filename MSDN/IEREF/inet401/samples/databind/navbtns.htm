<HTML>
<HEAD>
<SCRIPT>
var public_description = new CScriptlet();
var g_RS = null;
var g_DSO = null;

var g_nFirst = 1;
var g_nPrevious = 2;
var g_nNext = 3;
var g_nLast = 4;

// constructor
function CScriptlet()
{
	this.get_DSO = GetDSO;
	this.put_DSO = SetDSO;
	this.SetCaption = SetCaption;
}

// Change the caption of any of the navigation button
//
// Parameters
//
// nButton  - index of button, the caption of which is to be changed. valid range = (0..3)
// cCaption - the new caption
function SetCaption(nButton, cCaption)
{
	if (nButton == null || nButton > document.body.children.length - 1 || cCaption == null)
		return;

	document.body.children(nButton).value = cCaption;
}

// called when the DSO property of the scriptlet is set
function SetDSO(oDSO)
{
	g_DSO = oDSO;
	g_RS = (g_DSO == null ? null : g_DSO.recordset);
	if (g_DSO != null)
		g_DSO.ondatasetchanged = HandleDataSetChanged;
}

// called when the DSO property of the scriptlet is retrieved
function GetDSO()
{
	return g_DSO;
}

// Navigate through the ADO recordset provided by the DSO
function ADONavigate(nDirection)
{
	if (g_RS == null)
	{
		return;
	}

    // cDirection indicates the direction to navigate
	switch (nDirection)
	{
	case g_nFirst:
		g_RS.MoveFirst();
		break;
	case g_nPrevious:
		if (g_RS.AbsolutePosition > 1)
		{
			g_RS.MovePrevious();
		}
		else
		{
			top.status = 'At beginning of file';
		}
		break;
	case g_nNext:
		if (g_RS.AbsolutePosition < g_RS.RecordCount)
		{
			g_RS.MoveNext();
		}
		else
		{
			top.status = 'At end of file';
		}
		break;
	case g_nLast:
		g_RS.MoveLast();
		break;
	default:
		alert("Invalid direction (" + nDirection + ")");
	}
}

// handle notifications from the DSO that the data set has changed
function HandleDataSetChanged()
{
	g_RS = g_DSO.recordset;
}

</SCRIPT>
</HEAD>

<BODY>
<INPUT TYPE=BUTTON VALUE="<<" TITLE="Move to the first record" onclick="ADONavigate(g_nFirst)">
<INPUT TYPE=BUTTON VALUE=" < " TITLE="Move to the previous record" onclick="ADONavigate(g_nPrevious)">
<INPUT TYPE=BUTTON VALUE=" > " TITLE="Move to the next record" onclick="ADONavigate(g_nNext)">
<INPUT TYPE=BUTTON VALUE=">>" TITLE="Move to the last record" onclick="ADONavigate(g_nLast)">
</BODY>
</HTML>