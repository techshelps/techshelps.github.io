<HTML>
<HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DB Wizard 4</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso8859-1">
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="ROBOTS" CONTENT="all">

<SCRIPT language="JavaScript">
var g_oFieldRecordset;
</SCRIPT>

<SCRIPT FOR=window EVENT=onload>
// plug the data from the wizard table into the textbox
oFields = this.parent.tdcWiz.recordset.fields;
spanQuestion.innerText = oFields('question').value;
</SCRIPT>

<SCRIPT FOR=tdcFields EVENT=ondatasetchanged>
   // Scenario: User adds new fields, moves onto next step, returns to this step
   // Problem: TDC in IFRAME was unloaded and didn't persist data, 
   // so TDC in outer frame has correct data, but TDC in IFRAME has original dataset

   // force the TDC to load its data since it's not bound to any page elements
   g_oFieldRecordset = window.parent.tdcFields.recordset;

   oRecordSet = this.recordset;
   oRecordSet.MoveFirst();
   for (i = 1; i = oRecordSet.RecordCount; i++)
   {
      oRecordSet.Delete();
	  oRecordSet.MoveFirst();
   }

   // Repopulate with the records from the outer frame
   g_oFieldRecordset.MoveFirst();
   while (!g_oFieldRecordset.EOF)
   {
      var aFields = new Array('field_name', 'field_label');
      var aValues = new Array(g_oFieldRecordset.fields('field_name').value, g_oFieldRecordset.fields('field_label').value);
      oRecordSet.AddNew(aFields, aValues);
      
      g_oFieldRecordset.MoveNext();
   }

</SCRIPT>

<SCRIPT FOR=document EVENT=onclick>
   oElement = window.event.srcElement;
   if (oElement.id == 'cmdDelete')
   {
      ADODelete(g_oFieldRecordset, oElement.recordNumber);
	  ADODelete(tdcFields.recordset, oElement.recordNumber);
   }
</SCRIPT>

<SCRIPT FOR=btnAdd EVENT=onclick>
   // update the dbfields table
   if (txtFieldName.value != '' && txtFieldLabel.value != '')
   {
      ADOAdd(g_oFieldRecordset);
      ADOAdd(tdcFields.recordset);
   }
</SCRIPT>

<SCRIPT language="JavaScript">
// Add the (field, label) tuple to the data set
function ADOAdd(oRecordSet)
{
   if (oRecordSet == null)
      return;

   var aFields = new Array('field_name', 'field_label');
   var aValues = new Array(txtFieldName.value, txtFieldLabel.value);
   oRecordSet.AddNew(aFields, aValues);
}

// Delete the record at absolute position nRecord from the data set.
function ADODelete(oRecordSet, nRecord)
{
   if (oRecordSet == null)
      return;

   oRecordSet.AbsolutePosition = nRecord;
   oRecordSet.Delete();
}

</SCRIPT>

</HEAD>

<BODY TOPMARGIN=0 LEFTMARGIN=0 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">

<OBJECT classid="clsid:333C7BC4-460F-11D0-BC04-0080C7055A83"
    ID=tdcFields HEIGHT=0 WIDTH=0>
	<PARAM NAME="DataURL" VALUE="dbfields.csv">
	<PARAM NAME="UseHeader" VALUE="True">
</OBJECT>

<SPAN ID=spanQuestion></SPAN>
<TABLE>
<TR><TD>Name</TD><TD><INPUT STYLE="width:100px" TYPE=TEXT ID=txtFieldName></TD></TR>
<TR><TD>Label</TD><TD><INPUT STYLE="width:100px" TYPE=TEXT ID=txtFieldLabel></TD></TR>
<INPUT TYPE=BUTTON ID=btnAdd TITLE="Add to Field List" STYLE="position:absolute;left:160px;top:50px" VALUE="+">
</TABLE>

<P>
<TABLE BORDER=1 DATASRC=#tdcFields>
<THEAD><TR><TH>&nbsp;</TH><TH>Field</TH><TH>Label</TH></TR></THEAD>
<TBODY>
<TR><TD><INPUT TYPE=BUTTON VALUE='x' TITLE="Delete this field" ID=cmdDelete></TD><TD><SPAN DATAFLD=field_name></SPAN></TD><TD><SPAN DATAFLD=field_label></SPAN></TD></TR>
</TBODY>
</TABLE>
</FONT>
</BODY>
</HTML>