<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding the ReplacePen Helper Function</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2"><h1><a name="_gs_adding_the_replacepen_helper_function"></a>Adding the ReplacePen Helper Function</h1>
<p>
In this topic, you will use WizardBar to add the member function <code>ReplacePen</code>. </p>
<p class=label>
<b>To create the ReplacePen helper function</b>
<ol>
<li>
Click the action button arrow, located on the right end of WizardBar.<br><br></li>
<li>
From the action menu, click <b>Add Member Function</b>.<p class=tl>
The <b>Add Member Function</b> dialog box appears.</P></li>
<li>
In the <b>Function Type</b> edit box, type the function’s return type (in this case, <code>void</code>).<br><br></li>
<li>
In the <b>Function Declaration</b> edit box, type the declaration (function name and parameters, if any) of the new function.<p class=tl>
In this case, type the following:</P><p class=tl>
<code>ReplacePen ()</code></P><p class=tl>
You don’t need to type a semicolon. Also, for functions such as this that take no parameters, the parentheses are optional.</P></li>
<li>
In the <b>Access </b>area, select <b>Protected</b>.<br><br></li>
<li>
Click <b>OK</b>.<p class=tl>
ClassWizard adds the declaration to the beginning of the first Protected section of the header file it finds (creating the section if it does not exist); creates a starter definition in the implementation file; and jumps you to the declaration. </P></li>
<li>
Using WizardBar, select CScribbleDoc from the <b>Class</b> combo box and select <code>ReplacePen</code> from the <b>Members</b> combo box. <br><br></li>
<li>
Type the following code to fill in the function definition for <code>ReplacePen</code>: <pre><code>m_nPenWidth = m_bThickPen ? m_nThickWidth : m_nThinWidth;
// Change the current pen to reflect the new width.
m_penCur.DeleteObject( );
m_penCur.CreatePen( PS_SOLID, m_nPenWidth, RGB(0,0,0) );
</code></pre>
</li>
</ol>
<p>
The <code>ReplacePen</code> member function uses the C conditional operator (<b>?:</b>) to determine the pen width and return its value. Then it calls the <code>DeleteObject</code> member function of the current pen object and creates a new solid black pen with <code>CreatePen</code>, setting its width and other attributes.</p>
<p>
Now that you’ve created <code>ReplacePen</code>, you want to call it from the Scribble code that initializes the pen width. This happens in the <code>InitDocument</code> member function code.</p>
<p class=label>
<b>To incorporate ReplacePen into Scribble</b>
<ol>
<li>
Using WizardBar, select <code>CScribbleDoc</code> in the <b>Class</b> combo box and <code>InitDocument</code> in the <b>Members</b> combo box. Click the action button to jump to <code>InitDocument</code>.<br><br></li>
<li>
In the text editor, replace the current code with the single line that calls <code>ReplacePen</code>:<pre><code>ReplacePen();&nbsp;&nbsp; // Initialize pen according to current width
</code></pre>
<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This code replaces the code you originally added in Lesson 4, <a href="_gs_creating_the_view.htm">Creating the View</a>: </p><pre><code>&nbsp;&nbsp;&nbsp;m_nPenWidth = 2; // Default 2 pixel pen width
 &nbsp; // Solid, black pen
 &nbsp; m_penCur.CreatePen( PS_SOLID, m_nPenWidth, RGB( 0,0,0 ) );
</code></pre>
<p class=atl>
because this code was incorporated into the <code>ReplacePen</code> function.</p></li>
<li>
Save your work.</li>
</ol>
</font></BODY>
</HTML>
