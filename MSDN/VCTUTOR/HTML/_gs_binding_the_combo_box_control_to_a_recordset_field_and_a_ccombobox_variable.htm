<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Binding the Combo Box Control to a Recordset Field and a CComboBox Variable</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_gs_binding_the_combo_box_control_to_a_recordset_field_and_a_ccombobox_variable"></a><sup></sup>Binding the Combo Box Control to a Recordset Field and a CComboBox Variable</h1>
<p>
Now that you have replaced the edit control for the <code>m_CourseID</code> member of <code>CSectionSet</code> with a combo box, you need to:
<ul type=disc>
<li>
Unbind the old edit control.<br><br></li>
<li>
Bind the new combo box control to the CourseID field.<br><br></li>
<li>
Bind the combo box control to a second member variable, a CComboBox variable in <code>CSectionForm</code>. </li>
</ul>
<p>
You will later use member functions of CComboBox, such as <b>AddString</b>, to fill and read the combo box. </p>
<p>
When you complete the next three procedures, the combo box control will have two member variables associated with it: (1) the foreign member variable, <code>m_CourseID</code>, in the recordset associated with the record view, and (2) the CComboBox member variable in the record view class. </p>
<p>
ClassWizard supports having two such member variables bound to the same control.</p>
<p class=label>
<b>To remove the old edit control binding</b>
<ol>
<li>
From the <b>View</b> menu, click <b>ClassWizard</b>. <br><br></li>
<li>
Click the <b>Member Variables</b> tab.<br><br></li>
<li>
In the <b>Class name</b> box, select class CSectionForm (if it isn’t already selected).<br><br></li>
<li>
In the <b>Control IDs</b> box, select <code>IDC_COURSE</code> and click <b>Delete Variable</b>. <br><br></li>
<li>
Click <b>OK</b>.</li>
</ol>
<p class=label>
<b>To bind the combo box control to the recordset member</b>
<ol>
<li>
In the dialog editor, press CTRL and double-click the combo box control to open the <b>Add Member Variable</b> dialog box.<p class=tl>
Recall that when you changed the edit control to a combo box, you also changed the tab order so the combo box would directly follow the Course static text control. ClassWizard chooses the member variable name based on the recordset member associated with the static text control that directly precedes it in tab order. </P></li>
<li>
Click <b>OK</b> to accept <code>m_pSet-&gt;m_CourseID</code> as the member variable name and exit the <b>Add Member Variable</b> dialog box.</li>
</ol>
<p class=label>
<b>To bind the combo box control to the view’s CComboBox member variable</b>
<ol>
<li>
Open ClassWizard and, if necessary, click the <b>Member Variables</b> tab.<br><br></li>
<li>
In the <b>Control IDs</b> list, highlight <code>IDC_COURSELIST</code>, and click <b>Add Variable</b>. <p class=tl>
The <b>Add Member Variable</b> dialog box appears.</P></li>
<li>
In the <b>Member variable name</b> box, type <code>m_ctlCourseList</code>.<br><br></li>
<li>
In the <b>Category</b> box, select Control.<p class=tl>
Note that this automatically selects CComboBox<b> </b>as the <b>Variable type</b>.</P></li>
<li>
Click <b>OK</b> to exit the <b>Add Member Variable</b> dialog box.<br><br></li>
<li>
Click <b>OK</b> to exit ClassWizard.<br><br></li>
<li>
Close the dialog editor and property page and save your work.</li>
</ol>
<ul type=disc>
<li>
If you are working through the DaoEnrol tutorial, proceed to the topic <a href="_gs_creating_a_recordset_for_the_course_table_in_daoenrol.htm">Creating a Recordset for the Course Table in DaoEnrol</a><br><br></li>
<li>
If you are working through the Enroll tutorial, proceed to the topic <a href="_gs_creating_a_recordset_for_the_course_table.htm">Creating a Recordset for the Course Table</a>.</li>
</ul>
</font></BODY>
</HTML>
