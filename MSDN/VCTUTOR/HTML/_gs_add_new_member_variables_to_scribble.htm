<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Add New Member Variables to Scribble</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2"><h1><a name="_gs_add_new_member_variables_to_scribble"></a><sup></sup>Add New Member Variables to Scribble</h1>
<p>
In addition to storing the current pen width in <code>m_nPenWidth</code>, class <code>CScribbleDoc</code> needs to keep track of whether the pen is currently thick or thin and how “thick” and “thin” are defined (in pixels). You do this by adding new data members for the thick and thin pen values. In <a href="_gs_connecting_a_class_to_a_dialog_box.htm">Connecting a Class to a Dialog Box</a>, in Scribble’s next lesson, you will add code to allow the user to define these values with a dialog box. For now, the default values will be hard coded. </p>
<p class=label>
<b>To add the new data members</b>
<ol>
<li>
Use ClassView to jump to the class definition for <code>CScribbleDoc</code>.<p class=tl>
Locate the section labeled “<code>// Attributes:</code>”.</P></li>
<li>
Right above this label, and after the <b>protected</b> keyword and the existing <code>m_nPenWidth</code> declaration, add the following code:<pre><code>BOOL&nbsp;&nbsp;&nbsp; m_bThickPen;    // Thick currently selected or not 
UINT&nbsp;&nbsp;&nbsp; m_nThinWidth;    // Current definition of thin
UINT&nbsp;&nbsp;&nbsp; m_nThickWidth;    // Current definition of thick 
</code></pre>
</li>
</ol>
<p class=indent>
<B><b>Tip</b></B>&nbsp;&nbsp;&nbsp;You could also right-click CScribbleDoc in ClassView and click <b>Add Member Variable</b> to add these three variables.</p>
<p class=label>
<b>To hard code the values</b>
<ol>
<li>
Use ClassView to jump to <code>InitDocument</code> (in ScribbleDoc.cpp), and add the following code just before the call to <code>ReplacePen:</code><pre><code>m_bThickPen = FALSE;
m_nThinWidth = 2;&nbsp;&nbsp;&nbsp;&nbsp; // Default thin pen is 2 pixels wide
m_nThickWidth = 5;&nbsp;&nbsp;&nbsp; // Default thick pen is 5 pixels wide
</code></pre>
<p class=tl>
The added code specifies that the pen is initially thin and defines the meanings of “thin” and “thick.”</P></li>
<li>
Save your work in ScribbleDoc.h and ScribbleDoc.cpp.</li>
</ol>
<p>
ClassView displays icons for the new member variables in class <code>CScribbleDoc</code>.</p>
</font></BODY>
</HTML>
