<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Add OLE Server Support to the Application Object</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_gs_add_ole_server_support_to_the_application_object"></a><sup></sup>Add OLE Server Support to the Application Object</h1>
<p>
You’ve already added much OLE server support to the application object by using the Full-server version of Scribble.cpp. In the next two procedures, you’ll complete this process by adding a <b>COleTemplateServer </b>data member to <code>CScribbleApp</code> and by adding a string resource to Scribble’s string table. </p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;For these procedures, you will be working in Scribble itself, not in Scratch/Scribble.</p>
<h3>Suggested Reading</h3>
<ul type=disc>
<li>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="ClassView">
</object><a href=JavaScript:alink_1.Click()>ClassView: Overview</a>, <i>Visual C++ User’s Guide</i><br><br></li>
<li>
<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="ClassView">
</object><a href=JavaScript:alink_2.Click()>ClassView Topics</a>, <i>Visual C++ Programmer’s Guide</i><br><br></li>
<li>
<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="Project views">
</object><a href=JavaScript:alink_3.Click()>Project Workspace Views</a>, <i>Visual C++ User’s Guide</i></li>
</ul>
<p class=label>
<b>To add a COleTemplateServer data member to CScribbleApp</b>
<ul type=disc>
<li>
Use ClassView to jump to the <code>CScribbleApp</code> declaration in Scribble.h and add the following lines at the beginning of the // Implementation section: <pre><code>COleTemplateServer m_server;
// Server object for document creation
</code></pre>
<p class=tl>
You will find the same code in Scratch\Scribble.h, which was provided by AppWizard.</P><p class=tl>
The <b>COleTemplateServer</b> object is used to register a server application with OLE. See how <code>m_server</code> is used in Scribble’s <code>InitInstance</code>.</P></li>
</ul>
<p class=label>
<b>To copy the string resource</b>
<ol>
<li>
Switch to ResourceView and open Scribble’s String table. <br><br></li>
<li>
Use the <b>File</b> menu to open the .RC file for the Scratch\Scribble project, and open its String table. (Don’t insert this resource file.)<br><br></li>
<li>
Arrange the String editor windows so that you can view both String tables and they don’t overlap.<br><br></li>
<li>
Press CTRL and then drag the resource <code>IDP_OLE_INIT_FAILED</code> from the Full-server version of Scribble to your Scribble project’s String table.<p class=tl>
This AppWizard provided string is used in Scribble’s <code>InitInstance</code>. The string text is:</P><pre><code>OLE initialization failed. Make sure that the OLE libraries are correct version.
</code></pre>
<p class=tl>
You can view this text by selecting the string and then clicking <b>Properties</b> from the <b>View</b> menu.</P></li>
<li>
Save your Scribble.rc and close both String tables. (You can also close the Scratch\Scribble version of Scribble.rc.)</li>
</ol>
</font></BODY>
</HTML>
