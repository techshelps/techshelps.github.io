<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting the CircleOffset Default Value</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_gs_setting_the_circleoffset_default_value"></a>Setting the CircleOffset Default Value</h1>
<p>
Similar to other properties, the CircleOffset property must be initialized to a default value when the control is created. In this case, setting CircleOffset to 0 is logical. Add the following line:</p>
<pre><code>&nbsp;&nbsp;&nbsp;&nbsp;PX_Short(pPX, _T("CircleOffset"), m_circleOffset, 0);
</code></pre>
<p>
to the <code>DoPropExchange</code> function in CIRCCTL.CPP:</p>
<pre><code>void CCircCtrl::DoPropExchange(CPropExchange* pPX)
{
 &nbsp;&nbsp; ExchangeVersion(pPX, MAKELONG(_wVerMinor, _wVerMajor));
 &nbsp;&nbsp; COleControl::DoPropExchange(pPX);

 &nbsp;&nbsp; PX_Bool(pPX, _T("CircleShape"), m_circleShape, TRUE);
 &nbsp;&nbsp; PX_Short(pPX, _T("CircleOffset"), m_circleOffset, 0);
}
</code></pre>
<p>
The CircleOffset property is initialized by calling <b>PX_Short</b> in the <code>CCircCtrl::DoPropExchange</code> member function, passing 0 as the default value parameter (the last parameter in the function call). Now, when the circle is first drawn, it will be centered in the bounding rectangle of the Circle control. As with all literal strings, the property name parameter must be passed through the <b>_T</b> macro.</p>
<p>
Properties initialized by calling a <b>PX_</b> function in a control's <code>DoPropExchange</code> function are persistent properties; thus, CircleOffset is a persistent property. Steps described in <a href="_gs_setting_the_circleoffset_property.htm">Setting the Circle Offset Property</a> will set the modified flag for persistent properties whenever the value of the CircleOffset property changes.</p>
</font></BODY>
</HTML>
