<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Invalidate Selected and Deselected Objects</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_gs_invalidate_selected_and_deselected_objects"></a>Invalidate Selected and Deselected Objects</h1>
<p>
To eliminate unnecessary repainting whenever the user changes the selected object, only the old and the new selected objects need to be invalidated. This results in smarter repainting than simply invalidating the entire client area of the view.</p>
<p class=label>
<b>To add update hints to selection code</b>
<ul type=disc>
<li>
Use ClassView to jump to the <code>SetSelection</code> member function in <code>CContainerView</code> and replace the following code:<pre><code>Invalidate();    
m_pSelection = pItem;    
</code></pre>
<p class=tl>
with this code:</P><pre><code>// update view to new selection
if (m_pSelection != pItem)
{
if (m_pSelection != NULL)
OnUpdate(NULL, HINT_UPDATE_ITEM, m_pSelection);

m_pSelection = pItem;
if (m_pSelection != NULL)
OnUpdate(NULL, HINT_UPDATE_ITEM, m_pSelection);
}
</code></pre>
</li>
</ul>
</font></BODY>
</HTML>
