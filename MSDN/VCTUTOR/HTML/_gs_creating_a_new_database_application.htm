<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a New Database Application</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_gs_creating_a_new_database_application"></a><sup></sup>Creating a New Database Application</h1>
<p>
AppWizard lets you specify whether your database application uses a file as well as a database. The Enroll application doesn’t need a file, so it is based on the <b>Database view without file support</b> option in AppWizard.</p>
<h3>Suggested Reading in the <i>Visual C++ Programmer’s Guide</i></h3>
<ul type=disc>
<li>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="Begin database">
</object><a href=JavaScript:alink_1.Click()>Overview: Creating a Program That Supports a Database</a><br><br></li>
<li>
<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_core_Serialization.3a_.Serialization_vs.._Database_Input.2f.Output">
</object><a href=JavaScript:alink_2.Click()>Serialization: Serialization vs. Database Input/Output</a></li>
</ul>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;In order to successfully complete the following procedure, you must have completed the steps required to register the Student Registration database with ODBC. If you have not done so, see <a href="_gs_setting_up_the_student_registration_data_source.htm">Setting Up the Student Registration Data Source</a>, in Lesson 1 of Enroll.</p>
<p class=label>
<b>To create the tutorial database application</b>
<ol>
<li>
From the <b>File</b> menu, choose <b>New</b>.<p class=tl>
The <b>New</b> dialog box appears.</P></li>
<li>
Click the <b>Projects</b> tab.<br><br></li>
<li>
Complete the <b>Projects</b> dialog box as follows:<ul type=disc>
<li>
In the <b>Type</b> box, select MFC AppWizard (exe).<br><br></li>
<li>
In the <b>Project Name</b> box, type <code>Enroll</code>.<br><br></li>
<li>
In the <b>Location</b> box, type the name of the directory to keep your source file project directory.<p class=tl>
AppWizard creates a project directory with the project's name (Enroll) under the directory specified in the <b>Location</b> box. </P></li>
</ul>
</li>
<li>
Click <b>OK</b>.<p class=tl>
AppWizard creates the project directory, and the <b>MFC AppWizard&nbsp;–&nbsp;Step 1</b> dialog box appears.</P></li>
<li>
Click the <b>Single document</b> radio button, and then click <b>Next</b>.<br><br></li>
<li>
In the <b>MFC AppWizard&nbsp;–&nbsp;Step 2 of 6</b> dialog box: <ul type=disc>
<li>
Click <b>Database view without file support</b>.<p class=tl>
When you create a database application without file support, AppWizard always creates it as an SDI application. </P><p class=tl>
This enables the <b>Data Source</b> button.</P></li>
<li>
Click <b>Data Source</b>.<p class=tl>
The <b>Database Options</b> dialog box appears.</P></li>
<li>
Click <b>ODBC</b> and, from the drop-down list box, select Student Registration. Click <b>OK</b>.<p class=tl>
The <b>Select Database Tables</b> dialog box appears. </P></li>
<li>
Select the table name Section, and click <b>OK</b>. <p class=tl>
This returns you to the <b>MFC AppWizard&nbsp;–&nbsp;Step 2 of 6</b> dialog box.</P><p class=tl>
Depending on the data source type you are using, additional qualifiers may precede or follow the table name. </P></li>
</ul>
</li>
<li>
Click <b>Next</b> to accept the options you have specified, then click <b>Next</b> in the AppWizard dialog boxes for Steps 3, 4, and 5 to accept the default options.<p class=tl>
In the <b>MFC AppWizard&nbsp;–&nbsp;Step 6 of 6</b> dialog box, you can check and, if necessary, modify the default names that AppWizard creates for your program’s classes and files. </P><p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;By default, AppWizard bases the names of classes on the project name you supply. This naming is probably fine if your application has only one recordset/view pair. If your application has multiple recordsets and record views, it’s a good idea to change the name of the first recordset/view pair created by AppWizard so the naming better reflects the name of the table in the data source. For Enroll, you’ll modify two class names and their related header and implementation filenames, even though the tutorial uses only one recordset/view pair.</p></li>
<li>
In the <b>MFC AppWizard&nbsp;–&nbsp;Step 6 of 6</b>  dialog box, make the following changes to class names:<ul type=disc>
<li>
Select the class <code>CEnrollSet</code>, and change it as follows:<p class=tl>
In the <b>Class name</b> box, change its name to <code>CSectionSet</code>. </P><p class=tl>
In the <b>Header file</b> box, change the header filename to <code>SectionSet.h</code>. </P><p class=tl>
In the <b>Implementation file</b> box, change the name to <code>SectionSet.cpp</code>.</P><p class=tl>
The base class is <b>CRecordset</b>. The edit item is disabled to show that you can’t change it.</P></li>
<li>
Select the class <code>CEnrollView</code>,&nbsp; and change it as follows:<p class=tl>
In the <b>Class name</b> box, change its name to <code>CSectionForm</code>. </P><p class=tl>
In the <b>Header file</b> box, change the header filename to <code>SectionForm.h</code>.</P><p class=tl>
In the <b>Implementation file</b> box, change the implementation filename to <code>SectionForm.cpp</code>.</P><p class=tl>
The base class is <b>CRecordView</b>.</P></li>
</ul>
</li>
<li>
Click <b>Finish</b>. <p class=tl>
The <b>New Project Information</b> dialog box appears, summarizing the settings and features AppWizard will generate for you when it creates your project.</P><p class=tl>
Take a moment to examine the application type, classes, and features that AppWizard automatically provides.</P></li>
<li>
Click <b>OK</b> in the <b>New Project Information</b> dialog box.<p class=tl>
AppWizard creates all necessary files and opens the project. The next topics describe the AppWizard-createf files in more detail.</P></li>
</ol>
</font></BODY>
</HTML>
