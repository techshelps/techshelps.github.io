<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The CircleOffset Property</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_gs_the_circleoffset_property"></a>The CircleOffset Property</h1>
<p>
This topic discusses the functional aspects of the CircleOffset property and the property's effect on the behavior of the Circle control. It also presents a strategy for modifying the Circle control's code to prepare for implementing the CircleOffset property's behavior.</p>

<h2><a name="_gs_circleoffset_property_functionality"></a>CircleOffset Property Functionality</h2>
<p>
The CircleOffset property allows the user to offset the circle from the center of the control's bounding rectangle. The CircleOffset property has an effect only if the value of the CircleShape property is <b>TRUE</b>. When the CircleShape property is <b>FALSE</b>, the control is drawn as an ellipse the size of the bounding rectangle. When CircleShape is <b>TRUE</b>, the circle can be offset potentially from center in either the x or the y direction as shown in the figure below, depending on which has the greater extent.</p>
<p class=label>
<b>Circle Offset 25 Units from Center</b></p>
<p>
<img src="vc39af1.gif" border=0></p>
<p>
The circle can also be offset in a negative direction. For example, if the Circle control is drawn with a greater x-extent, a positive offset will move the circle to the right, and a negative offset will move the circle to the left, within the bounding rectangle. If the control is drawn with a greater y-extent, a positive offset will move the circle toward the top, and a negative offset will move the circle toward the bottom, of the bounding rectangle.</p>
<p class=label>
<b>Circle Control with a Greater Y-Extent</b></p>
<p>
<img src="vc39af2.gif" border=0></p>
<p>
The following rules apply to CircleOffset property behavior:
<ul type=disc>
<li>
The control ignores any offset that would cause the circle to be placed outside the control's bounding rectangle.<br><br></li>
<li>
If the control is resized, CircleOffset is set to 0.<br><br></li>
<li>
If the CircleShape property is set to <b>TRUE</b>, CircleOffset is set to 0.</li>
</ul>
<p>
The control cannot allow the circle to be moved beyond its bounding rectangle. Thus, CircleOffset property's Set method must implement code that will validate the value of the offset passed to the Set method before setting the value of the CircleOffset property.</p>

<h2><a name="_gs_implementing_the_circleoffset_property"></a>Implementing the CircleOffset Property</h2>
<p>
Implementing CircleOffset property functions is more complex than implementing the CircleShape property. Not only does the CircleOffset property affect the drawing behavior of the control, it also requires that the value of the CircleOffset property be reset to 0 when either the control is resized or the CircleShape property is set to <b>TRUE</b>. Given these factors, the following code revisions must be made:
<ul type=disc>
<li>
Use ClassWizard to <a href="_gs_adding_the_circleoffset_property.htm">add the CircleOffset property</a> to the control.<br><br></li>
<li>
<a href="_gs_setting_the_circleoffset_default_value.htm">Set the default value of the CircleOffset property</a> to 0 when the control is created.<br><br></li>
<li>
<a href="_gs_setting_the_circleoffset_property.htm">Modify the CircleOffset property's Set method</a> to perform offset validation.<br><br></li>
<li>
<a href="_gs_drawing_the_control.htm">Modify the CCircCtrl::GetDrawRect member function</a> to properly calculate the coordinates of the square region based on the current CircleOffset property value.<br><br></li>
<li>
<a href="_gs_modifying_the_oncircleshapechanged_function.htm">Modify the CCircCtrl::OnCircleShapeChanged member function</a> to reset the CircleOffset property value to 0 if the CircleShape property is changed to <b>TRUE</b>.<br><br></li>
<li>
<a href="_gs_adding_the_onsize_function.htm">Add the CCircCtrl::OnSize notification function</a> to reset the CircleOffset value to 0 if the size of the control is changed.</li>
</ul>
</font></BODY>
</HTML>
