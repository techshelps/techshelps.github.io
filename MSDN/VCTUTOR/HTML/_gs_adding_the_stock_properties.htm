<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding the Stock Properties</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_gs_adding_the_stock_properties"></a>Adding the Stock Properties</h1>
<p>
Use ClassWizard to add the stock Caption, Font, and ForeColor properties to the Circle control. </p>
<p class=label>
<b>To add the stock properties</b>
<ol>
<li>
On the <b>View</b> menu, click <b>ClassWizard</b>.<br><br></li>
<li>
Click the <b>Automation</b> tab.<br><br></li>
<li>
In the <b>Class</b> <b>name</b> drop-down list box, select CCircCtrl.<br><br></li>
<li>
Click <b>Add</b> <b>Property</b>.<p class=tl>
The <b>Add</b> <b>Property</b> dialog box appears.</P></li>
<li>
From the <b>External</b> <b>name</b> drop-down combo box, select Caption.<br><br></li>
<li>
Under <b>Implementation</b>, select <b>Stock</b> (it may already be selected).<br><br></li>
<li>
Click <b>OK</b> to close the <b>Add</b> <b>Property</b> dialog box.<br><br></li>
<li>
Click <b>Add</b> <b>Property</b>.<br><br></li>
<li>
From the <b>External</b> <b>name</b> drop-down combo box, select Font.<br><br></li>
<li>
Click <b>OK</b> to close the <b>Add</b> <b>Property</b> dialog box.<br><br></li>
<li>
Click <b>Add</b> <b>Property</b>.<br><br></li>
<li>
From the <b>External</b> <b>name</b> drop-down combo box, select ForeColor.<br><br></li>
<li>
Click <b>OK</b> to close the <b>Add</b> <b>Property</b> dialog box.<p class=tl>
This returns you to the <b>Automation</b> tab. Notice that the implementation of the ForeColor property appears as:</P><pre><code>Implementation:
Stock Property
</code></pre>
</li>
<li>
Click <b>OK</b> to confirm your choices and close ClassWizard.</li>
</ol>
<p>
ClassWizard creates the code to add the Caption, Font, and ForeColor properties, modifying both the <code>CCircCtrl</code> class and the CIRC.ODL file.</p>
<p>
ClassWizard modifies the <code>CCircCtrl</code> class dispatch map in CIRCCTL.CPP to add the <b>DISP_STOCKPROP_CAPTION</b> macro entry for each property:</p>
<pre><code>BEGIN_DISPATCH_MAP(CCircCtrl, COleControl)
 &nbsp;&nbsp; //{{AFX_DISPATCH_MAP(CCircCtrl)
 &nbsp;&nbsp; DISP_PROPERTY_NOTIFY(CCircCtrl, "FlashColor", m_flashColor, OnFlashColorChanged, VT_COLOR)
 &nbsp;&nbsp; DISP_PROPERTY_NOTIFY(CCircCtrl, "CircleShape", m_circleShape, OnCircleShapeChanged, VT_BOOL)
 &nbsp;&nbsp; DISP_PROPERTY_EX(CCircCtrl, "CircleOffset", GetCircleOffset, SetCircleOffset, VT_I2)
 &nbsp;&nbsp; DISP_STOCKPROP_BACKCOLOR()
 &nbsp;&nbsp; DISP_STOCKPROP_CAPTION()
 &nbsp;&nbsp; DISP_STOCKPROP_FONT()
 &nbsp;&nbsp; DISP_STOCKPROP_FORECOLOR()
 &nbsp;&nbsp; DISP_FUNCTION_ID(CCircCtrl, "AboutBox", DISPID_ABOUTBOX, AboutBox, VT_EMPTY, VTS_NONE)
 &nbsp;&nbsp; //}}AFX_DISPATCH_MAP
END_DISPATCH_MAP()
</code></pre>
<p>
The <b>DISP_STOCKPROP_CAPTION</b> macro enables the stock Caption property in the Circle control, implemented as a Get/Set property. Note that the Caption property is an alias for the stock Text property. The Get and Set methods, and notification function for the Caption property are the <b>GetText</b>, <b>SetText</b>, and <b>OnTextChanged</b> functions in class <b>COleControl</b>.</p>
<p>
The <b>OnTextChanged</b> function is invoked when the Caption property is modified through the <b>SetText</b> function. By default, <b>OnTextChanged</b> simply invalidates the control.</p>
<p>
Stock property notification functions such as <b>OnTextChanged</b> can be overridden in the descendent control class. For example, you may wish to provide an optimal solution for redrawing the caption other than invalidating the control, which forces the whole control to repaint.</p>
<p>
In addition to the <b>GetText</b> function, the Caption property can be accessed directly through the <b>InternalGetText</b> function of <b>COleControl</b>. <b>InternalGetText</b> is useful when the control developer accesses the Caption property internally, for example, from the control’s <code>OnDraw</code> function. The <code>CCircCtrl::OnDraw</code> function will be changed to use the <b>InternalGetText</b> function to draw the caption text.</p>
<p>
The Circle control uses the font information contained in the stock Font property to draw the caption text. The Font property is actually a pointer to a font object that is encapsulated by class <b>CFontHolder</b>. The font object contains several properties that describe the current font. These properties are accessible through the font object’s <b>IDispatch</b> interface.</p>
<p>
Similar to the Caption property, the Font property is implemented as a Get/Set property. The Font property supports a notification function called <b>OnFontChanged</b>, which is defined in <b>COleControl</b>. By default, this function invalidates the control. <b>OnFontChanged</b> can be overridden in the control class to provide an optimal solution to reflecting the font change.</p>
<p>
The stock ForeColor property contains the foreground color that the control uses to paint the caption text. Like the stock BackColor property, the ForeColor property is a Get/Set property type.</p>
</font></BODY>
</HTML>
