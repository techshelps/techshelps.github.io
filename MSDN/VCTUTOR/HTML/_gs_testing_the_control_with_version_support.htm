<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Testing the Control with Version Support</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_gs_testing_the_control_with_version_support"></a>Testing the Control with Version Support</h1>
<p>
Testing different versions of the same control is not easy, simply because only one of the versions can be registered at a time. This is one way in which you might check to see if a newer version of the Circle control correctly ignores persistent data stored by an earlier version of the control.</p>
<p class=label>
<b>To insert the Circ control in Test Container</b>
<ol>
<li>
From the <b>Tools</b> menu, click <b>ActiveX Control Test Container</b>.<br><br></li>
<li>
From the <b>Edit</b> menu, click <b>Insert New Control</b>.<p class=tl>
The<b> Insert Control</b> dialog box appears.</P></li>
<li>
From the list box, select <b>Circ Control</b>.<br><br></li>
<li>
Click <b>OK</b> to close the <b>Insert Control</b> dialog box and insert the control into Test Container.</li>
</ol>
<p class=label>
<b>To test the version checking serialization code</b>
<ol>
<li>
From the <b>Edit</b> menu, click <b>Properties... Circ Control Object</b>.<p class=tl>
The <b>Circ Control Properties</b> dialog box appears.</P></li>
<li>
Change the value of the <b>CircleShape</b> property to <b>FALSE</b> (clear the check box and then click <b>OK</b>).<br><br></li>
<li>
From the <b>Control</b> menu, click <b>Save to Stream</b> or <b>Save to Storage</b>. Name the file as appropriate.<br><br></li>
<li>
From the <b>Edit</b> menu, click <b>Delete</b> <b>All</b>.<br><br></li>
<li>
In CIRC.CPP, change the version number to 2.0 by changing the value of the _wVerMajor global constant to 2.<br><br></li>
<li>
On the <b>Build</b> menu, click <b>Build Circ.ocx</b> to rebuild the control.<br><br></li>
<li>
From Test Container's <b>Edit</b> menu, click <b>Insert Control from Stream</b> or <b>Insert Control from Storage</b>, as appropriate. Insert your control.<br><br></li>
<li>
Select the control. From the <b>Edit</b> menu, click <b>Properties... Circ Control Object</b>.<p class=tl>
The <b>Circ Control Properties</b> dialog box appears.</P></li>
<li>
View the value of the <b>CircleShape</b> property in the property page.<p class=tl>
The persistent data saved in step 3 is version 1.0. When the control is recreated in step 6, the control's version is 2.0. Because the persistent data and the control have different versions, the control's persistent properties are initialized to their default values. The stored values are ignored. In particular, the <b>CircleShape</b> property should be <b>TRUE</b> (the check box will be checked).</P></li>
<li>
Change the value of the <b>CircleShape</b> property to <b>FALSE</b> again (clear the check box, then click <b>OK</b>).<br><br></li>
<li>
From the <b>Control</b> menu, click <b>Save</b> <b>to</b> <b>Stream</b> or <b>Save</b> <b>to</b> <b>Storage</b>. Name the file as appropriate.<br><br></li>
<li>
From the <b>Edit</b> menu, click <b>Delete</b> <b>All</b>.<br><br></li>
<li>
From Test Container's <b>Edit</b> menu, click <b>Insert Control from Stream</b> or <b>Insert Control from Storage</b>, as appropriate. Insert your control.<br><br></li>
<li>
Select the control. From the <b>Edit</b> menu, click <b>Properties... Circ Control Object</b>.<p class=tl>
The <b>Circ Control Properties</b> dialog box appears.</P></li>
<li>
View the value of the <b>CircleShape</b> property using the property page.<p class=tl>
The persistent data saved in step 11 is version 2.0. When the control is recreated in step 13, the control's version is 2.0. Because the persistent data and the control have the same version, the control's persistent properties are set to the stored values. In particular, the <b>CircleShape</b> property should be <b>FALSE</b> (the check box is cleared).</P><p class=tl>
When you have finished, close Test Container.</P></li>
</ol>
<p>
If you want your Circle control to match the control found in the sample directories, be sure to restore the control version to 1.0 (change the value of _wVerMajor in CIRC.CPP to 1 and rebuild the control).</p>
<p>
This concludes the Circle tutorial.</p>
</font></BODY>
</HTML>
