<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Add OLE Menu Resources</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_gs_add_ole_menu_resources"></a><sup></sup>Add OLE Menu Resources</h1>
<p>
A server application shows different menus, depending on whether it is running stand-alone, embedded, or in-place activated. AppWizard provides three different menus for these cases:
<ul type=disc>
<li>
<code>IDR_SCRIBBTYPE</code> is the menu for the document when it is opened in the usual way.<br><br></li>
<li>
<code>IDR_SCRIBBTYPE_SRVR_EMB</code> is the menu for the document when the server is opened fully from the container application.<br><br></li>
<li>
<code>IDR_SCRIBBTYPE_SRVR_IP</code> is the menu for the document when it is activated in place (thus, “IP”) in a container. When an object is activated in place, OLE merges the menu of the container application with the menu provided by the server application. The merging of the two menus is based on separator bars. Scribble’s in-place menu (<code>IDR_SCRIBBTYPE_SRVR_IP</code>) looks like this:<p class=tl>
Edit | Pen | Help</P><p class=tl>
An example of a container’s menu is seen in Container (the ActiveX Container tutorial discussed in Lessons 13 through 15), as shown below:</P><p class=tl>
File | | Window</P><p class=tl>
OLE merges the two menus to create the following menu when the Scribble object is activated in place in the Container application. By doing so, you can perform any Scribble-related tasks from within the container.</P><p class=tl>
File Edit Pen Window Help</P><p class=tl>
OLE merges pop-up menus, from left to right, in the following order:</P><ul type=disc>
<li>
Container’s pop-up menu(s) before the first separator.<br><br></li>
<li>
Server’s pop-up menu(s) before the first separator.<br><br></li>
<li>
Container’s pop-up menu(s) between the first and second separators.<br><br></li>
<li>
Server’s pop-up menu(s) between the first and second separators.<br><br></li>
<li>
Container’s pop-up menu(s) after the second separator.<br><br></li>
<li>
Server’s pop-up menu(s) after the second separator.</li>
</ul>
</li>
</ul>
<p>
Scribble’s two distinct OLE-related menu resources are referred to in Scribble.cpp in <code>CScribbleApp::InitInstance</code>:</p>
<pre><code>pDocTemplate-&gt;SetServerInfo(
   IDR_SCRIBBTYPE_SRVR_EMB, IDR_SCRIBBTYPE_SRVR_IP,
   RUNTIME_CLASS(CInPlaceFrame));
</code></pre>
<p>
AppWizard provides all the code and resources described above, except for the Pen pop-up menu, which is application specific. If you are creating a new application from scratch, each new pop-up menu must be added to each of the three resources. This is easy to do with the drag and copy feature of the Menu editor. You can copy a resource by dragging it to the desired location while holding down the CTRL key and then releasing the mouse button.</p>
<p>
In this part of the tutorial, you will:
<ul type=disc>
<li>
Copy the two new resources, <code>IDR_SCRIBBTYPE_SRVR_EMB</code> and <code>IDR_SCRIBBTYPE_SRVR_IP</code>, from the AppWizard-provided Scratch\Scribble.rc to your Scribble.rc.<br><br></li>
<li>
Add the Pen pop-up menu to each of the menus.</li>
</ul>
<p class=label>
<b>To copy menu resources</b>
<ol>
<li>
Switch to ResourceView and expand the Scribble Resources folder, then expand the Menu folder.<br><br></li>
<li>
From the <b>File</b> menu, click <b>Open</b> and select Scratch\Scribble\Scribble.rc. Again, expand the Menu folder.<br><br></li>
<li>
Copy the menus <code>IDR_SCRIBBTYPE_SRVR_EMB</code> and <code>IDR_SCRIBBTYPE_SRVR_IP</code> from the scratch resource file to your Scribble project .RC file.<br><br></li>
<li>
Close the scratch version of Scribble.rc.</li>
</ol>
<p class=label>
<b>To copy menu items</b>
<ol>
<li>
Open the menu resources <code>IDR_SCRIBBTYPE</code> and <code>IDR_SCRIBBTYPE_SRVR_EMB</code> in your Scribble project resource file.<br><br></li>
<li>
Arrange the two menus so they don’t overlap and so you can see both of them in the Menu editor window.<br><br></li>
<li>
Copy the Pen menu from <code>IDR_SCRIBBTYPE</code> into the <code>IDR_SCRIBBTYPE_SRVR_EMB</code> menu so that it is between the Edit and View menus, as in <code>IDR_SCRIBBTYPE</code>.<br><br></li>
<li>
Copy the Clear All menu item from the Edit menu in <code>IDR_SCRIBBTYPE</code> to the Edit menu in <code>IDR_SCRIBBTYPE_SRVR_EMB</code>.<br><br></li>
<li>
Close <code>IDR_SCRIBBTYPE_SRVR_EMB</code> and repeat steps 1 to 3 for <code>IDR_SCRIBBTYPE_SRVR_IP</code>, placing the Pen menu as follows:<p class=tl>
Edit | Pen | View | |&nbsp;&nbsp;&nbsp;|&nbsp; | Help </P><p class=tl>
(Don’t copy the Clear All menu item.)</P></li>
<li>
Save and then close the menu resources.</li>
</ol>
</font></BODY>
</HTML>
