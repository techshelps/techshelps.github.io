<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Deleting Embedded Objects</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_gs_deleting_embedded_objects"></a>Deleting Embedded Objects</h1>
<p>
To clear, or delete, an embedded object, you must:
<ul type=disc>
<li>
Add a Delete command to the Edit menu in the <code>IDR_CONTRTYPE</code> menu and assign its command ID<br><br></li>
<li>
Create handlers for the new Delete command<br><br></li>
<li>
Implement code for the handlers.</li>
</ul>
<p>
The following procedure explains how to do these tasks. </p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;For a refresher on working with the menu editor, complete the procedure outlined in <a href="_gs_add_the_clear_all_command_to_scribble.92.s_edit_menu.htm">Add the Clear All Command to Scribble's Edit Menu</a> in Scribble Lesson 5.</p>
<p class=label>
<b>To delete an embedded object</b>
<ol>
<li>
Use the menu editor to add a Delete command and separator to the Edit menu in the <code>IDR_CONTRTYPE</code> menu resource:<p class=tl>
Edit</P><p class=tl>
...</P><p class=tl>
Paste &amp;Special</P><p class=tl>
-------------</P><p class=tl>
&amp;Delete</P><p class=tl>
-------------</P></li>
<li>
Assign the standard framework command ID, <b>ID_EDIT_CLEAR</b>, to the Delete command. Note that the command prompt is already defined for you by the framework:<pre><code>Erase the selection\nErase
</code></pre>
<p class=tl>
(The prompt doesn’t show until you’re out of edit mode for this menu command.)</P></li>
<li>
Save the resource file.<br><br></li>
<li>
Using WizardBar, create a pair of <b>ON_COMMAND</b> and <b>ON_UPDATE_COMMAND_UI</b> handlers for <b>ID_EDIT_CLEAR</b> in ContainerView.cpp. <br><br></li>
<li>
Implement <code>OnEditClear</code> as follows:<pre><code>if (m_pSelection != NULL)
{
m_pSelection-&gt;Delete();
m_pSelection = NULL;
GetDocument()-&gt;UpdateAllViews(NULL);
}
</code></pre>
</li>
<li>
Implement <code>OnUpdateEditClear</code> as follows:<pre><code>pCmdUI-&gt;Enable(m_pSelection != NULL);
</code></pre>
</li>
</ol>
<p>
To delete an embedded object in a container, simply call the object’s <b>COleClientItem::Delete</b> function.</p>
</font></BODY>
</HTML>
