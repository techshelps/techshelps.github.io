<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Enhance Scribble's Print Preview</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2"><h1><a name="_gs_enhance_scribble.92.s_print_preview"></a>Enhance Scribble’s Print Preview</h1>
<p>
The default print preview capabilities are almost sufficient for Scribble’s needs. To some extent, Scribble’s print preview has already been enhanced when the printing capabilities were enhanced. Recall that in the override of <code>OnPreparePrinting</code> you called the <b>SetMaxPages</b> function to specify the length of Scribble documents. This allows the framework to add a scroll bar to the preview window.</p>
<p>
Another enhancement you can make is to change the number of pages displayed when preview mode is invoked. </p>
<p class=label>
<b><a name="_gs_to_set_the_number_of_pages_displayed_in_preview_mode"></a>To set the number of pages displayed in preview mode</b>
<ul type=disc>
<li>
Use WizardBar to jump to the <code>OnPreparePrinting</code> member function in ScribbleView.cpp. Then add the following code to the end of the function:<pre><code>BOOL bRet = DoPreparePrinting (pInfo);      // default preparation
pInfo-&gt;m_nNumPreviewPages = 2;        //Preview 2 pages at a time
// Set this value after calling DoPreparePrinting to override
// value read from registry
return bRet;
</code></pre>
<p class=tl>
The lines added here assign the value 2 to <code>m_nNumPreviewPages</code>. This causes Scribble to preview both pages of the document at once: the title page (page 1) and the drawing page (page 2). Note the value for <code>m_nNumPreviewPages</code> must be assigned after calling <code>DoPreparePrinting</code>, because <code>DoPreparePrinting</code> sets <code>m_nNumPreviewPages</code> to the number of preview pages used the last time the program was executed; this value is stored in the application’s registry entry.</P></li>
</ul>
</font></BODY>
</HTML>
