<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Basic Tasks for Adding Scrolling</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_gs_basic_tasks_for_adding_scrolling"></a>Basic Tasks for Adding Scrolling</h1>
<p>
The basic tasks for adding scrolling to your application are as follows:
<ol>
<li>
Define a size for your documents. This can be a constant, a member stored in each document object, or a value calculated at run time, for example.<br><br></li>
<li>
Derive your view class from <b>CScrollView</b> instead of <b>CView</b>.<p class=atl>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;In the <b>AppWizard&nbsp;–&nbsp;Step 6</b> dialog box, you have the option of changing your base class. You could have, for example, chosen <b>CScrollView</b> instead of <b>CView</b> at that point, thereby eliminating some of the steps in this procedure.</p></li>
<li>
Pass the document’s size to the <b>SetScrollSizes</b> member function of <b>CScrollView</b> whenever the size may change.<br><br></li>
<li>
Convert between logical coordinates and device coordinates if passing points between graphic device interface (GDI) and non-GDI functions.</li>
</ol>
<p>
The framework’s responsibilities are as follows:
<ul type=disc>
<li>
Handle all <b>WM_HSCROLL</b> and <b>WM_VSCROLL</b> messages, scroll the document in response, and move the scroll box accordingly. <p class=tl>
The positions of the scroll boxes reflect where the currently displayed portion of the document resides relative to the rest of the document:</P><ul type=disc>
<li>
If the user clicks a scroll arrow at either end of the scroll bar, the document scrolls one “line” (whose meaning depends on the document type).<br><br></li>
<li>
If the user clicks either side of the scroll box, the document scrolls one page.<br><br></li>
<li>
If the user drags the scroll box itself, the document scrolls accordingly.</li>
</ul>
</li>
<li>
Calculate a mapping between the lengths of the scroll bars and the height and width of the document, adjust this scaling factor when the window is resized or when the size of the document changes, and in turn remove or add scroll bars as needed. </li>
</ul>
<p>
The figure below shows Scribble with scroll bars added.</p>
<p class=label>
<b>Scribble with Scrolling Support</b></p>
<p>
<img src="ct0232s.gif" border=0></p>
</font></BODY>
</HTML>
