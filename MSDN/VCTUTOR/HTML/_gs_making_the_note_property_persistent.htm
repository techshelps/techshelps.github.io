<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Making the Note Property Persistent</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2">
<h1><a name="_gs_making_the_note_property_persistent"></a>Making the Note Property Persistent</h1>
<p>
To manage the persistence of the Note property and to initialize it to a default value when the Circle control is created, add a call to a <b>PX_</b> function in <code>DoPropExchange</code> in CIRCCTL.CPP. </p>
<p>
Add the following line to CIRCCTL.CPP:</p>
<pre><code>&nbsp;&nbsp;&nbsp;&nbsp;PX_String(pPX, _T("Note"), m_note, _T(""));
</code></pre>
<p>
as shown in the following code example:</p>
<pre><code>void CCircCtrl::DoPropExchange(CPropExchange* pPX)
{
 &nbsp;&nbsp; ExchangeVersion(pPX, MAKELONG(_wVerMinor, _wVerMajor));
 &nbsp;&nbsp; COleControl::DoPropExchange(pPX);

 &nbsp;&nbsp; PX_Bool(pPX, _T("CircleShape"), m_circleShape, TRUE);
 &nbsp;&nbsp; PX_Short(pPX, _T("CircleOffset"), m_circleOffset, 0);
 &nbsp;&nbsp; PX_Long(pPX, _T("FlashColor"), (long &amp;)m_flashColor, RGB(0xFF, 0x00, 0x00));
 &nbsp;&nbsp; PX_String(pPX, _T("Note"), m_note, _T(""));
}
</code></pre>
<p>
Since the Note property is of type <b>BSTR</b>, the <b>PX_String</b> function is used. The <code>m_note</code> member variable (which holds the Note property value) and a zero-length string (which is the default value for the Note property) are parameters to this function. As with all literal strings, the property name string and default value string are passed through the <b>_T</b> macro before being passed as parameters to the <b>PX_String</b> function.</p>
</font></BODY>
</HTML>
