<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Compiling Scribble's Help from the Development Environment</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2"><h1><a name="_gs_compiling_scribble.92.s_help_from_the_development_environment"></a>Compiling Scribble’s Help from the Development Environment</h1>
<p>
You can easily prepare Scribble to compile the new Help files from within the development environment, by performing the following two procedures.</p>
<p class=label>
<b>To add Scribble.hpj to the project</b>
<ol>
<li>
With your Scribble project open, from the <b>Project</b> menu, click <b>Add to Project</b>. Then click <b>Files</b>.<br><br></li>
<li>
In the <b>Insert Files into Project</b> dialog box, navigate to the \HLP directory underneath the Scribble project root directory and specify Scribble.hpj.<br><br></li>
<li>
Click <b>OK</b>.<p class=tl>
The file now appears under Source Files in FileView.</P></li>
</ol>
<p class=label>
<b>To add the HLP directory to the project</b>
<ol>
<li>
Select the name of the project (Scribble) in File View.<br><br></li>
<li>
Right click and select <b>New Folder</b> from the shortcut menu.<br><br></li>
<li>
Name the new folder Help Files.<br><br></li>
<li>
Right click on the Help Files folder and select <b>Add Files to Folder</b>.<br><br></li>
<li>
From the <b>Insert Files into Project</b> dialog box, select all the files in the HLP directory of the Scribble project.</li>
</ol>
<p>
When AppWizard adds context-sensitive Help support, it implements special build options for the application’s Help Project file. You can duplicate this functionality by specifying Custom Build settings for Scribble.hpj, Scribble.cnt and resource.h. Once you complete this step, you can build Scribble.hpj from within the development environment.</p>
<p class=label>
<b>To specify custom build settings</b>
<ol>
<li>
From the <b>Project</b> menu, choose <b>Settings</b>.<p class=tl>
The <b>Project Settings </b>dialog box opens. </P></li>
<li>
In the <b>Settings For</b> area, expand the Scribble icon and the Source Files folder and select Scribble.hpj.<p class=tl>
You can simultaneously select Scribble.hpj in both the Debug and Release project build types by clicking the combo box located above the <b>Settings For</b> area and clicking <b>All Configurations</b>.</P></li>
<li>
Click the <b>Custom Build</b> tab.<br><br></li>
<li>
In the <b>Build Command(s)</b> box, copy the following custom build rules into the Commands box:<pre><code>start /wait hcw /C /E /M "hlp\$(InputName).hpj"
if errorlevel 1 goto :Error
if not exist "hlp\$(InputName).cnt" goto :Error
if not exist "hlp\$(InputName).hlp" goto :Error
copy "hlp\$(InputName).hlp" $(OutDir)
goto :done
:Error
echo "hlp\$(InputName).hpj(1)" : error: Problem encountered creating help file
type "hlp\$(InputName).log"
:done
</code></pre>
</li>
<li>
In the <b>Output File(s)</b> edit box, type the following:<pre><code>$(OutDir)\$(InputName).hlp
</code></pre>
</li>
<li>
Select the Resource.h file and copy the following custom build rules into the Commands box:<pre><code>echo. &gt;&gt;"hlp\$(TargetName).hm"
echo // Commands (ID_* and IDM_*) &gt;&gt;"hlp\$(TargetName).hm"
makehm ID_,HID_,0x10000 IDM_,HIDM_,0x10000 resource.h &gt;&gt;"hlp\$(TargetName).hm"
echo. &gt;&gt;"hlp\$(TargetName).hm"
echo // Prompts (IDP_*) &gt;&gt;"hlp\$(TargetName).hm"
makehm IDP_,HIDP_,0x30000 resource.h &gt;&gt;"hlp\$(TargetName).hm"
echo. &gt;&gt;"hlp\$(TargetName).hm"
echo // Resources (IDR_*) &gt;&gt;"hlp\$(TargetName).hm"
makehm IDR_,HIDR_,0x20000 resource.h &gt;&gt;"hlp\$(TargetName).hm"
echo. &gt;&gt;"hlp\$(TargetName).hm"
echo // Dialogs (IDD_*) &gt;&gt;"hlp\$(TargetName).hm"
makehm IDD_,HIDD_,0x20000 resource.h &gt;&gt;"hlp\$(TargetName).hm"
echo. &gt;&gt;"hlp\$(TargetName).hm"
echo // Frame Controls (IDW_*) &gt;&gt;"hlp\$(TargetName).hm"
makehm IDW_,HIDW_,0x50000 resource.h &gt;&gt;"hlp\$(TargetName).hm"
</code></pre>
</li>
<li>
In the <b>Output File(s)</b> edit box, type the following:<pre><code>hlp\$(TargetName).hm
</code></pre>
</li>
<li>
Select the project’s .cnt file and copy the following custom build rules into the Commands box:<pre><code>copy "hlp\$(InputName).cnt" $(OutDir)
</code></pre>
</li>
<li>
In the <b>Output File(s)</b> edit box, type the following:<pre><code>$(OutDir)\$(InputName).cnt
</code></pre>
</li>
<li>
Click <b>OK</b>.<p class=tl>
You can now compile Scribble.hlp from the development environment anytime you need to update the contents of the Help Project files.</P></li>
</ol>
<p class=label>
<b>To compile Scribble Help from within the development environment</b>
<ol>
<li>
After completing the previous two procedures, in FileView, expand Source Files and select Scribble.hpj.<br><br></li>
<li>
From the <b>Build</b> menu, click <b>Compile Scribble.hpj</b>.</li>
</ol>
<p>
You can also simply build Scribble.exe at this point to see Scribble running with full application Help support.</p>
<p class=label>
<b><a name="_gs_to_try_out_scribbles_help"></a>To try out Scribble's Help</b>
<ol>
<li>
From the <b>Build</b> menu, click <b>Execute Scribble.exe</b>. Click <b>Yes</b> when prompted to build.<br><br></li>
<li>
From the <b>Help</b> menu, click <b>Help Topics</b>.<br><br></li>
<li>
In the <b>Contents</b> tab, expand the <b>Menus</b> heading, and double-click the <b>Pen</b> menu topic.<p class=tl>
This is the topic you added to Scribble’s Help system by editing the .CNT and .HPJ files. You’ll see the custom Help that has been provided in Pen.rtf.</P></li>
<li>
Return to the Scribble application, and press SHIFT+F1 to enter Help mode, then click one of the items on Scribble’s <b>Pen</b> menu.<p class=tl>
Help mode, invoked by pressing SHIFT+F1, is another way for users to access Scribble application Help topics.</P></li>
<li>
Click the <b>Index</b> and <b>Find</b> commands in the <b>Help Topics</b> dialog box to see the Windows Help interface.</li>
</ol>
</font></BODY>
</HTML>
