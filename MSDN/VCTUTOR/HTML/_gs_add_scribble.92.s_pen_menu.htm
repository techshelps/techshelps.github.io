<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Add Scribble's Pen Menu</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<font face="verdana,arial,helvetica" size="2"><h1><a name="_gs_add_scribble.92.s_pen_menu"></a>Add Scribble’s Pen Menu</h1>
<p>
Adding a new menu is similar to adding new commands to existing menus.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This procedure assumes you have “pinned” the Menu Properties window so that it remains open. </p>
<p class=label>
<b><a name="_gs_to_add_scribble.92.s_pen_menu"></a>To add Scribble’s Pen menu</b>
<ol>
<li>
With the menu-editor window still showing, click in the empty cell at the right-hand end of the Scribble menu bar (after the Help menu).<br><br></li>
<li>
To position the menu entry, drag the selected cell to the left and drop it between the Edit and View menus.<br><br></li>
<li>
Type the new menu’s caption: <code>&amp;Pen</code>.<p class=tl>
The caption appears simultaneously in the cell and in the <b>Caption</b> edit box of the <b>Menu Item Properties</b> window.</P></li>
<li>
Press ENTER to advance to the first menu item on the Pen menu (or click the empty cell that descends beneath the word “Pen”).<br><br></li>
<li>
Type this menu item’s caption: <code>Thick &amp;Line</code>.<p class=tl>
Move your cursor to the <b>ID</b> box in the <b>Menu Item Properties</b> window. You’ll notice that Visual C++ created an ID for you, based on the menu name and the menu item name: <code>ID_PEN_THICKLINE</code>. </P></li>
<li>
Modify this ID slightly, to <code>ID_PEN_THICK_OR_THIN</code>.<br><br></li>
<li>
In the <b>Prompt</b> box, type the following command prompt string:<pre><code>Toggles the line thickness between thin and thick 
</code></pre>
<p class=tl>
No default prompt string appeared because ID_PEN_THICK_OR_THIN is not a predefined command ID. </P></li>
<li>
Select the empty cell at the bottom of the Pen menu, below “Thick Line.” (You can also toggle between the <b>Menu Item Properties</b> window and the menu editor by pressing ENTER.)<br><br></li>
<li>
Type this menu item’s caption: <code>Pen &amp;Widths...</code>.<p class=tl>
An ellipsis (. . .) included in a menu item’s caption lets the user know that selecting the item opens a dialog box or a cascading menu.</P></li>
<li>
In the <b>ID</b> box, modify the Visual C++-generated ID slightly, to <code>ID_PEN_WIDTHS</code>.<br><br></li>
<li>
Type the following command prompt string:<pre><code>Sets the size of the thin and thick pen
</code></pre>
</li>
<li>
Close the menu editor and save your work.</li>
</ol>
<p>
The following figure shows the completed menu as it appears in the menu editor.</p>
<p class=label>
<b>The Completed Pen Menu</b></p>
<p>
<img src="ct0216s.gif" border=0></p>
<p>
Typically, at this point you would use ClassWizard or WizardBar to bind the menu commands to message-handler functions. That step is postponed until the next lesson in order to keep this lesson focused on constructing the user interface. If you like, you can skip ahead, perform the command-binding steps in <a href="_gs_binding_visual_objects_to_code_using_wizardbar.htm">Binding Visual Objects to Code Using WizardBar</a>, and then return to this lesson to <a href="_gs_edit_scribble.92.s_toolbar.htm">edit Scribble’s toolbar</a>. </p>
</font></BODY>
</HTML>
