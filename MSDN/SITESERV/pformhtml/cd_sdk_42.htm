<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CLSID Property</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="cd_replicationeventsinkconfig_clsid_property"></a>CLSID Property</h1>
<p>
This property specifies either the CLSID or ProgID of the event sink.</p>
<p>
<b>Syntax</b></p>
<p>
<i>ReplicationEventSinkConfig</i><b>.CLSID</b>[=<i>ID</i>]</p>
<p>
<b>Parameters</b></p>
<p class=dt>
<i>ID</i></p>
<p class=indent>
The ProgID or CLSID of the event sink. The following ProgIDs are defined for the built-in event sinks: </p>
<p class=dt>
CRSLocalEvents</p>
<p class=indent>
The local OLEDB event sink.</p>
<p class=dt>
Crssink</p>
<p class=indent>
The local store and forward Content Deployment event sink.</p>
<p class=dt>
Mail</p>
<p class=indent>
The event sink for mail.</p>
<p class=dt>
NT</p>
<p class=indent>
The NT event sink.</p>
<p>
<b>Remarks</b></p>
<p>
You must have Site Server Publishing administrator privileges on the server to get or set this property.</p>
<p>
The <b>ReplicationEventSinkConfig</b><i> </i>object can be either a user-defined event sink object or one of the installed Content Deployment event sinks, such as the OLEDB event sink or the Content Deployment event sink. You must set the CLSID property when you create your own event sink. </p>
<p>
<b>Example</b></p>
<p>
The following example adds Project1's events to those that the NT event sink monitors and commits the change.</p>
<pre><code>Option Explicit 
On Error Resume Next

const CRS_ERROR_NO_MORE_ITEMS&nbsp; = 0&amp;80003B17

dim ReplServer
set ReplServer = CreateObject("CrsApi.ReplicationServer")
ReplServer.Initialize("")

dim Iterator
Iterator = 0
dim EvSink

do while True
  'Clear any error text
  Err.Clear
  'Get an event sink
  set EvSink = ReplServer.EnumEventSinks(Iterator)

  'Quit if empty object returned (no more instances)
  if IsEmpty(EvSink) then exit do

  'Quit if "No more items" error 
  dim ReplError
  ReplError = Err.Number
  if ReplError = CRS_ERROR_NO_MORE_ITEMS then exit do

  dim CLSID
  CLSID = EvSink.CLSID
  if CLSID = "NT" then
 &nbsp;&nbsp; EvSink.ProjectFilter("Project1")
 &nbsp;&nbsp; EvSink.Commit
 &nbsp;&nbsp; exit do
  end if
Loop

'Release objects
set EvSink&nbsp;&nbsp;&nbsp;&nbsp; = Nothing
set ReplServer = Nothing
</code></pre>
<p>
<b>See Also</b></p>
<p>
<a href="cd_sdk_156.htm">ReplicationServer.AddEventSink</a>, <a href="cd_sdk_166.htm">ReplicationServer.EnumEventSinks</a></p>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
</BODY>
</HTML>
