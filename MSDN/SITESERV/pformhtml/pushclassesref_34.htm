<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Defining A Custom XML Element</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="pu_common_collections_elements_defining_a_custom_xml_element"></a>Defining A Custom XML Element</h1>
<p>
The <b>Dictionary</b> class object can define an XML element when placed in an <b>Elements</b> collection for a supporting object. Normally, a programmer would simply use the <b>AddElement</b> method to add an XML element to the collection of a particular object. This sets the name of the element, and optionally, the content. However, adding attributes requires adding extra key/value pairs to the corresponding <b>Dictionary</b> object. The name and content of the element use two predefined keys that are required when building the element's CDF string. The predefined keys used to define the element are listed below.</p>
<table border=0 cellpadding=5 cols=3 frame=below width=563>
<tr valign=top>
<td width=19%><b>Key</b></td>
<td width=30%><b>Value</b></td>
<td width=51%><b>Value Type</b></td>
</tr>
<tr valign=top>
<td width=19%>Tag</td>
<td width=30%>This value becomes the name of the XML element.</td>
<td width=51%>String. The string should comply with the XML specification on naming elements.</td>
</tr>
<tr valign=top>
<td width=19%>Content</td>
<td width=30%>This value becomes the content of the element.</td>
<td width=51%>String.</td>
</tr>
</table><br>
<p>
<i>All other key value pairs become attribute and value pairs for the element.</i></p>
<p>
A programmer must be careful not to overwrite the contents indexed under "tag" and "content," as they are reserved and may not be used as names for attributes in this case. When the element's CDF string is built, the value under "tag" always becomes the name of the element, and the value under "content" always becomes the content of the element. All other key/value pairs always become attribute and value pairs for the element.</p>
<p>
<b>Example</b></p>
<p>
As an example, we will add the following XML element to a <b>Channel</b> object:</p>
<pre><code>&lt;THIS ATTRIB1=VAL1 ATTRIB2=VAL2&gt;
This is some content
&lt;/THIS&gt;</code></pre>
<p>
The following key/value pairs would define this element in a <b>Dictionary</b> object.</p>
<table border=0 cellpadding=5 cols=2 frame=below width=366>
<tr valign=top>
<td width=27%><b>Key</b></td>
<td width=73%><b>Value</b></td>
</tr>
<tr valign=top>
<td width=27%>Tag</td>
<td width=73%>"THIS"</td>
</tr>
<tr valign=top>
<td width=27%>Content</td>
<td width=73%>"This is some content"</td>
</tr>
<tr valign=top>
<td width=27%>"attrib1"</td>
<td width=73%>"VAL1"</td>
</tr>
<tr valign=top>
<td width=27%>"attrib2"</td>
<td width=73%>"VAL2"</td>
</tr>
</table><br>
<p class=indent>
<b>Note</b>&nbsp;&nbsp;&nbsp;The keys "attrib1" and "attrib2" are shown in lowercase specifically. This is because the <b>Dictionary</b> object stores all keys in lower case internally. Thus, "ATTRIB1", "attrib1", and "AtTrIb1" all refer to the same key. The parent object converts the keys to upper case when it creates the CDF string for the element.</p>
<p>
The code below demonstrates the process of defining the XML element above in VBScript by using the <b>Channel</b> object. Since the <b>Dictionary</b> class <i>is not</i> a bona fide COM class, we cannot directly create an instance. We must use the <b>AddElement</b> method to get started.</p>
<pre><code>Set Element = Channel.AddElement("this","this is some content")
Element("attrib1")="VAL1"
Element("attrib2")="VAL2"</code></pre>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
</BODY>
</HTML>
