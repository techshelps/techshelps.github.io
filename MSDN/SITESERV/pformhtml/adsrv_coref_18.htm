<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RecordEvent Method</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="ad_recordevent_method"></a>RecordEvent Method</h1>
<p>
The <b>RecordEvent </b>method<b> </b>logs both ad requests and clicks to the Internet Information Server's log.</p>
<p>
<b>Syntax</b></p>
<p>
<i>AdServerObject</i><b>.RecordEvent (</b>[<i>Response</i>]<i>, </i>[<i>CampaignItemID</i>]<i>,</i><b> </b><i>EventType</i><b>)</b></p>
<p>
<b>Parameters</b></p>
<p class=dt>
<i>Response </i></p>
<p class=indent>
Optional. The ASP built-in <b>Response</b> object, used to log ad events to the IIS log file.</p>
<p class=dt>
<i>CampaignItemID</i></p>
<p class=indent>
Optional. A long Variant specifying the number of the campaign item being logged.</p>
<p class=dt>
<i>EventType</i></p>
<p class=indent>
A string Variant containing either "IMPR" (for impressions) or "CLIK" (for click events). </p>
<p>
<b>Remarks</b></p>
<p>
Usually you will not need to use this method directly. The method is used in the AdRedir.asp page. In this page, the <i>CampaignItemID </i>is provided in the string returned by the <b>GetAd</b> method for ads that can be clicked.</p>
<p>
Impression events are logged automatically by the <b>GetAd</b> method, so that “IMPR” never needs to be passed in directly as an <i>EventType</i> argument.</p>
<p>
In order for the <b>RecordEvent</b> method to log the click event, you must set the logging properties for the Web site to enable URI Query. </p>
<p>
<b>Example</b></p>
<p>
The following example shows the entire AdRedir.asp file. When the visitor clicks an ad, the visitor’s browser is redirected to this script. This script logs the click event into the IIS log using the <b>RecordEvent</b> method before redirecting the visitor’s browser to the click-through page for the ad using the <b>Redirect</b> method of the <b>Response</b> object.</p>
<p>
The ciid argument is the campaign item identifier, returned by the <b>GetAd</b> method in creating the URL and query string passed to this page.</p>
<pre><code>&lt;%
 Set Ad = Application("Ad")
 ciid = Request.Querystring("ciid")
 url = Request.Querystring("url")
 evt = Request.Querystring("evt")
 if evt = "" then evt = "CLIK"
 call Ad.RecordEvent(Response, ciid, evt)
 Response.Redirect(Request.QueryString("url"))
%&gt;
</code></pre>
<p>
<b>See Also</b></p>
<p>
<a href="adsrv_coref_8.htm">RedirectURL</a>, <u>GetAd</u></p>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
</BODY>
</HTML>
