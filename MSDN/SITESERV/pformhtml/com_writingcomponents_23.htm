<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sample Templates</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h3><a name="com_writingcomponents_ejqd"></a>Sample Templates</h3>
<p>
A majority of the pipeline components included with Commerce Server 3.0 implement <b>IPipelineComponentAdmin</b> to support setting component properties using a configuration <b>Dictionary</b>. Consequently, for examples of how to build ASP-based property pages for components that implement this interface, you can refer to the ASP source for any of the Commerce Server for examples of how to build the edit and post pages for your component.</p>
<p>
If your component exposes its properties by implementing Automation properties, you can use the template.asp and template_post.asp files as examples of how to create your property pages. These files are included in the \Microsoft Site Server\SiteServer\Admin\Commerce\Pipeline Configuration directory.</p>
<p>
The following is the text of the template.asp file.</p>
<pre><code>&lt;%@ LANGUAGE = VBScript %&gt;
&lt;% REM############################################################ %&gt;
&lt;% REM                                                                           %&gt;
&lt;% REM   TEMPLATE.ASP                                                            %&gt;
&lt;% REM   Microsoft Commerce Server v3.00                                         %&gt;
&lt;% REM   Commerce Order Pipeline Editor                                          %&gt;
&lt;% REM                                                                           %&gt;
&lt;% REM   Copyright (c) 1996-98 Microsoft Corporation.  All rights &lt;%reserved.      %&gt;
&lt;% REM                                                                           %&gt;
&lt;% REM ############################################### %&gt;

&lt;!--#INCLUDE FILE="pe_3rd_party_edit_header.asp" --&gt;

field: &lt;INPUT TYPE="TEXT" NAME="field" SIZE="70" VALUE="&lt;%= ComponentConfig.field %&gt;"&gt;

&lt;!--#INCLUDE FILE="pe_3rd_party_edit_footer.asp" --&gt;
</code></pre>
<p>
The <b>ComponentConfig</b> object referenced on this page represents an instance of the component being configured, and field represents the name of the component’s dispatched property. For example, the <b>MinMaxShip</b> component dispatches the <b>MinShipping</b> and <b>Percentage</b> properties. To configure this component, the text above might be changed as follows:</p>
<pre><code>field: &lt;INPUT TYPE="TEXT" NAME="MinShipping" SIZE="70" VALUE="&lt;%= ComponentConfig.MinShipping %&gt;"&gt;

field: &lt;INPUT TYPE="TEXT" NAME="Percentage" SIZE="70" VALUE="&lt;%= ComponentConfig.Percentage %&gt;"&gt;
</code></pre>
<p>
The template_post.asp simply retrieves the values of the form fields submitted from the template.asp, and assigns the components dispatched properties the appropriate values.</p>
<pre><code>&lt;%@ LANGUAGE = VBScript %&gt;
&lt;% REM ################################################################# %&gt;
&lt;% REM                                                            %&gt;
&lt;% REM   TEMPLATE_POST.ASP                                                       
&lt;% REM   Microsoft Commerce Server v3.00                            %&gt;
&lt;% REM   Commerce Order Pipeline Editor                           %&gt;
&lt;% REM                                                            %&gt;
&lt;% REM   Copyright (c) 1996-98 Microsoft Corporation.  All %&gt;
&lt;% REM     rights reserved.

&lt;% REM ############################################################## %&gt;

&lt;!--#INCLUDE FILE="pe_3rd_party_post_header.asp" --&gt;

&lt;%
field = mscsPage.RequestString("field", null, 1, 255)
if IsNull(field) then
    errorList.Add "field must be a string between 1 and 255 characters in length"
else
    ComponentConfig.field = field
end if
%&gt;

&lt;!--#INCLUDE FILE="pe_3rd_party_post_footer.asp" --&gt;
</code></pre>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
