<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TableShippingADO</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_tools_axlb"></a><sup></sup>TableShippingADO</h2>
<p>
The <b>TableShippingADO</b> component, which appears in the Shipping stage of an order processing pipeline, sets the value of <code>_shipping_total</code> on the order form by using values retrieved from the database.
<ul>
<li>
&upsilon;<b>Key</b>. (Read-only) The name of a property on the order form used to specify shipping method. The value of this property is compared to the string specified in the <b>Method</b> field to determine whether to apply the shipping charge to the order.</li>
<li>
&upsilon;<b>Apply when</b>. Specifies when to apply the shipping charge.<ul>
<li>
&upsilon;<b>Equal to Method</b>. Specifies that the shipping charge should be applied if the value of the field specified for <b>Key</b> is the same as the string specified in the <b>Method</b> field. </li>
<li>
&upsilon;<b>Has Any Value</b>. Specifies that the shipping charge should be applied when the value of the field specified for <b>Key</b> has any value on the order form. If you select this option, the <b>Method</b> field should be left blank.</li>
<li>
&upsilon;<b>Always</b>. Specifies that the shipping charge is always applied to the order.</li>
</ul>
</li>
<li>
&upsilon;<b>Method</b>. If <b>Equal to Method</b> is selected, specifies a string that the component compares with the value of <b>shipping_method</b> on the order form to determine whether to apply the shipping charge to the order. The shipping charge will be applied only if there is an exact match.</li>
<li>
&upsilon;<b>Connection string</b>. Specifies the connection string used for connecting to the database. The connection string must include either the full connection string (the data source name (DSN), database login ID, and database password) or the name of a named connection stored in the connection map. If this field is blank, the default connection string is used.</li>
<li>
&upsilon;<b>Query</b>. Specifies either the full SQL text of the query that is executed by this component or the name of a query whose full SQL text is defined in the site’s global.asa file.</li>
<li>
&upsilon;<b>Parameter List</b>. A space-delimited list of parameters for the query identified in the <b>Query</b> setting.</li>
<li>
&upsilon;<b>Column</b>. Specifies the name of the column in the database that contains the shipping charge.</li>
</ul>
<h4>Remarks</h4>
<p>
The combination of the <b>Key</b>, <b>Apply when</b>, and <b>Method</b> fields determine whether the shipping charge should be applied to the order.</p>
<p>
The <b>TableShippingADO </b>component first checks the <b>Apply when </b>value. If it is set to <b>Always</b>, the shipping charge is always applied to the order. If <b>Apply when</b> is set to <b>Has any value</b>, the shipping charge is applied to the order whenever the order form contains any value for <code>shipping_method</code>. If <b>Apply when</b> is set to <b>Equal to Method</b>, the component does a comparison between the value of <code>shipping_method</code><b> </b>on the order form and the text string in the <b>Method</b> field on this property page. If there is a match, the shipping charge is applied.</p>
<p>
If the component determines that the shipping charge should be applied, it then executes the query specified in <b>Query</b>, which retrieves the shipping charge from the database column specified in <b>Column</b>. The component then computes the shipping charge.</p>
<p>
The <b>Parameter List</b> is used to specify parameters to the query, which usually include a basis for the table lookup. The basis can be total cost of the order, or a merchant-defined value such as weight.</p>
<p>
For parameters, you can use any of the following values.</p>
<table cellspacing=4 cols=2 width=464>
<tr valign=top>
<th align=left width=29%>Basis Item Key prefix</th>
<th align=left width=71%>Description</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%></td>
</tr>
<tr valign=top>
<td width=29%><code>order.<i>fieldname</i></code></td>
<td width=71%>The value of the specified field, where <i>fieldname </i>is a property on the order form.</td>
</tr>
<tr valign=top>
<td width=29%><code>sum.<i>fieldname</i></code></td>
<td width=71%>The sum of value of the specified field for each item, where <i>fieldname </i>is a property in the item list.</td>
</tr>
<tr valign=top>
<td width=29%><code>sumq.<i>fieldname</i></code></td>
<td width=71%>The sum of value of the specified field for each item, where <i>fieldname </i>is a property in the item list, times the quantity of that item.</td>
</tr>
<tr valign=top>
<td width=29%><code>count</code></td>
<td width=71%>The number of line items in the order form. (Does not depend on quantity of each item.)</td>
</tr>
</table><br>
<p>
The following table illustrates some useful values for <b>Basis Item Key</b>:</p>
<table cellspacing=4 cols=2 width=464>
<tr valign=top>
<th align=left width=48%>Example Basis Item Key</th>
<th align=left width=52%>Result</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%></td>
</tr>
<tr valign=top>
<td width=48%><code>order._oadjust_subtotal</code></td>
<td width=52%>Subtotal on the order form.</td>
</tr>
<tr valign=top>
<td width=48%><code>sum.quantity</code></td>
<td width=52%>Sum of all quantities (total number of items ordered).</td>
</tr>
<tr valign=top>
<td width=48%><code>sum._oadjust_adjustedprice</code></td>
<td width=52%>Sum of adjusted prices.</td>
</tr>
<tr valign=top>
<td width=48%><code>sumq._iadjust_currentprice</code></td>
<td width=52%>Sum of current price times quantity for all items in the order.</td>
</tr>
<tr valign=top>
<td width=48%><code>sumq._product_weight</code></td>
<td width=52%>Total weight of order. (Assumes that the <code>weight</code> column exists in the product table, and that the query used by <b>QueryProdInfoADO</b> includes this field.)</td>
</tr>
</table><br>
<p>
For example, if <code>sumq._product_weight </code>is specified, and if the order has two items, one item weighing 2 pounds with a quantity of 3 and the other item weighing 4 pounds with a quantity of 1, then the basis value is 10 pounds.</p>
<h4>Related Topics</h4>
<ul>
<li>
&upsilon;<a href="com_opp_28.htm">How to use Table Shipping</a></li>
</ul>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
