<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Commit Method</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="cd_replicationproject_commit_method"></a>Commit Method</h1>
<p>
This method commits changes for a project.</p>
<p>
<b>Syntax</b></p>
<p>
<i>ReplicationProject</i><b>.Commit</b></p>
<p>
<b>Remarks</b></p>
<p>
You must have Site Server Publishing administrator privileges on the server to call this method. </p>
<p>
You must use this method to initialize a new project. There are a number of required parameters and properties that you must set before you can call the <b>Commit</b> method. All of the parameters and properties are described in the Parameters topic. The required parameters and properties are described in the following table.</p>
<table border=0 cellpadding=5 cols=3 frame=below width=587>
<tr valign=top>
<td colspan=2 width=79%><b>Required Parameters and Properties for Push Projects</b></td>
</tr>
<tr valign=top>
<td width=40%><b>Name</b></td>
<td colspan=2 width=60%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=40%>ReplicationMethod</td>
<td colspan=2 width=60%>Set this property to "SENDINET" for Push projects. </td>
</tr>
<tr valign=top>
<td width=40%>Destination</td>
<td colspan=2 width=60%>This parameter is a list of the names of all servers to receive the replication. Can be Empty ("") if there is no destination. If creating a project using routes, it must be the name of the route. The list cannot exceed 4096 characters. Microsoft recommends that you use the <b>ReplicationProject.AddDestination</b>, <b>ReplicationProject.EnumDestination</b>, and <b>ReplicationProject.RemoveDestination </b>methods to add, list, and remove a destination, respectively.</td>
</tr>
<tr valign=top>
<td width=40%>LocalDirectory</td>
<td colspan=2 width=60%>This property is the (Unicode) name of the local directory used to send or receive the content. Cannot be Empty ("").</td>
</tr>
<tr valign=top>
<td width=40%>Flags</td>
<td colspan=2 width=60%>This property is a long array of bitmapped values (see the Flags appendix)</td>
</tr>
<tr valign=top>
<td colspan=2 width=79%><b>Required Parameters and Properties for Pull Projects</b></td>
</tr>
<tr valign=top>
<td width=40%><b>Name</b></td>
<td colspan=2 width=60%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=40%>ReplicationMethod</td>
<td colspan=2 width=60%>Set this property to "PULL"&nbsp; for Pull projects. </td>
</tr>
<tr valign=top>
<td width=40%>RootUrl</td>
<td colspan=2 width=60%>This parameter is the URL from which to pull data; for example, “http://www.microsoft.com/”.</td>
</tr>
<tr valign=top>
<td width=40%>LocalDirectory</td>
<td colspan=2 width=60%>This property is the name of the local directory to store the information. Cannot be Empty ("").</td>
</tr>
<tr valign=top>
<td width=40%>Depth</td>
<td colspan=2 width=60%>This parameter is the depth of the replication. For HTTP, this is the number of times to follow links from the root page. For FTP, this is the depth to go in the directory structure.</td>
</tr>
</table><br>
<p>
<b>Example</b></p>
<p>
The following example specifies that the new project MyProject pulls Web pages from http://www.microsoft.com/ to C:\LocalCopy, going as much as three levels deep. </p>
<pre><code>Option Explicit
On Error Resume Next

const CREATE_NEW_PROJECT = 1

dim ReplServer
set ReplServer = CreateObject("CrsApi.ReplicationServer")
ReplServer.Initialize("")

'Create new pull project, FromMS
dim ReplProject
set ReplProject = ReplServer.OpenProject("FromMS", CREATE_NEW_PROJECT)
ReplProject.ReplicationMethod = "PULL"
ReplProject.Put("RootUrl", "http://www.microsoft.com/")
ReplProject.LocalDirectory = "C:\LocalCopy"
ReplProject.Put("Depth", "3"
ReplProject.Commit

'Release objects
set ReplProject = Nothing
set ReplServer&nbsp; = Nothing
</code></pre>
<p>
<b>See Also</b></p>
<p>
<a href="cd_sdk_177.htm">ReplicationServer.OpenProject</a></p>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
</BODY>
</HTML>
