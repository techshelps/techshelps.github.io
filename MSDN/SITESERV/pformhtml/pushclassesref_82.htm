<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Dispinterface IManager GetAgents Method</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="pu_manager_class_methods_getagents"></a>GetAgents Method</h1>
<p>
The <b>GetAgents</b> method returns a class <b>Dictionary</b> object's dispinterface. The keys are names of installed agents and the associated values are arrays (SAFEARRAYS) of configuration information for the agent. </p>
<p>
<b>VBScript Syntax</b></p>
<pre><code><i>IManager</i><b>.GetAgents</b></code></pre>
<p>
<b>Parameters </b></p>
<p>
None </p>
<p>
<b>Return Value </b></p>
<p>
The <b>IDictionary</b> dispinterface.</p>
<p>
<b>Remarks </b></p>
<p>
The <b>Dictionary</b> object stores key/value pairs that describe the various installed agents. Each key is a name of an agent, and each value is an array (SAFEARRAY) with six elements that define the agent. The table below lists the items in the order in which they appear in the array.</p>
<p>
All information returned in the array by this method is contained in the registry at key HKLM\Software\Microsoft\Site Server\3.0\Active Channel Agents. Each agent name is a subkey, and the six values associated are the named values stored under the key.</p>
<p>
&nbsp;</p>
<table border=0 cellpadding=5 cols=3 frame=below width=587>
<tr valign=top>
<td width=17%><b>Array Index</b></td>
<td width=27%><b>Reg Key named value</b></td>
<td width=56%><b>Description of indexed value</b></td>
</tr>
<tr valign=top>
<td width=17%>0</td>
<td width=27%>ASP Property Page</td>
<td width=56%>This ASP page is used by the WebAdmin tool to set options for this agent.</td>
</tr>
<tr valign=top>
<td width=17%>1</td>
<td width=27%>ASP Wizard Page</td>
<td width=56%>This ASP page is used by the WebAdmin tool to start the agent options wizard.</td>
</tr>
<tr valign=top>
<td width=17%>2</td>
<td width=27%>COM Property Sheet</td>
<td width=56%>This value is a GUID identifying the COM class that implements an <b>IPropertySheet</b> interface. This class is "bootstrapped" by the MMC tool when a user requests to set options for this agent. </td>
</tr>
<tr valign=top>
<td width=17%>3</td>
<td width=27%>Display Name</td>
<td width=56%>This value is the display name for the agent.</td>
</tr>
<tr valign=top>
<td width=17%>4</td>
<td width=27%>Script Language</td>
<td width=56%>This value specifies the scripting language that the Active Scripting Host should use to run the agent.</td>
</tr>
<tr valign=top>
<td width=17%>5</td>
<td width=27%>Script Pathname</td>
<td width=56%>This value specifies the path to the agent script.</td>
</tr>
</table><br>
<p>
<b>Example </b></p>
<pre><code>' Using Windows Scripting Host and VBScript
Option Explicit
Dim Agents
Dim Manager
Dim Items

Set Manager = CreateObject("Push.Manager")
Set Agents = Manager.GetAgents
For Each Agent in Agents
  wscript.echo "Agent Name: " &amp; Agent
  wscript.echo "Agents definition items: "
  Items = Agents(Agent)
  For i = LBOUND(Items) to UBound(Items)
 &nbsp; wscript.echo Items(i)
  Next
Next</code></pre>
<p>
<b>See Also</b></p>
<p>
<a href="pushclassesref_145.htm">Class Dictionary</a></p>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
</BODY>
</HTML>
