<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ConfigurationCacheHelper Object Overview</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_compref_krmh"></a>ConfigurationCacheHelper Object Overview</h2>
<p>
The <b>ConfigurationCacheHelper</b> object enables a pipeline configuration to be cached in memory for any subsequent load operation, helping to reduce the performance penalty associated with accessing a pipeline configuration (.pcf ) on disk.</p>
<h5>Note</h5>
<p>
The actual performance benefits obtained by using the configuration cache helper depend on your specific configuration. To properly assess this benefit, measure the results in your production environment.</p>
<p>
A pipeline configuration can be saved in cache from a loaded pipeline by using the <b>SaveToCache</b> method, and later retrieved into a new instance of a pipeline by using the <b>LoadFromCache</b> method.</p>
<p>
The following example shows an ASP file creating, loading, and executing a pipeline, using the configuration cache helper. The script attempts to retrieve a cached configuration. If the requested configuration has not yet been cached, the script loads the configuration from the Plan.pcf configuration file, and then saves the configuration in the cache for future use.</p>
<pre><code>REM  Create the pipeline
Set pipeline = Server.CreateObject("Commerce.MtsPipeline")
if VarType(pipeline) &lt;&gt; vbObject then
    Response.Write "Failed to create the pipeline&lt;P&gt;"
end if
REM Response.Write "Created the pipeline&lt;BR&gt;"

set cacheHelper = Server.CreateObject("Commerce.ConfigurationCacheHelper")
if VarType(cacheHelper) &lt;&gt; vbObject then
    Response.Write "Failed to create the ConfigurationCacheHelper&lt;P&gt;"
end if

on error resume next
cacheHelper.LoadFromCache pipeline, Application("PlanCache")
if Err.Number &lt;&gt; 0 then
    REM  likely that cache has not been initialized
    REM  so load the configuration from file
        pipeline.LoadPipe "c:\Inetpub\wwwroot\mysite\config\Plan.pcf"

    REM  Save the pipeline configuration into the cache for next time
    Application("PlanCache") = cacheHelper.SaveToCache(pipeline)    
end if

REM  Execute the pipeline
pipeline.Execute 1, orderform, ordercontext, 1
if Err.Number &lt;&gt; 0 then
    errnum = Err.Number
    errdesc = Err.description
    Response.Write "Error " &amp; errnum &amp; " (" &amp; errdesc &amp; ") executing the pipeline&lt;P&gt;"
end if

pipeline = None
</code></pre>
<p>
Alternatively, the configuration cache could be created in the Global.asa, so that each page could assume that the configuration is already present in the cache and would not need to have any code to load from the .pcf file.</p>
<p>
If the configuration cache helper is used, the following script should be added to the site’s Global.asa to delete the configuration cache entry and reclaim the memory when the application ends:</p>
<pre><code>Sub Application_OnEnd
   REM  ... other code
Set pipeline = Server.CreateObject("Commerce.MtsPipeline")
if VarType(pipeline) &lt;&gt; vbObject then
    goto ErrorRet
end if
set cacheHelper = Server.CreateObject("Commerce.ConfigurationCacheHelper")
if VarType(cacheHelper) &lt;&gt; vbObject then
    goto ErrorRet
end if

on error resume next
cacheHelper.DeleteCacheEntry pipeline, Application("PlanCache")

pipeline = None

End Sub
</code></pre>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
