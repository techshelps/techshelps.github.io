<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adapting WSH Examples for ASP</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="sr_adapting_wsh_examples_for_asp"></a>Adapting WSH Examples for ASP </h1>
<p>
Although the interface reference examples are written for the Windows Scripting Host (WSH), you can easily adapt them for Active Server Pages (ASP). The first step is to wrap the VBScript code in the ASP delimiters (&lt;% and %&gt;), as in the following example:</p>
<table border=0 cellpadding=5 cols=2 frame=below width=600>
<tr valign=top>
<td width=49%><b>WSH File</b></td>
<td width=51%><b>ASP File</b></td>
</tr>
<tr valign=top>
<td width=49%><pre><code>&nbsp;</code><pre><code>Option Explicit 
On Error Resume Next 
Dim objSearchAdmin 
Set objSearchAdmin = _
CreateObject("Search.SearchAdmin.1") 
... 
'Release objSearchAdmin object 
Set objSearchAdmin = Nothing </code></pre>
</pre>
</td>
<td width=51%><pre><code>&lt;% </code><pre><code>Option Explicit 
On Error Resume Next 
Dim objSearchAdmin 
Set objSearchAdmin = _
CreateObject("Search.SearchAdmin.1") 
... 
'Release objSearchAdmin object 
Set objSearchAdmin = Nothing 
%&gt;</code></pre>
</pre>
</td>
</tr>
</table><br>
<p>
Also, to produce output, you must change the <b>Wscript.Echo</b> methods to <b>Response.Write</b> methods. </p>
<p class=indent>
<b>Note</b>&nbsp;&nbsp;&nbsp;Since ASP files default to the VBScript programming language, you need not supply a language qualifier to your VBScript ASP pages. If you use a different language, such as JScript, you must amend the first line of the previous ASP example to the following: </p>
<pre><code>&lt;% SCRIPT LANGUAGE="JScript"
 </code></pre>
<p>
ASP files offer some additional functionality over WSH files. For example, you can create an include file in which can place commonly-used code, such as the following defined constants, which specify the error codes you receive if Search cannot create the object or the object does not exist: </p>
<pre><code>Const E_CREATEOBJECT&nbsp; = 429   ' cannot create object 
Const E_NOTEXIST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 424   ' object doesn't exist 
 </code></pre>
<p>
You can then include this file in an ASP file with a line of code similar to the following, where SearchInclude.inc is the name of the include file (it can be any legal file name and need not have the .inc file extension): </p>
<pre><code>&lt;!--#include file = "SearchInclude.inc"--&gt;
</code></pre>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
</BODY>
</HTML>
