<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Appendix A: Implementing IPersistXML, IPersistStreamInit, or IPersistStream</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="com_cic_wfup"></a><sup></sup>Appendix A: Implementing IPersistXML, IPersistStreamInit, or IPersistStream</h1>
<p>
If you are using the Commerce Interchange Pipeline (CIP) <b>MapToXML</b> and <b>MapFromXML</b> components, then the <code>OBJECT</code> name/value pair in the Transport Dictionary must reference an object that implements <b>IPersistXML</b>, <b>IPersistStream</b>, or <b>IPersistStreamInit</b> interface. The Commerce Server <b>SimpleList</b>, <b>Dictionary</b>, and <b>OrderForm</b> objects implement these interfaces.</p>
<p>
If you map a business data object as binary data, the CIP mapping components check to see if the business data object implements <b>IPersistStream</b> or <b>IPersistStreamInit</b>. Although there is no limit on how deeply objects referenced within the business data object may be nested, both the root object and all nested object must implement one of these interfaces, or an error is raised.</p>
<p>
If you map a business data object as XML, the CIP mapping components first attempt to get the business data object’s implementation of <b>IPersistXML</b>. If the object does not support <b>IPersistXML</b>, the mapping components attempt to get the business data object’s <b>IPersistStreamInit</b> or <b>IPersistStream</b> implementation (in that order). If the object (or nested object) implements one of these interfaces, the mapping component uses that implementation to save/load the object and its direct links to other objects. In this case also, there is no limit on how deeply objects referenced in the business data object can be nested.</p>
<p>
If you use a <b>SimpleList</b>, <b>OrderForm</b>, or <b>Dictionary</b>, be aware that these object’s implementations of <b>IPersistXML</b>/<b>IPersistStreamInit</b> do not persist the following types of data:
<ul>
<li>
&upsilon;Error Objects</li>
<li>
&upsilon;VARIANTs of type VT_EMPTY or VT_NULL.</li>
<li>
&upsilon;References.</li>
<li>
&upsilon;SAFEARRAYs.</li>
<li>
&upsilon;Sub-objects that do not themselves implement <b>IPersistXML</b> or <b>IPersistStreamInit</b>. For example, if a name/value pair in a Dictionary references an object that does not support one of these interfaces, the Dictionary will be mapped, but the referenced object’s data will not.</li>
</ul>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
