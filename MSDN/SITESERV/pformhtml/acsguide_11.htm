<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Objects to Store Content Data</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="pu_guide_using_the_objects_to_store_content_data"></a>Using the Objects to Store Content Data</h1>
<p>
The following example shows how to construct the CDF string listed below:</p>
<pre><code>&lt;?XML version="1.0"?&gt;

&lt;CHANNEL HREF="http://www.mysite.com/Channel/homepage.htm"
    BASE="http://www.mysite.com/Channel/"&gt;
   &lt;TITLE&gt;Sample "Color" Channel&lt;/TITLE&gt;
   &lt;ABSTRACT&gt;The sample color channel contains a red, green, and blue page for viewing.&lt;/ABSTRACT&gt;
   &lt;LOGO HREF="logo_big.gif" STYLE="IMAGE-WIDE"/&gt;
   &lt;LOGO HREF="logo_med.gif" STYLE="IMAGE"/&gt;
   &lt;SCHEDULE STARTDATE="1997-09-23"&gt;
      &lt;INTERVALTIME DAY="1" /&gt;
      &lt;EARLIESTTIME HOUR="2" /&gt;
      &lt;LATESTTIME HOUR="6" /&gt;
   &lt;/SCHEDULE&gt;
 &nbsp;    &lt;ITEM HREF="page1.htm"&gt;
      &lt;LOGO HREF="red.gif" STYLE="ICON"/&gt;
      &lt;TITLE&gt;The Red Page&lt;/TITLE&gt;
      &lt;ABSTRACT&gt;This is the abstract description for the red page.&lt;/ABSTRACT&gt;
   &lt;/ITEM&gt;
   &lt;ITEM HREF="page2.htm"&gt;
      &lt;LOGO HREF="green.gif" STYLE="ICON"/&gt;
       &lt;TITLE&gt;The Green Page&lt;/TITLE&gt;
      &lt;ABSTRACT&gt;This is the abstract description for the green page.&lt;/ABSTRACT&gt;
 &nbsp;    &lt;/ITEM&gt;
   &lt;ITEM HREF="page3.htm"&gt;
      &lt;LOGO HREF="blue.gif" STYLE="ICON"/&gt;
      &lt;TITLE&gt;The Blue Page&lt;/TITLE&gt;
      &lt;ABSTRACT&gt;This is the abstract description for the blue page.&lt;/ABSTRACT&gt;
   &lt;/ITEM&gt;
   &lt;ITEM HREF="scrnsave.htm"&gt;
      &lt;USAGE VALUE="ScreenSaver"&gt;&lt;/USAGE&gt;
   &lt;/ITEM&gt;

&lt;/CHANNEL&gt;</code></pre>
<p>
The example below builds a <b>Project</b> object defining the content. </p>
<pre><code>' Using VBScript and Windows Scripting Host Runtime Env
Dim Project

Set Project = CreateObject("Push.Project")
Project.Name="ColorChannel"

' Add the logos to the project 

call Project.AddLogo("Top-Big","logo_big.gif", "IMAGE-WIDE")
call Project.AddLogo( "Top-Med","logo_med.gif", "IAMGE")
call Project.AddLogo( "Red"&nbsp;&nbsp;&nbsp; , "red.gif",&nbsp;&nbsp;&nbsp;&nbsp; "ICON")
call Project.AddLogo( "Green"&nbsp; , "green.gif",&nbsp;&nbsp; "ICON")
call Project.AddLogo( "Blue"&nbsp;&nbsp; , "blue.gif",&nbsp;&nbsp;&nbsp; "ICON")

' set up the channel

Project.Channel.HREF="http://www.mysite.com/Channel/homepage.htm"
Project.Channel.BASE="http://www.mysite.com/Channel/"
Project.Channel.Title="Sample "Color" Channel"
Project.Channel.Abstract="The sample color channel contains a red, green, and blue page for viewing."

' attach the logos to the channel itself
Project.Channel.LogoRefs.Add "Top-Big"
Project.Channel.LogoRefs.Add "Top-Med"

' set up the schedule element
Project.Channel.Schedule.Startdate=#1997-09-23#
Project.Channel.Schedule.Intervaltime=1
Project.Channel.Schedule.Earliesttime=2
Project.Channel.Schedule.Latesttime=6

' now add the items
Dim Item

' Red item
Set Item = Project.Channel.AddItem
Item.HREF="page1.htm"
Item.Title="The Red Page"
Item.Abstract="This is the abstract description for the red page."
Item.LogoRefs.Add "Red" 

' Green item
Set Item = Project.Channel.AddItem()
Item.HREF="page2.htm"
Item.Title="The Green Page"
Item.Abstract="This is the abstract description for the green page."
Item.LogoRefs.Add "Green" 

' Blue item
Set Item = Project.Channel.AddItem()
Item.HREF="page3.htm"
Item.Title="The Blue Page"
Item.Abstract="This is the abstract description for the blue page."
Item.LogoRefs.Add "Blue"

' Screensaver item

Set Item = Project.Channel.AddItem()
Item.HREF="scrnsave.htm"
Item.AddUsage "ScreenSaver" 


' Save the project&nbsp; (very important!)
Call Project.Save "ColorChannels"

' write the CDF file to disk
Call Project.WriteCDFFile("c:\channels\color\color.cdf")</code></pre>
<p>
<br>
This example, although not very interesting, does illustrate the core features of the primary Active Channel Objects. A more interesting use of these objects is in an Active Channel Agent that searches the system for content that meets certain conditions to be included in the <b>Channel</b> object during the refresh cycle.</p>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
</BODY>
</HTML>
