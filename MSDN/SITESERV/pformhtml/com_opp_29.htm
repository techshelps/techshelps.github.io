<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Tax Components</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_opp_njwl"></a><sup></sup>Using the Tax Components</h2>
<p>
The Tax Stage and its components ensure that <code>order._tax_total</code> and <code>order._tax_included</code> are set. If not, an error is generated. If you are writing a custom tax processing component, be sure that your component sets both of these values when appropriate.</p>
<p>
All components in the Tax stage will execute (unless a fatal error is returned). To cooperate, each component must check the resulting <code>_tax_*</code> values. If these values are already set, the component should return without doing anything. If the values are not set, the component will attempt to calculate the tax and if it is successful, set the <code>_tax_*</code> values.</p>
<p>
In addition, the tax components must ensure that the value of <code>_ship_to_country</code> is set to the intended country; otherwise, the component will not execute. Furthermore, the <b>OrderForm</b> expects <code>_tax_total</code> to be set by the tax component. The tax component may set other name/value pairs during its execution, but in order for the stage to complete successfully, <code>_tax_total</code> must be set.</p>
<p>
In each of the tax components, the country name must be specified as a parameter even though the name of the country is part of the name of the component (for example, <b>SimpleCanadaTax</b>). This is because the name of the component describes only the model for computing sales tax, and not the country to which it applies. For example, another country may actually use a tax model similar to Canada. Because the country name is specified, the tax model (and its corresponding component) can be used for more than one country.</p>
<h5>Note</h5>
<p>
The tax components shipped with Commerce Server are provided only for evaluation and testing purposes only. Microsoft strongly recommends that you have an independent tax professional verify all applicable tax rates and data generated by this component before you use such information for personal or business purposes.</p>
<h4>Related Topics</h4>
<ul>
<li>
&upsilon;<a href="com_piperef_17.htm"><b>DefaultTax</b></a></li>
<li>
&upsilon;<a href="com_piperef_61.htm"><b>SimpleCanadaTax</b></a></li>
<li>
&upsilon;<a href="com_piperef_62.htm"><b>SimpleJapanTax</b></a></li>
<li>
&upsilon;<a href="com_piperef_63.htm"><b>SimpleUSTax</b></a></li>
<li>
&upsilon;<a href="com_piperef_64.htm"><b>SimpleVATTax</b></a></li>
<li>
&upsilon;<a href="com_piperef_51.htm"><b>RequiredTax</b></a></li>
</ul>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
