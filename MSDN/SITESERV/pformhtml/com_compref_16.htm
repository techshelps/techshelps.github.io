<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AdminSite.Status Property</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_compref_xqyg"></a><sup></sup>AdminSite.Status Property</h2>
<p>
The <b>Status</b> property is a Boolean indicating whether the Commerce Server site is open or closed. In addition, when its value is set, it either opens or closes the Commerce Server site. The function closes the site by writing the value of the <b>Site.CloseRedirectURL</b> property into the <b>HttpRedirect</b> property of the metabase, and opens the site by clearing the <b>HttpRedirect</b> property.</p>
<h4>Examples</h4>
<p>
The following example opens a Commerce Server site:</p>
<pre><code>Set CurSite = Server.CreateObject("Commerce.AdminSite")
Call CurSite.Initialize("1", "Clocktower")
CurSite.Status = True
</code></pre>
<p>
The following example checks the status of the Commerce Server site and saves the text <i>Open</i> or <i>Closed</i> in a variable called <code>statusMsg</code>. (If the attempt to read the <b>Status</b> Boolean fails, as might happen if permission to a file were denied or a directory did not exist, then <code>statusMsg</code> will contain the text <i>Invalid</i>.)</p>
<pre><code>REM -- check site status
On Error Resume Next
curStatus = CurrSite.status
if Err.Number = 0 then
    if curstatus = TRUE then
        statusMsg = "Open"
    else
        statusMsg = "Closed"
    End If
Else
    statusMsg = "Invalid"
    Err.Clear
End if
</code></pre>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
