<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SimpleUSTax</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_tools_dtye"></a><sup></sup>SimpleUSTax</h2>
<p>
The <b>SimpleUSTax </b>component, which appears in the Tax stage of an order processing pipeline, applies a given rate to any order sent to a specified state in the United States.
<ul>
<li>
&upsilon;<b>Key</b>. (Read-only) The name of a property on the order form used to specify tax method. The value of this property is compared to the string specified in the <b>Method</b> field to determine whether to apply the tax to the order.</li>
<li>
&upsilon;<b>Apply when</b>. Specifies when to apply the tax.<ul>
<li>
&upsilon;<b>Equal to Country</b>. Specifies that the tax will be applied only if the value of the property specified for <b>Key</b> is the same as the string specified in the <b>Country</b> field.</li>
<li>
&upsilon;<b>Has any value</b>. Specifies that the tax will be applied when the value of the property specified for <b>Key</b> has any value on the order form. If you select this option, the <b>Country</b> field should be left blank.</li>
<li>
&upsilon;<b>Always</b>. Specifies that the tax is always applied to the order.</li>
</ul>
</li>
<li>
&upsilon;<b>Country</b>. If <b>Equal to Country</b> is selected, specifies a string that the component compares with the value of <b>ship_to_country</b> on the order form to determine whether to apply the tax to the order. The tax will be applied only if there is an exact match. </li>
<li>
&upsilon;<b>State Rate List</b>. Specifies each state for which tax is collected, and the tax rate for that state. These are listed as fields in the form <i>state:rate</i>, with state expressed as the two-character postal code abbreviation and rate expressed as a decimal value. For example, an 8.6% tax rate for the state of Washington is entered as <b>WA:8.6</b>. Multiple state/rate pairs are separated by a space. You can enter an <i>at</i> sign (@) (the wildcard character) to represent all states that are not explicitly listed (for example: @:0). </li>
</ul>
<h5>Note</h5>
<p>
The <b>SimpleUSTax</b> component is a simple tool for you to use to calculate tax rates. Microsoft strongly recommends that you have an independent tax professional verify all applicable tax rates and data generated by this component before you use such information for personal or business purposes.</p>
<h4>Remarks</h4>
<p>
The combination of the <b>Key</b>, <b>Apply when</b>, and <b>Country</b> fields determine whether tax should be applied, but only if the state to which the order is being shipped is listed in the <b>State Rate List</b>.</p>
<p>
The <b>SimpleUSTax </b>component first checks the <b>Apply when </b>value. If it is set to <b>Always</b>, the tax is always applied to the order. If <b>Apply when</b> is set to <b>Has any value</b>, the tax is applied to the order whenever the order form contains any value for <code>ship_to_country</code>. If <b>Apply when</b> is set to <b>Equal to Country</b>, the component does a comparison between the value of <code>ship_to_country</code><b> </b>on the order form and the text string in the <b>Country</b> field on this property page. If there is a match, the component applies the tax.</p>
<p>
If the component determines that tax should be applied, it then compares the value of <code>ship_to_state</code> on the order form to the list of states specified in <b>State Rate List</b>. If there is a match, indicating that the order is being shipped to a state where tax should be collected, the component applies the tax rate specified for that state, and sets the values for <code>item._tax_total</code>, <code>item._tax_included</code>,<code> order._tax_total</code>, <code>order._tax_included</code>.</p>
<p>
<b>SimpleUSTax</b> always sets <code>_tax_included</code> name/value pairs to zero (0) for both the item and the order. The component does not handle fractions of base currency units; all calculations are rounded to the nearest whole unit.</p>
<p>
If the customer types a country or state in the <b>OrderForm</b> that is not specified in the <b>SimpleUSTax</b> component configuration, the values of the <code>_tax_total</code> and <code>_tax_included</code> name/value pairs on the order and on the items will not be set.</p>
<h4>Related Topics</h4>
<ul>
<li>
&upsilon;<a href="com_opp_24.htm">Component Coordination</a></li>
</ul>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
