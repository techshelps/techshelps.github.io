<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TableHandlingADO</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_tools_xkoz"></a><sup></sup>TableHandlingADO</h2>
<p>
The <b>TableHandlingADO</b> component, which appears in the Handling stage of an order processing pipeline, sets the value of <code>_handling_total</code> on the order form by using values retrieved from the database.
<ul>
<li>
&upsilon;<b>Key</b>. (Read-only) The name of a property on the order form used to specify handling method. The value of this property is compared to the string specified in the <b>Method</b> field to determine whether to apply the handling charge to the order.</li>
<li>
&upsilon;<b>Apply when</b>. Specifies when to apply the handling charge.<ul>
<li>
&upsilon;<b>Equal to Method</b>. Specifies that the handling charge should be applied if the value of the field specified for <b>Key</b> is the same as the string specified in the <b>Method</b> field. </li>
<li>
&upsilon;<b>Has Any Value</b>. Specifies that the handling charge should be applied when the value of the field specified for <b>Key</b> has any value on the order form. If you select this option, the <b>Method</b> field should be left blank.</li>
<li>
&upsilon;<b>Always</b>. Specifies that the handling charge is always applied to the order.</li>
</ul>
</li>
<li>
&upsilon;<b>Method</b>. If <b>Equal to Method</b> is selected, specifies a string that the component compares with the value of <b>shipping_method</b> on the order form to determine whether to apply the handling charge to the order. The handling charge will be applied only if there is an exact match.</li>
<li>
&upsilon;<b>Connection string</b>. Specifies the connection string used for connecting to the database. The connection string must include either the full connection string (the data source name (DSN), database login ID, and database password) or the name of a named connection stored in the connection map. If this field is blank, the default connection string is used.</li>
<li>
&upsilon;<b>Query</b>. Specifies either the full SQL text of the query that is executed by this component or the name of a query whose full SQL text is defined in the site’s global.asa file.</li>
<li>
&upsilon;<b>Parameter List</b>. Specifies the parameters that the component passes to the query. The parameter <b>count</b> passes the query the number of line items on the order. The parameter <b>order.<i>fieldname</i></b> passes the value of the specified field on the order form. The parameter <b>sum.<i>fieldname</i></b> passes the query the sum of a particular field on the order, while <b>sumq.<i>fieldname</i></b> passes the  sum times the respective quantities. If multiple parameters are specified, each parameter is separated from the next by a single space.</li>
<li>
&upsilon;<b>Column</b>. Specifies the name of the column in the database that contains the handling charge.</li>
</ul>
<h4>Remarks</h4>
<p>
The combination of the <b>Key</b>, <b>Apply when</b>, and <b>Method</b> fields determine whether the handling charge should be applied to the order.</p>
<p>
The <b>TableHandlingADO </b>component first checks the <b>Apply when </b>value. If it is set to <b>Always</b>, the handling charge is always applied to the order. If <b>Apply when</b> is set to <b>Has any value</b>, the handling charge is applied to the order whenever the order form contains any value for <code>shipping_method</code>. If <b>Apply when</b> is set to <b>Equal to Method</b>, the component does a comparison between the value of <code>shipping_method</code><b> </b>on the order form and the text string in the <b>Method</b> field on this property page. If there is a match, the handling charge is applied.</p>
<p>
If the component determines that the handling charge should be applied, it then executes the query specified in <b>Query</b>, which retrieves the handling charge from the database column specified in <b>Column</b>. The component then computes the handling charge.</p>
<h4>Related Topics</h4>
<ul>
<li>
&upsilon;<a href="com_opp_24.htm">Component Coordination</a></li>
</ul>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
