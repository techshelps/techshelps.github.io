<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MessageManager Object Overview</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_compref_bfbe"></a><sup></sup>MessageManager Object Overview</h2>
<p>
The <b>MessageManager</b> object is usually created in the Global.asa file. Use the Active Server Pages (ASP) <b>Server</b> object’s <b>CreateObject</b> method to create a <b>MessageManager</b> object, as follows:</p>
<pre><code>Set MSCSMessageManager = Server.CreateObject("Commerce.MessageManager")
</code></pre>
<p>
Also in Global.asa, store the new object in the <b>Application</b> object, as follows:</p>
<pre><code>Set Application("MSCSMessageManager") = MSCSMessageManager
</code></pre>
<p>
The <b>MessageManager</b> object is used to associate sets of error messages with user languages or dialects. The <b>MessageManager</b> separates the text of these messages from the components that detect the errors, making it easy to support many languages while using the same code, site configuration, pipeline components and pipeline configuration. </p>
<p>
For information about how the <b>MessageManager</b> is used in an application, see “Managing Languages and Error Messages” in <i>Architecture of a Business-to-Consumer Site</i> in the Commerce documentation.</p>
<p>
The following example, from the Global.asa file for the Microsoft Press® sample site, illustrates the creation and initialization of a <b>MessageManager</b> object:</p>
<pre><code>REM -- Create a message manager for use by the pipeline stages
Dim MSCSMessageManager
Set  MSCSMessageManager = Server.CreateObject("Commerce.MessageManager")
Call MSCSMessageManager.AddLanguage("usa", &amp;H0409)
Call MSCSMessageManager.AddLanguage("FRA", &amp;H040c)
Call MSCSMessageManager.AddLanguage("ENC", &amp;H1009)
MSCSMessageManager.defaultLanguage = "usa"
Call MSCSMessageManager.AddMessage("pur_out_of_stock", "At least one item is out of stock.")
Call MSCSMessageManager.AddMessage("pur_badsku", "Products in your basket were deleted because they don't exist in this store.")
Call MSCSMessageManager.AddMessage("pur_badplacedprice", "Prices of products in your basket have been updated.")
Call MSCSMessageManager.AddMessage("pur_noitems", "An order must have at least one item.")
Call MSCSMessageManager.AddMessage("pur_badshipping", "Unable to complete order. Cannot compute shipping cost.")
Call MSCSMessageManager.AddMessage("pur_badtax", "Unable to complete order. Cannot compute tax.")
Call MSCSMessageManager.AddMessage("pur_badhandling", "Unable to complete order. Cannot compute handling cost.")
Call MSCSMessageManager.AddMessage("pur_badverify", "Changes to the data require your review. Please review and resubmit.")
Call MSCSMessageManager.AddMessage("pur_badpayment", "There was a problem authorizing your credit.  Please verify your payment information or use a different card.")
Call MSCSMessageManager.AddMessage("pur_badcc", "Bad Credit Card Number.")
</code></pre>
<p>
In the preceding example, the <b>MessageManager</b>’s <b>DefaultLanguage</b> property is initialized to reference the message set called "<code>usa"</code>, which has been added to the <b>MessageManager</b> through the call to <b>AddLanguage</b>. Because subsequent calls to <b>AddMessage</b> do not specify the message set with which each message is associated, the added messages are automatically associated with the default message set.</p>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
