<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SimpleJapanTax</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_tools_hnal"></a><sup></sup>SimpleJapanTax</h2>
<p>
The <b>SimpleJapanTax </b>component, which appears in the Tax stage of an order processing pipeline, computes a tax rate for the Japanese tax model. It can be used for any country that uses a similar model. The component handles fractions of currency units only at the item level; order-level calculations (<code>order._tax_total</code> and <code>order._tax_included</code>) are rounded to the nearest whole unit.
<ul>
<li>
&upsilon;<b>Key</b>. (Read-only) The name of a property on the order form used to specify tax method. The value of this property is compared to the string specified in the <b>Method</b> field to determine whether to apply the tax to the order.</li>
<li>
&upsilon;<b>Apply when</b>. Specifies when to apply the tax.<ul>
<li>
&upsilon;<b>Equal to Country</b>. Specifies that the tax will be applied only if the value of the property specified for <b>Key</b> is the same as the string specified in the <b>Country</b> field.</li>
<li>
&upsilon;<b>Has any value</b>. Specifies that the tax will be applied when the value of the property specified for <b>Key</b> has any value on the order form. If you select this option, the <b>Country</b> field should be left blank.</li>
<li>
&upsilon;<b>Always</b>. Specifies that the tax is always applied to the order.</li>
</ul>
</li>
<li>
&upsilon;<b>Country</b>. If <b>Equal to Country</b> is selected, specifies a string that the component compares with the value of <b>ship_to_country</b> on the order form to determine whether to apply the tax to the order. The tax will be applied only if there is an exact match. </li>
<li>
&upsilon;<b>Include Item Key</b>. Specifies the name of the field in the item <b>Dictionary</b> that indicates whether the tax is already included in the item’s price. This field is assumed to contain a Boolean value that indicates whether or not the tax rate is to be added to the line item (in which case <code>item._tax_total</code> is set to the tax amount and <code>item._tax_included</code> is set to zero), or whether the tax rate is included in the price (in which case <code>item._tax_included</code> is set to the tax amount and <code>item._tax_total</code> is set to zero).</li>
<li>
&upsilon;<b>Rate Item Key</b>. Specifies the name of the field in the item that contains the tax rate charged for the item. </li>
</ul>
<h5>Note</h5>
<p>
The <b>SimpleJapanTax</b> component is a simple tool for you to use to calculate tax rates. Microsoft strongly recommends that you have an independent tax professional verify all applicable tax rates and data generated by this component before you use such information for personal or business purposes.</p>
<h4>Remarks</h4>
<p>
The combination of the <b>Key</b>, <b>Apply when</b>, and <b>Country</b> fields determine whether tax should be applied, but only if tax is not already included in the item’s price.</p>
<p>
The <b>SimpleJapanTax </b>component first checks the <b>Apply when </b>value. If it is set to <b>Always</b>, the tax is always applied to the order. If <b>Apply when</b> is set to <b>Has any value</b>, the tax is applied to the order whenever the order form contains any value for <b>ship_to_country</b>. If <b>Apply when</b> is set to <b>Equal to Country</b>, the component does a comparison between the value of <b>ship_to_country </b>on the order form and the text string in the <b>Country</b> field on this property page. If there is a match, the component applies the tax whose value is stored in the field specified in <b>Rate Item Key</b>.</p>
<h4>Example</h4>
<p>
To specify that a 9.54% tax rate is included within an item’s price and is not included in another item’s price for items in Japan, do the following:
<ol>
<li>
Add a column for the included tax rate to your product table. The tax rate should be specified as a <b>smallint</b> number:<pre><code>jpn_prod_tax_included   smallint  NOT NULL,
</code></pre>
</li>
<li>
Add a column for the tax rate to your product table. The tax rate should be specified as a real number:<pre><code>jpn_prod_tax_rate       real     NOT NULL,
</code></pre>
</li>
<li>
Assign tax rates and tax included values to each product in your product table using an SQL script. This example uses two products, <code>Product Included</code> and <code>Product Excluded</code>. Assign <code>Product Included</code> the 9.54% tax rate with the tax included in the product price. Type 9.54 into the <code>jpn_prod_tax_rate</code> column and <b>1 </b>(True), in the <code>jpn_prod_tax_included</code> column in the <code>Product Included</code> row. Assign <code>Product Excluded</code> the 9.54% tax rate with the tax not included in the product price. Type 9.54 into the <code>jpn_prod_tax_rate</code> column and <b>0</b> (False), in the <code>jpn_prod_tax_included</code> column in the <code>Product Excluded</code> row.</li>
<li>
Double-click the SimpleJapanTax icon in the Win32®-based Pipeline Editor, or click the <b>Edit</b> link for the component in the ASP-based Pipeline Editor and enter the following in the resulting property page.</li>
</ol>
<table cellspacing=4 cols=2 width=464>
<tr valign=top>
<th align=left width=48%>Field</th>
<th align=left width=52%>Value</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%></td>
</tr>
<tr valign=top>
<td width=48%><b>Apply when</b></td>
<td width=52%>Has any value</td>
</tr>
<tr valign=top>
<td width=48%><b>Country</b></td>
<td width=52%>JPN</td>
</tr>
<tr valign=top>
<td width=48%><b>Include Item Key</b></td>
<td width=52%>_product_jpn_prod_tax_included</td>
</tr>
<tr valign=top>
<td width=48%><b>Rate Item Key</b></td>
<td width=52%>_product_jpn_prod_tax_rate</td>
</tr>
</table><br>
<h5>Note</h5>
<p>
If the customer types a country in the <b>OrderForm</b> that is not specified in the <b>SimpleJapanTax</b> component configuration, the values of the <code>_tax_total</code> and <code>_tax_included</code> name/value pairs on the order and on the items will not be set.</p>
<h4>Related Topics</h4>
<ul>
<li>
&upsilon;<a href="com_opp_24.htm">Component Coordination</a></li>
</ul>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
