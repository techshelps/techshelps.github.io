<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TrafficTable.InitTraffic Method</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_compref_syyg"></a><sup></sup>TrafficTable.InitTraffic Method</h2>
<h5>Note</h5>
<p>
The <b>TrafficTable</b> object is included in Commerce Server 3.0 only for backward compatibility with sites created in Commerce Server 2.0. New sites should measure traffic with Site Server Analysis.</p>
<p>
The <b>InitTraffic </b>method initializes the <b>TrafficTable </b>object. <b>InitTraffic</b> determines what information is to be logged by examining the column names in the destination database table. The following table lists the column names that may appear in the table, along with the information that will be stored into that column by the <b>LogTraffic </b>method.</p>
<table cellspacing=4 cols=2 width=464>
<tr valign=top>
<th align=left width=20%>Column name</th>
<th align=left width=80%>Information to be logged</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%></td>
</tr>
<tr valign=top>
<td width=20%><b>store_name</b></td>
<td width=80%>Text that was provided to <b>InitTraffic</b> as its <i>SiteName</i> argument. Usually this string contains the name of the site.</td>
</tr>
<tr valign=top>
<td width=20%><b>shopper_id</b></td>
<td width=80%>Unique identifier of the current shopper, which is provided as the <i>ShopperID</i> argument to the <b>LogTraffic</b> method.</td>
</tr>
<tr valign=top>
<td width=20%><b>event</b></td>
<td width=80%>Number provided as the <i>Event</i> argument to the <b>LogTraffic</b> method. This arbitrary number is usually used to identify the type of event being logged.</td>
</tr>
<tr valign=top>
<td width=20%><b>item_requested</b></td>
<td width=80%>String provided as the <i>ItemRequested</i> argument to the <b>LogTraffic</b> method. This arbitrary string is usually used to identify the URL of the page being requested.</td>
</tr>
<tr valign=top>
<td width=20%><b>event_time</b></td>
<td width=80%>Current time.</td>
</tr>
<tr valign=top>
<td width=20%><b>args_</b><i>argname</i></td>
<td width=80%>Value of a specified URL query string passed to the page in the URL (either from a FORM or a generated URL). <i>argname </i>must match the name of the variable in a query string. For example, if the keyword <code>args_product</code> is listed, then <b>LogTraffic</b> will look for a query string in the URL beginning "?product=" and will include the value specified in the log.</td>
</tr>
<tr valign=top>
<td width=20%><b>remote_addr</b></td>
<td width=80%>IP address of the client computer.</td>
</tr>
<tr valign=top>
<td width=20%><b>remote_host</b></td>
<td width=80%>Host name of the client computer (in some cases, this value may be an IP address).</td>
</tr>
<tr valign=top>
<td width=20%><b>http_</b><i>argname</i></td>
<td width=80%>Environment variables, such as REFER and USER_AGENT (for example, http_REFER). In names containing hyphens, an underscore is used instead of a hyphen because database column names cannot contain hyphens.</td>
</tr>
</table><br>
<h4>Syntax</h4>
<p>
<i>Traffic</i><b>.InitManager(</b><i>Datasource</i>, <i>SiteName</i>, <i>TableName</i><b>)</b></p>
<h4>Parameters</h4>
<dl>
<dt>
<i>Datasource</i></dt>
<dd>
A variable that identifies the <b>Datasource </b>object for the table to which you want to log.</dd>
<dt>
<i>SiteName</i></dt>
<dd>
An arbitrary string that will identify the site in the log.</dd>
<dt>
<i>TableName</i></dt>
<dd>
The name of the table in the referenced data source.
</dd>
</dl>
<h4>Example</h4>
<pre><code>REM -- Create and initialize database traffic server
Set  MSCSTraffic = Server.CreateObject("Commerce.TrafficTable")
call MSCSTraffic.InitTraffic(MSCSDataSource, "Clocktower", "Clocktower_traffic")
</code></pre>
<h4>Related Topics</h4>
<ul>
<li>
&upsilon;<a href="com_compref_194.htm"><b>TrafficTable.LogTraffic</b> Method</a></li>
</ul>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
