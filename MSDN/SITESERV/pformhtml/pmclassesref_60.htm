<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Interface ISetupStore GenerateJetFileName Method</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="pm_class_setupstore_interface_isetupstore_method_generatejetfilename"></a>GenerateJetFileName Method</h1>
<p>
This method can be used to automatically generate a filename for an access database that does not conflict with others.&nbsp; The names are all of the form "c:\winnt\system32\inetsvr\mpinstX.mdb" where "X" is a number.&nbsp; The idea here is to correlate the instance number for the LDAP server using the access database with the name of the database itself.&nbsp; Read mpinst3.mdb as "Membership and Personalization for LDAP instance 3."</p>
<p>
<b>IDL Definition</b></p>
<pre><code><b>HRESULT GenerateJetFileName(
[in] DWORD </b><i>dwID</i><b>, 
[out, retval] BSTR *</b><i>pbstrFileName</i><b>
);</b></code></pre>
<p>
<b>Parameters</b></p>
<p class=dt>
<i>dwID</i></p>
<p class=indent>
the identifier to attempt to append to the "mpinst" prefix in the database name. If the number conflicts with another database name, the next possible value is added, and that filename is returned.</p>
<p class=dt>
<i>pbstrFileName</i></p>
<p class=indent>
on return, the address of a BSTR variable containing the generated filename.</p>
<p>
<b>Return Values</b></p>
<p>
a standard HRESULT value</p>
<p>
<b>Remarks</b></p>
<p>
The argument to this method is the "suggested" id for the name.&nbsp; If we are setting up LDAP instance number 3, we would send 3 as the argument.&nbsp; Filename clashed permitting, we would receive "c:\winnt\system32\inetsvr\mpinst3.mdb" from the method.&nbsp; However, if this file already exists, we would receive the next name available in the sequence.&nbsp; That is, if all numbers up to 6 are used (mpinst1.mdb … mpinst6.mdb") are used, the method would return "c:\winnt\system32\inetsvr\mpinst7.mdb"</p>
<p>
<b>Example</b></p>
<pre><code>Set ObjCreator = CreateObject("ObjCreator.ObjCreator.1")
Set DSConfig = ObjCreator.CreateObjAuth("MemAdmin.DSConfig.1")
Filename = DSconfig.GenerateJetFilename(3) ' hope to use 3

DirName="company1"
DBUserName="ldapuser"
DBUserPass="passwordhere"
DBSuperPass="superpass"
fUseMembershipSecurity=1 ' true
call DSConfig.CreateJetDB(Filename, DirName, DBUserName, DBUserPass, DBSuperPass, fUseMembershipSecurity)
' go on to configure LDAP instance</code></pre>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
</BODY>
</HTML>
