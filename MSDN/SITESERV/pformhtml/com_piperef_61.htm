<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SimpleCanadaTax</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_tools_wehb"></a><sup></sup>SimpleCanadaTax</h2>
<p>
The <b>SimpleCanadaTax </b>component, which appears in the Tax stage of an order processing pipeline, calculates the Goods and Services Tax (GST) and Provincial Sales Tax (PST) used in Canada, and writes the computed values to the <code>order._tax_total_pst</code>, <code>order._tax_total_gst</code>, <code>order._tax_total</code>, and <code>item._tax_total</code> fields. <b>SimpleCanadaTax</b> always sets <code>_tax_included</code> name/value pairs to zero (0) for both the item and the order. The data used by the <b>SimpleCanadaTax </b>component is usually provided by the <b>QueryProdInfoADO</b> component. 
<ul>
<li>
&upsilon;<b>Key</b>. (Read-only) The name of a property on the order form used to specify tax method. The value of this property is compared to the string specified in the <b>Method</b> field to determine whether to apply the tax to the order.</li>
<li>
&upsilon;<b>Apply when</b>. Specifies when to apply the tax.<ul>
<li>
&upsilon;<b>Equal to Country</b>. Specifies that the tax will be applied only if the value of the property specified for <b>Key</b> is the same as the string specified in the <b>Country</b> field.</li>
<li>
&upsilon;<b>Has any value</b>. Specifies that the tax will be applied when the value of the property specified for <b>Key</b> has any value on the order form. If you select this option, the <b>Country</b> field should be left blank.</li>
<li>
&upsilon;<b>Always</b>. Specifies that the tax is always applied to the order.</li>
</ul>
</li>
<li>
&upsilon;<b>Country</b>. If <b>Equal to Country</b> is selected, specifies a string that the component compares with the value of <code>ship_to_country</code> on the order form to determine whether to apply the tax to the order. The tax will be applied only if there is an exact match. </li>
<li>
&upsilon;<b>GST Item Key</b>. Specifies the name of a field on the order form in which the GST tax rate is stored.</li>
<li>
&upsilon;<b>PST Item Key Prefix</b>. Specifies a prefix that the <b>SimpleCanadaTax</b> component appends to the name of the province to which the item is being shipped (from the <code>ship_to_state</code> field on the order form). The component then uses this concatenated string to look up the PST tax rate on the order form.</li>
<li>
&upsilon;<b>Province List</b>. Specifies the list of provinces (separated by spaces) for which to compute the tax. This value is used to look up the tax rate in the database table column. Optionally, multiple provinces can be specified.</li>
</ul>
<h4>Remarks</h4>
<h5>Note</h5>
<p>
The <b>SimpleCanadaTax</b> component is a simple tool for you to use to calculate tax rates. Microsoft strongly recommends that you have an independent tax professional verify all applicable tax rates and data generated by this component before you use such information for personal or business purposes.</p>
<p>
GST is common throughout Canada and almost all goods and services have a GST. If a product is taxed, the GST rate is the same throughout Canada. However, some products are not taxed and some service merchants (making less than a given amount) may elect to not charge GST. Each province has its own PST, usually a fixed rate for all products, but PST still depends on the product (although a province may elect to tax an item not taxed by another province).</p>
<p>
When shipping from one province to another you do not pay any PST tax. Although not common, a product may have PST but not GST. The reverse is also true.</p>
<p>
<b>SimpleCanadaTax</b> always sets <code>_tax_included</code> fields to zero (0) for both the item and the order (see <a href="com_opp_29.htm">Using the Tax Components</a>). The component does not handle fractions of base currency units; all calculations are rounded to the nearest whole unit.</p>
<p>
The combination of the <b>Key</b>, <b>Apply when</b>, and <b>Country</b> fields determine whether tax should be applied, but only if the order is being shipped to one of the provinces in the <b>Province List</b>. </p>
<p>
The <b>SimpleCanadaTax </b>component first checks the <b>Apply when </b>value. If it is set to <b>Always</b>, the tax is always applied to the order. If <b>Apply when</b> is set to <b>Has any value</b>, the tax is applied to the order whenever the order form contains any value for <b>ship_to_country</b>. If <b>Apply when</b> is set to <b>Equal to Country</b>, the component does a comparison between the value of <b>ship_to_country </b>on the order form and the text string in the <b>Country</b> field on this property page. If there is a match, the tax is applied. </p>
<p>
If the component determines that tax should be applied, it then compares the value of <b>ship_to_state</b> on the order form to the list of provinces specified in <b>Province List</b>. If there is a match, indicating that the order is being shipped to a province where tax should be collected, the component does two things. First, it retrieves the GST tax rate from the field on the order form identified by <b>GST Item Key</b>. Second, it appends the prefix specified in <b>PST Item Key Prefix</b> to the name of the province to which the item is being shipped (from the <b>ship_to_state</b> field on the order form). The component then uses this concatenated string to look up the PST tax rate on the order form.</p>
<h4>Example</h4>
<p>
To specify that a 2% GST tax rate and a 4.5% Alberta PST tax rate is charged for an item shipped to Alberta, Canada, do the following:
<ol>
<li>
Add a column for the GST rate to your product table. The tax rate should be specified as a real number:<pre><code>can_prod_gst_tax_rate       real  NOT NULL
</code></pre>
</li>
<li>
Add a column for the Alberta PST rate to your product table. The tax rate should be specified as a real number:<pre><code>can_prod_pst_tax_rate_alb   real  NOT NULL
</code></pre>
</li>
<li>
Assign tax rates to each product in your product table using an SQL script. For this example, assign the 2% GST tax rate and the 4.5% Alberta PST tax rate to <code>Product ABC</code>. Type <b>2.0</b> into the <code>can_prod_gst_tax_rate </code>column and <b>4.5</b> into the <code>can_prod_pst_tax_rate_alb</code> column in the <code>Product ABC</code> row.</li>
<li>
Double-click the SimpleCanadaTax icon in the Win32®-based Pipeline Editor, or click the <b>Edit</b> link for the component in the ASP-based Pipeline Editor and enter the following in the resulting property page.</li>
</ol>
<table cellspacing=4 cols=2 width=464>
<tr valign=top>
<th align=left width=48%>Field</th>
<th align=left width=52%>Value</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%></td>
</tr>
<tr valign=top>
<td width=48%><b>Apply when</b></td>
<td width=52%>Has any value</td>
</tr>
<tr valign=top>
<td width=48%><b>Country</b></td>
<td width=52%>CAN</td>
</tr>
<tr valign=top>
<td width=48%><b>GST Item Key</b></td>
<td width=52%>_product_can_prod_gst_tax_rate</td>
</tr>
<tr valign=top>
<td width=48%><b>PST Item Key Prefix</b></td>
<td width=52%>_product_can_prod_pst_tax_rate</td>
</tr>
<tr valign=top>
<td width=48%><b>Province List</b></td>
<td width=52%>alb</td>
</tr>
</table><br>
<h5>Note</h5>
<p>
If the customer types a country or province on the <b>OrderForm</b> that is not specified in the <b>SimpleCanadaTax</b> component configuration, the values of the <code>_tax_total</code> and <code>_tax_included</code> name/value pairs on the order and on the items will not be set.</p>
<h4>Related Topics</h4>
<ul>
<li>
&upsilon;<a href="com_opp_24.htm">Component Coordination</a></li>
</ul>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
