<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OrderPipeline.OrderExecute Method</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_compref_dfus"></a><sup></sup>OrderPipeline.OrderExecute Method </h2>
<p>
The <b>OrderExecute</b> method runs the specified set of stages in the pipeline, applying their actions to the specified order form. Before invoking <b>OrderExecute</b>, you must load the pipeline configuration using the <b>LoadPipe</b> method.</p>
<p>
<b>OrderExecute</b> returns a <b>Long </b>result containing one of the following values:
<ul>
<li>
&upsilon;The number 1 indicates the pipeline executed successfully.</li>
<li>
&upsilon;The number 2 indicates errors raised by pipeline components in the basket or purchase error collections. These are typically customer errors, such as a mis-typed credit card number. An error message is displayed to the customers so that they can submit the information again.</li>
<li>
&upsilon;The number 3 indicates failure of the pipeline, such as the inability to access the database. This type of error cannot be corrected by the customer.</li>
</ul>
<h4>Syntax</h4>
<p>
<i>OrderPipeline</i><b>.OrderExecute(</b><i>Mode</i><b>,</b> <i>OrderForm</i><b>,</b> <i>PipeContext</i><b>,</b> <i>Reserved</i><b>)</b></p>
<h4>Parameters</h4>
<dl>
<dt>
<i>Mode</i></dt>
<dd>
Specifies the mode in which to execute the stages in the pipeline. This parameter may be set to one of the following:
<pre><code>1    Runs the product verification stages.
2    Runs all stages except payment and accept.
4    Runs the complete pipeline.
</code></pre>

<p>
The values for <i>Mode</i> may be defined as constants in Global.asa:

<pre><code>Application("OPPMODE_PRODUCT")  = 1
Application("OPPMODE_PLAN")     = 2
Application("OPPMODE_PURCHASE") = 4
</code></pre>

</dd>
</dl>
<h5 class=indent1>Note</h5>
<p class=indent1>
The <i>Mode</i> parameter is included only for backward compatibility with sites created in Commerce Server 2.0, and will be discontinued in future releases. In Commerce Server 3.0 and later, the selection of pipeline stages is made by loading an appropriate pipeline configuration file with the <b>LoadPipe</b> method. Commerce Server 3.0 applications should use the value one (1) for this parameter; zero (0) will cause no stages to run. </p>
<dl>
<dt>
<i>OrderForm</i></dt>
<dd>
An initialized <b>OrderForm</b>.</dd>
<dt>
<i>PipeContext</i></dt>
<dd>
A <b>PipeContext</b> object. The <b>PipeContext</b> object is a <b>Dictionary</b> object that references a group of initialized objects containing information needed by the pipeline.</dd>
<dt>
<i>Reserved</i></dt>
<dd>
This value is not used and must be set to zero (0).
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>OrderExecute</b> method should be used instead of the <b>RunProduct</b>, <b>RunPlan</b>, and <b>RunPurchase</b> methods on the <b>Page</b> object, as used in Commerce Server 2.0.</p>
<h4>Related Topics</h4>
<ul>
<li>
&upsilon;<a href="com_compref_184.htm"><b>OrderPipeline.LoadPipe</b> Method</a></li>
<li>
&upsilon;<a href="com_compref_157.htm">The <b>PipeContext </b>Dictionary</a></li>
</ul>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
