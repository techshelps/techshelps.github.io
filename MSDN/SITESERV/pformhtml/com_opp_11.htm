<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The OrderForm</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_opp_pyzc"></a><sup></sup>The OrderForm</h2>
<p>
The OPP requires that data passed from the site to the OPP, and from the OPP to the site, be passed in an <b>OrderForm </b>object. This requirement applies both to components included in the default OPP and to components designed to extend its functionality.</p>
<p>
The <b>OrderForm</b> consists of a structured set of <a href="com_compref_63.htm"><b>Dictionary</b></a> and <a href="com_compref_145.htm"><b>SimpleList</b></a> objects that makes it possible to present a detailed summary of all or part of one or more shopping sessions to the customer or to the OPP. This summary includes customer data, such as name, address, and credit-card information, as well as product information related to the purchase.</p>
<p>
<img src="dictlist.gif" border=0></p>
<p>
As the preceding diagram illustrates, the <b>OrderForm</b> is a <b>Dictionary</b>. The first element in this <b>Dictionary</b> is a reference to a <b>SimpleList</b> of the items that make up the order, and each of these items is itself another <b>Dictionary</b>. The <b>SimpleList</b> is referred to as the <code>items</code> list.</p>
<p>
The elements that make up both the order <b>Dictionary</b> and the <b>Dictionary</b> objects in the <code>items</code> <b>SimpleList</b> are called <i>name/value pairs</i>. Each component that you include in the OPP for your site is designed to operate on one or more of these name/value pairs. Typical operations include the following:
<ul>
<li>
&upsilon;<b>Name/value pair creation.</b> Several components create name/value pairs in an <b>OrderForm</b>. For example, the <b>QueryProdInfoADO</b> component queries a specified database table for information on a given product, prepends _<code>product</code>_ to the column name, and adds the resulting name and the value for the associated row to the <b>OrderForm</b>.</li>
<li>
&upsilon;<b>Name/value pair initialization.</b> The <i>required</i> components in the OPP fall into this category. These components check to make sure that certain name/value pairs are initialized, and if they are not, these components initialize them. Thus, the <b>RequiredOrderInit</b> component, which is part of the Order Initialization stage sets the _<code>total</code>_<code>total</code>, _<code>oadjust</code>_<code>subtotal</code>, _<code>shipping</code>_<code>total</code>, _<code>tax</code>_<code>total</code>, _<code>handling</code>_<code>total</code>, _<code>tax</code>_<code>included</code> and _<code>payment</code>_<code>auth</code>_<code>code</code> name/value pairs to Null.</li>
<li>
&upsilon;<b>Name/value pair verification.</b> The OPP fails if certain name/value pairs on an <b>OrderForm</b> are not initialized when the pipeline is invoked. For example, the <b>RequiredOrderInit</b> component verifies that the items <b>SimpleList</b> on an <b>OrderForm</b> is not empty. If this <b>SimpleList</b> is empty, the component returns status indicating failure.</li>
<li>
&upsilon;<b>Name/value pair calculation.</b> The optional components in the OPP initialize name/value pairs based on the work performed by other components. For example, the components in the Tax stage calculate the tax on an order, based on the list of items in the <b>OrderForm</b>’s items <b>SimpleList</b>, and writes the tax to the _<code>tax</code>_<code>total</code> name/value pair.</li>
</ul>
<p>
The underscore (_) character that precedes many of the name/value pairs in the <b>OrderForm</b> is known as a prefix. Generally, the inclusion of a prefix indicates the name/value pairs in an <b>OrderForm</b> that are not persistently stored. </p>
<h5>Note</h5>
<p>
The contents of an <b>OrderForm</b> can vary, depending on how the pipeline for a site is configured. The figure listed previously is intended only to illustrate a typical <b>OrderForm</b>.</p>
<h4>Related Topic</h4>
<ul>
<li>
&upsilon;<a href="com_opp_12.htm">Values Commonly Used on the OrderForm</a></li>
</ul>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
