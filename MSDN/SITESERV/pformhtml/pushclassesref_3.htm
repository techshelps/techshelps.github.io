<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ICDFGenerator Run Method</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="pu_cdfgenerator_class_methods_run"></a>Run Method</h1>
<p>
This<b> </b>method generates the CDF string representing the user's personal channel selections. It then directly sends the string to the client browser via the built-in ASP <b>Response</b> object with the MIME type set to "application/x-cdf." In essence, the ASP page becomes a dynamic CDF file containing the users personalized channel content.</p>
<p>
<b>VBScript Syntax</b></p>
<pre><code><i>ICDFGenerator</i>.<b>Run </b><i>CDFGenHelperName</i></code></pre>
<p>
<b>Parameters</b> </p>
<p class=dt>
<i>CDFGenHelperName</i> </p>
<p class=indent>
A string specifying the key indexing a class <b>CDFGenHelper</b> object in the ASP <b>Application</b> collection. </p>
<p>
<b>Return Value</b></p>
<p>
None</p>
<p>
<b>Remarks</b></p>
<p>
The <i>CDFGenHelperName</i> string passed must be the "key" under which a valid <b>CDFGenHelper</b> interface is indexed in the ASP application's <b>Application</b> collection. If the object cannot be found in the <b>Application</b> collection, the <b>Run</b> method will fail.</p>
<p>
The <b>Run</b> method will also fail if the class <b>Server</b> object did not create the instance of the <b>CDFGenerator</b> class, because the <a href="pm_coclass_userobjects.htm">UserObjects</a> object will not have been properly instantiated.</p>
<p>
<b>Examples</b></p>
<p>
The following example first lists a hypothetical <b>Application_OnStart</b> subroutine located in an ASP application's Global.asa file. The subroutine creates an instance of a <a href="pushclassesref_4.htm">CDFGenHelper</a> class and then loads a given <b>Project </b>object. It then adds the object to the ASP <b>Application </b>collection, making it available to other ASP pages within the application scope. The next example lists the contents of a hypothetical ASP page located within the application's scope (i.e., either in or below the virtual directory that contains the Global.asa file). The script creates an instance of the <b>CDFGenerator</b> class that generates the current user's personalized CDF string. It passes the <b>Application </b>"key" name of the <b>CDFGenHelper </b>object as an argument to the <b>Run</b> method. Behind the scenes, the object uses the resident <a href="pm_coclass_userobjects.htm">UserObjects</a> object to retrieve the user's list of selected channel GUID values that are stored in the Membership directory service under the user property specified by <b>Project.SelectionListPropName</b>. The <b>Project.SelectionStylePropName </b>optionally is checked to supply the "style" of the list (i.e., whether the list is of channels to include or exclude from the project.) The list and style are then passed to the <b>CDFGenHelper</b> object, and the personalized CDF string is returned. The string is then sent as the response to the user's request with the appropriate MIME-type.</p>
<p>
Following is an excerpt from a Global.asa file</p>
<pre><code>&lt;SCRIPT LANGUAGE="VBSCRIPT" RUNAT="SERVER"&gt;
Sub Application_OnStart ()
  ...
  Set ICDFGenHelper = CreateObject("Push.CDFGenHelper")
  ICDFGenHelper.Load "Project1"
  Set Application("GenHelperProject1") = ICDFGenHelper
  ...
End Sub
...
&lt;/SCRIPT&gt;</code></pre>
<p>
An ASP sample script</p>
<pre><code>&lt;% 
 &nbsp; Set ICDFGenerator = Server.CreateObject("Push.CDFGenerator")
 &nbsp; ICDFGenerator.Run "GenHelperProject1"
%&gt;</code></pre>
<p>
The following example illustrates what happens in the ASP script listed above behind the scenes. However, this approach is <i>not</i> recommended, as it would severely degrade server performance. It is presented strictly to outline the complete process encapsulated by the <b>CDFGenerator</b> methods, as well as facilitate debugging.</p>
<pre><code>&lt;%
 &nbsp; Response.Buffer = True

 &nbsp; '&nbsp; this step is done in CDFGenerator.OnStartPage method
 &nbsp; Set AUO = Server.CreateObject("Membership.UserObjects")

 &nbsp; 
 &nbsp; '&nbsp; The run method does the following

 &nbsp; '&nbsp; Get the dispinterface to the CDFGenHelper object
 &nbsp; Set PushPrjHelper = Application("GenHelperProject1")

 &nbsp; '&nbsp; fetch the property names that store channel
 &nbsp; '&nbsp; channel selections from the project
 &nbsp; PushPrjHelper.GetSelectionListPropName( ListPropName, StylePropName )
 &nbsp; 
' get the list of channel GUIDs, and optionally, the style
' of the list
 &nbsp; ChannelList = AUO.Get ListPropName&nbsp;&nbsp; ' fetch the list
 &nbsp; ListStyle&nbsp;&nbsp; = AUO.Get StylePropName&nbsp; ' fetch type of list

 &nbsp; '&nbsp; Get the CDF string using the returned list and send it to
 &nbsp; '&nbsp; the built-in ASP Response object

 &nbsp; call PushProject.GetCDFString(ChannelList, ListStyle, Response.Write)

 &nbsp; '&nbsp; Set the outgoing MIME type explicitly
 &nbsp; Response.ContentType = "application/x-cdf"
 &nbsp; Response.End
%&gt; &nbsp; </code></pre>
<p>
<b>See Also</b></p>
<p>
<a href="pm_coclass_userobjects.htm">Class UserObjects (Membership.UserObjects)</a></p>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
</BODY>
</HTML>
