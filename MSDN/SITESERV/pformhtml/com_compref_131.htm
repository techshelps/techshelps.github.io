<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Predictor Example: Microsoft Press Product.asp</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h3><a name="com_compref_umyo"></a>Predictor Example: Microsoft Press Product.asp</h3>
<p>
The Product.asp page in the Microsoft Press starter site is generated when the visitor clicks a book title in a list of titles. The page displays information about the particular book. Using the <b>Predictor</b>, this page also displays other books that this customer might be interested in.</p>
<p>
Whereas the prediction in the Basket.asp page is based on the customer's shopping basket, the prediction on the Product.asp page is based primarily on the book being displayed. The assumption is that if the customer is interested in this book, he or she may have a preference for certain other books. The customer’s shopping basket may be empty at this point. However, if the shopping basket does contain items, the logic of this page also takes those items into account in generating the suggestions, and prevents any items already ordered from appearing in the list of suggestions.</p>
<p>
The following script accomplishes this logic by building a customer interest list containing both the book currently displayed on this page as well as any items in the shopping basket, but with the <b>Quantity</b> property for the current book artificially set to 100. This weighting causes the <b>Predictor</b> to place the greatest emphasis on the current book, while still considering any books already in the basket. In this way, none of the suggestions will duplicate the contents of the basket.</p>
<p>
Specifically, the following script creates a <b>SimpleList</b> object called <code>thisitems</code> to serve as the customer interest list. The script then adds the current book to this list, in the form of a <b>Dictionary</b> object that contains the SKU of the current book and the <b>Quantity</b> of 100.</p>
<p>
Next, the script iterates through the customer’s order form and copies each item from the order form to the customer interest list, using the actual quantities ordered (<code>orderitem</code> is defined as the item list in the shopping basket by the statement <code>set orderitem = mscsOrderForm.items</code>, which appears<code> </code>in Order_bar.asp):</p>
<p>
Finally, the generated customer interest list is passed to the <b>Predictor</b>’s <b>GetPredictions</b> method. The remainder of the page displays the list of suggestions in the same manner as the Microsoft Press Basket.asp page:</p>
<pre><code>set predictor = Application("MSCSPredictor")
set interestList = Server.CreateObject("Commerce.SimpleList")

set thisitem = Server.CreateObject("Commerce.Dictionary")
thisitem.sku = CStr(sku)
thisitem.quantity = 100
interestList.add(thisitem)

for i = 0 to orderitem.Count - 1
    set thisitem = Server.CreateObject("Commerce.Dictionary")
    thisitem.quantity = orderitem(i).quantity
    thisitem.sku = orderitem(i).sku
    interestList.add(thisitem)
next

set products = predictor.GetPredictions(interestList, 3, 0.1, 2)
</code></pre>
<p>
The parameters passed to <b>GetPredictions</b> are the list of current items and quantities (<code>thisitems</code>), the desired number of suggestions to return (<code>3</code>), the <i>PopularItemFilter</i> (the value of <code>0.1</code> indicates that <b>GetPredictions</b> should include popular products in the suggestion list if they are relevant), and the <i>RequiredMatches</i> (the value of <code>2</code> in this example ensures that the returned list will be a composite of purchases of at least two similar customers).</p>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
