<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The Refresh Cycle and the Channel Agent</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="pu_guide_the_refresh_cycle_and_the_channel_agent"></a>The Refresh Cycle and the Channel Agent</h1>
<p>
The refresh cycle is a generic phrase used to describe what happens when the <b>Refresh</b> method is invoked on an <b>IChannel</b> or <b>IProject </b>dispinterface.&nbsp; When this occurs, it is said that the <i>refresh cycle</i> for the channel or project has begun.</p>
<p>
During this cycle, a <b>Channel</b> object runs a script called a <b>Channel Agent</b>.&nbsp; It does this using an <i>Active Scripting Host</i>.&nbsp; This process is similar to the one used with the <i>Windows Scripting Host</i> (WSH) and the <i>Active Server Pages</i> (ASP) system of Internet Information Server 3.0 and above.&nbsp; In the case of the channel scripting host, four dispinterfaces are passed to the namespace for the executing script (agent).&nbsp; They are listed below along with a brief description.</p>
<p>
<b>Intrinsic Namespace Interfaces</b></p>
<p class=dt>
<i>channel</i></p>
<p class=indent>
this name specifies an <b>IChannel</b> dispinterface on the <a href="pushclassesref_8.htm">Channel</a><u> </u>object running the refresh cycle.</p>
<p class=dt>
<i>project</i></p>
<p class=indent>
this name specifies an <b>IProject</b> dispinterface.&nbsp; This interface is passed to the <b>Refresh</b> method directly or indirectly.&nbsp; See the <a href="pushclassesref_91.htm">Project Class</a>.</p>
<p class=dt>
<i>options</i></p>
<p class=indent>
this name specifies a dispinterface to the <a href="pushclassesref_145.htm">class Dictionary object</a> referred to by the name <a href="pushclassesref_26.htm">RefreshOptions</a> on the <b>Channel</b> object.&nbsp; This collection is used to pass refresh option information to the agent for the refresh cycle.</p>
<p class=dt>
<i>util</i></p>
<p class=indent>
this name specifies a dispinterface to methods that perform routine tasks useful within an agent.</p>
<p>
Any agent script can access these interfaces by name as if they were intrinsic, just as an ASP page script can access the <b>Request</b> interface within an ASP page. </p>
<p>
<b>Scheduling Refresh Cycles for Automatic Execution</b></p>
<p>
An instance of the <b>Task</b> class can be used to schedule a routine refresh cycle on a given project using the Microsoft Scheduled Tasks Administrative tool that comes with Site Server 3.0 and later versions of Microsoft Windows NT.</p>
<p>
<b>Project Vs Channel Refresh</b></p>
<p>
Each <b>Channel</b> object can have its own agent and refresh options configured.&nbsp; Normally, one would configure the main channels of a project with various refresh channel agents and then schedule a task with the Scheduled Tasks Administrative tool.&nbsp; This would call <b>Refresh</b> on the <b>Project</b> object's <b>IProject</b> dispinterface.&nbsp; When this occurs, the <b>RefreshAll</b> method is invoked on the top-level channel's <b>IChannel</b> dispinterface.&nbsp; This recursively invokes the <b>RefreshAll</b> method on all <b>Channel</b> object in the content hierarchy for the project.&nbsp; Hence, the entire project and all of its subordinate <b>Channel</b> objects have the refresh cycle run.</p>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
</BODY>
</HTML>
