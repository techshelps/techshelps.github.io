<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Dispinterface IChannel Refresh Method</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="pu_channel_class_methods_refresh"></a>Refresh Method</h1>
<p>
This method runs the refresh cycle on the <b>Channel</b> object.</p>
<p>
<b>VBScript Syntax</b></p>
<pre><code><i>IChannel</i>.<b>Refresh</b>  <i>IProject</i></code></pre>
<p>
<b>Parameters </b></p>
<p class=dt>
<i>IProject</i> </p>
<p class=indent>
An <b>IProject</b> dispinterface (VT_DISPATCH)</p>
<p>
<b>Return Value </b></p>
<p>
None </p>
<p>
<b>Remarks</b></p>
<p>
The <b>Refresh</b> method runs the refresh cycle for this <b>Channel</b> object. When the method executes, it checks the <b>RefreshType</b> property value. If the string is not "userscript", "custom", "manual" or "none", it checks the appropriate registry location for a key that matches the string (case is ignored). When found, it finds the agent's corresponding "Script Name" named value. It then gets the "Script Language" named value that holds the corresponding scripting language identifier. Using these two values, it creates an <i>Active Scripting Host</i> to execute the agent. It passes four dispinterfaces to the host so that they appear within the namespace of the agent script. These interfaces and their corresponding namespace names are listed in the table below</p>
<table border=0 cellpadding=5 cols=2 frame=below width=587>
<tr valign=top>
<td width=26%><b>Namespace name</b></td>
<td width=74%><b>dispinterface</b></td>
</tr>
<tr valign=top>
<td width=26%>channel</td>
<td width=74%>The <b>IChannel</b> interface for the <b>Channel </b>object.</td>
</tr>
<tr valign=top>
<td width=26%>project</td>
<td width=74%>The <b>IProject</b> dispinterface passed to the method as an argument.</td>
</tr>
<tr valign=top>
<td width=26%>options</td>
<td width=74%>The dispinterface on the <b>Dictionary</b> object referred to by the <b>RefreshOptions</b> collection.</td>
</tr>
<tr valign=top>
<td width=26%>util</td>
<td width=74%>A dispinterface on a "utility" object. </td>
</tr>
</table><br>
<p>
If the <b>RefreshType</b> property is set to "userscript" or "custom," the process is the same, except that the file parsed and executed is pointed to by the <b>RefreshScript</b> property. If the <b>RefreshType</b> property value is "manual" or "none" no refresh cycle occurs.</p>
<p>
The registry keys used by the <b>Refresh</b> method are all found under the key:</p>
<p>
HKLM\Software\Microsoft\Site Server\3.0\Active Channel\Active Channel Agents\. </p>
<p>
<b>Example</b></p>
<p>
VBScript</p>
<pre><code>Set IProject = CreateObject("push.project.1")
Set IChannel = IProject.Channel
IChannel.RefreshType = "File System"
IChannel.RefreshOptions("directory") = "c:\channelcontent\"
IChannel.RefreshOptions("matchcriteria") = Array("*.asp","*.htm","*.doc")
' before
wscript.echo "before refresh"
wscript.echo IChannel.GetCDFString IProject
IChannel.Refresh IProject
' channel has the filesystem agent refresh it
wscript.echo "after refresh"
wscript.echo IChannel.GetCDFString IProject

</code></pre>
<p>
<b>See Also</b></p>
<p>
<a href="pushclassesref_97.htm">IProject Refresh Method</a></p>
<p>
<a href="pushclassesref_26.htm">RefreshOptions Collection</a></p>
<p>
<a href="pushclassesref_24.htm">RefreshType Property</a></p>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
</BODY>
</HTML>
