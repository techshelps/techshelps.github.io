<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SimpleVATTax</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_tools_eahx"></a><sup></sup>SimpleVATTax</h2>
<p>
The <b>SimpleVATTax </b>component, which appears in the Tax stage of an order processing pipeline, calculates the Value Added Tax (VAT).
<ul>
<li>
&upsilon;<b>Key</b>. (Read-only) The name of a property on the order form used to specify tax method. The value of this property is compared to the string specified in the <b>Method</b> field to determine whether to apply the tax to the order.</li>
<li>
&upsilon;<b>Apply when</b>. Specifies when to apply the tax.<ul>
<li>
&upsilon;<b>Equal to Country</b>. Specifies that the tax will be applied only if the value of the property specified for <b>Key</b> is the same as the string specified in the <b>Country</b> field.</li>
<li>
&upsilon;<b>Has any value</b>. Specifies that the tax will be applied when the value of the property specified for <b>Key</b> has any value on the order form. If you select this option, the <b>Country</b> field should be left blank.</li>
<li>
&upsilon;<b>Always</b>. Specifies that the tax is always applied to the order.</li>
</ul>
</li>
<li>
&upsilon;<b>Country</b>. If <b>Equal to Country</b> is selected, specifies a string that the component compares with the value of <b>ship_to_country</b> on the order form to determine whether to apply the tax to the order. The tax will be applied only if there is an exact match. </li>
<li>
&upsilon;<b>Rate Item Key</b>. Specifies the name of the field in the item <b>Dictionary</b> that contains the tax rate charged for the item.</li>
</ul>
<h5>Note</h5>
<p>
The <b>SimpleVATTax</b> component is a simple tool for you to use to calculate tax rates. Microsoft strongly recommends that you have an independent tax professional verify all applicable tax rates and data generated by this component before you use such information for personal or business purposes.</p>
<h4>Remarks</h4>
<p>
<b>SimpleVATTax</b> always sets <code>_tax_total</code> name/value pairs to zero (0) for both the item and the order. The component does not handle fractions of currency units; all calculations are rounded to the nearest whole unit.</p>
<p>
The combination of the <b>Key</b>, <b>Apply when</b>, and <b>Country</b> fields determine whether tax should be applied.</p>
<p>
The <b>SimpleVATTax </b>component first checks the <b>Apply when </b>value. If it is set to <b>Always</b>, the tax is always applied to the order. If <b>Apply when</b> is set to <b>Has any value</b>, the tax is applied to the order whenever the order form contains any value for <b>ship_to_country</b>. If <b>Apply when</b> is set to <b>Equal to Country</b>, the component does a comparison between the value of <b>ship_to_country </b>on the order form and the text string in the <b>Country</b> field on this property page. If there is a match, the component applies the tax whose value is stored in the field specified in <b>Rate Item Key</b>.</p>
<h4>Example</h4>
<p>
To specify that a VAT tax rate of 6.5% is charged for an item in Germany, do the following:
<ol>
<li>
Add a column for the VAT rate in Germany to your product table. The tax rate should be specified as a real number:<pre><code>ger_vat_tax_rate   real  NOT NULL
</code></pre>
</li>
<li>
Assign tax rates to each product in your product table using an SQL script. For this example, assign the 6.5% VAT rate to <code>Product ABC</code>. Type <b>6.5</b> into the <code>ger_vat_tax_rate </code>column in the <code>Product ABC</code> row.<ol start=3>
<li>
Double-click the <b>SimpleVATTax</b> icon in the Win32-based Pipeline Editor, or click the <b>Edit</b> link for the component in the ASP-based Pipeline Editor and enter the following in the resulting property page.</li>
</ol>
</li>
</ol>
<table cellspacing=4 cols=2 width=464>
<tr valign=top>
<th align=left width=48%>Field</th>
<th align=left width=52%>Value</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%></td>
</tr>
<tr valign=top>
<td width=48%><b>Apply when</b></td>
<td width=52%>Always</td>
</tr>
<tr valign=top>
<td width=48%><b>Country</b></td>
<td width=52%>GER</td>
</tr>
<tr valign=top>
<td width=48%><b>Rate Item Key</b></td>
<td width=52%>_product_get_vat_tax_rate</td>
</tr>
</table><br>
<p>
If the customer types a country on the <b>OrderForm</b> that is not specified in the <b>SimpleVATTax</b> component configuration, the values of the <code>_tax_total</code> and <code>_tax_included</code> name/value pairs on the order and on the items will not be set.</p>
<h4>Related Topics</h4>
<ul>
<li>
&upsilon;<a href="com_opp_24.htm">Component Coordination</a></li>
</ul>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
