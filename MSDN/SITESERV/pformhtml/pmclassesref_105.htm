<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Interface ILdapCfg CompactDatabase Method</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="pm_class_ldapcfg_interface_ildapcfg_compactdatabase"></a>CompactDatabase Method</h1>
<p>
This method will compact the backend Access database used by the specified LDAP server instance.</p>
<p>
<b>IDL Definition</b></p>
<pre><code><b>HRESULT CompactDatabase( [in] VARIANT </b><i>lInstanceId</i><b>);
</b></code></pre>
<p>
<b>Parameter</b></p>
<p class=dt>
<i>lInstanceId</i></p>
<p class=indent>
The LDAP server instance identifier.</p>
<p>
<b>Return Values</b></p>
<p>
a standard HRESULT value</p>
<p>
<b>Remarks</b></p>
<p>
This procedure is only applicable to LDAP servers that use Access as an underlying database. </p>
<p>
WARNING: The given LDAP server instance will be stopped and restarted during the compaction process. This is necessary in order for the Access DB driver to obtain an exclusive lock on the database as mandated by its compaction procedure. </p>
<p>
The <b>CompactDatabase</b> method will fail if another LDAP instance, aside from the given one, is also using the same Access Database.&nbsp; Such instances must be stopped in order for the compact operation to succeed. </p>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
</BODY>
</HTML>
