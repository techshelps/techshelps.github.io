<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Interface IVerifUsr VerifyCredentials Method</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="pm_class_verifusr_interface_iverifusr_verifycredentials"></a>VerifyCredentials Method</h1>
<p>
This method verifies that the passed arguments <i>bszUsername</i> and <i>bszPassword</i> are correct by contacting the appropriate Membership virtual server instance.&nbsp; If they are correct, an appropriate cookie is issued to the user, and the passed URL argument is returned.&nbsp; If the username and password are not valid, no cookie is issued, and the URL returned points to a predefined registration page.</p>
<p>
<b>IDL Definition</b></p>
<pre><code><b>HRESULT VerifyCredentials(
BSTR </b><i>bszUserName</i><b>, 
BSTR </b><i>bszPassword</i><b>, 
BSTR </b><i>bszURL</i><b>, 
[out, retval] BSTR * </b><i>pbstrUrlToRedirect</i><b>
);</b></code></pre>
<p>
<b>Parameters</b></p>
<p class=dt>
<i>bszUserName</i></p>
<p class=indent>
The username to check along with a password</p>
<p class=dt>
<i>bszPassword</i></p>
<p class=indent>
The password to check along with a username</p>
<p class=dt>
<i>bszURL</i></p>
<p class=indent>
The URL to send the user if the presented credentials are valid.</p>
<p class=dt>
<i>pbstrUrlToRedirect</i></p>
<p class=indent>
On return, the URL to redirect the client.&nbsp; This value is dependent on whether the client's presented credentials were valid or not.&nbsp; If the credentials are valid, the <i>bszURL</i> value is returned.&nbsp; Otherwise, a predefined error/registration URL is returned.</p>
<p>
<b>Return Values</b></p>
<p>
A standard HRESULT value</p>
<p>
<b>Remarks</b></p>
<p>
This method should be used in ASP pages for IIS server instances mapped to Authentication server instances that have "Membership" authentication set, and is most useful when "Forms Authentication" is being used. One then uses this method to perform the verification of credentials. Once the user has successfully provided authentic credentials to the <b>VerifyCredentials </b>method, the necessary cookies are sent in the response that then allow the user to access content.&nbsp; </p>
<p>
In any case, a user must have the necessary cookies issued to proceed to content without being sent back to the login page.&nbsp; </p>
<p>
<b>Example</b></p>
<p>
VBScript in an ASP page</p>
<p>
Assume ”forms authentication" is being used for this IIS server.&nbsp; Further assume the items <i>Username</i> and <i>Password</i> are collected through an HTML form that has it's ACTION attribute set to an ASP script with the following code included. A "success" target URL is set up in the form if login is successful, usually as a "hidden" variable in the form.</p>
<pre><code>&lt;% 
Name&nbsp; = Request("UserName")
Password = Request("Password")
URL = Request("SuccessURL")
Set IVerifUsr = Server.CreateObject("Membership.VerifUsr.1")
If IVerifUser.
returnedURL = oVerifUsr.VerifyCredentials(Name,Password,URL)
Response.Redirect returnedURL
%&gt;</code></pre>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
</BODY>
</HTML>
