<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding the Property Page</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h3><a name="com_writingcomponents_heqf"></a>Adding the Property Page</h3>
<p>
A property page consists of a dialog resource, and class derived from <b>IPropertyPagesImpl</b> that is designed to manage this resource.</p>
<p>
The <b>IPropertyPagesImpl</b> method supports a default implementation of the <b>Activate</b> and <b>Apply</b> methods. The <b>Activate</b> method is called by the Win32®-based Pipeline Editor when the property pages for a component are displayed. The Apply method is called when the user clicks the <b>Apply</b> button on the property pages dialog box.</p>
<p>
Using the Visual C++ user interface to add a property page to the MinMaxShip project results in a default implementation of <b>IPropertyPagesImpl</b>.</p>
<h5>To add a property page to MinMaxShip</h5>
<ol>
<li>
Start the ATL Object Wizard, click <b>Controls</b>, click <b>Property Page</b>, and then click <b>Next</b>.</li>
</ol>
<p>
<img src="tut_addproppg.gif" border=0>
<ol start=2>
<li>
You again get the dialog box allowing you to type the name of the object. Call the object <b>MinMaxPropPg</b> and type that name in the <b>Short Name</b> edit box.</li>
</ol>
<p>
<img src="tut_addproppg2.gif" border=0></p>
<p class=indent1>
Notice that the <b>Interface</b> edit box appears dimmed. This is because a property page does not need a custom interface.</p>
<ol start=3>
<li>
Click the <b>Strings</b> tab to set the title of the property page. The title of the property page is the string that appears in the tab for that page. The <b>Doc String</b> is a description that a property frame could use to put in a status line or tool tip. The standard property frame currently does not use this string, but you can set it anyway. You are not going to generate a Helpfile at the moment, so delete the entry in that text box. Click <b>OK</b>, and the property page object will be created.</li>
</ol>
<p>
<img src="tut_addproppg3.gif" border=0></p>
<p>
The following three files are created.</p>
<table cellspacing=4 cols=2 width=464>
<tr valign=top>
<th align=left width=48%>File</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%></td>
</tr>
<tr valign=top>
<td width=48%>MinMaxPropPg.h</td>
<td width=52%>Contains the C++ class <b>CMinMaxPropPg</b>, which defines the property page.</td>
</tr>
<tr valign=top>
<td width=48%>MinMaxPropPg.cpp</td>
<td width=52%>Includes the MinMaxPropPg.h file, and implements the <b>Apply</b> and <b>Activate</b> functions.</td>
</tr>
<tr valign=top>
<td width=48%>MinMaxPropPg.rgs</td>
<td width=52%>The registry script that registers the property page object.</td>
</tr>
</table><br>
<p>
The new property page is added to the object entry map in MinMaxShip.cpp. A reference to the <b>MinMaxPropPg</b> class is added to the MinMaxShip.idl file. The new registery script file, MinMaxPropPg.rgs is added to the project resource. A dialog box template is added to the project resource for the property page. The property strings you specified are added to the resource string table.</p>
<p>
Your final step in creating the property page is to open the project’s resource file, display the dialog template for the property page (IDD_MINMAXPROPPG), and add the controls through which the user of the MinMaxShip component will modify the component’s properties.</p>
<p>
When you are finished, the dialog template should look like this one.</p>
<p>
<img src="tut_addproppg4.gif" border=0></p>
<p>
The edit controls should be given the following resource identifiers, in this order:</p>
<p>
IDC_PERCENTAGE, IDC_MINSHIPPING</p>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
