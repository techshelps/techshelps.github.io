<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SendFiles Method</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="cd_replicationclient_sendfiles_method"></a>SendFiles Method</h1>
<p>
This method sends an array of files to each destination server defined for the project. </p>
<p>
<b>Syntax</b></p>
<p>
<i>ReplicationClient</i><b>.SendFiles(</b><i>FileArray</i><b>)</b></p>
<p>
<b>Parameters</b></p>
<p class=dt>
<i>FileArray</i></p>
<p class=indent>
The array of files to replicate. The file paths should not include a full path, but should be relative to the project. </p>
<p>
<b>Remarks</b></p>
<p>
You must have Site Server Publishing administrator privileges on the server to call this method.</p>
<p>
If a connection has already been established, this method sends the files. Otherwise, it connects, sends the files, and disconnects, committing the files. If transaction processing is turned on at the destinations, then the file transaction is not applied until either a <b>Commit</b> or <b>Disconnect</b> is called.</p>
<p>
Since this method does not go through the Content Deployment server on the source machine, the replication information is not logged on the source.</p>
<p>
Note</p>
<p class=indent>
You cannot run both the <b>SendFiles</b> method and a replication on a source machine at the same time. If you attempt to run both, Content Deployment refuses and issues an error message.</p>
<p>
<b>Example</b></p>
<p>
The following example sends the files Newfile1.htm through Newfile10.htm to Project1's destination servers.</p>
<pre><code>Option Explicit 
On Error Resume Next

const NumFiles = 10

dim Client
set Client = CreateObject("CrsApi.ReplicationClient")
Client.Initialize("Project1")

dim i, FileList[NumFiles - 1] 

for i = 0 to NumFiles
  FileList[i] = "Newfile" &amp; i &amp; ".htm"
next

Client.SendFiles FileList 

'Release Client object
set Client = Nothing
</code></pre>
<p>
<b>See Also</b></p>
<p>
<a href="cd_sdk_10.htm">DeleteFile</a>, <a href="cd_sdk_12.htm">GetExtendedErrorInfo</a>, <a href="cd_sdk_14.htm">SendFile</a>, <a href="cd_sdk_105.htm">ReplicationProject.EnumDestination</a></p>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
</BODY>
</HTML>
