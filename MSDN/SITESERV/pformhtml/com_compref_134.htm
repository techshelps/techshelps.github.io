<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Predictor.InitPredictor Method</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_compref_kpxw"></a><sup></sup>Predictor.InitPredictor Method</h2>
<p>
The <b>InitPredictor</b> method builds a knowledge base of customer preferences by examining a database table containing the site purchase history. The method merges purchases by shopper ID, creating <i>merged baskets</i> that contain all purchases for each unique customer in the site’s purchase history.</p>
<p>
The <b>InitPredictor</b> method returns the total number of merged baskets that it has loaded into the knowledge base. This value may be used to verify that the <b>Predictor </b>object has correctly processed the site purchase history. Also, when used in combination with the number of matches returned by the <b>GetPredictions</b> method, the value can help to determine the validity of a particular suggestion.</p>
<h4>Syntax</h4>
<p>
<i>Predictor</i><b>.InitPredictor(</b><i>DSN</i>, <i>Table, UserColumn, SKUColumn, QuantityColumn, MaxMemory</i><b>)</b></p>
<h4>Parameters</h4>
<dl>
<dt>
<i>DSN</i></dt>
<dd>
The data source name (DSN) for the table containing the site purchase history.</dd>
<dt>
<i>Table</i></dt>
<dd>
The name of the table containing the site purchase history.</dd>
<dt>
<i>UserColumn</i></dt>
<dd>
The name of the column that contains the shopper ID. This must be a column in <i>Table</i>.</dd>
<dt>
<i>SKUColumn</i></dt>
<dd>
The name of the column that contains the SKU of the item(s) ordered. This must be a column in <i>Table</i>.</dd>
<dt>
<i>QuantityColumn</i></dt>
<dd>
The name of the column that contains the quantity of items ordered. This must be a column in <i>Table</i>.</dd>
<dt>
<i>MaxMemory</i></dt>
<dd>
The maximum amount of memory, in kilobytes (K), to allocate to the knowledge base. This setting must be at least 1000 (1 megabyte (MB) of memory). A recommended size is 4000 (indicating that a maximum of 4 MB of RAM could be used by the object). The object uses this limit in determining which baskets (sets of SKUs associated with a single customer) to sample for its analysis. If the <i>MaxMemory</i> parameter is less than the amount needed to store a complete knowledge base, priority is given to those merged baskets containing the most items. (Baskets are merged for all purchases with the same shopper ID in the site purchase history.)
<p>
Additional memory generally improves performance. Because the quality of recommendations increases significantly with the size of the sample that the <b>Predictor</b> object can accommodate, higher settings of this parameter are recommended. This parameter sets the limit of memory used. The <b>Predictor</b> object does not necessarily use all the memory specified. 

<p>
The following table may be used to determine suggested memory sizes (in kilobytes). The table maps the approximate number of unique SKUs appearing in the site’s purchase history (from 100 to 100,000 SKUs) against an estimate of the number of SKUs each individual customer has purchased, based on shopper ID in the site’s purchase history (an average of either 10 or 3 SKUs per basket). The table suggests memory requirements based on average number of baskets per SKU (thickness of the data) between 20 and 50.

<table cellspacing=4 cols=3 width=446>
<tr valign=top>
<th align=left width=28%>Unique SKUs in site purchase history</th>
<th align=left width=28%>Average SKUs per customer</th>
<th align=left width=44%>Suggested memory requirement (KB)</th>
</tr>
<tr valign=top>
<td colspan=3 width=100%></td>
</tr>
<tr valign=top>
<td width=28%>100</td>
<td width=28%>10</td>
<td width=44%>1,000</td>
</tr>
<tr valign=top>
<td width=28%>100</td>
<td width=28%>3</td>
<td width=44%>1,000</td>
</tr>
<tr valign=top>
<td width=28%>1,000</td>
<td width=28%>10</td>
<td width=44%>1,100–1,900</td>
</tr>
<tr valign=top>
<td width=28%>1,000</td>
<td width=28%>3</td>
<td width=44%>1,600–3,100</td>
</tr>
<tr valign=top>
<td width=28%>10,000</td>
<td width=28%>10</td>
<td width=44%>3,500–7,400</td>
</tr>
<tr valign=top>
<td width=28%>10,000</td>
<td width=28%>3</td>
<td width=44%>6,000–13,600</td>
</tr>
<tr valign=top>
<td width=28%>20,000</td>
<td width=28%>10</td>
<td width=44%>6,500–14,200</td>
</tr>
<tr valign=top>
<td width=28%>20,000</td>
<td width=28%>3</td>
<td width=44%>11,400–26,700</td>
</tr>
<tr valign=top>
<td width=28%>100,000</td>
<td width=28%>10</td>
<td width=44%>30,300–69,200</td>
</tr>
<tr valign=top>
<td width=28%>100,000</td>
<td width=28%>3</td>
<td width=44%>55,200–131,500</td>
</tr>
</table><br>


</dd>
</dl>
<h4>Example</h4>
<p>
The following example, from Microsoft Press Global.asa, initializes the knowledge base:</p>
<pre><code>call MSCSPredictor.InitPredictor(MSCSSite.DefaultConnectionString, "mspress30_predictor_data", "shopper_id", "sku", "quantity", 2000)
</code></pre>
<p>
You can also make use of the value returned as an additional determination of validity. The following example performs the initialization and saves the value returned (the total number of merged baskets loaded into the knowledge base):</p>
<pre><code>Application("predictorBaskets") = MSCSPredictor.InitPredictor(MSCSSite.DefaultConnectionString, "mspress30_predictor_data", "shopper_id", "sku", "quantity", 2000)
</code></pre>
<p>
Using this value, you can add a test for a reasonable number of baskets to determine whether to call the <b>GetPredictions</b> method:</p>
<pre><code>if Not IsNull(predictor) and Not IsEmpty(predictor)  and 
      Application("predictorBaskets") &gt; 20 then
   set products = predictor.GetPredictions(orderItems, 6, 0.3, 2)
   REM display suggestions
</code></pre>
<h4>Remarks</h4>
<p>
The knowledge base is created or updated only by calling the <b>InitPredictor</b> method. If the <b>InitPredictor</b> method is called in Global.asa, then the knowledge base will be updated only when the application is started.</p>
<p>
The site purchase history may have any valid name, and its columns may have any valid name, because the <b>InitPredictor</b> method accepts arbitrary names. Furthermore, the columns may appear in any order in the table, and the table may optionally contain other columns as well.</p>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
