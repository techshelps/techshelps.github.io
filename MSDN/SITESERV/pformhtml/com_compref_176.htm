<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Content.AddQuery Method</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_compref_awdt"></a><sup></sup>Content.AddQuery Method</h2>
<h5>Note</h5>
<p>
The <b>Content </b>object is included in Commerce Server 3.0 only for backward compatibility with sites created in Commerce Server 2.0. New sites should be constructed using ADOs. Connection strings (not DSNs) should be stored in the <b>ConnectionStringMap </b>(part of the site dictionary) and queries should be stored in the <b>QueryMap Dictionary</b> object.</p>
<p>
The <b>AddQuery</b> method adds a query variable to the <b>Content</b> object.</p>
<h4>Syntax</h4>
<p>
<i>Content</i><b>.AddQuery(</b><i>QueryName</i>, <i>QueryText</i>, <i>Timeout</i>, <i>CommandType</i>, <i>MaximumRows</i>, <i>CursorType</i>, <i>CursorSize</i>, <i>RetrievalMethod</i><b>)</b></p>
<h4>Parameters</h4>
<dl>
<dt>
<i>QueryName</i></dt>
<dd>
A string variable that identifies the query. This name must be a non-Null string, but can contain spaces, numbers, and other non-Null characters.</dd>
<dt>
<i>QueryText</i></dt>
<dd>
The SQL text of the query.</dd>
<dt>
<i>Timeout</i></dt>
<dd>
Optional. A number that specifies the period of time, in seconds, to wait for the database to respond after an operation has been executed. A value of zero (0) indicates that the defaults for the database driver should be used. This value should be increased for database operations that are slow, or during operations that are known to take more time than is allowed by the default.</dd>
<dt>
<i>CommandType</i></dt>
<dd>
Optional. An integer constant that specifies the kind of command that <i>QueryText</i> represents. Specifying the precise type of the command (as opposed to <b>adCmdUnknown</b>), results in faster execution time. The following table lists the possible constant values.
<table cellspacing=4 cols=3 width=446>
<tr valign=top>
<th align=left width=24%>Constant</th>
<th align=left width=13%>Value</th>
<th align=left width=63%>Description</th>
</tr>
<tr valign=top>
<td colspan=3 width=100%></td>
</tr>
<tr valign=top>
<td width=24%><b>adCmdText</b></td>
<td width=13%>1</td>
<td width=63%>Evaluates <i>QueryText</i> as a textual definition of a command.</td>
</tr>
<tr valign=top>
<td width=24%><b>AdCmdTable</b></td>
<td width=13%>2</td>
<td width=63%>Evaluates <i>QueryText </i>as a table name.</td>
</tr>
<tr valign=top>
<td width=24%><b>AdCmdStoredProc</b></td>
<td width=13%>4</td>
<td width=63%>Evaluates <i>QueryText </i>as a stored procedure.</td>
</tr>
<tr valign=top>
<td width=24%><b>AdCmdUnknown</b></td>
<td width=13%>8</td>
<td width=63%>Type of command for the <i>QueryText </i>value is not known. This is the default value.</td>
</tr>
</table><br>

</dd>
<dt>
<i>MaximumRows</i></dt>
<dd>
Optional. The maximum number of rows to return. The default value is zero (0). Specifying a value greater than zero for queries that always return a small number of rows can substantially reduce the speed of query execution.</dd>
<dt>
<i>CursorType</i></dt>
<dd>
Optional. An integer constant that references the ADO cursor type. The <i>CursorType</i> is used most often in conjunction with the <i>CursorSize </i>parameter. This parameter can contain one of the following values.
<table cellspacing=4 cols=3 width=446>
<tr valign=top>
<th align=left width=33%>Constant</th>
<th align=left width=14%>Value</th>
<th align=left width=53%>Description</th>
</tr>
<tr valign=top>
<td colspan=3 width=100%></td>
</tr>
<tr valign=top>
<td width=33%><b>adOpenForwardReadOnly</b></td>
<td width=14%>0</td>
<td width=53%>Forward-only cursor. Identical to a static cursor except that you can only scroll forward through records. This improves performance in situations when you only need to make a single pass through a <b>Recordset</b>. (Default.) </td>
</tr>
<tr valign=top>
<td width=33%><b>adOpenKeyset</b></td>
<td width=14%>1</td>
<td width=53%>Keyset cursor. Like a dynamic cursor, except that you cannot view records that other users add, although records that other users delete are inaccessible from your <b>Recordset</b>. Data changes by other users are still visible.</td>
</tr>
<tr valign=top>
<td width=33%><b>adOpenDynamic</b></td>
<td width=14%>2</td>
<td width=53%>Dynamic cursor. Additions, changes, and deletions by other users are visible, and all types of movement through the <b>Recordset</b> are allowed, except for bookmarks if the provider does not support them. </td>
</tr>
<tr valign=top>
<td width=33%><b>adOpenStatic</b></td>
<td width=14%>3</td>
<td width=53%>Static cursor. A static copy of a set of records that you can use to find data or generate reports. Additions, changes, or deletions by other users are not visible. </td>
</tr>
</table><br>

</dd>
<dt>
<i>CursorSize</i></dt>
<dd>
Optional. A number that specifies the number of rows to gather at one time. Specifying a value of one (1) optimizes the server-side cursor by ensuring that the server never has to retrieve more than a single row in server memory at a time. The default value is zero (0).</dd>
<dt>
<i>RetrievalMethod</i></dt>
<dd>
Optional. A number that specifies the method to use to retrieve data from the results set. The default value is 2 (unknown). If you are using an Oracle database, the block retrieval method is unavailable; you must use the row retrieval option.
<p>
The following values can be used for this parameter.

<table cellspacing=4 cols=2 width=446>
<tr valign=top>
<th align=left width=9%>Value</th>
<th align=left width=91%>Description</th>
</tr>
<tr valign=top>
<td colspan=2 width=100%></td>
</tr>
<tr valign=top>
<td width=9%>0</td>
<td width=91%>Block retrieval. Indicates that the result set contains no long text or binary data, or that the database fully supports block retrieval of long data.</td>
</tr>
<tr valign=top>
<td width=9%>1</td>
<td width=91%>Row retrieval. Indicates that the database supports the retrieval of long data, but only on a row-by-row basis.</td>
</tr>
<tr valign=top>
<td width=9%>2</td>
<td width=91%>Unknown. When you use this value, you effectively ask the system to determine for itself which method to call by searching for columns that contain binary data.</td>
</tr>
</table><br>


</dd>
</dl>
<h4>Remarks</h4>
<p>
When you execute a query using the <b>Datasource</b> object’s <b>Execute</b> method, you can simply pass <b>Execute</b> the name you have associated with the query through a call to <b>AddQuery</b>.</p>
<p>
Although you can also pass the <b>Execute</b> method the SQL text of a query that you have not added to the <b>Content</b> object, this results in a degradation in performance time. For optimal efficiency, you should always pass <b>Execute</b> query variables stored by <b>AddQuery</b> in the <b>Content </b>object’s query list.</p>
<p>
Additionally, if you pass <b>Execute</b> the text of your query, the <b>Datasource</b> object internally uses a set of default values for the <i>Timeout</i>, <i>CommandType</i>, <i>MaximumRows</i>, <i>CursorType</i>, and <i>CursorSize</i> values described previously, and you cannot override these defaults.</p>
<h4>Related Topics</h4>
<ul>
<li>
&upsilon;<a href="com_compref_175.htm"><b>Content.AddDatasource</b> Method</a></li>
</ul>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
