<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MapToXML</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_tools_ypvr"></a><sup></sup>MapToXML</h2>
<p>
The <b>MapToXML</b> component, which usually appears in the Map stage of a Commerce Interchange Transmit pipeline, reads the data stored in an object referenced by the name/value pair in the Transport Dictionary specified by the <b>Object Source Key</b> field. <b>MapToXML</b> converts this data to an XML stream or to an XML-enclosed binary stream. <b>MapToXML</b> then writes the resulting stream to the name/value pair in the Transport Dictionary specified by <b>Results XML Key</b>.
<ul>
<li>
&upsilon;<b>Object Source Key</b>. Specifies the name of a field on the Transport Dictionary from which the component reads the business data object.</li>
<li>
&upsilon;<b>Results XML Key</b>. Specifies the name of a field on the Transport Dictionary to which the component writes the XML-formatted business data object.</li>
<li>
&upsilon;<b>Preferred Data Format</b>. Specifies the preferred format into which the component translates the business data object.<ul>
<li>
&upsilon;<b>XML Tags</b>. Specifies that the entire business data object is to be translated into a pure XML stream.</li>
<li>
&upsilon;<b>Encoded Binary</b>. Specifies that the binary version of the business data object is to be wrapped in XML tags.</li>
</ul>
</li>
</ul>
<p>
If the object to be read implements <a href="com_interfaces_72.htm"><b>IPersistXML</b></a> or <a href="com_interfaces_66.htm"><b>IPersistStreamInit</b></a>, the output produced by <b>MapToXML</b> is as follows:</p>
<pre><code>&lt;MAPXML&gt;&lt;VALUE dt:dt="object" dt:classid="classid:<i>classid</i>"&gt;
&lt;<i>ObjectTag</i>&gt;
<i>Object Data</i>
&lt;/<i>ObjectTag</i>&gt;
&lt;/VALUE&gt;&lt;/MAPXML&gt;
</code></pre>
<p>
or, in the case of encoded binary format, in the following form:</p>
<pre><code>&lt;MAPXML&gt;&lt;VALUE dt:dt="object" dt:classid="classid:<i>classid</i>" dt:binary="1"&gt;
<i>Binary Object Data</i>
&lt;/VALUE&gt;&lt;/MAPXML&gt;
</code></pre>
<p>
The value 1 (one) following <code>binary</code> indicates that the result was mapped using the object’s <b>IPersistStream</b> interface; a value of 2 (two) indicates that the result was mapped using the object’s <b>IPersistStreamInit</b> interface.</p>
<h4>Example</h4>
<p>
Suppose a <b>Dictionary</b> object is created, as follows::</p>
<pre><code>Set myObj = Server.CreateObject("Commerce.Dictionary")
myObj.Company = "Microsoft"
</code></pre>
<p>
When this dictionary is passed to the <b>MapToXML </b>component, the component produces the following output, when the output is specified as XML tags:</p>
<pre><code>&lt;MAPXML&gt;&lt;VALUE dt:dt="object" dt:classid="classid:B7990D09-45FD-11D0-8176-00A0C90A90C7"&gt;
&lt;DICTIONARY&gt;
&lt;DICTITEM key="Company"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;Microsoft&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;/DICTIONARY&gt;
&lt;/VALUE&gt;&lt;/MAPXML&gt;    
</code></pre>
<p>
A <b>SimpleList</b> object created as follows:</p>
<pre><code>Set myObj = Server.CreateObject("Commerce.SimpleList")
Call myObj.Add("Microsoft")
</code></pre>
<p>
produces the following result when mapped to XML tags:</p>
<pre><code>&lt;MAPXML&gt;&lt;VALUE dt:dt="object" dt:classid="classid:B7990D0E-45FD-11D0-8176-00A0C90A90C7"&gt;
&lt;SIMPLELIST&gt;
&lt;LISTITEM&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;Microsoft&lt;/VALUE&gt;&lt;/LISTITEM&gt;
&lt;/SIMPLELIST&gt;
&lt;/VALUE&gt;&lt;/MAPXML&gt;
</code></pre>
<p>
The following example shows an order form that has been converted to XML by the <b>MapToXML </b>component. The example was produced by ordering a laser printer cartridge in the Microsoft Market sample site. </p>
<p>
The XML output reveals the structure of the order form object (the classID of which is 713DD5B1-747C-11D0-BE8A-00A0C90DC855). It contains a dictionary, which in turn contains name value pairs associated with the order. One of these values, <code>Items</code>, contains a <b>SimpleList</b> object, which consists of a list of the items ordered (in this case, only one). The list item, in turn, contains another dictionary, which contains values describing the item ordered (<code>SKU</code>, <code>Quantity</code>, and so on). </p>
<pre><code>&lt;MAPXML&gt;&lt;VALUE dt:dt="object" dt:classid="classid:713DD5B1-747C-11D0-BE8A-00A0C90DC855"&gt;
&lt;DICTIONARY&gt;
&lt;DICTITEM key="Items"&gt;&lt;VALUE dt:dt="object" dt:classid="classid:B7990D0E-45FD-11D0-8176-00A0C90A90C7"&gt;
&lt;SIMPLELIST&gt;
&lt;LISTITEM&gt;&lt;VALUE dt:dt="object" dt:classid="classid:B7990D09-45FD-11D0-8176-00A0C90A90C7"&gt;
&lt;DICTIONARY&gt;
&lt;DICTITEM key="SKU"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;OPPRINTER1001605&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="Quantity"&gt;&lt;VALUE dt:dt="i4"&gt;1&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="insertby"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;JoeStart&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="ReqClassCode"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;OP&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="ISOCurrencyCode"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;USD&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="RequisitionID"&gt;&lt;VALUE dt:dt="i4"&gt;10004&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="PartNumber"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;1001605&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="PartClassCode"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;PRINTER&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="Partdescription"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;Print Cartridge GGG Printer Black&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="isstandardpart"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;Y&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="UnitCode"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;EA&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="list_price"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;2519&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="AccountCode"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;728002&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="InternalOrder"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;1&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="placed_price"&gt;&lt;VALUE dt:dt="i4"&gt;2519&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;/DICTIONARY&gt;
&lt;/VALUE&gt;&lt;/LISTITEM&gt;
&lt;/SIMPLELIST&gt;
&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="RequisitionID"&gt;&lt;VALUE dt:dt="i4"&gt;10004&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="ReqStatusID"&gt;&lt;VALUE dt:dt="i2"&gt;2&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="insertby"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;JoeStart&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="DateCreated"&gt;&lt;VALUE dt:dt="dateTime.iso8601"&gt;19980206T11:34:34000&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="DateChanged"&gt;&lt;VALUE dt:dt="dateTime.iso8601"&gt;19980206T11:34:43000&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="ReqClassCode"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;OP&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="ISOCurrencyCode"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;USD&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="VendorNumber"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;0002001243&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="locale"&gt;&lt;VALUE dt:dt="i4"&gt;1033&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="order_id"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;DJUH21SKKES12MHD00L1R0D8N7&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="ReqName"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;Joe Start&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="ReqEmailalias"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;JoeStart&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="ApprovalManagerAlias"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;MaryJJJ&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="ReqPhone"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;454-9894&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="TransmissionRoom"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;2343&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="TransmissionLocation"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;100&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="TransmissionLine1"&gt;&lt;VALUE dt:dt="string" xml-space="preserve"&gt;Joe Start&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="TotalAtSubmit"&gt;&lt;VALUE dt:dt="i4"&gt;2519&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;DICTITEM key="needapproval"&gt;&lt;VALUE dt:dt="boolean"&gt;0&lt;/VALUE&gt;&lt;/DICTITEM&gt;
&lt;/DICTIONARY&gt;
&lt;/VALUE&gt;&lt;/MAPXML&gt;  
</code></pre>
<h4>Related Topics</h4>
<ul>
<li>
&upsilon;<a href="com_piperef_33.htm"><b>MapFromXML</b></a></li>
<li>
&upsilon;<a href="com_cic_10.htm">Using Mapping Components</a></li>
</ul>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
