<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AdServer Object Overview</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h1><a name="ad_adserver_object_overview"></a>AdServer Object Overview</h1>
<p>
The <b>AdServer</b> object is usually created in the <b>Application_OnStart</b> function defined in the Global.asa file. Use the Active Server Pages (ASP) <b>Server</b> object’s <b>CreateObject</b> method to create an <b>AdServer</b> object. In addition, properties of this object can be set in Global.asa:</p>
<pre><code>'&nbsp; Create the AdServer object
Set&nbsp; Ad = Server.CreateObject("Commerce.AdServer") 

Ad.ConnectionString = “DSN=adsamples;UID=sa;PWD=;”   

'&nbsp; Set AdServer properties
Ad.DefaultAd = "&lt;B&gt;&lt;FONT SIZE=+4 COLOR=BLUE&gt;&lt;MARQUEE WIDTH=400&gt;This is the default ad&lt;/MARQUEE&gt;&lt;/FONT&gt;&lt;/B&gt;"
Ad.RefreshInterval = 900
Ad.RetryInterval = 60
Ad.RedirectURL = "/adsamples/adredir.asp"
Ad.DesignMode = False
Ad.Application = "clocktower"
</code></pre>
<p>
Also in Global.asa, store the new object in the <b>Application</b> object, as follows:</p>
<pre><code>Set Application("Ad")&nbsp; = Ad
</code></pre>
<p>
Because the <b>AdServer </b>object is marked "both" under threading model, it has been designed to be "thread safe" and can be given application scope and used by ASP pages at any time without fear of data loss or collision.</p>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
</BODY>
</HTML>
