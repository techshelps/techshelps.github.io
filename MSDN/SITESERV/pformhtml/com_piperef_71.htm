<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TableShipping</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_tools_hkjv"></a><sup></sup>TableShipping</h2>
<p>
The <b>TableShipping</b> component, which appears in the Shipping stage of an order processing pipeline, sets the value of <code>_shipping_total</code> on the order form by using values retrieved from the database.</p>
<h5>Note</h5>
<p>
The <b>TableShipping</b> component is included in Commerce Server 3.0 only for backward compatibility with sites created in Commerce Server 2.0. Commerce Server 3.0 sites should use <b>TableShippingADO</b>.</p>
<ul>
<li>
&upsilon;<b>Key</b>. (Read-only) The name of a property on the order form used to specify shipping method. The value of this property is compared to the string specified in the <b>Method</b> field to determine whether to apply the shipping charge to the order.</li>
<li>
&upsilon;<b>Apply when</b>. Specifies when to apply the shipping charge.<ul>
<li>
&upsilon;<b>Equal to Method</b>. Specifies that the shipping charge should be applied if the value of the field specified for <b>Key</b> is the same as the string specified in the <b>Method</b> field. </li>
<li>
&upsilon;<b>Has Any Value</b>. Specifies that the shipping charge should be applied when the value of the field specified for <b>Key</b> has any value on the order form. If you select this option, the <b>Method</b> field should be left blank.</li>
<li>
&upsilon;<b>Always</b>. Specifies that the shipping charge is always applied to the order.</li>
</ul>
</li>
<li>
&upsilon;<b>Method</b>. If <b>Equal to Method</b> is selected, specifies a string that the component compares with the value of <b>shipping_method</b> on the order form to determine whether to apply the shipping charge to the order. The shipping charge will be applied only if there is an exact match.</li>
<li>
&upsilon;<b>Basis Item Key</b>. Specifies the property of the item that is used to compute the shipping charge. The component computes the charge by multiplying the value retrieved by the database query by the sum of the property specified for <b>Basis Item Key</b>. For example, you might base the shipping charge on the quantity of the items, and the <b>Basis Item Key</b> might be <b>sum.quantity</b>. If the order contains two items, one item with a quantity of four and the other item with a quantity of two, then the basis sum is six. The component multiplies the shipping charge by six. See <a href="com_opp_33.htm">Specifying the Basis Item Key</a>.</li>
<li>
&upsilon;<b>Query</b>. Specifies either the full SQL text of the query that is executed by this component or the name of a query whose full SQL text is stored in the <b>Content</b> object.</li>
<li>
&upsilon;<b>Order Key</b>. Specifies the property of the order as a whole that is used to compute the shipping charge. This key is the name of a column in a database table that specifies a per-order handling charge. This parameter is optional; if none is specified, it defaults to<code> ship_to_zip</code>.</li>
<li>
&upsilon;<b>Item Key</b>. Specifies the property of each item that is used to compute the shipping charge. This key is the name of a column in a database table that specifies a per-item handling charge. This parameter is optional; if none is specified, it defaults to <code>cost</code>.</li>
</ul>
<h4>Remarks</h4>
<p>
The combination of the <b>Key</b>, <b>Apply when</b>, and <b>Method</b> fields determine whether the handling should be applied to the order.</p>
<p>
The <b>TableHandling </b>component first checks the <b>Apply when </b>value. If it is set to <b>Always</b>, the shipping charge is always applied to the order. If <b>Apply when</b> is set to <b>Has any value</b>, the shipping charge is applied to the order whenever the order form contains any value for <b>shipping_method</b>. If <b>Apply when</b> is set to <b>Equal to Method</b>, the component does a comparison between the value of <b>shipping_method </b>on the order form and the text string in the <b>Method</b> field on this property page. If there is a match, the shipping charge is applied.</p>
<p>
If the component determines that the shipping charge should be applied, it then executes the query specified in <b>Query</b>. This query retrieves the per-item and per-order shipping charges from the database, and then uses the value of the <b>Basis Item Key</b> to compute the shipping charge.</p>
<h4>Related Topics</h4>
<ul>
<li>
&upsilon;<a href="com_opp_24.htm">Component Coordination</a></li>
</ul>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
