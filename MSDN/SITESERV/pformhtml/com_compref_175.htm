<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Content.AddDatasource Method</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css">
<br>
</HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="com_compref_hoib"></a><sup></sup>Content.AddDatasource Method</h2>
<h5>Note</h5>
<p>
The <b>Content </b>object is included in Commerce Server 3.0 only for backward compatibility with sites created in Commerce Server 2.0. New sites should be constructed using ADOs. Connection strings (DSNs) should be stored in the <b>ConnectionStringMap </b>(part of the site dictionary) and queries should be stored in the <b>QueryMap Dictionary</b> object.</p>
<p>
The <b>AddDatasource </b>method associates a configured file or system DSN with a string alias.</p>
<h4>Syntax</h4>
<p>
<i>Content</i><b>.AddDatasource(</b><i>Alias</i>, <i>ConnectionString</i><b>)</b></p>
<h4>Parameters</h4>
<dl>
<dt>
<i>Alias</i></dt>
<dd>
A string that identifies the name by which you will reference the DSN in your site.</dd>
<dt>
<i>ConnectionString</i></dt>
<dd>
A database connection string that contains connection and login information. Usually the database connection string is defined in the Dsn_include.asp file, which is included at the start of Global.asa.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If you use more than one DSN in a site, you should specify one of them as the default DSN for the site. To do this, set the <b>Application </b>object’s <b>MSCSDefaultDatasource</b> variable to reference the string variable name that you have associated with a DSN that you have added to the <b>Content </b>object query collection.</p>
<h4>Example</h4>
<p>
The following example, from the Clocktower sample site, creates a <b>Content</b> object, adds a DSN variable to the object, and makes that DSN the default DSN for the site:</p>
<pre><code>REM Create a Content object for access to the database
Set  MSCSContent = Server.CreateObject("Commerce.Content")
Call MSCSContent.AddDatasource("Clocktower", MSCSDSN)
Set  MSCSDataSource = MSCSContent.Datasource("Clocktower") 

' Later, in Application_OnStart
Application("MSCSDefaultDatasource") = "Clocktower"
</code></pre>
<h4>Related Topics</h4>
<ul>
<li>
&upsilon;<a href="com_compref_176.htm"><b>Content.AddQuery</b> Method</a></li>
</ul>
<!-----------------------------Copyright 1997-1998 Microsoft Corporation------------------------------>
<hr>
<center><font size=-1>
<A HREF="sdklegal.htm">&copy; 1997-1998 Microsoft Corporation. All rights reserved.</A>
</font></center>
<br>
<br>
<p>&nbsp;</p></body>
</HTML>
