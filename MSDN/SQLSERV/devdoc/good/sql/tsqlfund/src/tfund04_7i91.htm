<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The COMPUTE Clause</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_the_compute_clause"></a>The COMPUTE Clause</h2>
<p>
The COMPUTE clause is used in SELECT statements with row aggregate functions ¾ SUM, AVG, MIN, MAX, and COUNT ¾ to generate summary values based on the values in groups of rows.</p>
<p>
These summary values appear as new rows in the query results, allowing you to see both detail and summary rows in one set of results. (Compare this to results from aggregate functions and the GROUP BY clause, which appear as new columns.)</p>
<p>
The results of a query that includes a COMPUTE clause are like a control-break report, which is a report whose summary values are controlled by the groupings, or breaks, that you specify. You can produce summary values for groups, and you can calculate more than one aggregate function for the same group.</p>
<p>
Here's how to use the COMPUTE clause to calculate the sum for the prices of the different types of cookbooks:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<td colspan=3 width=100%><pre>SELECT type, price</pre>
</td>
</tr>
<tr valign=top>
<td colspan=3 width=100%><pre>FROM titles</pre>
</td>
</tr>
<tr valign=top>
<td colspan=3 width=100%><pre>WHERE type like '%cook'</pre>
</td>
</tr>
<tr valign=top>
<td colspan=3 width=100%><pre>ORDER BY type, price</pre>
</td>
</tr>
<tr valign=top>
<td colspan=3 width=100%><pre>COMPUTE SUM(price) BY type</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre></pre>
</td>
<td width=33%><pre></pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>type</pre>
</td>
<td width=33%><pre>price</pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>--------</pre>
</td>
<td width=33%><pre>-------------</pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>mod_cook</pre>
</td>
<td width=33%><pre>2.99</pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>mod_cook</pre>
</td>
<td width=33%><pre>19.99</pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre></pre>
</td>
<td width=33%><pre>sum</pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre></pre>
</td>
<td width=33%><pre>=============</pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre></pre>
</td>
<td width=33%><pre>22.98</pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre></pre>
</td>
<td width=33%><pre></pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>type</pre>
</td>
<td width=33%><pre>price</pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>---------</pre>
</td>
<td width=33%><pre>-------------</pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>trad_cook</pre>
</td>
<td width=33%><pre>11.95</pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>trad_cook</pre>
</td>
<td width=33%><pre>14.99</pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>trad_cook</pre>
</td>
<td width=33%><pre>20.95</pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre></pre>
</td>
<td width=33%><pre>sum</pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre></pre>
</td>
<td width=33%><pre>=============</pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre></pre>
</td>
<td width=33%><pre>47.89</pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre></pre>
</td>
<td width=33%><pre></pre>
</td>
<td width=34%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=3 width=100%><pre>(7 row(s) affected)</pre>
</td>
</tr>
</table><br>
<pre></pre>
<p>
Notice that the summary values appear as new rows in the results, labeled with the word "sum," and that all the detail rows are also included.</p>
<p>
With GROUP BY, detail rows are not shown, and the summary values are displayed as new columns. The same summary information can be produced with this statement:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<td colspan=3 width=100%><pre>SELECT type, SUM(price)</pre>
</td>
</tr>
<tr valign=top>
<td colspan=3 width=100%><pre>FROM titles</pre>
</td>
</tr>
<tr valign=top>
<td colspan=3 width=100%><pre>WHERE type LIKE '%cook'</pre>
</td>
</tr>
<tr valign=top>
<td colspan=3 width=100%><pre>GROUP BY type</pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre></pre>
</td>
<td width=19%><pre></pre>
</td>
<td width=48%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>type</pre>
</td>
<td width=19%><pre></pre>
</td>
<td width=48%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>---------</pre>
</td>
<td width=19%><pre>------</pre>
</td>
<td width=48%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>mod_cook</pre>
</td>
<td width=19%><pre>22.98</pre>
</td>
<td width=48%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre>trad_cook</pre>
</td>
<td width=19%><pre>47.89</pre>
</td>
<td width=48%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=33%><pre></pre>
</td>
<td width=19%><pre></pre>
</td>
<td width=48%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=3 width=100%><pre>(2 row(s) affected)</pre>
</td>
</tr>
</table><br>
<pre></pre>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
