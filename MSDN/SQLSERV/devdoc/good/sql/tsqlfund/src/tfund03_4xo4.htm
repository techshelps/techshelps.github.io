<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Changing Data with WRITETEXT</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_changing_data_with_writetext"></a>Changing Data with WRITETEXT</h2>
<p>
To update text or image values, use the WRITETEXT statement. By default, WRITETEXT statements (using <i>text</i> or <i>image</i> data) are not logged, so that the transaction log will not fill up with large amounts of data. </p>
<p>
<b>Note</b>  The system administrator must use the <b>sp_dboption</b> system procedure to set <b>select into/bulk copy</b> to <b>true</b> for the WRITETEXT statement to be used in its default, nonlogged state.</p>
<p>
The WRITETEXT statement completely overwrites any existing data in the column it affects. For WRITETEXT to work, the column must already contain a valid text pointer. There are two ways to create a text pointer:
<ul>
<li>
Insert actual data into the text or image column. </li>
<li>
Update the column with data or with NULL.</li>
</ul>
<p>
<b>Important</b>  After a WRITETEXT operation that does not include the WITH LOG option, a DUMP TRANSACTION operation will not archive changes made to a text or image column, because these changes were not recorded in the transaction log. In this situation, the only way to archive such changes is to use the DUMP DATABASE statement.</p>
<p>
Because an initialized text column uses at least one page (2K) of storage, even to store a couple of words, SQL Server saves space by not initializing text columns when explicit or implicit null values are placed in text columns with INSERT. For example:</p>
<pre>INSERT publishers
VALUES ('9925', 'New Publisher', 'Redmond', 'WA', 'USA')
go
INSERT pub_info
VALUES ('9925', NULL, NULL)
go
</pre>
<p>
After an INSERT operation, such as the one in the preceding example, you can use this UPDATE statement to initialize the text column:</p>
<pre>UPDATE pub_info
SET pr_info = null
WHERE pub_id = '9925'
</pre>
<p>
Once you have initialized the pointer, you can use WRITETEXT. This example adds text to an existing row in the <i>publishers</i> table:</p>
<pre>DECLARE @val varbinary(16)
SELECT @val = textptr(pr_info) FROM pub_info
WHERE pub_id = '9925'
WRITETEXT pub_info.pr_info @val WITH LOG
'Information about New Publisher.'
</pre>
<p>
This example puts the text pointer into the local variable <i>@val</i>. Then WRITETEXT places the new text string into the row pointed to by <i>@val</i>.</p>
<p>
For details on WRITETEXT, see the <a href="../../tsqlref/src/tsql27_35ys.htm">WRITETEXT statement</a> in the <i>Microsoft SQL Server Transact-SQL Reference</i>.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
