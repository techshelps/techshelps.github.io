<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Displaying Locking Information</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="displaying_locking_information"></a>Displaying Locking Information</h2>
<p>
To get a report on the locks currently held on SQL Server, use SQL Enterprise Manager. </p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To get a report on locks</h5>
<ul>
<li>
From the Server menu in SQL Enterprise Manager, choose Current Activity, and then examine the User Activity, Detail Activity, and Object Locks tabs in the Current Activity dialog box.</li>
</ul>
<p>
Or 
<ul>
<li>
Execute the <b>sp_lock</b> system procedure:<pre>sp_lock</pre>
</li>
</ul>
<table cellspacing=4 cols=5>
<tr valign=top>
<td width=15%><pre>spid</pre>
</td>
<td width=22%><pre>locktype</pre>
</td>
<td width=22%><pre>table_id</pre>
</td>
<td width=16%><pre>page</pre>
</td>
<td width=25%><pre>dbname</pre>
</td>
</tr>
<tr valign=top>
<td width=15%><pre>----</pre>
</td>
<td width=22%><pre>---------</pre>
</td>
<td width=22%><pre>--------</pre>
</td>
<td width=16%><pre>-----</pre>
</td>
<td width=25%><pre>-----------</pre>
</td>
</tr>
<tr valign=top>
<td width=15%><pre>1</pre>
</td>
<td width=22%><pre>Sh_intent</pre>
</td>
<td width=22%><pre>16003088</pre>
</td>
<td width=16%><pre>0</pre>
</td>
<td width=25%><pre>master</pre>
</td>
</tr>
<tr valign=top>
<td width=15%><pre>4</pre>
</td>
<td width=22%><pre>Ex_extent</pre>
</td>
<td width=22%><pre>0</pre>
</td>
<td width=16%><pre>440</pre>
</td>
<td width=25%><pre>pubs</pre>
</td>
</tr>
<tr valign=top>
<td width=15%><pre>4</pre>
</td>
<td width=22%><pre>Ex_extent</pre>
</td>
<td width=22%><pre>0</pre>
</td>
<td width=16%><pre>504</pre>
</td>
<td width=25%><pre>pubs</pre>
</td>
</tr>
<tr valign=top>
<td width=15%><pre>4</pre>
</td>
<td width=22%><pre>Sh_table</pre>
</td>
<td width=22%><pre>112003430</pre>
</td>
<td width=16%><pre>0</pre>
</td>
<td width=25%><pre>pubs</pre>
</td>
</tr>
<tr valign=top>
<td width=15%><pre>4</pre>
</td>
<td width=22%><pre>Ex_table</pre>
</td>
<td width=22%><pre>240003886</pre>
</td>
<td width=16%><pre>0</pre>
</td>
<td width=25%><pre>pubs</pre>
</td>
</tr>
</table><br>
<pre></pre>
<p>
The <i>locktype</i> column provides the following information:
<ul>
<li>
The type of lock: shared (<i>Sh</i>), exclusive (<i>Ex</i>), or <i>Update</i>. </li>
<li>
What the lock is holding: a table, page, or extent</li>
<li>
Whether the lock represents an intent to acquire a shared or exclusive lock on a data page.</li>
<li>
Whether the lock is blocking (<i>blk</i>) another process</li>
</ul>
<p>
In general, you apply shared locks for read operations and exclusive locks for write operations. However, if you want to read data initially, but possibly change it later, use an update lock.</p>
<p>
An intent lock indicates that SQL Server wants to acquire a shared or exclusive lock on a data page. Setting an intent lock prevents another transaction from subsequently acquiring an exclusive lock on the table containing that page.</p>
<p>
An extent lock is a lock held on a group of eight contiguous database pages while they are being allocated or freed. Extent locks are set during a CREATE or DROP statement, or during an INSERT operation that requires new data or index pages.</p>
<p>
The <i>blk</i> suffix indicates that one process is blocking other processes that need to acquire locks. As soon as the blocking process completes, the other processes move forward.</p>
<p>
For more information about locks, you can query the <i>syslocks</i> system table. For details, see the <i>Microsoft SQL</i> <i>Server Administrator's Companion</i>.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
