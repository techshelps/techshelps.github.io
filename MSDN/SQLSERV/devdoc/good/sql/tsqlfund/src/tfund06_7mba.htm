<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Implicit and Explicit Null Values</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_implicit_and_explicit_null_values_tfund06"></a>Implicit and Explicit Null Values</h2>
<p>
The IF UPDATE (<i>column_name</i>) clause is true for an INSERT statement whenever the column is assigned a value in the select list or in the VALUES clause. An explicit NULL or a default assigns a value to a column and thus activates the trigger. With an implicit NULL, if the value is not specified by the query or by the assigned default, the trigger on that column is not activated.</p>
<pre>CREATE TABLE junk
(a int NULL, b int NOT NULL)
go
CREATE TRIGGER junktrig
ON junk
FOR INSERT
AS
IF UPDATE(a) AND UPDATE(b)
    PRINT 'FIRING'
go
CREATE DEFAULT b_dflt
AS 99
go
sp_bindefault b_dflt, junk.b
go
INSERT junk (a, b)        /*IF UPDATE is true for both columns, */
VALUES (1, 2)            /*the trigger is activated. */
INSERT junk                /*IF UPDATE is true for both columns, */
VALUES (1, 2)            /*the trigger is activated. */
INSERT junk                /*Explicit NULL: */
VALUES (null, 2)            /*IF UPDATE is true for both columns, */
                        /*the trigger is activated. */
INSERT junk (b)            /*No default on column a, */
VALUES (2)                /*IF UPDATE is not true for both columns, */
                        /*the trigger is not activated. */
INSERT junk (a)            /*Default on column b, */
VALUES (2)                /*IF UPDATE is true for both columns, */
                        /*the trigger is activated. */</pre>
<p>
Exactly the same results are produced by using only this clause:</p>
<pre>IF UPDATE(a)</pre>
<p>
To create a trigger that disallows the insertion of implicit null values, use:</p>
<pre>IF UPDATE(a) OR UPDATE(b)</pre>
<p>
SQL statements in the trigger can then test to see whether <i>a</i> is NULL.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
