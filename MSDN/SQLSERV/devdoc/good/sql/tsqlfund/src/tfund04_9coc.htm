<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GROUP BY and ALL</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_group_by_and_all"></a>GROUP BY and ALL</h3>
<p>
Transact-SQL provides the ALL keyword in the GROUP BY clause. ALL is meaningful only when the SELECT statement in which it is used also includes a WHERE clause.</p>
<p>
If you use ALL, the query results include all groups produced by the GROUP BY clause, even if some of the groups don't have any rows that meet the search conditions. Without ALL, a SELECT statement that includes GROUP BY does not show groups for which no rows qualify.</p>
<p>
Here are two examples:</p>
<table cellspacing=4 cols=6>
<tr valign=top>
<td colspan=5 width=94%><pre>SELECT type, AVG(price)</pre>
</td>
</tr>
<tr valign=top>
<td colspan=5 width=94%><pre>FROM titles</pre>
</td>
</tr>
<tr valign=top>
<td colspan=5 width=94%><pre>WHERE royalty = 10</pre>
</td>
</tr>
<tr valign=top>
<td colspan=5 width=94%><pre>GROUP BY type</pre>
</td>
</tr>
<tr valign=top>
<td width=31%><pre></pre>
</td>
<td colspan=2 width=27%><pre></pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=31%><pre>type</pre>
</td>
<td colspan=2 width=27%><pre></pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=31%><pre>------------</pre>
</td>
<td colspan=2 width=27%><pre>-----------</pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=31%><pre>business</pre>
</td>
<td colspan=2 width=27%><pre>17.31</pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=31%><pre>popular_comp</pre>
</td>
<td colspan=2 width=27%><pre>20.00</pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=31%><pre>psychology</pre>
</td>
<td colspan=2 width=27%><pre>40.38</pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=31%><pre>trad_cook</pre>
</td>
<td colspan=2 width=27%><pre>17.97</pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=31%><pre></pre>
</td>
<td colspan=2 width=27%><pre></pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=5 width=94%><pre>(4 row(s) affected)</pre>
</td>
</tr>
<tr valign=top>
<td width=31%><pre></pre>
</td>
<td colspan=2 width=27%><pre></pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td width=31%><pre></pre>
</td>
<td colspan=2 width=27%><pre></pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=5 width=94%><pre>SELECT type, AVG(price)</pre>
</td>
</tr>
<tr valign=top>
<td colspan=5 width=94%><pre>FROM titles</pre>
</td>
</tr>
<tr valign=top>
<td colspan=5 width=94%><pre>WHERE royalty = 10</pre>
</td>
</tr>
<tr valign=top>
<td colspan=5 width=94%><pre>GROUP BY all type</pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=37%><pre></pre>
</td>
<td colspan=2 width=27%><pre></pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=37%><pre>type</pre>
</td>
<td colspan=2 width=27%><pre></pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=37%><pre>---------</pre>
</td>
<td colspan=2 width=27%><pre>-----------</pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=37%><pre>business</pre>
</td>
<td colspan=2 width=27%><pre>17.31</pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=37%><pre>mod_cook</pre>
</td>
<td colspan=2 width=27%><pre>(null)</pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=37%><pre>popular_comp</pre>
</td>
<td colspan=2 width=27%><pre>20.00</pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=37%><pre>psychology</pre>
</td>
<td colspan=2 width=27%><pre>40.38</pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=37%><pre>trad_cook</pre>
</td>
<td colspan=2 width=27%><pre>17.97</pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=37%><pre>UNDECIDED</pre>
</td>
<td colspan=2 width=27%><pre>(null)</pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=2 width=37%><pre></pre>
</td>
<td colspan=2 width=27%><pre></pre>
</td>
<td colspan=2 width=36%><pre></pre>
</td>
</tr>
<tr valign=top>
<td colspan=5 width=94%><pre>(6 row(s) affected)</pre>
</td>
</tr>
</table><br>
<pre></pre>
<p>
The first statement produces groups only for those books that commanded royalties of 10 percent. Since no modern cookbooks have a royalty of 10 percent, there is no group in the results for the <i>mod_cook</i> type.</p>
<p>
The second statement produces groups for all types, including modern cookbooks and UNDECIDED, even though the modern cookbook group doesn't include any rows that meet the qualification specified in the WHERE clause.</p>
<p>
The column that holds the aggregate value (the average price) is NULL for groups that lack qualifying rows.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
