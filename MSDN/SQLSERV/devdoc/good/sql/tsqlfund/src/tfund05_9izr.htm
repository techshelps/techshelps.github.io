<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Understanding Locking</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_understanding_locking"></a>Understanding Locking</h2>
<p>
The following table describes the three different types of locks that SQL Server uses:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=15%></th>
<th align=left width=85%></th>
</tr>
<tr valign=top>
<th align=left width=15%></th>
<th align=left width=85%></th>
</tr>
<tr valign=top>
<th align=left width=15%>Lock Type</th>
<th align=left width=85%><br>
Description</th>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=85%></td>
</tr>
<tr valign=top>
<td width=15%>Shared</td>
<td width=85%>SQL Server usually uses <i>shared locks</i> for operations that do not change or update data, such as a SELECT statement.</td>
</tr>
<tr valign=top>
<td width=15%>Update</td>
<td width=85%>SQL Server uses <i>update locks</i> when it intends to modify a page, and later promotes the update page lock to an exclusive page lock before actually making the changes.</td>
</tr>
<tr valign=top>
<td width=15%>Exclusive</td>
<td width=85%>SQL Server uses <i>exclusive locks</i> for the data modification operations UPDATE, INSERT, or DELETE.</td>
</tr>
</table><br>
<p>
These are the different types of items that can be locked by SQL Server:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=15%></th>
<th align=left width=85%></th>
</tr>
<tr valign=top>
<th align=left width=15%></th>
<th align=left width=85%></th>
</tr>
<tr valign=top>
<th align=left width=15%>Item</th>
<th align=left width=85%>Description</th>
</tr>
<tr valign=top>
<td width=15%></td>
<td width=85%></td>
</tr>
<tr valign=top>
<td width=15%>Page</td>
<td width=85%>A 2K data page or index page. This is the most common type of lock.</td>
</tr>
<tr valign=top>
<td width=15%>Extent</td>
<td width=85%>A contiguous group of 8 2K data pages or index pages. This lock is only used for allocation.</td>
</tr>
<tr valign=top>
<td width=15%>Table</td>
<td width=85%>An entire table, including all data and indexes.</td>
</tr>
<tr valign=top>
<td width=15%>Intent</td>
<td width=85%>A special type of table lock to indicate the type of page locks currently placed on the table.</td>
</tr>
</table><br>
<p>
This table describes the compatibility of different types of page locks with each other:</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=16%></th>
<th align=left width=27%>Shared</th>
<th align=left width=28%>Update</th>
<th align=left width=29%>Exclusive</th>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=27%></td>
<td width=28%></td>
<td width=29%></td>
</tr>
<tr valign=top>
<td width=16%><b>Shared</b></td>
<td width=27%>Yes</td>
<td width=28%>Yes</td>
<td width=29%>No</td>
</tr>
<tr valign=top>
<td width=16%><b>Update</b></td>
<td width=27%>Yes</td>
<td width=28%>No</td>
<td width=29%>No</td>
</tr>
<tr valign=top>
<td width=16%><b>Exclusive</b></td>
<td width=27%>No</td>
<td width=28%>No</td>
<td width=29%>No</td>
</tr>
</table><br>
<p>
An entry of "Yes" means that these locks are compatible. An entry of "No" means these locks are incompatible. While a particular type of lock is held on a specific page, only compatible lock types can be placed on that same page.</p>
<p>
For example, while an exclusive lock is held, no other transaction can acquire a lock of any kind (shared, update, or exclusive) on that item until the exclusive lock is released at the end of the first transaction.</p>
<p>
If a shared lock has been applied to an item, other transactions can also acquire a shared lock or an update lock on that item ¾ even if the first transaction hasn't completed. However, other transactions cannot acquire an exclusive lock until the shared lock has been released.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
