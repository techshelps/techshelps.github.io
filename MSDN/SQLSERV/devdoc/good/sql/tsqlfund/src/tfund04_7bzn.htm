<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Subqueries in UPDATE, DELETE, and INSERT Statements</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_subqueries_in_update.2c_.delete.2c_.and_insert_statements"></a>Subqueries in UPDATE, DELETE, and INSERT Statements</h2>
<p>
Subqueries can be nested in UPDATE, DELETE, and INSERT statements, as well as in SELECT statements.</p>
<p>
The following query doubles the price of all books published by New Moon Books. The statement updates the <i>titles</i> table; its subquery references the <i>publishers</i> table:</p>
<pre>UPDATE titles
SET price = price * 2
WHERE pub_id in
    (SELECT pub_id
    FROM publishers
    WHERE pub_name = 'New Moon Books')
</pre>
<p>
Here's an equivalent UPDATE statement using a join:</p>
<pre>UPDATE titles
SET price = price * 2
FROM titles, publishers
WHERE titles.pub_id = publishers.pub_id
    AND pub_name = 'New Moon Books'
</pre>
<p>
You can remove all records of sales of business books with this nested select statement:</p>
<pre>DELETE sales
WHERE title_id IN
    (SELECT title_id
    FROM titles
    WHERE type = 'business')
</pre>
<p>
Here's an equivalent DELETE statement using a join:</p>
<pre>DELETE sales
FROM sales, titles
WHERE sales.title_id = titles.title_id
    AND type = 'business'
</pre>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
