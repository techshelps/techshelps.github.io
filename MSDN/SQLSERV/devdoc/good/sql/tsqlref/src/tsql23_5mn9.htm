<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_password System Stored Procedure</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_password_system_stored_procedure"></a>sp_password System Stored Procedure</h2>
<p>
Adds or changes a password for a SQL Server login ID.</p>
<h4>Syntax</h4>
<p>
<b>sp_password</b> <i>old</i><b>,</b> <i>new</i> [<b>,</b> <i>login_id</i>]</p>
<p>
where
<dl>
<dt>
<i>old</i></dt>
<dd>
Is the user's old password, which is encrypted in <i>master.dbo.syslogins</i>. The default password for all users is NULL. The system administrator can specify NULL for this parameter no matter what the user's old password was. However, if the system administrator gives any value besides NULL, SQL Server checks the value against <i>master.dbo.syslogins</i> and rejects it if it is wrong.</dd>
<dt>
<i>new</i></dt>
<dd>
Is the user's new password.</dd>
<dt>
<i>login_id</i></dt>
<dd>
Is an option that only the system administrator can use to change any user's password.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Any user can use <b>sp_password</b> to change his or her own password. Only the system administrator can change someone else's password (using the <i>login_id</i> parameter).</p>
<p>
The <i>old</i> parameter is checked against the existing password for the user <i>login_id</i> (unless the user executing the procedure is the system administrator and the <i>old</i> parameter is NULL) and must match for the password to be changed. Passwords are encrypted in <i>master.dbo.syslogins.password</i>.</p>
<p>
If front-end programs require the same password on remote servers as on the local server, a user must change his or her password on all the remote servers before changing the local password. The<b> sp_password</b> procedure should be executed as a call to a remote stored procedure on each remote server.</p>
<h4>Permission</h4>
<p>
Execute permission defaults to the <i>public</i> group. Each member of <i>public</i> has permission to change only his or her own password. The system administrator can change any user's password.</p>
<h4>Table Used</h4>
<p>
<i>master.dbo.syslogins</i></p>
<h4>Examples</h4>
<h5>A.&nbsp;&nbsp;&nbsp;&nbsp;SA Can Change Password Without Knowing the Former Password</h5>
<p>
In this example, the system administrator has changed Victoria's password to ok. Notice that NULL is not enclosed in quotation marks.</p>
<pre>sp_password NULL, ok, Victoria
</pre>
<h5>B.&nbsp;&nbsp;&nbsp;&nbsp;A User Changes Her Password</h5>
<p>
In this example, the user Victoria changes her password from ok to coffee.</p>
<pre>sp_password ok, coffee
</pre>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%><a href="tsql18_62g5.htm"><b>sp_addlogin</b></a></td>
<td width=52%><a href="tsql14_9r6t.htm"><b>xp_grantlogin</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql18_5qw5.htm"><b>sp_adduser</b></a></td>
<td width=52%><a href="tsql14_4ijp.htm"><b>xp_logininfo</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql20_6mat.htm"><b>sp_defaultdb</b></a></td>
<td width=52%><a href="tsql14_9yhx.htm"><b>xp_revokelogin</b></a></td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
