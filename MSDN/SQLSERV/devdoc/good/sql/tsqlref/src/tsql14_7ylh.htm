<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>xp_findnextmsg Extended Stored Procedure</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_xp_findnextmsg_extended_stored_procedure"></a>xp_findnextmsg Extended Stored Procedure</h2>
<p>
Accepts a message ID for input and returns the message ID for output. This extended stored procedure is used with the <b>sp_processmail </b>system stored procedure in order to process mail in the SQL Server inbox.</p>
<h4>Syntax</h4>
<p>
<b>xp_findnextmsg</b> [@msg_id <b>=</b> <i>msg_id</i> [OUTPUT]] <br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>,</b> @type <b>=</b> <i>type</i>] <br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>,</b> @unread_only <b>=</b> {<b>'true' | 'false'</b>}])</p>
<p>
where
<dl>
<dt>
@msg_id <b>=</b> <i>msg_id</i></dt>
<dd>
Is an input and output parameter; specifies the string of the message on input and the string of the next message on output.</dd>
<dt>
OUTPUT</dt>
<dd>
When specified, places the value of the <i>msg_id</i> in the output parameter. When not specified, the <i>msg_id </i>is returned as a single-column, single-row results set.</dd>
<dt>
<i>@type</i> <b>=</b> <i>type</i></dt>
<dd>
Is the input message type based on the MAPI mail definition:
<pre>IP[M | C].Vendorname.subclass</pre>

<p>
Message types beginning with IPM will appear in the inbox of the mail client, and will be found or read by <b>xp_findnextmsg</b> if the @type is NULL. Message types beginning with IPC do not appear in the inbox of the mail client and must be found or read by setting the @type parameter. The default is NULL.
</dd>
<dt>
@unread_only = <b>'true' | 'false'</b></dt>
<dd>
Specifies that only unread messages are considered. The default is <b>true</b>.</dd>
</dl>
<h4>Remarks</h4>
<p>
This extended stored procedure returns a successful (0) or failed (1) status. Any failure except an invalid parameter is logged to the Windows NT application event log.</p>
<h4>Example</h4>
<p>
This example returns the status when searching for the next message ID (for only unread messages). In this example, the value from <b>xp_findnextmsg</b> is placed in a local variable named @message_id.</p>
<pre>EXEC @status = xp_findnextmsg @msg_id = @message_id OUTPUT
</pre>
<h4>Permission</h4>
<p>
Execute permission defaults to the system administrator, who can grant permission to other users.</p>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%></td>
<td width=52%></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql23_095x.htm"><b>sp_processmail</b></a></td>
<td width=52%><a href="tsql14_4nad.htm"><b>xp_sendmail</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql14_7vfp.htm"><b>xp_deletemail</b></a></td>
<td width=52%><a href="tsql14_0411.htm"><b>xp_startmail</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql14_4dph.htm"><b>xp_readmail</b></a></td>
<td width=52%><a href="tsql14_77c5.htm"><b>xp_stopmail</b></a></td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
