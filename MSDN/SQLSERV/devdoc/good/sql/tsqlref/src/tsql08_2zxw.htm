<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DUMP Statement</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dump_database_statement"></a>DUMP Statement </h1>
<p>
For SQL Server 6.5 information, see <a href="../../hydra/tsql/src/addnfeat_9dtg.htm">DUMP Statement</a> in <i>What's New for SQL Server 6.5</i>.</p>
<p>
Makes a backup copy of a database and its transaction log (DUMP DATABASE) or makes a copy of only the transaction log (DUMP TRANSACTION) in a form that can be read into SQL Server using the LOAD statement.</p>
<h4>Syntax</h4>
<p>
<b>Dumping a database:</b></p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;DUMP DATABASE {<i>dbname</i> | <i>@dbname_var</i>}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO <i>dump_device </i>[<b>,</b> <i>dump_device2 </i>[...<b>,</b> <i>dump_device32</i>]]<br>
&nbsp;&nbsp;&nbsp;&nbsp;[WITH <i>options </i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[[<b>,</b>] STATS [ <b>=</b> <i>percentage</i>]]]</p>
<p>
<b>Dumping a transaction log:</b></p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;DUMP TRANSACTION {<i>dbname</i> | <i>@dbname_var</i>} <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[TO <i>dump_device </i>[<b>,</b> <i>dump_device2 </i>[...<b>,</b> <i>dump_device32</i>]]]<br>
&nbsp;&nbsp;&nbsp;&nbsp;[WITH {TRUNCATE_ONLY | NO_LOG | NO_TRUNCATE}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<i>options</i>}]</p>
<p>
where
<dl>
<dt>
<i>dump_device </i><b>=</b></dt>
<dd>
{<i>dump_device_name </i>| <i>@dump_device_namevar</i>} <br>
| {DISK | TAPE | FLOPPY | PIPE}<b> = <br>
</b>{<b>'</b><i>temp_dump_device</i><b>'</b> | <i>@temp_dump_device_var</i>}} <br>
[VOLUME <b>=</b> {<i>volid</i> | <i>@volid_var</i>}]</dd>
<dt>
<i>options </i><b>=</b></dt>
<dd>
[[<b>,</b>] {UNLOAD | NOUNLOAD}]<br>
[[<b>,</b>] {INIT | NOINIT}]<br>
[[<b>,</b>] {SKIP | NOSKIP}]<br>
[[<b>,</b>] {{EXPIREDATE <b>=</b> {<i>date </i>| <i>@date_var</i>}} <br>
| {RETAINDAYS <b>=</b> {<i>days</i> | <i>@days_var</i>}}]

<p>
<b>Note</b>  The UNLOAD and NOUNLOAD options are supported only by TAPE dump devices.

<p>
When you specify a PIPE dump device, multivolume dumps and dump device options (UNLOAD, NOUNLOAD, INIT, NOINIT, SKIP, NOSKIP, EXPIREDATE, and RETAINDAYS) are not supported. 

</dd>
<dt>
DATABASE</dt>
<dd>
Specifies that the complete database and transaction log are to be backed up. 
<p>
If the transaction log is on the same device as the database, using DUMP DATABASE is the only way you can create a backup copy of both the database and its transaction log. However, because DUMP DATABASE does not remove the inactive portion of the log, you must use DUMP TRANSACTION WITH TRUNCATE_ONLY to purge the log of completed transactions. Generally, databases and transaction logs should be stored on different devices; this improves performance and enables unrestricted use of both the DUMP DATABASE and DUMP TRANSACTION statements.
</dd>
<dt>
TRANSACTION</dt>
<dd>
Specifies that only the transaction log is to be backed up. DUMP TRANSACTION removes the inactive part of the transaction log and makes a backup copy of it in a form that can be read in with the LOAD statement. To retain a backup of only the transaction log (using DUMP TRANSACTION without the TRUNCATE_ONLY or NO_LOG options), the transaction log must be stored on a separate database device from the data portion of the database. 

<p>
<b>Note</b>  If dumping the transaction log doesn't appear to truncate the majority of your transaction log, you may have an open transaction in the log. To determine whether a transaction has been left open, use DBCC OPENTRAN. 

<p>
For databases that store the data portion of the database on a separate device from the log portion, log space can be monitored with various DBCC commands and the Performance Monitor. For details, see the DBCC statement.


<dl>
<dt>
TRUNCATE_ONLY</dt>
<dd>
Removes the inactive part of the log without making a backup copy of it. This optional clause frees disk space used by the transaction log. Specifying a <i>dump_device</i> is unnecessary because the transaction log dump will not be saved.
<p>
Prior to backing up a database, it is useful to dump a transaction log using the TRUNCATE_ONLY option to clear out the log and decrease the total time required to back up the database.

</dd>
</dl>

<p>
<b>Note</b>  After dumping a transaction log using the TRUNCATE_ONLY option, you should immediately make a backup of the database using DUMP DATABASE. Dumping of the transaction log (using DUMP TRANSACTION) will not be allowed until a full database dump (using DUMP DATABASE) has been performed.


<dl>
<dt>
NO_LOG</dt>
<dd>
Is used only when you have run out of space in the database and cannot use DUMP TRANSACTION WITH TRUNCATE_ONLY to purge the log. The NO_LOG option removes the inactive part of the log without making a backup copy of it, and it saves space by not logging the operation.
<p>
If the transaction log of a published (replicated) database becomes full and absolutely must be truncated, unsubscribe all subscriptions to the publications of that database. This allows you to truncate past the oldest distributed transaction.

<p>
After the transaction log has been dumped using NO_LOG, the changes recorded in the log are not recoverable. For recovery purposes, immediately execute the DUMP DATABASE statement.

<p>
Because both options clear the log without making a backup of it, it is unnecessary to use both the TRUNCATE_ONLY and NO_LOG option in the same statement.
</dd>
<dt>
NO_TRUNCATE</dt>
<dd>
Makes it possible to dump a transaction log even if the database is inaccessible by using a pointer to the transaction log in the <i>master</i> database. 
<p>
The NO_TRUNCATE option provides up-to-the-minute media recovery when the <i>master </i>database and the log portion of the user database reside on undamaged database devices and when only the data portion of the user database is damaged.
</dd>
</dl>
</dd>
<dt>
<i>dbname</i> | <i>@dbname_var</i></dt>
<dd>
Specifies the database from which the transaction log or complete database is being dumped. If supplied as a variable (<i>@dbname_var</i>), this name can be specified as a string, or as a <i>char</i> or <i>varchar</i> variable.</dd>
<dt>
<i>dump_device_name</i> | <i>@dump_device_namevar</i></dt>
<dd>
Specifies the logical name of the dump device or devices (as created by the <b>sp_addumpdevice </b>system stored procedure) to which the database will be backed up. If supplied as a variable (<i>@dump_device_namevar</i>), the dump device name can be specified as a string or as a <i>char</i> or <i>varchar</i> variable.</dd>
<dt>
DISK | TAPE | FLOPPY | PIPE<b> = </b></dt>
<dd>

<dl>
<dt>
<b>'</b><i>temp_dump_device</i><b>'</b> | <i>@temp_dump_device_var</i></dt>
</dl>

<p>
Allows backups directly to temporary dump devices. These devices are created (or accessed, if they already exist) when the dump occurs; they do not have entries in the <i>sysdevices</i> system table.<b> </b>With DISK, TAPE, and FLOPPY specify the complete path and filename of the device. With PIPE, specify the name of the named pipe that will be used by the client application. If supplied as a variable (<i>@temp_dump_device_var</i>), the temporary dump device name can be specified as a string or as a <i>char</i> or <i>varchar</i> variable. If you are using a network server with a UNC name or using a redirected drive letter, specify a device type of DISK.


<p>
<b>Important</b>  When specifying a striped dump, logical device names (or variables) and temporary device names (or variables) can be mixed. PIPE devices have been added to allow third-party vendors a flexible and powerful way to connect their own software. For typical Transact-SQL use, the PIPE device will not be used. 

</dd>
<dt>
VOLUME = <i>volid</i> | <i>@volid_var</i></dt>
<dd>
Specifies the volume ID, <i>volid</i>, a 6-byte character string. If dumping to a new tape, this value is the name of the ANSI VOL1 label. For SQL Server, the default is SQ0001. For subsequent dumps, this value is used to validate the volume name of the dump device. If supplied as a variable (<i>@volid_var</i>), the volume name can be specified as a string or as a <i>char</i> or <i>varchar</i> variable. It is not necessary, or recommended, to explicitly specify the volume ID.</dd>
<dt>
UNLOAD</dt>
<dd>
Specifies that the tape is automatically rewound and unloaded when the dump is finished. UNLOAD is set by default when a new user session is started. It remains set until that user specifies NOUNLOAD. This option is used only for tape devices.</dd>
<dt>
NOUNLOAD</dt>
<dd>
Specifies that the tape will not be unloaded automatically from the tape drive after a dump. NOUNLOAD remains set until UNLOAD is specified. This option is used only for tape devices.</dd>
<dt>
INIT</dt>
<dd>
Specifies that the dump should be the first file on the DISK or TAPE device. If INIT is specified, any existing data on that device will be overwritten. If the first file on the device has an ANSI-standard label, the label will be evaluated to determine whether the previous dump(s) can be overwritten. For details, see the EXPIREDATE and RETAINDAYS options, later in this section.</dd>
<dt>
NOINIT</dt>
<dd>
Specifies that the dump should be appended to the current DISK or TAPE device. This is the default for both single dump devices and striped dumps. Dump devices used in a stripe set must always be used in a stripe set (unless reinitialized at some point with INIT). Once a device is defined as part of a stripe set, it cannot be used for a single device dump unless INIT is specified. Similarly, a device that contains nonstriped dumps cannot be used in a stripe set unless INIT is specified.</dd>
<dt>
SKIP</dt>
<dd>
Instructs the server not to read the ANSI TAPE device headers.</dd>
<dt>
NOSKIP</dt>
<dd>
Specifies that the server will read ANSI TAPE device headers. This is the default.

<p>
<b>Note</b>  When specified, SKIP and NOSKIP override the setting as defined with the dump device (when the <b>sp_addumpdevice</b> system stored procedure was executed).

</dd>
<dt>
EXPIREDATE <b>=</b> <i>date</i> | <i>@date_var</i></dt>
<dd>
Specifies the date when the dump media expires and can be overwritten. If supplied as a variable (<i>@date_var</i>), this date can be specified as a string or as a <i>char</i> or <i>varchar</i> variable, and it must follow the configured datetime format for the system. This option is used for DISK and TAPE devices only and is effective only when specified with INIT.</dd>
<dt>
RETAINDAYS <b>=</b> <i>days</i> | <i>@days_var</i></dt>
<dd>
Specifies the number of days that must elapse between the existing dump and when the dump media can be overwritten. If supplied as a variable (<i>@days_var</i>), it must be specified as an integer. This option is used for DISK and TAPE devices only and is effective only when specified with INIT.
</dd>
</dl>
<p>
<b>Important</b>  EXPIREDATE and RETAINDAYS override the configuration value for media retention when specified with the DUMP DATABASE or DUMP TRANSACTION statements. These options are used with DISK and TAPE devices only. If an expiration date is needed for diskette devices, configure media retention with the <b>sp_configure</b> system stored procedure.</p>
<p>
If EXPIREDATE or RETAINDAYS is specified, subsequent dumps can be appended to that device; however, EXPIREDATE and RETAINDAYS are valid only for dumps specified with INIT.</p>
<p>
These options only prevent SQL Server from overwriting a device. Tapes can still be erased using other methods, and disk-device files can still be deleted through the operating system.</p>
<dl>
<dt>
STATS <b>=</b> <i>percentage</i></dt>
<dd>
Returns the percentage of pages dumped in increments optionally set at the time of the dump. If the <i>percentage</i> is not specified, statistics will be shown for each 10 percent of the dump. This option is available only with DUMP DATABASE.
</dd>
</dl>
<h4>Remarks</h4>
<p>
In earlier releases of SQL Server, dumping a database or a transaction log to a single device always overwrote the previous dump unless (for tape devices only) NOINIT was specified. With SQL Server 6.0, database or transaction log dumps can be appended to any DISK or TAPE device, allowing you to keep a database and its transaction logs all within one physical location. </p>
<p>
The SQL Server dump is a dynamic dump ¾ it can take place while the database is active. The dump captures the state of the data as it is at the moment the statement is executed; no partial transactions are reflected. Any data changes made after the dump begins are not reflected in the dumped database. Performing a dump can slow the system down somewhat, so you may want to run it when the database or table is not being heavily updated. </p>
<p>
Ownership and permissions problems on the physical file can interfere with a DUMP statement. The <a href="tsql18_53vp.htm"><b>sp_addumpdevice</b> system stored procedure</a> adds the device to the system tables, but it does not check file access permission.</p>
<p>
You cannot execute the DUMP TRANSACTION statement while the <b>trunc. log on chkpt.</b> database option is enabled. Nor can you execute it after enabling <b>select into/bulkcopy</b> and making unlogged changes to the database with SELECT INTO or a bulk-copy operation. Use DUMP DATABASE instead.</p>
<p>&nbsp;</p></body>
</HTML>
