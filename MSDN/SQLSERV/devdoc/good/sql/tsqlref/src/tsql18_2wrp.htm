<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_altermessage System Stored Procedure</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_altermessage_system_stored_procedure"></a>sp_altermessage System Stored Procedure </h2>
<p>
Alters the state of a <i>sysmessages</i> error.</p>
<h4>Syntax</h4>
<p>
<b>sp_altermessage</b> <i>message_id</i><b>,</b><i> </i>WITH_LOG<b>,</b><i> </i>{<b>true</b> | <b>false</b>}</p>
<p>
where
<dl>
<dt>
<i>message_id</i></dt>
<dd>
Specifies which <i>sysmessages</i> error or message to alter.</dd>
<dt>
WITH_LOG</dt>
<dd>
Specifies that the <i>sysmessages</i> is to be written to the Windows NT event log when it occurs. 

<p>
<b>Note</b>  If a message is written to the Windows NT event log, it is also written to the SQL Server error log file.

</dd>
<dt>
<b>true</b> | <b>false</b></dt>
<dd>
Specifies whether the error will be written to the Windows NT event log. If <b>true</b>,<b> </b>the error will be automatically written to the Windows NT event log. If <b>false</b>, the error will not be automatically written to the Windows NT event log but may be written, depending on how the error was raised.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The effect of the <b>sp_altermessage</b> system stored procedure with the WITH_LOG option is similar to that of the RAISERROR WITH LOG parameter, except that <b>sp_altermessage</b> changes the logging behavior of an existing message. If a message has been altered to be WITH_LOG, then no matter how a user invokes the error it will always be written to the Windows NT event log. Even if RAISERROR is executed without the WITH LOG option, the error will be written to the Windows NT event log.</p>
<p>
System messages (such as 605), as well as user messages added by <b>sp_addmessage</b>,<b> </b>can be modified by using <b>sp_altermessage</b>.</p>
<h4>Example</h4>
<p>
This example causes existing message 55001 to be logged to the Windows NT event log.</p>
<pre>sp_altermessage 55001, WITH_LOG, TRUE
</pre>
<h4>Permission</h4>
<p>
Execute permission defaults to the system administrator and can be transferred to other users.</p>
<h4>Table Used</h4>
<p>
<i>sysmessages</i></p>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%><a href="tsql18_076t.htm"><b>sp_addmessage</b></a></td>
<td width=52%><a href="tsql21_3ffp.htm"><b>sp_dropmessage</b></a></td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
