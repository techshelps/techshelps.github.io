<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_dboption System Stored Procedure</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_dboption_system_stored_procedure"></a>sp_dboption System Stored Procedure </h2>
<p>
For SQL Server 6.5 information, see <a href="../../hydra/tsql/src/addsproc_8c32.htm"><b>sp_dboption</b></a> in <i>What's New for SQL Server 6.5</i>.</p>
<p>
Displays or changes database options.</p>
<h4>Syntax</h4>
<p>
<b>sp_dboption</b> [<i>dbname</i><b>,</b> <i>optname</i><b>,</b> {<b>true</b> | <b>false</b>}]</p>
<p>
where
<dl>
<dt>
<i>dbname</i></dt>
<dd>
Specifies the database in which you want to set the option. </dd>
<dt>
<i>optname</i></dt>
<dd>
Is the name of the option you want to set or turn off. SQL Server understands any unique string that is part of the option name. Enclose the option name with quotation marks if it includes embedded blanks or is a keyword. The available options are:
<dl>
<dt>
<b>ANSI null default</b></dt>
<dd>
Allows the user to control the database default nullability. When not explicitly defined, a user-defined datatype or a column definition will use the default setting for nullability. Nullability is determined by session settings and database settings. SQL Server defaults to NOT NULL. However, the ANSI-standard is NULL. For ANSI compatibility, setting <b>ANSI null default</b> to TRUE changes the database default nullability to NULL.
<p>
With this option set to <b>true</b>, all user-defined datatypes or columns not explicitly defined as NOT NULL during a CREATE TABLE or ALTER TABLE statement will default to allowing NULLs. Columns defined with constraints will follow constraint rules regardless of this setting (for example, PRIMARY KEY columns, IDENTITY columns, and columns of type <i>bit</i> cannot be NULL).

<p>
Session settings override the default database setting for ANSI null default. For more information, see the SET statement.
</dd>
<dt>
<b>dbo use only</b></dt>
<dd>
Sets a database for use only by the database owner. Active users of the database can continue to access the database, but no new users are allowed. When active users disconnect or change database context (with the USE statement), they will not be allowed access to this database unless this option has been set to <b>false</b>. </dd>
<dt>
<b>no chkpt on recovery</b></dt>
<dd>
Defines whether or not a checkpoint record is added to the database after it is recovered during a SQL Server startup. If this option is off (<b>false</b>, the default), a checkpoint record is added. 
<p>
The <b>no chkpt on recovery</b> option is useful when an up-to-date copy of a database is kept. In these situations, there is a "primary" and a "secondary" database. Initially, the primary database is dumped and loaded into the secondary database. Then, at intervals, the transaction log of the primary database is dumped and loaded into the secondary database. If this option is on (<b>true</b>) in the secondary database, no checkpoint record is added to a database after it is recovered, so subsequent transaction log dumps from the primary database can be loaded into it.
</dd>
<dt>
<b>offline</b></dt>
<dd>
Allows a database to be placed online (when set to <b>false</b>, the database is ready to be used) or offline (when set to <b>true</b>, the database is unavailable and cannot be used). This option is primarily used on databases with removable media devices but it can be used on any database.
<p>
When a database is placed online, all devices belonging to the specified database are opened (if they are not already open) and marked as non-deferred, and the database is recovered and becomes available for use. 

<p>
When a database is placed offline, all devices belonging to that database are closed and marked as deferred, except those that contain space belonging to other online databases. Databases placed offline are not recovered automatically at server startup. 

</dd>
</dl>

<p>
<b>Note</b>  A database cannot be placed offline if it has an active user. 


<dl>
<dt>
<b>published</b></dt>
<dd>
Allows the database to be published for replication. This option does not publish a database. Instead, it permits the tables of a database to be published. 
<p>
When set to <b>true</b>, this option enables publishing and adds the user <b>repl_subscriber</b> to the database. 

<p>
When set to <b>false</b> , it disables publishing, drops all publications, unmarks all transactions that were marked for replication in the transaction log, and removes the database user <b>repl_subscriber</b>.
</dd>
<dt>
<b>read only</b></dt>
<dd>
Defines a database as read only. This option means that users can retrieve data from the database but cannot modify anything. Because a read-only database does not allow data modifications, automatic recovery is skipped at system startup.</dd>
<dt>
<b>select into/bulkcopy</b></dt>
<dd>
Allows a database to accept non-logged operations. Non-logged operations include: using the UPDATETEXT or WRITETEXT statement, using SELECT INTO into a permanent table, using fast bulk copy (<b>bcp</b>), or performing a table load. This option need not be set to run <b>bcp</b> on a table that has indexes, because tables with indexes are always copied with the slower version of <b>bcp</b> and are logged. 
<p>
After performing non-logged operations, using the DUMP TRANSACTION statement is prohibited. Issuing DUMP TRANSACTION after making unlogged changes to the database with SELECT INTO or bulk copy produces an error message telling you to use DUMP DATABASE instead. Once all non-logged operations are completed, turn off <b>select into/bulkcopy</b> and issue the DUMP DATABASE statement. 

<p>
By default, the <b>select into/bulkcopy</b> option is turned off in newly created databases. To change the default situation, set this option in the <i>model</i> database.

</dd>
</dl>

<p>
<b>Note</b>  Because SELECT is a keyword, you must enclose <b>select into/<br>
bulkcopy</b> in quotation marks to avoid a syntax error.


<dl>
<dt>
<b>single user</b></dt>
<dd>
Restricts database access to a single user. Any user accessing the database when <b>single user</b> is set to <b>true</b> can continue to use the database. A new user will be allowed into this database only if all other users have disconnected or changed to another database. When this option is set, the <b>trunc. log on chkpt.</b> option is not supported. Truncate the log after single user operations are completed.</dd>
<dt>
<b>subscribed</b></dt>
<dd>
Allows the database to be subscribed for replication. Setting <b>subscribed</b> to <b>true</b> aliases the login ID of <b>repl_publisher</b> to DBO. This allows the distribution process to replicate to this database. Setting <b>subscribed</b> to <b>false</b> removes the alias.
<p>
This stored procedure does not subscribe to a database. It permits a database to subscribe to a published database.
</dd>
<dt>
<b>trunc. log on chkpt.</b></dt>
<dd>
Causes the transaction log to be truncated (committed transactions are removed) every time the CHECKPOINT process occurs (usually once per minute). When the database owner runs CHECKPOINT manually, however, the log is <i>not</i> truncated. It may be useful to turn this option on while doing development work, to prevent the log from growing. While the <b>trunc. log on chkpt.</b> option is set, backups of the transaction log are not allowed since dumps from the truncated transaction log dumps cannot be used to recover from media failure. Issuing the DUMP TRANSACTION statement produces an error message instructing you to use the DUMP DATABASE statement instead.</dd>
</dl>
</dd>
<dt>
<b>true </b>|<b> false</b></dt>
<dd>
Specifies how to set the option. Use <b>true</b> if you want to set the option and <b>false</b> if you want to turn off the option.
</dd>
</dl>
<h4>Remarks</h4>
<p>
To display the list of available database options, execute <b>sp_dboption</b> with no parameters. To list all of the configured options for a particular database, execute the <b>sp_helpdb </b>system stored procedure. The only option you can set for the <i>master</i> database is <b>trunc. log on chkpt</b>. The database owner or system administrator can set or turn off particular database options for all new databases by executing <b>sp_dboption</b> on the <i>model</i> database.</p>
<p>
After <b>sp_dboption</b> has been executed, a checkpoint will be executed in the database for which the option was changed. This will cause the change to take effect immediately.</p>
<p>
For additional details on database options, see the <i>Microsoft SQL Server Administrator's Companion</i>.</p>
<h4>Permission</h4>
<p>
Execute permission to display the list of options only (using <b>sp_dboption</b> with no parameters) defaults to all users. Execute permission to change an option (using <b>sp_dboption</b> with parameters) defaults to the system administrator and the database owner of the database for which the option is to be changed.</p>
<h4>Examples</h4>
<h5>A.&nbsp;&nbsp;&nbsp;&nbsp;sp_dboption with No Parameters</h5>
<p>
This example displays a list of the database options.</p>
<pre>sp_dboption
go

    Settable database options: 
    -------------------------- 
    ANSI null default          
    dbo use only               
    no chkpt on recovery       
    offline                    
    published                  
    read only                  
    select into/bulkcopy       
    single user                
    subscribed                 
    trunc. log on chkpt.       
</pre>
<h5>B.&nbsp;&nbsp;&nbsp;&nbsp;Set a Database to Read Only</h5>
<p>
This example makes the <i>pubs</i> database read only.</p>
<pre>sp_dboption pubs, 'read', TRUE
go

    CHECKPOINTing database that was changed.
</pre>
<h5>C.&nbsp;&nbsp;&nbsp;&nbsp;Turn Off an Option</h5>
<p>
This example makes the <i>pubs</i> database writable again.</p>
<pre>sp_dboption pubs, 'read', FALSE
go

    CHECKPOINTing database that was changed.
</pre>
<h5>D.&nbsp;&nbsp;&nbsp;&nbsp;Take a Database Offline</h5>
<p>
This example takes the <i>sales</i> database offline if there are no users accessing the sales database.</p>
<pre>USE master
go
sp_dboption sales, offline, TRUE 
go

    CHECKPOINTing database that was changed.
</pre>
<h4>Tables Used</h4>
<p>
<i>master.dbo.spt_values</i>, <i>master.dbo.sysdatabases</i></p>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%><a href="tsql01_6juc.htm">CHECKPOINT</a></td>
<td width=52%><a href="tsql15_14kl.htm"><b>sp_droppublisher</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql12_654k.htm">SELECT</a></td>
<td width=52%><a href="tsql15_5t5x.htm"><b>sp_dropsubscriber</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql14_57fp.htm"><b>sp_addpublisher</b></a></td>
<td width=52%><a href="tsql22_0nl1.htm"><b>sp_helpdb</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql14_6wh1.htm"><b>sp_addsubscriber</b></a></td>
<td width=52%><a href="tsql16_0r8l.htm"><b>sp_helpdistributor</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql15_9ecl.htm"><b>sp_changesubscriber</b></a></td>
<td width=52%><a href="tsql23_0d7p.htm"><b>sp_helpserver</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql19_3yzp.htm"><b>sp_configure</b></a></td>
<td width=52%><a href="tsql16_6bxh.htm"><b>sp_helpsubscriberinfo</b></a></td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
