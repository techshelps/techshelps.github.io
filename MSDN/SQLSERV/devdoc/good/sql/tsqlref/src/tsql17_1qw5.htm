<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_addtask SQL Executive Stored Procedure</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_addtask_sql_executive_stored_procedure"></a>sp_addtask SQL Executive Stored Procedure </h2>
<p>
For SQL Server 6.5 information, see <a href="../../hydra/tsql/src/addsproc_34ff.htm"><b>sp_addtask</b></a> in <i>What's New for SQL Server 6.5</i>.</p>
<p>
Creates a scheduled task.</p>
<h4>Syntax</h4>
<p>
<b>sp_addtask</b> <i>name</i><b> </b>[<b>,</b> <i>subsystem</i>] [<b>,</b> <i>server</i>] [<b>,</b> <i>username</i>] [<b>,</b> <i>databasename</i>] <br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>,</b> <i>enabled</i>] [<b>,</b> <i>freqtype</i>] [<b>,</b> <i>freqinterval</i>] [<b>,</b> <i>freqsubtype</i>] [<b>,</b> <i>freqsubinterval</i>] <br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>,</b> <i>freqrelativeinterval</i>] [<b>,</b> <i>freqrecurrencefactor</i>] [<b>,</b> <i>activestartdate</i>] <br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>,</b> a<i>ctiveenddate</i>] [<b>,</b> <i>activestarttimeofday</i>] [<b>,</b> <i>activeendtimeofday</i>] <br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>,</b> <i>nextrundate</i>] [<b>,</b> <i>nextruntime</i>] [<b>,</b> <i>runpriority</i>] [<b>,</b> <i>emailoperatorname</i>] <br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>,</b> <i>retryattempts</i>] [<b>,</b> <i>retrydelay</i>] [<b>,</b> <i>command</i>] [<b>,</b> <i>loghistcompletionlevel</i>] <br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>,</b> <i>emailcompletionlevel</i>] [<b>,</b> <i>description</i>] [<b>,</b> <i>tagadditionalinfo</i>] [<b>,</b> <i>tagobjectid</i>] <br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>,</b> <i>tagobjecttype</i>] [<b>,</b> @newid OUTPUT]</p>
<p>
where
<dl>
<dt>
<i>name</i> </dt>
<dd>
Is the name of the task being scheduled.</dd>
<dt>
<i>subsystem</i></dt>
<dd>
Specifies the subsystem to use. Can be <b>Distribution</b>, <b>LogReader</b>, <b>Sync</b>, <b>TSQL</b>, or <b>CmdExec</b>. These must be typed using the capitalization (case) shown.</dd>
<dt>
<i>server</i></dt>
<dd>
Specifies the server on which to execute this task.</dd>
<dt>
<i>username</i></dt>
<dd>
Specifies the database user to impersonate when executing this task. Only the system administrator or the database owner can specify this parameter.</dd>
<dt>
<i>databasename</i></dt>
<dd>
Specifies the database to use when executing the task.</dd>
<dt>
<i>enabled</i></dt>
<dd>
Specifies the status of scheduled tasks: 1 indicates enabled, the tasks will be scheduled and run; 0 indicates disabled, the tasks will not be scheduled and run.</dd>
<dt>
<i>freqtype</i></dt>
<dd>
Specifies the frequency for this task:<br>
1One Time<br>
2On Demand (the default)<br>
4Daily<br>
8Weekly<br>
16Monthly<br>
32Monthly Relative<br>
64Autostart<br>
124Recurring</dd>
<dt>
<i>freqinterval</i></dt>
<dd>
Specifies the interval for <i>freqtype</i>.</dd>
<dt>
<i>freqsubtype</i></dt>
<dd>
Specifies how often to reschedule the task during the defined period:<br>
1  Once (the default)<br>
2  Second<br>
4  Minute<br>
8  Hour</dd>
<dt>
<i>freqsubinterval</i></dt>
<dd>
Specifies the value for <i>freqsubtype</i> when the <i>freqsubtype</i> is set to second, minute, or hour.</dd>
<dt>
<i>freqrelativeinterval</i></dt>
<dd>
Specifies the value used when <i>freqtype</i> is set to 32 (monthly relative). Indicates the first, second, third, fourth, or last day of the month:
<p>
1First (the default)<br>
2Second<br>
4Third<br>
8Fourth<br>
16Last
</dd>
<dt>
<i>freqrecurrencefactor</i></dt>
<dd>
Specifies how often the task should reoccur during the defined <i>freqtype</i>.</dd>
<dt>
<i>activestartdate</i></dt>
<dd>
Specifies the date when this task will first be scheduled. Formatted as YYYYMMDD. The default is 0.</dd>
<dt>
<i>activeenddate</i></dt>
<dd>
Specifies the date when this task will stop being scheduled. Formatted as YYYYMMDD. The default is 0.</dd>
<dt>
<i>activestarttimeofday</i></dt>
<dd>
Specifies when this task will be scheduled initially. Formatted as HHMMSS. The default is 0.</dd>
<dt>
<i>activeendtimeofday</i></dt>
<dd>
Specifies when this task will stop being scheduled. Formatted as HHMMSS. The default is 0.</dd>
<dt>
<i>nextrundate</i></dt>
<dd>
Specifies the date the task will be scheduled. If the current date is greater than <i>activestartdate</i>, specifies the next date that the task will be scheduled; 0 indicates that the SQL Executive will calculate the next appropriate date. Formatted as YYYYMMDD. The default is 0.</dd>
<dt>
<i>nextruntime</i></dt>
<dd>
Specifies the date the task will be scheduled if the current time is greater than the <i>activestarttime</i>. 0 indicates that the SQL Executive will calculate the next appropriate time. Formatted as HHMMSS. The default is 0.</dd>
<dt>
<i>runpriority</i></dt>
<dd>
Specifies the thread priority level at which the subsystem event thread runs. The default is 0.</dd>
<dt>
<i>emailoperatorname</i></dt>
<dd>
The e-mail name of the operator who will receive notifications. The default is NULL.</dd>
<dt>
<i>retryattempts</i></dt>
<dd>
Specifies the number of times the SQL Executive retries before issuing an error. The default is 0.</dd>
<dt>
<i>retrydelay</i></dt>
<dd>
Specifies the interval the SQL Executive waits before retrying the task. The default is 1.</dd>
<dt>
<i>command</i></dt>
<dd>
Specifies a command string (based on the valid specified <i>subsystem</i> commands) to be passed to the subsystem. If the specified subsystem is TSQL, the command cannot consist of more than one batch. The batch separator GO is not supported. The default is NULL.</dd>
<dt>
<i>loghistcompletionlevel</i></dt>
<dd>
Specifies the level of events to capture in the event log: 1 captures all successfully run events, 2 captures only failed events.</dd>
<dt>
<i>emailcompletionlevel</i> </dt>
<dd>
Specifies the level of events to capture via e-mail: 1 captures all successfully run events; 2 captures only failed events. The default is 2.</dd>
<dt>
<i>description</i></dt>
<dd>
Is a description of the task.</dd>
<dt>
<i>tagadditionalinfo</i> </dt>
<dd>
Is user-defined information. This parameter is not required and is normally not used. <i>Varchar</i> (96).</dd>
<dt>
<i>tagobjectid</i></dt>
<dd>
Is user-defined information. This parameter is not required and is normally not used. <i>Integer</i>.</dd>
<dt>
<i>tagobjecttype</i></dt>
<dd>
Is user-defined information. This parameter is not required and is normally not used. <i>Integer</i>.</dd>
<dt>
@newid OUTPUT</dt>
<dd>
Is an output parameter that returns the system generated ID for the task.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This stored procedure must be run from the <i>msdb</i> database.</p>
<h4>Examples</h4>
<h5>&nbsp;&nbsp;&nbsp;&nbsp;A.&nbsp;&nbsp;&nbsp;&nbsp;Add a Sync Task</h5>
<p>
This example adds a task for <b>"auth_table_sync"</b> in subsystem <b>"Sync"</b> to run each hour from 9 A.M. to 11 P.M. If scheduled to run after September 26, 1995, the task starts at 4:00 P.M. the first day. </p>
<pre>sp_addtask "auth_table_sync", "Sync", "server1", "sa",
    "pubs", 1, 4, 1, 8, 1, 0, 0, 19950926, 19991231, 
    090000, 230000, 00000000, 160000, 0, "", 2, 1, "", 2, 2
</pre>
<h5>&nbsp;&nbsp;&nbsp;&nbsp;B.&nbsp;&nbsp;&nbsp;&nbsp;Add a Distribution Task</h5>
<p>
This example adds a task for <b>"dist_server2_pubs"</b> in subsystem <b>"Distribution"</b> to run every 15 minutes and pass the command string <b>"-Sserver2 -Usa -P -dpubs -pserver1"</b>. </p>
<pre>sp_addtask "dist_server2_pubs", "Distribution", "server1", 
    "sa", "pubs", 1, 4, 1, 4, 15, 0, 0, 19950926, 19991231, 000500, 
    235500, 00000000, 000000, 0, "", 2, 1, 
    "-server2 -Usa -P -dpubs -pserver1", 2, 2
</pre>
<h4>Permission</h4>
<p>
Execute permission defaults to the <i>public</i> group.</p>
<h4>Tables Used</h4>
<p>
<i>systasks</i></p>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%></td>
<td width=52%></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql17_01d1.htm"><b>sp_droptask</b></a></td>
<td width=52%><a href="tsql17_13ol.htm"><b>sp_purgehistory</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql17_30bp.htm"><b>sp_helphistory</b></a></td>
<td width=52%><a href="tsql17_7rz9.htm"><b>sp_updatetask</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql17_6yjp.htm"><b>sp_helptask</b></a></td>
<td width=52%></td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
