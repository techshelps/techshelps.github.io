<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>xp_deletemail Extended Stored Procedure</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_xp_deletemail_extended_stored_procedure"></a>xp_deletemail Extended Stored Procedure</h2>
<p>
Deletes a message from the SQL Server inbox. This procedure is used by the <b>sp_processmail </b>system stored procedure to process mail in the SQL Server inbox.</p>
<h4>Syntax</h4>
<p>
<b>xp_deletemail</b> [@msg_id <b>=</b> ] <i>msg_id</i></p>
<p>
where
<dl>
<dt>
@msg_id <b>=</b> <i>msg_id</i></dt>
<dd>
Specifies the ID (as assigned by <b>xp_findnextmsg</b>)<b> </b>of the mail message in the inbox that should be deleted.</dd>
</dl>
<h4>Remarks</h4>
<p>
This extended stored procedure returns a successful (0) or failed (1) status. Any failure except an invalid parameter is logged to the Windows NT application event log.</p>
<h4>Example</h4>
<p>
This example deletes the message ID as supplied from <b>xp_findnextmsg</b>. In this example, the value from <b>xp_findnextmsg</b> is placed in a local variable named @message_id.</p>
<pre>xp_deletemail @message_id
</pre>
<h4>Permission</h4>
<p>
Execute permission defaults to the system administrator, who can grant permission to other users.</p>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%></td>
<td width=52%></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql23_095x.htm"><b>sp_processmail</b></a></td>
<td width=52%><a href="tsql14_4nad.htm"><b>xp_sendmail</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql14_7ylh.htm"><b>xp_findnextmsg</b></a></td>
<td width=52%><a href="tsql14_0411.htm"><b>xp_startmail</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql14_4dph.htm"><b>xp_readmail</b></a></td>
<td width=52%><a href="tsql14_77c5.htm"><b>xp_stopmail</b></a></td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
