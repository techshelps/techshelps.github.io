<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>UPDATETEXT Statement</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_updatetext"></a>UPDATETEXT Statement</h2>
<p>
Updates an existing <i>text</i> or <i>image </i>field. WRITETEXT updates and replaces an entire <i>text</i> or <i>image </i>field. UPDATETEXT is more flexible because it changes only a portion of a <i>text</i> or <i>image </i>value in place.</p>
<h4>Syntax</h4>
<p>
UPDATETEXT<br>
[[<i>database</i><b>.</b>]<i>owner</i><b>.</b>]<i>table_name</i><b>.</b><i>dest_column_name</i> <i>dest_text_ptr<br>
</i>{NULL | <i>insert_offset</i>} {NULL | <i>delete_length</i>} [WITH LOG]<br>
[<i>inserted_data</i> | <br>
[{[<i>database</i><b>.</b>]<i>owner</i><b>.</b>]<i>table_name</i><b>.</b><i>src_column_name</i> <i>src_text_ptr</i>}]</p>
<p>
where
<dl>
<dt>
<i>table_name</i><b>.</b><i>dest_column_name</i></dt>
<dd>
Specifies the table and <i>text</i> or <i>image</i> column to be updated. The database name and owner name are optional.</dd>
<dt>
<i>dest_text_ptr</i></dt>
<dd>
Is a text pointer value (returned by the TEXTPTR function) that points to the <i>text</i> or <i>image</i> data to be updated.</dd>
<dt>
<i>insert_offset</i></dt>
<dd>
Is the zero-based starting position, specified as the number of bytes (from the start of the existing <i>text</i> or <i>image</i> value) to skip before inserting the new data. The existing <i>text</i> or <i>image</i> data beginning at this zero-based starting position will be shifted to the right to make room for the new data. A value of 0 means that the new data will be inserted at the beginning of the existing data value. A value of NULL means that the new data will be appended to the existing data value.</dd>
<dt>
<i>delete_length</i></dt>
<dd>
Is the number of bytes to delete from the existing <i>text</i> or <i>image</i> value, starting at the <i>insert_offset</i> position. A value of 0 means that no data will be deleted. A value of NULL means that all data from the <i>insert_offset</i> position to the end of the existing <i>text</i> or <i>image</i> value will be deleted.</dd>
<dt>
WITH LOG</dt>
<dd>
Specifies that the inserted <i>text</i> or <i>image</i> data will be logged. This option allows recovery, but it can quickly increase the size of the transaction log.

<p>
<b>Note</b>  If the WITH LOG option is not specified, the database must have the <b>select into/bulkcopy</b> database option turned on. For details, see the <b>sp_dboption</b> system stored procedure.

</dd>
<dt>
<i>inserted_data</i></dt>
<dd>
Is the data to be inserted into the existing <i>text</i> or <i>image</i> value at the <i>insert_offset</i> location. This is a single <i>char</i>, <i>varchar</i>, <i>binary</i>, <i>varbinary</i>, <i>text</i>, or <i>image</i> constant.</dd>
<dt>
<i>table_name</i><b>.</b><i>src_column_name</i></dt>
<dd>
Specifies the table and <i>text</i> or <i>image</i> column that can be used as the source of the inserted data.</dd>
<dt>
<i>src_text_ptr</i></dt>
<dd>
Is a text pointer value (returned by the TEXTPTR function) that points to a <i>text</i> or <i>image</i> value that can be used as the source of the inserted data.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The UPDATETEXT statement can be used to replace existing data, delete existing data, or insert new data. Newly inserted data can be a single <i>inserted_data</i> constant, or a table name, column name, or text pointer.</p>
<p>
To replace data, specify a non-null <i>insert_offset</i> value, a non-zero <i>delete_length</i> value, and the new data to be inserted.</p>
<p>
To delete existing data, specify a non-null <i>insert_offset</i> value and a non-zero <i>delete_length</i>. Do not specify any new data to be inserted.</p>
<p>
To insert new data, specify the desired <i>insert_offset</i> value, a <i>delete_length</i> of 0, and the new data to be inserted. </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
