<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SETUSER Statement</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_setuser_statement"></a>SETUSER Statement </h1>
<p>
Allows a database owner to impersonate another user. The SETUSER statement is used by the system administrator or a database owner when he or she wants to adopt the identity of another user in order to use another user's database object, to grant permissions to that object, to create an object, and so on.</p>
<h4>Syntax</h4>
<p>
SETUSER [<b>'</b><i>username</i><b>' </b>[WITH NORESET]]</p>
<p>
where 
<dl>
<dt>
<i>username</i></dt>
<dd>
Specifies the name of the user who will be impersonated by the system administrator or the database owner. The <i>username</i> supplied must be listed in the <i>sysusers</i> table. When no <i>username</i> is specified, the original identity of the system administrator or database owner is re-established.</dd>
<dt>
NORESET</dt>
<dd>
Specifies that subsequent SETUSER statements (with no specified <i>username</i>)<i> </i>will not reset to the system administrator or database owner. </dd>
</dl>
<h4>Remarks</h4>
<p>
Using SETUSER to impersonate a user, a database owner, or system administrator will have only those rights given to the user being impersonated. Because the owner of an object always retains the rights to that object, no users, other than those given explicit permission to that object, can access it. Because a database owner and the system administrator always have supervisory permission over their database (or the system) they can temporarily adopt another database user's identity. The database owner or system administrator can act as that user, create objects in that user's name, and test permissions as given to that user. The SETUSER statement remains in effect until another SETUSER statement is issued or until the current database is changed with the USE statement.</p>
<p>
In SQL Server 6.0, the SETUSER statement does not need to be used to drop objects owned by another user. The database owner and system administrator can drop user's objects by explicitly qualifying the object name with the owner's name. For details, see the DROP statements (DROP DEFAULT, DROP PROCEDURE, DROP TABLE, and so on).</p>
<p>
In earlier releases of SQL Server, the system administrator retained full system administrator permissions and could not use SETUSER to acquire another user's permissions. If you want to maintain compatibility with this previous behavior, use trace flag 206. For details, see the Trace Flags topic.</p>
<h4>Permission</h4>
<p>
Execute permission defaults to the database owner and is not transferable.</p>
<h4>Examples</h4>
<h5>A.&nbsp;&nbsp;&nbsp;&nbsp;SETUSER</h5>
<p>
In this example, Mary (the database username of mary) has created a table called <i>computer_types</i>. Mary happens to be out of town and another user (Joe) needs to access Mary's <i>computer_types</i> table. The database owner or system administrator can execute:</p>
<pre>SETUSER 'mary'
go
GRANT SELECT ON computer_types TO joe
go
SETUSER</pre>
<h5>B.&nbsp;&nbsp;&nbsp;&nbsp;NORESET Option</h5>
<p>
In this example, the database owner needs to create some objects and then test their usability with minimal permissions. For simplicity, the database owner wants to maintain only Mary's permission for the entire session. The database owner or system administrator can execute:</p>
<pre>SETUSER 'mary' WITH NORESET
go
CREATE TABLE computer_types2
.
.
.
GRANT ...
go
SETUSER        /* This statement will have no effect. */</pre>
<p>
The only way the database owner or system administrator can re-establish his or her own rights is to log off and then log on again.</p>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%></td>
<td width=52%></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql10_95ys.htm">GRANT</a></td>
<td width=52%><a href="tsql29_9uus.htm">USE</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql11_6elw.htm">REVOKE</a></td>
<td width=52%></td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
