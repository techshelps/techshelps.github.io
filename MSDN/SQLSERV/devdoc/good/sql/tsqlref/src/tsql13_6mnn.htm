<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_special_columns Catalog Stored Procedures</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_special_columns_catalog_stored_procedures"></a>sp_special_columns Catalog Stored Procedures </h2>
<p>
Returns the optimal set of columns that uniquely identify a row in the table and columns that are automatically updated when any value in the row is updated by a transaction.</p>
<h4>Syntax</h4>
<p>
<b>sp_special_columns</b> <i>table_name</i> [<b>, </b><i>table_owner</i>] [<b>, </b><i>table_qualifier</i>] [<b>, </b><i>col_type</i>] [<b>,</b> <i>scope</i>] [<b>,</b> <i>nullable</i>]</p>
<p>
where
<dl>
<dt>
<i>table_name</i></dt>
<dd>
Specifies the table used to return catalog information. The <i>table_name </i>can be a variable character length name with a maximum of 32 characters. Wildcard pattern matching is not supported.</dd>
<dt>
<i>table_owner</i></dt>
<dd>
Specifies the table owner of the table used to return catalog information. The <i>table_owner </i>can be a variable character name with a maximum 32 characters. Wildcard pattern matching is not supported. If the <i>table_owner</i> is not specified, the default table visibility rules of the underlying DBMS apply.
<p>
In Microsoft SQL Server, if the current user owns a table with the specified name, that table's columns are returned. If the <i>table_owner </i>is not specified and the current user does not own a table with the specified <i>table_name</i>, this procedure will look for a table with the specified <i>table_name </i>owned by the database owner. If one exists, that table's columns are returned.
</dd>
<dt>
<i>table_qualifier</i></dt>
<dd>
Is the name of the table qualifier. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the database name. In some products, it represents the server name of the table's database environment.</dd>
<dt>
<i>col_type</i></dt>
<dd>
Specifies the column type, either R or V. Type R returns the optimal column or set of columns that, by retrieving values from the column or columns, allows any row in the specified table to be uniquely identified. A column can be either a pseudo column specifically designed for this purpose, or the column or columns of any unique index for the table. Type V returns the column or columns in the specified table, if any, that are automatically updated by the data source when any value in the row is updated by any transaction.</dd>
<dt>
<i>scope</i></dt>
<dd>
Specifies the minimum required scope of the ROWID, either C or T. Scope C specifies that the ROWID is valid only when positioned on that row. Scope T specifies that the ROWID is valid for the transaction. </dd>
<dt>
<i>nullable</i></dt>
<dd>
Specifies whether or not the special column can accept a null value, either U or O. Nullable U specifies that this special column allows null values. Nullable O is a special column that does not allow null values.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>sp_special_columns</b> stored procedure is equivalent to <b>SQLSpecialColumns</b> in ODBC. The results returned are ordered by SCOPE. </p>
<p>
This is the results set:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=29%></th>
<th align=left width=18%></th>
<th align=left width=53%></th>
</tr>
<tr valign=top>
<th align=left width=29%></th>
<th align=left width=18%></th>
<th align=left width=53%></th>
</tr>
<tr valign=top>
<th align=left width=29%>Column</th>
<th align=left width=18%>Datatype</th>
<th align=left width=53%>Description</th>
</tr>
<tr valign=top>
<td width=29%></td>
<td width=18%></td>
<td width=53%></td>
</tr>
<tr valign=top>
<td width=29%>SCOPE</td>
<td width=18%><i>int</i></td>
<td width=53%>Is the actual scope of the row ID. Can be 0, 1, or 2. SQL Server always returns 0. This field will always return a value. <p>
0&nbsp;&nbsp;&nbsp;&nbsp;SQL_SCOPE_CURROW. The row<br>
&nbsp;&nbsp;&nbsp;&nbsp;ID is guaranteed to be valid only <br>
&nbsp;&nbsp;&nbsp;&nbsp;while positioned on that row. A <br>
&nbsp;&nbsp;&nbsp;&nbsp;later reselect using the row ID may<br>
&nbsp;&nbsp;&nbsp;&nbsp;not return a row if the row was <br>
&nbsp;&nbsp;&nbsp;&nbsp;updated or deleted by another <br>
&nbsp;&nbsp;&nbsp;&nbsp;transaction.</p>
<p>
1&nbsp;&nbsp;&nbsp;&nbsp;SQL_SCOPE_TRANSACTION. <br>
&nbsp;&nbsp;&nbsp;&nbsp;The row ID is guaranteed to be <br>
&nbsp;&nbsp;&nbsp;&nbsp;valid for the duration of the current<br>
&nbsp;&nbsp;&nbsp;&nbsp;transaction.</p>
<p>
2&nbsp;&nbsp;&nbsp;&nbsp;SQL_SCOPE_SESSION. The <br>
&nbsp;&nbsp;&nbsp;&nbsp;row <small>id </small>is guaranteed to be valid for<br>
&nbsp;&nbsp;&nbsp;&nbsp;the duration of the session (across<br>
&nbsp;&nbsp;&nbsp;&nbsp;transaction boundaries).</p>
</td>
</tr>
<tr valign=top>
<td width=29%>COLUMN_NAME</td>
<td width=18%><i>varchar</i>(32)</td>
<td width=53%>Is the name of the column, for each column of the TABLE_NAME returned. In Microsoft SQL Server, this column represents the column name as listed in the <i>syscolumns</i> table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=29%>DATA_TYPE</td>
<td width=18%><i>smallint</i></td>
<td width=53%>Is an ODBC SQL datatype. </td>
</tr>
<tr valign=top>
<td width=29%>TYPE_NAME</td>
<td width=18%><i>varchar</i>(13)</td>
<td width=53%>Is a data source-dependent datatype name; for example, <b>'</b>CHAR<b>'</b>, <b>'</b>VARCHAR<b>'</b>, <b>'</b>MONEY<b>'</b>, or <b>'</b>TEXT<b>'</b>.</td>
</tr>
<tr valign=top>
<td width=29%>PRECISION</td>
<td width=18%><i>int</i></td>
<td width=53%>Is the precision of the column on the data source. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=29%>LENGTH</td>
<td width=18%><i>int</i></td>
<td width=53%>Is the length, in bytes, required for the datatype in its binary form in the data source. For example, 10 for CHAR(10), 4 for INTEGER, and 2 for SMALLINT.</td>
</tr>
<tr valign=top>
<td width=29%>SCALE</td>
<td width=18%><i>smallint</i></td>
<td width=53%>Is the scale of the column on the data source. NULL is returned for datatypes where scale is not applicable.</td>
</tr>
<tr valign=top>
<td width=29%>PSEUDO_COLUMN</td>
<td width=18%><i>smallint</i></td>
<td width=53%>Indicates whether the column is a pseudo column. SQL Server 6.0 always returns 2. Can be:<p>
0&nbsp;&nbsp;&nbsp;&nbsp;SQL_PC_UNKNOWN<br>
1&nbsp;&nbsp;&nbsp;&nbsp;SQL_PC_PSEUDO<br>
2&nbsp;&nbsp;&nbsp;&nbsp;SQL_PC_NOT_PSEUDO</p>
</td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
