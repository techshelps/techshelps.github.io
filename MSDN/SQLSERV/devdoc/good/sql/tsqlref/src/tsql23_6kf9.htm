<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_logdevice System Stored Procedure</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_logdevice_system_stored_procedure"></a>sp_logdevice System Stored Procedure</h2>
<p>
Puts the <i>syslogs</i> system table, which contains the transaction log, on a separate database device.</p>
<h4>Syntax</h4>
<p>
<b>sp_logdevice</b> <i>dbname</i><b>,</b> <i>database_device</i></p>
<p>
where
<dl>
<dt>
<i>dbname</i></dt>
<dd>
Specifies which database has the <i>syslogs</i> table to put on a specific database device.</dd>
<dt>
<i>database_device</i></dt>
<dd>
Is the name of the database device on which to put the <i>syslogs</i> table. This database device must have been referenced in a CREATE DATABASE or ALTER DATABASE statement for <i>dbname</i>. Run <b>sp_helpdevice</b> for a report on existing database devices.
</dd>
</dl>
<p>
<b>Note</b>  Because <b>sp_logdevice</b> affects only future allocations of space for <i>syslogs</i>, the first pages of your log remain on the same device as your data, leaving them temporarily vulnerable. However, using the LOG ON extension to CREATE DATABASE immediately puts the entire transaction log on a separate device.</p>
<h4>Remarks</h4>
<p>
For better recovery and performance, put most databases and their transaction logs on separate database devices. You can keep small and non-critical databases on the same device as their log. In that case, however, use only the DUMP DATABASE statement (never DUMP TRANSACTION) for backups.</p>
<p>
DBCC CHECKALLOC and <b>sp_helplog</b> show some pages for <i>syslogs</i> still allocated on the database device until after the next DUMP TRANSACTION statement. After that, transfer the transaction log to the device named when you executed <b>sp_logdevice</b>.</p>
<p>
The size of the database device required for a transaction log varies according to the amount of update activity and the frequency of transaction log dumps. As a rule, allocate to the log device 10-25 percent of the space you allocate to the database itself. It is best to start small, since space allocated to a transaction log device cannot be reclaimed.</p>
<p>
To increase the amount of allocated storage space on the transaction log database device, give the logical name of the log database device in the ON clause when you execute the ALTER DATABASE statement. Then execute <b>sp_logdevice</b> to make the newly allocated space available to the log.</p>
<p>
The device or segment on which you put <i>syslogs</i> is used only for the <i>syslogs</i> table. If you want to increase the amount of storage space allocated to the rest of the database, specify any database device other than the log database device when you execute the ALTER DATABASE statement.</p>
<p>
Use the DISK INIT statement to format a new physical database device on which to store databases and transaction logs.</p>
<p>
For further details, see the <i>Microsoft SQL Server Administrator's Companion</i>.</p>
<h4>Example</h4>
<p>
This example shows how <b>sp_logdevice</b> is used after altering a database. In this example the <i>products</i> database is altered by 2 MB and the log is then moved to that 2-MB segment.</p>
<pre>ALTER DATABASE products ON logdevice = 2
go

sp_logdevice products, logdevice
</pre>
<h4>Permission</h4>
<p>
Execute permission defaults to the database owner of the named database.</p>
<h4>Tables Used</h4>
<p>
<i>master.dbo.sysdatabases</i>, <i>master.dbo.sysdevices</i>, <i>master.dbo.sysusages</i></p>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%><a href="tsql01_9b04.htm">ALTER DATABASE</a></td>
<td width=52%><a href="tsql08_2zxw.htm">DUMP</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql02_69ro.htm">CREATE DATABASE</a></td>
<td width=52%><a href="tsql21_1ffp.htm"><b>sp_extendsegment</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql06_0yus.htm">DBCC</a></td>
<td width=52%><a href="tsql22_79id.htm"><b>sp_helpdevice</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql07_3t9w.htm">DISK INIT</a></td>
<td width=52%></td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
