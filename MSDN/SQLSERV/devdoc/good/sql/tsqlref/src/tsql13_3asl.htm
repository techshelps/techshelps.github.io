<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_columns Catalog Stored Procedure</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_columns_catalog_stored_procedure"></a>sp_columns Catalog Stored Procedure </h2>
<p>
For SQL Server 6.5 information, see <a href="../../hydra/tsql/src/addsproc_4g37.htm"><b>sp_columns</b></a> in <i>What's New for SQL Server 6.5</i>.</p>
<p>
Returns column information for a single object that can be queried in the current environment. The returned columns belong to a table or a view.</p>
<h4>Syntax</h4>
<p>
<b>sp_columns</b> <i>object_name</i> [<b>,</b> <i>object_owner</i>] [<b>,</b> <i>object_qualifier</i>] [<b>,</b> <i>column_name</i>]</p>
<p>
where
<dl>
<dt>
<i>object_name</i></dt>
<dd>
Is the name of the table or view used to return catalog information. The <i>object_name </i>can be a variable character name with a maximum of 32 characters. Wildcard pattern matching is not supported.</dd>
<dt>
<i>object_owner</i></dt>
<dd>
Specifies the object owner of the table or view used to return catalog information. The <i>object_owner </i>can be a variable character name with a maximum of 32 characters. Wildcard pattern matching is not supported. If <i>object_owner</i> is not specified, the default table or view visibility rules of the underlying DBMS apply.
<p>
In Microsoft SQL Server, if the current user owns a table or view with the specified name, that table's columns are returned. If <i>object_owner </i>is not specified and the current user does not own a table or view with the specified <i>object_name</i>, this procedure looks for a table or view with the specified <i>object_name </i>owned by the database owner. If one exists, that table's columns are returned.
</dd>
<dt>
<i>object_qualifier</i></dt>
<dd>
Specifies the name of the table or view qualifier. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the database name. In some products, it represents the server name of the table's database environment.</dd>
<dt>
<i>column_name</i></dt>
<dd>
Specifies a single column and is used when only one column of catalog information is desired. If <i>column_name </i>is not specified, all columns will be returned. In Microsoft SQL Server, this <i>column_name </i>represents the column name as listed in the <i>syscolumns</i> table. The value specified can include wildcard characters using the underlying DBMS's wildcard matching patterns. For maximum interoperability, the gateway client should assume only ANSI-standard SQL pattern matching (the % and _ wildcard characters).
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>sp_columns</b> catalog stored procedure is equivalent to <b>SQLColumns</b> in ODBC. The results returned are ordered by TABLE_QUALIFIER, TABLE_OWNER, and TABLE_NAME.</p>
<p>
This is the results set:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=31%></th>
<th align=left width=20%></th>
<th align=left width=49%></th>
</tr>
<tr valign=top>
<th align=left width=31%></th>
<th align=left width=20%></th>
<th align=left width=49%></th>
</tr>
<tr valign=top>
<th align=left width=31%>Column</th>
<th align=left width=20%>Datatype</th>
<th align=left width=49%>Description</th>
</tr>
<tr valign=top>
<td width=31%></td>
<td width=20%></td>
<td width=49%></td>
</tr>
<tr valign=top>
<td width=31%>TABLE_QUALIFIER</td>
<td width=20%><i>varchar</i>(32)</td>
<td width=49%>Is the name of the table or view qualifier. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the database name. In some products, it represents the server name of the table's database environment. This field can be NULL.</td>
</tr>
<tr valign=top>
<td width=31%>TABLE_OWNER</td>
<td width=20%><i>varchar</i>(32)</td>
<td width=49%>Is the name of the table or view owner. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the name of the database user that created the table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=31%>TABLE_NAME</td>
<td width=20%><i>varchar</i>(32)</td>
<td width=49%>Is the name of the table or view. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the table or view name as listed in the <i>sysobjects</i> table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=31%>COLUMN_NAME</td>
<td width=20%><i>varchar</i>(32)</td>
<td width=49%>Is the name of the column, for each column of the TABLE_NAME returned. In Microsoft SQL Server, this column represents the column name as listed in the <i>syscolumns</i> table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=31%>DATA_TYPE</td>
<td width=20%><i>smallint</i></td>
<td width=49%>Is an integer code for ODBC datatype. If this is a datatype that cannot be mapped to an ODBC type, it is NULL. The native datatype name is returned in the TYPE_NAME column.</td>
</tr>
<tr valign=top>
<td width=31%>TYPE_NAME</td>
<td width=20%><i>varchar</i>(13)</td>
<td width=49%>Is a string representing a datatype. The underlying DBMS presents this datatype name.</td>
</tr>
<tr valign=top>
<td width=31%>PRECISION</td>
<td width=20%><i>int</i></td>
<td width=49%>Is the number of significant digits.</td>
</tr>
<tr valign=top>
<td width=31%>LENGTH</td>
<td width=20%><i>int</i></td>
<td width=49%>Is the transfer size of the data. (*) </td>
</tr>
<tr valign=top>
<td width=31%>SCALE</td>
<td width=20%><i>smallint</i></td>
<td width=49%>Is the number of digits to the right of the decimal point.</td>
</tr>
<tr valign=top>
<td width=31%>RADIX</td>
<td width=20%><i>smallint</i></td>
<td width=49%>Is the base for numeric types.</td>
</tr>
<tr valign=top>
<td width=31%>NULLABLE</td>
<td width=20%><i>smallint</i></td>
<td width=49%>Specifies nullability. 1 means NULL is possible; 0 means NOT NULL.</td>
</tr>
<tr valign=top>
<td width=31%>REMARKS</td>
<td width=20%><i>varchar</i>(254)</td>
<td width=49%>For Microsoft SQL Server, this field will always return NULL.</td>
</tr>
<tr valign=top>
<td width=31%>SS_DATA_TYPE</td>
<td width=20%><i>tinyint</i></td>
<td width=49%>Is a SQL Server datatype, as defined in <i>Microsoft SQL Server Programming Open Data Services</i>, used by ODS gateway applications. The gateway converts the underlying data to this SQL Server datatype as the default. If the gateway supports configurable datatype conversions, either per installation or per session, then the conversion type is returned when the stored procedure is executed.</td>
</tr>
<tr valign=top>
<td width=31%>COLID</td>
<td width=20%><i>tinyint</i></td>
<td width=49%>Is a SQL Server - specific column appended to the result set. This column does not need to appear in Open Data Services gateway implementations of catalog stored procedures.</td>
</tr>
<tr valign=top>
<td colspan=3 width=100%>*&nbsp;&nbsp;&nbsp;&nbsp;For details about length, see the <i>Microsoft ODBC Programmer's Reference and SDK </i><br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>Guide</i>, available separately.</td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
