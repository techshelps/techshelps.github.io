<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>xp_startmail Extended Stored Procedure</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_xp_startmail_extended_stored_procedure"></a>xp_startmail Extended Stored Procedure</h2>
<p>
Starts a SQL Server mail client session.</p>
<h4>Syntax</h4>
<p>
<b>xp_startmail</b> [<b>'</b><i>user</i><b>'</b>] [<b>,</b> <b>'</b><i>password</i><b>'</b>] </p>
<p>
where 
<dl>
<dt>
<i>user</i></dt>
<dd>
Is an optional parameter specifying a mail username. </dd>
<dt>
<i>password</i></dt>
<dd>
Is the mail password for the named <i>user</i>. NULL is allowed when the mail client is started (on the same computer) before running <b>xp_startmail</b>. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
If <i>user</i> and <i>password</i> are provided, SQL Server attempts to log on to Windows NT Mail (or other MAPI provider) using that username and password. If <i>user</i> and <i>password</i> are provided but are incorrect, an error message is returned. If no <i>user</i> or <i>password</i> are provided, SQL Server uses the username and password specified in SQL Setup, using the Mail Login dialog box under Server Options.</p>
<p>
If there is an existing mail session, <b>xp_startmail</b> will not start a new one. If mail is being used on the same computer on which SQL Server is also running, the mail client must be started before <b>xp_startmail</b> is used or before SQL Server (if using the Set Server Options "Auto Start Mail Client" option found in SQL Setup). For more information, see the <i>Microsoft SQL Server Administrator's Companion</i>.</p>
<h4>Examples</h4>
<h5>A.&nbsp;&nbsp;&nbsp;&nbsp;No Variables with xp_startmail</h5>
<p>
This example starts mail using the username and password specified in SQL Setup.</p>
<pre>xp_startmail
</pre>
<h5>B.&nbsp;&nbsp;&nbsp;&nbsp;Variables with xp_startmail</h5>
<p>
This example starts mail using the username <i>mailuser</i> and the password <i>abc12345</i>.</p>
<pre>xp_startmail 'mailuser', 'abc12345'
</pre>
<h4>Permission</h4>
<p>
Execute permission defaults to the system administrator, who can grant permission to other users.</p>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%></td>
<td width=52%></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql23_095x.htm"><b>sp_processmail</b></a></td>
<td width=52%><a href="tsql14_4dph.htm"><b>xp_readmail</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql14_7vfp.htm"><b>xp_deletemail</b></a></td>
<td width=52%><a href="tsql14_4nad.htm"><b>xp_sendmail</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql14_7ylh.htm"><b>xp_findnextmsg</b></a></td>
<td width=52%><a href="tsql14_77c5.htm"><b>xp_stopmail</b></a></td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
