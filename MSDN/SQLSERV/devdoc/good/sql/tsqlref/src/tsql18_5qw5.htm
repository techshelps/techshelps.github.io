<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_adduser System Stored Procedure</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_adduser_system_stored_procedure"></a>sp_adduser System Stored Procedure </h2>
<p>
Adds a new user to the current database.</p>
<h4>Syntax</h4>
<p>
<b>sp_adduser</b> <i>login_id</i> [<b>,</b> <i>username</i> [<b>,</b> <i>grpname</i>]]</p>
<p>
where
<dl>
<dt>
<i>login_id</i></dt>
<dd>
Is the user's login ID as found in the <i>name</i> column of <i>master.dbo.syslogins</i>.</dd>
<dt>
<i>username</i></dt>
<dd>
Specifies a name for this user in the current database. Omitting this parameter causes the <i>username</i> to default to the user's login ID.</dd>
<dt>
<i>grpname</i></dt>
<dd>
Identifies an existing group in the database. If you don't specify a group, the user becomes a member of the default group <i>public</i>. If you want to add a user to a group, you must supply a value for the <i>username</i> parameter. (The <i>username</i> can be the same as <i>login_id</i>.)
<p>
A user can be a member of only one group, in addition to <i>public</i>. Every user is a member of the default group, <i>public</i>. The group must already exist in the database.

</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>sp_adduser</b> system stored procedure treats the combination of a <i>guest</i> login ID and user <i>guest</i> as a special case. In earlier releases, a non-special <i>guest</i> user could be created within a user-defined database. SQL Server 6.0 prevents this from happening, in the following way:
<ul>
<li>
If a login name of <i>guest</i> is specified with the <b>sp_adduser</b> system stored procedure and a <i>guest</i> login exists and the username is not specified as <i>guest</i>, a user with the <i>suid</i> of the login name <i>guest</i> will be added.<pre>sp_adduser guest, dbuser1</pre>
</li>
<li>
If the username <i>guest</i> is specified and the login name specified is not <i>guest</i>, an error message is returned, stating the <i>guest</i> user cannot be mapped to a login.<pre>sp_adduser loginid1, guest</pre>
</li>
<li>
If a login name of <i>guest</i> is specified and the username specified is <i>guest</i> or not supplied, then the user created within the database will be the special <i>guest</i> user. If the <i>guest</i> user already exists, an error message will be returned.<pre>sp_adduser guest, guest</pre>
</li>
</ul>
<p>
The database owner executes the <b>sp_adduser</b> system stored procedure to add a login ID to the <i>sysusers</i> table of the current database, enabling the user to access the current database under his or her own name.</p>
<p>
Specifying a <i>username</i> parameter gives the new user a name in the database different from his or her login ID on SQL Server. The ability to assign a different name to a user on SQL Server and in a database is provided as a convenience. This is not an alias as provided by the sp_addalias system stored procedure¾ the user is simply given a different name, not mapped to the identity and permissions of another user as with <b>sp_addalias</b>.</p>
<p>
To access a database, a user must be listed in <i>sysusers</i> (by using <b>sp_adduser</b>) or mapped to another user in <i>sysalternates</i> (by using <b>sp_addalias</b>), or there must be a <i>guest</i> entry in <i>sysusers</i>.</p>
<h4>Examples</h4>
<h5>A.&nbsp;&nbsp;&nbsp;&nbsp;Add a User</h5>
<p>
The SQL Server login ID Victoria has already been added to SQL Server with <b>sp_addlogin</b>. This example adds Victoria to the database. Victoria will be known in the current database by the username Victoria and belong to the group <i>fort_mudge</i> (previously created with <b>sp_addgroup</b>).</p>
<pre>sp_adduser Victoria, Victoria, fort_mudge
</pre>
<h5>B.&nbsp;&nbsp;&nbsp;&nbsp;Add a Username with the Same Login ID</h5>
<p>
This example adds Margaret to the database. Her database username is the same as her SQL Server login ID, and she belongs to the default group <i>public</i>.</p>
<pre>sp_adduser Margaret
</pre>
<h5>C.&nbsp;&nbsp;&nbsp;&nbsp;Add a User Who Uses a Different Username</h5>
<p>
This example adds Haroldq to the database. When Haroldq uses the current database, his name is Harold. He belongs to the <i>fort_mudge</i> group.</p>
<pre>sp_adduser Haroldq, Harold, fort_mudge
</pre>
<h4>Permission</h4>
<p>
Execute permission defaults to the database owner.</p>
<h4>Tables Used</h4>
<p>
<i>master.dbo.syslogins</i>, <i>sysalternates</i>, <i>sysusers</i></p>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%><a href="tsql10_95ys.htm">GRANT</a></td>
<td width=52%><a href="tsql21_68kl.htm"><b>sp_dropgroup</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql11_6elw.htm">REVOKE</a></td>
<td width=52%><a href="tsql23_12zp.htm"><b>sp_helpuser</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql18_4j1h.htm"><b>sp_addalias</b></a></td>
<td width=52%><a href="tsql29_9uus.htm">USE</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql18_77fp.htm"><b>sp_addgroup</b></a></td>
<td width=52%><a href="tsql14_9r6t.htm"><b>xp_grantlogin</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql18_5r39.htm"><b>sp_changegroup</b></a></td>
<td width=52%><a href="tsql14_4ijp.htm"><b>xp_logininfo</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql21_3k6d.htm"><b>sp_dropalias</b></a></td>
<td width=52%><a href="tsql14_9yhx.htm"><b>xp_revokelogin</b></a></td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
