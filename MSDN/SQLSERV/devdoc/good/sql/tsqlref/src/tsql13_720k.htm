<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SHUTDOWN Statement</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_shutdown_statement"></a>SHUTDOWN Statement </h1>
<p>
Stops SQL Server. Only the system administrator can execute this statement.</p>
<h4>Syntax</h4>
<p>
SHUTDOWN [WITH NOWAIT]</p>
<p>
where
<dl>
<dt>
WITH NOWAIT</dt>
<dd>
Shuts down SQL Server immediately, without performing checkpoints in every database. SQL Server exits after attempting to terminate all user processes and roll back any active transactions.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Unless the system administrator uses the WITH NOWAIT option, SHUTDOWN tries to shut down SQL Server in an orderly fashion by:
<ol>
<li>
Disabling logins (except for the system administrator). To see a listing of all current users, use the <b>sp_who</b> system stored procedure.</li>
<li>
Waiting for currently executing Transact-SQL statements or stored procedures to finish. To see a listing of all active processes and locks, use the <b>sp_lock</b> and <b>sp_who </b>system stored procedures.</li>
<li>
Performing a checkpoint in every database.</li>
</ol>
<p>
Using the SHUTDOWN statement minimizes the amount of automatic recovery work needed when the system administrator restarts SQL Server.</p>
<p>
The following tools and methods can also be used to stop SQL Server. Each of these performs a checkpoint in all databases and then a SHUTDOWN WITH NOWAIT to flush all committed data from data cache and stop the server quickly.
<ul>
<li>
SQL Enterprise Manager.</li>
<li>
NET STOP MSSQLSERVER from a Win32 command prompt.</li>
</ul>
<p>
SQL Server can also be stopped by the following methods. Because these methods do not perform checkpoints in each database prior to shutdown, they are not recommended and may increase the recovery time needed the next time the server is restarted. You can stop SQL Server in these additional ways:
<ul>
<li>
By using the Services application from the Windows NT Control Panel.</li>
<li>
By pressing ctrl+c if <b>sqlservr.exe </b>was started from the command-line.</li>
</ul>
<h4>Permission</h4>
<p>
SHUTDOWN permission defaults to the system administrator and cannot be transferred.</p>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%></td>
<td width=52%></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql30_2fdx.htm"><b>sqlservr</b> Command-line Executable</a></td>
<td width=52%><a href="tsql24_2739.htm"><b>sp_who</b> System Stored Procedure</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql23_6z51.htm"><b>sp_lock</b> System Stored Procedure</a></td>
<td width=52%></td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
