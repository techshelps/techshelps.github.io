<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>UPDATE STATISTICS Statement</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_update_statistics_statement"></a>UPDATE STATISTICS Statement </h1>
<p>
Updates information about the distribution of key values in specified indexes.</p>
<h4>Syntax</h4>
<p>
UPDATE STATISTICS [[<i>database</i><b>.</b>]<i>owner</i><b>.</b>]<i>table_name</i> [<i>index_name</i>]</p>
<p>
where
<dl>
<dt>
<i>table_name</i></dt>
<dd>
Specifies the table with which the index is associated. The <i>table_name</i> parameter is required because Transact-SQL does not require index names to be unique in a database.</dd>
<dt>
<i>index_name</i></dt>
<dd>
Specifies the index to be updated. If an index name is not specified, the distribution statistics for all indexes in the specified table are updated. To see a list of index names and descriptions, execute the <a href="tsql22_5rdx.htm"><b>sp_helpindex</b> system stored procedure</a> with the table name. 
</dd>
</dl>
<h4>Remarks</h4>
<p>
SQL Server keeps statistics about the distribution of the key values in each index and uses these statistics in decisions about which index(es) to use in query processing. The optimization of your queries depends on the accuracy of the distribution steps. If there is significant change in the key values in your index, rerun UPDATE STATISTICS on that index. If a great deal of data in an indexed column has been added, changed, or removed (that is, if you suspect that the distribution of key values has changed) or the table has been truncated using the TRUNCATE TABLE statement and then repopulated, use the UPDATE STATISTICS statement.</p>
<p>
UPDATE STATISTICS is run automatically when you create or re-create an index on a table that already contains data. However, to see when the statistics were last updated, use the STATS_DATE system function or the DBCC SHOW_STATISTICS option. For syntax and usage, see the Functions topic and the DBCC statement.</p>
<h4>Permission</h4>
<p>
UPDATE STATISTICS permission defaults to the table owner and is not transferable.</p>
<h4>Examples</h4>
<h5>A.&nbsp;&nbsp;&nbsp;&nbsp;Update All Statistics for a Single Table</h5>
<p>
This single command will update the distribution statistics for all indexes on the <i>authors </i>table.</p>
<pre>UPDATE STATISTICS authors
</pre>
<h5>B.&nbsp;&nbsp;&nbsp;&nbsp;Update Only the Statistics for a Single Index</h5>
<p>
To update only the distribution information for one index on a table, specify the index after the table name.</p>
<pre>UPDATE STATISTICS authors au_id_ind
</pre>
<h5>C.&nbsp;&nbsp;&nbsp;&nbsp;Use Cursors to Run UPDATE STATISTICS on All Tables</h5>
<p>
In this example, the <i>update_all_stats </i>procedure will first create a cursor, <i>tnames_cursor</i>, and then populate the cursor with all rows from <i>sysobjects</i> of type <b>'</b>U<b>'</b> = User-defined table. After retrieving all table names, this procedure will run UPDATE STATISTICS against each of the tables.</p>
<pre>CREATE PROCEDURE update_all_stats
AS
/*
    This procedure will run UPDATE STATISTICS against
    all user-defined tables within this database.
*/
DECLARE @tablename varchar(30)
DECLARE @tablename_header varchar(75)
DECLARE tnames_cursor CURSOR FOR SELECT name FROM sysobjects 
    WHERE type = 'U'
OPEN tnames_cursor
FETCH NEXT FROM tnames_cursor INTO @tablename
WHILE (@@fetch_status &lt;&gt; -1)
BEGIN
    IF (@@fetch_status &lt;&gt; -2)
    BEGIN
        SELECT @tablename_header = "Updating "  
            RTRIM(UPPER(@tablename))
        PRINT @tablename_header
        EXEC ("UPDATE STATISTICS "  @tablename )
    END
    FETCH NEXT FROM tnames_cursor INTO @tablename
END
PRINT " "
PRINT " "
SELECT @tablename_header = "*************  NO MORE TABLES"
             "  *************" 
PRINT @tablename_header
PRINT " "
PRINT "Statistics have been updated for all tables."
DEALLOCATE tnames_cursor
go
update_all_stats
go
Updating AUTHORS
Updating DISCOUNTS
Updating EMPLOYEE
Updating JOBS
Updating PUB_INFO
Updating PUBLISHERS
Updating ROYSCHED
Updating SALES
Updating STORES
Updating TITLEAUTHOR
Updating TITLES
 
 
*************  NO MORE TABLES  *************
 
Statistics have been updated for all tables.
</pre>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%></td>
<td width=52%></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql03_46t0.htm">CREATE INDEX</a></td>
<td width=52%><a href="tsql08_8dx0.htm">EXECUTE</a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql05_8037.htm">Cursors</a></td>
<td width=52%><a href="tsql22_5rdx.htm"><b>sp_helpindex</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql06_0yus.htm">DBCC</a></td>
<td width=52%><a href="tsql09_2svt.htm">System Functions</a></td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
