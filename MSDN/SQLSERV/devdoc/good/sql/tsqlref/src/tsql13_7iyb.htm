<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_table_privileges Catalog Stored Procedures</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_table_privileges_catalog_stored_procedures"></a>sp_table_privileges Catalog Stored Procedures </h2>
<p>
For SQL Server 6.5 information, see <a href="../../hydra/tsql/src/addsproc_5j8z.htm"><b>sp_table_privileges</b></a> in <i>What's New for SQL Server 6.5</i>.</p>
<p>
Returns privilege information for a single table in the current environment.</p>
<h4>Syntax</h4>
<p>
<b>sp_table_privileges</b> <i>table_name</i> [<b>,</b> <i>table_owner</i>] [<b>,</b> <i>table_qualifier</i>]</p>
<p>
where
<dl>
<dt>
<i>table_name</i></dt>
<dd>
Specifies the table used to return catalog information. The <i>table_name </i>can be a variable character length name with a maximum of 32 characters. Wildcard pattern matching is supported.</dd>
<dt>
<i>table_owner</i></dt>
<dd>
Specifies the table owner of the table used to return catalog information. The <i>table_owner </i>can be a variable character name with a maximum of 32 characters. Wildcard pattern matching is supported. If the <i>table_owner</i> is not specified, the default table visibility rules of the underlying DBMS apply.
<p>
In Microsoft SQL Server, if the current user owns a table with the specified name, that table's columns are returned. If the <i>table_owner </i>is not specified and the current user does not own a table with the specified <i>table_name</i>, this procedure will look for a table with the specified <i>table_name </i>owned by the database owner. If one exists, that table's columns are returned.
</dd>
<dt>
<i>table_qualifier</i></dt>
<dd>
Is the name of the table qualifier. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the database name. In some products, it represents the server name of the table's database environment.
</dd>
</dl>
<h4>Remarks</h4>
<p>
SQL Server does not support the ability to grant privileges through SELECT_GRANTABLE, INSERT_GRANTABLE, UPDATE_GRANTABLE, DELETE_GRANTABLE, and REFERENCES_GRANTABLE.</p>
<p>
The <b>sp_table_privileges</b> stored procedure is equivalent to <b>SQLTablePrivileges</b> in ODBC. The results returned are ordered by TABLE_QUALIFIER, TABLE_OWNER, TABLE_NAME, and PRIVILEGE.</p>
<p>
This is the results set:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=18%></th>
<th align=left width=55%></th>
</tr>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=18%></th>
<th align=left width=55%></th>
</tr>
<tr valign=top>
<th align=left width=27%>Column</th>
<th align=left width=18%>Datatype</th>
<th align=left width=55%>Description</th>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=18%></td>
<td width=55%></td>
</tr>
<tr valign=top>
<td width=27%>TABLE_QUALIFIER</td>
<td width=18%><i>varchar</i>(32)</td>
<td width=55%>Is the name of the table qualifier. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the database name. In some products, it represents the server name of the table's database environment. This field can be NULL.</td>
</tr>
<tr valign=top>
<td width=27%>TABLE_OWNER</td>
<td width=18%><i>varchar</i>(32)</td>
<td width=55%>Is the name of the table owner. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the name of the database user who created the table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=27%>TABLE_NAME</td>
<td width=18%><i>varchar</i>(32)</td>
<td width=55%>Is the name of the table. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the table name as listed in the <i>sysobjects</i> table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=27%>GRANTOR</td>
<td width=18%><i>varchar</i>(32)</td>
<td width=55%>Is the name of the database user who has granted permissions on this TABLE_NAME to the listed GRANTEE. In Microsoft SQL Server, this column will always be the same as the TABLE_OWNER. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=27%>GRANTEE</td>
<td width=18%><i>varchar</i>(32)</td>
<td width=55%>Is the name of the database user who has been granted permissions on this TABLE_NAME by the listed GRANTOR. In Microsoft SQL Server, this column will always include a database user from the <i>sysusers </i>table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=27%>PRIVILEGE</td>
<td width=18%><i>varchar</i>(32)</td>
<td width=55%>Is one of the available table privileges. Table privileges can be one of the following values (or other values supported by the data source when implementation is defined):<p>
SELECT&nbsp;&nbsp;&nbsp;&nbsp;The GRANTEE can retrieve data for one or more of the columns.</p>
<p>
INSERT&nbsp;&nbsp;&nbsp;&nbsp;The GRANTEE can provide data for new rows for one or more of the columns.</p>
<p>
UPDATE&nbsp;&nbsp;&nbsp;&nbsp;The GRANTEE can modify existing data for one or more of the columns.</p>
<p>
DELETE&nbsp;&nbsp;&nbsp;&nbsp;The GRANTEE can remove rows from the table.</p>
<p>
REFERENCES&nbsp;&nbsp;&nbsp;&nbsp;The GRANTEE can reference a column in a foreign table in a primary key/foreign key relationship. In SQL Server 6.0, primary key/foreign key relationships are defined with table constraints.</p>
<p>
The scope of action given to the GRANTEE by a given table privilege is data-source dependent. For example, the UPDATE privilege might permit the GRANTEE to update all columns in a table on one data source and only those columns for which the GRANTOR has UPDATE privilege on another data source.</p>
</td>
</tr>
<tr valign=top>
<td width=27%>IS_GRANTABLE</td>
<td width=18%><i>varchar</i>(3)</td>
<td width=55%>Indicates whether or not the GRANTEE is permitted to grant privileges to other users (often referred to as "grant with grant" permission). Can be YES, NO, or NULL. An unknown (or NULL) value refers to a data source where "grant with grant" is not applicable. In SQL Server 6.0, "grant with grant" permission is not supported.</td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
