<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_statistics Catalog Stored Procedures</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_statistics_catalog_stored_procedures"></a>sp_statistics Catalog Stored Procedures </h2>
<p>
Returns a list of all indexes on a specified table.</p>
<h4>Syntax</h4>
<p>
<b>sp_statistics</b> <i>table_name</i> [<b>,</b> <i>table_owner</i>] [<b>,</b> <i>table_qualifier</i>] <br>
[<b>,</b> <i>index_name</i>] [<b>,</b> <i>is_unique</i>]</p>
<p>
where
<dl>
<dt>
<i>table_name</i></dt>
<dd>
Specifies the table used to return catalog information. The <i>table_name </i>can be a variable character length name with a maximum of 32 characters. Wildcard pattern matching is not supported.</dd>
<dt>
<i>table_owner</i></dt>
<dd>
Specifies the table owner of the table used to return catalog information. The <i>table_owner </i>can be a variable character name with a maximum 32 characters. Wildcard pattern matching is not supported. If the <i>table_owner</i> is not specified, the default table visibility rules of the underlying DBMS apply.
<p>
In Microsoft SQL Server, if the current user owns a table with the specified name, that table's columns are returned. If the <i>table_owner </i>is not specified and the current user does not own a table with the specified <i>table_name</i>, this procedure will look for a table with the specified <i>table_name </i>owned by the database owner. If one exists, that table's columns are returned.
</dd>
<dt>
<i>table_qualifier</i></dt>
<dd>
Is the name of the table qualifier. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the database name. In some products, it represents the server name of the table's database environment.</dd>
<dt>
<i>index_name </i>(<i>varchar</i>(32))</dt>
<dd>
Is the index name. Wildcard pattern matching is not supported.</dd>
<dt>
<i>is_unique </i>(<i>char</i>(1))</dt>
<dd>
Identifies indexes to be returned. Enter Y if only unique indexes are to be returned.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The indexes in the results set appear in ascending order by the columns NON_UNIQUE, TYPE, INDEX_NAME, and SEQ_IN_INDEX.</p>
<p>
The index type <i>clustered</i> refers to an index in which table data is stored in the order of the index. This corresponds to SQL Server clustered indexes.</p>
<p>
The index type <i>hashed</i> accepts exact match or range searches, but pattern matching searches do not use the index.</p>
<p>
The <b>sp_statistics</b> stored procedure is equivalent to <b>SQLStatistics</b> in ODBC. The results returned are ordered by NON_UNIQUE, TYPE, INDEX_QUALIFIER, INDEX_NAME, and SEQ_IN_INDEX.</p>
<p>
This is the results set:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=21%></th>
<th align=left width=52%></th>
</tr>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=21%></th>
<th align=left width=52%></th>
</tr>
<tr valign=top>
<th align=left width=27%>Column</th>
<th align=left width=21%>Datatype</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=21%></td>
<td width=52%></td>
</tr>
<tr valign=top>
<td width=27%>TABLE_QUALIFIER</td>
<td width=21%><i>varchar</i>(32)</td>
<td width=52%>Is the name of the table qualifier. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the database name. In some products, it represents the server name of the table's database environment. This field can be NULL.</td>
</tr>
<tr valign=top>
<td width=27%>TABLE_OWNER</td>
<td width=21%><i>varchar</i>(32)</td>
<td width=52%>Is the name of the table owner. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the name of the database user who created the table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=27%>TABLE_NAME</td>
<td width=21%><i>varchar</i>(32)</td>
<td width=52%>Is the name of the table. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the table name as listed in the <i>sysobjects</i> table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=27%>NON_UNIQUE</td>
<td width=21%><i>smallint</i></td>
<td width=52%>NOT NULL. 0 means unique; 1 means non unique.</td>
</tr>
<tr valign=top>
<td width=27%>INDEX_QUALIFIER</td>
<td width=21%><i>varchar</i>(32)</td>
<td width=52%>Is the name of the index owner. Some DBMS products allow users other than the table owner to create indexes. In Microsoft SQL Server, this column will always be the same as TABLE_OWNER.</td>
</tr>
<tr valign=top>
<td width=27%>INDEX_NAME</td>
<td width=21%><i>varchar</i>(32)</td>
<td width=52%>Is the name of the index. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=27%>TYPE</td>
<td width=21%><i>smallint</i></td>
<td width=52%>This field will always return a value. SQL Server 6.0 returns 0, 1, or 3. Can be:<p>
0&nbsp;&nbsp;&nbsp;&nbsp;Statistics for a table<br>
1&nbsp;&nbsp;&nbsp;&nbsp;Clustered<br>
2&nbsp;&nbsp;&nbsp;&nbsp;Hashed<br>
3&nbsp;&nbsp;&nbsp;&nbsp;Other</p>
</td>
</tr>
<tr valign=top>
<td width=27%>SEQ_IN_INDEX</td>
<td width=21%><i>smallint</i></td>
<td width=52%>Is the position of the column within the index.</td>
</tr>
<tr valign=top>
<td width=27%>COLUMN_NAME</td>
<td width=21%><i>varchar</i>(32)</td>
<td width=52%>Is the name of the column, for each column of the TABLE_NAME returned. In Microsoft SQL Server, this column represents the column name as listed in the <i>syscolumns</i> table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=27%>COLLATION</td>
<td width=21%><i>char</i>(1)</td>
<td width=52%>Is the order used in collation. SQL Server 6.0 always returns A. Can be:<p>
A          Ascending<br>
D          Descending<br>
NULL  Not applicable</p>
</td>
</tr>
<tr valign=top>
<td width=27%>CARDINALITY</td>
<td width=21%><i>int</i></td>
<td width=52%>Is the number of rows in the table or unique values in the index.</td>
</tr>
<tr valign=top>
<td width=27%>PAGES</td>
<td width=21%><i>int</i></td>
<td width=52%>Is the number of pages to store the index or table.</td>
</tr>
<tr valign=top>
<td width=27%>FILTER_CONDITION</td>
<td width=21%><i>varchar(128)</i></td>
<td width=52%>SQL Server 6.0 does not return a value.</td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
