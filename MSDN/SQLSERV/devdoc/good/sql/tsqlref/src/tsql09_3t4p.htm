<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Text and Image Functions</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_text_and_image_functions_tsql09"></a>Text and Image Functions</h2>
<p>
Text and image functions return values commonly needed for operations on <i>text</i> and <i>image</i> data only. <i>Text</i> and <i>image</i> built-in function names are not keywords.</p>
<h4>Syntax</h4>
<p>
<i>function_name</i><b>(</b><i>parameters</i><b>)</b></p>
<p>
where
<dl>
<dt>
<i>function_name</i></dt>
<dd>
Specifies a <i>text </i>or <i>image </i>function. 
<p>
These are the <i>text </i>and <i>image </i>functions:

<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=18%></th>
<th align=left width=39%></th>
<th align=left width=43%></th>
</tr>
<tr valign=top>
<th align=left width=18%></th>
<th align=left width=39%></th>
<th align=left width=43%></th>
</tr>
<tr valign=top>
<th align=left width=18%>Function</th>
<th align=left width=39%>Parameters</th>
<th align=left width=43%>Result</th>
</tr>
<tr valign=top>
<td width=18%>TEXTPTR</td>
<td width=39%><b>(</b><i>column_name</i><b>)</b></td>
<td width=43%>The text-pointer value in <i>varbinary</i>&nbsp;format. The text pointer is checked to ensure that it points to the first text page.</td>
</tr>
<tr valign=top>
<td width=18%>TEXTVALID</td>
<td width=39%><b>('</b><i>table_name</i><b>.</b><i>column_name</i><b>',</b> <i>text_ ptr</i><b>)</b> </td>
<td width=43%>Checks whether a given text pointer is valid. Returns 1 if the pointer is valid and 0 if the pointer is invalid. Note that the identifier for the <i>text</i> column must include the table name.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
If a <i>text</i> or <i>image</i> column has not been initialized by an INSERT or UPDATE statement, TEXTPTR returns a null pointer. Use TEXTVALID to check whether a text pointer exists. You cannot use UPDATETEXT, WRITETEXT, or READTEXT without a valid text pointer.</p>
<p>
In addition to these specific <i>text </i>and <i>image </i>functions, the following functions and statement are also useful with <i>text </i>and <i>image </i>data:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=39%></th>
<th align=left width=61%></th>
</tr>
<tr valign=top>
<th align=left width=39%></th>
<th align=left width=61%></th>
</tr>
<tr valign=top>
<th align=left width=39%>Function or statement</th>
<th align=left width=61%>Description</th>
</tr>
<tr valign=top>
<td width=39%>PATINDEX<b>('</b><i>%pattern%</i><b>',</b> <br>
<i>expression</i><b>)</b></td>
<td width=61%>The character position of a given character string in <i>text</i> columns. For details, see "String Functions" earlier in this topic.</td>
</tr>
<tr valign=top>
<td width=39%>DATALENGTH<b>(</b><i>expression</i><b>)</b></td>
<td width=61%>The length of data in <i>text</i> and <i>image</i> columns. For details, see "System Functions," earlier in this topic.</td>
</tr>
<tr valign=top>
<td width=39%>SET TEXTSIZE</td>
<td width=61%>The limit, in bytes, of the <i>text</i> or <i>image</i> data to be returned with a SELECT statement. For details, see the SET statement.</td>
</tr>
</table><br>
<h4>Examples</h4>
<h5>A.&nbsp;&nbsp;&nbsp;&nbsp;TEXTPTR Function</h5>
<p>
This example uses the TEXTPTR function to locate the <i>image </i>column <i>logo </i>associated with New Moon Books in the <i>pub_info </i>table of the <i>pubs </i>database. The text pointer is put into a local variable <i>@ptrval</i>.</p>
<pre>DECLARE @ptrval varbinary(16)
SELECT @ptrval = TEXTPTR(logo) 
    FROM pub_info pr, publishers p
        WHERE p.pub_id = pr.pub_id 
        AND p.pub_name = 'New Moon Books'
</pre>
<h5>B.&nbsp;&nbsp;&nbsp;&nbsp;Return <i>text </i>Data</h5>
<p>
This example selects the <i>pub_id </i>column and the 16-byte text pointer of the <i>pr_info </i>column from the <i>pub_info </i>table.</p>
<pre>SELECT pub_id, TEXTPTR(pr_info) FROM pub_info
</pre>
<p>
To return the first 255 bytes of text:</p>
<pre>SELECT pub_id, pr_info FROM pub_info
</pre>
<h5>C.&nbsp;&nbsp;&nbsp;&nbsp;TEXTVALID Function</h5>
<p>
This example reports whether a valid text pointer exists for each value in the <i>logo</i> column of the <i>pub_info </i>table.</p>
<pre>SELECT pub_id, 'Valid (if 1) Text data' 
                = TEXTVALID ('pub_info.logo', TEXTPTR(logo)) 
    FROM pub_info</pre>
<p>&nbsp;</p></body>
</HTML>
