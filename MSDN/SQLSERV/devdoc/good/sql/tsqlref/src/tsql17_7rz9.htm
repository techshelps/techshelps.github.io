<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_updatetask SQL Executive Stored Procedure</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_updatetask_sql_executive_stored_procedure"></a>sp_updatetask SQL Executive Stored Procedure </h2>
<p>
Updates information about a task.</p>
<h4>Syntax</h4>
<p>
<b>sp_updatetask</b> {<i>currentname</i> | <i>id</i>} [<b>, </b><i>name</i>] [<b>, </b><i>subsystem</i>] [<b>, </b><i>server</i>] [<b>, </b><i>username</i>] [<b>, </b><i>databasename</i>] [<b>, </b><i>enabled</i>] [<b>, </b><i>freqtype</i>] [<b>, </b><i>freqinterval</i>] [<b>, </b><i>freqsubtype</i>] [<b>, </b><i>freqsubinterval</i>] [<b>, </b><i>freqrelativeinterval</i>] [<b>, </b><i>freqrecurrencefactor</i>] [<b>, </b><i>activestartdate</i>] [<b>, </b><i>activeenddate</i>] [<b>, </b><i>activestarttimeofday</i>] [<b>, </b><i>activeendtimeofday</i>] [<b>, </b><i>nextrundate</i>] [<b>, </b><i>nextruntime</i>] [<b>, </b><i>runpriority</i>] [<b>, </b><i>emailoperatorname</i>] [<b>, </b><i>retryattempts</i>] [<b>, </b><i>retrydelay</i>] [<b>, </b><i>command</i>] [<b>, </b><i>loghistcompletionlevel</i>] [<b>, </b><i>emailcompletionlevel</i>] [<b>, </b><i>description</i>] [<b>, </b><i>tagadditionalinfo</i>] [<b>, </b><i>tagobjectid</i>] [<b>, </b><i>tagobjecttype</i>] </p>
<p>
where
<dl>
<dt>
<i>currentname</i> | <i>id</i></dt>
<dd>
Specifies which task to update.</dd>
<dt>
<i>name</i> </dt>
<dd>
Specifies a new name for the task.</dd>
<dt>
<i>subsystem</i></dt>
<dd>
For replication, specifies which subsystem to use. Can be <b>Distribution</b>, <b>LogReader</b>, or <b>Sync</b>. These must be typed using the capitalization (case) shown.</dd>
<dt>
<i>server</i></dt>
<dd>
Specifies the name of server on which to execute this task.</dd>
<dt>
<i>username</i></dt>
<dd>
Specifies the database user to impersonate when creating this task. Only the system administrator or the database owner can specify this parameter.</dd>
<dt>
<i>databasename</i></dt>
<dd>
Specifies the database to use when executing the task.</dd>
<dt>
<i>enabled</i></dt>
<dd>
Specifies the status of scheduled tasks: 1 indicates enabled (tasks will be scheduled and run), 0 indicates disabled.</dd>
<dt>
<i>freqtype</i></dt>
<dd>
Specifies the frequency with which to schedule this task:<br>
1One Time<br>
2On Demand (the default)<br>
4Daily<br>
8Weekly<br>
16Monthly<br>
32Monthly Relative<br>
64Autostart<br>
124Recurring</dd>
<dt>
<i>freqinterval</i></dt>
<dd>
Specifies the interval for <i>freqtype</i>.</dd>
<dt>
<i>freqsubtype</i></dt>
<dd>
Specifies how often to reschedule during the defined period:<br>
1  Once (the default)<br>
2  Second<br>
4  Minute<br>
8  Hour</dd>
<dt>
<i>freqsubinterval</i></dt>
<dd>
Specifies the value for <i>freqsubtype</i> when the subtype is set to second, minute, or hour.</dd>
<dt>
<i>freqrelativeinterval</i></dt>
<dd>
Is the value used when <i>freqtype</i> is set to 32 (monthly relative). Indicates the first, second, third, fourth, or last day of the month.
<p>
1First (the default)<br>
2Second<br>
4Third<br>
8Fourth<br>
16Last
</dd>
<dt>
<i>freqrecurrencefactor</i></dt>
<dd>
Specifies how often the task should re-occur during the defined <i>freqtype</i>.</dd>
<dt>
<i>activestartdate</i></dt>
<dd>
Specifies the date when this task will be scheduled initially. Formatted as YYYYMMDD. The default is 0.</dd>
<dt>
<i>activeenddate</i></dt>
<dd>
Specifies the date when this task will stop being scheduled. Formatted as YYYYMMDD. The default is 0.</dd>
<dt>
<i>activestarttimeofday</i></dt>
<dd>
Specifies the time this task will be scheduled initially. Formatted as HHMMSS. The default is 0.</dd>
<dt>
<i>activeendtimeofday</i></dt>
<dd>
Specifies when this task will stop being scheduled. Formatted as HHMMSS. The default is 0.</dd>
<dt>
<i>nextrundate</i></dt>
<dd>
Specifies the date the task will be scheduled. If the current date is greater than <i>activestartdate</i>, specifies the next date that the task will be scheduled: 0 indicates that the SQL Executive will calculate the next appropriate date. Formatted as YYYYMMDD. The default is 0.</dd>
<dt>
<i>nextruntime</i></dt>
<dd>
Specifies the time the task will be scheduled. If the current time is greater than the <i>activestarttime</i>, specifies the next time that the task will be scheduled: 0 indicates that the SQL Executive will calculate the next appropriate time. Formatted as HHMMSS. The default is 0.</dd>
<dt>
<i>runpriority</i></dt>
<dd>
Specifies the thread priority level at which the subsystem event thread runs. The default is 0.</dd>
<dt>
<i>emailoperatorname</i></dt>
<dd>
Specifies the e-mail name of the operator who will receive notifications. </dd>
<dt>
<i>retryattempts</i></dt>
<dd>
Specifies the number of times the SQL Executive retries before issuing an error. The default is 0.</dd>
<dt>
<i>retrydelay</i></dt>
<dd>
Specifies the SQL Executive the SQL Executive waits before retrying the task. The default is 1.</dd>
<dt>
<i>command</i></dt>
<dd>
Specifies a command string (based on the valid specified <i>subsystem</i> commands) to be passed to the subsystem. If the specified subsystem is TSQL, the command cannot consist of more than one batch. The batch separator GO is not supported. The default is NULL.</dd>
<dt>
<i>loghistcompletionlevel</i></dt>
<dd>
Specifies the level of events to capture in the event log, 1 captures all successfully run events, 2 captures only failed events.</dd>
<dt>
<i>emailcompletionlevel</i> </dt>
<dd>
Specifies the level of events to capture via e-mail, 1 captures all successfully run events, 2 captures only failed events. The default is 2.</dd>
<dt>
<i>description</i></dt>
<dd>
Is text describing the task.</dd>
<dt>
<i>tagadditionalinfo</i> </dt>
<dd>
Reserved for future use.</dd>
<dt>
<i>tagobjectid</i></dt>
<dd>
Reserved for future use.</dd>
<dt>
<i>tagobjecttype</i></dt>
<dd>
Reserved for future use.
</dd>
</dl>
<h4>Remarks</h4>
<p>
All specified (non-NULL) parameters are updated. To clear a string, use <b>'</b> <b>'</b>.</p>
<h4>Examples</h4>
<p>
This example renames the <i>auth_table_sync</i> task to <i>authors_sync</i>.</p>
<pre>sp_updatetask 'auth_table_sync', @name = 'authors_sync'
</pre>
<h4>Permission</h4>
<p>
Only the system administrator can use this procedure.</p>
<h4>Table Used</h4>
<p>
<i>systasks</i></p>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%></td>
<td width=52%></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql17_01d1.htm"><b>sp_droptask</b></a></td>
<td width=52%><a href="tsql17_1qw5.htm"><b>sp_addtask</b></a></td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
