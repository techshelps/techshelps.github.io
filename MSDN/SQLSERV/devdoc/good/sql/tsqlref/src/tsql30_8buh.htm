<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>isql Command-line Utility</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_isql_command.2d.line_utility"></a>isql Command-line Utility</h2>
<p>
For SQL Server 6.5 information, see <a href="../../hydra/tsql/src/addnfeat_6l7o.htm">ISQLPASSWORD</a> in <i>What's New for SQL Server 6.5</i>.</p>
<p>
Allows you to enter SQL statements and system procedures.</p>
<h4>Syntax</h4>
<p>
<b>isql</b> <b>/U</b> <i>login_id</i> [<b>/e</b>] [<b>/E</b>] [<b>/p</b>] [<b>/n</b>] [<b>/d</b> <i>dbname</i>] [<b>/q "</b><i>query</i><b>"</b>] [<b>/Q</b> <b>"</b><i>query</i><b>"</b>]<br>
[<b>/c</b> <i>cmdend</i>] [<b>/h</b> <i>headers</i>] [<b>/w</b> <i>columnwidth</i>] [<b>/s</b> <i>colseparator</i>] <br>
[<b>/t</b> <i>timeout</i>] [<b>/m</b> <i>errorlevel</i>] [<b>/L</b>] [<b>/?</b>] [/<b>r</b> {<b>0</b> | <b>1</b>}]<br>
[<b>/H</b> <i>wksta_name</i>] [<b>/P</b> <i>password</i>] <br>
[<b>/S</b> <i>servername</i>] [<b>/i</b> <i>inputfile</i>] [<b>/o</b> <i>outputfile</i>] [<b>/a</b> <i>packet_size</i>]</p>
<p>
where
<dl>
<dt>
<b>/U </b><i>login_id</i></dt>
<dd>
Is the user login ID. Login IDs are case-sensitive.</dd>
<dt>
<b>/e</b></dt>
<dd>
Echoes input.</dd>
<dt>
<b>/E</b></dt>
<dd>
Uses a trusted connection instead of requesting a password.</dd>
<dt>
<b>/p</b></dt>
<dd>
Prints performance statistics.</dd>
<dt>
<b>/n</b></dt>
<dd>
Removes numbering and the prompt symbol (&gt;) from input lines.</dd>
<dt>
<b>/d </b><i>dbname</i></dt>
<dd>
Issues a USE <i>dbname</i> statement when <b>isql </b>is started.</dd>
<dt>
<b>/q "</b><i>query</i><b>"</b></dt>
<dd>
Executes a query when <b>isql</b> starts. (Note, the query statement should not include GO). If you issue a query from a batch file, you can use %variables. Environment %variables% also work. For example:
<p>
SET table = sysobjects<br>
isql /q "Select * from %table%"

<p>
Use double quotation marks around the query and single quotation marks around anything embedded in the query.
</dd>
<dt>
<b>/Q</b> <b>"</b><i>query</i><b>"</b></dt>
<dd>
Executes a query and immediately exits <b>isql</b>. Use double quotation marks around the query and single quotation marks around anything embedded in the query.</dd>
<dt>
<b>/c </b><i>cmdend</i></dt>
<dd>
Specifies the command terminator. By default, commands are terminated and sent to SQL Server by entering GO on a line by itself. When you reset the command terminator, do not use SQL reserved words or characters that have special meaning to the operating system, whether preceded by a backslash or not.</dd>
<dt>
<b>/h </b><i>headers</i></dt>
<dd>
Specifies the number of rows to print between column headings. The default is to print headings only once for each set of query results. Use -<b>1</b> to specify that no headers will be printed. If using -1, there must be no space between the parameter and the setting (/<b>h</b>-<b>1</b>, not <b>/h </b>-1).</dd>
<dt>
<b>/w </b><i>columnwidth</i></dt>
<dd>
Allows the user to set the screen width for output. The default is 80 characters. When an output line has reached its maximum screen width, it is broken into multiple lines.</dd>
<dt>
<b>/s </b><i>colseparator</i></dt>
<dd>
Specifies the column-separator character, which is blank by default. To use characters that have special meaning to the operating system (for example, | ; &amp; &lt; &gt;), precede the character with a backslash (\).</dd>
<dt>
<b>/t </b><i>timeout</i></dt>
<dd>
Specifies the number of seconds before a command times out. If no <i>timeout</i> is specified, a command runs indefinitely; the default timeout for logging in to <b>isql</b> is 8 seconds.</dd>
<dt>
<b>/m </b><i>errorlevel</i></dt>
<dd>
Customizes the display of error messages. The message number, state, and error level are displayed for errors of the specified severity level or higher. Nothing is displayed for errors of levels lower than the specified level. Use -<b>1</b> to specify that all headers are returned with messages, even informational messages. If using -1, there must be no space between the parameter and the setting (/<b>m</b>-<b>1</b>, not <b>/m</b> -1).</dd>
<dt>
<b>/L</b></dt>
<dd>
Lists the locally configured servers and the names of the servers broadcasting on the network.</dd>
<dt>
<b>/?</b></dt>
<dd>
Displays the syntax summary of <b>isql</b> switches.</dd>
<dt>
<b>/r </b>{<b>0</b> | <b>1</b>}</dt>
<dd>
Redirects message output to <b>stderr</b>. If you don't specify a parameter, or if you specify 0, only error-level message severity (severity 17 or higher) is redirected. If you specify 1, all message output (including "print") is redirected.</dd>
<dt>
<b>/H </b><i>wksta_name</i></dt>
<dd>
Is a workstation name, changing the value in the dynamic system table <i>sysprocesses</i>, if the user logs in from a computer different from the usual login computer. If no workstation name is specified, the current computer name is assumed.</dd>
<dt>
<b>/P </b><i>password</i></dt>
<dd>
Is a user-specified password. If the <b>/P</b> option is not used, <b>isql</b> prompts for a password. If the <b>/P</b> option is used at the end of the command line without any password, <b>isql</b> uses the default password NULL. Passwords are case-sensitive.</dd>
<dt>
<b>/S </b><i>servername</i></dt>
<dd>
Specifies which SQL Server to connect to. The <i>servername</i> is the name of the server computer on the network. This option is required if you are executing <b>isql</b> from a remote computer on the network.</dd>
<dt>
<b>/i </b><i>inputfile</i></dt>
<dd>
Identifies the file that contains a batch of SQL statements or stored procedures. The less-than symbol (<b>&lt;</b>) can be used in place of <b>/i</b>.</dd>
<dt>
<b>/o </b><i>outputfile</i></dt>
<dd>
Identifies the file that receives output from <b>isql</b>. The greater-than symbol (<b>&gt;</b>) can be used in place of <b>/o</b>.</dd>
<dt>
<b>/a</b> <i>packet_size</i></dt>
<dd>
Allows you to request a different size packet. The valid values for <i>packet_size</i> are 512 through 65535. The default value for the Windows NT - based version of <b>isql</b> is 8192; otherwise, the default value is 512 for MS-DOS, although larger sizes can be requested with that version as well. Increased packet size can enhance performance on larger script execution where the amount of SQL statements between GO statements is substantial. Microsoft testing indicates that 8192 is typically the fastest setting for bulk copy operations. A larger packet size can be requested, but will default to 512 if the request cannot be granted.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The <b>isql</b> utility is started directly from the operating system with the case-sensitive options listed here. Once started, <b>isql</b> accepts SQL commands and sends them to SQL Server interactively. The results are formatted and printed on the standard output device (the screen). Use QUIT or EXIT to exit from <b>isql</b>.</p>
<p>
If you do not specify a username when you start <b>isql</b>, SQL Server checks for the environment variables ¾ for example, <b>isqluser=(</b><i>user</i><b>)</b> or <b>isqlserver=(</b><i>server</i><b>)</b>, and uses those. If no environment variables are set, the workstation username is used. If you do not specify a server, the name of the workstation is used.</p>
<p>
If neither the <b>/U</b> or <b>/P</b> options are used, SQL Server uses the currently logged in user account and will not prompt for a password. This is useful when using integrated or mixed security. For details about security, see the <i>Microsoft SQL Server Administrator's Companion</i>.</p>
<p>
In addition to using Transact-SQL statements within <b>isql</b>, use the following commands:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=21%></th>
<th align=left width=79%></th>
</tr>
<tr valign=top>
<th align=left width=21%></th>
<th align=left width=79%></th>
</tr>
<tr valign=top>
<th align=left width=21%>Command</th>
<th align=left width=79%>Description</th>
</tr>
<tr valign=top>
<td width=21%>GO</td>
<td width=79%>Executes a command.</td>
</tr>
<tr valign=top>
<td width=21%>RESET</td>
<td width=79%>Clears any statements you have entered.</td>
</tr>
<tr valign=top>
<td width=21%>ED</td>
<td width=79%>Calls the editor.</td>
</tr>
<tr valign=top>
<td width=21%><b>!!</b> <i>command</i></td>
<td width=79%>Executes an operating-system command.</td>
</tr>
<tr valign=top>
<td width=21%>QUIT or EXIT( )</td>
<td width=79%>Exits from <b>isql</b>.</td>
</tr>
<tr valign=top>
<td width=21%>ctrl+c</td>
<td width=79%>Terminates a query without exiting from <b>isql</b>.</td>
</tr>
</table><br>
<p>
The command terminators, GO (by default), RESET, ED, <b>!!</b>, EXIT, QUIT, and CTRL+C, are recognized only if they appear at the beginning of a line, immediately following the <b>isql</b> prompt. Anything entered on the same line after these keywords is disregarded by <b>isql</b>.</p>
<p>
Terminate a command by typing a line beginning with a command terminator. You can follow the command terminator with an integer to specify how many times the command should be run. For example, to execute this command 100 times, type:</p>
<pre>SELECT x = 1
go 100</pre>
<p>
The results are printed once, at the end of execution.</p>
<p>
With <b>isql</b>, there is a limit of 1000 characters per line. Large statements should be spread across multiple lines.</p>
<p>
The user can call an editor on the current query buffer by typing ED as the first word on a line. Operating-system commands can also be executed by starting a line with two exclamation points (<b>!!</b>) followed by the command. The editor is defined in the EDITOR environment variable. The default editor is "edit" for MS-DOS and Windows NT. You can specify a different editor by setting the EDITOR environment variable. For example, to make the default editor Notepad, at the operating-system prompt, type:</p>
<pre>SET EDITOR=notepad</pre>
<p>
The command recall facilities of DOSKEY can be used to recall and modify previously entered <b>isql</b> statements on a Windows NT - based computer. The existing query buffer can be cleared by typing RESET on a line by itself. It causes any pending input to be discarded.</p>
<p>
When running stored procedures, <b>isql</b> prints a blank line between each set of results in a batch. In addition, the "0 rows affected" message does not appear when it doesn't apply to the statement executed.</p>
<p>
To use <b>isql</b> interactively, type the <b>isql</b> command (and any of the options) at the operating-system prompt.</p>
<p>
You can read in a file containing a query (such as STORES.QRY) for execution by <b>isql</b> by typing a command similar to this:</p>
<pre>isql /U alma /P /i stores.qry
</pre>
<p>
The file must include a command terminator(s). The results are displayed on the user's workstation.</p>
<p>
You can read in a file containing a query (such as TITLES.QRY) and direct the results to another file by typing a command similar to this:</p>
<pre>isql /U alma /P /i titles.qry /o titles.res
</pre>
<p>
When using <b>isql</b> interactively, you can read an operating-system file into the command buffer with <b>:r</b><i> filename</i>. Do not include a command terminator in the file; enter the terminator interactively once you have finished editing.</p>
<p>
You can include comments in a Transact-SQL statement submitted to SQL Server by <b>isql</b>. Two types of commenting styles are allowed. For more information, see the Comments topic.</p>
<p>
For example:</p>
<pre>SELECT au_lname, au_fname
 -- Retrieve authors' last and first names.
    FROM authors a, titles t, titleauthor ta
        WHERE a.au_id = ta.au_id
        AND t.title_id = ta.title_id
/* This is a three-way join that links authors
** to the books they have written. */
</pre>
<p>
<b>Note</b>  Do not include a GO command within a comment. A GO command within a comment produces an error message.</p>
<p>
You can return the result of an integer SELECT as the return value from <b>isql</b>. The first column of the first result row is converted to a 4-byte integer (long). MS-DOS passes the low byte to the parent process or operating-system error level. Windows NT passes the entire 4-byte integer. The syntax is:</p>
<p>
EXIT<b>(</b><i>query</i><b>)</b></p>
<p>
For example:</p>
<pre>EXIT(SELECT @@rowcount)

EXIT(SELECT 5)
</pre>
<p>
You can also include the exit parameter as part of a batch file. For example:</p>
<pre>isql /Q "EXIT(SELECT COUNT(*) FROM '%1')"
</pre>
<p>
The <b>isql</b> utility passes everything between the parentheses <b>( )</b> to the server exactly as entered. The EXIT<b>( )</b> statement can span lines. If a stored system procedure selects a set and returns a value, only the selection is returned. The EXIT<b>(</b> <b>) </b>statement with nothing between the parentheses executes everything preceding it in the batch and then exits with no return value. </p>
<p>
There are four exit formats:
<ul>
<li>
EXIT<p>
Does not execute the batch; quits immediately and returns no value.
</li>
<li>
EXIT<b>(</b> <b>)</b><p>
Executes the batch, and then quits and returns no value.
</li>
<li>
EXIT<b>(</b><i>query</i><b>)</b><p>
Executes the batch, including the query, and then quits, returning the results of the query.
</li>
<li>
Using the RAISERROR statement with a severity of 127. If RAISERROR is used within an <b>isql</b> script and a severity of 127 is raised, <b>isql</b> will terminate and return the message ID back to the client. For example,<pre>RAISERROR(50001, 10, 127)</pre>
<p>
This error will cause the <b>isql</b> script to terminate and the message ID 50001 will be returned to the to the client.
</li>
</ul>
<p>
The return values - 1 to - 99 are reserved by SQL Server; <b>isql</b> defines the following values:</p>
<p>
- 100: Error encountered prior to selecting return value.</p>
<p>
- 101: No rows found when selecting return value.</p>
<p>
- 102: Conversion error when selecting return value.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
