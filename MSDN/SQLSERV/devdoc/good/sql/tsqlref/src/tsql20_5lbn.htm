<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_dbinstall System Stored Procedures</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_dbinstall_removable_media_stored_procedures"></a>sp_dbinstall System Stored Procedure </h2>
<p>
Installs a database and its devices. It must be run once for each device of the database being installed. This system stored procedure copies the system device to the hard disk (placing the system catalog tables and the transaction log on read/write media). You can leave the data device on the distribution media (usually a CD), or you can copy it to the hard disk (but it remains read-only).</p>
<h4>Syntax</h4>
<p>
<b>sp_dbinstall</b> <i>database</i><b>,</b> <i>logical_dev_name</i><b>,</b> <b>'</b><i>physical_dev_name</i><b>',</b> <i>size<b>,</b><br>
</i><b>'</b><i>devtype</i><b>'</b> [<b>,'</b><i>location</i><b>'</b>]<b> </b></p>
<p>
where
<dl>
<dt>
<i>database</i></dt>
<dd>
Is the name of the removable media database being installed. Any valid database name conforming to the SQL Server rules for identifiers can be used. You are not required to enter the database name that was originally used for this database during development.</dd>
<dt>
<i>logical_dev_name</i></dt>
<dd>
Is the logical name of the device being installed.</dd>
<dt>
<i>physical_dev_name</i></dt>
<dd>
Is the physical name, including the fully qualified path, of the device being installed. The path entered here is the path to the device on the distribution media.</dd>
<dt>
<i>size</i></dt>
<dd>
Is the size, in 1-MB blocks, of the device being installed.</dd>
<dt>
<i>devtype</i></dt>
<dd>
Indicates the type of device being installed:
<dl>
<dt>
<b>SYSTEM</b></dt>
<dd>
Indicates that the device being installed contains the system catalog tables and the transaction log. The system device must be installed before the data device.</dd>
<dt>
<b>DATA</b></dt>
<dd>
Indicates that the device being installed contains data tables. The data device must be installed after the system device. Note that even if a data device will be left on the distribution media, it must be installed using this system stored procedure.
<p>
If the database contains more than one data device, you must run this system stored procedure once for each device. 
</dd>
</dl>
</dd>
<dt>
<i>location</i></dt>
<dd>
Indicates the destination location to which the device will be copied from the distribution media. This is usually a destination on the computer's local hard disk. The location is a fully qualified filename, including the drive, directory, and filename of the device. The referenced directories must already exist (<b>sp_dbinstall</b> will not create them).
<p>
A <i>location</i> is required for the system device. It is optional for a data device (since a data device can be left on the distribution media).

</dd>
</dl>
<h4>Remarks</h4>
<p>
<b>Important</b>  When using <b>sp_dbinstall</b>, all of a database's devices must be installed.</p>
<p>
The information required by the <b>sp_dbinstall</b> parameters is provided when the database is verified using <b>sp_certify_removable</b>.</p>
<p>
When a database is installed using <b>sp_dbinstall</b>, it is set to offline. Before it can be used it must be placed online by using <b>sp_dboption</b>. After the database has been installed using <b>sp_dbinstall</b> and brought online using <b>sp_dboption</b>, it can be configured to suit local requirements. Users can be added, permissions can be granted, and stored procedures and views can be created. However, after the database is installed, do not attempt to perform inserts, updates, or deletes against the read-only data in the data tables.</p>
<p>
Before the database can be used (that is, set online by using <b>sp_dboption</b>) all of its devices must be available. This means that if a database¾because of size¾has been distributed on several CDs with a different data device on each CD, and if the computer is equipped with only one CD drive, then as each device is installed <b>sp_dbinstall</b> must be provided a <i>location</i> parameter for all but one of the devices, so that all but one of the data devices are copied off the distribution CDs onto the computer's local hard disk. If this is done, only one CD will need to be in the CD drive when the database is used. To eliminate all need for a CD when using the database, all the data devices can be copied. </p>
<p>
As an advanced option, if the data device has been moved to read/write media, it can be made read/write by running <b>sp_addsegment</b> against the device and using <b>sp_devoption</b> to set the <b>readonly</b> setting to <b>false</b> for that device. </p>
<p>
You can also use this system stored procedure to install databases and devices from non-removable media.</p>
<h4>Example</h4>
<p>
This example installs the removable media database <i>inventory</i> from the distribution CD, which is located in the computer's CD-ROM drive, drive E. The system device containing the system catalog tables and the transaction log is copied to the computer's hard disk and the data device is left on the distribution media.</p>
<pre>sp_dbinstall inventory,invsys,'e:\invsys.dat',2,'SYSTEM',
   'c:\sql60\data\invsys.dat'
EXEC sp_dbinstall inventory,invdata,'e:\invdata.dat',10,'DATA'
</pre>
<h4>Permission</h4>
<p>
Only the system administrator can use this stored procedure.</p>
<h4>Tables Used</h4>
<p>
<i>sysdatabases, sysdevices</i>, <i>sysusages</i></p>
<h4>See also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%><a href="tsql18_3tr9.htm"><b>sp_certify_removable</b></a></td>
<td width=52%><a href="tsql20_1tnp.htm"><b>sp_dboption</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="tsql20_0u05.htm"><b>sp_create_removable</b></a></td>
<td width=52%><a href="tsql20_7tk5.htm"><b>sp_dbremove</b></a></td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
