<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_column_privileges Catalog Stored Procedure</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_column_privileges_catalog_stored_procedure"></a>sp_column_privileges Catalog Stored Procedure </h2>
<p>
For SQL Server 6.5 information, see <a href="../../hydra/tsql/src/addsproc_8dv7.htm"><b>sp_column_privileges</b></a> in <i>What's New for SQL Server 6.5</i>.</p>
<p>
Returns column privilege information for a single table in the current environment.</p>
<h4>Syntax</h4>
<p>
<b>sp_column_privileges</b> <i>table_name</i> [<b>,</b> <i>table_owner</i>] [<b>,</b> <i>table_qualifier</i>] <br>
[<b>,</b> <i>column_name</i>]</p>
<p>
where
<dl>
<dt>
<i>table_name</i></dt>
<dd>
Specifies the table used to return catalog information. The <i>table_name </i>can be a variable-length character name with a maximum of 32 characters. Wildcard pattern matching is not supported.</dd>
<dt>
<i>table_owner</i></dt>
<dd>
Specifies the table owner of the table used to return catalog information. The <i>table_owner </i>can be a variable-length character name with a maximum 32 characters. Wildcard pattern matching is not supported. If the <i>table_owner</i> is not specified, the default table visibility rules of the underlying database management system (DBMS) apply.
<p>
In Microsoft SQL Server, if the current user owns a table with the specified name, that table's columns are returned. If the <i>table_owner </i>is not specified and the current user does not own a table with the specified <i>table_name</i>, this procedure will look for a table with the specified <i>table_name </i>owned by the database owner. If one exists, that table's columns are returned.
</dd>
<dt>
<i>table_qualifier</i></dt>
<dd>
Is the name of the table qualifier. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the database name. In some products, it represents the server name of the table's database environment.</dd>
<dt>
<i>column_name</i></dt>
<dd>
Specifies a single column and is used when only one column of catalog information is desired. If <i>column_name </i>is not specified, all columns will be returned. In Microsoft SQL Server, this <i>column_name </i>represents the column name as listed in the <i>syscolumns</i> table. The value specified can include wildcard characters using the underlying DBMS's wildcard matching patterns. For maximum interoperability, the gateway client should assume only ANSI-standard SQL pattern matching (the % and _ wildcard characters).
</dd>
</dl>
<h4>Remarks</h4>
<p>
With SQL Server, privileges are given with the GRANT statement and taken away by the REVOKE statement.</p>
<p>
The <b>sp_column_privileges</b> catalog stored procedure is equivalent to <b>SQLColumnPrivileges</b> in ODBC. The results returned are order by TABLE_QUALIFIER, TABLE_OWNER, TABLE_NAME, COLUMN_NAME, and PRIVILEGE.</p>
<p>
This is the results set:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=26%></th>
<th align=left width=22%></th>
<th align=left width=52%></th>
</tr>
<tr valign=top>
<th align=left width=26%></th>
<th align=left width=22%></th>
<th align=left width=52%></th>
</tr>
<tr valign=top>
<th align=left width=26%>Column</th>
<th align=left width=22%>Datatype</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=26%></td>
<td width=22%></td>
<td width=52%></td>
</tr>
<tr valign=top>
<td width=26%>TABLE_QUALIFIER</td>
<td width=22%><i>varchar</i>(32)</td>
<td width=52%>Is the name of the table qualifier. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the database name. In some products, it represents the server name of the table's database environment. This field can be NULL.</td>
</tr>
<tr valign=top>
<td width=26%>TABLE_OWNER</td>
<td width=22%><i>varchar</i>(32)</td>
<td width=52%>Is the name of the table owner. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the name of the database user who created the table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=26%>TABLE_NAME</td>
<td width=22%><i>varchar</i>(32)</td>
<td width=52%>Is the name of the table. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the table name as listed in the <i>sysobjects</i> table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=26%>COLUMN_NAME</td>
<td width=22%><i>varchar</i>(32)</td>
<td width=52%>Is the name of the column, for each column of the TABLE_NAME returned. In Microsoft SQL Server, this column represents the column name as listed in the <i>syscolumns</i> table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=26%>GRANTOR</td>
<td width=22%><i>varchar</i>(32)</td>
<td width=52%>Is the name of the database user who has granted permissions on this COLUMN_NAME to the listed GRANTEE. In Microsoft SQL Server, this column will always be the same as the TABLE_OWNER. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=26%>GRANTEE</td>
<td width=22%><i>varchar</i>(32)</td>
<td width=52%>Is the name of the database user who has been granted permissions on this COLUMN_NAME by the listed GRANTOR. In Microsoft SQL Server, this column will always include a database user from the <i>sysusers </i>table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=26%>PRIVILEGE</td>
<td width=22%><i>varchar</i>(32)</td>
<td width=52%>Is one of the available column privileges. Column privileges can be one of the following values (or other values supported by the data source when implementation is defined):<p>
SELECT   The GRANTEE can retrieve data for the columns.</p>
<p>
INSERT   The GRANTEE can provide data for this column when new rows are inserted (by the GRANTEE) into the table.</p>
<p>
UPDATE   The GRANTEE can modify existing data in the column.</p>
<p>
REFERENCES   The GRANTEE can reference a column in a foreign table in a primary key/foreign key relationship. In SQL Server 6.0, primary key/foreign key relationships are defined with table constraints.</p>
</td>
</tr>
<tr valign=top>
<td width=26%>IS_GRANTABLE</td>
<td width=22%><i>varchar</i>(3)</td>
<td width=52%>Indicates whether the GRANTEE is permitted to grant privileges to other users (often referred to as "grant with grant" permission). Can be YES, NO, or NULL. An unknown (or NULL) value refers to a data source where "grant with grant" is not applicable. In SQL Server 6.0, "grant with grant" permission is not supported.</td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
