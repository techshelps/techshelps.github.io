<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_sproc_columns Catalog Stored Procedures</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_sproc_columns_catalog_stored_procedures"></a>sp_sproc_columns Catalog Stored Procedures </h2>
<p>
For SQL Server 6.5 information, see <a href="../../hydra/tsql/src/addsproc_7zzn.htm"><b>sp_sproc_columns</b></a> in <i>What's New for SQL Server 6.5</i>.</p>
<p>
Returns column information for a single stored procedure in the current environment.</p>
<h4>Syntax</h4>
<p>
<b>sp_sproc_columns</b> <i>procedure_name</i> [<b>,</b> <i>procedure_owner</i>] [<b>,</b> <i>procedure_qualifier</i>] [<b>,</b> <i>column_name</i>]</p>
<p>
where
<dl>
<dt>
<i>procedure_name</i></dt>
<dd>
Is the name of the procedure used to return catalog information. The <i>procedure_name </i>can be a variable character name with a maximum of 42 characters. Wildcard pattern matching is not supported.</dd>
<dt>
<i>procedure_owner</i></dt>
<dd>
Is the name of the owner of the procedure used to return catalog information. The <i>procedure_owner </i>can be a variable character name with a maximum of 30 characters. Wildcard pattern matching is not supported. If <i>procedure_owner</i> is not specified, the default procedure visibility rules of the underlying DBMS apply.
<p>
In Microsoft SQL Server, if the current user owns a procedure with the specified name, that table's columns are returned. If <i>procedure_owner </i>is not specified and the current user does not own a procedure with the specified <i>procedure_name</i>, this procedure looks for a procedure with the specified <i>procedure_name </i>owned by the database owner. If one exists, that table's columns are returned.
</dd>
<dt>
<i>procedure_qualifier</i></dt>
<dd>
Specifies the name of the procedure qualifier. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the database name. In some products, it represents the server name of the table's database environment.</dd>
<dt>
<i>column_name</i></dt>
<dd>
Specifies a single column and is used when only one column of catalog information is desired. If <i>column_name </i>is not specified, all columns will be returned. In Microsoft SQL Server, this <i>column_name </i>represents the column name as listed in the <i>syscolumns</i> table. The value specified can include wildcard characters using the underlying DBMS's wildcard matching patterns. For maximum interoperability, the gateway client should assume only ANSI-standard SQL pattern matching (the % and _ wildcard characters).
</dd>
</dl>
<h4>Remarks</h4>
<p>
The returned columns belong to the parameters or results set of a stored procedure. If the SP_NUM_PARAMETERS and SP_NUM_RESULT_SETS columns returned by <i>sp_stored_procedure</i> for a particular stored procedure are -1 (indeterminate), <b>sp_proc_columns</b> returns no rows for that stored procedure. In SQL Server 6.0, only the column information about input and output parameters for the stored procedure are returned.</p>
<p>
The <b>sp_sproc_columns</b> catalog stored procedure is equivalent to <b>SQLProcedureColumns</b> in ODBC. The results returned are ordered by PROCEDURE_QUALIFIER, PROCEDURE_OWNER, PROCEDURE_NAME, and the order that the parameters appear in the procedure definition.</p>
<p>
This is the results set:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=36%></th>
<th align=left width=18%></th>
<th align=left width=46%></th>
</tr>
<tr valign=top>
<th align=left width=36%></th>
<th align=left width=18%></th>
<th align=left width=46%></th>
</tr>
<tr valign=top>
<th align=left width=36%>Column</th>
<th align=left width=18%>Datatype</th>
<th align=left width=46%>Description</th>
</tr>
<tr valign=top>
<td width=36%></td>
<td width=18%></td>
<td width=46%></td>
</tr>
<tr valign=top>
<td width=36%>PROCEDURE_QUALIFIER</td>
<td width=18%><i>char</i>(32)</td>
<td width=46%>Is the name of the procedure qualifier. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the database name. In some products, it represents the server name of the table's database environment. This field can be NULL.</td>
</tr>
<tr valign=top>
<td width=36%>PROCEDURE_OWNER</td>
<td width=18%><i>char</i>(32)</td>
<td width=46%>Is the name of the procedure owner. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the name of the database user that created the table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=36%>PROCEDURE_NAME</td>
<td width=18%><i>char</i>(41)</td>
<td width=46%>Is the name of the procedure. Various DBMS products support three-part naming for tables (<i>qualifier</i><b>.</b><i>owner</i><b>.</b><i>name</i>). In Microsoft SQL Server, this column represents the procedure name as listed in the <i>sysobjects</i> table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=36%>COLUMN_NAME</td>
<td width=18%><i>char</i>(32)</td>
<td width=46%>Is the name of the column, for each column of the TABLE_NAME returned. In Microsoft SQL Server, this column represents the column name as listed in the <i>syscolumns</i> table. This field will always return a value.</td>
</tr>
<tr valign=top>
<td width=36%>COLUMN_TYPE</td>
<td width=18%><i>smallint</i></td>
<td width=46%>This field will always return a value. Can be:<p>
0&nbsp;&nbsp;&nbsp;&nbsp;SQL_PARAM_TYPE_UNKNOWN<br>
1&nbsp;&nbsp;&nbsp;&nbsp;SQL_PARAM_TYPE_INPUT<br>
2&nbsp;&nbsp;&nbsp;&nbsp;SQL_PARAM_TYPE_OUTPUT<br>
3&nbsp;&nbsp;&nbsp;&nbsp;SQL_RESULT_COL<br>
4&nbsp;&nbsp;&nbsp;&nbsp;SQL_PARAM_OUTPUT<br>
5&nbsp;&nbsp;&nbsp;&nbsp;SQL_RETURN_VALUE</p>
</td>
</tr>
<tr valign=top>
<td width=36%>DATA_TYPE</td>
<td width=18%><i>smallint</i></td>
<td width=46%>Is an integer code for an ODBC datatype. If this datatype cannot be mapped to an ANSI type, the value will be NULL. The native datatype name is returned in the TYPE_NAME column. </td>
</tr>
<tr valign=top>
<td width=36%>TYPE_NAME</td>
<td width=18%><i>char</i>(30)</td>
<td width=46%>Is the string representation of the datatype. This is the datatype name as presented by the underlying DBMS.</td>
</tr>
<tr valign=top>
<td width=36%>PRECISION</td>
<td width=18%><i>int</i></td>
<td width=46%>Is the number of significant digits.</td>
</tr>
<tr valign=top>
<td width=36%>LENGTH</td>
<td width=18%><i>int</i></td>
<td width=46%>Is the transfer size of the data.</td>
</tr>
<tr valign=top>
<td width=36%>SCALE</td>
<td width=18%><i>smallint</i></td>
<td width=46%>Is the number of digits to the right of the decimal point.</td>
</tr>
<tr valign=top>
<td width=36%>RADIX</td>
<td width=18%><i>smallint</i></td>
<td width=46%>Is the base for numeric types.</td>
</tr>
<tr valign=top>
<td width=36%>NULLABLE</td>
<td width=18%><i>smallint</i></td>
<td width=46%>Specifies nullability. 1 means this datatype can be created allowing null values; 0 means null values are not allowed.</td>
</tr>
<tr valign=top>
<td width=36%>REMARKS</td>
<td width=18%><i>varchar</i>(254)</td>
<td width=46%>Is a description of the procedure column. SQL Server will not return a value for this column.</td>
</tr>
<tr valign=top>
<td width=36%>SS_DATA_TYPE</td>
<td width=18%><i>tinyint</i></td>
<td width=46%>Is a SQL Server datatype, as defined in <i>Microsoft SQL Server Programming DB-Library for C</i>. The gateway converts the underlying data to this SQL Server datatype as the default, for use by Open Data Services gateway implementations of catalog stored procedures. If the gateway supports configurable datatype conversions, either per installation or per session, the conversion type when the stored procedure is executed is returned.</td>
</tr>
<tr valign=top>
<td width=36%>COLID</td>
<td width=18%><i>tinyint</i></td>
<td width=46%>Is a SQL Server - specific column added to the result set. This column does not need to appear in Open Data Services gateway implementations of catalog stored procedures.</td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
