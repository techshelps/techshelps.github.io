<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Up a SQLMail Client</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_setting_up_a_sqlmail_client"></a>Setting Up a SQLMail Client</h1>
<p>
To enable SQLMail functionality for a server, you will:
<ol>
<li>
Set up the server computer as a Microsoft Windows NT Mail client.</li>
<li>
Set up SQL Server as a SQLMail client.</li>
</ol>
<p>
The procedures that follow describe how to accomplish these tasks.</p>
<p>
<b>Note</b>  As a prerequisite to setting up a SQLMail client, a Mail post office must already be available. If one is not, see <a href="admn18_8bs5.htm">Setting Up a Mail Post Office</a>, later in this chapter. </p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To set up the server computer as a Microsoft Windows NT Mail client</h5>
<ol>
<li>
From the Main program group, double-click the Mail icon.<p>
<img src="images/ad18_08.gif" border=0>
<p>
The Welcome to Mail dialog box appears.
<p>
<img src="images/ad18_01.gif" border=0>
</li>
<li>
Choose the option Connect To An Existing Postoffice, and then choose OK.<p>
The Connect to Postoffice dialog box appears.
<p>
<img src="images/ad18_03.gif" border=0>
</li>
<li>
Enter the network path of the post office, and then choose OK.<p>
For example:
<pre>\\airedale\wgpo
</pre>
<p>
A dialog box appears, asking whether or not you have an account on the post office.
<p>
<img src="images/ad18_09.gif" border=0>
</li>
<li>
Choose Yes or No.<ul>
<li>
To use an existing mail login account, choose Yes. In the Mail Sign In dialog box that appears, enter the mail login name and password, and then choose OK. The server is configured as a Mail client, and the Mail window appears.<p>
After you sign into an existing mail login account, skip to step 7.
</li>
<li>
To create a new mail login account, choose No. The Enter Your Account Details dialog box appears. To complete this dialog box, proceed with step 5.</li>
</ul>
<p>
<img src="images/ad18_10.gif" border=0>
</li>
<li>
Define a mail login account. At a minimum, enter a name, mailbox, and password. <dl>
<dt>
<b>Name </b></dt>
<dd>
Is the full name of the mail user.
<p>
Normally, this would be the full name of a user of this computer. For example:

<pre>John Q. Public
</pre>

<p>
However, in this case, it is recommended that you consider creating a mail account especially for SQL Server. For example, if the local server is named TERRIER, you might enter: 

<pre>SQL Server Terrier
</pre>
</dd>
<dt>
<b>Mailbox</b></dt>
<dd>
Is a mail address that will be used to log in to the post office.
<p>
Normally, this would be a variation of the user's full name. For example, to represent "John Q. Public" you might enter:

<pre>JohnQP
</pre>

<p>
Or for a mail login that will be used by the local SQL Server, you might enter:

<pre>terrier
</pre>
</dd>
<dt>
<b>Password</b></dt>
<dd>
Is a password for the mail login. For example:
<pre>casey86
</pre>
</dd>
</dl>
</li>
<li>
Choose the OK button.<p>
The server is configured as a Mail client, the mail login account is created, and the Mail window appears.
</li>
<li>
Verify that Mail is set up properly by sending an ordinary mail message to yourself. To send a message, choose the Compose button and complete the dialog box that appears. <p>
For information about sending and receiving messages, see the online Help for Mail.
</li>
<li>
From the Mail menu, choose the Options menu and set the Mail options to appropriate values for use by SQL Server. In particular:<ul>
<li>
Set the Check For New Mail option to Every 1 Minute.</li>
<li>
Clear the option Save Copy Of Outgoing Messages In Sent Mail Folder. (Do not save messages in that folder.)</li>
<li>
Clear the option Check Spelling Of Messages Before Sending. (Do not check spelling.)</li>
</ul>
<p>
For information about setting options, see the online Help for Mail.
</li>
</ol>
<p>
Once the server is set up as a Microsoft Windows NT Mail client, you can set up SQLMail by using SQL Setup.</p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To set up SQLMail</h5>
<ol>
<li>
Start the Mail client using the same Mail login account SQLMail will use to log on to Windows NT mail.<p>
You will specify the name and password of this Mail login account in step 7 of this procedure.
</li>
<li>
From the Microsoft SQL Server 6.0 program group, double-click the SQL Setup icon.</li>
<li>
Follow the on-screen instructions until the Microsoft SQL Server 6.0 Options dialog box appears.<p>
<img src="images/ad18_800.gif" border=0>
</li>
<li>
Choose Set Server Options, and then choose Continue.<p>
The Select Server Options dialog box appears.
<p>
<img src="images/ad18_801.gif" border=0>
</li>
<li>
To start a SQLMail session every time SQL Server starts, select Auto Start Mail Client.</li>
<li>
To set the SQLMail login options, choose the Mail Login button.<p>
The Mail Login dialog box appears.
<p>
<img src="images/ad18_802.gif" border=0>
</li>
<li>
To specify a mail login account SQLMail will use to log in to Windows NT Mail, in the Mail Login Name box, type a valid Mail login name; in the Mail Password box type the password for that Mail login name; and in the Confirm Password box type the password again.<p>
If you have configured SQL Server to start SQLMail sessions automatically, you must supply a mail login name and password. If you will be starting mail sessions manually (by using <b>xp_startmail</b>), you can optionally supply your login name and password in this dialog box so that you do not have to type it at the command line. (Note that SQLMail will "piggyback" an existing client session of Mail, if one is running.)
<p>
<b>Note</b>  If at any time the Windows NT Mail password is changed, you will need to change the password here as well.
</li>
<li>
If you are setting up SQLMail on this server for the first time, select the option Copy SQLMail Configuration from Current User Account.<p>
This copies the post office location and mail options of the user you set up the Windows NT Mail client for previously. The settings are copied to the Default User.
<p>
Even if you don't use the Mail Login dialog box to save a Mail username and password, you must select this option when setting up SQLMail for the first time. Thereafter, the check box does not need to be selected unless you have changed your Mail client configuration information. 
</li>
<li>
Choose Continue.<p>
The Select Server Options dialog box returns.
</li>
<li>
Choose Change Options.<p>
The new settings are processed.
</li>
<li>
Choose Exit.</li>
</ol>
<p>
After SQLMail is installed, by default the SQL Executive service will automatically attempt to start the SQLMail session every time SQL Executive starts. This behavior can be controlled through a Registry value.</p>
<p>
HKEY_LOCAL_MACHINE<br>
&nbsp;&nbsp;&nbsp;&nbsp;\SOFTWARE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\Microsoft<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\MSSQLServer<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\SQLExecutive</p>
<p>
Name: MailAutoStart<br>
Type: REG_DWORD<br>
Data: </p>
<p>
If the value is set to 1, SQLMail auto-starts when SQL Executive starts. If the value is set to 0 or the Registry key does not exist, SQLMail does not start when SQL Executive starts. The default is 1.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
