<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Rebuilding the master Database</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_rebuilding_the_master_database"></a>Rebuilding the <i>master</i> Database</h1>
<p>
The <i>master</i> database is the system database that keeps track of user accounts, remote user accounts, remote servers, environment variables, system error messages, system databases, database storage allocation, devices, and active locks. </p>
<p>
The <b>setup</b> program can be used to rebuild the <i>master</i> database. This rewrites the master database and resets the configuration values on its existing device. This process can also be used to change the server's character set or sort order.</p>
<p>
<b>Caution</b>  Rebuild the <i>master</i> database only when it is absolutely essential. Rebuilding the <i>master</i> database completely rewrites the <i>master</i> database, destroys all information added since SQL Server was first installed, and renders all other databases unusable. If you rebuild the <i>master</i> database, you must recreate the user databases, reload each database from the most recent dump, and then reapply any changes not included in the dump. </p>
<p>
When rebuilding the <i>master</i> database, you have the option of changing the character set or sort order. Because the sort order is used to construct all indexes, including system indexes, all databases must be rebuilt if you change the sort order. The <b>setup</b> program rebuilds the <i>master</i> database for you, but you must rebuild user databases yourself. </p>
<p>
If you must rebuild the <i>master</i> database or change the character set or sort order, follow this procedure.</p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To use setup to rebuild the <i>master</i> database</h5>
<ol>
<li>
If you are changing the character set or the sort order, back up all databases. If not, go to step 4.</li>
<li>
Put all data definition language (DDL) commands in batch files. You will use the batch files to recreate the structure of your databases after changing the sort order. (SQL Enterprise Manager can help with this step.)</li>
<li>
Use the <b>bcp</b> (bulk copy) utility to copy data out of your tables.<p>
Include all database objects. Also copy out lists of users.
</li>
<li>
Back up the entire SQL Server directory tree and any disk devices that you have created in other directories.</li>
<li>
From the Microsoft SQL Server 6.0 program group, double-click the SQL Setup icon and follow the on-screen instructions until the Microsoft SQL Server 6.0 Options dialog box appears.<p>
<img src="images/ad03_317.gif" border=0>
</li>
<li>
Select the Rebuild Master Database option, and then choose Continue.<p>
A confirmation dialog box appears.
<p>
<img src="images/ad03_318.gif" border=0>
</li>
<li>
Choose Resume.<p>
The Rebuild Options dialog box appears.
<p>
<img src="images/ad03_319.gif" border=0>
</li>
<li>
To change the character set during the rebuild, choose the Sets button, and complete the Select Character Set dialog box that appears.<p>
For information about the character sets provided with SQL Server, see <i>Microsoft SQL Server Setup</i>.
</li>
<li>
To change the sort order during the rebuild, choose the Orders button, and complete the Select Sort Order dialog box that appears.<p>
<b>Important</b>  The sort order is used to construct all indexes, including system indexes. If you change the sort order, all databases must be rebuilt. The <b>setup</b> program rebuilds the <i>master</i> database for you, but you must rebuild user databases yourself. 
<p>
For information about the sort orders provided with SQL Server, see <i>Microsoft SQL Server Setup</i>.
</li>
<li>
In the Rebuild Options dialog box, choose Continue.<p>
The SQL Server Installation Path dialog box appears.
<p>
<img src="images/ad03_320.gif" border=0>
</li>
<li>
If it is not correctly displayed in the dialog box, enter the location of the existing SQL Server installation, and then choose Continue.<p>
The Rebuild Master Device dialog box appears.
<p>
<img src="images/ad03_321.gif" border=0>
</li>
<li>
If it is not correctly displayed in the dialog box, enter the location and name of the existing MASTER device. Also enter a MASTER device size, and then choose Continue.<p>
The setup program rebuilds the master database.
</li>
<li>
When the rebuild completes and the completion dialog box appears, choose the Exit button.</li>
<li>
If you changed the character set or sort order, recreate all databases using the batch files created in step 2, and then use <b>bcp</b> to copy the data back into your databases.</li>
</ol>
<p>
For information about <b>bcp</b>, see Chapter 11, <a href="admn11_3a75.htm">Exporting and Importing Data</a>. </p>
<p>
The files MASTER.DA@ and MASTER.AL@ are stored in the \SQL60\INSTALL directory. When installing SQL Server or rebuilding the <i>master</i> database, one of these two files is used. When the default sort order and character set are selected during an installation or a <i>master</i> database rebuild, MASTER.DA@ is expanded and copied onto the server, replacing MASTER.DAT. When an alternate character set and/or sort order is selected, MASTER.AL@ is expanded and copied onto the server, and several SQL scripts are run. Because of this, selecting the default character set and sort order results in a rapid master database rebuild. Choosing an alternate character set or sort order can result in a somewhat longer rebuild time.</p>
<p>
Because of the introduction of one-way encrypted passwords with SQL Server 6.0, changing the sort order has an impact on the use of passwords. For information, see <i>Microsoft SQL Server Setup</i>.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
