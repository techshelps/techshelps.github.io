<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Stored Procedures Used for Removable Media Databases</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_stored_procedures_used_for_removable_media_databases"></a>Stored Procedures Used for Removable Media Databases</h2>
<p>
The following stored procedures are used to administer removable media. The following information provides summary descriptions. For more information, see the <i>Microsoft SQL Server Transact-SQL Reference</i>. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=33%></th>
<th align=left width=67%></th>
</tr>
<tr valign=top>
<th align=left width=33%></th>
<th align=left width=67%></th>
</tr>
<tr valign=top>
<th align=left width=33%>Stored procedure</th>
<th align=left width=67%>Role in removable media administration</th>
</tr>
<tr valign=top>
<td width=33%><b>sp_certify_removable</b></td>
<td width=67%>Verifies that a database is configured properly for distribution on removable media. If the database passes, it is set to offline, and some information required for installation is returned.</td>
</tr>
<tr valign=top>
<td width=33%><b>sp_create_removable</b></td>
<td width=67%>Creates a removable media database. Creates three or more devices and places the database on those devices. One device holds the system catalog tables, one the transaction log, and one or more the data tables. Use this stored procedure to create the database prior to performing database development.</td>
</tr>
<tr valign=top>
<td width=33%><b>sp_dbinstall</b></td>
<td width=67%>Installs a database and its devices. Must be run once for each device of the database being installed. Copies the system device to the hard disk (which places the system catalog tables and the transaction log on read-write media). Can leave data devices on the distribution media (usually, a CD) or can copy data devices to the hard disk.</td>
</tr>
<tr valign=top>
<td width=33%><b>sp_dboption</b></td>
<td width=67%>Used to place a database online (database is ready to be used) or offline (database is unavailable). Place a database offline before removing a disk containing the data device from a drive.</td>
</tr>
<tr valign=top>
<td width=33%><b>sp_dbremove</b></td>
<td width=67%>Used to remove an installed database (and, optionally, any devices it has exclusive use of).<p>
This procedure can be used for all databases, not just those on removable media.</p>
</td>
</tr>
</table><br>
<p>
<b>Note</b>  Some of these stored procedures have other uses and other options not documented here. This chapter discusses only the functionality of these stored procedures related to removable media. For more information, see the <i>Microsoft SQL Server Transact-SQL Reference</i>.</p>
<p>
Also, although this section focuses on administering databases on removable media, note that you can also set databases and devices to online or offline using <b>sp_dboption</b>, and you can use<b> sp_dbremove</b> to drop databases, whether the databases are on removable media or not.</p>
<p>&nbsp;</p></body>
</HTML>
