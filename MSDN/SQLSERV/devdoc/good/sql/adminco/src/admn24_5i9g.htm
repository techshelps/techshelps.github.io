<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Associating a Page with an Object</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_associating_a_page_with_an_object"></a>Associating a Page with an Object </h1>
<p>
Some SQL Server error messages specify a logical page number instead of the table or index name to which the page belongs. The following procedure shows how to determine the object to which a particular database page belongs.</p>
<p>
Although you can use DBCC CHECKALLOC and DBCC CHECKDB to identify table names and index IDs, a quicker method is described below. Note, however, that this method tells you only the table or index associated with a particular page number.</p>
<p>
Suppose you encounter the following error message:</p>
<pre>Error 644, Severity 21, State 1
The non_clustered leaf row entry for page 1342 row 6 was not found in index page 944 indexid 3 database 'production'
  </pre>
<p>
The error message implies that a nonclustered index is corrupt, but the corresponding table name or index name is not given ¾ only a page number (944) and an index ID (3).</p>
<p>
To determine which table or index is involved, follow these steps:
<ol>
<li>
Log in as <b>sa</b>.</li>
<li>
Determine the database ID (<i>dbid</i>) as follows:<pre>select db_id('database_name')</pre>
</li>
<li>
Enable trace flag 3604 to allow DBCC output to appear on the server:<pre>dbcc traceon(3604) </pre>
</li>
<li>
To display information about the page in question, use the DBCC PAGE statement as follows:<p>
<b>dbcc page(</b><i>database_id</i><b>,</b> <i>page_number</i><b>)</b>
<p>
<b>Note</b>  The DBCC PAGE statement is not a supported feature, so future compatibility is not assured. It is offered here only for the purpose of providing a faster method of associating a page with an object. Additional information about the output of DBCC PAGE is not available.
<p>
For example, assuming that the output from step 2 indicates that the database ID is 6, you can find information about page 944 (the index page indicated in the error message shown above) as follows. (The <i>objid</i> and <i>indid</i> shown in the boxes in the following example are used in steps 5 and 6, below.)
<pre>dbcc page (6, 944)
PAGE: Page not found in cache - read from disk.
BUFFER: Buffer header for buffer 0x2c4b30 page=0x540800 bdnew=0x0 
bold=0x0 bhash=0x0 bnew=0x0 bold=0x0 bvirtpg=7092 bdbid=6 
bpinproc=0 bkeep=0 bspid=0 
bstat=0x0000 bpageno=0
PAGE HEADER: Page header for page 0x540800 
objid=9051068
pageno=944 nextpg=0 prevpg=0 timestamp=0001 
000c70f2
indid=3
nextrno=32 level=0  freeoff=52 minlen=7 
page status bits: 0x2, 
DBCC execution completed. If DBCC printed error messages, see your System Administrator.</pre>
</li>
<li>
Translate the object ID (<i>objid</i>) in the PAGE HEADER section of the output into a table name:<pre>use database_name
go
select object_name(9051068)
go
--------------
bad_table</pre>
</li>
<li>
If an index is applicable, translate the index ID (<i>indid</i>) into an index name:<pre>use database_name
go
select name from sysindexes 
where id = 9051068 and indid = 3
go</pre>
</li>
<li>
To determine the index type, refer to the following table:</li>
</ol>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=17%></th>
<th align=left width=83%></th>
</tr>
<tr valign=top>
<th align=left width=17%></th>
<th align=left width=83%></th>
</tr>
<tr valign=top>
<th align=left width=17%>Index Id</th>
<th align=left width=83%>Meaning</th>
</tr>
<tr valign=top>
<td width=17%>0</td>
<td width=83%>Table data</td>
</tr>
<tr valign=top>
<td width=17%>1</td>
<td width=83%>Clustered index</td>
</tr>
<tr valign=top>
<td width=17%>2 - 254 </td>
<td width=83%>Nonclustered index</td>
</tr>
<tr valign=top>
<td width=17%>255</td>
<td width=83%>Text page</td>
</tr>
</table><br>
<p class=indent1>
Because the DBCC PAGE output indicated that the <i>indid</i> is 3, the page belongs to a nonclustered index. (If the <i>indid</i> is 0, the page belongs to a table, and it does not belong to an index.)</p>
<ol start=8>
<li>
Disable trace flag 3604:<pre>dbcc traceoff(3604)</pre>
</li>
</ol>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
