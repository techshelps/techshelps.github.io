<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Dropping a Database When DROP DATABASE Fails</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dropping_a_database_when_drop_database_fails"></a>Dropping a Database When DROP DATABASE Fails</h1>
<p>
You can use the following procedure to drop a database if DROP DATABASE fails.</p>
<p>
<b>Caution</b>  Do not use this procedure unless directed to do so by your primary support provider or this manual, or unless there is no critical data in the database. Otherwise, you might damage your database.</p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To drop a database when DROP DATABASE fails</h5>
<ol>
<li>
Log in as <b>sa</b>.</li>
<li>
Check to be sure that the database has been marked suspect:<pre>select name from master..sysdatabases
where status &amp; 256 = 256</pre>
</li>
<li>
If the database is marked suspect, go to step 4. If it has not been marked suspect, mark the database suspect using either of the following methods:<ul>
<li>
Execute the <b>sp_marksuspect</b> stored procedure described in "Resetting the Suspect Status," later in this chapter.</li>
</ul>
<p>
Or
<ul>
<li>
Update the <i>sysdatabases</i> table manually as shown in the following example:<pre>sp_configure 'allow updates', 1
go

reconfigure with override
go

use master
go

begin tran
update sysdatabases set status = status | 256
where name = 'database_name'
go
</pre>
<p>
Verify that only one row was affected and commit the transaction:
<pre>commit tran
</pre>
<p>
Then reset the <b>allow updates</b> option using <b>sp_configure</b>:
<pre>sp_configure 'allow updates', 0
go

reconfigure with override
go
</pre>
<p>
Finally, restart SQL Server to initialize the change.
</li>
</ul>
</li>
<li>
Remove the database using DBCC<b> </b>DBREPAIR:<pre>dbcc dbrepair(database_name,dropdb)</pre>
<p>
<b>Note</b>  DBCC<b> </b>DBREPAIR<b> </b>sometimes displays an error message even though it successfully drops the database. If an error message appears, verify that the database has been removed by executing USE <i>database_name</i>. This should fail with a 911 error because you dropped the database. If any other error occurs, contact your primary support provider.
</li>
</ol>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
