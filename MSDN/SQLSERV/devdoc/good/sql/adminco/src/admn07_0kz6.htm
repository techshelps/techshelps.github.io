<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Master Database from a Mirror</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_using_the_master_database_from_a_mirror"></a>Using the Master Database from a Mirror</h2>
<p>
If the primary device used for the <i>master</i> database becomes unavailable or has been corrupted while the server is running, the mirror device for <i>master</i> automatically becomes active. However, when the primary device for the <i>master</i> database has failed and you need to restart the server, use the <b>sqlservr</b> executable with the <b>-r</b> option. The <b>-r</b> option enables the server to find and use the mirror device for the <i>master</i> database when restarting SQL Server. </p>
<p>
For example, if the MASTER mirror device is D:\SQL60\MIRROR<br>
\MASTMIR.DAT, the following example restarts the server using the mirror device:</p>
<pre>sqlservr -c -dc:\sql60\data\master.dat -ec:\sql60\log\error.log 
    -rd:\sql60\mirror\mastmir.dat</pre>
<p>
where
<dl>
<dt>
<b>-c</b></dt>
<dd>
Starts SQL Server independent of the Windows NT Service Control Manager.</dd>
<dt>
<b>-d</b></dt>
<dd>
Is the path of the primary device for the <i>master</i> database. </dd>
<dt>
<b>-e</b> </dt>
<dd>
Is the path of the error log file for SQL Server. </dd>
<dt>
<b>-r</b></dt>
<dd>
Is the path of the mirroring device to be used to mirror the <i>master</i> database.

</dd>
</dl>
<p>
<b>Note</b>  The <b>sqlservr</b> utility requires that both the <b>-d</b> and <b>-r</b> options be present on the command line. The program always attempts to use the primary device specified by the <b>-d</b> option before it uses the <b>-r</b> option. When the primary device for <i>master</i> cannot be used, the server uses the device specified with the <b>-r</b> parameter. You cannot force the server to use the mirror device as the primary device if the original primary device works.</p>
<p>
Configuring the server startup parameters to run SQL Server with the <b>-r</b> option allows SQL Server services to automatically use the mirror device for the <i>master</i> database when the primary device for <i>master</i> fails. The <b>-r </b>option requires the full path of the mirror device.</p>
<p>
You can configure the server startup parameters by using either SQL Setup or SQL Enterprise Manager. The following procedure assumes you are using SQL Setup.</p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To modify the server options to specify -r</h5>
<ol>
<li>
From the Microsoft SQL Server 6.0 program group, double-click the SQL Setup icon.<p>
<img src="images/ad07_09.gif" border=0>
</li>
<li>
Follow the onscreen instructions until the Microsoft SQL Server 6.0 Options dialog box appears.<p>
<img src="images/ad07_10.gif" border=0>
</li>
<li>
Select Set Server Options and choose the Continue button.<p>
The Select Server Options dialog box appears.
<p>
<img src="images/ad07_11.gif" border=0>
</li>
<li>
Choose the Parameters button.<p>
The Server Parameters dialog box appears.
<p>
<img src="images/ad07_12.gif" border=0>
</li>
<li>
In the Parameter box, type the path of the mirror device. For example:<pre>-re:\mirdir\mastmir.dat</pre>
</li>
<li>
Choose the Add button, and then choose the OK button.<p>
The Select Server Options dialog box reappears.
</li>
<li>
Choose the Change Options button.</li>
<li>
Choose the Exit button.</li>
</ol>
<p>
If the <b>-r</b> option is present, <b>sqlservr</b> is always executed with both the <b>-r</b> and the <b>-d</b> options. This minimizes the chance that you will get a message stating that the MASTER device is unusable. If the <b>-r </b>option is present, the mirror file is used when the primary device fails.</p>
<p>
<b>Note</b>  You should periodically check the error log to determine if you are running SQL Server using the mirror of the <i>master</i> database, because it is possible to have a no longer operational primary device but not be aware of it. Since it is possible to not be aware of the primary device failure, you might want to use <b>-r</b> only if it becomes necessary because the primary device fails.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
