<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding Registry Keys</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_adding_registry_keys"></a>Adding Registry Keys</h1>
<p>
When you install SQL Server, the <b>setup</b> program writes a set of default startup options in the Windows NT Registry under the key:</p>
<p>
HKEY_LOCAL_MACHINE<br>
&nbsp;&nbsp;&nbsp;&nbsp;\SOFTWARE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\Microsoft<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\MSSQLServer<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\MSSQLServer</p>
<p>
If you want to create and store alternate sets of startup options in the Registry ¾ for example, to start SQL Server in single-user mode ¾ copy the MSSQLServer key (under MSSQLServer) to a new key, and then edit the options in the new key to suit your needs. Each startup option is stored as a separate parameter in the Parameters entry of the MSSQLServer key, starting with <b>SQLArg0</b>, then <b>SQLArg1</b>, and so on. The order of the parameters is not important.</p>
<p>
Only experienced users should use REGEDT32 to edit the Windows NT registry. Editing of the Registry is not generally recommended, and inappropriate or incorrect changes can cause serious configuration problems for your system.</p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To copy the Server key to a new key</h5>
<ol>
<li>
Start the Registry editor (run the REGEDT32.EXE program).</li>
<li>
Switch to the HKEY_LOCAL_MACHINE window.</li>
<li>
Double-click the SOFTWARE entry.</li>
<li>
Double-click the Microsoft entry.</li>
<li>
Select the MSSQLServer entry.</li>
<li>
From the Edit menu, choose Add Key.</li>
<li>
In the Key Name box, enter a name for the new key.</li>
<li>
Choose the OK button.</li>
<li>
Select the MSSQLServer entry (under MSSQLServer).</li>
<li>
From the Registry menu, choose Save Key.</li>
<li>
In the File Name box, enter a filename for the saved key.</li>
<li>
Choose the OK button.</li>
<li>
Select the new key.</li>
<li>
From the Registry menu, choose Restore.</li>
<li>
In the File Name box, enter the filename for the saved key.</li>
<li>
Choose the OK button.</li>
<li>
Choose the Yes button.</li>
</ol>
<p>
For example, you could create a new key called SingleUser and then edit this Registry entry to include the additional <b>-m</b> startup option.</p>
<p>
HKEY_LOCAL_MACHINE<br>
&nbsp;&nbsp;&nbsp;&nbsp;\SOFTWARE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\Microsoft<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\MSSQLServer<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\SingleUser<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\Parameters</p>
<p>
Using this procedure, you could create a new key called SingleUser, and then edit this entry </p>
<p>
HKEY_LOCAL_MACHINE<br>
&nbsp;&nbsp;&nbsp;&nbsp;\SOFTWARE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\Microsoft<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\MSSQLServer<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\SingleUser<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\Parameters </p>
<p>
to include the additional <b>-m</b> startup option. </p>
<p>
The entire Parameters entry for the SingleUser key would look like this:</p>
<pre>HKEY_LOCAL_MACHINE
    \Software
        \Microsoft
            \MSSQLServer
                \SingleUser
                    \Parameters
SQLArg0 : REG_SZ : -dC:\SQL\DAT\MASTER.DAT
SQLArg1 : REG_SZ : -eC:\SQL\LOG\ERRORLOG
SQLArg2 : REG_SZ : -m
<b><i> </i></b></pre>
<p>
To start SQL Server using this alternate key, you would start SQL Server from the command line using the <b>-s</b> startup option, as shown in the following example:</p>
<pre>sqlservr -c -sSingleUser
</pre>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
