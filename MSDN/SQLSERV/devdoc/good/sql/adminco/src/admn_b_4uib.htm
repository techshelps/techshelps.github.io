<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Average Sizes for Variable Fields</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_using_average_sizes_for_variable_fields"></a>Using Average Sizes for Variable Fields</h3>
<p>
These calculations use the maximum size of the variable-length fields. If you know the average size of the fields, you can use this value in Steps 1 and 4 for calculating table size, and the value in Step 1 for calculating the nonclustered index size. You'll need slightly different formulas for clustered and nonclustered indexes.</p>

<h5><a name="_for_clustered_indexes"></a>For Clustered Indexes</h5>
<p>
In "Step 1: Calculate the Data Row Size," use the sum of the average length of the variable-length columns instead of the sum of the defined length of the variable-length columns to determine the average data row size:</p>
<p>
<b>4 +</b> (<i>Sum of bytes in all fixed-length columns</i>) + (<i>Sum of bytes of the average length of variable-length columns</i>) <b>=</b> <i>Subtotal</i></p>
<p>
In "Step 2: Calculate the Number of Data Pages," use the average data row size from the first formula:</p>
<p>
<b>2016</b> <b>/ </b>(<i>Average data row size</i>) <b>=</b> <i>Number of data rows per page</i></p>
<p>
In "Step 3: Calculate the Size of Clustered Index Rows," you must perform the addition twice. The first time, calculate the maximum index row size, using the given formula. The second time, calculate the average index row size, substituting the sum of the average number of bytes in the variable-length index keys for the sum of the defined number of bytes in the variable-length index keys:</p>
<p>
<b>5 +</b> (<i>Sum of bytes in the fixed-length index keys</i>) + (<i>Sum of bytes in variable length keys) </i><b>=</b> <i>Subtotal</i></p>
<p>
<i>Subtotal</i> + ((<i>Subtotal</i> <b>/ 256</b>) +<b> 1</b>) +<b> 2</b> <b>=</b> <i>Maximum index row size</i></p>
<p>
In "Step 4: Calculate the Number of Clustered Index Pages," substitute the following formula for the first formula, using the two different length values you calculated in the previous equation:</p>
<p>
(<b>2016 - </b>(<b>2 * </b><i>Maximum index row size</i>)) <b>/</b> <i>Average index row size</i> <b>=</b> <i>Number of clustered index rows per page</i></p>

<h4><a name="_for_nonclustered_indexes"></a>For Nonclustered Indexes</h4>
<p>
In "Step 1: Calculate the Size of the Leaf Index Row," you must perform the addition twice. The first time, calculate the maximum leaf index row size, using the given formula. The second time, calculate the average leaf index row size, substituting the average number of bytes in the variable-length index keys for the sum of bytes in the variable-length index keys:</p>
<p>
<b>5 +</b> (<i>Sum of bytes in the fixed-length index keys</i>) + (<i>Sum of the average number of bytes in variable-length index keys) </i><b>=</b> <i>Subtotal</i></p>
<p>
<i>Subtotal</i> + ((<i>Subtotal</i> <b>/ 256</b>) +<b> 1</b>) +<b> 2</b> <b>=</b> <i>Average index row size</i></p>
<p>
In "Step 2: Calculate the Number of Leaf Pages in the Index," use the average leaf index row size in the first division procedure:</p>
<p>
<b>2016 / </b>(<i>Average leaf index row size</i>) <b>=</b> <i>Number of leaf rows per page</i></p>
<p>
In "Step 3: Calculate the Size of the Nonleaf Rows," use the average leaf index row size:</p>
<p>
(<i>Average leaf index row</i>) +<b> 4 =</b> <i>Size of nonleaf row</i></p>
<p>
In "Step 4: Calculate the Number of Nonleaf Pages," substitute the following formula for the first formula, using the maximum and average row sizes calculated in Step 1:</p>
<p>
(<b>2016 - </b>(<b>2 * </b><i>Maximum index row size</i>)) <b>/</b> <i>Average index row size</i> <b>=</b> <i>Number of nonleaf index rows per page</i></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
