<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Copying Tables With or Without Indexes</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_copying_tables_with_or_without_indexes"></a>Copying Tables With or Without Indexes</h2>
<p>
For copying data in, the <b>bcp</b> utility is fastest if your database table has no indexes. Fast <b>bcp</b> does not log data inserts in the transaction log.</p>
<p>
<b>Important</b>  Before a user can do non-logged inserts with <b>bcp</b>, the SA or database owner must first use SQL Enterprise Manager (or the <b>sp_dboption</b> system procedure) to set the Select Into/Bulk Copy option for that database to <b>true</b>. If the option is not set and a user tries to copy data into a table that does not have indexes, SQL Server generates a warning message and will log the bulk inserts.</p>
<p>
For a table that has indexes, you do not need to set the Select Into/Bulk Copy option to copy data in, because bulk inserts into tables with indexes are always logged.</p>
<p>
When you copy into a table that has indexes, the server logs data inserts in the transaction log, which can cause the transaction log to become very large. After backing up your database with DUMP DATABASE, you can remove the committed transactions from the log by backing up the transaction log to a dump device. </p>
<p>
<b>Note</b>  If you back up the transaction log with TRUNCATE_ONLY, you will not be able to load any subsequent log dumps unless they have been made after another DUMP DATABASE.</p>
<p>
When copying data in, if a target table has no indexes, and if the Select Into/Bulk Copy database option is on, you can use non-logged <b>bcp</b>. Otherwise, you can only use logged <b>bcp</b>.</p>
<p>
By default, the Select Into/Bulk Copy option is off in newly created databases. To change the default for all new databases, set this option in the <i>model</i> database.</p>
<p>
There is a performance penalty for copying data into a table that has indexes in place. If you are copying a large number of rows, it can be faster to drop all the indexes beforehand with DROP INDEX, set the database option, copy the data into the table, dump the database, and then re-create the indexes. If the bulk data is sorted prior to the copy, you can use the WITH SORTED DATA option to build the clustered index in place on the newly loaded table.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
