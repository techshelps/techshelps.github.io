<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLMail Stored Procedures</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqlmail_stored_procedures"></a>SQLMail Stored Procedures</h1>
<p>
A dynamic-link library, SQLMAP60.DLL, is installed with SQL Server and includes the extended stored procedures necessary for mail enabling. Following are descriptions of the SQLMail extended stored procedures:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=73%></th>
</tr>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=73%></th>
</tr>
<tr valign=top>
<th align=left width=27%>SQLMail extended stored procedure</th>
<th align=left width=73%><br>
<br>
Description</th>
</tr>
<tr valign=top>
<td width=27%><b>xp_deletemail</b></td>
<td width=73%>Deletes a specified message.</td>
</tr>
<tr valign=top>
<td width=27%><b>xp_findnextmsg</b></td>
<td width=73%>Finds the next message in the mail box.</td>
</tr>
<tr valign=top>
<td width=27%><b>xp_readmail</b></td>
<td width=73%>Reads a message and/or an attachment from the mail box.</td>
</tr>
<tr valign=top>
<td width=27%><b>xp_sendmail</b></td>
<td width=73%>Sends a message and/or a query result set and/or an attachment to specified recipients.</td>
</tr>
<tr valign=top>
<td width=27%><b>xp_startmail</b></td>
<td width=73%>Starts a SQL Server Mail client session.</td>
</tr>
<tr valign=top>
<td width=27%><b>xp_stopmail</b></td>
<td width=73%>Stops a SQL Server Mail client session.</td>
</tr>
</table><br>
<p>
There is also one system stored procedure used by SQLMail:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=73%></th>
</tr>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=73%></th>
</tr>
<tr valign=top>
<th align=left width=27%>SQLMail system stored procedure</th>
<th align=left width=73%><br>
<br>
Description</th>
</tr>
<tr valign=top>
<td width=27%><b>sp_processmail</b></td>
<td width=73%>Processes mail in the inbox of SQL Server. Finds, reads, responds to, and deletes mail messages. Can return results of a query to a message sender. Can be called by SQL Executive as a scheduled task.</td>
</tr>
</table><br>
<p>
SQLMail system and extended stored procedures, syntax, and functionality are documented in the <i>Microsoft SQL Server Transact-SQL Reference</i>.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
