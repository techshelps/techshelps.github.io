<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Up DBOs to Manage Publications and Subscriptions</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_setting_up_dbos_to_manage_publications_and_subscriptions"></a>Setting Up DBOs to Manage Publications and Subscriptions</h2>
<p>
When you set up publication, distribution, and subscription servers for replication, permissions are automatically set that allow the SAs to manage publications and subscriptions. However, before the DBOs of the publication and subscription databases can manage publications or subscriptions, the proper permissions must be set up. </p>
<p>
Permissions are set up by creating some necessary SQL Server login IDs, database users, and remote login mappings. Permissions are set up separately for the DBOs of publication and subscription databases. There are two ways to set up permissions for the DBO of a publication database, depending on whether that publication server uses a remote distribution server or acts as its own combined publisher/distributor.</p>

<h5><a name="_a_dbo_on_a_combined_publisher.2f.distributor"></a>A DBO on a Combined Publisher/Distributor</h5>
<p>
When a publication server is configured to act as a combined publisher/distributor, to allow the DBO of a publication database to manage publications, you must:
<ol>
<li>
Add a database user to the publisher's <i>msdb</i> database for the login ID of the user who is DBO in the publication database.</li>
<li>
Add a database user to the publisher's <i>distribution</i> database for the login ID of the user who is DBO in the publication database.</li>
</ol>
<p>
If several users in the publication database are aliased to DBO, this must be repeated for each aliased user. Or, all users could be aliased to one user in the <i>msdb</i> database, and to one user in the <i>distribution</i> database.</p>
<p>
Database users are set up using SQL Enterprise Manager or the <b>sp_adduser</b> system stored procedure. For detailed information about setting up database users, see Chapter 9, <a href="admn09_8ozd.htm">Managing Security</a>. </p>

<h5><a name="_a_dbo_on_a_publication_server_that_uses_a_remote_distributor"></a>A DBO on a Publication Server that Uses a Remote Distributor</h5>
<p>
When a publication server is configured to use a remote distribution server, to allow the DBO of a publication database to manage publications, you must:
<ol>
<li>
On the distribution server, add a login ID for the user from the publication server (the user who is the DBO of the publication database). If that user already has a login ID on the remote distribution server, skip this step.<p>
Add the login ID using SQL Enterprise Manager or <b>sp_addlogin</b>. 
</li>
<li>
On the distribution server, to the <i>msdb</i> database, add a database user for the login ID that was added in step 1.<p>
Add the database user using SQL Enterprise Manager or <b>sp_adduser</b>.
</li>
<li>
On the distribution server, to the <i>distribution</i> database, add a database user for the login ID that was added in step 1.</li>
<li>
On the distribution server, map the login ID from the publication server to the login ID on the remote distributor. <p>
Map the login IDs using <b>sp_addremotelogin</b>. For example, if the publication server is named AIREDALE, the login ID on the distribution server is <i>peggysue</i>, and the login ID of the DBO of the publication database is <i>peggy</i>, you would type:
<pre>sp_addremotelogin AIREDALE, 'peggysue', 'peggy'
</pre>
</li>
<li>
On the distribution server, set the trusted remote login option to use integrated security.<p>
Set the remote login option using <b>sp_remoteoption</b>. For the above example, you would type: 
<pre>sp_remoteoption AIREDALE, 'peggysue', 'peggy', 'trusted', true
</pre>
</li>
</ol>
<p>
If several users in the publication database are aliased to DBO, this must be repeated for each aliased user. In this case, instead of creating a database user for each one, you could alias all the users to one user in the <i>msdb</i> database, and to one user in the <i>distribution</i> database.</p>
<p>
For detailed information about setting up database users, see Chapter 9, <a href="admn09_8ozd.htm">Managing Security</a>. For information about setting up remote logins, see Chapter 10, <a href="admn10_1qpf.htm">Remote Servers and Users</a>. </p>

<h5><a name="_a_dbo_on_a_subscription_server"></a>A DBO on a Subscription Server</h5>
<p>
To allow the DBO of a destination database to manage subscriptions, you must use <b>sp_addremotelogin</b> to map the login ID of the DBO on the subscriber to the <b>repl_subscriber</b> login ID on the publisher. This mapping is performed on the publication server. To use integrated security, the trusted remote login option must then be set using <b>sp_remoteoption</b>.</p>
<p>
This must be repeated for each publication server that the destination database will subscribe from. If several users in that destination database are aliased to DBO, this must be repeated once for each aliased user.</p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To set up permissions allowing the DBO of a destination database on a subscription server to subscribe to the publications from a publication server</h5>
<ul>
<li>
On the publication server, type<p>
<b>sp_addremotelogin</b> <i>remoteserver</i>, '<b>repl_subscriber</b>', '<i>loginID</i>'
<p>
where
<dl>
<dt>
<i>remoteserver</i></dt>
<dd>
Is the name of the subscription server. (From the perspective of the publication server that is being administered, the subscriber is a remote server.)</dd>
<dt>
<b>repl_subscriber</b></dt>
<dd>
Is the login ID on the local server. (In this case, it is the special <b>repl_subscriber</b> login ID on the publication server.)</dd>
<dt>
<i>loginID</i></dt>
<dd>
Is the login ID on the subscriber. (The login ID of the user who is DBO of the destination database.)
</dd>
</dl>
<p>
For example:
<pre>sp_addremotelogin TERRIER, 'repl_subscriber', 'delaney' </pre>
</li>
</ul>
<pre></pre>
<p class=indent1>
Then type:</p>
<p class=indent1>
<b>sp_remoteoption</b> <i>remoteserver</i>, '<b>repl_subscriber</b>', '<i>loginID</i>', 'trusted', 'true'</p>
<p class=indent1>
For example:</p>
<pre>sp_remoteoption TERRIER, 'repl_subscriber', 'delaney', 'trusted', 'true'
</pre>
<p>
For more information about setting up remote logins, see Chapter 10, <a href="admn10_1qpf.htm">Remote Servers and Users</a>. </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
