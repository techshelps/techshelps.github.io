<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Expanding or Shrinking Databases</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_expanding_or_shrinking_databases"></a>Expanding or Shrinking Databases</h1>
<p>
To <i>expand</i> a database is to allocate additional device space to the database. If a database grows so that it uses most or all of the space allocated for it, you can expand it.</p>
<p>
You expand a database using SQL Enterprise Manager or the ALTER DATABASE statement. This chapter describes the use of SQL Enterprise Manager. For information about using ALTER DATABASE and other statements, see the <i>Microsoft SQL Server Transact-SQL Reference</i>. </p>
<p>
You can expand a database by allocating more space on its existing device or by allocating space on another device. A database can occupy more than one database device with different amounts of space on each. When expanding a database, you must increase the size of the database by at least 1 MB. Permission for expanding a database defaults to the database owner and is automatically transferred with database ownership. For information on permissions and database ownership, see Chapter 8, <a href="admn08_25tf.htm">Security Concepts</a>. </p>
<p>
You cannot expand the <i>master</i> database on any device other than MASTER. If the <i>master</i> database requires more space, you can use SQL Enterprise Manager or the DISK RESIZE statement to increase the size of the MASTER device, and then expand the master database on the MASTER device. For information on expanding a device, see Chapter 5, <a href="admn05_0tgz.htm">Managing Devices</a>. </p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To expand a database</h5>
<ol>
<li>
From the Server Manager window, select a server, and then from the toolbar, choose the Manage Databases button.<p>
<img src="images/db01.gif" border=0>
<p>
The Manage Databases window appears.
</li>
<li>
Select a database name, and then choose the Edit Database button.<p>
<img src="images/db04.gif" border=0>
<p>
The Edit Database window appears.
<p>
<img src="images/ad06_602.gif" border=0>
<p>
Under Information, the Size field shows the amount of space allocated to the database, and the Space Available field shows the amount of unused allocated space.
</li>
<li>
Choose the Expand button.<p>
The Expand Database dialog box appears.
<p>
<img src="images/ad06_605.gif" border=0>
</li>
<li>
From the list in the Data Device box, select a database device on which to expand the database. Or to create a new device for the database expansion, select <b>&lt;new&gt;</b> and complete the New Database Device dialog box that appears.<p>
Refer to the graph at the bottom of the dialog box for a display of the devices on the server, and the available space on each.
</li>
<li>
In the Data Device Size box, type a size, in megabytes, to allocate to the database. <p>
If this is a device the database already has space on, enter the amount of additional space to allocate (not the total space). The default is the maximum space available on the selected device.
</li>
<li>
Choose OK.<p>
The Edit Database window returns.
</li>
<li>
Choose OK.</li>
</ol>
<p>
<b>Note</b>  While the database is expanded, the transaction log can also be expanded. For information about expanding transaction logs, see <a href="admn06_4zoz.htm">Expanding or Moving Transaction Logs</a>, next in this chapter. </p>
<p>
You can also expand the <i>tempdb</i> database, including <i>tempdb in ram</i>. However, when <i>tempdb</i> resides in RAM, it can only be altered 10 times without requiring the server to be shut down and restarted. Altering <i>tempdb</i> while it is in RAM causes each alteration of the database to allocate a new "chunk" of contiguous memory to <i>tempdb</i>. This memory, although it is contiguous, is not necessarily located next to the existing portion(s) of <i>tempdb</i> in RAM. To obtain maximum performance, the server should be stopped and restarted after <i>tempdb</i> is altered. For information about <i>tempdb</i> and <i>tempdb in ram</i>, see the <i>Microsoft SQL Server Transact-SQL Reference</i>.</p>
<p>
If a database has been allocated unused space that you would like to recapture, you can shrink the database. In order to shrink a database, the database must be in single-user mode, but SQL Enterprise Manager sets this option automatically for you while it is shrinking the database.</p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To shrink a database</h5>
<ol>
<li>
From the Server Manager window, select a server, and then from the toolbar, choose the Manage Databases button.<p>
<img src="images/db01.gif" border=0>
<p>
The Manage Databases window appears.
</li>
<li>
Select a database name, and then choose the Edit Database button.<p>
<img src="images/db04.gif" border=0>
<p>
The Edit Database window appears.
<p>
<img src="images/ad06_602.gif" border=0>
<p>
Under Information, the Size field shows the amount of space allocated to the database, and the Space Available field shows the amount of unused allocated space.
</li>
<li>
Choose the Shrink button. <p>
A message appears, informing you that the database will be set to single-user mode during the shrink operation, and asking whether or not to continue.
</li>
<li>
Choose Yes.<p>
The Shrink Database dialog box appears. 
<p>
<img src="images/ad06_604.gif" border=0>
<p>
There may be a delay before the minimum size is shown.
</li>
<li>
Enter a smaller size in the Database Size (MB) box, and then choose the OK button. <p>
The database is set to single-user mode, the database is shrunk, and then the single-user setting is cleared. The Edit Database window returns.
</li>
<li>
Choose OK.</li>
</ol>
<p>
You can also reduce the allocated space using DBCC SHRINKDB. To shrink the <i>master</i> or <i>tempdb</i> databases you must start the server in single-user mode (use the <b>sqlservr</b> command-line executable with the <b>-m</b> parameter) and use the DBCC SHRINKDB command. For information, see the <i>Microsoft SQL Server Transact-SQL Reference</i>.</p>
<p>
<b>Note</b>  After you expand or shrink a database, back up the <i>master</i> database.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
