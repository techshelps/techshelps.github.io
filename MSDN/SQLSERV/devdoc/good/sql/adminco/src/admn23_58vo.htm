<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The update mode is direct</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_the_update_mode_is_direct"></a>The update mode is direct</h2>
<p>
Whenever possible, SQL Server attempts to use the direct method of applying updates to tables because it is faster and requires fewer log records to be generated than the deferred method. Depending on the type of statement, certain criteria must be met in order for SQL Server to perform the update using the direct method. Those criteria are:</p>
<h5>Rules for an Update-In-Place</h5>
<p>
In SQL Server 6.0, various techniques are used to determine whether or not an UPDATE can be performed "in-place." When an "update-in-place" occurs, the overall performance of the UPDATE statement is improved because the update is direct (only the row modifications to the page are logged). The decision as to whether or not an update-in-place can occur is based on the following requirements. If these requirements are not true, a deferred update will take place. A deferred update is a delete followed by an insert.
<ul>
<li>
The UPDATE cannot affect the column(s) that participates in a clustered index.</li>
<li>
The table cannot have an UPDATE trigger.</li>
<li>
The table cannot be marked for replication.</li>
<li>
For single-row updates:<ul>
<li>
The updated column(s) can be variable length, but the new total row size must fit on the same page as the old row.</li>
<li>
The updated column(s) can participate in a nonunique nonclustered index only if the index key is a fixed-width column.</li>
<li>
The updated column(s) can participate in a unique nonclustered index only if the index key is fixed-width and the WHERE clause criteria must have an exact match (based on an unique index match¾the index could be the same as the updated column).</li>
<li>
The new row cannot include differing bytes by more than 50 percent of the original row size, and the total number of discontiguous differing bytes is not more than 24.</li>
</ul>
</li>
<li>
For multirow updates:<ul>
<li>
The updated column must be fixed length.</li>
<li>
The updated column cannot participate in a unique nonclustered index.</li>
<li>
The updated column can participate in a nonunique nonclustered index only if the column is a fixed-width column (the index used to find rows cannot be the same as the updated column).</li>
<li>
The table cannot include a column with the <i>timestamp </i>datatype.</li>
</ul>
</li>
</ul>
<p>
To see the update strategy used (DIRECT or DEFERRED), set the SHOWPLAN session setting. For details, see the SET statement.</p>
<h4>Query 1:</h4>
<pre>UPDATE titles
SET price = $5.99
WHERE title_id = 'BU2075'
</pre>
<h4>SHOWPLAN 1:</h4>
<pre>STEP 1
The type of query is UPDATE
The update mode is direct
FROM TABLE
titles
Nested iteration
Using Clustered Index
TO TABLE
titles

</pre>
<h4>Query 2:</h4>
<pre>UPDATE titles
SET price = $5.99
WHERE title_id like 'BU%'
</pre>
<h4>SHOWPLAN 2:</h4>
<pre>STEP 1
The type of query is UPDATE
The update mode is deferred
FROM TABLE
titles
Nested iteration
Using Clustered Index
TO TABLE
titles
</pre>
<p>
Note that the only difference between Query 1 and Query 2 is qualification of the WHERE clause. In both queries, the column being updated allows nulls. In Query 1, no more than one row is guaranteed to qualify because of the unique clustered index on the <i>title_id </i>column. Therefore, the direct method can be used for the update. In Query 2, multiple rows may qualify for the update, and since the updated column allows nulls the deferred method must be used.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
