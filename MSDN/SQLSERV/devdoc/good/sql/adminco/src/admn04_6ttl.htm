<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting the Default Net-Library</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_setting_the_default_net_library"></a>Setting the Default Net-Library</h2>
<p>
When you install SQL Server client utilities on a workstation you can specify the client's default Net-Library, which supports communication between the client and SQL Server. (The <b>setup</b> program's default is to set the Named Pipes Net-Library as the default.) However, if after installation you determine that the client will be regularly connecting to a server that is not configured to support the client's default interprocess communication (IPC) mechanism (for example, NWLink IPX/SPX), after installation you can change the client's default Net-Library. 
<ul>
<li>
For Windows NT-, Windows 95-, and Windows-based clients, change the default Net-Library by using the SQL Client Configuration Utility. </li>
<li>
For MS-DOS - based clients, change the default Net-Library by loading a different Net-Library TSR program.</li>
</ul>
<p>
The following table lists the SQL Server client Net-Libraries for the Windows NT, Windows 95, Windows, and MS-DOS operating systems:</p>
<table cellspacing=4 cols=5>
<tr valign=top>
<th align=left width=21%></th>
<th align=left width=26%></th>
<th align=left width=25%></th>
<th align=left width=27%></th>
</tr>
<tr valign=top>
<th align=left width=21%></th>
<th align=left width=26%></th>
<th align=left width=25%></th>
<th align=left width=27%></th>
</tr>
<tr valign=top>
<th align=left width=21%><br>
Net-Library</th>
<th align=left width=26%>Windows NT <br>
or Windows 95</th>
<th align=left width=25%><br>
Windows  (1) </th>
<th align=left width=27%><br>
MS-DOS</th>
</tr>
<tr valign=top>
<td width=21%></td>
<td width=26%></td>
<td width=25%></td>
<td width=27%></td>
</tr>
<tr valign=top>
<td width=21%>Named Pipes</td>
<td width=26%>DBNMPNTW.DLL</td>
<td width=25%>DBNMP3.DLL</td>
<td width=27%>DBNMPIPE.EXE</td>
</tr>
<tr valign=top>
<td width=21%>NWLink IPX/SPX</td>
<td width=26%>DBMSSPXN.DLL</td>
<td width=25%>DBMSSPX3.DLL</td>
<td width=27%>DBMSSPX.EXE</td>
</tr>
<tr valign=top>
<td width=21%>Banyan VINES</td>
<td width=26%>DBMSVINN.DLL</td>
<td width=25%>DBMSVIN3.DLL</td>
<td width=27%>DBMSVINE.EXE</td>
</tr>
<tr valign=top>
<td width=21%>TCP/IP Sockets</td>
<td width=26%>DBMSSOCN.DLL</td>
<td width=25%>DBMSSOC3.DLL</td>
<td width=27%>Not available</td>
</tr>
<tr valign=top>
<td width=21%>Multi-Protocol</td>
<td width=26%>DBMSRPCN.DLL</td>
<td width=25%>DBMSRPC3.DLL (2) </td>
<td width=27%>Not available</td>
</tr>
<tr valign=top>
<td colspan=5 width=100%>(1)&nbsp;&nbsp;&nbsp;&nbsp;16-bit Windows: Microsoft Windows 3.11 and Microsoft Windows for Workgroups.<p>
(2)&nbsp;&nbsp;&nbsp;&nbsp;The Multi-Protocol Net-Library used by Windows-based clients (DBMSRPC3.DLL) also <br>
&nbsp;&nbsp;&nbsp;&nbsp;uses the following runtime DLLs: RPCNS1.DLL, RPCRT1.DLL, RPC16C3.DLL, <br>
&nbsp;&nbsp;&nbsp;&nbsp;RPC16C1.DLL, RPC16DG3.DLL, RPC16C4.DLL, RPC16C5.DLL, RPC16C6.DLL, <br>
&nbsp;&nbsp;&nbsp;&nbsp;RPC16DG6.DLL and SECURITY.DLL. These are provided with SQL Server and <br>
&nbsp;&nbsp;&nbsp;&nbsp;installed by the <b>setup</b> program as Net-Libraries.</p>
</td>
</tr>
</table><br>
<p>
Connection limits for each of these Net-Libraries are shown in the following table:</p>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=23%></th>
<th align=left width=25%></th>
<th align=left width=27%></th>
<th align=left width=25%></th>
</tr>
<tr valign=top>
<th align=left width=23%></th>
<th align=left width=25%></th>
<th align=left width=27%></th>
<th align=left width=25%></th>
</tr>
<tr valign=top>
<th align=left width=23%><br>
Net-Library</th>
<th align=left width=25%>Windows NT <br>
or Windows 95</th>
<th align=left width=27%><br>
Windows</th>
<th align=left width=25%><br>
MS-DOS</th>
</tr>
<tr valign=top>
<td width=23%></td>
<td width=25%></td>
<td width=27%></td>
<td width=25%></td>
</tr>
<tr valign=top>
<td width=23%>Named Pipes</td>
<td width=25%>No limit  (1) </td>
<td width=27%>34  (2) </td>
<td width=25%>15  (3) </td>
</tr>
<tr valign=top>
<td width=23%>NWLink IPX/SPX</td>
<td width=25%>No limit  (1) </td>
<td width=27%>25  (2,4) </td>
<td width=25%>15  (5) </td>
</tr>
<tr valign=top>
<td width=23%>Banyan VINES</td>
<td width=25%>No limit  (1) </td>
<td width=27%>15</td>
<td width=25%>15</td>
</tr>
<tr valign=top>
<td width=23%>TCP/IP Sockets</td>
<td width=25%>No limit  (1) </td>
<td width=27%>6</td>
<td width=25%>N/A</td>
</tr>
<tr valign=top>
<td width=23%>Multi-Protocol</td>
<td width=25%>No limit  (1) </td>
<td width=27%>No limit (6) </td>
<td width=25%>N/A</td>
</tr>
<tr valign=top>
<td colspan=4 width=100%>(1) &nbsp;&nbsp;&nbsp;&nbsp;Limited only by operating-system memory resources.<p>
(2) &nbsp;&nbsp;&nbsp;&nbsp;Might vary with different versions of DB-Library and the Net-Library (due to <br>
&nbsp;&nbsp;&nbsp;&nbsp;possible differences in the sizes of some internal data structures).</p>
<p>
(3)&nbsp;&nbsp;&nbsp;&nbsp;Limited by the number of available MS-DOS file handles.</p>
<p>
(4)&nbsp;&nbsp;&nbsp;&nbsp;The Windows-based client Net-Libraries use one IPX socket per connection and one <br>
&nbsp;&nbsp;&nbsp;&nbsp;to three SPX sessions per connection. To achieve the maximum number of connections, <br>
&nbsp;&nbsp;&nbsp;&nbsp;set the IPX Sockets parameter to 32 and the SPX Connections parameter to 96 in the <br>
&nbsp;&nbsp;&nbsp;&nbsp;SHELL.CFG file. You may also need to change the Novell NET.CFG file.</p>
<p>
(5)&nbsp;&nbsp;&nbsp;&nbsp;The MS-DOS - based client Net-Libraries use one IPX socket per connection and one to <br>
&nbsp;&nbsp;&nbsp;&nbsp;three SPX sessions per connection. To achieve the maximum number of connections, <br>
&nbsp;&nbsp;&nbsp;&nbsp;set the IPX Sockets parameter to 22 and the SPX Connections parameter to 66 in the <br>
&nbsp;&nbsp;&nbsp;&nbsp;SHELL.CFG file.</p>
<p>
(6)&nbsp;&nbsp;&nbsp;&nbsp;Limit is determined by the underlying protocol that is being used.</p>
</td>
</tr>
</table><br>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To set the default Net-Library for Windows NT- or Windows 95-based clients</h5>
<ol>
<li>
Start the SQL Client Configuration Utility as described in <a href="admn04_00ah.htm">Starting the Client Configuration Utility</a>, earlier in this chapter.<p>
The SQL Client Configuration Utility window appears.
</li>
<li>
Choose the Net-Library tab.<p>
<img src="images/ad04_211.gif" border=0>
</li>
<li>
From the list in the Default Network box, select a Net-Library.</li>
<li>
Choose the Done button.</li>
</ol>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To set the default Net-Library for Windows-based clients</h5>
<ol>
<li>
From the SQL Server Tools program group, double-click the SQL Client Configuration Utility icon.<p>
<img src="images/ad04_214.gif" border=0>
<p>
The SQL Client Configuration Utility window appears.
<p>
<img src="images/ad04_215.gif" border=0>
</li>
<li>
From the list in the Default Network box, select a Net-Library.</li>
<li>
Choose the Change button.</li>
<li>
Choose the Done button.</li>
</ol>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To set the default Net-Library for MS-DOS - based clients</h5>
<ul>
<li>
Using a text editor, edit the computer's AUTOEXEC.BAT file so that it loads the appropriate Net-Library TSR at system startup.</li>
</ul>
<p>
MS-DOS - based clients use terminate-and-stay-resident (TSR) programs to communicate with the underlying network layer. Only one Net-Library TSR can be loaded at a time. These TSR programs are included with the client software for MS-DOS - based clients: :
<ul>
<li>
Named Pipes (DBNMPIPE.EXE)</li>
<li>
Novell SPX (DBMSSPX.EXE)</li>
<li>
Banyan VINES (DBMSVINE.EXE)</li>
</ul>
<p>
Note that MS-DOS-based clients do not support TCP/IP sockets and Multi-Protocol.</p>
<p>
During installation, the <b>setup</b> program gives you the option of selecting one of the TSR programs for automatic loading every time the operating system starts, and of adding the \SQL\BIN directory to the system path. If you do not select this <b>setup</b> option, you will need to load the TSR manually. You may also need to make sure the \SQL\BIN directory is in the path.</p>
<p>
A TSR can be manually loaded by typing its executable name from a command prompt (for example, type <b>dbnmpipe</b>). </p>
<p>
Since only one TSR can loaded at once, a loaded TSR must be unloaded before a different TSR can be loaded. To stop a loaded TSR, run the ENDDBLIB.EXE utility (from a command prompt, type <b>enddblib</b>).</p>
<p>
You can also set the default MS-DOS Net-Library by editing the AUTOEXEC.BAT file.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
