<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Error 1505</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_error_1505"></a>Error 1505</h1>
<h4>Severity Level 14</h4>
<h4>Message Text</h4>
<pre>Create unique index aborted on duplicate key. Primary key is '%S_KEY'
</pre>
<h4>Explanation</h4>
<p>
This error occurs when you attempt to create a unique index and more than one row contains the duplicate value. SQL Server has detected a uniqueness violation and cancels the create index operation.</p>
<p>
For example, the creation for the index below would be canceled due to the uniqueness violation at row 3. The DORR ROBERT combination is already located in row 1.</p>
<table cellspacing=4 cols=5>
<tr valign=top>
<td width=14%><pre>TABLE:</pre>
</td>
<td width=23%><pre>tblTest</pre>
</td>
</tr>
<tr valign=top>
<td width=14%><pre><u>Row</u></pre>
</td>
<td width=23%><pre><u>strLastName</u></pre>
</td>
<td width=25%><pre><u>strFirstName</u></pre>
</td>
<td width=18%><pre><u>strCity</u></pre>
</td>
<td width=20%><pre><u>strState</u></pre>
</td>
</tr>
<tr valign=top>
<td width=14%><pre>1</pre>
</td>
<td width=23%><pre>DORR</pre>
</td>
<td width=25%><pre>ROBERT</pre>
</td>
<td width=18%><pre>IRVING</pre>
</td>
<td width=20%><pre>TX</pre>
</td>
</tr>
<tr valign=top>
<td width=14%><pre>2</pre>
</td>
<td width=23%><pre>DEDECKER</pre>
</td>
<td width=25%><pre>TODD</pre>
</td>
<td width=18%><pre>LEWISVILLE</pre>
</td>
<td width=20%><pre>TX</pre>
</td>
</tr>
<tr valign=top>
<td width=14%><pre>3</pre>
</td>
<td width=23%><pre><i>DORR</i></pre>
</td>
<td width=25%><pre><i>ROBERT</i></pre>
</td>
<td width=18%><pre>PLANO</pre>
</td>
<td width=20%><pre>TX</pre>
</td>
</tr>
<tr valign=top>
<td width=14%><pre>4</pre>
</td>
<td width=23%><pre>SCOTT</pre>
</td>
<td width=25%><pre>HULKE</pre>
</td>
<td width=18%><pre>PLANO</pre>
</td>
<td width=20%><pre>TX</pre>
</td>
</tr>
</table><br>
<pre>create unique nonclustered index
idxUniqueNames ON
tblText(strLastName, strFirstName)</pre>
<h4>Action</h4>
<p>
You must review your index objective. If your index does not need to be unique, remove the UNIQUE keyword and reissue the create index statement. However, if you still want to create a unique index, you must query the table in question and remove the rows in error. For more detailed information on the create index statement, see the <i>Microsoft SQL Server Transact-SQL Reference</i>.</p>
<p>
To find the duplicate rows, issue a GROUP BY statement:</p>
<pre>SELECT * FROM tblTest
GROUP BY strLastName, strFirstName</pre>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
