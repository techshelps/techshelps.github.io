<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Example of Splitting a Table Across Segments</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_example_of_splitting_a_table_across_segments"></a>Example of Splitting a Table Across Segments</h2>
<p>
You can improve performance for high-volume multiuser applications by splitting large tables across segments located on separate physical disks.</p>
<p>
<b>Note</b>  If the table is updated frequently, the balance of disk allocation can change over time. To guarantee that the speed advantages are maintained, it may be necessary to drop and re-create the table.</p>
<p>
The following example shows how to split a table across two segments. This example uses a database called <i>mydata</i> and a table called <i>riff</i> to represent the user database and the table being split:
<ol>
<li>
Select physical devices to use. In this example, the physical devices are C:\SQL60\DATA\MYDEV1.DAT and D:\DATA\MYDEV2.DAT.</li>
<li>
Switch to the <i>master</i> database:<pre>use master</pre>
</li>
<li>
Add the devices <i>mydisk1 </i>and <i>mydisk2</i>. Allocate 4 MB for <i>mydisk1 </i>and 2 MB for <i>mydisk2</i>:<pre>DISK INIT
NAME = 'mydisk1', 
PHYSNAME = 'C:\sql60\data\mydev1.dat',
VDEVNO = 7, 
SIZE = 2048
DISK INIT 

NAME = 'mydisk2', 
PHYSNAME = 'D:\sql60\data\mydev2.dat', 
VDEVNO = 8, 
SIZE = 1024 </pre>
</li>
<li>
Allocate additional storage space for the database by adding the <i>mydisk1</i> and <i>mydisk2</i> devices to <i>mydata</i>:<pre>alter database mydata
on mydisk1 = 4, 
mydisk2 = 2  </pre>
</li>
<li>
Switch to the <i>mydata</i> database:<pre>use mydata</pre>
</li>
<li>
Add a segment to <i>mydisk1</i> and a segment to <i>mydisk2</i>:<pre>sp_addsegment seg_mydisk1, mydisk1 
&lt;execute&gt;
sp_addsegment seg_mydisk2, mydisk2
&lt;execute&gt;</pre>
</li>
<li>
Create a third segment called <i>seg_bothdisks</i> and extend it to span both <i>mydisk1 </i>and <i>mydisk2</i>:<pre>sp_addsegment seg_bothdisks, mydisk1
&lt;execute&gt;
sp_extendsegment seg_bothdisks, mydisk2
&lt;execute&gt;</pre>
</li>
<li>
Drop the SYSTEM and DEFAULT segments from the new devices:<pre>sp_dropsegment 'default', mydisk1 
&lt;execute&gt;
sp_dropsegment system, mydisk1
&lt;execute&gt;
sp_dropsegment 'default', mydisk2 
&lt;execute&gt;
sp_dropsegment system, mydisk2
&lt;execute&gt;</pre>
</li>
<li>
Create the table and clustered index on the <i>seg_mydisk1</i> segment.<pre>create table riff (ri_id id, ri_lname varchar(40), 
  ri_fname varchar(20), phone char(12), address varchar(40), 
  city varchar(20), state char(2), zip char(5), contract bit) 
  on seg_mydisk1 
create clustered index ri_index 
  on riff(au_id) on seg_mydisk1</pre>
<p>
In this case, the table is <i>riff</i> and the clustered index is <i>ri_index</i>.
</li>
<li>
Use the <b>bcp</b> utility to copy half of the rows into the <i>riff</i> table.</li>
<li>
Place the <i>riff</i> table on the second segment (<i>seg_mydisk</i>):<pre>sp_placeobject seg_mydisk2, riff</pre>
</li>
<li>
Use <b>bcp</b> to copy the rest of the rows.</li>
<li>
Place the <i>riff</i> table on the segment that spans both disks (<i>seg_bothdisks</i>):<pre>sp_placeobject seg_bothdisks, riff</pre>
<p>
<b>Important</b>  You must create the clustered index before the table is placed on the second segment. If you create the clustered index after the table is placed on the second segment, both the table and the index move to the second segment. If you create the index after creating <i>seg_bothdisks</i>, the allocation of disk space is unpredictable. 
</li>
</ol>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
