<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Defining Articles</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_defining_articles"></a>Defining Articles</h2>
<p>
A published table is called an article. You have a number of options for controlling the way a table is published. An article can be the entire table or a subset of columns and/or rows from the table.</p>
<p>
For each article, you can set the article name, article description, and destination table name; exclude rows and columns from those published (horizontal and vertical partitioning); customize the synchronization schema script; and customize the data replication mechanism. You accomplish these tasks by using the Manage Article dialog box. </p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To define an article</h5>
<ol>
<li>
While creating a publication, from the Edit Publications dialog box, select the Article tab; from the Articles in Publication list, select an article; and then choose the Edit button.<p>
For information about how to access the Edit Publications dialog box, see <a href="admn14_92pf.htm">Creating Publications</a>, earlier in this chapter.
<p>
The Manage Article dialog box appears.
<p>
<img src="images/ad14_911.gif" border=0>
</li>
<li>
To change the default name supplied for the article, type a new name in the Name box.</li>
<li>
To provide a description of this article, type it in the Description box.<p>
A description can be up to 255 characters.
</li>
<li>
To change the default name supplied for the destination table, type a table name in the Destination Table box.</li>
<li>
To partition the article vertically or horizontally, select the Filters tab.</li>
<li>
To partition the article vertically¾so that only selected columns are replicated¾select the Replicate option box for each column to be replicated. Clear the Replicate option box for each column that will not be replicated.<p>
If you do not modify the default settings, all columns are replicated. You must replicate the primary key column.
</li>
<li>
To partition the article horizontally¾so that only selected rows are replicated¾type a WHERE clause in the Restriction Clause box.<p>
For example, if you have published the <i>authors</i> table from the <i>pubs</i> database and are editing the <i>authors</i> article, you could replicate only those rows containing authors from California by typing:
<pre>state = 'CA'
</pre>
</li>
<li>
To customize the data replication mechanism or the synchronization schema script, select the Scripts tab.<p>
<img src="images/ad14_912.gif" border=0>
</li>
<li>
Define the data replication mechanism.<p>
Usually, you will not change this from the default. The data replication mechanism determines the action SQL Server takes when the log reader process encounters transactions (INSERT, UPDATE, or DELETE) that are marked for replication in the transaction log of the publication database.
<ul>
<li>
To use the default, do not change the selected options for the INSERT Command, UPDATE Command, and DELETE Command. <p>
When the log reader process encounters a transaction of one of these types (INSERT, UPDATE, or DELETE) that is marked for replication in the transaction log of the publication database, the SQL statement will be reconstructed and applied to the destination database. This is the default data replication mechanism used by SQL Server replication.
</li>
<li>
To specify custom processing for one or more of the command types (INSERT, UPDATE, or DELETE), choose the Custom option, and then enter a custom command in the Custom box. There are two possible custom commands.<p>
If you enter <b>NONE</b>, transactions of that type will not be replicated. For example, if for DELETE you choose the Custom option, and type <b>NONE</b>, then DELETE commands will not be replicated.
<p>
If you enter <b>CALL</b> <i>stored_procedure_name</i> (for example, if you type <b>CALL MYPROC</b>), when the log reader encounters a command of that type (INSERT, DELETE, or UPDATE) in a transaction marked for replication, it will pass column parameters from that transaction to the referenced stored procedure. The referenced stored procedure must exist in the destination database of each subscriber.
<p>
For information about creating your own stored procedures to be called when INSERT, DELETE, or UPDATE statements are encountered by the log reader, see Chapter 15, <a href="admn15_738u.htm">Advanced Replication</a>. 
</li>
</ul>
</li>
<li>
To allow SQL Server to automatically create the initial table synchronization schema script for you, leave the Creation Script box blank.<p>
When you edit a new article, this box is empty. When you edit an existing article, this box contains the full path to the schema script in the distribution working directory. For example:
<pre>\\TERRIER\C$\SQL60\REPLDATA\terrier_sales_receipts_charges.sch
</pre>
<p>
Schema scripts are automatically generated when a publication is created or modified (by choosing the Add or Modify button from the Edit Publications dialog box).
</li>
<li>
To edit an existing schema creation script, choose Edit, edit the creation script in the Creation Script dialog box that appears, and then choose OK.<p>
<img src="images/ad14_914.gif" border=0>
<p>
The Manage Article dialog box returns.
</li>
<li>
To generate a schema script now, choose the Generate button and complete the Auto-Generate Sync Scripts dialog box that appears.<p>
<img src="images/ad14_915.gif" border=0>
<ul>
<li>
Select <i>Do Nothing</i> when you do not want to drop, truncate, or delete rows from the destination table before synchronization is applied. </li>
<li>
Select <i>DROP Table First</i> to drop the existing table before synchronization is applied.</li>
<li>
Select <i>Truncate Table Only</i> to remove all rows but leave the table structure in place before synchronization is applied.</li>
<li>
Select <i>Delete Data using Restriction Clause</i> to remove only the target rows (as defined by the restriction clause) before synchronization is applied.</li>
<li>
Select <i>Transfer Clustered Index</i> to create in the destination table the same clustered index that exists for the published table.</li>
<li>
Select <i>Transfer non-Clustered Index</i> to create in the destination table the same non-clustered indexes that exist for the published table.</li>
<li>
Select <i>Convert</i> <i>UDDT to base datatype</i> to convert user-defined datatypes from the published table to base datatypes in the destination table.</li>
<li>
Select <i>Include DRI-PK</i> to copy the declared primary key to the destination table.</li>
</ul>
<p>
When the options are set, choose Auto-Generate. The initial table synchronization schema script is created. The Manage Article dialog box returns.
</li>
<li>
To use a schema creation script that you have prepared manually, place that schema script in the distribution working directory, and then enter the full path and filename in the Creation Script box. For example:<pre>\\TERRIER\C$\SQL60\REPLDATA\terrier_sales_receipts_myschema.sch
</pre>
<p>
Note that you enter the full UNC path even if this is a combined publisher/distributor using its own local distribution working directory. Use the administrative share name (ending in "$") for the drive, rather than the drive letter.
</li>
<li>
To specify custom filtering, select the Advanced button and complete the Manage Article-Advanced dialog box that appears.<p>
<img src="images/ad14_103.gif" border=0>
<ul>
<li>
To specify a custom filter stored procedure, select a stored procedure from the list in the Filter Stored Procedure box.<p>
This is a filter stored procedure that you have previously created in the publication database. This stored procedure must take the form:
<p>
<b>IF</b> <i>sql_statement</i> <b>RETURN 1, ELSE RETURN 0</b>
<p>
where <i>sql_statement</i> is a Transact-SQL statement that accomplishes filtering. For example:
<pre>IF exists (select * from authors where city = 'Oakland')
   return 1
else
   return 0
</pre>
<p>
Because the filter is executed against every log record for the replicated table, the filter should be as simple as possible. This will minimize overhead. 
<p>
Any reference to the table will represent only a single log record value. 
</li>
<li>
To set the synchronization object to an object other than the default, select the object from the list in the Synchronization Object box. If you are setting up custom filtering, this will be a view you have created in the publication database.<p>
The Synchronization Object is the database object that is used as the source of the data for the initial synchronization of the destination table. In most cases, this is handled automatically by SQL Server and you do not need to change from the default. By default, the synchronization object is the article's base table. If the article has been horizontally and/or vertically partitioned, SQL Server automatically creates a view of the partitioned table, and by default that view becomes the synchronization object.
<p>
The Synchronization Object list includes all the tables and views in the publication database.
</li>
</ul>
<p>
When the options are set, choose OK. The Manage Article dialog box returns.
</li>
<li>
When the advanced article is defined, from the Manage Article dialog box, choose OK.<p>
The Edit Publications dialog box returns.
</li>
</ol>
<p>
If you create an auto-generated script that does not support the creation of indexes, then the synchronization task will use fast <b>bcp</b> as the initial synchronization method if the Select Into/Bulk Copy option is set in the destination database.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
