<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Certifying a Removable Media Database</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_certifying_a_removable_media_database"></a>Certifying a Removable Media Database</h2>
<p>
When database development is complete, use the <b>sp_certify_removable</b> stored procedure to prepare the database for distribution on removable media. This stored procedure checks that there are no user-created objects in the database, no permissions granted to users, that the SA is the DBO and the owner of all database objects, and that all fragments are contiguous and in sequence. It also truncates the transaction log, moves it to the system device, drops the log device, and sets the database to offline.</p>
<p>
The SA must be owner of the database and all database objects because SA is a known user who exists on all SQL Servers and can be counted on to exist when the database is later distributed and installed.</p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To certify that a database is configured properly for distribution on removable media</h5>
<ul>
<li>
Type:<p>
<b>sp_certify_removable</b> <i>dbname</i>[<b>, AUTO</b>]
<p>
where
<dl>
<dt>
<i>dbname</i></dt>
<dd>
Is the name of the database to be verified.</dd>
<dt>
<b>AUTO</b></dt>
<dd>
As necessary, gives ownership of the database and all database objects to the SA, and drops any user-created database users and any permissions they may have.</dd>
</dl>
</li>
</ul>
<p>
For example:</p>
<pre>sp_certify_removable inventory
</pre>
<p>
If the preceding indicates, for example, that user-created users exist in the database, you could then issue the stored procedure by using the <b>AUTO</b> option:</p>
<pre>sp_certify_removable inventory,AUTO
</pre>
<p>
If the database is configured properly, this stored procedure sets the database offline and returns information that will be required when the database is later installed using <b>sp_dbinstall</b>. It returns the physical and logical names and the size in megabytes of the system and data devices. Make a note of this information, and provide it¾along with the distribution disk¾to users who will be installing the removable media database. </p>
<p>
If you run this stored procedure without the <b>AUTO</b> option and it returns information indicating that the SA is not the DBO, that user-created objects exist, that the SA does not own all objects in the database, or that non-default permissions have been granted, then you have two choices. You can correct those conditions normally, using SQL Server tools and procedures, and then run <b>sp_certify_removable</b> again, or you can simply run <b>sp_certify_removable</b> by using the <b>AUTO</b> option.</p>
<p>
Note that this stored procedure only checks for users and user permissions. It is permissible to add groups to the database and to grant permissions to those groups.</p>
<p>
For more information about using <b>sp_certify_removable</b>, see the <a href="../../tsqlref/src/tsql18_3tr9.htm">sp_certify_removable System Stored Procedure</a> topic in the <i>Microsoft SQL Server Transact-SQL Reference</i>.</p>
<p>
Once the database has been certified, it can be copied, and then that master copy can be reproduced for distribution. Before reproducing the master copy onto distribution disks, you can compare files to ensure that the master copy is identical to the original. For example, to use the <b>fc</b> utility in Windows NT to compare the device files in two directories, you could type:</p>
<pre>fc  c:\sql60\data\remove\*.dat  e:\manu\*.dat
</pre>
<p>
For more information about the <b>fc</b> utility, see your documenatation for Windows NT.</p>
<p>
When the database is distributed, be sure to include the information returned by <b>sp_certify_removable</b> (the physical and logical names and the size, in megabytes, of the system and data devices). </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
