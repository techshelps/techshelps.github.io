<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLServer-Locks Object</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_sqlserver.2d.locks_object"></a>SQLServer-Locks Object</h3>
<p>
Locks are held on pages that are read or modified during a transaction to prevent problems that might arise from concurrent use of resources by multiple transactions. Minimizing locks increases concurrency, which can improve performance results. Although there are many ways to minimize locks, one method is to commit transactions as soon as you have completed them. (For information about concurrency, see the <i>Microsoft SQL Server Database Developer's Companion</i>.)</p>
<p>
SQL Server can hold several types of locks. In general, read operations acquire <i>shared locks</i>, and write operations acquire <i>exclusive locks</i>. <i>Update locks</i> are created at the page level and are acquired during the initial portion of an update operation when the pages are being read or by cursors opened with pessimistic concurrency. Update locks are compatible with shared locks. Later, if the pages are changed, the update locks are promoted to exclusive locks.</p>
<p>
SQL Server locks can be held on a table (table or intent), a page, or an extent. SQL Server tries to satisfy requests with <i>page locks</i> before acquiring <i>table locks</i>. However, if many page locks are held during the course of a transaction, SQL Server upgrades the lock to a table lock (shared or exclusive). The point at which escalation occurs is configurable with <b>sp_configure</b>. SQL Server obtains table locks when it suspects that a transaction might affect an entire table. Table locks provide a way of avoiding lock collisions at the page level.</p>
<p>
An <i>intent lock</i> indicates the intention to acquire a shared or exclusive lock on a data page. (An intent lock prevents another transaction from acquiring an exclusive lock on the table containing that page.) An <i>extent lock</i> is held on a group of eight database pages while they are being allocated or freed. Extent locks are set while a CREATE or DROP statement is running or while an INSERT statement that requires new data or index pages is running.</p>
<p>
In addition, some SQL Server locks are considered <i>blocking locks</i>. A blocking lock is a lock that blocks another process that needs to acquire a lock. As soon as the process that is causing the block finishes, the other process can move forward. </p>
<p>
For more information about locks, see the discussion about monitoring database integrity and optimizing databases in the <i>Microsoft SQL Server Database Developer's Companion</i>.</p>
<p>
The following statistics are included in the SQLServer-Locks object:
<dl>
<dt>
<b>Extent Locks</b> ¾ <b>Exclusive</b></dt>
<dd>
A count of exclusive extent locks.</dd>
<dt>
<b>Extent Locks</b> ¾ <b>Shared</b></dt>
<dd>
A count of shared extent locks.</dd>
<dt>
<b>Extent Locks</b> ¾ <b>Total</b></dt>
<dd>
A count of all extent locks.</dd>
<dt>
<b>Intent Locks</b> ¾ <b>Exclusive</b></dt>
<dd>
A count of exclusive intent locks.</dd>
<dt>
<b>Intent Locks ¾ Shared</b></dt>
<dd>
A count of shared intent locks.</dd>
<dt>
<b>Intent Locks ¾ Total</b></dt>
<dd>
A count of all intent locks.</dd>
<dt>
<b>Page Locks</b> ¾ <b>Exclusive</b></dt>
<dd>
A count of exclusive page locks.</dd>
<dt>
<b>Page Locks</b> ¾ <b>Shared</b></dt>
<dd>
A count of shared page locks.</dd>
<dt>
<b>Page Locks</b> ¾ <b>Total</b></dt>
<dd>
A count of all page locks.</dd>
<dt>
<b>Page Locks</b> ¾ <b>Update</b></dt>
<dd>
A count of update page locks.</dd>
<dt>
<b>Table Locks</b> ¾ <b>Exclusive</b></dt>
<dd>
A count of exclusive table locks.</dd>
<dt>
<b>Table Locks</b> ¾ <b>Shared</b></dt>
<dd>
A count of shared table locks.</dd>
<dt>
<b>Table Locks</b> ¾ <b>Total</b></dt>
<dd>
A count of all table locks.</dd>
<dt>
<b>Total Blocking Locks</b></dt>
<dd>
A count of all locks blocking other processes.</dd>
<dt>
<b>Total Exclusive Locks</b></dt>
<dd>
A count of all exclusive locks.</dd>
<dt>
<b>Total Locks</b></dt>
<dd>
A count of all locks being used by SQL Server.</dd>
<dt>
<b>Total Shared Locks</b></dt>
<dd>
A count of all shared locks.
</dd>
</dl>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
