<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding Remote Servers</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_adding_remote_servers"></a>Adding Remote Servers</h2>
<p>
To add a remote server, you must set up both the local server and the remote server. On the local server, you must add the server name of the remote server. On the remote server, you must add the server name of the local server. To do this, you use the <b>sp_addserver</b> system procedure to add entries to the <i>sysservers</i> system table. </p>
<p>
After you have added the remote server, you must reset certain configuration options on both the local and the remote server as described in <a href="admn10_5ysz.htm">Setting Configuration Options for Remote Servers</a>. </p>
<p>
Before you add a remote server, be sure that you can access the remote server as a client using <b>isql</b>. </p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To check that you can access the remote server</h5>
<ul>
<li>
On both the local and remote servers, type:<p>
<b>isql /Usa /P</b>sa_password<b> /S</b>servername
<p>
where
<dl>
<dt>
<i>sa_ password</i></dt>
<dd>
Is the system administrator's password.</dd>
<dt>
<i>servername</i></dt>
<dd>
Specifies the remote server to connect to.
</dd>
</dl>
</li>
</ul>
<p>
If you have difficulty connecting to the remote server, you can use the SQL Client Configuration Utility to configure access to the server. For more information about using the SQL Client Configuration Utility, see Chapter 4, <a href="admn04_904z.htm">Configuring Clients</a>. </p>
<p>
After you have verified that you can connect to the remote servers as a client, you can set up the servers for remote access. You must execute <b>sp_addserver</b> on both the local server and the remote server.</p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To add a remote server</h5>
<ul>
<li>
Type:<p>
<b>sp_addserver</b> <i>server_name </i>[<b>, local</b>]
<p>
where
<dl>
<dt>
<i>server_name</i></dt>
<dd>
Is the name of the server.</dd>
<dt>
<b>local</b></dt>
<dd>
Sets <i>server_name</i> as the @@SERVERNAME global variable. For Windows NT - based servers, the @@SERVERNAME global variable is set at installation to the computer name, so you will usually not need to use this option, (unless you decide you want to change the server name).
<p>
One reason to use the <b>local</b> option occurs when you are running both SQL Server 4.2 and SQL Server 6.0 servers at the same time on the same computer. In order to be supported by the graphical tools the servers must use different names. For example, if you want to use SQL Transfer Manager to transfer data between the two, each must use a different server name.

</dd>
</dl>
</li>
</ul>
<p>
For example, to add EXPENSES as a remote server for the ACCOUNTS server, from ACCOUNTS, type:</p>
<pre>sp_addserver expenses</pre>
<p>
From the remote server EXPENSES, type:</p>
<pre>sp_addserver accounts</pre>
<p>
When you add a new entry with <b>sp_addserver</b>, the <i>srvname</i> and <i>srvnetname</i> are entered in the <i>sysservers</i> table. The <i>srvname</i> is the name that users must supply when executing calls to remote procedures. The <i>srvnetname</i> is the server's network name. The <i>srvname</i> must be unique on each server; the <i>srvnetname</i> does not have to be unique. When you add a new server, the <i>srvname</i> and the <i>srvnetname</i> store the same value. </p>
<p>
In the <i>sysservers</i> table, a <i>srvstatus</i> of 0 indicates that the server is the local server, and 1 indicates the server is a remote server.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
