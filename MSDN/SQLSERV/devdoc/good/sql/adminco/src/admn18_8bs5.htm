<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Up a Mail Post Office</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_setting_up_a_mail_post_office"></a>Setting Up a Mail Post Office</h1>
<p>
The Windows NT Mail application provided with Windows NT has a client side and a mail-server side. The client side includes the Mail application, with its graphical user interface. The server side simply contains a directory structure known as the <i>post office</i> and has no programmatic components.</p>
<p>
The post office must reside on a shared network directory on a computer running Windows NT, and each Mail client must have access. The post office is a directory structure in which the main directory is called a <i>workgroup post office</i> (WGPO). All post office file manipulation is handed by the Mail client. The post office is a temporary message store, holding a message only until the Mail client computer retrieves it.</p>
<p>
Following are instructions for setting up a Windows NT Mail post office on a computer running the Windows NT Server operating system. The post office computer does not need to have SQL Server installed, although it can.</p>
<p>
<b>Note</b>  This procedure provides only the basic post office setup instructions. For detailed information about setting up Microsoft Windows NT Mail post offices, see your documentation for Windows NT or the <i>Microsoft Windows NT Resource Kit</i>.</p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To set up a Windows NT Mail post office</h5>
<ol>
<li>
From the Main program group, double-click the Mail icon.<p>
<img src="images/ad18_08.gif" border=0>
<p>
The Welcome to Mail dialog box appears.
<p>
<img src="images/ad18_02.gif" border=0>
</li>
<li>
Select the option Create New Workgroup Postoffice, and then choose OK.<p>
A confirmation dialog box appears.
<p>
<img src="images/ad18_04.gif" border=0>
</li>
<li>
Choose Yes in the confirmation dialog box.<p>
The Create Workgroup Postoffice dialog box appears.
<p>
<img src="images/ad18_05.gif" border=0>
</li>
<li>
Select the drive and directory where the post office files will be installed, and then choose OK.<p>
The Enter Your Administrator Account Details dialog box appears.
<p>
<img src="images/ad18_06.gif" border=0>
</li>
<li>
Define a mail login account that you will use to administer this post office. At a minimum, enter a name, mailbox, and password. <dl>
<dt>
<b>Name </b></dt>
<dd>
Is the full name of the mail user. For example: 
<pre>Peggy Sue Haimbach
</pre>
</dd>
<dt>
<b>Mailbox</b></dt>
<dd>
Is a mail login (email name) that will be used to log onto the post office. For example:
<pre>peggysh
</pre>
</dd>
<dt>
<b>Password</b></dt>
<dd>
Is a password for the mail login. For example:
<pre>royce90
</pre>
</dd>
</dl>
</li>
<li>
Choose OK.<p>
The post office is created, the mail login for the post office administrator is created, and a message appears telling you to create a shared network directory for that post office.
<p>
<img src="images/ad18_07.gif" border=0>
</li>
<li>
Choose OK.<p>
The Mail window appears.
</li>
<li>
To add mail users, from the Mail menu choose Postoffice Manager, and complete the Postoffice Manager dialog box that appears.<p>
For more information about adding Mail users, see your documentation for Windows NT.
</li>
</ol>
<p>
After the Mail post office is installed, you must create a shared network directory for that post office. You can do this from the command line or from File Manager. The following procedure tells you how to do this from File Manager. For information on accomplishing this from the command line, see your documentation for Windows NT.</p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create a shared network directory for the post office</h5>
<ol>
<li>
From the Main program group, start File Manager<p>
<img src="images/ad18_12.gif" border=0>
</li>
<li>
In the File Manager window, select the post office directory.</li>
<li>
From the Disk menu, choose Share As, and complete the dialog box that appears.<p>
For more information, see the online Help for File Manager.
</li>
</ol>
<p>
When setting up the shared network directory, ensure that the SQL Server service and all Mail clients have RWCD access to the post office share. If a SQL Server is running under the LocalSystem account, this will require that the post office share grant these rights to EVERYONE if the SQL Server is on the same domain as the post office server, and to GUEST if it is not.</p>
<p>
If the post office share is on an NTFS drive, permissions must be set for both the network share and the directory. For information on setting share and directory permissions, see the online Help for File Manager.</p>
<p>
If the post office resides on a computer running Windows NT Server version 3.5 or later and MSSQLServer on a Mail client computer runs under the LocalSystem account, it is necessary to add the post office share to the list of shares that can be accessed by services running under LocalSystem. This can be done by adding the share name to the Registry key on the Windows NT computer sharing the post office:</p>
<p>
\\HKEY_LOCAL_MACHINE<br>
&nbsp;&nbsp;&nbsp;&nbsp;\System<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\CurrentControlSet<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\Services</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\LanmanServer<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\Parameters</p>
<p>
Name: NullSessionShares<br>
Type: REG_MULTI_SZ<br>
Data: COMCFG</p>
<p>
A Registry key can be added by using the Registry Editor (REGEDT32.EXE). For more information, see the online Help for the Registry Editor. You can also set the SQL Server service (MSSQLServer) to run under a Windows NT user account, which does not require the NullSessionShares Registry entry.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
