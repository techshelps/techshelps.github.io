<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Chapter 28   ODBC Messages</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_odbc_messages"></a>ODBC Messages</h1>
<p>
SQLError returns SQLSTATE values as defined by the X/Open and SQL Access Group SQL CAE specification (1992). SQLSTATE values are strings that contain five characters. The following table lists SQLSTATE values that a driver can return for SQLError.</p>
<p>
The character string value returned for an SQLSTATE consists of a two character class value followed by a three character subclass value. A class value of 01 indicates a warning and is accompanied by a return code of SQL_SUCCESS_WITH_INFO. Class values other than 01, except for the class IM, indicate an error and are accompanied by a return code of SQL_ERROR. The class IM is specific to warnings and errors that derive from the implementation of ODBC itself. The subclass value 000 in any class is for implementation defined conditions within the given class. The assignment of class and subclass values is defined by ANSI SQL-92.</p>
<h5>Note</h5>
<p>
Although successful execution of a function is normally indicated by a return value of SQL_SUCCESS, the SQLSTATE 00000 also indicates success.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=23%></th>
<th align=left width=77%></th>
</tr>
<tr valign=top>
<th align=left width=23%>SQLSTATE</th>
<th align=left width=77%>ODBC API (Driver Manager) Error</th>
</tr>
<tr valign=top>
<td width=23%></td>
<td width=77%></td>
</tr>
<tr valign=top>
<td width=23%>00000</td>
<td width=77%>Success</td>
</tr>
<tr valign=top>
<td width=23%>01000</td>
<td width=77%>General warning</td>
</tr>
<tr valign=top>
<td width=23%>01002</td>
<td width=77%>Disconnect error</td>
</tr>
<tr valign=top>
<td width=23%>01004</td>
<td width=77%>Data truncated</td>
</tr>
<tr valign=top>
<td width=23%>01006</td>
<td width=77%>Privilege not revoked</td>
</tr>
<tr valign=top>
<td width=23%>01S00</td>
<td width=77%>Invalid connection string attribute</td>
</tr>
<tr valign=top>
<td width=23%>01S01</td>
<td width=77%>Error in row</td>
</tr>
<tr valign=top>
<td width=23%>01S02</td>
<td width=77%>Option value changed</td>
</tr>
<tr valign=top>
<td width=23%>01S03</td>
<td width=77%>No rows updated or deleted</td>
</tr>
<tr valign=top>
<td width=23%>01S04</td>
<td width=77%>More than one row updated or deleted</td>
</tr>
<tr valign=top>
<td width=23%>01S05</td>
<td width=77%>Cancel treated as FreeStmt/Close</td>
</tr>
<tr valign=top>
<td width=23%>01S06</td>
<td width=77%>Attempt to fetch before the result returned the first rowset</td>
</tr>
<tr valign=top>
<td width=23%>07001</td>
<td width=77%>Wrong number of parameters</td>
</tr>
<tr valign=top>
<td width=23%>07006</td>
<td width=77%>Restricted data type attribute violation</td>
</tr>
<tr valign=top>
<td width=23%>07S01</td>
<td width=77%>Invalid use of default paramater</td>
</tr>
<tr valign=top>
<td width=23%>08001</td>
<td width=77%>Unable to connect to data source</td>
</tr>
<tr valign=top>
<td width=23%>08002</td>
<td width=77%>Connection in use</td>
</tr>
<tr valign=top>
<td width=23%>08003</td>
<td width=77%>Connection not open</td>
</tr>
<tr valign=top>
<td width=23%>08004</td>
<td width=77%>Data source rejected establishment of connection</td>
</tr>
<tr valign=top>
<td width=23%>08007</td>
<td width=77%>Connection failure during transaction</td>
</tr>
<tr valign=top>
<td width=23%>08S01</td>
<td width=77%>Communication link failure</td>
</tr>
<tr valign=top>
<td width=23%>21S01</td>
<td width=77%>Insert value list does not match column list</td>
</tr>
<tr valign=top>
<td width=23%>21S02</td>
<td width=77%>Degree of derived table does not match column list</td>
</tr>
<tr valign=top>
<td width=23%>22001</td>
<td width=77%>String data right truncation</td>
</tr>
<tr valign=top>
<td width=23%>22002</td>
<td width=77%>Indicator variable required but not supplied</td>
</tr>
<tr valign=top>
<td width=23%>22003</td>
<td width=77%>Numeric value out of range</td>
</tr>
<tr valign=top>
<td width=23%>22005</td>
<td width=77%>Error in assignment</td>
</tr>
<tr valign=top>
<td width=23%>22008</td>
<td width=77%>Datetime field overflow</td>
</tr>
<tr valign=top>
<td width=23%>22012</td>
<td width=77%>Division by zero</td>
</tr>
<tr valign=top>
<td width=23%>22026</td>
<td width=77%>String data, length mismatch</td>
</tr>
<tr valign=top>
<td width=23%>23000</td>
<td width=77%>Integrity constraint violation</td>
</tr>
<tr valign=top>
<td width=23%>24000</td>
<td width=77%>Invalid cursor state</td>
</tr>
<tr valign=top>
<td width=23%>25000</td>
<td width=77%>Invalid transaction state</td>
</tr>
<tr valign=top>
<td width=23%>28000</td>
<td width=77%>Invalid authorization specification</td>
</tr>
<tr valign=top>
<td width=23%>34000</td>
<td width=77%>Invalid cursor name</td>
</tr>
<tr valign=top>
<td width=23%>37000</td>
<td width=77%>Syntax error or access violation</td>
</tr>
<tr valign=top>
<td width=23%>3C000</td>
<td width=77%>Duplicate cursor name</td>
</tr>
<tr valign=top>
<td width=23%>40001</td>
<td width=77%>Serialization failure</td>
</tr>
<tr valign=top>
<td width=23%>42000</td>
<td width=77%>Syntax error or access violation</td>
</tr>
<tr valign=top>
<td width=23%>70100</td>
<td width=77%>Operation aborted</td>
</tr>
<tr valign=top>
<td width=23%>IM001</td>
<td width=77%>Driver does not support this function</td>
</tr>
<tr valign=top>
<td width=23%>IM002</td>
<td width=77%>Data source name not found and no default driver specified</td>
</tr>
<tr valign=top>
<td width=23%>IM003</td>
<td width=77%>Specified driver could not be loaded</td>
</tr>
<tr valign=top>
<td width=23%>IM004</td>
<td width=77%>Driver's SQLAllocEnv failed</td>
</tr>
<tr valign=top>
<td width=23%>IM005</td>
<td width=77%>Driver's SQLAllocConnect failed</td>
</tr>
<tr valign=top>
<td width=23%>IM006</td>
<td width=77%>Driver's SQLSetConnectOption failed</td>
</tr>
<tr valign=top>
<td width=23%>IM007</td>
<td width=77%>No data source or driver specified; dialog prohibited</td>
</tr>
<tr valign=top>
<td width=23%>IM008</td>
<td width=77%>Dialog failed</td>
</tr>
<tr valign=top>
<td width=23%>IM009</td>
<td width=77%>Unable to load translation DLL</td>
</tr>
<tr valign=top>
<td width=23%>IM010</td>
<td width=77%>Data source name too long</td>
</tr>
<tr valign=top>
<td width=23%>IM011</td>
<td width=77%>Driver name too long</td>
</tr>
<tr valign=top>
<td width=23%>IM012</td>
<td width=77%>DRIVER keyword syntax error</td>
</tr>
<tr valign=top>
<td width=23%>IM013</td>
<td width=77%>Trace file error</td>
</tr>
<tr valign=top>
<td width=23%>S0001</td>
<td width=77%>Base table or view already exists</td>
</tr>
<tr valign=top>
<td width=23%>S0002</td>
<td width=77%>Base table not found</td>
</tr>
<tr valign=top>
<td width=23%>S0011</td>
<td width=77%>Index already exists</td>
</tr>
<tr valign=top>
<td width=23%>S0012</td>
<td width=77%>Index not found</td>
</tr>
<tr valign=top>
<td width=23%>S0021</td>
<td width=77%>Column already exists</td>
</tr>
<tr valign=top>
<td width=23%>S0022</td>
<td width=77%>Column not found</td>
</tr>
<tr valign=top>
<td width=23%>S0023</td>
<td width=77%>No default for column</td>
</tr>
<tr valign=top>
<td width=23%>S1000</td>
<td width=77%>General error</td>
</tr>
<tr valign=top>
<td width=23%>S1001</td>
<td width=77%>Memory allocation failure</td>
</tr>
<tr valign=top>
<td width=23%>S1002</td>
<td width=77%>Invalid column number</td>
</tr>
<tr valign=top>
<td width=23%>S1003</td>
<td width=77%>Program type out of range</td>
</tr>
<tr valign=top>
<td width=23%>S1004</td>
<td width=77%>SQL data type out of range</td>
</tr>
<tr valign=top>
<td width=23%>S1008</td>
<td width=77%>Operation canceled</td>
</tr>
<tr valign=top>
<td width=23%>S1009</td>
<td width=77%>Invalid argument value</td>
</tr>
<tr valign=top>
<td width=23%>S1010</td>
<td width=77%>Function sequence error</td>
</tr>
<tr valign=top>
<td width=23%>S1011</td>
<td width=77%>Operation invalid at this time</td>
</tr>
<tr valign=top>
<td width=23%>S1012</td>
<td width=77%>Invalid transaction operation code specified</td>
</tr>
<tr valign=top>
<td width=23%>S1015</td>
<td width=77%>No cursor name available</td>
</tr>
<tr valign=top>
<td width=23%>S1090</td>
<td width=77%>Invalid string or buffer length</td>
</tr>
<tr valign=top>
<td width=23%>S1091</td>
<td width=77%>Descriptor type out of range</td>
</tr>
<tr valign=top>
<td width=23%>S1092</td>
<td width=77%>Option type out of range</td>
</tr>
<tr valign=top>
<td width=23%>S1093</td>
<td width=77%>Invalid parameter number</td>
</tr>
<tr valign=top>
<td width=23%>S1094</td>
<td width=77%>Invalid scale value</td>
</tr>
<tr valign=top>
<td width=23%>S1095</td>
<td width=77%>Function type out of range</td>
</tr>
<tr valign=top>
<td width=23%>S1096</td>
<td width=77%>Information type out of range</td>
</tr>
<tr valign=top>
<td width=23%>S1097</td>
<td width=77%>Column type out of range</td>
</tr>
<tr valign=top>
<td width=23%>S1098</td>
<td width=77%>Scope type out of range</td>
</tr>
<tr valign=top>
<td width=23%>S1099</td>
<td width=77%>Nullable type out of range</td>
</tr>
<tr valign=top>
<td width=23%>S1100</td>
<td width=77%>Uniqueness option type out of range</td>
</tr>
<tr valign=top>
<td width=23%>S1101</td>
<td width=77%>Accuracy option type out of range</td>
</tr>
<tr valign=top>
<td width=23%>S1103</td>
<td width=77%>Direction option out of range</td>
</tr>
<tr valign=top>
<td width=23%>S1104</td>
<td width=77%>Invalid precision value</td>
</tr>
<tr valign=top>
<td width=23%>S1105</td>
<td width=77%>Invalid parameter type</td>
</tr>
<tr valign=top>
<td width=23%>S1106</td>
<td width=77%>Fetch type out of range</td>
</tr>
<tr valign=top>
<td width=23%>S1107</td>
<td width=77%>Row value out of range</td>
</tr>
<tr valign=top>
<td width=23%>S1108</td>
<td width=77%>Concurrency option out of range</td>
</tr>
<tr valign=top>
<td width=23%>S1109</td>
<td width=77%>Invalid cursor position</td>
</tr>
<tr valign=top>
<td width=23%>S1110</td>
<td width=77%>Invalid driver completion</td>
</tr>
<tr valign=top>
<td width=23%>S1111</td>
<td width=77%>Invalid bookmark value</td>
</tr>
<tr valign=top>
<td width=23%>S1C00</td>
<td width=77%>Driver not capable</td>
</tr>
<tr valign=top>
<td width=23%>S1DE0</td>
<td width=77%>No data at execution values pending</td>
</tr>
<tr valign=top>
<td width=23%>S1T00</td>
<td width=77%>Timeout expired</td>
</tr>
</table><br>
<p>
The ODBC SQL Server Driver version 2.5 can return error messages for certain SQLSTATE values, as shown in the following table:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=23%></th>
<th align=left width=77%></th>
</tr>
<tr valign=top>
<th align=left width=23%>SQLSTATE</th>
<th align=left width=77%>SQL SERVER DRIVER ERROR</th>
</tr>
<tr valign=top>
<td width=23%></td>
<td width=77%></td>
</tr>
<tr valign=top>
<td width=23%>01000</td>
<td width=77%>The ODBC catalog stored procedures installed on server %s are version %s; version %02d.%02d.%4.4d or later is required to ensure proper operation. Please contact your system administrator.</td>
</tr>
<tr valign=top>
<td width=23%>01000</td>
<td width=77%>Ongoing transaction has been committed</td>
</tr>
<tr valign=top>
<td width=23%>01000</td>
<td width=77%>Access to database specified in the odbc.ini file has been denied. Default used.</td>
</tr>
<tr valign=top>
<td width=23%>01000</td>
<td width=77%>Language specified in the odbc.ini file is not supported. Default used.</td>
</tr>
<tr valign=top>
<td width=23%>01000</td>
<td width=77%>Procedure executed with 'EXEC'. No output parameters returned.</td>
</tr>
<tr valign=top>
<td width=23%>01S02</td>
<td width=77%>Packet size change not honored by server, server size used</td>
</tr>
<tr valign=top>
<td width=23%>22008</td>
<td width=77%>Invalid date</td>
</tr>
<tr valign=top>
<td width=23%>22008</td>
<td width=77%>Invalid time</td>
</tr>
<tr valign=top>
<td width=23%>22008</td>
<td width=77%>Invalid timestamp</td>
</tr>
<tr valign=top>
<td width=23%>28000</td>
<td width=77%>Invalid authorization specification; Access to selected database has been denied</td>
</tr>
<tr valign=top>
<td width=23%>28000</td>
<td width=77%>Invalid authorization specification; Language specified is not supported</td>
</tr>
<tr valign=top>
<td width=23%>IM006</td>
<td width=77%>Packet size change not supported by server, default used</td>
</tr>
<tr valign=top>
<td width=23%>IM009</td>
<td width=77%>Translation module is not valid</td>
</tr>
<tr valign=top>
<td width=23%>S1000</td>
<td width=77%>The stored procedure required to complete this operation could not be found on the server (they were supplied with the ODBC setup disk for the SQL Server driver). Please contact your system administrator.</td>
</tr>
<tr valign=top>
<td width=23%>S1000</td>
<td width=77%>Unknown token received from SQL Server</td>
</tr>
<tr valign=top>
<td width=23%>S1000</td>
<td width=77%>Operation not allowed while results are pending</td>
</tr>
<tr valign=top>
<td width=23%>S1000</td>
<td width=77%>Unable to load communication module. Driver has not been correctly installed.</td>
</tr>
<tr valign=top>
<td width=23%>S1000</td>
<td width=77%>Communication module is not valid. Driver has not been correctly installed.</td>
</tr>
<tr valign=top>
<td width=23%>S1000</td>
<td width=77%>Warning: Partial insert/update. The insert/update of a text or image column(s) did not succeed.</td>
</tr>
<tr valign=top>
<td width=23%>S1000</td>
<td width=77%>Connection is busy with results for another hstmt</td>
</tr>
<tr valign=top>
<td width=23%>S1000</td>
<td width=77%>Failure during closing of connection</td>
</tr>
<tr valign=top>
<td width=23%>S1000</td>
<td width=77%>Protocol error in TDS stream</td>
</tr>
<tr valign=top>
<td width=23%>S1000</td>
<td width=77%>TDS buffer length too large</td>
</tr>
<tr valign=top>
<td width=23%>S1000</td>
<td width=77%>Non-default parameter not allowed after default parameter</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
