<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Copying Data from SQL Server to a File</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_copying_data_from_sql.a0.server_to_a_file"></a>Copying Data from SQL Server to a File</h3>
<p>
You can copy tables out of SQL Server for use with other programs, such as a spreadsheet program, or for use on other SQL Servers. The following examples show how to copy a database table to a file in its current format, as well as how to copy a database table to a file in a new format.</p>

<h4><a name="_copying_a_database_table_to_a_file"></a>Copying a Database Table to a File</h4>
<p>
In the following example, <b>bcp</b> copies data from the <i>publishers</i> table to an output file called PUBL_OUT for later reloading into SQL Server using the format file PUBL_FMT. It creates an output file with a new line at the end of each row and a comma between each field in a row.</p>
<pre>bcp pubs..publishers out publ_out /S<i>servername</i> /Usa /P<i>password</i>

    Enter the file storage type of field pub_id [char]:
    Enter prefix length of field pub_id [0]:
    Enter length of field pub_id [4]:
    Enter field terminator [none]: ,

    Enter the file storage type of field pub_name [char]:
    Enter prefix length of field pub_name [0]: 
    Enter length of field pub_name [40]:
    Enter field terminator [none]: ,

    Enter the file storage type of field city [char]:
    Enter prefix length of field city [0]: 
    Enter length of field city [20]:
    Enter field terminator [none]: ,

    Enter the file storage type of field state [char]:
    Enter prefix length of field state [0]: 
    Enter length of field state [2]:
    Enter field terminator [none]: ,

    Enter the file storage type of field country [char]:
    Enter prefix length of field country [0]: 
    Enter length of field country [30]:
    Enter field terminator [none]: \n

    Do you want to save this format information in a file? [Y/n] y
    Host filename: [bcp_fmt] publ_fmt

     Starting copy...

    8 rows copied.
    Network packet size (bytes): 4096
    Clock Time (ms.): total = 150    Avg = 18    (53.33 rows per sec.)
</pre>
<p>
These are the results in the PUBL_OUT output file:</p>
<pre>0736,New Moon Books,Boston,MA,USA
0877,Binnet &amp; Hardley,Washington,DC,USA
1389,Algodata Infosystems,Berkeley,CA,USA
1622,Five Lakes Publishing,Chicago,IL,USA
1756,Ramona Publishers,Dallas,TX,USA
9901,GGG&amp;G,München,,Germany
9952,Scootney Books,New York,NY,USA
9999,Lucerne Publishing,Paris,,France
</pre>
<p>
In this example, the user saved a format file called PUBL_FMT in response to the associated prompt. These are the results in the PUBL_FMT file:</p>
<pre>6.0
5
1       SQLCHAR       0       4       ","       1       pub_id
2       SQLCHAR       0       40      ","       2       pub_name
3       SQLCHAR       0       20      ","       3       city
4       SQLCHAR       0       2       ","       4       state
5       SQLCHAR       0       30      "\r\n"    5       country
</pre>
<p>
To use the saved format file to copy this data back into SQL Server, type:</p>
<pre>bcp pubs..publishers in publ_out /f publ_fmt /S<i>servername</i> /Usa /P<i>password</i>
</pre>
<p>
Note that the PUBL_FMT format file can be used to copy any data with the same format into SQL Server.</p>

<h4><a name="_copying_a_database_table_to_a_file_in_a_new_format"></a>Copying a Database Table to a File in a New Format</h4>
<p>
By changing the default values of the <b>bcp</b> prompts, you can store data in a new format for use with other software. In most cases, you'll want an ASCII file for other programs. The usual responses to the <b>bcp</b> prompts are as follows:
<ul>
<li>
The storage type should be <i>char</i>.</li>
<li>
The prefix length should be 0.</li>
<li>
The field length should be the default.</li>
<li>
The terminator depends on what software you plan to use. For output delimited with commas, use a comma as the terminator for each field. For tabular output, terminate the last field with the newline character (<b>\n</b>) and all other fields with the tab character (<b>\t</b>).</li>
</ul>
<p>
The following example creates output in the computer format called system data format (SDF). Each field has a fixed length with spaces to pad the fields. Adjacent fields in which the data completely fills the first field seem to run together, since there are no field separators on each line of output. Only the final field has a terminator, the newline character(<b>\n</b>). This format can be easily read or produced by other software.</p>
<pre>bcp pubs..sales out sal_out /Sserver /Usa /Ppassword

    Enter the file storage type of field stor_id [char]:
    Enter prefix-length of field stor_id [0]:
    Enter length of field stor_id [4]:
    Enter field terminator [none]:

    Enter the file storage type of field ord_num [char]:
    Enter prefix-length of field ord_num [0]: 
    Enter length of field ord_num [20]:
    Enter field terminator [none]:

    Enter the file storage type of field date [datetime]: char
    Enter prefix-length of field date [0]: 
    Enter length of field date [26]:
    Enter field terminator [none]:

    Enter the file storage type of field qty [smallint]: char
    Enter prefix-length of field qty [0]: 
    Enter length of field qty [6]:
    Enter field terminator [none]:

    Enter the file storage type of field payterms [char]:
    Enter prefix-length of field payterms [0]: 
    Enter length of field payterms [12]:
    Enter field terminator [none]:

    Enter the file storage type of field title_id [char]:
    Enter prefix-length of field title_id [0]: 
    Enter length of field title_id [6]:
    Enter field terminator [none]: \n

    Do you want to save this format information in a file? [Y/n] y
    Host filename: [bcp_fmt] sal_fmt

    Starting copy...

    21 rows copied.
    Network packet size (bytes): 4096
    Clock Time (ms.): total = 210   Avg = 10     (100.00 rows per sec.)
</pre>
<p>
The following output is sent by <b>bcp</b> to the SAL_OUT file:</p>
<table cellspacing=4 cols=6>
<tr valign=top>
<td width=11%><pre>6380</pre>
</td>
<td width=16%><pre>6871</pre>
</td>
<td width=31%><pre>Sep 14 1994 12:00AM</pre>
</td>
<td width=8%><pre>5</pre>
</td>
<td width=19%><pre>Net 60</pre>
</td>
<td width=15%><pre>BU1032</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>6380</pre>
</td>
<td width=16%><pre>722a</pre>
</td>
<td width=31%><pre>Sep 13 1994 12:00AM</pre>
</td>
<td width=8%><pre>3</pre>
</td>
<td width=19%><pre>Net 60</pre>
</td>
<td width=15%><pre>PS2091</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>7066</pre>
</td>
<td width=16%><pre>A2976</pre>
</td>
<td width=31%><pre>May 24 1993 12:00AM</pre>
</td>
<td width=8%><pre>50</pre>
</td>
<td width=19%><pre>Net 30</pre>
</td>
<td width=15%><pre>PC8888</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>7066</pre>
</td>
<td width=16%><pre>QA7442.3</pre>
</td>
<td width=31%><pre>Sep 13 1994 12:00AM</pre>
</td>
<td width=8%><pre>75</pre>
</td>
<td width=19%><pre>ON invoice</pre>
</td>
<td width=15%><pre>PS2091</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>7067</pre>
</td>
<td width=16%><pre>D4482</pre>
</td>
<td width=31%><pre>Sep 14 1994 12:00AM</pre>
</td>
<td width=8%><pre>10</pre>
</td>
<td width=19%><pre>Net 60</pre>
</td>
<td width=15%><pre>PS2091</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>7067</pre>
</td>
<td width=16%><pre>P2121</pre>
</td>
<td width=31%><pre>Jun 15 1992 12:00AM</pre>
</td>
<td width=8%><pre>40</pre>
</td>
<td width=19%><pre>Net 30</pre>
</td>
<td width=15%><pre>TC3218</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>7067</pre>
</td>
<td width=16%><pre>P2121</pre>
</td>
<td width=31%><pre>Jun 15 1992 12:00AM</pre>
</td>
<td width=8%><pre>20</pre>
</td>
<td width=19%><pre>Net 30</pre>
</td>
<td width=15%><pre>TC4203</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>7067</pre>
</td>
<td width=16%><pre>P2121</pre>
</td>
<td width=31%><pre>Jun 15 1992 12:00AM</pre>
</td>
<td width=8%><pre>20</pre>
</td>
<td width=19%><pre>Net 30</pre>
</td>
<td width=15%><pre>TC7777</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>7131</pre>
</td>
<td width=16%><pre>N914008</pre>
</td>
<td width=31%><pre>Sep 14 1994 12:00AM</pre>
</td>
<td width=8%><pre>20</pre>
</td>
<td width=19%><pre>Net 30</pre>
</td>
<td width=15%><pre>PS2091</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>7131</pre>
</td>
<td width=16%><pre>N914014</pre>
</td>
<td width=31%><pre>Sep 14 1994 12:00AM</pre>
</td>
<td width=8%><pre>25</pre>
</td>
<td width=19%><pre>Net 30</pre>
</td>
<td width=15%><pre>MC3021</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>7131</pre>
</td>
<td width=16%><pre>P3087a</pre>
</td>
<td width=31%><pre>May 29 1993 12:00AM</pre>
</td>
<td width=8%><pre>20</pre>
</td>
<td width=19%><pre>Net 60</pre>
</td>
<td width=15%><pre>PS1372</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>7131</pre>
</td>
<td width=16%><pre>P3087a</pre>
</td>
<td width=31%><pre>May 29 1993 12:00AM</pre>
</td>
<td width=8%><pre>25</pre>
</td>
<td width=19%><pre>Net 60</pre>
</td>
<td width=15%><pre>PS2106</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>7131</pre>
</td>
<td width=16%><pre>P3087a</pre>
</td>
<td width=31%><pre>May 29 1993 12:00AM</pre>
</td>
<td width=8%><pre>15</pre>
</td>
<td width=19%><pre>Net 60</pre>
</td>
<td width=15%><pre>PS3333</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>7131</pre>
</td>
<td width=16%><pre>P3087a</pre>
</td>
<td width=31%><pre>May 29 1993 12:00AM</pre>
</td>
<td width=8%><pre>25</pre>
</td>
<td width=19%><pre>Net 60</pre>
</td>
<td width=15%><pre>PS7777</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>7896</pre>
</td>
<td width=16%><pre>QQ2299</pre>
</td>
<td width=31%><pre>Oct 28 1993 12:00AM</pre>
</td>
<td width=8%><pre>15</pre>
</td>
<td width=19%><pre>Net 60</pre>
</td>
<td width=15%><pre>BU7832</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>7896</pre>
</td>
<td width=16%><pre>TQ456</pre>
</td>
<td width=31%><pre>Dec 12 1993 12:00AM</pre>
</td>
<td width=8%><pre>10</pre>
</td>
<td width=19%><pre>Net 60</pre>
</td>
<td width=15%><pre>MC2222</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>7896</pre>
</td>
<td width=16%><pre>X999</pre>
</td>
<td width=31%><pre>Feb 21 1993 12:00AM</pre>
</td>
<td width=8%><pre>35</pre>
</td>
<td width=19%><pre>ON invoice</pre>
</td>
<td width=15%><pre>BU2075</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>8042</pre>
</td>
<td width=16%><pre>423LL922</pre>
</td>
<td width=31%><pre>Sep 14 1994 12:00AM</pre>
</td>
<td width=8%><pre>15</pre>
</td>
<td width=19%><pre>ON invoice</pre>
</td>
<td width=15%><pre>MC3021</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>8042</pre>
</td>
<td width=16%><pre>423LL930</pre>
</td>
<td width=31%><pre>Sep 14 1994 12:00AM</pre>
</td>
<td width=8%><pre>10</pre>
</td>
<td width=19%><pre>ON invoice</pre>
</td>
<td width=15%><pre>BU1032</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>8042</pre>
</td>
<td width=16%><pre>P723</pre>
</td>
<td width=31%><pre>Mar 11 1993 12:00AM</pre>
</td>
<td width=8%><pre>25</pre>
</td>
<td width=19%><pre>Net 30</pre>
</td>
<td width=15%><pre>BU1111</pre>
</td>
</tr>
<tr valign=top>
<td width=11%><pre>8042</pre>
</td>
<td width=16%><pre>QA879.1</pre>
</td>
<td width=31%><pre>May 22 1993 12:00AM</pre>
</td>
<td width=8%><pre>30</pre>
</td>
<td width=19%><pre>Net 30</pre>
</td>
<td width=15%><pre>PC1035</pre>
</td>
</tr>
</table><br>
<pre></pre>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
