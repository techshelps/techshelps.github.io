<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Error 7130</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_error_7130"></a>Error 7130</h1>
<h4>Severity Level 16</h4>
<h4>Message Text</h4>
<pre>%s with no log is not valid at this time. Use sp_dboption to set the 'select into/bulkcopy' option on for database %s.
</pre>
<h4>Explanation</h4>
<p>
This error occurs upon executing the writetext command or <b>dbwritetext </b>routine in a database that does not have the <b>sp_dboption</b> system stored procedure's <b>select into/bulkcopy</b> option enabled. Because these are non-logged operations, the option must be enabled.</p>
<p>
Often, writetext and <b>dbwritetext</b> are run against a temporary table. The <b>select into/bulkcopy</b> option must be enabled in <i>tempdb</i>, or these will not run successfully.</p>
<h4>Action</h4>
<p>
Enable the <b>sp_dboption</b> system stored procedure's <b>select into/bulkcopy</b> option for all databases affected by the query that contains a non-logged operation. To do this, the system administrator and database owners should follow these steps:
<ol>
<li>
Enable the option:<pre>USE master
go
sp_dboption database_name, 'select into/bulkcopy',true
go
USE database_name
go
CHECKPOINT
go</pre>
</li>
</ol>
<pre></pre>
<ol start=2>
<li>
Verify that the change is active:<pre>sp_helpdb database_name
go</pre>
</li>
<li>
Execute the non-logged operation.</li>
<li>
When the non-logged operation is complete, dump the database.<p>
<b>Caution</b>  After executing a non-logged operation, do not dump the transaction log. Although the procedure may appear to succeed, you may have been dumping only empty text pages. Whenever you make non-logged changes to your database, you must use the dump database statement, because changes made by the non-logged operation cannot be recovered from transaction logs.
</li>
<li>
Return the database to its original condition by disabling the <b>select into/bulkcopy</b> option:<pre>USE master
go
sp_dboption database_name, 'select into/bulkcopy',false
go
USE database_name
go
CHECKPOINT
go</pre>
</li>
<li>
Verify that the change is active:<pre>sp_helpdb database_name
go</pre>
</li>
</ol>
<p>
For more information about writetext and <b>dbwritetext()</b>, see the <i>Microsoft SQL Server Transact-SQL Reference </i>and <i>Microsoft SQL Server Programming DB-Library for C</i>. For more information about database dumps and recoverability, see Part 5, "Data Management."</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
