<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Bulk Copies into a Database</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_bulk_copies_into_a_database"></a>Bulk Copies into a Database</h2>
<p>
You can also break up large transactions when using<b> bcp </b>to bulk copy data into a database. If you use<b> bcp </b>without specifying a batch size, the entire operation is performed as a single logical transaction.</p>
<p>
Even if another user process does a DUMP TRANSACTION statement, the log records associated with the bulk copy operation remain in the log until the entire operation completes or another DUMP TRANSACTION statement is executed. This is one of the most common causes of the 1105 error. You can avoid the problem by splitting the bulk copy operation into batches.</p>
<p>
To ensure recoverability, follow this procedure:
<ol>
<li>
Set the <b>trunc. log on chkpt.</b> option to true:<pre>use master
go
sp_dboption database_name, trunc, true
go</pre>
<p>
<b>Note</b>  The <b>trunc</b> option is an abbreviated form of the <b>trunc. log on chkpt.</b> option. The two options are interchangeable.
</li>
<li>
Run <b>bcp</b> from the command line using the <b>/b</b> <i>batchsize</i> option, as shown in the following example:<pre>bcp database_name..table_name in /b 100 /U sa /P sa_password 
/S server_name
</pre>
</li>
<li>
When the<b> bcp </b>operations are complete, turn off the <b>trunc. log on chkpt.</b> option and dump the database.</li>
</ol>
<p>
In this example, a batch size of 100 rows is specified. This results in one transaction for every 100 rows copied. In some cases, you might also need to break the<b> bcp </b>input file into two or more separate files and execute a DUMP TRANSACTION after copying each file (to prevent the transaction log from filling up).</p>
<p>
If <b>bcp </b>is performed in the fast mode, the operation is not logged. In other words, only the space allocations are logged, not the complete table, so the transaction log cannot be dumped to a device. In this case, you must use the DUMP TRANSACTION WITH TRUNCATE_ONLY statement to free space in the log. Remember, however, that after you execute DUMP TRANSACTION WITH TRUNCATE_ONLY, you must dump the database before you can dump the transaction log to a device.</p>
<p>
For additional information about using<b> bcp</b>, see the <i>Microsoft SQL Server Transact-SQL Reference</i>.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
