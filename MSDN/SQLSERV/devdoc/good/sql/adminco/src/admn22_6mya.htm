<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Automatic Transaction Log Dumps Using Performance Monitor</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_automatic_transaction_log_dumps_using_performance_monitor"></a>Automatic Transaction Log Dumps Using Performance Monitor </h1>
<p>
SQL Server for Windows NT is integrated with the Windows NT Performance Monitor, so you can use the "% Full" counter of the SQLServer-Log object to dump or truncate the transaction log.</p>
<p>
Here is how to set up the event:
<ol>
<li>
Set up a text file called DUMP.SQL. This file will contain the TRANSACT-SQL commands to dump or truncate the log. <p>
For example:
<pre>dump tran pubs with truncate_only
go</pre>
</li>
<li>
Start Performance Monitor, and add an alert that will run the script when the log is more than a specified percentage full. </li>
<li>
Make sure that SQL Server is running.</li>
<li>
Start Performance Monitor.</li>
<li>
From the View menu, choose Alert.</li>
<li>
Choose the  button to add an alert event.</li>
<li>
Choose the object SQLServer-Log.</li>
<li>
Choose the counter Log Space Used(%).</li>
<li>
Choose the instance of the database to monitor (<i>pubs </i>in this example).</li>
<li>
Choose the Over button of the Alert If dialog box, and then enter the percentage at which you want the log to be truncated in the box to the right of this button. For example, entering "75" will issue the truncate command when the log becomes more than 75% full.</li>
<li>
Enter the <b>isql </b>command under Run Program on Alert. The command should launch the DUMP.SQL file. For example:<pre>isql -Sserver -Usa -Ppassword -ic:\sql60\dump.sql</pre>
</li>
<li>
Click the Every Time button so that the log will be truncated every time the fullness exceeds the specified threshold.</li>
<li>
Choose OK.</li>
</ol>
<p>
You can save these settings using the Save Alert Settings dialog box that appears when you choose Save As from the File menu so that you do not have to re-create this alert every time you start Windows NT.</p>
<p>
<b>Note</b>  If you are using Integrated Security, Performance Monitor must be started under an administrator account or one that maps to the database owner.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
