<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Batch Sizes with bcp</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_using_batch_sizes_with_bcp"></a>Using Batch Sizes with bcp</h3>
<p>
The bulk copy program (<b>bcp</b>) accepts as one of its parameters:</p>
<p>
<b>/b</b> <i>batchsize</i></p>
<p>
This parameter allows the user to specify the number of rows per batch for the data that will be loaded into a SQL Server table. The use of the <b>/b</b> parameter has a large impact on how the data insertions are logged. When the <b>/b</b> parameter is not used with the <b>bcp</b> utility, all rows from a data file are copied into SQL Server in one batch, and <b>bcp</b> displays the message "1000 rows sent to SQL Server" after every 1000 rows have been copied.</p>
<p>
When nonlogged (or "fast") <b>bcp</b> is used, the data insertions are not logged in the transaction log. However, SQL Server still logs extent allocations each time a new extent is allocated to the table. (An extent is a block of eight 2K data pages.)</p>
<p>
If the <b>/b</b> parameter is not used, SQL Server treats the entire <b>bcp</b> operation as a single transaction. Thus, if for any reason the <b>bcp</b> is aborted before it finishes, the entire transaction is rolled back, and the destination table will not contain any new rows from the <b>bcp</b> operation.</p>
<p>
If the <b>/b</b> parameter is used, each batch of rows is logged as a separate transaction. For example, if a data file has 1000 rows, and a batch size of 100 is used, SQL Server will log the operation as 10 separate transactions. If the <b>bcp</b> operation were to abort while copying in row 750, only the previous 49 rows would be removed, and the destination table would still contain the first 700 rows.</p>
<p>
When copying large data files into SQL Server with <b>bcp</b>, it is possible for the transaction log to fill up from the extent allocation logging before the copy is complete. In this situation, you can either enlarge the transaction log or perform the <b>bcp</b> copy by using the <b>/b</b> option and setting the database option Truncate Log on<b> </b>Checkpoint. Setting this option on will instruct SQL Server to truncate the log each time it performs a CHECKPOINT, so the log records for those batches that have been committed will be removed from the log. Because only committed transactions can be truncated from the log, this option will not free up space in the log if the <b>/b</b> option is not used (because the entire operation is logged as a single transaction).</p>
<p>
<b>Note</b>  When you use nonlogged <b>bcp</b> to import data into a SQL Server database, it is important to back up the database (by using the DUMP DATABASE command) when the <b>bcp</b> copy is complete.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
