<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Placing a Database Online or Offline</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_placing_a_database_online_or_offline"></a>Placing a Database Online or Offline</h2>
<p>
Placing a database online makes it ready to be used. All devices belonging to the specified database are opened (if they are not already open) and marked nondeferred, and the database is recovered and becomes available for use. Recovery is skipped if the database is set as read only.</p>
<p>
Placing a database offline sets the database as unavailable and allows the storage media (CD or other) to be removed from the drive. All devices belonging to that database are closed and marked as deferred, except those that contain space belonging to other online databases. Databases placed offline are not recovered automatically at server startup.</p>
<p>
Before a removable media disk is removed from a drive, all databases on that disk must be placed offline. </p>
<p>
<b>Note</b>  If you remove the storage media from the drive without first placing the database offline, you can later receive operating system error messages.</p>
<p>
Use the <b>sp_dboption</b> stored procedure to place a database online or offline.</p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To place an installed database online</h5>
<ol>
<li>
If necessary, place the removable media into the drive.<p>
When a database is placed online, any needed removable disk must be in the disk drive. A disk is needed if it contains a data device that was not moved to the local hard disk during installation.
</li>
<li>
Run <b>sp_dboption</b> using the <b>offline, false</b> option.<p>
For example, to place the database <i>inventory</i> online, from the Query Analyzer in SQL Enterprise Manager, use:
<pre>sp_dboption inventory,offline,FALSE</pre>
</li>
</ol>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To place a database offline</h5>
<ol>
<li>
Make sure the database has no active users.<p>
View active users by opening the Current Activity window of SQL Enterprise Manager.
</li>
<li>
Run <b>sp_dboption</b> using the <b>offline, true</b> option.<p>
For example, to place the database <i>inventory</i> offline, from the Query Analyzer in SQL Enterprise Manager, use:
<pre>sp_dboption inventory,offline,true</pre>
</li>
</ol>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To remove media that contains an installed database</h5>
<ol>
<li>
Place the database offline using <b>sp_dboption</b></li>
<li>
If the removable media contains more than one database, repeat step 1 for each.</li>
<li>
Remove the storage media from the drive.</li>
</ol>
<p>
For more information about using <b>sp_dboption</b>, see the <a href="../../tsqlref/src/tsql20_1tnp.htm">sp_dboption System Stored Procedure</a> topic in the <i>Microsoft SQL Server Transact-SQL Reference</i>.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
