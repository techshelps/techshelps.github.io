<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DECnet Sockets Clients</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_decnet_sockets_clients"></a>DECnet Sockets Clients</h2>
<p>
To support VMS clients to NT SQL Server via DECNet sockets, the NT Server system should be running Digital's NT Pathworks for Windows NT version 4.1b.  This version is supported on both NT 3.5 and NT 3.51.</p>
<p>
<b>Note</b>  Because of networking incompatibilities for out-of-band data, you may notice a delay in sending attention events to cancel queries (such as using CRTL+C to cancel a query sent by ISQL). The length if the delay is proportional to the size of the result set.</p>
<p>
If you experience difficulties establishing connections from VMS clients via DECNet sockets, check the Windows NT application log or the SQL Server error log, and verify that the DECNet sockets Net-Library is loaded correctly. If not, you will see an error message.</p>
<p>
If the DECnet sockets Net-Library is loaded properly on the server, you should see a message similar to the following in the Windows NT application log or the SQL Server error log:</p>
<pre>Using 'SSMSDECN.DLL' version '6.00.0.0' to listen on '#150'
</pre>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To check a DECnet socket connection from a client to the server</h5>
<ul>
<li>
Start the NCP utility on the VMS client and type:<p>
<b>LOOP NODE</b> <i>node_address</i>
<p>
where 
<dl>
<dt>
<i>node_address</i> </dt>
<dd>
Is the DECnet node address of the Windows NT-based server.
</dd>
</dl>
</li>
</ul>
<p>
For example, to check the connection between the client and SQL Server at DECnet node address 1.996, start NCP and type:</p>
<pre>LOOP NODE 1.996
</pre>
<p>
If the connection is open, the output should look similar to this:</p>
<pre>LOOP NODE test started at 22-Jul-1994 9:59:12
   Connect completed to node NTSQL
   Remote node maximum buffer size for loopback: 4096
   Successfully send and receive, message 1.
LOOP NODE test finished successfully at 22-Jul-1994 9:59:13
</pre>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To verify that SQL Server is listening on DECnet sockets and can accept a client connection</h5>
<ol>
<li>
If necessary, copy the client-side DECnet Net-Library from the \SQL60\DLL directory to the same directory on a Windows NT-based computer with Pathworks for Windows NT installed.</li>
<li>
On this system, use the SQL Server Client Configuration Utility to change the default Net-Library to DBMSDECN.DLL.</li>
<li>
Attempt an ISQL connection with the node address and the DECnet object ID. For example:<pre>isql -Usa -P -S1.909,#150</pre>
<p>
If you can connect with ISQL and execute queries, the server is properly configured to listen on DECnet sockets and is accepting connections.
</li>
</ol>
<p>&nbsp;</p></body>
</HTML>
