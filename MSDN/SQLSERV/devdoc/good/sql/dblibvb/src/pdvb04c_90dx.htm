<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SqlServerEnum%</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqlserverenum.25"></a>SqlServerEnum%</h1>
<p>
Lists the names of local SQL Servers, network SQL Servers, or both.</p>
<h4>Syntax</h4>
<p>
<b>SqlServerEnum% ( </b><i>searchmode%</i><b>,</b><i> serverbuf$</i><b>,</b><i> numentries%</i><b> )</b></p>
<p>
where
<dl>
<dt>
<i>searchmode%</i></dt>
<dd>
Determines whether <b>SqlServerEnum%</b> checks for server names locally, on the network, or both.
<p>
LOCSEARCH searches for the server names listed in the WIN.INI file. LOCSEARCH has the value 1.

<p>
NETSEARCH searches for server names on the network type defined by the default Net-Library. The VBSQL Library loads the default Net-Library set by the DSQUERY entry in the WIN.INI file. If no default entry exists, the VBSQL Library loads the named pipes Net-Library. NETSEARCH has the value 2. 

<p>
(LOCSEARCH  NETSEARCH) searches for server names using both methods, searching first for server names listed in the WIN.INI file and then for server names on the network type defined by the default Net-Library. A server name is listed twice if it is specified in the WIN.INI file and is also available on the default network type.
</dd>
<dt>
<i>serverbuf$</i></dt>
<dd>
Is the buffer that stores the server names that <b>SqlServerEnum%</b> returns. You must preallocate this buffer using an appropriate Visual Basic function such as <b>Space$</b>. DB-Library for Visual Basic determines the length of the buffer based on what you allocated.</dd>
<dt>
<i>numentries%</i></dt>
<dd>
Is an output parameter that returns the number of server names copied to the buffer by the current call to <b>SqlServerEnum%</b>.
</dd>
</dl>
<h4>Returns</h4>
<p>
<b>SqlServerEnum%</b> returns one or more of the following status codes:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%></th>
<th align=left width=68%></th>
</tr>
<tr valign=top>
<th align=left width=32%></th>
<th align=left width=68%></th>
</tr>
<tr valign=top>
<th align=left width=32%>Constant</th>
<th align=left width=68%>Value</th>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%></td>
</tr>
<tr valign=top>
<td width=32%>ENUMSUCCESS%</td>
<td width=68%>0</td>
</tr>
<tr valign=top>
<td width=32%>MOREDATA%</td>
<td width=68%>1</td>
</tr>
<tr valign=top>
<td width=32%>NETNOTAVAIL%</td>
<td width=68%>2</td>
</tr>
<tr valign=top>
<td width=32%>OUTOFMEMORY%</td>
<td width=68%>4</td>
</tr>
<tr valign=top>
<td width=32%>NOTSUPPORTED%</td>
<td width=68%>8</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The <b>SqlServerEnum%</b> function returns a list of server names to the <i>server$</i> buffer in the order in which it finds them. LOCSEARCH names are listed before NETSEARCH names. Only complete server names are copied to the buffer. Each server name is separated by a null character (<b>chr$(0)</b>).</p>
<p>
The end of the list is designated by two consecutive null characters. If the buffer becomes full before <b>SqlServerEnum%</b> has finished sending names, <b>SqlServerEnum%</b> returns the value MOREDATA.</p>
<p>
Note that on named pipes networks, <b>SqlServerEnum%</b> returns the server names of computers on which SQL Server is installed, regardless of whether or not SQL Server is currently running.</p>
<h4>See Also</h4>
<p>
<a href="pdvb04b_399x.htm"><b>SqlOpen%</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
