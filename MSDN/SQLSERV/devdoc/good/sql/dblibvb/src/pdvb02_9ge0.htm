<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Error- and Message-Handling Interface Syntax</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_error.2d_.and_message.2d.handling_interface_syntax"></a>Error- and Message-Handling Interface Syntax</h3>
<p>
This section describes the syntax for the DB-Library for Visual Basic error and message handlers. <b>VBSQL1_Error</b> is called automatically whenever the application encounters a DB-Library for Visual Basic error. <b>VBSQL1_Message</b> is called in response to messages returned by SQL Server.</p>

<h4><a name="_vbsql1_error_procedure"></a>VBSQL1_Error Procedure</h4>
<p>
The <b>VBSQL1_Error</b> procedure has the following syntax:</p>
<p>
<b>VBSQL1_Error ( </b><i>sqlconn%</i><b>,</b> <i>severity%</i><b>,</b> <i>errornum%</i><b>,</b> <i>errorstr$</i><b>,</b> <i>retcode% </i><b>)</b></p>
<p>
where
<dl>
<dt>
<i>sqlconn%</i></dt>
<dd>
Is a SQL Server connection that encountered an error.</dd>
<dt>
<i>severity%</i></dt>
<dd>
Is an integer that denotes the severity of an error. For a list of error severities, see <a href="pdvbb_9c6p.htm">Error Messages</a>. </dd>
<dt>
<i>errornum%</i></dt>
<dd>
Is an integer, or error number, that denotes an error constant. Error numbers and their corresponding constants are listed in the VBSQL.BAS include file. For a list of DB-Library for Visual Basic error constants and their corresponding error messages, see <a href="pdvbb_9c6p.htm">Error Messages</a>. </dd>
<dt>
<i>errorstr$</i></dt>
<dd>
Is a string that is the error message for a corresponding error constant. For a list of DB-Library for Visual Basic error constants and their corresponding error messages, see <a href="pdvbb_9c6p.htm">Error Messages</a>. </dd>
<dt>
<i>retcode%</i></dt>
<dd>
Is an output parameter that determines how DB-Library for Visual Basic will proceed following the error. Custom error handling code can set <i>retcode%</i> to one of the following integers prior to exiting the <b>VBSQL1_Error</b> procedure:
<dl>
<dt>
<b>0</b>INTEXIT</dt>
<dd>
Treated as an intcancel error.</dd>
<dt>
<b>1</b>INTCONTINUE</dt>
<dd>
Meaningful only for timeout errors (sqletime). It continues to wait for a second timeout period. At the end of the second period, the error handler is called again. In any other case, this value is considered an error and is treated as an intcancel.</dd>
<dt>
<b>2</b>INTCANCEL</dt>
<dd>
Returns FAIL from the DB-Library for Visual Basic function that caused the error.
<p>
For timeout errors (SQLETIME) only, DB-Library will call <b>SqlCancel%</b> in an attempt to cancel the current command batch and flush any pending results. If this <b>SqlCancel% </b>attempt also times out, the connection is broken.

</dd>
</dl>
</dd>
</dl>

<h4><a name="_vbsql1_message_procedure"></a>VBSQL1_Message Procedure</h4>
<p>
The <b>VBSQL1_Message</b> procedure has the following syntax:</p>
<p>
<b>VBSQL1_Message ( </b><i>sqlconn%</i><b>,</b> <i>message&amp;</i><b>,</b> <i>state%</i><b>,</b> <i>severity%</i><b>,</b> <i>msgstr$ </i><b>)</b></p>
<p>
where
<dl>
<dt>
<i>sqlconn%</i></dt>
<dd>
Is the SQL Server connection that encountered an error.</dd>
<dt>
<i>message&amp;</i></dt>
<dd>
Is an integer that is a message number returned by SQL Server. Each number has a corresponding message to which it is associated. For more information about SQL Server messages, see the <i>Microsoft SQL Server Administrator's Companion</i>.</dd>
<dt>
<i>state%</i></dt>
<dd>
Is the SQL Server state number. The number provides information about the context of the current error.</dd>
<dt>
<i>severity%</i></dt>
<dd>
Is an integer that denotes the SQL Server severity of an error. For information about SQL Server severities, see the <i>Microsoft SQL Server Administrator's Companion</i>. </dd>
<dt>
<i>msgstr$</i></dt>
<dd>
Is a message string corresponding to the <i>message</i> number returned by SQL Server. For more information about SQL Server messages, see the <i>Microsoft SQL Server Administrator's Companion</i>.
</dd>
</dl>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
