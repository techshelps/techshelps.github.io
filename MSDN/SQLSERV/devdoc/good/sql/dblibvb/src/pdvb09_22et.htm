<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SqlBCPControl%</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqlbcpcontrol.25"></a>SqlBCPControl%</h1>
<p>
Changes the default settings for various control parameters for a bulk copy between a file and SQL Server.</p>
<h4>Syntax</h4>
<p>
<b>SqlBCPControl% ( </b><i>sqlconn%</i><b>,</b> <i>param%</i><b>,</b> <i>value&amp;</i><b> )</b></p>
<p>
where
<dl>
<dt>
<i>sqlconn%</i></dt>
<dd>
Is a SQL Server connection. The value of <i>sqlconn%</i> is returned by <b>SqlOpen%</b>.</dd>
<dt>
<i>param%</i></dt>
<dd>
One of the following:
<dl>
<dt>
BCPMAXERRS%</dt>
<dd>
Specifies the number of errors allowed before terminating. The default is 10. Providing a value of less than 1 to this field resets it to its default value. If a value larger than 65,535 is specified, this field is set to 65,535.</dd>
<dt>
BCPFIRST%</dt>
<dd>
Specifies the first row to copy. The default is 1. Providing a value of less than 1 to this field resets it to its default value.</dd>
<dt>
BCPLAST%</dt>
<dd>
Specifies the last row to copy. The default is to copy all rows. Providing a value of less than 1 to this field resets it to its default value.</dd>
<dt>
BCPBATCH%</dt>
<dd>
Specifies the number of rows per batch. The default is 0. Providing a value of less than 1 to this field resets it to its default value.</dd>
<dt>
BCPKEEPNULLS</dt>
<dd>
Specifies whether empty data values in the file will be converted to NULL values in the SQL Server table. If this option is set before calling <b>SqlBCPExec%</b>, empty values will be converted to NULL values in the SQL Server table. The default is for empty values to be converted to the column's default value in the SQL Server table.</dd>
</dl>
</dd>
<dt>
<i>value&amp;</i></dt>
<dd>
Is the value for the specified <i>param%</i>.
</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED (1) or FAIL (0).</p>
<h4>Remarks</h4>
<p>
<b>SqlBCPControl%</b> sets various control parameters for bulk-copy operations, including the number of errors allowed before ending an operation, the numbers of the first and last rows to copy, and the batch size.</p>
<p>
These control parameters are meaningful only when you are copying between an operating-system file and a SQL Server table.</p>
<h4>Example</h4>
<pre>'Initialize bcp.
Result% = 
SqlBCPInit%(Sqlconn%,"condb..address", "address.add", "addr.err", DBIN%)
IF Result% = FAIL THEN
   SQLExit
   SQLWinExit
   End
END IF
'Set the number of rows per batch.
Result% = SqlBDPControl%(Sqlconn%, BCPBATCH%, 1000)
IF Result% = FAIL THEN
   PRINT "SqlBCPControl% failed to set batching behavior."
   PRINT
   SQLExit
   SQLWinExit
   End
END IF
'Set file column count.
Result% = SQLBCPColumns%(Sqlconn%, 1)
IF Result% = FAIL THEN
   PRINT "SqlBCPColumns% failed."
   PRINT
   SQLExit
   SQLWinExit
   End
END IF

'Set file format.
Result% = SqlBCPColfmt%(Sqlconn%, 1, 0, 0, -1, Chr$(13), 1, 1)
IF Result% = FAIL THEN
   PRINT "SqlBCPColfmt% failed."
   PRINT
   SQLExit
   SQLWinExit
   End
END IF

'Now, execute the bulk-copy.
Result% = SqlBCPExec%(Sqlconn%, RowsCopied&amp;)
IF Result% = FAIL THEN
   PRINT "Incomplete bulk-copy. Only "; RowsCopied&amp;; " rows copied."
   PRINT
   SQLExit
   SQLWinExit
   End
END IF
</pre>
<h4>See Also</h4>
<p>
<a href="pdvb09_60qd.htm"><b>SqlBCPColfmt%</b></a>, <a href="pdvb09_88mt.htm"><b>SqlBCPColumns%</b></a>, <a href="pdvb09_3vw5.htm"><b>SqlBCPExec%</b></a>, <a href="pdvb09_55it.htm"><b>SqlBCPInit%</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
