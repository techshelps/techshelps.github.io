<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Up the Error- and Message-Handling Interface</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_setting_up_the_error_and_message_handling_interface"></a>Setting Up the Error- and Message-Handling Interface</h2>
<p>
The error-handling interface between your application and DB-Library for Visual Basic is provided by a custom control. When you add this custom control to your application, it installs two error handler event procedures, assigns them the default names <b>VBSQL1_Error</b> and <b>VBSQL1_Message</b>, and supplies the appropriate parameter list as part of each procedure name. </p>
<p>
You must explicitly include the DB-Library for Visual Basic procedures for handling errors in your application's primary form before you can use them in your application. These error-handling procedures are contained in the VBSQL.VBX file as part of a custom-control tool that is represented by a stop sign icon in the Toolbox palette. You can place only one error-handler control in an application. </p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To include the error-handling procedures in your application</h5>
<ol>
<li>
From the File menu, choose Add File to add the file VBSQL.VBX (available in the C:\SQL60\BIN directory by default) to your Project. <p>
Visual Basic adds the VBSQL.VBX file to your Project window and adds the VBSQL.VBX error handler to the bottom of the Toolbox as a custom control that is shown as a stop sign.
</li>
<li>
Select the error-handler custom control and place it on your startup form. Only a single copy of the VBSQL.VBX control should be used for an application. The form containing the VBSQL.VBX should remain loaded as long as the DB-Library application is running, and it should be the last form unloaded when the application ends.<p>
It appears on the form with a default name of VBSQL1. (Since the VBSQL1 custom control requires no action from the user to make it active, you can set its <i>Visible</i> property to FALSE (0) to make it invisible.) The code for the startup form now includes the object VBSQL1 and includes procedure templates for two error event handlers: <b>VBSQL1_Error</b> and <b>VBSQL1_Message</b>.
</li>
</ol>
<p>
To implement your error handlers, add code to these event procedures to perform whatever specialized error handling is appropriate to your application. Note that you can also rename the error-handler custom control using the Properties window.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
