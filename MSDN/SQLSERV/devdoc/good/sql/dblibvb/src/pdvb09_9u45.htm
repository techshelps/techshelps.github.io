<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SqlBCPColumnFormat%</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqlbcpcolumnformat.25"></a>SqlBCPColumnFormat%</h1>
<p>
Sets up the column format for the input file in a bulk-copy operation. This is a utility function that combines <b>SqlBCPColumns%</b> and <b>SqlBCPColfmt%</b> in one step.</p>
<h4>Syntax</h4>
<p>
<b>SqlBCPColumnFormat% ( </b><i>sqlconn%</i><b>,</b> <i>col</i>( )<b>,</b> <i>numcols%</i><b> )</b></p>
<p>
where
<dl>
<dt>
<i>sqlconn%</i></dt>
<dd>
Is a SQL Server connection. The value of <i>sqlconn%</i> is returned by <b>SqlOpen%</b>.</dd>
<dt>
<i>col</i>( )</dt>
<dd>
Is an array of a user-defined datatype (structure) defined as <i>BCPColData</i>, that contains the following elements:
<dl>
<dt>
<i>ftype%</i></dt>
<dd>
Is the datatype of this column in the operating-system file. If the datatype of this column is different from the datatype of the corresponding column in the database table (<i>tcol%</i>), the data is converted automatically. To specify the same data type as in the corresponding column in the database table (<i>tcol%</i>), set this parameter to 0.</dd>
<dt>
<i>fplen%</i></dt>
<dd>
Is the length of the length prefix for this column in the operating-system file. Legal prefix lengths are 1, 2, and 4 bytes. To avoid using a length prefix, set this parameter to 0. So that the<b> bcp</b> utility will determine whether to use a length prefix, set this parameter to -1. In that case, the <b>bcp</b> utility uses a length prefix of whatever length is necessary if the database column length is variable.
<p>
When more than one means of specifying the column length of an operating-system file is used (such as a length prefix and a maximum column length, or a length prefix and a terminator sequence), the <b>bcp</b> utility uses the one that results in the shortest amount of data being copied.

<p>
One valuable use for length prefixes is to simplify the specifying of null data values in an operating-system file. For example, assume that you have a length prefix of 1 byte for a 4-byte integer column. Ordinarily, the length prefix contains a value of 4 to indicate that a 4-byte value follows. However, if the value of the column is an empty string, the length prefix can be set to 0 to indicate that 0 bytes follow.
</dd>
<dt>
<i>fcollen&amp;</i></dt>
<dd>
Is the maximum length of this column's data in the operating-system file, not including the length of any length prefix and/or terminator. Setting <i>fcollen&amp;</i> to 0 signifies that the data is an empty string. Setting <i>fcollen&amp;</i> to - 1 directs the system to ignore this parameter, indicating that there is no default maximum length.
<p>
For fixed-length datatypes such as integers, the length of the data is constant, except for the special case of null values. Therefore, for fixed-length datatypes, <i>fcollen&amp;</i> must always be -1 except when the data is an empty string, in which case <i>fcollen&amp;</i> must be 0. For character, text, binary, and image data, <i>fcollen&amp;</i> can be -1, 0, or any positive value. If <i>fcollen&amp;</i> is -1, the system uses either a length prefix or a terminator sequence to determine the length of the data. (If both are supplied, the system uses the one that results in the shorter amount of data being copied.) If <i>fcollen&amp;</i> is  - 1 and neither a prefix length nor a terminator sequence is specified, the system returns an error message. If <i>fcollen&amp;</i> is 0, the system assumes that the data is an empty string. If <i>fcollen&amp;</i> is a positive value, the system uses <i>fcollen&amp;</i> as the maximum data length. However, if a positive <i>fcollen&amp;</i> and a prefix length and/or terminator sequence are provided, the system determines the data length by using the method that results in the shortest amount of data being copied.
</dd>
<dt>
<i>fterm$</i></dt>
<dd>
Is the terminator sequence to be used for this column. This parameter is useful for <i>character</i>, <i>text</i>, <i>binary</i>, and <i>image</i> datatypes, because all other types are of fixed length. To avoid using a terminator, set this parameter to an empty string. To set the terminator to null-terminated, set <i>fterm$</i> to <i>chr$</i>(0). To make the tab character the terminator, set <i>fterm$</i> to <i>chr$</i>(9). To make the newline character the terminator, set <i>fterm$</i> to <i>chr$</i>(13)  <i>chr$</i>(10). The length of <i>fterm$</i> is limited to 30 characters.
<p>
When more than one means of specifying the column length of an operating-system file is used (such as a terminator and a length prefix, or a terminator and a maximum column length), the <b>bcp</b> utility uses the one that results in the shortest amount of data being copied.
</dd>
<dt>
<i>ftlen%</i></dt>
<dd>
Is the length, in bytes, of the terminator sequence to be used for this column. To avoid using a terminator, set this value to -1.</dd>
<dt>
<i>tcol%</i></dt>
<dd>
Is the corresponding column in the database table. If this value is 0, the column in the database table is not copied. The first column is column 1.</dd>
</dl>
</dd>
<dt>
<i>numcols%</i></dt>
<dd>
Is the total number of columns to be copied.
</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED (1) or FAIL (0).</p>
<h4>Remarks</h4>
<p>
<b>SqlBCPColumnFormat%</b> is equivalent to calling <b>SqlBCPColumns%</b> (to set the number of columns) and repeated calls to <b>SqlBCPColfmt%</b> (to set the format).</p>
<p>
The size of the <i>col</i>( ) array is equal to the number of columns (<i>numcols%</i>). To access an element of the <i>col</i> structure, you must use the point (.) notation. For example:</p>
<pre>col.elementname 
</pre>
<p>
For example, the following statement sets the datatype of the column in the operating-system file:</p>
<pre>Col.ftype% = SystemFileType% 
</pre>
<h4>See Also</h4>
<p>
<a href="pdvb09_60qd.htm"><b>SqlBCPColfmt%</b></a>, <a href="pdvb09_88mt.htm"><b>SqlBCPColumns%</b></a></p>
<p>&nbsp;</p></body>
</HTML>
