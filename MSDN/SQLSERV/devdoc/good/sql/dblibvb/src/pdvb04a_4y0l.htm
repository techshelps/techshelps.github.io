<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SqlColInfo%</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqlcolinfo.25"></a>SqlColInfo%</h1>
<p>
Returns information about a regular column or a compute column in a result set, or a column in a cursor.</p>
<h4>Syntax</h4>
<p>
<b>SqlColInfo% ( </b><i>sqlhandle%</i><b>,</b><i> type%</i><b>,</b> <i>column%</i><b>,</b><i> computeid%</i><b>,</b><i> columninfo </i><b>)</b></p>
<p>
where
<dl>
<dt>
<i>sqlhandle%</i></dt>
<dd>
Is a SQL Server connection or a cursor handle. If <i>type%</i> is SQLCI_REGULAR% or SQLCI_ALTERNATE%, this is a SQL Server connection (returned by <b>SqlOpen%)</b>. If <i>type%</i> is SQLCI_CURSOR%, this is a cursor handle (returned by <b>SqlCursorOpen%)</b>.</dd>
<dt>
<i>type%</i></dt>
<dd>
Is the type of column information to return. The following table describes the different <i>type%</i> values:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=32%></th>
<th align=left width=68%></th>
</tr>
<tr valign=top>
<th align=left width=32%></th>
<th align=left width=68%></th>
</tr>
<tr valign=top>
<th align=left width=32%><i>type%</i></th>
<th align=left width=68%>Description</th>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=68%></td>
</tr>
<tr valign=top>
<td width=32%>SQLCI_REGULAR%</td>
<td width=68%>Return information about a regular column in the current result set.</td>
</tr>
<tr valign=top>
<td width=32%>SQLCI_ALTERNATE%</td>
<td width=68%>Returns information about a compute column in the current result set.</td>
</tr>
<tr valign=top>
<td width=32%>SQLCI_CURSOR%</td>
<td width=68%>Returns information about a column in the open cursor.</td>
</tr>
</table><br>

</dd>
<dt>
<i>column%</i></dt>
<dd>
The number of the column. The first column is number 1.</dd>
<dt>
<i>computeid%</i></dt>
<dd>
If <i>type%</i> is <b>SQLCI_ALTERNATE</b>, this is the ID that identifies the compute (the result of a COMPUTE clause) value. The <i>computeid%</i> is returned by <b>SqlNextRow%</b> or <b>SqlGetRow%</b>.</dd>
<dt>
<i>columninfo</i></dt>
<dd>
A <i>ColInfo</i> structure that DB-Library will use to return detailed information about the specified column.
<p>
The <i>ColInfo</i> structure is defined as follows:

<pre>Type ColInfo
    Name As String * 31
    ActualName As String * 31
    TableName As String * 31
    CType As Integer
    UserType As Long
    MaxLength As Long
    Precision As Integer
    Scale As Integer
    VarLength As Integer
    Null As Integer
    CaseSensitive As Integer
    Updatable As Integer
    Identity As Integer
End Type</pre>

<p>
The <i>ColInfo</i> fields (and the equivalent DB-Library functions, if any) are described below:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=20%></th>
<th align=left width=80%></th>
</tr>
<tr valign=top>
<th align=left width=20%></th>
<th align=left width=80%></th>
</tr>
<tr valign=top>
<th align=left width=20%>Field</th>
<th align=left width=80%>Description</th>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%></td>
</tr>
<tr valign=top>
<td width=20%><b>Name</b></td>
<td width=80%>Is the name of the returned column (<b>SqlColName$</b>).</td>
</tr>
<tr valign=top>
<td width=20%><b>ActualName</b></td>
<td width=80%>Is the actual name of the column in <b>TableName</b> if <i>type%</i> is SQLCI_CURSOR%; otherwise, this is the same as <b>Name</b>.</td>
</tr>
<tr valign=top>
<td width=20%><b>TableName</b></td>
<td width=80%>Is the table that contains the column if <i>type%</i> is SQLCI_CURSOR%; otherwise, an empty string.</td>
</tr>
<tr valign=top>
<td width=20%><b>CType</b></td>
<td width=80%>Is the datatype of the column (<b>SqlColType%</b>, <b>SqlAltType%</b>).</td>
</tr>
<tr valign=top>
<td width=20%><b>UserType</b></td>
<td width=80%>Is the user-defined datatype of the column (<b>SqlColUType&amp;</b>, <b>SqlAltUType&amp;</b>).</td>
</tr>
<tr valign=top>
<td width=20%><b>MaxLength</b></td>
<td width=80%>Is the maximum length, in bytes, of the column (<b>SqlColLen%</b>, <b>SqlAltLen%</b>).</td>
</tr>
<tr valign=top>
<td width=20%><b>Precision</b></td>
<td width=80%>The precision if <b>Type</b> is SQLDECIMAL or SQLNUMERIC; otherwise, - 1.</td>
</tr>
<tr valign=top>
<td width=20%><b>Scale</b></td>
<td width=80%>The scale if <b>Type</b> is SQLDECIMAL or SQLNUMERIC; otherwise, - 1.</td>
</tr>
<tr valign=top>
<td width=20%><b>VarLength</b></td>
<td width=80%>Is one of the following:<p>
SUCCEED (1) if the column is variable-length.</p>
<p>
FAIL (0) if the column is fixed-length.</p>
</td>
</tr>
<tr valign=top>
<td width=20%><b>Null</b></td>
<td width=80%>Is one of the following:<p>
SUCCEED (1) if the column allows nulls.</p>
<p>
FAIL (0) if the column does not allow nulls.</p>
<p>
SQLUNKNOWN (2) if nullability is unknown.</p>
</td>
</tr>
<tr valign=top>
<td width=20%><b>CaseSensitive</b></td>
<td width=80%>Is one of the following:<p>
SUCCEED (1) if the column is case sensitive.</p>
<p>
FAIL (0) if the column is case insensitive.</p>
<p>
SQLUNKNOWN (2) if case sensitivity is unknown.</p>
</td>
</tr>
<tr valign=top>
<td width=20%><b>Updatable</b></td>
<td width=80%>Is one of the following:<p>
SUCCEED (1) if the column can be changed.</p>
<p>
FAIL (0) if the column is read-only and cannot be changed.</p>
<p>
SQLUNKNOWN (2) if updatability is unknown.</p>
</td>
</tr>
<tr valign=top>
<td width=20%><b>Identity</b></td>
<td width=80%>Is one of the following:<p>
SUCCEED (1) if the column is an identity column.</p>
<p>
FAIL (0) if the column is not an identity column.</p>
</td>
</tr>
</table><br>


</dd>
</dl>
<h4>Returns</h4>
<p>
succeed (1) or fail (0).</p>
<h4>Remarks</h4>
<p>
The <b>SqlColInfo%</b> function fills the supplied <i>ColInfo</i> structure with information about the specified column. Call this function after <b>SqlResults%</b> returns SUCCEED, or after <b>SqlCursorOpen%</b> returns a cursor handle.</p>
<h4>See Also</h4>
<p>
<a href="pdvb04a_4to5.htm"><b>SqlAltLen%</b></a>, <a href="pdvb04a_1wl1.htm"><b>SqlAltType%</b></a>, <a href="pdvb04a_81x2.htm"><b>SqlAltUType&amp;</b></a>, <a href="pdvb04a_48mt.htm"><b>SqlColLen%</b></a>, <a href="pdvb04a_84l0.htm"><b>SqlColName$</b></a>, <a href="pdvb04a_4i7p.htm"><b>SqlColType%</b></a>, <a href="pdvb04a_4i7q.htm"><b>SqlColUType&amp;</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
