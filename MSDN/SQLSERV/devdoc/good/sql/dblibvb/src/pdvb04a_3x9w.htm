<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SqlChange$</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqlchange.24"></a>SqlChange$</h1>
<p>
Determines whether a command batch has changed the current database to another database.</p>
<h4>Syntax</h4>
<p>
<b>SqlChange$ ( </b><i>sqlconn%</i><b> )</b></p>
<p>
where
<dl>
<dt>
<i>sqlconn%</i></dt>
<dd>
Is a SQL Server connection. The value of <i>sqlconn%</i> is returned by <b>SqlOpen%</b>.
</dd>
</dl>
<h4>Returns</h4>
<p>
The name of the new database, if any. If the database has not changed, an empty string is returned.</p>
<h4>Remarks</h4>
<p>
<b>SqlChange$</b> informs the application of a switch from one database to another by catching any instance of the Transact-SQL USE statement.</p>
<p>
When connected to SQL Server 4.2, a USE statement does not take effect until the end of the batch. The <b>SqlChange$</b> function is therefore useful only in determining whether the current command batch has changed to another database for subsequent command batches. The simplest way to keep track of database switches is to call <b>SqlChange$</b> when <b>SqlResults%</b> returns NOMORERESULTS at the end of each command batch.</p>
<p>
When connected to SQL Server 6.0, a USE statement takes effect immediately.</p>
<p>
You can also get the name of the current database by calling <b>SqlName$</b>.</p>
<h4>See Also</h4>
<p>
<a href="pdvb04c_4s6t.htm"><b>SqlExec%</b></a>, <a href="pdvb04b_2cvo.htm"><b>SqlName$</b></a>, <a href="pdvb04c_07jp.htm"><b>SqlResults%</b></a>, <a href="pdvb04c_6rzp.htm"><b>SqlSend%</b></a>, <a href="pdvb04c_4hmd.htm"><b>SqlUse%</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
