<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SqlClrOpt%</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqlclropt.25"></a>SqlClrOpt%</h1>
<p>
Clears an option set by <b>SqlSetOpt%</b>. </p>
<h4>Syntax</h4>
<p>
<b>SqlClrOpt% ( </b><i>sqlconn%</i><b>,</b> <i>opt%</i><b>,</b> <i>optparam$</i><b> )</b></p>
<p>
where
<dl>
<dt>
<i>sqlconn%</i></dt>
<dd>
Is a SQL Server connection. The value of <i>sqlconn%</i> is returned by <b>SqlOpen%</b>. When <i>sqlconn%</i> is 0, the specified option is cleared for every active SQL Server connection.</dd>
<dt>
<i>opt%</i></dt>
<dd>
Is the option to be cleared. Do not enclose <i>opt%</i> in quotation marks. For a list of the options available in DB-Library for Visual Basic, see <a href="pdvba_6yup.htm">DB-Library for Visual Basic Options</a>. </dd>
<dt>
<i>optparam$</i></dt>
<dd>
Is a parameter for an option. You must include <i>optparam$</i> for all options, whether or not they take parameters. Enclose <i>optparam$</i> in quotation marks.
<p>
If an option does not take a parameter, <i>optparam$</i> is ignored. If an option does take a parameter, <i>optparam$</i> is ignored for all options except SQLOFFSET and SQLSTAT.

<p>
The SQLOFFSET and SQLSTAT options can have several settings, each with a different parameter. In these cases, <b>SqlClrOpt%</b> needs a valid <i>optparam$</i> to determine which option parameter to clear.

<p>
For a list of the options available in DB-Library for Visual Basic, see <a href="pdvba_6yup.htm">DB-Library for Visual Basic Options</a>. 

</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED (1) or FAIL (0).</p>
<h4>Remarks</h4>
<p>
<b>SqlClrOpt%</b> turns off options that have been set with <b>SqlSetOpt%</b>. Although you can set and clear some options directly through Transact-SQL, design your application to use <b>SqlSetOpt%</b> and <b>SqlClrOpt%</b> to set and clear options because <b>SqlSetOpt%</b> and <b>SqlClrOpt%</b> provide a uniform interface for setting and clearing all options. With these functions, your application can also use <b>SqlIsOpt%</b> to check the status of an option.</p>
<p>
<b>SqlClrOpt%</b> does not immediately clear the options specified (with the exception of sqlbuffer and sqlnoautofree). Options are cleared when you send the statements in the command buffer to SQL Server by invoking <b>SqlExec%</b>. Also, the results of the command generated by <b>SqlClrOpt%</b> are not returned until the command is transferred to SQL Server. Therefore, design your application to expect the results returned from the command string generated by <b>SqlClrOpt%</b>. If an invalid parameter is specified, it is not detected until the command is sent to SQL Server and the results for that command are returned using <b>SqlResults%</b>.</p>
<p>
Note that the command string generated by this function is not immediately sent to SQL Server. Instead, it is buffered within DB-Library and sent the next time <b>SqlExec%</b> is invoked. Therefore, any options requested by this function do not go into effect until then. Also, the results of the command generated by this function are not returned until the command is transferred to SQL Server. The application should be expecting the results returned from the command string generated by this function.</p>
<p>
For a list of the options available in DB-Library for Visual Basic, see <a href="pdvba_6yup.htm">DB-Library for Visual Basic Options</a>. </p>
<h4>See Also</h4>
<p>
<a href="pdvb04b_0a45.htm"><b>SqlIsOpt%</b></a>, <a href="pdvb04c_9pv9.htm"><b>SqlSetOpt%</b></a>; <a href="pdvba_6yup.htm">DB-Library for Visual Basic Options</a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
