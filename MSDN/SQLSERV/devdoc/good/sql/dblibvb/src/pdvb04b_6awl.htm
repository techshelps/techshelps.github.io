<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SqlNextRow%</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqlnextrow.25"></a>SqlNextRow%</h1>
<p>
Reads in the next data row from the row buffer.</p>
<h4>Syntax</h4>
<p>
<b>SqlNextRow% ( </b><i>sqlconn%</i><b> )</b></p>
<p>
where
<dl>
<dt>
<i>sqlconn%</i> </dt>
<dd>
Is a SQL Server connection. The value of <i>sqlconn%</i> is returned by <b>SqlOpen%</b>. 
</dd>
</dl>
<h4>Returns</h4>
<p>
One of five types of values depending on certain conditions:
<ul>
<li>
If <b>SqlNextRow%</b> reads a regular row,<b> </b>REGROW (-1) is returned. Regular rows contain data from columns designated by a SELECT statement.</li>
<li>
If <b>SqlNextRow%</b> is unsuccessful, FAIL (0) is returned.</li>
<li>
If there are no more rows to be read, if the statement returns no rows, or if the server was unable to return more rows (for example, when a deadlock occurs), NOMOREROWS (-2) is returned.</li>
<li>
If row buffering is turned on (using <b>SqlSetOpt%</b> with the SQLBUFFER option) and reading the next row would fill the buffer, BUFFULL (-3) is returned. In this case, no row is read, and to continue, at least one row must be cleared from the top of the row buffer. Clear the row buffer by calling <b>SqlClrBuf</b>. </li>
<li>
If the current row is a compute row, the identification number of the COMPUTE clause is returned.</li>
</ul>
<h4>Remarks</h4>
<p>
Normally, each row is processed in turn by repeatedly calling <b>SqlNextRow%</b>. If row buffering is turned on and the row buffer is cleared by <b>SqlClrBuf</b>, the discarded rows are no longer available. When row buffering is turned off, the last row is cleared when <b>SqlNextRow%</b> returns NOMOREROWS. If row buffering is turned on and you call <b>SqlGetRow%</b> to read a row, you can call <b>SqlNextRow%</b> to return rows in order following the row read by <b>SqlGetRow%</b>. </p>
<p>
<b>SqlResults%</b> must be called and must return SUCCEED before you make any calls to <b>SqlNextRow%</b>. </p>
<p>
You must continue calling <b>SqlNextRow%</b> until it returns NOMOREROWS. This is true even when you know that your query generates only one results row. Even if <b>SqlRows%</b> or <b>SqlCmdRow%</b> returns FAIL (indicating that no rows were returned), you must process the results by calling <b>SqlNextRow%</b> until it returns NOMOREROWS.</p>
<p>
SQL Server can return two types of rows:
<ul>
<li>
Regular rows containing data from columns designated by a SELECT statement's select list.</li>
<li>
Compute rows resulting from the COMPUTE clause.</li>
</ul>
<p>
To help process data rows from SQL Server, <b>SqlNextRow%</b> returns different values according to the type of row. For details, see the previous section, "Returns."</p>
<p>
<b>Note</b>  This function is one of the four that do not return control to the application until the server sends the required response. The application can be blocked for a considerable time if the server is waiting for a lock or is processing a large sort. If this is unacceptable, always call <b>SqlDataReady%</b> before <b>SqlNextRow%</b> and set the DB-Library timeout to regain control periodically.</p>
<h4>Example</h4>
<p>
The following program fragment uses <b>SqlNextRow%</b> to process a regular row:</p>
<pre>'Put the statement into the command buffer.
Result% = SqlCmd%(Sqlconn%, "SELECT data FROM table")

'Send the statement to SQL Server and start execution.
Result% = SqlExec%(Sqlconn%) 
'Process the statement results.
Result% = SqlResults%(Sqlconn%)

'Retrieve and process the data in each row.
DO UNTIL SqlNextRow%(Sqlconn%) = NOMOREROWS

   'Code to print or process row of data.

LOOP
</pre>
<h4>See Also</h4>
<p>
<a href="pdvb04a_80tx.htm"><b>SqlCancel%</b></a>, <a href="pdvb04a_7vsl.htm"><b>SqlCanQuery%</b></a>, <a href="pdvb04a_2s9y.htm"><b>SqlClrBuf</b></a>, <a href="pdvb04b_5qut.htm"><b>SqlGetRow%</b></a>, <a href="pdvb04c_07jp.htm"><b>SqlResults%</b></a>, <a href="pdvb04c_0nud.htm"><b>SqlRows%</b></a>; <a href="pdvba_6yup.htm">DB-Library for Visual Basic Options</a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
