<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SqlDateCrack%</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqldatecrack.25"></a>SqlDateCrack%</h1>
<p>
Converts a string of date and time values into a format more usable to the user. </p>
<h4>Syntax</h4>
<p>
<b>SqlDateCrack% ( </b><i>sqlconn%</i><b>,</b> <i>dateinfo</i><b>,</b> <i>datetime$</i><b> )</b> </p>
<p>
where
<dl>
<dt>
<i>sqlconn%</i> </dt>
<dd>
Is a SQL Server connection. The value of <i>sqlconn%</i> is returned by <b>SqlOpen%</b>.</dd>
<dt>
<i>dateinfo</i> </dt>
<dd>
Identifies a structure containing the components of the <i>datetime$</i> string. The <i>dateinfo</i> structure contains the following fields:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=20%></th>
<th align=left width=80%></th>
</tr>
<tr valign=top>
<th align=left width=20%></th>
<th align=left width=80%></th>
</tr>
<tr valign=top>
<th align=left width=20%>Field</th>
<th align=left width=80%>Description</th>
</tr>
<tr valign=top>
<td width=20%></td>
<td width=80%></td>
</tr>
<tr valign=top>
<td width=20%><i>year%</i></td>
<td width=80%>A number of a year in the range 1753 through 9999.</td>
</tr>
<tr valign=top>
<td width=20%><i>quarter%</i></td>
<td width=80%>A number of a quarter of a year in the range 1 though 4.</td>
</tr>
<tr valign=top>
<td width=20%><i>month%</i></td>
<td width=80%>A number of a month in the range 1 through 12.</td>
</tr>
<tr valign=top>
<td width=20%><i>dayofyear%</i></td>
<td width=80%>A number of a day of a year in the range 1 through 366. Leap years are counted.</td>
</tr>
<tr valign=top>
<td width=20%><i>day%</i></td>
<td width=80%>A number of a day of a month in the range 1 through 31.</td>
</tr>
<tr valign=top>
<td width=20%><i>week%</i></td>
<td width=80%>A number of a week of a year in the range 1 through 54. Leap years are counted.</td>
</tr>
<tr valign=top>
<td width=20%><i>weekday%</i></td>
<td width=80%>A number of the day of a week in the range 1 through 7 (Monday though Sunday).</td>
</tr>
<tr valign=top>
<td width=20%><i>hour%</i></td>
<td width=80%>A number of an hour in the range 0 through 23. </td>
</tr>
<tr valign=top>
<td width=20%><i>minute%</i></td>
<td width=80%>A number of a minute in the range 0 through 59.</td>
</tr>
<tr valign=top>
<td width=20%><i>second%</i></td>
<td width=80%>A number of a second in the range 0 through 59.</td>
</tr>
<tr valign=top>
<td width=20%><i>millisecond%</i></td>
<td width=80%>A number of a millisecond in the range 0 through 999.</td>
</tr>
</table><br>

</dd>
<dt>
<i>datetime$ </i></dt>
<dd>
Is a string containing the date and time.
</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED (1) or FAIL (0).</p>
<h4>Remarks</h4>
<p>
<b>SqlDateCrack%</b> converts a SQL Server DATETIME string into its integer components and puts them into a <i>dateinfo</i> structure.</p>
<p>
Date and time values are maintained in an internal format that is not readily usable. For example, a time value is stored as the number of 300ths of a second since midnight, and a date value is stored as the number of days since January 1, 1900. The <b>SqlDateCrack%</b> function converts the internal value to something easily usable by an application.</p>
<h4>Example</h4>
<pre>'Put the statement into the command buffer.
Result% = SqlCmd%(Sqlconn%, "SELECT name, crdate FROM master..sysdatabases")

'Send the statement to SQL Server and start execution.
Result% = SqlExec%(Sqlconn%)

'Process the statement results.
Result% = SqlResults%(Sqlconn%)

'Retrieve and print the database name and its date info.
DO UNTIL SqlNextRow%(Sqlconn%) = NOMOREROWS
   PRINT "Database Name is "
   PRINT SqlData$(Sqlconn%, 1)
   PRINT
   PRINT "Creation date string info is "
   PRINT SqlData$(Sqlconn%, 2)
   PRINT

   'Break up the creation date into its constituent parts.

   Datetime$ = SqlData$(Sqlconn%, 2)

   SqlDateCrack(Sqlconn%, Dateinfo(), Datetime$)

   'Print the parts of the creation date.
   PRINT
   PRINT "Year = "; Dateinfo.year
   PRINT "Month = "; Dateinfo.month
   PRINT "Day of month = "; Dateinfo.day
   PRINT "Day of year = "; Dateinfo.dayofyear
   PRINT "Day of week = "; Dateinfo.weekday
   PRINT "Hour = "; Dateinfo.hour
   PRINT "Minute = "; Dateinfo.minute
   PRINT "Second = "; Dateinfo.second
   PRINT "Millisecond = "; Dateinfo.millisecond

LOOP
</pre>
<h4>See Also</h4>
<p>
<a href="pdvb04a_89f8.htm"><b>SqlData$</b></a> </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
