<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SqlUpdateText%</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqlupdatetext.25"></a>SqlUpdateText%</h1>
<p>
Updates an existing <i>text</i> or <i>image</i> value. Unlike <b>SqlWriteText%</b> which replaces an entire <i>text</i> or <i>image</i> value, <b>SqlUpdateText%</b> can change only a portion of a <i>text</i> or <i>image</i> value in place.</p>
<h4>Syntax</h4>
<p>
<b>SqlUpdateText% ( </b><i>sqlconn%</i><b>,</b><i> dest_object$</i><b>,</b><i> dest_textptr$</i><b>,</b><i> dest_timestamp$</i><b>,</b><i> update_type%</i><b>, </b><i>insert_offset&amp;</i><b>,</b><i> delete_length&amp;</i><b>,</b><i> src_object$</i><b>,</b><i> src_size&amp;</i><b>,</b><i> src_text$ </i><b>)</b></p>
<p>
where
<dl>
<dt>
<i>sqlconn%</i></dt>
<dd>
A SQL Server connection. The value of <i>sqlconn%</i> is returned by <b>SqlOpen%</b>.</dd>
<dt>
<i>dest_object$</i></dt>
<dd>
Is the destination table and <i>text</i> or <i>image</i> column name (separated with a period) of the existing <i>text</i> or <i>image</i> value to be updated.</dd>
<dt>
<i>dest_textptr$</i></dt>
<dd>
Is the text pointer of the existing <i>text</i> or <i>image</i> value to be updated. Call <b>SqlTxPtr$</b> to get this value. This string cannot be empty.</dd>
<dt>
<i>dest_timestamp$</i></dt>
<dd>
Is the timestamp of the existing <i>text</i> or <i>image</i> value to be updated. Call <b>SqlTxTimeStamp$</b> to get this value. This string cannot be empty.</dd>
<dt>
<i>update_type%</i></dt>
<dd>
The type of update operation to perform.
<p>
Use UTTEXT% to insert new data from a program variable specified in this call to <b>SqlUpdateText%</b>. You must specify an empty <i>src_object$</i> string, a <i>src_size&amp;</i> equal to the size in bytes of the new data value being inserted, and a non-empty <i>src_text$</i> that contains the new data value being inserted.

<p>
Use UTMORETEXT% to insert new data from a program variable with later calls to <b>SqlMoreText%</b>. You must specify an empty <i>src_object$</i> string, a <i>src_size&amp;</i> equal to the total size in bytes of the new data value (that will be inserted by calls to <b>SqlMoreText%</b>), and an empty <i>src_text$</i> string. Then call <b>SqlMoreText% </b>to insert the new data value in chunks.

<p>
Use UTTEXTPTR% to insert new data from a <i>text</i> or <i>image</i> column of an existing table. You must specify a non-empty <i>src_object$</i> string that gives the table and column a <i>src_size&amp;</i> of 0, and a non-empty <i>src_text$</i> string that gives the text pointer (returned by <b>SqlTxPtr$</b>) of the new data value being inserted from the <i>src_object$</i>.

<p>
Use UTDELETEONLY% to only delete existing data. You must specify an <i>insert_offset&amp;</i> value other than -1 and a non-zero <i>delete_length&amp;</i> value. Specify that no new data will be inserted by using an empty <i>src_object$</i> string, a <i>src_size&amp;</i> of 0 and an empty <i>src_text$</i> string.

<p>
By default, a <b>SqlUpdateText%</b> operation is not recorded in the transaction log. You can bitwise OR the UTLOG% bit flag with any of these <i>update_type%</i> values (for example UTTEXT%<b> </b>Or<b> </b>UTLOG%) to indicate that this operation will be recorded in the transaction log.
</dd>
<dt>
<i>insert_offset&amp;</i></dt>
<dd>
Is the zero-based starting position, specified as the number of bytes (from the start of the existing <i>text</i> or <i>image</i> value) to skip before inserting the new data. The existing <i>text</i> or <i>image</i> data beginning at this zero-based starting position will be shifted to the right to make room for the new data. A value of 0 means that the new data will be inserted at the beginning of the existing data value. A value of -1 means that the new data will be appended to the existing data value.</dd>
<dt>
<i>delete_length&amp;</i></dt>
<dd>
Is the number of bytes to delete from the existing <i>text</i> or <i>image</i> value, starting at the <i>insert_offset&amp;</i> position. A value of 0 means that no data will be deleted. A value of -1 means that all data from the <i>insert_offset&amp;</i> position to the end of the existing <i>text</i> or <i>image</i> value will be deleted.</dd>
<dt>
<i>src_object$</i></dt>
<dd>
Is the source table and <i>text</i> or <i>image</i> column name (separated with a period) that can be used as the source of the inserted data. If not empty, the <i>src_size&amp;</i> and <i>src_text$</i> parameters are ignored. If this string is empty, the <i>src_size&amp;</i> and <i>src_text$</i> parameters specify the data to be inserted.</dd>
<dt>
<i>src_size&amp;</i></dt>
<dd>
Is the total size, in bytes, of the source <i>text</i> or <i>image</i> value (specified by <i>src_text$</i>) to be inserted. Use this parameter only if the <i>src_object$</i> parameter is empty.</dd>
<dt>
<i>src_text$</i></dt>
<dd>
Is a pointer to the source data value to be inserted. Use this parameter only if the <i>src_object$</i> parameter is empty.
</dd>
</dl>
<h4>Returns</h4>
<p>
succeed (1) or fail (0).</p>
<h4>Remarks</h4>
<p>
The <b>SqlUpdateText%</b> function can be used to delete existing data and then insert new data, to delete only existing data, or to insert only new data.</p>
<p>
To delete existing data and then insert new data, specify an <i>update_type%</i> other than UTDELETEONLY%, an <i>insert_offset&amp;</i> value other than -1, a non-zero <i>delete_length&amp;</i> value, and the new data to be inserted.</p>
<p>
To delete only existing data, specify an <i>update_type%</i> value of UTDELETEONLY%, an <i>insert_offset&amp;</i> value other than -1 and a non-zero <i>delete_length&amp;</i> value. Do not specify any new data to be inserted.</p>
<p>
To insert only new data, specify an <i>update_type%</i> other than UTDELETEONLY%, a <i>delete_length&amp;</i> value of 0, and the new data to be inserted.</p>
<h4>See Also</h4>
<p>
<a href="pdvb07_1ph1.htm"><b>SqlMoreText%</b></a>, <a href="pdvb07_7vhw.htm"><b>SqlTxPtr$</b></a>, <a href="pdvb07_65o4.htm"><b>SqlTxTimeStamp$</b></a>, <a href="pdvb07_6g1g.htm"><b>SqlTxTsNewVal$</b></a>, <a href="pdvb07_319x.htm"><b>SqlTxTsPut%</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
