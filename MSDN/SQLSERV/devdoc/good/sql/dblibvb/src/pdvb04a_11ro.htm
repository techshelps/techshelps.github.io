<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SqlAData$</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqladata.24"></a>SqlAData$</h1>
<p>
Returns the data in a COMPUTE clause column.</p>
<h4>Syntax</h4>
<p>
<b>SqlAData$ ( </b><i>sqlconn%</i><b>,</b> <i>computeid%</i><b>,</b> <i>column%</i><b> )</b></p>
<p>
where
<dl>
<dt>
<i>sqlconn%</i></dt>
<dd>
Is a SQL Server connection. The value of <i>sqlconn%</i> is returned by <b>SqlOpen%</b>.</dd>
<dt>
<i>computeid%</i></dt>
<dd>
Is the COMPUTE clause. A SELECT statement can have multiple COMPUTE clauses, which can have varying numbers of aggregate operators and aggregate targets. The <i>computeid%</i> is returned by <b>SqlNextRow%</b> or <b>SqlGetRow%</b>.</dd>
<dt>
<i>column%</i></dt>
<dd>
Is the number of the column. The first column returned is number 1.
</dd>
</dl>
<h4>Returns</h4>
<p>
A string containing the data in the compute column. For the SQL Server datatypes <i>binary</i>, <i>varbinary</i>, and <i>image</i>, <b>SqlAData$</b> returns a string of binary data. For all other datatypes, <b>SqlAData$</b> returns a string of characters. When there is no such column or when the data is NULL, an empty string is returned. To make sure that the data really is NULL, always check for a return of 0 by using <b>SqlADLen&amp;</b>.</p>
<h4>Remarks</h4>
<p>
After each call to <b>SqlNextRow%</b> that returns a value greater than 0, use <b>SqlAData$</b> to obtain the data in a particular COMPUTE clause column. The data is not null-terminated. Use <b>SqlADLen&amp;</b> to get the length of the data in a COMPUTE clause column.</p>
<h4>Example</h4>
<pre>'Put commands into the command buffer.
cmd$ = "SELECT db_name(dbid), dbid, size FROM sysusages"
cmd$ = cmd$  " ORDER BY dbid"
cmd$ = cmd$  " COMPUTE SUM(size) BY dbid"
Result% = SqlCmd%(Sqlconn%, cmd$)
'Send commands to SQL Server and start execution.
Result% = SqlExec%(Sqlconn%)
Result% = SqlResults%(Sqlconn%)
'Examine the results of the COMPUTE clause.
IF Result% = SUCCEED THEN
   DO UNTIL Result% = NOMOREROWS
      Result% = SqlNextRow%(Sqlconn%)
      IF Result% = NOMOREROWS THEN Exit DO
      IF Result = REGROW THEN
         PRINT "regular row returned."
         PRINT
      ELSE
         'This row is the result of a COMPUTE clause
         'and Result% is the computeid% of this 
         'COMPUTE clause
         sum = Val(SqlAData$(Sqlconn%, Result%, 1))
         PRINT "sum = "; sum
         PRINT
      END IF
   LOOP
</pre>
<h4>See Also</h4>
<p>
<a href="pdvb04a_4bzq.htm"><b>SqlADLen&amp;</b></a>,<a href="pdvb04a_4to5.htm"> <b>SqlAltLen%</b></a>, <a href="pdvb04a_1wl1.htm"><b>SqlAltType%</b></a>, <a href="pdvb04b_5qut.htm"><b>SqlGetRow%</b></a>, <a href="pdvb04b_6awl.htm"><b>SqlNextRow%</b></a>, <a href="pdvb04b_60mt.htm"><b>SqlNumAlts%</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
