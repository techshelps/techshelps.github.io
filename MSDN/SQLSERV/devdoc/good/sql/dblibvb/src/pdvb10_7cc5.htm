<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SqlGetAltColInfo%</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqlgetaltcolinfo.25"></a>SqlGetAltColInfo%</h1>
<p>
Gets the column ID, datatype, maximum length, type of aggregate function, and aggregate type name of a specific column in the current set of results.</p>
<h4>Syntax</h4>
<p>
<b>SqlGetAltColInfo% ( </b><i>sqlconn%</i><b>,</b> <i>altcolumndata</i><b>,</b> <i>computeid%</i><b>,</b> <i>altcolumn%</i><b> )</b></p>
<p>
where
<dl>
<dt>
<i>sqlconn%</i></dt>
<dd>
Is a SQL Server connection. The value of <i>sqlconn%</i> is returned by <b>SqlOpen%</b>.</dd>
<dt>
<i>altcolumndata</i></dt>
<dd>
Is a user-defined datatype (structure) defined as <i>AltColumnData</i>. It contains the following elements:
<dl>
<dt>
<i>colid%</i></dt>
<dd>
Is an integer value of the column identification number that the aggregate of the compute column applies to.</dd>
<dt>
<i>datatype%</i></dt>
<dd>
Is the datatype of the compute column. See <b>SqlAltType%</b> for the list of datatype token values. If either the <i>computeid%</i> or the <i>altcolumn%</i> is invalid, this value is - 1.</dd>
<dt>
<i>maxlen&amp;</i></dt>
<dd>
The maximum length, in bytes, that the data in the column can be.</dd>
<dt>
<i>aggtype%</i></dt>
<dd>
The type of aggregate operator of the compute column. See <b>SqlAltOpt%</b> for the list of aggregate function types.</dd>
<dt>
<i>aggopname$</i></dt>
<dd>
A string containing the name of the aggregate operator used by SQL Server ¾ for example, SUM, AVG, and MAX.</dd>
</dl>
</dd>
<dt>
<i>computeid%</i></dt>
<dd>
Is the compute ID. A SELECT statement can have multiple COMPUTE clauses, each of which can have a different number of aggregate operators and aggregate targets. The <i>computeid%</i> is returned by <b>SqlNextRow%</b> or <b>SqlGetRow%.</b></dd>
<dt>
<i>altcolumn%</i></dt>
<dd>
Is the number of the column. The first column returned is number 1.
</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED (1) or FAIL (0). The column ID, datatype, maximum length, type of aggregate function, and name of the aggregate operator type are returned by the <i>altcolumndata</i> parameter.</p>
<h4>Remarks</h4>
<p>
<b>SqlGetAltColInfo%</b> performs the actions of several other Visual Basic functions and puts the results of the functions in the corresponding elements of the <i>altcolumndata</i> parameter. <b>SqlGetAltColInfo%</b> is the equivalent of calling <b>SqlAltColId%</b>, <b>SqlAltLen%</b>, <b>SqlAltOp%</b>, and <b>SqlAltType%</b>. To access an element returned by <i>altcolumndata</i>, you must use the point (.) notation:</p>
<pre>altcolumndata.elementname </pre>
<p>
For example, the following statement gets the column name returned by <i>altcolumndata</i> :</p>
<pre>AggregateOperatorName$ = AltColumnData.AggOpName$</pre>
<h4>Example</h4>
<pre>Dim AltColDetails As AltColumnData
'Put commands into the command buffer.
cmd$ = "SELECT title_id, price, advance FROM titles"
cmd$ = cmd$  " COMPUTE SUM(price), MAX(advance)"
Result% = SqlCmd%(SqlConn%, cmd$)
'Send the command to SQL Server and start execution.
Result% = SqlExec%(SqlConn%)
Result% = SqlResults%(SqlConn%)

'Get the column ID, datatype, and name of the aggregate operator from   
 compute columns and print the results.
IF Result% = SUCCEED THEN
   DO UNTIL SqlNextRow%(SqlConn%) = NOMOREROWS
      IF Result% = REGROW THEN
         PRINT "regular row returned."
         PRINT
      ELSE
         GetAltColInfo% = SqlGetAltColInfo%(SqlConn%, AltColDetails, 
                        ComputeId%, AltColumn%)
         IF GetAltColInfo% = SUCCEED THEN
            AltColumnID% = AltColDetails.ColID%
            ColDatatype% = AltColDetails.Datatype%
            AggregateOperator$ = AltColDetails.AggOpName$
            PRINT "Column ID of compute column = "  AltColumnID%
            PRINT "Datatype of column = "  ColData type%
            PRINT "Aggregate Operator of column = "  AggregateOperator$
            PRINT
         END IF
      END IF
   LOOP
</pre>
<h4>See Also</h4>
<p>
<a href="pdvb04a_5cmt.htm"><b>SqlAltColId%</b></a>, <a href="pdvb04a_4to5.htm"><b>SqlAltLen%</b></a>, <a href="pdvb04a_8n5h.htm"><b>SqlAltOp%</b></a>, <a href="pdvb04a_1wl1.htm"><b>SqlAltType%</b></a>, <a href="pdvb10_8gmt.htm"><b>SqlGetColumnInfo%</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
