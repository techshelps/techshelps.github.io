<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SqlBCPColfmt%</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqlbcpcolfmt.25"></a>SqlBCPColfmt%</h1>
<p>
Specifies the format of an operating-system file in a bulk copy into or out of SQL Server.</p>
<h4>Syntax</h4>
<p>
<b>SqlBCPColfmt% ( </b><i>sqlconn%</i><b>,</b> <i>fcolumn%</i><b>,</b> <i>ftype%</i><b>,</b> <i>fplen%</i><b>,</b> <i>fclen&amp;</i><b>,</b> <i>fterm$</i><b>,</b> <i>ftlen%</i><b>,</b> <i>tcol%</i><b> )</b></p>
<p>
where
<dl>
<dt>
<i>sqlconn%</i></dt>
<dd>
Is a SQL Server connection. The value of <i>sqlconn%</i> is returned by <b>SqlOpen%</b>.</dd>
<dt>
<i>fcolumn%</i></dt>
<dd>
Is the column number in the operating-system file whose format is being specified. The first column is number 1.</dd>
<dt>
<i>ftype%</i></dt>
<dd>
Is the datatype of this column in the operating-system file. If the specified datatype is different from the datatype of the corresponding column in the database table (<i>tcol%</i>), the datatype is converted automatically. To specify the same datatype as in the corresponding column of the database table (<i>tcol%</i>), set this parameter to 0.
<p>
For a bulk copy out of SQL Server into a file, when <i>ftype%</i> is SQLDECIMAL or SQLNUMERIC:

<ul>
<li>
If the source column is not <i>decimal</i> or <i>numeric</i>, the default precision and scale are used.</li>
<li>
If the source column is <i>decimal</i> or <i>numeric</i>, the precision and scale of the source column are used.</li>
</ul>
</dd>
<dt>
<i>fplen%</i></dt>
<dd>
Is the length of the length prefix for this column in the operating-system file. Legal prefix lengths are 1, 2, and 4 bytes. To avoid using a length prefix, set this parameter to 0. So that DB-Library will determine whether to use a length prefix, set this parameter to -1. In that case, DB-Library uses a length prefix of whatever length is necessary if the database column length is variable.
<p>
If more than one means of specifying the column length of an operating-system file is used (such as a length prefix and a maximum column length, or a length prefix and a terminator sequence), DB-Library uses the one that results in the shortest amount of data being copied.

<p>
One valuable use of length prefixes is to simplify the specification of null data values in an operating-system file. For example, assume that you have a 1-byte length prefix for a 4-byte integer column. Ordinarily, the length prefix contains a value of 4 to indicate that a 4-byte value follows. However, if the value of the column is NULL, the length prefix can be set to 0 to indicate that 0 bytes follow.
</dd>
<dt>
<i>fclen&amp;</i></dt>
<dd>
Is the maximum length of this column's data in the operating-system file, not including the length of any length prefix and/or terminator. Setting <i>fclen&amp;</i> to 0 signifies that the data is NULL. Setting <i>fclen&amp;</i> to -1 directs the system to ignore this parameter, indicating that there is no default maximum length.
<p>
For fixed-length datatypes such as integers, the length of the data is constant, except in the special case of null values. Therefore, for fixed-length datatypes, <i>fclen&amp;</i> must always be -1 except when the data is NULL, in which case <i>fclen&amp;</i> must be 0. For character, text, binary, and image data, <i>fclen&amp;</i> can be <br>
- 1, 0, or any positive value. When <i>fclen&amp;</i> is -1, the system uses either a length prefix or a terminator sequence to determine the length of the data. (If both are supplied, the system uses the one that results in the shorter amount of data being copied.) If <i>fclen&amp;</i> is -1 and neither a prefix length nor a terminator sequence is specified, the system returns an error message. If <i>fclen&amp;</i> is 0, the system assumes the data is NULL. If <i>fclen&amp;</i> is a positive value, the system uses <i>fclen&amp;</i> as the maximum data length. However, if a positive <i>fclen&amp;</i> and a prefix length and/or terminator sequence are provided, the system determines the data length by using the method that results in the shortest amount of data being copied.
</dd>
<dt>
<i>fterm$</i></dt>
<dd>
Is the terminator sequence to be used for this column. This parameter is useful primarily for character, text, binary, and image datatypes, because all other types are of fixed length. To avoid using a terminator, set this parameter to NULL. To set the terminator to NULL, set <i>fterm$</i> to <i>chr$</i>(0). To make the tab character the terminator, set <i>fterm$</i> to <i>chr$</i>(9). To make the newline character the terminator, set <i>fterm$</i> to <i>chr$</i>(13)  <i>chr$</i>(10).
<p>
If more than one means of specifying the column length of an operating-system file is used (such as a terminator and a length prefix, or a terminator and a maximum column length), DB-Library uses the one that results in the shortest amount of data being copied.
</dd>
<dt>
<i>ftlen%</i></dt>
<dd>
Is the length, in bytes, of the terminator sequence to be used for this column. To avoid using a terminator, set this value to 0.</dd>
<dt>
<i>tcol%</i></dt>
<dd>
Is the corresponding column number in the database table. If this value is 0, this column is not copied. The first column number is column 1.
</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED (1) or FAIL (0).</p>
<h4>Remarks</h4>
<p>
<b>SqlBCPColfmt%</b> specifies the format of the operating-system file for bulk copies. The format of a bulk-copy operation contains the following parts:
<ul>
<li>
A mapping from the columns in the operating-system file to columns in the database.</li>
<li>
The datatype of each column in the operating-system file.</li>
<li>
The length of the optional-length prefix of each column.</li>
<li>
The maximum length of the data in a column in the operating-system file.</li>
<li>
The optional terminating-byte sequence in each column.</li>
<li>
The length of the optional terminating-byte sequence in each column.</li>
</ul>
<p>
Each call to <b>SqlBCPColfmt%</b> specifies the format for one column in the operating system file. For example, when you have a table with five columns and want to change the default settings for three of those columns, first call <b>SqlBCPColumns%(5)</b>, and then call <b>SqlBCPColfmt%</b> five times, with three of those calls setting your custom format. Set <i>ftype%</i> for the remaining two calls to 0 and <i>fplen%</i>, <i>fclen&amp;</i>, and <i>ftlen%</i> to -1. These settings copy all five columns ¾ three with your customized format and two with the default format.</p>
<p>
You must call <b>SqlBCPColumns%</b> before you call <b>SqlBCPColfmt%</b>.</p>
<p>
You must call <b>SqlBCPColfmt%</b> once and only once for every column in the operating-system file, regardless of whether those columns use the default format or are skipped.</p>
<p>
To skip a column, set <i>tcol%</i> to 0.</p>
<h4>See Also</h4>
<p>
<a href="pdvb09_9u45.htm"><b>SqlBCPColumnFormat%</b></a>, <a href="pdvb09_88mt.htm"><b>SqlBCPColumns%</b></a>, <a href="pdvb09_22et.htm"><b>SqlBCPControl%</b></a>, <a href="pdvb09_3vw5.htm"><b>SqlBCPExec%</b></a>, <a href="pdvb09_55it.htm"><b>SqlBCPInit%</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
