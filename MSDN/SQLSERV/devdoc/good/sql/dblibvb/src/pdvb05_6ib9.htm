<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SqlCursorInfoEx%</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqlcursorinfoex.25"></a>SqlCursorInfoEx%</h1>
<p>
Returns information about a client cursor, a transparent server cursor, or an explicit server cursor.</p>
<h4>Syntax</h4>
<p>
<b>SqlCursorInfoEx%( </b><i>cursorhandle%</i><b>, </b><i>cursorinfo </i><b>)</b></p>
<p>
where
<dl>
<dt>
<i>cursorhandle%</i></dt>
<dd>
Is a cursor handle returned by <b>SqlCursorOpen%</b>.</dd>
<dt>
<i>cursorinfo</i></dt>
<dd>
Is a <i>SqlCursorInfo</i> structure that DB-Library will fill with information about the specified cursor.
<p>
The <i>SqlCursorInfo</i> structure is defined as follows:

<pre>Type SqlCursorInfo
    TotCols As Long
    TotRows As Long
    CurRow As Long
    TotRowsFetched As Long
    CursorType As Long
    Status As Long
End Type
</pre>

<p>
The <i>SqlCursorInfo</i> fields are described below:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%></th>
<th align=left width=64%></th>
</tr>
<tr valign=top>
<th align=left width=36%></th>
<th align=left width=64%></th>
</tr>
<tr valign=top>
<th align=left width=36%>Field</th>
<th align=left width=64%>Description</th>
</tr>
<tr valign=top>
<td width=36%></td>
<td width=64%></td>
</tr>
<tr valign=top>
<td width=36%><b>TotCols</b></td>
<td width=64%>Is the total number of columns in the cursor.</td>
</tr>
<tr valign=top>
<td width=36%><b>TotRows</b></td>
<td width=64%>Is the total number of rows in the cursor results set.<p>
<b>Client cursor:</b></p>
<p>
For a keyset cursor, this number is always valid. For a dynamic cursor, this number is valid only if the current fetch buffer contains the last row in the cursor results set; otherwise, - 1 is returned.</p>
<p>
<b>Transparent server cursor, explicit server cursor:</b></p>
<p>
For a dynamic cursor, - 1 is returned.</p>
<p>
For a keyset cursor, if the <b>Status</b> field is CU_FILLING, the asynchronous population of the cursor results set is incomplete, and this value indicates the number of rows populated. If the <b>Status</b> field is CU_FILLED, the cursor results set is completely populated, and this value indicates the total number of rows in the cursor results set.</p>
</td>
</tr>
<tr valign=top>
<td width=36%><b>CurRow</b></td>
<td width=64%>Is the row number within the cursor results set of the current cursor position (first row of the fetch buffer). The first row of the cursor results set is number 1.<p>
<b>Client cursor:</b></p>
<p>
This value will be 0.</p>
<p>
<b>Transparent server cursor, explicit server cursor:</b></p>
<p>
For a keyset cursor, this value is always valid. </p>
<p>
For a dynamic cursor, this value will always be 1 when the current position is within the cursor results set.</p>
<p>
This value will be 0 if the current position is before the beginning of the cursor. This value will be - 1 if the current position is after the end of the cursor.</p>
</td>
</tr>
<tr valign=top>
<td width=36%><b>TotRowsFetched</b></td>
<td width=64%>Is the total number of valid rows in the current fetch buffer.</td>
</tr>
<tr valign=top>
<td width=36%><b>Type</b></td>
<td width=64%>Is a bitmap of cursor type, scroll option, and concurrency control information. It is a series of the following values ORed together:<p>
<b>Type:</b></p>
<p>
CU_CLIENT: Client cursor</p>
<p>
CU_SERVER: Transparent server cursor or explicit server cursor</p>
<p>
<b>Scroll option:</b></p>
<p>
CU_DYNAMIC: Dynamic cursor</p>
<p>
CU_FORWARD: Forward-only dynamic cursor</p>
<p>
CU_KEYSET: Keyset cursor</p>
<p>
CU_INSENSITIVE: Insensitive keyset cursor</p>
<p>
CU_MIXED: Mixed-mode cursor (provided for backward compatibility only)</p>
<p>
<b>Concurrency control:</b></p>
<p>
CU_READONLY: Read-only concurrency</p>
<p>
CU_LOCKCC: Intent to update concurrency</p>
<p>
CU_OPTCC: Optimistic concurrency based on timestamp or values</p>
<p>
CU_OPTCCVAL: Optimistic concurrency based on values</p>
</td>
</tr>
<tr valign=top>
<td width=36%><b>Status</b></td>
<td width=64%>Bitmap of status information. It is a series of the following values ORed together:<p>
<b>Client cursor:</b></p>
<p>
CU_FILLED: All cursors</p>
<p>
<b>Transparent server cursor, explicit server cursor:</b></p>
<p>
CU_FILLING: Incomplete asynchronous population of a keyset transparent server cursor or keyset explicit server cursor results set</p>
<p>
CU_FILLED: Incomplete asynchronous population of a keyset transparent server cursor or keyset explicit server cursor results set, or the cursor is a dynamic cursor</p>
</td>
</tr>
</table><br>


</dd>
</dl>
<h4>Returns</h4>
<p>
succeed (1) or fail (0).</p>
<h4>Remarks</h4>
<p>
Before calling <b>SqlCursorInfoEx%</b>, set the <b>SizeOfStruct</b> field equal to the value returned by the C <b>sizeof</b> function for the SQLCURSORINFO% structure. The <b>SqlCursorInfoEx%</b> function fills the supplied SQLCURSORINFO% structure with information about the open server cursor.</p>
<h4>See Also</h4>
<p>
<a href="pdvb05_34xh.htm"><b>SqlCursor%</b></a>, <a href="pdvb05_8ihx.htm"><b>SqlCursorClose</b></a>, <a href="pdvb05_1tbp.htm"><b>SqlCursorColInfo%</b></a>, <a href="pdvb05_7z5h.htm"><b>SqlCursorFetch%</b></a>, <a href="#_sqlcursorinfoex.25"><b>SqlCursorInfoEx%</b></a>, <a href="pdvb05_2f91.htm"><b>SqlCursorOpen%</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
