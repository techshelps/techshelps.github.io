<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SqlBCPInit%</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqlbcpinit.25"></a>SqlBCPInit%</h1>
<p>
Initializes a bulk-copy operation.</p>
<h4>Syntax</h4>
<p>
<b>SqlBCPInit% ( </b><i>sqlconn%</i><b>,</b> <i>tblname$</i><b>,</b> <i>hfile$</i><b>,</b> <i>errfile$</i><b>,</b> <i>direction%</i><b> )</b></p>
<p>
where
<dl>
<dt>
<i>sqlconn%</i></dt>
<dd>
Is a SQL Server connection. The value of <i>sqlconn%</i> is returned by <b>SqlOpen%</b>.</dd>
<dt>
<i>tblname$</i></dt>
<dd>
Is the name of the database table to copy. This name can also include the name of the database and the name of the database owner. For example, <i>pubs.gracie.titles</i>, <i>pubs..titles</i>, <i>gracie.titles</i>, and <i>titles</i> are all legal table names.
<p>
If <i>direction%</i> is DBOUT%, <i>tblname$</i> can also be the name of a database view.
</dd>
<dt>
<i>hfile$</i></dt>
<dd>
Is the name of the operating-system file to bulk copy into or out of SQL Server.</dd>
<dt>
<i>errfile$</i></dt>
<dd>
Is the name of the error file to be used. This error file contains progress messages, error messages, and copies of any rows that could not be copied from an operating-system file to a SQL Server table. If NULL is passed as <i>errfile$</i>, no error file is used.</dd>
<dt>
<i>direction%</i></dt>
<dd>
Is the direction of the copy. This parameter must be one of two values: DBIN% or DBOUT%. DBIN% indicates a copy from an operating-system file into the database table; DBOUT% indicates a copy from a database table into an operating-system file.
</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED (1) or FAIL (0).</p>
<h4>Remarks</h4>
<p>
<b>SqlBCPInit%</b> performs the initializations necessary to bulk-copy data between a workstation and SQL Server. It sets the default data formats for the operating-system file and examines the structure of the database table.</p>
<p>
When you use an operating-system file to bulk-copy (see the description of the <i>hfile$</i> parameter), the default native data formats are as follows:
<ul>
<li>
The order, type, length, and number of the columns in the operating-system file are assumed to be identical to the order, type, length, and number of the columns in the database table.</li>
<li>
If the data in a given database column is of fixed length, then the data column in the operating-system file is also of fixed length. If the data in a given database column is of variable length or can contain NULL values, the data column in the operating-system file is prefixed by a 4-byte length value for SQLTEXT and SQLIMAGE datatypes and a 1-byte length value for all other types.</li>
<li>
There are no terminators between columns in the operating-system file.</li>
</ul>
<p>
You can override any of these defaults by calling <b>SqlBCPColumns%</b> and <b>SqlBCPColfmt%</b>.</p>
<p>
To use the bulk-copy functions to copy data to a database table, you must do the following:
<ul>
<li>
Call <b>SqlBCPSetL%</b> to make the server connection usable for bulk-copy purposes:<pre>login% = sqllogin%
SqlBCPSetL%(login%, TRUE)</pre>
</li>
<li>
If the table has no indexes, set the database option <b>select into/bulkcopy</b> to TRUE, use the database, and send the SQL Server CHECKPOINT statement:<pre>cmd$ = "sp_dboption 'mydb', 'select into/bulkcopy', 'true'"
Result% = SqlExec%(Sqlconn%)
Result% = SqlUse%(Sqlconn%, Database$)
cmd$ = "CHECKPOINT"
Result% = SqlExec%(Sqlconn%)</pre>
</li>
</ul>
<p>
The <b>SqlBCPInit%</b> function must be called before any other bulk-copy functions. Failure to do so results in an error.</p>
<h4>See Also</h4>
<p>
<a href="pdvb09_60qd.htm"><b>SqlBCPColfmt%</b></a>, <a href="pdvb09_88mt.htm"><b>SqlBCPColumns%</b></a>, <a href="pdvb09_22et.htm"><b>SqlBCPControl%</b></a>, <a href="pdvb09_3vw5.htm"><b>SqlBCPExec%</b></a>, <a href="pdvb09_8e5x.htm"><b>SqlBCPSetL%</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
