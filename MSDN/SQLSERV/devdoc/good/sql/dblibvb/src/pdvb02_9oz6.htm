<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sending Transact-SQL Statements to SQL Server</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sending_transact_sql_statements_to_sql.a0.server"></a>Sending Transact-SQL Statements to SQL Server</h2>
<p>
The <b>SqlCmd%</b> and <b>SqlExec%</b> functions allow your application to execute Transact-SQL statements.</p>
<p>
The <b>SqlCmd%</b> function fills the command buffer with Transact-SQL statements that you then send to SQL Server. Each succeeding call to <b>SqlCmd%</b> appends the supplied Transact-SQL text to the end of text already in the buffer. When you add text to text already in the buffer, be sure to supply necessary blanks between words, such as the blank space at the beginning of the WHERE clause in the program fragment that follows.</p>
<pre>'Retrieve two columns from the "authors" table
'in the "pubs" database.

'Put the command into the command buffer.
Result% = SqlCmd%(Sqlconn%, "SELECT au_lname, city")
Result% = SqlCmd%(Sqlconn%, " FROM pubs..authors")
Result% = SqlCmd%(Sqlconn%, " WHERE state = 'CA'")

'Send the command to SQL Server and start execution.
Result% = SqlExec%(Sqlconn%)
</pre>
<p>
<b>SqlExec%</b> sends the contents of the buffer to SQL Server, which parses and executes the specified Transact-SQL statements. You can also use <b>SqlSend%</b> and <b>SqlOk%</b> instead of <b>SqlExec%</b>.</p>
<p>
For an example of how these functions are used, refer to the QUERY sample application. This sample application calls the routine <b>ExecuteSqlCommand</b>, which in turn calls the functions <b>SqlCmd%</b> and <b>SqlExec%</b>. <b>ExecuteSqlCommand</b> is defined separately in the VBSQLGEN.BAS common code module. </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
