<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Stopping SQL Server</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_stopping_sql.a0.server"></a>Stopping SQL Server</h2>
<p>
You can stop SQL Server locally from the server or remotely from a client or another server. If you've started SQL Server as a service, you can stop it by using SQL Enterprise Manager, SQL Service Manager, the Services application in the Control Panel, or the <b>net stop</b> <b>mssqlserver</b> command. If you've started SQL Server from the command line, you can stop SQL Server from a client (either locally or remotely) by using the SHUTDOWN<b> </b>command. You can stop SQL Server from a command prompt window by pressing ctrl  c.</p>
<p>
When you use any of these procedures to stop SQL Server, SQL Server shuts down in an orderly fashion by performing the following steps:
<ul>
<li>
Disabling logins (except for system administrators)</li>
<li>
Performing a CHECKPOINT in every database</li>
</ul>
<p>
In addition, if you stop SQL Server from a client, SQL Server waits for any currently executing Transact-SQL statements or stored procedures to finish. To bring the system to an immediate halt, you must issue the statement SHUTDOWN WITH NOWAIT from a client.</p>
<p>
When you plan to shut down SQL Server, it's a good idea to first pause the SQL Server service and then broadcast a message that SQL Server will be stopped. Give users enough time to finish their current tasks, and then shut down SQL Server as described in the preceding section.</p>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To stop SQL Server using SQL Service Manager</h5>
<ol>
<li>
From the Microsoft SQL Server 6.0 program group, start SQL Service Manager.<p>
The SQL Service manager Window appears.
</li>
<li>
To stop a remote SQL Server, in the Server box, select or enter the name of the remote server, and then choose the Connect button.</li>
<li>
From the Service box, select MSSQLServer.</li>
<li>
Choose the yellow Pause light to pause the service.</li>
<li>
Send a message informing connected users that the server will soon be shutting down. After an appropriate interval, proceed to step 6.</li>
<li>
Choose the red Stop light.</li>
</ol>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To stop SQL Server using SQL Enterprise Manager</h5>
<ol>
<li>
From the Microsoft SQL Server 6.0 program group, start SQL Enterprise Manager.<p>
The SQL Enterprise Manager Window appears.
</li>
<li>
From SQL Enterprise Manager's Server Manager window, open a server group and select a server.</li>
<li>
From the toolbar, select the Services icon (the stoplight).</li>
<li>
Choose the yellow Pause light to pause the service. </li>
<li>
Send a message informing connected users that the server will soon be shutting down. After an appropriate interval, proceed to step 6.</li>
<li>
Choose the red Stop light.</li>
<li>
Choose the Done button.</li>
</ol>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To stop SQL Server from operating-system prompt</h5>
<ul>
<li>
Type:<p>
<b>net stop mssqlserver </b>
</li>
</ul>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To stop SQL Server from an isql client</h5>
<ul>
<li>
Type:<p>
<b>SHUTDOWN </b>[<b>WITH NOWAIT</b>]
<p>
Issuing SHUTDOWN waits for currently executing Transact-SQL statements or stored procedures to finish before shutting down. Issuing SHUTDOWN WITH NOWAIT brings the system to an immediate halt.
</li>
</ul>
<h5><img src="../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To broadcast a shutdown message</h5>
<ul>
<li>
From an operating-system prompt, type:<p>
<b>net send /users</b> <b>"</b><i>message</i><b>"</b>
<p>
For example:
<pre>net send /users "SQL Server is going down in 20 minutes. 
Please disconnect."</pre>
<p>
The <b>/users</b> option causes the specified message to be sent to all users connected to the server. For descriptions of other <b>net send</b> options, see your manuals for Windows NT.
</li>
</ul>
<p>
You can also stop SQL Server locally from the server by using the Services application in the Control Panel. For more information, see your manuals for Windows NT.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
