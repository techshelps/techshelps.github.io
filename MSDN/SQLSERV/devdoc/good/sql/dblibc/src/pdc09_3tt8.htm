<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>bcp_control</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_bcp_control"></a>bcp_control</h1>
<p>
Changes the default settings for various control parameters for a bulk copy between a file and SQL Server.</p>
<h4>Syntax</h4>
<p>
<b>RETCODE bcp_control ( <br>
PDBPROCESS </b><i>dbproc</i><b>, <br>
INT </b><i>field</i><b>, <br>
DBINT </b><i>value</i><b> );</b></p>
<p>
where
<dl>
<dt>
<i>dbproc</i></dt>
<dd>
Is the DBPROCESS structure that is the handle for a particular workstation/ SQL Server process. It contains all the information that DB-Library uses to manage communications and data between the workstation and SQL Server.</dd>
<dt>
<i>field</i></dt>
<dd>
One of the following:
<dl>
<dt>
BCPMAXERRS</dt>
<dd>
Is the number of errors allowed before giving up. The default is 10; a value less than 1 resets this field to its default value. If a value larger than 65,535 is specified, this field is set to 65,535.</dd>
<dt>
BCPFIRST</dt>
<dd>
Is the first row to copy. The default is 1; a value less than 1 resets this field to its default value.</dd>
<dt>
BCPLAST</dt>
<dd>
Is the last row to copy. The default is to copy all rows; a value less than 1 resets this field to its default value.</dd>
<dt>
BCPBATCH</dt>
<dd>
Is the number of rows per batch. The default is 0; a value less than 1 resets this field to its default value.</dd>
<dt>
BCPKEEPNULLS</dt>
<dd>
Specifies whether empty data values in the file will be converted to NULL values in the SQL Server table. If this option is set before calling <b>bcp_exec</b>, empty values will be converted to NULL values in the SQL Server table. The default is for empty values to be converted to the column's default value in the SQL Server table.</dd>
</dl>
</dd>
<dt>
<i>value</i></dt>
<dd>
Is the value for the specified <i>field</i>.
</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED or FAIL.</p>
<h4>Remarks</h4>
<p>
This function sets various control parameters for bulk copy operations, including the number of errors allowed before canceling a bulk copy, the numbers of the first and last rows to copy, and the batch size.</p>
<p>
These control parameters are only meaningful when copying between a user file and a SQL Server table. Control parameter settings have no effect on <b>bcp_bind</b> row transfers.</p>
<h4>Example</h4>
<p>
The following example shows how to use <b>bcp_control</b>:</p>
<pre>LOGINREC    *login;
DBPROCESS    *dbproc;
DBINT        rowsread;

// Install error-handler and message-handler. 
dberrhandle(err_handler);
dbmsghandle(msg_handler);

// Open a DBPROCESS. 
login = dblogin();
BCP_SETL(login, TRUE);
DBSETLUSER(login, "user");
DBSETLPWD(login, "my_passwd");
DBSETLAPP(login, "example");
dbproc = dbopen(login, "my_server");

// Initialize bcp. 
if (bcp_init(dbproc, "comdb..address", "address.add", "addr.err",
    DB_IN) == FAIL)
    exit(ERREXIT);

// Set the number of rows per batch. 
if (bcp_control(dbproc, BCPBATCH, (DBINT) 1000) == FAIL)
{
    printf("bcp_control failed to set batching behavior.\n");
    exit(ERREXIT);
}

// Set file column count. 
if (bcp_columns(dbproc, 1) == FAIL)
{
    printf("bcp_columns failed.\n");
    exit(ERREXIT);
}

// Set the file format. 
if (bcp_colfmt(dbproc, 1, 0, 0, (DBINT)-1, "\n", 1, 1) == FAIL)
{
    printf("bcp_colformat failed.\n");
    exit(ERREXIT);
}

// Now, execute the bulk copy. 
if (bcp_exec(dbproc, &amp;rowsread) == FAIL)
{
    printf("Incomplete bulk copy.    Only %ld row%c copied.\n",
        rowsread, (rowsread == 1) ? ' ': 's');
    exit(ERREXIT);
}
</pre>
<h4>See Also</h4>
<p>
<a href="pdc09_8r6w.htm"><b>bcp_batch</b></a>, <a href="pdc09_4fac.htm"><b>bcp_bind</b></a>, <a href="pdc09_3zqs.htm"><b>bcp_colfmt</b></a>, <a href="pdc09_4ib2.htm"><b>bcp_collen</b></a>, <a href="pdc09_4voy.htm"><b>bcp_colptr</b></a>, <a href="pdc09_9tgz.htm"><b>bcp_columns</b></a>, <a href="pdc09_66sl.htm"><b>bcp_done</b></a>, <a href="pdc09_2l2b.htm"><b>bcp_exec</b></a>, <a href="pdc09_46r8.htm"><b>bcp_init</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
