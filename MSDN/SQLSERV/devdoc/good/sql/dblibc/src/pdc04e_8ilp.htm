<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>dbserverenum</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dbserverenum"></a>dbserverenum</h1>
<p>
Searches for the names of SQL Servers locally, over the network, or both. </p>
<h4>Syntax</h4>
<p>
<b>INT dbserverenum ( <br>
USHORT </b><i>searchmode</i><b>, <br>
LPSTR </b><i>servnamebuf</i><b>, <br>
USHORT </b><i>sizeservnamebuf</i><b>, <br>
LPUSHORT </b><i>numentries</i><b> );</b></p>
<p>
where
<dl>
<dt>
<i>searchmode</i></dt>
<dd>
Defines whether the <b>dbserverenum </b>function checks for server names locally, on the network, or both. 
<p>
Set <i>searchmode</i> to loc_search to search for the names of servers in the WIN.INI file (Windows) or in the following subtree of the Windows NT Registry:

<p>
HKEY_LOCAL_MACHINE\<br>
SOFTWARE\<br>
Microsoft\<br>
MSSQLServer\<br>
Client\<br>
ConnectTo

<p>
The loc_search constant has the value 0x0001.

<p>
To search for the names of servers registered by the default Net-Library, set <i>searchmode</i> to net_search. The net_search constant has the value 0x0002.

<p>
To search both locally and on the network for server names, use a bitwise OR operation (net_search | loc_search) to combine the values of loc_search and net_search. In this case, a server name is duplicated if the server name is defined both locally and on the network.

<p>
DB-Library first tries to load the default Net-Library set by the DSQUERY entry in the Windows NT Registry or in the .INI file (Windows). If no default entry exists, DB-Library loads the appropriate named pipe Net-Library. 
</dd>
<dt>
<i>servnamebuf</i></dt>
<dd>
Is a pointer to a buffer that stores the server names returned by a search. When the <b>dbserverenum</b> function successfully returns a list of server names, the <i>servnamebuf</i> buffer contains the server names separated by null characters. The end of the list is designated by two consecutive null characters. Only complete server names are copied to the buffer. When a buffer is full and there are additional names that could not be copied to the buffer, <b>dbserverenum</b> returns the value more_data. Server names are returned in non-sorted order; names found using the loc_search constant are returned before those names found using the net_search constant. Note that <b>dbserverenum</b> can return server names even when the SQL Server is not running. Therefore, although a server name is returned in the list of servers, it does not guarantee that you can access the server.</dd>
<dt>
<i>sizeservnamebuf</i></dt>
<dd>
Specifies the size of the buffer for the server names returned by a successful search. The buffer size limits the maximum number of names that <b>dbserverenum</b> can return in a single call.</dd>
<dt>
<i>numentries</i></dt>
<dd>
Returns the number of server names copied to the buffer by the current call to <b>dbserverenum</b>.
</dd>
</dl>
<h4>Returns</h4>
<p>
The <b>dbserverenum</b> function returns one or more of the following status code constants:
<dl>
<dt>
enum_success (0x0000)</dt>
<dd>
Indicates that the search to detect server names succeeded. enum_success can be returned even when no servers are detected (when <i>numentries</i> = 0).</dd>
<dt>
more_data (0x0001)</dt>
<dd>
Indicates that DB-Library has enough memory to service the <b>dbserverenum</b> request but the buffer passed to <b>dbserverenum</b> is not large enough to hold all the names returned. Increasing the size of <i>sizeservnamebuf</i> enables the buffer to hold more server names.</dd>
<dt>
net_not_available (0x0002)</dt>
<dd>
Indicates that the Net-Library DLL is unavailable. A Net-Library DLL might be unavailable because no DLL is found or because the available Net-Library DLL does not support the <b>dbserverenum</b> function. When the <i>searchmode</i> parameter includes the net_search mode, <b>dbserverenum</b> calls the default Net-Library DLL. When <i>searchmode</i> includes both the net_search and loc_search modes (net_search | loc_search), <b>dbserverenum</b> can return both more_data and net_not_available (more_data | net_not_available).</dd>
<dt>
out_of_memory (0x0004)</dt>
<dd>
Indicates that DB-Library cannot allocate enough memory to service the <b>dbserverenum</b> request.</dd>
<dt>
not_supported (0x0008)</dt>
<dd>
Indicates that the capability is not supported by the current Net-Library version or the current server platform.</dd>
<dt>
enum_invalid_param (0x0010)</dt>
<dd>
Indicates that an invalid parameter, such as a null pointer, was passed to the function.
</dd>
</dl>
<h4>Remarks</h4>
<p>
Using <b>dbserverenum</b>, you can obtain the names of servers to which you can connect. The <b>dbserverenum</b> function can search for the names of SQL Servers either locally or over the network. For network searches, the Net-Library DLL used must support the <b>dbserverenum</b> function. A Net-Library DLL registers and finds servers on networks for a specific network environment such as LAN Manager - based networks. </p>
<p>
When the search mode is set to net_search, <b>dbserverenum</b> calls the default Net-Library DLL (for example, named pipes or Novell® IPX/SPX). Because only one Net-Library DLL can be the default, those servers discernible to the specific Net-Library are enumerated using the net_search parameter. You must add a specific server entry in the Windows NT Registry to use a Net-Library DLL other than the default Net-Library DLL. Servers listed in the Registry are enumerated when the search mode is set to loc_search.</p>
<h4>See Also</h4>
<p>
<a href="pdc04d_8mjy.htm"><b>dbopen</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
