<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>dbcursorbind</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dbcursorbind"></a>dbcursorbind</h1>
<p>
Binds a column of a client cursor, transparent server cursor, or explicit server cursor to an array of program variables. This array of program variables is filled with result data after every fetch or refresh.</p>
<h4>Syntax</h4>
<p>
<b>RETCODE dbcursorbind ( <br>
PDBCURSOR </b><i>hc</i><b>, <br>
INT </b><i>col</i><b>, <br>
INT </b><i>vartype</i><b>, <br>
DBINT </b><i>varlen</i><b>, <br>
LPDBINT </b><i>poutlen</i><b>, <br>
LPBYTE </b><i>pvaraddr</i><b> );</b></p>
<p>
where
<dl>
<dt>
<i>hc</i></dt>
<dd>
Is the cursor handle created by <b>dbcursoropen</b>.</dd>
<dt>
<i>col</i></dt>
<dd>
Is the column number in the cursor to be bound to a program variable. The first column is number 1.</dd>
<dt>
<i>vartype</i></dt>
<dd>
Is the bind type used to bind the <i>col</i> column to the <i>pvaraddr</i> array of program variables. This bind type is identical to the <i>vartype</i> parameter of <b>dbbind</b> and uses the same conversion rules. The <i>vartype</i> parameter indicates the program variable datatype of the <i>pvaraddr</i> array elements.
<p>
In addition to the <b>dbbind</b> bind types, <i>vartype</i> can be set to NOBIND, indicating that no binding is established for a column. After a fetch:

<ul>
<li>
Each element of the <i>pvaraddr</i> array will contain a pointer to the column data for that row, similar to <b>dbdata</b>.</li>
<li>
Each element of the <i>poutlen</i> array will contain the length of the column data for that row, similar to <b>dbdatlen</b>.</li>
</ul>
</dd>
<dt>
<i>varlen</i></dt>
<dd>
Is the maximum length, in bytes, of a variable-length datatype. This parameter must be supplied when <i>vartype</i> is one of the following:
<ul>
<li>
CHARBIND, VARYCHARBIND</li>
<li>
STRINGBIND, NTBSTRINGBIND</li>
<li>
BINARYBIND, VARYBINBIND</li>
</ul>

<p>
This parameter is ignored for fixed-length datatypes (all other <i>vartype</i> values except those given above) and when <i>vartype</i> is NOBIND.
</dd>
<dt>
<i>poutlen</i></dt>
<dd>
Is a pointer to an array of DBINT elements, one element for each row in the fetch buffer. The required number of elements in this array is given below. After a fetch, each element of this array will contain the length of the column data for that row, similar to <b>dbdatlen</b>. A length element value of 0 indicates that the column is NULL.
<p>
If <i>poutlen</i> is set to NULL, the lengths are not returned.

<p>
Before calling <b>dbcursor</b> to update or insert a row with values from the <i>pvaraddr</i> array of bound program variables, set the corresponding <i>poutlen</i> element (for that row in the fetch buffer) to one of the following values:

<ul>
<li>
Set an element to 0 to indicate a NULL value.</li>
<li>
When <i>vartype</i> is NOBIND, CHARBIND, VARYCHARBIND, BINARYBIND, or VARYBINBIND, set the element to the length, in bytes, of the new column data.</li>
<li>
When vartype is STRINGBIND or NTBSTRINGBIND, any non-zero value is ignored, and the length of the string is determined by scanning for the null terminator.</li>
<li>
For fixed-length datatypes, non-zero values are ignored.</li>
</ul>

<p>
<b>Client cursor, transparent server cursor:</b>

<p>
The number of elements in this array must equal the <i>nrows</i> parameter of <b>dbcursoropen</b>.

<p>
<b>Explicit server cursor:</b>

<p>
The maximum number of elements in this array is the <i>nrows</i> parameter of <b>dbcursoropen</b>. Before a fetch is made, the number of elements in this array must be equal to or greater than the <i>nfetchnrows</i> parameter that will be passed to <b>dbcursorfetchex</b>.
</dd>
<dt>
<i>pvaraddr</i></dt>
<dd>
Is a pointer to an array of elements, one element for each row in the fetch buffer. The required number of elements in this array is given below. After a fetch, each element of this array will contain:
<ul>
<li>
A copy of the column data for that row, converted as specified by the <i>vartype</i> parameter (similar to <b>dbbind</b>) when <i>vartype</i> is one of the standard <b>dbbind</b> bind types</li>
<li>
A pointer to the actual column data for that row (similar to <b>dbdata</b>) when <i>vartype</i> is NOBIND</li>
</ul>

<p>
Setting <i>pvaraddr</i> to NULL breaks any existing binding established by a previous call to <b>dbcursorbind</b> for the column.

<p>
<b>Client cursor, transparent server cursor:</b>

<p>
The number of elements in this array must equal the <i>nrows</i> parameter of <b>dbcursoropen</b>.

<p>
<b>Explicit server cursor:</b>

<p>
The maximum number of elements in this array is the <i>nrows</i> parameter of <b>dbcursoropen</b>. Before a fetch is made, the number of elements in this array must be equal to or greater than the <i>nfetchnrows</i> parameter that will be passed to <b>dbcursorfetchex</b>.

</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED or FAIL.</p>
<h4>Remarks</h4>
<p>
If <b>dbcursorbind</b> is called more than once for any column, only the last call will be effective.</p>
<h4>See Also</h4>
<p>
<a href="pdc05_7l4i.htm"><b>dbcursor</b></a>, <a href="pdc05_22sl.htm"><b>dbcursorclose</b></a>, <a href="pdc05_7wbz.htm"><b>dbcursorcolinfo</b></a>, <a href="pdc05_1y20.htm"><b>dbcursorfetch</b></a>, <a href="pdc05_5ban.htm"><b>dbcursorinfo</b></a>, <a href="pdc05_9772.htm"><b>dbcursoropen</b></a>; <a href="pdc09_7e7t.htm">Bulk-Copy Functions</a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
