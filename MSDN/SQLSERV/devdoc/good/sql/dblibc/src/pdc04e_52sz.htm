<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>dbresults</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dbresults"></a>dbresults</h1>
<p>
Sets up the results of the next query.</p>
<h4>Syntax</h4>
<p>
<b>RETCODE dbresults ( PDBPROCESS </b><i>dbproc</i><b> );</b></p>
<p>
where
<dl>
<dt>
<i>dbproc</i></dt>
<dd>
Is the DBPROCESS structure that is the handle for a particular workstation/ SQL Server process. It contains all the information that DB-Library uses to manage communications and data between the workstation and SQL Server.
</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED, FAIL, NO_MORE_RESULTS, or NO_MORE_RPC_RESULTS. The most common reason for failing is a NULL or inactive <i>dbproc</i>. NO_MORE_RPC_RESULTS is returned when stored procedure return information is available from one stored procedure in a batch of multiple stored procedures. from by if there are no more results to be processed. NO_MORE_RESULTS is returned if there are no more results to be processed.</p>
<p>
<b>Note</b>  This function is one of the four that do not return control to the application until the server sends the required response. The application can be blocked for a considerable time if the server is waiting for a lock or processing a large sort. If this is unacceptable, always call <b>dbdataready</b> before <b>dbresults</b> and set the DB-Library timeout to regain control periodically.</p>
<h4>Remarks</h4>
<p>
This function sets up the next statement in the command batch for processing. It is called after <b>dbsqlexec</b> or <b>dbsqlok</b> returns SUCCEED. The <b>dbresults</b> function returns SUCCEED or NO_MORE_RESULTS on the first call if <b>dbsqlexec</b> or <b>dbsqlok</b> has returned SUCCEED, unless a network error or out-of-memory error has occurred. Once <b>dbresults</b> returns SUCCEED, the user typically processes any rows with <b>dbnextrow</b>.</p>
<p>
The <b>dbresults</b> function must be called for each statement in the command batch, whether or not the statement returns any rows. If the application code doesn't know how many statements are in the batch, <b>dbresults</b> can be called until it returns NO_MORE_RESULTS. Ordinarily, call <b>dbresults</b> once for any stored procedure in the command batch. However, if the stored procedure contains more than one Transact-SQL SELECT statement, call <b>dbresults</b> once for each SELECT statement. The easiest way to do this is to continue to call <b>dbresults</b> until it returns no_more_results.</p>
<p>
You must call <b>dbresults</b> until it returns no_more_results, or <i>any</i> continued use of the DBPROCESS causes the DB-Library error 10038 "Results Pending."</p>
<h4>Example</h4>
<p>
This example shows the typical sequence of calls when using <b>dbresults</b> with <b>dbsqlexec</b>:</p>
<pre>DBINT    xvariable;
DBCHAR    yvariable[10];

// Read the query into the command buffer. 
dbcmd(dbproc, "select x = 100, y = 'hello'");

// Send the query to SQL Server. 
dbsqlexec(dbproc);
// Get ready to process the results of the query. 
dbresults(dbproc);
// Bind column data to program variables. 
dbbind(dbproc, 1, INTBIND, (DBINT) 0, (BYTE *) &amp;xvariable);
dbbind(dbproc, 2, STRINGBIND, (DBINT) 0, yvariable);
// Now process each row. 
while (dbnextrow(dbproc) != NO_MORE_ROWS)
{
    // C-code to print or process row data 
}</pre>
<h4>See Also</h4>
<p>
<a href="pdc04b_4zc4.htm"><b>dbbind</b></a>, <a href="pdc04b_1tbg.htm"><b>dbcancel</b></a>, <a href="pdc04b_5hfd.htm"><b>dbcanquery</b></a>, <a href="pdc04d_0fqv.htm"><b>dbnextrow</b></a>, <a href="pdc04f_43hf.htm"><b>dbsqlexec</b></a>, <a href="pdc04f_6pij.htm"><b>dbsqlok</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
