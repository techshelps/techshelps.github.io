<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>bcp_init</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_bcp_init"></a>bcp_init</h1>
<p>
Initializes bulk copy operation.</p>
<h4>Syntax</h4>
<p>
<b>RETCODE bcp_init ( <br>
PDBPROCESS </b><i>dbproc</i><b>, <br>
LPCSTR </b><i>tblname</i><b>, <br>
LPCSTR </b><i>hfile</i><b>, <br>
LPCSTR </b><i>errfile</i><b>, <br>
INT </b><i>direction</i><b> );</b></p>
<p>
where
<dl>
<dt>
<i>dbproc</i></dt>
<dd>
Is the DBPROCESS structure that is the handle for a particular workstation/ SQL Server process. It contains all the information that DB-Library uses to manage communications and data between the workstation and SQL Server.</dd>
<dt>
<i>tblname</i></dt>
<dd>
Is the name of the database table to be copied in or out. This name can also include the database name or the database owner name. For example, <i>pubs.gracie.titles</i>, <i>pubs..titles</i>, <i>gracie.titles</i>, and <i>titles</i> are all legal table names.
<p>
If <i>direction</i> is DB_OUT, <i>tblname</i> can also be the name of a database view.
</dd>
<dt>
<i>hfile</i></dt>
<dd>
Is the name of the user file to be copied into or out of SQL Server. If data is being copied directly from variables using <b>bcp_sendrow</b>, set <i>hfile</i> to NULL.</dd>
<dt>
<i>errfile</i></dt>
<dd>
Is the name of the error file to be used. This error file is filled with progress messages, error messages, and copies of any rows that, for any reason, could not be copied from a user file to a SQL Server table. If NULL is passed as <i>errfile</i>, no error file is used.</dd>
<dt>
<i>direction</i></dt>
<dd>
Is the direction of the copy. It must be one of two values: DB_IN or DB_OUT. DB_IN indicates a copy from program variables or a user file to the database table, while DB_OUT indicates a copy from the database table to the user file. It is illegal to request a bulk copy from the database table (DB_OUT) without supplying a user filename.
</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED or FAIL.</p>
<h4>Remarks</h4>
<p>
The <b>bcp_init</b> function performs the necessary initializations for a bulk copy of data between the workstation and SQL Server. It sets the default user file data formats and examines the structure of the database table.</p>
<p>
If a user file is being used (see the description of the <i>hfile</i> parameter), the default data native formats are as follows:
<ul>
<li>
The order, type, length, and number of the columns in the user file are assumed to be identical to the order, type, and number of the columns in the database table.</li>
<li>
If a given database column's data is fixed length, then the user file's data column is also fixed length. When a given database column's data is variable length or when it can contain null values, the user file's data column is prefixed by a 4-byte length value for SQLTEXT and SQLIMAGE datatypes and a 1-byte length value for all other types.</li>
<li>
There are no terminators of any kind between user file columns.</li>
</ul>
<p>
Any of these defaults can be overridden by calling <b>bcp_columns</b> and <b>bcp_colfmt</b>.</p>
<p>
To use the bulk copy functions to copy data to a database table, follow these examples:
<ul>
<li>
Call <b>BCP_SETL</b> to make the DBPROCESS structure usable for bulk copy purposes:<pre>login = dblogin();
BCP_SETL(login, TRUE);</pre>
</li>
<li>
If the table has no indexes, set the database option <b>select into/bulkcopy</b> to TRUE, use the database, and send the SQL Server CHECKPOINT statement:<pre>sp_dboption 'mydb', 'select into/bulkcopy', 'true'
go
use mydb
go
checkpoint</pre>
</li>
</ul>
<p>
If no user file is being used, it is necessary to call <b>bcp_bind</b> to specify the format and location in memory for each column's data value, and send the rows using <b>bcp_sendrow</b></p>
<p>
The <b>bcp_init</b> function must be called before any other bulk copy functions. Failure to do so results in an error.</p>
<h4>See Also</h4>
<p>
<a href="pdc09_8r6w.htm"><b>bcp_batch</b></a>, <a href="pdc09_4fac.htm"><b>bcp_bind</b></a>, <a href="pdc09_3zqs.htm"><b>bcp_colfmt</b></a>, <a href="pdc09_4ib2.htm"><b>bcp_collen</b></a>, <a href="pdc09_4voy.htm"><b>bcp_colptr</b></a>, <a href="pdc09_9tgz.htm"><b>bcp_columns</b></a>, <a href="pdc09_3tt8.htm"><b>bcp_control</b></a>, <a href="pdc09_66sl.htm"><b>bcp_done</b></a>, <a href="pdc09_2l2b.htm"><b>bcp_exec</b></a>, <a href="pdc09_3u7r.htm"><b>bcp_sendrow</b></a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
