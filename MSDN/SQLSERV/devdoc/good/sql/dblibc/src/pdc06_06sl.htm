<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>dbrettype</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dbrettype"></a>dbrettype</h1>
<p>
Determines the datatype of a return-parameter value generated by a stored procedure or a remote stored procedure.</p>
<h4>Syntax</h4>
<p>
<b>INT dbrettype ( <br>
PDBPROCESS </b><i>dbproc</i><b>, <br>
INT </b><i>retnum</i><b> );</b></p>
<p>
where
<dl>
<dt>
<i>dbproc</i></dt>
<dd>
Is the DBPROCESS structure that is the handle for a particular workstation/ SQL Server process. It contains all the information that DB-Library uses to manage communications and data between the workstation and SQL Server.</dd>
<dt>
<i>retnum</i></dt>
<dd>
Is the number of the returned value of interest. The first return value is number 1. Values are returned in the same order as the parameters were originally specified in the stored procedure's CREATE PROCEDURE statement. (Note that this is not necessarily the same order as that specified in the remote stored procedure.) When specifying <i>retnum</i>, non-return parameters are not counted. For example, if the second parameter in a stored procedure is the only return parameter, its <i>retnum</i> is 1, not 2.
</dd>
</dl>
<h4>Returns</h4>
<p>
A token value for the datatype of the specified return value.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=25%></th>
<th align=left width=75%></th>
</tr>
<tr valign=top>
<th align=left width=25%></th>
<th align=left width=75%></th>
</tr>
<tr valign=top>
<th align=left width=25%>Column <br>
datatype</th>
<th align=left width=75%><br>
Returned constant</th>
</tr>
<tr valign=top>
<td width=25%></td>
<td width=75%></td>
</tr>
<tr valign=top>
<td width=25%><i>char</i></td>
<td width=75%>SQLCHAR</td>
</tr>
<tr valign=top>
<td width=25%><i>varchar</i></td>
<td width=75%>SQLCHAR</td>
</tr>
<tr valign=top>
<td width=25%><i>binary</i></td>
<td width=75%>SQLBINARY</td>
</tr>
<tr valign=top>
<td width=25%><i>varbinary</i></td>
<td width=75%>SQLBINARY</td>
</tr>
<tr valign=top>
<td width=25%><i>tinyint</i></td>
<td width=75%>SQLINT1</td>
</tr>
<tr valign=top>
<td width=25%><i>smallint</i></td>
<td width=75%>SQLINT2</td>
</tr>
<tr valign=top>
<td width=25%><i>int</i></td>
<td width=75%>SQLINT4</td>
</tr>
<tr valign=top>
<td width=25%><i>real</i></td>
<td width=75%>SQLFLT4</td>
</tr>
<tr valign=top>
<td width=25%><i>float</i></td>
<td width=75%>SQLFLT8</td>
</tr>
<tr valign=top>
<td width=25%><i>smallmoney</i></td>
<td width=75%>SQLMONEY4</td>
</tr>
<tr valign=top>
<td width=25%><i>money</i></td>
<td width=75%>SQLMONEY</td>
</tr>
<tr valign=top>
<td width=25%><i>decimal</i></td>
<td width=75%>SQLDECIMAL</td>
</tr>
<tr valign=top>
<td width=25%><i>numeric</i></td>
<td width=75%>SQLNUMERIC</td>
</tr>
<tr valign=top>
<td width=25%><i>smalldatetime</i></td>
<td width=75%>SQLDATETIM4</td>
</tr>
<tr valign=top>
<td width=25%><i>datetime</i></td>
<td width=75%>SQLDATETIME</td>
</tr>
</table><br>
<p>
If <i>retnum</i> is out of range, -1 is returned.</p>
<h4>Remarks</h4>
<p>
For more information about stored procedure return parameters, see "<b>dbretdata</b>."</p>
<p>
The server returns stored procedure information (including any return status and parameter values) immediately after returning all normal results for that stored procedure. Process the normal results, and then call <b>dbrettype</b> after <b>dbresults</b> returns NO_MORE_RPC_RESULTS (for all stored procedures in a batch except the last one) or NO_MORE_RESULTS (for a single stored procedure, or for the last stored procedure in a batch).</p>
<p>
The <b>dbrettype</b> function actually returns an integer token value for the datatype (SQLCHAR, SQLFLT8, and so on). To convert the token value into a readable token string, use <b>dbprtype</b>. For a list of all token values and their equivalent token strings, see <a href="pdc04e_2qxx.htm">dbprtype</a>. For a list of SQL Server datatypes, see <a href="pdcb_852a.htm">Appendix B: DB-Library Datatypes</a>. </p>
<h4>See Also</h4>
<p>
<a href="pdc04d_0fqv.htm"><b>dbnextrow</b></a>, <a href="pdc06_6r1v.htm"><b>dbnumrets</b></a>, <a href="pdc04e_2qxx.htm"><b>dbprtype</b></a>, <a href="pdc04e_52sz.htm"><b>dbresults</b></a>, <a href="pdc06_86sh.htm"><b>dbretdata</b></a>, <a href="pdc06_4wby.htm"><b>dbretlen</b></a>, <a href="pdc06_4d5x.htm"><b>dbretname</b></a>, <a href="pdc06_8gms.htm"><b>dbrpcinit</b></a>, <a href="pdc06_6g8d.htm"><b>dbrpcparam</b></a><b> </b></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
