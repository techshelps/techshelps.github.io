<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>dbclropt</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dbclropt"></a>dbclropt</h1>
<p>
Clears an option set by <b>dbsetopt</b>.</p>
<h4>Syntax</h4>
<p>
<b>RETCODE dbclropt ( <br>
PDBPROCESS </b><i>dbproc</i><b>, <br>
INT </b><i>option</i><b>, <br>
LPCSTR </b><i>param</i><b> );</b></p>
<p>
where
<dl>
<dt>
<i>dbproc</i></dt>
<dd>
Is the DBPROCESS structure that is the handle for a particular workstation/ SQL Server process. It contains all the information that DB-Library uses to manage communications and data between the workstation and SQL Server. If <i>dbproc</i> is null, the option is set for all active and future DBPROCESS structures.</dd>
<dt>
<i>option</i></dt>
<dd>
Is the option to be turned off.</dd>
<dt>
<i>param</i></dt>
<dd>
Is the option parameter. Certain options take parameters. If an option does not take a parameter, <i>param</i> is ignored. If an option does take a parameter, <i>param</i> is ignored for all options except DBOFFSET and DBSTAT.
<p>
The DBOFFSET and DBSTAT options can have several settings, each with a different parameter. In these cases, <b>dbclropt</b> needs a valid <i>param</i> to determine which option parameter to clear.

<p>
For a list of options that take parameters, see <a href="pdca_9kbl.htm">DB-Library Options</a>. 

<p>
If an invalid parameter is specified for one of the SQL Server options, it will not be discovered until the command is sent to SQL Server. The <b>dbsqlexec</b> or <b>dbsqlsend</b> calls will fail and DB-Library will invoke the user-installed message handler. If an invalid parameter is specified for one of the DB-Library options (DBBUFFER or DBTEXTLIMIT) <b>dbclropt</b> itself will fail.

</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED or FAIL.</p>
<h4>Remarks</h4>
<p>
This function clears SQL Server and DB-Library options that have been set with <b>dbsetopt</b>. Although SQL Server options can be set and cleared directly through SQL, use <b>dbsetopt</b> and <b>dbclropt</b> in an application to set and clear options. This provides a uniform interface for setting both SQL Server and DB-Library options. It also allows the application to use <b>dbisopt</b> to check the status of an option.</p>
<p>
The <b>dbclropt</b> function does not immediately clear the options specified. With the exception of DBBUFFER and DBNOAUTOFREE, options are not cleared until the command buffer is sent to SQL Server (by invoking the <b>dbsqlexec</b> function). An additional result is returned by using <b>dbresults</b>. (For information about results returned, see "<b>dbresults</b>.")</p>
<p>
Note that the command string generated by this function is not immediately sent to SQL Server. Instead, it is buffered within DB-Library and sent the next time <b>dbsqlexec</b> is invoked. Therefore, any options requested by this function do not go into effect until then. Also, the results of the command generated by this function are not returned until the command is transferred to SQL Server. The application should be expecting the results returned from the command string generated by this function.</p>
<p>
For a complete list of options, see <a href="pdca_9kbl.htm">DB-Library Options</a> </p>
<h4>See Also</h4>
<p>
<a href="pdc04c_29ro.htm"><b>dbisopt</b></a>, <a href="pdc04e_96us.htm"><b>dbsetopt</b></a>; <a href="pdc09_7e7t.htm">Bulk-Copy Functions</a> and <a href="pdca_9kbl.htm">DB-Library Options</a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
