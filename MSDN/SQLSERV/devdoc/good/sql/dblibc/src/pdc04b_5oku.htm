<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>dbcollen</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dbcollen"></a>dbcollen</h1>
<p>
Returns the maximum length, in bytes, of the data for a column.</p>
<h4>Syntax</h4>
<p>
<b>DBINT dbcollen ( <br>
PDBPROCESS </b><i>dbproc</i><b>, <br>
INT </b><i>column</i><b> );</b></p>
<p>
where
<dl>
<dt>
<i>dbproc</i></dt>
<dd>
Is the DBPROCESS structure that is the handle for a particular workstation/ SQL Server process. It contains all the information that DB-Library uses to manage communications and data between the workstation and SQL Server.</dd>
<dt>
<i>column</i></dt>
<dd>
Is the number of the column. The first column is number 1. For further information, see "<b>dbadata</b>."
</dd>
</dl>
<h4>Returns</h4>
<p>
The maximum length of the data for the particular column. If the column number is not in range, -1 is returned.</p>
<h4>Remarks</h4>
<p>
In the case of variable length data, the maximum length is not necessarily the actual length of the data, but rather the maximum length that the data can be. For the actual data length, use <b>dbdatlen</b>. Call <b>dbcollen</b> after <b>dbresults</b> returns SUCCEED.</p>
<h4>Example</h4>
<p>
The following example shows how to use <b>dbcollen</b>:</p>
<pre>DBPROCESS    *dbproc;
int            colnum;
DBINT        column_length;

// Put the command into the command buffer. 
dbcmd(dbproc, "select name, id, type from sysobjects");

// Send the command to SQL Server and begin execution. 
dbsqlexec(dbproc);

// Process the command results. 
dbresults(dbproc);

// Examine the column lengths. 
for (colnum = 1; colnum &lt; 4; colnum+)
{
    column_length = dbcollen(dbproc, colnum);
    printf("column %d, length is %ld.\n", colnum, column_length);
}
</pre>
<h4>See Also</h4>
<p>
<a href="pdc04b_4kyt.htm"><b>dbcolname</b></a>, <a href="pdc04b_0elh.htm"><b>dbcoltype</b></a>, <a href="pdc04c_5iw1.htm"><b>dbdata</b></a>, <a href="pdc04c_0bvy.htm"><b>dbdatlen</b></a>, <a href="pdc04d_3c6r.htm"><b>dbnumcols</b></a> </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
