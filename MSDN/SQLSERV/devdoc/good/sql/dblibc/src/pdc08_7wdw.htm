<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>dbtsput</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dbtsput"></a>dbtsput</h1>
<p>
Puts the new value of the timestamp column into the given table's current row in the DBPROCESS.</p>
<h4>Syntax</h4>
<p>
<b>RETCODE dbtsput ( <br>
PDBPROCESS </b><i>dbproc</i><b>, <br>
LPCDBBINARY </b><i>newts</i><b>, <br>
INT </b><i>newtslen</i><b>, <br>
INT </b><i>tabnum</i><b>, <br>
LPCSTR </b><i>tabname</i><b> );</b></p>
<p>
where
<dl>
<dt>
<i>dbproc</i></dt>
<dd>
Is the DBPROCESS structure that is the handle for a particular workstation/ SQL Server process. It contains all the information that DB-Library uses to manage communications and data between the workstation and SQL Server. This must be the DBPROCESS used to perform the original SELECT query.</dd>
<dt>
<i>newts</i></dt>
<dd>
Is a pointer to the new timestamp value. It is returned by <b>dbtsnewval</b>.</dd>
<dt>
<i>newtslen</i></dt>
<dd>
Is the length of the new timestamp value. It is returned by <b>dbtsnewlen</b>.</dd>
<dt>
<i>tabnum</i></dt>
<dd>
Is the number of the updated table. Table numbers start at 1. The <i>tabnum</i> must refer to a table that can be browsed. The <b>dbtabbrowse</b> function determines whether a table can be browsed. If this value is -1, the <i>tabname</i> parameter identifies the table.</dd>
<dt>
<i>tabname</i></dt>
<dd>
Is a pointer to a null-terminated table name. The <i>tabname</i> must refer to a table that can be browsed. Set this pointer to NULL if the <i>tabnum</i> parameter is used to identify the table. The value of <i>tabname</i> is returned by <b>dbtabsource</b>.
</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED or FAIL. The following situations cause this function to return FAIL:
<ul>
<li>
The application tries to update the timestamp of a nonexistent row.</li>
<li>
The application tries to update the timestamp, using NULL as the new timestamp value (<i>newts</i>).</li>
<li>
The specified table cannot be browsed.</li>
</ul>
<h4>Remarks</h4>
<p>
The <b>dbtsput</b> function is one of the DB-Library browse-mode functions. For a detailed discussion of browse mode, see <a href="pdc02_4tb9.htm">Browse Mode</a> in <a href="pdc02_3mpe.htm">Programming with DB-Library</a>. </p>
<p>
The <b>dbtsput</b> function manipulates the timestamp column. The WHERE clause returned by <b>dbqual</b> contains a call to the TSEQUAL built-in function. When such a WHERE clause is used in an UPDATE statement, the TSEQUAL function places a new value in the updated row's timestamp column and returns the new timestamp value to the application (if the update is successful). If the same row is updated a second time, the UPDATE statement's WHERE clause must use the latest timestamp value. This function updates the timestamp in the DBPROCESS for the row currently being browsed. Then, if the application needs to update the row a second time, it can call <b>dbqual</b> to formulate a new WHERE clause that uses the new timestamp. Call <b>dbtsput</b> only after <b>dbnextrow</b> or <b>dbgetrow</b> has returned reg_row.</p>
<h4>See Also</h4>
<p>
<a href="pdc08_7gv9.htm"><b>dbcolbrowse</b></a>, <a href="pdc08_065h.htm"><b>dbcolsource</b></a>, <a href="pdc08_0ap8.htm"><b>dbqual</b></a>, <a href="pdc08_91ut.htm"><b>dbtabbrowse</b></a>, <a href="pdc08_3v1w.htm"><b>dbtabcount</b></a>, <a href="pdc08_9did.htm"><b>dbtabname</b></a>, <a href="pdc08_1r51.htm"><b>dbtabsource</b></a>, <a href="pdc08_95wu.htm"><b>dbtsnewlen</b></a>, <a href="pdc08_01bg.htm"><b>dbtsnewval</b></a>; <a href="pdc09_7e7t.htm">Bulk-Copy Functions</a></p>
<p>&nbsp;</p></body>
</HTML>
