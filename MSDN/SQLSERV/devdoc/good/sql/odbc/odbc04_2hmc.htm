<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Remote Procedure Calls</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_remote_procedure_calls_odbc04"></a>Remote Procedure Calls</h1>
<p>
The SQL&nbsp;Server driver uses the RPC facility in SQL&nbsp;Server to run procedures rather than pass procedures to SQL&nbsp;Server in an SQL statement. A procedure can be:
<ul>
<li>
A prepared statement (which is a statement that is stored as a procedure)</li>
<li>
A procedure that is called with the ODBC procedure syntax</li>
<li>
A stored procedure that the SQL&nbsp;Server driver uses to implement a catalog function </li>
</ul>
<p>
RPCs have the following advantages over procedures passed in an SQL statement:
<ul>
<li>
RPCs are faster than procedures passed in an SQL statement.</li>
<li>
RPCs can have output parameters (however, see "Limitations," below); procedures passed in an SQL statement cannot. (A procedure can return a value in either case.)</li>
</ul>
<h5><img src="../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To run a statement as an RPC, an application</h5>
<ol>
<li>
Constructs an SQL statement.</li>
<li>
Calls <b>SQLBindParameter</b> for each parameter in the statement.</li>
<li>
Prepares the statement with <a href="odbc07_24af.htm"><b>SQLPrepare</b></a>. (Note that the SQL_USE_PROCEDURE_FOR_PREPARE connection option must be set to SQL_UP_ON.)</li>
<li>
Executes the statement with <b>SQLExecute</b>.</li>
</ol>
<h5><img src="../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To run a procedure as an RPC, an application</h5>
<ol>
<li>
Constructs an SQL statement that uses the ODBC procedure syntax. The statement uses parameter markers for each input, input/output, and output parameter, and for the procedure return value (if any).</li>
<li>
Calls <b>SQLBindParameter</b> for each input, input/output, and output parameter, and for the procedure return value (if any).</li>
<li>
Executes the statement with <b>SQLExecDirect</b>.</li>
</ol>
<p>
<b>Note</b>  If an application submits a procedure using the SQL&nbsp;Server syntax (as opposed to the ODBC procedure syntax), the SQL&nbsp;Server driver passes the procedure call to SQL&nbsp;Server as an SQL statement rather than as an RPC.</p>
<p>&nbsp;</p></body>
</HTML>
