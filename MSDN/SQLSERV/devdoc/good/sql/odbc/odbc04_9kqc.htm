<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Manual-commit Mode Transactions</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_manual.2d.commit_mode_transactions_odbc04"></a>Manual-commit Mode Transactions</h1>
<p>
When the SQL&nbsp;Server driver is in manual-commit mode, it initiates a transaction with a BEGIN TRANSACTION statement in the following situations:
<ul>
<li>
An SQL statement is pending.</li>
<li>
There is no current transaction.</li>
<li>
It is not a restricted Data Definition Language (DDL) statement.<p>
For more information about restricted DDL statements, see the section on <a href="../tsqlref/src/tsql28_9u7s.htm">Transactions</a> in the <i>Microsoft SQL&nbsp;Server Transact-SQL Reference</i> documentation for the list of statements that cannot be in a transaction.
</li>
</ul>
<p>
To commit or roll back a transaction in manual-commit mode, the application must call <b>SQLTransact</b>. The SQL&nbsp;Server driver sends a COMMIT TRANSACTION statement to commit a transaction; it sends a ROLLBACK TRANSACTION statement to roll back a transaction.</p>
<p>
A restricted DDL statement can be executed only in manual-commit mode under one of the following circumstances:
<ul>
<li>
After manual commit mode has been set and before a non-restricted DDL or a Data Manipulation Language (DML) statement has been executed, </li>
</ul>
<p>
Or
<ul>
<li>
After a transaction has been committed or rolled back and before a non-restricted DDL or a DML statement has been executed.</li>
</ul>
<p>
For more information about manual-commit mode, see <a href="odbc07_5x9z.htm"><b>SQLSetConnectOption</b></a> in the <i>Microsoft ODBC SDK Programmer's Reference</i>.</p>
<p>
The following ODBC catalog functions cannot be called inside a transaction because they use catalog stored procedures that create temporary tables:</p>
<p>
<b>SQLColumnPrivileges</b><br>
<b>SQLForeignKeys</b><br>
<b>SQLPrimaryKeys</b> (limited for SQL&nbsp;Server 4.2<i>x</i> only)<br>
<b>SQLStatistics</b><br>
<b>SQLTablePrivileges</b></p>
<p>&nbsp;</p></body>
</HTML>
