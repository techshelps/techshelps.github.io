<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Upgrading the Catalog Stored Procedures</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_upgrading_the_catalog_stored_procedures_odbc02"></a>Upgrading the Catalog Stored Procedures</h1>
<p>
The SQL&nbsp;Server driver uses a set of system stored procedures, known as catalog stored procedures, to obtain information from the SQL&nbsp;Server system catalog. Microsoft SQL&nbsp;Server installs the catalog stored procedures automatically when you install or upgrade SQL&nbsp;Server. The INSTCAT.SQL file included with this driver includes minor updates to the catalog stored procedures. Having the SQL&nbsp;Server system administrator upgrade the catalog stored procedures on a server running Microsoft SQL&nbsp;Server 4.21a or 6.0 is required.</p>
<p>
To upgrade the catalog stored procedures, the system administrator runs a script using the <b>isql</b> utility (see the instructions below). Before making any changes to the <i>master</i> database, the system administrator should back it up. To run <b>isql</b>, your computer must be installed as a client workstation for Microsoft SQL&nbsp;Server.</p>
<h5><img src="../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To upgrade the catalog stored procedures</h5>
<ul>
<li>
At the command prompt, use the <b>isql</b> utility to run the INSTCAT.SQL script. For example:<p>
C:&gt; <b>ISQL /Usa /P</b><i>sa_password</i> <b>/S</b><i>server_name</i> <b>/i</b><i>location</i>\INSTCAT.SQL
<p>
where
</li>
</ul>
<dl>
<dt>
<i>sa_password </i></dt>
<dd>
Is the system administrator's password.</dd>
<dt>
<i>server_name </i></dt>
<dd>
Is the name of the server on which SQL&nbsp;Server resides.</dd>
<dt>
<i>location</i> </dt>
<dd>
Is the full path of the location of INSTCAT.SQL. You can use INSTCAT.SQL from an installed SQL&nbsp;Server&nbsp;6.5 (the default location is C:\MSSQL\INSTALL) or from the SQL&nbsp;Server&nbsp;6.5 CD (the default location is <i>D</i>:\<i>platform</i> where <i>D</i> is the CD drive letter and <i>platform</i> is the appropriate server platform directory, such as I386).
</dd>
</dl>
<p>
The INSTCAT.SQL script generates messages. Ignore these.</p>
<p>
The INSTCAT.SQL script fails when there is not enough space available in the <i>master</i> database to store the catalog stored procedures or to log the changes to existing procedures. If the INSTCAT.SQL script fails, contact your system administrator.</p>
<p>
The SQL&nbsp;Server driver uses the following catalog stored procedures.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=40%>Stored procedure</th>
<th align=left width=60%>Returns</th>
</tr>
<tr valign=top>
<td width=40%><b>sp_column_privileges</b></td>
<td width=60%>Information about column privileges for the specified table(s)</td>
</tr>
<tr valign=top>
<td width=40%><b>sp_columns</b></td>
<td width=60%>Information about columns for the specified table(s)</td>
</tr>
<tr valign=top>
<td width=40%><b>sp_databases</b></td>
<td width=60%>A list of databases</td>
</tr>
<tr valign=top>
<td width=40%><b>sp_datatype_info</b></td>
<td width=60%>Information about the supported datatypes</td>
</tr>
<tr valign=top>
<td width=40%><b>sp_fkeys</b></td>
<td width=60%>Information about logical foreign keys</td>
</tr>
<tr valign=top>
<td width=40%><b>sp_pkeys</b></td>
<td width=60%>Information about primary keys</td>
</tr>
<tr valign=top>
<td width=40%><b>sp_server_info</b></td>
<td width=60%>A list of attribute names and matching values for the server</td>
</tr>
<tr valign=top>
<td width=40%><b>sp_special_columns</b></td>
<td width=60%>Information for a single table about columns in the table that have special attributes</td>
</tr>
<tr valign=top>
<td width=40%><b>sp_sproc_columns</b></td>
<td width=60%>Column information for a stored procedure</td>
</tr>
<tr valign=top>
<td width=40%><b>sp_statistics</b></td>
<td width=60%>A list of indexes for a single table</td>
</tr>
<tr valign=top>
<td width=40%><b>sp_stored_procedures</b></td>
<td width=60%>A list of stored procedures</td>
</tr>
<tr valign=top>
<td width=40%><b>sp_table_privileges</b></td>
<td width=60%>Information about table privileges for the specified table(s)</td>
</tr>
<tr valign=top>
<td width=40%><b>sp_tables</b></td>
<td width=60%>A list of objects that can be queried</td>
</tr>
</table><br>
<p>
For additional information about the catalog stored procedures, see <i>What's New in SQL&nbsp;Server&nbsp;6.5 </i>and the <i>Microsoft SQL&nbsp;Server Transact-SQL Reference</i>.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
