<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Cursors</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_creating_cursors_odbc06"></a>Creating Cursors</h1>
<p>
For the purposes of ODBC cursors, the cursor definition is essentially the SQL statement passed as an argument to <b>SQLExecuteDirect</b> or <b>SQLPrepare</b>/<b>SQLExecute</b>. The following rules apply when creating cursors through the SQL&nbsp;Server driver:
<ul>
<li>
Server cursors are created only for statements that begin with a SELECT, EXEC[ute] <i>procedure_name</i>, or {<b>call</b> <i>procedure_name</i>} clause. Otherwise, the statement is treated as a Type A statement. Server cursors are not created for an SQL batch. SQL batches are treated as Type A statements.</li>
<li>
When connected to SQL&nbsp;Server version 6.0 and earlier, if you ask for a Dynamic or Keyset cursor and there is not a unique index for every table referenced in the cursor definition, the server creates a static cursor and the driver returns a SQL_SUCCESS_WITH_INFO status.</li>
<li>
SQL&nbsp;Server allows you to create cursors on base tables as well as on views. In addition, cursors can be opened on a query involving joins between multiple tables and/or aggregate operators. You cannot, however, use the keywords COMPUTE, COMPUTE BY, FOR BROWSE, and INTO in the cursor definition.</li>
<li>
If the cursor definition involves a UNION, UNION ALL, outer join, GROUP BY with/without HAVING, or DISTINCT, a static cursor is always created irrespective of what was requested and the driver returns a SQL_SUCCESS_WITH_INFO status.</li>
<li>
When connected to SQL&nbsp;Server version 6.0 and earlier, if you ask for a Dynamic cursor and the cursor definition contains an ORDER BY clause that does not match a unique index or a subquery, the server creates a Keyset cursor and the driver returns a SQL_SUCCESS_WITH_INFO status.</li>
<li>
If you ask for a concurrency of row versioning and there is not a <i>timestamp </i>column for every table in the cursor definition, the server uses a concurrency based on values and the driver returns a SQL_SUCCESS_WITH_INFO status.</li>
<li>
You will get a cursor on <b>SQLExecDirect</b> <b>(</b>EXEC[ute] <i>procedure_name</i> or {<b>call </b><i>procedure_name</i>}<b>)</b> only if the procedure contains one SELECT statement and nothing else. Otherwise, SQL&nbsp;Server generates an error message. </li>
<li>
You will automatically get the cursor behavior associated with Type A statements when executing a batch that contains multiple SELECT statements (except if the first statement is a SELECT, EXECUTE, or ODBC canonical procedure invocation, in which case, SQL&nbsp;Server driver generates an error message).</li>
</ul>
<p>
Keyset cursors could also be populated asynchronously (please refer to the SQL&nbsp;Server documentation about <b>sp_configure</b>). Asynchronous keyset population does not affect the cursor-related ODBC APIs except for <b>SQLRowCount</b>.</p>
<p>
</p>
<p>
The following ODBC functions are relevant for creating cursors: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%><object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sqlsetstmtoption">
</object><a href=JavaScript:alink_1.Click()><b>SQLSetStmtOption</b></a></td>
<td width=52%><object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sqlgetcursorname">
</object><a href=JavaScript:alink_2.Click()><b>SQLGetCursorName</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="odbc07_4ncn.htm"><b>SQLSetScrollOptions</b></a></td>
<td width=52%><a href="odbc07_01x3.htm"><b>SQLGetStmtOption</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="odbc07_5x9z.htm"><b>SQLSetConnectOption</b></a></td>
<td width=52%><a href="odbc07_0it3.htm"><b>SQLGetInfo</b></a></td>
</tr>
<tr valign=top>
<td width=48%><a href="odbc07_7y5z.htm"><b>SQLSetCursorName</b></a></td>
<td width=52%></td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
