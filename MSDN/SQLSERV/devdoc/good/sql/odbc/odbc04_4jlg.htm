<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Logging Performance Data</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_logging_performance_data_odbc04"></a>Logging Performance Data</h1>
<p>
In SQL&nbsp;Server&nbsp;6.5, the ODBC SQL&nbsp;Server driver supports logging performance data.</p>
<h5><img src="../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To log ODBC performance data</h5>
<ol>
<li>
Optionally, call <b>SQLSetConnectOption</b> with <i>fOption</i> set to SQL_COPT_SS_PERF_DATA_LOG and <i>vParam</i> set to the full path and filename of the performance data log file. For example: <pre><code>C:\\ODBCPERF.LOG
</code></pre>
</li>
<li>
Call <b>SQLSetConnectOption</b> with <i>fOption</i> set to SQL_COPT_SS_PERF_DATA and <i>vParam</i> set to SQL_PERF_START to start logging performance data.</li>
<li>
Call <b>SQLGetConnectOption</b> with <i>fOption</i> set to SQL_COPT_SS_PERF_DATA and <i>pvParam</i> set to the address of a pointer to a SQLPERF structure. This will set the pointer to point to a valid SQLPERF structure that contains current performance data.</li>
<li>
Optionally, call <b>SQLSetConnectOption</b> with <i>fOption</i> set to SQL_COPT_SS_LOG_NOW and <i>vParam</i> set to NULL to write a tab-delimited record of performance data to the performance data log file.</li>
<li>
Call <b>SQLSetConnectOption</b> with <i>fOption</i> set to SQL_COPT_SS_PERF_DATA and <i>vParam</i> set to SQL_PERF_STOP to stop logging performance data.</li>
</ol>
<p>
The SQLPERF structure is defined as follows:</p>
<pre><code>typedef struct sqlperf
{
    // Application Profile Statistics
    DWORD TimerResolution;
    DWORD SQLidu;
    DWORD SQLiduRows;
    DWORD SQLSelects;
    DWORD SQLSelectRows;
    DWORD Transactions;
    DWORD SQLPrepares;
    DWORD ExecDirects;
    DWORD SQLExecutes;
    DWORD CursorOpens;
    DWORD CursorSize;
    DWORD CursorUsed;
    LDOUBLE PercentCursorUsed;
    LDOUBLE AvgFetchTime;
    LDOUBLE AvgCursorSize; 
    LDOUBLE AvgCursorUsed;
    DWORD SQLFetchTime;
    DWORD SQLFetchCount;
    DWORD CurrentStmtCount;
    DWORD MaxOpenStmt;
    DWORD SumOpenStmt;
    
    // Connection Statistics
    DWORD CurrentConnectionCount;
    DWORD MaxConnectionsOpened;
    DWORD SumConnectionsOpened;
    DWORD SumConnectionTime;
    LDOUBLE AvgTimeOpened;

    // Network Statistics
    DWORD ServerRndTrips;
    DWORD BuffersSent;
    DWORD BuffersRec;
    DWORD BytesSent;
    DWORD BytesRec;

    // Time Statistics;
    DWORD msExecutionTime;
    DWORD msNetworkServerTime;

}     SQLPERF;
</code></pre>
<p>&nbsp;</p></body>
</HTML>
