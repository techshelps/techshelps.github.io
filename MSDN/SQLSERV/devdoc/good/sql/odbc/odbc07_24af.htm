<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLPrepare</title>
<link disabled rel=stylesheet href=../../../backsdk3.css>
<style type="text/css">
@import url(../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sqlprepare_odbc07"></a>SQLPrepare</h1>
<p>
SQL&nbsp;Server does not directly support the Prepare/Execute model of ODBC.</p>
<p>
First, a temporary stored procedure is created from the statement, because stored procedures are an efficient way to execute a statement more than once. The procedure is named #odbc#<i>useridentifier</i>, where <i>user</i> is up to 6 characters of the username and <i>identifier</i> is up to 8 digits and identifies the statement. The procedure is created at prepare time if all parameters have been set, or at execute time if all parameters were not set at prepare time or if any parameter has been reset since the procedure was created. Because of this, <b>SQLExecute</b> can return any errors that <b>SQLPrepare</b> can return.</p>
<p>
If CREATE PROCEDURE returns an error, <b>SQLPrepare</b> submits the statement to SQL&nbsp;Server with the SET NOEXEC or SET PARSEONLY option enabled (depending on the statement type). SQL&nbsp;Server checks the syntax of the statement and returns any errors.</p>
<p>
If a user cannot create a stored procedure for any reason (such as lack of permission), the SQL&nbsp;Server driver does not use a stored procedure but, instead, submits the SQL statement each time <b>SQLExecute</b> is called.</p>
<p>
You can disable a generation of stored procedures for <b>SQLPrepare</b>. If disabled, the statement will be stored and re-executed at execution time. You can disable generation of stored procedures in either of two ways:
<ul>
<li>
Clear the Generate Stored Procedures for Prepared Statements check box in the ODBC SQL&nbsp;Server Driver Setup dialog box.</li>
<li>
Set the SQL_USE_PROCEDURE_FOR_PREPARE option of the <b>SQLSetConnectOption</b> function to SQL_UP_OFF.</li>
</ul>
<p>
When generation of stored procedures is disabled and the statement is stored and executed at run time, all syntax error checking is delayed until run time.</p>
<p>
Note that if SET NOCOUNT ON has been executed, multiple statements embedded in a stored procedure do not create multiple results sets as they should. Row counts that are generated by SQL statements inside a stored procedure are ignored by the driver. </p>
<p>&nbsp;</p></body>
</HTML>
