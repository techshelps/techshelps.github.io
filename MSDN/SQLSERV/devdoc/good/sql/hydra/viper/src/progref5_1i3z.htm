<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ITransaction::GetTransactionInfo</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_itransaction.3a3a.gettransactioninfo"></a>ITransaction::GetTransactionInfo</h3>
<p>
Returns information about a transaction.</p>
<h4>Syntax</h4>
<p>
<b>HRESULT GetTransactionInfo ( XACTTRANSINFO* </b><i>pinfo</i> <b>)</b></p>
<p>
where
<dl>
<dt>
<i>pinfo</i></dt>
<dd>
[out] Is the pointer to the XACTTRANSINFO structure that was allocated by the caller. This structure will receive information about the transaction. Must not be NULL.

<p>
The XACTTRANSINFO structure is defined as follows:

<pre>typedef struct XACTTRANSINFO
{
XACTUOW uow;
ISOLEVEL isoLevel;
ULONG isoFlags;
DWORD grfTCSupported;
DWORD grfRMSupported;
DWORD grfTCSupportedRetaining;
DWORD grfRMSupportedRetaining;
}    XACTTRANSINFO;
</pre>

<p>
The XACTTRANSINFO members are described below.

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=37%></th>
<th align=left width=63%></th>
</tr>
<tr valign=top>
<th align=left width=37%></th>
<th align=left width=63%></th>
</tr>
<tr valign=top>
<th align=left width=37%>Member</th>
<th align=left width=63%>Description</th>
</tr>
<tr valign=top>
<td width=37%><b>uow</b></td>
<td width=63%>Is the unit of work that is associated with this transaction.</td>
</tr>
<tr valign=top>
<td width=37%><b>isoLevel</b></td>
<td width=63%>Is the isolation level that is associated with this transaction object. ISOLATIONLEVEL_UNSPECIFIED indicates that no isolation level was specified.</td>
</tr>
<tr valign=top>
<td width=37%><b>isoFlags</b></td>
<td width=63%>Will be set to zero (0).</td>
</tr>
<tr valign=top>
<td width=37%><b>grfTCSupported</b></td>
<td width=63%>This bit mask indicates which <i>grfTC</i> flags are supported by the current version of MS DTC. The application can set one or more of these <i>grfTC</i> flags when calling <b>ITransaction::Commit</b>. </td>
</tr>
<tr valign=top>
<td width=37%><b>grfRMSupported</b></td>
<td width=63%>Will be set to zero (0).</td>
</tr>
<tr valign=top>
<td width=37%><b>grfTCSupportedRetaining</b></td>
<td width=63%>Will be set to zero (0).</td>
</tr>
<tr valign=top>
<td width=37%><b>grfRMSupportedRetaining</b></td>
<td width=63%>Will be set to zero (0).</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Returns</h4>
<dl>
<dt>
S_OK</dt>
<dd>
Indicates succeeded.</dd>
<dt>
XACT_E_NOTRANSACTION</dt>
<dd>
Indicates unable to retrieve information for the transaction, because it was already complete. No information is returned.</dd>
<dt>
E_UNEXPECTED</dt>
<dd>
Indicates an unexpected error has occurred. No information is returned.</dd>
<dt>
E_INVALIDARG</dt>
<dd>
Indicates the value of <i>pinfo</i> was NULL. No information is returned.
</dd>
</dl>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
