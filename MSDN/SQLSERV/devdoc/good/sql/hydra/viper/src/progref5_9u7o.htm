<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ITransaction::Commit</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_itransaction.3a3a.commit"></a>ITransaction::Commit</h3>
<p>
Commits the transaction.</p>
<h4>Syntax</h4>
<p>
<b>HRESULT Commit (</b><br>
<b>BOOL</b> <i>fRetaining</i><b>,</b> <br>
<b>DWORD</b> <i>grfTC</i><b>,</b> <br>
<b>DWORD</b> <i>grfRM </i><b>)</b></p>
<p>
where
<dl>
<dt>
<i>fRetaining</i></dt>
<dd>
[in] Is FALSE.</dd>
<dt>
<i>grfTC</i></dt>
<dd>
[in] Is the set of values from the enumeration XACTTC that is described below.</dd>
<dt>
<i>grfRM</i></dt>
<dd>
[in] Is zero. 
</dd>
</dl>
<h4>Returns</h4>
<dl>
<dt>
S_OK</dt>
<dd>
Indicates succeeded.</dd>
<dt>
XACT_S_ASYNC</dt>
<dd>
Indicates an asynchronous commit was specified. The commit operation has begun, but its outcome is not yet known. The application can use the <b>ITransactionOutcomeEvents </b>interface to receive notice of the outcome of the transaction. </dd>
<dt>
XACT_E_NOTRANSACTION</dt>
<dd>
Indicates unable to commit the transaction, because it had already been committed or aborted. The call was ignored.</dd>
<dt>
XACT_E_ALREADYINPROGRESS</dt>
<dd>
Indicates a commit or abort operation was already in progress. The call was ignored.</dd>
<dt>
XACT_E_NOTSUPPORTED</dt>
<dd>
Indicates an invalid combination of commit flags was specified. The call was ignored.</dd>
<dt>
XACT_E_CANTRETAIN</dt>
<dd>
Indicates retaining commit is not supported. The call was ignored.</dd>
<dt>
E_FAIL</dt>
<dd>
Indicates the transaction failed to commit for an unknown reason. The transaction was aborted.</dd>
<dt>
XACT_E_INDOUBT</dt>
<dd>
Indicates the transaction status is unknown. A communication failure has occurred or a transaction manager or resource manager has failed. </dd>
<dt>
E_UNEXPECTED</dt>
<dd>
Indicates an unexpected error has occurred. The transaction status is unknown.</dd>
<dt>
XACT_E_ABORTED</dt>
<dd>
Indicates the transaction was aborted before <b>ITransaction::Commit </b>was called.</dd>
<dt>
XACT_E_CONNECTION_DOWN</dt>
<dd>
Indicates no longer able to communicate with the transaction manager, because the connection to the transaction manager failed. The transaction was aborted.
</dd>
</dl>
<h4>Remarks</h4>
<p>
These flags are supported for the <i>grfTC</i> parameter.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=36%></th>
<th align=left width=64%></th>
</tr>
<tr valign=top>
<th align=left width=36%></th>
<th align=left width=64%></th>
</tr>
<tr valign=top>
<th align=left width=36%>Flag</th>
<th align=left width=64%>Meaning</th>
</tr>
<tr valign=top>
<td width=36%>XACTTC_ASYNC</td>
<td width=64%>When this flag is specified, an asynchronous commit is performed. The call to <b>ITransaction::Commit</b> returns as soon as the two-phase commit protocol is initiated. The application can use the <b>ITransactionOutcomeEvents </b>interface to determine the outcome of the transaction. This flag cannot be specified when the XACTTC_SYNCPHASEONE flag is specified.<p>
If neither XACTTC_ASYNC nor XACTTC_SYNCPHASEONE is specified, a synchronous commit is performed.</p>
</td>
</tr>
<tr valign=top>
<td width=36%>XACTTC_SYNCPHASEONE</td>
<td width=64%>When this flag is specified, a synchronous commit is performed. The call to <b>ITransaction::Commit</b> returns after phase one of the two-phase commit protocol. This flag cannot be specified when the XACTTC_ASYNC flag is specified.<p>
If neither XACTTC_ASYNC nor XACTTC_SYNCPHASEONE is specified, a synchronous commit is performed.</p>
</td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
