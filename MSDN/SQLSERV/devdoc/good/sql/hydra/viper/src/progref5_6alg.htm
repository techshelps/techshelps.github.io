<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ITransactionOutcomeEvents::Aborted</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_itransactionoutcomeevents.3a3a.aborted"></a>ITransactionOutcomeEvents::Aborted</h3>
<p>
Raised when the transaction aborts.<b> </b></p>
<p>
MS DTC raises the <b>Aborted</b> event as soon as the transaction manager decides to abort the transaction. When the <b>Aborted</b> event is raised, there is no guarantee that the resource managers will have received the abort request or undone the effects of the aborted transaction.</p>
<p>
A transaction can abort for any of the following reasons:
<ul>
<li>
The application that initiated the transaction aborted the transaction by calling <b>ITransaction::Abort</b>.</li>
<li>
The application that initiated the transaction called <b>ITransaction::Commit</b> for the transaction, but the attempt to commit the transaction was unsuccessful.</li>
<li>
The application that initiated the transaction failed due to a process fault or system failure before it called <b>ITransaction::Commit</b>.</li>
<li>
The application that initiated the transaction lost communication with the transaction manager before calling <b>ITransaction::Commit</b>.</li>
<li>
An enlisted resource manager failed due to a process fault or system failure before completion of phase one of the two-phase commit protocol.</li>
<li>
A communication failure occurred between a transaction manager and an enlisted resource manager before completion of phase one of the two-phase commit protocol.</li>
<li>
An enlisted resource manager called <b>IUnknown::Release</b> to release the transaction object before completion of phase one of the two-phase commit protocol.</li>
<li>
An enlisted resource manager replied "abort" when asked to prepare at phase one of the two-phase commit protocol.</li>
<li>
An enlisted transaction manager failed due to a process fault or system failure before the completion of phase one of the two-phase commit protocol.</li>
<li>
A communication failure occurred between two enlisted transaction managers before the completion of phase one of the two-phase commit protocol.</li>
<li>
The transaction failed to commit within the timeout that was specified when the transaction was initiated. The transaction was aborted by the transaction manager.</li>
<li>
A transaction manager detected that a new transaction manager or resource manager tried to join the transaction while the transaction was being committed. The transaction manager aborted the transaction.</li>
<li>
The system administrator resolved an in-doubt transaction by manually aborting it.</li>
</ul>
<h4>Syntax</h4>
<p>
<b>HRESULT Aborted (</b><br>
<b>BOID* </b><i>pboidReason</i><b>,</b><br>
<b>BOOL </b><i>fRetaining</i><b>,</b><br>
<b>XACTUOW* </b><i>pNewUOW</i><b>,</b><br>
<b>HRESULT </b><i>hr</i> <b>)</b></p>
<p>
where
<dl>
<dt>
<i>pboidReason</i></dt>
<dd>
[in] Is always NULL.</dd>
<dt>
<i>fRetaining</i></dt>
<dd>
[in] Is always FALSE.</dd>
<dt>
<i>pNewUOW</i></dt>
<dd>
[in] Is always NULL.</dd>
<dt>
<i>hr</i></dt>
<dd>
[in] Is always S_OK
</dd>
</dl>
<h4>Returns</h4>
<dl>
<dt>
S_OK</dt>
<dd>
Indicates the transaction aborted.
</dd>
</dl>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
