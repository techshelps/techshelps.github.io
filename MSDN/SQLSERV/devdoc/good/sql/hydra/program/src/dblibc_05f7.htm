<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>dbenlistxatrans</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_dbenlistxatrans"></a>dbenlistxatrans</h1>
<p>
Enlists the current SQL Server connection in a transaction that is coordinated by an XA-compliant transaction processing (TP) monitor.</p>
<h4>Syntax</h4>
<p>
<b>RETCODE dbenlistxatrans ( <br>
PDBPROCESS </b><i>dbproc</i><b>, <br>
BOOL </b><i>enlisttran</i><b> );</b></p>
<p>
where
<dl>
<dt>
<i>dbproc</i></dt>
<dd>
Is the DBPROCESS structure that is the handle for a particular workstation/SQL Server process. It contains all the information that DB-Library uses to manage communications and data between the workstation and SQL Server.</dd>
<dt>
<i>enlisttran</i></dt>
<dd>
Is TRUE or FALSE. TRUE specifies to enlist in the current XA transaction. False specifies to enlist in the NULL transaction, which results in the connection no longer being enlisted in any XA transaction.
<p>
When <i>enlisttran</i> is TRUE, the SQL Server connection is enlisted in the current XA transaction. All SQL operations performed using the SQL Server connection will be performed under the protection of the current XA transaction.


<p>
When <i>enlisttran</i> is FALSE, the SQL Server connection is no longer enlisted in any XA transaction. If you have used a SQL Server connection with an XA transaction, and you want to use the same SQL Server connection with a local SQL Server transaction, you must call <b>dbenlistxatrans</b> and pass a value of FALSE for the <i>enlisttran</i> parameter.

</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED or FAIL.</p>
<h4>Remarks</h4>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To use XA transactions</h5>
<ol>
<li>
Call <b>dbopen</b> once for each SQL Server connection you want to establish.</li>
<li>
Call the X/Open <b>tx_begin</b> function to begin an XA transaction. <b>tx_begin</b> calls the appropriate XA-compliant TP monitor.</li>
<li>
For each SQL Server connection you want to enlist in the XA transaction, call <b>dbenlistxatrans</b> with <i>enlisttran</i> set to TRUE. Each call associates the current XA transaction with the specified SQL Server connection.</li>
<li>
Call <b>dbsqlexec</b> one or more times to perform SQL Server operations.</li>
<li>
Call the X/Open <b>tx_commit</b> function to commit the XA transaction.<p>
To perform a series of XA transactions, repeat steps 2 through 5.
</li>
</ol>
<p>
See the SQL_COPT_SS_ENLIST_IN_XA connection option of the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../../../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_sqlsetconnectoption">
</object><a href=JavaScript:alink_1.Click()><b>SQLSetConnectOption</b></a> function for information about using XA transactions through ODBC.</p>
<h4>See Also</h4>
<p>
<a href="dblibc_0a9f.htm"><b>dbenlisttrans</b></a> </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
