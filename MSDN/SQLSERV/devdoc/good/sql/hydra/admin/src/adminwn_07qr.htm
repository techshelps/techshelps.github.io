<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Replication and Invalid SQL Server Names</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_replication_and_invalid_sql_server_names"></a>Replication and Invalid SQL Server Names</h3>
<p>
In SQL Server 6.0, replication to and from servers with Windows NT-based computers that are invalid SQL Server names is not supported.  (For example, names with hyphens are invalid SQL Server names). The reason for this is that in SQL Server 6.0, replication uses the <i>srvname </i>column in the <i>sysservers </i>system table, and entries in this column need to be valid SQL Server names.</p>
<p>
SQL Server 6.5 relaxes this restriction by using the <i>srvnetname </i>column in <i>sysservers </i>instead.</p>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To set up an invalid SQL Server name as a publisher, distributor, or publisher/distributor</h5>
<ol>
<li>
In the SQL Client Configuration utility, in the Advanced dialog box, create a DB-Library alias from a valid server name to the Windows NT-based machine name. For example, if the machine name is <b>new-server-name</b> (with invalid hyphens), the client configuration information will be:</li>
</ol>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=38%>Server:</td>
<td width=62%>new_server_name</td>
</tr>
<tr valign=top>
<td width=38%>DLL:</td>
<td width=62%>Named pipes</td>
</tr>
<tr valign=top>
<td width=38%>Connection string:</td>
<td width=62%>new-server-name</td>
</tr>
</table><br>
<p class=indent1>
For more information, see the <i>Microsoft SQL Server Administrator's Companion</i>.</p>
<ol start=2>
<li>
In SQL Enterprise Manager, from the Server menu, register the server using the alias defined in step 1.<p>
For example, register the server as <b>new_server_name</b>.
<p>
Note that you will not be able to start and stop SQL Server or SQL Executive from SQL Enterprise Manager. You can use SQL Service Manager. Also, you will be unable to view the SQL Executive icon. View SQL Executive tasks via the Server menu/Scheduled Tasks selection in SQL Enterprise Manager.
</li>
<li>
Using stored procedure <b>sp_addserver</b>,<b> </b>create a local server name for SQL Server that matches the server alias created in step 1, as follows:<pre>sp_addserver new_server_name, LOCAL
<b><i>  </i></b></pre>
<p>
where 
<dl>
<dt>
<i>new_server_name</i></dt>
<dd>
Specifies a logical server name to replace the invalid server name.</dd>
<dt>
LOCAL</dt>
<dd>
Specifies the server is on the local machine.</dd>
</dl>
</li>
<li>
Start SQL Server.</li>
<li>
In SQL Enterprise Manager, from the Server menu, choose Replication Configuration/Install Publishing. <p>
Complete the Install Replication Publishing dialog box that appears.
</li>
<li>
In SQL Enterprise Manager, from the Server menu, choose Replication Configuration/Publishing. <p>
The Replication - Publishing dialog box appears. 
</li>
<li>
In the Working Directory box, type the network machine name; it will be using the registered server name.</li>
<li>
In SQL Enterprise manager, create publications and articles on the publisher. You can also use stored procedures to create publications and articles.</li>
<li>
With SQL Enterprise Manager focus set on a subscribing server, set the publisher's <i>srvnetname </i>on the subscriber as follows:<pre>sp_setnetname new_server_name, 'new-server-name'
<b><i>  </i></b></pre>
<p>
where
<dl>
<dt>
<i>new_server_name</i> </dt>
<dd>
Is the server alias for the publisher that was defined on the subscriber by SQL Enterprise Manager.</dd>
<dt>
<i>new-server-name</i></dt>
<dd>
Is the invalid machine name.</dd>
</dl>
</li>
<li>
Enable subscribing from the publishing server.<p>
You can now create either push or pull subscriptions.
</li>
</ol>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To set up an invalid SQL Server name as a subscriber </h5>
<ol>
<li>
Change the SQL Server name by using the stored procedure <b>sp_addserver</b>, as follows:<pre>sp_addserver new_server_name, LOCAL
<b><i>  </i></b></pre>
<p>
where
<dl>
<dt>
<i>new_server_name</i></dt>
<dd>
Specifies a logical server name to replace the invalid server name.</dd>
<dt>
LOCAL</dt>
<dd>
Specifies the local machine.</dd>
</dl>
</li>
<li>
Restart SQL Server.</li>
<li>
From SQL Enterprise Manager, add a subscriber using the logical name (for example, <b>new-server-name</b>) on the Publisher/Distributor.</li>
<li>
Set the subscriber's <i>srvnetname </i>on the Publisher/Distributor by using:<pre>sp_setnetname new_server_name, 'new-server-name'
<b><i>  </i></b></pre>
<p>
where
<dl>
<dt>
<i>new_server_name</i></dt>
<dd>
Specifies a logical server name to replace the invalid server name.</dd>
<dt>
<i>new-server-name</i></dt>
<dd>
Specifies the real machine name, which contains hyphens in this example.</dd>
</dl>
</li>
<li>
Create publications and articles on the publisher.</li>
<li>
Create push or pull subscriptions.</li>
</ol>
<p>
For more information on replication, see the <i>Microsoft SQL Server Administrator's Companion.</i></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
