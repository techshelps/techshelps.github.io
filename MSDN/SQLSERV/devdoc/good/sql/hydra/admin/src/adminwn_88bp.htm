<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQL Trace</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sql.a0.trace"></a>SQL Trace</h1>
<p>
Microsoft SQL Trace is a graphical utility that monitors and records SQL Server 6.5 database activity. SQL Trace can display all server activity in real time or create filters that focus on the actions of particular users, applications, or host servers. SQL Trace can display any SQL statements or remote procedure calls (RPCs) that are sent to any Microsoft SQL Server 6.5 server. SQL Trace also records connections and disconnections made to and from the server. SQL Trace activity can be saved to disk in an ISQL/w-compatible script or as an activity log. </p>
<p>
All events can be annotated with SQL Server login name, Windows NT domain\username, application name, and host name (where available). The statistics start time, end time, duration, CPU usage, reads, and synchronous writes are avaliable for all events. For language and RPC events, the statistics refer to the individual events. For events such as disconnection, the statistics refer to the complete session. Complete session statistics can be used for auditing.</p>
<p>
SQL Trace provides a graphical user interface to the extended stored procedure <b>xp_sqltrace</b>. Many of the features provided by SQL Trace can also be achieved programmatically by using <b>xp_sqltrace</b> directly. For example, by creating an auto-start stored procedure that calls <b>xp_sqltrace</b>, it is possible to automatically start SQL Server auditing.</p>
<p>
SQL Trace is installed with SQL Server 6.5 server software and, optionally, with the 32-bit client software. </p>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To start SQL Trace from the command line</h5>
<ul>
<li>
From the command line, type:</li>
</ul>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;sqltrace /U<i>username </i>/P<i>password </i>/E /H<i>hostname </i>/F<i>filter</i></p>
<p class=indent1>
where</p>
<dl>
<dt>
/U<i>username</i></dt>
<dd>
Specifies the username to log on under.</dd>
<dt>
/P<i>password</i> </dt>
<dd>
Specifies the password for the username.</dd>
<dt>
/E</dt>
<dd>
Specifies that a secure connection will be used.</dd>
<dt>
/H<i>hostname</i></dt>
<dd>
Specifies the computer's hostname.</dd>
<dt>
/F<i>filter</i></dt>
<dd>
Specifies a SQL Trace filter.</dd>
</dl>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To start SQL Trace from the user interface</h5>
<p class=indent1>
<img src="images/sql_icon.gif" border=0></p>
<ol>
<li>
From the Microsoft SQL Server 6.5 program group, choose the SQL Trace icon. <p>
The Connect Server dialog box appears.
</li>
<li>
In the Server box, specify a server to connect to and choose the Connect button. <p>
If filters have been defined for the selected server, the Start Selected Filters dialog box appears. If filters have not been defined for the selected server, a dialog box appears in which you can choose to create a filter. When you choose Yes, the New Filter dialog box appears.
<p>
<img src="images/sqlt_new.gif" border=0>
</li>
</ol>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To create a filter</h5>
<ul>
<li>
When you connect to a server without defined filters, a dialog box appears in which you can choose to create a filter. Choose the Yes button and complete the New Filter dialog box that appears.</li>
</ul>
<p>
Or
<ul>
<li>
In the SQL Trace window, from the toolbar choose the New Filter button to open the New Filter dialog box.</li>
</ul>
<p>
Or
<ul>
<li>
From the File menu, choose New Filter to open the dialog box.</li>
</ul>
<p>
For more information about New Filter dialog box options, from the New Filter dialog box choose Help.</p>
<p>
You can modify or delete an existing filter by using the Filter Properties dialog box.</p>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To modify a filter</h5>
<ol>
<li>
In the SQL Trace window, from the toolbar choose the Edit Filter Properties button. </li>
<li>
Complete the Filter Properties dialog box that appears.</li>
</ol>
<p>
Or
<ul>
<li>
From the File menu, choose Edit Filter Properties to open the Filter Properties dialog box.</li>
</ul>
<p>
Or
<ul>
<li>
In the Filter Status pane, double-click the filter name to open the Filter Properties dialog box.</li>
</ul>
<p>
For more information about Filter Properties dialog box options, from the Filter Properties dialog box, choose Help.</p>
<p>
You can delete an inactive filter.</p>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To delete a filter</h5>
<ol>
<li>
In the Filter Status pane, verify that the filter you want to delete is not running.</li>
<li>
In the SQL Trace window, from the toolbar choose the Delete Filters button.<p>
Complete the Delete Selected Filters dialog box that appears.
</li>
</ol>
<p>
Or
<ul>
<li>
From the File menu, choose Delete Filters to open the Delete Selected Filters dialog box and select the filter to delete.</li>
</ul>
<p>
Or
<ul>
<li>
In the Filter Status pane, double-click the filter name to open the Filter Properties dialog box and choose the Delete button.</li>
</ul>
<p>
For more information about Delete Selected Filters dialog box options, from the Delete Selected Filters dialog box, choose Help.</p>
<p>
<img src="images/sqltrac1.gif" border=0></p>
<p>
The SQL Trace window contains the following elements.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%></th>
<th align=left width=52%></th>
</tr>
<tr valign=top>
<th align=left width=48%></th>
<th align=left width=52%></th>
</tr>
<tr valign=top>
<th align=left width=48%>Element</th>
<th align=left width=52%>Description</th>
</tr>
<tr valign=top>
<td width=48%>SQL Trace title bar</td>
<td width=52%>Displays the name of the connected server. </td>
</tr>
<tr valign=top>
<td width=48%>Active Filter pane</td>
<td width=52%>Displays the activity of the named filter and the requests that are coming to the server named in the SQL Trace title bar. The Active Filter pane title bar displays the filter name. </td>
</tr>
<tr valign=top>
<td width=48%>Filter Status pane</td>
<td width=52%>Lists the filters that are currently defined on the server, displays information about these filters, and provides Start, Pause, and Stop buttons.</td>
</tr>
<tr valign=top>
<td width=48%>&nbsp;&nbsp;&nbsp;&nbsp;Screen check box</td>
<td width=52%>Specifies whether to display filter activity in the Active Filter pane.</td>
</tr>
<tr valign=top>
<td width=48%>&nbsp;&nbsp;&nbsp;&nbsp;Script check box</td>
<td width=52%>Specifies whether to save filter activity as an SQL script.</td>
</tr>
<tr valign=top>
<td width=48%>&nbsp;&nbsp;&nbsp;&nbsp;Log check box</td>
<td width=52%>Specifies whether to save filter activity to a log.</td>
</tr>
<tr valign=top>
<td width=48%>Active Filters box&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td width=52%>Displays in the lower, right-hand corner of the status bar the number of active filters. To display the Active Filters box, from the View menu, select Statusbar. To hide the Active Filters box, from the View menu, clear Statusbar.</td>
</tr>
</table><br>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To control filter activity from the Filter Status pane</h5>
<p>
<img src="images/strtfilt.gif" border=0></p>
<p>
To start a filter, choose the right-pointing arrow Start button.</p>
<p>
<img src="images/pzfilt.gif" border=0></p>
<p>
To pause a filter, choose, the parallel vertical bars Pause button.</p>
<p>
<img src="images/stpfilt.gif" border=0></p>
<p>
To stop a filter, choose the solid box Stop button.</p>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To modify a filter from the Filter Status pane</h5>
<ol>
<li>
Double-click the filter name to modify.</li>
<li>
Complete the Filter Properties dialog box that appears.</li>
</ol>
<p>
For more information about configuring and using SQL Trace, see the SQL Trace online Help.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
