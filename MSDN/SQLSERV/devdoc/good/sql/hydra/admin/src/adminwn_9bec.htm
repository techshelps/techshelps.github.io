<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Queries with the SQL Server Web Assistant</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_creating_queries_with_the_sql_server_web_assistant"></a>Creating Queries with the SQL Server Web Assistant</h3>
<p>
The SQL Server Web Assistant offers several ways to build queries. You can:
<ul>
<li>
Build a query from a database/table hierarchy.</li>
<li>
Enter a query as free-form text.</li>
<li>
Use an existing stored procedure.</li>
</ul>
<h4>Building a Query from a Database/Table Hierarchy</h4>
<p>
Select this option for interactive assistance in building a query.</p>
<p>
The SQL Server Web Assistant Query screen appears.</p>
<p>
<img src="images/wp_qry_a.gif" border=0></p>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To interactively build a query from a database/table hierarchy</h5>
<ol>
<li>
From the Query screen, select the Build A Query From A Database Hierarchy option.</li>
<li>
From the database list, select and expand a database. To expand a database object, click the plus sign (+) next to it.</li>
<li>
From the expanded database list, select the table(s) to use in your query. This option is equivalent to a SELECT * FROM <i>table_name</i> statement.</li>
<li>
To select individual columns, expand the table selection. All columns are selected by default. To cancel a selection, clear the column(s).</li>
<li>
In the Do You Want Any Additional Criteria . . . box, type additional clauses for the query, such as WHERE or ORDER BY.</li>
<li>
To continue, choose the Next button. To exit, choose the Cancel button.</li>
</ol>
<p>
For example, to create a web page that contains author information from the sample <i>pubs</i> database, select and expand the <i>pubs</i> database, and then select the <i>authors</i> table. To include only <i>au_id</i> and <i>au_lname</i> columns, expand the <i>authors</i> table and select only these columns. To further refine the query and include only authors from the state of California, add the following clause to the Additional Criteria list box:</p>
<pre>WHERE state = "CA"
<b><i>  </i></b></pre>
<p>
<b>Note</b>  You must enclose string values in double quotation marks (<b>"</b>). Using a single quotation mark (<b>'</b>) will generate a syntax error.</p>
<h4>Entering a Query as Free-form Text</h4>
<p>
Select this option to directly enter Transact-SQL queries or to execute external stored procedures. When you select this option from the Query screen, the following screen appears.</p>
<p>
<img src="images/wp_qry_b.gif" border=0></p>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To enter a Transact-SQL query</h5>
<ol>
<li>
From the Query screen, select the Enter A Query As Free-Form Text option and select a database.</li>
<li>
In the Type Your Query text box, type your query.</li>
<li>
To continue, choose the Next button. To exit, choose the Cancel button.</li>
</ol>
<p>
You can use the free-form text option with the EXECUTE command to execute existing stored procedures or extended stored procedures.</p>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To execute an extended stored procedure</h5>
<ol>
<li>
From the Query screen, select the Enter A Query As Free-Form Text option and select a database.</li>
<li>
Use the EXECUTE command with the extended stored procedure call and applicable arguments.</li>
<li>
To continue, choose the Next button. To exit, choose the Cancel button.</li>
</ol>
<p>
For example, to execute a directory command in the command shell, use the <b>xp_cmdshell</b> stored procedure within the following syntax:</p>
<pre>EXEC xp_cmdshell dir
<b><i>  </i></b></pre>
<h4>Using a Query in a Stored Procedure</h4>
<p>
Select this option to execute Transact-SQL stored procedures. When you select this option from the Query screen, the following screen appears.</p>
<p>
<img src="images/wp_qry_c.gif" border=0></p>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To use a query in a stored procedure</h5>
<ol>
<li>
From the Query screen, select the Use A Query In A Stored Procedure option and select a database.</li>
<li>
Select a stored procedure. <p>
The procedure text is displayed and cannot be edited.
</li>
<li>
In the Does Your Stored Procedure Require Any Arguments text box, type applicable arguments for the stored procedure.</li>
<li>
To continue, choose the Next button. To exit, choose the Cancel button.</li>
</ol>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
