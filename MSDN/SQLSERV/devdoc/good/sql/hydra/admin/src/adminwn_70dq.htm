<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>text and image Replication</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_text_and_image_datatype_replication"></a><i>text</i> and <i>image</i> Replication</h2>
<p>
The process of replicating <i>text</i> and <i>image</i> datatypes is subject to the following considerations:
<ul>
<li>
INSERT, UPDATE, and DELETE statements are supported.</li>
<li>
Logged text operations can be replicated by using WRITETEXT and UPDATETEXT with the WITH LOG option on tables that are published for replication. A <i>text</i> or <i>image</i> column that is published for replication using WRITETEXT and UPDATETEXT operations with the WITH NO_LOG option are not supported, because the replication process monitors the transaction log. </li>
<li>
UPDATETEXT operations can be performed for Microsoft SQL Server 6.0 and later subscribers (not for other SQL Server subscribers). Also, the UPDATETEXT option will fail at the publisher if an ODBC subscriber has a subscription on the <i>text</i> or <i>image</i> column.</li>
<li>
WRITETEXT operations are replicated as UPDATE statements, enabling replication of WRITETEXT to ODBC subscribers as well as to SQL Server. (UPDATETEXT operations are replicated as UPDATETEXT.)</li>
<li>
Custom procedures are not used if multiple <i>text </i>columns are being modified, because the other <i>text </i>column values are not logged. A standard UPDATE statement is generated instead.</li>
<li>
A configurable parameter, <b>max text repl size</b>, controls the maximum size (in bytes) of text and image data that can be replicated. This permits support of ODBC drivers and other SQL Server databases that cannot handle large text and image values, and distributors that have system resource (virtual memory) constraints. When a <i>text</i> or <i>image</i> column is published and an INSERT, UPDATE, WRITETEXT, or UPDATETEXT operation is run that exceeds the configured limit, the operation fails.<p>
The <b>max text repl size</b> parameter is set by using the <b>sp_configure</b> system stored procedure or the SQL Enterprise Manager Server Configuration dialog box.
<p>
For more information on setting <b>max text repl size</b>, see <a href="../../tsql/src/addsproc_0put.htm"><b>sp_configure</b></a>. 
</li>
<li>
Because SQL Server is log-based, for <i>text</i> and <i>image</i> columns to be replicated, the text pointer must be retrieved within the same transaction as the UPDATETEXT or WRITETEXT operation. <p>
Also, once the text pointer has been obtained, you should not perform any operations that can alter the location of the text pointed to by the text pointer (such as updating the primary key), before exectuing the UPDATETEXT or WRITETEXT statement. 
<p>
This is the recommended way of using UPDATETEXT and WRITETEXT operations with data to be replicated:
<ol>
<li>
Begin the transaction.</li>
<li>
Obtain the text pointer.</li>
<li>
Use the text pointer in the UPDATETEXT or WRITETEXT operation.</li>
<li>
Commit the transaction.</li>
</ol>
</li>
<li>
To replicate a <i>text</i> or <i>image</i> column, publish the table using SQL Enterprise Manager and include the <i>text</i> or <i>image</i> column in the published article. For more information about publishing tables and columns, see the <i>Microsoft SQL Server Administrator's Companion</i>.</li>
</ul>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
