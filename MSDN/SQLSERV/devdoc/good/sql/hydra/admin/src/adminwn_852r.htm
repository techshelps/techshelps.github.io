<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Troubleshooting the Fallback Process</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_troubleshooting_the_fallback_process"></a>Troubleshooting the Fallback Process</h2>
<p>
To detect integrity problems, <b>sp_fallback_help</b> can be executed on the fallback server (either directly or via an RPC) at any time. Integrity problems that are detected are:
<ul>
<li>
Internal to the <i>sysdatabases</i>, <i>sysdevices</i>, and <i>sysusages</i> tables.</li>
<li>
Internal to <b>spt_fallback_db</b>, <b>spt_fallback_dev</b>, and <b>spt_fallback_usg</b> tables.</li>
<li>
Between the two sets of tables. Simple referential integrity is checked, as is "activation integrity." Activation integrity means system and fallback tables agree on the status of a database's fallback status.</li>
<li>
Whenever NULL, the following columns indicate a database, a device, or usage is enrolled but not active:<pre>spt_fallback_db.xfallback_dbid
spt_fallback_dev.xfallback_low
spt_fallback_usg.xfallback_vstart</pre>
</li>
</ul>
<pre></pre>
<p class=indent1>
Some integrity problems can be solved by setting these columns to NULL. Some integrity problems could be fixed by updating a NULL <i>spt_fallback_db.xfallback_dbid </i>to the corresponding <i>sysdatabases.dbid</i>.</p>
<ul>
<li>
During active fallback support, no commands should be issued that could affect the physical devices or space allocations on them. Commands like ALTER DATABASE or DISK RESIZE could permanently eliminate the option of the original primary server resuming control of its enrolled databases and devices. If ALTER DATABASE is mistakenly issued, use <b>sp_fallback_permanent_svr</b> and <b>sp_dbremove </b>(the latter on the primary server only).</li>
<li>
The SA is responsible for passing the proper parameter values when executing <b>sp_fallback_upd_dev_drive</b>. If a bad value is used but realized before activation, then another execution can solve the problem. If activation with a bad value is attempted before the problem is recognized, then <b>sp_fallback_deactivate_svr_db </b>should be enough to allow another execution of <b>sp_fallback_upd_dev_drive</b>.</li>
<li>
On the primary server, the DBO for a given database can be logged on to a login other than SA. But when fallback is activated, each database is installed with the DBO recorded as the SA. You can, however, execute the necessary procedures to change the DBO of a database that is being actively supported on the fallback server.</li>
<li>
Like all <i>spt_ </i>tables, the<i> spt_fallback_ </i>tables should not be updated directly unless you are instructed to do so by technical support personnel.</li>
</ul>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
