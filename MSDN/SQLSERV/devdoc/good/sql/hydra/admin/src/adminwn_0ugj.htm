<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Upgrading a Microsoft SQL Server for SMS Databases</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_upgrading_a_microsoft_sql_server_for_sms_databases"></a>Upgrading a Microsoft SQL Server for SMS Databases</h2>
<p>
SMS uses SQL Server to store its system information and computer inventory data. When you upgrade SQL Server for SMS 1.0 or 1.1 databases, additional steps are required to re-create some of the stored procedures used by SMS. If these stored procedures are not created, then the SMS Scheduler cannot activate jobs that use the Include Substitutes option. This means that jobs will remain in a pending state and will not be activated.</p>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To re-create the stored procedures for an SMS database</h5>
<ol>
<li>
From the directory of the SMS site server on the drive that SMS was installed on, run the SQL script <b>sp_site.sql</b> against the SQL Server containing the SMS database. The <b>sp_site.sql</b> script is located in <b>C:\<i>SMSDIRECTORY</i>\SITE.SRV\<i>PLATFORM</i>.BIN</b>. </li>
</ol>
<p>
You can use ISQL/w in the SQL Server program group to execute the script file.</p>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To use ISQL/w to execute the script file</h5>
<ol>
<li>
From the SQL Server 6.5 program group, click the ISQL/w icon.<p>
The Microsoft ISQL/w window opens and displays the Connect Server dialog box.
</li>
<li>
Connect to the SQL Server that contains the SMS database.</li>
<li>
In the DB box, enter the SMS database.</li>
<li>
To open the <b>sp_site.sql </b>script located on the site server, click the Load SQL Script button and select the script.</li>
<li>
From the Query menu, choose Execute to run the script. The script returns the following text if it is sucessful:<pre>This command did not return data, and it did not return any rows.
<b><i>  </i></b></pre>
<p>
If the Results tab displays 'Invalid Object Name' errors, verify that you did not execute the script in the wrong database.
<p>
Note that you do not need to manually run the <b>sp_site.sql </b>script for SMS version 1.2 databases. For more information, see the Microsoft Systems Management Server documentation.
</li>
</ol>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
