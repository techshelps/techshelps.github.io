<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQL Mail</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sql_mail"></a>SQL Mail</h1>
<p>
SQL Server 6.5 provides the following enhancements to SQL Mail:
<ul>
<li>
You can start and stop SQL Mail, and you can assign a mail login name and a password to SQL Mail from SQL Enterprise Manager.</li>
</ul>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To start and stop SQL Mail from SQL Enterprise Manager</h5>
<p>
<img src="images/mailico.gif" border=0>
<ol>
<li>
In the Server Manager window, expand the tree for the server, and click the right mouse button on that server's SQL Mail icon.</li>
<li>
From the shortcut menu, choose Start or Stop.</li>
</ol>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To assign a mail login name and a password to SQL Mail from SQL Enterprise Manager</h5>
<ol>
<li>
In the Server Manager window, click the right mouse button on the SQL Mail icon.</li>
<li>
From the shortcut menu, choose Configure.<p>
The SQL Mail Configuration dialog box appears.
</li>
<li>
Complete the dialog box.<p>
On servers where Microsoft Exchange has been installed, this dialog box will ask for a profile name.
<p>
For more information about setting up a SQL Mail Client, see the <i>Microsoft SQL Server Administrator's Companion</i>.
</li>
</ol>
<ul>
<li>
Enhancement to <b>xp_sendmail</b> makes it easier to use within triggers. For more information, see <a href="../../tsql/src/addnfeat_60fg.htm">What's New for Transact-SQL</a>, later in this document.</li>
<li>
Enhancement to <b>xp_readmail</b> now supports an additional output parameter that returns the mail message originator's mail address.</li>
<li>
SQL Mail is compatible with Microsoft® Exchange. </li>
</ul>
<h5><img src="../../../../../images/wedge.gif" border=0>&nbsp;&nbsp;&nbsp;&nbsp;To set up SQL Mail to work with Microsoft Exchange</h5>
<ol>
<li>
At the Microsoft Exchange server, set up a mailbox for the user account that will be used by the MSSQLServer service. This account must be a domain account that adheres to the requirements listed under <a href="../../setup/src/setup_4ewk.htm">Platform Support</a> in "What's New for Setup," earlier in this document. For example, </li>
</ol>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=24%>Account:</td>
<td width=76%>DOMAIN1\SQLServerAccount</td>
</tr>
<tr valign=top>
<td width=24%>Mailbox:</td>
<td width=76%>SQL1</td>
</tr>
</table><br>
<ol start=2>
<li>
At the SQL Server machine, log on to Windows NT using the same user account that will be used by the MSSQLServer service ("DOMAIN1\SQLServerAccount" in the example above).</li>
<li>
Install the Microsoft Exchange Client on the SQL Server machine.</li>
<li>
Start the Microsoft Exchange Client and use the Exchange Setup Wizard to configure the client to connect to Microsoft Exchange Server. After <b>setup</b> is complete, verify that you can send and receive mail interactively.<p>
<b>Note</b>  You cannot use the Microsoft Exchange Client to connect SQL Server to Microsoft Mail post offices.
</li>
<li>
Start the Microsoft Exchange Services application (also called the Mail and Fax application in Control Panel). Choose the Show Profiles button to find the name of the profile that the Exchange Setup Wizard has created (for example, SQL Server).<p>
<b>Note</b>  Before you configure Microsoft Exchange Server, read the <a href="adminwn_6cj7.htm">SQL Mail and Microsoft Exchange Server Configuration Requirements</a> section.
</li>
<li>
From Control Panel, open the Services application and configure the MSSQLServer service to run under the same Windows NT user account that Microsoft Exchange is set to use. Start or restart the MSSQLServer service.</li>
<li>
In SQL Enterprise Manager, select a server and from the Server menu, choose SQL Mail/Configure or right-click the SQL Mail icon below the selected server and choose Configure. Type the profile name you found in step 5. You do not need to provide a password for Microsoft Exchange; it uses the account and password configured for the MSSQLServer service.</li>
<li>
In SQL Enterprise Manager, from the Server menu, choose SQL Mail/Start or right-click the SQL Mail icon and choose Start. The SQL Mail icon will become green if SQL Mail has started successfully.<p>
For more information on setting up Microsoft Exchange, see the <i>Microsoft Exchange Server Installation Guide</i>.
</li>
</ol>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
