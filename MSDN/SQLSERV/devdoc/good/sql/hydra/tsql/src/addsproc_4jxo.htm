<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>xp_cmdshell</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_xp_cmdshell"></a>xp_cmdshell (version 6.5)</h2>
<p>
Grants non-administrative users permission to execute <b>xp_cmdshell</b>. </p>
<p>
For complete syntax information for <a href="../../../tsqlref/src/tsql14_6d0l.htm"><b>xp_cmdshell</b></a>, see the <i>Microsoft SQL Server Transact-SQL Reference</i>.</p>
<p>
For more information about enabling more flexible security management, see <a href="../../admin/src/adminwn_91wz.htm">What's New for Administrators</a> earlier in this document.</p>
<h4>Remarks</h4>
<p>
Generally, <b>xp_cmdshell</b> executes Windows NT commands in SQL Server's security context, which by default is a user account with local administrator authority. When a non-system administrator executes <b>xp_cmdshell</b> with the new configuration option set, the requested command runs in the SQLExecutiveCmdExec user account, which is the same account used by SQL Executive for scheduled tasks entered by non-system administrators.</p>
<p>
When you grant execute permission for <b>xp_cmdshell </b>to users, the users can execute any operating-system command at the Windows NT command shell that the account running SQL Server (usually a local system account) has privilege to execute.</p>
<p>
To restrict <b>xp_cmdshell</b> access to users who have administrator permission on the Windows NT-based computer where SQL Server is running, configure your SQL Server at the Server Options tab: Select the "xp_cmdshell - Use SQLExecutiveCmdExecAccount for Non-SAs" option. </p>
<p>
<b>Note</b>  If you select the "xp_cmdshell - Use SQLExecutiveCmdExec Account for NonSAs" option and the client logs on to SQL Server as the system administrator, the command is executed under SQL Server's security context instead of the SQLExecutiveCmdExec security context.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
