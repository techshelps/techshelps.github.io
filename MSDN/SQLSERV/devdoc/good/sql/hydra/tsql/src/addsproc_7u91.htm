<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>xp_snmp_getstate</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_xp_snmp_getstate"></a>xp_snmp_getstate (version 6.5)</h2>
<p>
Returns the state of the SQL Server Simple Network Management Protocol (SNMP) agent. The state of the SNMP agent indicates whether the agent is available to have the Microsoft SQL Server server queried by an SNMP client.</p>
<p>
For more information about Simple Network Management Protocol (SNMP), consult your Microsoft Windows NT operating-system documentation.</p>
<h4>Syntax</h4>
<p>
<b>xp_snmp_getstate </b>[<i>return_status </i>OUTPUT]</p>
<p>
where
<dl>
<dt>
<i>return_status </i>OUTPUT</dt>
<dd>
Specifies the status returned from the SNMP agent. The return status must have an <i>int </i>datatype. Executing the procedure with no parameters returns a results set that indicates the status and the definition of the SNMP agent's state.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The SQL Server SNMP agent interacts between SQL Server and SNMP clients that are running an operating system, including Windows NT, UNIX®, or another mainframe computer operating system. Stored procedures that depend upon the SNMP agent can query the SNMP agent to make sure it is available and in a normal state before proceeding.</p>
<p>
For more information about SNMP agents, see, <a href="../../admin/src/adminwn_91wz.htm">What's New for Administrators</a> earlier in this document.</p>
<p>
If <b>xp_snmp_getstate</b> is executed with no parameters (for example, EXECUTE <b>xp_snmp_getstate</b>), a status and its meaning are returned. Status indicates the status code integer and meaning explains the status code. For a complete list of all statuses, see <a href="addsproc_9dm8.htm"><b>xp_snmp_raisetrap</b></a> later in this document.</p>
<h4>Examples</h4>
<h5>A.&nbsp;&nbsp;&nbsp;&nbsp;Return SNMP Agent Status</h5>
<p>
This example returns the state of the SNMP agent.</p>
<pre>DECLARE @retval INT
EXECUTE xp_snmp_getstate @retval OUTPUT
SELECT 'status'=@retval
<b><i>  </i></b></pre>
<h5>B.&nbsp;&nbsp;&nbsp;&nbsp;Return SNMP Agent Status and Meaning</h5>
<p>
This example returns status and status meaning for the current SNMP agent.</p>
<pre>EXECUTE xp_snmp_getstate
<b><i>  </i></b>
Status            Meaning
--------------     --------------------------------
3                The network has not been started.
<b><i>  </i></b></pre>
<h4>Permission</h4>
<p>
The system administrator and users granted execute permission by the system administrator can execute this procedure.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
