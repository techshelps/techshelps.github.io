<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLMAINT.EXE Command-prompt Utility</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sqlmaint..exe_command_line_utility"></a>SQLMAINT.EXE Command-prompt Utility (version 6.5)</h2>
<p>
The SQLMAINT.EXE command-prompt utility performs routine database maintenance. Use SQLMAINT.EXE to run DBCC checks, to dump a database and its transaction log, to update statistics, and to rebuild indexes. All database maintenance activities generate a report that can be sent to a designated e-mail account.  </p>
<h4>Syntax</h4>
<p>
SQLMAINT <br>
 [<b>-?</b>] | [<b>-S</b> <i>server_name</i>]<br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>-U</b> <i>login_ID</i> [<b>-P</b> <i>password</i>]]<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>-D</b> <i>database_name</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>-Rpt</b> <i>output_file</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>-To</b> <i>operator_name</i>]<br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>-CkDB</b> | <b>-CkDBNoIdx</b>]<br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>-CkAl</b> | <b>-CkAlNoIdx</b>]<br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>-CkTxtAl</b>]<br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>-CkCat</b>]<br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>-UpdSts</b>]<br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>-RebldIdx</b> <i>free_space</i>]<br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>-BkUpDB </b><i>backup_path</i> | <b>-BkUpLog</b> <i>backup_path</i>]<br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>-BkUpOnlyIfClean</b>]<br>
&nbsp;&nbsp;&nbsp;&nbsp;[<b>-BkUpMedia</b> {DISK [<b>-DelBkUps</b> <i>number_of_weeks</i>] | TAPE}]</p>
<p>
where 
<dl>
<dt>
<b>-?</b></dt>
<dd>
Specifies that the syntax diagram for SQLMAINT.EXE utility be returned. This parameter must be used alone.</dd>
<dt>
<b>-D</b> <i>database_name</i> </dt>
<dd>
Specifies the target database name. This parameter is required if the <b>-? </b>parameter is not used.</dd>
<dt>
<b>-Rpt</b> <i>report_file</i></dt>
<dd>
Specifies the full path and name of the file into which the report is to be generated. The report is also generated on the screen. This parameter is required if the <b>-?</b> parameter is not used. The report maintains version information by adding a date to the filename. The date is generated as follows: at the end of the filename but before the period, in the form _YYYYMMDD.
<p>
If you run the utility on Dec. 1, 1996 and this is the <i>report_file</i> value: 

<pre>c:\mssql\backups\pubs_maint.rpt
<b><i>  </i></b></pre>

<p>
Then it becomes: 

<pre>c:\mssql\backups\pubs_maint_19961201.rpt
</pre>

<p>
The full UNC filename is required for the <b>-Rpt</b> file when SQLMAINT.EXE accesses a remote server. 
</dd>
<dt>
<b>-S</b> <i>server</i></dt>
<dd>
Specifies the target server. If this parameter is not supplied, SQL Server is assumed to be on the local machine. The SQL Server must be version 6.0 or later, though it is recommended that you run the utility on version 6.5. This parameter is optional.</dd>
<dt>
<b>-U</b> <i>login_ID</i></dt>
<dd>
Specifies the login ID to use when connecting to the server. If this parameter is not supplied SQLMAINT.EXE will attempt to log in by using a trusted connection. This parameter is optional.</dd>
<dt>
<b>-P</b> <i>password</i></dt>
<dd>
Specifies the password for the login ID. Only valid if the <b>-U</b> parameter is also supplied. This parameter is optional.</dd>
<dt>
<b>-To </b><i>operator_name</i></dt>
<dd>
Specifies the operator to whom the generated report will be sent through SQL Mail. The operator can be defined by using SQL Enterprise Manager. This parameter is optional.</dd>
<dt>
<b>-CkDB</b> | <b>-CkDBNoIdx</b></dt>
<dd>
Specifies page checking against extent structures. The <b>CkDB</b> checks data and index pages against allocation units. <b>CkDBNoIdx</b> will check only the data pages against the extent structures. 
<p>
Data storage is held in pages, 256 of which are grouped into one extent structure. At the beginning of each allocation unit, a page is dedicated to keeping track of the pages within the extent. Also, the pages are linked by pointers stored on the pages. This check tests to see that the pages linked by pointers match the pages listed on the first page in the extent structure. 

<p>
A warning is written to an output file if the database is in use when SQLMAINT.EXE runs. This parameter is optional.

<p>
These parameters are equivalent to DBCC NEWALLOC and DBCC NEWALLOC with the NOINDEX option. For more information, see the <a href="../../../tsqlref/src/tsql06_0yus.htm">DBCC statement</a>.
</dd>
<dt>
<b>-CkAI | -CkAlNoIdx</b></dt>
<dd>
Is to check the allocation of <i>text</i> and <i>image</i> columns in the database and generates a report of allocation errors. This parameter is optional.</dd>
<dt>
<b>-CkCat</b></dt>
<dd>
Is to check for consistency of the system tables and generates a report of all consistency errors. This parameter is optional.</dd>
<dt>
<b>-UpdSts</b></dt>
<dd>
Is to update statistics about the distribution of key values in specified indexes for all tables in the target database. This parameter is optional.</dd>
<dt>
<b>-Rebldldx</b> <i>free_space</i></dt>
<dd>
Specifies that indexes on tables in the target database should be rebuilt by using the Free Space percent value as the inverse of the fillfactor. For example, if Free Space percentage is 30 then the fillfactor used is 70. If the Free Space percentage value of 100 is specified, then the indexes are rebuilt with the original fillfactor value. 
<p>
This parameter is optional and is available only with SQL Server version 6.5.
</dd>
<dt>
<b>-BkUpDB</b> <i>backup_path</i> |<b> -BkUpLog </b><i>backup_path</i></dt>
<dd>
Specifies a backup action. <b>BkUpDb</b> backs up the entire database. <b>BkUpLog</b> backs up only the transaction log.
<p>
The <i>backup_path</i> specifies the directory for the backup. The backup can be placed in a directory or a tape device address (For example, \\.\TAPE0). The filename for a database backup is automatically generated as follows:

<pre>dbname_db_dump.yyyymmdd
<b><i>  </i></b></pre>

<p>
The filename for a transaction backup is automatically generated as follows:

<pre>dbname_log_dump.yyyymmdd
<b><i>  </i></b></pre>

<p>
If you use the <b>-BkUpDB</b> parameter you must also specify the media using the <b>-BkUpMedia</b> parameter.
</dd>
<dt>
<b>-BkUpMedia</b> {TAPE | DISK [<b>DelBkUps</b> <i>num_weeks</i>]}</dt>
<dd>
Specifies the media type of the backup as either TAPE or DISK.</dd>
<dt>
<b>-DelBkUps</b> <i>number_of_weeks</i></dt>
<dd>
Specifies the number of weeks to retain disk backup files. Backup files older than the specified number of weeks are deleted. This parameter can be used only if <b>-BkUpType</b> DISK is also specified.</dd>
<dt>
<b>-BkUpOnlyIfClean</b></dt>
<dd>
Specifies that the backup occurs only if any specified <b>-CK</b> checks did not find problems with the data. Maintenance actions run in the same sequence as they appear on the command line. Specify the parameters <b>-CkDB</b>, -<b>CkDBNoIdx</b>, <b>-CkAL</b>, <b>-CkAlNoIDX</b>, <b>-CkTxtAL</b>,  or <b>-CkCat</b> before the <b>-BkUpDB/-BkUpLog</b> parameter(s) if you are also going to specify <b>-BkUpOnlyIfClean</b>, or the backup will occur whether or not the check reports problems.
</dd>
</dl>
<h4>Remarks</h4>
<p>
SQLMAINT.EXE is a SQL-DMO application, which makes it necessary to register SQL-DMO on the machine where you intend to run SQLMAINT.EXE. If SQL Server or SQL Enterprise Manager are installed on the machine, SQL-DMO is already registered.  </p>
<p>
Type the following to register SQL-DMO at the command line: </p>
<pre>regsvr32 c:\mssql\binn\sqlole65
<b><i>  </i></b></pre>
<p>
SQLMAINT.EXE returns 0 if it runs successfully or 1 if it fails. Failure is reported:  
<ul>
<li>
If any of the maintenance actions fail. </li>
<li>
If <b>-CkDB</b>, <b>-CkDBNoIdx</b>, <b>-CkAL</b>, <b>-CkALNoIdx</b>, <b>-CkTxtAL</b>, or <b>-CkCat</b> checks find problems with the data. </li>
<li>
If a general failure is encountered. </li>
</ul>
<p>
For example, SQLMAINT.EXE returns 1 if SQL-DMO has not been registered. </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
