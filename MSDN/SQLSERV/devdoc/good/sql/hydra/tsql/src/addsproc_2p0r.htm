<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_makewebtask</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_makewebtask"></a>sp_makewebtask (version 6.5)</h2>
<p>
Creates a task that produces an HTML document. This HTML document contains data returned by executed queries.</p>
<h4>Syntax</h4>
<p>
<b>sp_makewebtask </b>{<b>@</b>outputfile <b>=</b> <b>'</b><i>outputfile</i><b>'</b>, <b>@</b>query <b>=</b> <b>'</b><i>query</i><b>'</b>}<br>
[<b>,</b> [<b>@</b>fixedfont <b>=</b> <i>fixedfont</i><b>,</b>] [<b>@</b>bold <b>=</b> <i>bold</i><b>,</b>] [<b>@</b>italic <b>=</b> <i>italic</i><b>,</b>]<br>
[<b>@</b>colheaders <b>=</b> <i>colheaders</i><b>,</b>] [<b>@</b>lastupdated <b>=</b> <i>lastupdated</i><b>,</b>]<br>
[<b>@</b>HTMLHeader <b>=</b> <i>HTMLHeader</i><b>,</b>] [<b>@</b>username <b>=</b> <i>username</i><b>,</b>]<br>
[<b>@</b>dbname <b>=</b> <i>dbname</i><b>,</b>] [<b>@</b>templatefile <b>=</b> <b>'</b><i>templatefile</i><b>',</b>]<br>
[<b>@</b>webpagetitle <b>=</b> <b>'</b><i>webpagetitle</i><b>',</b>] [<b>@</b>resultstitle <b>=</b> <b>'</b><i>resultstitle</i><b>',</b>]<br>
[[<b>@</b>URL <b>=</b> <b>'</b><i>URL</i><b>',</b> <b>@</b>reftext <b>=</b> <b>'</b><i>reftext</i><b>'</b>] | <br>
[<b>@</b>table_urls <b>=</b> <i>table_urls</i><b>,</b> <b>@</b>url_query <b>=</b> <b>'</b><i>url_query</i><b>',</b>]]<br>
[<b>@</b>whentype <b>=</b> <i>whentype</i><b>,</b>] [<b>@</b>targetdate <b>=</b> <i>targetdate</i><b>,</b>] [<b>@</b>targettime <b>=</b> <i>targettime</i><b>,</b>]<br>
[<b>@</b>dayflags <b>=</b> <i>dayflags</i><b>,</b>] [<b>@</b>numunits <b>=</b> <i>numunits</i><b>,</b>] [<b>@</b>unittype <b>=</b> <i>unittype</i><b>,</b>]<br>
[<b>@</b>procname <b>=</b> <i>procname</i><b>,</b> ] [<b>@</b>maketask <b>=</b> <i>maketask</i><b>,</b>] [<b>@</b>rowcnt <b>=</b> <i>rowcnt</i><b>,</b>]<br>
[<b>@</b>tabborder <b>=</b> <i>tabborder</i><b>,</b>] [<b>@</b>singlerow <b>=</b> <i>singlerow</i><b>,</b>] [<b>@</b>blobfmt <b>=</b> <i>blobfmt</i>]]
<dl>
<dt>
<b>@</b>outputfile</dt>
<dd>
Specifies the location of the generated HTML file on the computer that is running SQL Server and can be a UNC name if the file is to be created on a remote computer. This parameter is required and must be unique for each task created with <b>sp_makewebtask</b>. The <i>outputfile</i> variable is of <i>varchar</i> datatype and has a maximum of 255 characters.</dd>
<dt>
<b>@</b>query</dt>
<dd>
Specifies the query to be run. This parameter is required. Query results are displayed in the HTML document in a table format when the task is run with <b>sp_runwebtask</b>. Multiple SELECT queries can be specified and will result in multiple tables being displayed in the <b>@</b>outputfile. The <b>@</b>query parameter is of <i>text</i> datatype.</dd>
<dt>
<b>@</b>fixedfont</dt>
<dd>
Specifies that the query results be displayed in a fixed font (1) or a proportional font (0). Fixed font (1) is the default. The <i>fixedfont</i> variable is of <i>tinyint</i> datatype.</dd>
<dt>
<b>@</b>bold</dt>
<dd>
Specifies that the query results be displayed in a bold font (1) or non-bold font (0). Non-bold (0) is the default. The <i>bold</i> variable is of <i>tinyint</i> datatype.</dd>
<dt>
<b>@</b>italic</dt>
<dd>
Specifies that the query results be displayed in an italic font (1) or non-italic font (0). Non-italic (0) is the default. The <i>italic</i> variable is of <i>tinyint</i> datatype.</dd>
<dt>
<b>@</b>colheaders</dt>
<dd>
Specifies that the query results be displayed with column headers (1) or no column headers (0). Column headers (1) is the default. The <i>colheaders</i> variable is of <i>tinyint</i> datatype.</dd>
<dt>
<b>@</b>lastupdated</dt>
<dd>
Specifies whether the generated HTML document displays a Last Updated: timestamp indicating the last updated date and time (1) or no timestamp (0). Timestamp (1) is the default. The timestamp appears one line before the query results in the HTML document. The <i>lastupdated</i> variable is of <i>tinyint</i> datatype.</dd>
<dt>
<b>@</b>HTMLHeader</dt>
<dd>
Specifies the HTML formatting code for displaying the text contained in the <b>@</b>resultstitle variable. The <i>HTMLHeader</i> variable is of <i>tinyint</i> datatype. These are the values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=21%></th>
<th align=left width=79%></th>
</tr>
<tr valign=top>
<th align=left width=21%></th>
<th align=left width=79%></th>
</tr>
<tr valign=top>
<th align=left width=21%>Value</th>
<th align=left width=79%>HTML formatting code</th>
</tr>
<tr valign=top>
<td width=21%>1</td>
<td width=79%>H1</td>
</tr>
<tr valign=top>
<td width=21%>2</td>
<td width=79%>H2</td>
</tr>
<tr valign=top>
<td width=21%>3</td>
<td width=79%>H3</td>
</tr>
<tr valign=top>
<td width=21%>4</td>
<td width=79%>H4</td>
</tr>
<tr valign=top>
<td width=21%>5</td>
<td width=79%>H5</td>
</tr>
<tr valign=top>
<td width=21%>6</td>
<td width=79%>H6</td>
</tr>
</table><br>

</dd>
<dt>
<b>@</b>username</dt>
<dd>
Specifies the username for executing the query. The default is the current user. The <i>username</i> variable is of <i>varchar</i> datatype and has a maximum of 30 characters. The sa or dbo can specify another <b>@</b>username.</dd>
<dt>
<b>@</b>dbname</dt>
<dd>
Specifies the database name to run the query on. If a database name is not given, <b>@</b>dbname defaults to the current database. The <i>dbname</i> variable is of <i>varchar</i> datatype and has a maximum of 30 characters.</dd>
<dt>
<b>@</b>templatefile</dt>
<dd>
Specifies the path of the template file used to generate the HTML document. The template file contains information about formatting characteristics for HTML documents and contains the tag <b>&lt;%</b>insert_data_here<b>%&gt;</b>, which indicates the position to add the query results in an HTML table. There are no spaces between the less than sign (<b>&lt;</b>) and the "<b>%</b>i" of "<b>%</b>insert" and between the "e<b>%</b>" of "here<b>%</b>" and the greater than sign (<b>&gt;</b>). The <i>templatefile</i> variable is of <i>varchar</i> datatype and has a maximum of 255 characters.
<p>
There are two ways to specify the location of the results of a query in a template file:

<ol>
<li>
Include the tag <b>&lt;%</b>insert_data_here<b>%&gt;</b>, which indicates the position to add the query results in an HTML table. There are no spaces between the less than sign (<b>&lt;</b>) and the "<b>%</b>i" of "<b>%</b>insert" and between the "e<b>%</b>" of "here<b>%</b>" and the greater than sign (&gt;).</li>
<li>
Specify a complete row format between the keywords <b>&lt;%</b>begindetail<b>%&gt; </b>and <b>&lt;%</b>enddetail<b>%&gt;</b> including &lt;TR&gt;, &lt;/TR&gt;, &lt;TD&gt;, and &lt;/TD&gt; HTML tags. For each column to display in the results set, include the tag <b>&lt;%</b>insert_data_here<b>%&gt;</b> inside the row format keywords. Specifying the complete row format produces a more precise layout of the results set. When used with this complete row format, <b>@</b>colheaders is ignored.</li>
</ol>

<p>
If <b>@</b>templatefile is specified, the following parameters are ignored when the HTML file is generated:

<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%><b>@</b>bold</td>
<td width=52%><b>@</b>singlerow</td>
</tr>
<tr valign=top>
<td width=48%><b>@</b>fixedfont</td>
<td width=52%><b>@</b>tabborder</td>
</tr>
<tr valign=top>
<td width=48%><b>@</b>HTMLHeader</td>
<td width=52%><b>@</b>table_urls</td>
</tr>
<tr valign=top>
<td width=48%><b>@</b>italic</td>
<td width=52%><b>@</b>URL</td>
</tr>
<tr valign=top>
<td width=48%><b>@</b>lastupdated</td>
<td width=52%><b>@</b>url_query</td>
</tr>
<tr valign=top>
<td width=48%><b>@</b>reftext</td>
<td width=52%><b>@</b>webpagetitle</td>
</tr>
<tr valign=top>
<td width=48%><b>@</b>resultstitle</td>
<td width=52%></td>
</tr>
</table><br>


</dd>
<dt>
<b>@</b>webpagetitle</dt>
<dd>
Specifies the title of the HTML document. The default is SQL Server Web Assistant. The <i>webpagetitle</i> variable is of <i>varchar</i> datatype and has a maximum of 255 characters.</dd>
<dt>
<b>@</b>resultstitle</dt>
<dd>
Specifies the title displayed above the query results in the HTML document. The default title is Query Results. The <i>resultstitle</i> variable is of <i>varchar</i> datatype and has a maximum of 255 characters.</dd>
<dt>
<b>@</b>URL</dt>
<dd>
Specifies a hyperlink to another HTML document. The hyperlink is placed after the query results and at the end of the HTML document. If this parameter is specified, <b>@</b>reftext must also be specified, and <b>@</b>table_urls and <b>@</b>url_query cannot be specified. The <i>URL</i> variable is of <i>varchar</i> datatype and has a maximum of 255 characters.

<p>
<b>Important</b>  If <b>@</b>table_urls = 1, then <b>@</b>url_query must be included to specify the query to be executed for retrieving hyperlink information, and <b>@</b>URL and <b>@</b>reftext cannot be specified. Information is specified either in <b>@</b>URL and <b>@</b>reftext, or in <b>@</b>url_query and <b>@</b>table_urls.

</dd>
<dt>
<b>@</b>reftext</dt>
<dd>
Specifies the hyperlink that describes to what HTML document the hyperlink should take the user. The hyperlink text describes the destination and the hyperlink address comes from the URL in the <b>@</b>URL parameter. The <i>reftext</i> variable is of <i>varchar</i> datatype and has a maximum of 255 characters.</dd>
<dt>
<b>@</b>table_urls</dt>
<dd>
Specifies whether hyperlinks will be included on the HTML document (1) and whether the hyperlinks will come from a SELECT statement executed on Microsoft SQL Server. A value of 0 (the default) indicates that there is no query that will generate hyperlinks for the HTML. <b>@</b>URL and <b>@</b>reftext may still be specified for a single hyperlink. A value of 1 indicates that a list of hyperlinks will be created by using <b>@</b>url_query. The <i>table_urls</i> variable is of <i>tinyint</i> datatype.

<p>
<b>Important</b>  If @table_urls = 1, then @url_query must be included to specify the query to be executed for retrieving hyperlink information, and @URL and @reftext cannot be specified. Information is specified either in @URL and @reftext, or in @url_query and @table_urls.

</dd>
<dt>
<b>@</b>url_query</dt>
<dd>
Specifies the SELECT statement to create the URL and its hyperlink text. URLs and hyperlink text come from a SQL Server table. With this parameter, it is possible to generate multiple URLs with associated hyperlinks. Use <b>@</b>url_query with <b>@</b>table_urls. The <i>url_query</i> variable is of <i>varchar</i> datatype with a maximum of 255 characters. The <i>url_query</i> variable must return a results set containing two columns: The first column is the address of a hyperlink and the second column describes the hyperlink. The number of hyperlinks inserted into the HTML document equals the number of rows returned by executing <b>@</b>url_query.</dd>
<dt>
<b>@</b>whentype</dt>
<dd>
Specifies when to run the task that creates the HTML document. The <i>whentype</i> variable is of <i>tinyint</i> datatype. These are the possible values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=12%></th>
<th align=left width=88%></th>
</tr>
<tr valign=top>
<th align=left width=12%></th>
<th align=left width=88%></th>
</tr>
<tr valign=top>
<th align=left width=12%>Value</th>
<th align=left width=88%>Description</th>
</tr>
<tr valign=top>
<td width=12%>1</td>
<td width=88%>Create page now. The web task will be created, executed immediately, and deleted immediately after execution. This is the default.</td>
</tr>
<tr valign=top>
<td width=12%>2</td>
<td width=88%>Create page later. The stored procedure for creating the HTML document will be created immediately, but execution of the web task is deferred until the date and time specified by <b>@</b>targetdate and <b>@</b>targettime (optional). If no <b>@</b>targettime is specified, the web task will be executed at 12:00 a.m. <b>@</b>targetdate is required when <b>@</b>whentype = 2. This web task will be deleted automatically after the targeted date and time has passed. </td>
</tr>
<tr valign=top>
<td width=12%>3</td>
<td width=88%>Create page every <i>n</i> day(s) of the week. The HTML document will be created on day(s) specified in <b>@</b>dayflags and at the time specified by <b>@</b>targettime (optional), beginning with the date in <b>@</b>targetdate. If no <b>@</b>targettime value is specified, the default is 12:00 a.m. The <b>@</b>targetdate parameter is required when <b>@</b>whentype = 3. The day(s) of the week are specified in the <b>@</b>dayflags parameter. More than one day of the week can be specified with the <b>@</b>dayflags parameter. Web tasks created with <b>@</b>whentype = 3 will not be deleted automatically and continue to run on the specified day(s) of the week until the user deletes them by using <b>sp_dropwebtask</b>.</td>
</tr>
<tr valign=top>
<td width=12%>4</td>
<td width=88%>Create page every <i>n</i> minutes, hours, days, or weeks. The HTML document is created every <i>n</i> time period beginning with the date and time specified in <b>@</b>targetdate and <b>@</b>targettime (optional). If no <b>@</b>targettime is specified, the Web task will be executed at 12:00 a.m. The <b>@</b>targetdate parameter is required in this case. The task will run automatically every <i>n</i> minutes, hours, days, or weeks as specified by the <b>@</b>numunits and <b>@</b>unittype parameters. The tasks will run until the user deletes them by using <b>sp_dropwebtask</b>.</td>
</tr>
<tr valign=top>
<td width=12%>5</td>
<td width=88%>Create page upon request. The procedure is created without automatic scheduling. The user creates a HTML document by running <b>sp_runwebtask</b> and deletes it only by using <b>sp_dropwebtask</b>.</td>
</tr>
<tr valign=top>
<td width=12%>6</td>
<td width=88%>Create page now and later. The HTML document is created immediately and re-created according to <b>@</b>whentype = 2.</td>
</tr>
<tr valign=top>
<td width=12%>7</td>
<td width=88%>Create page now and every <i>n </i>day(s) of the week. The HTML document is created immediately and re-created according to <b>@</b>whentype = 3, except no <b>@</b>targetdate is required.</td>
</tr>
<tr valign=top>
<td width=12%>8</td>
<td width=88%>Create page now and periodically thereafter. The HTML document is created immediately and re-created according to <b>@</b>whentype = 4, except no <b>@</b>targetdate is required.</td>
</tr>
<tr valign=top>
<td width=12%>9</td>
<td width=88%>Create page now and upon request. The HTML document is created immediately and re-created according to <b>@</b>whentype = 5. The task must be deleted manually.</td>
</tr>
</table><br>

</dd>
<dt>
<b>@</b>targetdate</dt>
<dd>
Specifies the date the page should be built. The format is YYYYMMDD. In <b>@</b>whentype &gt; 3 cases where <b>@</b>targetdate is important but not supplied, the current date is used. For <b>@</b>whentype = 2 (later), 3 (dayofweek), 4 (periodic), and 6 (now and later), the <b>@</b>targetdate parameter is required. The <i>targetdate</i> variable is of <i>int</i> datatype.</dd>
<dt>
<b>@</b>targettime</dt>
<dd>
Specifies the time the HTML document should be created. When a starting time is important but not supplied, 12:00 a.m. is the default. The format is HHMMSS. The <i>targettime</i> variable is of <i>int</i> datatype.</dd>
<dt>
<b>@</b>dayflags</dt>
<dd>
Specifies what days to update the HTML document. To specify certain days, add the values together. To specify Monday and Thursday, for example, use <b>@</b>dayflags = 18. The <i>dayflags</i> variable is of <i>tinyint</i> datatype. This parameter is required for <b>@</b>whentype = 3 (dayofweek), <b>@</b>whentype = 7 (now and dayofweek); and in cases in which <b>@</b>whentype = 4 (periodic) and <b>@</b>whentype = 8 (now and periodic) where the <b>@</b>unittype = 3 (weeks). These are the values and their descriptions.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=12%></th>
<th align=left width=88%></th>
</tr>
<tr valign=top>
<th align=left width=12%></th>
<th align=left width=88%></th>
</tr>
<tr valign=top>
<th align=left width=12%>Value</th>
<th align=left width=88%>Day of the week</th>
</tr>
<tr valign=top>
<td width=12%>1</td>
<td width=88%>Sunday</td>
</tr>
<tr valign=top>
<td width=12%>2</td>
<td width=88%>Monday</td>
</tr>
<tr valign=top>
<td width=12%>4</td>
<td width=88%>Tuesday</td>
</tr>
<tr valign=top>
<td width=12%>8</td>
<td width=88%>Wednesday</td>
</tr>
<tr valign=top>
<td width=12%>16</td>
<td width=88%>Thursday</td>
</tr>
<tr valign=top>
<td width=12%>32</td>
<td width=88%>Friday</td>
</tr>
<tr valign=top>
<td width=12%>64</td>
<td width=88%>Saturday</td>
</tr>
</table><br>

</dd>
<dt>
<b>@</b>numunits</dt>
<dd>
Specify how often to update the HTML document. Values range from 1 to 255. This parameter is used only when <b>@</b>whentype = 4 (periodic) or <b>@</b>whentype = 8 (now and periodically thereafter). For example, if <b>@</b>whentype = 4, <b>@</b>numunits = 6, and <b>@</b>unittype = 1 (hours), the specified HTML document will be updated every six hours. The <i>numunits</i> variable is of <i>tinyint</i> datatype.</dd>
<dt>
<b>@</b>unittype</dt>
<dd>
Specifies how often the HTML document should be updated for <b>@</b>numunits = 4 (periodic) or <b>@</b>whentype = 8 (now and later). Use 1 (hours), 2 (days), 3 (weeks), or 4 (minutes). The <i>unittype</i> variable is of <i>tinyint</i> datatype.</dd>
<dt>
<b>@</b>procname</dt>
<dd>
Specifies the procedure or task name for the HTML document. If no <b>@</b>procname is specified, the procedure name generated by <b>sp_makewebtask</b> is in the form of Web_YYMMDDHHMMSS&lt;spid&gt;. If it is user-specified, the procedure name must meet the conditions for valid procedure names and the procedure name must be unique. The <i>procname</i> variable is of <i>varchar</i> datatype and has a maximum of 28 characters.</dd>
<dt>
<b>@</b>maketask</dt>
<dd>
Specifies whether a task should be created to execute an internal stored procedure that generates an HTML document. The default is to build the task (1). A value of 0 creates the stored procedure. The <i>maketask</i> variable is of <i>tinyint</i> datatype.</dd>
<dt>
<b>@</b>rowcnt</dt>
<dd>
Specifies the maximum number of rows to display in the generated HTML document. The default is to specify that all rows that satisfy the given query will be displayed in the HTML document (0). The <i>rowcnt</i> variable is of <i>int</i> datatype.</dd>
<dt>
<b>@</b>tabborder</dt>
<dd>
Specifies whether a border should be drawn around the results table (1, the default) or no border should be drawn around the results table (0). The <i>taborder</i> variable is of <i>tinyint</i> datatype.</dd>
<dt>
<b>@</b>singlerow</dt>
<dd>
Specifies whether the results are to be displayed as one row per page. If <b>@</b>singlerow is 0 (the default) all results appear on the same page and in the same table. With a value of 1, <b>@</b>singlerow causes a new HTML page to be generated for every qualifying row in the results set. Successive HTML pages are generated with a number appended to the specified <i>output_filename</i>. For example, if web.html is specified as the output filename, by using <b>@</b>singlerow = 1, pages are called web1.html, web2.html, and so on. The <i>singlerow</i> variable is of <i>tinyint</i> datatype.</dd>
<dt>
<b>@</b>blobfmt</dt>
<dd>
Specifies whether all columns of <i>text</i> or <i>image</i> datatypes should be embedded in the same results page (NULL, the default) or whether these fields should be saved in another page and linked to the main HTML document by an URL. To place the <i>text</i> or <i>image</i> data in a separate HTML page, use the following format:
<pre>"%n% FILE=output_filename TPLT=template_filename 
URL=url_link_name..."
<b><i>  </i></b></pre>

<p>
where

<dl>
<dt>
<i>n</i> </dt>
<dd>
Is the column number in the results list corresponding to a text field, and <i>n</i>+1 is the URL hyperlink text to the separate <i>text</i> or <i>image</i> HTML file. If a template_filename is provided, the<b> &lt;%</b>insert_data_here<b>%&gt;</b> marker should be used to indicate the data insertion point. 
<p>
Output filenames end with a number indicating successive rows similar to <b>@</b>singlerow. The <i>output_filename </i>parameter is required, but the <i>template_filename</i> and <i>url_link_name</i> parameters are optional. The FILE <i>output_filename</i> is the full path to the <i>output_file </i>location. If provided, the <i>url_link_name </i>is the http:// link to the file that is accessible through the World Wide Web. If the <i>url_link_name </i>parameter is not provided, then the full physical filename preceeded with the "file:///" tag will be used as the url_link_name. The same syntax in <b>@</b>blobfmt ("<b>%</b>n<b>%</b> FILE<b>=</b>...") can be repeated for multiple <i>text</i> or <i>image</i> columns.

</dd>
</dl>

<p>
<b>Note</b>  Do not add spaces before or after the equal sign (<b>=</b>) and do not put filenames in quotation marks (<b>'</b>).


<p>
The URL text is part of the results set and is always the column after the original <i>text</i> or <i>image</i> column. This URL text column will not be displayed as a separate column in the results set. The <i>blobfmt</i> variable is of <i>text</i> or <i>image</i> datatype.

</dd>
</dl>
<h4>Remarks</h4>
<p>
For scheduled tasks, all errors are reported in the Windows NT event log on the computer running SQL Server and will have a source of xpsqlweb. </p>
<p>
<b>Important</b>  The <b>sp_dropwebtask</b>, <b>sp_makewebtask</b>, and <b>sp_runwebtask</b> stored procedures can be run only on Microsoft SQL Server version 6.5 databases. Running these procedures on a database of a previous version will return errors.</p>
<p>
The SQL Server Web Assistant provides an interface for using the <b>sp_makewebtask</b> stored procedure. For more information about creating web pages with the Web Assistant, see <a href="../../admin/src/adminwn_7lv8.htm">SQL Server Web Assistant</a> earlier in this document.</p>
<p>
Fonts available for HTML documents depend upon the capabilities of your web browser software. Consult your browser software for information about font availability and HTML formatting.</p>
<h4>Examples</h4>
<h5>A.&nbsp;&nbsp;&nbsp;&nbsp;Create Multiple Queries Using a Template File</h5>
<p>
This example creates an HTML document now and upon request and retrieves five book titles and prices, five author first and last names, five publisher names, and five author first and last names. In this document, placement of data is specified by the <b>&lt;%</b>insert_data_here<b>%&gt;</b> marker.</p>
<p>
This is the template file:</p>
<pre>&lt;HTML&gt;
<b><i>  </i></b>
&lt;HEAD&gt;
<b><i>  </i></b>
&lt;TITLE&gt;SQL Server Multiple Queries with Template Web Sample&lt;/TITLE&gt;
<b><i>  </i></b>
&lt;BODY&gt;
<b><i>  </i></b>
&lt;H1&gt;Books For Sale&lt;/H1&gt;
&lt;HR&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;P&gt;
&lt;TABLE BORDER&gt;
&lt;TR&gt; &lt;TH&gt;&lt;I&gt;Title&lt;/I&gt;&lt;/TH&gt; &lt;TH&gt;&lt;B&gt;Price&lt;/B&gt;&lt;/TH&gt; &lt;/TR&gt;
&lt;%begindetail%&gt;
&lt;TR&gt; &lt;TD&gt;&lt;I&gt; &lt;%insert_data_here%&gt; &lt;/I&gt; &lt;/TD&gt;
    &lt;TD ALIGN=RIGHT&gt;&lt;B&gt; $&lt;%insert_data_here%&gt;&lt;/B&gt;&lt;/TD&gt; &lt;/TR&gt;
&lt;%enddetail%&gt;
&lt;/TABLE&gt;
&lt;P&gt;
<b><i>  </i></b>
&lt;HR&gt;
<b><i>  </i></b>
&lt;%insert_data_here%&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;P&gt;
<b><i>  </i></b>
&lt;TABLE BORDER&gt;
&lt;TR&gt; &lt;TH ALIGN=CENTER&gt;ID&lt;/TH&gt; &lt;TH ALIGN=LEFT&gt;&lt;I&gt;Publiher's Name&lt;/I&gt;&lt;/TH&gt; &lt;/TR&gt;
&lt;%begindetail%&gt;
&lt;TR&gt; &lt;TD&gt; &lt;%insert_data_here%&gt; &lt;/TD&gt;
    &lt;TD ALIGN=LEFT&gt;&lt;I&gt; &lt;%insert_data_here%&gt;&lt;/I&gt;&lt;/TD&gt; &lt;/TR&gt;
&lt;%enddetail%&gt;
&lt;/TABLE&gt;
<b><i>  </i></b>
&lt;HR&gt;
<b><i>  </i></b>
&lt;%insert_data_here%&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;P&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;A HREF = "http://www.w3.org.pub/WWW/"&gt;The World Wide Web Consortium&lt;/A&gt;&lt;P&gt;
&lt;A HREF = "http://www.w3.org/hypertext/WWW/MarkUp/html3/contents.html"&gt;HTML 3 specs&lt;/A&gt;&lt;P&gt;
&lt;A HREF = "http://www.microsoft.com"&gt;MICROSOFT&lt;/A&gt;&lt;P&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;/BODY&gt;
<b><i>  </i></b>
&lt;/HTML&gt;
<b><i>  </i></b></pre>
<p>
This is the query:</p>
<pre>USE pubs
go
EXECUTE sp_makewebtask @outputfile = 'C:\WEB\MULTIPLE.HTM',
@query = 'SELECT title, price FROM titles SELECT au_lname, au_fname 
FROM authors SELECT pub_id, pub_name FROM publishers SELECT au_lname, 
au_fname FROM authors', @templatefile = 'C:\WEB\MULTIPLE.TPL',
@dbname = 'PUBS', @rowcnt = 5, @whentype = 9
go
<b><i>  </i></b></pre>
<p>
This is the results set:</p>
<pre>&lt;HTML&gt;
<b><i>  </i></b>
&lt;HEAD&gt;
<b><i>  </i></b>
&lt;TITLE&gt;SQL Server Multiple Queries with Template Web Sample&lt;/TITLE&gt;
<b><i>  </i></b>
&lt;BODY&gt;
<b><i>  </i></b>
&lt;H1&gt;Books For Sale&lt;/H1&gt;
&lt;HR&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;P&gt;
&lt;TABLE BORDER&gt;
&lt;TR&gt; &lt;TH&gt;&lt;I&gt;Title&lt;/I&gt;&lt;/TH&gt; &lt;TH&gt;&lt;B&gt;Price&lt;/B&gt;&lt;/TH&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;TR&gt; &lt;TD&gt;&lt;I&gt; The Busy Executive's Database Guide &lt;/I&gt; &lt;/TD&gt;
    &lt;TD ALIGN=RIGHT&gt;&lt;B&gt; $19.99&lt;/B&gt;&lt;/TD&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;TR&gt; &lt;TD&gt;&lt;I&gt; Cooking with Computers: Surreptitious Balance Sheets &lt;/I&gt; &lt;/TD&gt;
    &lt;TD ALIGN=RIGHT&gt;&lt;B&gt; $11.95&lt;/B&gt;&lt;/TD&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;TR&gt; &lt;TD&gt;&lt;I&gt; You Can Combat Computer Stress! &lt;/I&gt; &lt;/TD&gt;
    &lt;TD ALIGN=RIGHT&gt;&lt;B&gt; $2.99&lt;/B&gt;&lt;/TD&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;TR&gt; &lt;TD&gt;&lt;I&gt; Straight Talk About Computers &lt;/I&gt; &lt;/TD&gt;
    &lt;TD ALIGN=RIGHT&gt;&lt;B&gt; $19.99&lt;/B&gt;&lt;/TD&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;TR&gt; &lt;TD&gt;&lt;I&gt; Silicon Valley Gastronomic Treats &lt;/I&gt; &lt;/TD&gt;
    &lt;TD ALIGN=RIGHT&gt;&lt;B&gt; $19.99&lt;/B&gt;&lt;/TD&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;/TABLE&gt;
&lt;P&gt;
<b><i>  </i></b>
&lt;HR&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;P&gt;
&lt;P&gt;&lt;TABLE BORDER=1&gt;
&lt;TR&gt;&lt;TH ALIGN=LEFT&gt;au_lname&lt;/TH&gt;&lt;TH ALIGN=LEFT&gt;au_fname&lt;/TH&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;White&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Johnson&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Green&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Marjorie&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Carson&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Cheryl&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;O'Leary&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Michael&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Straight&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Dean&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;HR&gt;
<b><i>  </i></b>
<b><i>  </i></b>
<b><i>  </i></b>
&lt;P&gt;
<b><i>  </i></b>
&lt;TABLE BORDER&gt;
&lt;TR&gt; &lt;TH ALIGN=CENTER&gt;ID&lt;/TH&gt; &lt;TH ALIGN=LEFT&gt;&lt;I&gt;Publiher's Name&lt;/I&gt;&lt;/TH&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;TR&gt; &lt;TD&gt; 0736 &lt;/TD&gt;
    &lt;TD ALIGN=LEFT&gt;&lt;I&gt; New Moon Books&lt;/I&gt;&lt;/TD&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;TR&gt; &lt;TD&gt; 0877 &lt;/TD&gt;
    &lt;TD ALIGN=LEFT&gt;&lt;I&gt; Binnet &amp; Hardley&lt;/I&gt;&lt;/TD&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;TR&gt; &lt;TD&gt; 1389 &lt;/TD&gt;
    &lt;TD ALIGN=LEFT&gt;&lt;I&gt; Algodata Infosystems&lt;/I&gt;&lt;/TD&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;TR&gt; &lt;TD&gt; 1622 &lt;/TD&gt;
    &lt;TD ALIGN=LEFT&gt;&lt;I&gt; Five Lakes Publishing&lt;/I&gt;&lt;/TD&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;TR&gt; &lt;TD&gt; 1756 &lt;/TD&gt;
    &lt;TD ALIGN=LEFT&gt;&lt;I&gt; Ramona Publishers&lt;/I&gt;&lt;/TD&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;/TABLE&gt;
<b><i>  </i></b>
&lt;HR&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;P&gt;
&lt;P&gt;&lt;TABLE BORDER=1&gt;
&lt;TR&gt;&lt;TH ALIGN=LEFT&gt;au_lname&lt;/TH&gt;&lt;TH ALIGN=LEFT&gt;au_fname&lt;/TH&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;White&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Johnson&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Green&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Marjorie&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Carson&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Cheryl&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;O'Leary&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Michael&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Straight&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Dean&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;HR&gt;
<b><i>  </i></b>
<b><i>  </i></b>
<b><i>  </i></b>
&lt;P&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;A HREF = "http://www.w3.org.pub/WWW/"&gt;The World Wide Web Consortium&lt;/A&gt;&lt;P&gt;
&lt;A HREF = "http://www.w3.org/hypertext/WWW/MarkUp/html3/contents.html"&gt;HTML 3 specs&lt;/A&gt;&lt;P&gt;
&lt;A HREF = "http://www.microsoft.com"&gt;MICROSOFT&lt;/A&gt;&lt;P&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;/BODY&gt;
<b><i>  </i></b>
&lt;/HTML&gt;
<b><i>  </i></b></pre>
<h5>B.&nbsp;&nbsp;&nbsp;&nbsp;Create Hyperlinks</h5>
<p>
This example creates a two-column table called <i>my_favorite_sites</i>. The first column <i>url_def</i> is the URL to a specific web location, and the second column <i>display_text</i>, is the hyperlink text for the corresponding URL. After creating the table and filling it with values, the HTML document is created.</p>
<p>
This is the query:</p>
<pre>USE pubs
go
CREATE TABLE my_favorite_web_sites(url_def varchar(255), display_text varchar(255) NULL)
go
INSERT my_favorite_web_sites(url_def, display_text) 
VALUES ('http://www.micsosoft.com', 'Microsoft Home Page')
INSERT my_favorite_web_sites(url_def) VALUES ('http://www.yahoo.com')
INSERT my_favorite_web_sites(url_def, display_text) 
VALUES ('http://www.w3.org.pub/WWW/', 'The World Wide Web Consortium')
INSERT my_favorite_web_sites(url_def, display_text) 
VALUES ('http://www.nasa.gov', 'NASA  Home Page')
go
EXECUTE sp_makewebtask @outputfile = 'C:\WEB\URL.HTM', 
@query='SELECT title, price FROM titles ORDER BY price desc', 
@table_urls = 1, @tabborder = 0, @lastupdated=0, @colheaders = 0, 
@url_query= 'SELECT url_def, display_text FROM 
my_favorite_web_sites', @whentype = 9
go
<b><i>  </i></b></pre>
<p>
This is the results set:</p>
<pre>&lt;HTML&gt;
<b><i>  </i></b>
&lt;HEAD&gt;
<b><i>  </i></b>
&lt;TITLE&gt;Microsoft SQL Server Web Assistant&lt;/TITLE&gt;
<b><i>  </i></b>
&lt;BODY&gt;
<b><i>  </i></b>
&lt;H1&gt;Query Results&lt;/H1&gt;
&lt;HR&gt;
<b><i>  </i></b>
&lt;P&gt;
&lt;P&gt;&lt;TABLE BORDER=0&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;But Is It User Friendly?&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;22.95&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Computer Phobic AND Non-Phobic Individuals: Behavior Variations&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;21.59&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Onions, Leeks, and Garlic: Cooking Secrets of the Mediterranean&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;20.95&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Secrets of Silicon Valley&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;20.00&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;The Busy Executive's Database Guide&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;19.99&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Straight Talk About Computers&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;19.99&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Silicon Valley Gastronomic Treats&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;19.99&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Prolonged Data Deprivation: Four Case Studies&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;19.99&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Sushi, Anyone?&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;14.99&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Cooking with Computers: Surreptitious Balance Sheets&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;11.95&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Fifty Years in Buckingham Palace Kitchens&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;11.95&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Is Anger the Enemy?&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;10.95&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Emotional Security: A New Algorithm&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;7.99&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Life Without Fear&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;7.00&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;You Can Combat Computer Stress!&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;2.99&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;The Gourmet Microwave&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;2.99&lt;/TT&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;The Psychology of Computer Cooking&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;n/a&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Net Etiquette&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;n/a&lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;HR&gt;
&lt;A HREF = "http://www.microsoft.com"&gt;Microsoft Home Page&lt;/A&gt;&lt;P&gt;
&lt;A HREF = "http://www.yahoo.com"&gt;http://www.yahoo.com&lt;/A&gt;&lt;P&gt;
&lt;A HREF = "http://www.w3.org.pub.WWW/"&gt;The World Wide Web Consortium&lt;/A&gt;&lt;P&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;/BODY&gt;
<b><i>  </i></b>
&lt;/HTML&gt;
<b><i>  </i></b></pre>
<h5>C.&nbsp;&nbsp;&nbsp;&nbsp;Execute Multiple Queries with Single Row Mode</h5>
<p>
This example creates four HTML documents from multiple queries and uses the single row mode.</p>
<p>
This is the query:</p>
<pre>USE pubs
go
EXECUTE sp_makewebtask @outputfile = 'C:\WEB\SROW.HTM', 
@query = 'SELECT title, price FROM titles ORDER BY price desc 
SELECT au_lname, au_fname FROM authors WHERE state = "CA" ', 
@fixedfont = 0, @webpagetitle = 'Single row SQL Web Assistant', 
@resultstitle = 'One row per page results', @singlerow = 1, 
@rowcnt = 4,@URL = "http://www.microsoft.com", 
@reftext = 'Microsoft Home Page'
go
<b><i>  </i></b></pre>
<p>
This is the first file of the results set called C:\WEB\SROW1.HTM:</p>
<pre>&lt;HTML&gt;
<b><i>  </i></b>
&lt;HEAD&gt;
<b><i>  </i></b>
&lt;TITLE&gt;Single row SQL Web Assistant&lt;/TITLE&gt;
<b><i>  </i></b>
&lt;BODY&gt;
<b><i>  </i></b>
&lt;H1&gt;One row per page results&lt;/H1&gt;
&lt;HR&gt;
<b><i>  </i></b>
&lt;PRE&gt;Last updated: Jun 5 1996  3:15PM&lt;/PRE&gt;
<b><i>  </i></b>
&lt;P&gt;
&lt;P&gt;&lt;TABLE BORDER=1&gt;
&lt;TR&gt;&lt;TH ALIGN=LEFT&gt;title&lt;/TH&gt;&lt;TH ALIGN=LEFT&gt;price&lt;/TH&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;But Is It User Friendly?&lt;/TD&gt;&lt;TD NOWRAP&gt;22.95&lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;HR&gt;
&lt;A HREF = "http://www.microsoft.com"&gt;Microsoft Home Page&lt;/A&gt;&lt;P&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;/BODY&gt;
<b><i>  </i></b>
&lt;/HTML&gt;
<b><i>  </i></b></pre>
<p>
This is the second file of the results set called C:\WEB\SROW2.HTM:</p>
<pre>&lt;HTML&gt;
<b><i>  </i></b>
&lt;HEAD&gt;
<b><i>  </i></b>
&lt;TITLE&gt;Single row SQL Web Assistant&lt;/TITLE&gt;
<b><i>  </i></b>
&lt;BODY&gt;
<b><i>  </i></b>
&lt;H1&gt;One row per page results&lt;/H1&gt;
&lt;HR&gt;
<b><i>  </i></b>
&lt;PRE&gt;Last updated: Jun 5 1996  3:15PM&lt;/PRE&gt;
<b><i>  </i></b>
&lt;P&gt;
&lt;P&gt;&lt;TABLE BORDER=1&gt;
&lt;TR&gt;&lt;TH ALIGN=LEFT&gt;title&lt;/TH&gt;&lt;TH ALIGN=LEFT&gt;price&lt;/TH&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;Computer Phobic AND Non-Phobic Individuals: Behavior Variations&lt;/TD&gt;&lt;TD NOWRAP&gt;21.59&lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;HR&gt;
&lt;A HREF = "http://www.microsoft.com"&gt;Microsoft Home Page&lt;/A&gt;&lt;P&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;/BODY&gt;
<b><i>  </i></b>
&lt;/HTML&gt;
<b><i>  </i></b></pre>
<p>
This is the third file of the results set called C:\WEB\SROW3.HTM:</p>
<pre>&lt;HTML&gt;
<b><i>  </i></b>
&lt;HEAD&gt;
<b><i>  </i></b>
&lt;TITLE&gt;Single row SQL Web Assistant&lt;/TITLE&gt;
<b><i>  </i></b>
&lt;BODY&gt;
<b><i>  </i></b>
&lt;H1&gt;One row per page results&lt;/H1&gt;
&lt;HR&gt;
<b><i>  </i></b>
&lt;PRE&gt;Last updated: Jun 5 1996  3:15PM&lt;/PRE&gt;
<b><i>  </i></b>
&lt;P&gt;
&lt;P&gt;&lt;TABLE BORDER=1&gt;
&lt;TR&gt;&lt;TH ALIGN=LEFT&gt;au_lname&lt;/TH&gt;&lt;TH ALIGN=LEFT&gt;au_fname&lt;/TH&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;White&lt;/TD&gt;&lt;TD NOWRAP&gt;Johnson&lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;HR&gt;
&lt;A HREF = "http://www.microsoft.com"&gt;Microsoft Home Page&lt;/A&gt;&lt;P&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;/BODY&gt;
<b><i>  </i></b>
&lt;/HTML&gt;
<b><i>  </i></b></pre>
<p>
This is the fourth file of the results set called C:\WEB\SROW4.HTM:</p>
<pre>&lt;HTML&gt;
<b><i>  </i></b>
&lt;HEAD&gt;
<b><i>  </i></b>
&lt;TITLE&gt;Single row SQL Web Assistant&lt;/TITLE&gt;
<b><i>  </i></b>
&lt;BODY&gt;
<b><i>  </i></b>
&lt;H1&gt;One row per page results&lt;/H1&gt;
&lt;HR&gt;
<b><i>  </i></b>
&lt;PRE&gt;Last updated: Jun 5 1996  3:15PM&lt;/PRE&gt;
<b><i>  </i></b>
&lt;P&gt;
&lt;P&gt;&lt;TABLE BORDER=1&gt;
&lt;TR&gt;&lt;TH ALIGN=LEFT&gt;au_lname&lt;/TH&gt;&lt;TH ALIGN=LEFT&gt;au_fname&lt;/TH&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;Green&lt;/TD&gt;&lt;TD NOWRAP&gt;Marjorie&lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;HR&gt;
&lt;A HREF = "http://www.microsoft.com"&gt;Microsoft Home Page&lt;/A&gt;&lt;P&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;/BODY&gt;
<b><i>  </i></b>
&lt;/HTML&gt;
<b><i>  </i></b></pre>
<h5>D.&nbsp;&nbsp;&nbsp;&nbsp;Execute Multiple Queries Using Data Insert Markers and a Template</h5>
<p>
This example creates two HTML documents from multiple queries by using a template that places each book title and price in separate HTML files.</p>
<p>
This is the template file:</p>
<pre>&lt;HTML&gt;
<b><i>  </i></b>
&lt;HEAD&gt;
<b><i>  </i></b>
&lt;TITLE&gt;SQL Server Multiple Queries, Data Insert Markers, &amp; Template Web Sample&lt;/TITLE&gt;
<b><i>  </i></b>
&lt;BODY&gt;
<b><i>  </i></b>
&lt;H1&gt;Books For Sale&lt;/H1&gt;
&lt;HR&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;P&gt;
&lt;TABLE BORDER&gt;
&lt;TR&gt; &lt;TH&gt;&lt;I&gt;Title&lt;/I&gt;&lt;/TH&gt; &lt;TH&gt;&lt;B&gt;Price&lt;/B&gt;&lt;/TH&gt; &lt;/TR&gt;
&lt;%begindetail%&gt;
&lt;TR&gt; &lt;TD&gt;&lt;I&gt; &lt;%insert_data_here%&gt; &lt;/I&gt; &lt;/TD&gt;
    &lt;TD ALIGN=RIGHT&gt;&lt;B&gt; $&lt;%insert_data_here%&gt;&lt;/B&gt;&lt;/TD&gt; &lt;/TR&gt;
&lt;%enddetail%&gt;
&lt;/TABLE&gt;
&lt;P&gt;
<b><i>  </i></b>
&lt;HR&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;A HREF = "http://www.w3.org.pub/WWW/"&gt;The World Wide Web Consortium&lt;/A&gt;&lt;P&gt;
&lt;A HREF = "http://www.w3.org/hypertext/WWW/MarkUp/html3/contents.html"&gt;HTML 3 specs&lt;/A&gt;&lt;P&gt;
&lt;A HREF = "http://www.microsoft.com"&gt;MICROSOFT&lt;/A&gt;&lt;P&gt;
<b><i>  </i></b>
&lt;/BODY&gt;
<b><i>  </i></b>
&lt;/HTML&gt;
<b><i>  </i></b></pre>
<p>
This is the query:</p>
<pre>USE pubs
go
EXECUTE sp_makewebtask @outputfile = 'C:\WEB\DATAINS.HTM',
@query = 'SELECT title, price FROM titles', 
@templatefile = 'C:\WEB\DATAINS.TPL', @dbname = 'PUBS', 
@rowcnt = 2, @whentype = 9, @singlerow = 1
go
<b><i>  </i></b></pre>
<p>
This is the first file of the results set called C:\WEB\DATAINS1.HTM:</p>
<pre>&lt;HTML&gt;
<b><i>  </i></b>
&lt;HEAD&gt;
<b><i>  </i></b>
&lt;TITLE&gt;SQL Server Multiple Queries, Data Insert Markers, &amp; Template Web Sample&lt;/TITLE&gt;
<b><i>  </i></b>
&lt;BODY&gt;
<b><i>  </i></b>
&lt;H1&gt;Books For Sale&lt;/H1&gt;
&lt;HR&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;P&gt;
&lt;TABLE BORDER&gt;
&lt;TR&gt; &lt;TH&gt;&lt;I&gt;Title&lt;/I&gt;&lt;/TH&gt; &lt;TH&gt;&lt;B&gt;Price&lt;/B&gt;&lt;/TH&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;TR&gt; &lt;TD&gt;&lt;I&gt; The Busy Executive's Database Guide &lt;/I&gt; &lt;/TD&gt;
    &lt;TD ALIGN=RIGHT&gt;&lt;B&gt; $19.99&lt;/B&gt;&lt;/TD&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;/TABLE&gt;
&lt;P&gt;
<b><i>  </i></b>
&lt;HR&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;A HREF = "http://www.w3.org.pub/WWW/"&gt;The World Wide Web Consortium&lt;/A&gt;&lt;P&gt;
&lt;A HREF = "http://www.w3.org/hypertext/WWW/MarkUp/html3/contents.html"&gt;HTML 3 specs&lt;/A&gt;&lt;P&gt;
&lt;A HREF = "http://www.microsoft.com"&gt;MICROSOFT&lt;/A&gt;&lt;P&gt;
<b><i>  </i></b>
&lt;/BODY&gt;
<b><i>  </i></b>
&lt;/HTML&gt;
<b><i>  </i></b></pre>
<p>
This is the second file of the results set called C:\WEB\DATAINS2.HTM:</p>
<pre>&lt;HTML&gt;
<b><i>  </i></b>
&lt;HEAD&gt;
<b><i>  </i></b>
&lt;TITLE&gt;SQL Server Multiple Queries, Data Insert Markers, &amp; Template Web Sample&lt;/TITLE&gt;
<b><i>  </i></b>
&lt;BODY&gt;
<b><i>  </i></b>
&lt;H1&gt;Books For Sale&lt;/H1&gt;
&lt;HR&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;P&gt;
&lt;TABLE BORDER&gt;
&lt;TR&gt; &lt;TH&gt;&lt;I&gt;Title&lt;/I&gt;&lt;/TH&gt; &lt;TH&gt;&lt;B&gt;Price&lt;/B&gt;&lt;/TH&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;TR&gt; &lt;TD&gt;&lt;I&gt; Cooking with Computers: Surreptitious Balance Sheets &lt;/I&gt; &lt;/TD&gt;
    &lt;TD ALIGN=RIGHT&gt;&lt;B&gt; $11.95&lt;/B&gt;&lt;/TD&gt; &lt;/TR&gt;
<b><i>  </i></b>
&lt;/TABLE&gt;
&lt;P&gt;
<b><i>  </i></b>
&lt;HR&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;A HREF = "http://www.w3.org.pub/WWW/"&gt;The World Wide Web Consortium&lt;/A&gt;&lt;P&gt;
&lt;A HREF = "http://www.w3.org/hypertext/WWW/MarkUp/html3/contents.html"&gt;HTML 3 specs&lt;/A&gt;&lt;P&gt;
&lt;A HREF = "http://www.microsoft.com"&gt;MICROSOFT&lt;/A&gt;&lt;P&gt;
<b><i>  </i></b>
&lt;/BODY&gt;
<b><i>  </i></b>
&lt;/HTML&gt;
<b><i>  </i></b></pre>
<h5>E.&nbsp;&nbsp;&nbsp;&nbsp;Execute Query Using @blobfmt</h5>
<p>
This example executes a single query and places the information into HTML documents. The <i>publishers</i> table is linked with the <i>pub_info</i> table to provide company logos in the HTML documents.</p>
<p>
This is the template file called C:\WEB\BLOBSMP.TPL:</p>
<pre>&lt;HTML&gt;
<b><i>  </i></b>
&lt;HEAD&gt;
<b><i>  </i></b>
&lt;TITLE&gt;Publishers PR Info&lt;/TITLE&gt;
<b><i>  </i></b>
&lt;/HEAD&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;BODY&gt;
<b><i>  </i></b>
&lt;HR&gt;
<b><i>  </i></b>
&lt;PRE&gt;
<b><i>  </i></b>
&lt;%insert_data_here%&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;/PRE&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;/BODY&gt;
<b><i>  </i></b>
&lt;/HTML&gt;
<b><i>  </i></b></pre>
<p>
This is the query:</p>
<pre>USE pubs
go
EXECUTE sp_makewebtask @outputfile = 'C:\WEB\BLOBSMP.HTM',     
@query = 'SELECT pr_info, pub_name, city, state, country, logo, 
pub_info.pub_id FROM pub_info, publishers 
WHERE pub_info.pub_id = publishers.pub_id', 
@webpagetitle = 'Publishers Home Page', 
@resultstitle = 'Premier Publishers and Their Home Page Links', 
@whentype = 9, @blobfmt='%1% FILE=C:\WEB\BLOBSMP.HTM 
TPLT=C:\WEB\BLOBSMP.TPL %6% FILE=C:\WEB\PUBLOGO.BMP', @rowcnt = 2
go
<b><i>  </i></b></pre>
<p>
This is the main HTML document BLOBSMP.HTM, which contains hyperlinks to the logo bitmaps and to the publisher's home web pages.</p>
<pre>&lt;HTML&gt;
<b><i>  </i></b>
&lt;HEAD&gt;
<b><i>  </i></b>
&lt;TITLE&gt;Publishers Home Page&lt;/TITLE&gt;
<b><i>  </i></b>
&lt;BODY&gt;
<b><i>  </i></b>
&lt;H1&gt;Premier Publishers and Their Home Page Links&lt;/H1&gt;
&lt;HR&gt;
<b><i>  </i></b>
&lt;PRE&gt;&lt;TT&gt;Last updated: Jun 28 1996  3:15PM&lt;/TT&gt;&lt;/PRE&gt;
<b><i>  </i></b>
&lt;P&gt;
&lt;P&gt;&lt;TABLE BORDER=1&gt;
&lt;TR&gt;&lt;TH ALIGN=LEFT&gt;pr_info&lt;/TH&gt;&lt;TH ALIGN=LEFT&gt;city&lt;/TH&gt;&lt;TH ALIGN=LEFT&gt;state&lt;/TH&gt;&lt;TH ALIGN=LEFT&gt;country&lt;/TH&gt;&lt;TH ALIGN=LEFT&gt;logo&lt;/TH&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;A HREF = "file:///c:\web\blobfmt1.htm"&gt;New Moon Books&lt;/A&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Boston&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;MA&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;USA&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;A HREF = "file:///c:\web\publogo1.bmp"&gt;0736&lt;/A&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD NOWRAP&gt;&lt;A HREF = "file:///c:\web\blobfmt2.htm"&gt;Binnet &amp; Hardley&lt;/A&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;Washington&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;DC&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;TT&gt;USA&lt;/TT&gt;&lt;/TD&gt;&lt;TD NOWRAP&gt;&lt;A HREF = "file:///c:\web\publogo2.bmp"&gt;0877&lt;/A&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;HR&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;/BODY&gt;
<b><i>  </i></b>
&lt;/HTML&gt;
<b><i>  </i></b></pre>
<p>
This is the first file of the results set called C:\WEB\BLOBSMP1.HTM:</p>
<pre>&lt;HTML&gt;
<b><i>  </i></b>
&lt;HEAD&gt;
<b><i>  </i></b>
&lt;TITLE&gt;Publishers PR Info&lt;/TITLE&gt;
<b><i>  </i></b>
&lt;/HEAD&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;BODY&gt;
<b><i>  </i></b>
&lt;HR&gt;
<b><i>  </i></b>
&lt;PRE&gt;
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Books is located in Boston, Massachusettes.
<b><i>  </i></b>
This is sample text data for New Moon Books, publisher 0736 in the pubs database. New Moon Boo
<b><i>  </i></b>
<b><i>  </i></b>
&lt;/PRE&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;/BODY&gt;
<b><i>  </i></b>
&lt;/HTML&gt;
<b><i>  </i></b></pre>
<p>
This is the second file of the results set called C:\WEB\BLOBSMP2.HTM:</p>
<pre>&lt;HTML&gt;
<b><i>  </i></b>
&lt;HEAD&gt;
<b><i>  </i></b>
&lt;TITLE&gt;Publishers PR Info&lt;/TITLE&gt;
<b><i>  </i></b>
&lt;/HEAD&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;BODY&gt;
<b><i>  </i></b>
&lt;HR&gt;
<b><i>  </i></b>
&lt;PRE&gt;
<b><i>  </i></b>
This is sample text data for Binnet &amp; Hardley, publisher 0877 in the pubs database. Binnet &amp; Hardley is located in Washington, D.C.
<b><i>  </i></b>
This is sample text data for Binnet &amp; Hardley, publisher 0877 in the pubs database. Binnet &amp; Hardley is located in Washington, D.C.
<b><i>  </i></b>
This is sample text data for Binnet &amp; Hardley, publisher 0877 in the pubs database. Binnet &amp; Hardley is located in Washington, D.C.
<b><i>  </i></b>
This is sample text data for Binnet &amp; Hardley, publisher 0877 in the pubs database. Binnet &amp; Hardley is located in Washington, D.C.
<b><i>  </i></b>
This is sample text data for Binnet &amp; Hardley, publisher 0877 in the pubs database. Binnet &amp; Hardley is located in Washington, D.C.
<b><i>  </i></b>
<b><i>  </i></b>
<b><i>  </i></b>
<b><i>  </i></b>
&lt;/PRE&gt;
<b><i>  </i></b>
<b><i>  </i></b>
&lt;/BODY&gt;
<b><i>  </i></b>
&lt;/HTML&gt;
<b><i>  </i></b>
<b><i>  </i></b></pre>
<h4>Permission</h4>
<p>
The user must have SELECT permissions to run the specified query and CREATE PROCEDURE permissions in the database in which the query will run. The SQL Server account must have privileges to write the generated HTML document to the specified location. Only the system administrator can impersonate other users.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
