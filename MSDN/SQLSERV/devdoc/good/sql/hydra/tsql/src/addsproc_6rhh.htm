<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_setnetname</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_setnetname"></a>sp_setnetname (version 6.5)</h2>
<p>
Sets the network names in<i> sysservers</i> to their actual network machine names for remote computers running SQL Server. Names can include hyphens and other non-alphabetic characters. This procedure can be used to enable execution of remote stored procedure calls to machines that have network names containing invalid SQL Server identifiers.</p>
<h4>Syntax</h4>
<p>
<b>sp_setnetname</b> <b>@</b><i>server</i> [ <b>= '</b><i>server</i><b>'</b>]<b>, @</b><i>netname</i> [ <b>= '</b><i>netname</i><b>'</b>]</p>
<p>
where
<dl>
<dt>
<i><b>@</b>server</i></dt>
<dd>
Is the name of the remote server as referenced in user-coded remote stored procedure call syntax. Exactly one row in <i>sysservers</i> must already exist to use this <i><b>@</b>server</i>.</dd>
<dt>
<i><b>@</b>netname</i></dt>
<dd>
Is the network name of the computer to which remote stored procedure calls will be made. This name must match the Windows NT machine name, and it can include characters, such as hyphens, that are not allowed in SQL Server identifiers. In most cases, setting the <i><b>@</b>netname</i> to the network machine name enables remote stored procedure calls to a SQL Server running on a remote machine with a name that is not legal in SQL Server.
<p>
If a DB-Library alias matching the <i><b>@</b>netname</i> is defined on the SQL Server machine, the connection string information in that alias is used to connect to the remote SQL Server.

</dd>
</dl>
<h4>Remarks</h4>
<p>
Because Transact-SQL syntax does not usually recognize characters such as a hyphen in an object name, some remote stored procedure calls to Windows NT computers that have a machine name containing a hyphen can cause problems. Use this procedure to differentiate the values in <i>sysservers.srvname</i> versus <i>sysservers.srvnetname</i>. </p>
<p>
For example, if your Windows NT Server machine name is MY-NT-PC, SQL Server Setup warns you that this computer name contains an invalid identifier, the hyphen (-). If your network system administrator requires MY-NT-PC to remain the machine name, then the system administrator can use <b>sp_addserver</b> and <b>sp_setnetname</b> to keep the server's network name MY-NT-PC while the computer's local name is another name that contains valid SQL Server identifiers.</p>
<p>
For example:</p>
<pre>sp_addserver 'MY_NT_PC', 'local'
sp_setnetname 'MY_NT_PC', 'MY-NT-PC'
<b><i>  </i></b></pre>
<p>
This procedure aids replication in situations where Windows NT machines with invalid SQL Server names are involved.</p>
<h4>Example</h4>
<p>
This example is a typical administrative sequence on the SQL Server that issues the remote stored procedure call.</p>
<pre>EXECUTE sp_addserver 'Win_NT1'
EXECUTE sp_setnetname 'Win_NT1','Win-NT1'
EXECUTE Win_NT1.master.dbo.sp_who 
<b><i>  </i></b></pre>
<h4>Permissions</h4>
<p>
Only the system administrator can execute this procedure.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
