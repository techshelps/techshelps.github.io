<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_replcmds</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_replcmds"></a>sp_replcmds (version 6.5)</h2>
<p>
Treats the first client who runs <b>sp_replcmds</b> within a given database as the logreader. Clients who attempt to run <b>sp_replcmds</b> within the same database receive error 18752 until the first client disconnects. After the first client disconnects, another client can run <b>sp_replcmds</b> and becomes the new logreader.</p>
<p>
For additional syntax information for <a href="../../../tsqlref/src/tsql16_87hh.htm"><b>sp_replcmds</b></a>, see the <i>Microsoft SQL Server Transact-SQL Reference</i>. </p>
<h4>Remarks</h4>
<p>
This procedure can generate commands for owner-qualified tables or not qualify the table name (the default). Adding qualified table names allows replication of data from tables owned by a specific user in one database to tables owned by the same user in another database.</p>
<p>
<b>Note</b>  Because the table name in the source database will be qualified by the owner name, the owner of the table in the target database must be the same owner name.</p>
<p>
The error message 18752 is:</p>
<pre>Msg 18752, Level 16, State 1, Server &lt;SERVERNAME&gt;, Line 1
Another logreader is replicating the database
<b><i>  </i></b></pre>
<p>
<b>Note</b>  The <b>sp_replcmds </b>procedure<b> </b>should be run only to troubleshoot problems with replication.</p>
<p>
A warning message number 18759 will be added to both the SQL Server error log and the Windows NT Event Log if <b>sp_replcmds </b>is unable to replicate a text command because the text pointer was not retrieved in the same transaction. The 18759 error message text is: Unable to replicate a text command because the corresponding TEXTPTR was not found in the replicated transaction (<b>%</b>ld, <b>%</b>ld).</p>
<p>
For more information about distribution processes, see the <i>Microsoft SQL Server Administrator's Companion</i>.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
