<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Transact-SQL Reference Errata</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_transact.2d.sql_reference_errata"></a><i>Transact-SQL Reference </i>Errata</h2>
<p>
The following changes should be made to the <i>Microsoft SQL Server Transact-SQL Reference</i> for Microsoft SQL Server 6.0.
<ul>
<li>
On page 5, the description for <i>datatype</i> of the ALTER TABLE statement should be:<dl>
<dt>
<i>datatype</i></dt>
<dd>
Specifies the datatype of the column. System or user-defined datatypes are acceptable. Columns added to a table must be defined as NULL. When a column is added, the initial value of the column will be set to NULL. This restriction forces the ALTER TABLE statement to fail if the <i>bit</i> datatype is used.</dd>
</dl>
</li>
<li>
On page 7, add the following sentence after the sentence that begins with "A table can have":<p>
There is a limit to the number of FOREIGN KEY constraints which is restricted by the number of unique joins between the tables involved in the join.
</li>
<li>
On page 15, the syntax for the simple CASE expression should be:<p>
CASE expression
<p class=indent1>
WHEN <i>search_condition1</i> THEN <i>result1</i></p>
<p class=indent1>
[[WHEN <i>search_condition2</i> THEN <i>result2</i>] [...]]</p>
</li>
<li>
On page 17, example A of the CASE expression should be:<pre>-- Comment describing usage of the generic CASE expression
-- WHEN <i>search condition</i> THEN <i>result</i>
<b><i>  </i></b>
SELECT    Category = 
CASE type
WHEN 'popular_comp' THEN 'Popular Computing'
WHEN 'mod_cook' THEN 'Modern Cooking'
WHEN 'business' THEN 'Business'
WHEN 'psychology' THEN 'Psychology'
WHEN 'trad_cook' THEN 'Traditional Cooking'
ELSE 'Not yet categorized'
END,
'Shortened Title' = CONVERT(varchar(30), title),
Price = price
FROM titles
WHERE price IS NOT NULL
ORDER BY type
COMPUTE AVG(price) BY type
go
<b><i>  </i></b></pre>
</li>
<li>
On page 29, the syntax for the IF...ELSE Block should be:<p>
IF <i>Boolean_expression</i>
<p>
{<i>sql_statement</i> | <i>statement_block</i>}
<p>
[ELSE
<p>
{<i>sql_statement</i> | <i>statement_block</i>}]
</li>
<li>
On page 29, add the following sentence to the definition of the <i>sql_statement</i> | <i>statement</i>_<i>block</i> parameter for the IF...ELSE Block:<p>
CREATE TABLE statements or SELECT INTO statements must refer to the same table name if the CREATE TABLE or SELECT INTO statements are used in both the IF and ELSE areas of the IF...ELSE Block.
</li>
<li>
On page 29, the syntax for the RETURN statement should be:<p>
RETURN [(<i>integer_expression</i>)]
</li>
<li>
On page 46, FILLFACTOR values must be 1 to 100. Zero is not a valid FILLFACTOR value.</li>
<li>
On page 48, add the following "Note" to the SORTED_DATA definition for the CREATE INDEX Statement:<p>
<b>Note</b>  If duplicate rows exist in the table, the CREATE TABLE command will fail.
</li>
<li>
On page 48, the sentence that begins with "To determine whether or not a table is contiguous" should be:<p>
To determine whether or not a table is contiguous, use the DBCC statement's SHOWCONTIG.
</li>
<li>
On page 52, OUTPUT should be added as an option in the CREATE PROCEDURE syntax:<p>
CREATE PROC[EDURE] [<i>owner</i><b>.</b>]<i>procedure_name</i>[<b>;</b><i>number</i>]
<p>
[<b>(</b><i>parameter1</i> [<b>, </b><i>parameter2</i>]...[<b>, </b><i>parameter255</i>]<b>)</b>]
<p>
[{FOR REPLICATION WITH RECOMPILE} | 
<p>
[{[WITH] | [<b>,</b>]} ENCRYPTION]]
<p>
[OUTPUT]
<p>
AS <i>sql_statements</i>
</li>
<li>
On page 66, the syntax of the <i>column_properties</i> clause of the CREATE TABLE statement should be:<dl>
<dt>
<i>column_properties</i> <b>=</b></dt>
<dd>
<i>datatype</i> [IDENTITY[<b>(</b><i>seed</i><b>, </b><i>increment</i><b>)</b>]]</dd>
</dl>
</li>
<li>
On page 67, the syntax of the <i>constraint</i> clause of the CREATE TABLE statement should add [NULL | NOT NULL] as a possible <i>constraint</i> value.</li>
<li>
On page 69, add the following sentence after the sentence that begins with "A table can have":<p>
There is a limit to the number of FOREIGN KEY constraints, which is restricted by the number of unique joins between the tables involved in the join.
</li>
<li>
On page 75, for the CREATE TABLE statement, the code examples should be:</li>
</ul>
<h5>A.&nbsp;&nbsp;&nbsp;&nbsp;Show Generic Syntax</h5>
<p>
This example shows the generic syntax for using the IDENTITY property.</p>
<pre>SET IDENTITY_INSERT tablename ON
go
DECLARE @minidentval column_type
DECLARE @nextidentval column_type
SELECT @minidentval = MIN(IDENTITYCOL) FROM tablename
IF @minidentval = IDENT_SEED('tablename')
    SELECT @nextidentval = MIN(IDENTITYCOL) + IDENT_INCR('tablename')
    FROM tablename t1
    WHERE IDENTITYCOL BETWEEN IDENT_SEED('tablename') AND 
        MAX(column_type) AND
        NOT EXISTS (SELECT * FROM tablename t2
            WHERE t2.IDENTITYCOL = t1.IDENTITYCOL + 
                IDENT_INCR('tablename'))
ELSE
    SELECT @nextidentval = IDENT_SEED('tablename')
SET IDENTITY_INSERT tablename OFF
<b><i>  </i></b></pre>
<h5>B.&nbsp;&nbsp;&nbsp;&nbsp;Check <i>image</i> Table for Gaps</h5>
<p>
This example shows how to use the IDENTITY property on a table called <i>image</i> that has two columns: the first column called <i>id_num</i>, which is an increasing identification number, and the second column called <i>company_name</i>.</p>
<pre>-- Create the image table
CREATE TABLE image (id_num int IDENTITY(1,1), company_name varchar)
INSERT image(company_name) VALUES ('A Company Name')
INSERT image(company_name) VALUES ('Another Company Name')
-- Set IDENTITY_INSERT on and utilize in image table
SET IDENTITY_INSERT image ON
go
DECLARE @minidentval smallint
DECLARE @nextidentval smallint
SELECT @minidentval = MIN(IDENTITYCOL) FROM image
 IF @minidentval = IDENT_SEED('image')
     SELECT @nextidentval = MIN(IDENTITYCOL) + IDENT_INCR('image')
     FROM image t1
     WHERE IDENTITYCOL BETWEEN IDENT_SEED('image') AND 32766 and NOT EXISTS (SELECT * FROM image t2
         WHERE t2.IDENTITYCOL = t1.IDENTITYCOL + IDENT_INCR('image'))
 ELSE
     SELECT @nextidentval=IDENT_SEED('image')
SET IDENTITY_INSERT image OFF
<b><i>  </i></b></pre>
<ul>
<li>
On page 75, add another example for the IDENTITY syntax of the CREATE TABLE statement:<pre>SELECT pkid = IDENTITY(int,1,1), type, name
INTO #t1
FROM sysobjects
WHERE type = 'U'
<b><i>  </i></b></pre>
</li>
<li>
On page 81, the CREATE TRIGGER syntax should be:<p>
CREATE TRIGGER [<i>owner</i><b>.</b>]<i>trigger_name</i>
<p>
ON [<i>owner</i><b>.</b>]<i>table_name</i>
<p>
[WITH ENCRYPTION]
<p>
FOR {INSERT, UPDATE, DELETE}
</li>
<li>
On page 84, in "Trigger Limitations," the last sentence should be:<p>
The WRITETEXT and UPDATETEXT statements, whether logged or unlogged, do not activate a trigger.
</li>
<li>
On page 102, example C, the comment for the stored procedure should include the word "user" as follows:<pre>This procedure will generate a short report of the DBCC output for 
all user tables within this database.
<b><i>  </i></b></pre>
</li>
<li>
On page 103, the procedure call should be dbcc_all_tables, not dbcc_all_tables 'U'.</li>
<li>
On page 111, in the "Date Formats" topic, the fourth alphabetic format in the first paragraph of alphabetic formats, <pre>Apr[il] [19]96 15
<b><i>  </i></b></pre>
<p>
is no longer supported.
</li>
<li>
On page 113, the title for the "Using Data and Time Datatypes" topic should be "Using Date and Time Datatypes."</li>
<li>
On page 114, the sentence that begins with "The clause" in the "Using Date and Time Datatypes" topic should be:<p>
The clause LIKE <b>'</b>May 2%<b>'</b> (with one space between May and 2) finds all dates from May 20 through May 29, but not May 2.
</li>
<li>
On page 114, the first sentence of the description of the <i>decimal</i> and <i>numeric</i> datatypes for the "Exact Numeric Data" topic should be:<p>
Are exact numeric datatypes that hold values from 1038 - 1 through - 1038 - 1.
</li>
<li>
On page 115, the second sentence of the description of the <i>float</i> datatype for the "Approximate Numeric Data" topic should be:<p>
Specify the binary precision with <i>n</i>, which must be from 1 through 15.
</li>
<li>
On page 115, the sentence that begins with "Storage size is 8 bytes" in the <i>float</i> description for the "Approximate Numeric Data" topic should be:<p>
Storage size is 8 bytes unless <i>n</i> is 7 or less. If <i>n</i> is 7 or less, then storage size is only 4 bytes.
</li>
<li>
On page 116, the negative limit for the <i>money</i> datatype should be <br>
-922,337,203,685,477.5807.</li>
<li>
On page 117, the sentence that begins with "For example" under the description for the <i>bit</i> datatype for the "Special Datatypes" topic should be:<p>
For example, 8 one-bit columns fit into 1 byte; 9 one-bit columns take 2 bytes.
</li>
<li>
On page 117, under the "Special Datatypes" <i>timestamp </i>topic, the sentence that begins with "Values in <i>timestamp </i>columns" should be:<p>
Values in <i>timestamp</i> columns are not <i>datetime</i> data, but either <i>binary</i>(8) or <i>varbinary</i>(8) data and indicate the sequence of SQL Server activity on the row.
</li>
<li>
On page 118, the sentence that begins with "When <i>image</i>" in the "Text and Image Data" topic should be:<p>
When <i>image</i> is data entered with an odd number of characters (but less than 255), it is padded with a leading zero.
</li>
<li>
On page 121, the syntax for the SHOWCONTIG parameter for the DBCC statement should be:<p>
SHOWCONTIG <b>(</b><i>table_id</i><b> </b>[<b>,</b> <i>index_id</i>]<b>)</b> |
</li>
<li>
On page 121, the syntax for TEXTALL and TEXTALLOC in the DBCC statement should be:<p>
TEXTALL [<b>(</b>{<i>database_name</i> | <i>database_id</i>}[<b>,</b> <b>'</b>FULL<b>'</b> | FAST]<b>)</b>] |
<p>
TEXTALLOC [<b>(</b>{<i>table_name</i> | <i>table_id</i>}[<b>,</b> <b>'</b>FULL<b>'</b> | FAST]<b>)</b>] |
</li>
<li>
On page 121, add the following sentence to the description of the <i>database_id</i> parameter for the DBCC statement:<p>
To find the <i>database_id</i> of a database, specify the database name (<i>db_name</i>) in the following query:
<pre>SELECT dbid FROM sysdatabases
WHERE name = 'db_name'
</pre>
</li>
<li>
On page 121, the syntax for the SHOWCONTIG parameter for the DBCC statement should be:<p>
SHOWCONTIG <b>(</b><i>table_id</i><b> </b>[<b>,</b> <i>index_id</i>]<b>)</b> |
</li>
<li>
On page 121, add the following sentence and example to the description of the <i>database_id</i> parameter for the DBCC statement:<p>
To find the <i>database_id</i> of a database, specify the database name (<i>db_name</i>) in the following query:
<pre>SELECT dbid FROM sysdatabases
WHERE name = 'db_name'
<b><i>  </i></b></pre>
</li>
<li>
On page 122, add the following sentence and example to the description of the <i>index_id</i> parameter for the DBCC statement:<p>
To find the <i>index_id</i> of a nonclustered index, specify the nonclustered index name (<i>nc_index_name</i>) in the following query:
<pre>SELECT indid FROM sysindexes
WHERE name = 'nc_index_name'
<b><i>  </i></b></pre>
</li>
<li>
On page 122, add the following sentence and example to the description of the <i>table_id</i> parameter for the DBCC statement:<p>
To find the <i>table_id</i> of a table, specify the table name (<i>tbl_name</i>) in the following query:
<pre>SELECT id FROM sysobjects 
WHERE name = 'tbl_name'
<b><i>  </i></b></pre>
</li>
<li>
On page 123, add the following sentences and examples in the CHECKTABLE parameter description for the DBCC statement:<p>
To find the <i>database_id</i> of a database, specify the database name (<i>db_name</i>) in the following query:
<pre>SELECT dbid FROM sysdatabases
WHERE name = 'db_name'
<b><i>  </i></b></pre>
<p>
To find the <i>index_id</i> of a nonclustered index, specify the nonclustered index name (<i>nc_index_name</i>) in the following query:
<pre>SELECT indid FROM sysindexes
WHERE name = 'nc_index_name'
<b><i>  </i></b></pre>
<p>
To find the <i>table_id</i> of a table, specify the table name (<i>tbl_name</i>) in the following query:
<pre>SELECT id FROM sysobjects 
WHERE name = 'tbl_name'
<b><i>  </i></b></pre>
</li>
<li>
On page 123, the last sentence of the description of the <i>dllname</i> (FREE) parameter for the DBCC statement should be:<p>
This statement allows a DLL to be unloaded without shutting down SQL Server.
</li>
<li>
On page 125, the sentence that begins with "If you are not careful" in the description of the PINTABLE parameter for the DBCC statement should be:<p>
If you are not careful, a large table could consume all the data cache, the server would need to be restarted, and then the table unpinned.
</li>
<li>
On page 125, the sentence that begins with "To understand the output of SHOW_STATISTICS" in the SHOW_STATISTICS parameter for the DBCC statement should be:<p>
To understand the output of SHOW_STATISTICS, see the examples later in this topic, and the UPDATE STATISTICS statement.
</li>
<li>
On page 126, add the following sentences and examples before the DBCC SHOWCONTIG table for the DBCC statement:<p>
To find the <i>database_id</i> of a database, specify the database name (<i>db_name</i>) in the following query:
<pre>SELECT dbid FROM sysdatabases
WHERE name = 'db_name'
<b><i>  </i></b></pre>
<p>
To find the <i>table_id</i> of a table, specify the table name (<i>tbl_name</i>) in the following query:
<pre>SELECT id FROM sysobjects 
WHERE name = 'tbl_name'
<b><i>  </i></b></pre>
</li>
<li>
On page 127, the sentence that begins with "That is" in the Important note for the SHRINKDB clause of the DBCC statement should be:<p>
That is, <i>new_size</i> must be equal to or greater than the minimum size returned by DBCC SHRINKDB plus any number of 512K increments (each of which is 256 2K pages).
</li>
<li>
On page 127, the syntax for the SQLPERF clause of the DBCC statement should be:<p>
SQLPERF <b>(</b>{IOSTATS | LRUSTATS | NETSTATS | RASTATAS [<b>,</b> CLEAR]} | {THREADS} | {LOGSPACE}<b>)</b>
</li>
<li>
On page 128, the Definition for the Log Logical IO Average for the IOSTATS clause of the DBCC statement should be:<p>
Logical pages written per physical write for transaction log.
</li>
<li>
On page 130, the definition for SQLPERF (LOGSPACE) should be:<p>
Shows the logspace percentages for all databases. This statement is meaningful only if the log is on a separate device from its database. In the output from SQLPERF (LOGSPACE), a status of 0 indicates that the log device is separate from the database device. A status of 1 indicates that the log device is on the same device as the database.
</li>
<li>
On page 131, the definition for the UNPINTABLE clause of the DBCC statement should be:<p>
Marks the table as no longer being RAM resident; however, the pages of the table will remain in cache until they are aged out of cache (and flushed to disk, if necessary).
</li>
<li>
On page 131, add the following sentences and examples in the UPDATEUSAGE parameter description for the DBCC statement:<p>
To find the <i>database_id</i> of a database, specify the database name (<i>db_name</i>) in the following query:
<pre>SELECT dbid FROM sysdatabases
WHERE name = 'db_name'
<b><i>  </i></b></pre>
<p>
To find the <i>index_id</i> of a nonclustered index, specify the nonclustered index name (<i>nc_index_name</i>) in the following query:
<pre>SELECT indid FROM sysindexes
WHERE name = 'nc_index_name'
<b><i>  </i></b></pre>
<p>
To find the <i>table_id</i> of a table, specify the table name (<i>tbl_name</i>) in the following query:
<pre>SELECT id FROM sysobjects 
WHERE name = 'tbl_name'
<b><i>  </i></b></pre>
</li>
<li>
On page 133, the paragraph after example A should be:<p>
This database contains six allocation units of 256 2K pages (0.5 MB) each, giving 1536 2K pages in all (3 MB). Of that 3 MB, 75 extents (75 * 16K = 1200K) is reserved and 137 pages (or 137 * 2K = 274K) are used by data and indexes. The reserved 75 extents include objects that have been created but not yet completely populated with data. Ref pages refer to those pages that do contain actual data or index pages.
</li>
<li>
On page 134, the numbers 4.72 and 95.28 in the output for example D for the DBCC statement should indicate 4.72% of space is used on the log segment, and 95.28% of space is free on the log segment.</li>
<li>
On page 136, the last sentence of the first paragraph for example F of the DBCC statement should be:<p>
This example shows the DBCC output for each index after 1500 rows are inserted and the statistics have been updated by using UPDATE STATISTICS.
</li>
<li>
On page 138, example G<b> </b>for the DBCC statement should be:<ol>
<li>
Change your current database to the database you want to shrink.</li>
<li>
Set the database to single-user mode using the <b>sp_dboption</b> system stored procedure.</li>
<li>
Verify how small you can make the database. (Run DBCC SHRINKDB without specifying <i>new_size</i>.)</li>
<li>
Shrink the database.</li>
</ol>
<pre>USE sales
go
sp_dboption 'sales', 'single user', true
go
DBCC SHRINKDB(sales)
go
  Current size of database Size database can be shrunk to
  ------------------------ ------------------------------
  5376                     1024
<b><i>  </i></b>
  (1 row(s) affected)
<b><i>  </i></b>
  DBCC execution completed. If DBCC printed error messages, see your 
  System Administrator.
<b><i>  </i></b></pre>
<p>
DBCC SHRINKDB reported a minimum size of 1024 pages. Because the absolute minimum is not always necessary, shrink the <i>sales</i> database to a new size of 6 MB.
<pre>DBCC SHRINKDB(sales, 3072)
go
  DBCC SHRINKDB running on database "sales"...
  DBCC execution completed. If DBCC printed error messages, see your
  System Administrator.
<b><i>  </i></b></pre>
</li>
<li>
On page 139, add the following sentence to the end of the description for the <i>datatype</i> parameter for the DECLARE statement:<p>
Datatypes that cannot be created by using the DECLARE statement are <i>text</i> and <i>image</i> datatypes.
</li>
<li>
On page 141 in the Transact-SQL Extension<b> </b>paragraph for the DELETE statement, the last sentence should be:<p>
The functionality provided is similar to that of using a correlated subquery such as a <i>search_condition</i> in the WHERE clause of a standard delete.
</li>
<li>
On page 143, the last sentence in the description for the DISK INIT statement should be:<p>
A device is an operating system file that SQL Server pre-allocates for database use.
</li>
<li>
On page 143, the description of the PHYSNAME parameter for the DISK INIT statement should be:<p>
Is the drive letter, full path, and filename of the database device. Paths for database devices must follow the rules for the operating system paths and filenames. Directories will not be created if they do not already exist. They must be enclosed with single quotation marks (<b>'</b>).
</li>
<li>
On page 143, the last sentence of the description for the SIZE parameter for the DISK INIT statement should be:<p>
If you are planning to use the new database device to create a new database, the minimum size is 1 MB (512 2K blocks).
</li>
<li>
On page 147, the last sentence of the description of the MIRROR parameter for the DISK REMIRROR statement should be:<p>
It cannot be an existing file but the path must already exist.
</li>
<li>
On page 149, the description of the NAME parameter for the DISK REMIRROR statement should be:<p>
Is the logical name of the database device that you want to resume mirroring on.
</li>
<li>
On page 149, add a note for example A:<p>
<b>Note</b>  The path to the G: drive and the SQLIMAGE directory must both exist before running the DISK REMIRROR example.
</li>
<li>
On page 150, the Note for the DISK REFIT statement should be:<p>
<b>Note</b>  If this statement is not run immediately after the DISK REINIT statement, DISK REFIT will fail. To see the complete recovery steps (DISK REINIT and then DISK REFIT), see the DISK REINIT statement examples.
</li>
<li>
On page 153, the syntax for the DISK RESIZE statement should be:<p>
DISK RESIZE<br>
NAME <b>=</b> <b>'</b><i>logical_device_name</i><b>',</b><br>
SIZE <b>=</b> <i>final_size</i>
</li>
<li>
On page 153, the description for example A should be:<p>
This example increases the size of DEVICE1 from its initial size of 12 MB to 20 MB.
</li>
<li>
On page 154, the last sentence of the second paragraph in the "Remarks" section should be:<p>
To drop a database in recovery (<i>sysdatabases..status</i> &amp; 128 = 128), use the <b>sp_dbremove</b> system stored procedure.
</li>
<li>
On page 155, in the "Remarks" section of the DROP DEFAULT statement, the second paragraph should be:<p>
After you drop a default from a column that allows null values, NULL is inserted in that position when rows are added and no value is explicitly supplied. After you drop a default from a NOT NULL column, an error message is returned when rows are added and no value is explicitly supplied. These rows are added later as part of the normal INSERT behavior.
</li>
<li>
On page 155, in the "Permission" topic of the DROP DEFAULT statement, the sentence that begins with "However" should be:<p>
However, the database owner and system administrator can drop any default object by specifying the owner in the DROP DEFAULT statement.
</li>
<li>
On page 157, the description for the DROP PROCEDURE statement should be:<p>
Removes user-created stored procedures or user-created procedure groups from the current database.
</li>
<li>
On page 158, the description for the DROP RULE statement should be:<p>
Removes a user-defined rule from a database.
</li>
<li>
On page 158, the description for the "Example" should be:<p>
This example unbinds and then drops the <i>pub_id_rule</i>.
</li>
<li>
On page 159, add the following sentence to the description for the DROP TABLE statement:<p>
Any view on the dropped table must be explicitly dropped by using the DROP VIEW statement.
</li>
<li>
On page 162, add the following sentence to the description for the DROP VIEW statement:<p>
Any view on the dropped table (dropped by using the DROP TABLE statement) must be explicitly dropped by using the DROP VIEW statement.
</li>
<li>
On page 163, add the following to the Note for the DUMP statement:<p>
A multivolume dump is when several dumps are appended to a file or tape, as opposed to each dump erasing the previous dump when the WITH INIT option is used. Multivolume and tape dumps require extra control over the storage of the data that is supported with files and tapes, that is not offered when sending the data to the pipe.
</li>
<li>
On pages 163 and 164, the sentence that begins with "However" in the description for the DATABASE parameter of the DUMP statement should be:<p>
However, because DUMP DATABASE does not remove the inactive portion of the log, you must first use DUMP TRANSACTION WITH TRUNCATE_ONLY to purge the log of completed transactions.
</li>
<li>
On page 167, the sentence that begins with "These options are used with DISK" in the Important note of the RETAINDAYS parameter for the DUMP statement should be:<p>
These options are used with DISK and TAPE devices only and are ignored on FLOPPY and PIPE devices.
</li>
<li>
On page 123, the first sentence of the NOINDEX clause description for the DBCC statement should be:<p>
Specifies that only the clustered index (the data itself) is to be checked for user-defined tables.
</li>
<li>
On page 127, add the following "Note" after the first paragraph for DBCC SHRINKDB:<p>
<b>Note</b>  DBCC SHRINKDB is not disk compaction. DBCC SHRINKDB provides an estimate of the smallest amount of disk space that the entire database, including indexes and user-defined objects, can occupy. Because indexes and user-defined objects such as views and tables consume disk space, the database may occupy more disk space than the data itself occupies. DBCC SHRINKDB is aware of the presence of indexes and user-defined objects and suggests what size the database can be reduced to given the index and objects in the database.
</li>
<li>
On page 167, in the "Remarks" section of the DUMP statement, the sentence that begins with "The dump captures" should be:<p>
The dump captures the state of the data as it is at any moment the statement is executed; partial transactions are reflected and will automatically roll back when the dump is loaded. 
</li>
<li>
On page 170, in the "Database Dumping to Novell File Servers" topic of the DUMP statement, the sentence that begins with "On the Novell file server" should be:<p>
On the Novell file server, add the GUEST account to the NTGATEWAY Group and make sure that account has complete TRUSTEE rights to the directory where the SQL Server database dump will be written.
</li>
<li>
On page 170, in the "Database Dumping to Novell File Servers" topic of the DUMP statement, the sentence that begins with "In addition" should be:<p>
In addition, the user account must be a member of the NTGATEWAY Group and must have complete TRUSTEE rights to the directory where the SQL Server database dump will be written.
</li>
<li>
On page 171, example A for the DUMP statement, the EXECUTE of <b>sp_addumpdevice</b> should be:</li>
</ul>
<pre>EXEC sp_addumpdevice 'disk', 'disk_dev1', 'c:\\dumps\diskdev1.dmp'
<b><i>  </i></b></pre>
<ul>
<li>
On page 175, the description of the <b>@</b><i>variable</i> parameter for the EXECUTE statement should be:<p>
Specifies the variable that stores a parameter or a return parameter.
</li>
<li>
On page 177, the EXEC command examples should be:<pre>EXEC( 'USE pubs' + ' ' +'SELECT * FROM authors')</pre>
<p>
OR
<pre>EXEC( 'USE pubs' + ' SELECT * FROM authors')</pre>
<p>
OR
<pre>EXEC('USE pubs SELECT * FROM authors')
<b><i>  </i></b></pre>
<p>
<b>Note</b>  In the second EXEC example, there is a space between the left quotation mark and the "S" of SELECT.
</li>
<li>
On page 178, the EXEC statement in example C for the EXAMPLE statement should be:<pre>EXEC ('DROP TABLE ' + @tablename)
<b><i>  </i></b></pre>
</li>
<li>
On page 179, the EXEC statement in example E for the EXAMPLE statement should be:<pre>EXECUTE xp_cmdshell 'dir *.exe'
<b><i>  </i></b></pre>
</li>
<li>
On page 180, the second sentence of the description of the AND parameter for the "Expressions" topic should be:<p>
Returns "true" when both expressions are true.
</li>
<li>
On page 180, the second sentence of the description of the OR parameter for the "Expressions" topic should be:<p>
Returns "true" when either condition is true.
</li>
<li>
On page 181, add the following sentence to the "Remarks" section for the "Expressions" topic:<p>
All numeric values with a decimal point are treated as <i>numeric</i> and those values without a decimal point are treated as <i>int</i>.
</li>
<li>
On page 181, add the CASE Statement to the list in the "See Also" topic for the "Expressions" topic.</li>
<li>
On page 185, add the following to the "Remarks" section for Aggregate Functions:<p>
This is a list of the results of promoted datatypes when you use Aggregate Functions.
</li>
</ul>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=20%></th>
<th align=left width=80%></th>
</tr>
<tr valign=top>
<th align=left width=20%></th>
<th align=left width=80%></th>
</tr>
<tr valign=top>
<th align=left width=20%>Datatype</th>
<th align=left width=80%>SUM or AVG is of datatype</th>
</tr>
<tr valign=top>
<td width=20%><i>tinyint</i></td>
<td width=80%><i>int</i></td>
</tr>
<tr valign=top>
<td width=20%><i>smallint</i></td>
<td width=80%><i>int</i></td>
</tr>
<tr valign=top>
<td width=20%><i>int</i></td>
<td width=80%><i>int</i></td>
</tr>
<tr valign=top>
<td width=20%><i>smallmoney</i></td>
<td width=80%><i>money</i></td>
</tr>
<tr valign=top>
<td width=20%><i>money</i></td>
<td width=80%><i>money</i></td>
</tr>
<tr valign=top>
<td width=20%><i>real</i></td>
<td width=80%><i>float</i></td>
</tr>
<tr valign=top>
<td width=20%><i>float</i></td>
<td width=80%><i>float</i></td>
</tr>
<tr valign=top>
<td width=20%><i>decimal</i></td>
<td width=80%>more precise<i> decimal</i>, if necessary</td>
</tr>
<tr valign=top>
<td width=20%><i>numeric</i></td>
<td width=80%>more precise<i> numeric</i>, if necessary</td>
</tr>
</table><br>
<ul>
<li>
On page 206, the first two sentences in the "Result" for the SOUNDEX function should be:<p>
Returns a four-character (SOUNDEX) code to evaluate the similarity of two strings. The SOUNDEX function converts an alpha string to a four-character code to find similar sounding words or names.
</li>
<li>
On page 208, the sentence that begins with "Returning" in example G for the "SOUNDEX and DIFFERENCE Functions" should be:<p>
Returning the SOUNDEX for "Smith" and "Smythe" will return the same SOUNDEX result because all vowels, the letter "y," doubled letters, and the letter "h," are not included.
</li>
<li>
On page 220, the sentence that begins with, "To enforce or remove quoted identifier" for the "Quoted Identifiers" topic should be:<p>
To enforce or remove quoted identifier and string constant resolution at the session level, use the SET QUOTED_IDENTIFIER ON statement.
</li>
<li>
On page 221, add the following sentence to the last paragraph of the "Quoted Identifiers" topic:<p>
Strings passed as parameters to extended stored procedures can be enclosed in single or double quotation marks, regardless of the QUOTED_IDENTIFIER setting.
</li>
<li>
On page 224, the last sentence of the DEFAULT VALUES clause description should be:<p>
If any column of the table does not have a default <i>and</i> does not allow null, an error is returned and the INSERT statement is rejected.
</li>
<li>
On page 244, add the following "Note" to the "Remarks" section of the "Null Values" topic:<p>
In the following example, if you try to find NULL values in columns defined as NOT NULL, SQL Server will retrieve zero rows.
<pre>CREATE TABLE t (x int NOT NULL)
go
INSERT INTO t VALUES (1)
go
SELECT * FROM t WHERE x IS NULL
<b><i>  </i></b></pre>
</li>
<li>
On page 250, the operator precedence chart should be:<ul>
<li>
Primary grouping: <b>( )</b></li>
<li>
Bitwise: <b>~</b></li>
<li>
Mutiplicative: <b>* / %</b></li>
<li>
Other: <b>+ - ^ &amp; |</b></li>
<li>
NOT</li>
<li>
AND</li>
<li>
OR</li>
</ul>
</li>
<li>
On page 266, the IDENTITY syntax of the INTO clause for the SELECT statement should be:<p>
IDENTITY<b>(</b><i>datatype</i><b>,</b> <i>n1</i><b>,</b> <i>n2</i><b>)</b>
<p>
where
<dl>
<dt>
<i>datatype</i></dt>
<dd>
Is the datatype of the column.</dd>
<dt>
<i>n1</i></dt>
<dd>
Is the first number to generate.</dd>
<dt>
<i>n2</i></dt>
<dd>
Is the increment for successive numbers.</dd>
</dl>
</li>
<li>
On page 270, the third paragraph of the description of the GROUP BY clause should be:<p>
You can use GROUP BY for a column or expression that does not appear in the <i>select_list</i>. Any column referenced in the <i>select_list</i> must also be referenced in the GROUP BY clause unless the column is being used in an aggregate function. Null values in the GROUP BY column are put into a single group when the GROUP BY column is also contained in the <i>select_list</i>.
</li>
<li>
On page 271, add the following sentence to the description of the ORDER BY clause of the SELECT statement:<p>
If SELECT DISTINCT is specified, the ORDER BY items must appear in the <i>select_list</i>.
</li>
<li>
On page 274, disregard the following statement:<p>
To allow queries that contain aggregates or a GROUP BY clause with items in the <i>select_list</i> that are not in the GROUP BY clause and are not aggregate functions, set trace flag 204.
</li>
<li>
On page 280, for the SET statement, remove the QUOTED_IDENTIFIER option.</li>
<li>
On pages 280 and 283, DEADLOCKPRIORITY should be DEADLOCK_PRIORITY.</li>
<li>
On page 282, the description for STATISTICS IO should be:<p class=indent1>
On a query-by-query basis, displays the number of scans, the number of logical reads (pages accessed in the cache), and the number of physical reads (number of times the disk was accessed) for each table referenced in the statement. Output from this procedure displays how many buffers were introduced into the cache for a particular table during a read ahead.</p>
</li>
<li>
On page 290, remove the paragraph that begins with "SQL Server can also be stopped." </li>
<li>
On page 290, the methods for stopping SQL Server should be:<ul>
<li>
SQL Enterprise Manager.</li>
<li>
NET STOP MSSQLSERVER from a Win32® command prompt.</li>
<li>
By using the Services application from the Windows NT Control Panel.</li>
<li>
By using the Windows NT Server Manager from the Windows NT Control Panel.</li>
<li>
By using the SQL Service Manager.</li>
<li>
By pressing CTRL+C if <b>sqlservr.exe</b> was started from the command-line.</li>
</ul>
<p>
<b>Note</b>  The SQL Enterprise Manager, NET STOP, and Control Panel methods of stopping SQL Server produce the identical service control message of SERVICE_CONTROL_STOP to SQL Server.
</li>
<li>
On page 290, the sentence that begins with "Each of these" in the "Remarks" section of the SHUTDOWN statement should be:<p>
Each of these performs a checkpoint in all databases. All committed data from data cache is flushed, and then the server is stopped.
</li>
<li>
On page 308, the list of <b>ATTRIBUTE_ID</b>s for the <b>sp_server_info</b> catalog stored procedure should be:</li>
</ul>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=23%></th>
<th align=left width=41%></th>
<th align=left width=36%></th>
</tr>
<tr valign=top>
<th align=left width=23%></th>
<th align=left width=41%></th>
<th align=left width=36%></th>
</tr>
<tr valign=top>
<th align=left width=23%><br>
ATTRIBUTE_ID</th>
<th align=left width=41%>ATTRIBUTE_NAME <br>
description</th>
<th align=left width=36%><br>
ATTRIBUTE_VALUE</th>
</tr>
<tr valign=top>
<td width=23%>13</td>
<td width=41%>TABLE_LENGTH<p>
Specifies the maximum number of characters for a table name.</p>
</td>
<td width=36%>30</td>
</tr>
<tr valign=top>
<td width=23%>14</td>
<td width=41%>MAX_QUAL_LENGTH<p>
Specifies the maximum length of the name for a table qualifier (the first part of a three-part table name).</p>
</td>
<td width=36%>30</td>
</tr>
<tr valign=top>
<td width=23%>15</td>
<td width=41%>COLUMN_LENGTH<p>
Specifies the maximum number of characters for a column name.</p>
</td>
<td width=36%>30</td>
</tr>
<tr valign=top>
<td width=23%>16</td>
<td width=41%>IDENTIFIER_CASE<p>
Specifies the user-defined names (table names, column names, stored procedure names) in the database (the case of the objects in the system catalogs).</p>
</td>
<td width=36%>MIXED or SENSITIVE, depending upon whether SQL Server is set to case-sensitive or case-insensitive.</td>
</tr>
<tr valign=top>
<td width=23%>17</td>
<td width=41%>TX_ISOLATION<p>
Specifies the initial transaction isolation level the server assumes, which corresponds to an isolation level defined in ANSI SQL-92.</p>
</td>
<td width=36%>2</td>
</tr>
<tr valign=top>
<td width=23%>18</td>
<td width=41%>COLLATION_SEQ<p>
Specifies the ordering of the character set for this server.</p>
</td>
<td width=36%>charset ID</td>
</tr>
<tr valign=top>
<td width=23%>19</td>
<td width=41%>SAVEPOINT_SUPPORT<p>
Specifies whether the underlying DBMS supports named savepoints.</p>
</td>
<td width=36%>Y</td>
</tr>
<tr valign=top>
<td width=23%>20</td>
<td width=41%>MULTI_RESULT_SETS<p>
Specifies whether the underlying database or the gateway itself supports multiple results sets (multiple statements can be sent through the gateway with multiple results sets returned to the client).</p>
</td>
<td width=36%>Y</td>
</tr>
<tr valign=top>
<td width=23%>22</td>
<td width=41%>ACCESSIBLE_TABLES<p>
Specifies whether in the <b>sp_tables</b> stored procedure, the gateway returns only tables, views, and so on that are accessible by the current user (that is, the user who has at least SELECT privileges for the table).</p>
</td>
<td width=36%>Y</td>
</tr>
<tr valign=top>
<td width=23%>100</td>
<td width=41%>USERID_LENGTH<p>
Specifies the maximum number of characters for a username.</p>
</td>
<td width=36%>30</td>
</tr>
<tr valign=top>
<td width=23%>101</td>
<td width=41%>QUALIFIER_TERM<p>
Specifies the DBMS vendor term for a table qualifier (the first part of a three-part name).</p>
</td>
<td width=36%>Database</td>
</tr>
<tr valign=top>
<td width=23%>102</td>
<td width=41%>NAMED_TRANSACTIONS<p>
Specifies whether the underlying DBMS supports named transactions.</p>
</td>
<td width=36%>Y</td>
</tr>
<tr valign=top>
<td width=23%>103</td>
<td width=41%>SPROC_AS_LANGUAGE<p>
Specifies whether stored procedures can be executed as language events.</p>
</td>
<td width=36%>Y</td>
</tr>
<tr valign=top>
<td width=23%>104</td>
<td width=41%>ACCESSIBLE_SPROC<p>
Specifies whether in the <b>sp_stored_procedures</b> stored procedure, the gateway returns only stored procedures that are executable by the current user.</p>
</td>
<td width=36%>Y</td>
</tr>
<tr valign=top>
<td width=23%>105</td>
<td width=41%>MAX_INDEX_COLS<p>
Specifies the maximum number of columns in an index for the DBMS.</p>
</td>
<td width=36%>16</td>
</tr>
<tr valign=top>
<td width=23%>106</td>
<td width=41%>RENAME_TABLE<p>
Specifies whether tables can be renamed.</p>
</td>
<td width=36%>Y</td>
</tr>
<tr valign=top>
<td width=23%>107</td>
<td width=41%>RENAME_COLUMN<p>
Specifies whether columns can be renamed.</p>
</td>
<td width=36%>Y</td>
</tr>
<tr valign=top>
<td width=23%>108</td>
<td width=41%>DROP_COLUMN<p>
Specifies whether columns can be dropped.</p>
</td>
<td width=36%>N</td>
</tr>
<tr valign=top>
<td width=23%>109</td>
<td width=41%>INCREASE_COLUMN_LENGTH<p>
Specifies whether column size can be increased.</p>
</td>
<td width=36%>N</td>
</tr>
<tr valign=top>
<td width=23%>110</td>
<td width=41%>DDL_IN_TRANSACTION<p>
Specifies whether DDL statements can appear in transactions.</p>
</td>
<td width=36%>Returns Y if SQL Server version 6.5 or later is running and N for earlier releases.</td>
</tr>
<tr valign=top>
<td width=23%>111</td>
<td width=41%>DESCENDING_INDEXES<p>
Specifies whether descending indexes are supported.</p>
</td>
<td width=36%>N</td>
</tr>
<tr valign=top>
<td width=23%>112</td>
<td width=41%>SP_RENAME<p>
Specifies whether a stored procedure can be renamed.</p>
</td>
<td width=36%>Y</td>
</tr>
<tr valign=top>
<td width=23%>113</td>
<td width=41%>REMOTE_SPROC<p>
Specifies whether stored procedures can be executed through the remote stored procedure functions in DB-Library.</p>
</td>
<td width=36%>Y</td>
</tr>
<tr valign=top>
<td width=23%>500</td>
<td width=41%>SYS_SPROC_VERSION<p>
Specifies the version of the catalog stored procedures currently implemented.</p>
</td>
<td width=36%>Current version number</td>
</tr>
<tr valign=top>
<td width=23%></td>
<td width=41%></td>
<td width=36%></td>
</tr>
</table><br>
<ul>
<li>
On page 330, for example D, the text <br>
(<b>@</b>result = 1) should be replaced with (<b>@</b>result = 0) as follows:<pre>DECLARE @result int
EXECUTE @result = xp_cmdshell 'dir *.exe'
IF (@result = 0)
PRINT 'Success'
ELSE
PRINT 'Failure'
<b><i>  </i></b></pre>
<p>
The exit code of the invoked program, 'dir *.exe' in the example above is stored in the variable <b>@</b>return. If <b>@</b>result is 0, either no exit code was returned or a 0 was returned. In the example above, 'dir *.exe' can be replaced with 'myprog.exe'.
</li>
<li>
On page 333, the second sentence of the definition for <b>@</b>unread_only for the <b>xp_findnextmsg</b> extended stored procedure should be:<p>
The default is <b>false.</b>
</li>
<li>
On page 342, the syntax for the <b>@</b>unread parameter for the <b>xp_readmail</b> extended stored procedure should be:<p>
[<b>,</b> <b>@</b>unread <b>=</b> {<b>'true' </b>|<b> 'false'</b>} OUTPUT]
</li>
<li>
On page 343, the definition for the <b>@</b>unread parameter of the <b>xp_readmail </b>extended stored procedure should be:<p>
Specifies that a message has not been previously read.
</li>
<li>
On page 343, add the following to the "Remarks" section for the <b>xp_readmail</b> extended stored procedure:<p>
There are two ways to use <b>xp_readmail</b>:
<ol>
<li>
Return the contents of the Inbox as a result set to the client.</li>
<li>
Read a single message from the Inbox.</li>
</ol>
<p>
To return the contents of the Inbox as a result set to the client either set <b>@</b>msg_id to NULL or do not include <b>@</b>msg_id. In this situation, <b>@</b>type can be used to read specific messages. You can specify <b>@</b>peek and <b>@</b>supress_attach as input parameters to control the way the message is read.
<p>
To read a single message from the Inbox, supply a valid <b>@</b>msg_id that is returned by <b>xp_findnextmsg</b> as an input parameter to <b>xp_readmail</b>. You can specify <b>@</b>peek and <b>@</b>supress_attach as input parameters to control the way the message is read. When using <b>@</b>peek and <b>@</b>supress_attach with this method, all other parameters are optional output parameters that contain specific information from the message to be read.
<p>
You can view an example of using <b>xp_findnextmsg</b> as an input parameter to <b>xp_readmail</b> by executing the following command:
<pre>sp_helptext 'sp_processmail'
<b><i>  </i></b></pre>
<p>
When used to read a single message, <b>xp_readmail</b> can read message text of longer than 255 bytes in sections. Use <b>@</b>msg_length and <b>@</b>skip_bytes to read message text of longer than 255 bytes in sections. Using <b>@</b>skip_bytes as both an input and output parameter allows easy coding of a loop to process the entire message text. The following code shows an example of such a loop, assuming <b>@</b>msg_id is set to a valid message identifier returned by <b>xp_findnextmsg</b>:
<pre>WHILE (1=1)
BEGIN
EXECUTE @status = xp_readmail @msg_id = @msg_id,
@message = @message OUTPUT,
@skip_bytes = @skip_bytes OUTPUT,
@msg_length = @msg_length OUTPUT
<b><i>  </i></b>
IF @status &lt;&gt; 0 BREAK
SELECT 'msg_id' = @msg_id, 'msg_part' = @message
IF @skip_bytes = @msg_length BREAK
END
<b><i>  </i></b></pre>
</li>
<li>
On page 346, the @recipient for <b>xp_sendmail</b> should be @recipients in both the syntax diagram and the definition for the @recipient parameter.</li>
<li>
On page 348, add the following to the "Remarks" section for <b>xp_sendmail</b>:<p>
The <b>xp_sendmail</b> extended stored procedure runs in SQL Server's security context which is a local administrator account by default. A valid user of <b>xp_sendmail</b> can access files for attachment to a mail message in an administrator's security context. If non-system administrator users need access to <b>xp_sendmail</b> and you wish to guard against unsecured access to attachment files, the system administrator can create a stored procedure that calls <b>xp_sendmail</b> and provides the needed functionality but does not expose the <b>@</b>attachments parameter. This stored procedure must be defined in the <i>master</i> database. The system administrator then grants execute permission on the stored procedure to the users necessary without granting permssion to the underlying <b>xp_sendmail</b> procedure.
</li>
<li>
On page 366, the syntax for <b>sp_addsubscription</b> should be:<p>
<b>sp_addsubscription</b> <i>publication</i> [<b>,</b> <b>'</b><i>article</i><b>'</b>]<b>, </b><i>subscriber</i> [<b>,</b><i> destination_db</i>]
<p>
[<b>,</b> <b>@</b>sync_type <b>=</b> {<b>'automatic'</b> | <b>'manual'</b> | <b>'none'</b>}]
<p>
[<b>,</b> <b>@</b>status <b>=</b> {<b>'inactive' </b>| <b>'active'</b> | <b>'subscribed'</b>}
</li>
<li>
On page 371, add the following to the "Remarks" section for the <b>sp_articleview</b> replication stored procedure:<p>
If you use <b>sp_articleview</b> on a base table that is not vertically partitioned, the article view will be created.
</li>
<li>
On page 405, disregard the example for the <b>sp_replstatus</b> replication stored procedure.</li>
<li>
On page 418, add the following sentences to the description of the <i>server</i> parameter of the <b>sp_addtask</b> executive stored procedure:<p>
For use with replication tasks only. Transact-SQL and CmdExec tasks are executed only locally.
</li>
<li>
On page 418, the <b>sp_addtask </b><i>server</i> parameter is to be used only for replication tasks and should be so indicated in the procedure description.</li>
<li>
On page 458, for <b>sp_addtype</b>, the <i>nulltype</i> argument must be enclosed in single quotation marks (<b>'</b>NOT NULL<b>'</b>). The syntax remark for <i>nulltype</i> must indicate the need for quotation marks and the example should be:<pre>sp_addtype ssn, 'VARCHAR(11)', 'NOT NULL'
<b><i>  </i></b></pre>
</li>
<li>
On page 475, the time slice <i>config_name</i> for <b>sp_configure</b> has been removed.</li>
<li>
On page 499, add the following sentence to the "Remarks" section for <b>sp_defaultdb</b>:<p>
It is recommended that this procedure be used to change the default database for all users other than the system administrator.
</li>
<li>
On page 581, the descriptions for the first two <i>texttype</i> column attributes in the <i>syscomments<b> </b></i>table should be:<ol>
<li>
User-supplied comment (users can add entries that describe an object or column).</li>
<li>
System-supplied comment (for views, rules, defaults, triggers, and stored procedures).</li>
</ol>
</li>
<li>
On page 588, the <i>userstat</i> column for the <i>sysobjects</i> system table should have a description of "Reserved."</li>
<li>
On page 604, add the following description for the <i>status</i> column of the <i>sysdatabases</i> system table:<p>
A <i>status</i> of 512 indicates Offline.
</li>
<li>
On page 604, the emergency mode status for the <i>sysdatabases</i> system table description should be -32768.</li>
<li>
On page 633, the description for the <i>activestarttimeofday</i> column in the <i>systasks</i> reference table should be:<dl>
<dt>
<i>activestarttimeofday        </i>The time of day when this task is <i>no longer</i> active.</dt>
</dl>
</li>
</ul>
<pre></pre>
<ul>
<li>
On page 637, add the following sentence to the "Remarks" section for READTEXT:<p>
When reading <i>image</i> columns, ISQL/w internally limits the length of <i>image</i> columns to 255 characters. Reduction of the <i>image</i> length reduces the likelihood that Windows 95 - based text-drawing APIs and graphics drivers will exceed their character-per-line maximum.
</li>
<li>
On page 648, add the following sentence to the second paragraph for the "Remarks" section of the ROLLBACK TRANSACTION statement:<p>
A <i>savepoint_name</i> can be issued multiple times during a single transaction, and a rollback to that <i>savepoint_name</i> will roll back only to the most recent issuance point.
</li>
<li>
On page 661, example C, the UPDATE statement examples should be:<pre>UPDATE titles
SET ytd_sales = ytd_sales + qty
FROM titles, sales
WHERE titles.title_id = sales.title_id
AND sales.ord_date = (SELECT MAX(sales.ord_date) FROM sales)
<b><i>  </i></b>
UPDATE titles
SET ytd_sales = 
(SELECT SUM(qty)
FROM sales
WHERE sales.title_id = titles.title_id
AND sales.ord_date IN (SELECT MAX(ord_date) FROM sales))
FROM titles, sales
<b><i>  </i></b></pre>
</li>
<li>
On page 678, the last bullet for the <b>isql</b> utility should be:<ul>
<li>
Using the RAISERROR statement with a state of 127. If RAISERROR is used within an <b>isql</b> script and a state of 127 is raised, <b>isql<i> </i></b>terminates and returns the error message ID back to the client. For example:</li>
</ul>
<pre>RAISERROR('No error, but we won't send anymore batches',0,127)
<b><i>  </i></b></pre>
<p class=indent1>
This error causes the <b>isql</b> script to terminate and the message stated is returned to the client.</p>
<p>
<b>Note</b>  It is recommended that you use a severity of 0 when printing a non-error message and that you allow SQL Server severity levels of 1 through 10.
</li>
<li>
On page 683, the second sentence in the description for the <i>datatype</i> parameter of the DECLARE statement should be:<p>
A variable cannot be of <i>image</i> or <i>text</i> datatypes.
</li>
<li>
On page 692, in the System Catalog diagram, the data rows show that <i>syscurconfigs</i> is a superset of <i>sysconfigures</i>. The relationship line should be reversed to run from <i>syscurconfigs</i> to <i>sysconfigures</i>.</li>
<li>
On page 693, in the System Catalog diagram, one relationship line extends from <i>systypes</i> to <i>syscolumns</i> and is labeled "type, usertype." The main normal relationship should be labeled "usertype." A second relationship from <i>systypes</i> to <i>syscolumns</i><b> </b>involving "type" exists, but it is separate from the "usertype" relationship.</li>
<li>
On page 693, the <i>systypes</i> System Catalog diagram should have "name" as an alternate key.</li>
<li>
On page 693, the relationship from <i>syscolumns</i> to <i>sysconstraints</i> should be "id, colid." The "id" corresponds with the "id" column from <i>sysobjects</i>.</li>
<li>
On pages 698 and 699, author names in the <i>authors</i> table should be:<p>
Carlos Hernandez
<p>
Rita Muller
<p>
Martine Rance
<p>
Martin Sommer
</li>
<li>
On page 702, the state referenced in the <i>pr_info </i>column for <i>pub_id </i>0736 in the <i>pubs </i>database should be Massachusetts.</li>
<li>
</li>
</ul>
<p>&nbsp;</p></body>
</HTML>
