<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>msdb Tables</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_msdb_tables"></a><i>msdb </i>Tables</h1>
<p>
In SQL Server 6.5, tables have been added to the <i>msdb</i> database to aid in maintaining backup information. These are the new tables.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=33%></th>
<th align=left width=67%></th>
</tr>
<tr valign=top>
<th align=left width=33%></th>
<th align=left width=67%></th>
</tr>
<tr valign=top>
<th align=left width=33%>Table name</th>
<th align=left width=67%>Description</th>
</tr>
<tr valign=top>
<td width=33%><a href="addsproc_7cmk.htm"><i>sysbackupdetail</i></a></td>
<td width=67%>Specifies a summary of the devices used to backup (dump).</td>
</tr>
<tr valign=top>
<td width=33%><a href="addsproc_1pmh.htm"><i>sysbackuphistory</i></a></td>
<td width=67%>Specifies a summary of each backup operation (dump).</td>
</tr>
<tr valign=top>
<td width=33%><a href="addsproc_7oz0.htm"><i>sysrestoredetail</i></a></td>
<td width=67%>Specifies a summary of the devices used to restore (load).</td>
</tr>
<tr valign=top>
<td width=33%><a href="addsproc_3nqx.htm"><i>sysrestorehistory</i></a></td>
<td width=67%>Specifies a summary of each restore operation (load).</td>
</tr>
</table><br>
<p>
SQL Server automatically maintains a complete online backup and restore history in the <i>msdb</i> database. This information includes who performed the backup, at what time, and on which devices or files it is stored. </p>
<p>
Backup and restore events are recorded even if they were created with custom applications or third-party tools. A Visual Basic application that calls SQL-DMO objects to perform backup and restore operations will cause the events to be logged in these tables.</p>
<p>
After each DUMP statement is executed, a description of the dump is saved in <i>sysbackuphistory</i> and the dump device details are saved in <i>sysbackupdetail </i>as part of a single transaction. </p>
<p>
After each LOAD statement is executed, a description of the restore is saved in <i>sysrestorehistory</i> and the device details are saved in <i>sysrestoredetail</i>. If for any reason the history cannot be written to <i>msdb</i> database, a message is written to the Windows NT event log and to the SQL Server error log.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
