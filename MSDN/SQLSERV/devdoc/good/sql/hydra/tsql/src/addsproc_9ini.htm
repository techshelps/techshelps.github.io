<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_bindsession</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_bindsession"></a>sp_bindsession (version 6.5)</h2>
<p>
Binds or unbinds a connection to other connections. A bound connection allows two or more connections to participate in the same transaction and share the transaction space until a ROLLBACK TRANSACTION or COMMIT TRANSACTION is issued. </p>
<p>
For more information about bound connections, see <a href="addnfeat_6u7n.htm">Bound Connections</a> earlier in this document.</p>
<h4>Syntax</h4>
<p>
<b>sp_bindsession</b> {<b>'</b><i>bind_token</i><b>'</b> | <b>'</b>NULL<b>'</b>}</p>
<p>
where
<dl>
<dt>
<i>bind_token</i></dt>
<dd>
Specifies the token that identifies the transaction space originally obtained by using the <b>sp_getbindtoken</b> stored procedure or the <b>srv_getbindtoken</b> Open Data Services function. The <i>bind_token </i>supports a maximum of 255 characters and must have a <i>varchar</i> datatype.
<p>
For more information, see <a href="../../program/src/ods_1966.htm"><b>srv_getbindtoken</b></a> later in this document.

</dd>
</dl>
<h4>Remarks</h4>
<p>
This procedure uses a bind token to bind two or more existing client connections together. A connection is a client executing a command. Multiple cooperating database connections allow sharing of a common transaction lock space by being bound together to share a transaction context and lock space.</p>
<p>
<b>Note</b>  If a connection involved in a local transaction executes a remote procedure call (RPC) on a remote server with SET REMOTE_PROC_TRANSACTIONS ON, the local transaction is promoted to a distributed transaction by Microsoft Distributed Transaction Coordinator (MS DTC) and an MS DTC session starts. When the transaction is promoted, the bind token changes to a distributed token identification number. Use the changed token identification number.</p>
<p>
Unbind from a session either by omitting the <i>bind_token </i>parameter or by passing NULL as the <i>bind_token</i> parameter.</p>
<p>
This procedure can be executed through ODBC, DB-LIBRARY functions, or <b>isql</b>.</p>
<p>
<b>Important</b>  Prior to executing <b>sp_bindsession</b>, you must obtain a bind token by running <b>sp_getbindtoken</b> or the Open Data Services <b>srv_getbindtoken</b> function.</p>
<p>
For information about obtaining a bind token, see <a href="addsproc_338u.htm"><b>sp_getbindtoken</b></a>, later in this document.</p>
<p>
For more information about the <a href="../../admin/src/adminwn_2982.htm">Microsoft Distributed Transaction Coordinator (MS DTC)</a>, see the <i>Guide to Microsoft Distributed Transaction Coordinator</i>.</p>
<h4>Permission</h4>
<p>
To obtain and pass a bind token, run <b>sp_getbindtoken</b> prior to executing <b>sp_bindsession </b>for sharing the same lock space. If you obtain a bind token, <b>sp_bindsession</b> will run correctly.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
