<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_helprotect</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_helprotect"></a>sp_helprotect (version 6.5)</h2>
<p>
Reports on user permissions for an object and includes SELECT, execute, and access permissions for a given object.</p>
<p>
For additional syntax information for <a href="../../../tsqlref/src/tsql23_7n51.htm"><b>sp_helprotect</b></a>, see the <i>Microsoft SQL Server Transact-SQL Reference</i>. </p>
<h4>Syntax</h4>
<p>
<b>sp_helprotect </b>[<i>OwnerObject_Statement_Name_Pattern </i>[<b>, </b><i>GranteeName</i> [<b>, </b><i>GrantorName</i> [<b>, </b><i>PermissionsCategories</i>]]]]</p>
<p>
where
<dl>
<dt>
<i>OwnerObject_Statement_Name_Pattern</i></dt>
<dd>
Is the name of an object and/or statement for which permissions can be granted: the parameter <i>PermissionCategories</i> determines which permissions will be granted to the object or statement. The name can be any pattern understandable to the LIKE operator.
<p>
For more information on the LIKE operator, see <a href="../../../tsqlref/src/tsql30_6far.htm">Wildcard Characters</a> in the <i>Microsoft SQL Server Transact-SQL Reference</i>.

<p>
An object name of <b>'</b>tb217[_]Customer<b>'</b> can be used to focus on one table. For a broader report use <b>'</b>tb<b>%'</b> or <b>'%</b>cust<b>%'</b>. An owner name can be used to qualify the object name, such as in <b>'</b>dbo.vwBudget<b>'</b> or <b>'</b>Patia<b>%</b>.pc<b>%'</b>. A database name cannot be used as a qualifier in this parameter; instead, rely upon the current database context. The default is <b>'%'</b>.
</dd>
<dt>
<i>GranteeName</i></dt>
<dd>
Is the name of the person who has permission to access the database object. This value can be any pattern that is understood by the LIKE operator (NULL is not accepted). As the GRANT statement syntax implies, <i>users</i>, <i>guest</i>, <i>groups</i>, and <i>public</i> can all be grantees. The default is <b>'%'</b>.</dd>
<dt>
<i>GrantorName</i></dt>
<dd>
Is the name of the grantor to the database object. The grantor is anyone who has authority to grant another person (the grantee) access to an object. This value can be any pattern that is understood by the LIKE operator (NULL is not accepted). Only members of the <i>users</i> group can be grantors. The default is <b>'%'</b>. </dd>
<dt>
<i>PermissionsCategories</i></dt>
<dd>
Is a string of single letters that determines which categories will be reported. This determines the interpretation of the first parameter. These are the supported categories of permissions.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=25%></th>
<th align=left width=75%></th>
</tr>
<tr valign=top>
<th align=left width=25%></th>
<th align=left width=75%></th>
</tr>
<tr valign=top>
<th align=left width=25%>Categories</th>
<th align=left width=75%>Permissions</th>
</tr>
<tr valign=top>
<td width=25%>O</td>
<td width=75%>Object.</td>
</tr>
<tr valign=top>
<td width=25%>S</td>
<td width=75%>Statement.</td>
</tr>
<tr valign=top>
<td width=25%>OS</td>
<td width=75%>All categories are available (the default).</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
The output report is sorted by permission category, owner, object, grantee, grantor, protection type category, protection type, action, and column sequential ID.</p>
<p>
These are the special values that can appear in the report. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=20%></th>
<th align=left width=80%></th>
</tr>
<tr valign=top>
<th align=left width=20%></th>
<th align=left width=80%></th>
</tr>
<tr valign=top>
<th align=left width=20%>Value</th>
<th align=left width=80%>Description</th>
</tr>
<tr valign=top>
<td width=20%><b>(All)</b></td>
<td width=80%>Indicates that the privilege covers all current columns of the object.</td>
</tr>
<tr valign=top>
<td width=20%><b>(New)</b></td>
<td width=80%>Indicates that the privilege covers any new columns that might be altered (by using the ALTER statement) on the object in the future.</td>
</tr>
<tr valign=top>
<td width=20%><b>(All+New)</b></td>
<td width=80%>Indicates a combination of <b>All</b> and <b>New</b>.</td>
</tr>
</table><br>
<p>
The width of each column in the output report will be reduced to the length of the longest data value under each column. No data values are truncated.</p>
<p>
If this procedure completes successfully, 0 is returned. If an error occurs, 1 is returned.</p>
<h4>Example</h4>
<p>
This example reports all permissions except those for DBO objects that begin with the letter <i>T</i> and grantor names that begin with the letter <i>d</i>.</p>
<pre>sp_helprotect 'dbo.[^Tt]%',default,'[^d]%','O' 
<b><i>  </i></b></pre>
<h4>Permission</h4>
<p>
Execute permission is granted to the <i>public</i> group during installation or upgrade.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
