<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BEGIN DISTRIBUTED TRANSACTION Statement</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_begin_distributed_transaction"></a>BEGIN DISTRIBUTED TRANSACTION Statement (version 6.5)</h2>
<p>
Begins a distributed transaction. </p>
<h4>Syntax</h4>
<p>
BEGIN DISTRIBUTED TRANsaction [<i>transaction_name</i>]</p>
<p>
where
<dl>
<dt>
BEGIN DISTRIBUTED TRANSACTION</dt>
<dd>
Specifies that a distributed transaction managed by Microsoft Distributed Transaction Coordinator (MS DTC) starts.</dd>
<dt>
<i>transaction_name</i></dt>
<dd>
Specifies a user-defined transaction name is used to track the distributed transaction within MS DTC utilities.</dd>
</dl>
<h4>Remarks</h4>
<p>
The BEGIN DISTRIBUTED TRANsaction statement is used instead of the BEGIN TRANsaction statement when a transaction is to be processed on one or more remote servers. The command alerts MS DTC to manage the transaction processing on the local and remote servers.  </p>
<p>
For example, suppose a company has several marketing departments in different physical locations. At each location a server is running a database. The company headquarter database records the company marketing budget and the amounts of money that subsidiary offices have to produce events and run their various departments. Each subsidiary's database allocates budget and costs. When the company's headquarters issues a check to the subsidiary, headquarters records the debit to its local database and also credits the database on the remote subsidiary's server. If the transaction fails, then the transaction must not be recorded on one server and not the other. The BEGIN DISTRIBUTED TRANsaction statement protects the transaction so that records of the budget cannot be lost between servers.  </p>
<p>
The BEGIN DISTRIBUTED TRANsaction statement requests that the MS DTC begin a new transaction and enlist the requester in that transaction.  </p>
<p>
The requester who issued the BEGIN DISTRIBUTED TRANsaction statement is the transaction originator, and a subsequent COMMIT TRANsaction statement causes the server to ask the MS DTC to start the commit sequence. The MS DTC transactions started by SQL Server cannot be exported to other servers because the client is not able to pass the transaction object from one server to another server. </p>
<p>
To protect server-to-server remote procedure calls (RPCs) under MS DTC control without changing existing applications, a server configuration option is provided, <b>remote proctrans</b> in <b>sp_configure</b>, to implicitly create MS DTC transactions that cover server-to-server RPCs.  </p>
<p>
The session-level SET option, REMOTE_PROC_TRANSACTIONS,  overrides the server default established by <b>sp_configure</b>. With this option in effect, an MS DTC transaction is created to cover an RPC if an MS DTC transaction does not exist. The server that creates the MS DTC transaction becomes the originating site for the transaction. Provided any nested transactions have been committed, the COMMIT TRANsaction initiates an MS DTC coordinated commit. </p>
<p>
For more information about the distributed transaction environment and process, see the <i>Guide to Microsoft Distributed Transaction Coordinator.</i> </p>
<h4>Example</h4>
<p>
This example updates the author's last name on the local and remote databases. The local and remote databases will both either commit or roll back the transaction. </p>
<pre>BEGIN DISTRIBUTED TRANSACTION
UPDATE authors
    SET au_lname = 'McDonald' WHERE au_id = '409-56-7008'
EXECUTE remote.pubs.dbo.changeauth_lname '409-56-7008','McDonald'
COMMIT TRAN
GO
<b><i>  </i></b></pre>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
