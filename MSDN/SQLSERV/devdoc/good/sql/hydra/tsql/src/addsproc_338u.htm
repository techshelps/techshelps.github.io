<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_getbindtoken</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_getbindtoken"></a>sp_getbindtoken (version 6.5)</h2>
<p>
Creates a bound connection context and returns a unique identifier for the created context. This unique identifier is referred to as a bind token. This system stored procedure returns a string representation to use as a token for a shared transaction between two clients.</p>
<h4>Syntax</h4>
<p>
<b>sp_getbindtoken</b> <i>return_value</i> OUTPUT [<b>, </b><i>@for_xp_flag</i>]</p>
<p>
where
<dl>
<dt>
<i>return_value</i> OUTPUT</dt>
<dd>
Is the token to use to share a transaction context. This parameter can have a maximum of 255 characters and must have a <i>varchar</i> datatype.</dd>
<dt>
<b>@</b><i>for_xp_flag</i></dt>
<dd>
Specifies a literal constant. If equal to 1, creates a bind token that can be passed to an extended stored procedure to call back into the server.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The bind token can be used with <b>sp_bindsession</b> to bind new sessions to the same transaction context. Sessions on one SQL Server that are bound to the same transaction context share a single-transaction lock space during each session.</p>
<p>
To obtain and pass a bind token, you must run <b>sp_getbindtoken</b> prior to executing <b>sp_bindsession </b>for sharing the same lock space. If you obtain a bind token, <b>sp_bindsession</b> will run correctly.</p>
<p>
If a literal constant is not used for the <b>@</b>for_xp_flag parameter, you will receive the following error message:</p>
<pre>Msg 214, Level 16, State 1, Server &lt;server_name&gt;, Procedure &lt;procedure_name&gt;, Line 5
Cannot convert parameter @for_xp_flag to type constant expected by procedure.
<b><i>  </i></b></pre>
<p>
<b>Note</b>  It is recommended that you use the <b>srv_getbindtoken</b> Open Data Services API to obtain a bind token to be used from an extended stored procedure.</p>
<p>
For more information about sharing a transaction context and binding connections, see <a href="addsproc_9ini.htm"><b>sp_bindsession</b></a>.</p>
<p>
For more information about the <b>srv_getbindtoken</b> Open Data Services API, see <a href="../../program/src/ods_2ecz.htm">What's New for Open Data Services</a> later in this document.</p>
<h4>Examples</h4>
<h5>A.&nbsp;&nbsp;&nbsp;&nbsp;Obtain Bind Token</h5>
<p>
This example obtains a bind token and displays the bind token name.</p>
<pre>DECLARE @bind_token varchar(255)
EXECUTE sp_getbindtoken @bind_token OUTPUT
SELECT @bind_token AS Token
<b><i>  </i></b></pre>
<p>
This is the results set:</p>
<pre>Token
----------------------------------------------------------
\0]---5^PJK51bP&lt;1F&lt;-7U-]ANZ
<b><i>  </i></b></pre>
<p>
<b>Note</b>  Your bind token name will differ from the results displayed above.</p>
<h5>B.&nbsp;&nbsp;&nbsp;&nbsp;Use @for_xp_flag Parameter</h5>
<p>
This example specifies a literal constant to use for calling back to the server.</p>
<pre>DECLARE @bind_token varchar(255)
EXECUTE sp_getbindtoken @bind_token OUTPUT, 1
SELECT @bind_token AS Token</pre>
<p>
For more information about binding connections, see <a href="addsproc_9ini.htm"><b>sp_bindsession</b></a>, earlier in this document. </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
