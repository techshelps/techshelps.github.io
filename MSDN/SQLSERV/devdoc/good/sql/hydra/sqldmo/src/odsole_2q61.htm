<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>sp_OAGetProperty</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_sp_oagetproperty"></a>sp_OAGetProperty</h2>
<p>
Gets a property value of an OLE object.</p>
<h4>Syntax</h4>
<p>
<b>sp_OAGetProperty</b> <i>objecttoken</i><b>,</b> <i>propertyname</i><b>,</b> [<i>propertyvalue</i> OUTPUT <br>
[<b>,</b> <i>index</i>...]]</p>
<p>
where
<dl>
<dt>
<i>objecttoken</i></dt>
<dd>
Is the object token of an OLE object previously created by <b>sp_OACreate</b>.</dd>
<dt>
<i>propertyname</i></dt>
<dd>
Is the property name of the OLE object to return.</dd>
<dt>
<i>propertyvalue </i>OUTPUT</dt>
<dd>
Is the returned property value. If specified, it must be a local variable of the appropriate datatype.</dd>
<dt>
<i>index</i></dt>
<dd>
Is an index parameter. If specified, it must be a value of the appropriate datatype.
<p>
Some properties have parameters. They are called indexed properties, and the parameters are called index parameters. A property can have multiple index parameters.
</dd>
</dl>
<h4>Remarks</h4>
<p>
If the property returns a single value, either:
<ul>
<li>
Specify a local variable for <i>propertyvalue</i>. The property value is returned in the local variable.<p>
Or
</li>
<li>
Do not specify <i>propertyvalue</i>. The property value is returned to the client as a single-column, single-row results set.</li>
</ul>
<p>
If the property returns an OLE object, you must specify a local variable of datatype <i>int</i> for the <i>propertyvalue</i> parameter. An object token will be stored in the local variable, and this object token can be used with other OLE Automation stored procedures.</p>
<p>
If the property returns an array with one or two dimensions, the array will be returned to the client as a results set as follows:
<ul>
<li>
A one-dimensional array is returned to the client as a single-row results set with as many columns as there are elements in the array. In other words, the array is returned as (columns).</li>
<li>
A two-dimensional array is returned to the client as a results set with as many columns as there are elements in the first dimension of the array and with as many rows as there are elements in the second dimension of the array. In other words, the array is returned as (columns, rows).</li>
</ul>
<p>
When the property returns an array, if <i>propertyvalue</i> is specified, it is set to NULL.</p>
<p>
If <i>propertyvalue</i> is specified, but the property does not return a value, an error occurs. If the property returns an array with more than two dimensions, an error occurs.</p>
<p>
You can also use <b>sp_OAMethod</b> to get a property value.</p>
<p>
This procedure returns a 0 when successful or a non-zero HRESULT when an error occurs.</p>
<h4>Examples</h4>
<h5>A.&nbsp;&nbsp;&nbsp;&nbsp;Use Local Variable</h5>
<p>
This example gets the HostName property (of the previously created SQLServer object) and stores it in a local variable.</p>
<pre>DECLARE @property varchar(255)
EXEC @hr = sp_OAGetProperty @object, 'HostName', @property OUT
IF @hr &lt;&gt; 0
BEGIN
    EXEC sp_displayoaerrorinfo @object, @hr
    RETURN
END
PRINT @property
<b><i>  </i></b></pre>
<h5>B.&nbsp;&nbsp;&nbsp;&nbsp;Use Results Set</h5>
<p>
This example gets the HostName property (of the previously created SQLServer object) and returns it to the client as a results set.</p>
<pre>EXEC @hr = sp_OAGetProperty @object, 'HostName'
IF @hr &lt;&gt; 0
BEGIN
    EXEC sp_displayoaerrorinfo @object, @hr
    RETURN
END
<b><i>  </i></b></pre>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
