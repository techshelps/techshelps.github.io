<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ScriptTransfer Method</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_scripttransfer_method_wnsqldmo"></a>ScriptTransfer Method</h2>
<h4>Description</h4>
<p>
Creates Transact-SQL script file(s) used by the Transfer method for creating copied objects in the destination database. Set the properties of a created Transfer object as desired, pass that Transfer object to the ScriptTransfer method with <i>tScriptMode</i> set to SQLOLEXfrFile_SummaryFiles to create the script files, and then pass the same Transfer object to the Transfer method to perform the database transfer.</p>
<h4>Visual Basic</h4>
<p>
<i>strScript </i><b>=</b><i> Database</i><b>.ScriptTransfer ( <br>
</b>[<b>TransferSpec :=</b>]<b> </b><i>Transfer</i><b>,</b><i><br>
</i>[[<b>ScriptFileMode :=</b>]<b> </b><i>tScriptMode</i><b>,</b>]<i><br>
</i>[[<b>ScriptFilePath :=</b>]<b> </b><i>strFile</i>]<i> </i><b>)</b></p>
<h4>C++</h4>
<p>
<b>HRESULT</b> <i>pDatabase</i><b>-&gt;ScriptTransfer ( <br>
LPSQLOLETRANSFER</b> <i>pTransfer</i><b>,</b><br>
<b>SQLOLE_XFRSCRIPTMODE_TYPE</b> <i>tScriptMode</i> <b>= SQLOLEXfrFile_Default,</b><br>
<b>SQLOLE_LPCSTR</b> <i>strFile</i> <b>= NULL,</b><br>
<b>SQLOLE_LPBSTR</b> <i>pstrScript</i> <b>= NULL ); </b></p>
<h4>Elements</h4>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=16%></th>
<th align=left width=42%></th>
<th align=left width=42%></th>
</tr>
</table><br>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=16%>Element</th>
<th align=left width=42%>Type</th>
<th align=left width=42%>Description</th>
</tr>
</table><br>
<table cellspacing=4 cols=3>
<tr valign=top>
<td width=16%><i>strScript</i></td>
<td width=42%>String</td>
<td width=42%>Returned Transact-SQL script</td>
</tr>
<tr valign=top>
<td width=16%><i>Transfer</i></td>
<td width=42%>Transfer</td>
<td width=42%>Created Transfer object that specifies how to execute the database transfer</td>
</tr>
<tr valign=top>
<td width=16%><i>tScriptMode</i></td>
<td width=42%>SQLOLE_XFRSCRIPTMODE<br>
  _TYPE</td>
<td width=42%>The script transfer type</td>
</tr>
<tr valign=top>
<td width=16%><i>strFile</i></td>
<td width=42%>String</td>
<td width=42%>If <i>tScriptMode</i> is SQLOLEXfrFile_SingleFile, the full path and filename of the single script file; otherwise, the full path of the directory used to store the script files</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
When <i>tScriptMode</i> is SQLOLEXfrFile_SummaryFiles (the default), multiple script files are created that have names of the following form:</p>
<p>
<i>source_server</i><b>.</b><i>source_database</i><b>.</b><i>ext</i></p>
<p>
where <i>source_server</i> is the name of the SQL Server that contains the source database, <i>source_database</i> is the name of the source database, and <i>ext</i> is one of the following three-letter extensions that are used to create database objects...</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=18%></th>
<th align=left width=82%></th>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=18%>File <br>
extension</th>
<th align=left width=82%>Script <br>
creates</th>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=18%>LGN</td>
<td width=82%>Logins</td>
</tr>
<tr valign=top>
<td width=18%>GRP</td>
<td width=82%>Groups, group statement privileges</td>
</tr>
<tr valign=top>
<td width=18%>USR</td>
<td width=82%>Users, user statement privileges</td>
</tr>
<tr valign=top>
<td width=18%>DEF</td>
<td width=82%>Non-declarative referential integrity (DRI) defaults</td>
</tr>
<tr valign=top>
<td width=18%>RUL</td>
<td width=82%>Rules</td>
</tr>
<tr valign=top>
<td width=18%>UDT</td>
<td width=82%>User-defined datatypes</td>
</tr>
<tr valign=top>
<td width=18%>TAB</td>
<td width=82%>Tables (does not include DRI)</td>
</tr>
<tr valign=top>
<td width=18%>DR1</td>
<td width=82%>Table DRI before copying data (includes clustered primary and unique keys)</td>
</tr>
<tr valign=top>
<td width=18%>DR2</td>
<td width=82%>Table DRI after copying data (includes nonclustered primary and unique keys, CHECK constraints, and DRI defaults)</td>
</tr>
<tr valign=top>
<td width=18%>ID1</td>
<td width=82%>Table indexes created before copying data (includes clustered <br>
non-DRI indexes)</td>
</tr>
<tr valign=top>
<td width=18%>ID2</td>
<td width=82%>Table indexes created after copying data (includes nonclustered <br>
non-DRI indexes)</td>
</tr>
<tr valign=top>
<td width=18%>BND</td>
<td width=82%>Bindings for rules and non-DRI defaults</td>
</tr>
<tr valign=top>
<td width=18%>PRV</td>
<td width=82%>Table privileges</td>
</tr>
<tr valign=top>
<td width=18%>FKY</td>
<td width=82%>Foreign keys</td>
</tr>
<tr valign=top>
<td width=18%>TRG</td>
<td width=82%>Triggers</td>
</tr>
<tr valign=top>
<td width=18%>VIW</td>
<td width=82%>Views and view privileges</td>
</tr>
<tr valign=top>
<td width=18%>PRC</td>
<td width=82%>Stored procedures and stored procedure privileges</td>
</tr>
</table><br>
<p>
...or one of the following three-letter extensions that are used to drop database objects.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=18%></th>
<th align=left width=82%></th>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=18%>Extension</th>
<th align=left width=82%>Script drops</th>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=18%>DP1</td>
<td width=82%>Drops foreign keys that reference copied tables (listed in the file with the DP2 extension). The Transfer method does not run this script. After a transfer is complete, you can run the DP1 script followed by the DP2 script on the source database to drop the source objects.</td>
</tr>
<tr valign=top>
<td width=18%>DP2</td>
<td width=82%>Drops all objects to be copied. (DP2 is used on the destination database only when the Transfer.DropDestObjectsFirst property is set to True).</td>
</tr>
</table><br>
<p>
The Database.Transfer method runs these script files in the following order: DP2, LGN, GRP, USR, DEF, RUL, UDT, TAB, DR1, ID1, bulk copy of copied tables, DR2, ID2, BND, PRV, FKY, TRG, VIW, PRC.</p>
<p>
To create the transfer scripts for private use (and not for later use with the Transfer method) you can set <i>tScriptMode</i> to SQLOLEXfrFile_SingleFilePerObject or SQLOLEXfrFile_SingleFile.</p>
<p>
When <i>tScriptMode</i> is SQLOLEXfrFile_SingleFilePerObject, multiple files are created that have names of the following form:</p>
<p>
<i>owner</i><b>.</b><i>object</i><b>.</b><i>ext</i></p>
<p>
where <i>owner</i> is the username of the object owner, <i>object</i> is the name of the database object, and <i>ext</i> is one of the extensions listed above.</p>
<p>
When <i>tScriptMode</i> is SQLOLEXfrFile_SingleFile, a single file (specified in <i>strFile</i>) is created that contains the entire Transact-SQL script for creating the database objects in the destination database.</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
