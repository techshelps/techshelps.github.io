<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Getting a Property</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="getting_a_property"></a>Getting a Property</h2>
<p>
Because all SQL-DMO property values are read-only or read-write, you can get all property values.</p>
<h5>Visual Basic</h5>
<p>
To get a property, use the following syntax:</p>
<p>
[<b>Set</b>] <i>variable</i><b> = </b><i>Object</i><b>.</b><i>Property</i></p>
<p>
For example, to get a long property:</p>
<pre>Dim lTime As Long
lTime = oSQLServer.LoginTimeout</pre>
<p>
For example, to get a string property:</p>
<pre>Dim strHost As String
strHost = oSQLServer.HostName</pre>
<p>
For example, to get an object property:</p>
<pre>Dim oConfiguration As SQLOLE.Configuration
Set oConfiguration = oSQLServer.Configuration</pre>
<p>
You can also use the <i>Object</i><b>.</b><i>Property</i> value directly as part of a more complex expression.</p>
<h5>C++</h5>
<p>
For a property named <i>Property</i>, you use a function named <b>Get</b><i>Property</i> to get a property value. Because all SQL-DMO functions return an HRESULT, you must pass the address of a program variable (use the address of <b>&amp;</b> operator) of the appropriate type to the <b>Get</b><i>Property</i> function. The <b>Get</b><i>Property</i> function will write the current property value to your program variable. Use the following syntax:</p>
<p>
<i>pObject</i><b>-&gt;Get</b><i>Property</i> <b>( &amp;</b><i>variable</i> <b>);</b></p>
<p>
For example, to get a long property:</p>
<pre>LONG lTime;
pSQLServer-&gt;GetLoginTimeout (&amp;lTime);</pre>
<p>
Getting a string property requires an extra step. A <b>Get</b><i>Property</i> function for a string property takes a parameter of type SQLOLE_LPBSTR, which is the address of a SQLOLE_BSTR variable. You pass the address of a SQLOLE_BSTR variable to the <b>Get</b><i>Property</i> function. The <b>Get</b><i>Property</i> function will allocate a new string and then write the current property value to the newly allocated string. After your program is finished using the string (allocated by SQL-DMO) it must call <b>SQLOLEFreeString</b> macro to deallocate the string.</p>
<p>
For example, to get a string property:</p>
<pre>SQLOLE_BSTR strHost;
pSQLServer-&gt;GetVersionString (&amp;strHost);
// use strHost
SQLOLEFreeString (strHost);</pre>
<p>
<b>SQLOLEFreeString</b> is mapped to the OLE <b>SysFreeString</b> function, with an appropriate conversion for ANSI strings when you are using the SQL-DMO ANSI interfaces.</p>
<p>
For example, to get an object property:</p>
<pre>LPSQLOLECONFIGURATION pConfiguration = NULL;
hr = pSQLServer-&gt;GetConfiguration (&amp;pConfiguration);</pre>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
