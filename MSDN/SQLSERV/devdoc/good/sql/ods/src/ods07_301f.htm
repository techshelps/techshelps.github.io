<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Programming Considerations</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_programming_considerations"></a>Programming Considerations</h1>
<p>
This section describes some programming considerations that you will need to keep in mind when writing Open Data Services routines that users will access as extended stored procedures in SQL Server (as opposed to routines that users will access on an Open Data Services server).</p>
<p>
When standard stored procedures are added to SQL Server, an administrator defines their expected parameters so that the system can validate user-specified parameters and return syntax errors. With extended stored procedures, it is up to the application to validate any user-specified parameters.</p>
<p>
When using the <b>srv_senddone</b> function to send a results completion message to the client, always set the completion status flag to SRV_DONE_MORE instead of to SRV_DONE_FINAL. The client receives SRV_DONE_FINAL from SQL Server.</p>
<p>
Each extended stored procedure function that you create should follow these recommendations for accepting and responding to user input:
<ol>
<li>
Check that the caller of the procedure has provided all of the required parameters and that each parameter is of the appropriate datatype. Return an appropriate message if not.</li>
<li>
Define the columns for returning a result set.</li>
<li>
Create each record for returning to the caller.</li>
<li>
Set up any output parameters and return statuses used by the procedure.</li>
<li>
When finished returning results, send the results completion message using <b>srv_senddone</b> with the SRV_DONE_MORE status flag.</li>
<li>
Return from the procedure with the desired Transact-SQL return status.</li>
</ol>
<p>
A single DLL file can contain multiple extended stored procedures. And SQL Server supports the use of multiple DLL files.</p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
