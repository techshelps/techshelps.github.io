<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Chapter 8   Sample Application-Procedure Server</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_sample_application_procedure_server"></a>Sample Application–Procedure Server </h1>
<p>
This chapter describes the PROCSRV.EXE sample application that is provided with your Open Data Services package. It describes programming considerations for creating your own procedure server applications, explains how to use the features of the PROCSRV sample application, and includes a listing of the PROCSRV source code. For the most current version of the sample code, refer to the version that shipped with your software.</p>
<p>
The PROCSRV sample application demonstrates how to implement stored procedures in an Open Data Services server application. PROCSRV provides the following procedures for use by clients and servers in the SQL Server environment:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=28%></th>
<th align=left width=72%></th>
</tr>
<tr valign=top>
<th align=left width=28%></th>
<th align=left width=72%></th>
</tr>
<tr valign=top>
<th align=left width=28%></th>
<th align=left width=72%></th>
</tr>
<tr valign=top>
<th align=left width=28%>PROCSRV <br>
procedure</th>
<th align=left width=72%><br>
Function</th>
</tr>
<tr valign=top>
<td width=28%></td>
<td width=72%></td>
</tr>
<tr valign=top>
<td width=28%><b>diskfree</b></td>
<td width=72%>Allows the caller to specify a drive letter as a stored procedure output parameter and returns the amount of available disk space as a stored procedure return value. </td>
</tr>
<tr valign=top>
<td width=28%><b>disklist</b></td>
<td width=72%>Obtains a list of available disk drives from the operating-system environment in which the Open Data Services server application is running and returns the available disk space for each drive as a SQL Server relational results set.</td>
</tr>
<tr valign=top>
<td width=28%><b>proclist</b></td>
<td width=72%>Returns a list of the procedures available in PROCSRV.</td>
</tr>
<tr valign=top>
<td width=28%><b>scan_xbase</b></td>
<td width=72%>Returns the contents of a dBASE-format file as a SQL Server relational results set.</td>
</tr>
<tr valign=top>
<td width=28%><b>sp_exec</b></td>
<td width=72%>Executes any command string in the operating-system environment in which the Open Data Services server application is running.</td>
</tr>
</table><br>
<p>
The procedures in the PROCSRV sample application implement many of the features described in <a href="ods01_94kx.htm">Overview</a>. The procedures are similar to the extended stored procedures covered in <a href="ods07_6fcj.htm">Sample Application¾Extended Stored Procedures</a>. Note, however, that PROCSRV runs as a separate network server application; extended stored procedures run as part of SQL Server. </p>
<p>
Open Data Services includes two versions of the PROCSRV application:
<ul>
<li>
A compiled version that you can use without modification</li>
<li>
The source code to use as a model if you are writing an Open Data Services server application that provides similar functionality</li>
</ul>
<p>
PROCSRV implements both a remote stored procedure event handler and a language event handler:
<ul>
<li>
The remote stored procedure event handler allows database clients to call procedures directly, using the DB-Library <b>dbrpc</b> functions. It also allows SQL Server to call the PROCSRV procedures as if they were remote stored procedures on another SQL Server.<p>
The event handler checks for the existence of the procedure name, runs the appropriate routine, and returns results to the caller.
</li>
<li>
The language event handler provides a mechanism for DB-Library clients that do not use the DB-Library <b>dbrpc</b> functions to access the PROCSRV procedures by using language statements. <p>
The event handler parses the language statement to extract the procedure call and the appropriate parameters. It processes the appropriate routine and returns results to the caller. This allows access from any type of database client that can send user-defined SQL statements, such as the <b>isql</b> utility. 
<p>
To execute the PROCSRV procedures by using language statements, the database client must be directly connected to the PROCSRV application server.
</li>
</ul>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
