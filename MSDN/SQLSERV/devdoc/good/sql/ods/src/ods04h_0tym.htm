<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SRV_TDSVERSION</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_srv_tdsversion"></a>SRV_TDSVERSION</h1>
<p>
Determines the tabular data stream (TDS) version being used in the client connection for the SRV_PROC structure.</p>
<h4>Syntax</h4>
<p>
<b>int SRV_TDSVERSION ( SRV_PROC * </b><i>srvproc </i><b>);</b></p>
<p>
where
<dl>
<dt>
<i>srvproc</i></dt>
<dd>
Is a pointer to the SRV_PROC structure that is the handle for a particular client connection (in this case, the handle for which the TDS version is requested).
</dd>
</dl>
<h4>Returns</h4>
<p>
The TDS version used by the specified client connection. The following table lists the TDS version constants that can be returned:</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=26%></th>
<th align=left width=74%></th>
</tr>
<tr valign=top>
<th align=left width=26%></th>
<th align=left width=74%></th>
</tr>
<tr valign=top>
<th align=left width=26%></th>
<th align=left width=74%></th>
</tr>
<tr valign=top>
<th align=left width=26%>Constant</th>
<th align=left width=74%>Version</th>
</tr>
<tr valign=top>
<td width=26%>srv_tds_4_0</td>
<td width=74%>The version used by SQL Server 4.2 and by Open Data Services version 4.2.</td>
</tr>
<tr valign=top>
<td width=26%>srv_tds_6_0</td>
<td width=74%>The version used by SQL Server 6.0 and by Open Data Services version 6.0.</td>
</tr>
</table><br>
<h4>Remarks</h4>
<p>
The macro <b>SRV_TDSVERSION</b> returns more useful information than the <b>srv_pfield</b> function. Using <b>SRV_TDSVERSION </b>you can determine if the client connection supports SRVDECIMAL and SRVNUMERIC data. If <b>SRV_TDSVERSION</b> returns SRV_TDS_6_0 then the client supports SRVDECIMAL and SRVNUMERIC data. If <b>SRV_TDSVERSION</b> returns SRV_TDS_4_0 then the client does not support SRVDECIMAL and SRVNUMERIC data, and the Open Data Services application should convert SRVDECIMAL and SRVNUMERIC data into SRVFLT8 before sending it to the client.</p>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=73%></th>
</tr>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=73%></th>
</tr>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=73%></th>
</tr>
<tr valign=top>
<th align=left width=27%>This entry</th>
<th align=left width=73%>For information about</th>
</tr>
<tr valign=top>
<td width=27%><a href="ods04g_3fc4.htm"><b>srv_pfield</b></a></td>
<td width=73%>Returning a field from an SRV_PROC structure</td>
</tr>
</table><br>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
