<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Feature Support Flags</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_feature_support_flags"></a>Feature Support Flags</h2>
<p>
The Open Data Services ODBC driver uses these flags to determine the capability of the gateway to handle SQL Server - specific features: 
<dl>
<dt>
IDS_FEATURE_FMTONLY_SUPPORT</dt>
<dd>
This flag is set to Y if the gateway can handle the SET FMTONLY ON/OFF statement. The Open Data Services ODBC driver sends a SET FMTONLY ON statement when a statement has been prepared (<b>SQLPrepare</b> called) and metadata (<b>SQLDescribeCol</b>, <b>SQLColAttributes</b>, or <b>SQLNumResultCols</b>) is required before it has been executed (<b>SQLExecute</b>). The driver sets FMTONLY on, sends the SQL statement, and then sets FMTONLY off. It is expected that the gateway will return only the metadata, without any rows of data. 
<p>
If this flag is set to N, the Open Data Services ODBC driver tries to add a WHERE 1=2 clause to a SELECT statement and then executes it to get the metadata. This will work only for a SELECT statement in which there is a single statement in the batch or when multiple statements are separated by semicolons. This fallback behavior may not work or may not be efficient, depending on the particular query involved and the type of back-end data source.
</dd>
<dt>
IDS_FEATURE_NOEXEC_SUPPORT</dt>
<dd>
This flag is set to Y if the gateway can handle the SET NOEXEC ON/OFF statement. The Open Data Services ODBC driver sends a SET NOEXEC ON statement when a statement is to be prepared (<b>SQLPrepare</b> called). It is expected that the gateway will return any errors found in processing but not execute the statement. If the DBMS supports a true prepare model, the statement should be prepared and the plan held for later execution. For more information, see <a href="odse_3gbr.htm">Prepare/Execute Handling</a>. </dd>
<dt>
IDS_FEATURE_HOLDLOCK_SUPPORT</dt>
<dd>
This feature is set to Y if the gateway supports the HOLDLOCK keyword of the SQL Server SELECT statement to hold locks for the duration of the transaction. When <b>SQLConnectOption</b> SQL_TXN_ISOLATION is set to SQL_TXN_SERIALIZABLE, the Open Data Services ODBC driver adds a HOLDLOCK keyword after each table name in the select statement. 
<p>
If set to N, the HOLDLOCK keyword is never added. For more information, see <a href="odse_21d3.htm">Transaction Handling</a> and <a href="odse_20oj.htm">Isolation Levels</a>. 
</dd>
<dt>
IDS_FEATURE_NOTNULL_DEFAULT</dt>
<dd>
This flag is set to Y if the gateway has a default of NOT NULL for the column definition in a CREATE TABLE or ALTER TABLE statement. The ODBC default is NULL. If neither NOT NULL nor NULL is specified, the Open Data Services ODBC driver adds NOT NULL after each column name. If this flag is set to N, these statements are unchanged.</dd>
<dt>
IDS_FEATURE_TEXTPTR_SUPPORT</dt>
<dd>
This flag is used by the Open Data Services ODBC driver to determine the level of text pointer support supported by the gateway. The following settings are supported:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=31%></th>
<th align=left width=69%></th>
</tr>
<tr valign=top>
<th align=left width=31%></th>
<th align=left width=69%></th>
</tr>
<tr valign=top>
<th align=left width=31%></th>
<th align=left width=69%></th>
</tr>
<tr valign=top>
<th align=left width=31%>Flag Setting</th>
<th align=left width=69%>Description</th>
</tr>
<tr valign=top>
<td width=31%>N</td>
<td width=69%>No text pointer support</td>
</tr>
<tr valign=top>
<td width=31%>R</td>
<td width=69%>READTEXT</td>
</tr>
<tr valign=top>
<td width=31%>W </td>
<td width=69%>WRITETEXT </td>
</tr>
<tr valign=top>
<td width=31%>U</td>
<td width=69%>UPDATETEXT</td>
</tr>
<tr valign=top>
<td width=31%>B </td>
<td width=69%>READTEXT and WRITETEXT</td>
</tr>
<tr valign=top>
<td width=31%>A</td>
<td width=69%>READTEXT, WRITETEXT, and UPDATETEXT</td>
</tr>
</table><br>


<p>
The Open Data Services ODBC driver currently uses WRITETEXT to send LONG VARCHAR or LONG VARBINARY data that is longer than 64K to the gateway. If the data is shorter than 64K, it is treated normally. If the gateway does not support text pointers, set the flag to N. This restricts the ODBC application from sending data that is longer than 64K to LONG VARCHAR/VARBINARY columns. Currently, the Open Data Services ODBC driver does not use READTEXT, so output data from these columns is only included in the normal result set. The Open Data Services ODBC driver uses UPDATETEXT when an update of a long data column affects multiple rows.
</dd>
<dt>
IDS_FEATURE_RPC_SUPPORT</dt>
<dd>
The following flag settings are supported:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=17%></th>
<th align=left width=83%></th>
</tr>
<tr valign=top>
<th align=left width=17%></th>
<th align=left width=83%></th>
</tr>
<tr valign=top>
<th align=left width=17%></th>
<th align=left width=83%></th>
</tr>
<tr valign=top>
<th align=left width=17%>Flag <br>
setting</th>
<th align=left width=83%><br>
Description</th>
</tr>
<tr valign=top>
<td width=17%>Y</td>
<td width=83%>The gateway supports execution of procedures through the RPC mechanism in addition to a language event. The Open Data Services ODBC driver will use the RPC invocation for execution of the catalog stored procedures and canonical procedure invocation. This is advantageous since the data is presented in binary form and there is no SQL statement to parse. RPC can also be used for prepare/execute, if supported. For more information, see <a href="odse_3gbr.htm">Prepare/Execute Handling</a>.       </td>
</tr>
<tr valign=top>
<td width=17%>N</td>
<td width=83%>The Open Data Services ODBC driver will execute any procedure invocation using SQL statements as a language event. The IDS_AUX_RPC_TEXT string contains the text added as a prefix to the function name.</td>
</tr>
<tr valign=top>
<td width=17%>B</td>
<td width=83%>Executing multiple RPCs in a single batch is supported.</td>
</tr>
</table><br>

</dd>
<dt>
IDS_FEATURE_STRIP_SEPARATORS</dt>
<dd>
This flag is set to Y if the gateway does not support semicolons between statements in a batch. The Open Data Services ODBC driver changes the separators to blanks. 
<p>
This flag is set to N if the gateway or DBMS supports the semicolon statement separator.
</dd>
<dt>
IDS_FEATURE_TSQL_OJ_SUPPORT</dt>
<dd>
This flag is set to Y if the gateway supports the SQL Server outer join syntax (*= or =*). The Open Data Services ODBC driver converts a canonical outer join to the SQL Server syntax. 
<p>
This flag is set to N if the gateway does not support the SQL Server outer join syntax. In this case, the Open Data Services ODBC driver will send the canonical form through to the gateway for it to handle. If the gateway does not support either the SQL Server or canonical form, the <b>SQLGetInfo</b> SQL_OUTER_JOINS option should be set to N.
</dd>
<dt>
IDS_FEATURE_EXEC_THRU_PROC</dt>
<dd>
This flag is set to Y if the gateway wants the Open Data Services ODBC driver to create a procedure and execute it for the prepare/execute model. If set to N, execution of a prepared statement will have the SQL statement sent with each execution. For more information, see <a href="odse_3gbr.htm">Prepare/Execute Handling</a>. </dd>
<dt>
IDS_FEATURE_KEEP_PARM_MARKERS</dt>
<dd>
This flag is set to Y if the gateway wants the parameter markers (question marks) to be retained when the statement is sent for preparation. If this flag is set to N, the Open Data Services ODBC driver substitutes dummy data of the proper type for the parameter markers.</dd>
<dt>
IDS_FEATURE_AS_ALIAS</dt>
<dd>
This flag is set to Y to tell the ODBC driver to keep the AS keyword ('<i>column_name</i> AS <i>column_alias</i>') in a SQL statement. If this flag is set to N, the ODBC driver removes the AS keyword.</dd>
<dt>
IDS_FEATURE_ASC_INDEX</dt>
<dd>
This flag is set to Y to tell the ODBC driver to keep the ASC and DESC keywords in a CREATE INDEX statement. If this flag is set to N, the ODBC driver removes these keywords.</dd>
<dt>
IDS_FEATURE_CURSOR_SUPPORT</dt>
<dd>
This flag is set to Y if the gateway supports the Microsoft SQL Server 6.0 cursor extended stored procedures. This allows the gateway to expose scrollable, updateable cursors to the client application. If this flag is set to N, the gateway does not support these cursor extended stored procedures.</dd>
<dt>
IDS_FEATURE_DECNUM_SUPPORT</dt>
<dd>
This flag is set to Y if the gateway supports data in the Open Data Services SRVDECIMAL and SRVNUMERIC format. If this flag is set to N, the gateway does not support these datatypes.</dd>
</dl>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
