<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>srv_message_handler</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_srv_message_handler"></a>srv_message_handler</h1>
<p>
Calls the installed Open Data Services message handler. This function is usually used to call SQL Server from an extended stored procedure to log an error (defined by the extended stored procedure) in the SQL Server error log file and/or the Windows NT event log.</p>
<h4>Syntax</h4>
<p>
<b>int srv_message_handler (<br>
SRV_PROC * </b><i>srvproc</i><b>,<br>
int </b><i>errornum</i><b>,<br>
BYTE </b><i>severity</i><b>,<br>
BYTE </b><i>state</i><b>,<br>
int </b><i>oserrnum</i><b>,<br>
char * </b><i>errtext</i><b>,<br>
int </b><i>errtextlen</i><b>,<br>
char * </b><i>oserrtext</i><b>,<br>
int </b><i>oserrtextlen </i><b>);</b></p>
<p>
where
<dl>
<dt>
<i>srvproc</i></dt>
<dd>
Is a pointer to the SRV_PROC structure that is the handle for a particular client connection. The <i>srvproc</i> parameter contains the information that the Open Data Services Library uses to manage communication and data between the application and the client.</dd>
<dt>
<i>errornum</i></dt>
<dd>
Is an error number defined by the extended stored procedure. This number must be from 50,001 through 2,147,483,647. You can OR this error number with the following values to adjust the event type recorded in the Windows NT event log:
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=26%></th>
<th align=left width=74%></th>
</tr>
<tr valign=top>
<th align=left width=26%></th>
<th align=left width=74%></th>
</tr>
<tr valign=top>
<th align=left width=26%></th>
<th align=left width=74%></th>
</tr>
<tr valign=top>
<th align=left width=26%>Value</th>
<th align=left width=74%>Windows NT event type</th>
</tr>
<tr valign=top>
<td width=26%></td>
<td width=74%></td>
</tr>
<tr valign=top>
<td width=26%>0x40000000</td>
<td width=74%>Informational</td>
</tr>
<tr valign=top>
<td width=26%>0x80000000</td>
<td width=74%>Warning</td>
</tr>
<tr valign=top>
<td width=26%>0xC0000000</td>
<td width=74%>Error</td>
</tr>
</table><br>

</dd>
<dt>
<i>severity</i></dt>
<dd>
Is a standard SQL Server severity value for the error. This number must be from 0 through 24.</dd>
<dt>
<i>state</i></dt>
<dd>
Is a SQL Server state value for the error.</dd>
<dt>
<i>oserrnum</i></dt>
<dd>
Is the operating-system error number.</dd>
<dt>
<i>errtext</i></dt>
<dd>
Is the description of the extended stored procedure error <i>errornum</i>.</dd>
<dt>
<i>errtextlen</i></dt>
<dd>
Is the length of the extended stored procedure error string <i>errtext</i>.</dd>
<dt>
<i>oserrtext</i></dt>
<dd>
Is the description of the operating-system error <i>oserrnum</i>.</dd>
<dt>
<i>oserrtextlen </i></dt>
<dd>
Is the length of the operating-system error string <i>oserrtext</i>.
</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED or FAIL.</p>
<h4>Remarks</h4>
<p>
The <b>srv_message_handler</b> function enables an extended stored procedure to integrate with the centralized error logging and reporting features of SQL Server. SQL Server alerts can be established for events from extended stored procedures, and SQLExecutive will monitor for these alert conditions.</p>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=73%></th>
</tr>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=73%></th>
</tr>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=73%></th>
</tr>
<tr valign=top>
<th align=left width=27%>This entry</th>
<th align=left width=73%>For information about</th>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=73%></td>
</tr>
<tr valign=top>
<td width=27%><a href="ods04c_2tt1.htm"><b>srv_errhandle</b></a></td>
<td width=73%>Installing a developer-supplied error handler</td>
</tr>
</table><br>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
