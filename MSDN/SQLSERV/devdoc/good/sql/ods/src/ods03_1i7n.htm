<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Client-initiated Events</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_client.2d.initiated_events"></a>Client-initiated Events</h2>
<p>
Most Open Data Services events are initiated by SQL Server client applications. The client applications use the same set of DB-Library functions to communicate with SQL Server database servers and with Open Data Services server applications. </p>
<p>
Each Open Data Services event initiated by a client application has a corresponding DB-Library function. The following table shows the DB-Library client requests that activate Open Data Services events:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=23%></th>
<th align=left width=31%></th>
<th align=left width=46%></th>
</tr>
<tr valign=top>
<th align=left width=23%></th>
<th align=left width=31%></th>
<th align=left width=46%></th>
</tr>
<tr valign=top>
<th align=left width=23%></th>
<th align=left width=31%></th>
<th align=left width=46%></th>
</tr>
<tr valign=top>
<th align=left width=23%>DB-Library <br>
call</th>
<th align=left width=31%>Open Data Services <br>
event activated</th>
<th align=left width=46%><br>
Description of event</th>
</tr>
<tr valign=top>
<td width=23%><b>dbcancel</b></td>
<td width=31%>SRV_ATTENTION</td>
<td width=46%>Interrupt request </td>
</tr>
<tr valign=top>
<td width=23%><b>dbclose</b></td>
<td width=31%>SRV_DISCONNECT</td>
<td width=46%>Disconnect request </td>
</tr>
<tr valign=top>
<td width=23%><b>dbopen</b></td>
<td width=31%>SRV_CONNECT</td>
<td width=46%>Connect request </td>
</tr>
<tr valign=top>
<td width=23%><b>dbsqlexec</b></td>
<td width=31%>SRV_LANGUAGE</td>
<td width=46%>Language request </td>
</tr>
<tr valign=top>
<td width=23%><b>dbrpcsend</b></td>
<td width=31%>SRV_RPC</td>
<td width=46%>Remote stored procedure request </td>
</tr>
</table><br>
<p>
In addition, Open Data Services provides a built-in remote stored procedure, <b>sp_sqlexec</b>, that allows a server or a client to send a language request that is formatted for a non – SQL Server data source to the Open Data Services server application in the form of a remote stored procedure argument. When an <b>sp_sqlexec</b> request is received by Open Data Services, Open Data Services converts the <b>sp_sqlexec</b> string into a language request, allowing the server application's language event handler to pass the request to an alternate data source.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=22%></th>
<th align=left width=26%></th>
<th align=left width=52%></th>
</tr>
<tr valign=top>
<th align=left width=22%></th>
<th align=left width=26%></th>
<th align=left width=52%></th>
</tr>
<tr valign=top>
<th align=left width=22%></th>
<th align=left width=26%></th>
<th align=left width=52%></th>
</tr>
<tr valign=top>
<th align=left width=22%>Remote <br>
stored <br>
procedure <br>
call</th>
<th align=left width=26%><br>
<br>
<br>
Event activated</th>
<th align=left width=52%><br>
<br>
<br>
Description of event</th>
</tr>
<tr valign=top>
<td width=22%><b>sp_sqlexec</b></td>
<td width=26%>SRV_LANGUAGE</td>
<td width=52%>Uses a remote procedure call to pass a string containing a language request to the language event handler, which then interprets the string as a language request.</td>
</tr>
</table><br>
<p>
For DB-Library client applications that run on Windows or Windows NT, if the client computer's <b>AutoAnsiToOem</b> setting is enabled, the client application will generate an SRV_LANGUAGE<b> </b>event immediately following the SRV_CONNECT<b> </b>event to determine which character set the server is using.</p>
<p>
Open Data Services server applications should include code to handle this event without generating an error. The query calls the catalog stored procedure <b>sp_server_info</b> with a parameter of 18 to obtain the server's COLLATION_SEQ value. If the first 5 bytes of the resulting value is iso_1, it indicates that the server is returning string data in the ANSI code page, and DB-Library does not need to perform any character set conversions. If the resulting value is anything else, DB-Library assumes that the server is returning string data in an OEM code page (such as 437 or 850). In this case, DB-Library performs a character set conversion to convert all string data into the Windows ANSI code page, unless conversion is explicitly turned off in the client application. For more information about character set conversions in DB-Library, see the <i>Microsoft SQL Server Programming DB-Library for C</i>. For more information about catalog stored procedures, see the <i>Microsoft SQL Server Transact-SQL Reference</i>.</p>
<p>
Alternatively, for any DB-Library clients that connect only to Open Data Services, you can disable this event by turning off the client computer's <b>AutoAnswerToOem</b> setting. This setting can be changed using the SQL Client Configuration Utility.</p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
