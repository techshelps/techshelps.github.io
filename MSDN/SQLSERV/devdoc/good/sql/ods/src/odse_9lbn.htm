<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>fType and fNew Values</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_ftype_and_fnew_values"></a>fType and fNew Values</h3>
<p>
The most important information in the ODSUSERTYPE data structure is the <b>fType</b> value. In most cases, this should be an ODBC datatype code, as defined in the <i>Microsoft ODBC 2.0 Programmer's Reference and SDK Guide</i>. (The datatype constants themselves are defined in the ODBC header files SQL.H and SQLEXT.H.) </p>
<p>
When <b>fType</b> refers to an ODBC datatype code, <b>fNew</b> should be set to NEWODBCTYPE. The Open Data Services ODBC driver will then look up additional information about the datatype in the gateway resources DLL file, such as its native name and its use in a search clause. In the sample resources DLL file shipped with this toolkit, these datatype definitions are defined in the LOCAL.RC source file, starting with IDS_DATATYPE_OFFSET+0. The Open Data Services ODBC driver will find the first datatype definition whose DATA_TYPE value (second column) matches the <b>fType</b> set by the gateway.</p>
<p>
The IDS_DATATYPE_OFFSET strings include values for NULLABLE and CASE SENSITIVE that apply to a datatype as a class. If these values indicate that a datatype can be null or is case sensitive, the Open Data Services ODBC driver will use the values of the <b>fNullable</b> and <b>fCaseSensitive</b> flags to determine if a given column instance of the datatype can contain null values or is case sensitive.</p>
<p>
For some data sources, there may be more than one source datatype that matches an ODBC datatype. For example, a data source might support both a MONEY datatype and a DECIMAL datatype, both of which map to the ODBC datatype SQL_DECIMAL. To distinguish between the different source datatypes in this case, set the <b>fNew</b> flag to NEWUSERTYPE. The Open Data Services ODBC driver will then interpret the <b>fType</b> code as a USER_TYPE (last column) when looking up the datatype attributes in the resources DLL. </p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
