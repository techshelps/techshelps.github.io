<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>srv_pre_handle</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_srv_pre_handle"></a>srv_pre_handle</h1>
<p>
Installs a pre-event handler for an extended stored procedure that is called <i>before</i> the standard event handler.</p>
<h4>Syntax</h4>
<p>
<b>int srv_pre_handle (<br>
SRV_SERVER * </b><i>server</i><b>,<br>
SRV_PROC * </b><i>srvproc</i><b>,<br>
DBINT </b><i>event</i><b>,<br>
SRV_PRE_HANDLE_PROC </b><i>handler</i><b>,<br>
BOOL </b><i>remove </i><b>);</b></p>
<p>
where
<dl>
<dt>
<i>server</i></dt>
<dd>
Is a pointer to the SRV_SERVER structure. Use <b>srv_init</b> to get this pointer. If you provide a <i>server</i> value, you must provide a NULL <i>srvproc</i> value.</dd>
<dt>
<i>srvproc</i></dt>
<dd>
Is a pointer to the SRV_PROC structure that is the handle for a particular client connection. The <i>srvproc</i> parameter contains the information that the Open Data Services Library uses to manage communication and data between the application and the client.
<p>
If you provide a <i>srvproc</i> value, you must provide a NULL <i>server</i> value.
</dd>
<dt>
<i>event</i></dt>
<dd>
Specifies the event assigned to <i>handler</i>. If you provide a <i>server</i> value, all events are valid. If you provide a <i>srvproc</i> value, the following client-generated events are valid:
<ul>
<li>
SRV_ATTENTION</li>
<li>
SRV_DISCONNECT</li>
<li>
SRV_LANGUAGE</li>
<li>
SRV_RPC</li>
</ul>
</dd>
<dt>
<i>handler</i></dt>
<dd>
Is a pointer to the function that is called before the standard event handler (installed by <b>srv_handle</b>) when the event defined by <i>event</i> occurs.
<p>
If a <i>server</i> value is provided, this function is global to the Open Data Services application and will be called (before the standard event handler) every time <i>event</i> occurs.

<p>
If a <i>srvproc</i> value is provided, this function will be called (before the standard event handler) only when <i>event</i> is generated by the <i>srvproc</i> client connection.

<p>
This function should be defined as returning an <b>int</b> and taking a single parameter. This parameter should be defined as SRV_SERVER * when <i>event</i> is one of the following:

<ul>
<li>
SRV_EXIT</li>
<li>
SRV_START</li>
<li>
SRV_SLEEP</li>
<li>
SRV_RESTART</li>
<li>
SRV_STOP</li>
</ul>

<p>
and defined as SRV_PROC * when <i>event</i> is one of the following:

<ul>
<li>
SRV_ATTENTION</li>
<li>
SRV_DISCONNECT</li>
<li>
SRV_LANGUAGE</li>
<li>
SRV_RPC</li>
</ul>

<p>
This function must return one of the following values:

<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=28%></th>
<th align=left width=72%></th>
</tr>
<tr valign=top>
<th align=left width=28%></th>
<th align=left width=72%></th>
</tr>
<tr valign=top>
<th align=left width=28%>Return value</th>
<th align=left width=72%>Description</th>
</tr>
<tr valign=top>
<td width=28%></td>
<td width=72%></td>
</tr>
<tr valign=top>
<td width=28%>SRV_CONTINUE</td>
<td width=72%>Continue normal processing.</td>
</tr>
<tr valign=top>
<td width=28%>SRV_DISCONNECT</td>
<td width=72%>Fire a disconnect event to close the client connection.</td>
</tr>
<tr valign=top>
<td width=28%>SRV_EXIT</td>
<td width=72%>Fire a disconnect event to close the client connection.</td>
</tr>
<tr valign=top>
<td width=28%>SRV_SKIP</td>
<td width=72%>Skip execution of the standard event handler. The post-event handler is still executed.</td>
</tr>
</table><br>

</dd>
<dt>
<i>remove</i></dt>
<dd>
Is a boolean flag that determines if the specified handler should be installed or removed. Use FALSE to install a new <i>handler</i> for <i>event</i>. Use TRUE to remove an existing <i>handler</i> for <i>event</i>.
</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED, FAIL, or SRV_DUPLICATE_HANDLER. SRV_DUPLICATE_HANDLER is returned if you attempt to install the same pre-event handler function multiple times for the same event.</p>
<h4>Remarks</h4>
<p>
When an event occurs, Open Data Services calls the following functions in this order:
<ol>
<li>
The pre-event handler (installed by <b>srv_pre_handle</b>)</li>
<li>
The standard event handler (installed by <b>srv_handle</b>)</li>
<li>
The post-event handler (installed by <b>srv_post_handle</b>)</li>
</ol>
<p>
You can install pre-event handlers dynamically. The new pre-event handler is called when the next event occurs. For each event, an extended stored procedure application can have multiple global pre-event handlers, and multiple pre-event handlers per client connection, but you cannot install the same pre-event handler function multiple times for the same event. Open Data Services will automatically remove the post-event handler when necessary; your program should not attempt to do this.</p>
<h4>See Also</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=73%></th>
</tr>
<tr valign=top>
<th align=left width=27%></th>
<th align=left width=73%></th>
</tr>
<tr valign=top>
<th align=left width=27%>This entry</th>
<th align=left width=73%>For information about</th>
</tr>
<tr valign=top>
<td width=27%></td>
<td width=73%></td>
</tr>
<tr valign=top>
<td width=27%><a href="ods04e_1co5.htm"><b>srv_handle</b></a></td>
<td width=73%>Installing a standard event handler</td>
</tr>
<tr valign=top>
<td width=27%><a href="ods04g_2bc5.htm"><b>srv_post_handle</b></a></td>
<td width=73%>Installing a post-event handler</td>
</tr>
</table><br>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
