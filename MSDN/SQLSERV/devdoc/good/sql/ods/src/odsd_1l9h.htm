<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Appendix D   Using the sp_sqlexec Built-in Stored Procedure</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_using_the_sp_sqlexec_built.2d.in_stored_procedure"></a>Using the sp_sqlexec Built-in Stored Procedure</h1>
<p>
The <b>sp_sqlexec</b> built-in stored procedure for Open Data Services provides a convenient way for SQL Server database clients and servers to send a language statement of any format to an Open Data Services server application. </p>
<p>
The <b>sp_sqlexec</b> stored procedure call uses the following syntax:</p>
<p>
<b>sp_sqlexec</b> <b>"</b><i>query_string</i><b>"</b></p>
<p>
where
<dl>
<dt>
<i>query_string</i></dt>
<dd>
Is a single database query that you want to send to a destination data source that is connected to an Open Data Services server application. The string can have a maximum of 256 characters, and must be of a <i>char</i> or <i>varchar</i> datatype. You must enclose the string in quotation marks.
</dd>
</dl>
<p>
The <b>sp_sqlexec</b> built-in stored procedure accepts a user-specified string as a stored procedure argument. SQL Server can pass the stored procedure call to a remote Open Data Services server without performing any processing on the string. </p>
<p>
When Open Data Services receives the <b>sp_sqlexec</b> request, it converts the request into a language statement so that the string is handled by the Open Data Services language event handler, allowing the Open Data Services server application to pass the string directly to a back-end data source for processing as a language statement.</p>
<p>
Many back-end databases cannot process remote stored procedure calls directly. The <b>sp_sqlexec</b> procedure allows the Open Data Services server application to function as a translator, accepting a remote stored procedure from a client or server in the SQL Server environment, and passing it to another data source as a language statement. In this way, SQL Server handles the request as a remote stored procedure, passing it to the Open Data Services server application without interpreting its contents. Any SQL Server - based client application can use <b>sp_sqlexec</b> to send data to or retrieve data from a gateway application, even when the client application is connected to a SQL Server and is not directly connected to the Open Data Services gateway application. Any SQL Server can call <b>sp_sqlexec</b> as a result of a trigger or from within another stored procedure, allowing SQL Server to send a language statement using its standard method of server-to-server remote stored procedure communication.</p>
<p>
The following example sends a remote stored procedure call to an Open Data Services server application called <b>odsapp</b>, which has previously been defined as a remote server in the SQL Server <b>sysservers</b> table:</p>
<pre>odsapp...sp_sqlexec "select au_lname, au_fname, phone from 
    authors where au_id = '427-17-2319'"</pre>
<p>
In this example, <b>odsapp</b> could be an Open Data Services gateway to a DB2® database. The <b>sp_sqlexec</b> procedure causes the <b>odsapp</b> language event handler to issue the SELECT statement to the DB2 back-end database and retrieve the results of the query.</p>
<p>&nbsp;</p></body>
</HTML>
