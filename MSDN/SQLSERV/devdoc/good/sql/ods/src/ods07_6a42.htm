<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding Extended Stored Procedures to SQL Server</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_adding_extended_stored_procedures_to_sql_server"></a>Adding Extended Stored Procedures to SQL Server</h1>
<p>
A DLL application file that contains extended stored procedure functions forms an extension to SQL Server itself. To install the DLL file, copy the file to the same directory as the standard SQL Server DLL files. As with other DLL files, once the extended stored procedure DLL is placed in the appropriate directory and the appropriate paths are set, you can make its functions available to users immediately ¾ it is not necessary to restart the server. </p>
<p>
For each function provided in an extended stored procedure DLL, a SQL Server system administrator must run the <b>sp_addextendedproc</b> system procedure, specifying the name of the function and the name of the DLL in which that function resides. This registers the function with the SQL Server <i>master</i> database and updates the SQL Server system tables by adding the name of the DLL to the <i>syscomments</i> table and adding the specified function name to the <i>sysobjects</i> table as an extended stored procedure with <i>X</i> as the object type. For example:</p>
<pre>sp_addextendedproc 'xp_proclist', 'xp.dll'</pre>
<p>
This command registers the function <b>xp_proclist</b>, located in the file XP.DLL, as a SQL Server extended stored procedure.</p>
<p>
To drop individual extended stored procedures, a system administrator uses the system procedure <b>sp_dropextendedproc</b>.</p>
<p>
SQL Server loads an extended stored procedure DLL as soon as a call is made to one of the DLL's functions. The DLL remains loaded until the server is shut down or until the system administrator uses the <b>DBCC</b> command to unload it. For example:</p>
<pre>DBCC xp(FREE)</pre>
<p>
This command unloads XP.DLL, allowing the system administrator to copy in a newer version of this file without shutting down the server.</p>
<p>
For more information about the administrative tasks described in this section, see the <i>Microsoft SQL Server Administrator's Companion</i>.</p>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
