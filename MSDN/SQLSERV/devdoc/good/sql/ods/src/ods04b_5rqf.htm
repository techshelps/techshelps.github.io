<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>srv_config</title>
<link disabled rel=stylesheet href=../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_srv_config"></a>srv_config</h1>
<p>
Sets server configuration parameters.</p>
<h4>Syntax</h4>
<p>
<b>int srv_config (<br>
SRV_CONFIG *</b> <i>config</i><b>, <br>
DBINT </b><i>option</i><b>, <br>
DBCHAR *</b> <i>value</i><b>, <br>
int </b><i>valuelen</i> <b>);</b></p>
<p>
where
<dl>
<dt>
<i>config</i></dt>
<dd>
Is a pointer to the SRV_CONFIG structure, which contains the values for the configuration options used by the Open Data Services application. Before issuing srv_config, <i>config</i> must first be allocated with <b>srv_config_alloc</b>.</dd>
<dt>
<i>option</i></dt>
<dd>
Specifies which of the following configuration parameters to set:
<dl>
<dt>
SRV_ANSI_CODEPAGE</dt>
<dd>
Specifies how Open Data Services handles character conversion for <b>srv_sendrow</b> and <b>srv_sendmsg</b>. Specify "FALSE" to convert all character data from ANSI to OEM (using the <b>AnsiToOem</b> function) before sending it to the client. Specify "TRUE" to not convert the data before sending it to the client. The default is "TRUE". These conversions do not affect English language characters but can affect extended characters (character positions 128-255) used in many languages.
<p>
It is recommended that extended stored procedures do not adjust this option, and always call <b>srv_sendrow</b> and <b>srv_sendmsg</b> with ANSI character strings. Open Data Services will handle any necessary character conversions to be consistent with the character set of SQL Server.

<p>
It is recommended that pass-through gateways to SQL Server set SRV_ANSI_CODEPAGE to "TRUE" to avoid any character conversion. DB-Library clients and SQL Server will handle any necessary character conversions.

<p>
For standalone Open Data Services applications with data that is already in ANSI form, and when you need to connect clients running MS-DOS, it is recommended that you set SRV_ANSI_CODEPAGE to "FALSE". ODS will convert your ANSI data to OEM before sending it to the client. Clients running MS-DOS will do no conversion, and clients running Windows and Windows NT can turn on AutoANSItoOEM. If your clients are running Windows and Windows NT only (none running MS-DOS), you can set SRV_ANSI_CODEPAGE to "TRUE" in your Open Data Services application, and turn off AutoANSItoOEM on the clients to avoid converting from ANSI to OEM at the server, and then from OEM back to ANSI at the client.

<p>
For standalone Open Data Services applications with data that is already in OEM form, it is recommended that you set SRV_ANSI_CODEPAGE to "TRUE" to avoid invalid character conversion. Clients running Windows and Windows NT can turn on AutoANSItoOEM.

<p>
For more information about DB-Library character set conversion and the AutoANSItoOEM client option, see Appendix A of the <i>Microsoft SQL Server Programming DB-Library for C</i>.
</dd>
<dt>
srv_connections</dt>
<dd>
The maximum number of client connections that the server will accept. This value must be a positive integer; the default is 10.</dd>
<dt>
SRV_DEFAULT_PACKETSIZE</dt>
<dd>
The default TDS packet size used by the Open Data Services application and the client connection if the client did not request a specific TDS packet size.</dd>
<dt>
srv_logfile</dt>
<dd>
The name of the log file to which the server will write Open Data Services messages. The default name is SRV.LOG. Messages are added to the log file when an <b>srv_log</b> function is issued. To stop adding messages and close the open log file, set <i>value</i> to <b>"</b> <b>"</b> and <i>valuelen</i> to 0.</dd>
<dt>
SRV_MAX_PACKETS </dt>
<dd>
The maximum number of tabular data stream (TDS) packets that Open Data Services will read for each incoming client or server request. The default value is 128 packets, allowing for 64K of data per request when using the default TDS packet size of 512 bytes. If clients or servers receive error messages that some requests are too large, increase this value. (This is most likely to occur for remote stored procedure requests that pass a large amount of information.)</dd>
<dt>
srv_max_packetsize</dt>
<dd>
The maximum TDS packet size that Open Data Services will use for all Net-Library connections. This value can be from 512 to 65535; the default is 512. DB-Library clients that request a large TDS packet size via <b>DBSETLPACKET</b> will use either the requested TDS packet size or the value specified by srv_max_packetsize, whichever is smaller. A larger packet size allows the ODS Library to execute large client requests and server responses with fewer network operations.</dd>
<dt>
srv_maxworkingthreads</dt>
<dd>
The maximum number of working threads that can actively process client requests on the server at one time. This value must be a positive integer between 1 and 65535; the default is 255. This parameter limits the size of the active thread pool, not the number of client connections. (To limit client connections, see the SRV_CONNECTIONS option.) </dd>
<dt>
srv_minworkingthreads</dt>
<dd>
The minimum number of worker threads available to process client requests when the application is idle. This value must be a positive integer between 1 and 65535; the default is 32. </dd>
<dt>
SRV_REMOTE_ACCESS </dt>
<dd>
Must be set to <b>"</b>TRUE<b>"</b> to allow SYBASE®- and OS/2-based SQL Servers to access the Open Data Services server application; the default is <b>"</b>TRUE<b>"</b>. Specify <b>"</b>FALSE<b>"</b> to deny access to these types of servers. </dd>
<dt>
SRV_REMOTE_CONNECTIONS </dt>
<dd>
The maximum number of individual remote stored procedure requests that the Open Data Services server application will accept from SYBASE- and OS/2-based SQL Server sites at one time; the default is 20. Each SYBASE- or OS/2-based SQL Server site that establishes a session with Open Data Services can send multiple remote stored procedure requests. This parameter limits the total number of simultaneous, requests from all sites. </dd>
<dt>
SRV_REMOTE_SITES</dt>
<dd>
The maximum number of active sessions that the Open Data Services server application can establish with individual SYBASE- and OS/2-based SQL Server sites at one time; the default is 10. Each SYBASE- or OS/2-based SQL Server site can establish a single session with Open Data Services. This parameter limits the total number of simultaneous sessions. </dd>
<dt>
srv_stacksize</dt>
<dd>
The stack space size to be allocated for each new connect event. The default is 4096 bytes. For each new client connection, the ODS Library allocates a separate stack, reserving an area for client connection information and for client callback functions. Normally the default stack size is sufficient. However, some developer-defined callback functions might require a larger stack space in order to operate properly. SRV_STACKSIZE allows you to adjust the stack size allocated to each client connection thread.</dd>
<dt>
SRV_THREADPRIORITY</dt>
<dd>
The thread priority (within a priority class) of every Open Data Services thread. It must be one of the following values:
<p>
SRV_PRIORITY_LOW: 2 points below normal priority

<p>
SRV_PRIORITY_NORMAL: Normal thread priority

<p>
SRV_PRIORITY_HIGH: 2 points above normal priority

<p>
SRV_PRIORITY_REALTIME: Highest possible priority

<p>
The default value is SRV_PRIORITY_NORMAL.
</dd>
<dt>
srv_threadtimeout</dt>
<dd>
The number of minutes that worker threads and networking threads can remain idle before they time out and exit. This value must be a positive integer between 1 and 65535; the default is 15. A thread is forced to exit if it remains idle for the specified time-out value. This parameter allows a decrease in network and worker threads during idle processing.</dd>
</dl>
</dd>
<dt>
<i>value</i></dt>
<dd>
Is a character string that provides the value for the configuration option. Specifying 0 sets <i>option</i> to its default value.</dd>
<dt>
<i>valuelen</i></dt>
<dd>
Indicates the length, in bytes, of the <i>value</i> string. If <i>valuelen</i> is SRV_NULLTERM, then the <i>value</i> string is expected to be null terminated and <i>valuelen</i> is ignored.</dd>
</dl>
<h4>Returns</h4>
<p>
SUCCEED or FAIL.</p>
<h4>Remarks</h4>
<p>
All configuration options have default values. The <b>srv_config</b> function is not required unless configuration option values differ from the default values. The log file can be changed at any time by calling <b>srv_config</b> with the log file option and specifying a new filename for <i>value</i>. Open Data Services sets the <i>valuelen</i> to 0 and uses the string in <i>value</i>.</p>
<p>
All thread configuration parameters can be changed at any time by calling <b>SRV_GETCONFIG</b> and then <b>srv_config</b> again, specifying new values, which take effect immediately. Changes to SRV_CONNECTIONS, SRV_MAX_PACKETS, SRV_REMOTE_ACCESS, SRV_REMOTE_CONNECTIONS, and SRV_REMOTE_SITES do not take effect until you re-start the Open Data Services application.</p>
<p>
The options SRV_REMOTE_ACCESS, SRV_REMOTE_CONNECTIONS, and SRV_REMOTE_SITES apply only when the Open Data Services server application is servicing incoming requests from SYBASE SQL Server or Microsoft SQL Server for OS/2. Because these servers can make multiple requests in a single session, option parameters are provided to prevent one or more servers from consuming the resources of the Open Data Services server application. With Microsoft SQL Server for Windows NT, individual remote stored procedure requests are handled by Open Data Services as separate client sessions, eliminating the potential for resource contention problems. </p>
<p>
Open Data Services uses a pool of <i>working threads</i> to process client requests.</p>
<p>
At least one worker thread must be available to process active client requests. If the number of client connections exceeds the maximum number of available worker threads specified with SRV_MAXWORKINGTHREADS, Open Data Services will continue to accept client connections by placing them in a queue until they can be serviced by available threads from the thread pool. Threads are subject to time-outs and will exit if they are idle beyond the specified time-out value, in order to minimize processing overhead when the application is idle.</p>
<h4>See Also</h4>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=27%></th>
<th align=left colspan=2 width=72%></th>
</tr>
<tr valign=top>
<th align=left width=27%></th>
<th align=left colspan=2 width=72%></th>
</tr>
<tr valign=top>
<th align=left width=27%></th>
<th align=left colspan=2 width=72%></th>
</tr>
<tr valign=top>
<th align=left width=27%>This entry</th>
<th align=left colspan=2 width=72%>For information about</th>
</tr>
<tr valign=top>
<td colspan=2 width=27%></td>
<td colspan=2 width=73%></td>
</tr>
<tr valign=top>
<td colspan=2 width=27%><a href="ods04b_19k3.htm"><b>srv_config_alloc</b></a></td>
<td colspan=2 width=73%>Allocating an Open Data Services server configuration structure</td>
</tr>
<tr valign=top>
<td colspan=2 width=27%><a href="ods04c_19mc.htm"><b>srv_event</b></a></td>
<td colspan=2 width=73%>Activating an event</td>
</tr>
<tr valign=top>
<td colspan=2 width=27%><a href="ods04d_2gfb.htm"><b>SRV_GETCONFIG</b></a></td>
<td colspan=2 width=73%>Accessing an Open Data Services server configuration structure</td>
</tr>
<tr valign=top>
<td colspan=2 width=27%><a href="ods04e_4lys.htm"><b>srv_init</b></a></td>
<td colspan=2 width=73%>Initializing an Open Data Services server application</td>
</tr>
<tr valign=top>
<td colspan=2 width=27%><a href="ods04f_1qqv.htm"><b>srv_log</b></a></td>
<td colspan=2 width=73%>Writing a message to the Open Data Services server log file</td>
</tr>
<tr valign=top>
<td colspan=2 width=27%><a href="ods04g_2a0e.htm"><b>srv_run</b></a></td>
<td colspan=2 width=73%>Starting an Open Data Services server application</td>
</tr>
</table><br>
<p>
</p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
