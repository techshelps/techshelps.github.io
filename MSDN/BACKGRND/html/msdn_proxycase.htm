<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Coopers &amp; Lybrand: Microsoft Proxy Server Security Evaluation</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="msdn_proxycase"></a>Coopers &amp; Lybrand: Microsoft<sup> </sup>Proxy Server Security Evaluation</h1>
<p>
Coopers &amp; Lybrand, L.L.P., Information Technology Security Services</p>
<p>
April 1997</p>
<h2>Abstract</h2>
<p>
This case study presents the results of tests designed to evaluate Microsoft® Proxy Server security. Interconnectivity security issues and the Microsoft Proxy Server features designed to address these issues are presented. The approach used to evaluate Microsoft Proxy Server security is discussed, and definitions of multiple test cases covering Microsoft Proxy Server installation, configuration, function, and penetration are provided. The configuration of the testing laboratory and its equipment used to evaluate this product is described, and a security checklist and baseline security configuration is presented.</p>
<h2>Table of Contents</h2>
<p>
<a href="#proxyexecsumm">Executive Summary</a></p>
<p>
<a href="#proxyintroduction">Introduction</a></p>
<p>
<a href="#proxybackground">Background</a></p>
<p>
<a href="#proxyobjectives">Objectives</a></p>
<p>
<a href="#proxywhatis">What Is Microsoft Proxy Server?</a></p>
<p>
<a href="#proxyinterconnectivity">Interconnectivity Security Issues and Microsoft Proxy Server Security Features</a></p>
<p>
<a href="#proxytestapproach">Test Case Approach</a></p>
<p>
<a href="#proxytestfindings">Test Case Findings Summary</a></p>
<p>
<a href="#proxyinstall">Installation Tests</a></p>
<p>
<a href="#proxyconfig">Configuration Tests</a></p>
<p>
<a href="#proxyfunction">Function Tests</a></p>
<p>
<a href="#proxypenetration">Penetration Tests</a></p>
<p>
<a href="#proxyinstallsumm">Installation Test Case Results Summary</a></p>
<p>
<a href="#proxyconfigsumm">Configuration Test Case Results Summary</a></p>
<p>
<a href="#proxyfuncsumm">Function Test Case Results Summary</a></p>
<p>
<a href="#proxypensumm">Penetration Test Case Results Summary</a></p>
<p>
<a href="#proxyappa">Appendix A—Test Specification</a></p>
<p>
<a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a></p>
<p>
<a href="#proxyappc">Appendix C—Server Security Checklist</a></p>
<p>
<a href="#proxyreducing">Reducing Security Risks</a></p>
<p>
<a href="#proxyappd">Appendix D—Output of ISS SafeSuite Scans (Abbreviated)</a></p>
<p>
<a href="#proxyappe">Appendix E—Suggested Baseline Security Configuration</a></p>
<p>
<a href="#proxyappf1">Appendix F1—Detailed Installation Test Case Results</a></p>
<p>
<a href="#proxyappf2">Appendix F2—Detailed Configuration Test Case Results</a></p>
<p>
<a href="#proxyappf3">Appendix F3—Detailed Functional Test Case Results</a></p>
<p>
<a href="#proxyappf4">Appendix F4—Detailed Penetration Test Case Results</a></p>
<p>
<a href="#proxymanagement">Management's Assertion</a></p>
<p>
<a href="#proxyreport">Report of Independent Accountants</a></p>
<p>
<a href="#proxydisclaimer">Disclaimer</a></p>
<p>
<a href="#proxylimitation">Limitation of Testing</a></p>
<p>
<a href="#proxybibliography">Bibliography</a></p>
<p>
<a href="#proxyaboutcl">About Coopers &amp; Lybrand</a></p>
<p>
<a href="#proxyaboutauthors">About the Authors</a></p>
<h2><a name="proxyexecsumm"></a>Executive Summary</h2>
<p>
In the fast-growing market for Internet related products and services, new offerings are made available on an increasingly frequent basis, often without extensive field use or review. This document represents an attempt to provide an additional level of evaluation of Microsoft Proxy Server and presents the results of a series of tests designed to evaluate the product’s security capabilities. The exercises conducted provide information regarding the security functionality of the product and should be used in conjunction with vendor literature, along with your own critical evaluation, to determine its effectiveness and appropriateness for your environment. This document is one of several sources that can be referenced when attempting to make decisions regarding the relative strength of security measures your organization would like to implement when establishing Internet connectivity.</p>
<p>
It is critical to note that there is no one right answer to the question of what constitutes enough security. The answer is often a custom solution that depends on your needs for control and flexibility. Adopting a practical business approach when addressing the level of security an organization requires should be fundamental to all security decisions. </p>
<p>
Based on our analysis, it appears that Microsoft Proxy Server can be used to satisfy the security needs of many organizations as they establish and maintain Internet-based systems and applications.</p>
<p>
In our assessment of Microsoft Proxy Server, we completed a four-phase evaluation program:
<ul type=disc>
<li>
Installation <br><br></li>
<li>
Configuration<br><br></li>
<li>
Feature analysis (for features related to security only)<br><br></li>
<li>
Penetration testing</li>
</ul>
<p>
Coopers &amp; Lybrand’s (C&amp;L) intent in constructing this four-phase approach was to emulate, as closely as possible, the life cycle of product deployment in commercial environments. The approach was designed to unearth security vulnerabilities that would have a major impact on the overall security of private networks. C&amp;L employed generally recognized techniques for testing security controls in networked environments of this kind.</p>
<p>
Throughout the evaluation, Microsoft Proxy Server withstood the testing of well known and well documented tools, such as the public domain tools Internet Security Scanner and Satan, that exploit vulnerabilities in TCP/IP networks. In addition, Microsoft Proxy Server did not reveal any easily exploitable vulnerabilities that would place private networks at significant risk when communicating via the Internet. </p>
<p>
Obtaining an in-depth understanding of the contents of this document requires a fundamental understanding of internetworking architecture, the TCP/IP protocol, and general security vulnerabilities in Internet technology. It should be noted that without careful installation, monitoring, and observation, any computing product or system may be vulnerable to exploitation in current and future configurations. Please see the <a href="#proxybibliography">Bibliography</a> later in this document for additional information regarding these issues.</p>
<p>
One must note Microsoft Proxy Server relies on Microsoft Windows NT® Server version 4.0 as its operating system and for certain security features. In some scenarios and configurations, the IP forwarding feature of the Microsoft Windows NT Server version 4.0 operating system may present routing vulnerabilities. This feature is not enabled when Microsoft Windows NT Server version 4.0 is installed, but since this feature is not automatically disabled when Microsoft Proxy Server is installed, it is important to disable it. In addition, Microsoft Windows NT Server version 4.0’s TCP/IP allows initial connections to some IP ports, which can be detected via the Internet. This may entice vandals to attempt further attack scenarios and encourage organizations interested in the highest level of security to employ additional firewall components (such as a packet filtering router or other commercial firewall product) between the proxy server and the public Internet. This paper explains how proper configuration can help you avoid these risks. Finally, since a major component of security depends on good monitoring, all organizations that utilize the Microsoft Proxy Server, which does include an adequate auditing mechanism but no automatic alert mechanism, should make the commitment to allocate proper personnel resources for continuous system monitoring.</p>
<p>
In summary, it appears that Microsoft Proxy Server, when properly installed, configured, maintained, and monitored, can provide a reasonable and practical level of security for a wide variety of computing environments.</p>
<h2><a name="proxyintroduction"></a>Introduction</h2>
<h3><a name="proxybackground"></a>Background</h3>
<p>
Recent technical developments provide fast efficient communication among individuals and businesses. Currently, one of the most publicized forms of modern communication is the computer network, specifically the Internet. As this communication technology becomes increasingly a necessity, the concern for its security and control also increases. Resulting from this concern, organizations have developed additional technology to counter these control and security issues.</p>
<p>
Microsoft Proxy Server is one such technology created to address the security and control of communications conducted through a computer network.</p>
<h3><a name="proxyobjectives"></a>Objectives</h3>
<p>
The primary objectives of this white paper are to:
<ul type=disc>
<li>
Introduce the Microsoft Proxy Server<br><br></li>
<li>
Document the Microsoft Proxy Server’s security features<br><br></li>
<li>
Document the results of evaluating the Microsoft Proxy Server’s security controls<br><br></li>
<li>
Provide a checklist for securing the Microsoft Proxy Server<br><br></li>
<li>
Provide a baseline configuration for securing the Microsoft Proxy Server</li>
</ul>
<p>
While this document addresses the security controls of the Microsoft Proxy Server, it does not address all of the security controls of the Microsoft Windows NT Server version 4.0 operating system or the Microsoft Internet Information Server products, both of which are prerequisites for the Microsoft Proxy Server operation. This evaluation is not intended to be a conclusive examination of Microsoft Windows NT Server version 4.0 or IIS.</p>
<h3><a name="proxywhatis"></a>What Is Microsoft Proxy Server?</h3>
<p>
Microsoft Proxy Server is a secure, high performance, cost-effective gateway to the Internet. Microsoft Proxy Server has two services: Web Proxy and WinSock Proxy.</p>
<h4>Web Proxy</h4>
<p>
Web Proxy is fully compliant with the CERN proxy standard, and offers proxy service for FTP Read, Gopher, and WWW for computers on your private network running TCP/IP. Web Proxy supports the popular web browsers, including Microsoft Internet Explorer 3.0, Netscape Navigator 3.0, and PointCast Network. Web Proxy also supports multiple platforms including Windows NT Server, Windows NT Workstation, Windows® 95, Windows for Workgroups, Windows 3.1, UNIX, and Macintosh®. Web Proxy also supports SSL Tunneling, which provides an encrypted connection between the client and Web Server through the proxy.</p>
<h4>WinSock Proxy</h4>
<p>
WinSock Proxy proxies virtually all Windows Sockets 1.1 compatible applications and protocols by intercepting Windows Sockets Application Programming Interface (API) network calls, with support for TCP/IP and IPX/SPX net protocols. This service is transparent to the application, therefore virtually all applications can be proxied. Examples of remote capable applications are TELNET, FTP, RealAudio, SMTP, and VDOLive.</p>
<p>
Microsoft Proxy Server offers an extensive array of supporting features.</p>
<p class=label>
<b>Feature Summary</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=27%><b>Feature</b></td>
<td class=label width=73%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=27%>Single IP Address</td>
<td width=73%>Microsoft Proxy Server presents one IP address to computers on the Internet. This enables one point of connection between many internal computers and external computers. The internal network addresses are not presented to the external computers.</td>
</tr>
<tr valign=top>
<td width=27%>Supports Dual-Homed Adapters</td>
<td width=73%>Microsoft Proxy Server supports two network adapter cards with different addresses that do not use IP-Forwarding. This feature separates the internal addresses topology from the external.</td>
</tr>
<tr valign=top>
<td width=27%>Local Address Table</td>
<td width=73%>Microsoft Proxy Server enables the specification of the IP address range(s) of all internal computers when IP is used as one of the internal protocols. This enables local clients to determine whether they must connect through the Proxy Server to access an external IP address. This feature also blocks processing of external client requests to internal servers.</td>
</tr>
<tr valign=top>
<td width=27%>Internet/Intranet Applicable</td>
<td width=73%>The single IP address, support for two network adapter cards, and Local Address Table make Microsoft Proxy Server suitable for securing internal networks from the Internet or from other internal networks.</td>
</tr>
<tr valign=top>
<td width=27%>Site Filtering</td>
<td width=73%>Microsoft Proxy Server enables certain Internet sites to be filtered from internal clients.</td>
</tr>
<tr valign=top>
<td width=27%>Access Control</td>
<td width=73%>Microsoft Proxy Server enables user and group permission lists to be established for each protocol.</td>
</tr>
<tr valign=top>
<td width=27%>Proxy Request Logging</td>
<td width=73%>Microsoft Proxy Server enables logging of system usage and access. Logs can be saved to text files or to a database (such as SQL Server™) using ODBC.</td>
</tr>
<tr valign=top>
<td width=27%>Remote Administration</td>
<td width=73%>Microsoft Proxy Server can be administered from remote intranet (within corporate network) locations using the Internet Service Manager tool.</td>
</tr>
<tr valign=top>
<td width=27%>Tight Integration with Windows NT Server Version 4.0</td>
<td width=73%>Microsoft Proxy Server tightly integrates with Microsoft Internet Information Server and the Windows NT Server Version 4.0 network operating system, therefore allowing central administration through the Windows NT administrative environment and single logon for Proxy Server users.</td>
</tr>
<tr valign=top>
<td width=27%>Multiple Network Compatible</td>
<td width=73%>Microsoft Proxy Server supports both TCP/IP and IPX/SPX protocols and it can be used with existing networks, therefore allowing migration to a pure TCP/IP based network at a self-defined pace.</td>
</tr>
<tr valign=top>
<td width=27%>Ease of Use</td>
<td width=73%>Microsoft Proxy Server runs on the Windows NT Server Version 4.0 network operating system and presents a user-friendly interface. </td>
</tr>
<tr valign=top>
<td width=27%>Demand Dial</td>
<td width=73%>Microsoft Proxy Server contains an autodial feature, which automatically connects the Proxy Server to the Internet Service Provider whenever data is required and not stored in the cache. The autodial disconnects from the service provider when the data is retrieved or when a time out expires. </td>
</tr>
<tr valign=top>
<td width=27%>Protocol Support</td>
<td width=73%>Microsoft Proxy Server supports all Internet protocols, including streaming audio and video, Internet Relay Chat, TELNET, HTTP, FTP, SMTP, NTP, and more.</td>
</tr>
<tr valign=top>
<td width=27%>Caching</td>
<td width=73%>Microsoft Proxy Server offers active, intelligent caching of frequently visited sites to reduce network costs and bandwidth consumption. Caching is scaleable through Windows NT and hardware.</td>
</tr>
<tr valign=top>
<td width=27%>Integration With SNMP</td>
<td width=73%>Microsoft Proxy Server integrates with SNMP services, which enables the status of a Proxy Server to be viewed from across the network.</td>
</tr>
<tr valign=top>
<td width=27%>Extensibility</td>
<td width=73%>Microsoft Proxy Server supports the multi-vendor ISAPI Filter specification enabling third parties to write value-enhancing add-ons to the Proxy Server. Examples of current extensions include virus scanning and site filtering.</td>
</tr>
</table><br>
<h2><a name="proxyinterconnectivity"></a>Interconnectivity Security Issues and Microsoft Proxy Server Security Features</h2>
<p>
Organizations or individuals that connect to the Internet assume significant security risk. Microsoft Proxy Server and Windows NT Server Version 4.0 have features designed to prevent and/or severely reduce most of the common security issues that are introduced by connecting to the Internet. The following section focuses on those features and the issues and risks eliminated, severely reduced, or generally mitigated by each of those features.</p>
<h3>Issue</h3>
<p>
<b>Network Penetration</b>—The most widely discussed set of risks relating to a corporate network is outside users accessing internal resources. This includes external users accessing data on the internal network as well as potentially doing damage to the network itself. As more companies connect to external networks, a variety of tools, including proxy servers, have been developed for the purpose of masking the internal network from the Internet or other external networks in order to prevent snooping on or hacking into the internal network.</p>
<h3>Feature</h3>
<p>
<b>Local Address Table (LAT) and Proxy Server</b>—In the network configuration (LAT) dialog box, each address pair in the Internal IP Addresses list identifies a range of addresses that belong to the private network. This information is used to create the Local Address Table (LAT). The LAT is stored in the msplat.txt file, located by default at C:\msp\clients. When a client computer runs the client Setup program, this table is downloaded from the Server to the client. When a WinSock Proxy or Web Proxy client attempts to access a network IP address, the LAT is used to determine whether the address is inside the private network (and can be connected to directly) or is outside on the Internet (and therefore must be connected to through Microsoft Proxy Server).</p>
<p>
When a client request is received, it is verified that it came from an internal network interface.</p>
<p>
<b>Supports dual-homed environment</b>—The Microsoft Proxy Server can easily be configured as a dual-homed (separate network interface for each side) non-routing (not arbitrarily passing IP packets between connected networks) security device. This method of connection provides the most secure form of network security isolation. This dual-homed environment can be configured to support a different network protocol on the two interfaces, thus providing another security level.</p>
<p>
<b>Ability to Disable IP Forwarding in Windows NT Server Version 4.0 TCP/IP</b>—In a dual-homed server, IP forwarding is enabled or disabled under the routing tab of the TCP/IP properties menu. This is found by selecting TCP/IP under the protocol tab of the network icon. The network icon may be accessed through the Control Panel.</p>
<p>
<b>Support for IPX protocol</b>—Since many corporate networks do not run the TCP/IP protocol, but support the IPX protocol, the Microsoft Proxy Server will function in that network environment. The Proxy Server will operate in a dual-homed network with the internal network running IPX and the external network running TCP/IP. Some system administrators believe this provides better security on the private network. The IPX protocol is configured in Windows NT server using the network icon’s protocols tab. Once configured, Microsoft Proxy Server will automatically utilize the protocol.</p>
<h3>Issue</h3>
<p>
<b>IP Spoofing</b>—IP spoofing or masquerading is a technique used in a network or system attack in which the attacking computer assumes the identity of a computer already in the internal network. The attacking computer spoofs or imitates the IP address of the internal computer to either send data as if they were on the internal network or to receive data intended for the machine being spoofed.</p>
<h3>Feature</h3>
<p>
<b>Local Address Table (LAT) and Web Proxy</b>—The Microsoft Proxy Server is designed to prevent any IP packets with destination addresses not found in the LAT from entering through the public Internet-connected interface and attempting to access computers on the internal network. This feature plays a major role in preventing spoofing (IP address masquerading) attacks from the Internet.</p>
<h3>Issue</h3>
<p>
<b>External Publication of Internal Data</b>—Prevention of internal data, used on an internal network or an Intranet, from being visible on any external network.</p>
<h3>Feature</h3>
<p>
<b>Enable/Disable Internet Web Publishing</b>—The Internet Information Server (IIS) may be installed when Windows NT Server Version 4.0 is installed. All three IIS publishing services (WWW, Gopher, and FTP) are started by default when the Windows NT Server is started. These services, when configured, are then advertised both on the internal and on the external network. When the Microsoft Proxy Server is installed, WWW publishing (http protocol, port 80) on the external network is disabled, effectively hiding the internal http data from the outside. This feature may be manually enabled by selecting the check box to allow outside access to the inside data.</p>
<h3>Issue</h3>
<p>
<b>Access to Unauthorized or Undesirable Internet Sites</b>—Internet browser software will allow access to any site on the Internet. Many corporate entities find that certain sites are unacceptable in their content or will want to limit access to only business-related sites. These organizations prefer to restrict access not only by written policy, but also by enforcing an actual restriction to those sites that they deem unacceptable. Lack of site access restrictions and a policy regarding site access may be interpreted to mean that access to all sites is acceptable. Appropriate use and legal liability are risks associated with internal users accessing outside resources. This risk can be mitigated through controls such as filtering for certain sites identified as inappropriate, issuance of a policy regarding site access, and monitoring site access.</p>
<h3>Feature</h3>
<p>
<b>Site/Domain Filtering</b>—The Microsoft Proxy Server gives an administrator the capability to limit which Internet sites can be accessed by the internal client user population. This feature can be configured to grant or deny access to all sites except those listed in the proxy filtering database. Filtering can be assigned by providing specific, individual network addresses, network address ranges and subnet masks, or Internet domain names. This feature may be used to limit a corporation’s exposure to non-authorized Internet access.</p>
<p>
This feature is disabled by default and must be enabled to use. Access may be controlled on a granted or denied list. All access is granted except to sites listed or all access is denied except to sites listed. The system administrator may override filtering by using the Unlimited protocol of the WinSock Proxy.</p>
<h3>Issue</h3>
<p>
<b>Auditablility</b>—The ability to gather information about the use of the Microsoft Proxy Server is important to overall system security—the administrator’s knowledge of what users are accessing and what information is being moved over the network helps avoid problems. Without such information, the network administrator knows nothing about the activity on the proxy server, neither the types of access nor the locations visited. </p>
<p>
Weak or nonexistent monitoring controls increases the risk associated with not interrupting or noticing any attacks on your network or servers.</p>
<h3>Feature</h3>
<p>
<b>Logging</b>—The Microsoft Proxy Server enables administrators to activate one of two levels of activity/security logging functionality (regular or verbose). With each level of logging a trade-off takes place between amount of detail available versus performance and storage requirements. The regular level of logging provides sufficient information to gain a comfortable level of security monitoring for most network applications, while the verbose level provides all of the information regarding a connection or event.</p>
<p>
Logging provides the system administrator the ability to track system usage and access. Without logging the ability to prevent unauthorized activity is severely limited. Operating the Microsoft Proxy Server without logging enabled should be considered insecure.</p>
<p>
The logging feature records the following information and stores it in the listed directories:</p>
<p>
Web proxy: %SYSTEMROOT%\w3plogs</p>
<p>
Winsock proxy: %SYSTEMROOT%\wsplogs</p>
<h4>Regular logging</h4>
<ul type=disc>
<li>
Client machine’s IP address<br><br></li>
<li>
Client user name<br><br></li>
<li>
Log date<br><br></li>
<li>
Log time<br><br></li>
<li>
Service name<br><br></li>
<li>
Destination name as IP address<br><br></li>
<li>
Destination port<br><br></li>
<li>
Protocol name (TCP, UDP)<br><br></li>
<li>
Object name <br><br></li>
<li>
Object source<br><br></li>
<li>
Result code</li>
</ul>
<h4>Verbose logging</h4>
<ul type=disc>
<li>
Client machine’s IP address<br><br></li>
<li>
Client user name<br><br></li>
<li>
Client agent<br><br></li>
<li>
Client platform<br><br></li>
<li>
Authentication status<br><br></li>
<li>
Log date<br><br></li>
<li>
Log time<br><br></li>
<li>
Service name<br><br></li>
<li>
Proxy name<br><br></li>
<li>
Referring server name<br><br></li>
<li>
Destination name<br><br></li>
<li>
Destination address<br><br></li>
<li>
Destination port<br><br></li>
<li>
Processing time<br><br></li>
<li>
Bytes received<br><br></li>
<li>
Bytes sent<br><br></li>
<li>
Protocol name<br><br></li>
<li>
Transport<br><br></li>
<li>
Operation<br><br></li>
<li>
Object name<br><br></li>
<li>
Object MIME<br><br></li>
<li>
Object source<br><br></li>
<li>
Result code</li>
</ul>
<h3>Issue</h3>
<p>
<b>Unauthorized Users</b>—Most corporations desire to control access to the Internet. Authentication of users connecting to this medium will provide some comfort level that the appropriate persons are using the access facility. Poor or no authentication may lead to a loss of accountability in the use of the private and public network.</p>
<h3>Feature</h3>
<p>
<b>User-Level Authentication</b>—This feature is implemented and operates differently within the Web Proxy Server and the WinSock Proxy Servers. </p>
<p>
Use of an anonymous logon, between client and proxy server, is the most common access method to the Internet. Use of this method assumes that the connection is coming through the internal network and is essentially trusted. There is no security involved with this connection, other than assuring that the client is on the internal network. Microsoft Proxy Server offers two kinds of user-level authentication.</p>
<p>
Using either of the authenticated connection processes enhances security by forcing the proxy server to authenticate each connection before allowing the request to pass through the proxy. The user has to be revalidated for each connection through the proxy server. This requires some level of account management either on the proxy server itself or on the domain controller for the domain that contains the proxy server machine or on a domain controller in a trusted domain, as each user must have a valid account on the proxy server.</p>
<p>
Authentication between a private network client and the Web Proxy Server is configured in the WWW Service tab of the Internet Information Server (IIS) and in the Web Proxy Permissions tab of the Proxy Server. In addition to anonymous authentication, the Proxy Server allows two other authentication methods—Basic Authentication with Clear Text and Windows NT Challenge/Response Authentication.</p>
<p>
The Web Proxy Server allows access control to be enabled or disabled. If disabled, all users get access to the Web Proxy and the settings in the WWW Service tab are not used. If enabled, then user-level authentication takes place based on the settings in the WWW Service. When access control is enabled, using the anonymous login feature will not work, unless the IUSR_machinename account is given protocol permission on the Web Proxy’s Permissions tab. If anonymous login is the only authentication choice selected in the WWW service of IIS, then no access control at the Web Proxy is active. If any other authentication method is chosen in the WWW service of IIS, then access control is available in the Web Proxy.</p>
<h4>Basic authentication</h4>
<p>
With Basic authentication enabled, a username and password are passed to the Microsoft Proxy Server in the uuencoded format. Uuencoding means that the text is scrambled, but normal ASCII characters are visible, so the username Murray might come out as Nvttbz. To the casual viewer this may seem unusable, but encoded text is easily unscrambled by certain programs.</p>
<h4>Windows NT Challenge/Response authentication</h4>
<p>
Windows NT Challenge/Response (NTCR) authentication is Windows NT’s highest level of security. NTCR is typically run in a networked environment that includes Windows NT servers and Windows NT workstations. Windows 95 workstations can also use NTCR to provide secure client authentication. Windows for Workgroups and Windows 3.1 cannot utilize this method by default, but may be upgraded to do so. </p>
<p>
Using NTCR authentication is one of many requirements to be met if you want your network to be C2 compliant. NTCR requires that you run an NTCR-compatible application such as Internet Explorer 3.0 with the Web Proxy.</p>
<p>
The WinSock Proxy provides access control similar to that of the Web Proxy. When access control is enabled, the WinSock Proxy authenticates all users with the Windows NT Challenge/Response method. When access control is disabled, the WinSock Proxy allows anonymous access.</p>
<p>
In the WinSock Proxy, if access control is disabled, then all users have access. This is the equivalent of disabling access control in the Web Proxy. If access control is enabled, then only those granted permission to the specific protocols may access the Proxy Server.</p>
<h3>Issue</h3>
<p>
<b>Unauthorized Access to Services</b>—Administrators and managers may wish to limit user access to specific Internet protocols and specific network ports. These limitations may vary based on individual user profiles or group membership. </p>
<h3>Feature</h3>
<p>
The Microsoft Proxy Server has the capability of securing both out-bound and in-bound Internet access down to specific individuals or groups of individuals for the specific protocols. This can be enforced using the Proxy Server’s Properties and Permissions function for either WinSock Proxy or Web Proxy. This makes it possible to limit particular proxy services to as fine a degree as an organization feels is appropriate.</p>
<p>
<b>User Level: Access Control</b>—This feature is controlled in the Permissions Property Sheet for both the Web Proxy and the WinSock Proxy. Individual users or groups of users may be granted permissions to use any individual protocol within the Proxy Server. Users who are not explicitly given access to a protocol are not permitted to access that protocol.</p>
<p>
<b>Global Level: Disable Port/Protocol</b>—The WinSock Proxy permits an entire protocol to be disabled from access. Protocols not listed in the Protocol Description Property Sheet are automatically disabled from any access. Protocols listed in the property sheet are available unless the individual ports listed within the protocol are disabled. Protocols may disabled by denying user access to them or by removing their definition from the WinSock Proxy’s protocols tab.</p>
<p>
The WinSock Proxy provides an additional protocol known as Unlimited. This protocol provides those granted access with unlimited access to all protocols defined for the WinSock Proxy. Unlimited access also provides an override to any filters that may be in place.</p>
<h3>Issue</h3>
<p>
<b>Visibility of Internal Network Addresses to the Internet</b>—Providing transparent access from an internal or private network to the public or external network while masking or protecting the internal network.</p>
<h3>Feature</h3>
<p>
<b>Proxy Architecture—</b>The Proxy Server provides IP address aggregation. This means that for every client request it receives, the Proxy Server issues that request to the external network using its external IP address, thus concealing the internal network addresses from the outside. When services are proxied by the Microsoft Proxy Server, the source IP address of each service request is re-mapped to that of the Proxy Server external network adapter. This ensures that the external services and/or any unauthorized party cannot determine the internal network addresses of client stations and later attempt to penetrate those stations through some other open access point (for example, a non-authenticating terminal server or a passive routing device that may be open).</p>
<h3>Issue</h3>
<p>
<b>Unauthorized Access to Cached Data</b>—Data from the World Wide Web, such as sites visited and information viewed, is sometimes stored for faster access by other users. These data could contain sensitive information and need to be protected from inadvertent or unauthorized viewing.</p>
<h3>Feature</h3>
<p>
The Microsoft Proxy Server provides caching for http resources accessed on the Internet from internal network computers. The Proxy Server cache is checked prior to all Internet data requests to see if the requested data resides in the cache.</p>
<p>
<b>SSL Not Cached—</b>A security feature of this caching is that no http pages are ever cached. This prevents one user from inadvertently viewing data that was issued to another user while in a secure mode.</p>
<p>
<b>NTFS Support—</b>The Windows NT File System (NTFS) provides security and access control for your data files. By using NTFS, you can limit access to portions of your file system for specific users and services. This will help block access to cached data, as individual users need no access to the cache directory.</p>
<p>
<b>User Authentication Resources Not Cached</b>—Any authenticated resources are not stored in cache at any time. This prevents any access to user account and password information. This feature is enabled by default. </p>
<h3>Issue</h3>
<p>
<b>System Detection and Probing—</b>Certain TCP/IP network protocol ports, if active, may be used by hackers to gather information about a network or as a possible penetration point to a network. Information is gathered about listening network ports through the use of the freely available network scanning tools.</p>
<h3>Feature</h3>
<p>
<b>Disabling of Specific Network Ports</b>—The Windows NT Server that hosts the Microsoft Proxy Server implementation listens for network connections on various ports depending on which services are active in the Web Proxy and the WinSock Proxy. Certain other ports such as 47, 135, 137, 138, and 139, are active and may be disabled through the Windows NT Server’s registry and by changing the bindings on the network interface card. Bindings are modified under the Bindings tab of the network icon. This icon is available through the control panel. More information on how to disable these ports is found in the Appendices of this document.</p>
<h3>Issue</h3>
<p>
<b>Denial of Service Attacks</b>—The “Denial of Service Attack” uses automated tools to flood the port(s) of the system providing access to the network with requests for connection, which will be denied. Flooding the entry ports exploits the fact that a single point of control can also be a single point of failure. These attacks cause a server to become so occupied with the attack that it either crashes or only responds to the attack scenario preventing any legitimate uses of the server.</p>
<h3>Feature</h3>
<p>
Many features of the UNIX operating system that could be used in denial of service attacks are functions that are not available in a standard Windows NT Server installation. These features include server services for finger, rexec, rlogin, and so on. In addition, telnet attempts to an open port produced a successful packet acknowledgment preventing the “SYN” attack.</p>
<h3>Issue</h3>
<p>
<b>Data Privacy</b>—Ensuring that data transmitted between the Proxy Server and the clients is secure and unreadable.</p>
<h3>Feature</h3>
<p>
<b>SSL Tunneling</b>—The tunneling of the Secure Sockets Layer (SSL) protocol is enabled by default within the Proxy Server when a user is granted access to the Web Proxy. This feature provides for an SSL session between the server and the client computer. This is supported in a browser like Internet Explorer 3.0.</p>
<p>
For information on securing Microsoft Proxy Server, refer to <a href="#proxyappc">Appendix C—Microsoft Proxy Server Security Checklist</a> and <a href="#proxyappe">Appendix E—Suggested Baseline Security Configuration</a>.</p>
<h2><a name="proxytestapproach"></a>Test Case Approach</h2>
<p>
C&amp;L evaluated Microsoft Proxy Server by creating a test environment, developing an objective test case approach, executing the test cases, and interpreting test case results.</p>
<p>
The most significant component of the approach is the test cases, which focus on four test areas: Installation, Configuration, Function, and Penetration. Each test area contains tests designed to satisfy test area objectives. This section describes the test areas and objectives.</p>
<h3><a name="proxytestfindings"></a>Test Case Findings Summary</h3>
<p>
A total of 15 test cases were run, in the four areas described below, during the testing of the Microsoft Proxy Server. These test cases show that Microsoft Proxy Server can be easily configured to a maximum level of security; however, creating the most secure Microsoft Proxy Server configuration requires thought and planning, as with any product installation. In addition, the penetration test cases using standard tools showed no vulnerabilities, but some unexpected TCP/IP ports were visible and would need to be disabled.</p>
<p>
In summary, the results of the following test cases show that the Microsoft Proxy Server can provide a reasonable and practical level of security for a wide variety of installations.</p>
<h3><a name="proxyinstall"></a>Installation Tests</h3>
<p>
The objective of the installation test is to identify any security-related installation options, and evaluate the security implications of the installation options and overall installation procedure.</p>
<h3><a name="proxyconfig"></a>Configuration Tests</h3>
<p>
The objective of the configuration test area is to identify any security-related configuration options, and to evaluate security when Microsoft Proxy Server is configured with default, minimum, or maximum security settings.</p>
<h3><a name="proxyfunction"></a>Function Tests</h3>
<p>
The objective of the function test area is to evaluate Microsoft Proxy Server’s ability to provide proxy services and disallow traffic when certain security features are activated, and evaluate the logging functionality.</p>
<h3><a name="proxypenetration"></a>Penetration Tests</h3>
<p>
The objective of the penetration test area is to evaluate Microsoft Proxy Server’s external vulnerabilities. The penetration tests were designed to use a combination of standard Internet tools that determine vulnerabilities of common Internet-connected servers, in addition to special C&amp;L methods and tools designed to exploit specific Internet vulnerabilities and Microsoft Proxy Server specific vulnerabilities (based on our understanding of how it was designed).</p>
<p>
<a href="#proxyappd">Appendix D—Output of ISS Safesuite Scans</a> contains the actual output from one of the automated tools used during these tests.</p>
<p>
The <a href="#proxyinterconnectivity">Interconnectivity Security Issues and Microsoft Proxy Server Security Features</a> section of this document provides additional information along with the implications of the issues addressed in the Test Case Results sections.</p>
<h2><a name="proxyinstallsumm"></a>Installation Test Case Results Summary</h2>
<h3>Test Case PROX-I-1</h3>
<h4>Objective </h4>
<p>
Assess security implications of Microsoft Proxy Server installation procedure and installation options.</p>
<h4>Observations</h4>
<p>
The Microsoft Proxy Server installation procedure did not appear to reveal any serious security issues.</p>
<p>
<b>Issue</b></p>
<p>
Careful configuration of the LAT is necessary for maximum security.</p>
<p>
<b>Description</b></p>
<p>
The LAT is configured in the Local Address Table (“LAT”) Configuration window. This option requires basic knowledge of the internal network’s addresses. It is important to configure the LAT correctly because an address range greater than the internal network’s is unnecessary for Microsoft Proxy Server functionality and could produce security openings in the Proxy Server. Refer to the <a href="#proxyinterconnectivity">Interconnectivity Security Issues and Microsoft Proxy Server Security Features</a> section of this document for additional information and the implications of this feature.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
The LAT can be constructed automatically using the addresses of the Proxy Server’s routing table or the standard private address ranges. This is accessible through the Construct Local Address Table window. Refer to <a href="#proxyappe">Appendix E—Baseline Security Configuration</a> for the recommended baseline implementation of this feature.</p>
<p>
<b>Issue</b></p>
<p>
Accessibility of cached data to users on the internal network.</p>
<p>
<b>Description</b></p>
<p>
Microsoft Proxy Server provides caching for HTTP resources accessed on the Internet from internal client stations. The Proxy Server cache is checked prior to all Internet data requests. Cached data is stored on disk. Certain users have access to the disk where the cache resides.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
A security feature of this caching is that HTTP-S pages and user-authenticated objects are not cached. This prevents one user from inadvertently viewing data that was issued to another user while in a secure mode. In addition, the cached data should be stored on a Windows NT NTFS partition, which will utilize Windows NT file security.</p>
<h2><a name="proxyconfigsumm"></a>Configuration Test Case Results Summary</h2>
<h3>Test Case PROX-C-1</h3>
<h4>Objective </h4>
<p>
Identify and assess Microsoft Proxy Server default security configuration and assess security implications.</p>
<h4>Observations</h4>
<ul type=disc>
<li>
The default configuration did not appear to reveal any serious security configuration issues.<br><br></li>
<li>
No permissions have been granted to connect with any protocol, thereby preventing access to everyone.<br><br></li>
<li>
Logging is enabled, thereby providing administration with activity documentation.<br><br></li>
<li>
Web publishing is disabled, thereby preventing Internet publishing.</li>
</ul>
<p>
<b>Issue</b></p>
<p>
Internet Information Server Services may be running.</p>
<p>
<b>Description</b></p>
<p>
One should also note that Internet Information Server (IIS) is installed when Windows NT Server Version 4.0 is installed. All IIS services (WWW, Gopher, and FTP) are started by default.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
The WWW IIS services are configured to prevent publishing to the Internet. For maximum security, the FTP and Gopher IIS services should be stopped. The Microsoft-provided <a href="#proxyappc">Appendix C—Server Security Checklist</a> discusses services.</p>
<h3>Test Case PROX-C-2</h3>
<h4>Objective </h4>
<p>
Assess Microsoft Proxy Server configuration options security when set to a minimal (as close to none<i> </i>as possible) level of security.</p>
<h4>Observations</h4>
<p>
Microsoft Proxy Server can be configured to a minimal level of security. Although not recommended, this level of security may be adequate for certain environments.</p>
<p>
<b>Issue</b></p>
<p>
Microsoft Proxy Server can easily be configured to a minimal level of security.</p>
<p>
<b>Description</b></p>
<p>
A minimal level of configurable security may include user-level access control disabled, logging disabled, and Internet Web publishing enabled. As noted in Test Case PROX-C-1, Microsoft Proxy Server does not configure to this minimal level of security by default. The administrator must configure Microsoft Proxy Server to these settings.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
The minimally secure configuration can easily be avoided through proper planning and completely understanding the features. The Microsoft provided <a href="#proxyappc">Appendix C—Server Security Checklist</a> and <a href="#proxyappe">Appendix E—Baseline Security Configuration</a> along with hard copy documentation and on-line help descriptions of the security features, are tools that can be used to plan and understand the features. The converse to this scenario is presented in Test Case PROX-C-3.</p>
<h3>Test Case PROX-C-3</h3>
<h4>Objective </h4>
<p>
Assess Microsoft Proxy Server configuration options security when set to a maximum level of security.</p>
<h4>Observations</h4>
<p>
<b>Issue</b></p>
<p>
Microsoft Proxy Server can be easily configured to a maximum level of security; however creating the most secure Microsoft Proxy Server configuration requires thought and planning.</p>
<p>
<b>Description</b></p>
<p>
A maximum level of configurable security may include access control, verbose logging to files that are automatically created and saved on a daily basis, and Internet Web publishing disabled. As noted in Test Case PROX-C-1, Microsoft Proxy Server does not configure to this maximum level of security by default. The administrator must configure access control and logging.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
The Administrator must select the correct level of access without denying needed services. The maximum secure configuration can be accomplished through proper planning and completely understanding the features. The Microsoft-provided <a href="#proxyappc">Appendix C—Server Security Checklist</a> and <a href="#proxyappe">Appendix E—Baseline Security Configuration</a> along with hard copy documentation and on-line help descriptions of the security features, are tools that can be used to plan and understand the features. The converse to this scenario is presented in Test Case PROX-C-2.</p>
<h3>Test Case PROX-C-4</h3>
<h4>Objective </h4>
<ul type=disc>
<li>
Determine if a Microsoft Proxy Server can be configured to function as an IP router.<br><br></li>
<li>
Determine the risk of this event happening inadvertently.</li>
</ul>
<h4>Observational requirements</h4>
<ul type=disc>
<li>
Observe and document the state of Windows NT IP routing pre- and post-installation of Microsoft Proxy Server.<br><br></li>
<li>
Document any options during Microsoft Proxy Server installation which may cause different results.</li>
</ul>
<h4>Observations</h4>
<ul type=disc>
<li>
Windows NT routing is referred to as IP Forwarding. This feature is not selected by default.<br><br></li>
<li>
Windows NT routing is controlled by an IP Forwarding checkbox located in the TCP/IP protocol definition window.<br><br></li>
<li>
The state of the checkbox was unaffected by the installation of Microsoft Proxy Server.<br><br></li>
<li>
When Microsoft Proxy Server is installed, there is no warning if IP Forwarding is active.<br><br></li>
<li>
The internal card on PROXY-1 could be seen from machines outside of the network. Refer to PROX-P-1 for further description of the implications.</li>
</ul>
<p>
<b>Issue</b></p>
<p>
It is possible to configure Microsoft Proxy Server to forward IP traffic between its two network interface cards.</p>
<p>
<b>Description</b></p>
<p>
The IP Forwarding function becomes active when the IP Forwarding checkbox is selected before or after the Microsoft Proxy Server installation. When Microsoft Proxy Server is installed, there is no warning indicating IP Forwarding is active. Risk is incurred for administrators who may select IP Forwarding with Microsoft Proxy Server installed without understanding the consequences.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
This issue can be addressed procedurally. The administrator must be attentive to the status of the IP Forwarding checkbox.</p>
<h2><a name="proxyfuncsumm"></a>Function Test Case Results Summary</h2>
<h3>Test Case PROX-F-1</h3>
<h4>Objective</h4>
<p>
Determine the security impact of configuring the internal (private) network for addresses that are being used on the external (public) network. This is the basis for a spoofing attack if Microsoft Proxy Server does not respond properly in such a configuration.</p>
<h4>Observations</h4>
<ul type=disc>
<li>
This spoofing attempt was unsuccessful.<br><br></li>
<li>
The Microsoft Proxy Server did not allow any packets entering its external interface to reach internal systems, even when the external source address fell within the range specified by the Proxy Servers’ LAT. This result should not be used to justify an improperly configured LAT. If an organization requires the LAT to contain addresses not officially allocated to that organization by the InterNIC (the Internet Network Information Center), every effort should be made to utilize an internal addressing scheme that will not be routed on the Internet.</li>
</ul>
<h3>Test Case PROX-F-2</h3>
<h4>Objective </h4>
<p>
Test the level of access between internal and external networks when the internal client does not have Microsoft Proxy Server client software installed or if both the external and internal machines run a non-Microsoft Proxy Server–supported operating system.</p>
<h4>Observations</h4>
<p>
Microsoft Proxy Server successfully prevented non-proxy clients from using services beyond the Proxy Server.</p>
<h3>Test Case PROX-F-3</h3>
<h4>Objective </h4>
<p>
Test the functionality of Microsoft Proxy Server’s logging mechanism.</p>
<h4>Observations</h4>
<p>
<b>Issue</b></p>
<p>
Configuration of the logging feature.</p>
<p>
<b>Description</b></p>
<p>
The logging processes gather a significant amount of information about any connected process. This makes the logging facility a valuable tool for tracking system usage and monitoring individual user activity. Without logging, the ability of the system administrator to track the system usage and to prevent unauthorized activity is severely limited. Operating the Microsoft Proxy Server without logging should be considered insecure.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
As indicated in Test Case PROX-C-1, regular logging to a new file on a daily basis is selected by default. This configuration may be adequate for certain environments. Test Case PROX-C-3 and <a href="#proxyappe">Appendix E—Baseline Security Configuration</a> provide information on the recommended settings for the logging feature.</p>
<h2><a name="proxypensumm"></a>Penetration Test Case Results Summary</h2>
<h3>Test Case PROX-P-1</h3>
<h4>Objective</h4>
<p>
To determine which IP addresses respond to an ICMP echo (ping) request on the various sub-nets where the Microsoft Proxy Server is attached. The primary objective is to determine which IP addresses answer to untrusted systems connected to the external network.</p>
<h4>Observations</h4>
<ul type=disc>
<li>
All of the systems attached to the external network did not answer the echo request from a system on the internal network. This result was expected.<br><br></li>
<li>
None of the internal network machines answered an echo request from an external network machine.</li>
</ul>
<p>
<b>Issue</b></p>
<p>
The internal adapter of machine PROXY-1 (the dual-homed Proxy Server) unexpectedly answered the echo request from an external system.</p>
<p>
<b>Description</b></p>
<p>
When an echo request is sent to a Microsoft Proxy Server with a destination address of the internal network adapter, the internal adapter will respond. If the response of the internal adapter address is detected by an outside entity, it could aid in designing a more focused attack on the internal network. Although designing a more focused attack may not be directly possible through the Microsoft Proxy Server, the information could be used if another entry point was also identified (i.e., a non-secured dial-in SLIP or PPP line), and later used to penetrate the network.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
Microsoft Proxy Server does not currently address this issue. However, Microsoft Proxy Server prevents visibility and access to the other systems connected to that adapter’s internal network.</p>
<h3>Test Case PROX-P-2</h3>
<h4>Objective</h4>
<p>
To determine which TCP/IP ports a Windows NT Server will answer to when running the Microsoft Proxy Server using the default configuration options.</p>
<h4>Observations</h4>
<p>
<b>Issue</b></p>
<p>
The strobe utility detected seven TCP ports answering to external network connections. Three of these were expected: FTP, HTTP, and Gopher. Four of these were unexpected: NI FTP (port 47), Location Server (port 135), NetBIOS (port 139), and Port 1028.</p>
<p>
<b>Description</b></p>
<p>
Each of the TCP/IP service ports identified by “Strobe” represents a possible avenue of external attack by other TCP/IP service-specific penetration tools and techniques. In the penetration test cases that follow this test, each of the significant responding ports are further tested for security vulnerabilities.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
This issue can be addressed procedurally. Many of the identified ports can be disabled. The Microsoft-provided <a href="#proxyappc">Appendix C—Server Security Checklist</a> provides guidance on disabling ports 47, 139, and 1028 on the external adapter of a Windows NT Server running Microsoft Proxy Server. FTP port 21 and gopher port 70 can be disabled using the<i> </i>Internet Information Server management tool. Port 135 cannot currently be disabled. The RPC service will unconditionally listen on port 135 on all interfaces, and relies on Windows NT RPC authentication for security; however, our testing did not show any vulnerability related specifically to this issue.</p>
<h3>Test Case PROX-P-3</h3>
<h4>Objective</h4>
<p>
To determine if the Microsoft Proxy Server is susceptible to any of the common Internet weaknesses identified by the Internet Security Scanner (ISS) public domain security analyzer/tool.</p>
<p>
The ISS utility will analyze all target systems for the following Internet risks and/or vulnerabilities:
<ul type=disc>
<li>
Existence and misconfiguration of default accounts (guest, lp, sync, and so on)<br><br></li>
<li>
Anonymous FTP vulnerabilities<br><br></li>
<li>
NIS (Sun Naming Server) exposures (that is, ability to capture copy of password file)<br><br></li>
<li>
NFS exposures (that is, directories readable/writable by the world)<br><br></li>
<li>
Mail vulnerabilities (that is, existence of common aliases)<br><br></li>
<li>
RPC (Remote Procedure Call) exposures<br><br></li>
<li>
Remote Command (rcp, rlogin. rexec) vulnerabilities<br><br></li>
<li>
Boot server vulnerabilities</li>
</ul>
<h4>Observations</h4>
<ul type=disc>
<li>
This tool did not identify any vulnerabilities.<br><br></li>
<li>
In order for a potential system attacker to use this tool, it will be necessary for them to make some code modifications to the standard FreeWare release. Refer to test case PROX-P-7 for the results of the commercial version of this penetration testing tool.<br><br></li>
<li>
The ISS utility, in its FreeWare and unmodified release form, did not attempt to perform any of its tests beyond the initial port scan (and this required using the -p command line option).</li>
</ul>
<h3>Test Case PROX-P-4</h3>
<h4>Objective</h4>
<p>
To determine if the Microsoft Proxy Server is susceptible to any of the common Internet weaknesses identified by the Satan public domain security analyzer/tool.</p>
<p>
The Satan<i> </i>utility will analyze all target systems for the following additional (over ISS) Internet risks and/or vulnerabilities:
<ul type=disc>
<li>
HTTP vulnerabilities<br><br></li>
<li>
UDP port existence and vulnerabilities<br><br></li>
<li>
Additional TCP port vulnerabilities</li>
</ul>
<h4>Observations</h4>
<ul type=disc>
<li>
Satan did not identify any vulnerabilities.</li>
</ul>
<p>
<b>Issue</b></p>
<p>
The only issue reported by the Satan utility was its ability to identify that the Proxy Server was offering an Anonymous FTP service.</p>
<p>
<b>Description</b></p>
<p>
The Anonymous FTP service is an optional part of the Windows NT Server that was configured by default prior to the installation of the Proxy Server. The FTP service is installed as part of the Internet Information Server. The presence of Anonymous FTP service represents a possible avenue of external attack if misconfigured. Test Case PROX-P-5 tests this for security vulnerabilities within the FTP service.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
This issue can be addressed procedurally. FTP port 21 can be disabled using the<i> </i>Internet Information Server management tool.</p>
<h3>Test Case PROX-P-5</h3>
<h4>Objective</h4>
<p>
To attempt manual anonymous FTP penetration attempts.</p>
<h4>Observations</h4>
<p>
<b>Issue</b></p>
<p>
The FTP Server allowed the external system to gain a successful anonymous login.</p>
<p>
<b>Description</b></p>
<p>
The Anonymous FTP service is an optional part of the Windows NT Server that was configured by default prior to the installation of the Proxy Server. The FTP service is installed as part of the Internet Information Server. The presence of Anonymous FTP service represents a possible avenue of external attack.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
The coexistence of a properly configured (which is the default) FTP server in the same system with the Microsoft Proxy Server does not appear to present any additional vulnerabilities to the proxy service, Windows NT operating system, or the internal network behind the server. The FTP server allowed the external system to gain a successful anonymous login. The default-configured FTP server could not be compromised through standard manual penetration techniques as listed in this test case. In addition, if not required, FTP port 21 can be disabled.</p>
<h3>Test Case PROX-P-6</h3>
<h4>Objective</h4>
<p>
To attempt to exploit the fact that the Microsoft Proxy Server allows connections to the unused TCP/IP port 47 (as a previous run of strobe detected). C&amp;L focused on this port because it is the only additional port that started accepting TCP/IP connection requests after the Proxy Server was installed and is identified by Microsoft as a port that can be used to administrate the Proxy Server.</p>
<h4>Observations</h4>
<ul type=disc>
<li>
Port 47 on the Proxy Server allowed a successful telnet from an external system.<br><br></li>
<li>
None of the manual telnet or ftp commands received any response from the Proxy Server.<br><br></li>
<li>
Although attempts at initiating 100 telnet sessions appeared to be successful, when the netstat command was issued on the Proxy Server, it indicated a single inactive connection to port 47<i>. </i>The Microsoft Proxy Server continued to function normally during and after these 100 telnet sessions were attempted.<br><br></li>
<li>
The Network Monitor indicated that the Proxy Server answered each telnet request with a good initial TCP/IP ACK.</li>
</ul>
<p>
<b>Issue</b></p>
<p>
Microsoft Proxy Server allows connections to port 47.</p>
<p>
<b>Description</b></p>
<p>
The ability to connect to port 47 represents a possible avenue of external attack by more service-specific penetration tools and techniques.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
This issue can be addressed procedurally. Port 47 can be disabled. The Microsoft-provided <a href="#proxyappc">Appendix C—Server Security Checklist</a> provides guidance on disabling port 47 on the external adapter of a Windows NT server running Microsoft Proxy Server. In addition, there seem to be no security implications in Microsoft Proxy Server’s allowing connections to port 47. A denial of service attack does not appear to be effective against this open port.</p>
<h3>Test Case PROX-P-7</h3>
<h4>Objective</h4>
<ul type=disc>
<li>
To determine if the Microsoft Proxy Server is susceptible to any of the Internet weaknesses identified by the commercial version of the Internet Security Scanner version 4.0.3 by Internet Security Systems, Inc.<br><br></li>
<li>
The commercial ISS SafeSuite utility will analyze all target systems with an intense series of platform- and network-related vulnerabilities.</li>
</ul>
<h4>Observations</h4>
<ul type=disc>
<li>
The Microsoft Proxy Server, when configured properly, does not appear to be vulnerable to attack from the ISS SafeSuite Internet scanner.<br><br></li>
<li>
Attempts were made to initially have the ISS Scanner run all possible tests against the Microsoft Proxy Server, however, two of the tests had to be disabled to prevent the ISS scanner from hanging. These test included:<ul type=disc>
<li>
The Brute Force <b>Rsh</b> test<br><br></li>
<li>
The <b>X Windows</b> test</li>
</ul>
</li>
</ul>
<p class=indent>
<B><b>Note&nbsp;&nbsp;&nbsp;</b></B>The above two tests do not apply to any of the services offered by or answered to by Microsoft Proxy Server. Therefore, their exclusion should have no impact on the overall test results.
<ul type=disc>
<li>
A total of eighty-nine (89) ISS SafeSuite tests were performed.</li>
</ul>
<p>
<b>Issue</b></p>
<p>
The only issue raised by the ISS tool was that the Proxy Server allowed trace routing packets to be passed between its two network interfaces.</p>
<p>
<b>Description</b></p>
<p>
Trace routing is when a router allows packet routing information to be echoed through to both attached networks. This information can be helpful to attackers in determining internal network addressing schemes when looking to exploit weaknesses on other systems connected to the internal network. This issue was also identified in Test Case PROX-P-1 when the Proxy Server allowed its internal network adapter to respond to a general echo (ping) request. This issue was noted because the Proxy Server’s internal network adapter answered.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
Microsoft Proxy Server does not currently address this issue. However, as noted in Test Case PROX-P-1, Microsoft Proxy Server prevents visibility and access to the other systems connected to the internal adapter’s network. This seems to have no apparent security implication.</p>
<h2><a name="proxyappa"></a>Appendix A—Test Specification</h2>
<p>
The following table presents the test lab equipment specification and configuration(s):</p>
<p class=label>
<b>Test Lab SPEC-1</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=19%><b>Computer Name Workgroup</b></td>
<td class=label width=16%><b><br>
Network Protocol</b></td>
<td class=label width=65%><b><br>
<br>
Operating System and Hardware Configuration</b></td>
</tr>
<tr valign=top>
<td width=19%>PROXY-1<p>
PROXY-0</p>
</td>
<td width=16%>TCP/IP</td>
<td width=65%>Windows NT Server version 4.0<p>
Microsoft Proxy Server</p>
<p>
Intel® Pentium class CPU (133 -&gt; 166 MHz)</p>
<p>
32 megabytes of RAM</p>
<p>
One 1.2 gigabyte hard drive</p>
<p>
Two Ethernet adapters (Windows NT compatible)</p>
<p>
Internal 0x300, IRQ 10, 10 base T</p>
<p>
External 0x270, IRQ 7, 10 base T</p>
<p>
Dual/quad speed CD-ROM Drive</p>
<p>
3.5" floppy drive</p>
<p>
15" SVGA color monitor</p>
</td>
</tr>
<tr valign=top>
<td width=19%>IR-1<p>
WG-1</p>
</td>
<td width=16%>NetBEUI<p>
TCP/IP</p>
</td>
<td width=65%>Windows NT Workstation 4.0<p>
Windows95</p>
<p>
SCO UNIX</p>
<p>
Microsoft Proxy Server client</p>
<p>
Intel Pentium class CPU (133 -&gt; 166 MHz)</p>
<p>
32 megabytes of RAM</p>
<p>
Two 1.2 gigabyte hard drive</p>
<p>
One Ethernet adapter (Windows NT and Win3.1/Windows 95 compatible)</p>
<p>
28.8 Kbps modem</p>
<p>
Dual/quad speed CD-ROM drive</p>
<p>
3.5" floppy drive</p>
<p>
15" SVGA color monitor</p>
</td>
</tr>
<tr valign=top>
<td width=19%>PPTP-1<p>
ROUTE-0</p>
</td>
<td width=16%>NetBEUI<p>
TCP/IP</p>
</td>
<td width=65%>Windows NT Server version 4.0<p>
Microsoft Proxy Server client</p>
<p>
Intel Pentium class CPU (133 -&gt; 166 MHz)</p>
<p>
32 megabytes of RAM</p>
<p>
One 1.2 gigabyte hard drive</p>
<p>
Two Ethernet adapters (Windows NT Compatible)</p>
<p>
28.8 Kbps modem</p>
<p>
Dual/quad speed CD-ROM drive</p>
<p>
3.5" floppy drive</p>
<p>
15" SVGA color monitor</p>
</td>
</tr>
<tr valign=top>
<td width=19%>ER-1<p>
WG-2</p>
</td>
<td width=16%>NetBEUI<p>
TCP/IP</p>
</td>
<td width=65%>Windows NT Server version 4.0<p>
Intel Pentium class CPU (133 -&gt; 166 MHz)</p>
<p>
32 megabytes of RAM</p>
<p>
One 1.2 gigabyte hard drive partitioned</p>
<p>
One Ethernet adapters (Windows NT and SCO UNIX compatible)</p>
<p>
Dual/quad speed CD-ROM drive</p>
<p>
3.5" floppy drive</p>
<p>
15" SVGA color monitor</p>
</td>
</tr>
<tr valign=top>
<td width=19%>NT3.51-BOX<p>
TEST</p>
</td>
<td width=16%>TCP/IP</td>
<td width=65%>Windows NT Server 3.51<p>
Microsoft Proxy Server client</p>
<p>
Intel 486 class CPU (66 MHz)</p>
<p>
32 megabytes of RAM</p>
<p>
One 1.2 gigabyte hard drive</p>
<p>
One Ethernet adapters (Windows NT Compatible)</p>
<p>
Dual/quad speed CD-ROM drive</p>
<p>
3.5" floppy drive</p>
<p>
15" SVGA color monitor</p>
</td>
</tr>
<tr valign=top>
<td width=19%>AIX-BOX</td>
<td width=16%>TCP/IP</td>
<td width=65%>IBM RS/6000 model 530<p>
32 megabytes of RAM</p>
<p>
One 1.2 gigabyte hard drive</p>
<p>
One Ethernet adapter </p>
<p>
CD-ROM drive</p>
<p>
3.5" floppy drive</p>
<p>
19" SVGA color monitor</p>
<p>
AIX v3.2.5</p>
</td>
</tr>
</table><br>
<h4>Miscellaneous hardware</h4>
<ul type=disc>
<li>
Three 8-port UTP network hubs<br><br></li>
<li>
Five 25' Cat-5 UTP cables with RJ-45 connectors and straight-through wiring<br><br></li>
<li>
Two 50' Cat-5 UTP cables with RJ-45 connectors and straight-through wiring<br><br></li>
<li>
One PCMCIA Ethernet adapter—3-Com 3C589 (used on a laptop system running UNIX in order to simulate a network router)</li>
</ul>
<h2><a name="proxyappb"></a>Appendix B—Test Lab Network Diagrams</h2>
<p>
The following diagrams present the multiple test lab configurations used for testing. These diagrams detail computer names, IP addresses, default gateways, subnet masks, peripheral equipment, and network connections:</p>
<p class=label>
<b>Test Lab DIAG-1</b></p>
<p>
<img src="proxy1.gif" border=0></p>
<p class=label>
<b>Test Lab DIAG-2</b></p>
<p>
<img src="proxy2.gif" border=0></p>
<p class=label>
<b>Test Lab DIAG-3</b></p>
<p>
<img src="proxy3.gif" border=0></p>
<p class=label>
<b>Test Lab DIAG-4</b></p>
<p>
<img src="proxy4.gif" border=0></p>
<h2><a name="proxyappc"></a>Appendix C—Server Security Checklist </h2>
<p>
Connecting computers to the Internet provides for some very powerful and useful scenarios. It becomes possible to communicate with millions of people and computers worldwide using the TCP/IP protocols. This broad flexibility imposes a degree of risk: Not only can you communicate with people and systems using the protocols that you choose, but it is also possible for users to attempt to initiate communication with your systems. </p>
<h3><a name="proxyreducing"></a>Reducing Security Risks</h3>
<p>
The following list should be reviewed to learn how to reduce security risks. </p>
<h4>If your private network runs TCP/IP, the Server’s Enable IP Forwarding check box in the Network application should not be selected. </h4>
<p>
Clearing the Enable IP Forwarding check box prevents unauthorized IP packets from infiltrating your network. The Enable IP Forwarding check box is located in the Microsoft TCP/IP Properties dialog box. Access this through the Network application in Control Panel. </p>
<p>
<b>To disable IP forwarding on Windows NT Server version 4.0: </b>
<ol>
<li>
From the Start menu, select Settings, and then click Control Panel.<br><br></li>
<li>
In Control Panel, double-click the Network icon.<br><br></li>
<li>
In the Network dialog box, click the Protocols tab, select TCP/IP Protocol, and then click Properties.<br><br></li>
<li>
In the Microsoft TCP/IP Properties dialog box, click Routing.<br><br></li>
<li>
Make sure the check box for Enable IP Forwarding is cleared.<br><br></li>
<li>
Click OK, then click OK again. </li>
</ol>
<p class=indent>
<B><b>Warning&nbsp;&nbsp;&nbsp;</b></B>If the Windows NT Remote Access Service (RAS) is installed on your gateway after Microsoft Proxy Server is installed, IP forwarding will be enabled. You must disable IP forwarding after installing RAS. </p>
<h4>Use NTFS volumes</h4>
<p>
The Windows NT File System (NTFS) provides security and access control for your data files. By using NTFS, you can limit access to portions of your file system for specific users and services.</p>
<h4>Run only the services that you need</h4>
<p>
The fewer services you are running on your system, the less likely it is that a mistake will be made in administration that could be exploited. Use the Services application in Control Panel to disable any services not absolutely necessary on your system. </p>
<h4>Unbind unnecessary services from your Internet adapter cards</h4>
<p>
Use the Bindings feature in the Network application in Control Panel to unbind any unnecessary services from any network adapter cards connected to the Internet. </p>
<p>
For example, you might use the Server service to upload new images and documents from computers in your internal network, but you might not want users to have direct access to the Server service from the Internet. If you need to use the Server service on your private network, the Server service binding to any network adapter cards connected to the Internet should be disabled. </p>
<p>
You can use the Windows NT Server service over the Internet; however, you should fully understand the security implications and comply with Windows NT Server licensing requirements. (When you are using the Windows NT Server service you are using Microsoft networking—that is, the Server Message Block [SMB] protocol—and all Windows NT Server licensing requirements still apply.) </p>
<p>
The FTP Server service included with Windows NT should also be disabled or configured to ensure adequate security. </p>
<h4>Check permissions set on network shares</h4>
<p>
If you are running the Server service on your Internet adapter cards, be sure to double-check the permissions set on the shares you have created on the system. It is also wise to double-check the permissions set on the files contained in the shares’ directories to ensure that you have set them appropriately. </p>
<h4>Enable auditing</h4>
<p>
You can enable auditing of NTFS files and directories on Windows NT Server. This is done using Windows Explorer and is a useful mechanism to ensure that you have set the appropriate permissions on your shares. </p>
<h4>Limit the membership of the Administrator group</h4>
<p>
By limiting the members of the Administrator group, you limit the number of users who might choose bad passwords. </p>
<h4>Enforce strict account policies</h4>
<p>
User Manager for Domains provides configuration options called security policies, such as one that allows a system administrator to specify how quickly account passwords expire (forcing users to regularly change passwords), and another that determines how many bad logon attempts will be tolerated before a user is locked out. Use the User Manager for Domains security policies to configure the Server against exhaustive or random password attacks. </p>
<h4>Choose good password</h4>
<p>
Although this may seem obvious, a stolen or easily guessed password is the best opportunity for someone to gain access to your system. Make sure that all users on the system, especially those with administrative rights, have difficult-to-guess passwords. In particular make sure to select a good administrator password (long, mixed-case, alphanumeric password) and set the appropriate account policies. Passwords can be set using Windows NT User Manager for Domains.</p>
<h4>Disable certain external TCP/IP ports</h4>
<p>
Certain listening ports such as 47, 137, 138, 139, and 1028 can be disabled. The following procedures can be used to disable these ports.</p>
<p>
<b>Disabling port 47 </b></p>
<p>
This port is used by the Proxy Server administrator’s tool (over TCP/IP with RPC calls). </p>
<p>
Procedure:
<ol>
<li>
As the Administrator, run the regedt32.exe tool.<br><br></li>
<li>
Select the HKEY_LOCAL_MACHINE window.<br><br></li>
<li>
Expand the System key, then the Current Control Set key, then the Services key, then the W3Proxy key, and finally the Parameters key.<br><br></li>
<li>
Select the RpcBindings value and edit its value from 7 to 6.<br><br></li>
<li>
Close the local registry using the FILE drop-down menu.<br><br></li>
<li>
Shut down and restart the server.</li>
</ol>
<p>
Implications:</p>
<p>
None</p>
<p>
<b>Disabling ports 137 through 139</b></p>
<p>
This procedure is used to disable Windows NT TCP/IP from listening on ports 137, 138, 139:</p>
<p>
Procedure:
<ol>
<li>
Open Control Panel, Network, Bindings<br><br></li>
<li>
Select to show bindings for all adapters<br><br></li>
<li>
Disable entire WINS client* (TCP/IP) for the external network interface card.</li>
</ol>
<p>
Implications:</p>
<p>
NetBIOS will not be accessible on the external (Internet) network interface.</p>
<p>
<b>Disabling port 102x </b></p>
<p>
Ports 1024 through 1029 are allocated by Windows NT for RPC listen TCP/IP services. This procedure allows it to be configured to listen only on the internal IP interface, and as a result, these ports will no longer be visible to the Internet.</p>
<p>
Procedure:
<ol>
<li>
As the Administrator, run the regedt32 tool.<br><br></li>
<li>
Select the HKEY_LOCAL_MACHINE window.<br><br></li>
<li>
Expand the System key, then the Current Control Set key, then the Services key.<br><br></li>
<li>
Look for the entry for your internal network adapter and record the key name used (for example, <i>Elnk1</i>)<br><br></li>
<li>
Create a new key of RPC, then expand that key.<br><br></li>
<li>
Create a new key of Linkage, then expand that key.<br><br></li>
<li>
Create a new key of Bind (as type REG_MULTI_SZ), then expand that key.<br><br></li>
<li>
You will now be in HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Rpc\Linkage\Bind<br><br></li>
<li>
Create a new value equal to the name of your internal adapter identified in Step 4 (no actual value needs to be assigned to it)</li>
</ol>
<p>
Implications:</p>
<p>
RPC will only bind to the adapters listed in the HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Rpc\Linkage\Bind. </p>
<h4>Install all service packs</h4>
<p>
All service packs for Windows NT Server version 4.0 and Microsoft Proxy Server should be installed. This will assure that security-related enhancements are incorporated in Microsoft Proxy Server.</p>
<h2><a name="proxyappd"></a>Appendix D—Output of ISS SafeSuite Scans (Abbreviated)</h2>
<p>
Internet Security Scanner ©1994–1996</p>
<p>
ISS SafeSuite V4.0.3</p>
<p>
By Internet Security Systems, Inc.</p>
<p>
Analysis Report</p>
<h3>Summary Report of Vulnerabilities</h3>
<p>
Summary Information</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Hosts Scanned:&nbsp; 1</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Hosts Active:&nbsp; 1</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Hosts Inactive:&nbsp; 0</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Start Time:&nbsp; Thu Oct. 3 12:27:53 1996</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;End Time:&nbsp; Thu Oct. 3 12:33:10 1996</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Total Time:&nbsp; 5 minutes 17 seconds</p>
<p>
Scan Completed Normally</p>
<p>
Total Number of Vulnerability Risks:&nbsp; 1</p>
<p>
Average Number of Vulnerability Risks per Active Hosts:&nbsp; 1.00</p>
<p>
Maximum License Number Reached:&nbsp; 0</p>
<p>
Out of Range:&nbsp; 0</p>
<p>
Open Ports via Socks Service [High Risk]:&nbsp; 0</p>
<p>
Open Defaults found through Telnet [High Risk]:&nbsp; 0</p>
<p>
Open Defaults found through Rexec [High Risk]:&nbsp; 0</p>
<p>
Open Defaults found through FTP [High Risk]:&nbsp; 0</p>
<p>
Open Defaults found through POP3 [High Risk]:&nbsp; 0</p>
<p>
Accounts accessible through Rsh [High Risk]:&nbsp; NA </p>
<p>
X Check [High Risk]:&nbsp; NA </p>
<p>
Uudecode Alias in Sendmail [High Risk]: 0</p>
<p>
Remote Execution Hole in Sendmail [High Risk]:&nbsp; 0</p>
<p>
Wizard Backdoor in Sendmail [High Risk]:&nbsp; 0</p>
<p>
Remote Execution Hole through Identd [High Risk]:&nbsp; 0</p>
<p>
FTP Site Exec Vulnerable [High Risk]:&nbsp; 0</p>
<p>
Rlogin-froot Vulnerability [High Risk]:&nbsp; 0</p>
<p>
Rsh Vulnerable in hosts.equiv [High Risk]:&nbsp; 0</p>
<p>
Rexd [High Risk]:&nbsp; 0</p>
<p>
HTTP (WWW server) port active [High Risk]:&nbsp; 0</p>
<p>
Rsh Vulnerable through TCP Seq Prediction Spoofing [High Risk]:&nbsp; NA</p>
<p>
Rsh Null Vulnerable [High Risk]:&nbsp; 0</p>
<p>
Rlogin Vulnerable through TCP Seq Prediction Spoofing:&nbsp; 0</p>
<p>
Admind [High Risk]:&nbsp; 0</p>
<p>
Mountable [High Risk]:&nbsp; 0</p>
<p>
Mountable via Portmapper [High Risk]:&nbsp; 0</p>
<p>
NFS Mountable via Ultrix Remount Bug [High Risk]:&nbsp; 0</p>
<p>
NFS Writable [High Risk]:&nbsp; 0</p>
<p>
NFS UID Vulnerability [High Risk]:&nbsp; 0</p>
<p>
NFS CD Vulnerability [High Risk]:&nbsp; 0</p>
<p>
NFS MKNOD Vulnerability [High Risk]:&nbsp; 0</p>
<p>
NFS Guess Vulnerability [High Risk]:&nbsp; 0</p>
<p>
NFS Access Files [Medium Risk]:&nbsp; 0</p>
<p>
Dynamic Linker Telnet Vulnerability [High Risk]:&nbsp; 0</p>
<p>
Netbios SMB Easy Password [High Risk]:&nbsp; 0</p>
<p>
Open Defaults found on Cisco device [High Risk]:&nbsp; 0</p>
<p>
Open Administrative Account found on Cisco device [High Risk]:&nbsp; 0</p>
<p>
Remote Execution Hole through Syslog Buffer Overflow [High Risk]:&nbsp; 0</p>
<p>
RPC Statd file creation and removal vulnerability [High Risk]:&nbsp; 0</p>
<p>
HTTP Proxy Penetrated [High Risk]:&nbsp; 0</p>
<p>
FTP Proxy Penetrated [High Risk]:&nbsp; NA </p>
<p>
HTTP (WWW server) port active [High Risk]:&nbsp; 0</p>
<p>
Exploit of phf program in /cgi-bin executed an arbitrary command [High Risk]:&nbsp; 0</p>
<p>
Server indicated presence of potentially exploitable program in /cgi-bin [High Risk]:&nbsp; 0</p>
<p>
A CGI program executed an arbitrary command [High Risk]:&nbsp; 0</p>
<p>
Server allowed exploit of .bat and .cmd bug [High Risk]:&nbsp; 0</p>
<p>
A password-protected WWW resource was accessed by brute force [High Risk]:&nbsp; 0</p>
<p>
Server returned a file listing for a directory that had no index [High Risk]:&nbsp; 0</p>
<p>
Open Defaults found through Telnet on TIS firewall [High Risk]:&nbsp; 0</p>
<p>
Open Defaults found through Telnet on Checkpoint Firewall [High Risk]:&nbsp; 0</p>
<p>
Open Defaults found through FTP on Catapult [High Risk]:&nbsp; 0</p>
<p>
Open Defaults found through Telnet on Raptor firewall [High Risk]:&nbsp; 0</p>
<p>
Files Obtained [Medium Risk]:&nbsp; 0</p>
<p>
Routed service active [Medium Risk]:&nbsp; 0</p>
<p>
UUCP available [Medium Risk]:&nbsp; 0</p>
<p>
Host susceptible to UDP bomb packet [Medium Risk]:&nbsp; 0</p>
<p>
Finger Bomb [Medium Risk]:&nbsp; 0</p>
<p>
TCP Sequence Predictable [Medium Risk]:&nbsp; 0</p>
<p>
Anonymous FTP with writable directories [Medium Risk]:&nbsp; 0</p>
<p>
Wall Daemon [Medium Risk]:&nbsp; 0</p>
<p>
Selection_Svc Vulnerable [Medium Risk]:&nbsp; 0</p>
<p>
TFTP [Medium Risk]:&nbsp; 0</p>
<p>
TFTP Output [Medium Risk]:&nbsp; 0</p>
<p>
NIS passwd via TCP [Medium Risk]:&nbsp; 0</p>
<p>
NIS passwd via UDP [Medium Risk]:&nbsp; 0</p>
<p>
Domain names and NIS Server [Medium Risk]:&nbsp; 0</p>
<p>
NIS Maps [Low Risk]:&nbsp; 0</p>
<p>
Anonymous FTP [Low Risk]:&nbsp; 0</p>
<p>
Netbios SMB Root Share [Medium Risk]:&nbsp; 0</p>
<p>
Netbios SMB Dot Dot Bug [Medium Risk]:&nbsp; 0</p>
<p>
Netbios SMB NT Dot Dot Bug [Medium Risk]:&nbsp; 0</p>
<p>
Chargen Service [Medium Risk]: 0 </p>
<p>
Echo Service [Medium Risk]:&nbsp; 0</p>
<p>
Windows 95 Password Cache Files [Medium Risk]:&nbsp; 0</p>
<p>
RIP tables modified [Medium Risk]:&nbsp; 0</p>
<p>
Sync Storm [Medium Risk]:&nbsp; 0</p>
<p>
Syslog Flood [Medium Risk]:&nbsp; 0</p>
<p>
Data Flood [Medium Risk]:&nbsp; 0</p>
<p>
Exploit of test-cgi script returned listing of /cgi-bin [Medium Risk]:&nbsp; 0</p>
<p>
WWW server returned a listing of the directory above ServerRoot [Medium Risk]:&nbsp; 0</p>
<p>
Netstat [Low Risk]:&nbsp; 0</p>
<p>
Sysstat [Low Risk]:&nbsp; 0</p>
<p>
Bootparam [Low Risk]:&nbsp; 0</p>
<p>
BootparamDom [Low Risk]:&nbsp; 0</p>
<p>
Finger [Low Risk]:&nbsp; 0</p>
<p>
Rusers Output [Low Risk]:&nbsp; 0</p>
<p>
Finger Output [Low Risk]:&nbsp; 0</p>
<p>
SNMP Public Information [Low Risk]:&nbsp; 0</p>
<p>
Verify Account Information about Users with Sendmail [Low Risk]:&nbsp; 0</p>
<p>
Expand Account Information about Users with Sendmail [Low Risk]:&nbsp; 0</p>
<p>
NNTP Daemon [Low Risk]:&nbsp; 0</p>
<p>
Trace Routing of Packets:&nbsp; 1</p>
<p>
Open/Close Connection Flood [Low Risk]:&nbsp; 0</p>
<p>
DNS Open Connection Flood [Low Risk]:&nbsp; 0</p>
<p>
RWHO Daemon Overflow [Low Risk]:&nbsp; 0</p>
<p>
========== End of Report ==========</p>
<p>
Internet Security Scanner ©1994-1996</p>
<p>
ISS SafeSuite V4.0.3</p>
<p>
By Internet Security Systems, Inc.</p>
<p>
Analysis Report</p>
<h3>Report by Hosts</h3>
<h4>Summary Information</h4>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Hosts Scanned:&nbsp; 1</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Hosts Active:&nbsp;&nbsp; 1</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Hosts Inactive: 0</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Start Time: Thu Oct. 3 12:27:53 1996</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;End Time&nbsp; : Thu Oct. 3 12:33:10 1996</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Total Time: 5 minutes 17 seconds</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Scan Completed Normally</p>
<p>
IP Address:&nbsp; 204.142.190.161</p>
<p>
Hostname:&nbsp; proxy1e</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Host is Active</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Host Types:</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Services:</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Open Port</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port 19 not accessible</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port 139&nbsp; ("netbios-ssn" service) opened.</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port 70&nbsp; ("gopher" service) opened.</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port 21&nbsp; ("ftp" service) opened.</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Port 80&nbsp; ("httpd" service) opened.</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Netbios Name Table</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dump of netbios names that were found during scanning</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROXY1&nbsp;&nbsp;&nbsp;&nbsp;(type=0x0) &lt;ACTIVE&gt; B</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INet~Services&nbsp;&nbsp; (type=0x1c) &lt;ACTIVE&gt; &lt;GROUP&gt; B</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS~PROXY1 (type=0x0) &lt;ACTIVE&gt; B</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WORKGROUP&nbsp;&nbsp;&nbsp;&nbsp; (type=0x0) &lt;ACTIVE&gt; &lt;GROUP&gt; B</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROXY1&nbsp;&nbsp;&nbsp;&nbsp; (type=0x20) &lt;ACTIVE&gt; B</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROXY1&nbsp;&nbsp;&nbsp;&nbsp; (type=0x3) &lt;ACTIVE&gt; B</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WORKGROUP&nbsp;&nbsp;&nbsp;&nbsp; (type=0x1e) &lt;ACTIVE&gt; &lt;GROUP&gt; B</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WORKGROUP&nbsp;&nbsp;&nbsp;&nbsp; (type=0x1d) &lt;ACTIVE&gt; B</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;____MSBROWSE___ (type=0x1) &lt;ACTIVE&gt; &lt;GROUP&gt; B</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROXY1¿¿¿¿¿¿¿¿¿ (type=0xbf) &lt;ACTIVE&gt; B</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Master Browser Name: WORKGROUP</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Station Name: PROXY1</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SMB Service Name: PROXY1</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Vulnerabilities:</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Trace Routing of Packets</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Traceroute allows you to determine the path a packet takes </p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;between two hosts. This information allows someone to </p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;determine network topology&nbsp; and routers on the network.</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;204.142.190.161</p>
<p>
Hosts Trusted by scanned Hosts</p>
<p>
No trusted hosts found.</p>
<h2><a name="proxyappe"></a>Appendix E—Suggested Baseline Security Configuration</h2>
<p>
The following tables present a suggested baseline security configuration for WinSock and Web Proxy Services.</p>
<p class=label>
<b>WinSock Proxy Service Suggested Baseline Security Configuration</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>Window/Configuration Option</b></td>
<td class=label width=66%><b>Baseline Security Configuration</b></td>
</tr>
<tr valign=top>
<td width=34%>Service Tab</td>
<td width=66%>Limit the configure of the LAT to the range of addresses in the internal network.</td>
</tr>
<tr valign=top>
<td width=34%>Permissions Tab</td>
<td width=66%>Enable access control.<p>
Grant access to protocols necessary for operating your business.</p>
</td>
</tr>
<tr valign=top>
<td width=34%>Logging Tab</td>
<td width=66%>Logging enabled.<p>
Regular logging selected.</p>
<p>
Log to File selected.</p>
<p>
Automatically open new log (Daily) selected.</p>
</td>
</tr>
<tr valign=top>
<td width=34%>Filtering Tab</td>
<td width=66%>If your company has a filtering policy, it can be applied through the Properties/Filtering feature.</td>
</tr>
</table><br>
<p class=label>
<b>Web Proxy Service Suggested Baseline Security Configuration</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>Window/Configuration Option</b></td>
<td class=label width=66%><b>Baseline Security Configuration</b></td>
</tr>
<tr valign=top>
<td width=34%>Service Tab</td>
<td width=66%>Limit the configure of the LAT to the range of addresses in the internal network.<p>
Internet publishing not enabled unless necessary.</p>
</td>
</tr>
<tr valign=top>
<td width=34%>Permissions Tab</td>
<td width=66%>Access control enabled for all protocols.<p>
Access granted to selected users for all protocols.</p>
</td>
</tr>
<tr valign=top>
<td width=34%>Logging Tab</td>
<td width=66%>Logging enabled.<p>
Regular logging selected.</p>
<p>
Log to File selected.</p>
<p>
Automatically open new log (Daily) selected.</p>
</td>
</tr>
<tr valign=top>
<td width=34%>Filtering Tab</td>
<td width=66%>If your company has a filtering policy, it can be applied through the Properties/Filtering feature</td>
</tr>
</table><br>
<p class=indent>
<B><b>Note&nbsp;&nbsp;&nbsp;</b></B>Microsoft Proxy Server and all files should be installed on a secured NTFS partition separate from the Windows NT Server Version 4.0 operating system.</p>
<h2><a name="proxyappf1"></a>Appendix F1—Detailed Installation Test Case Results</h2>
<h3>Test Case PROX-I-1</h3>
<h4>Objective </h4>
<p>
Assess security implications of Microsoft Proxy Server installation procedure and installation options.</p>
<h4>Configuration</h4>
<ul type=disc>
<li>
Refer to <a href="#proxyappa">Appendix A—Test Lab Specification</a>, Test Lab SPEC-1, and <a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a>, Test Lab DIAG-1.<br><br></li>
<li>
Microsoft Proxy Server not installed on PROXY-1.</li>
</ul>
<h4>Procedure</h4>
<ol>
<li>
Install Microsoft Proxy Server using the standard product installation steps.<br><br></li>
<li>
Select all product defaults or recommended settings during installation.<br><br></li>
<li>
Identify installation steps and options.<br><br></li>
<li>
Record observations.<br><br></li>
<li>
Assess security implications of installation procedure installation options.<br><br></li>
<li>
Document the results.</li>
</ol>
<h4>Observational requirements</h4>
<ul type=disc>
<li>
All security-related installation options.</li>
</ul>
<h4>Observations</h4>
<p>
The Microsoft Proxy Server installation procedure did not appear to reveal any serious security issues.</p>
<p>
<b>Issue</b></p>
<p>
Careful configuration of the LAT is necessary for maximum security.</p>
<p>
<b>Description</b></p>
<p>
The LAT is configured in the Local Address Table (“LAT”) Configuration window. This option requires basic knowledge of the internal network’s addresses. It is important to configure the LAT correctly because an address range greater than the internal network’s is unnecessary for Microsoft Proxy Server functionality and could cause security openings in the Proxy Server. Refer to the Interconnectivity Security Issues and Microsoft Proxy Server Security Features section of this document for additional information and the implications of this feature.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
The LAT can be constructed automatically using the addresses of the Proxy Server’s routing table or the standard private address ranges. This is accessible through the Construct Local Address Table window. Refer to <a href="#proxyappe">Appendix E—Baseline Security Configuration</a> for the recommended baseline implementation of this feature.</p>
<p>
<b>Issue</b></p>
<p>
Accessibility of cached data to users on the internal network.</p>
<p>
<b>Description</b></p>
<p>
Microsoft Proxy Server provides caching for HTTP resources accessed on the Internet from internal client stations. The Proxy Server cache is checked prior to all Internet data requests. Cached data is stored on disk. Certain users have access to the disk where the cache resides.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
A security feature of this caching is that HTTP-S pages and user-authenticated objects are not cached. This prevents one user from inadvertently viewing data that was issued to another user while in a secure mode. In addition, the cached data should be stored on a Windows NT NTFS partition that will utilize Windows NT file security.</p>
<h2><a name="proxyappf2"></a>Appendix F2—Detailed Configuration Test Case Results</h2>
<h3>Test Case PROX-C-1</h3>
<h4>Objective </h4>
<p>
Identify and assess Microsoft Proxy Server default security configuration and assess security implications.</p>
<h4>Configuration</h4>
<ul type=disc>
<li>
Refer to <a href="#proxyappa">Appendix A—Test Lab Specification</a>, Test Lab SPEC-1, and <a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a>, Test Lab DIAG-1.<br><br></li>
<li>
Microsoft Proxy Server installed using the standard product installation steps.<br><br></li>
<li>
Microsoft Proxy Server installed with all default or recommended settings.</li>
</ul>
<h4>Procedure</h4>
<ol>
<li>
Identify Microsoft Proxy Server default configuration.<br><br></li>
<li>
Record default configuration settings and any observations.<br><br></li>
<li>
Assess security implications of the default configuration settings.<br><br></li>
<li>
Document the results.</li>
</ol>
<h4>Observational requirements</h4>
<p>
All security related settings.</p>
<h4>Observations</h4>
<ul type=disc>
<li>
The default configuration did not appear to reveal any serious security configuration issues.<br><br></li>
<li>
No permissions have been granted to connect with any protocol, thereby preventing access to everyone.<br><br></li>
<li>
Logging is enabled, thereby providing administration with activity documentation.<br><br></li>
<li>
Web publishing is disabled, thereby preventing Internet publishing.</li>
</ul>
<p>
<b>Issue</b></p>
<p>
Microsoft Proxy Server can easily be configured to a minimal level of security.</p>
<p>
<b>Description</b></p>
<p>
One should also note that Internet Information Server (IIS) is installed when Windows NT Server version 4.0 is installed. All IIS services (WWW, Gopher, and FTP) are started by default.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
The WWW IIS services are configured to prevent publishing to the Internet. For maximum security, the FTP and Gopher IIS services should be stopped.</p>
<p>
The Microsoft-provided <a href="#proxyappc">Appendix C—Server Security Checklist</a> and <a href="#proxyappe">Appendix E—Baseline Security Configuration</a>, along with hard copy documentation and on-line help descriptions of the security features, are tools which can be used to plan and understand the features. The converse to this scenario is presented in Test Case PROX-C-3.</p>
<p class=label>
<b>Test PROX-C-1 WinSock Proxy Observation Table</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=39%><b>Window/Configuration Option</b></td>
<td class=label width=61%><b>Security Related Observations</b></td>
</tr>
<tr valign=top>
<td width=39%>Microsoft Internet Service Manager</td>
<td width=61%>The WinSock Proxy Service was in the running state by default after installation.</td>
</tr>
<tr valign=top>
<td width=39%>WinSock Proxy Services Properties/ Service</td>
<td width=61%>The LAT can be accessed and subsequently edited by selecting the “Edit Local Address Table (LAT)” button, by administrators only.</td>
</tr>
<tr valign=top>
<td width=39%>WinSock Proxy Service Properties/Permissions</td>
<td width=61%>Access control can be enabled through a check box.<p>
Access control was enabled for all protocols by default.</p>
<p>
Access was not granted to anyone for all protocols by default.</p>
</td>
</tr>
<tr valign=top>
<td width=39%>WinSock Proxy Service Properties/Logging</td>
<td width=61%>Logging can be selected via a checkbox.<p>
Logging was enabled by default.</p>
<p>
Regular logging or verbose logging can be selected through a toggle.</p>
<p>
Regular logging was selected by default.</p>
<p>
Logging can be to a file or a SQL/ODBC Database.</p>
<p>
Log to File was selected.</p>
<p>
The frequency for opening a new log can be set through a toggle to Daily, Weekly, Monthly, or when the file size reaches a specific size.</p>
<p>
Automatically open new log (Daily) was selected by default.</p>
<p>
The default log file directory was C:\WINNT\System32\wsplogs.</p>
</td>
</tr>
</table><br>
<p class=label>
<b>Test PROX-C-1 Web Proxy Observation Table</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=39%><b>Window/Configuration Option</b></td>
<td class=label width=61%><b>Security Related Observations</b></td>
</tr>
<tr valign=top>
<td width=39%>Microsoft Internet Service Manager</td>
<td width=61%>The Web Proxy Service was in the running state by default after installation.</td>
</tr>
<tr valign=top>
<td width=39%>Web Proxy Services Properties/ Service</td>
<td width=61%>Internet publishing can be enabled through this window.<p>
Internet publishing is not enabled by default.</p>
<p>
The LAT can be accessed and subsequently edited by selecting the “Edit Local Address Table (LAT)” button.</p>
</td>
</tr>
<tr valign=top>
<td width=39%>Web Proxy Service Properties/Permissions</td>
<td width=61%>Access control can be enabled through a checkbox.<p>
Access control was enabled for all protocols by default.</p>
<p>
Access was not granted to anyone for all protocols by default.</p>
</td>
</tr>
<tr valign=top>
<td width=39%>Caching</td>
<td width=61%>Caching can be enabled through a checkbox.<p>
Caching was enabled by default.</p>
<p>
Cache options are presented.</p>
</td>
</tr>
<tr valign=top>
<td width=39%>Web Proxy Service Properties/Logging</td>
<td width=61%>Logging can be selected via a checkbox.<p>
Logging was enabled by default.</p>
<p>
Regular logging or verbose logging can be selected through a toggle.</p>
<p>
Regular logging was selected by default.</p>
<p>
Logging can be to a file or a SQL/ODBC Database.</p>
<p>
Log to File was selected.</p>
<p>
The frequency for opening a new log can be set through a toggle to Daily, Weekly, Monthly, or when the file size reaches a specific size.</p>
<p>
Automatically open new log (Daily) was selected by default.</p>
<p>
The default log file directory was C:\WINNT\System32\w3plogs.</p>
</td>
</tr>
</table><br>
<h3>Test Case PROX-C-2</h3>
<h4>Objective </h4>
<p>
Assess Microsoft Proxy Server configuration options security when set to a minimal (as close to none as possible) level of security.</p>
<h4>Configuration</h4>
<ul type=disc>
<li>
Refer to <a href="#proxyappa">Appendix A—Test Lab Specification</a>, Test Lab SPEC-1, and <a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a>, Test Lab DIAG-1.<br><br></li>
<li>
Microsoft Proxy Server installed using the standard product installation steps.<br><br></li>
<li>
Microsoft Proxy Server installed with all default or recommended settings.</li>
</ul>
<h4>Procedure</h4>
<ol>
<li>
Perform test case PROX-C-1.<br><br></li>
<li>
Change default configuration settings to a minimal (as close to none as possible) level of security.<br><br></li>
<li>
Record configuration settings and any observations.<br><br></li>
<li>
Assess security implications of the selected configuration settings.<br><br></li>
<li>
Document the results.</li>
</ol>
<h4>Observational requirements</h4>
<ul type=disc>
<li>
All security-related settings.</li>
</ul>
<h4>Observations</h4>
<p>
Microsoft Proxy Server can be configured to a minimal level of security. Although not recommended, this level of security may be adequate for certain environments.</p>
<p>
<b>Issue</b></p>
<p>
Microsoft Proxy Server can easily be configured to a minimal level of security.</p>
<p>
<b>Description</b></p>
<p>
A minimal level of configurable security may include user-level access control disabled, logging disabled, and Internet Web publishing enabled. As noted in Test Case PROX-C-1, Microsoft Proxy Server does not configure to this minimal level of security by default. The administrator must configure Microsoft Proxy Server to these settings.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
The minimally secure configuration can easily be avoided through proper planning and completely understanding the features. The Microsoft-provided <a href="#proxyappc">Appendix C—Server Security Checklist</a> and <a href="#proxyappe">Appendix E—Baseline Security Configuration</a>, along with hard copy documentation and on-line help descriptions of the security features, are tools that can be used to plan and understand the features. The converse to this scenario is presented in Test Case PROX-C-3.</p>
<p class=label>
<b>Test PROX-C-2 WinSock Proxy Observation Table</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=41%><b>Window/Configuration Option</b></td>
<td class=label width=59%><b>Security-Related Observations</b></td>
</tr>
<tr valign=top>
<td width=41%>WinSock Proxy Service Properties/Permissions</td>
<td width=59%><b>Default Setting:</b><p>
Access control enabled for all protocols, no permissions granted.</p>
<p>
<b>Minimally Secure Setting:</b></p>
<p>
Access control not selected.</p>
</td>
</tr>
<tr valign=top>
<td width=41%>WinSock Proxy Service Properties/Logging</td>
<td width=59%><b>Default Setting:</b><p>
Logging enabled.</p>
<p>
Regular logging selected.</p>
<p>
Log to File selected.</p>
<p>
Automatically open new log (Daily) selected.</p>
<p>
<b>Minimally Secure Setting:</b></p>
<p>
Logging not enabled.</p>
</td>
</tr>
</table><br>
<p class=label>
<b>Test PROX-C-2 Web Proxy Observation Table</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=41%><b>Window/Configuration Option</b></td>
<td class=label width=59%><b>Security-Related Observations</b></td>
</tr>
<tr valign=top>
<td width=41%>Web Proxy Services Properties/ Service</td>
<td width=59%><b>Default Setting: </b><p>
Internet publishing not enabled.</p>
<p>
<b>Minimally Secure Setting:</b></p>
<p>
Internet publishing enabled.</p>
</td>
</tr>
<tr valign=top>
<td width=41%>Web Proxy Service Properties/Permissions</td>
<td width=59%><b>Default Setting: </b><p>
Access control enabled for all protocols.</p>
<p>
Access not granted to anyone for all protocols.</p>
<p>
<b>Minimally Secure Setting:</b></p>
<p>
Access control not selected.</p>
</td>
</tr>
<tr valign=top>
<td width=41%>Web Proxy Service Properties/Logging</td>
<td width=59%><b>Default Setting:</b><p>
Logging enabled.</p>
<p>
Regular logging selected.</p>
<p>
Log to File selected.</p>
<p>
Automatically open new log (Daily) selected.</p>
<p>
<b>Minimally Secure Setting:</b></p>
<p>
Logging not enabled.</p>
</td>
</tr>
</table><br>
<h3>Test Case PROX-C-3</h3>
<h4>Objective </h4>
<p>
Assess Microsoft Proxy Server configuration options security when set to a maximum level of security.</p>
<h4>Configuration</h4>
<ul type=disc>
<li>
Refer to <a href="#proxyappa">Appendix A—Test Lab Specification</a>, Test Lab SPEC-1, and <a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a>, Test Lab DIAG-1.<br><br></li>
<li>
Microsoft Proxy Server installed using the standard product installation steps.<br><br></li>
<li>
Microsoft Proxy Server installed with all default or recommended settings.</li>
</ul>
<h4>Procedure</h4>
<ol>
<li>
Perform test case PROX-C-1.<br><br></li>
<li>
Change default configuration settings to maximum level of security.<br><br></li>
<li>
Record configuration settings and any observations.<br><br></li>
<li>
Assess security implications of the selected configuration settings. <br><br></li>
<li>
Document the results.</li>
</ol>
<h4>Observational requirements</h4>
<ul type=disc>
<li>
All security-related settings.</li>
</ul>
<h4>Observations</h4>
<p>
<b>Issue</b></p>
<p>
Microsoft Proxy Server can be easily configured to a maximum level of security; however, creating the most secure Microsoft Proxy Server configuration requires thought and planning.</p>
<p>
<b>Description</b></p>
<p>
A maximum level of configurable security may include access control, verbose logging to files which are automatically created and saved on a daily basis, and Internet Web publishing disabled. As noted in Test Case PROX-C-1, Microsoft Proxy Server does not configure to this maximum level of security by default. The administrator must configure access control and logging.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
The Administrator must select the correct level of access without denying needed services. The maximum secure configuration can be accomplished through proper planning and completely understanding the features. The Microsoft-provided <a href="#proxyappc">Appendix C—Server Security Checklist</a> and <a href="#proxyappe">Appendix E—Baseline Security Configuration</a>, along with hard copy documentation and on-line help descriptions of the security features, are tools that can be used to plan and understand the features. The converse to this scenario is presented in Test Case PROX-C-2.</p>
<p class=label>
<b>Test PROX-C-3 WinSock Proxy Observation Table</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=38%><b>Window/Configuration Option</b></td>
<td class=label width=62%><b>Security-Related Observations</b></td>
</tr>
<tr valign=top>
<td width=38%>WinSock Proxy Service Properties/Permissions</td>
<td width=62%><b>Default Setting:</b><p>
Access control enabled for all protocols.</p>
<p>
<b>Maximally Secure Setting:</b></p>
<p>
Access control selected.</p>
<p>
Grant access to selective users for each protocol.</p>
</td>
</tr>
<tr valign=top>
<td width=38%>WinSock Proxy Service Properties/Logging</td>
<td width=62%><b>Default Setting:</b><p>
Logging enabled.</p>
<p>
Regular logging selected.</p>
<p>
Log to File selected.</p>
<p>
Automatically open new log (Daily) selected.</p>
<p>
<b>Maximally Secure Setting:</b></p>
<p>
Logging enabled.</p>
<p>
Verbose logging selected.</p>
<p>
Log to File selected.</p>
<p>
Automatically open new log (Daily) selected.</p>
</td>
</tr>
</table><br>
<p class=label>
<b>Test PROX-C-3 Web Proxy Observation Table</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=38%><b>Window/Configuration Option</b></td>
<td class=label width=62%><b>Security-Related Observations</b></td>
</tr>
<tr valign=top>
<td width=38%>Web Proxy Services Properties/ Service</td>
<td width=62%><b>Default Setting: </b><p>
Internet publishing not enabled.</p>
<p>
<b>Maximally Secure Setting:</b></p>
<p>
Internet publishing not enabled.</p>
</td>
</tr>
<tr valign=top>
<td width=38%>Web Proxy Service Properties/Permissions</td>
<td width=62%><b>Default Setting: </b><p>
Access control enabled for all protocols.</p>
<p>
Access not granted to anyone for all protocols.</p>
<p>
<b>Maximally Secure Setting:</b></p>
<p>
Access control enabled for all protocols.</p>
<p>
Access granted to selected users for all protocols.</p>
</td>
</tr>
<tr valign=top>
<td width=38%>Web Proxy Service Properties/Logging</td>
<td width=62%><b>Default Setting:</b><p>
Logging enabled.</p>
<p>
Regular logging selected.</p>
<p>
Log to File selected.</p>
<p>
Automatically open new log (Daily) selected.</p>
<p>
<b>Maximally Secure Setting:</b></p>
<p>
Logging enabled.</p>
<p>
Verbose logging selected.</p>
<p>
Log to File selected.</p>
<p>
Automatically open new log (Daily) selected.</p>
</td>
</tr>
</table><br>
<h3>Test Case PROX-C-4</h3>
<h4>Objective </h4>
<ul type=disc>
<li>
Determine if a Microsoft Proxy Server can be configured to function as an IP router.<br><br></li>
<li>
Determine the risk of this event happening inadvertently.</li>
</ul>
<h4>Configuration</h4>
<ul type=disc>
<li>
Refer to <a href="#proxyappa">Appendix A—Test Lab Specification</a>, Test Lab SPEC-1, and <a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a>, Test Lab DIAG-3.<br><br></li>
<li>
Windows NT Server Version 4.0 not installed on PROXY-1.<br><br></li>
<li>
Microsoft Proxy Server not installed on PROXY-1.</li>
</ul>
<h4>Procedure</h4>
<ol>
<li>
Install Windows NT 4.x Operating System selecting all defaults relating the TCP/IP networking services and security. Select IP addresses per Test Lab DIAG-3.<br><br></li>
<li>
Document the state of the IP Forwarding checkbox.<br><br></li>
<li>
Ping PROXY-1 internal IP card 204.142.190.130 from IR-1.<br><br></li>
<li>
Ping PROXY-1 external IP card 204.142.190.161 from IR-1.<br><br></li>
<li>
Ping PPTP-1 internal card 204.142.190.162 from IR-1.<br><br></li>
<li>
Ping PROXY-1 external IP card 204.142.190.161 from PPTP-1.<br><br></li>
<li>
Ping PROXY-1 internal IP card 204.142.190.130 from PPTP-1.<br><br></li>
<li>
Ping IR-1 IP card 204.142.190.129 from PPTP-1.<br><br></li>
<li>
Install Microsoft Proxy Server using the standard product installation steps with all default or recommended settings.<br><br></li>
<li>
Ping PROXY-1 internal IP card 204.142.190.130 from IR-1.<br><br></li>
<li>
Ping PROXY-1 external IP card 204.142.190.161 from IR-1.<br><br></li>
<li>
Ping PPTP-1 internal card 204.142.190.162 from IR-1.<br><br></li>
<li>
Ping PROXY-1 external IP card 204.142.190.161 from PPTP-1.<br><br></li>
<li>
Ping PROXY-1 internal IP card 204.142.190.130 from PPTP-1.<br><br></li>
<li>
Ping IR-1 IP card 204.142.190.129 from PPTP-1.<br><br></li>
<li>
Select IP Forwarding.<br><br></li>
<li>
De-install Microsoft Proxy Server.<br><br></li>
<li>
Re-install Microsoft Proxy Server using the standard product installation steps with all default or recommended settings.<br><br></li>
<li>
Ping PROXY-1 internal IP card 204.142.190.130 from IR-1.<br><br></li>
<li>
Ping PROXY-1 external IP card 204.142.190.161 from IR-1.<br><br></li>
<li>
Ping PPTP-1 internal card 204.142.190.162 from IR-1.<br><br></li>
<li>
Ping PROXY-1 external IP card 204.142.190.161 from PPTP-1.<br><br></li>
<li>
Ping PROXY-1 internal IP card 204.142.190.130 from PPTP-1.<br><br></li>
<li>
Ping IR-1 IP card 204.142.190.129 from PPTP-1.<br><br></li>
<li>
Document the results.</li>
</ol>
<h4>Observational Requirements</h4>
<ul type=disc>
<li>
Observe and document the state of Windows NT IP routing pre- and post-installation of Microsoft Proxy Server.<br><br></li>
<li>
Document any options during Microsoft Proxy Server installation that may cause different results.</li>
</ul>
<h4>Observations</h4>
<ul type=disc>
<li>
Windows NT routing is referred to as IP Forwarding. This feature is not selected by default.<br><br></li>
<li>
Windows NT routing is controlled by an IP Forwarding checkbox located in the TCP/IP protocol definition window.<br><br></li>
<li>
The state of the checkbox was unaffected by the installation of Microsoft Proxy Server.<br><br></li>
<li>
When Microsoft Proxy Server is installed, there is no warning if IP Forwarding is active.<br><br></li>
<li>
The internal card on PROXY-1 could be seen from machines outside of the network. Refer to PROX-P-1 for further description of the implications.</li>
</ul>
<p>
<b>Issue</b></p>
<p>
It is possible to configure Microsoft Proxy Server to forward IP traffic between its two network interface cards.</p>
<p>
<b>Description</b></p>
<p>
The IP Forwarding function becomes active when the IP Forwarding checkbox is selected pre-or post the Microsoft Proxy Server installation. When Microsoft Proxy Server is installed, there is no warning indicating IP Forwarding is active. Risk is incurred for administrators who may select IP Forwarding with Microsoft Proxy Server installed without understanding the consequences.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
This issue can be addressed procedurally. The administrator must be attentive to the status of the IP Forwarding checkbox.</p>
<p class=label>
<b>Test PROX-C-4 Observation Table</b></p>
<table border=1 cellpadding=5 cols=5 frame=below rules=rows>
<tr valign=top>
<td class=label width=18%><b>PROXY-1 IP Forwarding</b></td>
<td class=label width=13%><b><br>
From</b></td>
<td class=label width=37%><b><br>
To</b></td>
<td class=label width=13%><b>Attempt To</b></td>
<td class=label width=19%><b><br>
Result</b></td>
</tr>
<tr valign=top>
<td width=18%>Disabled</td>
<td width=13%>IR-1</td>
<td width=37%>PROXY-1 204.142.190.130</td>
<td width=13%>Ping</td>
<td width=19%>Reply</td>
</tr>
<tr valign=top>
<td width=18%>Disabled</td>
<td width=13%>IR-1</td>
<td width=37%>PROXY-1 204.142.190.161</td>
<td width=13%>Ping</td>
<td width=19%>Reply</td>
</tr>
<tr valign=top>
<td width=18%>Disabled</td>
<td width=13%>IR-1</td>
<td width=37%>PPTP-1 204.142.190.162</td>
<td width=13%>Ping</td>
<td width=19%>Reply</td>
</tr>
<tr valign=top>
<td width=18%>Disabled</td>
<td width=13%>PPTP-1</td>
<td width=37%>PROXY-1 204.142.190.161</td>
<td width=13%>Ping</td>
<td width=19%>Reply</td>
</tr>
<tr valign=top>
<td width=18%>Disabled</td>
<td width=13%>PPTP-1</td>
<td width=37%>PROXY-1 204.142.130</td>
<td width=13%>Ping</td>
<td width=19%>Reply</td>
</tr>
<tr valign=top>
<td width=18%>Disabled</td>
<td width=13%>PPTP-1</td>
<td width=37%>IR-1 204.142.190.129</td>
<td width=13%>Ping</td>
<td width=19%>Timed Out</td>
</tr>
<tr valign=top>
<td width=18%></td>
<td width=13%></td>
<td width=37%></td>
<td width=13%></td>
<td width=19%></td>
</tr>
<tr valign=top>
<td width=18%>Enabled</td>
<td width=13%>IR-1</td>
<td width=37%>PROXY-1 204.142.190.130</td>
<td width=13%>Ping</td>
<td width=19%>Reply</td>
</tr>
<tr valign=top>
<td width=18%>Enabled</td>
<td width=13%>IR-1</td>
<td width=37%>PROXY-1 204.142.190.161</td>
<td width=13%>Ping</td>
<td width=19%>Reply</td>
</tr>
<tr valign=top>
<td width=18%>Enabled</td>
<td width=13%>IR-1</td>
<td width=37%>PPTP-1 204.142.190.162</td>
<td width=13%>Ping</td>
<td width=19%>Reply</td>
</tr>
<tr valign=top>
<td width=18%>Enabled</td>
<td width=13%>PPTP-1</td>
<td width=37%>PROXY-1 204.142.190.161</td>
<td width=13%>Ping</td>
<td width=19%>Reply</td>
</tr>
<tr valign=top>
<td width=18%>Enabled</td>
<td width=13%>PPTP-1</td>
<td width=37%>PROXY-1 204.142.130</td>
<td width=13%>Ping</td>
<td width=19%>Reply</td>
</tr>
<tr valign=top>
<td width=18%>Enabled</td>
<td width=13%>PPTP-1</td>
<td width=37%>IR-1 204.142.190.129</td>
<td width=13%>Ping</td>
<td width=19%>Reply</td>
</tr>
</table><br>
<p>
The table above details the results of Ping (ICMP echo protocol) tests between the internal and external networks under different conditions of the IP Forwarding checkbox.</p>
<p>
When an echo request is sent to a Microsoft Proxy Server with a destination address of the internal network adapter, the internal adapter will respond. If the response of the internal adapter address is detected by an outside entity, it could aid in designing a more focused attack on the internal network. Although designing a more focused attack may not be directly possible through the Microsoft Proxy Server, the information could be used if another entry point was also identified (for example, a dial-in SLIP or PPP line), and later used to penetrate the network.</p>
<h2><a name="proxyappf3"></a>Appendix F3—Detailed Functional Test Case Results</h2>
<h3>Test Case PROX-F-1</h3>
<h4>Objective</h4>
<p>
Determine the security impact of configuring the internal (private) network for addresses that are being used on the external (public) network. This is the basis for a spoofing attack if Microsoft Proxy Server does not respond properly in such a configuration.</p>
<h4>Configuration</h4>
<ul type=disc>
<li>
Refer to <a href="#proxyappa">Appendix A—Test Lab Specification</a>, Test Lab SPEC-1, and <a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a>, Test Lab DIAG-2.<br><br></li>
<li>
Microsoft Proxy Server installed using the standard product installation steps.<br><br></li>
<li>
Microsoft Proxy Server installed with all default or recommended settings.<br><br></li>
<li>
Microsoft Proxy Server security configured to <a href="#proxyappe">Appendix E—Baseline Security Configuration</a>.<br><br></li>
<li>
IR-1 operating with SCO UNIX.<br><br></li>
<li>
Three subnets created as follows:<table border=1 cellpadding=5 cols=4 frame=below rules=rows>
<tr valign=top>
<td class=label width=19%><b>Sub-net</b></td>
<td class=label width=28%><b>System</b></td>
<td class=label width=26%><b>IP Address</b></td>
<td class=label width=27%><b>Net Mask</b></td>
</tr>
<tr valign=top>
<td width=19%>External</td>
<td width=28%>AIX Server</td>
<td width=26%>204.142.190.151</td>
<td width=27%>255.255.255.240</td>
</tr>
<tr valign=top>
<td width=19%></td>
<td width=28%>Router (Ext Adapter)</td>
<td width=26%>204.142.190.150</td>
<td width=27%>255.255.255.240</td>
</tr>
<tr valign=top>
<td width=19%>Intermediate</td>
<td width=28%>Router (Int Adapter)</td>
<td width=26%>204.142.190.162</td>
<td width=27%>255.255.255.224</td>
</tr>
<tr valign=top>
<td width=19%></td>
<td width=28%>Proxy (Ext Adapter)</td>
<td width=26%>204.142.190.161</td>
<td width=27%>255.255.255.224</td>
</tr>
<tr valign=top>
<td width=19%>Internal</td>
<td width=28%>Proxy (Int Adapter)</td>
<td width=26%>204.142.190.130</td>
<td width=27%>255.255.255.224</td>
</tr>
<tr valign=top>
<td width=19%></td>
<td width=28%>SCO client</td>
<td width=26%>204.142.190.129</td>
<td width=27%>255.255.255.224</td>
</tr>
<tr valign=top>
<td width=19%></td>
<td width=28%>Windows NT client</td>
<td width=26%>204.142.190.133</td>
<td width=27%>255.255.255.224</td>
</tr>
</table><br>
</li>
</ul>
<h4>Procedure</h4>
<ol>
<li>
Verify AIX-BOX can access services on IR-1 if connected to the same subnet by connecting it directly to the same hub as IR-1.<br><br></li>
<li>
Verify that AIX-BOX and PROXY-1 have connectivity to each other using an ftp from each server to the opposite server.<br><br></li>
<li>
Access services on IR-1 from AIX-BOX.<br><br></li>
<li>
Add a static route to AIX-BOX that directs access to IR-1 through the router and PROXY-1 as the gateway (this may also require adding a static route to router).<br><br></li>
<li>
Assure “Access Control” is enabled on the Proxy Server for all connections.<br><br></li>
<li>
Configure the PROXY-1 LAT to include complete access to address range 204.142.190.128 through 204.142.190.159<b>.</b><br><br></li>
<li>
Access systems, services, or other resources on internal network from AIX-BOX. This should include at least an ftp and a telnet application request.<br><br></li>
<li>
Disable “Access Control” on PROXY-1 for all connections.<br><br></li>
<li>
Repeat step 8.<br><br></li>
<li>
Document the results.</li>
</ol>
<h4>Observational requirements</h4>
<ul type=disc>
<li>
Using a Network Monitor, record all IP traffic at PROXY-1.<br><br></li>
<li>
Document what can be accessed on IR-1 from AIX-BOX. Document the conditions of access.</li>
</ul>
<h4>Observations</h4>
<ul type=disc>
<li>
This spoofing attempt was unsuccessful.<br><br></li>
<li>
The Microsoft Proxy Server did not allow any packets entering its external interface to reach internal systems, even when the external source address fell within the range specified by the Proxy Servers’ LAT. This result should not be used to justify an improperly configured LAT, however. If an organization requires the LAT to contain addresses not officially allocated to that organization by the InterNIC, every effort should be made to utilize an internal addressing scheme that will not be routed on the Internet.<br><br></li>
<li>
Without the static routes (both on AIX and Router) in step 5, the AIX Server would get “No Route to Host” on all access attempts.<br><br></li>
<li>
With the static routes added, all access attempts from AIX to either the SCO client or the Windows NT client failed with “Connection Timed Out.”<br><br></li>
<li>
The Network Monitor running on the PROXY-1 indicated that properly formatted TCP/IP messages with a source of AIX-BOX were entering PROXY-1; however, it did not indicate any responses to those messages.</li>
</ul>
<h3>Test Case PROX-F-2</h3>
<h4>Objective </h4>
<p>
Test the level of access between internal and external networks when the internal client does not have Microsoft Proxy Server client software installed or if both the external and internal machines run a non-Microsoft Proxy Server–supported operating system.</p>
<h4>Configuration</h4>
<ul type=disc>
<li>
Refer to <a href="#proxyappa">Appendix A—Test Lab Specification</a>, Test Lab SPEC-1, and <a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a>, Test Lab DIAG-3.<br><br></li>
<li>
Microsoft Proxy Server installed using the standard product installation steps.<br><br></li>
<li>
Microsoft Proxy Server installed with all default or recommended settings.<br><br></li>
<li>
Microsoft Proxy Server security configured to <a href="#proxyappe">Appendix E—Baseline Security Configuration</a>.<br><br></li>
<li>
IR-1 operating with SCO UNIX.</li>
</ul>
<h4>Procedure</h4>
<ol>
<li>
Ping AIX-BOX 204.142.190.195 from IR-1.<br><br></li>
<li>
Finger AIX-BOX 204.142.190.195 from IR-1.<br><br></li>
<li>
FTP AIX-BOX 204.142.190.195 from IR-1.<br><br></li>
<li>
Telnet AIX-BOX 204.142.190.195 from IR-1.<br><br></li>
<li>
Ping IR-1 204.142.190.129 from AIX-BOX.<br><br></li>
<li>
Finger IR-1 204.142.190.129 from AIX-BOX.<br><br></li>
<li>
FTP IR-1 204.142.190.129 from AIX-BOX.<br><br></li>
<li>
Telnet IR-1 204.142.190.129 from AIX-BOX.<br><br></li>
<li>
Enable IP Forwarding on PROXY-1<br><br></li>
<li>
Ping AIX-BOX 204.142.190.195 from IR-1.<br><br></li>
<li>
Finger AIX-BOX 204.142.190.195 from IR-1.<br><br></li>
<li>
FTP AIX-BOX 204.142.190.195 from IR-1.<br><br></li>
<li>
Telnet AIX-BOX 204.142.190.195 from IR-1.<br><br></li>
<li>
Ping IR-1 204.142.190.129 from AIX-BOX.<br><br></li>
<li>
Finger IR-1 204.142.190.129 from AIX-BOX.<br><br></li>
<li>
FTP IR-1 204.142.190.129 from AIX-BOX.<br><br></li>
<li>
Telnet IR-1 204.142.190.129 from AIX-BOX.<br><br></li>
<li>
Disable IP Forwarding on PROXY-1<br><br></li>
<li>
Ping AIX-BOX 204.142.190.195 from IR-1.<br><br></li>
<li>
Finger AIX-BOX 204.142.190.195 from IR-1.<br><br></li>
<li>
FTP AIX-BOX 204.142.190.195 from IR-1.<br><br></li>
<li>
Telnet AIX-BOX 204.142.190.195 from IR-1.<br><br></li>
<li>
Ping IR-1 204.142.190.129 from AIX-BOX.<br><br></li>
<li>
Finger IR-1 204.142.190.129 from AIX-BOX.<br><br></li>
<li>
FTP IR-1 204.142.190.129 from AIX-BOX.<br><br></li>
<li>
Telnet IR-1 204.142.190.129 from AIX-BOX.<br><br></li>
<li>
Document the results.</li>
</ol>
<h4>Observational requirements</h4>
<ul type=disc>
<li>
Successful or unsuccessful connection to Microsoft Proxy Server PROXY-1.<br><br></li>
<li>
Information gathered from IR-1 by AIX-BOX.<br><br></li>
<li>
Information gathered from AIX-BOX by IR-1.</li>
</ul>
<h4>Observations</h4>
<p>
Microsoft Proxy Server successfully prevented non-proxy clients from using services beyond the Proxy Server.</p>
<p class=label>
<b>Test PROX-F-2 Observation Table</b></p>
<table border=1 cellpadding=5 cols=5 frame=below rules=rows>
<tr valign=top>
<td class=label width=16%><b>PROXY-1 IP Forwarding</b></td>
<td class=label width=15%><b><br>
From</b></td>
<td class=label width=32%><b><br>
To</b></td>
<td class=label width=12%><b>Attempt To</b></td>
<td class=label width=25%><b><br>
Result</b></td>
</tr>
<tr valign=top>
<td width=16%>Enabled</td>
<td width=15%>IR-1</td>
<td width=32%>AIX-BOX 204.142.190.195</td>
<td width=12%>Finger</td>
<td width=25%>Reply</td>
</tr>
<tr valign=top>
<td width=16%>Enabled</td>
<td width=15%>IR-1</td>
<td width=32%>AIX-BOX 204.142.190.195</td>
<td width=12%>FTP</td>
<td width=25%>Login Connection</td>
</tr>
<tr valign=top>
<td width=16%>Enabled</td>
<td width=15%>IR-1</td>
<td width=32%>AIX-BOX 204.142.190.195</td>
<td width=12%>Telnet</td>
<td width=25%>Login Connection</td>
</tr>
<tr valign=top>
<td width=16%>Enabled</td>
<td width=15%>AIX-BOX</td>
<td width=32%>IR-1 204.142.190.129</td>
<td width=12%>Finger</td>
<td width=25%>Reply</td>
</tr>
<tr valign=top>
<td width=16%>Enabled</td>
<td width=15%>AIX-BOX</td>
<td width=32%>IR-1 204.142.190.129</td>
<td width=12%>FTP</td>
<td width=25%>Login Connection</td>
</tr>
<tr valign=top>
<td width=16%>Enabled</td>
<td width=15%>AIX-BOX</td>
<td width=32%>IR-1 204.142.190.129</td>
<td width=12%>Telnet</td>
<td width=25%>Login Connection</td>
</tr>
<tr valign=top>
<td width=16%></td>
<td width=15%></td>
<td width=32%></td>
<td width=12%></td>
<td width=25%></td>
</tr>
<tr valign=top>
<td width=16%>Disabled</td>
<td width=15%>IR-1</td>
<td width=32%>AIX-BOX 204.142.190.195</td>
<td width=12%>Finger</td>
<td width=25%>Timed Out</td>
</tr>
<tr valign=top>
<td width=16%>Disabled</td>
<td width=15%>IR-1</td>
<td width=32%>AIX-BOX 204.142.190.195</td>
<td width=12%>FTP</td>
<td width=25%>Timed Out</td>
</tr>
<tr valign=top>
<td width=16%>Disabled</td>
<td width=15%>IR-1</td>
<td width=32%>AIX-BOX 204.142.190.195</td>
<td width=12%>Telnet</td>
<td width=25%>Timed Out</td>
</tr>
<tr valign=top>
<td width=16%>Disabled</td>
<td width=15%>AIX-BOX</td>
<td width=32%>IR-1 204.142.190.129</td>
<td width=12%>Finger</td>
<td width=25%>Timed Out</td>
</tr>
<tr valign=top>
<td width=16%>Disabled</td>
<td width=15%>AIX-BOX</td>
<td width=32%>IR-1 204.142.190.129</td>
<td width=12%>FTP</td>
<td width=25%>Timed Out</td>
</tr>
<tr valign=top>
<td width=16%>Disabled</td>
<td width=15%>AIX-BOX</td>
<td width=32%>IR-1 204.142.190.129</td>
<td width=12%>Telnet</td>
<td width=25%>Timed Out</td>
</tr>
</table><br>
<h3>Test Case PROX-F-3</h3>
<h4>Objective </h4>
<p>
Test the functionality of Microsoft Proxy Server’s logging mechanism.</p>
<h4>Configuration</h4>
<ul type=disc>
<li>
Refer to <a href="#proxyappa">Appendix A—Test Lab Specification</a>, Test Lab SPEC-1, and <a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a>, Test Lab DIAG-3.<br><br></li>
<li>
Microsoft Proxy Server installed using the standard product installation steps.<br><br></li>
<li>
Microsoft Proxy Server installed with all default or recommended settings.<br><br></li>
<li>
Microsoft Proxy Server security configured to <a href="#proxyappe">Appendix E—Baseline Security Configuration</a>.<br><br></li>
<li>
Logging configured for Web Proxy, WinSock Proxy, and IIS with the following settings:<ul type=disc>
<li>
Regular logging<br><br></li>
<li>
Logging to file<br><br></li>
<li>
Open new log automatically every day</li>
</ul>
</li>
<li>
Log Locations (by default)<ul type=disc>
<li>
Proxy: %SYSTEMROOT%\system32\w3plogs\W3yymmdd.log<br><br></li>
<li>
RWS: %SYSTEMROOT%\system32\wsplogs\Wsyymmdd.log<br><br></li>
<li>
IIS: %SYSTEMROOT%\system32\LogFiles\INyymmdd.log.</li>
</ul>
</li>
</ul>
<h4>Procedure</h4>
<ol>
<li>
Configure logging to regular logging.<br><br></li>
<li>
Access HTTP and ftp services through Web Proxy Server from IR-1.<br><br></li>
<li>
Access telnet and ftp services through the WinSock Proxy Server from IR-1.<br><br></li>
<li>
Configure logging to verbose logging.<br><br></li>
<li>
Repeat steps 2 and 3.<br><br></li>
<li>
Document the results.</li>
</ol>
<h4>Observational requirements</h4>
<ul type=disc>
<li>
Record the types of events in the wsplogs, w3plogs, and Logfiles directory log files.</li>
</ul>
<h4>Observations</h4>
<p>
<b>Issue</b></p>
<p>
Configuration of the logging feature.</p>
<p>
<b>Description</b></p>
<p>
The logging processes gather a significant amount of information about any connected process. This makes the logging facility a valuable tool for tracking system usage and monitoring individual user activity. Without logging, the ability of the system administrator to track the system usage and to prevent unauthorized activity is severely limited. Operating the Microsoft Proxy Server without logging should be considered insecure. Refer to the <a href="#proxyinterconnectivity">Interconnectivity Security Issues and Microsoft Proxy Server Security Features</a> section of this document for additional information and the implications of this feature.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
As indicated in Test Case PROX-C-1, regular logging to a new file on a daily basis is selected by default. This configuration may be adequate for certain environments. Test Case PROX-C-3 and <a href="#proxyappe">Appendix E—Baseline Security Configuration</a> provide information on the recommended settings for the logging feature.</p>
<p class=label>
<b>Test Case PROX-F-3: Regular and Verbose Logging Observation Table</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=50%><b>Regular logging records the following:</b></td>
<td class=label width=50%><b>Verbose logging records the following</b></td>
</tr>
<tr valign=top>
<td width=50%>client machine IP address</td>
<td width=50%>client machine IP address</td>
</tr>
<tr valign=top>
<td width=50%>client user name</td>
<td width=50%>client user name</td>
</tr>
<tr valign=top>
<td width=50%>Log date</td>
<td width=50%>client agent</td>
</tr>
<tr valign=top>
<td width=50%>Log time</td>
<td width=50%>client platform</td>
</tr>
<tr valign=top>
<td width=50%>Service name</td>
<td width=50%>Authentication Status</td>
</tr>
<tr valign=top>
<td width=50%>Destination name IP address</td>
<td width=50%>Log date</td>
</tr>
<tr valign=top>
<td width=50%>Destination port</td>
<td width=50%>Log time</td>
</tr>
<tr valign=top>
<td width=50%>Protocol name (TCP, UDP)</td>
<td width=50%>Service name</td>
</tr>
<tr valign=top>
<td width=50%>Object name </td>
<td width=50%>Proxy name</td>
</tr>
<tr valign=top>
<td width=50%>Object Source</td>
<td width=50%>Referring Server name</td>
</tr>
<tr valign=top>
<td width=50%>Result code</td>
<td width=50%>Destination name<br>
Destination address<br>
Destination port<br>
Processing time<br>
Bytes received<br>
Bytes sent<br>
Protocol name<br>
Transport<br>
Operation<br>
Object name<br>
Object MIME<br>
Object source<br>
Result code</td>
</tr>
</table><br>
<h2><a name="proxyappf4"></a>Appendix F4—Detailed Penetration Test Case Results</h2>
<h3>Test Case PROX-P-1</h3>
<h4>Objective</h4>
<p>
To determine which IP addresses respond to an ICMP echo (ping) request on the various sub-nets where the Microsoft Proxy Server is attached. The primary objective is to determine which IP addresses answer to untrusted systems connected to the external network.</p>
<h4>Configuration</h4>
<ul type=disc>
<li>
Refer to <a href="#proxyappa">Appendix A—Test Lab Specification</a>, Test Lab SPEC-1, and <a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a>, Test Lab DIAG-1.<br><br></li>
<li>
Microsoft Proxy Server installed using the standard product installation steps.<br><br></li>
<li>
Microsoft Proxy Server installed with all default or recommended settings.<br><br></li>
<li>
Microsoft Proxy Server configured to the maximum level of security as presented in Test Case PROX-E-3.<br><br></li>
<li>
AIX-BOX loaded with a working copy of the public domain utility fping<i>.</i><br><br></li>
<li>
IR-1 running SCO UNIX.<br><br></li>
<li>
IR-1 loaded with a working copy of the public domain utility fping<i>.</i></li>
</ul>
<h4>Procedure</h4>
<ol>
<li>
Run the fping<i> </i>utility from IR-1 against the external subnet.<br><br></li>
<li>
Run the fping<i> </i>utility from IR-1 against the internal subnet.<br><br></li>
<li>
Run the fping<i> </i>utility from AIX-BOX against the internal subnet.<br><br></li>
<li>
Run the fping<i> </i>utility from AIX-BOX against the external subnet.<br><br></li>
<li>
Document the results.</li>
</ol>
<h4>Observational requirements</h4>
<p>
The file /tmp/fping.out will contain the list of IP addresses which answered or did not answer the ICMP echo request (ping).</p>
<h4>Observations</h4>
<ul type=disc>
<li>
All of the systems attached to the external network did not answer the echo request from a system on the internal network. This result was expected.<br><br></li>
<li>
None of the internal network machines answered an echo request from an external network machine.</li>
</ul>
<p>
<b>Issue</b></p>
<p>
The internal adapter of machine PROXY-1 (the dual-homed Proxy Server) unexpectedly answered the echo request from an external system.</p>
<p>
<b>Description</b></p>
<p>
When an echo request is sent to a Microsoft Proxy Server with a destination address of the internal network adapter, the internal adapter will respond. If the response of the internal adapter address is detected by an outside entity, it could aid in designing a more focused attacked on the internal network. Although designing a more focused attack may not be directly possible through the Microsoft Proxy Server, the information could be used if another entry point was also identified (for example, a non-secured dial-in SLIP or PPP line), and later used to penetrate the network.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
Microsoft Proxy Server does not currently address this issue. However, Microsoft Proxy Server prevents visibility and access to the other systems connected to that adapter’s internal network.</p>
<p class=label>
<b>Test PROX-P-1 Observation Table</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=25%><b>From</b></td>
<td class=label width=34%><b>To</b></td>
<td class=label width=41%><b>Result</b></td>
</tr>
<tr valign=top>
<td width=25%>Internal Network</td>
<td width=34%>External Subnet</td>
<td width=41%>Fping not answered</td>
</tr>
<tr valign=top>
<td width=25%>Internal Network</td>
<td width=34%>Internal Subnet</td>
<td width=41%>1.2.3.0<p>
1.2.3.1</p>
<p>
1.2.3.2</p>
<p>
1.2.3.3</p>
<p>
1.2.3.4</p>
</td>
</tr>
<tr valign=top>
<td width=25%>External Network</td>
<td width=34%>Internal Subnet</td>
<td width=41%>1.2.3.2</td>
</tr>
<tr valign=top>
<td width=25%>External Network</td>
<td width=34%>External Subnet</td>
<td width=41%>10.11.12.1<p>
10.11.12.2</p>
<p>
10.11.12.3</p>
</td>
</tr>
</table><br>
<h3>Test Case PROX-P-2</h3>
<h4>Objective</h4>
<p>
To determine which TCP/IP ports a Windows NT Server will answer to when running the Microsoft Proxy Server using the default configuration options.</p>
<h4>Configuration</h4>
<ul type=disc>
<li>
Refer to <a href="#proxyappa">Appendix A—Test Lab Specification</a>, Test Lab SPEC-1, and <a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a>, Test Lab DIAG-4.<br><br></li>
<li>
Microsoft Proxy Server installed using the standard product installation steps.<br><br></li>
<li>
Microsoft Proxy Server installed with all default or recommended settings.<br><br></li>
<li>
Microsoft Proxy Server configured to maximum level of security as presented in Test Case PROX-E-3.<br><br></li>
<li>
AIX-BOX loaded with a working copy of the public domain utility strobe.</li>
</ul>
<h4>Procedure</h4>
<ol>
<li>
Run the <i>strobe</i> utility from AIX-BOX Server against PROXY-1 as follows:<pre><code># ./strobe proxy1&nbsp;&nbsp; 2&gt; /tmp/strobe.out</code></pre>
</li>
<li>
Document the results.</li>
</ol>
<h4>Observational requirements</h4>
<p>
The file /tmp/strobe.out will contain a complete listing of all of the TCP/IP ports that allowed connections. This file can then be used for further analysis and customization of additional attack scenarios and penetration test cases.</p>
<h4>Observations</h4>
<p>
<b>Issue</b></p>
<p>
The strobe utility detected seven TCP ports answering to external network connections. Three of these were expected: FTP, HTTP, and Gopher. Four of these were unexpected: NI FTP (port 47), Location Server (port 135), NetBIOS (port 139), and Port 1028.</p>
<p>
<b>Description</b></p>
<p>
Each of the TCP/IP service ports identified by “Strobe” represents a possible avenue of external attack by another TCP/IP service specific penetration tools and techniques. In the penetration test cases that follow this test, each of the significant responding ports are further tested for security vulnerabilities.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
This issue can be addressed procedurally. Many of the identified ports can be disabled. The Microsoft-provided <a href="#proxyappc">Appendix C—Server Security Checklist</a> provides guidance on disabling ports 47, 139, and 1028 on the external adapter of a Windows NT Server running Microsoft Proxy Server. FTP port 21 and gopher port 70 can be disabled using the Internet Information Server management tool. Port 135 cannot currently be disabled. The RPC service will unconditionally listen on port 135 on all interfaces, and relies on Windows NT RPC authentication for security; however, our testing did not show any vulnerability related specifically to this issue.</p>
<p class=label>
<b>Test Case PROX-P-2 Observation Table</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=11%><b>From</b></td>
<td class=label width=20%><b>To</b></td>
<td class=label width=69%><b>Result</b></td>
</tr>
<tr valign=top>
<td width=11%>External AIX-BOX</td>
<td width=20%>PROXY-1 204.142.190.161</td>
<td width=69%>proxy1eftp21/tcp File Transfer [Control] [96,JBP]<p>
proxy1eni-ftp47/tcp NI FTP [134,SK8]</p>
<p>
proxy1egopher70/tcp Gopher [MXC1]</p>
<p>
proxy1ewww80/tcp World Wide Web HTTP [TXL]</p>
<p>
proxy1eloc-srv135/tcp NT RPCSS</p>
<p>
proxy1enetbios-ssn139/tcp NETBIOS Session Service [JBP]</p>
<p>
proxy1eunknown1028/tcp unassigned</p>
</td>
</tr>
<tr valign=top>
<td width=11%>AIX-BOX</td>
<td width=20%>PROXY-1 204.142.190.130</td>
<td width=69%>proxy1iftp21/tcp File Transfer [Control] [96,JBP]<p>
proxy1ini-ftp47/tcp NI FTP [134,SK8]</p>
<p>
proxy1igopher70/tcp Gopher [MXC1]</p>
<p>
proxy1iwww80/tcp World Wide Web HTTP [TXL]</p>
<p>
proxy1iloc-srv135/tcp Location Service [JXP]</p>
<p>
proxy1inetbios-ssn139/tcp NETBIOS Session Service [JBP]</p>
<p>
proxy1iunknown1028/tcp unassigned</p>
</td>
</tr>
</table><br>
<h3>Test Case PROX-P-3</h3>
<h4>Objective</h4>
<p>
To determine if the Microsoft Proxy Server is susceptible to any of the common Internet weaknesses identified by the Internet Security Scanner public domain security analyzer/tool.</p>
<p>
The ISS utility will analyze all target systems for the following Internet risks and/or vulnerabilities:
<ul type=disc>
<li>
Existence and misconfiguration of default accounts (guest, lp, sync, and so on)<br><br></li>
<li>
Anonymous FTP vulnerabilities<br><br></li>
<li>
NIS (Sun Naming Server) exposures (i.e., ability to capture copy of password file)<br><br></li>
<li>
NFS exposures (i.e., directories Readable/Writable by the world).<br><br></li>
<li>
Mail vulnerabilities (i.e., existence of common aliases)<br><br></li>
<li>
RPC (Remote Procedure Call) exposures<br><br></li>
<li>
Remote Command (rcp, rlogin, rexec) vulnerabilities<br><br></li>
<li>
Boot Server vulnerabilities</li>
</ul>
<h4>Configuration</h4>
<ul type=disc>
<li>
Refer to <a href="#proxyappa">Appendix A—Test Lab Specification</a>, Test Lab SPEC-1, and <a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a>, Test Lab DIAG-4.<br><br></li>
<li>
Microsoft Proxy Server installed using the standard product installation steps.<br><br></li>
<li>
Microsoft Proxy Server installed with all default or recommended settings.<br><br></li>
<li>
Microsoft Proxy Server configured to maximum level of security as presented in Test Case PROX-F-3.<br><br></li>
<li>
AIX-BOX loaded with a working copy of the public domain analyzer/tool utility <i>ISS</i>.</li>
</ul>
<h4>Procedure</h4>
<ol>
<li>
Run the ISS utility from the AIX-BOX against PROXY-1 Server as follows:<pre><code># ./strobe&nbsp; 204.142.190.193&nbsp; 204.142.190.193</code></pre>
</li>
<li>
Run the ISS utility against the internal addresses on the inside of PROXY-1 as follows:<pre><code># ./strobe&nbsp; 204.142.190.129&nbsp; 204.142.190.130</code></pre>
</li>
<li>
Document the results.</li>
</ol>
<h4>Observational requirements</h4>
<p>
The file ../ISS.log (directory in which ISS was run) will contain a complete listing of all of the ISS utility findings. This file can then be used for further analysis and customization of additional attack scenarios and penetration test cases.</p>
<h4>Observations</h4>
<ul type=disc>
<li>
This tool did not identify any vulnerabilities.<br><br></li>
<li>
In order for a potential system attacker to use this tool, it will be necessary for them to make some code modifications to the standard FreeWare release. Refer to test case PROX-P-7 for the results of the commercial version of this penetration testing tool.</li>
</ul>
<p>
<b>ISS: Run against the external adapter from the external network (without options specified on the command line)</b></p>
<p>
--&gt; &nbsp;&nbsp; Inet Sec Scanner Log by Christopher Klaus ©1993&nbsp;&nbsp;&nbsp; &lt;--</p>
<p>
E-mail: cklaus@hotsun.nersc.gov coup@gnu.ai.mit.edu</p>
<p>
<b>ISS: Run against the external adapter from the external network (with the -p command line option specified)</b></p>
<p>
--&gt; &nbsp;&nbsp; Inet Sec Scanner Log by Christopher Klaus ©1993&nbsp;&nbsp;&nbsp; &lt;--</p>
<p>
E-mail: cklaus@hotsun.nersc.gov coup@gnu.ai.mit.edu</p>
<p>
==============================================================</p>
<p>
Host 10.11.12.2, Port 21 ("ftp" service) opened.</p>
<p>
Host 10.11.12.2, Port 47 opened.</p>
<p>
Host 10.11.12.2, Port 70 opened.</p>
<p>
Host 10.11.12.2, Port 80 opened.</p>
<p>
Host 10.11.12.2, Port 135 opened.</p>
<p>
Host 10.11.12.2, Port 139 opened.</p>
<p>
Host 10.11.12.2, Port 1029 opened.</p>
<p>
The ISS utility, in its FreeWare and unmodified release form, did not attempt to perform any of its tests beyond the initial port scan (and this required using the -p command line option).</p>
<h3>Test Case PROX-P-4</h3>
<h4>Objective</h4>
<p>
To determine if the Microsoft Proxy Server is susceptible to any of the common Internet weaknesses identified by the Satan public domain security analyzer/tool.</p>
<p>
The Satan<i> </i>utility will analyze all target systems for the following additional (over ISS) Internet risks and/or vulnerabilities:
<ul type=disc>
<li>
HTTP vulnerabilities<br><br></li>
<li>
UDP port existence and vulnerabilities<br><br></li>
<li>
Additional TCP port vulnerabilities</li>
</ul>
<h4>Configuration</h4>
<ul type=disc>
<li>
Refer to <a href="#proxyappa">Appendix A—Test Lab Specification</a>, Test Lab SPEC-1, and <a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a>, Test Lab DIAG-4.<br><br></li>
<li>
Microsoft Proxy Server installed using the standard product installation steps.<br><br></li>
<li>
Microsoft Proxy Server installed with all default or recommended settings.<br><br></li>
<li>
Microsoft Proxy Server configured to maximum level of security as presented in Test Case PROX-E-3.<br><br></li>
<li>
AIX-BOX loaded with a working copy of the public domain analyzer/tool utility Satan.</li>
</ul>
<h4>Procedure</h4>
<ol>
<li>
Run the Satan utility with the following options (either using command line options or modifications to the ./config/satan.cf configuration file):<p class=tl>
An attack level of 2 (command line of -a 2)</P><p class=tl>
A proximity descent level of 2 (command line of -A 2 -l 2)</P></li>
<li>
Run the Satan utility from the UNIX Server against the Windows NT Proxy Server as follows:<pre><code># ./Satan&nbsp; -a&nbsp; 2&nbsp; -A&nbsp; 2&nbsp; -l&nbsp; 2&nbsp;&nbsp; proxy1</code></pre>
</li>
<li>
Document the results.</li>
</ol>
<h4>Observational Requirements</h4>
<p>
The file ../results/Satan-data/facts (directory where Satan was run) will contain a complete listing of all of the Satan utility findings. This file can then be used for further analysis and customization of additional attack scenarios and penetration test cases.</p>
<h4>Observations</h4>
<ul type=disc>
<li>
Satan did not identify any vulnerabilities.</li>
</ul>
<p>
<b>Issue</b></p>
<p>
The only issue reported by the Satan utility was its ability to identify the Proxy Server was offering an Anonymous FTP service.</p>
<p>
<b>Description</b></p>
<p>
The Anonymous FTP service is an optional part of the Windows NT Server that was configured by default prior to the installation of the Proxy Server. The FTP service is installed as part of the Internet Information Server. The presence of Anonymous FTP service represents a possible avenue of external attack if misconfigured. Test Case PROX-P-5 tests this for security vulnerabilities within the FTP service.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
This issue can be addressed procedurally. FTP port 21 can be disabled using the<i> </i>Internet Information Server management tool.</p>
<h4>Test case PROX-P-4 Satan results</h4>
<p>
<b>Satan: Run against the external adapter from the internal network</b></p>
<p>
proxy1i|135:TCP|a|x||||offers 135:TCP</p>
<p>
proxy1i|http|a|x|||HTTP/1.0 400 Bad Request\r\nContent-Type: text/html\r\n\r\n&lt;body&gt;&lt;h1&gt;HTTP/1.0 400 Bad Request\r\n&lt;/h1&gt;&lt;/body&gt;|offers http</p>
<p>
proxy1i|ftp|a|x|||220 proxy1 Microsoft FTP Service (Version 2.0).\r\n221 \r\n|offers ftp</p>
<p>
proxy1i|47:TCP|a|x||||offers 47:TCP</p>
<p>
proxy1i|ftp|a|x|||ANONYMOUS|offers anon ftp</p>
<p>
proxy1i|gopher|a|x|||3 --6 Bad Request. \r\n.\r\n|offers gopher</p>
<p>
proxy1i|tcpscan.satan 1-9999|u|||||program timed out</p>
<p>
proxy1i||a|||||rpcinfo error #256</p>
<p>
proxy1i|udpscan.satan 1-2050,32767-33500|u|||||program timed out</p>
<p>
<b>Satan: Run against the external adapter from the external network</b></p>
<p>
proxy1e|ftp|a|x|||220 proxy1 Microsoft FTP Service (Version 2.0).\r\n221 \r\n|offers ftp</p>
<p>
proxy1e||a|||||rpcinfo error #256</p>
<p>
proxy1e|udpscan.satan 1-2050,32767-33500|u|||||program timed out</p>
<p>
proxy1e|47:TCP|a|x||||offers 47:TCP</p>
<p>
proxy1e|ftp|a|x|||ANONYMOUS|offers anon ftp</p>
<p>
proxy1e|gopher|a|x|||3 --6 Bad Request. \r\n.\r\n|offers gopher</p>
<p>
proxy1e|135:TCP|a|x||||offers 135:TCP</p>
<p>
proxy1e|tcpscan.satan 1-9999|u|||||program timed out</p>
<p>
proxy1e|http|a|x|||HTTP/1.0 400 Bad Request\r\nContent-Type: text/html\r\n\r\n&lt;body&gt;&lt;h1&gt;HTTP/1.0 400 Bad Request\r\n&lt;/h1&gt;&lt;/body&gt;|offers http</p>
<h3>Test Case PROX-P-5</h3>
<h4>Objective</h4>
<p>
To attempt manual anonymous FTP penetration attempts.</p>
<h4>Configuration</h4>
<ul type=disc>
<li>
Refer to <a href="#proxyappa">Appendix A—Test Lab Specification</a>, Test Lab SPEC-1, and <a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a>, Test Lab DIAG-4.<br><br></li>
<li>
Microsoft Proxy Server installed using the standard product installation steps.<br><br></li>
<li>
Microsoft Proxy Server installed with all default or recommended settings.<br><br></li>
<li>
Microsoft Proxy Server configured to maximum level of security as presented in Test Case PROX-E-3.<br><br></li>
<li>
AIX-BOX capable of performing a remote FTP session with another network connected system.</li>
</ul>
<h4>Procedure</h4>
<ol>
<li>
Initiate a remote FTP session from the external Server to the Proxy <p class=tl>
# ftp 201.142.190.161</P></li>
<li>
Attempt to login an anonymous user.<p class=tl>
Name (201.142.190.161:root) <b>anonymous</b></P><p class=tl>
Password: <b>test@unix.com</b></P></li>
<li>
Attempt to identify the current working directory<p class=tl>
ftp&gt; pwd</P></li>
<li>
Attempt to gain a listing of the current directory:<p class=tl>
ftp&gt; ls –l and ftp&gt; dir</P></li>
<li>
Attempt to change directory in the Proxy Server<br><br></li>
<li>
Attempt to read one of the Proxy Server critical configuration files.<br><br></li>
<li>
Attempt to add a file to one of the Proxy Server critical directories.<br><br></li>
<li>
Attempt to overwrite a critical Proxy Server file.<br><br></li>
<li>
Document the results.</li>
</ol>
<h4>Observational requirements</h4>
<p>
The tester should take note of all messages displayed by the FTP utility during the course of this test.</p>
<h4>Observations</h4>
<p>
<b>Issue</b></p>
<p>
The FTP Server allowed the external system to gain a successful anonymous login.</p>
<p>
<b>Description</b></p>
<p>
The Anonymous FTP service is an optional part of the Windows NT Server that was configured by default prior to the installation of the Proxy Server. The FTP service is installed as part of the Internet Information Server. The presence of Anonymous FTP service represents a possible avenue of external attack.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
The coexistence of a properly configured (which is the default) FTP Server in the same system with the Microsoft Proxy Server does not appear to present any additional vulnerabilities to the proxy service, Windows NT operating system, or the internal network behind the Server. The FTP Server allowed the external system to gain a successful anonymous login. The default configured FTP Server could not be compromised through standard manual penetration techniques as listed in this test case. In addition, if not required, FTP port 21 can be disabled.</p>
<h3>Test Case PROX-P-6</h3>
<h4>Objective</h4>
<p>
To attempt to exploit the fact that the Microsoft Proxy Server allows connections to the unused TCP/IP port 47 (as a previous run of strobe detected). C&amp;L focused on this port because it is the only additional port that started accepting TCP/IP connection requests after the Proxy Server was installed and is identified by Microsoft as a port that can be used to administrate the Proxy Server.</p>
<h4>Configuration</h4>
<ul type=disc>
<li>
Refer to <a href="#proxyappa">Appendix A—Test Lab Specification</a>, Test Lab SPEC-1, and <a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a>, Test Lab DIAG-4.<br><br></li>
<li>
Microsoft Proxy Server installed using the standard product installation steps.<br><br></li>
<li>
Microsoft Proxy Server installed with all default or recommended settings.<br><br></li>
<li>
Microsoft Proxy Server configured to maximum level of security as presented in Test Case PROX-E-3.<br><br></li>
<li>
AIX-BOX capable of performing a remote FTP session with another network-connected system.</li>
</ul>
<h4>Procedure</h4>
<ol>
<li>
Initiate a manual telnet session from the external system to port 47 on the Proxy.<br><br></li>
<li>
Attempt to perform common telnet and ftp commands such as cd, pwd, &lt;cr&gt;, get, put, and so on.<br><br></li>
<li>
Use a UNIX shell script to initiate 50 to 100 telnet sessions from the external UNIX box to port 47 on the Proxy Server.<br><br></li>
<li>
Use the netstat -a command on the Proxy Server to analyze the connection state of any and all incoming port 47 connections.<br><br></li>
<li>
Document the results.</li>
</ol>
<h4>Observational requirements</h4>
<ul type=disc>
<li>
The tester should take note of all messages displayed by the telnet utility during the course of this test.<br><br></li>
<li>
Network Monitor PROXY-1 to analyze the results of all manual attempts in this test case.<br><br></li>
<li>
Test PROXY-1 for normal operation using another client/server pair to establish a proxy connection.</li>
</ul>
<h4>Observations</h4>
<ul type=disc>
<li>
Port 47 on the Proxy Server allowed a successful telnet from an external system.<br><br></li>
<li>
None of the manual telnet or ftp commands received any response from the Proxy Server.<br><br></li>
<li>
Although attempts at initiating 100 telnet sessions appeared to be successful, when the netstat command was issued on the Proxy Server, it indicated a single inactive connection to port 47<i>. </i>The Microsoft Proxy Server continued to function normally during and after these 100 telnet sessions were attempted.<br><br></li>
<li>
The Network Monitor indicated that the Proxy Server answered each telnet request with a good initial TCP/IP <i>ACK</i>.</li>
</ul>
<p>
<b>Issue</b></p>
<p>
Microsoft Proxy Server allows connections to port 47.</p>
<p>
<b>Description</b></p>
<p>
The ability to connect to port 47 represents a possible avenue of external attack by more service-specific penetration tools and techniques.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
This issue can be addressed procedurally. Port 47 can be disabled. The Microsoft-provided <a href="#proxyappc">Appendix C—Server Security Checklist</a> provides guidance on disabling port 47 on the external adapter of a Windows NT Server running Microsoft Proxy Server. In addition, Microsoft Proxy Server’s allowing connections to port 47 seems to have no apparent security implication. A denial of service attack does not appear to be effective against this open port.</p>
<h3>Test Case PROX-P-7</h3>
<h4>Objective</h4>
<ul type=disc>
<li>
To determine if the Microsoft Proxy Server is susceptible to any of the Internet weaknesses identified by the commercial version of the Internet Security Scanner version 4.0.3 by Internet Security Systems, Inc.<p class=tl>
The commercial ISS SafeSuite<i> </i>utility will analyze all target systems with an intense series of platform and network related vulnerabilities.</P></li>
</ul>
<h4>Configuration</h4>
<ul type=disc>
<li>
Refer to <a href="#proxyappa">Appendix A—Test Lab Specification</a>, Test Lab SPEC-1, and <a href="#proxyappb">Appendix B—Test Lab Network Diagrams</a>, Test Lab DIAG-4.<br><br></li>
<li>
Microsoft Proxy Server installed using the standard product installation steps.<br><br></li>
<li>
Microsoft Proxy Server installed with all default or recommended settings.<br><br></li>
<li>
Microsoft Proxy Server configured to maximum level of security as presented in Test Case PROX-E-3.<br><br></li>
<li>
RIP installed on PROXY-1.<br><br></li>
<li>
AIX-BOX loaded with a working copy of the ISS suite of commercial security tools, including the X-Windows GUI interface.</li>
</ul>
<p class=indent>
<B><b>Note&nbsp;&nbsp;&nbsp;</b></B>It will be necessary to obtain and install a key file from ISS which will allow testing of the specific IP address that is being used by the external adapter of the Microsoft Proxy Server.</p>
<h4>Procedure</h4>
<ol>
<li>
Run the X-Windows version of the ISS utility from AIX-BOX against PROXY-1 as follows:<pre><code># ./xiss</code></pre>
</li>
<li>
Configure the <i>ISS</i> utility using the “Configure Scanner...” menu to attempt every possible penetration technique and to produce a verbose form of its raw output file.<br><br></li>
<li>
Set the IP Address of the Microsoft Proxy Server using the “Additional Hosts” and “&lt;&lt;ADD” entry fields.<br><br></li>
<li>
Start the ISS scanner attack on the Microsoft Proxy Server.<br><br></li>
<li>
Select the “Analyze” button to produce a complete set of text reports with all medium and above conditions included.</li>
</ol>
<h4>Observational requirements</h4>
<ul type=disc>
<li>
The “Analyze” menu will provide a means of generating a series of reports that will highlight a specified level of severity for each identified vulnerability. <br><br></li>
<li>
All members of the evaluation team should analyze the reports produced by the scanner.</li>
</ul>
<h4>Observations</h4>
<ul type=disc>
<li>
The Microsoft Proxy Server, when configured properly, does not appear to be vulnerable to attack from the ISS SafeSuite Internet scanner.<br><br></li>
<li>
Attempts were made to initially have the ISS Scanner run all possible tests against the Microsoft Proxy Server, however, two of the tests had to be disabled to prevent the ISS scanner from hanging. These test included:<ul type=disc>
<li>
The Brute Force <b>Rsh</b> test<br><br></li>
<li>
The <b>X Windows</b> test.</li>
</ul>
</li>
</ul>
<p class=indent>
<B><b>Note&nbsp;&nbsp;&nbsp;</b></B>The above two tests do not apply to any of the services offered by or answered to by Microsoft Proxy Server. Therefore, their exclusion should have no impact on the overall test results.
<ul type=disc>
<li>
A total of eighty-nine (89) ISS SafeSuite tests were performed.</li>
</ul>
<p>
<b>Issue</b></p>
<p>
The only issue raised by the ISS tool was that the Proxy Server allowed Trace Routing packets to be passed between its two network interfaces.</p>
<p>
<b>Description</b></p>
<p>
Trace Routing is when a router allows packet routing information to be echoed through to both attached networks. This information can be helpful to attackers in determining internal network addressing schemes when looking to exploit weaknesses on other systems connected to the internal network. This issue was also identified in Test Case PROX-P-1 when the Proxy Server allowed its internal network adapter to respond to a general echo (ping) request. This issue was noted because the Proxy Server’s internal network adapter answered.</p>
<p>
<b>How Microsoft Proxy Server addresses this issue</b></p>
<p>
Microsoft Proxy Server does not currently address this issue. However, as noted in Test Case PROX-P-1, Microsoft Proxy Server prevents visibility and access to the other systems connected to the internal adapter’s network. This seems to have no apparent security implication.</p>
<h2><a name="proxymanagement"></a>Management's Assertion</h2>
<p>
Microsoft Proxy Server is a software product that provides a gateway to the Internet. Microsoft management represents that the product achieves the following objective:
<ul type=disc>
<li>
Microsoft Proxy Server, when implemented properly in accordance with Microsoft recommendations, can provide a reasonable and practical level of security for Internet connections. These basic security controls are designed to:<ul type=disc>
<li>
Provide resistance to external penetration attempts using commonly known Internet based tools.<br><br></li>
<li>
Provide proxy services to help insulate internal systems from undesirable external activity.<br><br></li>
<li>
Provide a logging capability to detect potential unauthorized activity and track usage.<br><br></li>
<li>
Provide authentication processes to ensure that unauthorized users cannot utilize the product.<br><br></li>
<li>
Provide access control processes to restrict access to certain services, as needed.</li>
</ul>
</li>
</ul>
<h2><a name="proxyreport"></a>Report of Independent Accountants</h2>
<p>
We have examined management's assertion that the Microsoft Proxy Server, when implemented properly in accordance with Microsoft recommendations, is suitably designed to provide a reasonable and practical level of protection for Internet connections. This assertion was prepared by and is the responsibility of Microsoft management. </p>
<p>
Our examination was made in accordance with standards established by the American Institute of Certified Public Accountants and, accordingly, included obtaining an understanding of the internal control structure of the product and such other procedures as we considered necessary in the circumstances. We believe that our examination provides a reasonable basis for our opinion.</p>
<p>
Because of limitations inherent in the internal controls incorporated in software products and the impracticability of using all types of penetration tools and techniques, security controls may be breached and not be detected. Also, projections of any evaluation of controls to future periods are subject to the risk that controls may become inadequate because of changes in conditions, such as the introduction of more powerful tools or techniques to compromise information security.</p>
<p>
In our opinion, management's assertion that the Microsoft Proxy Server, when implemented properly in accordance with Microsoft recommendations, is suitably designed to provide a reasonable and practical level of security for Internet connections as of December 15, 1996 is fairly stated, in all material respects, based upon the criteria included in the assertion.</p>
<h2><a name="proxydisclaimer"></a>Disclaimer</h2>
<p>
This document (the “Evaluation”) presents certain discussions and recommendations concerning Microsoft Proxy Server security. The Evaluation is based on Microsoft Proxy Server (Build 167) running on Windows NT Server version 4.0 RTM (Build 1381), and to a large extent upon technical documentation and other information developed and supplied by Microsoft. Coopers &amp; Lybrand L.L.P. (“C&amp;L”) did not review source code for dormant flaws, and cannot ensure that every potential weakness that might arise in the future has been identified. The Evaluation is based upon a collection of methodologies and tests interacting at a single point in time with an Internet environment that is continually changing and becoming ever more complex. Internet security is continuously being assaulted by increasingly sophisticated and resourceful hackers and other criminals. Just as software virus protection programs are hard put to remain more than a small step ahead of the virus perpetrators, security analyses and recommendations may unexpectedly become outdated. C&amp;L and the individual authors of this report (collectively, the “Authors”) have used methodologies and software they believe to be reliable in evaluating the security issues presented, but the Authors make no representations or warranties concerning either those methodologies and software or the results obtained from their use. While the Authors believe that the material in this Evaluation presents a fair and reasonable picture of Microsoft Proxy Server security controls, nothing herein can substitute for each reader’s own professional and business judgment, independent investigations, and research into the subjects covered. All information presented herein is of a general nature and may not be applicable to any particular situation. Nothing herein constitutes an endorsement of any product by the Authors.</p>
<h2><a name="proxylimitation"></a>Limitation of Testing</h2>
<p>
It is important to note that not all types of penetration tools and techniques were utilized or attempted for the Evaluation. The tests executed in the Evaluation utilized penetration testing tools and techniques common to the security industry. Many penetration attempts rely on long periods of time to analyze and understand targets, utilize intermediary nodes and networks, and employ automated techniques that may run unattended for extended periods of time. Such long term testing was beyond the scope of the Evaluation. In addition, penetration tests provide information regarding only very specific security vulnerabilities and should not be viewed as conclusive of Microsoft Proxy Server’s overall security posture.</p>
<p>
The results of the Evaluation cannot disclose any weakness that may exist in prior or future versions.</p>
<p>
The Evaluation focused on technical controls. There are additional non-technical techniques, such as social engineering, dumpster diving, and others, that have proven to be very effective in circumventing security controls but were not addressed for the Evaluation. Please see the Bibliography for additional information regarding these issues.</p>
<h2><a name="proxybibliography"></a>Bibliography</h2>
<p>
<i>Firewalls and Internet Security: Repelling the Wily Hacker</i>, Cheswick and Bellovin (Addison-Wesley Publishing Company, 1994)</p>
<p>
<i>Network Security: How to Plan for it and Achieve it</i>, Baker (McGraw-Hill, Inc., 1995)</p>
<p>
<i>Computer Communications Security: Principles, Standard Protocols and Techniques</i>, Ford (Prentice-Hall, Inc., 1994)</p>
<p>
<i>Complete LAN Security and Control</i>, Davis, (McGraw-Hill, Inc., "Windcrest", 1994)</p>
<h2><a name="proxyaboutcl"></a>About Coopers &amp; Lybrand</h2>
<p>
Coopers &amp; Lybrand L.L.P. is one of the world's leading professional services firms providing audit, tax, management consulting, financial advisory, and human resource advisory services to clients in a broad range of industries on a globally integrated basis in 140 countries. In the United States, the firm has been serving clients since 1898 and today has 17,000 partners and staff working in over 100 offices. Organized along industry lines, the firm seeks to create value for its clients and to bring a competitive advantage to their activities. Its clients include a variety of large and small, publicly and privately held companies, many numbered among the Fortune 500.</p>
<p>
Coopers &amp; Lybrand L.L.P. has recognized the risks and threats to information since the early stages of information technology development. Their original approach to auditing computer-based systems included the study and evaluation of controls over the security of information. The firm has since established the Information Technology Security Services (ITSS) national practice dedicated to serving their clients’ needs in addressing security over one of their most important resources—technology generated and resident information. The ITSS professionals are recognized leaders in the fields of information technology, telecommunications, logical and physical security, and auditing. They are knowledgeable in the latest security tools and methods, and in evaluating, analyzing, developing, and implementing security and control solutions.</p>
<p>
Services offered by the ITSS practice include Information Security Assessment, Information Security Risk Analysis, Security Plan Development, Internet Connectivity Pre-Implementation Review, Firewall Review, Operating System Security Review, Penetration Testing, Policy and Procedure Development, Business Continuity Planning Review, and Training.</p>
<h2><a name="proxyaboutauthors"></a>About the Authors</h2>
<p>
<b>David Rivera</b> is a Senior Technical Manager of C&amp;L's IT Security Services (ITSS) practice and has over 19 years experience in data processing. David leads C&amp;L's technical team for Internet and UNIX Security Services. David's technical capabilities include internal knowledge of UNIX, TCP/IP, and all Internet protocols and services. David also leads focused Internet penetration exercises from C&amp;L’s Internet testing lab in New York. David earned an M.S. degree in Computer Science and a B.S. in Computer Technology from the New York Institute of Technology.</p>
<p>
<b>James Jumes </b>is a Manager of C&amp;L’s Business Systems Advisory Services (BSAS) and Security practices and has over ten years of information technology strategy, business system selection and implementation, and security experience. James is one of the principal authors of the book <i>Windows NT 3.5 Guidelines for Security, Audit, and Control</i> and has developed a Windows NT 3.5x security review program and recommendations tool. James earned an M.B.A. from Lehigh University and an M.Ed. and B.A. in Psychology from Boston College.</p>
<p>
<b>Neil Cooper </b>is a Technical Manager of C&amp;L’s Information Technology Security Services (ITSS) practice, and has over 16 years experience in data processing. Neil has primary responsibility for leading the Windows NT security service line for C&amp;L and is part of C&amp;L's technical team for UNIX, Windows NT, Netware, and Internet Security Services. Neil's technical capabilities include knowledge of Windows NT, UNIX, TCP/IP, and X-Windows, as well as mid-range systems. Neil earned both a B.S. and M.S. degree in Geology from Penn State University and the University of Delaware.</p>
<p>
<b>Christopher O'Hara</b> is a Senior Technical Specialist in C&amp;L’s Information Technology Security Services (ITSS) practice. Chris' technical focus is on a variety of UNIX variants (SunOS, Solaris, IBM AIX, Linux, HP-UX), Internet security (firewalls, topologies, protection strategies), TCP/IP networking, remote access connectivity, and DEC VAX/VMS data security assessments. In this capacity he has reviewed system configurations, network topologies, and network access points, and assessed the appropriateness of the related security controls. Chris earned a B.S. in Computer Information Systems from the University of Scranton.</p>
<p>
<b>Bruce Murphy </b>is the National Partner of Coopers &amp; Lybrand's ITSS practice based out of the New York region. He has over eleven years of experience implementing access control mechanisms, from a management, technical, and procedural perspective, across PC, LAN, mid-range, and mainframe computing platforms. Bruce lectures frequently on many areas of information security, including Electronic Commerce, Multi-Platform Network Architectures, Local Area Networks, Toll Fraud, and Advanced Authentication Techniques. Bruce earned a B.A. in English from Muhlenberg College, is President of the New Jersey ISSA chapter, and is designated a Certified Information Systems Security Professional.</p>
</BODY>
</HTML>
