<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Active Directory Services Interface in the Microsoft Exchange 5.5 Environment</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="msdn_adsiexch"></a>Active Directory Services Interface in the Microsoft Exchange 5.5 Environment</h1>
<p>
Microsoft Corporation</p>
<p>
November 1997</p>
<h2>Abstract</h2>
<p>
Active Directory Services Interfaces (ADSI) makes it easy to create directory-enabled applications by using high-level tools such as the Microsoft® Visual Basic® programming system, Java®, C, or the Visual C++® development system without having to worry about the underlying differences between the different directory implementations or namespaces. This means that you will be able to build applications that give you a single point of access to multiple directories in your network environment, whether those directories are based on the Lightweight Directory Access Protocol (LDAP) service, the NetWare Directory Service (NDS), or Windows NT Directory Service (NTDS). </p>
<p>
Microsoft Exchange 5.5 is a scalable, reliable, and secure messaging platform. Microsoft Exchange 5.5 directory service supports LDAP V3. You can use ADSI with its LDAP provider to manipulate any object in the Microsoft Exchange 5.5 directory. This capability, together with Collaboration Data Objects (CDO), allows Administrators and developers to write powerful collaborative applications or administration tools efficiently. Formerly known as Active Messaging, CDO provides the object interface for manipulating message and calendar objects as well as submission and retrieval of such objects. </p>
<p>
This paper helps application developers to write directory-enabled applications using ADSI on top of the Exchange 5.5 directory service.</p>
<h2>ADSI and LDAP</h2>
<p>
ADSI provides a Component Object Model (COM) interface to directory objects. ADSI is built on a provider-based model; the client interacts with the COM interfaces exposed by ADSI while the providers implement the mapping between the underlying directory system and the COM interfaces exposed by the ADSI client. An ADSI application that creates or modifies a user in an NDS directory can be used to create a user in an Exchange 5.5 directory. On the other hand, LDAP is an on-the-wire protocol for directory access. So an LDAP application is restricted to accessing directories that expose the LDAP protocol.</p>
<p>
Given that ADSI is a set of COM objects, it can easily be used within Visual Basic or Java script to directory-enable your Web-based applications. It is somewhat harder to do that with a "C"-based LDAP API.</p>
<h2>ADSI and ADO</h2>
<p>
ActiveX® Data Objects (ADO) is used to perform searches within the directory and have the results presented in a tabular form. ADSI, on the other hand, is used to modify entries in the directory. Often you use ADO to search for one or more objects then iterate through the result set and modify the objects of interest. The use of ADSI and ADO is illustrated in the samples below.</p>
<h3>The Microsoft Exchange Directory Schema</h3>
<p>
In order to write applications using ADSI on the Exchange directory, you must have an understanding of the directory schema. The schema defines the available object classes in the directory, the relationship between the object classes, the attributes on each object class, and specific characteristics of the attributes and classes. The Exchange Administration program allows you to view the Exchange directory schema. To do this: 
<ol>
<li>
Run Exchange Admin in RAW mode (admin /r).<br><br></li>
<li>
Select <b>View.Raw Directory</b> from the menu.<br><br></li>
<li>
Select <b>Schema</b> from the window on the left.<br><br></li>
<li>
Double click the object that represents the attribute or object class of interest from the window on the right.</li>
</ol>
<p>
There are three properties that are significant in ADSI support:</p>
<h4>Heuristic</h4>
<p>
The heuristic property can be interpreted as follows:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=23%>Bit 0</td>
<td width=77%>0: Replicate between sites<br>
1: Do not replicate between sites</td>
</tr>
<tr valign=top>
<td width=23%>Bit 1</td>
<td width=77%>0: Attribute is not visible through LDAP<br>
1: Attribute is visible to anonymous and authenticated LDAP clients</td>
</tr>
<tr valign=top>
<td width=23%>Bit 2</td>
<td width=77%>0: Attribute is not accessible by authenticated clients<br>
1: Attribute is accessible to authenticated clients but not anonymous clients</td>
</tr>
<tr valign=top>
<td width=23%>Bit 3</td>
<td width=77%>0: Attribute is not an operational attribute<br>
1: Attribute is an operational attribute</td>
</tr>
<tr valign=top>
<td width=23%>Bit 4</td>
<td width=77%>0: Attribute is not visible in Admin UI (Attributes page of “DS Site Configuration” object)<br>
1: Attribute is visible in Admin UI (Attributes page of “DS Site Configuration” object)</td>
</tr>
</table><br>
<p>
By taking note of heuristics, you can determine the visibility of particular attributes. For example, a heuristic value of 3 means the attribute is not replicated between sites and is visible by anonymous LDAP clients.</p>
<p>
A heuristic value of 11 means the attribute is an operational attribute and is visible to authenticated LDAP clients. </p>
<p>
Operational attributes (attributes with a heuristic bit 3 set) are not visible through ADSI even though it is possible to set their values. To get the value of an operational attribute, you must use an ADO query as described in the example below. </p>
<p class=indent>
<B><b>Caution&nbsp;&nbsp;&nbsp;</b></B>Changing bit 0 of the heuristic property could cause directory replication to stop. You should not change this bit of the heuristic property of an attribute.</p>
<h4>ACL</h4>
<p>
The ACL property determines what rights a user needs to modify the attribute. The ACL property value definitions are:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=17%>0:</td>
<td width=83%>Only the System can modify the attribute</td>
</tr>
<tr valign=top>
<td width=17%>1:</td>
<td width=83%>Users with Modify Admin right can modify the attribute</td>
</tr>
<tr valign=top>
<td width=17%>2:</td>
<td width=83%>Users with Modify User right can modify the attribute</td>
</tr>
<tr valign=top>
<td width=17%>3:</td>
<td width=83%>Users with Modify permissions right can modify the attribute</td>
</tr>
</table><br>
<h4>Description</h4>
<p>
Description determines the LDAP name of the attribute or class.<b> </b></p>
<p class=indent>
<B><b>Caution&nbsp;&nbsp;&nbsp;</b></B>Changing the LDAP name causes interoperability problems.</p>
<h3>Commonly Used Object Classes</h3>
<p>
The following section contains object classes commonly used as well as their most significant attributes. The columns in the tables below should be interpreted as follows:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=23%>LDAP Name: </td>
<td width=77%>Name of the attribute through LDAP (the Description of the attribute in the Exchange schema).</td>
</tr>
<tr valign=top>
<td width=23%>Exchange Name: </td>
<td width=77%>The name of the attribute in the Exchange schema.</td>
</tr>
<tr valign=top>
<td width=23%>Mandatory: </td>
<td width=77%>Whether the attribute is mandatory on the object or not.</td>
</tr>
<tr valign=top>
<td width=23%>Heuristic: </td>
<td width=77%>The heuristic of the attribute as described above.</td>
</tr>
<tr valign=top>
<td width=23%>ACL: </td>
<td width=77%>The access category of the attribute as described above.</td>
</tr>
<tr valign=top>
<td width=23%>Syntax: </td>
<td width=77%>The syntax of the attribute. <ul type=disc>
<li>
Boolean: Attributes with a Boolean syntax can have the values “TRUE” or “FALSE”.<br><br></li>
<li>
Integer: Any integer value.<br><br></li>
<li>
String(Unicode): A Unicode string.<br><br></li>
<li>
String(Numeric): A numeric string.<br><br></li>
<li>
String(Octet): A binary string. According to LDAP Binary attributes are supported using the string encoding of their binary representation. <br><br></li>
<li>
Object(DS-DN): A DN in rfc1779 format (e.g. cn=jsmith,ou=redmond,o=microsoft,c=us).<br><br></li>
<li>
Comment: Comment on the attribute.</li>
</ul>
</td>
</tr>
<tr valign=top>
<td width=23%></td>
<td width=77%></td>
</tr>
</table><br>
<h4>Mail-Recipient (person) Object Class</h4>
<p>
The Mail-Recipient object class is exposed as the “person” object class through LDAP. This object class is inherited by all object classes to which mail can be sent—for example mailbox, custom-recipient, distribution-list, and public-folder.&nbsp; </p>
<p>
It should be noted that this object class is <i>abstract</i>. Thus you cannot create an instance of this object class. It is defined only so that other object classes in the directory can inherit its attributes. </p>
<p>
The following table describes the commonly used attributes on the person object class:</p>
<table border=1 cellpadding=5 cols=9 frame=below rules=rows>
<tr valign=top>
<td width=8%><b>LDAP Name</b></td>
<td width=17%><b>Exchange Name</b></td>
<td width=10%><b>Mandatory</b></td>
<td width=8%><b>Heuristic</b></td>
<td width=5%><b>ACL</b></td>
<td width=11%><b>Syntax</b></td>
<td width=21%><b>Comment</b></td>
</tr>
<tr valign=top>
<td width=8%>rdn</td>
<td width=17%>Common-Name</td>
<td width=10%>Y</td>
<td width=8%>2</td>
<td width=5%>1</td>
<td width=11%>String(Teletex)</td>
<td width=21%>Common Name (RDN of this object)</td>
</tr>
<tr valign=top>
<td width=8%>cn</td>
<td width=17%>Display Name</td>
<td width=10%>N</td>
<td width=8%>2</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>The String displayed by the address book</td>
</tr>
<tr valign=top>
<td width=8%>language</td>
<td width=17%>Language-ISO639</td>
<td width=10%>N</td>
<td width=8%>3</td>
<td width=5%>2</td>
<td width=11%>String(Unicode)</td>
<td width=21%>ISO639 Language</td>
</tr>
<tr valign=top>
<td width=8%>LabeledURI</td>
<td width=17%>LabeledURI</td>
<td width=10%>N</td>
<td width=8%>5</td>
<td width=5%>2</td>
<td width=11%>String(Unicode)</td>
<td width=21%>URL specifying default HTML Web page</td>
</tr>
<tr valign=top>
<td width=8%>Voice-Mail-Recorded-Name</td>
<td width=17%>Voice-Mail-Recorded-Name</td>
<td width=10%>N</td>
<td width=8%>13</td>
<td width=5%>2</td>
<td width=11%>String(Octet)</td>
<td width=21%>The Voice Mail user's spoken name</td>
</tr>
<tr valign=top>
<td width=8%>Voice-Mail-Password</td>
<td width=17%>Voice-Mail-Password</td>
<td width=10%>N</td>
<td width=8%>13</td>
<td width=5%>2</td>
<td width=11%>String(Unicode)</td>
<td colspan=2 width=22%>DTMF digits representing user account security code</td>
</tr>
<tr valign=top>
<td width=8%>Voice-Mail-Greetings</td>
<td width=17%>Voice-Mail-Greetings</td>
<td width=10%>N</td>
<td width=8%>13</td>
<td width=5%>2</td>
<td width=11%>String(Unicode)</td>
<td width=21%>The Voice Mail user's recorded greeting(s)</td>
</tr>
<tr valign=top>
<td width=8%>Voice-Mail-User-ID</td>
<td width=17%>Voice-Mail-User-ID</td>
<td width=10%>N</td>
<td width=8%>13</td>
<td width=5%>2</td>
<td width=11%>String(Unicode)</td>
<td colspan=3 width=41%>DTMF digits representing a user account (e.g. phone extension)</td>
</tr>
<tr valign=top>
<td width=8%>MAPI-Recipient</td>
<td width=17%>MAPI-Recipient</td>
<td width=10%>N</td>
<td width=8%>18</td>
<td width=5%>1</td>
<td width=11%>Boolean</td>
<td colspan=3 width=41%>Indicates to a Gateway if it's a MAPI recipient (True=Yes, False=No)</td>
</tr>
<tr valign=top>
<td width=8%>mail, rfc822Mailbox,OtherMailbox, textEncodedORAddress</td>
<td width=17%>Proxy-Addresses</td>
<td width=10%>N</td>
<td width=8%>18</td>
<td width=5%>1</td>
<td width=11%>String(Teletex)</td>
<td colspan=3 width=41%>The list of foreign mail system addresses for this recipient. This attribute is exposed as follows: Primary SMTP address - mail Primary X.400 address - textEncodedORAddress other addresses - otherMailbox</td>
</tr>
<tr valign=top>
<td width=8%>name</td>
<td width=17%>Display-Name-Printable</td>
<td width=10%>N</td>
<td width=8%>18</td>
<td width=5%>1</td>
<td width=11%>String(Printable)</td>
<td width=21%>The Printable String version of the Display-Name.</td>
</tr>
<tr valign=top>
<td width=8%>uid</td>
<td width=17%>Mail-nickname</td>
<td width=10%>N</td>
<td width=8%>18</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>Mail Nickname</td>
</tr>
<tr valign=top>
<td width=8%>info</td>
<td width=17%>Comment</td>
<td width=10%>N</td>
<td width=8%>18</td>
<td width=5%>2</td>
<td width=11%>String(Unicode)</td>
<td colspan=2 width=22%>This recipient's comment in the Exchange address book.</td>
</tr>
<tr valign=top>
<td width=8%>url</td>
<td width=17%>WWW-Home-Page</td>
<td width=10%>N</td>
<td width=8%>18</td>
<td width=5%>2</td>
<td width=11%>String(Unicode)</td>
<td width=21%>WWW Home page associated with this entry</td>
</tr>
<tr valign=top>
<td width=8%>userCertificate</td>
<td width=17%>X509-Cert</td>
<td width=10%>N</td>
<td width=8%>18</td>
<td width=5%>2</td>
<td width=11%>String(Octet)</td>
<td width=21%>The X.509 v3 certificate(s) of the user</td>
</tr>
<tr valign=top>
<td width=8%>Extension-Attribute-9</td>
<td width=17%>Extension-Attribute-9</td>
<td width=10%>N</td>
<td width=8%>20</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>General extension attribute for customer use</td>
</tr>
<tr valign=top>
<td width=8%>Extension-Attribute-1</td>
<td width=17%>Extension-Attribute-1</td>
<td width=10%>N</td>
<td width=8%>20</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>General extension attribute for customer use</td>
</tr>
<tr valign=top>
<td width=8%>Extension-Attribute-10</td>
<td width=17%>Extension-Attribute-10</td>
<td width=10%>N</td>
<td width=8%>20</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>General extension attribute for customer use</td>
</tr>
<tr valign=top>
<td width=8%>Extension-Attribute-2</td>
<td width=17%>Extension-Attribute-2</td>
<td width=10%>N</td>
<td width=8%>20</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>General extension attribute for customer use</td>
</tr>
<tr valign=top>
<td width=8%>Extension-Attribute-3</td>
<td width=17%>Extension-Attribute-3</td>
<td width=10%>N</td>
<td width=8%>20</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>General extension attribute for customer use</td>
</tr>
<tr valign=top>
<td width=8%>Extension-Attribute-4</td>
<td width=17%>Extension-Attribute-4</td>
<td width=10%>N</td>
<td width=8%>20</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>General extension attribute for customer use</td>
</tr>
<tr valign=top>
<td width=8%>Extension-Attribute-5</td>
<td width=17%>Extension-Attribute-5</td>
<td width=10%>N</td>
<td width=8%>20</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>General extension attribute for customer use</td>
</tr>
<tr valign=top>
<td width=8%>Extension-Attribute-6</td>
<td width=17%>Extension-Attribute-6</td>
<td width=10%>N</td>
<td width=8%>20</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>General extension attribute for customer use</td>
</tr>
<tr valign=top>
<td width=8%>Extension-Attribute-7</td>
<td width=17%>Extension-Attribute-7</td>
<td width=10%>N</td>
<td width=8%>20</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>General extension attribute for customer use</td>
</tr>
<tr valign=top>
<td width=8%>Extension-Attribute-8</td>
<td width=17%>Extension-Attribute-8</td>
<td width=10%>N</td>
<td width=8%>20</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>General extension attribute for customer use</td>
</tr>
<tr valign=top>
<td width=8%>Extension-Attribute-15</td>
<td width=17%>Extension-Attribute-15</td>
<td width=10%>N</td>
<td width=8%>21</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>General extension attribute for customer use</td>
</tr>
<tr valign=top>
<td width=8%>Extension-Attribute-11</td>
<td width=17%>Extension-Attribute-11</td>
<td width=10%>N</td>
<td width=8%>21</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>General extension attribute for customer use</td>
</tr>
<tr valign=top>
<td width=8%>Extension-Attribute-12</td>
<td width=17%>Extension-Attribute-12</td>
<td width=10%>N</td>
<td width=8%>21</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>General extension attribute for customer use</td>
</tr>
<tr valign=top>
<td width=8%>Extension-Attribute-14</td>
<td width=17%>Extension-Attribute-14</td>
<td width=10%>N</td>
<td width=8%>21</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>General extension attribute for customer use</td>
</tr>
<tr valign=top>
<td width=8%>Extension-Attribute-13</td>
<td width=17%>Extension-Attribute-13</td>
<td width=10%>N</td>
<td width=8%>21</td>
<td width=5%>1</td>
<td width=11%>String(Unicode)</td>
<td width=21%>General extension attribute for customer use</td>
</tr>
</table><br>
<h4>Mailbox (organizationalPerson) Object Class</h4>
<p>
The Mailbox object class is exposed as the “organizationalPerson” object class through LDAP. This object class represents an object that contains mail storage in the Microsoft Exchange system. One critical attribute on a Mailbox object is the Assoc-NT-Account, which contains the Security Identifier (SID) of the NT account that has access to the mailbox.</p>
<table border=1 cellpadding=5 cols=7 frame=below rules=rows>
<tr valign=top>
<td class=label width=22%><b>LDAP Name</b></td>
<td class=label width=16%><b>Exchange Name</b></td>
<td class=label width=12%><b>Mandatory</b></td>
<td class=label width=11%><b>Heuristic</b></td>
<td class=label width=5%><b>ACL</b></td>
<td class=label width=9%><b>Syntax</b></td>
<td class=label width=25%><b>Comment</b></td>
</tr>
<tr valign=top>
<td width=22%>mailPreferenceOption</td>
<td width=16%>Delivery-Mechanism</td>
<td width=12%>Y</td>
<td width=11%>4</td>
<td width=5%>1</td>
<td width=9%>Integer</td>
<td width=25%>The mechanism by which this mailbox receives mail. This attribute should be set to 0.</td>
</tr>
<tr valign=top>
<td width=22%>personalTitle</td>
<td width=16%>Personal-Title</td>
<td width=12%>N</td>
<td width=11%>3</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Personal Title (Mr., Mrs., etc.)</td>
</tr>
<tr valign=top>
<td width=22%>Assoc-NT-Account</td>
<td width=16%>Assoc-NT-Account</td>
<td width=12%>N</td>
<td width=11%>12</td>
<td width=5%>1</td>
<td width=9%>String(Octet)</td>
<td width=25%>The primary NT account associated with this Mailbox</td>
</tr>
<tr valign=top>
<td width=22%>street</td>
<td width=16%>Street-Address</td>
<td width=12%>N</td>
<td width=11%>12</td>
<td width=5%>1</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Physical street address</td>
</tr>
<tr valign=top>
<td width=22%>generationQualifier</td>
<td width=16%>Generation-Qualifier</td>
<td width=12%>N</td>
<td width=11%>13</td>
<td width=5%>1</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Generation Qualifier e.g. Sr., Jr., IV</td>
</tr>
<tr valign=top>
<td width=22%>houseIdentifier</td>
<td width=16%>House-Identifier</td>
<td width=12%>N</td>
<td width=11%>13</td>
<td width=5%>1</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Building within a location</td>
</tr>
<tr valign=top>
<td width=22%>Company</td>
<td width=16%>Company</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>1</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Company of the Mailbox Owner</td>
</tr>
<tr valign=top>
<td width=22%>department</td>
<td width=16%>Department</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>1</td>
<td width=9%>String(Unicode)</td>
<td width=25%>The "Department" of this recipient.</td>
</tr>
<tr valign=top>
<td width=22%>givenName</td>
<td width=16%>Given-Name</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>1</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Specifies the first name (given name) of the Mailbox Owner</td>
</tr>
<tr valign=top>
<td width=22%>internationalISDNNumber</td>
<td width=16%>International-ISDN-Number</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>1</td>
<td width=9%>String(Numeric)</td>
<td width=25%>ISDN Number associated with the Mailbox</td>
</tr>
<tr valign=top>
<td width=22%>manager</td>
<td width=16%>Manager</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>1</td>
<td width=9%>Object(DS-DN)</td>
<td width=25%>The "Manager" of this recipient.</td>
</tr>
<tr valign=top>
<td width=22%>physicalDeliveryOfficeName</td>
<td width=16%>Office</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>1</td>
<td width=9%>String(Unicode)</td>
<td width=25%>e.g. "1/1061"</td>
</tr>
<tr valign=top>
<td width=22%>sn</td>
<td width=16%>Last Name</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>1</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Specifies the last name (surname) of the Mailbox Owner</td>
</tr>
<tr valign=top>
<td width=22%>st</td>
<td width=16%>State-Or-Province-Name</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>1</td>
<td width=9%>String(Unicode)</td>
<td width=25%>The State or Province the user is located in</td>
</tr>
<tr valign=top>
<td width=22%>teletexTerminalIdentifier</td>
<td width=16%>Teletex-Terminal-Identifier</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>1</td>
<td width=9%>String(Octet)</td>
<td width=25%></td>
</tr>
<tr valign=top>
<td width=22%>title</td>
<td width=16%>Title</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>1</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Business title of the Mailbox Owner</td>
</tr>
<tr valign=top>
<td width=22%>x121Address</td>
<td width=16%>X121-Address</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>1</td>
<td width=9%>String(Numeric)</td>
<td width=25%></td>
</tr>
<tr valign=top>
<td width=22%></td>
<td width=16%>Telephone-Office2</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Office Phone Number (2) of the Mailbox Owner</td>
</tr>
<tr valign=top>
<td width=22%>co</td>
<td width=16%>Text-Country</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>The country the user is located in</td>
</tr>
<tr valign=top>
<td width=22%>facsimileTelephoneNumber</td>
<td width=16%>Telephone-Fax</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Fax Phone Number of the Mailbox Owner</td>
</tr>
<tr valign=top>
<td width=22%>homephone</td>
<td width=16%>Home phone number</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Home Phone Number of the Mailbox Owner</td>
</tr>
<tr valign=top>
<td width=22%>initials</td>
<td width=16%>Initials</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>User's Initials</td>
</tr>
<tr valign=top>
<td width=22%>l</td>
<td width=16%>City</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>The location/City of the user</td>
</tr>
<tr valign=top>
<td width=22%>mobile</td>
<td width=16%>Mobile number</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Cellular Phone Number of the Mailbox Owner</td>
</tr>
<tr valign=top>
<td width=22%>pager</td>
<td width=16%>Pager number</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Pager Phone Number of the Mailbox Owner</td>
</tr>
<tr valign=top>
<td width=22%>postalAddress</td>
<td width=16%>Address</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Street address of the Mailbox Owner</td>
</tr>
<tr valign=top>
<td width=22%>postalCode</td>
<td width=16%>Postal code</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Postal/Zip Code</td>
</tr>
<tr valign=top>
<td width=22%>secretary</td>
<td width=16%>Assistant</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Mailbox Assistant Display Name</td>
</tr>
<tr valign=top>
<td width=22%>telephoneNumber</td>
<td width=16%>Phone number</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Office Phone Number (1) of the Mailbox Owner</td>
</tr>
<tr valign=top>
<td width=22%>telexNumber</td>
<td width=16%>Telex-Number</td>
<td width=12%>N</td>
<td width=11%>18</td>
<td width=5%>2</td>
<td width=9%>String(Octet)</td>
<td width=25%></td>
</tr>
<tr valign=top>
<td width=22%>employeeNumber</td>
<td width=16%>Employee-Number</td>
<td width=12%>N</td>
<td width=11%>21</td>
<td width=5%>1</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Employee Number</td>
</tr>
<tr valign=top>
<td width=22%>employeeType</td>
<td width=16%>Employee-Type</td>
<td width=12%>N</td>
<td width=11%>21</td>
<td width=5%>1</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Type of Employee</td>
</tr>
<tr valign=top>
<td width=22%>homeFax</td>
<td width=16%>Telephone-Home-Fax</td>
<td width=12%>N</td>
<td width=11%>21</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Home Fax Number</td>
</tr>
<tr valign=top>
<td width=22%>homePostalAddress</td>
<td width=16%>Address-Home</td>
<td width=12%>N</td>
<td width=11%>21</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Home Address</td>
</tr>
<tr valign=top>
<td width=22%>personalMobile</td>
<td width=16%>Telephone-Personal-Mobile</td>
<td width=12%>N</td>
<td width=11%>21</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Personal Mobile Number</td>
</tr>
<tr valign=top>
<td width=22%>personalPager</td>
<td width=16%>Telephone-Personal-Pager</td>
<td width=12%>N</td>
<td width=11%>21</td>
<td width=5%>2</td>
<td width=9%>String(Unicode)</td>
<td width=25%>Personal Pager Number</td>
</tr>
</table><br>
<h4>Custom-Recipient (custom-recipient)</h4>
<p>
The Custom-Recipient object class is exposed as “custom-recipient” object class through LDAP. This object class contains all the attributes of the organizationalPerson object class noted above with the exception of mailPreferenceOption. The Custom-Recipient object class does contain an additional mandatory attribute with the following properties</p>
<table border=1 cellpadding=5 cols=8 frame=below rules=rows>
<tr valign=top>
<td width=16%><b>LDAP Name</b></td>
<td width=20%><b>Exchange Name</b></td>
<td width=14%><b>Mandatory</b></td>
<td width=11%><b>Heuristic</b></td>
<td width=6%><b>ACL</b></td>
<td width=10%><b>Syntax</b></td>
<td width=22%><b>Comment</b></td>
</tr>
<tr valign=top>
<td width=16%>Target Address</td>
<td width=20%>E-mail Address</td>
<td width=14%>Y</td>
<td width=11%>18</td>
<td width=6%>1</td>
<td width=10%>String(Unicode)</td>
<td colspan=2 width=23%>Actual address of the recipient (this address is in the format &lt;address Type&gt;:&lt;value&gt; e.g. SMTP:jsmith@org.com</td>
</tr>
</table><br>
<h4>Distribution-List</h4>
<p>
The Distribution-List object class is exposed as the groupOfNames object class through LDAP. Its attributes are:</p>
<table border=1 cellpadding=5 cols=7 frame=below rules=rows>
<tr valign=top>
<td width=20%><b>LDAP Name</b></td>
<td width=19%><b>Exchange Name</b></td>
<td width=12%><b>Mandatory</b></td>
<td width=11%><b>Heuristic</b></td>
<td width=6%><b>ACL</b></td>
<td width=9%><b>Syntax</b></td>
<td width=23%><b>COMMENT</b></td>
</tr>
<tr valign=top>
<td width=20%>Company</td>
<td width=19%>Company</td>
<td width=12%>FALSE</td>
<td width=11%>18</td>
<td width=6%>1</td>
<td width=9%>String(Unicode)</td>
<td width=23%>Mainly for AB View grouping</td>
</tr>
<tr valign=top>
<td width=20%>department</td>
<td width=19%>Department</td>
<td width=12%>FALSE</td>
<td width=11%>18</td>
<td width=6%>1</td>
<td width=9%>String(Unicode)</td>
<td width=23%>Mainly for AB View grouping</td>
</tr>
<tr valign=top>
<td width=20%>physicalDeliveryOfficeName</td>
<td width=19%>office</td>
<td width=12%>FALSE</td>
<td width=11%>18</td>
<td width=6%>1</td>
<td width=9%>String(Unicode)</td>
<td width=23%>Mainly for AB View grouping</td>
</tr>
<tr valign=top>
<td width=20%>st</td>
<td width=19%>State-Or-Province-Name</td>
<td width=12%>FALSE</td>
<td width=11%>18</td>
<td width=6%>1</td>
<td width=9%>String(Unicode)</td>
<td width=23%>Mainly for AB View grouping</td>
</tr>
<tr valign=top>
<td width=20%>title</td>
<td width=19%>Title</td>
<td width=12%>FALSE</td>
<td width=11%>18</td>
<td width=6%>1</td>
<td width=9%>String(Unicode)</td>
<td width=23%>Mainly for AB View grouping</td>
</tr>
<tr valign=top>
<td width=20%>co</td>
<td width=19%>Text-Country</td>
<td width=12%>FALSE</td>
<td width=11%>18</td>
<td width=6%>2</td>
<td width=9%>String(Unicode)</td>
<td width=23%>Mainly for AB View grouping</td>
</tr>
<tr valign=top>
<td width=20%>l</td>
<td width=19%>City</td>
<td width=12%>FALSE</td>
<td width=11%>18</td>
<td width=6%>2</td>
<td width=9%>String(Unicode)</td>
<td width=23%>Mainly for AB View grouping</td>
</tr>
<tr valign=top>
<td width=20%>Hide-DL-Membership</td>
<td width=19%>Hide-DL-Membership</td>
<td width=12%>FALSE</td>
<td width=11%>20</td>
<td width=6%>1</td>
<td width=9%>Boolean</td>
<td width=23%>Indicates if he Membership should be hidden from the client (default is FALSE).</td>
</tr>
<tr valign=top>
<td width=20%>owner</td>
<td width=19%>Owner</td>
<td width=12%>FALSE</td>
<td width=11%>20</td>
<td width=6%>1</td>
<td width=9%>Object(DS-DN)</td>
<td width=23%>The DN of the Mailbox that "owns" this Distribution List.</td>
</tr>
<tr valign=top>
<td width=20%>member</td>
<td width=19%>Members</td>
<td width=12%>FALSE</td>
<td width=11%>20</td>
<td width=6%>2</td>
<td width=9%>Object(OR-Name)</td>
<td width=23%>The list of DNs that are members of the Distribution List</td>
</tr>
</table><br>
<h3>Retrieving Incremental Changes through ADSI</h3>
<p>
In certain applications, such as a directory synchronization service, it is important to get incremental changes out of the Exchange directory. This can be achieved by performing searches on the following operational attributes, which exist on every object in the Exchange directory:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=30%>USN-Changed: </td>
<td width=70%>This is an integer that is incremented by the Exchange directory every time a modification is made to an object (deletions are treated as any other modification to the object).</td>
</tr>
<tr valign=top>
<td width=30%>USN-Created: </td>
<td width=70%>This is an integer that represents when an object was created in the Exchange directory. </td>
</tr>
<tr valign=top>
<td width=30%>When-Changed: </td>
<td width=70%>This is the UTC time when the object was changed.</td>
</tr>
<tr valign=top>
<td width=30%>When-Created: </td>
<td width=70%>This is the UTC time when the object was created.</td>
</tr>
</table><br>
<p>
By keeping track of USN-Changed/Created or When-Changed/Created, an application can get at changes in the Exchange directory since the last time it polled for changes.</p>
<p>
These attributes are available to any authenticated user.</p>
<h3>Retrieving Deleted Objects through ADSI</h3>
<p>
Just as important as retrieving incremental changes from the Exchange Directory is the capability of retrieving deleted objects. This can be done by binding using clear text authentication with “,cn=admin” appended to the user’s DN (e.g. dc=domain,cn=jsmith,cn=admin). </p>
<p>
When a client is authenticated with the Exchange Directory with “,cn=admin” in the user’s DN, it will be able to query for an operational attribute called “is-deleted”. This attribute is a Boolean attribute that indicates whether the object has been deleted or not. A deleted object is referred to as a tombstone. Tombstones exist for a period of time indicated by the “Tombstone lifetime” parameter on the DS Site Configuration property page in the Microsoft Exchange Admin program. By default, the “Tombstone lifetime” is set to 30 days. If your application depends on getting deletions out of the Exchange Directory you should make sure that it runs within the “Tombstone lifetime” period.</p>
<h3>ADSI Samples</h3>
<p>
This section contains a couple of ADSI samples that demonstrate authentication against the Exchange directory, searches for objects using ADO, and manipulation of objects using ADSI.</p>
<h4>Distribution List manager</h4>
<p>
The code below will create a distribution list and populate it with the users found via an ADO query:</p>
<pre><code>Option Explicit

Dim strDisplayName&nbsp;&nbsp;&nbsp; ' DL's Display name
Dim strAliasName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' DL's Alias name
Dim strDirectoryName&nbsp; ' DL's Directory name
Dim strUserName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' User's logon name and domain
Dim strPassword&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' User's domain password
Dim strServer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Exchange server name
Dim strOrganization&nbsp;&nbsp; ' Exchange Organization
Dim strSite&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Exchange Site
Dim strRecipientsPath ' ADsPath to the Recipients Container
Dim strMSPrivMDBPath&nbsp; ' ADsPath to the MS Private MDB
Dim objRecipients&nbsp;&nbsp;&nbsp;&nbsp; ' Recipients Container object
Dim objMSPrivMDB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' MS Private MDB object
Dim objNewDL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' new distribution list object
Dim strMail&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' mail address of the MS Private MDB object
Dim intPos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' numeric position of the '@' in an SMTP address
Dim strSMTPExt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' SMTP domain type (ie. com, org, etc...)
Dim strSMTPAddr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' new DL's SMTP address
Dim aOtherMailbox(1)&nbsp; ' other addresses created (ie. MSMail, CCMail)
Dim strx400Addr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' new DL's X400 address
Dim objMyIADs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' ADSI object

' used by the PutEx method to set a muti-valued property
Const ADS_PROPERTY_UPDATE = 2

strDisplayName = "BellevueDL"
strAliasName = "BellevueDL"
strDirectoryName = "BellevueDL"

strUserName = "dc=redmond, cn=v-sparke"
strPassword = "password"

strServer = "sparker1"
strOrganization = "16"
strSite = "3081"

Set objMyIADs = GetObject("LDAP:")
</code></pre>
<p>
The following code determines the domain address extension by looking at the ‘'mail' property of the well-known “Microsoft Private MDB” object:</p>
<pre><code>strMSPrivMDBPath = "LDAP://" + strServer + "/cn=Microsoft Private MDB,cn=" + strServer + ",cn=Servers ,cn=Configuration,ou=" + strSite + ",o=" + strOrganization
</code></pre>
<p>
This application uses the OpenDSObject method to access directory objects. The user's logon domain, name and password are passed as parameters. The value of 0 means that the ADSI LDAP provider will do a simple bind:</p>
<pre><code>Set objMSPrivMDB = objMyIADs.OpenDSObject(strMSPrivMDBPath, strUserName, strPassword, 0)
objMSPrivMDB.GetInfo
strMail = objMSPrivMDB.Get("mail")
intPos = InStr(strMail, "@")
strSMTPExt = Mid(strMail, intPos, Len(strMail))
</code></pre>
<p>
The code below builds SMTP, MSMAIL, CCMAIL, and X400 addresses. "US" is hardcoded into the X400 address. The textEncodedORaddress property of the MS Private MDB object may be parsed to determine the correct X400 addressing scheme:</p>
<pre><code>strSMTPAddr = replace(strAliasName, " ", "") + strSMTPExt
aOtherMailbox(0) = CStr("MS$" + strOrganization + "/" + strSite + "/" + strAliasName)
aOtherMailbox(1) = CStr("CCMAIL$" + strAliasName + " at " + strSite)
strx400Addr = "c=US;a= ;p=" + strOrganization + ";o=" + strSite + ";s=" + strAliasName + ";"

strRecipientsPath = "LDAP://" + strServer + "/cn=Recipients,ou=" + strSite + ",o=" + strOrganization
Set objRecipients = objMyIADs.OpenDSObject(strRecipientsPath, strUserName, strPassword, 0)
</code></pre>
<p>
This code creates the distribution list:</p>
<pre><code>Set objNewDL = objRecipients.Create("groupOfNames", "cn=" + strDirectoryName)
</code></pre>
<p>
Note that in VBScript, it is necessary to CStr() string values to properly format the data for ADSI:</p>
<pre><code>objNewDL.Put "cn", CStr(strDisplayName)
objNewDL.Put "uid", CStr(strAliasName)
objNewDL.Put "distinguishedName", CStr("cn=" + strAliasName + ",cn=Recipients,ou=" + strSite + ",o=" + strOrganization)
objNewDL.Put "mail", CStr(strSMTPAddr)
</code></pre>
<p>
This code creates a multivalued property. In VBScript you have to de-reference the array by using parentheses:</p>
<pre><code>objNewDL.PutEx ADS_PROPERTY_UPDATE, "otherMailbox", (aOtherMailbox)

objNewDL.Put "Report-To-Originator", True
objNewDL.Put "Report-to-Owner", False
objNewDL.Put "Replication-Sensitivity", CInt(20)
objNewDL.Put "rfc822Mailbox", CStr(strSMTPAddr)
objNewDL.Put "textEncodedORaddress", CStr(strx400Addr)
objNewDL.SetInfo

Response.Write "DL Created Successfully!&lt;BR&gt;&lt;BR&gt;"
</code></pre>
<p>
The code below will find mailboxes in the Exchange directory services whose "City" property matches the search criteria. The ADSI LDAP name for "City" property is "l."</p>
<pre><code>Dim objADOconn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' ADO connection object
Dim strADOQueryString&nbsp;&nbsp; ' ADO query string
Dim objRS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' recordset object
Dim strCriteria&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' value used to search the directory tree

strCriteria = "Bellevue"

Set objADOconn = CreateObject("ADODB.Connection")
objADOconn.Provider = "ADSDSOObject"
objADOconn.Open "ADs Provider"
strADOQueryString = "&lt;LDAP://" + strServer + "&gt;;(&amp;(objectClass=organizationalPerson)(l=" + strCriteria + "));cn,adspath;subtree"
Set objRS = objADOconn.Execute(strADOQueryString)
If Not objRS.EOF Then
  While Not objRS.EOF
 &nbsp;&nbsp; objNewDL.Add objRS.Fields(1).Value
 &nbsp;&nbsp; Response.Write objRS.Fields(0) + " added :)&lt;BR&gt;"
 &nbsp;&nbsp; objRS.MoveNext
  Wend
Else
  Response.Write "No mailboxes were added to the DL :(&lt;BR&gt;"
End If
objRS.Close
</code></pre>
<h4>Phone List</h4>
<p>
This code will modify the Phone number property of a mailbox. All users have access to modify this property on their mailbox by default.</p>
<p>
This following code will cause the browser to pop up a user-identification dialog box. The IIS server's password authentication must be set to "Allow Anonymous" and "Basic (Clear Text)" only. This way, the browser will be able to use the correct security context when using the GetObject method.</p>
<pre><code>Dim strAT ' Authorization Type information

strAT = Request.ServerVariables("AUTH_TYPE")
If InStr(1, "_BasicNTLM", strAT, 1) &lt; 2 Then
  Response.Buffer = True
  Response.Status = ("401 Unauthorized")
  Response.End
End If

Dim strMailboxPath&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' ADsPath to the user's mailbox
Dim strServer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' name of the Exchange 5.5 server
Dim intPosPrefix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' numeric index used used to build ADsPath to schema object
Dim intPosSuffix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' numeric index used used to build ADsPath to schema object
Dim strPrefix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' prefix string used to build ADsPath to schema object
Dim strSuffix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' suffix string used to build ADsPath to schema object
Dim strPathToSchemaObject ' ADsPath to the schema object
Dim objMailbox&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' mailbox object
Dim strNewPoneNumber&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' value of the new phone number

Function isUserEditable(strSchemaObjectPath)
  Dim objSchemaObject&nbsp;&nbsp;&nbsp;&nbsp; ' schema object
  Dim intValue&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' value of the Access-Category property

  Set objSchemaObject = GetObject(strSchemaObjectPath)
  intValue = objSchemaObject.Get("Access-Category")
  If intValue = 2 Then&nbsp;&nbsp;&nbsp; ' user may modify the mailbox property
 &nbsp;&nbsp; isUserEditable = True
  Else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' the value was 0, 1, or 3
 &nbsp;&nbsp; isUserEditable = False
  End If
End Function
</code></pre>
<p>
This procedure will modify the property of an object that contains a string value. To set a property to the empty string, you must remove it from the object:</p>
<pre><code>Sub ModifyProperty(strNewValue, strADsProperty)
  On Error Resume Next

  If Len(strNewValue) &lt;&gt; 0 Then
 &nbsp;&nbsp; objMailbox.Put strADsProperty, CStr(strNewValue)

  Else&nbsp; ' The new value is empty
 &nbsp;&nbsp; objIADs.Get (strADsProperty)
</code></pre>
<p>
If the property doesn't exist on the object, an error will be generated using the Get method:</p>
<pre><code>&nbsp;&nbsp;&nbsp;&nbsp;If Err.Number = 0 Then ' the property exists on the object and must be removed
 &nbsp;&nbsp;&nbsp;&nbsp; objMailbox.PutEx ADS_PROPERTY_CLEAR, strADsProperty, CStr(" ")
 &nbsp;&nbsp; End If
 &nbsp;&nbsp; Err.Clear
  End If
End Sub

Const ADS_PROPERTY_CLEAR = 1&nbsp; ' used by the PutEx method to clear a property from an object

strMailboxPath = "LDAP://SPARKER1/cn=SParker,cn=Recipients,ou=3081,o=16"
strServer = "sparker1"
strNewPoneNumber = "(425) 882-8080 x 13882"

intPosPrefix = InStr(strMailboxPath, "/cn")
intPosSuffix = InStr(strMailboxPath, "ou")
strPrefix = Mid(strMailboxPath, 1, intPosPrefix - 1) + "/cn="
strSuffix = ",cn=Microsoft DMD," + Mid(strMailboxPath, intPosSuffix, Len(strMailboxPath))

strPathToSchemaObject = strPrefix + "Telephone-Office1" + strSuffix
If isUserEditable(strPathToSchemaObject) Then
  Set objMailbox = GetObject(strMailboxPath)
  ModifyProperty strNewPoneNumber, "telephoneNumber"
  objMailbox.SetInfo&nbsp; ' save the object information
  Response.Write "Phone number modified successfully :)&lt;BR&gt;"
Else
  Response.Write "You don't have permissions to modify your phone number :(&lt;BR&gt;"
End If
%&gt;
</code></pre>
<h3>Limitations of ADSI</h3>
<p>
ADSI cannot yet manipulate Access Control Lists (ACLs), which contain security information about which user has rights on a certain object. It cannot get the Windows NT Security Identifier (SID), the binary representation of a user’s account name, and thus cannot set the bits necessary to create the user’s rights. Thus developers cannot create a functional Mailbox object completely with ADSI, since a mailbox object requires the NT account SID in the Assoc-NT-Account attribute as well as the correct security rights on the mailbox object in the NT-Security-Descriptor attribute. The capability to manipulate ACLs is expected in a future release.</p>
<h4>Enhancing Exchange with ADSI</h4>
<p>
Because ADSI frees developers from involvement in directory-specific APIs, it makes administrative functions more flexible. For example, a directory-specific API might require an administrator to key in a security password and domain on an Active Server Page, exposing it to risk. By contrast, ADSI objects force the Web browser to prompt the administrator.</p>
<p>
Once a developer learns the ADSI convention, it is easy to write an LDAP path name and specify the class and property of an object. Exchange 5.5 will bring up an ADSI page that allows developers to type in the appropriate Exchange Server, pull it from the registry and populate the server field. By using ADSI objects, they can develop a variety of easy-to-use applications. For example, developers can write a Web-server script that allows a browser to look up details of users represented in different directories. Or, they can create a distribution list manager that creates distribution lists from users in different directories. Or, they can specify access privileges for printer queues. With the flexibility of ADSI, the possibilities are manifold.</p>
<h2>Conclusion</h2>
<p>
Designed to provide a single, consistent open set of interfaces for heterogeneous directory services, ADSI provides an important common ground in today’s far-flung enterprise networks and intranets. Furthermore, it enables Exchange administrators and developers to write applications and to port Exchange Directory Access Programming Interface (DAPI)-based applications to ADSI. These applications will run in Exchange 5.5 environments and with minimal or no changes can run on top of the Windows NT 5 Active Directory. Exchange developers and administrators can thus more easily keep pace with changes while developing directory-enabled applications more efficiently.</p>
<h3>For More Information </h3>
<p>
Visit the following Web sites for more information:
<ul type=disc>
<li>
Internet drafts, including the LDAPV3-protocol: <a href="ftp://ds.internic.net/internet-drafts/">ftp://ds.internic.net/internet-drafts/</a><br><br></li>
<li>
ADSI and Windows NT 5 Active Directory: <a href="http://www.microsoft.com/ntserver/default.asp">http://www.microsoft.com/ntserver/default.asp</a><br><br></li>
<li>
Information on Exchange 5.5: <a href="http://www.microsoft.com/exchange/default.asp">http://www.microsoft.com/exchange/default.asp</a></li>
</ul>
</BODY>
</HTML>
