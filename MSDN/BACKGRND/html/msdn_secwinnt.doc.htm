<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Securing Windows NT to Prevent ODBC Tracing</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="msdn_secwinnt.doc"></a>Securing Windows NT to Prevent ODBC Tracing </h1>
<p>
Microsoft Corporation</p>
<p>
1997</p>
<h2>Introduction</h2>
<p>
The Microsoft Windows NT operating system provides a rich set of security features. This article describes functionality in Windows NT 4.0 that provides a system administrator who requires enhanced security with the ability to keep non-administrative users from initiating an ODBC trace. The following steps should be followed while logged in as an administrator: 
<ol>
<li>
Log in to the machine you are protecting as the machine or domain administrator. Using regedt32.exe, take ownership of the following key: <pre><code>HKEY_LOCAL_MACHINE\
 SOFTWARE\
 ODBC\
 ODBC.INI
</code></pre>
</li>
<li>
Set the value "Trace" to "0". The "Trace" value can be found under the following registry key: <pre><code>HKEY_LOCAL_MACHINE\
 SOFTWARE\
 ODBC\
 ODBC.INI\
 ODBC
</code></pre>
</li>
<li>
Set the value "TraceDll" to an empty string. The "TraceDll" value can be found under the following registry key: <pre><code>HKEY_LOCAL_MACHINE\
 SOFTWARE\
 ODBC\
 ODBC.INI\
 ODBC
</code></pre>
</li>
<li>
Set the permissions for "Everyone" to READ on the "ODBC" key. <br><br></li>
<li>
Remove explicit permissions on the "ODBC" key for any non-administrative users. </li>
</ol>
<p>
For each user, there is a registry file. This file is named <code>%SYSTEMROOT%\profiles\username\ntuser.dat</code>. These files can be loaded into regedt32.exe using the Registry | Load Hive menu command. 
<ol>
<li>
Make the HKEY_USERS window active, and click on HKEY_USERS. Using the "Load Hive" command on the "Registry" menu, find the appropriate hive. When prompted for the key name, use the username you are editing. <br><br></li>
<li>
Take ownership of the key ODBC and its subkeys as was done in the preceding steps. The key will be found in the following location:<pre><code>HKEY_USERS\
 username\
 SOFTWARE\
 ODBC\
 ODBC.INI\
 ODBC
</code></pre>
</li>
<li>
Set the value "Trace" to "0". The "Trace" value can be found under the following registry key: <pre><code>HKEY_LOCAL_MACHINE\
 username\
 SOFTWARE\
 ODBC\
 ODBC.INI\
 ODBC
</code></pre>
</li>
<li>
Set the value "TraceDll" to an empty string. The "TraceDll" value can be found under the following registry key: <pre><code>HKEY_LOCAL_MACHINE\
 username\
 SOFTWARE\
 ODBC\
 ODBC.INI\
 ODBC
</code></pre>
</li>
<li>
Set the permissions for "Everyone" to READ on the "ODBC" key. <br><br></li>
<li>
Remove explicit permissions on the "ODBC" key for any non-administrative users. <br><br></li>
<li>
Unload the hive you just loaded. </li>
</ol>
<p>
The preceding steps secured currently existing registry keys. When creating new users, the steps above need to be followed.</p>
</BODY>
</HTML>
