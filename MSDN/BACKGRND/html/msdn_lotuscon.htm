<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The Microsoft Exchange Server 5.5 Connector for Lotus Notes</title>
                <style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="msdn_lotuscon"></a>The Microsoft Exchange Server 5.5 Connector for Lotus Notes </h1>
<p>
Microsoft Corporation</p>
<p>
November 1997</p>
<h2>Abstract</h2>
<p>
Now users and administrators who are working with Lotus Notes can add Microsoft® Exchange Server 5.5 to their environment and enjoy the benefits of both technologies. Through a product known as the Connector for Lotus Notes, Microsoft introduces comprehensive interoperability between Lotus Notes and Exchange, including high-fidelity messaging between the two environments, as well as support for DocLink, directory synchronization, and sophisticated workflow integration.</p>
<h2>Introduction</h2>
<p>
If you are installing Microsoft® Exchange Server 5.5 into a Lotus Notes environment, you now can leverage the benefits of both technologies with the help of the Connector for Lotus Notes, a Microsoft product that builds on the LinkAge Message Exchange technology. The Connector for Lotus Notes encompasses (1) the connectivity layer of LinkAge Message Exchange; (2) the SQL-based directory engine of LinkAge Directory Exchange, which translates addresses between systems and acts as a directory switch; and (3) new support for point-to-point directory synchronization. Enterprises that have the Connector no longer need Microsoft SQL Server™ to provide interoperability between Lotus Notes and Microsoft Exchange. </p>
<p>
In its first release, the Connector runs exclusively on Intel-based processors; but by next year, it is expected to run on Digital Alpha Server platforms also. In the meantime, enterprises using Alpha Servers can address items through the Connector for Lotus Notes proxy address generators or e-mail address generators for both Intel and Alpha platforms. The Connector for Lotus Notes is initially available in English, but by next year it will also support French, German, and Japanese. Until then, enterprises that require those languages can access Connector capabilities through its support for foreign language RTF file format.</p>
<h2>Integrating Two Powerful Environments </h2>
<p>
With the Connector for Lotus Notes, enterprises can enjoy integrated messaging and directory synchronization between Lotus Notes and Microsoft Exchange Server 5.5. The Connector is installed on an Exchange server and managed and configured from the standard Exchange Administrator program through property pages built into its container.</p>
<p>
The Connector can communicate with Lotus Notes version 3 or 4 servers, including the latest Domino servers, through the Notes API. To access the API, enterprises need one copy of Lotus Notes 4.52, the most recent client to be installed on the Exchange server. The client is not launched in terms of startup, but it does use certain files within the installation to access the API layer provided by Notes.</p>
<h3>High-Fidelity Connection </h3>
<p>
Developers have worked hard to ensure high fidelity in the connection between Notes and Exchange, so that users view the same content and exercise similar steps in sending and receiving messages. For example, users can trade OLE-based attachments and ordinary attachments alike. They can view text saved as .rtf files and use bold, underlining, italics, fonts, colors, and other formatting. They can see the same or similar status messages, such as delivery confirmation, nondelivery reports, and read receipt. They can also flag messages as high, medium, or low priority and with public, private, or confidential sensitivity.</p>
<h3>DocLink Support </h3>
<p>
Integral to the functionality of the Connector is DocLink, the powerful hyperlink capability between Lotus Notes documents. Most Notes-based workflow applications and simpler applications use a DocLink to join documents from different databases or applications. Because DocLink is so useful, the Connector supports it in messages sent from any LAN-connected Notes server to Exchange. Such messages can include .rtf and OLE attachments and, in the Domino version, hyperlink attachments. In addition, the Connector supports a DocLink that refers to a database residing anywhere in the connected Notes environment.</p>
<p>
On the receiving end of messages containing a DocLink, Exchange users have three options, depending on how their Exchange administrator has configured the Connector. In the most basic configuration, they can receive a DocLink as an ordinary .rtf attachment. When configured for this option, the Connector intercepts any message coming from Notes with a DocLink, retrieves the linked document, and converts it to an .rtf file. Exchange users can browse such a document using any word processor that supports rich text formatting.</p>
<p>
At a slightly higher level of interoperability, Exchange users can receive a DocLink as an OLE attachment. This option is preferred when Exchange users have Notes clients installed on their desktops. In such a situation, users can click an icon in Exchange to launch the Notes application from which the DocLink originated, and then participate fully in the application.</p>
<p>
At the highest level of interoperability, the Connector translates a DocLink into a URL hyperlink. Note that this option is available only for the Domino version of Notes, which has an HTTP server built into it. When Exchange is configured to support the URL option, a DocLink appears to Exchange users as an icon representing a Web page. Through this icon, Exchange users can launch their browser, their domain HTTP server, and their Notes application. </p>
<p>
Note that in an environment containing installations of Notes 3.<i>x</i> and 4.<i>x</i>, you can set the Connector to represent DocLinks as URLs. Then, any document that originates from a Domino server will be sent across in that way. A DocLink pointing to a document that is on an R3 server, for example—that is, not a Domino server—will be downgraded automatically to an .rtf attachment.</p>
<h3>Workflow Integration </h3>
<p>
Because they enable Exchange to participate fully in Notes applications through default browsers, the DocLink options can greatly streamline the integration of workflow applications throughout the enterprise. Such applications typically involve interactions between two or more people and a database application, and are characterized by almost constant interaction with the mail system. For example, one person originates a transaction; an agent monitors the database involved and sends a mail notification to the next person in the workflow; that person accesses the database to retrieve the original transaction and perform some action on it; and the agent transmits another mail notification to the transaction originator.</p>
<h3>Directory Synchronization</h3>
<p>
The Connector for Lotus Notes supports bidirectional directory synchronization with full-load or delta options. This means you can perform a full load or reload of the property page reusing delta options: pulling an entire directory from your Exchange or Notes site, or merely asking for updates from either system. The default configuration in the current Connector release provides the most commonly used attributes; more may be added in subsequent releases. </p>
<p>
The current Connector release also supports multiple Notes containers, name books, and address books. In many Notes configurations, particularly those involving complex directory scenarios, users keep name and address books separate. You can allow for this with the help of the Connector’s extensive customization capabilities, which provide granular control of the books’ presentation. </p>
<p>
The Connector also supports Notes groups and Exchange distribution lists, and includes some filtering capabilities. For example, you can exclude selected Notes groups, prohibit moving selected groups into Exchange distribution lists, and determine which custom recipients are to be included in these lists.</p>
<h3>Unsupported Features</h3>
<p>
It is important to note that despite the many capabilities of the Connector, it does not support a few Notes features: obscure mood stamps, bullets, numbering, tables, collapsible sections, and encryption. The Connector does support mood stamps that are, in fact, sensitivity attributes, by mapping them to Exchange attributes, but it drops the more obscure ones and moves them instead as normal class messages. Bullets, numbering, tables, collapsible sections, and encryption probably will be supported in a future release.</p>
<h2>Configuration Options</h2>
<p>
To configure the Connector, you must first identify the Notes server to which you are connecting the Exchange server, with a name and a polling interval. For directory synchronization, you must identify the container into which you will export to Notes and a schedule for directory synchronization, typically once per day.</p>
<p>
During installation of the Connector, you access a setup program that is separate from that of Exchange. As part of your installation, address generators are automatically installed on the Exchange server; you also can install them manually on downstream sites. (Note that those sites can be running Exchange 4.0, 5.0, or 5.5.) Automatic installation also occurs for all necessary proxy-address generation or email-address–generation DLLs. These DLLs are enabled once you have installed or activated their respective components.</p>
<h2>Architecture</h2>
<p>
<img src="lotuscon1.gif" border=0></p>
<p class=label>
<b>Figure 1. The Connector architecture consists of two domains: one for Lotus Notes and one for Microsoft Exchange. The Connector resides on an Exchange server with the Notes 4.52 client DLL available to it in the setup.</b></p>
<p>
<img src="lotuscon2.gif" border=0></p>
<p class=label>
<b>Figure 2. The Exchange information store is a transacted and recoverable area in which Connector processes are managed.</b></p>
<p>
Inside the Connector are a number of processes. In one, the Exchange connectivity administrator enables you to monitor the service and the processes running inside the service so you can see the status of individual processes. In Figure 2, the Exchange.box messages leave the Notes server and head for the Exchange server. In the process, they are converted into the correct Exchange format and moved into the next cube, into MTS-IN, the inbound-to-Exchange queue. They then proceed into the Exchange server, where they are routed to the appropriate user. A message headed in the opposite direction follows an analogous path.</p>
<h2>Implementation Scenarios</h2>
<p>
You can implement the Connector for Lotus Notes according to four different connection scenarios: departmental, downstream sites/domains, shared Internet access, and message switch. Within the departmental connection scenario, exist a single Notes domain and a single Exchange site that need to communicate with each other. To accomplish this, you first install the Connector on one of your Exchange servers. (For performance reasons, this should be a dedicated Exchange server and not one that also will be hosting native mailboxes.) Then you select a single Notes server as the “beachhead server,” where all the messages are to be delivered initially, before Notes Mail Router sends them downstream to Notes users. Messages heading in the opposite direction are routed to downstream Exchange users by the regular Exchange MTA.</p>
<p>
A slightly more complex connection scenario is that of the downstream sites/domains. In this scenario, you have more than one Notes domain and more than one Exchange site. For example, you may have a couple of Notes sites connected by the Notes Mail Router and a couple of Exchange Sites connected by the Exchange Site Connector. As in the departmental scenario, a Notes/Exchange connection is required in only one place. For this, you select a Notes server in one domain and an Exchange server in one site and install the Connector as in the departmental scenario. </p>
<p>
There ends, however, the similarity between the downstream sites/domains connection scenario and the departmental connection scenario. The main difference is that the downstream sites/domains scenario is more complex, because messages must be delivered not only to downstream servers but also to downstream sites or domains. For this reason, you may need to do some extra configuration on the Connector. </p>
<p>
First, you must identify to the Connector any downstream Notes domains, so that it knows how to route messages to those domains. Second, you must install the Notes e-mail-address generator on one server in the downstream Exchange site. This enables Exchange users in that site to have Notes e-mail addresses generated for them to ensure that messages can be routed back to them. You need not install the full Connector in the selected Exchange-site server, only the e-mail-address generator.</p>
<p>
The third Connector implementation is the shared Internet-access connection scenario. In this scenario, you can leverage the services of the Internet Mail Server that comes with Exchange and enable Notes and Exchange users alike to exploit the facilities of the Connector. The shared Internet-access connection employs both the Notes Connector and the Internet Mail Server in the Exchange environment, thereby enabling Notes users to route mail to the Internet by way of an Exchange server. </p>
<p>
There are two reasons for doing this. First, having only a single point of connection to the Internet means only a single connection to manage, a single firewall for better security, and less overall administrative effort. Second, by having only one connection, you can represent your entire organization to the Internet with a single flat Internet Domain Name.</p>
<p>
As for addressing under the shared Internet-access connection scenario, users need only enter the Internet address on the to: line of the Notes message. Then, as the message is routed through the Connector, it decodes the address and forwards the message to the Internet Mail Server. Typically, in entering an ad hoc address to a destination typically reached by the Connector, users append an @ sign and the Notes domain name that is used to represent the Connector. For Exchange, they append @Exchange to the end of the address, and for an SMTP address, they also append @Exchange to the end of the address, and the message gets routed directly though the Connector to the Internet Mail Server. Users also can add a correspondent’s name from either a public or private address book, again with the additional domain name at the end, and it will get routed properly. As long as you append the Domain that represents the Connector, the Notes Mail Writer will deliver that to the Connector and will take care of forwarding it to the Internet Mail Server.</p>
<p>
The remaining Connector implementation is the message-switch connection scenario. This scenario builds on the two-connections approach taken in the shared Internet-access connection scenario: Notes to Exchange and Exchange to the Internet. In this scenario there is a third connection: to an IBM mainframe (over an SNA network) using the OfficeVision/VM messaging system Connector on an Exchange server. This enables Exchange to function as a full-fledged message switch.</p>
<p>
Whatever implementation scenario you select, the Connector enables users in various domains and on various platforms to communicate with one other. This makes the Connector for Lotus Notes a powerful single-vendor solution for connecting users throughout the enterprise.</p>
<h2>Performance Concerns</h2>
<p>
The Connector performance between Exchange 5.0 and Exchange 5.5 environments shows significant improvement, based largely on the capability of the Exchange information store to get messages in more quickly. In the Microsoft lab, the Connector has achieved throughput benchmarks of 14,000 messages per hour. Any such throughput, of course, depends partly on the communications hardware available and partly on the server hardware—and more, then, on the Exchange server hardware than on the Notes server hardware. Whatever the hardware, however, you can help maintain throughput by periodically compacting Notes messages in your Exchange Mail.Box.</p>
<p>
Load balancing is another way to maintain peak performance levels if your message traffic through the Connector is high. You can implement load balancing by installing multiple Connectors in the same sites. You also can use the Exchange route-costing facilities to determine which messages will go through which Connectors. Note also that load balancing operates in one direction only: from Exchange to Notes. Notes doesn’t have a comparable feature on its site, so you cannot perform load balancing for traffic coming in the opposite direction. </p>
<p>
If you’re using multiple Connectors for load balancing, the Notes server knows the route to fall back on through the Notes user’s sender address, which indicates a path back to the Exchange server. This doesn’t alleviate all manual routing tasks, but it does simplify them. You also can configure multiple Connectors, one for inbound and one for outbound, for load-balancing purposes. If you do this, however, replies will typically return over the same Connector that they came from in either direction. One alternative is to have one Connector specifically going outbound for original messages in either direction.</p>
<p>
As for potential backups or logjams in an MTA environment, the Connector handles them as follows: As soon as you introduce any kind of content conversion to the mix, you immediately get a performance stepdown. This is why talking about the load that can be generated by the IMS, for example, is important. You cannot have multiple Notes Connectors servicing that kind of backlog.&nbsp; </p>
<p>
Yet another way to maintain performance is to piggyback several disconnected Notes domains through an Exchange backbone. This approach ensures that you won’t have Notes users in Los Angeles communicating directly to Notes users in New York. Instead, you can have Connectors at either end of an Exchange backbone and leverage the investment in the Exchange messaging infrastructure for connecting Notes users—even to each other.</p>
<h2>Future Plans and Companion Products </h2>
<p>
Localization will come in the next release, anticipated next year. With it, the Connector will support German, French, and Japanese. In addition, fidelity improvements will bolster the Connector’s support for Notes Tables, Bulleted Lists, Numbered Lists, and so on. Moreover, a per-recipient DocLink option will enable you to customize DocLink delivery for each user in a diverse community characterized by vastly different setups.</p>
<p>
For database replication between Notes .nsffiles and Exchange public folders, a company known as Mesa Software offers a product called JumpStart. JumpStart also provides some migration capability for data and forms in application folders.</p>
<p>
For a large replication engine, you can look to Replic-Action for Exchange, a product from a company called Casahl. With this product, you can communicate among Exchange, Notes, and databases running on Sybase, DB2, Microsoft SQL Server, and up to 35 other DBMSs. Replic-Action for Exchange acts as a data switch for moving data back and forth between different databases.</p>
<h2>Conclusion</h2>
<p>
Currently, the Connector for Lotus Notes provides a high-fidelity messaging and directory-synchronization solution. In the Microsoft lab, for example, testers have used the Connector to move 82,000 entries with no significant strain on the server hardware. This connector allows&nbsp; you to implement a strategic messaging system based on Exchange while retaining Notes applications that are already deployed; by doing this, you preserve an existing Notes investment and can take more time for planning eventual migration of these applications to Exchange.</p>
<h3>For More Information</h3>
<p>
For the latest information on Microsoft Exchange, check out our World Wide Web site at <a href="http://www.microsoft.com/exchange/default.asp">http://www.microsoft.com/exchange/default.asp</a>.</p>
<p>
<i>The information contained in this document represents the current view of Microsoft Corporation on the issues discussed as of the date of publication. Because Microsoft must respond to changing market conditions, it should not be interpreted to be a commitment on the part of Microsoft, and Microsoft cannot guarantee the accuracy of any information presented after the date of publication.</i></p>
<p>
<i>This White Paper is for informational purposes only. MICROSOFT MAKES NO WARRANTIES, EXPRESS OR IMPLIED, IN THIS DOCUMENT.</i></p>
</BODY>
</HTML>
