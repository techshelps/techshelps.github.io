<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Add Method (CDONTS Attachments Collection)</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_denali_add_method_cdonts_attachments_collection_"></a>Add Method (CDONTS Attachments Collection)  <a href="amsmtp_18db.htm"><img src="../../../../../images/group.gif" border=0></a></h3>
<p>
The <b>Add</b> method creates and returns a new <a href="amsmtp_8hpb.htm">Attachment</a> object in the Attachments collection. </p>
<h4>Syntax </h4>
<pre><code><b>Set</b><i> objAttach = collAttachments</i>.<b>Add( [</b><i>name</i><b>] [</b><i>, type</i><b>] [</b><i>, source</i><b>] [</b><i>, ContentLocation</i><b>] [</b><i>, ContentBase</i><b>] ) </b>
 </code></pre>
<dl>
<dt>
<i>objAttach </i></dt>
<dd>
On successful return, contains the new Attachment object. </dd>
<dt>
<i>collAttachments </i></dt>
<dd>
Required. The Attachments collection object. </dd>
<dt>
<i>name </i></dt>
<dd>
Optional. String. The display name of the attachment. The default value is an empty string. To allow a user to click on the attachment that appears in the message and activate an associated application, supply the full file name, including the file extension. </dd>
<dt>
<i>type </i></dt>
<dd>
Optional. Long. The type of attachment; either <b>CdoFileData</b> or <b>CdoEmbeddedMessage</b>. The default value is <b>CdoFileData</b>. </dd>
<dt>
<i>source </i></dt>
<dd>
Optional. String or Object. The path and file name of the file containing the data for the attachment, or the Message object to be embedded. The path and file name must be in the appropriate format for the attachment type, specified by the <i>type</i> parameter. The default value is an empty string. </dd>
<dt>
<i>ContentLocation </i></dt>
<dd>
Optional. String. The content location header for the appropriate body part of a MIME message attachment. </dd>
<dt>
<i>ContentBase </i></dt>
<dd>
Optional. String. The content base header for the appropriate body part of a MIME message attachment. 
</dd>
</dl>
<h4>Remarks </h4>
<p>
The <i>name</i>, <i>type</i>, <i>source</i>, <i>ContentLocation</i>, and <i>ContentBase</i> parameters correspond to the <a href="amsmtp_4sbj.htm"><b>Name</b></a>, <a href="amsmtp_73a7.htm"><b>Type</b></a>, <a href="amsmtp_3ba7.htm"><b>Source</b></a>, <a href="amsmtp_56u7.htm"><b>ContentLocation</b></a>, and <a href="amsmtp_3fxb.htm"><b>ContentBase</b></a> properties of the <a href="amsmtp_8hpb.htm">Attachment</a> object. The <i>source</i> parameter is also closely related to the <a href="amsmtp_6zj3.htm"><b>ReadFromFile</b></a> method's <i>fileName</i> parameter. </p>
<p>
You can supply the data for the attachment at the same time that you add it to the collection. The <b>Add</b> method operates differently depending on the value of the <i>type</i> parameter. The following table describes its operation. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=37%>Value of <i>type</i> parameter </th>
<th align=left width=63%>Value of <i>source</i> parameter </th>
</tr>
<tr valign=top>
<td width=37%><b>CdoFileData </b></td>
<td width=63%>Specifies a full path and file name that contains the data for the attachment, for example C:\DOCUMENT\BUDGET.XLS. Must be supplied with the <b>Add</b> method. The data is read into the attachment. </td>
</tr>
<tr valign=top>
<td width=37%></td>
<td width=63%></td>
</tr>
<tr valign=top>
<td width=37%></td>
<td width=63%></td>
</tr>
<tr valign=top>
<td width=37%><b>CdoEmbeddedMessage </b></td>
<td width=63%>Specifies the <a href="amsmtp_3odb.htm">Message</a> object to be embedded. The message is copied into the attachment. </td>
</tr>
</table><br>
<p>
If the <i>type</i> parameter is set to <b>CdoEmbeddedMessage</b>, any setting of the <i>name</i> parameter is ignored in the current version of CDO for NTS. If the <a href="amsmtp_4r1b.htm"><b>MessageFormat</b></a> property of the parent <a href="amsmtp_3odb.htm">Message</a> object is set to <b>CdoMime</b>, the embedded message's <a href="amsmtp_1333.htm"><b>Subject</b></a> property is used for the attachment name. If the parent message's <b>MessageFormat</b> is <b>CdoText</b>, CDO for NTS randomly creates an attachment name in the format ATT00099.EML. </p>
<p>
You should set the message's <b>MessageFormat</b> to <b>CdoMime</b> if you are running with the Microsoft® Exchange Server and plan to add attachments of type <b>CdoEmbeddedMessage</b>. This allows the greatest flexibility in opening and reading such an attachment. </p>
<p>
The attachment is saved in persistent storage when you call the <a href="amsmtp_2fhb.htm"><b>Send</b></a> method on the <a href="amsmtp_3odb.htm">Message</a> object containing the Attachments collection. </p>
<p>
The <b>Add</b> method returns <b>CdoE_NO_ACCESS</b> when called on a message in the Inbox. </p>
<p>
The CDO for NTS Library does not permit any modifications to messages in the Inbox, other than deleting the entire message. Prohibited modifications include adding, deleting, or modifying any attachment; adding, deleting, or modifying any recipient; and modifying any message property, even one with read/write access. </p>
<p>&nbsp;</p></body>
</HTML>
