<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NewMail Object (CDONTS Library)</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_denali_newmail_object_cdonts_library_"></a>NewMail Object (CDONTS Library)</h2>
<p>
The NewMail object provides for sending a message with very few lines of code. </p>
<h4>At a Glance </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=48%>Specified in type library: </td>
<td width=52%>CDONTS.DLL </td>
</tr>
<tr valign=top>
<td width=48%>First available in: </td>
<td width=52%>CDO for NTS Library version 1.2 </td>
</tr>
<tr valign=top>
<td width=48%>Parent objects: </td>
<td width=52%>(none) </td>
</tr>
<tr valign=top>
<td width=48%>Child objects: </td>
<td width=52%>(none) </td>
</tr>
<tr valign=top>
<td width=48%>Default property: </td>
<td width=52%><a href="amsmtp_17q7.htm"><b>Value</b></a> </td>
</tr>
</table><br>
<h4>Properties </h4>
<table cellspacing=4 cols=4>
<tr valign=top>
<th align=left width=32%><br>
Name </th>
<th align=left width=18%>Available since version </th>
<th align=left width=32%> <br>
Type </th>
<th align=left width=18%> <br>
Access </th>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_78in.htm"><b>Bcc</b></a> </td>
<td width=18%>1.2 </td>
<td width=32%>String </td>
<td width=18%>Write-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_00gv.htm"><b>Body</b></a> </td>
<td width=18%>1.2 </td>
<td width=32%><b>IStream</b> object or String </td>
<td width=18%>Write-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_52an.htm"><b>BodyFormat</b></a> </td>
<td width=18%>1.2 </td>
<td width=32%>Long </td>
<td width=18%>Write-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_4b8f.htm"><b>Cc</b></a> </td>
<td width=18%>1.2 </td>
<td width=32%>String </td>
<td width=18%>Write-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_8d7j.htm"><b>ContentBase</b></a> </td>
<td width=18%>1.2 </td>
<td width=32%>String </td>
<td width=18%>Write-only </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=18%></td>
<td width=32%></td>
<td width=18%></td>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_55gf.htm"><b>ContentLocation</b></a> </td>
<td width=18%>1.2 </td>
<td width=32%>String </td>
<td width=18%>Write-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_7tnj.htm"><b>From</b></a> </td>
<td width=18%>1.2 </td>
<td width=32%>String </td>
<td width=18%>Write-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_53dr.htm"><b>Importance</b></a> </td>
<td width=18%>1.2 </td>
<td width=32%>Long </td>
<td width=18%>Write-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_9mn3.htm"><b>MailFormat</b></a> </td>
<td width=18%>1.2 </td>
<td width=32%>Long </td>
<td width=18%>Write-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_34db.htm"><b>Subject</b></a> </td>
<td width=18%>1.2 </td>
<td width=32%>String </td>
<td width=18%>Write-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_62fz.htm"><b>To</b></a> </td>
<td width=18%>1.2 </td>
<td width=32%>String </td>
<td width=18%>Write-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_17q7.htm"><b>Value</b></a> </td>
<td width=18%>1.2 </td>
<td width=32%>String </td>
<td width=18%>Write-only </td>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_4fof.htm"><b>Version</b></a> </td>
<td width=18%>1.2 </td>
<td width=32%>String </td>
<td width=18%>Read-only </td>
</tr>
</table><br>
<h4>Methods </h4>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=32%><br>
Name </th>
<th align=left width=18%>Available since version </th>
<th align=left width=50%> <br>
Parameters </th>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_0d3z.htm"><b>AttachFile</b></a> </td>
<td width=18%>1.2 </td>
<td width=50%><i>Source</i> as <b>Object</b> or <b>String</b>, <br>
(optional) <i>FileName</i> as <b>String</b>, <br>
(optional) <i>EncodingMethod</i> as <b>Long</b> </td>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_77j3.htm"><b>AttachURL</b></a> </td>
<td width=18%>1.2 </td>
<td width=50%><i>Source</i> as <b>Object</b> or <b>String</b>, <br>
<i>ContentLocation</i> as <b>String</b>, <br>
(optional) <i>ContentBase</i> as <b>String</b>, <br>
(optional) <i>EncodingMethod</i> as <b>Long</b> </td>
</tr>
<tr valign=top>
<td width=32%></td>
<td width=18%></td>
<td width=50%></td>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_4grj.htm"><b>Send</b></a> </td>
<td width=18%>1.2 </td>
<td width=50%>(optional) <i>From</i> as <b>String</b>, <br>
(optional) <i>To</i> as <b>String</b>, <br>
(optional) <i>Subject</i> as <b>String</b>, <br>
(optional) <i>Body</i> as <b>Object</b> or <b>String</b>, <br>
(optional) <i>Importance</i> as <b>Long</b> </td>
</tr>
<tr valign=top>
<td width=32%><a href="amsmtp_2jmn.htm"><b>SetLocaleIDs</b></a> </td>
<td width=18%>1.2 </td>
<td width=50%><i>CodePageID</i> as <b>Long</b> </td>
</tr>
</table><br>
<h4>Remarks </h4>
<p>
The NewMail object is not built on the normal API architecture. It is meant for rapid generation of notification mail by an automated process running in the Microsoft® Windows NT® Server. No user interface is supplied, and no interaction with human users is expected during the generation and sending of the message. Therefore the NewMail object's properties are not designed to be read back and inspected. With the sole exception of <a href="amsmtp_4fof.htm"><b>Version</b></a>, they can only be written. </p>
<p>
The NewMail object is self-contained and does not expose any of the <a href="amsmtp_9tdf.htm">Properties Common to All CDO for NTS Library Objects</a>. </p>
<p>
Attachments and recipients, once added to the NewMail object, cannot be removed, and the NewMail object itself cannot be deleted. When the <a href="amsmtp_4grj.htm"><b>Send</b></a> method completes successfully, the NewMail object is invalidated but not removed from memory. The programmer should <b>Set</b> the invalid object to <b>Nothing</b> to remove it from memory, or reassign it to another NewMail object. Attempted access to a sent NewMail object results in a return of <b>CdoE_INVALID_OBJECT</b>. </p>
<p>
The NewMail object does not belong to the hierarchy encompassing the other CDO for NTS Library objects. It cannot access, nor can it be accessed from, any of the other objects. Like the <a href="amsmtp_3qcf.htm">Session</a> object, it is considered a top-level object and is created directly from a Microsoft® Visual Basic® program. Its ProgID is CDONTS.NewMail. This code fragment creates a NewMail object through early binding: </p>
<pre><code>Dim objNewMail As CDONTS.NewMail 
  Set objNewMail = CreateObject("CDONTS.NewMail") 
 </code></pre>
<p>
The main advantage of the NewMail object is the ease and simplicity with which you can generate and send a message. You do not have to log on to a session nor deal with a folder or a messages collection. You have only to create the NewMail object, send it, and <b>Set</b> it to <b>Nothing</b>. You can supply critical information in the parameters of the <a href="amsmtp_4grj.htm"><b>Send</b></a> method. In many cases you only need three lines of code: </p>
<pre><code>Set objNewMail = CreateObject("CDONTS.NewMail") 
  objNewMail.Send("me@company.com", "you@company.com", "Hello", _ 
                  "I sent this in 3 statements!", 0) ' low importance 
  Set objNewMail = Nothing ' canNOT reuse it for another message 
 </code></pre>
<p>
Including an attachment can add as little as one statement to your code, because you can pass information in the parameters of the <a href="amsmtp_0d3z.htm"><b>AttachFile</b></a> method: </p>
<pre><code>Set objNewMail = CreateObject("CDONTS.NewMail") 
  objNewMail.AttachFile("\\server\schedule\sched.xls", "SCHED.XLS") 
  objNewMail.Send("Automated Schedule Generator", "you@company.com", _ 
                  "Schedule", "Here's the latest master schedule", 0) 
  Set objNewMail = Nothing 
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
