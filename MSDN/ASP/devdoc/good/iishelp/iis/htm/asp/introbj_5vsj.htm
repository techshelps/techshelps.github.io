<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ServerVariables</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_servervariables"></a>ServerVariables</h1>
<p>
The <b>ServerVariables </b>collection retrieves the values of predetermined environment variables.</p>
<h4>Syntax</h4>
<pre><code><b>Request.ServerVariables (</b><i>server environment</i> <i>variable</i><b>) </b>
<b> </b></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>server environment variable</i> </dt>
<dd>
Specifies the name of the server environment variable to retrieve. It can be one of the following values.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=47%>Variable</th>
<th align=left width=53%>Description</th>
</tr>
<tr valign=top>
<td width=47%>ALL_HTTP</td>
<td width=53%>All HTTP headers sent by the client.</td>
</tr>
<tr valign=top>
<td width=47%>ALL_RAW</td>
<td width=53%>Retrieves all headers in the raw-form. The difference between ALL_RAW and ALL_HTTP is that ALL_HTTP places an HTTP_ prefix before the header name and the header-name is always capitalized. In ALL_RAW the header name and values appear as they are sent by the client. </td>
</tr>
<tr valign=top>
<td width=47%>APPL_MD_PATH</td>
<td width=53%>Retrieves the metabase path for the (WAM) Application for the ISAPI DLL.</td>
</tr>
<tr valign=top>
<td width=47%>APPL_PHYSICAL_PATH</td>
<td width=53%>Retrieves the physical path corresponding to the metabase path. IIS converts the APPL_MD_PATH to the physical (directory) path to return this value.</td>
</tr>
<tr valign=top>
<td width=47%>AUTH_PASSWORD</td>
<td width=53%>The value entered in the client's authentication dialog. This variable is only available if Basic authentication is used. </td>
</tr>
<tr valign=top>
<td width=47%>AUTH_TYPE</td>
<td width=53%>The authentication method that the server uses to validate users when they attempt to access a protected script.</td>
</tr>
<tr valign=top>
<td width=47%>AUTH_USER</td>
<td width=53%>Raw authenticated user name. </td>
</tr>
<tr valign=top>
<td width=47%>CERT_COOKIE</td>
<td width=53%>Unique ID for client certificate, Returned as a string. Can be used as a signature for the whole client certificate.</td>
</tr>
<tr valign=top>
<td width=47%>CERT_FLAGS</td>
<td width=53%>bit0 is set to 1 if the client certificate is present.<p>
bit1 is set to 1 if the Certifying Authority of the client certificate is invalid (not in the list of recognized CA on the server).</p>
</td>
</tr>
<tr valign=top>
<td width=47%>CERT_ISSUER</td>
<td width=53%>Issuer field of the client certificate (O=MS, OU=IAS, CN=user name, C=USA).</td>
</tr>
<tr valign=top>
<td width=47%>CERT_KEYSIZE</td>
<td width=53%>Number of bits in Secure Sockets Layer connection key size. For example, 128.</td>
</tr>
<tr valign=top>
<td width=47%>CERT_SECRETKEYSIZE</td>
<td width=53%>Number of bits in server certificate private key. For example, e.g. 1024.</td>
</tr>
<tr valign=top>
<td width=47%>CERT_SERIALNUMBER</td>
<td width=53%>Serial number field of the client certificate.</td>
</tr>
<tr valign=top>
<td width=47%>CERT_SERVER_ISSUER</td>
<td width=53%>Issuer field of the server certificate.</td>
</tr>
<tr valign=top>
<td width=47%>CERT_SERVER_SUBJECT</td>
<td width=53%>Subject field of the server certificate.</td>
</tr>
<tr valign=top>
<td width=47%>CERT_SUBJECT</td>
<td width=53%>Subject field of the client certificate.</td>
</tr>
<tr valign=top>
<td width=47%>CONTENT_LENGTH</td>
<td width=53%>The length of the content as given by the client. </td>
</tr>
<tr valign=top>
<td width=47%>CONTENT_TYPE</td>
<td width=53%>The data type of the content. Used with queries that have attached information, such as the HTTP queries GET, POST,<b> </b>and PUT.</td>
</tr>
<tr valign=top>
<td width=47%>GATEWAY_INTERFACE</td>
<td width=53%>The revision of the CGI specification used by the server. The format is CGI/revision. </td>
</tr>
<tr valign=top>
<td width=47%>HTTP_&lt;<i>HeaderName</i>&gt;</td>
<td width=53%>The value stored in the header <i>HeaderName</i>. Any header other than those listed in this table must be prefixed by HTTP_ in order for the <b>ServerVariables</b> collection to retrieve its value.<p>
<b>Note</b>&nbsp;&nbsp;The server interprets any underscore (_) characters in <i>HeaderName</i> as dashes in the actual header. For example if you specify HTTP_MY_HEADER, the server searches for a header sent as MY-HEADER. </p>
</td>
</tr>
<tr valign=top>
<td width=47%>HTTPS</td>
<td width=53%>Returns ON if the request came in through secure channel (SSL) or it returns OFF if the request is for a non-secure channel.</td>
</tr>
<tr valign=top>
<td width=47%>HTTPS_KEYSIZE</td>
<td width=53%>Number of bits in Secure Sockets Layer connection key size. For example, 128.</td>
</tr>
<tr valign=top>
<td width=47%>HTTPS_SECRETKEYSIZE</td>
<td width=53%>Number of bits in server certificate private key. For example, 1024.</td>
</tr>
<tr valign=top>
<td width=47%>HTTPS_SERVER_ISSUER</td>
<td width=53%>Issuer field of the server certificate.</td>
</tr>
<tr valign=top>
<td width=47%>HTTPS_SERVER_SUBJECT</td>
<td width=53%>Subject field of the server certificate.</td>
</tr>
<tr valign=top>
<td width=47%>INSTANCE_ID</td>
<td width=53%>The ID for the IIS instance in textual format. If the instance ID is 1, it appears as a string. You can use this variable to retrieve the ID of the Web-server instance (in the metabase) to which the request belongs.</td>
</tr>
<tr valign=top>
<td width=47%>INSTANCE_META_PATH</td>
<td width=53%>The metabase path for the instance of IIS that responds to the request.</td>
</tr>
<tr valign=top>
<td width=47%>LOCAL_ADDR</td>
<td width=53%>Returns the Server Address on which the request came in. This is important on multi-homed machines where there can be multiple IP addresses bound to a machine and you want to find out which address the request used.</td>
</tr>
<tr valign=top>
<td width=47%>LOGON_USER</td>
<td width=53%>The Windows NT® account that the user is logged into.</td>
</tr>
<tr valign=top>
<td width=47%>PATH_INFO</td>
<td width=53%>Extra path information as given by the client. You can access scripts by using their virtual path and the PATH_INFO server variable. If this information comes from a URL, it is decoded by the server before it is passed to the CGI script.</td>
</tr>
<tr valign=top>
<td width=47%>PATH_TRANSLATED</td>
<td width=53%>A translated version of PATH_INFO that takes the path and performs any necessary virtual-to-physical mapping.</td>
</tr>
<tr valign=top>
<td width=47%>QUERY_STRING</td>
<td width=53%>Query information stored in the string following the question mark (?) in the HTTP request. </td>
</tr>
<tr valign=top>
<td width=47%>REMOTE_ADDR</td>
<td width=53%>The IP address of the remote host making the request. </td>
</tr>
<tr valign=top>
<td width=47%>REMOTE_HOST</td>
<td width=53%>The name of the host making the request. If the server does not have this information, it will set REMOTE_ADDR and leave this empty.</td>
</tr>
<tr valign=top>
<td width=47%>REMOTE_USER</td>
<td width=53%>Unmapped user-name string sent in by the User. This is the name that is really sent by the user as opposed to the ones that are modified by any authentication filter installed on the server.</td>
</tr>
<tr valign=top>
<td width=47%>REQUEST_METHOD</td>
<td width=53%>The method used to make the request. For HTTP, this is GET, HEAD, POST, and so on.</td>
</tr>
<tr valign=top>
<td width=47%>SCRIPT_NAME</td>
<td width=53%>A virtual path to the script being executed. This is used for self-referencing URLs.</td>
</tr>
<tr valign=top>
<td width=47%>SERVER_NAME</td>
<td width=53%>The server's host name, DNS alias, or IP address as it would appear in self-referencing URLs.</td>
</tr>
<tr valign=top>
<td width=47%>SERVER_PORT</td>
<td width=53%>The port number to which the request was sent.</td>
</tr>
<tr valign=top>
<td width=47%>SERVER_PORT_SECURE</td>
<td width=53%>A string that contains either 0 or 1. If the request is being handled on the secure port, then this will be 1. Otherwise, it will be 0.</td>
</tr>
<tr valign=top>
<td width=47%>SERVER_PROTOCOL</td>
<td width=53%>The name and revision of the request information protocol. The format is <i>protocol</i>/<i>revision</i>.</td>
</tr>
<tr valign=top>
<td width=47%>SERVER_SOFTWARE</td>
<td width=53%>The name and version of the server software that answers the request and runs the gateway. The format is <i>name</i>/<i>version</i>.</td>
</tr>
<tr valign=top>
<td width=47%>URL </td>
<td width=53%>Gives the base portion of the URL.</td>
</tr>
</table><br>

</dd>
</dl>
<h4>Remarks</h4>
<p>
If a client sends a header other than those specified in the preceding table, you can retrieve the value of that header by prefixing the header name with HTTP_ in the call to <b>Request.ServerVariables</b>. For example, if the client sent this header</p>
<pre><code>SomeNewHeader:SomeNewValue
 </code></pre>
<p>
you could retrieve <code>SomeNewValue</code> by using the following syntax</p>
<pre><code>&lt;% Request.ServerVariables("HTTP_SomeNewHeader") %&gt;
 </code></pre>
<p>
You can use an iterator to loop through each server variable name. For example, the following script prints out all of the server variables in a table.</p>
<pre><code>&lt;TABLE&gt;
&lt;TR&gt;&lt;TD&gt;&lt;B&gt;Server Variable&lt;/B&gt;&lt;/TD&gt;&lt;TD&gt;&lt;B&gt;Value&lt;/B&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;% For Each name In Request.ServerVariables %&gt; 
&lt;TR&gt;&lt;TD&gt; &lt;%= name %&gt; &lt;/TD&gt;&lt;TD&gt;  &lt;%= Request.ServerVariables(name) %&gt; &lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;% Next %&gt; 
 </code></pre>
<h4>Example</h4>
<p>
The following example uses the <b>Request</b> object to display several server variables.</p>
<pre><code>&lt;HTML&gt;
&lt;!-- This example displays the content of several ServerVariables. --&gt; 
ALL_HTTP server variable = 
&lt;%= Request.ServerVariables("ALL_HTTP") %&gt; &lt;BR&gt;
CONTENT_LENGTH server variable = 
&lt;%= Request.ServerVariables("CONTENT_LENGTH") %&gt; &lt;BR&gt; 
CONTENT_TYPE server variable = 
&lt;%= Request.ServerVariables("CONTENT_TYPE") %&gt; &lt;BR&gt;
QUERY_STRING server variable = 
&lt;%= Request.ServerVariables("QUERY_STRING") %&gt; &lt;BR&gt; 
SERVER_SOFTWARE server variable = 
&lt;%= Request.ServerVariables("SERVER_SOFTWARE") %&gt; &lt;BR&gt; 
&lt;/HTML&gt;
 </code></pre>
<p>
The next example uses the <b>ServerVariables </b>collection to insert the name of the server into a hyperlink. </p>
<pre><code>&lt;A HREF = "http://&lt;%= Request.ServerVariables("SERVER_NAME") %&gt;
/scripts/MyPage.asp"&gt;Link to MyPage.asp&lt;/A&gt;
 </code></pre>
<h4>Applies To</h4>
<p>
<a href="introbj_5ulw.htm"><b>Request Object</b></a> </p>
<h4>See Also</h4>
<p>
<a href="introbj_8q5h.htm"><b>ClientCertificate</b></a>, <a href="introbj_0z3o.htm"><b>Cookies</b></a>, <a href="introbj_4fl9.htm"><b>Form</b></a>, <a href="introbj_53hj.htm"><b>QueryString</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
