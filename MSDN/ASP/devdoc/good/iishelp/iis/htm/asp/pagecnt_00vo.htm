<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Page Counter Component</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_page_counter_component"></a>Page Counter Component</h1>
<p>
The Page Counter component creates a <b>PageCounter</b> object that counts and displays the number of times a Web page has been opened. At regular intervals the object writes the number of hits to a text file so that in the event of a server shutdown, the data is not lost. The Page Counter component uses an internal <b>Central Management </b>object to record how many times each page in the application has been opened. </p>
<p>
When an instance of the <b>PageCounter</b> object is created on a page by using the <b>Server.CreateObject</b> method, the object retrieves the current hit count for the specified Web page from the <b>Central Management</b> object. The object can then be manipulated with the methods it exposes.</p>
<p>
The Page Counter component uses the following files:</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=38%>File Names</th>
<th align=left colspan=2 width=62%></th>
</tr>
<tr valign=top>
<td colspan=2 width=39%>pagecnt.dll </td>
<td width=61%>The Page Counter<b> </b>component.</td>
</tr>
<tr valign=top>
<td colspan=2 width=39%><a href="pagecnt_7aw5.htm"><b>Hit Count Data file</b></a> &nbsp;</td>
<td width=61%>The text file to which the Page Counter<b> </b>component saves the current hit count.</td>
</tr>
</table><br>
<h4>Syntax</h4>
<pre><code><b>&lt;% Set </b><i>oVar </i><b>= Server.CreateObject("MSWC.PageCounter") %&gt;</b> 
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>oVar</i></dt>
<dd>
Specifies the name of the <b>PageCounter</b> object created by the call to <b>Server.CreateObject</b>. 
</dd>
</dl>
<h4>Registry Entries</h4>
<p>
The Page Counter adds the key MSWC.PageCounter to the registry when the object is compiled or registered. The key is added under HKEY_CLASSES_ROOT and contains the following named values.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=22%>Named Value</th>
<th align=left width=78%>Description</th>
</tr>
<tr valign=top>
<td width=22%>File_Location&nbsp;</td>
<td width=78%>A string that specifies the path and filename of the Hit Count Data file. The default filename is hitcnt.cnt. This file is located in your Windows directory.</td>
</tr>
<tr valign=top>
<td width=22%>Save_Count&nbsp;</td>
<td width=78%>A DWORD that specifies the number of hits before the hit count is saved to the Hit Count Data file. Note that this is the total number of hits, not the number of hits per page. The default value is 25. </td>
</tr>
</table><br>
<h4>Methods</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=40%><a href="pagecnt_559v.htm"><b>Hits</b></a></td>
<td width=60%>Displays the number of times that a specified URL has been opened. </td>
</tr>
<tr valign=top>
<td width=40%><a href="pagecnt_2bhw.htm"><b>PageHit</b></a></td>
<td width=60%>Increments the Hit Count. </td>
</tr>
<tr valign=top>
<td width=40%><a href="pagecnt_2qic.htm"><b>Reset</b></a></td>
<td width=60%>Sets the hit count for a specified page to 0.</td>
</tr>
</table><br>
<h4>Example</h4>
<p>
The following example uses the <b>PageCounter</b> object to track the number of visitors to the page and sends a special message to the millionth visitor.</p>
<pre><code>&lt;% 
Set MyPageCounter = Server.CreateObject("MSWC.PageCounter")
HitMe = MyPageCounter.Hits

If HitMe = 1000000 Then 
%&gt;
  You are the lucky 1,000,000th Customer!!! &lt;BR&gt;
&lt;% Else %&gt;
  Sorry, you are customer #&lt;%= HitMe %&gt; &lt;BR&gt;
&lt;% End If %&gt;
 </code></pre>
<p>
<b>Note</b>&nbsp;&nbsp;This component is not installed with IIS. You can install it from the Microsoft Web site at: <a href="http://www.microsoft.com/iis/"><b>http://www.microsoft.com/iis/</b></a>, or from the CD included with the IIS Resource Kit.</p>
<p>&nbsp;</p></body>
</HTML>
