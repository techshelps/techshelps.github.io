<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AddHeader</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_addheader"></a>AddHeader</h1>
<p>
The <b>AddHeader </b>method adds an HTML header with a specified value. This method always adds a new HTTP header to the response. It will not replace an existing header of the same name. Once a header has been added, it cannot be removed.</p>
<p>
This method is for advanced use only. If another <b>Response </b>method will provide the functionality you require, it is recommended that you use that method instead.</p>
<h4>Syntax</h4>
<pre><code><b>Response.AddHeader</b> <i>name</i><b>,</b> <i>value</i>
<i> </i></code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>name</i></dt>
<dd>
The name of the new header variable.</dd>
<dt>
<i>value</i></dt>
<dd>
The initial value stored in the new header variable.
</dd>
</dl>
<h4>Remarks</h4>
<p>
To avoid name ambiguity, <i>name</i> should not contain any underscore (_) characters. The <b>ServerVariables</b> collection interprets underscores as dashes in the header name. For example, the following script causes the server to search for a header named MY-HEADER.</p>
<p>
<code>&lt;% Request.ServerVariables("HTTP_MY_HEADER") %&gt;</code></p>
<p>
Because HTTP protocol requires that all headers be sent before content, you must call <b>AddHeader </b>in your script before any output (such as that generated by HTML code or the <a href="introbj_2w2t.htm"><b>Write</b></a> method) is sent to the client. The exception to this rule is when the <a href="introbj_1fsi.htm"><b>Buffer</b></a><b> </b>property is set to TRUE. If the output is buffered, you can call the <b>AddHeader </b>method at any point in the script, as long as it precedes any calls to <a href="introbj_74tk.htm"><b>Flush</b></a>. Otherwise, the call to <b>AddHeader </b>will generate a run-time error.</p>
<p>
The following two .asp files illustrate this point.</p>
<pre><code>-------file1.asp---------
&lt;% Response.AddHeader "WARNING", "Error Message Text" %&gt; 
&lt;HTML&gt;
Some text on the Web page.
&lt;/HTML&gt;
 </code></pre>
<p>
In the preceding example, the page is not buffered. The script works, however, because the <b>AddHeader </b>method is called before the server sends the output</p>
<pre><code>Some text on the Web page
 </code></pre>
<p>
to the client. If the order were reversed, the call to the <b>AddHeader </b>method would generate a run-time error.</p>
<pre><code>------file2.asp----------
&lt;% Response.Buffer = TRUE %&gt; 
&lt;HTML&gt;
Here's some text on your Web page.
&lt;% Response.AddHeader "WARNING", "Error Message Text" %&gt; Here's some more interesting and illuminating text.
&lt;% Response.Flush %&gt; 
&lt;%= Response.Write("some string") %&gt; 
&lt;/HTML&gt;
 </code></pre>
<p>
In the preceding example, the page is buffered, and as a result, the server will not send output to the client until all the ASP scripts on the page have been processed or until the <a href="introbj_74tk.htm"><b>Flush</b></a><b> </b>method is called. With buffered output, calls to <b>AddHeader </b>can appear anywhere the script, so long as they precede any calls to <b>Flush</b>. If the call to <b>AddHeader</b> appeared below the call to <b>Flush </b>in the preceding example, the script would generate a run-time error. </p>
<p>
You can use this method to send multiple copies of the same header with different values, as with WWW-Authenticate headers. </p>
<h4>Example</h4>
<p>
The following example uses the <b>AddHeader </b>method to request that the client use BASIC authentication.</p>
<pre><code>&lt;% Response.Addheader "WWW-Authenticate", "BASIC" %&gt;
 </code></pre>
<p>
<b>Note</b>&nbsp;&nbsp;The preceding script merely informs the client browser which authentication to use. If you use this script in your Web applications, you should ensure that the Web server has BASIC authentication enabled.</p>
<h4>Applies To</h4>
<p>
<a href="introbj_5sj8.htm"><b>Response Object</b></a> </p>
<h4>See Also</h4>
<p>
<a href="introbj_74tk.htm"><b>Flush</b></a>, <a href="introbj_2w2t.htm"><b>Write</b></a>, <a href="introbj_1fsi.htm"><b>Buffer</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
