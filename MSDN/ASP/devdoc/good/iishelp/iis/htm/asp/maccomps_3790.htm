<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Counters Component</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_counters_component"></a>Counters Component</h1>
<p>
The Counter component creates a <b>Counters </b>object that can create, store, increment, and retrieve any number of individual counters. </p>
<p>
A counter is a persistent value that contains an integer. You can manipulate a counter with the <b>Get</b>, <b>Increment</b>, <b>Set</b>, and <b>Remove </b>methods of the <b>Counters </b>object. Once you create the counter, it persists until you remove it.</p>
<p>
Counters do not automatically increment on an event like a page hit. You must manually set or increment counters using the <a href="maccomps_40c4.htm"><b>Set</b></a> and <a href="maccomps_64xg.htm"><b>Increment</b></a> methods.</p>
<p>
Counters are not limited in scope. Once you create a counter, any page on your site can retrieve or manipulate its value. For example, if you increment and display a counter named <i>hits</i> in a page called Page1.asp, and you increment <i>hits</i> in another page called Page2.asp, both pages will increment the same counter. If you hit Page1.asp, and increment <i>hits</i> to 34, hitting Page2.asp will increment <i>hits</i> to 35. The next time you hit Page1.asp, <i>hits</i> will increment to 36.</p>
<p>
All counters are stored in a single text file, counters.txt, which is located in the same directory as the counters<i>.</i>dll file. </p>
<h4>File Names</h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=22%>counters.dll</td>
<td width=78%>The Counters component.</td>
</tr>
<tr valign=top>
<td width=22%>counters.txt</td>
<td width=78%>The file that stores all individual counters on a site. counters.txt is a UTF8-encoded file. You can have any Unicode characters in a counter name. </td>
</tr>
</table><br>
<h4>Syntax</h4>
<p>
Create the <b>Counters</b> object one time on your server by adding the following to the global.asa file:</p>
<pre><b><code>&lt;OBJECT 
RUNAT=Server 
SCOPE=Application 
ID=Counter 
PROGID="MSWC.Counters"&gt; 
&lt;/OBJECT&gt;</code></b></pre>
<h4>Registry Entries</h4>
<p>
None.</p>
<h4>Remarks</h4>
<p>
Only create one <b>Counters </b>object in your site. This single <b>Counters </b>object can create any number of individual counters. </p>
<p>
<b>Note</b>&nbsp;&nbsp;For Personal Web Server on Windows® 95, a Counters component has already been specified in the global.asa file in the default virtual directory. You can work with the <b>Counters </b>object the component creates as if it were a built-in object by calling <b>Counters.Get</b>, <b>Counters.Increment</b>, <b>Counters.Remove</b>, and <b>Counters.Set</b> . You should not create another instance of the <b>Counters </b>object. </p>
<h4>Methods </h4>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=22%><a href="maccomps_2yes.htm"><b>Get</b></a> </td>
<td width=78%>Returns the value of the counter. </td>
</tr>
<tr valign=top>
<td width=22%><a href="maccomps_64xg.htm"><b>Increment</b></a>  </td>
<td width=78%>Increases the counter by 1.</td>
</tr>
<tr valign=top>
<td width=22%><a href="maccomps_2aqt.htm"><b>Remove</b></a>  </td>
<td width=78%>Removes the counter from the counters.txt file. </td>
</tr>
<tr valign=top>
<td width=22%><a href="maccomps_40c4.htm"><b>Set</b></a> </td>
<td width=78%>Sets the value of the counter to a specific integer. </td>
</tr>
</table><br>
<h4>Example</h4>
<p>
Create an instance of the <b>Counters </b>object in the global.asa file with the ID attribute set to <code>Counter</code>: </p>
<pre><code>&lt;OBJECT RUNAT=Server SCOPE=Application ID=Counter PROGID="MSWC.Counters"&gt; &lt;/OBJECT&gt;
 </code></pre>
<p>
You can then use that <b>Counters </b>object on one page to create all the counters you need:</p>
<pre><code>There have been &lt;%= Counter.Increment('defaultPageHits') %&gt; to this site.
 </code></pre>
<p>
Then on another page you can increment the counter in the following manner:</p>
<pre><code>You are visitor number&lt;%= Counter.Increment('LinksPageHits') %&gt; to this page.
 </code></pre>
<p>
<b>Note</b>&nbsp;&nbsp;You can obtain this component from the CD included with the IIS Resource Kit.</p>
<p>&nbsp;</p></body>
</HTML>
