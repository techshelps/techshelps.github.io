<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3.4.3 Optional Header Data Directories (Image Only)</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>


<FONT FACE="verdana, Arial, Helvetica" SIZE="2">

<h1><a name="3.4.3optionalheaderdatadirectories(imageonly)"></a>3.4.3 Optional Header Data Directories (Image Only)</h1>
<p>
Each data directory gives the address and size of a table or string used by Windows NT. These are all loaded into memory so that they can be used by the system at run time. A data directory is an eight-byte field that has the following declaration:</p>
<pre><code>typedef struct _IMAGE_DATA_DIRECTORY {
    DWORD   RVA;
    DWORD   Size;
} IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;</code></pre>
<p>
The first field, RVA, is the relative virtual address of the table. The RVA is the address of the table, when loaded, relative to the base address of the image. The second field gives the size in bytes. The data directories, which form the last part of the Optional Header, are listed below.</p>
<p>
<i>Note that</i> <i>the number of directories is not fixed.</i>  The NumberOfRvaAndSizes field in the optional header should be checked before looking for a specific directory.</p>
<p>
Do not assume that the RVAs given in this table point to the beginning of a section or that the sections containing specific tables have specific names.</p>
<table border=1 cols=4 frame=box rules=all>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Offset</b></td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Size</b></td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Field</b></td>
<TD width=238pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Description</b></td>
</tr>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">96</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Export Table</td>
<TD width=238pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Export Table address and size.</td>
</tr>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">104</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Import Table</td>
<TD width=238pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Import Table address and size</td>
</tr>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">112</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Resource Table</td>
<TD width=238pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Resource Table address and size.</td>
</tr>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">120</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Exception Table</td>
<TD width=238pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Exception Table address and size.</td>
</tr>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">128</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Certificate Table</td>
<TD width=238pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Attribute Certificate Table address and size.</td>
</tr>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">136</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Base Relocation Table</td>
<TD width=238pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Base Relocation Table address and size.</td>
</tr>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">144</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Debug</td>
<TD width=238pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Debug data starting address and size.</td>
</tr>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">152</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Architecture</td>
<TD width=238pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Architecture-specific data address and size.</td>
</tr>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">160</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Global Ptr</td>
<TD width=238pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Relative virtual address of the global pointer register. Size member of this structure is set to 0.</td>
</tr>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">168</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">TLS Table</td>
<TD width=238pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Thread Local Storage (TLS) Table address and size.</td>
</tr>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">176</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Load Config Table</td>
<TD width=238pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Load Configuration Table address and size.</td>
</tr>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">184</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Bound Import</td>
<TD width=238pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Bound Import Table address and size.</td>
</tr>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">192</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">IAT</td>
<TD width=238pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Import Address Table address and size.</td>
</tr>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">200</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Delay Import Descriptor</td>
<TD width=238pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Address and size of the Delay Import Descriptor.</td>
</tr>
<tr valign=top>
<TD width=38pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">208</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">16</td>
<TD colspan=2 width=355pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Reserved</td>
</tr>
</table><br>

<p>
The Certificate Table entry points to a table of attribute certificates.  These certificates are <b><u>not</u></b> loaded into memory as part of the image.  As such, the first field of this entry, which is normally an RVA, is a File Pointer instead.</p>

</BODY>
</HTML>
