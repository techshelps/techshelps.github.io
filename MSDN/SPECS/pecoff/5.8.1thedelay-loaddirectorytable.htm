<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>5.8.1 The Delay-Load Directory Table</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>


<FONT FACE="verdana, Arial, Helvetica" SIZE="2">

<h1><a name="5.8.1thedelay-loaddirectorytable"></a>5.8.1 The Delay-Load Directory Table</h1>
<p>
The Delay-Load Directory Table is the counterpart to the Import Directory Table, and can be retrieved via the Delay Import Descriptor entry in the Optional Header Data Directories list (offset 200).  The Table is arranged as follows:</p>
<table border=1 cols=4 frame=box rules=all>
<tr valign=top>
<TD width=74pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Offset</b></td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Size</b></td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Field</b></td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Description</b></td>
</tr>
<tr valign=top>
<TD width=74pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">0</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Attributes</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Must be zero.</td>
</tr>
<tr valign=top>
<TD width=74pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Name</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Address of the name of the dll to be loaded. The name resides in the read-only data section of the image.</td>
</tr>
<tr valign=top>
<TD width=74pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Module Handle</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Address of the module handle (in the data section of the image) of the dll to be delay-loaded. Used for storage by the routine supplied to manage delay-loading.</td>
</tr>
<tr valign=top>
<TD width=74pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">12</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Delay Import Address Table</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Address of the delay-load import address table. See below for further details.</td>
</tr>
<tr valign=top>
<TD width=74pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">16</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Delay Import Name Table</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Address of the delay-load name table, which contains the names of the imports that may need to be loaded. Matches the layout of the Import Name Table, Section 6.4.3.6.4.3 Hint/Name Table.</td>
</tr>
<tr valign=top>
<TD width=74pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">20</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Bound Delay Import Table</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Address of the bound delay-load address table, if it exists.</td>
</tr>
<tr valign=top>
<TD width=74pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">24</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Unload Delay Import Table</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Address of the unload delay-load address table, if it exists. This is an exact copy of the Delay Import Address Table. In the event that the caller unloads the dll, this table should be copied back over the Delay IAT such that subsequent calls to the dll continue to use the thunking mechanism correctly.</td>
</tr>
<tr valign=top>
<TD width=74pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">28</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Time Stamp</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Time stamp of dll to which this image has been bound.</td>
</tr>
</table><br>
<p>
The tables referenced in this data structure are organized and sorted just as their counterparts are for traditional imports.  See Section &quot;Section 6.4. The .idata Section&quot; for details. </p>
</BODY>
</HTML>
