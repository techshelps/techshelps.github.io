<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3.4 Optional Header (Usually Image Only)</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>


<FONT FACE="verdana, Arial, Helvetica" SIZE="2">

<h1><a name="3.4optionalheader(usuallyimageonly)"></a>3.4 Optional Header (Usually Image Only)</h1>
<p>
Every image file has an Optional Header that provides information to the loader. This header is also referred to the PE Header. This header is optional in the sense that some files (specifically, object files) do not have it. For image files, this header is required. An object file may have an optional header, but generally this header has no function in an object file except to increase size. </p>
<p>
<i>Note that</i> <i>the size of the optional header is not fixed.</i>  The Optional Header Size in the COFF Header (see Section 3.3. COFF File Header (Object &amp; Image)) must be used in conjunction with the Optional Header's Number of Data Directories field to accuratly calculate the size of the header.  In addition, it is important to validate the optional Header's Magic number for format compatibility.</p>
<p>
The Optional Header itself has three major parts:</p>
<table border=1 cols=4 frame=box rules=all>
<tr valign=top>
<TD width=59pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2"><b>Offset</b></td>
<TD width=51pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2"><b>Size</b></td>
<TD width=150pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2"><b>Header Size</b></td>
<TD width=600pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2"><b>Description</b></td>
</tr>
<tr valign=top>
<TD width=59pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2">0</td>
<TD width=51pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2">28</td>
<TD width=150pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2">Standard fields</td>
<TD width=600pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2">These are defined for all implementations of COFF, including UNIX&reg;.</td>
</tr>
<tr valign=top>
<TD width=59pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2">28</td>
<TD width=51pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2">68</td>
<TD width=150pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2">Windows specific fields</td>
<TD width=600pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2">These include additional fields to support specific features of Windows (for example, subsystem).</td>
</tr>
<tr valign=top>
<TD width=59pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2">96</td>
<TD width=51pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2">128</td>
<TD width=150pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2">Data directories</td>
<TD width=600pt><FONT FACE="Verdanan, Arial, Helvetica" SIZE="2">These fields are address/size pairs for special tables, found in the image file and  used by the operating system (for example, Import Table and Export Table).</td>
</tr>
</table>
</BODY>
</HTML>
