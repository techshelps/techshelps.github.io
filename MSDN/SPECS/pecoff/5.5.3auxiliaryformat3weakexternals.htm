<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>5.5.3 Auxiliary Format 3: Weak Externals</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>


<FONT FACE="verdana, Arial, Helvetica" SIZE="2">

<h1><a name="5.5.3auxiliaryformat3weakexternals"></a>5.5.3 Auxiliary Format 3: Weak Externals</h1>
<p>
&quot;Weak externals&quot; are a mechanism for object files allowing flexibility at link time. A module can contain an unresolved external symbol (sym1), but it can also include an auxiliary record indicating that if sym1 is not present at link time, another external symbol (sym2) is used to resolve references instead.</p>
<p>
If a definition of sym1 is linked, then an external reference to the symbol is resolved normally. If a definition of sym1 is not linked, then all references to the weak external for sym1 refer to sym2 instead. The external symbol, sym2, must always be linked; typically it is defined in the module containing the weak reference to sym1.</p>
<p>
Weak externals are represented by a Symbol Table record with EXTERNAL storage class, UNDEF section number, and a value of 0. The weak-external symbol record is followed by an auxiliary record with the following format:</p>
<table border=1 cols=4 frame=box rules=all>
<tr valign=top>
<TD width=69pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Offset</b></td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Size</b></td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Field</b></td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Description</b></td>
</tr>
<tr valign=top>
<TD width=69pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">0</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">TagIndex</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Symbol-table index of sym2, the symbol to be linked if sym1 is not found.</td>
</tr>
<tr valign=top>
<TD width=69pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=117pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Characteristics </td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">A value of IMAGE_WEAK_EXTERN_SEARCH_NOLIBRARY indicates that no library search for sym1 should be performed.<p>
A value of IMAGE_WEAK_EXTERN_SEARCH_LIBRARY indicates that a library search for sym1 should be performed.</p>
<p>
A value of IMAGE_WEAK_EXTERN_SEARCH_ALIAS indicates that sym1 is an alias for sym2.</p>
</td>
</tr>
<tr valign=top>
<TD width=69pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">8</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">10</td>
<TD colspan=2 width=329pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Unused.</td>
</tr>
</table><br>
<p>
Note that the Characteristics field is not defined in WINNT.H; instead, the Total Size field is used.</p>

</BODY>
</HTML>
