<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3.4.2 Optional Header Windows NT-Specific Fields (Image Only)</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>


<FONT FACE="verdana, Arial, Helvetica" SIZE="2">

<h1><a name="3.4.2optionalheaderwindowsnt-specificfields(imageonly)"></a>3.4.2 Optional Header Windows NT-Specific Fields (Image Only)</h1>
<p>
The next twenty-one fields are an extension to the COFF Optional Header format and contain additional information needed by the linker and loader in Windows NT.</p>
<table border=1 cols=4 frame=box rules=all>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Offset</b></td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Size</b></td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Field</b></td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Description</b></td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">28</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">ImageBase</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Preferred address of first byte of image when loaded into memory; must be a multiple of  64K.  The default for DLLs is 0x10000000.  The default for Windows CE EXEs is 0x00010000.  The default for Windows NT, Windows 95, and Windows 98 is 0x00400000.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">32</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">SectionAlignment</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Alignment (in bytes) of sections when loaded into memory. Must greater or equal to File Alignment. Default is the page size for the architecture.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">36</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">FileAlignment</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Alignment factor (in bytes) used to align the raw data of sections in the image file. The value should be a power of 2 between 512 and 64K inclusive.  The default is 512.  If the SectionAlignment is less than the architecture&#39;s page size than this must match the SectionAlignment.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">40</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">2</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">MajorOperatingSystemVersion</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Major version number of required OS.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">42</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">2</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">MinorOperatingSystemVersion</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Minor version number of required OS.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">44</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">2</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">MajorImageVersion</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Major version number of image.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">46</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">2</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">MinorImageVersion</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Minor version number of image.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">48</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">2</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">MajorSubsystemVersion</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Major version number of subsystem.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">50</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">2</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">MinorSubsystemVersion</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Minor version number of subsystem.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">52</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Reserved</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">dd</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">56</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">SizeOfImage</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Size, in bytes, of image, including all headers; must be a multiple of Section Alignment.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">60</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">SizeOfHeaders</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Combined size of MS-DOS stub, PE Header, and section headers rounded up to a multiple of FileAlignment.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">64</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">CheckSum</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Image file checksum. The algorithm for computing is incorporated into IMAGHELP.DLL. The following are checked for validation at load time: all drivers, any DLL loaded at boot time, and any DLL that ends up in the server.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">68</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">2</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Subsystem</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Subsystem required to run this image. See &quot;Windows NT Subsystem&quot; below for more information.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">70</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">2</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">DllCharacteristics</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">See &quot;DLL Characteristics&quot; below for more information.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">72</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">SizeOfStackReserve</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Size of stack to reserve. Only the Stack Commit Size is committed; the rest is made available one page at a time, until reserve size is reached.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">76</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">SizeOfStackCommit</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Size of stack to commit.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">80</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">SizeOfHeapReserve</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Size of local heap space to reserve. Only the Heap Commit Size is committed; the rest is made available one page at a time, until reserve size is reached.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">84</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">SizeOfHeapCommit</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Size of local heap space to commit.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">88</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">LoaderFlags</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Obsolete.</td>
</tr>
<tr valign=top>
<TD width=56pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">92</td>
<TD width=40pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">4</td>
<TD width=144pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">NumberOfRvaAndSizes</td>
<TD width=212pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Number of data-dictionary entries in the remainder of the Optional Header. Each describes a location and size.</td>
</tr>
</table><br>
<h2>Windows NT Subsystem</h2>
<p>
The following values are defined for the Subsystem field of the Optional Header. They determine what, if any, Windows NT subsystem is required to run the image.</p>
<table border=1 cols=3 frame=box rules=all>
<tr valign=top>
<TD width=194pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Constant</b></td>
<TD width=45pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Value</b></td>
<TD width=234pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Description</b></td>
</tr>
<tr valign=top>
<TD width=194pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">IMAGE_SUBSYSTEM_UNKNOWN</td>
<TD width=45pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">0</td>
<TD width=234pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Unknown subsystem.</td>
</tr>
<tr valign=top>
<TD width=194pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">IMAGE_SUBSYSTEM_NATIVE</td>
<TD width=45pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">1</td>
<TD width=234pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Used for device drivers and native Windows NT processes.</td>
</tr>
<tr valign=top>
<TD width=194pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">IMAGE_SUBSYSTEM_WINDOWS_GUI</td>
<TD width=45pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">2</td>
<TD width=234pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Image runs in the Windows&reg; graphical user interface (GUI) subsystem.</td>
</tr>
<tr valign=top>
<TD width=194pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">IMAGE_SUBSYSTEM_WINDOWS_CUI</td>
<TD width=45pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">3</td>
<TD width=234pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Image runs in the Windows character subsystem.</td>
</tr>
<tr valign=top>
<TD width=194pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">IMAGE_SUBSYSTEM_POSIX_CUI</td>
<TD width=45pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">7</td>
<TD width=234pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Image runs in the Posix character subsystem.</td>
</tr>
<tr valign=top>
<TD width=194pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">IMAGE_SUBSYSTEM_WINDOWS_CE_GUI</td>
<TD width=45pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">9</td>
<TD width=234pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Image runs in on Windows CE</td>
</tr>
</table><br>
<h2>DLL Characteristics</h2>
<p>
The following values are defined for the DllCharacteristics field of the Optional Header.</p>
<table border=1 cols=3 frame=box rules=all>
<tr valign=top>
<TD width=248pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Constant</b></td>
<TD width=68pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Value</b></td>
<TD width=158pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"><b>Description</b></td>
</tr>
<tr valign=top>
<TD width=248pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"></td>
<TD width=68pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">0x0001</td>
<TD width=158pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Reserved</td>
</tr>
<tr valign=top>
<TD width=248pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"></td>
<TD width=68pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">0x0002</td>
<TD width=158pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Reserved</td>
</tr>
<tr valign=top>
<TD width=248pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"></td>
<TD width=68pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">0x0004</td>
<TD width=158pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Reserved</td>
</tr>
<tr valign=top>
<TD width=248pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2"></td>
<TD width=68pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">0x0008</td>
<TD width=158pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Reserved</td>
</tr>
<tr valign=top>
<TD width=248pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">IMAGE_DLLCHARACTERISTICS_WDM_DRIVER</td>
<TD width=68pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">0x2000</td>
<TD width=158pt><FONT FACE="verdana, Arial, Helvetica" SIZE="2">Driver is a WDM Driver</td>
</tr>
</table><br>


</BODY>
</HTML>
