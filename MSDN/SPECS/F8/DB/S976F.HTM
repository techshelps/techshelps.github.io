<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Chapter 2 Digital Video Command Strings</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
</OBJECT></FORM>
<H1>Chapter 2 Digital Video Command Strings</H1>  </P>
The <B>digitalvideo</B> command set supports the display and capture of motion video sequences. As important limiting cases, it also supports the display and capture of digital audio and still images.</P>
A command string has the following form:</P>
command device_id arguments</P>
<SPAN CLASS="list"><UL><LI>    The <I>command</I> specifies an MCI command (for example, <B>open</B>, <B>close</B>, or <B>play</B>).</LI><LI>    The <I>device_id</I> identifies an instance of an MCI driver. The <I>device_id</I> is created when the device is opened. </LI><LI>    The <I>arguments</I> specify the flags and parameters used by the <I>command</I>. Flags are key words recognized with the MCI command. Parameters are numbers or strings that apply to the MCI command or flag. 
For example, the <B>play</B> command uses the arguments <B>from</B> <I>position</I> and <B>to </B><I>position</I> to indicate the positions to start and end playing. In this section, flags are bold, and variable parameters are italic. You can list the flags used with a command in any order. When you use a flag that has a parameter associated with it, you must supply a value for the parameter. </P>

Unspecified (and optional) command arguments assume a default value.</P></LI></UL></SPAN>Although not explicitly listed with each command string, all commands accept the optional items <B>wait</B> and <B>notify</B>. All commands except <B>open</B> and <B>close</B> accept the optional item <B>test</B>.</P>
<B>Digitalvideo</B> devices support at least the following command set:</P>
  </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="92pt" VALIGN="TOP"><COL WIDTH="379pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Command</B></P></TD><TD VALIGN="TOP">Description</P></TD></TR></TBODY></TABLE>
<BR></P></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="379pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>capability</B> <I>item</I></P></TD><TD VALIGN="TOP">Fills an application supplied buffer with a string containing information about the capabilities of the <B>digitalvideo</B> device. The <I>item</I> is one of the following:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="294pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>can</B> <B>eject</B></P></TD><TD VALIGN="TOP">Returns <B>false</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>can freeze</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> is the device can freeze data in the frame buffer.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>can</B> <B>lock</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if the device supports a lock mask. This implies the device can lock portions of the image with the <B>freeze</B> and <B>unfreeze</B> commands.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>can</B> <B>play</B></P></TD><TD VALIGN="TOP">Digital video devices return <B>true</B>. Overlay devices return <B>false</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>can</B> <B>record</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if the device can digitize audio data, video data, or both. It returns <B>false</B> otherwise.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>can</B> <B>reverse</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if the device can <B>play</B> files in reverse.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>can</B> <B>save</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if the device can store digitized images, audio, and/or video to disk. It returns <B>false</B> otherwise.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>can</B> <B>stretch</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if the device can (even if only to a limited extent) resize an image or motion video in the process of writing it from the frame buffer to the display. It returns <B>false</B> otherwise.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>can</B> <B>stretch input</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if the device can (even if only to a limited extent) resize an image or motion video in the process of digitizing it into the frame buffer. It returns <B>false</B> otherwise.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>can</B> <B>test</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if the device recognizes the <B>test</B> keyword. It returns <B>false</B> otherwise.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>compound device</B></P></TD><TD VALIGN="TOP">Digital video devices returns <B>true</B>. Overlay devices return <B>false</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>device</B> <B>type</B></P></TD><TD VALIGN="TOP">Returns <B>digitalvideo</B> or <B>overlay</B> depending on how the device was opened.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>has</B> <B>audio</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if the device supports audio playback. It returns <B>false</B> otherwise.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>has</B> <B>still</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if the device treats files with a single image more efficiently than motion video files. It returns <B>false</B> otherwise.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>has</B> <B>video</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if the device supports video playback. It returns <B>false</B> otherwise.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>maximum play rate</B></P></TD><TD VALIGN="TOP">Returns the maximum play rate in frames per second.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>minimum play rate</B></P></TD><TD VALIGN="TOP">Returns the minimum play rate in frames per second.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>uses</B> <B>files</B></P></TD><TD VALIGN="TOP">Returns <B>true</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>uses</B> <B>palettes</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if images and video use a palette for display. It returns <B>false</B> otherwise.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>windows</B> </P></TD><TD VALIGN="TOP">Returns the maximum number of simultaneous display windows the device can support. The actual value might be less depending on what the device is doing. All windows might not be able to play motion video at the same time.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="379pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>capture</B> <I>items</I></P></TD><TD VALIGN="TOP">Copies the contents of the frame buffer and stores it in the specified file. This command might fail if the device is currently playing motion video or executing some other resource intensive operation. If the frame buffer is being updated in real time, the updating momentarily pauses so that a complete image is captured. If the device pauses the updating, there might be a visual or audible effect. If the file format, compression algorithm, and quality levels have not been set, their defaults are used. The following <I>items</I> modify this command:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="294pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>as</B> <I>pathname</I></P></TD><TD VALIGN="TOP">Specifies the destination path and filename for the captured image. This <I>item</I> is required.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>at</B> <I>rectangle</I></P></TD><TD VALIGN="TOP">Specifies the rectangular region within the frame buffer the device crops and saves to disk. If omitted, the cropped region defaults to the rectangle specified or defaulted on a previous <B>put</B> <B>source</B> command for this device instance.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="379pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>close</B></P></TD><TD VALIGN="TOP">Closes an instance of the <B>digitalvideo</B> device and releases all resources associated with it. If the window is a default window, it is destroyed; otherwise the contents of the window are not defined. If the workspace contains unsaved data, or there is a <B>save</B> in progress, then the associated data will be lost. The commands <B>status</B> <I>device name</I> <B>unsaved</B> and <B>status</B> <I>device name</I> <B>file mode</B>, can be used to detect these situations.</P></TD></TR><TR><TD VALIGN="TOP"><B>configure</B></P></TD><TD VALIGN="TOP">Displays a device specific dialog box used to change device specific features. The dialog box should not allow changes to parameters covered elsewhere in this specification. This ensures that applications provide only one way to modify standard parameters.</P></TD></TR><TR><TD VALIGN="TOP"><B>copy</B> <I>items</I></P></TD><TD VALIGN="TOP">Copies multimedia data onto the Clipboard without modifying the workspace. The following <I>items</I> modify this command. </P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="294pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>at</B> <I>rectangle</I></P></TD><TD VALIGN="TOP">Specifies the portion of each frame that will be copied. If omitted, it defaults to the entire frame.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio stream </B><I>stream</I></P></TD><TD VALIGN="TOP">Specifies the audio stream in the workspace affected by the command. If you use this flag and also want to copy video, you must also use the <B>video stream</B> flag. (If neither flag is specified, all audio and video streams are copied.)</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>from</B> <I>position</I></P></TD><TD VALIGN="TOP">Specifies the start of the range copied. If omitted, it defaults to the current position.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>to</B> <I>position</I></P></TD><TD VALIGN="TOP">Specifies the end of the range copied. The audio and video data copied are exclusive of this position. If omitted, it defaults to the end of the workspace.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video stream </B><I>stream</I></P></TD><TD VALIGN="TOP">Specifies the video stream in the workspace affected by the command. If you use this flag and also want to copy audio, you must also use the <B>audio stream</B> flag. (If neither flag is specified, all audio and video streams are copied.)</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="379pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>cue</B> <I>items</I></P></TD><TD VALIGN="TOP">Prepares a device instance for playback or recording. When a device is cued, the device performs whatever time consuming operations it can do in advance so that the <B>play</B> or <B>record</B> commands will start quickly. This command switches a device instance in a stopped state to a paused state. This command is modified by the following optional <I>items</I>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="294pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>input</B></P></TD><TD VALIGN="TOP">Prepares the device instance for recording. If a previous <B>reserve</B> or <B>cue </B>command has not been used, recording will perform an implied <B>reserve</B> (if applicable) using device-specific default parameters. <B>Input</B> can be omitted if the current presentation source is already the external input. (This command has no effect on selecting the presentation source.)</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>output</B></P></TD><TD VALIGN="TOP">Prepares the device instance for playing. If the workspace is paused, no positioning occurs. If the workspace is stopped, the position might change to a previous key frame image. The <B>output</B> flag can be omitted if the current presentation source is already the workspace.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>to</B> <I>position</I></P></TD><TD VALIGN="TOP">Specifies the position in the workspace. Unlike <B>seek to </B><I>position</I>, <B>cue</B> <B>to </B><I>position </I>always finishes in <B>paused</B> mode. The default is the current position.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>noshow</B></P></TD><TD VALIGN="TOP">Positions the workspace without changing the displayed image or the contents of the frame buffer. However, it changes the current position to that specified in the <B>to</B> parameter and gets ready to display that frame. For example, the <B>cue to 5 noshow </B>command positions the device at frame 5 without displaying the image of frame 5. Subsequently, sending <B>cue</B> without <B>noshow</B> displays the image.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="379pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>cut</B> <I>items</I></P></TD><TD VALIGN="TOP">Cuts multimedia data from the workspace and copies it onto the Clipboard. The change only becomes permanent when the data is explicitly saved. However, playback acts as if the data had actually been removed. This command is modified by the following <I>items</I>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="294pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>at</B> <I>rectangle</I></P></TD><TD VALIGN="TOP">Specifies the portion of each frame cut. If omitted, it defaults to the entire frame. When this item is specified, frames are not actually deleted. Instead the area inside the rectangle becomes black.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio stream </B><I>stream</I></P></TD><TD VALIGN="TOP">Specifies the audio stream in the workspace affected by the command. If you use this flag and also want to cut video, you must also use the <B>video stream</B> flag. (If neither flag is specified, all audio and video streams are cut.)</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>from</B> <I>position</I></P></TD><TD VALIGN="TOP">Specifies the start of the range cut. If omitted, it defaults to the current position.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>to</B> <I>position</I></P></TD><TD VALIGN="TOP">Specifies the end of the range cut. The audio and video data cut are exclusive of this position. If omitted it defaults to the end of the workspace.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video stream </B><I>stream</I></P></TD><TD VALIGN="TOP">Specifies the video stream in the workspace affected by the command. If you use this flag and also want to cut audio, you must also use the <B>audio stream</B> flag. (If neither flag is specified, all audio and video streams are cut.)</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="379pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>delete</B> <I>items</I></P></TD><TD VALIGN="TOP">Deletes multimedia data from the workspace without affecting the Clipboard. The change becomes permanent only when the data is explicitly saved. Playback, however, acts as if the data had actually been removed. This command is useful for recording with devices that do not support recording into a file containing existing data. This command is modified by the following <I>items</I>. </P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="294pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>at</B> <I>rectangle</I></P></TD><TD VALIGN="TOP">Specifies the portion of each frame deleted. If omitted, it defaults to the entire frame. When this item is specified, frames are not actually deleted. Instead the area inside the rectangle becomes black.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio stream </B><I>stream</I></P></TD><TD VALIGN="TOP">Specifies the audio stream in the workspace affected by the command. If you use this flag and also want to delete video, you must also use the <B>video stream</B> flag. (If neither flag is specified, all audio and video streams are deleted.)</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>from</B> <I>position</I></P></TD><TD VALIGN="TOP">Specifies the start of the range deleted. If omitted, it defaults to the current position.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>to</B> <I>position</I></P></TD><TD VALIGN="TOP">Specifies the last frame deleted. The audio and video data deleted are exclusive of this position. If omitted, data up to, and including the last frame of the workspace is deleted.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video stream </B><I>stream</I></P></TD><TD VALIGN="TOP">Specifies the video stream in the workspace affected by the command. If you use this flag and also want to delete audio, you must also use <B>audio stream</B> flag. (If neither flag is specified, all audio and video streams are deleted.)</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="379pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>freeze</B> <I>item</I></P></TD><TD VALIGN="TOP">Stops the updating of the frame buffer from the presentation source. It has no effect on the presentation source itself, which can continue to generate images that are discarded. The following optional <I>items</I> modify <B>freeze</B>.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="294pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>at</B> <I>rectangle</I></P></TD><TD VALIGN="TOP">Specifies a rectangular region within the frame buffer. Unless the <B>outside</B> flag is used, all of the pixels within the rectangle will have their lock mask bit turned on. If this item is not specified, it defaults to the entire frame buffer. The specified pixels will not be updated until their lock mask bit is turned off. This <I>item</I> is supported only if <B>capability</B> <I>device name</I> <B>can</B> <B>lock</B> is <B>true</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>outside</B></P></TD><TD VALIGN="TOP">Indicates the area outside the region specified with the <B>at</B> flag is frozen.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="379pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>info</B> <I>items</I></P></TD><TD VALIGN="TOP">Fills a user supplied buffer with a string containing information about the device or driver instance. The following optional <I>items</I> modify <B>info</B>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="294pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio</B> <B>algorithm</B></P></TD><TD VALIGN="TOP">Returns the name of the current audio compression algorithm.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio</B> <B>quality</B></P></TD><TD VALIGN="TOP">Returns the name for the current audio quality descriptor. This might return <B>unknown</B> if the application has set parameters to specific values that do not correspond to defined qualities.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>file</B></P></TD><TD VALIGN="TOP">Returns the full path of the file specified with the last <B>open</B> or <B>load</B>. If the device is opened without a file and the <B>load </B>command has not been used, then a null string is returned.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>product</B></P></TD><TD VALIGN="TOP">Returns the product name. This should be a descriptive name, typically giving manufacturer and model number. This name must be 31 characters or less.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>still</B> <B>algorithm</B></P></TD><TD VALIGN="TOP">Returns the name of the current still image compression algorithm.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>still</B> <B>quality</B></P></TD><TD VALIGN="TOP">Returns the name for the current still image quality descriptor. This might return <B>unknown</B> if the application has set parameters to specific values that do not correspond to defined qualities.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>usage</B></P></TD><TD VALIGN="TOP">Returns a string describing usage restrictions that might be imposed by the owner of the visual or audio data in the workspace.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>version</B></P></TD><TD VALIGN="TOP">Returns the release level of the device driver and hardware. Device-driver developers must document the syntax of the returned string.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video</B> <B>algorithm</B></P></TD><TD VALIGN="TOP">Returns the name of the current video compression algorithm.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video</B> <B>quality</B></P></TD><TD VALIGN="TOP">Returns the name for the current video quality descriptor. This might return <B>unknown</B> if the application has set parameters to specific values that do not correspond to defined qualities.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>window</B> <B>text</B></P></TD><TD VALIGN="TOP">Returns the text string in the title bar of the window associated with the device instance.</P></TD></TR></TBODY></TABLE>
<BR></P> <B>list</B> <I>items</I></P>
<P></P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="283pt" VALIGN="TOP"><COL WIDTH="10pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Returns information describing the compression algorithms, video sources, audio streams, and video streams supported by the device. This is an enumerated list. The <B>count</B> flag is used to determine the number of items in the list. The <B>number</B> flag specifies the index into the list. When used with the <B>number</B> flag, the <B>list</B> command returns information about the item corresponding to the index. The <I>item</I>s are defined as follows:</P></TD></TR><TR><TD VALIGN="TOP">_</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="294pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio</B> <B>algorithm</B></P></TD><TD VALIGN="TOP">Specifies the command should retrieve audio algorithm names.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio</B> <B>quality</B> </P></TD><TD VALIGN="TOP">Specifies the command should </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>algorithm </B><I>algorithm</I></P></TD><TD VALIGN="TOP">retrieve quality levels associated with the specified <I>algorithm</I>. If <I>algorithm</I> is <B>current</B> then the quality level of the current algorithm is returned.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio stream</B></P></TD><TD VALIGN="TOP">Specifies the command should retrieve the names of the audio streams associated with the workspace. These are strings (such as "English" or "German") are embedded in the file and identify the stream.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>count</B></P></TD><TD VALIGN="TOP">Returns the number of options of the specified type.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>number</B> <I>index</I></P></TD><TD VALIGN="TOP">Returns a string describing a specific option (as identified by <I>index</I>) of the specified option type. <I>Index</I> must be an integer between 1 and the value returned by <B>count</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>still</B> <B>algorithm</B></P></TD><TD VALIGN="TOP">Specifies the command should retrieve still algorithm names. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>still quality</B> </P></TD><TD VALIGN="TOP">Specifies the command should </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>algorithm </B><I>algorithm</I></P></TD><TD VALIGN="TOP">retrieve quality levels associated with the specified still <I>algorithm</I>. If <I>algorithm</I> is <B>current</B> then the quality level of the current algorithm is returned.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video</B> <B>algorithm</B></P></TD><TD VALIGN="TOP">Specifies the command should retrieve video algorithm names. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video</B> <B>quality</B> </P></TD><TD VALIGN="TOP">Specifies the command should retrieve </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>algorithm </B><I>algorithm</I></P></TD><TD VALIGN="TOP">quality levels associated with the specified video <I>algorithm</I>. If <I>algorithm</I> is <B>current</B> then the quality level of the current algorithm is returned.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video source</B></P></TD><TD VALIGN="TOP">Specifies the command should return information about the video sources. When used with the <B>count</B> flag, it returns the number of video sources. When used with the <B>number</B> flag, it returns the type of a video source. MCI defines the following constants for type: <B>ntsc</B>,<B> rgb</B>,<B> pal</B>,<B> secam</B>,<B> svideo</B>, and<B> generic</B>. There might be more than one source of each type returned. The <B>generic</B> source type is used when more than one signal is allowed for that connector.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video stream</B></P></TD><TD VALIGN="TOP">Specifies the command should retrieve the names of video streams associated with the workspace. These are strings (for example, "funny ending" or "sad ending") are embedded in the file and identify the stream.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="379pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>load</B> <I>item</I></P></TD><TD VALIGN="TOP">Loads a file into the workspace for the device instance. Files loaded using this command cannot be shared. Loading a file cancels any signals set for the device instance. After loading a file, the return value of <B>status</B> <B>mode</B> <B>stopped</B>. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">When a device is opened as a digital video device, it loads a still or motion video file into the workspace. When a device is opened as an overlay device, it loads a still image into the frame buffer. Overlay devices should use the <B>restore</B> command rather than <B>load</B>. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">This command is modified by the following <I>item</I>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="294pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><I>filename</I></P></TD><TD VALIGN="TOP">Specifies the path and filename for the file loaded into the workspace. This <I>item</I> is required. </P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="379pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>monitor</B> <I>items</I></P></TD><TD VALIGN="TOP">Specifies the presentation source. (The default presentation source is the workspace.) Switching the presentation source switches all audio and video streams in the source. The presentation source automatically switches to the workspace after a <B>play</B>, <B>step</B>, <B>pause</B>, <B>cue output</B>, or <B>seek</B> command. The <B>record</B> command does not automatically switch presentation sources. This gives your application the option of not showing video while it is being recorded. This command is modified by the following <I>items</I>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="294pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>input</B></P></TD><TD VALIGN="TOP">Specifies that the external input is the presentation source. If a <B>play</B> command is in progress, it is first paused. If <B>setvideo</B> is <B>on</B>, this flag displays a default hidden window. Devices might limit what other device instances can do while monitoring input. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>file</B></P></TD><TD VALIGN="TOP">Specifies that the workspace is the presentation source. This is the default source.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>method</B> <I>method</I></P></TD><TD VALIGN="TOP">When used with <B>monitor</B> <B>input</B>, this flag selects the method of monitoring. <I>Method </I>is either <B>pre</B>, <B>post</B>, or <B>direct</B>. <B>Direct</B> monitoring requests that the device be configured for optimum display quality during monitoring. The direct monitoring method might be incompatible with motion video recording. </P>
<B>Pre-</B> and <B>post-</B>monitoring both allow motion video recording. <B>Pre</B>-monitoring shows the external input prior to compression, while <B>post</B>-monitoring shows the external input after compression. Typically, different monitoring methods have different hardware implications. The default monitoring method is selected by the device.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="379pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>open</B> <I>items</I></P></TD><TD VALIGN="TOP">Initializes an instance of the <B>digitalvideo</B> device driver. Each <B>open</B> creates an independent instance of the device, which can be referenced by its <I>device name</I>. There might be device specific restrictions on how many instances can be opened simultaneously. The following <I>items</I> modify <B>open</B>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="294pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>alias</B> <I>alias</I></P></TD><TD VALIGN="TOP">Specifies an <I>alias</I> used to reference this instance of the device. The <B>open</B> is rejected if the <I>alias</I> is already in use by this application. If this <I>item</I> is omitted, the default <I>device name</I> is the specified <I>filename</I>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>nostatic</B></P></TD><TD VALIGN="TOP">Indicates that the device should reduce the number of static (system) colors in the palette. Reducing the number of static colors increases the number of colors available for rendering the video stream. This item only applies to devices that share a palette with Windows.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>parent</B> <I>hwnd</I></P></TD><TD VALIGN="TOP">Specifies the parent of the default window. This item is only used with a window <B>style</B> that requires the specification of a parent or owner. <I>hwnd</I> is the ASCII decimal equivalent of the parent window's handle.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>shareable</B></P></TD><TD VALIGN="TOP">Specifies that a single instance of the associated file can be accessed by two or more device instances. That is, file positioning commands directed towards one of these instances will affect the position in all the instances. Each instance can, however, have an independent window as well as other characteristics not directly related to file positioning. If the device uses only a single instance of digitizer hardware, then this flag also lets a single digitizer frame buffer be shared by multiple device instances.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>style</B> <I>StyleValue</I></P></TD><TD VALIGN="TOP">Specifies the style used for the default window. The <I>StyleValue</I> is the ASCII decimal value corresponding to a Windows style used by the <B>CreateWindow</B> function. The default value for <I>StyleValue</I> is WS_OVERLAPPED. In addition, the following constants are defined for <I>StyleValue</I>: <B>overlapped</B>, <B>popup</B>, and <B>child</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>type </B><I>device_type</I></P></TD><TD VALIGN="TOP">Specifies the device type of the device element. If omitted, MCI selects the device based on the filename extensions listed in the [mci extensions] section of the WIN.INI file. This flag is required when <B>new</B> is specified.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="379pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>paste</B> <I>items</I></P></TD><TD VALIGN="TOP">Copies the contents of the Clipboard into the workspace. No signals are present in the data copied from the Clipboard. The change becomes permanent only when the data is explicitly saved. However, playback acts as if the data had actually been added. This command is modified by the following <I>items</I>: </P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="294pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>at</B> <I>rectangle</I></P></TD><TD VALIGN="TOP">Specifies the location within the frame where the data is pasted. The upper left corner of the <I>rectangle</I> corresponds to the upper left corner of the added data. If the rectangle has a non-zero size in X or Y, the contents of the Clipboard are scaled in those dimensions when they are pasted into the frame. If omitted, the <I>rectangle</I> defaults to the entire frame. If this <I>item</I> is specified in <B>insert</B> mode (the default), then any region outside the rectangle is painted a solid color.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio stream </B><I>stream</I></P></TD><TD VALIGN="TOP">Specifies the audio stream in the workspace affected by the command. If only one audio stream exists on the Clipboard, the audio data is pasted into the designated <I>stream</I>. If more than one audio stream exists on the Clipboard, the <I>stream</I> indicates the starting number for the stream sequences. If you use this flag and also want to paste video, you must also use the <B>video stream</B> flag. (If neither flag is specified, all audio and video streams are pasted and retain their original stream numbers.) </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>insert</B></P></TD><TD VALIGN="TOP">Specifies that the data is inserted into the workspace. Any data after the insertion point is moved forward in the workspace to make room. This is the default value.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>overwrite</B></P></TD><TD VALIGN="TOP">Specifies that the data is copied into the workspace by writing over any existing data after the insertion point. The <B>insert</B> and <B>overwrite</B> flags affect whether frames are destroyed or moved during the paste operation, not how the data is pasted within each frame.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>to</B> <I>position</I></P></TD><TD VALIGN="TOP">Specifies the position in the workspace at which the data is pasted. If omitted, it defaults to the current position.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video stream </B><I>stream</I></P></TD><TD VALIGN="TOP">Specifies the video stream in the workspace affected by the command. If only one video stream exists on the Clipboard, the video data is pasted into the designated <I>stream</I>. If more than one video stream exists on the Clipboard, the <I>stream</I> indicates the starting number for the stream sequences. If you use this flag and also want to paste audio, you must also use the <B>audio stream</B> flag. (If neither flag is specified, all audio and video streams are pasted and retain their original stream numbers.) </P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>pause</B></P></TD><TD VALIGN="TOP">Pauses the playing or recording of motion video or audio. The last displayed image remains visible and the device instance remains cued. The <B>play</B>, <B>record</B>, and <B>resume</B> commands continue the operation of a paused device. If <B>pause</B> follows a <B>play notify</B>, the notification is not aborted</P>
If the <B>hold</B> flag was specified for a <B>record</B> in process, pausing a device also executes the <B>monitor file</B> command. This stops the presentation of audio and video data from the external input providing a visual cue that recording is paused.</P></TD></TR><TR><TD VALIGN="TOP"><B>play</B> <I>items</I></P></TD><TD VALIGN="TOP">Starts the generation of audio and/or video signals from the data in the workspace. <B>Play</B> causes an implied selection of the workspace as the presentation source. If <B>setvideo</B> is <B>on</B>, <B>play</B> displays a default hidden window. When a device finishes playing, its mode is the same as defined for <B>seek</B>. There might be device specific restrictions on what activities can occur simultaneously in other device instances. The following optional <I>items</I> modify <B>play</B>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>from</B> <I>position</I></P></TD><TD VALIGN="TOP">Specifies the position to seek to before beginning playback. The <I>position</I> value is specified in the current time format. The position the device uses is affected by whether <B>seek</B> <B>exactly</B> is <B>on</B> or <B>off</B>. </P>
If this flag is omitted and playing is currently paused or the device is cued, playing starts at the current position. If it is omitted and playing is stopped, the resulting seek might require changing the position to a previous key frame image.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>repeat</B></P></TD><TD VALIGN="TOP">Specifies that the playback should repeat until it is paused or stopped. Each iteration uses all the flags specified for the <B>play</B> command. If a <B>from</B> position is not specified using this command, the second and subsequent iterations start at the beginning of the media.</P>
Pausing play does not cancel the <B>repeat</B> flag.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>reverse</B></P></TD><TD VALIGN="TOP">Specifies playing should occur in <B>reverse</B>. A device might support reverse playback only for certain files (for example, files consisting of still images). If a file cannot play in reverse, or a device is incapable of playing the file in reverse, the command is rejected. If possible, the device plays any accompanying audio if audio output is enabled.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>to</B> <I>position</I></P></TD><TD VALIGN="TOP">Specifies the position to stop playing. When the current time format is <B>frames</B>, the <I>position</I> value is the number of the frame displayed when the motion video stops. Audio associated with the frame specified for <B>to</B> is not played by most devices. The <B>to</B> position is not affected by the <B>seek exactly</B> state. If <B>to</B> is not specified, playing continues until the last valid position is reached. In either case, when playing is done, the workspace has an image displayed in the window.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>put</B> <I>items</I></P></TD><TD VALIGN="TOP">Specifies a rectangular region that describes a cropping or scaling option. A flag indicating the video source or destination (for example, <B>destination</B>, <B>frame</B>, <B>video</B>, <B>source</B>, or <B>window</B>) must be specified with this command. The following <I>items</I> modify <B>put</B>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>at</B> <I>rectangle</I></P></TD><TD VALIGN="TOP">Specifies the <I>rectangle</I> used for one of the modifier items for this command. </P>
If a <I>rectangle</I> is not specified for a video source or destination, it defaults to the full image. A <I>rectangle</I> consists of four integer values denoting the coordinates of the upper-left pixel and the width and height of the rectangle. Each integer is delimited by one or more spaces. The pixel origin is defined such that pixel (0,0) is in the upper-left corner of the client rectangle, frame buffer or input depending on the specified region.</P>
Some devices might recognize negative values used for the height and width. The interpretation of these values is device dependent.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>destination</B></P></TD><TD VALIGN="TOP">Specifies the portion of the client window used to show the image or video. The <B>destination</B> rectangle is specified relative to the upper-left corner of the client window in pixel coordinates. The default rectangle is the full client area. </P>
The device instance will, to the best of its ability, linearly scale the <I>rectangle</I> specified by <B>put</B> <B>source</B> to the specified portion of the display. Devices that do not support a <B>capability</B> of <B>can</B> <B>stretch</B>, or cannot perform the specific stretch indicated, might display a different sized image starting at the designated upper-left pixel. If the specified rectangle is outside the client region, then no pixels are drawn. Devices that cannot shrink the image to the requested size crop the right and bottom of the image or video to avoid drawing outside the <B>destination</B> rectangle.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>frame</B></P></TD><TD VALIGN="TOP">Specifies which portion of the frame buffer, in frame buffer coordinates, the <B>video</B> rectangle should be scaled to fit within. The default rectangle is the full frame buffer. Specifying this rectangle lets the hardware scale the data as it is digitized. Devices that cannot do this scaling operation reject the command with MCIERR_UNSUPPORTED_FUNCTION. (A device cannot stretch the input if it returns <B>false </B>to <B>capability</B> <B>can</B> <B>stretch</B> <B>input</B>.) </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>source</B></P></TD><TD VALIGN="TOP">Specifies which portion of the frame buffer, in frame buffer coordinates, is scaled to fit in the <B>destination</B> rectangle. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video</B></P></TD><TD VALIGN="TOP">Specifies which portion of the current presentation source is stored in the frame buffer. The coordinates are in the natural coordinates for the presentation source. This rectangle specifies cropping that occurs prior to storing images and video in the frame buffer. The default rectangle is the full active scan area or the full decompressed images and video area. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>window</B></P></TD><TD VALIGN="TOP">Changes the size and location of the display window. The rectangle specified with the <B>at</B> flag is relative to the parent window of the display window (usually the desktop). If the rectangle is not specified, it defaults to the initial window size and position. (This is usually set to an optimum size and aspect ratio.) </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>window client</B></P></TD><TD VALIGN="TOP">Changes the size and location of the client window. This is the same as <B>put window</B> except that the specified rectangle is the position of the client rectangle rather than the position of the display window. See the Windows <B>AdjustWindowRect</B> function for more information about client rectangles.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>quality </B><I>items</I></P></TD><TD VALIGN="TOP">This command defines a custom quality level for either audio, video or still image data compression. It defines a string name for the quality level, which can then be used in a <B>setvideo</B> <B>quality</B>, <B>setvideo</B> <B>still</B> <B>quality</B>, or <B>setaudio</B> <B>quality</B> command to establish it as the current video, still or audio compression quality level. Precisely one of the three flags <B>audio</B>, <B>still</B>, and <B>video</B> must be present.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>algorithm </B></P>
<I>algorithm</I></P></TD><TD VALIGN="TOP">Associates the quality level with the specified <I>algorithm</I>. This <I>algorithm</I> must be supported by the device, and must be compatible with the <B>audio</B>, <B>still</B>, or <B>video</B> flag that is used. If omitted, the current algorithm is used.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio </B><I>name</I></P></TD><TD VALIGN="TOP">Indicates this command specifies an <B>audio</B> quality level identified with <I>name</I>. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>dialog</B></P></TD><TD VALIGN="TOP">Requests that the device display a dialog box. This dialog box has algorithm-specific fields that are used internally by the device to create the data structure describing a specific quality level.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>handle</B> <I>handle </I></P></TD><TD VALIGN="TOP">Specifies a <I>handle</I> to a data structure that contains algorithmic-specific data describing a specific quality level. The data structures for the data referenced by this handle are device specific.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>still </B><I>name</I> </P></TD><TD VALIGN="TOP">Indicates the command specifies a <B>still</B> quality level identified with <I>name.</I></P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video </B><I>name</I> </P></TD><TD VALIGN="TOP">Indicates the command specifies a <B>video</B> quality level identified with <I>name</I>. </P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>realize</B><I> items</I></P></TD><TD VALIGN="TOP">Tells the device to select and realize its palette into a display context of the displayed window. This command applies only to devices that use palettes. For more information, see the description of <B>SelectPalette</B> in the Windows 3.1 <I>Programmer's Reference. </I>One of the following <I>items</I> modifies <B>realize</B>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>background</B></P></TD><TD VALIGN="TOP">Realizes the palette as a background palette.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>normal</B></P></TD><TD VALIGN="TOP">Realizes the palette normally. This is the default.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="366pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>record</B> <I>items</I></P></TD><TD VALIGN="TOP">Compresses and stores audio and/or video data into the workspace. Recording uses a contiguous disk file allocated by a previous or implied <B>reserve</B> or <B>cue</B> <B>input</B> command. If you have not used <B>reserve</B> or <B>cue input</B> previously, <B>record</B> performs an implied <B>reserve</B> (with device specific default parameters) when necessary. If you have not set the file format, compression algorithm, and quality levels, their defaults are used. There can be device specific limitations on what other device instances might be doing during a <B>record</B>. The following <I>items</I> modify the behavior of <B>record</B>.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>at</B> <I>rectangle</I></P></TD><TD VALIGN="TOP">Specifies a rectangular region of the external input used as the source for the pixels compressed and saved. If not specified, the rectangle defaults to the rectangle specified (or defaulted) for <B>put</B> <B>video</B>. When it is set differently than the <B>video</B> rectangle, the displayed image is not what is recorded.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio stream</B> <I>stream</I></P></TD><TD VALIGN="TOP">Specifies the audio stream used for recording. If this flag is not specified and the file format does not define a default, it is recorded into the physically first stream.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>from</B> <I>position</I></P></TD><TD VALIGN="TOP">Specifies the <I>position</I> in the workspace where recording should begin. If this item is omitted, the default is the current position in the workspace. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>hold</B></P></TD><TD VALIGN="TOP">Specifies that when recording stops, there should be an automatic <B>monitor</B> <B>file</B>. When someone is monitoring the input, this provides immediate visual feedback that recording is complete or is suspended. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>insert</B></P></TD><TD VALIGN="TOP">Indicates the recorded data should be inserted in the existing workspace file at the position specified with the <B>from</B> flag. Whatever data is presently in the workspace is preserved. This is the default. The duration of recording is specified by the difference between the <B>to</B> and <B>from</B> flags. Devices that support inserting data do not change the contents of the original file until the data is explicitly saved with the <B>save</B> command. The device will, however, display the modified data with the <B>play</B> command. If a file in the workspace has data following the explicit or implied <B>from</B> position, and the device cannot guarantee it will preserve this data, it should reject the command.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>overwrite</B></P></TD><TD VALIGN="TOP">Specifies recorded data should replace data already present in the workspace. The frames replaced are designated by the <B>from</B> and <B>to</B> flags. Devices that support overwriting data do not change the contents of the original file until the data is explicitly saved using the <B>save</B> command. The device will, however, display the modified data with the <B>play</B> command. If a file in the workspace has data following the explicit or implied <B>to</B> position, and the device cannot guarantee it will preserve this data, it should reject the command.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>to</B> <I>position</I></P></TD><TD VALIGN="TOP">Specifies the frame in the recorded file where recording should end. The audio and video data recorded are exclusive of this <I>position</I>. When recording is complete the device is at the specified <I>position</I> and the mode is the same as defined for <B>seek</B>. If the <B>to</B> parameter is omitted then recording continues until a <B>pause</B> or <B>stop</B> command is sent.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video stream</B> <I>stream</I></P></TD><TD VALIGN="TOP">Specifies the video stream used for recording. If this is not specified and the file format does not define a default, then it is recorded into the physically first stream.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>reserve</B> <I>items</I></P></TD><TD VALIGN="TOP">Allocates contiguous disk space for the device instance's workspace. If needed, the space reserved is used by subsequent <B>record</B> or <B>save </B>commands. If the workspace contains unsaved data, the data is lost. For some devices, <B>reserve</B> is not required and will be ignored. If disk space is not reserved prior to recording, the <B>record</B> command will perform an implied <B>reserve</B> with device specific default parameters. Use an explicit <B>reserve</B> command if you want better control of when the delay for disk allocation occurs, control of how much space is allocated, and control of where the disk space is allocated. The amount and location of already reserved disk space for the device instance can be changed by subsequent <B>reserve </B>commands. Any allocated, and still unused, disk space is not deallocated until any recorded data is saved, or until the device instance is<B> </B>closed. The following optional <I>items</I> modify <B>reserve</B>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>in</B> <I>path</I></P></TD><TD VALIGN="TOP">Specifies the drive and directory path (but not the name) of a temporary file used to hold recorded data. The name of this file is specified by the device. The temporary file is deleted when the device is closed. If this flag is omitted, the device specifies the location of the disk space.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>size</B> <I>duration</I></P></TD><TD VALIGN="TOP">Specifies the approximate amount of disk space to reserve in the workspace. The <I>duration</I> value is specified in the current time format. The device bases its estimate of the required disk space on the following parameters: the requested time, the file format, the video and audio compression algorithm, and the compression quality values in effect. If <B>setvideo record</B> is <B>off</B> then space is reserved for audio only. If <B>setaudio record</B> is <B>off</B> then space is reserved for video only. If both are <B>off</B> or if <I>duration</I> is zero then no space is reserved and any existing reserved space is deallocated. If this flag is omitted, the device will use a device defined default.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>restore</B></P></TD><TD VALIGN="TOP">Copies a still image from a file to the frame buffer. This is the reverse of <B>capture</B>. Devices can recognize a variety of image formats and a Windows DIB is always accepted. The following <I>items</I> modify <B>restore</B>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>at </B><I>rectangle</I></P></TD><TD VALIGN="TOP">Specifies a rectangle relative to the frame buffer origin. The <I>rectangle</I> is specified as X1 Y1 X2 Y2. The coordinates X1, Y1 specify the top, left corner and the coordinates X2, Y2 specify the width and height of the rectangle. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">If this flag is not used, the image is copied to the upper-left corner of the frame buffer.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>from</B><I> filename</I></P></TD><TD VALIGN="TOP">Specifies the image filename to recall. This flag is required. </P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>resume</B></P></TD><TD VALIGN="TOP">Specifies playing or recording should continue from where it was interrupted by a <B>pause</B> or <B>stop</B> command. The <B>to</B> position specified using the original <B>play</B> or <B>record</B> command is remembered, as well as any other flags that were specified. <B>Resume</B> is always allowed, even if <B>play</B> or <B>record</B> has not been previously used. In this case, it is the same as a <B>play</B> with no parameters.</P>
If any commands used <B>notify</B> between the <B>pause </B>and the <B>resume </B>commands, it supersedes any pending <B>notify</B> from the original <B>play</B> or <B>record </B>command. When the <B>notify</B> flag is used with <B>resume</B>, MCI notifies the application when the resumed <B>play</B> or <B>record</B> completes.</P></TD></TR><TR><TD VALIGN="TOP"><B>save</B> <I>item</I></P></TD><TD VALIGN="TOP">Makes a permanent copy of the contents of the workspace or frame buffer. If the device is opened as an overlay device, this command saves the contents of the frame buffer. If the device is opened as a digital video device, this command saves the contents of the workspace. <B>Save</B> deallocates any unused disk space from the <B>reserve</B>. The current position is not affected by the progress of the <B>save</B> operation. The following <I>items</I> modify <B>save</B>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>abort</B></P></TD><TD VALIGN="TOP">Stops a <B>save</B> operation in progress. If used, this must be the only <I>item</I> present.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>at </B><I>rectangle</I></P></TD><TD VALIGN="TOP">Specifies a rectangle relative to the frame buffer origin. The <I>rectangle</I> is specified as X1 Y1 X2 Y2. The coordinates X1, Y1 specify the top, left corner and the coordinates X2, Y2 specify the width and height of the rectangle. This parameter is allowed only when the device is opened as an overlay device.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">For a digital video devices, <B>capture</B> is used to capture the contents of the frame buffer. Overlay devices should use the <B>capture</B> command to capture the frame-buffer contents.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><I>filename</I></P></TD><TD VALIGN="TOP">Specifies the filename to assign to the data file. If a path is not specified, the file will be placed on the disk and in the directory previously specified on the explicit or implicit <B>reserve</B>. If <B>reserve</B> has not been issued, the default drive and directory are those associated with the application's task. If a path is specified, the device might require it to be on the disk drive specified by the explicit or implicit <B>reserve</B>. The <I>filename</I> is a required <I>item</I>. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>keepreserve</B></P></TD><TD VALIGN="TOP">Specifies that unused disk space left over from the original <B>reserve</B> command is not deallocated.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>seek</B> <I>items</I></P></TD><TD VALIGN="TOP">Positions the workspace. At the end of the seek, the device shows the specified frame. Depending on the device, the mode after a <B>seek</B> is either <B>paused</B> or <B>stopped</B>. (Devices might make a tradeoff between the need to begin play quickly and the need to conserve resources used while paused.) If a device is <B>stopped</B> after <B>seek</B> then an image must be shown in <B>stopped</B> mode. The following <I>items</I> modify <B>seek</B>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>to</B> <I>position</I></P></TD><TD VALIGN="TOP">Specifies the desired new position in units of the current time format. If <B>seek</B> <B>exactly</B> is <B>set</B> <B>off</B>, <B>seek</B> positions the workspace at approximately the requested frame. In general, if the requested frame is interframe encoded, <B>seek</B> positions the workspace at a nearby, previous key frame image. There are two exceptions to this positioning rule.</P>
The first exception is if the <B>to</B> position follows the current position but is before the next key frame image. In this case, the device maintains the current position.</P>
The second exception applies to newly recorded files that have not been saved. In this case, some devices may position the workspace at the first frame of the new data.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>to</B> <B>end</B></P></TD><TD VALIGN="TOP">Positions the workspace to the last frame. If <B>seek exactly</B> is <B>off</B>, this might seek to the last key frame image. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>to</B> <B>start</B></P></TD><TD VALIGN="TOP">Positions the workspace to the first frame.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>set</B> <I>items</I></P></TD><TD VALIGN="TOP">Sets the state of various control items. One of the following <I>items</I> must be included:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>door</B> <B>closed</B></P></TD><TD VALIGN="TOP">Returns MCIERR_UNSUPPORTED_FUNCTION.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>door</B> <B>open</B></P></TD><TD VALIGN="TOP">Returns MCIERR_UNSUPPORTED_FUNCTION.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>file format</B> <I>format</I></P></TD><TD VALIGN="TOP">Specifies the file format used for <B>save</B>. The device developer should document the supported file formats and the default file format. If the specified file format conflicts with the currently selected <B>algorithm</B> and <B>quality</B> then they are changed to the defaults for the file format.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>seek</B> <B>exactly</B> <B>on</B></P></TD><TD VALIGN="TOP">Selects one of two <B>seek</B> modes. If <B>seek</B> </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>seek</B> <B>exactly</B> <B>off</B></P></TD><TD VALIGN="TOP"><B>exactly</B> is <B>on</B>, then the <B>seek</B>, <B>play from</B>, and <B>record from</B> commands will precisely access the requested frame. This might cause an extra delay if the requested frame is not a key frame. (In this case, the device must decode previous frames to decode the requested frame.) </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">If <B>seek</B> <B>exactly</B> is <B>off</B>, the device will <B>seek</B> to a key frame image that precedes the requested frame. For some devices, and some files, this might be the first frame of the file.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">The default for <B>seek exactly</B> is device dependent.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>speed</B> <I>factor</I></P></TD><TD VALIGN="TOP">Sets the relative speed of video and audio playback from the workspace. <I>Factor</I> is the ratio between the nominal frame rate and the desired frame rate where the nominal frame rate is designated as 1000. For example, half speed is 500 and double speed is 2000. The allowable speed range is device and possibly file dependent.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>still file </B></P></TD><TD VALIGN="TOP">Specifies the file format used for <B>capture</B> </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>format </B><I>format</I></P></TD><TD VALIGN="TOP">commands. The device developer should document the supported file formats and the default file format. If the specified file format conflicts with the currently selected <B>algorithm</B> and <B>quality</B> then they are changed to the defaults for the file format.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>time</B> <B>format </B><I>format</I></P></TD><TD VALIGN="TOP">Sets the time format to <I>format</I>. All position information is specified in this format following this command. A <B>digitalvideo</B> driver must support a time format of <B>frames</B> and should support a time format of <B>milliseconds</B>.<B> </B>The default time format is <B>frames</B>. <B>Milliseconds</B> can be abbreviated <B>ms</B>. </P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>setaudio</B> <I>items</I></P></TD><TD VALIGN="TOP">Sets various values associated with audio playback and capture. Some parameters used in the <I>items</I> list are specified as a <I>factor</I>. For these <I>items</I>, 0 represents a minimal amount of the specified characteristic, and 1000 represents the maximum value. To determine the value that indicates no change from the presentation source use the <B>nominal</B> flag with the <B>status</B> command. The linearity of these values is device specific. If a device cannot set the requested <I>factor</I>, it uses the closest value it supports. You can use the <B>status</B> command to determine the actual values set by the device. The <B>setaudio</B> command is modified by the following <I>items</I> (only one of these items can be present in a single command unless otherwise noted):</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>alignment</B> </P></TD><TD VALIGN="TOP">Sets the alignment of data blocks relative </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>to </B><I>integer</I></P></TD><TD VALIGN="TOP">to the start of input waveform data.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>algorithm </B><I>algorithm</I></P></TD><TD VALIGN="TOP">Selects a specific audio compression algorithm for use by a subsequent <B>reserve</B> or <B>record</B> command. The algorithms supported are device specific. MCI defines the values <B>g711</B>, <B>g721, g722</B>, <B>g728</B>, <B>pcm</B>, <B>cdxa</B>, <B>adpcm</B>, <B>adpcm4e</B> for <I>algorithm</I>. If a device supports the algorithm names <B>pcm</B>,<B> cdxa</B>, and <B>adpcm4e</B>, they adhere to standard definitions. The <B>cdxa</B> algorithm has been defined by Sony Corporation. The <B>adpcm4e</B> algorithm has been defined by Intel Corporation. The <B>g711, g721, g722, </B>and <B>g728</B> values represent audio algorithms recommended by the CCITT.</P>
If the specified algorithm conflicts with the current file format, the file format is changed to the default format for the algorithm.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>bass</B> <B>to</B> <I>factor</I></P></TD><TD VALIGN="TOP">Sets the audio low frequency level.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>bitspersample </B></P>
<B>to</B> <I>bit_count</I></P></TD><TD VALIGN="TOP">Sets the number of bits per sample recorded. The file is saved in this format. This flag applies only to devices supporting the <B>pcm</B> algorithm</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>bytespersec</B></P>
<B>to </B><I>integer</I></P></TD><TD VALIGN="TOP">Sets the average number of bytes per second for recording in the <B>pcm</B> and <B>adpcm</B> algorithms. The file is saved in this format.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>clocktime</B></P></TD><TD VALIGN="TOP">Indicates the time specified in the <B>over</B> parameter is in milliseconds. This time is absolute and not in step with the playing of the workspace.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>input</B></P></TD><TD VALIGN="TOP">Modifies the <B>bass</B>,<B> treble</B>, or<B> volume</B> flag so that it affects the input signal and modifies what is recorded. If possible, this is the default when monitoring the input.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>left off</B></P>
<B>left on</B></P></TD><TD VALIGN="TOP">Enables o<B>r disables audio output on the </B>left channel. The audio presentation source can be the external input or the workspace. The default is <B>left on</B>. If there is only one channel is set on or off.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>left</B> <B>volume</B> <B>to</B> <I>factor</I></P></TD><TD VALIGN="TOP">Sets the audio volume of the left audio channel. If there is only one channel it sets its volume</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>off</B></P>
<B>on</B></P></TD><TD VALIGN="TOP">Enable<B>s or disables audio. The audio </B>presentation source can either be the external input or the workspace. This command affects the left and right audio channel simultaneously. The default is <B>setaudio on</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>output</B></P></TD><TD VALIGN="TOP">Modifies the <B>bass</B>,<B> treble</B>,<B> </B>or <B>volume</B> flag so that it modifies only the played signal and not what is recorded. If possible, this is the default when monitoring file.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>over</B> <I>duration</I></P></TD><TD VALIGN="TOP">Specifies how long it should take to make a change that uses a <I>factor </I>parameter. The units for <I>duration</I> are in the current time format. Changes occur in step with the playing of workspace. When playing is suspended, the change is also suspended until the play continues. If <B>over</B> is not used or not supported, the change occurs immediately. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>quality </B><I>descriptor</I></P></TD><TD VALIGN="TOP">Specifies the characteristics of the audio compression performed when audio is recorded to a file. All devices support the three descriptors <B>low</B>, <B>medium</B>, and <B>high</B>. The default is device specific.</P>
If the <B>algorithm</B> flag is not specified, the <B>quality</B> adjustment applies to the current algorithm.</P>
The device-driver developer must determine and document the significance of the descriptor names used by the device. While a device can define its own descriptor names, the following additional naming conventions should be used to minimize confusion:For <B>cdxa</B>, <B>low</B>, <B>medium</B> and <B>high</B> denote the Sony-defined levels C, B, and A.</P>
The <B>quality</B> command can be used to define additional descriptor names.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>record</B> <B>on</B></P>
<B>record</B> <B>off</B></P></TD><TD VALIGN="TOP">Enables or disables recording of audio data. The default is to record audio data.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>right off</B></P>
<B>right on</B></P></TD><TD VALIGN="TOP">Enables or disables audio o<B>utput on the </B>right channel. The audio presentation source can be the external input or the workspace. The default is <B>right on</B>. If there is only one channel, this flag has no effect.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>right</B> <B>volume</B></P>
<B>to </B><I>factor</I></P></TD><TD VALIGN="TOP">Sets the a<B>udio volume to the right audio </B>channel. If there is only one channel, it has no effect.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>samplespersec</B></P>
<B>to</B> <I>integer</I></P></TD><TD VALIGN="TOP">Sets the<B> sample rate for recording with </B>the <B>pcm</B> and <B>adpcm</B> algorithms. The file is saved in this format.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>source</B> <B>to</B></P>
<I>sourcename</I></P></TD><TD VALIGN="TOP">Specifies <I>the source for the audio input </I>digitizer. The constants defined for <I>sourcename</I> include: <B>left</B>, <B>right</B>, <B>average</B>, and <B>stereo</B>. The first three specify monophonic recording using the left input only, the right input only, and the average of the two inputs.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>stream</B> <B>to </B><I>number</I></P></TD><TD VALIGN="TOP">Specifies the audio stream played back from the workspace. If the stream is not specified and the file format does not define a default, then the physically first interleaved audio stream will be played. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>treble</B> <B>to </B><I>factor</I></P></TD><TD VALIGN="TOP">Sets the audio high-frequency level.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>volume to</B> <I>factor</I></P></TD><TD VALIGN="TOP">Sets the average audio volume for both audio channels. If the left and right volumes have been set to different values, then the ratio of left-to-right volume is approximately unchanged.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>setvideo</B> <I>items</I></P></TD><TD VALIGN="TOP">Sets various values associated with video and still playback and capture. Some of the parameters in the <I>items</I> list are specified as a <I>factor</I>. For these <I>items</I>, 0 represents a minimal amount of the specified characteristic, and 1000 represents the maximum value. To determine the value that indicates no change from the presentation source, use the <B>nominal</B> flag with the <B>status</B> command. The linearity of these values is device specific. If a device cannot set the requested <I>factor</I>, it uses a value as close as possible to that specified. You can use the <B>status</B> command to determine the actual values set by the device. The <B>setvideo</B> command is modified by the following <I>items</I> (only one of these items can be present in a single command unless otherwise noted):</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>algorithm</B> <I>algorithm</I></P></TD><TD VALIGN="TOP">Specifies a video compression algorithm for use by a subsequent <B>reserve</B> or <B>record</B> command. Algorithms support by a device are device specific. MCI defines the constants <B>mpeg</B> and <B>h261</B> for <I>algorithm</I>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">If the specified algorithm conflicts with the current file format, the file format is changed to the default format for the algorithm.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>bitsperpel to </B><I>count</I></P></TD><TD VALIGN="TOP">Sets the number of bits-per-pixel for saving data with <B>capture</B> or <B>record</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>brightness</B> <B>to </B><I>factor</I></P></TD><TD VALIGN="TOP">Sets the video brightness level.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>clocktime</B></P></TD><TD VALIGN="TOP">Indicates that the time specified in the <B>over</B> parameter is in milliseconds. The time is absolute and not in step with the playing of the workspace.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>color</B> <B>to </B><I>factor</I></P></TD><TD VALIGN="TOP">Sets the color-saturation level.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>contrast to</B> <I>factor</I></P></TD><TD VALIGN="TOP">Sets the video-contrast level.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>gamma to </B><I>value</I></P></TD><TD VALIGN="TOP">Specifies the gamma correction exponent multiplied by 1000. For example, to specify an exponent of 2.2, use 2200 for <I>value</I>. A gamma value of 1.0 (1000) indicates no gamma correction is applied. Gamma correction adjusts the mapping between the intensity encoded in the presentation source and the displayed brightness.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>input</B></P></TD><TD VALIGN="TOP">Modifies the <B>brightness</B>,<B> color</B>,<B> contrast</B>,<B> gamma</B>,<B> sharpness</B>, or<B> tint</B> flag so that it affects the input signal and modifies what is recorded. If possible, this is the default when monitoring the input.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>key color</B> <B>to </B><I>r:g:b</I></P></TD><TD VALIGN="TOP">Sets the key color. The <I>r:g:b </I>parameter<B><I> </I></B>is a Windows RGB value. Colons (:) separate the individual red, green, and blue values.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>key index to</B> <I>index</I></P></TD><TD VALIGN="TOP">Sets the key index. The <I>index</I><B><I> </I></B>parameter is a physical palette index.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>off</B></P>
<B>on</B></P></TD><TD VALIGN="TOP">Enables<B> or disables display of video.  </B>Disabling video sets the pixels in the <B>put</B> <B>destination</B> rectangle (or its default, the client region of the current window) to a solid color. It has no effect on the frame buffer </P>
The video source, whether the workspace or an external input, might continue to store new images in the frame buffer. They are not displayed until video is enabled. If desired, you can use the <B>window</B> <B>state</B> command to hide the window. The default is <B>setvideo on</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>output</B></P></TD><TD VALIGN="TOP">Modifies the <B>brightness</B>,<B> color</B>,<B> contrast</B>,<B> gamma</B>,<B> sharpness</B>, or<B> tint</B> flag so that it modifies only the displayed signal and not what is recorded. If possible, this is the default when monitoring file.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>over</B> <I>duration</I></P></TD><TD VALIGN="TOP">Specifies how long it should take to make a change that uses a <I>factor </I>parameter. The units for <I>duration</I> are in the current time format. Changes occur in step with the playing of workspace. When playing is suspended, the change is also suspended until the play continues. If <B>over</B> is not used or not supported, the change occurs immediately. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>palette handle </B></P>
<B>to </B><I>handle</I></P></TD><TD VALIGN="TOP">Specifies the handle to a palette the device must use for rendering. This item is only supported by devices that use palettes. If <I>handle</I> is zero then the default palette is used. </P>
Digital-video devices should not free the palette passed with this command. Applications should free it after they close the device</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>quality </B><I>descriptor</I></P></TD><TD VALIGN="TOP">Specifies the characteristics of the video compression performed when video is recorded to a file. All devices support the three descriptors: <B>low</B>,<B> medium</B>,<B> </B>and <B>high</B>. The default is device specific. The significance of these names depends on the algorithm and the device. Devices might define additional descriptor names. The <B>quality</B> command can be used to define additional descriptor names. </P>
If the <B>algorithm</B> flag is not used, the <I>descriptor</I> applies to the current algorithm</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>record frame </B></P></TD><TD VALIGN="TOP">Sets the recording for motion video. The </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>rate to </B><I>rate</I><B> </B></P></TD><TD VALIGN="TOP">recording <I>rate</I> is specified in units of frames per second multiplied by 1000. For example, the NTSC frame rate of 29.97 frames per second is represented as 29970. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>record</B> <B>on</B></P>
<B>record</B> <B>off</B></P></TD><TD VALIGN="TOP">Enables or disables recording of video data. Recording video data is the default.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>sharpness to </B><I>factor</I></P></TD><TD VALIGN="TOP">Sets the video sharpness level.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>source to </B><I>source</I></P>
<B>number</B> <I>value</I></P></TD><TD VALIGN="TOP">Sets the source of the video input. This usually corresponds to external connectors. The constants defined for <I>source</I> include <B>rgb</B>, <B>pal</B>, <B>ntsc</B>, <B>svideo</B>, and <B>secam</B>. If more than one input of the specified type exists, the optional <B>number</B> <I>value</I> indicates the desired input. For example, <B>set source to ntsc number 2</B> specifies the second NTSC input.</P>
If <B>to </B><I>source</I> is omitted then the absolute source is used as defined by the <B>list video source</B> command.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>still</B> <B>algorithm </B></P>
<I>algorithm</I></P></TD><TD VALIGN="TOP">Specifies the still image compression algorithm used by the <B>capture</B> command. Every device must support an <I>algorithm</I> of <B>none</B>, which means no compression, and this is the default. In this case, digital video devices save still images as RGB format DIBs. Devices might also support a device-specific list of additional algorithms.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>still</B> <B>quality</B> </P></TD><TD VALIGN="TOP">Specifies the characteristics of the still</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><I>descriptor</I></P></TD><TD VALIGN="TOP">image compression performed while capturing a still image. All devices support the descriptors <B>low</B>,<B> medium</B>, and <B>high</B>. The default is device specific. The device developer must determine and document the significance of the descriptor names for each algorithm the device supports. A device might also define descriptor names in addition to those already defined.</P>
If the <B>algorithm</B> flag is not used, the <I>descriptor</I> applies to the current algorithm.</P>
The <B>quality</B> command can be used to define other descriptor names.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>stream</B> <B>to </B><I>number</I></P></TD><TD VALIGN="TOP">Specifies the video stream played back from the workspace. If the stream is not specified and a default stream is not defined by the file format, the physically first interleaved video stream is played. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>tint</B> <B>to</B><I> factor</I></P></TD><TD VALIGN="TOP">Sets the image tint. Typically, this adjustment is modeled after the tint control of many color television sets, with 250 meaning green, 750 meaning red, and 0 (or 1000) meaning blue. The nominal value is always 500.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>signal</B> <I>items</I></P></TD><TD VALIGN="TOP">Marks positions in the workspace. The signals are valid until another <B>signal</B> command moves or disables them, or the contents of the workspace change. Whenever data at a signal is presented (the device plays or steps to it), the device sends a Windows message to the application. The message identifies the device and a user value; optionally, it identifies the position. Although the window used for <B>notify</B> will receive the <B>signal</B> messages, the <B>signal</B> mechanism is entirely independent of the behavior of the <B>notify</B> and <B>wait</B> flags. </P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>at </B><I>position</I></P></TD><TD VALIGN="TOP">Specifies the location of the signal. The <I>position</I> value is in the current time format.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>cancel </B></P></TD><TD VALIGN="TOP">Removes signals from the workspace. An individual signal is specified using the <B>uservalue </B>flag. If the <B>uservalue</B> flag is not specified using <B>cancel</B>, the device cancels all signals. The <B>cancel </B>flag is incompatible with the <B>at</B>, <B>every</B>,<B> position</B>, and <B>return position</B> flags.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>every </B><I>interval</I></P></TD><TD VALIGN="TOP">Specifies the period of the signals. The <I>interval</I> value is specified in the current time format. </P>
If used with <B>at </B><I>position</I>, signals are placed throughout the workspace with one signal mark placed at <I>position</I>.</P>
Without the <B>at</B> flag, signals are places throughout the workspace with one signal at the current position.</P>
If this flag is omitted, only the position indicated by the <B>at</B> flag is marked.</P>
If the <I>interval</I> value is less than the minimum frequency supported by a device, it will use its minimum value.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>return position</B></P></TD><TD VALIGN="TOP">Indicates the device should send the position value instead of the <B>uservalue</B> ID in the signalling message. The <B>uservalue</B> ID can still be used to cancel or to redefine the signal marks.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>uservalue </B><I>id</I></P></TD><TD VALIGN="TOP">Specifies an ID that is reported back with the signaling message. This ID acts as an identifier that can be used with other <B>signal</B> commands to reference this <B>signal</B> setting. If omitted, the default value is zero.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>status</B> <I>item</I></P></TD><TD VALIGN="TOP">Returns status information about a device instance. One of the following <I>items</I> modifies <B>status</B>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio</B></P></TD><TD VALIGN="TOP">Returns <B>on</B> or <B>off</B> depending on the most recent <B>setaudio on</B> or <B>off</B> command. It returns <B>on</B> if either or both speakers are enabled, and <B>off</B> otherwise.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">audio alignment</P></TD><TD VALIGN="TOP">Returns the alignment of data blocks relative to the start of input waveform data.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio bitspersample</B></P></TD><TD VALIGN="TOP">Returns the number of bits per sample the device uses for recording. This flag applies only to devices supporting the <B>pcm</B> algorithm.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio bytespersec</B></P></TD><TD VALIGN="TOP">Returns the average number of bytes per second used for recording.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio</B> <B>input</B></P></TD><TD VALIGN="TOP">Returns the approximate instantaneous audio level of the analog input audio signal. A value greater than 1000 implies clipping distortion. Some devices can return this value only while recording audio. The value has no associated <B>set</B> or <B>setaudio</B> command. This value is related to, but normalized differently than, the <B>waveaudio</B> command <B>status</B> <B>level</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio</B> <B>record</B></P></TD><TD VALIGN="TOP">Returns <B>on</B> or <B>off</B>, reflecting the state set by <B>setaudio</B> <B>record</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio</B> <B>source</B></P></TD><TD VALIGN="TOP">Returns the current audio digitizer source: <B>left</B>, <B>right</B>, <B>average</B>, or <B>stereo</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio samplespersec</B></P></TD><TD VALIGN="TOP">Returns the number of samples per second recorded.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>audio stream</B></P></TD><TD VALIGN="TOP">Returns the current audio-stream number.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>bass</B></P></TD><TD VALIGN="TOP">Returns the current video-bass level.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>bitsperpel</B></P></TD><TD VALIGN="TOP">Returns the number of bits per pixel for saving captured or recorded data.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>brightness</B></P></TD><TD VALIGN="TOP">Returns the current video-brightness level.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>color</B></P></TD><TD VALIGN="TOP">Returns the current-color level.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>contrast</B></P></TD><TD VALIGN="TOP">Returns the current-contrast level.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>current</B> <B>track</B></P></TD><TD VALIGN="TOP">Typically returns 1.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>disk</B> <B>space</B> <I>drive</I></P></TD><TD VALIGN="TOP">Returns the approximate disk space that can be obtained by a <B>reserve</B> command for the specified disk <I>drive. </I>The space available is measured in units of the current time format. The <I>drive</I> is usually specified as a single letter or a single letter followed by a colon (:). However, some devices might use a path.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>file completion</B></P></TD><TD VALIGN="TOP">Returns the estimated percentage a <B>load</B>,<B> save</B>,<B> capture</B>,<B> cut</B>,<B> copy</B>,<B> delete</B>,<B> paste</B>, or <B>undo</B> operation has progressed. (Applications can use this to provide a visual indicator of progress.) This flag is not supported by all devices.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>file</B> <B>format</B> </P></TD><TD VALIGN="TOP">Returns the current file format for <B>record </B>or<B> save</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>file mode</B></P></TD><TD VALIGN="TOP">Returns <B>loading</B>,<B> saving</B>,<B> editing</B>, or <B>idle</B>. During a <B>load</B> operation, it returns <B>loading</B>. During <B>save</B> and <B>capture</B> operations, it returns <B>saving</B>. During <B>cut</B>,<B> copy</B>,<B> delete</B>, <B>paste</B>, or <B>undo</B> operations, it returns <B>editing</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>forward</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if the play direction is forward or if the device is not playing. Returns <B>false</B> otherwise.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>gamma</B></P></TD><TD VALIGN="TOP">Returns the value set with <B>setvideo gamma to</B><I> value.</I></P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>input</B></P></TD><TD VALIGN="TOP">Modifies the <B>bass</B>,<B> treble</B>,<B> volume</B>,<B> brightness</B>,<B> color</B>,<B> contrast</B>,<B> gamma</B>,<B> sharpness</B>, or<B> tint</B> flag so that it applies only to the input. This is the default when monitoring the input.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>left</B> <B>volume</B></P></TD><TD VALIGN="TOP">Returns the volume set for the left audio channel.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>length</B></P></TD><TD VALIGN="TOP">Returns the duration of the file in the workspace. The value returned is the length of the longest active stream. This is in units of the current time format. The flag returns zero if the workspace is empty.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>length</B> <B>track </B></P>
<I>TrackNo</I></P></TD><TD VALIGN="TOP">Returns the same value as <B>status length</B> if <I>TrackNo</I> is 1. Most devices reject this flag if <I>TrackNo</I> is not 1.</P>
</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>media present</B></P></TD><TD VALIGN="TOP">Returns <B>true</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>mode</B></P></TD><TD VALIGN="TOP">Returns the mode of the device: <B>not</B> <B>ready</B>, <B>paused</B>, <B>playing</B>, <B>recording</B>, or <B>stopped</B>. If it returns <B>not</B> <B>ready</B>, then retrying the command eventually returns one of the other values unless there is a hardware error. During a <B>record </B>operation, it returns <B>recording</B>. During a <B>step</B> or <B>play</B> operation, it returns <B>playing</B>. After a <B>cue</B> operation has completed, it returns <B>paused</B>. After a <B>stop</B> or <B>load</B> operation, and immediately after an <B>open</B> operation, it returns <B>stopped</B>. After a <B>seek</B>, <B>step</B>, <B>play</B>, or <B>record</B> operation it returns either <B>stopped</B> or <B>paused</B> depending on the device.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>monitor</B></P></TD><TD VALIGN="TOP">Returns <B>file</B> or <B>input</B>.<B> </B>The returned value indicates the current presentation source.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>monitor method</B></P></TD><TD VALIGN="TOP">Returns <B>pre</B>, <B>post</B>, or <B>direct</B>. The returned value indicates the method used for input monitoring.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>nominal</B></P></TD><TD VALIGN="TOP">The item modifies the <B>bass</B>, <B>brightness</B>, <B>color</B>, <B>contrast</B>, <B>gamma</B>, <B>sharpness</B>, <B>tint</B>, <B>treble,</B> and <B>volume</B> flags to return the nominal value instead of the current setting.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>nominal frame rate</B></P></TD><TD VALIGN="TOP">Returns the nominal frame rate associated with the file. The units are in frames per second multiplied by 1000.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>nominal record </B></P>
<B>frame rate</B></P></TD><TD VALIGN="TOP">Returns the nominal frame rate associated with the input video signal. The units are in frames per second multiplied by 1000.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>number of tracks</B></P></TD><TD VALIGN="TOP">Typically returns 1.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>output</B></P></TD><TD VALIGN="TOP">Modifies the <B>bass</B>,<B> treble</B>,<B> volume</B>,<B> brightness</B>,<B> color</B>,<B> contrast</B>,<B> gamma</B>,<B> sharpness</B>, or<B> tint</B> flag so that it applies only to the output. This is the default when monitoring file.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>palette handle</B></P></TD><TD VALIGN="TOP">Returns the palette handle used for display of motion video in the low-order word of the return value. This flag is supported only by devices that use palettes.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>pause mode</B></P></TD><TD VALIGN="TOP">Returns <B>recording</B> if the device is paused while recording. It returns <B>playing</B> if the device is paused while playing. It returns the error <B>Action not applicable in current mode</B> if the device is not paused.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>position</B></P></TD><TD VALIGN="TOP">Returns the current position in the workspace. This is in units of the current time format. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>position track</B> </P>
<I>TrackNo</I></P></TD><TD VALIGN="TOP">Returns the same value as status position if <I>TrackNo</I> is 1. Most devices reject this flag for other values for <I>TrackNo</I></P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>ready</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if this device instance is ready to accept another command. It returns <B>false</B> for a short interval immediately after initiating some commands, or in the case of a hardware error. The commands that cause a device to return <B>false</B> temporarily is device specific.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>record frame rate</B></P></TD><TD VALIGN="TOP">Returns the frame rate used for compression. This is in units of frames per second multiplied by 1000.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>reference</B> <I>frame</I></P></TD><TD VALIGN="TOP">Returns the frame number for the nearest key frame image that precedes the specified <I>frame</I>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>reserved size</B></P></TD><TD VALIGN="TOP">Returns the size of the reserved workspace. This value is in units of the current time format. The size corresponds to the approximate time it would take to play the compressed data from a full workspace. It returns zero if there is no reserved disk space. This flag returns the approximate size because the precise disk space for compressed data cannot, in general, be predicted until after the data has been compressed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>right</B> <B>volume</B></P></TD><TD VALIGN="TOP">Returns the volume set for the right audio channel.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>seek</B> <B>exactly</B></P></TD><TD VALIGN="TOP">Returns <B>on</B> or <B>off</B> indicating whether or not <B>seek</B> <B>exactly</B> is set.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>sharpness</B></P></TD><TD VALIGN="TOP">Returns the current sharpness level of the device.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>smpte</B></P></TD><TD VALIGN="TOP">Returns the SMPTE (Society of Motion Picture Engineers) time code associated with the current position in the workspace. This is a string with the form dd:dd:dd:dd, where each d denotes a digit from 0 to 9. If the workspace data does not include timecode data, then this flag returns 00:00:00:00. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>speed</B></P></TD><TD VALIGN="TOP">Returns the current playback speed in the same format used in <B>set speed</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>start position</B></P></TD><TD VALIGN="TOP">Returns the frame number for the first frame in the workspace. It is typically zero or one.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>still file format</B></P></TD><TD VALIGN="TOP">Returns the current file format for the <B>capture </B>command.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>time</B> <B>format</B></P></TD><TD VALIGN="TOP">Returns the current time format.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>tint</B></P></TD><TD VALIGN="TOP">Returns the current video-tint level.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>treble</B></P></TD><TD VALIGN="TOP">Returns the current audio-treble level.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>unsaved</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if there is recorded data in the workspace that might be lost as a result of a <B>close</B>, <B>load</B>, <B>record</B>, <B>reserve</B>, <B>cut</B>, <B>delete</B>, or <B>paste</B> command. Returns <B>false</B> otherwise.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video</B></P></TD><TD VALIGN="TOP">Returns <B>on</B> or <B>off</B>, reflecting the state set by <B>setvideo</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video key index</B></P></TD><TD VALIGN="TOP">Returns the value for the <B>key index</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video key color</B></P></TD><TD VALIGN="TOP">Returns the value for the <B>key color</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video</B> <B>record</B></P></TD><TD VALIGN="TOP">Returns <B>on</B> or <B>off</B>, reflecting the current state set by <B>setvideo</B> <B>record</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video source</B></P></TD><TD VALIGN="TOP">Returns the current video-source type.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video source </B></P>
<B>number</B></P></TD><TD VALIGN="TOP">Returns a number corresponding to the video source of the type in use. For example, <B>status video source number</B> returns 2 if the second NTSC <B>video source </B>input is being used.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video stream</B></P></TD><TD VALIGN="TOP">Returns the current video-stream number.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>volume</B></P></TD><TD VALIGN="TOP">Returns the average of the volume to the left and right speakers.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>window</B> <B>handle</B></P></TD><TD VALIGN="TOP">Returns the ASCII decimal value for the current window handle associated with this device instance.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>window visible</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if the window is not hidden.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>window minimized</B></P></TD><TD VALIGN="TOP">Returns <B>true</B> if the window is minimized.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>window maximized</B></P></TD><TD VALIGN="TOP">Return <B>true</B> if the window is maximized.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="366pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>step</B> <I>items</I></P></TD><TD VALIGN="TOP">Advances the position in the workspace. In addition to moving to a following image, this command selects the workspace as the presentation source, and stores the new image in the frame buffer for display. This command always operates on whole frames regardless of the current time format. The <B>step</B> command is not affected by the state of <B>seek exactly</B>. This command always functions as if <B>seek exactly</B> is <B>on</B>. A <B>step </B>command without any flags always advances to the next frame. Audio is muted during the step. After a <B>step</B> command, the mode of the device is the same as defined for <B>seek</B>. There might be device specific limitations on what other digital video instances can do during a step. This command is modified by the following <I>items</I>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>by</B> <I>frames</I></P></TD><TD VALIGN="TOP">Specifies the number of frames to advance before showing another image. The default value is one which steps to the next image. Any images between the current image and the target image are not stored in the frame buffer. The value of <I>frames</I> might be negative, in which case the <B>reverse</B> flag cannot be used. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>reverse</B></P></TD><TD VALIGN="TOP">Indicates the <B>step</B> is in the reverse direction.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>stop</B> <I>item</I></P></TD><TD VALIGN="TOP">Stops playing or recording motion video or audio. Stopping a device might free resources allowing other device instances to play or record. Unless this command includes the <B>hold</B> flag, the display might turn a solid color. If <B>stop</B> follows a <B>play notify</B>, the notification is aborted. This command supports the following optional <I>item</I>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>hold</B></P></TD><TD VALIGN="TOP">Prevents the release of resources required to redraw a still image on the screen. The frame buffer remains available for use in updating the display when, for example, the window is moved.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>undo</B></P></TD><TD VALIGN="TOP">Reverses the action taken by the most recent successful <B>copy</B>, <B>cut</B>, <B>delete</B>,<B> undo</B>, or <B>paste</B> command.</P></TD></TR><TR><TD VALIGN="TOP"><B>unfreeze</B> <I>item</I></P></TD><TD VALIGN="TOP">Enables the update of the frame buffer from the presentation source. The following optional <I>item</I> modifies <B>unfreeze</B>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>at</B> <I>rectangle</I></P></TD><TD VALIGN="TOP">Specifies a <I>rectangle</I> within the frame buffer whose pixels should have their lock mask bit turned off. If omitted, the rectangle defaults to the entire frame buffer. By using a sequence of <B>freeze</B> and <B>unfreeze</B> commands with different <I>rectangles</I>, arbitrary patterns of lock mask bits can be described. </P>
A <I>rectangle</I> consists of four integer values denoting the coordinates of the upper-left pixel and the width and height of the rectangle. Each integer is delimited by one or more spaces. The pixel origin is defined such that pixel (0,0) is in the upper-left corner of the client rectangle, frame buffer, or input depending on the specified region.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>update </B><I>items</I></P></TD><TD VALIGN="TOP">Repaints the current frame into the specified display context. When the application owns the window ( it has used <B>window handle</B> <I>hwnd)</I>, it must call <B>update</B> whenever the window must be painted; for example, when responding to a WM_PAINT message. The following <I>items</I> modify <B>update</B>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>at</B><I> rect</I></P></TD><TD VALIGN="TOP">Specifies the clipping rectangle relative to the client rectangle.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>hdc </B><I>hdc</I></P></TD><TD VALIGN="TOP">Specifies the handle of the display context to paint. If this parameter is not present then the device will render into the display context for the display window.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>paint</B></P></TD><TD VALIGN="TOP">An application uses the <B>paint</B> flag with <B>update</B> when it receives a WM_PAINT message intended for a display DC. A frame buffer device will usually paint the key color. A device that does not have a frame buffer may ignore <B>update</B> when the <B>paint</B> flag is used if it is currently playing because the display will be repainted during the play operation.</P>
If the <B>hdc</B> flag is used without <B>paint</B>, the device renders the current frame into the provided <I>hdc</I>. Device supporting this feature will render a full bitmap and not just update the key color.</P>
If both <B>hdc</B> and <B>paint</B> are omitted, the contents of the frame buffer of the video overlay device are refreshed. This is useful to show new live video data after an <B>unfreeze</B> is sent to the device from a <B>paused</B> state.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="366pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>where</B> <I>items</I></P></TD><TD VALIGN="TOP">Returns the rectangular region that has been previously specified (or defaulted) for the <B>put</B> command. The return string consists of four space separated integers that describe the X, Y coordinates of the upper left pixel, and the rectangle width and height. When the <B>max</B> flag is used, the command returns the maximum width and height of the region. The upper left pixel of the maximum region is always 0, 0. The following <I>items</I> modify <B>where</B>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>destination</B></P></TD><TD VALIGN="TOP">Returns a description of the rectangular region used to display video and images. This region is a portion of the client rectangle of the current window.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>destination max</B></P></TD><TD VALIGN="TOP">Returns the current size of the client window.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>frame</B></P></TD><TD VALIGN="TOP">Returns a description of the rectangular region of the frame buffer. Images from the <B>video</B> rectangle are scaled into this region.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>frame max</B></P></TD><TD VALIGN="TOP">Returns the maximum size of the frame buffer.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>source</B></P></TD><TD VALIGN="TOP">Returns a description of the rectangular region of the frame buffer used as the source of video images. The device uses this rectangle to crop the image before it is stretched to fit the <B>destination</B> rectangle on the display.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>source max</B></P></TD><TD VALIGN="TOP">Returns the maximum size of the frame buffer.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video</B></P></TD><TD VALIGN="TOP">Returns a description of the rectangular region of the presentation source used to fill the <B>frame</B> rectangle in the frame buffer.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>video max</B></P></TD><TD VALIGN="TOP">Returns the maximum size of the input.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>window</B></P></TD><TD VALIGN="TOP">Returns the current size and position of the display window frame. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>window max</B></P></TD><TD VALIGN="TOP">Returns the size of the entire display.</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="367pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>window</B> <I>items</I></P></TD><TD VALIGN="TOP">Changes attributes of the window used to display images or motion video. If a <B>window</B> command is not used, the default window created when the device instance was opened is used. The default window has a style defined or defaulted on the <B>open</B> command and is initially invisible. It is possible to change windows at any time by using the <B>window</B> command. The default window is not destroyed until the device instance is closed; it is also possible to switch back to it.</P>
If the current window is not visible and it is the default window, it becomes visible automatically whenever a <B>play</B> or <B>monitor</B> <B>input</B> command is used and when the state of <B>setvideo</B> is <B>on</B>. It is also possible to use the <B>window</B> <B>state</B> command to request the device to issue a <B>ShowWindow</B> call for the current window. The default window continues to show and play video when it is iconic.</P>
The following <I>items</I> modify <B>window</B>:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>handle</B> <I>hwnd</I></P></TD><TD VALIGN="TOP">Specifies a window to be used with this device-driver instance. The <I>hwnd</I> parameter contains the ASCII numeric equivalent of the window handle returned by the <B>CreateWindow </B>function. Two device instances can use the same window handle provided, that each instance updates the video and image pixels in the window as if the other instance did not exist. When video output is disabled with <B>setvideo off</B>, an <B>update</B> command will make the destination rectangle a solid color.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>handle</B> <B>default</B></P></TD><TD VALIGN="TOP">Specifies that the window associated with the device instance should be the default window created when it was opened. The default window has no owner unless a parent window is specified on <B>open</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>state</B> <I>ShowValue</I></P></TD><TD VALIGN="TOP">Executes the <B>ShowWindow</B> <BR>function for the current window. The following constants are defined for <I>ShowValue</I>:<I> <BR>    </I><B>hide<BR>    minimize<BR>    restore<BR>    show<BR>    show maximized<BR>    show</B> <B>minimized<BR>    show</B> <B>min</B> <B>noactive<BR>    show</B> <B>na<BR>    show</B> <B>noactivate<BR>    show</B> <B>normal</B></P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">For a description of the behavior of these options, see the description for the  <B>ShowWindow </B>function. In addition, the constants <B>no action</B> (for <B>show na</B>) and <B>minimized</B> (for <B>show</B> <B>minimized</B>) are also recognized.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"><B>text</B> <I>caption</I></P></TD><TD VALIGN="TOP">Specifies the text placed in the current title bar of the window. If this text contains embedded blanks, the entire caption must be enclosed in quotation marks. The default caption for the default window is blank.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
<P></P>
 </P>
</P></BODY></HTML>
