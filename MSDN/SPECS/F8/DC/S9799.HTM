<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MCI_SAVE</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
</OBJECT></FORM>
<H2>MCI_SAVE</H2>  </P>
This MCI command message saves the current file. Devices that modify files should not destroy the original copy until they receive this message. Support of this message by a device is optional.</P>
<P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="219pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Parameters</B> </P></TD><TD VALIGN="TOP">DWORD  <I>lParam1</I> </P></TD><TD VALIGN="TOP">The following flags apply to all devices supporting MCI_SAVE:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="97pt" VALIGN="TOP"><COL WIDTH="305pt" VALIGN="TOP"><COL WIDTH="10pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">MCI_NOTIFY</P></TD><TD VALIGN="TOP">Specifies that MCI should post the MM_MCINOTIFY message when this command completes. The window that receives this message is specified in the <B>dwCallback</B> field of the data structure identified by <I>lParam2</I>.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">MCI_TEST</P></TD><TD VALIGN="TOP">Queries the device to determine if it can execute the command. The device returns an error if it is incapable of executing the command. It returns no error if it can handle the command. MCI returns control to the application without executing the command.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">MCI_WAIT</P></TD><TD VALIGN="TOP">Specifies that the save operation should finish before MCI returns control to the application.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">MCI_SAVE_FILE</P></TD><TD VALIGN="TOP">Indicates the <B>lpstrFileName</B> field of the data structure identified by <I>lParam2</I> contains a pointer to a buffer containing the destination filename. If a path is not specified, the file is placed in the directory specified with MCI_RESERVE. If MCI_RESERVE has not been used, the device driver uses the drive and directory associated with the application's task as the default. Any path specified must be on the disk drive associated with the explicit or implied reserve. The filename is required.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">MCI_DGV_RECT</P></TD><TD VALIGN="TOP">Specifies that the <B>rc</B> field of the data structure identified by <I>lParam2</I> contains a valid rectangle. The rectangle specifies a region of the frame buffer that will be saved to the specified file. The first pair of coordinates specify the top, left corner of the rectangle and the second pair of coordinates specify the width and height of the rectangle. </P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">Digital-video devices must use the MCI_CAPTURE command to capture the contents of the frame buffer. Overlay devices should also use MCI_CAPTURE. This flag is for compatibility with the existing MCI overlay command set.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">MCI_DGV_SAVE_ABORT</P></TD><TD VALIGN="TOP">Stops a save operation in progress. This must be the only flag present.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">MCI_DGV_SAVE_KEEPRESERVE</P></TD><TD VALIGN="TOP">Indicates that unused disk space left over from the original MCI_RESERVE command is not deallocated.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">LPMCI_DGV_SAVE_PARMS  <I>lParam2</I> </P></TD><TD VALIGN="TOP">Specifies a far pointer to the <B>MCI_DGV_SAVE_PARMS</B> data structure.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"><B>Return Value</B> </P></TD><TD VALIGN="TOP">Returns zero if successful. Otherwise, it returns an MCI error code.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"><B>Comments</B> </P></TD><TD VALIGN="TOP">This command is supported by devices that return true to the MCI_GETDEVCAPS_CAN_SAVE query. For digital-video devices, MCI_CAPTURE is used to capture the contents of the frame buffer. Overlay devices can also use MCI_CAPTURE to save the frame buffer contents. </P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_SAVE makes a permanent copy of the workspace contents. Any unused disk space is deallocated from the reserve after this command. </P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">The current position is not affected by the progress of the save operation.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"><B>See Also</B> </P></TD><TD VALIGN="TOP">MCI_LOAD</P></TD><TD VALIGN="TOP"></P></TD></TR></TBODY></TABLE>
<BR></P> </P></BODY></HTML>
