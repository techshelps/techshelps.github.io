<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MCI_CAPTURE</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
</OBJECT></FORM>
<H2>MCI_CAPTURE</H2>  </P>
This MCI command message captures the contents of the frame buffer and stores it in a specified file.</P>
<B>Parameters</B>     DWORD  <I>lParam1</I>     The following flags apply to all devices supporting MCI_CAPTURE:</P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="149pt" VALIGN="TOP"><COL WIDTH="226pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">MCI_NOTIFY</P></TD><TD VALIGN="TOP">Specifies that MCI should post the MM_MCINOTIFY message when this command completes. The window that receives this message is specified in the <B>dwCallback</B> field of the data structure identified by <I>lParam2</I>.</P></TD></TR><TR><TD VALIGN="TOP">MCI_TEST</P></TD><TD VALIGN="TOP">Queries the device to determine if it can execute the command. The device returns an error if it is incapable of executing the command. It returns no error if it can handle the command. MCI returns control to the application without executing the command.</P></TD></TR><TR><TD VALIGN="TOP">MCI_WAIT</P></TD><TD VALIGN="TOP">Specifies that the capture operation should finish before MCI returns control to the application.</P></TD></TR><TR><TD VALIGN="TOP">MCI_DGV_CAPTURE_AS</P></TD><TD VALIGN="TOP">Indicates the <B>lpstrFileName</B> field of the data structure identified by <I>lParam2</I> contains a pointer to a buffer specifying the destination path and filename. (This flag is required.)</P></TD></TR><TR><TD VALIGN="TOP">MCI_DGV_CAPTURE_AT</P></TD><TD VALIGN="TOP">Specifies that the <B>rc</B> field of the data structure identified by <I>lParam2</I> contains a valid rectangle. The rectangle specifies the rectangular region within the frame buffer that is cropped and saved to disk. If omitted, the cropped region defaults to the rectangle specified or defaulted on a previous MCI_PUT command that specifies the source area for this instance of the device driver.</P></TD></TR></TBODY></TABLE>
<BR></P>LPMCI_DGV_CAPTURE_PARMS  <I>lParam2</I>     Specifies a far pointer to a <B>MCI_DGV_CAPTURE_PARMS</B> data structure.</P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="107pt" VALIGN="TOP"><COL WIDTH="270pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Return Value</B> </P></TD><TD VALIGN="TOP">Returns zero if successful. Otherwise, it returns an MCI error code.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comments</B> </P></TD><TD VALIGN="TOP">This command might fail if the device is currently playing motion video or executing some other resource-intensive operation. If the frame buffer is updated in real time, the update is momentarily paused so that a complete image is captured. Depending on the device, the pause for MCI_CAPTURE might cause visual or audible effects. The desired file format, compression algorithm, and quality level must be previously specified by the MCI_SET or MCI_SETVIDEO command, or allowed to default.</P></TD></TR></TBODY></TABLE>
<BR></P> </P></BODY></HTML>
