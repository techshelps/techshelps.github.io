<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MCI_STATUS</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
</OBJECT></FORM>
<H2>MCI_STATUS</H2>  </P>
This MCI command message is used to obtain information about an instance of an MCI device. All devices respond to this message. The parameters and flags available for this message depend on the selected device. Information is returned in the <B>dwReturn</B> field of the data structure identified by <I>lParam2</I>.</P>
<P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="257pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Parameters</B> </P></TD><TD VALIGN="TOP">DWORD  <I>lParam1</I> </P></TD><TD VALIGN="TOP">The following standard and command-specific flags apply to all devices:</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="329pt" VALIGN="TOP"><COL WIDTH="10pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">MCI_NOTIFY</P></TD><TD VALIGN="TOP">Specifies that MCI should post the MM_MCINOTIFY message when this command completes. The window that receives this message is specified in the <B>dwCallback</B> field of the data structure identified by <I>lParam2</I>.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">MCI_TEST</P></TD><TD VALIGN="TOP">Queries the device to determine if it can execute the command. The device returns an error if it is incapable of executing the command. It returns no error if it can handle the command. MCI returns control to the application without executing the command.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">MCI_WAIT</P></TD><TD VALIGN="TOP">Specifies that the status operation should finish before MCI returns control to the application.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">MCI_STATUS_ITEM</P></TD><TD VALIGN="TOP">Indicates the <B>dwItem</B> field of the data structure identified by <I>lParam2</I> contains a constant specifying which status item to obtain. The information about the status item is returned in the <B>dwReturn</B> field of the data structure. The following constants are defined to specify the status item:</P></TD><TD VALIGN="TOP"></P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="257pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_STATUS_CURRENT_TRACK</P></TD><TD VALIGN="TOP">The <B>dwReturn</B> field is set to the current track number. Digital-video devices typically return 1. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_STATUS_LENGTH</P></TD><TD VALIGN="TOP">The <B>dwReturn</B> field is set to the total media length. The value returned is the length of the longest active stream. (The length is measured in units of the current time format.) These devices return zero if the workspace is empty. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_STATUS_MODE</P></TD><TD VALIGN="TOP">The <B>dwReturn</B> field is set to the current mode of the device. The modes include the following:</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_MODE_NOT_READY—</P></TD><TD VALIGN="TOP">Specifies the device is not ready. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_MODE_PAUSE—</P></TD><TD VALIGN="TOP">Specifies the device is paused. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_MODE_PLAY—</P></TD><TD VALIGN="TOP">Specifies the device is playing. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_MODE_STOP—</P></TD><TD VALIGN="TOP">Specifies the device is stopped. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_MODE_OPEN—</P></TD><TD VALIGN="TOP">Specifies the device is open. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_MODE_RECORD—</P></TD><TD VALIGN="TOP">Specifies the device is recording. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_MODE_SEEK—</P></TD><TD VALIGN="TOP">Specifies the device is seeking. </P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="329pt" VALIGN="TOP"><COL WIDTH="10pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">If a digital-video device returns not ready, then retrying the command eventually returns one of the other values unless there is a hardware error. During a record or save, the command returns recording or saving respectively. During a step or play, the command returns playing. After a cue has completed, it returns paused. After a step, play, or record has completed, the mode is either stopped or paused depending on the implementation. After a stop or load, and immediately after an open it returns stopped. Digital-video devices do not return open. </P></TD><TD VALIGN="TOP"></P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="257pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_STATUS_NUMBER_OF_TRACKS</P></TD><TD VALIGN="TOP">The <B>dwReturn</B> field is set to the total number of playable tracks. Digital-video devices typically return 1. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_STATUS_POSITION</P></TD><TD VALIGN="TOP">The <B>dwReturn</B> field is set to the current position in the current time format units. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_STATUS_READY</P></TD><TD VALIGN="TOP">The <B>dwReturn</B> field is set to TRUE if the device will accept another command; otherwise, it is set to FALSE. Digital-video devices might return FALSE when a hardware error occurs or for a short interval immediately after initiating some commands. The set of commands that cause a temporary not ready status is device specific. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_STATUS_TIME_FORMAT</P></TD><TD VALIGN="TOP">The <B>dwReturn</B> field is set to the current time format of the device. The time formats include:</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_FORMAT_FRAMES</P></TD><TD VALIGN="TOP">Specifies frames as the time format. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">MCI_FORMAT_MILLISECONDS</P></TD><TD VALIGN="TOP">Specifies milliseconds as the time format. </P></TD></TR></TBODY></TABLE>
<BR></P><P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="329pt" VALIGN="TOP"><COL WIDTH="10pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">All digital-video devices support the frame format. Devices can return other time formats that apply to the device.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">MCI_STATUS_START</P></TD><TD VALIGN="TOP">Obtains the starting position of the media. To get the starting position, combine this flag with MCI_STATUS_ITEM and set the <B>dwItem</B> field of the data structure identified by <I>lParam2</I> to MCI_STATUS_POSITION. Digital-video devices return the frame number for the first frame in the workspace. It is typically zero or one.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">MCI_TRACK</P></TD><TD VALIGN="TOP">Indicates a status track parameter is included in the <B>dwTrack</B> field of the data structure identified by <I>lParam2</I>. You must use this flag with the MCI_STATUS_POSITION or MCI_STATUS_LENGTH constant. Digital-video devices typically have one track. </P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">When used with MCI_STATUS_POSITION, MCI_TRACK obtains the starting position of the specified track. For digital-video devices, this command is typically rejected unless one is specified for the track number. In this case it returns the starting position within the track. (This is the same as returned for the MCI_STATUS_START flag.)</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">When used with MCI_STATUS_LENGTH, MCI_TRACK obtains the length of the specified track. MCI uses continuous track numbers. For digital-video devices, this command is typically rejected unless one is specified for the track number. This combination returns the same value as MCI_STATUS_LENGTH.</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">LPMCI_DGV_STATUS_PARMS  <I>lParam2</I> </P></TD><TD VALIGN="TOP">Specifies a far pointer to the <B>MCI_DGV_STATUS_PARMS</B> data structure. (Devices with extended command sets might replace this data structure with a device-specific data structure.)</P></TD><TD VALIGN="TOP"></P></TD></TR></TBODY></TABLE>
<BR></P> </P></BODY></HTML>
