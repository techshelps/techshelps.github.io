<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>EndAccess</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H2>EndAccess</H2>  </P>
Called by the DCI client after each access to the surface specified by the lpSurface parameter.  It is provided for the DCI provider in order to perform any tasks which may be required after access to the surface. </P>
<B>DCIRVAL CALLBACK _loadds EndAccess(</B><I>lpSurface</I><B>)</B></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="172pt" VALIGN="TOP"><COL WIDTH="280pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>LPVOID</B></P></TD><TD VALIGN="TOP"><I>lpSurface</I>;</P></TD></TR></TBODY></TABLE>
<BR></P><A NAME="PT2"></A>INPUT PARAMETERS</P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="172pt" VALIGN="TOP"><COL WIDTH="280pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><I>lpSurface</I></P></TD><TD VALIGN="TOP">Specifies a far pointer to a <B>DCISURFACEINFO</B> structure that was previously obtained via a <B>DCIDCREATEPRIMARYSURFACE</B>, <B>DCICREATEOFFSCREENSURFACE</B>, or <B>DCICREATEOVERLAYSURFACE</B> escape.</P></TD></TR></TBODY></TABLE>
<BR></P><A NAME="PT3"></A>RETURNS</P>
Returns DCI_OK on success, or an error code on failure.  DCI error codes are listed in Chapter 2 of the DCI Specification.</P>
<A NAME="PT4"></A>COMMENTS</P>
<B>BeginAccess</B> and <B>EndAccess</B> are called as a framework around every set of accesses to the display buffer.  The DCI Client must not access surface memory before a <B>BeginAccess</B> or after an <B>EndAccess</B>.</P>
The DCI Client is encouraged to minimize processing time between <B>BeginAccess/EndAccess</B>.  Similarly the DCI Provider is encouraged to optimize the speed of these calls so that the DCI Client does not incur a stiff penalty on each direct access of a surface.  It is valid to return NULL pointers if no action need be taken by the DCI Provider.  </P>
  </P>
<B>Note</B>   It is valid to return NULL pointers if no action need be taken by the DCI Provider.  </P>
  </P>
The DCI Provider must manage the mouse cursor during surface accesses.  The DCI Client will provide the bounding rectangle of the area that will be accessed.  The DCI Provider must exclude the cursor at <B>BeginAccess</B>, if the mouse cursor is within this area.  At <B>EndAccess</B>, the DCI Provider must turn the mouse back on, if it was previously excluded.</P>
 </P></BODY></HTML>
