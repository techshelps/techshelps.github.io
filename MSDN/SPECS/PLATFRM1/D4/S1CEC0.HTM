<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>4.4. Plug and Play Isolation Sequence</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>4.4. Plug and Play Isolation Sequence</H3>  </P>
On power up, all Plug and Play cards detect RESET_DRV, set their CSN to 0, and enter the <B><I>Wait for Key</I></B> state.  There is a required 2 msec delay from either a RESET_DRV or ResetCmd to any Plug and Play port access to allow a card to load initial configuration information from a non-volatile device. </P>
Cards in the <B><I>Wait for Key </I></B>state do not respond to any access to their auto-configuration ports until the initiation key is detected.  Cards ignore all ISA accesses to their Plug and Play interface.</P>
When the cards have received the initiation key, they enter the <B><I>Sleep</I></B> state.  In this state, the cards listen for a Wake[CSN] command with the write data set to 0x00.  This Wake[CSN] command will send all cards to the <B><I>Isolation</I></B> state and reset the serial identifier/resource data pointer to the beginning.  </P>
The first time the cards enter the <B><I>Isolation</I></B> state it is necessary to set the READ_DATA port address using the Set RD_DATA port command.</P>
Next, 72 pairs of reads are performed to the Serial Isolation register to isolate a card as described previously.  If the checksum read from the card is valid, then this means one card has been isolated.  The isolated card remains in the <B><I>Isolation</I></B> state while all other cards have failed the isolation protocol and have returned to the <B><I>Sleep</I></B> state.  The CSN on this card is set to a unique number.  Writing this value causes this card to transition to the <B><I>Config</I></B> state.  Sending a Wake[0] command causes this card to transition back to <B><I>Sleep</I></B> state and all cards with a CSN value of zero to transition to the <B><I>Isolation </I></B>state.  This entire process is repeated until no Plug and Play cards are detected.</P>
If a conflict is detected on the READ_DATA port, a Wake[0] command is issued to cause all the cards that are in <B><I>Isolation</I></B> state to reset their serial identifier/data pointer to the beginning while remaining in the <B><I>Isolation</I></B> state. Further, after a read port conflict has been detected and a Wake[0] has been issued, the software must wait 1 msec before beginning the next 72 pairs of serial isolation read cycles.</P>
 </P></BODY></HTML>
