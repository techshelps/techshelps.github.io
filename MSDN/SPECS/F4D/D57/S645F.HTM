<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>EBDT - Embedded Bitmap Data Table</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
</OBJECT></FORM>
<H3>EBDT - Embedded Bitmap Data Table</H3>Three new tables are used to embed bitmaps in TrueType fonts. They are the 'EBLC' table for embedded bitmap locators, the 'EBDT' table for embedded bitmap data, and the 'EBSC' table for embedded bitmap scaling information.</P>
TrueType embedded bitmaps are also called 'sbits' (for "scaler bitmaps"). A set of bitmaps for a face at a given size is called a strike.</P>
The 'EBLC' table identifies the sizes and glyph ranges of the sbits, and keeps offsets to glyph bitmap data in indexSubTables. The 'EBDT' table then stores the glyph bitmap data, in a number of different possible formats. Glyph metrics information may be stored in either the 'EBLC' or 'EBDT' table, depending upon the indexSubTable and glyph bitmap data formats. The 'EBSC' table identifies sizes that will be handled by scaling up or scaling down other sbit sizes.</P>
The 'EBDT' table uses the same format as Apple has defined for the QuickDraw GX 'bdat' table.</P>
The 'EBDT' table begins with a header containing simply the table version number.</P>

<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="75pt" VALIGN="TOP"><COL WIDTH="119pt" VALIGN="TOP"><COL WIDTH="220pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Type</P></TD><TD VALIGN="TOP"><P>Name</P></TD><TD VALIGN="TOP"><P>Description</P></TD></TR><TR><TD VALIGN="TOP"><P>FIXED</P></TD><TD VALIGN="TOP"><P>version</P></TD><TD VALIGN="TOP"><P>Initially defined as 0x00020000</P></TD></TR></TBODY></TABLE>
<BR></P>The rest of the 'EBDT' table is a simply a collection of bitmap data. The data can be in a number of possible formats, indicated by information in the 'EBLC' table. Some of the formats contain metric information plus image data, and other formats contain only the image data. Long word alignment is not required for these sub tables; byte alignment is sufficient. </P>
There are also two different formats for glyph metrics: big glyph metrics and small glyph metrics. Big glyph metrics define metrics information for both horizontal and vertical layouts. This is important in fonts (such as Kanji) where both types of layout may be used. Small glyph metrics define metrics information for one layout direction only. Which direction applies, horizontal or vertical, is determined by the 'flags' field in the bitmapSizeTable field of the 'EBLC' table.</P>
<H4><A NAME="sec0"></A>bigGlyphMetrics</H4>
<TABLE COLS="2" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="75pt" VALIGN="TOP"><COL WIDTH="119pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Type</P></TD><TD VALIGN="TOP"><P>Name</P></TD></TR><TR><TD VALIGN="TOP"><P>BYTE</P></TD><TD VALIGN="TOP"><P>height</P></TD></TR><TR><TD VALIGN="TOP"><P>BYTE</P></TD><TD VALIGN="TOP"><P>width</P></TD></TR><TR><TD VALIGN="TOP"><P>CHAR</P></TD><TD VALIGN="TOP"><P>horiBearingX</P></TD></TR><TR><TD VALIGN="TOP"><P>CHAR</P></TD><TD VALIGN="TOP"><P>horiBearingY</P></TD></TR><TR><TD VALIGN="TOP"><P>BYTE</P></TD><TD VALIGN="TOP"><P>horiAdvance</P></TD></TR><TR><TD VALIGN="TOP"><P>CHAR</P></TD><TD VALIGN="TOP"><P>vertBearingX</P></TD></TR><TR><TD VALIGN="TOP"><P>CHAR</P></TD><TD VALIGN="TOP"><P>vertBearingY</P></TD></TR><TR><TD VALIGN="TOP"><P>BYTE</P></TD><TD VALIGN="TOP"><P>vertAdvance</P></TD></TR></TBODY></TABLE>
<BR></P><H4><A NAME="sec1"></A>smallGlyphMetrics</H4>
<TABLE COLS="2" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="75pt" VALIGN="TOP"><COL WIDTH="119pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Type</P></TD><TD VALIGN="TOP"><P>Name</P></TD></TR><TR><TD VALIGN="TOP"><P>BYTE</P></TD><TD VALIGN="TOP"><P>height</P></TD></TR><TR><TD VALIGN="TOP"><P>BYTE</P></TD><TD VALIGN="TOP"><P>width</P></TD></TR><TR><TD VALIGN="TOP"><P>CHAR</P></TD><TD VALIGN="TOP"><P>BearingX</P></TD></TR><TR><TD VALIGN="TOP"><P>CHAR</P></TD><TD VALIGN="TOP"><P>BearingY</P></TD></TR><TR><TD VALIGN="TOP"><P>BYTE</P></TD><TD VALIGN="TOP"><P>Advance</P></TD></TR></TBODY></TABLE>
<BR></P>The nine different formats currently defined for glyph bitmap data are listed and described below. Different formats are better for different purposes. Apple 'bdat' tables support only formats 1 through 7.</P>
<H4><A NAME="sec2"></A>Format 1: small metrics, byte-aligned data</H4>
<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="103pt" VALIGN="TOP"><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="220pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Type</P></TD><TD VALIGN="TOP"><P>Name</P></TD><TD VALIGN="TOP"><P>Description</P></TD></TR><TR><TD VALIGN="TOP"><P>smallGlyphMetrics</P></TD><TD VALIGN="TOP"><P>smallMetrics</P></TD><TD VALIGN="TOP"><P>Metrics information for the glyph</P></TD></TR><TR><TD VALIGN="TOP"><P>VARIABLE</P></TD><TD VALIGN="TOP"><P>image data</P></TD><TD VALIGN="TOP"><P>Byte-aligned bitmap data</P></TD></TR></TBODY></TABLE>
<BR></P>Glyph bitmap format 1 consists of small metrics records (either horizontal or vertical depending on the bitmapSizeTable 'flag' value in the 'EBLC' table) followed by byte aligned bitmap data. The bitmap data begins with the most significant bit of the first byte corresponding to the top-left pixel of the bounding box, proceeding through succeeding bits moving left to right. The data for each row is padded to a byte boundary, so the next row begins with the most significant bit of a new byte. 1 bits correspond to black, and 0 bits to white.</P>
<H4><A NAME="sec3"></A>Format 2: small metrics, bit-aligned data</H4>
<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="107pt" VALIGN="TOP"><COL WIDTH="86pt" VALIGN="TOP"><COL WIDTH="220pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Type</P></TD><TD VALIGN="TOP"><P>Name</P></TD><TD VALIGN="TOP"><P>Description</P></TD></TR><TR><TD VALIGN="TOP"><P>smallGlyphMetrics</P></TD><TD VALIGN="TOP"><P>small Metrics</P></TD><TD VALIGN="TOP"><P>Metrics information for the glyph</P></TD></TR><TR><TD VALIGN="TOP"><P>VARIABLE</P></TD><TD VALIGN="TOP"><P>image data</P></TD><TD VALIGN="TOP"><P>Bit-aligned bitmap data</P></TD></TR></TBODY></TABLE>
<BR></P>Glyph bitmap format 2 is the same as format 1 except that the bitmap data is bit aligned. This means that the data for a new row will begin with the bit immediately following the last bit of the previous row. The start of each glyph must be byte aligned, so the last row of a glyph may require padding. This format takes a little more time to parse, but saves file space compared to format 1.</P>
<H4><A NAME="sec4"></A>Format 3: (obsolete)</H4><H4><A NAME="sec5"></A>Format 4: (not supported) metrics in EBLC, compressed data</H4>Glyph bitmap format 4 is a compressed format used by Apple in some of their Far East fonts. MS has not implemented it in our rasterizer.</P>
<H4><A NAME="sec6"></A>Format 5: metrics in EBLC, bit-aligned image data only</H4>
<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="75pt" VALIGN="TOP"><COL WIDTH="119pt" VALIGN="TOP"><COL WIDTH="220pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Type</P></TD><TD VALIGN="TOP"><P>Name</P></TD><TD VALIGN="TOP"><P>Description</P></TD></TR><TR><TD VALIGN="TOP"><P>VARIABLE</P></TD><TD VALIGN="TOP"><P>image data</P></TD><TD VALIGN="TOP"><P>Bit-aligned bitmap data</P></TD></TR></TBODY></TABLE>
<BR></P>Glyph bitmap format 5 is similar to format 2 except that no metrics information is included, just the bit aligned data. This format is for use with 'EBLC' indexSubTable format 2 or format 5, which will contain the metrics information for all glyphs. It works well for Kanji fonts.</P>
The rasterizer recalculates sbit metrics for Format 5 bitmap data, allowing Windows to report correct ABC widths, even if the bitmaps have white space on either side of the bitmap image. This allows fonts to store monospaced bitmap glyphs in the efficient Format 5 without breaking Windows GetABCWidths call.</P>
<H4><A NAME="sec7"></A>Format 6: big metrics, byte-aligned data</H4>
<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="89pt" VALIGN="TOP"><COL WIDTH="104pt" VALIGN="TOP"><COL WIDTH="220pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Type</P></TD><TD VALIGN="TOP"><P>Name</P></TD><TD VALIGN="TOP"><P>Description</P></TD></TR><TR><TD VALIGN="TOP"><P>bigGlyphMetrics</P></TD><TD VALIGN="TOP"><P>bigMetrics</P></TD><TD VALIGN="TOP"><P>Metrics information for the glyph</P></TD></TR><TR><TD VALIGN="TOP"><P>VARIABLE</P></TD><TD VALIGN="TOP"><P>image data</P></TD><TD VALIGN="TOP"><P>Byte-aligned bitmap data</P></TD></TR></TBODY></TABLE>
<BR></P>Glyph bitmap format 6 is the same as format 1 except that is uses big glyph metrics instead of small.</P>
<H4><A NAME="sec8"></A>Format 7: big metrics, bit-aligned data</H4>
<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="94pt" VALIGN="TOP"><COL WIDTH="103pt" VALIGN="TOP"><COL WIDTH="216pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Type</P></TD><TD VALIGN="TOP"><P>Name</P></TD><TD VALIGN="TOP"><P>Description</P></TD></TR><TR><TD VALIGN="TOP"><P>bigGlyphMetrics</P></TD><TD VALIGN="TOP"><P>bigMetrics</P></TD><TD VALIGN="TOP"><P>Metrics information for the glyph</P></TD></TR><TR><TD VALIGN="TOP"><P>VARIABLE</P></TD><TD VALIGN="TOP"><P>image data</P></TD><TD VALIGN="TOP"><P>Bit-aligned bitmap data</P></TD></TR></TBODY></TABLE>
<BR></P>Glyph bitmap format 7 is the same as format 2 except that is uses big glyph metrics instead of small.</P>
<H4><A NAME="sec9"></A>ebdtComponent; array used by Formats 8 and 9</H4>
<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="98pt" VALIGN="TOP"><COL WIDTH="103pt" VALIGN="TOP"><COL WIDTH="212pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Type</P></TD><TD VALIGN="TOP"><P>Name</P></TD><TD VALIGN="TOP"><P>Description</P></TD></TR><TR><TD VALIGN="TOP"><P>USHORT</P></TD><TD VALIGN="TOP"><P>glyphCode</P></TD><TD VALIGN="TOP"><P>Component glyph code</P></TD></TR><TR><TD VALIGN="TOP"><P>CHAR</P></TD><TD VALIGN="TOP"><P>xOffset</P></TD><TD VALIGN="TOP"><P>Position of component left</P></TD></TR><TR><TD VALIGN="TOP"><P>CHAR</P></TD><TD VALIGN="TOP"><P>yOffset</P></TD><TD VALIGN="TOP"><P>Position of component top</P></TD></TR></TBODY></TABLE>
<BR></P>The component array, used by Formats 8 and 9, contains the glyph code of the component, which can be looked up in the 'EBLC' table, as well as xOffset and yOffset values which tell where to position the top-left corner of the component in the composite. Nested composites (a composite of composites) are allowed, and the number of nesting levels is determined by implementation stack space.</P>
<H4><A NAME="sec10"></A>Format 8: small metrics, component data</H4>
<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="103pt" VALIGN="TOP"><COL WIDTH="106pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Type</P></TD><TD VALIGN="TOP"><P>Name</P></TD><TD VALIGN="TOP"><P>Description</P></TD></TR><TR><TD VALIGN="TOP"><P>smallGlyphMetrics</P></TD><TD VALIGN="TOP"><P>smallMetrics</P></TD><TD VALIGN="TOP"><P>Metrics information for the glyph</P></TD></TR><TR><TD VALIGN="TOP"><P>BYTE</P></TD><TD VALIGN="TOP"><P>pad</P></TD><TD VALIGN="TOP"><P>Pad to short boundary</P></TD></TR><TR><TD VALIGN="TOP"><P>USHORT</P></TD><TD VALIGN="TOP"><P>numComponents</P></TD><TD VALIGN="TOP"><P>Number of components</P></TD></TR><TR><TD VALIGN="TOP"><P>ebdtComponent</P></TD><TD VALIGN="TOP"><P>componentArray[n]</P></TD><TD VALIGN="TOP"><P>Glyph code, offset array</P></TD></TR></TBODY></TABLE>
<BR></P><H4><A NAME="sec11"></A>Format 9: big metrics, component data</H4>
<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="94pt" VALIGN="TOP"><COL WIDTH="103pt" VALIGN="TOP"><COL WIDTH="216pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Type</P></TD><TD VALIGN="TOP"><P>Name</P></TD><TD VALIGN="TOP"><P>Description</P></TD></TR><TR><TD VALIGN="TOP"><P>bigGlyphMetrics</P></TD><TD VALIGN="TOP"><P>bigMetrics</P></TD><TD VALIGN="TOP"><P>Metrics information for the glyph</P></TD></TR><TR><TD VALIGN="TOP"><P>USHORT</P></TD><TD VALIGN="TOP"><P>numComponents</P></TD><TD VALIGN="TOP"><P>Number of components</P></TD></TR><TR><TD VALIGN="TOP"><P>ebdtComponent</P></TD><TD VALIGN="TOP"><P>componentArray[n]</P></TD><TD VALIGN="TOP"><P>Glyph code, offset array</P></TD></TR></TBODY></TABLE>
<BR></P>Glyph bitmap formats 8 and 9 are used for composite bitmaps. For accented characters and other composite glyphs it may be more efficient to store a copy of each component separately, and then use a composite description to construct the finished glyph. The composite formats allow for any number of components, and allow the components to be positioned anywhere in the finished glyph. Format 8 uses small metrics, and format 9 uses big metrics.</P></BODY></HTML>
