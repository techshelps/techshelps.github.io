<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The scan converter</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
</OBJECT></FORM>
<H2>The scan converter</H2>The TrueType scan converter takes an outline description of a glyph and produces a bitmap image for that glyph. </P>
The TrueType scan converter offers two modes. In the first mode, the scan converter uses a simple algorithm for determining which pixels are part of that glyph. The rules can be stated as follows:</P>
Rule 1</P>
<I>If a pixel's center falls within the glyph outline, that pixel is turned on and becomes part of that glyph.</I> </P>
Rule 2</P>
<I>If a contour falls exactly on a pixel's center, that pixel is turned on.</I> </P>
A point is considered to be an interior point of a glyph if it has a non-zero winding number. The winding number is itself determined by drawing a ray from the point in question toward infinity. (The direction in which the ray points in unimportant.) Starting with a count of zero, we subtract one each time a glyph contour crosses the ray from right to left or bottom to top. Such a crossing is termed an on transition. We add one each time a contour of the glyph crossed the ray from left to right or top to bottom. Such a crossing is termed an off transition. If the final count is non-zero, the point is an interior point. </P>
The direction of a contour can be determined by looking at the point numbers. The direction is always from lower point number toward higher point number. </P>
The illustration that follows demonstrates the use of winding numbers in determining whether a point is inside a glyph. The point p1 undergoes a sequence of four transitions (<I>on </I>transition,<I> off </I>transition, <I>on </I>transition, <I>off </I>transition). Since the sequence is even, the winding number is zero and the point is not inside the glyph. The second point, p2, undergoes an <I>off </I>transition followed by an <I>on </I>transition followed by an <I>off </I>transition yielding a winding number of +1. The point is in the interior of the glyph.</P>
<P>Figure 1-14   Determining the winding number of a point</P>
<P><img src="13494.gif"></P>
<H3><A NAME="sec0"></A>What is a dropout?</H3>A dropout occurs whenever there is a connected region of a glyph interior that contains two black pixels that cannot be connected by a straight line that only passes through black pixels. </P>
<P>Figure 1-15   The letter m with two dropouts</P>
<P><img src="13495.gif"></P>
<H3><A NAME="sec1"></A>Preventing dropouts</H3>The TrueType instructions are designed to allow you to gridfit a glyph so that the desired pixels will be turned on by the simple scan converter regardless of the point size or the transformation used. It may prove difficult to foresee all possible transformations that a glyph might undergo. It is therefore difficult to instruct a glyph to ensure that the proper grid-fitting distortion of the outline will take place for every desired transformation. This problem is especially difficult for very small numbers of pixels per em and for complex typefaces. In these situations, some renditions of a glyph may contain dropouts.</P>
It is possible to test for potential dropouts by looking at an imaginary line segment connecting two adjacent pixel centers. If this line segment is intersected by both an on-Transition contour and an off-Transition contour, a potential dropout condition exists. The potential dropout only becomes an actual dropout if the two contour lines continue on in both directions to cut other line segments between adjacent pixel centers. If the two contours join together immediately after crossing a scan line (forming a stub), a dropout does not occur, although a stem of the glyph may become shorter than desired.</P>
To prevent dropouts, type manufacturers can choose to have the scan converter use two additional rules:</P>
Rule 3</P>
<I>If a scan line between two adjacent pixel centers (either vertical or horizontal)  is intersected by both an on-Transition contour and an off-Transition contour and neither of the pixels was already turned on by rules 1 and 2, turn on the left-most pixel (horizontal scan line) or the bottom-most pixel (vertical scan line)</I> </P>
Rule 4</P>
<I>Apply Rule 3 only if the two contours continue to intersect other scan lines in both directions. That is do not turn on pixels for 'stubs'. The scanline segments that form a square with the intersected scan line segment are examined to verify that they are intersected by two contours.  It is possible that these could be different contours than the ones intersecting the dropout scan line segment.  This is very unlikely but may have to be controlled with grid-fitting in some exotic glyphs.</I></P>
The type manufacturer can choose to use the simple scan converter employing rules 1 and 2 only or may optionally invoke either rule 3 or rule 4. The decision about which scan converter to use can be made on a font wide basis or a different choice can be specified for each glyph. The selection made in the preProgram will be the default for the entire font. A change made to the default in the instructions for an individual glyph will apply only to that glyph. </P></BODY></HTML>
