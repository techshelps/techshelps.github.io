<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The Vertical Metrics Table</TITLE>

<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">


<H2>vmtx - Vertical Metrics Table
</H2>
<P>
The vertical metrics table allows you to specify the vertical spacing for each glyph in a vertical font. This table consists of either one or two arrays that contain metric information (the advance heights and top sidebearings) for the vertical layout of each of the glyphs in the font. The
vertical metrics coordinate system is shown below.


<BR>&nbsp;<BR>
<CENTER>
<TABLE CELLPADDING=10 BGCOLOR=#F0F0F0><TR><TD>
<IMG  WIDTH=265 HEIGHT=136 ALT="DIAGRAM" SRC="IMG00287.GIF"><BR>
</TABLE>
</CENTER>
<BR>

<P>
OpenType vertical fonts require both a vertical
header table ('vhea') and the vertical
metrics table discussed below. The vertical header table contains
information that is general to the font as a whole. The vertical
metrics table contains information that pertains to specific glyphs.
The formats of these tables are similar to those for horizontal
metrics (hhea and hmtx).
<P><BR><H4>Vertical Metrics Table Format
</H4>
<P>
The overall structure of the vertical metrics
table consists of two arrays shown below: the vMetrics array followed
by an array of top side bearings.
<P>
This table does not have a header, but does
require that the number of glyphs included in the two arrays equals
the total number of glyphs in the font.
<P>
The number of entries in the vMetrics array
is determined by the value of the numOfLongVerMetrics field of
the vertical header table.
<P>
The vMetrics array contains two values for
each entry. These are the advance height and the top sidebearing
for each glyph included in the array.
<P>
In monospaced fonts, such as Courier or Kanji, all glyphs have
the same advance height. If the font is monospaced, only one entry
need be in the first array, but that one entry is required.
<P>
The format of an entry in the vertical metrics array is given
below.

<TABLE WIDTH=460 BGCOLOR="#F0F0F0">
<THEAD>
<TR>
<TH BGCOLOR="#C0C0C0">Type</TH><TH BGCOLOR="#C0C0C0">Name</TH>
<TH BGCOLOR="#C0C0C0">Description</TH></TR>
</THEAD><TBODY>
<TR>
<TD VALIGN=TOP>USHORT</TD><TD VALIGN=TOP>advanceHeight</TD>
<TD VALIGN=TOP>The advance height of the glyph. Unsigned integer in FUnits
</TR>
<TR>
<TD VALIGN=TOP>SHORT</TD><TD VALIGN=TOP>topSideBearing</TD>
<TD VALIGN=TOP>The top sidebearing of the glyph. <BR>Signed integer in FUnits.
</TD></TR>
</TABLE>&nbsp;&nbsp;<P>
<P>
The second array is optional and generally
is used for a run of monospaced glyphs in the font. Only one such
run is allowed per font, and it must be located at the end of
the font. This array contains the top sidebearings of glyphs not
represented in the first array, and all the glyphs in this array
must have the same advance height as the last entry in the vMetrics
array. All entries in this array are therefore monospaced.
<P>
The number of entries in this array is calculated by subtracting
the value of numOfLongVerMetrics from the number of glyphs in
the font. The sum of glyphs represented in the first array plus
the glyphs represented in the second array therefore equals the
number of glyphs in the font. The format of the top sidebearing
array is given below.

<TABLE WIDTH=460 BGCOLOR="#F0F0F0">
<THEAD>
<TR>
<TH BGCOLOR="#C0C0C0">Type</TH><TH BGCOLOR="#C0C0C0">Name</TH>
<TH BGCOLOR="#C0C0C0">Description</TH></TR>
</THEAD><TBODY>
<TR>
<TD VALIGN=TOP>SHORT</TD><TD VALIGN=TOP>topSideBearing[]</TD>
<TD VALIGN=TOP>The top sidebearing of the glyph.<BR> Signed integer in FUnits.</TD></TR>
</TABLE>

</BODY></HTML>
