<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CoQueryAuthenticationServices</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>CoQueryAuthenticationServices</H3>  </P>
<B>HRESULT CoQueryAuthenticationServices(pcbAuthSvc, adwAuthSvc); </B></P>
Returns a list of the authentication services that are installed on the computer. The list can be used as input to CoRegisterAuthenticationService. Different authentication services support different levels of security. For example, NTLMSSP does not support delegation or mutual authentication while <I>Kerberos</I> does. The application is responsible for only registering authentication services that provide the features the application needs. There is no way to query which services have been registered with CoRegisterAuthenticationService.</P>
  </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="92pt" VALIGN="TOP"><COL WIDTH="123pt" VALIGN="TOP"><COL WIDTH="259pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Argument</B></P></TD><TD VALIGN="TOP"><B>Type</B></P></TD><TD VALIGN="TOP"><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP">pcbAuthSvc</P></TD><TD VALIGN="TOP">DWORD*</P></TD><TD VALIGN="TOP">Returns a count of the authentication services supported on the computer.</P></TD></TR><TR><TD VALIGN="TOP">adwAuthSvc</P></TD><TD VALIGN="TOP">DWORD**</P></TD><TD VALIGN="TOP">Returns a list of authentication services supported on the computer. The enumeration of authentication services is in rpcdce.h. Authentication services that are not currently in the enumeration may be installed on a computer without upgrading the operating system. The list is allocated by CoTaskMemAlloc. The application must free the list by calling CoTaskMemFree.</P></TD></TR><TR><TD VALIGN="TOP"><I>Returns</I></P></TD><TD VALIGN="TOP">S_OK</P></TD><TD VALIGN="TOP">Success.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">E_INVALIDARG</P></TD><TD VALIGN="TOP">One or more arguments are invalid.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">E_OUTOFMEMORY</P></TD><TD VALIGN="TOP">Insufficient memory to create the adwAuthSvc out-parameter.</P></TD></TR></TBODY></TABLE>
<BR></P> </P></BODY></HTML>
