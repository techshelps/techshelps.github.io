<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IClientSecurity::SetBlanket</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>IClientSecurity::SetBlanket</H3>  </P>
<B>HRESULT IClientSecurity::SetBlanket(pProxy, AuthnSvc, ServerPrincName, pAuthInfo, AuthnLevel, AuthzSvc);</B></P>
This method sets the authentication information that will be used to make calls on the specified proxy.  The values specified here override the values chosen by automatic security. Calling this method changes the security values for all other users of the specified proxy. Use IClientSecurity::CopyProxy to make a private copy.</P>
By default the authentication service and principal name is set to a list of authentication service and principal name pairs that were registered on the server. When this method is called COM will forget the default list. By default COM will try one principal name from the list of authentication services available on both computers. It will not retry if that principal name fails.</P>
If pAuthInfo is not set, it defaults to the logged-in ID. AuthnLevel and AuthzSvc default to the values specified to CoInitializeSecurity. If CoInitializeSecurity is not called, they default to RPC_C_AUTHN_LEVEL_NONE and RPC_C_AUTHZ_NONE. </P>
Security information will often be ignored if set on local interfaces. For example, it is legal to set security on the IClientSecurity interface. However, since that interface is supported locally, there is no need for security. IUnknown and IMultiQuery are special cases. The local implementation makes remote calls to support these interfaces. The local implementation will use the security settings for those interfaces.</P>
  </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="128pt" VALIGN="TOP"><COL WIDTH="263pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Argument</B></P></TD><TD VALIGN="TOP"><B>Type</B></P></TD><TD VALIGN="TOP"><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP">pProxy</P></TD><TD VALIGN="TOP">void*</P></TD><TD VALIGN="TOP">This parameter indicates the proxy to set.</P></TD></TR><TR><TD VALIGN="TOP">AuthnSvc</P></TD><TD VALIGN="TOP">DWORD</P></TD><TD VALIGN="TOP">This parameter indicates the authentication service. It may be RPC_C_AUTHN_NONE if no authentication is required. It may be RPC_C_AUTHN_DONT_CHANGE if you do not want to change the current value.</P></TD></TR><TR><TD VALIGN="TOP">ServerPrincName</P></TD><TD VALIGN="TOP">WCHAR*</P></TD><TD VALIGN="TOP">This parameter indicates the server principal name. It may be NULL if you don't want to change the current value.</P></TD></TR><TR><TD VALIGN="TOP">pAuthInfo</P></TD><TD VALIGN="TOP">RPC_AUTH_IDENTITY<BR>_HANDLE*</P></TD><TD VALIGN="TOP">This parameter sets the identity of the client. It is authentication-service specific. Some authentication services allow the application to pass in a different user name and password. COM keeps a pointer to the memory passed in until COM is uninitialized or a new value is set. If NULL is specified COM uses the current identity (whether the logged in or impersonated ID).</P></TD></TR><TR><TD VALIGN="TOP">AuthnLevel</P></TD><TD VALIGN="TOP">DWORD</P></TD><TD VALIGN="TOP">This parameter specifies the authentication level. It may be RPC_C_AUTHN_LEVEL_DONT_CHANGE if you do not want to change the current value.</P></TD></TR><TR><TD VALIGN="TOP">AuthzSvc</P></TD><TD VALIGN="TOP">DWORD</P></TD><TD VALIGN="TOP">This parameter specifies the authorization level. It may be RPC_C_AUTHZ_DONT_CHANGE if you do not want to change the current value.</P></TD></TR><TR><TD VALIGN="TOP"><I>Returns</I></P></TD><TD VALIGN="TOP">S_OK</P></TD><TD VALIGN="TOP">Success.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">E_INVALIDARG</P></TD><TD VALIGN="TOP">One or more arguments is invalid.</P></TD></TR></TBODY></TABLE>
<BR></P> </P></BODY></HTML>
