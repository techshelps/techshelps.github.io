<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Persistent Objects</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H2>Persistent Objects</H2>  </P>
Because COM allows an object to read and write itself to storage, there must be a way through which the client tells objects to do so. The way is, of course, additional interfaces that form a storage contract between the client and objects. When a client wants to tell and object to deal with storage, it queries the object for one of the persistence-related interfaces, as suits the context. The interfaces that objects can implement, in any combination, are described below:</P>
<SPAN CLASS="list"><UL><LI>    <B>IPersistStorage</B>  Object can read and write its persistent state to a storage object. The client provides the object with an <B>IStorage</B> pointer through this interface. This is the only <B>IPersist*</B><B><I> </I></B>interface that includes semantics for incremental access.</LI><LI>    <B>IPersistStream</B>  Object can read and write its persistent state to a stream object. The client provides the object with an <B>IStream</B> pointer through this interface.</LI><LI>    <B>IPersistFile</B>  Object can read and write its persistent state to a file on the underlying system directly. This interface does not involve <B>IStorage</B><B><I> </I></B>or <B>IStream</B> unless the underlying file is itself access through these interfaces, but the <B>IPersistFile</B> itself has no semantics relating to such structures. The client simply provides the object with a filename and orders to save or load; the object does whatever is necessary to fulfill the request.</LI></UL></SPAN>These interfaces and the rules governing them are described in Chapter 8.</P>
</P>
 </P></BODY></HTML>
