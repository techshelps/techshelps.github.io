<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IRemUnknown::RemAddRef</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>IRemUnknown::RemAddRef</H3>  </P>
<B>HRESULT IRemUnknown::RemAddRef(cInterfaceRefs, rgRefs)</B></P>
Obtain and grant ownership to the caller of one or more reference counts on one or more IPIDs managed by the corresponding OXID. </P>
  </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="101pt" VALIGN="TOP"><COL WIDTH="132pt" VALIGN="TOP"><COL WIDTH="241pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Argument</B></P></TD><TD VALIGN="TOP">Type</P></TD><TD VALIGN="TOP">Description</P></TD></TR></TBODY></TABLE>
<BR></P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="101pt" VALIGN="TOP"><COL WIDTH="132pt" VALIGN="TOP"><COL WIDTH="241pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">cInterfaceRefs</P></TD><TD VALIGN="TOP">unsigned short</P></TD><TD VALIGN="TOP">The size of the rgRefs array.</P></TD></TR><TR><TD VALIGN="TOP">rgRefs</P></TD><TD VALIGN="TOP">REMINTERFACEREF</P></TD><TD VALIGN="TOP">An array of IPID, cRefs pairs, cInterfaceRefs large. Each IPID indicates an interface managed by this OXID on whom more reference counts are sought. The corresponding reference count (cRefs), which may not be zero (and thus is one or more), indicates the number of reference counts sought on that IPID.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
  </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="115pt" VALIGN="TOP"><COL WIDTH="348pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Return Value</B></P></TD><TD VALIGN="TOP">Meaning</P></TD></TR></TBODY></TABLE>
<BR></P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="115pt" VALIGN="TOP"><COL WIDTH="348pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">S_OK</P></TD><TD VALIGN="TOP">Success. An attempt was made to retrieve each of the requested interfaces.</P></TD></TR><TR><TD VALIGN="TOP">E_INVALIDARG</P></TD><TD VALIGN="TOP">One or more of the IPIDs indicated were not in fact managed by this OXID, or one or more of the requested reference counts was zero. None of the requested reference counts have been granted to the caller; the call is a no-op.</P></TD></TR><TR><TD VALIGN="TOP">E_UNEXPECTED</P></TD><TD VALIGN="TOP">An unspecified error occurred. It is unknown whether any or all of the requested reference counts have been granted.</P></TD></TR></TBODY></TABLE>
<BR></P>  </P>
<B>Comments</B>   useful optimization is for a caller to RemAddRef more than needed. When a process receives an out marshaled interface, it receives one reference count. If the process wishes to pass that interface as an out parameter, it must get another reference to pass along. Instead, the process (or middleman) should get a large number of references. Then if the interface is passed out multiple times, no new remote calls are needed to gain additional references. </P>
marshaler may optionally specify more than one reference in the STDOBJREF when marshaling an interface. This allows the middle man case to pre-fill its cache of references without making an extra RemAddRef call. The number of references passed is always specified in the STDOBJREF field.</P>
  </P>
 </P></BODY></HTML>
