<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CoBuildVersion</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>CoBuildVersion</H3>  </P>
<B>DWORD CoBuildVersion(void)</B></P>
Return the major and the minor version number of the Component Object Model library.</P>
  </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="74pt" VALIGN="TOP"><COL WIDTH="294pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Argument</B></P></TD><TD VALIGN="TOP"><B>Type</B></P></TD><TD VALIGN="TOP"><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP">return value</P></TD><TD VALIGN="TOP">DWORD</P></TD><TD VALIGN="TOP">A 32 bit value whose high-order 16 bits are the major version number (rmm) and whose low-order 16 bits are the minor version number (rup).</P></TD></TR></TBODY></TABLE>
<BR></P>An application or .DLL can run against only one major version of the COM Library but can run against any minor version (possibly disabling specific minor features that are not available in a builds before a given minor number). Therefore during startup (initialization for .DLLs), all COM applications must include code similar to the following:</P>
  </P>
<BR></P>
<pre><code>DWORD    dwBuildVersion;
dwBuildVersion=CoBuildVersion();
if (HIWORD(dwBuildVersion)!=rmm)
    //Error:  Can't run against wrong major version
if (LOWORD(dwBuildVersion) &lt; rup)
    //Disable features dependent on the rup version of COM (or simply fail)
//Continue initialization</code></pre>
  </P>
</P>
 </P></BODY></HTML>
