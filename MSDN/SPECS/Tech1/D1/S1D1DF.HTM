<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IClientSecurity::QueryBlanket</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>IClientSecurity::QueryBlanket</H3>  </P>
<B>HRESULT IClientSecurity::QueryBlanket(pProxy, pcbAuthnSvc, pasAuthnSvc, ppAuthInfo, AuthnLevel);</B></P>
This method returns authentication information. This method is called by the client to find out what authentication information COM will use on calls made from the specified proxy.</P>
  </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="92pt" VALIGN="TOP"><COL WIDTH="145pt" VALIGN="TOP"><COL WIDTH="236pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Argument</B></P></TD><TD VALIGN="TOP"><B>Type</B></P></TD><TD VALIGN="TOP"><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP">pProxy</P></TD><TD VALIGN="TOP">void*</P></TD><TD VALIGN="TOP">This parameter indicates the proxy to query.</P></TD></TR><TR><TD VALIGN="TOP">PcbAuthnSvc</P></TD><TD VALIGN="TOP">DWORD*</P></TD><TD VALIGN="TOP">This parameter indicates the number of entries in the array pasAuthSvc.</P></TD></TR><TR><TD VALIGN="TOP">PasAuthnSvc</P></TD><TD VALIGN="TOP">SOLE_AUTHENTICATION<BR>_SERVICE*</P></TD><TD VALIGN="TOP">This parameter is an array of authentication service, principal name pairs. The first entry is the one that COM will use to make calls to the server. The array is allocated with CoTaskMemAlloc and the application must free it by calling CoTaskMemFree.</P></TD></TR><TR><TD VALIGN="TOP">ppAuthInfo</P></TD><TD VALIGN="TOP">RPC_AUTH_IDENTITY<BR>_HANDLE**</P></TD><TD VALIGN="TOP">This parameter returns the value passed to CoSetProxyAuthenticationInfo. It may be NULL if you do not care.</P></TD></TR><TR><TD VALIGN="TOP">AuthnLevel</P></TD><TD VALIGN="TOP">DWORD*</P></TD><TD VALIGN="TOP">This parameter returns the current authentication level. It may be NULL if you do not care.</P></TD></TR><TR><TD VALIGN="TOP"><I>Returns</I></P></TD><TD VALIGN="TOP">S_OK</P></TD><TD VALIGN="TOP">Success.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">E_INVALIDARG</P></TD><TD VALIGN="TOP">One or more arguments are invalid.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">E_OUTOFMEMORY</P></TD><TD VALIGN="TOP">Insufficient memory to create the pasAuthnSvc out-parameter.</P></TD></TR></TBODY></TABLE>
<BR></P> </P></BODY></HTML>
