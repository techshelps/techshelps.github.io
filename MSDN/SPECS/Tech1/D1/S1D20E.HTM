<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IMoniker::Reduce</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>IMoniker::Reduce</H3>  </P>
<B>HRESULT IMoniker::Reduce(pbc, dwReduceHowFar, ppmkToLeft, ppmkReduced)</B></P>
The reduction of monikers was reviewed and illustrated in the synopsis above; this is the function that actually carries it out. Return a more efficient or equally efficient moniker that refers to the same object as does this moniker. Many monikers, if not most, will simply reduce to themselves, since they cannot be rewritten any further. A moniker which reduces to itself indicates this by returning itself through ppmkReduced and the returning status code MK_S_REDUCED_TO_SELF. A moniker which reduces to nothing should return <B>NULL, </B>and should return the status code S_OK.</P>
If the moniker does not reduce to itself, then this function does <I>not</I> reduce this moniker in-place; instead, it returns a <I>new</I> moniker.</P>
The reduction of a moniker which is a composite of other monikers repeatedly reduces the pieces of which it is composed until they all reduce to themselves, then returns the composite of the reduced pieces. dwReduceHowFar controls the stopping point of the reduction process. It controls to what extent the reduction should be carried out. It has the following legal values.</P>
  </P>
<BR></P>
<pre><code>typedef enum tagMKRREDUCE {
    MKRREDUCE_ONE            = 3&lt;&lt;16,
    MKRREDUCE_TOUSER            = 2&lt;&lt;16,
    MKRREDUCE_THROUGUSER    = 1&lt;&lt;16,
    MKRREDUCE_ALL                 = 0
    } <B>MKRREDUCE;</B></code></pre>
  </P>
These values have the following semantics.</P>
  </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="101pt" VALIGN="TOP"><COL WIDTH="362pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Value</B></P></TD><TD VALIGN="TOP"><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP">MKRREDUCE<BR>_ONE</P></TD><TD VALIGN="TOP">Perform only one step of reduction on this moniker. In general, the caller will have to have specific knowledge as to the particular kind of moniker in question in order to be able to usefully take advantage of this option.</P></TD></TR><TR><TD VALIGN="TOP">MKRREDUCE<BR>_TOUSER</P></TD><TD VALIGN="TOP">Reduce this moniker to the first point where it first is of the form where it represents something that the user conceptualizes as being the identity of a persistent object. For example, a file name would qualify, but a macro or an alias would not. If no such point exists, then this option should be treated as MKRREDUCE_ALL.</P></TD></TR><TR><TD VALIGN="TOP">MKRREDUCE<BR>_THROUGUSER</P></TD><TD VALIGN="TOP">Reduce this moniker to the point where any further reduction would reduce it to a form which the user does not conceptualize as being the identity of a persistent object. Often, this is the same stage as MKRREDUCE_TOUSER.</P></TD></TR><TR><TD VALIGN="TOP">MKRREDUCE<BR>_ALL</P></TD><TD VALIGN="TOP">Reduce the entire moniker, then, if needed reduce it again and again to the point where it reduces to simply itself.</P></TD></TR></TBODY></TABLE>
<BR></P>When determining whether they have reduced themselves as far as requested, IMoniker::Reduce implementations should not compare for equality against dwReduceHowFar, as we wish to allow for the possibility that intermediate levels of reduction will be introduced in the future. Instead, IMoniker::Reduce implementations should reduce themselves <I>at least</I> as far as is requested.</P>
An important concept in the above is the idea of a moniker that the user thinks of as the name of a persistent object; a persistent identity. The intent is to provide the ability to programmatically reduce a moniker to canonical forms whose display names would be recognizable to the user. Paths in the file system, bookmarks in word-processing documents, and range names in spreadsheets are all examples of user-identities. In contrast, neither a macro nor an alias encapsulated in a moniker, nor an inode-like file ID moniker are such identities.</P>
The bind context parameter is used as in IMoniker::BindToObject. In particular, implementations of IMoniker::Reduce should pay attention to the time deadline imposed by the caller and the reporting of the moniker of the object that, if it had been running, would have allowed the reduction to progress further. See IBindCtx below.</P>
  </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="101pt" VALIGN="TOP"><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="281pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Argument</B></P></TD><TD VALIGN="TOP"><B>Type</B></P></TD><TD VALIGN="TOP"><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP">pbc</P></TD><TD VALIGN="TOP">IBindCtx*</P></TD><TD VALIGN="TOP">The bind context to use in this operation.</P></TD></TR><TR><TD VALIGN="TOP">dwReduceHowFar</P></TD><TD VALIGN="TOP">DWORD</P></TD><TD VALIGN="TOP">Indicates to what degree this moniker should be reduced; see above.</P></TD></TR><TR><TD VALIGN="TOP">ppmkToLeft</P></TD><TD VALIGN="TOP">IMoniker**</P></TD><TD VALIGN="TOP">On entry, the moniker which is the prefix of this one in the composite in which it is found. On exit, the pointer is either NULL or non-NULL. Non-NULL indicates that what was previously thought of as the prefix should be disregarded and the moniker returned through ppmkToLeft considered the prefix in its place (this is very rare). NULL indicates that the prefix should not be so replaced. Thus, most monikers will NULL out this parameter before returning.</P></TD></TR><TR><TD VALIGN="TOP">ppmkReduced</P></TD><TD VALIGN="TOP">IMoniker**</P></TD><TD VALIGN="TOP">On exit, the reduced form of this moniker. Possibly NULL.</P></TD></TR><TR><TD VALIGN="TOP">return value</P></TD><TD VALIGN="TOP">HRESULT</P></TD><TD VALIGN="TOP">S_OK, MK_S_REDUCED_TO_SELF, MK_E_EXCEEDEDDEADLINE.</P></TD></TR></TBODY></TABLE>
<BR></P> </P></BODY></HTML>
