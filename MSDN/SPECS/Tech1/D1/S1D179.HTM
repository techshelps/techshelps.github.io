<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CoCreateInstance</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>CoCreateInstance</H3>  </P>
<B>HRESULT CoCreateInstance(clsid, pUnkOuter, grfContext, iid, ppvObj)</B></P>
Create an uninitialized instance of the class clsid, asking for interface iid using the execution contexts given in grfContext. If the object is being used as part of an aggregation then pUnkOuter contains a pointer to the controlling unknown. These parameters behave as those of the same name in CoGetClassObject (clsid) and IClassFactory::CreateInstance (pUnkOuter, grfContext, iid, ppv),</P>
CoCreateInstance is simply a wrapper function for CoGetClassObject and IClassFactory that is implemented (conceptually) as follows:</P>
  </P>
<BR></P>
<pre><code>HRESULT CoCreateInstance(REFCLSID clsid, IUnknown * pUnkOuter,
.....DWORD grfContext, REFIID iid, void * ppvObj)
.....{
.....IClassFactory * pCF;
.....HRESULT         hr;

.....hr=CoGetClassObject(clsid, grfContext, NULL, IID_IClassFactory, (void *)pCF);

.....if (FAILED(hr))
..........return hr;

.....hr=pCF-&gt;CreateInstance(pUnkOuter, iid, (void *)ppv);
.....pCF-&gt;Release();

...../*
..... * If CreateInstance fails, ppv will be set to NULL. Otherwise
..... * ppv has the interface pointer and hr contains NOERROR.
..... */
.....return hr;
.....}</code></pre>
  </P>
  </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="79pt" VALIGN="TOP"><COL WIDTH="240pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Argument</B></P></TD><TD VALIGN="TOP"><B>Type</B></P></TD><TD VALIGN="TOP"><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP">clsid</P></TD><TD VALIGN="TOP">REFCLSID</P></TD><TD VALIGN="TOP">The class of which an instance is desired</P></TD></TR><TR><TD VALIGN="TOP">pUnkOuter</P></TD><TD VALIGN="TOP">IUnknown*</P></TD><TD VALIGN="TOP">The controlling unknown, if any.</P></TD></TR><TR><TD VALIGN="TOP">grfContext</P></TD><TD VALIGN="TOP">DWORD</P></TD><TD VALIGN="TOP">The CLSCTX to be used.</P></TD></TR><TR><TD VALIGN="TOP">iid</P></TD><TD VALIGN="TOP">REFIID</P></TD><TD VALIGN="TOP">The initialization interface desired</P></TD></TR><TR><TD VALIGN="TOP">ppv</P></TD><TD VALIGN="TOP">void**</P></TD><TD VALIGN="TOP">The place at which to return the desired interface.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
  </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="178pt" VALIGN="TOP"><COL WIDTH="213pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Return Value</B></P></TD><TD VALIGN="TOP"><B>Meaning</B></P></TD></TR><TR><TD VALIGN="TOP">S_OK</P></TD><TD VALIGN="TOP">Success.</P></TD></TR><TR><TD VALIGN="TOP">Any error that can be returned from CoGetClassObject or IClassFactory::CreateInstance</P></TD><TD VALIGN="TOP">Semantics as in those functions.</P></TD></TR><TR><TD VALIGN="TOP">E_UNEXPECTED</P></TD><TD VALIGN="TOP">An unknown error occurred.</P></TD></TR></TBODY></TABLE>
<BR></P> </P></BODY></HTML>
