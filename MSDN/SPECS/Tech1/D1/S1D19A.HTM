<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CoGetTreatAsClass</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>CoGetTreatAsClass</H3>  </P>
<B>HRESULT CoGetTreatAsClass(clsidOld, pclsidNew)</B></P>
Return the existing emulation information for a given class. If no emulation entry exists for clsidOld then clsidOld is returned in pclsidNew.</P>
  </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="70pt" VALIGN="TOP"><COL WIDTH="213pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Argument</B></P></TD><TD VALIGN="TOP"><B>Type</B></P></TD><TD VALIGN="TOP"><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP">clsidOld</P></TD><TD VALIGN="TOP">REFCID</P></TD><TD VALIGN="TOP">The class for which the emulation information is to be retrieved.</P></TD></TR><TR><TD VALIGN="TOP">pclsidNew</P></TD><TD VALIGN="TOP">CLSID *</P></TD><TD VALIGN="TOP">The place at which to return the class, if any, which emulates clsidOld. clsidOld is returned if there is no such class. pclsidNew may not be NULL.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
  </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="142pt" VALIGN="TOP"><COL WIDTH="213pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Return Value</B></P></TD><TD VALIGN="TOP"><B>Meaning</B></P></TD></TR><TR><TD VALIGN="TOP">S_OK</P></TD><TD VALIGN="TOP">Success. A new, (possibly) different CLSID is returned through *pclisdNew.</P></TD></TR><TR><TD VALIGN="TOP">S_FALSE</P></TD><TD VALIGN="TOP">Success. The class is emulating itself.</P></TD></TR><TR><TD VALIGN="TOP">CO_E_READREGDB</P></TD><TD VALIGN="TOP"><I>.</I></P></TD></TR><TR><TD VALIGN="TOP">E_UNEXPECTED</P></TD><TD VALIGN="TOP">An unspecified error occurred.</P></TD></TR></TBODY></TABLE>
<BR></P>How the COM Library implements these functions depends upon the structure of the system registry. For example, under Microsoft Windows, COM uses an additional subkey under an object's CLSID key in the form of:</P>
  </P>
<BR></P>
<pre><code>   TreatAs = {<I>&lt;new CLSID&gt;</I>}</code></pre>
  </P>
When the Windows COM implementation of CoGetClassObject attempts to locate a server for a CLSID, it will always call CoGetTreatAsClass<I> </I>to retrieve the actual CLSID to use. Since CoGetTreatAsClass will return the same CLSID as passed in if no emulation exists, COM doesn't have to do any special case checks for emulation.</P>
</P>
 </P></BODY></HTML>
