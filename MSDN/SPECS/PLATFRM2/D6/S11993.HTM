<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Use of the GetAsynchKeyState Function</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>Use of the GetAsynchKeyState Function</H3>  </P>
The <B>GetAsynchKeyState</B> function should not be used to retrieve the state of a key or a mouse button, except when absolutely necessary. This function queries the hardware driver to determine the physical key or button state, but ignores any keys being artificially held down or simulated by accessibility aids. When possible, you should use the <B>GetKeyState</B> function, which correctly reflects any simulated input. <B>GetAsynchKeyState</B> can, however, be called in certain cases, such as when the user types a key to interrupt a lengthy processing task.</P>
When handling mouse drag operations, you should avoid using <B>GetAsynchKeyState</B> to detect when a mouse button has been lifted. Instead, you should use the <B>SetCapture</B> function and wait for a button-up message. If you use <B>GetAsynchKeyState</B>, the results might differ from those obtained using other Windows functions and messages. This can cause your application to behave inconsistently with other software on the system.</P>
 </P></BODY></HTML>
