<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3.2    Example</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
</OBJECT></FORM>
<H2>3.2    Example</H2><P>The following code fragments briefly demonstrate how to call the interfaces from Visual Basic and C/C++.</P>
<P><B>Example 1:  Calling Active Directory Interfaces (Visual Basic)</B></P>
<P></P>
<P>' How to get and set properties, call methods, and handle errors.</P>
<P>Dim MyObject as IADsXYZ</P>
<P>Dim MyVariable as String</P>
<P></P>
<P>' Set exception handling.</P>
<P>On Error Resume Next</P>
<P></P>
<P>' Assume that MyObject has been bound to an interface</P>
<P>' on an object. How to do this is discussed in the </P>
<P>' next section.</P>
<P></P>
<P>' Get a property.</P>
<P>MyVariable = MyObject.AReadWriteProp</P>
<P>If Err&lt;&gt;0 Then</P>
<P>    ' Put error handling code here.</P>
<P>EndIf</P>
<P></P>
<P>' Set a property.</P>
<P>MyObject.AReadWriteProp = "A string value."</P>
<P>If Err&lt;&gt;0 Then</P>
<P>    ' Put error handling code here.</P>
<P>EndIf</P>
<P></P>
<P>' Call a method.</P>
<P>MyObject.AMethod</P>
<P>If Err&lt;&gt;0 Then</P>
<P>    ' Put error handling code here.</P>
<P>EndIf</P>
<P></P>
<P><B>Example 1:  Calling Active Directory Interfaces (C/C++)</B></P>
<P>IADsXYZ    *pMyObject;</P>
<P>BSTR    bstrMyVariable;</P>
<P>HRESULT    hr;</P>
<P></P>
<P>//</P>
<P>// Assume that pMyObject has been bound to an interface on an object.</P>
<P>// How to do this is discussed in the next section.</P>
<P>//</P>
<P>// Get a property value.</P>
<P>//</P>
<P>hr = pMyObject-&gt;get_AReadWriteProp(&amp;bstrMyVariable);</P>
<P>if (FAILED(hr))</P>
<P>{</P>
<P>// Put error handling code here.</P>
<P>}</P>
<P>SysFreeString(bstrMyVariable);</P>
<P></P>
<P>//</P>
<P>// Set a property value.</P>
<P>//</P>
<P>bstrMyVariable = SysAllocString(TEXT("A string value."));</P>
<P>hr = pMyObject-&gt;put_AReadWriteProp(bstrMyVariable);</P>
<P>if (FAILED(hr))</P>
<P>{</P>
<P>// Put error handling code here.</P>
<P>}</P>
<P></P>
<P>//</P>
<P>// Call a method.</P>
<P>//</P>
<P>hr = pMyObject-&gt;AMethod();</P>
<P>if (FAILED(hr))</P>
<P>{</P>
<P>// Put error handling code here.</P>
<P>}</P>
<P></P></BODY></HTML>
