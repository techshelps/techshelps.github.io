<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>5.2.1    IADsStream</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
</OBJECT></FORM>
<H3>5.2.1    IADsStream</H3><P>All Stream objects support the COM interface IADsStream. The interface definition is as follows:</P>
<P></P>
<P><pre><code>[ object, uuid(IID_IADsStream), oleautomation, dual ]</P>
<P>interface IADsStream: IDispatch</P>
<P>{</P>
<P>// Methods.</P>
<P>HRESULT OpenStream([in]long lMode,</P>
<P>[out, retval]Istream **ppStm);</P>
<P>};</code></pre></P>
<P></P>

<TABLE COLS="2" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="77pt" VALIGN="TOP"><COL WIDTH="369pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Method</B></P></TD><TD VALIGN="TOP">Remark</P></TD></TR><TR><TD VALIGN="TOP"><P>OpenStream</P></TD><TD VALIGN="TOP"><P>Returns a COM Stream object opened in the specified mode.  Stream objects returned by OpenStream <B>must</B> support the Read, Write, and Seek methods.  The following additional methods are defined by COM and can be implemented at the provider's discretion:</P>
Clone          clones the Istream</P>
Commit    commits changes in STGM_TRANSACTED mode</P>
CopyTo        copies byte range from current stream to another stream</P>
LockRegion    locks a byte range in a stream</P>
Revert        discards changes in STGM_TRANSACTED mode</P>
SetSize        explicitly sets the size of the stream (in bytes)</P>
Stat        returns a STATSTG struct for this stream (see COM doc)</P>
UnlockRegion    unlocks a byte range locked by LockRegion</P>
<P></P>
<P>The <B>lMode</B> parameter indicates the desired access to the stream.  Active Directory providers <B>must</B> support the following COM-defined modes:</P>
STGM_DIRECT            0x00000000L</P>
STGM_READ            0x00000000L</P>
STGM_WRITE            0x00000001L</P>
</P>
and may support any of the following additional modes at the provider's discretion.</P>
<B></B></P>
STGM_READWRITE        0x00000002L</P>
STGM_SHARE_DENY_NONE    0x00000040L</P>
STGM_SHARE_DENY_READ    0x00000030L</P>
STGM_SHARE_DENY_WRITE    0x00000020L</P>
STGM_SHARE_EXCLUSIVE    0x00000010L</P>
STGM_TRANSACTED        0x00010000L</P>
STGM_SIMPLE            0x08000000L</P>
STGM_PRIORITY        0x00040000L</P>
STGM_DELETEONRELEASE    0x04000000L</P>
STGM_CREATE            0x00001000L</P>
STGM_CONVERT        0x00020000L</P>
STGM_FAILIFTHERE        0x00000000L</P>
STGM_NOSCRATCH        0x00100000L</P>
<P></P>
<P></P></TD></TR></TBODY></TABLE>
<BR></P></BODY></HTML>
