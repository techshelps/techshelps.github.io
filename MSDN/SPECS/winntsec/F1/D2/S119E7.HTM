<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MSGINA.DLL Features</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>MSGINA.DLL Features</H3>  </P>
If you are writing a GINA to replace Microsoft's standard GINA (MSGINA), you may want to provide some or all of MSGINA's functionality. Following is a list of these features and a brief description of how they are controlled. </P>
Registry key values control the availability or behaviour of many of these features. Unless otherwise noted, these key values belong to a registry key refered to as the WinlogonIni key and have value types of [REG_SZ]. The actual path of the WinlogonIni key is:</P>
\HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon</P>
Having [REG_SZ] value types makes it convenient to query the key values using <B>AllocAndGetProfileString(), GetProfileString(), </B>and<B> GetProfileInt()</B>.</P>
<SPAN CLASS="list"><UL><LI><B>Legal Notification Dialog</B>    In many countries and states it is legal for anyone to walk up to a system, log on, and begin working unless there are notifications indicating that the system is intended for the private use of authorized users. Also, many users want company-specific messages displayed before normal logon. MSGINA uses two registry key values of the WinlogonIni key to implement such capabilities. If either key value is present and contains a non-null string, then a <I>Legal Notice</I> dialog is displayed before the typical <I>Welcome</I> screen. The dialog's caption is taken from one of these key values, and its message from the other.
These key values are:</P>

Value Name:    LegalNoticeCaption<BR>Valid Values:    (any string you want displayed as the dialog caption)</P>

Value Name:    LegalNoticeText<BR>Valid Values:    (any string you want displayed as the dialog body)</P></LI><LI><B>Don't Display Last Username</B>     By default, MSGINA displays the name of the last user to successfully log on a machine on the logon screen. To alter this, MSGINA uses a registry key value of the WinlogonIni key. If this key value is present and contains a string value "1", no user name is displayed in the logon dialog.</LI><LI><B>AutoAdmin Logon</B>     This feature allows an NT system to log on a user automatically. This feature can be used in two ways:

<UL><LI>Cause a user to be automatically logged on exactly once. If the user logs off or the system is shut down, the user will not be automatically logged on afterward. The user must have a null password for this feature to be used.</LI><LI>Cause a user to be logged on every time the system boots or the user logs off.</LI></UL>This feature uses the following values of the WinlogonIni key:</P></LI></UL></SPAN><SPAN CLASS="Symbol"></SPAN></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="137pt" VALIGN="TOP"><COL WIDTH="326pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Value Name:<BR>Valid Values:</P></TD><TD VALIGN="TOP">AutoAdminLogon<BR>"1" or any other string value</P></TD></TR><TR><TD VALIGN="TOP">Value Name:<BR>Valid Values:</P></TD><TD VALIGN="TOP">DefaultUserName<BR>(name of user to automatically log on)</P></TD></TR><TR><TD VALIGN="TOP">Value Name:<BR>Valid Values:</P></TD><TD VALIGN="TOP">DefaultDomainName<BR>(name of domain user account is in)</P></TD></TR><TR><TD VALIGN="TOP">Value Name:<BR>Valid Values:</P></TD><TD VALIGN="TOP">DefaultPassword<BR>(password of user account, in cleartext)</P></TD></TR></TBODY></TABLE>
<BR></P>If the AutoAdminLogon key value is present and contains a "1", an automatic logon will occur based upon the DefaultPassword key value. The account being logged onto is specified via the DefaultUserName and DefaultDomainName key values. If present and non-null, the password in DefaultPassword is also used.</P>
If an automatic logon is being performed, but the DefaultPassword key value is either not present or is null, then this is a one-time only autologon. The AutoAdminLogon key value will be set to contain a "0" before the logon is attempted. This prevents any future autologons.</P>
There is one additional caveat to autologon. If an autologon is indicated, MSGINA checks the state of the Shift key. If it is held down, it is assumed that the user wants to over-ride autologon and provide identification/authentication information interactively. This is a critical feature when you are debugging a dedicated application. The Shift-override of automatic logon is disabled if the following key value is present and has a value of "1":</P>
<SPAN CLASS="Symbol"></SPAN></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="160pt" VALIGN="TOP"><COL WIDTH="186pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Value Name:</P></TD><TD VALIGN="TOP">IgnoreShiftOverride</P></TD></TR></TBODY></TABLE>
<BR></P><SPAN CLASS="list"><UL><LI><B>Allow Unauthenticated Shutdown</B>    MSGINA may be configured to include a <I>Shutdown</I> button in the logon dialog. This allows users to shut down the system without first logging on. Inclusion of this button is controlled by the following key value:
Value Name:    ShutdownWithoutLogon<BR>Valid Values:    "1" to include button, any other value to exclude button.</P></LI><LI><B>UserInit.exe Activation</B>     Userinit.exe is an application activated by MSGINA at user logon time. It runs in the newly logged-on user's context and on the user's desktop. Its purpose is to set up the user's environment. This includes restoring net uses, establishing profile settings (like fonts and screen colors), running logon scripts (including those of network providers). It then activates the user shell program(s), which will inherit the environment that userinit.exe sets up. The shell programs userinit.exe activates are listed in the following WinlogonIni key value:</LI></UL></SPAN><SPAN CLASS="Symbol"></SPAN></P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="110pt" VALIGN="TOP"><COL WIDTH="136pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">Value Name:</P></TD><TD VALIGN="TOP">Shell</P></TD></TR></TBODY></TABLE>
<BR></P>There may be more than one program listed, each seperated by a comma. By default, "Progman" is listed. If this key is not found, or has no programs listed, Progman is activated as the default shell.</P>
<SPAN CLASS="list"><UL><LI><B>Logged On Security Options</B>     When logged on, if a user enters an SAS, the user is presented with a security options screen. Among the options listed are shut down the system, log off, change your password, go to the task list, and lock the workstation. An alternative GINA might provide similar options when an SAS is entered while a user is logged on.</LI></UL></SPAN> </P></BODY></HTML>
