<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Subsection Directory</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
</OBJECT></FORM>
<H2>Subsection Directory </H2>The subsection directory has the format</P>
</P>

<TABLE COLS="1" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="140pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Directory header</P></TD></TR><TR><TD VALIGN="TOP"><P>Directory entry 0</P></TD></TR><TR><TD VALIGN="TOP"><P>Directory entry 1</P></TD></TR><TR><TD VALIGN="TOP"><P>.</P></TD></TR><TR><TD VALIGN="TOP"><P>.</P></TD></TR><TR><TD VALIGN="TOP"><P>.</P></TD></TR><TR><TD VALIGN="TOP"><P>Directory entry <I>n</I></P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
The subsection directory is prefixed with a directory header structure indicating size and number of subsection directory entries that follow.  </P>
</P>

<TABLE COLS="5" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="86pt" VALIGN="TOP"><COL WIDTH="67pt" VALIGN="TOP"><COL WIDTH="63pt" VALIGN="TOP"><COL WIDTH="58pt" VALIGN="TOP"><COL WIDTH="63pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>2</P></TD><TD VALIGN="TOP"><P>2</P></TD><TD VALIGN="TOP"><P>4</P></TD><TD VALIGN="TOP"><P>4</P></TD><TD VALIGN="TOP"><P>4</P></TD></TR><TR><TD VALIGN="TOP"><P>cbDirHeader</P></TD><TD VALIGN="TOP"><P>cbDirEntry</P></TD><TD VALIGN="TOP"><P>cDir</P></TD><TD VALIGN="TOP"><P>lfoNextDir</P></TD><TD VALIGN="TOP"><P>flags</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
<P><I>cbDirHeader</I>    Length of the directory header</P>
<P><I>cbDirEntry</I>    Length of each directory entry</P>
<P><I>cDir</I>    Number of directory entries</P>
<P><I>lfoNextDir</I>    Offset from <B>lfaBase</B> of next directory.  This field is currently unused.   It is intended for use by the incremental linker to point to the next directory containing Symbol and Type OMF information from an incremental link. </P>
<P><I>flags</I>    Flags describing directory and subsection tables.  No values have been defined for this field.</P>
<P></P>
The directory header structure is  followed by the directory entries which specify the subsection type, module index if applicable, the subsection offset, and subsection size. </P>
</P>

<TABLE COLS="4" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="81pt" VALIGN="TOP"><COL WIDTH="76pt" VALIGN="TOP"><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="81pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>2</P></TD><TD VALIGN="TOP"><P>2</P></TD><TD VALIGN="TOP"><P>4</P></TD><TD VALIGN="TOP"><P>4</P></TD></TR><TR><TD VALIGN="TOP"><P>subsection</P></TD><TD VALIGN="TOP"><P>iMod</P></TD><TD VALIGN="TOP"><P>lfo</P></TD><TD VALIGN="TOP"><P>cb</P></TD></TR></TBODY></TABLE>
<BR></P><P></P>
<P><I>subsection</I>    Subdirectory index.  See the table below for a listing of the valid subsection indices.</P>
<P><I>iMod</I>    Module index.  This number is 1 based and zero is never a valid index.  The index 0xffff is reserved for tables that are not associated with a specific module.  These tables include sstLibraries, sstGlobalSym, sstGlobalPub and sstGlobalTypes.</P>
<P>lfo    Offset from the base address <B>lfaBase</B></P>
<P>cb    Number of bytes in subsection</P>
<P><B></B></P>
There is no requirement for a particular subsection to exist for a particular module.   There is a preferred order for subsections within the Symbol and Type OMF portion and the subsection directory of the file as emitted by the linker (NB05 signature).  The preferred order is:</P>
    </P>

<TABLE COLS="2" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="99pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>sstModule1</P></TD><TD VALIGN="TOP"><P>Module 1</P></TD></TR><TR><TD VALIGN="TOP"><P>.</P></TD><TD VALIGN="TOP"><P>.</P></TD></TR><TR><TD VALIGN="TOP"><P>sstModulen</P></TD><TD VALIGN="TOP"><P>Module n</P></TD></TR><TR><TD VALIGN="TOP"><P>sstTypes1</P></TD><TD VALIGN="TOP"><P>Module 1</P></TD></TR><TR><TD VALIGN="TOP"><P>sstPublics1</P></TD><TD VALIGN="TOP"><P>Module 1</P></TD></TR><TR><TD VALIGN="TOP"><P>sstSymbols1</P></TD><TD VALIGN="TOP"><P>Module 1</P></TD></TR><TR><TD VALIGN="TOP"><P>sstSrcModule1</P></TD><TD VALIGN="TOP"><P>Module 1</P></TD></TR><TR><TD VALIGN="TOP"><P>.</P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>sstTypesn</P></TD><TD VALIGN="TOP"><P>Module n</P></TD></TR><TR><TD VALIGN="TOP"><P>sstPublicsn</P></TD><TD VALIGN="TOP"><P>Module n</P></TD></TR><TR><TD VALIGN="TOP"><P>sstSymbolsn</P></TD><TD VALIGN="TOP"><P>Module n</P></TD></TR><TR><TD VALIGN="TOP"><P>sstSrcModulen</P></TD><TD VALIGN="TOP"><P>Module n</P></TD></TR><TR><TD VALIGN="TOP"><P>sstLibraries</P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>directory</P></TD><TD VALIGN="TOP"><P></P></TD></TR></TBODY></TABLE>
<BR></P></P>
However, if the tables are not written in this order by the linker, CVPACK will sort the subsection table into this order and read the subsections in this order by seeking to the correct location.  The net effect is that packing will be less efficient but will work.</P>
CVPACK will write the Symbol and Type OMF back to the file in the following order.  CodeView requires that the sstModule entries be first and sequential in the subsection directory.  For performance reasons, it is recommended that the order of the subsections in the file match the order of the subsection directory entries.</P>
For signatures prior to NB09, the packed file has the following subsections and ordering.    </P>

<TABLE COLS="2" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="173pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>NBxx</B></P></TD><TD VALIGN="TOP"><P>signature</P></TD></TR><TR><TD VALIGN="TOP"><P>lfoDir</P></TD><TD VALIGN="TOP"><P>directory offset</P></TD></TR><TR><TD VALIGN="TOP"><P>sstModule1</P></TD><TD VALIGN="TOP"><P>Module 1</P></TD></TR><TR><TD VALIGN="TOP"><P>.</P></TD><TD VALIGN="TOP"><P>.</P></TD></TR><TR><TD VALIGN="TOP"><P>sstModulen</P></TD><TD VALIGN="TOP"><P>Module n</P></TD></TR><TR><TD VALIGN="TOP"><P>sstAlignSym1</P></TD><TD VALIGN="TOP"><P>Module 1</P></TD></TR><TR><TD VALIGN="TOP"><P>sstSrcModule1</P></TD><TD VALIGN="TOP"><P>Module 1</P></TD></TR><TR><TD VALIGN="TOP"><P>.</P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>sstAlignSymn</P></TD><TD VALIGN="TOP"><P>Module n</P></TD></TR><TR><TD VALIGN="TOP"><P>sstSrcModulen</P></TD><TD VALIGN="TOP"><P>Module n</P></TD></TR><TR><TD VALIGN="TOP"><P>sstGlobalPub</P></TD><TD VALIGN="TOP"><P>Global Publics </P></TD></TR><TR><TD VALIGN="TOP"><P>sstGlobalSym</P></TD><TD VALIGN="TOP"><P>Global Symbols</P></TD></TR><TR><TD VALIGN="TOP"><P>sstLibraries</P></TD><TD VALIGN="TOP"><P>Libraries</P></TD></TR><TR><TD VALIGN="TOP"><P>sstGlobalTypes</P></TD><TD VALIGN="TOP"><P>Global Types</P></TD></TR><TR><TD VALIGN="TOP"><P>Directory</P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>NBxx</B></P></TD><TD VALIGN="TOP"><P>signature if OMF executable</P></TD></TR><TR><TD VALIGN="TOP"><P>lfoBase</P></TD><TD VALIGN="TOP"><P>offset of base if OMF executable</P></TD></TR></TBODY></TABLE>
<BR></P></P>
For NB09 signatures, the packed file has the following subsections and ordering.    </P>

<TABLE COLS="2" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="173pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>NBxx</B></P></TD><TD VALIGN="TOP"><P>signature</P></TD></TR><TR><TD VALIGN="TOP"><P>lfoDir</P></TD><TD VALIGN="TOP"><P>directory offset</P></TD></TR><TR><TD VALIGN="TOP"><P>sstModule1</P></TD><TD VALIGN="TOP"><P>Module 1</P></TD></TR><TR><TD VALIGN="TOP"><P>.</P></TD><TD VALIGN="TOP"><P>.</P></TD></TR><TR><TD VALIGN="TOP"><P>sstModulen</P></TD><TD VALIGN="TOP"><P>Module n</P></TD></TR><TR><TD VALIGN="TOP"><P>sstAlignSym1</P></TD><TD VALIGN="TOP"><P>Module 1</P></TD></TR><TR><TD VALIGN="TOP"><P>sstSrcModule1</P></TD><TD VALIGN="TOP"><P>Module 1</P></TD></TR><TR><TD VALIGN="TOP"><P>.</P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>sstAlignSymn</P></TD><TD VALIGN="TOP"><P>Module n</P></TD></TR><TR><TD VALIGN="TOP"><P>sstSrcModulen</P></TD><TD VALIGN="TOP"><P>Module n</P></TD></TR><TR><TD VALIGN="TOP"><P>sstGlobalPub</P></TD><TD VALIGN="TOP"><P>Global Publics</P></TD></TR><TR><TD VALIGN="TOP"><P>sstGlobalSym</P></TD><TD VALIGN="TOP"><P>Global Symbols</P></TD></TR><TR><TD VALIGN="TOP"><P>sstLibraries</P></TD><TD VALIGN="TOP"><P>Libraries</P></TD></TR><TR><TD VALIGN="TOP"><P>sstGlobalTypes</P></TD><TD VALIGN="TOP"><P>Global Types</P></TD></TR><TR><TD VALIGN="TOP"><P>sstStaticSym</P></TD><TD VALIGN="TOP"><P>Static Symbols</P></TD></TR><TR><TD VALIGN="TOP"><P>sstFileIndex</P></TD><TD VALIGN="TOP"><P>File Index</P></TD></TR><TR><TD VALIGN="TOP"><P>sstOffsetMap16 sstOffsetMat32</P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Directory</P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>NBxx</B></P></TD><TD VALIGN="TOP"><P>signature </P></TD></TR><TR><TD VALIGN="TOP"><P>lfoBase</P></TD><TD VALIGN="TOP"><P>offset </P></TD></TR></TBODY></TABLE>
<BR></P></P></BODY></HTML>
