<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Escaped Expressions</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<form name="x"><object classid="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" name="iv" width=0 height=0></object></form>
<h1><a name="escapedexpressions"></a>Escaped Expressions</h1>
<p>
An escape expression (for example, \'hh, \\, or \{) is usable in all RTF control words.</p>
<p>
<b>Writer:</b></p>
<p>
In general RTF should be written out with all characters above 0x80 in the escaped form, \'hh.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=40%><b>Character code</b></td>
<td width=60%><b>Write out as</b></td>
</tr>
<tr valign=top>
<td width=40%>0x00 &lt;= ch &lt; 0x20</td>
<td width=60%>Escaped (\'hh)</td>
</tr>
<tr valign=top>
<td width=40%>0x20 &lt;= ch &lt; 0x80</td>
<td width=60%>Raw (non-escaped) character</td>
</tr>
<tr valign=top>
<td width=40%>0x80 &lt;= ch &lt;= 0xFF</td>
<td width=60%>Escaped (\'hh)</td>
</tr>
</table><br>
<p>
For compatibility, there is an <b>RTFParam</b> option in the<b> HKEY_CURRENT_USERF\Software\Microsoft\Word\7.0FE\ </b>section of the registry database that determines whether raw 8-bit characters or escaped characters are used for the double-byte characters in <b>\stylesheet</b>, <b>\fonttbl</b>,<b> \bkmkstart</b>, and <b>\bkmkend</b>. This option is valid only when writing out the RTF; it does not affect RTF reading behavior.</p>
<p class=indent>
[Microsoft Word]</p>
<p class=indent>
RTFParam=7 (the default) uses an escaped expression when the character is above 0x80.</p>
<p class=indent>
RTFParam=8 uses raw 8-bit characters for <b>\stylesheet</b>, <b>\fonttbl</b>, <b>\bkmkstart</b>, and <b>\bkmkend</b> (does not escape even if trailing-byte was an RTF special character such as \, {, or }).</p>
<p>
<b>Reader:</b></p>
<p>
When the RTF reader encounters raw characters in the leading-byte range of the double-byte character, it regards the next character as the trailing byte of the double-byte character and combines the two characters into one double-byte character.</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td width=18%><b>Leading byte</b></td>
<td width=30%><b>Trailing byte</b></td>
<td width=52%><b>Validity</b></td>
</tr>
<tr valign=top>
<td width=18%>Escaped</td>
<td width=30%>Raw (0x20 &lt;= ch &lt;= 0x7f) </td>
<td width=52%>Valid (standard format for double-byte character)</td>
</tr>
<tr valign=top>
<td width=18%>Escaped</td>
<td width=30%>Escaped (other)</td>
<td width=52%>Valid (standard format for double-byte character)</td>
</tr>
<tr valign=top>
<td width=18%>Raw</td>
<td width=30%>Raw</td>
<td width=52%>Valid (RTF-J format for double-byte character)</td>
</tr>
<tr valign=top>
<td width=18%>Raw</td>
<td width=30%>Escaped</td>
<td width=52%>Invalid</td>
</tr>
</table>
</BODY>
</HTML>
