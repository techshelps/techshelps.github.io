<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Objects</title>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>
<form name="x"><object classid="clsid:9c2ac687-ceef-11cf-96d9-00a0c903b016" name="iv" width=0 height=0></object></form>
<h1><a name="objects"></a>Objects</h1>
<p>
Microsoft OLE links, Microsoft OLE embedded objects, and Macintosh Edition Manager subscriber objects are represented in RTF as objects. Objects are destinations that contain a data part and a result part. The data part is generally hidden to the application that produced the document. A separate application uses the data and supplies the appearance of the data. This appearance is the result part of the object.</p>
<p>
The representation of objects in RTF is designed to allow RTF readers that don't understand objects or don't use a particular type of object to use the current result in place of the object. This allows the appearance of the object to be maintained through the conversion even though the object functionality is lost. Each object comes with optional information about the object, a required destination that contains the object data, and an optional result that contains the current appearance of the object. This result contains standard RTF. It is an important responsibility of the RTF writer to provide the result so that existing RTF readers that either do not support objects or that do not support the particular type of object will be able to display the object.</p>
<p>
When the object is an OLE embedded or linked object, the data part of the object is the structure produced by the <b>OLESaveToStream</b> function. Some OLE clients rely on the OLE system to render the object and a copy of the result is not available to the RTF writer for that application. For these cases, the object result can be extracted from the structure produced by the <b>OLESaveToStream function. </b>For information about the <b>OLESaveToStream </b>function, see the Microsoft Object Linking and Embedding Software Development Kit.</p>
<p>
The syntax for this destination is:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=17%>&lt;obj&gt;</td>
<td width=83%>( '{' <b>\object</b> (&lt;objtype&gt; &amp; &lt;objmod&gt;? &amp; &lt;objclass&gt;? &amp; &lt;objname&gt;? &amp; &lt;objtime&gt;? &amp; &lt;objsize&gt;? &amp; &lt;rsltmod&gt;?) &lt;objdata&gt; &lt;result&gt; '}' ) | &lt;pubobject&gt;</td>
</tr>
<tr valign=top>
<td width=17%>&lt;objtype&gt;</td>
<td width=83%><b>\objemb</b> | <b>\objlink</b> | <b>\objautlink</b> | <b>\objsub</b> | <b>\objpub</b> | <b>\objicemb | objhtml | objocx</b></td>
</tr>
<tr valign=top>
<td width=17%>&lt;objmod&gt;</td>
<td width=83%><b>\linkself</b>? &amp; <b>\objlock</b>? | <b>\objupdate</b>?</td>
</tr>
<tr valign=top>
<td width=17%>&lt;objclass&gt;</td>
<td width=83%>'{\*' <b>\objclass</b> #PCDATA '}'</td>
</tr>
<tr valign=top>
<td width=17%>&lt;objname&gt;</td>
<td width=83%>'{\*' <b>\objname</b> #PCDATA '}'</td>
</tr>
<tr valign=top>
<td width=17%>&lt;objtime&gt;</td>
<td width=83%>'{\*' <b>\objtime</b> &lt;time&gt; '}'</td>
</tr>
<tr valign=top>
<td width=17%>&lt;rsltmod&gt;</td>
<td width=83%><b>\rsltmerge</b>? &amp; &lt;rslttype&gt;?</td>
</tr>
<tr valign=top>
<td width=17%>&lt;rslttype&gt;</td>
<td width=83%><b>\rsltrtf</b> | <b>\rslttxt</b> | <b>\rsltpict</b> | <b>\rsltbmp</b></td>
</tr>
<tr valign=top>
<td width=17%>&lt;objsize&gt;</td>
<td width=83%><b>\objsetsize</b>? &amp; <b><i>\objalign</i></b>? &amp; <b><i>\objtransy</i></b>? &amp; &lt;objhw&gt;? &amp; <b><i>\objcropt</i></b>? &amp; <b><i>\objcropb</i></b>? &amp; <b><i>\objcropl</i></b>? &amp; <b><i>\objcropr</i></b>? &amp; <b><i>\objscalex</i></b>? &amp; <b><i>\objscaley</i></b>?</td>
</tr>
<tr valign=top>
<td width=17%>&lt;objhw&gt;</td>
<td width=83%><b><i>\objh </i></b>&amp; <b><i>\objw</i></b></td>
</tr>
<tr valign=top>
<td width=17%>&lt;objdata&gt;</td>
<td width=83%>'{\*' <b>\objdata</b> (&lt;objalias&gt;? &amp; &lt;objsect&gt;?) &lt;data&gt; '}'</td>
</tr>
<tr valign=top>
<td width=17%>&lt;objalias&gt;</td>
<td width=83%>'{\*' <b>\objalias</b> &lt;data&gt; '}'</td>
</tr>
<tr valign=top>
<td width=17%>&lt;objsect&gt;</td>
<td width=83%>'{\*' <b>\objsect</b> &lt;data&gt; '}'</td>
</tr>
<tr valign=top>
<td width=17%>&lt;result&gt;</td>
<td width=83%>'{' <b>\result</b> &lt;para&gt;+ '}'</td>
</tr>
</table><br>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=17%><b>Control word</b></td>
<td width=83%><b>Meaning</b></td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>Object Type</td>
</tr>
<tr valign=top>
<td width=17%><b>\objemb</b></td>
<td width=83%>An object type of OLE embedded object. If no type is given for the object, the object is assumed to be of type <b>\objemb</b>.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objlink</b></td>
<td width=83%>An object type of OLE link.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objautlink</b></td>
<td width=83%>An object type of OLE autolink.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objsub</b></td>
<td width=83%>An object type of Macintosh Edition Manager subscriber.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objpub</b></td>
<td width=83%>An object type of Macintosh Edition Manager publisher.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objicemb</b></td>
<td width=83%>An object type of MS Word for the Macintosh Installable Command (IC) Embedder.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objhtml</b></td>
<td width=83%>An object type of HTML control.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objocx</b></td>
<td width=83%>An object type of OLE control.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>Object Information</td>
</tr>
<tr valign=top>
<td width=17%><b>\linkself</b></td>
<td width=83%>The object is a link to another part of the same document.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objlock</b></td>
<td width=83%>Locks the object from any updates.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objupdate</b></td>
<td width=83%>Forces an update to the object before displaying it.<b> </b>Note that this will override any values in the &lt;objsize&gt; control words, but reasonable values should always be provided for these to maintain backwards compatibility.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objclass</b></td>
<td width=83%>The text argument is the object class to use for this object; ignore the class specified in the object data. This is a destination control word.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objname</b></td>
<td width=83%>The text argument is the name of this object. This is a destination control word.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objtime</b></td>
<td width=83%>Describes the time that the object was last updated.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>Object Size, Position, Cropping, and Scaling</td>
</tr>
<tr valign=top>
<td width=17%><b>\objh<i>N</i></b></td>
<td width=83%><b><i>N</i></b> is the original object height in twips, assuming the object has a graphical representation.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objw<i>N</i></b></td>
<td width=83%><b><i>N</i></b> is the original object width in twips, assuming the object has a graphical representation.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objsetsize</b></td>
<td width=83%>Forces the object server to set the object's dimensions to that specified by the client.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objalign<i>N</i></b></td>
<td width=83%><b><i>N</i></b> is the distance in twips from the left edge of the objects that should be aligned on a tab stop. This is needed to place Equation Editor equations correctly in line. </td>
</tr>
<tr valign=top>
<td width=17%><b>\objtransy<i>N</i></b></td>
<td width=83%><b><i>N</i></b> is the distance in twips the objects should be moved vertically with respect to the baseline. This is needed to place Math Type equations correctly in line. </td>
</tr>
<tr valign=top>
<td width=17%><b>\objcropt<i>N</i></b></td>
<td width=83%><b><i>N</i></b> is the top cropping distance in twips.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objcropb<i>N</i></b></td>
<td width=83%><b><i>N</i></b> is the bottom cropping distance in twips.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objcropl<i>N</i></b></td>
<td width=83%><b><i>N</i></b> is the left cropping distance in twips.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objcropr<i>N</i></b></td>
<td width=83%><b><i>N</i></b> is the right cropping distance in twips.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objscalex<i>N</i></b></td>
<td width=83%><b><i>N</i></b> is the horizontal scaling percentage.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objscaley<i>N</i></b></td>
<td width=83%><b><i>N</i></b> is the vertical scaling percentage.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>Object Data</td>
</tr>
<tr valign=top>
<td width=17%><b>\objdata</b></td>
<td width=83%>This subdestination contains the data for the object in the appropriate format; OLE objects are in <b>OLESaveToStream </b>format. This is a destination control word.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objalias</b></td>
<td width=83%>This subdestination contains the alias record for the publisher object for the Macintosh Edition Manager. This is a destination control word.</td>
</tr>
<tr valign=top>
<td width=17%><b>\objsect</b></td>
<td width=83%>This subdestination contains the section record for the publisher object for the Macintosh Edition Manager. This is a destination control word.</td>
</tr>
<tr valign=top>
<td colspan=2 width=100%>Object Result</td>
</tr>
<tr valign=top>
<td width=17%><b>\rsltrtf</b></td>
<td width=83%>Forces the result to be rich text format, if possible.</td>
</tr>
<tr valign=top>
<td width=17%><b>\rsltpict</b></td>
<td width=83%>Forces the result to be a Windows metafile or MacPict image format, if possible.</td>
</tr>
<tr valign=top>
<td width=17%><b>\rsltbmp</b></td>
<td width=83%>Forces the result to be a bitmap, if possible.</td>
</tr>
<tr valign=top>
<td width=17%><b>\rslttxt</b></td>
<td width=83%>Forces the result to be plain text, if possible.</td>
</tr>
<tr valign=top>
<td width=17%><b>\rsltmerge</b></td>
<td width=83%>Uses the formatting of the current result whenever a new result is obtained.</td>
</tr>
<tr valign=top>
<td width=17%><b>\result</b></td>
<td width=83%>The result destination is optional in the <b>\object</b> destination. It contains the last update of the result of the object. The data of the result destination should be standard RTF so that RTF readers that don't understand objects or the type of object represented can use the current result in the object's place to maintain appearance. This is a destination control word.</td>
</tr>
</table><br>
<p>
When Word is used as an editor for Mail, the following control word can be emitted. It is not seen in other situations.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=17%><b>Control Word</b></td>
<td width=83%><b>Meaning</b></td>
</tr>
<tr valign=top>
<td width=17%><b>\objattph</b></td>
<td class=indent width=83%>Object attachment placeholder. Used in the RTF stream when Word is started as a mail editor and the message contains attachments. The control word tells where in the text stream the attachment should be placed. It does not define the actual attachment.</td>
</tr>
</table><br>
<h2>Macintosh Edition Manager Publisher Objects</h2>
<p>
Word for the Macintosh writes publisher objects for the Macintosh Edition Manager in terms of bookmarks (see "Bookmarks" on page 41 of this Application Note). The range of publisher objects are marked as bookmarks, so these controls are all used within the <b>\bkmkstart</b> destination. The RTF syntax for a publisher object is:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=17%>&lt;pubobject&gt;</td>
<td width=83%>'{\*' <b>\bkmkstart</b> <b>\bkmkpub</b> <b>\pubauto</b>? (&lt;objalias&gt;? &amp; &lt;objsect&gt;) #PCDATA '}'</td>
</tr>
</table><br>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td width=17%><b>Control word</b></td>
<td width=83%><b>Meaning</b></td>
</tr>
<tr valign=top>
<td width=17%><b>\bkmkpub</b></td>
<td width=83%>The bookmark marks a Macintosh Edition Manager publisher object.</td>
</tr>
<tr valign=top>
<td width=17%><b>\pubauto</b></td>
<td width=83%>The publisher object updates all Macintosh Edition Manager subscribers of this object automatically whenever it is edited.</td>
</tr>
</table>
</BODY>
</HTML>
