<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3.1.7.9  TSPI_phoneGetID</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H1>3.1.7.9  TSPI_phoneGetID</H1><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="325pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Syntax</B></P></TD><TD VALIGN="TOP">LONG<B> TSPI_phoneGetID</B>(dwRequestID, hdPhone, lpDeviceID, lpszDeviceClass)<BR>This function returns a device ID for the given device class associated with the specified phone device.  </P></TD></TR><TR><TD VALIGN="TOP"><B>Parameters</B></P></TD><TD VALIGN="TOP">DRV_REQUESTID    dwRequestID<BR>Specifies the identifier of the asynchronous request.  The Service Provider returns this value if the function completes asynchronously.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">HDRVPHONE    hdPhone<BR>Specifies the Service Provider's opaque handle to the phone to be queried.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">LPVARSTRING    lpDeviceID<BR>Specifies a far pointer to a data structure of type <B>VARSTRING</B> where the device ID is returned. Upon successful completion of the request, this location is filled with the device ID. The format of the returned information depends on the method used by the device class (API) for naming devices. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">LPCSTR    <B>const</B> lpszDeviceClass<BR>Specifies a far pointer to a NULL-terminated string that specifies the device class of the device whose ID is requested. Valid device class strings are those used in the SYSTEM.INI section to identify device classes.</P></TD></TR><TR><TD VALIGN="TOP"><B>Return Value</B></P></TD><TD VALIGN="TOP">Returns zero if the function is successful, the (positive) dwRequestID value if the function will be completed asynchronously, or a negative error number if an error has occurred. Possible error returns are:</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INVALPHONEHANDLE<BR>The hdPhone parameter is an invalid handle.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INVALPOINTER<BR>One of the specified pointer parameters are invalid.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_NODEVICE<BR>The phone device has no associated device for the given device class.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_OPERATIONFAILED<BR>The specified operation failed for unspecified reasons.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comments</B></P></TD><TD VALIGN="TOP">This operation can be used to retrieve a phone device ID given a phone handle. It can also be used to obtain the device ID of the media device (e.g., mci waveform, mci midi, waveform, etc.) associated with the opened phone device. This ID can then be used with the appropriate media API (e.g., mci, midi, wav, etc.) to select the corresponding device.</P></TD></TR><TR><TD VALIGN="TOP"><B>See Also</B></P></TD><TD VALIGN="TOP">Data Types:  <B>VARSTRING</B></P></TD></TR><TR><TD VALIGN="TOP"><B>Fields:</B></P></TD><TD VALIGN="TOP">The following table indicates which fields of the <B>VARSTRING</B> data structure are filled in by the Service Provider and which fields are filled in by the TAPI DLL.  The Service Provider must preserve (i.e., must not overwrite) the values filled in by the TAPI DLL.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
  </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="95pt" VALIGN="TOP"><COL WIDTH="77pt" VALIGN="TOP"><COL WIDTH="98pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Field Name</B></P></TD><TD VALIGN="TOP">TAPI DLL</P></TD><TD VALIGN="TOP">Service Provider</P></TD></TR></TBODY></TABLE>
<BR></P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="95pt" VALIGN="TOP"><COL WIDTH="77pt" VALIGN="TOP"><COL WIDTH="98pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">dwTotalSize;</P></TD><TD VALIGN="TOP">X</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwNeededSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwUsedSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwStringFormat;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwStringSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwStringOffset;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR></TBODY></TABLE>
<BR></P></BODY></HTML>
