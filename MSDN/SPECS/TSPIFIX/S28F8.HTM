<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3.1.7.13  TSPI_phoneGetStatus</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H1>3.1.7.13  TSPI_phoneGetStatus</H1><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="325pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Syntax</B></P></TD><TD VALIGN="TOP">LONG<B> TSPI_phoneGetStatus</B>(dwRequestID, hdPhone, lpPhoneStatus)<BR>This operation enables the TAPI DLL to query the specified open phone device for its overall status.</P></TD></TR><TR><TD VALIGN="TOP"><B>Parameters</B></P></TD><TD VALIGN="TOP">DRV_REQUESTID    dwRequestID<BR>Specifies the identifier of the asynchronous request.  The Service Provider returns this value if the function completes asynchronously.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">HDRVPHONE    hdPhone<BR>Specifies the Service Provider's opaque handle to the phone to be queried.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">LPPHONESTATUS    lpPhoneStatus<BR>Specifies a far pointer to a variable sized data structure of type <B>PHONESTATUS</B>, which is loaded with the returned information about the phone's status.</P></TD></TR><TR><TD VALIGN="TOP"><B>Return Value</B></P></TD><TD VALIGN="TOP">Returns zero if the function is successful, the (positive) dwRequestID value if the function will be completed asynchronously, or a negative error number if an error has occurred. Possible error returns are:</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INVALPHONEHANDLE<BR>The specified device handle is invalid.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INVALPOINTER<BR>The specified pointer parameter is invalid.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_OPERATIONFAILED<BR>The specified operation failed for unspecified reasons.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comments</B></P></TD><TD VALIGN="TOP">The TAPI DLL can use this function to determine the current state of an open phone device. The status information describes information about the phone device's hook switch devices, ringer, volume, display, and lamps of the open phone.</P></TD></TR><TR><TD VALIGN="TOP"><B>See Also</B></P></TD><TD VALIGN="TOP">Messages:  <B>PHONE_STATE</B></P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">Data Types:  <B>PHONESTATUS</B></P></TD></TR><TR><TD VALIGN="TOP"><B>Fields:</B></P></TD><TD VALIGN="TOP">The following table indicates which fields of the <B>PHONESTATUS</B> data structure are filled in by the Service Provider and which fields are filled in by the TAPI DLL.  The Service Provider must preserve (i.e., must not overwrite) the values filled in by the TAPI DLL.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
  </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="133pt" VALIGN="TOP"><COL WIDTH="78pt" VALIGN="TOP"><COL WIDTH="136pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Field Name</B></P></TD><TD VALIGN="TOP">TAPI DLL</P></TD><TD VALIGN="TOP">Service Provider</P></TD></TR></TBODY></TABLE>
<BR></P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="133pt" VALIGN="TOP"><COL WIDTH="78pt" VALIGN="TOP"><COL WIDTH="136pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">dwTotalSize;</P></TD><TD VALIGN="TOP">X</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwNeededSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwUsedSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwStatusFlags; </P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwNumOwners;</P></TD><TD VALIGN="TOP">X</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwNumMonitors;</P></TD><TD VALIGN="TOP">X</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwRingMode;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwRingVolume;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwHandsetHookSwitchMode;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwHandsetVolume;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwHandsetGain;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwSpeakerHookSwitchMode;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwSpeakerVolume;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwSpeakerGain;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwHeadsetHookSwitchMode;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwHeadsetVolume;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwHeadsetGain;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwDisplaySize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwDisplayOffset;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwLampModesSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwLampModesOffset;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwOwnerNameSize;</P></TD><TD VALIGN="TOP">X</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwOwnerNameOffset;</P></TD><TD VALIGN="TOP">X</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwDevSpecificSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwDevSpecificOffset;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR></TBODY></TABLE>
<BR></P></BODY></HTML>
