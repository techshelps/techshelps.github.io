<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>2.4.2.10  Call Transfer</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>2.4.2.10  Call Transfer</H3>The Telephony SPI provides two mechanisms for call transfer: blind transfer and consultation transfer. In blind transfer (or single-step transfer), an existing call is transferred to a specified destination address in one phase using <B>TSPI_lineBlindTransfer</B>. Under a consultation transfer, the existing call is first prepared for transfer using <B>TSPI_lineSetupTransfer</B>. This places the existing call on consultation hold, and identifies the call as the target for the next transfer completion request. <B>TSPI_lineSetupTransfer</B> also allocates a consultation call that can be used to establish the consultation call with the party to be transferred to. The TAPI DLL can dial the extension of the destination party on the consultation call (using <B>TSPI_lineDial</B>), or it can drop and deallocate the consultation call and instead activate an existing held call (using <B>TSPI_lineUnhold</B>), if supported by the switch. </P>
While the initial call is on consultation hold and the consultation call is active, the TAPI DLL can toggle between these calls via <B>TSPI_lineSwapHold</B>.</P>
Finally, the TAPI DLL completes the transfer in one of two ways using <B>TSPI_lineCompleteTransfer</B>:</P>
<SPAN CLASS="list"><UL><LI>Transfer the call on transfer hold to the destination party. Both calls are cleared from the line (i.e., they transition to the <I>idle</I> state) but remain valid. </LI><LI>Enter a three-way conference. A new call handle is created to represent the conference and this handle is returned to the TAPI DLL.</LI></UL></SPAN>TSPI_lineSetupTransfer</P>
Prepares a specified call for transfer to another address.</P>
TSPI_lineCompleteTransfer</P>
Transfers a call that was set up for transfer to another call, or enter a three-way conference.</P>
TSPI_lineBlindTransfer</P>
Transfers a call that was set up for transfer to another call.</P>
TSPI_lineSwapHold</P>
Swaps the active call with the call currently on consultation hold.</P></BODY></HTML>
