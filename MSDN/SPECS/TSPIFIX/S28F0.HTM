<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3.1.7.5  TSPI_phoneGetDevCaps</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H1>3.1.7.5  TSPI_phoneGetDevCaps</H1><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="325pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Syntax</B></P></TD><TD VALIGN="TOP">LONG<B> TSPI_phoneGetDevCaps</B>(dwRequestID, dwDeviceID, dwTSPIVersion, lpPhoneCaps)</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">This function queries a specified phone device to determine its telephony capabilities.</P></TD></TR><TR><TD VALIGN="TOP"><B>Parameters</B></P></TD><TD VALIGN="TOP">DRV_REQUESTID    dwRequestID<BR>Specifies the identifier of the asynchronous request.  The Service Provider returns this value if the function completes asynchronously.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    dwDeviceID<BR>Specifies the phone device to be queried.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    dwTSPIVersion<BR>Specifies the negotiated TSPI version number.  This value has already been negotiated for this device through the <B>TSPI_phoneNegotiateTSPIVersion</B> function.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">LPPHONECAPS    lpPhoneCaps<BR>Specifies a far pointer to a variable sized structure of type <B>PHONECAPS</B>. Upon successful completion of the request, this structure is filled with phone device capabilities information.</P></TD></TR><TR><TD VALIGN="TOP"><B>Return Value</B></P></TD><TD VALIGN="TOP">Returns zero if the function is successful, the (positive) dwRequestID value if the function will be completed asynchronously, or a negative error number if an error has occurred. Possible error returns are:</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INVALPOINTER<BR>The specified pointer parameter is invalid.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_BADDEVICEID<BR>The specified device ID is out of range.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_NODRIVER<BR>The driver was not installed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INCOMPATIBLEVERSIONS<BR>The app requested a version range that cannot supported by the Telephony API implementation and corresponding service provider version.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_OPERATIONFAILED<BR>The specified operation failed for unspecified reasons.</P></TD></TR><TR><TD VALIGN="TOP"><B>Call States</B></P></TD><TD VALIGN="TOP">Not applicable.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comments</B></P></TD><TD VALIGN="TOP">Phone device ID numbering for a Service Provider is sequential from the value set by the function <B>TSPI_phoneSetDeviceIDBase</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">The dwExtVersion field of lpPhoneCaps has already been filled in to indicate the version number of the Extension information requested.  If it is zero, no Extension information is requested.  If it is non-zero it holds a value that has already been negotiated for this device with the function <B>TSPI_phoneNegotiateExtVersion</B>.  The Service Provider should fill in Extension information according to the Extension version specified.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comparison</B></P></TD><TD VALIGN="TOP">This function differs from the corresponding TAPI function in the following ways: </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">No application identifier is passed to the Service Provider</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">The SPI version has already been negotiated between the TAPI DLL and the Service Provider.  The final result of the negotiation is passed as a parameter to this function. The Service Provider must preserve the value that is present in the dwTAPIVersion field of the PHONECAPS structure.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">The Extension version number has already been negotiated, with the dwExtVersion  field containing the negotiated value.  The Service Provider must preserve the value in this field and fill in the DevSpecific portion of the data structure according to that Extension version requested (regardless of any currently selected Extension version).  The special version number 0 indicates that no DevSpecific data is requested and the Service Provider may avoid filling it in.</P></TD></TR><TR><TD VALIGN="TOP"><B>See Also</B></P></TD><TD VALIGN="TOP">Data Types:  <B>PHONECAPS<BR></B>Functions:  <B>TSPI_phoneSetDeviceIDBase, TSPI_phoneNegotiateExtVersion</B></P></TD></TR><TR><TD VALIGN="TOP"><B>Fields:</B></P></TD><TD VALIGN="TOP">The following table indicates which fields of the <B>PHONECAPS</B> data structure are filled in by the Service Provider and which fields are filled in by the TAPI DLL.  The Service Provider must preserve (i.e., must not overwrite) the values filled in by the TAPI DLL.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
  </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="160pt" VALIGN="TOP"><COL WIDTH="76pt" VALIGN="TOP"><COL WIDTH="112pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Field Name</B></P></TD><TD VALIGN="TOP">TAPI DLL</P></TD><TD VALIGN="TOP">Service Provider</P></TD></TR></TBODY></TABLE>
<BR></P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="160pt" VALIGN="TOP"><COL WIDTH="76pt" VALIGN="TOP"><COL WIDTH="112pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">dwTotalSize;</P></TD><TD VALIGN="TOP">X</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwNeededSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwUsedSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwAPIVersion;</P></TD><TD VALIGN="TOP">X</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwExtVersion;</P></TD><TD VALIGN="TOP">X</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwExtensionID0;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwExtensionID1;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwExtensionID2;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwExtensionID3;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwProviderInfoSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwProviderInfoOffset;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwPhoneInfoSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwPhoneInfoOffset;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwPermanentPhoneID;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwPhoneNameSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwPhoneNameOffset;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwStringFormat;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwPhoneStates;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwHookSwitchDevs;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwHandsetHookSwitchModes;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwSpeakerHookSwitchModes;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwHeadsetHookSwitchModes;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwVolumeFlags;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwGainFlags;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwDisplayNumRows;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwDisplayNumColumns;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwNumRingModes;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwNumButtonLamps;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwButtonModesSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwButtonModesOffset;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwButtonFunctionsSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwButtonFunctionsOffset;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwLampModesSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwLampModesOffset;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwNumSetData;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwSetDataSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwSetDataOffset;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwNumGetData</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwGetDataSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwGetDataOffset;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR></TBODY></TABLE>
<BR></P></BODY></HTML>
