<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3.1.7.16  TSPI_phoneNegotiateTSPIVersion</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H1>3.1.7.16  TSPI_phoneNegotiateTSPIVersion</H1><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="101pt" VALIGN="TOP"><COL WIDTH="321pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Syntax</B></P></TD><TD VALIGN="TOP">LONG<B> TSPI_phoneNegotiateTSPIVersion</B>(<I>dwDeviceID, dwLowVersion, dwHighVersion</I>)</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">This function returns the highest SPI version the Service Provider is willing to operate under for this device given the range of possible SPI versions.</P></TD></TR><TR><TD VALIGN="TOP"><B>Parameters</B></P></TD><TD VALIGN="TOP">DWORD    <I>dwDeviceID<BR></I>Identifies the phone device for which interface version negotiation is to be performed.  In addition to device IDs within the range the Service Provider supports, this may be the value:</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">INITIALIZE_NEGOTIATION<BR>This value is used to signify that an overall interface version is to be negotiated.  Such an interface version is required for functions that can be called early in the initialization sequence, i.e., before the device ID range has been set.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    <I>dwLowVersion<BR></I>Specifies the lowest TSPI version number under which the TAPI DLL is willing to operate.  The most-significant WORD is the major version number and the least-significant WORD is the minor version number.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    <I>dwHighVersion<BR></I>Specifies the highest TSPI version number under which the TAPI DLL is willing to operate.  The most-significant WORD is the major version number and the least-significant WORD is the minor version number.</P></TD></TR><TR><TD VALIGN="TOP"><B>Return Value</B></P></TD><TD VALIGN="TOP">The Service Provider returns the highest interface version number, within the range requested by the caller, under which the Service Provider is willing to operate.  If the requested range does not overlap the range supported by the Service Provider, it returns zero.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comments</B></P></TD><TD VALIGN="TOP">The TAPI DLL typically calls this function early in the initialization sequence for each phone device.  In addition, it calls this with the value <B>INITIALIZE_NEGOTIATION</B> for <I>dwDeviceID</I> to negotiate an interface version for calling early initialization functions such as <B>TSPI_phoneGetProcTable</B>.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">Negotiation of an Extension version is done through the separater procedure <B>TSPI_phoneNegotiateExtVersion</B>.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comparison</B></P></TD><TD VALIGN="TOP">There is no directly corresponding function at the TAPI level, at which both interface version negotiation and Extension version negotiation are done as overloaded uses of <B>phoneGetDevCaps</B>.</P></TD></TR><TR><TD VALIGN="TOP"><B>See Also</B></P></TD><TD VALIGN="TOP">Functions:  <B>TSPI_phoneGetProcTable, TSPI_phoneNegotiateExtVersion<BR></B>Constants:  <B>INITIALIZE_NEGOTIATION</B></P></TD></TR></TBODY></TABLE>
<BR></P></BODY></HTML>
