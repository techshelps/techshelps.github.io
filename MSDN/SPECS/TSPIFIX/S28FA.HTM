<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3.1.7.15  TSPI_phoneNegotiateExtVersion</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H1>3.1.7.15  TSPI_phoneNegotiateExtVersion</H1><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="325pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Syntax</B></P></TD><TD VALIGN="TOP">LONG<B> TSPI_phoneNegotiateTSPIVersion</B>(dwDeviceID, dwTSPIVersion, dwLowVersion, dwHighVersion)</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">This function returns the highest Extension version number the Service Provider is willing to operate under for this device given the range of possible Extension versions.</P></TD></TR><TR><TD VALIGN="TOP"><B>Parameters</B></P></TD><TD VALIGN="TOP">DWORD    dwDeviceID<BR>Identifies the phone device for which interface version negotiation is to be performed.  The value INITIALIZE_NEGOTIATION may not be used for this function.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    dwTSPIVersion<BR>Specifies an interface version number that has already been negotiated for this device using <B>TSPI_phoneNegotiateTSPIVersion</B>.  This function operates according to the interface specification at this version level.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    dwLowVersion<BR>Specifies the lowest Extension version number under which the TAPI DLL or its client application is willing to operate.  The most-significant WORD is the major version number and the least-significant WORD is the minor version number.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    dwHighVersion<BR>Specifies the highest Extension version number under which the TAPI DLL or its client application is willing to operate.  The most-significant WORD is the major version number and the least-significant WORD is the minor version number.</P></TD></TR><TR><TD VALIGN="TOP"><B>Return Value</B></P></TD><TD VALIGN="TOP">The Service Provider returns the highest Extension version number, within the range requested by the caller, under which the Service Provider is willing to operate.  If the requested range does not overlap the range supported by the Service Provider, the function returns zero.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comments</B></P></TD><TD VALIGN="TOP">This function may be called before or after the device has been opened by the TAPI DLL.  If the device is currently open and has an Extension version selected, the function should return that version number if it is within the requested range.  If the selected version number is outside the requested range, the function returns 0.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comparison</B></P></TD><TD VALIGN="TOP">There is no directly corresponding function at the TAPI level, at which both interface version negotiation and Extension version negotiation are done as overloaded uses of <B>phoneGetDevCaps</B>.</P></TD></TR><TR><TD VALIGN="TOP"><B>See Also</B></P></TD><TD VALIGN="TOP">Functions:  <B>TSPI_phoneGetProcTable, TSPI_phoneNegotiateExtVersion<BR></B>Constants:  <B>INITIALIZE_NEGOTIATION</B></P></TD></TR></TBODY></TABLE>
<BR></P></BODY></HTML>
