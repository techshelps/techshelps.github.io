<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3.1.7.6  TSPI_phoneGetDisplay</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H1>3.1.7.6  TSPI_phoneGetDisplay</H1><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="325pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Syntax</B></P></TD><TD VALIGN="TOP">LONG<B> TSPI_phoneGetDisplay</B>(<I>dwRequestID, hdPhone, lpDisplay</I>)<BR>This function returns the current contents of the specified phone display.</P></TD></TR><TR><TD VALIGN="TOP"><B>Parameters</B></P></TD><TD VALIGN="TOP">DRV_REQUESTID    <I>dwRequestID<BR></I>Specifies the identifier of the asynchronous request.  The Service Provider returns this value if the function completes asynchronously.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">HDRVPHONE    <I>hdPhone<BR></I>Specifies the Service Provider's opaque handle to the phone to be queried.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">LPVARSTRING    <I>lpDisplay<BR></I>Specifies a far pointer to the memory location where the display content is to be stored, of type <B>VARSTRING</B>. </P></TD></TR><TR><TD VALIGN="TOP"><B>Return Value</B></P></TD><TD VALIGN="TOP">Returns zero if the function is successful, the (positive) <I>dwRequestID</I> value if the function will be completed asynchronously, or a negative error number if an error has occurred. Possible error returns are:</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INVALPHONEHANDLE<BR>The specified device handle is invalid.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INVALPOINTER<BR>The specified pointer parameter is invalid.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INVALPHONESTATE<BR>The phone device is not in a valid state for the requested operation.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_OPERATIONUNAVAIL<BR>The specified operation is not available.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_OPERATIONFAILED<BR>The specified operation failed for unspecified reasons.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comments</B></P></TD><TD VALIGN="TOP">The <I>lpDisplay</I> memory area should be at least (<B>dwNumRows</B> * <B>dwNumColumns</B>) elements in size to receive all of the display information. <B>dwNumRows</B> and <B>dwNumColumns</B> are available in the <B>PHONECAPS</B> structure returned by <B>TSPI_phoneGetDevCaps</B>.</P></TD></TR><TR><TD VALIGN="TOP"><B>See Also</B></P></TD><TD VALIGN="TOP">Functions:  <B>TSPI_phoneGetDevCaps, TSPI_phoneSetDisplay</B></P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">Data Types:  <B>PHONECAPS, VARSTRING</B></P></TD></TR><TR><TD VALIGN="TOP"><B>Fields:</B></P></TD><TD VALIGN="TOP">The following table indicates which fields of the <B>VARSTRING</B> data structure are filled in by the Service Provider and which fields are filled in by the TAPI DLL.  The Service Provider must preserve (i.e., must not overwrite) the values filled in by the TAPI DLL.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
  </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="95pt" VALIGN="TOP"><COL WIDTH="77pt" VALIGN="TOP"><COL WIDTH="98pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Field Name</B></P></TD><TD VALIGN="TOP">TAPI DLL</P></TD><TD VALIGN="TOP">Service Provider</P></TD></TR></TBODY></TABLE>
<BR></P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="95pt" VALIGN="TOP"><COL WIDTH="77pt" VALIGN="TOP"><COL WIDTH="98pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">dwTotalSize;</P></TD><TD VALIGN="TOP">X</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwNeededSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwUsedSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwStringFormat;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwStringSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwStringOffset;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR></TBODY></TABLE>
<BR></P></BODY></HTML>
