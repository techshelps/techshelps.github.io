<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>4.1.1.21  PHONE_STATE</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>4.1.1.21  PHONE_STATE</H3>This message is sent to the TAPI DLL whenever a phone device's status changes.</P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="325pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Sent to</B></P></TD><TD VALIGN="TOP">PHONEEVENT</P></TD></TR><TR><TD VALIGN="TOP"><B>Parameters</B></P></TD><TD VALIGN="TOP">HTAPIPHONE    <I>htPhone<BR></I>Specifies the TAPI DLL's opaque object handle to the phone device.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    <I>dwMsg<BR></I>The value PHONE_STATE</P></TD></TR><TR><TD VALIGN="TOP"> </P></TD><TD VALIGN="TOP">DWORD    <I>dwParam1<BR></I>Specifies the phone state that has changed, of type PHONESTATE. Values are:</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_OTHER<BR>An other phone status information item not listed below has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_CONNECTED<BR>The connection between the phone device and the API was just made. This happens when the API is first invoked, or when the wire connection the phone to the PC is plugged in with the API active.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_DISCONNECTED<BR>The connection between the phone device and the API was just broken. This happens when the wire connecting the phone set to the PC is unplugged while the API is active.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_DISPLAY<BR>The display of the phone has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_LAMP<BR>A lamp of the phone has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_RINGMODE<BR>The ring mode of the phone has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_RINGVOLUME<BR>The ring volume of the phone has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_HANDSETHOOKSWITCH<BR>The handset hookswitch state has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_HANDSETVOLUME<BR>The handset's speaker volume setting has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_HANDSETGAIN<BR>The handset's mic gain setting has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_SPEAKERHOOKSWITCH<BR>The speakerphone's hookswitch state has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_SPEAKERVOLUME<BR>The speakerphone's speaker volume setting has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_SPEAKERGAIN<BR>The speakerphone's mic gain setting state has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_HEADSETHOOKSWITCH<BR>The headset's hookswitch state has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_HEADSETVOLUME<BR>The headset's speaker volume setting has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_HEADSETGAIN<BR>The headset's mic gain setting has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_SUSPEND<BR>The app's use of the phone is temporarily suspended.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_RESUME<BR>The app's use of the phone device is resumed after having been suspended for some time.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_DEVSPECIFIC<BR>The phone's device specific information has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    <I>dwParam2<BR></I>Specifies phone state dependent information detailing the status change. This field is not used if multiple flags are set in <I>dwParam1</I>, since multiple status items have changed. The TAPI DLL should invoke TSPI_phoneGetStatus to obtain complete set of information.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">If <I>dwParam1</I> is PHONESTATE_LAMP, then <I>dwParam2</I> contains the button/lamp ID of the lamp that has changed. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">If <I>dwParam1</I> is PHONESTATE_RING, then <I>dwParam2</I> contains the new ring mode. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">If <I>dwParam1</I> is PHONESTATE_HANDSET, SPEAKER or HEADSET, then <I>dwParam2</I> contains the new hookswitch mode of that hookswitch device, of type PHONEHOOKSWITCHMODE. Values are:</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEHOOKSWITCHMODE_ONHOOK<BR>The device's mic and speaker are both onhook.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEHOOKSWITCHMODE_MIC<BR>The device's mic is active, the speaker is mute.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEHOOKSWITCHMODE_SPEAKER<BR>The device's speaker is active, the mic is mute.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEHOOKSWITCHMODE_MICSPEAKER<BR>The device's mic and speaker are both active.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    <I>dwParam3<BR></I>Unused.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comments</B></P></TD><TD VALIGN="TOP">The sending of this message is controlled by <B>TSPI_phoneSetStatusMessages</B>. By default, this message is disabled for all state changes.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comparison</B></P></TD><TD VALIGN="TOP">The Service Provider never reports changed values for <B>PHONESTATE_OWNER</B> or <B>PHONESTATE_MONITOR</B>, since the notion of privilege does not appear at the TSPI level.</P></TD></TR><TR><TD VALIGN="TOP"><B>See Also</B></P></TD><TD VALIGN="TOP">Functions:  <B>TSPI_phoneGetStatus, TSPI_phoneSetStatusMessages</B><BR>Data Types: <B>PHONESTATE</B></P></TD></TR></TBODY></TABLE>
<BR></P></P>
<P></P>
 </P></BODY></HTML>
