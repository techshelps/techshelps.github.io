<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3.1.7.28  TSPI_phoneSetStatusMessages</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H1>3.1.7.28  TSPI_phoneSetStatusMessages</H1><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="325pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Syntax</B></P></TD><TD VALIGN="TOP">LONG<B> TSPI_phoneSetStatusMessages</B>(dwRequestID, hdPhone, dwPhoneStates, dwButtonModes, dwButtonStates)</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">This operation enables the TAPI DLL to monitor the specified phone device for selected status events.</P></TD></TR><TR><TD VALIGN="TOP"><B>Parameters</B></P></TD><TD VALIGN="TOP">DRV_REQUESTID    dwRequestID<BR>Specifies the identifier of the asynchronous request.  The Service Provider returns this value if the function completes asynchronously.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">HDRVPHONE    hdPhone<BR>Specifies the Service Provider's opaque handle to the phone whose state-change monitoring filter is to be set.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    dwPhoneStates<BR>These flags specify the set of phone status changes and events for which the TAPI DLL wishes to receive notification messages, of type <B>PHONESTATE</B>. Values are:</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_OTHER<BR>A non-specified phone status information item has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_CONNECTED<BR>The connection between the phone device and the Service Provider was just made. This happens when the API is first invoked, or when the wire connecting the phone to the PC is plugged in with the API active.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_DISCONNECTED<BR>The connection between the phone device and the Service Provider was just broken. This happens when the wire connecting the phone set to the PC is unplugged while the Service Provider is active.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_DISPLAY<BR>The display of the phone has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_LAMP<BR>A lamp of the phone has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_RINGMODE<BR>The ring mode of the phone has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_RINGVOLUME<BR>The ring volume of the phone has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_HANDSETHOOKSWITCH<BR>The handset hookswitch state has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_HANDSETVOLUME<BR>The handset's speaker volume setting has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_HANDSETGAIN<BR>The handset's mic gain setting has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_SPEAKERHOOKSWITCH<BR>The speakerphone's hookswitch state has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_SPEAKERVOLUME<BR>The speakerphone's speaker volume setting has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_SPEAKERGAIN<BR>The speakerphone's mic gain setting state has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_HEADSETHOOKSWITCH<BR>The headset's hookswitch state has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_HEADSETVOLUME<BR>The headset's speaker volume setting has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_HEADSETGAIN<BR>The headset's mic gain setting has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_SUSPEND<BR>The TAPI DLL's use of the phone is temporarily suspended.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_RESUME<BR>The TAPI DLL's use of the phone device is resumed after having been suspended for some time.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONESTATE_DEVSPECIFIC<BR>The phone's device specific information has changed.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    dwButtonModes<BR>These flags specify the set of phone button modes for which the TAPI DLL wishes to receive notification messages, of type <B>PHONEBUTTONMODE</B>. Values are:</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEBUTTONMODE_CALL<BR>The button is assigned to a call appearance.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEBUTTONMODE_FEATURE<BR>The button is assigned to requesting features from the switch, such as hold, conference, transfer, etc.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEBUTTONMODE_KEYPAD<BR>The button is one of the twelve keypad buttons, '0' through '9', '*', and '#'.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEBUTTONMODE_LOCAL<BR>The button is a local function button, such as mute or volume control.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEBUTTONMODE_DISPLAY<BR>The button is a "soft" button associated with the phone's display. A phone set can have zero or more display buttons. </P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    dwButtonStates<BR>These flags specify the set of phone button state changes for which the TAPI DLL wishes to receive notification messages, of type <B>PHONEBUTTONSTATE</B>. Values are:</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEBUTTONSTATE_UP<BR>The button is in the "up" state.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEBUTTONSTATE_DOWN<BR>The button is in the "down" state (i.e., pressed down).</P></TD></TR><TR><TD VALIGN="TOP"><B>Return Value</B></P></TD><TD VALIGN="TOP">Returns zero if the function is successful, the (positive) dwRequestID value if the function will be completed asynchronously, or a negative error number if an error has occurred. Possible error returns are:</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INVALPHONEHANDLE<BR>The specified line device handle is invalid.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INVALPHONESTATE<BR>The specified phone states parameter is invalid.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INVALBUTTONMODE<BR>The button mode parameter is invalid.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INVALBUTTONSTATE<BR>The button states parameter is invalid.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_OPERATIONUNAVAIL<BR>The specified operation is not available.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_OPERATIONFAILED<BR>The specified operation failed for unspecified reasons.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comments</B></P></TD><TD VALIGN="TOP">The TAPI defines a number of messages that notify applications about events occurring on phones.  The sets of all change messages that all applications are interested may be much smaller than the set of possible messages.  This procedure allows the TAPI DLL to tell the Service Provider the reduced set of messages that should be delivered.  The Service Provider must deliver at least this set.  It is permitted to deliver more, but it is discouraged from doing so for performance reasons.  All phone status messages are disabled by default.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comparison</B></P></TD><TD VALIGN="TOP">This function differs from the corresponding TAPI function as follows: (1) The set of messages requested is the union of all sets requested by applications at the TAPI level. (2) The message set is neither reduced nor augmented by ownership (since there is no concept of ownership at the TSPI level) (3) The set is "advisory" in the sense that the Service Provider is required to forward at least the indicated set of messages but is permitted to forward a larger set.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">The Service Provider never reports state changes related to the number of outstanding Opens because there is only ever one Open at the TSPI level, and there are no distinct privelege levels.</P></TD></TR><TR><TD VALIGN="TOP"><B>See Also</B></P></TD><TD VALIGN="TOP">Functions:  <B>TSPI_phoneGetStatusMessages<BR></B>Messages:  <B>PHONE_STATE, PHONE_BUTTON<BR></B>Data Types: <B>PHONESTATE</B></P></TD></TR></TBODY></TABLE>
<BR></P></BODY></HTML>
