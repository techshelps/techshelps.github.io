<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3.1.7.3  TSPI_phoneGetButtonInfo</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H1>3.1.7.3  TSPI_phoneGetButtonInfo</H1><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="325pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Syntax</B></P></TD><TD VALIGN="TOP">LONG<B> TSPI_phoneGetButtonInfo</B>(dwRequestID, hdPhone, dwButtonLampID, lpButtonInfo)<BR>This function returns information about the specified button.</P></TD></TR><TR><TD VALIGN="TOP"><B>Parameters</B></P></TD><TD VALIGN="TOP">DRV_REQUESTID    dwRequestID<BR>Specifies the identifier of the asynchronous request.  The Service Provider returns this value if the function completes asynchronously.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">HDRVPHONE    hdPhone<BR>Specifies the Service Provider's opaque handle to the phone to be queried.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    dwButtonLampID<BR>Specifies a button on the phone device.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">LPPHONEBUTTONINFO    lpButtonInfo<BR>Specifies a far pointer to a variable sized structure of type <B>PHONEBUTTONINFO</B>. This data structure describes the mode, the function, and provides additional descriptive text corresponding to the button.</P></TD></TR><TR><TD VALIGN="TOP"><B>Return Value</B></P></TD><TD VALIGN="TOP">Returns zero if the function is successful, the (positive) dwRequestID value if the function will be completed asynchronously, or a negative error number if an error has occurred. Possible error returns are:</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INVALPHONEHANDLE<BR>The specified device handle is invalid.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INVALBUTTOMLAMPID<BR>The specified button/lamp ID is invalid.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_INVALPOINTER<BR>The specified pointer parameter is invalid.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_OPERATIONUNAVAIL<BR>The specified operation is not available.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">PHONEERR_OPERATIONFAILED<BR>The specified operation failed for unspecified reasons.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comments</B></P></TD><TD VALIGN="TOP">None.</P></TD></TR><TR><TD VALIGN="TOP"><B>See Also</B></P></TD><TD VALIGN="TOP">Functions:  <B>TSPI_phoneSetButtonInfo<BR></B>Data Types:  <B>PHONEBUTTONINFO</B>, <B>PHONECAPS</B></P></TD></TR><TR><TD VALIGN="TOP"><B>Fields:</B></P></TD><TD VALIGN="TOP">The following table indicates which fields of the <B>PHONEBUTTONINFO</B> data structure are filled in by the Service Provider and which fields are filled in by the TAPI DLL.  The Service Provider must preserve (i.e., must not overwrite) the values filled in by the TAPI DLL.</P></TD></TR></TBODY></TABLE>
<BR></P></P>
  </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="117pt" VALIGN="TOP"><COL WIDTH="78pt" VALIGN="TOP"><COL WIDTH="103pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Field Name</B></P></TD><TD VALIGN="TOP">TAPI DLL</P></TD><TD VALIGN="TOP">Service Provider</P></TD></TR></TBODY></TABLE>
<BR></P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="117pt" VALIGN="TOP"><COL WIDTH="78pt" VALIGN="TOP"><COL WIDTH="103pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP">dwTotalSize;</P></TD><TD VALIGN="TOP">X</P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwNeededSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwUsedSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwButtonMode;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwButtonFunction;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwButtonTextSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwButtonTextOffset;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP"></P></TD></TR><TR><TD VALIGN="TOP">dwDevSpecificSize;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR><TR><TD VALIGN="TOP">dwDevSpecificOffset;</P></TD><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">X</P></TD></TR></TBODY></TABLE>
<BR></P></BODY></HTML>
