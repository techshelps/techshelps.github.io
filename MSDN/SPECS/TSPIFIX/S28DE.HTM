<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>2.5.2.1  Hookswitch Devices</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>2.5.2.1  Hookswitch Devices</H3>A phone device may have multiple hookswitch devices. The SPI defines three types of hookswitch devices for a phone: handset, speakerphone and headset. Each hookswitch device has a speaker and a mic component. Each hookswitch device is in one of four hookswitch modes:</P>
<SPAN CLASS="list"><UL><LI><B>    onhook </B>- The hookswitch device is onhook, and both its mic and speaker are disabled.</LI><LI><B>    mic only</B> - The hookswitch device is offhook, its mic is enabled and its speaker is mute.</LI><LI><B>    speaker only - </B>The hookswitch device is offhook, its mic is mute and its speaker is enabled.</LI><LI><B>    mic and speaker </B>- The hookswitch device is offhook, both mic and speaker are enabled.</LI></UL></SPAN>The TAPI DLL can set and query hookswitch mode of an opened phone's hookswitch devices. To mute/unmute the mic or speaker component of a hookswitch device, the operation <B>TSPI_phoneSetHookSwitch</B> is used with the appropriate hookswitch mode.</P>
TSPI_phoneSetHookSwitch</P>
Sets the hookswitch mode of one or more of the hookswitch devices of an open phone device.</P>
TSPI_phoneGetHookSwitch</P>
Queries the hookswitch mode of a hookswitch device of an open phone device.</P>
When the mode of a phone's hookswitch device is changed manually, for example by lifting the handset from its cradle, a PHONE_STATUS message is sent to the TAPI DLL's callback to notify the TAPI DLL about the state change. Parameters to this message provide an indication of the change.</P>
The speaker component of a hookswitch device can be volume controlled. Note that volume setting is different from mute in that muting a speaker and later unmuting it will preserve the volume setting of the speaker.</P>
TSPI_phoneSetVolume</P>
Sets the volume of a hookswitch device's speaker of an open phone device.</P>
TSPI_phoneGetVolume</P>
Returns the volume setting of a hookswitch device's speaker of an open phone device.</P>
The mic component of a hookswitch device can be gain controlled. Note that gain setting is different from mute in that muting a mic and later unmuting it will preserve the gain setting of the mic.</P>
TSPI_phoneSetGain</P>
Sets the gain of a hookswitch device's mic of an open phone device.</P>
TSPI_phoneGetGain</P>
Returns the gain setting of a hookswitch device's mic of an opened phone.</P>
When the volume or gain of a phone's hookswitch device is changed, a PHONE_STATUS message is sent to the TAPI DLL's callback to notify the TAPI DLL about the state change. Parameters to this message provide an indication of the change.</P></BODY></HTML>
