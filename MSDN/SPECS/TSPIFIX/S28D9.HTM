<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>2.4.2.15  Call Completion</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>2.4.2.15  Call Completion</H3>When making an outbound call, the unavailability of certain resources may prevent the call from reaching the <I>connected</I> state; e.g., if the destination party is busy or doesn't answer. Unavailable resources include trunk circuits as well as the destination party's station. <B>TSPI_lineCompleteCall</B> allows the TAPI DLL to specify how its wants to complete a call that cannot be completed normally. The TAPI DLL has the following options:</P>
<SPAN CLASS="list"><UL><LI><B>    Camp on</B> to queue the call until the call can be completed. </LI><LI><B>    Call back</B> requests the called station to return the call when it returns to idle. Answering the call back may automatically re-initiate (i.e., redial) the connection request.  </LI><LI><B>    Intrude</B> allows the TAPI DLL to barge in to the existing call.</LI><LI><B>    Message</B> (aka "leave word calling") allows the TAPI DLL to send one of a small number of predefined messages to the destination. These messages can be text shown on the phone's display, a voice message left for the user, etc.</LI></UL></SPAN>A call completion request can be canceled via <B>TSPI_lineUncompleteCall</B>. Multiple call completion request can potentially be outstanding for a given address at any one time. To identify individual requests, the implementation returns a completion ID. When a call completion request completes and results in a new call, then the call completion ID is available in the <B>LINECALLINFO</B> data structure returned by <B>TSPI_lineGetCallInfo</B>. Canceling a call completion request in progress also uses this call completion ID. </P>
TSPI_lineCompleteCall</P>
Places a call completion request.</P>
TSPI_lineUncompleteCall</P>
Cancels a call completion request.</P></BODY></HTML>
