<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>4.1.0.15  LINE_NEWCALL</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H3>4.1.0.15  LINE_NEWCALL</H3>This message is sent whenever a new incoming call arrives on a line that the TAPI DLL has open.  This must be the first message sent regarding that call.  The TAPI DLL writes the <B>htCall</B> opaque handle to the location passed by the Service Provider as <I>dwParam2</I>.  This gives the Service Provider the <B>htCall</B> value to be used in subsequent messages.</P>
  </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="325pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Sent to</B></P></TD><TD VALIGN="TOP">LINEEVENT</P></TD></TR></TBODY></TABLE>
<BR></P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="325pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Parameters</B></P></TD><TD VALIGN="TOP">HTAPILINE    <I>htLine<BR></I>Specifies the TAPI DLL's opaque object handle to the line device.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">HTAPICALL    <I>htCall<BR></I>Unused</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    <I>dwMsg<BR></I>The value LINE_NEWCALL</P></TD></TR><TR><TD VALIGN="TOP"><B> </B></P></TD><TD VALIGN="TOP">DWORD    <I>dwParam1<BR></I>Specifies the Service Provider's opaque handle for the call, of type <B>HDRVCALL</B>.  The TAPI DLL will pass this value as the <I>hdCall</I> parameter to identify the call in subsequent procedures it invokes to operate on the call.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    <I>dwParam2<BR></I>A pointer of type <B>LPHTAPICALL</B> pointing to a <B>HTAPICALL</B>.  The TAPI DLL writes the TAPI DLL's opaque handle for the call to the indicated location.  The  Service Provider must save this value and pass it as the <I>htCall</I> parameter to identify the call in subsequent events it reports for the call.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">DWORD    <I>dwParam3<BR></I>Unused</P></TD></TR><TR><TD VALIGN="TOP"><B>Comments</B></P></TD><TD VALIGN="TOP">The Service Provider should send the <B>LINE_CALLSTATE</B> message as the next message for this call.  The <B>LINE_NEWCALL</B> event is unusual in the sense that it also passes a value back to the Service Provider.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comparison</B></P></TD><TD VALIGN="TOP">There is no directly corresponding message at the TAPI level.  This message is used at the TSPI level to uniquely and unambiguously introduce a new incoming call to the TAPI DLL and retrieve the TAPI DLL's opaque identifier for the call.</P></TD></TR><TR><TD VALIGN="TOP"><B>See Also</B></P></TD><TD VALIGN="TOP">Messages:  <B>LINE_CALLSTATE</B></P></TD></TR></TBODY></TABLE>
<BR></P></BODY></HTML>
