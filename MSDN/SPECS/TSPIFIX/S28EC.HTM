<HTML><HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3.1.7.1  TSPI_phoneClose</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

</OBJECT></FORM>
<H1>3.1.7.1  TSPI_phoneClose</H1>  </P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="325pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><B>Syntax</B></P></TD><TD VALIGN="TOP">void <B>TSPI_phoneClose</B>(<I>hdPhone</I>)<BR>This function closes the specified open phone device after completing or aborting all outstanding asynchronous operations on the device.</P></TD></TR><TR><TD VALIGN="TOP"><B>Parameters</B></P></TD><TD VALIGN="TOP">HDRVPHONE    <I>hdPhone<BR></I>Specifies the Service Provider's opaque handle to the phone to be closed.  After the phone has been successfully closed, this handle is no longer valid.</P></TD></TR><TR><TD VALIGN="TOP"><B>Return Value</B></P></TD><TD VALIGN="TOP">None.  This function is presumed to complete successfully and synchronously.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comments</B></P></TD><TD VALIGN="TOP">The Service Provider has the responsibility to (eventually) report completion for every operation it decides to execute asynchronously.  If this procedure is called for a phone on which there are outstanding asynchronous operations, the operations should be reported complete with an appropriate result or error code before this procedure returns.  Generally the TAPI DLL would wait for these to complete in an orderly fashion.  However, the Service Provider should be prepared to handle an early call to TSPI_phoneClose in "abort" or "emergency shutdown" situtations.</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">After this procedure returns the Service Provider must report no further events on the phone.  The Service Provider's opaque handle for the phone becomes "invalid".</P></TD></TR><TR><TD VALIGN="TOP"></P></TD><TD VALIGN="TOP">The Service Provider must relinquish non-sharable resources it reserves while the phone is open.  For example, closing a phone accessed through a comm port and modem should result in closing the comm port, making it once available for use by other applications.</P></TD></TR><TR><TD VALIGN="TOP"><B>Comparison</B></P></TD><TD VALIGN="TOP">This operation is strictly synchronous with presumed success in contrast to the phoneClose function defined at the TAPI level which allows for failure and asynchronous operation.</P></TD></TR><TR><TD VALIGN="TOP"><B>See Also</B></P></TD><TD VALIGN="TOP">Messages:  <B>PHONE_CLOSE</B></P></TD></TR></TBODY></TABLE>
<BR></P></BODY></HTML>
