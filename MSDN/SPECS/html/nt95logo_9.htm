<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<META HTTP-EQUIV="Content-Type" Content="text-html; Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installation</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>



<h4>Installation</h4>
<p>
<b>User Experience</b></p>
<p>
<b>Required:</b><BR>The product must have an installation program with a graphical Setup program that executes in a 32-bit Microsoft Windows operating system.</p>
<p>
<b>Required:<BR></b>The installer must either lead the user through the process in a user attended mode, (not just instruct the user to copy or decompress files) or provide a facility for a 'silent' or unattended install requiring no user input.  Preferably, (though not required) the application will provide both options.</p>
<p>
<b>Required:</b><BR>The installer must automatically detect the version of Microsoft&nbsp;Windows NT and/or Windows 95 running and install the correct version of your product automatically. This must be a seamless experience for the user.</p>
<p>
<b>Required:</b><BR>All shortcuts created by the installation must be viable, that is, not result in &quot;file not found&quot; or other error conditions when activated.</p>
<p>
<b>Required:<BR></b>Products distributed on CD-ROM must utilize the AutoPlay feature to begin setup or launch the program itself the first time the application is run. It is up to the vendor whether AutoPlay is enabled on subsequent insertions of the CD-ROM.  In the case of products distributed on multiple CD-ROMs, subsequent CD-ROMs must either utilize the AutoPlay feature or behave during install like a subsequent floppy disk (continue install without prompting user for action.)  It is not acceptable to require the end user to Start, Run the CD-ROM during installation.</p>
<p>
<b>Required:<BR></b>The installer for media other than CD-ROM must provide the ability to launch the installer through <b>Add/Remove Programs</b> in the Control Panel. </p>
<p>
<b>Required:<BR></b>The application must default installation to a directory (or directories) under &quot;drive:\Program Files&quot;.  The installer must query the registry for this directory path to ensure appropriate install if, for example, a user has renamed this directory on their machine, or if the application is being installed onto a non-English language, localized version of Windows.</p>
<p>
<b>Required:<BR></b>The application's installer must not install application DLLs or executables under the system root.</p>
<p>
<b>Required:<BR></b>The installer must check <b>before</b> starting any operation to ensure that it can complete that operation.  The following are the requirements based on this principle.<b> </b>
<ul>
<li>
Installers must fail gracefully in the case where a system component cannot be replaced because file system security prevents an existing file from being overwritten. Installers that need to overwrite system files, for example, should check up-front if the current user is a member of the administrators local group. This will avoid confusion later by preventing the user from getting file copy errors from which there is no recovery.<br><br></li>
<li>
Applications must be tested on Windows NT under non-administrator accounts. An application must run under a user account but that user must not be able to change the application setup configuration.<br><br></li>
<li>
When installing the application, the installer must check for the user privilege level. If the user is not an administrator and the application will work but with limited functionality, the installer must warn the user that only limited functionality will be available since they do not have admin privileges, and the installer must allow them to discontinue the installation.  This may be accomplished by using the Sample Code below or the KB article PSS ID# Q118626.  </li>
</ul>
<p>
<b>Sample Code</b>:</p>
<pre><code>//--------------------------------------------------------//
//&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09;&#09; 
// IsAdmin() - tests to see if the current user is an admin
//
//--------------------------------------------------------//

BOOL IsAdmin() {
&#09;
&#09;SC_HANDLE hSC;

&#09;//
&#09;// Try an Admin Privileged API - if it works return
&#09;// TRUE - else FALSE
&#09;//
       hSC = OpenSCManager(
              NULL,
              NULL,
              GENERIC_READ | GENERIC_WRITE | GENERIC_EXECUTE
              );

    if( hSC == NULL ) {
&#09;&#09;return FALSE;
    }
    
&#09;CloseServiceHandle( hSC );
&#09;return TRUE;
}</code></pre>
<dl>
<dt>
<b>Recommended:<BR></b>Applications should not assume that directory names will be in the English language, or unchanged by the user (for example, &quot;Program Files&quot;.)  Applications should query the registry directly to obtain the proper, language specific directory names.  Vendors should be aware that English versions of their application might be installed onto a non-English language version of Windows.  In this instance a search for the English language directory string  &quot;Program Files&quot; would not be successful &amp; would result in a failed install.  For other folders the proper paths can be queried via the <b>SHGetSpecialFolderLocation()</b> function with the following CSIDL flags: </dt>
<dd>
<pre><code>#define CSIDL_PROGRAMS                  0x0002
#define CSIDL_PERSONAL                  0x0005
#define CSIDL_FAVORITES                 0x0006
#define CSIDL_STARTUP                   0x0007
#define CSIDL_RECENT                    0x0008
#define CSIDL_SENDTO                    0x0009
#define CSIDL_STARTMENU                 0x000b
#define CSIDL_DESKTOPDIRECTORY          0x0010
#define CSIDL_NETHOOD                   0x0013
#define CSIDL_TEMPLATES                 0x0015
#define CSIDL_COMMON_STARTMENU          0x0016
#define CSIDL_COMMON_PROGRAMS           0X0017
#define CSIDL_COMMON_STARTUP            0x0018
#define CSIDL_COMMON_DESKTOPDIRECTORY   0x0019
#define CSIDL_APPDATA                   0x001a
#define CSIDL_PRINTHOOD                 0x001b</code></pre>
</dd>
</dl>
<p>
<b>Recommendations to enable roaming users &amp; unattended install:</b></p>
<p>
<b>Recommended:<BR></b>User settings should be maintained across application version changes.  It’s also recommended that user settings be able to be moved from machine to machine.   Examples of user settings include customized toolbars, any dynamic, user-generated lists or other user specific options.  For information about supporting a Networked or Managed environment refer to section 6.2.4.</p>
<p>
<b>Recommended:<BR></b>If the application can be sure it is installing on a single user machine, it should collect user name or Personal ID (PID) information the first time the application is run, not during install.</p>
<p>
<b>Using the Registry</b></p>
<p>
<b>Required:<BR></b>Native data file types (if applicable) must be registered as follows:</p>
<p>
 [HKEY_CLASSES_ROOT]</p>
<p>
.(file type extension)<BR>&#09;(Default) = REG_SZ:FileTypeID</p>
<p>
See the “Windows Interface Guidelines for Software Design,&quot; chapter 10  (available from MS Press), for further details on registering file types and application data.</p>
<p>
<b>Required:<BR></b>The application installer must register <i>all</i> shared components designed to be uninstalled under the following Registry key:</p>
<p>
[HKEY_LOCAL_MACHINE]\SOFTWARE\Microsoft\Windows\Current Version\SharedDLLs</p>
<p>
<b>Required:<BR></b>The installer must <i>not </i>register components that are self-registering, such as DirectX and Direct3D. The installers for these components will register their components as needed.</p>
<p>
<b>Required:<BR></b>Core components must <i>not</i> be refcounted in the registry by application installers. Please see <a href="http://www.microsoft.com/windows/thirdparty/winlogo/">http://www.microsoft.com/windows/thirdparty/winlogo/</a> for the most up-to-date and complete list of Windows 95 and Windows NT core components.</p>
<p>
<b>Required:<BR></b>The application must not add information to Win.ini or System.ini.</p>
<p>
<b>Exception</b>:<BR>Certain multimedia applications may require video codecs not supplied with Windows NT or 95. Products that must support links to existing 16-bit products may write to these files. Certain other products, such as screen savers, may not be supported in the Registry and must write to the .ini files. Writes to the embedded section of Win.ini may be unavoidable. It is okay to write to the font section of Win.ini and to leave behind fonts and font information after uninstallation.</p>
<p>
Any writes to Win.ini or System.ini must be explained in the Vendor Questionnaire.</p>
<p>
<b>Recommended:<BR></b>In addition to the above requirements, the following behaviors are strongly recommended with regard to registry usage:
<ul>
<li>
Applications should provide the following set of information in the registry.  This information will be used by the Add/Remove Programs Control Panel to provide a central place for information about the application.<br><br></li>
<li>
The registry values in the table below should be written under the following key:</li>
<p>
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall\NameofApplication&#09; &#09;

<table><tr valign=top>
<TD>

<b>
Name of Value</b></td>
<TD>

<b>
Type</b></td>
<TD>

<b>
Contains</b></td>
</tr>
<tr valign=top>
<TD>

DisplayName</td>

<TD>

REG_SZ</td>

<TD>

Display Name of Application.</td>

</tr>
<tr valign=top>
<TD>

UninstallPath</td>

<TD>

REG_SZ*</td>

<TD>

Full path to the Application’s uninstall program.</td>

</tr>
<tr valign=top>
<TD>

ModifyPath</td>

<TD>

REG_SZ*</td>

<TD>

Full path to the Application’s setup/modify program.</td>

</tr>
<tr valign=top>
<TD>

InstallLocation</td>

<TD>

REG_SZ*</td>

<TD>

Full path where the Application is located (folder or *.exe).</td>

</tr>
<tr valign=top>
<TD>

InstallSource</td>

<TD>

REG_SZ*</td>

<TD>

Location where the Application was installed from.</td>

</tr>
<tr valign=top>
<TD>

</td>

<TD>

</td>

<TD>

</td>

</tr>
<tr valign=top>
<TD>

DisplayVersion</td>

<TD>

REG_SZ</td>

<TD>

Displayed version number of Application.</td>

</tr>
<tr valign=top>
<TD>

VersionMajor</td>

<TD>

DWORD</td>

<TD>

Major Version Number of Application.</td>

</tr>
<tr valign=top>
<TD>

VersionMinor</td>

<TD>

DWORD</td>

<TD>

Minor Version of Application.</td>

</tr>
<tr valign=top>
<TD>

Publisher</td>

<TD>

REG_SZ</td>

<TD>

Publisher/Developer of Application.</td>

</tr>
<tr valign=top>
<TD>

ProductID</td>

<TD>

REG_SZ</td>

<TD>

Product ID of installed Application.</td>

</tr>
<tr valign=top>
<TD>

RegOwner</td>

<TD>

REG_SZ</td>

<TD>

Registered owner of Application.</td>

</tr>
<tr valign=top>
<TD>

RegCompany</td>

<TD>

REG_SZ</td>

<TD>

Registered company of Application.</td>

</tr>
<tr valign=top>
<TD>

HelpTelephone</td>

<TD>

REG_SZ</td>

<TD>

Telephone number for support/help.</td>

</tr>
<tr valign=top>
<TD>

HelpLink</td>

<TD>

REG_SZ*</td>

<TD>

Full path of Helpfile or Help URL for Application.</td>

</tr>
<tr valign=top>
<TD>

URLUpdateInfo</td>

<TD>

REG_SZ*</td>

<TD>

URL of Update Informaton for Application.</td>

</tr>
<tr valign=top>
<TD>

URLInfoAbout</td>

<TD>

REG_SZ*</td>

<TD>

URL that provides a link to the publisher’s home page or the application’s home page.</td>

</tr>
</table><br>
<p>
* For Windows NT 4.0, Windows95, and future versions of Windows 95, the REG_SZ notation should be used for all registry entries requiring string values.  However, for Windows NT 5.0, the REG_EXPAND_SZ notation should be used whenever possible for all string entries with asterisks.</p>
<p>
InstallSource:<b> </b>This is the path from which the application was installed.   It could also be an HTTP site or a network UNC path, such as \\applications\sample.  If the application were installed from floppy, then this value would be a:\, for the floppy drive letter.   This value also supports multiple paths.  To add additional paths, just separate each path with a semicolon.  For example:<BR>InstallSource = \\applications\sample; <u>\\corpnet\sample</u></p>
<p>
VersionMajor/VersionMinor: Future versions of Add/Remove Programs will use these two values to compute whether an upgrade is necessary.  These values will not be displayed to the user.  The numbering and ordering scheme of these numbers are up to the application.  Note that newer versions of the application must have a larger VersionMinor and/or a larger VersionMajor field to indicate an update.</p>
</li>
</ul>
</FONT></BODY>
</HTML>
