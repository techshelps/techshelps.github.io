<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SHEXINIT.CPP</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context6571"></a>SHEXINIT.CPP</h2>
<pre><code>// THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT WARRANTY OF <br>// ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO <br>// THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A <br>// PARTICULAR PURPOSE. <br>// <br>// Copyright 1993 - 1998 Microsoft Corporation.  All Rights Reserved. <br>// <br>//  MODULE:   shexinit.cpp <br>// <br>//  PURPOSE:   Implements the IShellExtInit member function necessary to support <br>//             the context menu and property sheet portioins of this shell extension.   <br>// <br> <br>#include "priv.h" <br>#include "shellext.h" <br> <br> <br>// <br>//  FUNCTION: CShellExt::Initialize(LPCITEMIDLIST, LPDATAOBJECT, HKEY) <br>// <br>//  PURPOSE: Called by the shell when initializing a context menu or property <br>//           sheet extension. <br>// <br>//  PARAMETERS: <br>//    pIDFolder - Specifies the parent folder <br>//    pDataObj  - Spefifies the set of items selected in that folder. <br>//    hRegKey   - Specifies the type of the focused item in the selection. <br>// <br>//  RETURN VALUE: <br>// <br>//    NOERROR in all cases. <br>// <br>//  COMMENTS:   Note that at the time this function is called, we don't know  <br>//              (or care) what type of shell extension is being initialized.   <br>//              It could be a context menu or a property sheet. <br>// <br> <br>STDMETHODIMP CShellExt::Initialize(LPCITEMIDLIST pIDFolder, <br>                                   LPDATAOBJECT pDataObj, <br>                                   HKEY hRegKey) <br>{ <br>    ODS("CShellExt::Initialize()\r\n"); <br> <br>    // Initialize can be called more than once <br> <br>    if (m_pDataObj) <br>    m_pDataObj-&gt;Release(); <br> <br>    // duplicate the object pointer and registry handle <br> <br>    if (pDataObj) <br>    { <br>    m_pDataObj = pDataObj; <br>    pDataObj-&gt;AddRef(); <br>    } <br> <br>    return NOERROR; <br>} <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
