<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>lineGetStatusMessages</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_linegetstatusmessages"></a>lineGetStatusMessages</h1>
<p>
The <b>lineGetStatusMessages</b> function enables an application to query which notification messages the application is set up to receive for events related to status changes for the specified line or any of its addresses. </p>
<pre><code><b>LONG lineGetStatusMessages(
  HLINE</b><i> hLine</i><b>,             </b>
<b>  LPDWORD</b><i> lpdwLineStates</i><b>,  </b>
<b>  LPDWORD</b><i> lpdwAddressStates  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hLine</i> </dt>
<dd>
A handle to the line device. </dd>
<dt>
<i>lpdwLineStates</i> </dt>
<dd>
A bit array that identifies for which line device status changes a message is to be sent to the application. If a flag is TRUE, that message is enabled; if FALSE, it is disabled. Note that multiple flags can be set. This parameter uses the following LINEDEVSTATE_ constants: 
<dl>
<dt>
LINEDEVSTATE_OTHER </dt>
<dd>
Device-status items other than those listed below have changed. The application should check the current device status to determine which items have changed. </dd>
<dt>
LINEDEVSTATE_RINGING </dt>
<dd>
The switch tells the line to alert the user. Service providers notify applications on each ring cycle by sending <a href="msgs_7het.htm">LINE_LINEDEVSTATE</a> messages containing this constant. For example, in the United States, service providers send a message with this constant every six seconds. </dd>
<dt>
LINEDEVSTATE_CONNECTED </dt>
<dd>
The line was previously disconnected and is now connected to TAPI. </dd>
<dt>
LINEDEVSTATE_NUMCOMPLETIONS </dt>
<dd>
The number of outstanding call completions on the line device has changed. </dd>
<dt>
LINEDEVSTATE_DISCONNECTED </dt>
<dd>
This line was previously connected and is now disconnected from TAPI. </dd>
<dt>
LINEDEVSTATE_MSGWAITON </dt>
<dd>
The "message waiting" indicator is turned on. </dd>
<dt>
LINEDEVSTATE_MSGWAITOFF </dt>
<dd>
The "message waiting" indicator is turned off. </dd>
<dt>
LINEDEVSTATE_INSERVICE </dt>
<dd>
The line is connected to TAPI. This happens when TAPI is first activated or when the line wire is physically plugged in and in service at the switch while TAPI is active. </dd>
<dt>
LINEDEVSTATE_OUTOFSERVICE </dt>
<dd>
The line is out of service at the switch or physically disconnected. TAPI cannot be used to operate on the line device. </dd>
<dt>
LINEDEVSTATE_MAINTENANCE </dt>
<dd>
Maintenance is being performed on the line at the switch. TAPI cannot be used to operate on the line device. </dd>
<dt>
LINEDEVSTATE_OPEN </dt>
<dd>
The line has been opened by some application. </dd>
<dt>
LINEDEVSTATE_CLOSE </dt>
<dd>
The line has been closed by some application. </dd>
<dt>
LINEDEVSTATE_NUMCALLS </dt>
<dd>
The number of calls on the line device has changed. </dd>
<dt>
LINEDEVSTATE_TERMINALS </dt>
<dd>
The terminal settings have changed. </dd>
<dt>
LINEDEVSTATE_ROAMMODE </dt>
<dd>
The roam mode of the line device has changed. </dd>
<dt>
LINEDEVSTATE_BATTERY </dt>
<dd>
The battery level has changed significantly (cellular). </dd>
<dt>
LINEDEVSTATE_SIGNAL </dt>
<dd>
The signal level has changed significantly (cellular). </dd>
<dt>
LINEDEVSTATE_DEVSPECIFIC </dt>
<dd>
The line's device-specific information has changed. </dd>
<dt>
LINEDEVSTATE_REINIT </dt>
<dd>
Items have changed in the configuration of line devices. To become aware of these changes (for example, the appearance of new line devices) the application should reinitialize its use of TAPI. The <i>hDevice</i> parameter of the <a href="msgs_7het.htm">LINE_LINEDEVSTATE</a> message is left NULL for this state change as it applies to any of the lines in the system. </dd>
<dt>
LINEDEVSTATE_LOCK </dt>
<dd>
The locked status of the line device has changed. </dd>
<dt>
LINEDEVSTATE_REMOVED </dt>
<dd>
The device is being removed from the system by the service provider (most likely through user action, through a control panel or similar utility). Normally, a LINE_LINEDEVSTATE message with this value is immediately followed by a <a href="msgs_7nad.htm">LINE_CLOSE</a> message on the device. Subsequent attempts to access the device prior to TAPI being reinitialized result in LINEERR_NODEVICE being returned to the application. If a service provider sends a <a href="msgs_7het.htm">LINE_LINEDEVSTATE</a> message containing this value to TAPI, TAPI passes it along to applications that have negotiated TAPI version 1.4 or later; applications negotiating a previous API version does not receive any notification. 
</dd>
</dl>
</dd>
<dt>
<i>lpdwAddressStates</i> </dt>
<dd>
A bit array that identifies for which address status changes a message is to be sent to the application. If a flag is TRUE, that message is enabled; if FALSE, disabled. Multiple flags can be set. This parameter uses the following LINEADDRESSSTATE_ constants: 
<dl>
<dt>
LINEADDRESSSTATE_OTHER </dt>
<dd>
Address-status items other than those listed below have changed. The application should check the current address status to determine which items have changed. </dd>
<dt>
LINEADDRESSSTATE_DEVSPECIFIC </dt>
<dd>
The device-specific item of the address status has changed. </dd>
<dt>
LINEADDRESSSTATE_INUSEZERO </dt>
<dd>
The address has changed to idle (it is now in use by zero stations). </dd>
<dt>
LINEADDRESSSTATE_INUSEONE </dt>
<dd>
The address has changed from being idle or from being in use by many bridged stations to being in use by just one station. </dd>
<dt>
LINEADDRESSSTATE_INUSEMANY </dt>
<dd>
The monitored or bridged address has changed from being in use by one station to being used by more than one station. </dd>
<dt>
LINEADDRESSSTATE_NUMCALLS </dt>
<dd>
The number of calls on the address has changed. This is the result of events such as a new incoming call, an outgoing call on the address, or a call changing its hold status. </dd>
<dt>
LINEADDRESSSTATE_FORWARD </dt>
<dd>
The forwarding status of the address has changed, including the number of rings for determining a "no answer" condition. The application should check the address status to determine details about the address's current forwarding status. </dd>
<dt>
LINEADDRESSSTATE_TERMINALS </dt>
<dd>
The terminal settings for the address have changed. 
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the request succeeds or a negative error number if an error occurs. Possible return values are: </p>
<p>
LINEERR_INVALLINEHANDLE, LINEERR_OPERATIONFAILED, LINEERR_INVALPOINTER, LINEERR_RESOURCEUNAVAIL, LINEERR_NOMEM, LINEERR_UNINITIALIZED.</p>
<h4>Remarks</h4>
<p>
TAPI defines a number of messages that notify applications about events occurring on lines and addresses. An application may not be interested in receiving all address and line status change messages. The <b>lineSetStatusMessages</b> function can be used to select which messages the application wants to receive. By default, address status and line status reporting is disabled. </p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Version:</b> Use TAPI version 1.4 and later.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in tapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with tapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="quickref_9s85.htm">TAPI Reference Overview</a>, <a href="quickref_7uzp.htm">Basic Telephony Services Reference</a>, <a href="msgs_7nad.htm">LINE_CLOSE</a>, <a href="msgs_7het.htm">LINE_LINEDEVSTATE</a>, <a href="func2_0o1f.htm"><b>lineSetStatusMessages</b></a></p>
<p>&nbsp;</p></body>
</HTML>
