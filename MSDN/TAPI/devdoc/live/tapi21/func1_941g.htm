<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>lineConfigDialogEdit</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_lineconfigdialogedit"></a>lineConfigDialogEdit</h1>
<p>
The <b>lineConfigDialogEdit</b> function causes the provider of the specified line device to display a dialog box (attached to <i>hwndOwner</i> of the application) to allow the user to configure parameters related to the line device. </p>
<pre><code><b>LONG lineConfigDialogEdit(
  DWORD</b><i> dwDeviceID</i><b>,              </b>
<b>  HWND</b><i> hwndOwner</i><b>,                </b>
<b>  LPCSTR</b><i> lpszDeviceClass</i><b>,        </b>
<b>  LPVOID const</b><i> lpDeviceConfigIn</i><b>,  </b>
<b>  DWORD</b><i> dwSize</i><b>,                  </b>
<b>  LPVARSTRING</b><i> lpDeviceConfigOut  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwDeviceID</i> </dt>
<dd>
The line device to be configured. </dd>
<dt>
<i>hwndOwner</i> </dt>
<dd>
A handle to a window to which the dialog box is to be attached. Can be NULL to indicate that any window created during the function should have no owner window. </dd>
<dt>
<i>lpszDeviceClass</i> </dt>
<dd>
A pointer to a NULL-terminated string that identifies a device class name. This device class allows the application to select a specific subscreen of configuration information applicable to that device class. This parameter is optional and can be left NULL or empty, in which case the highest level configuration is selected. </dd>
<dt>
<i>lpDeviceConfigIn</i> </dt>
<dd>
A pointer to the opaque configuration data structure that was returned by <a href="func1_6ckn.htm"><b>lineGetDevConfig</b></a> (or a previous invocation of <b>lineConfigDialogEdit</b>) in the variable portion of the <a href="struc2_90xe.htm"><b>VARSTRING</b></a> structure. </dd>
<dt>
<i>dwSize</i> </dt>
<dd>
The number of bytes in the structure pointed to by <i>lpDeviceConfigIn</i>. This value is returned in the <b>dwStringSize</b> member in the <b>VARSTRING</b> structure returned by <b>lineGetDevConfig</b> or a previous invocation of <b>lineConfigDialogEdit</b>. </dd>
<dt>
<i>lpDeviceConfigOut</i> </dt>
<dd>
A pointer to the memory location of type <b>VARSTRING</b> where the device configuration structure is returned. Upon successful completion of the request, this location is filled with the device configuration. The <b>dwStringFormat</b> member in the <b>VARSTRING</b> structure is set to STRINGFORMAT_BINARY. Prior to calling <b>lineGetDevConfig</b> (or a future invocation of <b>lineConfigDialogEdit</b>), the application should set the <b>dwTotalSize</b> member of this structure to indicate the amount of memory available to TAPI for returning information. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the request succeeds or a negative error number if an error occurs. Possible return values are: </p>
<p>
LINEERR_BADDEVICEID, LINEERR_OPERATIONFAILED, LINEERR_INVALDEVICECLASS, LINEERR_RESOURCEUNAVAIL, LINEERR_INVALPARAM, LINEERR_STRUCTURETOOSMALL, LINEERR_INVALPOINTER, LINEERR_UNINITIALIZED, LINEERR_NODRIVER, LINEERR_OPERATIONUNAVAIL, LINEERR_NOMEM, LINEERR_NODEVICE.</p>
<h4>Remarks</h4>
<p>
If LINEERR_STRUCTURETOOSMALL is returned, the <b>dwTotalSize</b> member of the <a href="struc2_90xe.htm"><b>VARSTRING</b></a> structure pointed to by <i>lpDeviceConfigOut</i> does not specify enough memory to contain the entire configuration structure. The <b>dwNeededSize</b> member has been set to the amount required. To the extent that user entries were reflected in information that could not be returned due to insufficient space, those edits are lost; applications should therefore allocate the maximum amount of space that may be needed by the device class to return its configuration structure (for more information, see <a href="devclass_9smr.htm">TAPI Device Classes</a>). </p>
<p>
The <b>lineConfigDialogEdit</b> function causes the service provider to display a modal dialog box (attached to <i>hwndOwner</i> of the application) to allow the user to configure parameters related to the line specified by <i>dwDeviceID</i>. </p>
<p>
The <i>lpszDeviceClass</i> parameter allows the application to select a specific subscreen of configuration information applicable to the device class in which the user is interested; the permitted strings are the same as for <a href="func1_99r8.htm"><b>lineGetID</b></a>. For example, if the line supports the Comm API, passing "COMM" as <i>lpszDeviceClass</i> causes the provider to display the parameters related specifically to Comm (or, at least, start at the corresponding point in a multilevel configuration dialog box chain, so the user doesn't have to "dig" to find the parameters of interest). </p>
<p>
The <i>lpszDeviceClass</i> parameter would be "tapi/line" , "", or NULL to cause the provider to display the highest level configuration for the line. </p>
<p>
The difference between this function and <a href="func1_195z.htm"><b>lineConfigDialog</b></a> is the source of the parameters to edit and the result of the editing. In <b>lineConfigDialog</b>, the parameters edited are those currently in use on the device (or set for use on the next call), and any changes made have (to the maximum extent possible) an immediate impact on any active connection; also, the application must use <b>lineGetDevConfig</b> to fetch the result of parameter changes from <b>lineConfigDialog</b>. With <b>lineConfigDialogEdit</b>, the parameters to edit are passed in from the application, and the results are returned to the application, with <i>no</i> impact on active connections; the results of the editing are returned with this function, and the application does not need to call <b>lineGetDevConfig</b>. Thus, <b>lineConfigDialogEdit</b> permits an application to provide the ability for the user to set up parameters for future calls without having an impact on any active call. However, the output of this function can be passed to <b>lineSetDevConfig</b> to affect the current call or next call. </p>
<p>
Although this is a new function that older applications would not be expected to call, for backward compatibility they should not be prevented from doing so; the function works the same way for all applications. </p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Version:</b> Use TAPI version 1.4 and later.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in tapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with tapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="quickref_9s85.htm">TAPI Reference Overview</a>, <a href="quickref_7uzp.htm">Basic Telephony Services Reference</a>, <a href="func1_195z.htm"><b>lineConfigDialog</b></a>, <a href="func1_6ckn.htm"><b>lineGetDevConfig</b></a>,<b> <a href="func1_99r8.htm">lineGetID</a></b>,<b> <a href="func2_6qhz.htm">lineSetDevConfig</a></b>, <a href="struc2_90xe.htm"><b>VARSTRING</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
