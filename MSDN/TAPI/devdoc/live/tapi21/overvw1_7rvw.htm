<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Placing the Call</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_placing_the_call"></a>Placing the Call</h3>
<p>
Once the application has opened the line device, it places the call with <a href="func1_0fsc.htm"><b>lineMakeCall</b></a>, specifying the address (phone number and area code) in the <i>lpszDestAddress</i> parameter and the media mode (datamodem, in this case) in the <i>lpCallParams</i> parameter. This function returns a positive request ID if the function will be completed asynchronously, or a negative error number if an error has occurred. Negative return values describe specific error states. LINEERR_CALLUNAVAIL, for example, means that the line is probably in use (someone else already has an active call). If dialing completes successfully, messages are sent to the application to inform it about the call's progress. Applications typically use these messages to display status reports to the user. </p>
<p>
Later, when the <b>lineMakeCall</b> function has successfully set up the call, the application receives a LINE_REPLY message (the asynchronous reply to <b>lineMakeCall</b>). At this point there is not necessarily a connection to the remote station, just an established call at the local end—perhaps indicated by a dial tone. This LINE_REPLY message informs the application that the call handle returned by <b>lineMakeCall</b> is valid. </p>
<p>
TAPI's programming model treats data calls similarly to voice calls, as shown by the fact that the same function is used to make calls of both types. If LINEBEARERMODE_DATA is specified in a field of the <i>lpCallParams</i> parameter of <b>lineMakeCall</b>, the call is set up to send data. Speech transmission can be chosen by using a different value. And if NULL is specified, a default 3.1 kHz voice call is established, which can support the speech, fax, and modem media modes. </p>
<p>
<b>Note</b>&nbsp;&nbsp;TAPI should not be used for fax transmissions. Instead, use the functions available through MAPI, the Microsoft Messaging API. </p>
<p>
As the call is placed, it passes through a number of states, each of which results in a LINE_CALLSTATE message sent to the application. These states include <i>dialtone</i>, <i>dialing</i>, <i>ringback</i>, and, if connection succeeds, LINECALLSTATE_CONNECTED. (To see the complete list of call states, see <a href="struc1_0p9u.htm"><b>LINECALLSTATUS</b></a>.) After the message indicating the connected state is received, the application can begin sending data. </p>
<p>&nbsp;</p></body>
</HTML>
