<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>lineSetAppPriority</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_linesetapppriority"></a>lineSetAppPriority</h1>
<p>
The <b>lineSetAppPriority</b> function allows an application to set its priority in the handoff priority list for a particular media mode or Assisted Telephony request mode, or to remove itself from the priority list. </p>
<pre><code><b>LONG lineSetAppPriority(
  LPCSTR</b><i> lpszAppFilename</i><b>,                 </b>
<b>  DWORD</b><i> dwMediaMode</i><b>,                      </b>
<b>  LPLINEEXTENSIONID const</b><i> lpExtensionID</i><b>,  </b>
<b>  DWORD</b><i> dwRequestMode</i><b>,                    </b>
<b>  LPCSTR</b><i> lpszExtensionName</i><b>,               </b>
<b>  DWORD</b><i> dwPriority                        </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszAppFilename</i> </dt>
<dd>
A pointer to a string containing the application executable module filename (without directory information). In TAPI version 2.0 or later, the parameter can specify a filename in either long or 8.3 filename format. </dd>
<dt>
<i>dwMediaMode</i> </dt>
<dd>
The media mode for which the priority of the application is to be set. The value can be one of the LINEMEDIAMODE_ constants; only a single bit may be on. The value zero should be used to set the application priority for Assisted Telephony requests. </dd>
<dt>
<i>lpExtensionID</i> </dt>
<dd>
A pointer to a structure of type <a href="struc2_1yia.htm"><b>LINEEXTENSIONID</b></a>. This parameter is ignored. </dd>
<dt>
<i>dwRequestMode</i> </dt>
<dd>
If the <i>dwMediaMode</i> parameter is zero, this parameter specifies the Assisted Telephony request mode for which priority is to be set. It must be either LINEREQUESTMODE_MAKECALL or LINEREQUESTMODE_MEDIACALL. This parameter is ignored if <i>dwMediaMode</i> is nonzero. </dd>
<dt>
<i>lpszExtensionName</i> </dt>
<dd>
This parameter is ignored. </dd>
<dt>
<i>dwPriority</i> </dt>
<dd>
The new priority for the application. If the value 0 is passed, the application is removed from the priority list for the specified media or request mode (if it was already not present, no error is generated). If the value 1 is passed, the application is inserted as the highest-priority application for the media or request mode (and removed from a lower-priority position, if it was already in the list). Any other value generates an error. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the request succeeds or a negative error number if an error occurs. Possible return values are: </p>
<p>
LINEERR_INIFILECORRUPT, LINEERR_INVALREQUESTMODE, LINEERR_INVALAPPNAME, LINEERR_NOMEM, LINEERR_INVALMEDIAMODE, LINEERR_OPERATIONFAILED, LINEERR_INVALPARAM, LINEERR_RESOURCEUNAVAIL, LINEERR_INVALPOINTER. </p>
<h4>Remarks</h4>
<p>
If LINEERR_INVALMEDIAMODE is returned, the value specified in <i>dwMediaMode</i> is not zero and not a LINEMEDIAMODE_ constant, or more than one bit is on in the parameter value. </p>
<p>
This function updates the stored priority list. If the telephony system is initialized, it also sets the current, active priorities for applications then running; the new priority is used on the next incoming call or <b>lineHandoff</b> based on media mode. </p>
<p>
Although this is a new function which older applications would not be expected to call, for backward compatibility they should not be prevented from doing so. The function works the same way for all applications. </p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Version:</b> Use TAPI version 1.4 and later.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in tapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with tapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="quickref_9s85.htm">TAPI Reference Overview</a>, <a href="quickref_2bg3.htm">Supplementary Line Services Functions</a>, <a href="struc2_1yia.htm"><b>LINEEXTENSIONID</b></a>, <a href="func1_0b52.htm"><b>lineHandoff</b></a></p>
<p>&nbsp;</p></body>
</HTML>
