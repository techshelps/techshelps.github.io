<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TAPI Client Management DLL API Hooks</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_tapi_client_management_dll_api_hooks"></a>TAPI Client Management DLL API Hooks</h2>
<p>
This section discusses TAPI Client Management DLL API hooks that are called from TAPISRV during their corresponding call to a TAPI function.</p>
<p>
The following TAPI functions have corresponding TAPI Client Management functions:</p>
<p>
<a href="func1_7iqt.htm"><b>lineAddToConference</b></a></p>
<p>
<a href="func1_6o8i.htm"><b>lineBlindTransfer</b></a></p>
<p>
<a href="func1_06cs.htm"><b>lineDial</b></a></p>
<p>
<a href="func1_6nvo.htm"><b>lineForward</b></a></p>
<p>
<a href="func1_1c37.htm"><b>lineGenerateDigits</b></a></p>
<p>
<a href="func1_0fsc.htm"><b>lineMakeCall</b></a></p>
<p>
<a href="func2_2lny.htm"><b>lineOpen</b></a></p>
<p>
<a href="func2_3s50.htm"><b>lineRedirect</b></a></p>
<p>
<a href="func2_44ip.htm"><b>lineSetCallData</b></a></p>
<p>
<a href="func2_59v7.htm"><b>lineSetCallParams</b></a></p>
<p>
<a href="func2_2m1x.htm"><b>lineSetCallPrivilege</b></a></p>
<p>
<a href="func2_9qes.htm"><b>lineSetCallTreatment</b></a></p>
<p>
<a href="func2_6ucu.htm"><b>lineSetCurrentLocation</b></a></p>
<p>
<a href="func2_6qhz.htm"><b>lineSetDevConfig</b></a></p>
<p>
<a href="func2_5fsj.htm"><b>lineSetLineDevStatus</b></a></p>
<p>
<a href="func2_4hbg.htm"><b>lineSetMediaControl</b></a></p>
<p>
<a href="func2_5bl1.htm"><b>lineSetMediaMode</b></a></p>
<p>
<a href="func2_7oz0.htm"><b>lineSetTerminal</b></a></p>
<p>
<a href="func2_6him.htm"><b>phoneOpen</b></a></p>
<p>
<b>Note</b>&nbsp;&nbsp;For more information on these TAPI functions, see the <i>Microsoft TAPI Programmer's Reference</i> in the Microsoft Platform Software Development Kit.</p>
<p>
During a managed TAPI call, TAPI runs through the list of Client Management DLLs and calls the corresponding <b>TAPICLIENT</b> function in the DLL. The DLLs are called in the order that they are listed in the <b>Client Management DLL</b> registry key.</p>
<p>
If a Client Management DLL returns LINEERR_STRUCTURETOOSMALL for a function, TAPI reallocates the buffer and calls the DLL again. If a DLL returns any other failure for a call, TAPI returns that failure to the client application. If the DLL call succeeds, TAPI calls the next DLL in the list.</p>
<p>
Certain functions allow the Client Management DLL to modify a buffer. For example, <a href="tapclmgt_7ylo.htm"><b>TAPICLIENT_LineMakeCall</b></a> allows the DLL to modify the destination address, <a href="struc1_1tgy.htm"><b>LINECALLPARAMS</b></a> structure, and the country code. If any parameter is modified during the call, the modified parameter is passed to the next DLL.</p>
<p>
<b>Note</b>&nbsp;&nbsp;The DLL <i>must not</i> modify the buffer unless it returns success for that call. In addition, the DLL must verify that the buffer is large enough for the changes before it attempts to modify the buffer.</p>
<p>
TAPI Client DLL does not need to implement every <b>TAPICLIENT</b> hook. A Client Management DLL can implement any hook it is interested in. </p>
<p>
The following return values apply to all <b>TAPICLIENT</b> functions.</p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=51%>Return Value</th>
<th align=left width=49%>Meaning</th>
</tr>
<tr valign=top>
<td width=51%>0</td>
<td width=49%>Success; the client is allowed to continue with this call.</td>
</tr>
<tr valign=top>
<td width=51%>LINEERR_STRUCTURETOOSMALL</td>
<td width=49%>A modifiable buffer passed in is too small for the modifications.</td>
</tr>
<tr valign=top>
<td width=51%>LINEERR_BILLINGREJECTED</td>
<td width=49%>The destination address is not allowed.</td>
</tr>
<tr valign=top>
<td width=51%>LINEERR_INVALFEATURE</td>
<td width=49%>The client is not allowed to call this function (under these conditions).</td>
</tr>
<tr valign=top>
<td width=51%>LINEERR_NOMEM</td>
<td width=49%>There was a memory failure during normal processing of this function.</td>
</tr>
<tr valign=top>
<td width=51%>LINEERR_OPERATIONFAILED</td>
<td width=49%>Some failure occurred during processing of this function.</td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
