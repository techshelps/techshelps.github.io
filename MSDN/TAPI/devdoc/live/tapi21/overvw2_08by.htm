<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Initialization and Shutdown</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_initialization_and_shutdown"></a>Initialization and Shutdown</h2>
<p>
For an application to use any of TAPI's 30 supplementary phone functions, it needs a connection to TAPI, through which it can receive messages. The application establishes this connection using the <a href="func2_5ans.htm"><b>phoneInitializeEx</b></a> function. In this function, the application specifies the notification mechanism by which TAPI informs the application of changes in the state of the phone and of asynchronous completion of phone functions.</p>
<p>
The <b>phoneInitializeEx</b> function returns two pieces of information to the application: an <i>application handle</i>, and the number of phone devices. The application handle represents the application's usage of TAPI. The TAPI functions that use phone handles do not require the application handle, as this handle is derived from the specified phone handle. </p>
<p>
The second piece of information returned by <b>phoneInitializeEx</b> is the number of phone devices available to TAPI. Phone devices are identified by their device identifier (<i>device ID</i>). Valid device identifiers range from zero to the number of phone devices minus one. For example, if <b>phoneInitializeEx</b> reports that there are two phone devices in a system, then valid phone device identifiers are 0 and 1. After an application is finished using the phone functions of TAPI, it invokes <a href="func2_7gku.htm"><b>phoneShutdown</b></a>, passing its application handle to shut down its usage of TAPI. This allows TAPI to free any resources assigned to the application. </p>
<p>
Both <b>phoneInitializeEx</b> and <b>phoneShutdown</b> operate synchronously. That is, these functions either return a success or failure indication, and never return an asynchronous request identifier. </p>
<p>&nbsp;</p></body>
</HTML>
