<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>lineSetNumRings</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_linesetnumrings"></a>lineSetNumRings</h1>
<p>
The <b>lineSetNumRings</b> function sets the number of rings that must occur before an incoming call is answered. This function can be used to implement a toll-saver-style function. It allows multiple independent applications to each register the number of rings. The function <a href="func1_76ib.htm"><b>lineGetNumRings</b></a> returns the minimum number of rings requested. It can be used by the application that answers incoming calls to determine the number of rings it should wait before answering the call. </p>
<pre><code><b>LONG lineSetNumRings(
  HLINE</b><i> hLine</i><b>,        </b>
<b>  DWORD</b><i> dwAddressID</i><b>,  </b>
<b>  DWORD</b><i> dwNumRings    </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hLine</i> </dt>
<dd>
A handle to the open line device. </dd>
<dt>
<i>dwAddressID</i> </dt>
<dd>
An address on the line device. </dd>
<dt>
<i>dwNumRings</i> </dt>
<dd>
The number of rings before a call should be answered in order to honor the toll-saver requests from all applications. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the request succeeds or a negative error number if an error occurs. Possible return values are: </p>
<p>
LINEERR_INVALLINEHANDLE, LINEERR_OPERATIONFAILED, LINEERR_INVALADDRESSID, LINEERR_RESOURCEUNAVAIL, LINEERR_NOMEM, LINEERR_UNINITIALIZED.</p>
<h4>Remarks</h4>
<p>
The <a href="func1_76ib.htm"><b>lineGetNumRings</b></a> and <b>lineSetNumRings</b> functions, when used in combination, provide a mechanism to support the implementation of toll-saver features across multiple independent applications. If no application ever calls <b>lineSetNumRings</b>, <b>lineGetNumRings</b> returns 0xFFFFFFFF. </p>
<p>
An application that is the owner of a call in the <i>offering</i> state and that received a <a href="msgs_7het.htm">LINE_LINEDEVSTATE</a> <i>ringing</i> message should wait a number of rings equal to the number returned by <b>lineGetNumRings</b> before answering the call in order to honor the toll-saver settings across all applications. A separate LINE_LINEDEVSTATE <i>ringing</i> message is sent to the application for each ring cycle, so the application should count these messages. If this call disconnects before being answered, and another call comes in shortly thereafter, the <a href="msgs_1eud.htm">LINE_CALLSTATE</a> message should allow the application to determine that ringing is related to the second call. </p>
<p>
If call classification is performed by TAPI by means of answering incoming calls of unknown media mode and filtering the media stream, TAPI honors this number as well. </p>
<p>
<b>Note</b>&nbsp;&nbsp;This operation is purely informational and does not affect the state of any calls on the line device. </p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Version:</b> Use TAPI version 1.4 and later.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in tapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with tapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="quickref_9s85.htm">TAPI Reference Overview</a>, <a href="quickref_7uzp.htm">Basic Telephony Services Reference</a>, <a href="msgs_1eud.htm">LINE_CALLSTATE</a>, <a href="msgs_7het.htm">LINE_LINEDEVSTATE</a>, <a href="func1_76ib.htm"><b>lineGetNumRings</b></a></p>
<p>&nbsp;</p></body>
</HTML>
