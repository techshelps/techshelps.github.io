<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>lineAddProvider</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_lineaddprovider"></a>lineAddProvider</h1>
<p>
The <b>lineAddProvider</b> function installs a new telephony service provider into the telephony system. </p>
<pre><code><b>LONG lineAddProvider(
  LPCSTR</b><i> lpszProviderFilename</i><b>,  </b>
<b>  HWND</b><i> hwndOwner</i><b>,               </b>
<b>  LPDWORD</b><i> lpdwPermanentProviderID  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszProviderFilename</i> </dt>
<dd>
A pointer to a NULL-terminated string containing the path of the service provider to be added. </dd>
<dt>
<i>hwndOwner</i> </dt>
<dd>
A handle to a window in which any dialog boxes that need to be displayed as part of the installation process (for example, by the service provider's <b>TSPI_providerInstall</b> function) would be attached. Can be NULL to indicate that any window created during the function should have no owner window. </dd>
<dt>
<i>lpdwPermanentProviderID</i> </dt>
<dd>
A pointer to a <b>DWORD</b>-sized memory location into which TAPI writes the permanent provider identifier of the newly installed service provider. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the request succeeds or a negative error number if an error occurs. Possible return values are: </p>
<p>
LINEERR_INIFILECORRUPT, LINEERR_NOMEM, LINEERR_INVALPARAM, LINEERR_NOMULTIPLEINSTANCE, LINEERR_INVALPOINTER, LINEERR_OPERATIONFAILED.</p>
<h4>Remarks</h4>
<p>
During this function call, TAPI checks to ensure that it can access the service provider by calling its <b>TSPI_providerInstall</b> function; if this is unsuccessful (if the DLL or function cannot be found, or if <b>TSPI_providerInstall</b> returns an error), the function fails and the provider is not added to the telephony system. If this succeeds, and the Win32 Telephony system is active (one or more applications have called <a href="func1_1nxh.htm"><b>lineInitialize</b></a> or <a href="func1_8th4.htm"><b>lineInitializeEx</b></a>), TAPI does not attempt to launch the newly-added service provider. Instead, in order to activate the new service provider, TAPI issues a message to restart Windows. When the activation succeeds, applications are informed of any new devices created by way of <a href="msgs_97xh.htm">LINE_CREATE</a> or <a href="msgs_9bs5.htm">PHONE_CREATE</a> messages, or by a <a href="msgs_7het.htm">LINE_LINEDEVSTATE</a> message requesting reinitialization (if the application does not support the CREATE messages). </p>
<p>
This function copies no files—not the service provider DLL itself nor any supporting files; the application managing the addition of the provider must ensure that the provider is installed in a directory where it can be found by TAPI (for example, \WINDOWS, \WINDOWS\SYSTEM, or elsewhere on the path). </p>
<p>
Although this is a new function that older applications would not be expected to call, for backward compatibility they should not be prevented from doing so; the function works the same way for all applications. </p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Version:</b> Use TAPI version 1.4 and later.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in tapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with tapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="quickref_9s85.htm">TAPI Reference Overview</a>, <a href="quickref_2bg3.htm">Supplementary Line Services Functions</a>, <a href="msgs_97xh.htm">LINE_CREATE</a>, <a href="msgs_7het.htm">LINE_LINEDEVSTATE</a>, <a href="func1_1nxh.htm"><b>lineInitialize</b></a>, <a href="func1_8th4.htm"><b>lineInitializeEx</b></a>, <a href="msgs_9bs5.htm">PHONE_CREATE</a></p>
<p>&nbsp;</p></body>
</HTML>
