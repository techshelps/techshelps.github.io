<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Media Monitoring</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_media_monitoring"></a>Media Monitoring</h3>
<p>
When a call is in the <i>connected</i> state, information can be transported over the call. A call's media mode provides an indication of the type of information (for example, its datatype, or higher-level protocol) of this media stream. TAPI allows applications to be provided with a notification about changes in a call's media mode. The notification provides an indication of the call's new media mode. The service provider decides how it wants to make this determination. For example, the service provider could use signal processing of the media stream to determine the media mode, or it could rely on distinctive ringing patterns assigned to different media streams, or on information elements passed in an out-of-band signaling protocol. Independent of how the media mode determination is achieved, the application is simply informed about media mode changes on an existing call. </p>
<p>
The media modes defined by TAPI include: 
<ul>
<li>
<b>Unknown</b> The media mode of the call is not currently known—the call is unclassified. </li>
<li>
<b>Interactive voice</b> Voice energy was detected on the call, and the call is handled as an interactive voice call with a person at the application's end. </li>
<li>
<b>Automated voice</b> Voice energy was detected on the call, and the call is handled as a voice call but with no person at the application's end, such as with an answering machine application. </li>
<li>
<b>Data modem</b> A modem session on the call. Current modem protocols require the called station to initiate the handshake. For an incoming data modem call, the application can typically make no positive detection. How the service provider makes this determination is its choice. For example, a period of silence just after answering an incoming call can be used as a heuristic to decide that this might be a data modem call. </li>
<li>
<b>G3</b> <b>fax</b> A group 3 fax session on the call. </li>
<li>
<b>G4</b> <b>fax</b> A group 4 fax session on the call. </li>
<li>
<b>TDD</b> The call's media stream uses the Telephony Devices for the Deaf protocol. </li>
<li>
<b>Digital data</b> A digital data stream of unspecified format. </li>
<li>
<b>Teletex, Videotex, Telex, Mixed</b> These correspond to the telematic services of the same names. </li>
<li>
<b>ADSI</b> An Analog Display Services Interface session on the call. ADSI enhances voice calls with alphanumeric information downloaded to the phone and the use of soft buttons on the phone. </li>
</ul>
<p>
An application can enable or disable <i>media monitoring</i> on a specified call with <a href="func2_94wx.htm"><b>lineMonitorMedia</b></a>. The application specifies which media modes it is interested in monitoring, and when media monitoring is enabled, the detection of a media mode change causes the application to be notified with the <a href="msgs_3w9t.htm">LINE_MONITORMEDIA</a> message. This message provides the call handle on which the media mode change was detected as well as the new media mode. </p>
<p>
There is a distinction between the media mode of a call as reported by <a href="func1_5zov.htm"><b>lineGetCallInfo</b></a> and the media mode event reports by LINE_MONITORMEDIA messages. A call's media mode is determined exclusively by owner applications of the call and is not automatically changed by media monitoring events. The one exception is the initial media mode determination that can be performed by the TAPI dynamic-link library to select the first owner of a call. One could argue that in this case, the library is the owner of the call. </p>
<p>
Default media mode monitoring is performed for the media modes for which the line device has been opened. This allows an incoming call's media mode to be determined before the call is handed to an application based on what the application demands. The scope of the media monitoring of a call is bound by the lifetime of the call. Media monitoring on a call ends as soon the call <i>disconnects</i> or goes <i>idle</i>. </p>
<p>
An application can obtain device identifiers for various device classes associated with an opened line by calling <a href="func1_99r8.htm"><b>lineGetID</b></a>. This function takes a line handle, address, or call handle and a device class description. It returns the device identifier for the device of the given device class that is associated with the open line device, address, or call. If the device class is "tapi/line," then the device identifier of the line device is returned. If the device class is "mci/wave," then the device identifier of an mci waveaudio device is returned (if supported), which allows activities such as the recording or playback of audio over the call on the line. </p>
<p>
The application can use the returned device identifier with the corresponding media API to query the device's capabilities and subsequently open the media device. For example, if your application needs to use the line as a waveform device, it must first call <b>waveInGetDevCaps</b> and/or <b>waveOutGetDevCaps</b> to determine the waveform capabilities of the device. The typical waveform data format supported by telephony in North America is 8-bit m-law at 8000 samples per second, although the wave device driver can convert this sample rate and companding to other more common multimedia audio formats. </p>
<p>
To subsequently open a line device for audio playback using the waveform API, an application calls <b>waveOutOpen</b>. The implementation of <b>waveOutOpen</b> is device specific, and there are a variety of options for implementing this function. </p>
<p>&nbsp;</p></body>
</HTML>
