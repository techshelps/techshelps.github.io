<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>lineSetTerminal</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_linesetterminal"></a>lineSetTerminal</h1>
<p>
The <b>lineSetTerminal</b> function enables an application to specify which terminal information related to the specified line, address, or call is to be routed. The <b>lineSetTerminal</b> function can be used while calls are in progress on the line to allow an application to route these events to different devices as required. </p>
<pre><code><b>LONG lineSetTerminal(
  HLINE</b><i> hLine</i><b>,            </b>
<b>  DWORD</b><i> dwAddressID</i><b>,      </b>
<b>  HCALL</b><i> hCall</i><b>,            </b>
<b>  DWORD</b><i> dwSelect</i><b>,         </b>
<b>  DWORD</b><i> dwTerminalModes</i><b>,  </b>
<b>  DWORD</b><i> dwTerminalID</i><b>,     </b>
<b>  DWORD</b><i> bEnable           </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hLine</i> </dt>
<dd>
A handle to an open line device. </dd>
<dt>
<i>dwAddressID</i> </dt>
<dd>
An address on the given open line device. </dd>
<dt>
<i>hCall</i> </dt>
<dd>
A handle to a call. The call state of <i>hCall</i> can be any state, if <i>dwSelect</i> is CALL. </dd>
<dt>
<i>dwSelect</i> </dt>
<dd>
Specifies whether the terminal setting is requested for the line, the address, or just the specified call. If line or address is specified, events either apply to the line or address itself or serve as a default initial setting for all new calls on the line or address. This parameter uses the following LINECALLSELECT_ constants: 
<dl>
<dt>
LINECALLSELECT_LINE </dt>
<dd>
Selects the specified line device. The <i>hLine</i> parameter must be a valid line handle; <i>hCall</i> and <i>dwAddressID</i> are ignored. </dd>
<dt>
LINECALLSELECT_ADDRESS </dt>
<dd>
Selects the specified address on the line. Both <i>hLine</i> and <i>dwAddressID</i> must be valid; <i>hCall</i> is ignored. </dd>
<dt>
LINECALLSELECT_CALL </dt>
<dd>
Selects the specified call. The <i>hCall</i> parameter must be valid; <i>hLine</i> and <i>dwAddressID</i> are both ignored. 
</dd>
</dl>
</dd>
<dt>
<i>dwTerminalModes</i> </dt>
<dd>
The class or classes of low-level events to be routed to the given terminal. This parameter uses the following LINETERMMODE_ constants: 
<dl>
<dt>
LINETERMMODE_BUTTONS </dt>
<dd>
The button presses from the terminal to the line. </dd>
<dt>
LINETERMMODE_DISPLAY </dt>
<dd>
The display events from the line to the terminal. </dd>
<dt>
LINETERMMODE_LAMPS </dt>
<dd>
The lamp lighting events from the line to the terminal. </dd>
<dt>
LINETERMMODE_RINGER </dt>
<dd>
The ring requests from the line to the terminal. </dd>
<dt>
LINETERMMODE_HOOKSWITCH </dt>
<dd>
The hookswitch events between the terminal and the line. </dd>
<dt>
LINETERMMODE_MEDIATOLINE </dt>
<dd>
This is the unidirectional media stream from the terminal to the line associated with a call on the line. Use this value when routing of both unidirectional channels of a call's media stream can be controlled independently. </dd>
<dt>
LINETERMMODE_MEDIAFROMLINE </dt>
<dd>
This is the unidirectional media stream from the line to the terminal associated with a call on the line. Use this value when routing of both unidirectional channels of a call's media stream can be controlled independently. </dd>
<dt>
LINETERMMODE_MEDIABIDIRECT </dt>
<dd>
This is the bidirectional media stream associated with a call on the line and the terminal. Use this value when the routing of both unidirectional channels of a call's media stream cannot be controlled independently. MEDIABIDIRECT is mutually exclusive with MEDIATOLINE and MEDIAFROMLINE. 
</dd>
</dl>
</dd>
<dt>
<i>dwTerminalID</i> </dt>
<dd>
The device identifier of the terminal device where the given events are to be routed. Terminal identifiers are small integers in the range of zero to one less than <b>dwNumTerminals</b>, where <b>dwNumTerminals</b>, and the terminal modes each terminal is capable of handling, are returned by <a href="func1_22nn.htm"><b>lineGetDevCaps</b></a>. 

<p>
<b>Note</b>&nbsp;&nbsp;These terminal identifiers have no relation to other device identifiers and are defined by the service provider using device capabilities. 

</dd>
<dt>
<i>bEnable</i> </dt>
<dd>
If TRUE, <i>dwTerminalID</i> is valid and the specified event classes are routed to or from that terminal. If FALSE, these events are not routed to or from the terminal device with identifier equal to <i>dwTerminalID</i>. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns a positive request identifier if the function is completed asynchronously, or a negative error number if an error occurs. The <i>dwParam2</i> parameter of the corresponding <a href="msgs_2ayh.htm">LINE_REPLY</a> message is zero if the function succeeds or it is a negative error number if an error occurs. Possible return values are: </p>
<p>
LINEERR_INVALADDRESSID, LINEERR_NOMEM, LINEERR_INVALCALLHANDLE, LINEERR_OPERATIONUNAVAIL, LINEERR_INVALCALLSELECT, LINEERR_OPERATIONFAILED, LINEERR_INVALLINEHANDLE, LINEERR_RESOURCEUNAVAIL, LINEERR_INVALTERMINALID, LINEERR_UNINITIALIZED, LINEERR_INVALTERMINALMODE. </p>
<h4>Remarks</h4>
<p>
An application can use this function to route certain classes of low-level line events to the specified terminal device or to suppress the routing of these events. For example, voice can be routed to an audio I/O device (headset), lamps and display events can be routed to the local phone device, and button events and ringer events can be suppressed altogether. </p>
<p>
This function can be called at any time, even when a call is active on the given line device. This allows a user to switch from using the local phone set to another audio I/O device. This function can be called multiple times to route the same events to multiple terminals simultaneously. To reroute events to a different terminal, the application should first disable routing to the existing terminal and then route the events to the new terminal. </p>
<p>
Terminal identifier assignments are made by the line's service provider. Device capabilities indicate only which terminal identifiers the service provider has available. Service providers that do not support this type of event routing would indicate that they have no terminal devices (<b>dwNumTerminals</b> in <a href="struc2_30mq.htm"><b>LINEDEVCAPS</b></a> would be zero). </p>
<p>
Invoking <b>lineSetTerminal</b> on a line or address affects all existing calls on that line or address, but does not affect calls on other addresses. It also sets the default for future calls on that line or address. A line or address that has multiple connected calls active at one time can have different routing in effect for each call. </p>
<p>
Disabling the routing of low-level events to a terminal when these events are not currently routed to or from that terminal does not necessarily generate an error so long as the function succeeds (the specified events are not routed to or from that terminal). </p>
<p>
TAPI routes call progress tones and messages to the same location as set by the <b>lineSetTerminal</b> function for "media". For example, if audio signals are going to the phone, then so will busy signals (analog) or Q.931 messages indicating busy (digital). </p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Version:</b> Use TAPI version 1.4 and later.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in tapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with tapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="quickref_9s85.htm">TAPI Reference Overview</a>, <a href="quickref_2bg3.htm">Supplementary Line Services Functions</a>, <a href="msgs_2ayh.htm">LINE_REPLY</a>, <a href="struc2_30mq.htm"><b>LINEDEVCAPS</b></a>, <a href="func1_22nn.htm"><b>lineGetDevCaps</b></a></p>
<p>&nbsp;</p></body>
</HTML>
