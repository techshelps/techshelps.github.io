<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Determining Initial Media Modes</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_determining_initial_media_modes"></a>Determining Initial Media Modes</h3>
<p>
When a service provider learns of the appearance of a call, its first task is to determine the call's media mode to the best of its ability. (It has received ringing voltage on a POTS line or, in the case of EPBX or ISDN, a protocol message indicating that a call is incoming.) It may be able to tell the single correct media mode or it may only be able to narrow down the possibilities to a certain few. These first media mode settings are called <i>initial media modes</i>, and the following are the considerations used for setting initial media mode bits: 
<ul>
<li>
<b>Service provider setup</b> The service provider has been configured to work with only a single media mode or certain media modes. </li>
<li>
<b>Hardware limitations</b> Hardware limitations are usually reflected in the service provider's configuration, but the media modes could be further restricted by a particular card in use. </li>
<li>
<b>Call to</b> <a href="func2_2lny.htm"><b>lineOpen</b></a> Possible media modes are limited by what applications have requested in their invocation of the <b>lineOpen</b> function. TAPI combines all of the media modes requested by applications and indicates the sum of them to the service provider in a call to <b>TSPI_lineSetDefaultMediaDetection</b>. For example, a telephony device and its service provider may be able to handle Group 3 fax calls, but if no application is running to handle such calls, the provider would know not to bother with probing for fax or reporting fax calls to TAPI. (The TAPI dynamic-link library does not automatically launch an application to handle a particular type of incoming call.) </li>
<li>
<b>Caller ID and Direct Inward Dialing</b> With Direct Inward Dialing (DID) at the called address, the switch supplies the service provider with the digits that were dialed (the called address). The service provider can be configured to associate particular called addresses with particular media modes. Likewise, it could associate calls from particular numbers as being associated with particular media modes, although this is much less commonly used. </li>
<li>
<b>Distinctive ringing</b> The ring pattern of the incoming call may match a predetermined pattern (of several possible at the called address) that is reserved for calls of a certain media mode. If, for example, the incoming call is using ring pattern 2, the service provider knows it to be a fax call (based on configuration information supplied by the user). </li>
<li>
<b>ISDN</b> On an ISDN network, the provider may analyze the call's protocol frames to determine the media mode. If the call is indicated as a 3.1 kHz voice call, it is still possible that the actual media mode on the call is analog data modem, Group 3 fax, text telephone, or any of several other voiceband modulated signals, in addition to human voice; it is only with digital data signals that the media mode would necessarily be clearly defined—for example as Group 4 fax—at call setup time in ISDN. </li>
<li>
<b>Auto answer and probe</b> Some providers give the user an option to let the service provider <i>autoanswer</i> the call and do some of the probing itself. In this process, TAPI gives the call the correct application with the correct media mode already identified. </li>
</ul>
<p>
These tools may be enough to make a final and accurate determination of the media mode. In any case, when the service provider passes the new call to TAPI, it sends a <a href="msgs_1eud.htm">LINE_CALLSTATE</a> message and includes in the message all that it knows about the call's media mode(s). The following topics give details on the possible cases. </p>
<p>&nbsp;</p></body>
</HTML>
