<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>lineRemoveProvider</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_lineremoveprovider"></a>lineRemoveProvider</h1>
<p>
The <b>lineRemoveProvider</b> function removes an existing telephony service provider from the telephony system. </p>
<pre><code><b>LONG lineRemoveProvider(
  DWORD</b><i> dwPermanentProviderID</i><b>,  </b>
<b>  HWND</b><i> hwndOwner                </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwPermanentProviderID</i> </dt>
<dd>
The permanent provider identifier of the service provider to be removed. </dd>
<dt>
<i>hwndOwner</i> </dt>
<dd>
A handle to a window to which any dialog boxes which need to be displayed as part of the removal process (for example, a confirmation dialog box by the service provider's <b>TSPI_providerRemove</b> function) would be attached. Can be a NULL value to indicate that any window created during the function should have no owner window. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the request succeeds or a negative error number if an error occurs. Possible return values are: </p>
<p>
LINEERR_INIFILECORRUPT, LINEERR_NOMEM, LINEERR_INVALPARAM, LINEERR_OPERATIONFAILED.</p>
<h4>Remarks</h4>
<p>
If the call to <b>TSPI_providerRemove</b> succeeds, and the telephony system is active at the time, TAPI calls <b>TSPI_lineShutdown</b> and/or <b>TSPI_phoneShutdown</b> on the service provider (depending on which device types are active). Any line or phone handles still held by applications on associated devices are forcibly closed with LINE_CLOSE or PHONE_CLOSE messages (it is preferable for service providers to issue these messages as part of <b>TSPI_providerRemove</b>, after verification with the user). The devices previously under the control of that provider are then marked as "unavailable", so that any future attempts by applications to reference them by device identifier result in LINEERR_NODRIVER. </p>
<p>
Although this is a new function that older applications would not be expected to call, for backward compatibility they should not be prevented from doing so. The function works the same way for all applications. </p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Version:</b> Use TAPI version 1.4 and later.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in tapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with tapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="quickref_9s85.htm">TAPI Reference Overview</a>, <a href="quickref_2bg3.htm">Supplementary Line Services Functions</a>, <a href="msgs_7nad.htm">LINE_CLOSE</a>, <a href="msgs_9oh1.htm">PHONE_CLOSE</a></p>
<p>&nbsp;</p></body>
</HTML>
