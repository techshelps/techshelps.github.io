<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>phoneOpen</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_phoneopen"></a>phoneOpen</h1>
<p>
The <b>phoneOpen</b> function opens the specified phone device. A phone device can be opened using either owner privilege or monitor privilege. An application that opens the phone with owner privilege can control the phone's lamps, display, ringer, and hookswitch or hookswitches. An application that opens the phone device with monitor privilege is notified only about events that occur at the phone, such as hookswitch changes or button presses. Ownership of a phone device is exclusive. In other words, only one application can have a phone device opened with owner privilege at a time. The phone device can, however, be opened multiple times with monitor privilege. </p>
<pre><code><b>LONG phoneOpen(
  HPHONEAPP</b><i> hPhoneApp</i><b>,       </b>
<b>  DWORD</b><i> dwDeviceID</i><b>,          </b>
<b>  LPHPHONE</b><i> lphPhone</i><b>,         </b>
<b>  DWORD</b><i> dwAPIVersion</i><b>,        </b>
<b>  DWORD</b><i> dwExtVersion</i><b>,        </b>
<b>  DWORD</b><i> dwCallbackInstance</i><b>,  </b>
<b>  DWORD</b><i> dwPrivilege          </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hPhoneApp</i> </dt>
<dd>
A handle to the application's registration with TAPI. </dd>
<dt>
<i>dwDeviceID</i> </dt>
<dd>
The phone device to be opened. </dd>
<dt>
<i>lphPhone</i> </dt>
<dd>
A pointer to an HPHONE handle that identifies the open phone device. Use this handle to identify the device when invoking other phone control functions. </dd>
<dt>
<i>dwAPIVersion</i> </dt>
<dd>
The API version number under which the application and Telephony API have agreed to operate. This number is obtained from <a href="func2_223y.htm"><b>phoneNegotiateAPIVersion</b></a>. </dd>
<dt>
<i>dwExtVersion</i> </dt>
<dd>
The extension version number under which the application and the service provider agree to operate. This number is zero if the application does not use any extensions. This number is obtained from <a href="func2_66cu.htm"><b>phoneNegotiateExtVersion</b></a>. </dd>
<dt>
<i>dwCallbackInstance</i> </dt>
<dd>
User instance data passed back to the application with each message. This parameter is not interpreted by the Telephony API. </dd>
<dt>
<i>dwPrivilege</i> </dt>
<dd>
The privilege requested. The <i>dwPrivilege</i> parameter can have only one bit set. This parameter uses the following PHONEPRIVILEGE_ constants: 
<dl>
<dt>
PHONEPRIVILEGE_MONITOR </dt>
<dd>
An application that opens a phone device with this privilege is informed about events and state changes occurring on the phone. The application cannot invoke any operations on the phone device that would change its state. </dd>
<dt>
PHONEPRIVILEGE_OWNER </dt>
<dd>
An application that opens a phone device in this mode is allowed to change the state of the lamps, ringer, display, and hookswitch devices of the phone. Having owner privilege to a phone device automatically includes monitor privilege as well. 
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the request succeeds or a negative error number if an error occurs. Possible return values are: </p>
<p>
PHONEERR_ALLOCATED, PHONEERR_NODRIVER, PHONEERR_BADDEVICEID, PHONEERR_NOMEM, PHONEERR_INCOMPATIBLEAPIVERSION, PHONEERR_OPERATIONFAILED, PHONEERR_INCOMPATIBLEEXTVERSION, PHONEERR_OPERATIONUNAVAIL, PHONEERR_INVALAPPHANDLE, PHONEERR_RESOURCEUNAVAIL, PHONEERR_INVALPOINTER, PHONEERR_UNINITIALIZED, PHONEERR_INVALPRIVILEGE, PHONEERR_REINIT, PHONEERR_INUSE, PHONEERR_NODEVICE, PHONEERR_INIFILECORRUPT.</p>
<h4>Remarks</h4>
<p>
When opening a phone device with monitor privileges, the application is sent messages when events occur that change the status of the phone. Messages sent to the application include <a href="msgs_01bi.htm">PHONE_BUTTON</a> and <a href="msgs_6wkl.htm">PHONE_STATE</a>. The latter provides an indication of the phone's status item that has changed. </p>
<p>
When opening a phone with owner privilege, the phone device can be manipulated in ways that affect the state of the phone device. An application should only open a phone using owner privilege if it actively wants to manipulate the phone device, and it should close the phone device when finished to allow other applications to control the phone. </p>
<p>
When an application opens a phone device, it must specify the negotiated API version and, if it wants to use the phone's extensions, the phone's device-specific extension version. This version number should have been obtained with the <b>phoneNegotiateAPIVersion</b> and <b>phoneNegotiateExtVersion </b>functions. Version numbering allows the mix and match of different application versions with different API versions and service-provider versions. </p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Version:</b> Use TAPI version 1.4 and later.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in tapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with tapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="quickref_9s85.htm">TAPI Reference Overview</a>, <a href="quickref_352r.htm">Supplementary Phone Services Functions</a>, <a href="msgs_01bi.htm">PHONE_BUTTON</a>, <a href="msgs_6wkl.htm">PHONE_STATE</a>, <a href="func2_223y.htm"><b>phoneNegotiateAPIVersion</b></a>, <a href="func2_66cu.htm"><b>phoneNegotiateExtVersion</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
