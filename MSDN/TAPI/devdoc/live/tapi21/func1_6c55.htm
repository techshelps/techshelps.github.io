<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>lineGetAppPriority</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_linegetapppriority"></a>lineGetAppPriority</h1>
<p>
The <b>lineGetAppPriority</b> function allows an application to determine whether or not it is in the handoff priority list for a particular media mode or Assisted Telephony request mode and, if so, its position in the priority list. </p>
<pre><code><b>LONG lineGetAppPriority(
  LPCSTR</b><i> lpszAppFilename</i><b>,                 </b>
<b>  DWORD</b><i> dwMediaMode</i><b>,                      </b>
<b>  LPLINEEXTENSIONID const</b><i> lpExtensionID</i><b>,  </b>
<b>  DWORD</b><i> dwRequestMode</i><b>,                    </b>
<b>  LPVARSTRING</b><i> lpExtensionName</i><b>,            </b>
<b>  LPDWORD</b><i> lpdwPriority                    </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpszAppFilename</i> </dt>
<dd>
A pointer to a string containing the application executable module filename (without directory information). In API version 2.0 or later, the parameter can be in either long or 8.3 filename format. In API versions earlier than 2.0, the parameter must specify a filename in the 8.3 format; long filenames cannot be used. </dd>
<dt>
<i>dwMediaMode</i> </dt>
<dd>
The media mode for which the priority information is to be obtained. The value can be one of the LINEMEDIAMODE_ constants; only a single bit can be on. The value 0 should be used if checking application priority for Assisted Telephony requests. </dd>
<dt>
<i>lpExtensionID</i> </dt>
<dd>
A pointer to structure of type <a href="struc2_1yia.htm"><b>LINEEXTENSIONID</b></a>. This parameter is ignored. </dd>
<dt>
<i>dwRequestMode</i> </dt>
<dd>
If the <i>dwMediaMode</i> parameter is zero, this parameter specifies the Assisted Telephony request mode for which priority is to be checked. It must be either LINEREQUESTMODE_MAKECALL or LINEREQUESTMODE_MEDIACALL. This parameter is ignored if <i>dwMediaMode</i> is non-zero. </dd>
<dt>
<i>lpExtensionName</i> </dt>
<dd>
This parameter is ignored. </dd>
<dt>
<i>lpdwPriority</i> </dt>
<dd>
A pointer to a <b>DWORD</b>-size memory location into which TAPI writes the priority of the application for the specified media or request mode. The value 0 is returned if the application is not in the stored priority list and does not currently have any line device open with ownership requested of the specified media mode or having registered for the specified request mode. 
<p>
In API versions earlier than 2.0, the value –1 (0xFFFFFFFF) is returned if the application has the line open for the specified media mode or has registered for the specified requests, but the application is not in the stored priority list (that is, it is in the temporary priority list only). In API version 2.0 or later, the value 0 is returned to indicate this condition. 

<p>
Otherwise, the value indicates the application's position in the list (with 1 being highest priority, and increasing values indicating decreasing priority). 

</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the request succeeds or a negative error number if an error occurs. Possible return values are: </p>
<p>
LINEERR_INIFILECORRUPT, LINEERR_INVALREQUESTMODE, LINEERR_INVALAPPNAME, LINEERR_NOMEM, LINEERR_INVALMEDIAMODE, LINEERR_OPERATIONFAILED, LINEERR_INVALPOINTER, LINEERR_STRUCTURETOOSMALL.</p>
<h4>Remarks</h4>
<p>
If LINEERR_INVALMEDIAMODE is returned, the value specified in <i>dwMediaMode</i> is not zero, not a valid extended media mode, and not a LINEMEDIAMODE_ constant, or more than one bit is on in the parameter value. </p>
<p>
Also, long filenames are now permitted for <i>lpszAppFilename</i>; 8.3 format names are acceptable, but no longer required. </p>
<p>
Although this is a new function that older applications would not be expected to call, for backward compatibility they should not be prevented from doing so; the function works the same way for all applications. </p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Version:</b> Use TAPI version 1.4 and later.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in tapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with tapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="quickref_9s85.htm">TAPI Reference Overview</a>, <a href="quickref_2bg3.htm">Supplementary Line Services Functions</a>, <a href="struc2_1yia.htm"><b>LINEEXTENSIONID</b></a>, <a href="struc2_90xe.htm"><b>VARSTRING</b></a></p>
<p>&nbsp;</p></body>
</HTML>
