<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>lineTranslateDialog</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_linetranslatedialog"></a>lineTranslateDialog</h1>
<p>
The <b>lineTranslateDialog</b> function displays an application-modal dialog box that allows the user to change the current location of a phone number about to be dialed, adjust location and calling card parameters, and see the effect. </p>
<pre><code><b>LONG lineTranslateDialog(
  HLINEAPP</b><i> hLineApp</i><b>,   </b>
<b>  DWORD</b><i> dwDeviceID</i><b>,    </b>
<b>  DWORD</b><i> dwAPIVersion</i><b>,  </b>
<b>  HWND</b><i> hwndOwner</i><b>,      </b>
<b>  LPCSTR</b><i> lpszAddressIn </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hLineApp</i> </dt>
<dd>
The application handle returned by <a href="func1_8th4.htm"><b>lineInitializeEx</b></a>. If an application has not yet called the <b>lineInitializeEx</b> function, it can set the <i>hLineApp</i> parameter to NULL. </dd>
<dt>
<i>dwDeviceID</i> </dt>
<dd>
The device identifier for the line device upon which the call is intended to be dialed, so that variations in dialing procedures on different lines can be applied to the translation process. </dd>
<dt>
<i>dwAPIVersion</i> </dt>
<dd>
Indicates the highest version of TAPI supported by the application (<i>not</i> necessarily the value negotiated by <a href="func2_329a.htm"><b>lineNegotiateAPIVersion</b></a> on the line device indicated by <i>dwDeviceID</i>). </dd>
<dt>
<i>hwndOwner</i> </dt>
<dd>
A handle to a window to which the dialog box is to be attached. Can be a NULL value to indicate that any window created during the function should have no owner window. </dd>
<dt>
<i>lpszAddressIn</i> </dt>
<dd>
A pointer to a NULL-terminated ASCII string containing a phone number that is used, in the lower portion of the dialog box, to show the effect of the user's changes on the location parameters. The number must be in canonical format; if noncanonical, the phone number portion of the dialog box is not displayed. This pointer can be left NULL, in which case the phone number portion of the dialog box is not displayed. If the <i>lpszAddressIn</i> parameter contains a subaddress or name field, or additional addresses separated from the first address by ASCII CR and LF characters, only the first address is used in the dialog box. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the request succeeds or a negative error number if an error occurs. Possible return values are: </p>
<p>
LINEERR_BADDEVICEID, LINEERR_INVALPARAM, LINEERR_INCOMPATIBLEAPIVERSION, LINEERR_INVALPOINTER, LINEERR_INIFILECORRUPT, LINEERR_NODRIVER, LINEERR_INUSE, LINEERR_NOMEM, LINEERR_INVALADDRESS, LINEERR_INVALAPPHANDLE, LINEERR_OPERATIONFAILED.</p>
<h4>Remarks</h4>
<p>
In TAPI version 2.0 or later, it is possible for multiple instances of this dialog box to be opened. In TAPI versions earlier than 2.0, LINEERR_INUSE is returned if the dialog box is already displayed by another application (cannot be open more than once). In these versions, TAPI brings the existing dialog box to the front, and the error indicates that any particulars related to the address passed in by the current application have not been handled, because that address was not processed by the function. </p>
<p>
The application must call <a href="func1_09o3.htm"><b>lineGetTranslateCaps</b></a> after this function to obtain any changes the user made to the telephony address translation parameters, and call <a href="func2_5qyb.htm"><b>lineTranslateAddress</b></a> to obtain a dialable string based on the user's new selections. </p>
<p>
If any function related to address translation (for example, <b>lineGetTranslateCaps</b> or <b>lineTranslateAddress</b>) returns LINEERR_INIFILECORRUPT, the application should call <b>lineTranslateDialog</b>. The <b>lineTranslateDialog</b> function detects the errors and corrects them, and reports the action taken to the user. LINEERR_INIFILECORRUPT is returned the first time any of these functions are used after installation of Windows 95, because the parameters are uninitialized (<b>lineTranslateDialog</b> takes care of initializing them, using the user-specified default country to select the default country code). </p>
<p>
Although this is a new function which older applications would not be expected to call, for backward compatibility they should not be prevented from doing so; the full range of API versions supported by TAPI (0x00010003 to 0x00010004) should work the same way. </p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Version:</b> Use TAPI version 1.4 and later.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in tapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with tapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="quickref_9s85.htm">TAPI Reference Overview</a>, <a href="quickref_7uzp.htm">Basic Telephony Services Reference</a>, <a href="func1_09o3.htm"><b>lineGetTranslateCaps</b></a>, <a href="func1_8th4.htm"><b>lineInitializeEx</b></a>, <a href="func2_329a.htm"><b>lineNegotiateAPIVersion</b></a>, <a href="func2_5qyb.htm"><b>lineTranslateAddress</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
