<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Variably Sized Data Structures</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_win32_variably_sized_data_structures"></a>Variably Sized Data Structures</h2>
<p>
When variably sized data structures are used to transmit information between TAPI and the application, the application is responsible for allocating the necessary memory. The amount of memory allocated must be at least large enough for the fixed portion of the data structure, and is set by the application in the <b>dwTotalSize</b> member of the data structure. The <b>dwUsedSize</b> and <b>dwNeededSize</b> members are filled in by TAPI. If <b>dwTotalSize</b> is less than the size of the fixed portion, then LINEERR/ PHONEERR_STRUCTURETOOSMALL is returned. If a function returns success, then all the fields in the fixed portion have been filled in. The <b>dwUsedSize</b> and <b>dwNeededSize</b> members can be compared to determine if all variable parts have been filled in, and how much space would be required to fill them all in. </p>
<p>
If <b>dwNeededSize</b> is equal to <b>dwUsedSize</b>, then all fixed and variable parts have been filled in. If <b>dwNeededSize</b> is larger than <b>dwUsedSize</b>, some variable parts may have been filled in, but exactly which variably sized fields have been filled in is undefined. No variable part is ever truncated, and variable parts that would have been truncated due to insufficient space are indicated by having both of their corresponding "Offset" and "Size" parts set to zero. If these are not both zero (and no error was returned), they indicate the offset and size of valid, nontruncated variable-part data. </p>
<p>
An application can always guarantee that all variable parts are filled in by allocating and indicating <b>dwNeededSize</b> bytes for the structure and calling the "Get" function again until the function returns success and <b>dwNeededSize</b> equals <b>dwUsedSize</b>. This should happen on the second try except for race conditions that cause changes in the size of variable parts between calls, which should be a rare occurrence. </p>
<p>
<b>Note</b>&nbsp;&nbsp;All ASCII, DBCS, and Unicode strings that occur in variably sized structures should be NULL-terminated according to normal C string handling conventions. </p>
<p>&nbsp;</p></body>
</HTML>
