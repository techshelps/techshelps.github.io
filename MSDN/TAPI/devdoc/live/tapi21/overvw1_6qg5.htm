<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Obtaining a Line</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h3><a name="_win32_obtaining_a_line"></a>Obtaining a Line</h3>
<p>
Next, the application needs to obtain a handle to a capable telephone line. The application opens the line with <a href="func2_2lny.htm"><b>lineOpen</b></a>, but before doing this, it must make sure that the line can support the desired type of call. Invoking the <a href="func1_22nn.htm"><b>lineGetDevCaps</b></a> function returns that information to the application in a data structure of type <a href="struc2_30mq.htm"><b>LINEDEVCAPS</b></a>. If data calls were not supported, this fact could be reported to the user in a dialog box. The application does not need to use <b>lineGetDevCaps</b> before every call, because a line's capabilities should remain static. If the local telephonic configuration (as expressed in .ini files) changes, TAPI notifies applications, which can then call <b>lineGetDevCaps</b> to see what has changed. </p>
<p>
One of the values returned by <b>lineGetDevCaps</b> (as a member in the <b>LINEDEVCAPS</b> structure) is the number of addresses assigned to the specified line device. In this example, a single device has a single address. </p>
<p>
Ownership of a call is a type of privilege. Applications obtain owner or monitor privilege to new incoming calls by specifying the desired privilege as a parameter of <a href="func2_2lny.htm"><b>lineOpen</b></a>. The privilege with which a line is opened remains in effect for subsequent calls used by that application on that line. An application always has owner privileges on calls it creates. When the application opens a line to place calls (as opposed to taking incoming calls) it invokes <b>lineOpen</b> with the privilege LINECALLPRIVILEGE_NONE, which insulates the application from incoming calls while allowing outgoing calls. The other privileges used with the <b>lineOpen</b> function are only for incoming calls. </p>
<p>
The LINEOPENOPTION_SINGLEADDRESS option is available when using the <b>lineOpen</b> function to allow the application to specify that handles for new calls (either monitor or owner handles) should be delivered to the application only if the address on which the call appears matches the address provided as a function parameter. This is extremely useful when different addresses on a line are designated for calls of different media modes. </p>
<p>&nbsp;</p></body>
</HTML>
