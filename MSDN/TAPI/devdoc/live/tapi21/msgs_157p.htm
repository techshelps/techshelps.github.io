<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TAPIERROR_FORMATMESSAGE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_tapierror_formatmessage"></a>TAPIERROR_FORMATMESSAGE</h1>
<p>
The <b>TAPIERROR_FORMATMESSAGE</b> macro generates an identifier for standard TAPI error message text strings that can be obtained by Win32 applications using the Win32 <b>FormatMessage</b> function.</p>
<p>
This mechanism should be used only for displaying information on errors for which the application has no defined method of recovery (that is, unexpected or internal errors). In most cases (unlike the following simplified example), it is desirable to include additional text informing the user of actions the application takes (or the user should take) as a result of the unhandled error.</p>
<p>
If the application gets an error result from any TAPI function, the error value can be passed through the <b>TAPIERROR_FORMATMESSAGE </b>macro, which in turn generates the real value to be passed to <b>FormatMessage</b>. <b>FormatMessage</b> produces an error string corresponding to the error in a buffer. For example:</p>
<pre><code>lResult = lineClose(hLine);

if (lResult &lt; 0)
{
        FormatMessage(FORMAT_MESSAGE_FROM_HMODULE,
                    (LPCVOID)GetModuleHandle("TAPI32.DLL"),
                    TAPIERROR_FORMATMESSAGE(lResult),
                    0,
                    (LPTSTR)pBuf,
                    BUFSIZE,
                    NULL);
        MessageBox(hWnd,pBuf,"TAPI ERROR",MB_OK);
}
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
