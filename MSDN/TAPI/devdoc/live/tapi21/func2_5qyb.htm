<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>lineTranslateAddress</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_linetranslateaddress"></a>lineTranslateAddress</h1>
<p>
The <b>lineTranslateAddress</b> function translates the specified address into another format. </p>
<pre><code><b>LONG lineTranslateAddress(
  HLINEAPP</b><i> hLineApp</i><b>,                       </b>
<b>  DWORD</b><i> dwDeviceID</i><b>,                        </b>
<b>  DWORD</b><i> dwAPIVersion</i><b>,                      </b>
<b>  LPCSTR</b><i> lpszAddressIn</i><b>,                    </b>
<b>  DWORD</b><i> dwCard</i><b>,                            </b>
<b>  DWORD</b><i> dwTranslateOptions</i><b>,                </b>
<b>  LPLINETRANSLATEOUTPUT</b><i> lpTranslateOutput  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hLineApp</i> </dt>
<dd>
The application handle returned by <a href="func1_8th4.htm"><b>lineInitializeEx</b></a>. If an application has not yet called the <b>lineInitializeEx</b> function, it can set the <i>hLineApp</i> parameter to NULL. </dd>
<dt>
<i>dwDeviceID</i> </dt>
<dd>
The device identifier for the line device upon which the call is intended to be dialed, so that variations in dialing procedures on different lines can be applied to the translation process. </dd>
<dt>
<i>dwAPIVersion</i> </dt>
<dd>
Indicates the highest version of TAPI supported by the application (<i>not</i> necessarily the value negotiated by <a href="func2_329a.htm"><b>lineNegotiateAPIVersion</b></a> on some particular line device). </dd>
<dt>
<i>lpszAddressIn</i> </dt>
<dd>
A pointer to a NULL-terminated ASCII string containing the address from which the information is to be extracted for translation. Must be in either the canonical address format, or an arbitrary string of dialable digits (non-canonical). This parameter must not be NULL. If the <i>AddressIn</i> contains a subaddress or name field, or additional addresses separated from the first address by ASCII CR and LF characters, only the first address is translated, and the remainder of the string is returned to the application without modification. </dd>
<dt>
<i>dwCard</i> </dt>
<dd>
The credit card to be used for dialing. This parameter is only valid if the CARDOVERRIDE bit is set in <i>dwTranslateOptions</i>. This parameter specifies the permanent identifier of a Card entry in the [Cards] section in the registry (as obtained from <b>lineTranslateCaps</b>) which should be used instead of the <b>PreferredCardID</b> specified in the definition of the <b>CurrentLocation</b>. It does not cause the <i>PreferredCardID</i> parameter of the current Location entry in the registry to be modified; the override applies only to the current translation operation. This parameter is ignored if the CARDOVERRIDE bit is not set in <i>dwTranslateOptions</i>. </dd>
<dt>
<i>dwTranslateOptions</i> </dt>
<dd>
The associated operations to be performed prior to the translation of the address into a dialable string. This parameter uses the following LINETRANSLATEOPTION_ constants: 
<dl>
<dt>
LINETRANSLATEOPTION_CARDOVERRIDE </dt>
<dd>
If this bit is set, <i>dwCard</i> specifies the permanent identifier of a Card entry in the [Cards] section in the registry (as obtained from <b>lineTranslateCaps</b>) that should be used instead of the <i>PreferredCardID</i> specified in the definition of the CurrentLocation. It does not cause the <i>PreferredCardID</i> parameter of the current Location entry in the registry to be modified; the override applies only to the current translation operation. The <i>dwCard</i> parameter is ignored if the CARDOVERRIDE bit is not set. </dd>
<dt>
LINETRANSLATEOPTION_CANCELCALLWAITING </dt>
<dd>
If a Cancel Call Waiting string is defined for the location, setting this bit causes that string to be inserted at the beginning of the dialable string. This is commonly used by data modem and fax applications to prevent interruption of calls by call waiting beeps. If no Cancel Call Waiting string is defined for the location, this bit has no affect. 
</dd>
</dl>

<p>
<b>Note</b>&nbsp;&nbsp;If you have set the LINETRANSLATEOPTION_CANCELCALLWAITING bit, it is also advisable to set the LINECALLPARAMFLAGS_SECURE bit in the <b>dwCallParamFlags</b> member of the <a href="struc1_1tgy.htm"><b>LINECALLPARAMS</b></a> structure (passed in to <b>lineMakeCall</b> through the <i>lpCallParams</i> parameter). This prevents the line device from using dialable digits to suppress call interrupts. 


<dl>
<dt>
LINETRANSLATEOPTION_FORCELOCAL </dt>
<dd>
If the number is local but would have been translated as a long distance call (LINETRANSLATERESULT_INTOLLLIST bit set in the <a href="struc2_7302.htm"><b>LINETRANSLATEOUTPUT</b></a> structure), this option forces it to be translated as local. This is a temporary override of the toll list setting. </dd>
<dt>
LINETRANSLATEOPTION_FORCELD </dt>
<dd>
If the address could potentially have been a toll call, but would have been translated as a local call (LINETRANSLATERESULT_NOTINTOLLLIST bit set in the <b>LINETRANSLATEOUTPUT</b> structure), this option forces it to be translated as long distance. This is a temporary override of the toll list setting. 
</dd>
</dl>
</dd>
<dt>
<i>lpTranslateOutput</i> </dt>
<dd>
A pointer to an application-allocated memory area to contain the output of the translation operation, of type <b>LINETRANSLATEOUTPUT</b>. Prior to calling <b>lineTranslateAddress</b>, the application should set the <b>dwTotalSize</b> member of this structure to indicate the amount of memory available to TAPI for returning information. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the request succeeds or a negative error number if an error occurs. Possible return values are: </p>
<p>
LINEERR_BADDEVICEID, LINEERR_INVALPOINTER, LINEERR_INCOMPATIBLEAPIVERSION, LINEERR_NODRIVER, LINEERR_INIFILECORRUPT, LINEERR_NOMEM, LINEERR_INVALADDRESS, LINEERR_OPERATIONFAILED, LINEERR_INVALAPPHANDLE, LINEERR_RESOURCEUNAVAIL, LINEERR_INVALCARD, LINEERR_STRUCTURETOOSMALL, LINEERR_INVALPARAM. </p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Version:</b> Use TAPI version 1.4 and later.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in tapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with tapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="quickref_9s85.htm">TAPI Reference Overview</a>, <a href="quickref_7uzp.htm">Basic Telephony Services Reference</a>, <a href="func1_8th4.htm"><b>lineInitializeEx</b></a>, <a href="struc1_1tgy.htm"><b>LINECALLPARAMS</b></a>, <a href="func2_329a.htm"><b>lineNegotiateAPIVersion</b></a>, <a href="struc2_7302.htm"><b>LINETRANSLATEOUTPUT</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
