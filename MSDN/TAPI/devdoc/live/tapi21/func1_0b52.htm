<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>lineHandoff</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_linehandoff"></a>lineHandoff</h1>
<p>
The <b>lineHandoff</b> function gives ownership of the specified call to another application. The application can be either specified directly by its filename or indirectly as the highest priority application that handles calls of the specified media mode. </p>
<pre><code><b>LONG lineHandoff(
  HCALL</b><i> hCall</i><b>,          </b>
<b>  LPCSTR</b><i> lpszFileName</i><b>,  </b>
<b>  DWORD</b><i> dwMediaMode     </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hCall</i> </dt>
<dd>
A handle to the call to be handed off. The application must be an owner of the call. The call state of <i>hCall</i> can be any state. </dd>
<dt>
<i>lpszFileName</i> </dt>
<dd>
A pointer to a NULL-terminated ASCII string. If this pointer parameter is non-NULL, it contains the filename of the application that is the target of the handoff. If NULL, the handoff target is the highest priority application that has opened the line for owner privilege for the specified media mode. A valid filename does not include the path of the file. </dd>
<dt>
<i>dwMediaMode</i> </dt>
<dd>
The media mode used to identify the target for the indirect handoff. The <i>dwMediaMode</i> parameter indirectly identifies the target application that is to receive ownership of the call. This parameter is ignored if <i>lpszFileName</i> is not NULL. Only a single flag can be set in the <i>dwMediaMode</i> parameter at any one time. This parameter uses the following LINEMEDIAMODE_ constants: 
<dl>
<dt>
LINEMEDIAMODE_UNKNOWN </dt>
<dd>
The target application is the one that handles calls of unknown media mode (unclassified calls). </dd>
<dt>
LINEMEDIAMODE_INTERACTIVEVOICE </dt>
<dd>
The target application is the one that handles calls with the interactive voice media mode (live conversations). </dd>
<dt>
LINEMEDIAMODE_AUTOMATEDVOICE </dt>
<dd>
Voice energy is present on the call and the voice is locally handled by an automated application. </dd>
<dt>
LINEMEDIAMODE_DATAMODEM </dt>
<dd>
The target application is the one that handles calls with the data modem media mode. </dd>
<dt>
LINEMEDIAMODE_G3FAX </dt>
<dd>
The target application is the one that handles calls with the group 3 fax media mode. </dd>
<dt>
LINEMEDIAMODE_TDD </dt>
<dd>
The target application is the one that handles calls with the TDD (Telephony Devices for the Deaf) media mode. </dd>
<dt>
LINEMEDIAMODE_G4FAX </dt>
<dd>
The target application is the one that handles calls with the group 4 fax media mode. </dd>
<dt>
LINEMEDIAMODE_DIGITALDATA </dt>
<dd>
The target application is the one that handles calls that are digital data calls. </dd>
<dt>
LINEMEDIAMODE_TELETEX </dt>
<dd>
The target application is the one that handles calls with the teletex media mode. </dd>
<dt>
LINEMEDIAMODE_VIDEOTEX </dt>
<dd>
The target application is the one that handles calls with the videotex media mode. </dd>
<dt>
LINEMEDIAMODE_TELEX </dt>
<dd>
The target application is the one that handles calls with the telex media mode. </dd>
<dt>
LINEMEDIAMODE_MIXED </dt>
<dd>
The target application is the one that handles calls with the ISDN mixed media mode. </dd>
<dt>
LINEMEDIAMODE_ADSI </dt>
<dd>
The target application is the one that handles calls with the ADSI (Analog Display Services Interface) media mode. </dd>
<dt>
LINEMEDIAMODE_VOICEVIEW </dt>
<dd>
The media mode of the call is VoiceView. 
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the request succeeds or a negative error number if an error occurs. Possible return values are: </p>
<p>
LINEERR_INVALCALLHANDLE, LINEERR_OPERATIONFAILED, LINEERR_INVALMEDIAMODE, LINEERR_TARGETNOTFOUND, LINEERR_INVALPOINTER, LINEERR_TARGETSELF, LINEERR_NOMEM, LINEERR_UNINITIALIZED, LINEERR_NOTOWNER.</p>
<h4>Remarks</h4>
<p>
The <b>lineHandoff</b> function returns LINEERR_TARGETSELF if the calling application attempted an indirect handoff (that is, set the <i>lpszFileName</i> parameter to NULL) and TAPI determined that the application is itself the highest priority application for the given media mode. If LINEERR_TARGETNOTFOUND is returned, a target for the call handoff was not found. This can occur if the named application did not open the same line with the LINECALLPRIVILEGE_OWNER bit in the <i>dwPrivileges</i> parameter of <a href="func2_2lny.htm"><b>lineOpen</b></a>. Or, in the case of media-mode handoff, no application has opened the same line with the LINECALLPRIVILEGE_OWNER bit in the <i>dwPrivileges</i> parameter of <b>lineOpen</b> and with the media mode specified in the <i>dwMediaModes</i> parameter of <b>lineOpen</b>. </p>
<p>
Call handoff allows ownership of a call to be passed among applications. There are two types of handoff. In the first type, if the application knows the filename of the target application, it can simply specify that filename. If an instance of the target application has opened the line device, ownership of the call is passed to the other application; otherwise, the handoff fails and an error is returned. This form of handoff succeeds if the call handle is handed off to the same filename as the application requesting the handoff. </p>
<p>
The second type of handoff is based on media mode. In this case, the application indirectly specifies the target application by means of a media mode. The highest priority application that has currently opened the line device for that media mode is the target for the handoff. If there is no such application, the handoff fails and an error is returned. </p>
<p>
The <b>lineHandoff</b> function does not change the media mode of a call. To change the media mode of a call, the application should use <a href="func2_5bl1.htm"><b>lineSetMediaMode</b></a> on the call, specifying the new media mode. This changes the call's media mode as stored in the call's <a href="struc1_0twy.htm"><b>LINECALLINFO</b></a> structure. </p>
<p>
If handoff succeeds, the receiving application receives a <a href="msgs_1eud.htm">LINE_CALLSTATE</a> message for the call. This message indicates that the receiving application has owner privilege to the call (<i>dwParam3</i>). In addition, the number of owners and/or monitors for the call may have changed. This is reported by the <a href="msgs_22cv.htm">LINE_CALLINFO</a> message, and the receiving application can then invoke <a href="func1_106r.htm"><b>lineGetCallStatus</b></a> and <a href="func1_5zov.htm"><b>lineGetCallInfo</b></a> to retrieve more information about the received call. </p>
<p>
The receiving application should first check the media mode in <a href="struc1_0twy.htm"><b>LINECALLINFO</b></a>. If only a single media mode flag is set, the call is officially of that media mode, and the application can act accordingly. If UNKNOWN and other media mode flags are set, then the media mode of the call is officially UNKNOWN but is assumed to be of one of the media modes for which a flag is set in <b>LINECALLINFO</b>. The application should assume that it ought to probe for the highest priority media mode. </p>
<p>
If the probe succeeds (either for that media mode or for another one), the application should set the media mode member in <b>LINECALLINFO</b> to the single media mode that was recognized. If the media mode flag matches the <b>LINECALLINFO</b> media mode, the application can act accordingly. If it makes a determination for another media mode, it must first hand off the call to that media mode. </p>
<p>
If the probe fails, the application should clear the corresponding media mode flag in <b>LINECALLINFO</b> and hand off the call, specifying <i>dwMediaMode</i> as LINEMEDIAMODE_UNKNOWN. It should also deallocate its call handle (or revert back to monitoring). </p>
<p>
If none of the media modes succeeded in making a determination, only the UNKNOWN flag remains set in the media mode field of <b>LINECALLINFO</b> at the time the media application attempts to hand off the call to UNKNOWN. The final <b>lineHandoff</b> fails if the application is the only remaining owner of the call. This informs the application that it should drop the call and deallocate its handle, in which case the call is abandoned. The privileges of the invoking application to the call are unchanged by this operation, but the application can change its privileges to a call with <b>lineSetCallPrivilege</b>. </p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Version:</b> Use TAPI version 1.4 and later.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in tapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with tapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="quickref_9s85.htm">TAPI Reference Overview</a>, <a href="quickref_7uzp.htm">Basic Telephony Services Reference</a>, <a href="struc1_0twy.htm"><b>LINECALLINFO</b></a>,<b> <a href="func1_106r.htm">lineGetCallStatus</a></b>,<b> <a href="func2_2lny.htm">lineOpen</a></b>, <a href="func2_2m1x.htm"><b>lineSetCallPrivilege</b></a>, <a href="func2_5bl1.htm"><b>lineSetMediaMode</b></a></p>
<p>&nbsp;</p></body>
</HTML>
