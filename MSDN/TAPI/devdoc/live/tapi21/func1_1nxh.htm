<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>lineInitialize</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_lineinitialize"></a>lineInitialize</h1>
<p>
The <b>lineInitialize</b> function is obsolete. It continues to be exported by tapi.dll and tapi32.dll for backward compatibility with applications using API versions 1.3 and 1.4. </p>
<p>
Applications using API version 2.0 or later must use <a href="func1_8th4.htm"><b>lineInitializeEx</b></a> instead. </p>
<h2>For TAPI Versions 1.4 and earlier</h2>
<p>
The<b> lineInitialize</b> function initializes the application's use of Tapi.dll for subsequent use of the line abstraction. The function registers the application's specified notification mechanism and returns the number of line devices available to the application. A line device is any device that provides an implementation for the line-prefixed functions in TAPI.</p>
<pre><code><b>LONG lineInitialize(
  LPHLINEAPP</b><i> lphLineApp</i><b>,  </b>
<b>  HINSTANCE</b><i> hInstance</i><b>,    </b>
<b>  LINECALLBACK</b><i> lpfnCallback</i><b>,  </b>
<b>  LPCSTR</b><i> lpszAppName</i><b>,     </b>
<b>  LPDWORD</b><i> lpdwNumDevs     </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lphLineApp</i></dt>
<dd>
A pointer to a location that is filled with the application's usage handle for TAPI.</dd>
<dt>
<i>hInstance</i></dt>
<dd>
The instance handle of the client application or DLL.</dd>
<dt>
<i>lpfnCallback</i></dt>
<dd>
The address of a callback function that is invoked to determine status and events on the line device, addresses, or calls. For more information, see <a href="func1_96xv.htm"><b>lineCallbackFunc</b></a>.</dd>
<dt>
<i>lpszAppName</i></dt>
<dd>
A pointer to a NULL-terminated ASCII string that contains only displayable ASCII characters. If this parameter is not NULL, it contains an application-supplied name for the application. This name is provided in the <a href="struc1_0twy.htm"><b>LINECALLINFO</b></a> structure to indicate, in a user-friendly way, which application originated, or originally accepted or answered the call. This information can be useful for call logging purposes. If <i>lpszAppName</i> is NULL, the application's filename is used instead.</dd>
<dt>
<i>lpdwNumDevs</i></dt>
<dd>
A pointer to a <b>DWORD</b>-sized location. Upon successful completion of this request, this location is filled with the number of line devices available to the application.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the request succeeds or a negative error number if an error occurs. Possible return values are:</p>
<p>
LINEERR_INVALAPPNAME, LINEERR_OPERATIONFAILED, LINEERR_INIFILECORRUPT, LINEERR_RESOURCEUNAVAIL, LINEERR_INVALPOINTER, LINEERR_REINIT, LINEERR_NODRIVER, LINEERR_NODEVICE, LINEERR_NOMEM, LINEERR_NOMULTIPLEINSTANCE.</p>
<h4>Remarks</h4>
<p>
If LINEERR_REINIT is returned and TAPI reinitialization has been requested (for example as a result of adding or removing a telephony service provider), then <b>lineInitialize</b> requests are rejected with this error until the last application shuts down its usage of the API (using <a href="func2_0m26.htm"><b>lineShutdown</b></a>). At that time, the new configuration becomes effective and applications are once again permitted to call <b>lineInitialize</b>. If the LINEERR_INVALPARAM error value is returned, the specified <i>hInstance</i> parameter is invalid.</p>
<p>
The application can refer to individual line devices by using line device identifiers that range from zero to <i>dwNumDevs</i> minus one. An application should not assume that these line devices are capable of anything beyond what is specified by the Basic Telephony subset without first querying their device capabilities using <a href="func1_22nn.htm"><b>lineGetDevCaps</b></a> and <a href="func1_7wfn.htm"><b>lineGetAddressCaps</b></a>.</p>
<p>
Applications should not invoke <b>lineInitialize</b> without subsequently opening a line (at least for monitoring). If the application is not monitoring and not using any devices, it should call <b>lineShutdown</b> so that memory resources allocated by tapi.dll can be released if unneeded, and tapi.dll itself can be unloaded from memory while not needed.</p>
<p>
Another reason for performing a <b>lineShutdown</b> is that if a user changes the device configuration (adds or removes a line or phone), there is no way for TAPI to notify an application that has a line or phone handle open at the time. After a reconfiguration has taken place, causing a LINEDEVSTATE_REINIT message to be sent, no applications can open a device until all applications have performed a <b>lineShutdown</b>. If any service provider fails to initialize properly, this function fails and returns the error indicated by the service provider.</p>
<p>
On all TAPI platforms, <b>lineInitialize</b> is equivalent to <b>lineInitializeEx()</b> using the LINEINITIALIZEEXOPTION_USEHIDDENWINDOW option.</p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Version:</b> Use TAPI version 1.4. Not available in TAPI 2.0 or later.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in tapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with tapi32.lib.</p>
<h4>See Also</h4>
<p>
<a href="func1_96xv.htm"><b>lineCallbackFunc</b></a>, <a href="struc1_0twy.htm"><b>LINECALLINFO</b></a>, <a href="func1_7wfn.htm"><b>lineGetAddressCaps</b></a>, <a href="func1_22nn.htm"><b>lineGetDevCaps</b></a>, <a href="func1_8th4.htm"><b>lineInitializeEx</b></a>, <a href="func2_0m26.htm"><b>lineShutdown</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
