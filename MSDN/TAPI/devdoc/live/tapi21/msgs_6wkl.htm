<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PHONE_STATE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_win32_phone_state"></a>PHONE_STATE</h1>
<p>
TAPI sends the PHONE_STATE message to an application whenever the status of a phone device changes. </p>
<pre><code>PHONE_STATE
hPhone = (HPHONE) hPhoneDevice;
dwCallbackInstance = (DWORD) hCallback;
dwParam1 = (DWORD) PhoneState;
dwParam2 = (DWORD) PhoneStateDetails;
dwParam3 = (DWORD) 0;
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hPhone</i> </dt>
<dd>
A handle to the phone device. </dd>
<dt>
<i>dwCallbackInstance</i> </dt>
<dd>
The application's callback instance provided when opening the phone device. </dd>
<dt>
<i>dwParam1</i> </dt>
<dd>
The phone state that has changed. This parameter uses the following PHONESTATE_ constants: 
<dl>
<dt>
PHONESTATE_OTHER </dt>
<dd>
Phone-status items other than those listed below have changed. The application should check the current phone status to determine which items have changed. </dd>
<dt>
PHONESTATE_CONNECTED </dt>
<dd>
The connection between the phone device and TAPI was just made. This happens when TAPI is first invoked or when the wire connecting the phone to the computer is plugged in while TAPI is active. </dd>
<dt>
PHONESTATE_DISCONNECTED </dt>
<dd>
The connection between the phone device and TAPI was just broken. This happens when the wire connecting the phone set to the computer is unplugged while TAPI is active. </dd>
<dt>
PHONESTATE_OWNER </dt>
<dd>
The number of owners for the phone device has changed. </dd>
<dt>
PHONESTATE_MONITORS </dt>
<dd>
The number of monitors for the phone device has changed. </dd>
<dt>
PHONESTATE_DISPLAY </dt>
<dd>
The display of the phone has changed. </dd>
<dt>
PHONESTATE_LAMP </dt>
<dd>
A lamp of the phone has changed. </dd>
<dt>
PHONESTATE_RINGMODE </dt>
<dd>
The ring mode of the phone has changed. </dd>
<dt>
PHONESTATE_RINGVOLUME </dt>
<dd>
The ring volume of the phone has changed. </dd>
<dt>
PHONESTATE_HANDSETHOOKSWITCH </dt>
<dd>
The handset hookswitch state has changed. </dd>
<dt>
PHONESTATE_HANDSETVOLUME </dt>
<dd>
The handset's speaker volume setting has changed. </dd>
<dt>
PHONESTATE_HANDSETGAIN </dt>
<dd>
The handset's microphone gain setting has changed. </dd>
<dt>
PHONESTATE_SPEAKERHOOKSWITCH </dt>
<dd>
The speakerphone's hookswitch state has changed. </dd>
<dt>
PHONESTATE_SPEAKERVOLUME </dt>
<dd>
The speakerphone's speaker volume setting has changed. </dd>
<dt>
PHONESTATE_SPEAKERGAIN </dt>
<dd>
The speakerphone's microphone gain setting state has changed. </dd>
<dt>
PHONESTATE_HEADSETHOOKSWITCH </dt>
<dd>
The headset's hookswitch state has changed. </dd>
<dt>
PHONESTATE_HEADSETVOLUME </dt>
<dd>
The headset's speaker volume setting has changed. </dd>
<dt>
PHONESTATE_HEADSETGAIN </dt>
<dd>
The headset's microphone gain setting has changed. </dd>
<dt>
PHONESTATE_SUSPEND </dt>
<dd>
The application's use of the phone device is temporarily suspended. </dd>
<dt>
PHONESTATE_RESUME </dt>
<dd>
The application's use of the phone device is resumed after having been suspended for some time. </dd>
<dt>
PHONESTATE_DEVSPECIFIC </dt>
<dd>
The phone's device-specific information has changed. </dd>
<dt>
PHONESTATE_REINIT </dt>
<dd>
Items have changed in the configuration of phone devices. To become aware of these changes (as with the appearance of new phone devices), the application should reinitialize its use of TAPI. The <i>hDevice</i> parameter of the PHONE_STATE message is left NULL for this state change as it applies to any of the phones in the system. </dd>
<dt>
PHONESTATE_CAPSCHANGE </dt>
<dd>
Indicates that due to configuration changes made by the user or other circumstances one or more of the members in the <a href="struc2_8x6a.htm"><b>PHONECAPS</b></a> structure have changed. The application should use <a href="func2_0eib.htm"><b>phoneGetDevCaps</b></a> to read the updated structure. </dd>
<dt>
PHONESTATE_REMOVED </dt>
<dd>
Indicates that the device is being removed from the system by the service provider (most likely through user action, through a control panel or similar utility). Normally, a PHONE_STATE message with this value is immediately followed by a <a href="msgs_9oh1.htm">PHONE_CLOSE</a> message on the device. Subsequent attempts to access the device prior to TAPI being reinitialized result in PHONEERR_NODEVICE being returned to the application. If a service provider sends a PHONE_STATE message containing this value to TAPI, TAPI passes it along to applications that have negotiated TAPI version 1.4 or later; applications negotiating a previous API version do not receive any notification. </dd>
</dl>
</dd>
<dt>
<i>dwParam2</i> </dt>
<dd>
Phone state-dependent information detailing the status change. This parameter is not used if multiple flags are set in <i>dwParam1</i>, because multiple status items have changed. The application should invoke <a href="func2_7c4z.htm"><b>phoneGetStatus</b></a> to obtain a complete set of information. 
<p>
If <i>dwParam1</i> is PHONESTATE_OWNER, <i>dwParam2</i> contains the new number of owners. 

<p>
If <i>dwParam1</i> is PHONESTATE_MONITORS, <i>dwParam2</i> contains the new number of monitors. 

<p>
If <i>dwParam1</i> is PHONESTATE_LAMP, <i>dwParam2</i> contains the button/lamp identifier of the lamp that has changed. 

<p>
If <i>dwParam1</i> is PHONESTATE_RINGMODE, <i>dwParam2</i> contains the new ring mode. 

<p>
If <i>dwParam1</i> is PHONESTATE_HANDSET, SPEAKER or HEADSET, <i>dwParam2</i> contains the new hookswitch mode of that hookswitch device. This parameter uses the following PHONEHOOKSWITCHMODE_ constants: 

<dl>
<dt>
PHONEHOOKSWITCHMODE_ONHOOK </dt>
<dd>
The device's microphone and speaker are both onhook. </dd>
<dt>
PHONEHOOKSWITCHMODE_MIC </dt>
<dd>
The device's microphone is active, the speaker is mute. </dd>
<dt>
PHONEHOOKSWITCHMODE_SPEAKER </dt>
<dd>
The device's speaker is active, the microphone is mute. </dd>
<dt>
PHONEHOOKSWITCHMODE_MICSPEAKER </dt>
<dd>
The device's microphone and speaker are both active. </dd>
</dl>
</dd>
<dt>
<i>dwParam3</i> </dt>
<dd>
Unused. 
</dd>
</dl>
<h4>Return Values</h4>
<p>
No return value. </p>
<h4>Remarks</h4>
<p>
Sending the PHONE_STATE message to the application can be controlled and queried using <b>phoneSetStatusMessages</b> and <b>phoneGetStatusMessages</b>. By default, this message is disabled for all state changes except for PHONESTATE_REINIT, which cannot be disabled. This message is sent to all applications that have a handle to the phone, including those that called <b>phoneOpen</b> with the <i>dwPrivileges</i> parameter set to PHONEPRIVILEGE_OWNER or PHONEPRIVILEGE_MONITOR. </p>
<p>
A PHONE_STATE message with an <i>Owners</i> and/or <i>Monitors</i> indication is sent to applications that already have a handle for the phone. This can be the result of another application changing ownership or monitorship of the phone device with <b>phoneOpen</b>, <b>phoneClose</b> or <b>phoneShutdown</b>. </p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Version:</b> Use TAPI version 1.4 and later.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in tapi.h.</p>
<h4>See Also</h4>
<p>
<a href="msgs_9oh1.htm">PHONE_CLOSE</a>, <a href="struc2_8x6a.htm"><b>PHONECAPS</b></a>, <a href="func2_8fc5.htm"><b>phoneClose</b></a>, <a href="func2_0eib.htm"><b>phoneGetDevCaps</b></a>, <a href="func2_7c4z.htm"><b>phoneGetStatus</b></a>, <a href="func2_8lyr.htm"><b>phoneGetStatusMessages</b></a>, <a href="func2_9zs5.htm"><b>phoneInitialize</b></a>, <a href="func2_5ans.htm"><b>phoneInitializeEx</b></a>, <a href="func2_6him.htm"><b>phoneOpen</b></a>, <a href="func2_86k3.htm"><b>phoneSetStatusMessages</b></a>, <a href="func2_7gku.htm"><b>phoneShutdown</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
