<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_lineGetID</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_linegetid"></a>TSPI_lineGetID</h1>
<p>
The <b>TSPI_lineGetID</b> function returns a device identifier for the specified device class associated with the selected line, address, or call.</p>
<pre><code><b>LONG TSPI_lineGetID(
  HDRVLINE</b><i> hdLine</i><b>,       </b>
<b>  DWORD</b><i> dwAddressID</i><b>,     </b>
<b>  HDRVCALL</b><i> hdCall</i><b>,       </b>
<b>  DWORD</b><i> dwSelect</i><b>,        </b>
<b>  LPVARSTRING</b><i> lpDeviceID</i><b>,  </b>
<b>  LPCWSTR</b><i> lpszDeviceClass</i><b>,  </b>
<b>  HANDLE</b><i> hTargetProcess  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hdLine</i></dt>
<dd>
The service provider's handle to the line to be queried.</dd>
<dt>
<i>dwAddressID</i></dt>
<dd>
An address on the given open line device. TAPI does not validate this parameter when this function is called.</dd>
<dt>
<i>hdCall</i></dt>
<dd>
The service provider's handle to the call to be queried.</dd>
<dt>
<i>dwSelect</i></dt>
<dd>
Specifies whether the device identifier requested is associated with the line, address, or a single call. The <i>dwSelect</i> parameter can only have one of the following LINECALLSELECT_ flags set: 
<dl>
<dt>
LINECALLSELECT_LINE </dt>
<dd>
Select the specified line device. The <i>hdLine</i> parameter must be a valid line handle; <i>hdCall</i> and <i>dwAddressID</i> are unused. </dd>
<dt>
LINECALLSELECT_ADDRESS </dt>
<dd>
Select the specified address on the line. Both <i>hdLine</i> and <i>dwAddressID</i> must be valid; <i>hdCall</i> is unused. </dd>
<dt>
LINECALLSELECT_CALL </dt>
<dd>
Select the specified call. The <i>hdCall</i> parameter must be valid; <i>hdLine</i> and <i>dwAddressID</i> are both unused. </dd>
</dl>
</dd>
<dt>
<i>lpDeviceID</i></dt>
<dd>
A pointer to the memory location of type <a href="struc2_7egi.htm"><b>VARSTRING</b></a> where the device identifier is returned. Upon successful completion of the request, this location is filled with the device identifier. The format of the returned information depends on the method used by the device class (API) for naming devices.</dd>
<dt>
<i>lpszDeviceClass</i></dt>
<dd>
A pointer to a NULL-terminated Unicode string that specifies the device class of the device whose identifier is requested. Valid device class strings are those used in the system.ini section to identify device classes (such as COM, Wave, and MCI.)</dd>
<dt>
<i>hTargetProcess</i></dt>
<dd>
The process handle of the application on behalf of which the <b>TSPI_lineGetID</b> function is invoked. If the information returned in the <a href="struc2_7egi.htm"><b>VARSTRING</b></a> structure includes a handle for use by the application, the service provider should create or duplicate the handle for the process.
<p>
If <i>hTargetProcess</i> is set to INVALID_HANDLE_VALUE, then the application is executing on a remote client system and it is not possible to create a duplicate handle directly. Instead, the <b>VARSTRING</b> structure should contain a UNC name of a network device or other name that the remote client can use to access the device. If this is not possible, then the function should fail.

</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the function succeeds, or an error number if an error occurs. Possible return values are as follows: </p>
<p>
LINEERR_INVALLINEHANDLE, LINEERR_NOMEM, LINEERR_INVALADDRESSID, LINEERR_OPERATIONUNAVAIL, LINEERR_INVALCALLHANDLE, LINEERR_OPERATIONFAILED, LINEERR_NODEVICE, LINEERR_RESOURCEUNAVAIL. </p>
<h4>Remarks</h4>
<p>
The service provide returns LINEERR_INVALLINEHANDLE if <i>dwSelect</i> is LINECALLSELECT_LINE or LINECALLSELECT_ADDRESS, and <i>hdLine</i> is invalid.</p>
<p>
The service provider returns LINEERR_INVALCALLHANDLE if <i>dwSelect</i> is LINECALLSELECT_CALL and <i>hdCall</i> is invalid.</p>
<p>
The service provider should support the tapi/line device class to allow applications to determine the real line device identifier of an opened line. In that case, the variable data returned is the <i>dwDeviceID</i>. For more information about common device class names, see <a href="devclass_7tpv.htm">TSPI Device Classes</a>.</p>
<p>
A vendor that defines a device-specific media mode also needs to define the corresponding device-specific (proprietary) API to manage devices of the media mode. To avoid collisions on device class names assigned independently by different vendors, a vendor should select a name that uniquely identifies the vendor and then the media type; for example: "intel/video".</p>
<p>
The service provider fills in all the members of the <b>VARSTRING</b> data structure, except for <b>dwTotalSize</b>, which is filled in by TAPI. The service provider must <i>not</i> overwrite the <b>dwTotalSize</b> member.</p>
<p>
The service provider does not need to be concerned with handling tapi/line and tapi/phone device classes because TAPI handles these for the service provider. Therefore, code for handling these device classes is optional.</p>
<h4>See Also</h4>
<p>
<a href="func2_7j53.htm"><b>TSPI_lineGetDevConfig</b></a>, <a href="func2_7x2f.htm"><b>TSPI_lineSetDevConfig</b></a>, <a href="struc2_7egi.htm"><b>VARSTRING</b></a></p>
<p>&nbsp;</p></body>
</HTML>
