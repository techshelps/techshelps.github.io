<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LINE_CREATE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_line_create"></a>LINE_CREATE</h1>
<p>
A service provider sends a LINE_CREATE message to the <a href="func3_7q7o.htm"><b>LINEEVENT</b></a> callback function when it desires to create a new device. This can occur when a new device is detected by Plug and Play, or dynamically enabled by the user through a provider configuration function. During the <b>LINEEVENT</b> callback procedure, TAPI simply queues this message for later processing. When the message is received from the queue, the <a href="func1_0qhx.htm"><b>TSPI_providerCreateLineDevice</b></a> function is called in the context of the TAPISRV.EXE process.</p>
<pre><code>LINE_CREATE
htLine = (HTAPILINE) 0;
htCall = (HTAPICALL) 0;
dwMsg = (DWORD) LINE_CREATE;
dwParam1 = (DWORD) hProvider;
dwParam2 = (DWORD) TempDeviceId;
dwParam3 = (DWORD) 0;
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>htLine</i></dt>
<dd>
Unused.</dd>
<dt>
<i>htCall</i></dt>
<dd>
Unused.</dd>
<dt>
<i>dwMsg</i></dt>
<dd>
The value LINE_CREATE.</dd>
<dt>
<i>dwParam1</i></dt>
<dd>
The service provider handle (<i>hProvider</i>) as received in <a href="func1_71kj.htm"><b>TSPI_providerEnumDevices</b></a>.</dd>
<dt>
<i>dwParam2</i></dt>
<dd>
Contains a <i>temporary</i> device identifier generated by the service provider. TAPI uses this value in a subsequent call to <a href="func1_0qhx.htm"><b>TSPI_providerCreateLineDevice</b></a> to assist the provider in associating the message and the function call (in the event that multiple devices are being created).</dd>
<dt>
<i>dwParam3</i></dt>
<dd>
Unused.
</dd>
</dl>
<h4>Return Values</h4>
<p>
No return value.</p>
<h4>Remarks</h4>
<p>
Service providers can (and should) continue to make "static" device allocations at startup when TAPI calls <a href="func1_71kj.htm"><b>TSPI_providerEnumDevices</b></a>. Creating known devices using this mechanism, instead of always using LINE_CREATE, involves lower overhead for applications (because they don't have to process LINE_CREATE messages, updated device information, and so on). The LINE_CREATE mechanism is intended to be used only if new devices are created while the service provider is active (for example, between <a href="func1_9pv8.htm"><b>TSPI_providerInit</b></a> and <a href="func1_2lke.htm"><b>TSPI_providerShutdown</b></a>).</p>
<p>
This message is sent to the <a href="func3_7q7o.htm"><b>LINEEVENT</b></a> callback entry point in TAPI. The service provider receives a pointer to this callback in the <b>TSPI_providerEnumDevices</b> function and in each <a href="func2_9u0e.htm"><b>TSPI_lineOpen</b></a> function; the LINE_CREATE message can be sent to the <b>LINEEVENT</b> callback function given to any open line or at startup.</p>
<p>
Devices cannot be removed dynamically. If a service provider wants to remove a line from service, it can send a <a href="messgs_58px.htm">LINE_LINEDEVSTATE</a> (LINEDEVSTATE_OUTOFSERVICE) message. It would then refuse (for example, by returning LINEERR_INVALLINESTATE) to perform any operation with the device until it returns to service or the provider is shut down and restarted (in which case the device could not be declared in <a href="func1_71kj.htm"><b>TSPI_providerEnumDevices</b></a>, effectively removing it from the system).</p>
<p>
For backward compatibility, older service providers are not expected to send this message. If they do, the message is treated in the same manner as described earlier for new service providers.</p>
<h4>See Also</h4>
<p>
<a href="messgs_58px.htm">LINE_LINEDEVSTATE</a>, <a href="func3_7q7o.htm"><b>LINEEVENT</b></a>, <a href="func2_9u0e.htm"><b>TSPI_lineOpen</b></a>, <a href="func1_0qhx.htm"><b>TSPI_providerCreateLineDevice</b></a>, <a href="func1_71kj.htm"><b>TSPI_providerEnumDevices</b></a>, <a href="func1_9pv8.htm"><b>TSPI_providerInit</b></a>, <a href="func1_2lke.htm"><b>TSPI_providerShutdown</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
