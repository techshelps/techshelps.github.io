<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_lineRedirect</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_lineredirect"></a>TSPI_lineRedirect</h1>
<p>
The <b>TSPI_lineRedirect</b> function redirects the specified offering call to the specified destination address.</p>
<pre><code><b>LONG TSPI_lineRedirect(
  DRV_REQUESTID</b><i> dwRequestID</i><b>,  </b>
<b>  HDRVCALL</b><i> hdCall</i><b>,          </b>
<b>  LPCWSTR</b><i> lpszDestAddress</i><b>,  </b>
<b>  DWORD</b><i> dwCountryCode       </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwRequestID</i></dt>
<dd>
The identifier of the asynchronous request.</dd>
<dt>
<i>hdCall</i></dt>
<dd>
The handle to the call to be redirected. The call state of <i>hdCall</i> can be <i>offering</i>.</dd>
<dt>
<i>lpszDestAddress</i></dt>
<dd>
A pointer to the destination address. This follows the standard link format.</dd>
<dt>
<i>dwCountryCode</i></dt>
<dd>
The country code of the party the call is redirected to. If a value of 0 is specified, a default is used by the implementation. This parameter is not validated by TAPI when this function is called.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns <i>dwRequestID</i>, or an error number if an error occurs. The <i>lResult</i> actual parameter of the corresponding <a href="func3_6ppq.htm"><b>ASYNC_COMPLETION</b></a> is zero if the function succeeds, or an error number if an error occurs. Possible return values are as follows: </p>
<p>
LINEERR_INVALCALLHANDLE, LINEERR_NOMEM, LINEERR_INVALCALLSTATE, LINEERR_OPERATIONUNAVAIL, LINEERR_INVALCOUNTRYCODE, LINEERR_OPERATIONFAILED, LINEERR_INVALADDRESS, LINEERR_RESOURCEUNAVAIL. </p>
<h4>Remarks</h4>
<p>
The service provider does not redirect the call if it returns LINEERR_INVALADDRESS.</p>
<p>
When this function is invoked, the service provider deflects the offering call to another address without first answering the call. Call redirect differs from call forwarding in that call forwarding is performed by the switch without the involvement of the called station; redirection can be done on a call-by-call basis by a client application, for example driven by caller ID information. It differs from call transfer in that transferring a call requires that the call first be answered.</p>
<p>
After a call is successfully redirected, the call typically transitions to <i>idle</i>. The service provider indicates the new state using a <a href="messgs_7gth.htm">LINE_CALLSTATE</a> message.</p>
<h4>See Also</h4>
<p>
<a href="func3_6ppq.htm"><b>ASYNC_COMPLETION</b></a>, <a href="messgs_7gth.htm">LINE_CALLSTATE</a>, <a href="func1_5rzo.htm"><b>TSPI_lineAccept</b></a>, <a href="func1_87u8.htm"><b>TSPI_lineDrop</b></a>, <a href="func2_5lo3.htm"><b>TSPI_lineGetDevCaps</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
