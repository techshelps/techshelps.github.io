<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PHONE_STATE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_phone_state"></a>PHONE_STATE</h1>
<p>
The PHONE_STATE message is sent to the <a href="func3_2x6c.htm"><b>PHONEEVENT</b></a> callback function to TAPI whenever a phone device's status changes.</p>
<pre><code>PHONE_STATE
htPhone = (HTAPIPHONE) hPhoneDevice;
dwMsg = (DWORD) PHONE_STATE;
dwParam1 = (DWORD) PhoneState;
dwParam2 = (DWORD) PhoneStateData;
dwParam3 = (DWORD) 0;
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>htPhone</i></dt>
<dd>
The TAPI opaque object handle to the phone device.</dd>
<dt>
<i>dwMsg</i></dt>
<dd>
The value PHONE_STATE.</dd>
<dt>
<i>dwParam1</i></dt>
<dd>
The phone state that has changed. This parameter uses the following PHONESTATE_ constants: 
<dl>
<dt>
PHONESTATE_OTHER </dt>
<dd>
A phone status information item other than those listed below has changed. </dd>
<dt>
PHONESTATE_CONNECTED </dt>
<dd>
The connection between the phone device and TAPI was just made. This happens when TAPI is first invoked, or when the wire connecting the phone to the computer is plugged in with TAPI active. </dd>
<dt>
PHONESTATE_DISCONNECTED </dt>
<dd>
The connection between the phone device and TAPI was just broken. This happens when the wire connecting the phone set to the computer is unplugged while TAPI is active. </dd>
<dt>
PHONESTATE_DISPLAY </dt>
<dd>
The display of the phone has changed. </dd>
<dt>
PHONESTATE_LAMP </dt>
<dd>
A lamp of the phone has changed. </dd>
<dt>
PHONESTATE_RINGMODE </dt>
<dd>
The ring mode of the phone has changed. </dd>
<dt>
PHONESTATE_RINGVOLUME </dt>
<dd>
The ring volume of the phone has changed. </dd>
<dt>
PHONESTATE_HANDSETHOOKSWITCH </dt>
<dd>
The handset hookswitch state has changed. </dd>
<dt>
PHONESTATE_HANDSETVOLUME </dt>
<dd>
The handset's speaker volume setting has changed. </dd>
<dt>
PHONESTATE_HANDSETGAIN </dt>
<dd>
The handset's mic gain setting has changed. </dd>
<dt>
PHONESTATE_SPEAKERHOOKSWITCH </dt>
<dd>
The speakerphone's hookswitch state has changed. </dd>
<dt>
PHONESTATE_SPEAKERVOLUME </dt>
<dd>
The speakerphone's speaker volume setting has changed. </dd>
<dt>
PHONESTATE_SPEAKERGAIN </dt>
<dd>
The speakerphone's mic gain setting state has changed. </dd>
<dt>
PHONESTATE_HEADSETHOOKSWITCH </dt>
<dd>
The headset's hookswitch state has changed. </dd>
<dt>
PHONESTATE_HEADSETVOLUME </dt>
<dd>
The headset's speaker volume setting has changed. </dd>
<dt>
PHONESTATE_HEADSETGAIN </dt>
<dd>
The headset's mic gain setting has changed. </dd>
<dt>
PHONESTATE_SUSPEND </dt>
<dd>
The application's use of the phone is temporarily suspended. </dd>
<dt>
PHONESTATE_RESUME </dt>
<dd>
The application's use of the phone device is resumed after having been suspended for some time. </dd>
<dt>
PHONESTATE_DEVSPECIFIC </dt>
<dd>
The phone's device-specific information has changed. </dd>
<dt>
PHONESTATE_REINIT </dt>
<dd>
Items have changed in the configuration of phone devices. To become aware of these changes (as with the appearance of new phone devices), the application should reinitialize its use of TAPI. If specified, the <i>htPhone</i> parameter is left NULL for this state change as it applies to any of the phones in the system. </dd>
<dt>
PHONESTATE_CAPSCHANGE </dt>
<dd>
Due to configuration changes made by the user or other circumstances, one or more of the members in the <a href="struc2_7ape.htm"><b>PHONECAPS</b></a> structure have changed. If a service provider sends a PHONE_STATE message containing this value to TAPI, TAPI passes it along to applications that have negotiated this or a later API version; applications negotiating an earlier API version receive PHONE_STATE messages specifying PHONESTATE_REINIT, requiring them to shutdown and reinitialize their connection to TAPI to obtain the updated information. </dd>
</dl>
</dd>
<dt>
<i>dwParam2</i></dt>
<dd>
Phone-state dependent information detailing the status change. This parameter is not used if multiple flags are set in <i>dwParam1</i>, because multiple status items have changed. TAPI should invoke <a href="func3_0v5f.htm"><b>TSPI_phoneGetStatus</b></a> to obtain a complete set of information. If <i>dwParam1</i> is PHONESTATE_LAMP, <i>dwParam2</i> contains the button/lamp identifier of the lamp that has changed. If <i>dwParam1</i> is PHONESTATE_RINGMODE, <i>dwParam2</i> contains the new ring mode. If <i>dwParam1</i> is PHONESTATE_HANDSETHOOKSWITCH, PHONESTATE_SPEAKERHOOKSWITCH or PHONESTATE_HEADSETHOOKSWITCH, <i>dwParam2</i> contains the new hookswitch mode of that hookswitch device, which can be set to any of the following PHONEHOOKSWITCHMODE_ constants: 
<dl>
<dt>
PHONEHOOKSWITCHMODE_ONHOOK </dt>
<dd>
The device's mic and speaker are both onhook. </dd>
<dt>
PHONEHOOKSWITCHMODE_MIC </dt>
<dd>
The device's mic is active, the speaker is mute. </dd>
<dt>
PHONEHOOKSWITCHMODE_SPEAKER </dt>
<dd>
The device's speaker is active, the mic is mute. </dd>
<dt>
PHONEHOOKSWITCHMODE_MICSPEAKER </dt>
<dd>
The device's mic and speaker are both active. </dd>
</dl>
</dd>
<dt>
<i>dwParam3</i></dt>
<dd>
Unused.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The sending of this message is controlled by <a href="func3_8zsj.htm"><b>TSPI_phoneSetStatusMessages</b></a>. By default, this message is disabled for all state changes.</p>
<p>
The service provider never reports changed values for PHONESTATE_OWNER or PHONESTATE_MONITORS, because the notion of privilege does not appear at the TSPI level.</p>
<p>
For backward compatibility, older service providers are not expected to generate this value in a PHONE_STATE message. If they do, the message is handled in the same manner as for newer service providers (as described earlier).</p>
<h4>See Also</h4>
<p>
<a href="func3_2x6c.htm"><b>PHONEEVENT</b></a>, <a href="cnstant_8hdg.htm">PHONEHOOKSWITCHMODE_ Constants</a>, <a href="cnstant_26ib.htm">PHONESTATE_ Constants</a>, <a href="func3_0v5f.htm"><b>TSPI_phoneGetStatus</b></a>, <a href="func3_8zsj.htm"><b>TSPI_phoneSetStatusMessages</b></a> </p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
