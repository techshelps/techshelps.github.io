<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Media Access</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_tspi_media_access"></a>Media Access</h2>
<p>
The <i>media</i> <i>mode</i> is the form in which data is transmitted on a line. The four main types of media mode are voice, speech, fax, and data. The <i>media stream</i> is the actual stream of information that travels on the line. Calls can be established independently of the media mode.</p>
<p>
The TSPI line and phone device classes only provide control operations for these devices. Access to media streams is not provided by the Win32 Telephony SPI. Applications must use other Win32 APIs, to provide this access or otherwise manage these media streams, such as the waveform API or the higher-level MCI interface.</p>
<p>
A TSPI function identifies the appropriate media device, such as a wave device, to open and use to generate and access the media stream. The service provider determines the relationship between the phone or line device and the media device. The service provider must provide the TSPI function that specifies the relationship between the phone or line device and the media device. The physical device supports line, phone, call and wave device classes.</p>
<p>
For line devices, the service provider receives a request to establish a connection to another station. After a call is established, the service provider receives a request for the media device associated with the call device. After information has been transmitted or received on the media device, the service provider receives a request to shut down the call.</p>
<p>
Each telephony device class has a corresponding media device class. The service provider reports media stream type changes when requested. This process is sometimes referred to as <i>call classification</i>. The mechanism used to determine the type of a media stream (such as voice, fax, data modem) is service-provider specific.</p>
<p>
A service provider can filter the media stream for energy or tones that characterize the media type. Alternatively, the service provider can determine the type by messages exchanged over the network, by use of distinctive ringing, or by knowledge about the caller or called ID.</p>
<p>&nbsp;</p></body>
</HTML>
