<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_lineDial</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_linedial"></a>TSPI_lineDial</h1>
<p>
The <b>TSPI_lineDial</b> function dials the specified dialable number on the specified call.</p>
<pre><code><b>LONG TSPI_lineDial(
  DRV_REQUESTID</b><i> dwRequestID</i><b>,  </b>
<b>  HDRVCALL</b><i> hdCall</i><b>,          </b>
<b>  LPCWSTR</b><i> lpszDestAddress</i><b>,  </b>
<b>  DWORD</b><i> dwCountryCode       </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwRequestID</i></dt>
<dd>
The identifier of the asynchronous request.</dd>
<dt>
<i>hdCall</i></dt>
<dd>
The service provider's handle to the call to be dialed. The call state of <i>hdCall</i> can be any state except <i>idle</i> and <i>disconnected</i>.</dd>
<dt>
<i>lpszDestAddress</i></dt>
<dd>
The destination to be dialed using the standard dialable number format.</dd>
<dt>
<i>dwCountryCode</i></dt>
<dd>
The country code of the destination. This is used by the implementation to select the call progress protocols for the destination address. If a value of 0 is specified, a default call-progress protocol defined by the service provider is used. This parameter is not validated by TAPI when this function is called.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns <i>dwRequestID</i> or an error number if an error occurs. The <i>lResult</i> actual parameter of the corresponding <a href="func3_6ppq.htm"><b>ASYNC_COMPLETION</b></a> is zero if the function succeeds or an error number if an error occurs. Possible return values are as follows: </p>
<p>
LINEERR_INVALCALLHANDLE, LINEERR_OPERATIONFAILED, LINEERR_INVALADDRESS, LINEERR_RESOURCEUNAVAIL, LINEERR_INVALCOUNTRYCODE, LINEERR_DIALBILLING, LINEERR_INVALCALLSTATE, LINEERR_DIALQUIET, LINEERR_ADDRESSBLOCKED, LINEERR_DIALDIALTONE, LINEERR_NOMEM, LINEERR_DIALPROMPT, LINEERR_OPERATIONUNAVAIL. </p>
<h4>Remarks</h4>
<p>
The service provider returns LINEERR_INVALCALLSTATE if the current state of the call does not allow dialing.</p>
<p>
The service provider carries out no dialing if it returns LINEERR_INVALADDRESS.</p>
<p>
If the service provider returns LINEERR_DIALBILLING, LINEERR_DIALQUIET, LINEERR_DIALDIALTONE, or LINEERR_DIALPROMPT, it should perform none of the actions otherwise performed by <b>TSPI_lineDial</b> (for example, no partial dialing, and no going offhook). This is because the service provider should pre-scan the number for unsupported characters first.</p>
<p>
<b>TSPI_lineDial</b> is used for dialing on an existing call appearance; for example, call handles returned from <a href="func2_0r8s.htm"><b>TSPI_lineMakeCall</b></a> with NULL as the <i>lpszDestAddress</i> or ending in ';', call handles returned from <a href="func3_7u42.htm"><b>TSPI_lineSetupTransfer</b></a> or <a href="func3_84h1.htm"><b>TSPI_lineSetupConference</b></a>. <b>TSPI_lineDial</b> can be invoked multiple times in the course of dialing in the case of multistage dialing, if the line's device capabilities permit it.</p>
<p>
If the string pointed to by the <i>lpszDestAddress</i> parameter in the previous call to the <b>TSPI_lineMakeCall</b> or <b>TSPI_lineDial</b> function is terminated with a semicolon, an empty string in the current call to <b>TSPI_lineDial</b> indicates that dialing is complete.</p>
<p>
Multiple addresses can be provided in a single dial string separated by CRLF. Service providers that provide inverse multiplexing can establish individual physical calls with each of the addresses, and return a single call handle to the aggregate of all calls to the application. All addresses would use the same country code.</p>
<p>
Dialing is considered complete after the address has been accepted by the service provider, not after the call is finally connected. Service providers that provide inverse multiplexing may allow multiple addresses to be provided at once. The service provider must send <a href="messgs_7gth.htm">LINE_CALLSTATE</a> messages to TAPI to inform it about the progress of the call.</p>
<h4>See Also</h4>
<p>
<a href="func3_6ppq.htm"><b>ASYNC_COMPLETION</b></a>, <a href="messgs_7gth.htm">LINE_CALLSTATE</a>, <a href="func2_0r8s.htm"><b>TSPI_lineMakeCall</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
