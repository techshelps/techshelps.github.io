<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TUISPI_providerInstall</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tuispi_providerinstall"></a>TUISPI_providerInstall</h1>
<p>
Implementation of the <b>TUISPI_providerInstall</b> function is the service provider's opportunity to install any additional "pieces" of the provider into the right directories (or at least verifying that they're there) and set up registry entries the provider needs. This function makes the <a href="func1_0f3g.htm"><b>TSPI_providerInstall</b></a> function obsolete in version 2.0 and later (supported in version 1.4 and earlier). </p>
<p>
If the service provider requires any privately-defined entries in the registry for proper operation, they must be installed at this time. </p>
<p>
Implementation is optional. </p>
<pre><code><b>LONG TSPIAPI TUISPI_providerInstall(
  TUISPIDLLCALLBACK</b><i> lpfnUIDLLCallback</i><b>,  </b>
<b>  HWND</b><i> hwndOwner</i><b>,                       </b>
<b>  DWORD</b><i> dwPermanentProviderID           </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>lpfnUIDLLCallback</i></dt>
<dd>
Pointer to a function the UI DLL can call to communicate with the service provider DLL to obtain information needed to display the dialog box.</dd>
<dt>
<i>hwndOwner</i></dt>
<dd>
The handle of the parent window in which the function can create any dialog box windows that are required during installation.</dd>
<dt>
<i>dwPermanentProviderID</i></dt>
<dd>
The service provider's permanent provider identifier.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the function succeeds or an error number if an error occurs. Possible return values are as follows: </p>
<p>
LINEERR_OPERATIONFAILED, LINEERR_INIFILECORRUPT, LINEERR_NOMEM. LINEERR_INVALPARAM. </p>
<h4>Remarks</h4>
<p>
This function must leave the system in a consistent state. It should run to completion, not allowing the user to abort the installation when it is partly completed. If installation fails, it is the provider's responsibility to "back out" what was done and return an error. This may imply pre-scanning to verify that a complete installation is possible, before the installation begins.</p>
<p>
This function can be invoked more than once during installation of the service provider, until there is a call to <a href="func3_7ffp.htm"><b>TUISPI_providerRemove</b></a>. If the service provider does not require or support multiple instances of the provider, however, it returns the <a href="cnstant_0sfn.htm">LINEERR_ Constants</a> LINEERR_NOMULTIPLEINSTANCE. </p>
<p>
The corresponding function at the TAPI level is <a href="../tapi21/func1_8lgy.htm"><b>lineAddProvider</b></a>. The <a href="messgs_9kkl.htm">LINE_CREATE</a> message informs applications that are running about dynamic reconfiguration.</p>
<h4>See Also</h4>
<p>
<a href="messgs_9kkl.htm">LINE_CREATE</a>, <a href="messgs_797p.htm">PHONE_STATE</a>, <a href="func3_7z1j.htm"><b>TUISPI_providerConfig</b></a>, <a href="func1_9pv8.htm"><b>TSPI_providerInit</b></a>, <a href="func3_7ffp.htm"><b>TUISPI_providerRemove</b></a>, <a href="func1_2lke.htm"><b>TSPI_providerShutdown</b></a></p>
<p>&nbsp;</p></body>
</HTML>
