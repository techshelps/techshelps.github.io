<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_lineConfigDialog</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_lineconfigdialog"></a>TSPI_lineConfigDialog</h1>
<p>
The <b>TSPI_lineConfigDialog</b> function is obsolete. TAPI version 1.4 or earlier service providers can implement this TSPI function. TAPI version 2.0 or later TSPs implement <a href="func3_8wx3.htm"><b>TUISPI_lineConfigDialog</b></a>. </p>
<p>
The <b>TSPI_lineConfigDialog</b> function causes the provider of the specified line device to display a modal dialog box as a child window of <i>hwndOwner</i> to allow the user to configure parameters related to the line device.</p>
<pre><code><b>LONG TSPI_lineConfigDialog(
  DWORD</b><i> dwDeviceID</i><b>,        </b>
<b>  HWND</b><i> hwndOwner</i><b>,          </b>
<b>  LPCWSTR</b><i> lpszDeviceClass  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwDeviceID</i></dt>
<dd>
The line device to be configured.</dd>
<dt>
<i>hwndOwner</i></dt>
<dd>
A handle to a parent window in which the dialog box window is to be placed.</dd>
<dt>
<i>lpszDeviceClass</i></dt>
<dd>
A pointer to a NULL-terminated string that identifies a device class name. This device class allows the caller to select a specific subscreen of configuration information applicable to that device class. If this parameter is NULL or an empty string, the highest level configuration dialog box should be selected. The permitted strings are the same as for <a href="func2_23vo.htm"><b>TSPI_lineGetID</b></a>. For example, if the line supports the Comm API, passing comm/datamodem as <i>lpszDeviceClass</i> causes the provider to display the parameters related specifically to Comm (or, at least, to start at the corresponding point in a multilevel configuration dialog box chain, so that the user doesn't have to search to find the desired parameters.)
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the function succeeds or an error number if an error occurs. Possible return values are as follows: </p>
<p>
LINEERR_INUSE, LINEERR_OPERATIONUNAVAIL, LINEERR_INVALDEVICECLASS, LINEERR_OPERATIONFAILED, LINEERR_NOMEM, LINEERR_RESOURCEUNAVAIL. </p>
<h4>Remarks</h4>
<p>
The procedure must update the [Windows Telephony] section in the win.ini file and broadcast the WM_WININICHANGE message if it makes any changes to the telephon.ini file that would cause a change in the line or address capabilities reported in <a href="struc2_0j1u.htm"><b>LINEDEVCAPS</b></a> or <a href="struc1_54du.htm"><b>LINEADDRESSCAPS</b></a>, or if a line device is created or removed.</p>
<p>
There is no restriction that this function (<b>TSPI_lineConfigDialog</b>) be called only when the line is closed. However, each provider can impose such a restriction itself. When <b>TSPI_lineConfigDialog</b> is called, the provider could alert the user with the message "The line is in use by one or more applications. You may not change the line configuration while the line is in use" (and return the error message LINEERR_INUSE). However, some configuration may be safe to change "on the fly," particularly those related to media modes (such as the modem error control protocol), especially when that media mode is not currently in use. The provider could allow those options to be changed while the line is open.</p>
<p>
Users should not be allowed to change anything that alters values returned with <a href="struc2_0j1u.htm"><b>LINEDEVCAPS</b></a> or <a href="struc1_54du.htm"><b>LINEADDRESSCAPS</b></a> without first forcibly closing the line as a signal that applications must call functions that return these structures in order to have accurate information.</p>
<h4>See Also</h4>
<p>
<a href="struc1_54du.htm"><b>LINEADDRESSCAPS</b></a>, <a href="struc2_0j1u.htm"><b>LINEDEVCAPS</b></a>, <a href="func2_7j53.htm"><b>TSPI_lineGetDevConfig</b></a>, <a href="func2_23vo.htm"><b>TSPI_lineGetID</b></a>, <a href="func2_7x2f.htm"><b>TSPI_lineSetDevConfig</b></a></p>
<p>&nbsp;</p></body>
</HTML>
