<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PHONE_CLOSE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_phone_close"></a>PHONE_CLOSE</h1>
<p>
The PHONE_CLOSE message is sent to the <a href="func3_2x6c.htm"><b>PHONEEVENT</b></a> callback function when an open phone device has been forcibly closed. The phone device handle is no longer valid once this message has been sent. The service provider guarantees that all asynchronous requests on the phone have been reported complete by calling <a href="func3_6ppq.htm"><b>ASYNC_COMPLETION</b></a> for each outstanding request before this message is sent. TAPI must not request any future operations using this phone handle.</p>
<pre><code>PHONE_CLOSE
htPhone = (HTAPIPHONE) hPhoneDevice;
dwMsg = (DWORD) PHONE_CLOSE;
dwParam1 = (DWORD) 0;
dwParam2 = (DWORD) 0;
dwParam3 = (DWORD) 0;
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>htPhone</i></dt>
<dd>
The TAPI opaque object handle to the phone device.</dd>
<dt>
<i>dwMsg</i></dt>
<dd>
The value PHONE_CLOSE.</dd>
<dt>
<i>dwParam1</i></dt>
<dd>
Unused.</dd>
<dt>
<i>dwParam2</i></dt>
<dd>
Unused.</dd>
<dt>
<i>dwParam3</i></dt>
<dd>
Unused.
</dd>
</dl>
<h4>Remarks</h4>
<p>
This message is only sent to TAPI after an open phone has been forcibly closed. This can be done, for example, when taking the phone out of service or reconfiguring the service provider. Whether or not the phone can be reopened immediately after a forced close is up to the service provider.</p>
<p>
An open phone device can be forcibly closed after the user has modified the configuration of that phone or its driver. If the user wants the configuration changes to be effective immediately (instead of after the next system restart), and they affect the application's current view of the device (such as a change in device capabilities), a service provider can forcibly close the phone device.</p>
<h4>See Also</h4>
<p>
<a href="func3_6ppq.htm"><b>ASYNC_COMPLETION</b></a>, <a href="func3_2x6c.htm"><b>PHONEEVENT</b></a>, <a href="func3_9z8l.htm"><b>TSPI_phoneClose</b></a></p>
<p>&nbsp;</p></body>
</HTML>
