<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_lineOpen</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_lineopen"></a>TSPI_lineOpen</h1>
<p>
The <b>TSPI_lineOpen</b> function opens the line device whose device identifier is given, returning the service provider's handle for the device. The service provider must retain the TAPI handle for the device for use in subsequent calls to the <a href="func3_7q7o.htm"><b>LINEEVENT</b></a> callback procedure.</p>
<pre><code><b>LONG TSPI_lineOpen(
  DWORD</b><i> dwDeviceID</i><b>,     </b>
<b>  HTAPILINE</b><i> htLine</i><b>,     </b>
<b>  LPHDRVLINE</b><i> lphdLine</i><b>,  </b>
<b>  DWORD</b><i> dwTSPIVersion</i><b>,  </b>
<b>  LINEEVENT</b><i> lpfnEventProc  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwDeviceID</i></dt>
<dd>
Identifies the line device to be opened.</dd>
<dt>
<i>htLine</i></dt>
<dd>
The TAPI handle for the line device to be used in subsequent calls to the <a href="func3_7q7o.htm"><b>LINEEVENT</b></a> callback procedure to identify the device.</dd>
<dt>
<i>lphdLine</i></dt>
<dd>
A pointer to an <a href="datype_7t2d.htm">HDRVLINE</a> where the service provider fills in its handle for the line device.</dd>
<dt>
<i>dwTSPIVersion</i></dt>
<dd>
The TSPI version.</dd>
<dt>
<i>lpfnEventProc</i></dt>
<dd>
A pointer to the <b>LINEEVENT</b> callback procedure supplied by TAPI that the service provider calls to report subsequent events on the line.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the function succeeds, or an error number if an error occurs. Possible return values are as follows: </p>
<p>
LINEERR_ALLOCATED, LINEERR_OPERATIONUNAVAIL, LINEERR_NODRIVER, LINEERR_OPERATIONFAILED, LINEERR_NOMEM, LINEERR_RESOURCEUNAVAIL. </p>
<h4>Remarks</h4>
<p>
The service provider should reserve any non-sharable resources that are required to manage the line. However, any actions that can be postponed to <b>lineMakeCall</b> should be. It is a design assumption in TAPI that <b>lineOpen</b> is an "inexpensive" operation. For example, if the line is opened in monitor mode only, it should not be necessary for a COMM-port-based service provider to open the COMM port.</p>
<p>
This procedure does not correspond directly to any procedure at the TAPI level, at which the functions of enabling device-specific extensions, selecting line characteristics, and setting media mode detection are included in the functionality defined by <b>lineOpen</b>. At the TSPI level, these additional capabilities are separated out into <b>TSPI_lineNegotiateExtVersion</b>, <b>TSPI_lineSetDefaultMediaDetection</b> and <b>TSPI_lineConditionalMediaDetection</b>.</p>
<h4>See Also</h4>
<p>
<a href="messgs_7nhh.htm">LINE_CLOSE</a>,<b> <a href="func3_7q7o.htm">LINEEVENT</a></b>, <a href="func1_2mxx.htm"><b>TSPI_lineClose</b></a>, <a href="func1_6tri.htm"><b>TSPI_lineConditionalMediaDetection</b></a>, <a href="func2_95im.htm"><b>TSPI_lineNegotiateExtVersion</b></a>, <a href="func2_7fvy.htm"><b>TSPI_lineNegotiateTSPIVersion</b></a>, <a href="func2_2z3i.htm"><b>TSPI_lineSetDefaultMediaDetection</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
