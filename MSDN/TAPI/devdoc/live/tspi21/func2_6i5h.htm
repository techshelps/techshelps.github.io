<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_lineSetMediaMode</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_linesetmediamode"></a>TSPI_lineSetMediaMode</h1>
<p>
The <b>TSPI_lineSetMediaMode</b> function changes the call's media as stored in the call's <a href="struc1_1ks2.htm"><b>LINECALLINFO</b></a> structure.</p>
<pre><code><b>LONG TSPI_lineSetMediaMode(
  HDRVCALL</b><i> hdCall</i><b>,  </b>
<b>  DWORD</b><i> dwMediaMode </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hdCall</i></dt>
<dd>
The handle to the call undergoing a change in media mode. The call state of <i>hdCall</i> can be any state.</dd>
<dt>
<i>dwMediaMode</i></dt>
<dd>
The new media mode(s) for the call. As long as the LINEMEDIAMODE_UNKNOWN media mode flag is set, multiple other media mode flags can be set as well. This is used to identify a call's media mode as not fully determined, but narrowed down to one of just a small set of specified media modes. If the LINEMEDIAMODE_UNKNOWN flag is not set, only a single media mode can be specified. LINEMEDIAMODE_ constant values are: 
<dl>
<dt>
LINEMEDIAMODE_UNKNOWN </dt>
<dd>
The anticipated media type is not fully classified. </dd>
<dt>
LINEMEDIAMODE_INTERACTIVEVOICE </dt>
<dd>
The anticipated media type is interactive voice media mode, namely live conversations. </dd>
<dt>
LINEMEDIAMODE_AUTOMATEDVOICE </dt>
<dd>
TAPI can handle calls in which there is voice data, but the voice is handled by an automated application. Most service providers cannot distinguish between automated and interactive voice. In such a case any request for voice or detection of voice is treated as interactive voice. </dd>
<dt>
LINEMEDIAMODE_DATAMODEM </dt>
<dd>
The anticipated media type is data modem media mode. </dd>
<dt>
LINEMEDIAMODE_G3FAX </dt>
<dd>
The anticipated media type is group 3 fax media mode. </dd>
<dt>
LINEMEDIAMODE_TDD </dt>
<dd>
The anticipated media type is TDD (Telephony Devices for the Deaf) media mode. </dd>
<dt>
LINEMEDIAMODE_G4FAX </dt>
<dd>
The anticipated media type is group 4 fax media mode. </dd>
<dt>
LINEMEDIAMODE_DIGITALDATA </dt>
<dd>
The anticipated media type is digital data calls. </dd>
<dt>
LINEMEDIAMODE_TELETEX </dt>
<dd>
The anticipated media type is teletex media mode. </dd>
<dt>
LINEMEDIAMODE_VIDEOTEX </dt>
<dd>
The anticipated media type is videotex media mode. </dd>
<dt>
LINEMEDIAMODE_TELEX </dt>
<dd>
The anticipated media type is telex media mode. </dd>
<dt>
LINEMEDIAMODE_MIXED </dt>
<dd>
The anticipated media type is ISDN mixed media mode. </dd>
<dt>
LINEMEDIAMODE_ADSI </dt>
<dd>
The anticipated media type is ADSI (Analog Display Services Interface) media mode. </dd>
<dt>
LINEMEDIAMODE_VOICEVIEW </dt>
<dd>
The media mode of the call is VoiceView. 
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the function succeeds, or an error number if an error occurs. Possible return values are as follows: </p>
<p>
LINEERR_INVALCALLHANDLE, LINEERR_OPERATIONUNAVAIL, LINEERR_INVALMEDIAMODE, LINEERR_OPERATIONFAILED, LINEERR_NOMEM, LINEERR_RESOURCEUNAVAIL. </p>
<h4>Remarks</h4>
<p>
Other than changing the call's media as stored in the call's <a href="struc1_1ks2.htm"><b>LINECALLINFO</b></a> structure, this procedure is simply advisory in the sense that it indicates an expected media change that is about to occur, rather than forcing a specific change to the call. Typical usage is to set a call's media mode to a specific known media mode, or to exclude possible media modes as long as the call's media mode is not fully known (the UNKNOWN media mode flag is set).</p>
<p>
TAPI makes the following guarantees regarding the passed media mode: (1) there is at least one bit set, (2) there are no reserved bits set, and (3) if more than one bit is set, "Unknown" is also set. The service provider must perform any further validity checks on the media modes, such as checking whether any media modes are indeed supported by the service provider.</p>
<h4>See Also</h4>
<p>
<a href="struc1_1ks2.htm"><b>LINECALLINFO</b></a>,<b> </b><a href="cnstant_4cxf.htm">LINEMEDIAMODE_ Constants</a>, <a href="func1_1shb.htm"><b>TSPI_lineGetCallInfo</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
