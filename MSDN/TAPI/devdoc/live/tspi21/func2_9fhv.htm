<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_lineSetStatusMessages</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_linesetstatusmessages"></a>TSPI_lineSetStatusMessages</h1>
<p>
The <b>TSPI_lineSetStatusMessages</b> function enables TAPI to specify which notification messages the service provider should generate for events related to status changes for the specified line or any of its addresses.</p>
<pre><code><b>LONG TSPI_lineSetStatusMessages(
  HDRVLINE</b><i> hdLine</i><b>,    </b>
<b>  DWORD</b><i> dwLineStates  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hdLine</i></dt>
<dd>
The handle to the line device for which the new filter is to be set.</dd>
<dt>
<i>dwLineStates</i></dt>
<dd>
A bit array that identifies for which line device status changes a message is to be sent to TAPI. This parameter uses the following LINEDEVSTATE_. constants: 
<dl>
<dt>
LINEDEVSTATE_OTHER </dt>
<dd>
Device-status items other than those listed below have changed. </dd>
<dt>
LINEDEVSTATE_RINGING </dt>
<dd>
The switch tells the line to alert the user. This should be sent repeatedly in a <a href="messgs_58px.htm">LINE_LINEDEVSTATE</a> message, once for each ring cycle. On a POTS device, the service provider can send the message whenever the central office sends ring voltage. On digital devices such as ISDN, the service provider may need to synthesize the repetition of the message if the switch generates only one ring request. Each repetition of the message should show the ring count increasing, so that toll save functions work properly. </dd>
<dt>
LINEDEVSTATE_CONNECTED </dt>
<dd>
The line was previously disconnected and is now connected to the service provider. </dd>
<dt>
LINEDEVSTATE_DISCONNECTED </dt>
<dd>
This line was previously connected and is now disconnected from the service provider. </dd>
<dt>
LINEDEVSTATE_MSGWAITON </dt>
<dd>
The "message waiting" indicator is turned on. </dd>
<dt>
LINEDEVSTATE_MSGWAITOFF </dt>
<dd>
The "message waiting" indicator is turned off. </dd>
<dt>
LINEDEVSTATE_INSERVICE </dt>
<dd>
The line is connected to the service provider. This happens when the service provider is first activated, or when the line wire is physically plugged in and in service at the switch while the service provider is active. </dd>
<dt>
LINEDEVSTATE_OUTOFSERVICE </dt>
<dd>
The line is out of service at the switch or is physically disconnected. The API cannot be used to operate on the line device. </dd>
<dt>
LINEDEVSTATE_MAINTENANCE </dt>
<dd>
Maintenance is being performed on the line at the switch. The service provider cannot be used to operate on the line device. </dd>
<dt>
LINEDEVSTATE_NUMCALLS </dt>
<dd>
The number of calls on the line device has changed. </dd>
<dt>
LINEDEVSTATE_NUMCOMPLETIONS </dt>
<dd>
The number of outstanding call completions on the line device has changed. </dd>
<dt>
LINEDEVSTATE_TERMINALS </dt>
<dd>
The terminal settings have changed. </dd>
<dt>
LINEDEVSTATE_ROAMMODE </dt>
<dd>
The roaming mode of the line device has changed. </dd>
<dt>
LINEDEVSTATE_BATTERY </dt>
<dd>
The battery level has changed significantly (cellular). </dd>
<dt>
LINEDEVSTATE_SIGNAL </dt>
<dd>
The signal level has changed significantly (cellular). </dd>
<dt>
LINEDEVSTATE_DEVSPECIFIC </dt>
<dd>
The line's device-specific information has changed. </dd>
<dt>
LINEDEVSTATE_REINIT </dt>
<dd>
Items have changed in the configuration of line devices. To become aware of these changes (as with the appearance of new line devices) TAPI notifies all its client applications to reinitialize their use of the API. A service provider should initiate such a sequence only in extreme cases that cannot be handled through the normal configuration-change notification mechanism described in the Overview section. The LINEDEVSTATE_REINIT message is never masked. REINIT messages should always be sent when appropriate, regardless of the setting of this flag. The setting of the REINIT flag is simply ignored and generates no error. </dd>
<dt>
LINEDEVSTATE_LOCK </dt>
<dd>
The locked status of the line device has changed. </dd>
<dt>
LINEDEVSTATE_REMOVED </dt>
<dd>
The device is being removed from the system by the service provider (most likely through user action, through a control panel or similar utility). A <a href="messgs_58px.htm">LINE_LINEDEVSTATE</a> message with this value is normally immediately followed by a <a href="messgs_7nhh.htm">LINE_CLOSE</a> message on the device. Subsequent attempts to access the device prior to TAPI being reinitialized result in LINEERR_NODEVICE being returned to the application. If a service provider sends a LINE_LINEDEVSTATE message containing this value to TAPI, TAPI passes it along to applications that have negotiated this or a subsequent API version; applications negotiating a previous API version do not receive any notification. </dd>
</dl>
</dd>
<dt>
<b>DWORD</b> <i>dwAddressStates</i></dt>
<dd>
A bit array that identifies for which address status changes a message is to be sent to TAPI. This parameter uses the following LINEADDRESSSTATE_ constants: 
<dl>
<dt>
LINEADDRESSSTATE_OTHER </dt>
<dd>
Address-status items other than those listed below have changed. </dd>
<dt>
LINEADDRESSSTATE_DEVSPECIFIC </dt>
<dd>
The device-specific item of the address status has changed. </dd>
<dt>
LINEADDRESSSTATE_INUSEZERO </dt>
<dd>
The address has changed to idle (it is now in use by zero stations). </dd>
<dt>
LINEADDRESSSTATE_INUSEONE </dt>
<dd>
The address has changed from being idle or from being in use by many bridged stations to being in use by just one station. </dd>
<dt>
LINEADDRESSSTATE_INUSEMANY </dt>
<dd>
The monitored or bridged address has changed to being in use by one station to being used by more than one station. </dd>
<dt>
LINEADDRESSSTATE_NUMCALLS </dt>
<dd>
The number of calls on the address has changed, as a result of an event such as a new inbound call, an outbound call on the address, or a call changing its hold status. </dd>
<dt>
LINEADDRESSSTATE_FORWARD </dt>
<dd>
The forwarding status of the address has changed including the number of rings for determining a no-answer condition. TAPI checks the address status to determine details about the address's current forwarding status. </dd>
<dt>
LINEADDRESSSTATE_TERMINALS </dt>
<dd>
The terminal settings for the address have changed. 
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the function succeeds, or an error number if an error occurs. Possible return values are as follows: </p>
<p>
LINEERR_INVALADDRESSSTATE, LINEERR_OPERATIONUNAVAIL, LINEERR_INVALLINEHANDLE, LINEERR_OPERATIONFAILED, LINEERR_INVALLINESTATE, LINEERR_RESOURCEUNAVAIL, LINEERR_NOMEM. </p>
<h4>Remarks</h4>
<p>
The service provider returns LINEERR_INVALLINESTATE if the <i>dwLineStates</i> parameter contains one or more bits that are not LINEDEVSTATE_ constants.</p>
<p>
Win32 Telephony defines a number of messages that notify applications about events occurring on lines and addresses. The sets of all change messages in which all applications are interested can be much smaller than the set of possible messages. This procedure allows TAPI to tell the service provider the reduced set of messages to deliver. The service provider delivers all of the messages it supports, within the specified set. It is permitted to deliver more (they are filtered out by TAPI), but is discouraged from doing so for performance reasons. If TAPI requests delivery of a particular message type that is not produced by the provider, the provider nevertheless accepts the request but simply does not produce the message. By default, address and line status reporting is initially disabled for a line.</p>
<p>
This function differs from the corresponding TAPI function as follows: (1) The set of messages requested is the union of all sets requested by applications at the TAPI level. (2) The message set is neither reduced nor augmented by ownership (because there is no concept of ownership at the TSPI level) (3) The set is advisory in the sense that the service provider is required to forward at least the indicated set of messages but is permitted to forward a larger set.</p>
<p>
Device state changes regarding Open and Close are not reported, because at the TSPI level there is only one outstanding Open at a time.</p>
<h4>See Also</h4>
<p>
<a href="messgs_53s5.htm">LINE_ADDRESSSTATE</a>, <a href="messgs_7nhh.htm">LINE_CLOSE</a>, <a href="messgs_58px.htm">LINE_LINEDEVSTATE</a>, <a href="cnstant_0mer.htm">LINEADDRESSSTATE_ Constants</a>, <a href="cnstant_9d2r.htm">LINEDEVSTATE_ Constants</a><b> </b></p>
<p>&nbsp;</p></body>
</HTML>
