<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_providerInit</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_providerinit"></a>TSPI_providerInit</h1>
<p>
The <b>TSPI_providerInit</b> function initializes the service provider and gives it parameters required for subsequent operation.</p>
<pre><code><b>LONG TSPI_providerInit(
  DWORD</b><i> dwTSPIVersion</i><b>,                  </b>
<b>  DWORD</b><i> dwPermanentProviderID</i><b>,          </b>
<b>  DWORD</b><i> dwLineDeviceIDBase</i><b>,             </b>
<b>  DWORD</b><i> dwPhoneDeviceIDBase</i><b>,            </b>
<b>  DWORD</b><i> dwNumLines</i><b>,                     </b>
<b>  DWORD</b><i> dwNumPhones</i><b>,                    </b>
<b>  ASYNC_COMPLETION</b><i> lpfnCompletionProc</i><b>,  </b>
<b>  LPDWORD</b><i> lpdwTSPIOptions               </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwTSPIVersion</i></dt>
<dd>
The version of the TSPI definition under which this function must operate. The caller can use <a href="func2_7fvy.htm"><b>TSPI_lineNegotiateTSPIVersion</b></a> with the special <i>dwDeviceID</i> <a href="datype_8aem.htm">INITIALIZE_NEGOTIATION</a> to negotiate a version that is guaranteed to be acceptible to the service provider.</dd>
<dt>
<i>dwPermanentProviderID</i></dt>
<dd>
The permanent identifier, unique within the service providers on this system, of the service provider being initialized.</dd>
<dt>
<i>dwLineDeviceIDBase</i></dt>
<dd>
The lowest device identifier for the line devices supported by this service provider.</dd>
<dt>
<i>dwPhoneDeviceIDBase</i></dt>
<dd>
The lowest device identifier for the phone devices supported by this service provider.</dd>
<dt>
<i>dwNumLines</i></dt>
<dd>
The number of line devices this service provider supports. The value returned is the number of line devices reported in <b>TSPI_providerEnumDevices</b>.</dd>
<dt>
<i>dwNumPhones</i></dt>
<dd>
The number of phone devices this service provider supports. The value returned is the number of phone devices reported in <b>TSPI_providerEnumDevices</b>.</dd>
<dt>
<i>lpfnCompletionProc</i></dt>
<dd>
The procedure the service provider calls to report completion of all asynchronously operating procedures on line and phone devices.</dd>
<dt>
<i>lpdwTSPIOptions</i></dt>
<dd>
A pointer to a <b>DWORD</b>-sized memory location, into which the service provider can write a value specifying LINETSPIOPTIONS_ values. This parameter allows the service provider to return bits indicating optional behaviors desired of TAPI. TAPI sets the options <b>DWORD</b> to 0 before calling <b>TSPI_providerInit</b>, so if the service provider doesn't want any of these options, it can just leave the <b>DWORD</b> set to 0.
<p>
At this time, only one bit is defined to be returned through this pointer: LINETSPIOPTION_NONREENTRANT. The service provider sets this bit if it is not designed for fully pre-emptive, multithreaded, multitasking, multiprocessor operation (for example, updating of global data protected by mutexes). When this bit is set, TAPI only makes one call at a time to the service provider; it does not call any other entry point, nor that entry point again, until the service provider returns from the original function call. Without this bit set, TAPI may call into multiple service provider entry points, including multiple times to the same entry point, simultaneously (<i>actually</i> simultaneously in a multiprocessor system). 

<p>
<b>Important Note</b> It must be emphasized that setting this bit degrades performance. It is <i>strongly recommended </i>that this be used only for development but not a shipped production service provider.

<p>
TAPI does not serialize access to TSPI functions that display a dialog box (<a href="func3_8wx3.htm"><b>TUISPI_lineConfigDialog</b></a>, <a href="func3_1pkk.htm"><b>TUISPI_lineConfigDialogEdit</b></a>, <a href="func3_7yjr.htm"><b>TUISPI_phoneConfigDialog</b></a>, <a href="func3_7z1j.htm"><b>TUISPI_providerConfig</b></a>, <a href="func3_3hm4.htm"><b>TUISPI_providerInstall</b></a>, <a href="func3_7ffp.htm"><b>TUISPI_providerRemove</b></a>) so that they do not block other TSPI functions from being called; the service provider <i>must</i> include internal protection on these functions.

</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the function succeeds or an error number if an error occurs. Possible return values are as follows: </p>
<p>
LINEERR_INCOMPATIBLEAPIVERSION, LINEERR_OPERATIONFAILED, LINEERR_NOMEM, LINEERR_RESOURCEUNAVAIL, LINEERR_INIFILECORRUPT, LINEERR_NOMULTIPLEINSTANCE. </p>
<h4>Remarks</h4>
<p>
This function is guaranteed to be called before any of the other functions prefixed with <b>TSPI_line</b> or <b>TSPI_phone</b> except <a href="func2_7fvy.htm"><b>TSPI_lineNegotiateTSPIVersion</b></a>. It is strictly paired with a subsequent call to <a href="func1_2lke.htm"><b>TSPI_providerShutdown</b></a> These pairs may overlap, for example, when the Telephony Control Panel utility supplied with Windows Telephony in versions 1.4 and earlier is used while telephony operations are in progress. The call to this function must be ignored (returning success) if there is already an outstanding pair.</p>
<p>
A service provider should perform as many consistency checks as is practical at the time. <b>TSPI_providerInit</b> is called to ensure that it is ready to run. Some consistency or installation errors, however, cannot be detected until the operation is attempted. The error LINEERR_NODRIVER can be used to report such nonspecific errors at the time they are detected.</p>
<p>
There is no directly corresponding function at the TAPI level. At that level, multiple different usage instances can be outstanding, with an "application handle" returned to identify the instance in subsequent operations. At TSPI level, the interface architecture supports only a single usage instance for each distinct service provider.</p>
<h4>See Also</h4>
<p>
<a href="func2_7fvy.htm"><b>TSPI_lineNegotiateTSPIVersion</b></a>, <a href="func1_2lke.htm"><b>TSPI_providerShutdown</b></a>, <a href="func3_8wx3.htm"><b>TUISPI_lineConfigDialog</b></a>, <a href="func3_1pkk.htm"><b>TUISPI_lineConfigDialogEdit</b></a>, <a href="func3_7yjr.htm"><b>TUISPI_phoneConfigDialog</b></a>, <a href="func3_7z1j.htm"><b>TUISPI_providerConfig</b></a>, <a href="func3_3hm4.htm"><b>TUISPI_providerInstall</b></a>, <a href="func3_7ffp.htm"><b>TUISPI_providerRemove</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
