<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_lineGetAddressID</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_linegetaddressid"></a>TSPI_lineGetAddressID</h1>
<p>
The <b>TSPI_lineGetAddressID</b> function returns the address identifier associated with address in a different format on the specified line.</p>
<pre><code><b>LONG TSPI_lineGetAddressID(
  HDRVLINE</b><i> hdLine</i><b>,        </b>
<b>  LPDWORD</b><i> lpdwAddressID</i><b>,  </b>
<b>  DWORD</b><i> dwAddressMode</i><b>,    </b>
<b>  LPCWSTR</b><i> lpsAddress</i><b>,     </b>
<b>  DWORD</b><i> dwSize            </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hdLine</i></dt>
<dd>
The service provider's handle to the line whose address is to be retrieved.</dd>
<dt>
<i>lpdwAddressID</i></dt>
<dd>
A pointer to a <b>DWORD</b>-sized memory location where the address identifier is returned.</dd>
<dt>
<i>dwAddressMode</i></dt>
<dd>
The address mode of the address contained in <i>lpsAddress</i>. The <i>dwAddressMode</i> parameter is allowed to have only the following LINEADDRESSMODE_ flag set: 
<dl>
<dt>
LINEADDRESSMODE_DIALABLEADDR </dt>
<dd>
The address is specified using its dialable address. <i>lpsAddress</i> is the dialable address format. </dd>
</dl>
</dd>
<dt>
<i>lpsAddress</i></dt>
<dd>
A pointer to a data structure holding the address assigned to the specified line device. The format of the address is determined by the <i>dwAddressMode</i> parameter. If it is LINEADDRESSMODE_DIALABLEADDR, the <i>lpsAddress</i> parameter uses the common dialable number format and is NULL terminated.</dd>
<dt>
<i>dwSize</i></dt>
<dd>
The size of the address contained in <i>lpsAddress</i>. The parameter <i>dwSize</i> must be set to the length of the string (plus one for the NULL) if LINEADDRESSMODE_DIALABLEADDR is used. If an extended LINEADDRESSMODE is used, the length should match the size of whatever is actually passed in (the DLL checks to be sure it can read the number of bytes specified from the given pointer).
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the function succeeds or an error number if an error occurs. Possible return values are as follows: </p>
<p>
LINEERR_INVALLINEHANDLE, LINEERR_OPERATIONUNAVAIL, LINEERR_INVALADDRESS, LINEERR_OPERATIONFAILED, LINEERR_NOMEM, LINEERR_RESOURCEUNAVAIL. </p>
<h4>Remarks</h4>
<p>
This function is used to map a phone number (address) assigned to a line device back to its <i>dwAddressID</i> (in the range from 0 through the number of addresses minus one) that is returned in the line's device capabilities.</p>
<h4>See Also</h4>
<p>
<a href="cnstant_5uyb.htm">LINEADDRESSMODE_ Constants</a></p>
<p>&nbsp;</p></body>
</HTML>
