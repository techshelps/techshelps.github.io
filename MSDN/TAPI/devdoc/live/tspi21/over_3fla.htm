<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Version Negotiation</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h4><a name="_tspi_version_negotiation"></a>Version Negotiation</h4>
<p>
To allow optimal interoperability of different versions of applications, versions of tapi32.dll itself, and versions of service providers by different vendors, TSPI provides a simple version negotiation mechanism for applications. There are two different versions that need to be agreed on by tapi32.dll and the service provider for each line device. The first is the version number for the Basic and Supplementary Telephony SPI, referred to as the <i>TSPI interface version</i>. The other is for provider-specific extensions, if any, and is referred to as the <i>extension version</i>. The format of the data structures and datatypes used by TSPI's Basic and Supplementary features is defined by the TSPI version, while the extension version determines the format of data structures defined by the vendor-specific extensions.</p>
<p>
These two types of version negotiation are handled by two different procedures: <a href="func2_7fvy.htm"><b>TSPI_lineNegotiateTSPIVersion</b></a> is used to negotiate the TSPI interface version, and <a href="func2_95im.htm"><b>TSPI_lineNegotiateExtVersion</b></a> is used to negotiate the extension version. Extension version negotiation can always be skipped if extensions are not wanted range of version numbers. If these ranges overlap, the service provider must return a value within the overlapping portion of the range as the result of the negotiation. Usually, this should be the highest possible value. If the ranges do not overlap, the two parties are incompatible and the function returns an error.</p>
<p>
Results of a negotiation simply indicate that the service provider is <i>willing</i> to operate at a particular version number, but do not commit the service provider to doing so. For example, tapi32.dll can renegotiate to determine an <i>ideal</i> version after having negotiated a <i>possible</i> version. The TSPI interface version is only committed when a line is opened using <a href="func2_9u0e.htm"><b>TSPI_lineOpen</b></a> and survives until the device is closed. The extension version is committed when the <a href="func2_4d9q.htm"><b>TSPI_lineSelectExtVersion</b></a> function is called, and survives until the selection is canceled by selecting extension version zero.</p>
<p>
Extension version selection can happen many times, including while an extension version is in effect. Because the service provider is committed to the extension version, its range of supported versions narrows to exactly that extension version. For example, consider a service provider that is normally compatible with extension versions 1.0 through 5.5. If version 3.0 is in effect while a caller attempts to negotiate a version within the range 1.0 to 5.5, the negotiation returns 3.0.</p>
<p>&nbsp;</p></body>
</HTML>
