<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LINE_CLOSE</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_line_close"></a>LINE_CLOSE</h1>
<p>
The LINE_CLOSE message is sent to the <a href="func3_7q7o.htm"><b>LINEEVENT</b></a> callback function by the service provider to request that TAPI close the specified line device. Once closed, the line device handle or any call handles for calls on the line are no longer valid. The service provider guarantees that all asynchronous requests on the line and all calls on the line have been reported complete by calling <a href="func3_6ppq.htm"><b>ASYNC_COMPLETION</b></a> for each outstanding request before this message is sent. TAPI must not request any future operations using this line handle or its associated call handles.</p>
<pre><code>LINE_CLOSE
htLine = (HTAPILINE) hLineDevice;
htCall = (HTAPICALL) 0;
dwMsg = (DWORD) LINE_CLOSE;
dwParam1 = (DWORD) 0;
dwParam2 = (DWORD) 0;
dwParam3 = (DWORD) 0;
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>htLine</i></dt>
<dd>
The TAPI opaque object handle to the line device.</dd>
<dt>
<i>htCall</i></dt>
<dd>
Unused.</dd>
<dt>
<i>dwMsg</i></dt>
<dd>
The value LINE_CLOSE.</dd>
<dt>
<i>dwParam1</i></dt>
<dd>
Unused.</dd>
<dt>
<i>dwParam2</i></dt>
<dd>
Unused.</dd>
<dt>
<i>dwParam3</i></dt>
<dd>
Unused.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The LINE_CLOSE message is a <i>request</i> from the service provider to TAPI to close the line. The service provider must not actually close the line until TAPI acknowledges the request by calling the <a href="func1_2mxx.htm"><b>TSPI_lineClose</b></a> function to direct the service provider to close the line. A service provider can send this message, for example, when taking the line out of service or reconfiguring the service provider. Whether or not the line can be reopened immediately after it is closed is up to the service provider.</p>
<p>
A service provider can also request that a line device be closed after the user has modified the configuration of that line or its driver. If the user wants the configuration changes to be effective immediately (as opposed to after the next system restart), and they affect the application's current view of the device (such as a change in device capabilities), a service provider can close the line device.</p>
<h4>See Also</h4>
<p>
<a href="func3_6ppq.htm"><b>ASYNC_COMPLETION</b></a>, <a href="func1_2mxx.htm"><b>TSPI_lineClose</b></a></p>
<p>&nbsp;</p></body>
</HTML>
