<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_lineGetIcon</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_linegeticon"></a>TSPI_lineGetIcon</h1>
<p>
The <b>TSPI_lineGetIcon</b> function retrieves a service line device-specific icon to display to the user.</p>
<pre><code><b>LONG TSPI_lineGetIcon(
  DWORD</b><i> dwDeviceID</i><b>,         </b>
<b>  LPCWSTR</b><i> lpszDeviceClass</i><b>,  </b>
<b>  LPHICON</b><i> lphIcon           </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwDeviceID</i></dt>
<dd>
The line device whose icon is requested.</dd>
<dt>
<i>lpszDeviceClass</i></dt>
<dd>
A pointer to a NULL-terminated string that identifies a device class name. This device class allows the caller to select an icon specific to that device class. This parameter is optional and can be left NULL, in which case the highest level icon associated with the line device rather than a specified media stream device is selected.
<p>
Permitted strings are the same as for <a href="func2_23vo.htm"><b>TSPI_lineGetID</b></a>. For example, if the line supports the Comm API, passing comm/datamodem as <i>lpszDeviceClass</i> causes the provider to return an icon related specifically to the Comm device functions of the service provider.
</dd>
<dt>
<i>lphIcon</i></dt>
<dd>
A pointer to a memory location in which the handle to the icon is returned.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the function succeeds, or an error number if an error occurs. Possible return values are as follows: </p>
<p>
LINEERR_INVALDEVICECLASS, LINEERR_OPERATIONFAILED, LINEERR_NOMEM, LINEERR_RESOURCEUNAVAIL, LINEERR_OPERATIONUNAVAIL. </p>
<h4>Remarks</h4>
<p>
The provider should return a handle (in the <b>DWORD</b> pointed to by <i>lphIcon</i>) to an icon resource (obtained from the Win32 <b>LoadIcon</b> function) associated with the specified line.</p>
<p>
A provider may choose to support many icons (selected by <i>lpszDeviceClass</i> and/or line number), a single icon (such as for the manufacturer, which would be returned for all <b>TSPI_lineGetIcon</b> requests regardless of the <i>lpszDeviceClass</i> selected), or no icons, in which case it sets the <b>DWORD</b> pointed to by <i>lphIcon</i> to NULL. TAPI examines the handle returned by the provider, and if the provider returns NULL, TAPI substitutes a generic Win32 Telephony icon (the generic "line" icon).</p>
<h4>See Also</h4>
<p>
<a href="func1_2fqf.htm"><b>TSPI_lineConfigDialog</b></a>, <a href="func2_23vo.htm"><b>TSPI_lineGetID</b></a></p>
<p>&nbsp;</p></body>
</HTML>
