<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Service Provider Features in TAPI Version 2.0</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_service_provider_features_in_tapi_version_2.0"></a>Service Provider Features in TAPI Version 2.0</h1>
<p>
To provide the best performance and support on the Windows NT and Windows 95 platforms, the Win32 Telephony service providers are fully implementated as 32-bit components in Win32. The following service provider features in TAPI version 2.0 are new:
<ul>
<li>
On the Windows NT platform, TAPI 2.0 service providers must be Win32; 16-bit service providers do not run on Windows NT.</li>
<li>
On the Windows 95 platform, TAPI 2.0 service providers should be Win32 but existing 16-bit Windows 3.1 and Windows 95 service providers are supported by a 16-bit compatibility layer.</li>
<li>
TAPI 2.0 service providers must support version 2.0; TAPI does not provide backward compatibility for service providers supporting only data structure formats for version 1.3 or 1.4.</li>
<li>
TAPI 2.0 imports service provider functions by name instead of by ordinal (as in previous versions).</li>
<li>
TAPI 2.0 service providers must be fully Unicode; all strings passed as parameters to TSPI functions or returned by service providers in structures or through pointers must be in Unicode.</li>
<li>
TAPI 2.0 service providers run in user mode. Kernel mode components do not have direct access to TAPI services. Service provider developers can, of course, use any appropriate mechanism to access kernel mode components, should they choose to use such an architecture.</li>
<li>
TAPI 2.0 uses <i>Telephony service provider user interface</i> DLLs to manage and display dialog boxes. TAPI loads the DLL into the process of an application that invokes any of the service provider functions that can display a dialog.</li>
<li>
TAPI 2.0 permits <i>proxy request handlers</i>. A handler is a full Telephony application that normally executes on a telephony server and provides services that are more appropriately implemented in an application than a driver.</li>
</ul>
<p>
<b>Note</b>&nbsp;&nbsp;The actual implementation of a client-server service provider for Windows NT and Windows 95, and of the server-side components (agent application, administration tools, third party call control service provider, and switch protocol link drivers) is not described in this document. See <a href="../tapi21/tapclmgt_8gac.htm">TAPI Client Management</a> for TAPI documentation.</p>
<p>
Functions and messages that were new or changed for TSPI version 2.0 are as follows: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=41%><i>Function </i></th>
<td width=59%></td>
</tr>
<tr valign=top>
<td width=41%><b>TSPI_lineConditionalMediaDetection</b> </td>
<td width=59%>Changed the conditions under which LINEERR_RESOURCEUNAVAIL is returned. </td>
</tr>
<tr valign=top>
<td width=41%><b>TSPI_lineDropNoOwner</b> </td>
<td width=59%>Obsolete. </td>
</tr>
<tr valign=top>
<td width=41%><b>TSPI_lineDropOnClose</b> </td>
<td width=59%>Obsolete. </td>
</tr>
<tr valign=top>
<td width=41%><b>TSPI_lineGetID</b> </td>
<td width=59%>Changed. Includes an additional parameter. </td>
</tr>
<tr valign=top>
<td width=41%><b>TSPI_lineSetCallData</b> </td>
<td width=59%>New </td>
</tr>
<tr valign=top>
<td width=41%><b>TSPI_lineSetCallQualityOfService</b> </td>
<td width=59%>New </td>
</tr>
<tr valign=top>
<td width=41%><b>TSPI_lineSetCallTreatment</b> </td>
<td width=59%>New </td>
</tr>
<tr valign=top>
<td width=41%><b>TSPI_lineSetLineDevStatus</b> </td>
<td width=59%>New </td>
</tr>
<tr valign=top>
<td width=41%><b>TSPI_phoneGetID</b> </td>
<td width=59%>Changed. Includes an additional parameter. </td>
</tr>
<tr valign=top>
<td width=41%><b>TSPI_providerInit</b> </td>
<td width=59%>Changed </td>
</tr>
<tr valign=top>
<td width=41%><b>TSPI_providerShutdown</b> </td>
<td width=59%>New parameter </td>
</tr>
</table><br>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=41%><i>Message </i></th>
<td width=59%></td>
</tr>
<tr valign=top>
<td width=41%><b>LINE_GATHERDIGITS</b> </td>
<td width=59%>Changed. Tick count added. </td>
</tr>
<tr valign=top>
<td width=41%><b>LINE_GENERATE</b> </td>
<td width=59%>Changed. Tick count added. </td>
</tr>
<tr valign=top>
<td width=41%><b>LINE_MONITORDIGITS</b> </td>
<td width=59%>Changed. Tick count added. </td>
</tr>
<tr valign=top>
<td width=41%><b>LINE_MONITORMEDIA</b> </td>
<td width=59%>Changed. Tick count added. </td>
</tr>
<tr valign=top>
<td width=41%><b>LINE_MONITORTONE</b> </td>
<td width=59%>Changed. Tick count added. </td>
</tr>
<tr valign=top>
<td width=41%><b>LINE_REMOVE</b> </td>
<td width=59%>New </td>
</tr>
<tr valign=top>
<td width=41%><b>PHONE_REMOVE</b> </td>
<td width=59%>New </td>
</tr>
</table><br>
<p>
The Telephony service provider user interface DLL provides a means of allowing user interaction within the context of the application rather than the service provider itself. TSPI version 2.0 delivered the following new functions, messages, and structures for implementation: </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<td width=68%><b>TSPI_providerFreeDialogInstance</b> </td>
<td width=32%>New </td>
</tr>
<tr valign=top>
<td width=68%><b>TSPI_providerGenericDialogData</b> </td>
<td width=32%>New </td>
</tr>
<tr valign=top>
<td width=68%><b>TSPI_providerUIIdentify</b> </td>
<td width=32%>New </td>
</tr>
<tr valign=top>
<td width=68%><b>TUISPI_lineConfigDialog</b> </td>
<td width=32%>New </td>
</tr>
<tr valign=top>
<td width=68%><b>TUISPI_lineConfigDialogEdit</b> </td>
<td width=32%>New </td>
</tr>
<tr valign=top>
<td width=68%><b>TUISPI_phoneConfigDialog</b> </td>
<td width=32%>New </td>
</tr>
<tr valign=top>
<td width=68%><b>TUISPI_providerConfig</b> </td>
<td width=32%>New </td>
</tr>
<tr valign=top>
<td width=68%><b>TUISPI_providerGenericDialog</b> </td>
<td width=32%>New </td>
</tr>
<tr valign=top>
<td width=68%><b>TUISPI_providerGenericDialogData</b> </td>
<td width=32%>New </td>
</tr>
<tr valign=top>
<td width=68%><b>TUISPI_providerInstall</b> </td>
<td width=32%>New </td>
</tr>
<tr valign=top>
<td width=68%><b>TUISPI_providerRemove</b> </td>
<td width=32%>New </td>
</tr>
<tr valign=top>
<td width=68%><b>TUISPIDLLCALLBACK</b> </td>
<td width=32%>New </td>
</tr>
<tr valign=top>
<td width=68%><b>LINE_CREATEDIALOGINSTANCE</b> </td>
<td width=32%>New </td>
</tr>
<tr valign=top>
<td width=68%><b>LINE_SENDDIALOGINSTANCEDATA</b> </td>
<td width=32%>New </td>
</tr>
<tr valign=top>
<td width=68%>  <b>TUISPICREATEDIALOGINSTANCEPARAMS</b> </td>
<td width=32%>New </td>
</tr>
</table><br>
<p>&nbsp;</p></body>
</HTML>
