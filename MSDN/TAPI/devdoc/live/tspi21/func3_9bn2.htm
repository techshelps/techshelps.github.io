<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_phoneOpen</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_phoneopen"></a>TSPI_phoneOpen</h1>
<p>
The <b>TSPI_phoneOpen</b> function opens the phone device whose device identifier is given, returning the service provider's opaque handle for the device and retaining TAPI's opaque handle for the device for use in subsequent calls to the <a href="func3_2x6c.htm"><b>PHONEEVENT</b></a> procedure.</p>
<pre><code><b>LONG TSPI_phoneOpen(
  DWORD</b><i> dwDeviceID</i><b>,       </b>
<b>  HTAPIPHONE</b><i> htPhone</i><b>,     </b>
<b>  LPHDRVPHONE</b><i> lphdPhone</i><b>,  </b>
<b>  DWORD</b><i> dwTSPIVersion</i><b>,    </b>
<b>  PHONEEVENT</b><i> lpfnEventProc  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwDeviceID</i></dt>
<dd>
The phone device to be opened.</dd>
<dt>
<i>htPhone</i></dt>
<dd>
The TAPI opaque handle for the phone device to be used in subsequent calls to the <a href="func3_2x6c.htm"><b>PHONEEVENT</b></a> callback procedure to identify the device.</dd>
<dt>
<i>lphdPhone</i></dt>
<dd>
A pointer to an <a href="datype_2j51.htm">HDRVPHONE</a> where the service provider writes its handle for the phone device to be used by TAPI in subsequent calls to identify the device.</dd>
<dt>
<i>dwTSPIVersion</i></dt>
<dd>
The TSPI version negotiated through <a href="func3_6k6m.htm"><b>TSPI_phoneNegotiateTSPIVersion</b></a> under which the service provider can operate.</dd>
<dt>
<i>lpfnEventProc</i></dt>
<dd>
A pointer to the <a href="func3_2x6c.htm"><b>PHONEEVENT</b></a> callback procedure supplied by TAPI that the service provider calls to report subsequent events on the phone.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the function succeeds, or an error number if an error occurs. Possible return values are as follows: </p>
<p>
PHONEERR_ALLOCATED, PHONEERR_NOMEM, PHONEERR_INCOMPATIBLEAPIVERSION, PHONEERR_RESOURCEUNAVAIL, PHONEERR_NODRIVER, PHONEERR_OPERATIONFAILED, PHONEERR_INUSE, PHONEERR_OPERATIONUNAVAIL, PHONEERR_INIFILECORRUPT. </p>
<h4>Remarks</h4>
<p>
Opening a phone entitles TAPI to make further requests on the phone. The phone becomes active in the sense that the service provider can report asynchronous events such as hookswitch changes or button presses. The service provider reserves whatever nonsharable resources are required to manage the phone. For example, opening a phone accessed through a comm port and modem should result in opening the comm port, making it no longer available for use by other applications.</p>
<p>
If the function succeeds, both TAPI and the service provider become committed to operating under the specified interface version number for this open device. Subsquent operations and events identified using the exchanged opaque phone handles conform to that interface version. This commitment and the validity of the handles remain in effect until TAPI closes the phone using <a href="func3_9z8l.htm"><b>TSPI_phoneClose</b></a> or until the service provider reports the <a href="messgs_0145.htm">PHONE_CLOSE</a> event. If the function is not successful, no such commitment is made and the handles are not valid.</p>
<h4>See Also</h4>
<p>
<a href="messgs_0145.htm">PHONE_CLOSE</a>, <a href="func3_2x6c.htm"><b>PHONEEVENT</b></a>, <a href="func3_9z8l.htm"><b>TSPI_phoneClose</b></a>, <a href="func3_6k6m.htm"><b>TSPI_phoneNegotiateTSPIVersion</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
