<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ASYNC_COMPLETION</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_async_completion"></a>ASYNC_COMPLETION</h1>
<p>
This type is a callback function implemented by TAPI and supplied to the service provider as a parameter to <a href="func1_9pv8.htm"><b>TSPI_providerInit</b></a>. The service provider calls this function to report the completion of a line or phone procedure that it executes asynchronously.</p>
<pre><code><b>ASYNC_COMPLETION Completion_Proc;
void(
  CALLBACK*</b><i> Completion_Proc)(  </i>
<b>  DRV_REQUESTID</b><i> dwRequestID</i><b>,  </b>
<b>  LONG</b><i> lResult                </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwRequestID</i></dt>
<dd>
The identifier passed in the original request that the service provider executed asynchronously.</dd>
<dt>
<i>lResult</i></dt>
<dd>
The outcome of the operation. This can be zero to indicate success or a negative number to indicate an error. The possible specific error values that can result from a function are the same for asynchronous or synchronous execution.
</dd>
</dl>
<h4>Return Values</h4>
<p>
No return value.</p>
<h4>Remarks</h4>
<p>
The call state when calling this function can be any state.</p>
<p>
This procedure is supplied by TAPI at the time a service provider is initialized with the <a href="func1_9pv8.htm"><b>TSPI_providerInit</b></a> function. Some of the TSPI procedures that operate on line, call, and phone devices specify asynchronous operation. These procedures include a <i>dwRequestID</i> parameter to identify the request. When such a procedure is called, the service provider can return a negative number for an error if one is detected immediately, or the positive <i>dwRequestID</i> if the operation continues asynchronously. The service provider must report completion exactly once for each request it executes asynchronously. It does so by calling this procedure. The service provider is not permitted to call this procedure or the <a href="func3_7q7o.htm"><b>LINEEVENT</b></a> or <a href="func3_2x6c.htm"><b>PHONEEVENT</b></a> procedure again until this procedure returns.</p>
<p>
The service provider is permitted to call the <b>ASYNC_COMPLETION</b> function before it returns from the first request. TAPI guarantees not to call the service provider from within the <b>ASYNC_COMPLETION</b> context except where noted.</p>
<p>
This does not have any direct correspondence at the TAPI level because at that level asynchronous function completions are reported as a message passed through the same callback interface that is used for spontaneous event messages. At the TSPI level, spontaneous events are reported through the <b>LINEEVENT</b> and <b>PHONEEVENT</b> callback procedures.</p>
<h4>See Also</h4>
<p>
<a href="func3_7q7o.htm"><b>LINEEVENT</b></a>, <a href="func3_2x6c.htm"><b>PHONEEVENT</b></a>, <a href="func1_9pv8.htm"><b>TSPI_providerInit</b></a><b> </b></p>
<p>&nbsp;</p></body>
</HTML>
