<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_phoneSetStatusMessages</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_phonesetstatusmessages"></a>TSPI_phoneSetStatusMessages</h1>
<p>
The <b>TSPI_phoneSetStatusMessages</b> function causes the service provider to filter status messages that are not currently of interest to any application.</p>
<pre><code><b>LONG TSPI_phoneSetStatusMessages(
  HDRVPHONE</b><i> hdPhone</i><b>,    </b>
<b>  DWORD</b><i> dwPhoneStates</i><b>,  </b>
<b>  DWORD</b><i> dwButtonModes</i><b>,  </b>
<b>  DWORD</b><i> dwButtonStates  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hdPhone</i></dt>
<dd>
The opaque handle to the phone whose state-change monitoring filter is to be set.</dd>
<dt>
<i>dwPhoneStates</i></dt>
<dd>
Flags that specify the set of phone status changes and events for which TAPI wants to receive notification messages. This parameter can have zero, one, or more than one of the following PHONESTATE_ bits set: 
<dl>
<dt>
PHONESTATE_OTHER </dt>
<dd>
A phone status information item other than those listed below has changed. </dd>
<dt>
PHONESTATE_CONNECTED </dt>
<dd>
The connection between the phone device and the service provider was just made. This happens when the API is first invoked, or when the wire connecting the phone to the computer is plugged in with the API active. </dd>
<dt>
PHONESTATE_DISCONNECTED </dt>
<dd>
The connection between the phone device and the service provider was just broken. This happens when the wire connecting the phone set to the computer is unplugged while the service provider is active. </dd>
<dt>
PHONESTATE_DISPLAY </dt>
<dd>
The display of the phone has changed. </dd>
<dt>
PHONESTATE_LAMP </dt>
<dd>
A lamp of the phone has changed. </dd>
<dt>
PHONESTATE_RINGMODE </dt>
<dd>
The ring mode of the phone has changed. </dd>
<dt>
PHONESTATE_RINGVOLUME </dt>
<dd>
The ring volume of the phone has changed. </dd>
<dt>
PHONESTATE_HANDSETHOOKSWITCH </dt>
<dd>
The handset's hookswitch state has changed. </dd>
<dt>
PHONESTATE_HANDSETVOLUME </dt>
<dd>
The handset's speaker volume setting has changed. </dd>
<dt>
PHONESTATE_HANDSETGAIN </dt>
<dd>
The handset's microphone gain setting has changed. </dd>
<dt>
PHONESTATE_SPEAKERHOOKSWITCH </dt>
<dd>
The speakerphone's hookswitch state has changed. </dd>
<dt>
PHONESTATE_SPEAKERVOLUME </dt>
<dd>
The speakerphone's speaker volume setting has changed. </dd>
<dt>
PHONESTATE_SPEAKERGAIN </dt>
<dd>
The speakerphone's microphone gain setting state has changed. </dd>
<dt>
PHONESTATE_HEADSETHOOKSWITCH </dt>
<dd>
The headset's hookswitch state has changed. </dd>
<dt>
PHONESTATE_HEADSETVOLUME </dt>
<dd>
The headset's speaker volume setting has changed. </dd>
<dt>
PHONESTATE_HEADSETGAIN </dt>
<dd>
The headset's microphone gain setting has changed. </dd>
<dt>
PHONESTATE_SUSPEND </dt>
<dd>
TAPI's use of the phone is temporarily suspended. This can occur when the switch requires exclusive use of the phone device. </dd>
<dt>
PHONESTATE_RESUME </dt>
<dd>
TAPI's use of the phone device is resumed after having been suspended for some time. </dd>
<dt>
PHONESTATE_DEVSPECIFIC </dt>
<dd>
The phone's device-specific information has changed. </dd>
<dt>
PHONESTATE_REINIT </dt>
<dd>
Items have changed in the configuration of phone devices. To become aware of these changes, (as with the appearance of new phone devices) the application should reinitialize its use of TAPI. If specified, the <i>htPhone</i> parameter is left NULL for this state change as it applies to any of the phones in the system. 
<p>
The PHONESTATE_REINIT message is never masked. REINIT messages should always be sent when appropriate, regardless of the setting of this flag. The setting of the REINIT flag is simply ignored and generates no error. 
</dd>
</dl>
</dd>
<dt>
<i>dwButtonModes</i></dt>
<dd>
Flags that specify the set of phone button modes for which TAPI wants to receive notification messages. If <i>dwButtonModes</i> is zero, <i>dwButtonStates</i> is ignored. This parameter can have zero, one, or more than one of the following PHONEBUTTONMODE_ bits set. If <i>dwButtonModes</i> has at least one of these flags set, <i>dwButtonStates</i> must also have at least one bit set: 
<dl>
<dt>
PHONEBUTTONMODE_CALL </dt>
<dd>
The button is assigned to a call appearance. </dd>
<dt>
PHONEBUTTONMODE_FEATURE </dt>
<dd>
The button is assigned to requesting features from the switch, such as hold, conference, or transfer. </dd>
<dt>
PHONEBUTTONMODE_KEYPAD </dt>
<dd>
The button is one of the twelve keypad buttons, '0' through '9', '*', and '#'. </dd>
<dt>
PHONEBUTTONMODE_LOCAL </dt>
<dd>
The button is a local function button, such as mute or volume control. </dd>
<dt>
PHONEBUTTONMODE_DISPLAY </dt>
<dd>
The button is a soft button associated with the phone's display. A phone set can have zero or more display buttons. </dd>
</dl>
</dd>
<dt>
<i>dwButtonStates</i></dt>
<dd>
This parameter specifies the set of phone button state changes for which TAPI wishes to receive notification messages. Values are: 
<dl>
<dt>
PHONEBUTTONSTATE_UP </dt>
<dd>
The button is in the up state. </dd>
<dt>
PHONEBUTTONSTATE_DOWN </dt>
<dd>
The button is in the down state (pressed down). 
</dd>
</dl>
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the function succeeds, or an error number if an error occurs. Possible return values are as follows: </p>
<p>
PHONEERR_INVALPHONEHANDLE, PHONEERR_NOMEM, PHONEERR_INVALPHONESTATE, PHONEERR_RESOURCEUNAVAIL, PHONEERR_INVALBUTTONMODE, PHONEERR_OPERATIONFAILED, PHONEERR_INVALBUTTONSTATE, PHONEERR_OPERATIONUNAVAIL. </p>
<h4>Remarks</h4>
<p>
TAPI defines a number of messages that notify applications about events occurring on phones. The sets of all change messages in which all applications are interested can be much smaller than the set of possible messages. This procedure allows TAPI to tell the service provider the reduced set of messages to deliver. The service provider delivers all of the messages it supports, within the specified set. It is permitted to deliver more (they are filtered out by TAPI), but is discouraged from doing so for performance reasons. If TAPI requests delivery of a particular message type that is not produced by the provider, the provider nevertheless accepts the request but simply does not produce the message. All phone status messages except PHONESTATE_REINIT are disabled by default.</p>
<h4>See Also</h4>
<p>
<a href="messgs_2iem.htm">PHONE_BUTTON</a>, <a href="messgs_797p.htm">PHONE_STATE</a>, <a href="cnstant_26ib.htm">PHONESTATE_ Constants</a></p>
<p>&nbsp;</p></body>
</HTML>
