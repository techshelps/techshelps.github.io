<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_phoneGetIcon</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_phonegeticon"></a>TSPI_phoneGetIcon</h1>
<p>
The <b>TSPI_phoneGetIcon</b> function retrieves a service phone device-specific (or provider-specific) icon to display to the user.</p>
<pre><code><b>LONG TSPI_phoneGetIcon(
  DWORD</b><i> dwDeviceID</i><b>,         </b>
<b>  LPCWSTR</b><i> lpszDeviceClass</i><b>,  </b>
<b>  LPHICON</b><i> lphIcon           </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwDeviceID</i></dt>
<dd>
The phone device whose icon is requested.</dd>
<dt>
<i>lpszDeviceClass</i></dt>
<dd>
A pointer to a NULL-terminated Unicode string that identifies a device class name. This device class allows the caller to select a specific sub icon applicable to that device class. This parameter is optional and can be left NULL or be empty, in which case the highest level icon associated with the phone device rather than a specified media stream device is selected.</dd>
<dt>
<i>lphIcon</i></dt>
<dd>
A pointer to a memory location in which the handle to the icon is returned.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the function succeeds, or an error number if an error occurs. Possible return values are as follows: </p>
<p>
PHONEERR_INVALDEVICECLASS, PHONEERR_OPERATIONFAILED, PHONEERR_NOMEM, PHONEERR_OPERATIONUNAVAIL, PHONEERR_RESOURCEUNAVAIL. </p>
<h4>Remarks</h4>
<p>
<b>TSPI_phoneGetIcon</b> causes the provider to return a handle (in the <b>DWORD</b> pointed to by <i>lphIcon</i>) to an icon resource (obtained from the Win32 <b>LoadIcon </b>function) associated with the specified phone. The icon handle is for a resource associated with the provider.</p>
<p>
The <i>lpszDeviceClass</i> parameter allows the provider to return different icons based on the type of service being referenced by the caller. The permitted strings are the same as for <a href="func3_9g6c.htm"><b>TSPI_phoneGetID</b></a>. For example, if the phone supports the Comm API, passing comm/datamodem as <i>lpszDeviceClass</i> causes the provider to return an icon related specifically to the Comm device functions of the service provider. For more information about common device classes, see <a href="devclass_7tpv.htm">TSPI Device Classes</a>.</p>
<p>
The parameters "tapi/phone", "", or NULL can be used to request the icon for the phone device. A provider can choose to support many icons (selected by <i>lpszDeviceClass</i> and/or phone number), a single icon (such as for the manufacturer, which would be returned for all <i>phoneGetIcon</i> requests regardless of the <i>lpszDeviceClass</i> selected), or no icons, in which case it sets the <b>DWORD</b> pointed to by <i>lphIcon </i>to NULL. TAPI examines the handle returned by the provider, and if the provider returns NULL, TAPI substitutes a generic Win32 Telephony icon included as a resource in TAPI (the generic phone icon).</p>
<p>
If the service provider supports no icons, it can leave this function unimplemented, in which case TAPI provides a generic phone icon for the application.</p>
<h4>See Also</h4>
<p>
<a href="func3_3ep3.htm"><b>TSPI_phoneConfigDialog</b></a>, <a href="func3_9g6c.htm"><b>TSPI_phoneGetID</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
