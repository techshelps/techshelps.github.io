<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_lineSetCurrentLocation</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_linesetcurrentlocation"></a>TSPI_lineSetCurrentLocation</h1>
<p>
This <b>TSPI_lineSetCurrentLocation</b> function is called by TAPI whenever the address translation location is changed by the user (in the <b>Dialing Properties</b>dialog box) or an application (using the <b>lineSetCurrentLocation</b> function). Service providers that store parameters specific to a location (for example, touch-tone sequences to invoke particular PBX functions) use the location to select the set of parameters applicable to the new location.</p>
<pre><code><b>LONG TSPIAPI TSPI_lineSetCurrentLocation(
  DWORD</b><i> dwLocation  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwLocation</i></dt>
<dd>
The permanent location identifier of the selected location.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the request succeeds or an error number if an error occurs. Possible return values are: </p>
<p>
LINEERR_NOMEM and LINEERR_OPERATIONFAILED. </p>
<h4>Remarks</h4>
<p>
Service providers that store sets of parameters based on the user's current location should identify those sets by the permanent location identifier of the location.</p>
<p>
If the service provider does not implement specific parameters by location, this function can be omitted.</p>
<p>
If the value passed in to the service provider by this function is not recognized by the service provider (for example, because no location-specific parameters have yet been set for the specified location), the service provider uses a default set of parameters.</p>
<p>
TAPI ignores the value returned by the service provider for this function; it is returned for debugging purposes only.</p>
<p>
The service provider can synchronize its stored location-specific parameters with the locations stored by TAPI whenever the <a href="func1_9n6v.htm"><b>TSPI_providerConfig</b></a> or <a href="func1_2fqf.htm"><b>TSPI_lineConfigDialog</b></a> function is called, by using the <b>lineGetTranslateCaps</b> function to obtain a table of current locations. Newly defined locations and removed locations can be detected at this time, and appropriate adjustments made to the service provider's stored location parameters (including prompting the user to make settings for new locations).</p>
<p>
For backward compatibility, if the service provider does not export this function, TAPI does not call it, and no ill effects result.</p>
<h4>See Also</h4>
<p>
<a href="func1_2fqf.htm"><b>TSPI_lineConfigDialog</b></a>, <a href="func1_9n6v.htm"><b>TSPI_providerConfig</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
