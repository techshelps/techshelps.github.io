<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_phoneGetStatus</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_phonegetstatus"></a>TSPI_phoneGetStatus</h1>
<p>
The <b>TSPI_phoneGetStatus</b> function queries the specified open phone device for its overall status.</p>
<pre><code><b>LONG TSPI_phoneGetStatus(
  HDRVPHONE</b><i> hdPhone</i><b>,           </b>
<b>  LPPHONESTATUS</b><i> lpPhoneStatus  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hdPhone</i></dt>
<dd>
The handle to the phone to be queried.</dd>
<dt>
<i>lpPhoneStatus</i></dt>
<dd>
A pointer to a variably sized data structure of type <a href="struc2_7pf6.htm"><b>PHONESTATUS</b></a>, into which the service provider writes information about the phone's status. Prior to calling <b>TSPI_phoneGetStatus</b>, the application sets the <b>dwTotalSize</b> member of this structure to indicate the amount of memory available to TAPI for returning information.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns zero if the function succeeds, or an error number if an error occurs. Possible return values are as follows: </p>
<p>
PHONEERR_INVALPHONEHANDLE, PHONEERR_OPERATIONFAILED, PHONEERR_NOMEM, PHONEERR_OPERATIONUNAVAIL, PHONEERR_RESOURCEUNAVAIL.</p>
<h4>Remarks</h4>
<p>
The following table indicates which members of the <a href="struc2_7pf6.htm"><b>PHONESTATUS</b></a> data structure are filled in by TAPI and which members are filled in by the service provider. The service provider must <i>not</i> overwrite the values filled in by TAPI. </p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=44%>Member </th>
<th align=left width=28%>TAPI </th>
<th align=left width=28%>Service Provider </th>
</tr>
<tr valign=top>
<td width=44%><b>dwTotalSize;</b> </td>
<td width=28%>X </td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=44%><b>dwNeededSize;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%><b>dwUsedSize;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%></td>
<td width=28%></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=44%><b>dwStatusFlags; </b></td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%><b>dwNumOwners;</b> </td>
<td width=28%>X </td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=44%><b>dwNumMonitors;</b> </td>
<td width=28%>X </td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=44%><b>dwRingMode;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%><b>dwRingVolume;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%></td>
<td width=28%></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=44%><b>dwHandsetHookSwitchMode;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%><b>dwHandsetVolume;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%><b>dwHandsetGain;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%></td>
<td width=28%></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=44%><b>dwSpeakerHookSwitchMode;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%><b>dwSpeakerVolume;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%><b>dwSpeakerGain;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%></td>
<td width=28%></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=44%><b>dwHeadsetHookSwitchMode;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%><b>dwHeadsetVolume;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%><b>dwHeadsetGain;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%></td>
<td width=28%></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=44%><b>dwDisplaySize;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%><b>dwDisplayOffset;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%></td>
<td width=28%></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=44%><b>dwLampModesSize;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%><b>dwLampModesOffset;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%></td>
<td width=28%></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=44%><b>dwOwnerNameSize;</b> </td>
<td width=28%>X </td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=44%><b>dwOwnerNameOffset;</b> </td>
<td width=28%>X </td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=44%></td>
<td width=28%></td>
<td width=28%></td>
</tr>
<tr valign=top>
<td width=44%><b>dwDevSpecificSize;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
<tr valign=top>
<td width=44%><b>dwDevSpecificOffset;</b> </td>
<td width=28%></td>
<td width=28%>X </td>
</tr>
</table><br>
<p>
TAPI can use this function to determine the current state of an open phone device. The status information describes information about the phone device's hookswitch devices, ringer, volume, display, and lamps of the open phone.</p>
<h4>See Also</h4>
<p>
<a href="messgs_797p.htm">PHONE_STATE</a>, <a href="struc2_7pf6.htm"><b>PHONESTATUS</b></a></p>
<p>&nbsp;</p></body>
</HTML>
