<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_lineSetTerminal</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_linesetterminal"></a>TSPI_lineSetTerminal</h1>
<p>
The <b>TSPI_lineSetTerminal</b> function enables TAPI to specify to which terminal information related to the specified line, address, or call is to be routed. This operation can be used while calls are in progress on the line, to allow events to be routed to different devices as required.</p>
<pre><code><b>LONG TSPI_lineSetTerminal(
  DRV_REQUESTID</b><i> dwRequestID</i><b>,  </b>
<b>  HDRVLINE</b><i> hdLine</i><b>,        </b>
<b>  DWORD</b><i> dwAddressID</i><b>,      </b>
<b>  HDRVCALL</b><i> hdCall</i><b>,        </b>
<b>  DWORD</b><i> dwSelect</i><b>,         </b>
<b>  DWORD</b><i> dwTerminalModes</i><b>,  </b>
<b>  DWORD</b><i> dwTerminalID</i><b>,     </b>
<b>  DWORD</b><i> bEnable           </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwRequestID</i></dt>
<dd>
The identifier of the asynchronous request.</dd>
<dt>
<i>hdLine</i></dt>
<dd>
The handle to a line.</dd>
<dt>
<i>dwAddressID</i></dt>
<dd>
An address on the given open line device. TAPI does not validate this parameter when this function is called.</dd>
<dt>
<i>hdCall</i></dt>
<dd>
The handle to a call. The call state can be any state (if <i>dwSelect</i> is LINECALLSELECT_CALL).</dd>
<dt>
<i>dwSelect</i></dt>
<dd>
Specifies whether the terminal setting is requested for the line, the address, or just the specified call. If line or address is specified, events either apply to the line or address itself or serve as a default initial setting for all new calls on the line or address. This parameter uses the following LINECALLSELECT_ constants: 
<dl>
<dt>
LINECALLSELECT_LINE </dt>
<dd>
Select the specified line device. The <i>hdLine</i> parameter must be a valid line handle; <i>hdCall</i> and <i>dwAddressID</i> must be ignored. </dd>
<dt>
LINECALLSELECT_ADDRESS </dt>
<dd>
Select the specified address on the line. Both <i>hdLine</i> and <i>dwAddressID</i> must be valid; <i>hdCall</i> must be ignored. The service provider must validate <i>dwAddressID</i>; TAPI validates <i>hdLine</i>. </dd>
<dt>
LINECALLSELECT_CALL </dt>
<dd>
Select the specified call. The <i>hdCall</i> parameter must be valid; <i>hdLine</i> and <i>dwAddressID</i> must both be ignored. </dd>
</dl>
</dd>
<dt>
<i>dwTerminalModes</i></dt>
<dd>
The class(es) of low level events to be routed to the given terminal. 
<dl>
<dt>
LINETERMMODE_BUTTONS </dt>
<dd>
The button presses from the terminal to the line. </dd>
<dt>
LINETERMMODE_LAMPS </dt>
<dd>
The lamp lighting events from the line to the terminal. </dd>
<dt>
LINETERMMODE_DISPLAY </dt>
<dd>
The display events from the line to the terminal. </dd>
<dt>
LINETERMMODE_RINGER </dt>
<dd>
The ring requests from the line to the terminal. </dd>
<dt>
LINETERMMODE_HOOKSWITCH </dt>
<dd>
The hookswitch events between the terminal and the line. </dd>
<dt>
LINETERMMODE_MEDIATOLINE </dt>
<dd>
The unidirectional media stream from the terminal to the line associated with a call on the line. This value is only allowed when routing of both unidirectional channels of a call's media stream can be controlled independently. </dd>
<dt>
LINETERMMODE_MEDIAFROMLINE </dt>
<dd>
The unidirectional media stream from the line to the terminal associated with a call on the line. This value is only allowed when routing of both unidirectional channels of a call's media stream can be controlled independently. </dd>
<dt>
LINETERMMODE_MEDIABIDIRECT </dt>
<dd>
The bidirectional media stream associated with a call on the line and the terminal. This is the only value allowed when routing of both unidirectional channels of a call's media stream cannot be controlled independently. 
<p>
<b>Note</b> The media modes (1) MEDIABIDIRECT and (2) MEDIATOLINE and MEDIAFROMLINE are exclusive, the enforcement of which is the responsibility of the service provider. 
</dd>
</dl>
</dd>
<dt>
<i>dwTerminalID</i></dt>
<dd>
The device identifier of the terminal device where the given events are to be routed. Terminal identifiers are small integers in the range from 0 through <b>dwNumTerminals</b> minus one, where <b>dwNumTerminals</b> and the terminal modes each terminal is capable of handling are indicated by the service provider in <a href="struc2_0j1u.htm"><b>LINEDEVCAPS</b></a>. 
<p>
<b>Note</b> These terminal identifiers have no relation to other device identifiers and are defined by the service provider through device capabilities. TAPI does not validate this parameter when this function is called.
</dd>
<dt>
<i>bEnable</i></dt>
<dd>
If TRUE, <i>dwTerminalID</i> is valid and the specified event classes are routed to or from that terminal. If FALSE, these events are not routed to or from the <i>dwTerminalID</i>. TAPI does not validate this parameter when this function is called.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns <i>dwRequestID</i>, or an error number if an error occurs. The <i>lResult</i> actual parameter of the corresponding <a href="func3_6ppq.htm"><b>ASYNC_COMPLETION</b></a> is zero if the function succeeds, or an error number if an error occurs. Possible return values are as follows: </p>
<p>
LINEERR_INVALLINEHANDLE, LINEERR_INVALTERMINALID, LINEERR_INVALADDRESSID, LINEERR_RESOURCEUNAVAIL, LINEERR_INVALCALLHANDLE, LINEERR_NOMEM, LINEERR_INVALCALLSELECT, LINEERR_OPERATIONUNAVAIL, LINEERR_INVALTERMINALMODE, LINEERR_OPERATIONFAILED. </p>
<h4>Remarks</h4>
<p>
The service provider returns LINEERR_RESOURCEUNAVAIL if the operation cannot be completed because of resource overcommitment or if too many terminals are set, due either to hardware limitations or to service provider/device driver limitations.</p>
<p>
TAPI can use this operation to route certain classes of low-level line events to the specified terminal device, or to suppress the routing of these events altogether. For example, voice can be routed to a separate audio I/O device (headset), lamps and display events can be routed to the local phone device, and button events and ringer events can be suppressed altogether.</p>
<p>
Call progress tones and/or messages get routed to the same place as media. For example, if audio signals are going to the phone, then so are busy signals (analog) or Q.931 messages indicating busy (digital).</p>
<p>
The service provider must determine whether the combinations of <i>dwSelect</i> and <i>dwTerminalModes</i> are legal.</p>
<p>
This operation can be called any time, even when a call is active on the given line device. This, for example, allows a user to switch from using the local phone set to another audio I/O device.</p>
<p>
This function can be called multiple times to route the same events to multiple terminals simultaneously. To reroute events to a different terminal, TAPI recommends that the application first disable routing to the existing terminal and next route the events to the new terminal. However, the service provider should make its best effort to accomodate the application's requests in any sequence.</p>
<p>
Terminal identifier assignments are made by the service provider, and <a href="struc2_0j1u.htm"><b>LINEDEVCAPS</b></a> indicates which terminal identifiers the service provider has available. Service providers that don't support this type of event routing indicate that they have no terminal devices (<b>dwNumTerminals</b> in <b>LINEDEVCAPS</b> is set to zero).</p>
<p>
<b>LineSetTerminal</b> on a line or address affects all existing calls on that line or address, but does not affect calls on other addresses. It also sets the default for future calls on that line or address. A line or address that has multiple connected calls active at any one time can have different routing in effect for each call.</p>
<p>
Disabling the routing of low-level events to a terminal when these events are not currently routed to or from that terminal is not required to generate an error so long as after the function succeeds, the specified events are not routed to or from that terminal.</p>
<h4>See Also</h4>
<p>
<a href="func3_6ppq.htm"><b>ASYNC_COMPLETION</b></a>, <a href="cnstant_9ysz.htm">LINECALLSELECT_ Constants</a>, <a href="cnstant_8j5f.htm">LINETERMMODE_ Constants</a></p>
<p>
</p>
<p>&nbsp;</p></body>
</HTML>
