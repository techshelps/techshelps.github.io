<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TSPI_lineUnpark</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_tspi_tspi_lineunpark"></a>TSPI_lineUnpark</h1>
<p>
The <b>TSPI_lineUnpark</b> function retrieves the call parked at the specified address and returns a call handle for it.</p>
<pre><code><b>LONG TSPI_lineUnpark(
  DRV_REQUESTID</b><i> dwRequestID</i><b>,  </b>
<b>  HDRVLINE</b><i> hdLine</i><b>,         </b>
<b>  DWORD</b><i> dwAddressID</i><b>,       </b>
<b>  HTAPICALL</b><i> htCall</i><b>,        </b>
<b>  LPHDRVCALL</b><i> lphdCall</i><b>,     </b>
<b>  LPCWSTR</b><i> lpszDestAddress  </i>
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>dwRequestID</i></dt>
<dd>
The identifier of the asynchronous request.</dd>
<dt>
<i>hdLine</i></dt>
<dd>
The handle to the line on which a call is to be unparked.</dd>
<dt>
<i>dwAddressID</i></dt>
<dd>
The address on <i>hdLine</i> at which to originate the unpark. TAPI does not validate this parameter when this function is called.</dd>
<dt>
<i>htCall</i></dt>
<dd>
The TAPI handle to the new unparked call. The service provider must save this and use it in all subsequent calls to the <a href="func3_7q7o.htm"><b>LINEEVENT</b></a> procedure reporting events on the call.</dd>
<dt>
<i>lphdCall</i></dt>
<dd>
A pointer to an <a href="datype_6j8s.htm">HDRVCALL</a> representing the service provider's identifier for the new unparked call. The service provider must fill this location with its handle for the call before this procedure returns. This handle is invalid if the function results in an error.</dd>
<dt>
<i>lpszDestAddress</i></dt>
<dd>
A pointer to a NULL-terminated Unicode string that contains the address where the call is parked. The address is in dialable address format.
</dd>
</dl>
<h4>Return Values</h4>
<p>
Returns <i>dwRequestID</i>, or an error number if an error occurs. The <i>lResult</i> actual parameter of the corresponding <a href="func3_6ppq.htm"><b>ASYNC_COMPLETION</b></a> is zero if the function succeeds, or an error number if an error occurs. Possible return values are as follows: </p>
<p>
LINEERR_INVALLINEHANDLE, LINEERR_NOMEM, LINEERR_INVALPOINTER, LINEERR_OPERATIONUNAVAIL, LINEERR_INVALADDRESSID, LINEERR_OPERATIONFAILED, LINEERR_INVALADDRESS, LINEERR_RESOURCEUNAVAIL. </p>
<h4>Remarks</h4>
<p>
This function differs from the corresponding TAPI function in that it follows the TSPI model for beginning the lifetime of a call. TAPI and the service provider exchange opaque handles representing the call with one another. In addition, the service provider is permitted to do callbacks for the new call before it returns from this procedure. In any case, the service provider must also treat the handle it returned as "not yet valid" until after the matching <b>ASYNC_COMPLETION</b> message reports success. In other words, it must not issue any <b>LINEEVENT</b> messages for the new call or include it in call counts in messages or status data structures for the line.</p>
<p>
The call handle created by this function is a new, distinct, call handle even if an original call handle for the call is still in existence (it has not been destroyed by <b>TSPI_lineCloseCall</b>).</p>
<h4>See Also</h4>
<p>
<a href="func3_6ppq.htm"><b>ASYNC_COMPLETION</b></a>, <a href="func1_4964.htm"><b>TSPI_lineCloseCall</b></a>, <a href="func2_45ij.htm"><b>TSPI_linePark</b></a></p>
<p>&nbsp;</p></body>
</HTML>
