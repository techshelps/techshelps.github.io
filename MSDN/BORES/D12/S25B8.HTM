<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Monitoring Events</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Monitoring Events</H3><P CLASS="t">Use the Event Log Filter tool (Elf.exe) to specify the servers and events that you want to monitor. After you specify what you want to monitor, the tool writes the results to a text file. It can monitor events on servers, or it can filter events saved in .evt files by using the Windows NT Server Event Viewer. </P>
<P CLASS="t"><B>Note</B></P>
<P>You can save an event log filter using the <B>Configuration Add</B> and <B>Remove</B> buttons.</P>
<H4 CLASS="h4"><A NAME="sec0"></A>To monitor events</H4><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Run Elf.exe.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Choose <B>Add</B> and <B>Remove</B> to specify the servers and .evt files you want to monitor. </P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Specify the name of the output text file.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    Specify how far back you want to check events.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;5.    Select the services you want to monitor. </P>
<P>Choose <B>Advanced</B> to specify individual event IDs to ignore for a service.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;6.    Specify the entry types you want to monitor.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;7.    Select the <B>Unattended</B> box if you want to skip over errors and continue.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;8.    Choose <B>Go</B> to start the filter.</P>
<P CLASS="t">The output text file created is in the same format as the Windows NT Server Event Viewer, except that it monitors more than one server and it adds the text description for events.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Displaying Event Log Output in Microsoft Access</H4><P CLASS="t">If you have Microsoft Access, you can use the Microsoft Access Elf.mdb file to provide common summaries of the events. To do so:</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Start Microsoft Access.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Open Elf.mdb.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Choose <B>Open Event Log</B> and specify the full path to the output file created with the Event Log Filter.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    Choose <B>View Details</B>.</P>
<P>The top half of the view window shows the count of each event ID found. Click an event to see individual occurrences in the bottom half of the window.</P>
<P CLASS="t"><B>Note</B></P>
<P>The Elf.mdb database will grow with use. You need to compact this database manually by using the Tools.Database Utilities.Compact Database option in Microsoft Access.</P>
<H4 CLASS="h3"><A NAME="sec2"></A>Monitoring for Specific Events</H4><P CLASS="t">You can use the Event Log Scan tool (Evtscan.exe) to monitor servers for specific events. When a specified event is detected, the Event Log Scan tool can be configured to: </P>
<UL><LI>Send a message.</LI><LI>Send a network pop-up to specific computers. </LI><LI>Restart or stop the service.</LI></UL><H5 CLASS="h4"><A NAME="sec3"></A>To configure the Event Log Scan tool</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Create a configuration file with a .cfg extension specifying the events and actions required. The format is as follows:</P>
<P>EventID;Source;Action;Alert list;Mail list;Comment string</P>
<P CLASS="ltbl"></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="99pt" VALIGN="TOP"><COL WIDTH="261pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Configuration Entry</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Event ID</P></TD><TD VALIGN="TOP"><P CLASS="tt">The numerical event ID (see the Windows NT Server Event Viewer).</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Source</P></TD><TD VALIGN="TOP"><P CLASS="tt">The source name for the service to monitor.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Action</P></TD><TD VALIGN="TOP"><P CLASS="tt">The action to take; can be <B>Restart</B> or <B>Stop</B>.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Alert list</P></TD><TD VALIGN="TOP"><P CLASS="tt">A comma-separated list of computers to send network pop-ups to when the event is detected.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Mail list</P></TD><TD VALIGN="TOP"><P CLASS="tt">A comma-separated list of e-mail aliases to notify when the event is detected.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Comment string</P></TD><TD VALIGN="TOP"><P CLASS="tt">A comment that is included in the alert pop-up and e-mail message when the event occurs.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Run Evtscan.exe by using the following command-line format:</P>
<P><B>evtscan -f</B><I> config_file</I> <B>-t</B> <I>delay_in_seconds</I> <I>server_list</I></P>
<P>where <I>config_file</I> is the name of the configuration file created in step 1, <I>delay_in_seconds</I> is the time the tool waits between scans (for example, typing <B>-t 15</B> means the tool scans for events every 15 seconds), and <I>server_list</I> is a comma-separated list of the servers to monitor for the events.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Leave Evtscan.exe running on the desktop. You might want to minimize the command prompt window.</P>
<H5 CLASS="h4"><A NAME="sec4"></A>Sample Configuration File</H5><P CLASS="t">The following is a sample configuration file:</P>
<P CLASS="spacing"><BR></P>
<PRE>;sample config file. 
9277;MSExchangeMTA;restart;nobellchem;nobellchem;Event 9277
9278;MSExchangeMTA;stop;nobellchem;;Event 9278
9279;MSExchangeMTA;;nobellchem;nobellchem;Event 9279
9297;MSExchangeMTA;restart;nobellchem;nobellchem;Event 9297</PRE></BODY></HTML>
