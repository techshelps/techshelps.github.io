<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Command Line Mail Sender</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Using Command Line Mail Sender</H3><P CLASS="t">The Command Line Mail Sender takes the command-line arguments you pass it and calls three basic MAPI functions: <B>Logon</B>, <B>SendMail</B>, and <B>Logoff</B>. The tool then pauses for one second and lets other MAPI threads, namely the Spooler, deliver your message before it quits. This is done so that the client does not need to be loaded to use the Command Line Mail Sender, and the message is delivered before the Command Line Mail Sender quits.</P>
<P CLASS="t">At the command prompt, type:</P>
<P CLASS="t"><B>SENDMAIL -u</B> <I>profile name</I> <B>-p</B><I> password </I><B>-r</B><I> recipient(s)</I> [<B>-c</B><I> copy recipient(s)</I>] [<B>-s</B> <I>subject</I>] [<B>-m</B><I> message</I>] [<B>-f</B><I> file attachment(s)</I>] [<B>-v</B>] [<B>-?</B>]</P>
<P CLASS="t">Use the profile name specified when you choose <B>Mail</B> and <B>Fax</B> in Control Panel. If there are spaces in the name, enclose the name in quotation marks.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Examples</H4><P CLASS="t">In this example, a message from user RISNT01 is sent to Technicians 1, 2, and 3 with a copy to local area network (LAN) Support. The subject is "[411] Server Alert" with a message "Disk is 90% full." The two log files are attached to the end of the message.</P>
<P CLASS="t">Instead of hard coding the subject line and message text, you can retrieve specific details from the Performance Monitor alert with the command-line arguments %0, %1, %2, and so on, to construct a meaningful Command Line Mail Sender message.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Run the Srvany.exe utility in the Windows NT Resource Kit to set up Performance Monitor to run as a service. </P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Add an alert that starts when the disk drive is more than 90 percent full. </P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    In the Alert Send window, run the Command Line Mail Sender by typing the following in the <B>Run Program on Alert</B> box:</P>
<P CLASS="spacing"><BR></P>
<PRE>SENDMAIL -u RISNT01 -p -r tech1;tech2tech3 -c "LAN Support" -s<BR>
"[411] ServerAlert" -m "Disk is 90% full" -f<BR>
c:\temp\diruse.log;c:\temp\status.log</PRE></BODY></HTML>
