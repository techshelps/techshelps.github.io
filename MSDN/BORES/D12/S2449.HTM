<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Configuring Default Messaging Profiles</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Configuring Default Messaging Profiles</H3><P CLASS="t">Microsoft Exchange Server provides a tool called the automatic profile generator (Newprof.exe) that can be used as an alternative to the Profile Wizard. If you use Newprof.exe, users don't need to create their own profiles using the Profile Wizard after Microsoft Exchange Client has been installed. It creates a default messaging profile with settings that you have specified. This process is transparent to the user.</P>
<P CLASS="t">Newprof.exe can be run during Setup or from the command line. It uses a .prf file to determine the settings for the new profile. If there is no default profile in the user's home directory and a .prf file is present, Newprof.exe creates a profile based on the information that you specified in the .prf file.</P>
<P CLASS="t">You can run Newprof.exe with a .prf file from the command line with a variety of distribution mechanisms such as SMS, logon scripts, and e-mail. If you use it with logon scripts, Newprof.exe can be used to create default profiles for <I>roving users</I> when they log on to a new computer. Roving users are users who log on to the Microsoft Exchange Client from different computers in an organization.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Automatically Creating Profiles for Roving Users</H4><P CLASS="t">Many users need to access their e-mail from different Microsoft Exchange Client computers. For example, a roving user can have two offices in two different locations. You can make it easier for a roving user to log on to a new Microsoft Exchange Client computer by using the automatic profile generator to create a default profile. If you preconfigure a default profile, roving users don't need to create a profile using the Profile Wizard every time they log on to a new client computer because the automatic profile generator creates one if needed.</P>
<P CLASS="t">To create profiles for roving users automatically, you can create a .prf file with the user's logon name and home server defined. You can also configure the logon script to verify that a profile does not exist for that user on the computer. If the computer doesn't already have a profile defined for the user, then the logon script calls Newprof.exe. Newprof.exe uses the .prf file in the user's home directory to create a new profile.</P>
<P CLASS="t">For more information about roving user support, see Chapter 3, "Working with Microsoft Exchange Server."</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Using Newprof.exe with a .Prf File</H4><P CLASS="t">You can use the Setup Editor or any text editor to specify settings in the .prf file. The .prf file can be in the client installation point or the user's home directory. If Setup is used to run Newprof.exe, the file must be named Default.prf or it will be ignored. To use a different name, you can run Newprof.exe from the command line as follows:</P>
<P CLASS="t"><B>Newprof.exe -p </B><I>filepath</I></P>
<P CLASS="t">where <I>filepath</I> is the path and file name of the .prf file.</P>
<P CLASS="t">You can use the sample Template.prf file provided with the Microsoft Exchange Client to create a customized .prf file.</P>
<H4 CLASS="h3"><A NAME="sec2"></A>Creating a .Prf File</H4><P CLASS="t">Some of the most common entries in a .prf file are described in the following table. For a list of entries in a .prf file and their formats, see the sample Template.prf file.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="130pt" VALIGN="TOP"><COL WIDTH="141pt" VALIGN="TOP"><COL WIDTH="83pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Entry</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Description</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Value</B></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">MailboxName=</P></TD><TD VALIGN="TOP"><P CLASS="tt">The name of the Microsoft Exchange Server mailbox. </P></TD><TD VALIGN="TOP"><P CLASS="tt">The user's name</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">HomeServer=</P></TD><TD VALIGN="TOP"><P CLASS="tt">The name of the Microsoft Exchange Server computer where the user's mailbox is located. </P></TD><TD VALIGN="TOP"><P CLASS="tt">The server name</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">OfflineFolderPath=</P></TD><TD VALIGN="TOP"><P CLASS="tt">The location of the offline (.ost) folder file. </P></TD><TD VALIGN="TOP"><P CLASS="tt">The path and file name</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">PathToPersonalAddressBook=</P></TD><TD VALIGN="TOP"><P CLASS="tt">The path to the personal address book (.pab). </P></TD><TD VALIGN="TOP"><P CLASS="tt">The path and file name</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">EmptyWastebasket=</P></TD><TD VALIGN="TOP"><P CLASS="tt">Whether to empty the Deleted Items folder when quitting. </P></TD><TD VALIGN="TOP"><P CLASS="tt">True or false</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">GenReadReceipt=</P></TD><TD VALIGN="TOP"><P CLASS="tt">Whether to generate a read receipt. </P></TD><TD VALIGN="TOP"><P CLASS="tt">True or false</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">GenDeliveryReceipt=</P></TD><TD VALIGN="TOP"><P CLASS="tt">Whether to generate a delivery receipt. </P></TD><TD VALIGN="TOP"><P CLASS="tt">True or false</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">SaveSentMail=</P></TD><TD VALIGN="TOP"><P CLASS="tt">Whether to save sent messages. </P></TD><TD VALIGN="TOP"><P CLASS="tt">True or false</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">If the default profile's user name is not specified in the .prf file, Newprof.exe obtains the user's name from the registry or the Win.ini file. If this information is not available, the system prompts for a name when the user logs on to the client.</P></BODY></HTML>
