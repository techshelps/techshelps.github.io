<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting Up Users Accessing Microsoft Exchange Client from Multiple Windows Operating Systems</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Setting Up Users Accessing Microsoft Exchange Client from Multiple Windows Operating Systems</H3><P CLASS="t">You can set up Microsoft Exchange Client users so they can move to any computer and access their mailbox, regardless of the Windows operating system.</P>
<P CLASS="t"><B>Note</B></P>
<P>Roving users using the Microsoft Exchange Client for MS-DOS can access their mailboxes only from the MS-DOS client.</P>
<H4 CLASS="h4"><A NAME="sec0"></A>To set up a roving user for all operating systems</H4><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Set up each operating system to allow roving users. See the procedures later in this section.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Assign Windows NT domain logon scripts for each domain user.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Using the Windows NT Server <B>User Manager for Domains</B> program or a logon script, create a home directory for each user.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    Copy three profile (.prf) files into each user's home directory, one for each platform. See the procedures later in this section. The profile is created the first time the user logs on to a computer with that operating system. The user should save the profile in the home directory and the profile will be available the next time the user logs on to any computer with the same operating system.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;5.    Follow the steps for each operating system that will be used. For more information, see "Using the Profile Generator" earlier in this chapter.</P>
<H4 CLASS="h4"><A NAME="sec1"></A>To set up the operating system to allow roving users</H4><P> <FONT FACE="symbol">·</FONT>    Set up each operating system as follows.</P>
<P CLASS="t"><B>Windows NT   </B>Use <B>User Manager for Domains</B> to create a user profile for each user.</P>
<P CLASS="t"><B>Windows 95   </B>Enable user profiles for Windows 95. In Control Panel, choose Passwords, and then choose <B>User Profiles</B>.</P>
<P CLASS="t"><B>Windows 3.</B><B><I>x</I></B><B><I> </I></B><B> and Windows for Workgroups   </B> Add the <B>ProfileDirectory16=&lt;</B><I>home directory</I><B>&gt;</B> line to the [MAPI] section of the Win.ini file.</P>
<H4 CLASS="h4"><A NAME="sec2"></A>To create profile files</H4><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Run the Microsoft Exchange Server Setup Editor at the client installation point for each operating system. Running the Setup Editor creates a Default.prf profile file in the client installation directory.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    From the <B>File </B>menu, choose <B>Set User Options</B>, then select the <B>Home Server</B> tab. Ensure the <B>Home Server</B> box is completed.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Copy Default.prf to Win95.prf, Winnt.prf, and Win16.prf. These profile files can be identical and must contain all of the information to be added to the user profile, except the MailboxName. This is entered by the profile generator (Profgen.exe).</P>
<H4 CLASS="h3"><A NAME="sec3"></A>Windows NT Mandatory User Profiles</H4><P CLASS="t">If you have mandatory user profiles, no changes to the Windows NT user profile are saved. Each time the user logs on, the default Windows NT profile overwrites the local Windows NT profile, so the Microsoft Exchange Client profiles created during one Windows NT logon session are not available the next time the user logs on.</P>
<P CLASS="t">Use the profile generator to automatically re-create the user's profile each time the user logs on to the Windows NT domain. The profile generator automatically renames the .prf file, so you use the Windows&nbsp;NT logon script to copy the .prf file.</P>
<H5 CLASS="h4"><A NAME="sec4"></A>To set up roving users with mandatory user profiles</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Modify the Windows NT logon script to copy a .prf file into the user's home directory by adding the following line:</P>
<P CLASS="spacing"><BR></P>
<PRE>Copy \\&lt;<I>ServerName</I>&gt;\&lt;<I>Share</I>&gt;\Default.prf  H:\</PRE>
<P>where H:\ is the user's home directory.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Complete the steps in "Using the Profile Generator" earlier in this chapter.</P>
<H4 CLASS="h3"><A NAME="sec5"></A>Preventing Roving Users from Creating Local .Pst Files</H4><P CLASS="t">For a roving user's mail to be accessible from each computer, the user must use only the server-based information store. If the user moves mail to a local .pst file (personal folders in the Microsoft Exchange Client), it will not be available from other computers.</P>
<P CLASS="t">You can prevent users from creating personal folders by installing the Microsoft Exchange Client without the personal folders service. Without this service, users cannot add personal folders to their profile.</P>
<H5 CLASS="h4"><A NAME="sec6"></A>To install the Microsoft Exchange Client without personal folders</H5><P CLASS="t"><B>Note</B></P>
<P>This works only if the Microsoft Exchange Client has never been installed on the computer.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Run the Microsoft Exchange Setup Editor at a client installation share point.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    From the <B>File</B> menu, choose <B>Select Client Installation Point</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Select the <B>Services</B> property page.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    In the <B>To be installed on the client</B> box, select the <B>Personal Folders</B> service and choose <B>Remove</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;5.    Choose <B>OK</B> and quit the program.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;6.    Run Microsoft Exchange Client Setup from the modified installation share point. The installed client will not have the personal folders service available.</P>
<P CLASS="t">If the Microsoft Exchange Client was previously installed on the computer with personal folders, personal folders are available even if you remove the client by selecting <B>Remove All</B> in Setup or if you reinstall with different services. The only way to remove the service is to edit the Mapisvf.inf file manually.</P>
<H5 CLASS="h4"><A NAME="sec7"></A>To remove personal folders from a Microsoft Exchange Client that has already been installed</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Open the Mapisvf.inf file using a text editor.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Remove the following line from the [Services] section.</P>
<P CLASS="spacing"><BR></P>
<PRE>MSPST MS=Personal Folders</PRE></BODY></HTML>
