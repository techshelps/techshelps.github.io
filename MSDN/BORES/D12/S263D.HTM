<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Enabling Clients to Securely Connect over the Internet</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Enabling Clients to Securely Connect over the Internet</H3><P CLASS="t">Microsoft Exchange Client computers can connect to mailboxes on Microsoft Exchange Server computers remotely using TCP/IP over the Internet. By connecting over the Internet, users can read and send mail just as if they were on the same local area network (LAN) as the server. For example, if users from CompanyA need to access mail while visiting CompanyB, they can use CompanyB's Internet connection. Microsoft Exchange Client doesn't need to use a modem or Remote Access Service (RAS) to establish a remote connection with Microsoft Exchange Server. However, both the client and the server must support TCP/IP.</P>
<P CLASS="t">You can enable communication over the Internet with the least amount of security risk to your organization by performing these tasks.</P>
<UL><LI>Configure the Microsoft Exchange Client to use encrypted RPCs. This ensures that messages transmitted over the Internet between a client and a server are secure and can't be tampered with. For more information about configuring encrypted RPCs, see "Configuring the Microsoft Exchange Client to Use Encrypted RPCs" earlier in this chapter.</LI><LI>Specify the client's home server using the server's fully qualified domain name. This enables the Microsoft Exchange Client to locate the home server.</LI><LI>If the home server is in a different domain from the user account accessing the mailbox, enable the client to be authenticated by the home server's domain. This gives the user access to the domain where the home server is located.</LI></UL><UL><LI>If your organization uses an Internet firewall, configure the firewall to allow RPC communication. If a firewall is not used, RPC communication to the Internet is enabled by default.</LI></UL><H4 CLASS="h3"><A NAME="sec0"></A>Specifying the Home Server</H4><P CLASS="t">To connect to a Microsoft Exchange Server computer remotely over the Internet, the client must use the server's fully qualified domain name. This is because the server name must be in a format that can be resolved over the Internet. Instead of connecting to a server using its computer name (also called a NetBIOS name) as the client on a LAN does, you must specify a name such as <I>server1.acme.com</I>. If the server name is not registered in DNS, you can specify the IP address instead.</P>
<H5 CLASS="h4"><A NAME="sec1"></A>To specify the home server name</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    In Control Panel, choose Mail, select Microsoft Exchange Server, and then choose <B>Properties</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Under <B>Microsoft Exchange server</B>, type the name of the server that contains the mailbox you want to use.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Choose <B>OK</B>.</P>
<H4 CLASS="h3"><A NAME="sec2"></A>Configuring Authentication by the Home Server's Domain</H4><P CLASS="t">When users connect to a server using the Internet, they will probably be in a different organization that uses a different domain from their home server. To ensure that the client is authenticated by the server's domain during a remote Internet connection, the user must connect to the home server using a user account that is valid in the home server's domain. To make connecting to the home server easier, the Microsoft Exchange Client can be configured to prompt the user for the name and password of the user account in the home server's domain.</P>
<H5 CLASS="h4"><A NAME="sec3"></A>To enable the client to be authenticated by the home server's domain</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    In Control Panel, choose Mail, select Microsoft Exchange Server, and then choose <B>Properties</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Select the <B>Advanced</B> tab.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Clear <B>Use network security during logon</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    Choose <B>OK</B>.</P>
<H4 CLASS="h3"><A NAME="sec4"></A>Configuring a Firewall to Allow RPC Communication</H4><P CLASS="t">In order for Microsoft Exchange Client computers to access Microsoft Exchange Server computers remotely over the Internet, the clients and servers must be able to communicate using RPCs. If you are not using an Internet firewall, RPC communication is enabled by default. This configuration is risky because an attacker can gain access to the server and potentially compromise the security of Microsoft Exchange Server resources such as mailboxes and public folders.</P>
<P CLASS="t">If you are using a firewall to increase your system's security, you may need to configure the firewall to allow RPC communication. Some Internet firewalls do not accept TCP/IP port numbers that Microsoft Exchange Server uses for RPC communication. To solve this problem, you should add port 135 to your firewall and configure Microsoft Exchange Server to use the same ports as your firewall.</P>
<P CLASS="t">To configure Microsoft Exchange Server, you should set two unique port numbers, one for the information store and one for the directory. The registry value TCP/IP Port controls this setting. This DWORD value is a 16-bit number that you set for the port that the firewall will accept.</P>
<P CLASS="t">For the directory, you can modify the port numbers in the following registry location:</P>
<P CLASS="spacing"><BR></P>
<PRE>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeDS\Parameters\TCP/IP Port</PRE>
<P CLASS="t">For the information store, you can modify the port number in the following registry location:</P>
<P CLASS="spacing"><BR></P>
<PRE>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeIS\ParametersSystem\TCP/IP Port</PRE>
<P CLASS="t">If you are using a packet filter, you must configure it to allow TCP connections to these ports in addition to port 135 (for the RPC End-Point Mapper service) on the Microsoft Exchange Server computer.</P>
<H5 CLASS="h4"><A NAME="sec5"></A>To add TCP/IP port numbers</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    In the Windows NT registry, select one of the following keys:</P>
<UL><LI>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\ MSExchangeDS\Parameters</LI><LI>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\ MSExchangeIS\ParametersSystem</LI></UL><p>&nbsp;&nbsp;&nbsp;&nbsp;2.    From the <B>Edit</B> menu, select <B>Add Key</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    In <B>Key Name</B>, type TCP/IP Port, and choose <B>OK</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    Select the new TCP/IP Port key, and select <B>Add Value</B> from the <B>Edit</B> menu.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;5.    In <B>Value Name</B>, type TCP/IP Port. In <B>Data Type</B>, select <B>REG_DWORD</B>, and choose <B>OK</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;6.    In <B>Data</B>, type the number of the port that the firewall will accept.</P>
<P CLASS="t"></P></BODY></HTML>
