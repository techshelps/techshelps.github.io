<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Unable to Send or Receive Internet Mail</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Unable to Send or Receive Internet Mail</H3><P CLASS="t">This section describes how to troubleshoot the following problems:</P>
<UL><LI>Outbound Internet mail sits in the queue or is returned to the sender as Host Unknown.</LI><LI>Inbound Internet mail arrives at the domain name server and sits in the queue.</LI><LI>Mail sent from the Internet addressed to users in the organization is returned as Host Unknown or Recipient not Recognized.</LI></UL><H4 CLASS="h3"><A NAME="sec0"></A>Solutions</H4><P CLASS="t">To successfully send and receive Internet Mail, check the following:</P>
<UL><LI>Verify the Microsoft Exchange Server site address.</LI><LI>Verify the Windows NT TCP/IP settings.</LI><LI>Verify that Domain Name Service (DNS) is configured correctly.</LI><LI>Verify the Internet Mail Connector address space is valid.</LI><LI>Use the DNS Resolver to verify your configuration.</LI></UL><H5 CLASS="h4"><A NAME="sec1"></A>Verifying the Site Address</H5><P CLASS="t">The default Microsoft Exchange Server simple mail transport protocol (SMTP) domain name is based on the organization and site name specified during installation. For example, Ferguson and Bardell's organization name<I> </I>(FAB) and site name (NAmerica-SW) are used to generate the following domain name.</P>
<P CLASS="spacing"><BR></P>
<PRE>namerica-sw<B>.</B>fab.com</PRE>
<P CLASS="t">The domain name is appended to the mailbox name to generate an SMTP address for messages sent through the Internet Mail Connector. For example, a user named <I>Fran Wilson</I> sending an SMTP message from this site has the following SMTP address.</P>
<P CLASS="spacing"><BR></P>
<PRE>franwilson@namerica-sw.fab.com</PRE>
<P CLASS="t">It is important to verify that the SMTP address for the site is the same address you specified in DNS or the hosts file. To check the SMTP site address, complete the following steps:</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;1.    In the Administrator window, choose <B>Configuration</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Double-click <B>Site Addressing</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Select the <B>Site Addressing</B> tab.</P>
<P><img src="xerk_i12.gif"></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    If the SMTP site address is incorrect, edit it.</P>
<P>Make a note of the site address for later use.</P>
<P CLASS="t">For more information about site addresses, see the <I>Microsoft Exchange Server Concepts and Planning Guide</I> and the <I>Microsoft Exchange Server Administrator's Guide</I>.</P>
<H5 CLASS="h4"><A NAME="sec2"></A>Verifying the Windows NT TCP/IP DNS Settings</H5><P CLASS="t">Whenever possible, the TCP/IP DNS host and domain names should match the Microsoft Exchange Server organization and site names. Check the Windows NT TCP/IP configuration by completing the following steps:</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;1.    In Control Panel, choose the Network icon.</P>
<P><img src="xerk_i09.gif"></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    In the <B>Installed Network Software</B> box, select <B>TCP/IP Protocol</B>, and then choose <B>Configure</B>.</P>
<P><img src="xerk_i10.gif"></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Choose <B>DNS</B>.</P>
<P><img src="xerk_i11.gif"></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    Verify that the DNS Host Name is the Microsoft Exchange Server site name and the DNS Domain Name is the Microsoft Exchange Server organization name. If you use a host and domain name that is different from the site and organization name, be sure that your domain name server has a mail exchanger (MX) record.</P>
<P CLASS="t">For more information about organization and site names, see the <I>Microsoft Exchange Server Concepts and Planning Guide</I> and the <I>Microsoft Exchange Server Administrator's Guide</I>. For more information about Windows NT TCP/IP, see the Windows NT Server documentation.</P>
<H5 CLASS="h4"><A NAME="sec3"></A>Verifying the DNS Configuration</H5><P CLASS="t">If you do not maintain a DNS server in your organization, you will need to work with your Internet provider to ensure the correct DNS records are specified for your organization. It is important to understand how address (A) records and MX records are used to verify their accuracy.</P>
<P CLASS="t">Internet mail and DNS settings are similar to letters and the postal system. The post office delivers a letter based on the street name and street number specified on the envelope. Internet mail is delivered through a query to DNS based on the domain name specified for the recipient. An A record is like the street address, and an MX record is the street number.</P>
<P CLASS="t">The A record should match the domain name in the Windows TCP/IP configuration. If the site name does not equal the host name specified in DNS, you need an MX record. For more information, see the <I>Microsoft Exchange Server Administrator's Guide.</I></P>
<P CLASS="t">In the example, the TCP/IP host name is <I>tucson03 </I>and the domain name is <I>fab.com</I>. The SMTP site address is <I>@NAmerica-SW.fab.com</I>. It is likely that a message will be sent <I>user@fab.com</I> rather than <I>user@NAmerica-SW.fab.com</I>, so an MX record is needed to correlate <I>NAmerica-SW</I> (the house number) with <I>fab.com</I> (the street name). To ensure the message is delivered, the A record and MX record look like the following.</P>
<P CLASS="spacing"><BR></P>
<PRE>Tucson03.fab.com.    IN A 10.31.67.198
NAmericaSW.fab.com IN MX 10 Tucson03.fab.com.</PRE>
<P CLASS="t">For more information about DNS, see the <I>Microsoft Exchange Server Concepts and Planning Guide,</I> the <I>Microsoft Exchange Server Administrator's Guide</I>, and your DNS server documentation.</P>
<H5 CLASS="h4"><A NAME="sec4"></A>Verifying the Address Space</H5><P CLASS="t">The address space of a connector creates a path for messages. It identifies the recipient type and addresses that the message passes through. If the address space is not defined, messages will not pass through it. If the address space is incorrect, some messages may not pass through it. Verify the address space for the Internet Mail Connector by completing the following steps:</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;1.    In the Administrator window, choose <B>Connections</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Double-click <B>Internet Mail Connector</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Select the <B>Address Space</B> tab.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<img src="xerk_i08.gif"></P>
<P></P>
<P CLASS="t">In this case, the address space is configured to process all SMTP type addresses (*.*). If the address space is not defined, create a new one. If it is not defined correctly, edit it.</P>
<P CLASS="t">For more information about address spaces, see the <I>Microsoft Exchange Server Administrator's Guide</I>.</P>
<H5 CLASS="h4"><A NAME="sec5"></A>Using the Internet Mail Connector DNS Resolver Test</H5><P CLASS="t">The Internet Mail Connector DNS Resolver Test performs a DNS query for MX records that match the specified domain. A list is created of one or more IP addresses in the same order of preference the Internet Mail Connector uses in its attempt to deliver mail for that domain.</P>
<P CLASS="t">If the MX query returns no results, a query for the A record matching the domain is performed. The result is a single IP address. If the A record search returns no results, the host file on the local computer is checked. If a match is found, the result is a single IP address.</P>
<P CLASS="t">The DNS Resolver Test is useful for checking DNS or host file configurations and for troubleshooting delivery problems.</P>
<P CLASS="t">Run the Internet Mail Connector DNS Resolver Test from the Support\Utils directory on the Microsoft Exchange Server compact disc. Run the test from the same computer that runs the Internet Mail Connector after TCP/IP and DNS are configured.</P>
<P CLASS="t">To run the IMC DNS Resolver Test with options, type the following at the command prompt.</P>
<P CLASS="spacing"><BR></P>
<PRE>restest [-debug] domain</PRE>
<P CLASS="t">Using <I>-debug</I> causes additional information to be displayed at each step of the search.</P></BODY></HTML>
