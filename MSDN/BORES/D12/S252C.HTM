<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Analyzing Load Simulator Data</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Analyzing Load Simulator Data</H3><P CLASS="t">As a performance tool, Load Simulator can help you answer the question: How many users per server does your Microsoft Exchange Server computer support? To determine the answer to this question, you can use Load Simulator to generate information about client response times. For more information about analyzing performance data, see the Microsoft Exchange Server white paper <I>Performance: Concurrent Users Per Server </I>that is available from the Microsoft Exchange Server web site (www.microsoft.com/exchange).</P>
<H4 CLASS="h3"><A NAME="sec0"></A>User Definitions</H4><P CLASS="t">Usage patterns and activity levels depend on many factors, including business and personal use of messaging, scheduling, and workgroup capabilities, geographical distribution, and corporate culture. For example, a user can receive hundreds of messages each day or only one or two.</P>
<P CLASS="t">To standardize results and provide a basis for comparing results across topologies and platforms, Load Simulator defines three basic user types. These types are available in Load Simulator as preconfigured settings. You can also use Load Simulator to customize the default user definitions to match the usage patterns in your organization.</P>
<P CLASS="t">The following table contains the Load Simulator parameter definitions for the Initialize Users test. The Initialize Users test uses the same message file distribution and weighting as the Load Simulation test.</P>
<P></P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="130pt" VALIGN="TOP"><COL WIDTH="54pt" VALIGN="TOP"><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="91pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="4" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="th"><B></B></P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="th"><B>Usage definitions</B></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="th"><B>Option</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Light</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Medium</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Heavy</B></P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Number of new folders</P></TD><TD VALIGN="TOP"><P>20</P></TD><TD VALIGN="TOP"><P>40</P></TD><TD VALIGN="TOP"><P>60</P></TD></TR><TR><TD VALIGN="TOP"><P>Number of messages per new folder</P></TD><TD VALIGN="TOP"><P>5</P></TD><TD VALIGN="TOP"><P>5</P></TD><TD VALIGN="TOP"><P>5</P></TD></TR><TR><TD VALIGN="TOP"><P>Number of messages in Inbox</P></TD><TD VALIGN="TOP"><P>1</P></TD><TD VALIGN="TOP"><P>4</P></TD><TD VALIGN="TOP"><P>9</P></TD></TR><TR><TD VALIGN="TOP"><P>Number of messages in Deleted Items</P></TD><TD VALIGN="TOP"><P>1</P></TD><TD VALIGN="TOP"><P>1</P></TD><TD VALIGN="TOP"><P>1</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">The following table contains the Load Simulator parameter definitions that correspond with options in the Load Simulator test. The default message files that Load Simulator uses are provided for each applicable option.</P>
<P></P>

<TABLE COLS="6" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="130pt" VALIGN="TOP"><COL WIDTH="54pt" VALIGN="TOP"><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="88pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"><COL WIDTH="3pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="6" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="th"><B></B></P></TD><TD COLSPAN="5" VALIGN="TOP"><P CLASS="th"><B>Usage definitions</B></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="th"><B>Option</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Light</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Medium</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Heavy</B></P></TD></TR><TR><TD COLSPAN="5" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Hours in day</P></TD><TD VALIGN="TOP"><P>8</P></TD><TD VALIGN="TOP"><P>8</P></TD><TD VALIGN="TOP"><P>8</P></TD></TR><TR><TD VALIGN="TOP"><P>Send new mail (not reply or forward)</P></TD><TD VALIGN="TOP"><P>2 times</P></TD><TD VALIGN="TOP"><P>4 times</P></TD><TD VALIGN="TOP"><P>6 times</P></TD></TR><TR><TD VALIGN="TOP"><p>&nbsp;&nbsp;&nbsp;&nbsp;Text only message</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><p>&nbsp;&nbsp;&nbsp;&nbsp;    1K text (Ups1k.msg)</P></TD><TD VALIGN="TOP"><P>90</P></TD><TD VALIGN="TOP"><P>60</P></TD><TD VALIGN="TOP"><P>50</P></TD></TR><TR><TD VALIGN="TOP"><p>&nbsp;&nbsp;&nbsp;&nbsp;    2K text (Ups2k.msg)</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>16</P></TD><TD VALIGN="TOP"><P>10</P></TD></TR><TR><TD VALIGN="TOP"><p>&nbsp;&nbsp;&nbsp;&nbsp;    4K text (Ups4k.msg)</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>4</P></TD><TD VALIGN="TOP"><P>5</P></TD></TR><TR><TD VALIGN="TOP"><p>&nbsp;&nbsp;&nbsp;&nbsp;1K text message with attachment</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><p>&nbsp;&nbsp;&nbsp;&nbsp;     10K attachment (Ups10kat.msg)</P></TD><TD VALIGN="TOP"><P>10</P></TD><TD VALIGN="TOP"><P>5</P></TD><TD VALIGN="TOP"><P>10</P></TD></TR><TR><TD VALIGN="TOP"><p>&nbsp;&nbsp;&nbsp;&nbsp;     Excel attachment (UpsXLatt.msg)</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>4</P></TD><TD VALIGN="TOP"><P>5</P></TD></TR><TR><TD VALIGN="TOP"><p>&nbsp;&nbsp;&nbsp;&nbsp;     Word attachment (UpsWDatt.msg)</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>2</P></TD><TD VALIGN="TOP"><P>5</P></TD></TR><TR><TD VALIGN="TOP"><p>&nbsp;&nbsp;&nbsp;&nbsp;     Embedded bitmap (UpsBMobj.msg)</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>2</P></TD><TD VALIGN="TOP"><P>5</P></TD></TR><TR><TD VALIGN="TOP"><p>&nbsp;&nbsp;&nbsp;&nbsp;     Embedded Excel object (UpsXLobj.msg)</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>2</P></TD><TD VALIGN="TOP"><P>10</P></TD></TR><TR><TD VALIGN="TOP"><P>Recipients per new or forwarded message</P></TD><TD VALIGN="TOP"><P>3</P></TD><TD VALIGN="TOP"><P>3</P></TD><TD VALIGN="TOP"><P>3</P></TD></TR><TR><TD VALIGN="TOP"><P>Add distribution list to sent mail</P></TD><TD VALIGN="TOP"><P>30%</P></TD><TD VALIGN="TOP"><P>30%</P></TD><TD VALIGN="TOP"><P>30%</P></TD></TR><TR><TD VALIGN="TOP"><P>Read new mail</P></TD><TD VALIGN="TOP"><P>12 times</P></TD><TD VALIGN="TOP"><P>12 times</P></TD><TD VALIGN="TOP"><P>12 times</P></TD></TR><TR><TD VALIGN="TOP"><p>&nbsp;&nbsp;&nbsp;&nbsp;Reply</P></TD><TD VALIGN="TOP"><P>5%</P></TD><TD VALIGN="TOP"><P>7%</P></TD><TD VALIGN="TOP"><P>15%</P></TD></TR><TR><TD VALIGN="TOP"><p>&nbsp;&nbsp;&nbsp;&nbsp;Reply All</P></TD><TD VALIGN="TOP"><P>3%</P></TD><TD VALIGN="TOP"><P>5%</P></TD><TD VALIGN="TOP"><P>7%</P></TD></TR><TR><TD VALIGN="TOP"><p>&nbsp;&nbsp;&nbsp;&nbsp;Forward</P></TD><TD VALIGN="TOP"><P>5%</P></TD><TD VALIGN="TOP"><P>7%</P></TD><TD VALIGN="TOP"><P>7%</P></TD></TR><TR><TD VALIGN="TOP"><p>&nbsp;&nbsp;&nbsp;&nbsp;Delete (move to Deleted Items folder)</P></TD><TD VALIGN="TOP"><P>40%</P></TD><TD VALIGN="TOP"><P>40%</P></TD><TD VALIGN="TOP"><P>40%</P></TD></TR><TR><TD VALIGN="TOP"><p>&nbsp;&nbsp;&nbsp;&nbsp;Move </P></TD><TD VALIGN="TOP"><P>20%</P></TD><TD VALIGN="TOP"><P>20%</P></TD><TD VALIGN="TOP"><P>20%</P></TD></TR><TR><TD VALIGN="TOP"><P>Load of attachments on read mail</P></TD><TD VALIGN="TOP"><P>25%</P></TD><TD VALIGN="TOP"><P>25%</P></TD><TD VALIGN="TOP"><P>25%</P></TD></TR><TR><TD VALIGN="TOP"><P>Maximum Inbox size (in messages)</P></TD><TD VALIGN="TOP"><P>20</P></TD><TD VALIGN="TOP"><P>125</P></TD><TD VALIGN="TOP"><P>250</P></TD></TR><TR><TD VALIGN="TOP"><P>Read old mail</P></TD><TD VALIGN="TOP"><P>5 times</P></TD><TD VALIGN="TOP"><P>15 times</P></TD><TD VALIGN="TOP"><P>20 times</P></TD></TR><TR><TD VALIGN="TOP"><P>Number of changes to schedule per day</P></TD><TD VALIGN="TOP"><P>1 </P></TD><TD VALIGN="TOP"><P>5 </P></TD><TD VALIGN="TOP"><P>10 </P></TD></TR><TR><TD VALIGN="TOP"><P>Empty Deleted Items folder</P></TD><TD VALIGN="TOP"><P>1 time</P></TD><TD VALIGN="TOP"><P>1 time</P></TD><TD VALIGN="TOP"><P>1 time</P></TD></TR><TR><TD VALIGN="TOP"><P>Messages sent per day (computed average)</P></TD><TD VALIGN="TOP"><P>4.7</P></TD><TD VALIGN="TOP"><P>14.2</P></TD><TD VALIGN="TOP"><P>30.7</P></TD></TR><TR><TD VALIGN="TOP"><P>Messages received per day (computed average)</P></TD><TD VALIGN="TOP"><P>22.9</P></TD><TD VALIGN="TOP"><P>66.3</P></TD><TD VALIGN="TOP"><P>118.9</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<H4 CLASS="h3"><A NAME="sec1"></A>Performance Log Parser</H4><P CLASS="t">The Load Simulator includes a useful command-line tool called Load Simulator Performance Log parser (Lslog.exe) for manipulating data from performance log files. Lslog.exe accepts one command-line parameter and one or more Load Simulator performance log files and prints its results to a standard output device. You can use output redirection (<B>&lt;</B> and <B>&gt;</B>) to save or print the results. For information about using Lslog.exe, type <B>lslog /? </B>at the command prompt. Lslog.exe supports the following command-line parameters.</P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="130pt" VALIGN="TOP"><COL WIDTH="217pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Option</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Description</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Truncate</P></TD><TD VALIGN="TOP"><P>Extracts a time window from a given log file and generates a new log file.</P></TD></TR><TR><TD VALIGN="TOP"><P>Merge</P></TD><TD VALIGN="TOP"><P>Combines two or more Load Simulator performance log files into one log file.</P></TD></TR><TR><TD VALIGN="TOP"><P>Answer</P></TD><TD VALIGN="TOP"><P>Generates nth percentile results for each type of action Load Simulator logs and a weighted average nth percentile result for all actions. By default, <I>n</I> is 95. The ninety-fifth percentile response time for a given action means that 95 percent of all response times recorded for that action were equal to or below that value. </P></TD></TR><TR><TD VALIGN="TOP"><P>Times</P></TD><TD VALIGN="TOP"><P>Lists the starting and ending time stamps for the given set of files. Time begins at 0.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<H4 CLASS="h3"><A NAME="sec2"></A>Determining Users Per Server</H4><P CLASS="t">To examine a server under load, you can run a simulated test and experiment with Performance Monitor on the server computer while the test is running. A more reliable and accurate method, however, is to generate a users per server (UPS) graph with data points from multiple load simulation tests. You can generate a UPS graph similar to the following graph produced by the Microsoft Exchange Server Performance Team.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<img src="xerk_h03.gif"></P>
<P></P>
<P CLASS="t">To generate a UPS graph, you must run the test several times, once for each data point. To generate accurate data for a users per server (UPS) graph, it's important to follow the same steps correctly every time you run a test. Your results should also document any mistakes you make while running a test.</P>
<P CLASS="t">You can use the data in the log files that is generated after each test to produce a weighted average ninety-fifth percentile response time score that represents the capability of the servers to support the number of users in the tests. The ninety-fifth percentile response time for a given action means that 95 percent of all response times recorded for that action were equal to or below that value. This type of measurement is typical of many forms of statistical analysis. After graphing this score versus the number of users run and defining the limit of acceptable response times, you can determine an approximate number of users supported by the test system.</P>
<P CLASS="t">You can obtain additional information from the graph as well. The shape of the curve can tell you how well the server will support variable load. For example, if the curve is relatively linear, adding a few users won't make a significant difference in response times.</P>
<P CLASS="t">To generate a single data point for a UPS graph, you must first run the test for a certain number of users and then generate a score from the test data.</P>
<H5 CLASS="h4"><A NAME="sec3"></A>Generating Performance Data</H5><P CLASS="t">The first step in generating a UPS graph is to generate a single data point for each test you run. You can gather additional data points by repeating the steps and increasing the number of users in each test.</P>
<P CLASS="t">The following are basic guidelines for generating a single data point on the UPS graph.</P>
<UL><LI>Verify that you're running the appropriate number of users for the current data point. For example, make sure that the message files and weights you defined in the <B>Messages</B> property pages match your user definitions.</LI><LI>If you're using multiple simulated clients, verify that they're all using the correct .sim file and have the same list of client computers. After you run the first test, you can verify that users are distributed correctly among the clients by checking the output log files for the names of the users that each client computer used.</LI><LI>The amount of physical RAM available on your Load Simulator client computers can affect the score. For accurate performance results, you should run no more than 100 simulated light or medium users on a 32 MB computer.</LI></UL><H5 CLASS="h4"><A NAME="sec4"></A>To generate data for a single data point</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Run the load simulation test for a specific number of users.</P>
<P>If you have multiple clients defined, be sure to start them all.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Stop the test after an appropriate amount of time, which is typically eight hours. This time period depends on how long it takes the system to reach a steady state for the type of users you've defined. The data the Microsoft Exchange Server Performance Team generated was based on five-hour and six-hour test runs.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Archive the results. Gather additional data points by repeating these steps and increasing the number of users in each test.</P>
<H5 CLASS="h4"><A NAME="sec5"></A>Generating a Score from Performance Data</H5><P CLASS="t">After you have generated data for a single data point, perform the following tasks to generate a score from raw Load Simulator performance log data. You must do this for each data point on the UPS graph.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Merge the log files from all of your simulated client computers using the LsLog <B>merge</B> command. This produces a single, combined performance log file for all simulated clients. You can also generate scores from a single control client and use the rest of the scores for verification of the control.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Extract the appropriate time window from the merged log file using the LsLog <B>truncate</B> command. For the data generated by the Microsoft Exchange Performance Team, the first two hours of data were removed from each six-hour test run.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Generate the ninety-fifth percentile response times and weighted average response time (the score) using the LsLog <B>answer</B> command.</P>
<P CLASS="t">For example, ClientA.log and ClientB.log are Load Simulator performance logs from a load simulation test that used two clients and ran for six hours. To generate the score, you would perform the following steps at the command prompt:</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Type <B>lslog merge</B> <I>ClientA.log</I>  <I>ClientB.log</I> <B>&gt;</B> <I>Merge.log</I></P>
<P>where <I>ClientA.log</I> and <I>ClientB.log</I> are log files generated on two client computers, and <I>Merge.log </I>is the merged log file.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Type <B>lslog truncate</B> <I>Merge.log</I>  <I>2 6</I> <B>&gt;</B> <I>Truncate.log</I></P>
<P>where <I>Merge.log</I> is the merged log file, <I>2 6</I> is a four-hour window between the first and the fifth hours, and <I>Truncate.log</I> is the truncated log file.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Type <B>lslog answer</B>  <I>Truncate.log</I> <B>&gt;</B> <I>Score.txt</I></P>
<P>where <I>Truncate.log</I> is the truncated log file and <I>Score.txt</I> is the file containing the score.</P>
<P CLASS="t"></P></BODY></HTML>
