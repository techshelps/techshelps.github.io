<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Mail Delivery Is Slow</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Mail Delivery Is Slow</H3><P CLASS="t">If the Microsoft Exchange Server computer appears to be delivering mail more slowly than normal, one or more of the following can be backlogged:</P>
<UL><LI>The message transfer agent (MTA) queue.</LI><LI>The information store (public or private) queue.</LI><LI>The Internet Mail Connector queue.</LI></UL><P CLASS="t">Ask the following questions to isolate the problem.</P>
<UL><LI>Is the server handling too many users?</LI><LI>Has the user activity changed? Are users sending more mail than usual, sending mail with large attachments, or sending to large distribution lists?</LI></UL><P CLASS="t">The following sections describe how to isolate the problem further.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>MTA Queue Is Backlogged</H4><P CLASS="t">Run the Performance Monitor Server Queues chart view to determine whether the MTA queue is the bottleneck. This shows how much traffic the MTA is transmitting to and from other servers, sites, or organizations. If the MTA is causing the mail to be delayed, the Work Queue Length counter will be high and the chart will be similar to the following illustration.</P>
<P><img src="xerk_i04.gif"></P>
<P CLASS="t">If the MTA queue is backlogged and there is high disk activity, the disk containing the databases is causing the problem. The queue can be backlogged because the MTA can't write to disk quickly enough.</P>
<H5 CLASS="h4"><A NAME="sec1"></A>Solutions</H5><P CLASS="t">Complete the following to improve the speed of message processing in the MTA queue:</P>
<UL><LI>Restrict the amount or type of mail users can send.</LI><LI>Add more disks to the stripe set.</LI><LI>Use multiple disk controllers.</LI><LI>Add one or more caching disk controllers that cache read and write operations.</LI></UL><H4 CLASS="h3"><A NAME="sec2"></A>Private Information Store Queue Is Backlogged</H4><P CLASS="t">Run the Performance Monitor Server Queues chart view to determine whether the private information store queue is the bottleneck. This shows how many messages the private information store is delivering to mailboxes. If the private information store is causing the mail to be delayed, your chart will look like the following illustration.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<img src="xerk_i03.gif"></P>
<H5 CLASS="h4"><A NAME="sec3"></A>Solutions</H5><P CLASS="t">Complete the following to improve the speed of message processing in the private information store queue:</P>
<UL><LI>Restrict the amount or type of mail users can send. For example, require users to send mail to public folders instead of distribution lists.</LI><LI>Move some or all mailboxes to another server.</LI><LI>Add more disks to the stripe set.</LI><LI>Use multiple disk controllers.</LI><LI>Add one or more caching disk controllers that cache read and write operations.</LI></UL><H4 CLASS="h3"><A NAME="sec4"></A>Public Information Store Queue Is Backlogged</H4><P CLASS="t">Run the Performance Monitor chart view Server Queues to determine whether the public information store queue is the bottleneck. This shows how many messages the public information store is delivering to public folders. For example, if it is taking longer than usual for public folder changes to be replicated throughout your system, the following counters will show increased activity:</P>
<UL><LI>MSExchangeIS Public: Send Queue Size</LI><LI>MSExchangeIS Public: Receive Queue Size</LI></UL><H5 CLASS="h4"><A NAME="sec5"></A>Solutions</H5><P CLASS="t">Complete the following to improve the speed of message processing in the public information store queue:</P>
<UL><LI>Configure public folder replication to occur at another time or less frequently.</LI><LI>Move some or all public folders to another server.</LI><LI>Add more disks to the stripe set.</LI><LI>Use multiple disk controllers.</LI><LI>Add one or more caching disk controllers that cache read and write operations.</LI></UL><H4 CLASS="h3"><A NAME="sec6"></A>Internet Mail Connector Queue Is Backlogged</H4><P CLASS="t">Run the following Performance Monitor chart views: Server IMC Traffic, Server IMC Statistics, and Server IMC Queues to determine whether the public information store queue is causing the problem. These chart views show how much traffic the Internet Mail Connector is transmitting to and from the Internet. For more information about troubleshooting the Internet Mail Connector, see "Internet Mail Connector" on the following page.</P>
<H5 CLASS="h4"><A NAME="sec7"></A>Solutions</H5><P CLASS="t">Complete the following to improve the Internet Mail Connector processing speed:</P>
<UL><LI>Restrict the amount or type of mail users can send to the Internet.</LI><LI>Move the Internet Mail Connector to another server.</LI><LI>Add more disks to the stripe set.</LI><LI>Use multiple disk controllers.</LI><LI>Add one or more caching disk controllers that cache read and write operations.</LI></UL></BODY></HTML>
