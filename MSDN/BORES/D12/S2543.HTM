<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Microsoft Exchange Server Is Slow</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Microsoft Exchange Server Is Slow</H3><P CLASS="t">If the Microsoft Exchange Server computer appears to be slower than normal, one or more of the following conditions probably exist:</P>
<UL><LI>CPU activity is high.</LI><LI>Disk activity is high.</LI><LI>Memory (RAM) usage is high.</LI></UL><P CLASS="t">To isolate the problem to one of these areas, ask the following questions:</P>
<UL><LI>Is the server supporting other applications?</LI><LI>Is the server handling too many users?</LI><LI>Has the user activity changed? Are users sending more mail than usual, sending mail with large attachments, or sending to large distribution lists?</LI></UL><P CLASS="t">The following sections describe how to isolate the problem further.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>CPU Activity Is High</H4><P CLASS="t">To determine whether the CPU is overworked, run the Performance Monitor Server Health chart view. If the CPU is the problem, your chart will be similar to the following illustration.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<img src="xerk_i07.gif"></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P CLASS="t">You can further isolate the problem by running the Performance Monitor Users chart view. If the Users Count counter is high, the server may be supporting more users than it's capable of supporting.</P>
<H5 CLASS="h4"><A NAME="sec1"></A>Solutions</H5><P CLASS="t">Complete the following to improve CPU use:</P>
<UL><LI>Restrict the amount or type of mail users can send.</LI><LI>Move Microsoft Exchange Server components or other applications to another server.</LI><LI>Move some or all mailboxes and public folder replicas to another server.</LI><LI>Add a faster processor.</LI><LI>If your server is a symmetric multiprocessor (SMP), add additional processors.</LI><LI>Optimize the way the system responds to foreground and background applications. In Control Panel, choose System, choose <B>Tasking</B>, and then select <B>Foreground and Background Applications Equally Responsive</B>.</LI><LI>Upgrade to a CPU that has more Level 2 (L2) caching, particularly if the server has less than 256K of L2 cache. Some systems allow up to 2 megabytes (MB) or more of L2 memory. L2 cache is faster than RAM.</LI></UL><H4 CLASS="h3"><A NAME="sec2"></A>Disk Activity Is High</H4><P CLASS="t">Run the Performance Monitor Server Health chart view to determine whether the disk is overworked. If the disk is causing the problem, the chart will be similar to the illustration on the following page.</P>
<P CLASS="t"><B>Note</B></P>
<P>If you haven't done so already, you should start the disk performance counters by typing <B>diskperf -y</B> at the command prompt. Then, add the LogicalDisk: Disk Bytes/sec and LogicalDisk: % Disk Time counters to the Microsoft Exchange Server Health chart view. These counters indicate the amount of data that is transferred to or from the disk during write or read operations. For more information about adding counters to charts, see your Windows NT Server documentation.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<img src="xerk_i06.gif"></P>
<P></P>
<P CLASS="t">Look at the disk and pages/sec. counters to determine which disk is the problem. If paging is high, the disk containing the pagefile is causing the problem.</P>
<H5 CLASS="h4"><A NAME="sec3"></A>Solutions</H5><P CLASS="t">Complete the following to improve disk use:</P>
<UL><LI>Move Microsoft Exchange Server transaction logs to another physical disk or another physical disk that is using a different disk controller than the disk containing the databases.</LI><LI>Restrict the amount or type of mail users can send.</LI><LI>Add more RAM and run Performance Optimizer to increase the database buffers.</LI><LI>Add more disks to the stripe set.</LI><LI>Use multiple disk controllers.</LI></UL><UL><LI>Add one or more caching disk controllers that cache read and write operations.</LI></UL><H4 CLASS="h3"><A NAME="sec4"></A>Memory Usage Is High</H4><P CLASS="t">Run the Performance Monitor Server Health chart view to determine whether the server is running out of memory. If RAM is causing the bottleneck, the pages/sec counter will be high (typically greater than 100 pages per second), and the chart will be similar to the following illustration.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<img src="xerk_i05.gif"></P>
<H5 CLASS="h4"><A NAME="sec5"></A>Solutions</H5><P CLASS="t">Complete the following to improve memory use:</P>
<UL><LI>Add more RAM.</LI><LI>Increase the size of your pagefile. In Control Panel, choose System, and then choose <B>Virtual Memory</B>. Under <B>Paging File Size For Selected Drive</B>, set a large pagefile. You can approximate the pagefile size by adding 125 MB to the amount of physical RAM available on your server. For example, if your server has 64 MB of RAM, you should set your pagefile size to 189 MB.</LI><LI>Move the pagefile to a separate physical disk.</LI><LI>Ensure Windows NT Server is optimized for network applications. In Control Panel, choose Network, choose <B>Server </B>in the list of installed network software, choose <B>Configure</B>, and then select <B>Maximize Throughput for Network Applications</B>.</LI><LI>Restrict the amount or type of mail users can send.</LI><LI>Move Microsoft Exchange Server components or other applications to another server.</LI><LI>If your server is paging excessively, adjust the size of the database buffer caches by typing <B>perfwiz -v </B>at the command prompt. You should reduce the size of the buffer cache by 10 to 30 percent.</LI></UL><UL><LI>Move some or all mailboxes and public folder replicas to another server.</LI></UL></BODY></HTML>
