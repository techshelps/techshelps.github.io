<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>New Client Installation</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">New Client Installation</H3><P CLASS="t">Most Microsoft Exchange Client files are stored in several compressed cabinet (.cab) files until they are installed. When Setup is run, the cabinet files are uncompressed and the files are copied to the client's disk or a network server. Knowing where the Microsoft Exchange Client files are stored when they are installed can be useful information if you need to troubleshoot a problem. For example, if the Microsoft Exchange Client won't start and it's running from a network server, the server containing the Microsoft Exchange Client files may be down. The location of the files depends on whether:</P>
<UL><LI>The Microsoft Exchange Client is run from the local disk or from a network share.</LI><LI>The operating system for the client computer is run from the local disk or from a network share.</LI></UL><P CLASS="t">The Microsoft Exchange Client installs configuration files, application files, and Messaging Application Programming Interface (MAPI) files. Configuration files (including .ini files, spelling DLLs that Microsoft Exchange Client and other applications share, and information about forms) are copied to and run from the Windows directory or the user's home directory on the local disk or another location on a network server where user files are stored. The following table describes where application files and MAPI files are copied to or run from depending on the Microsoft Exchange Client computer's configuration.</P>
<P CLASS="t"></P>

<TABLE COLS="6" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="94pt" VALIGN="TOP"><COL WIDTH="67pt" VALIGN="TOP"><COL WIDTH="66pt" VALIGN="TOP"><COL WIDTH="68pt" VALIGN="TOP"><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B></B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="th"><B>Application Files</B></P></TD><TD COLSPAN="4" VALIGN="TOP"><P CLASS="th"><B>MAPI System Files</B></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B></B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Copies to Exchange directory</P></TD><TD VALIGN="TOP"><P CLASS="tt">Runs from network share</P></TD><TD VALIGN="TOP"><P CLASS="tt">Copied to local Windows System directory </P></TD><TD VALIGN="TOP"><P CLASS="tt">Runs from Windows System directory on operating system network share</P></TD></TR><TR><TD VALIGN="TOP"><P>Local operating system and client</P></TD><TD VALIGN="TOP"><P>X</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>X </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Local operating system and shared client</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>X</P></TD><TD VALIGN="TOP"><P>X </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Shared operating system and local client</P></TD><TD VALIGN="TOP"><P>X</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>X</P></TD></TR><TR><TD VALIGN="TOP"><P>Shared operating system and client</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>X</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>X</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<H4 CLASS="h3"><A NAME="sec0"></A>Local Installation</H4><P CLASS="t">Setup uses the following process when installing the Microsoft Exchange Client to the local disk from a client installation point or floppy disks. If you encounter problems during Setup, you can use this information to help you troubleshoot. The operating system is running locally.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Reads the Setup.lst file in the client installation point to determine which files must be copied to the local disk. The Setup.lst file also instructs Setup to create a temporary, hidden directory for these files on the local disk that is called ~Mssetup.t\~Tmpjnk.t. The cabinet (.cab) files are uncompressed as they are copied to the temporary directory.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Reads the Exchng.stf file that was copied to the temporary directory and gathers the user's installation information. This file contains information such as the name of the user's organization and whether the installation is local or shared. By default, Setup obtains the user's name and organization from the registry or, depending on the operating system, the Win.ini file.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Copies files to the local disk as described in "New Client Installation" on the preceding page.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    Writes the Exchng.stf file to the Exchange directory. Edits the registry or Win.ini file to indicate the location of the Exchng.stf file. Deletes the temporary directory.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;5.    If a Default.prf file exists in the client installation point, Setup copies the file to the Windows directory and runs the automatic profile generator (Newprof.exe) to create a default profile. If a default profile does not exist, the Microsoft Exchange Client runs the Profile Wizard the first time the client is run.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Shared Installation</H4><P CLASS="t">To set up a network share and install Microsoft Exchange Client, you must first create the share by running Setup with the <B>/a</B> option. Then, you or the user can run Setup to install the Microsoft Exchange Client from the network share. If you encounter problems during Setup, you can use the following information to help you isolate the cause of the problem.</P>
<H5 CLASS="h4"><A NAME="sec2"></A>How a Network Share Is Created</H5><P CLASS="t">Setup /a creates a network share depending on whether the operating system on the computer setting up the share is running from a network share or from a local disk.</P>
<UL><LI>If the operating system is local, Setup copies all files from the client installation point to the new network share. Cabinet (.cab) files are uncompressed as they are copied to the new location.</LI><LI>If the operating system is shared, Setup copies all application files to the new network share. Cabinet (.cab) files are uncompressed as they are copied to the new location. Setup also installs MAPI system files to the Windows System directory on the operating system share.</LI></UL><H5 CLASS="h4"><A NAME="sec3"></A>How Microsoft Exchange Client Is Installed from a Network Share</H5><P CLASS="t">After you've created the network share, you can install Microsoft Exchange Client to run from the network share. The Setup process to install from a network share is similar to installing to a local disk, with the following differences:</P>
<UL><LI>Files required for Setup are not copied to a temporary directory as they are during a local installation.</LI><LI>Files are copied to directories on either the local disk or the network. For more information, see "New Client Installation" earlier in this chapter.</LI></UL></BODY></HTML>
