<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Profile Generator</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Using the Profile Generator</H3><P CLASS="t">The profile generator simplifies the process of creating Microsoft Exchange Client profiles for roving users. When you create profiles for each type of operating system, users can use any computer with any operating system and still have access to their mailbox by double-clicking the Microsoft Exchange Client icon. Users do not need to re-create their profiles.</P>
<P CLASS="t">You can use the profile generator from the command line or with the Profgen.ini file. If you do not specify command-line options, the profile generator looks for a file called Profgen.ini and reads options from that file.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Windows Version 3.<I>x</I> and Windows for Workgroups</H4><P CLASS="t">To support roving users who are using computers running Windows 3.<I>x</I> and Windows for Workgroups, Microsoft Exchange Clients should be running from a network share. During Setup, Messaging Application Programming Interface (MAPI) profiles are stored in the user's home directory or another location on a network file server.</P>
<P CLASS="t">You can assign logon scripts to users and make it easier for them to use the Microsoft Exchange Client on other computers in your organization. Logon scripts can connect users to their home directory when they log on to Windows and Windows for Workgroups. After a user is connected to the home directory and the Microsoft Exchange Client is started, the user's default profile is used.</P>
<P>When Microsoft Exchange Client is installed locally, it supports roving users. However, roving users must edit the Win.ini file.</P>
<H5 CLASS="h4"><A NAME="sec1"></A>To edit the Win.ini file</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Open the Win.ini file using a text editor.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Add the following line to the [MAPI] section.</P>
<P CLASS="spacing"><BR></P>
<PRE>ProfileDirectory16=&lt;path to messaging profile&gt;</PRE>
<P>Where <I>path to messaging profile </I>is the location of the user's messaging profile on the network.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Restart the computer.</P>
<H5 CLASS="h4"><A NAME="sec2"></A> <FONT FACE="symbol">Û</FONT>    To use the profile generator with Windows 3.<I>x</I> or Windows for Workgroups computers</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Copy Profgen.exe to C:\Exchange.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Copy Profgen.ini to C:\Windows.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    In the Profgen.ini file, edit the PathToExeFile and PathToPRFFile to point to the automatic profile generator (Newprof.exe) and .prf files respectively. Normally these entries should be as follows.</P>
<P>PathToExeFile=c:\exchange\newprof.exe</P>
<P>PathToPRFFile=h:\Win16.prf</P>
<P>where h:\ is the user's home directory on the server.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    Edit the Load= line in the Win.ini file as follows.</P>
<P CLASS="spacing"><BR></P>
<PRE>Load=c:\exchange\profgen.exe</PRE>
<p>&nbsp;&nbsp;&nbsp;&nbsp;5.    In the Win.ini file, ensure the following line is present in the [MAPI] section.</P>
<P CLASS="spacing"><BR></P>
<PRE>ProfileDirectory16=<I>home_directory</I>:</PRE>
<P>where <I>home_directory</I> is the user's home directory on the server.</P>
<H4 CLASS="h3"><A NAME="sec3"></A>Windows NT Workstation and Windows 95</H4><P CLASS="t">To support roving users who are using computers running Windows NT Workstation or Windows 95, you must store a user's MAPI profiles on the domain controller in a user's home domain. Storing the profiles in the user's home domain allows the users to access their profiles from any computer in your organization. If your roving users intend to use computers in other domains, you must permit the roving users to log on to multiple domains, and those domains must trust the user's home domain.</P>
<P CLASS="t">In addition, for Windows NT Workstation, ensure your roving users have user rights on the Windows NT Workstation computers they intend to use in your organization. If your roving users do not have user rights, they will be unable to log on.</P>
<P CLASS="t">To set up a roving user for Windows NT Workstation and Windows 95, you need to do the following:</P>
<UL><LI>Create a new user profile for the roving user.</LI></UL><UL><LI>Specify the path to the roving user's profile.</LI></UL><UL><LI>If the user is using computers from more than one domain, permit the roving user to log on to a different trusted domain.</LI></UL><H5 CLASS="h4"><A NAME="sec4"></A>To create a user profile for a Windows NT or Windows 95 roving user</H5><P CLASS="t">Before creating the profile, log on to your domain's primary domain controller and the Windows NT Server computer as domain administrator. Ensure the <B>Domain</B> box displays the domain you want the account for the roving user to belong to.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;1.    In the Administrative Tools program group, choose User Profile Editor.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    From the <B>File</B> menu, choose <B>New</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Choose the button next to the <B>Permitted to use profile</B> box.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<img src="xerk_c06.gif"></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    In the <B>Names</B> box, select the user account that should have permission to use this profile, or type the user name in the <B>Add Name</B> box and choose <B>Add</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<img src="xerk_c07.gif"></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;5.    Choose <B>OK</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;6.    From the <B>File</B> menu, choose <B>Save As File</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;7.    In the <B>Save File As Type</B> box, choose <B>Per-User Profile</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;8.    In the <B>Directories</B> box, choose the path for the profile.</P>
<P>You should store the profile in a shared user directory for security reasons. The profile can also be stored in a shared public directory.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;9.    In the <B>File Name </B>box, type a profile name, choose <B>OK</B>, and then close the <B>User Profile Editor </B>dialog box.</P>
<P CLASS="t">Before Windows NT roving users use Microsoft Exchange Server for the first time, you must verify their copy of Microsoft Exchange Server points to the network directory where the user profile is located. If it does not, change the working directory.</P>
<H5 CLASS="h4"><A NAME="sec5"></A>To change the working directory for the Microsoft Exchange Client on Windows NT</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    In the<B> </B>Microsoft Exchange program group of the Microsoft Exchange Client computer, choose <B>Microsoft Exchange</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    From the <B>File</B> menu, choose <B>Properties.</B></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    In the <B>Working Directory</B> box, type the path of the directory where the roving user's profile is located.</P>
<H5 CLASS="h4"><A NAME="sec6"></A> <FONT FACE="symbol">Û</FONT>    To specify the path to a Windows NT or Windows 95 roving user's profile</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    In the Administrative Tools program group, choose<B> </B>User Manager for Domains.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Double-click the appropriate user account.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Choose <B>Profile</B>.</P>
<P><img src="xerk_c01.gif"></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    In the <B>User Profile Path</B> box, type the path to the profile (.usr) file you created earlier.</P>
<P><img src="xerk_c02.gif"></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;5.    In the <B>Home Directory</B> box, select the <B>Connect To</B> option, and type the drive letter and path to the home server where the roving user's profile is located.</P>
<P CLASS="t">Before Windows 95 roving users use Microsoft Exchange Server for the first time, you must enable multiple users to customize preferences and desktop settings.</P>
<P CLASS="t"><B>Note</B></P>
<P>Windows 95 profiles can be stored on any type of server, including a Novell NetWare server.</P>
<H5 CLASS="h4"><A NAME="sec7"></A>To permit a Windows NT or Windows 95 roving user to log on to a different domain</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    In the Administrative Tools program group, choose User Manager for Domains.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    From the <B>Policies</B> menu, choose<B> User Rights</B>.</P>
<P><img src="xerk_c03.gif"></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    In the <B>Right</B> box, select <B>Log on locally</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    Select the <B>Show Advanced User Rights</B> box and choose <B>Add</B>.</P>
<P><img src="xerk_c04.gif"></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;5.    In the<B> List Names From</B> box, select the domain you want to add the roving user account to.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;6.    In the <B>Names</B> box, select the user account for the roving user, choose <B>Add</B>, and then choose <B>OK</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;7.    In the <B>User Rights Policy </B>dialog box, choose <B>OK</B>, and then close the <B>User Manager for Domains</B> dialog box.</P>
<H5 CLASS="h4"><A NAME="sec8"></A>To enable multiple users of a Microsoft Exchange Client computer to personalize their settings on Windows 95</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    In the Control Panel of the Microsoft Exchange Client computer, choose Passwords.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Select the <B>User Profiles </B>tab.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Select <B>Users can customize their preferences and desktop settings</B>.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<img src="xerk_c05.gif"></P>
<P CLASS="t"></P>
<H5 CLASS="h4"><A NAME="sec9"></A>To use the profile generator with Windows NT Workstation</H5><P>Add the following line to the Windows NT Workstation domain logon script.</P>
<P>\\Server Name\Share Name\PROFGEN.EXE  C:\EXCHANGE\NEWPROF.EXE -P H:\NTCLIENT.PRF</P>
<P>where H:\ is the user's home directory.</P>
<P CLASS="t">The automatic profile generator (Newprof.exe) must be located in the C:\Exchange directory. The profile generator (Profgen.exe) can be located on the local computer or the server.</P>
<H5 CLASS="h4"><A NAME="sec10"></A>To use the profile generator with Windows 95</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Copy Profgen.exe to C:\Exchange.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Copy Profgen.ini to C:\Windows.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    In the Profgen.ini file, edit the PathToExeFile and PathToPRFFile entries to point to automatic profile generator (Newprof.exe) and .prf files, respectively. Normally these entries should be as follows.</P>
<P CLASS="spacing"><BR></P>
<PRE>PathToExeFile=c:\exchange\newprof.exe
PathToPRFFile=h:\Win95.prf</PRE>
<P>where h:\ is the user's home directory on the server.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    In the Win.ini file, edit the Load= line as follows.</P>
<P CLASS="spacing"><BR></P>
<PRE>Load=c:\exchange\profgen.exe</PRE>
<H4 CLASS="h3"><A NAME="sec11"></A>MS-DOS</H4><P CLASS="t">To support a roving user on MS-DOS, you must store the profile in the user's home directory on a file server, and the Microsoft Exchange Client .exe file must be on a network share. When users run Workstation Setup from the network share, they must specify the home directory where they want to store their profile.</P>
<P CLASS="t">Assign logon scripts to users to make it easier for them to use the Microsoft Exchange Client on other computers in your organization. Logon scripts can automatically connect users to their home directory and the network share when they log on to MS-DOS. When a user is connected to the home directory and the Microsoft Exchange Client is started, the user's default profile is used.</P>
<H5 CLASS="h4"><A NAME="sec12"></A>To modify the logon scripts to connect users to their home directory</H5><P> <FONT FACE="symbol">·</FONT>    Modify logon scripts to include the following lines.</P>
<P CLASS="spacing"><BR></P>
<PRE>set EXCHANGE=&lt;home directory path&gt;
set RPC_BINDING_ORDER=ncalrpc,ncacn_np,ncacn_spx,ncacn_ip_tcp,netbios</PRE>
<P CLASS="t"><B>Note</B></P>
<P>If the user's logon script has been modified to set the home directory and the remote procedure call (RPC) binding order, the user should not modify the Autoexec.bat file during Setup. Otherwise, the information in the logon script and the Autoexec.bat file can conflict.</P></BODY></HTML>
