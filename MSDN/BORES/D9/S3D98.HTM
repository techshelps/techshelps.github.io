<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Deploying Windows 95 with SMS</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Deploying Windows&nbsp;95 with SMS</H3><P CLASS="t">Before you deploy the Windows&nbsp;95 operating system to SMS clients:</P>
<UL><LI>Use queries to identify which clients have the memory, disk space, and microprocessor required to run Windows&nbsp;95.</LI><LI>Use the query results to create a machine group that contains all the computers that you want to upgrade to Windows&nbsp;95.</LI><LI>Run ScanDisk on each client that will be upgraded.</LI><LI>Create a source directory for the Windows&nbsp;95 operating system files.</LI><LI>Create a package and a job to distribute Windows&nbsp;95.</LI><LI>Run a test to identify any issues in deploying Windows&nbsp;95 on your network.</LI></UL><P CLASS="t">For information about queries and machine groups, see the SMS version 1.2 <I>Administrator's Guide</I>.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Running ScanDisk</H4><P CLASS="t">The SCANDISK.EXE program checks for lost chains and clusters on the hard drives of the target clients. Because the Windows&nbsp;95 Setup program runs ScanDisk and will fail if it detects a problem, you should run ScanDisk before installing Windows&nbsp;95 on SMS clients.</P>
<P CLASS="t">You can use SCANDISK.PDF to distribute and run the ScanDisk program on clients that you plan to upgrade. </P>
<P CLASS="t"><B>Note</B></P>
<P>If the target client is running Windows for Workgroups version 3.11, use the version of ScanDisk created for MS­DOS version 6.22 rather than the one shipped on the Microsoft Windows&nbsp;95 compact disc.</P>
<P CLASS="t">For information about using ScanDisk, see the <I>Microsoft Windows&nbsp;95 Resource Kit</I>.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Preparing the Distribution Server</H4><P CLASS="t">Create a source directory on the distribution server for the Windows&nbsp;95 operating system files, and share the directory, using a share name that is identical to the directory name. Then copy all relevant files from the Windows&nbsp;95 compact disc to the new source directory There are two recommended ways to copy the files:</P>
<UL><LI>Use the NETSETUP program (see the <I>Microsoft Windows 95 Resource Kit</I> for details) to decompress and copy the necessary files to the source directory. This option will give you maximum flexibility in customizing your installed components. You should use the Netsetup option if you want to create a setup directory that you can use to install shared Windows&nbsp;95 configurations, where clients run Windows&nbsp;95 across the network.</LI><LI>Copy the compressed files directly from the WIN95 directory on the compact disc to the source directory. This method saves disk space, but you lose flexibility in customizing installation options.</LI></UL><P CLASS="t">From the site server, copy the following files from the LOGON.SRV\MSTEST directory to the source directory:</P>
<UL><LI>WIN95.INF (for automated installs)</LI><LI>WIN95MIN.INF (for manual installs)</LI><LI>DOS2W95.EXE (to set up MS-DOS clients)</LI><LI>WIN2W95.EXE (to set up Windows clients)</LI></UL><P CLASS="t">Modify the WIN95.INF and WIN95MIN.INF files (Windows&nbsp;95 setup script files that follow the MSBATCH.INF format) as necessary. The WIN95MIN.INF file is used in manual installs where the user provides or verifies installation choices. The WIN95.INF file is used for automated installations of Windows&nbsp;95. The WIN95.INF file supports both Microsoft Networks and Netware Networks by default. It also sets clients to validate Windows&nbsp;NT domain logons. You may need to make appropriate changes to the WIN95.INF file to reflect time zone and custom network or installation settings. Be sure to add your Windows&nbsp;95 product ID to both .INF files.</P>
<P CLASS="t">The automated Windows&nbsp;95 setup process attempts to determine specific client information when possible. However, you might need to modify the WIN95.INF file for your network attributes or machine group configuration. In particular, you will probably need to modify the product ID and time zone. Eeview the default network client configuration and logon domain settings and add information to the file to override default installation settings. See the <I>Microsoft Windows&nbsp;95 Resource Kit</I> for information about modifying an .INF file for various supported configurations.</P>
<P CLASS="t">The Windows&nbsp;95 installation process requires the User Name, Domain/Workgroup Name and Computer Name for the targeted client. In the provided WIN95.INF template, these values have been left blank. These values can be provided in one of three ways.</P>
<UL><LI>Edit the WIN95.INF file to provide one or more of the missing values.</LI><LI>Allow the installation program to fill in the blank items using values in either the client's SMS.INI file or the SYSTEM.INI file. The installation program searches for the User Name in the following manner:

<UL><LI>Looks in the input Windows 95 script file (usually WIN95.INF).</LI><LI>Looks in the SMS.INI on the client.</LI><LI>Looks in the MSBATCH.INF file in the Windows directory (Windows&nbsp;95 clients will have this file from their last installation).</LI><LI>Looks in the SERIALNO.INI file in the Windows directory (Windows for Workgroup clients will have this file from their last installation).</LI></UL></LI></UL><P>If a User Name cannot be located, the installation program uses the Computer&nbsp;Name as specified in the .INF or the MachineName field in the SMS.INI file. If the client is running NetWare, the installation program uses the logon name of the current user.</P>
<UL><LI>Allow the installation program to prompt the user during the installation process.</LI></UL><H4 CLASS="h3"><A NAME="sec2"></A>Creating a Package to Install Windows&nbsp;95</H4><P CLASS="t">Use an SMS package to install Windows&nbsp;95 on the target clients by running the setup command on each client. Make sure this package points to the proper network location for the Windows&nbsp;95 source code, including the appropriate .INF files, whether the standard MSBATCH.INF or another version of this file is used.</P>
<H5 CLASS="h4"><A NAME="sec3"></A>To create a package to install Windows&nbsp;95</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Create a source directory for the required installation files and share the directory.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    In the SMS&nbsp;Administrator, open the Packages window. From the File menu, choose New.</P>
<P>The Package Properties dialog box appears.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Choose Import.</P>
<P>The File Browser dialog box appears.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    Select the \\<I>servername</I>\<I>sharename</I>\IMPORT.SRC\ENU\WIN95.PDF file and choose OK.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;5.    Choose Workstations.</P>
<P>The Setup Package for Workstations dialog box appears.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;6.    In the Source Directory box, enter the full UNC name for the source directory (in this case, the directory with the Windows&nbsp;95 source files), and choose OK.</P>
<P>If you choose to browse through the list of files, edit the resulting path so that it shows the UNC name (which would begin with \\<I>servername</I>\<I>sharename</I>) rather than the relative name (which would begin with the drive letter you have assigned to the server during the current session).</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;7.    Choose OK in all open dialog boxes.</P>
<P>When the package has been created and appears in the Packages window, you can use it to create a job.</P>
<H4 CLASS="h3"><A NAME="sec4"></A>Running the Package on Clients</H4><P CLASS="t">Since certain warning and error conditions can pause or terminate automated installations of Windows&nbsp;95, observe the following guidelines when using SMS to install Windows&nbsp;95:</P>
<UL><LI>Ensure that all applications have been closed before starting the automated installation. If an application is open, the installation will pause until the user closes the application.</LI><LI>When you upgrade a client to MS-DOS 6.22, the MS-DOS setup program archives the previous MS-DOS directory as \OLD_DOS<I>x</I> (where <I>x</I> is a number). If the target computer has this directory, the Windows&nbsp;95 installation will pause and ask the user if this directory should be deleted. If you want to automatically install Windows&nbsp;95, make sure that the target clients do not have this directory. Use SMS to query for computers with an old MS-DOS directory and to delete these directories.</LI></UL><P CLASS="t">For the command in the package to be run on the target clients, you must create a Run Command on Workstation job. You can do this by dragging the package to the Machine Group in the site and filling in the resulting Job Details dialog box.</P>
<P CLASS="t">Once a job is distributed, the associated instructions are kept in the instruction file on each server until the job expires or is canceled, even after the job has completed on all target clients. This consumes about 3K per job per logon server. Use the Expires After setting in the Job Details dialog box to specify an expiration date that is realistic for your organization and for the job.</P>
<H4 CLASS="h3"><A NAME="sec5"></A>Testing the Windows&nbsp;95 Deployment</H4><P CLASS="t">After you run the test, evaluate the distribution results on the upgraded clients. Note that a Complete job status does not necessarily indicate successful deployment of Windows&nbsp;95. You must perform additional analysis to determine the results of deployment:</P>
<UL><LI>Make sure that the SMS client inventory has been updated for all clients in the target group.</LI><LI>Use the following queries to determine whether the upgrade succeeded.</LI></UL><P>The following query identifies successful upgrades:</P>
<P CLASS="spacing"><BR></P>
<PRE>Microsoft|Operating_System|1.0:Operating System Name is 'MS Windows&nbsp;95' </PRE>
<P>The following query identifies unsuccessful upgrades:</P>
<P CLASS="spacing"><BR></P>
<PRE>Microsoft|Operating_System|1.0:Operating System Name is 'MS DOS' <BR>AND <BR>Microsoft|Operating_System|1.0:Version is not '7.00'</PRE>
<UL><LI>Examine the computers that were not successfully upgraded on a case-by-case basis. If you marked the Inventory This Package check box in the Setup Package for Inventory dialog box when you created the package, you can examine a copy of the setup log file created on each target computer. Study this file to determine the cause of any problems. For example, there might have been changes in available disk space or in the availability of some other resource between the time the computer was added to the target group and the time the upgrade was performed.</LI><LI>Test the clients that were successfully upgraded to ensure that the configuration you specified works as expected on these computers. See the following section for details.</LI><LI>Check the details of job events to troubleshoot problems. For example, if a job has failed because the .INF file was not available where it was expected, this would be reported in the job events.</LI><LI>Determine whether any individual clients, which may have failed during the Windows&nbsp;95 upgrade process, are no longer operational.</LI></UL><P>Clients that are no longer operational are not updated in the SMS inventory. You might choose to perform the inventory at more frequent intervals before deployment to make sure that only currently operational computers are targeted. In some cases, you might want to develop an SMS query to identify clients that have not had their inventory updated. </P>
<UL><LI>Determine whether a faulty hardware component caused a failure of the Windows&nbsp;95 upgrade process.</LI></UL><H4 CLASS="h3"><A NAME="sec6"></A>Testing the Installation</H4><P CLASS="t">Test the upgraded clients to make sure that the configuration you have installed will serve your organization as expected. </P>
<P CLASS="t">On a client that has been upgraded to Windows&nbsp;95:</P>
<UL><LI>Connect to and browse through the network.</LI><LI>Set up a printer and test printing to local and network printers.</LI><LI>Open, run, and close applications on both the client and the server.</LI><LI>Shut down completely.</LI></UL><P CLASS="t">Test all mission-critical applications for proper functioning. If you encounter problems, try removing related features from the proposed configuration as a solution. Document any changes made to the original configuration. </P>
<P CLASS="t">If the preferred client configuration works as expected, you may want to conduct additional testing of the optional software features and components in Windows&nbsp;95. This can help you determine whether you are running Windows&nbsp;95 optimally. For this kind of testing, conduct side-by-side evaluations on two clients, changing individual features on each one, to determine the following:</P>
<UL><LI>Performance in terms of responsiveness and throughput</LI><LI>Ease of use</LI><LI>Stability</LI><LI>Compatibility</LI><LI>Functionality</LI></UL><H5 CLASS="h4"><A NAME="sec7"></A>Testing Installations on Novell Networks</H5><P CLASS="t">To evaluate network client software for Novell NetWare, run your network performance tests in the following configurations:</P>
<UL><LI>Windows&nbsp;95 installed with an existing 16-bit, Novell-supplied client (NETX), using ODI drivers.</LI><LI>Windows&nbsp;95 added to an existing installation of Windows 3.1 and NetWare, using Client for NetWare Networks and protected-mode networking support components (NDIS adapter drivers).</LI><LI>Windows&nbsp;95 as a new installation using all protected-mode components, including both Client for NetWare Networks and Client for Microsoft Networks, plus peer resource sharing support.</LI></UL><P CLASS="t">Perform several common tasks, such as connecting to the network and administering a remote NetWare server, to test for ease of use. Similarly, you'll want to run any business-specific NetWare applications under Microsoft Client for NetWare Networks to make sure that they run compatibly. Any stability issues should become apparent during this testing.</P>
<P CLASS="t">When you have identified a configuration that performs well during testing, test the same configuration on clients with different types of hardware configurations.</P></BODY></HTML>
