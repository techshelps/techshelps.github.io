<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SETLS Program</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">SETLS Program</H3><P CLASS="t">The SMS logon script calls the SETLS program to connect to an SMS logon server. SETLS uses information in the SMSLS.INI file to select an SMS logon server from which to run the SMS Client Setup and Inventory Agent programs for a client. SETLS builds a UNC name corresponding to the <I>platform</I>.BIN directory on the SMS logon server (\\<I>servername</I>\SMS_SHR\<I>platform</I>.BIN) and makes the connection. (SETLS will, when necessary, use a path.) Then the client is added to the computer inventory for the SMS logon server's domain. If no SMSLS.INI file is present, SETLS runs SMS programs from the SMS logon server where the SMSLS batch file was run.</P>
<P CLASS="t">SMS uses the Windows&nbsp;NT Directory Replicator service to place SMSLS.BAT, SMSLS.INI, and SETLS on the NETLOGON share of all SMS logon servers running Windows&nbsp;NT and LAN&nbsp;Manager.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Versions of SETLS</H4><P CLASS="t">To support computers running Windows&nbsp;NT, Windows version&nbsp;3.1, Windows for Workgroups, Windows&nbsp;95, MS-DOS, and OS/2, there are three versions of SETLS.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="139pt" VALIGN="TOP"><COL WIDTH="83pt" VALIGN="TOP"><COL WIDTH="124pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Client operating system</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>SETLS program</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Directory</B></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Windows&nbsp;NT</P></TD><TD VALIGN="TOP"><P CLASS="tt">SETLS32.EXE</P></TD><TD VALIGN="TOP"><P CLASS="tt">LOGON.SRV\<I>platform</I>.BIN</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">MS-DOS, Windows version&nbsp;3.1, Windows for Workgroups, and Windows&nbsp;95</P></TD><TD VALIGN="TOP"><P CLASS="tt">SETLS16.EXE</P></TD><TD VALIGN="TOP"><P CLASS="tt">LOGON.SRV\X86.BIN</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">OS/2</P></TD><TD VALIGN="TOP"><P CLASS="tt">SETLSOS2.EXE</P></TD><TD VALIGN="TOP"><P CLASS="tt">LOGON.SRV\X86.BIN</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">When you select the Automatically Configure Workstation Logon Scripts option in the Clients dialog box in Site Properties, the Site Configuration Manager copies the SETLS programs (and other SMS components) to the SCRIPTS directory in the REPL$ share on the primary domain controllers in LAN&nbsp;Manager and Windows&nbsp;NT domains. Depending on the microprocessor types supported in the site, the SETLS programs for the specific microprocessor types are copied to the corresponding directory: X86.BIN (x86 microprocessors), ALPHA.BIN (Alpha microprocessors), and MIPS.BIN (MIPS microprocessors).</P>
<P CLASS="t">SETLS includes command line options for connecting a logical drive to a network server, deleting an SMS logon server connection, and running a program file located on a network server.</P>
<H5 CLASS="h4"><A NAME="sec1"></A>Command Line Options</H5><P CLASS="t">The SETLS command line options are:</P>
<P CLASS="t">{<B>setls16</B> | <B>setls32</B> | <B>setlsos2</B>} [<B>/m:C</B>] [<B>/d:</B><I>drive</I>] [<B>/dr:</B><I>driverange</I>] [<B>/sh:</B><I>sharename</I>] [<B>/i</B>[<B>:</B><I>inifile</I>]] [<B>/v</B>[<B>:on</B>]]</P>
<P CLASS="t">{<B>setls16</B> | <B>setls32</B> | <B>setlsos2</B>} [/<B>m:D</B>] [<B>/d:</B><I>drive</I>] [<B>/v</B>[<B>:on</B>]]</P>
<P CLASS="t">{<B>setls16</B> | <B>setls32</B> | <B>setlsos2</B>} [/<B>m:E</B>] [<B>/sh:</B><I>sharename</I>] [/<B>p</B>:<I>programfile</I>] [/<B>pa:</B><I>argument</I> [...]] [<B>/sn</B>] [<B>/v</B>[<B>:on</B>]] [<B>/i</B>[<B>:</B><I>inifile</I>]] </P>
<P CLASS="term1"><B>/<B>m:C</B></B></P>
<P CLASS="dt1">Makes a network connection using a logical drive letter.</P>
<P CLASS="term1"><B><B>/m:D </B></B></P>
<P CLASS="dt1">Deletes a network connection that uses a logical drive letter.</P>
<P CLASS="term1"><B><B>/m:E </B></B></P>
<P CLASS="dt1">Runs a program file located on a remote server without making a logical drive network connection (the default is to connect).</P>
<P CLASS="term1"><B><B>/d:</B><I>drive</I> </B></P>
<P CLASS="dt1">Specifies a particular drive letter (the default is the next available drive letter).</P>
<P CLASS="term1"><B>/<B>dr</B>:<I>driverange</I></B></P>
<P CLASS="dt1">Limits the search for the next available drive.</P>
<P CLASS="term1"><B>/<B>sh</B>:<I>sharename</I> </B></P>
<P>Specifies the share to connect to. The default is SMS_SHR.</P>
<P CLASS="term1"><B><B>/i:</B>[:<I>inifile</I>]</B></P>
<P CLASS="dt1">Names the initialization file to use. The default is SMSLS.INI.</P>
<P CLASS="term1"><B><B>/v</B>[<B>:on</B>]</B></P>
<P CLASS="dt1">Specifies verbose mode for output messages. The default is off.</P>
<P CLASS="term1"><B>/<B>p</B>:<I>programfile</I></B></P>
<P CLASS="dt1"> Is a file name or relative path to an .EXE or a .COM file.</P>
<P CLASS="term1"><B>/<B>pa</B>:<I>argument </I></B></P>
<P CLASS="dt1">Passes an argument to the program when it runs. If you want to pass the UNC path of the SMS logon server, specify <B>%%SMS_unc%%</B> as the value for this argument. The SETLS program replaces this with the UNC path to the SMS_SHR share of the SMS logon server.</P>
<P CLASS="term1"><B><B>/sn</B></B></P>
<P CLASS="dt1">Indicates that the specified program should not be run on a slow network.</P></BODY></HTML>
