<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Events</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Using Events</H3><P CLASS="t">If an SMS service or component encounters an error while processing a job, it reports an SMS system event to both the Windows&nbsp;NT event log and the SMS event database. You should frequently check the SMS&nbsp;Administrator Events window for errors or warnings. If possible, fix conditions that are generating warnings as well as those generating error conditions. Periodically delete old or duplicate events (if appropriate) to minimize the number of events in the event log. The following dialog box shows the Events window in the SMS&nbsp;Administrator:</P>
<P><img src="srk_g04.gif"></P>
<H4 CLASS="h3"><A NAME="sec0"></A>Event Attributes</H4><P CLASS="t">Event attributes are reported in the Event Detail window for each event. The Event Detail window for event number 225 follows:</P>
<P><img src="srk_g05.gif"></P>
<P CLASS="t">Events in the Event Detail window have the following attributes:</P>
<P CLASS="term1"><B><B>SMSID</B></B></P>
<P CLASS="dt1">The SMS ID for the computer where the event occurred.</P>
<P CLASS="term1"><B><B>MachineName</B></B></P>
<P CLASS="dt1">The network name of the computer where the event occurred.</P>
<P CLASS="term1"><B><B>Time</B></B></P>
<P CLASS="dt1">The date and time when the event occurred. Time is displayed according to the date and time settings on the computer where the error occurred.</P>
<P CLASS="term1"><B><B>EventID</B></B></P>
<P CLASS="dt1">The identification number that specifies the type of event.</P>
<P CLASS="term1"><B><B>WarningLevel</B></B></P>
<P CLASS="dt1">A number that specifies the severity of the event: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="76pt" VALIGN="TOP"><COL WIDTH="257pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>WarningLevel</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Severity</B></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">0</P></TD><TD VALIGN="TOP"><P CLASS="tt">Success</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">1</P></TD><TD VALIGN="TOP"><P CLASS="tt">Informational</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">2</P></TD><TD VALIGN="TOP"><P CLASS="tt">Warning</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">3</P></TD><TD VALIGN="TOP"><P CLASS="tt">Error</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="term1"><B><B>EventModule</B></B></P>
<P CLASS="dt1">The source of the event. This is the text displayed as the Source for the event in the Windows&nbsp;NT Application Log. For most SMS events, the source is SMS. It is also the registry key used to find the location of the DLL that contains the message strings used to display the event's details within the Windows&nbsp;NT Event Viewer.</P>
<P CLASS="term1"><B><B>EventType</B></B></P>
<P CLASS="dt1">A string that identifies the type of event.</P>
<P CLASS="term1"><B><B>Component</B></B></P>
<P CLASS="dt1">The name of the service or program that logged the event. For the SMS Executive service, Component may display the SMS Executive thread that logged the event.</P>
<P CLASS="t"><B>Note</B></P>
<P>For Run Command On Workstation jobs, if the job fails to run at a client, the failing component is reported as the Despooler, not as Package Command Manager. </P>
<P CLASS="t">Depending on the type of event and the component that reported the event, the event may also display one of the following attributes:</P>
<P CLASS="term1"><B><B>JobID</B></B></P>
<P CLASS="dt1">If an event affects the processing of a job, this attribute specifies the job ID of the job that was affected.</P>
<P CLASS="term1"><B><B>JobDestination</B></B></P>
<P CLASS="dt1">If an event affects the processing of a job, this attribute is the specific destination site (within the Job Target for the job) that was affected.</P>
<P CLASS="term1"><B><B>PackageID</B></B></P>
<P CLASS="dt1">If an event affects the processing of a job, this attribute is the package ID for the job's package.</P>
<P CLASS="term1"><B><B>RequestID</B></B></P>
<P CLASS="dt1">If an event affects the sending of a job, this attribute specifies the send request that was affected.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Viewing Events</H4><P CLASS="t">By default, the Events window displays the main attributes for each event. You can also choose how the events and attributes are displayed in the Events window:</P>
<UL><LI>To choose the attributes that are displayed for each event, from the View menu, choose Partial Details.</LI><LI>To filter the events so that only the events that meet the criteria you want are displayed in the Events window, from the View menu, choose Filter.</LI><LI>To sort the events, from the View menu, choose Sort.</LI></UL><P CLASS="t">You can also change the attributes that are displayed in the Events windows by modifying the default query result format for the SMSEvents architecture, which is used to determine the attributes displayed in the Events window.</P>
<P CLASS="t">You can view events individually by opening the Event Detail dialog box for the event whose details you want to view. The Event Detail dialog box displays the main attributes of the event and provides a full description of the event.</P>
<H4 CLASS="h3"><A NAME="sec2"></A>Using Events in Queries and Alerts</H4><P CLASS="t">Events logged as event MIF files are stored as objects with the Event architecture in the database. As with other objects stored in the database (such as computers and user groups), you can create and run queries against the Event architecture to find the events you want to view. You can also run an Ad Hoc query from the Events window by double-clicking the window panel on the Events window.</P>
<P CLASS="t">As with any other query, you can use a query on events to trigger an alert. For example, you could have a query that searches for events with a value of 3 for WarningLevel. You could then specify that query in an alert. When the alert condition evaluates to true, the alert action is triggered. The alert can send a message, run a command, or log an SMS event.</P>
<H5 CLASS="h4"><A NAME="sec3"></A>To use queries to find events that are related to a specific job</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    In the SMS&nbsp;Administrator, open the Jobs window and find the job ID for the job you want to query.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    Open the Queries window and, from the File menu, choose New to create a new query.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    In the Query Name and Comment boxes, type a query name and comment, respectively.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    In the Architecture box, select the SMSEvent.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;5.    Choose Add And.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;6.    In the Query Expression Properties dialog box, select the line with attribute JobID.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;7.    Enter the value of the job ID for the job. (Make sure that the Expression Operator is set to is.)</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;8.    Save the query.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;9.    Run the query. </P>
<P CLASS="t">The events relating to the job are displayed in the Query Results window.</P>
<P CLASS="t">Using this query, you could also create an alert that triggers an action when any events containing the job ID are found in the SMS Event database. </P>
<P CLASS="t">For more information about using events and alerts, see the SMS version 1.2 <I>Administrator's Guide</I>.</P></BODY></HTML>
