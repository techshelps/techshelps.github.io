<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Site Server Services</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Site Server Services</H3><P CLASS="t">There are several SMS services that can use Windows&nbsp;NT&reg; user accounts and passwords and can be managed through the Windows&nbsp;NT Control Panel. By default, the following services run on all SMS site servers:</P>
<UL><LI>Hierarchy Manager</LI><LI>Site Configuration Manager</LI><LI>Inventory Agent</LI><LI>Package Command Manager for Windows&nbsp;NT</LI><LI>Client Configuration Manager</LI><LI>SMS Executive</LI></UL><P CLASS="t">Other SMS services include Bootstrap, SNA Receiver, SNMP Trap Receiver, and Inventory Agent for OS/2. Bootstrap runs temporarily on the secondary site servers during SMS installation. The Inventory Agent for OS/2 runs on LAN&nbsp;Manager for OS/2 logon servers.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Hierarchy Manager</H4><P CLASS="t">The Hierarchy Manager monitors the site database for changes to the configuration for a site or any of its subsites. If the Hierarchy Manager detects a change in a site's proposed configuration, it creates a site control file that contains all proposed configurations for a site and sends it to the site. If you make site configuration changes using the SMS&nbsp;Administrator, the Hierarchy Manager must be running so it can create a site control file to make changes to that site. The Hierarchy Manager exists only in primary sites.</P>
<P CLASS="t">If changes are proposed at the primary site, its control file passes directly to the Site Configuration Manager for that site, to record the changes.</P>
<P CLASS="t">The Hierarchy Manager includes several commands for diagnosing and fixing sites. You can use PREINST.EXE, in the SMS\SITE.SRV\<I>platform</I>.BIN directory, to pass commands to the Hierarchy Manager while it is running. The syntax for PREINST.EXE is as follows:</P>
<P CLASS="t"><B>preinst</B> <I>options</I></P>
<P CLASS="t">Where <I>options</I> are:</P>
<P CLASS="term1"><B><B>/DUMP</B></B></P>
<P CLASS="dt1">Writes site control images for all sites to the SMS\SITE.SRV\SITECFG.BOX directory.</P>
<P CLASS="term1"><B><B>/SYNCPARENT</B></B></P>
<P CLASS="dt1">Forces all site control images in the site database simultaneously up to the parent for the current site and all its subsites. Use this option when sites are out of synchronization due to time lags or job failures.</P>
<P CLASS="term1"><B><B>/DELSITE:{</B><I>sitecode</I>, <I>parentsite</I><B>}</B></B></P>
<P CLASS="dt1">Deletes incorrectly removed sites. Use this option if you removed a site before detaching it from its parent site. Note that the braces are required.</P>
<P CLASS="dt1">The <I>sitecode</I> parameter specifies the site to delete, and <I>parentsite</I> is the site code of the parent site for the site you are deleting. When you specify <I>parentsite</I>, it prevents unwanted deletion of a site previously relocated under a different parent site in another part of the site tree. For example, typing <B>preinst /DELSITE:{CHL,PAR}</B> deletes CHL only if it has a parent site of PAR. This transaction proceeds up the site hierarchy to all parent sites for the current site.</P>
<P CLASS="dt1"><B>Note</B>   This instruction does not send a remove job to the target site. It merely removes the site and its SMS domains from the local site database and propagates the change up the site hierarchy.</P>
<P CLASS="term1"><B><B>/DEINSTALL:{</B><I>sitecode</I><B>}</B></B></P>
<P CLASS="dt1">Sends a job to remove a specific secondary site. The <I>sitecode</I> parameter specifies the site to remove from the site hierarchy. Note that the braces are required.</P>
<P CLASS="dt1">If you want to remove a secondary site from the hierarchy, you should first try to remove it using the SMS&nbsp;Administrator. If that fails for any reason, use this option.</P>
<P CLASS="term1"><B><B>/UPGRADE:{</B><I>sitecode</I><B>}</B></B></P>
<P CLASS="dt1">Selectively upgrades a specific secondary site. The <I>sitecode</I> parameter specifies the site to upgrade. If a global upgrade fails after specifying a system upgrade, use this option for the failed sites. Note that the curly braces are required.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Site Configuration Manager</H4><P CLASS="t">The Site Configuration Manager monitors and controls the configuration of the site. The Site Configuration Manager uses the site configuration parameters in the site control files created by the Hierarchy Manager. If the site's configuration control file contains changes, the Site Configuration Manager implements the changes.</P>
<P CLASS="t">The Site Configuration Manager exists in both primary and secondary sites. It automatically restarts after the site server restarts, and it starts all other services.</P>
<P CLASS="t">When you add a Windows&nbsp;NT or LAN&nbsp;Manager domain to the site, the Site Configuration Manager:</P>
<UL><LI>Detects all logon servers (if appropriate) and verifies that each server is active and part of a supported network operating system for the domain.</LI><LI>Creates the SMS root directory (and shares it as SMS_SHR<I>x</I>) and the SMS_SHR share on the NTFS drive with the most free space on all logon servers. If no NTFS drive exists, it chooses the drive with the most available space even if it is a FAT drive.</LI><LI>Installs and starts the Inventory Agent to collect inventory for servers running Windows&nbsp;NT and LAN&nbsp;Manager. It also installs and starts the Package Command Manager on domain controllers.</LI><LI>Installs and starts the SMS Executive on helper servers.</LI><LI>In LAN&nbsp;Manager and Windows&nbsp;NT domains, when you select the Automatically Configure Workstation Logon Scripts option, the script files (SMSLS batch file and SETLS program files) are sent to the REPL$\SCRIPTS directory on the primary domain controller. If a user has an existing logon script, (text or ASCII script in a *.BAT or *.CMD file), the Site Configuration Manager adds the SMSLS command to the script. If a user has no logon script, it adds the script to the user's profile.</LI></UL><UL><LI>If you add a NetWare domain, the Site Configuration Manager creates an SMS directory on the volume with the most disk space. When you select the Automatically Configure Workstation Logon Scripts option, the system logon script for each logon server is modified. Once the system logon scripts are modified, the Site Configuration Manager installs the SMS client software in the SMS directory. The Maintenance Manager collects inventory information for the NetWare servers.</LI></UL><P CLASS="t">If you make site configuration changes using the SMS&nbsp;Administrator, the Site Configuration Manager must be running to implement the changes to the site.</P>
<H5 CLASS="h4"><A NAME="sec2"></A>Setting Monitoring Intervals for the Site Configuration Manager</H5><P CLASS="t">The Site Configuration Manager uses values set in the Windows&nbsp;NT registry to determine how frequently to monitor parts of the site. You can modify these values directly in the Windows&nbsp;NT registry using the Windows&nbsp;NT Registry Editor. These values are located in the HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SMS\Components\SMS_SITE_CONFIG_MANAGER registry key. You can set the following values:</P>
<P CLASS="term1"><B><B>Logon Script Configuration Interval</B></B></P>
<P CLASS="dt1">The frequency (in minutes) that the Site Configuration Manager checks the logon script configuration for all SMS domains in the site. By default, the interval is 1440 minutes (24 hours). This interval is checked only during the processing of a site control file or at the start of the next watchdog cycle.</P>
<P CLASS="term1"><B><B>Restart After Shutdown Delay</B></B></P>
<P CLASS="dt1">Determines the duration (in minutes) that the Site Configuration Manager waits before restarting SMS services at a site after the site server and the SMS system have been restarted. The startup delay is five minutes. This is the length of time that the Site Configuration Manager waits before activating the first cycle. Subsequent cycles work from the watchdog interval.</P>
<P CLASS="term1"><B><B>Site Configuration Reporting Interval</B></B></P>
<P CLASS="dt1">The frequency (in minutes) that the Site Configuration Manager writes a new site control file to report its current configuration. By default, the interval is 1440 minutes (24 hours). Note that this interval is checked only during the processing of a site control file or at the start of the next watchdog cycle.</P>
<P CLASS="term1"><B><B>User Group Reporting Interval</B></B></P>
<P CLASS="dt1">The frequency (in minutes) that the Site Configuration Manager retrieves the list of user groups from all SMS domains in the site and writes a management information format (MIF) file to report the user groups to the site database. By default, the interval is 1440 minutes (24 hours). This interval is checked only during the processing of a site control file or at the start of the next watchdog cycle.</P>
<P CLASS="term1"><B><B>Watchdogging Interval</B></B></P>
<P CLASS="dt1">The frequency (in minutes) that the Site Configuration Manager checks for new SMS logon servers, stopped services or components, or if any of the preceding reporting or configuration intervals are up. By default, the interval is 120 minutes (2 hours). This interval resets itself to be 24 times the service response polling interval whenever the service's response rate is changed. The response polling intervals are set by the Service Response rates for the Maintenance Manager, Site Configuration Manager, and Despooler. For more information, see SMS version 1.2 <I>Installation and Configuration</I>, Chapter 5.</P>
<H5 CLASS="h4"><A NAME="sec3"></A>Triggering a Specific Site Configuration Manager Task</H5><P CLASS="t">You can trigger a specific task by sending a service control code to the Site Configuration Manager using the SMS utility program SENDCODE.EXE. The syntax for SENDCODE.EXE is as follows:</P>
<P CLASS="t"><B>sendcode sms_site_config_manager </B><I>svccode</I></P>
<P CLASS="t">The following table lists the values for <I>svccode</I> supported by the Site Configuration Manager.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="76pt" VALIGN="TOP"><COL WIDTH="54pt" VALIGN="TOP"><COL WIDTH="216pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>Name</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B><I>svccode</I></B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Memtrack_on</B></P></TD><TD VALIGN="TOP"><P>128</P></TD><TD VALIGN="TOP"><P>Starts memory allocation tracking.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Memtrack_off</B></P></TD><TD VALIGN="TOP"><P>129</P></TD><TD VALIGN="TOP"><P>Stops memory allocation tracking.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Memtrack_dump</B></P></TD><TD VALIGN="TOP"><P>130</P></TD><TD VALIGN="TOP"><P>Dumps the memory allocation data to ALERTER.MEM, APPMGR.MEM, HMAN.MEM, SCMANMEM.LOG, SCHED.MEM, and SMSEXEC.MEM in the root directory.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>"Net pause" toggle</B></P></TD><TD VALIGN="TOP"><P>132</P></TD><TD VALIGN="TOP"><P>Toggles the <B>net pause</B> support on and off for the Site Configuration Manager.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Watchdog</B></P></TD><TD VALIGN="TOP"><P>192</P></TD><TD VALIGN="TOP"><P>Initiates a normal watchdog cycle (verifies current installation, checks for new SMS logon servers, restarts any stopped components, and so on).</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Status</B></P></TD><TD VALIGN="TOP"><P>193</P></TD><TD VALIGN="TOP"><P>Initiates a watchdog cycle then writes a status file (.CT2).</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Upgrade</B></P></TD><TD VALIGN="TOP"><P>194</P></TD><TD VALIGN="TOP"><P>Initiates a watchdog cycle but treats it as an upgrade. To be most effective, this should be preceded by <B>shutdown</B>.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Usergroups</B></P></TD><TD VALIGN="TOP"><P>195</P></TD><TD VALIGN="TOP"><P>Initiates a watchdog cycle and writes a user group MIF file.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Scripts</B></P></TD><TD VALIGN="TOP"><P>196</P></TD><TD VALIGN="TOP"><P>Initiates a watchdog cycle and modifies logon scripts only if the Automatically Configure Workstation Logon Scripts and the Use All Detected Servers options are enabled.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>Shutdown</B></P></TD><TD VALIGN="TOP"><P>234</P></TD><TD VALIGN="TOP"><P>Stops and removes services in the site (on the site server and all SMS logon and helper servers).</P></TD></TR><TR><TD VALIGN="TOP"><P> <B>Deinstall</B></P></TD><TD VALIGN="TOP"><P>255</P></TD><TD VALIGN="TOP"><P>Initiates a site removal (this removes all components, as well as files and shares, from the site server and all SMS logon and helper servers).</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<H4 CLASS="h3"><A NAME="sec4"></A>Inventory Agent</H4><P CLASS="t">The Inventory Agent runs on OS/2 and Windows&nbsp;NT-based servers. The Inventory Agent performs software and hardware inventory on the server, except NetWare servers (Maintenance Manager performs inventory on NetWare logon servers).</P>
<P CLASS="t">The Inventory Agent is started by the Site Configuration Manager during SMS installation on domain controllers for domains which SMS controls. The Inventory Agent wakes up at an interval specified by the Inventory Agent Service Interval in the HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SMS\Components\SMS_MAINTENANCE_MANAGER registry key. The default wake-up interval is 24 hours (1440 minutes). When it wakes up, the Inventory Agent checks software and hardware scan interval settings from the local DOMAIN.INI file. By default, scan interval settings for both hardware and software are 7 (days), indicating that inventory should once every seven days. To change the software and hardware scan interval settings, use the Site Properties dialog box in the SMS&nbsp;Administrator.</P>
<H4 CLASS="h3"><A NAME="sec5"></A>Package Command Manager for Windows&nbsp;NT</H4><P CLASS="t">The Package Command Manager is installed on all Windows&nbsp;NT-based servers (site and SMS logon servers) in an SMS hierarchy. The Package Command Manager service (PCMSVC32.EXE) provides unattended package installation — a user does not have to be logged on to a server running Windows&nbsp;NT for package installation to occur. However, the package must be configured for automated installation in background mode.</P>
<P CLASS="t">If a package arrives at a server running Windows&nbsp;NT that is also running the Package Command Manager (PCMWIN32.EXE file), the package is handled by the Package Command Manager. </P>
<P CLASS="t">The Package Command Manager initially wakes up once every 60 seconds to check the package polling interval. You set the polling interval in the Site Properties dialog box (under Clients) in the SMS&nbsp;Administrator. The default is 60 minutes. If the polling interval has elapsed, the Package Command Manager checks the package instruction file to see if the time and date have changed. If the polling interval has changed, the Package Command Manager resets the polling interval counter to the new value, and waits until that many minutes have passed before polling again. The Package Command Manager Service is limited to package installations that do not require user input and do not display windows on the server. The polling interval is set in the SMS.INI file.</P>
<H4 CLASS="h3"><A NAME="sec6"></A>Bootstrap</H4><P CLASS="t">The Bootstrap sets up a Windows&nbsp;NT-based server as a secondary site. After the Hierarchy Manager at the primary site detects the request to add a secondary site, it initiates a job to the site to install the SMS installation directory on the secondary site server. It also tells the senders (LAN or RAS) to install and start the Bootstrap from that directory.</P>
<P CLASS="t">When the primary site sends a package containing site components to the secondary site, the Bootstrap:</P>
<UL><LI>Decompresses the package.</LI><LI>Creates the site directory structure, and then places components in the appropriate directories on the site server. </LI><LI>Starts the Site Configuration Manager when it detects the site control file sent by the primary site. The Site Configuration Manager then removes the Bootstrap.</LI></UL><H4 CLASS="h3"><A NAME="sec7"></A>SNA Receiver</H4><P CLASS="t">After you add an SNA Sender to a site using the SMS&nbsp;Administrator, the SNA Receiver is activated by the Site Configuration Manager (the SNA Sender is started as part of the SMS Executive). The SNA Receiver processes information that has been sent from an SNA Sender at a remote site.</P>
<H4 CLASS="h3"><A NAME="sec8"></A>Client Configuration Manager</H4><P CLASS="t">The Client Configuration Manager exists in both primary and secondary sites and is used by SMS Client Setup to install, upgrade, and remove SMS service components on computers running Windows&nbsp;NT. When SMS Client Setup needs to perform actions that may require special access on a computer running Windows&nbsp;NT, it posts a client configuration request to the Client Configuration Manager. The Client Configuration Manager then carries out the request. The Client Configuration Manager runs on all SMS logon servers running Windows&nbsp;NT Server.</P>
<P CLASS="t">The Client Configuration Manager configures the following components on Windows&nbsp;NT-based computers running as SMS clients:</P>
<UL><LI>SMS Client Inventory Service</LI><LI>SMS Remote Control Agent</LI><LI>SNMP Event to Trap Translator</LI></UL><P CLASS="t"><B>Note</B></P>
<P>The Client Configuration Manager uses the SMS Service Account to install these components on computers running the Windows&nbsp;NT operating system. The service account must have administrative privileges on the computers or Client Configuration Manager will not be able to install the components. To grant administrative privileges on clients running Windows&nbsp;NT, do <I>one</I> of the following:</P>
<UL><LI>Make the SMS Service Account on the site server a member of the client's Administrators local group (directly or through other groups).</LI><LI>Have a local account on the client with the same name and password as the SMS Service Account. This account must have administrative privileges.</LI><LI>In the SMS domain where the client is a member, have an account with same name and password as the SMS Service Account.</LI></UL><H5 CLASS="h4"><A NAME="sec9"></A>Setting Parameters for the Client Configuration Manager</H5><P CLASS="t">The following Client Configuration Manager parameters are maintained in the site server registry, in the HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SMS\Components\SMS_CLIENT_CONFIG_MANAGER registry key.</P>
<P CLASS="term1"><B><B>Deinstall All Client Services</B></B></P>
<P CLASS="dt1">When this value is set to <B>Yes</B>, it specifies that each client configuration request (CCR) be treated as a request to remove all of the SMS service-based client components. The default value is <B>No</B>.</P>
<P CLASS="term1"><B><B>Prompt for Restart</B></B></P>
<P CLASS="dt1">When this value is set to 0, the Client Monitor does not prompt the user at the client to restart the computer after installing software. The default value is 1, and it is not recommended that you change this value.</P>
<P CLASS="term1"><B><B>Ignore These Event IDs</B></B></P>
<P CLASS="dt1">Values specified in this parameter represent SMS event IDs that should not be reported to the Windows&nbsp;NT Event Manager. You can specify the following values:</P>
<P CLASS="term2"><B><B>402</B></B></P>
<P CLASS="dt2">Event that occurs when the Client Configuration Manager is unable to connect to a client. This event occurs when the SMS service account does not have administrative rights on the client, and when the client cannot be found (because it is turned off for more than seven consecutive days, it no longer exists, or its computer name has changed).</P>
<P CLASS="term2"><B><B>403</B></B></P>
<P CLASS="dt2">Event that occurs when the Client Configuration Manager succeeded in connecting to the client but encountered an error while attempting to install the client components. </P>
<P CLASS="dt2">When you encounter many of these events, increase the <B>Error Reporting Delay </B>and <B>Retry Duration</B> values in the site server registry (under the Retry queue) to allow the Client Configuration Manager to retry the client for longer than the default 24 hours before reporting the problem.</P>
<P CLASS="term2"><B><B>404</B></B></P>
<P CLASS="dt2">Event that appears when an excessive number of CCRs (as defined by the <B>Machine Count Warning </B>key in the Retry queue) appear in either the incoming or retry queues on each logon server. This event appears the first time the queue rises above the threshold number of events, and when the number of CCRs drops back below the threshold numbers. </P>
<P CLASS="dt2">These events indicate a backlog of clients to process. If you see an event for the incoming queue, the Client Configuration Managers running on the logon servers are not keeping up with the demand, and you need to consider performance and tuning issues for the site.</P>
<P CLASS="term1"><B><B>Only Report These Event IDs When Fatal</B></B></P>
<P CLASS="dt1">Values specified in this parameter represent SMS event IDs that should be reported to the Windows&nbsp;NT Event Manager only after they are "fatal," which means that the Client Configuration has stopped retrying to connect to the client and install or maintain client components. This value can be 402 or 403.</P>
<H4 CLASS="h3"><A NAME="sec10"></A>SNMP Trap Receiver</H4><P CLASS="t">The SNMP Trap Receiver makes simple network management protocol (SNMP) trap information available to SMS. The SNMP Trap Receiver is disabled (no traps are received by or stored in the database) by default. You configure the SNMP Trap Receiver using the Site Properties dialog box (under SNMP Traps) in the SMS&nbsp;Administrator.</P>
<P CLASS="t">The SNMP Trap Receiver filters traps according to conditions you set. You can set trap filters based on the trap IP address, enterprise ID, Windows&nbsp;NT event source (for traps generated by the Event to Trap Translator), generic trap type, or specific trap ID. Filtered traps are either written to the database or discarded.</P>
<P CLASS="t">If a trap meets the filter conditions, SMS writes the trap data to the database. However, to minimize the impact on the database, SMS only writes the first 25 <B>varbinds</B> in the trap to the database. SMS also limits the size of each <B>varbind</B>. If any of the <B>varbinds</B> exceed the limit, SMS rejects the trap data. The data is not written to the database; a Windows&nbsp;NT event is created to log the failure instead.</P>
<P CLASS="t">The SNMP Trap Receiver can receive traps from any suitable SNMP source, including (but not limited to) the Event to Trap Translator. Traps generated by the Event to Trap Translator display the Windows&nbsp;NT event source name for the event that triggered the trap.</P>
<P CLASS="t">The SNMP Trap Receiver runs at all primary sites. It stores SNMP trap data in the database as a new architecture. This means that trap data can be viewed, queried against, and used to generate SMS alerts.</P>
<H4 CLASS="h3"><A NAME="sec11"></A>SMS Executive</H4><P CLASS="t">The SMS Executive serves as a master controller of several SMS components. The SMS Executive is started by the Site Configuration Manager, during SMS services startup and any other time that the SMS Executive is not running.</P>
<P CLASS="t">The SMS Executive reads the Windows&nbsp;NT registry to determine which components to start on SMS site, logon, and helper servers. By default, it starts the following components on the site server:</P>
<UL><LI>Maintenance Manager</LI><LI>Inventory Processor</LI><LI>Site Reporter</LI><LI>Scheduler</LI><LI>Despooler</LI><LI>Inventory Data Loader</LI><LI>Senders</LI><LI>Applications Manager</LI><LI>Alerter</LI></UL><P CLASS="t">Each of these components is discussed in the following sections.</P>
<H5 CLASS="h4"><A NAME="sec12"></A>Maintenance Manager</H5><P CLASS="t">The Maintenance Manager installs and maintains the SMS client components on the SMS logon servers in a site. It replicates client components and configuration information to SMS logon servers within the site and retrieves inventory and status files. The Maintenance Manager is installed in every primary and secondary site server. The Site Configuration Manager sets up the registry information and necessary directory structures that the Maintenance Manager needs to run properly.</P>
<P CLASS="t">When a logon server is added to the SMS system, the Maintenance Manager replicates client files, such as the Inventory Agent, Program Group Control, and Package Command Manager programs, to the logon server. The Maintenance Manager also monitors the site server for any changes in configuration. If a change is detected, the Maintenance Manager replicates these changes to all of the SMS logon servers within the site. The Maintenance Manager also periodically scans all the logon servers and updates missing files.</P>
<P CLASS="t">In addition, the Maintenance Manager:</P>
<UL><LI>Monitors the package rule file for changes and replicates it as necessary.</LI><LI>Passes files back and forth between the site server and SMS logon servers according to the polling interval. For example, it moves RAW files from each SMS logon server to the site server and replicates Package Command Manager instruction files and SMS network applications from the site server to all SMS logon servers.</LI><LI>Collects inventory from NetWare servers and creates a corresponding MIF file.</LI><LI>Reads the SYSTEM.MAP file and creates copy lists for the SMS Client Setup program. A copy list tells SMS Client Setup where to place files on the client.</LI><LI>Creates the unique identifier (*.UID) file. The *.UID file name prefix represents the next available SMS ID number for an SMS logon server.</LI><LI>Detects when the Despooler has distributed the package, then creates and sends package location MIF files.</LI></UL><H5 CLASS="h4"><A NAME="sec13"></A>Inventory Processor</H5><P CLASS="t">The Inventory Processor exists in both primary and secondary site servers. It creates the MIF files from the raw binary inventory information returned by the Inventory Agents for Windows&nbsp;NT and MS-DOS&reg; and reads the MIF files returned by the Inventory Agents for OS/2 and Macintosh clients. The Inventory Processor creates a history file for the Windows&nbsp;NT, Apple Macintosh, and OS/2 platforms. MIF files also track history, unless they are created with an NHM extension. When a new MIF file is received, the Inventory Processor compares it with the history file and writes changes to an inventory file called a Binary MIF file. (If this is the first MIF file, the Inventory Processor writes a complete Binary MIF inventory file.)</P>
<P CLASS="t">The Inventory Processor also converts MIF files in the ISVMIF directory into Binary MIF files. ISVMIFs are files generated by independent software vendors (ISVs), which report objects such as computers that have custom architectures. The ISVMIF directory also contains MIF files from OS/2 and Macintosh clients.</P>
<H5 CLASS="h4"><A NAME="sec14"></A>Site Reporter</H5><P CLASS="t">The Site Reporter maintains a queue of MIF files containing inventory, job status, or event information. At child sites, the Site Reporter periodically creates a system job to send these files to the parent site. The queue length that triggers when the files are sent is determined by various registry settings. The Site Reporter keeps track of the different categories of MIF files that arrive for it and compares the category with a registry entry that indicates how long that type of MIF file should be allowed to wait. When any MIF file reaches its maximum wait time, all MIF files for that site are bundled and sent. The registry entries for the Site Reporter are under the HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SMS\Components\SMS_SITE_REPORTER key and are maintained by the Site Configuration Manager.</P>
<P CLASS="t">The Site Reporter also deletes MIF files that are not reported to parent sites, either because there is no parent site or because the MIF file is normally not reported to a parent site (such as a job detail MIF file).</P>
<P CLASS="t">The Site Reporter exists in both primary and secondary sites.</P>
<H5 CLASS="h4"><A NAME="sec15"></A>Scheduler</H5><P CLASS="t">The Scheduler detects pending jobs and creates auxiliary files that enable jobs to be processed. This includes jobs that an administrator starts, such as a Run Command On Workstation job, as well as system jobs from system processes such as the Site Reporter.</P>
<P CLASS="t">When the Scheduler detects a job, it:</P>
<UL><LI>Compresses the relevant files (such as all files in a package source directory or all inventory MIF files) into a single file.</LI><LI>Creates a despooler file, in the SMS\LOGON.SRV\DESPOOLER.BOX directory, with instructions for completing the job at the receiving site.</LI><LI>Creates a send request file (*.SRQ) with instructions for sending the compressed files and the despooler instructions to the target site, in the corresponding sender outbox.</LI></UL><P CLASS="t">The Scheduler also manages send requests. It examines send requests for a specific sender's outbox and schedules them on a priority basis. For example, it might suspend a low priority job in progress and substitute a higher priority send request. After the higher priority job runs, it restarts the previous job. </P>
<P CLASS="t">The Scheduler runs on the site server, but you can use the Services button in the Site Properties dialog box in the SMS&nbsp;Administrator to move it to a helper server. The Scheduler exists in both primary and secondary sites.</P>
<H5 CLASS="h4"><A NAME="sec16"></A>Despooler</H5><P CLASS="t">The Despooler watches the SITE.SRV\DESPOOLR.BOX\RECEIVE directory for despooler instruction files and compressed packages created by the Scheduler. The instructions and packages can come from the local site or from another site. The Despooler reads the instruction file and uses the instructions to decompress the package files and determine how to process them. For example, it decompresses inventory files and moves them to the SMS\SITE.SRV \DATALOAD.BOX\DELTAMIF.COL directory so they can be processed by the Inventory Data Loader, which then updates the site database.</P>
<P CLASS="t"><B>Note</B></P>
<P>Specify the drive that the Despooler will use for temporary files in the Preferred Drive For Temp Directory setting for the Despooler registry key. This value is blank by default, which directs SMS to use its drive. The SMS Drive Minimum Free Space in Mbytes option specifies that SMS look for a drive of the configured value (default value is 100&nbsp;MB). If the free disk space on the SMS drive is less than 100 MB, the Despooler will start looking for other drives on which to place the package.</P>
<P CLASS="t">If there are two package shares, the Despooler will pick the drive (share) with the most free disk space until both of them have less than 100 MB of free space. Then it attempts to find a third drive with more free disk space. The Despooler will never place the same package on two shares even if they came in different jobs. To determine where packages are stored, look under the SMS\Components\SMS_Despooler\Transfer&nbsp;Package registry key.</P>
<P CLASS="t">For Run Command On Workstation jobs, the Despooler updates the Package Command Manager instruction files for all target computers in the site. After the package has been installed, the Despooler reports the job's status to the site where the job was created. It also logs an event to the site server's Windows&nbsp;NT event log if there is a failure.</P>
<P CLASS="t">The Despooler initially runs on the site server but can be moved to a helper server. The Despooler exists in both primary and secondary sites.</P>
<H5 CLASS="h4"><A NAME="sec17"></A>Inventory Data Loader</H5><P CLASS="t">The Inventory Data Loader updates computer inventory, events, job location, and user group and job status information in the database. When an inventory MIF file arrives from a computer, the Inventory Data Loader attempts to locate the computer in the site database based on its SMS ID and key attributes in its identification group. If the MIF file contains instructions to update an object, such as a client's identification group that is missing from the database, the Inventory Data Loader initiates a <B>resync</B> command to update the database. The Inventory Data Loader processes job status, user group, event, and package location information, and then updates the database directly (no <B>resync</B> is necessary).</P>
<P CLASS="t">In SMS version 1.2, each of the main architectures creates MIF files with different extensions, as shown in the following table:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="130pt" VALIGN="TOP"><COL WIDTH="193pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>MIF file name extension</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Contains</B></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">.EMF</P></TD><TD VALIGN="TOP"><P CLASS="tt">Event data</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">.JMF</P></TD><TD VALIGN="TOP"><P CLASS="tt">Job status data</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">.UMF</P></TD><TD VALIGN="TOP"><P CLASS="tt">User group data</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">.PMF</P></TD><TD VALIGN="TOP"><P CLASS="tt">Package location data</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="t">All other MIF files are processed by the 'misc' processing thread, including MIF files from sites that are running earlier versions of SMS. The Inventory Data Loader processes the different MIF files in parallel.</P>
<P CLASS="t">The Inventory Data Loader:</P>
<UL><LI>Monitors the DELTAMIF.COL directory for MIF files.</LI><LI>When it finds a file, it moves the file to the DELTAMIF.COL\PROCESS directory.</LI><LI>Starts the appropriate thread to process the file.</LI><LI>Copies the file to the SITEREF.BOX directory.</LI></UL><P CLASS="t"><B>Note</B></P>
<P>If the Inventory Data Loader is stopped before it has finished processing a MIF file, that file is renamed with an X at the beginning of the file name (for example, X0712.EMF). When the file has three X's at the beginning of the file name, it is considered a corrupt MIF file and is moved to the DELTAMIF.COL\BADMIFS directory.</P>
<P>If you stop and restart SMS&nbsp;Executive often, you might end up with many files in the DELTAMIF.COL\BADMIFS directory that would otherwise process normally.</P>
<P CLASS="t">The Inventory Data Loader is also responsible for:</P>
<UL><LI>Transferring the inventory from a child site to the Site Reporter, which uses a sender to deliver the information to a parent site after the parent/child hierarchy is first established.</LI><LI>Forwarding Binary MIF files to the Site Reporter after processing them. The Site Reporter creates a job to send Binary MIF files to a parent site if it exists.</LI></UL><P CLASS="t">The Inventory Data Loader initially runs on the site server but can be moved to a helper server. The Inventory Data Loader exists only in primary sites.</P>
<H5 CLASS="h4"><A NAME="sec18"></A>Senders</H5><P CLASS="t">To enable each site to communicate with its parent sites and child sites, every site must have one or more senders. A sender is an SMS component used to transmit instructions and data from one site to another (such as reporting inventory information or installing software on clients in another site).</P>
<P CLASS="t">There are six types of SMS senders:</P>
<UL><LI>One LAN Sender</LI><LI>Three RAS Senders (ISDN, X.25, and ASYNC)</LI><LI>Two SNA Senders (batch and interactive)</LI></UL><P CLASS="t">Each type of sender uses a specific type of communications link. The RAS Senders require a Remote Access Service (RAS) server, and the SNA Senders require the SNA&nbsp;Server communications service.</P>
<P CLASS="t">The sender monitors its outbox directory (the location for files waiting to be sent to another site) for a valid send request. When it detects a valid request, the sender connects to the target site and transfers the compressed files and its despooler instruction file to the destination site.</P>
<P CLASS="t">The LAN Sender runs on the site server but can be moved to a helper server. Use the SMS&nbsp;Administrator to add other senders. The sender exists in both primary and secondary sites.</P>
<H5 CLASS="h4"><A NAME="sec19"></A>Applications Manager</H5><P CLASS="t">The Applications Manager copies package and program group configuration information from the site database to other components in the site and to the sites beneath it in the site hierarchy.</P>
<P CLASS="t">When you create, modify, or delete packages or program groups using the SMS&nbsp;Administrator, the changes are added to the site database. When the Applications Manager detects a change to a package or program group, the new configuration information is updated in the Program Group Control database for the site. The Program Group Control database is a set of configuration files used by the Applications Control program for each SMS Windows&reg;-based client.</P>
<P CLASS="t">The Applications Manager uses a system job to replicate package and program group data to child sites. Each child site then generates its own copy of the Program Group Control database. The Applications Manager also uses a system job to add data to the database from parent sites.</P>
<P CLASS="t">The Applications Manager exists in both primary and secondary sites.</P>
<H5 CLASS="h4"><A NAME="sec20"></A>Alerter</H5><P CLASS="t">The Alerter monitors the database for new alerts and any changes to existing alerts. It runs queries associated with alerts and compares query results with alert criteria.</P>
<P CLASS="t">If an alert's trigger condition becomes true, the Alerter performs any or all of the following actions:</P>
<UL><LI>Logs an SMS event and a Windows&nbsp;NT event.</LI><LI>Runs a command line from the system path of the computer where the Alerter is installed.</LI></UL><P CLASS="t"><B>Note</B></P>
<P>The Alerter cannot run a command that writes to a window.</P>
<UL><LI>Sends a message to a computer or user on the local network.</LI></UL><P CLASS="t">The Alerter exists only in primary sites.</P></BODY></HTML>
