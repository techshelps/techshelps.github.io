<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>How SMS Maintains Package Inventory Rules and SMS Network Application Configurations</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">How SMS Maintains Package Inventory Rules and SMS Network Application Configurations</H3><P CLASS="t">Package and program group properties defined in a site's database are used to define software for which the Inventory Agent should scan and to configure program group offerings within the site. If a site is part of site hierarchy, the package and program group configuration information is propagated from the parent site down to the current site. Each parent site propagates its own package and program group configurations as well as those of its parent site.</P>
<P CLASS="t">For example, if site A is a parent site of site B and site B is a parent site of site C, site A propagates all its package and program group configuration information to site B; site B propagates its own package and program group configuration as well as those received from site A down to site C. Site C contains package and program group configuration information for sites A and B as well as those defined at site C.</P>
<P CLASS="t">When you create, modify, or delete a package or program item, SMS modifies the site database. A site database contains properties for all packages and program groups created at the current site and the sites above it in the hierarchy. The Applications Manager monitors the site database but it does not make changes until the packages and program group windows go through a period of inactivity. Updating the PACKAGE.RUL file is dependent on the polling intervals of both the Applications Manager and Maintenance Manager.</P>
<P CLASS="t">If a user doesn't make changes to packages and program groups for 10 minutes, the Applications Manager processes the change. This gives users time to modify packages and program groups without causing unnecessary package and program group updates. </P>
<P CLASS="t">When the Applications Manager processes a change in package properties, it updates the inventory detection rules at the current site. For more information about how inventory detection rules are updated at the current site, see "Maintaining Package Inventory Rules Within a Site" later in this chapter.</P>
<P CLASS="t">When the Applications Manager processes the change in package properties or program group properties at the current site, the Applications Manager updates the configuration files that are used by Program Group Control at Windows-based clients to set up and run SMS network applications. For more information about how network applications are configured within a site, see "SMS Network Applications" later in this chapter.</P>
<P CLASS="t">After the Applications Manager updates the local site's configuration, it creates transaction files to be sent to all its direct child sites. This process is summarized in Figure 3.8,Transaction Files.</P>
<P CLASS="t">The Applications Manager creates the following types of transaction files:</P>
<UL><LI>*.PAC (added or changed packages)</LI></UL><UL><LI>*.DPK (deleted packages)</LI></UL><UL><LI>*.GRP (added or changed program groups) </LI></UL><UL><LI>*.DPG (deleted program groups)</LI></UL><P></P>
<P CLASS="t">The Applications Manager then creates a job that sends all package and program group information to the sites directly beneath it in the hierarchy. </P>
<P CLASS="t">The Scheduler compresses these files into a single <I>jobid</I>.P* file (where <I>jobid</I> is the eight character job ID for the job) and creates a despooler instruction file. For each target site specified, the Scheduler also creates a send request file. A send request file (*.SRQ) contains instructions for sending the compressed package and the despooler instruction file to the target site. The sender transfers the <I>jobid</I>.P* file and despooler instructions to the lower-level sites.</P>
<P CLASS="t">At each site, the Despooler decompresses the files in the package and places them in the SITE.SRV\SITECFG.BOX directory on the site server. The Applications Manager at the site updates the site's database with the package and program group information in the transaction files. After Applications Manager updates the database, it also updates that site's inventory and SMS network application configuration and creates a job to send all its database's package and program group properties to its subsites. When a package gets sent to a child site that is a secondary site, Applications Manager stores the *.PAC and *.GRP files in the SITE.SRV\APPMGR.BOX directory rather than in the site database. </P>
<H4 CLASS="h3"><A NAME="sec0"></A>Maintaining Package Inventory Rules Within a Site</H4><P CLASS="t">A package's inventory rules resides at the site where the package was originally created and are propagated to all subsites. The SMS system scans for the package on all clients at the originating site and all of its subsites. For more information about how package inventory rules are propagated to subsites, see "How SMS Maintains Package Inventory Rules and SMS Network Application Configurations" earlier in this chapter.</P>
<P CLASS="t">When you define Inventory properties for a package, SMS adds the package's inventory rules to the site's database. A site's database contains properties for all packages created at the current site and the sites above it in the hierarchy. The Applications Manager monitors the site database but it does not make changes until the packages and program group windows go through a period of inactivity. Updating the PACKAGE.RUL file is dependent on the polling intervals of both the Applications Manager and Maintenance Manager.</P>
<P><img src="srk_c08.gif"></P>
<P>Figure 3.8    Transaction Files</P>
<P></P>
<P></P>
<P CLASS="t">If a user doesn't make changes to packages and program groups for 10 minutes, the Applications Manager processes the change. This gives users time to modify packages without causing unnecessary package property updates.</P>
<P CLASS="t">When the Applications Manager detects a change in a package's properties followed by a period of inactivity, it updates the site's PACKAGE.RUL file. The PACKAGE.RUL file contains rules for all packages inventoried at the site. Maintenance Manager uses the PACKAGE.RUL file to create the Inventory Agent program's configuration files, which contain rules for collecting inventory. Maintenance Manager replicates these configuration files (PKG_16.CFG) to all SMS logon servers for all SMS domains in the site. When the Inventory Agent program runs at a client in the site, it scans for packages defined in the site's database.</P>
<P CLASS="t">This process is summarized in Figure 3.9, Package Inventory Rules Update.</P>
<P><img src="srk_c09.gif"></P>
<P>Figure 3.9    Package Inventory Rules Update</P></BODY></HTML>
