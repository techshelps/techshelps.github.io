<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Deploying Microsoft SQL Server with SMS</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Deploying Microsoft SQL&nbsp;Server with SMS</H3><P CLASS="t">You can use SMS to automatically install Microsoft SQL&nbsp;Server version 6.5 on multiple computers running Windows&nbsp;NT Server in your organization.</P>
<P CLASS="t">The Microsoft SQL&nbsp;Server compact disc contains the following files to help you deploy SQL&nbsp;Server with SMS (located at the root of the compact disc).</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="103pt" VALIGN="TOP"><COL WIDTH="244pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><B>SQL&nbsp;Server file</B></P></TD><TD VALIGN="TOP"><P CLASS="th"><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">SQL65.PDF</P></TD><TD VALIGN="TOP"><P CLASS="tt">Automates the creation of a SQL&nbsp;Server package in SMS. The SQL&nbsp;Server package can then be distributed and installed on SMS computers. The PDF also enables SMS to detect SQL&nbsp;Server on SMS computers and report it in the SMS computer inventory.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">SQLFULL<I>drive</I>.CMD SQLNOBK<I>drive</I>.CMD</P></TD><TD VALIGN="TOP"><P CLASS="tt">Detect the platform of the computer and run the appropriate version of SQL&nbsp;Server Setup with the appropriate parameters, where <I>drive</I> indicates the drive letter where SQL&nbsp;Server will be installed. The SQLFULL<I>drive</I>.CMD batch file installs the full SQL&nbsp;Server product including the online books. The SQLNOBK<I>drive</I>.CMD batch file installs the SQL&nbsp;Server product <I>without</I> the online books.</P>
<P CLASS="tt">The installation scripts product (SQLFULL<I>drive</I>.INI and SQLNOBK<I>drive</I>.INI) for SQL&nbsp;Server Setup require that the installation drive be specified in the installation script. Batch files and scripts are provided for installation on drives C, D, and E. For example, if you wanted to install SQL&nbsp;Server on drive D, you would use the SQLFULLD.CMD batch file. A custom script (SQLCUSTM.INI) is also provided so that you can change the drive specification to a drive letter that follows E.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">SQLFULL<I>drive</I>.INI SQLNOBK<I>drive</I>.INI</P></TD><TD VALIGN="TOP"><P CLASS="tt">Installation scripts that install SQL&nbsp;Server to a specified drive. <I>drive</I> indicates the drive letter where SQL&nbsp;Server will be installed.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">SQLCUSTM.CMD SQLCUSTM.INI</P></TD><TD VALIGN="TOP"><P CLASS="tt">The SQLCUSTM.CMD batch file runs SQL&nbsp;Server Setup to install the full SQL&nbsp;Server using the SQLCUSTM.INI initialization file. If you are installing SQL&nbsp;Server on a drive letter after E, you can modify the SQLCUSTM.INI file to specify any drive letter that you want. You need to modify the entries that specify drive locations.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<H4 CLASS="h3"><A NAME="sec0"></A>Requirements</H4><P CLASS="t">The computers where SQL&nbsp;Server will be installed have the following disk space requirements:</P>
<UL><LI>Full installation: 90 MB</LI><LI>Installation without online books: 75 MB</LI></UL><P CLASS="t">For other installation requirements for SQL&nbsp;Server, see the Microsoft SQL&nbsp;Server documentation.</P>
<P CLASS="t">On the SMS site server where the job to install the SQL&nbsp;Server is created, the site server must have 180 MB of free disk space.</P>
<H5 CLASS="h4"><A NAME="sec1"></A>To create the Microsoft SQL&nbsp;Server package</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    Copy all directories and files from the Microsoft SQL&nbsp;Server compact disc to a package source directory.</P>
<P>To create the package source directory for SQL&nbsp;Server, create the package source directory on a server and share it with the same name. Copy the directories and files from the Microsoft SQL&nbsp;Server compact disc to the package source directory.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    If you plan to install SQL&nbsp;Server on a drive letter after E (that is, F, G, H, and so on), modify the drive specifications in the custom installation script (SQLCUSTM.CMD and SQLCUSTM.INI).</P>
<P>You need to modify the following items:</P>
<UL><LI>In the [SQLPath] section, set the <B>LogicalSQLDrive</B> entry to the drive where you want to install SQL&nbsp;Server. For example, to install SQL&nbsp;Server on drive G,
<P CLASS="lp2"><B>LogicalSQLDrive=g:</B></P></LI><LI>In the [MasterPath] section, set the <B>LogicalDBDrive</B> entry to the drive where you want to create the master database. For example, to create the master database on drive G,
<P CLASS="lp2"><B>LogicalDBDrive=g:</B></P></LI><LI>In the [Scripts] section, set the CustScPath entry to the custom script path you want to use. For example, if you want to create the master database on drive G, specify:
<P CLASS="lp2"><B>CustScPath=g:\</B></P></LI><LI>If you do not want to install the online books, in the [NewOptions] section of the SQLCUSTM.INI file, set the <B>BooksOnline</B> entry to <B>0</B>.</LI></UL><P>For information about the format of the installation script, see the Microsoft SQL&nbsp;Server documentation.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    In the SMS&nbsp;Administrator, open the Packages window, and from the File menu, choose New.</P>
<P>The Package Properties dialog box appears.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    Choose Import, and select the \\<I>servername</I>\<I>sharename</I>\SQL.PDF file.</P>
<P>The Package Properties dialog box displays SQL&nbsp;Server 6.5 in the Name box.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;5.    Choose Workstations.</P>
<P>The Setup Package for Workstation dialog box appears.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;6.    In the Source Directory box, enter the full UNC name of the SQL&nbsp;Server package source directory (for example, <B>\\myserver\sql65</B>).</P>
<P>You can choose to have SMS inventory this package. If you select this check box, SMS will copy the installation log file from the target computers to the SMS site server.</P>
<P CLASS="t"><B>Important</B></P>
<P>The installation scripts cannot be run by the Package Command Manager service. They can be run only through the Package Command Manager client software. This means that you must leave the System Background Task option disabled in the Command Line Properties of the commands in the SQL&nbsp;Server package.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;7.    Choose Close.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;8.    Choose OK in all open dialog boxes.</P>
<P>The SQL&nbsp;Server package now appears in the Packages window. You can now use the SQL&nbsp;Server package to create Run Command On Workstation jobs to install SQL&nbsp;Server.</P>
<H5 CLASS="h4"><A NAME="sec2"></A>To distribute the Microsoft SQL&nbsp;Server package</H5><p>&nbsp;&nbsp;&nbsp;&nbsp;1.    In the SMS&nbsp;Administrator, open the Queries window, and from the File menu, choose New.</P>
<P>Define a query to find the computers where you want to install SQL&nbsp;Server.</P>
<P>Because the installation scripts are based on the installation drive, you should use a query to identify the computers that have the specified installation drive and also have enough free disk space on those drives. You can also create queries that impose other requirements such as amount of RAM or an existing SQL&nbsp;Server.</P>
<P>For example, the following query is designed to find all computers running Windows&nbsp;NT Server that have enough free space on drive D for a full installation of SQL&nbsp;Server:</P>
<P CLASS="spacing"><BR></P>
<PRE>(
    MICROSOFT|DISK|1.0:Disk Index is 'D'
    AND
    MICROSOFT|DISK|1.0:Free Storage (MByte) is greater than or equal <BR>        to '90'
)
AND
(
    MICROSOFT|OPERATING_SYSTEM|1.0:Operating System Name is  <BR>        'Microsoft Windows NT'
    AND
    MICROSOFT|OPERATING_SYSTEM|1.0:Version is same as or comes after <BR>        '3.51'
)</PRE>
<P><B>Note</B>   The installation drive has these disk space requirements:</P>
<P>Full installation: 90 MB</P>
<P>Installation without online books: 75 MB</P>
<P>For other requirements for SQL&nbsp;Server such as RAM, see the Microsoft SQL&nbsp;Server documentation.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;2.    To run the query, from the File menu, choose Execute Query.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;3.    Use the query results to add the selected computers to a machine group.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;4.    Use the new machine group to specify the target computers where you want to install SQL&nbsp;Server.</P>
<P>You can also specify the query as a target — SMS will evaluate the query when it activates the job used to install the SQL&nbsp;Server package and use that result as the list of target computers.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;5.    In the SMS&nbsp;Administrator, open the Jobs window, and from the File menu, choose New.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;6.    Choose Details.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;7.    In the Job Target box, specify the query or machine group.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;8.    Select the Run Workstation Command check box.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;9.    Select the command that specifies the drive where you want to install SQL&nbsp;Server (for example, select Complete Install on D: Drive if you want to install the full installation of SQL&nbsp;Server on drive D of all the target computers). </P>
<P>Note that if you set up the SQLCUSTM.INI setup script, you must select the Custom Install command to use that script.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;10.    Choose OK in all open dialog boxes.</P>
<P>When the job completes, SQL&nbsp;Server will be installed on all target computers.</P></BODY></HTML>
