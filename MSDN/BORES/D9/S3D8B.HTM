<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Working with SMS Network Applications</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Working with SMS Network Applications</H3><P CLASS="t">SMS provides fault tolerance and load-leveling for SMS network applications by placing application packages on multiple distribution servers and by choosing, at run time, an available server to service a client. </P>
<P CLASS="t">SMS uses a device driver mechanism for Windows&nbsp;95 clients to choose application servers. This mechanism is completely transparent to both installation and execution of an application. This device driver mechanism depends upon UNC identification of servers. Any references to servers that an application records in the registry, in INI files, in Start menu shortcuts, or program item command lines, must be UNC paths; drive letters are not supported. Any persistent reference to a server location should contain the UNC from which the setup program was activated. At run time, SMS may translate that UNC into an equivalent UNC which represents the same application on a different server.</P>
<P CLASS="t">An application's PDF file should declare a single setup<I> </I>program item to represent a shared SMS network application. The following sample is extracted from the Office&nbsp;for Windows&nbsp;95 standard PDF file:</P>
<P CLASS="spacing"><BR></P>
<PRE>[Program Item Properties 1] 
CommandLine=dummy.exe 
Description=Microsoft Office95a Std Install 
ConfigurationScript=smsacm32.exe ofs95a+install setup.stf "SETUP.EXE /B4 /Q1" "SETUP.EXE /U /Q1" 
RegistryName=ofs95a+install 
DefaultINIFile= 
RunMinimized=FALSE 
RunLocalCopyIfPresent=FALSE 
DriveMode=UNC 
SupportedPlatforms=Windows95, Windows NT 3.1 (x86) 
SetupIcon=OFS95A01.ICO 
DisplayIconInProgGroup=TRUE </PRE>
<P CLASS="t">The entries in the application's PDF file should be as follows:</P>
<P CLASS="term1"><B><B>CommandLine</B></B></P>
<P CLASS="dt1">For reasons of backward compatibility, this entry cannot be blank so it should contain some text.</P>
<P CLASS="term1"><B><B>Description</B></B></P>
<P CLASS="dt1">The Start menu shortcut identifier or program item identifier; this entry must not be blank.</P>
<P CLASS="term1"><B><B>ConfigurationScript</B></B></P>
<P CLASS="dt1">Contains the setup program's command line, or, if special preprocessing is desired, the command line of an encapsulation program.</P>
<P CLASS="term1"><B><B>RegistryName</B></B></P>
<P CLASS="dt1">Must be unique to the application and its version.</P>
<P CLASS="term1"><B><B>SupportedPlatforms</B></B></P>
<P CLASS="dt1">See the SMS version 1.2 product documentation for allowable values for this entry.</P>
<P CLASS="term1"><B><B>SetupIcon</B></B></P>
<P CLASS="dt1">Contains the file name of the icon used to represent the setup program. Both the PDF file and the icon file should reside in a package's root directory. This entry is required for Program Group Control, and it only support icon files (.ICO).</P>
<P CLASS="t"></P>
<P CLASS="t">The other entries must posses the values indicated in the sample.</P>
<P CLASS="t">You install an SMS network application exactly as you would in the absence of SMS; no changes are made by SMS to Start menu items, program items, registry entries, or INI file entries.</P>
<P CLASS="t">To enable SMS to automatically remove an application upon your request, a setup program or its encapsulation program must record a removal command line in the HKEY_CLASSES_ROOT\SMS\Applications\<I>regname</I>\Info\Deinstall_App registry key. This must specify a full path to the removal program, including the server and share name.</P>
<P CLASS="t">To enable an encapsulation program to determine the UNC path from which a setup program is initiated, SMS records the installation server's UNC path in the HKEY_CLASSES_ROOT\SMS\Applications\<I>regname</I>\InstallationServer registry key. An encapsulation program can then prefix the removal command line with this UNC before recording it into the registry. The <I>regname</I> component is the name for the program item that was entered into the RegistryName entry within the PDF file.</P></BODY></HTML>
