<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Stored Procedures Installed with SQL Workbook Publisher</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Stored Procedures Installed with SQL Workbook Publisher</H3><P CLASS="t">The Transact-SQL script Sqlwpub.sql installs the following stored procedures in a selected SQL Server database.</P>

<TABLE COLS="5" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="158pt" VALIGN="TOP"><COL WIDTH="2pt" VALIGN="TOP"><COL WIDTH="100pt" VALIGN="TOP"><COL WIDTH="1pt" VALIGN="TOP"><COL WIDTH="96pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="thf">Stored procedure</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="th">Function</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="th">Used by</P></TD></TR><TR><TD COLSPAN="5" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>sp_SWPAdminDeleteFolder</B></P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">Deletes the selected folder and all folders and workbooks stored within the folder. This overrides the SQL Workbook Publisher parent-child rule.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">ISQL/w</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>sp_SWPCopyWorkbook</B></P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">Copies the selected workbook from one folder to another.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>sp_SWPCreateFolder</B></P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">Creates a folder.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>sp_SWPCreateWorkbook</B></P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">Creates a SQL Workbook Publisher workbook.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher</P>
<P CLASS="tt">Wizard</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>sp_SWPDeleteFolder</B></P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">Deletes the selected folder.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>sp_SWPDeleteWorkbook</B></P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">Deletes the selected workbook.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>sp_SWPGetFolders</B></P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">Displays all folders available in a selected database or in another folder.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>sp_SWPGetWorkbookInfo</B></P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">Displays the properties of one or more selected workbooks.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>sp_SWPGetWorkbook</B></P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">Displays all workbooks available in a selected folder.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>sp_SWPGetUserName</B></P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">Returns the username of the user logged in to SQL Server to verify whether the current user owns the workbook to be saved.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">MS Query<BR>SQL Server</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>sp_SWPIsDuplicateFolder</B></P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">Checks the <B>FolderName</B> column in the <B>SWPWorkbookFolder</B> table for duplicate names. Causes an error message to be displayed if a particular name already exists for a folder.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>sp_SWPIsDuplicateWorkbook</B></P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">Checks the <B>Name</B> column in the <B>SWPWorkbook</B> table for duplicate names. Causes an error message to be displayed if a particular name already exists for a folder.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt"><B>sp_SWPMoveWorkbook</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">Moves the selected workbook from one folder to another.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt"><B>sp_SWPRenameFolder</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">Stores a new folder name in the SQL Server database.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt"><B>sp_SWPRenameWorkbook</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">Stores a new workbook name in the SQL Server database.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt"><B>sp_SWPSaveSQL</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">Stores a SQL query in the SQL Server database.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher Wizard</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt"><B>sp_SWPUpdateFolderPath</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">Updates the <B>FolderPath</B> column of all subfolders when a folder is renamed.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt"><B>sp_SWPUpdateWorkbookProperties</B></P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">Refreshes the properties of a specified workbook.</P></TD><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tt">SQL Workbook Publisher</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P></BODY></HTML>
