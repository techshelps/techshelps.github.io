<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Triggering a Batch File with findstr</TITLE><BODY BGCOLOR="#FFFFFF">


<H2 CLASS="h1">Triggering a Batch File with findstr</H2><P CLASS="t">It is possible to write a batch file that conditionally takes action based on whether <B>findstr</B> detects a certain error string. This technique uses the Windows NT conditional processing commands: <B>&amp;&amp;</B> and<B> ||</B>. The following command executes the batch file Batch1.bat if any of the SQL error strings in the file Search.txt are found: </P>

<PRE>findstr /i /g:search.txt errorlog*.* &amp;&amp; batch1
</PRE>
<P CLASS="t">Batch1.bat could invoke a program or run an ISQL/w job that uses the extended stored procedure <B>xp_sendmail</B> to send a mail message notifying an operator of a problem.</P>
<P CLASS="t">The above techniques can be combined to perform a variety of tasks. For example, the following batch file will continuously run a <B>findstr</B> command that conditionally executes Batch1.bat if any of the SQL error strings in the file Search.txt are found, excluding the strings in Exclude.txt: </P>

<PRE>echo off
:start
findstr /i /g:search.txt errorlog*.* | findstr
/v /i /g:exclude.txt &amp;&amp; (echo WARNING &amp; batch1)
goto start
</PRE>
<P CLASS="t">With a little experimentation, these techniques can reduce the labor involved in searching SQL Server error log files and DBCC output files. These same techniques can also be used for any general text-searching task, not just those related to SQL Server.</P>
<P CLASS="t"><B>Note</B>   The Windows NT Resource Kit includes the powerful Perl scripting language, beginning with Windows NT 3.51. It's specifically designed for file scanning and batch automation. If you need more advanced batch automation and error-handling capabilities, you should strongly consider the Windows NT Resource Kit and Perl.</P>
<P CLASS="t">Starting with Windows NT 4.0, several powerful enhancements were added to the Cmd.exe command processor file that can facilitate writing patch jobs, especially those requiring conditional operations. One example is the FOR command. For details, run FOR/? or CMD/?.</P></BODY></HTML>
