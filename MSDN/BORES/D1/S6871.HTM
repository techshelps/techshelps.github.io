<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>A Multiserver Excel Macro</TITLE><BODY BGCOLOR="#FFFFFF">


<H2 CLASS="h1">A Multiserver Excel Macro</H2><P CLASS="t">The Multi.xls application demonstrates how SQL-DMO can be used to create a multiserver backup macro in Microsoft Excel. The application backs up all the databases on a network to a central file share. Providing the server has been registered, the application connects to and backs up all the databases. Then, it calculates the percentage of space used and displays the results in an Excel spreadsheet. You can extend this simple application to perform complex backup strategies and chart the use of resources.</P>
<P CLASS="t">Because this application backs up to a network share, you must give the MSSQLServer service a domain system account that has write access to the file share on every server.</P>
<P CLASS="t">This application is stored on your BackOffice Resource Kit CD-ROM as Multi.xls.</P>
<P CLASS="t">The results are generated on the Excel worksheet as shown in the following illustration.</P>
<P CLASS="a"><img src="dmoxls.gif"></P>
<P CLASS="a"><img src="dmoxls.gif"></P></BODY></HTML>
