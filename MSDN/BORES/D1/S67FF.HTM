<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Cascading Deletes/Updates with Stored Procedures</TITLE><BODY BGCOLOR="#FFFFFF">


<H2 CLASS="h1">Cascading Deletes/Updates with Stored Procedures </H2><P CLASS="t">Cascading deletes and updates can coexist with DRI FOREIGN KEY and REFERENCES constraints as long as the cascading operations are performed before the corresponding constraint checks are done. The data manipulation statements (inserts, updates, and deletes) should be managed by using stored procedures rather than by allowing users to directly manipulate table data; the statements can be executed directly, but encapsulating them in stored procedures provides additional security and maintainability. The users call the appropriate stored procedure for the required operation; permission is granted on the stored procedures and revoked from the tables to ensure proper use.</P>
<P CLASS="t">The cascading update stored procedure would first insert a new row in the primary table, duplicating all values of the existing row but including the new primary key value. It would then update the foreign keys in the dependent table(s) and then delete the original row in the primary table. </P>
<P CLASS="t">The cascading delete stored procedure would first either delete the foreign key rows or update them to either NULL or their default value. It would then delete the row in the primary table. </P>
<P CLASS="t">If further cascading was needed, the delete or update of the foreign keys would be done using another delete/update stored procedure for the dependent table. </P>
<P CLASS="t">The insert statement does not require any special processing beyond what DRI automatically provides, so the insert could be done directly or wrapped in a stored procedure for consistency. </P>
<P CLASS="t">To perform multirow updates and deletes, you can create temporary tables containing the primary keys of the rows that are to be processed and then create a cursor on the temporary table to call the procedure for each row, one by one. This is because a range of rows cannot be passed to a subsequent update or delete stored procedure to perform the cascading operation.</P></BODY></HTML>
