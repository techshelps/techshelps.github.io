<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Multithreaded SQL Server Demo</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Multithreaded SQL Server Demo</H3><P CLASS="t">This example<B> </B>demonstrates how to create a multithreaded SQL Server application. Before you can run the demo, you must run Adduser.sql, included on the CD-ROM provided with this resource guide, from ISQL/w or SQL Enterprise Manager. This script will create 16 new users and grant them access to the various tables in the <B>pubs</B> database.</P>
<P CLASS="t">This multithreaded application will create up to 15 threads. Each thread will open a connection to SQL Server. None of the threads begins executing SQL statements until a manual reset event is signaled.<B> </B>In this case, the Win32 event acts like a traffic light. When the traffic light is "green," or signaled, each user starts sending SQL statements to the server.</P>
<P CLASS="t">By running your user interface on a separate thread with a higher priority, your users will perceive that your application is fast.<B> </B>Even with 15 users working on SQL Server, you can instantly and gracefully disconnect all threads by clicking <B>Stop</B>.</P>
<P CLASS="t">Clicking <B>Stop</B> resets the Win32 event object to the nonsignaled state and each thread disconnects from SQL Server and terminates by calling <B>_endthreadex</B>. The following illustration shows SQL Enterprise Manager.</P>
<P CLASS="a"><img src="sqlem.gif"></P>
<P CLASS="t">The SQL Enterprise Manager <B>Current Activity</B> dialog box makes it easy to see who is using the server. To watch the SQL statements change while the demo runs, click <B>Refresh</B>.</P>
<P CLASS="t">To begin developing 32-bit applications for SQL Server, see<B> </B>the Microsoft SQL Server development libraries and documentation for ODBC, DB-Library, and Open Data Services, available with the SQL Workstation product, which also includes a complete single-user SQL Server, or<B> </B>MSDN Professional. </P></BODY></HTML>
