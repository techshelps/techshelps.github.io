<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing SQL Workbook Publisher</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Installing SQL Workbook Publisher</H3><P CLASS="t">SQL Workbook Publisher can be installed on computers running Windows NT Server, Windows 95, or Windows NT Workstation.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>To Install SQL Workbook Publisher on a SQL Server</H4><P CLASS="t"><I>This task is for database administrators.</I></P>
<P CLASS="t">Before installing SQL Workbook Publisher on your SQL Server, you must copy Sqlwpub.sql from the Sql\Swp\Excel97 directory on the BackOffice Resource Kit CD-ROM to your Windows NT Server computer.</P>
<P CLASS="t"><B>Caution</B>   It is recommended that you execute Sqlwpub.sql in the <B>pubs</B> database to familiarize yourself with its functionality. If you run Sqlwpub.sql in the <B>model</B> database, all future databases, including <B>tempdb </B>each time SQL Server is started, will be populated with the SQL Workbook Publisher tables and stored procedures. Additionally, for Sqlwpub.sql to execute properly in the <B>model</B> database, <B>model</B> will need an additional 1 MB of space.</P>
<P CLASS="t">If you increase the size of the <B>model</B> database, thereby increasing the size of <B>tempdb</B> each time SQL Server is started, be sure you have enough disk space in the <B>master</B> database to accommodate it. If you do not have enough disk space, you will need to expand the <B>master</B> database, otherwise the next SQL Server startup will fail.</P>
<P CLASS="ls">Start Microsoft ISQL/w.</P>
<P CLASS="ls">In the <B>Server</B> box, select the server on which you want to install SQL Workbook Publisher.</P>
<P CLASS="ls">In the <B>Login ID</B> box, type a valid login identification for the SQL Server. Be sure the login identification allows database owner access to the database.</P>
<P CLASS="ls">In the <B>Password</B> box, type the password for the login ID, and click <B>Connect</B>.</P>
<P CLASS="ls">In the <B>DB</B> box of the <B>Query</B> window, select the database on which you want to install SQL Workbook Publisher. This database stores the data that users will query to create Microsoft Excel workbooks. It is also where users eventually will store new workbooks.</P>
<P CLASS="ls">Click <B>Load SQL Script</B>, locate Sqlwpub.sql, and select it.</P>
<P CLASS="ls">After the Sqlwpub.sql script appears in the query window, click <B>Execute Query</B>.</P>
<P CLASS="ls">Repeat steps 5 through 7 for each database on the server that you want to use for SQL Workbook Publisher.</P>
<P CLASS="t">You can quit Microsoft ISQL/w after all SQL Workbook Publisher objects have been installed.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>To Install SQL Workbook Publisher on an Excel Client</H4><P CLASS="t"><I>This task is for Excel users.</I></P>
<P CLASS="t">There are two SQL Workbook Publisher client installations: the Publisher and the Viewer. The Publisher installation is for users who create, edit, and view workbooks. The Viewer installation is for users who only view existing workbooks.</P>
<P CLASS="t">Double-click the Setup.exe icon for either Publisher or Viewer in the Sql\Swp\Excel97 directory on the BackOffice Resource Kit CD-ROM. SQL Workbook Publisher will be activated the next time the user starts Excel. After installation, the following commands are available on the <B>File</B> menu: </P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1"><B>Open from SQL Server</B> (Viewer and Publisher)</LI><LI CLASS="ULI1"><B>Save to SQL Server</B> (Publisher only)</LI><LI CLASS="ULI1"><B>Save As to SQL Server</B> (Publisher only)</LI></UL></SPAN><P CLASS="t"><B>Caution</B>   Do not install both the Publisher and the Viewer on the same computer. If you have one of them installed and would like to install the other, you must first remove the existing SQL Workbook Publisher application from your computer using Add/Remove Programs in Control Panel.</P>
<H4 CLASS="h3"><A NAME="sec2"></A>To Install SQL Workbook Publisher for Viewing Workbooks on an Intranet</H4><P CLASS="t"><I>This task is for Webmasters.</I></P>
<P CLASS="t">If you plan to prepare Excel workbooks to be viewed on an intranet, you must install the following:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Microsoft Internet Information Server (IIS) on a Windows NT Server. (The server can be the same as or different from the one on which the workbooks are stored.)</LI><LI CLASS="ULI1">Microsoft Internet Explorer, or another Web browser, on a Windows NT Server, Windows NT Workstation, or a Windows 95 client.</LI></UL></SPAN><P CLASS="t">You must perform the following tasks to enable your intranet for viewing Excel workbooks:</P>
<P CLASS="ls">Install SQL Workbook Publisher on the IIS.</P>
<P CLASS="ls">Prepare the IIS for viewing Excel workbooks.</P>
<H5 CLASS="h4"><A NAME="sec3"></A>Task 1: Install SQL Workbook Publisher on the IIS</H5><P CLASS="t">Each IIS needs its own set of SQL Workbook Publisher scripts. Perform these steps for each IIS you want to enable for SQL Workbook Publisher.</P>
<P CLASS="ls">Find the IIS directory.</P>
<P CLASS="lt1">The directory default name is the Inetsrv folder on Windows NT Server 3.51 and the InetPub folder on Windows NT Server 4.0. By default, at least two folders will appear in this directory: Scripts and Wwwroot.</P>
<P CLASS="ls">Create a new directory in Scripts called Sqlwpub.</P>
<P CLASS="ls">Create a new directory in Wwwroot called Sqlwpub.</P>
<P CLASS="ls">Copy the four files from the Sql\Swp\Intranet\Scripts directory on the BackOffice Resource Kit CD-ROM (Folders.htx, Folders.idc, Database.htx, and Database.idc) into Scripts\Sqlwpub.</P>
<P CLASS="ls">Copy the Help folder and its contents from the Sql\Swp\Intranet\Wwwroot directory on the BackOffice Resource Kit CD-ROM into Wwwroot\Sqlwpub.</P>
<P CLASS="ls">Copy the three graphics files from the Sql\Swp\Intranet\Wwwroot directory on the BackOffice Resource Kit CD-ROM (Folder.gif, Workbook.gif, and Question.gif) into Wwwroot\Sqlwpub.</P>
<H5 CLASS="h4"><A NAME="sec4"></A>Task 2: Prepare IIS for Viewing</H5><P CLASS="t">Each database requires its own system data source name (DSN), set of database files, and set of folder files. Perform these subtasks for each database.</P>
<H6 CLASS="h5"><A NAME="sec5"></A>Subtask 1: Create a system DSN</H6><P CLASS="ls">On the Windows <B>Start</B> menu, point to <B>Settings</B>, and click <B>Control Panel</B>.</P>
<P CLASS="ls">In <B>Control Panel</B>, double-click <B>ODBC</B>.</P>
<P CLASS="ls">In the <B>Data Sources</B> dialog box, click <B>System DSN</B>.</P>
<P CLASS="ls">In the <B>System Data Sources</B> dialog box, click <B>Add</B>.</P>
<P CLASS="ls">In the <B>Add Data Source</B> dialog box, select <B>SQL Server</B>, and click <B>OK</B>.</P>
<P CLASS="ls">In the <B>ODBC SQL Server Setup</B> dialog box, type a unique name in the<B> Data Source Name</B> (<B>DSN</B>) box (for example, DSN1).</P>
<P CLASS="ls">Enter the name of the SQL Server that stores the SQL Workbook Publisher database in the <B>Server</B> box, and click <B>Options</B>.</P>
<P CLASS="ls">Type the name of the database that stores the data for the workbooks (for example, <B>pubs</B>).</P>
<P CLASS="ls">Verify that <B>Trusted Connection</B> (Windows NT Server 3.51) or <B>Use Trusted Connection</B> (Windows NT Server 4.0) is not selected, and click <B>OK</B>.</P>
<H6 CLASS="h5"><A NAME="sec6"></A>Subtask 2: Edit database files</H6><P CLASS="ls">Copy and rename Database.idc to the name of the database you'll be referencing (for example, pubs.idc).</P>
<P CLASS="ls">Copy and rename Database.htx to a name matching the database.idc name (for example, pubs.htx).</P>
<H6 CLASS="h5"><A NAME="sec7"></A>Subtask 3: Edit folder files</H6><P CLASS="ls">Copy and rename folders.idc to an original name (for example, folders1.idc).</P>
<P CLASS="ls">Copy and rename folders.htx to a name matching the folders.idc name (for example, folders1.htx).</P>
<P CLASS="ls">In the renamed database.htx file, search for "folders.idc" and change it to the renamed folders.idc.</P>
<P CLASS="ls">In the renamed folders.htx file, edit the Visual Basic script. The script will look like this:</P>
<P>Sub LoadWorkbookID(WorkbookID)</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;cSQLWorkbookPublisher.LoadWorkbook WorkbookID, "&lt;%Server%&gt;", "<I>pubs</I>", <I>#</I></P>
<P>End Sub</P>
<P></P>
<P CLASS="lt1">where:</P>
<P CLASS="lt1"><I>pubs</I> should be changed to the name of the database. (It is suggested you use the <B>pubs</B> database to understand the functionality of SQL Workbook Publisher before implementing it fully on your production servers.)</P>
<P CLASS="lt1"><I>#</I> indicates the security mode the client uses to connect to SQL Server. 1 indicates standard security. 2 indicates integrated security.</P>
<P CLASS="ls">In the renamed folders.idc file, edit the following lines:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI2">"Datasource" should be the data source name you entered in Subtask 1, Step 6.</LI><LI CLASS="ULI2">"Username" should be the login ID used by IDC to connect to the server.</LI><LI CLASS="ULI2">"Template" should be the renamed folders.htx file that corresponds to this renamed folders.idc file.</LI></UL></SPAN><P CLASS="t">Instruct users to view workbooks at: http://<I>server</I>/scripts/sqlwpub/<I>database.idc</I></P>
<P CLASS="t">where:</P>
<P CLASS="t"><I>database.idc</I> has been changed to the name of your database. If you have multiple databases and servers, use Template.htm included in the Sql\Swp\Intranet directory on the BackOffice Resource Kit CD-ROM to create a home page for your users. You will need to create your own links.</P></BODY></HTML>
