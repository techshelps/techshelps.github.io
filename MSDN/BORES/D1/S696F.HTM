<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Calculating the Size of a 9,000,000-Row Table with a Nonclustered Index</TITLE><BODY BGCOLOR="#FFFFFF">


<H2 CLASS="h1">Calculating the Size of a 9,000,000-Row Table <BR>with a Nonclustered Index</H2><P CLASS="t">The following example calculates the size of a nonclustered index on the 9,000,000-row table used in "Calculating the Size of a 9,000,000-Row Table with a Clustered Index," earlier in this article. There are two keys, one fixed- and one variable-length. The table contains:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">9,000,000 rows.</LI><LI CLASS="ULI1">Sum of bytes of fixed-length columns = 100.</LI><LI CLASS="ULI1">Sum of bytes of two variable-length columns = 50.</LI><LI CLASS="ULI1">Nonclustered key, fixed-length = 4 bytes.</LI><LI CLASS="ULI1">Nonclustered key, variable-length = 20 bytes. </LI></UL></SPAN><P CLASS="t">The five steps previously discussed were used to ascertain the index size.</P>
<P CLASS="ls">Calculate the index row size.</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp; 9    Overhead</P>
<P>+    4    Sum of length of fixed-length keys</P>
<P>+   20    Sum of length of variable-length keys</P>
<P>+    2    Number of variable-length keys + 1</P>
<P>———---    </P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;35    Subtotal</P>
<P>+    1    (Subtotal / 256) + 1</P>
<P>———---    </P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;36    Size of Leaf Index Row</P>
<P></P>
<P CLASS="ls">Calculate the number of leaf pages in the index.</P>
<P>2,016/36 = 56 nonclustered leaf rows per page</P>
<P>9,000,000/56 = 160,715 leaf pages</P>
<P></P>
<P CLASS="ls">Calculate the size of the nonleaf rows.</P>
<P>36 + 4 = 40 size of nonleaf index row</P>
<P></P>
<P CLASS="ls">Calculate the number of nonleaf pages.</P>
<P>(2,016/40) — 2 = 48 nonleaf index rows per page</P>
<P>160,715/48 = 3,348 index pages, level 1</P>
<P>3,348/48 = 69 index pages, level 2</P>
<P>69/48 = 2 index pages, level 3</P>
<P>2/48 = 1 index page, level 4</P>
<P></P>
<P CLASS="ls">Calculate the total number of nonleaf index pages.</P>
<P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="148pt" VALIGN="TOP"><COL WIDTH="50pt" VALIGN="TOP"><COL WIDTH="147pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="thf">Totals</P></TD><TD VALIGN="TOP"><P CLASS="thf">Pages</P></TD><TD VALIGN="TOP"><P CLASS="thf">Rows</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Level 4 (root)</P></TD><TD VALIGN="TOP"><P CLASS="tt">           1</P></TD><TD VALIGN="TOP"><P CLASS="tt">              2</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Level 3</P></TD><TD VALIGN="TOP"><P CLASS="tt">           2</P></TD><TD VALIGN="TOP"><P CLASS="tt">            69</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Level 2</P></TD><TD VALIGN="TOP"><P CLASS="tt">         69</P></TD><TD VALIGN="TOP"><P CLASS="tt">       3,348</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Level 1</P></TD><TD VALIGN="TOP"><P CLASS="tt">    3,348</P></TD><TD VALIGN="TOP"><P CLASS="tt">   160,715</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Level 0 (leaf)</P></TD><TD VALIGN="TOP"><P CLASS="tt">160,715</P></TD><TD VALIGN="TOP"><P CLASS="tt">9,000,000</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"></P></TD><TD VALIGN="TOP"><P CLASS="tt">———</P></TD><TD VALIGN="TOP"><P CLASS="tt"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Total number of 2K pages</P></TD><TD VALIGN="TOP"><P CLASS="tt">164,135</P></TD><TD VALIGN="TOP"><P CLASS="tt"></P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P></BODY></HTML>
