<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Checking the Validity of the Saved Data</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Checking the Validity of the Saved Data </H3><P CLASS="t">You can use the Transact-SQL string function ASCII(<I>char_expr</I>) to reveal the character that is saved in the SQL Server database. You can also use the ASCII(<I>column_name</I>) function to reveal the ASCII value for a particular column in the database.</P>
<P CLASS="t">For example, assume you have saved the character "<SPAN CLASS="Symbol">±</SPAN>" on a server with code page OEM 437. If you select this data from ISQL/w (which has a code page of ANSI 1252) when AutoANSItoOEM is on, you will see the "<SPAN CLASS="Symbol">±</SPAN>" character. AutoANSItoOEM has converted the OEM 437 "<SPAN CLASS="Symbol">±</SPAN>" (which has an ASCII value of 241) to the ANSI 1252 "<SPAN CLASS="Symbol">±</SPAN>" (which has an ASCII value of 177). However, if you select the data from ISQL/w when AutoANSItoOEM is off, you will see the "ñ" character. AutoANSItoOEM has not converted the OEM 437 ASCII value of 241 but instead has retrieved the character for the ANSI 1252 ASCII value of 241.</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="60pt" VALIGN="TOP"><COL WIDTH="68pt" VALIGN="TOP"><COL WIDTH="103pt" VALIGN="TOP"><COL WIDTH="113pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="thf">Code page</P></TD><TD VALIGN="TOP"><P CLASS="th">Character <SPAN CLASS="Symbol">±</SPAN></P></TD><TD VALIGN="TOP"><P CLASS="th">AutoANSItoOEM ON</P></TD><TD VALIGN="TOP"><P CLASS="th">AutoANSItoOEM OFF</P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">OEM 437</P></TD><TD VALIGN="TOP"><P CLASS="tt">ASCII <SPAN CLASS="Symbol">241</SPAN></P></TD><TD VALIGN="TOP"><P CLASS="tt"><SPAN CLASS="Symbol">±</SPAN></P></TD><TD VALIGN="TOP"><P CLASS="tt"><SPAN CLASS="Symbol">±</SPAN></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">ANSI 1252</P></TD><TD VALIGN="TOP"><P CLASS="tt">ASCII 177</P></TD><TD VALIGN="TOP"><P CLASS="tt"><SPAN CLASS="Symbol">±</SPAN></P></TD><TD VALIGN="TOP"><P CLASS="tt">ñ (ASCII 241)</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">Another way to reveal the code page is to set AutoANSItoOEM to OFF and then query the data both from a Windows tool and from <B>isql</B> at a command prompt. </P></BODY></HTML>
