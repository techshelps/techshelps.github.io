<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Microsoft Exchange Server</TITLE><BODY BGCOLOR="#FFFFFF">


<H2 CLASS="h1">Microsoft Exchange Server</H2><P CLASS="t"><B><I>Many corporate-solution providers combine Microsoft Exchange Server with Microsoft SQL Server.</I></B></P>
<P CLASS="t">To avoid any conflicts between Microsoft Exchange Server and Microsoft SQL Server, use the following basic troubleshooting techniques to diagnose and resolve most SQL Mail problems. Typically, errors in starting a SQL Mail session or sending mail from SQL Mail with a Microsoft Exchange Server fall into two categories: permissions problems and Microsoft Exchange client setup problems. SQL Mail functionality is documented in SQL Server 6.5 Books Online. You should thoroughly review this information before using SQL Mail.</P>
<P CLASS="t">To ensure that SQL Mail and Microsoft Exchange Server function together without conflict, perform the steps in the following checklist, preferably in the order given: </P>
<P CLASS="ls">Log on to Windows NT with a user account that is an administrator of the local computer and is a domain account.</P>
<P CLASS="ls">Confirm that the Microsoft Exchange client, Exchng32.exe, can connect to the Microsoft Exchange server and mail can be sent.</P>
<P CLASS="ls">Confirm that the Microsoft Exchange profile used does not have a Personal Message Store (.pst) by running Mail and Fax in Control Panel.</P>
<P CLASS="ls">Click <B>Show Profiles</B>.</P>
<P CLASS="ls">In the <B>Mail </B>dialog box, click the default profile in the <B>When starting Microsoft Exchange, use this profile </B>list.</P>
<P CLASS="ls">Click <B>Properties</B>.</P>
<P CLASS="ls">Click the <B>Services </B>tab and confirm that the only services are Microsoft Exchange Server and Personal Address Book.</P>
<P CLASS="ls">Click the <B>Delivery </B>tab. In the <B>Deliver new mail to the following location </B>list, click <B>Mailbox - </B><I>friendly_user_name</I> where <I>friendly_user_name</I> is the name of the user who logged on to Windows NT in step 1.</P>
<P CLASS="ls">To run SQL Mail with a Microsoft Exchange Server, the <B>MSSQLServer</B> service must be run under the same user account that logged on during step 1 above. To set this from Control Panel, double-click Services, click <B>MSSQLServer</B>, and then click <B>Startup</B>.</P>
<P CLASS="ls">Confirm that the SQL Mail user name and password are correct by running SQL Server Setup. Click <B>Set Server Options </B>and then click <B>Mail Login</B>. The user name must match the profile name from step 3 above.</P>
<P CLASS="lt1"><B>Note</B>   The password and Copy SQL Mail Configuration in the <B>Current User Account</B> check box do not matter since both no longer apply. SQL Server Setup version 6.5 will ask for only the Microsoft Exchange Profile name.</P>
<P CLASS="ls">Test SQL Server access permissions to the Microsoft Exchange Server. You can do this by using the <B>xp_cmdshell </B>extended stored procedure, which runs with the same permissions as SQL Mail. Use the following command to test connectivity to the server, assuming the Microsoft Exchange Server is located on a computer named NTServer.</P>
<P>xp_cmdshell "NET USE \\NTServer\IPC$"</P>
<P></P>
<P CLASS="lt1"><B>Note</B>   If the above command fails, step 4 has not been completed correctly.</P>
<P CLASS="ls">At this point SQL Mail should be able to Autostart or be started manually with the <B>xp_startmail </B>extended stored procedure. Additionally, you can choose the profile to use with <B>xp_startmail </B>by replacing <I>Profile name</I> below with the profile name from step 3, as in the following example:</P>
<P>xp_startmail "<I>Profile name</I>",""</P>
<P></P></BODY></HTML>
