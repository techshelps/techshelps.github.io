<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Troubleshooting</TITLE><BODY BGCOLOR="#FFFFFF">


<H2 CLASS="h1">Troubleshooting</H2><P CLASS="t">This section explains some ways to correct problems you may have encountered when upgrading SQL Server.</P>
<P CLASS="t">If you encounter a problem after copying all the files, remove all SQL directories and files and remove any entries in the Registry for SQL Server. Be careful when editing anything in the Registry. Should you inadvertently delete a key that does not belong to SQL Server, you can restore the Registry with the backup you made earlier. For information about restoring the Registry, see the documentation included with Microsoft SQL Server.</P>
<P CLASS="t"><B>Caution</B>   Using the Registry Editor incorrectly can cause serious problems that require you to reinstall SQL Server. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. </P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">If you are upgrading from SQL Server 4.2<I>x</I>, remove \SQLServer and \SQLMonitor from the following: </LI></UL></SPAN><p>&nbsp;&nbsp;&nbsp;&nbsp;\HKEY_LOCAL_MACHINE</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;       \SOFTWARE</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;          \Microsoft</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;                \SQLServer</P>
<P></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;\HKEY_LOCAL_MACHINE</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;       \SYSTEM</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;            \CurrentControlSet</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;                    \Services</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;                         \SQLServer</P>
<P></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;\HKEY_LOCAL_MACHINE</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;       \SYSTEM</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;            \CurrentControlSet</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;                    \Services</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;                         \SQLMonitor</P>
<P></P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">If you are upgrading from SQL Server 6.0, remove \MSSQLServer and \SQL Executive from the following: </LI></UL></SPAN><p>&nbsp;&nbsp;&nbsp;&nbsp;\HKEY_LOCAL_MACHINE</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;       \SOFTWARE</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;          \Microsoft</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;                \MSSQLServer</P>
<P></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;\HKEY_LOCAL_MACHINE</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;       \SYSTEM</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;          \CurrentControlSet</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;                  \Services</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;                       \MSSQLServer</P>
<P></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;\HKEY_LOCAL_MACHINE</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;       \SYSTEM</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;           \CurrentControlSet</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;                  \Services</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;                       \SQL Executive</P>
<P></P>
<P></P>
<P CLASS="t">After the preceding entries are removed, you have two options to try the upgrade again:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Option One
<P CLASS="ls2">Reinstall the original SQL Server version.</P>

<P CLASS="ls2">Once installed, stop the SQL Server services and replace all of the data and log device files, including Master.dat, with the backed-up versions. The directories for these files are listed in the <B>phyname</B> column of the output from the <B>sysdevices</B> table. You noted the file names in the "Microsoft Windows NT Backup" section earlier.</P>

<P CLASS="ls2">Fix whatever caused the upgrade to fail and try the upgrade again. If the upgrade does not successfully complete, contact your primary support provider. </P></LI><LI CLASS="ULI1">Option Two
<P CLASS="ls2">Reinstall the SQL Server version that you are trying to upgrade to.</P>

<P CLASS="ls2">Re-execute the CREATE DATABASE statement and the ALTER<B> </B>DATABASE statement to re-establish the fragments.</P>


<UL><LI CLASS="ULI2">The user databases need to be re-created in exactly the same way that they were originally created. That is, the device usage, log space allocation, and segment definitions in the new database must have values identical to those that existed when the database was dumped. This information is kept in the <B>sysusages</B> table of the <B>master</B> database. You can also find this information in the output from the Sqldump.sql script that you ran in the "Microsoft SQL Server Dump" section earlier.
<P CLASS="ls2">Load the earlier version of the SQL Server databases, while keeping the following in mind:</P></LI><LI CLASS="ULI2">The user database dump must be a full database dump, not a transaction log dump.</LI><LI CLASS="ULI2">The SQL Server version that you are trying to upgrade to must use the same sort order as the earlier version.</LI></UL></LI></UL></SPAN><P CLASS="t"><B>Note</B>   The <B>master</B> database is not allowed to be loaded or upgraded from earlier versions of SQL Server dumps.</P></BODY></HTML>
