<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Running the Integrity Checker</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Running the Integrity Checker</H3><P CLASS="t">The Outfile.sql produced by running the Dbchk<I>xxx</I>.sql scripts can then be used to check the integrity of all databases in the system.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Usage</H4><P CLASS="t">From the command prompt:</P>
<P CLASS="t"><B>ISQL /Usa /P</B><I>password</I> <B>/S</B><I>server_name</I> <B>/i</B><I>location</I>\<I>outfile.sql</I> <B>/o</B><I>report.rpt</I></P>
<P CLASS="lt1">where:</P>
<P CLASS="term2"><B>/P</B><I>password</I></P>
<P CLASS="dt2">Is the password for the SA login.</P>
<P CLASS="term2"><B>/S</B><I>server_name</I></P>
<P CLASS="dt2">Is the name of the server on which SQL Server resides.</P>
<P CLASS="term2"><B>/i</B><I>location</I></P>
<P CLASS="dt2">Is the full path to the <I>outfile.sql</I> script.</P>
<P CLASS="term2"><I>outfile.sql</I></P>
<P CLASS="dt2">Is the name of the file that was created by running Dbchkcrs.sql or Dbchktbl.sql.</P>
<P CLASS="term2"><B>/o</B><I>report.rpt</I></P>
<P CLASS="dt2">Is the name of the file <B>isql</B> will produce that will contain the results of the integrity checks on the databases.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Remarks</H4><P CLASS="t">The Report.rpt file produced by the second run of <B>isql</B> can either be checked manually before running the dumps or can be run through a DBCC report scanner.</P>
<P CLASS="t">The Dbchk<I>xxx</I>.sql scripts can be customized to do further processing. One option would be to add logic to put each database into single-user or read-only mode before running the DBCC commands, and take it out of single-user or read-only mode after the checks complete. This might be desirable since the DBCC commands may report spurious errors if they are run while users are updating the database. The decision to do this must be weighed against the availability requirements of the database, and whether there is a time window during which the database can be made read-only. Another option would be to change the Dbchkxxx.sql scripts so that they actually ran the DBCC commands, rather than building a script to be run later. Another option would be to have the logic encoded in a stored procedure which could be scheduled to run at specific times using the task manager in SQL Enterprise Manager.</P></BODY></HTML>
