<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Deleting Records Containing NULLs Using DAO</TITLE><BODY BGCOLOR="#FFFFFF">


<H2 CLASS="h1">Deleting Records Containing NULLs Using DAO</H2><P CLASS="t">When you use DAO to attach a SQL Server 6.5 table, an attempt to delete records that contain one or more NULL values results in the following error:</P>

<PRE>Data has changed. Operation stopped.
</PRE>
<P CLASS="t">The SQL Server 6.5 ODBC driver always sets the ANSI_NULLS option to ON on every connection that is to be ANSI compliant. This means that a search condition like 'WHERE &lt;colname&gt; = NULL' is always evaluated to FALSE. In accordance with the ANSI specification, the correct syntax when searching for NULLs is 'WHERE &lt;colname&gt; IS NULL'. </P>
<P CLASS="t">Consider a SQL Server table attached in Microsoft Access/Visual Basic that has NULL values. An attempt to delete a row that has one or more NULL fields will not succeed because Microsoft Access/Visual Basic uses the following syntax: </P>

<PRE>Delete from &lt;tablename&gt; 
Where &lt;colname1&gt; = NULL And &lt;colname2&gt; = 'xxx'
</PRE>
<P CLASS="t">Because the above search condition is always evaluated to FALSE, no rows will be affected by the delete and Microsoft Access/Visual Basic will display the message, "Data has changed. Operation stopped." </P>
<P CLASS="t">To work around this problem, do one of the following: </P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Update the NULL values to non-NULLs and then delete the record.</LI><LI CLASS="ULI1">Add a <B>timestamp</B> (a SQL Server data type) column to the SQL Server table that does not allow NULLs, and copy the data from the existing tables to the new ones. Then, delete the existing tables and rename the new tables.</LI><LI CLASS="ULI1">If using the 2.65.0240 SQL Server driver that shipped with SQL Server 6.5 Service Pack 2, deactivate the <B>Use ANSI NULLS, Padding, and Warnings</B> check box for the data source.</LI></UL></SPAN></BODY></HTML>
