<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Calculating the Size of a Table with a Nonclustered Index</TITLE><BODY BGCOLOR="#FFFFFF">


<H2 CLASS="h1">Calculating the Size of a Table with a Nonclustered Index</H2><P CLASS="t">The steps in this section show how to calculate the size of a table with a nonclustered index.</P>
<H3 CLASS="h3"><A NAME="sec0"></A>Step 1: Calculate the Size of the Leaf Index Row</H3><P CLASS="t">Calculating the size of nonclustered index rows depends on whether the keys are fixed- or variable-length.</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">If all the keys are fixed-length, calculate the size of nonclustered leaf rows as follows:
<P CLASS="lt1">7 + (sum of fixed-length keys) = size of leaf index row</P></LI><LI CLASS="ULI1">If the keys include variable-length columns, calculate the size of nonclustered leaf rows as follows:
<P CLASS="lt1">9 + (sum of length of fixed-length keys) + (sum of length of variable-length keys) + (number of variable-length keys) + 1 = Subtotal</P>

<P CLASS="lt1">(Subtotal) + ((Subtotal/256) + 1) = (size of leaf index row)</P></LI></UL></SPAN><P CLASS="t">The values 7 and 9 in the previous equations are overhead that SQL Server uses for internal storage.</P>
<H3 CLASS="h3"><A NAME="sec1"></A>Step 2: Calculate the Number of Leaf Pages in the Index</H3><P CLASS="t">Calculate the number of leaf pages using these formulas:</P>
<P CLASS="t">2,016/(size of leaf index row) = number of leaf rows per page</P>
<P CLASS="t">(number of rows in table)/(number of leaf rows per page) = number of leaf pages</P>
<H3 CLASS="h3"><A NAME="sec2"></A>Step 3: Calculate the Size of the Nonleaf Rows</H3><P CLASS="t">Calculate the size of nonleaf rows using this formula: </P>
<P CLASS="t">(size of leaf index row) + 4 = size of nonleaf row</P>
<P CLASS="t">The value 4 in the previous equation is overhead that SQL Server uses for internal storage.</P>
<H3 CLASS="h3"><A NAME="sec3"></A>Step 4: Calculate the Number of Nonleaf Pages</H3><P CLASS="t">Calculate the number of nonleaf pages using these formulas:</P>
<P CLASS="t">(2,016/size of nonleaf row) – 2 = number of nonleaf index rows per page</P>
<P CLASS="t">(number of leaf pages/number of nonleaf index rows per page) = number of index pages at level 1</P>
<P CLASS="t">If the result is greater than 1, repeat the following division step, using the quotient as the next dividend, until the quotient is equal to 1. When the quotient is equal to 1, you have reached the root level of the index.</P>
<P CLASS="t">(number of index pages at last level)/(number of nonleaf index rows per page) = number of index pages at next level</P>
<H3 CLASS="h3"><A NAME="sec4"></A>Step 5: Calculate the Total Number of Nonleaf Index Pages</H3><P CLASS="t">Calculate the total number of nonleaf index pages using this formula:</P>
<P CLASS="t">(number of index pages at level 0) + (number of index pages at next level) + (number of index pages at next level) + (number of index pages at next level) […] = (total number of 2K data pages used)</P></BODY></HTML>
