<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Prepare SQL Server 6.0</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Prepare SQL Server 6.0</H3><P CLASS="proch">To prepare your SQL Server 6.0 to be upgraded to version 6.5</P>
<P CLASS="ls">From a query window, set the default database of the system administrator (SA) to <B>master</B> by executing:</P>
<P>sp_defaultdb sa, master</P>
<P></P>
<P CLASS="ls">Make sure all the databases are not set to read-only by reviewing the <B>sp_helpdb</B> output from the Sqldump.sql script (see the status column). </P>
<P CLASS="ls">Check the SQL Server documentation to determine how much physical disk space is required for the upgrade.</P>
<P CLASS="ls">Run Chkupg65.exe to check that database status is acceptable, that all necessary comments exist in the <B>syscomments</B> system table, and that there are no keyword conflicts.</P>
<P CLASS="lt1"><B>Note</B>   Chkupg65.exe is included with SQL Server 6.5.</P>
<P CLASS="ls">Resolve any keyword conflicts before upgrading SQL Server. </P>
<P CLASS="ls">Check how much memory is given to SQL Server.</P>
<P CLASS="lt1">In SQL Server version 4.21a, the minimum value is 3,072 (6 MB), while in SQL Server versions 6.0 and 6.5, the minimum value is 4,096 (8 MB). If you have additional physical RAM, increase the memory given to SQL Server to the level recommended in the SQL Server documentation.</P>
<P CLASS="lt1"><B>Note</B>   Upgrading a database requires all objects to be scanned. In doing so, the upgrade may exceed some of your current run-time configuration values. To avoid this, you may want to temporarily double the size of open objects and locks before the upgrade. Make sure you have enough memory dedicated to SQL Server to accommodate the changed values.</P>
<P CLASS="ls">Make sure the open databases configuration option is equal to or greater than the total number of databases on your system. You can change this configuration from a query window by using:</P>
<P><B>sp_configure</B> [config_name [<B>,</B> config_value]]</P>
<P></P>
<P CLASS="lt1">Dynamic options take effect immediately after the RECONFIGURE statement has been executed. For all non-dynamic options, SQL Server must be stopped and restarted before the options can take effect. For details, see the RECONFIGURE statement.</P>
<P CLASS="ls">Execute <B>sp_helpsort</B> to determine what sort order and character sets you have installed.</P>
<P CLASS="lt1">For SQL Server 6.0 and SQL Server 6.5, these values can be found in Appendix A of <I>Microsoft SQL Server Setup</I> (see the "About Character Sets" and "Sort Order Ids" sections). For SQL Server 4.21a, these values can be found in the configuration guide.</P>
<P CLASS="ls">Shut down SQL Server and close any SQL Server windows before upgrading. </P></BODY></HTML>
