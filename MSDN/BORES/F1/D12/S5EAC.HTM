<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Buddy Dropper</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Using Buddy Dropper</H3><P CLASS="t">Use this tool when you want to avoid manual operations while working with a multitude of servers.</P>
<P CLASS="proch">To run Buddy Dropper</P>
<P CLASS="ls">From the <B>Start</B> menu, choose <B>Run</B>, and then choose <B>Browse</B> to locate the Buddy Dropper directory.</P>
<P CLASS="ls">Double-click Dropper.exe.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Automating Tasks</H4><P CLASS="t">You can use Buddy Dropper to automate the following tasks:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Starting applications on all servers.</LI><LI CLASS="ULI1">Setting variables on all servers inherited from parents.</LI><LI CLASS="ULI1">Running the children sites of all servers.</LI><LI CLASS="ULI1">Starting applications on My Lab.</LI><LI CLASS="ULI1">Setting variables on My Lab inherited from parents.</LI><LI CLASS="ULI1">Running applications on children of My Lab.</LI><LI CLASS="ULI1">Starting applications on ntserver1.</LI><LI CLASS="ULI1">Uninheriting variables from My Lab, such as <BR><B>Directory Name=DropperTest1</B>, <B>System Root=(blank)</B>.</LI><LI CLASS="ULI1">Setting the <B>COMPUTERNAME</B> reserved variable to <B>ntserver1</B>.</LI><LI CLASS="ULI1">Running All Server actions.</LI><LI CLASS="ULI1">Running My Lab actions, such as<B> </B>Get System Root path, If we obtained the System Root, and so on (see figure below).</LI><LI CLASS="ULI1">Starting application on ntserver2.</LI></UL></SPAN><H4 CLASS="h3"><A NAME="sec1"></A>Buddy Dropper User Interface</H4><P CLASS="t">The following figure shows the different panes in Buddy Dropper.</P>
<P CLASS="a"><img src="xerk_f05.gif"></P>
<P CLASS="proch">To add a server node</P>
<P CLASS="ls">Select a server group to which you want to add a node, for example, All Servers.</P>
<P CLASS="ls">From the <B>Edit</B> menu, choose <B>Add Server</B> or <B>Edit</B>.</P>
<P CLASS="ls">Select <B>Add Server Group</B>.</P>
<P CLASS="proch">To add an action</P>
<P CLASS="ls">Select a server node to which to add the action, such as My Lab.</P>
<P CLASS="ls">Select an action node, such as All Actions.</P>
<P CLASS="ls">From the <B>Edit</B> menu, choose <B>Add Action</B>.</P>
<P CLASS="proch">To add a variable</P>
<P CLASS="ls">Select a server node to which to add the variable.</P>
<P CLASS="ls">Select a variable.</P>
<P CLASS="ls">From the <B>Edit</B> menu, choose <B>Add Variable</B>.</P>
<P CLASS="t">If variables are defined both on a parent and on a child of the parent, the child's setting overrides the parent's setting. Siblings inherit "clean" variables from their parents; that is, siblings may not pass data from one to another by using Dropper variables (use temporary registry keys, environment variables, and so on).</P>
<H4 CLASS="h3"><A NAME="sec2"></A>Sample Dropper Script Used to Create a Directory</H4><P CLASS="t">Suppose you have a laboratory that contains several computers. Some are Windows NT Server/Microsoft Exchange Server computers; others are Windows 95 client computers. You want to create a certain directory under the system root directory on the Windows NT servers. You have decided to use Dropper because it will save you a lot of button-clicking, because it has a cooler user interface than the command prompt, and because you're eating lunch in your office and don't want to walk over to the lab. </P>
<P CLASS="t">To create a directory under the system root directory of Windows NT Server, you'll need to do the following (each step is explained in more detail later in this document):</P>
<P CLASS="ls">Set up your list of servers and variables. Then, for each computer in the lab, complete steps two through four:</P>
<P CLASS="ls">For each computer in the lab, obtain the registry value path for the system root directory on the computer by using the Get Registry Value action. If you can't obtain this key, skip to the next computer.</P>
<P CLASS="ls">Obtain the system root path.</P>
<P CLASS="ls">Create a directory (of previously defined names) under the system root directory.</P>
<P CLASS="ls">Now you're ready to run the Dropper script.</P>
<H5 CLASS="h4"><A NAME="sec3"></A>Step One</H5><P CLASS="proch">To set up your list of servers and variables</P>
<P CLASS="ls">From the <B>File</B> menu, choose <B>New</B> to create a new Dropper script.</P>
<P CLASS="ls">Select <B>All Servers</B>.</P>
<P CLASS="ls">From the <B>Edit</B> menu, choose <B>Add Server Group</B>.</P>
<P CLASS="ls">Name the group "My Lab," and then choose <B>OK</B>.</P>
<P CLASS="ls">Select the <B>My Lab</B> server group.</P>
<P CLASS="ls">From the <B>Edit</B> menu, choose <B>Add Server</B>.</P>
<P CLASS="ls">Type the name for one of your lab computers, and then choose <B>OK</B>.</P>
<P CLASS="ls">Repeat steps 6 and 7 for all computers in your lab on which you want the directory created.</P>
<P CLASS="t">The next step is to create variables to define the behavior of the script.</P>
<P CLASS="proch">To create variables</P>
<P CLASS="ls">Select the <B>My Lab</B> server group.</P>
<P CLASS="ls">Click anywhere in the Variables pane.</P>
<P CLASS="ls">From the <B>Edit</B> menu, choose <B>Add Variable</B>.</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI2">Name = "Directory Name"</LI><LI CLASS="ULI2">Value = "DropperTest1"</LI></UL></SPAN><P CLASS="ls">From the <B>Edit</B> menu, choose <B>Add Variable</B>.</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI2">Name = "System Root" </LI><LI CLASS="ULI2">Value = "" (blank)</LI></UL></SPAN><P CLASS="t">Your screen should resemble the figure below.</P>
<P CLASS="a"><img src="xerk_f06.gif"></P>
<H5 CLASS="h4"><A NAME="sec4"></A>Step Two</H5><P CLASS="t">Now you are ready to add a few actions. To do so, you need to obtain the registry value for the system root directory by using the Get Registry Value action, as shown in the following procedure.</P>
<P CLASS="proch">To obtain the registry value</P>
<P CLASS="ls">Select the My Lab server group.</P>
<P CLASS="ls">Select the All Actions node.</P>
<P CLASS="ls">From the <B>Edit</B> menu, choose <B>Add Action</B>.</P>
<P CLASS="ls">Select <B>Get Registry Value</B>, and then choose <B>OK</B>.</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI2">Name = "Get System Root path"</LI><LI CLASS="ULI2">Server = "%COMPUTERNAME%"</LI><LI CLASS="ULI2">Key = "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\<BR>CurrentVersion\SystemRoot"</LI><LI CLASS="ULI2">Variable = "System Root"</LI></UL></SPAN><P CLASS="t">Now you have created an action that will take the System Root path out of the current computer's registry and place the value into the System Root <I>Dropper Variable</I>.</P>
<H5 CLASS="h4"><A NAME="sec5"></A>Step Three</H5><P CLASS="t">Before proceeding further, you need to obtain the system root path.</P>
<P CLASS="proch">To obtain the system root path</P>
<P CLASS="ls">Select the All Actions node.</P>
<P CLASS="ls">From the <B>Edit</B> menu, choose <B>Add Action</B>.</P>
<P CLASS="ls">Select <B>Conditionally Execute Action Group</B>, and then choose <B>OK</B>.</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI2">Name = "If we obtained the System Root"</LI><LI CLASS="ULI2">Variable Name = "System Root"</LI><LI CLASS="ULI2">Compare = "does NOT EQUAL", "" (variable)</LI></UL></SPAN><P CLASS="ls">Choose <B>OK</B>.</P>
<P CLASS="t">This action tests the value of the Dropper variable "System Root" with (variable). If the System Root is not equal to (variable), then the children of this action will be executed.</P>
<H5 CLASS="h4"><A NAME="sec6"></A>Step Four</H5><P CLASS="t">Now you need to add the action to create the directory as a child of the conditional action in the last step. Note that this action will only be carried out if the System Root is not blank.</P>
<P CLASS="proch">To create the directory</P>
<P CLASS="ls">Select the <B>If we obtained the System Root</B> action group.</P>
<P CLASS="ls">From the <B>Edit</B> menu, choose <B>Add Action</B>.</P>
<P CLASS="ls">Select <B>Create Directory</B>.</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI2">Name = "Create the Directory"</LI><LI CLASS="ULI2">Server = "%COMPUTERNAME%"</LI><LI CLASS="ULI2">Directory = "%System Root%\%Directory Name%"</LI></UL></SPAN><P CLASS="ls">Choose <B>OK</B>.</P>
<P CLASS="t">Your screen should resemble the following figure.</P>
<P CLASS="a"><img src="xerk_f07.gif"></P>
<P CLASS="t">You're done!</P>
<H5 CLASS="h4"><A NAME="sec7"></A>Step Five</H5><P CLASS="proch">To run the Buddy Dropper script</P>
<P CLASS="ls">From the <B>Run</B> menu, choose <B>Start All</B>.</P></BODY></HTML>
