<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Defragmentation and Compaction</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Defragmentation and Compaction</H3><P CLASS="t">You can use the EDBUTIL utility to defragment and compact the data on your hard drive. </P>
<P CLASS="t">To perform an offline compaction of a database, use the following syntax: <B>edbutil /d &lt;</B><B><I>database name</I></B><B>&gt; [options]</B></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="85pt" VALIGN="TOP"><COL WIDTH="265pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">Option</P></TD><TD VALIGN="TOP"><P CLASS="th">Description</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>&lt;</B><B><I>Database name</I></B><B>&gt;</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">File name of database to compact, or one of the following: <B>/ispriv</B>,<B> /ispub</B>,<B> or /ds</B></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>Options</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Zero or more of the following switches, separated by a space: /l&lt;<I>path</I>&gt; - location of log files (default is the current directory).</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>/s&lt;path&gt;</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Location of system files.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>/r</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Repairs database while defragmenting.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>/b&lt;db&gt;</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Creates backup copy under the specified name.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>/t&lt;db&gt;</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Sets the temporary database name with a default name of Tempdfrg.edb.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>/p</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Preserves temporary database</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>/n</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Instructs the program to dump defragmentation information to the Dfrginfo.txt file.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>/o</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Suppresses the logo.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">The <B>/ispriv</B>, <B>/ispub</B>, and <B>/ds</B> switches use the registry to automatically set the database name, log file path, and system file path for the appropriate Microsoft Exchange Server store (public or private). Before defragmentation begins, soft recovery is always performed to ensure that the database is in a consistent state. If you disable instating by using the <B>/p</B> switch, the original database is preserved uncompacted, and the temporary database will contain the defragmented version of the database.</P></BODY></HTML>
