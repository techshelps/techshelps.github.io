<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Gimport Tool</TITLE><BODY BGCOLOR="#FFFFFF">


<H2 CLASS="h1">Gimport Tool</H2><P CLASS="t">The Gimport tool creates, deletes, and modifies postoffice address list (POL) groups that contain Microsoft Mail users and X.400, FAX, SMTP, SNADS, PROFS, and MHS gateway users.</P>
<P CLASS="t">You can create groups in the POL that contain users defined on the local postoffice, as well as users defined on external postoffices or as gateway addresses. However, any groups that contain external users cannot be exported to other Microsoft Mail postoffices, and these groups cannot be included in directory synchronization. This limitation can create challenges for organizations that have several Microsoft Mail postoffices and users that need to send mail to groups containing users on several different postoffices.</P>
<P CLASS="t">There is no method for creating such cross-postoffice groups only once and then exporting these groups to other postoffices. The groups can be exported through the Microsoft Mail Administrator program, and when a user on the postoffice where the group was created sends mail to the group, all users (local and external) receive the message. However, when a user on another postoffice sends mail to an exported group, only those users defined on the postoffice where the group was created receive the mail message; external users in that group do not. </P>
<P CLASS="t">The only way to enable all users on all postoffices to successfully send mail to the same group of users is to create that group on all postoffices. For large organizations with several postoffices and thousands of users, this process can be very time-consuming and prone to error.</P>
<P CLASS="t">Gimport.exe makes this process easier. Although you still need to create the groups on every postoffice, you can automate this task to a certain degree. To use Gimport, manually create the group on one postoffice, and then extract the group information to a text file. The information in the text file can then be imported to other postoffices.</P>
<H3 CLASS="h3"><A NAME="sec0"></A>System Requirements</H3><SPAN CLASS="list"><UL><LI CLASS="ULI1">An 80286 or higher computer.</LI><LI CLASS="ULI1">A minimum of 500K of extended or expanded memory. The actual amount of extended or expanded memory required may be greater than 500K, depending on the number of entries in the POL (Adminshd.nme).</LI><LI CLASS="ULI1">MS–DOS version 3.3 or later.</LI></UL></SPAN><H3 CLASS="h3"><A NAME="sec1"></A>When to Use Gimport</H3><P CLASS="t">Use this tool to create, delete, or modify groups on the postoffice. If the group is small (fewer than 20 users), and contains only local users, or if the number of groups is small (fewer than 5 groups), the Microsoft Mail Administrator program can be more efficient in creating and maintaining the group.</P>
<H3 CLASS="h3"><A NAME="sec2"></A>Side Effects of Using Gimport</H3><P CLASS="t">New groups are deleted or created, and existing groups are modified.</P>
<P CLASS="t"><B>Note   </B>Before you run Gimport, you must add users to a group so that they are present in the POL. You can automatically add users to the POL by running the Import. exe with the <B>-a</B> option. The Import.exe file ships with Microsoft Mail and is located in the Mailexe subdirectory. For more information on the Import tool, see your Microsoft Mail documentation.</P>
<P CLASS="proch">To run Gimport</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Use the following command-line syntax format and include the appropriate option(s):
<P CLASS="lt1"><B>gimport admin [-d[drive|path]] [-ffilename] [-i[filename]] [-llogfile] -ppassword [-r] [-s] [-v] [-x[file name]] [-y] [-?]</B></P></LI></UL></SPAN><P CLASS="t">The following table lists the options available in Gimport and their descriptions.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="83pt" VALIGN="TOP"><COL WIDTH="264pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">Option</P></TD><TD VALIGN="TOP"><P CLASS="th">Description</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>admin</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">The mailbox logon ID of a Microsoft Mail administrator (required).</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-d[drive|path]</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Specifies the location of the Microsoft Mail data files. <I>Drive</I> specifies the drive on which the Microsoft Mail data files reside (the default is drive M). <I>Path</I> specifies the path to the Microsoft Mail database files.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-ffilename</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Specifies the output file that contains the group definition and the group users. This file is not compatible with the Import.exe tool.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-i[filename]</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Specifies an output file that does not contain the group definition. This file is compatible with the Import.exe tool. The default name for this file is Grpusers.dat.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-llogfile</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Specifies the location of the log file.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-ppassword</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Specifies the mailbox password of the Microsoft Mail administrator (required).</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-r</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Removes all postoffice address list groups and resets all the group files to default values. The following files are reset: Admin.grp, Adminshd.grp, Group.glb, Grpmem.glb. In addition, the groups are removed from the Admin.nme and Adminshd.nme files. The records in the Access.glb file are modified to reset the point into the Grpmem.glb. All the Mem files are removed from the Mem directory.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-s</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Prevents name sorting of the members of the groups extracted from the postoffice. By default, sorting is turned on. This option can be used to speed up execution of the program when you extract extremely large groups.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-v</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Displays and logs detailed logging information.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-x[filename]</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Specifies which groups are to be extracted. If no file name is specified, all groups are extracted.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-y</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Overrides the confirmation message.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-?</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Displays the Help window.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H3 CLASS="h3"><A NAME="sec3"></A>File Formats</H3><P CLASS="t">The output file created with the <B>-f</B> option is a text file containing the group transactions. </P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">The file consists of the group name, followed by the group members. </LI><LI CLASS="ULI1">The format of the Import-compatible file created with the<B> -i</B> option is the same, except that the group name is not included. </LI><LI CLASS="ULI1">The format of the file used by the extract option (<B>-x)</B> is only the alias of the group, with each alias on a separate line.</LI></UL></SPAN><H4 CLASS="h4"><A NAME="sec4"></A>Group transaction file</H4><P CLASS="t">Each group transaction is on a separate line. Each of these lines contains four mandatory entries.</P>
<P CLASS="ls">The first entry's transaction type is either G, A, D, R, P, or #. The transcription type must appear in column 1. The following are transaction type codes and their description.</P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="80pt" VALIGN="TOP"><COL WIDTH="253pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">Transaction Type Code</P></TD><TD VALIGN="TOP"><P CLASS="th"><BR>Description</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">G</P></TD><TD VALIGN="TOP"><P CLASS="tt">Adds/modifies the following group to the POL. The list of members should follow this line. If the group does not exist in the POL, it is assumed to be a new group and is created. If the group does exist, the transactions following this line are assumed to be modifications to the existing group.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">A</P></TD><TD VALIGN="TOP"><P CLASS="tt">Adds the following address to the last group defined by the last G transaction type.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">D</P></TD><TD VALIGN="TOP"><P CLASS="tt">Deletes the following address from the last group defined by the last G transaction.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">R</P></TD><TD VALIGN="TOP"><P CLASS="tt">Replace the following group with the users defined in following transactions. All transactions for this group can only be of type A.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">P</P></TD><TD VALIGN="TOP"><P CLASS="tt">Purges (deletes) the following group from the POL.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">#</P></TD><TD VALIGN="TOP"><P CLASS="tt">Comment line. Ignored.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P></P>
<P CLASS="ls">The second entry is the alias. The alias can be from 1 to 30 characters long, and must start in column 3 or be separated from the first entry by a tab.</P>
<P CLASS="ls">The third entry is the address type. Follow it with a colon (:). This address type must start in column 34 or be separated from the second entry by a tab. Only the following address types are supported: PCM, X400, FAX, SMTP, SNADS, and PROFS.</P>
<P CLASS="ls">The fourth entry is the address. It immediately follows the address type and must be that type of address. For more information about the proper address format, see the Import Tool section in your Microsoft Mail documentation.</P>
<H4 CLASS="h4"><A NAME="sec5"></A>Sample input file</H4>
<PRE># New group to be created
G Group 1                PCM:network1/30po1/trial
A User 0                 PCM:network1/30po1/auto0
A User 1                 PCM:network1/30po1/auto1
# Group to be deleted
P Trial Group            PCM:network1/30po1/trial
# New group with gateway addresses
G Gateway Group 1          PCM:network1/30po1/gtwygrp
A Sample User 0            SMTP:user0@dummy.host.edu
A Sample User 1            SNADS:SNADSNET/DGN1/user1
A Sample User 2            PROFS:VMGATE/NODE1/user2
</PRE>
<H3 CLASS="h3"><A NAME="sec6"></A>Files to Back Up</H3><P CLASS="t">As with all Microsoft Mail utilities, it is highly recommended that you back up your Microsoft Mail database before you run Gimport.exe. As a minimum, you should back up the following directories:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Glb</LI><LI CLASS="ULI1">Nme</LI><LI CLASS="ULI1">Grp</LI><LI CLASS="ULI1">Mem</LI></UL></SPAN><H3 CLASS="h3"><A NAME="sec7"></A>Examples for Using Gimport</H3><P CLASS="t">The following examples illustrate how Gimport can be used in your organization.</P>
<H4 CLASS="h4"><A NAME="sec8"></A>Example 1: Automatically copying a group from one postoffice to another.</H4><P CLASS="t">This example assumes that you have created a group named "Test Group" on Postoffice 1 (on drive M) that contains only the user "Administrator" for Postoffice 1 and you want to create this group on Postoffice 2 (on drive N). </P>
<P CLASS="proch">To copy a group from one postoffice to another</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Type the following at the command prompt: 
<P CLASS="lt1"><B>gimport -dm admin -ppassword -xgrpext.inf -fgroups.ext -igrpusers.dat</B></P>


<UL><LI CLASS="ULI2"><B>Grpext.inf</B>—a text file that contains the name of the group to be extracted. For this example, the Grpext.inf file contains the following text: Test Group. </LI><LI CLASS="ULI2"><B>Groups.ext</B>—the file to which the group information is written. The Groups.ext file contains the following information:
<P CLASS="lt1"># - Microsoft Mail Group Import Program v3.0b</P>

<P CLASS="lt1"># - Started: 05/13/94 07:49</P>

<P CLASS="lt1">G Test Group           PCM:NET/PO/TestGroup</P>

<P CLASS="lt1">A Administrator         PCM:NET/PO/Admin</P></LI><LI CLASS="ULI2"><B>Grpusers.date</B>—the file to which only user information and not group information is written to. This file contains the following information: 
<P CLASS="lt1"># - Microsoft(R) Mail Group Import Program v3.0b</P>

<P CLASS="lt1"># - Started: 05/13/94 07:55</P>

<P CLASS="lt1"># The data in this file is for use with the Microsoft Mail Import.exe tool</P>

<P CLASS="lt1">A Administrator         PCM:NET/PO/TestGroup</P></LI></UL></LI></UL></SPAN><H4 CLASS="h4"><A NAME="sec9"></A>Importing the group into Postoffice 2</H4><P CLASS="proch">To import the names of users in the group to the POL on Postoffice 2</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Note that all the users in the group must be present in the POL on Postoffice 2. At the command prompt, type:
<P CLASS="lt1"><B>import -dn admin -ppassword -a -fgrpusers.dat </B></P>

<P CLASS="lt1">After typing this command, you will receive warning messages for any users who already exist on Postoffice 2. These messages can be ignored.</P></LI></UL></SPAN><H4 CLASS="h4"><A NAME="sec10"></A>Creating the group on Postoffice 2</H4><P CLASS="proch">To create the group on Postoffice 2 and add the users to it</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Use the Groups.ext file (containing the G transaction type). At the command prompt, type the following: 
<P CLASS="lt1"><B>gimport -dn admin -ppassword -fgroups.ext</B></P></LI></UL></SPAN><H4 CLASS="h4"><A NAME="sec11"></A>Example 2 - Resetting all group files on a postoffice</H4><P CLASS="t">In certain cases, you may want to reset all the group files on a Microsoft Mail postoffice. </P>
<P CLASS="proch">To reset all group files on a postoffice</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Use the Gimport.exe file. At the command prompt, type the following:
<P CLASS="lt1"><B>gimport -dm admin -ppassword -r</B></P>

<P CLASS="lt1">(The above example assumes that the postoffice on which you wish to reset all the group files exists on drive M.)</P></LI></UL></SPAN><H4 CLASS="h4"><A NAME="sec12"></A>Creating log files</H4><P CLASS="t">You can create a log file when working with any of the above examples.</P>
<P CLASS="proch">To create a log file</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Use the -<B>l&lt;</B><B><I>log file</I></B><B>&gt;</B> command-line option. To enable verbose logging, use the <BR><B>-v</B> command-line option.</LI></UL></SPAN></BODY></HTML>
