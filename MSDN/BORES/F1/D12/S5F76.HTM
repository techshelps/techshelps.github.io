<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Profgen</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Using Profgen</H3><P CLASS="t">Profgen simplifies the creation of Microsoft Exchange profiles for roving users. Users can move to any computer across operating systems and still access their Microsoft Exchange mailbox by double-clicking the <B>Microsoft Exchange Client </B>icon. Profiles do not have to be recreated.</P>
<P CLASS="t">Each of the Microsoft Exchange Clients share points contain a template .prf file (Template.prf). When the Microsoft Exchange Setup Editor is run against the client share point, it copies Template.prf to Default.prf. Any user option changes made by using the Setup Editor are then written to Default.prf. When the client Setup program is run, if the file Default.prf is present in the client installation directory, it is copied to the Windows directory on the client computer, and then Newprof.exe is run to create a new profile.</P>
<P CLASS="proch">To run Profgen</P>
<P CLASS="ls">In Windows Explorer, find the subdirectory where the Newprof.gen file is located.</P>
<P CLASS="ls">Double-click Newprof.exe.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Profile Descriptor File</H4><P CLASS="t">The Profile Descriptor File contains information relating to the services to be installed in the profile. This file contains four major sections: </P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Profile defaults</LI><LI CLASS="ULI1">Services in the profile</LI><LI CLASS="ULI1">Default values for each service</LI><LI CLASS="ULI1">Mapping for profile properties</LI></UL></SPAN><H5 CLASS="h4"><A NAME="sec1"></A>Profile defaults</H5><P CLASS="t">This part of the .prf file contains values that apply to the entire profile specified in the [General] section. Under the [General] section, the following entries are used:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1"><B>ProfileName=&lt;Name of the Profile&gt;</B> — This entry specifies the name to be used when creating the profile.</LI><LI CLASS="ULI1"><B>DefaultProfile= [Yes/No]</B> — If the value is set to Yes, then the profile being created is set as the default profile. By default, this entry is set to Yes.</LI><LI CLASS="ULI1"><B>OverwriteProfile= [Yes/No]</B> — Determines whether the profile being created should overwrite an existing profile with the same name. If the value is set to No, and a profile exists with the same name as the one specified in the ProfileName entry, then the profile is not created. The default value is No.</LI><LI CLASS="ULI1"><B>DefaultStore=&lt;Service ID&gt;</B> — Corresponds to a service that is to be used as the default store. The Service IDs are obtained from the entries listed in the [Service List] section as described below. By default, the value is set to Service2, which corresponds to the Microsoft Exchange Server service. This is determined by searching the [Service List] section. In that section, search for an entry whose name is Service2. The value of this entry is the actual name of the service.</LI></UL></SPAN><H5 CLASS="h4"><A NAME="sec2"></A>Services in the profile</H5><P CLASS="t">This part of the file lists all the services that are to be installed in the profile. The names of the profiles are listed as entries under the [Service List] section. By default, the [Service List] section is defined as shown below:</P>
<P CLASS="t"><B>[Service List]</B></P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1"><B>Service1</B>=Microsoft Exchange Client</LI><LI CLASS="ULI1"><B>Service2</B>=Microsoft Exchange Server</LI><LI CLASS="ULI1"><B>Service3</B>=Personal Address Book</LI></UL></SPAN><P CLASS="t">The services listed in this section are installed only if the settings associated with each of these services are valid. If the Automatic Profile Generator encounters a problem with one or more of the settings associated with a service, it will not install that service in the profile.</P>
<H5 CLASS="h4"><A NAME="sec3"></A>Default values for each service</H5><P CLASS="t">This section of the file contains information for the services listed under the [Service List] section. For each of the services listed under the [Service List] section, there should be a section with that service name containing entries for each configurable option of the service.</P>
<P CLASS="t">By default, these are the service sections:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1"><B>[Service1]</B> — This section contains configurable options for the Microsoft Exchange Client. The different settings available in the Microsoft Exchange Client are included in Section 4 of the .prf file, which is described below.</LI><LI CLASS="ULI1"><B>[Service2]</B> — This section contains settings for the Microsoft Exchange Server service. The different configurable settings available in the Microsoft Exchange Server service are included in Section 4 of the .prf file.</LI><LI CLASS="ULI1"><B>[Service3]</B> — This section contains settings for the Microsoft Exchange Personal Address Book (PAB) service. The various configurable settings available in the Microsoft Exchange PAB service are included in Section 4 of the .prf file.</LI></UL></SPAN><H5 CLASS="h4"><A NAME="sec4"></A>Mapping for profile properties</H5><P CLASS="t">This section of the file contains a listing of all the supported properties for each of the services that the Automatic Profile Generator supports. For each service, there is a Section 4 with the name of the service. This section contains all the settings for the service that the Profile Generator supports. By default, there are sections for</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Microsoft Exchange Client</LI><LI CLASS="ULI1">Microsoft Exchange Server</LI><LI CLASS="ULI1">Personal Folders</LI><LI CLASS="ULI1">Personal Address Book</LI><LI CLASS="ULI1">Microsoft Mail</LI></UL></SPAN><P CLASS="t">For each entry in the [Service List] section, there must be a corresponding section in Section 4 of the file. For example, if under the [Service List] section, there is a Service1=Microsoft Exchange Client entry, there must be a [Microsoft Exchange Client] section in Section 4 of the file. The [Microsoft Exchange Client] section contains descriptions of all the options that can be set for the Microsoft Exchange Client. Each description contains the type of entry and an internal ID number. A text description of the entry explains the use of that option and the values that can be assigned to the option.</P>
<P CLASS="t">Newprof.exe reads Section 4 to determine how to interpret each of the options. The textual description of each option is commented out and Newprof.exe ignores these lines. </P>
<P CLASS="t">Using the above example, if there is a "Service1=Microsoft Exchange Client" entry in the [Service List] section, there should be a [Service1] section in Section 3 of the file, and a [Microsoft Exchange Client] section in Section 4.</P>
<P CLASS="t">For each entry specified in the [Service1] section, there must be a corresponding entry in the [Microsoft Exchange Client] section that describes the type (whether the option is a Boolean variable, integer, and so on) and an internal ID number. If the corresponding entry is not present in the [Microsoft Exchange Client] section, the Automatic Profile Generator cannot interpret that option and displays an error message.</P>
<P CLASS="t">To have Newprof.exe set a particular option for a service, the option must be listed with a valid value in the [Service ID] section, where Service ID is the entry name corresponding to that service in the [Service List] section. There must also be a section corresponding to the Service Name in Section 4 of the file, and this section should include the description information for the option that you need to set.</P></BODY></HTML>
