<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the PFAdmin Tools</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Using the PFAdmin Tools</H3><P CLASS="t">You can use the following command-line syntax format when running PFAdmin:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">PFADMIN [Switches] Profile SETACL Folder|ALL User Rights [User Rights]... [YES|NO]</LI><LI CLASS="ULI1">PFADMIN [Switches] Profile REHOME Folder|ALL [Site\]Server [YES|NO]</LI><LI CLASS="ULI1">PFADMIN [Switches] Profile SETREPLICAS Folder Option Server(s)</LI><LI CLASS="ULI1">PFADMIN [Switches] Profile LISTACL Folder|ALL [YES|NO]</LI><LI CLASS="ULI1">PFADMIN [Switches] Profile LISTREPLICAS Folder|ALL [YES|NO]</LI><LI CLASS="ULI1">PFADMIN [Switches] Profile MESSAGETYPES Folder|ALL [FULL|I=IniFile] [O=CsvFile]</LI></UL></SPAN><P CLASS="t">Following is a list of the command-line switches available in PFAdmin:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">/En = eventlog logging level (default = 3)</LI><LI CLASS="ULI1">/Cn = console logging level (default = 4)</LI><LI CLASS="ULI1">/Dn = debug file logging level (default = 5)</LI><LI CLASS="ULI1">/Ln = logging level (console, debug, and EventLog)
<P CLASS="lt1">where 0=NONE, 1=STATUS, 2=ERROR, 3=WARNING, 4=INFO, 5=DEBUG</P></LI></UL></SPAN><H4 CLASS="h3"><A NAME="sec0"></A>Logging Level Defaults</H4><P CLASS="t">Logging levels range from 0 to 5, with Level 5 being the highest level.</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1"><B>Level 3 </B>— Output to the EventLog.</LI><LI CLASS="ULI1"><B>Level 4</B> — Output to stdout.</LI><LI CLASS="ULI1"><B>Level 5</B> — Output to the log file.</LI></UL></SPAN><H4 CLASS="h3"><A NAME="sec1"></A>PFAdmin and Message Types</H4><P CLASS="t">PFAdmin can search a specified folder tree, examine the message type of every message, and then write a .csv file that contains one line for each folder examined.</P>
<P CLASS="proch">To search a specified folder tree and write a .csv file</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">At the command prompt, type:
<P CLASS="lt1"><B>&gt;pfadmin ? messagetypes):</B></P></LI></UL></SPAN><H4 CLASS="h3"><A NAME="sec2"></A>Sample .csf File Format and Syntax</H4><P CLASS="t">The PFAdmin tool enables you to configure the IPM types you want to monitor. The message types are provided within the Default.ini file. A single level of subtypes is allowed. Messages that fall within a subtype are counted in both the subtype and its parent type.</P>
<P CLASS="t">Following is a sample .csv file format listing. The numbers in this example were chosen arbitrarily:</P>

<PRE>FOLDER,ITEMS,IPM_Type1,IPM_Type2, IPM_Type3,…
Folder One,99,16,3,967,...
Folder One\Subfolder A,16,0,2,222,...
TOTALS,9999,111,44,888...
</PRE>
<P CLASS="t"><I>ITEMS </I>represents the total number of messages in the folder (note that only HOMED messages are counted if this option is enabled). The remaining fields represent the number of messages for each message type found in the folder. Note that PFAdmin does not examine attachments and objects within these messages.</P>
<P CLASS="t">For the default and <B>I=IniFile</B> option, a message type is considered to match a default (or .ini-specified) type if the left-most characters match. Any additional characters are ignored. All other message types are combined into the All Other category. For the <B>Full</B> option, all characters are used to match message types and all types found are reported.</P>
<H4 CLASS="h3"><A NAME="sec3"></A>Help Syntax</H4><P CLASS="proch">To get Help when using PFAdmin</P>
<P CLASS="ls">At the command prompt, type: </P>
<P CLASS="lt1">pfadmin ? </P>
<P CLASS="ls">For additional Help, type any of the following commands:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI2">PFADMIN ? SETACL</LI><LI CLASS="ULI2">PFADMIN ? REHOME</LI><LI CLASS="ULI2">PFADMIN ? SETREPLICAS</LI><LI CLASS="ULI2">PFADMIN ? LISTACL</LI><LI CLASS="ULI2">PFADMIN ? LISTREPLICAS</LI><LI CLASS="ULI2">PFADMIN ? MESSAGETYPES</LI></UL></SPAN><H4 CLASS="h3"><A NAME="sec4"></A>Notes On Using the PFAdmin Tools</H4><SPAN CLASS="list"><UL><LI CLASS="ULI1">All entries are case-insensitive.</LI><LI CLASS="ULI1">You must use quotation marks when typing names containing blanks and use backslashes when typing subfolder names, starting with the top-level folder under All Public Folders.</LI><LI CLASS="ULI1">You can specify user rights by typing either a full name or character(s). You can combine rights by using the '|' symbol [for example, read | write (blanks optional)] or joining characters into a single word (for example, RW).</LI><LI CLASS="ULI1">You can also use "Default" as the user name to set the default permissions.</LI></UL></SPAN><H4 CLASS="h3"><A NAME="sec5"></A>Examples of Command-Line Syntax</H4><P CLASS="t">Following are examples of typical syntax usage for the PFAdmin Tools:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">&gt;<B>pfadmin &lt;</B><B><I>profile</I></B><B>&gt; setacl all "pf global admin" owner "pf lead" o</B></LI><LI CLASS="ULI1">&gt;<B>pfadmin &lt;</B><B><I>profile</I></B><B>&gt; setacl "Readme FAQ\Exchange Discussion" UserName r</B></LI><LI CLASS="ULI1">&gt;<B>pfadmin &lt;</B><B><I>profile</I></B><B>&gt; setacl all default read</B></LI></UL></SPAN></BODY></HTML>
