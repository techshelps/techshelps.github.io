<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using DL Import</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Using DL Import</H3><P CLASS="t">DL Import uses the Crystal Reports tool to create the raw data required to generate the distribution lists for buildings, groups, and servers. The server reports are scheduled to run on a daily basis against the Mailbox Administrator to obtain server data. The building and group reports are scheduled to run on a weekly basis against the global address list (GAL). </P>
<P CLASS="t">Some of the data is derived from cross-tabulated tables. Crystal Reports uses cross-tabulated tables to obtain distribution list (DL) aliases and long e-mail addresses.</P>
<P CLASS="t">The scheduled reports are formatted as a .csv file that is sent to a share point. If Crystal Reports fails to create the required data, an automatic e-mail notification is sent to the users defined in the requirements list.</P>
<P CLASS="t">The Windows NT process monitors the share point for a new file. When a new file is detected, it renames the old file and processes the new file. The process parses the .csv file to create the distribution lists. When it has created the distribution lists, it replaces the distribution lists in Microsoft Exchange Server using the designated e-mail address. If a distribution list is not created, the Windows NT process sends an automatic mail notification to the users defined in the requirements list.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Generating Data with Crystal Reports</H4><P CLASS="t">The first report generated by Crystal Reports contains a list of all mailboxes sorted by the home server distribution list name. This report runs off the Mailbox Administrator table. A user with a site Microsoft Exchange Administrator account can run this report against all servers within that site.</P>
<P CLASS="proch">To generate the report</P>
<P CLASS="ls">Use the server name to link to the server cross-tabulated table and return the distribution list names and e-mail addresses described in the table below. The result of the server report is exported to a .csv file that is sent to a file share. The server .csv file contains the following attributes: <I>SDL E-mail Address</I>,<I> SDL Alias Name</I>,<I> Recipient E-mail Address</I>,<I> </I>and <I>Recipient Alias Name</I>. </P>
<P CLASS="lt1">The following table lists the definitions for these field names and data sources:</P>
<P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="112pt" VALIGN="TOP"><COL WIDTH="221pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">Field Name</P></TD><TD VALIGN="TOP"><P CLASS="th">Description</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">SDL E-mail Address </P></TD><TD VALIGN="TOP"><P CLASS="tt">The distinct e-mail address of the server distribution list (SDL). The data file is sorted on this field and is obtained from the server cross-tabulated table.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">SDL Alias Name </P></TD><TD VALIGN="TOP"><P CLASS="tt">The e-mail alias of the server distribution list that is obtained from the server cross-tabulated table. This field is included in the .csv file for maintenance and troubleshooting purposes only.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Recipient E-mail Address </P></TD><TD VALIGN="TOP"><P CLASS="tt">The distinct e-mail address of the mailbox on the specified server.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Recipient Alias Name </P></TD><TD VALIGN="TOP"><P CLASS="tt">The e-mail alias of the mailbox recipient on the specified server that is obtained from the Account field in the personal address book (PAB) table. This field is included in the .csv file for maintenance and troubleshooting purposes only.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="ls">Develop a Crystal Report that runs against the global address list (GAL)and contains a list of all mailboxes sorted by the building's distribution list name (DL_Dist_Name). This report is used to generate the raw data for the building and group distribution lists. The groups are defined in the building cross-tabulated table.</P>
<P CLASS="lt1">Crystal Reports extracts the building numbers by using a specific formula. After the building numbers are extracted, they will be used to link to the building cross-tabulated table and return distribution list names and e-mail addresses as described in the following step.</P>
<P CLASS="ls">The result of the building report is exported to a .csv file and sent to a file share. The building .csv file will contain the following attributes: <I>BDL E-mail Address, BDL E-mail Alias Name, GDL E-mail Address, GDL E-mail Alias Name, Recipient E-mail Address, </I>and <I>Recipient E-mail Alias Name</I>. </P>
<P CLASS="lt1">The following table lists the definitions for these field names and data sources:</P>
<P></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="103pt" VALIGN="TOP"><COL WIDTH="230pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">Field Name</P></TD><TD VALIGN="TOP"><P CLASS="th">Description</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">BDL E-mail Address</P></TD><TD VALIGN="TOP"><P CLASS="tt">The distinct e-mail address of the building distribution list (BDL). The data file is sorted on this field. Obtained from the building cross-tabulated table.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">BDL E-mail Alias Name</P></TD><TD VALIGN="TOP"><P CLASS="tt">The e-mail alias of the building distribution list. Obtained from the building cross-tabulated table. This field is included in the .csv file for maintenance and troubleshooting purposes only.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">GDL E-mail Address</P></TD><TD VALIGN="TOP"><P CLASS="tt">The distinct e-mail address of the group distribution list. Obtained from the building cross-tabulated table.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">GDL Alias Name</P></TD><TD VALIGN="TOP"><P CLASS="tt">The e-mail alias of the group distribution list. Obtained from the building cross-tabulated table. This field is included in the .csv file for maintenance and troubleshooting purposes only.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Recipient E-mail Address</P></TD><TD VALIGN="TOP"><P CLASS="tt">The distinct e-mail address of the mailbox recipient in the specified building.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Recipient E-mail Alias Name</P></TD><TD VALIGN="TOP"><P CLASS="tt">The e-mail alias of the mailbox recipient in the specified building. Obtained from the Account field in the PAB table. This field is included in the .csv file for maintenance and troubleshooting purposes only.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H4 CLASS="h3"><A NAME="sec1"></A>Searching Cross-Tabulated Tables </H4><P CLASS="t">Crystal Reports needs to attach to a Microsoft Access cross-tabulated table. The Crystal Reports tool then uses either the server name or the building number to search the cross-tabulated tables and return the alias name and e-mail address of the distribution lists. </P>
<P CLASS="t">The following table lists field name descriptions for both the Building and Server cross-tabulated tables:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="85pt" VALIGN="TOP"><COL WIDTH="262pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">Field Name</P></TD><TD VALIGN="TOP"><P CLASS="th">Description</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Building Number</P></TD><TD VALIGN="TOP"><P CLASS="tt">The building number is used to search the table to retrieve Microsoft Exchange alias names and e-mail addresses for building and group distribution lists. The table must include all building name variations (for example, &lt;201N&gt;). Although the building names can be a combination of letters and numbers, they cannot consist of all letters and no numbers. For example, building names such as "Test" or "Mobile" are not valid.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">BDL E-mail Address</P></TD><TD VALIGN="TOP"><P CLASS="tt">The distinct e-mail address of the building distribution list.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">BDL E-mail Name</P></TD><TD VALIGN="TOP"><P CLASS="tt">The e-mail alias name of the building distribution list. </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">GDL E-mail Address</P></TD><TD VALIGN="TOP"><P CLASS="tt">The distinct e-mail address of the group distribution list. </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">GDL E-mail Name</P></TD><TD VALIGN="TOP"><P CLASS="tt">The e-mail alias name of the group distribution list.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">The naming conventions for the building distribution list names are contained in the server name and location table. Following are the field name descriptions for the server name and location table:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="88pt" VALIGN="TOP"><COL WIDTH="259pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">Field Name</P></TD><TD VALIGN="TOP"><P CLASS="th">Description</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Site\Server</P></TD><TD VALIGN="TOP"><P CLASS="tt">The name of the server site and home server. This information is used to retrieve Microsoft Exchange alias names and e-mail addresses for server distribution lists. </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Server Name</P></TD><TD VALIGN="TOP"><P CLASS="tt">The name of the home server. This information is used to build the Site/Server field. </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">SDL E-mail Address</P></TD><TD VALIGN="TOP"><P CLASS="tt">The distinct e-mail address of the server distribution list name.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">SDL E-mail Name</P></TD><TD VALIGN="TOP"><P CLASS="tt">The e-mail alias of the server distribution list. </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Server Site</P></TD><TD VALIGN="TOP"><P CLASS="tt">The site of the specified server. This information is used to build the Site/Server field.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H4 CLASS="h3"><A NAME="sec2"></A>Monitoring the Share Point and Creating New Distribution Lists</H4><P CLASS="ls">The Windows NT service process monitors a share point for a new file to be sent by Crystal Reports. The file names for the .csv files are Svrlist.csv and Bldlist.csv.</P>
<P CLASS="ls">When a new file is detected, the Windows NT process creates a backup copy of the old file, and then parses the .csv file to create the distribution lists. The backup file names are: Svr&lt;<I>yy/mm/dd</I>&gt;.csv and Bld&lt;<I>yy/mm/dd</I>&gt;.csv. </P>
<P CLASS="ls">When the distribution list's e-mail address changes, the Windows NT process performs processing breaks. This event initiates the creation of a new distribution list.</P>
<P CLASS="ls">The Windows NT process must create two different distribution lists from the building .csv file: the building distribution list and the group distribution list. If a row in the file has a null group, then it is not included in the group distribution list because the recipient is not an employee.</P>
<P CLASS="lt1"><B>Note   </B>The Windows NT process needs to be designed so that it knows where it left off if it is interrupted while processing distribution lists, so that it can automatically continue processing where it left off. This type of situation might occur during a server reboot. </P>
<P CLASS="ls">After the distribution lists are created, the Windows NT process replaces the distribution lists in Microsoft Exchange and retains the permissions of the original distribution list. Windows NT security is used so that only input from the account running Crystal Reports is accepted. </P>
<P CLASS="ls">If a distribution list is not created, the process sends an automatic notification to the users defined in the requirements list, identifies which distribution lists did not get created, and explains why (if the cause is known).</P>
<H4 CLASS="h3"><A NAME="sec3"></A>Windows NT Registry Data</H4><P CLASS="t">DL Import uses Windows NT registry data located in the following hierarchy: \HKEY_LOCAL_MACHINE\SOFTWARE\MSITG\CONSTOOLS\DLIMPORT\</P>
<P CLASS="t">The DL Import tool monitors for an event that indicates that a registry change has been made. The service parameters known at this time are listed below:</P>

<TABLE COLS="5" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="99pt" VALIGN="TOP"><COL WIDTH="92pt" VALIGN="TOP"><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="84pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th"><BR>Registry Key</P></TD><TD VALIGN="TOP"><P CLASS="th"><BR>Description</P></TD><TD VALIGN="TOP"><P CLASS="th">Registry Value Type</P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="th"><BR>Default </P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>DLImport_Polling<BR>_Frequency</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">How often the service inspects the CSV_File_Location for any .csv file to process.</P></TD><TD VALIGN="TOP"><P CLASS="tt">Registry Value Type: REG_DWORD</P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">1 minute</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>CSV_File_Location</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">The absolute path where the .csv file will be stored by Crystal Reports on its server.</P></TD><TD VALIGN="TOP"><P CLASS="tt">REG_SZ</P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">\\na-01-rpt\dlimport</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>CSV_Data_Files</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">The csv file name if the file is located at CSV_File_Location. Else, a UNC name is supported.</P></TD><TD VALIGN="TOP"><P CLASS="tt">REG_SZ</P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">"bldglistCSV,<BR>empgroupCSV"</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>CSV_Archive_<BR>Location</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">The absolute path where the .csv files are archived on the DL Import server.</P></TD><TD VALIGN="TOP"><P CLASS="tt">REG_SZ</P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">The CSV_File_<BR>Location and a subdirectory called Archive. (example: \\na-01-rpt\dlimport\<BR>archive).</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>Notification_Alias</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">The list of aliases that DL Import sends notification to when a DL processing error occurs. </P></TD><TD VALIGN="TOP"><P CLASS="tt">REG_MULTISZ</P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">&lt;approved e-mail alias names&gt;</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>EventLog_Level</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">The logging level used by the service when writing to the EventLog.</P></TD><TD VALIGN="TOP"><P CLASS="tt">REG_DWORD</P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">5 (debug)</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>LogFile_Level</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">The logging level used by the service when writing to the log file.</P></TD><TD VALIGN="TOP"><P CLASS="tt">REG_DWORD</P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">5 (debug)</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>Exchange_Logon<BR>_Profile</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">The profile used to connect to the GAL by the DL Import tool.</P></TD><TD VALIGN="TOP"><P CLASS="tt">REG_SZ</P></TD><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tt">"dlimport"</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H4 CLASS="h3"><A NAME="sec4"></A>Windows NT Registry Logging Functions</H4><P CLASS="t">Settings within the Windows NT registry are used to control the level of logging to the log file and the Windows NT EventLog. In other words, the degree of detail contained in the logs can be modified. Predetermined settings are used to control these logs. Documentation on the settings and their necessary location within the registry is provided with the tool </P>
<P CLASS="t">The debug log file for this tool should be named "DLimport.log" and created in the Binaries directory (or a Logs subdirectory).</P>
<P CLASS="t">The debug log file should contain only debug and processing status information. All other information used for an audit trail should be written to the application EventLog. </P></BODY></HTML>
