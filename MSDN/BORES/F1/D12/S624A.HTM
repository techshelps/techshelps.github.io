<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Fixidx Tool</TITLE><BODY BGCOLOR="#FFFFFF">


<H2 CLASS="h1">Fixidx Tool</H2><P CLASS="t">The Fixidx tool rebuilds the folder index file from records of all of the folders in a subdirectory. You can use Fixidx with Microsoft Mail version 2.1 and later postoffices. However, it has no effect on Microsoft Mail version 3.0 or 3.2 message files.</P>
<H3 CLASS="h3"><A NAME="sec0"></A>When to Use Fixidx</H3><P CLASS="t">Use this tool only when a folder index is deleted or irrevocably damaged.</P>
<H3 CLASS="h3"><A NAME="sec1"></A>Side Effects of Using Fixidx</H3><P CLASS="t">Running this program will result in the loss of all folder names. Rebuilding Foldroot.idx when there are group folders on that postoffice will make the group folders inaccessible, because Fixidx resets the group folder type to that of a shared folder. To repair damaged files, use the following procedure:</P>
<P CLASS="proch">To run Fixidx</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Use the following command-line syntax:
<P CLASS="lt1"><B>fixidx&lt; </B><B><I>fld_dir idx_file owner</I></B><B>&gt;</B></P></LI></UL></SPAN><P CLASS="t">The following table lists the command-line options available in FIDIDX, and their descriptions:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="79pt" VALIGN="TOP"><COL WIDTH="268pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">Option</P></TD><TD VALIGN="TOP"><P CLASS="th">Description</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>&lt;</B><B><I>fld_dir</I></B><B>&gt;</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Indicates the directory that contains the folder (.fld) files that should be used to build the new index file. For example, to rebuild the index (.idx) file for the public folders system when the Microsoft Mail database stored on drive M, use M:\Folders\Pub.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>&lt;</B><B><I>idx_file</I></B><B>&gt;</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Indicates that the file will be used to store the new index file. This can be any name but should be the name of the index file for the directory you are dealing with. For example, with the prior example (for &lt;fld_dir&gt;), use M:\Folders\Pub\Foldroot.idx.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>&lt;</B><B><I>owner</I></B><B>&gt;</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Displays the name of the person who will have ownership of all the folders in the index that is created. This parameter is necessary if you want to enable folders to be modified (using the <B>Options</B>, <B>Folders</B>, <B>Modify</B> command). Other users are given Read, Write, Delete privileges. For example, to give the administrator access to these folders, this field should be 00000000. If you are giving access to a different user, you must know that user's eight-digit Microsoft Mail ID number.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t"><B>Note   </B>As with all Microsoft Mail tools, it is highly recommended that you back up your Microsoft Mail database before running Fixidx. You must also back up the folder subdirectory you will be working with.</P>
<H3 CLASS="h3"><A NAME="sec2"></A>Rebuilding the Index file for Public Folders</H3><P CLASS="proch">To rebuild the index file for public folders</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Type the following at the command prompt:
<P CLASS="lt1"><B>fixidx m:\folders\pub m:\folders\pub\foldroot.idx 00000000</B></P>

<P CLASS="lt1">This assumes your Microsoft Mail database is on drive M.</P></LI></UL></SPAN><H3 CLASS="h3"><A NAME="sec3"></A>Rebuilding the Index File for Private Folders</H3><P CLASS="proch">To rebuild the index file for a user's private folders</P>
<P CLASS="ls">First you need to determine the eight-digit ID number for that user by using the Listuser tool included on the database utilities disk. </P>
<P CLASS="ls">After you know the ID number, type the following command (assuming your Microsoft Mail database is on drive M). Substitute the user's eight-digit ID number for &lt;hexid&gt;:</P>
<P CLASS="lt1"><B>fixidx m:\folders\loc\&lt;hexid&gt; m:\folders\loc\&lt;hexid&gt;.idx &lt;hexid&gt;</B></P>
<P CLASS="ls">If the index file for a user's private folder is corrupted or missing, you can reset that user's folder from the Microsoft Mail Administrator program. Select <B>Local-Admin</B>, <B>Folders</B>, <B>Reset</B>, select the user, and then press enter.</P>
<H3 CLASS="h3"><A NAME="sec4"></A>Repairing Damaged Group Folders</H3><P CLASS="t">Use the procedure outlined below to change the byte parameter, to indicate the current status of the folder as that of a shared folder. Note that you cannot directly change the folder status back to that of a group folder. Instead, the folder is designated as a shared folder.</P>
<P CLASS="ls">Before you run DEBUG on the .Fld file, you must run Fixfld on that folder.</P>
<P CLASS="ls">Run DEBUG on the folder in question and then change the 49th byte from 00 to 03 by typing the following at the command prompt:</P>
<P CLASS="lt1"><B>debug 00000003.fld</B></P>
<P CLASS="ls">Then type :</P>
<P CLASS="lt1"><B>e0131</B></P>
<P CLASS="lt1">DEBUG displays the following: xxxx:0131 02, where xxxx will vary from computer to computer.</P>
<P CLASS="ls">Type the following, pressing enter after each line: </P>
<P CLASS="lt1"><B>03 </B></P>
<P CLASS="lt1">w</P>
<P CLASS="lt1">q</P>
<P CLASS="lt1">This resets the folder's internal definition to be that of a shared folder. The administrator must then create a new group folder, move the messages from the old folder to the new folder, and then delete the old folder to restore group access.</P></BODY></HTML>
