<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>2.2  Microsoft Exchange Server Tool Notes</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">2.2 Microsoft Exchange Server Tool Notes</H3><H4 CLASS="h3"><A NAME="sec0"></A>2.2.1  Profile Generator</H4><P CLASS="t">The Profile Generator tool has been revised and is located in \Exchange\&lt;operating system\platform&gt;\Admin\Profgen. Since the program has no user interface, the version number is only available through the log file generated by the program.  Whats new in this version:</P>
<P CLASS="t"><B>Added the -R option (DonotRenamePRF   INI file entry). </B></P>
<P CLASS="t">This controls whether or not the PRF file is renamed at the end of the program</P>
<P CLASS="t"><B>Added the -N (UserLoginIDAsProfileName  INI file entry).  </B></P>
<P CLASS="t">This controls whether or not the profile is created with Current NT login ID as the name of the profile.</P>
<P CLASS="t"><B>Added the -T option (TempFilePath INI entry) to specify the location of the profgen.tmp file.</B></P>
<P CLASS="t">Added support for the -I command line option, to specify the mailbox to use from the command line.</P>
<P CLASS="t">Useful when running from login scripts.</P>
<P CLASS="t">If the -I option is specified with a mailbox name, then the program does not use the API call to determine what the current login ID is.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>2.2.2 SMTP Proxy Migration Tool (Migsmtp.exe)</H4><P CLASS="t">You should stop the DXA service while running Migsmtp.exe. After you do so, be aware that synchronization won't occur until the next scheduled time.</P>
<H4 CLASS="h3"><A NAME="sec2"></A>2.2.3  Addition to the Microsoft Exchanger Server Resource Guide</H4><P CLASS="t">A new registry entry has been added for the Microsoft Mail Interchange (MSMI) that is not documented in Chapter 6 of the Microsoft Exchange Server Resource Guide.</P>
<P CLASS="t"><B>Registry path:</B></P>
<P CLASS="t">\HKEY_LOCAL_MACHINE<BR>    \SYSTEM<BR>        \CurrentControlSet<BR>            \Services<BR>                \MSExchangeMSMI<BR>                    \Parameters</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="77pt" VALIGN="TOP"><COL WIDTH="210pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="t"><B>Value Entry:</B></P></TD><TD VALIGN="TOP"><P CLASS="t">Pass SMTP headers to SFS</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="t"><B>Data Type:</B></P></TD><TD VALIGN="TOP"><P CLASS="t">REG_DWORD</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="t"><B>Range: </B></P></TD><TD VALIGN="TOP"><P CLASS="t">0 | 1</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="t"><B>Default:</B> </P></TD><TD VALIGN="TOP"><P CLASS="t">0</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t"></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="77pt" VALIGN="TOP"><COL WIDTH="210pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="t"><B>Value</B></P></TD><TD VALIGN="TOP"><P CLASS="t">Meaning</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="t">0</P></TD><TD VALIGN="TOP"><P CLASS="t">The Exchange MS Mail Connector sends SMTP headers to MS Mail SFS clients.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="t">1</P></TD><TD VALIGN="TOP"><P CLASS="t">The Exchange MS Mail Connector does not send SMTP headers to MS Mail SFS clients.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">This value entry specifies whether or not SMTP headers are sent to MS Mail SFS clients by the Exchange MS Mail Connector.  The effect of this value entry is different depending upon which mail client (MS Mail or Exchange) receives and displays the mail, whether or not the the sender is defined as a custom recipient in Exchange, whether the message is of class MAPI, and upon the status of the StripGatewayHeaders value entry that can be set by the Windows MS Mail client. </P>
<P CLASS="t">These variables determine whether or not the SMTP headers are received and displayed by SFS.  The SMTP headers may not be displayed by the MS Mail Client, even if the Pass SMTP Headers to SFS value entry has the default value of 0.  </P>
<P CLASS="t">When SFS receives a message from the Internet Mail Service and the sender of the message is defined as a custom recipient in Exchange, the MS Mail Windows Client will always display the message headers.  If the StripGatewayHeaders value entry is set, it is over-ridden by these circumstances.  This happens because although the MS Mail Client is aware of message header information in addition to the MAPI designation, it is unable to parse the additional fields and so the client displays all header information, regardless of its type.  This is default behavior of the MS Mail Client.</P>
<P CLASS="t">When SFS receives a message from the Internet Mail Service and the sender of the message is not a custom recipient in Exchange, but has an address of type MS:\net\po\user, the MS Mail Windows Client and the MS Mail Transport Service for Exchange will never display the message headers.  In this case, if the StripGatewayHeaders value entry is set to display header information, and the Pass SMTP Headers to SFS value entry is set to 0, the MS Mail Windows Client and the MS Mail Transport Service for Exchange will still be unable to display this information.  This is also MS Mail Client default behavior.</P></BODY></HTML>
