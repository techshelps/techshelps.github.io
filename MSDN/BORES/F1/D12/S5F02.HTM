<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Running the Mailbox Migration tool</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Running the Mailbox Migration tool</H3><P CLASS="ls">Verify that your workstation is logged on to an account with the necessary permissions to create profiles and open mailboxes.</P>
<P CLASS="ls">Create a profile on the workstation that can be modified by the Mailbox Migration tool.</P>
<P CLASS="ls">From the Start menu, choose <B>Run</B>.</P>
<P CLASS="ls">Locate the Migrate.exe file and double-click on the filename.</P>
<P CLASS="ls">Type the path name and file name of the recipient's list file that contains the recipient's name and server.</P>
<P CLASS="lt1">Following is the structure of the recipient's file.</P>
<P CLASS="lt1"><I>&lt;Display Name&gt;,&lt;Alias Name&gt;,&lt;Pilot Server Name&gt;,&lt;Production Server Name&gt;&lt;CRLF&gt;</I></P>
<P CLASS="lt1">For example:</P>
<P CLASS="lt1">Joe Bloggs,JoeB,GW-PILOT1,GW-PROD1</P>
<P CLASS="lt1">Mary Smith,MarySm,GW-PILOT1,GW-PROD1</P>
<P CLASS="lt1">The file can contain any number of recipients and any combination of servers.</P>
<P CLASS="ls">Choose <B>Start</B>.</P>
<P CLASS="t">When the file is found, the Mailbox Migration tool begins processing the first recipient in the file.</P>
<P CLASS="t">The following figure illustrates the Mailbox Migration Tool user interface.</P>
<P CLASS="a"><img src="xerk_f46.gif"></P>
<P CLASS="t">For each recipient in the file, the application performs the following functions.</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Modifies the migration profile so it can open your mailbox and create a new .pst file on the workstation.</LI><LI CLASS="ULI1">Logs on to this profile.</LI><LI CLASS="ULI1">Copies all the messages and all subfolder trees in the mailbox Inbox folder to the .pst Inbox folder.</LI><LI CLASS="ULI1">Copies all the messages in the mailbox Sent Items folder to the .pst Sent Items folder. You can ignore any subfolders, unless it is easier to copy everything.</LI><LI CLASS="ULI1">Copies all the other folders, subfolders, and messages that you have created from the mailbox to the .pst store. However, any custom views, filters, rules, and permissions will not be copied.</LI><LI CLASS="ULI1">Logs off the profile.</LI><LI CLASS="ULI1">Copies the folders and messages from the .pst to your mailbox on the production server. Note that the Inbox of the new server will be checked. If there are any messages in this folder, the mailbox will not be migrated and an error message is generated. The Inbox is always the first folder to be migrated.</LI><LI CLASS="ULI1">Deletes the .pst file.</LI><LI CLASS="ULI1">If you choose the <B>Stop</B> button, the Mailbox Migration tool continues to process the current mailbox and then stops processing after the mailbox has been migrated, or after the mailbox migration attempt has failed due to errors.</LI><LI CLASS="ULI1">Any errors generated in the process are logged to an error log. </LI><LI CLASS="ULI1">The structure of the log file is as follows:</LI></UL></SPAN><P CLASS="t">&lt;type&gt;,&lt;Display Name&gt;,&lt;Alias Name&gt;,&lt;Pilot Server Name&gt;,&lt;Production Server Name&gt;,&lt;Description&gt;,&lt;Timestamp&gt;&lt;CRLF&gt;</P>
<P CLASS="t">For example:</P>

<PRE>SUCCESS,Joe Bloggs,JoeB,GW-PILOT1,GW-PROD1,Migrated No Errors,5/10/96 10:05:00
or:
FAILURE,Mary Smith,MarySm,GW-PILOT1,GW-PROD1,Error Copying Messages,5/10/96 10:09:10
</PRE>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">If the Migration Mailbox tool fails for any reason, you can restart the tool from the same point by using the same recipient list (as each successful migration causes the entry to be deleted).</LI><LI CLASS="ULI1">To migrate single users or groups of users that were not migrated because of errors, you can create recipient list files and run the Mailbox Migration tool again.</LI><LI CLASS="ULI1">When all mailboxes have been migrated in the recipient list, a message appears stating that the system has completed the migration.</LI></UL></SPAN><H4 CLASS="h3"><A NAME="sec0"></A>Control File</H4><P CLASS="t">The tool uses a standard comma-separated value file which contains the information required to migrate a mailbox from one server (source) to another server (destination). The control file can be created by any text editor or a spreadsheet like Microsoft Excel. There is a sample control file supplied (Sample.csv) that contains a header row and a sample line. The tool does not expect a header row in the control file, but it is easier to leave the header row in so the tool posts an error against the first record in the file.</P>
<P CLASS="t">The control file has two purposes. It is used as the input to the utility but also as the output and error log. An identical file format is created after running the utility. It marks the status of every record that has been migrated, any errors that occurred, and a timestamp showing when each migration was completed.</P>
<P CLASS="t">The fields are described below in the order they occur in the file.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="258pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="tt">SrcOrgName</P></TD><TD VALIGN="TOP"><P CLASS="tt">The name of the Exchange Organization where mailbox &lt;SrcAliasName&gt; is located.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">SrcSiteName</P></TD><TD VALIGN="TOP"><P CLASS="tt">The name of the Exchange Site where mailbox &lt;SrcAliasName&gt; is located.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">SrcAliasName</P></TD><TD VALIGN="TOP"><P CLASS="tt">The unique mailbox identifier on server &lt;SourceServer&gt; (unique within the Exchange site that hosts &lt;SourceServer&gt;)</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">DisplayName</P></TD><TD VALIGN="TOP"><P CLASS="tt">The display name as produced by the Exchange Directory Export Function.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">SrcNewDisplayName</P></TD><TD VALIGN="TOP"><P CLASS="tt">The display name used for the mailbox &lt;SrcAliasName&gt;. If this value is not blank, the display name is replaced with this value so that the mailboxes in both sites can be distinguished. If the value is blank, the name remains unchanged.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">SourceServer</P></TD><TD VALIGN="TOP"><P CLASS="tt">The machine name of the server where mailbox &lt;AliasName&gt; is located.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">DestOrgName</P></TD><TD VALIGN="TOP"><P CLASS="tt">The name of the Exchange Organization where mailbox &lt;DestAliasName&gt; is located.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">DestSiteName</P></TD><TD VALIGN="TOP"><P CLASS="tt">The name of the Exchange Site where mailbox &lt;DestAliasName&gt; is located.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">DestAliasName</P></TD><TD VALIGN="TOP"><P CLASS="tt">The unique mailbox identifier on server &lt;DestinationServer&gt; (unique within the Exchange site that hosts &lt;DestinationServer&gt;). This mailbox should already exist and have a valid Windows NT account associated with it.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">DestNewDisplayName</P></TD><TD VALIGN="TOP"><P CLASS="tt">The display name used for the mailbox &lt;DestAliasName&gt;. If this value is not blank, the display name of &lt;DestAliasName&gt; is set to this value. If this value is blank, then the display name of &lt;DestAliasName&gt; is set to &lt;DisplayName&gt;.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">DestinationServer</P></TD><TD VALIGN="TOP"><P CLASS="tt">The machine name of the server where mailbox &lt;DestAliasName&gt; is located.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">PstUNCName</P></TD><TD VALIGN="TOP"><P CLASS="tt">The location in UNC format where the .pst file is created or is to be found (the use depending on the value of pstBackup).  The actual name of the .pst file will be the alias name of the destination mailbox &lt;DestAliasName&gt;.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">PstBackup</P></TD><TD VALIGN="TOP"><P CLASS="tt">If this value is "Y" then the .pst file named &lt;AliasName&gt; is created in location pstUNCName from mailbox &lt;AliasName&gt; on server &lt;SourceServer&gt; if the value of Status is blank. The mailbox is not migrated from the .pst file to the destination server if this value is "Y".</P>
<P CLASS="tt">If this value is NOT "Y" then the mailbox &lt;AliasName&gt; is created on server &lt;DestinationServer&gt; from the contents of the .pst file located at &lt;pstUNCName&gt;.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">SetupAutoRules</P></TD><TD VALIGN="TOP"><P CLASS="tt">If this value is "Y" then a rule is created on mailbox &lt;SrcAliasName&gt; on server &lt;SourceServer&gt; that will set up an Auto Reply message. This message indicates that the mailbox is being migrated and message delivery will be delayed.</P>
<P CLASS="tt">Additionally, a rule is created on the mailbox &lt;SrcAliasName&gt; on server &lt;SourceServer&gt; that forwards all messages to mailbox &lt;DestAliasName&gt;.</P>
<P CLASS="tt">Both rules are created BEFORE the creation of the .pst file &lt;pstUNCName&gt; so that any new messages that are sent to the mailbox during the migration will get forwarded. However, the rules should not be copied to the new mailbox.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">DoSentDeletedItems</P></TD><TD VALIGN="TOP"><P CLASS="tt">If this value is "Y", then the Sent Items folder (and all sub folders) and the deleted items folder (and all its sub folders) will be copied.  Otherwise, they will be ignored.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Status</P></TD><TD VALIGN="TOP"><P CLASS="tt">This value will be blank, "Partial", "Complete" , "Failure", or "CRITICAL". The value is initially blank and is filled in by the utility after a mailbox has been migrated. A blank indicates a record that has not been migrated yet. "Partial" indicated that the mailbox has been successfully copied to a .pst file. "Complete" indicates that the mailbox has been fully migrated from one server to another. "Failure" indicates that some error has occured. "CRITICAL" indicates that an error has occured, causing a mailbox to be left in an inconsistent state, and requires attention.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Description</P></TD><TD VALIGN="TOP"><P CLASS="tt">This is a text string that generally will contain error messages.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">TimeStamp</P></TD><TD VALIGN="TOP"><P CLASS="tt">After a migration phase, this field contains a timestamp of the mailbox when the migration was completed.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P></BODY></HTML>
