<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>2.1  Microsoft Systems Management Server Tool Notes</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">2.1 Microsoft Systems Management Server Tool Notes</H3><P CLASS="t">The tools provided for use with Microsoft Systems Management Server are intended for use with Systems Management Server 1.2 only.</P>
<P CLASS="t">The binaries for the SMS New Service Account utility (Newsvcac.exe) are not on the BackOffice Resource Kit Part II CD-ROM.  At the time of shipping, this application was undergoing burn-in testing.  If the tests are successful, it is intended that the binaries will be placed on the FTP site for the BackOffice Resource Kit:  <B>ftp://ftp.microsoft.com/bussys/backoffice/reskit/</B>.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>2.1.1    Windows NT Inventory File Collection Tool</H4><P CLASS="t">In the Installation program for the Windows NT Inventory File Collector (Instpoll.exe), the default path contains spaces.  Delete the spaces before continuing.  Also, the installation program exits without confirming that installation is complete.</P>
<P CLASS="t">In the Password dialog box of the Windows NT Inventory File Collector installation, the OK button is not the default pushbutton, so pressing ENTER does not close the dialog box.</P>
<P CLASS="t">If you enter a bad service account during the installation of the Windows NT Inventory File Collector service, you will not be notified, although a log file called Pollreg.log will be created.  However, when you try to start the service,  it won't start.  The service account must be given as the domain and the username in the form <I>DOMAIN\username</I>.</P>
<H4 CLASS="h3"><A NAME="sec1"></A>2.1.2    Srvinfo Tool</H4><P CLASS="t">The Srvinfo tool is not supported for the Alpha platform running Windows NT 3.51.</P>
<H4 CLASS="h3"><A NAME="sec2"></A>2.1.3    SHRPERM.EXE</H4><P CLASS="t">When SHRPERM sets share permissions on Windows NT Server or Windows NT Workstation, it overwrites the existing permissions. It does not modify the existing permissions. The folder must already be shared when you use SHRPERM.EXE to change the permissions.</P>
<H4 CLASS="h3"><A NAME="sec3"></A>2.1.4    Controlling Secondary Site Upgrades</H4><P CLASS="t">Typically, when a new version of Systems Management Server is installed at the primary site, the secondary sites reporting to the primary are automatically updated to this new version. In some cases you may want to block the automatic upgrade of secondary sites, and upgrade them manually after the primary site has been upgraded. Tools and documentation to do so are included with this Resource Kit. For details, see Upg2site.doc in the SMS\Docs directory on the BackOffice Resource Kit CD-ROM.</P>
<P CLASS="t">The documentation and tools for controlling secondary site upgrades are also available at <B>http://www.microsoft.com/SMSMGMT/whitepaper.htm.</B></P>
<P CLASS="t">Note   The tool for performing manual upgrades to secondary sites must be run from the directory in which the DLLs are located: <B>SMS\SITE.SRV\platform.BIN</B>.</P>
<P CLASS="t">When typing the command</P>
<P CLASS="lt1"><B>setup /SYSMAP:system_map_path\SYSTEM.MAP /NOAUTOUPGRADE</B></P>
<P CLASS="t">great care must be taken not to misspell any of the parameters.  A misspelled parameter will not be reported, and could cause the setup to unintentionally upgrade the secondary sites.  To avoid this, use </P>
<P CLASS="lt1"><B>setup2</B> <I>path</I></P>
<P CLASS="t">where <I>path</I> is the fully qualified path to the new <B>SYSTEM.MAP</B> file.  The setup2.cmd script will always print the usage information whether or not the correct path is entered.</P>
<P CLASS="t">The Setup.exe utility requires the following DLLs:</P>
<P CLASS="t">Ntwdblib.dll</P>
<P CLASS="t">Msvcrt40.dll</P>
<P CLASS="t">Dbnmpntw.dll</P>
<H4 CLASS="h3"><A NAME="sec4"></A>2.1.5    Location of the SMSSAFE.TMP file</H4><P CLASS="t">As documented in the BackOffice Resource Kit Part I, the SMSSAFE.TMP file is created by the Inventory Agent to record the status of hardware inventory. This file is located in <I>drive_letter:</I><B>\ms\sms\data</B>, not in the root directory of <I>drive_letter</I>.</P>
<H4 CLASS="h3"><A NAME="sec5"></A>2.1.6    CHKSMS.SQL</H4><P CLASS="t">In the BackOffice Resource Kit Help and in Chapter 4, "Tools," of the Microsoft Systems Management Server Resource Guide, there are references to a file named CHECKSMS.SQL. The file name should be CHKSMS.SQL.</P>
<H4 CLASS="h3"><A NAME="sec6"></A>2.1.7    Replicating MSTEST Files Down a Hierarchy</H4><P CLASS="t">In the BackOffice Resource Kit Help and in Chapter 4, "Tools," of the Microsoft Systems Management Server Resource Guide, under the topic "COPYVT.BAT," an example is presented as instruction, and could be confusing. It is more accurate with the following change:</P>
<P CLASS="t">Because the mstest files are not automatically replicated down a hierarchy, you must copy them to every site that needs them. The platform of the files to copy to a current site should be the same as the platform of the clients that will use them; it does not depend on the platform of the current site. For example, you could copy the x86 files to the site and use them to install all the x86 sites you want. Then copy the Alpha files to the site (overwriting the x86 files) and use them to install all the Alpha sites you want. An Alpha client must find the Alpha files on its site server, even if its site server is x86. </P>
<H4 CLASS="h3"><A NAME="sec7"></A>2.1.8    CLIOPTS.EXE</H4><P CLASS="t">CLIOPTS.EXE is a 16-bit application. It applies only to Windows 3.1 and Windows for Workgroups clients.</P>
<H4 CLASS="h3"><A NAME="sec8"></A>2.1.9    FILEMOVE Utility</H4><P CLASS="t"><B>Target Directories Must Already Exist</B></P>
<P CLASS="t">When you use FILEMOVE to copy files, the target directories must already exist. If you attempt to copy files to a non-existent directory, the files will not be copied. The reported number of files copied will reflect that files were not copied to the non-existent directory, but no error message is generated. </P>
<P CLASS="t"><B>Polling Interval Setting</B></P>
<P CLASS="t">If the polling interval in the FMUI dialog box is missing or invalid, you will be prompted for the polling value and the value for the polling interval and for the log file size will be set to 0. You must then enter a valid integer for both of these fields.</P>
<P CLASS="t"><B>Log File</B></P>
<P CLASS="t">The size of the log file for the FILEMOVE utility must be explicitly set. If no value is set for the log file size, you will be prompted for the log file size (in kB). The log size must be set to an integer value between 10 and 100000000. Be sure the value you supply is within this range. If you specify a value greater than 100000000, the invalid value appears to be accepted but the file size remains at the last valid value.If you specify a value less than 10, you will be prompted for a valid value, and the values for both the polling interval and the log file size will be set to 0. You must then enter a valid integer for both of these fields.</P>
<P CLASS="t">As described in the BackOffice Resource Kit Help and in Chapter 4, "Tools," of the Microsoft Systems Management Server Resource Guide, FILEMOVE.EXE writes status to its log file (FILEMOVE.LOG). When this log file reaches its maximum size, it is closed and renamed FILEMOVE.LO_. A new FILEMOVE.LOG file is then created. Note that if an earlier FILEMOVE.LO_ file exists, it is overwritten by the new FILEMOVE.LO_ file.</P>
<P CLASS="t">Make sure you have sufficient space for the files to be copied and for the log file on the target computer. If the drive containing the log file becomes filled while the log file is smaller than the maximum size you have set, FILEMOVE will be unable to append new logs to the file. In this case the log file never reaches its maximum size, and so the FILEMOVE.LO_ file is never created or overwritten. As a result you have an incomplete log. If the drive that FILEMOVE attempted to copy files to was also filled, some of the lost entries will concern files that were not successfully copied.</P>
<P CLASS="t"><B>Polling Interval and Creation of New Folders</B></P>
<P CLASS="t">If a folder is being created on the target computer when the polling for FILEMOVE begins, the process that is creating the folder will hang until FILEMOVE.EXE or the FILEMOVE service is stopped, and some of the information supplied to create the folder may be lost. (For example, the last one or two characters of the folder name might be lost.) You may want to set the polling interval so that polling is unlikely to begin at times when a folder may be being created.</P>
<H4 CLASS="h3"><A NAME="sec9"></A>2.1.10    Creating a UMF File</H4><P CLASS="t">The Reskit utiltity UGMIF.EXE creates a user group MIF file with a .MIF extension.  As of SMS 1.2, user group MIF's should have an extension of .UMF. After you have created the user group MIF file with UGMIF.EXE, the MIFNAME tool can be used to rename the MIF file to a UMF file.</P>
<H4 CLASS="h3"><A NAME="sec10"></A>2.1.11    Notes on PDFWIZ.EXE </H4><P CLASS="t">The following notes apply to the PDF Wizard (PDFWIZ.EXE).</P>
<P CLASS="t"><B>Specifying Windows NT ALPHA </B></P>
<P CLASS="t">The PDF Wizard (PDFWIZ.EXE) does not successfully specify WindowsNT (ALPHA) as an operating system on which the files can be installed or deinstalled. This setting must be adjusted manually after the PDF is imported into SMS.</P>
<P CLASS="t"><B>Selecting Platforms On Which Files Can Be Installed</B></P>
<P CLASS="t">The dialog in which you specify the platforms on which the files in the PDF can be installed is the tenth dialog. It is mis-labeled Select the operating system on which the deinstallation command can run.</P>
<H4 CLASS="h3"><A NAME="sec11"></A>2.1.12    Notes on RSERVICE.EXE</H4><P CLASS="t">The following notes apply to the new features of RSERVICE included in this Resource Kit.</P>
<P CLASS="t"><B>Path Must Exist for Files in [other files] Section of Initialization File</B></P>
<P CLASS="t">The files listed in the [other files] section of the RSERVICE initialization file will be installed successfully if and only if the directory specified for those files exists on the destination computer. Make sure that all directories in the path have been created before using RSERVICE to install the service.</P>
<P CLASS="t"><B>Path Must Exist for Log Files </B></P>
<P CLASS="t">When you use the /log option to the rservice command, a log file will be created if and only if the directory specified with the /log option exists. </P>
<P CLASS="t"><B>Using the /deinstall Parameter</B></P>
<P CLASS="t">When you remove a service using the <B>rservice  /deinstall</B> command, the user account specified in the [service account] section of the RSERVICE initialization file is removed from Administrators local group on the client computer.  However, the account still exists in the domain, and it still has the <B>log on as a service</B> privilege on the client computer.  You may want to explicitly change the permissions for the user account on the client computers.</P>
<P CLASS="t"><B>Do Not Use The /change Parameter</B></P>
<P CLASS="t">The /change parameter to the rservice command does not successfully change the service account or password. If you accidentally use this parameter, you may be unable to start the service using either the old or the new account and password. If this happens, remove and reinstall the service.</P>
<P CLASS="t"><B>Computer Prefixes In [automatic start] and [machine list] Sections</B></P>
<P CLASS="t">In the [automatic start] section of the RSERVICE initialization file, list the computername for each computer, or indicate all computers with the *=parameter entry. Do not use computer prefixes in this section.</P>
<P CLASS="t">In the [machine list] section of the RSERVICE initialization file, list the computername for each computer. Do not use computer prefixes in this section.</P>
<P CLASS="t"><B>Permissions For Files in [other files] Section of Initialization File</B></P>
<P CLASS="t">The permissions specified in the [access permissions] section of the initialization file are assigned to those files listed in the [other files] section that are installed in the directory specified in the [installation directory] section. Files that are installed in other directories will not be assigned the permissions specified in the [access permissions] section.</P>
<P CLASS="t"><B>Embedded Spaces</B></P>
<P CLASS="t">Rservice will not accept embedded space characters in the Registry Keys, values or paths secified in the Iinitialization file.  An embedded space will cause the file to be parsed incorrectly.</P>
<H4 CLASS="h3"><A NAME="sec12"></A>2.1.13    Notes on PCM as a Service</H4><P CLASS="t">Note that the PCM service must have all needed programs in the package source. The PCM service will not find files located in the MSTEST directory. This means NTENCAP.EXE must be copied to the package source, along with any special files such as the NTUPGRD.SCR or NTUPGRD.400 script files.</P>
<P CLASS="t"><B>PCM Service Log File</B></P>
<P CLASS="t">In rare cases, on computers running WindowsNT, the PCM service does not produce a log file as expected. If this happens, set a log file name using a relative path (rather than an absolute path). The log file will then appear in the winnt\system32 directory on the boot drive.</P>
<H4 CLASS="h3"><A NAME="sec13"></A>2.1.14    SVCCTRL.EXE </H4><P CLASS="t">The Service Control utility (SVCCTRL.EXE, formerly called INSTSRV.EXE) controls services using the name used in the registry, rather than the "display name" that appears in dialog boxes. In most cases, these names are identical. The names are most likely to differ when there are spaces in the display name (for example, SMS Client Inventory and SMS Remote Control Agent). </P>
<P CLASS="t">If SVCCTRL seems unable to control a service, check for the name used for the service in the registry. You can either examine the registry directly, or use TLIST.EXE (included in the BackOffice Resource Kit) to view a list of the names of executable files that are running, and cross the executable name to the display name. When looking for information in the registry, if it is in a key, use  \View \Find Key… , unselect "match whole word only", enter the string and search. The key for WUSER32 can be found by searching for wuser. If the information is in a value, use \Registry \Save subtree as … to save the registry to a text file, open the file in notepad (the registry can be several megs in size so this can take a while), and use find in notepad to search for the value. The display name is a value, so this is the way that a display name will have to be crossed if it is not listed in the cross reference. Most tools controlling services can only use the service name, or executable name, not the display name.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="99pt" VALIGN="TOP"><COL WIDTH="144pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">Service Name</P></TD><TD VALIGN="TOP"><P CLASS="th">Display Name</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">WUSER32 </P></TD><TD VALIGN="TOP"><P CLASS="tt">SMS Remote Control Agent</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">INV32CLI </P></TD><TD VALIGN="TOP"><P CLASS="tt">SMS Client Inventory</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H4 CLASS="h3"><A NAME="sec14"></A>2.1.15    NetBoot Help - "About NetBoot"</H4><P CLASS="t">The "About NetBoot" dialog in the Help for NetBoot is not accessible after the utility has been used to create a net boot disk. The "About NetBoot" dialog becomes available again after you close and re-open the utility.</P>
<H4 CLASS="h3"><A NAME="sec15"></A>2.1.16    SKIPINV.EXE </H4><P CLASS="t">In the example given for SKIPINV in the BackOffice Resource Kit Help and in Chapter 4, "Tools," of the Microsoft Systems Management Server Resource Guide, the line </P>
<P>if errorlevel 12 goto RESTORE</P>
<P></P>
<P CLASS="t">should be changed to </P>
<P>if errorlevel 12 goto SCAN</P>
<P></P>
<H4 CLASS="h3"><A NAME="sec16"></A>2.1.17    Network Boot Floppy</H4><P CLASS="t">Netboot.exe requires that a database engine, such as Microsoft Access 7 (Access 95), be installed and available to the Netboot utility.  Netboot.exe will not work with Microsoft Access 2 or Access 8 (Access 97).</P></BODY></HTML>
