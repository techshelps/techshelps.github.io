<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Dropper Remote Tool</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Dropper Remote Tool</H3><P CLASS="t">Dropper Remote (DropRm.exe) is a Windows Sockets (WinSock) server application that uses static port allocation (port 1066). The "Run Remote Application" action contains a WinSock client that connects to the specified server and sends a data structure over the WinSock connection. The structure is then decomposed into a command string and several option flags on the remote side, and the application starts. If the application successfully starts and if you have requested the "Wait for completion" flag, DropRm waits until the application has started, and then returns a handshake signal to Dropper by using the active connection. At this point, the Dropper script execution proceeds normally.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Using Dropper Remote</H4><P CLASS="t">The Dropper <B>Run Remote Application</B> command enables you to run an application on a remote computer, instead of running it on a computer where Dropper resides. This command is useful if:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">You need to run installation programs for an application on a number of remote computers to upgrade existing software.</LI><LI CLASS="ULI1">You need to run batch files on remote computers that perform functions not accessible from remote computers, such as mapping local drives to network shares.</LI><LI CLASS="ULI1">You need to run batch files to distribute network load, such as copying very large directory trees.</LI></UL></SPAN><P CLASS="proch">To install Dropper Remote</P>
<P CLASS="ls">If you followed the procedures described earlier in "Installing Buddy Dropper," then you have already installed Dropper Remote. If Dropper Remote is already installed, double-click DropRm.exe to start the program. If you have not already installed Dropper Remote, then follow the procedures below: </P>
<P CLASS="ls">Copy DropRm.exe to any directory (preferably a directory in the system path).</P>
<P CLASS="ls">Copy the following DLLs to the system directory (%systemroot%\system for Windows95 or %systemroot%\system32 for Windows NT):</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI2">mfc40.dll</LI><LI CLASS="ULI2">msvcrt40.dll</LI><LI CLASS="ULI2">wsock32.dll.</LI></UL></SPAN><P CLASS="ls">Start DropRm.exe.</P>
<P CLASS="t">To use the Dropper <B>Run Remote Application</B> command, the remote target computer of a <B>Run Remote Application</B> action must be running the Dropper Remote file (DropRm.exe), and must use Transport Control Protocol/Internet Protocol (TCP/IP) as the communication protocol.</P>
<P CLASS="t"><B>Note   </B>The DropRm application does not need to be running on remote servers if you do not plan to use the <B>Run Remote Application</B> action. To maximize the usefulness of Buddy Dropper, however, it is recommended that DropRm be placed in the startup group of all computers where Dropper will run, so that it is always available. The flat/min can be used when running DropRm to cause it to run minimized (for Help on command-line options, type <B>DropRm /?</B> at the command prompt).</P>
<H5 CLASS="h4"><A NAME="sec1"></A>Dropper Run Remote Application action</H5><P CLASS="t">The following figure shows the configuration tab for a <B>Run Remote Application</B> action.</P>
<P CLASS="a"><img src="xerk_f08.gif"></P>
<P CLASS="t">In this example, the Notepad.exe application is started on all servers where the action applies. The working directory is an optional argument. If it is specified, the application's working directory will be set. If it is not specified, the working directory is the system default directory. Note that if the working directory is specified but does not exist, the application will fail to start.</P>
<P CLASS="t">In the following example, Dropper runs a batch file on the remote computer; the application "cmd.exe" (the Windows NT command prompt) starts with the batch file specified as an argument, and no working directory is set. The <B>/c</B> argument causes the command prompt to exit after the batch file is run.</P>
<P CLASS="a"><img src="xerk_f09.gif"></P>
<P CLASS="t">If you need to have an application completed on the remote computer before continuing the Dropper script, select the <B>Wait for application to complete</B> check box. This causes the Dropper script to stop until the remote application has completed (or has failed to execute).</P>
<P CLASS="t">You can, however, stop the Dropper script during this time. A common situation requiring use of the Wait flag is the mapping of a network share to a local drive. In this case, you would do the following:</P>
<P CLASS="ls">If drive X: is currently mapped to a network resource, unmap it by typing the following at the command prompt:</P>
<P CLASS="lt1"><B>net use /d X: </B></P>
<P CLASS="ls">Map drive X to \\&lt;<I>server\share</I>&gt; by typing:</P>
<P CLASS="lt1"><B>net use X: \\&lt;</B><B><I>server\share</I></B><B>&gt;</B></P>
<P CLASS="t">In this case, the steps must be sequential. Step one must be completed before you move to step two. The Wait flag should be specified in step one. Also, because further actions are likely to depend on the drive mapped by step two, it is suggested that you specify the Wait flag for step two as well.</P>
<H5 CLASS="h4"><A NAME="sec2"></A>Example of using Buddy Dropper</H5><P CLASS="t">In the following example, Dropper is being used to install and upgrade Microsoft Exchange Server testing topologies consisting of 100 or more computers. Computers within the topology are a mixture of Intel, Alpha, MIPS and PowerPC platforms. Each computer has installed one of a dozen or more languages. Each configuration mandates a different set of installation files and settings. The following figure displays these files and settings.</P>
<P CLASS="a"><img src="xerk_f10.gif"></P>
<P CLASS="t">In this example, the following procedures are used:</P>
<P CLASS="ls">Obtain the country code for the installed language from the remote computer's registry.</P>
<P CLASS="ls">Match the language code to all known languages, and set the <B>lang</B> variable accordingly (<B>lang</B> will then contain the name of a directory based on language type on the install point from which the Setup program is run)</P>
<P CLASS="ls">Perform the same procedure for detection of processor type.</P>
<P CLASS="ls">Construct the string that indicates the universal naming convention (UNC) path to the appropriate setup.exe for the remote computer's processor type and installed language.</P>
<P CLASS="ls">Have the remote computer launch setup.exe from the setup path and with appropriate flags.</P></BODY></HTML>
