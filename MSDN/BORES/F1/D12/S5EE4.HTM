<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Monitoring for Specific Events</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Monitoring for Specific Events</H3><P CLASS="t">You can use the Event Log Scan tool (Evtscan.exe) to monitor servers for specific events. When a specified event is detected, the Event Log Scan tool can be configured to: </P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Start an application or specify any other command-line directives.</LI><LI CLASS="ULI1">Send a message by using a selected profile and password.</LI><LI CLASS="ULI1">Send a network pop-up message to specific computers. </LI><LI CLASS="ULI1">Restart or stop the service.</LI></UL></SPAN><P CLASS="proch">To run the Event Log Scan tool</P>
<P CLASS="ls">Create a configuration file with a .cfg extension specifying the events and actions required. The format is as follows:</P>
<P CLASS="lt1">EventID;Source;Action;Alert list;Mail list;Command line;Comment string;</P>
<P CLASS="lt1">Following is a list of each configuration entry and a description for the type of event.</P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="243pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">Configuration Entry</P></TD><TD VALIGN="TOP"><P CLASS="th">Description</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Event ID</P></TD><TD VALIGN="TOP"><P CLASS="tt">The numerical event ID (see the Windows NT Event Viewer).</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Source</P></TD><TD VALIGN="TOP"><P CLASS="tt">The source name for the service to monitor.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Action</P></TD><TD VALIGN="TOP"><P CLASS="tt">The action to take; can be Restart or Stop.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Alert list</P></TD><TD VALIGN="TOP"><P CLASS="tt">A comma-separated list of computers to send network pop-up messages to when the event is detected.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Mail list</P></TD><TD VALIGN="TOP"><P CLASS="tt">A comma-separated list of e-mail aliases to notify when the event is detected.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Command line</P></TD><TD VALIGN="TOP"><P CLASS="tt">Command line with parameters (can be up to 256 characters in length).</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Comment string</P></TD><TD VALIGN="TOP"><P CLASS="tt">A comment that is included in the alert pop-up message and e-mail message when the event occurs.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="ls">Run Evtscan.exe by using the following command-line format:</P>
<P CLASS="lt1"><B>Evtscan -f</B><I> </I><B><I>&lt;config_file&gt;</I></B><B> -u &lt;</B><B><I>profile_name</I></B><B>&gt; [-p &lt;</B><B><I>password</I></B><B>&gt;] <BR>[-t &lt;</B><B><I>delay_in_seconds&gt;] server_list</I></B></P>
<P CLASS="lt1">where <I>config_file</I> is the name of the configuration file created in step 1, <I>delay_in_seconds</I> is the time the tool waits between scans (for example, typing <B>-t 15</B> sets the tool to scan for events every 15 seconds), profile is the name of the exchange profile to be used, password is the password for the profile, and <I>server_list</I> is a comma-separated list of the servers to monitor for the events. </P>
<P CLASS="lt1">Following is an example of typical syntax usage for the Event Log Scan tool: <B>Evtscan -f test.cfg -u scan -t 15 server1,server2,server3</B></P>
<P CLASS="ls">Leave Evtscan running on your computer desktop. You may want to minimize the command prompt window.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Sample Configuration File</H4><P CLASS="t">The following is a sample configuration file.</P>

<PRE>;sample config file. 
;Event ID;Source;Action;Alert List;Mail List;Command;Comment String
9277;MSExchangeMTA;restart; monitorwks1; johncole;winbeep.exe;Event 9277
9278;MSExchangeMTA;stop; monitorwks1;;notify.bat;Event 9278
9279;MSExchangeMTA;; monitorwks1; Aron Mecsi;;Event 9279
9299;MSExchangeMTA;;monitorwks1,monitorwks2;ChbierZ,EtueD;;Shutdown Complete
</PRE></BODY></HTML>
