<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the UNIX Mail Source Extractor</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Using the UNIX Mail Source Extractor</H3><P CLASS="t">Before attempting to use this utility, you should be familiar with the RFC822 standard. The Unix Source Extractor <I>parameter file</I> is referenced throughout this document. For more information on this file, see the "User Interface" section.</P>
<P CLASS="t">Note that the migrated files will be named <B>mmddhhmm.pkl, mmddhhmm.pri, &lt;loginID&gt;.pri</B>, and &lt;<B>loginID&gt;.sec.</B> The <B>mmddhhmm.pri</B> file will only contain the Directory section. If a file exists with the same time, the minutes value <B>(mm)</B> will be incremented by one minute. </P>
<H4 CLASS="h3"><A NAME="sec0"></A>Command-Line Syntax</H4><P CLASS="proch">To perform the migration</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Use the following syntax to begin the migration process:
<P CLASS="lt1"><B>migrate [-u&lt;</B><B><I>User File</I></B><B>&gt;] [-r] [-a] [-m] [-d&lt;</B><B><I>path</I></B><B>&gt;] [-p&lt;</B><B><I>/path/Parameter File</I></B><B>&gt;] [-? | -h | -H]</B></P></LI></UL></SPAN><P CLASS="t">The following table lists the command-line options available in the UNIX Mail Source Extractor tool, and their functions:</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="65pt" VALIGN="TOP"><COL WIDTH="65pt" VALIGN="TOP"><COL WIDTH="216pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">Command</P></TD><TD VALIGN="TOP"><P CLASS="th">Class</P></TD><TD VALIGN="TOP"><P CLASS="th">Function</P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-u&lt;</B><B><I>file name</I></B><B>&gt;</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Optional</P></TD><TD VALIGN="TOP"><P CLASS="tt">Indicates a file containing a list of the users to be migrated. (Note that a file name must be present.) The file can be in password file format (<I>/etc/passwd</I>) or a list of logon IDs with one logon ID per line. This file will be used to obtain the necessary information (such as the user ID, info section, and home directory) if the line contains 6 colons, otherwise the password file will be used. This overrides the lowest <B>UserID</B> variable in the Parameter file<I>. </I></P>
<P CLASS="tt">Example:</P>
<P CLASS="tt">        File 1:<BR>            Smith:x:173:175:M Smith:/user/fac/smithj:/bin/csh<BR>            billlee:x:175:110:Z Billlee:/user/grad/Billlee:/bin/csh<BR>            Steelej:x:176:110:S Steelej:/user/grad/steelej:/usr/local/bin/tcsh<BR>        File 2:<BR>            annd<BR>            johnd</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-r</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Optional</P></TD><TD VALIGN="TOP"><P CLASS="tt">Create custom recipients in Microsoft Exchange<I>. </I>(Does not create accounts or mail.)</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-a</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Optional</P></TD><TD VALIGN="TOP"><P CLASS="tt">Create accounts in Microsoft Exchange<I>. </I>(Does not migrate mail.)</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-m</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Optional</P></TD><TD VALIGN="TOP"><P CLASS="tt">Migrate mail to Microsoft Exchange (assumes custom recipients or mailboxes exist.)</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-d&lt;</B><B><I>path</I></B><B>&gt;</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Optional</P></TD><TD VALIGN="TOP"><P CLASS="tt">Overrides the default location where the extracted data will be located<I>. </I>The default location is the current directory. </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-p</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Optional</P></TD><TD VALIGN="TOP"><P CLASS="tt">Fully qualified path to the parameter file including the file name. Use the parameter file to indicate additional parameters. The parameter file can be located anywhere with any name. (Default is current directory.) </P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>-?, -h, -H</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Optional</P></TD><TD VALIGN="TOP"><P CLASS="tt">Displays command-line Help.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">The <B>-r</B>, <B>-a</B>, and <B>-m</B> commands migrate only the specific type of information indicated<I>. </I>However, if they are used together, they will migrate all of the types<I>. </I>Following are examples of common command-line procedures:</P>
<P CLASS="proch">To migrate custom recipients and mail</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Type <B>migrate -r -m</B></LI></UL></SPAN><P CLASS="proch">To migrate accounts and mail</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Type <B>migrate -a -m</B> </LI></UL></SPAN><P CLASS="proch">To migrate custom recipients and accounts</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Type <B>migrate -r -a</B> 
<P CLASS="lt1"><B>Note   </B>This command line will generate an error message on Import.</P></LI></UL></SPAN><H4 CLASS="h3"><A NAME="sec1"></A>Before You Perform the Migration</H4><P CLASS="t">During the extraction, the process must have read access to all files and directories where the mail exists<I>.</I> Read access on all files to be migrated is the minimum requirement for extraction.<I> Root</I> or <I>Superuser</I> access can be used. All mail queues must be empty. No modifications are made to the <I>passwd</I> file. </P>
<P CLASS="t">A system of UNIX computers in a cluster will require special consideration for migration. When you perform the migration, you must have access privileges to log on to the computer that contains the mail spooler. (IMAP access is not sufficient.) If it is not possible to log on to and access both directory locations of the user's home directories and the mail spooler, migration must be run twice; once against the home directories and once against the mail spooler.</P>
<H4 CLASS="h3"><A NAME="sec2"></A>Content Migrated</H4><P CLASS="t">Account information and messages are migrated to Microsoft Exchange. The account information is accessed through the <I>/etc/passwd</I> file along with the "hostname" command, which uses the <I>/etc/hosts</I> file. Mail data is migrated from the mail spool (<I>/var/spool/mail</I> or <I>/usr/spool/mail</I>) and from files located in the home directories of the individual users.</P>
<H4 CLASS="h3"><A NAME="sec3"></A>Account Information</H4><P CLASS="t">Account information is taken from the <I>/etc/passwd</I> file. The <I>passwd</I> file has the field format of "<I>login-name:password:user-ID:group-ID:info:directory:program</I>". The properties of the new accounts are shown in the following table.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="121pt" VALIGN="TOP"><COL WIDTH="226pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">New Microsoft Exchange Property</P></TD><TD VALIGN="TOP"><P CLASS="th"><BR>Old UNIX Property</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tr"><I></I></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Common-name</P></TD><TD VALIGN="TOP"><P CLASS="tt"><I>Login-name</I> field of the <I>passwd</I> file.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Display-name</P></TD><TD VALIGN="TOP"><P CLASS="tt">The first entry of the <I>info</I> field of the <I>passwd</I> file by default. For more information, see the discussion of the <I>info</I> field following this table.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Office</P></TD><TD VALIGN="TOP"><P CLASS="tt">The second entry of the<I> info</I> field of the <I>passwd</I> file by default. For more information, see the discussion of the <I>info</I> field following this table.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Phone</P></TD><TD VALIGN="TOP"><P CLASS="tt">For more information, see the discussion of the <I>info</I> field following this table.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Secondary-proxy-addresses</P></TD><TD VALIGN="TOP"><P CLASS="tt">"migrate:smtp:&lt;login-name&gt;@&lt; hostname&gt;". <I>Login-name</I> is from the <I>passwd</I> file. <I>Hostname</I> is to be located by the UNIX c call <B>gethostname</B>,which uses the <I>/etc/hosts</I> file.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Home-server</P></TD><TD VALIGN="TOP"><P CLASS="tt">Home-server will be "<I>~server</I>" which, when imported into Microsoft Exchange, sets the home server to the current directory server.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">The mapping of the <I>info</I> field can be adjusted to individual systems. In most systems, the <I>info</I> field takes the form of "<I>display name,office,phone,</I>" although the UNIX system does not recognize <I>phone</I> but places both <I>office</I> and <I>phone</I> information in the <I>office</I> output form. You can specify directory import/export fields in the parameter file, for mapping data stored in the field. This enables the following information mappings:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="121pt" VALIGN="TOP"><COL WIDTH="226pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">/etc/passwd</P></TD><TD VALIGN="TOP"><P CLASS="th">Directory Import/Export</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Bill Lee</P></TD><TD VALIGN="TOP"><P CLASS="tt">Display-name</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Lee, Bill</P></TD><TD VALIGN="TOP"><P CLASS="tt">Surname,Given-name</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Bill Lee,10B,x55555</P></TD><TD VALIGN="TOP"><P CLASS="tt">Display-name,Office,Phone</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">If the <I>info</I> field does not contain the correct number of comma delimiters corresponding to the directory import/export template, the UNIX Mail Source Extractor does not create an error. If the <I>info</I> field does not have enough comma delimiters, the extractor accepts the data that is present and treats the other fields as having no data. If the <I>info</I> field contains too many comma delimiters, the extractor will treat the data between them as part of the last directory import/export field.</P>
<P CLASS="t">By default, only users with a user-ID over 99 are migrated. It is possible to override this default by changing the LOWEST_USER_ID_TO_MIGRATE value in the <I>param.h</I> file or by passing a specific user list file to the source extractor on the command line. Custom recipient creation is supported. </P>
<P CLASS="proch">To start migration with directory synchronization</P>
<P CLASS="t">If you want to start migration with directory synchronization, follow the procedures below to create Microsoft Exchange custom recipients for UNIX IDs.</P>
<P CLASS="ls">Use the UNIX source extractor to extract the custom recipients.</P>
<P CLASS="ls">Import the resulting migration files by using the Migration Wizard.</P>
<P CLASS="proch">To create Microsoft Exchange custom recipients on the UNIX side</P>
<P CLASS="t">To create Microsoft Exchange custom recipients on the UNIX side, follow the steps outlined below.</P>
<P CLASS="ls">Use Directory Export to create a list of Microsoft Exchange users.</P>
<P CLASS="ls">Create UNIX accounts for all of the users.</P>
<P CLASS="ls">Create the .forward file in order to forward mail to Microsoft Exchange.</P>
<H4 CLASS="h3"><A NAME="sec4"></A>Message Data</H4><P CLASS="t">The message data to be migrated comes from the system mail spooler and the user's personal storage. The mail spooler location is configurable in the parameter file and the default is set in a header file of the C code, param.h. Note that Param.h is the template for the parameter file that can be called on the command line. This value will only have to be set once per computer if it is set in the header file prior to being compiled. </P>
<P CLASS="t">The default location is <I>/var/spool/mail/</I>. Inbox, Send Items, Outbox, and Deleted Items folders are created for each user with messages from the UNIX spooler being moved to the Microsoft Exchange Inbox folder.</P>
<P CLASS="t">The source extractor will also read mail from personal storage. Mail in personal storage has to be in the same format as mail in the spooler. Messages cannot have been touched by certain Emacs e-mail clients or any other client that modifies the standard message format. </P>
<P CLASS="t">For personal storage, both <I>~/Mail/</I> and <I>~/mail/</I> will be checked by default. The parameter file can be used to change those defaults. When addresses are extracted from message headers, the UNIX comma delimiter will be changed to semicolons. The names of the UNIX files in each folder will become the names of the Microsoft Exchange folders and the original capitalization is retained. The UNIX "sent" and "sent-mail" folders will be moved to the Microsoft Exchange Sent Items folder. Subfolders, however, will not be migrated.</P>
<P CLASS="t">The folder locations will map as shown below:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="174pt" VALIGN="TOP"><COL WIDTH="174pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">New Microsoft Exchange Location</P></TD><TD VALIGN="TOP"><P CLASS="th">Old UNIX Location</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Inbox</P></TD><TD VALIGN="TOP"><P CLASS="tt"><I>/var/spool/mail/ </I>(System spooler)</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Sent Items</P></TD><TD VALIGN="TOP"><P CLASS="tt"><I>Sent</I> or <I>Sent-Mail</I> folders</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">UNIX Folder Name (Root Level)</P></TD><TD VALIGN="TOP"><P CLASS="tt">UNIX-Folder-Name</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">The message properties will map as shown below:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="127pt" VALIGN="TOP"><COL WIDTH="220pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">New Microsoft Exchange Property</P></TD><TD VALIGN="TOP"><P CLASS="th"><BR>Old UNIX Property</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Sender</P></TD><TD VALIGN="TOP"><P CLASS="tt">The second <B>From</B> line in the header. If only one exists, the first <B>From</B> line will be used.</P>
<P CLASS="tt">The second <B>From</B> line usually contains a more descriptive address. These names will most likely have the form "AnnDevon@xyz (Part-time Developer)," depending upon the form in the actual mail.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">To</P></TD><TD VALIGN="TOP"><P CLASS="tt"><B>To</B> line in the header.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Cc</P></TD><TD VALIGN="TOP"><P CLASS="tt"><B>Cc</B> line in the header.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Bcc</P></TD><TD VALIGN="TOP"><P CLASS="tt"><B>Bcc</B> line in the header.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Subject</P></TD><TD VALIGN="TOP"><P CLASS="tt"><B>Subject </B>line in the header.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Send-date</P></TD><TD VALIGN="TOP"><P CLASS="tt"><I>Send Date</I> in the header's second<B> From</B> line. If it does not exist, then <I>Received Date</I> is used. If neither exists, the default is to <I>Import time</I>.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Received-date</P></TD><TD VALIGN="TOP"><P CLASS="tt"><I>Received Date</I> in the header's first <B>From</B> line. If it does not exist, then <I>Send Date</I> is used. If neither exists, the default is to <I>Import time</I>.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Priority</P></TD><TD VALIGN="TOP"><P CLASS="tt">1 (normal).</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Unread</P></TD><TD VALIGN="TOP"><P CLASS="tt">Mail will be marked as unread unless the header field Status exists and has "r" as the value.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Unsent</P></TD><TD VALIGN="TOP"><P CLASS="tt">Always FALSE.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t"><B>Note   </B>Pine has a concept of unsent mail that is specific to Pine and dependent on the file name of the local mail store. The UNIX source extractor ignores this value and places mail in the "postponed-msgs" folder, which requires no special handling.</P>
<P CLASS="t">No calendar or address book information will be migrated.</P>
<H4 CLASS="h3"><A NAME="sec5"></A>User Interface</H4><P CLASS="t">The user interface for the Source Extractor is command-line only. After the process has started, there is no interaction between the program and the user. All control data is passed to the source extractor through the command line and parameter file at run time.</P>
<P CLASS="t">The UNIX shortcut for directory specification of "<B>~billlee</B>" for specifying "<B>/home/billlee</B>" is not allowed.</P>
<H4 CLASS="h3"><A NAME="sec6"></A>Parameter File</H4><P CLASS="t">A sample parameter file (<I>param.txt</I>) is provided and the defaults are listed in the following table for each variable. If the syntax of the file is incorrect, migration will stop with an error message. All fields, with the exception of "Local Mail Store Location," can have only one value. An exclamation mark (!) as the first character of a line denotes that the line is a comment only.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="116pt" VALIGN="TOP"><COL WIDTH="116pt" VALIGN="TOP"><COL WIDTH="116pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">Variable Name</P></TD><TD VALIGN="TOP"><P CLASS="th">Default</P></TD><TD VALIGN="TOP"><P CLASS="th">Description</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">DAPI string</P></TD><TD VALIGN="TOP"><P CLASS="tt">Display-name,Office</P></TD><TD VALIGN="TOP"><P CLASS="tt">The Directory Import string that describes the content of the <I>info</I> field in the password file. This information is not verified by the UNIX Mail Source Extractor. (&lt; 200 characters.)</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Lowest User ID to Migrate</P></TD><TD VALIGN="TOP"><P CLASS="tt">100</P></TD><TD VALIGN="TOP"><P CLASS="tt">The User ID of the first user to be migrated. This is set at 100, because it is recommended not to give users a number under 100. This default does not migrate system accounts such as <I>root</I>, <I>diag</I>, <I>sysadm</I>, <I>bin</I> or <I>news</I>. If an illegal User ID exists for the user, the account will be migrated without an error. (Integer between -1 and 10000, retrieved with scanf.)</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Mail Spool Location</P></TD><TD VALIGN="TOP"><P CLASS="tt">/var/spool/mail/ </P>
<P CLASS="tt"></P></TD><TD VALIGN="TOP"><P CLASS="tt">Location of the mail spooler. The default is pulled from the <I>param.h</I> file, which can be changed at compile time. <BR>(&lt; 200 characters)</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">Local Mail Store Location</P></TD><TD VALIGN="TOP"><P CLASS="tt">/mail/<BR>/Mail/</P></TD><TD VALIGN="TOP"><P CLASS="tt">The directory where personal mail is stored. The value "/mail/" is translated to "~home/mail/". Ten locations are supported (most sites have a maximum of three). This field is multivalued, if this variable is listed more than once in the parameter file, the last occurrence will not overwrite the previous values. Each value must be entered one per line.<BR>(&lt; 200 characters.)</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H4 CLASS="h3"><A NAME="sec7"></A>Sample Param.txt File</H4><P CLASS="t">!Directory Import string that describes the content of the Info <BR>!field in the password file.<BR>DAPI string: Display-name,Office</P>
<P CLASS="t">!UserID of the first user to be migrated. This is set at 100 <BR>!because it is recommended not to give users a number under 100. <BR>!This default does not migrate accounts such as: root, diag, <BR>!sysadm, bin, and news.<BR>Lowest UserID to Migrate: 100</P>
<P CLASS="t">!Location of the Mail spooler.<BR>Mail Spool Location: /var/spool/mail/</P>
<P CLASS="t">!Directory where personal mail is stored<BR>Local Mail Store Location: /mail/<BR>Local Mail Store Location: /Mail/</P>
<P CLASS="t"></P></BODY></HTML>
