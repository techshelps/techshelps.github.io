<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Fixfld Tool</TITLE><BODY BGCOLOR="#FFFFFF">


<H2 CLASS="h1">Fixfld Tool</H2><P CLASS="t">The Fixfld tool attempts to rebuild folder files from their current contents. Fixfld can be used only with Microsoft Mail 2.1 and later postoffices. It does not work for Microsoft Mail 3.0 or 3.2 mail message files .</P>
<H3 CLASS="h3"><A NAME="sec0"></A>When to Use Fixfld</H3><P CLASS="t">Use this tool only when a public or private folder is corrupted.</P>
<H3 CLASS="h3"><A NAME="sec1"></A>Side Effects of Using Fixfld</H3><P CLASS="t">There are no side effects when using Fixfld because this tool is only specified on the command line.</P>
<P CLASS="proch">To run Fixfld</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Use the following command-line syntax format:
<P CLASS="lt1"><B>fixfld &lt;</B><B><I>saved_folder_file new_folder_file</I></B><B>&gt;</B></P></LI></UL></SPAN><P CLASS="t">The following table lists the command-line options available for Fixfld, and their descriptions:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="168pt" VALIGN="TOP"><COL WIDTH="180pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">Option</P></TD><TD VALIGN="TOP"><P CLASS="th">Description</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>&lt;</B><B><I>saved</I></B><B>_</B><B><I>folder</I></B><B>_</B><B><I>file</I></B><B>&gt;</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">The file where the copy of the old folder file was saved</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>&lt;</B><B><I>new</I></B><B>_</B><B><I>folder</I></B><B>_</B><B><I>file</I></B><B>&gt;</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">The name of the newly created folder file.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H3 CLASS="h3"><A NAME="sec2"></A>Backing Up Your Microsoft Mail Database</H3><P CLASS="t">As with all Microsoft Mail utilities, it is highly recommended that you back up your Microsoft Mail database before running Fixfld. Typically, .Fld files are stored in the Folders subdirectory. Private folders are stored in the Loc\000xxxxx directory, where 000xxxxx is the ID number for that user. Public, group, and shared folders are stored in the Pub subdirectory. Folder files can also be stored locally on a user's hard disk drive or on an alternate network location.</P>
<P CLASS="proch">To back up your Microsoft Mail database</P>
<P CLASS="ls">At the command prompt, create a backup copy of the folder file by typing:</P>
<P CLASS="lt1"><B>copy &lt;</B><B><I>file name</I></B><B>&gt;.fld &lt;</B><B><I>file name</I></B><B>&gt;.old</B></P>
<P CLASS="ls">Rename the folder file by typing: <B>ren &lt;filename&gt;.fld &lt;filename&gt;.sav</B></P>
<P CLASS="ls">Build a new copy of the folder file from the Folders\Pub subdirectory by typing:<B> </B></P>
<P CLASS="lt1"><B>fixfld &lt;f</B><B><I>ile name</I></B><B>&gt;.sav &lt;</B><B><I>file name</I></B><B>&gt;.fld</B></P>
<P CLASS="ls">Start the Microsoft Mail Administrator program and then chooose <B>Local-Admin</B>, <B>Folders</B>, <B>Compress</B>. This is necessary to ensure that the changes are stored.</P>
<P CLASS="t">You only need to perform one folder-compress step for multiple folder rebuilds. If a folder is no longer referenced by its corresponding index file, it is safe to delete the folder file.</P>
<H3 CLASS="h3"><A NAME="sec3"></A>Rebuilding a User's Private Folder</H3><P CLASS="t">The following steps assume that you are not running Microsoft Mail version 3.0 or 3.2 of the Microsoft Mail Windows client software, because this program handles folders differently than other clients.</P>
<P CLASS="t">If you are trying to rebuild a user's private folder, you can restore the corrupted folder from the backup copy in one of three ways:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Restore the entire private folder subdirectory, in which case all information placed in any folder since the last backup will be lost.</LI><LI CLASS="ULI1">Restore the corrupted folder file and run the Fixidx tool to rebuild the index file. For more information on running this tool, see the "Fixidx Tool" section. If you follow this option, you will lose only the information placed in the corrupted folder since the last backup.</LI><LI CLASS="ULI1">You can recover the folders from a backup copy by using the following procedure:
<P CLASS="ls2">Restore a backup of the entire Microsoft Mail database to a different location on the server or to a local hard disk.</P>

<P CLASS="ls2">Run the Microsoft Mail program with the <B>-d </B>option to specify where the restored database is located. If Microsoft Mail is located on the local hard disk, use the Subst command. For example, type <B>Subst p: C:\Maildb</B>, then type <B>Mail -dp</B>.)</P>

<P CLASS="ls2">Log on to Microsoft Mail as the user with the corrupted folder files.</P>

<P CLASS="ls2">Archive all of the user's folders by selecting <B>Options</B>, <B>Folders</B>, <B>Folders</B>, <B>Archive</B>.</P>

<P CLASS="ls2">On the production postoffice, reset the user's folders, de-archive the folders into the user's active mailbox by choosing <B>Options</B>, <B>Folders</B>,<B> Folders</B>, and <B>De-Archive</B> from the Microsoft Mail program, and then remove the restored copy of the Microsoft Mail database.</P>

<P CLASS="ls2">If none of the user's private folders are accessible, you can reset that user's folder from the Microsoft Mail Administrator program. Select <B>Local-Admin</B>, <B>Folders</B>, <B>Reset</B>, select the user, and then press ENTER. This will move the folder location back to the postoffice and create a new .idx file with no folders existing.</P></LI></UL></SPAN><H3 CLASS="h3"><A NAME="sec4"></A>Restoring a Shared Folder</H3><P CLASS="t">If you are trying to rebuild a shared folder, you can restore the folder from the backup copy in one of the following ways:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Restore the entire shared folder subdirectory, in which case all information placed in any shared folder since the last backup will be lost.</LI><LI CLASS="ULI1">Restore the corrupted folder file and then run Fixidx to rebuild the index file, in which case you will lose only the information placed in the corrupted folder since the last backup.</LI></UL></SPAN></BODY></HTML>
