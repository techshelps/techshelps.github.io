<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>COPYVT.BAT: Visual Test 4 Installer</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">COPYVT.BAT: Visual Test 4 Installer</H3><P CLASS="t">COPYVT.BAT copies the Visual Test 4.0 runtime files to site servers so that other tools that use these files will have access to them. </P>
<P CLASS="t">The Visual Test 4.0 script requires four files: mtrun.exe, mstest40.dll, msvcrt40.dll, and loger2nt.dll. There are different versions for each platform (Alpha, x86). To run compiled Visual Test 4.0 scripts on a site's clients, these files must be copied (manually or using a Run Command on Workstation job) to the maincfg.box\mstest directory of the site. </P>
<P CLASS="t">SMS then copies them to logon.srv\mstest on all SMS logon servers, where Package Command Manager (PCM) will access them. When you run a PCM job on the client, PCM goes to its own site's logon servers' logon.srv\mstest directory for the mstest files. This is also true if the job came from a site server higher in the hierarchy. </P>
<P CLASS="t">Because the mstest files are not automatically replicated down a hierarchy, you must copy them to every site that needs them. The platform of the files to copy to a current site should be the same as the platform of the clients that will use them; it does not depend on the platform of the current site. You should then copy the x86 files to the site (overwriting the Alpha files) and use them to install all the x86 sites you want. Then copy the Alpha files to the site (overwriting the x86 files) and use them to install all the Alpha sites you want. An Alpha client must find the Alpha files on its site server, even if its site server is x86. </P>
<P CLASS="t">The overwriting is necessary because PCM does not look in the platform subdirectories of mstest; it looks only in mstest itself. To copy the files using a Run Command on Workstation job, import copyvt.pdf to create a workstation package whose source directory is the VT40run directory from the Resource Kit CD-ROM, and which also contains copyvt.PDF. </P>
<P CLASS="t">You must add <B>\\server\share</B> to the end of the command line in the package, where <B>server</B> is the site to which the client is attached, and <B>share</B> is the main SMS directory. SMS always shares the main SMS directory as<B> sms_shr</B><I>x</I>, where <I>x</I> is the drive on which SMS is installed. You can see which drive it is on (and thus determine the share name) by looking in the SMS Administrator's Site Properties window. For example, if SMS is installed on drive <B>d:</B> of <B>\\myMachine</B>, the argument would be <B>\\myMachine\sms_shrd</B>. </P>
<P CLASS="t"><B>Note   </B>In copyvt.pdf, the command line <B>Copy Visual Test files to serverA</B> should be used first; it copies the VT files for all platforms to the site's platform subdirectories under the mstest directory, then copies the client platform to the mstest directory itself. Change <B>serverA</B> to the name of your site server, and modify <B>\\server\share</B> as described above. If you want to use the package for more than one site, repeat for <B>serverB</B>. Add more as needed.</P>
<P CLASS="t">Once all platforms are on the site, you can use the other type of command line, such as <B>Copy VT ALPHA files to serverA MSTEST dir</B>, to copy another platform's VT files from its subdirectory to the MSTEST directory. Change <B>serverA </B>to the name of your site server, and modify <B>\\server\share</B> as described above. </P>
<H4 CLASS="h3"><A NAME="sec0"></A>Runs On</H4><P CLASS="t">Alpha, x86 </P>
<H4 CLASS="h3"><A NAME="sec1"></A>Files Required  for COPYVT </H4><P CLASS="t">ALPHAVT.BAT <BR>COPYVT.BAT <BR>COPYVT.PDF <BR>LOGER2NT.DLL <BR>MSTEST40.DLL <BR>MSVCRT.DLL <BR>MTRUN.EXE <BR>X86VT.BAT</P></BODY></HTML>
