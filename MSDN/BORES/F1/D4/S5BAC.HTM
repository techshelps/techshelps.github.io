<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CHECKRAS.EXE: RAS Connection Checker</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">CHECKRAS.EXE: RAS Connection Checker</H3><P CLASS="t">CHECKRAS indicates how many Microsoft Remote Access Service (RAS) connections are currently open. When CHECKRAS is run, it returns one of the following return codes: </P>
<P CLASS="t">0 = No RAS connections </P>
<P CLASS="t">1 = 1 or more RAS connections </P>
<P CLASS="t">These return codes can be used when CHECKRAS is used in a batch file. For example, CHECKRAS can be used as part of the network logon script to detect whether the user is logged on using RAS. The usual SMS logon processes, such as inventory collection, can then be skipped if the connection is via RAS (that is, if the return code is 1). Such a logon script would include the following lines: </P>
<P>:CHECKRAS </P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;CHECKRAS &gt; nul </P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;if errorlevel 1 goto END </P>
<P>REM normal logon steps here ... </P>
<P>:END </P>
<P></P>
<P CLASS="t">RAS must be installed on any computer that runs CHECKRAS. </P>
<H4 CLASS="h3"><A NAME="sec0"></A>Runs On</H4><P CLASS="t">Alpha, x86 </P>
<H4 CLASS="h3"><A NAME="sec1"></A>Files Required  for CHECKRAS </H4><P CLASS="t">CHECKRAS.EXE <BR>RASAPI32.DLL </P>
<H4 CLASS="h3"><A NAME="sec2"></A>checkras Syntax </H4><P CLASS="t"><B>Checkras</B></P></BODY></HTML>
