<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SMS_NT_INVENTORY_FILE_COLLECTOR:Inventory File Collector</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">SMS_NT_INVENTORY_FILE_COLLECTOR:<BR>Inventory File Collector</H3><P CLASS="t">SMS_NT_INVENTORY_FILE_COLLECTOR is a service that collects inventory files from clients. You can run SMS_NT_INVENTORY_FILE_COLLECTOR on SMS logon servers to collect inventory files from clients that are not logged on frequently enough to ensure accurate site database updating. (Normally, inventory files are collected from a client each time a user logs onto the client.) The clients from which to collect are specified in an initialization file, INVCOLCL.TXT. </P>
<P CLASS="t">SMS_NT_INVENTORY_FILE_COLLECTOR must run under a user account (such as the SMS service account) that has rights to administrative shares on all clients from which it is collecting inventory files. </P>
<H4 CLASS="h3"><A NAME="sec0"></A>Installing: INSTPOLL.EXE</H4><P CLASS="t">INSTPOLL.EXE installs SMS_NT_INVENTORY_FILE_COLLECTOR on x86-based computers. For Alpha computers, use the following procedure: </P>
<P CLASS="proch">To install the inventory file collector on Alpha computers</P>
<P CLASS="ls">On the SMS 1.2 logon server on which you wish the service to run, copy the following files to <I>installation directory</I><B>\helper.srv\alpha.bin</B>, or to the directory of your choice:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI2">POLLINV.EXE</LI><LI CLASS="ULI2">POLLREG.EXE</LI><LI CLASS="ULI2">REMVPOLL.EXE </LI></UL></SPAN><P CLASS="ls">Find and note the installation directory value in the registry key</P>
<P CLASS="lt1">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SMS\Setup </P>
<P CLASS="ls">Create the following key in the registry:</P>
<P CLASS="lt1">HKEY_LOCAL_MACHINE\<BR>          SOFTWARE\<BR>                     Microsoft\<BR>                               SMS\<BR>                                         TRACING\<BR>                                                    SMS_NT_INVENTORY_FILE_COLLECTOR</P>
<P CLASS="lt1">The key SMS_NT_INVENTORY_FILE_COLLECTOR must have precisely this spelling, since this is the name of the service that will be created.</P>
<P CLASS="ls">Define a value, TraceFilename, in the key SMS_NT_INVENTORY_FILE_COLLECTOR. This value is used to provide the Inventory File Collector with the path of its log file. Assign it the value <I>installation directory</I><B>\LOGS\invcolcl.log</B>, where <I>installation directory</I> is the pathname of the installation directory, followed by the path of the log file. </P>
<P CLASS="ls">In the key SMS_NT_INVENTORY_FILE_COLLECTOR, give <B>Enabled</B> a value of 1.</P>
<P CLASS="ls">In the key SMS_NT_INVENTORY_FILE_COLLECTOR, set the <B>Poll Interval</B> value to the number of hours you want between inventory collections. The default is 24.</P>
<P CLASS="ls">Install the service with the following command:</P>
<P CLASS="lt1">pollreg.exe -path <I>pollinv_path</I> -serviceacct <I>service_acct </I>-password <I>password</I></P>
<P CLASS="lt1">where</P>
<P CLASS="term2"><I>pollinv_path </I></P>
<P CLASS="dt2">is the absolute path of POLLINV.EXE</P>
<P CLASS="term2"><I>service_acct </I></P>
<P CLASS="dt2">is the name of the SMS service account</P>
<P CLASS="term2"><I>password </I></P>
<P CLASS="dt2">is the password on the SMS service account</P>
<P CLASS="lt1">For example, if POLLINV.EXE is in the directory C:\SMS\Helper.srv\Alpha.bin and the service account name is <B>myservacct</B> with the password <B>mypasswd</B>, the command would be: </P>
<P CLASS="lt1">pollreg -path C:\SMS\helper.srv\alpha.bin\pollinv.exe -serviceacct myservacct -password mypasswd</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Deregistering: REMVPOLL.EXE</H4><P CLASS="t">REMVPOLL.EXE deregisters SMS_NT_INVENTORY_FILE_COLLECTOR (removes it from Windows&nbsp;NT Service Control Manager [SCM]). SMS_NT_INVENTORY_FILE_COLLECTOR and all its files remain on the computer, but SCM does not consider it an active service. </P>
<P CLASS="t">Deregistering is useful if you want to register SMS_NT_INVENTORY_FILE_COLLECTOR with the SCM under a new account name or password, which you would do if you changed the name or password of the SMS service account. </P>
<H4 CLASS="h3"><A NAME="sec2"></A>Reregistering: POLLREG.EXE</H4><P CLASS="t">POLLREG.EXE reregisters SMS_NT_INVENTORY_FILE_COLLECTOR with SCM on x86-based computers. For Alpha computers, use the procedure provided under Installing: INSTPOLL.EXE. </P>
<H4 CLASS="h3"><A NAME="sec3"></A>Runs On</H4><P CLASS="t">Alpha, x86 </P>
<H4 CLASS="h3"><A NAME="sec4"></A>Files Required  for SMS_NT_INVENTORY_FILE_COLLECTOR </H4><P CLASS="t">INSTPOLL.EXE <BR>INVCOLCL.TXT <BR>POLLINV.EXE <BR>POLLREG.EXE <BR>REMVPOLL.EXE </P>
<H4 CLASS="h3"><A NAME="sec5"></A>Syntax for Installing and Starting SMS_NT_INVENTORY_FILE_COLLECTOR </H4><P CLASS="t"><B>instpoll net start SMS_NT_INVENTORY_FILE_COLLECTOR </B></P>
<H4 CLASS="h3"><A NAME="sec6"></A>Syntax for Deregistering and Reregistering SMS_NT_INVENTORY_FILE_COLLECTOR </H4><P CLASS="t"><B>remvpoll pollreg -serviceacct</B> "<I>account</I>" <B>-password</B> "<I>password</I>" <B>-path</B> "<I>POLLINV_path</I>" </P>
<P CLASS="term1"><B>-serviceacct </B>"<I>account</I>" </P>
<P CLASS="dt1">Specifies the new SMS service account under which SMS_NT_INVENTORY_FILE_COLLECTOR will run. </P>
<P CLASS="term1"><B>-password</B> "<I>password</I>" </P>
<P CLASS="dt1">Specifies the password for account. </P>
<P CLASS="term1"><B>-path</B> "POLLINV_path" </P>
<P CLASS="dt1">Specifies the path for POLLINV.EXE. </P>
<H4 CLASS="h3"><A NAME="sec7"></A>Registry Entries for SMS_NT_INVENTORY_FILE_COLLECTOR </H4><P CLASS="t">A polling interval for SMS_NT_INVENTORY_FILE_COLLECTOR can be specified through the <B>PollInterval </B>in the following registry key:</P>
<P CLASS="t">HKEY_LOCAL_MACHINE\ <BR>    SOFTWARE\ <BR>        Microsoft\ <BR>            SMS\ <BR>                Components\ <BR>                    SMS_NT_INVENTORY_FILE_COLLECTOR </P>
<P CLASS="t"><B>PollInterval</B> is of type REG_DWORD and specifies the polling interval in hours. The default is 24. </P>
<P CLASS="t">Administrator privilege is required to change this value. Changes are not sent to SMS_NT_INVENTORY_FILE_COLLECTOR; changes are picked up at the end of each processing cycle. Therefore, a change in the registry takes effect for the next interval between processing cycles but does not cause the service to wake up and start a new processing cycle. </P>
<H4 CLASS="h3"><A NAME="sec8"></A>INVCOLCL.TXT: the SMS_NT_INVENTORY_FILE_COLLECTOR Initialization File </H4><P CLASS="t">A file containing a list of clients to be processed by SMS_NT_INVENTORY_FILE_COLLECTOR must be located in SMS\SITE.SRV\MAINCFG.BOX\CLIENT.SRC\INVCOLCL.TXT on the SMS site server on which SMS_NT_INVENTORY_FILE_COLLECTOR is run. INVCOLCL.TXT will be copied to all SMS logon servers by Maintenance Manager. </P>
<P CLASS="t">INVCOLCL.TXT contains one client per line. Lines starting with semicolons (;) or pound signs (#) are ignored. The list can be separated into sections. Each section is named for the computer that will collect the inventory from the clients in that section. Section names are surrounded by brackets. For example, consider the following INVCOLCL.TXT: </P>
<P CLASS="t">ClientA<BR>ClientB<BR>[Server1]<BR>ClientC<BR>ClientD<BR>[Server2]<BR>ClientE<BR>[Server3]</P>
<P CLASS="t">The SMS_NT_INVENTORY_FILE_COLLECTOR service running on Server1 collects inventory from ClientA, ClientB, ClientC, and ClientD. </P>
<P CLASS="t">The SMS_NT_INVENTORY_FILE_COLLECTOR service running on Server2 collects inventory from ClientA, ClientB, and ClientE. </P>
<P CLASS="t">The SMS_NT_INVENTORY_FILE_COLLECTOR service running on Server3 collects inventory from ClientA, and ClientB. The section for Server3 is unnecessary.</P></BODY></HTML>
