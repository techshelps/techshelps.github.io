<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RSERVICE.EXE: Service Remote Control</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">RSERVICE.EXE: Service Remote Control</H3><P CLASS="t">RSERVICE controls a service on remote computers. The control options include:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Installing</LI><LI CLASS="ULI1">Removing</LI><LI CLASS="ULI1">Starting</LI><LI CLASS="ULI1">Stopping</LI><LI CLASS="ULI1">Querying</LI><LI CLASS="ULI1">Pausing</LI><LI CLASS="ULI1">Changing the account and password</LI><LI CLASS="ULI1">Verifying the executable file</LI><LI CLASS="ULI1">Sending control codes</LI></UL></SPAN><P CLASS="t">RSERVICE operates on Win32 service programs on one or more computers running Windows&nbsp;NT in a single domain.</P>
<P CLASS="t">The data necessary to control a service must be specified in an initialization file. This data includes information on files and the account needed to install a service, and any arguments needed to start the service. </P>
<H4 CLASS="h3"><A NAME="sec0"></A>Runs On</H4><P CLASS="t">Alpha, x86</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Files Required for RSERVICE</H4><P CLASS="t">RSERVICE.EXE</P>
<H4 CLASS="h3"><A NAME="sec2"></A>RSERVICE Syntax</H4><P CLASS="t"><B>rservice</B> [<B>/install</B>] [<B>/deinstall</B>] [<B>/start</B>] [<B>/stop</B>] [<B>/pause</B>] [<B>/continue</B>] [<B>/query</B>] [<B>/change</B>] [<B>/verify</B>][/<B>sendcode:</B><I>code</I>] [<B>/c</B>] [<B>/l:</B><I>log_file</I>] [<B>/m:</B><I>computer</I>] [<B>/t:</B><I>thread_count</I>] [<B>/v</B>] [<B>/x</B>] <I>init_file</I></P>
<P CLASS="term1"><B>/install</B></P>
<P CLASS="dt1">Installs a service on the specified computers. This includes creating a directory and copying the service's executable files to the computer, if necessary. If the service is already installed, no action is taken. If <B>/install</B> is used, a password is requested at run-time. If <B>/install</B> is used and <B>/x</B> is not used, the user account specified in the [service account] section of the RSERVICE initialization file is added to the Administrators local user group and granted the Log on as a Service User right on each remote computer.</P>
<P CLASS="term1"><B>/deinstall</B></P>
<P CLASS="dt1">Removes a stopped service from the specified computers. This includes deleting the service executable files and removing the directory for a computer, if necessary. If the service is not installed or is not stopped, no action is taken. If the user account specified in the [service account] section of the RSERVICE initialization file was added to the Administrators local user group on the client computer, it is removed from that local group when the <B>/deinstall</B> option is used and the <B>/x</B> option is not used.</P>
<P CLASS="term1"><B>/start</B></P>
<P CLASS="dt1">Starts a stopped service on the specified computers. If the service is already running, no action is taken. If the service is paused it will be un-paused (same as <B>/continue</B>).</P>
<P CLASS="term1"><B>/stop</B></P>
<P CLASS="dt1">Stops a service on the specified computers. If the service is already stopped, no action is taken.</P>
<P CLASS="term1"><B>/pause</B></P>
<P CLASS="dt1">Pauses a service on the specified computers. If the service is not running, no action is taken.</P>
<P CLASS="term1"><B>/continue</B></P>
<P CLASS="dt1">Continues (un-pauses) a service on the specified computers. If the service is not running, no action is taken.</P>
<P CLASS="term1"><B>/query</B></P>
<P CLASS="dt1">Queries the running status of the service on the specified computers. The /query command is also useful for testing the set of computers within the domain included as a result of the information in the initialization file.</P>
<P CLASS="term1"><B>/change</B></P>
<P CLASS="dt1">Allows you to change the password for the service account used by an installed service, or to change to a new service account. </P>
<P CLASS="dt1">Before using the RSERVICE /change command, create the new service account and password, or change the password on the existing account. If you are changing to a different service account, edit the RSERVICE initialization file to change the account specified in the [service account] section. </P>
<P CLASS="dt1">Then, at a time when the service is not being used, stop the service on all computers, change the password and/or service account, and restart the service. These can be done with a single command of the form:</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;rservice /stop /change /start <I>initialization_file</I></P>
<P></P>
<P CLASS="term1"><B>/verify</B></P>
<P CLASS="dt1">Verifies that the executable file and the service image path have not been changed. It is recommended that you run RSERVICE with the <B>/verify</B> option on a regular basis, to guard against attempts to breach security by replacing a secure service. If changes have occurred, one of the following messages will be returned:</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;ALERT: The service registry ImagePath (<I>bad_image_path</I>) for service <I>service_name</I> on machine <I>computer_name </I>is incorrect!</P>
<P></P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;ALERT: Executable file <I>filename</I> for service <I>service_name</I> on machine <I>computer_name</I> is not the correct version!</P>
<P></P>
<P CLASS="term1"><B>/sendcode:</B><I>code</I></P>
<P CLASS="dt1">Sends a control code toa service on the specified computers. Win32 services can be written to handle user-defined control codes in the range 128 to 255.</P>
<P CLASS="term1"><B>/c</B></P>
<P CLASS="dt1">Makes an explicit connection to each computer using the service account before the service commands are executed. This option provides administrator level access to computers by using the service account specified in the initialization file instead of defaulting to the security context of the logged on user. All service commands are executed after the connection is established, and then the connection is deleted. If this option is used, RSERVICE prompts for a password.</P>
<P CLASS="term1"><B>/l:</B><I>log_file</I></P>
<P CLASS="dt1">Specifies a path for an output log file. Trace-level output from RSERVICE is appended to this file.</P>
<P CLASS="term1"><B>/m:</B><I>computer</I></P>
<P CLASS="dt1">Overrides [<B>machine list</B>] in<I> init_file</I>. This option causes the listed or automatically detected computers to be ignored, but all options specified in <I>init_file</I> are still used for <I>computer</I>. This option is useful for testing the information in the initialization file against a single computer before trying an operation on all computers in a domain.</P>
<P CLASS="term1"><B>/t:</B><I>thread_count</I></P>
<P CLASS="dt1">Specifies the maximum number of threads that can be used (the default is 10). Specifying the number of threads gives control over the response versus the system load of RSERVICE, and affects the number of computers operated on concurrently. RSERVICE will use a separate thread for each computer and execute all of the service commands within this thread.</P>
<P CLASS="term1">/<B>v</B></P>
<P CLASS="dt1">Verbose mode. More detailed output is displayed on the screen.</P>
<P CLASS="term1"><B>/x</B></P>
<P CLASS="dt1">Used to modify the /install and /deinstall options. Prevents the user account specified in the [service account] section of the RSERVICE initialization file from being added to or removed from the Administrators local user group on the remote computer. Also prevents the service account from being granted the <B>Log on as a service</B> user right.</P>
<P CLASS="term1"><I>init_file</I></P>
<P CLASS="dt1">Specifies a path to an initialization file (.INI) that defines a set of computers and service parameters. The following sections are required: <B>[domain name]</B>, <B>[service account]</B>, <B>[service name]</B>, <B>[executable file]</B>.</P>
<H4 CLASS="h3"><A NAME="sec3"></A>RSERVICE Initialization File</H4><P CLASS="t">The RSERVICE initialization file consists of sections to specify domain and computer information, service parameters, and installation parameters. The entries in all sections have this format:</P>
<P CLASS="t"><I>Entry</I><B>=</B><I>parameter</I></P>
<H5 CLASS="h4"><A NAME="sec4"></A>[domain name]</H5><P CLASS="t">Entries in this section specify the name of the domain containing the remote computers; RSERVICE requires that all listed computers be members of this domain. Entries in this section have the following forms:</P>
<P CLASS="t"><I>domain_name</I><B>=LISTED<BR></B><I>domain_name</I>=<I>Parameter</I> [,…]</P>
<P CLASS="term1"><B>LISTED</B></P>
<P CLASS="dt1">Specifies that the computers defined for this domain are listed in the [<B>machine list</B>] section; automatic detection of computers is off.</P>
<P CLASS="term1"><I>parameter</I> [,…]</P>
<P CLASS="dt1">A comma-separated list of one or more of the following. Automatic detection of computers is on.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="35pt" VALIGN="TOP"><COL WIDTH="298pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="tt"><B>NTWD</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Specifies that all computers with machine accounts in the domain are included.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>NTSD</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Specifies that all non-domain-controller servers with machine accounts in the domain are included.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>NTPDC</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Specifies that the primary domain controller of this domain is included.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>NTBDC</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Specifies that all backup domain controllers of this domain are included.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H5 CLASS="h4"><A NAME="sec5"></A>[machine list]</H5><P CLASS="t">Entries in this section specify the computers on which the service is to be installed or controlled. Entries in this section have the following forms:</P>
<P><B>computer_name=parameter</B><BR><B>computer_prefix*=parameter</B></P>
<P CLASS="term1"><I>computer_name</I></P>
<P CLASS="dt1">The exact name of a computer in the domain.</P>
<P CLASS="term1"><I>computer_prefix*</I></P>
<P CLASS="dt1">A common prefix found in the names of one or more computers in the domain. The <B>* </B>is a wild-card that matches zero or more additional characters in a computer's name.  This form can only be used with the EXCLUDE parameter.</P>
<P CLASS="term1"><I>parameter</I></P>
<P CLASS="dt1">One of the following:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="50pt" VALIGN="TOP"><COL WIDTH="283pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="tt"><B>INCLUDE</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Specifies that this computer is added to the list. <B>INCLUDE</B> is required for a computer to be managed when automatic detection is off. <B>INCLUDE</B> cannot be used with <I>computer_prefix</I>.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>EXCLUDE</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Specifies that this computer, or any matching computers, are excluded from the list, even if automatic detection is on.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H5 CLASS="h4"><A NAME="sec6"></A>[service account]</H5><P CLASS="t">Entries in this section specify a service account to be used. Entries in this section have the following forms:</P>
<P><B>*=</B><I>domain</I><B>\</B><I>account</I><BR><B>*=</B><I>account</I></P>
<P CLASS="term1"><I>domain</I></P>
<P CLASS="dt1">The name of the local or trusted domain where <I>account</I> exists.</P>
<P CLASS="term1"><I>account</I></P>
<P CLASS="dt1">An account with administrator access. This account is granted the <B>Log on as a Service</B> user right and added to the Administrators local user group by RSERVICE for each computer.</P>
<H5 CLASS="h4"><A NAME="sec7"></A>[service name]</H5><P CLASS="t">The entry in this section specifies the name of the service to be remotely managed. This entry has the following form:</P>
<P><B>*=</B><I>service_name</I></P>
<P CLASS="term1"><I>service_name</I></P>
<P CLASS="dt1">The name of the service. This name is used for both the system name and the display name if the service is installed by RSERVICE. If the service is installed by another method, then this name must be the system name of the service.</P>
<P CLASS="dt1">The service name must be identical to that which Service Control Manager uses to identify the service, not the display name.</P>
<H5 CLASS="h4"><A NAME="sec8"></A>[executable file]</H5><P CLASS="t">Entries in this section specify the executable file of the service specified in the<B> </B>[<B>service name</B>]<B> </B>section. Entries in this section have the following form:</P>
<P><I>computer_name</I><B>=</B><I>executable_filename</I><BR><I>computer</I>_prefix<B>*=</B><I>executable_filename</I><BR><B>*=</B><I>executable_filename</I></P>
<P CLASS="term1"><I>computer_name</I></P>
<P CLASS="dt1">The exact name of a computer in the domain.</P>
<P CLASS="term1"><I>computer_prefix*</I></P>
<P CLASS="dt1">A common prefix found in the names of one or more computers in the domain. The <B>* </B>is a wild-card that matches zero or more additional characters in a computer's name. When entries match more than one computer name, the parameter for the first match is used.</P>
<P CLASS="term1"><B><I>*</I></B></P>
<P CLASS="dt1">All computers not specified by <I>computer_name</I> or matched by <I>computer_prefix</I><B>*</B><I>.</I></P>
<P CLASS="term1"><B><I>executable_filename</I></B></P>
<P CLASS="dt1">The name of the executable file for the service.<I> Executable_filename</I> cannot include a directory path; only the filename and extension are allowed; for example, SERVICE_NAME.EXE.</P>
<H5 CLASS="h4"><A NAME="sec9"></A>[installation directory]</H5><P CLASS="t">Entries in this section specify the directory in which the executable file specified in the<B> </B>[<B>executable file</B>]<B> </B>section and the files specified in the [<B>other files</B>] section will be installed. Entries in this section have the following form:</P>
<P><I>computer_name</I><B>=</B><I>drive</I><B>:\</B> <I>path</I><BR><I>computer_prefix</I><B>*=</B><I>drive</I><B>:\</B> <I>path</I><BR><B>*=</B><I>drive</I><B>:\</B> <I>path</I></P>
<P><B></B></P>
<P CLASS="term1"><I>computer_name</I></P>
<P CLASS="dt1">The exact name of a computer in the domain.</P>
<P CLASS="term1"><I>computer_prefix*</I></P>
<P CLASS="dt1">A common prefix found in the names of one or more computers in the domain. The <B>* </B>is a wild-card that matches zero or more additional characters in a computer's name. When entries match more than one computer name, the parameter for the first match is used.</P>
<P CLASS="term1"><B>*</B></P>
<P CLASS="dt1">All computers not specified by <I>computer_name</I> or matched by <I>computer_prefix</I><B>*</B><I>.</I></P>
<P CLASS="term1"><I>drive</I><B><I>:\</I></B><I>path</I></P>
<P CLASS="dt1">A path to the directory for the services. This path must be a drive letter path (for example, <B>c:\rservice</B>). If this directory does not exist, it is created if the service is being installed, and any access permissions specified in the [<B>access permissions</B>] section are set on the new directory. The files then inherit permissions from the directory.</P>
<H5 CLASS="h4"><A NAME="sec10"></A>[other files]</H5><P CLASS="t">Entries in this section specify other files that are to be copied when the service is installed. For example, you may want to copy .DLL files required by the service, as well as the executable file specified in the [executable file] section. </P>
<P CLASS="t">All the files listed in this section are removed when the <B>RSERVICE /deinstall</B> command is used to remove the service.</P>
<P CLASS="t">Entries in this section have the following form:</P>
<P><I>computer_name</I>=<I>file</I>[:<I>drive</I>:\<I>path</I>] [<I>file</I>[:<I>drive</I>:\<I>path</I>] ...]</P>
<P><I>computer_prefix*</I>=<I>file</I>[:<I>drive:\path</I>] [<I>file</I>[:<I>drive:\path</I>] ...]</P>
<P><I>*</I>=<I>file</I>[:<I>drive:\path</I>] [<I>file</I>[:<I>drive:\path</I>] ...]</P>
<P></P>
<P CLASS="t">where</P>
<P CLASS="term1"><I>computer_name</I></P>
<P CLASS="dt1">Is the exact name of a computer in the domain.</P>
<P CLASS="term1"><I>computer_prefix*</I></P>
<P CLASS="dt1">Is a common prefix found in the names of one or more computers in the domain. The <B>* </B>is a wild-card that matches zero or more additional characters in a computer's name. When entries match more than one computer name, the parameter for the first match is used.</P>
<P CLASS="term1"><B><I>*</I></B></P>
<P CLASS="dt1">Specifies all computers not specified by <I>computer_name</I> or matched by <I>computer_prefix</I><B>*</B><I>.</I></P>
<P CLASS="term1"><I>file</I></P>
<P CLASS="dt1">Specifies the name of the file in the source directory that is to be copied.</P>
<P CLASS="term1"><I>drive</I>:\<I>path</I></P>
<P CLASS="dt1">Specifies the directory on the remote computer to which the file should be copied. By default, files are copied to the directory specified in the [installation directory] section. </P>
<P CLASS="dt1"><B>Note   </B>To copy the file into the SYSTEM32 directory, use <B>%SystemRoot%</B> instead of <B><I>drive</I></B><B>:\</B><B><I>path</I></B>.</P>
<P CLASS="dt1">For example:</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;*=xyz.dll qrt.dll abc.dll:c:\newservices\support </P>
<P></P>
<P CLASS="dt1">In this example, the files XYZ.DLL and QRT.DLL are copied from the source directory to the installation directory, and the file ABC.DLL is copied from the source directory to c:\newservices\support.</P>
<H5 CLASS="h4"><A NAME="sec11"></A>[startup parameters]</H5><P CLASS="t">Entries in this section specify the startup parameters (arguments) for the specified computers. Entries in this section have the following form:</P>
<P><I>computer_name</I><B>=</B> <I>parameter</I> […]<BR><I>computer_prefix</I><B>*=</B> <I>parameter</I> […]<BR><B>*=</B><I>parameter</I> […]</P>
<P><B></B></P>
<P CLASS="term1"><I>computer_name</I></P>
<P CLASS="dt1">The exact name of a computer in the domain.</P>
<P CLASS="term1"><I>computer_prefix*</I></P>
<P CLASS="dt1">A common prefix found in the names of one or more computers in the domain. The <B>* </B>is a wild-card that matches zero or more additional characters in a computer's name. When entries match more than one computer name, the parameter for the first match is used.</P>
<P CLASS="term1"><B><I>*</I></B></P>
<P CLASS="dt1">All computers not specified by <I>computer_name</I> or matched by <I>computer_prefix</I><B>*</B><I>.</I></P>
<P CLASS="term1"><I>parameter</I> […]</P>
<P CLASS="dt1">One or more service startup parameters separated by spaces. If a startup parameter includes embedded spaces, then the parameter must be surrounded by double quotes (for example, <B>"parameter with space"</B>). A parameter may also include a system environment variable, specified as %<I>variable_name</I>%, which is expanded to the computer-specific value when the service is started.</P>
<H5 CLASS="h4"><A NAME="sec12"></A>[automatic start]</H5><P CLASS="t">Entries in this section specify whether the service should start each time the computer is started. Entries in this section have the following form:</P>
<P><I>computer_name</I><B>=</B><I>parameter</I><BR><I>computer_prefix</I><B>*=</B><I>parameter</I><BR><B>*=</B><I>parameter</I></P>
<P><B></B></P>
<P CLASS="t">where </P>
<P CLASS="term1"><I>computer_name</I></P>
<P CLASS="dt1">Is the exact name of a computer in the domain.</P>
<P CLASS="term1"><I>computer_prefix*</I></P>
<P CLASS="dt1">Is a common prefix found in the names of one or more computers in the domain. The <B>* </B>is a wild-card that matches zero or more additional characters in a computer's name. When entries match more than one computer name, the parameter for the first match is used.</P>
<P CLASS="term1"><B><I>*</I></B></P>
<P CLASS="dt1">Specifies all computers not specified by <I>computer_name</I> or matched by <I>computer_prefix</I><B>*</B><I>.</I></P>
<P CLASS="term1"><I>parameter</I></P>
<P CLASS="dt1">Can be either of the following:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="50pt" VALIGN="TOP"><COL WIDTH="283pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="tt"><B>YES</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Specifies that the service is to be installed on this computer with a startup type of Automatic.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>NO</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Specifies that the service is to be installed on this computer with a startup type of Manual. The default value is <B>NO</B>.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><H5 CLASS="h4"><A NAME="sec13"></A>[access permissions]</H5><P CLASS="t">Entries in this section specify the access permissions granted to the installation directory specified in the [installation directory] section and the files specified in the [executable files] and [other files] sections. Entries in this section must be in one of the following forms:</P>
<P><I>computer_name</I><B>=</B> <I>user_group</I><B>:</B><I>access</I> [<I>user_group</I><B>:</B><I>access</I> …]<BR><I>computer_prefix</I><B>*=</B> <I>user_group</I><B>:</B><I>access</I> [<I>user_group</I><B>:</B><I>access</I> …]<BR><B>*=</B> <I>user_group</I><B>:</B><I>access</I> [<I>user_group</I><B>:</B><I>access</I> …]</P>
<P></P>
<P CLASS="t">where</P>
<P CLASS="term1"><I>computer_name</I></P>
<P CLASS="dt1">Is the exact name of a computer in the domain.</P>
<P CLASS="term1"><I>computer_prefix*</I></P>
<P CLASS="dt1">Is a common prefix found in the names of one or more computers in the domain. The <B>* </B>is a wild-card that matches zero or more additional characters in a computer's name. When entries match more than one computer name, the parameter for the first match is used.</P>
<P CLASS="term1"><B><I>*</I></B></P>
<P CLASS="dt1">Specifies all computers not specified by <I>computer_name</I> or matched by <I>computer_prefix</I><B>*</B><I>.</I></P>
<P CLASS="term1"><I>user_group</I></P>
<P CLASS="dt1">Is a user group name or user account. If this user group name or account is in a trusted domain then the name must be specified as <I>domain</I><B>\</B><I>user_group </I>or <I>domain</I><B>\</B><I>account.</I> If a user group or account name includes embedded spaces then the entire parameter must be surrounded by double quotes (e.g., "Backup Operators:READ".)</P>
<P CLASS="term1"><I>access</I></P>
<P CLASS="dt1">Specifies the directory and file access restriction for the <I>user_group</I> as one of the following:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="50pt" VALIGN="TOP"><COL WIDTH="283pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="tt"><B>FULL</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">All access.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>CHANGE</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Read, Write, Execute, and Delete access.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>READ</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">Read access only.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="dt1">For example:</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;[access permissions]</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;*=Administrators:READ "PrimoDomain\Domain Admins:FULL"</P>
<P></P>
<P CLASS="dt1">In this example, members of the Administrators local group on the client computer are granted read permissions, and the domain administrators for the domain PrimoDomain are granted full privileges, on the installation directory and the files installed with this initialization file.</P>
<H5 CLASS="h4"><A NAME="sec14"></A>[registry settings]</H5><P CLASS="t">This section specifies Registry settings to be made during installation of the service. You can specify multiple settings by including multiple entries in this section.</P>
<P CLASS="t"><B>Note   </B>The Registry settings are not changed when the service is removed using the <B>RSERVICE \deinstall</B> command. </P>
<P CLASS="t">Entries in this section have the following form:</P>
<P><I>computer_name</I><B>=</B><I> </I><B>key:</B><I>registry_path</I> [<I>type</I>:<I>name</I>=<I>value</I> ...] [<B>key:</B><I>registry_path</I> [<I>type</I>:<I>name</I>=<I>value</I> ...] ...]<BR><I>computer_prefix</I><B>*=</B><I> </I><B>key:</B><I>registry_path</I> [<I>type</I>:<I>name</I>=<I>value</I> ...] [<B>key:</B><I>registry_path</I> [<I>type</I>:<I>name</I>=<I>value</I> ...] ...]<BR><B>*= key:</B><I>registry_path</I> [<I>type</I>:<I>name</I>=<I>value</I> ...] [<B>key:</B><I>registry_path</I> [<I>type</I>:<I>name</I>=<I>value</I> ...] ...]</P>
<P></P>
<P CLASS="t">where</P>
<P CLASS="term1"><I>computer_name</I></P>
<P CLASS="dt1">Specifies either the name of a specific computer to receive this change to the Registry, or an asterisk (*) to specify that all computers will receive this change to the Registry.</P>
<P CLASS="term1"><I>registry_path</I></P>
<P CLASS="dt1">Specifies the registry path to an existing key or a key to be created, for example</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;HKLM\Software\Microsoft\SMS\TRACING</P>
<P></P>
<P CLASS="dt1">The following abbreviations are allowed for the root of the path:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="50pt" VALIGN="TOP"><COL WIDTH="283pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="tt"><B>HKLM</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">HKEY_LOCAL_MACHINE</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>HKU</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">HKEY_USERS</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt"><B>HKCR</B></P></TD><TD VALIGN="TOP"><P CLASS="tt">HKEY_CLASSES_ROOT</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="term1"><I>type</I></P>
<P CLASS="dt1">Specifies the data type for an existing registry entry. RSERVICE recognizes the data types <B>DWORD</B>, <B>SZ</B>, and <B>EXPAND_SZ</B>.</P>
<P CLASS="term1"><I>name</I></P>
<P CLASS="dt1">Specifies the name of the Registry entry.</P>
<P CLASS="term1"><I>value</I></P>
<P CLASS="dt1">Specifies the value of the Registry entry.</P>
<H5 CLASS="h4"><A NAME="sec15"></A>[source directory]</H5><P CLASS="t">Entries in this section specify the directory from which the executable files specified in the<B> </B>[<B>executable file</B>]<B> </B>and [<B>other files</B>] sections will be copied. Entries in this section have the following form:</P>
<P>computer_name<B>=</B>drive<B>:\</B> path<BR>computer_prefix<B>*=</B>drive<B>:\</B> path<BR><B>*=</B>drive<B>:\</B> path</P>
<P></P>
<P CLASS="term1"><I>computer_name</I></P>
<P CLASS="lt1">The exact name of a computer in the domain.</P>
<P CLASS="term1"><I>computer_prefix*</I></P>
<P CLASS="dt1">A common prefix found in the names of one or more computers in the domain. The <B>* </B>is a wild-card that matches zero or more additional characters in a computer's name.</P>
<P CLASS="term1"><B><I>*</I></B></P>
<P CLASS="dt1">All computers not specified by <I>computer_name</I> or matched by <I>computer_prefix</I><B>*</B><I>.</I></P>
<P CLASS="term1"><I>drive</I><B><I>:\</I></B><I>[path]</I></P>
<P CLASS="dt1">A path to the directory containing the service executable files.</P>
<H4 CLASS="h3"><A NAME="sec16"></A>Example RSERVICE Initialization File</H4><P>[domain name]</P>
<P>engrdomain=listed</P>
<P></P>
<P>[machine list]</P>
<P>engrlab1=include</P>
<P>engrmary=include</P>
<P>engrjohn=include</P>
<P>station87=include</P>
<P></P>
<P>[service account]</P>
<P>*=masterdom\smsadmacct</P>
<P></P>
<P>[service name]</P>
<P>*=SMS_INVENTORY_AGENT_NT</P>
<P></P>
<P>[executable file]</P>
<P>*=invwin32.exe</P>
<P></P>
<P>[installation directory]</P>
<P>station87=d:\smsdir</P>
<P>engrlab*=e:\smsdir</P>
<P>*=c:\smsdir</P>
<P></P>
<P>[startup parameters]</P>
<P>engrmary=/L:\\smsengr02\sms_shr\ /T0</P>
<P>engrjohn=/L:\\smsengr03\sms_shr\ /T0</P>
<P>*=/L:\\smsengr01\sms_shr\ /T0</P>
<P></P>
<P>[source directory]</P>
<P>*=c:\smstest\rservice</P>
<P></P>
<P>[other files]</P>
<P>*=smsengr.dll</P>
<P></P>
<P>[access permissions]</P>
<P>*=Administrators:READ " masterdom\Domain Admins:FULL"</P>
<P></P>
<P>[automatic start]</P>
<P>*=yes</P>
<P></P>
<P>[registry settings]</P>
<P>*=key:HKLM\Software\Microsoft\SMS\TRACING DWORD:Enabled=1 key:HKLM\Software\Microsoft\SMS\TRACING\SMS_INVENTORY_AGENT_NT DWORD:Enabled=1 SZ:TraceFilename=c:\rservice\invagent.log</P>
<P></P></BODY></HTML>
