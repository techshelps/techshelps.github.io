<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BREAKFTM.EXE: Mirror Breaker and Restorer</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">BREAKFTM.EXE: Mirror Breaker and Restorer</H3><P CLASS="t">A mirrored system drive causes the Windows&nbsp;NT 4.0 Unattended Upgrade to fail. Therefore, the mirror must be broken before upgrading.</P>
<P CLASS="t">BREAKFTM breaks the system mirror before the Windows NT Server 4.0 upgrade, then recreates the mirror once the upgrade is finished. BREAKFTM has no effect on computers that do not have a system mirror.</P>
<P CLASS="t">Use BREAKFTM only with Windows NT Server 4.0 Unattended Upgrade. To break or create a mirror manually, use Disk Administrator in Administration Tools (Windows NT Server version only). Do not use BREAKFTM while using Disk Administrator.</P>
<P CLASS="t">BREAKFTM can recover mirrors only if they were broken by BREAKFTM. </P>
<P CLASS="t">BREAKFTM can be run either through SMS or directly from a command prompt.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Runs On</H4><P CLASS="t">Alpha, x86</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Files Required for BREAKFTM</H4><P CLASS="t">BREAKFTM.EXE<BR>BREAKFTM.PDF</P>
<H4 CLASS="h3"><A NAME="sec2"></A>BREAKFTM Syntax</H4><P CLASS="t"><B>breakftm</B> [<B>/b</B>] [<B>/r</B>] [<B>/d </B><I>drive_letter</I><B>:</B>]<B> </B>[<B>/sms</B>]</P>
<P CLASS="term1"><B>/b</B></P>
<P CLASS="dt1">Breaks the mirror, then restarts the computer.</P>
<P CLASS="term1"><B>/r</B></P>
<P CLASS="dt1">Restores the mirror, then restarts the computer.</P>
<P CLASS="term1"><B>/d</B><B><I> </I></B><I>drive_letter</I><B>:</B></P>
<P CLASS="dt1">Specifies the drive to break or restore. The default is the system drive.</P>
<P CLASS="term1"><B>/sms</B></P>
<P CLASS="dt1">Use this option when calling BREAKFTM from SMS.</P>
<P CLASS="term1"><B>/?</B></P>
<P CLASS="dt1">Provides a usage statement.</P>
<H4 CLASS="h3"><A NAME="sec3"></A>BREAKFTM Error Correction</H4><P CLASS="t">BREAKFTM creates a hidden file called mirrorbk.dat in the Windows&nbsp;NT system directory; this file contains the original mirror information needed to restore the mirror. If this file is removed, the mirror cannot be restored.</P>
<P CLASS="t">After the mirror is broken and the system is restarted, the system drive appears as a normal partition. The shadow has no drive letter assigned to it, but is visible from Disk Administrator.</P>
<P CLASS="t">If an error occurs while restoring the mirror, the mirror can be reestablished manually through Disk Administrator. To re-create the mirror manually, delete the shadow partition (the partition with no drive letter assigned) and use the free space to re-create the mirror. (See Disk Administrator help for more information.)</P>
<H4 CLASS="h3"><A NAME="sec4"></A>BREAKFTM Output Messages</H4><P CLASS="t"><B>Success No Mirror to Break</B>. The system partition is not a mirror.</P>
<P CLASS="t"><B>Success Mirror Broken</B>. The system mirror was broken successfully.</P>
<P CLASS="t"><B>Success Mirror Recovered</B>. The system mirror was recovered successfully.</P>
<P CLASS="t"><B>Success There Was No Mirror To Recover</B>. The system partition was not a mirror originally.</P>
<P CLASS="t"><B>Usage error in calling breakftm.exe</B>. Usage error in calling breakftm from the command line.</P>
<P CLASS="t"><B>Error occurred while parsing the registry</B>. Could not get the disk information out of the registry key. The disk key in the registry might be corrupt or missing. The mirror was not broken or recovered; do it manually.</P>
<P CLASS="t"><B>Error occurred while parsing the partition table</B>. The information in the partition table was not what was expected. The mirror was not broken or recovered; do it manually.</P>
<P CLASS="t"><B>Drive letter was invalid</B>. The specified drive letter is not valid, or the system drive letter is incorrect. The mirror was not broken.</P>
<P CLASS="t"><B>Unknown registry version</B>. The disk registry key is of a version not recognized by breakftm. Break the mirror manually.</P>
<P CLASS="t"><B>Drive letter was not a mirror or simple partition</B>. The requested drive letter is not associated with a mirrored configuration, possibly indicating that a simple partition is in use.</P>
<P CLASS="t"><B>Mirror was initializing</B>. The mirror could not be broken because it was initializing. Wait for the initialization to complete and retry.</P>
<P CLASS="t"><B>Mirror is unhealthy</B>. The mirror could not be broken because it was unhealthy. See Disk Administrator help for more information.</P>
<P CLASS="t"><B>Could not read mirror data from file mirrorbk.dat</B>. The hidden file mirrorbk.dat is corrupt or missing. The mirror was not recovered; do it manually.</P>
<P CLASS="t"><B>Drive letter does not match drive letter of broken mirror</B>. The system drive letter has changed. It is unsafe to recover the mirror using breakftm; do it manually.</P>
<P CLASS="t"><B>Current partition table does not match stored mirror data</B>. The partition information on the drives has changed after breaking the mirror. It is unsafe to recover the mirror using breakftm; do it manually.</P>
<P CLASS="t"><B>Current registry does not match stored mirror data</B>. The partition information in the registry has changed after breaking the mirror or is missing. It is unsafe to recover the mirror using breakftm; do it manually.</P>
<P CLASS="t"><B>Unexpected Win32 error code</B>. An unexpected Win32 error occurred. The mirror was not broken or recovered. You can retry, or do it manually.</P>
<P CLASS="t"><B>Unknown error occurred</B>. The mirror was not broken or recovered. You can retry, or do it manually.</P>
<H4 CLASS="h3"><A NAME="sec5"></A>Using BREAKFTM with SMS</H4><P CLASS="t">There are two setup variations for BREAKFTM in BREAKFTM.PDF: <B>Break System Mirror</B> and <B>Recover System Mirror</B>. Schedule <B>Break System Mirror</B> immediately before a Windows&nbsp;NT Server 4.0 upgrade. Schedule <B>Recover System Mirror</B> immediately after a Windows&nbsp;NT Server 4.0 upgrade. BREAKFTM has no effect on nonmirrored systems, so it can be safely used with any Windows&nbsp;NT Server 4.0 upgrade.</P></BODY></HTML>
