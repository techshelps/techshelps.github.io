<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Unattended Installation of SMS Client</TITLE><BODY BGCOLOR="#FFFFFF">


<H2 CLASS="h1">Unattended Installation of SMS Client</H2><P CLASS="t">SMS client software typically is automatically installed via a logon script when a user logs on from a client computer. You can also install SMS client on a computer running Windows&nbsp;NT Workstation or Windows&nbsp;NT Server without anyone logging on at that computer. This involves using tools from both the Windows&nbsp;NT Server Resource Kit and the BackOffice Resource Kit.</P>
<P CLASS="t">The instructions in this section assume that the SMS logon server to be used by that client is already set up. You will need a licensed copy of both the Windows&nbsp;NT Server Resource Kit and the BackOffice Resource Kit to use the tools described in this section.</P>
<P CLASS="t">The computer that will receive the unattended installation of the SMS client must have the Remote Command Server service (RCMDSVC.EXE) installed. This service is included in the Windows&nbsp;NT Server Resource Kit, and is documented in the on-line Help for that Resource Kit. </P>
<P CLASS="t">If necessary, you can install the Remote Command Server remotely, using the RSERVICE utility. RSERVICE is included with this Resource Kit, and is documented in the on-line Help.</P>
<P CLASS="proch">To install Remote Command Server using RSERVICE</P>
<P CLASS="ls">Create an initialization file to install Remote Command Server. The RSERVICE initialization file contains the name of the domain and information on how to determine the computers where RCMDSVC.EXE is to be installed. This file is an ASCII text file that follows the standard Windows INI file format. Sections in this initialization file are required to give the service name and other information about the service. An example initialization file for Remote Command Server installation is given here for a domain named EC_SALES.</P>
<P CLASS="lt1">[domain name]</P>
<P CLASS="lt1">;specify domain and computers affected by this initialization file</P>
<P CLASS="lt1">;<I>domain_name</I>=<I>parameter</I></P>
<P CLASS="lt1">EC_SALES=NTWD</P>
<P CLASS="lt1"></P>
<P CLASS="lt1">[service account]</P>
<P CLASS="lt1">;specify user account that the service is to use, including domain</P>
<P CLASS="lt1">;*=<I>domain_name</I>\<I>account_name</I></P>
<P CLASS="lt1">*=HQ_MASTER\SMS_RCMD</P>
<P CLASS="lt1"></P>
<P CLASS="lt1">[service name]</P>
<P CLASS="lt1">;specify the service (for PCM service, type exactly as shown)</P>
<P CLASS="lt1">*=Remote Command Server</P>
<P CLASS="lt1"></P>
<P CLASS="lt1">[executable file]</P>
<P CLASS="lt1">;specify the executable file (for PCM service, type exactly as shown)</P>
<P CLASS="lt1">*=RCMDSVC.EXE</P>
<P CLASS="lt1"></P>
<P CLASS="lt1">[installation directory]</P>
<P CLASS="lt1">;specify where the service is to be installed on the destination computers </P>
<P CLASS="lt1">;*=<I>drive</I>:\[<I>path</I>]</P>
<P CLASS="lt1">*=c:\sms_rcmd</P>
<P CLASS="lt1"></P>
<P CLASS="lt1">[source directory]</P>
<P CLASS="lt1">; specify the location of the service executable files on the local computer</P>
<P CLASS="lt1">;*=<I>drive</I>:\[<I>path</I>]</P>
<P CLASS="lt1">*=d:\sms12\site.srv\x86.bin</P>
<P CLASS="lt1">This example initialization file could be used to install the Remote Command Server onto all Windows&nbsp;NT Workstation computers (NTWD) in the EC_SALES domain. You could specify other classes of computers, as follows:</P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="160pt" VALIGN="TOP"><COL WIDTH="172pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">Parameter</P></TD><TD VALIGN="TOP"><P CLASS="th">Computers specified</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">NTWD</P></TD><TD VALIGN="TOP"><P CLASS="tt">all Windows&nbsp;NT Workstation computers</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">NTSD</P></TD><TD VALIGN="TOP"><P CLASS="tt">all stand-alone servers</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">NTPDC</P></TD><TD VALIGN="TOP"><P CLASS="tt">primary domain controller</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">NTBDC</P></TD><TD VALIGN="TOP"><P CLASS="tt">all backup domain controllers</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="lt1">You can install the service on multiple classes of computers by listing the parameters in a comma-separated list. </P>
<P CLASS="ls">Save this initialization file with an appropriate filename; for example, EC_SALES_RCMDSVC.INI.</P>
<P CLASS="ls">Create the user account that is referenced in the [service account] section of the RSERVICE initialization file, if it does not exist already. This account should have admin privileges on the client computers. </P>
<P CLASS="ls">Log on to an SMS site server that has network access to the domain specified in the initialization file.</P>
<P CLASS="ls">Install the Remote Command Server on the computers referenced in the [domain name] section of the initialization file. If you are logged on using the user account you established for RSERVICE, use the following command-line:</P>
<P>RSERVICE /INSTALL initialization_filename</P>
<P></P>
<P CLASS="lt1">If you are logged on using any other user account, use the <B>/c</B> option for the RSERVICE command, as follows:</P>
<P>RSERVICE /INSTALL initialization_filename /c</P>
<P></P>
<P CLASS="lt1">The <B>/c</B> option will cause RSERVICE to prompt you for the password of the account specified in the initialization file. If the <B>/c</B> is not in the command line, RSERVICE will attempt to use the user account from which the RSERVICE command is issued, and you will receive an "Access Denied" message.</P>
<P CLASS="t">Once the Remote Command Server is installed on the target computer, you can use Remote Command (RCMD.EXE), from any computer on the network that has the Windows&nbsp;NT Server Resource Kit installed, to install the SMS client.</P>
<P CLASS="proch">To install the SMS Client using Remote Command</P>
<P CLASS="ls">The target computer should be turned on. For example, you can have users leave their computers on after logging off.</P>
<P CLASS="ls">At any computer on the network that has Windows&nbsp;NT Server Resource Kit installed, type the following command:</P>
<P CLASS="lt1">rcmd \\target_computer</P>
<P CLASS="lt1">where <I>target_computer</I> is the name of the computer on which you want to install the SMS Client.</P>
<P CLASS="lt1">An RCMD console window will open on your screen. Any commands entered in this window are issued for the target computer.</P>
<P CLASS="ls">In the RCMD console window, enter the following command: </P>
<P CLASS="lt1">net use x: \\SMS_logon_server\sms_shr</P>
<P CLASS="lt1">where <I>x</I> is any available drive letter and <I>sms_logon_server</I> is the server that the target computer can use as an SMS logon server. </P>
<P CLASS="ls">In the RCMD console window, enter the following command: </P>
<P CLASS="lt1">run <I>x</I>:\runsms.bat</P>
<P CLASS="lt1">where <I>x</I> is the drive letter used to connect to the SMS logon server in Step 3.</P>
<P CLASS="lt1">Since the RUNSMS.BAT command is effectively issued from the target computer, all the SMS client files are installed on that computer. During this time the RCMD console window will display the words "SYSTEMS MANAGEMENT SERVER."</P>
<P CLASS="ls">Still using the RCMD console window, you may edit c:\SMS.INI on the target computer to set the remote troubleshooting features. </P>
<P CLASS="ls">In the RCMD console window, use the following Windows&nbsp;NT Server Resource Kit command to shut down and restart the target computer:</P>
<P CLASS="lt1">shutdown \\target_computer</P>
<P CLASS="lt1">where <I>target_computer</I> is the computer on which you have just installed the SMS Client.</P>
<P CLASS="t">You can verify that the SMS client software has been installed by looking for the target computer in the SMS inventory. Several variables affect how long it takes for the computer to be added to the inventory, including the service response time set for the SMS server, the network load, the load on the SMS server, and how often the target computer is logged on.</P></BODY></HTML>
