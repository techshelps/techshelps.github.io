<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SKIPINV.EXE: Inventory Skipper</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">SKIPINV.EXE: Inventory Skipper</H3><P CLASS="t">SKIPINV is a small program that can be used to determine whether or not an SMS client needs to do an inventory scan. Normally, before an SMS client can determine if inventory should be taken, it must transfer several large programs across the network from the logon server, and then it must load these programs into local memory. These programs are used to scan for inventory and to verify the client setup; together, they require about 1 MB of disk space. SKIPINV lets clients quickly determine whether inventory should be taken. If SKIPINV indicates that inventory is not needed, then the client can load fewer programs, and the load on the SMS logon servers can be reduced. </P>
<P CLASS="t">When called from a batch file, SKIPINV will return one of the following values:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="285pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="th">Return value</P></TD><TD VALIGN="TOP"><P CLASS="th">Description</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P CLASS="tr"></P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">0 </P></TD><TD VALIGN="TOP"><P CLASS="tt">Inventory scan not needed.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">1</P></TD><TD VALIGN="TOP"><P CLASS="tt">Software inventory scan needed.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">2 </P></TD><TD VALIGN="TOP"><P CLASS="tt">Hardware inventory scan needed.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">11</P></TD><TD VALIGN="TOP"><P CLASS="tt">Error: C:\SMS.INI could not be found.</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">12 </P></TD><TD VALIGN="TOP"><P CLASS="tt">Error: SMS.INI file was found but was invalid or could not be read.</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="t">To avoid loading the inventory programs when inventory is not needed, SKIPINV should be inserted into the SMS batch file that clients run to configure SMS (SMSLS.BAT or RUNSMS.BAT). The batch file should use the return code from SKIPINV to determine whether inventory should be run. See the example below for further details.</P>
<H4 CLASS="h3"><A NAME="sec0"></A>Runs On</H4><P CLASS="t">All supported platforms and operating systems (except for Macintosh).</P>
<H4 CLASS="h3"><A NAME="sec1"></A>Files Required</H4><P CLASS="t">SKIPINV.EXE </P>
<H4 CLASS="h3"><A NAME="sec2"></A>Syntax </H4><P CLASS="t"><B>SKIPINV.EXE</B></P>
<H4 CLASS="h3"><A NAME="sec3"></A>Using SKIPINV</H4><P CLASS="t">If you want to use SKIPINV to skip unneeded inventory scans on all computers, you should place the call to SKIPINV in the SMSLS.BAT or the RUNSMS.BAT file on all SMS logon servers. The batch file should check the return code from SKIPINV to determine whether the program worked, and whether any inventory scans are required. It should check all possible return values, checking the highest values first (since this is how they are processed in the batch file). </P>
<P CLASS="t">The call to SKIPINV should be inserted before one or both of the calls to SETLS. For each supported operating system, there are two calls to SETLS; the first calls the Client Setup code, the second calls the Inventory Agent. You can use SKIPINV to skip all calls to SETLS, or you can skip only the call to the Inventory Agent. </P>
<P CLASS="t"><B>Caution   </B>There are issues associated with skipping the Inventory Agent or the Client Setup code. The Inventory Agent performs many functions, including inventory scans, resyncs, and site or domain moves. The Client Setup code performs component installation, removal, and upgrades, as well as other functions. Therefore, if you use SKIPINV, some or all of these functions may not be called during the logon or RUNSMS process.</P>
<P CLASS="t">The following example shows how SKIPINV might be used in the SMSLS.BAT file. This example skips all calls to SETLS if SKIPINV determines that inventory is not needed. This example uses the existing :START and :END labels, as well as a new label called :NOSKIP. The :END label is not shown in this example because it is near the end of the existing batch file. </P>
<P CLASS="t"><B>Note   </B>You must ensure that the SKIPINV program exists in a directory that can be accessed by the SMS clients. The following example assumes that the SKIPINV program exists in the same directory as the logon script SMSLS.BAT. It uses the %0 syntax to ensure that the SKIPINV program is run from the same directory as the batch file.</P>
<P>REM The following label exists in the standard SMSLS.BAT file</P>
<P>:START</P>
<P></P>
<P>REM The following (new) line calls the SKIPINV program using the</P>
<P>REM %0 syntax; this syntax tells the batch file that the program</P>
<P>REM being called exists in the same directory as the logon script.</P>
<P>%0\..\skipinv.exe</P>
<P></P>
<P>REM The following (new) lines check the return code from SKIPINV.</P>
<P></P>
<P>REM If the return code is 11 or 12, an error has occurred, </P>
<P>REM so we better call SETLS.</P>
<P>if errorlevel 12 goto NOSKIP</P>
<P>if errorlevel 11 goto NOSKIP</P>
<P></P>
<P>REM If the return code is 1 or 2, SKIPINV has determined </P>
<P>REM that an inventory scan is required, so we better call SETLS.</P>
<P>if errorlevel 2 goto NOSKIP</P>
<P>if errorlevel 1 goto NOSKIP</P>
<P></P>
<P>REM If the return code is 0, inventory is not needed,</P>
<P>REM so we will skip the call to SETLS.</P>
<P>if errorlevel 0 goto END</P>
<P></P>
<P>REM You need to add the following label to the batch file</P>
<P>REM immediately following the SKIPINV tests.</P>
<P>:NOSKIP</P>
<P></P>
<P CLASS="t">If you wanted to skip the call to the Inventory Agent only, you would put the SKIPINV logic after the first SETLS call (to the Client Setup code), but before the second SETLS call (to the Inventory Agent). For Windows NT computers, the call to SKIPINV (and the return code tests) would go between these two lines:</P>
<P>setls%SMS_OS% -m:E -i -p:%SMS_BIN%\CLI_NT.EXE   -pa:/p:%%SMS_UNC%%\ -pa:%SMS_VERBOSE% %SMS_VERBOSE%</P>
<P></P>
<P>%0\..\skipinv.exe</P>
<P></P>
<P>REM If SKIPINV returns an 11 or a 12, client setup had problems, </P>
<P>REM so we should clean up and quit.</P>
<P>if errorlevel 12 goto RESTORE</P>
<P>if errorlevel 11 goto RESTORE</P>
<P></P>
<P>REM If SKIPINV returns a 2 or a 1, an inventory scan is required.</P>
<P>if errorlevel 2 goto SCAN</P>
<P>if errorlevel 1 goto SCAN</P>
<P></P>
<P>REM If SKIPINV returns a 0, everything is OK and no scan is needed.</P>
<P>if errorlevel 0 goto RESTORE</P>
<P></P>
<P>:SCAN</P>
<P></P>
<P>setls%SMS_OS% -m:E -i -p:%SMS_BIN%\INVWIN32.EXE -pa:/l:%%SMS_UNC%%\ -pa:/e -pa:/t0 -pa:/i -pa:%SMS_VERBOSE% %SMS_VERBOSE%</P></BODY></HTML>
