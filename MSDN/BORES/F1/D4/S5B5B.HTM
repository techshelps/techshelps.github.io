<HTML><head><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Components of Traps Generated from Windows NT Events</TITLE><BODY BGCOLOR="#FFFFFF">


<H3 CLASS="h2">Components of Traps Generated from Windows&nbsp;NT Events</H3><P CLASS="t">Each SNMP trap created from a Windows&nbsp;NT event includes at least the following nine components.</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Object Identifier</LI><LI CLASS="ULI1">Network Address</LI><LI CLASS="ULI1">Generic trap ID</LI><LI CLASS="ULI1">Specific trap ID</LI><LI CLASS="ULI1">Timestamp</LI><LI CLASS="ULI1">Message</LI><LI CLASS="ULI1">UserName</LI><LI CLASS="ULI1">ComputerName</LI><LI CLASS="ULI1">EventType</LI><LI CLASS="ULI1">EventCategory</LI></UL></SPAN><P CLASS="t">The last five of these components comprise the variable bindings (VarBind) list. If any insertion strings are included in the message, they are added as additional VarBinds. </P>
<P CLASS="term1"><B>Object Identifier (Object ID)</B></P>
<P CLASS="dt1">The Object ID is used in all SNMP traps sent by the Event to Trap Translator. It contains three parts. The first two parts are Microsoft's Enterprise Object ID (1.3.6.1.4.1.311) and a sequence indicating that the traps are sent by the Event to Trap translator (1.4.1). So each Object ID sent by the Event to Trap Translator begins with the sequence </P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;1.3.6.1.4.1.311.1.4.1</P>
<P></P>
<P CLASS="dt1">The remainder of the Object ID is generated from the Event Source as it appears in the Event Viewer—for example "SMS" or "MSSQLServer". The characters from the Event Source string are converted to ASCII values ("SMS" becomes 83 77 83), and this value is preceded by the length of the string (3 in this instance). So, for the string "SMS", the variable portion of the Object ID is 3.83.77.83 and the final Object ID is</P>
<p>&nbsp;&nbsp;&nbsp;&nbsp;1.3.6.1.4.1.311.1.4.1.3.83.77.83</P>
<P></P>
<P CLASS="term1"><B>Network Address</B></P>
<P CLASS="dt1">The IP address of the computer generating the trap.</P>
<P CLASS="term1"><B>Generic trap ID</B></P>
<P CLASS="dt1">For translated Windows&nbsp;NT events, this is always 6, indicating an enterprise-specific trap.</P>
<P CLASS="term1"><B>Specific trap ID</B></P>
<P CLASS="dt1">This is the 32-bit Event ID of the Windows&nbsp;NT Event. </P>
<P CLASS="dt1">Bits 31 and 32 of the 32-bit event ID are the default severity of the error, normally displayed either as an icon representation in the Windows NT Event Log, or as the Type entry when viewing an event in detail. They can be interpreted as follows:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="30pt" VALIGN="TOP"><COL WIDTH="130pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P CLASS="tt">00</P></TD><TD VALIGN="TOP"><P CLASS="tt">Success</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">01</P></TD><TD VALIGN="TOP"><P CLASS="tt">Informational</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">10</P></TD><TD VALIGN="TOP"><P CLASS="tt">Warning</P></TD></TR><TR><TD VALIGN="TOP"><P CLASS="tt">11</P></TD><TD VALIGN="TOP"><P CLASS="tt">Error</P></TD></TR></TBODY></TABLE>
<P CLASS="spacing"><BR></P><P CLASS="dt1">In the Event Viewer, you only see the lower 16 bits of the event ID; the first 16 bits of the specific trap ID are actually the Windows NT event ID displayed within the Windows NT Event Log. To interpret the first 16 bits, you must convert them from hexadecimal to decimal: this gives you the Event ID number. You can then use this to look up the event for that Event ID. </P>
<P CLASS="dt1">You can use ERROR32.EXE, included with this Resource Kit, to display the text of an error message for a specified Windows&nbsp;NT (Win32 subsystem, driver, or service) error code.</P>
<P CLASS="term1"><B>Timestamp</B></P>
<P CLASS="dt1">The time (in hundredths of a second) since the SNMP agent was started.</P>
<P CLASS="term1"><B>Message</B></P>
<P CLASS="dt1">The message component is provided by calling the Win32 API FormatMessage() for the data from the Event Record. It is of SNMP type <I>DisplayString</I>. The message component lists the string associated with the event, with the string substitutions supplied. Any formatting characters, such as new lines and tabs, are also converted. </P>
<P CLASS="dt1">Each insertion string will be included as a separate VarBind. These insertion string VarBinds appear at the end of the trap.</P>
<P CLASS="term1"><B>UserName</B></P>
<P CLASS="dt1">This is the user name of the account from which the event was generated. It is equivalent to the User field in the Event Viewer, and is of SNMP type <I>DisplayString</I>.</P>
<P CLASS="term1"><B>ComputerName</B></P>
<P CLASS="dt1">This is the name of the computer from which the event was generated. It is equivalent to the Computer field in the Event Viewer, and is of SNMP type <I>DisplayString</I>.</P>
<P CLASS="term1"><B>EventType</B></P>
<P CLASS="dt1">This is the classification type of the event by the NT operating system (for example, "Information," "Error," "Warning"). It is equivalent to the Type field in the Event Viewer, and is of SNMP type <I>DisplayString</I>.</P>
<P CLASS="term1"><B>EventCategory</B></P>
<P CLASS="dt1">This is the classification of the event, as defined by the source. It is equivalent to the Category field in the Event Viewer, and is of SNMP type <I>DisplayString</I>.</P></BODY></HTML>
