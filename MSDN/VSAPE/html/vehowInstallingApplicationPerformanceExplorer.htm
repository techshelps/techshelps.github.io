<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing Application Performance Explorer</title>
<style>@import url(msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="msdn_ie3.css">
</HEAD>
<BODY>

<h1><a name="vehowinstallingapplicationperformanceexplorer"></a>Installing Application Performance Explorer</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vehowInstallingApplicationPerformanceExplorer_C">
</object></p>
<p>
To use this release of Application Performance Explorer (APE), you should read each of the following topics to determine which are required for your APE installation.
<ul type=disc>
<li>
Installing Microsoft<sup>®</sup> Transaction Server<br><br></li>
<li>
Installing Microsoft<sup>®</sup> SQL Server™ with Service Pack 3<br><br></li>
<li>
Configuring DCOM Access Permissions Using DCOMCNFG<br><br></li>
<li>
Configuring RA Access Permissions Using RACMGR32</li>
</ul>
<h2>Installing Microsoft Transaction Server</h2>
<p>
You must install Microsoft Transaction Server (MTS) separately on all server machines. This includes standalone workstation configurations where all of APE runs on a single machine. APE MTS scenarios will not run without installing MTS.</p>
<p>
After installing MTS and APE, you must install the APE MTS package on each server machine.</p>
<p class=label>
<b>To install the APE MTS package on each server machine</b>
<ol>
<li>
From the <b>Start</b> menu, point to <b>Programs</b>, <b>Windows NT 4 Option Pack</b>, <b>Microsoft Transaction Server</b>, and then click <b>Transaction Server Explorer</b>.<br><br></li>
<li>
In the left pane, expand the Microsoft Transaction Server folder, the Computers folder, and the <b>MyComputer</b> folder. Right-click the <b>Packages Installed</b> folder, point to <b>New</b>, and then click <b>Package</b>.<br><br></li>
<li>
In the <b>Package Wizard</b> dialog box, click <b>Install pre-built packages</b>.<br><br></li>
<li>
In the <b>Select Package Files</b> dialog box, click <b>Add</b>.<br><br></li>
<li>
In the <b>Install from Package File</b> dialog box, browse to Program Files\Microsoft Visual Studio\Common\Tools\Ape\Aemtssvc.pak, and then click <b>Open</b>.<br><br></li>
<li>
In the <b>Select Package Files</b> dialog box, click <b>Next</b>.<br><br></li>
<li>
In the <b>Set Package Identity</b> dialog box, click <b>Next</b>.<br><br></li>
<li>
In the <b>Installation Options</b> dialog box, click <b>Finish</b>.</li>
</ol>
<h2>Installing Microsoft SQL Server with Service Pack 3</h2>
<p>
If you want to test the performance of MTS scenarios that include Microsoft SQL Server, you must install Microsoft<sup>®</sup> SQL Server 6.5™ and Microsoft SQL Server Service Pack 3.</p>
<p class=label>
<b>To install Microsoft SQL Server 6.5 with Service Pack 3</b>
<ol>
<li>
Run the Microsoft<sup>®</sup> Visual Studio™ Installation Wizard.<br><br></li>
<li>
Click <b>Server Applications and Tools (Add Only)</b>, and then click <b>Next</b>.<br><br></li>
<li>
Click <b>Launch BackOffice Installation Wizard</b>, and then click <b>Install</b>.<br><br></li>
<li>
In the <b>BackOffice Business Solutions</b> dialog box, click <b>Custom</b>, and then click <b>Next</b>.<br><br></li>
<li>
In the <b>Disk Space Requirements</b> dialog box, click <b>Next</b>.<br><br></li>
<li>
In the <b>BackOffice Programs and Their Components</b> dialog box, in the <b>BackOffice Programs</b> list, click <b>SQL Server Developer Edition 6.5</b>, clear check boxes for the other selections, and then click <b>Next</b>.<br><br></li>
<li>
In the <b>Administrator and Service Accounts for BackOffice Programs </b>dialog box, click <b>Assign Accounts</b> to create at least one SQL Server system administrator account name and password, and then click <b>Next</b>.<br><br></li>
<li>
In the <b>Your BackOffice Installation</b> dialog box, click <b>Next</b> and then follow the remaining instructions to install SQL Server 6.5.</li>
</ol>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This installation of SQL Server 6.5 includes Service Pack 3. You do not need to run a separate Service Pack 3 installation process.</p>
<h2>Configuring Access Permissions Using DCOMCNFG</h2>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;This topic applies to your APE installation only if you plan to use DCOM in your APE tests.</p>
<p>
APE can use remote machines to offload service tasks during distributed performance tests. This situation occurs when you test with the following options.
<ul type=disc>
<li>
The <b>Use Remote Application Server</b> check box is selected in the <b>Application Service Connection Options</b> dialog box.<br><br></li>
<li>
A valid machine name is provided in the <b>Server Name</b> field.<br><br></li>
<li>
APE server components have been set up on the named server.<br><br></li>
<li>
A valid user has logged on to Microsoft<sup>®</sup> Windows NT<sup>®</sup> at the named machine.</li>
</ul>
<p>
Before APE can successfully use remote machines in distributed performance tests, you must use the DCOMCNFG utility to configure appropriate access permissions for each of the following APE machine configurations.
<ul type=disc>
<li>
APE Service Manager machine (the main server machine that will host the Queue and Pool Managers).<br><br></li>
<li>
APE Client Manager machine (the machine that the main APE Control Panel UI runs on).<br><br></li>
<li>
APE Remote Client machine (client machines other than the APE Client Manager machine).<br><br></li>
<li>
APE Remote Worker machine (worker machines other than the APE Service Manager machine).</li>
</ul>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;These four APE machine configurations do not necessarily require four separate machines. You could use just two machines.</p>
<p>
For each of the preceding machine configurations, you use DCOMCNFG to perform the following simple steps.
<ol>
<li>
Start the DCOMCNFG utility.<br><br></li>
<li>
Select the machine configuration (APE Service Manager, APE Client Manager, APE Remote Client, or APE Remote Worker) from within the DCOMCNFG application list.<br><br></li>
<li>
Click the <b>Default Properties</b> tab.<br><br></li>
<li>
Select the <b>Enable Distributed COM on this computer</b> check box.<br><br></li>
<li>
In the <b>Default Authentication Level</b> list, select <b>None</b>.<br><br></li>
<li>
In the <b>Default Impersonation Level</b> list, select <b>Identity</b>.<br><br></li>
<li>
Define access and launch permissions for each user of this service.</li>
</ol>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;Each logged-on user of each service that will connect to the APE clients or services must have permission to access all APE components. To define these permissions, use the procedure "To define component access and launch permissions" at the end of this topic.
<ol start=8>
<li>
Click the <b>Applications</b> tab.<br><br></li>
<li>
In the <b>Applications</b> list, select <b>Ape Worker</b>.<br><br></li>
<li>
Click <b>Properties</b>.<br><br></li>
<li>
In the <b>Application Properties</b> dialog box, click the <b>Identity</b> tab.<br><br></li>
<li>
Click <b>The interactive user</b>.<br><br></li>
<li>
Click <b>OK</b>.<br><br></li>
<li>
Select <b>Ape Worker Provider</b> and repeat Steps 10 through 13.<br><br></li>
<li>
Select <b>Ape Queue Manager</b> and repeat Steps 10 through 13.<br><br></li>
<li>
Select <b>Ape Pool Manager</b> and repeat Steps 10 through 13.<br><br></li>
<li>
Select <b>Ape Logger</b> and repeat Steps 10 through 13.<br><br></li>
<li>
Select <b>Ape Server Manager</b> and repeat Steps 10 through 13.</li>
</ol>
<p class=label>
<b>To define component access and launch permissions</b>
<ol>
<li>
Click the <b>Default Security</b> tab.<br><br></li>
<li>
Under <b>Default Access Permissions</b>, click <b>Edit Default</b>.<br><br></li>
<li>
In the <b>Registry Value Permissions</b> dialog box, in the <b>Name</b> list, add each user name that will have access permissions for the APE Service Manager machine.<br><br></li>
<li>
In the <b>Type of Access</b> list, select <b>Allow Access</b> for each user permitted to access components.<br><br></li>
<li>
Under <b>Default Launch Permissions</b>, click <b>Edit Default</b>.<br><br></li>
<li>
In the <b>Registry Value Permissions</b> dialog box, in the <b>Name</b> list, add each user name that will have launch permissions for the APE Service Manager machine.<br><br></li>
<li>
In the <b>Type of Access</b> list, select <b>Allow Launch</b> for each user permitted to launch components.</li>
</ol>
<h2>Configure RA Access Permissions Using RACMGR32</h2>
<p>
After installing APE server components, you need to enable Remote Automation (RA) by completing the following.
<ul type=disc>
<li>
Setting System Security Policy<br><br></li>
<li>
Starting the Automation Manager</li>
</ul>
<h3>Setting System Security Policy</h3>
<p>
You must run the RA Connection Manager utility on each machine that will participate in your APE tests, and set the System Security Policy option to Allow All Remote Creates.</p>
<p class=label>
<b>To set the System Security Policy option</b>
<ol>
<li>
From the <b>Start</b> menu, click <b>Run</b>.<br><br></li>
<li>
Type Racmgr32.exe and click <b>OK</b>.<br><br></li>
<li>
Click the <b>Client Access</b> tab.<br><br></li>
<li>
Click <b>Allow All Remote Creates</b>.<br><br></li>
<li>
Click<b> File</b> and <b>Exit</b>.</li>
</ol>
<h3>Starting the Automation Manager</h3>
<p>
Before starting your APE test session, you must start the Automation Manager on each APE machine. Once Automation Manager is running, subsequent APE tests will run without intervention.</p>
<p class=label>
<b>To start the Automation Manager</b>
<ul type=disc>
<li>
Browse to C:\Winnt\System32\Autmgr32.exe and double-click <b>Autmgr32.exe</b>.</li>
</ul>
</BODY>
</HTML>
