<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Running the Online Catalog Sample Application</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->

<h2><a name="dasdk_onlinecatalogsample_running"></a>Setting Up and Running the Online Catalog Sample Application</h2>
<p>
The Online Catalog Sample Application uses any major web browser for its client piece, IIS as the Web Server, and SQL Server as the database.</p>
<p>
The following sections describe the steps necessary to set up the environment for running the sample application:
<ul type=disc>
<li>
<a href="#dasdk_onlinecatalogsample_hwreq">Hardware Requirements</a><br><br></li>
<li>
<a href="#dasdk_onlinecatalogsample_sqlsetup">Setup SQL Server Database</a><br><br></li>
<li>
<a href="#dasdk_onlinecatalogsample_webserversetup">Load Web Pages onto Server</a><br><br></li>
<li>
<a href="#dasdk_onlinecatalogsample_webserversetup">Setup Web Server</a><br><br></li>
<li>
<a href="#dasdk_onlinecatalogsample_runsample">Run the Sample Application</a><br><br></li>
<li>
<a href="#dasdk_onlinecatalogsample_troubleshooting">Troubleshooting</a></li>
</ul>
<p>
<b>NOTE</b>: These instructions are designed to get the sample applications up and running: they should not be used as a guide to good database practices in a production environment.</p>
<p>
<a name="dasdk_onlinecatalogsample_hwreq"></a>Hardware Requirements You need to verify that you meet the following hardware requirements:
<ul type=disc>
<li>
Server machine with the following software installed and configured:&nbsp; <ul type=disc>
<li>
Windows NT 4.0<br><br></li>
<li>
Windows NT Service Pack 3<br><br></li>
<li>
Internet Information Service 4.0 installed from the NT Option Pack<br><br></li>
<li>
SQL Server 6.5<br><br></li>
<li>
ADO 2.0</li>
</ul>
</li>
<li>
Client machine with a major browser installed (IE 3.0 or 4.0, Netscape 3.0 or 4.0)<p class=atl>
<b>NOTE</b>: The SQL Server and Web Server will exist on the same machine, even though in a production environment exposed to the Internet you would probably have your SQL Server on a separate machine behind a fire wall.</p></li>
</ul>
<h3><a name="dasdk_onlinecatalogsample_sqlsetup"></a>Setup SQL Server Database</h3>
<p>
This section outlines how to run the self-extracting DBSetup.exe file and the commands used to create the physical directories for your database, the database itself, the tables and stored procedures, and then loads the domain table data.</p>
<p class=atl>
<b>NOTE</b>: The MDAC SDK installs two self-extracting exe files used to setup an SQL Server database and an IIS server with the files necessary to run this sample. When you run these self-extracting exe files, they decompress a set of files into the directory “MDAC Samples” on your C: drive. These files, <b>DBSetup.exe</b> and <b>WebSetup.exe</b>, are located where you installed the MDAC SDK in the <b>Samples\MDAC</b> directory. The default is <b>C:\MSDASDK\Samples\MDAC</b>.</p><p class=atl>
The DBSetup.exe file sets up the SQL Server database. You need to extract this file on the machine running SQL Server, or on the client machine with the SQL Server client software installed.</p><p class=atl>
The Websetup.exe file sets up the IIS server with the sample web files. You need to run this file on the system running the IIS server.</p><p class=atl>
If the machine running either SQL Server or the IIS server is different than the machine you installed the MDAC SDK on, simply copy the appropriate exe to that machine. </p><ol>
<li>
If needed, copy the file DBSetup.exe to the machine running SQL Server, or a machine that has the client SQL Server software installed.<br><br></li>
<li>
Run the DBSetup.exe file. The program will extract the database setup files to the directory “C:\MDAC Samples\Database”  In addition, the program creates several subdirectories underneath this directory. You can remove these files and subdirectories after the database has been setup.<br><br></li>
<li>
Open an MS DOS window and change to the directory where you extracted the database setup files. Change to the bat subdirectory under “C:\MDAC Samples\Database”. This directory contains all the batch files to run. These batch files use the following parameters:<ul type=disc>
<li>
<i>ServerName</i> specifies the server name<br><br></li>
<li>
<i>AdminUserID</i> specifies the administrative user id <p class=tl>
This is typically “sa” or a user id with administrative privileges.</P></li>
<li>
<i>Password</i> specifies the user password</li>
</ul>
</li>
<li>
Create the database devices by entering the following in the MS DOS window:<pre><code>makedev <i>ServerName</i> <i>AdminUserID</i> <i>Password</i>
</code></pre>
<p class=tl>
Two acknowledgement messages appear:&nbsp; Data device created, and Log device created. If you get the following error message: “The name specified is not recognized as an internal or external command, operable program or batch file”, it could mean that SQL Server, or the client software, is not installed propertly on your system. In order to complete properly, the SQL Server software ISQL.EXE must be available on the system. </P><p class=tl>
This step creates the directory <b>MDACsql</b> off the root <b>c:\driver</b> with the subdirectories <b>data</b> and <b>logs</b>. The data device is 10 mg in size, the logs device is 5 meg.</P><p class=tl>
Any errors encountered are added to a log report. You can identify these files by the <b>.LOG</b> extension with the same name as the command used (in this case MAKEDEV.LOG).&nbsp; Check this file to see if any errors occurred.</P><p class=atl>
<b>NOTE</b>: If you want to create these devices somewhere else, you need to modify the <b>makedev.sql</b> file. Search for "@vc_device_UNC" which defines the paths of the devices.</p></li>
<li>
Create the database by entering the following in the MS DOS window:<pre><code>createdb <i>ServerName</i> <i>AdminUserID</i> <i>Password</i>
</code></pre>
<p class=tl>
Several acknowledgement messages appear. Check CREATEDB.LOG for any errors.</P></li>
<li>
Set up the contents of the database by entering the following in the MS DOS window:<pre><code>setupdb <i>ServerName</i> <i>AdminUserID</i> <i>Password</i>
</code></pre>
<p class=tl>
This step does the following:</P><ul type=disc>
<li>
Creates the tables and should complete with no messages or errors<br><br></li>
<li>
Creates the stored procedures and should complete with “Creating stored Procedures” message and no errors<br><br></li>
<li>
Creates database logons and users with their permissions set, and should complete with several acknowledgement messages, and no errors<br><br></li>
<li>
Loads tables with data and should complete with several acknowledgement messages, and no errors</li>
</ul>
</li>
</ol>
<h3><a name="dasdk_onlinecatalogsample_webserversetup"></a>Web Server Setup</h3>
<p>
This section outlines how to run the self-extracting <b>Websetup.exe</b> file to extract the sample web pages, and how to set up your IIS Web server to run the samples.
<ol>
<li>
If needed, copy the file WebSetup.exe to the machine running your IIS 4.0 server.<br><br></li>
<li>
Run the WebSetup.exe file. The program will extract the web pages to the directory “C:\MDAC Samples\OnlineCatalog”.&nbsp; After they are extracted, if you wish to move them to a different directory, you can simple copy the directory elsewhere.<br><br></li>
<li>
Start Internet Service Manager (<b>Start -&gt; NT 4.0 Option Pack -&gt; Microsoft Internet Information Server -&gt; Internet Service Manager</b>).<br><br></li>
<li>
In the window that appears, click on the <b>Internet Information Server</b> node to open it.<br><br></li>
<li>
Click on the [Server Name] node to open it.<br><br></li>
<li>
Enable Anonymous Access:<ol>
<li>
Right-click on <b>Default Web Site</b> and select <b>Properties</b>.<br><br></li>
<li>
Click the <b>Directory Security</b> tab in the dialog box.<br><br></li>
<li>
Click the <b>Edit</b> button in the <b>Anonymous Access and Authentication Control</b> panel.<br><br></li>
<li>
Click on the <b>Allow</b> <b>Anonymous Access</b> check box, then click the <b>OK</b> button.<br><br></li>
<li>
Click the <b>OK</b> button to exit the <b>Properties </b>dialog Box.</li>
</ol>
</li>
<li>
Set the virtual directories for the sample Order Entry application:<ol>
<li>
Right-click on <b>Default Web Site</b> -&gt; <b>New</b> -&gt; <b>Virtual Directory</b>.<br><br></li>
<li>
In the <b>Alias to be used to access virtual directory</b> text box, enter:<pre><code>OnlineCatalog
</code></pre>
<p class=tl>
Click the <b>Next</b> button.</P></li>
<li>
Enter the physical path where the extracted files reside.&nbsp; The extract program places them in “C:\MDAC Samples\OnlineCatalog”.&nbsp; If you copied them elsewhere, specify the new location.&nbsp; Or you can find and select it by clicking the <b>Browse</b> button, and click <b>NEXT</b>.<br><br></li>
<li>
Click on the <b>Allow Access</b> check boxes for <b>Read</b>, <b>Script</b>, and <b>Execute</b> permission. Click the <b>Finish</b> button.</li>
</ol>
</li>
<li>
Set the Default Document:<ol>
<li>
Right-click on <b>Default Web Site</b> and select <b>Properties</b>.<br><br></li>
<li>
Click the <b>Document</b> tab in the dialog box.<br><br></li>
<li>
Click on the <b>Enable Default Document</b> check box. Click the Add Button and enter Default.asp (if not already present). Click the <b>OK</b> button.</li>
</ol>
</li>
<li>
Restart the W3 Service:<ol>
<li>
Select <b>Default Web Site</b>.<br><br></li>
<li>
Click the <b>Stop</b> icon (the black square in the tool bar).<br><br></li>
<li>
When the Service stops, the black square is no longer bold, click on the <b>Start</b> icon, (the triangle).</li>
</ol>
</li>
</ol>
<h3><a name="dasdk_onlinecatalogsample_runsample"></a>Run the Sample App</h3>
<p>
To run the application, start up your browser and type in the following:</p>
<pre><code>http://<i>ServerName</i>/OnlineCatalog
</code></pre>
<p>
The Sample Application's homepage appears. All the Domain tables have data entered, except for Customers and Orders. You can now start browsing the Catalog, entering Customer Profile information, making Orders, and checking Order Status.</p>
<h3><a name="dasdk_onlinecatalogsample_troubleshooting"></a>Troubleshooting</h3>
<p>
You may want to undo the installation for any number of reasons: insufficient disk space, changing path names, or interrupted installation.&nbsp; In all cases, follow the steps below.&nbsp; Since you may be backing out an incomplete install, start with the last step that you got to.
<ol>
<li>
Using the Microsoft Management Console, delete the OnlineCatalog virtual directory under the “Default Web Site Node”.<br><br></li>
<li>
Using the Microsoft Management Console, stop the Web Service and restart it again:&nbsp; this will release any hold the IIS Server had on the file system directories and files where the web pages reside;<br><br></li>
<li>
Start Enterprise Manager (<b>Start -&gt; Programs -&gt; SQL Server 6.5 -&gt; Eneterprise Manager</b>). <br><br></li>
<li>
Open the appropriate server by clicking on its name.<br><br></li>
<li>
Delete the Sample database:<ol>
<li>
Open the Databases node by clicking on it.<br><br></li>
<li>
Right click on it, and click <b>Refresh</b><br><br></li>
<li>
Delete the database by right clicking on the database name (MDAC20Samples), and selecting <b>Delete</b>.</li>
</ol>
</li>
<li>
Delete the database logical devices:<ol>
<li>
Open the Database Devices node.<br><br></li>
<li>
Right click on the Database Devises tab and select <b>Refresh</b>. If the <b>ADO20Samples_log1</b> file or <b>ADO20Samples_data1</b> file exists, select and delete them.</li>
</ol>
</li>
<li>
Delete the physical files that make up the Database Devices by starting Windows NT Explorer and deleting c:\MDACsql. This deletes the data and logs subdirectories.<br><br></li>
<li>
Delete the sample logon:<ol>
<li>
Open the Logins node by clicking on it.<br><br></li>
<li>
Right-click <b>SampleUser</b> and select <b>Drop</b>.</li>
</ol>
</li>
<li>
Delete the directory “C:\MDAC Samples\Database”. Do likewise with the web pages directory “C:\MDAC Samples\OnlineCatalog” (make sure any DOS boxes that might be referencing these directories are closed.&nbsp; This deletes all scripts decompressed from the exe files.</li>
</ol>
<p>
You are now ready to make any needed changes to the scripts (device or directory names, etc), and repeat the install process. </p>
</font></BODY>
</HTML>
