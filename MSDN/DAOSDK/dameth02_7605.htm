<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CompactDatabase Method (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvmthcompactdatabase"></a>CompactDatabase Method</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthCompactDatabaseC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthCompactDatabaseX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthCompactDatabaseA">
</object></p>
<p>
Copies and compacts a closed database, and gives you the option of changing its version, collating order, and encryption. (<a href="daglos02_60it.htm">Microsoft Jet workspaces</a> only).</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>VOIDCompactDatabase(LPCTSTR </b><i>pstrOldDatabase</i><b>,</b></p>
<p>
<b>LPCTSTR </b><i>pstrNewDatabase</i><b>,</b></p>
<p>
<b>LPCTSTR </b><i>pstrDstConnect</i><b> = NULL,</b></p>
<p>
<b>LONG </b><i>lOptions</i><b> = -1,</b></p>
<p>
<b>LPCTSTR </b><i>pstrSrcConnect</i><b> = NULL);</b></p>
<p class=label>
<b>Parameters</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=20%><b>Type</b></td>
<td class=label width=31%><b>Argument</b></td>
<td class=label width=49%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=20%><b>LPCTSTR</b></td>
<td width=31%><i>pstrOldDatabase</i></td>
<td width=49%>A pointer to a string that identifies an existing, closed database. It can be a full path and file name, such as "C:\db1.mdb". If the file name has an extension, you must specify it. If your network supports it, you can also specify a network path, such as "\\server1\share1\dir1\db1.mdb".</td>
</tr>
<tr valign=top>
<td width=20%><b>LPCTSTR</b></td>
<td width=31%><i>pstrNewDatabase</i></td>
<td width=49%>A pointer to a string that is the file name (and path) of the compacted database that you are creating. You can also specify a network path. You can't use the <i>pstrNewDatabase</i> argument to specify the same database file as <i>pstrOldDatabase</i>.</td>
</tr>
<tr valign=top>
<td width=20%><b>LPCTSTR</b></td>
<td width=31%><i>pstrDstConnect</i></td>
<td width=49%>Optional. A pointer to a string composed of zero or more parameters separated by semicolons. This parameter is used to pass additional information to the destination database as needed. For example, collating order is specified here.</td>
</tr>
<tr valign=top>
<td width=20%><b>LONG</b></td>
<td width=31%><i>Ioptions</i></td>
<td width=49%>Optional. A constant or combination of constants that indicates one or more options. The options specify the version of its data format and whether the new compacted database should be encrypted.</td>
</tr>
<tr valign=top>
<td width=20%><b>LPCTSTR</b></td>
<td width=31%><i>pstrSrcConnect</i></td>
<td width=49%>Optional. A pointer to a string composed of zero or more parameters separated by semicolons. This parameter is used to pass additional information from the source as needed.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
You can concatenate one of the following constants in the <i>pstrDstConnect</i> argument to specify the <b>CollatingOrder</b> for string comparisons of text in the compacted database.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b>Constant</b></td>
<td class=label width=50%><b>Collating order</b></td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangGeneral</b></td>
<td width=50%>English, German, French, Portuguese, Italian, and Modern Spanish</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangArabic</b></td>
<td width=50%>Arabic</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangChineseSimplified</b></td>
<td width=50%>Simplified Chinese</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangChineseTraditional</b></td>
<td width=50%>Traditional Chinese</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangCyrillic</b></td>
<td width=50%>Russian</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangCzech</b></td>
<td width=50%>Czech</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangDutch</b></td>
<td width=50%>Dutch</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangGreek</b></td>
<td width=50%>Greek</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangHebrew</b></td>
<td width=50%>Hebrew</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangHungarian</b></td>
<td width=50%>Hungarian</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangIcelandic</b></td>
<td width=50%>Icelandic</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangJapanese</b></td>
<td width=50%>Japanese</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangKorean</b></td>
<td width=50%>Korean</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangNordic</b></td>
<td width=50%>Nordic languages (Microsoft Jet database engine version 1.0 only)</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangNorwDan</b></td>
<td width=50%>Norwegian and Danish</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangPolish</b></td>
<td width=50%>Polish</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangSlovenian</b></td>
<td width=50%>Slovenian</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangSpanish</b></td>
<td width=50%>Traditional Spanish</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangSwedFin</b></td>
<td width=50%>Swedish and Finnish</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangThai</b></td>
<td width=50%>Thai</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangTurkish</b></td>
<td width=50%>Turkish</td>
</tr>
</table><br>
<p>
You can use one of the following constants in the <i>lOptions</i> argument to specify whether to encrypt or to decrypt the database while it's compacted.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=33%><b>Constant</b></td>
<td class=label width=67%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=33%><b>dbEncrypt</b></td>
<td width=67%>Encrypt the database while compacting.</td>
</tr>
<tr valign=top>
<td width=33%><b>DbDecrypt</b></td>
<td width=67%>Decrypt the database while compacting.</td>
</tr>
</table><br>
<p>
If you omit an encryption constant or if you include both <b>dbDecrypt</b> and <b>dbEncrypt</b>, <i>pstrNewDatabase</i> will have the same encryption as <i>pstrOldDatabase.</i></p>
<p>
You can use one of the following constants in the <i>lOptions</i> argument to specify the version of the data format for the compacted database. This constant affects only the version of the data format of <i>pstrNewDatabase</i> and doesn't affect the version of any Microsoft Access-defined objects, such as forms and reports.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=30%><b>Constant</b></td>
<td class=label width=70%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=30%><b>dbVersion10</b></td>
<td width=70%>Creates a database that uses the <a href="daglos02_0elh.htm">Microsoft Jet database engine</a> version 1.0 file format while compacting.</td>
</tr>
<tr valign=top>
<td width=30%><b>dbVersion11</b></td>
<td width=70%>Creates a database that uses the Microsoft Jet database engine version 1.1 file format while compacting.</td>
</tr>
<tr valign=top>
<td width=30%><b>dbVersion20</b></td>
<td width=70%>Creates a database that uses the Microsoft Jet database engine version 2.0 file format while compacting.</td>
</tr>
<tr valign=top>
<td width=30%><b>dbVersion30</b></td>
<td width=70%>Creates a database that uses the Microsoft Jet database engine version 3.0 file format (compatible with version 3.5) while compacting.</td>
</tr>
</table><br>
<p>
You can specify only one version constant. If you omit a version constant, <i>pstrNewDatabase</i> will have the same version as <i>pstrOldDatabase</i>. You can compact <i>pstrNewDatabase</i> only to a version that is the same or later than that of <i>pstrOldDatabase</i>.</p>
<p class=label>
<b>Remarks</b></p>
<p>
As you change data in a database, the database file can become fragmented and use more disk space than is necessary. Periodically, you can use the <b>CompactDatabase</b> method to compact your database to defragment the database file. The compacted database is usually smaller and often runs faster. You can also change the collating order, the encryption, or the version of the data format while you copy and compact the database.</p>
<p>
You must close <i>pstrOldDatabase</i> before you compact it. In a multiuser environment, other users can't have <i>pstrOldDatabase</i> open while you are compacting it. If <i>pstrOldDatabase</i> isn't closed or isn't available for <a href="daglos02_5wit.htm">exclusive</a> use, an error occurs.</p>
<p>
Because <b>CompactDatabase</b> creates a copy of the database, you must have enough disk space for both the original and the duplicate databases. The compact operation fails if there isn't enough disk space available. The <i>pstrNewDatabase</i> duplicate database doesn't have to be on the same disk as <i>pstrOldDatabase</i>. After successfully compacting a database, you can delete the <i>pstrOldDatabase</i> file and rename the compacted <i>pstrNewDatabase</i> file to the original file name.</p>
<p>
The <b>CompactDatabase</b> method copies all the data and the security <a href="daglos03_31ny.htm">permission</a> settings from the database specified by <i>pstrOldDatabase</i> to the database specified by <i>pstrNewDatabase</i>.</p>
<p>
If you use <b>CompactDatabase</b> to convert a version 1.<i>x</i> database to version 2.5 or 3.<i>x</i>, only applications using version Microsoft Jet 2.5 or 3.<i>x</i> can open the converted database.</p>
<p class=indent>
<B><b>Note</b></B> In an <a href="daglos03_4o11.htm">ODBCDirect workspace</a>, using the <b>CompactDatabase</b> method doesn't return an error, but instead loads the Microsoft Jet database engine into memory.</p>
<p class=indent>
<B><b>Caution</b></B> Because the <b>CompactDatabase</b> method doesn't convert Microsoft Access objects, you shouldn't use <b>CompactDatabase</b> to convert a database containing such objects.</p>
<p class=label>
<b>Usage</b></p>
<pre><code>#include &lt;afxole.h&gt;
#include &lt;dbdao.h&gt;
...
CdbDBEngine   dben;
...
dben.CompactDatabase(   _T("Northwind.mdb"), _T("Nwind2.mdb"),
                     dbLangGeneral, // This is really a string.
                     dbVersion30);
</code></pre>
</font></BODY>
</HTML>
