<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Delete Method (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvmthdelete"></a>Delete Method</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthDeleteC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthDeleteX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthDeleteA">
</object>
<ul type=disc>
<li>
<a href="dadobj04_452s.htm">Recordset</a> objects deletes the <a href="daglos01_7wpw.htm">current record</a> in an updatable <b>Recordset</b> object. For <a href="daglos03_4o11.htm">ODBCDirect workspaces</a>, the type of driver determines whether <b>Recordset</b> objects are updatable and therefore support the <b>Delete</b> method.<br><br></li>
<li>
Collections deletes a <a href="daglos03_0oxg.htm">persistent object</a> from a <a href="daglos01_6q0e.htm">collection</a>.</li>
</ul>
<p class=label>
<b>Syntax: Recordset</b></p>
<p>
<b>VOIDDelete(VOID);</b></p>
<p class=label>
<b>Syntax: Collections</b></p>
<p>
<b>VOID</b><i>collection</i><b>.Delete (LPCTSTR</b><i> pstr </i><b>);</b></p>
<p>
The collections <b>Delete</b> method syntax has these parts.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=30%><b>Part</b></td>
<td class=label width=70%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=30%><i>collection</i></td>
<td width=70%>An <a href="daglos03_5jl1.htm">object variable</a> that represents any collection that can accept new objects (for limitations, see the table at the end of this topic).</td>
</tr>
<tr valign=top>
<td width=30%><i>pstr</i></td>
<td width=70%>A pointer to a string which names the element of the collection to be deleted.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
You can use the <b>Delete</b> method to delete a current record from a <b>CdbRecordset</b> or a member from a collection, such as a stored table from a database, a stored field from a table, or a stored index from a table.</p>
<p class=label>
<b>Recordsets</b></p>
<p>
A <b>Recordset</b> must contain a current record before you use <b>Delete</b>; otherwise, a run-time error occurs.</p>
<p>
In an updatable <b>Recordset</b> object, <b>Delete</b> removes the current record and makes it inaccessible. Although you can't edit or use the deleted record, it remains current. Once you move to another record, however, you can't make the deleted record current again. Subsequent references to a deleted record in a <b>Recordset</b> are invalid and produce an error.</p>
<p>
You can undo a record deletion if you use <a href="daglos04_9dta.htm">transactions</a> and the <a href="dameth01_50fn.htm">Rollback</a> method.</p>
<p>
If the <a href="daglos01_6dwl.htm">base table</a> is the <a href="daglos03_412d.htm">primary table</a> in a <a href="daglos01_40yt.htm">cascading delete</a> relationship, deleting the current record may also delete one or more records in a <a href="daglos02_4fs5.htm">foreign table</a>.</p>
<p class=indent>
<B><b>Note</b></B> To add, edit, or delete a record, there must be a unique index on the record in the underlying data source. If not, a "Permission denied" error will occur on the <a href="dameth01_4uuv.htm">AddNew</a>, <b>Delete</b>, or <a href="dameth03_5fzo.htm">Edit</a><b> </b>method call in a <a href="daglos02_60it.htm">Microsoft Jet workspace</a>, or an "Invalid argument" error will occur on the <a href="dameth06_94yt.htm">Update</a> method call in an <a href="daglos03_4o11.htm">ODBCDirect workspace</a>.</p>
<p class=label>
<b>Collections</b></p>
<p>
You can use the <b>Delete</b> method to delete a persistent object. However, if the collection is a <a href="dadobj01_4y3p.htm">Databases</a>, <a href="dadobj04_45o4.htm">Recordsets</a>, or <a href="dadobj05_89ph.htm">Workspaces</a> collection (each of which is stored only in memory), you can remove an open or active object only by closing that object with the <a href="dameth02_4pt1.htm">Close</a> method.</p>
<p>
The deletion of a stored object occurs immediately, but you should use the <a href="dameth06_3gdk.htm">Refresh</a> method on any other collections that may be affected by changes to the database structure.</p>
<p>
When you delete a <a href="dadobj05_8086.htm">CdbTableDef</a> object from the <a href="dadobj05_8bhi.htm">TableDefs</a> collection, you delete the table definition and the data in the table.</p>
<p>
The following table lists some limitations of the <b>Delete</b> method. The object in the first column contains the collection in the second column. The third column indicates if you can delete an object from that collection (for example, you can never delete a <a href="dadobj01_7702.htm">CdbContainer</a> object from the <b>Containers</b> collection of a <b>CdbDatabase</b> object).</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=33%><b>Object</b></td>
<td class=label width=33%><b>Collection</b></td>
<td class=label width=34%><b>Can you use the Delete method?</b></td>
</tr>
<tr valign=top>
<td width=33%><b>CdbDBEngine</b></td>
<td width=33%><a href="dadobj05_89ph.htm">Workspaces</a></td>
<td width=34%>No. Closing the objects deletes them. </td>
</tr>
<tr valign=top>
<td width=33%><b>CdbDBEngine</b></td>
<td width=33%><a href="dadobj02_7oaa.htm">Errors</a></td>
<td width=34%>No</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbWorkspace</b></td>
<td width=33%><a href="dadobj01_2sa6.htm">Connections</a></td>
<td width=34%>No. Closing the objects deletes them.</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbWorkspace</b></td>
<td width=33%><a href="dadobj01_4y3p.htm">Databases</a></td>
<td width=34%>No. Closing the objects deletes them.</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbWorkspace</b></td>
<td width=33%><a href="dadobj02_6lv4.htm">Groups</a></td>
<td width=34%>Yes</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbWorkspace</b></td>
<td width=33%><a href="dadobj05_66k2.htm">Users</a></td>
<td width=34%>Yes</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbConnection</b></td>
<td width=33%><a href="dadobj03_7ana.htm">QueryDefs</a></td>
<td width=34%>No</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbConnection</b></td>
<td width=33%><a href="dadobj04_45o4.htm">Recordsets</a></td>
<td width=34%>No. Closing the objects deletes them.</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbDatabase</b></td>
<td width=33%><a href="dadobj01_77le.htm">Containers</a></td>
<td width=34%>No</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbDatabase</b></td>
<td width=33%><b>QueryDefs</b></td>
<td width=34%>Yes</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbDatabase</b></td>
<td width=33%><b>Recordsets</b></td>
<td width=34%>No. Closing the objects deletes them.</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbDatabase</b></td>
<td width=33%><a href="dadobj05_4sku.htm">Relations</a></td>
<td width=34%>Yes</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbDatabase</b></td>
<td width=33%><a href="dadobj05_8bhi.htm">TableDefs</a></td>
<td width=34%>Yes</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbGroup</b></td>
<td width=33%><b>Users</b></td>
<td width=34%>Yes</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbUser</b></td>
<td width=33%><b>Groups</b></td>
<td width=34%>Yes</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbContainer</b></td>
<td width=33%><a href="dadobj01_7184.htm">Documents</a></td>
<td width=34%>No</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbQueryDef</b></td>
<td width=33%><a href="dadobj02_5jz8.htm">Fields</a></td>
<td width=34%>No</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbQueryDef</b></td>
<td width=33%><a href="dadobj03_48tu.htm">Parameters</a></td>
<td width=34%>No</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbRecordset</b></td>
<td width=33%><b>Fields</b></td>
<td width=34%>No</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbRelation</b></td>
<td width=33%><b>Fields</b></td>
<td width=34%>Only when the <b>CdbRelation</b> object is a new, unappended object.</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbTableDef</b></td>
<td width=33%><b>Fields</b></td>
<td width=34%>Only when the <b>CdbTableDef</b> object is new and hasn’t been appended to the database, or when the <a href="daprop08_6kbp.htm">Updatable</a> property of the <b>CdbTableDef</b> is set to <b>True</b>.</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbTableDef</b></td>
<td width=33%><a href="dadobj03_2bzs.htm">Indexes</a></td>
<td width=34%>Only when the <b>CdbTableDef</b> object is new and hasn’t been appended to the database, or when the <b>Updatable</b> property of the <b>CdbTableDef</b> is set to <b>True</b>.</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbIndex</b></td>
<td width=33%><b>Fields</b></td>
<td width=34%>Only when the <a href="dadobj03_74qg.htm">CdbIndex</a> object is new and hasn’t been appended to the database.</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbDatabase</b>, <b>CdbField,</b> <b>CdbIndex</b>, <b>CdbQueryDef</b>, <b>CdbTableDef</b></td>
<td width=33%><a href="dadobj03_6aux.htm">Properties</a></td>
<td width=34%>Only when the property is user-defined.</td>
</tr>
<tr valign=top>
<td width=33%><b>CdbDBEngine, CdbParameter, CdbRecordset, Workspace</b></td>
<td width=33%><b>Properties</b></td>
<td width=34%>No</td>
</tr>
</table><br>
<p class=label>
<b>Usage</b></p>
<pre><code>#include &lt;afxole.h&gt;
#include &lt;dbdao.h&gt;

CdbRecordset      rst;
...
rst.MoveLast();         // Make the last record the current record.
rst.Delete();            // Delete the current record.
rst.Close();            // Close the recordset.
</code></pre>
</font></BODY>
</HTML>
