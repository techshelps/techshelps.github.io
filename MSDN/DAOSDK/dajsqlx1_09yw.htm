<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>INNER JOIN Operation Example (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<p class=label>
<b><a name="dasqlinnerjoinx"></a>INNER JOIN Operation Example</b></p>
<p>
This example creates two <a href="daglos02_3vou.htm">equi-joins</a>: one between the Order Details and Orders tables and another between the Orders and Employees tables. This is necessary because the Employees table doesn't contain sales data, and the Order Details table doesn't contain employee data. The query produces a list of employees and their total sales.</p>
<p>
This example calls the EnumFields procedure, which you can find in the SELECT statement example.</p>
<pre><code>Sub InnerJoinX()

   Dim dbs As Database, rst As Recordset

   ' Modify this line to include the path to Northwind
   ' on your computer.
   Set dbs = OpenDatabase("Northwind.mdb")
   
   ' Create a join between the Order Details and 
   ' Orders tables and another between the Orders and 
   ' Employees tables. Get a list of employees and 
   ' their total sales.
   Set rst = dbs.OpenRecordset("SELECT DISTINCTROW " _
      &amp; "Sum(UnitPrice * Quantity) AS Sales, " _
      &amp; "(FirstName &amp; Chr(32) &amp; LastName) AS Name " _
      &amp; "FROM Employees <span class=cfe><b>INNER JOIN</b></span>(Orders " _
      &amp; "<span class=cfe><b>INNER JOIN</b></span> [Order Details] " _
      &amp; "ON [Order Details].OrderID = " _
      &amp; "Orders.OrderID ) " _
      &amp; "ON Orders.EmployeeID = " _
      &amp; "Employees.EmployeeID " _
      &amp; "GROUP BY (FirstName &amp; Chr(32) &amp; LastName);")
   
   ' Populate the Recordset.
   rst.MoveLast
   
   ' Call EnumFields to print the contents of the 
   ' Recordset. Pass the Recordset object and desired
   ' field width.
   EnumFields rst, 20

   dbs.Close

End Sub
</code></pre>
</font></BODY>
</HTML>
