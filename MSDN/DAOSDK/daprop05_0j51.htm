<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Prepare Property (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvproprepare"></a>Prepare Property</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvproPrepareC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvproPrepareA">
</object></p>
<p>
Sets or returns a value that indicates whether the query should be prepared on the server as a temporary stored procedure, using the ODBC <b>SQLPrepare</b> API function, prior to execution, or just executed using the ODBC <b>SQLExecDirect</b> API function (<a href="daglos03_4o11.htm">ODBCDirect workspaces</a> only).</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>VOIDSetPrepare(LPVARIANT</b><i> pv</i><b>);</b></p>
<p>
<b>COleVariantGetPrepare(VOID);</b></p>
<p class=label>
<b>Parameters</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=20%><b>Type</b></td>
<td class=label width=21%><b>Argument</b></td>
<td class=label width=59%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=20%><b>LPVARIANT</b></td>
<td width=21%><i>pv</i></td>
<td width=59%>A pointer to a variant with one of the values shown below.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
This property takes either of the following constants:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b>Constant</b></td>
<td class=label width=50%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=50%><b>dbQPrepare</b></td>
<td width=50%>(Default) The statement is prepared (that is, the ODBC <b>SQLPrepare</b> API is called). </td>
</tr>
<tr valign=top>
<td width=50%><b>dbQUnprepare</b></td>
<td width=50%>The statement is not prepared (that is, the ODBC <b>SQLExecDirect</b> API is called).</td>
</tr>
</table><br>
<p>
You can use the <b>Prepare</b> property to either have the server create a temporary stored procedure from your query and then execute it, or just have the query executed directly. By default the <b>Prepare</b> property is set to <b>dbQPrepare</b>. However, you can set this property to <b>dbQUnprepare</b> to prohibit preparing of the query. In this case, the query is executed using the <b>SQLExecDirect</b> API.</p>
<p>
Creating a stored procedure can slow down the initial operation, but increases performance of all subsequent references to the query. However, some queries cannot be executed in the form of stored procedures. In these cases, you must set the <b>Prepare</b> property to <b>dbQUnprepare</b>.</p>
<p>
If <b>Prepare</b> is set to <b>dbQPrepare</b>, this can be overridden when the query is executed by setting the <a href="dameth03_7u1x.htm">Execute</a> method's <b><i>options</i></b> argument to <b>dbExecDirect</b>.</p>
<p class=indent>
<B><b>Note</b></B> The ODBC <b>SQLPrepare</b> API is called as soon as the <a href="daprop07_7f70.htm">SQL</a> property is set. Therefore, if you want to improve performance using the <b>dbQUnprepare</b> option, you must set the <b>Prepare</b> property before setting the <b>SQL</b> property.</p>
</font></BODY>
</HTML>
