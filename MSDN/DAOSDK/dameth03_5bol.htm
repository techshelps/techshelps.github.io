<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FillCache Method (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvmthfillcache"></a>FillCache Method</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthFillCacheC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthFillCacheX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthFillCacheA">
</object></p>
<p>
Fills all or a part of a local cache for a <a href="dadobj04_452s.htm">CdbRecordset</a> object that contains data from a <a href="daglos02_7hgl.htm">Microsoft Jet-connected ODBC data source</a> (Microsoft Jet-connected ODBC databases only).</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>VOIDFillCache(LONG </b><i>lRows</i><b> = -1, CdbBookmark *</b><i>pbm</i><b> = NULL);</b></p>
<p class=label>
<b>Parameters</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=24%><b>Type</b></td>
<td class=label width=24%><b>Argument</b></td>
<td class=label width=52%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=24%><b>LONG</b></td>
<td width=24%><i>lRows</i></td>
<td width=52%>Optional. An integer that specifies the number of rows to store in the cache. If you omit this argument, the value is determined by the <a href="daprop02_7xid.htm">CacheSize</a> property setting.</td>
</tr>
<tr valign=top>
<td width=24%><b>CdbBookmark *</b></td>
<td width=24%><i>pbm</i> = <b>NULL</b></td>
<td width=52%>Optional. Pointer to a bookmark. The cache is filled starting from the record indicated by this bookmark. If you omit this argument, the cache is filled starting from the record indicated by the <a href="daprop02_77ck.htm">CacheStart</a> property.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
Caching improves the performance of an application that retrieves data from a remote server. A cache is space in local memory that holds the data most recently retrieved from the server; this assumes that the data will probably be requested again while the application is running. When a user requests data, the <a href="daglos02_0elh.htm">Microsoft Jet database engine</a> checks the cache for the data first rather than retrieving it from the server, which takes more time. The cache doesn't save data that doesn't come from an ODBC data source.</p>
<p>
Rather than waiting for the cache to be filled with records as they are retrieved, you can use the <b>FillCache</b> method to explicitly fill the cache at any time. This is a faster way to fill the cache because <b>FillCache</b> retrieves several records at once instead of one at a time. For example, while you view each screenful of records, your application uses <b>FillCache</b> to retrieve the next screenful of records for viewing.</p>
<p>
Any Microsoft Jet-connected ODBC data source that you access with <b>CdbRecordset</b> objects can have a local cache. To create the cache, open a <b>CdbRecordset</b> object from the remote data source, and then set the <b>CacheSize</b> and <b>CacheStart</b> properties of the <b>CdbRecordset</b>.</p>
<p>
If <i>lRows</i> and <i>pbm</i> create a range of records that is partially or entirely outside the range of records specified by the <b>CacheSize</b> and <b>CacheStart</b> properties, the portion outside this range is ignored and will not be loaded into the cache.</p>
<p>
If <b>FillCache</b> requests more records than the number remaining in the remote data source, Microsoft Jet retrieves only the remaining records, and no error occurs.</p>
<p class=label>
<b>Notes</b>
<ul type=disc>
<li>
Records retrieved from the cache don't reflect concurrent changes that other users made to the source data.<br><br></li>
<li>
<b>FillCache</b> only retrieves records not already cached. To force an update of all the cached data, set the <b>CacheSize</b> property of the <b>CdbRecordset</b> to 0, reset it to the size of the cache you originally requested, and then use <b>FillCache</b>.</li>
</ul>
<p class=label>
<b>Usage</b></p>
<pre><code>#include &lt;afxole.h&gt;
#include &lt;dbdao.h&gt;

CdbDBE   ngine      dben(..., dbUseODBC);
CdbDatabase      dbs;
CdbRecordset      rst;
CdbBookmark      book;

dbs = dben.OpenDatabase(_T("ODBC;..."));
rst = dbs.OpenRecordset(..., dbOpenDynaset);
if (rst.Bookmarkable())
{
   // Remember the current record position.
book = rst.GetBookmark();
   // Start the cache from the current position.
rst.SetCacheStart(book);
   // The cache will hold 25 records.
rst.SetCacheSize(25);
rst.FillCache();
   // Do some work...
rst.MoveNext();
   // Get a few more records.
book = rst.GetBookmark();
rst.FillCache(5, &amp;book);
...
}
</code></pre>
</font></BODY>
</HTML>
