<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OpenRecordset Method (dbDAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvmthopenrecordsets"></a>CdbRecordset::OpenRecordset Method</h1>
<p>
Creates a new <b>Recordset</b> object and appends it to the <b>Recordsets</b> collection.</p>
<p class=label>
<b>Syntax</b></p>
<p>
CdbRecordsetOpenRecordset(LONG lType=-1, LONG lOption=-1);</p>
<p class=label>
<b>Parameters</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=563>
<tr valign=top>
<td class=label width=26%><b>Type</b></td>
<td class=label width=27%><b>Example</b></td>
<td class=label width=47%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=26%>LONG</td>
<td width=27%>lType</td>
<td width=47%>Optional. A constant that indicates the type of <b>Recordset</b> to open as listed in Settings.</td>
</tr>
<tr valign=top>
<td width=26%>LONG</td>
<td width=27%>lOption</td>
<td width=47%>Optional. A combination of constants that specify characteristics of the new <b>Recordset</b> as listed in Settings.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
Use the following values for Type.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=563>
<tr valign=top>
<td class=label width=40%><b>Constant</b></td>
<td class=label width=60%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=40%><b>dbOpenTable</b></td>
<td width=60%>Opens a table-type <b>Recordset</b> object (Microsoft Jet workspaces only).</td>
</tr>
<tr valign=top>
<td width=40%><b>dbOpenDynamic</b></td>
<td width=60%>Opens a dynamic-type <b>Recordset</b> object, which is similar to an ODBC dynamic cursor. (ODBCDirect workspaces only)</td>
</tr>
<tr valign=top>
<td width=40%><b>dbOpenDynaset</b></td>
<td width=60%>Opens a dynaset-type <b>Recordset</b> object, which is similar to an ODBC keyset cursor.</td>
</tr>
<tr valign=top>
<td width=40%><b>dbOpenSnapshot</b></td>
<td width=60%>Opens a snapshot-type <b>Recordset</b> object, which is similar to an ODBC static cursor.</td>
</tr>
<tr valign=top>
<td width=40%><b>dbOpenForwardOnly</b></td>
<td width=60%>Opens a forward-only-type <b>Recordset</b> object.</td>
</tr>
</table><br>
<p>
&nbsp;</p>
<p>
Use the following values for Option.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=563>
<tr valign=top>
<td class=label width=40%><b>Constant</b></td>
<td class=label width=60%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=40%><b>dbAppendOnly</b></td>
<td width=60%>Allows users to append new records to the <b>Recordset</b>, but prevents them from editing or deleting existing records (Microsoft Jet dynaset-type <b>Recordset</b> only).</td>
</tr>
<tr valign=top>
<td width=40%><b>dbSQLPassThrough</b></td>
<td width=60%>Passes an SQL statement to a Microsoft Jet-connected ODBC data source for processing (Microsoft Jet snapshot-type <b>Recordset</b> only).</td>
</tr>
<tr valign=top>
<td width=40%><b>dbSeeChanges</b></td>
<td width=60%>Generates a run-time error if one user is changing data that another user is editing (Microsoft Jet dynaset-type <b>Recordset</b> only). This is useful in applications where multiple users have simultaneous read/write access to the same data.</td>
</tr>
<tr valign=top>
<td width=40%><b>dbDenyWrite</b></td>
<td width=60%>Prevents other users from modifying or adding records (Microsoft Jet <b>Recordset</b> objects only).</td>
</tr>
<tr valign=top>
<td width=40%><b>dbDenyRead</b></td>
<td width=60%>Prevents other users from reading data in a table (Microsoft Jet table-type <b>Recordset</b> only).</td>
</tr>
<tr valign=top>
<td width=40%><b>dbForwardOnly</b></td>
<td width=60%>Creates a forward-only <b>Recordset</b> (Microsoft Jet snapshot-type <b>Recordset</b> only). It is provided only for backward compatibility, and you should use the <b>dbOpenForwardOnly</b> constant in the type argument instead of using this option.</td>
</tr>
<tr valign=top>
<td width=40%><b>dbReadOnly</b></td>
<td width=60%>Prevents users from making changes to the <b>Recordset</b> (Microsoft Jet only). The <b>dbReadOnly</b> constant in the lockedits argument replaces this option, which is provided only for backward compatibility.</td>
</tr>
<tr valign=top>
<td width=40%><b>dbRunAsync</b></td>
<td width=60%>Runs an asynchronous query (ODBCDirect workspaces only).</td>
</tr>
<tr valign=top>
<td width=40%><b>dbExecDirect</b></td>
<td width=60%>Runs a query by skipping <b>SQLPrepare</b> and directly calling <b>SQLExecDirect</b> (ODBCDirect workspaces only). Use this option only when you’re not opening a <b>Recordset</b> based on a parameter query. For more information, see the "Microsoft ODBC 3.0 Programmer’s Reference."</td>
</tr>
<tr valign=top>
<td width=40%><b>dbInconsistent</b></td>
<td width=60%>Allows inconsistent updates (Microsoft Jet dynaset-type and snapshot-type <b>Recordset</b> objects only).</td>
</tr>
<tr valign=top>
<td width=40%><b>dbConsistent</b></td>
<td width=60%>Allows only consistent updates (Microsoft Jet dynaset-type and snapshot-type <b>Recordset</b> objects only).</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
The constants <b>dbConsistent</b> and <b>dbInconsistent</b> are mutually exclusive. Using both causes an error.</p>
<p class=indent>
<B><b>Note</b></B> The core topic says the <b>LockEdits</b> parameter is available for all <b>OpenRecordset</b> methods. The <b>CdbRecordset::OpenRecordset</b> method actually applies to Microsoft Jet workspaces only. The <b>LockEdits</b> parameter actually applies to ODBCDirect workspaces only and is not available in this method.</p>
<p class=label>
<b>Usage</b></p>
<pre><code>#include &lt;afxole.h&gt;
#include &lt;dbdao.h&gt;
CdbDBEngine      dben;
CdbDatabase      dbs;
CdbRecordset      rst, rst2;

dbs = dben.OpenDatabase(_T("Northwind.mdb"));
rst = dbs.OpenRecordset(_T("SELECT * FROM EMPLOYEES"),dbOpenDynaset);
   // Get more selective.
rst.SetFilter(_T("LASTNAME &gt;= 'M'");
rst2 = rst.OpenRecordset();
</code></pre>
</font></BODY>
</HTML>
