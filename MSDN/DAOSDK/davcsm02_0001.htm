<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OpenConnection Method (dbDAO);</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvmthopenconnections"></a>CdbWorkspace::OpenConnection Method</h1>
<p>
Opens a <b>Connection</b> object on an ODBC data source (ODBCDirect workspaces only).</p>
<p class=label>
<b>Syntax</b></p>
<p>
CdbConnectionOpenConnection(LPCTSTR pstrName,</p>
<p>
LONG lOption=-1L,</p>
<p>
BOOL bReadOnly=FALSE,</p>
<p>
LPCTSTR pstrConnect=NULL);</p>
<p class=label>
<b>Parameters</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=563>
<tr valign=top>
<td class=label width=21%><b>Type</b></td>
<td class=label width=25%><b>Example</b></td>
<td class=label width=54%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=21%>LPCTSTR</td>
<td width=25%>pstrName</td>
<td width=54%>A pointer to a string that contains the name of a registered ODBC data source (DSN). If it doesn't refer to a valid ODBC data source name, an error occurs.</td>
</tr>
<tr valign=top>
<td width=21%>LONG</td>
<td width=25%>IOption</td>
<td width=54%>Optional. A <b>Long</b> value that specifies how the ODBC driver manager should prompt the user for connection information such as DSN, user name, and password. Possible values are described in Remarks.</td>
</tr>
<tr valign=top>
<td width=21%>BOOL</td>
<td width=25%>bReadOnly</td>
<td width=54%>Optional. A <b>Boolean</b>.<p>
<b>TRUE</b>Opens a <b>Connection</b> object for read-only access.</p>
<p>
<b>FALSE</b>(Default) Opens a <b>Connection</b> object for read/write access.</p>
</td>
</tr>
<tr valign=top>
<td width=21%>LPCTSTR</td>
<td width=25%>pstrConnect</td>
<td width=54%>Optional. A pointer to a string that contains the ODBC connect string. See the <b>Connect</b> property for the specific elements and syntax of this string. A prepended "ODBC;" is required. If <i>Connect</i> is omitted (default), the UID and/or PWD will be taken from the <b>UserName</b> and <b>Password</b> properties of the <b>Workspace</b>.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
The following are valid Options values.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=563>
<tr valign=top>
<td class=label width=46%><b>Constant</b></td>
<td class=label width=54%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=46%><b>dbDriverNoPrompt</b></td>
<td width=54%>The ODBC driver manager uses the connection string provided in <i>Name</i> and <i>Connect</i>. If sufficient information is not provided, a trappable error is returned.</td>
</tr>
<tr valign=top>
<td width=46%><b>dbDriverPrompt</b></td>
<td width=54%>The driver manager displays the ODBC Data Sources dialog box. The connection string used to establish the connection is constructed from the DSN selected and completed by the user via the dialog boxes, or, if no DSN is chosen, the default DSN is used.</td>
</tr>
<tr valign=top>
<td width=46%><b>dbDriverComplete</b></td>
<td width=54%>If the Connect argument includes the DSN keyword, the driver manager uses the string as provided in <i>Connect</i>. Otherwise it behaves as it does when <b>dbDriverPrompt</b> is specified.</td>
</tr>
<tr valign=top>
<td width=46%><b>dbDriverCompleteRequired</b></td>
<td width=54%>Behaves like <b>dbDriverComplete</b> except the driver disables the prompts for any information not required to complete the connection.</td>
</tr>
<tr valign=top>
<td width=46%><b>dbRunAsync</b></td>
<td width=54%>Execute the method asynchronously. This constant may be used with any of the other <i>Options</i> constants.</td>
</tr>
</table><br>
<p>
The <b>OpenConnection</b> method is similar but not equivalent to <b>OpenDatabase</b>. The main difference is that <b>OpenConnection</b> is available only in an ODBCDirect workspace.</p>
<p class=label>
<b>Usage</b></p>
<pre><code>#include &lt;afxole.h&gt;
#include &lt;dbdao.h&gt;
CdbDBEngine      dben(..., dbUseODBC);
CdbWorkspace      wksp;
CdbConnection   conn;
CdbRecordset      rstX;
wksp = dben.Workspaces[0L];
conn = wksp.OpenConnection(_T("ODBC;..."), 
                           (dbDriverNoPrompt|dbRunAsync),
                           FALSE, T("DATABASE=SomeDB..."));
rstX = conn.OpenRecordset(...);
</code></pre>
</font></BODY>
</HTML>
