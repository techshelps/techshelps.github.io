<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQL Property (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvprosql"></a>SQL Property</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvproSQLC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvproSQLA">
</object></p>
<p>
Sets or returns the <a href="daglos04_188k.htm">SQL statement</a> that defines the query executed by a <a href="dadobj03_6zdy.htm">CdbQueryDef</a> object.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>VOIDSetSQL(LPCTSTR </b><i>pstr</i><b> );</b></p>
<p>
<b>CStringGetSQL(VOID);</b></p>
<p class=label>
<b>Parameters</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=26%><b>Type</b></td>
<td class=label width=26%><b>Argument</b></td>
<td class=label width=48%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=26%><b>LPCTSTR</b></td>
<td width=26%><i>pstr</i></td>
<td width=48%>A pointer to a string that contains an SQL statement.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
The <b>SQL</b> property contains the SQL statement that determines how records are selected, grouped, and ordered when you execute the query. You can use the query to select records to include in a <b>CdbRecordset</b> object. You can also define action queries to modify data without returning records.</p>
<p>
The SQL syntax used in a query must conform to the SQL dialect of the query engine, which is determined by the type of workspace. In a <a href="daglos02_60it.htm">Microsoft Jet workspace</a>, use the Microsoft Jet SQL dialect, unless you create an SQL pass-through query, in which case you should use the dialect of the server. In an <a href="daglos03_4o11.htm">ODBCDirect workspace</a>, use the SQL dialect of the server.</p>
<p class=indent>
<B><b>Note</b></B> You can send DAO queries to a variety of different database servers with ODBCDirect, and different servers will recognize slightly different dialects of SQL. Therefore, context-sensitive Help is no longer provided for Microsoft Jet SQL, although online Help for Microsoft Jet SQL is still included through the Help menu. Be sure to check the appropriate reference documentation for the SQL dialect of your database server when using either ODBCDirect connections or pass-through queries in Microsoft Jet-connected client/server applications.</p>
<p>
If the SQL statement includes <a href="daglos03_7hv6.htm">parameters</a> for the query, you must set these before execution. Until you reset the parameters, the same parameter values are applied each time you execute the query.</p>
<p>
In an ODBCDirect workspace, you can also use the <b>SQL</b> property to execute a prepared statement on the server. For example, setting the <b>SQL</b> property to the following string will execute a prepared statement named “GetData” with one parameter on a Microsoft SQL Server back-end.</p>
<pre><code>"{call GetData (?)}"
</code></pre>
<p>
In a Microsoft Jet workspace, using a <b>CdbQueryDef</b> object is the preferred way to perform SQL pass-through operations on <a href="daglos02_7hgl.htm">Microsoft Jet-connected ODBC data sources</a>. By setting the <b>CdbQueryDef</b> object's <a href="daprop02_4ilw.htm">Connect</a> property to an <a href="daglos03_23vp.htm">ODBC data source</a>, you can use non–Microsoft-Jet-database SQL in the query to be passed to the external server. For example, you can use TRANSACT SQL statements (with Microsoft SQL Server or Sybase SQL Server databases), which the Microsoft Jet database engine would otherwise not process.</p>
<p class=indent>
<B><b>Note</b></B> If you set the property to a string concatenated with a non-integer value, and the system parameters specify a non-U.S. decimal character such as a comma (for example, <code>strSQL = "PRICE &gt; " &amp; lngPrice</code>, and <code>lngPrice = 125,50</code>), an error will result when you try to execute the <b>CdbQueryDef</b> object in a Microsoft Jet database. This is because during concatenation, the number will be converted to a string using your system's default decimal character and Microsoft Jet SQL only accepts U.S. decimal characters.</p>
</font></BODY>
</HTML>
