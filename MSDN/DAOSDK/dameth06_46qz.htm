<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Seek Method (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvmthseek"></a>Seek Method</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthSeekC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthSeekX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthSeekA">
</object></p>
<p>
Locates the record in an indexed table-type <a href="dadobj04_452s.htm">CdbRecordset</a> object that satisfies the specified criteria for the <a href="daglos01_9vzs.htm">current index</a> and makes that record the <a href="daglos01_7wpw.htm">current record</a> (<a href="daglos02_60it.htm">Microsoft Jet workspaces</a> only).</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>VOIDSeek(LPCTSTR </b><i>pstrComparison</i><b>,</b></p>
<p>
<b>LONG </b><i>lNumFields</i><b>,</b></p>
<p>
<b>COleVariant </b><i>cKey</i><b>,</b></p>
<p>
<b>...);</b></p>
<p class=label>
<b>Parameters</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=21%><b>Type</b></td>
<td class=label width=25%><b>Argument</b></td>
<td class=label width=54%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=21%><b>LPCTSTR</b></td>
<td width=25%><i>pstrComparison</i></td>
<td width=54%>One of the following string expressions: &lt;, &lt;=, =, &gt;=, or &gt;.</td>
</tr>
<tr valign=top>
<td width=21%><b>LONG</b></td>
<td width=25%><i>lNumFields</i></td>
<td width=54%>The number of key arguments that follow. This argument may have a value from 1 to 13. (The maximum value of this parameter is defined by DAO_MAXSEEKFIELDS.)</td>
</tr>
<tr valign=top>
<td width=21%><b>COleVariant</b></td>
<td width=25%><i>cKey</i>, ...</td>
<td width=54%>One or more values corresponding to fields in the <b>CdbRecordset</b> object's current index, as specified by its <a href="daprop04_7flk.htm">Index</a> property setting. <b>Seek</b> accepts an unspecified number of arguments, as indicated by the ellipsis symbol ("..."), however you may only have a maximum of 13 key arguments. </td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
You must set the current index with the <b>Index </b>property before you use <b>Seek</b>. If the index identifies a nonunique key field, <b>Seek</b> locates the first record that satisfies the criteria.</p>
<p>
The <b>Seek</b> method searches through the specified key fields and locates the first record that satisfies the criteria specified by <i>pstrComparison</i> and <i>cKey</i>. Once found, it makes that record current and sets the <a href="daprop05_8uqw.htm">NoMatch</a> property to <b>False</b>. If the <b>Seek</b> method fails to locate a match, the <b>NoMatch</b> property is set to <b>True</b>, and the current record is undefined.</p>
<p>
If <i>pstrComparison</i> is equal (=), greater than or equal (&gt;=), or greater than (&gt;), <b>Seek</b> starts at the beginning of the index and searches forward.</p>
<p>
If <i>pstrComparison</i> is less than (&lt;) or less than or equal (&lt;=), <b>Seek</b> starts at the end of the index and searches backward. However, if there are duplicate index entries at the end of the index, <b>Seek</b> starts at an arbitrary entry among the duplicates and then searches backward.</p>
<p>
You must specify values for all fields defined in the index. If you use <b>Seek</b> with a multiple-column index, and you don't specify a comparison value for every field in the index, then you cannot use the equal (=) operator in the comparison. That's because some of the <i>cKey</i> criteria fields will default to <a href="daglos03_67os.htm">Null</a>, which will probably not match. Therefore, the equal operator will work correctly only if you have a record which is all <b>Null</b> except the key you're looking for. It's recommended that you use the greater than or equal (&gt;=) operator instead.</p>
<p>
The <i>cKey</i> argument must be of the same <a href="daglos01_9yed.htm">field data type</a> as the corresponding field in the current index. For example, if the current index refers to a number field (such as Employee ID), <i>cKey</i> must be numeric.</p>
<p>
There doesn't have to be a current record when you use <b>Seek</b>.</p>
<p>
You can use the <a href="dadobj03_2bzs.htm">Indexes</a> collection to enumerate the existing indexes.</p>
<p>
To locate a record in a dynaset- or snapshot-type <b>CdbRecordset</b> that satisfies a specific condition that is not covered by existing indexes, use the <a href="dameth03_2184.htm">Find</a> methods. To include all records, not just those that satisfy a specific condition, use the <a href="dameth04_5rn8.htm">Move</a> methods to move from record to record.</p>
<p>
You can't use the <b>Seek</b> method on a <a href="daglos02_01np.htm">linked table</a> because you can't open linked tables as table-type <b>Recordset</b> objects. However, if you use the <a href="dameth05_6b6t.htm">OpenDatabase</a> method to directly open an <a href="daglos02_1c8d.htm">installable ISAM</a> (non-ODBC) database, you can use <b>Seek</b> on tables in that database.</p>
<p>
In an <a href="daglos03_4o11.htm">ODBCDirect workspace</a>, the <b>Find</b> and <b>Seek</b> methods are not available on any type of <b>CdbRecordset</b> object, because executing a <b>Find</b> or <b>Seek</b> through an ODBC connection is not very efficient over the network. Instead, you should design the query (that is, using the <i>pstrSource</i> argument to the <a href="dameth05_1f78.htm">OpenRecordset</a> method) with an appropriate WHERE clause that restricts the returned records to only those that meet the criteria you would otherwise use in a <b>Find</b> or <b>Seek</b>.</p>
<p class=label>
<b>Usage</b></p>
<pre><code>#include &lt;afxole.h&gt;
#include &lt;dbdao.h&gt;

CdbDBEngine      dben;
CdbDatabase      dbs;
CdbRecordset      rst;
...
   // Open a table-type recordset.
rst = dbs.OpenRecordset(..., dbOpenTable);
   // Define current index as the LastName index.
rst.SetIndex(_T("LastName"));
   // Seek first record with last name equal to Smith
rst.Seek("=", 1, _T("Smith"));
</code></pre>
</font></BODY>
</HTML>
