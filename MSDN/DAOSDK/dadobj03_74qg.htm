<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Index Object (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvobjindex"></a>CdbIndex Object</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvobjIndexC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Methods">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvobjIndexM">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Properties">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvobjIndexP">
</object></p>
<p>
<b>CdbIndex</b> objects specify the order of records accessed from database tables and whether or not duplicate records are accepted, providing efficient access to data. For external databases, <b>CdbIndex</b> objects describe the indexes established for external tables (<a href="daglos02_60it.htm">Microsoft Jet workspaces</a> only).</p>
<p>
<a href="dadobj05_8086.htm"><img src="objtable.gif" border=0></a><br>
<img src="parmult.gif" border=0><a href="dadobj03_2bzs.htm"><img src="colindex.gif" border=0></a><br>
<img src="parlower.gif" border=0><img src="parchild.gif" border=0><img src="objindex.gif" border=0><br>
<img src="parchild.gif" border=0><img src="paracros.gif" border=0><img src="parshare.gif" border=0><a href="dadobj02_5jz8.htm"><img src="colfield.gif" border=0></a></p>
<p class=label>
<b>Remarks</b></p>
<p>
The <a href="daglos02_0elh.htm">Microsoft Jet database engine</a> uses indexes when it joins tables and creates <a href="dadobj04_452s.htm">CdbRecordset</a> objects. Indexes determine the order in which <a href="dadobj04_4kz8.htm">table-type CdbRecordset</a> objects return records, but they don't determine the order in which the Microsoft Jet database engine stores records in the base table or the order in which any other type of <b>CdbRecordset</b> object returns records.</p>
<p>
With a <b>CdbIndex</b> object, you can:
<ul type=disc>
<li>
Use the <b>Required</b> property to determine whether the <a href="dadobj02_0cpw.htm">Field</a> objects in the index require values that are not <a href="daglos03_67os.htm">Null</a>, and then use the <b>IgnoreNulls</b> property to determine whether the <b>Null</b> values have index entries.<br><br></li>
<li>
Use the <b>Primary</b> and <b>Unique </b>properties to determine the ordering and uniqueness of the <b>CdbIndex</b> object.</li>
</ul>
<p>
The Microsoft Jet database engine maintains all <a href="daglos01_6dwl.htm">base table</a> indexes automatically. It updates indexes whenever you add, change, or delete records from the base table. Once you create the database, use the <a href="dameth02_7605.htm">CompactDatabase</a> method periodically to bring index statistics up-to-date.</p>
<p>
When accessing a table-type <b>CdbRecordset</b> object, specify the order of records using the object's <b>CdbIndex</b> property. Set this property to the <b>Name</b> property setting of an existing <b>CdbIndex</b> object in the <b>Indexes</b> collection. This collection is contained by the <a href="dadobj05_8086.htm">CdbTableDef</a> object underlying the <b>CdbRecordset</b> object that you're populating.</p>
<p class=indent>
<B><b>Note</b></B> You don't have to create indexes for a table, but for large, unindexed tables, accessing a specific record or processing <a href="daglos02_37hq.htm">joins</a> can take a long time. Conversely, having too many indexes can slow down updates to the database as each of the table indexes is amended.</p>
<p>
The <a href="daprop01_7yk3.htm">Attributes</a> property of each <b>CdbField</b> object in the index determines the order of records returned and, consequently, determines which access techniques to use for that index.</p>
<p>
Each <b>CdbField</b> object in the <b>Fields</b> collection of a <b>CdbIndex</b> object is a component of the index. To define a new <b>CdbIndex</b> object, set its properties before you append it to a collection, making the <b>CdbIndex</b> object available for subsequent use.</p>
<p class=indent>
<B><b>Note</b></B> You can modify the <b>Name</b> property setting of an existing <b>CdbIndex</b> object only if the <a href="daprop08_6kbp.htm">Updatable</a> property setting of the containing <b>CdbTableDef</b> object is <b>TRUE</b>.</p>
<p>
When you set a <a href="daglos03_8r3t.htm">primary key</a> for a table, the Microsoft Jet database engine automatically defines it as the primary index. A primary index consists of one or more fields that uniquely identify all records in a table in a predefined order. Because the primary index field must be unique, the Microsoft Jet database engine automatically sets the <b>Unique</b> property of the primary <b>CdbIndex</b> object to <b>TRUE</b>. If the primary index consists of more than one field, each field can contain duplicate values, but the combination of values from all the indexed fields must be unique. A primary index consists of a key for the table and is always made up of the same fields as the primary key.</p>
<p class=indent>
<B><b>Important</b></B> Make sure your data complies with the attributes of your new index. If your index requires unique values, make sure that there are no duplicates in existing data records. If duplicates exist, the Microsoft Jet database engine can't create the index; a trappable error results when you attempt to use the <b>Append</b> method on the new index.</p>
<p>
When you create a relationship that enforces <a href="daglos03_8i2h.htm">referential integrity</a>, the Microsoft Jet database engine automatically creates an index with the <b>Foreign</b> property, set as the <a href="daglos02_2zll.htm">foreign key</a> in the referencing table. After you've established a table relationship, the Microsoft Jet database engine prevents additions or changes to the database that violate that relationship. If you set the <b>Attributes</b> property of the <a href="dadobj05_4hbi.htm">CdbRelation</a> object to allow <a href="daglos01_2hr9.htm">cascading updates</a> and <a href="daglos01_40yt.htm">cascading deletes</a>, the Microsoft Jet database engine updates or deletes records in related tables automatically.</p>
<p class=label>
<b><img src="prcarrow.gif" border=0>To create a new CdbIndex object</b>
<ol>
<li>
Use the <b>CreateIndex</b> method on a <b>CdbTableDef</b> object.<br><br></li>
<li>
Use the <b>CreateField</b> method on the <b>CdbIndex</b> object to create a <b>CdbField</b> object for each field (column) to be included in the <b>CdbIndex</b> object.<br><br></li>
<li>
Set <b>CdbIndex</b> properties as needed.<br><br></li>
<li>
Append the <b>CdbField</b> object to the <b>Fields</b> collection.<br><br></li>
<li>
Append the <b>CdbIndex</b> object to the <b>Indexes</b> collection.</li>
</ol>
<p class=indent>
<B><b>Note</b></B> The <b>Clustered</b> property is ignored for databases that use the Microsoft Jet database engine, which doesn't support clustered indexes.</p>
<p class=label>
<b>CdbIndex Constructor Syntax</b></p>
<p>
Use any one of the following three constructors. The qualifier 'CONSTRUCTOR' in the syntax models is provided to help readability. It has no syntactic value.</p>
<p>
<b>CONSTRUCTORCdbIndex(VOID);</b></p>
<p>
This constructor creates an instance of the class. There are no parameters.</p>
<p>
<b>CONSTRUCTORCdbIndex(const CdbIndex &amp;);</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b>Type</b></td>
<td class=label width=50%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=50%><b>const CdbIndex &amp;</b></td>
<td width=50%>Reference to an object.</td>
</tr>
</table><br>
<p>
This constructor creates a copy of the object referenced in the parameter.</p>
<p>
<b>CONSTRUCTORCdbIndex(DAOIndex *</b><i>pidx</i><b>,</b></p>
<p>
<b>BOOL </b><i>bAddRef</i> <b>= FALSE);</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=23%><b>Type</b></td>
<td class=label width=28%><b>Argument</b></td>
<td class=label width=49%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=23%><b>DAOIndex *</b></td>
<td width=28%><i>pidx</i></td>
<td width=49%>A DAO Automation interface pointer corresponding to this DAO class.</td>
</tr>
<tr valign=top>
<td width=23%><b>BOOL</b></td>
<td width=28%><i>bAddRef</i><p>
<b>=FALSE</b></p>
</td>
<td width=49%>Optional. A <b>Boolean</b>. If <b>TRUE</b>, the DAO Automation interface <b>AddRef</b> function is called.</td>
</tr>
</table><br>
<p>
DAO functionality is presented through pointers to DAO Automation interfaces. This constructor makes a DAO interface available in the form of a DAO class object that provides additional functionality.</p>
<p>
This constructor is not required for typical use. It is provided to enable you to easily create a DAO class object if you have access to the corresponding DAO interface.</p>
<p>
When the destructor for the DAO object is invoked, the underlying Automation interface's <b>Release</b> member is called. If <b>Release</b> decrements the interface's reference count to zero, the pointer to the Automation interface can be deleted. If you don't want this to happen (for example, because you want to discard the DAO object but continue using the Automation interface), specify <b>TRUE</b> for the second parameter. The underlying Automation interface's <b>AddRef</b> member is called, which counterbalances the eventual call to <b>Release</b>.</p>
</font></BODY>
</HTML>
