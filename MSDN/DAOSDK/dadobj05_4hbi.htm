<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Relation Object (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvobjrelation"></a>CdbRelation Object</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvobjRelationC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Methods">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvobjRelationM">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Properties">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvobjRelationP">
</object></p>
<p>
A <b>CdbRelation</b> object represents a <a href="daglos03_8d9s.htm">relationship</a> between fields in tables or queries (<a href="daglos02_23l1.htm">Microsoft Jet</a> databases only).</p>
<p>
<a href="dadobj01_4mud.htm"><img src="objdatab.gif" border=0></a><br>
<img src="parchild.gif" border=0><a href="dadobj05_4sku.htm"><img src="colrelat.gif" border=0></a><br>
<img src="space.gif" border=0><img src="parchild.gif" border=0><img src="objrelat.gif" border=0><br>
<img src="space.gif" border=0><img src="space.gif" border=0><img src="parmult.gif" border=0><a href="dadobj02_5jz8.htm"><img src="colfield.gif" border=0></a><br>
<img src="space.gif" border=0><img src="space.gif" border=0><img src="parchild.gif" border=0><a href="dadobj03_6aux.htm"><img src="colprope.gif" border=0></a></p>
<p class=label>
<b>Remarks</b></p>
<p>
You can use the <b>CdbRelation</b> object to create new relationships and examine existing relationships in your database.</p>
<p>
Using a <b>CdbRelation</b> object and its properties, you can:
<ul type=disc>
<li>
Specify an enforced relationship between fields in <a href="daglos01_6dwl.htm">base tables</a> (but not a relationship that involves a query or a <a href="daglos02_01np.htm">linked table</a>).<br><br></li>
<li>
Establish unenforced relationships between any type of table or query&nbsp;— native or linked.<br><br></li>
<li>
Use the <b>Name</b> property to refer to the relationship between the fields in the referenced <a href="daglos03_412d.htm">primary table</a> and the referencing <a href="daglos02_4fs5.htm">foreign table</a>.<br><br></li>
<li>
Use the <b>Attributes</b> property to determine whether the relationship between fields in the table is <a href="daglos03_7h68.htm">one-to-one</a> or <a href="daglos03_01io.htm">one-to-many</a> and how to enforce referential integrity.<br><br></li>
<li>
Use the <b>Attributes</b> property to determine whether the Microsoft Jet database engine can perform cascading update and cascading delete operations on primary and foreign tables.<br><br></li>
<li>
Use the <b>Attributes</b> property to determine whether the relationship between fields in the table is <a href="daglos02_7z8u.htm">left join</a> or <a href="daglos03_04ha.htm">right join</a>.<br><br></li>
<li>
Use the <b>Name</b> property of all <b>CdbField</b> objects in the <b>Fields</b> collection of a <b>CdbRelation</b> object to set or return the names of the fields in the primary key of the referenced table, or the <b>ForeignName</b> property settings of the <b>CdbField</b> objects to set or return the names of the fields in the foreign key of the referencing table.</li>
</ul>
<p>
If you make changes that violate the relationships established for the database, a trappable error occurs. If you request <a href="daglos01_2hr9.htm">cascading update</a> or <a href="daglos01_40yt.htm">cascading delete</a> operations, the Microsoft Jet database engine also modifies the <a href="daglos03_8r3t.htm">primary</a> or <a href="daglos02_2zll.htm">foreign key</a> tables to enforce the relationships you establish.</p>
<p>
For example, the Northwind database contains a relationship between an Orders table and a Customers table. The CustomerID field of the Customers table is the primary key, and the CustomerID field of the Orders table is the foreign key. For Microsoft Jet to accept a new record in the Orders table, it searches the Customers table for a match on the CustomerID field of the Orders table. If Microsoft Jet doesn't find a match, it doesn't accept the new record and a trappable error occurs.</p>
<p>
When you enforce referential integrity, a unique <a href="daglos02_9np4.htm">index</a> must already exist for the key field of the referenced table. The Microsoft Jet database engine automatically creates an index with the <b>Foreign</b> property set to act as the foreign key in the referencing table.</p>
<p>
To create a new <b>CdbRelation</b> object, use the <b>CreateRelation</b> method. To refer to a <b>CdbRelation</b> object in a collection by its ordinal number or by its <b>Name</b> property setting, use either of the following syntax forms:</p>
<p>
<b>Relations[</b>0<b>]</b></p>
<p>
<b>Relations[</b>"<i>name</i>"<b>]</b></p>
<p class=label>
<b>CdbRelation Constructor Syntax</b></p>
<p>
Use any one of the following three constructors. The qualifier 'CONSTRUCTOR' in the syntax models is provided to help readability. It has no syntactic value.</p>
<p>
<b>CONSTRUCTORCdbRelation(VOID);</b></p>
<p>
This constructor creates an instance of the class. There are no parameters.</p>
<p>
<b>CONSTRUCTORCdbRelation(const CdbRelation &amp;);</b></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b>Type</b></td>
<td class=label width=50%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=50%><b>const CdbRelation &amp;</b></td>
<td width=50%>Reference to an object.</td>
</tr>
</table><br>
<p>
This constructor creates a copy of the object referenced in the parameter.</p>
<p>
<b>CONSTRUCTORCdbRelation(DAORelation *</b><i>prl</i><b>,</b></p>
<p>
<b>BOOL </b><i>bAddRef </i><b>= FALSE);</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=24%><b>Type</b></td>
<td class=label width=24%><b>Argument</b></td>
<td class=label width=52%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=24%><b>DAORelation *</b></td>
<td width=24%><i>prl</i></td>
<td width=52%>A DAO Automation interface pointer corresponding to this DAO class.</td>
</tr>
<tr valign=top>
<td width=24%><b>BOOL</b></td>
<td width=24%><i>bAddRef</i><p>
=<b>FALSE</b></p>
</td>
<td width=52%>Optional. A <b>Boolean</b>. If <b>TRUE</b>, the DAO Automation interface <b>AddRef</b> function is called.</td>
</tr>
</table><br>
<p>
DAO functionality is presented through pointers to DAO Automation interfaces. This constructor makes a DAO interface available in the form of a DAO class object that provides additional functionality.</p>
<p>
This constructor is not required for typical use. It is provided to enable you to easily create a DAO class object if you have access to the corresponding DAO interface.</p>
<p>
When the destructor for the DAO object is invoked, the underlying Automation interface's <b>Release</b> member is called. If <b>Release</b> decrements the interface's reference count to zero, the pointer to the Automation interface can be deleted. If you don't want this to happen (for example, because you want to discard the DAO object, but continue using the Automation interface), specify <b>TRUE</b> for the second parameter. The underlying Automation interface's <b>AddRef</b> member is called, which counterbalances the eventual call to <b>Release</b>.</p>
</font></BODY>
</HTML>
