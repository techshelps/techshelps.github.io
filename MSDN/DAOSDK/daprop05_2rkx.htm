<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PartialReplica Property (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvpropartialreplica"></a>PartialReplica Property</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvproPartialReplicaC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvproPartialReplicaA">
</object></p>
<p>
Sets or returns a value on a <a href="dadobj05_4hbi.htm">CdbRelation</a> object indicating whether that relation should be considered when populating a partial replica from a full replica. (<a href="daglos02_23l1.htm">Microsoft Jet databases</a> only.)</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>VOIDSetPartialReplica(BOOL</b><i> bFlag</i><b>);</b></p>
<p>
<b>BOOLGetPartialReplica(VOID);</b></p>
<p class=label>
<b>Parameters</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=19%><b>Type</b></td>
<td class=label width=19%><b>Argument</b></td>
<td class=label width=62%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=19%><b>BOOL</b></td>
<td width=19%><i>bFlag</i></td>
<td width=62%><b>TRUE</b> when the relation should be enforced during synchronization.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
This property enables you to replicate data from the full replica to the partial replica based on relationships between tables. You can use the <b>PartialReplica</b> property when setting the <a href="daprop06_6cs2.htm">ReplicaFilter</a> property alone can't adequately specify what data should be replicated to the partial. For example, suppose you have a database in which the Customers table has a <a href="daglos03_01io.htm">one-to-many relationship</a> with the Orders table, and you want to configure a partial replica that only replicates orders from customers in the California region (instead of all orders). It is not possible to set the <b>ReplicaFilter</b> property on the Orders table to <code>Region = 'CA'</code> because the Region field is in the Customers table, not the Orders table.</p>
<p>
To replicate all orders from the California region, you must indicate that the relation between the Orders and Customers tables will be active during replication. Once you've created a partial replica, the following steps will populate it with all orders from the California region:
<ol>
<li>
Set the <b>ReplicaFilter</b> property on the Customers <a href="dadobj05_8086.htm">CdbTableDef</a> object to <code>"Region = 'CA'"</code>.<br><br></li>
<li>
Set the value of the <b>PartialReplica</b> property to <b>True</b> on the <b>CdbRelation</b> object corresponding to the relationship between Orders and Customers.<br><br></li>
<li>
Invoke the <a href="dameth05_89ws.htm">PopulatePartial</a> method.</li>
</ol>
<p class=indent>
<B><b>Caution</b></B> When you set a replica filter or replica relation, be aware that records in the partial replica that don't satisfy the restriction criteria will be removed from the partial replica, but not from the full replica. For example, suppose you set the <b>ReplicaFilter</b> property on the Customers <b>TableDef</b> in the partial replica to <code>"Region = 'CA'"</code> and you then repopulate the database. This will insert or update all records for California-based customers. If you then reset the <b>ReplicaFilter</b> property to <code>"Region = 'FL'"</code> and repopulate the database, all California region records in the partial replica will be removed, and all records from Florida-based customers will be inserted from the full replica. No records in the full replica will be deleted.</p>
<p class=indent>
Before setting either the <b>ReplicaFilter</b> or <b>PartialReplica</b> property, it's a good idea to synchronize the partial replica in which you are setting these properties with the full replica. This will ensure that pending changes in the partial replica will be merged into the full replica before any records are removed in the partial replica.</p>
</font></BODY>
</HTML>
