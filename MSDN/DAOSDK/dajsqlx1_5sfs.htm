<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PARAMETERS Declaration Example (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<p class=label>
<b><a name="dasqlparametersx"></a>PARAMETERS Declaration Example</b></p>
<p>
This example requires the user to provide a job title and then uses that job title as the criteria for the query.</p>
<p>
This example calls the EnumFields procedure, which you can find in the SELECT statement example.</p>
<pre><code>Sub ParametersX()

   Dim dbs As Database, qdf As QueryDef
   Dim rst As Recordset
   Dim strSql As String, strParm As String
   Dim strMessage As String
   Dim intCommand As Integer
   
   ' Modify this line to include the path to Northwind
   ' on your computer.
   Set dbs = OpenDatabase("NorthWind.mdb")
   
   ' Define the parameters clause.
   strParm = "<span class=cfe><b>PARAMETERS</b></span> [Employee Title] TEXT; "

   ' Define an SQL statement with the parameters
   ' clause.
   strSql = strParm &amp; "SELECT LastName, FirstName, " _
      &amp; "EmployeeID " _
      &amp; "FROM Employees " _
      &amp; "WHERE Title =[Employee Title];"
   
   ' Create a QueryDef object based on the 
   ' SQL statement.
   Set qdf = dbs.CreateQueryDef _
      ("Find Employees", strSql)
   
   Do While True
      strMessage = "Find Employees by Job " _
         &amp; "title:" &amp; Chr(13) _
         &amp; "&nbsp; Choose Job Title:" &amp; Chr(13) _
         &amp; " 1 - Sales Manager" &amp; Chr(13) _
         &amp; " 2 - Sales Representative" &amp; Chr(13) _
         &amp; " 3 - Inside Sales Coordinator"
      
      intCommand = Val(InputBox(strMessage))
      
      Select Case intCommand
         Case 1
            qdf("Employee Title") = _
               "Sales Manager"
         Case 2
            qdf("Employee Title") = _
               "Sales Representative"
         Case 3
            qdf("Employee Title") = _
               "Inside Sales Coordinator"
         Case Else
            Exit Do
      End Select
      
      ' Create a temporary snapshot-type Recordset.
      Set rst = qdf.OpenRecordset(dbOpenSnapshot)
      ' Populate the Recordset.
      rst.MoveLast
         
   ' Call EnumFields to print the contents of the 
   ' Recordset. Pass the Recordset object and desired
   ' field width.
      EnumFields rst, 12
   Loop
   
   ' Delete the QueryDef because this is a
   ' demonstration.
   dbs.QueryDefs.Delete "Find Employees"
   
   dbs.Close

End Sub
</code></pre>
</font></BODY>
</HTML>
