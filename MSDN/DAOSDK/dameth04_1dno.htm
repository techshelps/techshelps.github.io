<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetField, SetField Methods (dbDAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvmthgetfield"></a>GetField, SetField Methods</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthGetFieldC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthGetFieldX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthGetFieldA">
</object></p>
<p>
<b>GetField</b> returns the value of a <b>CdbField</b> (that is, a table column) in a <b>Recordset</b>. The <b>CdbField</b> is identified by either its name (that is, column name), or its index (that is, cardinal position in the row).</p>
<p class=label>
<b>Syntax: GetField</b></p>
<p>
<b>COleVariantGetField( LPCTSTR</b><i>pstrIndex</i><b> );</b></p>
<p>
<b>COleVariantGetField( CString &amp;</b><i>str</i><b> );</b></p>
<p>
<b>COleVariantGetField( LONG</b><i>lIndex</i><b> );</b></p>
<p>
<b>COleVariantGetField( COleVariant &amp;</b><i>vIndex</i><b> );</b></p>
<p class=label>
<b>Syntax: SetField</b></p>
<p>
<b>VOIDSetField( LPCTSTR </b><i>pstrIndex</i><b>, LPVARIANT </b><i>pv</i><b> );</b></p>
<p>
<b>VOIDSetField( CString &amp;</b><i>str</i><b>,LPVARIANT </b><i>pv</i><b> );</b></p>
<p>
<b>VOIDSetField( LONG </b><i>lIndex</i><b>, LPVARIANT </b><i>pv</i><b> );</b></p>
<p>
<b>VOIDSetField( COleVariant &amp;</b><i>vIndex</i><b>,LPVARIANT </b><i>pv</i><b> );</b></p>
<p class=label>
<b>Parameters</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=23%><b>Type</b></td>
<td class=label width=23%><b>Example</b></td>
<td class=label width=54%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=23%><b>LPCTSTR</b></td>
<td width=23%><i>pstrIndex</i></td>
<td width=54%>A pointer to a string that contains the name of the desired <b>CdbField</b>.</td>
</tr>
<tr valign=top>
<td width=23%><b>CString &amp;</b></td>
<td width=23%><i>str</i></td>
<td width=54%>A reference to a <b>CString</b> that contains the name of the desired <b>CdbField</b>.</td>
</tr>
<tr valign=top>
<td width=23%><b>LONG</b></td>
<td width=23%><i>lIndex</i></td>
<td width=54%>An integer that is the index of the desired <b>CdbField</b>, starting from the leftmost <b>CdbField</b> and counting from zero.</td>
</tr>
<tr valign=top>
<td width=23%><b>COleVariant &amp;</b></td>
<td width=23%><i>vIndex</i></td>
<td width=54%>A reference to a <b>COleVariant</b> with a value that is the index of the desired <b>CdbField</b>, starting from the leftmost <b>CdbField</b> and counting from zero, or a string containing the name of the <b>CdbField</b>.</td>
</tr>
<tr valign=top>
<td width=23%><b>LPVARIANT</b></td>
<td width=23%><i>pv</i></td>
<td width=54%>Pointer to a <b>COleVariant</b> whose value will be inserted into the specified <b>CdbField</b>.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
<b>GetField</b> and <b>SetField</b> are only available in dbDAO. They are provided as a more efficient way of getting or setting the value of a <b>CdbField</b>, other than accessing the <b>CdbRecordset</b> object's <b>Fields</b> collection, then using the <a href="daprop08_9u3p.htm">GetValue</a> or <a href="daprop08_9u3p.htm">SetValue</a> properties:</p>
<pre><code>COleVariant vValbyName, vValbyIndex;
vValbyName = recordset.Fields[_T(<i>"fieldname"</i>)].GetValue();
vValbyIndex = recordset.Fields[<i>index</i>].GetValue();

COleVariant    vName(_T("Smith"), VT_BSTRT),
            vValue(100, VT_I4);
...
recordset.Fields[_T("LastName")].SetValue(&amp;vName);
recordset.Fields[0L].SetValue(&amp;vValue);
</code></pre>
<p class=label>
<b>Usage: GetField</b></p>
<pre><code>#include &lt;afxole.h&gt;
#include &lt;dbdao.h&gt;

COleVariant vVal;
   // Initialize a recordset, etc.
   // Get the value of the 'LastName' field.
vVal = recordset.GetField(_T("LastName"));&nbsp; 
   // Get the value of the third field.       
vVal = recordset.GetField(2L);       
</code></pre>
<p class=label>
<b>Usage: SetField</b></p>
<pre><code>#include &lt;afxole.h&gt;
#include &lt;dbdao.h&gt;

COleVariant    vName(_T("Smith"), VT_BSTRT),
            vValue(100, VT_I4);
...
recordset.SetField(_T("LastName"), &amp;vName); // set the LastName field
recordset.SetField(0L, &amp;vValue);   // set the first field
</code></pre>
</font></BODY>
</HTML>
