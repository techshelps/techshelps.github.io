<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AppendChunk Method (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvmthappendchunk"></a>AppendChunk Method</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthAppendChunkC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthAppendChunkX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthAppendChunkA">
</object></p>
<p>
Appends data from a <a href="daglos04_8ur2.htm">string expression</a> to a <a href="daglos02_4sit.htm">Memo</a> or <a href="daglos02_11x5.htm">Long Binary</a> <a href="dadobj02_0cpw.htm">CdbField</a> object in a <a href="dadobj04_452s.htm">CdbRecordset</a>.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>VOIDAppendChunk(LPVARIANT </b><i>pv </i><b>);</b></p>
<p class=label>
<b>Parameters</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=21%><b>Type</b></td>
<td class=label width=20%><b>Argument</b></td>
<td class=label width=59%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=21%><b>LPVARIANT</b></td>
<td width=20%><i>pv</i></td>
<td width=59%>A pointer to a variant whose value will be appended to the <b>Fields</b> collection.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
You can use the <b>AppendChunk</b> and <a href="dameth04_8dwr.htm">GetChunk</a> methods to access subsets of data in a Memo or Long Binary field.</p>
<p>
You can also use these methods to conserve string space when you work with Memo and Long Binary fields. Certain operations (copying, for example) involve temporary strings. If string space is limited, you may need to work with chunks of a field instead of the entire field.</p>
<p>
If there is no <a href="daglos01_7wpw.htm">current record</a> when you use <b>AppendChunk</b>, an error occurs.</p>
<p class=label>
<b>Notes</b>
<ul type=disc>
<li>
The initial <b>AppendChunk</b> operation (after an <a href="dameth03_5fzo.htm">Edit</a> or <a href="dameth01_4uuv.htm">AddNew</a> call) will simply place the data in the field, overwriting any existing data. Subsequent <b>AppendChunk</b> calls within the same <b>Edit</b> or <b>AddNew</b> session will then add to the existing data.<br><br></li>
<li>
In an <a href="daglos03_4o11.htm">ODBCDirect workspace</a>, unless you first edit another field in the current record, using <b>AppendChunk</b> will fail (though no error occurs) while you are in <b>Edit</b> mode.<br><br></li>
<li>
In an ODBCDirect workspace, after you use <b>AppendChunk </b>on a field, you cannot read or write that field in an assignment statement until you move off the current record and then return to it. You can do this by using the <a href="dameth04_5rn8.htm">MoveNext</a> and <a href="dameth04_5rn8.htm">MovePrevious</a> methods.</li>
</ul>
<p class=label>
<b>Usage</b></p>
<pre><code>#include &lt;afxole.h&gt;
#include &lt;dbdao.h&gt;

CdbRecordset      rs;
CdbField         fld;
COleVariant      vVal("abcdefghijklmnop", VT_BSTRT);
...                     // Initialize recordset, etc.
fld = rs.Fields[0];         // Get a field.
fld.AppendChunk(&amp;vVal);    // Append the chunk.
</code></pre>
</font></BODY>
</HTML>
