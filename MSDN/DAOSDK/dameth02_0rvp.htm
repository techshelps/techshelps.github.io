<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CreateDatabase Method (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvmthcreatedatabase"></a>CreateDatabase Method</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthCreateDatabaseC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthCreateDatabaseX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthCreateDatabaseA">
</object></p>
<p>
Creates a new <a href="dadobj01_4mud.htm">CdbDatabase</a> object, saves the database to disk, and returns an opened <b>CdbDatabase</b> object (<a href="daglos02_60it.htm">Microsoft Jet workspaces</a> only).</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>CdbDatabaseCreateDatabase(LPCTSTR </b><i>pstrName</i><b>,</b></p>
<p>
<b>LPCTSTR </b><i>pstrConnect</i><b>,</b></p>
<p>
<b>LONG </b><i>lOptions </i><b>= -1);</b></p>
<p class=label>
<b>Parameters</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=19%><b>Type</b></td>
<td class=label width=22%><b>Argument</b></td>
<td class=label width=59%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=19%><b>LPCTSTR</b></td>
<td width=22%><i>pstrName</i></td>
<td width=59%>A pointer to a string up to 255 characters long that is the name of the database file that you're creating. It can be the full path and file name, such as "C:\db1.mdb". If you don't supply a file name extension, .mdb is appended. If your network supports it, you can also specify a network path, such as "\\server1\share1\dir1\db1". You can only create .mdb database files with this method.</td>
</tr>
<tr valign=top>
<td width=19%><b>LPCTSTR</b></td>
<td width=22%><i>pstrConnect</i></td>
<td width=59%>A pointer to a string that specifies various connection information, including the collating order for text strings and a password.<p>
You can create a password for the new <b>Database</b> object by concatenating the password string (starting with <code>";pwd="</code>) with a constant, for example:</p>
<p>
<code>dbLangSpanish &amp; ";pwd=Password"</code></p>
<p>
If you want to use the default collating order, but specify a password, simply enter a password string for this argument:</p>
<p>
<code>";pwd=Password"</code></p>
</td>
</tr>
<tr valign=top>
<td width=19%><b>LONG</b></td>
<td width=22%><i>lOptions</i></td>
<td width=59%>Optional. A constant or combination of constants that indicates one or more options. See Settings for details.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
You can concatenate one of the following constants in the <i>pstrConnect</i> argument to specify the <a href="daprop02_2g8i.htm">CollatingOrder</a> for string comparisons of text in the database.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b>Constant</b></td>
<td class=label width=50%><b>Collating order</b></td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangGeneral</b></td>
<td width=50%>English, German, French, Portuguese, Italian, and Modern Spanish</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangArabic</b></td>
<td width=50%>Arabic</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangChineseSimplified</b></td>
<td width=50%>Simplified Chinese</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangChineseTraditional</b></td>
<td width=50%>Traditional Chinese</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangCyrillic</b></td>
<td width=50%>Russian</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangCzech</b></td>
<td width=50%>Czech</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangDutch</b></td>
<td width=50%>Dutch</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangGreek</b></td>
<td width=50%>Greek</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangHebrew</b></td>
<td width=50%>Hebrew</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangHungarian</b></td>
<td width=50%>Hungarian</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangIcelandic</b></td>
<td width=50%>Icelandic</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangJapanese</b></td>
<td width=50%>Japanese</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangKorean</b></td>
<td width=50%>Korean</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangNordic</b></td>
<td width=50%>Nordic languages (Microsoft Jet database engine version 1.0 only)</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangNorwDan</b></td>
<td width=50%>Norwegian and Danish</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangPolish</b></td>
<td width=50%>Polish</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangSlovenian</b></td>
<td width=50%>Slovenian</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangSpanish</b></td>
<td width=50%>Traditional Spanish</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangSwedFin</b></td>
<td width=50%>Swedish and Finnish</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangThai</b></td>
<td width=50%>Thai</td>
</tr>
<tr valign=top>
<td width=50%><b>dbLangTurkish</b></td>
<td width=50%>Turkish</td>
</tr>
</table><br>
<p>
You can use one or more of the following constants in the <i>lOptions</i> argument to specify which version the data format should have and whether or not to encrypt the database.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=28%><b>Constant</b></td>
<td class=label width=72%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=28%><b>dbEncrypt</b></td>
<td width=72%>Creates an encrypted database.</td>
</tr>
<tr valign=top>
<td width=28%><b>DbVersion10</b></td>
<td width=72%>Creates a database that uses the <a href="daglos02_0elh.htm">Microsoft Jet database engine</a> version 1.0 file format.</td>
</tr>
<tr valign=top>
<td width=28%><b>DbVersion11</b></td>
<td width=72%>Creates a database that uses the Microsoft Jet database engine version 1.1 file format.</td>
</tr>
<tr valign=top>
<td width=28%><b>DbVersion20</b></td>
<td width=72%>Creates a database that uses the Microsoft Jet database engine version 2.0 file format.</td>
</tr>
<tr valign=top>
<td width=28%><b>DbVersion30</b></td>
<td width=72%>(Default) Creates a database that uses the Microsoft Jet database engine version 3.0 file format (compatible with version 3.5).</td>
</tr>
</table><br>
<p>
If you omit the encryption constant, <b>CreateDatabase</b> creates an un-encrypted database. You can specify only one version constant. If you omit a version constant, <b>CreateDatabase</b> creates a database that uses the Microsoft Jet database engine version 3.0 file format.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Use the <b>CreateDatabase</b> method to create and open a new, empty database, and return the <b>CdbDatabase</b> object. You must complete its structure and content by using additional <a href="daglos01_7lis.htm">DAO objects</a>. If you want to make a partial or complete copy of an existing database, you can use the <a href="dameth02_7605.htm">CompactDatabase</a> method to make a copy that you can customize.</p>
<p class=label>
<b>Usage</b></p>
<pre><code>#include &lt;afxole.h&gt;
#include &lt;dbdao.h&gt;

CdbDBEngine      dben;
CdbWorkspace      wrkDefault;
CdbDatabase      dbsNew;

wrkDefault = dben.Workspaces(0L);
/* Create a new encrypted database with the specified 
   (dbLangGeneral) collating order.
*/
dbsNew = wrkDefault.CreateDatabase(_T("NewDB.mdb"),
                                 dbLangGeneral, dbEncrypt);
...
dbsNew.Close();
</code></pre>
</font></BODY>
</HTML>
