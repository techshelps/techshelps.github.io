<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Calculating Fields in SQL Functions</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dasqlcalculatingfields"></a>Calculating Fields in SQL Functions</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dasqlCalculatingFieldsC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dasqlCalculatingFieldsX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="daSQLCalculatingFieldsS">
</object> </p>
<p>
You can use the <a href="daglos04_8ur2.htm">string expression</a> argument in an <a href="dajsql04_3i43.htm">SQL aggregate function</a> to perform a calculation on values in a field. For example, you could calculate a percentage (such as a surcharge or sales tax) by multiplying a field value by a fraction.</p>
<p>
The following table provides examples of calculations on fields from the Orders and Order Details tables in the Northwind.mdb database.</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=50%><b>Calculation</b></td>
<td class=label width=50%><b>Example</b></td>
</tr>
<tr valign=top>
<td width=50%>Add a number to a field</td>
<td width=50%><code>Freight + 5</code></td>
</tr>
<tr valign=top>
<td width=50%>Subtract a number from a field</td>
<td width=50%><code>Freight - 5</code></td>
</tr>
<tr valign=top>
<td width=50%>Multiply a field by a number</td>
<td width=50%><code>UnitPrice * 2</code></td>
</tr>
<tr valign=top>
<td width=50%>Divide a field by a number</td>
<td width=50%><code>Freight / 2</code></td>
</tr>
<tr valign=top>
<td width=50%>Add one field to another</td>
<td width=50%><code>UnitsInStock + UnitsOnOrder</code></td>
</tr>
<tr valign=top>
<td width=50%>Subtract one field from another</td>
<td width=50%><code>ReorderLevel - UnitsInStock</code></td>
</tr>
</table><br>
<p>
The following example calculates the average discount amount of all orders in the Northwind.mdb database. It multiplies the values in the UnitPrice and Discount fields to determine the discount amount of each order and then calculates the average. You can use this expression in an <a href="daglos04_188k.htm">SQL statement</a> in Visual Basic code:</p>
<pre><code>SELECT Avg(UnitPrice * Discount) AS [Average Discount] FROM [Order Details];
</code></pre>
</font></BODY>
</HTML>
