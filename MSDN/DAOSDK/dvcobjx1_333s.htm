<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Group Object, Groups Collection and User Object, Users Collection Example (VC++)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="daobjgroupx"></a>Group Object, Groups Collection and User Object, Users Collection Example (VC++)</h1>
<p>
This example illustrates the use of the <b>Group</b> and <b>User</b> objects and the <b>Groups</b> and <b>Users</b> collections. First, it creates a new <b>User</b> object with the <b>Name</b>, <b>PID</b>, and <b>Password</b> property settings of "Pat Smith", "abc123DEF456", and "My Secret" and appends the object to the <b>Users</b> collection of the default <b>Workspace</b> object. Next, it creates a new <b>Group</b> object with the <b>Name</b> and <b>PID</b> property settings of "Accounting" and "UVW987xyz654" and appends the object to the <b>Groups</b> collection of the default <b>Workspace</b> object. Then the example adds user Pat Smith to the Accounting group. Finally, it enumerates the <b>User</b> and <b>Group</b> objects in the collections of the default <b>Workspace</b> object. See the methods and properties listed in the <b>Group</b> and <b>User</b> summary topics for additional examples.</p>
<pre><code>CdbDBEngine         dbeng;
CdbWorkspace      wrkDefault;
CdbUser            usrTemp;
CdbGroup         grpTemp; 
long            intI, intJ;

wrkDefault = dbeng.Workspaces[0L];

// Enumerate all users.
for (intJ = 0; intJ &lt; wrkDefault.Users.GetCount(); intJ++)
   {
   usrTemp = wrkDefault.Users[intJ];
   printf(_T("Enumeration of User: %s\n\n"), usrTemp.GetName());

   // Enumerate groups.
   printf(_T("   Groups: \n"));
   for (intI = 0; intI &lt; usrTemp.Groups.GetCount(); intI++)
      printf(_T("   %s\n"), usrTemp.Groups[intI].GetName());
   }
// Enumerate all groups.
printf(_T("\n------------------------------------\n\n"));
for (intJ = 0; intJ &lt; wrkDefault.Groups.GetCount(); intJ++)
   {
   grpTemp = wrkDefault.Groups[intJ];
   printf("Enumeration of Groups: %s\n", grpTemp.GetName());
   // Enumerate users.
   printf(_T("   Users: \n"));
   for (intI = 0; intI &lt; grpTemp.Users.GetCount(); intI++)
      printf(_T("   %s\n"), grpTemp.Users[intI].GetName());
   }
</code></pre>
</font></BODY>
</HTML>
