<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RepairDatabase Method (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvmthrepairdatabase"></a>RepairDatabase Method</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthRepairDatabaseC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthRepairDatabaseX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvmthRepairDatabaseA">
</object></p>
<p>
Attempts to repair a corrupted <a href="daglos02_23l1.htm">Microsoft Jet database</a> (<a href="daglos02_23l1.htm">Microsoft Jet databases</a> only).</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>VOIDRepairDatabase(LPCTSTR </b><i>pstrDatabase</i><b> );</b></p>
<p class=label>
<b>Parameters</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=587>
<tr valign=top>
<td class=label width=17%><b>Type</b></td>
<td class=label width=24%><b>Argument</b></td>
<td class=label width=59%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=17%><b>LPCTSTR</b></td>
<td width=24%><i>pstrDatabase</i></td>
<td width=59%>A pointer to a string that contains the path and file name of an existing Microsoft Jet database file. If you omit the path, only the current directory is searched. If your system supports the uniform naming convention (UNC), you can also specify a network path, such as "\\server1\share1\dir1\db1.mdb".</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
You must close the database specified by <i>pstrDatabase</i> before you repair it. In a multiuser environment, other users can't have <i>pstrDatabase</i> open while you're repairing it. If <i>pstrDatabase</i> isn't closed or isn't available for <a href="daglos02_5wit.htm">exclusive</a> use, an error occurs.</p>
<p>
This method attempts to repair a database that was marked as possibly corrupt by an incomplete write operation. This can occur if an application using the Microsoft Jet database engine is closed unexpectedly because of a power outage or computer hardware problem. The database won't be marked as possibly corrupt if you use the <a href="dameth02_4pt1.htm">Close</a> method or if you quit your application in a usual way.</p>
<p>
The <b>RepairDatabase</b> method also attempts to validate all system tables and all indexes. Any data that can't be repaired is discarded. If the database can't be repaired, a run-time error occurs.</p>
<p>
When you attempt to open or compact a corrupted database, a run-time error usually occurs. In some situations, however, a corrupted database may not be detected, and no error occurs. It's a good idea to provide your users with a way to use the <b>RepairDatabase</b> method in your application if their database behaves unpredictably.</p>
<p>
Some types of databases can become corrupted if a user ends an application without closing <b>CdbDatabase</b> or <b>CdbRecordset </b>objects<b> </b>and the Microsoft Jet database engine; Microsoft Windows doesn't have a chance to write data caches to disk. To avoid corrupt databases, establish procedures for closing applications and shutting down systems that ensure that all cached pages are saved to the database. In some cases, power supplies that can't be interrupted may be necessary to prevent accidental data loss during power fluctuations.</p>
<p class=indent>
<B><b>Note</b></B> After repairing a database, it's also a good idea to compact it using the <a href="dameth02_7605.htm">CompactDatabase</a> method to defragment the file and to recover disk space.</p>
<p class=label>
<b>Usage</b></p>
<pre><code>#include &lt;afxole.h&gt;
#include &lt;dbdao.h&gt;
CdbDBEngine   dben;
...                     // Attempt to repair a local database
dben.RepairDatabase(_T("db1.mdb"));&nbsp; 
</code></pre>
</font></BODY>
</HTML>
