<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>KeepLocal Property (DAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvprokeeplocal"></a>KeepLocal Property</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvproKeepLocalC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="dvproKeepLocalA">
</object></p>
<p>
Sets or returns a value on a table, query, form, report, macro, or module that you do not want to replicate when the database is replicated (<a href="daglos02_60it.htm">Microsoft Jet workspaces</a> only).</p>
<p class=indent>
<B><b>Note</b></B> Before getting or setting the <b>KeepLocal</b> property on a <a href="dadobj01_6pys.htm">CdbDocument</a>, <a href="dadobj05_8086.htm">CdbTableDef</a>, or <a href="dadobj03_6zdy.htm">CdbQueryDef</a><b> </b>object, you must create it by using the <a href="dameth02_24mx.htm">CreateProperty</a> method and append it to the <a href="dadobj03_6aux.htm">Properties</a> collection for the object.</p>
<p class=label>
<b>Syntax</b></p>
<p>
There is no member function to explicitly access this property. See Usage below for an example of how this property is managed.</p>
<p class=label>
<b>Remarks</b></p>
<p>
If you set this property to <code>"T",</code> the object will remain local when the database is replicated. You can't use the <b>KeepLocal</b> property on objects after they have been replicated.</p>
<p>
Once you set the <b>KeepLocal</b> property, it will appear in the <b>Properties</b> collection for the object.</p>
<p>
Before setting the <b>KeepLocal </b>property, you should check the value of the <a href="daprop06_2u05.htm">Replicable</a> property.</p>
<p>
After you make a database replicable, all new objects created within the <a href="daglos01_0zoy.htm">Design Master</a>, or in any other <a href="daglos03_9b4x.htm">replicas</a> in the set, are <a href="daglos02_23as.htm">local objects</a>. Local objects remain in the replica in which they're created and aren't copied throughout the <a href="daglos03_0alw.htm">replica set</a>. Each time you make a new replica in the set, the new replica contains all the replicable objects from the source replica, but none of the local objects from the source replica.</p>
<p>
If you create a new object in a replica and want to change it from local to replicable so that all users can use it, you can either create it in, or import it into, the Design Master. Be sure to delete the local object from any replicas; otherwise, you will encounter a design error. After the object is part of the Design Master, set the object's <b>Replicable</b> property to <b>True</b>.</p>
<p>
The object on which you are setting the <b>KeepLocal</b> property might have already inherited that property from another object. However, the value set by the other object has no effect on the behavior of the object you want to keep local. You must explicitly set the property for each object.</p>
<p class=label>
<b>Usage</b></p>
<pre><code>...
CdbDBEngine      engine;
CdbProperty      prp;
CdbQueryDef      qdf;
COleVariant      vTrue(_T("T"));
...      
// Initialize engine, queryDef, etc.
prp = qdf.CreateProperty(
            _T("Replicable"), dbText, &amp;vTrue);
qdf.Properties.Append( prp );
...
prp = qdf.Properties[_T("Replicable")];
if (prp.GetValue() == vTrue) 
   {
   prp = qdf.CreateProperty(
            _T("KeepLocal"), dbText, &amp;vTrue);
   qdf.Properties.Append( prp );
   }
...</code></pre>
</font></BODY>
</HTML>
