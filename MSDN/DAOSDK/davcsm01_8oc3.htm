<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CompactDatabase Method (dbDAO)</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dvmthcompactdatabases"></a>CdbDBEngine::CompactDatabase Method</h1>
<p>
Copies and compacts a closed database, and gives you the option of changing its version, collating order, and encryption (Microsoft Jet workspaces only).</p>
<p class=label>
<b>Syntax</b></p>
<p>
VOIDCompactDatabase(LPCTSTR pstrOldDatabase,</p>
<p>
LPCTSTR pstrNewDatabase,</p>
<p>
LPCTSTR pstrDstConnect = NULL,</p>
<p>
LONG lOptions=-1,</p>
<p>
LPCTSTR pstrSrcConnect = NULL);</p>
<p class=label>
<b>Parameters</b></p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows width=563>
<tr valign=top>
<td class=label width=20%><b>Type</b></td>
<td class=label width=27%><b>Example</b></td>
<td class=label width=53%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=20%>LPCTSTR</td>
<td width=27%>pstrOldDatabase</td>
<td width=53%>A pointer to a string that identifies an existing, closed database. It can be a full path and file name, such as "C:\db1.mdb". If the file name has an extension, you must specify it. If your network supports it, you can also specify a network path, such as "\\server1\share1\dir1\db1.mdb".</td>
</tr>
<tr valign=top>
<td width=20%>LPCTSTR</td>
<td width=27%>pstrNewDatabase</td>
<td width=53%>A pointer to a string that is the file name (and path) of the compacted database that you're creating. You can also specify a network path. You can't use the <i>NewDatabase</i> argument to specify the same database file as <i>OldDatabase</i>.</td>
</tr>
<tr valign=top>
<td width=20%>LPCTSTR</td>
<td width=27%>pstrDstConnect</td>
<td width=53%>Optional. A pointer to a string composed of zero or more parameters separated by semicolons. This parameter is used to pass additional information to the destination database as needed. For example, collating order is specified here.</td>
</tr>
<tr valign=top>
<td width=20%>LONG</td>
<td width=27%>IOptions</td>
<td width=53%>Optional. A constant or combination of constants that indicates one or more options. The options specify the version of its data format and whether the new compacted database should be encrypted.</td>
</tr>
<tr valign=top>
<td width=20%>LPCTSTR</td>
<td width=27%>pstrSrcConnect</td>
<td width=53%>Optional. A pointer to a string composed of zero or more parameters separated by semicolons. This parameter is used to pass additional information from the source as needed.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
All users must close the database before you compact it. If the database isn't closed or isn't available for exclusive use, an error occurs.</p>
<p class=label>
<b>Usage</b></p>
<pre><code>#include &lt;afxole.h&gt;
#include &lt;dbdao.h&gt;
...
CdbDBEngine   dben;
...
dben.CompactDatabase(   _T("Northwind.mdb"), _T("Nwind2.mdb"),
                     dbLangGeneral, // This is really a string.
                     dbVersion30);
</code></pre>
</font></BODY>
</HTML>
