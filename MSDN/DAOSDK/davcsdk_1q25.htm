<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the Supplied Install Program</title>
<link disabled rel=stylesheet href=msdn_ie3.css>
<style type="text/css">
@import url(msdn_ie4.css);
</style>
</HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->


<h1><a name="dahowusingsuppliedinstallprogram"></a>Using the Supplied Install Program</h1>
<p>
As shipped with Microsoft Visual C++ 5.0, the DAO SDK is divided into four subdirectories labeled <b>disk1</b> through <b>disk5</b>. This setup has been structured so that you can take the parts you need and use them directly with no recompilation required. In particular, two options are available for redistribution:
<ul type=disc>
<li>
Install DAO runtime with all data file formats (for example, Xbase and Excel)<br><br></li>
<li>
Install DAO runtime with Jet MDB support only (version 3.x)</li>
</ul>
<p>
To enable these options, you need to replace the Setup.iss and Setup.pkg files that are found in <b>disk1</b>. A set of alternate replacement files are provided in the <b>disk1</b> directory called Daomin.iss/Pkg/Ins (note the third file in this case). The Daomin files will install DAO with the ability to read Microsoft Jet 3.x databases only. In addition to replacing the ISS and PKG files, you will need to make sure that the appropriate compressed files are also available.</p>
<h1>Assembling the Files</h1>
<p>
The DAOMIN installation requires the following files:
<ul type=disc>
<li>
Setup.pkg<br><br></li>
<li>
Setup.iss<br><br></li>
<li>
Setup.ins (all three renamed from Daomin.*)<br><br></li>
<li>
Disk1.id<br><br></li>
<li>
Setup.exe<br><br></li>
<li>
Uninst.exe<br><br></li>
<li>
_Setup.lib<br><br></li>
<li>
_Setup.dll<br><br></li>
<li>
Daocore.1<br><br></li>
<li>
Daocore.2</li>
</ul>
<p>
If you are distributing over a network, CD-ROM, or some other media format large enough to put all of the files into one directory, then you can simply place all the files in one directory and invoke Setup from that location. If you are distributing on 1.44 MB floppies, then take care to group the files the same way that they are grouped in the \Daosdk\Disk directories on your distribution CD-ROM; for example, DISK2 should include Daocore.2 and Jetisam.z. You will also need to add the file Disk2.id to your second disk.</p>
<p class=indent>
<B><b>Note</b></B> If you alter how the files are grouped across directories and/or disks, you must supply a new InstallShield packing list (.pkg) file. See the InstallShield documentation for details on how to do this.</p>
<h1>Executing Setup</h1>
<p>
Neither of the options outlined above require any input from the user. Execute the DAO Setup program with the following command line:</p>
<pre><code>setup -s
</code></pre>
<p>
This will silently install DAO with no visual feedback, unless another disk is required. If you omit the <b>-s</b> flag, the DAO Setup introductory screen will be displayed until the user chooses <b>Next</b>, which will start copying files.</p>
<p>
If you are invoking setup from another program, you can check the status of the install two ways.</p>
<p>
The first way is to check the return code of the Setup.exe call. This will tell you whether Setup.exe successfully <i>began</i> the installation process. However, since the setup happens in the background, the call will actually return before the setup is complete.</p>
<p>
A second, more robust technique is to invoke setup with the command line:</p>
<pre><code>setup -s -f2c:\somefile.log
</code></pre>
<p>
The <b>-f2</b> option forces a log file to be written to the location specified. By examining the log file, your program can determine if the setup has completed successfully by searching for the string “ResultCode=0”.</p>
<p class=indent>
<B><b>Note</b></B> InstallShield in silent mode <i>must</i> write a log file. If you omit the <code>-f</code> option, it will try to create a log file in the default directory which often is a read-only diskette.</p>
</font></BODY>
</HTML>
