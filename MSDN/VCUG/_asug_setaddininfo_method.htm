<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetAddInInfo Method</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<h1><a name="_asug_setaddininfo_method"></a>SetAddInInfo Method</h1>
<p>
<a href="_asug_home_page.3a_.developer_studio_objects.htm">Home Page (Objects)</a>  |&nbsp; <a href="_asug_overview.3a_.developer_studio_objects.htm">Overview</a>  |&nbsp; <a href="_asug_frequently_asked_questions.3a_.developer_studio_objects.htm">FAQ</a>  |&nbsp; <a href="_asug_reference.3a_.developer_studio_objects.htm">Reference</a></p>
<p>
Applies to: <a href="_asug_application_object.htm">Application</a> object</p>
<p>
Provides Developer Studio with information about an <a href="_asug_overview.3a_.developer_studio_add.2d.ins.htm">add-in</a>, when the add-in is loaded. The add-in calls <b>SetAddInInfo</b>.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<i>object</i><b>.SetAddInInfo</b> <i>Hinstance</i><b>,</b> <i>CmdDispatch</i><b>,</b> <i>BitmapResourceMedium</i><b>,</b> <i>BitmapResourceLarge</i><b>,</b> <i>cookie</i></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>object</i></p>
<p class=indent>
An expression that evaluates to an <b>Application</b> object. When you use the <b>SetAddInInfo</b> method of the <b>Application</b> object, you can omit <i>object</i> because the name of the <b>Application</b> object is implied when you access its properties and methods.</p>
<p class=dt>
<i>Hinstance</i></p>
<p class=indent>
The <b>HINSTANCE</b> of the add-in's DLL, casted to a <b>Long</b>. If you create the add-in using Visual Basic, you can access this with the <b>App</b> object <b>App.HInstance</b>.</p>
<p class=dt>
<i>CmdDispatch</i></p>
<p class=indent>
The pointer to the dispatch interface (dispinterface) implemented by the add-in's <a href="_asug_how_add.2d.ins_connect_and_disconnect.htm#_asug_the_commands_object">Commands</a> object. When a user chooses one of the add-in's commands, Developer Studio invokes the command by using this pointer to communicate with the add-in.</p>
<p class=dt>
<i>BitmapResourceMedium</i></p>
<p class=indent>
A <b>Long</b> that is the ID of the bitmap resource containing medium-sized images of all toolbar buttons that the add-in is adding. Specify <b>-1</b> if the add-in does not provide toolbar buttons.</p>
<p class=dt>
<i>BitmapResourceLarge</i></p>
<p class=indent>
A <b>Long</b> that is the ID of the bitmap resource containing large-sized images of all toolbar buttons that the add-in is adding. Specify <b>-1</b> if the add-in does not provide toolbar buttons.</p>
<p class=dt>
<i>cookie</i></p>
<p class=indent>
A <b>Long</b> that is the cookie identifying the add-in. Developer Studio passes this value to the add-in through the add-in's <a href="_asug_how_add.2d.ins_connect_and_disconnect.htm">OnConnection</a> method.</p>
<p class=label>
<b>Remarks</b></p>
<p>
Only add-ins can call the <b>SetAddInInfo</b> method. <a href="_asug_overview.3a_.vbscript_macros.htm">VBSscript macros</a> cannot.</p>
<p class=label>
<b>Example</b></p>
<p>
The following example, which is written in Visual C++, is the code automatically generated when you create an add-in using the Developer Studio Add-in Wizard:</p>
<pre><code>STDMETHODIMP CDSAddIn::OnConnection(IApplication* pApp, VARIANT_BOOL bFirstTime,
 &nbsp;&nbsp;&nbsp;&nbsp; long dwCookie, VARIANT_BOOL* OnConnection)
{
...
 &nbsp; pApplication-&gt;SetAddInInfo((long) AfxGetInstanceHandle(),
 &nbsp;&nbsp;&nbsp;&nbsp; (LPDISPATCH) m_pCommands, IDR_TOOLBAR_MEDIUM, IDR_TOOLBAR_LARGE, m_dwCookie);
...
}
</code></pre>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_asug_addcommand_method.htm">AddCommand</a> method, <a href="_asug_addcommandbarbutton_method.htm">AddCommandBarButton</a> method, <a href="_asug_addkeybinding_method.htm">AddKeybinding</a> method, <a href="_asug_enablemodeless_method.htm">EnableModeless</a> method.</p>
</FONT></BODY>
</HTML>
