<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding and Removing Files from Projects</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<h1><a name="_asug_adding_and_removing_files_from_projects"></a>Adding and Removing Files from Projects</h1>
<p>
<a href="_asug_home_page.3a_.working_with_projects.htm">Home Page (Projects)</a>  |&nbsp; <a href="_asug_overview.3a_.working_with_projects.htm">Overviews</a>  |&nbsp; <a href="_asug_how_do_i......_topics.3a_.working_with_projects.htm">How Do I... Topics</a>  |&nbsp; <a href="_asug_overview.3a_.nmake_reference.htm">NMAKE Reference</a></p>
<p>
When you add a file to a project, you add the file to all configurations for that project. For instance, if you have a project named MyProject, with Debug and Release configurations, adding a file adds it to both those project configurations.</p>
<p>
If you add files from directories on a different drive than the project, Visual C++ uses absolute paths in the filenames for those files in the project's .dsp file. Because of the absolute paths, it is difficult to share the project (.dsp) file. Other developers in your group may have other drive names.</p>
<p>
To support sharing files outside the project directory, you can use the <b>Persist As</b> field in the source file's property page. In the <b>Persist As</b> field, put in a replacement path for the file that will be persisted ("preserved") in the project file. </p>
<p>
For example:
<ol>
<li>
Add a file, c:\basefiles\mybase.cpp, to your project, where your project is located at c:\myproject\project1. <br><br></li>
<li>
Use the <b>Persist As</b> field in either of two ways: <ul type=disc>
<li>
In the <b>Persist As</b> field, change the string "c:\basefiles\mybase.cpp" to "..\..\basefiles\mybase.cpp."<p class=tl>
This requires all users of the project to maintain the same directory structure that you use for the project.</P></li>
</ul>
<p class=tl>
-or-</P><ul type=disc>
<li>
Define an environmental variable, such as "BASEFILES," that contains "c:\basefiles" on the user's machine, and change the string in the <b>Persist As</b> field from "c:\basefiles\mybase.cpp" to "$(BASEFILES)\mybase.cpp."</li>
</ul>
</li>
</ol>
<p class=indent>
Note: The NMAKE utility requires that you use upper case for the environment variable names.</p>
<h3>What do you want to do?</h3>
<p>
<a href="#_asug_add_files_to_a_project">Add files to a project</a></p>
<p>
<a href="#_asug_move_or_copy_files_from_one_project_workspace_to_another">Move or copy files from one project to another</a></p>
<p>
<a href="#_asug_remove_files_from_a_project">Remove files from a project</a></p>
<p class=label>
<b><a name="_asug_add_files_to_a_project"></a>To add files to a project</b>
<ol>
<li>
Open the project to which you want to add files.<br><br></li>
<li>
On the <b>Project </b>menu, click <b>Add To Project</b>, and then click <b>Files</b>.<br><br></li>
<li>
In the <b>Files of type</b> box, specify the type of files to add.<br><br></li>
<li>
Select one or more files.<br><br></li>
<li>
Click <b>OK</b>.</li>
</ol>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;You can also use the shortcut menu from <b>FileView</b> to add files more quickly. </p>
<p class=label>
<b><a name="_asug_move_or_copy_files_from_one_project_workspace_to_another"></a>To move or copy files from one workspace to another</b>
<ol>
<li>
From the <b>FileView</b> pane, select the files that you want to move or copy.<br><br></li>
<li>
On the <b>Edit </b>menu, click <b>Cut </b>if you want to move the files, or <b>Copy </b>if you want to copy the files.<br><br></li>
<li>
Close the current project workspace.<br><br></li>
<li>
Open the destination project workspace.<br><br></li>
<li>
Select the project to receive the files.<br><br></li>
<li>
On the <b>Edit </b>menu, click <b>Paste</b>.</li>
</ol>
<p class=label>
<b><a name="_asug_remove_files_from_a_project"></a>To remove files from a project</b>
<ol>
<li>
From the <b>FileView</b> pane, select the files that you want to remove.<br><br></li>
<li>
On the <b>Edit</b> menu, click <b>Delete</b>.</li>
</ol>
</FONT></BODY>
</HTML>
