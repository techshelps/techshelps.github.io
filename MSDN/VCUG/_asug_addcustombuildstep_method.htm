<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AddCustomBuildStep Method</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<h1><a name="_asug_addcustombuildstep_method"></a>AddCustomBuildStep Method</h1>
<p>
<a href="_asug_home_page.3a_.developer_studio_objects.htm">Home Page (Objects)</a>  |&nbsp; <a href="_asug_overview.3a_.developer_studio_objects.htm">Overview</a>  |&nbsp; <a href="_asug_frequently_asked_questions.3a_.developer_studio_objects.htm">FAQ</a>  |&nbsp; <a href="_asug_reference.3a_.developer_studio_objects.htm">Reference</a></p>
<p>
Applies to: <a href="_asug_configuration_object.htm">Configuration</a> object</p>
<p>
Adds a custom build step to a specified configuration.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<i>object</i><b>.AddCustomBuildStep</b> <b>(</b> <i>command</i><b>,</b><i> output</i><b>,</b><i> description </i><b>)</b></p>
<p class=label>
<b>Parameters</b></p>
<p class=dt>
<i>object</i></p>
<p class=indent>
An expression that evaluates to a <b>Configuration</b> object.</p>
<p class=dt>
<i>command</i></p>
<p class=indent>
A <b>String</b> containing commands that you want to execute after building the specified configuration. These commands correspond to those in the <b>Build Commands(s)</b> list on the <b>Custom Build</b> tab of the <b>Project Settings</b> dialog box (Project menu, Settings command) and are separated by commas.</p>
<p class=dt>
<i>output</i></p>
<p class=indent>
A <b>String </b>specifying the files you want to create from this custom build step. These files correspond to those in the <b>Outputs</b> list on the <b>Custom Build</b> tab of the <b>Project Settings</b> dialog box (Project menu, Settings command). Each file name is separated by a newline character. (In VBScript use Chr(10) to represent a newline character.)</p>
<p class=dt>
<i>description</i></p>
<p class=indent>
A <b>String</b> describing the purpose of this build step. This corresponds to the <b>Description </b>box on the <b>Custom Build</b> tab of the <b>Project Settings</b> dialog box (Project menu, Settings command) .</p>
<p class=label>
<b>Remarks</b></p>
<p>
The <b>AddCustomBuildStep</b> method runs after the specified configuration is built and applies to the entire configuration, not to a single file in the configuration.</p>
<p>
<B><b>Tip</b></B>&nbsp;&nbsp;&nbsp;If you have a makefile project, you can also use this method to set the command line. If you are using this approach and you specify more than one command line or more than one output file, then only the first will be used. When using AddCustomBuildStep() on a makefile project, "command" becomes the command, "output" becomes the output, and "description" becomes the "rebuild all option."</p>
<p class=label>
<b>Example</b></p>
<p>
The following example includes a build step that copies an executable from a project's configuration to a specified directory after the executable is built:</p>
<pre><code>Sub AddTargetCopyRule
If Projects(1).Type = "Build" Then
 &nbsp; Projects(1).Configurations(1).AddCustomBuildStep "copy ""$(TargetPath)"" ""c:\MyOutDir""", _
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "c:\MyOutDir\$(TargetName).exe", "Copy executable to c:\MyOutDir"
End If
End Sub
</code></pre>
</FONT></BODY>
</HTML>
