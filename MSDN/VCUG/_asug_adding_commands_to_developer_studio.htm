<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding Commands to the Visual C++ Developer Studio</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<h1><a name="_asug_adding_commands_to_developer_studio"></a>Adding Commands to the Visual C++ Developer Studio</h1>
<p>
<a href="_asug_home_page.3a_.developer_studio_add_ins.htm">Home Page (Add-ins)</a>  |&nbsp; <a href="_asug_overview.3a_.developer_studio_add.2d.ins.htm">Overview</a>  |&nbsp; <a href="_asug_how_do_i_......_topics.3a_.developer_studio_add.2d.ins.htm">How Do I ... Topics</a>  |&nbsp; <a href="_asug_frequently_asked_questions.3a_.developer_studio_add_ins.htm">FAQ</a>  |&nbsp; <a href="_asug_reference.3a_.developer_studio_add.2d.ins.htm">Reference</a></p>
<p>
If you use the Developer Studio Add-in Wizard to create an add-in, the wizard automatically creates the code for adding one command to the Visual C++ environment. However, if you want to add other commands, you must write additional code.</p>
<p class=label>
<b>To add a command</b>
<ol>
<li>
Open the add-in's project.<br><br></li>
<li>
In ClassView, expand the project's classes.<br><br></li>
<li>
Select the <b>ICommands</b> interface, and then click the right mouse button.<br><br></li>
<li>
Click the <b>Add Method</b> command.<br><br></li>
<li>
In the <b>Method</b> <b>Declaration</b> box, enter the method that specifies what the command is supposed to do.<br><br></li>
<li>
In ClassView, expand the <b>CCommands</b> class, and then double-click the method name.<br><br></li>
<li>
In the Commands.cpp file, write the code for the method.<br><br></li>
<li>
In ClassView, expand the <b>CDSAddIn</b> class.<br><br></li>
<li>
Double-click the <a href="_asug_the_onconnection_method.htm">OnConnection</a> method.<br><br></li>
<li>
Search for code that adds a command. This code calls the <a href="_asug_addcommand_method.htm">AddCommand</a> method.<br><br></li>
<li>
For the new command, copy and customize the <b>AddCommand</b> call.<br><br></li>
<li>
Optionally, provide a toolbar button the user can press to carry out the command. If you used the Developer Studio Add-in Wizard and selected the <b>Provides a toolbar</b> option, then the wizard generated the code needed to provide a button. However, if you didn't select that option, you must add the necessary code. For details, see <a href="_asug_creating_toolbar_buttons_for_add_in_commands_programmatically.htm">Creating Toolbar Buttons for Add-in Commands Programmatically</a>.<br><br></li>
<li>
Optionally, create an image for the toolbar button. If you used the Developer Studio Add-in Wizard and selected the <b>Provides a toolbar</b> option, then the wizard automatically created an image for the button. For details, see <a href="_asug_creating_images_for_toolbar_buttons.htm">Creating Images for Toolbar Buttons</a>.<br><br></li>
<li>
Optionally, assign a key sequence to the command. For details, see <a href="_asug_assigning_key_sequences_to_add_in_commands_programmatically.htm">Assigning Key Sequences to Add-in Commands_Programmatically</a>.</li>
</ol>
</FONT></BODY>
</HTML>
