<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Assigning Key Sequences to Add-in Commands Programmatically</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<h1><a name="_asug_assigning_key_sequences_to_add_in_commands_programmatically"></a>Assigning Key Sequences to Add-in Commands Programmatically</h1>
<p>
<a href="_asug_home_page.3a_.developer_studio_add_ins.htm">Home Page (Add-ins)</a>  |&nbsp; <a href="_asug_overview.3a_.developer_studio_add.2d.ins.htm">Overview</a>  |&nbsp; <a href="_asug_how_do_i_......_topics.3a_.developer_studio_add.2d.ins.htm">How Do I ... Topics</a>  |&nbsp; <a href="_asug_frequently_asked_questions.3a_.developer_studio_add_ins.htm">FAQ</a>  |&nbsp; <a href="_asug_reference.3a_.developer_studio_add.2d.ins.htm">Reference</a></p>
<p>
The user can carry out an add-in command by using a key sequence assigned to the command. The user can assign this key sequence through the user interface, or you can assign it programmatically.</p>
<p class=label>
<b>To assign a key sequence programmatically</b>
<ol>
<li>
Open the project for the add-in.<br><br></li>
<li>
In ClassView, expand the project's classes, and then expand the <b>CDSAddIn</b> class.<br><br></li>
<li>
Double-click the <a href="_asug_the_onconnection_method.htm">OnConnection</a> method.<br><br></li>
<li>
Search for code that adds the command. This code calls the <a href="_asug_addcommand_method.htm">AddCommand</a> method.<br><br></li>
<li>
After the <b>AddCommand</b> call, insert a call to the <a href="_asug_addkeybinding_method.htm">AddKeyBinding</a> method so that Developer Studio calls <b>AddKeyBinding</b> only when the <i>bFirstTime</i> parameter of the <b>OnConnection</b> method has a value of <b>VARIANT_TRUE</b>.<p class=tl>
The <i>bFirstTime</i> parameter directs Developer Studio to call <b>AddKeyBinding</b> only when the user first <a href="_asug_connecting_add_ins_to_developer_studio.htm">connects the add-in to the development environment</a>.</P></li>
</ol>
<p class=indent>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;Unless key sequences are necessary, do not add them because they might replace existing ones. For example, if a keystroke is assigned to a command and you assign the same keystroke to another command, your new assignment replaces the original. For best results, let the user assign key sequences to the commands added by an add-in.</p>
<p>
Additionally, Visual C++ provides other ways of using key sequences to customize your desktop environment. For details, see <a href="_asug_overview.3a_.customizing_developer_studio.htm">Overview: Customizing Visual C++</a>.</p>
<p>
<b>See Also</b>&nbsp;&nbsp;&nbsp;<a href="_asug_assigning_key_sequences_to_add_in_commands_visually.htm">Assigning Key Sequences to Add-in Commands Visually</a>, <a href="_asug_creating_toolbar_buttons_for_add_in_commands_programmatically.htm">Creating Toolbar Buttons for Add-in Commands Programmatically</a></p>
</FONT></BODY>
</HTML>
