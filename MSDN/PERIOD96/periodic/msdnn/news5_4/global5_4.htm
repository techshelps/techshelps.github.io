<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="Template" content="C:\MSOffice\Templates\NEWNEWS.DOT">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Make All the World a Stage for ActiveX Controls</title>

<meta name=href content="msdn_ie4.css">                
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<basefont face="verdana, arial, helvetica" color="#000000" size=2> 
<BODY bgcolor="#ffffff" vlink="#666666" link="#ff0000" text="#000000">


<p><font size="6" face="verdana">Make All the World a
Stage for ActiveX Controls </font></p>

<p><font size="1"><i>by F. Avery Bishop</i></font></p>

<p><font size="2">As a worldwide phenomenon, the Web provides
exposure to multiple cultures and languages for developers and
users alike. The challenge to Web site developers is to provide
content that takes advantage of this diverse mix and is sensitive
to it. In particular, ActiveX controls present special challenges
because they are downloaded to a client machine that could be in
any of dozens of locale or language environments.</font></p>

<p><font size="2">Keep in mind that an ActiveX control is simply
a Component Object Model (COM) object, that is, a (usually small)
component of executable code. Thus, most of the guidelines for
globalizing a standard Win32 application apply. (See the
checklist inside the cover of <i>Developing International
Software for Windows 95 and Windows NT</i>, by Nadine Kano,
Microsoft Press, 1995.) The differences in guidelines for ActiveX
controls arise from the need to keep the controls small and/or
download asynchronously to maintain the user&#146;s interest in
the page. </font></p>

<p><font size="2">Here are some guidelines to help you develop
ActiveX controls that won&#146;t embarrass you, wherever the
controls show up in the world. Parents should be so lucky to have
kids like this.</font></p>

<blockquote>
    <p><font size="2"><b>Avoid data, such as text, that needs to
    be localized (translated)</b></font></p>
</blockquote>

<p><font size="2">You read that right</font><font size="2"
face="Symbol">¾</font><font size="2"> avoid text if possible.
This is actually a reasonable restriction in most cases, because
controls are often at a level of granularity that doesn&#146;t
require menus, message boxes, and other text. If you just
can&#146;t avoid using text in your control, you&#146;ll have to
translate most of it (there are some exceptions, such as product
names) into lots of languages, and then download the version
appropriate to the client locale to avoid appearing
English-centric. </font></p>

<p><font size="2">Note that this says nothing about the use of
locale-sensitive <i>formats</i>, such as those of date/time and
currency. For example, it&#146;s okay to use a date in an ActiveX
control, because the data itself (the date) is <i>not</i>
locale-sensitive. You can use the Win32 national language support
(NLS) application programming interface (API) to render the date
as appropriate to the locale without downloading extra data (see
the next item). </font></p>

<blockquote>
    <p><font size="2"><b>Take advantage of the NLS API</b></font></p>
</blockquote>

<p><font size="2">This standard guideline for traditional
applications is even more important for ActiveX controls. By
using functions such as <b>GetDateFormat</b> or <b>LCMapString</b>
to display or process data as appropriate to the client locale,
you can avoid maintaining your own database&#151;a significant
timesaver, since that database must be accessed or downloaded
over the net.</font></p>

<blockquote>
    <p><font size="2"><b>Use universal bitmaps</b></font></p>
</blockquote>

<p><font size="2">The overhead associated with downloading
bitmaps makes this guideline all the more imperative in the case
of ActiveX controls. Use icons, pictures, or symbols that are
universal around the world, so that a single bitmap will work
everywhere. In particular, avoid text in bitmaps, with the
exception of product names or &quot;design&quot; text that does
not need to be localized.</font></p>

<blockquote>
    <p><font size="2"><b>Separate text and other locale-sensitive
    resources from the program code</b></font></p>
</blockquote>

<p><font size="2">This is one of the first rules of
globalization: &quot;Thou shalt put all text in resource files
separate from the program code,&quot; so it&#146;s easier to find
and localize. Because ActiveX controls are for the <i>World Wide</i>
Web, you&#146;ll eventually want to translate text strings into
several languages, in which case this step is essential to
maintaining your schedule and your sanity. </font></p>

<blockquote>
    <p><font size="2"><b>Verify that your locale requirements are
    met</b></font></p>
</blockquote>

<p><font size="2">If your control absolutely requires features
not offered by all locales, check the locale setting, and set it
to one you can use. For example, if your object requires an Input
Method Editor (IME), check the locale of the client system to
make sure that it is one of the Far Eastern locales. The
following code will set the American National Standards Institute
(ANSI) locale to the system default, and will return the name of
the locale setting for use with the ANSI functions:</font></p>

<p><font color="#0000ff" size="2" face="Courier New">&nbsp;&nbsp;&nbsp;#include
&lt;locale.h&gt;</font>

<br><font color="#0000ff" size="2" face="Courier New">&nbsp;&nbsp;&nbsp;char
*szDefaultLocale = setlocale(LC_ALL, &quot;&quot;) ;</font></p>

<p><font size="2">The second parameter in the <b>setlocale</b>
function can also be a string representing any valid locale, such
as &quot;German_Switzerland.1252&quot;. If the call is not
successful, it will return a NULL pointer. You should call <b>setlocale</b>
at the beginning of execution in any case, because programs
always start out in the &quot;C&quot; locale, which is as boring
as American rice lager. </font></p>

<p><font size="2">If you prefer to use the Win32 locale
functions, you can check the locale identifier (LCID) as follows:</font></p>

<p><font color="#0000ff" size="2" face="Courier New">&nbsp;&nbsp;&nbsp;#include
&lt;winnls.h&gt;</font>

<br><font color="#0000ff" size="2" face="Courier New">&nbsp;&nbsp;&nbsp;LCID
lcDefault = GetSystemDefaultLCID() ;</font></p>

<p><font size="2">If your control cannot operate in this locale,
you can fail gracefully, rather than simply crashing. </font></p>

<blockquote>
    <p><font size="2"><b>Download only the localized data needed
    for the client locale</b></font></p>
</blockquote>

<p><font size="2">If you have large amounts of locale-specific
data, such as help files or special-purpose fonts, check the
client&#146;s locale ID, as shown above. You can then use the
ANSI locale or LCID to decide which files are appropriate,(for
example, by a switch statement) and then set up a URL moniker
that will download only the files needed. </font></p>

<p><font size="2">A general point to keep in mind during design
is that because the Web is <i>worldwide, </i>you can&#146;t
assume anything about either the locale or the user using your
ActiveX control, so it's important to make the design as general
as possible.</font></p>

<p><font size="2" face="verdana"><b>Going Global online
</b></font></p>

<p><font size="2">For more information on globalizing software
for international markets, consult Microsoft's <i>Going Global</i>
site on the World Wide Web, <a href="http://www.microsoft.com/globaldev/"><b>http://www.microsoft.com/globaldev/</b>.</a></font></p>

<p><font size="2"><i>When not writing for the </i>Going Global<i>
title, F. Avery Bishop dabbles in exotic languages and scales the
Cascade peaks in his backyard.</i></font>


<blockquote>
    <p align="center"><font color="#0000ff" size="3"
    face="verdana">The differences in guidelines for
    ActiveX controls arise from the need to keep the controls
    small and/or download asynchronously</font>
    <p align="center"><font color="#0000ff" size="3"
    face="verdana">Because the Web is <i>worldwide,</i>
    you can&#146;t assume anything about either the locale or the
    user using your ActiveX control</font></p>
</blockquote>
</font></body>
</html>
