<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Massive Permissions</title>

<meta name=href content="msdn_ie4.css">                
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><basefont face="verdana,arial,helvetica" size=2 color="#000000">

<BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2">

<p><font color="#000000" size="5" face="verdana,arial,helvetica">Massive
Permissions</font><font color="#000000"
face="verdana,arial,helvetica"> </font></p>

<h2><font color="#000000" size="2" face="verdana,arial,helvetica">Doc:</font><font
color="#000000" face="verdana,arial,helvetica"> </font></h2>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">I'm
trying to figure out a way to &quot;programmatically&quot; make
mass changes to Windows NT user permissions. Specifically, I'm
looking for a way to change a user's logon times. While I know
this can be done with the user manager, we've got about 6,000
users who need their allowed logon times changed, and this could
be a pain, especially if we decide later to change it back.</font><font
color="#000000" face="verdana,arial,helvetica"> </font></p>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">Anyway,
I've written a short Visual C++ app that takes a .TXT list of
user names and does a command line 'NET USER /times: etc etc' for
each one, but this is a bit inelegant.</font><font
color="#000000" face="verdana,arial,helvetica"> </font></p>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">Is
there an appropriate Windows NT API that I can use to make these
changes? I tried reading up on the SAMLIB API, but there's no
info available, and for all I know that might not even be the
right way to do it.</font><font color="#000000"
face="verdana,arial,helvetica"> </font></p>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">Thanks
for your time,</font><font color="#000000"
face="verdana,arial,helvetica"> </font></p>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">Dave
Yarbrough</font><font color="#000000"
face="verdana,arial,helvetica"> </font></p>

<h2><font size="2" face="verdana">Dr. GUI replies:</font></h2>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">Six
thousand users? Cool! And the good doctor is sure you'll need to
change the logon times back when they find out what you've done.</font><font
color="#000000" face="verdana,arial,helvetica"> </font></p>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">You
can call <b>NetUserSetInfo</b> and tell it you're passing a
USER_INFO_3 structure. The USER_INFO_3 structure contains the
following member </font></p>

<p><font color="#000000" size="2" face="Courier New">PBYTE
usri3_logon_hours</font><font color="#000000"
face="verdana,arial,helvetica"> </font></p>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">that
does exactly what the doctor, or patient in this case, ordered.
Set the member correctly and away you go!</font><font
color="#000000" face="verdana,arial,helvetica"> </font></p>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">Another
API, called <b>NetUserEnum</b>, allows you to enumerate existing
computer accounts.</font><font color="#000000"
face="verdana,arial,helvetica"> </font></p>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">Check
out the Knowledge Base article, Q136867&#151;&quot;How to Manage
Computer Accounts Programmatically in Windows NT&quot;&#151;which
provides sample code for how to implement <b>NetUserSetInfo</b>.</font><font
color="#000000" face="verdana,arial,helvetica"> </font></p>
</font></body>
</html>
