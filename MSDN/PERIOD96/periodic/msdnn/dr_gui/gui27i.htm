<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Doing Two Things at Once: Multiple Threads</title>

<meta name=href content="msdn_ie4.css">                
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><basefont face="verdana,arial,helvetica" size=2 color="#000000">

<BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2">

<font size="5" face="verdana,arial,helvetica">Doing Two Things at
Once: Multiple Threads</font>

<h3><font size="2" face="verdana,arial,helvetica">Dear Dr. GUI:</font></h3>

<p><font size="2" face="verdana,arial,helvetica">I am developing Internet
chatting. I have a question on which I need you to help me out. </font></p>

<p><font size="2" face="verdana,arial,helvetica">Because it is for
Internet use, our application is sort of a real-time application
on Windows NT and Windows 95. My question is while the program is
downloading and playing a wave file through the Internet, if the
user clicks on some pull-down menu (actually just using a mouse
to hold it) or hits F1 to activate context-sensitive Help, the
program will stop playing the audio clip. Is there any way to
solve this problem? I noticed that the Sound Recorder in
Accessories of Windows NT will not halt under this kind of
condition. </font></p>

<p><font size="2" face="verdana,arial,helvetica">My application is SDI,
and for some reason we used <b>OnIdle()</b> to check the event to
make the program continue to play sound. Do you think <b>PeekMessage</b>
will still work for this? </font></p>

<p><font size="2" face="verdana,arial,helvetica">BTW, if you still have a
DR. GUI T-shirt, would you mind sending me one? </font></p>

<p><font size="2" face="verdana,arial,helvetica">Mr. Victor Dong </font></p>

<h3><font size="2" face="verdana,arial,helvetica">Dr. GUI replies:</font></h3>

<p><font size="2" face="verdana,arial,helvetica">Wouldn&#146;t we all
like to do two things at once&#151;and do them well? As it turns
out, this is a <i>lot</i> easier with Win32 than it was with
Win16. Programs that keep doing whatever they do while the UI is
working most probably use multiple background threads (which
execute independently of the UI). Specifically, a strategy using <b>OnIdle</b>
or <b>PeekMessage</b> won&#146;t work if your program isn&#146;t
idle&#151;and it won&#146;t be idle while a menu is being held
down or while a help context is being loaded. So what you need is
a background thread to play the sound. </font></p>

<p><font size="2" face="verdana,arial,helvetica">There&#146;s tons of
material on multithreading on the MSDN Library CD. As starters,
I&#146;d recommend the articles &#147;Multithreading for
Rookies&#148; and &#147;Multiple Threads in the User
Interface.&#148; And since you&#146;re using MFC, be sure to
check out the article on multithreading in the MFC Encyclopedia. </font></p>

<p><font size="2" face="verdana,arial,helvetica">Another technique that
helps applications remain responsive is to use asynchronous I/O
rather than waiting for I/O to complete&#151;this is especially
important when doing I/O over a network. </font></p>
</font></body>
</html>
