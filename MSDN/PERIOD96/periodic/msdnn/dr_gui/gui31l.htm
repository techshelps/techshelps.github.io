<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tell
It to the Grapevine: MAPI, OLE Messaging</title>

<meta name=href content="msdn_ie4.css">                
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><basefont face="verdana,arial,helvetica" size=2 color="#000000">

<BODY bgcolor="#FFFFFF">
<font face="verdana,arial,helvetica" size="2">

<p><font color="#000000" size="5" face="verdana,arial,helvetica">Tell
It to the Grapevine: MAPI, OLE Messaging</font></p>

<h2><font color="#000000" size="2" face="verdana,arial,helvetica">Dear
Dr. GUI:</font><font color="#000000"
face="verdana,arial,helvetica"> </font></h2>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">What
is the minimal amount of code used to send a MAPI message to the
Internet without a user interface&#151;i.e., default user id, and
default message.</font><font color="#000000"
face="verdana,arial,helvetica"> </font></p>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">Rick
Hopkin</font><font color="#000000" face="verdana,arial,helvetica">
</font></p>

<h2><font size="2" face="verdana">Dr. GUI replies:</font></h2>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">Automatic
messages! My cost accountant is very happy!</font><font
color="#000000" face="verdana,arial,helvetica"> </font></p>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">There
are several ways to automate the process of sending a message in
Visual Basic. You can use the MAPI controls, direct MAPI calls,
or OLE Messaging.</font><font color="#000000"
face="verdana,arial,helvetica"> </font></p>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">There
are two common approaches to using MAPI from Visual Basic 4.0.</font><font
color="#000000" face="verdana,arial,helvetica"> </font></p>

<blockquote>
    <p><font color="#000000" size="2"
    face="verdana,arial,helvetica">&#149; Use the MAPI controls
    that come with the Professional and Enterprise editions of
    Visual Basic 4.0. VBMAIL.VBP, a sample project that comes
    with Visual Basic, demonstrates the use of the MAPI controls.</font><font
    color="#000000" face="verdana,arial,helvetica"> </font></p>
    <p><font color="#000000" size="2"
    face="verdana,arial,helvetica">&#149; Use the OLE Messaging
    Object Library to manipulate messages, attachments, folders,
    and addresses in Microsoft Exchange.</font><font
    color="#000000" face="verdana,arial,helvetica"> </font></p>
</blockquote>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">Here
is an example of using OLE Messaging to send a message:</font><font
color="#000000" face="verdana,arial,helvetica"> </font></p>

<p><font color="#000000" size="2" face="Courier New">Dim oSession
As Object</font><font color="#000000"
face="verdana,arial,helvetica"> <br>
&nbsp; <br>
</font><font color="#000000" size="2" face="Courier New">Set
oSession = CreateObject(&quot;MAPI.Session&quot;)</font><font
color="#000000" face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">oSession.Logon
&quot;MS Exchange Settings&quot;, True</font><font
color="#000000" face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">Dim
objMessage As Object ' Message object</font><font color="#000000"
face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">Dim
objOneRecip As Object ' Recipient object</font><font
color="#000000" face="verdana,arial,helvetica"> <br>
&nbsp; <br>
</font><font color="#000000" size="2" face="Courier New">If
oSession Is Nothing Then</font><font color="#000000"
face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">MsgBox
&quot;You have to log on first....&quot;</font><font
color="#000000" face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">Exit Sub</font><font
color="#000000" face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">End If</font><font
color="#000000" face="verdana,arial,helvetica"> <br>
&nbsp; <br>
</font><font color="#000000" size="2" face="Courier New">Set
objMessage = oSession.Outbox.Messages.Add</font><font
color="#000000" face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">' create
the recipient</font><font color="#000000"
face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">Set
objOneRecip = objMessage.Recipients.Add</font><font
color="#000000" face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">objOneRecip.Name
= &quot;Rickcau@Microsoft.com&quot;</font><font color="#000000"
face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">objOneRecip.Type
= mapiTo</font><font color="#000000"
face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">objOneRecip.Resolve
(True) 'Show dialog to resolve ambiguities</font><font
color="#000000" face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">With
objMessage ' message object</font><font color="#000000"
face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">.subject
= &quot;Test MAPI/OLE VB Message w/ole object - explicit&quot;</font><font
color="#000000" face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">.Text =
&quot;Like you really wanted this ... please delete this
test&quot;</font><font color="#000000"
face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">End With</font><font
color="#000000" face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">' send
the message</font><font color="#000000"
face="verdana,arial,helvetica"> <br>
</font><font color="#000000" size="2" face="Courier New">objMessage.Send
showDialog:=False</font><font color="#000000"
face="verdana,arial,helvetica"> </font></p>

<p><font color="#000000" size="2" face="verdana,arial,helvetica">For
more information on direct MAPI calls and OLE Messaging, in the
MSDN Library, see the book <i>Win32 Messaging API (MAPI)</i> in
the Win32 SDK.</font></p>
</font></body>
</html>
