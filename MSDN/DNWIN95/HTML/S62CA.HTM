<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Troubleshooting Specific Startup Errors</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h3>Troubleshooting Specific Startup Errors</H3><P>This section describes specific conditions that might interfere with starting a Windows&nbsp;95 computer and how to fix them. </P>
<P>In general, for system startup problems, the first problem-solving method is to start Windows 95 in Safe Mode. For information about how to start in Safe Mode and use BOOTLOG.TXT for troubleshooting, see Chapter 35, "General Troubleshooting."</P>
<H4><A NAME="sec0"></A>Windows&nbsp;95 stalls during the first restart after installation.</H4><P>Usually this occurs because of legacy hardware that was configured incorrectly before Windows 95 was installed. Remove settings for hardware services in CONFIG.SYS and AUTOEXEC.BAT. Also, ensure that any SCSI devices are terminated correctly. You might also need to disable the ISA enumerator. This software detects a new type of adapter that can be configured from the operating system. The detection sequence requires the ISA enumerator for I/O processes on some ports. Although every effort has been made to avoid ports commonly in use, you might have hardware that is also trying to use these I/O ports. </P>
<H4><A NAME="sec1"></A>To disable the ISA enumerator </H4><UL><LI>Remove the following line from the [386Enh] section of SYSTEM.INI:</LI><LI>device = ISAPNP.386</LI></UL><h5><A NAME="sec2"></A>Bad or missing file error occurs on startup.</H5><P>If you receive a "Bad or missing <I>filename</I>" message when the system is starting (where <I>filename</I> might contain HIMEM.SYS, IFSHLP.SYS, and so on), do the following:</P>
<UL><LI>Check the syntax of the entry in CONFIG.SYS or other startup file.</LI><LI>Verify the existence, location, version, and integrity of the file.</LI></UL><P>If the filename to which the message refers is a device driver the computer needs for accessing the drive where Windows&nbsp;95 is installed, you need to move the <B>device=</B> line that contains the device driver to the beginning of CONFIG.SYS to allow access to the drive when CONFIG.SYS tries to load files from the Windows&nbsp;directory. </P>
<h5><A NAME="sec3"></A>Windows&nbsp;95 has damaged or missing core files.</H5><P>When Windows&nbsp;95 loads, it counts on key files being available and undamaged. If a system file is damaged or missing, it might prevent loading or normal operation. If VMM32.VXD or other core files are missing or damaged, you might need to run Windows&nbsp;95 Setup and select the Verify option in Safe Recovery to replace the files.</P>
<h5><A NAME="sec4"></A>System Registry file is missing.</H5><P>The Windows&nbsp;95 Registry file is required for operation. This is contained in SYSTEM.DAT and USER.DAT, which are backed up as .DA0 files. If only the SYSTEM.DAT Registry file is missing, Windows&nbsp;95 does one of the following:</P>
<UL><LI>Windows&nbsp;95 automatically replaces SYSTEM.DAT from the backup Registry .DA0 file.
<P> – Or –</P></LI><LI>Windows&nbsp;95 automatically uses Safe Mode to start Windows&nbsp;95 and displays the Registry Problem dialog box. Click the Restore From Backup And Restart button to restore the Registry, which copies SYSTEM.DA0 and USER.DA0 to .DAT files.</LI></UL><P>If both SYSTEM.DAT and SYSTEM.DA0 files are missing (or if the <B>WinDir= </B>entry in MSDOS.SYS is not set), a message informs you that the Registry file is missing and that Registry services are not available for this session. (This means that most operations in Windows&nbsp;95 will fail.) After this message appears, Windows&nbsp;95 automatically starts in Safe Mode and displays another message offering an option to restore the Registry. However, if there is no .DA0 file, the Registry cannot be restored. To resolve this problem, either restore SYSTEM.DAT from backup or run Windows&nbsp;95 Setup.</P>
<P>For information about backing up and restoring the Registry, see Chapter 33, "Windows 95 Registry."</P>
<h5><A NAME="sec5"></A>BIOS or a BIOS setting is incompatible.</H5><P>A ROM BIOS setting might prevent Windows&nbsp;95 from installing or loading, because some computers have a feature that prevents applications from writing to the boot sector. This is usually in the form of anti-virus protection set through your computer's CMOS. If this is enabled, Windows&nbsp;95 cannot complete the installation or cannot start properly.</P>
<P>If boot sector protection is enabled in the computer's BIOS, one of the following symptoms occurs:</P>
<UL><LI>Windows&nbsp;95 Setup stalls.</LI><LI>Windows&nbsp;95 stalls while starting. </LI><LI>The anti-virus software prompts you to overwrite the boot sector. Choosing Yes might allow you to complete the Setup procedure, but Windows&nbsp;95 stalls when it attempts to load.</LI></UL><P>To correct this problem, disable the Boot Sector protection feature through your computer's CMOS, then reinstall Windows&nbsp;95. For information about disabling this feature, consult your hardware documentation or service center.</P>
<h5><A NAME="sec6"></A>VxD error returns you to the command prompt.</H5><P>If a VxD is missing or damaged, Windows&nbsp;95 displays an error message that indicates which VxD is involved. If the VxD is critical to the operation of Windows&nbsp;95, then Windows&nbsp;95 does not start and the screen displays the command prompt. You might need to run Windows&nbsp;95 Setup and select Verify or Safe Recovery to replace the missing VxD.</P>
<P>You can selectively override a VxD that is included within VMM32.VxD. If the same VxD is loaded twice, the second instance intercepts all the calls to that particular VxD. There are two ways to override this:</P>
<UL><LI>Copy the related .VXD file into the Windows SYSTEM\VMM32 directory.</LI><LI>Edit SYSTEM.INI to add the entry <B>device= </B><I>filename</I><B>.vxd</B> in the [386enh] section. </LI></UL><h5><A NAME="sec7"></A>You cannot use dual boot to run a previous operating system.</H5><P>To take advantage of the dual-boot support in Windows&nbsp;95, you cannot install Windows&nbsp;95 into an existing Windows 3.x directory, and the value <B>BootMulti=1</B> must be defined in the Windows&nbsp;95 version of MSDOS.SYS. </P>
<P>DR DOS and versions of MS-DOS earlier than 5.0 do not support Windows&nbsp;95 dual-boot functionality. To return to your previous operating system, you have to remove Windows&nbsp;95 and reinstall your previous operating system, as described earlier in this chapter. </P>
<h5><A NAME="sec8"></A>"Previous MS-DOS files not found" message appears.</H5><P>When trying to dual-boot to the previous version of MS-DOS, you might receive an error message stating that your previous MS-DOS files were not found. It is probable that either the files are missing, or that your previous version of MS-DOS was not version 5.0 or higher.</P>
<P>You must have MS-DOS 5.0 or higher in order to start to a previous version of MS-DOS. Any version of MS-DOS earlier than 5.0 looks for the first three sectors of the IO.SYS file in the first three sectors of the data area of the drive. In MS-DOS 5.0 or higher, IO.SYS is designed to allow itself to be located outside the first three sectors of a drive's data area. In this situation, the only way to start to a version of MS-DOS prior to 5.0 is from a startup floppy disk.</P>
<P>Drivers, such as DBLSPACE.SYS, that are loaded when you start the computer using the earlier version of MS-DOS might not be available.</P>
<h5><A NAME="sec9"></A>Required real-mode drivers are missing or damaged.</H5><P>The previous operating system might have required certain real-mode drivers (compression, partitioning, hard disk drivers, and so on), and does not start correctly without them. </P>
<UL><LI>At system startup, press F8 and select Step-By-Step Confirmation to verify the correct loading of all specified drivers.</LI><LI>Verify that any drivers required to support your hardware are all specified in the appropriate startup file.</LI></UL><h5><A NAME="sec10"></A>Windows&nbsp;95 doesn't recognize a device.</H5><P>In some cases, Windows&nbsp;95 is unable to recognize an installed device, and the device resources are unavailable to Windows&nbsp;95. If Windows&nbsp;95 doesn't recognize an installed device, remove it in Device Manager, and reinstall it by using the Add New Hardware option in Control Panel. You can also use Device Manager to check resource conflicts. For information, see Chapter 19, "Devices." Or see the hardware conflict troubleshooting information in online Help.</P>
<h5><A NAME="sec11"></A>Installing drivers causes Windows&nbsp;95 system startup to fail.</H5><P>If you try to install drivers for Windows 3.x from other vendors over Windows&nbsp;95 (such as sound or video drivers), running the provided installation program can cause Windows&nbsp;95 to fail to start or operate correctly.</P>
<H4><A NAME="sec12"></A>To recover, when using a device that is supported by Windows&nbsp;95</H4><OL><LI>Remove all entries in SYSTEM.INI that were added by the installation software from another vendor.</LI><LI>Delete the device in Device Manager in the System properties, as described in Chapter 19, "Devices."</LI><LI>Shut down and restart Windows&nbsp;95.</LI><LI>Use the Add New Hardware option in Control Panel to reinstall the device by using the Windows&nbsp;95 drivers.</LI></OL>
<h5><A NAME="sec13"></A>The wrong applications run after Windows&nbsp;95 starts.</H5><UL><LI>In Windows Explorer, double-click the Windows Start Menu\Programs\Startup directory, and then delete any items that you do not want to run when Windows&nbsp;95 starts. </LI><LI>If the programs that are running do not appear in the Start Menu folder in Windows Explorer, run Registry Editor and find this key:</LI><LI>HKey_Current_User\Software\Microsoft\Windows\CurrentVersion\Explorer</LI><LI>   \Shell Folders
<P>The value of <B>Startup= </B>should be <I>Windows</I><B>\Start Menu\Program\Startup</B>, where <I>Windows</I> is the drive and directory containing the Windows&nbsp;95 files.</P></LI></UL></FONT></BODY></HTML>
