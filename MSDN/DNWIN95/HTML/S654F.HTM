<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Scheduling Programs with System Agent</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h3>Scheduling Programs with System Agent</H3><P>System Agent is a Win32-based application for scheduling programs to run at times you specify. After it is installed and configured on a computer, System Agent periodically runs programs according to your preferences. System Agent supports options for specifying when Compression Agent, Disk Defragmenter, ScanDisk, and other programs will run, and it provides notification of exceptional conditions such as low disk space. </P>
<P>Programs can be scheduled to run based on several criteria, such as the exact time and date, or a range of times, or whether the computer is idle or is running on batteries.</P>
<H4><A NAME="sec0"></A>How System Agent Works</H4><P>System Agent consists of two parts, a scheduling engine (SAGE.EXE) and a separate application (SYSAGENT.EXE) for displaying and modifying the list of scheduled programs. The list of scheduled programs for System Agent is stored in the SAGE.DAT file, which is placed by default on the user's computer in the SYSTEM subdirectory of the folder where Microsoft Plus! is installed. However, this file can also be stored in a network directory. The <B>ConfigPath</B> value in the following Registry key defines the location of SAGE.DAT:</P>
<P><BR></P>
<pre><code>Hkey_Local_Machine\Software\Microsoft\Plus!\System Agent</code></pre>
<P>The System Agent scheduling engine is a system service that runs continuously, monitoring the system and starting programs according to a database that contains the schedule you define for programs to be run. The only way you can interact with SAGE.EXE is by using the System Agent application.</P>
<P>The scheduling service starts automatically when the computer starts because its Setup program adds <B>sage.exe</B> as a value under the following Registry key:</P>
<P><BR></P>
<pre><code>Hkey_Local_Machine\Software\Microsoft\Windows\CurrentVersion\Run</code></pre>
<P>You can quit SAGE.EXE if required — for example, if a setup program such as Windows&nbsp;95 Setup prompts you to quit all applications before running — by choosing a command in the System Agent application.</P>
<H4><A NAME="sec1"></A>To quit SAGE.EXE (the System Agent scheduling engine)</H4><UL><LI>In the System Agent application click the Advanced menu, and then click Stop Using System Agent.
<P><B>Note</B>   Removing the System Agent scheduling engine in this way completely removes both SAGE.EXE and SYSAGENT.EXE from memory and from the Registry. Consequently, System Agent will not start automatically, and scheduled programs will not be run.</P>

<P>To restore System Agent as an automatic service, run the System Agent application, and answer Yes when prompted to start SAGE.EXE.</P></LI></UL><P>System Agent also notifies you when the following events occur:</P>
<UL><LI>Disk space falls below a predefined threshold</LI><LI>System Agent fails to run a program at its scheduled time because the computer was not running, was running on batteries, or was otherwise not idle</LI><LI>A DblSpace or DrvSpace CVF needs to be upgraded to DriveSpace&nbsp;3
<P><B>Note</B>   When Microsoft Plus! is installed, the ScanDisk and Defrag tools are enhanced to support DriveSpace 3 compression.</P></LI></UL><P>Upgrade notification (UPGRDALM.EXE) is scheduled to run when the computer first starts after Microsoft Plus! Setup. If there are no compressed drives to be upgraded, this notification is removed from the System Agent schedule and never runs again. If you choose to upgrade, the notification runs DriveSpace&nbsp;3, and then removes itself from the System Agent schedule when it has confirmed that the drives have been upgraded or compressed.</P>
<P><b>Note</b></P>
<P>The Upgrade notification runs by default at system startup although it doesn't appear in the list of programs scheduled in System Agent. For the Upgrade notification to appear in System Agent, change the <B>ShowSystemTasks</B> string value to <B>1</B> in the following Registry key:</P>
<P>Hkey_Current_User\Software\Microsoft\Plus!\System Agent</P>
<H4><A NAME="sec2"></A>Running Other Programs with System Agent: An Overview</H4><P>In addition to the disk utilities such as ScanDisk or Compression Agent that can be scheduled to run with System Agent, you can use System Agent to schedule any kind of program that you want to run at a particular time or periodically. For example, you might use System Agent to do the following:</P>
<UL><LI>Dial into an online service during off-peak hours, look for certain topics, download the results, and hang up.</LI><LI>Run a spreadsheet application such as Microsoft Excel, and use one or more macros to perform extensive computations on worksheets.</LI><LI>Run backup software when the computer is not being used.</LI></UL><P>The methods you use for scheduling and running a program depend on whether the application was designed to work with System Agent. </P>
<P>If the program is designed to run with System Agent, you can use the Settings dialog box in System Agent to choose options to use when running the program. For example, you might designate that ScanDisk run a standard test nightly, but run a thorough test once a month. A System Agent-aware program might offer additional options to choose for running the program.</P>
<P>For all types of programs, you can define a command line for running the program. This command line can be one of the following:</P>
<UL><LI>Any command-line statements that the program accepts. This might include only the program's executable name, the program name and a macro name or target filename, or the program name and any command-line switches. </LI><LI>A batch file with any allowable actions. If you use a batch file, you can simulate a chained group of commands for running multiple programs or batch files. To do this, use the <B>start /W</B> command in the batch file, which starts a program and waits for the results before running the next statement in the batch file.</LI></UL><P>The general process for scheduling a program to run in System Agent includes the following basic steps:</P>
<OL><LI>Select the Schedule A New Program command in System Agent, and specify a program to schedule.
<P>This is where you can specify the command-line switches or a batch file to run (for a program that is not System Agent-aware).</P></LI><LI>Optionally, define a friendly name for the program.</LI><LI>Optionally, for System Agent-aware programs such as ScanDisk or Compression Agent, click the Settings button and define the options for running the program.</LI><LI>Click the When To Run button and specify the interval at which the program will run, such as daily, weekly, or monthly.</LI></OL></FONT></BODY></HTML>
