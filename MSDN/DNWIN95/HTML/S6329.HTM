<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Client for NetWare Networks Technical Notes</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h3>Client for NetWare Networks Technical Notes</H3><P>This section presents some technical issues you should be aware of when using Client for NetWare Networks, including a summary of configuration settings and required support files, and configuration notes, plus notes about NetWare API support and running NetWare utilities with Client for NetWare Networks.</P>
<H4><A NAME="sec0"></A>Summary of Settings for Client for NetWare Networks</H4><P>The following table lists the required and possible settings for CONFIG.SYS and AUTOEXEC.BAT files if you install Client for NetWare Networks.</P>
<P><B>Configuration File Settings for Client for NetWare Networks</B></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="174pt" VALIGN="TOP"><COL WIDTH="174pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Filename</B></P></TD><TD VALIGN="TOP"><P><B>Required settings</B></P></TD></TR><TR><TD VALIGN="TOP"><P>autoexec.bat</P></TD><TD VALIGN="TOP"><P>None</P></TD></TR><TR><TD VALIGN="TOP"><P>startnet.bat1</P></TD><TD VALIGN="TOP"><P>None</P></TD></TR><TR><TD VALIGN="TOP"><P>config.sys</P></TD><TD VALIGN="TOP"><P>None</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>1   The STARTNET.BAT file is a startup batch file created when VLM is installed, and is called from AUTOEXEC.BAT. This file is not required with Microsoft Client for NetWare Networks.</P>
<P>Notice that LOGIN.EXE is not loaded from any configuration file. Windows&nbsp;95 Setup removes this entry automatically. Also, if either NETX or VLM is initialized from AUTOEXEC.BAT or another batch file, then Client for NetWare Networks will not be loaded. No real-mode drivers are needed if a network adapter driver appears in the list of installed components in the Network option in Control Panel.</P>
<P>The following table summarizes the minimum settings that you should see in the Network option in Control Panel if you install Client for NetWare Networks.</P>
<P><B>Required Network Settings for Client for NetWare Networks1</B></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="259pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Network component</B></P></TD><TD VALIGN="TOP"><P><B>Configuration options</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Client for NetWare Networks</P></TD><TD VALIGN="TOP"><P>If the computer will be downloading system policies or user profiles from NetWare servers, Client for NetWare Networks should be selected in the Primary Network Logon box. </P>
<P>In the General properties for Client for NetWare Networks, Preferred Server should show the name of the NetWare server to be used for initial logon. If login scripts are used, the option that enables login scripts should be checked.</P></TD></TR><TR><TD VALIGN="TOP"><P>Network adapter</P></TD><TD VALIGN="TOP"><P>In the General properties for the adapter, the driver type should be Enhanced Mode (32-bit and 16-bit) NDIS.1</P></TD></TR><TR><TD VALIGN="TOP"><P>IPX/SPX-compatible protocol</P></TD><TD VALIGN="TOP"><P>In its Advanced properties, the Frame Type should be Auto. If any network applications at your site require support for NetBIOS over IPX, that option should be checked in the NetBIOS properties.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>1<B>   </B>You can also specify 16-bit ODI drivers. You do not need to load such drivers from CONFIG.SYS or another configuration file.</P>
<H4><A NAME="sec1"></A>Required Support Files for Client for NetWare Networks</H4><P>The following table summarizes the support files required for Client for NetWare Networks. All of these files are found in the Windows SYSTEM directory and are provided with Windows&nbsp;95; no Novell-supplied components are required. For more information about these components, see Chapter 32, "Windows 95 Network Architecture."</P>
<P><B>Required Files for Client for NetWare Networks1</B></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="266pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>File</B></P></TD><TD VALIGN="TOP"><P><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP"><P>netware.drv</P></TD><TD VALIGN="TOP"><P>Emulates a WinNet driver required by some NetWare-aware applications that check for this file, such as Lotus Notes&reg;. Notice that this file is supplied with Windows&nbsp;95, and is not the same as the similarly-named Novell-supplied file. (The Windows&nbsp;95 version is approximately 2K in size.)</P></TD></TR><TR><TD VALIGN="TOP"><P>nwlink.vxd</P></TD><TD VALIGN="TOP"><P>Provides the IPX/SPX-compatible protocol.</P></TD></TR><TR><TD VALIGN="TOP"><P>nwlsproc.exe, nwlscon.exe</P></TD><TD VALIGN="TOP"><P>Optionally, provides the 32-bit login script processor and console used by Client for NetWare Networks.</P></TD></TR><TR><TD VALIGN="TOP"><P>nwnet32.dll</P></TD><TD VALIGN="TOP"><P>Provides common NetWare networking functions for the 32-bit network provider and print provider.</P></TD></TR><TR><TD VALIGN="TOP"><P>nwnp32.dll</P></TD><TD VALIGN="TOP"><P>Provides access to NetWare network resources using Windows Explorer, Network Neighborhood, and so on. This 32-bit network provider for NetWare networks is the service provider interface to the Multiple Provider Router. </P></TD></TR><TR><TD VALIGN="TOP"><P>nwpp32.dll</P></TD><TD VALIGN="TOP"><P>Provides the print provider interface to the print router in SPOOLSS.DLL. This 32-bit print provider supports the ability to print to NetWare printing resources.</P></TD></TR><TR><TD VALIGN="TOP"><P>nwredir.vxd</P></TD><TD VALIGN="TOP"><P>Provides a 32-bit file system driver (redirector) to support applications that use the NCP file sharing protocol.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>1<B>   </B>These files are all supplied on the Windows&nbsp;95 product disks. The NETWARE.DRV file in this configuration is a replacement for an identically named Novell-supplied file.</P>
<P>The following tables summarize entries that are changed automatically in configuration files when Client for NetWare Networks is installed with Windows&nbsp;95.</P>
<P><B>AUTOEXEC.BAT Additions for Client for NetWare Networks</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="116pt" VALIGN="TOP"><COL WIDTH="116pt" VALIGN="TOP"><COL WIDTH="116pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>dosagent</P></TD><TD VALIGN="TOP"><P>winagent</P></TD><TD VALIGN="TOP"><P></P></TD></TR></TBODY></TABLE>
<P><BR></P><P><B>AUTOEXEC.BAT Deletions for Client for NetWare Networks</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="116pt" VALIGN="TOP"><COL WIDTH="116pt" VALIGN="TOP"><COL WIDTH="116pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>bnetx <BR>brequest  <BR>emsnetx <BR>emsnet5  <BR>emsnet4  <BR>emsnet3  <BR>int2f  <BR>ipxodi  </P></TD><TD VALIGN="TOP"><P>ipx  <BR>lsl  <BR>msipx  <BR>netbios  <BR>net3<BR>net4<BR>net5<BR>netx</P></TD><TD VALIGN="TOP"><P>odihlp<BR>odinsup<BR>startnet<BR>vlm<BR>xmsnet3<BR>xmsnet4<BR>xmsnet5<BR>xmsnetxp</P></TD></TR></TBODY></TABLE>
<P><BR></P><P><B>SYSTEM.INI Additions for Client for NetWare Networks</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="116pt" VALIGN="TOP"><COL WIDTH="114pt" VALIGN="TOP"><COL WIDTH="117pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>[Boot]<BR>networks32=nwnp32</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR></TBODY></TABLE>
<P><BR></P><P><B>SYSTEM.INI Deletions for Client for NetWare Networks</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="116pt" VALIGN="TOP"><COL WIDTH="114pt" VALIGN="TOP"><COL WIDTH="117pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>[386enh]<BR>network=<BR>uniquedospsp=<BR>pspincrements=<BR>timercriticalsection=<BR>reflectdosint2a=</P></TD><TD VALIGN="TOP"><P>[Boot]<BR>network.drv=</P>
<P></P></TD><TD VALIGN="TOP"><P>[boot.description]<BR>network.drv=</P></TD></TR></TBODY></TABLE>
<P><BR></P><P><B>NET.CFG Deletions for Client for NetWare Networks</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="87pt" VALIGN="TOP"><COL WIDTH="128pt" VALIGN="TOP"><COL WIDTH="132pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>msipx</P></TD><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR></TBODY></TABLE>
<P><BR></P><P><B>Files Renamed in Windows or SYSTEM Directories1</B></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="87pt" VALIGN="TOP"><COL WIDTH="128pt" VALIGN="TOP"><COL WIDTH="132pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>nwuser.exe <BR>netware.drv <BR>netware.hlp </P></TD><TD VALIGN="TOP"><P>nwgdi.dll <BR>nwpopup.exe </P></TD><TD VALIGN="TOP"><P>vnetware.386 <BR>vipx.386 </P></TD></TR></TBODY></TABLE>
<P><BR></P><P>1   Files are renamed <I>filename.ex</I>~.</P>
<H4><A NAME="sec2"></A>Client for NetWare Networks Configuration Notes</H4><P>This section presents some configuration notes for Client for NetWare Networks.</P>
<UL><LI>When Windows&nbsp;95 attempts to connect to a NetWare server, it first silently tries to use the user's logon name and password to make the connection. If you use system policies, you can set a policy that turns off this behavior for Client for NetWare Networks. For information, see Chapter 15, "User Profiles and System Policies."</LI><LI>Client for NetWare Networks is always bound only to the IPX/SPX-compatible protocol. This is the only protocol this network client can use. If you require an additional protocol for your network, such as TCP/IP, you must install an additional network client, such as Client for Microsoft Networks.
<P>Notice, however, that you can install Microsoft TCP/IP to connect to the Internet without installing an additional network client.</P></LI><LI>Windows&nbsp;95 automatically provides a real-mode NetWare-compatible network client for use in emergency startup and recovery situations. It is not a full-featured, robust network client and, therefore, does not support features such as long filenames, automatic reconnection to servers, and the packet-burst (burst-mode) protocol. For more information about Safe Mode with Networking, see Chapter 35, "General Troubleshooting."</LI><LI>With Client for NetWare Networks, you cannot map drives for individual VM&nbsp;sessions; drive mappings are always global. This is the equivalent of the behavior specified in earlier versions of Windows by the SYSTEM.INI setting <B>NWShareHandles=True</B> (when using NETX or VLM). Notice, however, that with Client for NetWare Networks, each VM can have a different current directory on network drives, unlike earlier versions of Windows.</LI><LI>If you are using File and Printer Sharing for NetWare Networks, then CONFIG.SYS should not have a <B>LastDrive=</B> statement.</LI><LI>The NWPopUp messaging utility is not supported with Client for NetWare Networks. You can use WinPopup to broadcast pop-up messages, as described in Chapter&nbsp;12, "Network Technical Discussion."</LI></UL><H4><A NAME="sec3"></A>Additional Settings for Client for NetWare Networks</H4>
<P>This section describes some additional settings that can be added to the Registry for Client for NetWare Networks or for File and Printer Sharing for NetWare Networks. For information about how to add Registry values, see Chapter 33, "Windows 95 Registry."</P>
<P><B>Setting maximum IPX packet size for the LIP protocol.</B></P>
<P>You can set a global value for the maximum IPX packet size for the LIP protocol. To do this, add a Registry entry named <B>MaxLIP</B> and specify a binary or DWORD value that is the greatest value allowed on any one network segment. This global setting is also used on the local network. For example, if a client on a token-ring segment (which allows 4K packet sizes) communicates over an Ethernet segment (which allows 1.5K packets) to a server on another token-ring segment, the size specified for <B>MaxLIP</B> should be limited to the lowest packet size allowed. </P>
<P>Add <B>MaxLIP </B>as an entry under the following Registry key: </P>
<P><BR></P>
<pre><code>Hkey_Local_Machine\System\CurrentControlSet\Services\VxD\Nwredir</code></pre>
<P>To continue the earlier example, you would specify a value for 1.5K (0x000005DC in hexadecimal). The actual optimal value depends on the frame-header size, which is the IPX portion of the packet. You might want to experiment to get the right size but, in general, specifying a size that is too small is better than too large, because you want to make sure that the echo packet goes through on the first try. </P>
<P><B>Turning off support for packet-burst protocol.</B></P>
<P>If you want to turn off support for the packet-burst protocol (which is enabled by default for File and Printer Sharing for NetWare Networks), set <B>SupportBurst=0</B> in the following Registry key:</P>
<P><BR></P>
<pre><code>Hkey_Local_Machine\System\CurrentControlSet\Services\VxD\Nwserver</code></pre>
<P><B>Setting the shell version for .OVL files.</B></P>
<P>The versions of NetWare available for the United States that run on x86-based computers use Novell-supplied IBM*.OVL (overlay) files to present the NetWare shell. This is the default assumed by Windows&nbsp;95. However, other locales use other versions of .OVL files to account for different architecture. For example, NetWare 3.x J (for Japan) uses the following overlay files for various computer types.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="168pt" VALIGN="TOP"><COL WIDTH="180pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Overlay file</B></P></TD><TD VALIGN="TOP"><P><B>Computer architecture</B></P></TD></TR><TR><TD VALIGN="TOP"><P>pc98$run.ovl</P></TD><TD VALIGN="TOP"><P>NEC&reg; PC9800</P></TD></TR><TR><TD VALIGN="TOP"><P>dosv$run.ovl</P></TD><TD VALIGN="TOP"><P>IBM&reg; PC-compatible</P></TD></TR><TR><TD VALIGN="TOP"><P>j31$run.ovl</P></TD><TD VALIGN="TOP"><P>Toshiba&reg; J3100</P></TD></TR><TR><TD VALIGN="TOP"><P>fmr$run.ovl</P></TD><TD VALIGN="TOP"><P>Fujitsu&reg; FMR</P></TD></TR><TR><TD VALIGN="TOP"><P>ps55$run.ovl</P></TD><TD VALIGN="TOP"><P>IBM Japan</P></TD></TR></TBODY></TABLE>
<P><BR></P>
<P>For real-mode clients, alternate .OVL files are specified in NET.CFG as the SHORT MACHINE TYPE. For Microsoft Client for NetWare Networks, alternate .OVL files can be specified as the <B>ShellVersion</B> value in the following Registry key:</P>
<P><BR></P>
<pre><code>Hkey_Local_Machine\System\CurrentControlSet\Services\VxD\Nwredir</code></pre>
<P>The default value is <B>MDOS\0V7.00\0IBM_PC\0IBM\0</B>, where \0 indicates a binary zero (null value). This value represents the four concatenated strings returned by the INT&nbsp;21 function 0xEA. You must replace the last string (0IBM) with the one used to generate the *$RUN.OVL name. The value in the Registry must have a binary type; however, you can enter the required combination of raw ASCII and binary data in the Enter Binary Data dialog box.</P>
<H4><A NAME="sec4"></A>NetWare API Support in Client for NetWare Networks</H4><P>Client for NetWare Networks includes built-in support for MS-DOS – based APIs defined by Novell for NetWare 3.x, as summarized in the following table.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="76pt" VALIGN="TOP"><COL WIDTH="272pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>API for MS-DOS</B></P></TD><TD VALIGN="TOP"><P><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP"><P>INT21H</P></TD><TD VALIGN="TOP"><P>Used by applications for NetWare information, bindery services, and so on</P></TD></TR><TR><TD VALIGN="TOP"><P>INT64 and INT7A</P></TD><TD VALIGN="TOP"><P>Used by applications to submit IPX/SPX requests</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>Client for NetWare Networks supports MS-DOS – based API calls documented in <I>Novell NetWare Client SDK</I>. If problems occur with applications that make proprietary or undocumented API calls, then you should use a real-mode Novell-supplied client. Also, please report this problem to both Microsoft and the application vendor. </P>
<P>The Windows 3.x APIs for NetWare consist of a series of DLLs provided by Novell with the version 3.x WinNet16 driver for the VLM client. The 16-bit Novell-supplied DLLs for Windows can run with Client for NetWare Networks. This ensures that Windows-based applications and utilities that are NetWare-aware will run with Microsoft Client for NetWare Networks.</P>
<P>If any of your applications requires one or more of these DLLs when running on a Novell-supplied client (NETX or VLM), then you must also run the same DLLs when using that application under Client for NetWare Networks.</P>
<P>The NetWare DLLs are described in the following list. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="74pt" VALIGN="TOP"><COL WIDTH="273pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>API for Windows</B></P></TD><TD VALIGN="TOP"><P><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP"><P>nwcalls.dll</P></TD><TD VALIGN="TOP"><P>APIs for NCP communication between the file server and the client computer</P></TD></TR><TR><TD VALIGN="TOP"><P>nwgdi.dll</P></TD><TD VALIGN="TOP"><P>NetWare Graphical Device Interface</P></TD></TR><TR><TD VALIGN="TOP"><P>nwipxspx.dll</P></TD><TD VALIGN="TOP"><P>APIs for IPX/SPX communication</P></TD></TR><TR><TD VALIGN="TOP"><P>nwlocale.dll</P></TD><TD VALIGN="TOP"><P>APIs for localization of applications</P></TD></TR><TR><TD VALIGN="TOP"><P>nwnetapi.dll</P></TD><TD VALIGN="TOP"><P>Network API support for NDS</P></TD></TR><TR><TD VALIGN="TOP"><P>nwpsrv.dll</P></TD><TD VALIGN="TOP"><P>Print server services APIs</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>These Novell-supplied DLLs are not provided with Windows&nbsp;95. They are provided by Novell with NetWare versions 3.12 and 4.x, and are updated on CompuServe and other electronic forums. Also, you must follow the directions provided in your Novell documentation to install these files. For information about obtaining the most recent files, see "Obtaining Current Novell-Supplied Files" later in this chapter.</P>
<H4><A NAME="sec5"></A>Running NetWare Utilities with Client for NetWare Networks</H4><P>In addition to the 32-bit, protected-mode graphical tools built into Windows&nbsp;95, you can use the 16-bit command-line utilities provided with NetWare for managing and sharing resources. </P>
<P>With Microsoft Client for NetWare Networks, you can run all NetWare 3<I>.</I>x utilities that reside on the NetWare server, such as SYSCON. You can run most NetWare 4.x utilities when you are using Client for NetWare Networks, except those that require NDS, such as NWADMIN, CX, and NETADMIN. You can also run NetWare 2.x file and printer utilities. However, you cannot use the VLM NWUSER utility with Client for NetWare Networks. </P>
<P><B>Tip</B>   To use Novell-supplied utilities such as SYSCON, map the SYS:PUBLIC directory in the login script.</P>
<H4><A NAME="sec6"></A>To run NetWare 3.x utilities in Windows&nbsp;95 </H4><OL><LI>Map a drive to the volume containing the NetWare utilities by using statements in a login script or by using the Map Network Drive dialog box. 
<P>When you use Map Network Drive, you can make this a persistent connection by clicking the Reconnect At Logon box.</P></LI><LI>From the Start button, point to Programs, and then click MS-DOS Prompt to start an MS-DOS session.</LI><LI>Switch to the mapped network drive, and then run the utilities in the usual way. </LI></OL></FONT></BODY></HTML>
