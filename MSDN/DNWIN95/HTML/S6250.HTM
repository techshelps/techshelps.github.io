<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Server-Based Setup to Create Custom Scripts</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h3>Using Server-Based Setup to Create Custom Scripts</H3><P>You can use the Make Script button in Server-based Setup to create a default setup script. This option can only be used to create a setup script, not to edit an existing script. To edit an existing script, you must use a text editor, as described in "Editing MSBATCH.INF for Custom Settings" later in this chapter. </P>
<H4><A NAME="sec0"></A>To create a custom setup script using the Server-based Setup program</H4><OL><LI>In Server-Based Setup, click the Make Script button.</LI><LI>In the Save As dialog box, specify the filename for this setup script, and specify the path where the script is to be stored, and then click OK.
<P><img src="RK05_01.gif"></P></LI><LI>Use the SBS Default Properties dialog box to specify custom settings, as described in the following table. For information about each of these . </LI></OL><P>The following table summarizes what is set when a particular option is checked in the SBS Default Properties dialog box. For more information about each of these options when specified in a setup script, see Appendix D, "MSBATCH.INF Parameters." </P>
<P><B>Server-Based Setup Options for Custom Scripts</B></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="256pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Option</B></P></TD><TD VALIGN="TOP"><P><B>Description and related script setting</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>Setup Options [Setup]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Automated Install</P></TD><TD VALIGN="TOP"><P>Specifies whether to allow user input during Setup; sets <B>Express=1</B>.</P></TD></TR><TR><TD VALIGN="TOP"><P>Setup Mode</P></TD><TD VALIGN="TOP"><P>Selects Compact or Custom as the Setup type; sets the <B>InstallType=</B> value.</P></TD></TR><TR><TD VALIGN="TOP"><P>Create an Emergency Boot Disk</P></TD><TD VALIGN="TOP"><P>Ensures that Setup will create a startup disk; sets <B>EBD=1</B>. The user will be prompted to insert a floppy disk when Setup is ready to create this disk.</P></TD></TR><TR><TD VALIGN="TOP"><P>Install Verification</P></TD><TD VALIGN="TOP"><P>Specifies full installation or verification only; sets the <B>Verify=</B> value:</P>
<P> <FONT FACE="symbol"></FONT>  Do a full installation<BR> <FONT FACE="symbol"></FONT>  Verify install but don't copy files</P></TD></TR><TR><TD VALIGN="TOP"><P>Enable Pen Windows Warning</P></TD><TD VALIGN="TOP"><P>Ensures that a warning appears if Setup finds an unknown version of Pen Windows; sets <B>PenWinWarning=1</B>.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>Install Location [Setup]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Install Directory</P></TD><TD VALIGN="TOP"><P>Specifies the path for where Windows&nbsp;95 is to be installed; sets the <B>InstallDir=</B> value.</P></TD></TR><TR><TD VALIGN="TOP"><P>Server based Setup</P></TD><TD VALIGN="TOP"><P>Specifies where to install and how to start Windows&nbsp;95.</P>
<P>The Store Windows item offers two options:</P>
<P> <FONT FACE="symbol"></FONT>  On the server (for shared installations)<BR> <FONT FACE="symbol"></FONT>  On the user's hard disk (for local installations)</P>
<P>The Boot Device item offers three options that apply only for shared installations:</P>
<P> <FONT FACE="symbol"></FONT>  Floppy disk<BR> <FONT FACE="symbol"></FONT>  Hard disk<BR> <FONT FACE="symbol"></FONT>  Remote-boot server</P>
<P>For more information about shared installations of Windows&nbsp;95, see Chapter 4, "Server-Based Setup for Windows 95."</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>Name and Organization [NameAndOrg]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Display name and organization page</P></TD><TD VALIGN="TOP"><P>Prevents the User Information dialog box from appearing during Setup; sets <B>Display=0</B>.</P></TD></TR><TR><TD VALIGN="TOP"><P>Name</P></TD><TD VALIGN="TOP"><P>Specifies a user name; sets the <B>Name=</B> value.</P></TD></TR><TR><TD VALIGN="TOP"><P>Organization</P></TD><TD VALIGN="TOP"><P>Specifies a company name; sets the <B>Organization=</B> value.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>Network Options [Network]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Display network pages during custom setup</P></TD><TD VALIGN="TOP"><P>Prevents the Network Configuration dialog box from appearing during Setup; sets <B>Display=0</B>.</P></TD></TR><TR><TD VALIGN="TOP"><P>Clients to Install</P></TD><TD VALIGN="TOP"><P>Specifies a comma-separated list of network clients to be installed; sets the <B>Clients=</B> value.</P>
<P> <FONT FACE="symbol"></FONT>  VREDIR installs Client for Microsoft Networks<BR> <FONT FACE="symbol"></FONT>  NWREDIR installs Client for NetWare Networks<BR> <FONT FACE="symbol"></FONT>  NETX or VLM retains existing Novell-supplied clients</P>
<P>The first client in the list becomes the default client, which loads first when the computer is started.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>Client for Windows Networks [VRedir]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Validated Logon</P></TD><TD VALIGN="TOP"><P>Permits network logon only if the user has a valid account on the domain; sets <B>ValidatedLogon=1</B>.</P></TD></TR><TR><TD VALIGN="TOP"><P>Logon Domain</P></TD><TD VALIGN="TOP"><P>Specifies a Microsoft network domain name; sets the <B>LogonDomain=</B> value.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>Client for NetWare Networks [NWRedir]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Preferred Server</P></TD><TD VALIGN="TOP"><P>Specifies a NetWare server name; sets the <B>PreferredServer=</B> value.</P></TD></TR><TR><TD VALIGN="TOP"><P>First Network Drive</P></TD><TD VALIGN="TOP"><P>Specifies a drive letter; sets the <B>FirstNetDrive=</B> value.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>Protocols [Network]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Protocols to Install</P></TD><TD VALIGN="TOP"><P>Specifies a comma-separated list to set the <B>Protocols=</B> value. The following values install the standard protocols provided with Windows&nbsp;95:</P>
<P> <FONT FACE="symbol"></FONT>  NWLINK indicates IPX/SPX-compatible protocol<BR> <FONT FACE="symbol"></FONT>  NETBEUI indicates Microsoft NetBEUI<BR> <FONT FACE="symbol"></FONT>  MSTCP indicates Microsoft TCP/IP</P>
<P>The first protocol in the list becomes the default protocol, which also sets LANA 0.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>IPX/SPX-compatible protocol [NWLink]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Frame Type</P></TD><TD VALIGN="TOP"><P>Selects a frame type; sets the <B>FrameType=</B> value. The recommended setting for this is <B>Auto</B> unless you are absolutely certain of the frame type.</P></TD></TR><TR><TD VALIGN="TOP"><P>NetBIOS support</P></TD><TD VALIGN="TOP"><P>Installs support for NetBIOS over IPX; sets <B>NetBIOS=1</B>. </P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>Microsoft TCP/IP [MSTCP]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>DHCP</P></TD><TD VALIGN="TOP"><P>Enables DHCP for configuring TCP/IP; sets <B>DHCP=1</B>.</P></TD></TR><TR><TD VALIGN="TOP"><P>IP Address</P></TD><TD VALIGN="TOP"><P>Specifies an IP address for the computer in the form ###.###.###.###; sets the <B>IPAddress=</B> value.</P></TD></TR><TR><TD VALIGN="TOP"><P>Subnet Mask</P></TD><TD VALIGN="TOP"><P>Specifies a subnet mask in the form ###.###.###.###; sets the <B>SubnetMask=</B> value.</P></TD></TR><TR><TD VALIGN="TOP"><P>WINS</P></TD><TD VALIGN="TOP"><P>Specifies whether WINS servers are used for name resolution and how WINS is configured; sets the <B>WINS=</B> value. The following are the possible choices:</P>
<P> <FONT FACE="symbol"></FONT>  Disable WINS<BR> <FONT FACE="symbol"></FONT>  Enable WINS; get parameters from DHCP<BR> <FONT FACE="symbol"></FONT>  Enable WINS resolution (you must type WINS addresses)</P></TD></TR><TR><TD VALIGN="TOP"><P>Primary WINS</P></TD><TD VALIGN="TOP"><P>Specifies an IP address for a WINS server in the form ###.###.###.###; sets the <B>PrimaryWINS=</B> value.</P></TD></TR><TR><TD VALIGN="TOP"><P>Secondary WINS</P></TD><TD VALIGN="TOP"><P>Specifies an IP address for a WINS server in the form ###.###.###.###; sets the <B>SecondaryWINS=</B> value.</P></TD></TR><TR><TD VALIGN="TOP"><P>Scope ID</P></TD><TD VALIGN="TOP"><P>Specifies a scope ID string; sets the <B>ScopeID=</B> value.</P></TD></TR><TR><TD VALIGN="TOP"><P>Enable DNS</P></TD><TD VALIGN="TOP"><P>Enables the use of DNS servers or LMHOSTS files for name resolution; sets <B>DNS=1</B>.</P></TD></TR><TR><TD VALIGN="TOP"><P>Hostname</P></TD><TD VALIGN="TOP"><P>Specifies a host name for the computer (usually the same as the value of <B>ComputerName=</B>); sets the <B>Hostname=</B> value.</P></TD></TR><TR><TD VALIGN="TOP"><P>Domain</P></TD><TD VALIGN="TOP"><P>Specifies the DNS domain name for this computer; sets the <B>Domain=</B> value.</P></TD></TR><TR><TD VALIGN="TOP"><P>DNS Server search order</P></TD><TD VALIGN="TOP"><P>Specifies a comma-separated list of DNS servers in the order to be searched, each in the form ###.###.###.###; sets the <B>DNSServers=</B> value.</P></TD></TR><TR><TD VALIGN="TOP"><P>Domain search order</P></TD><TD VALIGN="TOP"><P>Specifies a comma-separated list of DNS domain suffixes; sets the <B>DomainOrder=</B> value.</P></TD></TR><TR><TD VALIGN="TOP"><P>LMHOST Path</P></TD><TD VALIGN="TOP"><P>Specifies the path where the LMHOST file is stored; sets the <B>LMHostPath=</B> value. Notice that you must also check the Enable DNS option to use LMHOSTS.</P></TD></TR><TR><TD VALIGN="TOP"><P>Gateways</P></TD><TD VALIGN="TOP"><P>Specifies a comma-separated list of gateways to be used, each in the form ###.###.###.###; sets the <B>Gateways=</B> value.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>Net cards [</B><B><I>netcard</I></B><B>]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Net cards to install</P></TD><TD VALIGN="TOP"><P>Specifies a comma-separated list of network adapter driver names, which sets the <B>Netcards=</B> value. </P>
<P><B>Note </B> In general, this value should not be defined in a setup script; you should let Windows&nbsp;95 Setup use detection to identify and configure network adapters.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>Services [Network]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Services to install</P></TD><TD VALIGN="TOP"><P>Specifies a comma-separated list of network services to be installed; sets the <B>Services=</B> value. For File and Printer Sharing services, specify one of the following values:</P>
<P> <FONT FACE="symbol"></FONT>  VSERVER installs support for Microsoft networks<BR> <FONT FACE="symbol"></FONT>  NWSERVER installs support for NetWare networks</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>File and Printer Sharing for NetWare Networks [NWServer]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>SAP Browsing</P></TD><TD VALIGN="TOP"><P>Enables SAP Advertising for this computer; sets <B>Use_SAP=1</B>.</P></TD></TR><TR><TD VALIGN="TOP"><P>Browse Master</P></TD><TD VALIGN="TOP"><P>Enables Workgroup Advertising for this computer, and specifies the browser master role for this computer; sets the <B>BrowseMaster=</B> value. The following choices are possible:</P>
<P> <FONT FACE="symbol"></FONT>  This machine can be a browse master<BR> <FONT FACE="symbol"></FONT>  This machine cannot be a browse master<BR> <FONT FACE="symbol"></FONT>  This machine is the preferred browse master</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>File and Printer Sharing for Microsoft Networks [VServer]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>LMAnnounce</P></TD><TD VALIGN="TOP"><P>Allows computers running Microsoft LAN Manager to see this computer; sets <B>LMAnnounce=1</B>.</P></TD></TR><TR><TD VALIGN="TOP"><P>Browse Master</P></TD><TD VALIGN="TOP"><P>Specifies the computer's browser master role; sets the <B>MaintainServerList=</B> value. The following choices are possible:</P>
<P> <FONT FACE="symbol"></FONT>  Auto (the computer can be a browse master if required)<BR> <FONT FACE="symbol"></FONT>  Enabled (this computer is the browse master)<BR> <FONT FACE="symbol"></FONT>  Disabled (this computer cannot be a browse master)</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>Identification [Network]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Computer Name</P></TD><TD VALIGN="TOP"><P>Specifies a unique name on the network; sets the <B>ComputerName=</B> value.</P></TD></TR><TR><TD VALIGN="TOP"><P>Workgroup</P></TD><TD VALIGN="TOP"><P>Specifies a unique name on the network; sets the <B>Workgroup=</B> value.</P></TD></TR><TR><TD VALIGN="TOP"><P>Description</P></TD><TD VALIGN="TOP"><P>Specifies any string, with no commas; sets the <B>Description=</B> value.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>Access Control [Network]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Security Type</P></TD><TD VALIGN="TOP"><P>Defines the type of security to be used to protect shared resources, and the type of pass-through security agent, if user-level security is specified; sets the <B>Security=</B> value. The following choices are possible:</P>
<P> <FONT FACE="symbol"></FONT>  Share (for share-level security)<BR> <FONT FACE="symbol"></FONT>  User-level — Windows NT domain<BR> <FONT FACE="symbol"></FONT>  User-level — Windows NT computer<BR> <FONT FACE="symbol"></FONT>  User-level — NetWare server</P></TD></TR><TR><TD VALIGN="TOP"><P>Pass-through Agent</P></TD><TD VALIGN="TOP"><P>Specifies the server or domain that is to provide pass-through validation for user-level security; sets the <B>PassThroughAgent=</B> value.<I> </I></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>System Components [System]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Various device types</P></TD><TD VALIGN="TOP"><P>Specifies the related INF section name for installing and configuring a specific device. This includes Advanced Power Management, locale, machine, pen windows, tablet, keyboard, monitor, display, and mouse devices. </P>
<P><B>Note </B> The recommended method for installing and configuring all these devices is for Windows&nbsp;95 Setup to use detection.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P><B>Most Recently Used Paths [InstallLocationsMRU]:</B></P></TD></TR><TR><TD VALIGN="TOP"><P>Most Recently Used Path</P></TD><TD VALIGN="TOP"><P>Specifies UNC names for up to four paths that can be displayed in dialog boxes that request the location of files during Setup.</P></TD></TR></TBODY></TABLE>
<P><BR></P><H4><A NAME="sec1"></A>Tip for Ensuring User Logon Capabilities in Setup Scripts</H4><P>By default, Windows&nbsp;95 Setup preserves the network identification information from the user's previous networking configuration, including the logon domain or preferred server. However, in cases where this configuration information is not already defined, you must specify settings in the setup script.</P>
<P>If users are installing Windows&nbsp;95 from a server that requires logon validation, make sure the custom setup script defines the correct logon server. For a computer that will run Client for Microsoft Networks and use the Windows&nbsp;NT network for network logon validation, you should define values for <B>LogonDomain=</B> and <B>ValidatedLogon=</B> in the [VRedir] section. For a computer that will run Client for NetWare Networks, define a correct value for <B>PreferredServer=</B> in the [NWRedir] section.</P>
<P>If the appropriate values aren't defined in a setup script, the user might not have the validated access required to complete the final Setup steps for installing printers and other actions.</P></FONT></BODY></HTML>
