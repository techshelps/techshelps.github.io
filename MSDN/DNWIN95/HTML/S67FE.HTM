<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Checking for Missing System Files</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h3>Checking for Missing System Files</H3><P>A missing operating system file prevents the startup process from continuing. If you are missing only the COMMAND.COM file, you can fix this problem from the Startup menu as described in "Safe Mode Command Prompt Only" earlier in this chapter, or from a Windows&nbsp;95 startup disk as described in this section. </P>
<P></P>
<P>This section also describes how to check and restore the IO.SYS and MSDOS.SYS system files. Windows&nbsp;95 uses the same names for the real-mode operating system files as MS-DOS does (IO.SYS, MSDOS.SYS, and COMMAND.COM). However, to support dual-boot, the MS-DOS versions of these files are renamed with a .DOS extension when you install or start Windows&nbsp;95 after having started the computer with the previous operating system. </P>
<P></P>
<H4><A NAME="sec0"></A>To replace or reinstall the real-mode operating system files on drive C </H4><OL><LI>Start the computer using the Windows&nbsp;95 startup disk.</LI><LI>At the command prompt for the startup drive, type <B>sys c:</B> to copy IO.SYS, MSDOS.SYS, DRVSPACE.BIN, and COMMAND.COM to drive C. This rewrites the boot sector.</LI><LI>Remove the floppy disk, and then restart the computer.</LI></OL><P>If COMMAND.COM is missing, a message indicates this and prompts you to type the path for the file.</P>
<H4><A NAME="sec1"></A>To restore COMMAND.COM using command-line commands</H4><OL><LI>Insert the startup disk into the floppy disk drive.</LI><LI>At the command prompt, type the following:</LI></OL><UL><LI>attrib -r -s -h c:\command.com<BR>copy a:command.com c:\</LI></UL><P>If the Windows&nbsp;95 MSDOS.SYS file is missing, a blue screen presents a message: "Invalid Vxd dynamic link call from IFSMGR (03)." This is followed by an error initializing IFSMGR, and startup fails.</P>
<P>Errors that appear during system startup related to the Registry, XMS, and IFSMGR, are all caused by invalid syntax in the specification of the [Paths] section of MSDOS.SYS or the <B>WinDir= </B>entry. Setting the <B>WinDir=</B> value causes IO.SYS to use that value to set the following environment variables:</P>
<P><BR></P>
<pre><code>tmp=WinDir
temp=<I>WinDir</I>
path=<I>WinDir</I>;<I>WinDir</I>\command
comspec=<I>WinDir</I>\command.com</code></pre>
<P>If no valid <B>WinDir=</B> entry is found in MSDOS.SYS, the path defaults to C:\WINDOWS, and COMSPEC defaults to C:\COMMAND.COM.</P>
<P>If IO.SYS is missing, the computer stalls before the Starting Windows&nbsp;95 message appears and displays a message. The message says that the system disk is invalid and prompts you to replace it. You must use a bootable Windows&nbsp;95 disk (such as the startup disk) to start the computer. You will then need to reinstall the real-mode operating system files on drive C as described in the preceding procedure.</P>
<P>You can also restore the COMMAND.COM in Windows&nbsp;95.</P>
<H4><A NAME="sec2"></A>To restore COMMAND.COM using Windows Explorer</H4><OL><LI>Restart the computer, press F8 at the Starting Windows&nbsp;95 message, and then select the Safe Mode option. </LI><LI>Insert the startup disk into the startup drive.</LI><LI>Using My Computer or Windows Explorer, find COMMAND.COM on the floppy disk drive, and then drag the file from the floppy disk to the root directory of the boot drive.</LI></OL></FONT></BODY></HTML>
