<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>VLM Technical Notes</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h3>VLM Technical Notes</H3><P>VLM, the network client provided with Novell NetWare version 4.x, provides the same support and behavior under Windows 95 as it does under MS-DOS or Windows 3.1. In addition, you gain the benefits described in "Microsoft Client for NetWare Networks: The Benefits" earlier in this chapter.</P>
<P>If the computer is using VLM, you should still load the Novell-supplied client components and TSR programs, and log on from either AUTOEXEC.BAT or STARTNET.BAT. Login scripts also work in the same way they do with MS-DOS and Windows 3.x. After Windows&nbsp;95 starts, you can use the Windows&nbsp;95 user interface to make drive and printer connections, or you can run NetWare utilities by running NWUSER or other commands at the command prompt. Notice, however, that you cannot use NDS names in Windows&nbsp;95 dialog boxes.</P>
<P>Installing Windows&nbsp;95 with the VLM client requires special steps if an earlier version of Windows is not installed, as described in this section. This section also presents specific notes related to using the Novell-supplied NetWare&nbsp;4.x client software with Windows&nbsp;95.</P>
<H4><A NAME="sec0"></A>Setting Up Windows 95 with VLM</H4><P>If you install Windows&nbsp;95 into the existing Windows directory on a computer where VLM is already configured to run with an earlier version of Windows, then to install VLM support, follow the steps described in "Installing Windows 95 with a Novell NetWare Client" earlier in this chapter.</P>
<P>However, if you are installing Windows&nbsp;95 into a new directory, or if you are installing it on a computer that has only the MS-DOS operating system (but no earlier version of Windows), you must follow special steps to set up the computer properly. This is because Windows support for VLM requires software supplied only through the Novell-supplied VLM installation program. Follow the instructions under the procedure in this section that most closely describes your configuration.</P>
<P>Windows&nbsp;95 Setup tries to detect VLM by looking for an NLS directory. If NLS is present, it begins installing Windows&nbsp;95 for VLM. If the NLS directory is not present but you select the VLM client to install in Setup, Windows&nbsp;95 Setup asks you to first install VLM using the Novell installation program. Then you can continue with Windows&nbsp;95 Setup. </P>
<P><B>Important</B>   Automatic logon for the NetWare network from AUTOEXEC.BAT needs to be configured before running Windows&nbsp;95 Setup; otherwise, your login script will not be run under Windows&nbsp;95 (and therefore any mapped drives will not be available).</P>
<H4><A NAME="sec1"></A>If you already run VLM with Windows 3.x and install Windows&nbsp;95 over Windows&nbsp;3.x</H4><UL><LI>Start the computer as usual, and make sure that the Novell software is running. Then run Windows&nbsp;95 Setup and choose support for Novell NetWare 4.0, as described in "Installing Windows 95 with a Novell NetWare Client" earlier in this chapter. 
<P>– Or –</P></LI></UL><OL><LI>After Setup is complete, in the Network option in Control Panel, select Client for NetWare Networks (if this has been installed), and then click Remove. </LI><LI>Click Add, and then double-click Client.</LI><LI>In the Select Network Client dialog box, click Novell in the Manufacturers list, and click the option named Novell NetWare (Workstation Shell 4.0 and above [VLM]) in the Network Clients list. Then click OK.</LI><LI>If you want to install Client for Microsoft Networks at this time, you can repeat the steps in the Select Network Client dialog box to install it. Then shut down and restart the computer.</LI></OL><H4><A NAME="sec2"></A>If you already run VLM with Windows 3.1 and install Windows&nbsp;95 in a new directory, or if you are running VLM with MS-DOS</H4><OL><LI>Start the computer as usual, making sure that the Novell-supplied network software is running. Then run Windows&nbsp;95 Setup, and select Custom as the Setup Type. </LI><LI>When the Network Configuration dialog box appears, select Client for NetWare Networks in the list of components (if this has been installed), and then click Remove.
<P><B>Note</B>   If you were logged into NDS when Setup was started, then VLM appears in this list and you can skip the following steps.</P></LI><LI>Click Add, and then double-click Client in the Select Network Component Type dialog box.</LI><LI>In the Select Network Client dialog box, click Novell in the Manufacturers list, and click Novell NetWare (Workstation Shell 4.0 And Above [VLM]) in the Network Clients list. Then click OK.
<P>Setup partially configures Windows&nbsp;95, and then prompts you to run the Novell Workstation Shell Install program after Windows&nbsp;95 has been installed.</P></LI><LI>Setup places information in AUTOEXEC.BAT that instructs you to run the Novell Workstation Shell Install program, after the Copying Files phase is complete. Complete this step to install the Novell-supplied support for Windows.
<P><B>Note</B>   Setup also places the entry <B>device=vnetbios</B> in SYSTEM.INI, which causes a blue screen to appear when you restart the computer. You can ignore this screen.</P></LI><LI>Restart the computer again, and let Windows&nbsp;95 start normally.</LI></OL><P>In the Network option in Control Panel, you will see that Setup has added Novell NetWare (Workstation Shell 4.0 And Above [VLM]) as a network client. Information in NET.CFG is used to configure the other network components. </P>
<P>For information about required files, see "Obtaining Current Novell-Supplied Files" later in this chapter.</P>
<H4><A NAME="sec3"></A>Using VLM with Client for Microsoft Networks</H4><P>If you are using VLM as the network client, you might also choose to install the 32-bit, protected-mode Client for Microsoft Networks if you want to connect to other Microsoft networking computers, such as computers running Windows for Workgroups 3.x, LAN Manager, or Windows NT. The following illustration describes this configuration.</P>
<P><B>Architecture for Novell-supplied VLM with Client for NetWare Networks; Components shown in bold are supplied by Novell.</B></P>
<P><img src="RK09_09.gif"></P>
<P>In this configuration, the Novell-supplied version of NETWARE.DRV is not used by Windows&nbsp;95. It is installed and loaded only for applications that call it directly. All access to NetWare resources is through the Windows&nbsp;95 user interface, not the NETWARE.DRV dialog boxes. The NWUSER utility calls NETWARE.DRV directly to bring up the central NetWare Version 3.0 WinNet16 dialog box.</P>
<P>Notice that this configuration requires a Microsoft Windows NT Client Access License if this computer will be connecting to servers running Windows NT Server. For more information, see Chapter 8, "Windows 95 on Microsoft Networks."</P>
<H4><A NAME="sec4"></A>Using VLM as the Sole Client </H4><P>This configuration can be used if you do not need to connect to other computers that are running Windows for Workgroups 3.x, LAN Manager, or Windows NT. (Of course, you can connect to a Windows&nbsp;95 computer running Microsoft File and Printer Sharing for NetWare.) </P>
<P>The following illustration summarizes this configuration.</P>
<P><B>Architecture for Novell-supplied VLM as the sole client; Components show in bold are supplied by Novell.</B></P>
<P><img src="RK09_11.gif"></P>
<P>The following table lists the required settings for CONFIG.SYS and AUTOEXEC.BAT files if you use VLM as the sole network client.</P>
<P><B>Configuration File Settings for VLM as the Sole Client</B></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="266pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Filename</B></P></TD><TD VALIGN="TOP"><P><B>Required settings</B></P></TD></TR><TR><TD VALIGN="TOP"><P>config.sys</P></TD><TD VALIGN="TOP"><P>lastdrive=<I>drive_letter</I></P></TD></TR><TR><TD VALIGN="TOP"><P>autoexec.bat</P></TD><TD VALIGN="TOP"><P>startnet.bat</P></TD></TR><TR><TD VALIGN="TOP"><P>startnet.bat</P></TD><TD VALIGN="TOP"><P>lsl.com<BR>odi driver<BR>ipxodi.com<BR>vlm.exe<BR>f:      ; that is, first network drive in net.cfg<BR>login<BR>c:</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>The following table summarizes the minimum settings that you should see in the Network option in Control Panel if you install Windows&nbsp;95 with VLM as the sole client.</P>
<P><B>Network Settings for VLM as the Sole Client</B></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="83pt" VALIGN="TOP"><COL WIDTH="265pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Network component</B></P></TD><TD VALIGN="TOP"><P><B>Options</B></P></TD></TR><TR><TD VALIGN="TOP"><P>NetWare (Workstation Shell 4.X [VLM])</P></TD><TD VALIGN="TOP"><P>Novell NetWare (Workstation Shell 4.X [VLM]) appears in the list of installed components. All other settings are configured in NET.CFG.</P></TD></TR><TR><TD VALIGN="TOP"><P>Network adapter</P></TD><TD VALIGN="TOP"><P>In the General properties for the adapter, the Real Mode (16-bit) ODI Driver option should be checked.</P></TD></TR><TR><TD VALIGN="TOP"><P>Novell IPX ODI </P></TD><TD VALIGN="TOP"><P>Settings are configured in NET.CFG.</P></TD></TR></TBODY></TABLE>
<P><BR></P><H4><A NAME="sec5"></A>Setting the LastDrive Parameter for VLM</H4><P>Windows&nbsp;95 uses the value of the <B>LastDrive=</B> entry in the Registry to allocate enough storage space in the internal memory structures to recognize drive letters for devices. For example, a setting of <B>LastDrive=Z</B> tells Windows&nbsp;95 to recognize drive letters from A to Z.</P>
<P>The Novell-supplied NetWare 4.x redirector handles the <B>LastDrive=</B> entry the same way that Windows&nbsp;95 does. That is, both the NetWare 4.x redirector and Windows&nbsp;95 allow drive letters to be used to connect to redirected network drives up through the drive letter specified by the <B>LastDrive=</B> entry.</P>
<P>The NetWare 4.x redirector uses the <B>First Network Drive=</B> entry in the NET.CFG file to identify the first network drive that can be mapped. For more information about this setting, consult your Novell documentation. </P></FONT></BODY></HTML>
