<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Preparing a STARTUP.GRP File</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h3>Preparing a STARTUP.GRP File</H3><P>If you are upgrading computers that run Windows for Workgroups, you can create a special Startup group that is used just once to run the login script. </P>
<P>The use of the Startup group is only mandatory when the user is running Windows for Workgroups 3.11 with logon validated performed by Windows NT Server. In this case, the user starts Windows for Workgroups, which loads the protected-mode protocols and processes the login script. The login script runs in a VM; although Windows&nbsp;95 Setup cannot be run in a VM, the login script can be used to create a modified STARTUP.GRP file that causes Setup to run as a Windows-based application after the login script finishes running.</P>
<P><b>Note</b></P>
<P>For computers that use a real-mode network client, login scripts can run Windows&nbsp;95 Setup directly, without using a special STARTUP.GRP.</P>
<P>Only computers that use a protected-mode network client need to use the STARTUP.GRP method to run Setup from within Windows for Workgroups.</P>
<H4><A NAME="sec0"></A>To prepare for push installations to upgrade earlier versions of Windows</H4><OL><LI>Run Windows for Workgroups on a computer.</LI><LI>If the Startup group is not present, use the File New command in Program Manager to create a Startup group.</LI><LI>In the Startup group, use the File New command to create an Upgrade icon that contains the following command line:</LI></OL><UL><LI><I>source_drive:setup [source_drive:msbatch_format.inf]</I>
<P>If the setup script is named MSBATCH.INF and is in the Windows directory in the source files, you do not need to specify the script name on the command line. Otherwise, specify the drive and script name. For example:</P></LI><LI>k:\setup k:\myscript.inf
<P>Specify the same source drive used in the login script statements, as described in the following sections on preparing the server for push installations.</P></LI></UL><OL><LI>Copy the STARTUP.GRP file to the shared directory on the server that contains the Windows&nbsp;95 source files. </LI><LI>Delete the group or icon that you just created, so that it is no longer stored on the computer where you are working.</LI><LI>In the MSBATCH.INF file, add the following statements to make sure that STARTUP.GRP is replaced after Setup:</LI></OL><UL><LI>[install]</LI><LI>renfiles=replace.startup.grp</LI><LI>[replace.startup.grp]</LI><LI>startup.grp, startup.sav</LI><LI>[destinationdirs]</LI><LI>replace.startup.grp=10</LI></UL></FONT></BODY></HTML>
