<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing Other Software Using Custom Scripts</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h3>Installing Other Software Using Custom Scripts</H3><P>This section describes how to use INF Installer to prepare for installing other software with Windows 95 and how to add Run-Once actions that occur at the end of Setup.</P>
<P>Server-based Setup cannot be used to add extra components, such as <I>Windows&nbsp;95 Resource Kit</I> utilities or applications and services from the ADMIN directory on the Windows&nbsp;95 compact disc. To add such components or to add any other software that uses Windows&nbsp;95 INF files, you must make sure that the source files are installed correctly, the INF files used by Windows&nbsp;95 Setup are modified properly, and correct entries are added to MSBATCH.INF.</P>
<P>The INF Installer utility (INFINST.EXE) accomplishes these actions automatically for any software that has a Windows&nbsp;95 INF file. INF Installer is part of the <I>Windows&nbsp;95 Resource Kit </I>utilities. Before you can use INF Installer, you must use Server-based Setup to install the Windows&nbsp;95 source files in a network directory, as described in Chapter 4, "Server-Based Setup for Windows 95."</P>
<H4><A NAME="sec0"></A>To use INF Installer to add components in MSBATCH.INF</H4><OL><LI>From the ADMIN\RESKIT\APPTOOLS\INFINST directory on the Windows&nbsp;95 compact disc, copy INFINST.EXE to the Windows directory on your computer.</LI><LI>From the Start menu, click Run, and then type <B>infinst</B> </LI><LI>In the INF Installer window, click the Set Path button and type the UNC path name for the Windows&nbsp;95 source files on the network.</LI><LI>To add a component's INF and other files to the Windows&nbsp;95 source files, click the Install INF button, and then browse for the path name for the current location of the component's INF, executable, and supporting files.</LI></OL><P>INF Installer copies the files listed in the component's INF file and makes the following modifications in the MSBATCH.INF file that's in the Windows directory on the server that contains the Windows&nbsp;95 source files:</P>
<UL><LI>If the component is a network service, then the device ID as specified in the INF file is added to the <B>services=</B> entry in the [Network] section.</LI><LI>If the component is an application, the components listed in the INF file are added as comments in the [OptionalComponents] section. 
<P><B>Note</B>   For any component to be installed using this setup script, you must manually remove the semicolon before the entry for the component name.</P></LI></UL><P>If you want to add to the Run-Once operations that occur the first time Windows&nbsp;95 starts, you can define entries for these actions in MSBATCH.INF. In addition, you must make sure that the required files are available with the Windows&nbsp;95 source files, or are otherwise available on a shared resource that users installing Windows&nbsp;95 have access to. For software components that have Windows&nbsp;95 INF files, you can use INF Installer to prepare files to be included with Windows&nbsp;95 Setup. You must also add these entries in the setup script:</P>
<UL><LI>Create an <B>AddReg=</B> entry in the [Install] section for each software component that you want to run during the Run-Once part of Setup. For example:</LI><LI>[install]<BR>AddReg=myprogram.addreg
<P>For more examples of [Install] section entries, see Appendix D, "MSBATCH.INF Parameters."</P></LI><LI>In the related [<I>software</I>] section, add the following kind of entry for the operation:</LI><LI>[myprogram.addreg]<BR>HKLM,Software\Microsoft\Windows\CurrentVersion\RunOnce\<I>reg_values</I></LI></UL><P>The following shows the Run-Once entry from MSMAIL.INF that causes the setup routine for Microsoft Mail to run after Windows&nbsp;95 is installed:</P>
<P><BR></P>
<pre><code>[MSMailAddReg]
HKLM,Software\Microsoft\Windows\CurrentVersion<BR>   \RunOnce\Setup,"%EmailRunOnce%",,"%25%\mlset32.exe"</code></pre>
<P><B>Important</B>   To create definitions in MSBATCH.INF for Run-Once statements or other actions, you must provide the precise Registry settings that the program uses to read or write to the Registry. This requires programmatic understanding of the software, or you must use values provided by the software manufacturer.</P>
<P>If you want to add other software as part of Windows&nbsp;95 installation, but that software does not have a Windows&nbsp;95 INF file, you must use a system management tool for software distribution, such as Microsoft Systems Management Server.</P>
<P><B>Tip</B>   Avoid using relative path names in setup scripts so that you can make sure the commands are run from the correct directory.</P></FONT></BODY></HTML>
