<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Task 2: Creating Machine Directories</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h2>Task 2: Creating Machine Directories</H2><P>When you run Windows&nbsp;95 Setup to create a shared installation for a client computer, information is stored in the client computer's machine directory (not in individual users' home directories). The machine directory contains the following kinds of configuration information:</P>
<UL><LI>Appropriate initialization and configuration files (including WIN.INI and SYSTEM.INI)</LI><LI>SYSTEM.DAT and USER.DAT files, which make up the Registry for the shared installation</LI><LI>Files that define the Desktop, Start menu directories, and other programs</LI><LI>The spool directory for printing</LI></UL><P>For floppy disk-based and remote-boot computers, the swap file and TEMP directory are also placed in the machine directory. You must create machine directories on a server for floppy disk-based and remote-boot shared installations. Using machine directories is optional for computers with hard disks that are running a shared version of Windows&nbsp;95.</P>
<P>You can set up the machine directory for a single computer or specify the filename of a text file that defines machine directories for multiple computer names.</P>
<H3><A NAME="sec0"></A>To specify machine directories for multiple computers</H3><OL><LI>Create a text file that contains a list of computer names with the related location of machine directories that are to contain Windows 95 computer-specific files.
<P>In this text file, the entry for each machine directory must appear on a separate line, in the following format:</P></LI><UL><LI><I>computername,\\UNC_server_name\directory\machine_directory</I>
<P>For example:</P></LI><LI>machine1,\\nwsvr1\netsetup\machine1   <BR>machine2,\\nwsvr1\netsetup\machine2</LI></UL><LI>Save the file in text-only (ASCII) format, using any filename and storing it in any shared directory.</LI></OL><H3><A NAME="sec1"></A>To create machine directories using Server-based Setup</H3><OL><LI>In the Server-Based Setup dialog box, click Set Path (or Change Path), and specify the path for the server that contains the Windows&nbsp;95 source files. Then click OK.</LI><LI>Click the Add button.
<P><img src="RK04_07.gif"></P></LI><LI>In the Set Up Machine dialog box, click an option to specify whether you are adding a single machine directory or multiple directories: 

<UL><LI>If you want to add a machine directory for a single computer, click Set Up One Machine. Then specify the name of the computer and the path to its machine directory.</LI><LI>If you want to add multiple machine directories using a batch file, click Set Up Multiple Machines. Then type the path and filename of the batch file that contains the list of computer names and machine directories. (This is the file created in the previous procedure.)
<P>If the file is stored on another server, type the UNC path to the directory.</LI></UL></LI><LI>If you want Server-based Setup to create setup scripts based on the values set in this dialog box and the default script created in Task 1, make sure the related Generate Setup Script option is checked.</LI><LI>If you want to create a shared installation based on the configuration in an existing machine directory, specify that directory in the box named Existing Machine Directory.
<P>You can see a list of the machine directories created in the currently selected server by clicking the View button in the Server-based Setup dialog box.</LI><LI>After you have specified all the options you want, click OK.</LI></OL><P>Server-based Setup creates the specified machine directories and, if you specified that a setup script should be created, it stores a setup script in each machine directory. </P>
<H3><A NAME="sec2"></A>Tip for Setting Up Machine Directories</H3><P>The best way to take advantage of Server-based Setup for setting up multiple computers is to specify options and run Windows&nbsp;95 Setup to create a shared installation for one computer. Then, for each group of computers that have the same network adapter and that will start a shared copy of Windows&nbsp;95, you can use the Set Up Machine dialog box to automatically create machine directories for all computers of the same type.</P>
<P>By using Server-based Setup in this way, you only need to run Windows&nbsp;95 Setup once for each type of computer configuration. Setup will automatically create machine directories and copy the main Windows&nbsp;95 files, such as the Registry files, INI files, program groups, and so on, to each new machine directory. For each machine directory, Setup also updates the Registry to set the correct path to the machine directory and to prepare the Run-Once actions to convert program groups and complete other actions.</P></FONT></BODY></HTML>
