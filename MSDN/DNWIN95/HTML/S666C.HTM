<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Correcting Connection Problems</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h3>Correcting Connection Problems </H3><P>This section describes basic steps for troubleshooting communications and explains specific communications errors or problems and how to correct them. </P>
<H4><A NAME="sec0"></A>Modem will not dial or will not answer.</H4><P>If your modem is not set up correctly, communications features might not function properly. The following procedures list steps in verifying the correct operation of your modem and the Windows&nbsp;95 communications subsystem.</P>
<P>Because some communications programs designed for Windows 3.1 install incompatible driver files, which can cause COM ports and modems to stop working, start by verifying that the correct Windows&nbsp;95 files are being loaded.</P>
<H4><A NAME="sec1"></A>To verify that the required communications files are present</H4><OL><LI>Verify file sizes and dates of COMM.DRV and SERIAL.VXD in the SYSTEM directory against the original versions from the Windows&nbsp;95 floppy disks or compact disc.</LI><LI>Confirm that the following lines are present in SYSTEM.INI:</LI></OL><UL><LI>[boot]</LI><LI>comm.drv=comm.drv</LI><LI>[386enh]</LI><LI>device=*vcd</LI></UL><OL><LI>To revert to the default communications drivers for Windows&nbsp;95, delete communications port entries in Device Manager. </LI><LI>Run the Add New Hardware wizard in Control Panel to detect and install the Windows&nbsp;95 drivers. </LI></OL><P><B>Note</B>   Windows&nbsp;95 does not load the SERIAL.VXD driver in SYSTEM.INI. Rather, Windows&nbsp;95 loads it on demand by using the Registry. Also, there is no corresponding file for the *vcd entry in SYSTEM.INI. This is an internal file built into VMM32.VXD.</P>
<H4><A NAME="sec2"></A>To verify the modem configuration by using the Modems option in Control&nbsp;Panel</H4><OL><LI>In General properties, verify that the manufacturer and model for your modem are correct. If not, you might have changed the modem and failed to reconfigure it. In this case, run the Install New Modem wizard to detect the modem and confirm it with the current Registry configuration.</LI><LI>If your modem does not appear in the list of installed modems, click Add, and then select the appropriate modem. </LI><LI>If the manufacturer and model are not correct and are not available from the list, try the Hayes-compatible option or the Generic Modem driver option, set to the maximum speed supported by the modem. Click OK. </LI><LI>Try removing any other modem entries in the list to eliminate any conflicts.</LI></OL><H4><A NAME="sec3"></A>To verify that the modem is enabled by using the System option in Control&nbsp;Panel</H4><OL><LI>Click the Device Manager tab, click a modem from the list, and then click Properties. </LI><LI>Click the option named The Device Is Present, Please Use It, if this is not already selected.</LI></OL><H4><A NAME="sec4"></A>To verify that the port is correct by using the Modems option in Control&nbsp;Panel</H4><OL><LI>In General properties, click a modem, and then click the Properties button. </LI><LI>In General properties for that modem, verify that the listed port is correct. If not, select the correct port. Click OK.</LI></OL><H4><A NAME="sec5"></A>To determine if a serial port's I/O address and IRQ settings are properly defined by using the System option in Control&nbsp;Panel</H4><OL><LI>Click the Device Manager tab, click Ports, and then click a specific port (such as COM2).</LI><LI>Click the Properties button, and then click the Resources tab to display the current resource settings (IRQ, I/O) for that port. To find the correct settings, consult the modem manual.</LI><LI>In the Resources properties, check the Conflicting Devices List to see if the modem is using resources in conflict with other devices.</LI><LI>If the modem is in conflict with other devices, click the Change Setting button, and then click a Basic Configuration that does not cause resource conflicts.</LI></OL><P><B>Note</B>   Do not try to use a modem on COM3 if there is a serial mouse or other device on COM1. Usually, COM1 and COM3 ports use the same IRQ, meaning that they cannot be used simultaneously on most computers. The COM2 and COM4 ports have the same problem. If possible, change the COM3 or COM4 port to an IRQ setting that is not in conflict. Also, some display adapters (especially S3, 8514A and ATI mach8) have an address conflict with COM4 ports. You can work around this by using another COM port or replacing your display adapter. </P>
<H4><A NAME="sec6"></A>To check the port settings by using the Modems option in Control Panel</H4><OL><LI>Click a modem in the list box, and then click Properties. </LI><LI>Click the Connection tab to check the current port settings, such as bits per second (speed), data bits, stop bits, and parity. </LI><LI>Click the Advanced button to check error control and flow control. If you are using Win16-based applications, turn off these advanced features. </LI><LI>Verify the UART type.<B> </B>
<P>Data transmission problems can occur if a speed greater than 9600 is selected on a slower 80386-based computer not equipped with a 16550 UART, or when performing other tasks during a file download. If problems or errors occur during transmission, try lowering the speed. Attempting to use speed greater than 9600 on computers equipped with 8250 or 16450 UARTs will probably result in dropped characters. </P></LI></OL><H4><A NAME="sec7"></A>To check the modem speed by using the Modems option in Control Panel</H4><OL><LI>Click a modem in the list box, and click the Properties button.</LI><LI>In the General properties, check the speed to make sure it isn't set too high for either the modem or computer. Lower speeds might work, especially when using an older, slower computer. </LI><LI>Click the option named Only Connect At This Speed if it is not already selected. </LI></OL><P><B>Tip</B>   To optimize communications performance, you can set the speed higher if your computer has an 80486 or a Pentium processor. </P>
<H4><A NAME="sec8"></A>To disable hardware flow control if your modem cable doesn't support it</H4><OL><LI>In the Modems option in Control Panel, click a modem in the list box, and then click the Properties button.</LI><LI>Click the Connection tab, and then click the Advanced button.</LI><LI>If a check appears in the Use Flow Control check box, click the box to clear it.</LI></OL><H4><A NAME="sec9"></A>To remove VxDs from other vendors that might be interfering with modem operation</H4><UL><LI>Search for and comment out (type a semicolon as the first character of the line) any related entries in the SYSTEM.INI file. When commenting out a line in SYSTEM.INI, it is useful to add a comment line denoting this.</LI></UL><h5><A NAME="sec10"></A>The initialization (dialing) string is improper for the modem.</H5><P>If the modem will not pick up the line and dial, it might be due to an improper initialization string. Typically, the manufacturer's recommended dial command string is loaded from the corresponding modem INF file; however, if your modem driver was not available and you selected a compatible modem, the dial command string might not work correctly. Try using the modem types, and retest the modem dialing the selected number.</P>
<h5><A NAME="sec11"></A>The modem repeatedly drops the connection.</H5><UL><LI>Check for a bad or loose serial cable to the modem. If all connections are tight, test for a faulty cable by replacing it with a working cable, and retest the modem communications. </LI><LI>Check the connection between the RJ-11 phone outlet and the modem. Verify that the connection is firmly plugged in and well connected.</LI><LI>Try using a different phone line. If you have ruled out other factors, consistent modem errors might be due to problems in the telephone line used for communication.</LI><LI>Disable call waiting, if it is in use. The call waiting feature can interfere with remote connections and file transfers. If you use this feature regularly, disable it only temporarily (during the time the modem is in use).</LI><LI>Check communications with the host computer. The communications problems might be due to the host computer not connecting or repeatedly dropping the line.</LI><LI>Try using a lower speed in the modem properties in the Modems option in Control Panel.</LI></UL><h5><A NAME="sec12"></A>The COM ports remain in Device Manager after the modem is removed.</H5><P>After installing an internal modem and assigning it to a COM port that does not physically exist on your computer, the port appears in the Device Manager. After removing this adapter, you might also need to manually remove the port in Device Manager as described in Chapter 19, "Devices." </P>
<h5><A NAME="sec13"></A>You are unable to dial international calls. </H5><P>Windows&nbsp;95 allows you to set specific modem properties that assist you when making international calls over your modem. You set these properties in Dial-Up Networking, Dialing Properties, and in the modem properties.</P>
<H4><A NAME="sec14"></A>To check location and calling card settings</H4><OL><LI>In Phone Dialer, click Tools, and click Dialing Properties.</LI><LI>In the My Locations properties, verify that your calling location and calling card settings are correct. </LI></OL><H4><A NAME="sec15"></A>To disable dial-tone detection if your modem fails to detect a dial tone</H4><UL><LI>In the Modems option in Control Panel, click the Connection tab, and click to clear the check box next to the Use Dial Tone option.</LI></UL><H4><A NAME="sec16"></A>To increase the time between dialing if connections are taking a long time </H4><UL><LI>In the Modems in Control Panel, click the Connection tab, and then increase the number of seconds in the Cancel the Call If Not Connected Within option. </LI></UL><H4><A NAME="sec17"></A>To manually control modem dialing</H4><UL><LI>See "Dialing Manually" earlier in this chapter. </LI></UL><H4><A NAME="sec18"></A>To display a terminal window to type AT commands before or after dialing</H4><UL><LI>See "Displaying the Terminal Window" earlier in this chapter. </LI></UL></FONT></BODY></HTML>
