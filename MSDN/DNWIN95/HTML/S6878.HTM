<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>[Install]</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h3>[Install]</H3><P>The [Install] section sets parameters for copying additional files as part of Windows&nbsp;95 installation. The format for this section is identical to the format for the [Install] section in general INF files, as defined in Appendix C, "Windows 95 INF Files." </P>
<P>The following sections provide these examples for using the [Install] section for custom installations:</P>
<UL><LI>Installing custom bitmaps and shortcuts</LI><LI>Enabling user profiles and remote administration</LI><LI>Disabling TSRs and replacing protocols</LI></UL><H4><A NAME="sec0"></A>[Install] Example: Copying Custom Files</H4><P>This section describes MSBATCH.INF entries for copying custom files while installing Windows&nbsp;95. In the following example, custom files are copied for a bitmap file containing a corporate logo plus a shortcut to be placed in the Network Neighborhood. These custom files must be created by the administrator and placed with the Windows&nbsp;95 source files on the network.</P>
<P><BR></P>
<pre><code>[install]
CopyFiles=newfiles.Copy
<BR>[NEWFILES.Copy]   
my_corp.bmp      ; bitmap file
my_link.lnk      ; file that contains the shortcut
<BR>[DestinationDirs]
newfiles.copy=25   ; shared Windows directory</code></pre>
<P>The statement in [DestinationDirs] specifies where files are to be copied. Common values include the following for shared installations:</P>
<UL><LI>10 = machine directory</LI><LI>11 = Windows SYSTEM directory</LI><LI>25 = Windows directory </LI></UL><P>Notice that the most flexible means of providing custom links for multiple users is to use system policies. For information about using system policies to create a custom Network Neighborhood or a custom desktop, see Chapter 15, "User Profiles and System Policies."</P>
<H4><A NAME="sec1"></A>[Install] Example: Enabling User Profiles and Remote Administration</H4><P>If you plan to take advantage of user profiles and to allow administration of remote computers, you can enable these capabilities using setup scripts. The following entries are required in MSBATCH.INF to enable these features.</P>
<P><BR></P>
<pre><code>[Install]
AddReg=User.Profiles,Remote.Admin
<BR>[User.Profiles]
HKLM,"Network\Logon","UserProfiles",1,1
<BR>[Remote.Admin]
HKLM,"Security\Access\Admin\Remote",%Server_Domain_Username%,1,ff,00
<BR>[Network]
Security=<I>domain_or_server   </I>;enables user-level security
PassThroughAgent=<I>provider_name</I>
services=remotereg   ;installs the Microsoft Remote Registry agent
<BR>[strings]
; specifies the server containing the group or individual account 
; to be allowed remote administration capabilities 
Server_Domain_Username = "<I>server_or_domain</I>\<I>account</I>"</code></pre>
<H4><A NAME="sec2"></A>To define the custom values required for enabling remote administration</H4>
<OL>
<LI>To enable user-level security, set the appropriate values in the [Network] section for <B>Security=</B> and <B>PassThroughAgent=</B>. 
<P>For example, on a NetWare network, if the security provider is a server named NWSVR1:</P></LI>
<UL>
<LI>Security=server</LI>
<LI>PassThroughAgent=NWSVR1
<P>On a Windows NT network, if the security provider is a domain named NTDOM1:</P></LI><LI>Security=Domain</LI>
<LI>PassThroughAgent=NTDOM1</LI>
</UL>
<LI>In the [Strings] key, define the value for <B>%server_domain_username%</B> to specify the location for the list of user accounts, plus the names of accounts for users who will be allowed remote administration capabilities for this particular computer. 
<P>For example, for a NetWare network, the following specifies the server containing the group or individual account, plus the account name to be given remote administration capabilities:</P></LI>
</OL>
<UL>
<LI>Server_Domain_Username = "NWSVR\HELPDESK"
<P>For a Microsoft NT network, the following specifies the domain containing the account, plus the account name to be given remote administration capabilities:</P></LI><LI>Server_Domain_Username = "NTDOM1\ADMIN"</LI></UL><P><B>Important</B>   You must also make sure that the related files supporting Microsoft Remote Registry services are installed with the Windows&nbsp;95 source files. To do this, use INF Installer, as described in Chapter 5, "Custom, Automated, and Push Installations."</P>
<P>When you enable remote administration in this way, Setup automatically adds the appropriate Administrators account (including Supervisor and Domain Administrators under Windows&nbsp;NT) to the list of persons or groups allowed to administer the computer remotely, and sets the permissions required for remote administration. </P>
<P>Enabling user profiles in a setup script is the equivalent of selecting the items in the Passwords option in Control Panel named Users Can Customize Their Preferences And Desktop Settings and Include Desktop Icons And Network Neighborhood Settings. </P>
<H4><A NAME="sec3"></A>To enable group policies</H4><UL><LI>If you want to enable group policies for both the Client for Microsoft Networks and Client for NetWare networks, add the following entries to MSBATCH.INF:</LI><p>[Install]</p><p>Addreg=User.Profiles.Reg, Group.Policies.Reg</p><p>Copyfiles=Group.Policies.Copy</p><p><BR>[User.Profiles.Reg]</p><p>HKLM,Network\Logon,UserProfiles,1,1</p><p><BR>[Group.Policies.Reg]</p><p>HKLM,Network\Logon,PolicyHandler,,"GROUPPOL.DLL,ProcessPolicies"</p><p>HKLM,System\CurrentControlSet\Services\MSNP32\NetworkProvider,</p><p>   GroupFcn,,"GROUPPOL.DLL,NTGetUserGroups"</p><p>HKLM,System\CurrentControlSet\Services\NWNP32\NetworkProvider,</p><p>   GroupFcn,,"GROUPPOL.DLL,NWGetUserGroups"</p><p><BR>[Group.Policies.Copy]</p><p>grouppol.dll</p><p><BR>[DestinationDirs]</p><p>Group.Policies.Copy = 11</p></UL><P>For information about user profiles and group policies, see Chapter 15, "User Profiles and System Policies." For information about remote administration of a computer's Registry, see Chapter 16, "Remote Administration."</P>
<H4><A NAME="sec4"></A>[Install] Example: Replacing Configuration Entries</H4><P>This section presents some sample entries for replacing entries in configuration files as part of Windows&nbsp;95 Setup.</P>
<P>Depending on the common network configuration at your site, you may determine that you need to remove a line from one or more configuration files as a global procedure before starting Windows&nbsp;95 Setup. For example, you may want to use a protected-mode protocol such as Microsoft TCP/IP instead of the real-mode version of TCP/IP currently being using on the target computers. The following kinds of entries can be used to make these changes during the installation process.</P>
<P><B>Note</B>   If you want to remove TSRs when installing Windows&nbsp;95 on a NetWare network, you should modify the NETDET.INI file rather than making modifications using MSBATCH.INF. For information, see Chapter 9, "Windows 95 on NetWare Networks."</P>
<P><BR></P>
<pre><code>[Install]
UpdateInis=update_prot.Ini   
UpdateCfgSys=Update_config.sys   
UpdateAutoBat=Update_autoexec.bat
<BR>[Update_prot.Ini]
system.ini,386enh,"device=mytcp.386"
<BR>[Update_config.sys]
<BR>[Update_autoexec.bat]</code></pre></FONT></BODY></HTML>
