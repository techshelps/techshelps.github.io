<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Final System Configuration Phase</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h3>Final System Configuration Phase</H3><P>During the final system configuration phase, Windows&nbsp;95 Setup upgrades the existing configuration of Windows and replaces the existing version of MS-DOS with the new Windows&nbsp;95 operating system (if you are upgrading an existing version of Windows). During this process, Setup restarts the computer running Windows&nbsp;95.</P>
<P>When Windows&nbsp;95 Setup completes this phase, it displays a message to indicate that the installation was successful and it prompts you to restart the computer. After you click OK but before Windows 95 Setup restarts the computer, Setup modifies the boot sector of the boot drive by adding a new system file (IO.SYS) that takes the place of the MS-DOS files IO.SYS and MSDOS.SYS. The old files are renamed to IO.DOS and MSDOS.DOS.</P>
<P>After the files are updated and the operating system is configured, Windows&nbsp;95 Setup uses wizards to guide you through a process to configure peripheral devices (such as printers) connected to the computer. More files might also be copied here, and you might be asked to restart the computer again.</P>
<P></P>
<H4><A NAME="sec0"></A>Initializing the System after Setup</H4><P>After first restarting the computer during the final system configuration phase, Windows&nbsp;95 Setup updates configuration files by performing the following steps:</P>
<UL><LI>WININIT.EXE processes three sections in WININIT.INI to combine all the virtual devices (VxDs) intoVMM32.VXD and to rename files initially used by Setup, including ARIAL.WIN, USER32.TMP, and LOGO.SYS.</LI><LI>SYSTEM.DAT is renamed to SYSTEM.DA0, and SYSTEM.NEW is renamed to SYSTEM.DAT.</LI><LI>A flag is set in the Registry that indicates this is the first time Windows&nbsp;95 is being run after a new installation. Hardware manufacturers can also add specific entries to the Run-Once Registry key.</LI><LI>The Run-Once module is run to complete the initial configuration of PCMCIA and MIDI devices, to set up printers (if you are not installing in an existing Windows directory), and to run custom hardware manufacturers' setup programs. 
<P><B>Important</B>   If the system fails when running these first-time programs, restart Windows&nbsp;95 rather than rerunning Windows&nbsp;95 Setup. </P></LI><LI>The Program Group converter (GRPCONV) adds existing Windows 3.x .GRP files to the PROGRAMS directory and renames the files using long filenames. </LI></UL><P>Windows&nbsp;95 installation is now complete.</P>
<H4><A NAME="sec1"></A>Modifying the Boot Drive after Setup</H4><P>Windows&nbsp;95 places the real-mode operating system files named IO.SYS, MSDOS.SYS, and COMMAND.COM in the root directory of the computer's boot drive. The real-mode files needed to connect to the network are also placed on the computer's boot drive or device. (These filenames vary, depending on the network you use.)</P>
<P>Windows&nbsp;95 detects boot drives and compression drivers, and writes certain startup files to the boot device. </P>
<H4><A NAME="sec2"></A>Verifying the Installation</H4><P>Setup has an option for verifying the installation, as described in "Safe Detection, Safe Recovery, and Verification" later in this chapter. So, Windows&nbsp;95 Setup can install files on your disk without actually having to transfer all of the file data from the floppy disk drive, network, or other source. As a part of this process, Windows&nbsp;95 rebuilds VMM32.VXD or recopies any files it finds to be damaged.</P>
<P>For Safe Recovery, Windows&nbsp;95 Setup places the following two lines in AUTOEXEC.BAT during installation:</P>
<P><BR></P>
<pre><code>@if exist c:\wininst0.400\suwarn.bat call C:\wininst0.400\suwarn.bat<BR>@if exist c:\wininst0.400\suwarn.bat del C:\wininst0.400\suwarn.bat</code></pre>
<P>The SUWARN.BAT file is run only once after a failed installation. These lines are removed when Windows&nbsp;95 Setup is complete.</P></FONT></BODY></HTML>
