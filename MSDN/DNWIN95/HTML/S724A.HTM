<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Technical Notes for Microsoft Fax</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h2>Technical Notes for Microsoft Fax</H2><P>This section describes technical information about Microsoft Fax architecture and Registry entries.</P>
<P>You can send faxes either by using the mail client or the Microsoft Fax printer driver. In each case, the message is sent to the Microsoft Fax service provider by using MAPI. If you sent the message from a mail client, it might contain text, embedded OLE formats, and attachments. If you sent it by using the Microsoft Fax printer driver, the mail message will contain a rendered format of the file as an attachment to the mail message.</P>
<P>MAPI allows messages to be preprocessed based on the transport protocol used to send them. The transport protocol chooses the correct modem connection, uses TAPI to create a dial string, and sends the message to that recipient. The preprocessor determines whether to render the message into a fax form to be printed by a fax machine. The rendered format is attached to the original message as a message property and is deleted either when the message is sent or when the transport protocol tries to send the message but determines it cannot.</P>
<P>If the message does not have to be rendered, the message is converted from its original binary format to a line image (also called a linearized form), and then it is compressed. </P>
<P>After the message is submitted, the transport protocol determines what type of recipient the message is intended for as follows:  </P>
<UL><LI>If it is a traditional fax recipient and the user has selected printed form or "best available," Microsoft Fax will render the document into the standard Group 3 image format. This can be used by standard fax machines and software. If the user selects editable form, an error message is returned.</LI><LI>If the recipient is a Microsoft At Work-enabled recipient and the user has selected printed form, then it will render the document into the Microsoft Fax rendered format. This format provides high-quality images of smaller size than standard Group 3 and it is used between Microsoft At Work devices, including fax machines and printers. </LI><LI>If the recipient is a Microsoft Fax recipient and the user has selected editable form, no rendering is required. </LI><LI>If there is a mix of recipients, and the user has selected "best available," then Group 3 and editable versions of the document are packaged in the message. </LI><LI>If the capabilities of the recipient are unknown, Microsoft Fax creates multiple formats to be sure that the proper format is available upon connect.</LI></UL><P>Fax-form messages sent to Microsoft At Work devices will be sent by using BFT with the resource-based rendering of the message sent as an attachment.</P>
<P>The Registry keys for a fax modem are found in:</P>
<P><BR></P>
<pre><code>Hkey_Local_Machines\Software\Microsoft\At Work Fax\<I>Local Modems</I></code></pre>
<P></P>
<P>For each local modem that has been installed by Windows&nbsp;95, information is stored in the key named TAPI<I>nnnnnnnn</I> where <I>nnnnnnnn </I>is an arbitrary number assigned by TAPI. The TAPI key contains subkey values. Values that are important to the system administrator are described in the following tables. </P>
<P></P>
<P>The following table lists the modem command strings used to reset the modem whenever Microsoft Fax acquires it from TAPI:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="258pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Subkey</B></P></TD><TD VALIGN="TOP"><P><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP"><P>ResetCommand </P></TD><TD VALIGN="TOP"><P>This "AT" command string includes:</P>
<P> <FONT FACE="symbol"></FONT>  Load factory defaults: &amp;F</P>
<P> <FONT FACE="symbol"></FONT>  Disable auto-answer: S0=0</P>
<P> <FONT FACE="symbol"></FONT>  Echo OFF: E0</P>
<P> <FONT FACE="symbol"></FONT>  Verbose ON: V1</P>
<P> <FONT FACE="symbol"></FONT>  Quiet OFF: Q0</P>
<P>The default depends on fax modem. Typically, <B>AT&amp;FS0=0E0V1Q0</B>.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>The following table lists the setup modem command string used to set up the modem before dialing or answering:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="260pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Subkey</B></P></TD><TD VALIGN="TOP"><P><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP"><P>SetupCommand </P></TD><TD VALIGN="TOP"><P>This "AT" command string includes:</P>
<P> <FONT FACE="symbol"></FONT>  Max dial-tone timeout: S7=255</P>
<P> <FONT FACE="symbol"></FONT>  Tie DTR drop to reset: &amp;D3</P>
<P> <FONT FACE="symbol"></FONT>  XON/XOFF flow control: Varies</P>
<P>The default depends on fax modem. Typically, <B>ATS7=255&amp;D3&amp;K4</B>.</P></TD></TR><TR><TD VALIGN="TOP"><P>ExitCommand</P></TD><TD VALIGN="TOP"><P>This command string is issued to the modem after hang-up, and just before releasing the port. The default is empty.</P></TD></TR><TR><TD VALIGN="TOP"><P>FixSerialSpeed</P></TD><TD VALIGN="TOP"><P>This command string specifics the port speed. The default is <B>19200</B>.</P></TD></TR><TR><TD VALIGN="TOP"><P>PreAnswerCommand</P></TD><TD VALIGN="TOP"><P>This modem command string is issued to the modem just before issuing the ATA (answer) command. Microsoft Fax will have already issued the Setup command, and the command to go to the appropriate Fax Class (Class 1 or 2). The default is empty.</P></TD></TR><TR><TD VALIGN="TOP"><P>PreDialCommand</P></TD><TD VALIGN="TOP"><P>This modem command string is issued just before issuing an ATA (dial) command. Microsoft Fax will have already issued the Setup command, and the command to go to the appropriate Fax class (class 1or 2). The default is empty.</P></TD></TR><TR><TD VALIGN="TOP"><P>HighestSendSpeed</P></TD><TD VALIGN="TOP"><P>This modem command string specifies the highest speed to try sending a fax, in bits per second. A value of 0 forces the highest available speed. The default is <B>0</B>.</P></TD></TR><TR><TD VALIGN="TOP"><P>LowestSendSpeed</P></TD><TD VALIGN="TOP"><P>This modem command string specifies the lowest speed to try sending a fax, in bits per second. A value of 0 forces the lowest available speed. The default is <B>0</B>.</P></TD></TR><TR><TD VALIGN="TOP"><P>EnableV17Send</P></TD><TD VALIGN="TOP"><P>If 0, this command string disables use of V.17 (14.4 kbps, short train) for sending. The default is <B>1</B>.</P></TD></TR><TR><TD VALIGN="TOP"><P>EnableV17Recv</P></TD><TD VALIGN="TOP"><P>If 0, this command string disables use of V.17 (14.4 kbps, short train) for receiving. The default is <B>1</B>.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>For more information about the Registry, see Chapter 33, "Windows 95 Registry."</P>
<P></P></FONT></BODY></HTML>
