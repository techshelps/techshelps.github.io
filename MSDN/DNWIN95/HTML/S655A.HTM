<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Administrative Considerations for Long Filenames</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h3>Administrative Considerations for Long Filenames</H3><P>If you are supporting long filenames at a site with many users, the following issues must be considered:</P>
<UL><LI>If you back up files to a server that does not support Windows&nbsp;95 long filenames, use the LFNBK utility to save and restore long filenames. For information, see "Using the LFNBK Utility for Temporary Compatibility" later in this chapter.</LI><LI>Be aware of utilities that will not work with the new Windows&nbsp;95 directory entries for long filenames. Some virus scanning programs, disk repair utilities, disk optimizers, and other programs depend on the FAT file system and might not work with long filenames. If you are unsure whether a utility is compatible with the long filename system, check with the manufacturer. If you must use an incompatible program, be sure to turn off long filenames by using the LFNBK utility before proceeding.</LI><LI>Do not use filenames that are more than 50 to 75 characters long. Although filenames can be up to 255 characters, the full path name cannot be more than 260 characters. To save room for moving a file from one directory to another, use filenames shorter than the limit. Besides, filenames that are too long can make browsing a list difficult.</LI><LI>Publish a naming convention for your site so that users are aware of naming considerations and can prevent problems with the long filenames they use. For example, your policy could recommend making the first three or four letters significant, so that the 8.3 filename aliases can be distinguished from each other. The following example shows the alias names for some long filenames:</LI><LI>Status Report for Oct   -&gt;   STATUS~1.TXT</LI><LI>Status Report for Nov   -&gt;   STATUS~2.TXT</LI><LI>Status Report for Dec   -&gt;   STATUS~3.TXT
<P>Using the following alternate filenames, you can distinguish between the 8.3 filenames:</P></LI><LI>Oct Status Report   -&gt;   OCTSTA~1.TXT</LI><LI>Nov Status Report   -&gt;   NOVSTA~1.TXT</LI><LI>Dec Status Report   -&gt;   DECSTA~1.TXT
<P>You could also recommend that users give files a short filename as part of the long filename. For example:</P></LI><LI>Mktg_rpt - Marketing Report for our new project   -&gt;   MKTG_R~1.TXT
<P>As part of the naming convention, recommend that users check the properties for files to ensure that the alias (the MS-DOS Name in the properties dialog box) is what they expect it to be.</P></LI></UL><H4><A NAME="sec0"></A>Tip for Long Filenames in the Root Directory </H4><P>Usually, it is best to store files in a directory beneath the root directory. This is especially true for files with long filenames. Files with long filenames use more directory entries than files with 8.3 filenames. Because the number of entries in the root is limited to 512, the root directory can fill up with fewer files if long filenames are used.</P>
<P>Notice that typing the command <B>mkdir Examples</B> creates a long filename directory entry that contains the name Examples to preserve the case, plus an 8.3 filename alias entry with the name EXAMPLES for compatibility. In this example, two directory entries are used.</P>
<H4><A NAME="sec1"></A>Using the LFNBK Utility for Temporary Compatibility</H4><P>Most hard disk utility programs released before Windows&nbsp;95 require updating to work correctly with Windows&nbsp;95. If you use a hard disk utility that was not created especially for use with Windows&nbsp;95, you might lose long filenames and you are at risk of losing data. Examples of such programs include the following:</P>
<UL><LI>Norton Utilities&reg; by Peter Norton Computing</LI><LI>PC Tools&trade; by Central Point Software, Inc.</LI><LI>Microsoft Defragmenter for MS-DOS version 6.0, 6.2, 6.21, or 6.22</LI><LI>Stacker 4.0 by STAC Electronics</LI></UL><P>In special cases, you might need to run backup or disk management utilities created for older versions of Windows or MS-DOS that are not compatible with the extended file system capabilities of Windows&nbsp;95. Or you might need occasionally to run an application that is not compatible with long filenames. In such cases, you can use the LFNBK utility to remove (and later restore) long filenames on a disk.</P>
<H4><A NAME="sec2"></A>To install the LFNBK utility</H4><UL><LI>From the Windows&nbsp;95 compact disc, copy LFNBK.EXE to the Windows directory on your computer.</LI></UL><P><b>Caution</b>
</P>
<P>The LFNBK utility is intended for use only by experienced Windows&nbsp;95 users with special needs for compatibility with older disk utilities. It is not intended for everyday use by average users. </P>
<P>Microsoft recommends that users rely on the disk management utilities included with Windows&nbsp;95 or use Windows&nbsp;95-compatible utilities from other vendors, rather than attempting to use older utilities that are not compatible with Windows&nbsp;95.</P>
<P>Notice also that the DriveSpace utility included with Windows&nbsp;95 is compatible with long filenames and can be used without LFNBK to manage compressed disks created with older versions of DriveSpace or DoubleSpace.</P>
<P>The following shows the syntax for LFNBK:</P>
<P><B>lfnbk</B> [<B>/v</B>] [<B>/b</B> | <B>/r</B> | <B>/pe</B>] [<B>/nt</B>] [<B>/force</B>] [<B>/p</B>] [<I>drive</I>]</P>
<P>The following table lists and describes the parameters for this command.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="74pt" VALIGN="TOP"><COL WIDTH="273pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Parameter</B></P></TD><TD VALIGN="TOP"><P><B>Description</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>/v</B></P></TD><TD VALIGN="TOP"><P>Reports actions on the screen.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>/b</B></P></TD><TD VALIGN="TOP"><P>Backs up and removes long filenames on the disk.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>/r</B> </P></TD><TD VALIGN="TOP"><P>Restores previously backed-up long filenames.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>/pe</B></P></TD><TD VALIGN="TOP"><P>Extracts errors from backup database.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>/nt</B></P></TD><TD VALIGN="TOP"><P>Does not restore backup dates and times.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>/force</B></P></TD><TD VALIGN="TOP"><P>Forces LFNBK to run, even in unsafe conditions.</P></TD></TR><TR><TD VALIGN="TOP"><P><B>/p</B></P></TD><TD VALIGN="TOP"><P>Finds long filenames, but does not convert them to 8.3 filename aliases. This reports the existing long filenames, along with the associated dates for file creation, last access, and last modification of the file.</P></TD></TR></TBODY></TABLE>
<P><BR></P><H4><A NAME="sec3"></A>To preserve long filenames with disk utilities that do not recognize them</H4><OL><LI>Turn off tunneling.
<P>To do this, in the System option in Control Panel, click the Performance tab, and then click File System. In the File System Performance dialog box, click the Troubleshooting tab, and check the option named Disable Long Name Preservation for Old Programs.</P></LI><LI>Close all other applications. LFNBK cannot rename open files.</LI><LI>At the command prompt, type <B>lfnbk /b</B> [<I>drive</I>] to back up and remove long filenames.</LI><LI>Restart the computer, and then run the disk utility. If it is an MS-DOS – based utility, run it in MS-DOS Mode. For a Windows-based utility, run it in the usual way.</LI><LI>Turn tunneling on again, and then restart the computer. </LI><LI>At the command prompt, type <B>lfnbk /r</B> [<I>drive</I>] to restore long filenames.</LI></OL><P>The LFNBK utility actually renames each file with a long filename to its associated alias. The filename changes are stored in the LFNBK.DAT file in the root of the drive where you are running LFNBK. This file is used to restore long filenames (when you run LFNBK with the <B>/r</B> switch). </P>
<P>The following list provides some brief notes for using the LFNBK utility:</P>
<UL><LI>You cannot use LFNBK to repair long filename problems.</LI><LI>LFNBK might not be able to rename files with exact matches to long-filename aliases, and the related alias is not guaranteed to be the same as before running LFNBK.</LI><LI>After you run LFNBK and then restart Windows&nbsp;95, the default Start menu will appear, rather than your custom Start menu. After you run <B>lfnbk /r</B> to restore long filenames, your custom Start menu will also be restored.</LI><LI>If the directory structure changes after you run <B>lfnbk /b</B>, then long filenames cannot be restored with <B>lfnbk /r</B>. For example, if you run a disk utility that prunes or removes subdirectories, LFNBK cannot restore the long filenames within those subdirectories.</LI></UL><H4><A NAME="sec4"></A>Creating Long Filenames at the MS-DOS Prompt</H4><P>At an MS-DOS prompt or when Windows&nbsp;95 is started only at the command prompt (from the F8 Startup menu), the keyboard buffer's ability to create long filenames is limited to 127 characters. This is because the default command-line character limitation is 127 characters. In the default configuration, the MS-DOS environment will not allow more than 127 characters in a given command line. (However, in batch files, or for environment variables and other VM elements, the long filename support is 244 characters.)</P>
<P>You can increase the global command-line character limit for the keyboard buffer to its maximum by placing the following line in CONFIG.SYS:</P>
<P><BR></P>
<pre><code>shell=c:\windows\command.com /u:255</code></pre>
<P>If the <B>shell</B> command is already present with the <B>/u</B> switch, increase the value to 255.</P>
<P>This command will affect all VMs and the Windows&nbsp;95 command line.</P>
<P>With the command-line character limit set to its maximum of 255 characters, filenames are limited to 255 characters minus the contents of the command line. For example, the command line might contain the following:</P>
<P><BR></P>
<pre><code>copy con "long filename"</code></pre>
<P>In this case, the maximum length of the long filename is 244 characters (255 minus the 11 characters of the command).</P>
<P><b>Note</b></P>
<P>It is necessary to put the filename in quotation marks on the command line only if the filename contains special characters such as spaces.</P>
<P>Notice, however, MS-DOS – based applications configured to run in MS-DOS Mode use only the real-mode FAT file system. Because of this, long filenames created in a Windows environment are not visible when the system runs in MS-DOS Mode; only the 8.3 filename aliases are visible.</P>
<P>The same is true of files with long filenames that are copied to a floppy disk subsequently used by a down-level FAT file system such as MS-DOS 6.0, Windows 3.1, OS/2 2.11, Windows&nbsp;NT 3.1, and so on.) On down-level file systems, only the 8.3 filename alias is visible on the floppy disk, even if it contains long filenames created in Windows&nbsp;95.</P>
<H4><A NAME="sec5"></A>Technical Notes on Long Filenames</H4><P>This section summarizes some technical points with regard to long filenames. This information will be helpful to you if you experience problems with long filenames.</P>
<P><B>Long filenames cannot be used on SUBST drives.</B></P>
<P>Windows&nbsp;95 supports SUBST only for backward compatibility with drives created on older systems. Filenames on SUBST drives must comply with the 8.3 filename rule.</P>
<P><B>Turning off numeric tails for filename aliases.</B></P>
<P>If you do not want to use filename aliases that automatically use a numeric tail (~<I>n</I>), you can force the file system to create friendly 8.3 filename aliases, at least for the first instance of the 8.3 filename. </P>
<H4><A NAME="sec6"></A>To use friendly alias names instead of numeric tails </H4><UL><LI>Add the value <B>NameNumericTail = 0</B> in the following Registry key:
<P>Hkey_Local_Machine\System\CurrentControlSet\Control\FileSystem</P></LI></UL><P><B>Turning off the extended file system features.</B></P>
<P>In extremely rare cases, you might determine that you need to turn off the extended file system features in Windows&nbsp;95. In this case, you can enable the Windows 3.1 file system by changing the Registry. However, this is not a recommended option.</P>
<P>Using the older Windows 3.1 file system affects many of the features available under Windows&nbsp;95. Also, the Windows 3.1 file system was not tested extensively under Windows 95 in the same way as the new file system. You can expect the following results if you enable the Windows 3.1 file system:</P>
<UL><LI>No support is provided for long filenames</LI><LI>No extended file information is available, such as creation date and time, and last access date</LI><LI>Folders cannot be included with user profiles</LI></UL><H4><A NAME="sec7"></A>To enable the Windows 3.1 file system</H4><OL><LI>At the command prompt, run <B>lfnbk</B> <B>/b</B> to remove long filenames from the hard disk, as described in "Using the LFNBK Utility for Temporary Compatibility" earlier in this chapter.
<P> – Or –</P>

<P>At the command prompt, run <B>scandskw /o </B>to remove long filenames and all extended file attributes from the disk. To remove long filenames from removable disks, include the drive letter with the command; for example, <B>scandskw /o a: </B></P>

<P><B>Caution</B>   If you use <B>scandskw /o</B> to remove long filenames, ScanDisk will check all fixed disks and will repair disk errors without warning you. Changes made with <B>scandskw /o</B> cannot be reversed.</P></LI><LI>In Registry Editor, set the value of <B>Win31FileSystem</B> to <B>1</B> in the following Registry key. Then shut down and restart the computer.</LI></OL><UL><LI>Hkey_Local_Machine\System\CurrentControlSet\Control\FileSystem</LI></UL></FONT></BODY></HTML>
