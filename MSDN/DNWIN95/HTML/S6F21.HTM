<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Preparing Login Scripts for Push Installations</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h3>Preparing Login Scripts for Push Installations</H3><P>This section presents some information about creating login scripts that use an Upgrade account for installing Windows&nbsp;95 on client computers. Some of the login script statements described in this section are related to using the STARTUP.GRP file for Windows for Workgroups, as described in "Preparing a STARTUP.GRP File" earlier in this chapter.</P>
<P><b>Tip</b></P>
<P>Avoid using relative path names in login scripts and setup scripts so that you can ensure the commands are run from the correct directory.</P>
<P>Also, for shared installations, after Windows&nbsp;95 Setup is complete, make sure that all path statements in users' login scripts point to Windows&nbsp;95, and not Windows 3.x or MS-DOS directories.</P>
<P></P>
<P><B>Login scripts for Microsoft real-mode network clients.</B></P>
<P>For a computer running MS-DOS or Windows 3.1 with a Microsoft real-mode network client, the login script should be similar to the following:</P>
<P><BR></P>
<pre><code>net start full
net use <I>drive_letter</I>: \\<I>server\distshare</I>
<I>drive_letter</I>:setup <I>drive_letter</I>:<I>msbatch.inf</I></code></pre>
<P></P>
<P>If the client computer is running on a LAN Manager or Windows for Workgroups network, the login script must contain a <B>net start full</B> statement. On a Windows for Workgroups network, the real-mode network client for Windows for Workgroups or Windows&nbsp;3.1 also requires the entry <B>lmlogon=1</B> in the [Network] section of SYSTEM.INI. This ensures that the full network redirector is loaded and the user is validated for network logon. Other login script issues are discussed in the following section. </P>
<P> </P>
<P><B>Login scripts for Windows&nbsp;NT networks.</B></P>
<P>For client computers running MS-DOS or Windows 3.1 on a Windows NT network where an Upgrade account is to be used to install Windows&nbsp;95, the login script for must contain the following kinds of entries: </P>
<P><BR></P>
<pre><code>net use <I>source_drive \\ntserver\distshare </I>
<I>source_drive</I>:setup <I>source_drive</I>:<I>msbatch.inf</I></code></pre>
<P></P>
<P>If this login script will be used to upgrade computers that are currently running Windows for Workgroups, the login script must contain the following kinds of entries to use a STARTUP.GRP:</P>
<P><BR></P>
<pre><code>net use <I>source_drive \\ntserver\distshare</I>
rename <I>windowsdir</I>\startup.grp *.sav
copy <I>path</I>\startup.grp <I>windowsdir</I>\startup.grp</code></pre>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="257pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Value</B></P></TD><TD VALIGN="TOP"><P><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP"><P><I>Source_Drive </I></P></TD><TD VALIGN="TOP"><P>Maps a drive letter for the server containing the source files. This must be the same drive letter as specified in the STARTUP.GRP file. Check the <B>lastdrive=</B> setting in CONFIG.SYS to make sure that the drive letter specified on the preceding command line is a valid logical drive letter. If it is not, the network connection will not be made, and the Setup process will fail.</P></TD></TR><TR><TD VALIGN="TOP"><P><I>\\NTServer\DistShare </I></P></TD><TD VALIGN="TOP"><P>Specifies the Windows NT computer that contains the Windows&nbsp;95 source files.</P></TD></TR><TR><TD VALIGN="TOP"><P><I>WindowsDir </I></P></TD><TD VALIGN="TOP"><P>Specifies the relative path to the user's Windows directory.</P></TD></TR><TR><TD VALIGN="TOP"><P><I>Path</I></P></TD><TD VALIGN="TOP"><P>Specifies the path to the Startup group file.</P></TD></TR><TR><TD VALIGN="TOP"><P><I>User_Windows</I></P></TD><TD VALIGN="TOP"><P>Specifies the relative path to the user's Windows directory that will contain STARTUP.GRP. Use the relative drive and directory designation ( . ) instead of the actual path to the Windows directory (for example, C:\WINDOWS). Do not use the <B>WinDir</B> environment variable, because <B>WinDir</B> is not an accessible environment variable in the script.</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>For example, for a computer running Windows for Workgroups, the login script could be similar to the following:</P>
<P><BR></P>
<pre><code>net use k: \\ntserver\distshare
rename .\startup.grp *.sav
copy \winnt\system32\repl\import\scripts\startup.grp .\startup.grp
exit</code></pre>
<P></P>
<P><B>Login scripts for installing Windows&nbsp;95 on NetWare networks.</B></P>
<P>The login script for client computers running MS-DOS or Windows 3.1 must contain the following kinds of entries: </P>
<P><BR></P>
<pre><code>attach <I>nwserver</I>/<I>DistShare</I>:
map <I>source_drive</I>:<I>nwserver/DistShare</I>
<I>source_drive</I>:setup<I> source_drive</I>:<I>msbatch.inf</I></code></pre>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="108pt" VALIGN="TOP"><COL WIDTH="239pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Value</B></P></TD><TD VALIGN="TOP"><P><B>Description</B></P></TD></TR><TR><TD VALIGN="TOP"><P><I>Source_Drive</I></P></TD><TD VALIGN="TOP"><P>Specifies the same drive letter as specified in the Startup group</P></TD></TR><TR><TD VALIGN="TOP"><P><I>NWServer/DistShare</I></P></TD><TD VALIGN="TOP"><P>Specifies the NetWare server that contains the Windows&nbsp;95 source files</P></TD></TR></TBODY></TABLE>
<P><BR></P><P>For example, for a computer running MS-DOS or Windows 3.1 with a real-mode network client, the login script could be similar to the following:</P>
<P><BR></P>
<pre><code>attach nwserver1/win95
map k:nwserver1/win95
k:setup k:msbatch.inf</code></pre></FONT></BODY></HTML>
