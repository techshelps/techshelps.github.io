<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Devices Overview</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h2>Devices Overview</H2>
<P>In Windows 95, how you install a device depends on whether the device and the computer are Plug and Play compliant. To take full advantage of Plug and Play technology, a computer needs the following: </P>
<UL><LI>Plug and Play operating system (Windows&nbsp;95) </LI><LI>Plug and Play BIOS</LI><LI>Plug and Play-compliant hardware devices with drivers </LI></UL><P>The Plug and Play components perform the following tasks:</P>
<UL><LI>Identify the installed devices</LI><LI>Determine the device resource requirements</LI><LI>Create a nonconflicting system configuration</LI><LI>Program the devices</LI><LI>Load the device drivers</LI><LI>Notify the system of a configuration change</LI></UL><P>Windows&nbsp;95 handles the installation and configuration of Plug and Play-compliant devices automatically, and it provides a wizard to detect and configure legacy devices. Microsoft recommends that, whenever possible, you choose new Plug and Play-compliant devices, even for a legacy computer which does not have a Plug and Play BIOS. </P>
<P>Windows&nbsp;95 uses a large number of subsystems to control various classes of devices that identify logical device types such as the display, keyboard, and network. Each subsystem uses a different driver architecture and offers different user options and compatibility constraints, so different installation mechanisms are required for each class. For many devices, you must use Device Manager in the System option in Control Panel for configuration if you need to make manual changes.</P>
<P>The following table lists the default classes and shows where you can find the installation tools for changing the device driver.</P>
<P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="108pt" VALIGN="TOP"><COL WIDTH="243pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Class and device types</B></P></TD><TD VALIGN="TOP"><P><B>Where to configure this device</B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>Disk class: <BR>Disk drives and adapters</P></TD><TD VALIGN="TOP"><P>Properties for specific devices displayed under related disk controllers in Device Manager.</P></TD></TR><TR><TD VALIGN="TOP"><P>Display class: <BR>Display adapters</P></TD><TD VALIGN="TOP"><P>Display option in Control Panel. See "Configuring the Display" later in this chapter.</P></TD></TR><TR><TD VALIGN="TOP"><P>Keyboard class: <BR>Keyboard devices</P></TD><TD VALIGN="TOP"><P>Keyboard option in Control Panel. See online Help.</P></TD></TR><TR><TD VALIGN="TOP"><P>Modem class: <BR>Data and fax modems</P></TD><TD VALIGN="TOP"><P>Modem option in Control Panel. See Chapter 25, "Modems and Communications Tools."</P></TD></TR><TR><TD VALIGN="TOP"><P>Mouse class: <BR>Mouse devices</P></TD><TD VALIGN="TOP"><P>Mouse option in Control Panel. See online Help. See also "Configuring the Mouse" later in this chapter.</P></TD></TR><TR><TD VALIGN="TOP"><P>Multimedia class: <BR>Multimedia devices</P></TD><TD VALIGN="TOP"><P>Multimedia option in Control Panel. See the related media devices in Device Manager for game ports; see also Chapter 21, "Multimedia."</P></TD></TR><TR><TD VALIGN="TOP"><P>Network class: <BR>Network adapters</P></TD><TD VALIGN="TOP"><P>Properties for the network adapter under the Network option in Control Panel. See Chapter 12, "Network Technical Discussion."</P></TD></TR><TR><TD VALIGN="TOP"><P>PCMCIA class: <BR>PC Card sockets</P></TD><TD VALIGN="TOP"><P>Specific device's properties in Device Manager. See "Enabling PCMCIA Cards" later in this chapter.</P></TD></TR><TR><TD VALIGN="TOP"><P>Ports class: <BR>Ports </P></TD><TD VALIGN="TOP"><P>Ports properties in Device Manager. See "Configuring Communications Ports and Printer Ports" later in this chapter.</P></TD></TR><TR><TD VALIGN="TOP"><P>Printer class: <BR>Printers</P></TD><TD VALIGN="TOP"><P>Printers Folder (no class installer). See Chapter 23, "Printing and Fonts."</P></TD></TR><TR><TD VALIGN="TOP"><P>System class: <BR>System devices</P></TD><TD VALIGN="TOP"><P>Installation handled by the system. Configure using the device's properties in Device Manager.</P></TD></TR><TR><TD VALIGN="TOP"><P>Unknown class: <BR>Detected devices with no driver for Windows&nbsp;95 </P></TD><TD VALIGN="TOP"><P>Add New Hardware icon in Control Panel. See "Installing New Devices" later in this chapter.</P></TD></TR></TBODY></TABLE>
<P><BR></P><H3><A NAME="sec0"></A>How Windows&nbsp;95 Installs a New Device: An Overview</H3><P>Windows&nbsp;95 Setup performs an inventory of all devices on the computer and records the information about those devices in the Registry. Setup gets configuration information from device INF files. To maintain compatibility, Setup also checks entries in WINI.INI, SYSTEM.INI, and CONFIG.SYS.</P>
<P>When a new device is installed, Windows&nbsp;95 uses the device ID to search Windows&nbsp;95 INF files for an entry for that device. Windows&nbsp;95 uses this information or a default driver to create an entry for the device under the Hkey_Local_Machine branch in the Registry, and it copies the drivers needed. Then the Registry entries are copied from the INF file to the driver's Registry entry, including the <B>DevLoader=</B> and<B> DriverDesc=</B> values for the Driver entry, and the <B>Driver= </B>and<B> ConfigFlags=</B> values for the Enum entry.</P>
<P></P>
<P><B>Tip</B>   If you use custom setup scripts to install Windows&nbsp;95, you can include the setting <B>devicepath=1</B> in the [Setup] section to specify that Windows&nbsp;95 should check a source installation path to find INF files, rather than looking only in the Windows INF directory when installing devices. When you use this parameter in setup scripts, you can later add INF files to a single network source location to ensure that up-to-date drivers are used any time a new device is installed on computers running Windows&nbsp;95. For information, see Appendix D, "MSBATCH.INF Parameters."</P></FONT></BODY></HTML>
