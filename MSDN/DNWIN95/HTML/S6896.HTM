<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows 95 Deployment Procedures</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" size="2">
<h2>Windows 95 Deployment Procedures</H2><P>The first step in the upgrade process is to determine which of your computers are appropriate for upgrading to Windows&nbsp;95. The easiest way to do this, if you have Systems Management Server installed, is to query the SQL database to locate all computers that match the upgrade specifications. </P>
<P>Depending on your installation, you may be able to use a single query to identify all upgrade candidates, or you may have to write several queries, and upgrade the installation in stages. You will typically end up with at least one query for each Windows&nbsp;95 configuration you want to install; after running the query, you can use the results as the target for your installation package.</P>
<P>A typical query for an upgrade of desktop computers might specify:</P>
<UL><LI>A 386 DX processor or better </LI><LI>MS-DOS version 5.0 or later, Windows, or Windows for Workgroups</LI><LI>35 MB or more of hard disk space </LI></UL><P>The following table lists the amount of hard disk space required, according to the operating system being upgraded.</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="151pt" VALIGN="TOP"><COL WIDTH="62pt" VALIGN="TOP"><COL WIDTH="60pt" VALIGN="TOP"><COL WIDTH="73pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Existing operating system</B></P></TD><TD VALIGN="TOP"><P><B>Compact</B></P></TD><TD VALIGN="TOP"><P><B>Typical</B></P></TD><TD VALIGN="TOP"><P><B>Full</B></P></TD></TR><TR><TD VALIGN="TOP"><P>New (no system installed)</P></TD><TD VALIGN="TOP"><P>30 MB</P></TD><TD VALIGN="TOP"><P>40 MB</P></TD><TD VALIGN="TOP"><P>50 MB</P></TD></TR><TR><TD VALIGN="TOP"><P>Windows 3.1</P></TD><TD VALIGN="TOP"><P>15</P></TD><TD VALIGN="TOP"><P>35</P></TD><TD VALIGN="TOP"><P>40</P></TD></TR><TR><TD VALIGN="TOP"><P>Windows for Workgroups 3.11</P></TD><TD VALIGN="TOP"><P>15</P></TD><TD VALIGN="TOP"><P>30</P></TD><TD VALIGN="TOP"><P>35</P></TD></TR></TBODY></TABLE>
<P><BR></P><UL><LI>4 MB or more of installed RAM </LI><LI>Windows&nbsp;95 is not already installed</LI></UL><P>Systems Management Server includes some predefined queries which are ready to use. You can modify one of these, if appropriate, to query for criteria that are specific to your organization. The following steps show you how to create a simple query. To create a more complex query, repeat several of the steps to add more properties to your query.</P>
<H3><A NAME="sec0"></A>To create a simple query that detects computers running Windows for Workgroups</H3><OL><LI>From the Systems Management Server Administrator tool, open the Queries window.</LI><LI>From the File menu, choose New. The Queries Properties window appears.</LI><LI>In the Query Name box, type <B>Windows 95 Candidates</B> and click Add AND. This opens the Query Expression Properties dialog box.</LI><LI>Scroll down the list until you find the Operating System group, and then select the Operating System Name attribute.</LI><LI>In the Operator box, select is.</LI><LI>In the Value box, select MS Windows for Workgroups.</LI><LI>Click OK to return to the Query Properties dialog box with your query displayed.</LI><LI>Click OK and then minimize the Queries window.</LI></OL><P>This creates a simple query that has only one property<FONT FACE="Symbol">¾</FONT>that the operating system is Windows for Workgroups. You can use the Add AND<B> </B>or<B> </B>the<B> </B>Add OR<B> </B>functions to define more query details.</P>
<P>There are two ways you can execute a query: </P>
<UL><LI>You can choose Execute Query from the File menu, select the query you want to execute, and click OK. The Query results window appears listing all the computers that meet the criteria of the query, as shown in the following illustration.</LI><LI>You can also simply drag the query from the Queries window and drop it onto the site (in the Sites window) that you wish to run the query on, as shown in the following illustration. This makes it easy for administrators to run queries on certain sites as required.</LI></UL><P>Here are the basic steps in using Systems Management Server to roll out Windows&nbsp;95.</P>
<H3><A NAME="sec1"></A>To roll out Windows&nbsp;95 using Systems Management Server</H3><OL><LI>Create and share a package source directory for the Windows 95 files. This directory can be on any server that can be shared with the network.</LI><LI>Copy the appropriate files from the Windows 95 compact disc or flopp disks to the new package source directory. If copying from the compact disc, you can use the Server-Based Setup (<B>netsetup</B>; see Chapter 4, "Server-Based Setup for Windows 95") to copy appropriate files to the source directory. If you are copying from a server that already contains an installation created using Server-based Setup, floppies, you can use <B>xcopy </B>to copy the files and directory structure.</LI><LI>From the Systems Management Server 1.0a CD-ROM, copy the following files to the package source directory.

<UL><LI>WIN95.INF file from SMS\LOGON.SRV\MSTEST.</LI><LI>DOS2W95.EXE file from SMS\LOGON.SRV\MSTEST (if you are setting up DOS clients).</LI></UL></LI><LI>Review the INF file for your configuration, and make appropriate changes (such as the time zone).</LI><LI>Create a package containing the Windows&nbsp;95 source directory:

<UL><LI>From the Systems Management Server&nbsp;Administrator, open the Packages window. From the File Menu, choose New. When the Package Properties dialog box appears, click Import. </LI><LI>In the File Browser dialog box, select the WIN95.PDF in the SMS\PRIMSITE.SRV\IMPORT.SRC\ENU directory, and then click OK.</LI><LI>Click Workstations. In the Source directory boxof the Setup Package For Workstations dialog box , type the location of the Windows&nbsp;95 package source directory (or click Browse [...] to find it). This is the package source directory that you created earlier. Then click Close, and click OK.</LI></UL></LI><LI>When ready to install Windows&nbsp;95 on one or more clients, create a job to distribute the package to the clients.

<UL><LI>From the Systems Management Server&nbsp;Administrator, open the Packages window. Open the Sites window.</LI><LI>In the Packages window, select the package you created for the operating system, and drag it to a client, machine group, or site in the Sites window. </LI><LI>Complete the Job Details dialog box, making sure to choose the correct client command appropriate for the operating system environment of the target clients on which the job will be run. Use Automated Setup for Windows/WfW Clients for computers running Windows or Automated Setup for DOS Clients for computers running MS-DOS.</LI></UL></LI><LI>Send the job to the target computers.</LI></OL><P>The Windows 95 installation process requires the User Name, Domain/Workgroup Name, and Computer Name for the targeted client. These values are left blank in the WIN95.INF template. There are several ways for the installation program to acquire this information:</P>
<UL><LI>Determine if the input Win95 script file (usually WIN95.INF) has UserName set.</LI><LI>If not, check in the client's SMS.INI for the UserName (this is an optional field that people can set using PCM).</LI><LI>Then, make sure there's an MSBATCH.INF file in the Windows directory and that it has the UserName set (computers running Windows&nbsp;95 will have this file from their last installation).</LI><LI>Next, check if there's a SERIALNO.INI file in the Windows directory that has UserName set (computers running Windows for Workgroups will have this file from the installation).</LI><LI>Finally, have the UserName default to the same value as the computer name. The computer name was either specified in the INF file or copied from the MachineName field in SMS.INI. </LI></UL><P>Check the README.TXT file for further information.</P>
<P>For Windows-based clients, the user must close all applications before starting the automated Windows 95 installation. If an application is open, the installation will pause until the user closes it. Also, certain warning and error conditions can occur during the installation process that may pause or terminate the installation. </P></FONT></BODY></HTML>
