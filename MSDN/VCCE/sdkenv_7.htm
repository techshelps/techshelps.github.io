<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Example of a Windows CE Make File</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<h2><a name="_vcce_example_of_a_windows_ce_make_file"></a>Example of a Windows CE Make File</h2>
<pre><code>!IF 0
Copyright (c) 1989-1996  Microsoft Corporation
Abstract:
    This file specifies the target component being built and the list of
    sources files needed to build that component.  Also specifies optional
    compiler switches and libraries that are unique for the component being
    built. Makefile for project "foo".
!ENDIF

!IF "$(DEBUG)"=="1"
LDEFINES=$(LDEFINES) -debug:full -debugtype:both  -pdb:none
CFLAGS=$(CFLAGS) -Z7 -Od
TYPE=debug
!ELSE
TYPE=retail
!ENDIF

PROJ=foo
OUTDIR=$(TYPE)_$(TARGETCPU)

OBJS= $(OUTDIR)\foo1.obj \
      $(OUTDIR)\foo2.obj \
      $(OUTDIR)\foo3.obj 

GLOBAL_DEP= foo.h

CFLAGS= $(CFLAGS) -nologo -W3 -c
RFLAGSS= $(RFLAGS) -r
RC_FILE= foo.rc
RES_FILE=$(OUTDIR)\$(PROJ).res

I386EM_TARGETLIBS=user32.lib   \
                  commctrl.lib \
                  kernel32.lib \
                  gdi32.lib \
                  mscvrt.lib

MIPSEM_TARGETLIBS=user32.lib   \
                  commctrl.lib \
                  kernel32.lib \
                  gdi32.lib \
                  msvcrt.lib

SH3_TARGETLIBS=commctrl.lib \
               coredll.lib \
               libc.lib 
              
R4100_TARGETLIBS=commctrl.lib \
                 coredll.lib \
                 libc.lib 

!IF "$(TARGETCPU)"=="i386"
TARGETLIBS=$(I386EM_TARGETLIBS)
MACHINE_OPTION= $(TARGETCPU)
EXEENTRY = WinMainCRTStartup
!ENDIF

!IF "$(TARGETCPU)"=="MIPS"
TARGETLIBS=$(MIPSEM_TARGETLIBS)
MACHINE_OPTION= $(TARGETCPU)
EXEENTRY = WinMainCRTStartup
!ENDIF

!IF "$(TARGETCPU)"=="SH3"
TARGETLIBS=$(SH3_TARGETLIBS)
MACHINE_OPTION= $(TARGETCPU)
EXEENTRY = WinMain
!ENDIF

!IF "$(TARGETCPU)"=="R4100"
TARGETLIBS=$(R4100_TARGETLIBS)
MACHINE_OPTION= MIPS
EXEENTRY = WinMain
!ENDIF

$(OUTDIR)\$(PROJ).exe: $(OUTDIR) $(OBJS) $(RES_FILE)
     link $(LDEFINES) $(OBJS) $(TARGETLIBS) $(RES_FILE) \
     -out:$(OUTDIR)\$(PROJ).exe -entry:$(EXEENTRY) -machine:$(MACHINE_OPTION)

$(OBJS): $$(@B).c $(GLOBAL_DEP)
     $(CC) $(CFLAGS) $(CDEFINES)  $(@B).c -Fo$@

$(RES_FILE): $(RC_FILE) $(GLOBAL_DEP) $(OUTDIR)
   rc $(RFLAGS) $(RDEFINES)  /fo$(RES_FILE) $(RC_FILE)

"$(OUTDIR)" :
    if not exist "$(OUTDIR)" mkdir "$(OUTDIR)"

clean:
    del /q $(OUTDIR)
    nmake
 </code></pre>
<p>&nbsp;</p></body>
</HTML>
