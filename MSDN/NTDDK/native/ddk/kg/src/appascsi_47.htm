<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>A.4.5.5 Handling SRB_FUNCTION_FLUSH and SRB_FUNCTION_SHUTDOWN</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_Handling_SRB_FUNCTION_FLUSH_and_SRB_FUNCTION_SHUTDOWN_KG"></A>A.4.5.5 Handling SRB_FUNCTION_FLUSH and SRB_FUNCTION_SHUTDOWN</H4>
<P>
If the HBA caches data internally, as indicated when the HwScsiFindAdapter
routine set up the PORT_CONFIGURATION_INFORMATION, the HwScsiStartIo routine
must support the SRB_FUNCTION_FLUSH and SRB_FUNCTION_SHUTDOWN requests as
follows: 
<UL>
<LI>
An SRB with its <B>Function</B>&nbsp;member set to SRB_FUNCTION_FLUSH tells the
miniport driver to transfer data cached in the HBA, usually to a disk. The
miniport must hold on to the flush request until all cached data has been
transferred and, then, complete the flush request. 
<P>
Such a flush request might originate when an application closes a file or the
application itself is terminated. 
<P>
<LI>
An SRB with its <B>Function</B>&nbsp;member set to SRB_FUNCTION_SHUTDOWN tells the
miniport driver to complete transferring data, including flushing all cached
data, out to the target device. The miniport driver must hold on to the
shutdown request until no data remains in the HBA’s internal cache for the
target logical unit and, then, complete the shutdown request. 
<P>
Note that a miniport can be called with more than one shutdown request,
possibly for the same LU or with several shutdown requests for different LUs,
before the system itself is actually shut down. 
</UL>
<P></FONT>
</BODY>
</HTML>
