<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>3.3.5  Using Busmaster DMA</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_Using_Busmaster_DMA_KG"></A>3.3.5  Using Busmaster DMA</H3>
<P>
NT drivers of busmaster DMA devices can use the following kinds of
system-supplied DMA support:
<UL>
<LI>
Packet-based DMA if the busmaster adapter is such that the driver can
determine when a DMA transfer operation is done and/or when to begin another
transfer operation for a given IRP
<P>
<LI>
Common-buffer DMA (also called <I>continuous DMA</I>) if the busmaster adapter
is such that the driver cannot determine readily when a transfer operation
will begin or when a transfer is complete, or if a single buffer area is used
continuously or repeatedly for DMA transfers
</UL>
<P>
Depending on the nature of the busmaster adapter, some NT drivers use
packet-based DMA exclusively, some use common-buffer DMA exclusively, and some
use both. For example, the driver of a busmaster adapter that uses a mailbox
scheme to communicate status information and commands might use a common
buffer for the mailboxes shared between the driver and its adapter, together
with packet-based DMA for data transfers.
<H5><IMG SRC="../../../wedge.gif" BORDER=0>&nbsp; &nbsp; Setting up a common buffer can tie up some (or all, depending on the size of the requested buffer) of the map registers associated with the adapter object that represents the busmaster adapter, so consider the following a design guideline: </H5>
<P>
<I>Use common-buffer DMA economically</I>.
<P>
Setting up common-buffer area(s) economically, such as in PAGE_SIZE chunks or
in a single allocation, leaves more map registers available for such a
driver’s packet-based DMA operations, if any. It also leaves more system
memory free for other purposes, which yields better overall driver and system
performance.
<P>
The following subsections explain each kind of busmaster DMA separately.
<P></FONT>
</BODY>
</HTML>
