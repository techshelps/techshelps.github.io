<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>15.1.2  Releasing Device and Controller Objects</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_Releasing_Device_and_Controller_Objects_KG"></A>15.1.2  Releasing Device and Controller Objects</H3>
<P>
Any NT driver must release its references to external resources, such as
pointers to other drivers’ objects and/or to interrupt objects, that it stored
in a device or controller extension before it deletes the corresponding device
or controller object.
<P>
After it has freed all resources associated with a device or controller
object, the Unload routine must call <B>IoDeleteDevice</B>&nbsp;for each device
object that the driver created with successful calls to <B>IoCreateDevice</B>,
and it must call <B>IoDeleteController</B>&nbsp;if the DriverEntry routine called <B>IoCreateController</B>.
<P>
Any Kernel-defined object for which the driver provides storage in a device
extension is automatically freed when the Unload routine calls <B>IoDeleteDevice</B>
with the corresponding device object. In general, any object that the
DriverEntry routine set up by calling <B>KeInitialize</B><I>Xxx</I>&nbsp;can be
freed by a call to <B>IoDeleteDevice</B>&nbsp;if the driver provided storage for
that object in its device extension. For example, if a driver has a
CustomTimerDpc routine and has provided storage for the necessary DPC and
timer objects in its device extension, the call to <B>IoDeleteDevice</B>
releases these system resources.
<P>
In a similar manner, any Kernel-defined object for which the driver provides
storage in a controller extension is automatically freed when the Unload
routine calls <B>IoDeleteController</B>&nbsp;with the corresponding controller
object.
<P></FONT>
</BODY>
</HTML>
