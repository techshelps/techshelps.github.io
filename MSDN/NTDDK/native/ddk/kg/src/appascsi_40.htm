<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>A.4.3.5  Return from HwScsiFindAdapter to ScsiPortInitialize</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_Return_from_HwScsiFindAdapter_to_ScsiPortInitialize_KG"></A>A.4.3.5  Return from HwScsiFindAdapter to ScsiPortInitialize</H4>
<P>
When a miniport driver’s HwScsiFindAdapter routine returns control, <B>ScsiPortInitialize</B>
returns to the <B>DriverEntry</B>&nbsp;routine if the call(s) to HwScsiFindAdapter
indicated that the miniport driver could not support an HBA. Otherwise, <B>ScsiPortInitialize</B>
claims resources in the registry, sets up necessary system resources, such as
NT interrupt and adapter objects, on behalf of the miniport driver. Then, it
calls the miniport’s HwScsiInitialize routine, described in <A HREF="appascsi_41.htm">Section
A.4.4</A>. 
<P>
In addition to the values it sets in the PORT_CONFIGURATION_INFORMATION
buffer, <B>ScsiPortInitialize</B>&nbsp;also checks the registry for user-set values
that disable any or all of the following: 
<UL>
<LI>
Synchronous transfers on the HBA 
<P>
The port driver ORs the default <B>SrbFlags</B>&nbsp;that it maintains for the HBA
with SRB_FLAGS_DISABLE_SYNCH_TRANSFER. 
<P>
<LI>
Bus-disconnect operations on the HBA 
<P>
The port driver ORs the default <B>SrbFlags</B>&nbsp;with
SRB_FLAGS_DISABLE_DISCONNECT. 
<P>
<LI>
Tagged queueing 
<P>
The port driver sets the <B>TaggedQueuing</B>&nbsp;Boolean that it maintains for
the HBA to FALSE. 
<P>
<LI>
Internal queueing of requests on the HBA 
<P>
The port driver sets the <B>MultipleRequestPerLu</B>&nbsp;Boolean that it maintains
about the HBA to FALSE. 
</UL>
<P>
If any of the immediately preceding “disable” values are in the registry, it
overrides whatever the HwScsiFindAdapter routine sets in the
PORT_CONFIGURATION_INFORMATION buffer. Note that temporarily disabling
synchronous transfers, bus-disconnect operations, tagged queueing, and HBA
internal request queueing can simplify using a debugger to trace request
handling in a miniport driver that is under development. 
<P>
Note also that the Windows NT port driver uses the
PORT_CONFIGURATION_INFORMATION values provided by a miniport’s
HwScsiFindAdapter routine and/or in the registry to fill in the
IO_SCSI_CAPABILITIES data for use by SCSI class drivers, as described in <A HREF="appascsi_7.htm">Section
A.1.3.3</A>. 
<P></FONT>
</BODY>
</HTML>
