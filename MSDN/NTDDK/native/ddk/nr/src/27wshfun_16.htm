<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WSHSetSocketInformation</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_WSHSetSocketInformation_NR"></A>WSHSetSocketInformation</H2>
<P>
<B>INT</B><BR>
<B>&nbsp; &nbsp; WSHSetSocketInformation(</B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN PVOID</B>&nbsp; <I>HelperDllSocketContext</I><B>,</B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN SOCKET</B>&nbsp; <I>SocketHandle</I><B>,</B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN HANDLE</B>&nbsp; <I>TdiAddressObjectHandle</I><B>,</B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN HANDLE</B>&nbsp; <I>TdiConnectionObjectHandle</I><B>,</B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN INT</B>&nbsp; <I>Level</I><B>,</B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN INT</B>&nbsp; <I>OptionName</I><B>,</B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN PCHAR</B>&nbsp; <I>OptionValue</I><B>,</B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN INT</B>&nbsp; <I>OptionLength</I><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; );</B>
<P>
<B>WSHSetSocketInformation</B>&nbsp;is called by the Windows Sockets DLL whenever
an application calls <B>setsockopt</B>&nbsp;with an option that Windows Sockets
does not explicitly handle.
<H3>Parameter</H3>
<DL>
<DT>
<I>HelperDllSocketContext</I>
<DD>
Points to a per-socket context area, allocated and initialized by the WSH DLL <B>WSHOpenSocket
</B>or <B>WSHOpenSocket2 </B>function.
<BR>
<DT>
<I>SocketHandle</I>
<DD>
Specifies the handle of the socket returned by <B>socket</B>&nbsp;or <B>accept</B>.
<BR>
<DT>
<I>TdiAddressObjectHandle</I>
<DD>
Specifies the handle to a file object representing the open transport address
for the socket. If the socket is not currently bound to an address, this
parameter is NULL.
<BR>
<DT>
<I>TdiConnectionObjectHandle</I>
<DD>
Specifies the handle to a file object representing the connection endpoint
associated with the socket. If the socket is not currently connected, this
parameter is NULL.
<BR>
<DT>
<I>Level</I>
<DD>
Specifies the <I>level</I>&nbsp;passed in the <B>setsockopt</B>&nbsp;call.
<BR>
<DT>
<I>OptionName</I>
<DD>
Specifies the <I>optname</I>&nbsp;passed in the <B>setsockopt</B>&nbsp;call. 
<BR>
<DT>
<I>OptionValue</I>
<DD>
Points to a buffer passed as the <I>optval</I>&nbsp;argument to <B>setsockopt</B>.
This buffer contains caller-supplied data for the set operation.
<BR>
<DT>
<I>OptionLength</I>
<DD>
Specifies the size in bytes of the buffer at <I>OptionValue</I>.
</DL>
<H3>Return Value</H3>
<P>
<B>WSHSetSocketInformation</B>&nbsp;returns zero if it successfully interprets the
given option and carries out whatever operation it requires. Otherwise it
returns a Windows Sockets error code. If the return value is nonzero, the <B>setsockopt</B>
call fails and the error is set to the value returned by <B>WSHSetSocketInformation</B>.
<H3>Comments</H3>
<P>
<B>WSHSetSocketInformation</B>&nbsp;can provide support for arbitrary options
beyond those defined by Windows Sockets. Certain defined options also are
passed to the helper DLL because of the different ways in which transport
drivers provide support for these options, in particular for the SO_KEEPALIVE<B>
</B>and SO_DONTROUTE options.
<P>
Any option passed in an application call to <B>setsockopt</B>&nbsp;that the Windows
Sockets DLL does not explicitly support is forwarded to <B>WSHSetSocketInformation</B>.
The Windows Sockets DLL relies on each helper DLL to fail calls for which the
given option is invalid or unsupported by the helper DLL or underlying
transport. 
<H3>See Also</H3>
<P>
<B><A HREF="27wshfun_7.htm">WSHGetSocketInformation</A></B>&nbsp;
<P></FONT>
</BODY>
</HTML>
