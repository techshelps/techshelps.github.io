<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TDI_DISASSOCIATE_ADDRESS</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_TDI_DISASSOCIATE_ADDRESS_NR"></A>TDI_DISASSOCIATE_ADDRESS</H2>
<P>
When a kernel-mode client makes a TDI_DISASSOCIATE_ADDRESS request, it asks
the underlying TDI transport driver to break an established association
between a particular local-node address and a connection endpoint.
<H3>IRP</H3>
<P>
The transport calls <B>IoGetCurrentIrpStackLocation</B>&nbsp;with the given <I>Irp</I>
to get a pointer to its own I/O stack location in the IRP, shown in the
following list as <B>IrpSp</B>. IRP members relevant to this request include
the following:
<DL>
<DT>
<B>IoStatus.Status</B>
<DD>
Specifies the final status of the disassociate-address request. The transport
sets this member before it completes the IRP, possibly to one of the
following:
<P>
STATUS_SUCCESS<BR>
STATUS_INVALID_CONNECTION
<BR>
<DT>
<B>IrpSp-&gt;MajorFunction</B>
<DD>
Specifies IRP_MJ_INTERNAL_DEVICE_CONTROL. The transport can ignore this member
if it exports a TdiDispatchInternalDeviceControl routine that handles only
TDI_<I>XXX</I>&nbsp;requests. 
<BR>
<DT>
<B>IrpSp-&gt;MinorFunction</B>
<DD>
Specifies TDI_DISASSOCIATE_ADDRESS.
<BR>
<DT>
<B>IrpSp-&gt;FileObject</B>
<DD>
Points to an open file object representing the connection endpoint to be
disassociated from a local-node address. The transport uses the <B>FsContext</B>
and, possibly, <B>FsContext2</B>&nbsp;fields to access the state it maintains about
the connection. 
</DL>
<H3>Comments</H3>
<P>
A client makes this request to disassociate a connection endpoint for an
inactive connection from the associated local-node address, whether that
client initiated the disconnection from its remote-node peer or vice versa. 
<P>
After the address has been disassociated, the client can reassociate it with
another connection endpoint or reassociate the connection endpoint with
another open local-node address by making another TDI_ASSOCIATE_ADDRESS
request. Consequently, the transport cannot assume that the file objects
representing such an address and connection endpoint will be closed following
the completion of the TDI_DISASSOCIATE_ADDRESS request. 
<P>
<B>TdiBuildDisassociateAddress</B>&nbsp;is the macro a client uses to fill in this
IRP.
<H3>See Also</H3>
<P>
<B><A HREF="22ioctl_3.htm">TDI_ASSOCIATE_ADDRESS</A></B>, <B><A HREF="24bldmac_5.htm">TdiBuildDisassociateAddress</A></B>,
<B><A HREF="22ioctl_6.htm">TDI_DISCONNECT</A></B>, <B><A HREF="21tddisp_6.htm">TdiDispatchInternalDeviceControl</A></B>
<P></FONT>
</BODY>
</HTML>
