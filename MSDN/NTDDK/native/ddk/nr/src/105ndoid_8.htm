<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>5.8  TAPI Objects</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_TAPI_Objects_NR"></A>5.8  TAPI Objects</H2>
<P>
This defines the OIDs for TAPI objects, both for query and set information
requests. These OIDs define the request interface between user-mode TAPI
service providers and underlying WAN NIC miniports. Each such request goes
through NDISTAPI and NDISWAN to the target miniport. 
<P>
For more information about higher-level TAPI components, especially about
user-mode service providers in which these OID requests originate, see the
Win32 SDK. 
<P>
The following chart summarizes the OIDs used to get operational
characteristics for NDIS drivers and NICs that support TAPI on a WAN network.
<P>
In contrast with other OIDs, defined TAPI OID values do not indicate whether
each OID is required or optional. The length of the information buffer for
TAPI OID requests varies according to the OID-specific structure. Instances of
some OID-specific structures also vary in size, in particular for TAPI-defined
structures with members of type VAR_STRING, described later. 
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Q</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>S</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Name</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Mandatory OID_TAPI_<I>XXX</I></B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_ANSWER_NR">OID_TAPI_ANSWER</A>&nbsp; <BR>
Answer
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_CLOSE_NR">OID_TAPI_CLOSE</A>&nbsp; <BR>
Close
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_CLOSE_CALL_NR">OID_TAPI_CLOSE_CALL</A>&nbsp; <BR>
Close Call
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_CONDITIONAL_MEDIA_DETECTION_NR">OID_TAPI_CONDITIONAL_MEDIA_DETECTION</A>&nbsp; <BR>
Conditional Media Detection
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_DROP_NR">OID_TAPI_DROP</A>&nbsp; <BR>
Drop
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_GET_ADDRESS_CAPS_NR">OID_TAPI_GET_ADDRESS_CAPS</A>&nbsp; <BR>
Get Address Capabilities
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_GET_ADDRESS_ID_NR">OID_TAPI_GET_ADDRESS_ID</A>&nbsp; <BR>
Get Address ID
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_GET_ADDRESS_STATUS_NR">OID_TAPI_GET_ADDRESS_STATUS</A>&nbsp; <BR>
Get Address Status
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_GET_CALL_ADDRESS_ID_NR">OID_TAPI_GET_CALL_ADDRESS_ID</A>&nbsp; <BR>
Get Call Address ID
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_GET_CALL_INFO_NR">OID_TAPI_GET_CALL_INFO</A>&nbsp; <BR>
Get Call Information
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_GET_CALL_STATUS_NR">OID_TAPI_GET_CALL_STATUS</A>&nbsp; <BR>
Get Call Status
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_GET_DEV_CAPS_NR">OID_TAPI_GET_DEV_CAPS</A>&nbsp; <BR>
Get Device Capabilities
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_GET_ID_NR">OID_TAPI_GET_ID</A>&nbsp; <BR>
Get ID
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_GET_LINE_DEV_STATUS_NR">OID_TAPI_GET_LINE_DEV_STATUS</A>&nbsp; <BR>
Get Line Device Status
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_MAKE_CALL_NR">OID_TAPI_MAKE_CALL</A>&nbsp; <BR>
Make Call
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_OPEN_NR">OID_TAPI_OPEN</A>&nbsp; <BR>
Open
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_PROVIDER_INITIALIZE_NR">OID_TAPI_PROVIDER_INITIALIZE</A>&nbsp; <BR>
Provider Initialize
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_PROVIDER_SHUTDOWN_NR">OID_TAPI_PROVIDER_SHUTDOWN</A>&nbsp; <BR>
Provider Shutdown
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_SET_APP_SPECIFIC_NR">OID_TAPI_SET_APP_SPECIFIC</A>&nbsp; <BR>
Set Application Specific Member 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_SET_CALL_PARAMS_NR">OID_TAPI_SET_CALL_PARAMS</A>&nbsp; <BR>
Set Call Paramaters
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_SET_DEFAULT_MEDIA_DETECTION_NR">OID_TAPI_SET_DEFAULT_MEDIA_DETECTION</A>&nbsp; <BR>
Set Default Media Detection
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_SET_MEDIA_MODE_NR">OID_TAPI_SET_MEDIA_MODE</A>&nbsp; <BR>
Set Media Mode
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_SET_STATUS_MESSAGES_NR">OID_TAPI_SET_STATUS_MESSAGES</A>&nbsp; <BR>
Set Status Messages
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Optional OID_TAPI_<I>XXX</I></B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_ACCEPT_NR">OID_TAPI_ACCEPT</A>&nbsp; <BR>
Accept
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_CONFIG_DIALOG_NR">OID_TAPI_CONFIG_DIALOG</A>&nbsp; <BR>
Configuration Dialog
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_DEV_SPECIFIC_NR">OID_TAPI_DEV_SPECIFIC</A>&nbsp; <BR>
Device Specific
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_DIAL_NR">OID_TAPI_DIAL</A>&nbsp; <BR>
Dial Specified Number for Specified Call
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_GET_DEV_CONFIG_NR">OID_TAPI_GET_DEV_CONFIG</A>&nbsp; <BR>
Get Device Configuration
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_GET_EXTENSION_ID_NR">OID_TAPI_GET_EXTENSION_ID</A>&nbsp; <BR>
Get Extension ID
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_NEGOTIATE_EXT_VERSION_NR">OID_TAPI_NEGOTIATE_EXT_VERSION</A>&nbsp; <BR>
Return Highest Acceptable Version Extension
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_SET_DEV_CONFIG_NR">OID_TAPI_SET_DEV_CONFIG</A>&nbsp; <BR>
Set Device Configuration
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_SECURE_CALL_NR">OID_TAPI_SECURE_CALL</A>&nbsp; <BR>
Secure Call
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_SELECT_EXT_VERSION_NR">OID_TAPI_SELECT_EXT_VERSION</A>&nbsp; <BR>
Select Extension Version
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_TAPI_SEND_USER_USER_INFO_NR">OID_TAPI_SEND_USER_USER_INFO</A>&nbsp; <BR>
Send User User Information
</FONT></TABLE>
<P>
WAN NIC miniports must support the OIDS labeled as <B>Mandatory</B>&nbsp;in the
preceding chart. The extent to which a given miniport supports those labeled <B>Optional</B>
in the preceding chart depends on the discretion of the driver writer and the
capabilities of the NIC. 
<P>
The functional requirements are quite simple for several of the TAPI OID
requests. For example, the OID_TAPI_SET_APP_SPECIFIC request requires a NIC
driver only to associate a ULONG value with a specified call instance, which
can be retrieved later with an OID_TAPI_GET_CALL_INFO request. Requests that a
NIC driver writer chooses to ignore should be completed with the
NDIS_STATUS_TAPI_OPERATIONUNAVAIL status code. 
<P>
A NIC driver can indicate the requests it supports, which might vary over time
depending on line, address, or call state, by setting or clearing specific
bits in the members of structures for some of the OID_TAPI_GET_<I>XXX</I>
requests, such as in the <B>ulAddrCapFlags </B>member in the LINE_ADDRESS_CAPS
structure.
<P>
For the declaration of LINE_ADDRESS_CAPS and other system-defined structures
in which WAN miniports maintain TAPI state, see <I>ndistapi.h</I>. For more
information about these structures, see also the Win32 SDK. 
<H5><A NAME="DDK_TAPI_Type_VAR_STRING_NR"></A>TAPI Type VAR_STRING</H5>
<P>
For several OID_TAPI_<I>XXX</I>, the miniport is given an OID-specific
structured information buffer. More than one of these TAPI structures have a
member of type VAR_STRING, which is also a structured buffer, defined as
follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _VAR_STRING {
&nbsp; &nbsp; ULONG  ulTotalSize;<BR>    ULONG  ulNeededSize;<BR>    ULONG  ulUsedSize;<BR>    ULONG  ulStringFormat;<BR>    ULONG  ulStringSize;<BR>    ULONG  ulStringOffset;
} VAR_STRING, *PVAR_STRING;
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulTotalSize</B>
<DD>
The total size in bytes of the buffer, including the buffered string. 
<BR>
<DT>
<B>ulNeededSize</B>
<DD>
The size in bytes of a buffer necessary to contain a particular string. For
example, the underlying driver sets this value if a protocol-supplied buffer
is too short to contain a requested string. 
<BR>
<DT>
<B>ulUsedSize</B>
<DD>
The number of bytes in the given buffer that were actually used. 
<BR>
<DT>
<B>ulStringFormat</B>
<DD>
Specifies how the buffered string should be interpreted, as one of the following:<BR>
STRINGFORMAT_ASCII<BR>
STRINGFORMAT_DBCS<BR>
STRINGFORMAT_UNICODE<BR>
STRINGFORMAT_BINARY
<BR>
<DT>
<B>ulStringSize</B>
<DD>
The number of bytes in the given buffered string.
<BR>
<DT>
<B>ulStringOffset</B>
<DD>
The offset within this buffer at which the string begins.
</DL>
<P>
The following describes the OID_<I>XXX</I>&nbsp;listed in the preceding chart and
their associated TAPI structures, if any, more fully. 
<H3>TAPI Query Information Requests</H3>
<P>
Query-information requests differ from set-information requests in that one or
more members in the associated structure, denoted by the “OUT” prefix in the
structure definition, are reserved for information the underlying miniport
should return to the initiator of the request. WAN NIC drivers should treat
structure members prefixed with “IN” as read-only. 
<P>
The first member of all the structures used in query-information requests, <B>ulRequestID</B>,
is reserved for future use. Miniport drivers should ignore this member.
<H4><A NAME="DDK_OID_TAPI_GET_ADDRESS_CAPS_NR"></A>OID_TAPI_GET_ADDRESS_CAPS</H4>
<P>
This OID requests the WAN NIC driver to return information for the specified
address on the specified line about its telephony capabilities. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_GET_ADDRESS_CAPS structure, defined as follows,
to query the telephony capabilities of a specified address: 
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_GET_ADDRESS_CAPS { 
&nbsp; &nbsp; IN ULONG               ulRequestID; 
&nbsp; &nbsp; IN ULONG               ulDeviceID; 
&nbsp; &nbsp; IN ULONG               ulAddressID; 
&nbsp; &nbsp; IN ULONG               ulExtVersion; 
&nbsp; &nbsp; OUT LINE_ADDRESS_CAPS  LineAddressCaps; 
} NDIS_TAPI_GET_ADDRESS_CAPS, *PNDIS_TAPI_GET_ADDRESS_CAPS; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>ulDeviceID</B>
<DD>
Specifies the link or data channel to be queried. This was set up in a
preceding <A HREF="#DDK_OID_TAPI_GET_ID_NR">OID_TAPI_GET_ID</A>&nbsp;request. 
<BR>
<DT>
<B>ulAddressID</B>
<DD>
Specifies the address on the given link for which capabilities should be
returned. The value of this member is not validated by NDISTAPI when this
request is made.
<BR>
<DT>
<B>ulExtVersion</B>
<DD>
Specifies the version number of the miniport-specific extensions to be used.
This member is zero if no device-specific extensions are used. Otherwise, the
high-order bytes contain the major version number and the low-order bytes
contain the minor version number. The value of this member is not validated by
NDISTAPI when this request is made.
<BR>
<DT>
<B>LineAddressCaps</B>
<DD>
Specifies the base virtual address of a variable-size structure of type
LINE_ADDRESS_CAPS. See <I>ndistapi.h</I>&nbsp;for details. 
<P>
This structure has at least <B>sizeof(</B>LINE_ADDRESS_CAPS<B>) </B>bytes
reserved.
<P>
Upon successful completion of the request, the miniport fills this structure
with address capabilities information.
</DL>
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INCOMPATIBLEEXTVERSION<BR>
NDIS_STATUS_TAPI_INVALADDRESSID<BR>
NDIS_STATUS_TAPI_NODRIVER<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_GET_ADDRESS_ID_NR"></A>OID_TAPI_GET_ADDRESS_ID</H4>
<P>
This OID requests the WAN NIC driver to return the address ID associated with
the address in a different format on the specified line. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_GET_ADDRESS_ID structure, defined as follows: 
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_GET_ADDRESS_ID { 
&nbsp; &nbsp; IN ULONG      ulRequestID; 
&nbsp; &nbsp; IN HDRV_LINE  hdLine; 
&nbsp; &nbsp; OUT ULONG     ulAddressID; 
&nbsp; &nbsp; IN ULONG      ulAddressMode; 
&nbsp; &nbsp; IN ULONG      ulAddressSize; 
&nbsp; &nbsp; IN CHAR       szAddress[1]; 
} NDIS_TAPI_GET_ADDRESS_ID, *PNDIS_TAPI_GET_ADDRESS_ID; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdLine</B>
<DD>
Specifies the miniport’s handle to the line for which the address ID should be
retrieved. This was set up in a preceding <A HREF="#DDK_OID_TAPI_OPEN_NR">OID_TAPI_OPEN</A>
request. 
<BR>
<DT>
<B>ulAddressID</B>
<DD>
Specifies the requested address ID. The miniport fills in this member with the
address ID corresponding to <B>szAddress</B>&nbsp;to complete this request
successfully.
<BR>
<DT>
<B>ulAddressMode</B>
<DD>
Specifies the address mode of the address contained in <B>szAddress</B>. This
member can have only the following LINEADDRESSMODE flag set:
<P>
LINEADDRESSMODE_DIALABLEADDR
<BR>
<DT>
<B>ulAddressSize</B>
<DD>
Specifies the size in bytes of the address in <B>szAddress</B>.
<BR>
<DT>
<B>szAddress</B>
<DD>
Specifies the virtual address of variable-size structure containing an address
assigned to the line device. The format of the address is determined by the <B>ulAddressMode</B>
member. If it is LINEADDRESSMODE_DIALABLEADDR, <B>szAddress</B>&nbsp;uses the
common dialable number format and is zero-terminated.
</DL>
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALLINEHANDLE <BR>
NDIS_STATUS_TAPI_INVALADDRESS<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_GET_ADDRESS_STATUS_NR"></A>OID_TAPI_GET_ADDRESS_STATUS</H4>
<P>
This OID requests the miniport to return the current status for the specified
address. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_GET_ADDRESS_STATUS structure, defined as
follows, to query the current status for the specified address:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_GET_ADDRESS_STATUS { 
&nbsp; &nbsp; IN ULONG                 ulRequestID; 
&nbsp; &nbsp; IN HDRV_LINE             hdLine; 
&nbsp; &nbsp; IN ULONG                 ulAddressID; 
&nbsp; &nbsp; OUT LINE_ADDRESS_STATUS  LineAddressStatus; 
} NDIS_TAPI_GET_ADDRESS_STATUS, *PNDIS_TAPI_GET_ADDRESS_STATUS; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdLine</B>
<DD>
Specifies the miniport’s handle for the line.
<BR>
<DT>
<B>ulAddressID</B>
<DD>
Specifies an address on the given open line device. This is the address for
which the status should be returned. The value of this member is not validated
by NDISTAPI when this request is made.
<BR>
<DT>
<B>LineAddressStatus</B>
<DD>
Specifies the virtural address of a variable-size structure of type
LINE_ADDRESS_STATUS. See <I>ndistapi.h</I>&nbsp;for details.
<P>
The miniport fills this structure with address status information to complete
this request successfully.
<P>
The <B>LineAddressStatus</B>&nbsp;member has at least <B>sizeof(</B>LINE_ADDRESS_STATUS<B>)</B>
bytes reserved.
</DL>
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALLINEHANDLE<BR>
NDIS_STATUS_TAPI_INVALADDRESSID<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_GET_CALL_ADDRESS_ID_NR"></A>OID_TAPI_GET_CALL_ADDRESS_ID</H4>
<P>
This OID requests the miniport to return the address ID for the specified
call. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_GET_CALL_ADDRESS_ID structure, defined as
follows: 
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_GET_CALL_ADDRESS_ID { 
&nbsp; &nbsp; IN ULONG      ulRequestID, 
&nbsp; &nbsp; IN HDRV_CALL  hdCall, 
&nbsp; &nbsp; OUT ULONG     ulAddressID 
} NDIS_TAPI_GET_CALL_ADDRESS_ID, *PNDIS_TAPI_GET_CALL_ADDRESS_ID; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call for which the ID should be
retrieved. This handle was set up either in a preceding <A HREF="#DDK_OID_TAPI_MAKE_CALL_NR">OID_TAPI_MAKE_CALL</A>
request or when the miniport called <B><A HREF="103ndisx_108.htm">NdisMIndicateStatus</A></B>
to report an incoming call. 
<BR>
<DT>
<B>ulAddressID</B>
<DD>
Specifies the address ID. The miniport fills this member with the
corresponding address ID for <B>hdCall</B>&nbsp;to complete this request
successfully.
</DL>
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_GET_CALL_INFO_NR"></A>OID_TAPI_GET_CALL_INFO</H4>
<P>
This OID requests the miniport to return detailed information about the
specified call. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_GET_CALL_INFO structure, defined as follows: 
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_GET_CALL_INFO { 
&nbsp; &nbsp; IN ULONG            ulRequestID; 
&nbsp; &nbsp; IN HDRV_CALL        hdCall; 
&nbsp; &nbsp; OUT LINE_CALL_INFO  LineCallInfo; 
} NDIS_TAPI_GET_CALL_INFO, *PNDIS_TAPI_GET_CALL_INFO; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call for which it should return
information.
<BR>
<DT>
<B>LineCallInfo</B>
<DD>
Specifies the virtual address variable-size data structure of type
LINE_CALL_INFO. See <I>ndistapi.h</I>&nbsp;for details.
<P>
The miniport fills this structure with call-related information to complete
this request successfully.
<P>
The structure at <B>LineCallInfo</B>&nbsp;has at least <B>sizeof(</B>LINE_CALL_INFO<B>)</B>
bytes reserved.
</DL>
<P>
The MiniportQueryInformation function can return one of the following: NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALCALLHANDLE<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_GET_CALL_STATUS_NR"></A>OID_TAPI_GET_CALL_STATUS</H4>
<P>
This OID requests the miniport to return the current status of the specified
call. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_GET_CALL_STATUS structure, defined as follows: 
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_GET_CALL_STATUS { 
&nbsp; &nbsp; IN ULONG              ulRequestID; 
&nbsp; &nbsp; IN HDRV_CALL          hdCall; 
&nbsp; &nbsp; OUT LINE_CALL_STATUS  LineCallStatus; 
} NDIS_TAPI_GET_CALL_STATUS, *PNDIS_TAPI_GET_CALL_STATUS; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call for which the current status
should be returned.
<BR>
<DT>
<B>LineCallStatus</B>
<DD>
Specifies the virtual address of a variable-size structure of type
LINE_CALL_STATUS. See <I>ndistapi.h</I>&nbsp;for details. 
<P>
The miniport fills this structure with call status information to complete
this request successfully. 
<P>
The structure at <B>LineCallStatus</B>&nbsp;has at least <B>sizeof(</B>LINE_CALL_STATUS<B>)</B>
bytes reserved.
</DL>
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALCALLHANDLE<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_GET_DEV_CAPS_NR"></A>OID_TAPI_GET_DEV_CAPS</H4>
<P>
This OID requests the miniport to return the telephony capabilities of a
specified line device. The returned information is valid for all addresses on
the given line device. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_GET_DEV_CAPS structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_GET_DEV_CAPS { 
&nbsp; &nbsp; IN ULONG           ulRequestID; 
&nbsp; &nbsp; IN ULONG           ulDeviceID; 
&nbsp; &nbsp; IN ULONG           ulExtVersion; 
&nbsp; &nbsp; OUT LINE_DEV_CAPS  LineDevCaps; 
} NDIS_TAPI_GET_DEV_CAPS, *PNDIS_TAPI_GET_DEV_CAPS; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>ulDeviceID</B>
<DD>
Specifies the link or data channel to be queried. This was set up in a
preceding <A HREF="#DDK_OID_TAPI_GET_ID_NR">OID_TAPI_GET_ID</A>&nbsp;request. 
<BR>
<DT>
<B>ulExtVersion</B>
<DD>
Specifies the negotiated extension version number, if any. 
<P>
The value has already been negotiated for this device through the <A HREF="#DDK_OID_TAPI_NEGOTIATE_EXT_VERSION_NR">OID_TAPI_NEGOTIATE_EXT_VERSION</A>
request. The value of this member is not validated when this request is made.
<BR>
<DT>
<B>LineDevCaps</B>
<DD>
Specifies the virtual address of a variable-size structure of type
LINE_DEV_CAPS. See <I>ndistapi.h</I>&nbsp;for details. 
<P>
The NIC driver fills this structure with line device capabilities information
to complete this request successfully.
<P>
The structure at <B>LineDevCaps </B>has at least <B>sizeof(</B>LINE_DEV_CAPS<B>)</B>
bytes reserved.
<DL>
<DT>
The supplied provider information in the <B>dwProviderInfoOffset</B>&nbsp;member of
LINE_DEV_CAPS must have the following format:
<DD>
<I>MediaName</I><B>\0</B><I>ProviderName</I><B>\0</B>&nbsp;<BR>
where <BR>
<I>MediaName</I>&nbsp;is ISDN, SW56, FrameRelay, and so forth, as appropriate <BR>
and <BR>
<I>ProviderName</I>&nbsp;is the name of the manufacturer of the device and the
unique name of the device, if any. 
<P>
For example, the driver of an ISDN device from SomeIHV Inc. would set the <B>dwProviderInfoOffset</B>
member with a pointer to the string “ISDN\0SomeIHV\0”
</DL>
</DL>
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_NODRIVER<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_GET_DEV_CONFIG_NR"></A>OID_TAPI_GET_DEV_CONFIG</H4>
<P>
This OID requests the miniport to return the current configuration of a device
associated one-to-one with a particular line. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_GET_DEV_CONFIG structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_GET_DEV_CONFIG { 
&nbsp; &nbsp; IN ULONG        ulRequestID; 
&nbsp; &nbsp; IN ULONG        ulDeviceID; 
&nbsp; &nbsp; IN ULONG        ulDeviceClassSize; 
&nbsp; &nbsp; IN ULONG        ulDeviceClassOffset; 
&nbsp; &nbsp; OUT VAR_STRING  DeviceConfig; 
} NDIS_TAPI_GET_DEV_CONFIG, *PNDIS_TAPI_GET_DEV_CONFIG; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>ulDeviceID</B>
<DD>
Specifies the line device to be queried. This value was set up in a preceding <A HREF="#DDK_OID_TAPI_PROVIDER_INITIALIZE_NR">OID_TAPI_PROVIDER_INITIALIZE</A>
request.
<BR>
<DT>
<B>ulDeviceClassSize</B>
<DD>
Specifies the number of bytes in the device-class string.
<BR>
<DT>
<B>ulDeviceClassOffset</B>
<DD>
Specifies the offset in bytes to the zero-terminated, variable-size counted
string specifying the class of the device whose configuration is requested.
Valid device class strings are the same as those specified for the <A HREF="#DDK_OID_TAPI_GET_ID_NR">OID_TAPI_GET_ID</A>
request when it is applied to a “line” device (<B>ulSelect</B>&nbsp;has the value
LINECALLSELECT_LINE).
<BR>
<DT>
<B>DeviceConfig</B>
<DD>
Specifies the virtual address of a structure of type <A HREF="#DDK_TAPI_Type_VAR_STRING_NR">VAR_STRING</A>
to contain the device configuration information for the associated device. 
<P>
The <B>ulStringFormat</B>&nbsp;member of the VAR_STRING structure must be set to
STRINGFORMAT_BINARY.
<P>
The miniport fills this structure with the device configuration information to
complete this request successfully. 
</DL>
<P>
In general, the contents of the NDIS_TAPI_GET_DEV_CONFIG structure are
specific to the NIC driver’s line and the device class. 
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NNDIS_STATUS_TAPI_INVALDEVICECLASS<BR>
NDIS_STATUS_TAPI_STRUCTURETOOSMALL<BR>
NDIS_STATUS_TAPI_NODRIVER<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_GET_ID_NR"></A>OID_TAPI_GET_ID</H4>
<P>
This OID requests the miniport to return a device ID for the specified device
class associated with the selected line, address, or call. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_GET_ID structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_GET_ID { 
&nbsp; &nbsp; IN ULONG        ulRequestID; 
&nbsp; &nbsp; IN HDRV_LINE    hdLine; 
&nbsp; &nbsp; IN ULONG        ulAddressID; 
&nbsp; &nbsp; IN HDRV_CALL    hdCall; 
&nbsp; &nbsp; IN ULONG        ulSelect; 
&nbsp; &nbsp; IN ULONG        ulDeviceClassSize; 
&nbsp; &nbsp; IN ULONG        ulDeviceClassOffset; 
&nbsp; &nbsp; OUT VAR_STRING  DeviceID; 
} NDIS_TAPI_GET_ID, *PNDIS_TAPI_GET_ID; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdLine</B>
<DD>
Specifies the miniport’s handle to the line.
<BR>
<DT>
<B>ulAddressID</B>
<DD>
Specifies an address on the given open line device. The value of this member
is not validated by NDISTAPI when this request is made.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call.
<BR>
<DT>
<B>ulSelect</B>
<DD>
Specifies whether the device ID is associated with the line, address, or a
single call as one of the following:
<DL>
<DT>
LINECALLSELECT_LINE
<DD>
Selects the specified line device. The <B>hdLine</B>&nbsp;member must contain a
valid line handle; <B>hdCall</B>&nbsp;and <B>ulAddressID</B>&nbsp;are unused.
<BR>
<DT>
LINECALLSELECT_ADDRESS
<DD>
Selects the specified address on the line. Both <B>hdLine</B>&nbsp;and <B>ulAddressID
</B>must be valid; <B>hdCall</B>&nbsp;is unused.
<BR>
<DT>
LINECALLSELECT_CALL
<DD>
Selects the specified call. The <B>hdCall</B>&nbsp;member must be valid; <B>hdLine</B>
and <B>ulAddressID</B>&nbsp;are unused.
</DL>
<DT>
<B>ulDeviceClassSize</B>
<DD>
Specifies the size in bytes of the zero-terminated, variable-size string
specifying the device class of the device for which the configuration should
be returned.
<BR>
<DT>
<B>ulDeviceClassOffset</B>
<DD>
Specifies the offset in bytes to the device-class string.
<BR>
<DT>
<B>DeviceID</B>
<DD>
Specifies the virtual address of a data structure of type <A HREF="#DDK_TAPI_Type_VAR_STRING_NR">VAR_STRING</A>
in which the the device ID should be returned. 
<P>
The miniport fills this structure with the device ID to complete this request
successfully. 
<BR>
<DT>
Currently, there are two types of this request that must be supported by WAN
NIC drivers:
<DD>
1. <B>IN</B>&nbsp; <B>DeviceClass</B>&nbsp;= “ndis” // case insensitive<BR>
&nbsp; &nbsp; <B>IN</B>&nbsp; <B>ulSelect</B>&nbsp;= LINECALLSELECT_CALL<BR>
&nbsp; &nbsp; <B>IN</B>&nbsp; <B>hdCall</B>&nbsp;= <I>ActiveCallHandle</I><BR>
&nbsp; &nbsp; <B>OUT</B>&nbsp; <B>DeviceID</B>&nbsp;= <I>ConnectionWrapperID</I>&nbsp;
<P>
<B>DeviceID </B>should be set to the <B>NdisLinkContext</B>&nbsp;handle returned by
NDISWAN in the <A HREF="106nstru_3.htm">NDIS_MAC_LINE_UP</A>&nbsp;structure
for the initial NDIS_STATUS_WAN_LINE_UP indication to establish the link.
<P>
The miniport must make the initial line-up indication to establish a link (or
open a data channel on a line) before returning from this request in order to
supply this <B>DeviceID</B>&nbsp;value. 
<P>
2. <B>IN</B>&nbsp; <B>DeviceClass</B>&nbsp;= “tapi/line”<BR>
&nbsp; &nbsp; <B>IN</B>&nbsp; <B>ulSelect </B>= LINECALLSELECT_LINE<BR>
&nbsp; &nbsp; <B>IN</B>&nbsp; <B>hdLine</B>&nbsp;= <I>OpenLineHandle</I><BR>
&nbsp; &nbsp; <B>OUT</B>&nbsp; <B>DeviceID</B>&nbsp;= <I>ulDeviceID</I>&nbsp;
<P>
<B>DeviceID</B>&nbsp;will be set to the miniport-determined DeviceID associated
with the line handle.
</DL>
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALLINEHANDLE<BR>
NDIS_STATUS_TAPI_INVALADDRESSID<BR>
NDIS_STATUS_TAPI_INVALCALLHANDLE<BR>
NDIS_STATUS_TAPI_NODEVICE<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_GET_LINE_DEV_STATUS_NR"></A>OID_TAPI_GET_LINE_DEV_STATUS</H4>
<P>
This OID requests the miniport to return the current status for the specified
open line device. The returned information is global to all addresses on the
line. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_GET_LINE_DEV_STATUS structure, defined as
follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_GET_LINE_DEV_STATUS { 
&nbsp; &nbsp; IN ULONG             ulRequestID; 
&nbsp; &nbsp; IN HDRV_LINE         hdLine; 
&nbsp; &nbsp; OUT LINE_DEV_STATUS  LineDevStatus; 
} NDIS_TAPI_GET_LINE_DEV_STATUS, *PNDIS_TAPI_GET_LINE_DEV_STATUS; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdLine</B>
<DD>
Specifies the miniport’s handle to the line to be queried.
<BR>
<DT>
<B>LineDevStatus</B>
<DD>
Specifies a variable-sized structure of type LINE_DEV_STATUS. See <I>ndistapi.h</I>
for details. 
<P>
The miniport fills this structure with the line’s current device status to
complete this request successfully.
<P>
The structure at <B>LineDevStatus </B>has at least <B>sizeof(</B>LINE_DEV_STATUS<B>)
</B>bytes reserved.
</DL>
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALLINEHANDLE<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_MAKE_CALL_NR"></A>OID_TAPI_MAKE_CALL</H4>
<P>
This OID requests the miniport to place a call on the specified line to the
specified destination address. Optionally, additional call parameters can be
specified if the miniport is to use something other than default call-setup
parameters. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_MAKE_CALL structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_MAKE_CALL { 
&nbsp; &nbsp; IN ULONG             ulRequestID; 
&nbsp; &nbsp; IN HDRV_LINE         hdLine; 
&nbsp; &nbsp; IN HTAPI_CALL        htCall; 
&nbsp; &nbsp; OUT HDRV_CALL        hdCall; 
&nbsp; &nbsp; IN ULONG             ulDestAddressSize; 
&nbsp; &nbsp; IN ULONG             ulDestAddressOffset; 
&nbsp; &nbsp; IN BOOLEAN           bUseDefaultLineCallParams; 
&nbsp; &nbsp; IN LINE_CALL_PARAMS  LineCallParams; 
} NDIS_TAPI_MAKE_CALL, *PNDIS_TAPI_MAKE_CALL; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdLine</B>
<DD>
Specifies the miniport’s handle to the line on which the new call is to be
originated.
<BR>
<DT>
<B>htCall</B>
<DD>
Specifies NDISTAPI’s handle to the call. 
<P>
The miniport must save this handle for use in subsequent notifications, in
particular the initial <A HREF="106nstru_3.htm">NDIS_MAC_LINE_UP</A>
notification to establish a link or data channel.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call. The miniport must fill this
member with its handle for the call before completing this request
successfully. This handle is ignored if the miniport returns an error status.
<BR>
<DT>
<B>ulDestAddressSize</B>
<DD>
Specifies the size in bytes of the variable-size buffer at <B>ulDestAddressOffset</B>
containing the destination address. 
<P>
This member can be zero for undialed addresses, such as for a hot phone, which
always automatically connects to a predefined number, or when dialing will be
done subsequently with an <A HREF="#DDK_OID_TAPI_DIAL_NR">OID_TAPI_DIAL</A>
request. 
<BR>
<DT>
<B>ulDestAddressOffset</B>
<DD>
Specifies the offset in bytes from the beginning of this structure to the
destination address. This destination addresss is in standard dialable number
format. This member should be zero if <B>ulDestAddressSize</B>&nbsp;is zero. 
<P>
If dialing will be done subsequently with an OID_TAPI_DIAL request, the driver
should allocate an available call appearance on receipt of this request and
remain in the dialtone state until dialing begins. Drivers of NICs that have
inverse multiplexing capabilities can allow an application to specify many
addresses at once.
<BR>
<DT>
<B>bUseDefaultLineCallParams</B>
<DD>
Specifies whether the miniport should use the default call-setup parameters or
the parameters specified in <B>LineCallParams</B>&nbsp;when making the call. If
this member is FALSE, the driver should ignore <B>LineCallParams</B>.
<BR>
<DT>
<B>LineCallParams</B>
<DD>
The LINE_CALL_PARAMS structure at this member specifies how the call should be
set up. It selects elements such as the call’s bearer mode, data rate,
expected media mode, origination address, blocking of caller ID information,
and dialing parameters. See <I>ndistapi.h</I>&nbsp;for details. 
</DL>
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_ADDRESSBLOCKED<BR>
NDIS_STATUS_TAPI_BEARERMODEUNAVAIL<BR>
NDIS_STATUS_TAPI_CALLUNAVAIL<BR>
NDIS_STATUS_TAPI_DIALBILLING<BR>
NDIS_STATUS_TAPI_DIALQUIET<BR>
NDIS_STATUS_TAPI_DIALDIALTONE<BR>
NDIS_STATUS_TAPI_DIALPROMPT<BR>
NDIS_STATUS_TAPI_INUSE<BR>
NDIS_STATUS_TAPI_INVALBEARERMODE<BR>
NDIS_STATUS_TAPI_INVALMEDIAMODE<BR>
NDIS_STATUS_TAPI_INVALLINESTATE<BR>
NDIS_STATUS_TAPI_INVALRATE<BR>
NDIS_STATUS_TAPI_INVALLINEHANDLE<BR>
NDIS_STATUS_TAPI_INVALADDRESS<BR>
NDIS_STATUS_TAPI_INVALADDRESSID<BR>
NDIS_STATUS_TAPI_INVALCALLPARAMS<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_TAPI_RATEUNAVAIL<BR>
NDIS_STATUS_TAPI_USERUSERINFOTOOBIG<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_OPEN_NR"></A>OID_TAPI_OPEN</H4>
<P>
This OID requests the miniport to open the line device designated by the given
device ID and return the NIC driver’s handle for the device. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_OPEN structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_OPEN { 
&nbsp; &nbsp; IN ULONG       ulRequestID; 
&nbsp; &nbsp; IN ULONG       ulDeviceID; 
&nbsp; &nbsp; IN HTAPI_LINE  htLine; 
&nbsp; &nbsp; OUT HDRV_LINE  hdLine; 
} NDIS_TAPI_OPEN, *PNDIS_TAPI_OPEN; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>ulDeviceID</B>
<DD>
Specifies the line device to be queried. This was set up in a preceding <A HREF="#DDK_OID_TAPI_PROVIDER_INITIALIZE_NR">OID_TAPI_PROVIDER_INITIALIZE</A>
request.  
<BR>
<DT>
<B>htLine</B>
<DD>
Specifies NDISTAPI’s handle to the line device to be used in subsequent calls
to the LINE_EVENT callback procedure to identify the line
<BR>
<DT>
<B>hdLine</B>
<DD>
Specifies the miniport NIC driver’s handle to the line device. 
<P>
The NIC driver must fill this location with its handle for the line device to
complete this request successfully. This handle is ignored if the miniport
completes the request with an error status.
</DL>
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_ALLOCATED<BR>
NDIS_STATUS_TAPI_INVALMEDIAMODE<BR>
NDIS_STATUS_FAILURE
<P>
The miniport must retain the <B>htLine</B>&nbsp;handle for the device provided by
NDISTAPI for use in subsequent <A HREF="106nstru_8.htm">NDIS_TAPI_EVENT</A>
notifications using the LINE_EVENT structure. 
<H4><A NAME="DDK_OID_TAPI_PROVIDER_INITIALIZE_NR"></A>OID_TAPI_PROVIDER_INITIALIZE</H4>
<P>
This OID requests that the miniport initialize itself as a TAPI provider. The
driver should set up whatever internal state it uses to track incoming
requests from TAPI.
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_PROVIDER_INITITIALIZE structure, defined as
follows: 
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_PROVIDER_INITIALIZE { 
&nbsp; &nbsp; IN ULONG   ulRequestID; 
&nbsp; &nbsp; IN ULONG   ulDeviceIDBase; 
&nbsp; &nbsp; OUT ULONG  ulNumLineDevs; 
&nbsp; &nbsp; OUT ULONG  ulProviderID; 
} NDIS_TAPI_PROVIDER_INITIALIZE, *PNDIS_TAPI_PROVIDER_INITIALIZE; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>ulDeviceIDBase</B>
<DD>
Specifies the lowest device ID for the line devices supported by the miniport.
Subsequent to this request, the driver uses this value as the zero-based line
device identifier value. That is, if <B>ulNumLineDevs</B>&nbsp;is greater than one,
the <B>ulDeviceID</B>&nbsp;values subsequently passed in requests such as <A HREF="#DDK_OID_TAPI_OPEN_NR">OID_TAPI_OPEN</A>,
contains this value for the first line, this value plus one for the second
line, and so forth. 
<BR>
<DT>
<B>ulNumLineDevs</B>
<DD>
Specifies the number of line devices supported by the miniport to complete
this request successfully. 
<BR>
<DT>
<B>ulProviderID</B>
<DD>
Specifies an ID for the WAN NIC driver if this request is completed
successfully. This value must be unique within the set of WAN drivers that
support TAPI; the <I>NdisMiniportContext</I>&nbsp;handle passed in to the
MiniportInitialize function can be used to provide a guaranteed unique value.
</DL>
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_CONFIG_DIALOG_NR"></A>OID_TAPI_CONFIG_DIALOG</H4>
<P>
This OID requests the miniport to return the name of a user-mode dynamic-link
library that can be loaded and called to configure the specified device. 
<P>
Such a configuration DLL exports the following function by name:
<P>
<B>&nbsp; &nbsp; LONG<BR>
&nbsp; &nbsp; WINAPI<BR>
&nbsp; &nbsp; ConfigDialog(<BR>
&nbsp; &nbsp; &nbsp; &nbsp; IN  HWND  </B><I>hwndOwner</I><B>,<BR>
&nbsp; &nbsp; &nbsp; &nbsp; IN  ULONG  </B><I>ulDeviceID</I><B>,<BR>
&nbsp; &nbsp; &nbsp; &nbsp; IN  LPCSTR  </B><I>lpszDeviceClass</I><B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; );</B>
<P>
Support for this request is optional. This request is not made by RAS. 
<P>
The NDIS_TAPI_CONFIG_DIALOG structure, defined as follows, is used with this
OID to retrieve the name of a user-mode dynamic link library that can be
called to configure the specified device.
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_CONFIG_DIALOG { 
&nbsp; &nbsp; IN ULONG  ulRequestID; 
&nbsp; &nbsp; IN ULONG  ulDeviceID; 
&nbsp; &nbsp; IN ULONG  ulDeviceClassSize; 
&nbsp; &nbsp; IN ULONG  ulDeviceClassOffset; 
&nbsp; &nbsp; IN ULONG  ulLibraryNameTotalSize; 
&nbsp; &nbsp; OUT ULONG ulLibraryNameNeededSize; 
&nbsp; &nbsp; OUT CHAR  szLibraryName[1]; 
} NDIS_TAPI_CONFIG_DIALOG, *PNDIS_TAPI_CONFIG_DIALOG; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<UL>
<P>
<B>ulRequestID</B>
<P>
Reserved.
</UL>
<DL>
<DT>
<B>ulDeviceID</B>
<DD>
Specifies the line device to be configured. This was set up in a preceding <A HREF="#DDK_OID_TAPI_PROVIDER_INITIALIZE_NR">OID_TAPI_PROVIDER_INITIALIZE</A>
request. 
<BR>
<DT>
<B>ulDeviceClassSize</B>
<DD>
Specifies the size in bytes of the device-class string. 
<BR>
<DT>
<B>ulDeviceClassOffset</B>
<DD>
Specifies the offset in bytes to the zero-terminated, variable-size counted
string specifying the class of the device whose configuration is requested.
Valid device class strings are the same as those specified for the <A HREF="#DDK_OID_TAPI_GET_ID_NR">OID_TAPI_GET_ID</A>
request when it is applied to a “line” device (<B>ulSelect</B>&nbsp;has the value
LINECALLSELECT_LINE).
<BR>
<DT>
<B>ulLibraryNameTotalSize</B>
<DD>
Specifies the size in bytes of the <B>szLibraryName</B>&nbsp;member.
<BR>
<DT>
<B>ulLibraryNameNeededSize</B>
<DD>
Specifies the size in bytes that is needed to hold all the returned
information.
<BR>
<DT>
<B>szLibraryName</B>
<DD>
Specifies space for a zero-terminated string naming a configuration DLL for
the requested device. Names not containing a complete path or an extension
will be subject to the rules used by the Win32 <B>LoadLibrary</B>&nbsp;function for
determining default paths and extensions. If the miniport determines this
buffer is too small to hold all the information, it should specify the
necessary size in the <B>ulLibraryNameNeededSize</B>&nbsp;member and return an
NDIS_STATUS_TAPI_STRUCTURETOOSMALL error.
</DL>
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_STRUCTURETOOSMALL<BR>
NDIS_STATUS_TAPI_INVALDEVICECLASS<BR>
NDIS_STATUS_TAPI_OPERATIONUNAVAIL<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_DEV_SPECIFIC_NR"></A>OID_TAPI_DEV_SPECIFIC</H4>
<P>
This OID requests the miniport to provide access to features not accessible
through other OID requests. The meaning of the extensions are device-specific,
so the application must be fully aware of them to take advantage of these
extensions. 
<P>
Support for this request is optional. 
<P>
This request uses an NDIS_TAPI_DEV_SPECIFIC structure, defined as follows, to
query and provide access to features not specified in other TAPI OID requests:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_DEV_SPECIFIC { 
&nbsp; &nbsp; IN ULONG      ulRequestID; 
&nbsp; &nbsp; IN HDRV_LINE  hdLine; 
&nbsp; &nbsp; IN ULONG      ulAddressID; 
&nbsp; &nbsp; IN HDRV_CALL  hdCall; 
&nbsp; &nbsp; IN OUT ULONG  ulParamsSize; 
&nbsp; &nbsp; IN OUT UCHAR  Params[1]; 
} NDIS_TAPI_DEV_SPECIFIC, *PNDIS_TAPI_DEV_SPECIFIC; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following device-specific
information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdLine</B>
<DD>
Specifies the miniport’s handle to the line to be operated on. 
<BR>
<DT>
<B>ulAddressID</B>
<DD>
Specifies the address on the specified line to be operated on.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call to be operated on. This member can
be NULL.
<BR>
<DT>
<B>ulParamsSize</B>
<DD>
Specifies the number of bytes in the following parameter block. On entry, this
member will contain the size in bytes of the parameter block passed in to the
miniport. 
<P>
If the miniport returns information in the parameter block, it should set this
member to the size in bytes of the returned information, which cannot exceed
the input <B>ulParamsSize</B>. Otherwise, the miniport should set this member
to zero to indicate that it is returning no information.
<BR>
<DT>
<B>Params</B>
<DD>
Specifies a device-specific parameter block.
</DL>
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALLINEHANDLE<BR>
NDIS_STATUS_TAPI_INVALADDRESSID<BR>
NDIS_STATUS_TAPI_OPERATIONUNAVAIL<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_GET_EXTENSION_ID_NR"></A>OID_TAPI_GET_EXTENSION_ID</H4>
<P>
This OID requests the miniport to return the extension ID for the specified
line device. 
<P>
Support for this request is optional. 
<P>
This request uses an NDIS_TAPI_GET_EXTENSION_ID structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_GET_EXTENSION_ID { 
&nbsp; &nbsp; IN ULONG               ulRequestID; 
&nbsp; &nbsp; IN ULONG               ulDeviceID; 
&nbsp; &nbsp; OUT LINE_EXTENSION_ID  LineExtensionID; 
} NDIS_TAPI_GET_EXTENSION_ID, *PNDIS_TAPI_GET_EXTENSION_ID; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>ulDeviceID</B>
<DD>
Specifies the link or data channel to be queried. This was set up in a
preceding <A HREF="#DDK_OID_TAPI_GET_ID_NR">OID_TAPI_GET_ID</A>&nbsp;request. 
<BR>
<DT>
<B>LineExtensionID</B>
<DD>
Points to a structure of type LINE_EXTENSION_ID. See <I>ndistapi.h</I>&nbsp;for
details. 
<P>
If the miniport supports device-specific extensions, it fills this structure
with the extension ID of these extensions. Otherwise, it fills this structure
with zeros. 
<P>
For a bound protocol, a valid extension ID cannot consist of all zeros.
</DL>
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_NEGOTIATE_EXT_VERSION_NR"></A>OID_TAPI_NEGOTIATE_EXT_VERSION</H4>
<P>
This OID requests the miniport to return the highest version extension number
the miniport is willing to operate under for this device, given the range of
possible extension versions. 
<P>
Support for this request is optional. 
<P>
This request uses an NDIS_TAPI_NEGOTIATE_EXT_VERSION structure, defined as
follows: 
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_NEGOTIATE_EXT_VERSION { 
&nbsp; &nbsp; IN ULONG   ulRequestID; 
&nbsp; &nbsp; IN ULONG   ulDeviceID; 
&nbsp; &nbsp; IN ULONG   ulLowVersion; 
&nbsp; &nbsp; IN ULONG   ulHighVersion; 
&nbsp; &nbsp; OUT ULONG  ulExtVersion; 
} NDIS_TAPI_NEGOTIATE_EXT_VERSION, *PNDIS_TAPI_NEGOTIATE_EXT_VERSION; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>ulDeviceID</B>
<DD>
Specifies the link or data channel  for which the extension version
negotiation is to be performed. The value INITIALIZE_NEGOTIATION cannot be
used. This was set up in a preceding <A HREF="#DDK_OID_TAPI_GET_ID_NR">OID_TAPI_GET_ID</A>
request.
<BR>
<DT>
<B>ulLowVersion</B>
<DD>
Specifies the lowest extension version under which NDISTAPI or its client
application will operate. The most significant two bytes specify the major
version and the least significant two bytes specify the minor version. The
value of this member is not validated by NDISTAPI when this request is made.
<BR>
<DT>
<B>ulHighVersion</B>
<DD>
Specifies the highest extension version under which NDISTAPI or its client
application will operate. The most significant two bytes specify the major
version and the least significant two bytes specify the minor version. The
value of this member is not validated by NDISTAPI when this request is made.
<BR>
<DT>
<B>ulExtVersion</B>
<DD>
Specifies the miniport’s extension version within the range specified by <B>ulLowVersion</B>
and <B>ulHighVersion</B>. The most significant two bytes specifiy the major
version and the least significant two bytes specify the minor version. 
<P>
The miniport fills this member with the highest extension version number,
within the range requested by the caller, under which it is willing to operate
to complete this request successfully. 
<P>
If the requested range specified in <B>ulLowVersion</B>&nbsp;and <B>ulHighVersion</B>
does not overlap the range supported by the miniport, it returns
NDIS_STATUS_TAPI_INCOMPATIBLEEXTVERSION.
</DL>
<P>
The MiniportQueryInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INCOMPATIBLEEXTVERSION<BR>
NDIS_STATUS_TAPI_NODRIVER<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H3>TAPI Set Information Requests</H3>
<P>
WAN miniports return no information for set requests other than the completion
status. All OID-specific structures are provided by the protocol driver, and
their members are read-only to the underlying WAN NIC miniport. 
<H4><A NAME="DDK_OID_TAPI_ANSWER_NR"></A>OID_TAPI_ANSWER</H4>
<P>
This OID requests the miniport to answer the specified call on offer.
Optionally, it requests that the miniport send the specified user-to-user
information to the calling party.
<P>
Support for this request is mandatory. 
<P>
The OID_TAPI_ANSWER request uses an NDIS_TAPI_ANSWER structure, defined as
follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_ANSWER { 
&nbsp; &nbsp; IN ULONG      ulRequestID; 
&nbsp; &nbsp; IN HDRV_CALL  hdCall; 
&nbsp; &nbsp; IN ULONG      ulUserUserInfoSize; 
&nbsp; &nbsp; IN UCHAR      UserUserInfo[1]; 
} NDIS_TAPI_ANSWER, *PNDIS_TAPI_ANSWER; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call to be answered. The driver set
this handle up when it called <B><A HREF="103ndisx_108.htm">NdisMIndicateStatus</A></B>
with the LINE_EVENT_NEWCALL indication. 
<BR>
<DT>
<B>ulUserUserInfoSize</B>
<DD>
Specifies the size in bytes of the user-to-user information in <B>UserUserInfo</B>.
If this member is zero, <B>UserUserInfo</B>&nbsp;should be ignored .
<BR>
<DT>
<B>UserUserInfo</B>
<DD>
Specifies a string containing user-to-user information to be sent to the
remote party as part of the call accept. User-to-user information is sent only
if supported by the underlying network (see <A HREF="#DDK_OID_TAPI_GET_DEV_CAPS_NR">OID_TAPI_GET_DEV_CAPS</A>).
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALCALLHANDLE<BR>
NDIS_STATUS_TAPI_INVALCALLSTATE<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_TAPI_USERUSERINFOTOOBIG<BR>
NDIS_STATUS_FAILURE
<P>
Upon successful completion of the OID_TAPI_ANSWER request, the miniport must
be prepared to respond to the <A HREF="#DDK_OID_TAPI_GET_ID_NR">OID_TAPI_GET_ID</A>
request. 
<P>
The initiating application must wait for the LINECALLSTATE_CONNECTED
indication before actually writing data.
<H4><A NAME="DDK_OID_TAPI_CLOSE_NR"></A>OID_TAPI_CLOSE</H4>
<P>
This OID requests the miniport to close the specified open line device. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_CLOSE structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_CLOSE { 
&nbsp; &nbsp; IN ULONG      ulRequestID; 
&nbsp; &nbsp; IN HDRV_LINE  hdLine; 
} NDIS_TAPI_CLOSE, *PNDIS_TAPI_CLOSE; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdLine</B>
<DD>
Specifies the miniport’s handle to the line to be closed. After the line has
been successfully closed, this handle is no longer valid.
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING
<H4><A NAME="DDK_OID_TAPI_CLOSE_CALL_NR"></A>OID_TAPI_CLOSE_CALL</H4>
<P>
This OID requests the miniport to close a specified call after completing or
terminating all outstanding asynchronous requests on the call. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_CLOSE_CALL structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_CLOSE_CALL { 
&nbsp; &nbsp; IN ULONG      ulRequestID; 
&nbsp; &nbsp; IN HDRV_CALL  hdCall; 
} NDIS_TAPI_CLOSE_CALL, *PNDIS_TAPI_CLOSE_CALL; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call to be closed. After the call has
been successfully closed this handle is no longer valid.
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING
<H4><A NAME="DDK_OID_TAPI_CONDITIONAL_MEDIA_DETECTION_NR"></A>OID_TAPI_CONDITIONAL_MEDIA_DETECTION</H4>
<P>
NDISTAPI makes this OID request to NDISWAN, which passes it down to WAN NIC
miniports, whenever a client application uses LINEMAPPER as the <I>dwDeviceID</I>
in the <B>lineOpen</B>&nbsp;function to request that lines be scanned to find one
that supports the desired media mode(s) and call parameters. 
<P>
NDISTAPI scans based on the union of the desired media modes and the other
media modes currently being monitored on the line, to give each WAN miniport
the opportunity to indicate whether it can simultaneously monitor for all of
the requested media modes. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_CONDITIONAL_MEDIA_DETECTION structure, defined
as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_CONDITIONAL_MEDIA_DETECTION { 
&nbsp; &nbsp; IN ULONG             ulRequestID; 
&nbsp; &nbsp; IN HDRV_LINE         hdLine; 
&nbsp; &nbsp; IN ULONG             ulMediaModes; 
&nbsp; &nbsp; IN LINE_CALL_PARAMS  LineCallParams; 
} NDIS_TAPI_CONDITIONAL_MEDIA_DETECTION, 
&nbsp; &nbsp; *PNDIS_TAPI_CONDITIONAL_MEDIA_DETECTION; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdLine</B>
<DD>
Specifies the the miniport’s handle to the line on which media monitoring and
parameter capabilites are to be set.
<BR>
<DT>
<B>ulMediaModes</B>
<DD>
Specifies the media mode(s) currently of interest to the calling application.
This parameter uses the LINEMEDIAMODE constants. See <I>ndistapi.h</I>&nbsp;for
details. 
<BR>
<DT>
<B>LineCallParams</B>
<DD>
The LINE_CALL_PARAMS structure specifies information that the line device
should provide. The only relevent members for the purpose of this request are
the following:
<P>
<B>ULONG    ulBearerMode;</B>
<P>
<B>ULONG    ulMinRate;</B>
<P>
<B>ULONG    ulMaxRate;</B>
<P>
<B>ULONG    ulMediaMode;</B>
<P>
<B>ULONG    ulCallParamFlags;</B>
<P>
<B>ULONG    ulAddressMode;</B>
<P>
If the value of <B>ulAddressMode</B>&nbsp;is LINEADDRESSMODE_ADDRESSID, any address
on the line is acceptable. Otherwise, the value of <B>ulAddressMode</B>&nbsp;is
LINEADDRESSMODE_DIALABLEADDR, indicating either that the miniport should
search for a specific originating address (phone number), or, if it is a
provider-specific extension, the <B>ulOrigAddressSize/Offset</B>&nbsp;and the <B>ulDevSpecificSize/Offset</B>
values are also relevant. All other members of the LINE_CALL_PARAMS structure
are irrelevant to this OID request.
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALLINEHANDLE<BR>
NDIS_STATUS_TAPI_NODRIVER<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_TAPI_INVALMEDIAMODE<BR>
NDIS_STATUS_FAILURE
<P>
If a miniport can monitor for the specified set of media modes and support the
capabilities specified in <B>CallParams</B>, it completes the request with
NDIS_STATUS_SUCCESS, but it leaves the active media monitoring modes for the
line unchanged. 
<H4><A NAME="DDK_OID_TAPI_DROP_NR"></A>OID_TAPI_DROP</H4>
<P>
This OID requests the miniport to drop or disconnect the specified call. 
<P>
User-to-user information can optionally be transmitted as part of the call
disconnect. This request can be made by the application at any time. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_DROP structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_DROP { 
&nbsp; &nbsp; IN ULONG      ulRequestID; 
&nbsp; &nbsp; IN HDRV_CALL  hdCall; 
&nbsp; &nbsp; IN ULONG      ulUserUserInfoSize; 
&nbsp; &nbsp; IN UCHAR      UserUserInfo[1]; 
} NDIS_TAPI_DROP, *PNDIS_TAPI_DROP; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call to be dropped.
<BR>
<DT>
<B>ulUserUserInfoSize</B>
<DD>
Specifies the size in bytes of the user-to-user information in <B>UserUserInfo.</B>
If this member is zero, the miniport should ignore the next member.
<BR>
<DT>
<B>UserUserInfo</B>
<DD>
Specifies a string containing user-to-user information to be sent to the
remote party as part of the call drop. User-to-user information is sent only
if supported by the underlying network (see <A HREF="#DDK_OID_TAPI_GET_DEV_CAPS_NR">OID_TAPI_GET_DEV_CAPS</A>).
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALCALLHANDLE<BR>
NDIS_STATUS_TAPI_INVALCALLSTATE<BR>
NDIS_STATUS_TAPI_USERUSERINFOTOOBIG<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<P>
When a miniport completes this request successfully, the call should be in the
idle state. However, the miniport can still receive requests, such as
statistics queries, specifying the <B>hdCall</B>&nbsp;handle until it completes the
<A HREF="#DDK_OID_TAPI_CLOSE_CALL_NR">OID_TAPI_CLOSE_CALL</A>&nbsp;request for this
handle. 
<H4><A NAME="DDK_OID_TAPI_PROVIDER_SHUTDOWN_NR"></A>OID_TAPI_PROVIDER_SHUTDOWN</H4>
<P>
This OID requests the miniport to shut down its TAPI operations when TAPI is
cleaning up its state because applications are no longer using TAPI services. 
<P>
On receipt of this OID, the miniport should terminate any activities
associated with TAPI that it has in progress, call <B><A HREF="103ndisx_108.htm">NdisMIndicateStatus</A></B>
with <A HREF="106nstru_2.htm">NDIS_MAC_LINE_DOWN</A>&nbsp;to NDISWAN for any
lines currently open, and clean up any state it was using to track TAPI
operations. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_PROVIDER_SHUTDOWN structure, defined as
follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_PROVIDER_SHUTDOWN { 
&nbsp; &nbsp; IN ULONG  ulRequestID; 
} NDIS_TAPI_PROVIDER_SHUTDOWN, *PNDIS_TAPI_PROVIDER_SHUTDOWN; 
&nbsp;</FONT></PRE>
<P>
The member of this structure contains the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_SET_APP_SPECIFIC_NR"></A>OID_TAPI_SET_APP_SPECIFIC</H4>
<P>
This OID requests the miniport to set the <B>ulAppSpecific</B>&nbsp;member of the
specified call’s LINECALLINFO structure. See <I>ndistapi.h</I>&nbsp;for details of
this structure. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_SET_APP_SPECIFIC structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_SET_APP_SPECIFIC { 
&nbsp; &nbsp; IN ULONG      ulRequestID; 
&nbsp; &nbsp; IN HDRV_CALL  hdCall; 
&nbsp; &nbsp; IN ULONG      ulAppSpecific; 
} NDIS_TAPI_SET_APP_SPECIFIC, *PNDIS_TAPI_SET_APP_SPECIFIC; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call for which the application-specific
member is to be set.
<BR>
<DT>
<B>ulAppSpecific</B>
<DD>
Specifies the new content of the <B>ulAppSpecific</B>&nbsp;member for the call’s
LINECALLINFO structure. This value is uninterpreted by the NIC driver. The
value is not validated by NDISTAPI when this request is made.
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALCALLHANDLE<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_SET_CALL_PARAMS_NR"></A>OID_TAPI_SET_CALL_PARAMS</H4>
<P>
This OID requests the miniport to set certain call parameters for an existing
call. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_SET_CALL_PARAMS structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">struct _NDIS_TAPI_SET_CALL_PARAMS { 
&nbsp; &nbsp; IN ULONG             ulRequestID; 
&nbsp; &nbsp; IN HDRV_CALL         hdCall; 
&nbsp; &nbsp; IN ULONG             ulBearerMode; 
&nbsp; &nbsp; IN ULONG             ulMinRate; 
&nbsp; &nbsp; IN ULONG             ulMaxRate; 
&nbsp; &nbsp; IN BOOLEAN           bSetLineDialParams; 
&nbsp; &nbsp; IN LINE_DIAL_PARAMS  LineDialParams; 
} NDIS_TAPI_SET_CALL_PARAMS, *PNDIS_TAPI_SET_CALL_PARAMS; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call for which the following parameters
are to be changed.
<BR>
<DT>
<B>ulBearerMode</B>
<DD>
Specifies the new bearer mode for the call. This member can have only one of
the following LINEBEARERMODE flags set:
<P>
LINEBEARERMODE_VOICE
<P>
LINEBEARERMODE_SPEECH
<P>
LINEBEARERMODE_MULTIUSE
<P>
LINEBEARERMODE_DATA
<P>
LINEBEARERMODE_ALTSPEECHDATA
<P>
LINEBEARERMODE_NONCALLSIGNALING
<BR>
<DT>
<B>ulMinRate</B>
<DD>
Specifies a lower bound for the call’s new data rate. The value of this member
is not validated by NDISTAPI before the miniport is called.
<P>
This value indicates that the caller is willing to accept a new rate as low as
this one.
<BR>
<DT>
<B>ulMaxRate</B>
<DD>
Specifies an upper bound for the call’s new data rate. The value of this
member is not validated by NDISTAPI before the miniport is called. 
<P>
This value indicates the maximum data rate the caller would like. 
<P>
Equal values for the <B>ulMinRate </B>and <B>ulMaxRate</B>&nbsp;members indicate
that the caller requires an exact rate. 
<BR>
<DT>
<B>bSetLineDialParams</B>
<DD>
Specifies whether the following dialing parameters should be used for the
call. If this member is FALSE, the call’s current dialing parameters should be
used and the next member should be ignored.
<BR>
<DT>
<B>LineDialParams</B>
<DD>
This structure specifies the new dial parameters for the call. See <I>ndistapi.h</I>
for details. 
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALCALLHANDLE<BR>
NDIS_STATUS_TAPI_INVALCALLSTATE<BR>
NDIS_STATUS_TAPI_INVALBEARERMODE<BR>
NDIS_STATUS_TAPI_BEARERMODEUNAVAIL<BR>
NDIS_STATUS_TAPI_INVALRATE<BR>
NDIS_STATUS_TAPI_RATEUNAVAIL<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL <BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_SET_DEFAULT_MEDIA_DETECTION_NR"></A>OID_TAPI_SET_DEFAULT_MEDIA_DETECTION</H4>
<P>
This OID requests the miniport to use a new set of media modes to detect for
the indicated line, thereby replacing whatever set it was using. 
<P>
The miniport must <I>not</I>&nbsp;notify NDISWAN of an incoming call unless this
request has been successfully completed for the incoming call’s media mode.
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_SET_DEFAULT_MEDIA_DETECTION structure, defined
as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_SET_DEFAULT_MEDIA_DETECTION { 
&nbsp; &nbsp; IN ULONG      ulRequestID; 
&nbsp; &nbsp; IN HDRV_LINE  hdLine; 
&nbsp; &nbsp; IN ULONG      ulMediaModes; 
} NDIS_TAPI_SET_DEFAULT_MEDIA_DETECTION, 
&nbsp; &nbsp; *PNDIS_TAPI_SET_DEFAULT_MEDIA_DETECTION; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdLine</B>
<DD>
Specifies the miniport’s handle to the line for which the default media mode
should be set.
<BR>
<DT>
<B>ulMediaModes</B>
<DD>
Specifies the media mode(s) of interest to NDISTAPI. This member is set with
one or more of the LINEMEDIAMODE constants. See <I>ndistapi.h</I>&nbsp;for details.
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALLINEHANDLE<BR>
NDIS_STATUS_TAPI_INVALMEDIAMODE<BR>
NDIS_STATUS_TAPI_NODRIVER<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_SET_DEV_CONFIG_NR"></A>OID_TAPI_SET_DEV_CONFIG</H4>
<P>
This OID requests the miniport to restore the configuration of a device
associated one-to-one with the line device from a configuration previously
obtained using <A HREF="#DDK_OID_TAPI_GET_DEV_CONFIG_NR">OID_TAPI_GET_DEV_CONFIG</A>.
<P>
The contents of this structure are specific to the miniport’s line and device
class. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_SET_DEV_CONFIG structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_SET_DEV_CONFIG { 
&nbsp; &nbsp; IN ULONG  ulRequestID; 
&nbsp; &nbsp; IN ULONG  ulDeviceID; 
&nbsp; &nbsp; IN ULONG  ulDeviceClassSize; 
&nbsp; &nbsp; IN ULONG  ulDeviceClassOffset; 
&nbsp; &nbsp; IN ULONG  ulDeviceConfigSize; 
&nbsp; &nbsp; IN UCHAR  DeviceConfig[1]; 
} NDIS_TAPI_SET_DEV_CONFIG, *PNDIS_TAPI_SET_DEV_CONFIG; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>ulDeviceID</B>
<DD>
Specifies the line device to be configured. This value was set up in a
preceding <A HREF="#DDK_OID_TAPI_PROVIDER_INITIALIZE_NR">OID_TAPI_PROVIDER_INITIALIZE</A>
request. 
<BR>
<DT>
<B>ulDeviceClassSize</B>
<DD>
Specifies the size in bytes of the device class for the device whose
configuration is to be restored. Valid device class strings are the same as
those specified for the <A HREF="#DDK_OID_TAPI_GET_ID_NR">OID_TAPI_GET_ID</A>
request when it is applied to a “line” device (<B>ulSelect </B>has the value
LINECALLSELECT_LINE).
<BR>
<DT>
<B>ulDeviceClassOffset</B>
<DD>
Specifies the offset in bytes to the device class of the device whose
configuration is to be restored. 
<BR>
<DT>
<B>ulDeviceConfigSize</B>
<DD>
Specifies the number of bytes at <B>DeviceConfig</B>. This value was already
returned in the <B>ulStringSize</B>&nbsp;member in the VAR_STRING structure
returned for a preceding OID_TAPI_GET_DEV_CONFIG request.
<BR>
<DT>
<B>DeviceConfig</B>
<DD>
Specifies data that was returned in the variable portion of the <A HREF="#DDK_TAPI_Type_VAR_STRING_NR">VAR_STRING</A>
structure for a preceding OID_TAPI_GET_DEV_CONFIG request.
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALDEVICECLASS<BR>
NDIS_STATUS_TAPI_INVALPARAM<BR>
NDIS_STATUS_TAPI_NODRIVER<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_SET_MEDIA_MODE_NR"></A>OID_TAPI_SET_MEDIA_MODE</H4>
<P>
This OID requests the miniport to change a call’s media mode as stored in the
LINE_CALL_INFO structure for that call. See <I>ndistapi.h</I>&nbsp;for the
declaration of LINE_CALL_INFO. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_SET_MEDIA_MODE structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_SET_MEDIA_MODE { 
&nbsp; &nbsp; IN ULONG      ulRequestID; 
&nbsp; &nbsp; IN HDRV_CALL  hdCall; 
&nbsp; &nbsp; IN ULONG      ulMediaMode; 
} NDIS_TAPI_SET_MEDIA_MODE, *PNDIS_TAPI_SET_MEDIA_MODE; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call for which it should change the
media mode.
<BR>
<DT>
<B>ulMediaMode</B>
<DD>
Specifies the new media mode(s) for the call as one or more of the
LINEMEDIAMODE_<I>XXX</I>&nbsp;flags. 
<P>
If the LINEMEDIAMODE_UNKNOWN flag is set, other media mode flags also can be
set. Such a combination of flags specifies that the call’s media mode is not
fully determined, but that it has been narrowed down to a subset of possible
media modes. If the LINEMEDIAMODE_UNKNOWN flag is clear, only a single media
mode can be specified.
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALCALLHANDLE<BR>
NDIS_STATUS_TAPI_INVALMEDIAMODE<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_SET_STATUS_MESSAGES_NR"></A>OID_TAPI_SET_STATUS_MESSAGES</H4>
<P>
This OID requests the miniport to allow NDISTAPI to specify which notification
messages the miniport should generate for events related to status changes for
the specified line or any of its addresses. 
<P>
By default, address-status and line-status reporting is initially disabled for
a line. 
<P>
Support for this request is mandatory. 
<P>
This request uses an NDIS_TAPI_SET_STATUS_MESSAGES structure, defined as
follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_SET_STATUS_MESSAGES { 
&nbsp; &nbsp; IN ULONG      ulRequestID; 
&nbsp; &nbsp; IN HDRV_LINE  hdLine; 
&nbsp; &nbsp; IN ULONG      ulLineStates; 
&nbsp; &nbsp; IN ULONG      ulAddressStates; 
} NDIS_TAPI_SET_STATUS_MESSAGES, *PNDIS_TAPI_SET_STATUS_MESSAGES; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdLine</B>
<DD>
Specifies the miniport’s handle to the line device.
<BR>
<DT>
<B>ulLineStates</B>
<DD>
Specifies a bit array that identifies status changes for which messages should
be sent to NDISTAPI. This parameter uses the LINEDEVSTATE constants. See <I>ndistapi.h</I>
for details. 
<BR>
<DT>
<B>ulAddressStates</B>
<DD>
Specifies a bit array that identifies which address status changes the
miniport should monitor to send appropriate notifications to NDISTAPI. The
value is an ORed combination of LINEADDRESSSTATE flags. See <I>ndistapi.h</I>
for details. 
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALLINEHANDLE<BR>
NDIS_STATUS_TAPI_INVALLINESTATE<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_ACCEPT_NR"></A>OID_TAPI_ACCEPT</H4>
<P>
This OID requests the miniport to accept the specified call. Optionally, it
requests that the miniport send the specified user-to-user information to the
calling party. 
<P>
Support for this request is optional. 
<P>
The request uses an NDIS_TAPI_ACCEPT structure, defined as follows: 
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_ACCEPT { 
&nbsp; &nbsp; IN ULONG      ulRequestID; 
&nbsp; &nbsp; IN HDRV_CALL  hdCall; 
&nbsp; &nbsp; IN ULONG      ulUserUserInfoSize; 
&nbsp; &nbsp; IN UCHAR      UserUserInfo[1]; 
} NDIS_TAPI_ACCEPT, *PNDIS_TAPI_ACCEPT; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call to be accepted. The driver set
this handle up when it called <B><A HREF="103ndisx_108.htm">NdisMIndicateStatus</A></B>
with the LINE_EVENT_NEWCALL indication. 
<BR>
<DT>
<B>ulUserUserInfoSize</B>
<DD>
Specifies the size in bytes of the user-to-user information in <B>UserUserInfo</B>.
If this member is zero, the miniport should ignore the next member.
<BR>
<DT>
<B>UserUserInfo</B>
<DD>
Specifies a string containing user-to-user information to be sent to the
remote party as part of the call-accept operation. User-to-user information is
sent only if supported by the underlying network (see <A HREF="#DDK_OID_TAPI_GET_DEV_CAPS_NR">OID_TAPI_GET_DEV_CAPS</A>).
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALCALLHANDLE<BR>
NDIS_STATUS_TAPI_INVALCALLSTATE<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_TAPI_USERUSERINFOTOOBIG<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_DIAL_NR"></A>OID_TAPI_DIAL</H4>
<P>
This OID requests the miniport to dial the specified number on the specified
call. 
<P>
Support for this request is optional. 
<P>
This request uses an NDIS_TAPI_DIAL structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_DIAL { 
&nbsp; &nbsp; IN ULONG      ulRequestID; 
&nbsp; &nbsp; IN HDRV_CALL  hdCall; 
&nbsp; &nbsp; IN ULONG      ulDestAddressSize; 
&nbsp; &nbsp; IN CHAR       szDestAddress[1]; 
} NDIS_TAPI_DIAL, *PNDIS_TAPI_DIAL; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call for which it should dial. This
handle was set up in a preceding <A HREF="#DDK_OID_TAPI_MAKE_CALL_NR">OID_TAPI_MAKE_CALL</A>
request. 
<BR>
<DT>
<B>ulDestAddressSize</B>
<DD>
Specifies the size in bytes of the address in the next member.
<BR>
<DT>
<B>szDestAddress</B>
<DD>
Specifies the destination to be dialed in standard dialable number format.
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALCALLHANDLE<BR>
NDIS_STATUS_TAPI_INVALADDRESS<BR>
NDIS_STATUS_TAPI_INVALCALLSTATE<BR>
NDIS_STATUS_TAPI_ADDRESSBLOCKED<BR>
NDIS_STATUS_TAPI_DIALBILLING<BR>
NDIS_STATUS_TAPI_DIALQUIET<BR>
NDIS_STATUS_TAPI_DIALDIALTONE<BR>
NDIS_STATUS_TAPI_DIALPROMPT<BR>
NDIS_STATUS_TAPI_OPERATIONUNAVAIL<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_SECURE_CALL_NR"></A>OID_TAPI_SECURE_CALL</H4>
<P>
This OID requests the miniport to secure a particular call from any
interruptions or interference that can affect the call’s media stream. 
<P>
Support for this request is optional. 
<P>
This request uses an NDIS_TAPI_SECURE_CALL structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_SECURE_CALL { 
&nbsp; &nbsp; IN ULONG      ulRequestID; 
&nbsp; &nbsp; IN HDRV_CALL  hdCall; 
} NDIS_TAPI_SECURE_CALL, *PNDIS_TAPI_SECURE_CALL; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call to be secured.
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALCALLHANDLE<BR>
NDIS_STATUS_TAPI_INVALCALLSTATE<BR>
NDIS_STATUS_TAPI_OPERATIONUNAVAIL<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_SELECT_EXT_VERSION_NR"></A>OID_TAPI_SELECT_EXT_VERSION</H4>
<P>
This OID requests the miniport to select the indicated extension version for
the indicated line device. Subsequent requests on the line operate according
to the selected extension version. 
<P>
Support for this request is optional. 
<P>
This request uses an NDIS_TAPI_SELECT_EXT_VERSION structure, defined as
follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_SELECT_EXT_VERSION { 
&nbsp; &nbsp; IN ULONG      ulRequestID; 
&nbsp; &nbsp; IN HDRV_LINE  hdLine; 
&nbsp; &nbsp; IN ULONG      ulExtVersion; 
} NDIS_TAPI_SELECT_EXT_VERSION, *PNDIS_TAPI_SELECT_EXT_VERSION; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdLine</B>
<DD>
Specifies the handle to the line for which the extension version is to be
selected.
<BR>
<DT>
<B>ulExtVersion</B>
<DD>
Specifies the extension version to be selected. The most significant two bytes
specify the major version number, and the least significant two bytes specify
the minor version number. Zero indicates the miniport should cancel the
current selection.
<P>
This version has been negotiated in a preceding <A HREF="#DDK_OID_TAPI_NEGOTIATE_EXT_VERSION_NR">OID_TAPI_NEGOTIATE_EXT_VERSION</A>
request. 
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INCOMPATIBLEEXTVERSION<BR>
NDIS_STATUS_TAPI_OPERATIONUNAVAIL<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<H4><A NAME="DDK_OID_TAPI_SEND_USER_USER_INFO_NR"></A>OID_TAPI_SEND_USER_USER_INFO</H4>
<P>
This OID requests the miniport to send user-to-user information to the remote
party on the specified call. 
<P>
Support for this request is optional. 
<P>
This request uses an NDIS_TAPI_SEND_USER_USER_INFO structure, defined as
follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_TAPI_SEND_USER_USER_INFO { 
&nbsp; &nbsp; IN ULONG      ulRequestID; 
&nbsp; &nbsp; IN HDRV_CALL  hdCall; 
&nbsp; &nbsp; IN ULONG      ulUserUserInfoSize; 
&nbsp; &nbsp; IN UCHAR      UserUserInfo[1]; 
} NDIS_TAPI_SEND_USER_USER_INFO, *PNDIS_TAPI_SEND_USER_USER_INFO; 
&nbsp;</FONT></PRE>
<P>
The members of this structure contain the following information:
<DL>
<DT>
<B>ulRequestID</B>
<DD>
Reserved.
<BR>
<DT>
<B>hdCall</B>
<DD>
Specifies the miniport’s handle to the call on which to send user-to-user
information.
<BR>
<DT>
<B>ulUserUserInfoSize</B>
<DD>
Specifies the size in bytes of the <B>UserUserInfo</B>&nbsp;string.
<BR>
<DT>
<B>UserUserInfo</B>
<DD>
Specifies a string containing user-to-user information to be sent to the
remote party as part of a call-accept operation. User-to-user information is
sent only if supported by the underlying network (see <A HREF="#DDK_OID_TAPI_GET_DEV_CAPS_NR">OID_TAPI_GET_DEV_CAPS)</A>.
</DL>
<P>
The MiniportSetInformation function can return one of the following:<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_TAPI_INVALCALLHANDLE<BR>
NDIS_STATUS_TAPI_INVALCALLSTATE<BR>
NDIS_STATUS_TAPI_USERUSERINFOTOOBIG<BR>
NDIS_STATUS_TAPI_OPERATIONUNAVAIL<BR>
NDIS_STATUS_TAPI_RESOURCEUNAVAIL<BR>
NDIS_STATUS_FAILURE
<P></FONT>
</BODY>
</HTML>
