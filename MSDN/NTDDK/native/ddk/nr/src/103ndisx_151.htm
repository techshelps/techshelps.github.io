<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NdisOpenProtocolConfiguration</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_NdisOpenProtocolConfiguration_NR"></A>NdisOpenProtocolConfiguration</H2>
<P>
<B>VOID</B><BR>
&nbsp; &nbsp; <B>NdisOpenProtocolConfiguration(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PNDIS_STATUS</B>&nbsp; <I>Status</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PNDIS_HANDLE</B>&nbsp; <I>ConfigurationHandle</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PNDIS_STRING</B>&nbsp; <I>ProtocolSection</I><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>); </B>
<P>
<B>NdisOpenProtocolConfiguration</B>&nbsp;returns a handle for the
HKEY_LOCAL_MACHINE<B>\System\CurrentControlSet\Services<BR>
\</B><I>NICDriverInstance</I><B>\Parameters\</B><I>ProtocolName</I>&nbsp;registry
key. 
<H3>Parameters</H3>
<DL>
<DT>
<I>Status</I>
<DD>
Points to a caller-supplied variable that is set to NDIS_STATUS_SUCCESS or
NDIS_STATUS_FAILURE on return from this function.
<BR>
<DT>
<I>ConfigurationHandle</I>
<DD>
Points to a caller-supplied variable in which this function returns the handle
to the registry key for the named driver to which the caller will bind itself
later. Value entries under this key contain protocol-installed,
adapter-specific information.
<BR>
<DT>
<I>ProtocolSection</I>
<DD>
Points to a counted string, specified in the system-default character set,
naming the NDIS driver, effectively the adapter, for which the <B>Parameters\</B><I>ProtocolName</I>
key in the registry protocol section should be opened. For Windows NT
protocols, this counted string contains Unicode characters. 
<P>
For NDIS drivers that have a ProtocolBindAdapter function, this pointer is the
<I>SystemSpecific1</I>&nbsp;input parameter to ProtocolBindAdapter. 
</DL>
<H3>Comments</H3>
<P>
This function returns a handle that the caller can pass subsequently to the <B>Ndis..Configuration</B>
functions to retrieve or store information in the registry. 
<P>
A protocol driver calls <B>NdisOpenProtocolConfiguration</B>&nbsp;to get a registry
key handle to be passed to <B>NdisReadConfiguration</B>&nbsp;or <B>NdisWriteConfiguration</B>
if it or its installation script stored adapter-specific configuration
information in the protocol section of the registry from which the protocol
sets up its bindings. 
<P>
Windows NT protocols call kernel-mode support routines open their own <B>\</B><I>DriverName</I>\<B>Parameters</B>
registry keys. For more information about these support routines, see the <I>Kernel-Mode
Driver Reference</I>. 
<P>
Callers of <B>NdisOpenProtocolConfiguration</B>&nbsp;run at IRQL PASSIVE_LEVEL. 
<H3>See Also</H3>
<P>
<B><A HREF="103ndisx_20.htm">NdisCloseConfiguration</A></B>, <B><A HREF="103ndisx_79.htm">NdisInitializeString</A></B>,
<B><A HREF="103ndisx_80.htm">NdisInitUnicodeString</A></B>, <B><A HREF="103ndisx_175.htm">NdisReadConfiguration</A></B>,
<B><A HREF="103ndisx_216.htm">NdisWriteConfiguration</A></B>, <B><A HREF="104tdlow_2.htm">ProtocolBindAdapter</A></B>
<P></FONT>
</BODY>
</HTML>
