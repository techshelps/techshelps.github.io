<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NdisAllocateSharedMemory</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_NdisAllocateSharedMemory_NR"></A>NdisAllocateSharedMemory</H2>
<P>
<B>VOID<BR>
</B>&nbsp; &nbsp; <B>NdisAllocateSharedMemory(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN NDIS_HANDLE</B>&nbsp; <I>NdisAdapterHandle</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN ULONG</B>&nbsp; <I>Length</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN BOOLEAN</B>&nbsp; <I>Cached</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PVOID</B>&nbsp; *<I>VirtualAddress</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PNDIS_PHYSICAL_ADDRESS</B>&nbsp; <I>PhysicalAddress</I><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>NdisAllocateSharedMemory</B>&nbsp;is called by the NIC driver to request the
operating system to allocate memory the NIC driver shares with a busmaster
network interface card during DMA operations. 
<H3>Parameters</H3>
<DL>
<DT>
<I>NdisAdapterHandle</I>
<DD>
Specifies the handle that the NDIS interface library associates with the
network interface card.
<BR>
<DT>
<I>Length</I>
<DD>
Specifies the size, in bytes, of the memory.
<BR>
<DT>
<I>Cached</I>
<DD>
Specifies TRUE if the driver requests cached memory.
<BR>
<DT>
<I>VirtualAddress</I>
<DD>
Points to a caller-supplied memory location at which this function writes the
base virtual address of the allocated memory. If memory of the specified type
is not available, the pointer value is NULL.
<BR>
<DT>
<I>PhysicalAddress</I>
<DD>
Points to a caller-supplied variable in which this function returns the
corresponding physical address for the shared memory.
</DL>
<H3>Comments</H3>
<P>
NIC drivers call this function during initialization. The operating system
allocates the memory as physically contiguous, either cached or noncached.
Because this function writes the physical address of the shared memory, the
NIC driver must not call <B>NdisGetBufferPhysicalMapping</B>.
<P>
If the allocated memory is cached and the cache needs flushing, the NIC driver
must call <B>NdisAllocateBuffer</B>&nbsp;to allocate a buffer descriptor for the
memory. It then calls <B>NdisFlushBuffer</B>&nbsp;to flush the cache.
<P>
Callers of <B>NdisAllocateSharedMemory</B>&nbsp;run at IRQL PASSIVE_LEVEL. 
<H3>See Also</H3>
<P>
<B><A HREF="103ndisx_8.htm">NdisAllocateBuffer</A></B>, <B><A HREF="103ndisx_36.htm">NdisFlushBuffer</A></B>,
<B><A HREF="appdxa_78.htm">NdisFreeSharedMemory</A></B>&nbsp;
<P></FONT>
</BODY>
</HTML>
