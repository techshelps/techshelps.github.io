<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TdiReturnChainedReceives</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_TdiReturnChainedReceives_NR"></A>TdiReturnChainedReceives</H2>
<P>
<B>VOID</B><BR>
&nbsp; &nbsp; <B>TdiReturnChainedReceives(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PVOID</B>&nbsp; <B>*</B><I>TsduDescriptors</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN ULONG</B>&nbsp; <I>NumberOfTsdus</I><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>TdiReturnChainedReceives</B>&nbsp;returns an array of TSDU descriptors for one
or more chained receive indications previously forwarded to a transport&#39;s
client, which returned STATUS_PENDING for each such chained receive
indication. 
<H3>Parameters</H3>
<DL>
<DT>
<I>TsduDescriptors</I>
<DD>
Points to an array of descriptors of type NDIS_PACKET. 
<BR>
<DT>
<I>NumberOfTsdus</I>
<DD>
Specifies the number of elements in the array at <I>TsduDescriptors</I>. 
</DL>
<H3>Comments</H3>
<P>
For faster network throughput, a TDI transport can pass to its clients direct
(but read-only) access to a chain of buffers containing a full received
network packet, subject to the following conditions:
<UL>
<LI>
The transport registered an NDIS ProtocolReceivePacket function with <B>NdisRegisterProtocol</B>,
so it can receive indications that permit direct, read-only access to the
contents of the underlying NIC driver&#39;s receive buffer(s). If the
transport is bound directly to the driver of a physical NIC, rather than to an
NDIS intermediate driver, its ProtocolReceivePacket function is given access
to the NIC&#39;s receive buffer(s). 
<P>
<LI>
The transport is bound to a underlying NIC driver that calls <B>NdisMIndicateReceivePacket</B>
to make receive indications, thereby allowing any bound protocol that supplies
a ProtocolReceivePacket function to hold on to received data in the NIC
driver&#39;s receive buffer(s) until the protocol no longer needs the
indicated packet. Such a receive indication is always a full network packet,
mapped by the buffer descriptors (MDLs) chained to each indicated
NDIS_PACKET-type TSDU descriptor. 
<P>
<LI>
The client has registered its handler for TDI_EVENT_CHAINED_RECEIVE or
TDI_EVENT_RECEIVE_DATAGRAM events with the transport. 
</UL>
<P>
When such a transport&#39;s ProtocolReceivePacket function is called, it can
forward the receive indication to the appropriate ClientEventReceive(Datagram)
function, giving the client the opportunity to process the indicated TSDU
without the overhead of double buffering such a received packet in the
transport. If the ClientEventReceive(Datagram) callback returns
STATUS_PENDING, the client retains exclusive read-only access to the indicated
packet until that client calls <B>TdiReturnChainedReceives</B>&nbsp;with the TSDU
descriptor. Its call to <B>TdiReturnChainedReceives</B>&nbsp;returns the indicated
descriptor and all resources that it describes to the underlying NDIS driver
that originally allocated the packet descriptor. 
<P>
Any packets indicated by the underlying NDIS driver to the transport&#39;s
ProtocolReceive function must be forwarded to such a client&#39;s
ClientEventReceive, ClientEventReceiveExpedited, or ClientEventReceiveDatagram
function. Calls to these client event handlers direct the client to make a
copy of the indicated data as quickly as possible, and
ClientEventReceive(Expedited/Datagram) relinquishes the client&#39;s access to
the buffer(s) containing the indicated data when the event handler returns
control.
<P>
Only kernel-mode clients with registered ClientEventChainedReceive,
ClientEventChainedReceiveExpedited, and/or ClientEventChainedReceiveDatagram
handlers call <B>TdiReturnChainedReceives</B>. 
<P>
Callers of <B>TdiReturnChainedReceives</B>&nbsp;run at IRQL &lt;= DISPATCH_LEVEL. 
<H3>See Also</H3>
<P>
<B><A HREF="25tdicli_2.htm">ClientEventChainedReceive</A></B>, <B><A HREF="25tdicli_3.htm">ClientEventChainedReceiveDatagram</A></B>,
<B><A HREF="25tdicli_4.htm">ClientEventChainedReceiveExpedited</A></B>,
<B><A HREF="25tdicli_7.htm">ClientEventReceive</A></B>, <B><A HREF="25tdicli_8.htm">ClientEventReceiveDatagram</A></B>,
<B><A HREF="25tdicli_9.htm">ClientEventReceiveExpedited</A></B>,
<B><A HREF="103ndisx_107.htm">NdisMIndicateReceivePacket</A></B>,
<B><A HREF="106nstru_4.htm">NDIS_PACKET</A></B>, <B><A HREF="103ndisx_192.htm">NdisReturnPackets</A></B>,
<B><A HREF="104tdlow_5.htm">ProtocolReceive</A></B>, <B><A HREF="104tdlow_7.htm">ProtocolReceivePacket</A></B>
<P></FONT>
</BODY>
</HTML>
