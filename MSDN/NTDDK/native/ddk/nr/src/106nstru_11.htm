<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NDIS_WAN_LINE_UP</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_NDIS_WAN_LINE_UP_NR"></A>NDIS_WAN_LINE_UP</H2>
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_WAN_LINE_UP {
&nbsp; &nbsp; IN ULONG             LinkSpeed;
&nbsp; &nbsp; IN ULONG             MaximumTotalSize;
&nbsp; &nbsp; IN NDIS_WAN_QUALITY  Quality;
&nbsp; &nbsp; IN USHORT            SendWindow;
&nbsp; &nbsp; IN UCHAR             RemoteAddress[6];
&nbsp; &nbsp; IN OUT UCHAR         LocalAddress[6];
&nbsp; &nbsp; IN ULONG             ProtocolBufferLength;
&nbsp; &nbsp; IN PUCHAR            ProtocolBuffer;
&nbsp; &nbsp; IN USHORT            ProtocolType;
&nbsp; &nbsp; IN OUT NDIS_STRING   DeviceName;
} NDIS_WAN_LINE_UP, *PNDIS_WAN_LINE_UP;
</FONT></PRE>
<P>
NDIS_WAN_LINE_UP contains information associated with a line-up indication. 
<H3>Members</H3>
<DL>
<DT>
<B>LinkSpeed</B>
<DD>
Specifies the speed of the link, in units of 100 bps. Zero indicates no change
from the speed returned when the protocol called <B>NdisRequest</B>&nbsp;with
OID_GEN_LINK_SPEED. 
<BR>
<DT>
<B>MaximumTotalSize</B>
<DD>
Specifies the maximum number of bytes per packet that the protocol can send
over the network. Zero indicates no change from the value returned when the
protocol called <B>NdisRequest</B>&nbsp;with OID_GEN_MAXIMUM_TOTAL_SIZE. 
<BR>
<DT>
<B>Quality</B>
<DD>
Specifies the quality of service (QOS) of the new line. 
<BR>
<DT>
<B>SendWindow</B>
<DD>
Specifies the underlying WAN NIC driver’s send window, effectively its limit
on outstanding send packets it will handle for this link. After submitting
this number of packets to MiniportWanSend, NDISWAN will hold incoming sends
queued until the driver completes an outstanding send. 
<BR>
<DT>
<B>RemoteAddress</B>
<DD>
Represents the address of the remote node on the link in Ethernet-style
format. NDISWAN supplies this value. 
<BR>
<DT>
<B>LocalAddress</B>
<DD>
Represents the protocol-determined context for indications on this link in
Ethernet-style format. NDISWAN reserves the two high-order bytes for its own
use; the protocol should set the remainder to whatever should be the input
parameter for this link to its ProtocolReceive and ProtocolStatus functions
thereafter. 
<BR>
<DT>
<B>ProtocolBufferLength</B>
<DD>
Specifies the number of bytes in the buffer at <B>ProtocolBuffer</B>. 
<BR>
<DT>
<B>ProtocolBuffer</B>
<DD>
Points to a buffer, allocated by NDISWAN, containing protocol-specific
information supplied by a higher-level component that makes connections
through NDISWAN to the appropriate protocol(s). For example, this buffer would
contain an IP address if the target protocol is IP or an IPX network number if
the target protocol is IPX. NDISWAN frees this buffer when the target protocol
returns control from the line-up indication. 
<BR>
<DT>
<B>ProtocolType</B>
<DD>
Specifies the assigned ether type of the protocol. 
<BR>
<DT>
<B>DeviceName</B>
<DD>
Specifies the name of the binding as a counted string in the system-default
character set. For Windows NT drivers, this string contains Unicode
characters. This string can be at most 64 characters. 
</DL>
<H3>Comments</H3>
<P>
When a WAN miniport calls <B>NdisMIndicateStatus</B>&nbsp;with a line-up
indication, NDISWAN forwards the indication to interested protocol(s),
formatted in this structure. At the initial line-up indication for a given
link, the protocol should save any necessary state for subsequent
communications on the link, including possible line-up, line-down, and
fragment indications. 
<P>
Subsequently, the protocol can use the <B>SendWindow</B>&nbsp;value as its upper
bound on the number of calls it makes to <B>NdisSend</B>&nbsp;for this link before
the protocol regains ownership of at least one of the packets it sent down to
the underlying WAN NIC driver. Some NICs achieve higher throughput if they
have several packets to send at once. Others could become unreliable if their
drivers are flooded with send packets. NDISWAN also uses the miniport-set <B>SendWindow</B>
value in this manner. 
<P>
NDISWAN uses Ethernet-style address format to communicate with protocols, so
the pair of <I>Xxx</I><B>Address</B>&nbsp;members of this structure are six-byte
addresses, used as follows:
<UL>
<LI>
NDISWAN uses the <B>RemoteAddress</B>&nbsp;to designate a particular link-protocol
context. At the initial line-up indication for a link, the protocol should
save the <B>RemoteAddress</B>&nbsp;supplied by NDISWAN. Subsequently, the protocol
passes the <B>RemoteAddress</B>&nbsp;value to NDISWAN in calls to <B>NdisSend</B>
for transmissions on this link. 
<P>
<LI>
The protocol uses <B>LocalAddress</B>&nbsp;to set up context for itself in the
low-order four bytes (<B>&amp;LocalAddress[2]</B>) when it receives the
initial line-up indication for a link being established. Subsequently, NDISWAN
passes the <B>LocalAddress</B>&nbsp;to the protocol at receive and status
indications. In effect, NDISWAN uses the given <B>LocalAddress</B>&nbsp;as the
destination for incoming receives and status indications on the link
thereafter.  
</UL>
<P>
The <B>DeviceName</B>&nbsp;member is used with stacks in which a lower-level
protocol has a single binding to NDISWAN but several bindings between it and a
higher-level protocol in the stack, and this member might be used to support
future PnP scenarios. That is, <B>DeviceName</B>&nbsp;would be used for either of
the following:
<UL>
<LI>
To identify the binding (IN) to which a lower protocol should propagate the
line-up indication it is given by NDISWAN
<P>
<LI>
In a PnP environment, to report back (OUT) to NDISWAN the name of a newly
created binding set up by a lower protocol at a line-up indication
</UL>
<P>
For more information about the OID_<I>XXX</I>&nbsp;codes passed in calls to <B>NdisRequest</B>,
see <A HREF="105ndoid.htm">Chapter 5</A>. 
<H3>See Also</H3>
<P>
<B><A HREF="101mini_10.htm">MiniportQueryInformation</A></B>, <B><A HREF="101mini_16.htm">MiniportSetInformation</A></B>,
<B><A HREF="106nstru_3.htm">NDIS_MAC_LINE_UP</A></B>, <B><A HREF="103ndisx_108.htm">NdisMIndicateStatus</A></B>,
<B><A HREF="103ndisx_188.htm">NdisRequest</A></B>, <B><A HREF="106nstru_9.htm">NDIS_WAN_FRAGMENT</A></B>,
<B><A HREF="106nstru_10.htm">NDIS_WAN_LINE_DOWN</A></B>, <B><A HREF="104tdlow_11.htm">ProtocolStatus</A></B>
<P></FONT>
</BODY>
</HTML>
