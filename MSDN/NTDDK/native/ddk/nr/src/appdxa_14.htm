<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MacOpenAdapter</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_MacOpenAdapter_NR"></A>MacOpenAdapter</H2>
<P>
<B>NDIS_STATUS<BR>
</B>&nbsp; &nbsp; <B>MacOpenAdapter(<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PNDIS_STATUS</B>&nbsp; <I>OpenErrorStatus</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT NDIS_HANDLE</B>&nbsp; *<I>MacBindingHandle</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PUINT</B>&nbsp; <I>SelectedMediumIndex</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PNDIS_MEDIUM</B>&nbsp; <I>MediumArray</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN UINT</B>&nbsp; <I>MediumArraySize</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN NDIS_HANDLE</B>&nbsp; <I>NdisBindingContext</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN NDIS_HANDLE</B>&nbsp; <I>MacAdapterContext</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN UINT</B>&nbsp; <I>OpenOptions</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PSTRING</B>&nbsp; <I>AddressingInformation</I>&nbsp; <B>OPTIONAL</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
MacOpenAdapter is called when a protocol driver requests a binding to the NIC
with <B>NdisOpenAdapter</B>. 
<H3>Parameters</H3>
<DL>
<DT>
<I>OpenErrorStatus</I>
<DD>
Points to the caller-supplied variable in which MacOpenAdapter returns an
NDIS_STATUS_<I>XXX</I>&nbsp;indicating the reason for a failure to open the NIC if
the open fails. 
<BR>
<DT>
<I>MacBindingHandle</I>
<DD>
Points to the caller-supplied variable in which MacOpenAdapter returns a
handle that the NIC driver associates with the binding. This value is
typically a pointer to a driver-defined structure in resident memory
containing binding-specific information. All future requests that NDIS
forwards from the protocol driver to the NIC driver specify this value if the
request concerns this binding. 
<BR>
<DT>
<I>SelectedMediumIndex</I>
<DD>
Points to the caller-supplied variable in which this function returns the
index of the NIC driver’s medium type, selected from the supplied values at <I>MediumArray</I>.
<BR>
<DT>
<I>MediumArray</I>
<DD>
Points to an array of media types the protocol driver supports. 
<BR>
<DT>
<I>MediumArraySize</I>
<DD>
Specifies the number of elements in <I>MediumArray</I>. 
<BR>
<DT>
<I>NdisBindingContext</I>
<DD>
Specifies the context that NDIS associates with the binding. The NIC driver
uses this handle when it sends an indication to the protocol driver. 
<BR>
<DT>
<I>MacAdapterContext</I>
<DD>
Specifies the context that the NIC driver associates with the NIC. 
<BR>
<DT>
<I>OpenOptions</I>
<DD>
Specifies a bitmask containing flags the protocol driver passes to the NIC
driver. Currently, the bitmask is undefined. 
<BR>
<DT>
<I>AddressingInformation</I>
<DD>
Points to an optional variable-length string containing specific information
the NIC driver can use to program the network interface card. A NIC driver
supporting an asynchronous modem can use this information for dialing. The
addressing information, if specified, remains valid until this function
completes. This parameter can be NULL. 
</DL>
<H3>Return Value</H3>
<P>
MacOpenAdapter can return the following status codes: 
<P>
NDIS_STATUS_ADAPTER_NOT_FOUND<BR>
NDIS_STATUS_FAILURE<BR>
NDIS_STATUS_NOT_ACCEPTED<BR>
NDIS_STATUS_OPEN_FAILED<BR>
NDIS_STATUS_OPEN_LIST_FULL<BR>
NDIS_STATUS_PENDING<BR>
NDIS_STATUS_RESOURCES<BR>
NDIS_STATUS_SUCCESS<BR>
NDIS_STATUS_UNSUPPORTED_MEDIA
<H3>Comments</H3>
<P>
In its call to <B>NdisOpenAdapter</B>, the protocol driver specifies an array
containing the media types that it supports. The NIC driver reads this array
and writes the index of its own media type in <I>SelectedMediumIndex</I>. 
<P>
A NIC driver can imitate a medium type other than the true underlying type of
its NIC, and this imitation is transparent to the protocol driver. If the NIC
driver cannot find a medium type that it and the protocol driver both support,
MacOpenAdapter returns NDIS_STATUS_UNSUPPORTED_MEDIA. 
<P>
When the protocol driver calls <B>NdisOpenAdapter</B>, MacOpenAdapter
activates the NIC if it is not already physically enabled. Subsequently, the
NIC driver does not disable the network interface card until its reference
count for open bindings returns to zero. The maximum number of simultaneous
opens the NIC driver supports can be configured. 
<P>
Before MacOpenAdapter completes the open request, the filter library causes
the NIC driver to reset all multicast and functional addresses for the newly
bound protocol driver. The reset of filter database information has no effect
on other protocol drivers that are also bound to the NIC. 
<P>
MacOpenAdapter completes synchronously if it finishes the open operation
before it returns control with a status code other than NDIS_STATUS_PENDING. 
<P>
If MacOpenAdapter cannot complete the open operation before it returns
control, it returns NDIS_STATUS_PENDING. For example, MacOpenAdapter usually
returns NDIS_STATUS_PENDING at the initial open for its NIC. Then, the NIC
driver eventually calls <B>NdisCompleteOpenAdapter</B>, which, in turn, calls
the ProtocolOpenAdapterComplete function of the driver that initiated the
open. This asynchronous completion allows protocol driver postprocessing of
the NIC open request. 
<P>
Whether MacOpenAdapter completes an open synchronously or asynchronously, it
must set values for <I>MacBindingHandle</I>&nbsp;and <I>SelectedMediumIndex</I>
before it returns control. 
<P>
MacOpenAdapter runs at IRQL DISPATCH_LEVEL. 
<H3>See Also</H3>
<P>
<B><A HREF="appdxa_37.htm">EthNoteFilterOpenAdapter</A></B>, <B><A HREF="appdxa_54.htm">FddiNoteFilterOpenAdapter</A></B>,
<B><A HREF="appdxa_68.htm">NdisCompleteOpenAdapter</A></B>, <B><A HREF="103ndisx_148.htm">NdisOpenAdapter</A></B>,
<B><A HREF="104tdlow_4.htm">ProtocolOpenAdapterComplete</A></B>,
<B><A HREF="appdxa_127.htm">TrNoteFilterOpenAdapter</A></B>&nbsp;
<P></FONT>
</BODY>
</HTML>
