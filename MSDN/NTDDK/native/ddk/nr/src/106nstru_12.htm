<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NDIS_WAN_PACKET</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_NDIS_WAN_PACKET_NR"></A>NDIS_WAN_PACKET</H2>
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_WAN_PACKET {
&nbsp; &nbsp; LIST_ENTRY          WanPacketQueue;
&nbsp; &nbsp; PUCHAR              CurrentBuffer;
&nbsp; &nbsp; ULONG               CurrentLength;
&nbsp; &nbsp; PUCHAR              StartBuffer;
&nbsp; &nbsp; PUCHAR              EndBuffer;
&nbsp; &nbsp; PVOID               ProtocolReserved1;
&nbsp; &nbsp; PVOID               ProtocolReserved2;
&nbsp; &nbsp; PVOID               ProtocolReserved3;
&nbsp; &nbsp; PVOID               ProtocolReserved4;
&nbsp; &nbsp; PVOID               MacReserved1;
&nbsp; &nbsp; PVOID               MacReserved2;
&nbsp; &nbsp; PVOID               MacReserved3;
&nbsp; &nbsp; PVOID               MacReserved4;
} NDIS_WAN_PACKET, *PNDIS_WAN_PACKET;
</FONT></PRE>
<P>
NDIS_WAN_PACKET defines the packet passed to the MiniportWanSend functions of
WAN NIC drivers.
<H3>Members</H3>
<DL>
<DT>
<B>WanPacketQueue</B>
<DD>
Specifies the head of the send packet queue, used by MiniportWanSend while the
miniport is processing this packet.
<BR>
<DT>
<B>CurrentBuffer</B>
<DD>
Specifies the base virtual address within the given buffer at which the net
packet to be transmitted starts.  
<BR>
<DT>
<B>CurrentLength</B>
<DD>
Specifies the number of bytes of network packet data. 
<BR>
<DT>
<B>StartBuffer</B>
<DD>
Specifies the base virtual address for the given buffer, including padding. 
<BR>
<DT>
<B>EndBuffer</B>
<DD>
Specifies the virtual address for the end of the given buffer, including
padding. 
<BR>
<DT>
<B>ProtocolReserved</B><I>X</I>
<DD>
Specifies members reserved for use by protocols. 
<BR>
<DT>
<B>MacReserved</B><I>X</I>
<DD>
Specifies members that the miniport can use for its own purposes. 
</DL>
<H3>Comments</H3>
<P>
When a protocol calls <B>NdisSend</B>&nbsp;with an NDIS_PACKET-type transmit
request for an underlying WAN NIC driver, NDISWAN transforms the given packet
into a packet formatted as this structure before calling the underlying
driver’s MiniportWanSend function. 
<P>
The <B>StartBuffer</B>&nbsp;and <B>EndBuffer</B>&nbsp;pointers specify a discrete
virtual range. <B>CurrentBuffer</B>&nbsp;and <B>CurrentLength</B>&nbsp;specify a proper
subrange of the range specified by <B>StartBuffer</B>&nbsp;and <B>EndBuffer</B>.
Consequently, one of the following formulas yields the number of bytes of
header or tail padding, if any, for the buffer passed in this structure to
MiniportWanSend:
<UL>
<LI>
<I>HeaderPadding</I>&nbsp; =  <B>CurrentBuffer</B>&nbsp;- <B>StartBuffer</B>
<P>
<LI>
<I>TailPadding</I>&nbsp; =  <B>EndBuffer</B>&nbsp;- (<B>CurrentBuffer</B>&nbsp;+ <B>CurrentLength</B>)
</UL>
<P>
NDISWAN always gives the underlying NIC driver at least as much header and
tail padding as the driver returned in response to the OID_WAN_GET_INFO query
during initialization. 
<P>
MiniportWanSend can manipulate the buffer data in any manner. Until it
completes a given send packet, either by returning a status other than
NDIS_STATUS_PENDING from MiniportWanSend or by calling <B>NdisMWanSendComplete</B>,
the NIC driver retains ownership of the given packet and of everything it
specifies except the <B>ProtocolReserved</B><I>X</I>&nbsp;members. 
<P>
For more information about WAN-specific and about all system-defined OIDs, see
<A HREF="105ndoid.htm">Chapter 5</A>. 
<H3>See Also</H3>
<P>
<B><A HREF="101mini_10.htm">MiniportQueryInformation</A></B>, <B><A HREF="101mini_21.htm">MiniportWanSend</A></B>,
<B><A HREF="103ndisx_145.htm">NdisMWanSendComplete</A></B>, <B><A HREF="103ndisx_193.htm">NdisSend</A></B>
<P>
&nbsp;
<P></FONT>
</BODY>
</HTML>
