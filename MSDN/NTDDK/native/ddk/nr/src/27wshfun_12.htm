<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WSHJoinLeaf</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_WSHJoinLeaf_NR"></A>WSHJoinLeaf</H2>
<P>
<B>INT<BR>
&nbsp; &nbsp; WSHJoinLeaf(<BR>
&nbsp; &nbsp; &nbsp; &nbsp; IN PVOID  </B><I>HelperDllSocketContext<B>,</I></B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN SOCKET </B><I>&nbsp;SocketHandle<B>,</I></B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN HANDLE  </B><I>TdiAddressObjectHandle<B>,</I></B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN HANDLE  </B><I>TdiConnectionObjectHandle<B>,</I></B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN PVOID  </B><I>LeafHelperDllSocketContext<B>,</I></B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN SOCKET  </B><I>LeafSocketHandle<B>,</I></B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN PSOCKADDR  </B><I>Sockaddr<B>,</I></B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN DWORD  </B><I>SockaddrLength<B>,</I></B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN LPWSABUF  </B><I>CallerData<B>,</I></B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN LPWSABUF  </B><I>CalleeData<B>,</I></B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN LPQOS  </B><I>SocketQOS<B>,</I></B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN LPQOS  </B><I>GroupQOS<B>,</I></B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN DWORD  </B><I>Flags<BR>
</I><B>&nbsp; &nbsp; &nbsp; &nbsp; );</B>
<P>
<B>WSHJoinLeaf</B>&nbsp;performs any protocol-specific actions that must be taken
to add a socket to a multipoint session as a leaf node.
<H3>Parameters</H3>
<DL>
<DT>
<I>HelperDllSocketContext</I>
<DD>
Points to a per-socket context area, allocated and initialized by the WSH DLL <B>WSHOpenSocket
</B>or <B>WSHOpenSocket2 </B>function.
<BR>
<DT>
<I>SocketHandle</I>
<DD>
Specifies the handle to the socket that was used to establish a multipoint
session.
<BR>
<DT>
<I>TdiAddressObjectHandle</I>
<DD>
Specifies the handle to a file object representing the open transport address
for the socket.<B>&nbsp;</B>
<BR>
<DT>
<I>TdiConnectionObjectHandle</I>
<DD>
Specifies the handle to a file object representing the connection endpoint
associated with the socket. If the socket is not currently connected, this
parameter is NULL.
<BR>
<DT>
<I>LeafHelperDllSocketContext</I>
<DD>
Points to a helper DLL-defined socket context for a newly created socket
(created by <B>WSHOpenSocket2</B>) that is being added as a new leaf node on
the multipoint session.
<BR>
<DT>
<I>LeafSocketHandle</I>
<DD>
Specifies the handle to the newly created socket that is being added to the
multipoint session.
<BR>
<DT>
<I>Sockaddr</I>
<DD>
Points to the value from <B>WSAJoinLeaf </B>for the name of the peer socket
with which the leaf will be merged.
<BR>
<DT>
<I>SockaddrLength</I>
<DD>
Specifies the length in bytes at <I>Sockaddr</I>.
<BR>
<DT>
<I>CallerData</I>
<DD>
Points to a buffer containing data that should be transmitted to the peer
socket when the sockets are joined.
<BR>
<DT>
<I>CalleeData</I>
<DD>
Points to a buffer in which <B>WSAJoinLeaf</B>&nbsp;returns any data transmitted by
the peer socket when the sockets are joined.
<BR>
<DT>
<I>SocketQOS</I>
<DD>
Points to a quality-of-service flow specification for the multipoint session
of the original socket as specified by the given <I>SocketHandle</I>. This
parameter specifies quality of service for each direction of data.
<BR>
<DT>
<I>GroupQOS</I>
<DD>
Points to a quality-of-service flow specification for the socket group. This
specification cannot be used to change the QOS of the socket group, but can be
used to modify the newly joined socket&#39;s QOS as part of that group.
<BR>
<DT>
<I>Flags</I>
<DD>
Specifies whether the socket being created as a new leaf node acts as a
sender, receiver, or both as one of the following:
<DL>
<DT>
JL_SENDER_ONLY
<DD>
The new leaf node will act as a sender of data only.
<BR>
<DT>
JL_RECEIVER_ONLY
<DD>
The new leaf node will act as a receiver of data only
<BR>
<DT>
JL_BOTH
<DD>
The new leaf node will act as both a sender and receiver of data.
</DL>
</DL>
<H3>Return Value</H3>
<P>
<B>WSHJoinLeaf</B>&nbsp;returns zero if the input parameters are valid and the
function successful. Otherwise, it returns a nonzero value (see Comments)
corresponding to a Windows Sockets error code, defined in <I>winsock2.h</I>.
<H3>Comments</H3>
<P>
<B>WSHJoinLeaf</B>&nbsp;is responsible for performing any protocol-specific actions
required to add a new socket to a multipoint session, including verifying
parameters for applicability to the protocol being supported. <B>WSHJoinLeaf</B>
<I>must</I>&nbsp;verify all parameters because no parameter checking is done
between the call to <B>WSAJoinLeaf</B>&nbsp;and <B>WSHJoinLeaf</B>.
<P>
When the multipoint session is established, the helper DLL should transmit any
data specified at <I>CallerData </I>to the peer-level socket when the
connection is made. Any data returned by the peer socket should be copied into
the buffer at <I>CalleeData</I>. If the protocol does not support the
transmission of caller-supplied data and <I>CallerData</I>&nbsp;is nonNULL, the
helper DLL should return WSAEPROTONOSUPPORT.
<P>
If the buffer sizes for <I>CalleeData, SocketQOS, </I>or <I>GroupQOS</I>&nbsp;are
too small, then the error WSAEFAULT should be returned.
<P>
If a quality-of-service specification is provided at <I>SocketQOS </I>or <I>GroupQOS</I>
but quality of service is not supported by the protocol, WSAEOPNOTSUPP should
be returned. This error should also be returned if the given quality of
service specification(s) cannot be met.
<P>
If an attempt to allocate memory to complete the join request fails, <B>WSHJoinLeaf</B>
should return WSAENOBUFS to indicate that a low memory condition exists.
<H3>See Also</H3>
<P>
<B><A HREF="27wshfun_15.htm">WSHOpenSocket2</A></B>&nbsp;
<P></FONT>
</BODY>
</HTML>
