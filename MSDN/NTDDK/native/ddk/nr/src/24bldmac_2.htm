<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TdiBuildAction</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_TdiBuildAction_NR"></A>TdiBuildAction</H2>
<P>
<B>VOID <BR>
&nbsp; &nbsp; TdiBuildAction (<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PIRP</B>&nbsp; <I>Irp</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PDEVICE_OBJECT</B>&nbsp; <I>DevObj</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PFILE_OBJECT</B>&nbsp; <I>FileObj</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PVOID</B>&nbsp; <I>CompRoutine</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PVOID</B>&nbsp; <I>Contxt</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PMDL</B>&nbsp; <I>MdlAddr<BR>
</I>&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>TdiBuildAction</B>&nbsp;sets up an internal device control IRP for a TDI_ACTION
request to the underlying transport in which a local-node client has already
opened an address, connection endpoint, or control channel to which the
requested action applies. 
<H3>Parameters</H3>
<DL>
<DT>
<I>Irp</I>
<DD>
Points to a client-supplied IRP, either originating in a higher level network
component or allocated with <B>TdiBuildInternalDeviceControlIrp</B>. 
<BR>
<DT>
<I>DevObj</I>
<DD>
Points to the device object created by the next lower TDI transport driver.
<BR>
<DT>
<I>FileObj</I>
<DD>
Points to a file object representing an address, connection endpoint, or
control channel.
<BR>
<DT>
<I>CompRoutine</I>
<DD>
Specifies the entry point of a client-supplied IoCompletion routine or NULL.
The I/O Manager calls this routine when the given IRP is completed, unless the
client sets this parameter to NULL. 
<BR>
<DT>
<I>Contxt</I>
<DD>
Points to a client-determined context. This client-supplied pointer is passed
in to the IoCompletion routine when it is called with the completed IRP. <I>Contxt</I>
should be NULL if <I>CompRoutine</I>&nbsp;is NULL.
<BR>
<DT>
<I>MdlAddr</I>
<DD>
Points to an MDL, possibly the head of an MDL chain, mapping a client-supplied
buffer containing the action parameter block set up by the client. This buffer
contains a system-defined header, followed by whatever transport-determined
information is necessary to carry out the action request.  
</DL>
<H3>Comments</H3>
<P>
<B>TdiBuildAction </B>sets IRP_MJ_INTERNAL_DEVICE_CONTROL as the <B>MajorFunction</B>
and TDI_ACTION as the <B>MinorFunction</B>&nbsp;codes in the transport&#39;s I/O
stack location of the given IRP.
<P>
A client can make an action request for transport-provided extensions
pertaining to an address, a connection, or a control channel. The client
supplies a buffer containing all transport-required information concerning
such a request in an action parameter block. 
<P>
Every action parameter block begins with a system-defined TDI_ACTION_HEADER
structure containing a transport identifier and an action code. On receipt of
such a request, the transport uses the value of <B>TransportId</B>&nbsp;in this
header to validate the request. The <B>ActionCode</B>&nbsp;member specifies the
transport-defined operation to carry out and determines the transport-required
contents for the remainder of the parameter block. The underlying transport
defines the set of possible action codes and the required formats of the
remaining parameter block for each such action. 
<P>
The successful completion of any client&#39;s action request makes the
transport-provided extension applicable to that client but not to any other
TDI clients or drivers.
<H3>See Also</H3>
<P>
<B><A HREF="22ioctl_2.htm">TDI_ACTION</A></B>, <B><A HREF="26tdstrc_8.htm">TDI_ACTION_HEADER</A></B>,
<B><A HREF="24bldmac_7.htm">TdiBuildInternalDeviceControlIrp</A></B>
<P></FONT>
</BODY>
</HTML>
