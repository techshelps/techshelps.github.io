<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NdisReadMcaPosInformation</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_NdisReadMcaPosInformation_NR"></A>NdisReadMcaPosInformation</H2>
<P>
<B>VOID<BR>
&nbsp; &nbsp; NdisReadMcaPosInformation(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PNDIS_STATUS</B>&nbsp;<I>Status</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN NDIS_HANDLE</B>&nbsp;<I>WrapperConfigurationContext</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PUINT</B>&nbsp;<I>ChannelNumber</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PNDIS_MCA_POS_DATA</B>&nbsp;<I>McaData</I><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>NdisReadMcaPosInformation</B>&nbsp;returns bus-relative configuration
information for a NIC on an MCA bus.
<H3>Parameters</H3>
<DL>
<DT>
<I>Status</I>
<DD>
Points to a caller-supplied variable in which this function returns the status
of the call as one of the following:
<DL>
<DT>
NDIS_STATUS_SUCCESS
<DD>
The NIC driver can examine the buffered configuration data to determine
whether a NIC that it supports has been found and, if so, can use the
bus-relative configuration values as parameters to certain <B>Ndis</B><I>Xxx</I>
initialization functions.
<BR>
<DT>
NDIS_STATUS_ADAPTER_NOT_FOUND
<DD>
A NIC could not be found on an MCA bus in the machine. 
<BR>
<DT>
NDIS_STATUS_RESOURCES
<DD>
NDIS could not allocate a buffer to contain the requested MCA configuration
information or could not allocate the resources it needs to collect the
configuration information. 
<BR>
<DT>
NDIS_STATUS_FAILURE
<DD>
This is a default status, returned if the caller supplied an invalid parameter
or if POS information is unavailable. For example, if the caller sets the <I>AdapterType</I>
to something other than <B>NdisInterfaceMca</B>&nbsp;when the miniport calls <B>NdisMSetAttributes</B>,
<B>NdisReadMcaPosInformation</B>&nbsp;returns this status. 
</DL>
<DT>
<I>WrapperConfigurationContext</I>
<DD>
Specifies the handle input to MiniportInitialize. 
<BR>
<DT>
<I>ChannelNumber</I>
<DD>
Points to a caller-supplied variable in which this function returns the
channel number of a NIC on the bus.
<BR>
<DT>
<I>McaData</I>
<DD>
Points to a caller-supplied buffer in which this function returns the
requested information, formatted as an NDIS_MCA_POS_DATA structure, if the
call is successful. 
</DL>
<H3>Comments</H3>
<P>
<B>NdisReadMcaPosInformation</B>&nbsp;reads data from the POS register of an MCA
NIC. The function copies this information into a buffer that the NIC driver
provides.
<P>
The NDIS_MCA_POS_DATA structure is defined as follows: 
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_MCA_POS_DATA {
&nbsp; &nbsp; USHORT AdapterId; //NIC&#39;s ID
&nbsp; &nbsp; UCHAR PosData1;   // First byte of POS data
&nbsp; &nbsp; UCHAR PosData2;   
&nbsp; &nbsp; UCHAR PosData3;   
&nbsp; &nbsp; UCHAR PosData4;   
} NDIS_MCA_POS_DATA, *PNDIS_MCA_POS_DATA;
&nbsp;</FONT></PRE>
<P>
A NIC driver can use the returned <B>AdapterId</B>&nbsp;value to determine whether
the NIC is its own. If so, the driver can call <B>NdisMRegisterInterrupt</B>
to register its MiniportISR function. The driver also might use the returned
value at <I>ChannelNumber</I>, for example, in a subsequent call to <B>NdisMRegisterDmaChannel</B>
if its NIC is a slave DMA device. 
<P>
The caller is responsible for freeing the buffer it allocated at <I>McaData </I>with
<B>NdisFreeMemory</B>. 
<P>
Callers of <B>NdisReadMcaPosInformation</B>&nbsp;run at IRQL PASSIVE_LEVEL. 
<H3>See Also</H3>
<P>
<B><A HREF="101mini_8.htm">MiniportInitialize</A></B>, <B><A HREF="101mini_9.htm">MiniportISR</A></B>,
<B><A HREF="103ndisx_39.htm">NdisFreeMemory</A></B>, <B><A HREF="103ndisx_122.htm">NdisMRegisterDmaChannel</A></B>,
<B><A HREF="103ndisx_123.htm">NdisMRegisterInterrupt</A></B>, <B><A HREF="103ndisx_129.htm">NdisMSetAttributes</A></B>,
<B><A HREF="103ndisx_130.htm">NdisMSetAttributesEx</A></B>&nbsp;
<P></FONT>
</BODY>
</HTML>
