<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TdiCopyBufferToMdl</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_TdiCopyBufferToMdl_NR"></A>TdiCopyBufferToMdl</H2>
<P>
<B>NTSTATUS <BR>
&nbsp; &nbsp; TdiCopyBufferToMdl (<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PVOID</B>&nbsp; <I>SourceBuffer</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN ULONG</B>&nbsp; <I>SourceOffset</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN ULONG</B>&nbsp; <I>SourceBytesToCopy</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PMDL</B>&nbsp; <I>DestinationMdlChain</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN ULONG</B>&nbsp; <I>DestinationOffset</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PULONG</B>&nbsp; <I>BytesCopied<BR>
</I>&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>TdiCopyBufferToMdl</B>&nbsp;copies data from a buffer range into a set of one or
more destination buffers mapped by a given MDL chain.
<H3>Parameters</H3>
<DL>
<DT>
<I>SourceBuffer</I>
<DD>
Specifies the base virtual address of the source buffer containing the data to
be copied.
<BR>
<DT>
<I>SourceOffset</I>
<DD>
Specifies the byte offset within the source buffer at which to begin the copy.
<BR>
<DT>
<I>SourceBytesToCopy</I>
<DD>
Specifies the number of bytes to copy from <I>SourceBuffer</I>&nbsp;to the buffer
mapped by the given MDL.
<BR>
<DT>
<I>DestinationMdlChain</I>
<DD>
Points to the initial MDL in a chain of linked MDLs mapping the destination
buffers into which to copy the data.
<BR>
<DT>
<I>DestinationOffset</I>
<DD>
Specifies the byte offset within the destination buffer(s) at which to begin
the copy. Effectively, this is the number of bytes mapped by the given MDLs to
skip before beginning the copy operation. 
<BR>
<DT>
<I>BytesCopied</I>
<DD>
Points to a caller-supplied variable in which <B>TdiCopyBufferToMdl</B>
returns the number of bytes copied from the source to the destination buffer.
</DL>
<H3>Return Value</H3>
<P>
<B>TdiCopyBufferToMdl</B>&nbsp;returns STATUS_SUCCESS if it copied <I>SourceBytesToCopy</I>
into the mapped destination buffer(s). Otherwise, it returns
STATUS_BUFFER_OVERFLOW if <I>SourceBytesToCopy</I>&nbsp;was too large to fit into
the destination buffer space available from the given <I>DestinationOffset</I>.
<H3>Comments</H3>
<P>
<B>TdiCopyBufferToMdl</B>&nbsp;always copies as much data as possible from the
source buffer to the destination buffer(s), even if it returns
STATUS_BUFFER_OVERFLOW. At most, the return value of <I>BytesCopied</I>&nbsp;is
equal to the given <I>SourceBytesToCopy</I>. 
<P>
Both transports and their kernel-mode clients can call <B>TdiCopyBufferToMdl</B>.
<P>
Callers of <B>TdiCopyBufferToMdl</B>&nbsp;can be running at IRQL &lt;=
DISPATCH_LEVEL if the source and destination buffers are resident. If either
is pageable, the caller must be running at IRQL &lt; DISPATCH_LEVEL. 
<H3>See Also</H3>
<P>
<B><A HREF="23tdifun_3.htm">TdiCopyLookaheadData</A></B>, <B><A HREF="23tdifun_4.htm">TdiCopyMdlToBuffer</A></B>
<P></FONT>
</BODY>
</HTML>
