<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NdisMSetTimer</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_NdisMSetTimer_NR"></A>NdisMSetTimer</H2>
<P>
<B>VOID <BR>
&nbsp; &nbsp; NdisMSetTimer(<BR>
&nbsp; &nbsp; &nbsp; &nbsp; IN PNDIS_MINIPORT_TIMER</B>&nbsp;<I>Timer</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN UINT</B>&nbsp;<I>MillisecondsToDelay<BR>
</I>&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>NdisMSetTimer</B>&nbsp;sets a timer to fire after a specified interval, thereby
running an associated MiniportTimer function when the timer fires.
<H3>Parameters</H3>
<DL>
<DT>
<I>Timer</I>
<DD>
Points to caller-supplied resident storage for a timer object previously
initialized with <B>NdisMInitializeTimer</B>.
<BR>
<DT>
<I>MillisecondsToDelay</I>
<DD>
Specifies the interval, in milliseconds, to time out before calling the
MiniportTimer function. 
</DL>
<H3>Comments</H3>
<P>
<B>NdisMSetTimer</B>&nbsp;causes the driver-supplied MiniportTimer function, which
was associated with the timer object when MiniportInitialize called <B>NdisMInitializeTimer</B>,
to run once after the given <I>MillisecondsToDelay</I>&nbsp;expires. Execution of
the MiniportTimer function associated with the <I>Timer</I>&nbsp;passed to <B>NdisMSetTimer</B>
is episodic, rather than periodic. A miniport must call <B>NdisMSetTimer</B>
each time the associated timer function should be run. 
<P>
By contrast, <B>NdisMSetPeriodicTimer</B>&nbsp;causes the associated MiniportTimer
function to be run repeatedly whenever the given <I>MillisecondsPeriod</I>
expires. At the initial call to <B>NdisMSetPeriodicTimer</B>, the timer object
is queued until the <I>MillisecondsPeriod</I>&nbsp;expires, when the MiniportTimer
function is run and the timer object is automatically requeued for the next
interval. 
<P>
As a general rule, a miniport should allocate and initialize two timer objects
if it calls both <B>NdisMSetPeriodicTimer</B>&nbsp;and <B>NdisMSetTimer</B>. Such a
driver is likely to have two MiniportTimer functions with different
functionality, each associated with a particular timer object when it is
initialized with <B>NdisMInitializeTimer</B>. For example, a MiniportTimer
function that runs periodically might poll device state at regular intervals,
while another MiniportTimer function might retry a particular runtime
operation only if it times out on the NIC. 
<P>
If a miniport calls <B>NdisMSetTimer</B>, <B>NdisMCancelTimer</B>, or <B>NdisMSetPeriodicTimer</B>
with the same <I>Timer</I>&nbsp;pointer originally passed to <B>NdisMSetTimer</B>
before the originally specified <I>MillisecondsToDelay</I>&nbsp;has expired, the
current call cancels its preceding call to <B>NdisMSetTimer</B>. Any call to <B>NdisMSet..Timer</B>
resets the given timer to expire at the interval specified in the most recent
call and causes the associated MiniportTimer function to run when the most
recently specified interval has expired. 
<P>
Timer resolution on the host varies. Consequently, calling <B>NdisMSetTimer</B>
with very small time-out values does not necessarily cause the execution of
the MiniportTimer function exactly when the specified interval expires. The
minimum practicable interval to specify on Windows NT platforms is ten
milliseconds. 
<P>
Callers of <B>NdisMSetTimer</B>&nbsp;run at IRQL &lt;= DISPATCH_LEVEL. 
<H3>See Also</H3>
<P>
<B><A HREF="101mini_8.htm">MiniportInitialize</A></B>, <B><A HREF="101mini_19.htm">MiniportTimer</A></B>,
<B><A HREF="103ndisx_91.htm">NdisMCancelTimer</A></B>,<B>&nbsp;<A HREF="103ndisx_110.htm">NdisMInitializeTimer</A></B>,
<B><A HREF="103ndisx_132.htm">NdisMSetPeriodicTimer</A></B>&nbsp;
<P></FONT>
</BODY>
</HTML>
