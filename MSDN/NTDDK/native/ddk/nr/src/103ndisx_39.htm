<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NdisFreeMemory</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_NdisFreeMemory_NR"></A>NdisFreeMemory</H2>
<P>
<B>VOID<BR>
&nbsp; &nbsp; NdisFreeMemory(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PVOID</B>&nbsp; <I>VirtualAddress</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN UINT</B>&nbsp; <I>Length</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN UINT</B>&nbsp; <I>MemoryFlags</I><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>NdisFreeMemory</B>&nbsp;releases a block of memory previously allocated with <B>NdisAllocateMemory</B>.
<H3>Parameters</H3>
<DL>
<DT>
<I>VirtualAddress</I>
<DD>
Points to the base virtual address of the allocated memory. This address was
returned by <B>NdisAllocateMemory</B>. 
<BR>
<DT>
<I>Length</I>
<DD>
Specifies the size in bytes of the memory block to be released. This parameter
must be identical to the <I>Length</I>&nbsp;that was passed to <B>NdisAllocateMemory</B>.
<BR>
<DT>
<I>MemoryFlags</I>
<DD>
Specifies zero or the bitmask originally passed to <B>NdisAllocateMemory</B>
for the preceding range, designating the following: 
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Value</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Meaning</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
zero
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Nonpaged system-space memory
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
NDIS_MEMORY_CONTIGUOUS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Physically contiguous memory
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
NDIS_MEMORY_NONCACHED
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Noncached memory
</FONT></TABLE>
<P>
This value must be identical to the <I>MemoryFlags</I>&nbsp;that was passed to <B>NdisAllocateMemory</B>.
</DL>
<H3>Comments</H3>
<P>
The parameters passed to <B>NdisFreeMemory</B>&nbsp;must be identical to those
passed to <B>NdisAllocateMemory</B>&nbsp;when the block of memory was allocated.
That is, a caller of <B>NdisFreeMemory</B>&nbsp;cannot release a subrange of the
block that was allocated. 
<P>
Because noncached memory and contiguous memory are seldom released until the
allocating NIC driver is unloading, callers of <B>NdisFreeMemory</B>&nbsp;usually
are running at IRQL PASSIVE_LEVEL for these types of deallocations. 
<P>
Callers of <B>NdisFreeMemory</B>&nbsp;can run at IRQL &lt;= DISPATCH_LEVEL when
releasing memory that was allocated from nonpaged system space or that was
allocated as noncached memory. Callers must be running at IRQL PASSIVE_LEVEL
to release contiguous allocations. 
<H3>See Also</H3>
<P>
<B><A HREF="101mini_6.htm">MiniportHalt</A></B>, <B><A HREF="103ndisx_10.htm">NdisAllocateMemory</A></B>
<P></FONT>
</BODY>
</HTML>
