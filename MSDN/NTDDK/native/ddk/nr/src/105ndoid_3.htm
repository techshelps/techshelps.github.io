<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>5.3  Token Ring Objects</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_Token_Ring_Objects_NR"></A>5.3  Token Ring Objects</H2>
<P>
This describes the OIDs for Token Ring objects, both operational and
statistical types.
<H3>Token Ring Operational Characteristics</H3>
<P>
The following chart summarizes the OIDs used to get or set Token Ring
operational characteristics for NDIS drivers and NICs.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Length</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Q</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>S</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Name</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
6
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_PERMANENT_ADDRESS_NR">OID_802_5_PERMANENT_ADDRESS</A>&nbsp; <BR>
Permanent station address
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
6
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_CURRENT_ADDRESS_NR">OID_802_5_CURRENT_ADDRESS</A>&nbsp; <BR>
Current station address
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
4
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_CURRENT_FUNCTIONAL_NR">OID_802_5_CURRENT_FUNCTIONAL</A>&nbsp; <BR>
Current functional address
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
4
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_CURRENT_GROUP_NR">OID_802_5_CURRENT_GROUP</A>&nbsp; <BR>
Current group address
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
4
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_LAST_OPEN_STATUS_NR">OID_802_5_LAST_OPEN_STATUS</A>&nbsp; <BR>
Last open status
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
4
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_CURRENT_RING_STATUS_NR">OID_802_5_CURRENT_RING_STATUS</A>&nbsp; <BR>
Current ring status
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
4
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_CURRENT_RING_STATE_NR">OID_802_5_CURRENT_RING_STATE</A>&nbsp; <BR>
Current ring state
</FONT></TABLE>
<P>
The following describes each of the OID_<I>XXX</I>&nbsp;listed in the preceding
chart more fully. 
<H4><A NAME="DDK_OID_802_5_PERMANENT_ADDRESS_NR"></A>OID_802_5_PERMANENT_ADDRESS</H4>
<P>
The address of the NIC encoded in the hardware.
<H4><A NAME="DDK_OID_802_5_CURRENT_ADDRESS_NR"></A>OID_802_5_CURRENT_ADDRESS</H4>
<P>
The address the NIC is currently using.
<P>
The network management software cannot set the current station address using
the NDIS library. It must set the address as a configuration parameter.
<H4><A NAME="DDK_OID_802_5_CURRENT_FUNCTIONAL_NR"></A>OID_802_5_CURRENT_FUNCTIONAL</H4>
<P>
The functional address enabled on the NIC for packet reception.
<P>
When the underlying driver initializes its NIC, it resets the functional
address to zero. NDIS also initializes the packet filter so that a protocol
does not receive functional address packets. 
<P>
To receive a functional address packet, a bound protocol must later set the
packet filter to include the NDIS_PACKET_TYPE_FUNCTIONAL flag. At any time, it
can disable packet reception by canceling this flag. The order in which the
protocol enables reception for functional address packets is unimportant.
<H4><A NAME="DDK_OID_802_5_CURRENT_GROUP_NR"></A>OID_802_5_CURRENT_GROUP</H4>
<P>
The group address enabled on the NIC for packet reception.
<H4><A NAME="DDK_OID_802_5_LAST_OPEN_STATUS_NR"></A>OID_802_5_LAST_OPEN_STATUS</H4>
<P>
The last open error status returned for a protocol’s call to <B><A HREF="103ndisx_148.htm">NdisOpenAdapter</A></B>.
<P>
If the open succeeded, a status code other than NDIS_STATUS_OPEN_FAILED was
returned for the most recent open of the target NIC, so the value returned for
this query should be zero.
<H4><A NAME="DDK_OID_802_5_CURRENT_RING_STATUS_NR"></A>OID_802_5_CURRENT_RING_STATUS</H4>
<P>
The last ring status indicated with an NDIS_RING_<I>XXX</I>&nbsp;status code, which can be any of the following values:<BR>
NDIS_RING_SIGNAL_LOSS<BR>
NDIS_RING_HARD_ERROR<BR>
NDIS_RING_SOFT_ERROR<BR>
NDIS_RING_TRANSMIT_BEACON<BR>
NDIS_RING_LOBE_WIRE_FAULT<BR>
NDIS_RING_AUTO_REMOVAL_ERROR<BR>
NDIS_RING_REMOVE_RECEIVED<BR>
NDIS_RING_COUNTER_OVERFLOW<BR>
NDIS_RING_SINGLE_STATION<BR>
NDIS_RING_RING_RECOVERY
<H4><A NAME="DDK_OID_802_5_CURRENT_RING_STATE_NR"></A>OID_802_5_CURRENT_RING_STATE</H4>
<P>
The state of the NIC driver with respect to entering the ring, as one of the
following:
<DL>
<DT>
<B>NdisRingStateOpened</B>
<DD>
Specifies an open ring.
<BR>
<DT>
<B>NdisRingStateClosed</B>
<DD>
Specifies a closed ring.
<BR>
<DT>
<B>NdisRingStateOpening</B>
<DD>
Specifies a ring that is opening.
<BR>
<DT>
<B>NdisRingStateClosing</B>
<DD>
Specifies a ring that is closing.
<BR>
<DT>
<B>NdisRingStateOpenFailure</B>
<DD>
Specifies a failure of a ring open operation.
<BR>
<DT>
<B>NdisRingStateRingFailure</B>
<DD>
Specifies a failure of the ring.
</DL>
<H3>Token Ring Statistics</H3>
<P>
The following chart summarizes the OIDs used to get Token Ring statistics for
NICs.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Length</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Q</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>S</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Name</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
4
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_LINE_ERRORS_NR">OID_802_5_LINE_ERRORS</A>&nbsp; <BR>
FCS or code violations detected in repeated frame
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
4
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
M
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_LOST_FRAMES_NR">OID_802_5_LOST_FRAMES</A>&nbsp; <BR>
Frames transmitted that have failed to return
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
4
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_BURST_ERRORS_NR">OID_802_5_BURST_ERRORS</A>&nbsp; <BR>
Number of five half-bit transition absences detected
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
4
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_AC_ERRORS_NR">OID_802_5_AC_ERRORS</A>&nbsp; <BR>
Access control (A/C) errors
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
4
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_ABORT_DELIMITERS_NR">OID_802_5_ABORT_DELIMITERS</A>&nbsp; <BR>
Frames transmitted with abort delimiter
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
4
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_FRAME_COPIED_ERRORS_NR">OID_802_5_FRAME_COPIED_ERRORS</A>&nbsp; <BR>
Frame copy errors
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
4
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_FREQUENCY_ERRORS_NR">OID_802_5_FREQUENCY_ERRORS</A>&nbsp; <BR>
Frequency errors detected
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
4
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_TOKEN_ERRORS_NR">OID_802_5_TOKEN_ERRORS</A>&nbsp; <BR>
Active monitor regenerations
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
4
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
O
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<A HREF="#DDK_OID_802_5_INTERNAL_ERRORS_NR">OID_802_5_INTERNAL_ERRORS</A>&nbsp; <BR>
Internal errors detected
</FONT></TABLE>
<P>
The following describes each of the OID_<I>XXX</I>&nbsp;listed in the preceding
chart more fully. 
<H4><A NAME="DDK_OID_802_5_LINE_ERRORS_NR"></A>OID_802_5_LINE_ERRORS</H4>
<P>
The number of frames with an invalid FCS or a code violation.
<H4><A NAME="DDK_OID_802_5_LOST_FRAMES_NR"></A>OID_802_5_LOST_FRAMES</H4>
<P>
The number of frames transmitted that have not circled the ring within the
maximum ring latency.
<H4><A NAME="DDK_OID_802_5_BURST_ERRORS_NR"></A>OID_802_5_BURST_ERRORS</H4>
<P>
The number of frames containing five half bits with no transition.
<H4><A NAME="DDK_OID_802_5_AC_ERRORS_NR"></A>OID_802_5_AC_ERRORS</H4>
<P>
The number of frames with A/C errors.
<H4><A NAME="DDK_OID_802_5_ABORT_DELIMITERS_NR"></A>OID_802_5_ABORT_DELIMITERS</H4>
<P>
The number of abort delimiters transmitted.
<H4><A NAME="DDK_OID_802_5_FRAME_COPIED_ERRORS_NR"></A>OID_802_5_FRAME_COPIED_ERRORS</H4>
<P>
The number of frames addressed to this NIC that another NIC on the ring has
also copied.
<H4><A NAME="DDK_OID_802_5_FREQUENCY_ERRORS_NR"></A>OID_802_5_FREQUENCY_ERRORS</H4>
<P>
The number of frequency errors on the ring.
<H4><A NAME="DDK_OID_802_5_TOKEN_ERRORS_NR"></A>OID_802_5_TOKEN_ERRORS</H4>
<P>
The number of times the NIC has been the active monitor and has had to
recreate.
<H4><A NAME="DDK_OID_802_5_INTERNAL_ERRORS_NR"></A>OID_802_5_INTERNAL_ERRORS</H4>
<P>
The number of internal errors the NIC has detected.
<P></FONT>
</BODY>
</HTML>
