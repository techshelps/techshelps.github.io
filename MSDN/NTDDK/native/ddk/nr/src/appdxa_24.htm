<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MacUnload</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_MacUnload_NR"></A>MacUnload</H2>
<P>
<B>VOID<BR>
</B>&nbsp; &nbsp; <B>MacUnload(<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN NDIS_HANDLE</B>&nbsp; <I>MacMacContext</I><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
MacUnload is called by NDIS to remove the NIC driver. 
<H3>Parameters</H3>
<DL>
<DT>
<I>MacMacContext</I>
<DD>
Specifies the context that the NIC driver associates with itself. 
</DL>
<H3>Comments</H3>
<P>
Before calling MacUnload, NDIS calls the NIC driver’s MacRemoveAdapter
function to deregister all the driver’s NICs that were registered. 
<P>
The unload process for a NIC driver is OS-dependent. Windows NT NIC drivers
must have a MacUnload function. Windows NT protocol drivers also have an
Unload routine, which they set in the driver object during initialization. 
<P>
MacUnload first frees any resources that were allocated for the driver itself.
It decrements the reference count in the NIC driver block to zero. MacUnload
then calls <B>NdisDeregisterMac</B>&nbsp;to release the resources NDIS allocated
when the driver originally called <B>NdisRegisterMac</B>. The call to <B>NdisDeregisterMac</B>
renders the <I>MacMacContext</I>&nbsp;handle invalid. 
<P>
After NDIS informs bound protocols of the NIC driver’s termination, all bound
protocol drivers call <B>NdisDeregisterProtocol</B>&nbsp;to release the resources
that NDIS allocated when they registered themselves. 
<P>
The last driver being unloaded when the network is shutting down should make a
final call to <B>NdisTerminateWrapper</B>&nbsp;to close the NDIS interface library.
<P>
If the operating system does not support unloading drivers, MacUnload simply
returns control and NDIS unloads the NIC driver. 
<P>
MacUnload runs at IRQL PASSIVE_LEVEL. 
<H3>See Also</H3>
<P>
<B><A HREF="appdxa_16.htm">MacRemoveAdapter</A></B>, <B><A HREF="appdxa_76.htm">NdisDeregisterMac</A></B>,
<B><A HREF="103ndisx_27.htm">NdisDeregisterProtocol</A></B>, <B><A HREF="103ndisx_209.htm">NdisTerminateWrapper</A></B>
<P></FONT>
</BODY>
</HTML>
