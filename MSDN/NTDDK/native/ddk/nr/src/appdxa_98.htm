<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NdisRegisterMac</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_NdisRegisterMac_NR"></A>NdisRegisterMac</H2>
<P>
<B>VOID<BR>
</B>&nbsp; &nbsp; <B>NdisRegisterMac(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PNDIS_STATUS</B>&nbsp;<I>Status</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PNDIS_HANDLE</B>&nbsp;<I>NdisMacHandle</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN NDIS_HANDLE</B>&nbsp;<I>NdisWrapperHandle</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN NDIS_HANDLE</B>&nbsp;<I>MacMacContext</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PNDIS_MAC_CHARACTERISTICS</B>&nbsp;<I>MacCharacteristics</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN UINT</B>&nbsp;<I>CharacteristicsLength</I><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>NdisRegisterMac</B>&nbsp;is called by the NIC driver immediately after it calls <B>NdisInitializeWrapper</B>.
<H3>Parameters</H3>
<DL>
<DT>
<I>Status</I>
<DD>
Points to the caller-supplied variable in which this function writes the
status of the registration. Possible values are:
<P>
NDIS_STATUS_BAD_CHARACTERISTICS<BR>
NDIS_STATUS_BAD_VERSION<BR>
NDIS_STATUS_FAILURE<BR>
NDIS_STATUS_NOT_ACCEPTED<BR>
NDIS_STATUS_RESOURCES<BR>
NDIS_STATUS_SUCCESS
<BR>
<DT>
<I>NdisMacHandle</I>
<DD>
Points to the caller-supplied variable in which this function writes the
handle that the NDIS interface library associates with the NIC driver. This
value is a required parameter to several <B>Ndis</B><I>Xxx</I>&nbsp;functions. 
<BR>
<DT>
<I>NdisWrapperHandle</I>
<DD>
Specifies the handle associated with the NDIS interface library.
<BR>
<DT>
<I>MacMacContext</I>
<DD>
Specifies the context that the NIC driver associates with itself. This value
is typically a pointer to storage that the NIC driver maintains and describes.
The NDIS interface library records the context and passes it to the caller’s
MacAddAdapter and MacUnload functions.
<BR>
<DT>
<I>MacCharacteristics</I>
<DD>
Points to an NDIS_MAC_CHARACTERISTICS structure, defined as follows:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _NDIS_MAC_CHARACTERISTICS {
&nbsp; &nbsp; UCHAR MajorNdisVersion;
&nbsp; &nbsp; UCHAR MinorNdisVersion;
&nbsp; &nbsp; UINT Reserved;
&nbsp; &nbsp; OPEN_ADAPTER_HANDLER OpenAdapterHandler;
&nbsp; &nbsp; CLOSE_ADAPTER_HANDLER CloseAdapterHandler;
&nbsp; &nbsp; SEND_HANDLER SendHandler;
&nbsp; &nbsp; TRANSFER_DATA_HANDLER TransferDataHandler;
&nbsp; &nbsp; RESET_HANDLER ResetHandler;
&nbsp; &nbsp; REQUEST_HANDLER RequestHandler;
&nbsp; &nbsp; QUERY_GLOBAL_STATISTICS_HANDLER<BR>                      QueryGlobalStatisticsHandler;
&nbsp; &nbsp; UNLOAD_MAC_HANDLER UnloadMacHandler;
&nbsp; &nbsp; ADD_ADAPTER_HANDLER AddAdapterHandler;
&nbsp; &nbsp; REMOVE_ADAPTER_HANDLER RemoveAdapterHandler;
&nbsp; &nbsp; NDIS_STRING Name;
} NDIS_MAC_CHARACTERISTICS, *PNDIS_MAC_CHARACTERISTICS;
</FONT></PRE>
<P>
This structure’s members provide the following information: 
<DL>
<DT>
<B>MajorNdisVersion</B>
<DD>
Specifies the major NDIS version. This value should be set to 0x03. 
<BR>
<DT>
<B>MinorNdisVersion</B>
<DD>
Specifies the minor NDIS version. This value should be set to NDIS 3.0. 
<BR>
<DT>
<B>Reserved</B>
<DD>
This member is reserved for system use. 
<BR>
<DT>
<B>OpenAdapterHandler</B>
<DD>
Specifies the address of the caller’s MacOpenAdapter function. 
<BR>
<DT>
<B>CloseAdapterHandler</B>
<DD>
Specifies the address of the caller’s MacCloseAdapter function. 
<BR>
<DT>
<B>SendHandler</B>
<DD>
Specifies the address of the caller’s MacSend function. 
<BR>
<DT>
<B>TransferDataHandler</B>
<DD>
Specifies the address of the caller’s MacTransferData function. 
<BR>
<DT>
<B>ResetHandler</B>
<DD>
Specifies the address of the caller’s MacReset function. 
<BR>
<DT>
<B>RequestHandler</B>
<DD>
Specifies the address of the caller’s MacRequest function. 
<BR>
<DT>
<B>QueryGlobalStatisticsHandler</B>
<DD>
Specifies the address of the caller’s MacQueryGlobalStatistics function. 
<BR>
<DT>
<B>UnloadMacHandler</B>
<DD>
Specifies the address of the caller’s MacUnload function. 
<BR>
<DT>
<B>AddAdapterHandler</B>
<DD>
Specifies the address of the caller’s MacAddAdapter function. 
<BR>
<DT>
<B>RemoveAdapterHandler</B>
<DD>
Specifies the address of the caller’s MacRemoveAdapter function. 
<BR>
<DT>
<B>Name</B>
<DD>
Specifies the address of a caller-initialized counted string, in the
system-default character set, naming the driver. For Windows NT drivers, this
string contains Unicode characters. 
</DL>
<DT>
<I>CharacteristicsLength</I>
<DD>
Specifies the size in bytes of the characteristics structure.
</DL>
<H3>Comments</H3>
<P>
<B>NdisRegisterMac </B>provides the NDIS library with information about the
NIC driver, including the addresses of its upper-edge driver functions. In
response, the NDIS library registers the NIC driver and provides a connection
for it. 
<P>
Every NIC driver should initialize the characteristics structure with <B>NdisZeroMemory</B>
before it sets values in this structure and calls <B>NdisRegisterMac</B>. 
<P>
<B>NdisRegisterMac</B>&nbsp;saves the information at <I>MacCharacteristics</I>&nbsp;in
the NDIS library. 
<P>
All upper-edge function addresses in the characteristics structure must be
valid. After it has registered, the NIC driver cannot alter its upper-edge
functions.
<P>
After <B>NdisRegisterMac</B>&nbsp;returns control, the NDIS interface library calls
the supplied MacAddAdapter function.
<P>
Callers of <B>NdisRegisterMac</B>&nbsp;run at IRQL PASSIVE_LEVEL. 
<H3>See Also</H3>
<P>
<B><A HREF="appdxa_4.htm">MacAddAdapter</A></B>, <B><A HREF="appdxa_11.htm">MacCloseAdapter</A></B>,
<B><A HREF="appdxa_14.htm">MacOpenAdapter</A></B>, <B><A HREF="appdxa_15.htm">MacQueryGlobalStatistics</A></B>,
<B><A HREF="appdxa_16.htm">MacRemoveAdapter</A></B>, <B><A HREF="appdxa_17.htm">MacRequest</A></B>,
<B><A HREF="appdxa_18.htm">MacReset</A></B>, <B><A HREF="appdxa_19.htm">MacSend</A></B>,
<B><A HREF="appdxa_23.htm">MacTransferData</A></B>, <B><A HREF="appdxa_24.htm">MacUnload</A></B>,
<B><A HREF="appdxa_76.htm">NdisDeregisterMac</A></B>, <B><A HREF="103ndisx_79.htm">NdisInitializeString</A></B>,
<B><A HREF="appdxa_85.htm">NdisInitializeWrapper</A></B>, <B><A HREF="appdxa_96.htm">NdisRegisterAdapter</A></B>,
<B><A HREF="103ndisx_223.htm">NdisZeroMemory</A></B>&nbsp;
<P></FONT>
</BODY>
</HTML>
