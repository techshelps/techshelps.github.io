<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PROPSHEETUI_INFO</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_PROPSHEETUI_INFO_GG"></A>PROPSHEETUI_INFO</H2>
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _PROPSHEETUI_INFO {
&nbsp; &nbsp; WORD                    cbSize;
&nbsp; &nbsp; WORD                    Version;
&nbsp; &nbsp; WORD                    Flags;
&nbsp; &nbsp; WORD                    Reason;
&nbsp; &nbsp; HANDLE                  hComPropSheet;
&nbsp; &nbsp; PFNCOMPROPSHEET         pfnComPropSheet;
&nbsp; &nbsp; LPARAM                  lParamInit;
&nbsp; &nbsp; DWORD                   UserData;
&nbsp; &nbsp; DWORD                   Result;
} PROPSHEETUI_INFO, *PPROPSHEETUI_INFO;
</FONT></PRE>
<P>
The PROPSHEETUI_INFO structure is passed from the CPSUI to the caller-defined <B><A HREF="cpsui_6.htm">PFNPROPSHEETUI</A></B>
function.
<H3>Members</H3>
<DL>
<DT>
<B>cbSize</B>
<DD>
Size of this structure in bytes.
<BR>
<DT>
<B>Version</B>
<DD>
Version number of this structure. The current version is defined as
PROPSHEETUI_INFO_VERSION in <I>compstui.h</I>.
<BR>
<DT>
<B>Flags</B>
<DD>
Flag field in which the following bit can be set.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Flag</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PSUIINFO_UNICODE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The caller’s executable was compiled for Unicode.
</FONT></TABLE>
<DT>
<B>Reason</B>
<DD>
Specifies the action to be performed on the property sheet by the <B><A HREF="cpsui_6.htm">PFNPROPSHEETUI</A></B>
callback to which the PROPSHEETUI_INFO structure was passed. It can be one of
the following values.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Reason</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PROPSHEETUI_REASON_INIT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
This is the first call that the CPSUI makes to <B>PFNPROPSHEETUI</B>. The
callback should initialize itself and call the CPSUI function to which <B>pfnComPropSheet</B>
points to add new pages to the CPSUI object identified by <B>hComPropSheet</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PROPSHEETUI_REASON_<BR>
GET_INFO_HEADER
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI calls <B>PFNPROPSHEETUI</B>&nbsp;with this reason when the first call
with PROPSHEETUI_REASON_INIT set returns successfully. The callback should
supply the property sheet title bar information needed by the CPSUI to display
the property sheet dialog boxes. The CPSUI passes a PROPSHEETUI_INFO_HEADER
structure as the <I>lParam</I>&nbsp;parameter to <B>PFNPROPSHEETUI</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PROPSHEETUI_REASON_<BR>
GET_ICON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI calls <B>PFNPROPSHEETUI</B>&nbsp;with this reason to retrieve the icon
that represents this <B>PFNPROPSHEETUI</B>&nbsp;function.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PROPSHEETUI_REASON_<BR>
SET_RESULT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
A new handle, added through a call to <B><A HREF="cpsui_5.htm">PFNCOMPROPSHEET</A></B>
with <I>Function</I>&nbsp;set to CPSFUNC_ADD_<I>Xxx</I>, needs to return its result
to its parent. The CPSUI provides a pointer to a <A HREF="cpsui_23.htm">SETRESULT_INFO</A>
structure with the following fields set:
<P>
<B>hSetResult</B>&nbsp;specifies the handle that was added;
<P>
<B>Result</B>&nbsp;specifies the result from adding the property sheet page(s)
identified by <B>hSetResult</B>. This result is to be set in the
PROPSHEETUI_INFO <B>Result</B>&nbsp;field in this call to <B>PFNPROPSHEETUI</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PROPSHEETUI_REASON_<BR>
DESTROY
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Pages previously added by <B><A HREF="cpsui_6.htm">PFNPROPSHEETUI</A></B>
need to be deleted now, or the property sheet is being destroyed entirely. <B>PFNPROPSHEETUI</B>
should uninitialize itself and free all memory allocated in this function
instance.
<P>
When <B>PFNPROPSHEETUI</B>&nbsp;is called with this reason, all children of <B>hComPropSheet</B>
are destroyed, and the children’s handles are no longer valid.
</FONT></TABLE>
<DT>
<B>hComPropSheet</B>
<DD>
Handle to the CPSUI object on which action is to be performed. This handle is
created and managed by the CPSUI, and is typically a parent handle. When <B>PFNPROPSHEETUI</B>
calls the function to which <B>pfnComPropSheet</B>&nbsp;points to add or delete
property sheet pages, it should pass this handle as the <I>hComPropSheet</I>
parameter.
<BR>
<DT>
<B>pfnComPropSheet</B>
<DD>
Pointer to the CPSUI’s callback function. <B><A HREF="cpsui_6.htm">PFNPROPSHEETUI</A></B>
calls the function to which <B>pfnComPropSheet</B>&nbsp;points so that the CPSUI
can complete the action to be performed on the property sheet.
<BR>
<DT>
<B>lParamInit</B>
<DD>
Specifies the LPARAM value passed in the first call to the caller’s <B>PFNPROPSHEETUI</B>
callback by the CPSUI; the first call is always made with <B>Reason</B>&nbsp;set to
PROPSHEETUI_REASON_INIT. This member is passed to each subsequent call to <B>PFNPROPSHEETUI</B>,
regardless of reason.
<BR>
<DT>
<B>UserData</B>
<DD>
Field in which the current <B>PFNPROPSHEETUI</B>&nbsp;call can store data. This
field is an IN/OUT parameter whose value depends on <B>Reason</B>&nbsp;as shown in
the following table.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Reason</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PROPSHEETUI_REASON_INIT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
IN: Set to zero.
<P>
OUT: Contains data that was stored by this call to <B>PFNPROPSHEETUI</B>. This
data is passed in the next call to <B>PFNPROPSHEETUI</B>&nbsp;for any reason.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
All other reasons
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
IN: Specifies the data stored in the last call to <B>PFNPROPSHEETUI</B>&nbsp;for
any reason.
<P>
OUT: Contains data that was stored by this call to <B>PFNPROPSHEETUI</B>, if
any.
</FONT></TABLE>
<DT>
<B>Result</B>
<DD>
Member in which the result of the call to <B><A HREF="cpsui_6.htm">PFNPROPSHEETUI</A></B>
is stored. This field is an IN/OUT parameter whose value depends on <B>Reason</B>
as shown in the following table.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Reason</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PROPSHEETUI_REASON_INIT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
IN: Set to zero.
<P>
OUT: Set to the appropriate result of the current call to <B>PFNPROPSHEETUI</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
All other reasons
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
IN: Specifies the result returned by the previous call to <B>PFNPROPSHEETUI</B>
for any reason.
<P>
OUT: Set to the appropriate result of the current call to <B>PFNPROPSHEETUI</B>.
</FONT></TABLE>
</DL>
<H3>Comments</H3>
<P>
The CPSUI allocates, initializes, and maintains the PROPSHEETUI_INFO
structure. The CPSUI passes this structure as a parameter to <B><A HREF="cpsui_6.htm">PFNPROPSHEETUI</A></B>.
<P>
The caller’s <B>PFNPROPSHEETUI</B>&nbsp;callback can determine and set the <B>UserData</B>
and <B>Result</B>&nbsp;fields of the PROPSHEETUI_INFO structure for any
PROPSHEETUI_REASON_<I>Xxx</I>&nbsp;reason that it is called.
<P></FONT>
</BODY>
</HTML>
