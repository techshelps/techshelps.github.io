<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DrvDocumentEvent</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_DrvDocumentEvent_GG"></A>DrvDocumentEvent</H2>
<P>
<B>INT DrvDocumentEvent(</B>
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>HANDLE  </B><I>hPrinter</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>HDC  </B><I>hdc</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>int  </B><I>iEsc</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>ULONG  </B><I>cbIn</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>PULONG</B>&nbsp; <I>pbIn</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>ULONG  </B><I>cbOut</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>PULONG  </B><I>pbOut</I>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>&nbsp; &nbsp;);</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT></TABLE>
<P>
<B>DrvDocumentEvent</B>&nbsp;allows the printer driver UI to hook certain printer
management calls.
<H3>Parameters</H3>
<DL>
<DT>
<I>hPrinter</I>
<DD>
Handle that identifies the printer.
<BR>
<DT>
<I>hdc</I>
<DD>
Handle to the device context
<BR>
<DT>
<I>iEsc</I>
<DD>
Specifies the escape code that identifies the event to be handled. The escape
code is packed in the LOWORD of <I>iEsc</I>, and the HIWORD contains zero.
This parameter can be one of the following values:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Escape</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Definition</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_CREATEDCPRE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
User-mode GDI is calling <B>DrvDocumentEvent</B>&nbsp;before sending an
application’s <B>CreateDC</B>&nbsp;call to kernel-mode GDI for processing.<BR>
<B>pbIn</B>&nbsp;points to an array of four ULONGs that are 0, pointer to the
printer name, pointer to the input DEVMODE, and a Boolean value that specifies
whether the call was <B>CreateIC</B>&nbsp;(TRUE) or <B>CreateDC</B>&nbsp;(FALSE).<BR>
The driver should return a pointer to the output DEVMODE in <B>pbOut</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_CREATEDCPOST
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
User-mode GDI is calling <B>DrvDocumentEvent</B>&nbsp;after kernel-mode GDI has
processed an application’s <B>CreateDC</B>&nbsp;call.<BR>
<B>pbIn</B>&nbsp;points to the DEVMODE structure returned by a previous call to <B>DrvDocumentEvent</B>
with an <I>iEsc</I>&nbsp;of DOCUMENTEVENT_CREATEDCPRE.<BR>
<B>pbOut</B>&nbsp;is not used.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_RESETDCPRE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
User-mode GDI is calling <B>DrvDocumentEvent</B>&nbsp;before sending an
application’s <B>ResetDC</B>&nbsp;call to kernel-mode GDI for processing.<BR>
<B>pbIn</B>&nbsp;points to an input DEVMODE.<BR>
The driver should return a pointer to the output DEVMODE in <B>pbOut</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_RESETDCPOST
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
User-mode GDI is calling <B>DrvDocumentEvent</B>&nbsp;after kernel-mode GDI has
processed an application’s <B>ResetDC</B>&nbsp;call.<BR>
<B>pbIn</B>&nbsp;points to the DEVMODE structure returned by a previous call to <B>DrvDocumentEvent</B>
with an <I>iEsc</I>&nbsp;of DOCUMENTEVENT_RESETDCPRE.<BR>
<B>pbOut</B>&nbsp;is not used.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_STARTDOCPRE<BR>
DOCUMENTEVENT_STARTDOC
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
User-mode GDI is calling <B>DrvDocumentEvent</B>&nbsp;before sending an
application’s <B>StartDoc</B>&nbsp;call to kernel-mode GDI for processing.<BR>
<B>pbIn</B>&nbsp;points to an input DOCINFO structure.<BR>
<B>pbOut</B>&nbsp;is not used.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_STARTDOCPOST
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
User-mode GDI is calling <B>DrvDocumentEvent</B>&nbsp;after kernel-mode GDI has
processed an application’s <B>StartDoc</B>&nbsp;call.<BR>
<B>pbIn</B>&nbsp;points to a ULONG that specifies the ID of the current print job.<BR>
<B>pbOut</B>&nbsp;is not used.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_STARTPAGE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
User-mode GDI is calling <B>DrvDocumentEvent</B>&nbsp;before sending an
application’s <B>StartPage</B>&nbsp;call to kernel-mode GDI for processing.<BR>
Neither <B>pbIn</B>&nbsp;or <B>pbOut</B>&nbsp;are used.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_ENDPAGE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
User-mode GDI is calling <B>DrvDocumentEvent</B>&nbsp;before sending an
application’s <B>EndPage</B>&nbsp;call to kernel-mode GDI for processing.<BR>
Neither <B>pbIn</B>&nbsp;or <B>pbOut</B>&nbsp;are used.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_ENDDOCPRE<BR>
DOCUMENTEVENT_ENDDOC
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
User-mode GDI is calling <B>DrvDocumentEvent</B>&nbsp;before sending an
application’s <B>EndDoc</B>&nbsp;call to kernel-mode GDI for processing.<BR>
Neither <B>pbIn</B>&nbsp;or <B>pbOut</B>&nbsp;are used.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_ENDDOCPOST
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
User-mode GDI is calling <B>DrvDocumentEvent</B>&nbsp;after kernel-mode GDI has
processed an application’s <B>EndDoc</B>&nbsp;call.<BR>
Neither <B>pbIn</B>&nbsp;or <B>pbOut</B>&nbsp;are used.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_ABORTDOC
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
User-mode GDI is calling <B>DrvDocumentEvent</B>&nbsp;before sending an
application’s <B>AbortDoc</B>&nbsp;call to kernel-mode GDI for processing.<BR>
Neither <B>pbIn</B>&nbsp;or <B>pbOut</B>&nbsp;are used.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_DELETEDC
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
User-mode GDI is calling <B>DrvDocumentEvent</B>&nbsp;before sending an
application’s <B>DeleteDC</B>&nbsp;call to kernel-mode GDI for processing.<BR>
Neither <B>pbIn</B>&nbsp;or <B>pbOut</B>&nbsp;are used.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_ESCAPE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
User-mode GDI is calling <B>DrvDocumentEvent</B>&nbsp;before sending an
application’s <B>ExtEscape</B>&nbsp;call to kernel-mode GDI for processing.<BR>
<B>pbIn</B>&nbsp;points to an array of three ULONGs that specify the <I>nEscape</I>,
<I>cbInput</I>, and <I>lpszInData</I>&nbsp;parameters of the Win32 <B>ExtEscape</B>.<BR>
The driver should return <B>cbOut</B>&nbsp;and <B>pbOut</B>&nbsp;so that they correspond
with the <I>cbOutput</I>&nbsp;and <I>lpszOutData</I>&nbsp;parameters to <B>ExtEscape</B>.
</FONT></TABLE>
<DT>
<I>cbIn</I>
<DD>
Size in bytes of the buffer to which <I>pbIn</I>&nbsp;points.
<BR>
<DT>
<I>pbIn</I>
<DD>
Pointer to the input data associated with <I>iEsc</I>, if any. See the
description of <I>iEsc</I>&nbsp;for details.
<BR>
<DT>
<I>cbOut</I>
<DD>
Size in bytes of the buffer to which <I>pbOut</I>&nbsp;points.
<BR>
<DT>
<I>pbOut</I>
<DD>
Pointer to the output data associated with <I>iEsc</I>, if any. See the
description of <I>iEsc</I>&nbsp;for details.
</DL>
<H3>Return Value</H3>
<P>
<B>DrvDocumentEvent</B>&nbsp;returns one of the following values:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Return Value</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Meaning</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_SUCCESS 
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The driver successfully handled the hooked call identified by <I>iEsc</I>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_UNSUPPORTED
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The driver does not support the hooked call identified by <I>iEsc</I>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DOCUMENTEVENT_FAILURE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The driver supports the hooked call identified by <I>iEsc</I>, but failed to
handle the request.
</FONT></TABLE>
<H3>Comments</H3>
<P>
A printer driver UI can optionally implement <B>DrvDocumentEvent</B>&nbsp;to hook
certain printer management calls made by an application to GDI. This enables
the printer driver’s UI module to process data in user mode before GDI passes
the call to kernel-mode, and to post-process the data returned from
kernel-mode before GDI returns it to the application. <B>DrvDocumentEvent</B>
is executed in the context of the application’s process.
<P>
GDI calls <B>DrvDocumentEvent</B>&nbsp;before sending the application call on to
kernel-mode GDI when the escape code definition has no suffix or is suffixed
with <I>PRE</I>. For those escape code definitions suffixed with <I>POST</I>,
GDI calls <B>DrvDocumentEvent</B>&nbsp;after the call is processed by kernel-mode
GDI but before the results are returned to the application.
<P>
A FAX driver can implement <B>DrvDocumentEvent</B>&nbsp;so that it displays a user
interface dialog box upon a call to the Win32 <B>StartDoc</B>&nbsp;routine.
<P></FONT>
</BODY>
</HTML>
