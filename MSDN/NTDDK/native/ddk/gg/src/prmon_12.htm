<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Managing a Port</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_Managing_a_Port_GG"></A>Managing a Port</H3>
<P>
Except for remote port deletion, the spooler does not support remote port
configuration.
<H4>Configuring a Port</H4>
<P>
A port monitor’s <B><A HREF="pmonfncs_4.htm">ConfigurePort</A></B>
implementation depends on the type of port(s) that the monitor supports. For
example, if the port is a serial port, <B>ConfigurePort</B>&nbsp;could allow serial
port settings, such as baud rate and parity, to be configured. The
configuration dialog box from the Control Panel’s Ports applet can be used for
serial port configuration. Likewise, a parallel port could allow the
transmission retry time-out to be configured, and a network port could allow
an address to be configured.
<H4>Adding a Port</H4>
<P>
The spooler calls a port monitor’s <B><A HREF="pmonfncs_1.htm">AddPort</A>&nbsp;</B>or <B><A HREF="pmonfncs_2.htm">AddPortEx</A></B>
function to create a port and add it to the spooler environment. When the
monitor successfully adds a port, the spooler knows that the port is supported
by and available for printing through that monitor. Then, when a printer has
been associated with this port, the spooler can ask the monitor to open the
port for printing.
<P>
<B>AddPort</B>&nbsp;allows a port to be added interactively, so it should prompt
users to enter the port name in a dialog box on the window associated with <I>hWnd</I>.
<P>
A port monitor should ensure that no duplicate port names are added to the
spooler environment by validating that the supplied port name is unique for
all ports on the machine. It can obtain a list of the machine’s ports by
calling the Win32 <B>EnumPorts</B>&nbsp;function. Port names are unique on a per
machine basis. A port monitor should also verify that the port is one that it
supports.
<H4>Deleting a Port</H4>
<P>
As stated previously, a port’s setup is done before printers can be associated
with it. Likewise, all printers must be disassociated from a port before it
can be deleted. An application that attempts to delete a port with which a
printer is still associated gets an error.
<H4>Setting Port Timeouts</H4>
<P>
Port timeouts can be established with the one-time port initializations
performed by <B><A HREF="pmonfncs_14.htm">OpenPort</A></B>, or by calling a port
monitor’s <B><A HREF="pmonfncs_17.htm">SetPortTimeOuts</A></B>
implementation. To avoid hung or unreasonably delayed port responses, port
monitors should always establish reasonable time-outs before actually calling
a port.
<P>
<B>SetPortTimeOuts</B>&nbsp;can use the Win32 <B>GetCommTimeouts</B>&nbsp;and <B>SetCommTimeouts</B>
functions to establish the time-out parameters for a port.
<P>
&nbsp;
<P></FONT>
</BODY>
</HTML>
