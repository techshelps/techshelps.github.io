<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PFNPROPSHEETUI</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_PFNPROPSHEETUI_GG"></A>PFNPROPSHEETUI</H2>
<P>
<B>LONG (FAR *PFNPROPSHEETUI)(</B>
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>PPROPSHEETUI_INFO  </B><I>pPSUIInfo</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>LPARAM  </B><I>lParam</I>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>&nbsp; &nbsp;);</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT></TABLE>
<P>
<B>PFNPROPSHEETUI</B>&nbsp;is a caller-defined function that the CPSUI calls to
enable its caller to add or delete pages from a property sheet.
<H3>Parameters</H3>
<DL>
<DT>
<I>pPSUIInfo</I>
<DD>
Pointer to a <A HREF="cpsui_20.htm">PROPSHEETUI_INFO</A>&nbsp;structure. The
CPSUI allocates and initializes this structure with the information needed by <B>PFNPROPSHEETUI</B>
to add property sheet pages. This parameter can be null.
<BR>
<DT>
<I>lParam</I>
<DD>
If <I>pPSUIInfo</I>&nbsp;is null, the caller of <B>PFNPROPSHEETUI</B>&nbsp;is not the
CPSUI, but is the spooler or Print Folder instead. In this situation, <I>lParam</I>
is a parameter whose type is known the caller. If <I>pPSUIInfo</I>&nbsp;is
non-null, the CPSUI has called <B>PFNPROPSHEETUI</B>. In this situation, the
value of <I>lParam</I>&nbsp;depends on the <B>Reason</B>&nbsp;member of the <A HREF="cpsui_20.htm">PROPSHEETUI_INFO</A>
structure shown in the following table.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Reason</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Description
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PROPSHEETUI_REASON_INIT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <I>lParam</I>&nbsp;parameter is either the unmodified <I>lParam</I>&nbsp;parameter
passed to <B><A HREF="cpsui_2.htm">CommonPropertySheetUI</A></B>,
or the <I>lParam2</I>&nbsp;parameter passed to <B><A HREF="cpsui_5.htm">PFNCOMPROPSHEET</A></B>
with a <I>Function</I>&nbsp;of CPSFUNC_ADD_PFNPROPSHEETUI.
<P>
The CPSUI has copied this instance of <I>lParam</I>&nbsp;to the <B>lParamInit</B>
field of the PROPSHEETUI_INFO structure. The <B>lParamInit</B>&nbsp;field is passed
to all subsequent calls to <B>PFNPROPSHEETUI</B>&nbsp;without modification.
<P>
The <I>lParam</I>&nbsp;parameter must not reside on the calling function’s stack.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PROPSHEETUI_REASON_<BR>
GET_INFO_HEADER
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <I>lParam</I>&nbsp;parameter is a pointer to a <A HREF="cpsui_21.htm">PROPSHEETUI_INFO_HEADER</A>
structure. <B>PFNPROPSHEETUI</B>&nbsp;must fill in the fields of this structure for
the CPSUI.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PROPSHEETUI_REASON_<BR>
DESTROY
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <I>lParam</I>&nbsp;parameter is zero when the destroy request occurs because
the caller has called the CPSUI’s <B><A HREF="cpsui_5.htm">PFNCOMPROPSHEET</A></B>
callback with <I>Function</I>&nbsp;set to CPSFUNC_DELETE_HCOMPROPSHEET, or when the
CPSUI’s callback failed a caller’s CPSFUNC_ADD_<I>Xxx</I>&nbsp;request.
<P>
The <I>lParam</I>&nbsp;parameter is nonzero when the user is exiting the property
sheet.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PROPSHEETUI_REASON_<BR>
SET_RESULT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <I>lParam</I>&nbsp;parameter is a pointer to a SETRESULT_INFO structure in
which the CPSUI has set the following fields:
<P>
<B>hSetResult</B>&nbsp;contains the handle to those page(s) added to the sheet
through a call to <B>PFNCOMPROPSHEET</B>&nbsp;with a CPSFUNC_ADD_<I>Xxx</I>
function index;
<P>
<B>Result</B>&nbsp;contains the result obtained when <B>hSetResult</B>&nbsp;was
generated. <B>PFNPROPSHEETUI</B>&nbsp;should save this result in the <B>Result</B>
field of the structure to which <I>pPSUIInfo</I>&nbsp;points. When <B>PFNPROPSHEETUI</B>’s
return value is greater than zero, the CPSUI propagates the <B>Result</B>
field of the structure to which <I>pPSUIInfo</I>&nbsp;points to its parent.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PROPSHEETUI_REASON_<BR>
GET_ICON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <I>lParam</I>&nbsp;parameter is a pointer to a <A HREF="cpsui_19.htm">PROPSHEETUI_GETICON_INFO</A>
structure in which the CPSUI has set the following fields:
<P>
<B>cxIcon</B>&nbsp;is the icon’s width, in pixels;
<P>
<B>cyIcon</B>&nbsp;is the icon’s height, in pixels;
<P>
<B>hIcon</B>&nbsp;is null. <B>PFNPROPSHEETUI</B>&nbsp;should create an icon and return
its handle, or, if it does not create an icon, should return null.
</FONT></TABLE>
</DL>
<H3>Return Value</H3>
<P>
The return value of <B>PFNPROPSHEETUI</B>&nbsp;depends on the <B>Reason</B>&nbsp;field
of the PROPSHEETUI_INFO structure shown in the following table.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Reason</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Return Value</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PROPSHEETUI_REASON_INIT,<BR>
PROPSHEETUI_REASON_GET_INFO_HEADER,<BR>
PROPSHEETUI_REASON_DESTROY
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Returns greater than zero to indicate success, and less than or equal to zero
to indicate failure.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PROPSHEETUI_REASON_SET_RESULT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Returns greater than zero to indicate that the <B>Result</B>&nbsp;field in the
structure to which <I>pPSUIInfo</I>&nbsp;points should be set to its parent;
returns less than or equal to zero to indicate that <B>Result</B>&nbsp;need not be
set to its parent.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PROPSHEETUI_REASON_GET_ICON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Returns greater than zero to indicate success, zero to indicate that no icon
was available, and less than zero to indicate failure.
</FONT></TABLE>
<H3>Comments</H3>
<P>
<B>PFNPROPSHEETUI</B>&nbsp;is a pseudoname; the actual name of this function can be
decided upon by the developer. <B>PFNPROPSHEETUI</B>&nbsp;must be implemented.
<P>
<B>PFNPROPSHEETUI</B>&nbsp;is a caller-defined function in which the caller can
request the CPSUI to add pages to the property sheet. The CPSUI calls this
function as follows:
<PRE><FONT FACE="Courier" SIZE="2">PROPSHEETUI_INFO   PSUIInfo;
PFNPROPSHEETUI(&amp;PSUIInfo, lParam);
</FONT></PRE>
<P>
The CPSUI stores the reason for calling <B>PFNPROPSHEETUI</B>&nbsp;in the <B>Reason</B>
field of the <A HREF="cpsui_20.htm">PROPSHEETUI_INFO</A>&nbsp;structure to
which <I>pPSUIInfo</I>&nbsp;points. <B>PFNPROPSHEETUI</B>&nbsp;should be implemented as
a re-entrant, message-based function, as the CPSUI calls it several times over
the lifetime of the property sheet.
<P>
The CPSUI calls <B>PFNPROPSHEETUI</B>&nbsp;for the first time with <B>Reason</B>
always set to PROPSHEETUI_REASON_INIT. <B>PFNPROPSHEETUI</B>&nbsp;should initialize
itself and then call the CPSUI to add new pages to the property sheet root
identified by the <B>hComPropSheet</B>&nbsp;member of the PROPSHEETUI_INFO
structure.<B>&nbsp;PFNPROPSHEETUI</B>&nbsp;must call back to the CPSUI to actually add
(or delete) pages from the property sheet. The CPSUI provides a pointer to its
callback in the <B>pfnComPropSheet</B>&nbsp;field. The CPSUI callback returns a
value greater than zero to indicate success, and a value less than or equal to
zero to indicate failure.
<P>
If the first call to <B>PFNPROPSHEETUI</B>&nbsp;does not return successfully, the
CPSUI calls <B>PFNPROPSHEETUI</B>&nbsp;with <B>Reason</B>&nbsp;set to
PROPSHEETUI_REASON_DESTROY so that <B>PFNPROPSHEETUI</B>&nbsp;can uninitialize
itself.
<P>
The CPSUI calls <B>PFNPROPSHEETUI</B>&nbsp;with <B>Reason</B>&nbsp;set to
PROPSHEETUI_REASON_GET_INFO_HEADER to obtain high-level property sheet
information to use when it displays the property sheet dialog boxes. 
<H3>See Also</H3>
<P>
<B><A HREF="cpsui_2.htm">CommonPropertySheetUI</A></B>, <B><A HREF="cpsui_5.htm">PFNCOMPROPSHEET</A></B>,
<A HREF="cpsui_20.htm">PROPSHEETUI_INFO</A>, <A HREF="cpsui_21.htm">PROPSHEETUI_INFO_HEADER</A>
<P></FONT>
</BODY>
</HTML>
