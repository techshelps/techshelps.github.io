<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>STROBJ</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_STROBJ_GG"></A>STROBJ</H2>
<PRE><FONT FACE="Courier" SIZE="2">class _STROBJ {
&nbsp; &nbsp; ULONG cGlyphs;
&nbsp; &nbsp; FLONG flAccel;
&nbsp; &nbsp; ULONG ulCharInc;
&nbsp; &nbsp; RECTL rclBkGround;
&nbsp; &nbsp; GLYPHPOS *pgp;
&nbsp; &nbsp; PWSTR pwszOrg;
} STROBJ;
</FONT></PRE>
<P>
The STROBJ class, or text string object, contains an enumeration of glyph
handles and positions for the device driver.
<H3>Members</H3>
<DL>
<DT>
<B>cGlyphs</B>
<DD>
Specifies the number of glyphs in the STROBJ.
<BR>
<DT>
<B>flAccel</B>
<DD>
Accelerator flags. This member can be any of the following values:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Flag</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Meaning</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SO_FLAG_DEFAULT_PLACEMENT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Default increment vectors are used to position the characters.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SO_HORIZONTAL
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Text is horizontal; left-to-right or right-to-left, depending on SO_REVERSED.
The y coordinate is only supplied for the first glyph in the string.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SO_VERTICAL
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Text is vertical; top-to-bottom or bottom-to-top, depending on SO_REVERSED.
The x coordinate is only supplied for the first glyph in the string.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SO_REVERSED
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Set if horizontal is right-to-left or vertical is bottom-to-top.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SO_ZERO_BEARINGS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
All glyphs have zero A and zero C spacing. This bit guarantees that glyph’s
black boxes do not overlap.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SO_CHAR_INC_EQUAL_BM_BASE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Spacing is determined by bitmap sizes. In this context, bitmap base is defined
as cx for horizontal case, cy for vertical case. This bit is set means that
every glyph in a font the bitmap (supplied in GLYPHBITS structure by GDI) will
have a base equal to the advance width for that glyph. This does not mean that
this is a fixed pitch font. (Not used for PATHOBJs.)
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SO_MAXEXT_EQUAL_BM_SIDE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Bitmaps have the same widths. In this context, bitmap side is defined as cy
for horizontal case and cx for vertical case. This flag guarantees that all
glyphs in the font will have the same side equal to the sum of ascender and
descender. However, this bit indicates more than just a constant side. For
horizontal case, this bit also indicates that the vertical distance between
the top of the glyph&#39;s bitmap and its character origin is equal to the
ascender for all glyphs. For vertical case, this bit indicates that the
horizontal distance between the glyph&#39;s origin and &quot;top&quot; of the
glyph&#39;s bitmap (which is really right or left, depending on whether you
are writing in the direction of positive or negative y axis) is equal to the
ascender. In either case, the tops and bottoms of all glyph bitmaps lay on the
same line in the direction of writing. (Not used for PATHOBJs.)
</FONT></TABLE>
<DT>
<B>ulCharInc</B>
<DD>
Specifies whether the font is a fixed-pitch (monospace) font. If it is, this
member is equal to the advance width of glyphs in pels; otherwise, it is zero.
When this member is nonzero, GDI supplies a valid coordinate for only the
first character in the string. All other character positions must be generated
by the driver by successively adding the value of this member along the
writing direction.
<BR>
<DT>
<B>rclBkGround</B>
<DD>
Specifies the bounding box for the string.
<BR>
<DT>
<B>pgp</B>
<DD>
Points to the GLYPHPOS array for the whole string. If this member is not null,
enumeration is not required.
<BR>
<DT>
<B>pwszOrg</B>
<DD>
Points to the original Unicode string or <B>cGlyphs</B>&nbsp;characters. Contrary
to its name, this string is not usually zero-terminated. Also, this string is
not always valid, such as in journalling with printer fonts, in which case
this parameter will be null.
</DL>
<H3>Comments</H3>
<P>
<B><A HREF="grfncs_183.htm">STROBJ_vEnumStart</A></B>&nbsp;and <B><A HREF="grfncs_181.htm">STROBJ_bEnum</A></B>
provide access to the Unicode string for the driver.
<H3>See Also</H3>
<P>
<B><A HREF="grfncs_27.htm">DrvGetGlyphMode</B>&nbsp;</A>, <B><A HREF="grfncs_59.htm">DrvTextOut</A></B>
<P></FONT>
</BODY>
</HTML>
