<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>COMPROPSHEETUI</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_COMPROPSHEETUI_GG"></A>COMPROPSHEETUI</H2>
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _COMPROPSHEETUI {
&nbsp; &nbsp; WORD                  cbSize;
&nbsp; &nbsp; WORD                  Flags;
&nbsp; &nbsp; HINSTANCE             hInstCaller;
&nbsp; &nbsp; LPTSTR                pCallerName;
&nbsp; &nbsp; DWORD                 UserData;
&nbsp; &nbsp; LPTSTR                pHelpFile;
&nbsp; &nbsp; _CPSUICALLBACK        pfnCallBack;
&nbsp; &nbsp; POPTITEM              pOptItem;
&nbsp; &nbsp; PDLGPAGE              pDlgPage;
&nbsp; &nbsp; WORD                  cOptItem;
&nbsp; &nbsp; WORD                  cDlgPage;
&nbsp; &nbsp; DWORD                 IconID;
&nbsp; &nbsp; LPTSTR                pOptItemName;
&nbsp; &nbsp; WORD                  CallerVersion;
&nbsp; &nbsp; WORD                  OptItemVersion;
&nbsp; &nbsp; DWORD                 dwReserved[4];
} COMPROPSHEETUI, *PCOMPROPSHEETUI;
</FONT></PRE>
<P>
The COMPROPSHEETUI data structure contains the caller-specific data required
by the CPSUI to construct and display the property sheet pages.
<H3>Members</H3>
<DL>
<DT>
<B>cbSize</B>
<DD>
Size in bytes of this structure.
<BR>
<DT>
<B>Flags</B>
<DD>
Bitmask in which the caller can set any combination of the following flags.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Value</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Description
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUIF_UPDATE_PERMISSION
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
All valid items to which <B>pOptItem</B>&nbsp;points are changeable by the user.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUIF_ICONID_AS_HICON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI should interpret <B>IconID</B>&nbsp;as a handle to an icon rather than a
resource ID.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUIF_ABOUT_CALLBACK
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
If the end-user selects the <B>About…</B>&nbsp;button in the treeview tab, the
CPSUI should call the callback to which <B>pfnCallBack</B>&nbsp;points with the <B>Reason</B>
field of the <I>pComPropSheetUICBParam</I>&nbsp;parameter set to
CPSUICB_REASON_ABOUT.
</FONT></TABLE>
<DT>
<B>hInstCaller</B>
<DD>
Handle to the caller’s instance of itself. The CPSUI uses this handle to load
the caller’s icon and other resources.
<BR>
<DT>
<B>pCallerName</B>
<DD>
Pointer to a null-terminated string that specifies the name of the caller.
This string is typically a driver’s name, such as “PostScript Driver”.
<BR>
<DT>
<B>UserData</B>
<DD>
A 32-bit value that is defined and used by the caller. When the CPSUI calls <B>pfnCallBack</B>,
it passes this member as the <B>UserData</B>&nbsp;field of the <I>pComPropSheetUICBParam</I>
parameter. The CPSUI does not not modify this value.
<BR>
<DT>
<B>pHelpFile</B>
<DD>
Pointer to a null-terminated string that specifies a standard Microsoft help
file. This string must contain the complete path to the file. The <B>HelpIndex</B>
field of the <A HREF="cpsui_16.htm">OPTITEM</A>&nbsp;structure specifies the index
location into the help file for the context string associated with the item.
<BR>
<DT>
<B>pfnCallBack</B>
<DD>
Pointer to a <B><A HREF="cpsui_3.htm">_CPSUICALLBACK</A></B>&nbsp;callback
that is defined by the caller. The CPSUI calls this callback for various
CPSUICB_REASON_<I>Xxx</I>&nbsp;reasons only when an OPTITEM’s OPTIF_CALLBACK bit is
set.
<BR>
<DT>
<B>pOptItem</B>
<DD>
Pointer to an array of OPTITEM structures that describe the option items to be
displayed by the CPSUI.
<BR>
<DT>
<B>pDlgPage</B>
<DD>
Pointer to an array of <A HREF="cpsui_11.htm">DLGPAGE</A>&nbsp;structures that
describe the characteristics of each property sheet page. The CPSUI has
defined the following standard dialog boxes for use by the caller.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>DLGPAGE </B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUI_PDLGPAGE_DOCPROP
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The property sheet has two standard pages, whose tabs are <B>Page Setup</B>
and <B>Advanced</B>. The <B>Advanced</B>&nbsp;page is a treeview.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUI_PDLGPAGE_ADVDOCPROP
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The property sheet has one treeview page whose tab reads <B>Advanced</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUI_PDLGPAGE_PRINTERPROP
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The property sheet has one treeview page whose tab reads <B>Device Settings</B>.
This page is a CPSUI-defined standard printer property sheet.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUI_PDLGPAGE_TREEVIEWONLY
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The property sheet has one treeview page.
</FONT></TABLE>
<DT>
<B>cOptItem</B>
<DD>
Specifies the number of <A HREF="cpsui_16.htm">OPTITEM</A>&nbsp;structures to which <B>pOptItem</B>
points.
<BR>
<DT>
<B>cDlgPage</B>
<DD>
Specifies the number of <A HREF="cpsui_11.htm">DLGPAGE</A>&nbsp;structures to which <B>pDlgPage</B>
points. The CPSUI ignores this field if <B>pDlgPage</B>&nbsp;specifies a standard
CPSUI_PDLGPAGE_<I>Xxx</I>&nbsp;dialog box.
<BR>
<DT>
<B>IconID</B>
<DD>
Identifies the icon to be displayed on the title bar of the property sheet
page. This field can be a standard IDI_CPSUI_<I>Xxx</I>&nbsp;icon ID, a caller’s
icon resource ID, or, if the CPSUIF_ICONID_AS_HICON bit is set in <B>Flags</B>,
a handle to a caller-defined icon. If <B>IconID</B>&nbsp;is zero, the property
sheet’s title bar does not have an icon associated with it.
<BR>
<DT>
<B>pOptItemName</B>
<DD>
Pointer to a null-terminated string that identifies the root-level option
item. This field is typically the device name, such as “HP 4si”.
<BR>
<DT>
<B>CallerVersion</B>
<DD>
Specifies the caller’s version number. The high byte identifies the major
version; the low byte is the minor version. For example, a <B>CallerVersion</B>
value of 0x310 specifies a caller version number of 3.16.
<BR>
<DT>
<B>OptItemVersion</B>
<DD>
Specifies the version number for the root-level option item. The high byte
identifies the major version; the low byte is the minor version. For example,
an <B>OptItemVersion</B>&nbsp;value of 0x3ff specifies a caller version number of
3.255.
<BR>
<DT>
<B>dwReserved[4]</B>
<DD>
Reserved. These fields must be set to zero.
</DL>
<H3>Comments</H3>
<P>
A COMPROPSHEETUI structure is initialized by the caller and passed to the
CPSUI’s <B><A HREF="cpsui_5.htm">PFNCOMPROPSHEET</A></B>&nbsp;callback as <I>lParam1</I>
when <I>Function</I>&nbsp;is CPSFUNC_ADD_PCOMPROPSHEETUI.
<P>
If the CPSUIF_ABOUT_CALLBACK bit is set in the <B>Flags</B>&nbsp;field, the
callback to which <B>pfnCallBack</B>&nbsp;points must handle a user request to see
the <B>About</B>&nbsp;dialog box. If this bit is not set, the CPSUI calls the Win32
<B>ShellAbout</B>&nbsp;function with the <B>pCallerName</B>&nbsp;and <B>CallerVersion</B>
fields formatted as the <I>szApp</I>&nbsp;parameter, and <B>pOptItemName</B>&nbsp;and <B>OptItemVersion</B>
formatted as the <I>szOtherStuff</I>&nbsp;parameter.
<P>
The CPSUI automatically modifies the <B>DlgPageIdx</B>&nbsp;fields of each <A HREF="cpsui_16.htm">OPTITEM</A>
when the user specifies CPSUI_PDLGPAGE_<I>Xxx</I>&nbsp;in <B>pDlgPage</B>.
<P></FONT>
</BODY>
</HTML>
