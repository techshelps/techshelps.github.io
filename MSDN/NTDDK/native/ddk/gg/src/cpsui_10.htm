<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CPSUICBPARAM</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_CPSUICBPARAM_GG"></A>CPSUICBPARAM</H2>
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _CPSUICBPARAM {
&nbsp; &nbsp; WORD              cbSize;
&nbsp; &nbsp; WORD              Reason;
&nbsp; &nbsp; HWND              hDlg;
&nbsp; &nbsp; POPTITEM          pOptItem;
&nbsp; &nbsp; WORD              cOptItem;
&nbsp; &nbsp; WORD              Flags;
&nbsp; &nbsp; POPTITEM          pCurItem;
&nbsp; &nbsp; union {
&nbsp; &nbsp; &nbsp; &nbsp; LONG          OldSel;
&nbsp; &nbsp; &nbsp; &nbsp; LPTSTR        pOldSel;
&nbsp; &nbsp; };
&nbsp; &nbsp; DWORD             UserData;
&nbsp; &nbsp; DWORD             Result;
} CPSUICBPARAM, *PCPSUICBPARAM;
</FONT></PRE>
<P>
The CPSUICBPARAM structure contains the reason for the CPSUI’s call to <B><A HREF="cpsui_3.htm">_CPSUICALLBACK</A></B>,
and the parameters needed by <B>_CPSUICALLBACK</B>&nbsp;to make changes to an
option item and return an action to the CPSUI. The CPSUI can then redisplay
the treeview or <B>Page Setup</B>&nbsp;data.
<H3>Members</H3>
<DL>
<DT>
<B>cbSize</B>
<DD>
Size in bytes of this structure.
<BR>
<DT>
<B>Reason</B>
<DD>
Specifies the reason that the CPSUI is calling back to the caller. This member
can be one of the following values.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Reason</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUICB_REASON_<BR>
SEL_CHANGED
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The user has made a change to the item to which <B>pCurItem</B>&nbsp;points. If the
<B>DMPubID</B>&nbsp;field of the affected <A HREF="cpsui_16.htm">OPTITEM</A>&nbsp;is
DMPUB_COPIES_COLLATE, the CPSUI enables/disables the extended check box
without calling back to <B>_CPSUICALLBACK</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUICB_REASON_<BR>
PUSH BUTTON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The user has pushed the push button, and the push button item’s <A HREF="cpsui_17.htm">OPTPARAM</A>
<B>Style</B>&nbsp;field is set to PUSH BUTTON_TYPE_CALLBACK.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUICB_REASON_<BR>
ECB_CHANGED
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The user has changed state in the extended check box described by the
structure to which <B>pCurItem-&gt;pExtChkBox</B>&nbsp;points.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUICB_REASON_<BR>
DLGPROC
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The user has pushed the push button, and the push button item’s OPTPARAM <B>Style</B>
field is set to PUSH BUTTON_TYPE_DLGPROC.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUICB_REASON_<BR>
EXTPUSH
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The user has pushed the extended push button described by the structure to
which <B>pCurItem-&gt;pExtPush</B>&nbsp;points.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUICB_REASON_<BR>
APPLYNOW
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The user has pushed the <B>Apply Now</B>&nbsp;push button. The CPSUI sets <B>pCurItem</B>
to point to the item to which <B>pOptItem</B>&nbsp;points. It also sets <B>OldSel</B>
to -1 to indicate that all valid changed items should be applied now.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUICB_REASON_<BR>
OPTITEM_SETFOCUS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
An option item has keyboard focus. The CPSUI calls the callback so that it can
examine the item.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUICB_REASON_<BR>
ITEMS_REVERTED
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
After changing option(s), the user has pushed the <B>Undo</B>&nbsp;push button to
undo the changes.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUICB_REASON_<BR>
ABOUT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The user has pushed the <B>About <I>Xxx</I></B>&nbsp;push button on the treeview
page, and the CPSUIF_ABOUT_CALLBACK flag is set, indicating that the caller
has hooked the <B>About</B>&nbsp;page to display their proprietary <B>About</B>
information. <B>_CPSUICALLBACK</B>&nbsp;sets <B>pCurItem</B>&nbsp;to point to the item
to which <B>pOptItem</B>&nbsp;points, and sets <B>pOldSel</B>&nbsp;to point to the
original copy of the <A HREF="cpsui_9.htm">COMPROPSHEETUI</A>&nbsp;structure
passed to the CPSUI.
</FONT></TABLE>
<DT>
<B>hDlg</B>
<DD>
Handle to the dialog box that is currently active for the <B><A HREF="cpsui_3.htm">_CPSUICALLBACK</A></B>
function.
<BR>
<DT>
<B>pOptItem</B>
<DD>
Points to an array of <A HREF="cpsui_16.htm">OPTITEM</A>&nbsp;structures that
describe the treeview items to be displayed by the CPSUI. This is the same
pointer sent by the caller to the CPSUI’s <B>pfnComPropSheet</B>&nbsp;callback in
the <B>pOptItem</B>&nbsp;field of the <A HREF="cpsui_9.htm">COMPROPSHEETUI</A>
structure.
<BR>
<DT>
<B>cOptItem</B>
<DD>
Number of OPTITEM structures to which <B>pOptItem</B>&nbsp;points. This is the same
value sent by the caller to the CPSUI’s <B>pfnComPropSheet</B>&nbsp;callback in the
<B>cOptItem</B>&nbsp;field of the COMPROPSHEETUI structure.
<BR>
<DT>
<B>Flags</B>
<DD>
Specifies the flags passed by the caller to the CPSUI’s <B>pfnComPropSheet</B>
callback in the <B>Flags</B>&nbsp;field of the COMPROPSHEETUI structure.
<BR>
<DT>
<B>pCurItem</B>
<DD>
Pointer to the <A HREF="cpsui_16.htm">OPTITEM</A>&nbsp;structure in the array to
which <B>pOptItem</B>&nbsp;points that describes the item for which the callback
was generated.
<BR>
<DT>
<B>OldSel</B>
<DD>
The <B>Sel</B>&nbsp;field of the OPTITEM structure that was current before the user
made a change. This field is valid only when the <B>Reason</B>&nbsp;callback is
CPSUICB_REASON_SEL_CHANGED. The callback can use this field to check the
change against the previous item selection.
<BR>
<DT>
<B>pOldSel</B>
<DD>
Pointer to a null-terminated string that describes the option item’s last
selection before a change was made by the user; that is, <B>pOldSel</B>&nbsp;is
equal to the previously current OPTITEM’s<B>&nbsp;pSel</B>&nbsp;field. The <B>pOldSel</B>
member is valid only when the <B>Reason</B>&nbsp;callback is
CPSUICB_REASON_SEL_CHANGED. The callback can use this field to check the
change against the previous item selection.
<BR>
<DT>
<B>UserData</B>
<DD>
Specifies the 32-bit value provided by the original caller to the CPSUI’s <B>pfnComPropSheet</B>
callback in the <B>UserData</B>&nbsp;field of the <A HREF="cpsui_9.htm">COMPROPSHEETUI</A>
structure.
<BR>
<DT>
<B>Result</B>
<DD>
Specifies the result of the <B><A HREF="cpsui_3.htm">_CPSUICALLBACK</A></B>
callback. The default <B>Result</B>&nbsp;is CPSUI_OK, and is set by the CPSUI. The <B>_CPSUICALLBACK</B>
function can alter this result before returning to the CPSUI. The <B>Result</B>
field need only be set when <B>Reason</B>&nbsp;is CPSUICB_REASON_APPLYNOW; the
CPSUI ignores <B>Result</B>&nbsp;for all other reasons.
</DL>
<H3>Comments</H3>
<P>
When <B>Reason</B>&nbsp;is CPSUICB_REASON_APPLYNOW, <B>_CPSUICALLBACK</B>&nbsp;must set
the requested result in the <B>Result</B>&nbsp;field when it returns a value other
than CPSUICB_ACTION_NO_APPLY_EXIT. The CPSUI sends <B>Result</B>&nbsp;to the parent
of the current property sheet page.
<P></FONT>
</BODY>
</HTML>
