<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The Print Monitor API</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_The_Print_Monitor_API_GG"></A>The Print Monitor API</H2>
<P>
Port and language monitor function prototypes and structure definitions can be
found in the Windows NT DDK <I>winsplp.h</I>&nbsp;include file.
<P>
The following table contains the print monitor API and implementation
requirements on a per-monitor basis. <B><A HREF="pmonfncs_11.htm">InitializePrintMonitor</A></B>
and <B>DllEntryPoint</B>&nbsp;are the only two functions that a monitor’s DLL must
export; the spooler accesses all other functions through the function table
returned by <B>InitializePrintMonitor</B>. For this reason, except for <B>InitializePrintMonitor</B>
and <B>DllEntryPoint</B>, the names of all other required functions are
pseudonames that can, in fact, have any name that the monitor developer
wishes.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Implement?*</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Function Name</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>PM</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>LM</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>LMPM</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_11.htm">InitializePrintMonitor</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Initializes the print monitor.
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>DllEntryPoint</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Entry function; called when the spooler loads a monitor’s DLL with the Win32 <B>LoadLibrary</B>
function.
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_14.htm">OpenPort</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Opens a port for a newly connected printer.
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<FONT FACE="Symbol">&#45;</FONT>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_15.htm">OpenPortEx</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Opens a port for a newly connected printer.
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<FONT FACE="Symbol">&#45;</FONT>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_3.htm">ClosePort</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Closes a port when there are no printers connected to it.
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_18.htm">StartDocPort</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Performs the tasks required to start a print job on a port.
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_19.htm">WritePort</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Writes data to a printer port.
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_16.htm">ReadPort</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Reads data from a printer port.
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_6.htm">EndDocPort</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Performs end-of-print-job tasks on a port.
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_1.htm">AddPort</A>&nbsp;</B>or <B><A HREF="pmonfncs_2.htm">AddPortEx</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Creates a port. 
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<FONT FACE="Symbol">&#45;</FONT>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_5.htm">DeletePort</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Deletes a port.
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<FONT FACE="Symbol">&#45;</FONT>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_7.htm">EnumPorts</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Enumerates the ports available for printing on a server.
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<FONT FACE="Symbol">&#45;</FONT>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_4.htm">ConfigurePort</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Performs port configuration.
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<FONT FACE="Symbol">&#45;</FONT>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
X
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_17.htm">SetPortTimeOuts</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Sets a time-out value on an open port.
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
o
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<FONT FACE="Symbol">&#45;</FONT>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
o
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_8.htm">GetPrinterDataFromPort</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Gets data from a bidirectional printer by providing IEEE 1284 support.
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
o
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
o
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
o
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>*</B>&nbsp;X = required;   <FONT FACE="Symbol">&#45;</FONT> = do not implement, 
&nbsp;o = optional
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT></TABLE>
<P>
To perform the basic requirements of monitoring printers connected to ports
and sending print job data through ports, <I>all</I>&nbsp;print monitors must
implement the following functions:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_11.htm">InitializePrintMonitor</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_18.htm">StartDocPort</A></B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>DllEntryPoint</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_19.htm">WritePort</A></B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_14.htm">OpenPort</A>&nbsp;</B>or <B><A HREF="pmonfncs_15.htm">OpenPortEx</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_16.htm">ReadPort</A></B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_3.htm">ClosePort</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_6.htm">EndDocPort</A></B>
</FONT></TABLE>
<P>
For information on <B>DllEntryPoint</B>, see the Win32 SDK.
<P>
Port monitors and LMPMs are required to implement the print monitor functions
that perform port management. These functions are:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_1.htm">AddPort</A></B>&nbsp;or <B><A HREF="pmonfncs_2.htm">AddPortEx</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_7.htm">EnumPorts</A></B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_5.htm">DeletePort</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="pmonfncs_4.htm">ConfigurePort</A></B>
</FONT></TABLE>
<P>
Because port management is the port monitor’s responsibility, a pure language
monitor should not implement any of these routines.
<P>
The remaining functions of the print monitor API, <B><A HREF="pmonfncs_17.htm">SetPortTimeouts</A></B>
and<B>&nbsp;<A HREF="pmonfncs_8.htm">GetPrinterDataFromPort</A></B>, can
be optionally implemented by port monitors and LMPMs. Pure language monitors
can implement <B>GetPrinterDataFromPort</B>, but should not implement <B>SetPortTimeouts</B>
because it is a port management function.
<P></FONT>
</BODY>
</HTML>
