<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_CPSUICALLBACK</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK__CPSUICALLBACK_GG"></A>_CPSUICALLBACK</H2>
<P>
<B>LONG (APIENTRY *_CPSUICALLBACK)(</B><BR>
&nbsp; &nbsp; <B>PCPSUICBPARAM</B>&nbsp; &nbsp; <I>pComPropSheetUICBParam</I><BR>
<B>);</B>
<P>
<B>_CPSUICALLBACK</B>&nbsp;is a caller-defined function that is called by the CPSUI
to allow the caller to make changes to an option item.
<H3>Parameters</H3>
<DL>
<DT>
<I>pComPropSheetUICBParam</I>
<DD>
Pointer to a <A HREF="cpsui_10.htm">CPSUICBPARAM</A>&nbsp;structure containing
the reason for calling <B>_CPSUICALLBACK</B>. This structure also contains the
parameters needed by the caller to make changes to an option item and return
an action to the CPSUI to redisplay the affected dialog box.
</DL>
<H3>Return Value</H3>
<P>
<B>_CPSUICALLBACK</B>&nbsp;returns one of the following values to the CPSUI:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Value</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Definition</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUICB_ACTION_NONE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
No action is required by the CPSUI for all option items.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUICB_ACTION_<BR>
OPTIF_CHANGED
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI should examine the OPTIF_CHANGED flag in the <B>pOptItem</B>&nbsp;field
of the structure to which <I>pComPropSheetUICBParam</I>&nbsp;points. If
OPTIF_CHANGED is set, the CPSUI needs to redisplay the item because the item’s
<B>Flags</B>&nbsp;field or selection has changed.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUICB_ACTION_<BR>
REINIT_ITEMS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI should examine the OPTIF_CHANGED flag in the <B>pOptItem</B>&nbsp;field
of the structure to which <I>pComPropSheetUICBParam</I>&nbsp;points. If
OPTIF_CHANGED is set, the CPSUI needs to reinitialize the item in the dialog
box control because its associated <A HREF="cpsui_18.htm">OPTTYPE</A>&nbsp;structure
or <A HREF="cpsui_17.htm">OPTPARAM</A>’s <B>Flag</B>&nbsp;and/or <B>pData</B>&nbsp;fields
have changed.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUICB_ACTION_<BR>
NO_APPLY_EXIT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Notifies the CPSUI that, due to constraints on the <A HREF="cpsui_16.htm">OPTITEM</A>
to which <B>pOptItem</B>&nbsp;points, <B>_CPSUICALLBACK</B>&nbsp;displayed a dialog box
message and/or had the user correct or confirm something in the OPTITEM. This
return value is valid only when <B>_CPSUICALLBACK</B>&nbsp;is called with the <B>Reason</B>
field of the <I>pComPropSheetUICBParam</I>&nbsp;parameter set to
CPSUICB_REASON_APPLYNOW.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUICB_ACTION_<BR>
ITEMS_APPLIED
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Notifies the CPSUI that the callback has recorded the option(s) that were
changed by the user. The CPSUI  clears the OPTIF_CHANGEONCE flag of the
OPTITEM to which <B>pOptItem</B>&nbsp;points, and saves the new default(s) for
future <B>Undo</B>&nbsp;operation(s) that the user might perform. This action is
returned only in response to a <B>Reason</B>&nbsp;of CPSUICB_REASON_APPLYNOW.
</FONT></TABLE>
<H3>Comments</H3>
<P>
<B>_CPSUICALLBACK</B>&nbsp;is a caller-defined function. The caller sets the <B>pfnCallBack</B>
member of the <A HREF="cpsui_9.htm">COMPROPSHEETUI</A>&nbsp;structure to
point to its <B>_CPSUICALLBACK</B>&nbsp;function, and passes the structure to <B><A HREF="cpsui_5.htm">PFNCOMPROPSHEET</A></B>
with the CPSFUNC_ADD_PCOMPROPSHEETUI function index.
<P>
The CPSUI calls <B>_CPSUICALLBACK</B>&nbsp;so that the CPSUI-caller can respond to
option item change(s) made by the user. This call occurs when the user selects
<B>OK</B>&nbsp;or <B>Apply</B>&nbsp;on the property sheet page after changing one or
more options. <B>_CPSUICALLBACK</B>&nbsp;should record the results of the change
and return the appropriate action to the CPSUI. The CPSUI does not call <B>_CPSUICALLBACK</B>
if no changes are made or if the user selects <B>Cancel</B>&nbsp;on the property
sheet page.
<H3>See Also</H3>
<P>
<A HREF="cpsui_9.htm">COMPROPSHEETUI</A>, <A HREF="cpsui_10.htm">CPSUICBPARAM</A>,
<B><A HREF="cpsui_5.htm">PFNCOMPROPSHEET</A></B>&nbsp;
<P></FONT>
</BODY>
</HTML>
