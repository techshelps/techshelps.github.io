<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GDI Support for Palettes</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_GDI_Support_for_Palettes_GG"></A>GDI Support for Palettes</H3>
<P>
GDI can do most of the work with regard to palette management. When GDI calls <B><A HREF="grfncs_20.htm">DrvEnablePDEV</A></B>,
the driver returns its default palette to GDI as part of the DEVINFO
structure. The driver should create this palette with <B><A HREF="grfncs_74.htm">EngCreatePalette</A></B>.
<P>
A palette effectively maps 32-bit <I>color indexes</I>&nbsp;into 24-bit RGB color
values, which is the way GDI uses palettes. A driver specifies its palette so
GDI can determine how different color indexes are to appear on the device.
<P>
The driver need not deal with most palette operations and calculations as long
as it uses the <A HREF="grstrcts_35.htm">XLATEOBJ</A>&nbsp;provided by GDI.
<P>
If the device supports a modifiable palette, it should implement <B><A HREF="grfncs_48.htm">DrvSetPalette</A></B>.
GDI calls <B>DrvSetPalette</B>&nbsp;when an application changes the palette for a
device and passes the resulting new palette to the driver. The driver should
set its internal hardware palette to match the new palette as closely as
possible.
<P>
A palette can be defined for GDI in either of the two different formats listed
in the following table.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Palette Format</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Indexed
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
A color index is an index into an array of RGB values. The array can be small,
containing, for example, 16 color indexes; or large, containing, for example,
4096 color indexes or more.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Bit Fields
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Bit fields in the color index specify colors in terms of the amounts of R, G,
and B in each color. For example, 5 bits could be used for each, providing a
value between 0 and 31 for each color. The 5-bit value would be scaled up to
cover a range of 0 to 255 for each component when converting to RGB. (The
usual RGB representation itself is defined by bit fields.)
</FONT></TABLE>
<P>
GDI typically uses the palette mapping in reverse. That is, an application
specifies an RGB color for drawing and GDI must locate the color index that
causes the device to display that color. As indicated in the next table, GDI
provides two primary palette service functions for creating and deleting the
palette, as well as some service functions related to the PALOBJ and the <A HREF="grstrcts_35.htm">XLATEOBJ</A>
used to translate color indexes between two palettes.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Function</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="grfncs_74.htm">EngCreatePalette</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Creates a palette. The driver associates the palette with a device by
returning a handle to the palette in the <A HREF="grstrcts_6.htm">DEVINFO</A>
structure.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="grfncs_82.htm">EngDeletePalette</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Deletes the given palette.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="grfncs_171.htm">PALOBJ_cGetColors</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Allows a driver to download RGB colors from an indexed palette. Called by the
display driver in <B><A HREF="grfncs_48.htm">DrvSetPalette</A></B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="grfncs_192.htm">XLATEOBJ_iXlate</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Translates a single source color index to a destination color index.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="grfncs_193.htm">XLATEOBJ_piVector</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Retrieves a translation vector from an indexed source palette. The driver can
use this vector to perform its own translation of the source indexes to
destination indexes.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="grfncs_191.htm">XLATEOBJ_cGetPalette</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Retrieves the 24-bit RGB value for the colors in an indexed source palette.
The driver can use this function to obtain information from the palette to
perform color blending.
</FONT></TABLE>
<P>
For more information on these functions, refer to the <I>Graphics Driver
Reference</I>.
<P></FONT>
</BODY>
</HTML>
