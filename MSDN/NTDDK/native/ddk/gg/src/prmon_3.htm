<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Port and Language Monitor Interaction</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_Port_and_Language_Monitor_Interaction_GG"></A>Port and Language Monitor Interaction</H2>
<P>
Figure 14.1 shows the path taken by printer data from the print processor to a
printer that <I>a)</I>&nbsp;has a language monitor associated with it; and <I>b)</I>
does not have a language monitor associated with it.
<P>
<IMG SRC="../art/mon1.gif" BORDER=0>
<P>
<B>Figure 14.1   Printing data flow (a) without a language monitor; (b) with a
language monitor.</B>
<P>
When a language monitor is associated with a printer driver during the
driver’s installation, all print data that flows from the printer driver to
the printer goes through the language monitor before being passed to the port
monitor. That is, all calls that the spooler makes to print a job go through a
language monitor if one is associated with the printer.
<P>
A language monitor should then make the appropriate calls to the port monitor
with which it is working. For example, a language monitor’s <B><A HREF="pmonfncs_18.htm">StartDocPort</A></B>
implementation might call the associated port monitor’s <B>StartDocPort</B>
implementation to do generic print job setup and then set up its own
language-specific job control information for the first port write.
<P>
Note that a language monitor never communicates directly with a printer port;
it relies on the port monitor to send and receive printer data for it. Note
also that, regardless of printer type, the print data stream should always be
handed to the printer’s port by a port monitor.
<P>
Language monitor writers should gracefully handle attempts to read from
printers and files that cannot be read back from. For example, a language
monitor written for a driver class that contains both bidirectional and
unidirectional printers should handle ill-fated read attempts on
unidirectional printers.
<P>
Because language monitors and port monitors are discrete architectural
components, it is possible for vendors of bidirectional printers to develop
only a language monitor and use an existing port monitor. Or, if vendors also
require special port monitor features that will only be used in conjunction
with their language monitor, they can develop a combined language monitor and
port monitor (LMPM). An LMPM can work with other port monitors.
<P></FONT>
</BODY>
</HTML>
