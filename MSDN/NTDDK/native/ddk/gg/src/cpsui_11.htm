<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DLGPAGE</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_DLGPAGE_GG"></A>DLGPAGE</H2>
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _DLGPAGE {
&nbsp; &nbsp; WORD              cbSize;
&nbsp; &nbsp; WORD              Flags;
&nbsp; &nbsp; DLGPROC           DlgProc;
&nbsp; &nbsp; LPTSTR            pTabName;
&nbsp; &nbsp; DWORD             IconID;
&nbsp; &nbsp; union {
&nbsp; &nbsp; &nbsp; &nbsp; WORD          DlgTemplateID;
&nbsp; &nbsp; &nbsp; &nbsp; HANDLE        hDlgTemplate;
&nbsp; &nbsp; };
} DLGPAGE, *PDLGPAGE;
</FONT></PRE>
<P>
The DLGPAGE structure describes the non-treeview property sheet page
characteristics.
<H3>Members</H3>
<DL>
<DT>
<B>cbSize</B>
<DD>
Size in bytes of this structure.
<BR>
<DT>
<B>Flags</B>
<DD>
Bitmask in which any combination of the following flags can be set.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Flag</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Description
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DPF_ICONID_AS_HICON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>IconID</B>&nbsp;is a handle to an icon rather than an icon resource ID.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DPF_USE_HDLGTEMPLATE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI should use the <B>hDlgTemplate</B>&nbsp;union member.
</FONT></TABLE>
<DT>
<B>DlgProc</B>
<DD>
Pointer to a caller-defined DLGPROC procedure that subclasses the page’s
dialog box processing.
<BR>
<DT>
<B>pTabName</B>
<DD>
Pointer to the null-terminated string to be displayed on the dialog box tab.
<BR>
<DT>
<B>IconID</B>
<DD>
Specifies the icon to display on the dialog box tab. This member can be a
standard IDI_CPSUI_<I>Xxx</I>&nbsp;icon ID, a caller-defined icon resource ID, or a
handle to a caller-defined icon if DPF_ICONID_AS_HICON is set in the <B>Flags</B>
field. A value of zero indicates that no icon should be displayed.
<BR>
<DT>
<B>DlgTemplateID</B>
<DD>
Specifies the ID of the template to use for the property sheet page dialog
box. The DP_STD_<I>Xxx</I>&nbsp;templates are 252x216 dialog box units in size.
This field can be user-defined, or can have one of the following values.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Value</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Description
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DP_STD_TREEVIEWPAGE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
This page is a standard treeview page provided by the CPSUI. The CPSUI
treeview page displays all valid OPTITEMs as a tree, and allows the user to
modify valid selectable OPTITEMs on the page.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DP_STD_DOCPROPPAGE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
This page is the standard<B>&nbsp;Document Properties</B>&nbsp;page provided by the
CPSUI.
</FONT></TABLE>
<P>
User-defined values must not conflict with system-supplied ones.
<BR>
<DT>
<B>hDlgTemplate</B>
<DD>
Handle to the DLGTEMPLATE structure that describes the property sheet page
dialog box. The CPSUI uses this handle to display the dialog box.
</DL>
<H3>Comments</H3>
<P>
If <B>DlgProc</B>&nbsp;is not null and <B>DlgTemplateID</B>&nbsp;is not DP_STD_<I>Xxx</I>,
the CPSUI processes messages as shown in the following table.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Message</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
WM_INITDIALOG
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI initializes the dialog box and then calls the function to which <B>DlgProc</B>
points with the WM_INITDIALOG message. The <B>DlgProc</B>&nbsp;function should
return the behavior expected for this message; see the Win32 SDK<I>&nbsp;</I>for
details.
<P>
The <B>lParam</B>&nbsp;member of WM_INITDIALOG is a pointer to a Win32
PROPSHEETPAGE structure. The <B>lParam</B>&nbsp;field of the PROPSHEETPAGE
structure is the <B>UserData</B>&nbsp;field of the <A HREF="cpsui_9.htm">COMPROPSHEETUI</A>
structure.
<P>
To access the <A HREF="cpsui_22.htm">PSPINFO</A>&nbsp;structure associated with this
property sheet page, the caller’s <B>DlgProc</B>&nbsp;function should use the
CPSUI-defined PPSPINFO_FROM_WM_INITDIALOG_LPARAM(<B>lParam</B>) macro, where <B>lParam</B>
is the parameter passed to the WM_INITDIALOG message. The caller’s subclass
function should save the pointer to the PSPINFO structure for later use. It
must not modify the contents of the PSPINFO structure.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
All Other Dialog Messages
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
If the value returned by the <B>DlgProc</B>&nbsp;function is non-zero, the CPSUI
assumes that the <B>DlgProc</B>&nbsp;function has processed the message entirely.
If the value returned is zero, the CPSUI processes the message.
</FONT></TABLE>
<P>
Each <A HREF="cpsui_16.htm">OPTITEM</A>&nbsp;corresponds to one input control with
one extended check box or extended push button. Because the CPSUI
automatically disables and removes from the property sheet those items with
the OPTIF_HIDE flag set, and dynamically moves the remaining controls, the
following tips for designing the dialog box controls should be followed:
<UL>
<LI>
Each item should have one input control with an optional extended check box or
extended push button, one icon control, and other static controls.
<P>
<LI>
Each item should occupy the entire horizontal space of the property sheet
page. Items should not overlay each other in the vertical direction.
<P>
<LI>
For items whose option type is TVOT_2STATES or TVOT_3STATES, if the option
buttons are arranged from left to right in state order, the option buttons and
icons should be aligned on the X axis. If the option buttons are arranged from
top to bottom in state order, the option buttons and icons should be aligned
on the Y axis.
<P>
<LI>
If option buttons and icons are arranged top to bottom in order and there are
other controls obscured in Y direction, the CPSUI rearranges the option
buttons but does not remove any white space in the Y direction.
<P>
<LI>
If multiple items share one group box, the group box must belong to the first <A HREF="cpsui_16.htm">OPTITEM</A>,
which is the topmost item in the group box. The caller must design the group
box to be large enough to contain all items associated with it.
</UL>
<P></FONT>
</BODY>
</HTML>
