<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OPTPARAM</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_OPTPARAM_GG"></A>OPTPARAM</H2>
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _OPTPARAM {
&nbsp; &nbsp; WORD          cbSize;
&nbsp; &nbsp; BYTE          Flags;
&nbsp; &nbsp; BYTE          Style;
&nbsp; &nbsp; LPTSTR        pData;
&nbsp; &nbsp; DWORD         IconID;
&nbsp; &nbsp; LONG          lParam;
&nbsp; &nbsp; DWORD         dwReserved[2];
} OPTPARAM, *POPTPARAM;
</FONT></PRE>
<P>
The OPTPARAM structure is used to describe each selectable entry in an option
item’s list of selections.
<H3>Members</H3>
<DL>
<DT>
<B>cbSize</B>
<DD>
Size in bytes of this structure.
<BR>
<DT>
<B>Flags</B>
<DD>
Bitmask in which the caller can return a bitwise OR of any of the following
flags.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Flag</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTPF_HIDE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
This selection is hidden from the user.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTPF_DISABLED
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
This selection is not available for a user to select. 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTPF_ICONID_AS_HICON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI interprets the <B>IconID</B>&nbsp;member as a handle to an icon rather
than as a resource ID.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTPF_OVERLAY_WARNING_ICON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI overlays its IDI_CPSUI_WARNING icon on the icon associated with this
selection.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTPF_OVERLAY_STOP_ICON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI overlays its IDI_CPSUI_STOP icon on the icon associated with this
selection.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTPF_OVERLAY_NO_ICON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI overlays its IDI_CPSUI_NO icon on the icon associated with this
selection.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTPF_USE_HDLGTEMPLATE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>lParam</B>&nbsp;member is a handle to a DLGTEMPLATE structure supplied by
the original caller.
</FONT></TABLE>
<DT>
<B>Style</B>
<DD>
Specifies the action to be performed on this item if it is selected. The <B>pData</B>
and <B>lParam</B>&nbsp;fields depend on the value of <B>Style</B>. This member is
valid only when the treeview option type is TVOT_PUSH BUTTON, and can be one
of the following values.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Value</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PUSH BUTTON_TYPE_DLGPROC
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
This push button causes the CPSUI to display a caller-specified dialog box.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PUSH BUTTON_TYPE_CALLBACK
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
This push button requires that the caller process the option item.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PUSH BUTTON_TYPE_HTCLRADJ
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
This push button causes the CPSUI to display a halftone color adjustment
dialog box.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PUSH BUTTON_TYPE_HTSETUP
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
This push button causes the CPSUI to display a device halftone setup dialog
box.
</FONT></TABLE>
<DT>
<B>pData</B>
<DD>
Pointer to data whose interpretation depends on the <B>Type</B>&nbsp;field of the
associated <A HREF="cpsui_18.htm">OPTTYPE</A>&nbsp;structure. For each OPTPARAM in
the array to which the <B>pOptParam</B>&nbsp;member of OPTYPE points, <B>pData</B>
has the following value:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Type</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_2STATES
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>pOptParam[0]-&gt;pData</B>&nbsp;points to the text string that describes State 1.<BR>
<B>pOptParam[1]-&gt;pData</B>&nbsp;points to the string that describes State 2.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_3STATES
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>pOptParam[0]-&gt;pData</B>&nbsp;points to the text string that describes State 1.<BR>
<B>pOptParam[1]-&gt;pData</B>&nbsp;points to the text string that describes State 2.<BR>
<B>pOptParam[2]-&gt;pData</B>&nbsp;points to the text string that describes State
3.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_UDARROW
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>pOptParam[0]-&gt;pData</B>&nbsp;points to the text string for the selection
postfix and icons.
<P>
<B>pOptParam[1]-&gt;pData</B>&nbsp;points to the help line text above the control.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_TRACKBAR<BR>
TVOT_SCROLLBAR
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>pOptParam[0]-&gt;pData</B>&nbsp;points to the text string for the selection postfix and icons.<BR>
<B>pOptParam[1]-&gt;pData</B>&nbsp;points to the low range of the
trackbar/scrollbar control. This value must be in the range of a 16-bit signed
integer.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_LISTBOX<BR>
TVOT_COMBOBOX
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>pOptParam[0]-&gt;pData</B>&nbsp;points to the text string for the first OPTPARAM.<BR>
<B>pOptParam[1]-&gt;pData</B>&nbsp;points to the text string for the second OPTPARAM.<BR>
…<BR>
<B>pOptParam[n-1]-&gt;pData</B>&nbsp;points to the text string for the <I>nth</I>
OPTPARAM.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_EDITBOX
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>pOptParam[0]-&gt;pData</B>&nbsp;points to the text string for the selection postfix and icons.<BR>
<B>pOptParam[1]-&gt;pData</B>&nbsp;points to the help line text above the control. 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_PUSH BUTTON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Depends on the value of <B>Style</B>. See the <B>Comments</B>&nbsp;section for
details.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_CHKBOX
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>pOptParam[0]-&gt;pData</B>&nbsp;points to the text string for the OPTPARAM.
</FONT></TABLE>
<DT>
<B>IconID</B>
<DD>
Identifies the icon to be associated with this selectable option item entry.
This field can be a standard IDI_CPSUI_<I>Xxx</I>&nbsp;icon ID, a caller’s icon
resource ID, or, if the OPTPF_ICONID_AS_HICON bit is set in <B>Flags</B>, a
handle to a caller-defined icon. If <B>IconID</B>&nbsp;is zero, the selectable
entry does not have an icon associated with it.
<BR>
<DT>
<B>lParam</B>
<DD>
The value of this field depends on the TVOT_<I>Xxx</I>&nbsp;type specified in the <B>Type</B>
field of the OPTTYPE structure of which this OPTPARAM structure is a member,
and is described in the following table.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Type</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_2STATES
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI ignores <B>lParam</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_3STATES
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI ignores <B>lParam</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_UDARROW
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Specifies the high range of the up-down control. This value must be in the
range of a 16-bit signed integer.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_TRACKBAR<BR>
TVOT_SCROLLBAR
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Specifies the high range of the trackbar/scrollbar control. This value must be
in the range of a 16-bit signed integer.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_LISTBOX<BR>
TVOT_COMBOBOX
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI ignored <B>lParam</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_EDITBOX
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI ignored <B>lParam</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_PUSH BUTTON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Depends on the value of <B>Style</B>. See the <B>Comments</B>&nbsp;section for
details.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
TVOT_CHKBOX
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI ignored <B>lParam</B>.
</FONT></TABLE>
<DT>
<B>dwReserved[2]</B>
<DD>
Reserved; these fields must be set to zero.
</DL>
<H3>Comments</H3>
<P>
The OPTPARAM structure is used to describe each selectable entry in an option
item’s list of selections.
<P>
When the caller has set the OPTPF_HIDE flag, the CPSUI does not display this
selection in the selection list on the property sheet. If all of the
selectable items associated with an option item are marked as hidden, then the
CPSUI automatically hides the entire option item.
<P>
The OPTPF_HIDE flag is valid only when the treeview option type is one of
TVOT_3STATES, TVOT_LISTBOX, or TVOT_COMBOBOX. If the <B>Type</B>&nbsp;field of an
option item’s OPTTYPE structure is TVOT_3STATES and only two of the three
states are specified as hidden, the CPSUI does not add the page and returns an
error condition.
<P>
When the caller has set the OPTPF_DISABLED flag, the CPSUI displays this
selection, but does not allow a user to select it. This flag is valid only
when the treeview option type is one of TVOT_2STATES, TVOT_3STATES,
TVOT_LISTBOX, or TVOT_COMBOBOX.
<P>
When the <B>Type</B>&nbsp;field of the associated <A HREF="cpsui_18.htm">OPTTYPE</A>
structure is TVOT_PUSH BUTTON, the <B>pData</B>&nbsp;and <B>lParam</B>&nbsp;fields
depend on the value of <B>Style</B>, and are interpreted as shown in the
following table.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Style</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>pData </B>and<B>&nbsp;lParam</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PUSH BUTTON_<BR>
TYPE_DLGPROC
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>pData</B>&nbsp;field is a pointer to the caller’s dialog box function; the <B>lParam</B>
field specifies the caller’s DIALOG resource template ID or DLGTEMPLATE
handle, depending on the OPTPF_USE_HDLGTEMPLATE flag.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PUSH BUTTON_<BR>
TYPE_CALLBACK
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>pData</B>&nbsp;field is a pointer to a callback of type <A HREF="cpsui_3.htm">_CPSUICALLBACK</A>;
the <B>lParam</B>&nbsp;field is not used.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PUSH BUTTON_<BR>
TYPE_HTCLRADJ
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>pData</B>&nbsp;field is a pointer to a COLORADJUSTMENT structure; the <B>lParam</B>
field is not used.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
PUSH BUTTON_<BR>
TYPE_HTSETUP
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>pData</B>&nbsp;field is a pointer to a DEVHTADJDATA structure; the <B>lParam</B>
field is not used.
</FONT></TABLE>
<P>
The <B>pData</B>&nbsp;field must be supplied when <B>Type</B>&nbsp;is TVOT_CHKBOX and <B>Style</B>
is one of CHKBOXS_FALSE_PDATA, CHKBOXS_NO_PDATA, CHKBOXS_OFF_PDATA, or
CHKBOXS_NONE_PDATA.
<P>
If the treeview option type is not TVOT_PUSH BUTTON, the<B>&nbsp;pData</B>&nbsp;field is
either a pointer to a null-terminated string that describes the selectable
option item entry, or an integer value that specifies a string resource
identifier. If <B>pData</B>&nbsp;specifies a resource identifier, its high-order
word must be zero and its low-order word must contain the identifier.
<P>
When using resource IDs, the caller should use the standard IDS_CPSUI_<I>Xxx</I>
values as often as possible for user interface consistency.
<P></FONT>
</BODY>
</HTML>
