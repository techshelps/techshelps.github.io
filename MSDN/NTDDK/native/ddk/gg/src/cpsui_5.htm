<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PFNCOMPROPSHEET</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_PFNCOMPROPSHEET_GG"></A>PFNCOMPROPSHEET</H2>
<P>
<B>DWORD ( CALLBACK *PFNCOMPROPSHEET)(</B>
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>HANDLE  </B><I>hComPropSheet</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>UINT  </B><I>Function</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>LPARAM  </B><I>lParam1</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>LPARAM  </B><I>lParam2</I>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>&nbsp; &nbsp;);</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT></TABLE>
<P>
<B>PFNCOMPROPSHEET</B>&nbsp;is a CPSUI-defined callback that is called by the
caller’s <B><A HREF="cpsui_6.htm">PFNPROPSHEETUI</A></B>&nbsp;callback to
perform an action on a property sheet.
<H3>Parameters</H3>
<DL>
<DT>
<I>hComPropSheet</I>
<DD>
Handle to the CPSUI object on which action is to be performed. This handle is
created by the CPSUI, and must be the handle passed from the CPSUI when it
called the caller-supplied <B>PFNPROPSHEETUI</B>&nbsp;callback.
<BR>
<DT>
<I>Function</I>
<DD>
Specifies the action to be performed by the CPSUI’s <B>PFNCOMPROPSHEET</B>
callback. This value can be one of the CPSFUNC_<I>Xxx</I>&nbsp;definitions. See the
<B>Comments</B>&nbsp;section for details.
<BR>
<DT>
<I>lParam1</I>
<DD>
Data required by the CPSUI to process the specified action. The CPSUI’s
interpretation of <I>lParam1</I>&nbsp;depends on <I>Function</I>. See the <B>Comments</B>
section for details.
<BR>
<DT>
<I>lParam2</I>
<DD>
Data required by the CPSUI to process the specified action. The CPSUI’s
interpretation of <I>lParam2</I>&nbsp;depends on <I>Function</I>. See the <B>Comments</B>
section for details.
</DL>
<H3>Return Value</H3>
<P>
The value returned by <B>PFNCOMPROPSHEET</B>&nbsp;depends on <I>Function</I>. See
the <B>Comments</B>&nbsp;section for details.
<H3>Comments</H3>
<P>
The caller’s <B><A HREF="cpsui_6.htm">PFNPROPSHEETUI</A></B>&nbsp;calls <B>PFNCOMPROPSHEET</B>
to perform an action on the property sheet page(s) identified by <I>hComPropSheet</I>.
The action is specified by <I>Function</I>.
<P>
The <I>lParam1</I>&nbsp;and <I>lParam2</I>&nbsp;parameters and <B>PFNCOMPROPSHEET</B>’s
return value all depend on the value of <I>Function</I>, and are summarized in
the following topics.
<H3><A NAME="DDK_CPSFUNC_ADD_HPROPSHEETPAGE_GG"></A>CPSFUNC_ADD_HPROPSHEETPAGE</H3>
<P>
Adds a page to the CPSUI object identified by <I>hComPropSheet</I>&nbsp;using a
handle to a PROPSHEETPAGE structure. The caller obtains a PROPSHEETPAGE handle
by calling the Win32 <B>CreatePropertySheetPage</B>&nbsp;function.
<P>
<I>lParam1</I>&nbsp;is a handle to the PROPSHEETPAGE structure to be used by CPSUI
to add the page.
<P>
<I>lParam2</I>&nbsp;is not used, and must be set to zero.
<P>
<B>PFNCOMPROPSHEET</B>&nbsp;returns a handle to the newly added page if it
succeeds; otherwise, it returns null.
<H3><A NAME="DDK_CPSFUNC_ADD_PROPSHEETPAGE_GG"></A>CPSFUNC_ADD_PROPSHEETPAGE</H3>
<P>
Adds a page to the CPSUI object identified by <I>hComPropSheet</I>&nbsp;using a
PROPSHEETPAGE structure.
<P>
<I>lParam1</I>&nbsp;is a pointer to a <B>PROPSHEETPAGE</B>&nbsp;structure.
<P>
<I>lParam2</I>&nbsp;is not used and must be set to zero.
<P>
<B>PFNCOMPROPSHEET</B>&nbsp;returns a handle to the newly added page if it
succeeds; it returns null if it fails.
<H3><A NAME="DDK_CPSFUNC_ADD_PCOMPROPSHEETUI_GG"></A>CPSFUNC_ADD_PCOMPROPSHEETUI</H3>
<P>
Adds one or more pages to the CPSUI object identified by <I>hComPropSheet</I>
using the <A HREF="cpsui_9.htm">COMPROPSHEETUI</A>&nbsp;data structure.
<P>
<I>lParam1</I>&nbsp;is a pointer to the COMPROPSHEETUI structure to be used by
CPSUI to add the page(s).
<P>
<I>lParam2</I>&nbsp;is a pointer to a 32-bit location in which the CPSUI returns
the number of pages added when it succeeds, or ERR_CPSUI_<I>Xxx</I>&nbsp;if it
fails.
<P>
PFNCOMPROPSHEET returns a handle to the newly added page(s) if it succeeds;
otherwise, it returns null.
<H3><A NAME="DDK_CPSFUNC_ADD_PFNPROPSHEETUI_GG"></A>CPSFUNC_ADD_PFNPROPSHEETUI</H3>
<DL>
<DT>
Adds the function to which <I>lParam1</I>&nbsp;points to the CPSUI object
identified by <I>hComPropSheet</I>. The CPSUI calls this function to add
page(s) to the property sheet as follows:
<DD>
<PRE><FONT FACE="Courier" SIZE="2">PROPSHEETUI_INFO            PSUIInfo;
PSUIInfo.cbSize             = sizeof(PROPSHEETUI_INFO);
PSUIInfo.Version            = PROPSHEETUI_INFO_VERSION;
PSUIInfo.Flags              = (Ansi) ? 0 : PSUIINFO_UNICODE;
PSUIInfo.Reason             = PROPSHEETUI_REASON_INIT;
PSUIInfo.hComPropSheet&#09;      = <I>hComPropSheet</I>;
PSUIInfo.pfnComPropSheet    = ComPropSheetUICallBack;
PSUIInfo.lParamInit         = <I>lParam2</I>;
PSUIInfo.UserData           = 0;
PSUIInfo.Result             = 0;
((PFNPROPSHEETUI)<I>lParam1</I>)(&amp;PSUIInfo, <I>lParam2</I>);
</FONT></PRE>
</DL>
<P>
<I>lParam1</I>&nbsp;is a pointer to a <B><A HREF="cpsui_6.htm">PFNPROPSHEETUI</A></B>
callback that is called to add the property sheet page(s). This function’s
implementation must use the <I>hComPropSheet</I>&nbsp;parameter as its handle when
it calls back to the CPSUI’s <B>PFNCOMPROPSHEET</B>&nbsp;callback to add/delete
pages.
<P>
<I>lParam2</I>&nbsp;is a 32-bit data field that is passed to <B>PFNPROPSHEETUI</B>
as the <I>lParam</I>&nbsp;parameter.
<P>
<B>PFNCOMPROPSHEET</B>&nbsp;returns a handle to the newly added property sheet
page(s) if it succeeds; it returns null if it fails or no pages were added.
<H3><A NAME="DDK_CPSFUNC_DELETE_HCOMPROPSHEET_GG"></A>CPSFUNC_DELETE_HCOMPROPSHEET</H3>
<P>
Deletes the child page(s) from the parent CPSUI object using the passed child
handle. The parent is identified by <I>hComPropSheet</I>.
<P>
<I>lParam1</I>&nbsp;is a handle to the child page(s) to be deleted. This handle
must previously have been returned from an executed CPSFUNC_ADD_<I>Xxx</I>&nbsp;or
CPSFUNC_INSERT_<I>Xxx</I>&nbsp;function.
<P>
<I>lParam2</I>&nbsp;is not used and must be set to zero.
<P>
<B>PFNCOMPROPSHEET</B>&nbsp;returns a value greater than zero if it succeeds; it
returns a value less than or equal to zero if it fails.
<H3><A NAME="DDK_CPSFUNC_SET_HSTARTPAGE_GG"></A>CPSFUNC_SET_HSTARTPAGE</H3>
<P>
Marks the page(s) identified by <I>hComPropSheet</I>&nbsp;as the initial page(s) of
the property sheet. The caller can call <B>PFNCOMPROPSHEET</B>&nbsp;with this
function index both before and after the property sheet is displayed. If it is
called after the initial display, the CPSUI switches the top (displayed)
property sheet page with the first page of the marked page(s) on top.
<P>
<I>lParam1</I>&nbsp;is a handle to the page(s) to be marked as those page(s) that
the CPSUI displays first on the property sheet when it displays the property
sheet dialog boxes. This handle must have been returned from an executed
CPSFUNC_ADD_<I>Xxx</I>&nbsp;or CPSFUNC_INSERT_<I>Xxx</I>&nbsp;function.
<P>
<I>lParam2</I>&nbsp;is an index to the exact page to be displayed first. If <I>lParam1</I>
is a parent handle, <I>lParam2</I>&nbsp;is a zero-based index to the child page
that should be marked as first. This parameter can also be one of the
following special indexes if the handle identified by <I>lParam1</I>&nbsp;was added
by the CPSFUNC_ADD_PCOMPROPSHEETUI function.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Value</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Description
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SSP_TVPAGE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Mark the specified page as the treeview page.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SSP_STDPAGE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Mark the specified page as the <B>Page Setup</B>&nbsp;document property sheet page.
</FONT></TABLE>
<P>
The SSP_<I>Xxx</I>&nbsp;values apply only to property sheet requests that
originated in a call to the Win32 <B>DocumentPropertySheet</B>&nbsp;function.
<P>
PFNCOMPROPSHEET returns a value greater than zero if it succeeds; it returns a
value less than or equal to zero if it fails.
<H3><A NAME="DDK_CPSFUNC_GET_PAGECOUNT_GG"></A>CPSFUNC_GET_PAGECOUNT</H3>
<P>
Returns the number of pages that belong to the CPSUI object identified by <I>hComPropSheet</I>.
<P>
<I>lParam1</I>&nbsp;is not used and must be set to zero.
<P>
<I>lParam2</I>&nbsp;is not used and must be set to zero.
<P>
PFNCOMPROPSHEET returns the page count if it succeeds; it returns zero if it
fails. There are never zero pages.
<H3><A NAME="DDK_CPSFUNC_GET_HPSUIPAGES_GG"></A>CPSFUNC_GET_HPSUIPAGES</H3>
<DL>
<DT>
Returns an array of handles to PROPSHEETPAGE structures. These handles
identify the children that belong to the parent CPSUI object identified by <I>hComPropSheet</I>.
To obtain all of the children’s handles, the caller should call <B>PFNCOMPROPSHEET</B>
as follows:
<DD>
<PRE><FONT FACE="Courier" SIZE="2">if (((cPage = PFNCOMPROPSHEET(<I>hComPropSheet</I>,
CPSFUNC_GET_PAGECOUNT, 0L, 0L)) &gt; 0) &amp;&amp;
((phPage = ALLOCMEM(cPage * sizeof(HANDLE))) != NULL) {
PFNCOMPROPSHEET(<I>hComPropSheet</I>, CPSFUNC_GET_HPSUIPAGES,
&nbsp; &nbsp; &nbsp; &nbsp; (LPARAM)phPage, (LPARAM)cPage);
}
</FONT></PRE>
</DL>
<P>
<I>lParam1</I>&nbsp;is a pointer to an array in which the CPSUI writes the
children’s handles.
<P>
<I>lParam2</I>&nbsp;specifies the number of handles that can be stored in the array
to which <I>lParam1</I>&nbsp;points.
<P>
<B>PFNCOMPROPSHEET</B>&nbsp;returns the number of handles stored in <I>lParam1 </I>if
it succeeds; it returns a value less than or equal to zero if it fails.
<H3><A NAME="DDK_CPSFUNC_SET_RESULT_GG"></A>CPSFUNC_SET_RESULT</H3>
<P>
Propagates up the result of the property sheet page to the parent that added
it through a CPSFUNC_ADD_<I>Xxx</I>&nbsp;function.
<P>
<I>lParam1</I>&nbsp;is a handle to the page that is setting the result. If <I>lParam1</I>
is null, the CPSUI uses <I>hComPropSheet</I>.
<P>
<I>lParam2</I>&nbsp;specifies the 32-bit DWORD result to be set.
<P>
Upon success, <B>PFNCOMPROPSHEET</B>&nbsp;returns the number of parents for which
the result was set, or returns zero if the page identified by <I>lParam1</I>
has no parent. It returns a value less than zero if it fails because <I>lParam1</I>
is an invalid handle. The CPSUI propagates the result to the root handle.
<H3><A NAME="DDK_CPSFUNC_LOAD_CPSUI_STRING_GG"></A>CPSFUNC_LOAD_CPSUI_STRING</H3>
<P>
Loads the CPSUI resource string identified by the resource ID in the high word
of <I>lParam2</I>.
<P>
<I>lParam1</I>&nbsp;is a pointer to a null-terminated string of type LPTSTR in
which the CPSUI loads the resource string from the CPSUI’s DLL.
<P>
<I>lParam2</I>&nbsp;specifies the following two values.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>WORD</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Description
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
LOWORD(<I>lParam2</I>)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Number of characters, including the null terminator, in the string to which <I>lParam1</I>
points.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
HIWORD(<I>lParam2</I>)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Specifies the resource ID of the string to be loaded. This value is one of the
predefined IDS_CPSUI_<I>Xxx</I>&nbsp;string resource ID definitions.
</FONT></TABLE>
<P>
<B>PFNCOMPROPSHEET</B>&nbsp;returns the number of characters stored in the string
to which <I>lParam1</I>&nbsp;points upon success; this does not include the null
terminator. It returns zero when an invalid IDS_CPSUI_<I>Xxx</I>&nbsp;string
resource ID is passed in the high word of <I>lParam2</I>. It returns a value
less than zero when <I>lParam1</I>&nbsp;is null or when the low word of <I>lParam2</I>
is zero.
<H3><A NAME="DDK_CPSFUNC_LOAD_CPSUI_ICON_GG"></A>CPSFUNC_LOAD_CPSUI_ICON</H3>
<P>
Loads the CPSUI resource icon identified by <I>lParam1</I>.
<P>
<I>lParam1</I>&nbsp;specifies the resource ID of the icon to be loaded. This value
is one of the predefined IDI_CPSUI_<I>Xxx</I>&nbsp;icon resource ID definitions.
<P>
<I>lParam2</I>&nbsp;specifies the following two values.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>WORD</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Description
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
LOWORD(<I>lParam2</I>)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Specifies the icon width in pixels. If this value is zero, the CPSUI uses
SM_CXICON.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
HIWORD(<I>lParam2</I>)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Specifies the icon height in pixels. If this value is zero, the CPSUI uses
SM_CYICON.
</FONT></TABLE>
<P>
<B>PFNCOMPROPSHEET</B>&nbsp;returns a handle to the icon upon success, and null
when it fails. The caller must call the Win32 <B>DestroyIcon</B>&nbsp;function when
it no longer needs the icon.
<H3><A NAME="DDK_CPSFUNC_GET_PFNPROPSHEETUI_ICON_GG"></A>CPSFUNC_GET_PFNPROPSHEETUI_ICON</H3>
<P>
Returns the icon handle that represents the children page(s) specified by <I>lParam1</I>.
<P>
<I>lParam1</I>&nbsp;is a handle to the page(s) whose icon handle is to be queried.
This handle must have been returned from a call to <B>PFNCOMPROPSHEET</B>&nbsp;with
a CPSFUNC_ADD_PFNPROPSHEETUI function.
<P>
<I>lParam2</I>&nbsp;specifies the following two values.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>WORD</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Description
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
LOWORD(<I>lParam2</I>)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Specifies the icon width in pixels. If this value is zero, the CPSUI uses
SM_CXICON.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
HIWORD(<I>lParam2</I>)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Specifies the icon height in pixels. If this value is zero, the CPSUI uses
SM_CYICON.
</FONT></TABLE>
<P>
<B>PFNCOMPROPSHEET</B>&nbsp;returns a handle to the icon when it succeeds; it
returns a null handle when it fails. The caller is responsible for calling the
Win32 <B>DestroyIcon</B>&nbsp;function when it no longer needs the icon identified
by the returned icon handle.
<H3><A NAME="DDK_CPSFUNC_INSERT_PSUIPAGE_GG"></A>CPSFUNC_INSERT_PSUIPAGE</H3>
<P>
Inserts property sheet page(s) at the position specified in <I>lParam2</I>.
The CPSUI object identified by <I>hComPropSheet</I>&nbsp;must be the parent handle.
<P>
<I>lParam1</I>&nbsp;specifies a handle to the CPSUI object by which the page(s) are
inserted. This handle must have been returned from a call to <B>PFNCOMPROPSHEET</B>
with a CPSFUNC_ADD_<I>Xxx</I>&nbsp;function, or with a CPSFUNC_INSERT_PSUIPAGE.
<P>
<I>lParam2</I>&nbsp;is a pointer to an <A HREF="cpsui_14.htm">INSERTPSUIPAGE_INFO</A>
structure.
<P>
<B>PFNCOMPROPSHEET</B>&nbsp;returns a handle to the newly added property sheet
page(s) upon success; it returns null when it fails.
<H3><A NAME="DDK_CPSFUNC_SET_PSUIPAGE_TITLE_GG"></A>CPSFUNC_SET_PSUIPAGE_TITLE</H3>
<P>
Sets the tab title for a property sheet page.
<P>
<I>lParam1</I>&nbsp;is a handle to the property sheet page whose title is to be
set. This handle must have been returned from a call to <B>PFNCOMPROPSHEET</B>
with a function of CPSFUNC_ADD_PROPSHEETPAGE, CPSFUNC_ADD_HPROPSHEETPAGE, or
CPSFUNC_INSERT_PSUIPAGE with the <B>Type</B>&nbsp;field of the INSERTPSUIPAGE_INFO
structure set to PSUIPAGEINSERT_PROPSHEETPAGE or
PSUIPAGEINSERT_HPROPSHEETPAGE.
<P>
<I>lParam2</I>&nbsp;is a pointer to a null-terminated string that specifies the new
title.
<P>
<B>PFNCOMPROPSHEET</B>&nbsp;returns a value greater than zero upon success; it
returns a value less than or equal to zero if it fails. This function returns
zero if the property sheet page is not currently displayed.
<H3><A NAME="DDK_CPSFUNC_SET_PSUIPAGE_ICON_GG"></A>CPSFUNC_SET_PSUIPAGE_ICON</H3>
<P>
Sets a new icon for display on a property sheet page’s tab.
<P>
<I>lParam1</I>&nbsp;specifies a handle to the page with which the icon is to be
associated. This handle must previously have been returned from a call to <B>PFNCOMPROPSHEET</B>
with a function of CPSFUNC_ADD_PROPSHEETPAGE, CPSFUNC_ADD_HPROPSHEETPAGE, or
CPSFUNC_INSERT_PSUIPAGE with the <B>Type</B>&nbsp;field of the INSERTPSUIPAGE_INFO
structure set to PSUIPAGEINSERT_PROPSHEETPAGE or
PSUIPAGEINSERT_HPROPSHEETPAGE.
<P>
<I>lParam2</I>&nbsp;is a handle to the icon. The CPSUI stretches or shinks all
icons to be of size 16x16 pixels.
<P>
<B>PFNCOMPROPSHEET</B>&nbsp;returns a value greater than zero upon success; it
returns a value less than or equal to zero if it fails. This function returns
zero if the property sheet page is not currently displayed.
<P>
If the icon was originally created through a call to the Win32 <B>CreateIcon</B>
function, the caller is responsible for destroying the icon by calling the
Win32 <B>DestroyIcon</B>&nbsp;function. The caller need not destroy the icon if it
was created through a call to the Win32 <B>LoadIcon</B>&nbsp;function.
<P></FONT>
</BODY>
</HTML>
