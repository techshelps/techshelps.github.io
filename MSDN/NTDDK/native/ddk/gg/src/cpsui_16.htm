<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OPTITEM</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_OPTITEM_GG"></A>OPTITEM</H2>
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _OPTITEM {
&nbsp; &nbsp; WORD                  cbSize;
&nbsp; &nbsp; BYTE                  Level;
&nbsp; &nbsp; BYTE                  DlgPageIdx;
&nbsp; &nbsp; DWORD                 Flags;
&nbsp; &nbsp; DWORD                 UserData;
&nbsp; &nbsp; LPTSTR                pName;
&nbsp; &nbsp; union {
&nbsp; &nbsp; &nbsp; &nbsp; LONG              Sel;
&nbsp; &nbsp; &nbsp; &nbsp; LPTSTR            pSel;
&nbsp; &nbsp; };
&nbsp; &nbsp; union {
&nbsp; &nbsp; &nbsp; &nbsp; PEXTCHKBOX        pExtChkBox;
&nbsp; &nbsp; &nbsp; &nbsp; PEXTPUSH          pExtPush;
&nbsp; &nbsp; };
&nbsp; &nbsp; POPTTYPE              pOptType;
&nbsp; &nbsp; DWORD                 HelpIndex;
&nbsp; &nbsp; BYTE                  DMPubID;
&nbsp; &nbsp; BYTE                  UserItemID;
&nbsp; &nbsp; WORD                  wReserved;
&nbsp; &nbsp; POIEXT                pOIExt;
&nbsp; &nbsp; DWORD                 dwReserved[3];
} OPTITEM, *POPTITEM;
</FONT></PRE>
<P>
The OPTITEM structure is used to describe each item’s name, selection type,
and selectability in the dialog box view(s).
<H3>Members</H3>
<DL>
<DT>
<B>cbSize</B>
<DD>
Size in bytes of this structure.
<BR>
<DT>
<B>Level</B>
<DD>
Specifies the level of this item in the treeview. The root item should have
the lowest level, and numbering should start at zero. The maximum number of
levels is 256.
<BR>
<DT>
<B>DlgPageIdx</B>
<DD>
Specifies a zero-based index into the array of <A HREF="cpsui_11.htm">DLGPAGE</A>
structures pointed to by the <B>pDlgPage</B>&nbsp;member of the <A HREF="cpsui_9.htm">COMPROPSHEETUI</A>
structure. The maximum index possible is MAX_DLGPAGE_COUNT. The CPSUI sets <B>DlgPageIdx</B>
if <B>pDlgPage</B>&nbsp;is a standard CPSUI_PDLGPAGE_<I>Xxx</I>&nbsp;DLGPAGE.
<BR>
<DT>
<B>Flags</B>
<DD>
Specifies the flags to apply to the option item identified by this OPTITEM
structure. The OPTIF_CHANGEONCE flag is set by the CPSUI; all other flags are
set by the caller. Any combination of the following flags can be set in <B>Flags</B>.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Flag</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_COLLAPSE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Collapse this treeview item and its children so that it is not expanded
initially.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_HIDE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Hide this item from the treeview. The OPTIF_HIDE flag must be set before the
item is initially displayed; the CPSUI ignores this bit if it is set after the
item is displayed.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_CALLBACK
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI should call back to the caller-supplied <B><A HREF="cpsui_3.htm">_CPSUICALLBACK</A></B>
function when a user changes this item.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_CHANGED
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
This item has changed and needs to be redisplayed. The caller should set this
flag only when returning from its <B>_CPSUICALLBACK</B>&nbsp;callback.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_CHANGEONCE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
This item has been changed. The CPSUI sets this bit.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_DISABLED
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
This item is not selectable.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_ECB_CHECKED
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The associated extended check box is in the checked state.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_EXT_HIDE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Hide the extended check box or extended push button.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_EXT_DISABLED
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The extended check box or extended push button is not selectable.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_SEL_AS_HICON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>Sel</B>&nbsp;field contains a handle to an icon rather than an icon resource
ID. The CPSUI uses this flag only when <B>pOptType</B>&nbsp;is null.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_EXT_<BR>
IS_EXTPUSH
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI should use the <B>pExtPush</B>&nbsp;field if it is not null. By default,
if the union field contains a valid pointer and the OPTIF_EXT_IS_EXTPUSH bit
is not set, the CPSUI assumes that the pointer points to an EXTCHKBOX
structure.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_NO_<BR>
GROUPBOX_NAME
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI should not overwrite the group box’s title text if a group box ID is
defined.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_OVERLAY_<BR>
WARNING_ICON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI overlays its IDI_CPSUI_WARNING icon on the icon associated with this
option item.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_OVERLAY_<BR>
STOP_ICON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI overlays its IDI_CPSUI_STOP icon on the icon associated with this
option item.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_OVERLAY_<BR>
NO_ICON
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The CPSUI overlays its IDI_CPSUI_NO icon on the icon associated with this
option item.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_INITIAL_TVITEM
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
This item is the initial item to be selected and displayed on the treeview
page. The CPSUI expands tree tiers and scrolls the selection into view as
necessary. If this bit is not set or if the item is hidden, the CPSUI chooses
the initial item to display.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OPTIF_HAS_POIEXT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>pOIExt</B>&nbsp;field contains a valid pointer to an OIEXT structure. The
CPSUI uses the OIEXT structure only when this bit is set.
</FONT></TABLE>
<DT>
<B>UserData</B>
<DD>
Specifies a 32-bit value that is set and used by the caller. The CPSUI never
uses or modifies this member.
<BR>
<DT>
<B>pName</B>
<DD>
Pointer to a null-terminated string that specifies the name of this option
item. Alternatively, it is used as data as described in the <B>DMPubID</B>
member.
<BR>
<DT>
<B>Sel</B>
<DD>
Specifies the index number for this item’s current selection. If <B>pOptType</B>
is null, then this index number is the icon ID to be used for the
non-selectable header of child option items.
<BR>
<DT>
<B>pSel</B>
<DD>
Pointer to a null-terminated string that specifies the current selection for
this item.
<BR>
<DT>
<B>pExtChkBox</B>
<DD>
Pointer to the <A HREF="cpsui_12.htm">EXTCHKBOX</A>&nbsp;structure that describes
the extended check box associated with this item. If <B>pExtChkBox</B>&nbsp;is
null, then this item does not have a check box associated with it.
<P>
The caller must clear the OPTIF_EXT_IS_EXTPUSH flag to notify the CPSUI that
the option item has an extended check box associated with it. The
OPTIF_ECB_CHECKED flag specifies whether the extended check box is checked or
not checked.
<BR>
<DT>
<B>pExtPush</B>
<DD>
Pointer to the <A HREF="cpsui_13.htm">EXTPUSH</A>&nbsp;structure that describes the
extended push button associated with this item. If <B>pExtPush</B>&nbsp;is null,
then this item does not have a push button associated with it. The caller must
set the OPTIF_EXT_IS_EXTPUSH flag to notify the CPSUI that the option item has
an extended push button associated with it.
<BR>
<DT>
<B>pOptType</B>
<DD>
Pointer to an <A HREF="cpsui_18.htm">OPTTYPE</A>&nbsp;structure that describes the
display and selections of this item. This item has no selection(s) when <B>pOptType</B>
is null, so the CPSUI uses this item as the header for child items. When <B>pOptType</B>
is null, the icon ID is specified by <B>Sel</B>.
<BR>
<DT>
<B>HelpIndex</B>
<DD>
Specifies the index into the help file being used for context-sensitive help.
A value of zero indicates that help does not exist for this item.
<BR>
<DT>
<B>DMPubID</B>
<DD>
Specifies whether this item is one of the public fields in the <A HREF="grstrcts_7.htm">DEVMODE</A>
structure supported by the CPSUI. For consistency, the caller should set <B>pName</B>
to the standard CPSUI-defined resource ID for those DMPUB_<I>Xxx</I>&nbsp;values
that identify DEVMODE fields. This field can be one of the following values.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Value</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>DEVMODE Field and Recommended pName</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DMPUB_NONE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Not a public field of DEVMODE.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DMPUB_ORIENTATION
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>dmOrientation</B>&nbsp;field. Set <B>pName</B>&nbsp;to IDS_CPSUI_ORIENTATION.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DMPUB_SCALE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>dmScale</B>&nbsp;field. Set <B>pName</B>&nbsp;to IDS_CPSUI_SCALE.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DMPUB_COPIES_COLLATE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>dmCopies</B>&nbsp;/ <B>dmCollate</B>&nbsp;field. Set <B>pName</B>&nbsp;to
IDS_CPSUI_COPIES. 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DMPUB_DEFSOURCE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>dmDefSource</B>&nbsp;field. Set <B>pName</B>&nbsp;to IDS_CPSUI_SOURCE.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DMPUB_PRINTQUALITY
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>dmPrintQuality</B>&nbsp;field. Set <B>pName</B>&nbsp;to IDS_CPSUI_PRINTQUALITY or
IDS_CPSUI_RESOLUTION. If <B>pName</B>&nbsp;is not set to either of these values,
the CPSUI defaults it to IDS_CPSUI_RESOLUTION.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DMPUB_COLOR
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>dmColor</B>&nbsp;field. Set <B>pName</B>&nbsp;to IDS_CPSUI_COLOR_APPERANCE. 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DMPUB_DUPLEX
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>dmDuplex</B>&nbsp;field. Set <B>pName</B>&nbsp;to IDS_CPSUI_DUPLEX.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DMPUB_TTOPTION
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>dmTTOption</B>&nbsp;field. Set <B>pName</B>&nbsp;to IDS_CPSUI_TTOPTION.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DMPUB_FORMNAME
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>dmFormName</B>&nbsp;field. Set <B>pName</B>&nbsp;to IDS_CPSUI_FORMNAME.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DMPUB_ICMMETHOD
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>dmICMMethod</B>&nbsp;field. Set <B>pName</B>&nbsp;to IDS_CPSUI_ICMMETHOD.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DMPUB_ICMINTENT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>dmICMIntent</B>&nbsp;field. Set <B>pName</B>&nbsp;to IDS_CPSUI_ICMINTENT.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DMPUB_MEDIATYPE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>dmMediaType</B>&nbsp;field. Set <B>pName</B>&nbsp;to IDS_CPSUI_MEDIA.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DMPUB_DITHERTYPE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The <B>dmDitherType</B>&nbsp;field. Set <B>pName</B>&nbsp;to IDS_CPSUI_DITHERING.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Greater than or equal to DMPUB_USER
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Specifies a caller-defined value.
</FONT></TABLE>
<DT>
<B>UserItemID</B>
<DD>
Specifies a caller-defined byte ID. The caller can use <B>UserItemID</B>&nbsp;to
identify this item.
<BR>
<DT>
<B>wReserved</B>
<DD>
Reserved; this field must be set to zero.
<BR>
<DT>
<B>pOIExt</B>
<DD>
Pointer to an <A HREF="cpsui_15.htm">OIEXT</A>&nbsp;structure containing extended data
to describe this option item.
<BR>
<DT>
<B>dwReserved[3]</B>
<DD>
Reserved; these fields must be set to zero.
</DL>
<H3>Comments</H3>
<P>
The OPTITEM structure is used to describe each item’s name, selection type,
and selectability in the dialog box view(s).
<P>
When the CPSUI is called to construct and display the <B>Document Properties</B>
page, it automatically groups many of the DEVMODE’s public items together. The
grouping is CPSUI version-dependent, and cannot be altered by the caller.
<P>
When <B>DMPubID</B>&nbsp;is DMPUB_COPIES_COLLATE, the CPSUI does the following
before calling the <B><A HREF="cpsui_3.htm">_CPSUICALLBACK</A></B>
callback if the OPTIF_EXT_HIDE flag is not set and <B>pExtChkBox</B>&nbsp;is not
null:
<UL>
<LI>
Enable the <B>Collate Copies</B>&nbsp;extended check box when a user requests more
than one copy, and disable it when only one copy is requested.
<P>
<LI>
Set the item’s postfix to <B>copy</B>&nbsp;for one copy and <B>copies</B>&nbsp;for more
than one copy.
</UL>
<P>
When <B>DMPubID</B>&nbsp;is DMPUB_COLOR, the CPSUI does the following before
calling <B>_CPSUICALLBACK</B>&nbsp;if <B>Color</B>&nbsp;is selected over <B>Gray Scale</B>:
<UL>
<LI>
Calls the halftone color adjustment with the current color selection.
<P>
<LI>
Disables color matching when color is not selected.
</UL>
<P>
The CPSUI requires that <B>Gray Scale</B>&nbsp;be state 0 and <B>Color</B>&nbsp;be state
1.
<P></FONT>
</BODY>
</HTML>
