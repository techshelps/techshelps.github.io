<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CommonPropertySheetUI</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_CommonPropertySheetUI_GG"></A>CommonPropertySheetUI</H2>
<P>
<B>LONG CommonPropertySheetUI(</B>
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>HWND  </B><I>hWndOwner</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>PFNPROPSHEETUI  </B><I>pfnPropSheetUI</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>LPARAM  </B><I>lParam</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>LPDWORD  </B><I>pResult</I>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>&nbsp; &nbsp;);</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT></TABLE>
<P>
<B>CommonPropertySheetUI</B>&nbsp;manages and displays a property sheet.
<H3>Parameters</H3>
<DL>
<DT>
<I>hWndOwner</I>
<DD>
Window handle for the owner of the property sheet. This parameter can be null.
<BR>
<DT>
<I>pfnPropSheetUI</I>
<DD>
Pointer to a callback function of type PFNPROPSHEETUI.
<BR>
<DT>
<I>lParam</I>
<DD>
Specifies the parameter that is passed to the function to which <I>pfnPropSheetUI</I>
points when it is called by the CPSUI.
<BR>
<DT>
<I>pResult</I>
<DD>
Pointer to a DWORD that receives the final result of the function to which <I>pfnPropSheetUI</I>
points when it is called. Specifically, the <B>Result</B>&nbsp;field of the
PROPSHEETUI_INFO structure is copied into <I>pResult</I>&nbsp;if an error is not
returned; otherwise, <I>pResult</I>&nbsp;is set to null.
</DL>
<H3>Return Value</H3>
<P>
<B>CommonPropertySheetUI</B>&nbsp;returns one of the following values:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Return Value</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUI_CANCEL
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The property sheet was not displayed because there were no pages.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUI_OK
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The function succeeded.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUI_RESTARTWINDOWS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The function succeeded. The property sheet was displayed, and the end-user
changed a selection that requires the login session to be restarted in order
for the change to take effect.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CPSUI_REBOOTSYSTEM
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The function succeeded. The property sheet was displayed, and the end-user
changed a selection that requires the system to be rebooted in order for the
change to take effect.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
ERR_CPSUI_<I>Xxx</I>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The property sheet was not displayed due to the error specified by the return
error code. These error code values are always less than zero.
</FONT></TABLE>
<H3>Comments</H3>
<P>
<B>CommonPropertySheetUI </B>is the main entry point for the CPSUI. An
application calls this function to have the CPSUI manage and display a
property sheet.
<P>
The function to which <I>pfnPropSheetUI</I>&nbsp;points is a caller-defined
function in which the caller requests the CPSUI to add pages to the property
sheet. The CPSUI calls this function as follows:
<PRE><FONT FACE="Courier" SIZE="2">PROPSHEETUI_INFO   PSUIInfo;
<I>pfnPropSheetUI</I>(&amp;PSUIInfo, <I>lParam</I>);
</FONT></PRE>
<P>
When an end-user closes the property sheet by selecting <B>OK</B>&nbsp;or <B>Cancel</B>,
<B>CommonPropertySheetUI</B>&nbsp;returns the appropriate CPSUI_<I>Xxx</I>&nbsp;value to
the original caller.
<P>
If the function to which <I>pfnPropSheetUI</I>&nbsp;points returns a LONG value
greater than zero, the CPSUI displays the property sheet dialog boxes. When an
end-user closes the property sheet by selecting <B>OK</B>&nbsp;or <B>Cancel</B>, <B>CommonPropertySheetUI</B>
returns one of CPSUI_OK, CPSUI_RESTARTWINDOWS, or CPSUI_REBOOTSYSTEM. If the
callback returns a LONG value that is equal to or less than zero, there were
no pages on the property sheet or an error was encountered. In this situation,
the CPSUI did not display the property sheet and <B>CommonPropertySheetUI</B>
returns CPSUI_CANCEL or ERR_CPSUI_<I>Xxx</I>.
<P>
When the last call to <I>pfnPropSheetUI()</I>&nbsp;returns, the value in the <B>Result</B>
field of <A HREF="cpsui_20.htm">PROPSHEETUI_INFO</A>&nbsp;is copied into the
DWORD to which <I>pResult</I>&nbsp;points. The <I>pResult</I>&nbsp;parameter is set only
when <B>CommonPropertySheetUI</B>&nbsp;does not return ERR_CPSUI_<I>Xxx</I>. <B>CommonPropertySheetUI</B>
does not return the last DWORD result of <I>pfnPropSheet()</I>&nbsp;if <I>pResult</I>
is null.
<H3>See Also</H3>
<P>
<B><A HREF="cpsui_6.htm">PFNPROPSHEETUI</A></B>&nbsp;
<P></FONT>
</BODY>
</HTML>
