<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DOCUMENTPROPERTYHEADER</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_DOCUMENTPROPERTYHEADER_GG"></A>DOCUMENTPROPERTYHEADER</H2>
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _DOCUMENTPROPERTYHEADER {
&nbsp; &nbsp; WORD            cbSize;
&nbsp; &nbsp; WORD            Reserved;
&nbsp; &nbsp; HANDLE          hPrinter;
&nbsp; &nbsp; LPTSTR          pszPrinterName;
&nbsp; &nbsp; PDEVMODE        pdmIn;
&nbsp; &nbsp; PDEVMODE        pdmOut;
&nbsp; &nbsp; DWORD           cbOut;
&nbsp; &nbsp; DWORD           fMode;
} DOCUMENTPROPERTYHEADER, *PDOCUMENTPROPERTYHEADER;
</FONT></PRE>
<P>
The DOCUMENTPROPERTYHEADER structure is passed to <B><A HREF="pui_10.htm">DrvDocumentPropertySheets</A></B>
as the <I>lParam</I>&nbsp;parameter.
<H3>Members</H3>
<DL>
<DT>
<B>cbSize</B>
<DD>
Size of this structure, in bytes.
<BR>
<DT>
<B>Reserved</B>
<DD>
Reserved. Must be set to zero.
<BR>
<DT>
<B>hPrinter</B>
<DD>
Handle to the printer whose configuration data is being queried or set.
<BR>
<DT>
<B>pszPrinterName</B>
<DD>
Pointer to a null-terminated string that specifies the name of the printer.
<BR>
<DT>
<B>pdmIn</B>
<DD>
Pointer to the input <A HREF="grstrcts_7.htm">DEVMODE</A>&nbsp;structure that contains
the configuration data to be used by the driver to initialize the controls of
the dialog box. This parameter can be null.
<BR>
<DT>
<B>pdmOut</B>
<DD>
Pointer to an output DEVMODE structure in which the final printer
configuration data is returned. This parameter can be null.
<BR>
<DT>
<B>cbOut</B>
<DD>
Specifies the size, in bytes, of the buffer to which <B>pdmOut</B>&nbsp;points.
<BR>
<DT>
<B>fMode</B>
<DD>
Bitmask specifying the operation(s) to be performed by <B><A HREF="pui_10.htm">DrvDocumentPropertySheets</A></B>.
If this member is zero, the driver should simply return the size, in bytes, of
its DEVMODE structure. Otherwise, this parameter can be one or more of the
following values:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Flag</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Meaning</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DM_IN_BUFFER
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The buffer to which <B>pdmIn</B>&nbsp;points is valid. Before doing anything else,
the driver should merge its current settings with the settings in the input
DEVMODE, updating only those members specified in the <B>dmField</B>&nbsp;member of
the input DEVMODE. In cases of conflict during the merge, the driver should
use the setting provided by the input DEVMODE.
<P>
This value is also defined as DM_MODIFY.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DM_IN_PROMPT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The buffer to which <B>pdmIn</B>&nbsp;points is valid. The driver should present
its <B>Document Properties</B>&nbsp;property sheet using the default values
specified in the input DEVMODE. The driver should update its DEVMODE structure
to those values specified by the user through the UI. The driver should ignore
this field when <I>pPSUIInfo</I>&nbsp;is null, because no dialog box interaction
should occur.
<P>
This value is also defined as DM_PROMPT.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DM_OUT_BUFFER
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The driver should write its current print settings, including private data, in
the buffer to which <B>pdmOut</B>&nbsp;points. If the DM_OUT_BUFFER bit is not set,
<B>pdmOut</B>&nbsp;can be null.
<P>
This value is also defined as DM_COPY.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DM_ADVANCED
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>DrvDocumentPropertySheets</B>&nbsp;has been called as a result of an application
call to the Win32 <B>AdvancedDocumentProperties</B>&nbsp;function. This bit is set
by the spooler.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DM_NOPERMISSION
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The driver should not allow the user to change any items on the property
sheet. This bit is set by the spooler.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DM_USER_DEFAULT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>DrvDocumentPropertySheets</B>&nbsp;was called by the Printer Folder as a result
of the user selecting “Document Properties”.
</FONT></TABLE>
</DL>
<P></FONT>
</BODY>
</HTML>
