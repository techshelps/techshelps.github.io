<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>User-Mode Printer Drivers</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_User_Mode_Printer_Drivers_GG"></A>User-Mode Printer Drivers</H2>
<P>
Windows NT provides printer driver extensions that allow you to optionally
implement a user-mode printer driver. These extensions allow a printer driver
to implement rendering functionality in user mode by allowing the driver to
alter the data stream both before it is sent to the kernel-mode printer driver
and after it is returned from the kernel-mode printer driver.
<P>
If implemented, the user-mode printer driver should exist as a separate module
from the printer interface driver. In this situation, the user-mode printer
driver must link to <I>spoolss.lib</I>, as opposed to <I>winspool.lib</I>.
<P>
When the spooler calls <B><A HREF="pui_11.htm">DrvPrinterEvent</A></B>
with PRINTER_EVENT_INITIALIZE, the printer interface driver should call the
Win32 <B>SetPrinterData</B>&nbsp;function with a value of
SPLPRINTER_USER_MODE_PRINTER_DRIVER and a REG_SZ value that is the name of the
DLL. The spooler will then know which DLL to load during printing.
<P>
Sample code for a simple user-mode printer driver is provided with this
Windows NT DDK. Function declarations can be found in <I>winddiui.h</I>, which
is also provided with the DDK. The following table lists the functions that
comprise this interface, and identifies those functions that must be
implemented.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="drvspl_1.htm">DrvSplAbort</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Aborts the printing job. Optional.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="drvspl_2.htm">DrvSplClose</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Releases the user-mode printer driver handle and its associated resources.
Required.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="drvspl_3.htm">DrvSplEndDoc</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Ends the printing job. Required.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="drvspl_4.htm">DrvSplEndPage</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Provides end-of-page notification. Optional.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="drvspl_5.htm">DrvSplStartDoc</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Starts the identified print job. Required.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="drvspl_6.htm">DrvSplStartPage</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Prepares the printer to accept data. Optional.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B><A HREF="drvspl_7.htm">DrvSplWritePrinter</A></B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Writes data to the printer. Required.
</FONT></TABLE>
<P>
&nbsp;
<P></FONT>
</BODY>
</HTML>
