<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DrvDeviceCapabilities</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_DrvDeviceCapabilities_GG"></A>DrvDeviceCapabilities</H2>
<P>
<B>DWORD DrvDeviceCapabilities(</B>
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>HANDLE  </B><I>hPrinter</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>PWSTR  </B><I>pDeviceName</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>WORD  </B><I>iDevCap</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>VOID  </B>*<I>pvOutput</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>PDEVMODE  </B><I>pDevMode</I>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>&nbsp; &nbsp;);</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT></TABLE>
<P>
<B>DrvDeviceCapabilities</B>&nbsp;provides information about the specified device
and its capabilities.
<H3>Parameters</H3>
<DL>
<DT>
<I>hPrinter</I>
<DD>
Handle to the printer whose capabilities are being queried.
<BR>
<DT>
<I>pDeviceName</I>
<DD>
Points to a null-terminated string that specifies the name of the printing
device.
<BR>
<DT>
<I>iDevCap</I>
<DD>
Specifies the device capability about which information is requested. This
parameter can be one of the following values, as defined in <I>windef.h</I>:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Flag</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Description</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_FIELDS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Returns the <B>dmFields</B>&nbsp;member of the printer driver’s <A HREF="grstrcts_7.htm">DEVMODE</A>
structure, indicating which members in the device-independent portion of the
structure are supported by the printer driver.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_PAPERS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Writes a list of indexes in the WORD array to which <I>pvOutput</I>&nbsp;points,
where each index represents a supported form. The return value is set to the
number of supported forms.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_PAPERSIZE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Writes a list of supported paper sizes, in 0.1mm increments, in the array of
POINT structures to which <I>pvOutput</I>&nbsp;points. The return value is set to
the number of supported paper sizes.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_PAPERNAMES
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Writes a list of supported form names in the Unicode string array to which <I>pvOutput</I>
points. The <I>pvOutput</I>&nbsp;parameter points to an array of string buffers
that are each 64 characters in length. If a form name is less than 64
characters in length, the driver pads that buffer with null characters; if a
form name is equal to 64 characters in length, the driver does not append a
null character. Form names that are greater than 64 characters in length are
truncated and no null character is appended. Return value is set to the number
of supported form names.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_MINEXTENT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Writes the minimum allowable values for the <B>dmPaperLength</B>&nbsp;and <B>dmPaperWidth</B>
members of the driver’s DEVMODE structure. The function returns these values
in a POINTS structure. The low and high words of the returned value specify <B>x</B>
and <B>y</B>, respectively.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_MAXEXTENT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Writes the maximum allowable values for the <B>dmPaperLength</B>&nbsp;and <B>dmPaperWidth</B>
members of the printer driver’s DEVMODE structure. The function returns these
values in a POINTS structure. The low and high words of the returned value
specify <B>x</B>&nbsp;and <B>y</B>, respectively.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_BINS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Writes a list of indexes in a WORD array to which <I>pvOutput</I>&nbsp;points,
where each index represents an available paper bin. Returns the number of
input bins.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_BINNAMES
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Writes a list of the names of the input bins in <I>pvOutput</I>. The <I>pvOutput</I>
parameter points to an array of string buffers that are each 24 characters in
length. The driver should add a terminating null character to each string. Bin
names that are greater than 24 characters in length are truncated and a null
character is appended. Returns the number of input bins.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_DUPLEX
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Returns 1 if the printer supports duplex printing; otherwise, zero is
returned.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_SIZE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Returns the <B>dmSize</B>&nbsp;member of the printer driver’s <A HREF="grstrcts_7.htm">DEVMODE</A>
structure.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_EXTRA
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Returns the <B>dmDriverExtra</B>&nbsp;member of the driver’s DEVMODE structure.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_VERSION
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Returns the <B>dmSpecVersion</B>&nbsp;member of the driver’s DEVMODE structure.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_DRIVER
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Returns the <B>dmDriverVersion</B>&nbsp;member of driver’s DEVMODE structure.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_ENUMRESOLUTIONS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Writes the list of printer-supported resolutions in <I>pvOutput</I>. Each
resolution is specified as a pair of LONG integers that represent the
horizontal and vertical resolutions. The return value is the number of
printer-supported resolutions.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_FILEDEPENDENCIES
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Writes the names of all files that need to be loaded when the driver is
installed in <I>pvOutput</I>. The <I>pvOutput</I>&nbsp;parameter points to an array
of string buffers that are each 64 characters in length. Each filename is a
null-terminated string. The return value is the number of files.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_TRUETYPE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Returns a bitwise OR of one or more of the following values, indicating the ability of the driver to use TrueType fonts (a value of zero indicates no support):<BR>
DCTT_BITMAP: Device can print TrueType fonts as graphics.<BR>
DCTT_DOWNLOAD: Device can download TrueType fonts.<BR>
DCTT_SUBDEV: Device can substitute device fonts for TrueType fonts.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_ORIENTATION
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Returns the relationship between portrait and landscape orientations for a
device. The return value is in terms of the number of degrees that portrait
orientation is rotated counterclockwise to produce landscape orientation. Zero
means that landscape orientation is not available.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DC_COPIES
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Returns the maximum number of copies of a document that the printer can print.
</FONT></TABLE>
<DT>
<I>pvOutput</I>
<DD>
Pointer to the output buffer in which device capability data can be returned.
The size and type of returned device capability data, if any, depends on the
value specified in <I>iDevCap</I>.
<BR>
<DT>
<I>pDevMode</I>
<DD>
Pointer to the source DEVMODE structure.
</DL>
<H3>Return Value</H3>
<P>
<B>DrvDeviceCapabilities</B>&nbsp;returns the specified device’s capabilities upon
success. The actual value depends on <I>iDevCap</I>. The driver should turn
off the <I>iDevCap</I>&nbsp;bit for any feature it does not support and return a
single value for that value. For example, if the device does not support
multiple resolutions, the drivers returns only one resolution when queried
with an <I>iDevCap</I>&nbsp;value of DC_ENUMRESOLUTIONS.
<P>
This function returns GDI_ERROR if it fails.
<H3>Comments</H3>
<P>
If <I>pvOutput</I>&nbsp;is null for an <I>iDevCap</I>&nbsp;value that requires a buffer,
the driver should set the return value accordingly so that the caller can
allocate the correct size of buffer and call <B>DrvDeviceCapabilities</B>
again.
<P></FONT>
</BODY>
</HTML>
