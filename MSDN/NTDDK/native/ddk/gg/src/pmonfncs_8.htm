<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetPrinterDataFromPort</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_GetPrinterDataFromPort_GG"></A>GetPrinterDataFromPort</H2>
<P>
<B>BOOL (WINAPI *pfnGetPrinterDataFromPort)(</B>
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>HANDLE  </B><I>hPort</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>DWORD  </B><I>ControlID</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>LPWSTR  </B><I>pValueName</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>LPWSTR  </B><I>lpInBuffer</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>DWORD  </B><I>cbInBuffer</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>LPWSTR  </B><I>lpOutBuffer</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>DWORD</B>&nbsp; <I>cbOutBuffer</I><B>,</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; &nbsp; <B>LPDWORD  </B><I>lpcbReturned</I>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>&nbsp; &nbsp;);</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT></TABLE>
<P>
<B>GetPrinterDataFromPort</B>&nbsp;gets data from a bidirectional printer.
<H3>Parameters</H3>
<DL>
<DT>
<I>hPort</I>
<DD>
Handle to the port to which the bidirectional printer is connected.
<BR>
<DT>
<I>ControlID</I>
<DD>
Specifies the I/O control code for the operation.
<BR>
<DT>
<I>pValueName</I>
<DD>
Points to a null-terminated string value understood by both monitors and print
drivers. Vendors can define a set of values for this parameter that their
language monitor can interpret as requests for bidirectional printer status
from their printer driver(s).
<P>
Port monitors should ignore this parameter.
<BR>
<DT>
<I>lpInBuffer</I>
<DD>
Points to a buffer containing the data required to perform the operation. This
parameter can be null if the call does not require input data.
<BR>
<DT>
<I>cbInBuffer</I>
<DD>
Specifies the size, in bytes, of <I>lpInBuffer</I>.
<BR>
<DT>
<I>lpOutBuffer</I>
<DD>
Points to a buffer in which the specified operation’s output data is returned.
This parameter can be null if the call does not produce output data.
<BR>
<DT>
<I>cbOutBuffer</I>
<DD>
Specifies the size, in bytes, of <I>lpOutBuffer</I>.
<BR>
<DT>
<I>lpcbReturned</I>
<DD>
Points to a DWORD in which the number of bytes written in <I>lpOutBuffer</I>
is returned.
</DL>
<H3>Return Value</H3>
<P>
<B>GetPrinterDataFromPort</B>&nbsp;returns TRUE if the operation is successful;
otherwise, it returns FALSE.
<H3>Comments</H3>
<P>
A port monitor can implement <B>GetPrinterDataFromPort</B>&nbsp;to provide IEEE
1284 support for a language monitor’s usage. A language monitor can support <B>GetPrinterDataFromPort</B>
to query information from a bidirectional printer that supports the IEEE 1284
standard. Vendors define the status request strings passed from a language
monitor to the associated bidirectional printer.
<P>
Monitors should log the ERROR_INVALID_PARAMETER error for all calls that they
do not understand. This ensures that the spooler will then try to read the key
from the registry directly.
<P>
<B>GetPrinterDataFromPort</B>&nbsp;can be optionally implemented by all monitors.
<H3>See Also</H3>
<P>
<B><A HREF="pmonfncs_16.htm">ReadPort</A></B>
<P></FONT>
</BODY>
</HTML>
