<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TapeMiniTapeError</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_TapeMiniTapeError_KR"></A>TapeMiniTapeError</H2>
<P>
<B>VOID <BR>
&nbsp; &nbsp; TapeMiniTapeError(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PVOID</B>&nbsp; <I>MinitapeExtension</I><B>,</B>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PSCSI_REQUEST_BLOCK</B>&nbsp; <I>Srb</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN OUT PTAPE_STATUS</B>&nbsp; <I>TapeStatus</I><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
TapeMiniTapeError provides device-specific error handling when a SCSI request
block is completed with an error status. This routine is optional.
<H3>Parameters</H3>
<DL>
<DT>
<I>MinitapeExtension</I>
<DD>
Points to the driver-specific minitape extension. NULL if the miniclass driver
does not use a minitape extension.
<BR>
<DT>
<I>Srb</I>
<DD>
Points to the SCSI request block for the operation that failed.
<BR>
<DT>
<I>TapeStatus</I>
<DD>
Points to the TAPE_STATUS set by the tape class driver. The tape miniclass
driver can change the TAPE_STATUS or leave it as is.
</DL>
<H3>Comments</H3>
<P>
Most tape miniclass drivers do not provide a TapeMiniTapeError routine. The
TAPE_STATUS codes set by the tape class driver are appropriate.
<P>
For some devices, however, a tape miniclass driver can identify a more
appropriate error code than the tape class driver. For example, for some
devices the tape class driver returns a TAPE_STATUS_BUS_RESET, but the tape
miniclass driver is able to determine that the real problem is more accurately
represented by TAPE_STATUS_NO_MEDIA.
<P>
A tape miniclass driver optionally specifies a TapeMiniTapeError routine in
TAPE_INIT_DATA in its <B>DriverEntry</B>&nbsp;routine. When an error occurs during
a read, write, or device control command the tape class driver sets an
appropriate TAPE_STATUS code. If the tape miniclass driver supplied a
TapeMiniTapeError routine, the tape class driver calls that routine with the
minitape extension, the failed SRB, and the TAPE_STATUS code that would be
returned.
<P>
TapeMiniTapeError determines whether to alter the status provided by the tape
class driver based on the input parameters and its knowledge of the device. If
the SRB_STATUS_AUTOSENSE_VALID bit is set in <B>Srb<FONT
FACE="Symbol">&#45;</FONT>&gt;SrbStatus</B>, then the SRB contains SCSI sense
information at <B>SenseInfoBuffer</B>. The length of the buffer is <B>SenseInfoBufferLength</B>.
The<B>&nbsp;</B>TapeMiniTapeError routine should examine this information along
with the <B>SrbStatus</B>&nbsp;and <B>ScsiStatus</B>&nbsp;in the SRB to determine
whether or not to change the TAPE_STATUS returned.
<H3>See Also</H3>
<P>
<A HREF="k305_4.htm">SCSI_REQUEST_BLOCK</A>&nbsp;
<P></FONT>
</BODY>
</HTML>
