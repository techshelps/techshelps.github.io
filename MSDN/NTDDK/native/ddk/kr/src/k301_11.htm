<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ScsiPortGetUncachedExtension</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_ScsiPortGetUncachedExtension_KR"></A>ScsiPortGetUncachedExtension</H2>
<P>
<B>PVOID <BR>
&nbsp; &nbsp; ScsiPortGetUncachedExtension(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PVOID</B>&nbsp; <I>HwDeviceExtension</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PPORT_CONFIGURATION_INFORMATION</B>&nbsp; <I>ConfigInfo</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN ULONG</B>&nbsp; <I>NumberOfBytes</I><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>ScsiPortGetUncachedExtension</B>&nbsp;allocates memory that can be used by both
the CPU and a busmaster HBA for DMA or for shared data.
<H3>Parameters</H3>
<DL>
<DT>
<I>HwDeviceExtension</I>
<DD>
Points to the miniport driver’s per-HBA storage area.
<BR>
<DT>
<I>ConfigInfo</I>
<DD>
Specifies information about the HBA’s DMA capabilities. The following members
must be filled in: <B>DmaChannel</B>&nbsp;or <B>DmaPort</B>, <B>DmaWidth</B>, <B>DmaSpeed</B>,
<B>MaximumLength</B>, <B>ScatterGather</B>, <B>Master</B>&nbsp;set to TRUE, <B>NumberOfPageBreaks</B>,
<B>AdapterInterfaceType</B>, <B>Dma32BitAddresses</B>, <B>SystemIoBusNumber</B>,
and <B>AutoRequestSense</B>.
<P>
Members that are not pertinent to the HBA, such as <B>DmaChannel</B>&nbsp;for an
EISA busmaster adapter, must be left as is.
<BR>
<DT>
<I>NumberOfBytes</I>
<DD>
Indicates the size in bytes of the uncached extension to be allocated.
</DL>
<H3>Return Value</H3>
<P>
<B>ScsiPortGetUncachedExtension</B>&nbsp;returns a virtual address pointer to the
uncached extension. If it cannot allocate the requested memory, it returns
NULL.
<H3>Comments</H3>
<P>
<B>ScsiPortGetUncachedExtension</B>&nbsp;can be called only from miniport driver’s
HwScsiFindAdapter routine and only for a busmaster HBA. Calls from other
miniport driver routines will result in system failure or incorrect operation
for the caller.
<P>
Because high-end machines have caches and large memories, any memory to be
shared between an HBA and the CPU must be specially allocated. Mailboxes or
I/O request queues in system memory are examples of this type of shared
memory.
<P>
The HwScsiFindAdapter routine can call <B>ScsiPortGetUncachedExtension</B>
only once for each busmaster HBA the miniport driver supports.
<P>
To obtain the physical address for the uncached extension that the HBA can
use, call <B>ScsiPortGetPhysicalAddress</B>.
<H3>See Also</H3>
<P>
<A HREF="k305_3.htm">PORT_CONFIGURATION_INFORMATION</A>,
<A HREF="k302_6.htm">HwScsiFindAdapter</A>, <B><A HREF="k301_9.htm">ScsiPortGetPhysicalAddress</A></B>
<P></FONT>
</BODY>
</HTML>
