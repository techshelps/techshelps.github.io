<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>6.1  Disk I/O Requests</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_Disk_I_O_Requests_KR"></A>6.1  Disk I/O Requests</H2>
<P>
Use the browse button to view these topics in sequence.
<H3>IRP_MJ_CREATE</H3>
<H4>Operation</H4>
<P>
Returns STATUS_SUCCESS, indicating that the device or partition exists. For
the caller, this request opens the device for I/O.
<H4>When Called</H4>
<P>
A higher-level driver is attempting to connect or attach one of its device
objects to the target device object, or a user-mode process has attempted to
open a file stored on the physical device, thereby causing a file system to
carry out a mount operation.
<H4>I/O Status Block</H4>
<P>
Returns STATUS_SUCCESS in the <B>Status</B>&nbsp;field and zero in the <B>Information</B>
field.
<H3>IRP_MJ_FLUSH_BUFFERS</H3>
<H4>Operation</H4>
<P>
Transfers any data cached in the device or in the driver’s internal buffer(s)
to system memory or out to the device. If the device or driver supports
caching or buffering data, the driver must handle this request.
<H4>When Called</H4>
<P>
A file system or DTP application makes this request to ensure data integrity.
<H4>I/O Status Block</H4>
<P>
The <B>Status</B>&nbsp;field is set to STATUS_SUCCESS when the data has been
transferred.
<H3>IRP_MJ_SHUTDOWN</H3>
<H4>Operation</H4>
<P>
Transfers any data cached in the device or in the driver’s internal buffer(s)
to system memory or out to the device before the system is shut down. If the
device or driver supports caching or buffering data, the driver must handle
this request.
<H4>When Called</H4>
<P>
The user has decided to shut down the system.
<H4>I/O Status Block</H4>
<P>
The <B>Status</B>&nbsp;field is set to STATUS_SUCCESS when the data has been
transferred.
<H3>IRP_MJ_READ</H3>
<H4>Operation</H4>
<P>
Transfers data from the device to system memory.
<H4>Output</H4>
<P>
Drivers of disk-type devices generally use direct I/O, so the lowest-level
driver transfers data using DMA or PIO into the buffer described by the MDL at
<B>Irp-&gt;MdlAddress</B>.
<H4>When Called</H4>
<P>
A user-mode application that has a handle for an opened file or a higher-level
driver has requested data.
<H4>I/O Status Block</H4>
<DL>
<DT>
The <B>Information</B>&nbsp;field is set to the number of bytes transferred,
whatever the <B>Status</B>&nbsp;field’s value. In addition to STATUS_SUCCESS,
possible values are any of the following:
<DD>
Device Errors
<PRE><FONT FACE="Courier" SIZE="2">STATUS_INVALID_DEVICE_REQUEST
STATUS_NO_SUCH_DEVICE
STATUS_IO_TIMEOUT
STATUS_DEVICE_NOT_CONNECTED
</FONT></PRE>
<P>
Sector/Data Errors
<PRE><FONT FACE="Courier" SIZE="2">STATUS_DEVICE_DATA_ERROR
STATUS_CRC_ERROR
</FONT></PRE>
<P>
and, by drivers of removable-media devices:
<PRE><FONT FACE="Courier" SIZE="2">STATUS_NO_MEDIA_IN_DEVICE
STATUS_VERIFY_REQUIRED</FONT></PRE>
</DL>
<H3>IRP_MJ_WRITE</H3>
<H4>Operation</H4>
<P>
Transfers data from system memory to the device.
<H4>Input</H4>
<P>
Drivers of disk-type devices generally use direct I/O, so the lowest-level
driver transfers data using DMA or PIO from the buffer described by the MDL at
<B>Irp-&gt;MdlAddress</B>.
<H4>When Called</H4>
<P>
A user-mode application that has a handle for an opened file or a higher-level
driver has requested a data transfer.
<H4>I/O Status Block</H4>
<P>
The <B>Information</B>&nbsp;field is set to the number of bytes transferred,
whatever the <B>Status</B>&nbsp;field’s value. Possible values are any of those
returned for read requests and STATUS_MEDIA_WRITE_PROTECTED returned by
drivers of removable-media devices.
<H3>IRP_MJ_DEVICE_CONTROL</H3>
<H4>Operation</H4>
<P>
Determined by the I/O control code set at <B>Parameters.DeviceIoControl.IoControlCode</B>
in the driver’s I/O stack location of the IRP.
<H4>When Called</H4>
<P>
A Win32 application has called <B>DeviceIoControl</B>, or a higher-level
driver has set up such a request.
<H4>I/O Status Block</H4>
<P>
Also determined by the operation, either STATUS_SUCCESS or an appropriate
STATUS_<I>XXX</I>&nbsp;value. For most operations, the set of possible STATUS_<I>XXX</I>
values includes those propagated from a call to a support routine or
lower-level driver and/or those chosen by the driver designer. In general, the
<B>Information</B>&nbsp;field of the I/O status block is set to the number of bytes
returned or transferred when the device driver completes the IRP.
<P></FONT>
</BODY>
</HTML>
