<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IoBuildAsynchronousFsdRequest</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_IoBuildAsynchronousFsdRequest_KR"></A>IoBuildAsynchronousFsdRequest</H2>
<P>
<B>PIRP <BR>
&nbsp; &nbsp; IoBuildAsynchronousFsdRequest(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN ULONG</B>&nbsp; <I>MajorFunction</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PDEVICE_OBJECT</B>&nbsp; <I>DeviceObject</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN OUT PVOID</B>&nbsp; <I>Buffer</I><B>,</B>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN ULONG</B>&nbsp; <I>Length</I><B>,</B>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PLARGE_INTEGER</B>&nbsp; <I>StartingOffset</I><B>,</B>&nbsp; &nbsp; &nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PIO_STATUS_BLOCK</B>&nbsp; <I>IoStatusBlock</I>&nbsp;&nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>IoBuildAsynchronousFsdRequest</B>&nbsp;allocates and sets up an IRP to be sent
to lower-level drivers.
<H3>Parameters</H3>
<DL>
<DT>
<I>MajorFunction</I>
<DD>
Specifies the major function code to be set in the IRP, one of IRP_MJ_READ,
IRP_MJ_WRITE, IRP_MJ_FLUSH_BUFFERS, or IRP_MJ_SHUTDOWN.
<BR>
<DT>
<I>DeviceObject</I>
<DD>
Points to the next-lower driver’s device object, representing the target
device for the read, write, flush, or shutdown operation.
<BR>
<DT>
<I>Buffer</I>
<DD>
Points to a buffer into which data is read or from which data is written. The
value of this argument is NULL for flush and shutdown requests.
<BR>
<DT>
<I>Length</I>
<DD>
Specifies the length in bytes of <I>Buffer</I>. The value of this argument is
zero for flush and shutdown requests.
<BR>
<DT>
<I>StartingOffset</I>
<DD>
Points to the starting offset on the input/output media. The value of this
argument is zero for flush and shutdown requests.
<BR>
<DT>
<I>IoStatusBlock</I>
<DD>
Points to the address of an I/O status block in which the to-be-called
driver(s) return final status about the requested operation.
</DL>
<H3>Return Value</H3>
<P>
<B>IoBuildAsynchronousFsdRequest</B>&nbsp;returns a pointer to an IRP or a NULL
pointer if the IRP cannot be allocated.
<H3>Comments</H3>
<P>
Intermediate or highest-level drivers can call <B>IoBuildAsynchronousFsdRequest</B>
to set up IRPs for requests sent to lower-level drivers. Such a driver must
set its IoCompletion routine in the IRP so the IRP can be deallocated with <B>IoFreeIrp</B>.
<P>
The IRP that gets built contains only enough information to get the operation
started and to complete the IRP. No other context information is tracked
because an asynchronous request is context-independent.
<P>
Callers of <B>IoBuildAsynchronousFsdRequest</B>&nbsp;must be running at IRQL &lt;=
DISPATCH_LEVEL.
<P>
An intermediate or highest-level driver also can call <B>IoBuildDeviceIoControlRequest</B>,
<B>IoAllocateIrp</B>, or <B>IoBuildSychronousFsdRequest</B>&nbsp;to set up requests
it sends to lower-level drivers. Only a highest-level driver can call <B>IoMakeAssociatedIrp</B>.
<H3>See Also</H3>
<P>
<A HREF="k112_26.htm">IO_STACK_LOCATION</A>, <B><A HREF="k104_5.htm">IoAllocateIrp</A></B>,
<B><A HREF="k104_13.htm">IoBuildDeviceIoControlRequest</A></B>,
<B><A HREF="k104_15.htm">IoBuildSynchronousFsdRequest</A></B>,
<B><A HREF="k104_16.htm">IoCallDriver</A></B>, <B><A HREF="k104_36.htm">IoFreeIrp</A></B>,
<B><A HREF="k104_54.htm">IoMakeAssociatedIrp</A></B>, <B><A HREF="k104_68.htm">IoSetCompletionRoutine</A></B>,
<A HREF="k112_28.htm">IRP</A>&nbsp;
<P></FONT>
</BODY>
</HTML>
