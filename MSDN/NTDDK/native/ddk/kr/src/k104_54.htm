<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IoMakeAssociatedIrp</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_IoMakeAssociatedIrp_KR"></A>IoMakeAssociatedIrp</H2>
<P>
<B>PIRP <BR>
&nbsp; &nbsp; IoMakeAssociatedIrp(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PIRP</B>&nbsp; <I>Irp</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN CCHAR</B>&nbsp; <I>StackSize</I><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>IoMakeAssociatedIrp</B>&nbsp;allocates and initalizes an IRP to be associated
with a master IRP sent to a highest-level driver, allowing the caller to split
the original request and send associated IRPs on to lower-level drivers.
<H3>Parameters</H3>
<DL>
<DT>
<I>Irp</I>
<DD>
Points to the master IRP that was input to a highest-level driver’s Dispatch
routine.
<BR>
<DT>
<I>StackSize</I>
<DD>
Specifies the number of stack locations to be allocated for the associated
IRP. The value must be at least equal to the <B>StackSize</B>&nbsp;of the
next-lower driver’s device object, but the associated IRP can have an
additional stack location for the caller.
</DL>
<H3>Return Value</H3>
<P>
<B>IoMakeAssociatedIrp</B>&nbsp;returns a pointer to the associated IRP or returns
a NULL pointer if an IRP cannot be allocated.
<H3>Comments</H3>
<P>
Only a highest-level driver can call this routine.
<P>
The I/O Manager completes the master IRP automatically when lower drivers have
completed all associated IRPs as long as the caller has not set its
IoCompletion routine in an associated IRP and returned
STATUS_MORE_PROCESSING_REQUIRED from its IoCompletion routine. In these
circumstances, the caller must explicitly complete the master IRP when that
driver has determined that all associated IRPs were completed.
<P>
Callers of <B>IoMakeAssociatedIrp</B>&nbsp;must be running at IRQL &lt;=
DISPATCH_LEVEL.
<H3>See Also</H3>
<P>
<B><A HREF="k104_5.htm">IoAllocateIrp</A></B>, <B><A HREF="k104_12.htm">IoBuildAsynchronousFsdRequest</A></B>,
<B><A HREF="k104_13.htm">IoBuildDeviceIoControlRequest</A></B>,
<B><A HREF="k104_15.htm">IoBuildSynchronousFsdRequest</A></B>,
<B><A HREF="k104_16.htm">IoCallDriver</A></B>, <B><A HREF="k104_68.htm">IoSetCompletionRoutine</A></B>,
<A HREF="k112_28.htm">IRP</A>&nbsp;
<P></FONT>
</BODY>
</HTML>
