<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ZwOpenKey</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_ZwOpenKey_KR"></A>ZwOpenKey</H2>
<P>
<B>NTSTATUS <BR>
&nbsp; &nbsp; ZwOpenKey(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PHANDLE</B>&nbsp; <I>KeyHandle</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN ACCESS_MASK</B>&nbsp; <I>DesiredAccess</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN POBJECT_ATTRIBUTES</B>&nbsp; <I>ObjectAttributes</I><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>ZwOpenKey</B>&nbsp;opens an existing key in the registry.
<H3>Parameters</H3>
<DL>
<DT>
<I>KeyHandle</I>
<DD>
Points to a returned handle for the key specified in <I>ObjectAttributes</I>
if this call is successful.
<BR>
<DT>
<I>DesiredAccess</I>
<DD>
Specifies the access rights desired to the key. See <B>ZwCreateKey</B>&nbsp;for a
description of possible values for this parameter.
<BR>
<DT>
<I>ObjectAttributes</I>
<DD>
Points to the initialized object attributes of the key being opened. See the
description of <B>ZwCreateKey</B>&nbsp;for more information.
</DL>
<H3>Return Value</H3>
<P>
<B>ZwOpenKey</B>&nbsp;returns STATUS_SUCCESS if the given key was opened.
Otherwise, it can return an error status, including the following values:
<P>
STATUS_INVALID_HANDLE<BR>
STATUS_ACCESS_DENIED
<H3>Comments</H3>
<P>
<B>ZwOpenKey</B>&nbsp;or <B>ZwCreateKey</B>&nbsp;must be called before any of the <B>Zw...Key</B>
routines that require an input <I>KeyHandle</I>.
<P>
If the specified key does not exist or the <I>DesiredAccess</I>&nbsp;requested is
not allowed, <B>ZwOpenKey</B>&nbsp;returns an error status, and the <I>KeyHandle</I>
remains invalid.
<P>
<B>ZwOpenKey</B>&nbsp;ignores the security information in the input <I>ObjectAttributes</I>.
Access rights for a key object can be set only when the key is created.
<P>
Callers of <B>ZwOpenKey</B>&nbsp;must be running at IRQL PASSIVE_LEVEL.
<H3>See Also</H3>
<P>
<B><A HREF="k109_2.htm">InitializeObjectAttributes</A></B>,
<B><A HREF="k111_4.htm">ZwCreateKey</A></B>, <B><A HREF="k111_5.htm">ZwDeleteKey</A></B>,
<B><A HREF="k111_6.htm">ZwEnumerateKey</A></B>, <B><A HREF="k111_7.htm">ZwEnumerateValueKey</A></B>,
<B><A HREF="k111_8.htm">ZwFlushKey</A></B>, <B><A HREF="k111_14.htm">ZwQueryKey</A></B>,
<B><A HREF="k111_15.htm">ZwQueryValueKey</A></B>, <B><A HREF="k111_19.htm">ZwSetValueKey</A></B>
<P></FONT>
</BODY>
</HTML>
