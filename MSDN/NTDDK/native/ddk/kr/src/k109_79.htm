<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RtlWriteRegistryValue</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_RtlWriteRegistryValue_KR"></A>RtlWriteRegistryValue</H2>
<P>
<B>NTSTATUS <BR>
&nbsp; &nbsp; RtlWriteRegistryValue(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN ULONG</B>&nbsp; <I>RelativeTo</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PWSTR</B>&nbsp; <I>Path</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PWSTR</B>&nbsp; <I>ValueName</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN ULONG</B>&nbsp; <I>ValueType</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PVOID</B>&nbsp; <I>ValueData</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN ULONG</B>&nbsp; <I>ValueLength</I><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>RtlWriteRegistryValue</B>&nbsp;writes caller-supplied data into the registry
along the specified relative path at the given value name.
<H3>Parameters</H3>
<DL>
<DT>
<I>RelativeTo</I>
<DD>
Specifies whether <I>Path</I>&nbsp;is an absolute registry path or is relative to a
predefined path as one of the following:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Value</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Meaning</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
RTL_REGISTRY_ABSOLUTE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Path is an absolute registry path.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
RTL_REGISTRY_SERVICES
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Path is relative to <B>\Registry\Machine\System\CurrentControlSet\Services</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
RTL_REGISTRY_CONTROL
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Path is relative to <B>\Registry\Machine\System\CurrentControlSet\Control</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
RTL_REGISTRY_WINDOWS_NT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Path is relative to <B>\Registry\Machine\Software\Microsoft\<BR>
Windows NT\CurrentVersion</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
RTL_REGISTRY_DEVICEMAP
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Path is relative to <B>\Registry\Machine\Hardware\DeviceMap</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
RTL_REGISTRY_USER
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Path is relative to <B>\Registry\User\CurrentUser</B>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
RTL_REGISTRY_OPTIONAL
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Specifies that the key referenced by this parameter and the <I>Path</I>
parameter are optional.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
RTL_REGISTRY_HANDLE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
&nbsp; 
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Specifies that the <I>Path</I>&nbsp;parameter is actually a registry handle to use.
This value is optional.
</FONT></TABLE>
<DT>
<I>Path</I>
<DD>
Points to either an absolute registry path or a path relative to the known
location specified by the <I>RelativeTo</I>&nbsp;parameter. If the
RTL_REGISTRY_HANDLE flag is specified, this parameter is a registry handle for
an already opened key to be used directly.
<BR>
<DT>
<I>ValueName</I>
<DD>
Points to the name of a subkey or value entry to be written into the registry.
<BR>
<DT>
<I>ValueType</I>
<DD>
Points to the type of value, identified by the <I>ValueName</I>&nbsp;parameter, to
be placed in the registry.
<BR>
<DT>
<I>ValueData</I>
<DD>
Points to the name of a subkey or values for its value entries (or both) to be
written into the registry.
<BR>
<DT>
<I>ValueLength</I>
<DD>
Specifies the number of bytes of <I>ValueData</I>&nbsp;to be written into the
registry.
</DL>
<H3>Return Value</H3>
<P>
<B>RtlWriteRegistryValue</B>&nbsp;returns the status of the operation.
<H3>Comments</H3>
<P>
Callers of <B>RtlWriteRegistryValue</B>&nbsp;must be running at IRQL PASSIVE_LEVEL.
<H3>See Also</H3>
<P>
<B><A HREF="k109_16.htm">RtlCheckRegistryKey</A></B>, <B><A HREF="k109_26.htm">RtlCreateRegistryKey</A></B>,
<B><A HREF="k109_28.htm">RtlDeleteRegistryValue</A></B>, <B><A HREF="k109_66.htm">RtlQueryRegistryValues</A></B>,
<B><A HREF="k111_11.htm">ZwOpenKey</A></B>&nbsp;
<P></FONT>
</BODY>
</HTML>
