<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SeAccessCheck</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_SeAccessCheck_KR"></A>SeAccessCheck</H2>
<P>
<B>BOOLEAN <BR>
&nbsp; &nbsp; SeAccessCheck(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PSECURITY_DESCRIPTOR</B>&nbsp; <I>SecurityDescriptor</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PSECURITY_SUBJECT_CONTEXT</B>&nbsp; <I>SubjectSecurityContext</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN BOOLEAN</B>&nbsp; <I>SubjectContextLocked</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN ACCESS_MASK</B>&nbsp; <I>DesiredAccess</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN ACCESS_MASK</B>&nbsp; <I>PreviouslyGrantedAccess</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PPRIVILEGE_SET</B>&nbsp; <I>*Privileges</I><B>,</B>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PGENERIC_MAPPING</B>&nbsp; <I>GenericMapping</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN KPROCESSOR_MODE</B>&nbsp; <I>AccessMode</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PACCESS_MASK</B>&nbsp; <I>GrantedAccess</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PNTSTATUS</B>&nbsp; <I>AccessStatus</I><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>SeAccessCheck</B>&nbsp;determines whether the requested access rights can be
granted to an object protected by a security descriptor and an object owner.
<H3>Parameters</H3>
<DL>
<DT>
<I>SecurityDescriptor</I>
<DD>
Points to the security descriptor protecting the object being accessed.
<BR>
<DT>
<I>SubjectSecurityContext</I>,
<DD>
Points to the subject’s captured security context.
<BR>
<DT>
<I>SubjectContextLocked</I>
<DD>
Indicates whether the user’s subject context is locked, so that it does not
have to be locked again.
<BR>
<DT>
<I>DesiredAccess</I>
<DD>
Specifies the access mask for rights that the caller is attempting to acquire.
<BR>
<DT>
<I>PreviouslyGrantedAccess</I>
<DD>
Specifies the access rights already granted, for example, as a result of
holding a privilege.
<BR>
<DT>
<I>Privileges</I>
<DD>
Points to a set of buffered privileges used as part of the access validation.
The buffer must be released by the caller with <B>ExFreePool</B>&nbsp;when the
caller has consumed this information.
<BR>
<DT>
<I>GenericMapping</I>
<DD>
Points to the generic mapping associated with this object type.
<BR>
<DT>
<I>AccessMode</I>
<DD>
Specifies the access mode to be used in the check, one of <B>UserMode</B>&nbsp;or <B>KernelMode</B>.
<BR>
<DT>
<I>GrantedAccess</I>
<DD>
Points to a returned access mask indicating the granted access.
<BR>
<DT>
<I>AccessStatus</I>
<DD>
Points to the status value indicating why access was denied.
</DL>
<H3>Return Value</H3>
<P>
If access is allowed, <B>SeAccessCheck</B>&nbsp;returns TRUE.
<H3>Comments</H3>
<P>
Network transport drivers call this routine.
<P>
<B>SeAccessCheck</B>&nbsp;might perform privilege tests for <B>SeTakeOwnershipPrivilege</B>
and/or <B>SeSecurityPrivilege</B>, depending on the accesses being requested.
It might perform additional privilege testing in future releases of Windows
NT.
<P>
This routine also might check whether the subject is the owner of the object
in order to grant WRITE_DAC access.
<P>
If this routine returns FALSE, the caller should use the returned <I>AccessStatus</I>
as its return value. That is, the caller should avoid hardcoding a return
value of STATUS_ACCESS_DENIED or any other specific STATUS_<I>XXX</I>&nbsp;value.
<P>
Callers of this routine must be running at IRQL PASSIVE_LEVEL.
<H3>See Also</H3>
<P>
<B><A HREF="k102_21.htm">ExFreePool</A></B>, <B><A HREF="k104_44.htm">IoGetFileObjectGenericMapping</A></B>
<P></FONT>
</BODY>
</HTML>
