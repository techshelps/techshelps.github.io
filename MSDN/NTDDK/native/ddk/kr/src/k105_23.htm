<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>KeInsertByKeyDeviceQueue</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_KeInsertByKeyDeviceQueue_KR"></A>KeInsertByKeyDeviceQueue</H2>
<P>
<B>BOOLEAN <BR>
&nbsp; &nbsp; KeInsertByKeyDeviceQueue(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PKDEVICE_QUEUE</B>&nbsp; <I>DeviceQueue</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PKDEVICE_QUEUE_ENTRY</B>&nbsp; <I>DeviceQueueEntry</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN ULONG</B>&nbsp; <I>SortKey</I><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>KeInsertByKeyDeviceQueue</B>&nbsp;acquires the spin lock for the given <I>DeviceQueue</I>
and queues an entry according to the given sort-key value if the state of the
device queue is Busy.
<H3>Parameters</H3>
<DL>
<DT>
<I>DeviceQueue</I>
<DD>
Points to a control object of the device queue type for which the caller
provides the storage.
<BR>
<DT>
<I>DeviceQueueEntry</I>
<DD>
Points to the device queue entry to be inserted into the device queue
according to the specific key value.
<BR>
<DT>
<I>SortKey</I>
<DD>
Specifies the sort-key value that determines the position in the device queue
in which to insert the entry.
</DL>
<H3>Return Value</H3>
<P>
If the device queue is empty, FALSE is returned, meaning the <I>DeviceQueueEntry</I>
is not inserted in the device queue.
<H3>Comments</H3>
<P>
The given device queue spin lock is acquired and the state of the device queue
is checked. If the state of the device queue is Busy, the IRP specified by the
<I>DeviceQueueEntry</I>&nbsp;is inserted into the device queue according to its
sort-key value and the device queue spin lock is released.
<P>
The new entry is positioned in the device queue after any entries in the queue
with sort-key values less than or equal to its sort-key value and preceding
any entries with sort-key values that are greater.
<P>
If <B>KeInsertByKeyDeviceQueue</B>&nbsp;returns FALSE, the caller must begin
processing the IRP. A call to <B>KeInsertDeviceQueue</B>&nbsp;or <B>KeInsertByKeyDeviceQueue</B>
when the queue is empty causes the device queue state transition from Not-Busy
to Busy.
<P>
This routine is for code that queues an I/O request to a device driver.
<P>
Callers of <B>KeInsertByKeyDeviceQueue</B>&nbsp;must be running at IRQL
DISPATCH_LEVEL.
<H3>See Also</H3>
<P>
<B><A HREF="k105_15.htm">KeInitializeDeviceQueue</A></B>, <B><A HREF="k105_24.htm">KeInsertDeviceQueue</A></B>,
<B><A HREF="k105_43.htm">KeRemoveDeviceQueue</A></B>, <B><A HREF="k105_44.htm">KeRemoveEntryDeviceQueue</A></B>
<P></FONT>
</BODY>
</HTML>
