<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>KeSetTimerEx</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_KeSetTimerEx_KR"></A>KeSetTimerEx</H2>
<P>
<B>BOOLEAN <BR>
&nbsp; &nbsp; KeSetTimerEx(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PKTIMER</B>&nbsp; <I>Timer</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN LARGE_INTEGER</B>&nbsp; <I>DueTime</I><B>,<BR>
&nbsp; &nbsp; &nbsp; &nbsp; IN LONG</B>&nbsp; <I>Period</I><B>,&#09;</B>&nbsp; &nbsp; &nbsp; &nbsp; /* optional */<B><BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PKDPC</B>&nbsp; <I>Dpc</I>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>KeSetTimerEx</B>&nbsp;sets the absolute or relative interval at which a timer
object is to be set to the Signaled state, optionally supplies a
CustomTimerDpc routine to be executed when that interval expires, and
optionally supplies a recurring interval for the timer.
<H3>Parameters</H3>
<DL>
<DT>
<I>Timer</I>
<DD>
Points to a timer object that was initialized with <B>KeInitializeTimer</B>&nbsp;or
<B>KeInitializeTimerEx</B>.
<BR>
<DT>
<I>DueTime</I>
<DD>
Specifies the absolute or relative time at which the timer is to expire. If
the value of the <I>DueTime</I>&nbsp;parameter is negative, the expiration time is
relative to the current system time. Otherwise, the expiration time is
absolute. The expiration time is expressed in system time units
(100-nanosecond intervals). Absolute expiration times track any changes in the
system time; relative expiration times are not affected by system time
changes.
<BR>
<DT>
<I>Period</I>
<DD>
Specifies an optional period for the timer in milliseconds. Must be less than
or equal to MAXLONG.
<BR>
<DT>
<I>Dpc</I>
<DD>
Points to a DPC object that was initialized by <B>KeInitializeDpc</B>. This
parameter is optional.
</DL>
<H3>Return Value</H3>
<P>
If the timer object was already in the system timer queue, <B>KeSetTimerEx</B>
returns TRUE.
<H3>Comments</H3>
<P>
<B>KeSetTimerEx</B>:
<UL>
<LI>
Computes the expiration time.
<P>
<LI>
Sets the state of the timer to Not-Signaled.
<P>
<LI>
Sets the recurring interval for the timer, if one was specified.
<P>
<LI>
Inserts the timer object in the system timer queue.
</UL>
<P>
If the timer object was already in the timer queue, it is implicitly canceled
before being set to the new expiration time. A call to <B>KeSetTimerEx</B>
before the previously specified <I>DueTime</I>&nbsp;has expired cancels both the
timer and the call to the <I>Dpc</I>, if any, associated with the previous
call.
<P>
If the <I>Dpc</I>&nbsp;parameter is specified, a DPC object is associated with the
timer object. When the timer expires, the timer object is removed from the
system timer queue and its state is set to Signaled. If a DPC object was
associated with the timer when it was set, the DPC object is inserted in the
system DPC queue to be executed as soon as conditions permit after the timer
interval expires.
<P>
A DPC routine cannot deallocate a periodic timer. A DPC routine can deallocate
a nonperiodic timer.
<P>
Only one instantiation of a given DPC object can be queued at any given
moment.  To avoid potential race conditions, the DPC passed to <B>KeSetTimerEx</B>
should <I>not</I>&nbsp;be passed to <B>KeInsertQueueDpc</B>.
<P>
A caller cannot wait at raised IRQL nor in an arbitrary thread context for a
timer to expire by calling <B>KeWait</B><I>Xxx</I>.
<P>
Callers of <B>KeSetTimerEx</B>&nbsp;must be running at IRQL &lt;= DISPATCH_LEVEL.
<H3>See Also</H3>
<P>
<B><A HREF="k105_5.htm">KeCancelTimer</A></B>, <B><A HREF="k105_16.htm">KeInitializeDpc</A></B>,
<B><A HREF="k105_21.htm">KeInitializeTimer</A></B>, <B><A HREF="k105_22.htm">KeInitializeTimerEx</A></B>,
<B><A HREF="k105_36.htm">KeReadStateTimer</A></B>, <B><A HREF="k105_54.htm">KeWaitForMultipleObjects</A></B>,
<B><A HREF="k105_56.htm">KeWaitForSingleObject</A></B>&nbsp;
<P></FONT>
</BODY>
</HTML>
