<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TapeClassLogicalBlockToPhysicalBlock</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_TapeClassLogicalBlockToPhysicalBlock_KR"></A>TapeClassLogicalBlockToPhysicalBlock</H2>
<P>
<B>TAPE_PHYS_POSITION<BR>
&nbsp; &nbsp; TapeClassLogicalBlockToPhysicalBlock(<BR>
&nbsp; &nbsp; &nbsp; &nbsp; IN UCHAR  </B><I>DensityCode</I><B>,<BR>
&nbsp; &nbsp; &nbsp; &nbsp; IN ULONG  </B><I>LogicalBlockAddress</I><B>,<BR>
&nbsp; &nbsp; &nbsp; &nbsp; IN ULONG  </B><I>BlockLength</I><B>,<BR>
&nbsp; &nbsp; &nbsp; &nbsp; IN BOOLEAN  </B><I>FromBOT</I><B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; );</B>
<P>
<B>TapeClassLogicalBlockToPhysicalBlock</B>&nbsp;translates a pseudological block
address to a physical block address. This routine is for SCSI-I devices.
<H3>Parameters</H3>
<DL>
<DT>
<I>DensityCode</I>
<DD>
Specifies the tape media density code. This routine supports tapes with the
following density codes: QIC_24, QIC_120, QIC_150, QIC_525, QIC_1000, QIC_2GB,
QIC_1350, and QIC_2100.
<BR>
<DT>
<I>LogicalBlockAddress</I>
<DD>
Specifies a pseudological block address.
<BR>
<DT>
<I>BlockLength</I>
<DD>
Specifies the logical block size, in bytes.
<BR>
<DT>
<I>FromBOT</I>
<DD>
TRUE indicates that the physical block calculation should start at the
beginning of the tape and account for the physical device header. FALSE
indicates that the tape has two partitions, that the block address is on the
directory partition, and therefore no physical device header needs to be
factored into the calculation.
</DL>
<H3>Return Value</H3>
<P>
<B>TapeClassLogicalBlockToPhysicalBlock</B>&nbsp;returns a structure containing the
physical block address:
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _TAPE_PHYS_POSITION { 
&nbsp; &nbsp; ULONG SeekBlockAddress; 
&nbsp; &nbsp; ULONG SpaceBlockCount; 
} TAPE_PHYS_POSITION, PTAPE_PHYS_POSITION; 
&nbsp;</FONT></PRE>
<H3>Comments</H3>
<P>
A tape miniclass driver calls <B>TapeClassLogicalBlockToPhysicalBlock</B>&nbsp;to
translate a logical block address from an application to a physical block
address for a tape device. <B>TapeClassLogicalBlockToPhysicalBlock</B>&nbsp;is not
necessary for SCSI-II drivers because SCSI-II devices support logical block
addressing.
<P>
To position a tape to the physical block address returned by this routine a
tape miniclass driver issues two SCSI commands: a LOCATE command to position
the tape to the <B>SeekBlockAddress</B>&nbsp;and then a SPACE command to advance
the tape <B>SpaceBlockCount</B>. The <B>SpaceBlockCount</B>&nbsp;value is necessary
if the pseudological blocks on the tape are smaller than the physical blocks;
in that case, the logical block boundary might not align with a physical block
boundary.
<P>
If a tape miniclass driver calls this routine with an unsupported tape density
code, <B>TapeClassLogicalBlockToPhysicalBlock</B>&nbsp;does not perform any
translation. It returns the logical block address in <B>SeekBlockAddress</B>
and returns zero in <B>SpaceBlockCount</B>.
<H3>See Also</H3>
<P>
<B><A HREF="k303_5.htm">TapeClassPhysicalBlockToLogicalBlock</A></B>
<P></FONT>
</BODY>
</HTML>
