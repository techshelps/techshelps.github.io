<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACCESS_RANGE</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_ACCESS_RANGE_KR"></A>ACCESS_RANGE</H2>
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _ACCESS_RANGE { 
&nbsp; &nbsp; SCSI_PHYSICAL_ADDRESS RangeStart; 
&nbsp; &nbsp; ULONG RangeLength; 
&nbsp; &nbsp; BOOLEAN RangeInMemory; 
} ACCESS_RANGE, *PACCESS_RANGE; 
&nbsp;</FONT></PRE>
<P>
An ACCESS_RANGE describes a memory or I/O port range used by an HBA.
<H3>Members</H3>
<DL>
<DT>
<B>RangeStart</B>
<DD>
Specifies the bus-relative base address of the range. This is an address that
can be passed into <B>ScsiPortGetDeviceBase</B>.
<BR>
<DT>
<B>RangeLength</B>
<DD>
Specifies the size in bytes or number of ports in the range. A miniport driver
must ensure that this value matches the range actually decoded by the adapter.
For example, if the HBA uses seven registers but responds to eight, this
member should be set to eight.
<BR>
<DT>
<B>RangeInMemory</B>
<DD>
TRUE indicates the range is in memory, rather than in I/O space.
</DL>
<H3>Comments</H3>
<P>
Each ACCESS_RANGE is an <B>AccessRanges</B>&nbsp;array element within the
PORT_CONFIGURATION_INFORMATION structure that is passed to a miniport driver’s
HwScsiFindAdapter routine.
<P>
If possible, the OS-specific port driver sets up each access range element
with a bus-relative HBA range for the miniport driver before calling the
miniport’s HwScsiFindAdapter routine. Otherwise, the port driver zeros range
elements for which it cannot supply configuration information.
<P>
If the port driver does supply a range, the miniport’s HwScsiFindAdapter
routine should use only the supplied addresses and should <I>never</I>&nbsp;attempt
to find other HBAs on the same bus using addresses of its own devising.
Attempting to access other bus-relative port or memory ranges when the port
driver has supplied range information, particularly in x86-only systems in
which some devices are initialized in x86 real mode, can cause other devices
on the bus to fail initialization or even cause the system to fail the boot
process.
<P>
Each miniport driver should have a set of bus-relative default ranges to try
if the OS-specific port driver cannot supply the information. A miniport
driver must call <B>ScsiPortValidateRange</B>&nbsp;to check the safety of any
miniport-supplied access range <I>before</I>&nbsp;it attempts to map such a range
with <B>ScsiPortGetDeviceBase</B>&nbsp;and use the returned logical addresses to
access an adapter, particularly if one of its HBAs has a BIOS.
<P>
Any access range that a miniport driver fills in for the OS-specific port
driver in the PORT_CONFIGURATION_INFORMATION must have the <B>RangeStart</B>
member set to a bus-relative address, such as a value returned by <B>ScsiPortGetBusData</B>.
<P>
The corresponding base logical address returned by <B>ScsiPortGetDeviceBase</B>
should be stored, usually in the miniport’s device extension, as the <B>RangeStart</B>
address for a mapped range of I/O ports or memory addresses used to call the <B>ScsiPortRead</B><I>Xxx</I>
and <B>ScsiPortWrite</B><I>Xxx</I>&nbsp;routines.
<H3>See Also</H3>
<P>
<A HREF="k302_6.htm">HwScsiFindAdapter</A>, <A HREF="k305_3.htm">PORT_CONFIGURATION_INFORMATION</A>,
<B><A HREF="k301_3.htm">ScsiPortConvertUlongToPhysicalAddress</A></B>,
<B><A HREF="k301_6.htm">ScsiPortGetBusData</A></B>, <B><A HREF="k301_7.htm">ScsiPortGetDeviceBase</A></B>,
<B>ScsiPortRead</B><I>Xxx</I>, <B><A HREF="k301_32.htm">ScsiPortValidateRange</A></B>,
<B>ScsiPortWrite</B><I>Xxx</I>&nbsp;
<P>
&nbsp;
<P>
&nbsp;
<P></FONT>
</BODY>
</HTML>
