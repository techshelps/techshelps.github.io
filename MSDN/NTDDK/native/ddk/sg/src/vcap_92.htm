<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>VC_OpenDevice</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_VC_OpenDevice"></A>VC_OpenDevice</H2>
<P>
<B>VCUSER_HANDLE<BR>
VC_OpenDevice(<BR>
&nbsp; &nbsp; PWCHAR </B><I>pDeviceName<B>,</I><BR>
&nbsp; &nbsp; int </B><I>DeviceIndex<B><BR>
&nbsp; &nbsp; </I>);</B>
<P>
The <B>VC_OpenDevice</B>&nbsp;function opens a specified video capture device.
<H5>Parameters</H5>
<DL>
<DT>
<I>pDeviceName</I>
<DD>
Pointer to a UNICODE string containing the name of the device to open. If
NULL, <I>DeviceIndex</I>&nbsp;specifies the device.
<BR>
<DT>
<I>DeviceIndex</I>
<DD>
Index number used to identify the device, if <I>pDriverName</I>&nbsp;is NULL. If <I>pDriverName</I>
points to a string, <I>DeviceIndex</I>&nbsp;must be zero (see the following <B>Comments</B>
section).
</DL>
<H5>Return Value</H5>
<P>
Returns a handle to the kernel-mode driver, if the operation succeeds.
Otherwise returns NULL.
<H5>Comments</H5>
<P>
A user-mode driver should call <B>VC_OpenDevice</B>&nbsp;when it receives a <A HREF="intro_34.htm">DRV_OPEN</A>
message. Typically, the driver receives multiple DRV_OPEN messages, because
DRV_OPEN is sent each time the client opens one of the video channels
(VIDEO_EXTERNALIN, VIDEO_IN, VIDEO_OUT, or VIDEO_EXTERNALOUT). The driver only
needs to call <B>VC_OpenDevice</B>&nbsp;for the client’s first DRV_OPEN message, as
illustrated by the <A HREF="vcap_4.htm">sample video
capture drivers</A>.
<P>
If <I>pDeviceName</I>&nbsp;points to a string, that string is used as the device
name. Because the current implementation does not allow a single kernel-mode
video capture driver to support more than one device, a device number is <I>not</I>
appended to this string. The <I>DeviceIndex</I>&nbsp;value must be zero. The <I>pDriverName
</I>value<I>&nbsp;</I>must be a pointer to the same string that was specified as
input to <B><A HREF="vcap_93.htm">VC_OpenProfileAccess</A></B>.
<P>
If <I>pDeviceName</I>&nbsp;is NULL, then the <I>DeviceIndex</I>&nbsp;parameter specifies
an index value. This value is appended to the device name “vidcap”, which is
defined by DD_VIDCAP_DEVICE_NAME_U in <I>ntddvidc.h</I>. For kernel-mode
drivers <A HREF="vcap_29.htm">using <I>VCKernel.lib</A></I>, this name
is used by <B><A HREF="vcap_128.htm">VC_Init</A></B>&nbsp;when creating a device object.
Thus, specifying a <I>DeviceIndex</I>&nbsp;value allows a user-mode driver to
attempt to open a video capture device without specifying a particular device
name, such as “bravado”. See the sample <I>msyuv.dll</I>&nbsp;driver for an example
of using the <I>DeviceIndex</I>&nbsp;parameter. (For more information about device
objects, see the <I>Kernel-Mode Drivers Design Guide</I>.)
<P>
The <B>VC_OpenDevice</B>&nbsp;function calls <B>CreateFile</B>, described in the
Win32 SDK, to open the device. As a result of this call, the kernel-mode
driver receives an IRP_MJ_CREATE function code. When a kernel-mode driver <A HREF="vcap_29.htm">using
<I>VCKernel.lib</A></I>&nbsp;receives this function code, its <B><A HREF="vcap_146.htm">DeviceOpenFunc</A></B>
function is called.
<P></FONT>
</BODY>
</HTML>
