<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Guidelines for Handling MCI Commands</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_Guidelines_for_Handling_MCI_Commands"></A>Guidelines for Handling MCI Commands</H3>
<P>
A developer’s most important guideline is to <I>make sure the driver design
adheres to the command descriptions and flag descriptions provided by the
Win32 SDK</I>. For example, the description of MCI_PLAY says that the starting
position is the current position and the ending position is the end of the
medium, unless the application includes MCI_FROM and MCI_TO flags.
<P>
If you need to provide extensions to the basic commands, do so in a manner
that is consistent with extended command sets that already exist.
<P>
If an application sends an MCI_PLAY command with MCI_NOTIFY set, subsequent
MCI_PAUSE and MCI_RESUME commands should not cancel the notification request.
The application should still be notified when the original play operation has
completed. The MCI_PAUSE and MCI_RESUME commands just delay the completion of
the MCI_PLAY operation; they do not cancel or modify it.
<P>
Drivers for compound devices can allow MCI_RECORD commands to be sent with the
the MCI_OPEN_ELEMENT flag set, but with the element file name specified as a
null-terminated, zero-length string. In this case the recorded data should be
saved in temporary storage. On receipt of a subsequent MCI_SAVE command, the
driver should move the temporary data into a permanent file. Alternatively,
drivers can disallow MCI_RECORD commands without a valid filename, and return
MCIERR_FILENAME_REQUIRED if the filename is not included.
<P></FONT>
</BODY>
</HTML>
