<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RegisterModule</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_RegisterModule"></A>RegisterModule</H2>
<P>
<B>RegisterModule( )</B>
<P>
This BIOS operation call is made from the 16-bit module to register a third
party DLL with the BIOS operation manager. This call returns a handle to the
16-bit caller which is used later to dispatch a call to the DLL.
<H3>Parameters</H3>
<DL>
<DT>
Client DS:SI
<DD>
ASCIIZ string of DLL name
<BR>
<DT>
Client DS:DI
<DD>
ASCIIZ string of Initialization Routine in the DLL. (Optional if DS = 0 and DI
= 0).
<BR>
<DT>
Client DS:BX
<DD>
ASCIIZ string to Dispatch routine in the DLL.
</DL>
<H3>Return Value</H3>
<P>
If successful the client’s carry is cleared and the client’s handle in AX will
equal (non Zero). Otherwise, the client carry will be set, and an error code
will be returned in AX. 
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Client AX</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Error Code</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
AX = 1
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DLL not found.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
AX = 2
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Dispatch routine not found.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
AX = 3
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Initialization routine not found.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
AX = 4
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Insufficient memory available.
</FONT></TABLE>
<H3>Comments</H3>
<P>
<B>RegisterModule</B>&nbsp;will load the DLL specified in DS:SI. The DLL
initialization routine is called and the DLL dispatch routine is stored. All
calls made from the <B>DispatchCall</B>&nbsp;are sent to this routine.
<H3>See Also</H3>
<P>
<B>UnRegisterModule</B>, <B>DispatchCall</B>
<P></FONT>
</BODY>
</HTML>
