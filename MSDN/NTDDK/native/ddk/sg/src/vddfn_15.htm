<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>VDDInstallIOHook</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_VDDInstallIOHook"></A>VDDInstallIOHook</H2>
<P>
<B>BOOL VDDInstallIOHook(</B><I>hVDD</I>,<B>&nbsp;</B><I>cPortRange</I>,<B>&nbsp;</B><I>pPortRange</I>,<B>
</B><I>10handler</I><B>)</B><BR>
<B>IN HANDLE</B>&nbsp; <I>hVDD</I><B>;</B><BR>
<B>IN WORD</B>&nbsp; <I>cPortRange</I><B>;</B><BR>
<B>IN PVDD_IO_PORTRANGE</B>&nbsp; <I>pPortRange</I><B>;</B><BR>
<B>IN PVDD_IO_HANDLERS</B>&nbsp; <I>10handler</I><B>;</B>
<P>
<B>VDDInstallIOHook</B>&nbsp;hooks the I/O Ports for the responsible VDD.
<H3>Parameters</H3>
<DL>
<DT>
<I>hVdd</I>
<DD>
Identifies the VDD.
<BR>
<DT>
<I>cPortRange</I>
<DD>
Specifies the number of VDD_IO_PORTRANGE structures.
<BR>
<DT>
<I>pPortRange</I>
<DD>
Points to the VDD_IO_PORTRANGE array.
<BR>
<DT>
<I>10handler</I>
<DD>
Points to the handler array pointer.
</DL>
<H3>Return Value</H3>
<P>
<B>VDDInstallIOHook</B>&nbsp;returns TRUE if successful. Otherwise, this function
returns FALSE and logs one of the following errors:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Value</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Meaning</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
ERROR_ACCESS_EXISTS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The VDD already has active I/O port handlers.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
ERROR_OUTOFMEMORY
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
There are insufficient resources for additional VDD port handler sets.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
ERROR_INVALID_ADDRESS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
One of the I/O port handlers has an invalid address.
</FONT></TABLE>
<H3>Comments</H3>
<P>
The last VDD to hook a port will always get control of the port. There is no
concept of chaining hooks.
<P>
<I>plOFn</I>&nbsp;must provide the byte read and write handlers. Others can be
NULL.
<P>
If word or string handlers are not provided, their effect will be emulated
using byte handlers.
<P>
VDDs must not hook DMA ports. The Win32 VDM component manages this for all the
clients and services provided to perform DMA operations. This includes any
attempt to access and modify DMA data.
<P>
VDDs should not hook video ports. A video port can be successfully hooked but
there is no guarantee that the I/O handler will get called.
<P>
Each VDD is allowed to install only one set of I/O hooks at a time.
<H3>See Also</H3>
<P>
<B>VDDDeInstalllOHook</B>
<P></FONT>
</BODY>
</HTML>
