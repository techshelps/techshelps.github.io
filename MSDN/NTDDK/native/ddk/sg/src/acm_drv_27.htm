<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACMDM_FORMAT_DETAILS</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_ACMDM_FORMAT_DETAILS"></A>ACMDM_FORMAT_DETAILS</H2>
<P>
The ACMDM_FORMAT_DETAILS message requests an ACM driver to return information
about a format associated with a specified format tag.
<H4>Parameters</H4>
<DL>
<DT>
<I>dwDriverID</I>
<DD>
Driver instance identifier. This is the value returned by the driver in
response to the <A HREF="intro_34.htm">DRV_OPEN</A>&nbsp;message.
<BR>
<DT>
<I>hDriver</I>
<DD>
Driver handle.
<BR>
<DT>
<I>uMsg</I>
<DD>
ACMDM_FORMAT_DETAILS
<BR>
<DT>
<I>lParam1</I>
<DD>
Pointer to an ACMFORMATDETAILS structure. (ACMFORMATDETAILS is defined in <I>msacm.h</I>
and described in the Win32 SDK.)
<BR>
<DT>
<I>lParam2</I>
<DD>
Contains one of the following flags, specified by the <I>fdwDetails</I>
parameter of the <B>acmFormatDetails</B>&nbsp;function, which is described in the
Win32 SDK:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Flag</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Meaning</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
ACM_FORMATDETAILSF_INDEX
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Indicates the <B>dwFormatIndex</B>&nbsp;member of the ACMFORMATDETAILS structure
contains a format index. The valid index range is from zero to one less than
the <B>cStandardFormats</B>&nbsp;member returned in the ACMFORMATTAGDETAILS
structure for the format tag. (See <A HREF="acm_drv_29.htm">ACMDM_FORMATTAG_DETAILS</A>.)
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
ACM_FORMATDETAILSF_FORMAT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Indicates the client has filled in the WAVEFORMATEX structure associated with
the ACMFORMATDETAILS structure.
</FONT></TABLE>
</DL>
<H4>Return Value</H4>
<P>
The driver should return MMSYSERR_NOERROR if the operation succeeds. Otherwise
it should return one of the MMSYSERR error codes defined in <I>mmsystem.h</I>,
or one of the ACMERR error codes defined in <I>msacm.h</I>. Possible error
codes include:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Error Code</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Meaning</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
MMSYSERR_NOTSUPPORTED
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The driver does not support the specified query operation.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
ACMERR_NOTPOSSIBLE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
The input parameter values do not represent a valid format or format tag.
</FONT></TABLE>
<H4>Comments</H4>
<P>
A client sends the ACMDM_FORMAT_DETAILS message by calling the driver’s <B><A HREF="intro_44.htm">DriverProc</A></B>
entry point, passing the specified parameters. The ACM sends this message when
an application calls the <B>acmFormatDetails</B>&nbsp;function, which is described
in the Win32 SDK.
<P>
All ACM drivers must support this message.
<P>
The client can do either of the following:
<UL>
<LI>
Specify a format index, in order to obtain a description of the format
associated with the index.
<P>
<LI>
Specify a format description, in order to validate the format and obtain the
format’s string description.
</UL>
<P>
The client specifies the format tag in the ACMFORMATDETAILS structure’s <B>dwFormatTag</B>
member. The driver returns information for a particular format belonging to
the format tag, as follows:
<UL>
<LI>
If the ACM_FORMATDETAILSF_INDEX flag is set, the client has specified an index
value in the ACMFORMATDETAILS structure’s <B>dwFormatIndex</B>&nbsp;member. The
driver fills in the WAVEFORMATEX structure for the format associated with the
specified index value. It also fills in the ACMFORMATDETAILS structure’s <B>szFormat</B>,
<B>fdwSupport</B>, and <B>cbStruct</B>&nbsp;members.
<P>
<LI>
If the ACM_FORMATDETAILSF_FORMAT flag is set, the client has filled in the
WAVEFORMATEX structure. The driver validates the structure contents and, if
the contents are valid, fills in the ACMFORMATDETAILS structure’s <B>szFormat</B>,
<B>fdwSupport</B>, and <B>cbStruct</B>&nbsp;members.
</UL>
<P>
Before calling the driver’s <B>DriverProc</B>&nbsp;function, the ACM verifies that:
<UL>
<LI>
The ACMFORMATDETAILS structure and its associated WAVEFORMATEX structure are
readable and writeable.
<P>
<LI>
The size of the ACMFORMATDETAILS structure (contained in its <B>cbStruct</B>
member) is at least the structure’s defined size. (The structure’s size can be
larger than its defined size, to allow for a longer <B>szFormat</B>&nbsp;member or
to allow newer, larger structure definitions to be used within drivers under
development.)
<P>
<LI>
The size of the WAVEFORMATEX structure associated with the ACMFORMATDETAILS
structure’s <B>pwfx</B>&nbsp;member is at least as large as the generic
WAVEFORMATEX structure’s defined size. (See <B>The WAVEFORMATEX Structure</B>
below.)
<P>
<LI>
The ACMFORMATDETAILS structure’s <B>fdwSupport</B>&nbsp;member contains zero.
<P>
<LI>
The <I>lParam2</I>&nbsp;parameter contains a valid flag value.
</UL>
<P>
Before returning, the driver must set the ACMFORMATDETAILS structure’s <B>cbStruct</B>
member to the actual number of bytes returned. The value returned in <B>cbStruct</B>
must not be greater than the value received.
<H5><A NAME="DDK_The_WAVEFORMATEX_Structure"></A>The WAVEFORMATEX Structure</H5>
<P>
The WAVEFORMATEX structure is a generic structure for describing a waveform
format. Generally, you will use this structure as a basis for defining
structures for your specific format types, as has been done in the <A HREF="acm_drv_5.htm#DDK_IMA_ADPCM_Audio_Codec">IMA
ADPCM Audio Codec</A>. (For an example, see IMAADPCMWAVEFORMAT in <I>mmreg.h</I>.)
When a client sends an ACMDM_FORMAT_DETAILS message, it specifies the address
of a structure that you have defined for the specified format type. This
structure is typically larger than the generic WAVEFORMATEX structure.
<P>
For more information about format tags and format structures, see <A HREF="acm_drv_4.htm">Format
Tags and Filter Tags</A>&nbsp;and <A HREF="acm_drv_14.htm">Defining
Format Structures and Filter Structures</A>.
<H5><A NAME="DDK_Returning_a_Description_String"></A>Returning a Description String</H5>
<P>
The WAVEFORMATEX structure’s <B>szFormat</B>&nbsp;member is used for returning a
format description string. If an ACM driver returns a zero-length string in <B>szFormat</B>,
the ACM creates an internationalized description string for the format. This
string includes the format’s speed (in Hz), bit depth, and channel setting
(mono or stereo), based on the contents of the <B>nSamplesPerSec</B>, <B>wBitsPerSample</B>,
and <B>nChannels</B>&nbsp;members of the WAVEFORMATEX structure. If <B>wBitsPerSample</B>
contains zero, the ACM does not include the bit depth in the description
string. You can provide your own description string and return it in <B>szFormat</B>,
but allowing ACM to generate an internationalized string is preferred.
<P></FONT>
</BODY>
</HTML>
