<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Loading and Unloading a Command Table</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_Loading_and_Unloading_a_Command_Table"></A>Loading and Unloading a Command Table</H4>
<P>
A driver loads a customized command table by calling <B><A HREF="mcidrv_51.htm">mciLoadCommandResource</A></B>,
as follows: 
<PRE><FONT FACE="Courier" SIZE="2">uCommandTable = mciLoadCommandResource(hModuleInstance, &quot;mcivcr&quot;, 0);
&nbsp;</FONT></PRE>
<P>
The call should be made when <B><A HREF="intro_44.htm">DriverProc</A></B>
receives a <A HREF="intro_33.htm">DRV_LOAD</A>&nbsp;message. In the example, the
command table’s name is “mcivcr”, which means “mcivcr” is the <I>nameID</I>
argument to the table’s RCDATA statement. Additionally, if you place the
command table in a separate file, the file must be named <I>mcivcr.mci</I>.
The file must reside in a directory that is accessible by Win32’s <B>CreateFile</B>
function.
<P>
A driver must unload its customized command table by calling <B><A HREF="mcidrv_49.htm">mciFreeCommandResource</A></B>.
This call should be made when <B><A HREF="intro_44.htm">DriverProc</A></B>
receives a <A HREF="intro_31.htm">DRV_FREE</A>&nbsp;message.
<P>
Every driver that defines a customized command table must use <B><A HREF="mcidrv_51.htm">mciLoadCommandResource</A></B>
and <B><A HREF="mcidrv_49.htm">mciFreeCommandResource</A></B>&nbsp;to load
and unload the table. There is one exception to this rule <FONT
FACE="Symbol">&#190;</FONT> if the command table defines a new device type <I>and</I>
if the table resides in a separate file, then the driver does not need to
explicitly load and unload the table. In this case, <I>winmm.dll</I>&nbsp;uses the
device type name that the application specifies with the MCI_OPEN message to
locate and load the command table.
<P>
In other words, a driver must explicitly load and unload its customized
command table if the table is device-specific (as opposed to being for a
device type) <I>or</I>&nbsp;if the table is linked to the driver.
<P>
If you create a customized command table for a one of the device types
provided by Microsoft, and if you put the table in a separate file, do not use
the device type name as the file name. Otherwise, other drivers will not be
able to access the device type table provided by Microsoft because your table
will override it.
<P></FONT>
</BODY>
</HTML>
