<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Supporting MIDI Devices</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_Supporting_MIDI_Devices"></A>Supporting MIDI Devices</H3>
<P>
Functions in <I>soundlib.lib</I>&nbsp;provide support for MIDI synthesizers and
external MIDI devices. Both Ad Lib and OPL3 synthesizer types are supported.
External MIDI devices are supported in UART mode. All of these capabilities
are utilized by <I>sndblst.sys</I>.
<H4><A NAME="DDK_Supporting_MIDI_Synthesizers"></A>Supporting MIDI Synthesizers</H4>
<P>
To make use of the synthesizer functions provided in <I>soundlib.lib</I>, do
the following:
<UL>
<LI>
Within the driver object received by <B>DriverEntry</B>, assign <B><A HREF="audiodrv_169.htm">SoundDispatch</A></B>
to be the driver’s main dispatcher for IRP control codes. See “<A HREF="audiodrv_27.htm">Examining
<B>DriverEntry</B>&nbsp;in <I>sndblst.sys</A></I>.”
<P>
<LI>
Call the <B><A HREF="audiodrv_208.htm">SynthInit</A></B><I>&nbsp;</I>function for each
card, during <A HREF="audiodrv_28.htm">hardware and
driver initialization</A>.
<P>
<LI>
Call the <B><A HREF="audiodrv_207.htm">SynthCleanup</A></B>&nbsp;function for each
card, just before the driver is unloaded.
</UL>
<P>
Additionally, if your hardware generates an interrupt for timer expiration,
your driver must provide code to connect to the interrupt and to dismiss the
interrupt. This interrupt is not handled by <I>soundlib.lib</I>.
<H4><A NAME="DDK_Supporting_External_MIDI_Devices"></A>Supporting External MIDI Devices</H4>
<P>
To use <I>soundlib.lib</I>&nbsp;for handling external MIDI devices, you must:
<UL>
<LI>
Within the driver object received by <B>DriverEntry</B>, assign <B><A HREF="audiodrv_169.htm">SoundDispatch</A></B>
to be the driver’s main dispatcher for IRP control codes. See “<A HREF="audiodrv_27.htm">Examining
<B>DriverEntry</B>&nbsp;in <I>sndblst.sys</A></I>.”
<P>
<LI>
Define a <A HREF="audiodrv_218.htm">SOUND_DEVICE_INIT</A>&nbsp;structure for MIDI
input, and another for MIDI output. The structures’ <B>DispatchRoutine</B>
members must be set to the address of <B><A HREF="audiodrv_185.htm">SoundMidiDispatch</A></B>,
which is the MIDI dispatch routine within <I>soundlib.lib</I>&nbsp;for <B>DeviceIoControl</B>
messages.
<P>
<LI>
Define a <A HREF="audiodrv_212.htm">MIDI_INFO</A>&nbsp;structure. A single MIDI_INFO
structure can support both MIDI output and MIDI input.
<P>
<LI>
Call <B><A HREF="audiodrv_166.htm">SoundCreateDevice</A></B>&nbsp;once for each
SOUND_DEVICE_INIT structure you have defined.
</UL>
<P></FONT>
</BODY>
</HTML>
