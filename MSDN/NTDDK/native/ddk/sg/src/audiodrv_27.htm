<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Examining DriverEntry in sndblst.sys</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_Examining_DriverEntry_in_sndblst.sys"></A>Examining DriverEntry in <I>sndblst.sys</I></H4>
<P>
Like all kernel-mode drivers, <I>sndblst.sys</I>&nbsp;supplies an initialization
function called <B>DriverEntry</B>&nbsp;to handle initialization and configuration
operations. Because this code is only executed once, it is located in the
driver’s INIT data segment, which is marked as discardable.
<P>
For more information about <B>DriverEntry</B>, see <B><A HREF="intro_43.htm">DriverEntry</B>
for Multimedia Drivers</A>.
<P>
The <B>DriverEntry</B>&nbsp;function for <I>sndblst.sys</I>&nbsp;is located in <I>\src\mmedia\sndblst\driver\init.c</I>.
As a first step, the function initializes the received device object’s
dispatch table. Drivers using <I>soundlib.lib</I>&nbsp;must specify <B><A HREF="audiodrv_169.htm">SoundDispatch</A></B>
as the dispatcher for the IRP_MJ_CLEANUP, IRP_MJ_CLOSE, IRP_MJ_CREATE,
IRP_MJ_DEVICE_CONTROL, IRP_MJ_READ ,and IRP_MJ_ WRITE control codes.
<P>
The <B>DriverEntry</B>&nbsp;function calls <B><A HREF="audiodrv_171.htm">SoundEnumSubkeys</A></B>
in <I>soundlib.lib</I>&nbsp;to locate the registry entry for each card. For each
card found, <B>SoundEnumSubkeys</B>&nbsp;calls back into <B>SoundCardInstanceInit</B>,
also located in <I>init.c.</I>&nbsp;If any callback to <B>SoundCardInstanceInit</B>
returns a failure, <B>SoundEnumSubkeys</B>&nbsp;returns immediately. After <B>SoundEnumSubkeys</B>
returns, <B>DriverEntry</B>&nbsp;calls <B><A HREF="audiodrv_206.htm">SoundWriteRegistryDWORD</A></B>
to write each card’s initialization status into the registry.
<P>
<B>Note:</B>&nbsp; The <B>DriverEntry</B>&nbsp;function for <I>sndblst.sys</I>&nbsp;searches
for multiple cards. Both <I>soundlib.lib</I>&nbsp;and the registry’s multimedia
device keys can handle multiple sound cards. However, the current
implementation of <I>sndblst.sys</I>&nbsp;references only one card for I/O
operations.
<P></FONT>
</BODY>
</HTML>
