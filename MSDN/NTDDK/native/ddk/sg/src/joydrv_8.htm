<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Calculation of Calibration Values</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_Calculation_of_Calibration_Values"></A>Calculation of Calibration Values</H3>
<P>
To calculate the base and delta calibration values, the Joystick application
sets the base value to 0 and the delta values to 1. It then polls the joystick
driver while the user holds the joystick at each corner of the device
coordinate space. This produces the actual value range returned by the device
for each coordinate.
<P>
After retrieving the coordinate ranges specified by the <B>joyGetDevCaps</B>
function, the application uses the following formulas to calculate new base
and delta values.
<PRE><FONT FACE="Courier" SIZE="2">wDelta = (wTargetMax - wTargetMin) / (wActualMax - wActualMin) 
wBase = wActualMin * wDelta - wTargetMin
</FONT></PRE>
<P>
In the following example, the joystick returns <I>x</I>&nbsp;coordinate values in
the range 43 to 345, compared to a logical value range of 0 to 65535:
<PRE><FONT FACE="Courier" SIZE="2">wDelta = (65535-0) / (345-43)<BR>       = 216
wBase  = 43 * 216 - 0<BR>       = 9288
</FONT></PRE>
<P></FONT>
</BODY>
</HTML>
