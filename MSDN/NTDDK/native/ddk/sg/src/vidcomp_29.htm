<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Drawing the Data</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_Drawing_the_Data"></A>Drawing the Data</H4>
<P>
The client application sends<A HREF="vidcomp_56.htm">&nbsp;ICM_DRAW</A>&nbsp;each time it has
data to decompress. (Your driver should use this message to decompress data.
It should wait for the <A HREF="vidcomp_67.htm">ICM_DRAW_START</A>&nbsp;message
before it begins to render the data.) The client application uses the flags in
the file index to ensure the first frame in a series of decompressed frames
starts with a key-frame boundary. Your driver must allocate the memory it
needs for the decompressed data. 
<P>
The <A HREF="vidcomp_90.htm">ICDRAW</A>&nbsp;data structure specified in <I>dwParam1</I>
contains the decompression parameters. The value specified in <I>dwParam2</I>
specifies the size of the structure. The format of the input data is specified
in a BITMAPINFOHEADER structure pointed to by <B>lpFormat</B>. The input data
is in a buffer specified by <B>lpData</B>. The number of bytes in the input
buffer is specified by <B>cbData</B>. 
<P>
The client application sets the ICDRAW_HURRYUP flag in the <B>dwFlags</B>
member to direct your driver to decompress data at a faster rate. For example,
the client application might use this flag when the video is starting to lag
behind the audio. If your driver cannot speed up its decompression and
rendering performance, it might be necessary to avoid rendering a frame of
data. The client application sets the ICDRAW_UPDATE flag and sets <B>lpData</B>
to NULL to have your driver update the screen based on data previously
received. 
<P>
The client application sets the ICDRAW_PREROLL flag if it is sending data in
advance of the data to be rendered. For example, if the client application
will display frame 10 of a compressed sequence, it sets this flag for the
first 9 frames. This sends the key frame and other intermediate frames to the
driver so it can decompress the tenth frame.
<P>
The client application sets the ICDRAW_UPDATE flag to have the driver refresh
the screen.
<P>
The ICDRAW_NOTKEYFRAME flag indicates the data is not a key frame.
<P>
The ICDRAW_NULLFRAME flag indicates the previous frame should be repeated.
<P>
When your driver has finished decompressing the data, it returns ICERR_OK.
After the driver returns from this message, the client application deallocates
or reuses the memory containing the format and image data. If your driver
needs the format or image data for future use, it should copy the data it
needs before it returns from the message.
<P></FONT>
</BODY>
</HTML>
