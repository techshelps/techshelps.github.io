<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting the Video Data Format</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_Setting_the_Video_Data_Format"></A>Setting the Video Data Format</H3>
<P>
Developers of video capture clients expect video capture data to be stored as
device independent bitmaps (DIBs). DIB contents are described by BITMAPINFO
and BITMAPINFOHEADER structures, which are discussed in the Win32 SDK. A
client can specify a data format, or query the driver for the current format,
by sending the driver a <A HREF="vcap_45.htm">DVM_FORMAT</A>&nbsp;message and
including the address of a BITMAPINFOHEADER structure.
<P>
You can also allow users to modify the format. Typically, you include format
options in the dialog boxes associated with VIDEO_IN and VIDEO_OUT channels,
and your driver displays these dialog boxes when it receives <A HREF="vcap_43.htm">DVM_DIALOG</A>
messages. For more information, see <A HREF="vcap_10.htm">Configuring
Video Channels</A>. 
<P>
The sample video capture drivers do not support <A HREF="vcap_45.htm">DVM_FORMAT</A>
for the VIDEO_OUT channel, because the VIDEO_OUT channel is handled by <A HREF="vidcomp.htm">Video
Compression Manager drivers</A>.
<P>
Your driver should provide default values for all format variables. These
default values should represent a format that can be handled most efficiently
by the video capture hardware. The driver should use the default values if
client-specified (via <A HREF="vcap_45.htm">DVM_FORMAT</A>) or user-specified
(via <A HREF="vcap_43.htm">DVM_DIALOG</A>) values are not available.
<P>
Following is a typical scenario in which a client modifies the format because
of limited system storage space:
<OL>
<LI>
Prior to opening an input stream, a client sends a <A HREF="vcap_45.htm">DVM_FORMAT</A>
message, with the VIDEO_CONFIGURE_GET flag set, to determine the current
format.
<P>
<LI>
The client calculates the amount of storage needed to store a captured video
stream if the current format is used.
<P>
<LI>
The client attempts to allocate enough storage to save the stream. The
allocation fails because there is not enough storage space available.
<P>
<LI>
The client sends a <A HREF="vcap_45.htm">DVM_FORMAT</A>&nbsp;message to change the
format to one that requires less storage space.
<P>
<LI>
The client again attempts to allocate enough storage to save the stream. This
time the allocation succeeds.
<P>
<LI>
The client opens the stream and saves the input data. (For details, see <A HREF="vcap_14.htm">Transferring
Video Capture Data</A>.)
</OL>
<P></FONT>
</BODY>
</HTML>
