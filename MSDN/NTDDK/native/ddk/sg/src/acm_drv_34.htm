<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ACMDM_STREAM_OPEN</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_ACMDM_STREAM_OPEN"></A>ACMDM_STREAM_OPEN</H2>
<P>
The ACMDM_STREAM_OPEN message requests an ACM driver to either open a
conversion stream or indicate whether the specified conversion is supported.
<H4>Parameters</H4>
<DL>
<DT>
<I>dwDriverID</I>
<DD>
Driver instance identifier. This is the value returned by the driver in
response to the <A HREF="intro_34.htm">DRV_OPEN</A>&nbsp;message.
<BR>
<DT>
<I>hDriver</I>
<DD>
Driver handle.
<BR>
<DT>
<I>uMsg</I>
<DD>
ACMDM_STREAM_OPEN
<BR>
<DT>
<I>lParam1</I>
<DD>
Pointer to an <A HREF="acm_drv_46.htm">ACMDRVSTREAMINSTANCE</A>
structure.
<BR>
<DT>
<I>lParam2</I>
<DD>
Not used.
</DL>
<H4>Return Value</H4>
<P>
The driver should return MMSYSERR_NOERROR if the operation succeeds. Otherwise
it should return one of the MMSYSERR error codes defined in <I>mmsystem.h</I>,
or one of the ACMERR error codes defined in <I>msacm.h</I>. If a specified
conversion is not supported, the driver should return ACMERR_NOTPOSSIBLE.
<H4>Comments</H4>
<P>
A client sends the ACMDM_STREAM_OPEN message by calling the driver’s <B><A HREF="intro_44.htm">DriverProc</A></B>
entry point, passing the specified parameters. The ACM sends this message when
an application calls the <B>acmStreamOpen</B>&nbsp;function, which is described in
the Win32 SDK.
<P>
All ACM drivers that provide stream conversions must support this message. For
more information about stream conversions, see <A HREF="acm_drv_9.htm">Converting
Data Streams</A>.
<P>
If the client has specified the ACM_STREAMOPENF_QUERY flag (contained in the <A HREF="acm_drv_46.htm">ACMDRVSTREAMINSTANCE</A>
structure’s <B>fdwOpen</B>&nbsp;member), then the driver should not open a stream
instance. It should return MMSYSERR_NOERROR if the conversion is possible, and
MMSYSERR_NOTPOSSIBLE otherwise.
<P>
When a driver receives an ACMDM_STREAM_OPEN message, it should first determine
if it can perform the specified conversion. If it can, then it should perform
instance initialization operations for the stream, such as determining which
conversion routines to use and allocating instance-specific resources.
<P>
Store stream instance data in a local, dynamically allocated structure. Store
a pointer to the structure in the <A HREF="acm_drv_46.htm">ACMDRVSTREAMINSTANCE</A>
structure’s <B>dwDriver</B>&nbsp;member.
<P>
If the driver supports asynchronous operations, and if the client has
specified the ACM_STREAMOPENF_ASYNC flag (contained in the <A HREF="acm_drv_46.htm">ACMDRVSTREAMINSTANCE</A>
structure’s <B>fdwOpen</B>&nbsp;member), then the driver should send the client an <A HREF="acm_drv_41.htm">MM_ACM_OPEN</A>
callback message, by calling the <B><A HREF="intro_42.htm">DriverCallback</A></B>
function, after the operation completes.
<P>
Before calling the driver’s <B>DriverProc</B>&nbsp;function, the ACM verifies that:
<UL>
<LI>
The <A HREF="acm_drv_46.htm">ACMDRVSTREAMINSTANCE</A>&nbsp;structure’s <B>fdwOpen</B>
member contains valid flag values.
<P>
<LI>
The source and destination WAVEFORMATEX structures are readable.
<P>
<LI>
If a WAVEFILTER structure is specified, it is readable and the source and
destination format structures contain identical information.
<P>
<LI>
If the client has specified different source and destination format tags, then
the driver has declared itself to be a <A HREF="acm_drv_3.htm#DDK_codecs">codec</A>&nbsp;by setting
ACMDRIVERDETAILS_SUPPORTF_CODEC in the ACMDRIVERDETAILS structure’s <B>fdwSupport</B>
member. (See <A HREF="acm_drv_23.htm">ACMDM_DRIVER_DETAILS</A>.)
<P>
<LI>
If the client has specified source and destination formats associated with a
single format tag, then the driver has declared itself to be a <A HREF="acm_drv_3.htm#DDK_converters">converter</A>
by setting ACMDRIVERDETAILS_SUPPORTF_CONVERTER in the ACMDRIVERDETAILS
structure’s <B>fdwSupport</B>&nbsp;member. (See <A HREF="acm_drv_23.htm">ACMDM_DRIVER_DETAILS</A>.)
<P>
<LI>
If the client has specified a filter operation, then the driver has declared
itself to be a <A HREF="acm_drv_3.htm#DDK_filters">filter</A>&nbsp;by setting
ACMDRIVERDETAILS_SUPPORTF_FILTER in the ACMDRIVERDETAILS structure’s <B>fdwSupport</B>
member. (See <A HREF="acm_drv_23.htm">ACMDM_DRIVER_DETAILS</A>.)
</UL>
<P>
If the client has specified the ACM_STREAMOPENF_NONREALTIME flag (contained in
the <A HREF="acm_drv_46.htm">ACMDRVSTREAMINSTANCE</A>&nbsp;structure’s <B>fdwOpen</B>
member), then the driver can perform the conversion without time constraints.
However, if this flag is not specified, and the driver cannot perform the
conversion in real time, then it should return ACMERR_NOTPOSSIBLE. For more
information, see <A HREF="acm_drv_9.htm#DDK_Real_Time_Conversions">Real Time Conversions</A>.
<P></FONT>
</BODY>
</HTML>
