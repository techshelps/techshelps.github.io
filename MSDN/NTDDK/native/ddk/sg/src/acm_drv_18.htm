<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Writing Portable ACM Drivers</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_Writing_Portable_ACM_Drivers"></A>Writing Portable ACM Drivers</H3>
<P>
Audio Compression Managers are provided for Windows NT&reg; and for Windows<FONT
FACE="Symbol">&#226;</FONT> 95. The interfaces provided by both ACMs are
identical. You can write binary-compatible ACM drivers that are portable
between Windows NT and Windows 95, by obeying the following rules:
<UL>
<LI>
Do not call API functions that are only available under Windows NT. (Almost
all functions described in the Win32 SDK are available under both Windows NT
and Windows 95.)
<P>
<LI>
Do not compile with the UNICODE constant defined.
</UL>
<P>
The second rule requires further discussion. Windows NT provides Unicode
versions of all Win32 API functions, but Windows 95 does not (with a few
exceptions). However, ACM drivers must <I>always</I>&nbsp;pass Unicode strings to
the ACM, whether the ACM is running under Windows NT or Windows 95. To get
around this conflict, your ACM driver can include a copy of the <B>LoadStringCodec</B>
function that is defined in the sample ACM drivers.
<P>
The <B>LoadStringCodec</B>&nbsp;function loads a string resource and converts the
string to Unicode, even if the source code was not compiled with the UNICODE
constant defined. The converted string can then be passed to the ACM (in an
ACMDRIVERDETAILS structure, for example). You can also convert between Unicode
and ANSI strings by calling the <B>MultiByteToWideChar</B>&nbsp;and <B>WideCharToMultiByte</B>
functions that are described in the Win32 SDK.
<P>
The sample ACM drivers are written to be binary-compatible with Windows NT and
Windows 95.
<P></FONT>
</BODY>
</HTML>
