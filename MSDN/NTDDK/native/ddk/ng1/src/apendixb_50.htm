<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>B.9.3  Leaving a Subsystem-Parallel Stack (Exit Module)</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_B.9.3_Leaving_a_Subsystem_Parallel_Stack_Exit_Module__NG"></A>B.9.3  Leaving a Subsystem-Parallel Stack (Exit Module)</H3>
<P>
In STREAMS, a thread executing a service procedure remembers if it is
executing within a subsystem-parallel stack, which is necessary if the thread
calls <B>bufcall</B>&nbsp;or <B>timeout</B>&nbsp;while it is within the stack. This
feature preserves the subsystem-parallel stack requirement of a nonpreemptive
uniprocessor environment.
<P>
If the thread leaves the stack by calling the put procedure of the next queue,
STREAMS must be notified. The mechanism for this is the exit module. The stack
includes an upper exit module and a lower exit module, similar to insulating
modules, one for each boundary of a subsystem. The upper exit module queues
all puts on its read queue to its service procedure.
<P>
The lower exit module queues all puts on its write queue to its service
procedure.
<P>
The plumbing daemon of a subsystem-parallel stack must ensure that the
appropriate exit modules are pushed above and below the stack. Sample source
code for the exit modules is included in the Windows NT DDK. The insulating
and exit modules may be combined into a single module if desired.
<P></FONT>
</BODY>
</HTML>
