<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>B.3.6  Blocking Primitives for Open and Close Procedures</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_B.3.6_Blocking_Primitives_for_Open_and_Close_Procedures_NG"></A>B.3.6  Blocking Primitives for Open and Close Procedures</H3>
<P>
Instead of calling <B>KeWaitForMutexObject</B>, <B>KeWaitForMultipleObjects</B>,
and <B>KeWaitForSingleObject</B>, a STREAMS stack must use the following
corresponding functions, each of which has a queue pointer as the first
parameter:
<UL>
<LI>
StrmWaitForMutexObject
<P>
<LI>
StrmWaitForMultipleObjects
<P>
<LI>
StrmWaitForSingleObject
</UL>
<H5>StrmWaitForMutexObject</H5>
<P>
The function <B>StrmWaitForMutexObject</B>&nbsp;allows the calling routine to wait
until the specified mutex object attains a signaled state.
<PRE><FONT FACE="Courier" SIZE="2">NTSTATUS
StrmWaitForMutexObject(
&nbsp; &nbsp; IN queue_t <I>*Queue</I>,
&nbsp; &nbsp; IN PKMUTEX <I>Mutex</I>,
&nbsp; &nbsp; IN KWAIT_REASON <I>WaitReason</I>,
&nbsp; &nbsp; IN KPROCESSOR_MODE <I>WaitMode</I>,
&nbsp; &nbsp; IN BOOLEAN <I>Alertable</I>,
&nbsp; &nbsp; IN PLARGE_INTEGER <I>Timeout</I>&nbsp;OPTIONAL
&nbsp; &nbsp; );
&nbsp;</FONT></PRE>
<H5>Parameters</H5>
<DL>
<DT>
Queue
<DD>
Points to the queue of the calling open or close routine.
<BR>
<DT>
<I>Mutex</I>
<DD>
Points to the mutex object for which to wait.
<BR>
<DT>
<I>WaitReason</I>
<DD>
Specifies the reason for waiting.
<BR>
<DT>
<I>WaitMode</I>
<DD>
Specifies the processor wait mode to be used.
<BR>
<DT>
<I>Alertable</I>
<DD>
Specifies if the wait is alertable.
<BR>
<DT>
<I>Timeout</I>
<DD>
Optionally points to the timeout period.
</DL>
<H5>StrmWaitForMultipleObjects</H5>
<P>
The function <B>StrmWaitForMultipleObjects</B>&nbsp;allows the calling routine to
wait until the specified objects attain a signaled state.
<PRE><FONT FACE="Courier" SIZE="2">NTSTATUS
StrmWaitForMultipleObjects(
&nbsp; &nbsp; IN queue_t <I>*Queue</I>,
&nbsp; &nbsp; IN CCHAR <I>Count</I>,
&nbsp; &nbsp; IN PVOID <I>Object[]</I>,
&nbsp; &nbsp; IN WAIT_TYPE <I>WaitType</I>,
&nbsp; &nbsp; IN KWAIT_REASON <I>WaitReason</I>,
&nbsp; &nbsp; IN KPROCESSOR_MODE <I>WaitMode</I>,
&nbsp; &nbsp; IN BOOLEAN <I>Alertable</I>,
&nbsp; &nbsp; IN PLARGE_INTEGER <I>Timeout</I>&nbsp;OPTIONAL,
&nbsp; &nbsp; IN PKWAIT_BLOCK <I>WaitBlockArray</I>&nbsp;OPTIONAL
&nbsp; &nbsp; );
&nbsp;</FONT></PRE>
<H5>Parameters</H5>
<DL>
<DT>
<I>Queue</I>
<DD>
Points to the queue of the calling open or close routine.
<BR>
<DT>
<I>Count</I>
<DD>
Specifies the number of objects for which to wait.
<BR>
<DT>
<I>Object[]</I>
<DD>
Points to an array of pointers to dispatcher objects.
<BR>
<DT>
<I>WaitType</I>
<DD>
Specifies the wait type (<B>WaitAll</B>&nbsp;or <B>WaitAny</B>).
<BR>
<DT>
<I>WaitReason</I>
<DD>
Specifies the reason for waiting.
<BR>
<DT>
<I>WaitMode</I>
<DD>
Specifies the processor wait mode to be used.
<BR>
<DT>
<I>Alertable</I>
<DD>
Specifies if the wait is alertable.
<BR>
<DT>
<I>Timeout</I>
<DD>
Optionally points to the timeout period.
<BR>
<DT>
<I>WaitBlockArray</I>
<DD>
Optionally points to an array of wait blocks.
</DL>
<H5>StrmWaitForSingleObject </H5>
<P>
The function <B>StrmWaitForSingleObject</B>&nbsp;allows the calling routine to wait
until the specified object attains a Signaled state.
<PRE><FONT FACE="Courier" SIZE="2">NTSTATUS
StrmWaitForSingleObject(
&nbsp; &nbsp; IN queue_t <I>*Queue</I>,
&nbsp; &nbsp; IN PVOID <I>Object</I>,
&nbsp; &nbsp; IN KWAIT_REASON <I>WaitReason</I>,
&nbsp; &nbsp; IN KPROCESSOR_MODE <I>WaitMode</I>,
&nbsp; &nbsp; IN BOOLEAN <I>Alertable</I>,
&nbsp; &nbsp; IN PLARGE_INTEGER <I>Timeout</I>&nbsp;OPTIONAL
&nbsp; &nbsp; );
&nbsp;</FONT></PRE>
<H5>Parameters</H5>
<DL>
<DT>
<I>Queue</I>
<DD>
Points to the queue of the calling open or close routine.
<BR>
<DT>
<I>Object</I>
<DD>
Points to the dispatcher object.
<BR>
<DT>
<I>WaitReason</I>
<DD>
Specifies the reason for waiting.
<BR>
<DT>
<I>WaitMode</I>
<DD>
Specifies the processor wait mode to be used.
<BR>
<DT>
<I>Alertable</I>
<DD>
Specifies if the wait is alertable.
<BR>
<DT>
<I>Timeout</I>
<DD>
Optionally points to the timeout period.
</DL>
<P></FONT>
</BODY>
</HTML>
