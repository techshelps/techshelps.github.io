<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>B.2.3  STREAMS Interface Functions</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_B.2.3_STREAMS_Interface_Functions_NG"></A>B.2.3  STREAMS Interface Functions</H3>
<P>
To use the STREAMS environment, STREAMS drivers and modules that are part of
the transport provider must conform to the interface prototyped in this
section. Interface definitions are specified in Reference 1 (Further Readings
on Streams). STREAMS drivers/modules must provide the following interface
procedures which are called by STREAMS:
<UL>
<LI>
<I>Xxx</I><B>Open</B>
<P>
<LI>
<I>Xxx</I><B>Close</B>
<P>
<LI>
<I>Xxx</I><B>Put</B>
<P>
<LI>
<I>Xxx</I><B>Srv</B>
</UL>
<P>
<B>Note</B>&nbsp; The prefix “<I>Xxx”</I>&nbsp;is used as an example only. In real life,
a descriptive prefix is used for these procedures. For example, the open
procedure of the TCP driver is called <B>TcpOpen</B>; the close procedure of
the UDP driver is called <B>UdpClose</B>.
<H5>Xxxopen</H5>
<P>
The procedure <I>Xxx</I><B>open</B>&nbsp;is called by STREAMS to open a STREAMS
driver or module. See Reference 1 for details.
<PRE><FONT FACE="Courier" SIZE="2">INT
Xxxopen(
&nbsp; &nbsp; IN STRUCT queue <I>*rq</I>,
&nbsp; &nbsp; IN OUT dev_t <I>*devp</I>,
&nbsp; &nbsp; IN INT <I>flag</I>,
&nbsp; &nbsp; IN INT <I>sflag</I>,
&nbsp; &nbsp; IN VOID <I>*credp</I>
&nbsp; &nbsp; );
&nbsp;</FONT></PRE>
<H5>Parameters</H5>
<DL>
<DT>
<I>rq</I>
<DD>
Points to read queue.
<BR>
<DT>
<I>devp</I>
<DD>
Points to assigned device number.
<BR>
<DT>
<I>flag</I>
<DD>
Indicates the Open() flag; 0 for modules.
<BR>
<DT>
<I>sflag</I>
<DD>
Indicates the stream flag, which is CLONEOPEN or MODOPEN.
<BR>
<DT>
<I>credp</I>
<DD>
Unused.
</DL>
<P>
After being registered by <B>StrmRegisterDriver</B>, a STREAMS driver can be
opened via the Windows NT path:
<P>
&nbsp; &nbsp; \Device\Streams\<I>name</I>
<P>
where <I>name</I>&nbsp;is the driver specified in the streamtab structure, as
follows:
<P>
&nbsp; &nbsp; streamtab.st_rdinit-&gt;qi_minfo-&gt;mi_idname
<P>
Every STREAMS driver for Windows NT must be clonable. The stream head creates
a new file object every time a STREAMS driver is opened, and always calls the
open procedure of the driver with the CLONEOPEN flag.
<P>
The return value from the open procedure of the driver (<B>egopen</B>) must
either be 0 or OPENFAIL. If the return value is 0, <B>egopen</B>&nbsp;must have
assigned a minor device number to the stream, and returned it via the <I>devp</I>
parameter.
<H5>Xxxclose</H5>
<P>
The <I>Xxx</I><B>close</B>&nbsp;procedure is called by STREAMS to close a STREAMS
driver or module. See Further Readings on Streams, Reference 1 for details.
<PRE><FONT FACE="Courier" SIZE="2">INT
<I>Xxx</I>close(
&nbsp; &nbsp; IN STRUCT queue <I>*rq</I>,
&nbsp; &nbsp; IN INT <I>flag</I>,
&nbsp; &nbsp; IN VOID <I>*credp</I>
&nbsp; &nbsp; );
&nbsp;</FONT></PRE>
<H5>Parameters</H5>
<DL>
<DT>
<I>rq</I>
<DD>
Points to the read queue.
<BR>
<DT>
<I>flag</I>
<DD>
Indicates the Open() flag.
<BR>
<DT>
<I>credp</I>
<DD>
Unused.
</DL>
<H5>Xxxput</H5>
<P>
The <I>Xxx</I><B>put</B>&nbsp;procedure is an example of a queue routine that
receives messages from preceding queues in the stream. See Further Readings on
Streams, Reference 1 for details.
<PRE><FONT FACE="Courier" SIZE="2">INT
<I>Xxx</I>put(
&nbsp; &nbsp; IN STRUCT queue <I>*q</I>,
&nbsp; &nbsp; IN STRUCT msgb <I>*mp</I>
&nbsp; &nbsp; );
&nbsp;</FONT></PRE>
<H5>Parameters</H5>
<DL>
<DT>
<I>q</I>
<DD>
Points to the queue to be used.
<BR>
<DT>
<I>mp</I>
<DD>
Points to the message to be processed.
</DL>
<H5>Xxxsrv</H5>
<P>
The procedure <I>Xxx</I><B>srv</B>&nbsp;is an example of a service procedure for a
STREAMS driver/module.
<PRE><FONT FACE="Courier" SIZE="2">INT
<I>Xxx</I>srv(
&nbsp; &nbsp; IN STRUCT queue <I>*q</I>
&nbsp; &nbsp; );</FONT></PRE>
<H5>Parameters</H5>
<DL>
<DT>
<I>q</I>
<DD>
Points to the queue to be used.
</DL>
<P></FONT>
</BODY>
</HTML>
