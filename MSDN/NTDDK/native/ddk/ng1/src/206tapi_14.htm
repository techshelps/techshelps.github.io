<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>6.14  The NDISTAPI Interface</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_The_NDISTAPI_Interface_NG"></A>6.14  The NDISTAPI Interface</H2>
<P>
The following is a summary of the OID requests that define the interface
between the NDISTAPI driver, NDISWAN and underlying WAN NIC miniport drivers.
Each of these operations has a corresponding SPI function defined in the
Telephony Software Development Kit, documented in the Win32 SDK. 
<P>
WAN miniport developers should consult the SPI specifications when designing
and implementing drivers. Note that function definitions and parameters might
differ slightly between the NDISTAPI specification and the SPI specification,
in which case the developer should adhere to the NDISTAPI driver Interface
specification.
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>OID</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Optional or Required</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_ACCEPT
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Optional
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_ANSWER
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_CLOSE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_CLOSE_CALL
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_CONDITIONAL_MEDIA_DETECTION
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_CONFIG_DIALOG
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Optional
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_DEV_SPECIFIC
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Optional
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_DIAL
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Optional
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_DROP
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_GET_ADDRESS_CAPS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_GET_ADDRESS_ID
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_GET_ADDRESS_STATUS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_GET_CALL_ADDRESS_ID 
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_GET_CALL_INFO
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_GET_CALL_STATUS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_GET_DEV_CAPS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_GET_DEV_CONFIG
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Optional
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_GET_EXTENSION_ID
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Optional
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_GET_ID
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_GET_LINE_DEV_STATUS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_MAKE_CALL
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_NEGOTIATE_EXT_VERSION
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Optional
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_OPEN
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_PROVIDER_INITIALIZE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_PROVIDER_SHUTDOWN
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_SECURE_CALL 
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Optional
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_SELECT_EXT_VERSION
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Optional
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_SEND_USER_USER_INFO 
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Optional
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_SET_APP_SPECIFIC
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_SET_CALL_PARAMS
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_SET_DEFAULT_MEDIA_DETECTION
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_SET_DEV_CONFIG
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Optional
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_SET_MEDIA_MODE
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
OID_TAPI_SET_STATUS_MESSAGES 
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Required
</FONT></TABLE>
<P>
Definitions for these OIDs are found in <I>ntddndis.h</I>. Definitions for
NDIS_TAPI_EVENT messages are found in <I>ndistapi.h</I>.
<P>
The extent to which a given WAN NIC driver supports this interface depends in
large part on the discretion of the miniport developer and the capabilities of
the underlying hardware. The functional requirements are quite simple for
several of the requests; for example, the OID_TAPI_SET_APP_SPECIFIC request
only requires the driver to associate a ULONG value with a specified call
instance, which can be retrieved later through an OID_TAPI_GET_CALL_INFO
request. 
<P>
Requests that the NIC driver developer chooses not to support should be
completed with the NDIS_STATUS_TAPI_OPERATIONUNAVAIL status code. The NIC
driver can indicate what types of requests it supports (which can vary over
time depending on line, address, or call state) by setting or clearing
specific bits in the members of structures present in some of the
OID_TAPI_GET_<I>XXX</I>&nbsp;requests (for example, the <B>ulAddrCapFlags</B>
member in the LINE_ADDRESS_CAPS structure).
<P></FONT>
</BODY>
</HTML>
