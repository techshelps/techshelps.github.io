<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>8.4  OEM Interfaces for NIC Installation</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_OEM_Interfaces_for_NIC_Installation_NG"></A>8.4  OEM Interfaces for NIC Installation</H2>
<P>
This describes OEM interfaces for installing network interface cards.
<H4>Adding NICs to Existing Windows NT System</H4>
<P>
Windows NT supplies the basic driver and DLL used to communicate with the
hardware. In addition, DLLs that support a family of NICs used in Windows NT
platforms are supplied. The complete list of NIC-detection DLLs used by the
NCPA and the Windows NT setup program is extracted from the registry during
runtime. All DLL information is merged with information from the <I>.inf</I>
files located in the <I>system32</I>&nbsp;directory. The cumulative results of this
merge are then used for autodetection of NICs and to provide installation
selections to the user.
<P>
There are two cases in which an OEM will add new NICs to the Windows NT
system. In the first scenario, the OEM makes a NIC part of the primary system
by installing it and its driver directly on the Windows NT release media (such
as CD-ROM, diskette, tape, and so forth) or on a preinstalled network share
point. In the second scenario, the OEM provides support for adding NIC drivers
to a running installation or for adding NIC drivers supplied as add-on
diskettes during installation. 
<P>
The NIC detection capabilities described here are intended to be extended by
OEMs and ISVs. These capabilities include an API that supports one or more
NICs from one or more DLLs. 
<H4>Adding NICs during Primary Installation</H4>
<P>
OEMs can add information into the Windows NT registry before NIC detection
commences. To facilitate this operation, the primary network installation file
<I>ntlanman.inf</I>&nbsp;calls the <I>oemhook.inf</I>&nbsp;file. This call is made
through the Win32 <I>setup.exe</I>&nbsp;shell command. No errors are reported if  <I>oemhook.inf</I>
is not found.
<P>
The <I>oemhook.inf</I>&nbsp;file allows an OEM to provide automatic NIC detection
during the primary system installation of Windows NT. This file can perform
any operations the OEM deems necessary. 
<H4>Adding NICs during Secondary Installation</H4>
<P>
NICs can also be added after the system has been completely installed, or
during a later phase of installation (in custom mode). This type of secondary
installation uses the network control panel application (NCPA). In secondary
installation, the supporting DLLs are not used for automatic detection of
network adapters. Their primary purpose is to provide the installation <I>.inf</I>
file with the proper NIC parameter definitions and available value ranges.
<P></FONT>
</BODY>
</HTML>
