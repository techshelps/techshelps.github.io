<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>6.11  Unsolicited Event Handling</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_Unsolicited_Event_Handling_NG"></A>6.11  Unsolicited Event Handling</H2>
<P>
During the course of a telephonic session, the WAN miniport NIC driver will
most likely need to notify the NDISTAPI driver of unsolicited events. Typical
examples of unsolicited events are an incoming call on an open line, a state
transition on an existing call (for example, from ringing to connected), or a
change in line-device status (from in-service to out-of-service or vice
versa). 
<P>
The NDIS_STATUS_TAPI_INDICATION status is used when reporting spontaneously
occurring events on the line or on a call on the line to the NDISTAPI driver.
The miniport calls <B><A HREF="../../nr/src/103ndisx_108.htm">NdisMIndicateStatus</A></B>,
specifying a <I>GeneralStatus</I>&nbsp;of NDIS_STATUS_TAPI_INDICATION and a <I>StatusBuffer</I>
parameter which points to an initialized structure of type NDIS_TAPI_EVENT.
<P>
This structure contains the following members:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Structure Member</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Meaning</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>htLine</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Specifies the NDISTAPI driver’s handle for the line on which the event
occurred. 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>htCall</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
For line-related events where there is no call, this parameter should be zero;
otherwise, it is the NDISTAPI driver’s handle for the call related to the
reported event.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>ulMsg</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Specifies the event type, of the form LINE_<I>XXX</I>.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>ulParam1</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
An event-specific parameter, for instance, a pointer to a structure that
describes the specific event.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>ulParam2</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Same as above.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>ulParam3</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Same as above.
</FONT></TABLE>
<P>
The notification messages of concern to miniport developers are the following:
<UL>
<LI>
LINE_ADDRESSSTATE
<P>
<LI>
LINE_CALLINFO
<P>
<LI>
LINE_CALLSTATE
<P>
<LI>
LINE_CLOSE
<P>
<LI>
LINE_DEVSPECIFIC
<P>
<LI>
LINE_LINEDEVSTATE
<P>
<LI>
LINE_NEWCALL
<P>
<LI>
LINE_CALLDEVSPECIFIC
</UL>
<P></FONT>
</BODY>
</HTML>
