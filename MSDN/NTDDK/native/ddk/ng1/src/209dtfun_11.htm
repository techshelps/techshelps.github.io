<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>9.1.11  Resource Claiming Functions for msncdet.dll</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_Resource_Claiming_Functions_for_msncdet.dll_NG"></A>9.1.11  Resource Claiming Functions for msncdet.dll</H3>
<P>
The functions listed next are only available in the NIC-detection DLL, <I>msncdet.dll</I>.
These functions report the availability of and control the allocation of
bus-related and hardware platform-related resources, such as IRQs and I/O
space addresses.
<H4>Claiming a Resource</H4>
<P>
<B>NcDetectResourceClaim</B>&nbsp;allows the calling function to attempt to claim
system hardware resources that are in use by a NIC. This is necessary to
verify that NIC configuration parameters are actually available for use in the
current system configuration. For example, <I>msncdet.dll</I>&nbsp;keeps a record
of resources claimed by the process to which it is attached. When asked to
claim or report resources later, <I>msncdet.dll</I>&nbsp;considers newly claimed
resources and reports them accordingly. In other words, the information is
used to augment the data extracted from the registry hardware hive.
<P>
The function prototype is as follows:
<P>
<B>LONG NcDetectResourceClaim(</B><BR>
<B>INTERFACE_TYPE</B>&nbsp; &nbsp;<I>ifType</I><B>,<BR>
LONG</B>&nbsp; &nbsp;<I>lBusNumber</I><B>,<BR>
LONG</B>&nbsp; &nbsp;<I>lType</I><B>,<BR>
LONG</B>&nbsp; &nbsp;<I>lValue</I><B>,<BR>
LONG</B>&nbsp; &nbsp;<I>lRange</I><B>,<BR>
LONG</B>&nbsp; &nbsp;<I>lFlags</I><B>,<BR>
BOOL</B>&nbsp; &nbsp;<I>fClaim</I><B><BR>
);</B>
<H4>Parameters</H4>
<DL>
<DT>
<I>ifType</I>
<DD>
Indicates the type of bus (for example, ISA, EISA, MCA, PCI). 
<BR>
<DT>
<I>lBusNumber</I>
<DD>
Indicates the zero-based number of the bus being addressed. 
<BR>
<DT>
<I>lType</I>
<DD>
Indicates the system-level resource being claimed as one of the following: 
<DL>
<DT>
NETDTECT_IRQ_RESOURCE
<DD>
Claim an interrupt vector or level.
<BR>
<DT>
NETDTECT_MEMORY_RESOURCE
<DD>
Claim a memory-mapped range.
<BR>
<DT>
NETDTECT_PORT_RESOURCE
<DD>
Claim an I/O port range.
<BR>
<DT>
NETDTECT_DMA_RESOURCE
<DD>
Claim a channel in the system DMA controller.
</DL>
<DT>
<I>lValue</I>
<DD>
Specifies the value of the resource type being claimed. 
<BR>
<DT>
<I>lRange</I>
<DD>
Specifies the size of the area being claimed, in address units. This applies
only to certain parameters, such as memory windows. For example, only the <I>lValue</I>
parameter would be meaningful for an IRQ parameter, while the <I>lRange</I>
parameter would be ignored. Both values are required for an IOADDR (port)
parameter.
<BR>
<DT>
<I>lFlags</I>
<DD>
Specifies either of the following if <I>IType</I>&nbsp;is set to
NETDTECT_IRQ_RESOURCE:
<DL>
<DT>
CM_RESOURCE_INTERRUPT_LEVEL_SENSITIVE
<DD>
Interrupt occurs when signal is asserted.
<BR>
<DT>
CM_RESOURCE_INTERRUPT_LATCHED
<DD>
Interrupt is edge-triggered.
</DL>
<DT>
<I>fClaim</I>
<DD>
Allows the calling function to verify whether a resource can be claimed,
without actually claiming it. If the parameter is TRUE, the resource is
claimed. If the parameterer is FALSE, the resource is not claimed. The result
is the same in either case.
</DL>
<H4>Freeing a Resource</H4>
<P>
<B>NcDetectResourceFree</B>&nbsp;allows the calling function to release resources
previously claimed through the use of <B>NcDetectResourceClaim</B>. The
function prototype is as follows:
<P>
<B>LONG NcDetectResourceFree(</B><BR>
<B>INTERFACE_TYPE</B>&nbsp; &nbsp;<I>ifType</I><B>,<BR>
LONG</B>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <I>lBusNumber</I><B>,<BR>
LONG</B>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <I>lType</I><B>,<BR>
LONG</B>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <I>lValue</I><B>,<BR>
LONG</B>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<I>lRange</I><B>,<BR>
LONG</B>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<I>lFlags</I><B><BR>
);</B>
<P>
The name of a resource (parameter) and its values must exactly match a
previously claimed value, or ERROR_INVALID_PARAMETER is returned.
<P></FONT>
</BODY>
</HTML>
