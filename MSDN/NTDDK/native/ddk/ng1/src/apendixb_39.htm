<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>B.8.2  Loading Windows NT Drivers</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_B.8.2_Loading_Windows_NT_Drivers_NG"></A>B.8.2  Loading Windows NT Drivers</H3>
<P>
Windows NT drivers are loaded either:
<OL>
<LI>
At system boot 
<P>
<LI>
Dynamically by the Win32 Service Controller
</OL>
<P>
The second method is recommended. Either method requires setting up the
Registry.
<P>
The streams.sys driver must be loaded prior to any driver that calls a <B>StrmRegister*</B>
function. The path for this driver is:
<P>
&nbsp; &nbsp; %SystemRoot%\system\drivers\streams.sys
<P>
The dynamic link library that provides the user-level stream head API
functions is winstrm.dll, accessed by the following path:
<P>
&nbsp; &nbsp; %SystemRoot%\system\winstrm.dll
<P>
In the following example, the Tcpipsys section of the Registry is for the
driver containing the STREAMS stack. The Tcpip section is for the user-level
plumbing daemon.
<P>
<B>Example: Registry Parameters for TCP/IP Configuration</B>
<PRE><FONT FACE="Courier" SIZE="2">\Registry\Machine
&nbsp; &nbsp; System
&nbsp; &nbsp; &nbsp; &nbsp; CurrentControlSet
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Services
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Tcpipsys
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Type = KernelDriver
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Start = DemandLoad
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ErrorControl = ErrorNormal
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DependOnService = REG_MULTI_SZ &quot;Streams&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ImagePath = REG_EXPAND_SZ
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\SystemRoot\system32\drivers\tcpip.sys
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Tcpip
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Type = Win32ServiceShareProcess
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Start = DemandLoad
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ErrorControl = ErrorNormal
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ImagePath = REG_EXPAND_SZ 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; %SystemRoot%\system32\LmSvcs.exe
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DependOnService = REG_MULTI_SZ &quot;Tcpipsys&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ObjectName = REG_SZ LocalSystem
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Parameters
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DefaultGateway = 11.1.0.1
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DatabasePath = REG_EXPAND_SZ 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;%SystemRoot%\system\drivers\etc&quot;
&nbsp;</FONT></PRE>
<P></FONT>
</BODY>
</HTML>
