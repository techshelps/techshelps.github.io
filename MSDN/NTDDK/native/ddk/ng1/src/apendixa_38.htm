<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>A.3.2  Registering Network Interface Cards</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_A.3.2_Registering_Network_Interface_Cards_NG"></A>A.3.2  Registering Network Interface Cards</H2>
<P>
After driver registration, the NDIS interface library must register network
interface cards to each NIC driver on the network. As Figure A.3.2 shows, the
library calls <B><A HREF="../../nr/src/appdxa_4.htm">MacAddAdapter</A></B>&nbsp;for each
network interface card. The NIC driver reads the Configuration Registry
database to determine parameters for the network card, using calls to <B><A HREF="../../nr/src/103ndisx_149.htm">NdisOpenConfiguration</A></B>,
<B><A HREF="../../nr/src/103ndisx_175.htm">NdisReadConfiguration</A></B>, and <B><A HREF="../../nr/src/103ndisx_20.htm">NdisCloseConfiguration</A></B>.
For additional configuration information about specialized network interface
cards, EISA-based drivers can call <B><A HREF="../../nr/src/103ndisx_176.htm">NdisReadEisaSlotInformation</A></B>,
MCA-based drivers can call <B><A HREF="../../nr/src/103ndisx_178.htm">NdisReadMcaPosInformation</A></B>,
and PCI-based drivers can call <B><A HREF="../../nr/src/103ndisx_180.htm">NdisReadPciSlotInformation</A></B>.
<P>
When the NIC driver has the appropriate configuration data, it makes a call to
<B><A HREF="../../nr/src/appdxa_96.htm">NdisRegisterAdapter</A></B>&nbsp;for the
associated network interface card and its logical adapter. This allows the
NDIS interface library wrapper to recognize the network card name when a
transport driver opens the card later. For more information about this task,
see <A HREF="apendixa_39.htm">Section A.3.3</A>.
Upon entry to <B>NdisRegisterAdapter</B>, the wrapper calls <B>IoCreateDevice</B>
to create a device object representing the network interface card, with an
object name that matches the network card name. 
<P>
<IMG SRC="../art/215-02.gif" BORDER=0>
<P>
<B>Figure A.3.2  Registering a network interface card </B>
<P>
The device object includes a NIC driver-specific extension that contains a
pointer to the NIC driver descriptor block; a list entry that links the
network interface card into the NIC driver list of registered network
interface cards (anchored in the NIC driver descriptor block); a list head for
the list of open bindings to the network interface card; and the context
passed to <B><A HREF="../../nr/src/appdxa_96.htm">NdisRegisterAdapter</A></B>. The
function gives the NIC driver the address of the device object extension in an
NDIS NIC handle. 
<P>
After <B>NdisRegisterAdapter</B>&nbsp;returns, the NIC driver can further
initialize the network interface card in calls to other NDIS interface library
functions, such as <B><A HREF="../../nr/src/103ndisx_10.htm">NdisAllocateMemory</A></B>,
<B><A HREF="../../nr/src/appdxa_86.htm">NdisMapIoSpace</A></B>, and <B><A HREF="../../nr/src/appdxa_62.htm">NdisAllocateDmaChannel</A></B>.
When it has completely initialized the network interface card, the NIC driver
must initialize interrupts by calling <B><A HREF="../../nr/src/appdxa_83.htm">NdisInitializeInterrupt</A></B>.
<P>
When registration for one network interface card is complete, the NDIS
interface library completes the preceding procedure for the remainder of the
network interface cards on the network. Then each bound transport driver can
communicate with its remote node peers using the network interface card to
which it is bound, and the associated NIC driver. The first action the
transport driver must take is to open its network interface card. For more
information about opening a network interface card, see <A HREF="apendixa_39.htm">SectionA.3.3</A>.
<P></FONT>
</BODY>
</HTML>
