<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>6.1  Overview of NDISTAPI</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_Overview_of_NDISTAPI_NG"></A>6.1  Overview of NDISTAPI</H2>
<P>
The NDISTAPI defines how WAN miniport NIC drivers implement telephonic
services. It is closely related to the Service Provider Interface established
in Windows Telephony, with telephony-capable NDIS miniport NIC drivers
providing kernel-mode support for user-mode TAPI service providers. This
document presents an overview of how a TAPI-capable WAN miniport initializes,
brings up lines, sets up calls and closes calls using TAPI and WAN OIDs. This
description touches briefly on the concepts embodied in Windows Telephony, but
the reader should to consult the documentation published with the Telephony
SDK for an in-depth discussion.
<P>
A TAPI-capable WAN miniport registers and initializes itself as a user of both
WAN and TAPI services. When registration and initialization are complete, a
user-level application can make telephonic requests to the user-mode KMDDSP
service provider module which converts SPI requests to corresponding OIDs. The
KMDDSP module passes the OIDs to the NDISTAPI driver, the kernel-mode
component of TAPI. NDISTAPI routes the OIDs to the correct NIC driver in order
to set up, monitor, and tear down lines, and calls. NDISTAPI passes the OIDs
in <B><A HREF="../../nr/src/103ndisx_188.htm">NdisRequest</A></B>&nbsp;calls to the NDISWAN
intermediate driver. NDISWAN passes these NDIS requests on, resulting in a
call to the MiniportQueryInformation function or the MiniportSetInformation
function of a TAPI-capable miniport. 
<P>
A TAPI-capable WAN miniport communicates changes in the states of lines and
calls, for instance a change from the proceeding state to the connected state,
the arrival of an incoming call, or a remote disconnection. State changes are
communicated to upper-layers by passing appropriate NDIS_STATUS_TAPI_<I>XXX</I>
and NDIS_STATUS_WAN_<I>XXX</I>&nbsp;status messages to <B><A HREF="../../nr/src/103ndisx_108.htm">NdisMIndicateStatus</A></B>.
<P>
The relationship among these components is shown in the following diagram. The
kernel-mode flow of communication is from NDISTAPI to NDISWAN, through NDIS to
a TAPI-capable WAN miniport.
<P>
<IMG SRC="../art/ng2_05.gif" BORDER=0>
<P></FONT>
</BODY>
</HTML>
