<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>6.6  TAPI Registration</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="DDK_TAPI_Registration_NG"></A>6.6  TAPI Registration</H2>
<P>
A WAN miniport sets itself to accept TAPI commands in two steps. When the
miniport registers with NDIS in its <B>DriverEntry</B>&nbsp;function by calling <B><A HREF="../../nr/src/103ndisx_125.htm">NdisMRegisterMiniport</A></B>,
it indicates that it requires WAN services by setting the flag
NDIS_USE_WAN_WRAPPER in the <B>Reserved</B>&nbsp;member of the
NDIS_WAN_MINIPORT_CHARACTERISTICS structure.
<P>
Following execution of the <B>DriverEntry</B>&nbsp;function and after
MiniportInitialize has been called to complete the initialization of one or
more adapters, the NDISWAN driver will make an <B>NdisRequest</B>&nbsp;call to the
WAN miniport’s MiniportQueryInformation function, with an OID_WAN_GET_INFO
request. A miniport that is TAPI-capable should set the TAPI_PROVIDER bit of
the <B>FramingBits</B>&nbsp;member of the NDIS_WAN_INFO structure passed in this
call. 
<P>
The TAPI-capable WAN miniport sets the <B>MaxTransmit</B>&nbsp;member of the
NDIS_WAN_INFO structure to the default maximum number of outstanding send
packets the miniport will accept. NDIS will hold send packets after this
maximum is reached. However, a TAPI-capable miniport can dynamically provide a
new send window that is different from this initialization-time default value.
When the miniport indicates a line up status to <B>NdisMIndicateStatus</B>, it
can provide a new nonzero value for that line by setting the <B>SendWindow</B>
passed in the NDIS_MAC_LINE_UP structure. If the miniport passes a <B>SendWindow</B>
of zero, NDISWAN uses the default value, <B>MaxTransmit</B>, that was set at
initialization time for that line.
<P>
As the WAN driver’s MiniportInitialize is called to initialize each adapter it
manages, NDISWAN calls NDISTAPI to register each TAPI-capable adapter. This
creates an association that NDISTAPI can use to send telephonic requests
through NDISWAN to the miniport for specific adapters that have been
registered.
<P></FONT>
</BODY>
</HTML>
