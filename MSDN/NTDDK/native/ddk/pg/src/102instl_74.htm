<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupDiGetActualSectionToInstall</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_SetupDiGetActualSectionToInstall_PG"></A>SetupDiGetActualSectionToInstall</H4>
<P>
<B>HKEY</B><BR>
&nbsp; &nbsp; <B>SetupDiGetActualSectionToInstall(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN HINF</B>&nbsp; <I>InfHandle</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PCTSTR</B>&nbsp; <I>InfSectionName</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PTSTR</B>&nbsp; <I>InfSectionWithExt</I><B>,</B>&nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN DWORD</B>&nbsp; <I>InfSectionWithExtSize</I><B>,<BR>
&nbsp; &nbsp; &nbsp; &nbsp; OUT PDWORD</B>&nbsp; <I>RequiredSize</I><B>,</B>&nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PTSTR</B>&nbsp; <I>*Extension</I>&nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>SetupDiGetActualSectionToInstall</B>&nbsp;finds the appropriate <B><A HREF="102instl_21.htm">Install</A></B>
section to use when installing a device from a Windows NT 4.0-style device INF
file. 
<H5>Parameters</H5>
<DL>
<DT>
<I>InfHandle</I>
<DD>
Supplies the handle of the INF file that contains the <B>Install</B>&nbsp;section.
<BR>
<DT>
<I>InfSectionName</I>
<DD>
Supplies a pointer to the name of the <B>Install</B>&nbsp;section as specified by
the driver node being installed.
<BR>
<DT>
<I>InfSectionWithExt</I>
<DD>
Supplies a pointer to a character buffer to receive the name of the <B>Install</B>
section that should be used for installation. If this parameter is NULL, <I>InfSectionWithExtSize</I>
must be 0. The caller can use the NULL value to determine the required buffer
size, because the function returns TRUE and <I>RequiredSize</I>&nbsp;is set to the
size, in characters, necessary to store the <B>Install</B>&nbsp;section name.
<BR>
<DT>
<I>InfSectionWithExtSize</I>
<DD>
Supplies the size, in characters, of the <I>InfSectionWithExt</I>&nbsp;buffer.
<BR>
<DT>
<I>RequiredSize</I>
<DD>
Supplies a pointer to a variable that receives the size, in characters,
required to store the actual <B>Install</B>&nbsp;section name, including the
terminating NULL.
<BR>
<DT>
<I>Extension</I>
<DD>
Supplies a pointer to a variable that receives a pointer to the extension,
including &quot;.&quot;. This parameter is NULL if an extension is not
required. <I>Extension </I>points to the extension within the caller-supplied
buffer. If the <I>InfSectionWithExt</I>&nbsp;buffer is not supplied, this variable
is not filled in.
</DL>
<H5>Return Value</H5>
<P>
If the function is successful, it returns TRUE. If the function fails, it
returns INVALID_HANDLE_VALUE. To get extended error information, call <B>GetLastError</B>.
<H5>Comments</H5>
<P>
This function supports an OS/architecture-specific extension that can be used
to specify multiple installation behaviors for a single device, dependent on
the operating environment. An extension is appended to the INF file <B>Install</B>
section name to identify that it contains OS/architecture-specific
installation instructions. <B>SetupDiGetActualSectionToInstall</B>&nbsp;searches
for the different <B>Install</B>&nbsp;section names in the manner described below.
<P>
Starting with the <B>Install</B>&nbsp;section name as specified in the driver node
(for example, <B>InstallSec</B>) the function attempts to find one of the
following section names (the search is carried out in the order listed):
<H5>In Windows NT 4.0:</H5>
<OL>
<LI>
<B>InstallSec.NT</B><I>platform</I>&nbsp;<BR>
where <I>platform</I>&nbsp;is x86, MIPS, Alpha, or PPC.
<P>
<LI>
<B>InstallSec.NT</B>
<P>
<LI>
<B>InstallSec</B>
</OL>
<H5>In Windows 95:</H5>
<OL>
<LI>
<B>InstallSec.Win</B>
<P>
<LI>
<B>InstallSec</B>
</OL>
<P>
The first <B>Install</B>&nbsp;section located is used for the installation. This
section name is also used as the base for <B>Hardware</B>&nbsp;and <B>Services</B>
section names. For example, if the <B>Install</B>&nbsp;section name found is <B>InstallSec.NTAlpha</B>,
the <B>Services</B>&nbsp;section name must be named <B>InstallSec.NTAlpha.Services</B>.
<P>
The original <B>Install</B>&nbsp;section name specified in the driver node is
written to the driver&#39;s registry key&#39;s <B>InfSection</B>&nbsp;value entry.
The extension that was found is stored in the key as the REG_SZ value <B>InfSectionExt</B>.
For example:
<PRE><FONT FACE="Courier" SIZE="2">InfSection       : REG_SZ :    &quot;InstallSec&quot;
InfSectionExt    : REG_SZ :    &quot;.NTMIPS&quot;
&nbsp;</FONT></PRE>
<P>
If a driver is not selected for the specified device information element, a
NULL driver is installed. Upon return, the Install Parameters flags in the
device’s SP_DEVINSTALL_PARAMS structure indicate whether the system should be
restarted or rebooted for the device to start.
<H5>See Also</H5>
<P>
<B><A HREF="102instl_94.htm">SetupDiInstallDevice</A></B>&nbsp;
<P></FONT>
</BODY>
</HTML>
