<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>A.3.6.5  Install Section Commands</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_Install_Section_Commands_PG"></A>A.3.6.5  Install Section Commands</H4>
<P>
These commands can only be called from an install section.
<H5>CreateDir Command</H5>
<P>
The <B>CreateDir</B>&nbsp;command creates the specified directory, if it does not
exist. If the path specifies more than one nonexistent directory, all are
created. The syntax of the command is:
<P>
<B>CreateDir</B>&nbsp;<I>Path</I>&nbsp;[<I>V</I>]
<DL>
<DT>
<I>FullPath</I>
<DD>
Specifies the full or partial path of the directory to create.
<BR>
<DT>
V
<DD>
If specified, the Setup program displays an error dialog and terminates if the
directory does not exist and cannot be created.
</DL>
<H5>RemoveDir Command</H5>
<P>
The<B>&nbsp;RemoveDir</B>&nbsp;command deletes the specified directory, if it exists and
is empty. The syntax of the command is:
<P>
<B>RemoveDir</B>&nbsp;<I>Path</I>&nbsp;[<I>V</I>]
<DL>
<DT>
<I>FullPath</I>
<DD>
Specifies the path of the directory to remove.
<BR>
<DT>
V
<DD>
If specified, the Setup program displays an error dialog and terminates if the
directory both exists and cannot be deleted.
</DL>
<H5>Commands to Copy Files</H5>
<P>
The INF script language provides a set of install section commands that work
in conjunction with the [Source Media Descriptions] section to copy files from
a distribution disk, a local hard disk, or a network path. The following are
the basic steps for using these commands:
<OL>
<LI>
Create one or more Files sections containing information about the files to be
copied.
<P>
<LI>
Use the <B>AddSectionFilesToCopyList</B>, <B>AddSectionKeyFileToCopyList</B>,
or <B>AddNthSectionFileToCopyList</B>&nbsp;commands to extract information from a
Files section and add it to the Setup program’s copy list. If necessary, use
the <B>ClearCopyList</B>&nbsp;command to remove all copy list entries without
copying the files.
<P>
<LI>
Use the <B>CopyFilesInCopyList</B>&nbsp;command. It copies the files specified in
the copy list, and then clears the information in the copy list.
</OL>
<P>
All three <B>Add..ToCopyList</B>&nbsp;commands specify the name of the Files
section, and the source and destination directories of the files to be copied.
The three commands provide different ways to extract files from the Files
section. <B>AddSectionFilesToCopyList</B>&nbsp;adds all files in the section, <B>AddSectionKeyFileToCopyList</B>
adds the file on the section line identified by a specified key, and <B>AddNthSectionFileToCopyList</B>
adds the file on the section line specified by number, where the lines are
numbered beginning with 1. The syntax for the CopyList commands is:
<PRE><FONT FACE="Courier" SIZE="2"><B>AddSectionFilesToCopyList</B>&nbsp;SectionName SrcDir DestDir
&nbsp;
<B>AddSectionKeyFileToCopyList</B>&nbsp;SectionName LineKey SrcDir DestDir
&nbsp;
<B>AddNthSectionFileToCopyList</B>&nbsp;SectionName LineIndex SrcDir DestDir
&nbsp;
<B>CopyFilesInCopyList</B>
&nbsp;
<B>ClearCopyList</B>
&nbsp;</FONT></PRE>
<P>
A Files section line has one of two formats. The first format specifies
another Files section from which to extract files.
<P>
[<I>Key</I>&nbsp;=] @(<I>SectionName</I>) [, @(<I>LineKey</I>)]
<DL>
<DT>
<I>Key</I>
<DD>
An optional string that identifies the line.
<BR>
<DT>
<I>SectionName</I>
<DD>
Identifies the Files section.
<BR>
<DT>
<I>LineKey</I>
<DD>
Specifies a line in the Files section. If not specified, all files in the
Files section are included.
</DL>
<P>
The second format identifies a file and specifies how to copy it.
<P>
[<I>Key</I>&nbsp;=] <I>DiskID</I>, <I>FileName</I>, [<I>Option</I>&nbsp;...]
<DL>
<DT>
<I>Key</I>
<DD>
An optional string that identifies the line.
<BR>
<DT>
<I>DiskID</I>
<DD>
An integer ID that identifies the distribution disk on which the source file
is located. This ID must match a <I>LineKey</I>&nbsp;in the [Source Media
Description] section. If the file is not being copied from a removable disk,
the disk description and tagfile name on the [Source Media Description]
section line are ignored.
<BR>
<DT>
<I>FileName</I>
<DD>
Specifies the base file name and extension (must be 8.3 FAT format) of the
source file.
<BR>
<DT>
<I>Option</I>
<DD>
One or more of the options (in any order) described in the next table.
</DL>
<P>
The CopyList mechanism for copying files provides a number of options that
determine whether a file is copied, and, if so, how the file is copied. The
default behavior is as follows:
<UL>
<LI>
The source file is copied with the same name to the destination directory.
<P>
<LI>
If a file with the same name exists in the destination directory, it is
overwritten.
<P>
<LI>
Any attributes of the source file are copied to the destination file.
</UL>
<P>
You can override these defaults by specifying an option on a Files section
line or by setting a global variable (for example, <B>STF_OVERWRITE</B>&nbsp;or <B>STF_UPGRADEONLY</B>).
The global <B>STF_</B>&nbsp;variables specify a different default behavior, which
can still be overridden by specifying an option on a Files section line.
<P>
Following are the options that can be specified on a Files section line. Note
that all file names must use the 8.3 FAT format.
<DL>
<DT>
APPEND=<I>DestFile</I>
<DD>
Appends the contents of the source file to the destination file specified by <I>DestFile</I>.
Cannot be used with BACKUP or RENAME options.
<BR>
<DT>
BACKUP=<I>SaveFile</I>
<DD>
If the destination file exists, renames it with name specified by <I>SaveFile</I>.
If <I>SaveFile</I>&nbsp;= *, renames the destination file by appending the .bak
extension. If a file with the backup name exists, the destination file is not
backed up. Cannot be used with APPEND option.
<BR>
<DT>
!COPY
<DD>
The file specified on this section line is not copied.
<BR>
<DT>
DATE=<I>YYYY</I>-<I>MM</I>-<I>DD</I>
<DD>
Used with the OVERWRITE=OLDER option in an update situation to ensure that the
destination file is overwritten only if its last write date is earlier than
that specified by DATE. <I>YYYY</I>&nbsp;is &gt;= 1980 and &lt;= 2099, <I>MM</I>&nbsp;is
in [01..12], and <I>DD</I>&nbsp;is in [01..31].
<BR>
<DT>
DECOMPRESS
<DD>
Decompresses the source file before copying it. If STF_DECOMPRESS is defined
to make decompression the default, you can use !DECOMPRESS to override it for
a specific file.
<BR>
<DT>
DESTINATION=<I>Path</I>
<DD>
Overrides the destination path specified in the Add..ToCopyList command line,
or path specified by <B>STF_DEST</B>. Path must be full path with drive, for
example, c:\windows\system32.
<BR>
<DT>
OVERWRITE=<I>Option</I>
<DD>
Specifies when an existing destination file is overwritten. <I>Option</I>&nbsp;is
one of the following:
<DL>
<DT>
ALWAYS
<DD>
Always overwrites.
<BR>
<DT>
NEVER
<DD>
Never overwrites. Same as !OVERWRITE.
<BR>
<DT>
OLDER
<DD>
Overwrites if version of destination file is lower than version specified in
VERSION option. If VERSION option not used, overwrites if date of destination
file is older than date specified in DATE option.
<BR>
<DT>
VERIFYSOURCEOLDER
<DD>
Compares last write times of source and destination files, and overwrites if
destination is older.
<BR>
<DT>
UNPROTECTED
<DD>
Overwrites unless destination file is read-only.
</DL>
<DT>
READONLY
<DD>
Sets the read-only attribute of the destination file. If <B>STF_READONLY</B>
is defined to make read-only the default, you can use !READONLY to override it
for a specific file.
<BR>
<DT>
RENAME=<I>NewName</I>
<DD>
Renames the destination file with the name specified by <I>NewName</I>. This
option is useful for specifying the new name of a driver’s <I>oemsetup.inf </I>file.
Cannot be used with APPEND options.
<BR>
<DT>
SETTIMESTAMP
<DD>
Sets the create, last access, and last write times of copied files to those of
the source file. Note that the FAT file system supports only last write times
which are always copied.
<BR>
<DT>
SIZE=<I>Size</I>
<DD>
Estimate of the file size, which Setup uses during copying to display a
progress bar graph. Alternative is to use TIME option. If neither SIZE nor
TIME is specified, progress is based on number of files copied.
<BR>
<DT>
TIME=<I>CopyingTime</I>
<DD>
Estimate of the time to copy the file, which Setup uses during copying to
display a progress bar graph.
<BR>
<DT>
UPGRADEONLY 
<DD>
Copies the file only if destination file exists. If <B>STF_UPGRADEONLY</B>&nbsp;is
defined to make this the default, you can use !UPGRADEONLY to override it for
a specific file.
<BR>
<DT>
VERSION=<I>A</I>,<I>B</I>,<I>C</I>,<I>D</I>
<DD>
Used with the OVERWRITE=OLDER option in an update situation to ensure that the
destination file is overwritten only if its version is lower than that
specified by VERSION. <I>A</I>&nbsp;is the high-order and <I>B</I>&nbsp;the low-order 16
bits of the most significant portion, and <I>C</I>&nbsp;and <I>D</I>&nbsp;are the high-
and low-order 16 bits of the least-significant portion of the file’s binary
version number.
<BR>
<DT>
VITAL
<DD>
If specified, Setup displays an error dialog and terminates if the file cannot
be copied.
</DL>
<H5>Default Copy Flags</H5>
<P>
Use the following variables to set the default copy flags. For example, the
following INF file line sets the OVERWRITE mode:
<P>
&nbsp; &nbsp; set STF_OVERWRITE = “VERYIFYSOURCEOLDER”
<P>
The variables for default copy flags include:
<DL>
<DT>
STF_COPY = ““
<DD>
Turns off copying. No files in the copy list are copied, except those that
explicitly specify the COPY option.
<BR>
<DT>
STF_DATE = <I>YYYY</I>-<I>MM</I>-<I>DD</I>
<DD>
Sets the default date to compare with if OVERWRITE=OLDER option is specified.
Override by DATE option. Default is “1980-01-01”.
<BR>
<DT>
STF_DECOMPRESS = 1
<DD>
Source files are decompressed before copying. Override by !DECOMPRESS.
<BR>
<DT>
STF_DEST = <I>DestDir</I>
<DD>
Overrides the destination path specified on <B>Add..ToCopyList</B>&nbsp;command
line. Must be full path including drive letter. Override by DESTINATION
option.
<BR>
<DT>
STF_OVERWRITE = <I>Option</I>
<DD>
Sets the default overwrite mode. One of the following is specified: ALWAYS,
NEVER, OLDER, VERIFYSOURCEOLDER, UNPROTECTED
<BR>
<DT>
STF_READONLY = 1
<DD>
Makes it the default to set the read-only attribute of destination files.
Override by !READONLY.
<BR>
<DT>
STF_UPGRADEONLY = 1
<DD>
Copies a source file only if the destination file exists. Override by
!UPGRADEONLY.
<BR>
<DT>
STF_VERSION = <I>A</I>,<I>B</I>,<I>C</I>,<I>D</I>
<DD>
Sets the default version to compare with if OVERWRITE=OLDER option is
specified. Override by VERSION option.
<BR>
<DT>
STF_VITAL = 1
<DD>
If a file cannot be copied, Setup displays an error dialog and terminates.
Override by !VITAL.
</DL>
<P>
&nbsp;
<P></FONT>
</BODY>
</HTML>
