<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupDiLoadClassIcon</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_SetupDiLoadClassIcon_PG"></A>SetupDiLoadClassIcon</H4>
<P>
<B>BOOLEAN</B><BR>
&nbsp; &nbsp; <B>SetupDiLoadClassIcon(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN LPGUID</B>&nbsp; <I>ClassGuid</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT HICON</B>&nbsp; *<I>LargeIcon</I><B>,</B>&nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT LPINT</B>&nbsp; <I>MiniIconIndex</I>&nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>SetupDiLoadClassIcon</B>&nbsp;loads both the large and mini-icon for the
specified class.
<H5>Parameters</H5>
<DL>
<DT>
<I>ClassGuid</I>
<DD>
Supplies the GUID of the class for which the icon(s) should be loaded.
<BR>
<DT>
<I>LargeIcon</I>
<DD>
Supplies a pointer to a variable to receive a handle for the loaded large icon
for the specified class. If this parameter is not specified, the large icon is
not loaded.
<BR>
<DT>
<I>MiniIconIndex</I>
<DD>
Supplies a pointer to a variable to receive the index of the mini-icon for the
specified class. The mini-icon is stored in the device installer&#39;s
mini-icon cache.
</DL>
<H5>Return Value</H5>
<P>
The function returns TRUE if it is successful. Otherwise it returns FALSE and
the logged error can be retrieved by a call to <B>GetLastError</B>.
<H5>Comments</H5>
<P>
The icons of the class are either predefined and loaded from the device
installer’s internal cache, or they are loaded directly from the class
installer’s executable. This function querys the registry value <B>ICON</B>&nbsp;in
the specified class’ section. If the <B>ICON</B>&nbsp;value is specified, it
indicates which mini-icon to load. 
<P>
If the <B>ICON</B>&nbsp;value is negative, the absolute value represents a
predefined icon in the class’ registry. See <B><A HREF="102instl_71.htm">SetupDiDrawMiniIcon</A></B>
for a list of the predefined mini-icons. 
<P>
If the <B>ICON</B>&nbsp;value is positive, it represents an icon in the class
installer’s executable that will be extracted. The value 1 is reserved. This
function also uses the <B>INSTALLER32</B>&nbsp;registry value and then the <B>ENUMPROPPAGES32</B>
registry value to determine which executable to extract the icon(s) from.
<H5>See Also</H5>
<P>
<B><A HREF="102instl_71.htm">SetupDiDrawMiniIcon</A></B>, <B><A HREF="102instl_75.htm">SetupDiGetClassBitmapIndex</A></B>
<P></FONT>
</BODY>
</HTML>
