<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>2.1.2.1  The Driver’s Services Database Key</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_The_Drivers_Services_Database_Key_PG"></A>2.1.2.1  The Driver’s Services Database Key</H4>
<P>
This is the required part of a driver’s installation in the registry. The
complete path of this required key for an installed driver is <B>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\</B><I>DriverName</I>.
Refer to the Win32 SDK online documentation to determine the appropriate
entries and values for your driver.
<P>
After the text mode phase of Windows NT Setup, the Service Controller should
be used to create a service of any kind, whether kernel driver or Win32
service. If you alter the registry and treat the result as a service, the
system must be restarted for the service to be recognized by the Service
Controller. Refer to the Win32 SDK online documentation for more details. The
information below is intended for those who must create services during text
mode operation.
<H5>Creating a Service</H5>
<P>
To create a service, the following value entries must be made in the registry:
<DL>
<DT>
Type
<DD>
Specifies the type of driver. One of the following is specified:
<P>
SERVICE_KERNEL_DRIVER (0x1)
<P>
SERVICE_FILE_SYSTEM_DRIVER (0x2)
<P>
SERVICE_ADAPTER (0x4)
<BR>
<DT>
Start
<DD>
Specifies when to start the driver. One of the following is specified:
<DL>
<DT>
SERVICE_BOOT_START (0x0)
<DD>
Indicates a driver started by the operating system loader, and should only be
used for drivers that are essential to loading the OS (for example, Atdisk).
<BR>
<DT>
SERVICE_SYSTEM_START (0x1)
<DD>
Indicates a driver started during OS initialization.
<BR>
<DT>
SERVICE_AUTO_START (0x2)
<DD>
Indicates a driver started by the Service Control Manager during system
startup.
<BR>
<DT>
SERVICE_DEMAND_START (0x3)
<DD>
Indicates a driver started on demand, by the Service Control Manager.
<BR>
<DT>
SERVICE_DISABLED (0x4)
<DD>
Indicates a driver that cannot be started.
</DL>
</DL>
<H5>Controlling the Load Order of Drivers</H5>
<P>
For a detailed discussion of controlling the load order of drivers, see
Chapter 1.
<P>
In addition to the required values under the driver’s <B>Services</B>&nbsp;key, the
following optional values can be specified to control the order in which the
driver is loaded:
<DL>
<DT>
Group
<DD>
Identifies the load order group of which this driver is a member. The <B>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\<BR>
Control\ServiceGroupOrder </B>key has a list of groups that determines the
order in which the system loads drivers. Examples of groups are: SCSI
miniport, port, Primary disk, and so forth.
<BR>
<DT>
Tag
<DD>
Determines the order in which this driver is started within its group. The <B>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\<BR>
Control\GroupOrderList</B>&nbsp;key has values that specify a tag order vector for
some groups. Tags are only evaluated for drivers that have start types of
SERVICE_BOOT_START or SERVICE_SYSTEM_START.
<BR>
<DT>
DependOnGroup
<DD>
Specifies a load order group on which the driver depends. The driver is
started only if at least one member of the specified group has been started.
<BR>
<DT>
DependOnService
<DD>
Specifies another driver or service that must be running before this driver is
started.
</DL>
<H5>Optional Keys and Values</H5>
<P>
You can create the following optional keys and values under a driver’s
Services key:
<DL>
<DT>
ImagePath
<DD>
A value entry that specifies the fully qualified path of the driver’s image
file. If this value is not specified, the default path is <I>NT_root</I>\<I>system32\Drivers\DriverName</I>.sys,
where <I>DriverName</I>&nbsp;is the name of the driver’s <B>Services</B>&nbsp;key.
<BR>
<DT>
Parameters
<DD>
A value entry used to store any device or driver-specific data that you want.
For some types of drivers, the system expects to find specific value entries. 
<BR>
<DT>
Performance
<DD>
A value entry used to specify needed information if a driver supports
performance monitoring. The values under this key specify the name of the
driver’s performance DLL and the names of certain exported functions in that
DLL. 
</DL>
<P></FONT>
</BODY>
</HTML>
