<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>A.3.5.2  DLLs in Detect Sections</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_DLLs_in_Detect_Sections_PG"></A>A.3.5.2  DLLs in Detect Sections</H4>
<P>
In a detect section, the line to call a DLL function has the following format:
<PRE><FONT FACE="Courier" SIZE="2">var = value ? LibHandle_or_Path FunctionName [Args]*
&nbsp;</FONT></PRE>
<P>
This is similar to other detect lines that use the <I>var</I>&nbsp;= <I>value</I>
format. If the detect section is called using the <B>read-syms</B>&nbsp;command, <I>value</I>
is assigned to <I>var</I>. But if the detect section is called using the <B>detect</B>
command, the DLL function is called to get a value assigned to <I>var</I>.
<DL>
<DT>
<I>LibHandle_or_Path</I>
<DD>
This can be a handle to a library module returned by a <B>LoadLibrary</B>
command executed in a shell or install section. Alternatively, it can be a
string containing the full or partial path of the DLL file.
<BR>
<DT>
<I>FunctionName</I>
<DD>
Name of the DLL function to call (case-sensitive).
<BR>
<DT>
<I>Args</I>
<DD>
Zero or more argument strings.
</DL>
<P>
The DLL function called from a detect section must conform to the prototype
shown below. The function’s return value indicates the actual number of bytes
returned by the function in the <I>lpszValue</I>&nbsp;buffer. If the return value
is greater than the size of the buffer, <I>cbValue</I>, the Setup program
reallocates the buffer to the specified size and recalls the function.
<P>
<B>UINT</B>&nbsp;<B>FunctionName</B>(<I>lpszArgs[]</I>, <I>cArgs</I>, <I>lpszValue</I>,
<I>cbValue</I>) <BR>
<B>LPSTR</B>&nbsp;<I>lpszArgs[]</I>; <BR>
<B>USHORT</B>&nbsp;<I>cArgs</I>; <BR>
<B>LPSTR</B>&nbsp;<I>lpszValue</I>; <BR>
<B>UINT</B>&nbsp;<I>cbValue</I>); 
<DL>
<DT>
<I>lpszArgs[]</I>
<DD>
An array of string arguments.
<BR>
<DT>
<I>cArgs</I>
<DD>
The number of arguments in the <I>lpszArgs</I>&nbsp;array.
<BR>
<DT>
<I>lpszValue</I>
<DD>
Points to a buffer allocated by the Setup program, to receive the value
assigned to the variable in the INF file.
<BR>
<DT>
<I>cbValue</I>
<DD>
Size, in bytes, of the buffer pointed to by <I>lpszValue</I>.
</DL>
<P></FONT>
</BODY>
</HTML>
