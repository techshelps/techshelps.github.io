<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>4.1.3  Using the Free and Checked Builds of Windows NT</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_Using_the_Free_and_Checked_Builds_of_Windows_NT_PG"></A>4.1.3  Using the Free and Checked Builds of Windows NT</H3>
<P>
The DDK provides two versions of the Windows NT operating system, called the <I>free
build </I>and the <I>checked build</I>. <I>Getting Started</I>&nbsp;explains how to
install each version.
<P>
The free build of Windows NT is the retail version that end users buy. Free
binaries are built with full optimization and contain a minimal set of
debugging symbols, such as function entry points and global variables.
<P>
The checked build is shipped only with the DDK; it is used in debugging
drivers and other system code. Checked binaries provide error checking,
argument verification, and system debugging code not present in the free
binaries.
<P>
Much of the additional code in the checked binaries is in the form of <B>ASSERT</B>
(see <A HREF="204debug_25.htm">Section 4.3.3.1</A>) macros that test an
expression. If the expression evaluates to FALSE, the macro generates a kernel
debugger error message and breaks into the debugger. This lets you immediately
determine the cause and location of the error. For example, recursive
acquisition of a spin lock (where a thread tries to acquire a spin lock that
it already owns) hangs the system in the free build of the operating system,
but generates a breakpoint on the checked build of the operating system.
<P>
Use the free and checked builds of Windows NT as follows:
<UL>
<LI>
Use the free build on the host machine, running <B>WinDbg</B>.
<P>
<LI>
Use the free build to develop and build a driver. Performance suffers in the
checked build due to the additional code that is executed.
<P>
<LI>
Use the checked build on the target machine to test and debug a driver during
the initial phases of its development.
<P>
<LI>
Use the free build on the target machine to test and debug your driver during
the final phases of its development. The final testing of your driver must be
done on a free version of the driver running the free build of Windows NT.
</UL>
<P>
The extra protection of the checked build of Windows NT carries some
penalties. Because of the additional error checking code and debugging
information, the checked binaries are larger and run slower than the free
binaries. This can conceal synchronization or other timing-related problems,
such as race conditions, that become apparent only in the free build.
<P>
If you run the checked build of Windows NT without having enabled kernel
debugging (refer to <A HREF="204debug_5.htm">Section
4.1.4</A>), unexpected system shutdowns can occur. This is because the additional
checks in the checked build increase the likelihood of encountering a
breakpoint. A kernel-mode breakpoint with kernel debugging disabled is an
unhandled kernel-mode exception, so the system calls the <B>KeBugCheckEx</B>
function and shuts down. 
<P>
However, if kernel debugging is enabled, a breakpoint freezes all threads in
the target system except for the component that communicates with <B>WinDbg</B>.
This lets <B>WinDbg</B>&nbsp;connect to a running target machine that has kernel
debugging enabled, even after a breakpoint has been encountered. See <A HREF="204debug_10.htm">Section
4.1.9</A>&nbsp;for details.
<P></FONT>
</BODY>
</HTML>
