<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupDiSetDeviceRegistryProperty</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_SetupDiSetDeviceRegistryProperty_PG"></A>SetupDiSetDeviceRegistryProperty</H4>
<P>
<B>BOOLEAN</B><BR>
&nbsp; &nbsp; <B>SetupDiSetDeviceRegistryProperty(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN HDEVINFO</B>&nbsp; <I>DeviceInfoSet</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN OUT PSP_DEVINFO_DATA</B>&nbsp; <I>DeviceInfoData</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN DWORD</B>&nbsp; <I>Property</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PBYTE</B>&nbsp; <I>PropertyBuffer</I><B>,</B><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN DWORD</B>&nbsp; <I>PropertyBufferSize</I><BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; );</B>
<P>
<B>SetupDiSetDeviceRegistryProperty</B>&nbsp;sets the specified Plug and Play
device registry property.
<H5>Parameters</H5>
<DL>
<DT>
<I>DeviceInfoSet</I>
<DD>
Supplies a handle to the device information set containing information about
the device instance whose Plug and Play registry property is to be modified.
<BR>
<DT>
<I>DeviceInfoData</I>
<DD>
Supplies a pointer to an SP_DEVINFO_DATA structure indicating the device
instance whose Plug and Play registry property is to be modified. If the
ClassGUID property is being set, this structure is updated upon return to
reflect the device&#39;s new class.
<BR>
<DT>
<I>Property</I>
<DD>
Supplies an ordinal specifying the property to be set. Can be one of the
following values:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Code</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Property</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_DEVICEDESC (0x00)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DeviceDesc 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_HARDWAREID (0x01)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
HardwareID 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_COMPATIBLEIDS (0x02)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CompatibleIDs 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_SERVICE (0x04)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Service 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_CLASSGUID (0x08)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
ClassGUID 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_DRIVER (0x09)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Driver 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_CONFIGFLAGS (0x0A)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
ConfigFlags 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_MFG (0x0B)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Mfg 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_FRIENDLYNAME (0x0C)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
FriendlyName 
</FONT></TABLE>
<DT>
<I>PropertyBuffer</I>
<DD>
Buffer that contains the new data for the property.
<BR>
<DT>
<I>PropertyBufferSize</I>
<DD>
Supplies the size, in bytes, of <I>PropertyBuffer</I>.
</DL>
<H5>Return Value</H5>
<P>
The function returns TRUE if it is successful. Otherwise it returns FALSE and
the logged error can be retrieved with a call to <B>GetLastError</B>.
<H5>Comments</H5>
<P>
The class name property cannot be set because it is based on the corresponding
class GUID and is automatically updated when that property is changed. When
the ClassGUID property changes, <B>SetupDiSetDeviceRegistryProperty</B>
automatically cleans up any software keys associated with the device.
<H5>See Also</H5>
<P>
<B><A HREF="102instl_84.htm">SetupDiGetDeviceRegistryProperty</A></B>
<P></FONT>
</BODY>
</HTML>
