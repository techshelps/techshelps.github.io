<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Update INI File Section</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_Update_INI_File_Section_PG"></A>Update INI File Section</H4>
<P>
The <B>Update INI File</B>&nbsp;section replaces, deletes, or adds complete entries
in the INI file. The section name, <I>update-ini-section-name</I>, must appear
in the <B>UpdateInis</B>&nbsp;item in the <B><A HREF="102instl_21.htm">Install</A>
</B>section of the INF file.
<PRE><FONT FACE="Courier" SIZE="2">[<I>update-ini-section-name</I>]
<I>ini-file</I>,<I>ini-section</I>,[<I>old-ini-entry</I>],[<I>new-ini-entry</I>],[<I>flags</I>]
.
.
.
&nbsp;</FONT></PRE>
<DL>
<DT>
<I>ini-file</I>
<DD>
The INI file containing the entry to change. 
<BR>
<DT>
<I>ini</I>-<I>section</I>
<DD>
Name of the section containing the entry to change.
<BR>
<DT>
<I>old</I>-<I>ini</I>-<I>entry</I>
<DD>
Optional. Usually in the form <I>key</I>=<I>value</I>.
<BR>
<DT>
<I>new</I>-<I>ini</I>-<I>entry</I>
<DD>
Optional. Usually in the form<I>&nbsp;key</I>=<I>value</I>. Either the key or value
may specify replaceable strings. For example, either the key or value
specified in the <I>new</I>-<I>ini</I>-<I>entry</I>&nbsp;parameter may be
%String1%, where the string that replaces %String1% is defined in the <B><A HREF="102instl_29.htm">Strings</A></B>
section of the INF file.
<BR>
<DT>
<I>flags</I>
<DD>
Optional action flags. The <I>flags</I>&nbsp;parameter can be one of these values:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Value</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Meaning</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
0
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Default. If <I>old</I>-<I>ini</I>-<I>entry</I>&nbsp;key is present in an INI file
entry, that entry is replaced with <I>new</I>-<I>ini</I>-<I>entry</I>. Only
the keys of the <I>old</I>-<I>ini</I>-<I>entry</I>&nbsp;parameter and the INF file
entry must match; the value of each entry is ignored.
<P>
To add <I>new</I>-<I>ini</I>-<I>entry</I>&nbsp;to the INI file unconditionally, set
<I>old</I>-<I>ini</I>-<I>entry</I>&nbsp;to NULL. To delete <I>old</I>-<I>ini</I>-<I>entry</I>
from the INI file unconditionally, set<I>&nbsp;new</I>-<I>ini</I>-<I>entry</I>&nbsp;to
NULL.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
1
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
If both key and value of <I>old</I>-<I>ini</I>-<I>entry </I>exist in an INI
file entry, that entry is replaced with <I>new</I>-<I>ini-entry</I>. The <I>old</I>-<I>ini</I>-<I>entry</I>
parameter and the INF file entry must match on both key and value for the
replacement to be made (this is in contrast to using an action flag value of
0, where only the keys must match for the replacement to be made).
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
2
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
If the key in the <I>old</I>-<I>ini</I>-<I>entry</I>&nbsp;parameter does not exist
in the INI file, then no operation is performed on the INI file.
<P>
If the key in the <I>old</I>-<I>ini-entry</I>&nbsp;parameter exists in an INI file
entry and the key in the <I>new</I>-<I>ini</I>-<I>entry</I>&nbsp;parameter exists
in an INI file entry, the INI file entry that matches the key in the <I>new</I>-<I>ini-entry</I>
parameter is deleted, and the key of the INI file entry that matches the <I>old</I>-<I>ini</I>-<I>entry</I>
parameter is replaced with the key in the <I>new</I>-<I>ini</I>-<I>entry</I>
parameter.
<P>
If the key in the <I>old</I>-<I>ini</I>-<I>entry</I>&nbsp;parameter exists in an
INI file entry and the key in the <I>new</I>-<I>ini</I>-<I>entry</I>&nbsp;parameter
does not exist in an INI file entry, an entry made up of the key in the <I>new</I>-<I>ini</I>-<I>entry</I>
parameter and the old value is added to the INI file.
<P>
The match of the <I>old</I>-<I>ini</I>-<I>entry</I>&nbsp;parameter and an INI file
entry is based on key alone, not key and value.
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
3
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Same as <I>flags</I>&nbsp;parameter value of 2 described above, except the match of
the <I>old</I>-<I>ini</I>-<I>entry </I>parameter and an entry in the INF file
is based on matching both key and value, not just the key.
</FONT></TABLE>
<P>
The wild card character (*) can be used in specifying the key and value and
they will be interpreted correctly.
</DL>
<P>
The <I>ini</I>-<I>file</I>&nbsp;name can be a string or a strings key. A strings
key has the form <I>%strkey%</I>&nbsp;where <I>strkey</I>&nbsp;is defined in the<B>
Strings</B>&nbsp;section in the INF file. The name must be a valid filename.
<P>
The <I>ini</I>-<I>file</I>&nbsp;name should include the name of the directory
containing the file, but the directory name should be given as a DIRID rather
than an actual name. The installer replaces a DIRID with an actual name during
installation.
<P>
A DIRID has the form <I>%dirid%</I>&nbsp;where <I>dirid</I>&nbsp;is one of the
predefined identifiers or a user-defined by a call to the <B>SetupSetDirectoryId</B>
function. When using a DIRID, you should use the backslash in a path. For
example, <I>%11%\card.ini</I>&nbsp;can be used to reference <I>card.ini</I>&nbsp;in the <I>system32</I>
directory.
<P>
The following examples illustrate individual items in an <B>Update INI File</B>
section:
<PRE><FONT FACE="Courier" SIZE="2">%11%\sample.ini, Section1,, Value1=2             ; adds new entry
%11%\sample.ini, Section2, Value3=*,             ; deletes old entry
%11%\sample.ini, Section4, Value5=1, Value5=4    ; replaces old entry
&nbsp;
&nbsp;</FONT></PRE>
<P></FONT>
</BODY>
</HTML>
