<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupDiOpenDevRegKey</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_SetupDiOpenDevRegKey_PG"></A>SetupDiOpenDevRegKey</H4>
<P>
<B>HKEY</B><BR>
&nbsp; &nbsp; <B>SetupDiOpenDevRegKey(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN HDEVINFO</B>&nbsp; <I>DeviceInfoSet</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PSP_DEVINFO_DATA</B>&nbsp; <I>DeviceInfoData</I><B>,<BR>
&nbsp; &nbsp; &nbsp; &nbsp; IN DWORD</B>&nbsp; <I>Scope</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN DWORD</B>&nbsp; <I>HwProfile</I><B>,<BR>
&nbsp; &nbsp; &nbsp; &nbsp; IN DWORD</B>&nbsp; <I>KeyType</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN REGSAM</B>&nbsp; <I>samDesired</I><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>SetupDiOpenDevRegKey</B>&nbsp;opens a registry storage key for device-specific
configuration information and returns a handle to the key.
<H5>Parameters</H5>
<DL>
<DT>
<I>DeviceInfoSet</I>
<DD>
Supplies a handle to the device information set containing information about
the device instance whose registry configuration storage key is to be opened.
<BR>
<DT>
<I>DeviceInfoData</I>
<DD>
Supplies a pointer to an SP_DEVINFO_DATA structure indicating the device
instance for which to open the registry key.
<BR>
<DT>
<I>Scope</I>
<DD>
Specifies the scope of the registry key to open. The scope determines where
the information is stored. The key opened can be global or hardware
profile-specific. Can be one of the following values:
<DL>
<DT>
DICS_FLAG_GLOBAL
<DD>
Open a key to store global configuration information. On Windows NT this opens
the key associated with the device instance that has the form:
<P>
<B>HKLM\SYSTEM\CurrentControlSet\Control\Class\</B><I>ClassGUID</I><B>\</B><I>InstanceID</I>.
<P>
where <I>classGUID</I>&nbsp;is the GUID representing the device’s class and <I>InstanceID</I>
is a base-10, four-digit ordinal representing this device instance within the
list of device instances for this class.
<P>
On Windows 95 the key has the following form:
<P>
<B>HKLM\SYSTEM\CurrentControlSet\Services\Class\</B><I>ClassName</I><B>\</B><I>InstanceID</I>.
<P>
where <I>ClassName</I>&nbsp;is the name representing the device’s class and <I>InstanceID</I>
is a base-10, four-digit ordinal representing this device instance within the
list of device instances for this class.
<BR>
<DT>
DICS_FLAG_CONFIGSPECIFIC
<DD>
Open a key to store hardware profile-specific configuration information. This
key has a path identical to the one opened by SPDICS_FLAG_GLOBAL, except that
it is rooted at one of the hardware-profile specific branches, instead of <B>HKEY_LOCAL_MACHINE</B>.
</DL>
<DT>
<I>HwProfile</I>
<DD>
Specifies the hardware profile to open a key for, if <I>Scope</I>&nbsp;is set to
SPDICS_FLAG_CONFIGSPECIFIC. If <I>HwProfile</I>&nbsp;is 0, the key for the current
hardware profile is opened. If <I>Scope</I>&nbsp;is SPDICS_FLAG_GLOBAL, this
parameter is ignored.
<BR>
<DT>
<I>KeyType</I>
<DD>
Specifies the type of registry storage key to open. Can be one of the
following values:
<DL>
<DT>
DIREG_DEV
<DD>
Open a hardware registry key for the device. This is the key for storage of
driver-independent configuration information. This key is in the <B>Device
Instance</B>&nbsp;key of the <B>Enum</B>&nbsp;branch.
<BR>
<DT>
DIREG_DRV
<DD>
Open a software, or driver, registry key for the device. This key is located
in the <B>Class</B>&nbsp;branch.
</DL>
<DT>
<I>samDesired</I>
<DD>
Specifies the access you require for this key.
</DL>
<H5>Return Value</H5>
<P>
If the function is successful, it returns a handle to an opened registry key
where private configuration data pertaining to this device instance can be
stored/retrieved.
<P>
If the function fails, it returns INVALID_HANDLE_VALUE. To get extended error
information, call <B>GetLastError</B>.
<H5>Comments</H5>
<P>
Close the handle returned from this function by calling <B>RegCloseKey</B>.
<P>
The specified device instance must be registered before calling this function.
After creating the device instance with <B>SetupDiCreateDeviceInfo</B>, call <B>SetupDiRegisterDeviceInfo</B>
to register it.
<H5>See Also</H5>
<P>
<B><A HREF="102instl_63.htm">SetupDiCreateDeviceInfo</A></B>, <B><A HREF="102instl_65.htm">SetupDiCreateDevRegKey</A></B>,
<B><A HREF="102instl_88.htm">SetupDiGetHwProfileList</A></B>, <B><A HREF="102instl_101.htm">SetupDiRegisterDeviceInfo</A></B>
<P></FONT>
</BODY>
</HTML>
