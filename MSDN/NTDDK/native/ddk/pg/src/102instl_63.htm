<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupDiCreateDeviceInfo</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_SetupDiCreateDeviceInfo_PG"></A>SetupDiCreateDeviceInfo</H4>
<P>
<B>BOOLEAN</B><BR>
&nbsp; &nbsp; <B>SetupDiCreateDeviceInfo(</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN HDEVINFO</B>&nbsp; <I>DeviceInfoSet</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PCTSTR</B>&nbsp; <I>DeviceName</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN LPGUID</B>&nbsp; <I>ClassGuid</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PCTSTR</B>&nbsp; <I>DeviceDescription</I><B>,</B>&nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN HWND</B>&nbsp; <I>hwndParent</I><B>,</B>&nbsp; &nbsp; /* optional */<BR>
<B>&nbsp; &nbsp; &nbsp; &nbsp; IN DWORD</B>&nbsp; <I>CreationFlags</I><B>,<BR>
</B>&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PSP_DEVINFO_DATA</B>&nbsp; <I>DeviceInfoData</I>&nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>SetupDiCreateDeviceInfo</B>&nbsp;creates a new device information element and
adds it as a new member to the specified device information set.
<H5>Parameters</H5>
<DL>
<DT>
<I>DeviceInfoSet</I>
<DD>
Supplies a handle to the device information set.
<BR>
<DT>
<I>DeviceName</I>
<DD>
Supplies either a full device instance ID (for example, <B>Root\*PNP0500\0000</B>)
or a root-enumerated device ID without the <B>Enum</B>&nbsp;branch prefix and
instance ID suffix (for example, <B>*PNP0500</B>). The root-enumerated device
ID can be used only if the DICD_GENERATE_ID flag is specified in the <I>CreationFlags</I>
parameter.
<BR>
<DT>
<I>ClassGuid</I>
<DD>
Supplies a pointer to the GUID for this device’s class. If the class is not
known, this value should be GUID_NULL.
<BR>
<DT>
<I>DeviceDescription</I>
<DD>
Supplies a textual description of the device.
<BR>
<DT>
<I>hwndParent</I>
<DD>
Supplies the window handle of the top-level window to use for any user
interface related to installing the device.
<BR>
<DT>
<I>CreationFlags</I>
<DD>
Controls how the device information element is created. Can be a combination
of the following values:
<DL>
<DT>
DICD_GENERATE_ID
<DD>
If this flag is specified, <I>DeviceName</I>&nbsp;contains only a Root-enumerated
device ID and the system creates a unique device instance key for it. This
unique device instance key is generated as:
<P>
<B>Enum\Root\</B><I>DeviceName</I><B>\</B><I>InstanceID<BR>
</I>where <I>InstanceID</I>&nbsp;is a four-digit, base-10 number that is unique
among all subkeys under <B>Enum\Root\</B><I>DeviceName</I>. Call <B>SetupDiGetDeviceInstanceId</B>
to find out what ID was generated for this device information element.
<BR>
<DT>
DICD_INHERIT_CLASSDRVS
<DD>
If this flag is specified, the resulting device information element inherits
the class driver list, if any, associated with the device information set. In
addition, if there is a selected driver for the device information set, that
same driver is selected for the new device information element.
</DL>
<DT>
<I>DeviceInfoData</I>
<DD>
Supplies a pointer to an SP_DEVINFO_DATA structure that will be initialized
for this new device information element.
</DL>
<H5>Return Value</H5>
<P>
The function returns TRUE if it is successful. Otherwise it returns FALSE and
the logged error can be retrieved with a call to <B>GetLastError</B>.
<H5>Comments</H5>
<P>
If this device instance is being added to a set that has an associated class,
the device class must be the same or the call fails. In this case, a call to <B>GetLastError</B>
returns ERROR_CLASS_MISMATCH.
<P>
If the specified device instance is the same as an existing device instance
key in the registry, the call fails. In this case, a call to <B>GetLastError</B>
returns ERROR_DEVINST_ALREADY_EXISTS. This occurs only if the DCID_GENERATE_ID
flag is not set.
<P>
If the new device information element was successfully created but the
caller-supplied <I>DeviceInfoData</I>&nbsp;buffer is invalid, the function returns
FALSE. In this case, a call to <B>GetLastError</B>&nbsp;returns
ERROR_INVALID_USER_BUFFER. However, the device information element will have
been added as a new member of the set already.
<H5>See Also</H5>
<P>
<B><A HREF="102instl_66.htm">SetupDiDeleteDeviceInfo</A></B>, <B><A HREF="102instl_72.htm">SetupDiEnumDeviceInfo</A></B>,
<B><A HREF="102instl_99.htm">SetupDiOpenDeviceInfo</A></B>
<P></FONT>
</BODY>
</HTML>
