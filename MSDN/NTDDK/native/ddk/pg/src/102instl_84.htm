<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupDiGetDeviceRegistryProperty</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_SetupDiGetDeviceRegistryProperty_PG"></A>SetupDiGetDeviceRegistryProperty</H4>
<P>
<B>BOOLEAN</B><BR>
&nbsp; &nbsp; <B>SetupDiGetDeviceRegistryProperty</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN HDEVINFO</B>&nbsp; <I>DeviceInfoSet</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN PSP_DEVINFO_DATA</B>&nbsp; <I>DeviceInfoData</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN DWORD</B>&nbsp; <I>Property</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PDWORD</B>&nbsp; <I>PropertyRegDataType</I><B>,</B>&nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PBYTE</B>&nbsp; <I>PropertyBuffer</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>IN DWORD</B>&nbsp; <I>PropertyBufferSize</I><B>,</B><BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>OUT PDWORD</B>&nbsp; <I>RequiredSize</I>&nbsp; &nbsp; /* optional */<BR>
&nbsp; &nbsp; &nbsp; &nbsp; <B>);</B>
<P>
<B>SetupDiGetDeviceRegistryProperty</B>&nbsp;retrieves the specified property from
the Plug and Play device storage location in the registry.
<H5>Parameters</H5>
<DL>
<DT>
<I>DeviceInfoSet</I>
<DD>
Supplies a handle to the device information set containing information about
the device instance for which to retrieve a Plug and Play registry property.
<BR>
<DT>
<I>DeviceInfoData</I>
<DD>
Supplies a pointer to an SP_DEVINFO_DATA structure indicating the device
instance for which to retrieve the Plug and Play property.
<BR>
<DT>
<I>Property</I>
<DD>
Supplies an ordinal specifying the property to be retrieved. Can be one of the
following values:
<TABLE>
<TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Code</B>
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
<B>Property</B>
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_DEVICEDESC (0x00)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
DeviceDesc 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_HARDWAREID (0x01)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
HardwareID 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_COMPATIBLEIDS (0x02)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
CompatibleIDs 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_NTDEVICEPATHS (0x03)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
NtDevicePaths 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_SERVICE (0x04)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Service 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_CONFIGURATION (0x05)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Configuration 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_CONFIGURATIONVECTOR (0x06)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
ConfigurationVector 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_CLASS (0x07)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Class 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_CLASSGUID (0x08)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
ClassGUID 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_DRIVER (0x09)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Driver 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_CONFIGFLAGS (0x0A)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
ConfigFlags 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_MFG (0x0B)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
Mfg 
</FONT><TR VALIGN=top>
<TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
SPDRP_FRIENDLYNAME (0x0C)
</FONT><TD><FONT FACE="ARIAL,HELVETICA" SIZE="2">
<P>
FriendlyName 
</FONT></TABLE>
<DT>
<I>PropertyRegDataType</I>
<DD>
Supplies a pointer to a variable to receive the data type of the property
being retrieved. This is one of the standard registry data types.
<BR>
<DT>
<I>PropertyBuffer</I>
<DD>
Supplies a pointer to a buffer to receive the property being retrieved.
<BR>
<DT>
<I>PropertyBufferSize</I>
<DD>
Supplies the length, in bytes, of <I>PropertyBuffer</I>.
<BR>
<DT>
<I>RequiredSize</I>
<DD>
Supplies a pointer to a variable to receive the number of bytes required to
store the requested property in <I>PropertyBuffer</I>.
</DL>
<H5>Return Value</H5>
<P>
The function returns TRUE if it is successful. Otherwise it returns FALSE and
the logged error can be retrieved with a call to <B>GetLastError</B>.
<H5>See Also</H5>
<P>
<B><A HREF="102instl_107.htm">SetupDiSetDeviceRegistryProperty</A></B>
<P></FONT>
</BODY>
</HTML>
