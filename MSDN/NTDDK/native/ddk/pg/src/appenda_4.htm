<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>A.2.1  Required oemsetup.inf Sections</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H3><A NAME="DDK_Required_oemsetup.inf_Sections_PG"></A>A.2.1  Required oemsetup.inf Sections</H3>
<P>
An <I>oemsetup.inf</I>&nbsp;file must include a set of required shell sections that
serve as entry points to be called by the Setup program. You can add
additional sections as needed. The DDK includes sample <I>oemsetup.inf</I>
files that illustrate the use of the required sections. You can use a sample
file as a template in creating your own version of the file. The following
sections are required in an <I>oemsetup.inf</I>&nbsp;file:
<H5>The Identify Section</H5>
<P>
The [Identify] section is the first section executed by Setup. It returns
information to Setup about the type of driver or drivers that can be installed
by this INF file. Setup will not proceed with the installation if the driver
type returned by the [Identify] section does not match the driver type
specified by the user. For example, if the user runs Setup, and chooses to add
a SCSI driver, installation fails if the file’s [Identify] section returns an
option type other than SCSI.
<P>
The [Identify] section also returns a string that specifies the name of the
floppy disk containing the driver’s files. Setup ignores this string.
<H5>The ReturnOptions Section</H5>
<P>
If the [Identify] section indicates that the INF file supports the appropriate
type of driver, Setup calls the [ReturnOptions] section. Setup passes a single
parameter to this section, indicating the language (English, Spanish, and so
on) to be used for dialog strings. This enables the INF file to support a
variety of languages. This section returns information to the Setup program,
listing the names of any drivers that can be installed by this INF file. It
also returns the text strings for each driver (in the requested language) to
be used in the dialog box that asks the user to select the driver to install.
<H5>The InstallOption Section</H5>
<P>
If the [ReturnOptions] section returns successfully, indicating the language
is supported, Setup displays a dialog box from which the user can select a
driver to install. If the user proceeds with the installation, Setup calls the
[InstallOption] section. Setup passes the following parameters to the
[InstallOption] section:
<PRE><FONT FACE="Courier" SIZE="2">Language to use
OptionID to install
SourceDirectory
AddCopy  (YES | NO)
DoCopy   (YES | NO)
DoConfig (YES | NO)
&nbsp;</FONT></PRE>
<H5>The Source Media Descriptions Section</H5>
<P>
The [Source Media Descriptions] section is a detect section required in all <I>oemsetup.inf</I>
files. It consists of a line for each floppy disk that is part of your
distribution set. The format for each line is as follows:
<P>
<I>LineKey</I>&nbsp;= [<I>DiskDescription</I>, TAGFILE = <I>TagFileName</I>] 
<DL>
<DT>
<I>LineKey</I>
<DD>
An integer [1 to 999] that identifies the line for later access. Lines must be
numbered consecutively beginning at 1.
<BR>
<DT>
<I>DiskDescription</I>
<DD>
Disk name string for prompting the user to insert the disk. This is ignored if
the source is not removeable media.
<BR>
<DT>
<I>TagFileName</I>
<DD>
Specifies the name of the file whose presence on the disk indicates to the
Setup program that the correct disk has been inserted. This is ignored if the
source is not removeable media. Note that TAGFILE, =, and <I>TagFileName</I>
must be separated by whitespace.
</DL>
<P>
For example:
<PRE><FONT FACE="Courier" SIZE="2">[Source Media Descriptions]
1  = &quot;Driver Disk #1&quot;  , TAGFILE = disk1
2  = &quot;Driver Disk #2&quot;  , TAGFILE = disk2
&nbsp;</FONT></PRE>
<P></FONT>
</BODY>
</HTML>
