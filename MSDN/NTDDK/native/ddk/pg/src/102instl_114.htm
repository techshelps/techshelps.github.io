<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SP_DEVINSTALL_PARAMS</TITLE>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>
<BODY BGPROPERTIES="FIXED" TEXT="#000000" BGCOLOR="#FFFFFF">

<FONT FACE="ARIAL,HELVETICA" SIZE="2">
<H4><A NAME="DDK_SP_DEVINSTALL_PARAMS_PG"></A>SP_DEVINSTALL_PARAMS</H4>
<PRE><FONT FACE="Courier" SIZE="2">typedef struct _SP_DEVINSTALL_PARAMS {
&nbsp; &nbsp; DWORD cbSize;
&nbsp; &nbsp; DWORD Flags;
&nbsp; &nbsp; DWORD FlagsEx;
&nbsp; &nbsp; HWND hwndParent;
&nbsp; &nbsp; PSP_FILE_CALLBACK InstallMsgHandler;
&nbsp; &nbsp; PVOID InstallMsgHandlerContext;
&nbsp; &nbsp; HSPFILEQ FileQueue;
&nbsp; &nbsp; DWORD ClassInstallReserved;
&nbsp; &nbsp; DWORD Reserved;
&nbsp; &nbsp; TCHAR DriverPath[MAX_PATH];
} SP_DEVINSTALL_PARAMS, *PSP_DEVINSTALL_PARAMS;
&nbsp;</FONT></PRE>
<P>
SP_DEVINSTALL_PARAMS defines device install parameters associated with a
particular device information element or globally with a device information
set.
<H5>Members</H5>
<DL>
<DT>
<B>cbSize</B>
<DD>
Contains the size, in bytes, of the SP_DEVINSTALL_PARAMS structure.
<BR>
<DT>
<B>Flags</B>
<DD>
Flags that control installation and user interface functions. Some flags can
be set prior to calling the device installation functions while others are set
automatically during the processing of some functions. <B>Flags</B>&nbsp;can be a
combination of the following values:
<DL>
<DT>
DI_SHOWOEM
<DD>
Set to allow support for OEM disks.
<BR>
<DT>
DI_NOVCP
<DD>
Set to disable creation of a new copy queue. Use the caller-supplied copy
queue.
<BR>
<DT>
DI_DIDCOMPAT
<DD>
Will be set if <B><A HREF="102instl_57.htm">SetupDiBuildDriverInfoList</A></B>
has already built a list of compatible drivers for this device. If this list
has already been built, it contains all the driver information and this flag
is always set.
<BR>
<DT>
DI_DIDCLASS
<DD>
Will be set if <B><A HREF="102instl_57.htm">SetupDiBuildDriverInfoList</A></B>
has already built a list of class drivers for this device. If this list has
already been built, it contains all the driver information and this flag is
always set.
<BR>
<DT>
DI_NEEDRESTART
<DD>
Will be set by <B><A HREF="102instl_94.htm">SetupDiInstallDevice</A></B>
if the device requires that the machine be rebooted after device installation
or a device state change.
<BR>
<DT>
DI_NEEDREBOOT
<DD>
For Windows NT, this is the same as DI_NEEDRESTART.
<BR>
<DT>
DI_NOBROWSE
<DD>
Set to disable browsing when the user is selecting an OEM disk path.
<BR>
<DT>
DI_MULTMFGS
<DD>
Will be set by <B><A HREF="102instl_57.htm">SetupDiBuildDriverInfoList</A></B>
if a class driver list contains drivers provided by multiple manufacturers.
<BR>
<DT>
DI_GENERALPAGE_ADDED
<DD>
Set by a property page provider if a general properties page has been added to
the device’s property sheet.
<BR>
<DT>
DI_RESOURCEPAGE_ADDED
<DD>
Set by a property page provider if a resource properties page has been added
to the device’s property sheet.
<BR>
<DT>
DI_PROPERTIES_CHANGE
<DD>
Set if a device’s properties have been changed and require an update of the
installer’s user interface.
<BR>
<DT>
DI_INF_IS_SORTED
<DD>
Set to indicate that the sorting order from the INF file should be used.
<BR>
<DT>
DI_ENUMSINGLEINF
<DD>
Set if <B><A HREF="102instl_57.htm">SetupDiBuildDriverInfoList</A></B>
should only search the specified INF file.
<BR>
<DT>
DI_DONOTCALLCONFIGMG
<DD>
Set if the Configuration Manager should not be called to modify the registry
hardware tree during the execution of certain device installation functions
(for example, <B><A HREF="102instl_94.htm">SetupDiInstallDevice</A></B>).
<BR>
<DT>
DI_INSTALLDISABLED
<DD>
Set if the device should be installed in a disabled state by default.
<BR>
<DT>
DI_COMPAT_FROM_CLASS
<DD>
Set to force <B><A HREF="102instl_57.htm">SetupDiBuildDriverInfoList</A></B>
to build a device&#39;s list of compatible drivers from its class driver list
instead of the INF file.
<BR>
<DT>
DI_CLASSINSTALLPARAMS
<DD>
Set to use the Class Install parameters.
<BR>
<DT>
DI_NODI_DEFAULTACTION
<DD>
Set if <B><A HREF="102instl_58.htm">SetupDiCallClassInstaller</A></B>
should not perform any default action if the class installer returns
ERR_DI_DO_DEFAULT or there is not a class installer.
<BR>
<DT>
DI_QUIETINSTALL
<DD>
Set if the device installer functions should be as silent as possible and use
default choices wherever possible.
<BR>
<DT>
DI_NOFILECOPY
<DD>
Set if <B><A HREF="102instl_94.htm">SetupDiInstallDevice</A></B>
should skip file copying.
<BR>
<DT>
DI_FORCECOPY
<DD>
Set if <B><A HREF="102instl_94.htm">SetupDiInstallDevice</A></B>
should always copy files, even if they are already present on the system.
<BR>
<DT>
DI_DRIVERPAGE_ADDED
<DD>
Set by a property page provider if a driver properties page has been added to
the device’s property sheet.
<BR>
<DT>
DI_USECI_SELECTSTRINGS
<DD>
Set if class installer-provided strings should be used during <B><A HREF="102instl_103.htm">SetupDiSelectDevice</A></B>.
<BR>
<DT>
DI_PROPS_NOCHANGEUSAGE
<DD>
Set if there should be no Enable/Disable capability on the device’s general
property page.
<BR>
<DT>
DI_NOSELECTICONS
<DD>
Set if small icons should not be used in select device dialogs.
<BR>
<DT>
DI_NOWRITE_IDS
<DD>
Set if <B><A HREF="102instl_94.htm">SetupDiInstallDevice</A></B>
should not write the device’s hardware and compatible IDs to the registry.
</DL>
<DT>
<B>FlagsEx</B>
<DD>
Flags that provide extended control over installation and user interface
functions. Some flags can be set prior to calling the device installer
functions while others are set automatically during the processing of some
functions. <B>Flags</B>&nbsp;can be a combination of the following values:
<DL>
<DT>
DI_FLAGSEX_AUTOSELECTRANK0
<DD>
Set if <B><A HREF="102instl_103.htm">SetupDiSelectDevice</A></B>&nbsp;should
automatically select all rank 0 drivers.
<BR>
<DT>
DI_FLAGSEX_CI_FAILED
<DD>
Is set internally if a class installer failed to load or start.
<BR>
<DT>
DI_FLAGSEX_DIDINFOLIST
<DD>
A class driver list has been built.
<BR>
<DT>
DI_FLAGSEX_DIDCOMPATINFO
<DD>
A compatible driver list has been built.
<BR>
<DT>
DI_FLAGSEX_FILTERCLASSES
<DD>
If set, <B><A HREF="102instl_56.htm">SetupDiBuildClassInfoList</A></B>
will check for class inclusion filters. This means that a device will not be
included in the class list if its class is marked as NoInstallClass.
<BR>
<DT>
DI_FLAGSEX_SETFAILEDINSTALL
<DD>
If set, the FAILEDINSTALL flag will be set when <B><A HREF="102instl_94.htm">SetupDiInstallDevice</A></B>
installs a NULL driver.
<BR>
<DT>
DI_FLAGSEX_DEVICECHANGE
<DD>
If set, any user interface that displays a list of devices will rebuild its
list of devices after the device property sheet is closed.
<BR>
<DT>
DI_FLAGSEX_ALWAYSWRITEIDS
<DD>
If set and the DI_NOWRITE_IDS flag is clear, always write hardware and
compatible IDs to the registry.
<BR>
<DT>
DI_FLAGSEX_ALLOWEXCLUDEDDRVS
<DD>
If set, <B><A HREF="102instl_103.htm">SetupDiSelectDevice</A></B>
displays drivers that have the Exclude From Select state.
<BR>
<DT>
DI_FLAGSEX_USECLASSFORCOMPAT
<DD>
Filter INF files on the device&#39;s class when building a list of compatible
drivers. If a device’s class is known, setting this flag can decrease the time
required to build a list of compatible drivers.
<BR>
<DT>
DI_FLAGSEX_OLDINF_IN_CLASSLIST
<DD>
Search legacy INF files when building a class driver list. This flag is valid
for Windows NT only.
<BR>
<DT>
DI_FLAGSEX_NO_DRVREG_MODIFY
<DD>
Do not process the <B>AddReg</B>&nbsp;and <B>DelReg</B>&nbsp;items for the device’s
software (driver) key.
</DL>
<DT>
<B>hwndParent</B>
<DD>
Window handle that will own the user interface dialogs related to this device.
<BR>
<DT>
<B>InstallMsgHandler</B>
<DD>
Callback used to handle events during file copying.
<BR>
<DT>
<B>InstallMsgHandlerContext</B>
<DD>
Private data used by the <B>InstallMsgHandler</B>&nbsp;callback.
<BR>
<DT>
<B>FileQueue</B>
<DD>
A handle to a caller-supplied file queue where file operations should be
queued but not committed.
<BR>
<DT>
<B>DriverPath</B>
<DD>
Specifies the path to this device’s INF file. This is a non-empty string only
if the driver was installed from an OEM INF file.
</DL>
<H5>See Also</H5>
<P>
<B><A HREF="102instl_56.htm">SetupDiBuildClassInfoList</A></B>, <B><A HREF="102instl_57.htm">SetupDiBuildDriverInfoList</A></B>,
<B><A HREF="102instl_58.htm">SetupDiCallClassInstaller</A></B>, <B><A HREF="102instl_82.htm">SetupDiGetDeviceInstallParams</A></B>,
<B><A HREF="102instl_94.htm">SetupDiInstallDevice</A></B>, <B><A HREF="102instl_103.htm">SetupDiSelectDevice</A></B>,
<B><A HREF="102instl_106.htm">SetupDiSetDeviceInstallParams</A></B>
<P></FONT>
</BODY>
</HTML>
