<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Processing System Broadcasts from a VxD</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Processing System Broadcasts from a VxD </H3><P>Virtual device drivers can send and receive system broadcast messages under Windows 95. The notification services are provided by the shell VxD. To receive system broadcast messages, VxDs must call the <B>SHELL_HookSystemBroadcast</B> function. </P>
<P>Between the sending of <B>Sys_Critial_Init</B> and when a VxD receives the WM_STARTSESSION notification, application time events are not processed. Also, during this time, broadcasts are sent only to VxDs (since other Windows system components are not loaded). This rule also applies to the time between a successful WM_ENDSESSION notification and <B>Sys_Critical_Exit</B>. During these phases of system operations, VxDs must send notifications only during times when other VxDs can safely respond to them. </P>
<P>During all other times, <B>SHELL_BroadcastSystemMessage</B> must only be called at application time. </P>
<H4><A NAME="sec0"></A>WM_STARTSESSION </H4><P><BR></P>
<PRE>WM_STARTSESSION
 reserved = wParam // undefined
 reserved = lParam // undefined
</PRE>
<P>Informs VxDs that the Windows user interface component is now active and that the <B>SHELL_CallAtAppyTime</B> services will now work. </P>
<H4><A NAME="sec1"></A>Special Notifications for VxDs </H4><P>VxDs receive WM_QUERYENDSESSION and WM_ENDSESSION messages when the Windows user interface component is shut down. These notifications have the same purpose as the WM_ENDSESSION message received by Windows applications. VxDs can refuse to allow Windows to shut down during the WM_QUERYENDSESSION broadcast. For more details on the <I>wParam</I> values for these broadcasts, refer to the Windows software development kit (SDK). </P>
<P>VxDs may also receive WM_STARTSESSION, a special notification that is not sent to Windows applications or drivers. </P>
</FONT></BODY></HTML>
