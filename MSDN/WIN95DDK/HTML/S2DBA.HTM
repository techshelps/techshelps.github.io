<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NPGetHomeDirectory</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>NPGetHomeDirectory </H3><P>This function is used to determine the home or personal directory associated with a user's account on a given network. Since the user's home directory is a typical place to store their User Profile (per-user registry settings), the directory should be one which the user (and network administrators) can write to, but which other users cannot write to. </P>
<P><BR></P>
<PRE>DWORD NPGetHomeDirectory(
  LPTSTR lpDirectory,
  LPDWORD lpBufferSize
  );
</PRE>
<P><I>lpDirectory</I> </P>
<P>Points to a buffer to receive the directory path. This will be either in UNC or drive-relative form, whichever is supported by the network. </P>
<P><I>lpBufferSize</I> </P>
<P>This is used to specify the size of the buffer passed in. If the call fails because the buffer is not big enough, this location is used to return the required buffer size. </P>
<UL><LI>     WN_SUCCESS if the call is successful. Otherwise, <B>GetLastError</B> should be called for extended error information. </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>WN_NOT_LOGGED_ON </P></TD><TD VALIGN="TOP"><P>The user is not logged on to this network. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NOT_SUPPORTED </P></TD><TD VALIGN="TOP"><P>The network does not support home directories, or the user does not have a home directory. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_MORE_DATA </P></TD><TD VALIGN="TOP"><P>The buffer is too small. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P></FONT></BODY></HTML>
