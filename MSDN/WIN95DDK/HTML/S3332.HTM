<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_RegQueryValueEx</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>_RegQueryValueEx </H3><P><BR></P>
<PRE>include vmm.h

LONG _RegQueryValueEx(HKEY hkey, LPTSTR lpszValueName, 
    LPDWORD lpdwReserved, LPDWORD lpdwType, LPBYTE lpbData, 
    LPDWORD lpcbData)
</PRE>
<P>Retrieves the type and data for a specified value name associated with an open registry key. See the documentation for the Win32 function of the same name for additional information. </P>
<UL><LI>     Returns ERROR_SUCCESS if the function succeeds. Otherwise, an error code is returned, possibly one of the following: </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>ERROR_KEY_DELETED </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>ERROR_MORE_DATA </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>ERROR_FILE_NOT_FOUND </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>ERROR_REGISTRY_IO_FAILED </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>ERROR_REGISTRY_CORRUPT </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>ERROR_BADDB </P></TD><TD VALIGN="TOP"><P></P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P><I>hkey</I> </P>
<P>Handle of an open key or one of the predefined keys: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>HKEY_CLASSES_ROOT </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>HKEY_CURRENT_USER </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>HKEY_LOCAL_MACHINE </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>HKEY_USERS </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>HKEY_CURRENT_CONFIG </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>HKEY_DYN_DATA </P></TD><TD VALIGN="TOP"><P></P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>lpszValueName</I> </P>
<P>Points to a null-terminated string containing the name of the value to be queried. </P>
<P><I>lpdwReserved</I> </P>
<P>Reserved; must be NULL. </P>
<P><I>lpdwType</I> </P>
<P>Address of variable that receives the type code for the value entry. This parameter can be NULL if the type is not required. The type can be any value or one of the standard values: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>REG_BINARY </P></TD><TD VALIGN="TOP"><P>Binary data in any form. </P></TD></TR><TR><TD VALIGN="TOP"><P>REG_SZ </P></TD><TD VALIGN="TOP"><P>A null-terminated UNICODE or ANSI string. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>lpbData</I> </P>
<P>Address of buffer that receives the data for the value entry. This parameter can be NULL if the data is not required. </P>
<P><I>lpcbData</I> </P>
<P>Address of variable that specifies size, in bytes, of the buffer addressed by lpbData. </P>
<P>Of the predefined key values, only HKEY_LOCAL_MACHINE and HKEY_DYN_DATA are available to VxDs during initialization time. The entire registry space can only be accessed after VxD initialization is complete. </P>
<P></P>
<P></P></FONT></BODY></HTML>
