<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FS_SearchFile</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>FS_SearchFile </H3><P><BR></P>
<PRE>FS_SearchFile(
 PIOREQ pir
 )
</PRE>
<P>All DOS find first and find next operations are performed through <B>FS_SearchFile</B>. This routine handles the INT 21h functions: 11h, 12h, 4Eh, and 4Fh. </P>
<P><I>ir_ppath</I> </P>
<P>Supplies a pointer to the canonicalized unicode pathname to search for. This is passed in only for a SEARCH_FIRST operation and is set to NULL on find next requests. Wildcards are allowed on the pathname. </P>
<P><I>ir_rh</I> </P>
<P>Supplies handle to disk volume or network resource where the pathname is to be searched for. </P>
<P><I>ir_flags</I> </P>
<P>Supplies the operation to perform. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Search Operation Values:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><B>SEARCH_FIRST</B> </P></TD><TD VALIGN="TOP"><P>Do a FindFirst operation on the path passed in. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>SEARCH_NEXT</B> </P></TD><TD VALIGN="TOP"><P>Do a FindNext operation on the path passed in on the SEARCH_FIRST operation. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>ir_attr</I> </P>
<P>Supplies wildcard search attributes. This is supplied only for SEARCH_FIRST requests. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Search Attribute Values:</B> </P>
<P>Any combination of the following attributes may be specified, causing those files to be included with normal files in the search. </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><B>FILE_ATTRIBUTE_HIDDEN</B> </P></TD><TD VALIGN="TOP"><P>Include hidden file in search. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>FILE_ATTRIBUTE_SYSTEM</B> </P></TD><TD VALIGN="TOP"><P>Include system file in search. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>FILE_ATTRIBUTE_DIRECTORY</B> </P></TD><TD VALIGN="TOP"><P>Include subdirectories in search. </P>
<P>The following attribute will only be specified by itself. It will not be combined with any of the other attributes. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>FILE_ATTRIBUTE_VOLUMELABEL</B> </P></TD><TD VALIGN="TOP"><P>Search for volume label only. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>ir_uFname</I> </P>
<P>Pointer to the case-preserved filename component in unicode. </P>
<P><I>ir_upath</I> </P>
<P>Pointer to the unparsed user pathname in unicode. </P>
<P><I>ir_data</I> </P>
<P>Supplies a pointer to the search info structure that is described below. </P>
<P><I>ir_user</I> </P>
<P>Supplies user id for this request. </P>
<P><I>ir_pid</I> </P>
<P>Supplies process id for this request. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>     <I>ir_error</I> </P></TD><TD VALIGN="TOP"><P>Returns status of the operation ( 0 if no error, errorcode otherwise ). </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_data</I> </P></TD><TD VALIGN="TOP"><P>Returns the information about the find in the search info structure. The contents of the supplied structure is the same as the info returned on a path based Int 21h search function. On a successful return the search info structure returns information required for a find next request that is filled in by the FSD. This information is stored in the users address space and is passed back on find next requests. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Search Info Structure:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P>se_key </P></TD><TD VALIGN="TOP"><P>Search key structure which contains information pertinent to the search operation that is in progress. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>Search Key Structure:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><I>sk_drive</I> </P></TD><TD VALIGN="TOP"><P>Drive value. This field is set by the IFS manager and will be overwritten. The FSD should not change this field. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>sk_pattern[11]</I> </P></TD><TD VALIGN="TOP"><P>Returns filename pattern being searched for. This field is set and used by the FSD to continue the search operation. The filename must be stored in the FCB 8.3 format. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>sk_attr</I> </P></TD><TD VALIGN="TOP"><P>Search attributes. This field is set and used by the FSD to continue searches. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>sk_localFSD[4]</I> </P></TD><TD VALIGN="TOP"><P>Returns local FSD continuation fields. These bytes should be used to save the information required to continue the search operation. The typical values saved are those used to locate the directory and the last entry with in the directory. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>sk_netFSD[2]</I> </P></TD><TD VALIGN="TOP"><P>Returns remote FSD continuation fields. These bytes should be used to save the information required to continue the search operation by network FSDs. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>sk_ifsmgr[2]</I> </P></TD><TD VALIGN="TOP"><P>Reserved for use by the IFS manager. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>se_attrib</I> </P></TD><TD VALIGN="TOP"><P>Returns attributes of matched file. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Return Attribute Values:</B> </P>
<P>Any combination of the following attributes may be returned. </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><B>FILE_ATTRIBUTE_READONLY</B> </P></TD><TD VALIGN="TOP"><P>Read-Only file. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>FILE_ATTRIBUTE_HIDDEN</B> </P></TD><TD VALIGN="TOP"><P>Hidden file. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>FILE_ATTRIBUTE_SYSTEM</B> </P></TD><TD VALIGN="TOP"><P>System file. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>FILE_ATTRIBUTE_DIRECTORY</B> </P></TD><TD VALIGN="TOP"><P>Subdirectory. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>FILE_ATTRIBUTE_ARCHIVE</B> </P></TD><TD VALIGN="TOP"><P>Archive file. </P>
<P>This attribute cannot be returned in combination with other attributes. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>FILE_ATTRIBUTE_VOLUMELABEL</B> </P></TD><TD VALIGN="TOP"><P>Volume label. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>se_time</I> </P></TD><TD VALIGN="TOP"><P>Returns DOS file time of matched file. This field is set by the FSD. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>se_date</I> </P></TD><TD VALIGN="TOP"><P>Returns DOS file date of matched file. This field is set by the FSD. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>se_size</I> </P></TD><TD VALIGN="TOP"><P>Returns size of matched file. This field is set by the FSD. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>se_name[13]</I> </P></TD><TD VALIGN="TOP"><P>Returns filename of matched file. This field is set by the FSD to the matching filename found by the search. The filename must be stored as an 8.3 format ASCIIZ string. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>ir_firstclus</I> </P></TD><TD VALIGN="TOP"><P>Returns first cluster of the file. This field is needed only for FCB-based search operations and is updated separately by the IFS. This field is valid only for FAT-based filesystems. A zero value should be returned by non-FAT-based FSDs. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P></P>
<P></P></FONT></BODY></HTML>
