<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GET_MESSAGE_PTR</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>GET_MESSAGE_PTR </H3><P><BR></P>
<PRE>GET_MESSAGE_PTR MsgIdentifier, Reg
</PRE>
<P>Returns the address of the given message. The macro carries out no other processing. </P>
<UL><LI>     Return the message address in the given register. </LI></UL><P></P>
<P><I>MsgIdentifier</I> </P>
<P>Message identifier of the message to retrieve. </P>
<P><I>Reg</I> </P>
<P>Name of register that recieves the message address. </P>
<P>A register name can also be given for the <I>MsgIdentifier</I> parameter. If a register name is given, the register value is checked at runtime to determine which table to look in for the message. Because this requires additional code to support, this register-based version of the macro should be avoided. </P>
<P>The overhead of the register-based version can be avoided by an alternate form of the <B>GET_MESSAGE_PTR</B> macro: </P>
<P><BR></P>
<PRE>Get_Message_Ptr MsgIdentifier, Reg1, Reg2
</PRE>
<P>This alternative form places into <I>Reg1</I> a pointer to the message string whose identifier is MsgIdentifier + <I>Reg2</I>. No range checking is performed; the value MsgIdentifier + <I>Reg2</I> must be of the same message type as MsgIdentifier. For example, if you have a series of three messages, declared contiguously: </P>
<P><BR></P>
<PRE>VxD_MESSAGE_SEG
DECLARE_MESSAGE MsgFirst, &lt;"First message"&gt;
DECLARE_MESSAGE MsgSecond, &lt;"Second Message"&gt;
DECLARE_MESSAGE MsgThird, &lt;"Third message"&gt;
VxD_MESSAGE_ENDS
</PRE>
<P>then the line: </P>
<P><BR></P>
<PRE>GET_MESSAGE_PTR MsgFirst, eax, esi
</PRE>
<P>would load into the EAX register a pointer to MsgFirst, if ESI = 0, a pointer to MsgSecond if ESI = 1, and a pointer to MsgThird if ESI = 2. Any other value for ESI is an error and will load garbage or possibly even page fault. </P>
<P></P>
<P></P></FONT></BODY></HTML>
