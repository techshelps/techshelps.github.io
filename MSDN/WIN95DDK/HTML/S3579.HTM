<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SHELL_Event</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>SHELL_Event </H3><P><BR></P>
<PRE>include shell.inc
mov ebx, Handle                  ; virtual machine handle
mov ecx, Event                   ; event number
mov ax, wParam                   ; word parameter for event
mov esi, OFFSET32 Callback       ; address of event callback proc
mov edx, OFFSET32 ReferenceData  ; reference data for the callback
VxDcall SHELL_Event

jc  error
mov [EventHandle], eax           ; event handle only if callback is used
</PRE>
<P>Posts an event in the Windows shell to WINOLDAPP. Uses EAX and Flags. </P>
<UL><LI>     Clears the carry flag if the event is placed in the queue. If a event callback procedure is given, the EAX register contains the handle of the event. The carry flag is set to indicate an error, such as the WINOLDAPP is not present or there is insufficient memory for placement. </LI></UL><P></P>
<P><I>Handle</I> </P>
<P>Virtual machine handle for the event. </P>
<P><I>Event</I> </P>
<P>Event number. </P>
<P><I>wParam</I> </P>
<P>16-bit parameter value for the event. The high 16 bits specify the special boost flags. </P>
<P><I>Callback</I> </P>
<P>Address of the callback procedure for the event. If this parameter is zero, no callback procedure is called. For more information about the callback procedure, see the comments section. </P>
<P><I>ReferenceData</I> </P>
<P>Address of reference data for the event callback procedure. </P>
<P>The system calls the callback procedure with the following input parameters: </P>
<P><BR></P>
<PRE>mov edx, ReferenceData    ; points to reference data
mov ebp, ClientReg        ; points to a WINOLDAPP Client_Reg_Struc frame
call [Callback]
</PRE>
<P>If the carry flag is clear on entry, the event was processed and the EBP register points to a <B>Client_Reg_Struc</B> structure containing the register values after the event returned. If the carry flag is set, the event could not be placed in the queue and only the EDX register contains valid data. In both cases, the EBX register does <I>not</I> contain a virtual machine handle. </P>
<P></P>
<P></P></FONT></BODY></HTML>
