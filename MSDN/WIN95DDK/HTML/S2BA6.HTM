<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MCI Structures</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>MCI Structures </H3><P>The members in the structures used for the <I>lParam2</I> parameter all have similar organizations. All the members in these structures are the size of <B>DWORD</B>s.Their first member is <B>dwCallback</B> and it is used for the window function associated with the MCI_NOTIFY flag. If the structure is used to return data from the device driver, the data-return members immediately follow the first member. If the structure is used to pass data to the device driver from the application, the data-transfer members immediately follow any return members. </P>
<P>There are four possible arrangements for return members: </P>
<UL><LI>     If a command message does not have return data, the structure does not have any return members. </LI><LI>     If a command message returns integer data, the second member of the structure is reserved for the data. </LI><LI>     If a command message returns string data, the second and third members of the structure are reserved. The second member is reserved for a pointer to the zero-terminated return string. The third member is reserved for the size of return buffer. The application is responsible for creating the buffer for the return string. </LI><LI>     If a command message returns <B>RECT</B> data, the data occupies the second and third members of the structure. The second member is reserved for the top-left values of the <B>RECT</B> data. The third member is reserved for the bottom-right values of the <B>RECT</B> data. </LI></UL><P></P>
<P>Any data passed to your device driver follows the return members. Your device driver should not read data from a member in these structures unless the member is validated with a flag. Without the flag, your device driver is not guaranteed of finding valid data in the structure. For example, the MCI_OPEN_ELEMENT flag validates the <B>lpstrElementName</B> member of the <B>MCI_OPEN_PARMS</B> structure. </P>
<P>If an application does not use any of the members of a structure, it can specify NULL for <I>lParam2</I>. </P>
<P>Commands that extend the structures will add new members to the end of the existing structures. The names used for extended structures add the device type to the name of the data type. For example, the extended <B>MCI_OPEN_PARMS</B> structure for animation devices uses <B>MCI_ANIM_OPEN_PARMS</B> as the name. </P></FONT></BODY></HTML>
