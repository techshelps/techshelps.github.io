<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NPLogoff</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>NPLogoff </H3><P>This function is used to log the user off from this network. The NP has the opportunity to confirm the logoff, if its effects could reach beyond those of active connections being disconnected and open files being closed (the MPR will warn about these before calling any NPs). </P>
<P>NPLogoff is also called with the same sequence when the user chooses to shut down or restart the computer. </P>
<P><BR></P>
<PRE>DWORD NPLogoff(
HWND hwndOwner,
LPLOGONINFO lpAuthentInfo
DWORD dwReason
  );
</PRE>
<P><I>hwndOwner</I> </P>
<P>A handle to a window which should be the owner for any dialog boxes or messages which the provider might display. </P>
<P><I>lpAuthentInfo</I> </P>
<P>A structure describing the currently logged-on user. </P>
<P><I>dwReason</I> </P>
<P>One of the following values: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>LOGOFF_PENDING </P></TD><TD VALIGN="TOP"><P>Logoff is beginning. The NP should display additional confirmations if necessary. If the user wishes to cancel the logon, the NP should return WN_CANCEL. The NP should <I>not</I> perform any logoff or cleanup operations until LOGOFF_COMMIT. </P></TD></TR><TR><TD VALIGN="TOP"><P>LOGOFF_COMMIT </P></TD><TD VALIGN="TOP"><P>Logoff is approved. The NP should take whatever actions necessary to log the user off. The NP may not refuse the logoff at this point. </P></TD></TR><TR><TD VALIGN="TOP"><P>LOGOFF_CANCEL </P></TD><TD VALIGN="TOP"><P>Passed only if this NP has been called with LOGOFF_PENDING for this logoff. An NP or application has canceled the logoff, so the logoff is not happening after all. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<UL><LI>     WN_SUCCESS if the call is successful. Otherwise, an error code is returned, which may include: </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>WN_CANCEL </P></TD><TD VALIGN="TOP"><P>The user wishes to cancel the logoff. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P></FONT></BODY></HTML>
