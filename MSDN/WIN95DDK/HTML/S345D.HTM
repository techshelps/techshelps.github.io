<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>tcb_s</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>tcb_s </H3><P><BR></P>
<PRE>include vmm.inc

tcb_s    struc
TCB_Flags            dd  ?  ; thread status flags; see below
TCB_Reserved1        dd  ?  ; reserved for use by VMM
TCB_Reserved2        dd  ?  ; reserved for use by VMM
TCB_Signature        dd  ?  ; SCHED_OBJ_THREAD_ID
TCB_ClientPtr        dd  ?  ; address of client registers
TCB_VMHandle         dd  ?  ; VM to which this thread belongs
TCB_ThreadId         dw  ?  ; thread ID 
TCB_PMLockOrigSS     dw  ?  ; client SS at Begin_Use_Locked_PM_Stack
TCB_PMLockOrigESP    dd  ?  ; client ESP at Begin_Use_Locked_PM_Stack
TCB_PMLockOrigEIP    dd  ?  ; client EIP at Begin_Use_Locked_PM_Stack
TCB_PMLockStackCount dd  ?  ; number of outstanding 
                            ;   Begin_Use_Locked_PM_Stack calls
TCB_PMLockOrigCS     dw  ?  ; client CS at Begin_Use_Locked_PM_Stack
TCB_PMPSPSelector    dw  ?  ; used by Vwin32
TCB_ThreadType       dd  ?  ; used by Vwin32
TCB_pad1             db  ?  ; padding
TCB_pad2             db  ?  ; padding
TCB_extErrLocus      db  ?  ; used by Vwin32
TCB_extErrAction     db  ?  ; used by Vwin32
TCB_extErrClass      db  ?  ; used by Vwin32
TCB_extErrPtr        dd  ?  ; used by Vwin32
tcb_s ends
</PRE>
<P>Thread control block. Contains information about, and the status of, a thread. The handle of a thread is also the address of its corresponding <B>tcb_s</B> structure. All fields in this structure are read-only. </P>
<P><B>TCB_Flags</B> </P>
<P>Value specifying the status of the thread. Can be zero or more of these values: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P>THFLAG_Suspended </P></TD><TD VALIGN="TOP"><P>Thread is not scheduled. </P></TD></TR><TR><TD VALIGN="TOP"><P>THFLAG_Not_Executeable </P></TD><TD VALIGN="TOP"><P>Thread has stopped executing. </P></TD></TR><TR><TD VALIGN="TOP"><P>THFLAG_Thread_Creation </P></TD><TD VALIGN="TOP"><P>Thread being created. </P></TD></TR><TR><TD VALIGN="TOP"><P>THFLAG_Thread_Blocked </P></TD><TD VALIGN="TOP"><P>Thread is blocked on a semaphore. </P></TD></TR><TR><TD VALIGN="TOP"><P>THFLAG_Ring0_Thread </P></TD><TD VALIGN="TOP"><P>Thread runs completely at ring 0. </P></TD></TR><TR><TD VALIGN="TOP"><P>THFLAG_ANSI THFLAG_OEM THFLAG_UNICODE THFLAG_RESERVED </P></TD><TD VALIGN="TOP"><P>Used by Vwin32 to indicate file system character set. </P></TD></TR><TR><TD VALIGN="TOP"><P>THFLAG_Extended_Handles </P></TD><TD VALIGN="TOP"><P>Thread uses extended handles. </P></TD></TR><TR><TD VALIGN="TOP"><P>THFLAG_Open_As_Immovable_File </P></TD><TD VALIGN="TOP"><P>Used by Vwin32 to prevent defragmenter from moving an open file. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>These bits are read-only. Virtual devices should not attempt to modify any of these bits. Some of the descriptions might not be directly meaningful; don't worry. Only Vwin32 really cares about them. </P>
<P><B>TCB_Reserved1, TCB_Reserved2</B> </P>
<P>Reserved by VMM for internal bookkeeping. </P>
<P><B>TCB_Signature</B> </P>
<P>The value SCHED_OBJ_THREAD_ID. </P>
<P><B>TCB_ClientPtr</B> </P>
<P>Pointer to thread client registers. </P>
<P><B>TCB_VMHandle</B> </P>
<P>Handle of VM to which this thread belongs. </P>
<P><B>TCB_ThreadId</B> </P>
<P>16-bit value that uniquely identifies the thread during its lifetime. Note that thread IDs are recycled. When a thread is destroyed, its ID becomes available for use. </P>
<P><B>TCB_PMLockOrigSS</B>, <B>TCB_PMLockOrigESP</B>, <B>TCB_PMLockStackCount</B>, and <B>TCB_PMLockOrigCS</B> </P>
<P>Used internally by the <B>Begin_Use_Locked_PM_Stack</B> service. </P>
<P><B>TCB_PMPSPSelector</B>, <B>TCB_ThreadType, TCB_extErrLocus</B>, <B> TCB_extErrAction</B>, <B>TCB_extErrClass</B>, and <B>TCB_extErrPtr</B> </P>
<P>Used internally by Vwin32. </P>
<P>See also <B>Close_VM</B>, <B>Client_Reg_Struc</B> </P>
<P></P>
<P></P></FONT></BODY></HTML>
