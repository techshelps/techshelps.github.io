<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NPGetResourceParent</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>NPGetResourceParent </H3><P><BR></P>
<PRE>DWORD NPGetResourceParent(
  LPNETRESOURCE lpNetResource,
  LPVOID lpBuffer,
  LPDWORD cbBuffer
  );
</PRE>
<P><I>lpNetResource</I> </P>
<P>This specifies the network resource for which the parent name is required. The <B>NETRESOURCE</B> could have been obtained via a previous <B>NPEnumResource</B>, or constructed by the caller. The <I>lpRemoteName</I> field of the <B>NETRESOURCE</B> specifies the remote name of the network resource whose parent name is required. If the calling program knows the values for the <I>lpProvider</I> and <I>dwType</I> fields, then it can fill them in, otherwise, they are set to NULL. If the <I>lpProvider</I> field is not NULL, then the network provider DLL can assume that the resource is owned by its network, but if it is NULL, then it must assume that the resource could be for some other network and do whatever checking is necessary to ensure that the result returned is accurate. For example, if being asked for the parent of a server, and the server is not part of a workgroup, then the network provider DLL should check to ensure that the server is part of its network and, if so, return its provider name. All other fields in the <B>NETRESOURCE</B> are ignored and are not initialized. </P>
<P><I>lpBuffer</I> </P>
<P>A pointer to the buffer to receive the result, which is returned as a single <B>NETRESOURCE</B> entry representing the parent resource. The <I>lpRemoteName</I>, <I>lpProvider</I>, <I>dwType</I>, and <I>dwUsage</I> fields are returned, all other fields being set to NULL. <I>lpProvider</I> should be set to NULL if the provider has only done a syntactic check (i.e. does not know that the resource is specific to its network). If the provider owns a parent of the network resource, (in other words is known to be the correct network to respond to this request), then <I>lpProvider</I> should be filled in with a non-null entry, even if the status return is WN_BAD_VALUE. The remote name returned should be in the same syntax as that returned from an enumeration, so that the caller can do a case-sensitive string compare to determine whether an enumerated resource is this resource. If a resource has no browse parent on the network, then <I>lpRemoteName </I>is returned as NULL. The RESOURCEUSAGE_CONNECTABLE value in the <I>dwUsage</I> field does not indicate that the resource can currently be connected to, but that the resource is connectable when it is available on the network. </P>
<P><I>cbBuffer</I> </P>
<P>This specifies the size in bytes of the buffer passed to the function call. If the result is WN_MORE_DATA, this will contain the buffer size required (in bytes) to hold the <B>NETRESOURCE</B> information. </P>
<UL><LI>     WN_SUCCESS if the call is successful. 
<P>WN_MORE_DATA if input buffer is too small. </P></LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>WN_BAD_VALUE </P></TD><TD VALIGN="TOP"><P>Invalid <I>dwScope</I> or dwUsage or <I>dwType</I>, or bad combination of parameters is specified (e.g. <I>lpRemoteName</I> does not correspond to <I>dwType</I>). </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NOT_AUTHENTICATED </P></TD><TD VALIGN="TOP"><P>The caller does not have the necessary permissions to obtain the name of the parent. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_ACCESS_DENIED </P></TD><TD VALIGN="TOP"><P>The user is authenticated to the network, but does not have sufficient permissions (access rights). </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P></FONT></BODY></HTML>
