<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Step 4. Creating an Installation Diskette and Installing the IR Communications Software</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Step 4. Creating an Installation Diskette and Installing the IR Communications Software </H3><P>When you reach this step of the roadmap, step 4, all the files you need to copy to a Windows 95 installation diskette for your device are in the RETAIL subdirectory on your development system hard disk. If you complete steps 2 and 3 of the Road Map procedure, the installation diskette you create in this step will contain your OEM-provided part of the serial IrFramer that supports your infrared device(s). </P>
<H4><A NAME="sec0"></A>A. Copying Files to Your Installation Diskette </H4><P>To create an installation diskette, do the following: </P>
<P>    1.     Format a 3.5" 1.44 Mb diskette, giving it the volume label "SIR Install." </P>
<P>    2.     Copy all the files from %IRDDKROOT%\BIN into the root directory of the installation diskette. </P>
<P>    3.     Copy your VxD into the root directory of the installation diskette. </P>
<P></P>
<H4><A NAME="sec1"></A>B. Editing the INFRARED.INF File </H4><P>Windows 95 Setup gets directives from INFRARED.INF for </P>
<UL><LI>     Installing a particular device (or devices) from a particular manufacturer. </LI><LI>     Copying files from your installation diskette to the appropriate directories on the Windows 95 computer hard disk. </LI><LI>     Displaying information about the device being installed and the manufacturer of that device in the Setup UI during the installation process. </LI><LI>     Adding keys and values to the Windows 95 registry that describe the IrFramer for your device. </LI></UL><P></P>
<P>The INFRARED.INF file that is shipped in the DDK has instructions for doing these things for all the IR devices supported by the DDK. The manufacturers and infrared device models supported by the INFRARED.INF file supplied with the DDK are reflected in the [Strings] section of the INF file: </P>
<P><BR></P>
<PRE> [Strings]
String1="(Standard infrared devices)"
String2="Extended Systems"
String3="Adaptec"
String4="Texas Instruments"
String5="ACTiSYS"
String6="Built-in Infrared port on laptop or desktop"
  .
  .
  .
String9="JetEye PC Infrared PC Interface (ESI-9680)"
String10="AIRport APA-9320 External Infrared Adapter"
String11="TI TravelMate 5000 Laptop"
String12="ACT-IR200L Infrared Wireless Interface"
String13="ACT-IR220L Infrared Wireless Interface"
String14="Parallax"
String15="LiteLink PRA9500A"
String16="AMP"
String17="PHASIR"
String18="Adaptec AIRport 1000"
</PRE>
<P>If you are a completely different manufacturer (for example, you are working for the Redeye Corporation on the REDEYE-88 IR adapter product), you will have to add information about your company and product in the INFRARED.INF file on the installation diskette for your product. Use the INFEDIT.EXE tool in the Windows 95 DDK to edit the INF file. Use the parts of the INFRARED.INF file that install the ACT_IR200L device as examples and add a similar set of information for your dongle. </P>
<P>For developers who are not familiar with using the INFEDIT.EXE tool, a detailed set of instructions follows for using Infedit to add an example IR device, the REDEYE-88, to INFRARED.INF. </P>
<P>The INFEDIT.EXE user interface shows the different parts of INFRARED.INF as folders (containers) on the left side of the screen. When you open a folder by double-clicking on it, the contents of the folder appear on the right side of the screen. The contents of a folder are one or more named items, each with a value (which may be null). </P>
<H5><A NAME="sec2"></A>Adding a New Manufacturer </H5><P>    1.     Right-click on the Manufacturer folder and select the New Manufacturer option from the popup menu. </P>
<P>    2.     When a folder labeled New Manufacturer appears, double-click on it to see its contents. </P>
<P>    3.     Double-click on the item <B>Company Name</B> and (for this example) enter "Redeye Corporation" (without the quotes) in the Edit String dialog box. </P>
<P></P>
<H5><A NAME="sec3"></A>Adding a New Device </H5><P>    1.     Right-click on the Manufacturer\Redeye Corporation folder and select the New Device option from the popup menu. </P>
<P>    2.     When a subfolder labeled &lt;Device Description&gt; is displayed under the Redeye Corporation folder, double-click on it to edit its contents. </P>
<P>    3.     Double-click on <B>Device Description</B> and enter the value "Redeye-88 Infrared Adapter" (or whatever the advertised name of your device is). </P>
<P>    4.     Double-click on <B>Install Section</B> and enter "Redeye_Install" (or any other self-documenting Install section name). </P>
<P>    5.     Double-click on <B>Hardware ID</B> and enter "Infrared\Redeye." </P>
<P></P>
<H5><A NAME="sec4"></A>Adding a Copy Files Section for the New Device You need to add a section to INFRARED.INF that copies both the generic serial IrFramer, IRLAPFRM.VXD, and the device-dependent VxD you created from the installation diskette to the \%WINDOWS%\SYSTEM subdirectory on the Windows 95 computer hard disk. </H5><P>    1.     Right-click on the Copy Files folder and select the New Copy Files Section option from the pop-up menu. </P>
<P>    2.     When a subfolder labeled NewFileSection is displayed below the Copy Files folder, double-click on it to edit the contents. </P>
<P>    3.     Double-click on <B>Section Name</B> and enter the value "Redeye_Framer." You do not have to change the <B>Destination Directory</B> value since the default destination directory for INFRARED.INF is the \%WINDOWS%\SYSTEM directory. </P>
<P>    4.     Right-click on the subfolder that is now labeled Redeye_Framer and select the Add Filename option from the popup menu. </P>
<P>    5.     Double-click on the item label <B>File Name</B> and in the Destination Name field of the edit dialog enter the filename of the generic serial IrFramer, IRLAPFRM.VXD. </P>
<P>    6.     Right-click again on the subfolder labeled Redeye_Framer and select the Add Filename option. </P>
<P>    7.    Double click on the item label <B>File Name</B> and in the Destination Name field of the edit dialog enter the filename the VxD you created in earlier steps of this Road Map. In this example, that is RED88.VXD. </P>
<P></P>
<H5><A NAME="sec5"></A>Adding an Add Registry Section for the New Device You need to add a section for INFRARED.INF that writes the named of the generic serial IrFramer VxD, the name of your device-specific VxD, and the name that identifies your device to the Registry. You can use the contents of the existing ACTiSYS-IR200L_AddReg folder in INFRARED.INF as a model. To add such a folder for your device: </H5>
<P>    1.     Right-click on the Add Registry Sections folder and select the New Add Registry Section option from the pop-up menu. </P>
<P>    2.    When a subfolder labeled &lt;Section Name&gt; is displayed below the Add Registry Sections folder, double-click on it so you can edit the contents. </P>
<P>    3.     Double-click on <B>Section Name</B> and enter the value "Redeye_AddReg." </P>
<P>    4.     Right-click on the folder that is now labeled Redeye_AddReg and select the Add Section Value option from the popup menu. </P>
<P>    5.      When a new subfolder labeled Item0 is displayed under the Redeye_AddReg folder, double-click on it to edit its contents to add a registry entry for the generic serial IrFramer. </P>
<P>    6.      Double-click on the <B>RegistryRoot</B> item label and enter the value "HKLM" (without the quotes). </P>
<P>    7.      Double-click on the <B>Subkey</B> item label and enter the value "\Enum\Infrared\Framer" (without the quotes). </P>
<P>    8.      Double-click on the <B>Value Name</B> item label and enter the value "Driver" (without the quotes). </P>
<P>    9.      Double-click on the <B>Value</B> item label and enter the value "IRLAPFRM.VXD" (without the quotes). </P>
<P></P>
<P>Repeat steps 4 through 9, except this time the new subfolder will be labeled Item1. Set the <B>RegistryRoot</B> and <B>Subkey</B> items to the same values as for Item0. Set the <B>Value Name</B> item value to "DongleType" and the <B>Value</B> to "RED88." </P>
<P>Repeat steps 4 through 9 again, except this time the new subfolder will be labeled Item2. Set the <B>RegistryRoot</B> and <B>Subkey</B> items to the same values as for Item0 and Item1. Set the <B>Value Name</B> item value to "SpeedDriver" and the <B>Value</B> to the name of the VxD you created (in this example, RED88.VXD). </P>
<H5><A NAME="sec6"></A>Adding an Install Section for Your Device </H5><P>An INF file Install section names all the other sections in the INF file that Windows 95 Setup is to run to do a complete installation of your device. You can use the existing folder ACTiSYS-IR200L_Install as a model for your new Install folder. </P>
<P>Your Install section has to name two Copy Files sections and two Add Registry sections. One Copy Files section copies the two Framer files (you created this section in an earlier step and in this example named the section Redeye_Framer). The other Copy Files section copies all the IR Communications for Windows 95 component files except the two Framer files off the Installation diskette; that section already exists in INFRARED.INF and is named Driver_Copy. </P>
<P>Your Install section also has to name the Add Registry section you just created, which in this example is named Redeye_AddReg, and the Add Registry section that registers all the other IR Communications for Windows 95 components (this folder already exists in INFRARED.INF and is named IRCOMMON_AddReg. </P>
<P>To add the Install section for your device do the following in the INFEDIT.EXE interface: </P>
<P>    1.     Right-click on the folder labeled Install Sections and select the New Install Section option from the popup. </P>
<P>    2.     When a new subfolder labeled NewInstallSection is displayed under the Install Sections folder, click on it to edit its contents. </P>
<P>    3.     Double-click on the item labeled <B>Copy File Sections</B>. A dialog box displays the names of all the Copy Files sections in INFRARED.INF. Select Driver_Copy and add it to the list on the right of the dialog box. The select Redeye_Framer and add it to the list on the right. Then click OK. </P>
<P>    4.     Double-click on the item labeled <B>AddReg</B>. A dialog box lists the names of all the sections in INFRARED.INF that add items to the Registry. Select IRCOMMON_AddReg and add it to the list on the right. Then select Redeye_AddReg and add it to the list of names on the right and click OK. </P>
<P></P>
<H4><A NAME="sec7"></A>C. Testing Your Installation Diskette </H4><P></P>
<P><B>Important </B></P>
<P>Before you use the installation disk you have created to install the Infrared Communications on a Windows 95 computer, make sure your infrared device is connected to the computer and powered-up. </P>
<P></P>
<P>Install Windows 95 Infrared Communications driver by inserting the installation diskette in a Windows 95 computer and running the Setup program on the diskette. The Setup program will install the required files in the Windows System and Inf directories, add required entries to the Registry, and launch the Windows 95 Add New Hardware Wizard. The Wizard prompts will lead you through the rest of the installation process. </P>
<P></P>
<P><B>Note </B></P>
<P>For a detailed description of how the installation procedure works, see the documentation file DRVRELNO.DOC which is part of this DDK. </P>
<P></P>
<H4><A NAME="sec8"></A>D. Checking the Windows 95 Registry </H4><P>If you are installing a dongle other than the JetEye PC Infrared PC Interface (ESI-9680), then you need to check the contents of the following key in the registry of the Windows 95 computer on which you installed the dongle: HKEY_LOCAL_MACHINE\Enum\Infrared\Framer. Use the Windows 95 REGEDIT.EXE tool to do this. </P>
<P>For dongles other than the JetEye PC Infrared PC Interface (ESI-9680), the HKEY_LOCAL_MACHINE\Enum\Infrared\Framer key must contain four values: </P>
<UL><LI>     DongleType </LI><LI>     Driver </LI><LI>     PortName </LI><LI>     SpeedDriver </LI></UL><P></P>
<P>For example, for an ACTiSYS ACT-IR200L Infrared Wireless Interface dongle installed on physical COM port COM1:, the required values look like this: </P>
<P><BR></P>
<PRE>DongleType="ACT-IR200L"
Driver="irlapfrm.vxd"
PortName="COM1"
SpeedDriver="act200l.vxd"
</PRE>
<P>The DongleType value is used by IRLAPFRM.VXD to determine which manufacturer's dongle is currently installed. The SpeedDriver value is used to dynamically load the OEM-supplied part of the framer. </P>
<P>If one of the required values is missing from the registry Framer key, add it using REGEDIT.EXE. </P></FONT></BODY></HTML>
