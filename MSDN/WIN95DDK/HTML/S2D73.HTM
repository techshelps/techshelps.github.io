<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Logoff</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Logoff </H3><P>When logoff is occurring, all applications are shut down. They receive the same messages that they would receive when the system is shut down: <B>WM_QUERYENDSESSION</B> followed by <B>WM_ENDSESSION</B>. The <I>lParam</I> parameter has the <B>EWX_REALLYLOGOFF</B> bit set indicating that this is a logoff, not a shutdown. The messages are sent via <B>BroadcastSystemMessage</B>, so they are received by all top-level windows, installable drivers, and VxDs. </P>
<P>Most ordinary applications are not affected by logon and logoff, beyond the ordinary implications of active connections being disconnected and open files being closed. The primary purpose of this message is for network-specific applications which maintain internal state based on the current logon. For example, an application which receives messages from other stations might need to delete a NetBIOS name when the user logs off. </P>
<P>A service process that needs to stay running when the user logs off can call the <B>RegisterServiceProcess</B> API to make itself exempt from the automatic shutdown of all applications at logoff time. </P>
</FONT></BODY></HTML>
