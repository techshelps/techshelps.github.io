<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NPGetUniversalName</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>NPGetUniversalName </H3><P>This function returns the name used to access a directory or file on a redirected local device from the network. Its primary use is to return the information for directories that are part of a distributed file store (DFS), which are redirected from a directory below the root of the associated local device. Providers that do not support this type of feature do not have to support this function, as MPR provides default behavior for this case. </P>
<P><BR></P>
<PRE>DWORD NPGetUniversalName(
  LPTSTR  lpLocalPath,
  DWORD   dwInfoLevel,
  LPVOID  lpBuffer,
  LPDWORD lpBufferSize
  );
</PRE>
<P><I>lpLocalPath</I> </P>
<P>Contains the local path to an object on a network resource. This path is a drive-based path. </P>
<P><I>dwInfoLevel</I> </P>
<P>The level of detail of information the caller is interested in as described above. This may have the value UNIVERSAL_NAME_INFO_LEVEL or REMOTE_NAME_INFO_LEVEL, depending upon the level of information required. </P>
<P><I>lpBuffer</I> </P>
<P>Points to a buffer to receive the information the user has requested. The buffer contains a <B>UNIVERSAL_NAME_INFO</B> structure or a <B>REMOTE_NAME_INFO</B> structure (depending upon the value of <I>dwInfoLevel</I>), followed by the return data pointed to from within the structure. The structures returned are described below. </P>
<P><I>lpBufferSize</I> </P>
<P>This is used to specify the size, in bytes, of the buffer passed in. If the call fails because the buffer is not big enough, this location will be used to return the required buffer size. </P>
<UL><LI>     WN_SUCCESS if the call is successful. Otherwise, an error code is returned, which may include: </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>WN_BAD_LOCALNAME </P></TD><TD VALIGN="TOP"><P><I>lpLocalPath</I> does not start with a valid redirected local disk device name. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_BAD_LEVEL </P></TD><TD VALIGN="TOP"><P><I>dwInfoLevel</I> is not set to a valid value. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NOT_CONNECTED </P></TD><TD VALIGN="TOP"><P><I>lpLocalPath</I> is not a connected network resource. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_MORE_DATA </P></TD><TD VALIGN="TOP"><P><I>lpBuffer</I> is not a large enough buffer to return the result. <I>lpBufferSize</I> is returned with the required buffer size. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NO_NETWORK </P></TD><TD VALIGN="TOP"><P>The network is not present. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P>The structures that can be returned have the following format: UNIVERSAL_NAME_INFO and REMOTE_NAME_INFO. </P>
<P></P>
<P></P></FONT></BODY></HTML>
