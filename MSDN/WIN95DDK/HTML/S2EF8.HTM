<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>gdiPlaySpoolStream</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>gdiPlaySpoolStream </H3><P><BR></P>
<PRE>HDC gdiPlaySpoolStream(
    LPSTR   lpszDevice,
    LPSTR   lpszOutput,
    LPSTR   lpszSpoolFile,
    DWORD   JobId,
    LPDWORD lpcbBuf,
    HDC     hDC
);
</PRE>
<P>The Microsoft-provided GDI 32 <B>gdiPlaySpoolStream</B> function plays back a spool file or a buffer of spool data, or deletes all the EMFs of a spool file. </P>
<UL><LI>     Returns a non-NULL hDC if successful in playing back a spool file or buffer, or successfully delete all the EMFs for a spool file. If a buffer of data was played back, <I>lpcbBuf</I> contains the amount of data (number of bytes) that were actually processed. Otherwise, returns NULL upon failure. </LI></UL><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>lpszDevice</I> </P></TD><TD VALIGN="TOP"><P>Specifies the name of the printer that prints the document, or NULL. If NULL, <B>gdiPlaySpoolStream</B> deletes all the .TMP files whose paths are listed in the job description file specified by the <I>lpszSpoolFile</I> parameter. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpszOutput</I> </P></TD><TD VALIGN="TOP"><P>Output file name from <B>StartDoc</B>, that will be passed back into <B>StartDoc</B>. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpszSpoolFile</I> </P></TD><TD VALIGN="TOP"><P>Spool file name or a buffer of spool data depending on the value in the <I>lpcbBuf</I> parameter. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>JobId</I> </P></TD><TD VALIGN="TOP"><P>Identifies the print job. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpcbBuf</I> </P></TD><TD VALIGN="TOP"><P>If <I>lpcbBuf</I> is NULL, <I>lpszSpoolFile</I> is a spool file name and this parameter is not used. </P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>If <I>lpcbBuf</I> is non-NULL, <I>lpszSpoolFile</I> is a buffer of spool data and <I>lpcbBuf</I> points to the size of the buffer. Upon return, <I>lpcbBuf</I> points to the amount of data (number of bytes) in the buffer that was processed, since the buffer may not end at a spool data block boundary. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>hDC</I> </P></TD><TD VALIGN="TOP"><P>If the <I>lpcbBuf</I> parameter is NULL, the <I>hDC</I> parameter is not used by the <B>gdiPlaySpoolStream</B> function. </P></TD></TR><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P>If the <I>lpcbBuf</I> parameter is non-NULL, the <I>hDC</I> parameter specifies the handle of the DC used to play back the spool buffer. If the <I>lpcbBuf</I> parameter is non-NULL and the <I>hDC</I> parameter is NULL, the very first buffer of the job is being played and there is not a valid handle to a DC yet. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>If <I>lpcbBuf</I> is NULL, <I>lpszSpoolFile</I> points to the filename of the spool file to playback. Otherwise, <I>lpszSpoolFile</I> is the pointer to a buffer of spool data, and <I>lpcbBuf</I> points to the size of the buffer and upon return, <I>lpcbBuf</I> points to the number of bytes that were actually sent to the printer. </P>
<P>If the <I>hDC</I> parameter is NULL, then this is the first call made to play the spool file. Otherwise, the <I>hDC</I> parameter will contain the handle of the DC that <B>gdiPlaySpoolStream</B> will use to play the remainder of the spool file. </P></FONT></BODY></HTML>
