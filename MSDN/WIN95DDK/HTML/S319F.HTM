<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Virtual Device Identifier Numbers</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H2>Virtual Device Identifier Numbers </H2><P>In the <B>DECLARE_VIRTUAL_DEVICE</B> line of every virtual device driver (VxD) is the "VxD ID" field. This field will be either a unique number assigned to the virtual device, or the <B>Undefined_Device_ID</B> constant. </P>
<P>Certain virtual devices for Windows must a have unique identifier. A VxD that calls a Microsoft&reg; MS-DOS&reg; device or a terminate-and-stay-resident (TSR) program must have an identifier. An identifier is also required for a VxD that provides any of the following: </P>
<UL><LI>     Any service </LI><LI>     A V86 mode API </LI><LI>     A protected mode API </LI></UL><P></P>
<P>In addition, Windows provides no protection against loading a VxD using <B>Undefined_Device_ID</B> more than once. When Windows loads, it gets a list of all virtual devices to be loaded (through the INT 2Fh, AX=1605h broadcast and the SYSTEM.INI file). If a particular VxD is specified more than once and it uses <B>Undefined_Device_ID</B>, the VxD will be loaded multiple times. If, however, the virtual device has its own unique identifier, Windows will recognize the situation, inform the user, and abort the loading process (unless there is code in the VxD that allows Windows to continue). </P></FONT></BODY></HTML>
