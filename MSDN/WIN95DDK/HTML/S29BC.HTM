<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Installing a Wave Driver</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Installing a Wave Driver </H3><P>Playback and recording of audio required by voice modems is done by the Windows Multimedia System (MMSystem), which uses digitized wave files (.WAV files). There are the two basic types of voice modem wave devices, each requiring a different interface with Unimodem/V: </P>
<UL><LI>     Serial wave device driver. </LI><LI>     Wave wrapper. </LI></UL><P></P>
<P>Serial port modems send and receive wave input/output data through the Windows 95 computer's communications port. SERWVDRV.DRV is used by Unimodem/V as the serial wave device driver. SERWVDRV.DRV supports the following formats: </P>
<UL><LI>     4-bit Rockwell ADPCM 7200 Hz </LI><LI>     4-bit IMA ADPCM 4800 Hz </LI><LI>     4-bit IMA ADPCM 7200 Hz </LI><LI>     4-bit IMA ADPCM 8000 Hz </LI></UL><P></P>
<P>Modems with a separate audio hardware interface require synchronization between the modem and audio via AT commands (to set the mode, etc.). For these modems, the wave driver wrapper performs all synchronization. It is called by MMSystem, and calls Unimodem to send any needed AT commands to the modem. After the AT commands are completed, the wave driver wrapper calls back into MMSystem, and MMSystem then calls the modem wave device. The modem wave device interfaces only to the audio hardware interface. Your modem wave driver must not directly access to the COMM port (let the wave wrapper send all AT commands to the modem). </P>
<P>You must decide which wave device driver to use, the serial wave device driver or the wave wrapper. </P>
<P>For either one to be installed, the following item must be added to an AddReg section in your modem INF file: </P>
<P><BR></P>
<PRE>   HKR,, Enumerator, ,serwave.vxd
</PRE>
<P>This item must be in every voice modem INF file, regardless of whether your voice modem uses the serial wave driver or wave wrapper to play audio. Do not change the value of this entry, it is always SERWAVE.VXD. SERWAVE.VXD has the ability to connect either type of wave device to your modem when your modem is detected. </P>
<P>You must also provide a wave driver INF in addition to your modem INF file. Sample INF files are in the MDK for both types of wave drivers: </P>
<UL><LI>     SMPSERWV.INF is a sample INF file the installs the serial wave driver. </LI><LI>     SMPWRAP.INF is a sample INF file that installs the wave wrapper. </LI></UL><P></P>
<P>When either the serial driver or wave wrapper are installed, the game-compatible device is installed automatically to ensure compatibility with Windows games. Three multimedia devices are usually installed: </P>
<UL><LI>     The line device, which allows audio to be recorded from and/or played to the phone line during an active call. </LI><LI>     The handset device, which allows audio to be recorded from and/or played to the local telephone handset. If the modem does not support a handset device, this device will not be installed. </LI><LI>     A game compatible device, which ensures compatibility with Windows games and other multimedia applications. Many Windows multimedia applications hard code using device 0 for their wave out device. When the serial wave device or wave wrapper is installed, it is always device 0. The game compatible device was added to the serial wave and wave wrapper devices to "pass through" calls to device 0 to the other wave driver device installed. </LI></UL><P></P>
<H4><A NAME="sec0"></A>Changing Items in SMPSERWV.INF </H4><P>A sample serial wave driver INF file is in the MDK, SMPSERWV.INF. You can include this file on your modem installation diskette with few, if any, changes. Each of the sections that contain items you may want to change are discussed below. </P>
<UL><LI>     You may want to change the XformID item, such as the one shown in the [SAMPLE2.AddReg] section. 
<P><BR></P>
<PRE>[SAMPLE2.AddReg]
HKR,Drivers\wave\serwvdrv.drv,Description,,%Rockwell.DeviceDesc%    ;; serwvdrv.drv is driver
HKR,Config,XformModule,  , "umdmxfrm.dll"    ;; necessary
HKR,Config,XformID,     1, 01, 00, 00, 00    ;; format

</PRE></LI></UL><P></P>
<P>Use the value of the XformID key to specify the format your serial wave device uses. The value used in SMPSERWV.INF, 0x00000001, specifies the 4-bit Rockwell ADPCM 7200 Hz format. Valid values for the XformID key are listed in the following table: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>XformID Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P>0x00000001 </P></TD><TD VALIGN="TOP"><P>4-bit Rockwell ADPCM 7200 Hz format </P></TD></TR><TR><TD VALIGN="TOP"><P>0x00000002 </P></TD><TD VALIGN="TOP"><P>4-bit IMA ADPCM 4800 Hz format </P></TD></TR><TR><TD VALIGN="TOP"><P>0x00000003 </P></TD><TD VALIGN="TOP"><P>4-bit IMA ADPCM 7200 Hz format </P></TD></TR><TR><TD VALIGN="TOP"><P>0x00000004 </P></TD><TD VALIGN="TOP"><P>4-bit IMA ADPCM 8000 Hz format </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<UL><LI>     You may want to change the WaveDevices item, such as the one shown in the [SAMPLE1.AddReg] section. 
<P><BR></P>
<PRE>[SAMPLE1.AddReg]
HKR,Drivers\wave\serwvdrv.drv,Description,,%Cirrus.DeviceDesc%
HKR,Config,XformModule,  , "umdmxfrm.dll"
HKR,Config,XformID,     1, 02, 00, 00, 00
HKR,Config,WaveDevices,  1, 01, 00        ;; normally, have 2 wave devices, line and
                        ;; handset.  If handset is not supported
                        ;; only have 1 wave device, so serwvdrv
                        ;; needs to know this so it only reports
                        ;; one device.  If this entry is omitted
                        ;; default is 2

</PRE></LI></UL><P></P>
<P>Use the value of the WaveDevices key to indicate whether or not your voice modem has the ability to playback and record to a handset device. The value used in SMPSERWV.INF, 0x00000001, indicates that the voice modem does not have this ability, or does not have a handset device. Valid values for the WaveDevices key are listed in the following table: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>WaveDevices Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P>0x00000001 </P></TD><TD VALIGN="TOP"><P>Voice modem plays back and records to line only. </P></TD></TR><TR><TD VALIGN="TOP"><P>0x00000002 </P></TD><TD VALIGN="TOP"><P>Voice modem plays back and records to line and handset device. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>There other items in the SMPSERWV.INF file that are of interest only because they indicate SMPSERWV.INF is a wave device INF file and not a modem device INF file. </P>
<UL><LI>     In the [Version] section, the class of device is Media and the class installer is MMCI.DLL. 
<P><BR></P>
<PRE>[Version]
Signature="$Windows95$"
Class=MEDIA        ;; needed - this is a wave driver, so gets installed in media
provider=%MSFT%

[ClassInstall]
Addreg=Class.AddReg    ;; standard media stuff

[Class.AddReg]        ;; standard media stuff
HKR,,,,%MediaClassName%
HKR,,Icon,,"-1"
HKR,,Installer,,mmci.dll

</PRE></LI><LI>     The devloader is MMDEVLDR.VXD. 
<P><BR></P>
<PRE>[MSSERWAVE.AddReg]                ;; this stuff should never change
HKR,,DevLoader,,mmdevldr.vxd
HKR,Drivers,MIGRATED,,0
HKR,Drivers\wave,,,
HKR,,Driver,,serwave.vxd
HKR,Drivers\wave\serwvdrv.drv,Driver,,serwvdrv.drv
HKR,Drivers,SubClasses,,"wave"

</PRE></LI></UL><P></P>
<H4><A NAME="sec1"></A>Changing Items in SMPWRAP.INF </H4><P>A sample serial wave driver INF file is in the MDK, SMPWRAP.INF. You can include this file on your modem installation diskette with few, if any, changes. Each of the sections that contain items you may want to change are discussed below. </P>
<UL><LI>     You may want to change one or more of the items that describe the wave wrapper, such as the items in the section [MSWRAPPER.AddReg]. 
<P><BR></P>
<PRE>[MSWRAPPER.AddReg]
  .
  .
  .
;; information about the Wave Driver being wrapped

HKR,Config,LowerMid,1,        5c, 00
HKR,Config,LowerWaveInPid,1,  81, 00
HKR,Config,LowerWaveOutPid,1, 82, 00

</PRE></LI></UL><P></P>
<P>Use the values of the LowerMid, LowerWaveInPid, and LowerWaveOutPid keys to specify the audio wave driver the wave wrapper is using. The LowerMid value is the wave driver manufacturer's ID, the LowerWaveInPid value is the wave input product ID, and the LowerWaveOutPid is the wave output product ID. </P>
<P>You may also want to change one of more of the following entries in the [MSWRAPPER.AddReg] section: </P>
<P><BR></P>
<PRE>HKR,Config,WaveOutMixerDest,    1, 00, 00, 00, 00
HKR,Config,WaveOutMixerSource,  1, 00, 00, 00, 00

HKR,Config,WaveInMixerDest,     1, 01, 00, 00, 00
HKR,Config,WaveInMixerSource,   1, 00, 00, 00, 00
</PRE>
<P>The wave wrapper has a mixer device. These entries connect the wave wrapper mixer device to the wave driver mixer. The wave wrapper mixer will control the wave driver mixer while the wave wrapper is loaded. When the wave wrapper is not loaded, the wave driver mixer settings are set back to their original settings. </P>
<P>Use the value in the WaveOutMixerDest key to indicate the multimedia line that wave out goes to; normally, this is the speakers. Use the value in the WaveOutMixerSource key to indicate the multimedia line used as the source relative to WaveOutMixerDest; normally this is the ADC. </P>
<P>Use the value in the WaveInMixerDest key to indicate the multimedia line corresponding to wave in. Use the value in the WaveInMixerSource key to indicate the multimedia line used as the source relative to WaveInMixerDest; normally this is line in or wave in. </P>
<P>There other items in the SMPWRAP.INF file that are of interest only because they indicate SMPWRAP.INF is a wave device INF file and not a modem device INF file. </P>
<UL><LI>     In the [Version] section, the class of device is Media and the class installer is MMCI.DLL. 
<P><BR></P>
<PRE>[Version]
Signature="$Windows95$"
Class=MEDIA
provider=%MSFT%

[ClassInstall]
Addreg=Class.AddReg

[Class.AddReg]
HKR,,,,%MediaClassName%
HKR,,Icon,,"-1"
HKR,,Installer,,mmci.dll

</PRE></LI><LI>     The devloader is MMDEVLDR.VXD. 
<P><BR></P>
<PRE>[MSWRAPPER.AddReg]
HKR,,DevLoader,,mmdevldr.vxd
HKR,Drivers,MIGRATED,,0
HKR,Drivers\wave,,,
HKR,,Driver,,serwave.vxd
HKR,Drivers\wave\tamwrap.drv,Description,,%Wavewrap.DeviceDesc%
HKR,Drivers\wave\tamwrap.drv,Driver,,wavewrap.drv
HKR,Drivers,SubClasses,,"wave"

</PRE></LI></UL><P></P></FONT></BODY></HTML>
