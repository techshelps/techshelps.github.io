<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Run-Time Dynamic Events</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Run-Time Dynamic Events </H3><P>A new feature of Windows 95 is the ability of device drivers and applications to query and notify each other about changes in the state of the system, particularly changes in the system hardware. Although Windows applications have been able to broadcast messages to other Windows applications in all releases of Windows subsequent to 3.0, it was not possible for VxDs to do so, nor was it possible to query other system components before taking action. Applications can use Windows 95's new capabilities to take appropriate action for such events as the addition or removal of a device; for example, an application that is using a floppy disk can use these API elements to receive a notification if the floppy disk is removed. </P>
<P>The <B>SHELL_BroadcastSystemMessage</B> function broadcasts a message to one or more of the following classes of system components: </P>
<UL><LI>     Windows applications </LI><LI>     Virtual device drivers (VxDs) </LI><LI>     Installable Windows ring 3 device drivers </LI><LI>     Network drivers </LI></UL><P></P>
<P>The counterpart to the <B>SHELL_BroadcastSystemMessage</B> function that is used by Windows applications is the <B>BroadcastSystemMessage</B> function. Windows applications receive broadcast system messages through their normal message procedure. The message is not sent to child windows. </P>
<P>The WM_DEVICECHANGE message identifies a change in the status of the system hardware; it can be used with <B>SHELL_BroadcastSystemMessage</B> to inform system components of hardware changes. WM_DEVICECHANGE includes a number of query notifications; an application can return QUERY_VETOED to a query notification to veto the specified action. </P></FONT></BODY></HTML>
