<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NPLogon</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>NPLogon </H3><P><BR></P>
<PRE>DWORD NPLogon(
HWND hwndOwner,
LPLOGONINFO lpAuthentInfo,
LPLOGONINFO lpPreviousAuthentInfo,
LPTSTR lpLogonScript,
DWORD dwBufferSize,
DWORD dwFlags
  );
</PRE>
<P><I>hwndOwner</I> </P>
<P>A handle to a window which should be the owner for any dialog boxes or messages which the provider might display. </P>
<P><I>lpAuthentInfo</I> </P>
<P>A structure describing the user who logged on. </P>
<P><I>lpPreviousAuthentInfo</I> </P>
<P>A structure describing the user's previous authentication information, if a password change was required during the logon process. If no password change was required, this parameter will be NULL. </P>
<P><I>lpLogonScript</I> </P>
<P>Points to a buffer to which the NP may copy the path of an executable program or batch file which should be run upon successful logon. This buffer is initialized by the MPR to be a null string. If the NP leaves the buffer that way, no logon script will be executed for that network. </P>
<P><I>dwBufferSize</I> </P>
<P>Size of the <I>lpLogonScript</I> buffer in bytes. This is guaranteed to be at least as long as the maximum length of a MS-DOS pathname. Since this entrypoint should not be called multiple times for a single logon phase, the NP may not return WN_MORE_DATA if the buffer is not large enough. In this case, the NP should just provide a null string, and no logon script will be executed for that network. </P>
<P><I>dwFlags</I> </P>
<P>Any combination of the following values: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>LOGON_DONE </P></TD><TD VALIGN="TOP"><P>Logon is completed. </P></TD></TR><TR><TD VALIGN="TOP"><P>LOGON_PRIMARY </P></TD><TD VALIGN="TOP"><P>This NP is the Primary Logon Provider. The provider should always display a user interface, and should return the user name and password in the <I>lpAuthentInfo</I> structure's buffers. The provider must return a non-blank user name; the password may or may not be blank. </P></TD></TR><TR><TD VALIGN="TOP"><P>LOGON_MUST_VALIDATE </P></TD><TD VALIGN="TOP"><P>If LOGON_PRIMARY is also set, the user must either be successfully authenticated with the network, or must cancel the logon. An "unconfirmed" logon is not permitted. If the provider returns WN_NOT_VALIDATED, MPR will display an appropriate warning message. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<UL><LI>     WN_SUCCESS if the call is successful. Otherwise, an error code is returned, which may include: </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>WN_CANCEL </P></TD><TD VALIGN="TOP"><P>The user canceled a logon dialog box displayed by the provider. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NOT_VALIDATED </P></TD><TD VALIGN="TOP"><P>The call is successful, but the user has not been authenticated with a network entity. It is not certain that the user's credentials are correct. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P></FONT></BODY></HTML>
