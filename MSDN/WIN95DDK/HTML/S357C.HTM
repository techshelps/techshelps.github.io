<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SHELL_Message</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>SHELL_Message </H3><P><BR></P>
<PRE>include shell.inc
mov ebx, Handle             ; virtual machine handle
mov eax, Flags              ; message box flags
mov ecx, OFFSET32 Message   ; address of message text
mov edi, OFFSET32 Caption   ; address of caption text
mov esi, OFFSET32 Callback  ; address of callback
mov edx, ReferenceData      ; reference data for callback
VxDcall SHELL_Message

jc  error
or eax, eax                 ; nonzero if success
</PRE>
<P>Displays a message box using the Windows shell. Uses EAX and Flags. </P>
<UL><LI>     Clears the carry flag and sets the EAX register to a nonzero value if successful. Otherwise, sets the carry flag to indicate an error such as insufficient memory to display the message. </LI></UL><P></P>
<P><I>Handle</I> </P>
<P>Handle of the virtual machine responsible for the message. </P>
<P><I>Flags</I> </P>
<P>Message box flags. See the MB_ symbols in the SHELL.INC file. </P>
<P><I>Message</I> </P>
<P>Address of a null-terminated string containing the message text. </P>
<P><I>Caption</I> </P>
<P>Address of a null-terminated string containing the caption text. If this parameter is zero, the service uses the standard caption. If this parameter points to an empty string, the message box has no caption. </P>
<P><I>Callback</I> </P>
<P>Address of the callback procedure to process the user's response when the message box returns. If this parameter is zero, no callback procedure is called. </P>
<P><I>ReferenceData</I> </P>
<P>Reference data to pass to the callback procedure. </P>
<P>The strings pointed to by the ECX and EDI registers must remain valid until the callback procedure is called. In other words, the memory for those strings should not be freed until the callback is made. </P>
<P>The system calls the callback procedure after the user closes the message box. The callback receives the following input parameters: </P>
<P><BR></P>
<PRE>mov eax, Response       ; response code from the message box
mov edx, ReferenceData  ; points to reference data
call [Callback]
</PRE>
<P>The response code in the EAX register is one of the ID symbols defined in the SHELL.INC file. The EBX register may or may not contain the current virtual machine handle when the callback is called. The callback must not rely on its value. If this service returns an error, a virtual device can use the <B>SHELL_SYSMODAL_Message</B> service to force the system to display a message. </P>
<P></P>
<P></P></FONT></BODY></HTML>
