<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CONFIGMG_Query_Remove_SubTree</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>CONFIGMG_Query_Remove_SubTree </H3><P><BR></P>
<PRE>CONFIGRET CONFIGMG_Query_Remove_SubTree(DEVNODE dnAncestor, ULONG ulFlags)
</PRE>
<P>Checks whether a device node and its progeny can be removed. </P>
<UL><LI>     Returns CR_SUCCESS if the function is successful. Otherwise, the return value can be CR_INVALID_DEVNODE, CR_INVALID_FLAG, CR_REMOVE_VETOED, or CR_NOT_SYSTEM_VM. </LI></UL><P></P>
<P><I>dnAncestor</I> </P>
<P>The root of the subtree whose removal is being queried. </P>
<P><I>ulFlags</I> </P>
<P>Must be zero. </P>
<P>If the hardware can only detect removal, the enumerator should call <B>CONFIGMG_Remove_SubTree</B>; this is problematic, because it does not give applications the opportunity to close their files. If the hardware has an indication that the user wants to remove it (that is, if it is software-eject capable), the enumerator should follow the steps shown in this example: </P>
<P><BR></P>
<PRE>if (CM_Query_Remove_Subtree(dnDevNode, 0)==CR_SUCCESS)
     CM_Remove_SubTree(dnDevNode, 0);
</PRE>
<P>See also <B>CONFIGMG_Remove_Subtree</B> </P>
<P></P>
<P></P></FONT></BODY></HTML>
