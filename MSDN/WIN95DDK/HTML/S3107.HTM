<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BCSToBCS</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>BCSToBCS </H3><P><BR></P>
<PRE>BCSToBCS(
 unsigned char * pDest,
 unsigned char * pSrc,
 int dstCharSet,
 int srcCharSet,
 unsigned int MaxLen
 )
</PRE>
<P>This service maps a BCS string to another BCS string. Currently, the only conversions supported are from OEM to Windows ANSI and vice versa. It takes care of double-byte encoding. </P>
<P><I>pDest</I> </P>
<P>Supplies a pointer to the destination buffer. The destination buffer must be long enough for the path. </P>
<P><I>pSrc</I> </P>
<P>Supplies a pointer to the source buffer. </P>
<P><I>dstCharSet</I> </P>
<P>Supplies the character set the destination string needs. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>BCS Character Set Values:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><B>BCS_WANSI</B> </P></TD><TD VALIGN="TOP"><P>Specifies that the BCS string uses the Windows ANSI codepage. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>BCS_OEM</B> </P></TD><TD VALIGN="TOP"><P>Specifies that the BCS string uses the currently active OEM codepage. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>srcCharSet</I> </P>
<P>Supplies the character set the source string is in. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>BCS Character Set Values:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><B>BCS_WANSI</B> </P></TD><TD VALIGN="TOP"><P>Specifies that the BCS string uses the Windows ANSI codepage. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>BCS_OEM</B> </P></TD><TD VALIGN="TOP"><P>Specifies that the BCS string uses the currently active OEM codepage. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>MaxLen</I> </P>
<P>Supplies the maximum length the destination path should be i.e. the size of the buffer. </P>
<UL><LI>     Returns the number of bytes in the converted unicode string and flags in the <B>_QWORD</B> structure format described below. </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>_QWORD Structure:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P>
<P>The fields in this structure are filled in as follows. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ddLower</I> </P></TD><TD VALIGN="TOP"><P>Returns the number of bytes in the converted unicode string. Under the standard C parameter conventions, this field is returned in register <I>[EAX]</I>. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ddUpper</I> </P></TD><TD VALIGN="TOP"><P>Returns special flags about the mapping operation. Under the standard C parameter conventions, this field is returned in register <I>[EDX]</I>. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Mapping Flag Values:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><B>MAP_FLAG_LOSS</B> </P></TD><TD VALIGN="TOP"><P>Indicates that a loss occurred during the conversion. This will typically happen if the BCS character has no corresponding character in the unicode character set. The replacement character for this case is the underscore character '_', ASCII code 0x5f. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>MAP_FLAG_TRUNCATE</B> </P></TD><TD VALIGN="TOP"><P>Indicates that a malformed multi-byte character was detected i.e. a lead byte for a multi-byte character was found without a tail byte. This can happen either because the string passed in was malformed or because the length passed in was incorrect so as to fall at the boundary between a lead byte and a trail byte. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>pDest</I> </P></TD><TD VALIGN="TOP"><P>Contains buffer filled in with the converted BCS string. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P></P>
<P></P></FONT></BODY></HTML>
