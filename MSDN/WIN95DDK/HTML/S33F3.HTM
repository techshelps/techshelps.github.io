<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Declare_Virtual_Device</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Declare_Virtual_Device </H3><P><BR></P>
<PRE>include vmm.inc

Declare_Virtual_Device Name, MajorVer, MinorVer, CtrlProc, DeviceNum,
                       InitOrder, V86Proc, PMProc
</PRE>
<P>Defines the name, device number, control procedure, and other attributes of a virtual device. Every virtual device must use the <B>Declare_Virtual_Device</B> macro. </P>
<UL><LI>     No return value. </LI></UL><P></P>
<P><I>Name</I> </P>
<P>Name of the virtual device. </P>
<P><I>MajorVer</I> </P>
<P>Value specifying the major version number for the virtual device. </P>
<P><I>MinorVer</I> </P>
<P>Value specifying the minor version number for the virtual device. </P>
<P><I>CtrlProc</I> </P>
<P>Name of the control procedure for the virtual device. The control procedure handles all system control messages sent to the virtual device. For most virtual devices, this parameter is the name of the procedure created by the <B>Begin_Control_Dispatch</B> macro. </P>
<P><I>DeviceNum</I> </P>
<P>Device identifier for the virtual device. If the virtual device replaces an existing virtual device, the device identifier must be be identical to the device identifier of the virtual device being replaced. Otherwise, the value must be Undefined_Device_ID or a value previously obtained from Microsoft. </P>
<P>Since Windows 95 supports name-based VxD services, it is no longer necessary to obtain a virtual device identifier from Microsoft. Instead, set the DeviceNum to Undefined_Device_ID and use name-based services to access your VxD. (Do not make up device numbers.) </P>
<P><I>InitOrder</I> </P>
<P>Value speifying the initialization order of the virtual device relative to other virtual devices. If you are replacing an existing virtual device, this value must be the same as that of the device you are replacing. If your device is not sensitive to initialization order, use Undefined_Init_Order. If your device needs to initialize at a particular time relative to another device, make the initialization order relative to the init order of that other device. When doing so, use a generous offset such as XX_Init_Order + 00040000h or XX_Init_Order – 0004000h, so as to allow room for additional devices to be inserted later. Do not use values like XX_Init_Order + 1 or XX_Init_Order – 1. Do not use VMM_Init_Order or Debug_Init_Order. </P>
<P><I>V86Proc</I> </P>
<P>Name of the V86-mode API procedure. This procedure processes any calls to the virtual device made by V86-mode applications running in a virtual machine. This parameter is optional. </P>
<P><I>PMProc</I> </P>
<P>Name of the protected-mode API procedure. This procedure processes any calls to the virtual device made by protected-mode applications running in a virtual machine. This parameter is optional. </P>
<P>See also <B>Begin_Control_Dispatch</B> </P>
<P></P>
<P></P></FONT></BODY></HTML>
