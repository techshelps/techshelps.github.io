<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WNetAddConnection</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>WNetAddConnection </H3><P>This function allows the caller to redirect (connect) a local device to a network resource. If successful, the connection will be made persistent. </P>
<P><BR></P>
<PRE>DWORD WNetAddConnection(
    LPTSTR lpRemoteName,
    LPTSTR lpPassword,
    LPTSTR lpLocalName
    );
</PRE>
<P><I>lpRemoteName</I> </P>
<P>Specifies the network resource to connect to. This is limited to MAX_PATH. </P>
<P><I>lpPassword</I> </P>
<P>Specifies the password to be used in making the connection. </P>
<P>The NULL value or string may be passed in to indicate that the caller wants the network to use the best password(s) it has available (such as no password, a default password, or an internally cached password). </P>
<P><I>lpLocalName</I> </P>
<P>This should contain the name of a local device to be redirected, such as "F:" or "LPT1". The string is treated in a case insensitive manner, and may be the empty string (or NULL) to indicate the connection to the network resource is to be made without a device redirection (i.e., deviceless connection). </P>
<UL><LI>     WN_SUCCESS if the call is successful. Other error codes include: </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>ERROR_BAD_DEV_TYPE </P></TD><TD VALIGN="TOP"><P>The device type and the resource type do not match. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_BAD_NETNAME </P></TD><TD VALIGN="TOP"><P><I>lpRemoteName</I> is not acceptable to any NP </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_BAD_LOCALNAME </P></TD><TD VALIGN="TOP"><P><I>lpLocalName</I> is invalid. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_BAD_PASSWORD </P></TD><TD VALIGN="TOP"><P>invalid password, or the the connection requires additional authentication not provided by the caller (e.g., a username) </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_ALREADY_CONNECTED </P></TD><TD VALIGN="TOP"><P><I>lpLocalName</I> is already connected to a network drive or is to a local drive that is already in use locally (e.g. is used for a hard drive or RAM drive). </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_ACCESS_DENIED </P></TD><TD VALIGN="TOP"><P>access denied (user may need to logon) </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NO_NETWORK </P></TD><TD VALIGN="TOP"><P>network is not present </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_CANNOT_OPEN_PROFILE </P></TD><TD VALIGN="TOP"><P>Unable to open the user profile to process persistent connections. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_BAD_PROFILE </P></TD><TD VALIGN="TOP"><P>The user profile is in an incorrect format. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_FUNCTION_BUSY </P></TD><TD VALIGN="TOP"><P>The MPR or NP is busy (possibly initializing). The caller should retry. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NO_NET_OR_BAD_PATH </P></TD><TD VALIGN="TOP"><P>the operation could not be handled either because a network component is not started or the specified name could not be handled. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_EXTENDED_ERROR </P></TD><TD VALIGN="TOP"><P>a network specific error occurred. <B>WNetGetLastError</B> should be called to obtain a description of the error. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P></P>
<P></P></FONT></BODY></HTML>
