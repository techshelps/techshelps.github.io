<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>EnumPrinters</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>EnumPrinters </H3><P><BR></P>
<PRE>BOOL EnumPrinters(
   DWORD   dwType,      /* printer type or types                   */
  LPTSTR  lpszName,    /* address of server name                  */
  DWORD   dwLevel,     /* structure level                         */
  LPBYTE  lpbPrinters, /* printer info array                      */
  DWORD   cbBuf,       /* number of bytes in printer info array   */
                       /* buffer provided by caller               */
  LPDWORD lpdwNeeded,  /* address of variable with count of bytes */
                       /* copied (or required)                    */
  LPDWORD lpdwReturned /* address of variable with count of job   */
                       /* info. structures copied                 */
);
</PRE>
<P>Enumerates the available printers on the specified server. </P>
<UL><LI>     If the function succeeds, the return value is <B>TRUE</B>; otherwise, it is <B>FALSE</B>. To get extended error information, use the <B>GetLastError</B> function. </LI></UL><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>dwType</I> </P></TD><TD VALIGN="TOP"><P>Specifies the type of printers that the function should enumerate. This value can be any combination of the following constants: </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="102pt" VALIGN="TOP"><COL WIDTH="102pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>PRINTER_ENUM_DEFAULT </P></TD><TD VALIGN="TOP"><P>Enumerates the default printer. </P></TD></TR><TR><TD VALIGN="TOP"><P>PRINTER_ENUM_LOCAL </P></TD><TD VALIGN="TOP"><P>Enumerates the locally installed printers. </P></TD></TR><TR><TD VALIGN="TOP"><P>PRINTER_ENUM_FAVORITE </P></TD><TD VALIGN="TOP"><P>Enumerates a list of favorite printers. This is essentially the list of printers that the user has made previous connections to. </P></TD></TR><TR><TD VALIGN="TOP"><P>PRINTER_ENUM_NAME </P></TD><TD VALIGN="TOP"><P>Enumerates the printer identified by <I>lpszName</I>. This could be a server <I>lpszName</I>, or a domain <I>lpszName</I>. If <I>lpszName</I> is NULL, available domains (that is, Network Print Providors) will be enumerated. </P></TD></TR><TR><TD VALIGN="TOP"><P>PRINTER_ENUM_REMOTE </P></TD><TD VALIGN="TOP"><P>Enumerates network printers. </P></TD></TR><TR><TD VALIGN="TOP"><P>PRINTER_ENUM_SHARED </P></TD><TD VALIGN="TOP"><P>Enumerates printers with the shared attribute. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpszName</I> </P></TD><TD VALIGN="TOP"><P>Points to a null-terminated string that specifies the name of the server for which to enumerate the printers. If this string is <B>NULL</B>, the local printers are enumerated. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>dwLevel</I> </P></TD><TD VALIGN="TOP"><P>Specifies the version of the structure to which <I>lpbPrinters</I> points. This value must be 1 or 2. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpbPrinters</I> </P></TD><TD VALIGN="TOP"><P>Points to an array of <B>PRINTER_INFO_1</B> or <B>PRINTER_INFO_2</B> structures. If <I>dwLevel</I> is 1, the array contains <B>PRINTER_INFO_1</B> structures; if <I>dwLevel</I> is 2, the array contains <B>PRINTER_INFO_2</B> structures. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>cbBuf</I> </P></TD><TD VALIGN="TOP"><P>Specifies the size, in bytes, of the array to which <I>lpbPrinters</I> points. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpdwNeeded</I> </P></TD><TD VALIGN="TOP"><P>Points to a value that specifies the number of bytes copied if the function succeeds or the number of bytes required if <I>cbBuf</I> is too small. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpdwReturned</I> </P></TD><TD VALIGN="TOP"><P>Points to a value that specifies the number of <B>PRINTER_INFO_1</B> or <B>PRINTER_INFO_2</B> structures that returned in the array to which the <I>lpbPrinters</I> parameter points. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>Network print providers are only required to support two of the <I>dwType</I> parameter values: PRINTER_ENUM_REMOTE and PRINTER_ENUM_NAME. </P>
<P>There are four possible dispositions for a server name passed to a provider's <B>EnumPrinters</B> function by the PRR: </P>
<P>    1    The name is not correctly formed. It is not a valid name on the provider's network. </P>
<P>    2    The name is valid, but the server cannot be found. </P>
<P>    3    The name is valid and the server exists, but it does not respond properly. </P>
<P>    4    The name is valid and the server responds as expected. </P>
<P></P>
<P>Cases 1 and 2 indicate that the specified server does not exist on the network. In these cases, the PRR expects providers to return <B>FALSE</B> and to set the last error code to the value <B>ERROR_INVALID_NAME</B>. </P>
<P>Case 3 represents a network error. The provider should return <B>FALSE</B> and call the <B>SetLastError</B> function to an appropriate Win32 error code. Once a network error has been encountered, the PRR will perform no further enumeration. </P>
<P>Case 4 indicates success. The provider should return <B>TRUE</B>. </P></FONT></BODY></HTML>
