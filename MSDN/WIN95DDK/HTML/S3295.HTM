<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Get_Next_Profile_String</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Get_Next_Profile_String </H3><P><BR></P>
<PRE>include vmm.inc

mov     edx, Profile    ; points to the previous entry value
mov     edi, Keyname    ; points to the keyname for the entry
VMMcall Get_Next_Profile_String

jc      no_next         ; carry flag set if no more entries
mov     [Next], edx     ; address of next profile string
</PRE>
<P>Searches the SYSTEM.INI file for the next entry with a given keyname following the specified entry. Virtual devices typically use this service if they have more than one entry with the same keyname. This service is available only during initialization. Uses EDX, Flags. </P>
<UL><LI>     Returns with the carry flag clear if an entry is found, set otherwise. If the carry flag is clear, the EDX register contains the address of the next string with the specified keyname. </LI></UL><P></P>
<P><I>Profile</I> </P>
<P>Address of a null-terminated string specifying the value of the previous entry. The string must have been previously returned using the <B>Get_Profile_String</B> or <B>Get_Next_Profile_String</B> service. </P>
<P><I>Keyname</I> </P>
<P>Points to a null-terminated string identifying the keyname for the entry. </P>
<P>A virtual device retrieves the first string using the <B>Get_Profile_String</B> service, then uses <B>Get_Next_Profile_String</B> to retrieve all subsequent entries. In all cases, the virtual device must not modify the returned string. </P>
<P>See also <B>Get_Profile_String</B> </P>
<P></P>
<P></P></FONT></BODY></HTML>
