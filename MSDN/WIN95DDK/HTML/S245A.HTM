<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the API Installation Method</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Using the API Installation Method </H3><P>Under Windows 3.1, the only way other than using the Control Panel to install a printer driver was for an application to modify WIN.INI directly. But under Windows 95, the printer subsystem does not get any information about an installed printer driver from WIN.INI. Windows 95 applications wishing to install their own printer driver should either: </P>
<UL><LI>     Call the necessary Win32 printing APIs (<B>AddPrinter</B>, <B>AddPrinterDriver</B>, <B>AddPrintProcessor</B>, <B>AddMonitor</B>, etc.), or </LI><LI>     Use the printer-specific INF file extensions provided by the Windows 95 printer installer utility. </LI><LI>     Launch the Add Printer Wizard using WinHelp. </LI></UL><P></P>
<P>The relative advantages and disadvantages of each method are summarized in the following table. </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="116pt" VALIGN="TOP"><COL WIDTH="116pt" VALIGN="TOP"><COL WIDTH="116pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Installation Method </B></P></TD><TD VALIGN="TOP"><P><B>Advantages </B></P></TD><TD VALIGN="TOP"><P><B>Disadvantage </B></P></TD></TR><TR><TD VALIGN="TOP"><P>Use Win32 APIs such as <B>AddPrintProcessor</B> or <B>AddMonitor</B>. </P></TD><TD VALIGN="TOP"><P>Offers flexibility, compared to the .INF file extension method. </P></TD><TD VALIGN="TOP"><P>Difficult to code and test, compared to the .INF file extension method. </P></TD></TR><TR><TD VALIGN="TOP"><P>Use printer-specific .INF file extensions. </P></TD><TD VALIGN="TOP"><P>Relatively inflexible. </P></TD><TD VALIGN="TOP"><P>Easy to code and test. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>This section describes how to use the Win32 APIs to install printer support. For information on how to use the printer-specific INF file extensions, see the section "Using the Printer-Specific Windows 95 INF File Extensions." </P>
<P>The topics of printer-specific INF file extensions and using Win32 APIs in a DLL to install printer support are not completely independent. If you decide to develop a DLL to install some level of printer support, you will have to name the DLL in either a VendorSetup or VendorInstaller statement in an INF file in order for your DLL to be known by the Windows 95 printer installer. The VendorSetup and VendorInstaller printer-specific INF file extensions are described in the section "Printer-Specific INF File Extensions Reference." </P></FONT></BODY></HTML>
