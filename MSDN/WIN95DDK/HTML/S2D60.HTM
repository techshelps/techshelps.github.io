<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WNetGetUser</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>WNetGetUser </H3><P>This is used to determine either the current default username, or the user identification used to establish a network connection. </P>
<P><BR></P>
<PRE>DWORD WNetGetUser(
    LPTSTR lpName,
    LPTSTR lpUserID,
    LPDWORD lpBufferSize
    );
</PRE>
<P><I>lpName</I> </P>
<P>Contains the name of the local device the caller is interested in, or the name of a remote network resource that the user has made a connection to, or the name of a network provider, or NULL or the empty string if the caller is interested in the name of the user currently logged on to the system. </P>
<P><I>lpUserID</I> </P>
<P>Points to a buffer to receive the user profile name. This is an identification string that the user made to establish the connection (for example, a user name, or group name). </P>
<P>If the name passed in is a network provider and the network does not have a network wide logon, then an empty string is returned. </P>
<P>If a network resource name is passed in, and the user is connected to that resource using different names, it is possible that a NP cannot resolve which user profile name to return. In this case the NP may make an arbitrary choice amongst the possible usernames. </P>
<P><I>lpBufferSize</I> </P>
<P>This is used to specify the size of the buffer passed in. If the call fails because the buffer is not big enough, this location is used to return the required buffer size. </P>
<UL><LI>     WN_SUCCESS if the call is successful. Other error codes include: </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>WN_NOT_LOGGED_ON </P></TD><TD VALIGN="TOP"><P>the user is not logged on to the system (<I>lpName</I> empty) or network (<I>lpName</I> a valid provider name). </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NOT_CONNECTED </P></TD><TD VALIGN="TOP"><P><I>lpName</I> not a redirected device nor a connected network name. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NOT_SUPPORTED </P></TD><TD VALIGN="TOP"><P><I>lpName</I> is the name of a network that does not support network wide logon. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_MORE_DATA </P></TD><TD VALIGN="TOP"><P>the buffer is too small </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_FUNCTION_BUSY </P></TD><TD VALIGN="TOP"><P>The MPR or NP is busy (possibly initializing). The caller should retry. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NO_NETWORK </P></TD><TD VALIGN="TOP"><P>network is not present. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_EXTENDED_ERROR </P></TD><TD VALIGN="TOP"><P>a network specific error occurred. <B>WNetGetLastError</B> should be called to obtain a description of the error. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P></P>
<P></P></FONT></BODY></HTML>
