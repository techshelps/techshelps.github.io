<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetupCommand</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>SetupCommand </H3><P>This command is sent before every send and before every answer (after the reset command). </P>
<P>Use a single command string. For example, </P>
<P><BR></P>
<PRE>HKR, Fax, SetupCommand,, "ATS7=255&amp;D3&amp;K4"

</PRE>
<P>The command should configure the modem as follows: </P>
<UL><LI>     Max dial-tone timeout </LI><LI>     Tie DTR drop to reset </LI><LI>     Xon/Xoff flow control </LI></UL><P></P>
<P>Windows 95 and NT-SUR fax software require software (Xon/Xoff) flow control. The software uses the following algorithm to determine the command to be used for flow control: first it tries "AT&amp;K4". It </P>
<P>then (even if the modem returned OK to AT&amp;K4) tries "AT\Q1", and if that worked, it tries "ATJ0'. If no commands worked so far, it tries "AT&amp;K5". Using this algorithm results in one of the following flow control commands: "AT&amp;K4", "AT&amp;K4\Q1", "AT&amp;K4\Q1\J0", "AT\Q1", "AT\Q1\J0", or "AT&amp;K5". </P>
<P>This algorithm works is a vast majority of cases. Two known exceptions are US Robotics(r) and certain Hayes(r) modems. These are special-cased in the fax driver (but could equally easily have been taken care of via the INF file). </P>
<P>See also Protocol and Port Settings </P>
<P></P>
<P></P></FONT></BODY></HTML>
