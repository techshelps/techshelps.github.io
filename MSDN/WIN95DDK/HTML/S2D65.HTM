<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DISCDLGSTRUCT Structure</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>DISCDLGSTRUCT Structure </H3><P><BR></P>
<PRE>typedef struct _DISCDLGSTRUCT{
    DWORD cbStructure;
    HWND hwndOwner;
    LPSTR lpLocalName;
    LPSTR lpRemoteName;
    DWORD dwFlags;
} DISCDLGSTRUCT, *LPDISCDLGSTRUCT;
</PRE>
<P><I>cbStructure</I> </P>
<P>The size of the <B>DISCDLGSTRUCT </B>structure in bytes. This is filled in by the caller to indicate the size of the structure passed in. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>hwndOwner</I> </P></TD><TD VALIGN="TOP"><P>This specifies the HWND of the owning window. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpRemoteName</I> </P></TD><TD VALIGN="TOP"><P>Specifies the network resource to disconnect. This field may be set to NULL is <I>lpLocalName</I> is specified in which case the connection to the resource redirected from <I>lpLocalName </I>is disconnected. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpLocalName</I> </P></TD><TD VALIGN="TOP"><P>The local device name that is redirected to the network resource, such as "F:" or "LPT1". </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>dwFlags</I> </P>
<P>Any combination of the following values: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>DISC_UPDATE_PROFILE </P></TD><TD VALIGN="TOP"><P>If set, the connection will no longer be persistent (automatically restored every time the user logs on to the network). This flag is only valid if <I>lpLocalName</I> specifies a local device. </P></TD></TR><TR><TD VALIGN="TOP"><P>DISC_NO_FORCE </P></TD><TD VALIGN="TOP"><P>If not set, force will be applied when attempting the disconnect if this is required (typically because the user has open files). The user will be informed if there are open files to the connection and asked if he still wants to disconnect. If so, the disconnect will be reattempted with additional force. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<UL><LI>     WN_SUCCESS if the connection is successfully disconnected. Other error codes include the following. </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>WN_CANCEL </P></TD><TD VALIGN="TOP"><P>the user was asked if he really wanted to disconnect and elected not to disconnect. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_OPEN_FILES </P></TD><TD VALIGN="TOP"><P>unable to disconnect because the user is actively using the connection. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_FUNCTION_BUSY </P></TD><TD VALIGN="TOP"><P>The MPR or NP is busy (possibly initializing). The caller should retry. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NO_NETWORK </P></TD><TD VALIGN="TOP"><P>network is not present. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_OUT_OF_MEMORY </P></TD><TD VALIGN="TOP"><P>insufficient memory to bring up the dialog. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_EXTENDED_ERROR </P></TD><TD VALIGN="TOP"><P>a network specific error occurred. <B>WNetGetLastError</B> should be called to obtain a description of the error. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P></P>
<P></P></FONT></BODY></HTML>
