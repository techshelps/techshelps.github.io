<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DrvSetPrinterData</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>DrvSetPrinterData </H3><P><BR></P>
<PRE>DWORD DrvSetPrinterData(LPSTR lpPrinter, LPSTR lpProfile, 
    DWORD lpType, LPBYTE lpPrinterData, DWORD dwSize)
</PRE>
<P>Enables a printer driver to store data in the registry. The data can be stored under a unique key to be retrieved later. Typically used to store data from the extended <B>DEVMODE</B> structure in the registry. </P>
<UL><LI>     Returns ERROR_SUCCESS, if successful; otherwise, returns one of the following error codes: ERROR_INVALID_PARAMETER, ERROR_INVALID_PRINTER_NAME, ERROR_MORE_DATA, or ERROR_INVALID_DATA (for the meaning of these error codes, see the winerror.h documentation). </LI></UL><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>lpPrinter</I> </P></TD><TD VALIGN="TOP"><P>Friendly name that identifies the printer device. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpProfile</I> </P></TD><TD VALIGN="TOP"><P>Name of profile under which to save data. Note that setting this parameter to INT_PD_DEFAULT_DEVMODE (which is defined in PRINT.H), the default DEVMODE is used. Private profile data can be used by passing the <I>lpProfile</I> parameter from <B>ExtDeviceMode</B> (it is non-NULL) as this parameter. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpType</I> </P></TD><TD VALIGN="TOP"><P>Type of data being stored. Use REG_BINARY for binary data (see the Win32 SDK for other registry data type descriptions). </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpPrinterData</I> </P></TD><TD VALIGN="TOP"><P>Far pointer to location of data to be saved. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>dwSize</I> </P></TD><TD VALIGN="TOP"><P>Buffer size at the location pointed to by the <I>lpPrinterData</I> parameter. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>Printer drivers are strongly encouraged to use this functionality to store all printer driver settings and to avoid using INI files wherever possible. </P>
<P>Printer drivers may obtain the model name of the device, typically required by the device driver, by calling the <B>DrvGetPrinterData</B> function with the <I>lpProfile</I> parameter set to INT_PD_DEFAULT_MODEL. </P>
<P>If the data has the REG_SZ, REG_MULTI_SZ, or REG_EXPAND_SZ types, then the size of the data returned to the location pointed to by the <I>lpPrinterData</I> parameter will include the terminating NULL character. </P></FONT></BODY></HTML>
