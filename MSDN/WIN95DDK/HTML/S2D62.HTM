<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WNetConnectionDialog1</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>WNetConnectionDialog1 </H3><P>This function brings up a general browsing dialog for connecting to network resources. </P>
<P><BR></P>
<PRE>DWORD WNetConnectionDialog1 (
    LPCONNECTDLGSTRUCT lpConnectDlgStruct
    );

typedef struct { 
    DWORD cbStructure;
    HWND hwndOwner;
    LPNETRESOURCE lpConnRes;
    DWORD dwFlags;
    DWORD dwDevNum;
} CONNECTDLGSTRUCT, FAR *LPCONNECTDLGSTRUCT;
</PRE>
<P><I>cbStructure</I> </P>
<P>Contains the size of this structure in bytes. </P>
<P><I>hwndOwner</I> </P>
<P>This specifies the HWND of the owning window. </P>
<P><I>lpConnRes</I> </P>
<P>A <B>NETRESOURCE</B> structure. If <I>lpConnRes.lpRemoteName</I> is specified, this field will be entered into the path field of the dialog. All other fields must be set to NULL except <I>lpConnRes.dwType </I>which specifies the type of resources of interest, and must be one of: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>RESOURCETYPE_DISK </P></TD><TD VALIGN="TOP"><P>Connect to disk resources. </P></TD></TR><TR><TD VALIGN="TOP"><P>RESOURCETYPE_PRINT </P></TD><TD VALIGN="TOP"><P>Connect to print resources. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>dwFlags</I> </P>
<P>Specifies variations in the dialog display. To simulate <B>WNetConnectionDialog</B>, set this to CONNDLG_USE_MRU. Currently, this may be one of: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>CONNDLG_RO_PATH </P></TD><TD VALIGN="TOP"><P>Instead of allowing user to type in flag, have a read only path already inserted. This flag should only be set if <I>lpConnRes.lpRemoteName</I> is not NULL (or an empty string), and CONNDLG_USE_MRU is not set. </P></TD></TR><TR><TD VALIGN="TOP"><P>CONNDLG_CONN_POINT </P></TD><TD VALIGN="TOP"><P>Internal flag. Do not use. </P></TD></TR><TR><TD VALIGN="TOP"><P>CONNDLG_USE_MRU </P></TD><TD VALIGN="TOP"><P>Fill up the combobox, listing most recently used paths. </P></TD></TR><TR><TD VALIGN="TOP"><P>CONNDLG_HIDE_BOX </P></TD><TD VALIGN="TOP"><P>Show the checkbox allowing the user to select whether or not the connection should be restored at logon. </P></TD></TR><TR><TD VALIGN="TOP"><P>CONNDLG_PERSIST </P></TD><TD VALIGN="TOP"><P>Set if the connection is to be restored at logon. </P></TD></TR><TR><TD VALIGN="TOP"><P>CONNDLG_NOT_PERSIST </P></TD><TD VALIGN="TOP"><P>Set if the connection is not to be restored at logon. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>dwDevNum</I> </P>
<P>If call is successful, this returns the number of the device connected to. </P>
<P>If neither CONNDLG_RO_PATH or CONNDLG_USE_MRU is set in <I>dwFlags</I>, then the request defaults to CONNDLG_RO_PATH if <I>lpConnRes.lpRemoteName</I> does not specify a remote path and to CONNDLG_USE_MRU otherwise. CONNDLG_PERSIST and CONNDLG_NOT_PERSIST cannot both be set. If neither is set, then the dialog defaults to the last option that was selected on this dialog for the particular type of device being connected. </P>
<UL><LI>     WN_SUCCESS if the call is successful in bringing up the dialog. Other error codes include the following. Typically this dialog will only return an error if the dialog could not be brought up since errors that occur thereafter are reported to the user directly. If the call is sucessful, <I>dwDevNum</I> will contain the number of the device connected to. </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>WN_BAD_VALUE </P></TD><TD VALIGN="TOP"><P>one of the following: CONNDLG_RO_PATH is set and either CONNDLG_USE_MRU is set or <I>lpConnRes.lpRemoteName</I> does not point to a remote name; both CONNDLG_PERSIST and CONNDLG_NOT_PERSIST are set. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_BAD_DEV_TYPE </P></TD><TD VALIGN="TOP"><P><I>lpConnRes.dwType </I>is not set to either RESOURCETYPE_DISK or RESOURCETYPE_PRINT. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_FUNCTION_BUSY </P></TD><TD VALIGN="TOP"><P>The MPR or NP is busy (possibly initializing). The caller should retry. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NO_NETWORK </P></TD><TD VALIGN="TOP"><P>network is not present. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_OUT_OF_MEMORY </P></TD><TD VALIGN="TOP"><P>insufficient memory to bring up the dialog. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_EXTENDED_ERROR </P></TD><TD VALIGN="TOP"><P>a network specific error occurred. <B>WNetGetLastError</B> should be called to obtain a description of the error. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P>See also <B>NETRESOURCE</B> </P>
<P></P>
<P></P></FONT></BODY></HTML>
