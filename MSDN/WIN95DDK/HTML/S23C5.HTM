<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Ini File to Registry Sections</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Ini File to Registry Sections </H3><P><BR></P>
<PRE>[&lt;ini-to-registry-section&gt;]
&lt;ini-file&gt;, &lt;ini-section&gt;, [&lt;ini-key&gt;], &lt;reg-root-string&gt;, &lt;subkey&gt;[,&lt;flags&gt;]
    .
    .
    .
</PRE>
<P>Moves lines or sections from an INI file to the registry, creating or replacing a registry entry under the given key in the registry. The section name <I>ini-to-registry-section</I> must appear in an <B>Ini2Reg</B> item in an Install section of the INF file. </P>
<P><I>ini-file</I> </P>
<P>Name of the INI file containing the key to copy. For more information about specifying the INI filename, see the comments in the Reference topic about the Update Ini File Section. </P>
<P><I>ini-section</I> </P>
<P>Name of the section in the INI file containing the key to copy. </P>
<P><I>ini-key</I> </P>
<P>Name of the key in the INI file to copy to the registry. If <I>ini-key</I> is empty the whole section is transferred to the specified registry key. </P>
<P><I>reg-root-string</I> </P>
<P>Registry root name. Can be one of these values: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>HKCR </P></TD><TD VALIGN="TOP"><P>Same as HKEY_CLASSES_ROOT </P></TD></TR><TR><TD VALIGN="TOP"><P>HKCU </P></TD><TD VALIGN="TOP"><P>Same as HKEY_CURRENT_USER </P></TD></TR><TR><TD VALIGN="TOP"><P>HKLM </P></TD><TD VALIGN="TOP"><P>Same as HKEY_LOCAL_MACHINE </P></TD></TR><TR><TD VALIGN="TOP"><P>HKU </P></TD><TD VALIGN="TOP"><P>Same as HKEY_USERS. </P></TD></TR><TR><TD VALIGN="TOP"><P>HKR </P></TD><TD VALIGN="TOP"><P>Means relative from the Key passed into <B>GenInstallEx</B> </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>subkey</I> </P>
<P>Identifies the subkey to receive the value. Has the form <I>key1\key2\key3</I>... </P>
<P><I>flags</I> </P>
<P>Indicates whether to delete the INI key after transfer to the registry and whether to overwrite the value in the registry if the registry key already exists. Can be one of these values: </P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="180pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Bit </P></TD><TD VALIGN="TOP"><P>Value </P></TD><TD VALIGN="TOP"><P>Meaning </P></TD></TR><TR><TD VALIGN="TOP"><P>0 </P></TD><TD VALIGN="TOP"><P>0 </P></TD><TD VALIGN="TOP"><P>(Default) Do not delete the INI entry from the INI file after moving the information in the entry to the registry. </P></TD></TR><TR><TD VALIGN="TOP"><P>0 </P></TD><TD VALIGN="TOP"><P>1 </P></TD><TD VALIGN="TOP"><P>Delete the INI entry from the INI file after moving the information in the entry to the registry. </P></TD></TR><TR><TD VALIGN="TOP"><P>1 </P></TD><TD VALIGN="TOP"><P>0 </P></TD><TD VALIGN="TOP"><P>(Default) If the registry subkey already exists, do not replace its current value. </P></TD></TR><TR><TD VALIGN="TOP"><P>1 </P></TD><TD VALIGN="TOP"><P>1 </P></TD><TD VALIGN="TOP"><P>If the registry subkey already exists, replace its current value with the value from the INI file entry. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>For example, suppose the following entry exists in the WIN.INI file: </P>
<P><BR></P>
<PRE>[Windows]
CursorBlinkRate=15
</PRE>
<P>If a CursorBlinkRate subkey does not exist under the Control Panel\Desktop, then the following item in an <B>Ini File to Registry</B> section creates the subkey, sets the value of the subkey to 15, and leaves the original line in WIN.INI unchanged: </P>
<P><BR></P>
<PRE>win.ini,Windows,CursorBlinkRate,HKCU,"Control Panel\Desktop"
</PRE>
<P>If the subkey already exists, the INF file item sets the value of the subkey to 15, and leaves the original line in WIN.INI unchanged. </P>

<P></P>
<P></P></FONT></BODY></HTML>
