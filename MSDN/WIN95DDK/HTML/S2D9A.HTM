<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NPCancelConnection</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>NPCancelConnection </H3><P>Breaks a network connection. </P>
<P><BR></P>
<PRE>DWORD NPCancelConnection(
  LPTSTR lpName,
  BOOL fForce
  DWORD dwFlags
  );
</PRE>
<P><I>lpName</I> </P>
<P>The name of either the redirected local device or the remote network resource to disconnect from. In the former case, only the redirection specified is broken. In the latter case, only the deviceless connection to the remote network resource is broken. </P>
<P><I>fForce</I> </P>
<P>Used to indicate if the disconnect should be done forcefully in the event of open files or jobs on the connection. If FALSE is specified, the call will fail if there are open files or jobs. If set, CONNECT_REFCOUNT will not be set. </P>
<P><I>dwFlags</I> </P>
<P>Additional information about the connection. Currently has the following bit value: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>CONNECT_REFCOUNT </P></TD><TD VALIGN="TOP"><P>The connection has a reference count on the session and, if set, the caller is requesting that the reference count be decremented. Otherwise the caller is requesting that the session be removed entirely for all users. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<UL><LI>     WN_SUCCESS if the call is successful. Otherwise, an error code is returned, which may include: </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>WN_NOT_CONNECTED </P></TD><TD VALIGN="TOP"><P><I>lpName</I> not a redirected device, or not currently connected to <I>lpName</I>. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_OPEN_FILES </P></TD><TD VALIGN="TOP"><P>There are open files, and <I>fForce</I> was FALSE. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P></FONT></BODY></HTML>
