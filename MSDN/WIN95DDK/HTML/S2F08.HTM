<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Local Port Monitor Design and Implementation Notes</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H2>Local Port Monitor Design and Implementation Notes </H2><P>A local port monitor isolates the spooler from printer port characteristics by presenting idealized printer ports to the spooler. The local port monitor supplied by Microsoft is the spooler system component that monitors the flow of print job data through physical parallel or serial ports. The local print monitor presents idealized ports to the spooler by masking the difference between parallel and serial ports, serializing I/O, and providing automatic buffering services. The local port monitor can also be used to multiplex one physical port to multiple virtual ports, each having a separate name and behavior. </P>
<P>A Windows 95 port monitor must offer half a dozen entry points to monitor printers connected to ports and send print job data through ports. The local monitor's <B>OpenPort</B> function is called at spooler startup for all ports with assigned printers and, if necessary, when another printer is added to the spooler's environment. The <B>ClosePort</B> function is called at spooler shutdown and may be called when a printer is removed form the spooler's environment. The <B>ReadPort</B> function is called to read status information from connected bi-directional printers. </P>
<P>The <B>StartDocPort</B> function is called to setup the port to send print job data to the printer, a sequence of one or more <B>WritePort</B> function calls provide the print job data the port monitor sends to the printer, and an <B>EndDocPort</B> function call is called when there is no more data to send for the print job. </P>
<P>The local port monitor must also provide four entry points that perform port management. The <B>AddPort</B> function is called when the spooler wants to add a port to its environment and the <B>DeletePort</B> function is called when the spooler wants to remove a port from its environment. The spooler calls the <B>ConfigurePort</B> function to configure a port and may offer a user interface to get some of the necessary configuration information. The spooler calls the <B>EnumPorts</B> function to get a list of ports currently maintained by the port monitor. </P></FONT></BODY></HTML>
