<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>About Refresh Rate Support</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H2>About Refresh Rate Support </H2><P>When called to set the video mode in <B>Enable</B>, <B>ReEnable</B>, etc., display drivers written for Windows&reg; 95 should set the refresh rate based on the current monitor selected in the Display control panel. The sample XGA driver source code in the Device Driver Kit (DDK) demonstrates how to do this. </P>
<P>When refresh rate support is enabled for a driver, the virtual display device (VDD) provides the following information about the current monitor in the <B>DISPLAYINFO</B> structure (defined in MINIVDD.INC) returned by <B>VDD_GetDisplayInfo</B>: </P>
<P>    1.     Pre-calculated maximum vertical refresh rate: If there is a VESA DDC EDID monitor identifier for the current monitor in the registry, the VDD returns the highest standard refresh rate supported for the current resolution. Otherwise, it calculates an estimated maximum refresh rate for the current resolution using the frequency ranges in the software registry key for the current monitor. </P>
<P>    2.     Horizontal and vertical frequency ranges: When the user selects the monitor type in the Display control panel, these ranges are written to the software registry key by the monitor INF file. If a monitor supports multiple timing ranges, the VDD returns the optimal range for the current resolution. </P>
<P>    3.     VESA DDC EDID structure: If Windows 95 is configured to detect VESA DDC monitors, and a DDC monitor is detected, its 128-byte <B>EDID</B> structure is stored in the monitor's hardware registry key. The <B>DISPLAYINFO</B> structure returned by the VDD contains a handle for the current monitor that can be passed to the registry API to return the <B>EDID</B> structure. For more information, see the section <I>Reading the EDID for the Current Monitor</I> below. </P>
<P></P>
<P>The most simple display driver would set the refresh rate based on the pre-computed refresh rate value returned for #1 above. Depending on the video BIOS services available to it, a more sophisticated driver might use the horizontal and vertical ranges specified by #2. An even more optimized driver can read the <B>EDID</B> data directly from the registry, using the handle returned in the <B>DISPLAYINFO</B> structure, and optimize display timings based on it. </P></FONT></BODY></HTML>
