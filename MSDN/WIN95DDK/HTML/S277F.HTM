<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>VCOMM_PM_API_EnableNotify</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>VCOMM_PM_API_EnableNotify </H3><P><BR></P>
<PRE>include vcomm.inc

mov     ebx, hPort
mov     di, Selector                   ;segment address of notification
shl     edi, 16                        ;  function in high word of EDI
mov     di, OFFSET CommNotifyProc      ;  and offset address in low word
mov     cx, hwnd                       ;reference data (window handle)
mov     dx, recvt
mov     si, sendt
mov     ax, VCOMM_PM_API_EnableNotify  ;function number
call    [_VCOMMCallAddr]
</PRE>
<P>Calls the <B>_VCOMM_EnableCommNotification</B> service. </P>
<UL><LI>     Returns zero in AX if successful, or an error value otherwise. </LI></UL><P></P>
<P><I>hPort</I> </P>
<P>Communications resource handle. </P>
<P><I>CommNotifyProc</I> </P>
<P>Address of a notification function in the VM. For more information, see <B>CommNotifyProc</B>. </P>
<P><I>hwnd</I> </P>
<P>Reference data that is passed to the notification function. COMM.DRV specifies the handle of the window to receive notification messages. </P>
<P><I>recvt</I> </P>
<P>Receive-queue notification threshold. </P>
<P><I>sendt</I> </P>
<P>Transmit-queue notification threshold. </P>
<P>Because the notification function is in a VM, VCOMM does not pass its address to the port driver. Instead, it passes the address of an internal function. When the port driver calls the internal function, it schedules an event and the event handler uses the nested execution mechanism to call the notification function. </P>
<P>See also <B>CommNotifyProc</B>, <B>_VCOMM_EnableCommNotification</B> </P>
<P></P>
<P></P></FONT></BODY></HTML>
