<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ScsiPortGetUncachedExtension</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>ScsiPortGetUncachedExtension </H3><P><BR></P>
<PRE>PVOID ScsiPortGetUncachedExtension(HwDeviceExtension, ConfigInfo, NumberOfBytes)
IN PVOID  HwDeviceExtension;
IN PPORT_CONFIGURATION_INFORMATION  ConfigInfo;
IN ULONG  NumberOfBytes;
</PRE>
<P>Allocates memory that can be used by both the CPU and host bus adapter for DMA or shared data. </P>
<UL><LI>     Returns an address for the uncached extension. If the memory cannot be allocated, NULL is returned. </LI></UL><P></P>
<P><I>HwDeviceExtension</I> </P>
<P>Points to the miniport driver's storage for per-adapter data. </P>
<P><I>ConfigInfo</I> </P>
<P>Specifies information about the adapter's DMA capabilities. The following members must be filled-in: <B>DmaChannel</B> or <B>DmaPort</B>, <B>DmaWidth</B>, <B>DmaSpeed</B>, <B>MaximumLength</B>, <B>ScatterGather</B>, <B>Master</B>, <B>NumberOfPageBreaks</B>, <B>AdapterInterfaceType</B>, <B>Dma32BitAddresses</B>, <B>SystemIoBusNumber</B>, and <B>AutoRequestSense</B>. </P>
<P>Members that are not pertinent to the HBA, such as <B>DmaChannel</B> for an EISA master adapter, must be left alone. </P>
<P><I>NumberOfBytes</I> </P>
<P>Indicates the size, in bytes, of the uncached extension to be allocated. </P>
<P>This function can be called only from HBA miniport driver's <B>HwFindAdapter</B> routine. Calls to <B>ScsiPortGetUncachedExtension</B> from other miniport driver functions will result in either a system failure or an incorrect operation. </P>
<P>Because new machines have caches and large memories, any memory shared between the host bus adapter and the CPU must be specially allocated. Mailboxes or I/O request queues in system memory are examples of this shared memory. </P>
<P>The allocation of memory can be done only once per HBA. </P>
<P>Use <B>ScsiPortGetPhysicalAddress</B> to find the physical address of the uncached extension. </P>
<P>See also <B>PORT_CONFIGURATION_INFORMATION</B>, <B>HwFindAdapter</B>, <B>ScsiPortGetPhysicalAddress</B> </P>
<P></P>
<P></P></FONT></BODY></HTML>
