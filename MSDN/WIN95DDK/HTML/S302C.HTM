<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DCB_COMMON</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>DCB_COMMON </H3><P><BR></P>
<PRE>#include &lt;dcb.h&gt;

typedef struct  _DCB_COMMON { 
    ULONG  DCB_physical_dcb;        // DCB for physical device 
    ULONG  DCB_expansion_length;    // expansion length; see below
    PVOID  DCB_ptr_cd;              // address of calldown list 
    ULONG  DCB_next_dcb;            // link to next DCB 
    ULONG  DCB_next_logical_dcb;    // address of next logical dcb
    BYTE   DCB_drive_lttr_equiv;    // drive number; see below
    BYTE   DCB_unit_number;         // drive or unit #; see below 
    USHORT DCB_TSD_Flags;           // TSD flags; see below

// Volume Tracking
    ULONG  DCB_vrp_ptr;             // address of VRP for this DCB 
    ULONG  DCB_dmd_flags;           // demand bits; see below
    ULONG  DCB_device_flags;        // general purpose flags; see below
    ULONG  DCB_device_flags2;       // general purpose flags; see below
    ULONG  DCB_Partition_Start;     // partition start sector 
    ULONG  DCB_track_table_ptr;     // address of track table buffer 
                                    //  for ioctls 
    ULONG  DCB_bds_ptr;             // DOS BDS corresp. to this DCB 
                                    //  (logical DCB's only)  
    ULONG  DCB_Reserved1;           // reserved; must be zero
    ULONG  DCB_Reserved2;           // reserved; must be zero
    BYTE   DCB_apparent_blk_shift;  // log of apparent_blk_size 
    BYTE   DCB_partition_type;      // partition type 
    USHORT DCB_sig;                 // padding and signature 
    BYTE   DCB_device_type;         // device type; see below
    ULONG  DCB_Exclusive_VM;        // exclusive access handle
    UCHAR  DCB_disk_bpb_flags;      // BPB flags; see below 
    UCHAR  DCB_cAssoc;              // # of assoc. logical drives 
    UCHAR  DCB_Sstor_Host;          // indicates a sstor host volume 
    USHORT DCB_user_drvlet;         // userdriveletter settings or 0xff
    USHORT DCB_Reserved3;           // reserved; must be zero
    ULONG  DCB_Reserved4;           // reserved; must be zero
} DCB_COMMON, *PDCB_COMMON;
</PRE>
<P>Contains device control block information that is common to logical and physical devices. </P>
<P><B>DCB_expansion_length</B> </P>
<P>Total length of IOP extension as filled in by the IOS. This excludes the size of the IOP size. </P>
<P><B>DCB_drive_lttr_equiv</B> </P>
<P>Drive number. Can be 0 for A, 1 for B, and so on. Set up during logical device associate processing. </P>
<P><B>DCB_unit_number</B> </P>
<P>Either physical drive number (sequential drive number with high bit set) or unit number within TSD. May be set up for disk physical, disk logical DCB, or CD-ROM physical DCBs. </P>
<P><B>DCB_TSD_Flags</B> </P>
<P>Flags for the TSD. Can be a combination of these values: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>DCB_TSD_INVALID_PARTITION </P></TD><TD VALIGN="TOP"><P>Don't trust the BPB. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_TSD_BAD_MBR </P></TD><TD VALIGN="TOP"><P>Bad master boot record; physical device only. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_TSD_USER_LETTERS_CHECKED </P></TD><TD VALIGN="TOP"><P>User drive letters checked. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_TSD_FIRST_USER_CHECK </P></TD><TD VALIGN="TOP"><P>User drive letters checked first time. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_TSD_BID_SET_GEOM </P></TD><TD VALIGN="TOP"><P>All geometry set by BID. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_TSD_USER_SET </P></TD><TD VALIGN="TOP"><P>User set the a drive letter range. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_TSD_NO_USER_INT13 </P></TD><TD VALIGN="TOP"><P>User INT 13h disabled. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_TSD_PROTMODE_INT_13 </P></TD><TD VALIGN="TOP"><P>Proteceted-mode only INT 13h. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_TSD_MBPB_PBR </P></TD><TD VALIGN="TOP"><P>Recommend BPB set from PBR by TSD from INT 41h or INT 46h. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_TSD_RBPB_INIT </P></TD><TD VALIGN="TOP"><P>Recommend BPB initialized by TSD. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_TSD_MBPB_INIT </P></TD><TD VALIGN="TOP"><P>Media BPB initialized by TSD. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_TSD_APPARENT_PBR </P></TD><TD VALIGN="TOP"><P>Apparent set from primary PBR by TSD. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_TSD_APPARENT_ROM </P></TD><TD VALIGN="TOP"><P>Apparent set from ROM data by TSD. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_TSD_ACTUAL_SET </P></TD><TD VALIGN="TOP"><P>Actual set from apparent by TSD. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_TSD_ACTUAL_PRE_SET </P></TD><TD VALIGN="TOP"><P>Actual geometry set prior to TSD. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_TSD_APPARENT_PRE_SET </P></TD><TD VALIGN="TOP"><P>Apparent geometry set prior to TSD. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><B>DCB_dmd_flags</B> </P>
<P>Demand flags for the topmost layer. Can be a combination of these values: </P>
<P><B>DCB_device_flags</B> </P>
<P>General purpose flags. Can be a combination of these values: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>DCB_DEV_SPINDOWN_SUPPORTED </P></TD><TD VALIGN="TOP"><P>Indicates drive supports spindown command. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_SPUN_DOWN </P></TD><TD VALIGN="TOP"><P>Indicates drive is currently spun down. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_IO_ACTIVE </P></TD><TD VALIGN="TOP"><P>Port driver use only. Indicates I/O has been received for this DCB. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_INT13_CONFIGURED </P></TD><TD VALIGN="TOP"><P>This device has been configured as an INT 13h drive. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_NO_ASPICAM </P></TD><TD VALIGN="TOP"><P>This DCB cannot handle ASPI or CAM requests. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_REMOVAL_PENDING </P></TD><TD VALIGN="TOP"><P>Device is going away soon. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_RMM_INT13 </P></TD><TD VALIGN="TOP"><P>Logical drives for this INT 13h device are controlled by the mapper. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_TSD_PROCESSED </P></TD><TD VALIGN="TOP"><P>Device has been processed by a TSD. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_SINGLE_FLOPPY </P></TD><TD VALIGN="TOP"><P>Equivalent to IRS_DRV_SINGLE_FLOPPY. Indicates that the dmd_a_b_toggling is not set in the floppy DCB. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_REAL_MODE </P></TD><TD VALIGN="TOP"><P>Device must be controlled by a real mode driver, and should not be taken over in protected mode. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_QUE_DESCEND </P></TD><TD VALIGN="TOP"><P>Current queuing direction is descending. Used by port drivers or IOS if DCB_SERIAL_CMD flag is set. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_MEDIA_CHANGED </P></TD><TD VALIGN="TOP"><P>Hardware indicated media change. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_INVALID_GEOM </P></TD><TD VALIGN="TOP"><P>Indicates the disk geometry has become invalid. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_INHIBIT_SW_TIMED_SUPPORT </P></TD><TD VALIGN="TOP"><P>Inhibits the volume tracking layer from carrying out the 2 second timing actions for media change. This bit is typically set if DCB_DEV_SYNC_MED_CHG_SUPPORT is set. Drive is in read only mode. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_ASYNC_MED_CHG_SUPPORT </P></TD><TD VALIGN="TOP"><P>Drive has hardware support to indicate by interrupt that disk door has been opened. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_SYNC_MED_CHG_SUPPORT </P></TD><TD VALIGN="TOP"><P>Drive has hardware support to indicate media change; first access of the drive after a media changed returns an error. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_PHYSICAL </P></TD><TD VALIGN="TOP"><P>Physical device. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_LOGICAL </P></TD><TD VALIGN="TOP"><P>Logical device. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_RMM </P></TD><TD VALIGN="TOP"><P>Real mode mapper DCB. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_UNCERTAIN_MEDIA </P></TD><TD VALIGN="TOP"><P>Media may have been changed. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_ROM_CFG_REQ </P></TD><TD VALIGN="TOP"><P>TSD must use ROM chain data. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_MUST_CONFIGURE </P></TD><TD VALIGN="TOP"><P>Set at create DCB time and cleared after all layer drivers receive the AEP_CONFIG_DCB function for this DCB. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_SSTOR_VOL </P></TD><TD VALIGN="TOP"><P>Set if this is SSTOR volume. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_PAGING_DEVICE </P></TD><TD VALIGN="TOP"><P>Indicates that the paging drive is on this DCB. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_CHAR_DEVICE </P></TD><TD VALIGN="TOP"><P>Indicates that this is a character device. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_I13_IN_PROGRESS </P></TD><TD VALIGN="TOP"><P>Used in conjunction with RMM and the global DCB. Set when an INT 13h is in progress and cleared when the INT 13h is complete. </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_CACHE </P></TD><TD VALIGN="TOP"><P>BDF_CACHE </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_SERIAL_CMD </P></TD><TD VALIGN="TOP"><P>BDF_Serial_Cmd </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_REMOTE </P></TD><TD VALIGN="TOP"><P>BDF_Remote </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_REMOVABLE </P></TD><TD VALIGN="TOP"><P>BDF_Removable </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_WRITEABLE </P></TD><TD VALIGN="TOP"><P>BDF_Writeable </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV_INT13_DRIVE </P></TD><TD VALIGN="TOP"><P>BDF_Int13_Drive </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><B>DCB_device_flags2</B> </P>
<P>General purpose flags. Can be a combination of these values: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>DCB_DEV2_THREAD_LOCK (1) </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV2_ATAPI_DEVICE (2) </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV2_DMF_DISK (4) </P></TD><TD VALIGN="TOP"><P>Indicates current media is DMF </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_DEV2_I13_COPY_PROT (8) </P></TD><TD VALIGN="TOP"><P>Indicates INT 13h copy protection access to one of the floppies. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><B>DCB_device_type</B> </P>
<P>Device type. Can be one of these values: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>DCB_type_disk </P></TD><TD VALIGN="TOP"><P>All Direct Access Devices -- non-removable </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_type_tape </P></TD><TD VALIGN="TOP"><P>Sequencial Access Devices </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_type_printer </P></TD><TD VALIGN="TOP"><P>Printer Device </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_type_processor </P></TD><TD VALIGN="TOP"><P>Processor type device </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_type_worm </P></TD><TD VALIGN="TOP"><P>Write Once Read Many Device </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_type_cdrom </P></TD><TD VALIGN="TOP"><P>CD ROM Device </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_type_scanner </P></TD><TD VALIGN="TOP"><P>Scanner Device </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_type_optical_memory </P></TD><TD VALIGN="TOP"><P>Some Optical disk </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_type_changer </P></TD><TD VALIGN="TOP"><P>Changer device e.g. juke box </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_type_comm </P></TD><TD VALIGN="TOP"><P>Communication devices </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_type_floppy </P></TD><TD VALIGN="TOP"><P>Devices like floppy </P></TD></TR><TR><TD VALIGN="TOP"><P>DCB_type_optical_nec </P></TD><TD VALIGN="TOP"><P>NEC 5.25" optical disk </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><B>DCB_disk_bpb_flags</B> </P>
<P>Can be zero or this value: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>DCBF_DISK_BPB_USEFAKE </P></TD><TD VALIGN="TOP"><P>Maximum size of a table of contents for a CDROM. Must not exceed the value CDROM_MAX_TOC. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>See also <B>DCB</B>, <B>DCB_cd_entry</B>, <B>IOS</B>, <B>IOP</B>, <B>VRP</B> </P>
<P></P>
<P></P></FONT></BODY></HTML>
