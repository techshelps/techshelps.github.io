<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WNetOpenEnum</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>WNetOpenEnum </H3><P>This API is used to open an enumeration of network resources or existing connections. It must be called to obtain a valid handle for enumeration. </P>
<P><BR></P>
<PRE>DWORD WNetOpenEnum (
    DWORD dwScope,
    DWORD dwType,
    DWORD dwUsage,
    LPNETRESOURCE lpNetResource,
    LPHANDLE lphEnum
    );
</PRE>
<P><I>dwScope</I> </P>
<P>Determines the scope of the enumeration. This can be one of: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>RESOURCE_CONNECTED </P></TD><TD VALIGN="TOP"><P>All currently connected resources - this does not include persistent connections that are not currently available. </P></TD></TR><TR><TD VALIGN="TOP"><P>RESOURCE_GLOBALNET </P></TD><TD VALIGN="TOP"><P>All resources on the network. </P></TD></TR><TR><TD VALIGN="TOP"><P>RESOURCE_REMEMBERED </P></TD><TD VALIGN="TOP"><P>All persistent connections. </P></TD></TR><TR><TD VALIGN="TOP"><P>RESOURCE_RECENT </P></TD><TD VALIGN="TOP"><P>The most recent connections made. </P></TD></TR><TR><TD VALIGN="TOP"><P>RESOURCE_CONTEXT </P></TD><TD VALIGN="TOP"><P>The resources associated with the user's current and default network context. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>dwType</I> </P>
<P>Used to specify the type of resources and level of detail of interest. This is a bit mask which may be any combination of: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>RESOURCETYPE_DISK </P></TD><TD VALIGN="TOP"><P>All disk resources. </P></TD></TR><TR><TD VALIGN="TOP"><P>RESOURCETYPE_PRINT </P></TD><TD VALIGN="TOP"><P>All print resources. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>If dwType is RESOURCETYPE_ANY, all types of resources are returned. If an NP does not have the capability to distinguish between print and disk resources at a level, it may return all resources. </P>
<P><I>dwUsage</I> </P>
<P>Used to specify the usage of resources of interest. This is a bit mask which may be any combination of: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>RESOURCEUSAGE_CONNECTABLE </P></TD><TD VALIGN="TOP"><P>All connectable resources. </P></TD></TR><TR><TD VALIGN="TOP"><P>RESOURCEUSAGE_CONTAINER </P></TD><TD VALIGN="TOP"><P>All container resources. </P></TD></TR><TR><TD VALIGN="TOP"><P>RESOURCEUSAGE_ALL </P></TD><TD VALIGN="TOP"><P>All resources. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>This field is ignored if dwScope is not RESOURCE_GLOBALNET. </P>
<P><I>lpNetResource</I> </P>
<P>This specifies the container upon which to perform the enumeration. The <B>NETRESOURCE</B> could have been obtained via <B>WNetEnumResource</B>, constructed by the caller, or NULL. If it is NULL, the logical root of the network is assumed. An application would normally start off by calling <B>WNetOpenEnum</B> with this parameter set to NULL, and then use the returned results for further enumeration. If the calling program knows exactly the NP and remote path to enumerate from, it may build its own <B>NETRESOURCE</B> structure to pass in, filling in the <I>lpProvider</I> and <I>lpRemoteName</I> fields.. If <I>dwScope</I> is RESOURCE_REMEMBERED, RESOURCE_CONNECTED, or RESOURCE_RECENT this parameter may be NULL to enumerate all networks, or an <I>lpProvider </I>may be used to specify a particular network, with <I>lpLocalName</I> and <I>lpRemoteName</I> being ignored. </P>
<P><I>lphEnum</I> </P>
<P>If function call is successful, this will contain a handle that can then be used for <B>WNetEnumResource</B>. </P>
<UL><LI>     WN_SUCCESS if the call is successful. Other error codes include: </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>WN_NOT_SUPPORTED </P></TD><TD VALIGN="TOP"><P>this call is specifically returned when <I>lpNetResource</I> specifies a provider, <I>dwScope</I> is RESOURCE_GLOBALNET, and the specified provider does not support browsing. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NOT_CONTAINER </P></TD><TD VALIGN="TOP"><P><I>lpNetResource</I> does not point to a container </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_BAD_VALUE </P></TD><TD VALIGN="TOP"><P>Invalid <I>dwScope</I> or dwUsage or <I>dwType</I>, or bad combination of parameters is specified. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_FUNCTION_BUSY </P></TD><TD VALIGN="TOP"><P>The MPR or NP is busy (possibly initializing). The caller should retry. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NO_NETWORK </P></TD><TD VALIGN="TOP"><P>network is not present </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_EXTENDED_ERROR </P></TD><TD VALIGN="TOP"><P>a network specific error occurred. <B>WNetGetLastError</B> should be called to obtain a description of the error. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NOT_AUTHENTICATED </P></TD><TD VALIGN="TOP"><P>authentication needs to occur before the network resource can be enumerated. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NOT_LOGGED_ON </P></TD><TD VALIGN="TOP"><P>a system logon needs to occur before network enumeration is possible. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_ACCESS_DENIED </P></TD><TD VALIGN="TOP"><P>the user is authenticated to the network where the enumeration is being attempted, but does not have sufficient permissions (access rights). </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P>If <I>dwScope</I> is set to RESOURCE_GLOBALNET and the <I>lpNetResource</I> parameter is NULL, each NETRESOURCE structure in the returned buffer will describe a network. Each entry's <I>lpRemoteName</I> field will be NULL (indicating the logical root of that network), and its <I>lpProvider</I> field will name the network. Passing such a NETRESOURCE to a further <B>WNetOpenEnum</B> will enumerate the top level of that particular network. </P>
<P>If <I>dwScope</I> is set to RESOURCE_CONTEXT, each NETRESOURCE structure in the returned buffer will describe a network resource that could be from any part of a network's global browse hierarchy. In addition, the first NETRESOURCE structure in the returned buffer represents a logical root for the network, and performing a <B>WNetOpenEnum</B> on this NETRESOURCE will enumerate the networks in the same way as above. Specifically, the NETRESOURCE structure has the following settings: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>dwScope</I> is RESOURCE_GLOBALNET </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>dwType</I> is RESOURCETYPE_ANY </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>dwDisplayType</I> is RESOURCEDISPLAYTYPE_ROOT </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>dwUsage</I> is RESOURCEUSAGE_CONTAINER </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpLocalName</I>, <I>lpRemoteName</I>, and <I>lpProvider</I>, are NULL </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpComment</I> is set to a descriptive text for the root of the network </P></TD><TD VALIGN="TOP"><P></P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P></P></FONT></BODY></HTML>
