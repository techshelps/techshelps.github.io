<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Class Install Section</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Class Install Section </H3><P><BR></P>
<PRE>[ClassInstall]
AddReg=&lt;Add-registry-section&gt;[,&lt;Add-registry-section&gt;]...
Copyfiles=&lt;file-list-section&gt;[,&lt;file-list-section&gt;]...
Delfiles=&lt;File-list section&gt;[,&lt;File-list-section&gt;]...
DelReg=&lt;Del-registry-section&gt;[,&lt;Del-registry-section&gt;]...
Renfiles=&lt;File-list-section&gt;[,&lt;File-list-section&gt;]...
UpdateInis=&lt;Update-ini-section&gt;[,&lt;Update-ini-section&gt;]...
UpdateIniFields=&lt;Update-inifields-Section&gt;[,&lt;Update-inifields-section&gt;]...
</PRE>
<P>Installs a new class for a device in the class section of the registry. </P>
<P>Not all the item types shown in the syntax above are needed or required. Typically a <B>ClassInstall</B> section will use AddReg-type items to add a class description and a class icon to the registry. These will be visible in the Windows 95 user interface. </P>
<P>In addition a class install section can specify a property provider and exert control over how the class is handled in the Windows 95 user interface. </P>
<P>Every device installed in Windows 95 has a class associated with it even if the class is "UNKNOWN" and every class has a class installer associated with it. </P>
<P>The installer processes the <B>ClassInstall</B> section if one of the devices defined in an INF file is about to be installed and the class is not built into Windows 95. Following is a list of the hardware class names that are built into Windows 95: </P>
<UL><LI>     CD-ROM Controllers </LI><LI>     Display Adapters </LI><LI>     Floppy disk controllers </LI><LI>     Hard disk controllers </LI><LI>     Keyboard </LI><LI>     Memory Technology Drivers (MTDs) </LI><LI>     Modem </LI><LI>     Mouse </LI><LI>     Multi-function adapters </LI><LI>     Network adapters </LI><LI>     Other devices </LI><LI>     PCMCIA sockets </LI><LI>     Ports (COM &amp; LPT) </LI><LI>     Printer </LI><LI>     SCSI Controllers </LI><LI>     Sound, video and game controllers </LI><LI>     System devices </LI></UL><P></P>
<P>The relative key is your class section. The Device Manager will create a class entry then you have a normal install section in here. </P>
<P>This example creates the class Sample and registers the description, installer, and icon for the class: </P>
<P><BR></P>
<PRE>[ClassInstall]
Addreg=SampleClassReg
CopyFiles=@Sample.cpl

[SampleClassReg]
HKR,,,,%SampleClassDesc%
HKR,,Installer,,Sample.cpl
HKR,,Icon,HEX,00,00

[Strings]
SampleClassDesc=Sample
</PRE>
<P>The following special controls over the class can be registered by adding one or more of the following items in the <B>AddReg</B>-type item referred to by the <B>ClassInstall</B> section: </P>
<P><BR></P>
<PRE>HKR,,NoUseClass,,1        ;Class will not be seen anywhere
HKR,,NoInstallClass,,1    ;Class is not shown in New Device Wizard
HKR,,NoDisplayClass,,1    ;Class will not be displayed by Device Manager
HKR,,SilentInstall,,1    ;Class is installed without any user interaction
</PRE>

<P></P>
<P></P></FONT></BODY></HTML>
