<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PortOpen</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>PortOpen </H3><P><BR></P>
<PRE>cCall [pPortOpen], &lt;&lt;OFFSET32 PortName&gt;, VMId, &lt;OFFSET32 dwError&gt;&gt;
mov     pPortInformation, eax
</PRE>
<P>Called by <B>_VCOMM_OpenComm</B> to open a port. Uses the C calling convention. </P>
<UL><LI>     Returns the address of a <B>_PORTINFORMATION</B> structure if successful, NULL otherwise. VCOMM specifies the address in all subsequent calls to port-driver functions for the port. </LI></UL><P></P>
<P><I>PortName</I> </P>
<P>Address of a null-terminated string specifying the port name, or NULL if the port should be opened by number. </P>
<P><I>VMId</I> </P>
<P>Handle of the virtual machine (VM) that owns the port. </P>
<P><I>dwError</I> </P>
<P>Address of a 32-bit value that receives an error code if the return value is NULL. This parameter is ignored if the return value is not NULL. </P>
<P>A port driver should call the <B>_VCOMM_Acquire_Port</B> service to block access to the port when this function is called. If the service fails, the port is already in use and the port driver should not attempt to open it. </P>
<P>The communications resource handle returned by <B>_VCOMM_OpenComm</B> is not necessarily the same as the address returned by this function. </P>
<P>See also <B>_PORTINFORMATION</B>, <B>_VCOMM_Acquire_Port</B>, <B>_VCOMM_OpenComm</B> </P></FONT></BODY></HTML>
