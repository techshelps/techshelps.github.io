<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Keyboard-Event Callback Function</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Keyboard-Event Callback Function </H3><P>The keyboard-interrupt handler calls the keyboard-event callback function when it has scan and virtual-key codes to pass back to Windows. The registers must be set as follows: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Register </B></P></TD><TD VALIGN="TOP"><P><B>Value </B></P></TD></TR><TR><TD VALIGN="TOP"><P>AL </P></TD><TD VALIGN="TOP"><P>Virtual key code. For more information about the specific values, see Section 6.1.7, "Virtual-Key Codes." </P></TD></TR><TR><TD VALIGN="TOP"><P>AH </P></TD><TD VALIGN="TOP"><P>80h if the key is up, or 00h if the key is down. </P></TD></TR><TR><TD VALIGN="TOP"><P>BL </P></TD><TD VALIGN="TOP"><P>Scan code. This is an OEM-dependent value. </P></TD></TR><TR><TD VALIGN="TOP"><P>BH </P></TD><TD VALIGN="TOP"><P>01h if the key is an enhanced key (that is, if the prefix 0E0h preceded this scan code), or 00h if the key is not enhanced. </P></TD></TR><TR><TD VALIGN="TOP"><P>DI:SI </P></TD><TD VALIGN="TOP"><P>Address of extra message information. If extra message information isn't used, set the DI and SI registers to 0. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>An enhanced key is one of a set of duplicate keys, such as the ENTER, INSERT, DELETE, and direction keys, found on some keyboards such as the IBM enhanced keyboard. On the IBM keyboard, an enhanced key has the same scan code as its corresponding nonenhanced key, but the keyboard inserts the 0E0h prefix byte to indicate that the enhanced key generated the code. In this case, the keyboard-interrupt handler sets the BH register to 1 before calling the keyboard-event callback function. On the IBM enhanced keyboard, the following are enhanced keys: Direction keys, INSERT, HOME, PAGE UP, DELETE, END, PAGE DOWN, DIVIDE (on numeric keypad), and ENTER (on numeric keypad). </P>
<P>For keyboards that have extended keys with special scan codes instead of prefixes, Windows will not generate the proper WM_KEYUP or WM_KEYDOWN message unless the interrupt handler converts the scan codes to the corresponding IBM scan codes on the IBM enhanced keyboard and sets the BH register to 1 before calling the keyboard-event callback function. </P></FONT></BODY></HTML>
