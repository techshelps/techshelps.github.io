<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Reporting Errors</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Reporting Errors </H3><P>An NP returns standard error codes to report errors like insufficient memory. An NP can also use the error reporting services <B>NPSSetCustomText</B> or <B>NPSSetExtendedError</B> described below to report errors that contain provider specific information. An NP should not call <B>SetLastError</B>. </P>
<P>Also, because MPR can try several networks when attempting a network operation, NPs need to be very careful to not return a hard error code unless certain that the request is specifically for their network. This can cause MPR to terminate trying networks and report the error back to the user. When not certain that the error is for its network, an NP should return only one of the following errors (since any other error returned will cause MPR to stop trying other networks to satisfy the request): </P>
<UL><LI>     WN_BAD_LOCALNAME </LI><LI>     WN_BAD_NETNAME </LI><LI>     WN_FUNCTION_BUSY </LI><LI>     WN_NO_NETWORK </LI><LI>     WN_NO_NET_OR_BAD_PATH </LI><LI>     WN_NOT_CONNECTED </LI><LI>     WN_NOT_CONTAINER </LI><LI>     WN_NOT_LOGGED_ON </LI></UL><P></P>
<P>Note that, in particular, returning ERROR_BAD_NETPATH will cause MPR to stop trying other NPs, so this code could be returned, for example for a bad share name when the server name is known to exist. Used in conjunction with <B>NPSSetCustomText</B> this gives good performance, a descriptive error to the user, and the calling program good opportunity for intelligent error handling. </P></FONT></BODY></HTML>
