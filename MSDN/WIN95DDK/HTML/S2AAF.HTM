<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Module-Definition Files</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Module-Definition Files </H3><P>To build a device-driver DLL, you must have a module-definition (.DEF) file. From this file, you export entry-point functions. Note that the <B>DriverProc</B> entry point must be exported for all drivers. If you are writing a waveform, MIDI, mixer, or auxiliary driver, you must export additional entry-point functions, as specified in the following list: </P>
<UL><LI>     The <B>DriverProc</B> function must be exported for all audio device drivers. </LI><LI>     The <B>wodMessage</B> function must be exported for waveform output drivers. </LI><LI>     The <B>widMessage</B> function must be exported for waveform input drivers. </LI><LI>     The <B>modMessage</B> function must be exported for MIDI output drivers. </LI><LI>     The <B>midMessage</B> function must be exported for MIDI input drivers. </LI><LI>     The <B>auxMessage</B> function must be exported for auxiliary audio drivers. </LI><LI>     The <B>mxdMessage</B> function must be exported for mixer drivers. </LI></UL><P></P>
<H4><A NAME="sec0"></A>Example .DEF File </H4><P>The .DEF file exports entry-point functions, as shown in the following example taken from the MSSB16.DEF file: </P>
<P><BR></P>
<PRE>LIBRARY     MSSB16

DESCRIPTION 'wave,aux,mixer:Creative Labs Sound Blaster 16 Driver'

EXETYPE     WINDOWS
PROTMODE

CODE        MOVEABLE DISCARDABLE LOADONCALL
DATA        FIXED SINGLE PRELOAD

SEGMENTS    _TEXT     FIXED                PRELOAD
            WEP_TEXT  FIXED                PRELOAD
            INIT      MOVEABLE DISCARDABLE PRELOAD
            COMMON    MOVEABLE DISCARDABLE PRELOAD
            MIXER     MOVEABLE DISCARDABLE PRELOAD
            WAVE      MOVEABLE DISCARDABLE PRELOAD

HEAPSIZE    2048

EXPORTS     WEP             @1          RESIDENTNAME
            DriverProc      @2          RESIDENTNAME
            wodMessage      @3          RESIDENTNAME
            widMessage      @4          RESIDENTNAME
            auxMessage      @5          RESIDENTNAME
            mxdMessage      @6          RESIDENTNAME
</PRE>
<P>For more information about the entry-point function listed in this example, see . </P>
<P>In this example, functions are exported by ordinal. The actual ordinal values you assign to each exported function are not significant, though each must be unique within the DLL. </P>
<H4><A NAME="sec1"></A>Module-Name Line </H4><P>The module-name line should specify a unique module name for your device driver. Windows will not load two different modules with the same module name. It's a good idea to use the base of your driver filename because, in certain instances, <B>LoadLibrary</B> assumes that to be your module name. For example, here's the module-name line from the first example in the previous section: </P>
<P><BR></P>
<PRE>LIBRARY     MSSB16
</PRE>
<H4><A NAME="sec2"></A>Module-Description Line </H4><P>The module-description line in the module-definition file should specify the type of device the driver supports. The content of this line varies for each type of driver. </P>
<P>The Multimedia option in the Control Panel uses the name in the module-description line to identify different types of drivers and to create the entry in the [drivers] section of SYSTEM.INI when installing a driver. </P>
<H5><A NAME="sec3"></A>Module-Description Line for Video-Capture Drivers </H5><P>To indicate that a driver is a video-capture driver, use MSVIDEO followed by a colon (:) in the module-description line. </P>
<P>The Bravado driver is an example of a video-capture driver. The module-description line from the Bravado driver is the following: </P>
<P><BR></P>
<PRE>DESCRIPTION 'MSVIDEO: Truevision Bravado Driver'
</PRE>
<H5><A NAME="sec4"></A>Module-Description Line for Video-Compression Drivers </H5><P>To specify a video-compression driver, include the keyname of VIDC, a period (.), and the four-character code for your driver in the DESCRIPTION entry. Use a colon (:) to separate this entry from the text description. </P>
<P>The ICSAMPLE.DRV driver is an example of a video-compression driver. The module-description line from this driver is the following: </P>
<P><BR></P>
<PRE>DESCRIPTION 'VIDC.SAMP:Sample Decompression Driver'
</PRE>
<P>If you are using a custom-installation application instead of assuming installation through the Multimedia option in Control Panel, you do not need to include this description information. </P>
<H5><A NAME="sec5"></A>Module-Description Line for Audio Compression Drivers </H5><P>It is not necessary to include a keyword to specify an ACM driver. Instead, use a text string that fully describes the driver. For example, the following is the module-description line for the IMA ADPCM driver: </P>
<P><BR></P>
<PRE>DESCRIPTION 'Microsoft Audio Compression Manager IMA ADPCM CODEC'
</PRE></FONT></BODY></HTML>
