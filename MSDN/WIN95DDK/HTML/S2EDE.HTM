<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AddJob</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>AddJob </H3><P><BR></P>
<PRE>BOOL AddJob(
    HANDLE hPrinter,    /* handle of printer object          */
    DWORD cLevel,       /* data-structure level              */
    LPBYTE pData,       /* address of data-structure array   */
    DWORD cbBuf,            /* count of bytes in array           */
    LPDWORD pcbNeeded,  /* address of variable that contains */
                        /* count of bytes required           */
);
</PRE>
<P>Returns the full path name of a file that can be used to store a print job. </P>
<UL><LI>     If the function succeeds, the return value is <B>TRUE</B>; otherwise, it is <B>FALSE</B>. To get extended error information, use the <B>GetLastError</B> function. </LI></UL><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>hPrinter</I> </P></TD><TD VALIGN="TOP"><P>Identifies the printer for which the print job is intended. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>cLevel</I> </P></TD><TD VALIGN="TOP"><P>Specifies the version of the structure to which <I>pData</I> points. The value of this parameter must be 1. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>pData</I> </P></TD><TD VALIGN="TOP"><P>Points to a<B>n ADDJOB_INFO_1</B> structure. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>cbBuf</I> </P></TD><TD VALIGN="TOP"><P>Specifies the size, in bytes, of the buffer pointed to by <I>pData</I>. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>pcbNeeded</I> </P></TD><TD VALIGN="TOP"><P>Points to a variable that will be updated with the number of bytes copied or the number of bytes required. If <I>cbBuf</I> is less than the required number of bytes, <I>pcbNeeded</I> specifies the number of bytes required; if <I>cbBuf</I> is large enough, <I>pcbNeeded</I> specifies the number of bytes copied. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>The filename returned in the <B>ADDJOB_INFO_1</B> structure can be opened with the <B>CreateFile</B> function. Once the file is opened, data can be written to the file by calling the <B>WriteFile</B> function. </P>
<P>The job identifier returned in the <B>ADDJOB_INFO_1</B> structure can be passed to the <B>SetJob</B> and <B>ScheduleJob</B> functions in order to control the print job. </P>
<P>The <B>AddJob</B> and <B>ScheduleJob</B> functions are not currently required for basic printing, but should be supported if at all possible. Currently, Windows 95 uses <B>StartDocPrinter</B> and <B>EndDocPrinter</B> for job submission and scheduling. </P></FONT></BODY></HTML>
