<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Reference</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H2>Reference </H2><P>The section describes the functions and structures used with language monitors that differ from the functions and structures used by port monitors. GetPrinterDataFromPort </P>
<P><BR></P>
<PRE>BOOL GetPrinterDataFromPort(
    HANDLE   hPort,
    DWORD    ControlID,
    LPTSTR   pValueName,
    LPTSTR   lpInBuffer,
    DWORD    cbInBuffer,
    LPTSTR   lpOutBuffer,
    DWORD    cbOutBuffer,
    LPDWORD  lpcbReturned
);
</PRE>
<P>Gets data from a bi-directional printer by providing IEEE 1284 support. </P>
<UL><LI>     Returns TRUE if the operation is successful. </LI></UL><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>hPort</I> </P></TD><TD VALIGN="TOP"><P>The handle of the port to which the bi-directional printer is connected. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ControlID</I> </P></TD><TD VALIGN="TOP"><P>Specifies the control code for the operation. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>pValueName</I> </P></TD><TD VALIGN="TOP"><P>A string that contains a name understood by both the language monitor and the printer driver with which it was associated at printer installation time. Since both the language monitor and printer driver are developed by a printer vendor, the developer can define a set of values for this <I>pValueName</I> parameter which the language monitor can interpret as requests for bi-directional printer status from the printer driver. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpInBuffer</I> </P></TD><TD VALIGN="TOP"><P>Points to a buffer containing the data required to perform the operation. This parameter can be NULL if the <I>ControlID</I> parameter specifies an operation that does not require input data. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>cbInBuffer</I> </P></TD><TD VALIGN="TOP"><P>Size of the input buffer, in bytes. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpOutBuffer</I> </P></TD><TD VALIGN="TOP"><P>Points to a buffer in which to return the specified operation's output data. This parameter can be NULL if the <I>ControlID</I> parameter specifies an operation that does not produce output data. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>cbOutBuffer</I> </P></TD><TD VALIGN="TOP"><P>Size of the output buffer, in bytes. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpcbReturned</I> </P></TD><TD VALIGN="TOP"><P>Points to a variable that receives the actual size, in bytes, of the output data returned in the output buffer. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>The <B>GetPrinterDataFromPort</B> function can be used to make any IEEE 1284 specification IOCTL call. </P>
<P>The language monitor <B>GetPrinterDataFromPort</B> function is called by the printer driver associated with the language monitor at printer installation. If the language monitor does not have the bi-directional printer status information requested by the printer driver, the language monitor can call the port monitor <B>GetPrinterDataFromPort</B> or <B>ReadPort</B> function to get current printer status information. </P></FONT></BODY></HTML>
