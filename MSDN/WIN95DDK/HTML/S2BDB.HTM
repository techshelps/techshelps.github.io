<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MCI_INFO</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>MCI_INFO </H3><P>Obtains string information from a device. All devices respond to this message. The parameters and flags available for this message depend on the selected device. Information is returned in the <B>lpstrReturn</B> member of the structure identified by <I>lpInfo</I>. The <B>dwReturnSize</B> member specifies the buffer length for the return data. </P>
<UL><LI>     Returns zero if successful. Otherwise, it returns an MCI error code. </LI></UL><P></P>
<P>DWORD <I>lParam1</I> </P>
<P>The following standard and command-specific flags apply to all devices: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>MCI_NOTIFY </P></TD><TD VALIGN="TOP"><P>Specifies that MCI should post the <B>MM_MCINOTIFY</B> message when this command completes. The window to receive this message is specified in the <B>dwCallback</B> member of the structure identified by <I>lpInfo</I>. </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_WAIT </P></TD><TD VALIGN="TOP"><P>Specifies that the query operation should finish before MCI returns control to the application. </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_INFO_PRODUCT </P></TD><TD VALIGN="TOP"><P>Obtains a description of the hardware associated with a device. Devices should supply a description that identifies both the driver and the hardware used. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>LPMCI_INFO_PARMS <I>lParam2</I> </P>
<P>Specifies a far pointer to the <B>MCI_INFO_PARMS</B> structure. (Devices with extended command sets might replace this structure with a device-specific structure.) </P>
<P><B>Animation Extensions</B> </P>
<P>The following additional flags for <I>lParam1</I>apply to animation devices: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>MCI_INFO_FILE </P></TD><TD VALIGN="TOP"><P>Obtains the filename of the current file. This flag is only supported by devices that return TRUE to the MCI_GETDEVCAPS_USES_FILES query. </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_ANIM_INFO_TEXT </P></TD><TD VALIGN="TOP"><P>Obtains the window caption. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>Note that <I>lParam2</I>specifies a far pointer to the <B>MCI_INFO_PARMS</B> structure. </P>
<P><B>Video Overlay Extensions</B> </P>
<P>The following additional flags for <I>lParam1</I>apply to video overlay devices: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>MCI_INFO_FILE </P></TD><TD VALIGN="TOP"><P>Obtains the filename of the current file. This flag is only supported by devices that return TRUE to the MCI_GETDEVCAPS_USES_FILES query. </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_OVLY_INFO_TEXT </P></TD><TD VALIGN="TOP"><P>Obtains the caption of the window associated with the overlay device. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>Note that <I>lParam2</I> specifies a far pointer to the <B>MCI_INFO_PARMS</B> structure. </P>
<P><B>Waveform Audio Extensions</B> </P>
<P>The following additional flags for <I>lParam1</I> apply to waveform audio devices: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>MCI_INFO_FILE </P></TD><TD VALIGN="TOP"><P>Obtains the filename of the current file. This flag is supported by devices that return TRUE to the MCI_GETDEVCAPS_USES_FILES query. </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_WAVE_INPUT </P></TD><TD VALIGN="TOP"><P>Obtains the product name of the current input. </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_WAVE_OUTPUT </P></TD><TD VALIGN="TOP"><P>Obtains the product name of the current output. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>Note that <I>lParam2</I> specifies a far pointer to the <B>MCI_INFO_PARMS</B> structure. </P>
<P>If an application requests return-string information and it does not supply a buffer large enough to hold it, your device driver should fill the buffer and truncate the string. Return MCIERR_PARAM_OVERFLOW to indicate the information in the buffer was truncated. </P>
<P></P>
<P></P></FONT></BODY></HTML>
