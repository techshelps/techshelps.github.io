<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Call_When_VM_Ints_Enabled</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Call_When_VM_Ints_Enabled </H3><P><BR></P>
<PRE>include vmm.inc

mov     edx, RefData            ; reference data
mov     esi, OFFSET32 Callback  ; points to callback procedure
VMMcall Call_When_VM_Ints_Enabled
</PRE>
<P>Installs a callback procedure that the system calls when the virtual machine enables interrupts. This service calls the callback procedure immediately if interrupts are already enabled. Virtual devices use this service to ensure that virtual machine interrupts are enabled before carrying out some action, such as calling a callback procedure in the virtual machine. Uses Client_Flags, Flags. </P>
<UL><LI>     No return value. </LI></UL><P></P>
<P><I>RefData</I> </P>
<P>Reference data to be passed to the callback procedure. </P>
<P><I>Callback</I> </P>
<P>Address of the callback procedure to install. For more information about the callback procedure, see below. </P>
<P>It is usually more convenient to use the <B>Call_Priority_VM_Event</B> service instead of calling this service directly. However, this service is faster. The callback procedure is automatically uninstalled when it is called. </P>
<P>The system calls the callback procedure as follows: </P>
<P><BR></P>
<PRE>mov     ebx, VM                  ; current VM handle
mov     edx, OFFSET32 RefData    ; points to reference data
mov     ebp, OFFSET32 crs        ; points to a Client_Reg_Struc
call    [Callback]
</PRE>
<P>The <I>VM</I> parameter is a handle identifying the current virtual machine, the <I>RefData</I> parameter points to the reference data specified when the callback procedure was installed, and the <I>crs</I> parameter points to a <B>Client_Reg_Struc</B> structure containing the register values for the virtual machine. </P>
<P>The callback procedure may use the EAX, EBX, ECX, EDX, ESI, EDI, and Flags registers. </P>
<P>See also <B>Call_When_Idle</B>, <B>Call_When_Not_Critical</B>, <B>Call_When_Task_Switched</B> </P>
<P></P>
<P></P></FONT></BODY></HTML>
