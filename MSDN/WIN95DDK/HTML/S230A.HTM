<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Windows Calling Conventions</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H2>Windows Calling Conventions </H2><P>This manual presents the syntax of most functions in C-language notation. All such functions are assumed to be declared as FAR PASCAL functions, and Windows will call these functions as such. In general, exported functions in a device driver must execute the standard Windows prolog on entry and epilog on exit. </P>
<P>The following list highlights the calling conventions: </P>
<UL><LI>     Set the DS register to the selector of the driver's automatic data segment. </LI><LI>     Save and restore the following registers if used: SS, SP, BP, SI, DI, and DS. </LI><LI>     Clear the direction flag if it has been set or modified. </LI><LI>     Place 16-bit return values in the AX register; 32-bit values in the DX:AX register pair. </LI><LI>     Execute a FAR return. </LI></UL><P></P>
<P>Windows pushes all parameters on the stack in a left to right order (the last parameter shown in the function syntax is closest to the stack pointer). Windows also passes pointer parameters as 32-bit quantities, pushing the selector first then the offset. This allows exported functions to use the <B>lds</B> or <B>les</B> instructions to retrieve pointers from the stack. </P>
</FONT></BODY></HTML>
