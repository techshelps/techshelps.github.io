<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Handling Mouse Interrupts</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Handling Mouse Interrupts </H3><P>A mouse minidriver installs an interrupt handler to process hardware interrupts from the mouse. To install an interrupt handler, a mouse minidriver must use services provided by the virtual programmable interrupt controller device (VPICD). </P>
<P>After installing the interrupt handler, the mouse minidriver must call the <B>VMD_Set_Mouse_Data</B> service to provide VMOUSE with information about the mouse, including the mouse-type identifier, the number of the interrupt request (IRQ) the mouse is using, the number of the port the mouse is using, and the number of buttons on the mouse. VMOUSE uses this information to respond to various Interrupt 33H functions. </P>
<P>The interrupt handler translates the raw data from the mouse into messages and posts them to VMOUSE by calling the <B>VMD_Post_Pointer_Message </B>service. Each message includes the horizontal and vertical delta values and a value indicating the status of the mouse buttons. The <I>horizontal</I> and <I>vertical delta values</I> indicate the amount, in mickeys, of horizontal and vertical mouse movement that occurred since posting the last message to VMOUSE. A <I>mickey</I> is the distance the mouse must move to generate a mouse-movement signal. </P>
<P>The button-status value is a byte-size array of bits that indicate the status of each mouse button; that is, whether each is pressed or released. A bit is 1 if the corresponding button is pressed; otherwise, it is 0. The button status value has the following form: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Bit </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P>0, 1 </P></TD><TD VALIGN="TOP"><P>Undefined </P></TD></TR><TR><TD VALIGN="TOP"><P>2 </P></TD><TD VALIGN="TOP"><P>Status of button 4 </P></TD></TR><TR><TD VALIGN="TOP"><P>3 </P></TD><TD VALIGN="TOP"><P>Status of button 2 </P></TD></TR><TR><TD VALIGN="TOP"><P>4 </P></TD><TD VALIGN="TOP"><P>Status of button 3 </P></TD></TR><TR><TD VALIGN="TOP"><P>5 </P></TD><TD VALIGN="TOP"><P>Status of button 1 </P></TD></TR><TR><TD VALIGN="TOP"><P>6, 7 </P></TD><TD VALIGN="TOP"><P>Undefined </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>VMOUSE interprets the data in the mouse messages based on user-defined settings such as the rotation angle, acceleration, and sensitivity and then passes the data to the appropriate VM. If the system VM has the mouse focus, VMOUSE passes the data to the <B>Mouse_Event</B> function in the Windows USER module. If an application in a non-system VM has the mouse focus, VMOUSE passes the data to the application's mouse callback function. The application installs the callback function by calling Interrupt 33h, Function 0Ch. </P>
<P>See also <B>Mouse_Event</B>, <B>VMD_Post_Pointer_Message</B>, <B>VMD_Set_Mouse_Data</B> </P></FONT></BODY></HTML>
