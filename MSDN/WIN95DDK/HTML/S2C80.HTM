<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Calculating Calibration Values</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Calculating Calibration Values </H3><P>To calculate the base and delta calibration values, the Joystick option of the Control Panel sets the base value to 0 and the delta values to 1. It then polls the joystick driver while the user holds the joystick at each corner of the device coordinate space. This produces the actual value range returned by the device for each coordinate. </P>
<P>After retrieving the coordinate ranges specified by the <B>joyGetDevCaps</B> function, the Joystick option uses the following formulas to calculate new base and delta values. </P>
<P><BR></P>
<PRE>wDelta = (wTargetMax - wTargetMin) / (wActualMax - wActualMin)
wBase = (wActualMin * wDelta) - wTargetMin
</PRE>
<P>In the following example, the joystick returned <I>x</I> coordinate values in the range 43 to 345, compared to a logical value range of 0 to 65535: </P>
<P><BR></P>
<PRE>wDelta = (65535-0) / (345-43)
       = 216

wBase  = 43 * 216 - 0
       = 9288
</PRE></FONT></BODY></HTML>
