<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NPGetConnection</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>NPGetConnection </H3><P>Obtains information about a redirected device. </P>
<P><BR></P>
<PRE>DWORD NPGetConnection(
  LPTSTR lpLocalName,
  LPTSTR lpRemoteName,
  LPDWORD lpBufferSize
  );
</PRE>
<P><I>lpLocalName</I> </P>
<P>Contains the name of the local device the caller is interested in. </P>
<P><I>lpRemoteName</I> </P>
<P>Points to a buffer to receive the remote name used to make the connection. </P>
<P><I>lpBufferSize</I> </P>
<P>This is used to specify the size, in bytes, of the buffer passed in. If the call fails because the buffer is not big enough, this location will be used to return the required buffer size. </P>
<UL><LI>     WN_SUCCESS if the call is successful. Otherwise, an error code is returned, which may include: </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>WN_BAD_LOCALNAME </P></TD><TD VALIGN="TOP"><P><I>lpLocalName</I> is invalid. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NOT_CONNECTED </P></TD><TD VALIGN="TOP"><P><I>lpLocalName</I> not a redirected device. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_MORE_DATA </P></TD><TD VALIGN="TOP"><P>The buffer is too small. </P></TD></TR><TR><TD VALIGN="TOP"><P>WN_NO_NETWORK </P></TD><TD VALIGN="TOP"><P>The network is not present. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P></FONT></BODY></HTML>
