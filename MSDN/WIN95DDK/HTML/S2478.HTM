<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>VendorInstaller</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>VendorInstaller </H3><P>VendorInstaller = <I>filename</I>, <I>function-name</I> </P>
<P>Names a vendor-provided Win32 DLL that performs the entire printer installation process, and the exported entry-point to call in that DLL. Can only be used for Plug and Play devices. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>filename</I> </P></TD><TD VALIGN="TOP"><P>Name of the vendor-supplied installer DLL. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>function-name</I> </P></TD><TD VALIGN="TOP"><P>Name of the function exported by the DLL to call to begin the vendor-supplied printer installation process. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>Use of a VendorInstaller statement in the Install section or a Data section it refers to indicates that the printer vendor has a custom printer installation process to be used instead of the normal installation process. Note that a custom printer installation process is only supported for Plug and Play printers, that is, printers that generate a device ID value. The normal installation process must be able to match the generated device ID with a device ID in the INF file before the normal installation process will call the entry-point exported by the vendor-supplied installer DLL. </P>
<P>The vendor-supplied DLL must be a Win32 DLL and the function identified by <I>function-name</I> must have the following prototype: </P>
<P><BR></P>
<PRE>VOID FAR PASCAL functionname (HWND      hWnd,
                              HINSTANCE hInstance,
                              LPSTR     lpszCmdLine,
                              int       nCmdShow
                             );
</PRE>
<P>When the normal installation process calls the exported function, <I>lpszCmdLine</I> points to the registry key, relative to HKEY_LOCAL_MACHINE, that has been created by Windows 95 Plug and Play and which contains information about the printer to be installed by the vendor-supplied DLL. The DLL is then responsible for carrying out all aspects of printer installation, except copying files that are specified in INF file sections named in the Install section CopyFiles statement -- the normal installation process carries out the CopyFiles directive before the DLL is called. </P>
<P>In general, the vendor-supplied DLL should add a registry value under the passed-in key named ConfigFlags and set its value to 0 (a DWORD of type REG_BINARY). Then the DLL should call the Win32 print subsystem APIs <B>AddPrinter</B>, <B>AddPrinterDriver</B>, etc. as needed. </P>
<P>If a VendorInstaller statement is used in the Install section (or a Data section it refers to), then Windows 95 will not prompt the user with the opportunity to print a test page at the end of the printer installation. </P></FONT></BODY></HTML>
