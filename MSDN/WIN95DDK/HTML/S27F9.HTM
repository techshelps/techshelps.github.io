<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Step 4: Add Hardware Acceleration Code</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Step 4: Add Hardware Acceleration Code </H3><P>Because the DIB engine uses highly-efficient software acceleration routines, it is not necessary to write any software accelerators. To improve display performance, your display adapter may be able to implement specific DDI calls through hardware. If you can use hardware to accelerate some driver drawing calls, performance will be greatly enhanced. The following operations are suggested, in order of importance: </P>
<UL><LI>     Screen to screen blts with the <B>SRCCOPY</B> ROP. </LI><LI>     Blts with the <B>PATCOPY</B> ROP. Recommended brushes are solid, dithered, pattern, and hatch. </LI><LI>     The DDI <B>ExtTextOut</B>. </LI><LI>     Blts with the following ROPS: <B>DSTINVERT</B>, <B>PATINVERT</B>, <B>WHITENESS</B>, <B>BLACKNESS</B>, <B>DPx</B>, <B>DPa</B> (with a mono brush) </LI><LI>     Solid color lines. </LI><LI>     <B>PolyScanLine</B> for solid color </LI></UL><P></P>
<P>For each call you replace with hardware acceleration, take the corresponding line out of DIBLINK.ASM. For example, if you replace <B>StretchBlt</B> with hardware acceleration, remove: </P>
<P><BR></P>
<PRE>DIBLINK StretchBlt, DIB_StretchBlt
</PRE>
<P>Note that if the driver can support multiple chipsets, the <B>Enable</B> section should detect the chipset and set flags for specific accelerators. Only add the detection you need; for example, don't add code to detect bus types if your hardware acceleration code does nothing unusual for a particular type of bus. </P></FONT></BODY></HTML>
