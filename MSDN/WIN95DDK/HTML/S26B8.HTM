<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>COMPOSITIONFORM</title>
<style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD>

<BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">

<H3>COMPOSITIONFORM </h3>

<P><br>
</p>

<pre>typedef tagCOMPOSITIONFORM {
    DWORD  dwStyle;
    POINT  ptCurrentPos;
    RECT  rcArea;
}COMPOSITIONFORM;
</pre>

<P>The <b>dwStyle</b> member is specified by CFS_xxxx.
The <b>ptCurrentPos</b> member specifies the size and position of
the bounding rectangle and the start position of the composition
window. </p>

<P><b>CFS_DEFAULT</b> </p>

<P>The CFS_DEFAULT value moves the composition window
out to the default position. IME can display the composition
window outside client area. It might be on a floating window. </p>

<P><img src="ime_01.gif" width="259" height="144"> </p>

<P><b>CFS_POINT</b> </p>

<P>The CFS_POINT value displays the composition window
at the upper left of the latter window, at the position indicated
by <b>ptCurrentPos</b>. The <b>ptCurrentPos</b> member indicates
the coordinates relative to the upper left of the latter window,
with the low-order word representing the x coordinate and the
high-order word the y coordinate. </p>

<P><img src="ime_02.gif" width="268" height="115"> </p>

<P><b>CFS__FORCE_POSITION</b> </p>

<P>The CFS_FORCE_POSITION value displays the
composition window at the upper left of the window as designated
by <b>ptCurrentPos</b>. The <b>ptCurrentPos</b> member indicates
the coordinates relative to the upper left of the latter window,
with the low-order word representing the x coordinate and the
high-order word the y coordinate. </p>

<P>Some near caret operation IMEs show its conversion
window by adjusting the position specified by the system or the
application. The CFS_FORCE_POSITION informs IMEs to stop this
adjustment. </p>

<P><img src="ime_03.gif" width="268" height="115"> </p>

<P>If the CFS_FORCE_POSITION bit is off, some IMEs
adjust their position according to the position specifying in
ptCurrentPos with CFS_POINT style. </p>

<P><img src="ime_04.gif" width="268" height="115"> </p>

<P><b>CFS_RECT</b> </p>

<P>The CFS_RECT value is the same as CFS_POINT except
that the bounding rectangle is specified by <b>rcCompArea</b>.
The coordinates are relative to the upper left of the window. </p>

<P><img src="ime_05.gif" width="316" height="153"> </p>

<P>When the style of the <b>COMPOSITIONFORM</b>
structure is CFS_POINT or CFS_FORCE_POINT, the IME starts to draw
the composition string from the position that is specified by <b>ptCurrentPos</b>
of the <b>COMPOSITIONFORM</b> structure that is given by the
application. If the style has CFS_RECT, the composition string
will be inside of the rectangle that is specified by <b>rcArea</b>.
If not, <b>rcArea</b> is the client rectangle of the application
window. </p>

<P>When the application specifies the composition font,
the composition window is rotated as the escapement of the
composition font. The direction of the composition string follows
the escapement of the font in a composition window. IME starts to
draw the composition string as follows. </p>

<P>The escapement of the composition font is 0 </p>

<P><img src="ime_06.gif" width="432" height="192"> </p>

<P>This is normal case. The <b>ptCurrentPos</b> member
of the composition form structure points left and top of the
string. All IMEs support this type. </p>

<P>The escapement of the composition font is 2700. </p>

<P><img src="ime_07.gif" width="432" height="316"> </p>

<P>This is a case of a vertical writing. When the
application provides the vertical writing, the application may
set the 2700 escapement in the composition font that is set by <b>ImmCompositionFont</b>.
The composition string will be drawn downward. The IMEs that have
UI_CAP_2700, UI_CAP_ROT90 or UI_CAP_ROTANY capability support
this type of the composition window. </p>

<P>The escapement of the composition font is 900 or
1800 </p>

<P><img src="ime_08.gif" width="432" height="192"> </p>

<P><img src="ime_09.gif" width="432" height="192"> </p>

<P>The IMEs that have UI_CAP_ROT90 or UI_CAP_ROTANY
capability support this type of the composition window. </p>

<P>The escapement of the composition font is any value.
</p>

<P><img src="ime_10.gif" width="432" height="192"> </p>

<P>The IMEs that have UI_CAP_ROTANY capability support
this type of the composition window. </p>

<P>UI_CAP_ROT90 and UI_CAPS_ANY are the option for the
enhancement of the IME. UI_CAP_2700 is recommended. </p>

<P>This structure is used with the
IMC_SETCOMPOSITIONWINDOW and IMC_SETCANDIDATEPOS messages. </p>
</FONT></BODY>
</html>
