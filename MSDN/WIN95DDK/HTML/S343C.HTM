<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Power_Event</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Power_Event </H3><P><BR></P>
<PRE>include vmm.inc
include power.inc

mov     esi, Event
mov     edi, OFFSET32 Return
mov     eax, Power_Event
VMMcall System_Control
</PRE>
<P>Notifies the virtual device that a power event has just occurred. The virtual device may modify all general registers and flags. </P>
<UL><LI>     The virtual device must return with carry clear, even to fail the call. See the description of Return for information on how to fail the call. </LI></UL><P></P>
<P><I>Event</I> </P>
<P>Type of power event. Can be one of these values: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P>PWR_CRITICALRESUME </P></TD><TD VALIGN="TOP"><P>Resume critical operations after suspension. </P></TD></TR><TR><TD VALIGN="TOP"><P>PWR_SUSPENDREQUEST </P></TD><TD VALIGN="TOP"><P>Suspend operation. </P></TD></TR><TR><TD VALIGN="TOP"><P>PWR_SUSPENDRESUME </P></TD><TD VALIGN="TOP"><P>Resume operation after suspension. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>Return</I> </P>
<P>Address of the doubleword that receives the return value, which can be one of these values: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P>PWR_FAIL </P></TD><TD VALIGN="TOP"><P>Virtual device failed to process the event. </P></TD></TR><TR><TD VALIGN="TOP"><P>PWR_OK </P></TD><TD VALIGN="TOP"><P>Virtual device processed the event successfully. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>All other values are reserved. </P>
<P>To fail the call, a virtual device should store the value PWR_FAIL in the doubleword pointed to by <I>Return</I>. For the call to succeed, the virtual device must leave the doubleword pointed to by <I>Return</I> unchanged. If a VxD stores PWR_OK through <I>Return</I>, it might overwrite a PWR_FAIL value that was written there by the previous device. </P>
<P>Only the virtual power device (VPOWERD) is permitted to send this message to devices. The EBX register must be zero on entry. The EDX register is reserved. </P>
<P>Note that this message is sent for compatibility with Windows 3.1 virtual devices. New virtual devices should use the <B>VPOWERD_Register_Power_Handler</B> service to be notified of changes in power state. </P>
<P></P>
<P></P></FONT></BODY></HTML>
