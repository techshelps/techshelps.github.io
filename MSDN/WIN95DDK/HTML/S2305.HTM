<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Building a Virtual Device</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H2>Building a Virtual Device </H2><P>You build a virtual device by doing the following: </P>
<P>    1.    Create the virtual device source files and assemble the sources using MASM.EXE, the 32-bit flat-model assembler. </P>
<P>    2.    Create a module definition file (.DEF) and link the object files using LINK.EXE, the 32-bit flat model linker. By convention, the resulting executable file should have the same filename as the virtual device, but with the filename extension .VXD. </P>
<P>    3.    Create a debugging symbol file for the executable file using MAPSYM.EXE. </P>
<P></P>
<P>A virtual device is not compatible with Windows dynamic-link libraries. Windows-based applications cannot load and use virtual devices directly. However, Win32-based applications can use the <B>CreateFile</B> and <B>DeviceIoControl</B> functions to load and interact with dynamically-loadable VxDs. </P>
<P>The module definition file for a virtual device has the following form: </P>
<P><BR></P>
<PRE>LIBRARY  VSAMPLED

DESCRIPTION 'VSAMPLED Device  (Version 4.0)'

EXETYPE  DEV386

SEGMENTS
             _LTEXT PRELOAD NONDISCARDABLE
             _LDATA PRELOAD NONDISCARDABLE
             _ITEXT CLASS 'ICODE' DISCARDABLE
             _IDATA CLASS 'ICODE' DISCARDABLE
             _TEXT  CLASS 'PCODE' NONDISCARDABLE
             _DATA  CLASS 'PCODE' NONDISCARDABLE

EXPORTS
             VSAMPLED_DDB  @1
</PRE>
<P>The <B>LIBRARY</B> statement must specify the name of the virtual device, as given in the device description block (DBB) and the <B>EXPORTS</B> statement must specify the name of the DBB. In all cases, the export ordinal for the DDB is 1. </P>
</FONT></BODY></HTML>
