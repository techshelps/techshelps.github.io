<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sample Port Monitor</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H2>Sample Port Monitor </H2><P>The default port monitor provided by Microsoft in Windows 95 is part of the spooler subsystem DLL. If you need to develop another port monitor, you need to package it as a separate DLL callable by the spooler subsystem. The Reference section of this chapter names the APIs that your DLL needs to export to be called by the spooler subsystem, and defines the members of the data structures the spooler subsystem uses to share information with a port monitor. </P>
<P>Only two APIs have to be exported by a port monitor such that they appear in the .DEF file for the monitor: <B>InitializeMonitorEx</B> and <B>DllEntryPoint</B>. The <B>InitializeMonitorEx</B> code loads the addresses (function pointers) of the other port monitor functions that the local print provider calls. For an example, see the <B>InitializeMonitorEx</B> function code in the sample port monitor code provided with the Windows 95 DDK. All the functions that the local print provider expects to call through the function pointer table are defined in the reference section. </P>
<P>The sample port monitor code is located in the SAMPLES directory after you install the Windows 95 DDK. </P></FONT></BODY></HTML>
