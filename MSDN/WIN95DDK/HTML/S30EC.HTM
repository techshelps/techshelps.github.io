<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IFSMgr_UseAdd</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>IFSMgr_UseAdd </H3><P><BR></P>
<PRE>IFSMgr_UseAdd(
 pioreq pir,
 int proId,
 netuse_info *pinfo
 )
</PRE>
<P>This service is called by an FSD to perform a network use operation to connect to a network resource. This service is normally not necessary to use. Most connections are done by the IFS manager directly. This is needed only for certain private apis that the IFS manager does not understand. </P>
<P><I>pir</I> </P>
<P>Supplies pointer to IOREQ structure. If a NULL is passed in for the IOREQ pointer, the IFS manager allocates an IOREQ structure for the duration of this call. In this case, the caller also needs to pass in the pinfo parameter so that the IOREQ structure can be appropriately initialized. The IOREQ structure is freed before return from the service. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>IOREQ Structure:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_data</I> </P></TD><TD VALIGN="TOP"><P>Supplies flat pointer to <B>use_info_2</B> structure described below. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Use_Info_2 Structure:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P>
<P>The fields that need to be initialized are described below. All other fields should be set to zero. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ui2_local</I> </P></TD><TD VALIGN="TOP"><P>Supplies the ASCIIZ string the resource is to be connected to viz. a device name or driveletter. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ui2_remote</I> </P></TD><TD VALIGN="TOP"><P>Supplies the ASCIIZ resource name that is to be connected. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ui2_password</I> </P></TD><TD VALIGN="TOP"><P>Supplies the ASCIIZ string for the password of the resource, if any. This pointer should be NULL if there is no password for this resource. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ui2_asg_type</I> </P></TD><TD VALIGN="TOP"><P>Supplies resource type for connection. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Connection Resource Type Values:</B> </P>
<P>One of the following resource types will be specified. </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><B>USE_WILDCARD</B> </P></TD><TD VALIGN="TOP"><P>Wild card resource type. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>USE_DISKDEV</B> </P></TD><TD VALIGN="TOP"><P>Disk resource. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>USE_SPOOLDEV</B> </P></TD><TD VALIGN="TOP"><P>Spooled printer resource. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>USE_CHARDEV</B> </P></TD><TD VALIGN="TOP"><P>Character device resource. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>USE_IPC</B> </P></TD><TD VALIGN="TOP"><P>Interprocess communication resource. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>ui2_res_type</I> </P>
<P>Supplies resource name type. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Resource Name Type Values:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P>USE_RES_UNC </P></TD><TD VALIGN="TOP"><P>Resource name is UNC. Currently, this is the only supported flag and <I>ui2_res_type</I> must always be set to this. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>ir_flags</I> </P>
<P>Supplies the connection status. This field has only 2 values: 1 if the connection should be set up disconnected, 0 if it should be set up connected. </P>
<P><I>ir_conflags</I> </P>
<P>Supplies the source of the connection. This must be set to a non-zero value because the connection is not via a normal api level call. </P>
<P><I>proId</I> </P>
<P>Supplies the provider id of the provider requesting the connection. </P>
<P><I>pinfo</I> </P>
<P>Supplies an optional pointer to a <B>netuse_info</B> structure. This should only be passed in if the provider has no IOREQ available i.e. NULL is passed in the pir field. The fields that need to be initialized are described below. All other fields should be set to zero. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Netuse_Info Structure:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><I>nu_data</I> </P></TD><TD VALIGN="TOP"><P>Suplies a pointer to a <B>use_info_2</B> struct that is initialized as described above. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>nu_flags</I> </P></TD><TD VALIGN="TOP"><P>Supplies flags for the request. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>FSD_NETAPI_USEOEM</B> </P></TD><TD VALIGN="TOP"><P>This flag is set if you are passing in OEM strings, otherwise strings are assumed to be ANSI. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>FSD_NETAPI_STATIC</B> </P></TD><TD VALIGN="TOP"><P>This flag is set for a connection that will only be removed at shutdown time. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>FSD_NETAPI_USELFN</B> </P></TD><TD VALIGN="TOP"><P>This flag specifies that the remote name passed in should be treated as a long name. Otherwise, it is treated as a short name. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>nu_rsvd</I> </P></TD><TD VALIGN="TOP"><P>Must be set to 0xff always. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<UL><LI>     Returns 0 if no error, errorcode otherwise. </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>IOREQ Structure:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_error</I> </P></TD><TD VALIGN="TOP"><P>Returns 0 if no error, errorcode otherwise. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P></P>
<P></P></FONT></BODY></HTML>
