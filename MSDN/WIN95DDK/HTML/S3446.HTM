<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>System_Exit</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>System_Exit </H3><P><BR></P>
<PRE>include vmm.inc

mov     ebx, SysVMHandle
mov     eax, System_Exit
VMMcall System_Control
</PRE>
<P>Notifies the virtual device that the system is terminating, either normally or as a result of a crash. Interrupts remain enabled while virtual devices process this message. The virtual device may modify all general registers and flags. </P>
<UL><LI>     This message cannot be failed. The virtual device must return carry clear. </LI></UL><P></P>
<P><I>SysVMHandle</I> </P>
<P>Handle of the system virtual machine. </P>
<P>The virtual device must <I>not</I> call the <B>Simulate_Int</B> or <B>Exec_Int</B> service, but the virtual device may modify the system virtual machine memory to restore the system state to allow Windows to exit without complication. </P>
<P>The system restores the instance snapshot before sending this message. </P>
<P>The virtual device may not access pageable data during the processing of the <B>System_Exit</B> message because the swap file may be in a bad state (which is why the system is crashing in the first place), or the swap file may already have been closed. Virtual devices which wish to access pageable data during <B>System_Exit</B> must lock the data during <B>Sys_VM_Terminate</B>. During a system crash, the <B>Sys_VM_Terminate</B> message is not sent, so the virtual device should have some way of determining during <B>System_Exit</B> whether or not it was able to lock its data; if not, it should skip any procedures which use the pageable data. </P>
<P>See also <B>Sys_Critical_Exit</B>, <B>Sys_VM_Terminate</B>, <B>System_Exit2</B> </P>
<P></P>
<P></P></FONT></BODY></HTML>
