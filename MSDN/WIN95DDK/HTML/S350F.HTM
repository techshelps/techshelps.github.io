<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>VXDLDR_LoadDevice</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>VXDLDR_LoadDevice </H3><P><BR></P>
<PRE>include vxdldr.inc

mov     edx, [Devicename]
mov     eax, [Flags]
VxDcall VXDLDR_LoadDevice
jc      errorhandler
</PRE>
<P>Loads a VxD into memory. Uses EAX and EDX. </P>
<UL><LI>     Returns the address of the device-descriptor block in EAX and the device handle in EDX when the function is successful. Otherwise, it sets the carry flag and EAX contains the error code, which can be one of the following values: </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P>VXDLDR_ERR_BAD_DEVICE_FILE </P></TD><TD VALIGN="TOP"><P>Specified VxD file is not usable. </P></TD></TR><TR><TD VALIGN="TOP"><P>VXDLDR_ERR_DEVICE_REFUSED </P></TD><TD VALIGN="TOP"><P>Specified device operation not allowed. </P></TD></TR><TR><TD VALIGN="TOP"><P>VXDLDR_ERR_DUPLICATE_DEVICE </P></TD><TD VALIGN="TOP"><P>Specified operation has already occurred for the given device. </P></TD></TR><TR><TD VALIGN="TOP"><P>VXDLDR_ERR_FILE_OPEN_ERROR </P></TD><TD VALIGN="TOP"><P>Unable to open specified file. </P></TD></TR><TR><TD VALIGN="TOP"><P>VXDLDR_ERR_FILE_READ </P></TD><TD VALIGN="TOP"><P>Unable to read specified file. </P></TD></TR><TR><TD VALIGN="TOP"><P>VXDLDR_ERR_IN_DOS </P></TD><TD VALIGN="TOP"><P>System error. </P></TD></TR><TR><TD VALIGN="TOP"><P>VXDLDR_ERR_NO_SUCH_DEVICE </P></TD><TD VALIGN="TOP"><P>Specified device not found. </P></TD></TR><TR><TD VALIGN="TOP"><P>VXDLDR_ERR_OUT_OF_MEMORY </P></TD><TD VALIGN="TOP"><P>Out of memory. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P><I>Devicename</I> </P>
<P>Address of a null-terminated string specifying the filename of the VxD. </P>
<P><I>Flags</I> </P>
<P>Indicates whether the device is initialized by the system or by the calling VxD. If this parameter is VXDLDR_INIT_DEVICE, the device is initialized by the system. Otherwise, this parameter should be zero, and the calling VxD should initialize the device and send the SYS_DYNAMIC_DEVICE_INIT message. </P>
<P>If you call this function without specifying the VXDLDR_INIT_DEVICE flag, you must call either the <B>VXDLDR_DevInitSucceeded</B> or <B>VXDLDR_DevInitFailed</B> service to free system resources associated with the VxD before calling <B>VXDLDR_UnloadDevice</B> to unload the VxD. </P>
<P></P>
<P></P></FONT></BODY></HTML>
