<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Error Handling</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H2>Error Handling </H2><P>A SCSI miniport driver is responsible for handling and for notifying the port driver of the following kinds of SCSI errors, which should be set in the <B>SrbStatus</B> field before the driver completes the SRB it was processing when the error occurred: </P>
<UL><LI>     SRB_STATUS_ERROR (if the HBA returns a nonspecific bus error) </LI><LI>     SRB_STATUS_PARITY_ERROR </LI><LI>     SRB_STATUS_UNEXPECTED_BUS_FREE </LI><LI>     SRB_STATUS_SELECTION_TIMEOUT </LI><LI>     SRB_STATUS_COMMAND_TIMEOUT </LI><LI>     SRB_STATUS_MESSAGE_REJECTED </LI><LI>     SRB_STATUS_NO_DEVICE </LI><LI>     SRB_STATUS_NO_HBA </LI><LI>     SRB_STATUS_DATA_OVERRUN (also returned for underruns) </LI><LI>     SRB_STATUS_PHASE_SEQUENCE_FAILURE </LI><LI>     SRB_STATUS_BUSY (TID busy) </LI></UL><P></P>
<P>For a data underrun, the miniport driver must update the SRB's <B>DataTransferLength</B> to indicate how much data actually was transferred. </P>
<P>Whenever the miniport driver encounters an HBA or bus error, it should call <B>ScsiPortLogError</B> with one of the following system-defined error codes: </P>
<UL><LI>     SP_BUS_PARITY_ERROR </LI><LI>     SP_UNEXPECTED_DISCONNECT (by the target LU) </LI><LI>     SP_INVALID_RESELECTION </LI><LI>     SP_BUS_TIME_OUT </LI><LI>     SP_REQUEST_TIMEOUT </LI><LI>     SP_PROTOCOL_ERROR </LI><LI>     SP_INTERNAL_ADAPTER_ERROR </LI><LI>     SP_IRQ_NOT_RESPONDING (if the miniport detects that the HBA is no longer generating interrupts) </LI><LI>     SP_BAD_FW_ERROR ("FW" stands for "firmware") </LI><LI>     SP_BAD_FW_WARNING </LI></UL><P></P>
<P><B>ScsiPortLogError</B> allocates an error-log packet, sets it up, and logs the I/O error on behalf of the miniport driver to help users or system administrators monitor the condition of the HBA. </P>
</FONT></BODY></HTML>
