<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DISPLAYINFO</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>DISPLAYINFO </H3><P><BR></P>
<PRE>DISPLAYINFO  struc
  diHdrSize    dw  size DisplayInfo
  diInfoFlags    dw  ?
  diDevNodeHandle    dd  ?
  diDriverName    db  16 dup(?)
  diXRes      dw  ?
  diYRes      dw  ?
  diDPI      dw  ?
  diPlanes    db  ?
  diBpp      db  ?
  diRefreshRateMax  dw  ?
  diRefreshRateMin  dw  ?
  diLowHorz    dw  ?
  diHighHorz    dw  ?
  diLowVert    dw  ?
  diHighVert    dw  ?
  diMonitorDevNodeHandle  dd  ?
  diHorzSyncPolarity  db  ?
  diVertSyncPolarity  db  ?
DISPLAYINFO
</PRE>
<P>Specifies the display information selected by the user. The information in this structure is obtained by calling either the ring 3 function <B>VDD_GET_DISPLAY_CONFIG </B>or the ring 0 function <B>VDD_GetDisplayInfo.</B> </P>
<P><B>diHdrSize</B> </P>
<P>Size in bytes of the <B>DISPLAYINFO</B> structure. </P>
<P><B>diInfoFlags</B> </P>
<P>Informational flags, may be one of the following: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>RETURNED_DATA_IS_STALE </P></TD><TD VALIGN="TOP"><P>Indicates that the data in the <B>DISPLAYINFO</B> structure was read in a previous call to <B>VDD_GET_DISPLAY_CONFIG</B> instead of directly from the Registry. If this flag is set, you may want to call <B>VDD_GET_DISPLAY_CONFIG</B> (or <B>VDD_GetDisplayInfo) </B>again to attempt to obtain data directly from the registry. </P></TD></TR><TR><TD VALIGN="TOP"><P>MINIVDD_FAILED_TO_LOAD </P></TD><TD VALIGN="TOP"><P>Indicates that the mini-VDD did not load, possibly because the mini-VDD did not match the chipset installed in the machine. </P></TD></TR><TR><TD VALIGN="TOP"><P>MINIVDD_CHIP_ID_DIDNT_MATCH </P></TD><TD VALIGN="TOP"><P>Indicates that although the mini-VDD did load successfully, when the ChipID that the mini-VDD calculated was compared against the value saved in the registry, they did not match. For example, suppose the user is using an S3-911 card and then decides to upgrade the display card to an S3-864. Because both cards use S3.VXD, the mini-VDD will load. But because the card model is different, the VDD will return a defect to configuration manager and set this flag. </P></TD></TR><TR><TD VALIGN="TOP"><P>REGISTRY_BPP_NOT_VALID </P></TD><TD VALIGN="TOP"><P>Indicates that the VDD was unable to obtain a bits-per-pixel value from the Registry. </P></TD></TR><TR><TD VALIGN="TOP"><P>REGISTRY_RESOLUTION_NOT_VALID </P></TD><TD VALIGN="TOP"><P>Indicates that the VDD was unable to obtain a resolution value from the Registry. </P></TD></TR><TR><TD VALIGN="TOP"><P>REGISTRY_DPI_NOT_VALID </P></TD><TD VALIGN="TOP"><P>Indicates that the VDD was unable to obtain a DPI value from the Registry. </P></TD></TR><TR><TD VALIGN="TOP"><P>MONITOR_DEVNODE_NOT_ACTIVE </P></TD><TD VALIGN="TOP"><P>Indicates that a call to the function <B>GET_DISPLAY_CONFIG </B>was made before the monitor DevNode handle had been created. This means that the monitor refresh rate information in the <B>DISPLAYINFO</B> structure is invalid. </P></TD></TR><TR><TD VALIGN="TOP"><P>MONITOR_INFO_NOT_VALID </P></TD><TD VALIGN="TOP"><P>Indicates that the values in <B>diRefreshRateMax</B>, <B>diRefreshRateMin</B>, <B>diLowHorz</B>, <B>diHighHorz</B>, <B>diLowVert</B>, <B>diHighVert</B>, <B>diHorzSyncPolarity</B>, and <B>diVertSyncPolarity</B> are not valid. </P></TD></TR><TR><TD VALIGN="TOP"><P>MONITOR_INFO_DISABLED_BY_USER </P></TD><TD VALIGN="TOP"><P>Indicates that either the "RefreshRate=" string in SYSTEM.INI had a negative number in it or that the string in the display software key "RefreshRate =" string was 0 or a negative number. </P></TD></TR><TR><TD VALIGN="TOP"><P>REFRESH_RATE_MAX_ONLY </P></TD><TD VALIGN="TOP"><P>Indicates that there was no data in the Registry for <B>diLowHorz</B>, <B>diHighHorz</B>, <B>diLowVert</B>, <B>diHighVert</B>, <B>diHorzSyncPolarity</B>, or <B>diVertSyncPolarity</B> and that the value returned in <B>diRefreshRateMax</B> is the only refresh rate data available and it was derived either from either the "RefreshRate=" string in SYSTEM.INI or the display software key "RefreshRate =" string in the Registry. </P></TD></TR><TR><TD VALIGN="TOP"><P>CARD_VDD_LOADED_OK </P></TD><TD VALIGN="TOP"><P>Indicates that a card VDD was successfully loaded and initialized. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><B>diDevNodeHandle</B> </P>
<P>Handle used to access information in the Registry about the display subsystem and passed to configuration management function calls. </P>
<P><B>diDriverName</B> </P>
<P>Address of a null-terminated string containing the name of the driver. </P>
<P><B>diXRes</B> </P>
<P>Width in pixels, of the display. </P>
<P><B>diYRes</B> </P>
<P>Height in pixels, of the display. </P>
<P><B>diDPI</B> </P>
<P>Number of dots per inch of the display. </P>
<P><B>diPlanes</B> </P>
<P>Number of color planes. </P>
<P><B>diBpp</B> </P>
<P>Number of adjacent color bits for each pixel. </P>
<P><B>diRefreshRateMax</B> </P>
<P>Maximum refresh rate. </P>
<P><B>diRefreshRateMin</B> </P>
<P>Minimum refresh rate. </P>
<P><B>diLowHorz </B>and <B>diHighHorz</B> </P>
<P>Horizontal sync polarity ranges. </P>
<P><B>diLowVert </B>and <B>diHighVert</B> </P>
<P>Vertical sync polarity ranges. </P>
<P><B>diMonitorDevNodeHandle</B> </P>
<P>Handle used to access Registry information about the monitor. </P>
<P><B>diHorzSyncPolarity</B> and <B>diVertSyncPolarity </B></P>
<P>Sync polarity monitor settings. </P>
<P>See also <B>ValidateMode</B>, <B>VDD_GET_DISPLAY_CONFIG</B> </P>
</FONT></BODY></HTML>
