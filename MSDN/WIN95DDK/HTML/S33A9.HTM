<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Get_Crit_Section_Status</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Get_Crit_Section_Status </H3><P><BR></P>
<PRE>include vmm.inc

VMMcall Get_Crit_Section_Status

mov     [VMHandle], ebx
mov     [Claims], ecx
jc      high_priority
</PRE>
<P>Retrieves the claim count and owner of the critical section. Uses Flags </P>
<UL><LI>     Returns the critical section claim count in ECX and the handle of the virtual machine owning the critical section in EBX. If ECX is 0, EBX is the handle of the current virtual machine. The carry flag is set if the current virtual machine has an execution priority greater than or equal to Critical_Section_Boost, such as during a hardware interrupt simulation. </LI></UL><P></P>
<P>Windows 3.1 sometimes delays releasing the critical section until events are processed. This service causes the system to complete any delayed releases before the service returns the status. This may cause a task switch if another virtual machine has a delayed release. </P>
<P>If a virtual device must ensure that it owns the critical section to successfully complete an operation, it should call this service to make sure that the critical section status is up to date. </P>
<P>This is not an asynchronous service; it must <I>not</I> be called at interrupt time. </P>
<P>See also <B>Get_Crit_Status_No_Block</B> </P>
<P></P>
<P></P></FONT></BODY></HTML>
