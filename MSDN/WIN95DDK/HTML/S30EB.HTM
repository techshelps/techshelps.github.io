<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IFSMgr_NetFunction</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>IFSMgr_NetFunction </H3><P><BR></P>
<PRE>IFSMgr_NetFunction(
 pioreq pir,
 pUserRegs pRegs,
 int proId,
 int flags
 )
</PRE>
<P>This service is provided to export certain functions most of which are specific to the network FSDs. These functions can come from a variety of sources: int 21h and int 2fh functions that the IFS hooks but does not support, int 21h functions that the IFS does not support that are hooked via IFSMgr_SetReqHook and internal IFS manager broadcast functions to notify FSDs of certain happenings. It is not possible to document the different functions that different FSDs might hook. What is documented here are the internal broadcasts that the IFS manager issues and the general interface of the IFSMgr_NetFunction api. FSDs that need to see these calls need to hook the IFSMgr_NetFunction service using the VMM Hook_Device_Service service. The IFS manager has a stub installed for the IFSMgr_NetFunction service that returns error if no one else has hooked the service. </P>
<P><I>pir</I> </P>
<P>Supplies the IOREQ structure. The actual fields used in IOREQ vary based on the function type and are described below. </P>
<P><I>pRegs</I> </P>
<P>Supplies pointer to the client register structure. </P>
<P><I>User AX</I> </P>
<P>Supplies the function type. Depending on the type of function the IOREQ structure is appropriately initialized. If this is an int 21h that is not processed by the IFS manager but has been hooked by the FSD via the IFSMgr_SetReqHook function, this field contains the original AX value that the user issued the int 21h with. There are a via int 2fh requests that are also routed through this service with AX containing the original int 2fh function numbers in AX. FSDs that need to process them should look for them. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Function Type:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><B>NF_PROCEXIT</B> </P></TD><TD VALIGN="TOP"><P>This function is broadcast whenever a process exits for FSDs to do any cleanup, if necessary. For normal resources, the IFS manager takes care of cleanup and calls the FSDs at process exit time. Only FSDs that need to maintain special per process resources that the IFS does not know about need to monitor this call. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>NF_DRIVEUSE</B> </P></TD><TD VALIGN="TOP"><P>This function is broadcast whenever a new drive appears in the system. This need not necessarily be a network drive. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>NF_DRIVEUNUSE</B> </P></TD><TD VALIGN="TOP"><P>This function is broadcast whenver a drive goes away. This need not necessarily be a net drive. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>NF_GETPRINTJOBID</B> </P></TD><TD VALIGN="TOP"><P>This function is broadcast when the IFS manager needs a print job id from the FSD. This is used only for network FSDs. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>NF_PRINTERUSE</B> </P></TD><TD VALIGN="TOP"><P>This function is broadcast whenever a network printer is attached. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>NF_PRINTERUNUSE</B> </P></TD><TD VALIGN="TOP"><P>This function is broadcast whenever a network printer is disconnected. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>proId</I> </P></TD><TD VALIGN="TOP"><P>Supplies the provider id the call is meant for - could be all providers (ANYPROID) also depending on the function type. This is described below. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>flags</I> </P>
<P>Supplies special flags. This flag is currently a boolean flag - it is set if this is a Win32 api call and clear if it is not a Win32 api call. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Function NF_PROCEXIT:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_pid</I> </P></TD><TD VALIGN="TOP"><P>Supplies process id of exiting process. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>proId</I> </P></TD><TD VALIGN="TOP"><P>ANYPROID. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Function NF_DRIVEUSE:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_rh</I> </P></TD><TD VALIGN="TOP"><P>Supplies FSD resource handle to the drive that has just appeared. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_flags</I> </P></TD><TD VALIGN="TOP"><P>Supplies driveletter (1-based) of drive that has just appeared. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_aux1.aux_ul</I> </P></TD><TD VALIGN="TOP"><P>Supplies provider id of the provider handling the new drive. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>proId</I> </P></TD><TD VALIGN="TOP"><P>ANYPROID. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Function NF_DRIVEUNUSE:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_rh</I> </P></TD><TD VALIGN="TOP"><P>Supplies FSD resource handle to the drive that has gone away. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_flags</I> </P></TD><TD VALIGN="TOP"><P>Supplies driveletter (1-based) of drive that has gone away. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_aux1.aux_ul</I> </P></TD><TD VALIGN="TOP"><P>Supplies provider id for the deleted drive. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>proId</I> </P></TD><TD VALIGN="TOP"><P>ANYPROID. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Function NF_GETPRINTJOBID:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_rh</I> </P></TD><TD VALIGN="TOP"><P>Supplies FSD resource handle to the printer. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_data</I> </P></TD><TD VALIGN="TOP"><P>Supplies pointer to the user buffer where the print job id is to be filled in. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>proId</I> </P></TD><TD VALIGN="TOP"><P>Provider id of provider handling the printer resource. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Function NF_PRINTERUSE:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_rh</I> </P></TD><TD VALIGN="TOP"><P>Supplies FSD resource handle to the new printer. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_flags</I> </P></TD><TD VALIGN="TOP"><P>Supplies printer index of new printer. The printer index is a value from 0 through 8 for LPT1 - LPT9. PRN has the same index as LPT1. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>proId</I> </P></TD><TD VALIGN="TOP"><P>Supplies provider id of provider who is handling the new printer. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Function NF_PRINTERUNUSE:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_rh</I> </P></TD><TD VALIGN="TOP"><P>Supplies FSD resource handle to the printer that just got disconnected. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_flags</I> </P></TD><TD VALIGN="TOP"><P>Supplies printer index of printer being disconnected. Look above for details about this field. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>proId</I> </P></TD><TD VALIGN="TOP"><P>Supplies provider id of provider who was handling the disconnected printer. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Hooked Int 21h Function:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_ppath</I> </P></TD><TD VALIGN="TOP"><P>Supplies pointer to parsed path buffer that can be used by the FSD. The IFS manager does not initialize this field with anything. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>proId</I> </P></TD><TD VALIGN="TOP"><P>Provider returned by the hooking FSD on its preamble return. The details are described in section 8.11.5.9. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<UL><LI>     The internal functions: NF_PROCEXIT, NF_DRIVEUSE, NF_DRIVEUNUSE, NF_PRINTERUSE, NF_PRINTERUNUSE have no return values. For all other functions, the return value is the same as what is returned in <I>ir_error</I>. </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>ir_error</I> </P></TD><TD VALIGN="TOP"><P>Returns 0 if success, errorcode if failure. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P></P>
<P></P></FONT></BODY></HTML>
