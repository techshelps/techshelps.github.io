<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DRV_SetEntryPoints</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>DRV_SetEntryPoints </H3><P>Registers a device or DLL to receive pen data at each interrupt. Such pen data include pen packets and any OEM-specific information. </P>
<UL><LI>     If the message processing is successful, the driver returns the device hook ID. The ID is a positive number that the sender should store. (To discontinue receiving pen events, the sender must provide the ID number with the DRV_RemoveEntryPoints message.) If the message processing is not successful, the driver returns DRV_FAILURE. </LI></UL><P></P>
<P><I>lParam1</I> </P>
<P>Either the PENREG_WILLHANDLEMOUSE flag or the PENREG_DEFAULT flag. </P>
<P><I>lParam2</I> </P>
<P>The address of a callback function to receive the pen data. This function must export the interface specified in the <B>ProcessTabletEvents</B> function specified elsewhere in this reference section. </P>
<P>The callback routine that handles tablet events must be in a page-locked code segment because it functions as an interrupt-handling routine. </P>
<P>Typically, only the PENWIN.DLL library sends the DRV_SetEntryPoints message to the pen driver. If another process needs to hook the interrupt data traffic, it should do so by sending DRV_SetEntryPoints. Possible reasons to hook the interrupt data include processing pen packets to determine hardware accuracy, recording interrupt-time information, or perhaps performing interrupt-time processing based on pen information. </P>
<P>The following example code shows a call to <B>SendDriverMessage</B> that sends a DRV_SetEntryPoints message. </P>
<P><BR></P>
<PRE>dwHookID = SendDriverMessage( hPenDrv, DRV_SetEntryPoints,
              PENREG_DEFAULT, &amp;ProcessTabletEvents );
</PRE>
<P></P>
<P></P></FONT></BODY></HTML>
