<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_PELDR_LoadModule</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>_PELDR_LoadModule </H3><P><BR></P>
<PRE>#include &lt;vxdldr.h&gt;

LRESULT CDECL PELDR_LoadModule(PHPEMODULE  phModule, 
    PSTR pFileName, PHLIST phList);
</PRE>
<P>Loads a portable executable, performs relocation fixups and resolves imports. Uses C calling conventions. </P>
<UL><LI>     Returns PELDR_ERR_NOERROR if successful, otherwise returns a non-zero error number. Possible error return values include the following: </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>PELDR_ERR_FILE_UNABLETOOPEN </P></TD><TD VALIGN="TOP"><P>Unable to open the specified file. </P></TD></TR><TR><TD VALIGN="TOP"><P>PELDR_ERR_MEM_NOMEMORY </P></TD><TD VALIGN="TOP"><P>Insufficient memory to complete the request. </P></TD></TR><TR><TD VALIGN="TOP"><P>PELDR_ERR_IMAGE_INVALIDSIZE </P></TD><TD VALIGN="TOP"><P>Module image size is invalid. </P></TD></TR><TR><TD VALIGN="TOP"><P>PELDR_ERR_IMAGE_INVALIDFORMAT </P></TD><TD VALIGN="TOP"><P>The specified file is not a valid portable executable type binary. </P></TD></TR><TR><TD VALIGN="TOP"><P>PELDR_ERR_FILE_READERROR </P></TD><TD VALIGN="TOP"><P>A read error occurred while loading the file. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P><I>phModule</I> </P>
<P>Address of the handle to receive the module handle on successful return. </P>
<P><I>pFileName</I> </P>
<P>Address of a null terminated string containing the path and filename to the executable. If the path is not specified, the path of the VMM32 executable is used. </P>
<P><I>phList</I> </P>
<P>Address of the list handle of export tables. This parameter is specified when a client restricts the export table list. If NULL, the global export table list is used. If the handle pointed to by phList is NULL, a new local export table list is created. </P>
<P>Note that this function does not load modules to resolve external dependencies, instead, this function assumes that the caller is loading modules in the appropriate order to resolve dynamic link dependencies. During system initialization (up to the Init_Complete notification), <B>_PELDR_LoadModule</B> will check the V86MMGR translation buffer state and automatically allocate a temporary global V86 data area for I/O buffering if the translation buffer does not exist. </P>
<P></P>
<P></P></FONT></BODY></HTML>
