<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Importing Services</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Importing Services </H3><P>A virtual device can import services from another virtual device by including the virtual device's service table declaration. In such cases, the service table declaration must <I>not</I> be preceded with the device-specific symbol (as described in the previous section). For example, a virtual device that includes the file VSAMPLED.INC, which contains the service table declaration for VSAMPLED services, can call those services. A virtual device calls VMM services using the <B>VMMcall</B> macro, and calls virtual device services using the <B>VxDcall</B> macro. </P>
<P>Depending on a computer's configuration, a virtual device may fail to load when Windows starts. This means a virtual device that uses services provided by another virtual device must verify that the other virtual device services are available before calling them. To verify the services, the calling virtual device must attempt to call the <B>Get_Version</B> service of the virtual device providing the services. If the virtual device has not been loaded, the VMM sets the carry flag and returns zero in the AX register. </P></FONT></BODY></HTML>
