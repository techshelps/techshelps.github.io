<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Control Panel Extensions</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H2>Using Control Panel Extensions </H2><P>A control-panel extension is an OLE 2 server DLL. You must supply a device-information (INF) file that copies your DLL to the Windows \SYSTEM directory and creates two registry keys, one that defines the extension's globally unique identifier (GUID), and the other that declares the GUID as a control-panel extension. The INF file format and the registry keys are described in more detail later in this topic. For an example of a control-panel extension, including source files, see the CPLX directory in the Windows 95 DDK. </P>
<P>Some of the Control Panel applications in Windows 95 can be extended by adding property-sheet pages or by making interface changes in existing property-sheet pages. This is an alternative to developing an entirely new Control Panel. Using Control Panel extensions has the following advantages: </P>
<UL><LI>     Enables an IHV to develop a user interface for the unique characteristics of a device without having to develop an entirely new Control Panel. </LI><LI>     Enables Windows 95 users to find all the settable characteristics of a device in the Control Panel that already exists for that device; a user is more likely to find an additional property-sheet page in the Display Control Panel , for example, than they are to find an entirely new Control Panel. Adding a new Control Panel also changes the pattern of displayed Control Panel icons from what the user is accustomed to. </LI></UL><P></P>
<P>When no existing Control Panel addresses your needs, you can create your own Control Panel. (For example, this could be necessary for BIOS setup interfaces.) For information about creating your own Control Panel, see "Control Panel Applications" in the Win32 Programmer's Reference. </P>
<P>As mentioned earlier, not all of the Control Panel applications in Windows 95 can be extended by adding property-sheet pages or by making interface changes in existing property-sheet pages. The following table lists the standard Control Panels and describes their extensibility: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Control Panel </B></P></TD><TD VALIGN="TOP"><P><B>Extensibility </B></P></TD></TR><TR><TD VALIGN="TOP"><P>Accessibility </P></TD><TD VALIGN="TOP"><P>Not extensible. </P></TD></TR><TR><TD VALIGN="TOP"><P>Add New Hardware </P></TD><TD VALIGN="TOP"><P>An application can add classes and devices to lists, using a .INF file. </P></TD></TR><TR><TD VALIGN="TOP"><P>Add/Remove Program </P></TD><TD VALIGN="TOP"><P>Net administrators can add a list of central company software to be installed by setting a registry key and creating a data file on a common server. This procedure is documented in the Resource Kit. </P>
<P>The Install/Uninstall property sheet contains a list of software that can be uninstalled by Windows. An application that uses the uninstall utility of the InstallShield application will be included in this list. InstallShield is included with the Windows 95 SDK. For more information, see the InstallShield documentation. </P></TD></TR><TR><TD VALIGN="TOP"><P>Date/Time </P></TD><TD VALIGN="TOP"><P>Not extensible. </P></TD></TR><TR><TD VALIGN="TOP"><P>Display </P></TD><TD VALIGN="TOP"><P>An application can add property sheet pages, using the <B>IShellPropSheetExt::AddPage</B> interface and adding a "Controls Folder\Display" key to the registry. </P></TD></TR><TR><TD VALIGN="TOP"><P>Joystick </P></TD><TD VALIGN="TOP"><P>Not extensible. </P></TD></TR><TR><TD VALIGN="TOP"><P>Keyboard </P></TD><TD VALIGN="TOP"><P>Although the Speed page is replacable, it should not be necessary to do so. Replacing this page can affect the accuracy of existing Help files. </P>
<P> </P>
<P>An application can add property sheet pages, using the <B>IShellPropSheetExt::AddPage</B> interface and adding a "Controls Folder\Keyboard" key to the registry. </P></TD></TR><TR><TD VALIGN="TOP"><P>Modems </P></TD><TD VALIGN="TOP"><P>Not extensible. </P></TD></TR><TR><TD VALIGN="TOP"><P>Mouse </P></TD><TD VALIGN="TOP"><P>Although the Motion and Button pages are replacable, it should not be necessary to do so. Replacing these pages can affect the accuracy of existing Help files. </P>
<P>An application can add property sheet pages, using the <B>IShellPropSheetExt::AddPage</B> interface and adding a "Controls Folder\Mouse" key to the registry. </P></TD></TR><TR><TD VALIGN="TOP"><P>Multimedia </P></TD><TD VALIGN="TOP"><P>Not extensible. </P></TD></TR><TR><TD VALIGN="TOP"><P>Network </P></TD><TD VALIGN="TOP"><P>Most network drivers and software can fully specify their installation requirements and files by using network .INF files. For more information about network .INF files, see "Network Driver Installer" in the DDK. </P></TD></TR><TR><TD VALIGN="TOP"><P>Passwords </P></TD><TD VALIGN="TOP"><P>An application can add property sheet pages, using the <B>IShellPropSheetExt::AddPage</B> interface and adding a "Controls Folder\Passwords" key to the registry. For more information, see "Passwords Control Panel" in the Windows 95 Programming Guide. </P></TD></TR><TR><TD VALIGN="TOP"><P>PCMCIA </P></TD><TD VALIGN="TOP"><P>Not extensible. </P></TD></TR><TR><TD VALIGN="TOP"><P>Power Management </P></TD><TD VALIGN="TOP"><P>An application can add property sheet pages, using the <B>IShellPropSheetExt::AddPage</B> interface and adding a "Controls Folder\Power" key to the registry </P></TD></TR><TR><TD VALIGN="TOP"><P>Regional Settings </P></TD><TD VALIGN="TOP"><P>Not extensible. </P></TD></TR><TR><TD VALIGN="TOP"><P>Sounds </P></TD><TD VALIGN="TOP"><P>Not extensible. </P></TD></TR><TR><TD VALIGN="TOP"><P>System </P></TD><TD VALIGN="TOP"><P>Not extensible. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P></FONT></BODY></HTML>
