<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Language Monitor and Port Monitor Relationships</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Language Monitor and Port Monitor Relationships </H3><P>In general, port monitor components deal with the relatively low-level communications protocol between the printer and computer. Language monitors deal with a higher-level communications exchange between printer and computer, as described in the section above. </P>
<P>Fundamental ideas about monitor components in the Windows 95 spooler architecture are: </P>
<UL><LI>     At least one port monitor component is required for the spooler to output print jobs, while language monitors are completely optional. </LI><LI>     Only port monitors send and receive signals through the hardware port a printer is connected to. </LI><LI>     Only language monitors are able to parse the strings of data read from a port with a bi-directional printer attached. The language monitor calls the port monitor <B>ReadPort</B> or <B>GetPrinterDataFromPort</B> functions to get data from a bi-directional printer. The port monitor <B>ReadPort</B> and <B>GetPrinterDataFromPort</B> functions read any data available from the printer and pass that data back to the language monitor without changing it in any way and it is up to the language monitor to interpret the meaning of the data from the printer. The language monitor should use a <B>GetPrinterDataFromPort</B> function call if the bi-directional printer supports the IEEE 1284 standard; otherwise, it should use a <B>ReadPort</B> call. The language monitor can call either of these port monitor functions from a background thread on a periodic basis (say every few seconds), using a timer, to read unsolicited status information from a bi-directional printer. The source code for the sample language monitor supplied with the DDK, PJLMON, contains code that implements reading unsolicited printer status information in this way. </LI></UL><P></P>
<P>The spooler architecture diagram in <I>Typical Printing Process Scenario Using a Raw Spool File</I> illustrates these principles. It shows a spooler with one port monitor and one language monitor, and only the port monitor sends and receives through the hardware port. A diagram that showed the relationship between spooler components when the only local target printer is non-bi-directional would probably not show a language monitor component. </P>
<P>Note that it is possible to integrate the language monitor functionality and port monitor functionality into one component. </P></FONT></BODY></HTML>
