<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using ASPI for Win32 - An Overview</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H2>Using ASPI for Win32 - An Overview </H2><P>The ASPI manager for Win32 is implemented as a Dynamic Link Library (DLL) called wnaspi32.dll. ASPI function calls can be used to retrieve information about installed SCSI host adapters and devices, and to execute SCSI I/O requests. The ASPI for Win32 layer is fully re-entrant, supporting multitasking and multithreaded operations. To use ASPI for Win32, the following two functions must be imported from wnaspi32.dll into the client's Win32 application. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="108pt" VALIGN="TOP"><COL WIDTH="240pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Function </B></P></TD><TD VALIGN="TOP"><P><B>Description </B></P></TD></TR><TR><TD VALIGN="TOP"><P>GetASPI32SupportInfo </P></TD><TD VALIGN="TOP"><P>This function returns the number of SCSI host adapters installed and ensures that the ASPI manager is initialized properly. Clients must call this function once at initialization time before the SendASPI32Command function can be accessed. </P></TD></TR><TR><TD VALIGN="TOP"><P>SendASPI32Command </P></TD><TD VALIGN="TOP"><P>This function handles requests for SCSI I/O. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>The following SCSI I/O command codes are defined within the SendASPI32Command: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="108pt" VALIGN="TOP"><COL WIDTH="240pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P>SC_HA_INQUIRY </P></TD><TD VALIGN="TOP"><P>Get information about installed host adapters, including the number of installed adapters. </P></TD></TR><TR><TD VALIGN="TOP"><P>SC_GET_DEV_TYPE </P></TD><TD VALIGN="TOP"><P>Get information about installed SCSI devices. </P></TD></TR><TR><TD VALIGN="TOP"><P>SC_EXEC_SCSI_CMD </P></TD><TD VALIGN="TOP"><P>Execute SCSI I/O. </P></TD></TR><TR><TD VALIGN="TOP"><P>SC_ABORT_SRB </P></TD><TD VALIGN="TOP"><P>Abort an outstanding I/O request. </P></TD></TR><TR><TD VALIGN="TOP"><P>SC_RESET_DEV </P></TD><TD VALIGN="TOP"><P>Reset an individual SCSI target. </P></TD></TR><TR><TD VALIGN="TOP"><P>SC_GET_DISK_INFO </P></TD><TD VALIGN="TOP"><P>Get information on disk type SCSI devices. (Not used with Windows NT) </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P></FONT></BODY></HTML>
