<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MapVirtualKey</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>MapVirtualKey </H3><P><BR></P>
<PRE>int MapVirtualKey(WORD  wCode, WORD  wMapType);
</PRE>
<P>Maps scan codes to virtual-key codes, and virtual-key codes to either scan codes or ANSI character. This function is intended to be used by the Program Information File (PIF) Editor and Windows to get information about keyboard mapping. </P>
<UL><LI>     Returns, in AX, a nonzero scan code or virtual-key code, if successful. Returns zero if mapping cannot be performed. </LI></UL><P></P>
<P><I>wCode</I> </P>
<P>Input scan code or virtual-key code. </P>
<P><I>wMapType</I> </P>
<P>Mapping to carry out. Can be one of these values. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P>0 </P></TD><TD VALIGN="TOP"><P>Map virtual key to scan code. </P></TD></TR><TR><TD VALIGN="TOP"><P>1 </P></TD><TD VALIGN="TOP"><P>Map scan code to virtual key. </P></TD></TR><TR><TD VALIGN="TOP"><P>2 </P></TD><TD VALIGN="TOP"><P>Map virtual key to ASCII character. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>The export ordinal for this function is 131. </P>
<P>For the first two mappings, the scan code to virtual-key code translation table is examined to determine the translations. Some valid codes may not be translated in this table. </P>
<P>For the third type of mapping, uppercase letters A through Z are returned for VK_A through VK_Z. ASCII characters are returned for the top-row numeric keys VK_0 through VK_9. For punctuation and dead keys in the main part of the keyboard, the unshifted character will be returned. </P>
<P>New keyboard drivers should support both <B>MapVirtualKey</B> and <B>MapVirtualKeyEx</B>. To support <B>MapVirtualKey</B>, call MapVirtualKeyEx with the <I>lcid</I> parameter set to the system locale id. </P>
<P>See also <B>AnsiToOem</B>, <B>OemToAnsi</B>, <B>MapVirtualKeyEx</B> </P>
<P></P>
<P></P></FONT></BODY></HTML>
