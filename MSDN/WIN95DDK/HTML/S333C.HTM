<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Controlling Virtual Machine Execution</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Controlling Virtual Machine Execution </H3><P>The <B>Close_VM</B> and <B>Nuke_VM</B> services terminate the specified virtual machine. <B>Close_VM</B> gives all virtual devices an opportunity to clean up before the virtual machine terminates by first broadcasting the <B>Close_VM_Notify</B> message to all virtual devices. By comparison, <B>Nuke_VM</B> does not broadcast any notifications before terminating the virtual machine. A virtual device should use <B>Nuke_VM</B> only to terminate a virtual machine that has not terminated normally and does not respond to <B>Close_VM</B>. </P>
<P>The VMM maintains a suspend count for each non-system virtual machine. The execution of a non-system virtual machine is suspended whenever its suspend count is greater than zero. Calling <B>Suspend_VM</B> increments the suspend count; calling Resume_VM decrements it. (As noted previously, this sense of the word "suspend" when applied to virtual machines is different from the sense when applied to threads.) </P>
<P>A virtual device receives the <B>VM_Suspend</B> control message when <B>Suspend_VM</B> changes a virtual machine's suspend count from 0 to 1. It receives the <B>VM_Resume</B> control message when <B>Resume_VM</B> changes the count from 1 to 0. A virtual device can prevent the virtual machine from resuming by setting the carry flag in response to <B>VM_Resume</B>. A virtual device cannot prevent a virtual machine from being suspended. The <B>No_Fail_Resume_VM</B> service is similar to <B>Resume_VM</B> except that it doesn't allow a virtual device to prevent a virtual machine from resuming. </P>
<P>See also <B>Close_VM</B>, <B>No_Fail_Resume_VM</B>, <B>Nuke_VM</B>, <B>Suspend_VM</B>, <B>Resume_VM</B>, <B>VM_Resume</B>, <B>VM_Suspend</B> </P></FONT></BODY></HTML>
