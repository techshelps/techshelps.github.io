<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MODM_OPEN</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>MODM_OPEN </H3><P>See also MODM_CLOSE, MIDIOPENDESC</P>
<P>Sent to a MIDI output driver to allocate a specified device for use by a client application. </P>
<UL><LI>     The return value is an error code, or zero (MMSYSERR_NOERROR) if the operation is successful. Possible error codes are: </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>MMSYSERR_NOTENABLED </P></TD><TD VALIGN="TOP"><P>The driver failed to load or initialize. </P></TD></TR><TR><TD VALIGN="TOP"><P>MMSYSERR_ALLOCATED </P></TD><TD VALIGN="TOP"><P>The device is already allocated by the maximum number of clients the driver supports or the device cannot be opened because of system resource limitations other than memory. </P></TD></TR><TR><TD VALIGN="TOP"><P>MMSYSERR_NOMEM </P></TD><TD VALIGN="TOP"><P>The device cannot be opened because of a failure allocating or locking memory. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P>DWORD <I>dwParam1</I> </P>
<P>Specifies a far pointer to a <B>MIDIOPENDESC</B> structure. This structure contains additional information for the driver such as instance data from the client and a callback for the client. </P>
<P>DWORD <I>dwParam2</I> </P>
<P>Specifies option flags for opening the device. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>CALLBACK_EVENT </P></TD><TD VALIGN="TOP"><P>If this flag is specified, <I>dwCallback</I> in the <B>MIDIOPENDESC</B> structure is assumed to be an event handle. </P></TD></TR><TR><TD VALIGN="TOP"><P>CALLBACK_FUNCTION </P></TD><TD VALIGN="TOP"><P>If this flag is specified, <I>dwCallback</I> in the <B>MIDIOPENDESC</B> structure is assumed to be the address of a callback function. </P></TD></TR><TR><TD VALIGN="TOP"><P>CALLBACK_THREAD </P></TD><TD VALIGN="TOP"><P>If this flag is specified, <I>dwCallback</I> in the <B>MIDIOPENDESC</B> structure is assumed to be a handle to a thread. </P></TD></TR><TR><TD VALIGN="TOP"><P>CALLBACK_WINDOW </P></TD><TD VALIGN="TOP"><P>If this flag is specified, <I>dwCallback</I> in the <B>MIDIOPENDESC</B> structure is assumed to be a window handle. </P></TD></TR><TR><TD VALIGN="TOP"><P>MIDI_IO_COOKED </P></TD><TD VALIGN="TOP"><P>If this flag is specified, the device is being opened in stream mode. In stream mode, the driver may receive all Windows 3.1 messages as well as the stream messages. The device driver must be able to handle any contingencies which arise; for example, it must be able to play short messages and system exclusive messages asynchronously to the stream. </P></TD></TR><TR><TD VALIGN="TOP"><P>MIDI_IO_PACKED </P></TD><TD VALIGN="TOP"><P>If this flag is specified, the driver is being opened in compatability mode. (Compatability mode is supported for applications written for the Windows 3.1 platform). </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>It is up to the driver to determine the number of clients allowed to use a particular device. Once a device is opened for the maximum number of clients the driver supports, the driver should return MMSYSERR_ALLOCATED for any additional open requests. If the open operation is successful, the driver should use the <B>DriverCallback</B> function to send the client a <B>MOM_OPEN</B> message. </P>
<P></P>
<P></P></FONT></BODY></HTML>
