<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetPrinterDriverDirectory</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>GetPrinterDriverDirectory </H3><P><BR></P>
<PRE>BOOL GetPrinterDriverDirectory(
  LPTSTR  lpszName,    /* address of server name                */
  LPTSTR  lpszEnv,     /* address of environment                */
  DWORD   dwLevel,     /* address of structure                  */
  LPBYTE  lpbDir,      /* address of structure array that       */
                       /* receives path                         */
  DWORD   cbBuf,       /* size, in bytes, of array              */
  LPDWORD lpdwNeeded   /* addr. of variable with count of bytes */
                       /* retrieved (or required)               */
);
</PRE>
<P>Retrieves the path to the specified printer driver. </P>
<UL><LI>     If the function succeeds, the return value is <B>TRUE</B>; otherwise, it is <B>FALSE</B>. To get extended error information, use the <B>GetLastError</B> function. </LI></UL><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>lpszName</I> </P></TD><TD VALIGN="TOP"><P>Points to a null-terminated string that specifies the name of the server on which the printer driver resides. If this string is <B>NULL</B>, the path to the Local Print Provider is retrieved. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpszEnv</I> </P></TD><TD VALIGN="TOP"><P>Points to a null-terminated string that specifies the environment. For example, "Windows 96 x86" specifies Windows 96 running on an Intel(r) 80386 or 80486 processor. If this string is NULL, the current environment of the caller/client (not of the destination/server) is used. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>dwLevel</I> </P></TD><TD VALIGN="TOP"><P>Specifies the structure level. This value must be 1. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpbDir</I> </P></TD><TD VALIGN="TOP"><P>Points to an array of bytes that receives the path. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>cbBuf</I> </P></TD><TD VALIGN="TOP"><P>Specifies the size of the array to which <I>lpbDir</I> points. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpdwNeeded</I> </P></TD><TD VALIGN="TOP"><P>Points to a value that specifies the number of bytes copied if the function succeeds, or the number of bytes required if <I>cbBuf</I> is too small. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P></FONT></BODY></HTML>
