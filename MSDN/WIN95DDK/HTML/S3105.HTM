<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>UniToBCS</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>UniToBCS </H3><P><BR></P>
<PRE>UniToBCSPath(
 unsigned char * pBCSStr,
 string_t  pUniStr,
 unsigned int length,
 unsigned int maxLength,
 int charSet
 )
</PRE>
<P>This service maps a unicode string to a BCS string in the specified character set. Currently, the Windows ANSI codepage or the current OEM codepage in the system can be specified for the conversion. It is important to note that the source and destination buffers cannot be the same nor can they overlap. They should be two separate buffers. This service does not terminate the converted path with a NUL character, the caller of the service needs to do this, if necessary. </P>
<P><I>pBCSStr</I> </P>
<P>Supplies a flat pointer to a destination buffer to contain the converted BCS string. </P>
<P><I>pUniStr</I> </P>
<P>Supplies a flat pointer to the source unicode string that needs to be converted into a BCS string. </P>
<P><I>length</I> </P>
<P>Supplies the length in bytes of the unicode input string. </P>
<P><I>maxLength</I> </P>
<P>Supplies the maximum length in bytes of the destination buffer, excluding the NUL character. </P>
<P><I>charSet</I> </P>
<P>Supplies the BCS character set the unicode path needs to be converted to. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>BCS Character Set Values:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><B>BCS_WANSI</B> </P></TD><TD VALIGN="TOP"><P>Specifies that the conversion should be done to the Windows ANSI codepage. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>BCS_OEM</B> </P></TD><TD VALIGN="TOP"><P>Specifies that the conversion should be done to currently active OEM codepage. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<UL><LI>     Returns the number of bytes in the converted unicode string and flags in the <B>_QWORD</B> structure format described below. </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>_QWORD Structure:</B> </P>
<P>The fields in this structure are filled in as follows. </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ddLower</I> </P></TD><TD VALIGN="TOP"><P>Returns the number of bytes in the converted unicode string. Under the standard C parameter conventions, this field is returned in register <I>[EAX]</I>. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ddUpper</I> </P></TD><TD VALIGN="TOP"><P>Returns special flags about the mapping operation. Under the standard C parameter conventions, this field is returned in register <I>[EDX]</I>. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Mapping Flag Values:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><B>MAP_FLAG_LOSS</B> </P></TD><TD VALIGN="TOP"><P>Indicates that a loss occurred during the conversion. This will typically happen if the BCS character has no corresponding character in the unicode character set. The replacement character for this case is the underscore character '_', ASCII code 0x5f. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>MAP_FLAG_TRUNCATE</B> </P></TD><TD VALIGN="TOP"><P>Indicates that the destination buffer was not large enough to contain the converted BCS string. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>pBCSStr</I> </P></TD><TD VALIGN="TOP"><P>Filled in with the converted BCS string. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P></P>
<P></P></FONT></BODY></HTML>
