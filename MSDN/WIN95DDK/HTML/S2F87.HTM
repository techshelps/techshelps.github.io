<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Driver Initialization and Registration</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H2>Driver Initialization and Registration </H2><P>To initialize the port driver, the IOS sends a SYS_DYNAMIC_DEVICE_INIT message to the driver's control procedure. When the driver receives the message, the driver must register with the IOS by passing the address of it's <B>DRP</B> structure to the <B>IOS_Register</B> service. The port driver must set at least these <B>DRP </B>members: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>DRP_LGN</B> </P></TD><TD VALIGN="TOP"><P>The load group number for the port driver should be one of these values: DRP_MISC_PD, DRP_ESDI_PD, DRP_ESDIEMUL_PD, DRP_ABIOS_PD, or DRP_ABIOS_PREMPT_PD. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>DRP_aer</B> </P></TD><TD VALIGN="TOP"><P>A port driver must provide an asynchronous event routine. The routine must handle these asynchronous event functions: AEP_INITIALIZE, AEP_CONFIG_DCB, AEP_DEVICE_INQUIRY, AEP_IOP_TIMEOUT, and AEP_BOOT_COMPLETE. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>DRP_ilb</B> </P></TD><TD VALIGN="TOP"><P>A port driver must provide an <B>ILB</B> structure to receive the addresses of the IOS service routines. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>Most port drivers also set the <B>DRP_eyecatch_str</B>, <B>DRP_ascii_name</B>, <B>DRP_revision</B>, <B>DRP_feature_code</B>, and <B>DRP_if_requirements</B> members. </P>
<P>After the <B>IOS_Register</B> service returns, the port driver must check the <B>DRP_reg_result</B> member for the values DRP_REMAIN_RESIDENT or DRP_MINIMIZE to determine whether the registration was successful. If success, the port driver clears the carry flag before returning to indicate that it successfully processed the SYS_DYNAMIC_DEVICE_INIT message. If <B>DRP_reg_result</B> is any other value, an error occurred and the port driver must set the carry flag before returning. </P>
<P>See also <B>DRP</B>, <B>IOS_Register</B> </P></FONT></BODY></HTML>
