<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Polling</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Polling </H3><P>Polling is another method of determining SCSI request completion. This method is not recommended. After the command is sent and ASPI for Win32 returns control back to the calling application, you can then poll the status byte waiting for the command to complete. For example, the following code segment will execute a SCSI Inquiry command to target #2 using polling. </P>
<P><BR></P>
<PRE> SRB_ExecSCSICmd6 MySRB;
 DWORD ASPIStatus;
 char InquiryBuffer[32];   
  .
  .
 /**************************************************/
 /* Code is entered with 'MySRB' zeroed.
 /**************************************************/
 MySRB.SRB_Cmd     = SC_EXEC_SCSI_CMD;
 MySRB.SRB_Flags     = SRB_DIR_SCSI;
 MySRB.SRB_Target     = 2;
 MySRB.SRB_BufLen     = 32;
 MySRB.SRB_SenseLen    = SENSE_LEN;
 MySRB.SRB_BufPointer   = InquiryBuffer;
 MySRB.SRB_CDBLen     = 6;
 MySRB.CDBByte[0]     = SCSI_INQUIRY;
 MySRB.CDBByte[4]     = 32;
  .
  .
 ASPIStatus      = SendASPI32Command ( (LPSRB) &amp;MySRB );
                // Send Inquiry command
 while ( MySRB.SRB_Status == SS_PENDING );   // Wait till it's finished
</PRE></FONT></BODY></HTML>
