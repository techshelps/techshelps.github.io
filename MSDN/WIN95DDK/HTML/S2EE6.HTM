<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>GetPrinterDriver</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>GetPrinterDriver </H3><P><BR></P>
<PRE>BOOL GetPrinterDriver(
HANDLE  hPrinter,   /* printer object                        */
LPTSTR  lpszEnv,    /* address of environment                */
DWORD   dwLevel,    /* structure level                       */
LPBYTE  lpbDrvInfo, /* address of structure array            */
DWORD   cbBuf,      /* size, in bytes, of array              */
LPDWORD lpdwNeeded  /* addr. of variable with count of bytes */
                    /* retrieved (or required)               */
);
</PRE>
<P>Retrieves driver data for the specified printer. </P>
<UL><LI>     If the function succeeds, the return value is <B>TRUE</B>; otherwise, it is <B>FALSE</B>. To get extended error information, use the <B>GetLastError</B> function. </LI></UL><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>hPrinter</I> </P></TD><TD VALIGN="TOP"><P>Identifies the printer for which to retrieve driver data. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpszEnv</I> </P></TD><TD VALIGN="TOP"><P>Points to a null-terminated string that specifies the environment. For example, "Windows 96 x86" specifies Windows 96 running on an Intel(r) 80386 or 80486 processor. If this string is NULL, the current environment of the caller/client (not of the destination/server) is used. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>dwLevel</I> </P></TD><TD VALIGN="TOP"><P>Specifies the version of the structure to which <I>lpbDrvInfo</I> points. This value must be either 1 or 2. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpbDrvInfo</I> </P></TD><TD VALIGN="TOP"><P>Points to either a <B>DRIVER_INFO_1</B> or a <B>DRIVER_INFO_2</B> structure. If <I>dwLevel</I> is 1, this array receives a <B>DRIVER_INFO_1</B> structure; if <I>dwLevel</I> is 2, this array receives a <B>DRIVER_INFO_2</B> structure. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>cbBuf</I> </P></TD><TD VALIGN="TOP"><P>Specifies the size, in bytes, of the array at which <I>lpbDrvInfo</I> points. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>lpdwNeeded</I> </P></TD><TD VALIGN="TOP"><P>Points to a value that specifies the number of bytes copied if the function succeeds or the number of bytes required if <I>cbBuf</I> is too small. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>The printer handle <I>hPrinter</I> is obtained by calling the <B>OpenPrinter</B> function. </P>
<P>The <B>DRIVER_INFO_2</B> structure contains a full path and filename that specifies the location of the printer driver. An application can use the path and filename to load a printer driver by calling the <B>LoadLibrary</B> function and supplying the path and filename as the single argument. </P></FONT></BODY></HTML>
