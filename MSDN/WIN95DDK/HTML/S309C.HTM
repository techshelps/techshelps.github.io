<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>File System Driver Interface</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>File System Driver Interface </H3><P>The interface to the FSD routines are defined as a C language callable interface so that the File System Driver VxD may be written in C, if desired. The FSD routines will only be called by the IFS Manager, either directly or via the filesystem api hookers, if any. </P>
<P>Each FSD routine takes a single pointer as an input parameter. This pointer refers to an I/O request structure that defines input and output parameters for the FSD routines. On entry to an FSD routine, the I/O request structure is filled in by the IFS Manager with the parameters relevant to the specific request. </P>
<P>The FSD routine then performs its function and fills in the required result information in the I/O request structure before returning. </P>
<P>The following are the parameters that exist in the I/O request structure that is passed to the FSD routines. Many of these parameters are overlayed with others to clarify the parameter names and compress the passed structure to a smaller size. For a further description of the basic structures, the reader is referred to the include file <B>ifs</B>.<B>h</B>. </P>
<P><B>I/O Request Structure Parameters:</B> </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>unsigned int </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_length</I> </P></TD><TD VALIGN="TOP"><P>Length of user buffer for reads/writes. This field is also overlayed with the following fields on other calls: </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_attr</I> </P></TD><TD VALIGN="TOP"><P>Attribute information for path-based calls. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_pathSkip</I> </P></TD><TD VALIGN="TOP"><P>Number of path elements consumed by a Connect operation. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>unsigned char </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_flags</I> </P></TD><TD VALIGN="TOP"><P>Miscellaneous status flags for various operations. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>uid_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_user</I> </P></TD><TD VALIGN="TOP"><P>User ID for a filesystem request. This field is overlayed with the following fields on certain calls: </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_drivenum</I> </P></TD><TD VALIGN="TOP"><P>Logical drive number, used for mounting a drive. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>sfn_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_sfn</I> </P></TD><TD VALIGN="TOP"><P>System File Number. This value is provided to the FSD only as a unique identifier for the file. The specific value and its meaning are private to the IFS Manager and should not be interpreted by the FSD. This field can be overlayed with other fields on some calls: </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_lananum</I> </P></TD><TD VALIGN="TOP"><P>Lan Address Number. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_tuna</I> </P></TD><TD VALIGN="TOP"><P>Used for tunnelling information. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>pid_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_pid</I> </P></TD><TD VALIGN="TOP"><P>Process ID of requesting task. This value is provided to the FSD only as a unique identifier for the process. The specific value and its meaning are private to the IFS Manager and should not be interpreted by the FSD. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>path_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_ppath</I> </P></TD><TD VALIGN="TOP"><P>Pointer to pathname. Pathnames are not restricted to the DOS 8.3 format, they may be longnames. The pathnames are passed in as unicode strings. The pathnames are also in canonical form that makes it easier for FSDs to walk the path. This format has been described in section 8.3.1. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>aux_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_aux1</I> </P></TD><TD VALIGN="TOP"><P>This structure is used for miscellaneous parameters and is a union of different field types. The field definitions overlayed with this particular field are as follows: </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="102pt" VALIGN="TOP"><COL WIDTH="102pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>ubuffer_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_data2</I> </P></TD><TD VALIGN="TOP"><P>Pointer to secondary data buffer used on some apis. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>vfunc_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_vfunc</I> </P></TD><TD VALIGN="TOP"><P>Pointer to volume function table. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>hfunc_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_hfunc</I> </P></TD><TD VALIGN="TOP"><P>Pointer to handle function table. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>path_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_ppath2</I> </P></TD><TD VALIGN="TOP"><P>Pointer to second unicode pathname passed in on some apis. The format is identical to ir_ppath. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>unsigned long </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_volh</I> </P></TD><TD VALIGN="TOP"><P>Pointer to volume handle on mount calls. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>ubuffer_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_data</I> </P></TD><TD VALIGN="TOP"><P>Pointer to user data buffer. This field is overlayed with the following field: </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_ptuninfo</I> </P></TD><TD VALIGN="TOP"><P>Pointer to tunnelling information. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>unsigned short </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_options</I> </P></TD><TD VALIGN="TOP"><P>Request handling options. This field is overlayed with the following fields: </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_sectors</I> </P></TD><TD VALIGN="TOP"><P>Contains sectors per cluster value. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_status</I> </P></TD><TD VALIGN="TOP"><P>Contains status information for named pipes. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>unsigned short </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_error</I> </P></TD><TD VALIGN="TOP"><P>Error code (0 if OK). </P></TD></TR><TR><TD VALIGN="TOP"><P><B>rh_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_rh</I> </P></TD><TD VALIGN="TOP"><P>FSD Resource Handle. This handle is private to the FSD and is not interpreted by the IFS Manager. It is used to identify the disk volume, or network resource connection where the I/O operation is to be performed. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>fh_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_fh</I> </P></TD><TD VALIGN="TOP"><P>FSD File Handle. This handle is private to the FSD and is not interpreted by the IFS Manager. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>pos_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_pos</I> </P></TD><TD VALIGN="TOP"><P>File position for request. This is an offset into the file relative to the beginning of the file. This field is overlayed with the following other fields: </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_size</I> </P></TD><TD VALIGN="TOP"><P>Initial size of file, used on creates and truncates. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_conflags</I> </P></TD><TD VALIGN="TOP"><P>Flags used for connect operations. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_attr2</I> </P></TD><TD VALIGN="TOP"><P>Second set of attributes, used on Rename calls. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>aux_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_aux2</I> </P></TD><TD VALIGN="TOP"><P>This structure is used for miscellaneous parameters and is a union of different field types. The field definitions overlayed with this particular field are as follows: </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="102pt" VALIGN="TOP"><COL WIDTH="102pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>unsigned long </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_numfree</I> </P></TD><TD VALIGN="TOP"><P>Number of free clusters value. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>unsigned long </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_locklen</I> </P></TD><TD VALIGN="TOP"><P>Record length for region locking. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>unsigned int </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_msglen</I> </P></TD><TD VALIGN="TOP"><P>Message length value for named pipes and mailslots. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>dos_time </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_dostime</I> </P></TD><TD VALIGN="TOP"><P>DOS date value. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>unsigned long </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_timeout</I> </P></TD><TD VALIGN="TOP"><P>Timeout value. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>void * </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_password</I> </P></TD><TD VALIGN="TOP"><P>Pointer to password data for connect operations. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>unsigned short </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_prtlen</I> </P></TD><TD VALIGN="TOP"><P>Length of printer setup string. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>unsigned short </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_prtflags</I> </P></TD><TD VALIGN="TOP"><P>Various printer flags. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>unsigned long </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_firstclus</I> </P></TD><TD VALIGN="TOP"><P>First cluster of a file. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>unsigned long </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_mntdrv</I> </P></TD><TD VALIGN="TOP"><P>Driveletter for mount operation. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>void * </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_cregptr</I> </P></TD><TD VALIGN="TOP"><P>Pointer to client register structure. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>string_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_uFName</I> </P></TD><TD VALIGN="TOP"><P>Pointer to case-preserved filename in unicode. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>aux_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_aux3</I> </P></TD><TD VALIGN="TOP"><P>This structure is used for miscellaneous parameters and is a union of different field types. The field definitions overlayed with this particular field are as follows: </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="102pt" VALIGN="TOP"><COL WIDTH="102pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>string_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_upath</I> </P></TD><TD VALIGN="TOP"><P>Pointer to unparsed pathname in unicode. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>void * </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_scratch</I> </P></TD><TD VALIGN="TOP"><P>Scratch buffer for special calls to network FSDs. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>pevent </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_pev</I> </P></TD><TD VALIGN="TOP"><P>Pointer to event structure for asynchronous requests. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>fsdwork_t </B></P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_fsd</I> </P></TD><TD VALIGN="TOP"><P>Available space for FSD use. The structure is 16 dwords in size and may be defined as desired by the FSD. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P></FONT></BODY></HTML>
