<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_RegQueryValue</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>_RegQueryValue </H3><P><BR></P>
<PRE>include vmm.h

LONG _RegQueryValue(HKEY hkey, LPTSTR lpszSubKey, LPTSTR lpszValue, 
    PLONG pcbValue)
</PRE>
<P>Retrieves the value associated with the unnamed value for a specified key in the registry. See the documentation for the Win32 function of the same name for additional information. </P>
<UL><LI>     Returns ERROR_SUCCESS if the function succeeds. Otherwise, an error code is returned, possibly one of the following: </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>ERROR_KEY_DELETED </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>ERROR_MORE_DATA </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>ERROR_BADKEY </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>ERROR_REGISTRY_IO_FAILED </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>ERROR_REGISTRY_CORRUPT </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>ERROR_BADDB </P></TD><TD VALIGN="TOP"><P></P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P><I>hkey</I> </P>
<P>Handle of an open key or one of the predefined keys: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>HKEY_CLASSES_ROOT </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>HKEY_CURRENT_USER </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>HKEY_LOCAL_MACHINE </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>HKEY_USERS </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>HKEY_CURRENT_CONFIG </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>HKEY_DYN_DATA </P></TD><TD VALIGN="TOP"><P></P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>lpszSubKey</I> </P>
<P>Address of string that contains name of the subkey of the <I>hkey </I>parameter for which a value is to be retrieved. </P>
<P><I>lpszValue</I> </P>
<P>Address of string that contains name of the subkey of the <I>hkey </I>parameter for which a value is to be retrieved. If this parameter is NULL and <I>pcbValue</I> is not NULL this service returns ERROR_SUCCESS and returns the size of the buffer needed the variable pointed to by <I>pcbValue</I>. </P>
<P><I>pcbValue</I> </P>
<P>Address of variable specifying the size, in bytes, of the <I>lpszValue </I>buffer. The buffer should be big enough to contain the terminating null character. On return, the variable contains the size of the data copied to the buffer. If the passed in size is not big enough, the variable will contain the size needed and ERROR_MORE_DATA will be returned. </P>
<P>Of the predefined key values, only HKEY_LOCAL_MACHINE and HKEY_DYN_DATA are available to VxDs during initialization time. The entire registry space can only be accessed after VxD initialization is complete. </P>
<P></P>
<P></P></FONT></BODY></HTML>
