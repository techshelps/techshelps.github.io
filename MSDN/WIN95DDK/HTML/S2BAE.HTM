<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Returning Information in an MCI Structure</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Returning Information in an MCI Structure </H3><P>When you use an MCI structure to return integer information that also has a string equivalent, MCI needs the string ID to find it in the resource table. The high-order word of the return member is set to the string ID. The low-order word of the return member is set to the return value. You can use the <B>MAKEMCIRESOURCE</B> macro to combine these values. For example, the follow statement assigns information for the songpointer format to the return member: </P>
<P><BR></P>
<PRE>lpStatus-&gt;dwReturn = MAKEMCIRESOURCE(MCI_SEQ_FORMAT_SONGPTR,
    MCI_SEQ_FORMAT_SONGPTR_S);
</PRE>
<P>Many of the return values defined in MMSYSTEM.H also have a string resource ID defined in MMDDK.H. Identifiers which are only used for return values and are not input parameters will normally have only one version (they do not have a resource identifier with the _S suffix). The following string resource IDs are defined by MMDDK.H: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="216pt" VALIGN="TOP"><COL WIDTH="132pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>String Resource ID </B></P></TD><TD VALIGN="TOP"><P><B>MCI Constant </B></P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_FORMAT_BYTES_S </P></TD><TD VALIGN="TOP"><P>MCI_FORMAT_BYTES </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_FORMAT_FRAMES_S </P></TD><TD VALIGN="TOP"><P>MCI_FORMAT_FRAMES </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_FORMAT_HMS_S </P></TD><TD VALIGN="TOP"><P>MCI_FORMAT_HMS </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_FORMAT_MILLISECONDS_S </P></TD><TD VALIGN="TOP"><P>MCI_FORMAT_MILLISECONDS </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_FORMAT_MSF_S </P></TD><TD VALIGN="TOP"><P>MCI_FORMAT_MSF </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_FORMAT_SAMPLES_S </P></TD><TD VALIGN="TOP"><P>MCI_FORMAT_SAMPLES </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_FORMAT_SMPTE_24_S </P></TD><TD VALIGN="TOP"><P>MCI_FORMAT_SMPTE_24 </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_FORMAT_SMPTE_25_S </P></TD><TD VALIGN="TOP"><P>MCI_FORMAT_SMPTE_25 </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_FORMAT_SMPTE_30_S </P></TD><TD VALIGN="TOP"><P>MCI_FORMAT_SMPTE_30 </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_FORMAT_SMPTE_30DROP_S </P></TD><TD VALIGN="TOP"><P>MCI_FORMAT_SMPTE_30DROP </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_FORMAT_TMSF_S </P></TD><TD VALIGN="TOP"><P>MCI_FORMAT_TMSF </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_SEQ_FILE_S </P></TD><TD VALIGN="TOP"><P>MCI_SEQ_FILE </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_SEQ_FORMAT_SONGPTR_S </P></TD><TD VALIGN="TOP"><P>MCI_SEQ_FORMAT_SONGPTR </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_SEQ_MAPPER_S </P></TD><TD VALIGN="TOP"><P>MCI_SEQ_MAPPER </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_SEQ_MIDI_S </P></TD><TD VALIGN="TOP"><P>MCI_SEQ_MIDI </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_SEQ_NONE_S </P></TD><TD VALIGN="TOP"><P>MCI_SEQ_NONE </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_SEQ_SMPTE_S </P></TD><TD VALIGN="TOP"><P>MCI_SEQ_SMPTE </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_VD_FORMAT_TRACK_S </P></TD><TD VALIGN="TOP"><P>MCI_VD_FORMAT_TRACK </P></TD></TR><TR><TD VALIGN="TOP"><P>MIDIMAPPER_S </P></TD><TD VALIGN="TOP"><P>MIDIMAPPER </P></TD></TR><TR><TD VALIGN="TOP"><P>WAVE_FORMAT_PCM_S </P></TD><TD VALIGN="TOP"><P>WAVE_FORMAT_PCM </P></TD></TR><TR><TD VALIGN="TOP"><P>WAVE_MAPPER_S </P></TD><TD VALIGN="TOP"><P>WAVE_MAPPER </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>MCI uses the high-order word of the <B>DriverProc</B> return value to tell <B>mciSendString</B> how to convert the information returned in the MCI structure into string form. (The <B>mciSendString</B> function translates the string interface used by an application to the command interface used by your device driver.) The following flags are defined for the high-order word of the <B>DriverProc</B> return value: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="216pt" VALIGN="TOP"><COL WIDTH="132pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Flag </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_RESOURCE_RETURNED </P></TD><TD VALIGN="TOP"><P>Indicates the high-order word of the value in the return member is a string resource ID. This ID is translated by <B>mciSendString</B> by loading the specified resource. </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_RESOURCE_DRIVER </P></TD><TD VALIGN="TOP"><P>Indicates the high-order word of the value in the return member is a string resource ID defined by the device driver. This flag requires MCI_RESOURCE_RETURNED. </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_COLONIZED3_RETURN | MCI_COLONIZED4_RETURN </P></TD><TD VALIGN="TOP"><P>Indicates that when the <B>DWORD</B> value in the return member is converted into a string, its individual bytes should be separated by colons. </P></TD></TR><TR><TD VALIGN="TOP"><P>MCI_INTEGER_RETURNED </P></TD><TD VALIGN="TOP"><P>Indicates that the value in a structure that allows either integer or string returns is an integer value. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>Integer return values which have resource string equivalents are indicated by setting the MCI_RESOURCE_RETURNED bit in the error return. This indicates that the high-order word of the value in the return member is a string ID to load. An application that uses <B>mciSendCommand</B> to call your driver will not see the high-order word of the return value when you return MCI_RESOURCE_RETURNED. When this flag is set, MCI will clear the high-order word of the return member before it returns to the application. Using the high-order word for resource data restricts the integer return value to the 16-bits of the low-order word. The following code fragment sets the MCI_RESOURCE_RETURNED bit for the <B>DriverProc</B> return value: </P>
<P><BR></P>
<PRE>lpStatus-dwReturn = MAKEMCIRESOURCE(MCI_SEQ_FORMAT_SONGPTR,
    MCI_SEQ_FORMAT_SONGPTR_S);
return MCI_RESOURCE_RETURNED;
</PRE>
<P>If your device driver defines the resource string, use the MCI_RESOURCE_DRIVER flag with the MCI_RESOURCE_RETURNED flag. </P>
<P>If your device driver returns information in the return member that should be separated by colons when it is displayed, use the MCI_COLONIZED3_RETURN or MCI_COLONIZED4_RETURN flag. For example, 0x01020304 is "colonized" as "4:3:2" for MCI_COLONIZED3_RETURN or "4:3:2:1" for MCI_COLONIZED4_RETURN. </P>
<P>If the return member of the structure can return either integer or string values, and your device driver is returning an integer value, use the MCI_INTEGER_RETURNED flag in the <B>DriverProc</B> return value. For example, the <B>sysinfo</B> command can return both string and integer data. When this flag is set, the returned integer is converted into a string equivalent by <B>mciSendString</B>. </P>
<P>Structures that return string data or RECT data do not require that you set any flags in the return value for <B>DriverProc</B>. </P></FONT></BODY></HTML>
