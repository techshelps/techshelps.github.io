<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Hardware Design</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>Hardware Design </H3><P>When designing ISA Plug and Play, Plug and Play BIOS's, or other Plug and Play compatible hardware, the vendor must consider the supporting software requirements. The primary rule is that a logical device must be functionally independent. </P>
<P>If you need to maintain compatibility with existing driver sets, you must use the logical device breakdown and resource sets described in the following topics. </P>
<H4><A NAME="sec0"></A>Logical Devices </H4><P>The defined resource sets of the supported multimedia devices provide a logical device breakdown and account for the sometimes hidden dependencies inherent in the hardware design. </P>
<P>To determine if you should define a logical device, you must answer the question: "Does the resource set describe an independently functional device?" If yes, create a logical device. If no, you will need to merge these resources with the other components required to start and/or support this device. </P>
<P>The reason for this requirement is that there is no bus-independent method for a driver to determine the association of one logical device with another or which physical device contains the logical device. This reasserts the definition of a logical device: a logical device is functionally independent. </P>
<P>For example, a sound card could contain many functions: a 16-bit audio component (including internal FM synthesis and external MIDI), a joystick adapter, a SCSI adapter, and a second independent DAC for compatibility with other cards. The immediate response is to define a logical device for each of the functionally independent components. This is not necessary if the device is software-configurable, however. Instead of allowing each child component to configure the device independently, the parent retrieves the entire resource set and applies the configuration to the hardware. The Configuration Manager creates the child devices using subsets of the resources of the parent. Although this example is a special case, it serves the purpose of demonstrating the sometimes subtle dependencies of hardware devices. </P>
<P>Following is a list of general rules to use when determining if a resource set is an independent logical device: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="223pt" VALIGN="TOP"><COL WIDTH="124pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>Internal hardware mixer dependencies </P></TD><TD VALIGN="TOP"><P>The most common example of this is the support of the FM synthesis device. Plug and Play devices most often include this I/O resource with the "audio" logical device. Most of the legacy device drivers shipped with Windows 95 adjust their mixer resources on the basis of whether an associated FM device is present. The determination of the FM association is the inclusion or exclusion of the I/O resource for the FM synthesis chip in "audio" logical device resource set. </P></TD></TR><TR><TD VALIGN="TOP"><P>Interrupt sharing </P></TD><TD VALIGN="TOP"><P>An example of this strategy is Creative Lab's Sound Blaster 16-bit audio series. The MPU-401, 8-bit ADC/DAC and 16-bit ADC/DAC share a single interrupt. Consequently, the logical device descriptor for the Sound Blaster 16 includes the resources for the MPU-401 and wave audio devices. </P></TD></TR><TR><TD VALIGN="TOP"><P>Multiple register planes using a single I/O path </P></TD><TD VALIGN="TOP"><P>The dependency of these designs is the I/O path (ADC/DAC). For example, the register planes provide the hardware interface for Sound Blaster compatibility and Windows Sound System compatibility, but are mutually exclusive such that register planes contend for the I/O path. Thus, the register planes are not functionally independent. Appropriate management of these register planes requires hardware contention management per device node. </P></TD></TR><TR><TD VALIGN="TOP"><P>DSP based solutions </P></TD><TD VALIGN="TOP"><P>These devices require special consideration when designing the logical device structure. For more information, see . </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<H4><A NAME="sec1"></A>Resource Organization </H4><P>The following table contains specific resource ordering for specific components of each device. </P>
<P></P>
<P><B>Note </B></P>
<P>The resource sets for following multimedia devices are order dependent, particularly within a class of resource. The drivers included with Windows 95 parse the resource set based on class, size and ordinal of the resource. </P>
<P> </P>
<P>The location of these components in I/O space is not a criterion for the parsing algorithm. This allows the device to "float" in I/O space when all optimal resource settings are in conflict. </P>
<P></P>

<TABLE COLS="5" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="50pt" VALIGN="TOP"><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="72pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Device ID </B></P></TD><TD VALIGN="TOP"><P><B>Manufacturer </B></P></TD><TD VALIGN="TOP"><P><B>Product </B></P></TD><TD VALIGN="TOP"><P><B>Resource Descriptor </B></P></TD><TD VALIGN="TOP"><P><B>Example </B></P></TD></TR><TR><TD VALIGN="TOP"><P>*AZT1605 </P></TD><TD VALIGN="TOP"><P>Aztech Labs </P></TD><TD VALIGN="TOP"><P>Sound Galaxy Nova 16 </P></TD><TD VALIGN="TOP"><P>I/O size 16 </P>
<P> microcontroller </P>
<P>I/O size 8 </P>
<P> WSS compatible </P>
<P>I/O size 4 </P>
<P> YMF262 </P>
<P>IRQ (SB compat.) </P>
<P>IRQ (WSS compat.) </P>
<P>DMA (SB compat.) </P>
<P>DMA (WSS compat.) </P></TD><TD VALIGN="TOP"><P>220-22F </P>
<P> </P>
<P>530-537 </P>
<P> </P>
<P>388-38B </P>
<P> </P>
<P>3, 5, 7 or 9 </P>
<P>7, 9, 10 or 11 </P>
<P>0, 1 or 3 </P>
<P>0, 1 or 3 </P></TD></TR><TR><TD VALIGN="TOP"><P>*AZT1608 </P></TD><TD VALIGN="TOP"><P>Aztech Labs </P></TD><TD VALIGN="TOP"><P>Sound Galaxy Pro 16 </P></TD><TD VALIGN="TOP"><P>TBD </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>*AZT2316 </P></TD><TD VALIGN="TOP"><P>Aztech Labs </P></TD><TD VALIGN="TOP"><P>Sound Galaxy Washington 16 </P></TD><TD VALIGN="TOP"><P>same as *AZT1605 </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>*ESS1481 </P></TD><TD VALIGN="TOP"><P>ESS Technology, Inc. </P></TD><TD VALIGN="TOP"><P>ES1488 AudioDrive </P></TD><TD VALIGN="TOP"><P>I/O size 16 </P>
<P> microcontroller </P>
<P>I/O size 2 or 4 </P>
<P> Yamaha 3812 or </P>
<P> YMF262 </P>
<P>IRQ </P>
<P>DMA </P></TD><TD VALIGN="TOP"><P>220-22F </P>
<P> </P>
<P>388-38B </P>
<P> </P>
<P> </P>
<P>3, 5, 7. or 9 </P>
<P>1 or 3 </P></TD></TR><TR><TD VALIGN="TOP"><P>*ESS1681 </P></TD><TD VALIGN="TOP"><P>ESS Technology, Inc. </P></TD><TD VALIGN="TOP"><P>ES1688 AudioDrive </P></TD><TD VALIGN="TOP"><P>I/O size 16 </P>
<P> microcontroller </P>
<P>I/O size 4 </P>
<P> YMF262 compat. </P>
<P>I/O size 2 </P>
<P> MPU-401 compat </P>
<P>IRQ </P>
<P>IRQ </P>
<P> (MPU-401 compat) </P>
<P>DMA </P></TD><TD VALIGN="TOP"><P>220-22F </P>
<P> </P>
<P>388-38B </P>
<P> </P>
<P>330-331 </P>
<P> </P>
<P>5, 7, 9 or 10 </P>
<P> </P>
<P>5, 7, 9, 10, or 11 </P>
<P>1 or 3 </P></TD></TR><TR><TD VALIGN="TOP"><P>*ESS4881 </P></TD><TD VALIGN="TOP"><P>ESS Technology, Inc. </P></TD><TD VALIGN="TOP"><P>ES488 AudioDrive </P></TD><TD VALIGN="TOP"><P>I/O size 16 </P>
<P> microcontroller </P>
<P>I/O size 2 or 4 </P>
<P> Yamaha 3812 or </P>
<P> YMF262 compat. </P>
<P>IRQ </P>
<P>DMA </P></TD><TD VALIGN="TOP"><P>220-22F </P>
<P> </P>
<P>388-38B </P>
<P> </P>
<P> </P>
<P>3, 5, 7 or 9 </P>
<P>1 or 3 </P></TD></TR><TR><TD VALIGN="TOP"><P>*ESS6881 </P></TD><TD VALIGN="TOP"><P>ESS Technology, Inc. </P></TD><TD VALIGN="TOP"><P>ES688 AudioDrive </P></TD><TD VALIGN="TOP"><P>I/O size 16 </P>
<P> microcontroller </P>
<P>I/O size 4 </P>
<P> YMF262 compat. </P>
<P>IRQ </P>
<P>DMA </P></TD><TD VALIGN="TOP"><P>220-22F </P>
<P> </P>
<P>388-38B </P>
<P> </P>
<P>5, 7, 9 or 10 </P>
<P>1 or 3 </P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB000 </P></TD><TD VALIGN="TOP"><P>Creative Labs </P></TD><TD VALIGN="TOP"><P>Sound Blaster 1.0 </P></TD><TD VALIGN="TOP"><P>I/O size 16 </P>
<P> microcontroller </P>
<P>I/O size 16 </P>
<P> (alias of 220-22F) </P>
<P>IRQ </P>
<P>DMA </P></TD><TD VALIGN="TOP"><P>220-22F </P>
<P> </P>
<P>380-38F </P>
<P> </P>
<P>3, 5, 7 or 9 </P>
<P>1 </P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB001 </P></TD><TD VALIGN="TOP"><P>Creative Labs </P></TD><TD VALIGN="TOP"><P>Sound Blaster 2.0 </P></TD><TD VALIGN="TOP"><P>I/O size 16 </P>
<P> microcontroller </P>
<P>I/O size 2 </P>
<P> Yamaha 3812 </P>
<P>IRQ </P>
<P>DMA </P></TD><TD VALIGN="TOP"><P>220-22F </P>
<P> </P>
<P>388-389 </P>
<P> </P>
<P>3, 5, 7 or 9 </P>
<P>1 </P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB002 </P></TD><TD VALIGN="TOP"><P>Creative Labs </P></TD><TD VALIGN="TOP"><P>Sound Blaster Pro </P></TD><TD VALIGN="TOP"><P>I/O size 16 </P>
<P> microcontroller </P>
<P>I/O size 2 or 4 </P>
<P> Yamaha 3812 or </P>
<P> YMF262 </P>
<P>IRQ </P>
<P>DMA </P></TD><TD VALIGN="TOP"><P>220-22F </P>
<P> </P>
<P>388-38B </P>
<P> </P>
<P> </P>
<P>3, 5, 7 or 9 </P>
<P>1 </P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB003 </P></TD><TD VALIGN="TOP"><P>Creative Labs </P></TD><TD VALIGN="TOP"><P>Sound Blaster 16 / AWE 32 </P></TD><TD VALIGN="TOP"><P>I/O size 16, </P>
<P> microcontroller </P>
<P>I/O size 2 </P>
<P> MPU-401 compat. </P>
<P>I/O size 4 </P>
<P> YMF262 </P>
<P>IRQ </P>
<P>DMA (byte) </P>
<P>DMA (word) </P></TD><TD VALIGN="TOP"><P>220-22F </P>
<P> </P>
<P>330-331 </P>
<P> </P>
<P>388-38B </P>
<P> </P>
<P>5, 7, 9 or 10 </P>
<P>0, 1 or 3 </P>
<P>5, 6 or 7 </P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB004 </P></TD><TD VALIGN="TOP"><P>Media Vision </P></TD><TD VALIGN="TOP"><P>Thunder Board </P></TD><TD VALIGN="TOP"><P>same as *PNPB001 </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB005 </P></TD><TD VALIGN="TOP"><P>Ad Lib </P></TD><TD VALIGN="TOP"><P>Ad Lib OPL2 (Yamaha 3812) </P></TD><TD VALIGN="TOP"><P>I/O size 2 </P></TD><TD VALIGN="TOP"><P>388-389 </P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB006 </P></TD><TD VALIGN="TOP"><P>Roland </P></TD><TD VALIGN="TOP"><P>MPU-401 </P></TD><TD VALIGN="TOP"><P>I/O size 2 </P>
<P>IRQ </P></TD><TD VALIGN="TOP"><P>330-331 </P>
<P>3, 4, 5, 7, 9 or 10 </P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB007 </P></TD><TD VALIGN="TOP"><P>Microsoft </P></TD><TD VALIGN="TOP"><P>Windows Sound System </P></TD><TD VALIGN="TOP"><P>I/O size 4 or 8 </P>
<P>I/O size 4 </P>
<P>IRQ </P>
<P>DMA </P></TD><TD VALIGN="TOP"><P>534-537 </P>
<P>388-38B </P>
<P>7, 9, 10 or 11 </P>
<P>0, 1 or 3 </P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB008 </P></TD><TD VALIGN="TOP"><P>Compaq </P></TD><TD VALIGN="TOP"><P>Business Audio </P></TD><TD VALIGN="TOP"><P>same as *PNPB007 </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB00B </P></TD><TD VALIGN="TOP"><P>Media Vision </P></TD><TD VALIGN="TOP"><P>Pro Audio 3D </P></TD><TD VALIGN="TOP"><P>I/O size 1 </P>
<P> wake-up port / </P>
<P> joystick </P>
<P>I/O size 2 </P>
<P> ID &amp; control registers </P>
<P>I/O size 16 </P>
<P> microcontroller </P>
<P>I/O size 4 </P>
<P> YMF 262 </P>
<P>I/O size 2 </P>
<P> MPU-401 compat. </P>
<P>IRQ </P>
<P>IRQ </P>
<P> (MPU-401 compat.) </P>
<P>DMA (byte) </P>
<P>DMA (word) </P></TD><TD VALIGN="TOP"><P>201-201 </P>
<P> </P>
<P> </P>
<P>380-381 </P>
<P> </P>
<P>220-22F </P>
<P> </P>
<P>388-38B </P>
<P> </P>
<P>330-331 </P>
<P> </P>
<P>3, 5, 7, 9 or 10 </P>
<P>3, 5, 7 or 9 </P>
<P> </P>
<P>1 or 3 </P>
<P>5 or 7 </P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB00D </P></TD><TD VALIGN="TOP"><P>Media Vision </P></TD><TD VALIGN="TOP"><P>Pro Audio Spectrum 16 </P></TD><TD VALIGN="TOP"><P>contact Microsoft </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB00E </P></TD><TD VALIGN="TOP"><P>Media Vision </P></TD><TD VALIGN="TOP"><P>Pro Audio Spectrum 16 with SCSI (Zilog chipset) </P></TD><TD VALIGN="TOP"><P>contact Microsoft </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB00F </P></TD><TD VALIGN="TOP"><P>Media Vision </P></TD><TD VALIGN="TOP"><P>Jazz - 16 or Pro Audio Deluxe </P></TD><TD VALIGN="TOP"><P>same as *PNPB00B </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB010 </P></TD><TD VALIGN="TOP"><P>Orchid </P></TD><TD VALIGN="TOP"><P>Vidiola </P></TD><TD VALIGN="TOP"><P>I/O size 2 </P>
<P>memory size 32k </P>
<P>IRQ </P></TD><TD VALIGN="TOP"><P>500-501 </P>
<P>d8000-dffff </P>
<P>5, 7, 10, 11, 12, 14 </P>
<P> or 15 </P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB020 </P></TD><TD VALIGN="TOP"><P>Ad Lib / Yamaha </P></TD><TD VALIGN="TOP"><P>YMF262 (OPL3) </P></TD><TD VALIGN="TOP"><P>I/O size 4 </P></TD><TD VALIGN="TOP"><P>388-38B </P></TD></TR><TR><TD VALIGN="TOP"><P>*PNPB02F </P></TD><TD VALIGN="TOP"><P>Microsoft </P></TD><TD VALIGN="TOP"><P>Generic Joystick </P></TD><TD VALIGN="TOP"><P>I/O size 1 </P></TD><TD VALIGN="TOP"><P>201-201 </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<H5><A NAME="sec2"></A>Windows Sound System Resource Descriptors </H5><P>Plug and Play implementations of the Windows Sound System designs should not include the "AutoSelect" range (for example: 530-533) in the base I/O resource descriptor. The reported range for the base address should be the CODEC only. Thus, a resource set for an ISA Plug and Play implementation of a WSS compatible device would contain: </P>
<UL><LI>     I/O size 4 for AD1848/CS4248 or compatible CODEC (534-537) </LI><LI>     I/O size 4 for YMF262 (388-38B) </LI><LI>     IRQ and DMA. </LI></UL><P></P>
<P>If the implementation provides additional hardware support for Sound Blaster compatibility and shares the DAC/ADC I/O path and IRQ/DMA resources with the WSS register plane (such as the Crystal Semiconductor CS4232 design), the resource set should contain both the CODEC and the Sound Blaster compatibility resources, as follows: </P>
<UL><LI>     I/O size 4 for AD1848/CS4248 or compatible CODEC (534-537) </LI><LI>     I/O size 4 for YMF262 (388-38B) </LI><LI>     I/O size 16 for Sound Blaster compatibility (220-22F) </LI><LI>     IRQ and DMA. </LI></UL><P></P>
<P>Again, please note that the above I/O resources structures are order-dependent. The standard device drivers shipped with Windows 95 handle the above cases correctly. </P>
<H5><A NAME="sec3"></A>ESS AudioDrive Resource Descriptors </H5><P>If your hardware implementation uses the ESS reference designs without modification, you may use the listed ESS device IDs as compatible device tags. However, if your implementation deviates from the ESS reference design, particularly with IRQ and DMA steering, you will need to create your own .INF files and include special IRQ/DMA steering information in these files. Please contact ESS Technology, Inc. or the Microsoft Hardware Vendor Relations Group for further information. </P>
<H4><A NAME="sec4"></A>Shared Resources </H4><P>When a design requires shared resources between functions such as an IRQ between the audio and SCSI functions on a PCMCIA design, the .INF file for the device implements multiple function definitions which allow child devices to be created from subsets of the parent's resources. </P>
<H4><A NAME="sec5"></A>DSP Based Solutions </H4><P>DSP-based solutions face numerous obstacles when implemented as ISA Plug and Play devices: </P>
<UL><LI>     The devices on a DSP based design tend to be dependent on the "parent" DSP device such that code must be present on the DSP for the various register planes to respond properly. </LI><LI>     DSPs are dynamic in nature. However, ISAPNP establishes a device with a static resource set. </LI><LI>     Because of the nature of Plug and Play, separate functions cannot have dependencies on other functions, because ISAPNP does not guarantee initialization order of the enumerated devices. The following statements support this claim: 

<UL><LI>     Logical devices are, by definition, independent. There is no bus independent method to determine the association of a device node with a parent board. </LI><LI>     Dependent components cannot determine when the supporting DSP initializes or relocates. </LI><LI>     Dependent components do not receive notification when a supporting device is disabled. </LI></UL></LI></UL><P></P>
<P></P>
<P>The solution to these problems is to include all the resources in a single device function and using the multiple function support in Windows 95 to create the child devices from a subset of the resources. The "multiple function" specification, as described elsewhere in the Windows 95 DDK, allows a parent/child relationship between device nodes. </P>
<P>For an example of multiple function support, please investigate the parent/child relationships established in WAVE.INF for the Media Vision Pro Audio Spectrum 16 cards (device IDs *PNPB00D and *PNPB00E). </P>
<P>An alternative solution is to write a private enumerator for your DSP based device. Please contact the Microsoft Hardware Vendor Relationship Group for details. </P>
<H4><A NAME="sec6"></A>Plug and Play BIOS Considerations </H4><P>Be sure to register appropriate device IDs and resource structures in your Plug and Play BIOS for machines with on-board multimedia devices. In other words, just because an on-board device is compatible with Sound Blaster does not mean that the BIOS should report the *PNPB001 device ID. </P>
<P>To determine the appropriate IDs, first determine the chipset manufacturer (such as Analog Devices, Creative Labs, ESS, and so on) and then match the resource IDs using the table provided in . You may report the device ID from this table or you may register your own ID and report the device ID from the table as a compatible ID. However, if you register your own device ID and this ID is not included in the standard .INF files or is not included in the OEM's implementation of Windows 95, the user will be prompted with a dialog box and given the option to select the compatible device or select from a list of other devices. </P>
<P>If the device is partially software configurable (such as the Windows Sound System or ES688 and ES1688 reference designs), you have some options for the reported device structure: </P>
<UL><LI>     You may report only the fixed resources in the boot configuration and allow the Configuration Manager to fill in the remaining required resources determined by the dependent functions. The Configuration Manager will determine the highest priority and most feasible dependent function to fill. </LI><LI>     You may report all of the resources in the boot configuration and require a restart to apply a new configuration (this option is not recommended). </LI></UL><P></P>
<P>Note that BIOS is expected to configure these software configurable resources to match the resulting configuration. </P></FONT></BODY></HTML>
