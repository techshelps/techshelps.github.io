<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NPGetPolicyPath</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>NPGetPolicyPath </H3><P>This function is used to determine the default location and filename for a policy file on a given network. The path should be one which network administrators can write to, but users cannot. The directory should also allow unvalidated connections, since policies are retrieved prior to logon. (If unvalidated connections are not available, then policies will be downloaded after user logon and not all settings will take effect immediately.) </P>
<P><BR></P>
<PRE>DWORD NPGetPolicyPath(
  LPTSTR lpPath,
  LPDWORD lpBufferSize,
  DWORD dwFlags
  );
</PRE>
<P><I>lpPath</I> </P>
<P>Points to a buffer to receive the path and filename of the policy file. This will be either in UNC or drive-relative form, whichever is supported by the network. </P>
<P><I>lpBufferSize</I> </P>
<P>This is used to specify the size of the buffer passed in. If the call fails because the buffer is not big enough, this location is used to return the required buffer size. </P>
<P><I>dwFlags</I> </P>
<P>Any combination of the following values: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>GPP_LOADBALANCE </P></TD><TD VALIGN="TOP"><P>The NP should pick a load-balancing policy path if it supports it. Normally the policy path should be to a known location on a single server, but if the load-balancing flag is set and the NP has a pool of servers that it may use, it should do so. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<UL><LI>     WN_SUCCESS if the call is successful. Otherwise, <B>GetLastError</B> should be called for extended error information. </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>WN_MORE_DATA </P></TD><TD VALIGN="TOP"><P>The buffer is too small. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P></FONT></BODY></HTML>
