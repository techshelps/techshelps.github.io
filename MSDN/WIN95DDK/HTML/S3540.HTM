<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>VCache_FindBlock</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>VCache_FindBlock </H3><P>Looks up data in virtual cache and can create a buffer if one is not found. Always uses EAX, ESI, and flags. If creating a buffer, ECX and EDX are also used. </P>
<UL><LI>     Returns information in the following locations: </LI></UL>
<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Location </B></P></TD><TD VALIGN="TOP"><P><B>Contents or settings </B></P></TD></TR><TR><TD VALIGN="TOP"><P>Carry flag </P></TD><TD VALIGN="TOP"><P>Set if the block is not found. Clear if the block is found. </P></TD></TR><TR><TD VALIGN="TOP"><P>ESI </P></TD><TD VALIGN="TOP"><P>contains the cache block handle if the block is found or created. Otherwise, ESI contains the value zero. </P></TD></TR><TR><TD VALIGN="TOP"><P>Zero flag </P></TD><TD VALIGN="TOP"><P>set if the buffer is not locked. </P></TD></TR><TR><TD VALIGN="TOP"><P>EAX </P></TD><TD VALIGN="TOP"><P>contains the address of the buffer if ESI is nonzero. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P>When a buffer is created, the value of its FSD private fields are set to zero. </P>
<P>On entry, AL contains one or more of the following options that determine how <B>VCache_FindBlock</B> acts: </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="204pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Option </B></P></TD><TD VALIGN="TOP"><P><B>Description </B></P></TD></TR><TR><TD VALIGN="TOP"><P>VCFB_Create </P></TD><TD VALIGN="TOP"><P>create buffer if not found </P></TD></TR><TR><TD VALIGN="TOP"><P>VCFB_Hold </P></TD><TD VALIGN="TOP"><P>hold buffer if found </P></TD></TR><TR><TD VALIGN="TOP"><P>VCFB_LowPri </P></TD><TD VALIGN="TOP"><P>low priority create </P></TD></TR><TR><TD VALIGN="TOP"><P>VCFB_MakeMRU </P></TD><TD VALIGN="TOP"><P>make buffer most recently used </P></TD></TR><TR><TD VALIGN="TOP"><P>VCFB_MustCreate </P></TD><TD VALIGN="TOP"><P>creation must succeed if there are any clean, unheld buffers (only valid with VCFB_Create) </P></TD></TR><TR><TD VALIGN="TOP"><P>VCFB_RemoveFromLRU </P></TD><TD VALIGN="TOP"><P>remove buffer from LRU list entirely (for buffers that will be held for a long time). Cannot be used with VCFB_MakeMRU. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P>Other options are obsolete and ignored. </P>
<P>On entry, AH contains the file system identifier. </P>
<P>On entry, EBX contains key1 information that includes the sector and byte #. </P>
<P>On entry, EDI contains key2 information that includes the volume id and file id. </P>
<P>NOTE: (0, 0) is not a valid key value. </P>
<P></P>
<P></P></FONT></BODY></HTML>
