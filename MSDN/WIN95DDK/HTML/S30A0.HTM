<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FS_ConnectNetResource</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>FS_ConnectNetResource </H3><P><BR></P>
<PRE>FS_ConnectNetResource(
 PIOREQ pir
 )
</PRE>
<P>A connection is made to a network resource through <B>FS_ConnectNetResource</B>. </P>
<P><I>ir_ppath</I> </P>
<P>Supplies a pointer to the canonicalized unicode network resource pathname to connect to. The pathname may contain more than just the network resource address name. Wildcards are not allowed on the pathname. </P>
<P><I>ir_password</I> </P>
<P>Supplies an optional pointer to the security credentials needed to connect to the network resource, otherwise this is set to NULL. Note that the password is passed in whatever format the user passed to the IFS manager, it is not converted to unicode format. </P>
<P><I>ir_options</I> </P>
<P>Supplies connection options. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Connection Option Values:</B> </P>
<P>One of the following options will be specified. </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><B>RESOPT_UNCREQUEST</B> </P></TD><TD VALIGN="TOP"><P>UNC style path based anonymous connection request. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>RESOPT_DEVATTACH</B> </P></TD><TD VALIGN="TOP"><P>Explicit device redirection. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>RESOPT_UNCCONNECT</B> </P></TD><TD VALIGN="TOP"><P>Explicit UNC style connection. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>RESOPT_DISCONNECTED</B> </P></TD><TD VALIGN="TOP"><P>Connection is to be setup disconnected, without touching the net. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>RESOPT_NO_CREATE</B> </P></TD><TD VALIGN="TOP"><P>Do not create a resource for this connection, just verify the connection exists. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>RESOPT_STATIC</B> </P></TD><TD VALIGN="TOP"><P>This connection is established at startup and disconnected only at shutdown, no user apis can disconnect it. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>ir_flags</I> </P>
<P>Supplies resource type. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Connection Resource Type Values:</B> </P>
<P>One of the following resource types will be specified. </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><B>RESTYPE_WILD</B> </P></TD><TD VALIGN="TOP"><P>Wild card resource type. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>RESTYPE_DISK</B> </P></TD><TD VALIGN="TOP"><P>Disk resource. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>RESTYPE_SPOOL</B> </P></TD><TD VALIGN="TOP"><P>Spooled printer resource. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>RESTYPE_CHARDEV</B> </P></TD><TD VALIGN="TOP"><P>Character device resource. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>RESTYPE_IPC</B> </P></TD><TD VALIGN="TOP"><P>Interprocess communication resource. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>ir_fh</I> </P>
<P>Supplies the IFS system resource handle for the network resource connection. This is passed back in to the IFS manager on certain calls. The FSD should not attempt to interpret this in any fashion, it is provided only for identification purposes. </P>
<P><I>ir_uFname</I> </P>
<P>Pointer to the case-preserved filename component in unicode. </P>
<P><I>ir_upath</I> </P>
<P>Pointer to the unparsed user pathname in unicode. </P>
<P><I>ir_user</I> </P>
<P>Supplies user id for this request. </P>
<P><I>ir_lananum</I> </P>
<P>Supplies the LAN address number, which is typically used only for mailslots. The ifs manager does not store this value. </P>
<P><I>ir_conflags</I> </P>
<P>Indicates whether the connect operation was initiated via a user api request or via an FSD directly. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Connection Flag Values:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><B>FALSE</B> </P></TD><TD VALIGN="TOP"><P>The connection has been initiated by a user api request. </P></TD></TR><TR><TD VALIGN="TOP"><P><B>TRUE</B> </P></TD><TD VALIGN="TOP"><P>The connection has been initiated via an FSD request. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P><I>ir_pid</I> </P>
<P>Supplies process id for this request. </P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P>     <I>ir_fh</I> </P></TD><TD VALIGN="TOP"><P>Returns the previous IFS system resource handle if the specified resource was previously connected. If this is a new connection, then the FSD should leave this field unchanged. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_rh</I> </P></TD><TD VALIGN="TOP"><P>Returns the handle to the network resource that a connection was made to. This handle is used to identify an existing connection and is passed back to the provider during file operations on the network resource. The value of this handle is not interpreted by the Win32 or INT 21h Managers, it is only used to identify the network resource. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_pathSkip</I> </P></TD><TD VALIGN="TOP"><P>Number of path elements consumed by the connect operation. The IFS manager then parses the rest of the path based on this return value. Typically, the network FSD will consume the servername and sharename components of the passed in path. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_flags</I> </P></TD><TD VALIGN="TOP"><P>Returns the correct resource type if the resource type passed in on the request was <B>RESTYPE_WILD</B>. For all other values of the resource type, this field need not be updated by the FSD. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>ir_vfunc</I> </P></TD><TD VALIGN="TOP"><P>Returns a pointer to a function table, in the FSD, containing a list of the FSD name based file I/O entry points. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Function Table Structure:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_version</I> </P></TD><TD VALIGN="TOP"><P>IFS version number. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_revision</I> </P></TD><TD VALIGN="TOP"><P>IFS interface revision number. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_size</I> </P></TD><TD VALIGN="TOP"><P>Number of function entry points in table. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[NUM_VOLFUNC]</I> </P></TD><TD VALIGN="TOP"><P>Array of pointers to volume-based functions as described below: </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><B>Volume Based Functions:</B> </P></TD><TD VALIGN="TOP"><P></P></TD></TR><TR><TD VALIGN="TOP"><P><B>Value </B></P></TD><TD VALIGN="TOP"><P><B>Meaning </B></P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[VFN_DELETE]</I> </P></TD><TD VALIGN="TOP"><P>Pointer to FS_DeleteFile function. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[VFN_DIR]</I> </P></TD><TD VALIGN="TOP"><P>Pointer to FS_Dir function. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[VFN_FILEATTRIB]</I> </P></TD><TD VALIGN="TOP"><P>Pointer to FS_FileAttributes function. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[VFN_FLUSH]</I> </P></TD><TD VALIGN="TOP"><P>Pointer to FS_FlushVolume function. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[VFN_GETDISKINFO]</I> </P></TD><TD VALIGN="TOP"><P>Pointer to FS_GetDiskInfo function. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[VFN_OPEN]</I> </P></TD><TD VALIGN="TOP"><P>Pointer to FS_OpenFile function. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[VFN_RENAME]</I> </P></TD><TD VALIGN="TOP"><P>Pointer to FS_RenameFile function. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[VFN_SEARCH]</I> </P></TD><TD VALIGN="TOP"><P>Pointer to FS_SearchFile function. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[VFN_QUERY]</I> </P></TD><TD VALIGN="TOP"><P>Pointer to FS_QueryResourceInfo function. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[VFN_DISCONNECT]</I> </P></TD><TD VALIGN="TOP"><P>Pointer to FS_DisconnectNetResource function. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[VFN_UNCPIPEREQUEST]</I> </P></TD><TD VALIGN="TOP"><P>Pointer to FS_NamedPipeRequest function for named pipes. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[VFN_IOCTL16DRIVE]</I> </P></TD><TD VALIGN="TOP"><P>Pointer to FS_Ioctl16Drive function. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[VFN_GETDISKPARMS]</I> </P></TD><TD VALIGN="TOP"><P>Function not defined for network resources, FSD must return pointer to error function. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[VFN_FINDOPEN]</I> </P></TD><TD VALIGN="TOP"><P>Pointer to function for FS_FindFirstFile function. </P></TD></TR><TR><TD VALIGN="TOP"><P><I>vfn_func[VFN_DASDIO]</I> </P></TD><TD VALIGN="TOP"><P>Function not supported for network resources, FSD must return pointer to error function. </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="144pt" VALIGN="TOP"><COL WIDTH="190pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><P><I>ir_error</I> </P></TD><TD VALIGN="TOP"><P>Returns status of the operation ( 0 if no error, errorcode otherwise ). </P></TD></TR></TBODY></TABLE>
<P><BR></P><P></P>
<P></P>
<P>This function will be called for each connection made to the network resource. The same network resource handle should be returned for multiple connections to a single network resource. </P>
<P></P>
<P></P></FONT></BODY></HTML>
