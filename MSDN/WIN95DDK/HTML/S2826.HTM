<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>VDD_Get_Mini_Dispatch_Table</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H3>VDD_Get_Mini_Dispatch_Table </H3><P><B>Call With</B></P>
<P>None </P>
<P><B>Return Values</B></P>
<P>ECX contains the number of mini-VDD Hookable Functions in the table. EDI contains the 32 bit linear address of the mini-VDD dispatch table. All other registers are preserved. </P>
<P><B>Remarks</B></P>
<P>This function can only be called up to and including the <B>Init_Complete </B>phase of VxD initialization. It will cause a fatal page fault if called after <B>Init_Complete</B>. </P>
<P>This service is used by all mini-VDD's in order to hook the callouts that the Main VDD provides to the mini-VDD. The mini-VDD calls this service and then uses the <B>MiniVDDDispatch</B> macro (found in MINIVDD.INC) to install the addresses of the routines that it wants to hook. The mini-VDD that calls this service should check the value returned in ECX against the number of functions that it intends to hook. If the value returned in ECX is less than the number of functions that the mini-VDD intends to hook, the mini-VDD should fail to load since trying to set a hook that the Main VDD does not understand would cause a GP Fault. If the value returned in ECX is greater than or equal to the number of functions that the mini-VDD intends to hook, then the mini-VDD can proceed to hook functions safely. Thus, the value returned in ECX can be used as a version check against using a Main VDD that is older than the MINIVDD.INC that the mini-VDD was compiled with. Refer to any of the example mini-VDD's to see howa mini-VDD installs its hook functions. </P>
<P></P>
<P></P></FONT></BODY></HTML>
