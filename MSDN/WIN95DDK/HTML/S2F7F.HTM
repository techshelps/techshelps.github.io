<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Virtual Device Requirements</TITLE><META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset= iso-8859-1"><style>@import url(/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="/msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">
<FONT FACE="verdana,arial,helvetica" SIZE="2">
<H2>Virtual Device Requirements </H2><P>A VSD must be a dynamically loadable virtual device that defines a control procedure but does not define services or APIs. The control procedure must process the SYS_DYNAMIC_DEVICE_INIT message. All other messages can be ignored. </P>
<P>The driver must have device name, a major and minor version number, and an initialization order. Although unique names are not required, a name that uniquely identifies the type of adapter supported by the driver is recommended. The initialization order for the driver must be UNDEFINED_INIT_ORDER. </P>
<P>The following example shows a typical virtual device declaration for a VSD: </P>
<P><BR></P>
<PRE>DECLARE_VIRTUAL_DEVICE HELPVSD,\
    HELPVSD_MAJOR_VERSION, \
    HELPVSD_MINOR_VERSION,\
    HelpVSD_Control,,\
    UNDEFINED_INIT_ORDER\
    ,,,Drv_Reg_Pkt
</PRE>
<P>In this example, Drv_Reg_Pkt is the name of the <B>DRP</B> structure (also known as the device registration packet) for the driver. The <B>DRP</B> structure is required for loading and registration. The following example is a typical <B>DRP</B> definition: </P>
<P><BR></P>
<PRE>Drv_Reg_Pkt    DRP &lt;EyeCatcher, DRP_VSD_9, offset32 Help_Async_Request,\
    offset32 vsd_ilb, HelpVSDName, HelpVSDRev, HelpVSDFeature,\
    HelpVSD_IF&gt;
</PRE>
<P>For successful loading, at least the <B>DRP_LGN </B>member of the structure must be set at when the driver is assembled. Other members must be set to zero if not initialized to valid values. </P>
<P>The I/O supervisor (IOS) loads and initializes all VSDs. To ensure that the IOS locates the driver, the VSD file must have the filename extension .VXD and the file must be placed in the SYSTEM\IOSUBSYS directory. </P>
<P></P>
<P><B>Warning </B></P>
<P>Do not use a device entry in the SYSTEM.INI file to load a VSD. </P>
<P></P>
<P>See also <B>DRP</B> </P></FONT></BODY></HTML>
