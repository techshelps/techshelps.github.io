<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>More window relationships</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<font face="verdana,arial,helvetica" size="2"><h1><a name="morewindowrelationships"></a>More window relationships</h1>
<p>
IterateChildWindows illustrates how to traverse the window tree with Get&shy;Window. Table 6-3 on the facing page describes some of the other window <BR>relationships.</p>
<p>
Except for “owner,” all these relationships should be obvious. The owner of a window is the window that is notified when something happens to the first window. You can get a better feel for this by browsing the outline in WinWatch’s Window Hierarchy box. Most windows in the hierarchy don’t have an owner, but a dialog box is owned by the window that launched it. The main Visual Basic window containing the menus and the toolbar is the owner of all the other windows—toolbox, project, properties, and code windows.</p>
<p>
If you look at the internal data stored for a window (see “Inside CWindow” page 301), you’ll see that only three relatives are stored for each window: the parent, the next sibling, and the first child. (The owner isn’t a relative, strictly speaking.) You won’t see a first, last, or previous sibling, even though Windows provides the GW_HWNDFIRST, GW_HWNDLAST, and GW_HWNDPREV constants. Each of these relationships can be calculated from the given data. For example, the first sibling is actually the first child of the parent. The last sibling is the first sibling’s next sibling’s next sibling until the sibling with no next.</p>
<table>
<tr valign=top>
<td>
<b>Operation</b></td>
<td>
<b>Description</b></td>
</tr>
<tr valign=top>
<td>
GetWindow with GW_HWNDFIRST</td>
<td>
Get the first sibling</td>
</tr>
<tr valign=top>
<td>
GetWindow with GW_HWNDLAST</td>
<td>
Get the last sibling</td>
</tr>
<tr valign=top>
<td>
GetWindow with GW_HWNDNEXT</td>
<td>
Get the next sibling</td>
</tr>
<tr valign=top>
<td>
GetWindow with GW_HWNDPREV</td>
<td>
Get the previous sibling</td>
</tr>
<tr valign=top>
<td>
GetWindow with GW_CHILD</td>
<td>
Get the first child</td>
</tr>
<tr valign=top>
<td>
GetWindow with GW_OWNER</td>
<td>
Get the owner</td>
</tr>
<tr valign=top>
<td>
GetNextWindow</td>
<td>
Get the next or previous sibling</td>
</tr>
<tr valign=top>
<td>
GetTopWindow</td>
<td>
Get the top-level window of a specified window</td>
</tr>
<tr valign=top>
<td>
GetDesktopWindow</td>
<td>
Get the desktop (the top of the window tree)</td>
</tr>
<tr valign=top>
<td>
GetParent</td>
<td>
Get the parent</td>
</tr>
<tr valign=top>
<td>
SetParent</td>
<td>
Change the parent of a window</td>
</tr>
<tr valign=top>
<td>
IsChild</td>
<td>
Indicate whether two windows are parent and child</td>
</tr>
</table><br>
<p>
<b>Table 6-3.&nbsp;Window relationships.</b></p>
</font></BODY>
</HTML>
