<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The API Contract</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<font face="verdana,arial,helvetica" size="2"><h1><a name="theapicontract"></a>The API Contract</h1>
<p>
You can think of the interface between Basic and the Windows API as a legal contract. On the one side, Basic wishes to acquire certain services and resources. On the other side, the Windows API is in the business of providing those services and resources. However, since each party is providing information that could be dangerous to the other, and since the parties don’t speak the same language, both feel the need for a legal contract spelling out the terms and limits of the transaction.</p>
<p>
The Windows API provides its side of the contract as part of the specifications of its DLLs. These are spelled out in the API documentation and are partially enforced by the actual DLL interfaces. Visual Basic submits a legal request in the form of a Declare statement. It checks the declaration against the DLL interface and rejects anything incompatible.</p>
<p>
As any lawyer can tell you, it’s impossible to fully specify the terms of a transaction in a legal contract. You try to define everything you can think of and handle the rest on an ad hoc basis. If something goes wrong, you can sue after the fact. Unfortunately, “lawsuits” in the Windows world often end up as unhandled exceptions, general protection faults, unrecoverable application errors, and cold boots. The next sections explain how far the API contract goes and how to avoid conflicts in areas the law doesn’t cover.</p>
</font></BODY>
</HTML>
