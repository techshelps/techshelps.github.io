<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Getting File Interface Information</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<font face="verdana,arial,helvetica" size="2"><h1><a name="gettingfileinterfaceinformation"></a>Getting File Interface Information</h1>
<p>
Open up Windows Explorer, and set the display mode to <i>Details</i>. You’ll see some information that we all know how to get as well as some you probably haven’t seen before and don’t know how to deal with in Visual Basic.</p>
<p>
Notice that Windows Explorer lists some filenames with extensions and some without. Actually, Windows Explorer isn’t showing filenames at all. You are seeing display names, which you can get by calling the SHGetFileInfo API function. Windows creates a display name based on information registered for the file document type. If a file doesn’t have a registered document type, the shell will report the full filename, including the extension, as the display name. Generally, Windows uses the extension to determine the document type. In some cases, the system can use a binary pattern in the first part of the file to distinguish documents that have the same extension. COM structured storage files have a file type unrelated to any extension.</p>
<p>
When you get the display name, you can also get other information from SHGet&shy;FileInfo, including the file type string, the file attributes, the executable type, and various forms of large and small icons. All this comes from the registry entry for the document type. (Windows has defaults for files that have no document file type.) SHGetFileInfo will also work on directories, disk drives, and special folder locations such as My Computer, Network Neighborhood, Desktop, and Recycle Bin.</p>
</font></BODY>
</HTML>
