<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Implementing a List Class</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<font face="verdana,arial,helvetica" size="2"><h1><a name="implementinglistclass"></a>Implementing a List Class</h1>
<BR>
There are many ways to implement linked lists, but I chose one of the most simple. Don’t assume, however, that the list will be obvious. The simple class you see before you went through a lot of iterations and a lot of testing to reach its current state.</p>
<BR>
The CList class has the following private members:</p>
<pre><code>Private lnkHead As CLink<BR>Private c As Long</code></pre>
<BR>
The <i>lnkHead </i>member is what makes the list work. The <i>c </i>member is just for counting the members for the Count property. The <i>lnkHead </i>member is the only access to the list; in addition, all new members must be added here. It’s also the only access the CLinkWalker will have. The following Friend property makes the Head available to cooperating classes:</p>
<pre><code>‘ Make data structure available to cooperating classes<BR>Friend Property Get Head() As CLink<BR>    Set Head = lnkHead<BR>End Property</code></pre>
<BR>
The Add method should give you a feel for the implementation:</p>
<pre><code>‘ Insert at head of list<BR>Sub Add(vItem As Variant)<BR>    ‘ Create temporary link with new value<BR>    Dim lnkTmp As CLink<BR>    Set lnkTmp = New CLink<BR>    If IsObject(vItem) Then<BR>        Set lnkTmp.Item = vItem<BR>    Else<BR>        lnkTmp.Item = vItem<BR>    End If<BR>    ‘ Point it where previous head pointed<BR>    Set lnkTmp.NextLink = lnkHead<BR>    ‘ Attach it to front<BR>    Set lnkHead = lnkTmp<BR>    ‘ lnkTmp temporary goes out of scope and disappears<BR>    c = c + 1<BR>End Sub</code></pre>
<BR>
If this code seems confusing, try stepping through it in the TCOLLECT.VBG project. Put watches on the <i>lnkTmp </i>and <i>lnkHead </i>object variables. Watch as the first item is added to the list, and keep watching as more items are added.</p>
<BR>
I could show you more methods and properties, but they wouldn’t make sense until you understand the CListWalker class.</p>
</font></BODY>
</HTML>
