<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The Picture property and the Extraction method</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<font face="verdana,arial,helvetica" size="2"><h1><a name="thepicturepropertyextracticonmethod"></a>The Picture property and the ExtractIcon method</h1>
<p>
The Picture property of the ListImage object simply returns the picture you put into the ImageList. If you put in an icon, you get back an icon; if you put in a bitmap, you get back a bitmap. This works for icons no matter where you place the picture, but bitmaps don’t look good unless they contain a solid image or unless the background of the image is the same as the background of the target picture. This makes the Picture property somewhat inflexible for general use, but of course you can use PaintPicture to do anything you want with it.</p>
<p>
The ExtractIcon method converts an image to an icon. If the image already is an icon, ExtractIcon is the equivalent of the Picture property. With a bitmap, ExtractIcon stretches or compresses it to the standard icon size, as determined by GetSystemMetrics, and uses the MaskColor property of the ImageList to make the image transparent. You can save the result to a file with SavePicture; just make sure that you set the MaskColor property to the color of the bitmap background. To see how this works in Test ImageList, use the Mask Color check box to set different colors that appear in the bitmap. This is a roundabout way to convert a bitmap to an icon. It’s much easier to use ImagEdit, although most bitmaps look terrible when converted to icons. The mechanism would be a lot more flexible if you could convert to an icon of any size (the size of the bitmap, for example). What you really want from ExtractIcon is its transparency, not a standard icon size. More on that later.</p>
</font></BODY>
</HTML>
