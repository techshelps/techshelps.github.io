<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>A little better LoadResPicture</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR=#FFFFFF TEXT=#000000>

<font face="verdana,arial,helvetica" size="2"><h1><a name="alittlebetterloadrespicture"></a>A little better LoadResPicture</h1>
<p>
Since LoadImage can load from resources as well as from files, it’s relatively easy to enhance LoadResPicture in the same way you enhanced LoadPicture. It’s a little more complicated because you have to deal with resources specified by string name or by integer index, but most of the code is the same.</p>
<p>
There is one big difference, however. LoadImage can read icons from resources in an EXE file, but it hasn’t a clue about how to read them in the Visual Basic environment. When you run in the environment, you’re not really running your own program; you’re running VB5.EXE. If you try to load icon resource 25 using the Windows API, you’ll get Visual Basic’s resource 25 or, more likely, you’ll get an error. LoadResPicture knows how to dig your resource out of some internal format known only to Madame Basic’s crystal ball. The best LoadAnyResPicture can do is detect the environment with a function called IsExe and then call the real LoadResPicture. </p>
<p>
You might think that having icons be one size in the environment and another in an EXE would be unworkable. Actually, it’s not so bad. For example, assume that you put multi-image icons in a resource file and then load them into an ImageList control as small icons at run time. You’ll end up with large icons squished to small icons in the environment, but your small icons will come out as small icons in the EXE. You can do the same thing for Image controls by playing with the image size and the Stretch property. It’s an annoying problem for you, but your customers will never be the wiser.</p>
</font></BODY>
</HTML>
