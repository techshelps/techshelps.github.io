<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>On Error Statement</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vastmonerror"></a>On Error Statement</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vastmOnErrorC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vastmOnErrorX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vastmOnErrorS">
</object></p>
<p>
Enables an error-handling routine and specifies the location of the routine within a <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defprocedure">
</object><a href=JavaScript:alink_4.Click()>procedure</a>; can also be used to disable an error-handling routine.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>On Error</b> <b>GoTo</b> <i>line</i> </p>
<p>
<b>On Error</b> <b>Resume Next</b></p>
<p>
<b>On Error</b> <b>GoTo</b> <b>0</b></p>
<p>
The <b>On Error </b>statement syntax can have any of the following forms:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=29%><b>Statement</b></td>
<td class=label width=71%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=29%><b>On Error GoTo</b> <i>line</i> </td>
<td width=71%>Enables the error-handling routine that starts at <i>line</i> specified in the required <i>line</i> <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defarg">
</object><a href=JavaScript:alink_5.Click()>argument</a>. The <i>line</i> argument is any <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="deflinelabel">
</object><a href=JavaScript:alink_6.Click()>line label</a> or <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="deflinenumber">
</object><a href=JavaScript:alink_7.Click()>line number</a>. If a <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defrterr">
</object><a href=JavaScript:alink_8.Click()>run-time error</a> occurs, control branches to <i>line</i>, making the error handler active<i>.</i> The specified <i>line</i> must be in the same procedure as the <b>On Error</b> statement; otherwise, a <object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defcompiletime">
</object><a href=JavaScript:alink_9.Click()>compile-time</a> error occurs.</td>
</tr>
<tr valign=top>
<td width=29%><b>On Error Resume Next</b></td>
<td width=71%>Specifies that when a run-time error occurs, control goes to the <object id=alink_10 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defstatement">
</object><a href=JavaScript:alink_10.Click()>statement</a> immediately following the statement where the error occurred where execution continues. Use this form rather than <b>On Error GoTo</b> when accessing objects.</td>
</tr>
<tr valign=top>
<td width=29%><b>On Error GoTo 0</b></td>
<td width=71%>Disables any enabled error handler in the current procedure.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
If you don't use an <b>On Error</b> statement, any run-time error that occurs is fatal; that is, an error message is displayed and execution stops.</p>
<p>
An "enabled" error handler is one that is turned on by an <b>On Error </b>statement; an "active" error handler is an enabled handler that is in the process of handling an error. If an error occurs while an error handler is active (between the occurrence of the error and a <b>Resume</b>, <b>Exit Sub</b>, <b>Exit Function</b>, or <b>Exit Property</b> statement), the current procedure's error handler can't handle the error. Control returns to the calling procedure. If the calling procedure has an enabled error handler, it is activated to handle the error. If the calling procedure's error handler is also active, control passes back through previous calling procedures until an enabled, but inactive, error handler is found. If no inactive, enabled error handler is found, the error is fatal at the point at which it actually occurred. Each time the error handler passes control back to a calling procedure, that procedure becomes the current procedure. Once an error is handled by an error handler in any procedure, execution resumes in the current procedure at the point designated by the <b>Resume</b> statement.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;An error-handling routine is not a <b>Sub</b> procedure or <b>Function</b> procedure. It is a section of code marked by a line label or line number.</p>
<p>
Error-handling routines rely on the value in the <b>Number</b> property of the <b>Err</b> object to determine the cause of the error. The error-handling routine should test or save relevant property values in the <b>Err</b> object before any other error can occur or before a procedure that might cause an error is called. The property values in the <b>Err</b> object reflect only the most recent error. The error message associated with <b>Err.Number </b>is contained in <b>Err.Description</b>.</p>
<p>
<b>On Error Resume Next</b> causes execution to continue with the statement immediately following the statement that caused the run-time error, or with the statement immediately following the most recent call out of the procedure containing the <b>On Error Resume Next</b> statement. This statement allows execution to continue despite a run-time error. You can place the error-handling routine where the error would occur, rather than transferring control to another location within the procedure. An <b>On Error Resume Next </b>statement becomes inactive when another procedure is called, so you should execute an <b>On Error Resume Next</b> statement in each called routine if you want inline error handling within that routine.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The <b>On Error Resume Next</b> construct may be preferable to <b>On Error GoTo</b> when handling errors generated during access to other objects. Checking <b>Err</b> after each interaction with an object removes ambiguity about which object was accessed by the code. You can be sure which object placed the error code in <b>Err.Number</b>, as well as which object originally generated the error (the object specified in <b>Err.Source</b>).</p>
<p>
<b>On Error GoTo 0</b> disables error handling in the current procedure. It doesn't specify line 0 as the start of the error-handling code, even if the procedure contains a line numbered 0. Without an <b>On Error GoTo 0</b> statement, an error handler is automatically disabled when a procedure is exited.</p>
<p>
To prevent error-handling code from running when no error has occurred, place an <b>Exit Sub</b>, <b>Exit Function</b>, or <b>Exit Property</b> statement immediately before the error-handling routine, as in the following fragment:</p>
<pre><code>Sub InitializeMatrix(Var1, Var2, Var3, Var4)
   On Error GoTo ErrorHandler
<b>   . . .</b>
   Exit Sub
ErrorHandler:
   <b>. . .</b>
   Resume Next
End Sub
</code></pre>
<p>
Here, the error-handling code follows the <b>Exit Sub</b> statement and precedes the <b>End Sub</b> statement to separate it from the procedure flow. Error-handling code can be placed anywhere in a procedure.</p>
<p>
Untrapped errors in objects are returned to the controlling application when the object is running as an executable file. Within the development environment, untrapped errors are only returned to the controlling application if the proper options are set. See your <object id=alink_11 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defhostapplication">
</object><a href=JavaScript:alink_11.Click()>host application's</a> documentation for a description of which options should be set during debugging, how to set them, and whether the host can create <object id=alink_12 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defclass">
</object><a href=JavaScript:alink_12.Click()>classes</a>.</p>
<p>
If you create an object that accesses other objects, you should try to handle errors passed back from them unhandled. If you cannot handle such errors, map the error code in <b>Err.Number</b> to one of your own errors, and then pass them back to the caller of your object. You should specify your error by adding your error code to the <b>vbObjectError</b> constant. For example, if your error code is 1052, assign it as follows:</p>
<pre><code>Err.Number = vbObjectError + 1052
</code></pre>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;System errors during calls to Windows <object id=alink_13 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defdll">
</object><a href=JavaScript:alink_13.Click()>dynamic-link libraries</a> (DLL) do not raise exceptions and cannot be trapped with Visual Basic error trapping. When calling DLL functions, you should check each return value for success or failure (according to the API specifications), and in the event of a failure, check the value in the <b>Err</b> object's <b>LastDLLError</b> property. </p>
</BODY>
</HTML>
