<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Number Property Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="vapronumberx"></a>Number Property Example</h2>
<p>
The first example illustrates a typical use of the <b>Number</b> property in an error-handling routine. The second example examines the <b>Number</b> property of the <b>Err</b> object to determine whether an error returned by an Automation object was defined by the object, or whether it was mapped to an error defined by Visual Basic. Note that the constant <b>vbObjectError</b> is a very large negative number that an object adds to its own error code to indicate that the error is defined by the server. Therefore, subtracting it from <b>Err.Number</b> strips it out of the result. If the error is object-defined, the base number is left in <code>MyError</code>, which is displayed in a message box along with the original source of the error. If <b>Err.Number</b> represents a Visual Basic error, then the Visual Basic error number is displayed in the message box.</p>
<pre><code>' Typical use of Number property
Sub test()
   On Error GoTo out
   
   Dim x, y
   x = 1 / y   ' Create division by zero error
   Exit Sub
   out:
   MsgBox Err.<span class=cfe><b>Number</b></span>
   MsgBox Err.Description
   ' Check for division by zero error
   If Err.Number = 11 Then
      y = y + 1
   End If
   Resume
End Sub



' Using Number property with an error from an 
' Automation object
Dim MyError, Msg
' First, strip off the constant added by the object to indicate one
' of its own errors.
MyError = Err.<span class=cfe><b>Number</b></span> - vbObjectError
' If you subtract the vbObjectError constant, and the number is still 
' in the range 0-65,535, it is an object-defined error code.
If MyError &gt; 0 And MyError &lt; 65535 Then
   Msg = "The object you accessed assigned this number to the error: " _
          &amp; MyError &amp; ". The originator of the error was: " _
         &amp; Err.Source &amp; ". Press F1 to see originator's Help topic."
' Otherwise it is a Visual Basic error number.
Else
   Msg = "This error (# " &amp; Err.<span class=cfe><b>Number</b></span> &amp; ") is a Visual Basic error" &amp; _
         " number. Press Help button or F1 for the Visual Basic Help" _
         &amp; " topic for this error."
End If
   MsgBox Msg, , "Object Error", Err.HelpFile, Err.HelpContext
</code></pre>
</BODY>
</HTML>
