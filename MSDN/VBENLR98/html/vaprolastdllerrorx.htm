<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LastDLLError Property Example</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h2><a name="vaprolastdllerrorx"></a>LastDLLError Property Example</h2>
<p>
When pasted into a <b>UserForm</b> module, the following code causes an attempt to call a DLL function. The call fails because the argument that is passed in (a null pointer) generates an error, and in any event, SQL can’t be cancelled if it isn’t running. The code following the call checks the return of the call, and then prints at the <b>LastDLLError</b> property of the <b>Err</b> object to reveal the error code. On systems without DLLs, <b>LastDLLError</b> always returns zero.</p>
<pre><code>&nbsp;Private Declare Function SQLCancel Lib "ODBC32.dll" _
 (ByVal hstmt As Long) As Integer

Private Sub UserForm_Click()
   Dim RetVal
   ' Call with invalid argument.
   RetVal = SQLCancel(myhandle&amp;)
   ' Check for SQL error code.   
   If RetVal = -2 Then
      'Display the information code.
      MsgBox "Error code is :" &amp; Err.<span class=cfe><b>LastDllError</b></span> 
 &nbsp;&nbsp; End If
End Sub
</code></pre>
</BODY>
</HTML>
