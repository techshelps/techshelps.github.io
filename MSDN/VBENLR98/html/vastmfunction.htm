<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Function Statement</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vastmfunction"></a>Function Statement</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vastmFunctionC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vastmFunctionX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vastmFunctionS">
</object></p>
<p>
Declares the name, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defarg">
</object><a href=JavaScript:alink_4.Click()>arguments</a>, and code that form the body of a <b>Function</b> <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defprocedure">
</object><a href=JavaScript:alink_5.Click()>procedure</a>.</p>
<p class=label>
<b>Syntax</b></p>
<p>
[<b>Public</b> | <b>Private | Friend</b>] [<b>Static</b>] <b>Function</b> <i>name</i> [<b>(</b><i>arglist</i><b>)</b>] [<b>As</b> <i>type</i>]<br>
[<i>statements</i>]<br>
[<i>name</i> <b>=</b> <i>expression</i>]<br>
[<b>Exit Function</b>] <br>
[<i>statements</i>]<br>
[<i>name</i> <b>=</b> <i>expression</i>]</p>
<p>
<b>End Function</b></p>
<p>
The <b>Function</b> statement syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=19%><b>Part</b></td>
<td class=label width=81%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=19%><b>Public</b></td>
<td width=81%>Optional. Indicates that the <b>Function</b> procedure is accessible to all other procedures in all <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defmodule">
</object><a href=JavaScript:alink_6.Click()>modules</a>. If used in a module that contains an <b>Option Private</b>, the procedure is not available outside the <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defproject">
</object><a href=JavaScript:alink_7.Click()>project</a>.</td>
</tr>
<tr valign=top>
<td width=19%><b>Private</b></td>
<td width=81%>Optional. Indicates that the <b>Function</b> procedure is accessible only to other procedures in the module where it is declared.</td>
</tr>
<tr valign=top>
<td width=19%><b>Friend</b></td>
<td width=81%>Optional. Used only in a <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defclassmodule">
</object><a href=JavaScript:alink_8.Click()>class module</a>. Indicates that the <b>Function</b> procedure is visible throughout the project, but not visible to a controller of an instance of an object.</td>
</tr>
<tr valign=top>
<td width=19%><b>Static</b></td>
<td width=81%>Optional. Indicates that the <b>Function</b> procedure's local <object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defvariable">
</object><a href=JavaScript:alink_9.Click()>variables</a> are preserved between calls. The <b>Static</b> attribute doesn't affect variables that are declared outside the <b>Function</b>, even if they are used in the procedure.</td>
</tr>
<tr valign=top>
<td width=19%><i>name</i></td>
<td width=81%>Required. Name of the <b>Function</b>; follows standard variable naming conventions.</td>
</tr>
<tr valign=top>
<td width=19%><i>arglist</i></td>
<td width=81%>Optional. List of variables representing arguments that are passed to the <b>Function</b> procedure when it is called. Multiple variables are separated by commas.</td>
</tr>
<tr valign=top>
<td width=19%><i>type</i></td>
<td width=81%>Optional. <object id=alink_10 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defdatatype">
</object><a href=JavaScript:alink_10.Click()>Data type</a> of the value returned by the <b>Function</b> procedure; may be <object id=alink_11 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defbytedatatype">
</object><a href=JavaScript:alink_11.Click()>Byte</a>, <object id=alink_12 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defbooleandatatype">
</object><a href=JavaScript:alink_12.Click()>Boolean</a>, <object id=alink_13 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defintegerdatatype">
</object><a href=JavaScript:alink_13.Click()>Integer</a>, <object id=alink_14 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="deflong">
</object><a href=JavaScript:alink_14.Click()>Long</a>, <object id=alink_15 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defcurrencydatatype">
</object><a href=JavaScript:alink_15.Click()>Currency</a>, <object id=alink_16 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defsingledatatype">
</object><a href=JavaScript:alink_16.Click()>Single</a>, <object id=alink_17 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defdoubledatatype">
</object><a href=JavaScript:alink_17.Click()>Double</a>, <object id=alink_18 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defdecimaldatatype">
</object><a href=JavaScript:alink_18.Click()>Decimal</a> (not currently supported), <object id=alink_19 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defdatedatatype">
</object><a href=JavaScript:alink_19.Click()>Date</a>, <object id=alink_20 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defstringdatatype">
</object><a href=JavaScript:alink_20.Click()>String</a>, or <b> </b>(except fixed length),<b> </b><object id=alink_21 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectdatatype">
</object><a href=JavaScript:alink_21.Click()>Object</a>, <object id=alink_22 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defvariantdatatype">
</object><a href=JavaScript:alink_22.Click()>Variant</a>, or any <object id=alink_23 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defuserdefinedtype">
</object><a href=JavaScript:alink_23.Click()>user-defined type</a>. </td>
</tr>
<tr valign=top>
<td width=19%><i>statements</i></td>
<td width=81%>Optional. Any group of statements to be executed within the <b>Function</b> procedure.</td>
</tr>
<tr valign=top>
<td width=19%><i>expression</i></td>
<td width=81%>Optional. Return value of the <b>Function</b>.</td>
</tr>
</table><br>
<p>
The <i>arglist</i> argument has the following syntax and parts:</p>
<p>
[<b>Optional</b>] [<b>ByVal</b> | <b>ByRef</b>] [<b>ParamArray</b>] <i>varname</i>[<b>( )</b>] [<b>As</b> <i>type</i>] [<b>=</b> <i>defaultvalue</i>]</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=19%><b>Part</b></td>
<td class=label width=81%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=19%><b>Optional</b></td>
<td width=81%>Optional. Indicates that an argument is not required. If used, all subsequent arguments in <i>arglist</i> must also be optional and declared using the <b>Optional</b> keyword. <b>Optional</b> can't be used for any argument if <b>ParamArray</b> is used.</td>
</tr>
<tr valign=top>
<td width=19%><b>ByVal</b></td>
<td width=81%>Optional. Indicates that the argument is passed <object id=alink_24 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defbyvalue">
</object><a href=JavaScript:alink_24.Click()>by value</a>.</td>
</tr>
<tr valign=top>
<td width=19%><b>ByRef</b></td>
<td width=81%>Optional. Indicates that the argument is passed <object id=alink_25 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defbyreference">
</object><a href=JavaScript:alink_25.Click()>by reference</a>. <b>ByRef</b> is the default in Visual Basic.</td>
</tr>
<tr valign=top>
<td width=19%><b>ParamArray</b></td>
<td width=81%>Optional. Used only as the last argument in <i>arglist</i> to indicate that the final argument is an <b>Optional</b> array of <b>Variant</b> elements. The <b>ParamArray</b> keyword allows you to provide an arbitrary number of arguments. It may not be used with <b>ByVal</b>, <b>ByRef</b>, or <b>Optional</b>.</td>
</tr>
<tr valign=top>
<td width=19%><i>varname</i></td>
<td width=81%>Required. Name of the variable representing the argument; follows standard variable naming conventions.</td>
</tr>
<tr valign=top>
<td width=19%><i>type</i></td>
<td width=81%>Optional. Data type of the argument passed to the procedure; may be <b>Byte</b>, <b>Boolean</b>, <b>Integer</b>, <b>Long</b>, <b>Currency</b>, <b>Single</b>, <b>Double</b>, <b>Decimal</b> (not currently supported) <b>Date</b>, <b>String </b>(variable length only), <b>Object</b>, <b>Variant</b>, or a specific <object id=alink_26 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjecttype">
</object><a href=JavaScript:alink_26.Click()>object type</a>. If the parameter is not <b>Optional</b>, a user-defined type may also be specified.</td>
</tr>
<tr valign=top>
<td width=19%><i>defaultvalue</i></td>
<td width=81%>Optional. Any <object id=alink_27 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defconstant">
</object><a href=JavaScript:alink_27.Click()>constant</a> or constant expression. Valid for <b>Optional</b> parameters only. If the type is an <b>Object</b>, an explicit default value can only be <b>Nothing</b>.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
If not explicitly specified using <b>Public</b>, <b>Private</b>, or <b>Friend</b>, <b>Function</b> procedures are public by default. If <b>Static</b> isn't used, the value of local variables is not preserved between calls. The <b>Friend</b> keyword can only be used in class modules. However, <b>Friend</b> procedures can be accessed by procedures in any module of a project. A <b>Friend</b> procedure does't appear in the <object id=alink_28 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="deftypelibrary">
</object><a href=JavaScript:alink_28.Click()>type library</a> of its parent class, nor can a <b>Friend</b> procedure be late bound.</p>
<p class=indent>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;<b>Function</b> procedures can be recursive; that is, they can call themselves to perform a given task. However, recursion can lead to stack overflow. The <b>Static</b> keyword usually isn't used with recursive <b>Function</b> procedures.</p>
<p>
All executable code must be in procedures. You can't define a <b>Function</b> procedure inside another <b>Function</b>, <b>Sub</b>, or <b>Property</b> procedure.</p>
<p>
The <b>Exit Function </b>statement causes an immediate exit from a <b>Function</b> procedure. Program execution continues with the statement following the statement that called the <b>Function</b> procedure. Any number of <b>Exit Function</b> statements can appear anywhere in a <b>Function</b> procedure.</p>
<p>
Like a <b>Sub</b> procedure, a <b>Function</b> procedure is a separate procedure that can take arguments, perform a series of statements, and change the values of its arguments. However, unlike a <b>Sub</b> procedure, you can use a <b>Function</b> procedure on the right side of an <object id=alink_29 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defexpression">
</object><a href=JavaScript:alink_29.Click()>expression</a> in the same way you use any intrinsic function, such as <b>Sqr</b>, <b>Cos</b>, or <b>Chr</b>, when you want to use the value returned by the function.</p>
<p>
You call a <b>Function</b> procedure using the function name, followed by the argument list in parentheses, in an expression. See the <b>Call</b> statement for specific information on how to call <b>Function</b> procedures.</p>
<p>
To return a value from a function, assign the value to the function name. Any number of such assignments can appear anywhere within the procedure. If no value is assigned to <i>name</i>, the procedure returns a default value: a numeric function returns 0, a string function returns a zero-length string (""), and a <b>Variant</b> function returns <object id=alink_30 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defempty">
</object><a href=JavaScript:alink_30.Click()>Empty</a>. A function that returns an object reference returns <b>Nothing</b> if no object reference is assigned to <i>name</i> (using <b>Set</b>) within the <b>Function</b>.</p>
<p>
The following example shows how to assign a return value to a function named <code>BinarySearch</code>. In this case, <b>False</b> is assigned to the name to indicate that some value was not found.</p>
<pre><code>Function BinarySearch(. . .) As Boolean
<b>. . .</b>
   ' Value not found. Return a value of False.
   If lower &gt; upper Then
      BinarySearch = False
      Exit Function
   End If
<b>. . .</b>
End Function
</code></pre>
<p>
Variables used in <b>Function</b> procedures fall into two categories: those that are explicitly declared within the procedure and those that are not. Variables that are explicitly declared in a procedure (using <b>Dim</b> or the equivalent) are always local to the procedure. Variables that are used but not explicitly declared in a procedure are also local unless they are explicitly declared at some higher level outside the procedure.</p>
<p class=indent>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;A procedure can use a variable that is not explicitly declared in the procedure, but a naming conflict can occur if anything you defined at the <object id=alink_31 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defmodulelevel">
</object><a href=JavaScript:alink_31.Click()>module level</a> has the same name. If your procedure refers to an undeclared variable that has the same name as another procedure, constant, or variable, it is assumed that your procedure refers to that module-level name. Explicitly declare variables to avoid this kind of conflict. You can use an <b>Option Explicit</b> statement to force explicit declaration of variables.</p>
<p class=indent>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;Visual Basic may rearrange arithmetic expressions to increase internal efficiency. Avoid using a <b>Function</b> procedure in an arithmetic expression when the function changes the value of variables in the same expression.</p>
</BODY>
</HTML>
