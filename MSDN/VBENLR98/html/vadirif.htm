<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>#If...Then...#Else Directive</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vadirif"></a>#If...Then...#Else Directive</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vadirIfC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vadirIfX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vadirIfS">
</object></p>
<p>
Conditionally compiles selected blocks of Visual Basic code.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>#If</b> <i>expression</i> <b>Then</b></p>
<p>
<i>statements</i></p>
<p>
[<b>#ElseIf</b> <i>expression-n</i> <b>Then</b></p>
<p>
[<i>elseifstatements</i>]]</p>
<p>
[<b>#Else</b></p>
<p>
[<i>elsestatements</i>]]</p>
<p>
<b>#End If</b></p>
<p>
The <b>#If...Then...#Else</b> directive syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=24%><b>Part</b></td>
<td class=label width=76%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=24%><i>expression</i></td>
<td width=76%>Required. Any <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defexpression">
</object><a href=JavaScript:alink_4.Click()>expression</a>, consisting exclusively of one or more <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defconditionalcompilerconstant">
</object><a href=JavaScript:alink_5.Click()>conditional compiler constants</a>, literals, and operators, that evaluates to <b>True</b> or <b>False</b>.</td>
</tr>
<tr valign=top>
<td width=24%><i>statements</i></td>
<td width=76%>Required. Visual Basic program lines or compiler directives that are evaluated if the associated expression is <b>True</b>.</td>
</tr>
<tr valign=top>
<td width=24%><i>expression-n</i></td>
<td width=76%>Optional. Any expression, consisting exclusively of one or more conditional compiler constants, literals, and operators, that evaluates to <b>True</b> or <b>False</b>.</td>
</tr>
<tr valign=top>
<td width=24%><i>elseifstatements</i></td>
<td width=76%>Optional. One or more program lines or compiler directives that are evaluated if <i>expression-n</i> is <b>True</b>.</td>
</tr>
<tr valign=top>
<td width=24%><i>elsestatements</i></td>
<td width=76%>Optional. One or more program lines or compiler directives that are evaluated if no previous <i>expression</i> or <i>expression-n</i> is <b>True</b>.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
The behavior of the <b>#If...Then...#Else</b> directive is the same as the <b>If...Then...Else</b> statement, except that there is no single-line form of the <b>#If</b>, <b>#Else</b>, <b>#ElseIf</b>, and <b>#End If</b> directives; that is, no other code can appear on the same line as any of the directives. Conditional compilation is typically used to compile the same program for different platforms. It is also used to prevent debugging code from appearing in an executable file. Code excluded during conditional compilation is completely omitted from the final executable file, so it has no size or performance effect.</p>
<p>
Regardless of the outcome of any evaluation, all expressions are evaluated. Therefore, all <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defconstant">
</object><a href=JavaScript:alink_6.Click()>constants</a> used in expressions must be defined — any undefined constant evaluates as <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defempty">
</object><a href=JavaScript:alink_7.Click()>Empty</a>.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;The <b>Option Compare</b> statement does not affect expressions in <b>#If</b> and <b>#ElseIf</b> statements. Expressions in a conditional-compiler directive are always evaluated with <b>Option Compare Text</b>.</p>
</BODY>
</HTML>
