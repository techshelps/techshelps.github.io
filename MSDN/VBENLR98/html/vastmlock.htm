<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Lock, Unlock Statements</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vastmlock"></a>Lock, Unlock Statements</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vastmLockC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vastmLockX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vastmLockS">
</object></p>
<p>
Controls access by other processes to all or part of a file opened using the <b>Open</b> statement.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<b>Lock</b> [<b>#</b>]<i>filenumber</i>[, <i>recordrange</i>]<br>
<b>. . .</b></p>
<p>
<b>Unlock </b>[<b>#</b>]<i>filenumber</i>[, <i>recordrange</i>]</p>
<p>
The <b>Lock</b> and <b>Unlock</b> statement syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=18%><b>Part</b></td>
<td class=label width=82%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=18%><i>filenumber</i></td>
<td width=82%>Required. Any valid <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="deffilenumber">
</object><a href=JavaScript:alink_4.Click()>file number</a>.</td>
</tr>
<tr valign=top>
<td width=18%><i>recordrange</i></td>
<td width=82%>Optional. The range of records to lock or unlock.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
The <i>recordrange</i> <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defarg">
</object><a href=JavaScript:alink_5.Click()>argument</a> settings are:</p>
<p>
<i>recnumber</i> | [<i>start</i>] <b>To</b> <i>end</i></p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=18%><b>Setting</b></td>
<td class=label width=82%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=18%><i>recnumber</i></td>
<td width=82%>Record number (<b>Random</b> mode files) or byte number (<b>Binary</b> mode files) at which locking or unlocking begins.</td>
</tr>
<tr valign=top>
<td width=18%><i>start</i></td>
<td width=82%>Number of the first record or byte to lock or unlock.</td>
</tr>
<tr valign=top>
<td width=18%><i>end</i></td>
<td width=82%>Number of the last record or byte to lock or unlock.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
The <b>Lock</b> and <b>Unlock</b> statements are used in environments where several processes might need access to the same file.</p>
<p>
<b>Lock</b> and <b>Unlock</b> statements are always used in pairs. The arguments to <b>Lock</b> and <b>Unlock</b> must match exactly.</p>
<p>
The first record or byte in a file is at position 1, the second record or byte is at position 2, and so on. If you specify just one record, then only that record is locked or unlocked. If you specify a range of records and omit a starting record (<i>start</i>), all records from the first record to the end of the range (<i>end</i>) are locked or unlocked. Using <b>Lock</b> without <i>recnumber</i> locks the entire file; using <b>Unlock</b> without <i>recnumber</i> unlocks the entire file.</p>
<p>
If the file has been opened for sequential input or output, <b>Lock</b> and <b>Unlock</b> affect the entire file, regardless of the range specified by <i>start</i> and <i>end</i>.</p>
<p class=indent>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;Be sure to remove all locks with an <b>Unlock</b> statement before closing a file or quitting your program. Failure to remove locks produces unpredictable results.</p>
</BODY>
</HTML>
