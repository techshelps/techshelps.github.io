<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Sub Statement</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vastmsub"></a>Sub Statement</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vastmSubC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vastmSubX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vastmSubS">
</object></p>
<p>
Declares the name, <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defarg">
</object><a href=JavaScript:alink_4.Click()>arguments</a>, and code that form the body of a <b>Sub</b> <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defprocedure">
</object><a href=JavaScript:alink_5.Click()>procedure</a>.</p>
<p class=label>
<b>Syntax</b></p>
<p>
[<b>Private</b> | <b>Public</b> | <b>Friend</b>] [<b>Static</b>] <b>Sub</b> <i>name</i> [<b>(</b><i>arglist</i><b>)</b>] <br>
[<i>statements</i>]<br>
[<b>Exit Sub</b>]<br>
[<i>statements</i>]</p>
<p>
<b>End Sub</b></p>
<p>
The <b>Sub</b> statement syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=19%><b>Part</b></td>
<td class=label width=81%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=19%><b>Public</b></td>
<td width=81%>Optional. Indicates that the <b>Sub</b> procedure is accessible to all other procedures in all <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defmodule">
</object><a href=JavaScript:alink_6.Click()>modules</a>. If used in a module that contains an <b>Option Private</b> statement, the procedure is not available outside the <object id=alink_7 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defproject">
</object><a href=JavaScript:alink_7.Click()>project</a>.</td>
</tr>
<tr valign=top>
<td width=19%><b>Private</b></td>
<td width=81%>Optional. Indicates that the <b>Sub</b> procedure is accessible only to other procedures in the module where it is declared.</td>
</tr>
<tr valign=top>
<td width=19%><b>Friend</b></td>
<td width=81%>Optional. Used only in a <object id=alink_8 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defclassmodule">
</object><a href=JavaScript:alink_8.Click()>class module</a>. Indicates that the <b>Sub</b> procedure is visible throughout the <object id=alink_9 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defproject">
</object><a href=JavaScript:alink_9.Click()>project</a>, but not visible to a controller of an instance of an object.</td>
</tr>
<tr valign=top>
<td width=19%><b>Static</b></td>
<td width=81%>Optional. Indicates that the <b>Sub</b> procedure's local <object id=alink_10 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defvariable">
</object><a href=JavaScript:alink_10.Click()>variables</a> are preserved between calls. The <b>Static</b> attribute doesn't affect variables that are declared outside the <b>Sub</b>, even if they are used in the procedure.</td>
</tr>
<tr valign=top>
<td width=19%><i>name</i></td>
<td width=81%>Required. Name of the <b>Sub</b>; follows standard <object id=alink_11 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defvariable">
</object><a href=JavaScript:alink_11.Click()>variable</a> naming conventions.</td>
</tr>
<tr valign=top>
<td width=19%><i>arglist</i></td>
<td width=81%>Optional. List of variables representing arguments that are passed to the <b>Sub</b> procedure when it is called. Multiple variables are separated by commas.</td>
</tr>
<tr valign=top>
<td width=19%><i>statements</i></td>
<td width=81%>Optional. Any group of <object id=alink_12 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defstatement">
</object><a href=JavaScript:alink_12.Click()>statements</a> to be executed within the <b>Sub</b> procedure.</td>
</tr>
</table><br>
<p>
The <i>arglist</i> argument has the following syntax and parts:</p>
<p>
[<b>Optional</b>] [<b>ByVal</b> | <b>ByRef</b>] [<b>ParamArray</b>] <i>varname</i>[<b>( )</b>] [<b>As</b> <i>type</i>] [<b>=</b> <i>defaultvalue</i>]</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=19%><b>Part</b></td>
<td class=label width=81%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=19%><b>Optional</b></td>
<td width=81%>Optional. <object id=alink_13 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defkeyword">
</object><a href=JavaScript:alink_13.Click()>Keyword</a> indicating that an argument is not required. If used, all subsequent arguments in <i>arglist</i> must also be optional and declared using the <b>Optional</b> keyword. <b>Optional</b> can't be used for any argument if <b>ParamArray</b> is used.</td>
</tr>
<tr valign=top>
<td width=19%><b>ByVal</b></td>
<td width=81%>Optional. Indicates that the argument is passed <object id=alink_14 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defbyvalue">
</object><a href=JavaScript:alink_14.Click()>by value</a>.</td>
</tr>
<tr valign=top>
<td width=19%><b>ByRef</b></td>
<td width=81%>Optional. Indicates that the argument is passed <object id=alink_15 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defbyreference">
</object><a href=JavaScript:alink_15.Click()>by reference</a>. <b>ByRef</b> is the default in Visual Basic.</td>
</tr>
<tr valign=top>
<td width=19%><b>ParamArray</b></td>
<td width=81%>Optional. Used only as the last argument in <i>arglist</i> to indicate that the final argument is an <b>Optional</b> <object id=alink_16 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defarray">
</object><a href=JavaScript:alink_16.Click()>array</a> of <b>Variant</b> elements. The <b>ParamArray</b> keyword allows you to provide an arbitrary number of arguments. <b>ParamArray</b> can't be used with <b>ByVal</b>, <b>ByRef</b>, or <b>Optional</b>.</td>
</tr>
<tr valign=top>
<td width=19%><i>varname</i></td>
<td width=81%>Required. Name of the variable representing the argument; follows standard variable naming conventions.</td>
</tr>
<tr valign=top>
<td width=19%><i>type</i></td>
<td width=81%>Optional. <object id=alink_17 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defdatatype">
</object><a href=JavaScript:alink_17.Click()>Data type</a> of the argument passed to the procedure; may be <object id=alink_18 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defbytedatatype">
</object><a href=JavaScript:alink_18.Click()>Byte</a>, <object id=alink_19 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defbooleandatatype">
</object><a href=JavaScript:alink_19.Click()>Boolean</a>, <object id=alink_20 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defintegerdatatype">
</object><a href=JavaScript:alink_20.Click()>Integer</a>, <object id=alink_21 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="deflong">
</object><a href=JavaScript:alink_21.Click()>Long</a>, <object id=alink_22 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defcurrencydatatype">
</object><a href=JavaScript:alink_22.Click()>Currency</a>, <object id=alink_23 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defsingledatatype">
</object><a href=JavaScript:alink_23.Click()>Single</a>, <object id=alink_24 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defdoubledatatype">
</object><a href=JavaScript:alink_24.Click()>Double</a>, <object id=alink_25 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defdecimaldatatype">
</object><a href=JavaScript:alink_25.Click()>Decimal</a> (not currently supported), <object id=alink_26 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defdatedatatype">
</object><a href=JavaScript:alink_26.Click()>Date</a>, <object id=alink_27 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defstringdatatype">
</object><a href=JavaScript:alink_27.Click()>String</a> (variable-length only), <object id=alink_28 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectdatatype">
</object><a href=JavaScript:alink_28.Click()>Object</a>, <object id=alink_29 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defvariantdatatype">
</object><a href=JavaScript:alink_29.Click()>Variant</a>, or a specific <object id=alink_30 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjecttype">
</object><a href=JavaScript:alink_30.Click()>object type</a>. If the parameter is not <b>Optional</b>, a <object id=alink_31 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defuserdefinedtype">
</object><a href=JavaScript:alink_31.Click()>user-defined type</a> may also be specified.</td>
</tr>
<tr valign=top>
<td width=19%><i>defaultvalue</i></td>
<td width=81%>Optional. Any <object id=alink_32 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defconstant">
</object><a href=JavaScript:alink_32.Click()>constant</a> or constant <object id=alink_33 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defexpression">
</object><a href=JavaScript:alink_33.Click()>expression</a>. Valid for <b>Optional</b> parameters only. If the type is an <b>Object</b>, an explicit default value can only be <b>Nothing</b>.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
If not explicitly specified using <b>Public</b>, <b>Private</b>, or <b>Friend</b>, <b>Sub</b> procedures are public by default. If <b>Static</b> isn't used, the value of local variables is not preserved between calls. The <b>Friend</b> keyword can only be used in class modules. However, <b>Friend</b> procedures can be accessed by procedures in any module of a project. A <b>Friend</b> procedure doesn't appear in the <object id=alink_34 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="deftypelibrary">
</object><a href=JavaScript:alink_34.Click()>type library</a> of its parent class, nor can a <b>Friend</b> procedure be late bound.</p>
<p class=indent>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;<b>Sub</b> procedures can be recursive; that is, they can call themselves to perform a given task. However, recursion can lead to stack overflow. The <b>Static</b> keyword usually is not used with recursive <b>Sub</b> procedures.</p>
<p>
All executable code must be in <object id=alink_35 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defprocedure">
</object><a href=JavaScript:alink_35.Click()>procedures</a>. You can't define a <b>Sub</b> procedure inside another <b>Sub</b>, <b>Function</b>, or <b>Property</b> procedure.</p>
<p>
The <b>Exit Sub </b>keywords cause an immediate exit from a <b>Sub</b> procedure. Program execution continues with the statement following the statement that called the <b>Sub</b> procedure. Any number of <b>Exit Sub</b> statements can appear anywhere in a <b>Sub</b> procedure.</p>
<p>
Like a <b>Function</b> procedure, a <b>Sub</b> procedure is a separate procedure that can take arguments, perform a series of statements, and change the value of its arguments. However, unlike a <b>Function</b> procedure, which returns a value, a <b>Sub</b> procedure can't be used in an expression.</p>
<p>
You call a <b>Sub</b> procedure using the procedure name followed by the argument list. See the <b>Call</b> statement for specific information on how to call <b>Sub</b> procedures.</p>
<p>
Variables used in <b>Sub</b> procedures fall into two categories: those that are explicitly declared within the procedure and those that are not. Variables that are explicitly declared in a procedure (using <b>Dim</b> or the equivalent) are always local to the procedure. Variables that are used but not explicitly declared in a procedure are also local unless they are explicitly declared at some higher level outside the procedure.</p>
<p class=indent>
<B><b>Caution</b></B>&nbsp;&nbsp;&nbsp;A procedure can use a variable that is not explicitly declared in the procedure, but a naming conflict can occur if anything you defined at the <object id=alink_36 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defmodulelevel">
</object><a href=JavaScript:alink_36.Click()>module level</a> has the same name. If your procedure refers to an undeclared variable that has the same name as another procedure, constant or variable, it is assumed that your procedure is referring to that module-level name. To avoid this kind of conflict, explicitly declare variables. You can use an <b>Option Explicit</b> statement to force explicit declaration of variables.</p>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;You can't use <b>GoSub</b>, <b>GoTo</b>, or <b>Return</b> to enter or exit a <b>Sub</b> procedure.</p>
</BODY>
</HTML>
