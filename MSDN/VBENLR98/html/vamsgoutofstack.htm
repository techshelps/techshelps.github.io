<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Out of stack space (Error 28)</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vamsgoutofstack"></a>Out of stack space (Error 28)</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vamsgOutofStackC">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Specifics">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vamsgOutOfStackS">
</object></p>
<p>
The stack is a working area of memory that grows and shrinks dynamically with the demands of your executing program. This error has the following causes and solutions:
<ul type=disc>
<li>
You have too many active <b>Function</b>, <b>Sub</b>, or <b>Property</b> procedure calls.<p class=tl>
Check that <object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defprocedure">
</object><a href=JavaScript:alink_3.Click()>procedures</a> aren't nested too deeply. This is especially true with recursive procedures, that is, procedures that call themselves. Make sure recursive procedures terminate properly. Use the <b>Calls</b> dialog box to view which procedures are active (on the stack).</P></li>
<li>
Your local <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defvariable">
</object><a href=JavaScript:alink_4.Click()>variables</a> require more local variable space than is available.<p class=tl>
Try declaring some variables at the <object id=alink_5 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defmodulelevel">
</object><a href=JavaScript:alink_5.Click()>module level</a> instead. You can also declare all variables in the procedure static by preceding the <b>Property</b>, <b>Sub</b>, or <b>Function</b> keyword with <b>Static</b>. Or you can use the <b>Static</b> statement to declare individual <b>Static</b> variables within procedures.</P></li>
<li>
You have too many fixed-length strings.<p class=tl>
Fixed-length strings in a procedure are more quickly accessed, but use more stack space than variable-length strings, because the string data itself is placed on the stack. Try redefining some of your fixed-length strings as variable-length strings. When you declare variable-length strings in a procedure, only the string descriptor (not the data itself) is placed on the stack. You can also define the string at module level where it requires no stack space. Variables declared at module level are <b>Public</b> by default, so the string is visible to all procedures in the module.</P></li>
<li>
You have too many nested <b>DoEvents</b> function calls.<p class=tl>
Use the <b>Calls</b> dialog box to view which procedures are active on the stack.</P></li>
<li>
Your code triggered an event cascade.<p class=tl>
An event cascade is caused by triggering an event that calls an event procedure that's already on the stack. An event cascade is similar to an unterminated recursive procedure call, but it's less obvious, since the call is made by Visual Basic rather than by an explicit call in your code. Use the <b>Calls</b> dialog box to view which procedures are active (on the stack).</P></li>
</ul>
<p>
To display the <b>Calls</b> dialog box, select the <b>Calls</b> button to the right of the <object id=alink_6 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defprocedurebox">
</object><a href=JavaScript:alink_6.Click()>Procedure box</a> in the <b>Debug</b> window or choose the <b>Calls</b> command. For additional information, select the item in question and press F1.</p>
</BODY>
</HTML>
