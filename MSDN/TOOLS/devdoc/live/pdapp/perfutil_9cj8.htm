<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using EXCTRLST</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_tools_using_exctrlst"></a>Using EXCTRLST</h2>
<p>
When the EXCTRLST utility is started, it scans the registry to determine which applications, devices, and services have registered extensible performance counter DLLs. These DLLs are listed in the list box of the display along with the corresponding application, driver, or service. The EXCTRLST utility does not test for the existence of the DLLs. </p>
<p>
The following table contains descriptions for the different fields displayed in the EXCTRLST dialog box. </p>
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=31%>Field</th>
<th align=left width=69%>Description</th>
</tr>
<tr valign=top>
<td width=31%><b>Machine</b> <b>name</b></td>
<td width=69%>The name of the machine from which the information is read. The default value is the local machine. However, you can use the name of any machine for which you have permission to read the registry. </td>
</tr>
<tr valign=top>
<td width=31%><b>Refresh</b></td>
<td width=69%>When you click this button, the utility updates the display with current information from the registry of the selected machine. </td>
</tr>
<tr valign=top>
<td width=31%><b>Sort Order</b></td>
<td width=69%>The sort order for the items displayed in the <b>Extensible Performance Counters</b> list box. The default sort order is <b>By Library Name</b>, which sorts the list in alphabetical order by the name of the DLL. If <b>By Service Name</b> is selected, the list is sorted by the name of the service entry in the registry. </td>
</tr>
<tr valign=top>
<td width=31%><b>Extensible <br>
Performance <br>
Counters</b></td>
<td width=69%>A list box that contains the names of the services that provide performance counters, and the DLL that provides this information. The order is determined by the <b>Sort Order</b> selection. </td>
</tr>
<tr valign=top>
<td width=31%><b>DLL Name</b></td>
<td width=69%>The entry found in the registry for the DLL that Windows NT is to load for the performance data provided by this service. Either the file must be located in the system path, or you must provide the fully qualified path to the DLL. If the DLL is not found, the system logs an error in the Application event log. </td>
</tr>
<tr valign=top>
<td width=31%><b>Open</b> <b>Procedure</b></td>
<td width=69%>The name of the DLL function that initializes the performance functions for the service. This function must be exported by the DLL and must return success. If this function is not found in the DLL or if it returns an error, the system logs an error in the Application event log. </td>
</tr>
<tr valign=top>
<td width=31%><b>Collect Procedure</b></td>
<td width=69%>The name of the DLL function that collects the performance data for the service. This function is called each time an application, such as Performance Monitor, requests performance data. If this function is not found in the DLL or causes an error, the system logs an error in the Application event log. </td>
</tr>
<tr valign=top>
<td width=31%><b>Close Procedure</b></td>
<td width=69%>The name of the DLL function that performs any termination or cleanup when the application requesting performance data closes its interface to the performance registry. If this function is not found in the DLL, the system logs an error in the Application event log. </td>
</tr>
<tr valign=top>
<td width=31%><b>Counter ID Range</b></td>
<td width=69%>When the extensible performance counter DLL is installed, the system assigns a range of Index values to its object and counter name strings. The values assigned during installation are displayed here. If the service uses pre-assigned index values, this entry is not applicable, and the value of this field is <b>N/A</b>. If there is a problem with the entry for the service, its counters are not displayed, and this field is <b>Not Found</b>. </td>
</tr>
<tr valign=top>
<td width=31%><b>Help ID Range</b></td>
<td width=69%>When the extensible performance counter DLL is installed, the system assigns a range of index values to its object and counter descriptions. The indices used are the corresponding counter or object name string index + 1. The values assigned during installation are displayed here. If the service uses pre-assigned index values, this entry is not applicable, and the value of this field is <b>N/A</b>. If there is a problem with the entry for the service, its counters are not displayed, and this field is <b>Not Found</b>. </td>
</tr>
</table><br>
<p>
<b>Note</b>&nbsp;&nbsp;The values for the <b>Counter ID Range</b> and <b>Help ID Range</b> fields must correspond to the entries found in the following registry key: </p>
<p>
<b>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Perflib\&lt;LangID&gt;\Counter </b></p>
<p>
where <b>&lt;LangID&gt;</b> corresponds to the specific entry for the default language on the machine (for example, 009 indicates that the language is English). If these values do not correspond, the counters and objects described for the service are not displayed correctly. </p>
<p>&nbsp;</p></body>
</HTML>
