<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Searching for Help with Keywords</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_tools_searching_for_help_with_keywords"></a>Searching for Help with Keywords</h2>
<p>
An application can enable the user to search for topics based on full or partial keywords. The following example searches for the keyword "Keyboard" and displays the corresponding topic, if found:</p>
<pre><code>WinHelp(hwnd, "myhelp.hlp", HELP_KEY, "Keyboard");
 </code></pre>
<p>
If the topic is not found, Windows Help displays the Index tab. If more than one topic has the same keyword, Windows Help displays the list of topics in the Topics Found dialog.</p>
<p>
An application can give the user more options in a search by specifying partial keywords. When a partial keyword is given, Windows Help usually displays the Index tab to allow the user to continue the search or return to the application. However, if there is an exact match and no other topic exists with the given keyword, Windows Help displays the topic. The following example opens the Find tab and selects the first keyword in the list starting with the letters <i>Ke</i>:</p>
<pre><code>WinHelp(hwnd, "myhelp.hlp", HELP_PARTIALKEY, "Ke");
 </code></pre>
<p>
When the HELP_KEY and HELP_PARTIALKEY values are specified in the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_winhelp">
</object><a href=JavaScript:alink_1.Click()><b>WinHelp</b></a> function, Windows Help searches the K keyword table. This table contains keywords generated by using the letter K with <b>\footnote</b> statements in the topic file. An application can search alternative keyword tables by specifying the HELP_MULTIKEY value in the <b>WinHelp</b> function. In this case, the application must specify the footnote character and the full keyword in a <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_multikeyhelp_str">
</object><a href=JavaScript:alink_2.Click()><b>MULTIKEYHELP</b></a> structure, as follows:</p>
<pre><code>HGLOBAL hglblmkh;
MULTIKEYHELP FAR* mkh;
PSTR pszKeyword = "Frame";
UINT cb;

cb = sizeof(MULTIKEYHELP) + lstrlen(pszKeyword);

hglblmkh = GlobalAlloc(GHND, (DWORD) cb);
if (hglblmkh == NULL)
    break;
mkh = (MULTIKEYHELP FAR*) GlobalLock(hglblmkh);

mkh-&gt;mkSize    = cb;
mkh-&gt;mkKeylist = 'L';
lstrcpy(mkh-&gt;szKeyphrase, pszKeyword);

WinHelp(hwnd, "myhelp.hlp", HELP_MULTIKEY, (DWORD) mkh);

GlobalUnlock(hglblmkh);
GlobalFree(hglblmkh);
 </code></pre>
<p>
If the keyword is not found, Windows Help displays an error message. If more than one topic has the keyword, Windows Help displays only the first topic. </p>
<p>
Applications cannot use alternative keyword tables unless the <b>MULTIKEY</b> option is specified in the [OPTIONS] section of the project file.</p>
<p>&nbsp;</p></body>
</HTML>
