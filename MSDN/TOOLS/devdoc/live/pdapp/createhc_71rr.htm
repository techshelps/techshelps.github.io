<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Displaying Help in a Secondary Window</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h2><a name="_tools_displaying_help_in_a_secondary_window"></a>Displaying Help in a Secondary Window</h2>
<p>
An application can display topics in secondary windows instead of in the Windows Help main window. Secondary windows are useful whenever the user does not need the full capabilities of Windows Help. </p>
<p>
To display help in a secondary window, the application specifies the name of the secondary window along with the name of the help file. The following example displays the topic having the context identifier IDM_FILE_SAVE in the secondary window named "wnd_menu":</p>
<pre><code>WinHelp(hwnd, "myhelp.hlp&gt;wnd_menu", HELP_CONTEXT, IDM_FILE_SAVE);
 </code></pre>
<p>
The name and characteristics of the secondary window must be defined in the <u>[WINDOWS]</u> section of the project file, as in the following example:</p>
<pre><code>[WINDOWS]
wnd_menu = "Menus", (128, 128, 256, 256), 0
 </code></pre>
<p>
Windows Help displays the secondary window with the initial size and position specified in the <u>[WINDOWS]</u> section. However, an application can set a new size and position by specifying the HELP_SETWINPOS value in the <object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_winhelp">
</object><a href=JavaScript:alink_1.Click()><b>WinHelp</b></a> function. In this case, the application sets the members in a <object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink,MENU">
<PARAM name="DefaultTopic" value="../../notopic_0pk4.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="_win32_helpwininfo_str">
</object><a href=JavaScript:alink_2.Click()><b>HELPWININFO</b></a> structure to specify the window size and position. The following examples sets the secondary window wnd_menu to a new size and position:</p>
<pre><code>HANDLE hhwi;
LPHELPWININFO lphwi;
WORD wSize;
char *szWndName = "wnd_menu";

wSize = sizeof(HELPWININFO) + lstrlen(szWndName);
hhwi = GlobalAlloc(GHND, wSize);
lphwi = (LPHELPWININFO)GlobalLock(hhwi);

lphwi-&gt;wStructSize = wSize;
lphwi-&gt;x           = 256;
lphwi-&gt;y           = 256;
lphwi-&gt;dx          = 767;
lphwi-&gt;dy          = 512;
lphwi-&gt;wMax        = 0;
lstrcpy(lphwi-&gt;rgchMember, szWndName);

WinHelp(hwnd, "myhelp.hlp", HELP_SETWINPOS, lphwi);

GlobalUnlock(hhwi);
GlobalFree(hhwi); </code></pre>
<p>&nbsp;</p></body>
</HTML>
