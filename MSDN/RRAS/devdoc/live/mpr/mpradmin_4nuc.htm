<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MprAdminInterfaceConnect</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mpr_mpradmininterfaceconnect"></a>MprAdminInterfaceConnect</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>MprAdminInterfaceConnect</b> function creates a connection to the specified WAN interface.</p>
<pre><code><b>DWORD  MprAdminInterfaceConnect(
</b>  <b>MPR_SERVER_HANDLE</b> <i>hMprServer,</i>    // handle to router
  <b>HANDLE</b> <i>hInterface</i>,               // handle to interface
  <b>HANDLE</b> <i>hEvent</i>,                   // event to signal when connection
                                   // attempt is complete
  <b>BOOL</b> <i>fBlocking</i>                   // flag to control
                                   // synchronous vs.
                                   // asychronous operation
<b>)</b>;</code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>hMprServer</i></dt>
<dd>
Handle to the Windows NT router on which to execute this call. Obtain this handle by calling <a href="mpradmin_0f90.htm"><b>MprAdminServerConnect</b></a>.</dd>
<dt>
<i>hInterface</i></dt>
<dd>
Handle to the interface. This handle is obtained from a previous call to <a href="mpradmin_1dut.htm"><b>MprAdminInterfaceCreate</b></a>.</dd>
<dt>
<i>hEvent</i></dt>
<dd>
Handle to an event that will be signaled after the attempt to connect the interface has completed. The function initiates the connection attempt and returns immediately. After the event is signaled, you can obtain the result of the connection attempt by calling <a href="mpradmin_2aun.htm"><b>MprAdminInterfaceGetInfo</b></a>.
<p>
If this parameter is NULL, and <i>fBlocking</i> is TRUE, then this call is synchronous, that is, the function will not return until the connection attempt has completed. 

<p>
The caller must specify NULL for this parameter, if <i>hMprserver</i> specifies a remote router.
</dd>
<dt>
<i>fBlocking</i></dt>
<dd>
If <i>hEvent</i> is NULL and this parameter is set to TRUE, the function will not return until the connection attempt has completed. 
<p>
If <i>hEvent</i> is NULL, and this parameter is set to FALSE, the function will return immediately. A return value of <b>PENDING</b> indicates that the connection attempt was initiated successfully. 

<p>
If <i>hEvent</i> is not NULL, this parameter is ignored.

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
<b>NO_ERROR</b></dt>
<dd>
Success, the interface is connected.</dd>
<dt>
<b>ERROR_ACCESS_DENIED</b></dt>
<dd>
The caller does not have sufficient privilege.</dd>
<dt>
<b>ERROR_ALREADY_CONNECTING</b></dt>
<dd>
A connection is already in progress on this interface.</dd>
<dt>
<b>ERROR_DDM_NOT_RUNNING</b></dt>
<dd>
The Demand Dial Manager (DDM) is not running.</dd>
<dt>
<b>ERROR_INTERFACE_DISABLED</b></dt>
<dd>
The interface is currently disabled.</dd>
<dt>
<b>ERROR_INTERFACE_HAS_NO_DEVICES</b></dt>
<dd>
No adapters are available for this interface.</dd>
<dt>
<b>ERROR_INVALID_HANDLE</b></dt>
<dd>
The <i>hInterface</i> value is invalid.</dd>
<dt>
<b>ERROR_SERVICE_IS_PAUSED</b></dt>
<dd>
The Demand Dial service is currently paused.</dd>
<dt>
<b>PENDING</b></dt>
<dd>
The interface is in the process of connecting. The caller should wait on the <i>hEvent</i> handle, if one was specified. After the event is signaled, you can obtain the state of the connection and any associated error can by calling <a href="mpradmin_2aun.htm"><b>MprAdminInterfaceGetInfo</b></a>.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The following table summarizes the relationship between <i>hEvent</i> and <i>fBlocking</i>.</p>
<table cellspacing=4 cols=3>
<tr valign=top>
<th align=left width=22%>hEvent</th>
<th align=left width=21%>fBlocking</th>
<th align=left width=57%>Result</th>
</tr>
<tr valign=top>
<td width=22%>Event Handle</td>
<td width=21%>Ignored</td>
<td width=57%>The call returns immediately. A return value of PENDING indicates that the attempt was initiated successfully. Wait on <i>hEvent</i>. When <i>hEvent</i> is signalled, use <a href="mpradmin_2aun.htm"><b>MprAdminInterfaceGetInfo</b></a> to determine the success or failure of the connection attempt.</td>
</tr>
<tr valign=top>
<td width=22%>NULL</td>
<td width=21%>TRUE</td>
<td width=57%>The call will not return until connection attempt has completed.</td>
</tr>
<tr valign=top>
<td width=22%>NULL</td>
<td width=21%>FALSE</td>
<td width=57%>The call returns immediately. A return value of PENDING indicates that the attempt was initiated successfully.</td>
</tr>
</table><br>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 5.0 and later.<br>
&nbsp;&nbsp;<b>Windows:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in mprapi.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with  mprapi.lib.</p>
<h4>See Also</h4>
<p>
<a href="mpradmin_1dut.htm"><b>MprAdminInterfaceCreate</b></a>, <a href="mpradmin_1778.htm"><b>MprAdminInterfaceDisconnect</b></a>, <a href="mpradmin_2aun.htm"><b>MprAdminInterfaceGetInfo</b></a>, <a href="mpradmin_0f90.htm"><b>MprAdminServerConnect</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
