<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SetGlobalInfo Sample</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mpr_setglobalinfo_sample"></a>SetGlobalInfo Sample</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<pre><code>DWORD
APIENTRY
SetGlobalInfo(
    IN PVOID pvConfig
    )
/*++
  Routine Description
      Called by the IP Router Manager usually in response to an admin
      utility changing the config.  We verify the parameters and the
      info and set it

  Arguments


  Return Value
      ERROR_INVALID_PARAMETER
      ERROR_INVALID_DATA
      NO_ERROR

--*/
{
    PSAMPLE_PROTOCOL_GLOBAL_INFO    pGlobalInfo;

    EnterProtocolApi();

    TraceEnter("SetGlobalInfo");

    if(pvConfig == NULL)
    {
        Trace0(ERR,
               "SetGlobalInfo: Router Manager called us with NULL info");

        TraceLeave("SetGlobalInfo");

        ExitProtocolApi();

        return ERROR_INVALID_PARAMETER;
    }
    

    pGlobalInfo = (PSAMPLE_PROTOCOL_GLOBAL_INFO)pvConfig;
    
    if(!ValidateGlobalInfo(pGlobalInfo))
    {
        //
        // Bad global info
        //

        TraceLeave("SetGlobalInfo");

        ExitProtocolApi();

        return ERROR_INVALID_DATA;
    }

    //
    // Good info
    //

    EnterCriticalSection(&amp;g_csGlobalInfoLock);

    g_dwLogLevel = pGlobalInfo-&gt;dwLogLevel;

    LeaveCriticalSection(&amp;g_csGlobalInfoLock);
    
    TraceLeave("SetGlobalInfo");

    ExitProtocolApi();

    return ERROR_INVALID_DATA;

}</code></pre>
<p>&nbsp;</p></body>
</HTML>
