<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RtmAddRoute</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mpr_rtmaddroute"></a>RtmAddRoute</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>RtmAddRoute</b> function adds a route entry, or updates an existing route entry. </p>
<pre><code><b>DWORD RtmAddRoute(
</b>  <b>HANDLE</b><i> ClientHandle</i>,      // handle that identifies the client
  <b>PVOID</b><i> Route</i>,              // pointer to new route structure
  <b>DWORD</b><i> TimeToLive</i>,         // how long to keep the route
  <b>DWORD</b><i> Flags</i>,              // best route change status
  <b>PVOID</b><i> CurBestRoute</i>,       // pointer to new best route
  <b>PVOID</b><i> PrevBestRoute</i>       // pointer to previous best route
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ClientHandle</i></dt>
<dd>
A handle that identifies the client and therefore the routing protocol of the added or updated route. Obtain this handle by calling <a href="rtm_5cdw.htm"><b>RtmRegisterClient</b></a>.</dd>
<dt>
<i>Route</i></dt>
<dd>
The address of a protocol-family-specific structure containing the new orupdated route. The following fields will be used by the RTM to update the routing table:
<dl>
<dt>
<i>RR_Network</i></dt>
<dd>
The destination network number.</dd>
<dt>
<i>RR_InterfaceID</i></dt>
<dd>
The index of the interface through which the route was received.</dd>
<dt>
<i>RR_NextHopAddress</i></dt>
<dd>
The address of the next hop router.</dd>
<dt>
<i>RR_FamilySpecificData</i></dt>
<dd>
Data specific to the protocol family. Although the data is transparent to the RTM, it is considered when comparing routes to determine if route information has changed. The data is also used to set metric values that are independent of the routing protocol. Consequently, it's used to determine the best route for the destination network.</dd>
<dt>
<i>RR_ProtocolSpecificData</i></dt>
<dd>
Data specific to the routing protocol that supplied the route.</dd>
<dt>
<i>RR_TimeStamp</i></dt>
<dd>
The RTM sets this field with the current system time.</dd>
</dl>
</dd>
<dt>
<i>TimeToLive</i></dt>
<dd>
The number of seconds the specified route should be kept in the routing table. If this parameter is set to INFINITE, the route is kept until explicitly deleted. The current limit for <i>TimeToLive</i> is 2147483 sec (24+ days).</dd>
<dt>
<i>Flags</i></dt>
<dd>
The address of a <b>DWORD </b>variable. The value of this variable is set by the RTM. The value indicates the type of the change, and what information was returned in the provided buffers. This parameter will be one of the following.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Flags</th>
<th align=left width=52%>Values </th>
</tr>
<tr valign=top>
<td width=48%>RTM_NO_CHANGE</td>
<td width=52%>The addition or update either did not change any of the significant route parameters, or the route entry affected is not the best route among the entries for the destination network.</td>
</tr>
<tr valign=top>
<td width=48%>RTM_ROUTE_ADDED</td>
<td width=52%>The route added for the first for the destination network. The <i>CurBestRoute</i> parameter points to the information for the added route.</td>
</tr>
<tr valign=top>
<td width=48%>RTM_ROUTE_CHANGED</td>
<td width=52%>At least one of the significant parameters was changed for the best route to the destination network. The significant parameters are:<p>
&nbsp;&nbsp;&nbsp;&nbsp;Protocol ID </p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Interface Index</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Next Hop Address</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Protocol Family Specific Data <br>
&nbsp;&nbsp;&nbsp;&nbsp;(including route metrics)</p>
</td>
</tr>
</table><br>


<p>
The <i>PrevBestRoute</i> parameter points to the route information as it was before the change. The <i>CurBestRoute</i> parameter points to the current (that is, after-change) route information.
</dd>
<dt>
<i>CurBestRoute</i></dt>
<dd>
The address of a structure to receive the current best route information (if any). The type of the structure is specific to the protocol family (for example, IP or IPX).
<p>
This parameter is optional. If the caller specifies NULL for this parameter, the current best route information is not returned.
</dd>
<dt>
<i>PrevBestRoute</i></dt>
<dd>
The address of a structure to receive the previous best route information (if any). The type of the structure is specific to the protocol family (for example, IP or IPX). 
<p>
This parameter is optional. If the caller specifies NULL for this parameter the previous best route information is not returned.

</dd>
</dl>
<h4>Return Value</h4>
<dl>
<dt>
<b>NO_ERROR</b></dt>
<dd>
The route was added/updated successfully.</dd>
<dt>
<b>ERROR_INVALID_HANDLE</b></dt>
<dd>
The client handle parameter is not a valid RTM handle.</dd>
<dt>
<b>ERROR_INVALID_PARAMETER</b></dt>
<dd>
The route structure contains an invalid parameter.</dd>
<dt>
<b>ERROR_NO_SYSTEM_RESOURCES</b></dt>
<dd>
Insufficient resources to carry out the operation.</dd>
<dt>
<b>ERROR_NOT_ENOUGH_MEMORY</b></dt>
<dd>
Insufficient memory to allocate the route entry.
</dd>
</dl>
<h4>Remarks</h4>
<p>
The function generates a route change message if the best route to a destination network has changed as the result of this operation. However, the route change message is not sent to the client that makes this call. Instead, relevant information is returned by this function directly to that client through the <i>Flags</i>, <i>CurBestRoute</i>, and <i>PrevBestRoute</i> parameters.</p>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 5.0 and later.<br>
&nbsp;&nbsp;<b>Windows:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in rtm.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with rtm.lib.</p>
<h4>See Also</h4>
<p>
<a href="rtm_4wrp.htm"><b>RtmDeleteRoute</b></a>, <a href="rtm_33j9.htm"><b>RtmDequeueRouteChangeMessage</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
