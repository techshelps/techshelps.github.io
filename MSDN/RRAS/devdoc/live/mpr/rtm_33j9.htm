<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RtmDequeueRouteChangeMessage</title>
<link disabled rel=stylesheet href=../../backsdk3.css>
<style type="text/css">
@import url(../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>

<h1><a name="_mpr_rtmdequeueroutechangemessage"></a>RtmDequeueRouteChangeMessage</h1>
<p>
<span style=color:#FF0000>[This is preliminary documentation and subject to change.]</span> </p>
<p>
The <b>RtmDequeueRouteChangeMessage </b>function returns the next route-change message in the queue associated with the specified client.</p>
<pre><code><b>DWORD RtmDequeueRouteChangeMessage(
</b>  <b>HANDLE</b><i> ClientHandle</i>,      // handle that identifies the client
  <b>DWORD</b><i> Flags</i>,              // type of change message
  <b>PVOID</b><i> CurBestRoute</i>,       // the new best route
  <b>PVOID</b><i> PrevBestRoute</i>       // the previous best route
<b>);</b>
 </code></pre>
<h4>Parameters</h4>
<dl>
<dt>
<i>ClientHandle</i></dt>
<dd>
A handle that identifies the client for which the operation is performed. Obtain this handle by calling <a href="rtm_5cdw.htm"><b>RtmRegisterClient</b></a>.</dd>
<dt>
<i>Flags</i></dt>
<dd>
The address of a <b>DWORD </b>variable. The value of this variable is set by the RTM. The value indicates the type of the change message, and what information was returned in the provided buffers. This parameter will be one of the following.
<table cellspacing=4 cols=2>
<tr valign=top>
<th align=left width=48%>Flags</th>
<th align=left width=52%>Values </th>
</tr>
<tr valign=top>
<td width=48%>RTM_ROUTE_ADDED</td>
<td width=52%>The first route was added for a particular destination network. The <i>CurBestRoute</i> parameter points to the information for the added route.</td>
</tr>
<tr valign=top>
<td width=48%>RTM_ROUTE_DELETED</td>
<td width=52%>The only route available for a particular destination network was deleted. The <i>PrevBestRoute</i> parameter points to the information for the deleted route.</td>
</tr>
<tr valign=top>
<td width=48%>RTM_ROUTE_CHANGED</td>
<td width=52%>At least one of the significant parameters was changed for a best route to a particular destination network. The significant parameters are:<p>
&nbsp;&nbsp;&nbsp;&nbsp;Protocol ID </p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Interface Index</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Next Hop Address</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Protocol Family Specific Data <br>
&nbsp;&nbsp;&nbsp;&nbsp;(including route metrics)</p>
</td>
</tr>
</table><br>


<p>
The <i>PrevBestRoute</i> parameter points to the route information as it was before the change. The <i>CurBestRoute</i> parameter points to current (that is,after-change) route information.
</dd>
<dt>
<i>CurBestRoute</i></dt>
<dd>
The address of a structure to receive the current best route information (if any). The type of the structure is specific to the protocol family (for example, IP or IPX). 
<p>
This parameter is optional. If the caller specifies NULL for this parameter, the current best route information is not returned.
</dd>
<dt>
<i>PrevBestRoute</i></dt>
<dd>
The address of a structure to receive the previous best route information (if any). The type of the structure is specific to the protocol family (for example, IP or IPX).
<p>
This parameter is optional. If the caller specifies NULL for this parameter, the previous best route information is not returned.

</dd>
</dl>
<h4>Return Values</h4>
<dl>
<dt>
<b>NO_ERROR</b></dt>
<dd>
This message was the last message in the client's queue. The event object is reset.</dd>
<dt>
<b>ERROR_INVALID_HANDLE</b></dt>
<dd>
The <i>ClientHandle</i> parameter is not a valid RTM handle, or at registration the client did not provide an event object for change message notification (see <a href="rtm_5cdw.htm"><b>RtmRegisterClient</b></a>).</dd>
<dt>
<b>ERROR_MORE_MESSAGES</b></dt>
<dd>
The client's queue contains additional messages. The client should call <b>RtmDequeueRouteChangeMessage</b> again as soon as possible to allow the RTM to free the resources associated with the pending messages.</dd>
<dt>
<b>ERROR_NO_MESSAGES</b></dt>
<dd>
The client's queue contains no messages; the call was unsolicited. The event is reset.</dd>
<dt>
<b>ERROR_NO_SYSTEM_RESOURCES</b></dt>
<dd>
Insufficient resources to carry out the operation.
</dd>
</dl>
<h4>QuickInfo</h4>
<p>
&nbsp;&nbsp;<b>Windows NT:</b>  Use version 5.0 and later.<br>
&nbsp;&nbsp;<b>Windows:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Windows CE:</b>  Unsupported.<br>
&nbsp;&nbsp;<b>Header:</b> Declared in rtm.h.<br>
&nbsp;&nbsp;<b>Import Library:</b> Link with rtm.lib.</p>
<h4>See Also</h4>
<p>
<a href="rtm_5cdw.htm"><b>RtmRegisterClient</b></a> </p>
<p>&nbsp;</p></body>
</HTML>
