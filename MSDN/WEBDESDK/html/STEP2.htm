<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML><HEAD><script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Step-By-Step: Building a Web Design-time Control with Visual Basic</TITLE>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<basefont face="verdana,arial,helvetica" size=2 color="#000000">

<BODY leftmargin=8 bgcolor="#FFFFFF" VLINK="#666666" LINK="#FF0000" TEXT="#000000">


<font size=6>Step-by-Step: Building a Web Design-time Control with Visual Basic </font>

<P><!--DATE-->October 6, 1996
<P><h4>Contents</h4>
<b><A HREF="#CREATEX">Create an ActiveX control</A></b>
<BR> &NBSP;&NBSP;&NBSP;<A HREF="#STEP1A">Step 1:  Create ActiveX control project</A>
<BR> &NBSP;&NBSP;&NBSP;<A HREF="#STEP2A">Step 2:  Use Visual Basic ActiveX Control Interface Wizard to configure your control</A>
<BR><b><A HREF="#ADDX">Add Web design-time control support</A></b>
<BR> &NBSP;&NBSP;&NBSP;<A HREF="#STEP3A">Step 3:  Add IActiveDesigner interface reference to project</A>
<BR> &NBSP;&NBSP;&NBSP;<A HREF="#STEP4A">Step 4:  Implement IActiveDesigner interface</A>
<P><h4>Summary</h4>   
<p>This document is a step-by-step tutorial for creating the BGSound Web design-time control using Visual Basic&#174; Control Creation Edition version 5.0.
<P><h3><A NAME="CREATEX"></A> Create an ActiveX control</h3>
<P><h4><A NAME="STEP1A"></A> Step 1:  Create ActiveX control project</H4><OL type=A>
<b><LI>Create new ActiveX control project using File.New Project and choose ActiveX Control at the type<LI>Add label control to the UserControl (ActiveX control) you have just created<LI>Set properties on the label control</b>
<P>Set label control Name property to "lblSource"
<BR>Set label control Caption property to "[No Sound Source]"
<P>
<b><LI>Name the project and control</b>
<PRE><FONT FACE="COURIER" SIZE="2">Project name = web
Control name = bgsound</FONT></PRE>
<b><LI>Save project and name project file as web.vbp; control file as bgsound.ctl</b></OL><h4><A NAME="STEP2A"></A> Step 2:  Use Visual Basic ActiveX Control Interface Wizard to configure your control</H4><OL type=A>
<b><LI>Use Add-Ins.ActiveX Control Interface Wizard to launch wizard<LI>Remove default events, props, and methods that have been added<LI>Add the following properties<BR>(Note: Repeat is used instead of Loop because Loop is a Visual Basic keyword)</b>
<PRE><FONT FACE="COURIER" SIZE="2">Source
Repeat
</FONT></PRE>
<b><LI>Point Source property to lblSource.Caption property<LI>Set datatype of Repeat to integer and default to -1<LI>Finish wizard</b></OL><h3><A NAME="ADDX"></A> Add Web design-time control support</h3>
<P><h4><A NAME="STEP3A"></A> Step 3:  Add IActiveDesigner interface reference to project</H4><P><OL type=A>
<b><LI>Add reference to "Microsoft Web Design-time Control Type Library"</b>
<br>Use Project.References and scan the list of available references to ensure that it is checked if present. If not, then browse to the <i>c:\progra~1\dcsdk\samples\vb\common</i> directory (if you used the default install location) and add webdc.tlb as a project type reference. This will automatically check it and include it in your project.
</ol>
<P><h4><A NAME="STEP4A"></A> Step 4:  Implement IActiveDesigner interface</H4><OL type=A>
<b><LI>Add IProvideRuntimeText interface definition</b>
<PRE><FONT FACE="COURIER" SIZE="2">Implements IProvideRuntimeText
</FONT></PRE>
<b><LI>Implement IProvideRuntimeText_GetRuntimeText</b>
<PRE><FONT FACE="COURIER" SIZE="2">Dim strText As String
Dim strQuote As String
strQuote = Chr$(34)
strText = &quot;&lt;BGSOUND SRC=&quot; &amp; strQuote &amp; lblSource.Caption &amp; strQuote 
strText = strText &amp; &quot; LOOP=&quot; &amp; strQuote &amp; Repeat &amp; strQuote &amp;  &quot;&gt;&quot;
IProvideRuntimeText_GetRuntimeText = strText
</FONT></PRE>
<b><LI>Compile web.ocx</b></OL> 
<!--DocFooterStart-->
</FONT>
<FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
&#169; 1997 Microsoft Corporation. All rights reserved. <A HREF="legal.htm" target="_top">Legal Notices</a>.
</FONT>
<!--DocFooterEnd-->
</BODY></HTML>
