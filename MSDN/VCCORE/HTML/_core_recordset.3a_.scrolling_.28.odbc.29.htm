<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Recordset: Scrolling (ODBC)</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.IsDeleted">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.MoveNext">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.MovePrev">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.MoveFirst">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.MoveLast">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.Move">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.IsEOF">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.IsBOF">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDatabase.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.CanScroll">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.CheckRowsetError">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_recordset.3a_.scrolling_.28.odbc.29"></A>Recordset: Scrolling (ODBC)</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article applies to the MFC ODBC classes. For DAO recordsets, see the article <A HREF="_core_dao_recordset.htm">DAO Recordset</A>.</P>

<P>After you open a recordset, you need to access the records to display values, do calculations, generate reports, and so on. Scrolling lets you move from record to record within your recordset.</P>

<P>This article explains:

<UL type=disc>
	<LI><A HREF="#_core_scrolling_from_one_record_to_another">How to scroll from one record to another in a recordset</A><BR><BR></LI>

	<LI><A HREF="#_core_when_scrolling_is_supported">Under what circumstances scrolling is and is not supported</A></LI>
</UL>



<H2><A NAME="_core_scrolling_from_one_record_to_another"></A>Scrolling from One Record to Another</H2>

<P>Class <B>CRecordset</B> provides the <B>Move</B> member functions for scrolling within a recordset. These functions move the current record by rowsets. If you have implemented bulk row fetching, a <B>Move</B> operation repositions the recordset by the size of the rowset. If you have not implemented bulk row fetching, a call to a <B>Move</B> function repositions the recordset by one record each time. For more information about bulk row fetching, see the article <A HREF="_core_recordset.3a_.fetching_records_in_bulk_.28.odbc.29.htm">Recordset: Fetching Records in Bulk (ODBC)</A>.</P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>When moving through a recordset, deleted records may not be skipped. See the <A HREF="JavaScript:hhobj_3.Click()">IsDeleted</A> member function for details.</P>

<P>In addition to the <B>Move</B> functions, <B>CRecordset</B> provides member functions for checking whether you have scrolled past the end or ahead of the beginning of your recordset.</P>

<P>To determine whether scrolling is possible in your recordset, call the <B>CanScroll</B> member function.</P>

<P class=label><B>To scroll</B>

<UL type=disc>
	<LI>Forward one record or one rowset: call the <A HREF="JavaScript:hhobj_4.Click()">MoveNext</A> member function.<BR><BR></LI>

	<LI>Backward one record or one rowset: call the <A HREF="JavaScript:hhobj_5.Click()">MovePrev</A> member function.<BR><BR></LI>

	<LI>To the first record in the recordset: call the <A HREF="JavaScript:hhobj_6.Click()">MoveFirst</A> member function.<BR><BR></LI>

	<LI>To the last record in the recordset or to the last rowset: call the <A HREF="JavaScript:hhobj_7.Click()">MoveLast</A> member function.<BR><BR></LI>

	<LI><I>N</I> records relative to the current position: call the <A HREF="JavaScript:hhobj_8.Click()">Move</A> member function.</LI>
</UL>

<P class=label><B>To test for the end or the beginning of the recordset</B>

<UL type=disc>
	<LI>Have you scrolled past the last record? Call the <A HREF="JavaScript:hhobj_9.Click()">IsEOF</A> member function.<BR><BR></LI>

	<LI>Have you scrolled ahead of the first record (moving backward)? Call the <A HREF="JavaScript:hhobj_10.Click()">IsBOF</A> member function.</LI>
</UL>

<P>The following code example uses <B>IsBOF</B> and <B>IsEOF</B> to detect the limits of a recordset when scrolling in either direction.</P>

<PRE><CODE>// Open a recordset; first record is current
CCustSet rsCustSet( NULL );
rsCustSet.Open( );

if( rsCustSet.IsBOF( ) )
    return;
    // The recordset is empty

// Scroll to the end of the recordset, past
// the last record, so no record is current
while ( !rsCustSet.IsEOF( ) )
    rsCustSet.MoveNext( );

// Move to the last record
rsCustSet.MoveLast( );

// Scroll to beginning of the recordset, before
// the first record, so no record is current
while( !rsCustSet.IsBOF( ) )
    rsCustSet.MovePrev( );

// First record is current again
rsCustSet.MoveFirst( );
</CODE></PRE>

<P><B>IsEOF</B> returns a nonzero value if the recordset is positioned past the last record. <B>IsBOF</B> returns a nonzero value if the recordset is positioned ahead of the first record (before all records). In either case, there is no current record to operate on. If you call <B>MovePrev</B> when <B>IsBOF</B> is already <B>TRUE</B>, or call <B>MoveNext</B> when <B>IsEOF</B> is already <B>TRUE</B>, the framework throws a <B>CDBException</B>. You can also use <B>IsBOF</B> and <B>IsEOF</B> to check for an empty recordset.</P>

<P>For more information about recordset navigation, see the article <A HREF="_core_recordset.3a_.bookmarks_and_absolute_positions_.28.odbc.29.htm">Recordset: Bookmarks and Absolute Positions (ODBC)</A>.</P>



<H2><A NAME="_core_when_scrolling_is_supported"></A>When Scrolling Is Supported</H2>

<P>As originally designed, SQL provided only forward scrolling, but ODBC extends scrolling capabilities. The available level of support for scrolling depends on the ODBC driver(s) your application will work with, your driver’s ODBC API conformance level, and whether the ODBC Cursor Library is loaded into memory. For more information, see the articles <A HREF="_core_odbc.htm">ODBC</A> and <A HREF="_core_odbc.3a_.the_odbc_cursor_library.htm">ODBC: The ODBC Cursor Library</A>. </P>

<P class=indent><B><B>Tip&nbsp;&nbsp;&nbsp;</B></B>You can control whether the cursor library is used. See the <I>bUseCursorLib</I> and <I>dwOptions</I> parameters to <A HREF="JavaScript:hhobj_11.Click()">CDatabase::Open</A>.</P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>Unlike the MFC DAO classes, the MFC ODBC classes do not provide a set of <B>Find</B> functions for locating the next (or previous) record that meets specified criteria.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="JavaScript:hhobj_12.Click()">CRecordset::CanScroll</A>, <A HREF="JavaScript:hhobj_13.Click()">CRecordset::CheckRowsetError</A>, <A HREF="_core_recordset.3a_.filtering_records_.28.odbc.29.htm">Recordset: Filtering Records (ODBC)</A> </P>
</font>
</BODY>
</HTML>
