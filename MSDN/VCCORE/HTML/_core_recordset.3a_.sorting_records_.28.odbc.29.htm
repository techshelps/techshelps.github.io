<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Recordset: Sorting Records (ODBC)</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.m_strSort">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_recordset.3a_.sorting_records_.28.odbc.29"></A>Recordset: Sorting Records (ODBC)</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article applies to the MFC ODBC classes. For DAO recordsets, see the article <A HREF="_core_dao_recordset.htm">DAO Recordset</A>.</P>

<P>This article explains how to sort your recordset. You can specify one or more columns on which to base the sort, and you can specify ascending or descending order (<B>ASC</B> or <B>DESC</B>; <B>ASC</B> is the default) for each specified column. For example, if you specify two columns, the records are sorted first on the first column named, then on the second column named. An SQL <B>ORDER BY</B> clause defines a sort. When the framework appends the <B>ORDER BY</B> clause to the recordset’s SQL query, the clause controls the selection’s ordering.</P>

<P>You must establish a recordset’s sort order after you construct the object but before you call its <B>Open</B> member function (or before you call the <B>Requery</B> member function for an existing recordset object whose <B>Open</B> member function has been called previously). </P>

<P class=label><B>To specify a sort order for a recordset object</B>

<OL>
	<LI>Construct a new recordset object (or prepare to call <B>Requery</B> for an existing one).<BR><BR></LI>

	<LI>Set the value of the object’s <A HREF="JavaScript:hhobj_3.Click()">m_strSort</A> data member.
<P class=tl>The sort is a null-terminated string. It contains the contents of the <B>ORDER BY</B> clause but not the keyword <B>ORDER BY</B>. For example, use:</P>
<PRE><CODE>recordset.m_strSort = "LastName DESC, FirstName DESC";
</CODE></PRE>

<P class=tl>not</P>
<PRE><CODE>recordset.m_strSort = "ORDER BY LastName DESC, FirstName DESC";
</CODE></PRE>
</LI>

	<LI>Set any other options you need, such as a filter, locking mode, or parameters.<BR><BR></LI>

	<LI>Call <B>Open</B> for the new object (or <B>Requery</B> for an existing object).</LI>
</OL>

<P>The selected records are ordered as specified. For example, to sort a set of student records in descending order by last name, then first name, do the following:</P>

<PRE><CODE>// Construct the recordset
CStudentSet rsStudent( NULL );
// Set the sort
rsStudent.m_strSort = "LastName DESC, FirstName DESC";
// Run the query with the sort in place
rsStudent.Open( );
</CODE></PRE>

<P>The recordset contains all of the student records, sorted in descending order (Z to A) by last name, then by first name.</P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>If you choose to override the recordset’s default SQL string by passing your own SQL string to <B>Open</B>, do not set a sort if your custom string has an <B>ORDER BY</B> clause.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_recordset.3a_.parameterizing_a_recordset_.28.odbc.29.htm">Recordset: Parameterizing a Recordset (ODBC)</A>, <A HREF="_core_recordset.3a_.filtering_records_.28.odbc.29.htm">Recordset: Filtering Records (ODBC)</A> </P>
</font>
</BODY>
</HTML>
