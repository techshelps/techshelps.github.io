<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO External: Improving Performance with External Data Sources</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.SetConnect">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase.3a3a.Execute">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_external.3a_.improving_performance_with_external_data_sources"></A>DAO External: Improving Performance with External Data Sources</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains some things you can do to improve performance when you connect to external data sources, such as ODBC data sources. For general information about external data sources, see the article <A HREF="_core_dao_external.3a_.working_with_external_data_sources.htm">DAO External: Working with External Data Sources</A>.</P>

<H2><A NAME="_core_improving_performance_with_odbc_data_sources"></A>Improving Performance with ODBC Data Sources</H2>

<P>If you're connecting to an ODBC data source, the following guidelines apply:

<UL type=disc>
	<LI>Use attached tables instead of directly opened tables whenever possible. 
<P class=tl>See the article <A HREF="_core_dao_external.3a_.working_with_external_data_sources.htm">DAO External: Working with External Data Sources</A> and the topic "Accessing External Databases with DAO" in DAO Help.</P>
<P class=atl><B><B>Important</B></B>&nbsp;&nbsp;&nbsp;This recommendation has the most significant impact on performance of all the recommendations in this list.</p></LI>

	<LI>Retrieve and view only the data you need. 
<P class=tl>Use restricted queries to limit the number of records you retrieve, and select only the columns you need. This requires transferring less data across the network.</P>
<P class=tl>Don't use dynaset-type recordsets if you're not updating the data. </P>
<P class=tl>Use forward-scrolling snapshot-type recordsets if you're only scrolling forward. Don't scroll through records unnecessarily, and avoid jumping to the last record of a large table. </P></LI>

	<LI>Use caching.
<P class=tl>In class <A HREF="JavaScript:hhobj_3.Click()">CDaoRecordset</A>, MFC supports caching a specified number of records. Doing so takes longer initially, when the data is retrieved into the cache, but moving through the records in the cache is faster than retrieving each record as it is scrolled to.</P></LI>

	<LI>Turn off the double-buffering option in MFC <A HREF="JavaScript:hhobj_4.Click()">CDaoRecordset</A> objects.
<P class=tl>This is a general way to improve performance that applies as well to working with external data sources.</P></LI>

	<LI>For bulk operations, such as adding records in bulk, use an SQL pass-through query. Call <A HREF="JavaScript:hhobj_5.Click()">SetConnect</A> for the <A HREF="JavaScript:hhobj_6.Click()">CDaoDatabase</A> representing your .MDB database. Then call the database object’s <A HREF="JavaScript:hhobj_7.Click()">Execute</A> member function, or create a recordset, with the <B>dbSQLPassThrough</B> option set. For more information about pass-through queries, see the article <A HREF="_core_dao_querydef.3a_.action_queries_and_sql_pass.2d.through_queries.htm">DAO Querydef: Action Queries and SQL Pass-Through Queries</A>. (You only need to set the connection information once, if you are always performing your SQL pass-through queries through the same connection.)<BR><BR></LI>

	<LI>Avoid using queries that cause processing to be done locally. 
<P class=tl>Don't use user-defined functions with remote column arguments. Use heterogeneous joins (joins on tables in two databases) only on indexed columns, and realize if you do this that some processing is done locally. When accessing external data, the Microsoft Jet database engine processes data locally only when the operation can't be performed by the external database. Query operations performed locally include:</P>
<UL type=disc>
	<LI><B>WHERE</B> clause restrictions on top of a query with a <B>DISTINCT</B> predicate.<BR><BR></LI>

	<LI><B>WHERE</B> clauses containing operations that can't be processed remotely, such as user-defined functions that involve remote columns. (Note that in this case only the parts of the <B>WHERE</B> clause that can't be processed remotely will be processed locally.)<BR><BR></LI>

	<LI>Joins between tables from different data sources.</LI>
</UL>

<P class=atl><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;Simply having joins between tables from different data sources doesn't mean that all of the processing occurs locally. If restrictions are sent to the server, only relevant rows are processed locally.</p>
<UL type=disc>
	<LI>Joins over aggregation or the <B>DISTINCT</B> predicate.<BR><BR></LI>

	<LI>Outer joins containing syntax not supported by the ODBC driver.<BR><BR></LI>

	<LI><B>DISTINCT</B> predicates containing operations that can't be processed remotely.<BR><BR></LI>

	<LI><B>ORDER BY</B> arguments (if the remote data source doesn't support them).<BR><BR></LI>

	<LI><B>ORDER BY</B> or <B>GROUP BY</B> arguments containing operations that can't be processed remotely.<BR><BR></LI>

	<LI>Multiple-level <B>GROUP BY</B> arguments, such as those used in reports with multiple grouping levels.<BR><BR></LI>

	<LI><B>GROUP BY</B> arguments on top of a query with a <B>DISTINCT</B> option.<BR><BR></LI>

	<LI>Cross-tab queries that have more than one aggregate or that have an <B>ORDER BY</B> clause that matches the <B>GROUP BY</B> clause.<BR><BR></LI>

	<LI><B>TOP</B> or <B>TOP PERCENT </B>predicate.</LI>
</UL>
</LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao_external.3a_.working_with_external_data_sources.htm">DAO External: Working with External Data Sources</A>, <A HREF="_core_dao_external.3a_.attaching_external_tables.htm">DAO External: Attaching External Tables</A></P>
</font>
</BODY>
</HTML>
