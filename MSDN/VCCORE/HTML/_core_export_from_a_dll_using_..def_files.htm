<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Export from a DLL Using .DEF Files</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_export_from_a_dll_using_..def_files"></A>Export from a DLL Using .DEF Files</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_dlls.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dll_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_dlls.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dll_topics.htm">Details</A>  |&nbsp; <A HREF="_core_dll_sample_programs.htm">Sample</A></P>

<P>A module-definition (.DEF) file is a text file containing one or more module statements that describe various attributes of a DLL. If you are not using the <B>__declspec(dllexport)</B> keyword to export the DLL’s functions, then the DLL requires a .DEF file. </P>

<P>A minimal .DEF file must contain the following module-definition statements:

<UL type=disc>
	<LI>The first statement in the file must be the LIBRARY statement. This statement identifies the .DEF file as belonging to a DLL. The LIBRARY statement is followed by the name of the DLL. The linker places this name in the DLL's import library. <BR><BR></LI>

	<LI>The EXPORTS statement lists the names and, optionally, the ordinal values of the functions exported by the DLL. You assign the function an ordinal value by following the function’s name with an at sign (@) and a number. When you specify ordinal values, they must be in the range 1 through N, where N is the number of functions exported by the DLL. If you wish to export functions by ordinal, see <A HREF="_core_export_functions_from_a_dll_by_ordinal_rather_than_by_name.htm">Export Functions From a DLL By Ordinal Rather Than By Name</A> as well as this topic.<BR><BR></LI>

	<LI>Although not required, typically a .DEF file also contains a DESCRIPTION statement that describes the purpose of the DLL.</LI>
</UL>

<P>For example, a DLL that contains the code to implement a binary search tree might look like the following:</P>

<PRE><CODE>LIBRARY   BTREE
DESCRIPTION "Implements a binary tree."
EXPORTS
   Insert   @1
   Delete   @2
   Member   @3
   Min   @4
</CODE></PRE>

<P>If you use <A HREF="_core_overview.3a_.creating_an_mfc_dll.htm">AppWizard to create an MFC DLL</A>, AppWizard creates a skeleton .DEF file for you and automatically adds it to your project. Add the names of the functions to be exported to this file. For non-MFC DLLs, you must create the .DEF file yourself and add it to your project.</P>

<P>If you are exporting functions in a C++ file, you will have to either place the decorated names in the .DEF file or define your exported functions with standard C linkage by using extern “C”. If you need to place the decorated names in the .DEF file, you can obtain them by using the tool <A HREF="_core_dumpbin_reference.htm">DUMPBIN</A> or by using the linker switch <A HREF="_core_.2f.map.htm">/MAP</A>. Note that the decorated names produced by the compiler are compiler specific. If you place the decorated names produced by the Visual C++ compiler into a .DEF file, applications that link to your DLL must also be built using the same version of Visual C++ so that the decorated names in the calling application match the exported names in the DLL’s .DEF file.</P>

<P>If you are building an <A HREF="_core_extension_dlls.3a_.overview.htm">extension DLL</A>, and exporting using a .DEF file, place the following code at the beginning and end of your header files that contain the exported classes:</P>

<PRE><CODE>#undef AFX_DATA
#define AFX_DATA AFX_EXT_DATA
// &lt;body of your header file&gt;
#undef AFX_DATA
#define AFX_DATA
</CODE></PRE>

<P>These lines ensure that MFC variables that are used internally or that are added to your classes are exported (or imported) from your extension DLL. For example, when deriving a class using <B>DECLARE_DYNAMIC</B>, the macro expands to add a <B>CRuntimeClass</B> member variable to your class. Leaving out these four lines may cause your DLL to compile or link incorrectly or cause an error when the client application links to the DLL.</P>

<P>When building the DLL, the linker uses the .DEF file to create an export (.EXP) file and an import library (.LIB) file. The linker then uses the export file to build the .DLL file. Executables that implicitly link to the DLL link to the import library when they are built. </P>

<P>Note that MFC itself uses .DEF files to export functions and classes from the MFCx0.DLL.</P>

<H3>What do you want to do?</H3>

<UL type=disc>
	<LI><A HREF="_core_export_from_a_dll_using___declspec.28.dllexport.29.htm">Export from a DLL using __declspec(dllexport)</A><BR><BR></LI>

	<LI><A HREF="_core_export_and_import_using_afx_ext_class.htm">Export and import using AFX_EXT_CLASS</A><BR><BR></LI>

	<LI><A HREF="_core_export_c.2b2b_.functions_for_use_in_c.2d.language_executables.htm">Export C++ functions for use in C-language executables</A><BR><BR></LI>

	<LI><A HREF="_core_export_c_functions_for_use_in_c_or_c.2b2b_.language_executables.htm">Export C functions for use in C or C++-language executables</A><BR><BR></LI>

	<LI><A HREF="_core_determine_which_exporting_method_to_use.htm">Determine which exporting method to use</A><BR><BR></LI>

	<LI><A HREF="_core_import_into_an_application_using___declspec.28.dllimport.29.htm">Import into an application using __declspec(dllimport)</A><BR><BR></LI>

	<LI><A HREF="_core_prepare_the_mfc_dll_for_use.htm">Prepare the MFC DLL for use</A> by an application, or <A HREF="_core_prepare_the_win32_dll_for_use.htm">Prepare the Win32 DLL for use</A> by an application</LI>
</UL>

<H3>What do you want to know more about?</H3>

<UL type=disc>
	<LI><A HREF="_core_module.2d.definition_files.htm">.DEF files</A><BR><BR></LI>

	<LI><A HREF="_core_rules_for_module.2d.definition_statements.htm">Rules for module-definition statements</A><BR><BR></LI>

	<LI><A HREF="_core_decorated_names.htm">Decorated names</A><BR><BR></LI>

	<LI><A HREF="_core_importing_and_exporting_inline_functions.htm">Importing and exporting inline functions</A><BR><BR></LI>

	<LI><A HREF="_core_mutual_imports.htm">Mutual imports</A></LI>
</UL>
</font>
</BODY>
</HTML>
