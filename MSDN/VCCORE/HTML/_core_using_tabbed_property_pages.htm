<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Tabbed Property Pages</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CPropertySheet">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CPropertyPage">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CPropertyPage">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CPropertySheet">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_PROPDLG">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_using_tabbed_property_pages"></A>Using Tabbed Property Pages</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_win32_programming.3a_.overview.htm">Overview</A> |&nbsp; <A HREF="_core_win32_programming_tasks.htm">How Do I</A></P>

<P>It’s recommended that your Windows 95 application use tabbed property pages where applicable. Tabbed property pages are useful for dialogs whose purpose is to let the user modify the attributes of some object on the screen. MFC provides support for property pages through the classes <A HREF="JavaScript:hhobj_2.Click()">CPropertySheet</A> and <A HREF="JavaScript:hhobj_3.Click()">CPropertyPage</A>. </P>

<P>The DRAWCLI sample previously used a dialog box to allow the user to set the fill mode and the pen size. For consistency with the Windows 95 user-interface guidelines, DRAWCLI now uses a property page to do so. </P>

<P>You can use the Gallery to add a property sheet to your application. However, for DRAWCLI, the task is not adding a property sheet, but converting an existing dialog into a property sheet. Depending on your application’s needs, you can use the Gallery to add property sheets and modify them as needed, or you can add them manually. </P>

<P>If you’re converting an existing dialog box to a property page, use the following procedure: 

<UL type=disc>
	<LI>From within Visual C++’s dialog editor, do the following:
<UL type=disc>
	<LI>Check the Disabled and Titlebar properties for the dialog.<BR><BR></LI>

	<LI>Choose the Child style and Thin borders. <BR><BR></LI>

	<LI>Optional: Modify the caption for the dialog. This caption will now appear on the tab for the property page instead of in the dialog’s title bar. </LI>
</UL>
</LI>

	<LI>Change the base class of your dialog class from <B>CDialog</B> to <B>CPropertyPage</B> and modify the constructor for your dialog class to call <B>CPropertyPage</B>’s constructor in its base-initializer list. </LI>
</UL>

<P>To display the property page, attach it to a <B>CPropertySheet</B> object and call <B>DoModal</B> on the <B>CPropertySheet</B> object. Here’s how DRAWCLI does it, in its implementation of <CODE>CDrawObj::OnOpen</CODE>: </P>

<PRE><CODE>CPropertySheet sheet( "Shape Properties" );
CRectDlg dlg; // derived from CPropertyPage

dlg.m_bNoFill = !m_bBrush;
dlg.m_penSize = m_bPen ? m_logpen.lopnWidth.x : 0;
sheet.AddPage( &amp;dlg );

if (sheet.DoModal() != IDOK)
   return;

m_bBrush = !dlg.m_bNoFill;
m_bPen = dlg.m_penSize &gt; 0;
if (m_bPen)
{
   m_logpen.lopnWidth.x = dlg.m_penSize;
   m_logpen.lopnWidth.y = dlg.m_penSize;
}
</CODE></PRE>

<P>The string passed to the constructor for <B>CPropertySheet</B> is used as the title in the dialog’s title bar. Before calling <B>DoModal</B>, the current values are copied into the property sheet. After <B>DoModal</B> returns, the new values are copied back. </P>

<P>The following figure shows what DRAWCLI’s property page looks like. For more information on implementing property pages with MFC, see <A HREF="_core_property_sheets_and_property_pages.htm">Property Sheets and Property Pages</A> and the descriptions of <A HREF="JavaScript:hhobj_4.Click()">CPropertyPage</A> and <A HREF="JavaScript:hhobj_5.Click()">CPropertySheet</A> in the <I>Class Library Reference</I>. For a demonstration of different types of property sheets, see the <A HREF="JavaScript:hhobj_6.Click()">PROPDLG</A> sample application in the MFC samples.</P>

<P class=label><B>DRAWCLI’s New Property Sheet</B></P>

<P><IMG SRC="propsht.gif" ALT="" BORDER=0></P>
</font>
</BODY>
</HTML>
