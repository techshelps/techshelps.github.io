<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Automation Servers</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Autoclik start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Autoclik start">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CCmdTarget">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleDispatchDriver">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_automation_servers"></A>Automation Servers</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_automation.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_automation_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_automation_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A></P>

<P>Automation makes it possible for your application to manipulate objects implemented in another application, or to expose objects so they can be manipulated. An Automation server is an application that exposes programmable objects to other applications, which are called Automation clients. Exposing programmable objects enables clients to automate certain procedures by directly accessing the objects and functionality the server makes available.</P>

<P>Exposing objects this way is beneficial when applications provide functionality that is useful for other applications. For example, a word processor might expose its spell-checking functionality so that other programs can use it. Exposure of objects thus enables vendors to improve their applications’ functionality by using the ready-made functionality of other applications. </P>

<P>By exposing application functionality through a common, well-defined interface, Automation makes it possible to build applications in a single general programming language like Microsoft Visual Basic instead of in diverse, application-specific macro languages.</P>



<H2><A NAME="_core_support_for_automation_servers"></A>Support for Automation Servers</H2>

<P>ClassWizard, AppWizard, and the framework all provide extensive support for Automation servers. They handle much of the overhead involved in making an Automation server, so you can focus your efforts on the functionality of your application.</P>

<P>The framework’s principal mechanism for supporting Automation is the dispatch map, a set of macros that expands into the declarations and calls needed to expose methods and properties for OLE. A typical dispatch map looks like this:</P>

<PRE><CODE>BEGIN_DISPATCH_MAP(CMyServerDoc, COleServerDoc)
    //{{AFX_DISPATCH_MAP(CMyServerDoc)
    DISP_PROPERTY(CMyServerDoc, "Msg", m_strMsg, VT_BSTR)
    DISP_FUNCTION(CMyServerDoc, "SetDirty", SetDirty, VT_EMPTY, VTS_I4)
    //}}AFX_DISPATCH_MAP
END_DISPATCH_MAP()
</CODE></PRE>

<P>ClassWizard assists in maintaining dispatch maps. When you add a new method or property to a class, ClassWizard adds a corresponding <CODE>DISP_FUNCTION</CODE> or <CODE>DISP_PROPERTY</CODE> macro with parameters indicating the class name, external and internal names of the method or property, and data types.</P>

<P>ClassWizard also simplifies the declaration of Automation classes and the management of their properties and operations. When you use ClassWizard to add a class to your project, you specify its base class. If the base class allows Automation, ClassWizard displays controls you use to specify whether the new class should support Automation, whether it is “OLE Createable” (that is, whether objects of the class can be created on a request from a COM client), and the external name for the COM client to use.</P>

<P>ClassWizard then creates a class declaration, including the appropriate macros for the OLE features you have specified. ClassWizard also adds the skeleton code for implementation of your class’s member functions.</P>

<P>AppWizard simplifies the steps involved in getting your automation server application off the ground. If you select Automation support in AppWizard’s OLE Options page, AppWizard adds to your application’s <B>InitInstance</B> function the calls required to register your Automation objects and run your application as an Automation server.</P>

<H3>What do you want to do?</H3>

<UL type=disc>
	<LI><A HREF="JavaScript:hhobj_3.Click()">Create an Automation server</A><BR><BR></LI>

	<LI><A HREF="_core_automation_clients.htm">Learn about Automation clients</A><BR><BR></LI>

	<LI><A HREF="JavaScript:hhobj_4.Click()">Learn more about class CCmdTarget</A><BR><BR></LI>

	<LI><A HREF="JavaScript:hhobj_5.Click()">Learn more about class COleDispatchDriver</A></LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_classwizard.3a_.automation_support.htm">ClassWizard: Automation Support</A>, <A HREF="_core_the_mfc_appwizard_.28.exe_version.293a_.step.2d.by.2d.step.htm">The MFC AppWizard (EXE version): Step-by-Step</A></P>
</font>
</BODY>
</HTML>
