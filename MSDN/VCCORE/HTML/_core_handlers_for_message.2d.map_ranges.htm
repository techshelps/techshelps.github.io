<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Handlers for Message-Map Ranges</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Scribble start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_ON_COMMAND_RANGE">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_ON_UPDATE_COMMAND_UI_RANGE">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_ON_CONTROL_RANGE">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_HIERSVR">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_handlers_for_message.2d.map_ranges"></A>Handlers for Message-Map Ranges</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_messages_and_commands.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_message.2d.mapping_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A></P>

<P>This article explains how to map a range of messages to a single message handler function (instead of mapping one message to only one function).</P>

<P>There are times when you need to process more than one message or control notification in exactly the same way. At such times, you might wish to map all of the messages to a single handler function. Message-map ranges allow you to do this for a contiguous range of messages:

<UL type=disc>
	<LI>You can map ranges of command IDs to:
<UL type=disc>
	<LI>A command handler function.<BR><BR></LI>

	<LI>A command update handler function.</LI>
</UL>
</LI>

	<LI>You can map control-notification messages for a range of control IDs to a message handler function.</LI>
</UL>

<P>Topics covered in this article include:

<UL type=disc>
	<LI><A HREF="#_core_writing_the_message.2d.map_entry">Writing the message-map entry</A><BR><BR></LI>

	<LI><A HREF="#_core_declaring_the_handler_function">Declaring the handler function</A><BR><BR></LI>

	<LI><A HREF="#_core_example_for_a_range_of_command_ids">Example for a range of command IDs</A><BR><BR></LI>

	<LI><A HREF="#_core_example_for_a_range_of_control_ids">Example for a range of control IDs</A></LI>
</UL>

<P class=indent><B><B>Important</B></B>&nbsp;&nbsp;&nbsp;ClassWizard does not support message-map ranges, so you must write the message-map entries and handler function declarations yourself. </P>



<H2><A NAME="_core_writing_the_message.2d.map_entry"></A>Writing the Message-Map Entry</H2>

<P>In the .CPP file, add your message-map entry, as shown in the following example:</P>

<PRE><CODE>...
BEGIN_MESSAGE_MAP(CMyApp, CWinApp)
    //{{AFX_MSG_MAP(CMyApp)
    ...
    //}}AFX_MSG_MAP
ON_COMMAND_RANGE(ID_MYCMD_ONE, ID_MYCMD_TEN, OnDoSomething)
END_MESSAGE_MAP( )
...
</CODE></PRE>

<P>The message-map entry consists of the following items:

<UL type=disc>
	<LI>The message-map range macro: 
<UL type=disc>
	<LI><A HREF="JavaScript:hhobj_3.Click()">ON_COMMAND_RANGE</A><BR><BR></LI>

	<LI><A HREF="JavaScript:hhobj_4.Click()">ON_UPDATE_COMMAND_UI_RANGE</A><BR><BR></LI>

	<LI><A HREF="JavaScript:hhobj_5.Click()">ON_CONTROL_RANGE</A></LI>
</UL>
</LI>

	<LI>Parameters to the macro:
<P class=tl>The first two macros take three parameters:</P>
<UL type=disc>
	<LI>The command ID that starts the range<BR><BR></LI>

	<LI>The command ID that ends the range<BR><BR></LI>

	<LI>The name of the message handler function</LI>
</UL>

<P class=tl>The range of command IDs must be contiguous.</P>
<P class=tl>The third macro, <B>ON_CONTROL_RANGE</B>, takes an additional first parameter: a control-notification message, such as <B>EN_CHANGE</B>.</P></LI>
</UL>



<H2><A NAME="_core_declaring_the_handler_function"></A>Declaring the Handler Function</H2>

<P>In the .H file, add your handler function declaration outside the <CODE>//{{AFX_MSG</CODE> comment brackets. The following code shows how this might look, as shown in the next-to-last line below:</P>

<PRE><CODE>// Generated message-map functions
protected:
    //{{AFX_MSG(CMyApp)   
        ...
    //}}AFX_MSG
    afx_msg void OnDoSomething( UINT nID );
    DECLARE_MESSAGE_MAP()
</CODE></PRE>

<P>Handler functions for single commands normally take no parameters. With the exception of update handler functions, handler functions for message-map ranges require an extra parameter, <I>nID</I>, of type <B>UINT</B>. This parameter is the first parameter. The extra parameter accommodates the extra command ID needed to specify which command the user actually chose.&nbsp; </P>

<P>See <A HREF="#_core_example_for_a_range_of_command_ids">Example for a Range of Command IDs</A> for more information about parameter requirements for updating handler functions.</P>



<H2><A NAME="_core_example_for_a_range_of_command_ids"></A>Example for a Range of Command IDs</H2>

<P>When might you use ranges? One example is in handling commands like the Zoom command in the MFC sample <A HREF="JavaScript:hhobj_6.Click()">HIERSVR</A>. This command zooms the view, scaling it between 25% and 300% of its normal size. HIERSVR’s view class uses a range to handle the Zoom commands with a message-map entry resembling this:</P>

<PRE><CODE>ON_COMMAND_RANGE(ID_VIEW_ZOOM25, ID_VIEW_ZOOM300, OnZoom)
</CODE></PRE>

<P>When you write the message-map entry, you specify:

<UL type=disc>
	<LI>Two command IDs, beginning and ending a contiguous range.
<P class=tl>Here they are <CODE>ID_VIEW_ZOOM25</CODE> and <CODE>ID_VIEW_ZOOM300</CODE>.</P></LI>

	<LI>The name of the handler function for the commands.
<P class=tl>Here it’s <CODE>OnZoom</CODE>.</P></LI>
</UL>

<P>The function declaration would resemble this:</P>

<PRE><CODE>afx_msg void OnZoom(UINT nID);
</CODE></PRE>

<P>The case of update handler functions is similar, and likely to be more widely useful. It’s quite common to write <B>ON_UPDATE_COMMAND_UI</B> handlers for a number of commands and find yourself writing, or copying, the same code over and over. The solution is to map a range of command IDs to one update handler function using the <B>ON_UPDATE_COMMAND_UI_RANGE</B> macro. The command IDs must form a contiguous range. For an example, see the <B>OnUpdateZoom</B> handler and its <B>ON_UPDATE_COMMAND_UI_RANGE</B> message-map entry in the HIERSVR sample’s view class.</P>

<P>Update handler functions for single commands normally take a single parameter, <I>pCmdUI</I>, of type <B>CCmdUI*</B>. Unlike handler functions, update handler functions for message-map ranges do not require an extra parameter, <I>nID</I>, of type <B>UINT</B>. The command ID, which is needed to specify which command the user actually chose, is found in the <B>CCmdUI</B> object.</P>



<H2><A NAME="_core_example_for_a_range_of_control_ids"></A>Example for a Range of Control IDs</H2>

<P>Another interesting case is mapping control-notification messages for a range of control IDs to a single handler. Suppose the user can click any of 10 buttons. To map all 10 buttons to one handler, your message-map entry would look like this:</P>

<PRE><CODE>ON_CONTROL_RANGE(BN_CLICKED, IDC_BUTTON1, IDC_BUTTON10, OnButtonClicked)
</CODE></PRE>

<P>When you write the <B>ON_CONTROL_RANGE</B> macro in your message map, you specify:

<UL type=disc>
	<LI>A particular control-notification message. 
<P class=tl>Here it’s <B>BN_CLICKED</B>.</P></LI>

	<LI>The control ID values associated with the contiguous range of controls. 
<P class=tl>Here these are <CODE>IDC_BUTTON1</CODE> and <CODE>IDC_BUTTON10</CODE>.</P></LI>

	<LI>The name of the message handler function.
<P class=tl>Here it’s <CODE>OnButtonClicked</CODE>.</P></LI>
</UL>

<P>When you write the handler function, specify the extra <B>UINT</B> parameter, as shown in the following:</P>

<PRE><CODE>...
void CMyDialog::OnButtonClicked( UINT nID )
{
    int nButton = nID - IDC_BUTTON1;
    ASSERT( nButton &gt;= 0 &amp;&amp; nButton &lt; 10 );
    // ...
}
</CODE></PRE>

<P>The <CODE>OnButtonClicked</CODE> handler for a single <B>BN_CLICKED</B> message takes no parameters. The same handler for a range of buttons takes one <B>UINT</B>. The extra parameter allows for identifying the particular control responsible for generating the <B>BN_CLICKED</B> message.</P>

<P>The code shown in the example is typical: converting the value passed to an <B>int</B> within the message range and asserting that this is the case. Then you might take some different action depending on which button was clicked.</P>
</font>
</BODY>
</HTML>
