<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Menus and Resources: Container Additions</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_OCLIENT">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_CONTAINER">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_menus_and_resources.3a_.container_additions"></A>Menus and Resources: Container Additions</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_ole_in_mfc.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_ole_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_ole_sample_list.htm">Sample</A>  |&nbsp; <A HREF="_core_ole_tutorial_list.htm">Tutorial</A></P>

<P>This article explains the changes that need to be made to the menus and other resources in a visual editing container application. </P>

<P>In container applications, two types of changes need to be made: modifications to existing resources to support OLE visual editing and addition of new resources used for in-place activation. If you use AppWizard to create your container application, these steps will be done for you, but they may require some customization.</P>

<P>If you don’t use AppWizard, you may want to look at OCLIENT.RC, the resource script for the OCLIENT sample application, to see how these changes are implemented. See the MFC OLE sample <A HREF="JavaScript:hhobj_2.Click()">OCLIENT</A>.</P>

<P>Topics covered in this article include:

<UL type=disc>
	<LI><A HREF="#_core_container_menu_additions">Container menu additions</A><BR><BR></LI>

	<LI><A HREF="#_core_container_application_accelerator_table_additions">Accelerator table additions</A><BR><BR></LI>

	<LI><A HREF="#_core_string_table_additions_for_container_applications">String table additions</A></LI>
</UL>



<H2><A NAME="_core_container_menu_additions"></A>Container Menu Additions</H2>

<P>You must add the following items to the Edit menu:</P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=34%><B>Item</B></TD>
<TD class=label width=66%><B>Purpose</B></TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>Insert New Object...</B></TD>
<TD width=66%>Opens the OLE Insert Object dialog box to insert a linked or embedded item into the document.</TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>Paste Link</B></TD>
<TD width=66%>Pastes a link to the item on the Clipboard into the document.</TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>OLE Verb</B></TD>
<TD width=66%>Calls the selected item’s primary verb. The text of this menu item changes to reflect the primary verb of the selected item.</TD>
</TR>

<TR VALIGN="top">
<TD width=34%><B>Links...</B></TD>
<TD width=66%>Opens the OLE Edit Links dialog box to change existing linked items.</TD>
</TR>
</TABLE><BR>

<P>In addition to the changes listed in this article, your source file must include AFXOLECL.RC, which is required for the Microsoft Foundation Class Library implementation. Insert New Object is the only required menu addition. Other items can be added, but those listed here are the most common. </P>

<P>You must create a new menu for your container application if you want to support in-place activation of contained items. This menu consists of the same File menu and Window pop-up menus used when files are open, but it has two separators placed between them. These separators are used to indicate where the server (component) item (application) should place its menus when activated in place. For more information on this menu-merging technique, see the article <A HREF="_core_menus_and_resources.3a_.menu_merging.htm">Menus and Resources: Menu Merging</A>. </P>



<H2><A NAME="_core_container_application_accelerator_table_additions"></A>Container Application Accelerator Table Additions</H2>

<P>Small changes to a container application’s accelerator table resources are necessary if you are supporting in-place activation. The first change allows the user to press the escape key (ESC) to cancel the in-place editing mode. Add the following entry to the main accelerator table:</P>

<TABLE border=1 cellpadding=5 cols=3 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=37%><B>ID</B></TD>
<TD class=label width=31%><B>Key</B></TD>
<TD class=label width=32%><B>Type</B></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>ID_CANCEL_EDIT_CNTR</B></TD>
<TD width=31%>VK_ESCAPE</TD>
<TD width=32%><B>VIRTKEY</B></TD>
</TR>
</TABLE><BR>

<P>The second change is to create a new accelerator table that corresponds to the new menu resource created for in-place activation. This table has entries for the File and Window menus in addition to the <B>VK_ESCAPE</B> entry above. The following example is the accelerator table created for in-place activation in the MFC tutorial <A HREF="JavaScript:hhobj_3.Click()">CONTAINER</A>:</P>

<TABLE border=1 cellpadding=5 cols=3 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=37%><B>ID</B></TD>
<TD class=label width=31%><B>Key</B></TD>
<TD class=label width=32%><B>Type</B></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>ID_FILE_NEW</B></TD>
<TD width=31%>CTRL + N</TD>
<TD width=32%><B>VIRTKEY</B></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>ID_FILE_OPEN</B></TD>
<TD width=31%>CTRL + O</TD>
<TD width=32%><B>VIRTKEY</B></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>ID_FILE_SAVE</B></TD>
<TD width=31%>CTRL + S</TD>
<TD width=32%><B>VIRTKEY</B></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>ID_FILE_PRINT</B></TD>
<TD width=31%>CTRL + P</TD>
<TD width=32%><B>VIRTKEY</B></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>ID_NEXT_PANE</B></TD>
<TD width=31%>VK_F6</TD>
<TD width=32%><B>VIRTKEY</B></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>ID_PREV_PANE</B></TD>
<TD width=31%>SHIFT + VK_F6</TD>
<TD width=32%><B>VIRTKEY</B></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>ID_CANCEL_EDIT_CNTR</B></TD>
<TD width=31%>VK_ESCAPE</TD>
<TD width=32%><B>VIRTKEY</B></TD>
</TR>
</TABLE><BR>



<H2><A NAME="_core_string_table_additions_for_container_applications"></A>String Table Additions for Container Applications</H2>

<P>Most of the changes to string tables for container applications correspond to the additional menu items mentioned in <A HREF="#_core_container_menu_additions">Container Menu Additions</A>. They supply the text displayed in the status bar when each menu item is displayed. As an example, here are the string-table entries AppWizard generates:</P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=40%><B>ID</B></TD>
<TD class=label width=60%><B>String</B></TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>IDP_OLE_INIT_FAILED</B></TD>
<TD width=60%>OLE initialization failed.&nbsp; Make sure that the OLE libraries are the correct version.</TD>
</TR>

<TR VALIGN="top">
<TD width=40%><B>IDP_FAILED_TO_CREATE</B></TD>
<TD width=60%>Failed to create object.&nbsp; Make sure that the object is entered in the system registry.</TD>
</TR>
</TABLE><BR>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_menus_and_resources.3a_.server_additions.htm">Menus and Resources: Server Additions</A> </P>
</font>
</BODY>
</HTML>
