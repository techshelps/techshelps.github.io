<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Initialize a DLL</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_dllmain">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_Dynamic_Link_Library_Entry_Point_Function">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_initialize_a_dll"></A>Initialize a DLL</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_dlls.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dll_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_dlls.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dll_topics.htm">Details</A>  |&nbsp; <A HREF="_core_dll_sample_programs.htm">Sample</A></P>

<P>Typically, your DLL has initialization code (such as allocating memory) that must execute when your DLL loads. When using Visual C++, where you add code to initialize your DLL depends on the kind of DLL you are building. If you don’t need to add initialization or termination code, there’s nothing special you have to do when building your DLL. If you need to initialize your DLL, the following table describes where to add your code. </P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=27%><B>Kind of DLL</B></TD>
<TD class=label width=73%><B>Where to add initialization and termination code</B></TD>
</TR>

<TR VALIGN="top">
<TD width=27%>Regular DLL </TD>
<TD width=73%>In the DLL’s <B>CWinApp</B> object’s <B>InitInstance</B> and <B>ExitInstance</B>.</TD>
</TR>

<TR VALIGN="top">
<TD width=27%>Extension&nbsp; DLL</TD>
<TD width=73%>In the <B>DllMain</B> function generated by AppWizard.</TD>
</TR>

<TR VALIGN="top">
<TD width=27%>Non-MFC DLL</TD>
<TD width=73%>In a function called <B>DllMain</B> that you provide.</TD>
</TR>
</TABLE><BR>

<P>In Win32, all DLLs may contain an optional entry-point function (usually called <B>DllMain</B>) that is called for both initialization and termination. This gives you an opportunity to allocate or release additional resources as needed. Windows calls the entry-point function in four situations: process attach, process detach, thread attach, and thread detach. </P>

<P>The C run-time library provides an entry-point function called <B>_DllMainCRTStartup</B>, and it calls <B>DllMain</B>. Depending on the kind of DLL, either you should have a function called <B>DllMain</B> in your source code or you should use the <B>DllMain</B> provided in the MFC library.</P>

<H3>What do you want to do?</H3>

<UL type=disc>
	<LI><A HREF="_core_initialize_regular_dlls.htm">Initialize regular DLLs</A><BR><BR></LI>

	<LI><A HREF="_core_initialize_extension_dlls.htm">Initialize extension DLLs</A><BR><BR></LI>

	<LI><A HREF="_core_initialize_non.2d.mfc_dlls.htm">Initialize non-MFC DLLs</A></LI>
</UL>

<H3>What do you want to know more about?</H3>

<UL type=disc>
	<LI><A HREF="_core_run.2d.time_library_behavior.htm">The C run-time library behavior and _DllMainCRTStartup</A><BR><BR></LI>

	<LI><A HREF="JavaScript:hhobj_2.Click()">The function specification for DllMain (Win32 SDK documentation)</A><BR><BR></LI>

	<LI><A HREF="JavaScript:hhobj_3.Click()">Dynamic-link library entry-point function (Win32 SDK documentation)</A></LI>
</UL>
</font>
</BODY>
</HTML>
