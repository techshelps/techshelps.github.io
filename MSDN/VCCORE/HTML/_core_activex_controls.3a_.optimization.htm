<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ActiveX Controls: Optimization</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="circle sample start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleControl">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_COleControl">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_COleControl">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_activex_controls.3a_.optimization"></A>ActiveX Controls: Optimization</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_activex_controls.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_activex_control_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_frequently_asked_questions_about_activex_controls.htm">FAQ</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_activex_control_sample_list.htm">Sample</A></P>

<P>This article explains techniques you can use to optimize your ActiveX controls for better performance. </P>

<H3>What do you want to know more about?</H3>

<UL type=disc>
	<LI><A HREF="_core_optimizing_persistence_and_initialization.htm">Optimizing Persistence and Initialization</A><BR><BR></LI>

	<LI><A HREF="_core_providing_windowless_activation.htm">Providing Windowless Activation</A><BR><BR></LI>

	<LI><A HREF="_core_turning_off_the_activate_when_visible_option.htm">Turning Off the Activate When Visible Option</A><BR><BR></LI>

	<LI><A HREF="_core_providing_mouse_interaction_while_inactive.htm">Providing Mouse Interaction While Inactive</A> <BR><BR></LI>

	<LI><A HREF="_core_providing_flicker.2d.free_activation.htm">Providing Flicker-Free Activation</A><BR><BR></LI>

	<LI><A HREF="_core_using_an_unclipped_device_context.htm">Using an Unclipped Device Context</A><BR><BR></LI>

	<LI><A HREF="_core_optimizing_control_drawing.htm">Optimizing Control Drawing</A> </LI>
</UL>

<P>The topics Turning Off the Activate When Visible Option and Providing Mouse Interaction While Inactive discuss controls that don’t create a window until activated. The topic <A HREF="_core_providing_windowless_activation.htm">Providing Windowless Activation</A> discusses controls that never create a window, even when they are activated. </P>

<P>Windows have two major drawbacks for OLE objects: they prevent objects from being transparent or nonrectangular when active, and they add a large overhead to the instantiation and display of controls. Typically, creating a window takes 60 percent of a control’s creation time. With a single shared window (usually the container’s) and some dispatching code, a control receives the same window services, generally without a loss of performance. Having a window is mostly unnecessary overhead for the object.</P>

<P>Some optimizations do not necessarily improve performance when your control is used in certain containers. For example, containers released prior to 1996 did not support windowless activation, so implementing this feature will not provide a benefit in older containers. However, nearly every container supports persistence, so optimizing your control’s persistence code will likely improve its performance in any container. If your control is specifically intended to be used with one particular type of container, you may want to research which of these optimizations is supported by that container. In general, however, you should try to implement as many of these techniques as are applicable to your particular control to ensure your control performs as well as it possibly can in a wide array of containers.</P>

<P>You can implement many of these optimizations through ControlWizard.</P>

<P class=label><B>ControlWizard OLE Optimization Options</B></P>

<TABLE border=1 cellpadding=5 cols=3 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=55%><B>ControlWizard Option</B></TD>
<TD class=label width=11%><B>Action</B></TD>
<TD class=label width=34%><B>More Information</B></TD>
</TR>

<TR VALIGN="top">
<TD width=55%>Activate when visible checkbox on ControlWizard Step 2 of 2</TD>
<TD width=11%>Clear</TD>
<TD width=34%><A HREF="_core_turning_off_the_activate_when_visible_option.htm">Turning Off the Activate When Visible Option</A></TD>
</TR>

<TR VALIGN="top">
<TD width=55%>Windowless activation checkbox on ControlWizard Advanced ActiveX Features</TD>
<TD width=11%>Select</TD>
<TD width=34%><A HREF="_core_providing_windowless_activation.htm">Providing Windowless Activation</A></TD>
</TR>

<TR VALIGN="top">
<TD width=55%>Unclipped device context</TD>
<TD width=11%>Select</TD>
<TD width=34%><A HREF="_core_using_an_unclipped_device_context.htm">Using an Unclipped Device Context</A></TD>
</TR>

<TR VALIGN="top">
<TD width=55%>Flicker-free activation checkbox on ControlWizard Advanced ActiveX Features</TD>
<TD width=11%>Select</TD>
<TD width=34%><A HREF="_core_providing_flicker.2d.free_activation.htm">Providing Flicker-Free Activation</A></TD>
</TR>

<TR VALIGN="top">
<TD width=55%>Mouse pointer notifications when inactive checkbox on ControlWizard Advanced ActiveX Features</TD>
<TD width=11%>Select</TD>
<TD width=34%><A HREF="_core_providing_mouse_interaction_while_inactive.htm">Providing Mouse Interaction While Inactive</A></TD>
</TR>

<TR VALIGN="top">
<TD width=55%>Optimized drawing code checkbox on ControlWizard Advanced ActiveX Features</TD>
<TD width=11%>Select</TD>
<TD width=34%><A HREF="_core_optimizing_control_drawing.htm">Optimizing Control Drawing</A></TD>
</TR>
</TABLE><BR>

<P>For detailed information about the member functions that implement these optimizations, see <A HREF="JavaScript:hhobj_3.Click()">COleControl</A>. The member functions are listed by use, such as <A HREF="JavaScript:hhobj_4.Click()">Windowless Operations</A> and <A HREF="JavaScript:hhobj_5.Click()">Inactive Pointer Handling Functions</A>.</P>
</font>
</BODY>
</HTML>
