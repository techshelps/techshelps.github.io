<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ClassWizard: Mapping Form Controls to Recordset Fields</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Scribble start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordView">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordView">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordView">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordView">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_classwizard.3a_.mapping_form_controls_to_recordset_fields"></A>ClassWizard: Mapping Form Controls to Recordset Fields</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_working_with_classes.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_working_with_classes_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A></P>

<P>A database form based on class <A HREF="JavaScript:hhobj_3.Click()">CRecordView</A> (for the MFC ODBC classes) or <A HREF="JavaScript:hhobj_4.Click()">CDaoRecordView</A> (for the MFC DAO classes) uses dialog data exchange (DDX) to exchange data between the form's controls and the field data members of the form's associated recordset object. This article explains how to use ClassWizard to set up the DDX connection between the controls and the recordset.</P>

<P>This connection is different from the normal use of DDX, which connects the controls in a dialog box directly to the data members of the associated dialog class. DDX for a record view object is indirect. The connection goes from form controls through the record view object to the field data members of the associated recordset object. For more information, see the articles <A HREF="_core_record_views.htm">Record Views</A> and <A HREF="_core_classwizard.3a_.foreign_objects.htm">ClassWizard: Foreign Objects</A>. The following table summarizes the mapping process.</P>

<P class=label><B>Mapping Record View Controls to a Recordset</B></P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=41%><B>To</B></TD>
<TD class=label width=59%><B>Do this</B></TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Specify the form control </TD>
<TD width=59%>Select the record view class on ClassWizard's Member Variables tab and select one of the form's control IDs</TD>
</TR>

<TR VALIGN="top">
<TD width=41%>Specify the recordset data member to connect it to</TD>
<TD width=59%>Use the Add Variable dialog box to select a recordset data member indirectly</TD>
</TR>
</TABLE><BR>

<P>The following procedure assumes you have already followed the procedures in the article <A HREF="_core_classwizard.3a_.creating_a_database_form.htm">ClassWizard: Creating a Database Form</A>. Specifically, you've created a <A HREF="JavaScript:hhobj_5.Click()">CRecordset</A>-derived or <A HREF="JavaScript:hhobj_6.Click()">CDaoRecordset</A>-derived class and added some field data members to it, created a dialog-template resource, created a <A HREF="JavaScript:hhobj_7.Click()">CRecordView</A>-derived or <A HREF="JavaScript:hhobj_8.Click()">CDaoRecordView</A>-derived class, and associated the record view class with the recordset class. Your record view class is associated with the dialog-template resource, to which you've added controls with the Visual C++ dialog editor.</P>

<P class=label><B><A NAME="_core_to_map_the_form_controls_to_the_recordset"></A>To map the form controls to the recordset</B>

<OL>
	<LI>Click ClassWizard's <B>Member Variables</B> tab.<BR><BR></LI>

	<LI>In the <B>Class Name</B> box, select the name of your record view class.<BR><BR></LI>

	<LI>In the <B>Control IDs</B> box, select a control ID.<BR><BR></LI>

	<LI>Click the <B>Add Variable</B> button to name a variable associated with the control.<BR><BR></LI>

	<LI>In the <B>Add Member Variable</B> dialog box, choose a variable name by selecting a recordset data member in the <B>Member Variable Name</B> drop-down list box. 
<P class=atl><B><B>Important</B></B>&nbsp;&nbsp;&nbsp;Use the drop-down list box to select a data member name from the associated recordset (a <A HREF="_core_classwizard.3a_.foreign_objects.htm">foreign object</A>). The names that appear are of the form <CODE>m_pSet-&gt;m_recordsetVarName</CODE>. You can type the name instead, but selecting from the drop-down list is faster and more accurate.</p>
<P class=tl>All variables of the recordset class appear in the box, not just variables of the currently selected data type.</P></LI>

	<LI>Click <B>OK</B> to close the <B>Add Member Variable</B> dialog box.<BR><BR></LI>

	<LI>Repeat steps 3 through 6 for each control in the record view that you want to map to a recordset field data member.<BR><BR></LI>

	<LI>Click <B>OK</B> to close ClassWizard.</LI>
</OL>

<P>By selecting a name from the drop-down list, you specify a connection that passes through the record view object to a field data member of its associated recordset object. </P>

<P class=indent><B><B>Tip</B></B>&nbsp;&nbsp;&nbsp;If you're running ClassWizard with the Visual C++ dialog editor open, the following shortcut is available. Choose a control on the form; then press CTRL and double-click the mouse. This opens ClassWizard's Add Member Variables dialog box, where you can bind a recordset field data member to the control. (If you use this shortcut before a class has been created for the dialog template, ClassWizard opens and displays its Add Class dialog box.)</P>

<P class=indent>If you follow a simple rule when placing controls on your record view form, ClassWizard is able to pre-select the most likely recordset member in the dialog box. The rule is to place the static text label for the control ahead of the corresponding control in the tab order.</P>

<P class=indent><B><B>Tip</B></B>&nbsp;&nbsp;&nbsp;You can use CTRL+double-click for pushbuttons too. In these cases, ClassWizard creates a message handler function for the <B>BN_CLICKED</B> notification message in your record view class. You can edit its code to specify the button's action.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_classwizard.3a_.foreign_objects.htm">ClassWizard: Foreign Objects</A> </P>
</font>
</BODY>
</HTML>
