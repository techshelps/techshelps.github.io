<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO Querydef: Using Querydefs</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Create">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Append">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Execute">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Close">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Create">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.SetConnect">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.SetODBCTimeout">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.SetReturnsRecords">
</OBJECT>
<OBJECT ID="hhobj_15" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.SetName">
</OBJECT>
<OBJECT ID="hhobj_16" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.SetSQL">
</OBJECT>
<OBJECT ID="hhobj_17" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Append">
</OBJECT>
<OBJECT ID="hhobj_18" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Append">
</OBJECT>
<OBJECT ID="hhobj_19" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Execute">
</OBJECT>
<OBJECT ID="hhobj_20" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef">
</OBJECT>
<OBJECT ID="hhobj_21" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_22" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Append">
</OBJECT>
<OBJECT ID="hhobj_23" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Create">
</OBJECT>
<OBJECT ID="hhobj_24" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Append">
</OBJECT>
<OBJECT ID="hhobj_25" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Execute">
</OBJECT>
<OBJECT ID="hhobj_26" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef">
</OBJECT>
<OBJECT ID="hhobj_27" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Create">
</OBJECT>
<OBJECT ID="hhobj_28" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Append">
</OBJECT>
<OBJECT ID="hhobj_29" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_30" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_31" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Execute">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_querydef.3a_.using_querydefs"></A>DAO Querydef: Using Querydefs</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains how to use <A HREF="JavaScript:hhobj_3.Click()">CDaoQueryDef</A> objects. Topics covered include:

<UL type=disc>
	<LI><A HREF="#_core_creating_a_querydef">Creating a querydef</A><BR><BR></LI>

	<LI><A HREF="#_core_saving_a_querydef">Saving a querydef</A> (in Microsoft Jet (.MDB) databases only)<BR><BR></LI>

	<LI><A HREF="#_core_opening_a_previously_saved_querydef">Opening a previously saved querydef</A><BR><BR></LI>

	<LI><A HREF="#_core_using_a_temporary_querydef">Using a temporary querydef</A><BR><BR></LI>

	<LI><A HREF="#_core_creating_a_recordset_from_a_querydef">Creating a recordset from a querydef</A><BR><BR></LI>

	<LI><A HREF="#_core_executing_a_querydef">Directly executing a query</A> (an action query or an SQL pass-through query that doesn't return records)</LI>
</UL>

<P>For a general understanding of querydefs and their uses, see the topic "QueryDef Object" in DAO Help.</P>



<H2><A NAME="_core_creating_a_querydef"></A>Creating a Querydef</H2>

<P>Creating a querydef, whether you save it in the database or use it as a temporary object, requires specifying the SQL statement that defines the query and setting any needed properties of the querydef. If the querydef represents a parameterized query, you also need to create the parameters and their corresponding fields and later set their values.</P>

<P class=indent><B><B>Tip&nbsp;&nbsp;&nbsp;</B></B>You can also set and get field values and parameter values (in a recordset) dynamically, without using a querydef. See the article <A HREF="_core_dao_recordset.3a_.binding_records_dynamically.htm">DAO Recordset: Binding Records Dynamically</A>.</P>

<P>Creating a new MFC <A HREF="JavaScript:hhobj_4.Click()">CDaoQueryDef</A> object creates the underlying DAO querydef object.</P>

<P class=label><B>To create a querydef</B>

<OL>
	<LI>Construct a <A HREF="JavaScript:hhobj_5.Click()">CDaoQueryDef</A> object.<BR><BR></LI>

	<LI>Call the querydef object's <A HREF="JavaScript:hhobj_6.Click()">Create</A> member function.
<P class=tl>In the <B>Create</B> call, pass a user-defined name for the querydef and a string that contains the SQL statement on which the querydef is based. While you can define the SQL string for a recordset with AppWizard or ClassWizard, you must write the SQL string for a querydef yourself. (You usually use class <B>CDaoQueryDef</B> directly rather than deriving your own querydef classes from it.)</P></LI>

	<LI>Save the querydef object in the database by calling its <A HREF="JavaScript:hhobj_7.Click()">Append</A> member function, unless you want to work with a temporary (unsaved) querydef. (See <A HREF="#_core_using_a_temporary_querydef">Using a Temporary Querydef</A>.)<BR><BR></LI>

	<LI>Either create a recordset based on the querydef or call the querydef object's <A HREF="JavaScript:hhobj_8.Click()">Execute</A> member function.</LI>
</OL>

<P>Close the querydef when you finish with it. Call its <A HREF="JavaScript:hhobj_9.Click()">Close</A> member function. For more information, see the detailed instructions under <A HREF="JavaScript:hhobj_10.Click()">CDaoQueryDef::Create</A> in the <I>Class Library Reference</I>.</P>

<P>Querydef objects have several properties you can set — primarily for querydefs to be used with ODBC data sources.</P>

<P class=label><B>To set a querydef's properties (primarily for ODBC)</B>

<OL>
	<LI>Create the querydef, using a <A HREF="JavaScript:hhobj_11.Click()">CDaoQueryDef</A> object, as described above.<BR><BR></LI>

	<LI>Call any of the following member functions: <A HREF="JavaScript:hhobj_12.Click()">SetConnect</A>, <A HREF="JavaScript:hhobj_13.Click()">SetODBCTimeout</A>, <A HREF="JavaScript:hhobj_14.Click()">SetReturnsRecords</A>, <A HREF="JavaScript:hhobj_15.Click()">SetName</A>, <A HREF="JavaScript:hhobj_16.Click()">SetSQL</A>.<BR><BR></LI>

	<LI>Save the querydef in the QueryDefs collection by calling <A HREF="JavaScript:hhobj_17.Click()">Append</A>, unless you want to use the querydef as a temporary object. (See <A HREF="#_core_using_a_temporary_querydef">Using a Temporary Querydef</A>.)<BR><BR></LI>

	<LI>Use the querydef.</LI>
</OL>

<P>You can use <B>SetName</B> and <B>SetSQL</B> for a querydef based on any kind of database. You can call these member functions at any time to rename the querydef object or to respecify its SQL statement. <B>SetReturnsRecords</B> applies only to SQL pass-through queries. The other functions apply only to ODBC data sources. </P>

<P>After creating a querydef, you will usually want to save it in the database by appending it to the QueryDefs collection. See <A HREF="#_core_saving_a_querydef">Saving a Querydef</A>. The alternative is to use the querydef as a temporary object. See <A HREF="#_core_using_a_temporary_querydef">Using a Temporary Querydef</A>. You can’t use the querydef unless you correctly create it as a temporary querydef or you append it to the collection.</P>

<P>Once created, use the querydef to create recordsets or to execute action queries or SQL pass-through queries. For information about action queries and SQL pass-through queries, see the article <A HREF="_core_dao_querydef.3a_.action_queries_and_sql_pass.2d.through_queries.htm">DAO Querydef: Action Queries and SQL Pass-Through Queries</A>.</P>



<H2><A NAME="_core_saving_a_querydef"></A>Saving a Querydef</H2>

<P>A saved querydef persists in its database (.MDB only), stored there along with the database's tables and data. You can think of a saved query as a compiled SQL statement — when you run the query, it executes faster than a standard new query because the database engine doesn't have to compile the SQL statement before executing it.</P>

<P class=indent><B><B>Tip&nbsp;&nbsp;&nbsp;</B></B>The easiest way to create a querydef is to do it in Microsoft Access. Open your target .MDB database, create querydefs, and save them in the database. Then you can use the querydefs in your code.</P>

<P class=label><B>To save a querydef</B>

<OL>
	<LI>Create the querydef as described under <A HREF="#_core_creating_a_querydef">Creating a Querydef</A>.<BR><BR></LI>

	<LI>Call <A HREF="JavaScript:hhobj_18.Click()">CDaoQueryDef::Append</A> for the object.</LI>
</OL>

<P>Appending the querydef object to the database's QueryDefs collection makes the object persistent between database engine sessions. You can open and run the query, or modify it, at any time. Other users of your database can use the querydef as well.</P>

<P>The alternative to saving a querydef is using it as a temporary object.</P>



<H2><A NAME="_core_opening_a_previously_saved_querydef"></A>Opening a Previously Saved Querydef</H2>

<P>Once you’ve saved a querydef in a database’s QueryDefs collection, you can open it at any time and run its query, either by creating a recordset or by calling <A HREF="JavaScript:hhobj_19.Click()">Execute</A>.</P>

<P class=label><B>To open a saved querydef</B>

<OL>
	<LI>Construct a <A HREF="JavaScript:hhobj_20.Click()">CDaoQueryDef</A> object.<BR><BR></LI>

	<LI>Call its <A HREF="JavaScript:hhobj_21.Click()">Open</A> member function.
<P class=tl>In the <B>Open</B> call, pass the user-defined name under which the querydef was stored.</P></LI>
</OL>



<H2><A NAME="_core_using_a_temporary_querydef"></A>Using a Temporary Querydef</H2>

<P>A temporary querydef object has the following characteristics:

<UL type=disc>
	<LI>It is never appended to the QueryDefs collection in the database, unlike a saved querydef.<BR><BR></LI>

	<LI>It is created by passing either <B>NULL</B> or an empty string for the querydef’s name.</LI>
</UL>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>MFC differs from the underlying DAO implementation in the way querydefs are appended to the collection. In DAO, a newly created querydef (provided you give it a name) is automatically appended to the QueryDefs collection. In MFC, you must explicitly call <A HREF="JavaScript:hhobj_22.Click()">Append</A>.</P>

<P>Saved querydefs are accessible to other users of your database (who have the appropriate permissions, if security is in effect). Temporary querydefs are not accessible to other users. In some cases, you might want to create a querydef and use it without storing it. For example, you might want to use querydef parameters but not want to save the querydef for reuse.</P>

<P>Whether a querydef is temporary or not depends on what you pass in the <I>lpszName</I> parameter to <A HREF="JavaScript:hhobj_23.Click()">Create</A>. Querydefs can be in one of the states listed in the following table.</P>

<P class=label><B>QueryDef States and Their Meanings</B></P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=19%><B>State</B></TD>
<TD class=label width=81%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=19%>Appended</TD>
<TD width=81%>You give the querydef a name when you create it. Then you call <A HREF="JavaScript:hhobj_24.Click()">Append</A>.</TD>
</TR>

<TR VALIGN="top">
<TD width=19%>Unappended</TD>
<TD width=81%>You give the querydef a name but you haven’t called <B>Append</B>. The querydef is unusable. This is not the same thing as a temporary querydef.</TD>
</TR>

<TR VALIGN="top">
<TD width=19%>Temporary</TD>
<TD width=81%>You pass <B>NULL</B> or an empty string (“”) for the querydef name when you create the querydef. You can’t append a temporary querydef, because it has no name. But you can use it to create recordsets or to call the <A HREF="JavaScript:hhobj_25.Click()">Execute</A> member function.</TD>
</TR>
</TABLE><BR>

<P>The following procedure explains how to create temporary querydefs.</P>

<P class=label><B>To create a temporary querydef</B>

<OL>
	<LI>Construct a <A HREF="JavaScript:hhobj_26.Click()">CDaoQueryDef</A> object.<BR><BR></LI>

	<LI>Call its <A HREF="JavaScript:hhobj_27.Click()">Create</A> member function, passing <B>NULL</B> or an empty string (“”).<BR><BR></LI>

	<LI><I>Don't</I> call <A HREF="JavaScript:hhobj_28.Click()">CDaoQueryDef::Append</A>.</LI>
</OL>

<P>You can still use a temporary querydef to create recordsets or to execute action queries or SQL pass-through queries.</P>



<H2><A NAME="_core_creating_a_recordset_from_a_querydef"></A>Creating a Recordset from a Querydef</H2>

<P>The most common way to use a querydef is to base a recordset on it. The recordset inherits the querydef's SQL statement.</P>

<P class=label><B>To create a recordset from a querydef</B>

<OL>
	<LI>Create a saved or temporary querydef as described in <A HREF="#_core_creating_a_querydef">Creating a Querydef</A>, or open a previously saved querydef.<BR><BR></LI>

	<LI>Construct a <A HREF="JavaScript:hhobj_29.Click()">CDaoRecordset</A> object.<BR><BR></LI>

	<LI>Call the recordset object's <A HREF="JavaScript:hhobj_30.Click()">Open</A> member function, passing a pointer to your querydef object.</LI>
</OL>

<P>Calling <B>Open</B> runs the query. For a more detailed discussion, see the article <A HREF="_core_dao_recordset.3a_.creating_recordsets.htm">DAO Recordset: Creating Recordsets</A>. </P>

<P>You can create any number of recordsets from the same querydef object. They will all have the same SQL statement unless you change the querydef's SQL statement between creating recordsets.</P>

<P>For related information, see the article <A HREF="_core_dao_queries.htm">DAO Queries</A>.</P>



<H2><A NAME="_core_executing_a_querydef"></A>Executing a Querydef</H2>

<P>Not all queries return records. Queries that don't return records include:

<UL type=disc>
	<LI>Action queries, which update data or alter the database's structure.<BR><BR></LI>

	<LI>SQL pass-through queries, which pass the SQL statement to the back-end DBMS without processing it in the Microsoft Jet database engine.</LI>
</UL>

<P>To execute such queries, you use a querydef rather than a recordset. For more information about action queries and SQL pass-through queries, see the article <A HREF="_core_dao_querydef.3a_.action_queries_and_sql_pass.2d.through_queries.htm">DAO Querydef: Action Queries and SQL Pass-Through Queries</A>.</P>

<P class=label><B>To directly execute a query that doesn't return records</B>

<OL>
	<LI>Create a saved or temporary querydef as described in <A HREF="#_core_creating_a_querydef">Creating a Querydef</A>.<BR><BR></LI>

	<LI>Call the querydef's <B>Execute</B> member function.</LI>
</OL>

<P>For more information about executing queries, see <A HREF="JavaScript:hhobj_31.Click()">CDaoQueryDef::Execute</A> in the <I>Class Library Reference</I> and the topic "Execute Method" in DAO Help.</P>

<H3>What do you want to know more about?</H3>

<UL type=disc>
	<LI><A HREF="_core_dao_querydef.htm">DAO Querydef</A><BR><BR></LI>

	<LI><A HREF="_core_dao_recordset.htm">DAO Recordset</A><BR><BR></LI>

	<LI><A HREF="_core_dao_queries.htm">DAO Queries</A><BR><BR></LI>

	<LI><A HREF="_core_dao_querydef.3a_.action_queries_and_sql_pass.2d.through_queries.htm">DAO Querydef: Action Queries and SQL Pass-Through Queries</A></LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A></P>
</font>
</BODY>
</HTML>
