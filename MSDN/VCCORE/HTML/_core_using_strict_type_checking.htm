<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using STRICT Type Checking</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_using_strict_type_checking"></A><SUP></SUP>Using STRICT Type Checking</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_win32_programming.3a_.overview.htm">Overview</A> |&nbsp; <A HREF="_core_win32_programming_tasks.htm">How Do I</A></P>

<P>To get the most benefit from STRICT type checking, there are additional guidelines you should follow. Your code will be more portable in future versions of Windows if you make the following changes:</P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=15%><B>Change</B></TD>
<TD class=label width=85%><B>To</B></TD>
</TR>

<TR VALIGN="top">
<TD width=15%><B>HANDLE</B></TD>
<TD width=85%>A specific handle such as <B>HINSTANCE</B>, <B>HMODULE</B>, <B>HGLOBAL</B>, <B>HLOCAL</B>, and so on</TD>
</TR>

<TR VALIGN="top">
<TD width=15%><B>WORD</B></TD>
<TD width=85%><B>UINT</B>, except where you want a 16-bit value even when the platform is 32 bits</TD>
</TR>

<TR VALIGN="top">
<TD width=15%><B>WORD</B> </TD>
<TD width=85%><B>WPARAM</B>, where <I>wParam</I> is declared</TD>
</TR>

<TR VALIGN="top">
<TD width=15%><B>LONG</B></TD>
<TD width=85%><B>LPARAM</B> or <B>LRESULT</B> as appropriate</TD>
</TR>
</TABLE><BR>

<P>Whenever you need an integer data type, you should declare it as <B>UINT</B> except where a 16-bit value is specifically required (as in a structure or parameter). Even if a variable never exceeds the range of a 16-bit integer, it can be handled by the processor more efficiently if it is 32 bits.</P>

<P>The types <B>WPARAM</B>, <B>LPARAM</B>, <B>LRESULT</B>, and <B>void *</B> are “polymorphic data types.” They hold different kinds of data at different times, even when STRICT type checking is enabled. To get the benefit of type checking, you should cast values of these types as soon as possible. Note that message crackers (as well as the Microsoft Foundation classes) automatically recast <I>wParam</I> and <I>lParam</I> for you in a portable way.</P>

<P>Take special care to distinguish <B>HMODULE</B> and <B>HINSTANCE</B> types. Even with STRICT enabled, they are defined as the same base type. Most kernel module management functions use <B>HINSTANCE</B> types, but there are a few API functions that return or accept only <B>HMODULE</B> types.</P>
</font>
</BODY>
</HTML>
