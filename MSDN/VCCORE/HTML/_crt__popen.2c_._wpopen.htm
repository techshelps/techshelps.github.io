<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_popen, _wpopen</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_crt__popen.2c_._wpopen"></A><SUP></SUP>_popen, _wpopen</H1>

<P>Creates a pipe and executes a command.</P>

<P><B>FILE</B> <B>*_popen(</B> <B>const</B> <B>char</B> <B>*</B><I>command</I><B>,</B> <B>const</B> <B>char</B> <B>*</B><I>mode</I> <B>);</B></P>

<P><B>FILE</B> <B>*_wpopen(</B> <B>const</B> <B>wchar_t</B> <B>*</B><I>command</I><B>,</B> <B>const</B> <B>wchar_t</B> <B>*</B><I>mode</I> <B>);</B></P>

<TABLE border=1 cellpadding=5 cols=3 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=17%><B>Routine</B></TD>
<TD class=label width=37%><B>Required Header</B></TD>
<TD class=label width=46%><B>Compatibility</B></TD>
</TR>

<TR VALIGN="top">
<TD width=17%><B>_popen</B></TD>
<TD width=37%>&lt;stdio.h&gt;</TD>
<TD width=46%>Win 95, Win NT</TD>
</TR>

<TR VALIGN="top">
<TD width=17%><B>_wpopen</B></TD>
<TD width=37%>&lt;stdio.h&gt; or &lt;wchar.h&gt;</TD>
<TD width=46%>Win NT</TD>
</TR>
</TABLE><BR>

<P>For additional compatibility information, see <A HREF="_crt_compatibility.htm">Compatibility</A> in the Introduction.</P>

<P class=label><B>Libraries</B></P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD width=24%>LIBC.LIB</TD>
<TD width=76%>Single thread static library, retail version</TD>
</TR>

<TR VALIGN="top">
<TD width=24%>LIBCMT.LIB</TD>
<TD width=76%>Multithread static library, retail version</TD>
</TR>

<TR VALIGN="top">
<TD width=24%>MSVCRT.LIB</TD>
<TD width=76%>Import library for MSVCRT.DLL, retail version</TD>
</TR>
</TABLE><BR>

<P class=label><B>Return Value</B></P>

<P>Each of these functions returns a stream associated with one end of the created pipe. The other end of the pipe is associated with the spawned command’s standard input or standard output. The functions return <B>NULL</B> on an error.</P>

<P class=label><B>Parameters</B></P>

<P class=dt><I>command</I></P>

<P class=indent>Command to be executed</P>

<P class=dt><I>mode</I></P>

<P class=indent>Mode of returned stream</P>

<P class=label><B>Remarks</B></P>

<P>The <B>_popen</B> function creates a pipe and asynchronously executes a spawned copy of the command processor with the specified string <I>command</I>. The character string <I>mode</I> specifies the type of access requested, as follows:</P>

<P class=dt><B>"r"</B></P>

<P class=indent>The calling process can read the spawned command’s standard output via the returned stream.</P>

<P class=dt><B>"w"</B></P>

<P class=indent>The calling process can write to the spawned command’s standard input via the returned stream.</P>

<P class=dt><B>"b"</B></P>

<P class=indent>Open in binary mode.</P>

<P class=dt><B>"t"</B></P>

<P class=indent>Open in text mode.</P>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;The <B>_popen</B> function returns an invalid file handle, if used in a Windows program, that will cause the program to hang indefinitely. <B>_popen</B> works properly in a Console application. To create a Windows application that redirects input and output, read the section "Creating a Child Process with Redirected Input and Output" in the Win32 SDK.</P>

<P><B>_wpopen</B> is a wide-character version of <B>_popen</B>; the <I>path</I> argument to <B>_wpopen</B> is a wide-character string. <B>_wpopen</B> and <B>_popen</B> behave identically otherwise.</P>

<P class=label><B>Generic-Text Routine Mappings</B></P>

<TABLE border=1 cellpadding=5 cols=4 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=17%><B>TCHAR.H Routine </B></TD>
<TD class=label width=29%><B>_UNICODE &amp; _MBCS Not Defined</B></TD>
<TD class=label width=26%><B>_MBCS Defined</B></TD>
<TD class=label width=28%><B>_UNICODE Defined</B></TD>
</TR>

<TR VALIGN="top">
<TD width=17%>_tpopen</TD>
<TD width=29%>_popen</TD>
<TD width=26%>_popen</TD>
<TD width=28%>_wpopen</TD>
</TR>
</TABLE><BR>

<P class=label><B>Example</B></P>

<PRE><CODE>/* POPEN.C: This program uses _popen and _pclose to receive a 
 * stream of text from a system process.
 */

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

void main( void )
{

   char   psBuffer[128];
   FILE   *chkdsk;

        /* Run DIR so that it writes its output to a pipe. Open this
    * pipe with read text attribute so that we can read it 
         * like a text file. 
    */
   if( (chkdsk = _popen( "dir *.c /on /p", "rt" )) == NULL )
      exit( 1 );

   /* Read pipe until end of file. End of file indicates that 
    * CHKDSK closed its standard out (probably meaning it 
         * terminated).
    */
   while( !feof( chkdsk ) )
   {
      if( fgets( psBuffer, 128, chkdsk ) != NULL )
         printf( psBuffer );
   }

   /* Close pipe and print return value of CHKDSK. */
   printf( "\nProcess returned %d\n", _pclose( chkdsk ) );
}

</CODE></PRE>

<P class=label><B>Output</B></P>

<PRE><CODE> Volume in drive C is CDRIVE
 Volume Serial Number is 0E17-1702

 Directory of C:\dolphin\crt\code\pcode

05/02/94  01:05a                   805 perror.c
05/02/94  01:05a                 2,149 pipe.c
05/02/94  01:05a                   882 popen.c
05/02/94  01:05a                   206 pow.c
05/02/94  01:05a                 1,514 printf.c
05/02/94  01:05a                   454 putc.c
05/02/94  01:05a                   162 puts.c
05/02/94  01:05a                   654 putw.c
               8 File(s)          6,826 bytes
                             86,597,632 bytes free

Process returned 0

</CODE></PRE>

<P><A HREF="_crt_process_and_environment_control.htm">Process and Environment Control Routines</A></P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_crt__pclose.htm">_pclose</A>, <A HREF="_crt__pipe.htm">_pipe</A></P>
</font>
</BODY>
</HTML>
