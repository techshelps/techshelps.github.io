<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_spawn, _wspawn Functions</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_crt__spawn.2c_._wspawn_functions"></A><SUP></SUP>_spawn, _wspawn Functions</H1>

<P>Each of the <B>_spawn</B> functions creates and executes a new process. </P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD width=37%><A HREF="_crt__spawnl.2c_._wspawnl.htm">_spawnl, _wspawnl</A></TD>
<TD width=63%><A HREF="_crt__spawnv.2c_._wspawnv.htm">_spawnv, _wspawnv</A></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><A HREF="_crt__spawnle.2c_._wspawnle.htm">_spawnle, _wspawnle</A></TD>
<TD width=63%><A HREF="_crt__spawnve.2c_._wspawnve.htm">_spawnve, _wspawnve</A></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><A HREF="_crt__spawnlp.2c_._wspawnlp.htm">_spawnlp, _wspawnlp</A></TD>
<TD width=63%><A HREF="_crt__spawnvp.2c_._wspawnvp.htm">_spawnvp, _wspawnvp</A></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><A HREF="_crt__spawnlpe.2c_._wspawnlpe.htm">_spawnlpe, _wspawnlpe</A></TD>
<TD width=63%><A HREF="_crt__spawnvpe.2c_._wspawnvpe.htm">_spawnvpe, _wspawnvpe</A></TD>
</TR>
</TABLE><BR>

<P>The letter(s) at the end of the function name determine the variation.</P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=17%><B>_spawn<BR>
Function<BR>
Suffix</B></TD>
<TD class=label width=83%><B><BR>
<BR>
Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=17%><B>e</B></TD>
<TD width=83%><I>envp</I>, array of pointers to environment settings, is passed to new process.</TD>
</TR>

<TR VALIGN="top">
<TD width=17%><B>l</B></TD>
<TD width=83%>Command-line arguments are passed individually to <B>_spawn</B> function. This suffix is typically used when number of parameters to new process is known in advance</TD>
</TR>

<TR VALIGN="top">
<TD width=17%><B>p</B></TD>
<TD width=83%><B>PATH</B> environment variable is used to find file to execute.</TD>
</TR>

<TR VALIGN="top">
<TD width=17%><B>v</B></TD>
<TD width=83%><I>argv,</I> array of pointers to command-line arguments, is passed to <B>_spawn</B> function. This suffix is typically used when number of parameters to new process is variable.</TD>
</TR>
</TABLE><BR>

<P class=label><B>Remarks</B></P>

<P>The <B>_spawn</B> functions each create and execute a new process. They automatically handle multibyte-character string arguments as appropriate, recognizing multibyte-character sequences according to the multibyte code page currently in use. The <B>_wspawn</B> functions are wide-character versions of the <B>_spawn</B> functions; they do not handle multibyte-character strings. Otherwise, the <B>_wspawn</B> functions behave identically to their <B>_spawn</B> counterparts.</P>

<P class=label><B>Generic-Text Routine Mappings</B></P>

<TABLE border=1 cellpadding=5 cols=4 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=17%><B>TCHAR.H Routine </B></TD>
<TD class=label width=29%><B>_UNICODE &amp; _MBCS Not Defined</B></TD>
<TD class=label width=26%><B>_MBCS Defined</B></TD>
<TD class=label width=28%><B>_UNICODE Defined</B></TD>
</TR>

<TR VALIGN="top">
<TD width=17%>_tspawnl</TD>
<TD width=29%>_spawnl</TD>
<TD width=26%>_spawnl</TD>
<TD width=28%>_wspawnl</TD>
</TR>

<TR VALIGN="top">
<TD width=17%>_tspawnle</TD>
<TD width=29%>_spawnle</TD>
<TD width=26%>_spawnle</TD>
<TD width=28%>_wspawnle</TD>
</TR>

<TR VALIGN="top">
<TD width=17%>_tspawnlp</TD>
<TD width=29%>_spawnlp</TD>
<TD width=26%>_spawnlp</TD>
<TD width=28%>_wspawnlp</TD>
</TR>

<TR VALIGN="top">
<TD width=17%>_tspawnlpe</TD>
<TD width=29%>_spawnlpe</TD>
<TD width=26%>_spawnlpe</TD>
<TD width=28%>_wspawnlpe</TD>
</TR>

<TR VALIGN="top">
<TD width=17%>_tspawnv</TD>
<TD width=29%>_spawnv</TD>
<TD width=26%>_spawnv</TD>
<TD width=28%>_wspawnv</TD>
</TR>

<TR VALIGN="top">
<TD width=17%>_tspawnve</TD>
<TD width=29%>_spawnve</TD>
<TD width=26%>_spawnve</TD>
<TD width=28%>_wspawnve</TD>
</TR>

<TR VALIGN="top">
<TD width=17%>_tspawnvp</TD>
<TD width=29%>_spawnvp</TD>
<TD width=26%>_spawnvp</TD>
<TD width=28%>_wspawnvp</TD>
</TR>

<TR VALIGN="top">
<TD width=17%>_tspawnvpe</TD>
<TD width=29%>_spawnvpe</TD>
<TD width=26%>_spawnvpe</TD>
<TD width=28%>_wspawnvpe</TD>
</TR>
</TABLE><BR>

<P>Enough memory must be available for loading and executing the new process. The <I>mode</I> argument determines the action taken by the calling process before and during <B>_spawn</B>. The following values for <I>mode</I> are defined in PROCESS.H:</P>

<P class=dt><B>_P_OVERLAY</B></P>

<P class=indent>Overlays calling process with new process, destroying the calling process (same effect as <B>_exec</B> calls).</P>

<P class=dt><B>_P_WAIT</B></P>

<P class=indent>Suspends calling thread until execution of new process is complete (synchronous <B>_spawn</B>).</P>

<P class=dt><B>_P_NOWAIT</B> or <B>_P_NOWAITO</B></P>

<P class=indent>Continues to execute calling process concurrently with new process (asynchronous <B>_spawn</B>). </P>

<P class=dt><B>_P_DETACH</B></P>

<P class=indent>Continues to execute the calling process; new process is run in the background with no access to the console or keyboard. Calls to <B>_cwait</B> against the new process will fail (asynchronous <B>_spawn</B>).</P>

<P>The <I>cmdname</I> argument specifies the file that is executed as the new process and can specify a full path (from the root), a partial path (from the current working directory), or just a filename. If <I>cmdname</I> does not have a filename extension or does not end with a period (<B>.</B>), the <B>_spawn</B> function first tries the .COM extension, then the .EXE extension, the .BAT extension, and finally the .CMD extension.</P>

<P>If <I>cmdname</I> has an extension, only that extension is used. If <I>cmdname</I> ends with a period, the <B>_spawn</B> call searches for <I>cmdname</I> with no extension. The <B>_spawnlp</B>, <B>_spawnlpe</B>, <B>_spawnvp</B>, and <B>_spawnvpe</B> functions search for <I>cmdname</I> (using the same procedures) in the directories specified by the <B>PATH</B> environment variable.</P>

<P>If <I>cmdname</I> contains a drive specifier or any slashes (that is, if it is a relative path), the <B>_spawn</B> call searches only for the specified file; no path searching is done.</P>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;To ensure proper overlay initialization and termination, do not use the <B>setjmp</B> or <B>longjmp</B> function to enter or leave an overlay routine.</P>

<H2>Arguments for the Spawned Process</H2>

<P>To pass arguments to the new process, give one or more pointers to character strings as arguments in the <B>_spawn</B> call. These character strings form the argument list for the spawned process. The combined length of the strings forming the argument list for the new process must not exceed 1024 bytes. The terminating null character ('\0') for each string is not included in the count, but space characters (automatically inserted to separate arguments) are included.</P>

<P>You can pass argument pointers as separate arguments (in <B>_spawnl</B>, <B>_spawnle</B>, <B>_spawnlp</B>, and <B>_spawnlpe</B>) or as an array of pointers (in <B>_spawnv</B>, <B>_spawnve</B>, <B>_spawnvp</B>, and <B>_spawnvpe</B>). You must pass at least one argument, <I>arg0</I> or <I>argv</I>[0], to the spawned process. By convention, this argument is the name of the program as you would type it on the command line. A different value does not produce an error.</P>

<P>The <B>_spawnl</B>, <B>_spawnle</B>, <B>_spawnlp</B>, and <B>_spawnlpe</B> calls are typically used in cases where the number of arguments is known in advance. The <I>arg0</I> argument is usually a pointer to <I>cmdname</I>. The arguments <I>arg1</I> through <I>argn</I> are pointers to the character strings forming the new argument list. Following <I>argn</I>, there must be a <B>NULL</B> pointer to mark the end of the argument list.</P>

<P>The <B>_spawnv</B>, <B>_spawnve</B>, <B>_spawnvp</B>, and <B>_spawnvpe</B> calls are useful when there is a variable number of arguments to the new process. Pointers to the arguments are passed as an array, <I>argv.</I> The argument <I>argv</I>[0] is usually a pointer to a path in real mode or to the program name in protected mode, and <I>argv</I>[1] through <I>argv</I>[<I>n</I>] are pointers to the character strings forming the new argument list. The argument <I>argv</I>[<I>n</I> +1] must be a <B>NULL</B> pointer to mark the end of the argument list.</P>

<H2>Environment of the Spawned Process</H2>

<P>Files that are open when a <B>_spawn</B> call is made remain open in the new process. In the <B>_spawnl</B>, <B>_spawnlp</B>, <B>_spawnv</B>, and <B>_spawnvp</B> calls, the new process inherits the environment of the calling process. You can use the <B>_spawnle</B>, <B>_spawnlpe</B>, <B>_spawnve</B>, and <B>_spawnvpe</B> calls to alter the environment for the new process by passing a list of environment settings through the <I>envp</I> argument. The argument <I>envp</I> is an array of character pointers, each element (except the final element) of which points to a null-terminated string defining an environment variable. Such a string usually has the form <I>NAME</I>=<I>value</I> where <I>NAME</I> is the name of an environment variable and <I>value</I> is the string value to which that variable is set. (Note that <I>value</I> is not enclosed in double quotation marks.) The final element of the <I>envp</I> array should be <B>NULL</B>. When <I>envp</I> itself is <B>NULL</B>, the spawned process inherits the environment settings of the parent process.</P>

<P>The <B>_spawn</B> functions can pass all information about open files, including the translation mode, to the new process. This information is passed in real mode through the <B>C_FILE_INFO</B> entry in the environment. The startup code normally processes this entry and then deletes it from the environment. However, if a <B>_spawn</B> function spawns a non-C process, this entry remains in the environment. Printing the environment shows graphics characters in the definition string for this entry because the environment information is passed in binary form in real mode. It should not have any other effect on normal operations. In protected mode, the environment information is passed in text form and therefore contains no graphics characters.</P>

<P>You must explicitly flush (using <B>fflush</B> or <B>_flushall</B>) or close any stream before calling a <B>_spawn</B> function.</P>

<P>You can control whether the open file information of a process is passed to its spawned processes. The external variable <A HREF="_crt__fileinfo.htm">_fileinfo</A> (declared in STDLIB.H) controls the passing of <B>C_FILE_INFO</B> information. If <B>_fileinfo</B> is 0 (the default), the <B>C_FILE_INFO</B> information is not passed to the new processes. If <B>_fileinfo</B> is not 0, <B>C_FILE_INFO</B> is passed to new processes. You can modify the default value of <B>_fileinfo</B> in one of two ways: link the supplied object file, FILEINFO.OBJ, into the program, or set the <B>_fileinfo</B> variable to a nonzero value directly in the C program.</P>

<P>New processes created by calls to <B>_spawn</B> routines do not preserve signal settings. Instead, the spawned process resets signal settings to the default.</P>

<P class=label><B>Example</B></P>

<PRE><CODE>/* SPAWN.C: This program accepts a number in the range
 * 1-8 from the command line. Based on the number it receives,
 * it executes one of the eight different procedures that
 * spawn the process named child. For some of these procedures,
 * the CHILD.EXE file must be in the same directory; for
 * others, it only has to be in the same path.
 */

#include &lt;stdio.h&gt;
#include &lt;process.h&gt;

char *my_env[] =
{
   "THIS=environment will be",
   "PASSED=to child.exe by the",
   "_SPAWNLE=and",
   "_SPAWNLPE=and",
   "_SPAWNVE=and",
   "_SPAWNVPE=functions",
   NULL
};

void main( int argc, char *argv[] )
{
   char *args[4];

   /* Set up parameters to be sent: */
   args[0] = "child";
   args[1] = "spawn??";
   args[2] = "two";
   args[3] = NULL;

   if (argc &lt;= 2)
   {
      printf( "SYNTAX: SPAWN &lt;1-8&gt; &lt;childprogram&gt;\n" );
      exit( 1 );
   }

   switch (argv[1][0])   /* Based on first letter of argument */
   {
   case '1':
      _spawnl( _P_WAIT, argv[2], argv[2], "_spawnl", "two", NULL );
      break;
   case '2':
      _spawnle( _P_WAIT, argv[2], argv[2], "_spawnle", "two", 
               NULL, my_env );
      break;
   case '3':
      _spawnlp( _P_WAIT, argv[2], argv[2], "_spawnlp", "two", NULL );
      break;
   case '4':
      _spawnlpe( _P_WAIT, argv[2], argv[2], "_spawnlpe", "two", 
                NULL, my_env );
      break;
   case '5':
      _spawnv( _P_OVERLAY, argv[2], args );
      break;
   case '6':
      _spawnve( _P_OVERLAY, argv[2], args, my_env );
      break;
   case '7':
      _spawnvp( _P_OVERLAY, argv[2], args );
      break;
   case '8':
      _spawnvpe( _P_OVERLAY, argv[2], args, my_env );
      break;
   default:
      printf( "SYNTAX: SPAWN &lt;1-8&gt; &lt;childprogram&gt;\n" );
      exit( 1 );
   }
   printf( "from SPAWN!\n" );
}

</CODE></PRE>

<P class=label><B>Output</B></P>

<PRE><CODE>SYNTAX: SPAWN &lt;1-8&gt; &lt;childprogram&gt;

</CODE></PRE>

<P><A HREF="_crt_process_and_environment_control.htm">Process and Environment Control Routines</A></P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_crt_abort.htm">abort</A>, <A HREF="_crt_atexit.htm">atexit</A>, <A HREF="_crt__exec.2c_._wexec_functions.htm">_exec Functions</A>, <A HREF="_crt_exit.2c_._exit.htm">exit</A>, <A HREF="_crt__flushall.htm">_flushall</A>, <A HREF="_crt__getmbcp.htm">_getmbcp</A>, <A HREF="_crt__onexit.htm">_onexit</A>, <A HREF="_crt__setmbcp.htm">_setmbcp</A>, <A HREF="_crt_system.2c_._wsystem.htm">system</A></P>
</font>
</BODY>
</HTML>
