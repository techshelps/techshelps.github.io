<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Common Controls</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CAnimateCtrl">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CHeaderCtrl">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CHotKeyCtrl">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CListCtrl">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CProgressCtrl">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CSliderCtrl">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CSpinButtonCtrl">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CStatusBarCtrl">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CTabCtrl">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CToolBarCtrl">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CToolTipCtrl">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CTreeCtrl">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_CMNCTRL1">
</OBJECT>
<OBJECT ID="hhobj_15" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_CMNCTRL2">
</OBJECT>
<OBJECT ID="hhobj_16" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_FIRE">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_using_common_controls"></A>Using Common Controls</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_win32_programming.3a_.overview.htm">Overview</A> |&nbsp; <A HREF="_core_win32_programming_tasks.htm">How Do I</A></P>

<P>It’s recommended that your Windows 95 application use the common controls where applicable. Visual C++’s dialog editor offers the common controls on its control palette, and MFC provides classes for all the Windows common controls.</P>

<P>One place in the DRAWCLI sample where a common control can be used is in the dialog box for specifying the thickness of the drawing pen. DRAWCLI formerly used a simple edit control in which the user typed the pen thickness; now DRAWCLI adds a spin control, allowing the user to use the mouse or the arrow keys to increment or decrement the pen thickness. </P>

<P>You can add a spin control to your application by using the Visual C++ dialog editor; associate the spin control with an edit control by checking the Auto Buddy and Set Buddy Integer properties on the control’s property page. Next, use the Member Variables tab of the ClassWizard dialog to add a member variable for the spin control. This causes ClassWizard to do two things:

<UL type=disc>
	<LI>Declare a member of type <B>CSpinButtonCtrl</B> in the dialog class. <BR><BR></LI>

	<LI>Add a call to <B>DDX_Control</B> in the dialog’s <B>DoDataExchange</B> member function, associating the spin control with the member variable. </LI>
</UL>

<P>You must manually add the statement <CODE>#include &lt;afxcmn.h&gt;</CODE> to your STDAFX.H file to include MFC’s common control support in an existing application. If you generate a new application with AppWizard, AppWizard now inserts this statement into STDAFX.H automatically.</P>

<P>Finally, override the <B>OnInitDialog</B> member function of the dialog class to initialize the spin control. Here’s what the function looks like in DRAWCLI: </P>

<PRE><CODE>BOOL CRectDlg::OnInitDialog() 
{
   CDialog::OnInitDialog();
   
   m_SpinCtrl.SetRange(0, 100);
   m_SpinCtrl.SetBase(10);
   m_SpinCtrl.SetPos(1);
   return TRUE;  
}
</CODE></PRE>

<P>This function sets the initial, minimum, and maximum values for the spin control. It also sets the spin control to use decimal notation. </P>

<P>For more information on using MFC’s common control classes, see <A HREF="_core_mfc_windows_95_support.htm">MFC: Windows 95 Support</A> in <I>Visual C++ Programmer’s Guide</I> and the descriptions of <A HREF="JavaScript:hhobj_2.Click()">CAnimateCtrl</A>, <A HREF="JavaScript:hhobj_3.Click()">CHeaderCtrl</A>, <A HREF="JavaScript:hhobj_4.Click()">CHotKeyCtrl</A>, <A HREF="JavaScript:hhobj_5.Click()">CListCtrl</A>, <A HREF="JavaScript:hhobj_6.Click()">CProgressCtrl</A>, <A HREF="JavaScript:hhobj_7.Click()">CSliderCtrl</A>, <A HREF="JavaScript:hhobj_8.Click()">CSpinButtonCtrl</A>, <A HREF="JavaScript:hhobj_9.Click()">CStatusBarCtrl</A>, <A HREF="JavaScript:hhobj_10.Click()">CTabCtrl</A>, <A HREF="JavaScript:hhobj_11.Click()">CToolBarCtrl</A>, <A HREF="JavaScript:hhobj_12.Click()">CToolTipCtrl</A>, and <A HREF="JavaScript:hhobj_13.Click()">CTreeCtrl</A> in the <I>Class Library Reference</I>. For a demonstration of various common controls, see the <A HREF="JavaScript:hhobj_14.Click()">CMNCTRL1</A>, <A HREF="JavaScript:hhobj_15.Click()">CMNCTRL2</A>, and <A HREF="JavaScript:hhobj_16.Click()">FIRE</A> sample applications in the MFC samples.</P>
</font>
</BODY>
</HTML>
