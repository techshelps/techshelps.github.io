<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Steps to Create a Typical ISAPI Filter</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="vceditions">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CHttpFilter.3a3a.GetFilterVersion">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CHttpFilter_Class_Members">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CHttpFilter.3a3a.GetFilterVersion">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CHttpFilter">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CHttpFilterContext">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_steps_to_create_a_typical_isapi_filter"></A>Steps to Create a Typical ISAPI Filter</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_internet_support.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_internet_tasks.htm">How Do I</A></P>

<P>Once you are familiar with the benefits of <A HREF="_core_isapi_extensions.3a_.filters.htm">ISAPI filters</A> and how to use them, you can create a filter project using the ISAPI Extension Wizard. For more information about starting a new project using wizards, see <A HREF="_core_visual_c.2b2b_.wizards_that_help_you_begin_your_program.htm">Visual C++ Wizards that Help You Begin Your Program</A>. After the project has been created, you add your custom notification handlers. The steps are described below.</P>

<P class=label><B>To create your project using the ISAPI Extension Wizard</B>

<OL>
	<LI>In the development environment, choose <B>New </B>from the <B>File </B>menu, and click the <B>Projects</B> tab. <BR><BR></LI>

	<LI>On the <B>Projects</B> tab, click <B>ISAPI Extension Wizard</B> and name your project. <BR><BR></LI>

	<LI>In Step 1 of the <B>ISAPI Extension Wizard</B>, check the option to <B>Generate a Filter object</B>.<BR><BR></LI>

	<LI>Name your <B>CHttpFilter </B>object, and choose whether to link to the MFC DLLs statically or dynamically, then choose the <B>Next </B>button.
<P class=atl><B><B>Feature Only in Professional and Enterprise Edition</B></B>&nbsp;&nbsp;&nbsp;Static linking to MFC is supported only in Visual C++ Professional and Enterprise Editions. For more information, see <A HREF="JavaScript:hhobj_2.Click()">Visual C++ Editions</A>.</p></LI>

	<LI>In Step 2 of the <B>ISAPI Extension Wizard</B>, select a filter notification priority.
<P class=tl>The default notification priority, which is recommended, is <B>Low</B>. Other priority notifications can affect performance and scalability.</P></LI>

	<LI>Choose which type of connections cause notifications for the filter. 
<P class=tl>The filter can receive notifications from a secured port, a nonsecured port, or both. The ISAPI Extension Wizard sets both as the default.</P></LI>

	<LI>Choose what notifications your filter will process. 
<P class=tl>See <A HREF="JavaScript:hhobj_3.Click()">CHttpFilter::GetFilterVersion</A> for a description of the notification flags and <A HREF="JavaScript:hhobj_4.Click()">CHttpFilter Class Members</A> for a list of functions you can override.</P>
<P class=tl>The notification filters you choose in the ISAPI Extension Wizard will appear with the default implementation in your project. Choose only the notifications you want your filter to handle. Adding unnecessary notifications will affect the efficiency of your filter. </P>
<P class=tl>You can add or delete notification functions manually in the project source files later.</P></LI>

	<LI>Click <B>Finish</B> to create the ISAPI extension. </LI>
</OL>

<P class=label><B>To add your filter processing</B>

<OL>
	<LI>Specify the notifications you want in <B>GetFilterVersion</B>.
<P class=tl><B>dwFlags</B> will already contain the filters for events you specified in the Extension Wizard.</P></LI>

	<LI>To add a new notification, add the filter flag to <B>dwFlags</B> in <A HREF="JavaScript:hhobj_5.Click()">CHttpFilter::GetFilterVersion</A>.
<UL type=disc>
	<LI>Add the filter function declaration to the .h file.<BR><BR></LI>

	<LI>Add the filter definition to the .cpp file. </LI>
</UL>

<P class=tl>You can remove notification flags and functions as well.</P></LI>

	<LI>To Implement your filter functions, open the .cpp file and add custom handling for your chosen filter notifications by replacing the <CODE>//TODO</CODE>s in the wizard-generated code.<BR><BR></LI>

	<LI>To add your filter to the registry, specify the full path and the name of your DLL.
<P class=tl>HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/Services/W3SVC/Parameters/FilterDLLs is the registry key where filters are specified. Multiple entries are separated by commas and are loaded in the order specified.</P></LI>
</OL>

<P class=label><B>To debug your filter, if running Microsoft Internet Information Server</B>

<UL type=disc>
	<LI>Run INETINFO.EXE with local or remote debugging as described in <A HREF="_core_isapi.3a_.debugging.htm">ISAPI: Debugging</A></LI>
</UL>

<P class=label><B>To load your filter, or to install a new version, if running Microsoft Internet Information Server</B>

<UL type=disc>
	<LI>Shut down the WWW service, copy the new version of your DLL over the old one, and restart the service.</LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="JavaScript:hhobj_6.Click()">CHttpFilter</A>, <A HREF="JavaScript:hhobj_7.Click()">CHttpFilterContext</A>, <A HREF="_core_internet.3a_.where_is.......htm">Internet: Where Is...</A></P>
</font>
</BODY>
</HTML>
