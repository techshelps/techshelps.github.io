<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Status Bars: Updating the Text of a Status-Bar Pane</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Scribble start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CStatusBar">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CStatusBar">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_status_bars.3a_.updating_the_text_of_a_status.2d.bar_pane"></A>Status Bars: Updating the Text of a Status-Bar Pane</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_status_bars.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_status.2d.bar_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A></P>

<P>This article explains how to change the text that appears in an MFC status bar pane. A status bar — a window object of class <A HREF="JavaScript:hhobj_3.Click()">CStatusBar</A> — contains several “panes.” Each pane is a rectangular area of the status bar that you can use to display information. For example, many applications display the status of the CAPS LOCK, NUM LOCK, and other keys in the rightmost panes. Applications also often display informative text in the leftmost pane (pane 0), sometimes called the “message pane.” For example, the default MFC status bar uses the message pane to display a string explaining the currently selected menu item or toolbar button. The figure in <A HREF="_core_status_bars.htm">Status Bars </A> shows a status bar from an AppWizard-created MFC application.</P>

<P>By default, MFC does not enable a <B>CStatusBar</B> pane when it creates the pane. To activate a pane, you must use the <B>ON_UPDATE_COMMAND_UI</B> macro for each pane on the status bar and update the panes. Because panes do not send <B>WM_COMMAND</B> messages (they aren’t like toolbar buttons), you can’t use ClassWizard to create an update handler to activate a pane; you must type the code manually. </P>

<P>For example, suppose one pane has <CODE>ID_INDICATOR_PAGE</CODE> as its command identifier and that it contains the current page number in a document. The following procedure describes how to create a new pane in the status bar. </P>

<P class=label><B>To make a new pane</B>

<OL>
	<LI>Define the pane’s command ID.
<P class=tl>Open the ResourceView in the Project Workspace window. Open the Symbol Browser<B> </B>with the <B>Resource Symbols</B> command on the <B>View </B>menu, and click <B>New</B>. Type a command ID name: for example, <CODE>ID_INDICATOR_PAGE</CODE>. Specify a value for the ID, or accept the value suggested by the Symbol Browser. For example, for <CODE>ID_INDICATOR_PAGE</CODE>, accept the default value. Close the Symbol Browser.</P></LI>

	<LI>Define a default string to display in the pane.
<P class=tl>With the ResourceView open, double-click <B>String Table</B> in the window that lists resource types for your application. With the <B>String Table</B> editor open, choose <B>New String</B> from the <B>Insert </B>menu. In the String Properties window, select your pane’s command ID (for example, <CODE>ID_INDICATOR_PAGE</CODE>) and type a default string value, such as “Page&nbsp;&nbsp;&nbsp;”. Close the string editor. (You need a default string to avoid a compiler error.)</P></LI>

	<LI>Add the pane to the <B>indicators</B> array.
<P class=tl>In file MAINFRM.CPP, locate the <B>indicators</B> array. This array lists command IDs for all of the status bar’s indicators, in order from left to right. At the appropriate point in the array, enter your pane’s command ID, as shown here for <CODE>ID_INDICATOR_PAGE</CODE>:</P>
<PRE><CODE>static UINT BASED_CODE indicators[] =
{
    ID_SEPARATOR,           // status line indicator
    ID_INDICATOR_CAPS,
    ID_INDICATOR_NUM,
    ID_INDICATOR_SCRL,
    ID_INDICATOR_PAGE,
};
</CODE></PRE>
</LI>
</OL>

<P>The recommended way to display text in a pane is to call the <B>SetText</B> member function of class <B>CCmdUI</B> in an update handler function for the pane. For example, you might want to set up an integer variable <CODE>m_nPage</CODE> that contains the current page number and use <B>SetText</B> to set the pane’s text to a string version of that number.</P>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;The <B>SetText</B> approach is recommended. It is possible to perform this task at a slightly lower level by calling the <B>CStatusBar</B> member function <B>SetPaneText</B>. Even so, you still need an update handler. Without such a handler for the pane, MFC automatically disables the pane, erasing its content.</P>

<P>The following procedure shows how to use an update handler function to display text in a pane.</P>

<P class=label><B>To make a pane display text</B>

<OL>
	<LI>Add a command update handler for the command.
<P class=tl>You can’t use ClassWizard to write a handler for a status bar pane, so manually add a prototype for the handler, as shown here for <CODE>ID_INDICATOR_PAGE</CODE> (in MAINFRM.H):</P>
<PRE><CODE>afx_msg void OnUpdatePage(CCmdUI *pCmdUI);
</CODE></PRE>

<P class=tl>In the appropriate .CPP file, add the handler’s definition, as shown here for <CODE>ID_INDICATOR_PAGE</CODE> (in MAINFRM.CPP):</P>
<PRE><CODE>void CMainFrame::OnUpdatePage(CCmdUI *pCmdUI)
{
    pCmdUI-&gt;Enable(); 
}
</CODE></PRE>

<P class=tl>In the appropriate message map, add the <B>ON_UPDATE_COMMAND_UI</B> macro (outside the “{{AFX” comments), as shown here for <CODE>ID_INDICATOR_PAGE</CODE> (in MAINFRM.CPP):</P>
<PRE><CODE>ON_UPDATE_COMMAND_UI(ID_INDICATOR_PAGE, OnUpdatePage)
</CODE></PRE>
</LI>

	<LI>Add code to the handler to display your text.
<P class=tl>For <CODE>ID_INDICATOR_PAGE</CODE>, expand the <CODE>OnUpdatePage</CODE> handler from step 1 above, adding the last three lines:</P>
<PRE><CODE>void CMainFrame::OnUpdatePage(CCmdUI *pCmdUI) 
{
    pCmdUI-&gt;Enable(); 
    CString strPage;
    strPage.Format( "Page %d", m_nPage ); 
    pCmdUI-&gt;SetText( strPage ); 
}
</CODE></PRE>
</LI>
</OL>

<P>Once you define the value of the <CODE>m_nPage</CODE> member variable (of class <CODE>CMainFrame</CODE>), this technique causes the page number to appear in the pane during idle processing in the same manner that the application updates other indicators. If <CODE>m_nPage</CODE> changes, the display changes during the next idle loop.</P>

<H3>What do you want to know more about?</H3>

<UL type=disc>
	<LI><A HREF="_core_how_to_update_user.2d.interface_objects.htm">Updating user-interface objects, such as toolbar buttons and menu items, as program conditions change</A></LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="JavaScript:hhobj_4.Click()">CStatusBar</A> </P>
</font>
</BODY>
</HTML>
