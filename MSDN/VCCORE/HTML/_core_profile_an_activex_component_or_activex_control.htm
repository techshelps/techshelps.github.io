<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Profile a COM or OLE Server or ActiveX Control</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_perf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="vceditions">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_profile_an_activex_component_or_activex_control"></A>Profile an OLE Server or ActiveX Control</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_profiling.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_articles_that_tell_about_performance_tuning.htm">Details</A></P>

<P><A HREF="_core_profile_dynamic.2d.link_libraries.htm">Profile Dynamic-Link Libraries</A> explains the steps involved in profiling dynamic-link libraries and profiling multiple .DLL and .EXE files.</P>

<P><B><B>Feature Only in Professional and Enterprise Editions</B></B>&nbsp;&nbsp;&nbsp;Profiling is supported only in Visual C++ Professional and Enterprise Editions. For more information, see <A HREF="JavaScript:hhobj_2.Click()">Visual C++ Editions</A>.</P>

<P>Since an OLE server is basically an EXE or a DLL, and an ActiveX control (formerly OLE control) is a DLL even though it has an extension of .OCX, profiling them is similar to profiling an EXE or a DLL. When you profile an OLE server or ActiveX control, you follow the same steps and use the same commands that you would for an EXE or a DLL. The same profiling rules that apply to EXEs and DLLs (such as the need to include debugging information and to supply a .MAP file) apply to OLE servers and ActiveX controls.</P>

<P>The four examples below illustrate the steps required to profile a full OLE server, a mini OLE server, an in-process Automation server (formerly OLE Automation server), and an ActiveX control.</P>

<P>You may need to register the mini OLE server, the in-process Automation server, or the ActiveX control explicitly. You can do one of the following steps to register them:

<UL type=disc>
	<LI>For a DLL (and thus for an ActiveX control), run REGSVR32 from the command prompt. Alternatively, you can open the corresponding project in the development environment and select the <B>Register Control</B> option from the <B>Tools </B>menu.<BR><BR></LI>

	<LI>For an EXE, simply run the executable file. You may not be able to run it or you may get a message saying, "This server can only be run from a container application," but you can click OK. It will have been registered.</LI>
</UL>

<P>In order to run the profiler, you may need to copy the \Program Files\Microsoft Visual Studio\VC98\bin \PROFILE.DLL file to the directory containing the file that you are profiling, or to one of the system directories.</P>

<P>Each step in the following examples is a command at the command prompt.&nbsp; Alternatively, you could create a batch file with these commands.</P>

<P>To profile a full OLE server or an Automation server:</P>

<PRE><CODE>PREP /OM /FT FullSrvr
PROFILE FullSrvr
PREP /M FullSrvr
PLIST FullSrvr &gt; FullSrvr.txt
</CODE></PRE>

<P>where FullSrvr.exe is the file corresponding to a full OLE server or Automation server.</P>

<P>To profile a mini OLE server:</P>

<PRE><CODE>COPY MiniSrvr.exe MiniSrvr.sav
PREP /OM /FT MiniSrvr
COPY MiniSrvr._xe MiniSrvr.exe
PROFILE /I MiniSrvr /O MiniSrvr Container
PREP /M MiniSrvr
PLIST MiniSrvr &gt; MiniSrvr.txt
COPY MiniSrvr.sav MiniSrvr.exe
</CODE></PRE>

<P>where MiniSrvr is the file corresponding to a mini OLE server and Container is a container application that runs the MiniSrvr.</P>

<P>To profile an in-process Automation server (the steps are similar to those of a mini OLE server except that you have a .dll extension instead of .exe):</P>

<PRE><CODE>COPY InProc.dll InProc.sav
PREP /OM /FT InProc.dll
COPY InProc._ll InProc.dll
PROFILE /I InProc /O InProc Client
PREP /M InProc
PLIST InProc &gt; InProc.txt
COPY InProc.sav InProc.dll
</CODE></PRE>

<P>where InProc is the file corresponding to an in-process Automation server and Client is an Automation client application that drives the InProc.dll.</P>

<P>To profile an ActiveX control with an .ocx extension (the steps are similar again except that you have an .ocx extension):</P>

<PRE><CODE>COPY Control.ocx Control.sav
PREP /OM /FT Control.ocx
COPY Control._cx Control.ocx
PROFILE /I Control /O Control ControlContainer
PREP /M Control
PLIST Control &gt; Control.txt
COPY Control.sav Control.ocx
</CODE></PRE>

<P>where Control is the ActiveX control and ControlContainer is an ActiveX control container application.</P>
</font>
</BODY>
</HTML>
