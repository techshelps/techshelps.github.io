<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO Workspace: The Database Engine</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoException">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_workspace.3a_.the_database_engine"></A>DAO Workspace: The Database Engine</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>MFC and DAO use the Microsoft Jet database engine, currently version 3.0, to retrieve data from and store data in user and system databases. The Microsoft Jet database engine is the data manager component on which various implementations are built, such as the MFC DAO classes, Microsoft Access, and Microsoft Visual Basic, and the Microsoft Desktop Database Drivers (currently version 3.0). </P>

<P>This article explains how you interact with the database engine via MFC. Topics covered include:

<UL type=disc>
	<LI><A HREF="#_core_data_sources_you_can_access">Data sources you can access</A><BR><BR></LI>

	<LI><A HREF="#_core_how_mfc_exposes_the_database_engine">How MFC exposes the database engine</A><BR><BR></LI>

	<LI><A HREF="#_core_database_engine_collections">Database engine collections</A><BR><BR></LI>

	<LI><A HREF="#_core_initializing_and_uninitializing_the_database_engine">Initializing and uninitializing the database engine</A></LI>
</UL>

<H2><A NAME="_core_data_sources_you_can_access"></A>Data Sources You Can Access</H2>

<P>While the database engine is best suited for working with Microsoft Jet (.MDB) databases, you can access several ISAM databases and any database for which you have an ODBC driver, including remote databases such as Microsoft SQL Server or Oracle. For more information about these non-.MDB sources, see the article <A HREF="_core_dao_external.3a_.working_with_external_data_sources.htm">DAO External: Working with External Data Sources</A>.</P>



<H2><A NAME="_core_how_mfc_exposes_the_database_engine"></A>How MFC Exposes the Database Engine</H2>

<P>In DAO, the database engine is represented by a DBEngine object. This object sits at the top of the DAO object hierarchy and contains all of the other objects, such as workspaces and databases. For detailed information about this DAO object, see the topic "DBEngine Object" in DAO Help. To view the DAO object hierarchy, see the topic "Data Access Object Hierarchy" in DAO Help.</P>

<P>In MFC, the DBEngine object is not exposed directly via an MFC class. Instead, all access to the underlying DAO database engine object is through a set of static member functions in class <A HREF="JavaScript:hhobj_3.Click()">CDaoWorkspace</A>. These member functions provide access to database engine properties that you can set or get to configure your database sessions. You can access the database engine through any workspace object, whether MFC creates the object implicitly or you create it explicitly. In the majority of situations, you will not need to set these properties. You can rely on the defaults instead.</P>



<H2><A NAME="_core_database_engine_collections"></A>Database Engine Collections</H2>

<P>DAO's DBEngine object houses two important collections used with MFC:

<UL type=disc>
	<LI>Workspaces<BR><BR></LI>

	<LI>Errors</LI>
</UL>

<H3>The DBEngine’s Workspaces Collection</H3>

<P>The Workspaces collection contains all open DAO workspace objects that you have explicitly appended to the collection. See the article <A HREF="_core_dao_collections.3a_.obtaining_information_about_dao_objects.htm">DAO Collections: Obtaining Information About DAO Objects</A> for a discussion of how to use the Workspaces collection.</P>

<H3>The DBEngine’s Errors Collection</H3>

<P>The Errors collection contains one DAO error object for each error returned by the most recent DAO operation. In most error situations, particularly when you are working with a Microsoft Jet (.MDB) database, the collection contains one object. If you are using an ODBC data source, it is likely that the collection might contain more than one error object. In MFC, all DAO errors are translated into thrown exceptions of type <A HREF="JavaScript:hhobj_4.Click()">CDaoException</A>. See class <B>CDaoException</B> and the article <A HREF="_core_exceptions.3a_.database_exceptions.htm">Exceptions: Database Exceptions</A> for a discussion of how to work with MFC's DAO exceptions.</P>



<H2><A NAME="_core_initializing_and_uninitializing_the_database_engine"></A>Initializing and Uninitializing the Database Engine</H2>

<P>MFC loads a single instance of the DAO DBEngine object, housed in a DLL, per application. Thus your database engine sessions are limited to your application. Your workspaces are not available to other applications or users.</P>

<H3>Initializing the Database Engine</H3>

<P>MFC initializes the database engine, beginning your database engine session, the first time your application creates or opens a workspace, either implicitly or explicitly. For more information about explicit and implicit workspaces, see the article <A HREF="_core_dao_workspace.htm">DAO Workspace</A>.</P>

<H3>Uninitializing the Database Engine</H3>

<P>MFC uninitializes the database engine, ending your database engine session, when your application terminates.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao_workspace.htm">DAO Workspace</A>, <A HREF="_core_dao_workspace.3a_.accessing_properties_of_the_database_engine.htm">DAO Workspace: Accessing Properties of the Database Engine</A></P>
</font>
</BODY>
</HTML>
