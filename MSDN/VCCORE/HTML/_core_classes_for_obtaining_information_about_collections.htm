<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Example: Obtaining Information About Querydefs</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDaoDatabaseInfo_structure">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDaoFieldInfo_structure">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDaoIndexInfo_structure">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoIndexFieldInfo_structure">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDaoParameterInfo_structure">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDaoQueryDefInfo_structure">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDaoRelationInfo_structure">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRelationFieldInfo_structure">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDaoTableDefInfo_structure">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDaoWorkspaceInfo_structure">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoException">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase.3a3a.GetQueryDefInfo">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDefInfo_structure">
</OBJECT>
</TD></TR></TABLE>
<font face="verdana,arial,helvetica" size="2">
<P class=label><B><A NAME="_core_classes_for_obtaining_information_about_collections"></A>Classes for Obtaining Information About Collections</B></P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=40%><B>Object</B></TD>
<TD class=label width=60%><B>Class (structure)</B></TD>
</TR>

<TR VALIGN="top">
<TD width=40%>Database</TD>
<TD width=60%><A HREF="JavaScript:hhobj_1.Click()">CDaoDatabaseInfo</A></TD>
</TR>

<TR VALIGN="top">
<TD width=40%>Field</TD>
<TD width=60%><A HREF="JavaScript:hhobj_2.Click()">CDaoFieldInfo</A></TD>
</TR>

<TR VALIGN="top">
<TD width=40%>Index</TD>
<TD width=60%><A HREF="JavaScript:hhobj_3.Click()">CDaoIndexInfo</A></TD>
</TR>

<TR VALIGN="top">
<TD width=40%>Index Field (field that is part of an index object)</TD>
<TD width=60%><A HREF="JavaScript:hhobj_4.Click()">CDaoIndexFieldInfo</A></TD>
</TR>

<TR VALIGN="top">
<TD width=40%>Parameter</TD>
<TD width=60%><A HREF="JavaScript:hhobj_5.Click()">CDaoParameterInfo</A></TD>
</TR>

<TR VALIGN="top">
<TD width=40%>QueryDef</TD>
<TD width=60%><A HREF="JavaScript:hhobj_6.Click()">CDaoQueryDefInfo</A></TD>
</TR>

<TR VALIGN="top">
<TD width=40%>Relation</TD>
<TD width=60%><A HREF="JavaScript:hhobj_7.Click()">CDaoRelationInfo</A></TD>
</TR>

<TR VALIGN="top">
<TD width=40%>Relation Field (field that is part of a relation object)</TD>
<TD width=60%><A HREF="JavaScript:hhobj_8.Click()">CDaoRelationFieldInfo</A></TD>
</TR>

<TR VALIGN="top">
<TD width=40%>TableDef</TD>
<TD width=60%><A HREF="JavaScript:hhobj_9.Click()">CDaoTableDefInfo</A></TD>
</TR>

<TR VALIGN="top">
<TD width=40%>Workspace</TD>
<TD width=60%><A HREF="JavaScript:hhobj_10.Click()">CDaoWorkspaceInfo</A></TD>
</TR>
</TABLE><BR>

<P>One additional DAO object, the error object, is handled somewhat differently in MFC, so you don’t use the technique described in this article to work with error objects. For information, see class <A HREF="JavaScript:hhobj_11.Click()">CDaoException</A> in the <I>Class Library Reference</I>.</P>

<H2><A NAME="_core_example.3a_.obtaining_information_about_querydefs"></A>Example: Obtaining Information About Querydefs</H2>

<P>This example shows how to loop through the QueryDefs collection of a <A HREF="JavaScript:hhobj_12.Click()">CDaoDatabase</A> object and obtain information about the QueryDefs in the collection. The example searches the QueryDefs collection for a particular named query, called “Senior Students”, so it can then extract other information about the query — such as its SQL string or query type.</P>

<PRE><CODE>// pDB is a pointer to a CDaoDatabase object
// Allocate a CDaoQueryDefInfo object to 
// receive the information
CDaoQueryDefInfo queryinfo;
int nQueries = pDB-&gt;GetQueryDefCount( );
for ( int i = 0; i &lt; nQueries; i++ )
{
    pDB-&gt;GetQueryDefInfo( i, queryinfo );
    if ( queryinfo.m_strName == "Senior Students" )
    {
        // Get other information about the query ...
        // ...
        break;
    }
}
</CODE></PRE>

<P>The code iterates through the collection, retrieving information about each object until the desired named query is found. Note that DAO collections are zero-based.</P>

<P class=indent><B><B>Tip&nbsp;&nbsp;&nbsp;</B></B>Some MFC DAO class functions use <I>CDaoXInfo</I> structures for input parameters as well as for output parameters. In those cases, you assign values to a <I>CDaoXInfo</I> object, then pass the object to the function.</P>



<H2><A NAME="_core_constants_for_specifying_the_levels_of_information_you_want"></A>Constants for Specifying the Levels of Information You Want</H2>

<P>The syntax of the <A HREF="JavaScript:hhobj_13.Click()">GetQueryDefInfo</A> member function used in the example under Example: Obtaining Information About Querydefs is:</P>

<P><B>void GetQueryDefInfo( int </B><I>nIndex</I><B>, CDaoQueryDefInfo&amp; </B><I>queryinfo</I>, <B>DWORD </B><I>dwInfoOptions</I><B> = AFX_DAO_PRIMARY_INFO );</B></P>

<P>In the example, the <I>queryinfo</I> parameter returns a reference to a <A HREF="JavaScript:hhobj_14.Click()">CDaoQueryDefInfo</A> object. The example accepts the default value, <B>AFX_DAO_PRIMARY_INFO</B>, for the <I>dwInfoOptions</I> parameter, which specifies what information to return. The following table lists the options in this case.</P>

<P class=label><B>Constants for Specifying the Levels of Information You Want</B></P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=50%><B>Constant</B></TD>
<TD class=label width=50%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>AFX_DAO_PRIMARY_INFO</B></TD>
<TD width=50%>Primary level of information; in the querydef case, this includes Name and Type.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>AFX_DAO_SECONDARY_INFO</B></TD>
<TD width=50%>Primary information plus a secondary level of information; in the querydef case, this would include Date Created, Date of Last Update, Returns Records, and Updatable.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>AFX_DAO_ALL_INFO</B></TD>
<TD width=50%>Primary and secondary information plus additional information: in the querydef case, this would include SQL, Connect, and ODBCTimeout.</TD>
</TR>
</TABLE><BR>

<P>The items listed in column 2 of the table correspond to data members of the appropriate <I>CDaoXInfo</I> structure and, beneath that, to DAO properties.</P>

<P>Notice that the levels of information are cumulative: if you specify a higher level, such as secondary or all, you get the lower levels as well. For details about what information you can obtain for each collection type, see the appropriate <I>GetXInfo</I> functions. The functions are listed in the table <A HREF="#_core_classes_for_obtaining_information_about_collections">Classes for Obtaining Information About Collections</A>.</P>

<P class=indent><B><B>Caution&nbsp;&nbsp;&nbsp;</B></B>In many cases, the information obtained with the <B>AFX_DAO_ALL_INFO</B> option can be time-consuming or otherwise costly to obtain. For example, getting a count of the records in a recordset can be time-consuming. Use this option with care.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao_collections.htm">DAO Collections</A></P>
</font>
</BODY>
</HTML>
