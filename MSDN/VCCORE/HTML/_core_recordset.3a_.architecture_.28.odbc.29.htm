<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Recordset: Architecture (ODBC)</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.m_nFields">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.m_nParams">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_recordset.3a_.architecture_.28.odbc.29"></A>Recordset: Architecture (ODBC)</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article applies to the MFC ODBC classes. For DAO recordsets, see the article <A HREF="_core_dao_recordset.htm">DAO Recordset</A>.</P>

<P>This article describes the data members that comprise the architecture of a recordset object:

<UL type=disc>
	<LI><A HREF="#_core_field_data_members">Field data members</A><BR><BR></LI>

	<LI><A HREF="#_core_parameter_data_members">Parameter data members</A><BR><BR></LI>

	<LI><A HREF="#_core_using_m_nfields_and_m_nparams">Using m_nFields and m_nParams data members</A></LI>
</UL>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>This article applies to objects derived from <B>CRecordset</B> in which bulk row fetching has not been implemented. If bulk row fetching is implemented, the architecture is similar. To understand the differences, see the article <A HREF="_core_recordset.3a_.fetching_records_in_bulk_.28.odbc.29.htm">Recordset: Fetching Records in Bulk (ODBC)</A>.</P>



<H2><A NAME="_core_a_sample_class"></A>A Sample Class</H2>

<P>When you use ClassWizard to declare a recordset class derived from <B>CRecordset</B>, the resulting class has the general structure shown in the following simple class:</P>

<PRE><CODE>class CCourse : CRecordset
{
   //{{AFX_FIELD(CCourse, CRecordset)
   CString m_strCourseID;
   CString m_strCourseTitle;
   //}}AFX_FIELD
   CString m_strIDParam;
};
</CODE></PRE>

<P>At the beginning of the class, ClassWizard writes a set of <A HREF="#_core_field_data_members">field data members</A>. When you create the class with ClassWizard, you must specify one or more field data members. If the class is parameterized, as the sample class is (with the data member <CODE>m_strIDParam</CODE>), you must manually add <A HREF="#_core_parameter_data_members">parameter data members</A>. ClassWizard doesn’t support adding parameters to a class.</P>



<H2><A NAME="_core_field_data_members"></A>Field Data Members</H2>

<P>The most important members of your recordset class are the field data members. For each column you select from the data source, the class contains a data member of the appropriate data type for that column. For example, the <A HREF="#_core_a_sample_class">sample class</A> shown at the beginning of this article has two field data members, both of type <B>CString</B>, called <CODE>m_strCourseID</CODE> and <CODE>m_strCourseTitle</CODE>.</P>

<P>When the recordset selects a set of records, the framework automatically “binds” the columns of the current record (after the <B>Open</B> call, the first record is current) to the field data members of the object. That is, the framework uses the appropriate field data member as a buffer in which to store the contents of a record column.</P>

<P>As the user scrolls to a new record, the framework uses the field data members to represent the current record. The framework refreshes the field data members, replacing the previous record’s values. The field data members are also used for updating the current record and for adding new records. As part of the process of updating a record, you specify the update values by assigning values directly to the appropriate field data member(s). </P>



<H2><A NAME="_core_parameter_data_members"></A>Parameter Data Members</H2>

<P>If the class is “parameterized,” it has one or more parameter data members. A parameterized class lets you base a recordset query on information obtained or calculated at run time. </P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>You must manually place these data members outside the “//{{AFX_FIELD” comment brackets. </P>

<P>Typically, the parameter helps narrow the selection, as in the following example. Based on the <A HREF="#_core_a_sample_class">sample class</A> at the beginning of this article, the recordset object might execute the following SQL statement:</P>

<PRE><CODE>SELECT CourseID, CourseTitle FROM Course WHERE CourseID = ?
</CODE></PRE>

<P>The “?” is a placeholder for a parameter value that you supply at run time. When you construct the recordset and set its <CODE>m_strIDParam</CODE> data member to “MATH101”, the effective SQL statement for the recordset becomes:</P>

<PRE><CODE>SELECT CourseID, CourseTitle FROM Course WHERE CourseID = MATH101
</CODE></PRE>

<P>By defining parameter data members, you tell the framework about parameters in the SQL string. The framework binds the parameter, which lets ODBC know where to get values to substitute for the placeholder. In the example, the resulting recordset contains only the record from the Course table with a CourseID column whose value is “MATH101”. All specified columns of this record are selected. You can specify as many parameters (and placeholders) as you need.</P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>MFC does nothing itself with the parameters — in particular, it doesn’t perform a text substitution. Instead, MFC tells ODBC where to get the parameter; ODBC retrieves the data and performs the necessary parameterization.</P>

<P class=indent><B><B>Important&nbsp;&nbsp;&nbsp;</B></B>The order of parameters is important. For details about this and more information about parameters, see the article <A HREF="_core_recordset.3a_.parameterizing_a_recordset_.28.odbc.29.htm">Recordset: Parameterizing a Recordset (ODBC)</A>. </P>



<H2><A NAME="_core_using_m_nfields_and_m_nparams"></A>Using m_nFields and m_nParams</H2>

<P>When ClassWizard writes a constructor for your class, it also initializes the <A HREF="JavaScript:hhobj_3.Click()">m_nFields</A> data member, which specifies the number of <A HREF="#_core_field_data_members">field data members</A> in the class. If you add any <A HREF="#_core_parameter_data_members">parameters</A> to your class, you must also add an initialization for the <A HREF="JavaScript:hhobj_4.Click()">m_nParams</A> data member, which specifies the number of parameter data members. The framework uses these values to work with the data members.</P>

<P>For more information and examples, see the article <A HREF="_core_record_field_exchange.3a_.using_rfx.htm">Record Field Exchange: Using RFX</A>. </P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_recordset.3a_.declaring_a_class_for_a_table_.28.odbc.29.htm">Recordset: Declaring a Class for a Table (ODBC)</A>, <A HREF="_core_record_field_exchange_.28.rfx.29.htm">Record Field Exchange</A> </P>
</font>
</BODY>
</HTML>
