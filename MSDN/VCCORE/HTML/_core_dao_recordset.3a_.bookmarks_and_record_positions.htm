<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO Recordset: Bookmarks and Record Positions</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.CanBookmark">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleVariant">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.GetBookmark">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetBookmark">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Move">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Seek">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Find">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.GetPercentPosition">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetPercentPosition">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.GetRecordCount">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.MoveLast">
</OBJECT>
<OBJECT ID="hhobj_15" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.GetAbsolutePosition">
</OBJECT>
<OBJECT ID="hhobj_16" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetAbsolutePosition">
</OBJECT>
<OBJECT ID="hhobj_17" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.GetRecordCount">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_recordset.3a_.bookmarks_and_record_positions"></A>DAO Recordset: Bookmarks and Record Positions</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains MFC's interfaces to:

<UL type=disc>
	<LI>The <A HREF="#_core_bookmarks_in_mfc_dao">Bookmark</A> property in DAO recordsets.<BR><BR></LI>

	<LI>The <A HREF="#_core_absolute_and_percent_positions_in_mfc">AbsolutePosition and PercentPosition</A> properties in DAO recordsets.</LI>
</UL>

<P>For details about these properties in DAO, see the following topics in DAO Help:

<UL type=disc>
	<LI>Bookmark Property<BR><BR></LI>

	<LI>AbsolutePosition Property<BR><BR></LI>

	<LI>PercentPosition Property<BR><BR></LI>

	<LI>Positioning the Current Record Pointer with DAO</LI>
</UL>

<P>Those DAO Help topics explain the fundamentals of the properties. This article explains how MFC exposes them to you.</P>



<H2><A NAME="_core_bookmarks_in_mfc_dao"></A>Bookmarks in MFC DAO</H2>

<P>Because records can be deleted from a recordset, you can't rely on the absolute position of a record within the recordset. The reliable way to keep track of the position of a particular record in your recordset is to use the record's bookmark. </P>

<P>Except for snapshot-type recordsets, each record has a unique bookmark from the time the recordset is created. In MFC, class <A HREF="JavaScript:hhobj_3.Click()">CDaoRecordset</A> supplies member functions for: 

<UL type=disc>
	<LI>Getting the bookmark of the current record, so you can save it in a variable.<BR><BR></LI>

	<LI>Moving quickly to a given record by specifying its bookmark, which you've saved earlier in a variable.</LI>
</UL>

<P>You can check whether a recordset supports bookmarks by calling <A HREF="JavaScript:hhobj_4.Click()">CDaoRecordset::CanBookmark</A>.</P>

<P>For example, suppose you want to mark the current record so you can later return to it easily. The following code does this:</P>

<PRE><CODE>// rs is a CDaoRecordset or 
// CDaoRecordset-derived object

COleVariant varRecordToReturnTo;
varRecordToReturnTo = rs.GetBookmark( );

//...more code in which you move to other records
rs.SetBookMark( varRecordToReturnTo );
</CODE></PRE>

<P>There is no need to extract the underlying data type from the <A HREF="JavaScript:hhobj_5.Click()">COleVariant</A> object. Simply get it with <A HREF="JavaScript:hhobj_6.Click()">CDaoRecordset::GetBookmark</A> and return to that bookmark with <A HREF="JavaScript:hhobj_7.Click()">CDaoRecordset::SetBookmark</A>.</P>



<H2><A NAME="_core_absolute_and_percent_positions_in_mfc"></A>Absolute and Percent Positions in MFC DAO</H2>

<P>Besides bookmarks (and <A HREF="JavaScript:hhobj_8.Click()">Move</A>, <A HREF="JavaScript:hhobj_9.Click()">Seek</A>, and <A HREF="JavaScript:hhobj_10.Click()">Find</A>), DAO provides two other ways to position the current record in a recordset: percent positioning and absolute positioning.</P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>Neither absolute nor percent positioning is recommended for moving the current record to a specific record. Use a bookmark instead. See <A HREF="#_core_dao_recordset.3a_.bookmarks_and_record_positions">DAO Recordset: Bookmarks and Record Positions</A>.</P>

<P>Neither percent positioning nor absolute positioning is available for table-type recordsets.</P>

<H3>Percent Positioning</H3>

<P>You can set the current record to a position that follows a specified percentage of the records in a recordset, and you can get the percentage position of the current record. This is useful for setting scroll bars. That is, you can:

<UL type=disc>
	<LI>Call <A HREF="JavaScript:hhobj_11.Click()">CDaoRecordset::GetPercentPosition</A> to determine the percentage position of the current record, that is, what percentage of the records precede the current record.<BR><BR></LI>

	<LI>Call <A HREF="JavaScript:hhobj_12.Click()">CDaoRecordset::SetPercentPosition</A> to make the record at a specified percentage position in a recordset the current record. For example, you might make the record at 50% of the current record, halfway through the recordset.</LI>
</UL>

<P>Keep in mind the following guidelines:

<UL type=disc>
	<LI>Percent positioning is approximate, and the exact record that is set can be affected by deletion of records.<BR><BR></LI>

	<LI>If you call <B>SetPercentPosition</B> before the recordset is fully populated, the amount of movement is relative to the number of populated records. Records are populated as you move to them and they are retrieved from the database. You can determine the number of populated records by calling <A HREF="JavaScript:hhobj_13.Click()">GetRecordCount</A>. You can populate all records in the recordset by calling <A HREF="JavaScript:hhobj_14.Click()">MoveLast</A> (keep in mind that calling <B>MoveLast</B> can be slow for dynaset-type and snapshot-type recordsets).</LI>
</UL>

<P>For related information, see the topic "PercentPosition Property" in DAO Help.</P>

<H3>Absolute Positioning</H3>

<P>You can set or get the record number of the current record in a recordset. That is, you can:

<UL type=disc>
	<LI>Call <A HREF="JavaScript:hhobj_15.Click()">CDaoRecordset::GetAbsolutePosition</A> to get the AbsolutePosition property of the recordset, which contains the ordinal position (zero-based) of the current record in a recordset.<BR><BR></LI>

	<LI>Call <A HREF="JavaScript:hhobj_16.Click()">CDaoRecordset::SetAbsolutePosition</A> to set the AbsolutePosition property. This makes the record at that ordinal position in the recordset the current record.</LI>
</UL>

<P class=indent><B><B>Important</B></B>&nbsp;&nbsp;&nbsp;The absolute position of a record is potentially unreliable. If the user can delete records ahead of a position, the ordinal number of records following the deletion is decreased. Bookmarks are a more reliable method of working with record positions. See <A HREF="#_core_bookmarks_in_mfc_dao">Bookmarks in MFC DAO</A>.</P>

<P>Keep in mind the following guideline:

<UL type=disc>
	<LI>Setting a position greater than the number of populated records causes MFC to throw an exception. Records are populated as you move to them and they are retrieved from the database. You can determine the number of populated records by calling <A HREF="JavaScript:hhobj_17.Click()">GetRecordCount</A>.</LI>
</UL>

<P>For related information, see the topic "AbsolutePosition Property" in DAO Help.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao_recordset.htm">DAO Recordset</A>, <A HREF="_core_dao_recordset.3a_.recordset_navigation.htm">DAO Recordset: Recordset Navigation</A>, <A HREF="_core_dao_recordset.3a_.seeking_and_finding.htm">DAO Recordset: Seeking and Finding</A></P>
</font>
</BODY>
</HTML>
