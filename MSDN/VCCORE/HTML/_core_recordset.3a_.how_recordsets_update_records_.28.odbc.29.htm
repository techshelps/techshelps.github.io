<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Recordset: How Recordsets Update Records (ODBC)</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDatabase">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CRecordset.3a3a.AddNew">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CRecordset.3a3a.Edit">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CRecordset.3a3a.Delete">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CRecordset.3a3a.Requery">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_recordset.3a_.how_recordsets_update_records_.28.odbc.29"></A>Recordset: How Recordsets Update Records (ODBC)</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article applies to the MFC ODBC classes. For DAO recordsets, see the article <A HREF="_core_dao_recordset.htm">DAO Recordset</A>.</P>

<P>Besides their ability to select records from a data source, recordsets can (optionally) update or delete the selected records or add new records. Three factors determine a recordset’s updatability: whether the connected data source is updatable, the options you specify when you create a recordset object, and the SQL that is created.</P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>The SQL upon which your <B>CRecordset</B> object is based can affect your recordset’s updatability. For example, if your SQL contains a join or a <B>GROUP BY</B> clause, MFC sets the updatability to <B>FALSE</B>.</P>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;This article applies to objects derived from <B>CRecordset</B> in which bulk row fetching has not been implemented. If you are using bulk row fetching, see the article <A HREF="_core_recordset.3a_.fetching_records_in_bulk_.28.odbc.29.htm">Recordset: Fetching Records in Bulk (ODBC)</A>.</P>

<P>This article explains:

<UL type=disc>
	<LI><A HREF="#_core_your_role_in_recordset_updating">Your role in recordset updating</A> and what the framework does for you. <BR><BR></LI>

	<LI><A HREF="#_core_the_edit_buffer">The recordset as an edit buffer</A> and the <A HREF="#_core_dynasets_and_snapshots">differences between dynasets and snapshots</A>.</LI>
</UL>

<P>The article <A HREF="_core_recordset.3a_.how_addnew.2c_.edit.2c_.and_delete_work_.28.odbc.29.htm">Recordset: How AddNew, Edit, and Delete Work (ODBC)</A> describes the actions of these functions from the point of view of the recordset.</P>

<P>The article <A HREF="_core_recordset.3a_.more_about_updates_.28.odbc.29.htm">Recordset: More About Updates (ODBC)</A> completes the recordset update story by explaining how transactions affect updates, how closing a recordset or scrolling affects updates in progress, and how your updates interact with the updates of other users.</P>

<H2><A NAME="_core_your_role_in_recordset_updating"></A>Your Role in Recordset Updating</H2>

<P>The following table shows your role in using recordsets to add, edit, or delete records, along with what the framework does for you.</P>

<P class=label><B>Recordset Updating: You and the Framework</B></P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=38%><B>You...</B></TD>
<TD class=label width=62%><B>The framework...</B></TD>
</TR>

<TR VALIGN="top">
<TD width=38%>Determine whether the data source is updatable (or appendable).</TD>
<TD width=62%>Supplies <A HREF="JavaScript:hhobj_3.Click()">CDatabase</A> member functions for testing the data source’s updatability or appendability.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>Open an updatable recordset (of any type).</TD>
<TD width=62%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>Determine whether the recordset is updatable by calling <B>CRecordset</B> update functions such as <B>CanUpdate</B> or <B>CanAppend</B>.</TD>
<TD width=62%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>Call recordset member functions to add, edit, and delete records.</TD>
<TD width=62%>Manages the mechanics of exchanging data between your recordset object and the data source.</TD>
</TR>

<TR VALIGN="top">
<TD width=38%>Optionally, use transactions to control the update process.</TD>
<TD width=62%>Supplies <B>CDatabase</B> member functions to support transactions.</TD>
</TR>
</TABLE><BR>

<P>For more information about transactions, see the article <A HREF="_core_transaction_.28.odbc.29.htm">Transaction (ODBC)</A>. </P>



<H2><A NAME="_core_the_edit_buffer"></A>The Edit Buffer</H2>

<P>Taken collectively, the field data members of a recordset serve as an edit buffer that contains one record — the current record. Update operations use this buffer to operate on the current record.

<UL type=disc>
	<LI>When you add a record, the edit buffer is used to build a new record. When you finish adding the record, the record that was previously current becomes current again.<BR><BR></LI>

	<LI>When you update (edit) a record, the edit buffer is used to set the field data members of the recordset to new values. When you finish updating, the updated record is still current.</LI>
</UL>

<P>When you call <A HREF="JavaScript:hhobj_4.Click()">AddNew</A> or <A HREF="JavaScript:hhobj_5.Click()">Edit</A>, the current record is stored so it can be restored later as needed. When you call <A HREF="JavaScript:hhobj_6.Click()">Delete</A>, the current record is not stored but is marked as deleted, and you must scroll to another record.</P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>The edit buffer plays no role in record deletion. When you delete the current record, the record is marked as deleted, and the recordset is “not on a record” until you scroll to a different record.</P>

<H2><A NAME="_core_dynasets_and_snapshots"></A>Dynasets and Snapshots</H2>

<P><A HREF="_core_dynaset.htm">Dynasets</A> refresh a record’s contents as you scroll to the record. <A HREF="_core_snapshot.htm">Snapshots</A> are static representations of the records, so a record’s contents are not refreshed unless you call <A HREF="JavaScript:hhobj_7.Click()">Requery</A>. To use all the functionality of dynasets, you must be working with an ODBC driver that conforms to the correct level of ODBC API support. For more information, see the articles <A HREF="_core_odbc.htm">ODBC</A> and <A HREF="_core_dynaset.htm">Dynaset</A>. </P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_recordset.3a_.how_addnew.2c_.edit.2c_.and_delete_work_.28.odbc.29.htm">Recordset: How AddNew, Edit, and Delete Work (ODBC)</A> </P>
</font>
</BODY>
</HTML>
