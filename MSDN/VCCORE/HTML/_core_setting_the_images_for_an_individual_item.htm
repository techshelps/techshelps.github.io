<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting the Images for an Individual Item</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_comboboxexitem">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CComboBoxEx.3a3a.InsertItem">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CComboBoxEx.3a3a.GetItem">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CComboBoxEx.3a3a.SetItem">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_setting_the_images_for_an_individual_item"></A>Setting the Images for an Individual Item</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_using_ccomboboxex.htm">Overview</A>  |&nbsp; <A HREF="_core_common_control_sample_list.htm">Sample</A></P>

<P>The different types of images used by the extended combo box item are determined by the values in the <B>iImage</B>, <B>iSelectedImage</B>, and <B>iOverlay</B> members of the <A HREF="JavaScript:hhobj_2.Click()">COMBOBOXEXITEM</A> structure. Each value is the index of an image in the associated image list of the control. By default, these members are set to 0, causing the control to display no image for the item. If you want to use images for a specific item, you can modify the structure accordingly, either when inserting the combo box item or by modifying an existing combo box item.</P>

<H3>Setting the Image for a New Item</H3>

<P>If you are inserting a new item, initialize the <B>iImage</B>, <B>iSelectedImage</B>, and <B>iOverlay</B> structure members with the proper values and then insert the item with a call to <A HREF="JavaScript:hhobj_3.Click()">CComboBoxEx::InsertItem</A>.</P>

<P>The following example inserts a new extended combo box item (<CODE>cbi</CODE>) into the extended combo box control (<CODE>m_comboEx</CODE>), supplying indices for all three image states:</P>

<PRE><CODE>COMBOBOXEXITEM     cbi;
CString            str;
int                nItem;

cbi.mask = CBEIF_IMAGE | CBEIF_INDENT | CBEIF_OVERLAY |
     CBEIF_SELECTEDIMAGE | CBEIF_TEXT;

cbi.iItem = i;
str.Format(_T("Item %02d"), i);
cbi.pszText = (LPTSTR)(LPCTSTR)str;
cbi.cchTextMax = str.GetLength();
cbi.iImage = 0;
cbi.iSelectedImage = 1;
cbi.iOverlay = 2;
cbi.iIndent = (i &amp; 0x03);   //Set indentation according
                            //to item position

nItem = m_comboEx.InsertItem(&amp;cbi);
ASSERT(nItem == i);
</CODE></PRE>

<H3>Setting the Image for an Existing Item</H3>

<P>If you are modifying an existing item, you need to work with the <B>mask</B> member of a <B>COMBOBOXEXITEM</B> structure.</P>

<P class=label><B>To modify an existing item to use images</B>

<OL>
	<LI>Declare a <B>COMBOBOXEXITEM</B> structure and set the <B>mask</B> data member to the values you are interested in modifying.<BR><BR></LI>

	<LI>Using this structure, make a call to <A HREF="JavaScript:hhobj_4.Click()">CComboBoxEx::GetItem</A>.<BR><BR></LI>

	<LI>Modify the <B>mask</B>, <B>iImage</B>, and <B>iSelectedImage</B> members of the newly returned structure, using the appropriate values.<BR><BR></LI>

	<LI>Make a call to <A HREF="JavaScript:hhobj_5.Click()">CComboBoxEx::SetItem</A>, passing in the modified structure.</LI>
</OL>

<P>The following example demonstrates this procedure by swapping the selected and unselected images of the third extended combo box item:</P>

<PRE><CODE>COMBOBOXEXITEM     cbi;
CString            str;
int                nItem;

cbi.mask = CBEIF_IMAGE | CBEIF_SELECTEDIMAGE;
cbi.iItem = 2;
m_comboEx.GetItem(&amp;cbi);

cbi.iImage = 1;
cbi.iSelectedImage = 0;
nItem = m_comboEx.SetItem(&amp;cbi);
ASSERT(nItem != 0);
</CODE></PRE>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_control_topics.htm#_core_windows_common_controls_and_mfc_classes">Windows Common Controls and MFC Classes</A></P>
</font>
</BODY>
</HTML>
