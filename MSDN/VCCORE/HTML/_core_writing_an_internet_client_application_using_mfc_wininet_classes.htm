<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Writing an Internet Client Application Using MFC WinInet Classes</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CInternetSession">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CInternetConnection">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CInternetSession.3a3a.GetFtpConnection">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CInternetSession.3a3a.GetHttpConnection">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CInternetSession.3a3a.GetGopherConnection">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CInternetFile">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CInternetSession">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CHttpFile">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CGopherFile">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CInternetSession.3a3a.OpenURL">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_writing_an_internet_client_application_using_mfc_wininet_classes"></A>Writing an Internet Client Application Using MFC WinInet Classes</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_internet_support.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_internet_tasks.htm">How Do I</A></P>

<P>The basis of every Internet client application is the Internet session. MFC implements Internet sessions as objects of class <A HREF="JavaScript:hhobj_2.Click()">CInternetSession</A>. Using this class, you can create one Internet session or several simultaneous sessions. </P>

<P>To communicate with a server, you need a <A HREF="JavaScript:hhobj_3.Click()">CInternetConnection</A> object as well as a <B>CInternetSession</B>. You can create a <B>CInternetConnection</B> by using <A HREF="JavaScript:hhobj_4.Click()">CInternetSession::GetFtpConnection</A>, <A HREF="JavaScript:hhobj_5.Click()">CInternetSession::GetHttpConnection</A>, or <A HREF="JavaScript:hhobj_6.Click()">CInternetSession::GetGopherConnection</A>. Each of these calls is specific to the protocol type. These calls do not open a file on the server for reading or writing. If you intend to read or write data, you must open the file as a separate step.</P>

<P>For most Internet sessions, the <B>CInternetSession</B> object works hand-in-hand with a <A HREF="JavaScript:hhobj_7.Click()">CInternetFile</A> object:

<UL type=disc>
	<LI>For an Internet session, you must create an instance of <A HREF="JavaScript:hhobj_8.Click()">CInternetSession</A>. <BR><BR></LI>

	<LI>If your Internet session reads or writes data, you must create an instance of <B>CInternetFile</B> (or its subclasses, <A HREF="JavaScript:hhobj_9.Click()">CHttpFile</A> or <A HREF="JavaScript:hhobj_10.Click()">CGopherFile</A>). The easiest way to read data is to call <A HREF="JavaScript:hhobj_11.Click()">CInternetSession::OpenURL</A>. This function parses a Universal Resource Locator (URL) supplied by you, opens a connection to the server specified by the URL, and returns a read-only <B>CInternetFile</B> object. <B>CInternetSession::OpenURL</B> is not specific to one protocol type &nbsp;? the same call works for any FTP, HTTP, or gopher URL. <B>CInternetSession::OpenURL</B> even works with local files (returning a <B>CStdioFile</B> instead of a <B>CInternetFile</B>).<BR><BR></LI>

	<LI>If your Internet session does not read or write data, but performs other tasks, such as deleting a file in an FTP directory, you may not need to create an instance of <B>CInternetFile</B>.</LI>
</UL>

<P>There are two ways to create a <B>CInternetFile</B> object:&nbsp;&nbsp;&nbsp;

<UL type=disc>
	<LI>If you use <B>CInternetSession::OpenURL</B> to establish your server connection, the call to <B>OpenURL</B> returns a <B>CInternetFile</B>.&nbsp;&nbsp;&nbsp;<BR><BR></LI>

	<LI>If use <B>CInternetSession::GetFtpConnection</B>, <B>GetGopherConnection</B>, or <B>GetHttpConnection</B> to establish your server connection, you must call <B>CFtpConnection::OpenFile</B>, <B>CGopherConnection::OpenFile</B>, or <B>CHttpConnection::OpenRequest,</B> respectively, to return a <B>CInternetFile</B>, <B>CGopherFile</B>, or <B>CHttpFile</B>, respectively.</LI>
</UL>

<P>The steps in implementing an Internet client application vary depending on whether you create a generic Internet client based on <B>OpenURL </B>or a protocol-specific client using one of the <B>GetConnection</B> functions. </P>

<H3>What do you know more about?</H3>

<UL type=disc>
	<LI><A HREF="_core_steps_in_a_typical_internet_client_application.htm">How do I write an Internet client application that works generically with FTP, HTTP, and gopher?</A><BR><BR></LI>

	<LI><A HREF="_core_steps_in_a_typical_ftp_client_application.htm">How do I write an FTP client application that opens a file?</A><BR><BR></LI>

	<LI><A HREF="_core_steps_in_a_typical_ftp_client_application_to_delete_a_file.htm">How do I write an FTP client application that does not open a file but performs a directory operation, such as deleting a file?</A><BR><BR></LI>

	<LI><A HREF="_core_steps_in_a_typical_gopher_client_application.htm">How do I write a gopher client application?</A><BR><BR></LI>

	<LI><A HREF="_core_steps_in_a_typical_http_client_application.htm">How do I write an HTTP client application?</A></LI>
</UL>
</font>
</BODY>
</HTML>
