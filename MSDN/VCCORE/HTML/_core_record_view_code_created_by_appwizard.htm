<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Record View Code Created by AppWizard</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CView.3a3a.OnInitialUpdate">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CWnd.3a3a.UpdateData">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_record_view_code_created_by_appwizard"></A>Record View Code Created by AppWizard</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P><A HREF="_core_classwizard.3a_.creating_a_database_form.htm">ClassWizard</A> (or <A HREF="_core_database_options_in_appwizard.htm">AppWizard</A>) overrides the view’s <B>OnInitialUpdate</B> and <B>OnGetRecordset</B> member functions. After the framework creates the frame window, document, and view, it calls <CODE>OnInitialUpdate</CODE> to initialize the view. <CODE>OnInitialUpdate</CODE> obtains a pointer to the recordset from the document. A call to the base class <A HREF="JavaScript:hhobj_3.Click()">CView::OnInitialUpdate</A> function opens the recordset. The following code shows this process for a <B>CRecordView</B> ? the code for a <B>CDaoRecordView</B> is similar: </P>

<PRE><CODE>void CSectionForm::OnInitialUpdate()
{
   m_pSet = &amp;GetDocument()-&gt;m_sectionSet;
   CRecordView::OnInitialUpdate();
}
</CODE></PRE>

<P>When the recordset opens, it selects records. <A HREF="JavaScript:hhobj_4.Click()">CRecordset::Open</A> or <A HREF="JavaScript:hhobj_5.Click()">CDaoRecordset::Open</A> makes the first record the current record, and DDX moves data from the recordset’s field data members to the corresponding form controls in the view. For more information about RFX, see the article <A HREF="_core_record_field_exchange_.28.rfx.29.htm">Record Field Exchange (RFX)</A>. For more information about DFX, see the article <A HREF="_core_dao_record_field_exchange_.28.dfx.29.htm">DAO Record Field Exchange (DFX)</A>. For more information about DDX, see <A HREF="_core_dialog_data_exchange_and_validation.htm">Dialog Data Exchange and Validation</A>. For details of the document/view creation process, see <A HREF="_core_using_the_classes_to_write_applications_for_windows.htm">Using the Classes to Write Applications for Windows</A>. </P>

<P class=indent><B><B>Important</B></B>&nbsp;&nbsp;&nbsp;You should give your end users the capability to refresh the record view controls from the recordset. Without this capability, if a user changes a control’s value to an illegal value, he or she could be permanently stuck on the current record. To refresh the controls, you call the <B>CWnd</B> member function <A HREF="JavaScript:hhobj_6.Click()">UpdateData</A> with a parameter of <B>FALSE</B>. For an example, see Step 3 in the ENROLL tutorial — look at the <CODE>OnRecordAdd</CODE> member function in file SECTFORM.CPP. The tutorial begins in <A HREF="JavaScript:hhobj_7.Click()">Creating a Database Application</A> in <I>Tutorials</I>.</P>
</font>
</BODY>
</HTML>
