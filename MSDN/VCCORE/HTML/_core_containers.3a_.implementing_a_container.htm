<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Containers: Implementing a Container</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Container start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_CONTAINER">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Container start">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_CONTAINER">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleClientItem">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Container start">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_DRAWCLI">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_containers.3a_.implementing_a_container"></A>Containers: Implementing a Container</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_ole_in_mfc.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_ole_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_ole_sample_list.htm">Sample</A>  |&nbsp; <A HREF="_core_ole_tutorial_list.htm">Tutorial</A></P>

<P><A HREF="JavaScript:hhobj_2.Click()">Creating an OLE Container</A> in <I>Tutorials</I> describes the implementation of a simple visual editing container, <A HREF="JavaScript:hhobj_3.Click()">CONTAINER</A>, explaining each step in detail. This article summarizes the tutorial procedure and points you to other articles that provide more detailed explanations about implementing containers. It also lists some optional OLE features you may want to implement and the articles describing these features.</P>

<P class=label><B>To prepare your CWinApp-derived class</B>

<OL>
	<LI>Initialize the OLE libraries by calling <B>AfxOleInit</B> in the <B>InitInstance</B> member function.<BR><BR></LI>

	<LI>Call <B>CDocTemplate::SetContainerInfo</B> in <B>InitInstance</B> to assign the menu and accelerator resources used when an embedded item is activated in-place. For more information on this topic, see the <A HREF="_core_activation.htm">Activation</A> article.</LI>
</OL>

<P>These features are provided for you automatically when you use AppWizard to create a container application. See the article <A HREF="_core_the_mfc_appwizard_.28.exe_version.293a_.step.2d.by.2d.step.htm">The MFC AppWizard (EXE version): Step-by-Step</A>. </P>

<P class=label><B>To prepare your view class</B>

<OL>
	<LI>Keep track of selected items by maintaining a pointer, or list of pointers if you support multiple selection, to the selected items. Your <B>OnDraw</B> function must draw all OLE items.<BR><BR></LI>

	<LI>Override <B>IsSelected</B> to check whether the item passed to it is currently selected.<BR><BR></LI>

	<LI>Implement an <B>OnInsertObject</B> message handler to display the <B>Insert Object </B>dialog box.<BR><BR></LI>

	<LI>Implement an <B>OnSetFocus</B> message handler to transfer focus from the view to an in-place active OLE embedded item.<BR><BR></LI>

	<LI>Implement an <B>OnSize</B> message handler to inform an OLE embedded item that it needs to change its rectangle to reflect the change in size of its containing view.</LI>
</OL>

<P>Because the implementation of these features varies dramatically from one application to the next, AppWizard provides only a basic implementation. You will likely have to customize these functions to get your application to function properly. For a more detailed explanation and an example of this, see the "Refining Active Container Functionality" section of <A HREF="JavaScript:hhobj_4.Click()">Creating an OLE Container</A> in <I>Tutorials</I>, and see the MFC Tutorial sample <A HREF="JavaScript:hhobj_5.Click()">CONTAINER</A>. </P>

<P class=label><B>To handle embedded and linked items</B>

<OL>
	<LI>Derive a class from <A HREF="JavaScript:hhobj_6.Click()">COleClientItem</A>. Objects of this class represent items that have been embedded in or linked to your OLE document.<BR><BR></LI>

	<LI>Override <B>OnChange</B>, <B>OnChangeItemPosition</B>, and <B>OnGetItemPosition</B>. These functions handle sizing, positioning, and modifying embedded and linked items.</LI>
</OL>

<P>AppWizard will derive the class for you, but you will likely need to override <B>OnChange</B> and the other functions listed with it in step 2 in the preceding procedure. The skeleton implementations need to be customized for most applications, because these functions are implemented differently from one application to the next. For more information about this, see step 2 of the <A HREF="JavaScript:hhobj_7.Click()">container tutorial</A> (called "Refining Active Container Functionality") in <I>Tutorials</I> and the MFC OLE sample <A HREF="JavaScript:hhobj_8.Click()">DRAWCLI</A>. </P>

<P>You must add a number of items to the container application’s menu structure to support OLE. For more information on these, see the article <A HREF="_core_menus_and_resources.3a_.container_additions.htm">Menus and Resources: Container Additions</A>. </P>

<P>You may also want to support some of the following features in your container application:

<UL type=disc>
	<LI>In-place activation when editing an embedded item.
<P class=tl>For more information, see the article <A HREF="_core_activation.htm">Activation</A>. </P></LI>

	<LI>Creation of OLE items by dragging and dropping a selection from a server application.
<P class=tl>For more information, see the article <A HREF="_core_drag_and_drop_.28.ole.29.htm">Drag and Drop (OLE)</A>.</P></LI>

	<LI>Links to embedded objects or combination container/server applications.
<P class=tl>For more information, see the article <A HREF="_core_containers.3a_.advanced_features.htm">Containers: Advanced Features</A>. </P></LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_containers.3a_.client_items.htm">Containers: Client Items</A> </P>
</font>
</BODY>
</HTML>
