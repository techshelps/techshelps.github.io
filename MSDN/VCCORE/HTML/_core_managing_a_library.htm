<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Managing a Library</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_compiling_home">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_managing_a_library"></A><SUP></SUP>Managing a Library</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_additional_command.2d.line_build_tools.3a_.overview.htm">Overviews</A></P>

<P>The default mode for LIB is to build or modify a library of COFF objects. LIB runs in this mode when you do not specify /EXTRACT (to copy an object to a file) or /DEF (to build an import library).</P>

<P>To build a library from objects and/or libraries, use the following syntax:</P>

<P>LIB [<I>options</I>...] <I>files</I>...</P>

<P>This command creates a library from one or more input <I>files</I>. The <I>files</I> can be COFF object files, 32-bit OMF object files, or existing COFF libraries. LIB creates one library that contains all objects in the specified files. If an input file is a 32-bit OMF object file, LIB converts it to COFF before building the library. LIB cannot accept a 32-bit OMF object that is in a library created by the 16-bit version of LIB. You must first use the 16-bit LIB to extract the object; then you can use the extracted object file as input to the 32-bit LIB.</P>

<P>By default, LIB names the output file using the base name of the first object or library file and the extension .LIB. The output file is put in the current directory. If a file already exists with the same name, the output file replaces the existing file. To preserve an existing library, use the /OUT option to specify a name for the output file.</P>

<P>The following options apply to building and modifying a library:</P>

<P class=dt>/LIST</P>

<P class=indent>Displays information about the output library to standard output. The output can be redirected to a file. You can use /LIST to determine the contents of an existing library without modifying it.</P>

<P class=dt>/OUT:<I>filename</I></P>

<P class=indent>Overrides the default output filename. By default, the output library is created in the current directory, with the base name of the first library or object file on the command line and the extension .LIB.</P>

<P class=dt>/LIBPATH:<I>dir</I></P>

<P class=indent>Overrides the environment library path. For details, see the description of the LINK <A HREF="_core_.2f.libpath.htm">/LIBPATH</A> option.</P>

<P class=dt>/LINK50COMPAT</P>

<P class=indent>Generates an import library in the previous (Visual C++ version 5.0) format for backwards compatibility.</P>

<P class=dt>/CONVERT</P>

<P class=indent>Converts an import library to the previous (Visual C++ version 5.0) format.</P>

<P class=dt>/REMOVE:<I>object</I></P>

<P class=indent>Omits the specified <I>object</I> from the output library. LIB creates an output library by first combining all objects (whether in object files or libraries), and then deleting any objects specified with /REMOVE.</P>

<P class=dt>/SUBSYSTEM:{NATIVE|WINDOWS|CONSOLE|WINDOWSCE|POSIX}[,<I>left</I>[.<I>right</I>]]</P>

<P class=indent>Tells the operating system how to run a program created by linking to the output library. For more information, see the description of the LINK <A HREF="_core_.2f.subsystem.htm">/SUBSYSTEM</A> option.</P>

<P>You can use LIB to perform the following library-management tasks:

<UL type=disc>
	<LI>To add objects to a library, specify the filename for the existing library and the filenames for the new objects.<BR><BR></LI>

	<LI>To combine libraries, specify the library filenames. You can add objects and combine libraries with a single LIB command.<BR><BR></LI>

	<LI>To replace a library member with a new object, specify the library containing the member object to be replaced and the filename for the new object (or the library that contains it). When an object that has the same name exists in more than one input file, LIB puts the last object specified in the LIB command into the output library. When you replace a library member, be sure to specify the new object or library after the library that contains the old object.<BR><BR></LI>

	<LI>To delete a member from a library, use the /REMOVE option. LIB processes any specifications of /REMOVE after combining all input objects, regardless of command-line order.</LI>
</UL>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;You cannot both delete a member and extract it to a file in the same step. You must first extract the member object using /EXTRACT, then run LIB again using /REMOVE. This behavior differs from that of the 16-bit LIB (for OMF libraries) provided in other Microsoft products.</P>
</font>
</BODY>
</HTML>
