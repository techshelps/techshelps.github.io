<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LoadLibrary and AfxLoadLibrary</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_FreeLibrary">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_loadlibrary_and_afxloadlibrary"></A>LoadLibrary and AfxLoadLibrary</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_dlls.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dll_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_dlls.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dll_topics.htm">Details</A>  |&nbsp; <A HREF="_core_dll_sample_programs.htm">Sample</A></P>

<P>Processes call <B>LoadLibrary</B> (or <B>AfxLoadLibrary</B>) to explicitly link to a DLL. If successful, the function maps the specified DLL into the address space of the calling process and returns a handle to the DLL that can be used with other functions used in explicit linking such as <B>GetProcAddresss </B>and <B>FreeLibrary</B>.</P>

<P><B>LoadLibrary</B> attempts to locate the DLL using the same search sequence used for implicit linking. If the system cannot find the DLL or if the entry-point function returns FALSE, <B>LoadLibrary</B> returns NULL. If the call to <B>LoadLibrary</B> specifies a DLL module already mapped into the address space of the calling process, the function simply returns a handle of the DLL and increments the module's reference count. </P>

<P>If the DLL has an entry-point function, the operating system calls the function in the context of the thread that called <B>LoadLibrary</B>. The entry-point function is not called if the DLL is already attached to the process because of a previous call to <B>LoadLibrary</B> with no corresponding call to the <B>FreeLibrary</B> function. </P>

<P>MFC applications loading extension DLLs should use <B>AfxLoadLibrary</B> instead of <B>LoadLibrary</B>. <B>AfxLoadLibrary</B> handles thread synchronization before calling <B>LoadLibrary</B>. The interface (function prototype) to <B>AfxLoadLibrary</B> is the same as <B>LoadLibrary</B>.</P>

<P>If for some reason Windows cannot load the DLL, the process can attempt to recover from the error. For example, the process could notify the user of the error and have the user specify another path to the DLL.</P>

<H3>What do you want to do?</H3>

<UL type=disc>
	<LI><A HREF="_core_link_implicitly.htm">Link implicitly</A><BR><BR></LI>

	<LI><A HREF="_core_determine_which_linking_method_to_use.htm">Determine which linking method to use</A></LI>
</UL>

<H3>What do you want to know more about?</H3>

<UL type=disc>
	<LI><A HREF="_core_getprocaddress.htm">GetProcAddress</A><BR><BR></LI>

	<LI><A HREF="JavaScript:hhobj_2.Click()">FreeLibrary</A><BR><BR></LI>

	<LI><A HREF="_core_the_search_path_used_by_windows_to_locate_a_dll.htm">The search path used by Windows to locate a DLL</A></LI>
</UL>
</font>
</BODY>
</HTML>
