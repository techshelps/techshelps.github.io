<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO External: Working with External Data Sources</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_external.3a_.working_with_external_data_sources"></A>DAO External: Working with External Data Sources</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains the best approaches to using the MFC DAO classes with external data sources, primarily ODBC data sources.</P>

<P>Topics include:

<UL type=disc>
	<LI><A HREF="#_core_external_data_source.3a_.definition">External data source: definition</A><BR><BR></LI>

	<LI><A HREF="#_core_external_data_sources_you_can_use">External data sources you can use</A><BR><BR></LI>

	<LI><A HREF="#_core_external_data_access_choices">External data access choices</A><BR><BR></LI>

	<LI><A HREF="#_core_performance_considerations_with_external_data">Performance considerations with external data</A><BR><BR></LI>

	<LI><A HREF="#_core_when_you_might_need_to_open_an_external_table_directly">When you might need to open an external table directly</A><BR><BR></LI>

	<LI><A HREF="#_core_other_articles_about_accessing_external_data">Other articles about accessing external data</A><BR><BR></LI>

	<LI><A HREF="#_core_for_more_information_about_accessing_external_data">For more information about accessing external data</A></LI>
</UL>

<H2><A NAME="_core_external_data_source.3a_.definition"></A>External Data Source: Definition</H2>

<P>Aside from working with a Microsoft Jet (.MDB) database on your local machine, you can use the MFC DAO classes to access external data of several kinds. External data includes data located in:

<UL type=disc>
	<LI>An ODBC data source, either local or on a network server.<BR><BR></LI>

	<LI>An ISAM database such as dBASE<SUP>®</SUP> or Microsoft FoxPro<SUP>®</SUP>, accessible through the Microsoft Jet database engine, either locally or on a network server.<BR><BR></LI>

	<LI>A Microsoft Jet (.MDB) database, created directly with Microsoft Access or created with DAO and stored either locally or on a network server, that contains tables you want to attach to a primary Microsoft Jet database.</LI>
</UL>

<H2><A NAME="_core_external_data_sources_you_can_use"></A>External Data Sources You Can Use</H2>

<P>The discussion in this and related articles applies to the following external data sources:

<UL type=disc>
	<LI>Microsoft FoxPro<SUP>®</SUP>, versions 2.0, 2.5, and 2.6. Can import and export data to and from version 3.0 but can’t create objects.<BR><BR></LI>

	<LI>dBASE III<SUP>®</SUP>, dBASE IV<SUP>®</SUP>, and dBASE 5.0<SUP>®</SUP>.<BR><BR></LI>

	<LI>Paradox<SUP>™</SUP>, versions 3.x, 4.x, and 5.x.<BR><BR></LI>

	<LI>Databases using the Microsoft Jet database engine (Microsoft Access, Microsoft Visual Basic, and Microsoft Visual C++), versions 1.x, 2.x, and 3.0.<BR><BR></LI>

	<LI>ODBC data sources, including but not limited to Microsoft SQL Server, SYBASE<SUP>®</SUP> SQL Server, and ORACLE<SUP>®</SUP> Server. An ODBC data source is any DBMS for which you have the appropriate ODBC driver. For Visual C++ versions 2.0 and later, you need 32-bit ODBC drivers (except on Win32s, where you need 16-bit ODBC drivers). See the article <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A> for a list of ODBC drivers included in this version of Visual C++ and for information about obtaining additional drivers.<BR><BR></LI>

	<LI>Microsoft Excel version 3.0, 4.0, 5.0, and 7.0 worksheets.<BR><BR></LI>

	<LI>Lotus<SUP>®</SUP> WKS, WK1, WK3, WK4 spreadsheets.<BR><BR></LI>

	<LI>Text files.</LI>
</UL>



<H2><A NAME="_core_external_data_access_choices"></A>External Data Access Choices</H2>

<P>The MFC DAO classes give you two choices for accessing tables stored in external data sources. You can either:

<UL type=disc>
	<LI>Attach the tables to a Microsoft Jet (.MDB) database
<P class=tl>-or-</P></LI>

	<LI>Open the external database directly.</LI>
</UL>

<H3>Attaching Tables</H3>

<P>When you attach a table, it is treated in most respects as if it were a Microsoft Jet database table in the current database — except that you can't modify the table's schema or open a table-type recordset on it. The connection information to the external data source is stored with the table definition, making it easy to open recordsets on the table. The data is still stored in the external data source, however. For information on attaching tables, see the article <A HREF="_core_dao_external.3a_.attaching_external_tables.htm">DAO External: Attaching External Tables</A>.</P>

<P class=indent><B><B>Tip</B></B>&nbsp;&nbsp;&nbsp;If you attach a table from within Microsoft Access, you can then use the table from MFC.</P>

<H3>Opening External Databases Directly</H3>

<P>When you open a table directly, you specify the connection information each time you open the external database. This can involve communication overhead. For information on opening tables directly, see the article <A HREF="_core_dao_external.3a_.opening_external_databases_directly.htm">DAO External: Opening External Databases Directly</A>.</P>

<P class=indent><B><B>Important</B></B>&nbsp;&nbsp;&nbsp;In most cases, attaching a table is a faster method for accessing external data than opening a table directly, especially when the table is in an ODBC data source. If possible, it's best to attach external tables rather than to open them directly. If you do open a table in an ODBC data source directly, keep in mind that performance will be significantly slower. </P>

<P>To attach or open a data source on a network, you must have access to the server and share and to the external table as well as appropriate permissions for access to the data, if applicable.</P>



<H2><A NAME="_core_performance_considerations_with_external_data"></A>Performance Considerations with External Data</H2>

<P>Keep in mind that external tables are not actually in your Microsoft Jet database. Each time you view data in an external table, your program must retrieve records from another file. This can take time, particularly if the table is an ODBC data source. </P>

<P>ODBC performance is optimal if you attach tables instead of opening them directly, and if you retrieve and view only the data you need. Restrict your queries to limit results and avoid excessive scrolling through records. For more performance tips, see the article <A HREF="_core_dao_external.3a_.improving_performance_with_external_data_sources.htm">DAO External: Improving Performance with External Data Sources</A>.</P>

<P>For a discussion of why performance suffers with external data sources, particularly ODBC data sources, see the topic "Accessing External Databases with DAO" in DAO Help.</P>

<H2><A NAME="_core_when_you_might_need_to_open_an_external_table_directly"></A>When You Might Need to Open an External Table Directly</H2>

<P>Attaching external tables to a Microsoft Jet database is generally more efficient than opening the external data source directly. However, there still might be circumstances under which you would prefer to open the external database directly. They include the following:

<UL type=disc>
	<LI>Non-ODBC external data sources give faster performance if you open them directly. Only ODBC is slower when opened directly.<BR><BR></LI>

	<LI>You need to enumerate the tables in the external data source to find out the database structure at run time. Unless you know the table names, you can’t attach them.<BR><BR></LI>

	<LI>You need to manipulate the table’s structure. You can’t modify the schema of an attached table.</LI>
</UL>

<H2><A NAME="_core_other_articles_about_accessing_external_data"></A>Other Articles About Accessing External Data</H2>

<P>For more information, including procedures, see the following articles (in the recommended reading order):

<UL type=disc>
	<LI><A HREF="_core_dao_external.3a_.attaching_external_tables.htm">DAO External: Attaching External Tables</A><BR><BR></LI>

	<LI><A HREF="_core_dao_external.3a_.creating_an_external_table.htm">DAO External: Creating an External Table</A><BR><BR></LI>

	<LI><A HREF="_core_dao_external.3a_.refreshing_and_removing_links.htm">DAO External: Refreshing and Removing Links</A><BR><BR></LI>

	<LI><A HREF="_core_dao_external.3a_.improving_performance_with_external_data_sources.htm">DAO External: Improving Performance with External Data Sources</A></LI>
</UL>

<H2><A NAME="_core_for_more_information_about_accessing_external_data"></A>For More Information About Accessing External Data</H2>

<P>An additional source of information is the <I>Advanced Topics</I> book from the Microsoft Access Developer's Toolkit. You'll need to translate Microsoft Access Basic examples to MFC, but the chapter on Accessing External Data gives detailed advice on using external data sources such as Microsoft FoxPro, dBASE and Paradox.</P>

<P>For related information, see the topic "Accessing External Databases with DAO" in DAO Help. </P>

<P>For information about accessing specific external data sources, see the following topics in DAO Help:

<UL type=disc>
	<LI>Accessing Data in ODBC Databases with DAO<BR><BR></LI>

	<LI>Accessing Data in a dBASE Database with DAO<BR><BR></LI>

	<LI>Accessing Data in a Microsoft Excel Worksheet or Workbook with DAO<BR><BR></LI>

	<LI>Accessing Data in a Microsoft FoxPro Database with DAO<BR><BR></LI>

	<LI>Accessing Data in a Lotus Spreadsheet with DAO<BR><BR></LI>

	<LI>Accessing Data in a Paradox Database with DAO<BR><BR></LI>

	<LI>Accessing Data in a Text Document with DAO<BR><BR></LI>

	<LI>Accessing Data on CD-ROM with DAO</LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A></P>
</font>
</BODY>
</HTML>
