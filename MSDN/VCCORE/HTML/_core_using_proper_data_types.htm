<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Proper Data Types</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_using_proper_data_types"></A><SUP></SUP>Using Proper Data Types</H1>

<P>Windows 3.<I>x</I> source code often uses the type <B>WORD</B> interchangeably with types such as <B>HWND</B> and <B>HANDLE</B>. For example, the type cast <B>(WORD)</B> might be used to cast a data type to a handle:</P>

<PRE><CODE>hWnd = (WORD) SendMessage( hWnd, WM_GETMDIACTIVATE, 0, 0 );</CODE></PRE>

<P>This code compiles Windows 3.<I>x</I> applications correctly because both the <B>WORD</B> type and handles are 16 bits. But the code produces errors when compiled for Win32 because handles (such as <B>HWND</B> types) grow to 32 bits while the <B>WORD</B> type is still 16 bits.</P>

<P>Examine each occurrence of <B>WORD</B> casts and data definitions in your code, and revise as follows:

<UL type=disc>
	<LI>If a variable or expression is to hold a handle, replace <B>WORD</B> with <B>HWND</B>, <B>HPEN</B>, <B>HINSTANCE</B>, or another handle type.<BR><BR></LI>

	<LI>If a variable or expression is a graphics coordinate or some other integer value that grows from 16 to 32 bits, replace <B>WORD</B> with <B>UINT</B>, and <B>short</B> with <B>int.</B><BR><BR></LI>

	<LI>Continue to use the <B>WORD</B> type only if the data type needs to be 16 bits for all versions of Windows (usually because it is a function argument or structure member).</LI>
</UL>

<P>In the portable version of the previous example, the <B>(WORD)</B> cast is replaced by <B>(HWND)</B>:</P>

<PRE><CODE>hWnd = (HWND) SendMessage( hWnd, WM_GETMDIACTIVATE, 0, 0 );</CODE></PRE>

<P>In general, it is best to use the most specific type possible. Avoid using a generic handle type such as <B>HANDLE</B>, and use a more specific type such as <B>HPEN</B>. You should also define specific types for application-specific objects you create.</P>
</font>
</BODY>
</HTML>
