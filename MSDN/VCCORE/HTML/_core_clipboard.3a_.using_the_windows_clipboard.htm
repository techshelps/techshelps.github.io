<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Clipboard: Using the Windows Clipboard</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_clipboard.3a_.using_the_windows_clipboard"></A>Clipboard: Using the Windows Clipboard</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_clipboard.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_clipboard_tasks.htm">How Do I</A></P>

<P>This article describes how to use the standard Windows Clipboard API within your MFC application.</P>

<P>Most applications for Windows support cutting or copying data to the Windows Clipboard and pasting data from the Clipboard. The Clipboard data formats vary among applications. The framework supports only a limited number of Clipboard formats for a limited number of classes. You will normally implement the Clipboard-related commands — Cut, Copy, and Paste — on the Edit menu for your view. The class library defines the command IDs for these commands: <B>ID_EDIT_CUT</B>, <B>ID_EDIT_COPY</B>, and <B>ID_EDIT_PASTE</B>. Their message-line prompts are also defined.</P>

<P><A HREF="_core_messages_and_commands_in_the_framework.htm">Messages and Commands in the Framework</A>, explains how to handle menu commands in your application by mapping the menu command to a handler function. As long as your application does not define handler functions for the Clipboard commands on the Edit menu, they remain disabled. To write handler functions for the Cut and Copy commands, implement selection in your application. To write a handler function for the Paste command, query the Clipboard to see whether it contains data in a format your application can accept. For example, to enable the Copy command, you might write a handler something like the following:</P>

<PRE><CODE>void CMyView::OnEditCopy()
{
  if ( !OpenClipboard() )
  {
    AfxMessageBox( "Cannot open the Clipboard" );
    return;
  }
  // Remove the current Clipboard contents
  if( !EmptyClipboard() )
  {
    AfxMessageBox( "Cannot empty the Clipboard" );
    return;
  }
  // ...
  // Get the currently selected data
  // ...
  // For the appropriate data formats...
  if ( ::SetClipboardData( CF_??, hData ) == NULL )
  {
    AfxMessageBox( "Unable to set Clipboard data" );
    CloseClipboard();
    return;
  }
  // ...
  CloseClipboard();
}
</CODE></PRE>

<P>The Cut, Copy, and Paste commands are only meaningful in certain contexts. The Cut and Copy commands should be enabled only when something is selected, and the Paste command only when something is in the Clipboard. You can provide this behavior by defining update handler functions that enable or disable these commands depending on the context. For more information, see <A HREF="_core_how_to_update_user.2d.interface_objects.htm">How to Update User-Interface Objects</A>.</P>

<P>The Microsoft Foundation Class Library does provide Clipboard support for text editing with the <B>CEdit</B> and <B>CEditView</B> classes. The OLE classes also simplify implementing Clipboard operations that involve OLE items. For more information on the OLE classes, see <A HREF="_core_clipboard.3a_.using_the_ole_clipboard_mechanism.htm">Clipboard: Using the OLE Clipboard Mechanism</A>.</P>

<P>Implementing other Edit menu commands, such as Undo (<B>ID_EDIT_UNDO</B>) and Redo (<B>ID_EDIT_REDO</B>), is also left to you. If your application does not support these commands, you can easily delete them from your resource file using the Visual C++ resource editors.</P>

<H3>What do you want to know more about?</H3>

<UL type=disc>
	<LI><A HREF="_core_clipboard.3a_.copying_and_pasting_data.htm">Copying and pasting data</A><BR><BR></LI>

	<LI><A HREF="_core_clipboard.3a_.using_the_ole_clipboard_mechanism.htm">Using the OLE Clipboard mechanism</A></LI>
</UL>
</font>
</BODY>
</HTML>
