<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO External: Attaching External Tables</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.Create">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.SetConnect">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.SetSourceTableName">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.Append">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.RefreshLink">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_external.3a_.attaching_external_tables"></A>DAO External: Attaching External Tables</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains how to attach a table from an external data source, such as an ODBC data source, to your current Microsoft Jet (.MDB) database. Attaching external tables is generally more efficient than opening them directly, as explained in the article <A HREF="_core_dao_external.3a_.working_with_external_data_sources.htm">DAO External: Working with External Data Sources</A>.</P>

<P class=indent><B><B>Important</B></B>&nbsp;&nbsp;&nbsp;For performance reasons, it is best to attach tables in ODBC data sources rather than to open them directly. You can open non-ODBC external data sources directly if you like.</P>

<P class=indent><B><B>Tip</B></B>&nbsp;&nbsp;&nbsp;If you attach a table from within Microsoft Access, you can then use the table from MFC.</P>

<P class=label><B>To attach an external table using the MFC DAO classes</B>

<OL>
	<LI>Open your Microsoft Jet (.MDB) database (the one to which you'll attach the external table): 
<P class=tl>Construct a <A HREF="JavaScript:hhobj_3.Click()">CDaoDatabase</A> object, or obtain a pointer to one (from an open recordset object, for example) and call the object's <A HREF="JavaScript:hhobj_4.Click()">Open</A> member function. </P></LI>

	<LI>Using the <B>CDaoDatabase</B> object, create a new <A HREF="JavaScript:hhobj_5.Click()">CDaoTableDef</A> object. Construct the tabledef object, then call its <A HREF="JavaScript:hhobj_6.Click()">Create</A> member function.
<P class=tl>In the <B>Create</B> call, you can specify the source table name and the connect string. Or you can accept the defaults in <B>Create</B> and separately call <A HREF="JavaScript:hhobj_7.Click()">SetConnect</A> and <A HREF="JavaScript:hhobj_8.Click()">SetSourceTableName</A> to specify the connect string and the name of the table as it appears on the data source. The example following this procedure calls <B>SetConnect</B> and <B>SetSourceTableName</B>.</P></LI>

	<LI>Attach the external table by appending it to the <B>CDaoDatabase</B> object's TableDefs collection. 
<P class=tl>Call the tabledef object's <A HREF="JavaScript:hhobj_9.Click()">Append</A> member function.</P></LI>

	<LI>Use the attached table as if it were actually a table in the Microsoft Jet database. 
<P class=tl>You can do the following, among other things:</P>
<UL type=disc>
	<LI>Use the table to create a recordset.<BR><BR></LI>

	<LI>Examine fields and indexes in the table.<BR><BR></LI>

	<LI>Get or set validation conditions for the table.</LI>
</UL>
</LI>
</OL>

<P>The following example illustrates how to attach an external table:</P>

<PRE><CODE>// Construct the database and the tabledef
CDaoDatabase db;
db.Open("C:\\datatbase\\theDB.mdb");

// Construct the tabledef then create attached table
CDaoTableDef td( &amp;db );
td.Create( "Preferred Customers", 0, "Customers",  
"ODBC;DSN=afx;UID=sa;PWD=Fred" );

// Attach the tabledef to the external data source
td.Append( );

// Use td ...
</CODE></PRE>

<P>The parameters to create are the tabledef name, attributes, source table name, and connect string.</P>

<P>Your link to the attached table remains active unless you delete the tabledef object or move the source table. If you move the source table, you can refresh the link using the tabledef object's <A HREF="JavaScript:hhobj_10.Click()">RefreshLink</A> member function.</P>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;For the external indexed sequential access method (ISAM) databases, such as FoxPro and dBASE, specify the full path to the directory in which the database files are located when a database name is called for.</P>

<P class=indent><B><B>Tip</B></B>&nbsp;&nbsp;&nbsp;Because a tabledef object name can be any valid Microsoft Access table name, you can give the attached table a more descriptive name than is often allowed in the external data source. For example, if you attach an external dBASE table named SLSDATA, you can rename the attached table as “Sales Data 1995 (from dBASE).” The code in the previous example illustrates this.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao_external.3a_.working_with_external_data_sources.htm">DAO External: Working with External Data Sources</A>, <A HREF="_core_dao_external.3a_.opening_external_databases_directly.htm">DAO External: Opening External Databases Directly</A></P>
</font>
</BODY>
</HTML>
