<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Containers: Advanced Features</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_OCLIENT">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_HIERSVR">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_OCLIENT">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_containers.3a_.advanced_features"></A>Containers: Advanced Features</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_ole_in_mfc.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_ole_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_ole_sample_list.htm">Sample</A>  |&nbsp; <A HREF="_core_ole_tutorial_list.htm">Tutorial</A></P>

<P>This article describes the steps necessary to incorporate optional advanced features into existing container applications. These features are:

<UL type=disc>
	<LI><A HREF="#_core_creating_a_container.2f.server_application">An application that is both a container and a server</A><BR><BR></LI>

	<LI><A HREF="#_core_links_to_embedded_objects">An OLE link to an embedded object</A></LI>
</UL>



<H2><A NAME="_core_creating_a_container.2f.server_application"></A>Creating a Container/Server Application</H2>

<P>A container/server application is an application that acts as both a container and a server. Microsoft Word for Windows is an example of this. You can embed Word for Windows documents in other applications, and you can also embed items in Word for Windows documents. The process for modifying your container application to be both a container and a full-server (you can’t create a combination container/mini-server application) is similar to the process for creating a full-server.</P>

<P>The article <A HREF="_core_servers.3a_.implementing_a_server.htm">Servers: Implementing a Server</A> lists a number of tasks required to implement a server application. If you convert a container application to a container/server application, you’ll need to perform some of those same tasks, adding code to the container. The following lists the important things to consider:

<UL type=disc>
	<LI>The container code created by AppWizard already initializes the OLE subsystem. You won’t need to change or add anything for that support.<BR><BR></LI>

	<LI>Wherever the base class of a document class is <B>COleDocument</B>, change the base class to <B>COleServerDoc</B>.<BR><BR></LI>

	<LI>Override <B>COleClientItem::CanActivate</B> to avoid editing items in place while the server itself is being used to edit in place. 
<P class=tl>For example: the MFC OLE sample <A HREF="JavaScript:hhobj_2.Click()">OCLIENT</A> has embedded an item created by your container/server application. You open the OCLIENT application and in-place edit the item created by your container/server application. While editing your application’s item, you decide you want to embed an item created by the MFC OLE sample <A HREF="JavaScript:hhobj_3.Click()">HIERSVR</A>. To do this, you cannot use in-place activation. You must fully open HIERSVR to activate this item. Because the Microsoft Foundation Class Library does not support this OLE feature, overriding <B>COleClientItem::CanActivate</B> allows you to check for this situation and prevent a possible run-time error in your application.</P></LI>
</UL>

<P>If you are creating a new application and want it to function as a container/server application, choose that option in the OLE Options dialog box in AppWizard and this support will be created automatically. For more information, see the article <A HREF="_core_overview.3a_.creating_an_activex_control_container.htm">Overview: Creating an ActiveX Control Container</A>. For information about MFC samples, see MFC Samples.</P>

<P>Note that you cannot insert an MDI application into itself. An application that is a container/server cannot be inserted into itself unless it is an SDI application.</P>



<H2><A NAME="_core_links_to_embedded_objects"></A>Links to Embedded Objects</H2>

<P>The Links to Embedded Objects feature enables a user to create a document with an OLE link to an embedded object inside your container application. For example, create a document in a word processor containing an embedded spreadsheet. If your application supports links to embedded objects, it could paste a link to the spreadsheet contained in the word processor’s document. This feature allows your application to use the information contained in the spreadsheet without knowing where the word processor originally got it.</P>

<P class=label><B>To link to embedded objects in your application</B>

<OL>
	<LI>Derive your document class from <B>COleLinkingDoc</B> instead of <B>COleDocument</B>.<BR><BR></LI>

	<LI>Create an OLE class ID (<B>CLSID</B>) for your application by using the Class ID Generator included with the OLE Development Tools.<BR><BR></LI>

	<LI>Register the application with OLE.<BR><BR></LI>

	<LI>Create a <B>COleTemplateServer</B> object as a member of your application class.<BR><BR></LI>

	<LI>In your application class’s <B>InitInstance</B> member function, do the following:
<UL type=disc>
	<LI>Connect your <B>COleTemplateServer</B> object to your document templates by calling the object’s <B>ConnectTemplate</B> member function.<BR><BR></LI>

	<LI>Call the <B>COleTemplateServer::RegisterAll</B> member function to register all class objects with the OLE system.<BR><BR></LI>

	<LI>Call <B>COleTemplateServer::UpdateRegistry</B>. The only parameter to <B>UpdateRegistry</B> should be <B>OAT_CONTAINER</B> if the application is not launched with the “/Embedded” switch. This registers the application as a container that can support links to embedded objects.
<P class=tl>If the application is launched with the “/Embedded” switch, it should not show its main window, similar to a server application.</P></LI>
</UL>
</LI>
</OL>

<P>The MFC OLE sample <A HREF="JavaScript:hhobj_4.Click()">OCLIENT</A> implements this feature. For an example of how this is done, see the <B>InitInstance</B> function in the OCLIENT.CPP file of this sample application. </P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_servers.htm">Servers</A> </P>
</font>
</BODY>
</HTML>
