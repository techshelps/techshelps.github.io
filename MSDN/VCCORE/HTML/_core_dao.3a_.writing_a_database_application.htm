<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO: Writing a Database Application</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordView">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CListView">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CTreeView">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_DAOVIEW">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CView">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDocument">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDocument.3a3a.UpdateAllViews">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CFrameWnd">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_15" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDialog">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao.3a_.writing_a_database_application"></A>DAO: Writing a Database Application</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This family of articles discusses writing database applications with the MFC DAO classes. Other articles focus on various parts of the process; this article looks at using DAO from an application design standpoint.</P>

<H3>In This Article</H3>

<P>This article considers:

<UL type=disc>
	<LI><A HREF="#_core_what_is_a_database_application.3f">What is a database application?</A><BR><BR></LI>

	<LI><A HREF="#_core_first_steps_in_writing_your_mfc_dao_application">First steps in writing your MFC DAO application</A><BR><BR></LI>

	<LI><A HREF="#_core_data_viewing_choices">Data viewing choices</A><BR><BR></LI>

	<LI><A HREF="#_core_documents_and_views_with_dao">Documents and views with DAO</A><BR><BR></LI>

	<LI><A HREF="#_core_dbms_choices">DBMS choices</A></LI>
</UL>

<H3>Other Articles in the Article Family on the Process</H3>

<P>The following additional articles discuss parts of the design and development process (in recommended reading order):

<UL type=disc>
	<LI><A HREF="_core_dao.3a_.database_application_design_options.htm">DAO: Database Application Design Options</A><BR><BR></LI>

	<LI><A HREF="_core_dao.3a_.steps_in_writing_mfc_dao_applications.htm">DAO: Steps in Writing MFC DAO Applications</A></LI>
</UL>

<H2><A NAME="_core_what_is_a_database_application.3f"></A>What Is a Database Application?</H2>

<P>Database applications obtain and manipulate data from a database managed by a database management system (DBMS). Typical database applications include programs for data input, data viewing, and batch processing of data. </P>

<P>Of course, there is no one kind of database application. There is a wide range from simple data entry or data viewing applications to complex client/server applications.</P>

<P>Beyond that, applications of any sort might use a database rather than disk-based files for input/output. For example, an e-mail client program that you use to read your mail doesn’t feel like a traditional database application, but it might use a database to store addresses, messages, and other information. In any case, the MFC DAO classes supply abstractions that you can use to write any kind of database application.</P>

<H2><A NAME="_core_first_steps_in_writing_your_mfc_dao_application"></A>First Steps in Writing Your MFC DAO Application</H2>

<P>To begin, you must make two fundamental decisions:

<UL type=disc>
	<LI>How do you want to display data in your application: in a form, as a list, some other way, or not at all.<BR><BR></LI>

	<LI>What database management system(s) (DBMSs) do you intend to target?</LI>
</UL>

<P>Your decisions determine how your application fits into MFC's document/view architecture and how appropriate the DAO classes are for your application. Your answers also help determine the selections you make when you run AppWizard to begin constructing your application.</P>



<H2><A NAME="_core_data_viewing_choices"></A>Data Viewing Choices</H2>

<P>MFC supplies varying degrees of support for different viewing choices:

<UL type=disc>
	<LI>Displaying one record at a time in a form.
<P class=tl>AppWizard will create a <A HREF="JavaScript:hhobj_3.Click()">CDaoRecordView</A>-derived class for you and connect it to a <A HREF="JavaScript:hhobj_4.Click()">CDaoRecordset</A> based on a table you specify. This makes it easy to create simple form-based applications.</P></LI>

	<LI>Displaying multiple records at a time.
<P class=tl>While AppWizard doesn't give any special help for this option, you can fairly easily connect a <B>CDaoRecordset</B> to a <A HREF="JavaScript:hhobj_5.Click()">CListView</A> or <A HREF="JavaScript:hhobj_6.Click()">CTreeView</A>. For examples, see the MFC Database sample <A HREF="JavaScript:hhobj_7.Click()">DAOVIEW</A>. </P></LI>

	<LI>Displaying multiple views of the data simultaneously, either in separate windows or in panes of a splitter window.</LI>
</UL>



<H2><A NAME="_core_documents_and_views_with_dao"></A>Documents and Views with DAO</H2>

<P>Do you need the MFC document/view architecture? The simplest architecture for MFC applications is to manage your data within an MFC document object and manage displaying that data separately in a view object. You aren't limited to this structure, though. Other options include:

<UL type=disc>
	<LI>Using a view object but treating the document as an unused appendage. 
<P class=tl>You can make your data structures — mainly your <A HREF="JavaScript:hhobj_8.Click()">CDaoDatabase</A> and <A HREF="JavaScript:hhobj_9.Click()">CDaoRecordset</A> objects — members of your <A HREF="JavaScript:hhobj_10.Click()">CView</A>-derived class rather than of a <A HREF="JavaScript:hhobj_11.Click()">CDocument</A>-derived class. Database applications typically don't need MFC's serialization mechanism, which is the primary feature of <B>CDocument</B>.</P>
<P class=tl>A particularly strong argument for using MFC’s document/view architecture is the ability to manage multiple views of your data through the document. <B>CDocument</B> has an <A HREF="JavaScript:hhobj_12.Click()">UpdateAllViews</A> member function that you can call to synchronize your views as data displayed in them changes. This is as useful in database applications as in any other kind of application.</P></LI>

	<LI>Drawing your data directly into the client area of a <A HREF="JavaScript:hhobj_13.Click()">CFrameWnd</A>-derived class. 
<P class=tl>You can handle Windows messages in the frame window and thus dispense with the view and the document. If you use a view, you can't just strip the document code from your application, but if you use neither view nor document, you can remove (or ignore) both the view code and the document code. In this case, you can store your <B>CDaoDatabase</B> and <B>CDaoRecordset</B> objects in the frame window class.</P></LI>

	<LI>Basing your application on a dialog box. 
<P class=tl>AppWizard supports this approach, and you can store your <A HREF="JavaScript:hhobj_14.Click()">CDaoDatabase</A> object(s) as members of your <A HREF="JavaScript:hhobj_15.Click()">CDialog</A>-derived class.</P></LI>
</UL>

<P>For related information, see the articles <A HREF="_core_mfc.3a_.using_database_classes_with_documents_and_views.htm">MFC: Using Database Classes with Documents and Views</A> and <A HREF="_core_mfc.3a_.using_database_classes_without_documents_and_views.htm">MFC: Using Database Classes Without Documents and Views</A>.</P>



<H2><A NAME="_core_dbms_choices"></A>DBMS Choices</H2>

<P>DAO is based on the Microsoft Jet database engine. Thus, DAO is optimally suited for working with Microsoft Jet (.MDB) databases. DAO also supports accessing external databases, including certain installable ISAM databases (which the database engine can read directly) and ODBC data sources. This means you can write DBMS-independent applications with DAO, targeting any data source that the Microsoft Jet database engine can read directly or for which your users will have the appropriate ODBC driver. </P>

<P>Note, however, that in general it is more efficient, with DAO, to attach ODBC data source tables to a Microsoft Jet database than it is to access the external data source directly. If your application is targeted on an external data source such as Microsoft SQL Server or Oracle, you might want to consider using the MFC ODBC classes instead of DAO.</P>

<P>For related information, see the articles <A HREF="_core_database_topics_.28.dao.29.htm">Database Topics (DAO)</A> and <A HREF="_core_dao_external.3a_.working_with_external_data_sources.htm">DAO External: Working with External Data Sources</A>.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao.3a_.database_tasks.htm">DAO: Database Tasks</A>, <A HREF="_core_dao.3a_.database_application_design_options.htm">DAO: Database Application Design Options</A>, <A HREF="_core_dao.3a_.steps_in_writing_mfc_dao_applications.htm">DAO: Steps in Writing MFC DAO Applications</A>, <A HREF="_core_mfc.3a_.using_database_classes_with_documents_and_views.htm">MFC: Using Database Classes with Documents and Views</A>, <A HREF="_core_mfc.3a_.using_database_classes_without_documents_and_views.htm">MFC: Using Database Classes Without Documents and Views</A>.</P>
</font>
</BODY>
</HTML>
