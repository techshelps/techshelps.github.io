<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Recordset: Bookmarks and Absolute Positions (ODBC)</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.GetBookmark">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.SetBookmark">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDBVariant">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.CanBookmark">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDatabase.3a3a.GetBookmarkPersistence">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.SetAbsolutePosition">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_recordset.3a_.bookmarks_and_absolute_positions_.28.odbc.29"></A>Recordset: Bookmarks and Absolute Positions (ODBC)</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article applies to the MFC ODBC classes. For DAO recordsets, see the article <A HREF="_core_dao_recordset.htm">DAO Recordset</A>.</P>

<P>When navigating through a recordset, you often need a way of returning to a particular record. A record's bookmark and absolute position provide two such methods.</P>

<P>This article explains:

<UL type=disc>
	<LI><A HREF="#_core_bookmarks_in_mfc_odbc">How to use bookmarks</A>.<BR><BR></LI>

	<LI><A HREF="#_core_absolute_positions_in_mfc_odbc">How to set the current record using absolute positions</A>.</LI>
</UL>



<H2><A NAME="_core_bookmarks_in_mfc_odbc"></A>Bookmarks in MFC ODBC</H2>

<P>A bookmark uniquely identifies a record. When you navigate through a recordset, you can't always rely on the absolute position of a record since records can be deleted from the recordset. The reliable way to keep track of the position of a record is to use its bookmark. Class <B>CRecordset</B> supplies member functions for:

<UL type=disc>
	<LI>Getting the bookmark of the current record, so you can save it in a variable (<A HREF="JavaScript:hhobj_3.Click()">GetBookmark</A>).<BR><BR></LI>

	<LI>Moving quickly to a given record by specifying its bookmark, which you saved earlier in a variable (<A HREF="JavaScript:hhobj_4.Click()">SetBookmark</A>).</LI>
</UL>

<P>The following example illustrates how to use these member functions to mark the current record and later return to it:</P>

<PRE><CODE>// rs is a CRecordset or
// CRecordset-derived object

CDBVariant varRecordToReturnTo;
rs.GetBookmark( varRecordToReturnTo );

// More code in which you
// move to other records

rs.SetBookmark( varRecordToReturnTo );
</CODE></PRE>

<P>You do not need to extract the underlying data type from the <A HREF="JavaScript:hhobj_5.Click()">CDBVariant</A> object. Simply assign the value with <B>GetBookmark</B> and return to that bookmark with <B>SetBookmark</B>.</P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>Depending on your ODBC driver and recordset type, bookmarks may not be supported. You can easily determine whether bookmarks are supported by calling <A HREF="JavaScript:hhobj_6.Click()">CRecordset::CanBookmark</A>. Furthermore, if bookmarks are supported, you must explicitly choose to implement them by specifying the <B>CRecordset::useBookmarks</B> option in the <A HREF="JavaScript:hhobj_7.Click()">Open</A> member function. You should also check the persistence of bookmarks after certain recordset operations. For example, if you <B>Requery</B> a recordset, bookmarks may no longer be valid. Call <A HREF="JavaScript:hhobj_8.Click()">CDatabase::GetBookmarkPersistence</A> to check whether you can safely call <B>SetBookmark</B>.</P>



<H2><A NAME="_core_absolute_positions_in_mfc_odbc"></A>Absolute Positions in MFC ODBC</H2>

<P>Besides bookmarks, class <B>CRecordset</B> allows you to set the current record by specifying an ordinal position. This is called absolute positioning.</P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>Absolute positioning is not available on forward-only recordsets. For more information about forward-only recordsets, see the article <A HREF="_core_recordset_.28.odbc.29.htm">Recordset (ODBC)</A>.</P>

<P>To move the current record pointer using absolute position, call <A HREF="JavaScript:hhobj_9.Click()">CRecordset::SetAbsolutePosition</A>. When you pass a value to <B>SetAbsolutePosition</B>, the record corresponding to that ordinal position becomes the current record.</P>

<P class=indent><B><B>Important&nbsp;&nbsp;&nbsp;</B></B>The absolute position of a record is potentially unreliable. If the user deletes records from the recordset, the ordinal position of any subsequent record will change. Bookmarks are the recommended method for moving the current record. See <A HREF="#_core_bookmarks_in_mfc_odbc">Bookmarks in MFC ODBC</A>.</P>

<P>For more information about recordset navigation, see the article <A HREF="_core_recordset.3a_.scrolling_.28.odbc.29.htm">Recordset: Scrolling (ODBC)</A>.</P>
</font>
</BODY>
</HTML>
