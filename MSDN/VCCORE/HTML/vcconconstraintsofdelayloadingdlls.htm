<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Constraints of Delay Loading DLLs</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_TlsAlloc">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_TlsFree">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_TlsGetValue">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_TlsSetValue">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="vcconconstraintsofdelayloadingdlls"></A>Constraints of Delay Loading DLLs</H1>

<P>There are constraints regarding the delay loading of imports.

<UL type=disc>
	<LI>Imports of data cannot be supported. A workaround is to explicitly handle the data import yourself using <B>LoadLibrary</B> (or <B>GetModuleHandle</B> after you know the delay-load helper has loaded the DLL) and <B>GetProcAddress</B>.<BR><BR></LI>

	<LI>Delay loading Kernel32.dll not supported. This DLL is necessary for the delay-load helper routines to perform the delay loading.<BR><BR></LI>

	<LI>Binding of entry points that are forwarded is not supported.<BR><BR></LI>

	<LI>Delay loading of a DLL may not result in the same behavior of the process if there are per-process initializations that occur in the entry point of the delay-loaded DLL. Other cases include static TLS (thread local storage, declared using <A HREF="_langref_thread.htm">__declspec(thread)</A> which is not handled when the DLL is loaded via <B>LoadLibrary</B>. Dynamic TLS, using&nbsp; <A HREF="JavaScript:hhobj_1.Click()">TlsAlloc</A>, <A HREF="JavaScript:hhobj_2.Click()">TlsFree</A>, <A HREF="JavaScript:hhobj_3.Click()">TlsGetValue</A>, <A HREF="JavaScript:hhobj_4.Click()">TlsSetValue</A> is still available for use in either static or delay-loaded DLLs.<BR><BR></LI>

	<LI>Static (global) function pointers should be reinitialized to imported functions after the first call to the function. This is because the first use of the function pointer will point to the thunk.</LI>
</UL>
</font>
</BODY>
</HTML>
