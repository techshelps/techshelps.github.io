<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Understanding the Helper Function</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="vcconunderstandinghelperfunction"></A>Understanding the Helper Function</H1>

<P>The helper function for linker-supported delayed loading is what actually loads the DLL at run time. You can modify the helper function to customize its behavior by writing your own function and linking it to your program instead of using the supplied helper function in Delayimp.lib. One helper function serves all delay loaded DLLs.</P>

<P>The helper function performs the following actions:

<UL type=disc>
	<LI>Checks the stored handle to the library to see if it has already been loaded<BR><BR></LI>

	<LI>Calls <B>LoadLibrary</B> to attempt loading of the DLL<BR><BR></LI>

	<LI>Calls <B>GetProcAddress</B> to attempt getting the address of the procedure<BR><BR></LI>

	<LI>Returns to the delay import load thunk to call the now-loaded entry point</LI>
</UL>

<P>The helper function can call back to a notification hook in your program after each of the following actions:

<UL type=disc>
	<LI>When the helper function starts up<BR><BR></LI>

	<LI>Just before <B>LoadLibrary</B> is called in the helper function<BR><BR></LI>

	<LI>Just before <B>GetProcAddress</B> is called in the helper function<BR><BR></LI>

	<LI>If the call to <B>LoadLibrary</B> in the helper function failed<BR><BR></LI>

	<LI>If the call to <B>GetProcAddress</B> in the helper function failed<BR><BR></LI>

	<LI>After the helper function is done processing</LI>
</UL>

<P>Each of these hook points can return a value that will alter normal processing of the helper routine in some manner except the return to the delay import load thunk.</P>

<P>The default helper code can be found in Delayhlp.cpp and Delayimp.h (in vc\include) and is compiled in Delayimp.lib (in vc\lib). You will need to include this library in your compilations unless you write your own helper function.</P>

<P class=label><B>The following topics describe the helper function:</B>

<UL type=disc>
	<LI><A HREF="vcconcallingconventionsparameters.htm">Calling Conventions and Parameters</A><BR><BR></LI>

	<LI><A HREF="vcconstructureconstantdefinitions.htm">Structure and Constant Definitions</A><BR><BR></LI>

	<LI><A HREF="vcconcalculatingnecessaryvalues.htm">Calculating Necessary Values</A><BR><BR></LI>

	<LI><A HREF="vcconreturnvalue.htm">Return Value</A><BR><BR></LI>

	<LI><A HREF="vcconexplicitlyunloadingdelay-loadeddll.htm">Explicitly Unloading a Delay-Loaded DLL</A></LI>
</UL>
</font>
</BODY>
</HTML>
