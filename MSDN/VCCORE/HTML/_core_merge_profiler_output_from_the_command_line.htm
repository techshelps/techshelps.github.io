<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Merge Profiler Output from the Command Line</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_perf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="vceditions">
</OBJECT>
</TD></TR></TABLE>
<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_merge_profiler_output_from_the_command_line"></A>Merge Profiler Output from the Command Line</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_profiling.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_articles_that_tell_about_performance_tuning.htm">Details</A></P>

<P><B><B>Feature Only in Professional and Enterprise Editions</B></B>&nbsp;&nbsp;&nbsp;Profiling is supported only in Visual C++ Professional and Enterprise Editions. For more information, see <A HREF="JavaScript:hhobj_2.Click()">Visual C++ Editions</A>.</P>

<P>If you need a single <A HREF="_core_plist.htm">PLIST</A> report from multiple profile runs, you must write and execute a batch file like this:</P>

<PRE><CODE>PREP /LV myprog.exe myfuncs.dll
PROFILE /O myprog1 myprog.exe
PROFILE /O myprog2 myprog.exe
PROFILE /O myprog3 myprog.exe
PREP /IT myprog /IO myprog1 /IO myprog2 /IO myprog3 /OT myprog
PLIST myprog &gt;myprog.out
</CODE></PRE>

<P>In this example, the program data can vary for each invocation of the <A HREF="_core_profile.htm">PROFILE</A> command.&nbsp; Then, the data is merged in the second <A HREF="_core_prep.htm">PREP</A> invocation.</P>

<P>Or, alternatively, because PREP Phase II adds data to an existing .PBT file:</P>

<PRE><CODE>PREP /LV myprog.exe myfuncs.dll
PROFILE myprog
PREP /M myprog
PROFILE myprog
PREP /M myprog
PROFILE myprog
PREP /M myprog
PLIST myprog &gt;myprog.out
</CODE></PRE>

<P>In this example, the output of the current profiler run is merged with the cumulative statistics from all previous profiler runs.</P>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;You can merge only eight .PBO files from the command line with each PREP invocation. To overcome this limitation, use PREP Phase II to merge groups of .PBO files into .PBT files. Then, merge the resulting .PBT files to yield a single .PBT file that contains statistics from the constituent .PBO files.</P>

<P>You cannot merge .PBO or .PBT files from different .PBI files. PREP can combine information only from profiling sessions that use the same .EXE and .PBI files (and therefore have identical profiling characteristics). You cannot, for example, merge the results of a timing session with the results of a coverage session.</P>
</font>
</BODY>
</HTML>
