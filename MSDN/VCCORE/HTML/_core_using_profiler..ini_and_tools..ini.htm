<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using PROFILER.INI and TOOLS.INI</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_perf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="vceditions">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_using_profiler..ini_and_tools..ini"></A>Using PROFILER.INI and TOOLS.INI</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_profiling.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_articles_that_tell_about_performance_tuning.htm">Details</A></P>

<P><B><B>Feature Only in Professional and Enterprise Editions</B></B>&nbsp;&nbsp;&nbsp;Profiling is supported only in Visual C++ Professional and Enterprise Editions. For more information, see <A HREF="JavaScript:hhobj_2.Click()">Visual C++ Editions</A>.</P>

<P>Upon invocation, the profiler looks in either one or two files for information about which object files and libraries to exclude. If neither of these files is present, profiling still continues. If exclude instructions exist in both files, all indicated object files and libraries will be excluded.</P>

<P>The PROFILER.INI file is created upon installation in \Program Files\Microsoft Visual Studio\VC98\bin . The <CODE>[profiler]</CODE> section of PROFILER.INI specifies libraries and object (.OBJ) files for the profiler to ignore. PROFILER.INI excludes object files and libraries from profiling that you would not ordinarily want to profile. By default, PROFILER.INI excludes the Win32 libraries, Microsoft Foundation Class (MFC) libraries, and C run-time libraries. View this file to see the complete list.</P>

<P>Whenever the profiler is run, it checks for the existence of the PROFILER.INI file in the same directory that the profiler executable files are located. If the file is present, it will exclude libraries and object files as indicated.</P>

<P>You should not modify PROFILER.INI, because if you reinstall Visual C++ the file will be overwritten.</P>

<P>TOOLS.INI is the file where you should specify additional object files and libraries to exclude from profiling. You have to create this file. You also have to set the INIT environment variable to the directory where TOOLS.INI can be found. For example, if you create TOOLS.INI in the root directory of your machine, you would set INIT to C:\.</P>

<P>As a sample, the following lines are taken from the default PROFILER.INI and represent the same format to use in TOOLS.INI. These commands exclude the common dialog and graphics device interface (GDI) libraries from profiling:</P>

<PRE><CODE>[profiler]
exclude:comdlg32.lib
exclude:gdi32.lib
</CODE></PRE>
</font>
</BODY>
</HTML>
