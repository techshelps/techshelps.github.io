<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Tree Control Item States Overview</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CTreeCtrl">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CTreeCtrl.3a3a.SetItemState">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CTreeCtrl.3a3a.GetItemState">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_tree_view_control_item_states">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_Win32_INDEXTOOVERLAYMASK">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CImageList.3a3a.SetOverlayImage">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_Win32_INDEXTOSTATEIMAGEMASK">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_tree_control_item_states_overview"></A>Tree Control Item States Overview</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_using_ctreectrl.htm">Overview</A>  |&nbsp; <A HREF="_core_common_control_sample_list.htm">Sample</A></P>

<P>Each item in a tree control (<A HREF="JavaScript:hhobj_2.Click()">CTreeCtrl</A>) has a current state. For example, an item can be selected, disabled, expanded, and so on. For the most part, the tree control automatically sets an item's state to reflect user actions, such as selection of an item. However, you can also set an item's state by using the <A HREF="JavaScript:hhobj_3.Click()">SetItemState</A> member function and retrieve the current state of an item by using the <A HREF="JavaScript:hhobj_4.Click()">GetItemState</A> member function. For a complete list of item states, see <A HREF="JavaScript:hhobj_5.Click()">Tree-View Control Constants</A> in the <I>Platform SDK</I>.</P>

<P>An item's current state is specified by the <I>nState</I> parameter. A tree control might change an item's state to reflect a user action, such as selecting the item or setting the focus to the item. In addition, an application might change an item's state to disable or hide the item or to specify an overlay image or state image.</P>

<P>When you specify or change an item's state, the <I>nStateMask</I> parameter specifies which state bits to set, and the <I>nState</I> parameter contains the new values for those bits. For example, the following example changes the current state of a parent item (specified by <CODE>hParentItem</CODE>) in a <B>CTreeCtrl</B> object (<CODE>m_treeCtrl</CODE>) to <B>TVIS_EXPANDPARTIAL</B>:</P>

<PRE><CODE>TVITEM curItem;
HTREEITEM hParentItem;

hParentItem= m_treeCtrl.GetSelectedItem();

//modify the parent item to keep the '+' sign
curItem.mask= TVIF_HANDLE;
curItem.hItem= hParentItem;
m_treeCtrl.GetItem(&amp;curItem);

curItem.mask= TVIF_STATE;
curItem.state= TVIS_EXPANDPARTIAL;
curItem.stateMask= TVIS_EXPANDPARTIAL;
m_treeCtrl.SetItem(&amp;curItem);
</CODE></PRE>

<P>Another example of changing the state would be to set an item's overlay image. To accomplish this, <I>nStateMask</I> must include the <B>TVIS_OVERLAYMASK</B> value, and <I>nState</I> must include the one-based index of the overlay image shifted left eight bits by using the <A HREF="JavaScript:hhobj_6.Click()">INDEXTOOVERLAYMASK</A> macro. The index can be 0 to specify no overlay image. The overlay image must have been added to the tree control's list of overlay images by a previous call to the <A HREF="JavaScript:hhobj_7.Click()">CImageList::SetOverlayImage</A> function. The function specifies the one-based index of the image to add; this is the index used with the <B>INDEXTOOVERLAYMASK</B> macro. A tree control can have up to four overlay images.</P>

<P>To set an item's state image, <I>nStateMask</I> must include the <B>TVIS_STATEIMAGEMASK</B> value, and <I>nState</I> must include the one-based index of the state image shifted left 12 bits by using the <A HREF="JavaScript:hhobj_8.Click()">INDEXTOSTATEIMAGEMASK</A> macro. The index can be 0 to specify no state image. For more information about overlay and state images, see <A HREF="_core_tree_control_image_lists.htm">Tree Control Image Lists</A>.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_control_topics.htm#_core_windows_common_controls_and_mfc_classes">Windows Common Controls and MFC Classes</A></P>
</font>
</BODY>
</HTML>
