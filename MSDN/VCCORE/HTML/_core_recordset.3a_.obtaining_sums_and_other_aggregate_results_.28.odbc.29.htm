<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Recordset: Obtaining SUMs and Other Aggregate Results (ODBC)</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CRecordset.3a3a.DoFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CRecordView">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_recordset.3a_.obtaining_sums_and_other_aggregate_results_.28.odbc.29"></A>Recordset: Obtaining SUMs and Other Aggregate Results (ODBC)</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article applies to the MFC ODBC classes. For DAO recordsets, see the article <A HREF="_core_dao_recordset.htm">DAO Recordset</A>.</P>

<P>This article explains how to obtain aggregate results using the following <A HREF="_core_sql.htm">SQL</A> keywords:

<UL type=disc>
	<LI><B>SUM</B>&nbsp;&nbsp;&nbsp;Calculates the total of the values in a column with a numeric data type.<BR><BR></LI>

	<LI><B>MIN</B>&nbsp;&nbsp;&nbsp;Extracts the smallest value in a column with a numeric data type.<BR><BR></LI>

	<LI><B>MAX</B>&nbsp;&nbsp;&nbsp;Extracts the largest value in a column with a numeric data type.<BR><BR></LI>

	<LI><B>AVG</B>&nbsp;&nbsp;&nbsp;Calculates an average value of all the values in a column with a numeric data type.<BR><BR></LI>

	<LI><B>COUNT</B>&nbsp;&nbsp;&nbsp;Counts the number of records in a column of any data type.</LI>
</UL>

<P>You use these SQL functions to obtain statistical information about the records in a data source rather than to extract records from the data source. The recordset that is created usually consists of a single record (if all columns are aggregates) that contains a value. (There might be more than one record if you used a <B>GROUP BY</B> clause.) This value is the result of the calculation or extraction performed by the SQL function.</P>

<P class=indent><B><B>Tip&nbsp;&nbsp;&nbsp;</B></B>To add an SQL <B>GROUP BY</B> clause (and possibly a <B>HAVING</B> clause) to your SQL statement, append it to the end of <B>m_strFilter</B>. For example:</P>

<PRE><CODE>m_strFilter = "sales &gt; 10 GROUP BY SALESPERSON_ID";
</CODE></PRE>

<P>You can limit the number of records you use to obtain aggregate results by filtering and sorting the columns. </P>

<P class=indent><B><B>Caution&nbsp;&nbsp;&nbsp;</B></B>Some aggregation operators return a different data type from the column(s) over which they are aggregating. 

<UL type=disc>
	<LI><B>SUM</B> and <B>AVG</B> may return the next larger data type (for example, calling with <B>int</B> returns <B>LONG</B> or <B>double</B>).<BR><BR></LI>

	<LI><B>COUNT</B> usually returns <B>LONG</B> regardless of target column type.<BR><BR></LI>

	<LI><B>MAX</B> and <B>MIN</B> return the same data type as the columns they calculate.</LI>
</UL>

<P class=indent>For example, ClassWizard creates <CODE>long</CODE> <CODE>m_lSales</CODE> to accommodate a Sales column, but you’ll need to replace this with a <CODE>double m_dblSumSales</CODE> data member to accommodate the aggregate result. See the example that follows.</P>

<P class=label><B><A NAME="_core_to_obtain_an_aggregate_result_for_a_recordset"></A>To obtain an aggregate result for a recordset</B>

<OL>
	<LI><A HREF="_core_classwizard.3a_.creating_a_recordset_class.htm">Create a recordset</A> containing the column(s) from which you want to obtain aggregate results.<BR><BR></LI>

	<LI>Modify the <A HREF="JavaScript:hhobj_3.Click()">DoFieldExchange</A> function for the recordset. Replace the string representing the column name (the second argument of the <A HREF="_core_record_field_exchange.3a_.using_rfx.htm">RFX</A> function call(s)) with a string representing the aggregation function on the column. For example, replace
<PRE><CODE>RFX_Long(pFX, "Sales", m_lSales);
</CODE></PRE>

<P class=tl>with</P>
<PRE><CODE>RFX_Double(pFX, "Sum(Sales)", m_dblSumSales)
</CODE></PRE>
</LI>

	<LI>Open the recordset. The result of the aggregation operation will be left in <CODE>m_dblSumSales</CODE>.</LI>
</OL>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>ClassWizard actually assigns data member names without Hungarian prefixes. For example, the wizard would produce <CODE>m_Sales</CODE> for a Sales column, rather than the <CODE>m_lSales</CODE> name used earlier for illustration.</P>

<P>If you’re using a <A HREF="JavaScript:hhobj_4.Click()">CRecordView</A> class to view the data, you’ll have to change the DDX function call to display the new data member value; in this case, changing it from</P>

<PRE><CODE>DDX_FieldText(pDX, IDC_SUMSALES, m_pSet-&gt;m_lSales, m_pSet);
</CODE></PRE>

<P>to</P>

<PRE><CODE>DDX_FieldText(pDX, IDC_SUMSALES, m_pSet-&gt;m_dblSumSales, m_pSet);
</CODE></PRE>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_recordset.3a_.how_recordsets_select_records_.28.odbc.29.htm">Recordset: How Recordsets Select Records (ODBC)</A> </P>
</font>
</BODY>
</HTML>
