<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ActiveX Controls: Adding Stock Methods to an ActiveX Control</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="circle sample start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleControl">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_activex_controls.3a_.adding_stock_methods_to_an_activex_control"></A>ActiveX Controls: Adding Stock Methods to an ActiveX Control</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_activex_controls.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_activex_control_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_frequently_asked_questions_about_activex_controls.htm">FAQ</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_activex_control_sample_list.htm">Sample</A></P>

<P>A stock method differs from a custom method in that it is already implemented by class <A HREF="JavaScript:hhobj_3.Click()">COleControl</A>. For example, <B>COleControl</B> contains a predefined member function supports the Refresh method for your control. The dispatch map entry for this stock method is <B>DISP_STOCKFUNC_REFRESH</B>. </P>

<P><B>COleControl</B> supports two stock methods: DoClick and Refresh. Refresh&nbsp; is invoked by the control’s user to immediately update the control’s appearance; DoClick is invoked to fire the control’s Click event.</P>

<TABLE border=1 cellpadding=5 cols=3 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=12%><B>Method</B></TD>
<TD class=label width=45%><B>Dispatch Map Entry</B></TD>
<TD class=label width=43%><B>Comment</B></TD>
</TR>

<TR VALIGN="top">
<TD width=12%><B>DoClick</B></TD>
<TD width=45%><B>DISP_STOCKPROP_DOCLICK( )</B></TD>
<TD width=43%>Fires a Click event.</TD>
</TR>

<TR VALIGN="top">
<TD width=12%><B>Refresh</B></TD>
<TD width=45%><B>DISP_STOCKPROP_REFRESH( )</B></TD>
<TD width=43%>Immediately updates the control’s appearance.</TD>
</TR>
</TABLE><BR>

<H2><A NAME="_core_adding_a_stock_method_using_classwizard"></A>Adding a Stock Method Using ClassWizard</H2>

<P>Adding a stock method is simple using ClassWizard. The following procedure demonstrates adding the Refresh method to a control created using ControlWizard.</P>

<P class=label><B>To add the stock Refresh method using ClassWizard</B>

<OL>
	<LI>Load your control’s project.<BR><BR></LI>

	<LI>On the <B>View </B>menu, click <B>ClassWizard</B>.<BR><BR></LI>

	<LI>Choose the <B>Automation</B> tab.<BR><BR></LI>

	<LI>Click the control class in the <B>Class name</B> box.<BR><BR></LI>

	<LI>Click <B>Add Method</B>.<BR><BR></LI>

	<LI>In the <B>External name</B> box, click <B>Refresh</B>.<BR><BR></LI>

	<LI>Click <B>OK</B>.<BR><BR></LI>

	<LI>Click <B>OK </B>to confirm your choices and close <B>ClassWizard</B>.</LI>
</OL>

<P>The following figure shows the Add Method dialog box of ClassWizard.</P>

<P class=label><B>The Add Method Dialog Box</B></P>

<P><IMG SRC="d07mthd.gif" ALT="" BORDER=0></P>



<H2><A NAME="_core_classwizard_changes_for_stock_methods"></A>ClassWizard Changes for Stock Methods</H2>

<P>Because the stock Refresh method is supported by the control’s base class, ClassWizard does not change the control’s class declaration in any way. It simply adds an entry for the method to the control’s dispatch map and to its .ODL file. The following line is added to the control’s dispatch map, located in its implementation (.CPP) file:</P>

<PRE><CODE>DISP_STOCKFUNC_REFRESH( )
</CODE></PRE>

<P>This makes the Refresh method available to the control’s users.</P>

<P>The following line is added to the control’s .ODL file:</P>

<P><CODE>[id(DISPID_REFRESH)] void Refresh();</CODE></P>

<P>This line assigns the Refresh method a specific ID number.</P>
</font>
</BODY>
</HTML>
