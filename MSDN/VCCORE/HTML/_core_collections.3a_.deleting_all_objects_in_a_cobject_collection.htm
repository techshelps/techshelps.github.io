<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Collections: Deleting All Objects in a CObject Collection</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_Sample_mfc_collect">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Scribble start">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_collections.3a_.deleting_all_objects_in_a_cobject_collection"></A>Collections: Deleting All Objects in a CObject Collection</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_collections.2c_.working_with_aggregate_data.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_collection_class_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_3.Click()">Tutorial</A></P>

<P>This article explains how to delete all objects in a collection (without deleting the collection object itself). </P>

<P>To delete all the objects in a collection of <B>CObject</B>s (or of objects derived from <B>CObject</B>), you use one of the iteration techniques described in the article <A HREF="_core_collections.3a_.accessing_all_members_of_a_collection.htm">Collections: Accessing All Members of a Collection</A> to delete each object in turn.</P>

<P class=indent><B><B>Caution&nbsp;&nbsp;&nbsp;</B></B>Objects in collections can be shared. That is, the collection keeps a pointer to the object, but other parts of the program may also have pointers to the same object. You must be careful not to delete an object that is shared until all the parts have finished using the object.</P>

<P>This article shows you how to delete the objects in:

<UL type=disc>
	<LI><A HREF="#_core_to_delete_all_objects_in_a_list_of_pointers_to_cobject">A list</A><BR><BR></LI>

	<LI><A HREF="#_core_to_delete_all_elements_in_an_array">An array</A><BR><BR></LI>

	<LI><A HREF="#_core_to_delete_all_elements_in_a_map">A map</A></LI>
</UL>

<P class=label><B><A NAME="_core_to_delete_all_objects_in_a_list_of_pointers_to_cobject"></A>To delete all objects in a list of pointers to CObject</B>

<OL>
	<LI>Use <B>GetHeadPosition</B> and <B>GetNext</B> to iterate through the list.<BR><BR></LI>

	<LI>Use the <B>delete</B> operator to delete each object as it is encountered in the iteration.<BR><BR></LI>

	<LI>Call the <B>RemoveAll</B> function to remove all elements from the list after the objects associated with those elements have been deleted.</LI>
</OL>

<P>The following example shows how to delete all objects from a list of <CODE>CPerson</CODE> objects. Each object in the list is a pointer to a <CODE>CPerson</CODE> object that was originally allocated on the heap.</P>

<PRE><CODE>CTypedPtrList&lt;CObList, CPerson*&gt; myList;
POSITION pos = myList.GetHeadPosition();

while( pos != NULL )
{
    delete myList.GetNext( pos );
}
myList.RemoveAll();
</CODE></PRE>

<P>The last function call, <B>RemoveAll</B>, is a list member function that removes all elements from the list. The member function <B>RemoveAt</B> removes a single element.</P>

<P>Notice the difference between deleting an element’s object and removing the element itself. Removing an element from the list merely removes the list’s reference to the object. The object still exists in memory. When you delete an object, it ceases to exist and its memory is reclaimed. Thus, it is important to remove an element immediately after the element’s object has been deleted so that the list won’t try to access objects that no longer exist.</P>

<P class=label><B><A NAME="_core_to_delete_all_elements_in_an_array"></A>To delete all elements in an array</B>

<OL>
	<LI>Use <B>GetSize</B> and integer index values to iterate through the array.<BR><BR></LI>

	<LI>Use the <B>delete</B> operator to delete each element as it is encountered in the iteration.<BR><BR></LI>

	<LI>Call the <B>RemoveAll</B> function to remove all elements from the array after they have been deleted.
<P class=tl>The code for deleting all elements of an array is as follows:</P>
<PRE><CODE>CArray&lt;CPerson*, CPerson*&gt; myArray;

int i = 0;
while (i &lt; myArray.GetSize() )
{
    delete myArray.GetAt( i++ );
}

myArray.RemoveAll();
</CODE></PRE>
</LI>
</OL>

<P>As with the list example above, you can call <B>RemoveAll</B> to remove all elements in an array or <B>RemoveAt</B> to remove an individual element.</P>

<P class=label><B><A NAME="_core_to_delete_all_elements_in_a_map"></A>To delete all elements in a map</B>

<OL>
	<LI>Use <B>GetStartPosition</B> and <B>GetNextAssoc</B> to iterate through the array.<BR><BR></LI>

	<LI>Use the <B>delete</B> operator to delete the key and/or value for each map element as it is encountered in the iteration.<BR><BR></LI>

	<LI>Call the <B>RemoveAll</B> function to remove all elements from the map after they have been deleted.
<P class=tl>The code for deleting all elements of a <B>CMap</B> collection is as follows. Each element in the map has a string as the key and a <CODE>CPerson</CODE> object (derived from <B>CObject</B>) as the value.</P>
<PRE><CODE>CMap&lt;CString, LPCSTR, CPerson*, CPerson*&gt; myMap;
// ... Add some key-value elements ...
// Now delete the elements
POSITION pos = myMap.GetStartPosition();
while( pos != NULL )
{
    CPerson* pPerson;
    CString string;
    // Gets key (string) and value (pPerson)
    myMap.GetNextAssoc( pos, string, pPerson );
    delete pPerson;
}
// RemoveAll deletes the keys
myMap.RemoveAll();
</CODE></PRE>
</LI>
</OL>

<P>You can call <B>RemoveAll</B> to remove all elements in a map or <B>RemoveKey</B> to remove an individual element with the specified key. </P>
</font>
</BODY>
</HTML>
