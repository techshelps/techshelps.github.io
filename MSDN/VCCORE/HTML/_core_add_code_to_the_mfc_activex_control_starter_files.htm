<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Add Code to the MFC ActiveX Control Starter Files</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_begin_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="MFC Samples">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_add_code_to_the_mfc_activex_control_starter_files"></A>Add Code to the MFC ActiveX Control Starter Files</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_overview.3a_.creating_an_mfc_activex_control_program.htm">Overview</A>  |&nbsp; <A HREF="_core_details.3a_.beginning_your_program.htm">Details</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Sample</A></P>

<P>After using the MFC ActiveX ControlWizard to create an ActiveX (formerly OLE) Control project, you get a working starter program with whatever functionality you asked for when completing the steps in the ControlWizard.</P>

<P>This starter program includes all the files necessary to build the control, including source (.CPP) and header files (.H), resource files (.RC), a module-definition file (.DEF), a project file (.DSP), an object description language file (.ODL), and so on. These files are compatible with ClassWizard, and you can then use ClassWizard to define the control’s events, properties, and methods, some of which have been already implemented in MFC.</P>

<P>Your project files contain a large amount of built-in functionality. This functionality includes code to draw the control, serialize data, and define dispatch, event, and message maps that you expand later in the development cycle.</P>

<P>Your final step is to supply the application-specific source code and connect the control to a parent program by defining what messages and commands the starter files should respond to. If you don’t already have a parent application, you can <A HREF="_core_overview.3a_.creating_an_activex_control_container.htm">create an ActiveX control container using AppWizard</A>.</P>

<P class=indent>If you selected the comments option when creating your program, the newly created starter files will display comments in green when viewed in the project workspace. The comments indicate where to add your source code, and help define the class behaviors for your specific control.</P>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;In the source code look for the comment: <CODE>// TODO: </CODE>, which is followed by an explanation of what to do. The comments also explain where not to edit specific blocks of code.</P>

<H3>Example of where to add your code</H3>

<PRE><CODE>CTestControl::CTestControl()
{
   InitializeIIDs(&amp;IID_DTest, &amp;IID_DTestEvents);
   //TODO: Initialize your control's instance data here.
}

CTestControl::~CTestControl()
{
   //TODO: Cleanup your control's instance data here.
}</CODE></PRE>

<H3>What do you want to know more about?</H3>

<UL type=disc>
	<LI><A HREF="_core_overview.3a_.creating_an_activex_control_container.htm">Creating an ActiveX Container program</A><BR><BR></LI>

	<LI><A HREF="_core_build_settings_generated_when_you_create_a_visual_c.2b2b_.program.htm">Build settings generated when you create a new program</A><BR><BR></LI>

	<LI><A HREF="_core_file_types_created_for_visual_c.2b2b_.projects.htm">Files created when you create a new program</A><BR><BR></LI>

	<LI><A HREF="_core_updating_dependencies_in_a_project.htm">Updating Dependencies in a Project</A></LI>
</UL>
</font>
</BODY>
</HTML>
