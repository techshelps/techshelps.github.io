<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO Queries</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef.3a3a.Execute">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Open">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_queries"></A>DAO Queries</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains what a query is and how to create and run one using the MFC DAO classes. Topics include:

<UL type=disc>
	<LI><A HREF="#_core_query.3a_.definition">Query: definition</A><BR><BR></LI>

	<LI><A HREF="#_core_querydefs_and_recordsets">Querydefs and recordsets</A><BR><BR></LI>

	<LI><A HREF="#_core_creating_a_query_with_a_querydef">Creating a query with a querydef</A><BR><BR></LI>

	<LI><A HREF="#_core_creating_a_query_with_a_recordset">Creating a query with a recordset</A></LI>
</UL>

<H2><A NAME="_core_query.3a_.definition"></A>Query: Definition</H2>

<P>A query is a formalized instruction to a database to either return a set of records or perform a specified action on a set of records as specified in the query. For example, the following SQL query statement returns records: </P>

<PRE><CODE>SELECT [Company Name] FROM Publishers WHERE State = "NY"
</CODE></PRE>

<P>You can create and run select, action, crosstab, parameter, and other queries using the MFC DAO classes. Queries are expressed with Structured Query Language (SQL) statements like the one shown above. The most common query type is the <B>SELECT</B> query. For a list of other query types, see the topic "Type Property" in DAO Help, under Settings and Return Values listed for querydef objects.</P>

<H3><A NAME="_core_how_to_write_sql_statements"></A>How to Write SQL Statements</H3>

<P>For general information on writing SQL queries, see the following topics in DAO Help:

<UL type=disc>
	<LI>Querying a Database with SQL in Code<BR><BR></LI>

	<LI>Building SQL Statements in Code</LI>
</UL>



<H3><A NAME="_core_syntax_of_sql_used_with_dao"></A>Syntax of SQL Used with DAO</H3>

<P>For a description of the SQL syntax used by DAO, see the topic "Comparison of Microsoft Jet Database Engine SQL and ANSI SQL" in DAO Help. For SQL syntax specific to your target database, see the documentation for your DBMS. For a list of additional topics on SQL in DAO Help, see the article <A HREF="_core_dao_queries.3a_.sql_for_dao.htm">DAO Queries: SQL for DAO</A>.</P>



<H2><A NAME="_core_querydefs_and_recordsets"></A>Querydefs and Recordsets</H2>

<P>You can work with queries in two ways:

<UL type=disc>
	<LI>Use a DAO querydef object&nbsp;? the corresponding MFC object is represented by class <A HREF="JavaScript:hhobj_3.Click()">CDaoQueryDef</A>.<BR><BR></LI>

	<LI>Use a DAO recordset object&nbsp;? the corresponding MFC object is represented by class <A HREF="JavaScript:hhobj_4.Click()">CDaoRecordset</A>.</LI>
</UL>

<P>A querydef is a query definition, which you can optionally save as a persistent object in the database. A recordset is an object that represents and gives access to a set of records returned by a query.</P>

<H2><A NAME="_core_creating_a_query_with_a_querydef"></A>Creating a Query with a Querydef</H2>

<P>Once you create a querydef object, based on <A HREF="JavaScript:hhobj_5.Click()">CDaoQueryDef</A>, you can do the following with it:

<UL type=disc>
	<LI>Save the querydef object in the database, which lets you run its query again later.<BR><BR></LI>

	<LI>Create parameters for the querydef, so you can run parameterized queries with it.<BR><BR></LI>

	<LI>Create a recordset based on the querydef.<BR><BR></LI>

	<LI>Use the querydef's <A HREF="JavaScript:hhobj_6.Click()">Execute</A> member function to directly execute a query that doesn't return records, such as an action query or a SQL pass-through query.</LI>
</UL>

<P class=label><B>To create a querydef</B>

<UL type=disc>
	<LI>See the detailed instructions in the article <A HREF="_core_dao_querydef.3a_.using_querydefs.htm">DAO Querydef: Using Querydefs</A>.</LI>
</UL>

<H2><A NAME="_core_creating_a_query_with_a_recordset"></A>Creating a Query with a Recordset</H2>

<P>You can create a query with a recordset, represented by <A HREF="JavaScript:hhobj_7.Click()">CDaoRecordset</A>, in one of three ways:

<UL type=disc>
	<LI>First create or open a <A HREF="JavaScript:hhobj_8.Click()">CDaoQueryDef</A> object; then base a <B>CDaoRecordset</B> object on it, using the version of <A HREF="JavaScript:hhobj_9.Click()">CDaoRecordset::Open</A> that takes a pointer to a <B>CDaoQueryDef</B> object.<BR><BR></LI>

	<LI>First create or open a <A HREF="JavaScript:hhobj_10.Click()">CDaoTableDef</A> object, then base a <A HREF="JavaScript:hhobj_11.Click()">CDaoRecordset</A> object on it, using the version of <A HREF="JavaScript:hhobj_12.Click()">CDaoRecordset::Open</A> that takes a pointer to a <B>CDaoTableDef</B> object.<BR><BR></LI>

	<LI>Create a recordset, usually based on a class that you derive from <B>CDaoRecordset</B> using AppWizard or ClassWizard, and open the recordset. No querydef is required.</LI>
</UL>

<P class=label><B>To create a recordset with or without a querydef or tabledef</B>

<UL type=disc>
	<LI>See the article <A HREF="_core_dao_recordset.3a_.creating_recordsets.htm">DAO Recordset: Creating Recordsets</A>.</LI>
</UL>

<P>You’ll most likely base your recordsets on querydefs when you have a saved querydef for a query that you run frequently, or when you have just created a querydef that you plan to save in the database for later reuse. Or you’ll base recordsets on tabledefs when you have a tabledef and want to work with the data in the table that the tabledef represents. Otherwise, you’ll simply create a recordset (without a querydef) whenever you need one.</P>

<P>For related information, see the following topics in DAO Help:

<UL type=disc>
	<LI>QueryDef Object<BR><BR></LI>

	<LI>Recordset Object<BR><BR></LI>

	<LI>CreateQueryDef Method</LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao_querydef.htm">DAO Querydef</A>, <A HREF="_core_dao_recordset.htm">DAO Recordset</A></P>
</font>
</BODY>
</HTML>
