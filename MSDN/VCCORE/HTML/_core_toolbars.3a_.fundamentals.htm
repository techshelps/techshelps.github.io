<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Toolbars: Fundamentals</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_gs_edit_scribble.27.s_toolbar">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CToolBar">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CWnd.3a3a.OnCreate">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CToolBar.3a3a.Create">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CToolBarCtrl">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CToolBar.3a3a.LoadToolBar">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_DOCKTOOL">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_core_Toolbars.2c_.Status_Bars.2c_.Dialog_Bars.2c_.and_Floating_Palettes_Samples">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="toolbar editor">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CToolBar">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CToolBar.3a3a.LoadToolBar">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CToolBar.3a3a.LoadBitmap">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CToolBar.3a3a.SetButtons">
</OBJECT>
<OBJECT ID="hhobj_15" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="toolbar editor">
</OBJECT>
<OBJECT ID="hhobj_16" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CToolBar.3a3a.LoadToolbar">
</OBJECT>
<OBJECT ID="hhobj_17" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CToolBar">
</OBJECT>
<OBJECT ID="hhobj_18" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CToolBar">
</OBJECT>
<OBJECT ID="hhobj_19" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CToolBarCtrl">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_toolbars.3a_.fundamentals"></A>Toolbars: Fundamentals</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_toolbars.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_toolbar_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_toolbar_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A></P>

<P>This article describes the fundamental MFC implementation that lets you add a default toolbar to your application by selecting an option in AppWizard. Topics covered include:

<UL type=disc>
	<LI>AppWizard toolbar option<BR><BR></LI>

	<LI><A HREF="#_core_the_toolbar_in_code">The toolbar in code</A><BR><BR></LI>

	<LI><A HREF="#_core_editing_the_toolbar_resource">Editing the toolbar resource</A><BR><BR></LI>

	<LI><A HREF="#_core_multiple_toolbars">Multiple toolbars</A></LI>
</UL>



<H2><A NAME="_core_the_appwizard_toolbar_option"></A>The AppWizard Toolbar Option</H2>

<P>To get a single toolbar with default buttons, select the Dockable Toolbar option on the page labeled AppWizard Step 4 of 6. This adds code to your application that:

<UL type=disc>
	<LI>Creates the toolbar object.<BR><BR></LI>

	<LI>Manages the toolbar, including its ability to dock or to float.</LI>
</UL>



<H2><A NAME="_core_the_toolbar_in_code"></A>The Toolbar in Code</H2>

<P>The toolbar object is a <A HREF="JavaScript:hhobj_3.Click()">CToolBar</A> object declared as a data member of your application’s <B>CMainFrame</B> class. In other words, the toolbar object is embedded in the main frame window object. This means that MFC creates the toolbar when it creates the frame window and destroys the toolbar when it destroys the frame window. The following partial class declaration, for a multiple document interface (MDI) application, shows data members for an embedded toolbar and an embedded status bar. It also shows the override of the <B>OnCreate</B> member function.</P>

<PRE><CODE>class CMainFrame : public CMDIFrameWnd
{
   // ...

// Implementation
   // ...

protected:  // control bar embedded members
   CStatusBar  m_wndStatusBar;
   CToolBar    m_wndToolBar;

// Generated message map functions
protected:
   //{{AFX_MSG(CMainFrame)
   afx_msg int OnCreate(LPCREATESTRUCT lpCreateStruct);
      // NOTE - the ClassWizard will add and remove member functions here.
      // DO NOT EDIT what you see in these blocks of 
      // generated code!
   //}}AFX_MSG
   DECLARE_MESSAGE_MAP()
};
</CODE></PRE>

<P>Toolbar creation occurs in <B>CMainFrame::OnCreate</B>. MFC calls <A HREF="JavaScript:hhobj_4.Click()">OnCreate</A> after creating the Windows window for the frame but before the frame window becomes visible. The default <B>OnCreate</B> that AppWizard generates does the following toolbar tasks:

<OL>
	<LI>Calls the <B>CToolBar</B> object’s <A HREF="JavaScript:hhobj_5.Click()">Create</A> member function to create the underlying <A HREF="JavaScript:hhobj_6.Click()">CToolBarCtrl</A> object.<BR><BR></LI>

	<LI>Calls <A HREF="JavaScript:hhobj_7.Click()">LoadToolBar</A> to load the toolbar resource information.<BR><BR></LI>

	<LI>Calls functions to enable docking, floating, and tool tips. For details about these calls, see the article <A HREF="_core_toolbars.3a_.docking_and_floating.htm">Toolbars: Docking and Floating</A>.</LI>
</OL>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;The MFC General sample <A HREF="JavaScript:hhobj_8.Click()">DOCKTOOL</A> includes illustrations of both old and new MFC toolbars. The toolbars that use <B>COldToolbar</B> require calls in step 2 to <B>LoadBitmap</B> (rather than <B>LoadToolBar</B>) and to <B>SetButtons</B>. The new toolbars require calls to <B>LoadToolBar</B>. Click for a list of <A HREF="JavaScript:hhobj_9.Click()">MFC samples related to toolbars</A>. </P>

<P>The docking, floating, and tool tips calls are optional. You can remove those lines from <B>OnCreate</B> if you prefer. The result is a toolbar that remains fixed, unable to float or redock and unable to display tool tips.</P>



<H2><A NAME="_core_editing_the_toolbar_resource"></A>Editing the Toolbar Resource</H2>

<P>The default toolbar you get with AppWizard is based on an <B>RT_TOOLBAR</B> custom resource, introduced in MFC version 4.0. You can edit this resource with the <A HREF="JavaScript:hhobj_10.Click()">toolbar editor</A>. The editor lets you easily add, delete, and rearrange buttons. It contains a graphical editor for the buttons that is very similar to the general graphics editor in Visual C++. If you edited toolbars in previous versions of Visual C++, you’ll find the task much easier now. </P>

<P>To connect a toolbar button to a command, you give the button a command ID, such as <CODE>ID_MYCOMMAND</CODE>. Specify the command ID in the button’s property page in the toolbar editor. Then use ClassWizard to create a handler function for the command. </P>

<P>New <A HREF="JavaScript:hhobj_11.Click()">CToolBar</A> member functions work with the <B>RT_TOOLBAR</B> resource. <A HREF="JavaScript:hhobj_12.Click()">LoadToolBar</A> now takes the place of <A HREF="JavaScript:hhobj_13.Click()">LoadBitmap</A> to load the bitmap of the toolbar button images, and <A HREF="JavaScript:hhobj_14.Click()">SetButtons</A> to set the button styles and connect buttons with bitmap images.</P>

<P>For details about the toolbar editor, see the <A HREF="JavaScript:hhobj_15.Click()">Toolbar Editor overview</A> in the <I>Visual C++ User’s Guide</I>.</P>



<H2><A NAME="_core_multiple_toolbars"></A>Multiple Toolbars</H2>

<P>AppWizard gives you one toolbar. If you want more, model your code for the additional toolbars on the code for the first one. </P>

<P>If you want to display a toolbar as the result of a command, you’ll need to:

<UL type=disc>
	<LI>Create a new toolbar resource with the toolbar editor and load it in <B>OnCreate</B> with the <A HREF="JavaScript:hhobj_16.Click()">LoadToolbar</A> member function.<BR><BR></LI>

	<LI>Embed a new <A HREF="JavaScript:hhobj_17.Click()">CToolBar</A> object in your main frame window class.<BR><BR></LI>

	<LI>Make the appropriate function calls in <B>OnCreate</B> to dock or float the toolbar, set its styles, and so on.</LI>
</UL>

<H3>What do you want to know more about?</H3>

<UL type=disc>
	<LI><A HREF="_core_toolbars.htm">General information about toolbars</A><BR><BR></LI>

	<LI><A HREF="_core_toolbars.3a_.docking_and_floating.htm">Docking and floating toolbars</A><BR><BR></LI>

	<LI><A HREF="_core_toolbars.3a_.tool_tips.htm">Toolbar tool tips</A><BR><BR></LI>

	<LI>The <A HREF="JavaScript:hhobj_18.Click()">CToolBar</A> and <A HREF="JavaScript:hhobj_19.Click()">CToolBarCtrl</A> classes<BR><BR></LI>

	<LI><A HREF="_core_toolbars.3a_.working_with_the_toolbar_control.htm">Working with the toolbar control</A><BR><BR></LI>

	<LI><A HREF="_core_toolbars.3a_.using_your_old_toolbars.htm">Using your old toolbars</A></LI>
</UL>
</font>
</BODY>
</HTML>
