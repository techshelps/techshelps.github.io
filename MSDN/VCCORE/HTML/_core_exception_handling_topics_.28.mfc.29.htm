<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Exception Handling Topics (MFC)</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CException">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CMemoryException">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CFileException">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CArchiveException">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CNotSupportedException">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CResourceException">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoException">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDBException">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleException">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleDispatchException">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CUserException">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CException">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_exception_handling_topics_.28.mfc.29"></A>Exception Handling Topics (MFC)</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_exception_handling.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_exception_handling_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_exception_handling.3a_.frequently_asked_questions.htm">FAQ</A></P>

<P>This article explains the exception-handling mechanisms available in MFC. Two mechanisms are available:

<UL type=disc>
	<LI>C++ exceptions, available in MFC version 3.0 and later<BR><BR></LI>

	<LI>The MFC exception macros, available in MFC versions 1.0 and later</LI>
</UL>

<P>If you’re writing a new application using MFC, you should use the C++ mechanism. You can use the macro-based mechanism if your existing application already uses that mechanism extensively.</P>

<P>You can readily convert existing code to use C++ exceptions instead of the MFC exception macros. Advantages of converting your code and guidelines for doing so are described in the article <A HREF="_core_exceptions.3a_.converting_from_mfc_exception_macros.htm">Exceptions: Converting from MFC Exception Macros</A>. </P>

<P>If you have already developed an application using the MFC exception macros, you can continue using these macros in your existing code, while using C++ exceptions in your new code. The article <A HREF="_core_exceptions.3a_.changes_to_exception_macros_in_version_3..0.htm">Exceptions: Changes to Exception Macros in Version 3.0</A> gives guidelines for doing so.</P>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;To enable C++ exception handling in your code, select Enable Exception Handling in the C++ Language category of the C/C++ tab of the Project Settings dialog box, or use the /GX compiler option. The default is /GX–, which disables exception handling.</P>

<P>This article covers the following topics:

<UL type=disc>
	<LI><A HREF="#_core_when_to_use_exceptions">When to use exceptions</A><BR><BR></LI>

	<LI><A HREF="#_core_mfc_exception_support">MFC exception support</A><BR><BR></LI>

	<LI><A HREF="#_core_further_reading_about_exceptions">Further reading about exceptions</A></LI>
</UL>



<H2><A NAME="_core_when_to_use_exceptions"></A>When to Use Exceptions</H2>

<P>Three categories of outcomes can occur when a function is called during program execution: normal execution, erroneous execution, or abnormal execution. Each category is described below.

<UL type=disc>
	<LI>Normal execution
<P class=tl>The function may execute normally and return. Some functions return a result code to the caller, which indicates the outcome of the function. The possible result codes are strictly defined for the function and represent the range of possible outcomes of the function. The result code can indicate success or failure or can even indicate a particular type of failure that is within the normal range of expectations. For example, a file-status function can return a code that indicates that the file does not exist. Note that the term “error code” is not used because a result code represents one of many expected outcomes.</P></LI>

	<LI>Erroneous execution
<P class=tl>The caller makes some mistake in passing arguments to the function or calls the function in an inappropriate context. This situation causes an error, and it should be detected by an assertion during program development. (For more information on assertions, see the article <A HREF="_core_the_assert_macro.htm">Diagnostics: The ASSERT Macro</A>.) </P></LI>

	<LI>Abnormal execution 
<P class=tl>Abnormal execution includes situations where conditions outside the program’s control, such as low memory or I/O errors, are influencing the outcome of the function. Abnormal situations should be handled by catching and throwing exceptions. </P></LI>
</UL>

<P>Using exceptions is especially appropriate for abnormal execution. </P>



<H2><A NAME="_core_mfc_exception_support"></A>MFC Exception Support</H2>

<P>Whether you use the C++ exceptions directly or use the MFC exception macros, you will use <A HREF="JavaScript:hhobj_2.Click()">CException</A> or <B>CException</B>-derived objects that may be thrown by the framework or by your application.</P>

<P>MFC provides several predefined kinds of exceptions:</P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=37%><B>Exception class</B></TD>
<TD class=label width=63%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><A HREF="JavaScript:hhobj_3.Click()">CMemoryException</A></TD>
<TD width=63%>Out-of-memory</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><A HREF="JavaScript:hhobj_4.Click()">CFileException</A></TD>
<TD width=63%>File exception</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><A HREF="JavaScript:hhobj_5.Click()">CArchiveException</A></TD>
<TD width=63%>Archive/Serialization exception</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><A HREF="JavaScript:hhobj_6.Click()">CNotSupportedException</A></TD>
<TD width=63%>Response to request for unsupported service</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><A HREF="JavaScript:hhobj_7.Click()">CResourceException</A></TD>
<TD width=63%>Windows resource allocation exception</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><A HREF="JavaScript:hhobj_8.Click()">CDaoException</A></TD>
<TD width=63%>Database exceptions (DAO classes)</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><A HREF="JavaScript:hhobj_9.Click()">CDBException</A></TD>
<TD width=63%>Database exceptions (ODBC classes)</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><A HREF="JavaScript:hhobj_10.Click()">COleException</A></TD>
<TD width=63%>OLE exceptions</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><A HREF="JavaScript:hhobj_11.Click()">COleDispatchException</A></TD>
<TD width=63%>Dispatch (automation) exceptions</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><A HREF="JavaScript:hhobj_12.Click()">CUserException</A></TD>
<TD width=63%>Exception that alerts the user with a message box, then throws a generic <A HREF="JavaScript:hhobj_13.Click()">CException</A></TD>
</TR>
</TABLE><BR>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;MFC supports both C++ exceptions and the MFC exception macros. MFC does not directly support Windows NT structured exception handlers (SEH), as discussed in <A HREF="_core_exception_handling_topics_.28.seh.29.htm">Exception Handling Topics (SEH)</A>.</P>



<H2><A NAME="_core_further_reading_about_exceptions"></A>Further Reading About Exceptions</H2>

<P>The following articles explain using the class library for exception handing:

<UL type=disc>
	<LI><A HREF="_core_exceptions.3a_.catching_and_deleting_exceptions.htm">Exceptions: Catching and Deleting Exceptions</A><BR><BR></LI>

	<LI><A HREF="_core_exceptions.3a_.examining_exception_contents.htm">Exceptions: Examining Exception Contents</A><BR><BR></LI>

	<LI><A HREF="_core_exceptions.3a_.freeing_objects_in_exceptions.htm">Exceptions: Freeing Objects in Exceptions</A><BR><BR></LI>

	<LI><A HREF="_core_exceptions.3a_.throwing_exceptions_from_your_own_functions.htm">Exceptions: Throwing Exceptions from Your Own Functions</A><BR><BR></LI>

	<LI><A HREF="_core_exceptions.3a_.database_exceptions.htm">Exceptions: Database Exceptions</A><BR><BR></LI>

	<LI><A HREF="_core_exceptions.3a_.ole_exceptions.htm">Exceptions: OLE Exceptions</A></LI>
</UL>

<P>The following articles compare the MFC exception macros with the C++ exception keywords and explain how you can adapt your code:

<UL type=disc>
	<LI><A HREF="_core_exceptions.3a_.changes_to_exception_macros_in_version_3..0.htm">Exceptions: Changes to Exception Macros in Version 3.0</A><BR><BR></LI>

	<LI><A HREF="_core_exceptions.3a_.converting_from_mfc_exception_macros.htm">Exceptions: Converting from MFC Exception Macros</A><BR><BR></LI>

	<LI><A HREF="_core_exceptions.3a_.using_mfc_macros_and_c.2b2b_.exceptions.htm">Exceptions: Using MFC Macros and C++ Exceptions</A></LI>
</UL>
</font>
</BODY>
</HTML>
