<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>The ON_UPDATE_COMMAND_UI Macro</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_the_on_update_command_ui_macro"></A>The ON_UPDATE_COMMAND_UI Macro</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_menus.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_menu_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_menu_sample_list.htm">Sample</A></P>

<P>Use ClassWizard to connect a user-interface object to a command-update handler in a command-target object. It will automatically connect the user-interface object’s ID to the <B>ON_UPDATE_COMMAND_UI</B> macro and create a handler in the object that will handle the update.</P>

<P>For example, the Scribble tutorial in <I>Tutorials</I> updates a Clear All command in its Edit menu. In the tutorial, ClassWizard adds a message-map entry in the chosen class, a function declaration for a command-update handler called <CODE>OnUpdateEditClearAll</CODE> in the class declaration, and an empty function template in the class’s implementation file. The function prototype looks like this:</P>

<PRE><CODE>afx_msg void OnUpdateEditClearAll( CCmdUI* pCmdUI );
</CODE></PRE>

<P>Like all handlers, the function shows the <B>afx_msg</B> keyword. Like all update handlers, it takes one argument, a pointer to a <B>CCmdUI</B> object.</P>
</font>
</BODY>
</HTML>
