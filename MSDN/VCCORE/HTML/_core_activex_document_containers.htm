<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Active Document Containers</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_activex_document_containers"></A>Active Document Containers</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_activex.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_activex_tasks.htm">How Do I</A></P>

<P>An active document container allows you to work with several documents of different application types within a single frame (instead of forcing you to create and use multiple application frames for each document type).</P>

<P>MFC provides full support for Active document containers in the <B>COleDocObjectItem</B> class. You can use the MFC AppWizard to create an Active document container by selecting the <B>Active document container</B> checkbox in step 3 of the MFC AppWizard. See <A HREF="_core_creating_a_docobject_container_application.htm">Creating an Active Document Container Application</A> for more information.</P>

<H3>What do you want to know more about?</H3>

<UL type=disc>
	<LI><A HREF="#container_requirements">Container Requirements</A><BR><BR></LI>

	<LI><A HREF="#document_site_objects">Document Site Objects</A><BR><BR></LI>

	<LI><A HREF="#view_site_objects">View Site Objects</A><BR><BR></LI>

	<LI><A HREF="#frame_object">Frame Object</A><BR><BR></LI>

	<LI><A HREF="_core_help_menu_merging.htm">Help Menu Merging</A><BR><BR></LI>

	<LI><A HREF="_core_programmatic_printing.htm">Programmatic Printing</A><BR><BR></LI>

	<LI><A HREF="vcconcommandtargets.htm">Command Targets</A></LI>
</UL>

<H3><A NAME="container_requirements"></A>Container Requirements</H3>

<P>Active document support in an Active document container implies more than just interface implementations: it also requires knowledge of using the interfaces of a contained object. The same applies to Active document extensions, where the container must also know how to use those extension interfaces on the Active documents themselves.</P>

<P>An active document container that integrates Active documents must:

<UL type=disc>
	<LI>Be capable of handling object storage through the <B>IPersistStorage </B>interface, that is, it must provide an <B>IStorage</B> instance to each Active document.<BR><BR></LI>

	<LI>Support the basic embedding features of OLE Documents, necessitating “site” objects (one per document or embedding) that implement <B>IOleClientSite </B>and <B>IAdviseSink</B>.<BR><BR></LI>

	<LI>Support in-place activation of embedded objects or Active documents. The container’s site objects must implement <B>IOleInPlaceSite</B> and the container’s frame object must provide <B>IOleInPlaceFrame</B>.<BR><BR></LI>

	<LI>Support the Active documents' extensions by implementing <B>IOleDocumentSite</B> to provide the mechanism for the container to talk to the document. Optionally, the container can implement the Active document interfaces <B>IOleCommandTarget</B> and <B>IContinueCallback</B> to pick up simple commands such as printing or saving.</LI>
</UL>

<P>The frame object, the view objects, and the container object can optionally implement <B>IOleCommandTarget </B>to support the dispatch of certain commands, as discussed in <A HREF="vcconcommandtargets.htm">Command Targets</A>. View and container objects can also optionally implement <B>IPrint</B> and <B>IContinueCallback</B>, to support programmatic printing, as discussed in <A HREF="_core_programmatic_printing.htm">Programmatic Printing</A>.</P>

<P>The following figure shows the conceptual relationships between a container and its components (at left), and the Active document and its views (at right). The Active document manages storage and data, and the view displays or optionally prints that data. Interfaces in bold are those required for Active document participation; those bold and italic are optional. All other interfaces are required.</P>

<P><IMG SRC="vc37gj1.gif" ALT="" BORDER=0></P>

<P>A document that supports only a single view can implement both the view and document components (that is, their corresponding interfaces) on a single concrete class. In addition, a container site that only supports one view at a time can combine the document site and the view site into a single concrete site class. The container’s frame object, however, must remain distinct, and the container’s document component is merely included here to give a complete picture of the architecture; it is not affected by the Active document containment architecture.</P>

<H3><A NAME="document_site_objects"></A>Document Site Objects</H3>

<P>In the Active document containment architecture, a document site is the same as a client site object in OLE Documents with the addition of the <B>IOleDocument</B> interface:</P>

<PRE><CODE>interface IOleDocumentSite : IUnknown
    {
    HRESULT ActivateMe(IOleDocumentView *pViewToActivate);
    }
</CODE></PRE>

<P>The document site is conceptually the container for one or more “view site” objects. Each view site object is associated with individual view objects of the document managed by the document site. If the container only supports a single view per document site, then it can implement the document site and the view site with a single concrete class.</P>

<H3><A NAME="view_site_objects"></A>View Site Objects</H3>

<P>A container’s view site object manages the display space for a particular view of a document. In addition to supporting the standard <B>IOleInPlaceSite</B> interface, a view site also generally implements <B>IContinueCallback</B> for programmatic printing control. (Note that the view object never queries for <B>IContinueCallback</B> so it can actually be implemented on any object the container desires.)</P>

<P>A container that supports multiple views must be able to create multiple view site objects within the document site. This provides each view with separate activation and deactivation services as provided through <B>IOleInPlaceSite</B>.</P>

<H3><A NAME="frame_object"></A>Frame Object</H3>

<P>The container’s frame object is, for the most part, the same frame that is used for in-place activation in OLE Documents, that is, the one that handles menu and toolbar negotiation. A view object has access to this frame object through <B>IOleInPlaceSite::GetWindowContext</B>, which also provides access to the container object representing the container document (which can handle pane-level toolbar negotiation and contained object enumeration).</P>

<P>An Active document container can augment the frame by adding <B>IOleCommandTarget</B>. This allows it to receive commands that originate in the Active document’s user interface in the same way that this interface can allow a container to send the same commands (such as <B>File New</B>, <B>Open</B>, <B>Save As</B>, <B>Print</B>; <B>Edit Copy</B>, <B>Paste</B>, <B>Undo</B>, etc.) to an active document. For more information, see <A HREF="vcconcommandtargets.htm">Command Targets</A>.</P>
</font>
</BODY>
</HTML>
