<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Drag and Drop: Customizing</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_COleDropSource">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_COleDataSource">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_drag_and_drop.3a_.customizing"></A>Drag and Drop: Customizing</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_ole_in_mfc.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_ole_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_ole_sample_list.htm">Sample</A>  |&nbsp; <A HREF="_core_ole_tutorial_list.htm">Tutorial</A></P>

<P>The default implementation of the drag-and-drop feature is sufficient for most applications. However, some applications may require that this standard behavior be changed. This article explains the steps necessary to change these defaults. In addition, you can use this technique to establish applications that do not support compound documents as drop sources.</P>

<P>If you are customizing standard OLE drag-and-drop behavior, or you have a non-OLE application, you must create a <B>COleDataSource</B> object to contain the data. When the user starts a drag-and-drop operation, your code should call the <B>DoDragDrop</B> function from this object instead of from other classes that support drag-and-drop operations.</P>

<P>Optionally, you can create a <B>COleDropSource</B> object to control the drop and override some of its functions depending on the type of behavior you want to change. This drop-source object is then passed to <B>COleDataSource::DoDragDrop</B> to change the default behavior of these functions. These different options allow a great deal of flexibility in how you support drag-and-drop operations in your application. For more information about data sources, see the article <A HREF="_core_data_objects_and_data_sources_.28.ole.29.htm">Data Objects and Data Sources (OLE)</A>. </P>

<P>You can override the following functions to customize drag-and-drop operations:</P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=31%><B>Override</B></TD>
<TD class=label width=69%><B>To customize</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>OnBeginDrag</B></TD>
<TD width=69%>How dragging is initiated after you call <B>DoDragDrop</B>.</TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>GiveFeedback</B></TD>
<TD width=69%>Visual feedback, such as cursor appearance, for different drop results.</TD>
</TR>

<TR VALIGN="top">
<TD width=31%><B>QueryContinueDrag</B></TD>
<TD width=69%>The termination of a drag-and-drop operation. This function enables you to check modifier key states during the drag operation.</TD>
</TR>
</TABLE><BR>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="JavaScript:hhobj_2.Click()">COleDropSource</A>, <A HREF="JavaScript:hhobj_3.Click()">COleDataSource</A></P>
</font>
</BODY>
</HTML>
