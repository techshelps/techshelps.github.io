<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Recordset: Filtering Records (ODBC)</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.m_strFilter">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_recordset.3a_.filtering_records_.28.odbc.29"></A>Recordset: Filtering Records (ODBC)</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article applies to the MFC ODBC classes. For DAO recordsets, see the article <A HREF="_core_dao_recordset.htm">DAO Recordset</A>.</P>

<P>This article explains how to filter a recordset so that it selects only a particular subset of the available records. For example, you might want to select only the class sections for a particular course, such as MATH101. A filter is a search condition defined by the contents of an SQL <B>WHERE</B> clause. When the framework appends it to the recordset’s SQL statement, the <B>WHERE</B> clause constrains the selection. </P>

<P>You must establish a recordset object’s filter after you construct the object but before you call its <B>Open</B> member function (or before you call the <B>Requery</B> member function for an existing recordset object whose <B>Open</B> member function has been called previously). </P>

<P class=label><B><A NAME="_core_to_specify_a_filter_for_a_recordset_object"></A>To specify a filter for a recordset object</B>

<OL>
	<LI>Construct a new recordset object (or prepare to call <B>Requery</B> for an existing object).<BR><BR></LI>

	<LI>Set the value of the object’s <A HREF="JavaScript:hhobj_3.Click()">m_strFilter</A> data member.
<P class=tl>The filter is a null-terminated string. It contains the contents of the SQL <B>WHERE</B> clause but not the keyword <B>WHERE</B>. For example, use</P>
<PRE><CODE>m_pSet-&gt;m_strFilter = "CourseID = 'MATH101'";
</CODE></PRE>

<P class=tl>not</P>
<PRE><CODE>m_pSet-&gt;m_strFilter = "WHERE CourseID = 'MATH101'";
</CODE></PRE>

<P class=atl><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>The literal string “MATH101” is shown with single quotation marks above. In the ODBC SQL specification, single quotes are used to denote a character string literal. Check your ODBC driver documentation for the quoting requirements of your DBMS in this situation. This syntax is also discussed further near the end of this article.</p></LI>

	<LI>Set any other options you need, such as sort order, locking mode, or parameters. Specifying a parameter is especially useful. For information on parameterizing your filter, see the article <A HREF="_core_recordset.3a_.parameterizing_a_recordset_.28.odbc.29.htm">Recordset: Parameterizing a Recordset (ODBC)</A>. <BR><BR></LI>

	<LI>Call <B>Open</B> for the new object (or <B>Requery</B> for a previously opened object).</LI>
</OL>

<P class=indent><B><B>Tip</B></B>&nbsp;&nbsp;&nbsp;Using parameters in your filter is potentially the most efficient method for retrieving records.</P>

<P class=indent><B><B>Tip</B></B>&nbsp;&nbsp;&nbsp;Recordset filters are useful for <A HREF="_core_recordset.3a_.performing_a_join_.28.odbc.29.htm">joining</A> tables and for using <A HREF="_core_recordset.3a_.parameterizing_a_recordset_.28.odbc.29.htm">parameters</A> based on information obtained or calculated at run time.</P>

<P>The recordset selects only those records that meet the search condition you specified. For example, to specify the course filter described above (assuming a variable <CODE>strCourseID</CODE> currently set, for instance, to “MATH101”), do the following:</P>

<PRE><CODE>// Using the recordset pointed to by m_pSet

// Set the filter
m_pSet-&gt;m_strFilter = "CourseID = " + strCourseID; 

// Run the query with the filter in place
if ( m_pSet-&gt;Open( CRecordset::snapshot, NULL, CRecordset::readOnly ) )

// Use the recordset
</CODE></PRE>

<P>The recordset contains records for all class sections for MATH101.</P>

<P>Notice how the filter string was set in the example above, using a string variable. This is the typical usage. But suppose you wanted to specify the literal value 100 for the course ID. The following code shows how to set the filter string correctly with a literal value:</P>

<PRE><CODE>m_strFilter = "StudentID = '100'";   // correct
</CODE></PRE>

<P>Note the use of single quote characters; if you set the filter string directly, the filter string is <B>not</B>:</P>

<PRE><CODE>m_strFilter = "StudentID = 100";   // incorrect for some drivers
</CODE></PRE>

<P>The quoting shown above conforms to the ODBC specification, but some DBMSs may require other quote characters. For more information, see the article <A HREF="_core_sql.3a_.customizing_your_recordset.92.s_sql_statement_.28.odbc.29.htm">SQL: Customizing Your Recordset’s SQL Statement (ODBC)</A>. </P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>If you choose to override the recordset’s default SQL string by passing your own SQL string to <B>Open</B>, you should not set a filter if your custom string has a <B>WHERE</B> clause. For more information about overriding the default SQL, see the article <A HREF="_core_sql.3a_.customizing_your_recordset.92.s_sql_statement_.28.odbc.29.htm">SQL: Customizing Your Recordset’s SQL Statement (ODBC)</A>. </P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_recordset.3a_.sorting_records_.28.odbc.29.htm">Recordset: Sorting Records (ODBC)</A>, <A HREF="_core_recordset.3a_.how_recordsets_select_records_.28.odbc.29.htm">Recordset: How Recordsets Select Records (ODBC)</A>, <A HREF="_core_recordset.3a_.how_recordsets_update_records_.28.odbc.29.htm">Recordset: How Recordsets Update Records (ODBC)</A>, <A HREF="_core_recordset.3a_.locking_records_.28.odbc.29.htm">Recordset: Locking Records (ODBC)</A> </P>
</font>
</BODY>
</HTML>
