<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Common Controls in a Dialog Box</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="MFC Samples">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDialog.3a3a.OnInitDialog">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_using_common_controls_in_a_dialog_box"></A>Using Common Controls in a Dialog Box</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Sample</A></P>

<P>The Windows common controls can be used in <A HREF="_core_dialog_boxes.3a_.overview.htm">dialog boxes</A>, form views, record views, and any other window based on a dialog template. The following procedure, with minor changes, will work for forms as well.</P>

<P class=label><B>To use a common control in a dialog box</B>

<OL>
	<LI>Place the control on the dialog template <A HREF="_core_using_the_dialog_editor_to_add_controls.htm">using the dialog editor</A>.<BR><BR></LI>

	<LI>Add to the dialog class a member variable that represents the control. In the <B>Add Member Variable</B> dialog box, select <B>Control</B> in the <B>Category </B>drop-down list.<BR><BR></LI>

	<LI>If this common control is providing input to the program, declare additional member variable(s) in the dialog class to handle those input values.
<P class=atl><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;ClassWizard will not support adding these member variables. You need to add them using the context menu in <A HREF="_core_using_classview.htm">ClassView</A>.</p></LI>

	<LI>In <A HREF="JavaScript:hhobj_3.Click()">OnInitDialog</A> for your dialog class, set the initial conditions for the common control. Using the member variable created in the previous step, use the member functions to set initial value and other settings. See the following descriptions of the controls for details on settings.
<P class=tl>You can also use <A HREF="_core_dialog_data_exchange_and_validation.htm">dialog data exchange</A> (DDX) to initialize controls in a dialog box.</P></LI>

	<LI>In handlers for controls on the dialog box, use the member variable to manipulate the control. See the following descriptions of the controls for details on methods.
<P class=atl><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;The member variable will exist only as long as the dialog box itself exists. You will not be able to query the control for input values after the dialog box has been closed. To work with input values from a common control, override <B>OnOK</B> in your dialog class. In your override, query the control for input values and store those values in member variables of the dialog class.</p>
<P class=atl>You can also use dialog data exchange to set or retrieve values from the controls in a dialog box.</p></LI>
</OL>

<H3>What do you want to do?</H3>

<UL type=disc>
	<LI><A HREF="_core_adding_controls_by_hand.htm">Add controls to a dialog box by hand instead of with the dialog editor</A><BR><BR></LI>

	<LI><A HREF="_core_deriving_controls_from_a_standard_control.htm">Derive my control from one of the standard Windows common controls</A><BR><BR></LI>

	<LI><A HREF="_core_using_a_common_control_as_a_child_window.htm">Use a common control as a child window</A><BR><BR></LI>

	<LI><A HREF="_core_receiving_notification_from_common_controls.htm">Receive notification messages from a control</A><BR><BR></LI>

	<LI><A HREF="_core_dialog_data_exchange_and_validation.htm">Use dialog data exchange (DDX)</A></LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_control_topics.htm#_core_windows_common_controls_and_mfc_classes">Windows Common Controls and MFC Classes</A></P>
</font>
</BODY>
</HTML>
