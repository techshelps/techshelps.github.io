<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO: General Performance Tips</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Move">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Seek">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Find">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Seek">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Find">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao.3a_.general_performance_tips"></A>DAO: General Performance Tips</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article offers tips for improving the performance of your MFC DAO applications. Use these tips as your starting point, and benchmark your changes. Keep in mind that these tips will often help, but there are no absolutes. Weigh everything in the context of your database and your application. Topics covered include:

<UL type=disc>
	<LI><A HREF="#_core_tip_best_tip">Best tip</A><BR><BR></LI>

	<LI><A HREF="#_core_tip_recordset_types">Recordset types</A><BR><BR></LI>

	<LI><A HREF="#_core_tip_selecting_records">Selecting records</A><BR><BR></LI>

	<LI><A HREF="#_core_tip_odbc">ODBC</A><BR><BR></LI>

	<LI><A HREF="#_core_tip_caching_and_double_buffering">Caching and double buffering</A><BR><BR></LI>

	<LI><A HREF="#_core_tip_opening_databases">Opening databases</A><BR><BR></LI>

	<LI><A HREF="#_core_tip_attached_tables">Attached tables</A><BR><BR></LI>

	<LI><A HREF="#_core_tip_sql">SQL</A><BR><BR></LI>

	<LI><A HREF="#_core_tip_transactions">Transactions</A><BR><BR></LI>

	<LI><A HREF="#_core_tip_locating_records">Locating records</A><BR><BR></LI>

	<LI><A HREF="#_core_tip_other_tips">Other tips</A></LI>
</UL>

<P>How you improve performance in a database application depends on what kind of performance improvement you need. You might need some of the following kinds of performance improvements more than others:

<UL type=disc>
	<LI>Better query speed<BR><BR></LI>

	<LI>Faster record location<BR><BR></LI>

	<LI>Faster scrolling through records<BR><BR></LI>

	<LI>Up-to-date record content in multi-user environments<BR><BR></LI>

	<LI>Better performance with external databases, especially ODBC data sources</LI>
</UL>

<H2><A NAME="_core_tip_best_tip"></A>Best Tip</H2>

<P>The design of your data is usually a bigger factor in performance than the design of your code:

<UL type=disc>
	<LI>Use Microsoft Access to examine your database design, queries, and indexes. Run your queries in Access and use the results to adjust your table and index designs for better performance. Then save the queries in your database for use from your code.<BR><BR></LI>

	<LI>Normalize your database schema to avoid storing multiple copies of your data. Consult any standard database text, such as C.J. Date's <I>Introduction to Database Systems</I>, 10th edition (Addison-Wesley, 1995), or consult the Microsoft Access documentation.</LI>
</UL>

<P>Also:

<UL type=disc>
	<LI>Store infrequently updated tables in your local Microsoft Jet (.MDB) database. If the data doesn’t change often, you can keep a local copy for queries and avoid having to move the data across the network.</LI>
</UL>



<H2><A NAME="_core_tip_recordset_types"></A>Recordset Types</H2>

<UL type=disc>
	<LI>In general, use a table-type recordset rather than either a dynaset-type recordset or a snapshot-type recordset if possible.<BR><BR></LI>

	<LI>For remote data, use snapshot-type recordsets rather than dynaset-type recordsets. But beware of Memo fields, especially in ODBC data sources. If the data contains Memo fields, use a dynaset-type recordset instead if you won’t be retrieving all the fields from all the rows. Dynaset-type recordsets are also better for COM objects in ODBC data sources.<BR><BR></LI>

	<LI>For ODBC data with COM objects or Memo fields, use dynaset-type recordsets instead of snapshot-type recordsets.</LI>
</UL>



<H2><A NAME="_core_tip_selecting_records"></A>Selecting Records</H2>

<UL type=disc>
	<LI>For dynaset-type recordsets and snapshot-type recordsets, select only the fields you need instead of all fields.<BR><BR></LI>

	<LI>For snapshot-type recordsets against ODBC data sources, use the <B>dbForwardOnly</B> option in your recordsets if you’ll be making a single pass through your data. <BR><BR></LI>

	<LI>For dynaset-type recordsets against ODBC data sources, cache multiple records. See the article <A HREF="_core_dao_recordset.3a_.caching_multiple_records_for_performance.htm">DAO Recordset: Caching Multiple Records for Performance</A>.<BR><BR></LI>

	<LI>If you're adding records to a dynaset-type recordset, especially against an ODBC data source, use the <B>dbAppendOnly</B> option.<BR><BR></LI>

	<LI>Requery recordsets rather than reopening them. Note that you lose this advantage if you change filters or sorts before you requery.<BR><BR></LI>

	<LI>Parameterize queries instead of using dynamic SQL statements, especially against ODBC data sources.<BR><BR></LI>

	<LI>Store queries instead of using dynamic SQL statements, especially on machines with low memory.<BR><BR></LI>

	<LI>Refresh current field values by calling <A HREF="JavaScript:hhobj_3.Click()">Move</A> with a parameter of <B>AFX_MOVE_REFRESH</B> instead of calling <B>MoveNext</B> and <B>MovePrev</B>. (Calling <B>Move</B> with a parameter of 0 is equivalent.)</LI>
</UL>



<H2><A NAME="_core_tip_odbc"></A>ODBC</H2>

<UL type=disc>
	<LI>Attach ODBC tables to a local Microsoft Jet (.MDB) database rather than opening the ODBC data source directly.<BR><BR></LI>

	<LI>Reduce your ODBC timeouts for faster performance in failure cases.<BR><BR></LI>

	<LI>For ODBC data with COM objects or Memo fields, use dynaset-type recordsets instead of snapshot-type recordsets.<BR><BR></LI>

	<LI>For snapshot-type recordsets against ODBC data sources, use the <B>dbForwardOnly</B> option in your recordsets. <BR><BR></LI>

	<LI>For dynaset-type recordsets against ODBC data sources, cache multiple records. See the article <A HREF="_core_dao_recordset.3a_.caching_multiple_records_for_performance.htm">DAO Recordset: Caching Multiple Records for Performance</A>.<BR><BR></LI>

	<LI>With ODBC SQL statements that don’t retrieve data, use pass-through queries where possible. For related information, see the article <A HREF="_core_dao_querydef.3a_.action_queries_and_sql_pass.2d.through_queries.htm">DAO Querydef: Action Queries and SQL Pass-Through Queries</A>.<BR><BR></LI>

	<LI>Speed ODBC finds by downloading to a local indexed table and seeking. If you will be making numerous finds in the data, copy it to a local Microsoft Jet database table and use <A HREF="JavaScript:hhobj_4.Click()">Seek</A> to locate information.<BR><BR></LI>

	<LI>On ODBC data, use <A HREF="JavaScript:hhobj_5.Click()">Find</A> only on indexed fields; otherwise, open a new recordset using an SQL statement with an appropriate <B>WHERE</B> clause.</LI>
</UL>

<P>For more information about working with ODBC data sources, see the articles <A HREF="_core_database_topics_.28.dao.29.htm">Database Topics (DAO)</A> and <A HREF="_core_dao_external.3a_.working_with_external_data_sources.htm">DAO External: Working with External Data Sources</A>.</P>



<H2><A NAME="_core_tip_caching_and_double_buffering"></A>Caching and Double Buffering</H2>

<UL type=disc>
	<LI>For best performance, turn off MFC's double-buffering mechanism. However, the tradeoff is that you must write more code to update a field. For more information, see the article <A HREF="_core_dao_record_field_exchange.3a_.double_buffering_records.htm">DAO Record Field Exchange: Double Buffering Records</A>.<BR><BR></LI>

	<LI>Cache multiple records when you are using an ODBC data source. See the article <A HREF="_core_dao_recordset.3a_.caching_multiple_records_for_performance.htm">DAO Recordset: Caching Multiple Records for Performance</A>.<BR><BR></LI>

	<LI>Cache tabledef references if they will be used many times. Keep your <A HREF="JavaScript:hhobj_6.Click()">CDaoQueryDef</A> objects open and reuse them rather than recreating them.</LI>
</UL>



<H2><A NAME="_core_tip_opening_databases"></A>Opening Databases</H2>

<UL type=disc>
	<LI>Open databases for exclusive use if you are the only user. Open databases as read-only if all users will be read-only.<BR><BR></LI>

	<LI>Use the <B>dbDenyWrite</B> option if nobody else will be writing to the database.<BR><BR></LI>

	<LI>Retrieve data from ODBC databases by attaching to a Microsoft Jet (.MDB) database instead of opening the ODBC database directly.</LI>
</UL>



<H2><A NAME="_core_tip_attached_tables"></A>Attached Tables</H2>

<UL type=disc>
	<LI>Attach ODBC tables to a local Microsoft Jet (.MDB) database rather than opening the ODBC data source directly.<BR><BR></LI>

	<LI>Open attached Microsoft Jet tables as table-type recordsets by parsing the tabledef connect string for the database name and then opening that database directly.</LI>
</UL>



<H2><A NAME="_core_tip_sql"></A>SQL</H2>

<UL type=disc>
	<LI>With ODBC SQL statements that don’t retrieve data, use pass-through queries where possible. For related information, see the article <A HREF="_core_dao_querydef.3a_.action_queries_and_sql_pass.2d.through_queries.htm">DAO Querydef: Action Queries and SQL Pass-Through Queries</A>.<BR><BR></LI>

	<LI>Replace code loops that run a query again and again with the equivalent SQL statements to run the query once for the whole loop. For example, rather than doing 100 update calls, run one bulk query for all of the affected records. <BR><BR></LI>

	<LI>Replace repeated execution of the same dynamic SQL with a temporary query. (This applies only if you are using a querydef pointer in <A HREF="JavaScript:hhobj_7.Click()">CDaoRecordset::Open</A> to create your recordset.)</LI>
</UL>



<H2><A NAME="_core_tip_transactions"></A>Transactions</H2>

<UL type=disc>
	<LI>Always embed your MFC DAO code in transactions if you are performing multiple updates. Balance transaction sizes against the likely available memory. Don’t try to do ten thousand large updates in a single transaction. Instead, break the work into smaller lots of, say, 500 records.</LI>
</UL>



<H2><A NAME="_core_tip_locating_records"></A>Locating Records</H2>

<UL type=disc>
	<LI>Use <A HREF="JavaScript:hhobj_8.Click()">Seek</A> rather than <A HREF="JavaScript:hhobj_9.Click()">Find</A>. (<B>Seek</B> only works with table-type recordsets.)<BR><BR></LI>

	<LI>Return to a location in a recordset using bookmarks rather than <B>Find</B>. See the article <A HREF="_core_dao_recordset.3a_.bookmarks_and_record_positions.htm">DAO Recordset: Bookmarks and Record Positions</A>.<BR><BR></LI>

	<LI>Speed ODBC finds by downloading to a local indexed table and seeking. If you will be making numerous finds in the data, copy it to a local Microsoft Jet database table and use <B>Seek</B> to locate information.<BR><BR></LI>

	<LI>On ODBC data, use <B>Find</B> only on indexed fields; otherwise, open a new recordset.</LI>
</UL>



<H2><A NAME="_core_tip_other_tips"></A>Other Tips</H2>

<UL type=disc>
	<LI>Use the power of Microsoft Jet queries to save writing and debugging code. For example, the Microsoft Jet database engine allows you to update the results of join queries and automatically distributes the changes to the underlying tables.<BR><BR></LI>

	<LI>Replace short Memo fields with long text fields.<BR><BR></LI>

	<LI>Replace floating-point numbers with integers.</LI>
</UL>
</font>
</BODY>
</HTML>
