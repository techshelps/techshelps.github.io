<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO Recordset: Caching Multiple Records for Performance</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetCacheStart">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.GetBookmark">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleVariant">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetCacheSize">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.FillCache">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetCacheStart">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetCacheSize">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.FillCache">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_recordset.3a_.caching_multiple_records_for_performance"></A>DAO Recordset: Caching Multiple Records for Performance</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article discusses the mechanism by which you can use a configurable buffer to cache multiple records in a recordset. </P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>The recordset caching mechanism described here applies only to ODBC data sources. It has no effect or benefit with non-ODBC databases.</P>

<P>Topics covered include:

<UL type=disc>
	<LI><A HREF="#_core_when_should_you_use_record_caching.3f">When should you use record caching?</A><BR><BR></LI>

	<LI><A HREF="#_core_configuring_the_record_cache">Configuring the record cache</A><BR><BR></LI>

	<LI><A HREF="#_core_filling_the_record_cache">Filling the record cache</A></LI>
</UL>

<P>Normally, records are retrieved from the database one at a time. To improve the performance of operations such as seeking and scrolling in recordsets based on ODBC data sources, you can cause DAO to cache multiple records. When you request a record, the database engine looks for it first in the cache. If the record is not in the cache, the database engine gets the record from the server. This is marginally slower at the time the cache is filled, but faster for operations that navigate through the records later. Use of this mechanism is limited in several ways, however (besides its limitation to ODBC); see <A HREF="#_core_when_should_you_use_record_caching.3f">When Should You Use Record Caching?</A>.</P>

<P>For an understanding of the DAO data caching mechanism that underlies MFC <A HREF="JavaScript:hhobj_3.Click()">CDaoRecordset</A> objects, see the following topics in DAO Help:

<UL type=disc>
	<LI>CacheSize, CacheStart Properties<BR><BR></LI>

	<LI>FillCache Method</LI>
</UL>



<H2><A NAME="_core_when_should_you_use_record_caching.3f"></A>When Should You Use Record Caching?</H2>

<P>Is record caching right for your application? This depends on several factors:

<UL type=disc>
	<LI>Are you using a remote data source? Caching is really useful only for remote data — ODBC data sources.<BR><BR></LI>

	<LI>Are you using dynaset-type recordsets? Caching is for use with these recordsets only.<BR><BR></LI>

	<LI>What kind of performance do you need to optimize? If your application makes intensive use of scrolling, seeking, finding, or other methods of positioning the current record, you probably should cache records. <BR><BR></LI>

	<LI>Keep in mind that caching requires storage space and that it can take extra time to fill the cache. Records retrieved from the cache also don't reflect changes made by other users in the database.</LI>
</UL>



<H2><A NAME="_core_configuring_the_record_cache"></A>Configuring the Record Cache</H2>

<P>To use MFC's record caching, you need to do two things:

<UL type=disc>
	<LI>Set the record position at which the cache is to start.
<P class=tl>Specify the first of the records to be cached by giving its bookmark in a call to <A HREF="JavaScript:hhobj_4.Click()">CDaoRecordset::SetCacheStart</A>. You can obtain a record's bookmark by moving to the record and calling <A HREF="JavaScript:hhobj_5.Click()">CDaoRecordset::GetBookmark</A>. <B>GetBookmark</B> returns a <A HREF="JavaScript:hhobj_6.Click()">COleVariant</A> value that you can store in a variable. Use the variable in your <B>SetCacheStart</B> call.</P></LI>

	<LI>Set the size of the cache, in records.
<P class=tl>Call <A HREF="JavaScript:hhobj_7.Click()">CDaoRecordset::SetCacheSize</A> to specify how many records are to be cached.</P></LI>
</UL>

<P>How big should you make your cache? This depends on your needs and what you are optimizing for. If you expect your users to perform long scrolls or seeks, moving through many records at a time, you probably need a larger cache. </P>

<P>A typical case might be an application that, for example, displays 25 records at a time. For such an application, a cache of 75 records might be a good choice. This would allow quick response for both scrolling up and down and paging up and down.</P>



<H2><A NAME="_core_filling_the_record_cache"></A>Filling the Record Cache</H2>

<P>DAO fills the cache as you request that records be retrieved from the data source. But you can explicitly fill all or part of the cache at any time by calling <A HREF="JavaScript:hhobj_8.Click()">CDaoRecordset::FillCache</A>.</P>

<P>When you call <B>FillCache</B>, you can specify either or both of the following:

<UL type=disc>
	<LI>The bookmark of the record at which you want to start filling the cache. If you omit the <I>lBookmark</I> parameter to <B>FillCache</B>, the cache is filled starting with the record specified in DAO's CacheStart property. You can set that value with <A HREF="JavaScript:hhobj_9.Click()">CDaoRecordset::SetCacheStart</A>.<BR><BR></LI>

	<LI>The number of records you want to put into the cache. This can be less than the cache size you specified with a call to <A HREF="JavaScript:hhobj_10.Click()">CDaoRecordset::SetCacheSize</A>. If you omit the <I>lSize</I> parameter to <B>FillCache</B>, the number of records defaults to DAO's CacheSize property value, which you can set with <B>SetCacheSize</B>.</LI>
</UL>

<P>For more information, see the <A HREF="JavaScript:hhobj_11.Click()">CDaoRecordset::FillCache</A> member function in the <I>Class Library Reference</I>. For information about the DAO caching mechanism, see the following topics in DAO Help:

<UL type=disc>
	<LI>CacheSize, CacheStart Properties<BR><BR></LI>

	<LI>FillCache Method</LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao_recordset.htm">DAO Recordset</A></P>
</font>
</BODY>
</HTML>
