<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Collections: How to Make a Type-Safe Collection</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_Sample_mfc_collect">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Scribble start">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_COLLECT">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_Collection_Class_Helpers">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_SerializeElements">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_ConstructElements">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_DestructElements">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_Collection_Class_Helpers">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_ConstructElements">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_DestructElements">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CArray.3a3a.SetSize">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CArray.3a3a.InsertAt">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CList.3a3a.AddHead">
</OBJECT>
<OBJECT ID="hhobj_15" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CList.3a3a.AddTail">
</OBJECT>
<OBJECT ID="hhobj_16" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CList.3a3a.InsertBefore">
</OBJECT>
<OBJECT ID="hhobj_17" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CList.3a3a.InsertAfter">
</OBJECT>
<OBJECT ID="hhobj_18" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CMap.3a3a.operator_.5b_5d">
</OBJECT>
<OBJECT ID="hhobj_19" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CArray.3a3a.SetSize">
</OBJECT>
<OBJECT ID="hhobj_20" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CArray.3a3a.RemoveAt">
</OBJECT>
<OBJECT ID="hhobj_21" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CList.3a3a.RemoveAll">
</OBJECT>
<OBJECT ID="hhobj_22" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CMap.3a3a.RemoveAll">
</OBJECT>
<OBJECT ID="hhobj_23" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CList.3a3a.RemoveHead">
</OBJECT>
<OBJECT ID="hhobj_24" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CList.3a3a.RemoveTail">
</OBJECT>
<OBJECT ID="hhobj_25" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CList.3a3a.RemoveAt">
</OBJECT>
<OBJECT ID="hhobj_26" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CMap.3a3a.RemoveKey">
</OBJECT>
<OBJECT ID="hhobj_27" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFCNOTES_TN004">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_collections.3a_.how_to_make_a_type.2d.safe_collection"></A>Collections: How to Make a Type-Safe Collection</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_collections.2c_.working_with_aggregate_data.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_collection_class_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_3.Click()">Tutorial</A></P>

<P>This article explains how to make type-safe collections for your own data types. Topics include:

<UL type=disc>
	<LI><A HREF="#_core_using_template.2d.based_classes_for_type_safety">Using template-based classes for type safety</A><BR><BR></LI>

	<LI><A HREF="#_core_implementing_helper_functions">Implementing helper functions</A><BR><BR></LI>

	<LI><A HREF="#_core_using_nontemplate_collection_classes">Using nontemplate collection classes</A></LI>
</UL>

<P>The Microsoft Foundation Class Library provides predefined type-safe collections based on C++ templates. Because they are templates, these classes provide type safety and ease of use without the type-casting and other extra work involved in using a nontemplate class for this purpose. The MFC Advanced Concepts sample <A HREF="JavaScript:hhobj_4.Click()">COLLECT</A> demonstrates the use of template-based collection classes in an MFC application. In general, use these classes any time you write new collections code.</P>



<H2><A NAME="_core_using_template.2d.based_classes_for_type_safety"></A>Using Template-Based Classes for Type Safety</H2>

<P class=label><B>To use template-based classes</B>

<OL>
	<LI>Declare a variable of the collection class type. For example:
<PRE><CODE>CList&lt;int, int&gt; m_intList;
</CODE></PRE>
</LI>

	<LI>Call the member functions of the collection object. For example:
<PRE><CODE>m_intList.AddTail( 100 );
m_intList.RemoveAll( );
</CODE></PRE>
</LI>

	<LI>If necessary, implement the <A HREF="JavaScript:hhobj_5.Click()">helper functions</A> <A HREF="JavaScript:hhobj_6.Click()">SerializeElements</A>, <A HREF="JavaScript:hhobj_7.Click()">ConstructElements</A>, and <A HREF="JavaScript:hhobj_8.Click()">DestructElements</A>. For information on implementing these functions, see <A HREF="#_core_implementing_helper_functions">Implementing Helper Functions</A>.</LI>
</OL>

<P>This example shows the declaration of a list of integers. The first parameter in step 1 is the type of data stored as elements of the list. The second parameter specifies how the data is to be passed to and returned from member functions of the collection class, such as <B>Add</B> and <B>GetAt</B>.</P>



<H2><A NAME="_core_implementing_helper_functions"></A>Implementing Helper Functions</H2>

<P>The template-based collection classes <B>CArray</B>, <B>CList</B>, and <B>CMap</B> use seven global helper functions that you can customize as needed for your derived collection class. For information on these helper functions, see <A HREF="JavaScript:hhobj_9.Click()">Collection Class Helpers</A> in the <I>Class Library Reference</I>. Three of these helper functions are used in constructing, destructing, and serializing collection elements; implementations of these functions are necessary for most uses of the template-based collection classes.</P>

<H3>Construction and Destruction</H3>

<P>The helper functions <A HREF="JavaScript:hhobj_10.Click()">ConstructElements</A> and <A HREF="JavaScript:hhobj_11.Click()">DestructElements</A> are called by members that respectively add and remove elements from a collection.</P>

<TABLE border=1 cellpadding=5 cols=3 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=29%><B>Helper</B></TD>
<TD class=label width=33%><B>Called directly by</B></TD>
<TD class=label width=38%><B>Called indirectly by</B></TD>
</TR>

<TR VALIGN="top">
<TD width=29%><B>ConstructElements</B></TD>
<TD width=33%><A HREF="JavaScript:hhobj_12.Click()">CArray::SetSize</A><BR>
<A HREF="JavaScript:hhobj_13.Click()">CArray::InsertAt</A></TD>
<TD width=38%><A HREF="JavaScript:hhobj_14.Click()">CList::AddHead</A><BR>
<A HREF="JavaScript:hhobj_15.Click()">CList::AddTail</A><BR>
<A HREF="JavaScript:hhobj_16.Click()">CList::InsertBefore</A><BR>
<A HREF="JavaScript:hhobj_17.Click()">CList::InsertAfter</A><BR>
<A HREF="JavaScript:hhobj_18.Click()">CMap::operator [ ]</A></TD>
</TR>

<TR VALIGN="top">
<TD width=29%><B>DestructElements</B></TD>
<TD width=33%><A HREF="JavaScript:hhobj_19.Click()">CArray::SetSize</A><BR>
<A HREF="JavaScript:hhobj_20.Click()">CArray::RemoveAt</A><BR>
<A HREF="JavaScript:hhobj_21.Click()">CList::RemoveAll</A><BR>
<A HREF="JavaScript:hhobj_22.Click()">CMap::RemoveAll</A></TD>
<TD width=38%><A HREF="JavaScript:hhobj_23.Click()">CList::RemoveHead</A><BR>
<A HREF="JavaScript:hhobj_24.Click()">CList::RemoveTail</A><BR>
<A HREF="JavaScript:hhobj_25.Click()">CList::RemoveAt</A><BR>
<A HREF="JavaScript:hhobj_26.Click()">CMap::RemoveKey</A></TD>
</TR>
</TABLE><BR>

<P>You should override these functions if their default action is not suitable for your collection class. The default implementation of <B>ConstructElements</B> sets to 0 the memory that is allocated for new elements of the collection and calls the constructor of each element. The default implementation of <B>DestructElements</B> calls the destructor for each element.</P>

<P>In general, overriding <B>ConstructElements</B> is necessary whenever the collection stores objects that require a call to a constructor (or other initializing function), or when the objects have members requiring such calls. Overriding <B>DestructElements</B> is necessary when an object requires special action, such as freeing memory allocated from the heap, when the object is destroyed.</P>

<P>For example, you might override <B>ConstructElements</B> for an array of <B>CPerson</B> objects as follows:</P>

<PRE><CODE>class CPerson : public CObject { . . . };
CArray&lt; CPerson, CPerson&amp; &gt; personArray;

template &lt;&gt; void AFXAPI ConstructElements &lt;CPerson&gt; ( CPerson* pNewPersons, int nCount )
{
    for ( int i = 0; i &lt; nCount; i++, pNewPersons++ )
    {
        // call CPerson default constructor directly
        new( pNewPersons )CPerson;
    }
}
</CODE></PRE>

<P>This override iterates through the new <B>CPerson</B> objects, calling each object’s constructor. The special <B>new</B> operator used here constructs a new <B>CPerson</B> object in place rather than allocating memory from the heap.</P>



<H3><A NAME="_core_serializing_elements"></A>Serializing Elements</H3>

<P>The <B>CArray</B>, <B>CList</B>, and <B>CMap</B> classes call <B>SerializeElements</B> to store collection elements to or read them from an archive.</P>

<P>The default implementation of the <B>SerializeElements</B> helper function does a bitwise write from the objects to the archive, or a bitwise read from the archive to the objects, depending on whether the objects are being stored in or retrieved from the archive. Override <B>SerializeElements</B> if this action is not appropriate.</P>

<P>If your collection stores objects derived from <B>CObject</B> and you use the <B>IMPLEMENT_SERIAL</B> macro in the implementation of the collection element class, you can take advantage of the serialization functionality built into <B>CArchive</B> and <B>CObject</B>:</P>

<PRE><CODE>class CPerson : public CObject { . . . };
CArray&lt; CPerson, CPerson&amp; &gt; personArray;

template &lt;&gt; void AFXAPI SerializeElements &lt;CPerson&gt; ( CArchive&amp; ar, CPerson* pNewPersons, int nCount )
{
    for ( int i = 0; i &lt; nCount; i++, pNewPersons++ )
    {
        // Serialize each CPerson object
        pNewPersons-&gt;Serialize( ar );
    }
}
</CODE></PRE>

<P>The overloaded insertion operators for <B>CArchive</B> call <B>CObject::Serialize</B> (or an override of that function) for each <B>CPerson</B> object.</P>



<H2><A NAME="_core_using_nontemplate_collection_classes"></A>Using Nontemplate Collection Classes</H2>

<P>MFC also supports the collection classes introduced with MFC version 1.0. These classes are not based on templates. They can be used to contain data of the supported types <B>CObject*</B>, <B>UINT</B>, <B>DWORD</B>, and <B>CString</B>. You can use these predefined collections (such as <B>CObList</B>) to hold collections of any objects derived from <B>CObject</B>. MFC also provides other predefined collections to hold primitive types such as <B>UINT</B> and void pointers (<B>void</B>*). In general, however, it is often useful to define your own type-safe collections to hold objects of a more specific class and its derivatives. Note that doing so with the collection classes not based on templates is more work than using the template-based classes.</P>

<P>There are two ways to create type-safe collections with the nontemplate collections:

<OL>
	<LI>Use the nontemplate collections, with type casting if necessary. This is the easier approach.<BR><BR></LI>

	<LI>Derive from and extend a nontemplate type-safe collection.</LI>
</OL>

<P class=label><B>To use the nontemplate collections with type casting</B>

<UL type=disc>
	<LI>Use one of the nontemplate classes, such as <B>CWordArray</B>, directly. 
<P class=tl>For example, you can create a <B>CWordArray</B> and add any 32-bit values to it, then retrieve them. There is nothing more to do. You just use the predefined functionality.</P>
<P class=tl>You can also use a predefined collection, such as <B>CObList</B>, to hold any objects derived from <B>CObject</B>. A <B>CObList</B> collection is defined to hold pointers to <B>CObject</B>. When you retrieve an object from the list, you may have to cast the result to the proper type since the <B>CObList</B> functions return pointers to <B>CObject</B>. For example, if you store <CODE>CPerson</CODE> objects in a <B>CObList</B> collection, you have to cast a retrieved element to be a pointer to a <CODE>CPerson</CODE> object. The following example uses a <B>CObList</B> collection to hold <CODE>CPerson</CODE> objects:</P>
<PRE><CODE>class CPerson : public CObject {...};

CPerson* p1 = new CPerson(...);
CObList myList;

myList.AddHead( p1 );   // No cast needed
CPerson* p2 = ( CPerson* )myList.GetHead();
</CODE></PRE>

<P class=tl>This technique of using a predefined collection type and casting as necessary may be adequate for many of your collection needs. If you need further functionality or more type safety, use a template-based class, or follow the next procedure.</P></LI>
</UL>

<P class=label><B><A NAME="_core_to_derive_and_extend_a_nontemplate_type.2d.safe_collection"></A>To derive and extend a nontemplate type-safe collection</B>

<UL type=disc>
	<LI>Derive your own collection class from one of the predefined nontemplate classes. 
<P class=tl>When you derive your class, you can add type-safe wrapper functions to provide a type-safe interface to existing functions.</P>
<P class=tl>For example, if you derived a list from <B>CObList</B> to hold <CODE>CPerson</CODE> objects, you might add the wrapper functions <CODE>AddHeadPerson</CODE> and <CODE>GetHeadPerson</CODE>, as shown below.</P>
<PRE><CODE>class CPersonList : public CObList
{
public:
    void AddHeadPerson( CPerson* person )
        {AddHead( person );}

    const CPerson* GetHeadPerson()
        {return (CPerson*)GetHead();}
};
</CODE></PRE>

<P class=tl>These wrapper functions provide a type-safe way to add and retrieve <CODE>CPerson</CODE> objects from the derived list. You can see that for the <CODE>GetHeadPerson</CODE> function, you are simply encapsulating the type casting.</P>
<P class=tl>You can also add new functionality by defining new functions that extend the capabilities of the collection rather than just wrapping existing functionality in type-safe wrappers. For example, the article <A HREF="_core_collections.3a_.deleting_all_objects_in_a_cobject_collection.htm">Collections: Deleting All Objects in a CObject Collection</A> describes a function to delete all the objects contained in a list. This function could be added to the derived class as a member function.</P></LI>
</UL>

<P>For related information, see <A HREF="JavaScript:hhobj_27.Click()">Technical Note 4: C++ Template Tool</A>. </P>
</font>
</BODY>
</HTML>
