<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ClassWizard: Creating a Recordset Class</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Scribble start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.m_strFilter">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.m_strFilter">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_classwizard.3a_.creating_a_recordset_class"></A>ClassWizard: Creating a Recordset Class</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_working_with_classes.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_working_with_classes_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A></P>

<P>This article explains how to create a recordset class with ClassWizard.</P>

<P>You'll need a new <A HREF="JavaScript:hhobj_3.Click()">CRecordset</A>-derived class (for ODBC) or <A HREF="JavaScript:hhobj_4.Click()">CDaoRecordset</A>-derived class (for DAO) for each table, join of tables, or predefined query you work with in your program. Each recordset class specifies its own set of columns and may also specify parameters. For information about the structure of your recordset class and its uses, see the article <A HREF="_core_recordset.3a_.architecture_.28.odbc.29.htm">Recordset: Architecture (ODBC)</A> or <A HREF="_core_dao_recordset.3a_.architecture.htm">DAO Recordset: Architecture</A>.</P>

<P>For information about mapping recordset field data members to columns in the table, see the article <A HREF="_core_classwizard.3a_.binding_recordset_fields_to_table_columns.htm">ClassWizard: Binding Recordset Fields to Table Columns</A>. </P>

<P>For information about using a <A HREF="JavaScript:hhobj_5.Click()">CRecordset</A> (ODBC) for a join of tables, see the article <A HREF="_core_recordset.3a_.performing_a_join_.28.odbc.29.htm">Recordset: Performing a Join (ODBC)</A>. (Performing a join with DAO is similar.) </P>

<P>For information about using a <B>CRecordset</B> for a predefined query, see the article <A HREF="_core_recordset.3a_.declaring_a_class_for_a_predefined_query_.28.odbc.29.htm">Recordset: Declaring a Class for a Predefined Query (ODBC)</A>. For information about predefined ("saved") queries in DAO, see the article <A HREF="_core_dao_querydef.htm">DAO Querydef</A>.</P>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;When creating <B>CRecordset</B>-derived or <B>CDaoRecordset</B>-derived classes with ClassWizard, be careful when selecting multiple tables or queries. Selecting multiple tables or queries will result in the construction of a JOIN query without any restriction on how to perform the JOIN (called a cross product or a Cartesian product JOIN). You may wish to specify a filter using <A HREF="JavaScript:hhobj_6.Click()">CRecordset::m_strFilter</A> or <A HREF="JavaScript:hhobj_7.Click()">CDaoRecordset::m_strFilter</A> (resulting in MFC building an SQL WHERE clause) before the recordset is opened. This will constrain the number of records in the result set. This is especially necessary when using the ODBC Cursor Library, since the Cursor Library may create a large temporary file for result sets with many records.</P>

<P>The table below shows the major steps in creating a recordset class.</P>

<P class=label><B>Recordset Class Creation Summary</B></P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=48%><B>To</B></TD>
<TD class=label width=52%><B>Do this</B></TD>
</TR>

<TR VALIGN="top">
<TD width=48%>Create the class</TD>
<TD width=52%>Use the Add Class dialog box in ClassWizard.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>Select a data source and database table for the class</TD>
<TD width=52%>Select options in the Database Options dialog box. These include a data source, possibly a recordset type, and possibly some advanced options. Then specify details about the data source in the Select Database dialog box (for ODBC) or the Open dialog box (for DAO). Next, use the Select Database Tables dialog box to select tables from those available on the data source.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>Remove any column mappings you don't want. By default, AppWizard and ClassWizard bind all columns in the table to recordset field data members</TD>
<TD width=52%>Select a column name on the Member Variables tab and choose Delete Variable.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>Optionally parameterize the underlying SQL statements</TD>
<TD width=52%>Manually add parameter data members, or, in DAO, base your recordset on a parameterized a querydef object.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>Optionally use dialog data exchange (DDX) to map recordset data members to controls in a record view</TD>
<TD width=52%>See the article <A HREF="_core_record_views.htm">Record Views</A>. </TD>
</TR>
</TABLE><BR>

<P>For more information about parameterizing your class, see the article <A HREF="_core_recordset.3a_.parameterizing_a_recordset_.28.odbc.29.htm">Recordset: Parameterizing a Recordset (ODBC)</A> or the article <A HREF="_core_dao_queries.3a_.filtering_and_parameterizing_queries.htm">DAO Queries: Filtering and Parameterizing Queries</A>. For information about using DDX between record view controls and recordset data members, see the article <A HREF="_core_classwizard.3a_.mapping_form_controls_to_recordset_fields.htm">ClassWizard: Mapping Form Controls to Recordset Fields</A>.</P>

<P class=label><B><A NAME="_core_to_create_the_recordset_class"></A>To create the recordset class</B></P>

<P>You can add a new class derived from class <A HREF="JavaScript:hhobj_8.Click()">CRecordset</A> or <A HREF="JavaScript:hhobj_9.Click()">CDaoRecordset</A> in ClassWizard's Add Class dialog box. This dialog box is available from any tab in ClassWizard. (All figures follow the procedure below.)

<OL>
	<LI>On the <B>View</B> menu, click ClassWizard.<BR><BR></LI>

	<LI>Click <B>Add Class</B> and select <B>New </B>from the drop-down list.
<P class=tl>The <B>Add Class </B>dialog box appears (see <A HREF="#_core_specifying_information_for_a_new_class">figure</A> below).</P></LI>

	<LI>In the <B>Name </B>box, enter a name for the class; in the <B>Filenames</B> box, enter filenames for its .h and .cpp files.<BR><BR></LI>

	<LI>From the <B>Base class</B> drop-down list, select <A HREF="JavaScript:hhobj_10.Click()">CRecordset</A> as the base-class type of the new class. If you're using the MFC DAO classes, select <A HREF="JavaScript:hhobj_11.Click()">CDaoRecordset</A>.<BR><BR></LI>

	<LI>Click <B>OK</B>.
<P class=tl>The <B>Database Options</B> dialog box appears (see <A HREF="#_core_selecting_a_data_source_in_classwizard">figure</A> below).</P></LI>

	<LI>Choose ODBC or DAO. Then select a data source:
<UL type=disc>
	<LI>For ODBC, select from the drop-down list. Depending on what you choose, you might need to make a further selection in an Open dialog box. If the data source is on a server, you might be prompted to log in to the server.<BR><BR></LI>

	<LI>For DAO, click the browse button beside the DAO edit control. Then, in the Open dialog box, navigate to the database file you want to use. (By default, the dialog box displays only Microsoft Jet databases, .mdb, but you can open any database that the Microsoft Jet database engine can read. For information, see the article <A HREF="_core_databases.3a_.overview.htm">Databases: Overview</A>.</LI>
</UL>
</LI>

	<LI>Select the Recordset type (Snapshot, Dynaset, or Table) and Advanced features you want the class to have.<BR><BR></LI>

	<LI>Click <B>OK</B>.<BR><BR></LI>

	<LI>In the <B>Select Database Tables</B> dialog box (see <A HREF="#_core_selecting_a_database_table_in_classwizard">figure</A> below), select the name(s) of the table(s) you want.
<P class=tl>Click <B>OK</B>.</P>
<P class=tl>On ClassWizard's <B>Member Variables</B> tab, notice that ClassWizard binds all of the table's columns to recordset field data members. For information about removing bindings you don't want, see the article <A HREF="_core_classwizard.3a_.binding_recordset_fields_to_table_columns.htm">ClassWizard: Binding Recordset Fields to Table Columns</A>. </P></LI>

	<LI>When you finish, click <B>OK </B>to close ClassWizard. ClassWizard writes your class files in the specified directory and adds them to your project.</LI>
</OL>

<P class=label><B><A NAME="_core_specifying_information_for_a_new_class"></A>Specifying Information for a New Class</B></P>

<P><IMG SRC="mcadcl.gif" ALT="" BORDER=0></P>
<P class=label><B><A NAME="_core_selecting_a_data_source_in_classwizard"></A>Selecting a Data Source in ClassWizard</B></P>

<P><IMG SRC="mcsqld.gif" ALT="" BORDER=0></P>
<P class=label><B><A NAME="_core_selecting_a_database_table_in_classwizard"></A>Selecting a Database Table in ClassWizard</B></P>

<P><IMG SRC="mcdbtl.gif" ALT="" BORDER=0></P>
<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_classwizard.3a_.database_support.htm">ClassWizard: Database Support</A>, <A HREF="_core_classwizard.3a_.binding_recordset_fields_to_table_columns.htm">ClassWizard: Binding Recordset Fields to Table Columns</A></P>
</font>
</BODY>
</HTML>
