<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ActiveX Controls: Adding Another Custom Property Page</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="circle sample start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_AfxOleRegisterPropertyPageClass">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_activex_controls.3a_.adding_another_custom_property_page"></A>ActiveX Controls: Adding Another Custom Property Page</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_activex_controls.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_activex_control_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_frequently_asked_questions_about_activex_controls.htm">FAQ</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_activex_control_sample_list.htm">Sample</A></P>

<P>Occasionally, an ActiveX control will have more properties than can reasonably fit on one property page. In this case, you can add property pages to the ActiveX control to display these properties.</P>

<P>This article discusses adding new property pages to an ActiveX control that already has at least one property page. For more information on adding stock property pages (font, picture, or color), see the article <A HREF="_core_activex_controls.3a_.using_stock_property_pages.htm">ActiveX Controls: Using Stock Property Pages</A>.</P>

<P>The following procedures use a sample ActiveX control framework created by ControlWizard. Therefore, the class names and identifiers are unique to this example.</P>

<P>For more information on using property pages in an ActiveX control, see the following articles:

<UL type=disc>
	<LI><A HREF="_core_activex_controls.3a_.property_pages.htm">ActiveX Controls: Property Pages</A><BR><BR></LI>

	<LI><A HREF="_core_activex_controls.3a_.using_stock_property_pages.htm">ActiveX Controls: Using Stock Property Pages</A></LI>
</UL>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;It is strongly recommended that new property pages adhere to the size standard for ActiveX control property pages. The stock picture and color property pages measure 250x62 dialog units (DLUs). The standard font property page is 250x110 DLUs. The default property page created by ControlWizard uses the 250x62 DLU standard.</P>

<P class=label><B>To create another property page</B>

<OL>
	<LI>With your control project open, click the <B>ResourceView</B> tab in the Project Workspace window.<BR><BR></LI>

	<LI>On the <B>Insert </B>menu, click <B>Resource</B>.<BR><BR></LI>

	<LI>Double-click on the dialog resource type to create a new dialog resource.<BR><BR></LI>

	<LI>Delete the <B>OK </B>and <B>Cancel </B>button controls.<BR><BR></LI>

	<LI>Right-click on the dialog template to open the <B>Dialog Properties</B> box, and type a resource ID.
<P class=tl>This example uses <CODE>IDD_PROPPAGE_NEWPAGE</CODE>. </P></LI>

	<LI>Click the <B>Styles</B> tab. From the <B>Style</B> box, select <B>Child</B>. From the <B>Border</B> box, select <B>None</B>.
<P class=tl>Make sure that on the <B>Styles</B> tab the <B>Titlebar</B> option is not checked, and on the <B>More Styles</B> tab the <B>Visible</B> option is not checked.</P></LI>

	<LI>Click <B>Save</B> on the toolbar.<BR><BR></LI>

	<LI>Double-click the dialog template to open <B>ClassWizard</B>.<BR><BR></LI>

	<LI>In the <B>Adding a Class</B> dialog box, click <B>OK</B>.<BR><BR></LI>

	<LI>In the <B>Class Name</B> box in the <B>New Class</B> dialog box, type a name for the new dialog class.
<P class=tl>(In this example, <CODE>CAddtlPropPage</CODE>.)</P></LI>

	<LI>If you want to change file names, click <B>Change</B>. Type in the names for your implementation and header files, or accept the default names.<BR><BR></LI>

	<LI>In the <B>Base Class </B>box, select <B>COlePropertyPage</B>.<BR><BR></LI>

	<LI>In the <B>Dialog ID </B>box, select IDD_PROPPAGE_NEWPAGE.<BR><BR></LI>

	<LI>Click <B>OK </B>to create the class.<BR><BR></LI>

	<LI>Click <B>OK </B>to close <B>ClassWizard</B>.</LI>
</OL>

<P>To allow the control’s users access to this new property page, make the following changes to the control’s property page IDs macro section (located in the control implementation file):</P>

<PRE><CODE>BEGIN_PROPPAGEIDS(CSampleCtrl, 2)
    PROPPAGEID(CMyPropPage::guid)
   PROPPAGEID(CAddtlPropPage::guid)
...
END_PROPPAGEIDS(CSampleCtrl)
</CODE></PRE>

<P>Note that you must increase the second parameter of the <B>BEGIN_PROPPAGEIDS</B> macro (the property page count) from 1 to 2.</P>

<P>You must also modify the control implementation file (.CPP) file to include the header (.H) file of the new property page class.</P>

<P>The next step involves creating two new string resources that will provide a type name and a caption for the new property page.</P>

<P class=label><B>To add new string resources to a property page</B>

<OL>
	<LI>With your control project open, click the <B>ResourceView</B> tab in the Project Workspace window.<BR><BR></LI>

	<LI>Double-click the <B>String Table</B> folder, then double-click the existing string table resource to which you want to add a string.
<P class=tl>This opens the string table in a window.</P></LI>

	<LI>Select the blank line at the end of the string table and type the text, or caption, of the string: for example, “Additional Property Page.”
<P class=tl>This opens a <B>String Properties</B> page showing <B>Caption</B> and <B>ID</B> boxes. The <B>Caption</B> box contains the string you typed.</P></LI>

	<LI>In the <B>ID</B> box, select or type an ID for the string. Press Enter when you finish.
<P class=tl>For example purposes, we’ve used IDS_SAMPLE_ADDPAGE for the type name of the new property page.</P></LI>

	<LI>Repeat steps 3 and 4 using IDS_SAMPLE_ADDPPG_CAPTION for the ID and “Additional Property Page” for the caption.<BR><BR></LI>

	<LI>In the .CPP file of your new property page class (in this example, <CODE>CAddtlPropPage</CODE>) modify the <CODE>CAddtlPropPage::CAddtlPropPageFactory::UpdateRegistry</CODE> so that IDS_SAMPLE_ADDPAGE is passed by <A HREF="JavaScript:hhobj_3.Click()">AfxOleRegisterPropertyPageClass</A>, as in the following example:
<PRE><CODE>BOOL CAddtlPropPage::CAddtlPropPageFactory::UpdateRegistry(BOOL bRegister)
{
    if (bRegister)
        return AfxOleRegisterPropertyPageClass(AfxGetInstanceHandle(),
                     m_clsid, IDS_SAMPLE_ADDPAGE);
    else
        return AfxOleUnregisterClass(m_clsid, NULL);
}
</CODE></PRE>
</LI>

	<LI>Modify the constructor of <CODE>CAddtlPropPage</CODE> so that IDS_SAMPLE_ADDPPG_CAPTION is passed to the <B>COlePropertyPage</B> constructor, as follows:
<PRE><CODE>CAddtlPropPage::CAddtlPropPage() :
// ****** Add your code below this line ********** //
     COlePropertyPage(IDD,  IDS_SAMPLE_ADDPPG_CAPTION)
// ****** Add your code above this line ********** //
{
    //{{AFX_DATA_INIT(CAddtlPropPage)
    // NOTE: ClassWizard will add member initialization here
    //    DO NOT EDIT what you see in these blocks of generated code !
    //}}AFX_DATA_INIT
}
</CODE></PRE>
</LI>
</OL>

<P>After you have made the necessary modifications rebuild your project and use Test Container to test the new property page. For more information on testing an ActiveX control with Test Container, see <A HREF="_core_test_container.htm">Test Container</A>.</P>
</font>
</BODY>
</HTML>
