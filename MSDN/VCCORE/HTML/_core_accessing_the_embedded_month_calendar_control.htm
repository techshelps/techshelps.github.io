<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Accessing the Embedded Month Calendar Control</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDateTimeCtrl.3a3a.GetMonthCalCtrl">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDateTimeCtrl.3a3a.GetMonthCalCtrl">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDateTimeCtrl.3a3a.SetMonthCalColor">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDateTimeCtrl.3a3a.SetMonthCalFont">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_accessing_the_embedded_month_calendar_control"></A>Accessing the Embedded Month Calendar Control</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_using_cdatetimectrl.htm">Overview</A>  |&nbsp; <A HREF="_core_common_control_sample_list.htm">Sample</A></P>

<P>The embedded month calendar control object can be accessed from the <B>CDateTimeCtrl</B> object with a call to the <A HREF="JavaScript:hhobj_2.Click()">GetMonthCalCtrl</A> member function.</P>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;The embedded month calendar control is used only when the date and time picker control does not have the <B>DTS_UPDOWN </B>style set.</P>

<P>This is useful if you want to modify certain attributes before the embedded control is displayed. To accomplish this, handle the <B>DTN_DROPDOWN</B> notification, retrieve the month calendar control (using <A HREF="JavaScript:hhobj_3.Click()">CDateTimeCtrl::GetMonthCalCtrl</A>), and make your modifications. Unfortunately, the month calendar control is not persistent.</P>

<P>In other words, when the user requests the display of the month calendar control, a new month calendar control is created (before the <B>DTN_DROPDOWN</B> notification). The control is destroyed (after the <B>DTN_CLOSEUP</B> notification) when dismissed by the user. This means that any attributes you modify, before the embedded control is displayed, are lost when the embedded control is dismissed.</P>

<P>The following example demonstrates this procedure, using a handler for the <B>DTN_DROPDOWN</B> notification. The code changes the background color of the month calendar control, with a call to <A HREF="JavaScript:hhobj_4.Click()">SetMonthCalColor</A>, to gray. The code is as follows:</P>

<PRE><CODE>void CMyDlg::OnDropdown(NMHDR* pNMHDR, LRESULT* pResult)
{

     //set the background color of the month to gray
     COLORREF clr= RGB(100, 100, 100);
     SetMonthCalColor(MCSC_MONTHBK, clr);

     *pResult = 0;
}
</CODE></PRE>

<P>As stated previously, all modifications to properties of the month calendar control are lost, with two exceptions, when the embedded control is dismissed. The first exception, the colors of the month calendar control, has already been discussed. The second exception is the font used by the month calendar control. You can modify the default font by making a call to <A HREF="JavaScript:hhobj_5.Click()">CDateTimeCtrl::SetMonthCalFont</A>, passing the handle of an existing font. The following example (where <CODE>m_dtPicker</CODE> is the date and time control object) demonstrates one possible method:</P>

<PRE><CODE>CMonthCalCtrl* pMCCtrl= NULL;

pMCCtrl= m_dtPicker.GetMonthCalCtrl();

//create and initialize the font to be used
LOGFONT logFont;

logFont.lfHeight = -12;
logFont.lfWidth = 0;
logFont.lfWeight = FW_NORMAL;
logFont.lfItalic = FALSE;
logFont.lfUnderline = FALSE;
logFont.lfStrikeOut = FALSE;
logFont.lfEscapement = 0;
logFont.lfOrientation = 0;
lstrcpy(logFont.lfFaceName, _T("Verdana"));

m_MCFont.CreateFontIndirect(&amp;logFont);
m_dtPicker.SetMonthCalFont((HFONT)m_MCFont);
</CODE></PRE>

<P>Once the font has been changed, with a call to <B>CDateTimeCtrl::SetMonthCalFont</B>, the new font is stored and used the next time a month calendar is to be displayed.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_control_topics.htm#_core_windows_common_controls_and_mfc_classes">Windows Common Controls and MFC Classes</A></P>
</font>
</BODY>
</HTML>
