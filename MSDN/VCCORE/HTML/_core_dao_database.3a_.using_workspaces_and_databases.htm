<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO Database: Using Workspaces and Databases</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDocument">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_15" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_16" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace.3a3a.BeginTrans">
</OBJECT>
<OBJECT ID="hhobj_17" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace.3a3a.CommitTrans">
</OBJECT>
<OBJECT ID="hhobj_18" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace.3a3a.Rollback">
</OBJECT>
<OBJECT ID="hhobj_19" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_database.3a_.using_workspaces_and_databases"></A>DAO Database: Using Workspaces and Databases</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains how to use <A HREF="JavaScript:hhobj_3.Click()">CDaoWorkspace</A> and <A HREF="JavaScript:hhobj_4.Click()">CDaoDatabase</A> objects. Topics covered include:

<UL type=disc>
	<LI><A HREF="#_core_a_typical_workspace_scenario">A typical workspace scenario</A><BR><BR></LI>

	<LI><A HREF="#_core_transactions_in_the_typical_scenario">Transactions in the typical scenario</A><BR><BR></LI>

	<LI><A HREF="#_core_beyond_the_typical_scenario">Beyond the typical scenario</A></LI>
</UL>

<H2><A NAME="_core_a_typical_workspace_scenario"></A>A Typical Workspace Scenario</H2>

<P>In the majority of data access applications, you work less at the workspace level than at the database or even recordset level. It might seem the normal thing to construct an explicit <A HREF="JavaScript:hhobj_5.Click()">CDaoWorkspace</A> object, then from it construct a <A HREF="JavaScript:hhobj_6.Click()">CDaoDatabase</A> object and from that construct <A HREF="JavaScript:hhobj_7.Click()">CDaoRecordset</A>, <A HREF="JavaScript:hhobj_8.Click()">CDaoQueryDef</A>, and <A HREF="JavaScript:hhobj_9.Click()">CDaoTableDef</A> objects. But the more typical approach is one of the following:

<UL type=disc>
	<LI>Construct a <B>CDaoDatabase</B> object, perhaps stored in your <A HREF="JavaScript:hhobj_10.Click()">CDocument</A>-derived class. Then from it construct the necessary recordsets and other objects. You're likely to do this if you want to maintain a connection to a single database for the life of your application, or at least the life of your document. For related information, see the articles <A HREF="_core_mfc.3a_.using_database_classes_with_documents_and_views.htm">MFC: Using Database Classes with Documents and Views</A>, <A HREF="_core_mfc.3a_.using_database_classes_without_documents_and_views.htm">MFC: Using Database Classes Without Documents and Views</A>, and <A HREF="_core_dao.3a_.writing_a_database_application.htm">DAO: Writing a Database Application</A>.<BR><BR></LI>

	<LI>Construct recordsets as needed, relying on MFC to create the necessary <A HREF="JavaScript:hhobj_11.Click()">CDaoDatabase</A> and <A HREF="JavaScript:hhobj_12.Click()">CDaoWorkspace</A> objects behind the scenes. You're likely to do this if you prefer to construct recordsets within the scope of a function, for example to run a query based on a menu command.
<P class=atl><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>This is inefficient if you are continually opening and closing the same database. In that case, create an explicit <B>CDaoDatabase</B> object and use it for the life of your application.</p></LI>
</UL>

<H2><A NAME="_core_transactions_in_the_typical_scenario"></A>Transactions in the Typical Scenario</H2>

<P>The primary action taken on a workspace object that might be called typical is to use the object for transactions against one or more databases. The transaction commands in MFC are members of class <A HREF="JavaScript:hhobj_13.Click()">CDaoWorkspace</A>. </P>

<P>To access transaction commands in the most typical case, you can use the implicit workspace that MFC creates behind <A HREF="JavaScript:hhobj_14.Click()">CDaoDatabase</A> and <A HREF="JavaScript:hhobj_15.Click()">CDaoRecordset</A> objects (one implicit workspace for multiple objects). To issue transaction commands, such as <A HREF="JavaScript:hhobj_16.Click()">BeginTrans</A>, <A HREF="JavaScript:hhobj_17.Click()">CommitTrans</A>, or <A HREF="JavaScript:hhobj_18.Click()">Rollback</A>, you can choose to call those member functions of <B>CDaoWorkspace</B> through the pointer stored in your <B>CDaoRecordset</B> or <B>CDaoDatabase</B> object. For details about accessing such pointers, see the article <A HREF="_core_dao.3a_.accessing_implicit_mfc_dao_objects.htm">DAO: Accessing Implicit MFC DAO Objects</A>.</P>

<P>For example, from a recordset object, you might call:</P>

<PRE><CODE>// prs is a pointer to an already opened 
// CDaoRecordset object
prs-&gt;m_pDatabase-&gt;m_pWorkspace-&gt;BeginTrans( );
...
</CODE></PRE>

<H2><A NAME="_core_beyond_the_typical_scenario"></A>Beyond the Typical Scenario</H2>

<P>The typical scenario is not enough in some fairly rare cases. For a discussion of when you might need an explicit <A HREF="JavaScript:hhobj_19.Click()">CDaoWorkspace</A> object, see the article <A HREF="_core_dao_workspace.htm">DAO Workspace</A>.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao_workspace.3a_.managing_transactions.htm">DAO Workspace: Managing Transactions</A>, <A HREF="_core_dao_workspace.htm">DAO Workspace</A>, <A HREF="_core_dao_database.htm">DAO Database</A>, <A HREF="_core_dao.3a_.creating.2c_.opening.2c_.and_closing_dao_objects.htm">DAO: Creating, Opening, and Closing DAO Objects</A></P>
</font>
</BODY>
</HTML>
