<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO Recordset: Recordset Operations</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.AddNew">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.CanUpdate">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.AddNew">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetFieldDirty">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetFieldNull">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Update">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace.3a3a.CommitTrans">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.AddNew">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetFieldDirty">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetFieldNull">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Edit">
</OBJECT>
<OBJECT ID="hhobj_15" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.CanUpdate">
</OBJECT>
<OBJECT ID="hhobj_16" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Edit">
</OBJECT>
<OBJECT ID="hhobj_17" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_18" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetFieldNull">
</OBJECT>
<OBJECT ID="hhobj_19" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetFieldDirty">
</OBJECT>
<OBJECT ID="hhobj_20" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetFieldNull">
</OBJECT>
<OBJECT ID="hhobj_21" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Update">
</OBJECT>
<OBJECT ID="hhobj_22" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace.3a3a.CommitTrans">
</OBJECT>
<OBJECT ID="hhobj_23" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Edit">
</OBJECT>
<OBJECT ID="hhobj_24" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.CanUpdate">
</OBJECT>
<OBJECT ID="hhobj_25" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Delete">
</OBJECT>
<OBJECT ID="hhobj_26" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Delete">
</OBJECT>
<OBJECT ID="hhobj_27" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.IsDeleted">
</OBJECT>
<OBJECT ID="hhobj_28" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Close">
</OBJECT>
<OBJECT ID="hhobj_29" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_30" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Requery">
</OBJECT>
<OBJECT ID="hhobj_31" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Requery">
</OBJECT>
<OBJECT ID="hhobj_32" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.m_strFilter">
</OBJECT>
<OBJECT ID="hhobj_33" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.m_strSort">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_recordset.3a_.recordset_operations"></A>DAO Recordset: Recordset Operations</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article discusses several key recordset operations, particularly those involving updating records. Topics covered include:

<UL type=disc>
	<LI><A HREF="#_core_adding_new_records_in_dao">Adding new records</A><BR><BR></LI>

	<LI><A HREF="#_core_editing_existing_records_in_dao">Editing existing records</A><BR><BR></LI>

	<LI><A HREF="#_core_deleting_records_in_dao">Deleting records</A><BR><BR></LI>

	<LI><A HREF="#_core_requerying_in_dao">Requerying recordsets</A></LI>
</UL>

<P>For related information about using recordsets, see the following articles:

<UL type=disc>
	<LI><A HREF="_core_dao_queries.htm">DAO Queries</A><BR><BR></LI>

	<LI><A HREF="_core_dao.3a_.creating.2c_.opening.2c_.and_closing_dao_objects.htm">DAO: Creating, Opening, and Closing DAO Objects</A><BR><BR></LI>

	<LI><A HREF="_core_dao_recordset.3a_.creating_recordsets.htm">DAO Recordset: Creating Recordsets</A><BR><BR></LI>

	<LI><A HREF="_core_dao_recordset.3a_.recordset_navigation.htm">DAO Recordset: Recordset Navigation</A><BR><BR></LI>

	<LI><A HREF="_core_dao_recordset.3a_.bookmarks_and_record_positions.htm">DAO Recordset: Bookmarks and Record Positions</A><BR><BR></LI>

	<LI><A HREF="_core_dao_recordset.3a_.seeking_and_finding.htm">DAO Recordset: Seeking and Finding</A><BR><BR></LI>

	<LI><A HREF="_core_dao_recordset.3a_.binding_records_dynamically.htm">DAO Recordset: Binding Records Dynamically</A><BR><BR></LI>

	<LI><A HREF="_core_dao_recordset.3a_.caching_multiple_records_for_performance.htm">DAO Recordset: Caching Multiple Records for Performance</A><BR><BR></LI>

	<LI><A HREF="_core_dao_record_field_exchange_.28.dfx.29.htm">DAO Record Field Exchange (DFX)</A><BR><BR></LI>

	<LI><A HREF="_core_dao_recordset.3a_.using_aggregate_sql_functions_with_mfc_dao_classes.htm">DAO Recordset: Using Aggregate SQL Functions with MFC DAO Classes</A></LI>
</UL>

<P class=indent><B><B>Important&nbsp;&nbsp;&nbsp;</B></B>Your ability to update records requires that you have update permission for your database and that you have an updatable table-type or dynaset-type recordset. You can't update snapshot-type recordsets with the MFC DAO classes.</P>



<H2><A NAME="_core_adding_new_records_in_dao"></A>Adding New Records in DAO</H2>

<P>For general information about adding records in DAO, see the following topics in DAO Help:

<UL type=disc>
	<LI>Populating Recordsets and Counting Records with DAO<BR><BR></LI>

	<LI>AddNew Method<BR><BR></LI>

	<LI>Update Method</LI>
</UL>

<P>For information about where the new record appears and other considerations, see <A HREF="JavaScript:hhobj_3.Click()">CDaoRecordset::AddNew</A>. For information about the role of double buffering, see the article <A HREF="_core_dao_record_field_exchange.3a_.how_dfx_works.htm">DAO Record Field Exchange: How DFX Works</A>.</P>

<P class=label><B>To add a new record to a recordset</B>

<OL>
	<LI>Determine whether your recordset is updatable. 
<P class=tl>Call the recordset's <A HREF="JavaScript:hhobj_4.Click()">CanUpdate</A> member function.</P></LI>

	<LI>Call the recordset's <A HREF="JavaScript:hhobj_5.Click()">AddNew</A> member function.
<P class=tl>The fields of the new recordset, represented by the recordset's edit buffer (the recordset’s data members), are initially all Null. <B>AddNew</B> prepares the MFC recordset's edit buffer, which DAO calls the copy buffer. For more information about the edit buffer with <B>AddNew</B>, see the article <A HREF="_core_dao_record_field_exchange.3a_.how_dfx_works.htm">DAO Record Field Exchange: How DFX Works</A>.</P></LI>

	<LI>Assign values to the new record's fields.
<P class=tl>If you're using a <A HREF="JavaScript:hhobj_6.Click()">CDaoRecordset</A>-derived class with DFX, assign values to the fields. If you have double buffering turned off, make the following two calls for each field you assign a value to:</P>
<UL type=disc>
	<LI><A HREF="JavaScript:hhobj_7.Click()">SetFieldDirty</A><BR><BR></LI>

	<LI><A HREF="JavaScript:hhobj_8.Click()">SetFieldNull</A> with the parameter <B>FALSE</B> (meaning “not Null”).</LI>
</UL>

<P class=tl>Or, if you explicitly want the field to be Null, call only <B>SetFieldNull</B>, with the parameter <B>TRUE</B>.</P></LI>

	<LI>Complete the process by calling the recordset's <A HREF="JavaScript:hhobj_9.Click()">Update</A> member function.
<P class=tl><B>Update</B> adds the record. If no transaction is in effect, the change takes place immediately. Otherwise, the change takes place when you call <A HREF="JavaScript:hhobj_10.Click()">CDaoWorkspace::CommitTrans</A>.</P></LI>
</OL>

<P>If you move to another record without calling <B>Update</B>, the change is lost. For more information, see <A HREF="JavaScript:hhobj_11.Click()">AddNew</A>.</P>



<H2><A NAME="_core_editing_existing_records_in_dao"></A>Editing Existing Records in DAO</H2>

<P>For general information about editing records in DAO, see the following topics in DAO Help:

<UL type=disc>
	<LI>Edit Method<BR><BR></LI>

	<LI>Update Method</LI>
</UL>

<P>If you have double buffering turned on, MFC maintains a copy of the edit buffer so it can detect changes to the recordset fields for you. You don't have to call <A HREF="JavaScript:hhobj_12.Click()">SetFieldDirty</A> and <A HREF="JavaScript:hhobj_13.Click()">SetFieldNull</A> (passing <B>FALSE</B>) for each change. For more information, see the article <A HREF="_core_dao_record_field_exchange.3a_.double_buffering_records.htm">DAO Record Field Exchange: Double Buffering Records</A>.</P>

<P>For details about what <B>Edit</B> does and about the role of double buffering, see <A HREF="JavaScript:hhobj_14.Click()">CDaoRecordset::Edit</A> and the article <A HREF="_core_dao_record_field_exchange.3a_.how_dfx_works.htm">DAO Record Field Exchange: How DFX Works</A>. </P>

<P class=label><B>To edit an existing record in a recordset</B>

<OL>
	<LI>Determine whether your recordset is updatable. 
<P class=tl>Call the recordset's <A HREF="JavaScript:hhobj_15.Click()">CanUpdate</A> member function.</P></LI>

	<LI>Move to the record you want to edit. 
<P class=tl>Use any of the recordset's navigation mechanisms that take you to a specific record.</P></LI>

	<LI>Call the recordset's <A HREF="JavaScript:hhobj_16.Click()">Edit</A> member function.
<P class=tl><B>Edit</B> prepares the recordset's edit buffer, which DAO calls the copy buffer. For more information about the edit buffer with <B>Edit</B>, see the article <A HREF="_core_dao_record_field_exchange.3a_.how_dfx_works.htm">DAO Record Field Exchange: How DFX Works</A>.</P></LI>

	<LI>Assign values to the fields you want to change.
<P class=tl>If you're using a <A HREF="JavaScript:hhobj_17.Click()">CDaoRecordset</A>-derived class with DFX, assign values to the fields. To give a field the value Null, call <A HREF="JavaScript:hhobj_18.Click()">SetFieldNull</A> (passing <B>TRUE</B>). If you have double buffering turned off, call <A HREF="JavaScript:hhobj_19.Click()">SetFieldDirty</A> and <A HREF="JavaScript:hhobj_20.Click()">SetFieldNull</A> (passing <B>FALSE</B>) for each field you assign a value to.</P></LI>

	<LI>Complete the process by calling the recordset's <A HREF="JavaScript:hhobj_21.Click()">Update</A> member function.
<P class=tl>Update changes the record in the database. If no transaction is in effect, the change takes place immediately. Otherwise, the change takes place when you call <A HREF="JavaScript:hhobj_22.Click()">CDaoWorkspace::CommitTrans</A>.</P></LI>
</OL>

<P>If you move to another record without calling <B>Update</B>, the change is lost. For more information, see <A HREF="JavaScript:hhobj_23.Click()">Edit</A>. For information about double buffering, see the article <A HREF="_core_dao_record_field_exchange.3a_.double_buffering_records.htm">DAO Record Field Exchange: Double Buffering Records</A>.</P>



<H2><A NAME="_core_deleting_records_in_dao"></A>Deleting Records in DAO</H2>

<P>For general information about deleting records in DAO, see the topic "Delete Method" in DAO Help.</P>

<P class=label><B>To delete a record from a recordset</B>

<OL>
	<LI>Determine whether your recordset is updatable. 
<P class=tl>Call the recordset's <A HREF="JavaScript:hhobj_24.Click()">CanUpdate</A> member function.</P></LI>

	<LI>Move to the record you want to edit. 
<P class=tl>Use any of the recordset's navigation mechanisms that take you to a specific record.</P></LI>

	<LI>Call the recordset's <A HREF="JavaScript:hhobj_25.Click()">Delete</A> member function.
<P class=tl>You don't call <B>Update</B> for a deletion.</P></LI>

	<LI>Move to another record before you attempt any other recordset operations.</LI>
</OL>

<P>In table-type and dynaset-type recordset objects, <B>Delete</B> removes the current record and makes it inaccessible. Although you can't edit or use the deleted record, it remains current. Once you move to another record, however, you can’t make the deleted record current again. Subsequent references to a deleted record in a recordset are invalid and cause an exception to be thrown. For more information, see <A HREF="JavaScript:hhobj_26.Click()">Delete</A>. You can tell whether you’re on a deleted record by calling <A HREF="JavaScript:hhobj_27.Click()">IsDeleted</A>.</P>



<H2><A NAME="_core_requerying_in_dao"></A>Requerying in DAO</H2>

<P>If you need to re-run a recordset query, perhaps with new parameter values each time, you can do either of the following:

<UL type=disc>
	<LI>Call <A HREF="JavaScript:hhobj_28.Click()">Close</A> to close the recordset, reset any parameters or other properties, and call <A HREF="JavaScript:hhobj_29.Click()">Open</A> again.<BR><BR></LI>

	<LI>Reset any parameters or other properties, then call <A HREF="JavaScript:hhobj_30.Click()">Requery</A>.</LI>
</UL>

<P>The purpose of either approach to requerying the recordset is to refresh the recordset by running its query again, perhaps with changed parameters or properties. You can also requery to refresh results in a multi-user environment (multiple users or recordsets modifying the same data). In general, <B>Requery</B> is somewhat more efficient than <B>Close</B> and <B>Open</B>, but see the Important note below.</P>

<P>This description of the use and behavior of <A HREF="JavaScript:hhobj_31.Click()">Requery</A> is exactly as in DAO. But MFC adds one feature: your ability to change the recordset’s <A HREF="JavaScript:hhobj_32.Click()">m_strFilter</A> and/or <A HREF="JavaScript:hhobj_33.Click()">m_strSort</A><B> </B>data members before you either call <B>Requery</B> or call <B>Open</B> again. If you do change either data member, MFC closes, then reopens the recordset. </P>

<P class=indent><B><B>Important&nbsp;&nbsp;&nbsp;</B></B>If you change <B>m_strFilter</B> or <B>m_strSort</B>, you lose the performance benefit of <B>Requery</B>. In this case, calling <B>Requery</B> performs no better than calling <B>Close</B> and <B>Open</B>.</P>

<P>For more information, see <B>Requery</B> in the <I>Class Library Reference</I>, and see the topic "Requery Method" in DAO Help.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao_recordset.htm">DAO Recordset</A></P>
</font>
</BODY>
</HTML>
