<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ISAPI: Extending Web Servers</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CHttpServer.3a3a.OnParseError">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_isapi.3a_.extending_web_servers"></A>ISAPI: Extending Web Servers</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_internet_support.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_internet_tasks.htm">How Do I</A></P>

<P>This article describes some of the tasks you can perform with ISAPI Web server extensions, and how MFC supports writing them. Topics included in this article are:

<UL type=disc>
	<LI><A HREF="#_core_how_does_isapi_make_it_easier_to_create_internet_server_applications.3f">How Does ISAPI Make it Easier to Create Internet Server Applications?</A><BR><BR></LI>

	<LI><A HREF="#_core_advantages_of_using_mfc_to_create_internet_server_applications">Advantages of Using MFC to Create Internet Server Applications</A><BR><BR></LI>

	<LI><A HREF="#_core_what_can_i_do_with_isapi.3f">What Can I Do With ISAPI?</A></LI>
</UL>

<H2><A NAME="_core_how_does_isapi_make_it_easier_to_create_internet_server_applications.3f"></A>How Does ISAPI Make it Easier to Create Internet Server Applications?</H2>

<P>You can use ISAPI to write database applications, such as an order entry system or a custom catalog. You can collect information from a user with an HTML form, and send back another HTML page customized for the user. ISAPI server extensions provide similar functionality to CGI applications. For a comparison of the two methods, see <A HREF="_core_how_does_isapi_compare_with_cgi.3f.htm">How Does ISAPI Compare with CGI?</A></P>

<P>A convenient feature of the World Wide Web is that you don't have to install your code on the client machine to run your application. This makes upgrading easy. To run an ISAPI server extension DLL, a user types a URL in a browser, for example, <CODE>http://myserver/register.dll?</CODE>. The DLL runs on the server and sends the HTML data back to the client.</P>

<P>To add an updated DLL with new features, you stop the Web server service, replace the old DLL with your new version in its shared location on the server, and restart the service. The next client request will load the latest version. This process makes it easy to add new functionality, and you upgrade only one computer instead of many.</P>

<H2><A NAME="_core_advantages_of_using_mfc_to_create_internet_server_applications"></A>Advantages of Using MFC to Create Internet Server Applications</H2>

<P>Visual C++ includes the ISAPI Extension Wizard to help you create ISAPI filters and servers. This wizard is one of the choices available on the Project tab in the New dialog box, which appears when you create a new project in the development environment. For more information about establishing a new project using wizards, see <A HREF="_core_visual_c.2b2b_.wizards_that_help_you_begin_your_program.htm">Visual C++ Wizards that Help You Begin Your Program</A>.</P>

<P>The ISAPI Extension Wizard makes it simple to generate a filter or a server extension. You can choose how (or if) to link to MFC; whether to have a filter, a server, or both; what filter notifications to handle at what priority; and whether the filter should get secured or unsecured notifications or both. After the project is generated, you add custom functionality and create parse maps.</P>

<H2>Error Handling</H2>

<P>MFC adds failure protection beyond any provided by the server. MFC handles the returning of appropriate HTTP errors to the client (for example, bad request). For a list of some common HTTP return codes, see <A HREF="_core_internet_first_steps.3a_.http.htm">Internet First Steps: HTTP</A>. To handle error conditions in your program, see <A HREF="JavaScript:hhobj_2.Click()">CHttpServer::OnParseError</A>.</P>

<H2>Forms Processing and Parse Maps</H2>

<P>HTML-based forms are used to collect information from the user. This information is sent to your server via a URL that includes the name of your ISAPI DLL and a list of parameters, based on the information the user entered in the form. MFC makes parsing of these parameters easy: You write the function, declare its parameters, and use <A HREF="_core_isapi_extensions.3a_.parse_maps.htm">parse map macros</A> to hook the command line arguments to your function parameters, including optional and default arguments. When a client invokes your server, MFC extracts the arguments and calls your function. MFC also returns results back to the client.</P>

<H2><A NAME="_core_what_can_i_do_with_isapi.3f"></A>What Can I Do With ISAPI?</H2>

<P>The following table lists some tasks you can perform using <A HREF="_core_isapi_extensions.3a_.servers.htm">ISAPI server extensions</A> and <A HREF="_core_isapi_extensions.3a_.filters.htm">ISAPI filters</A>.</P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=50%><B>I want to:</B></TD>
<TD class=label width=50%><B>Use a server extension to:</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Count users of my application.</TD>
<TD width=50%>Log information.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Write an order entry system.</TD>
<TD width=50%>Process an HTML form that is filled out at the client and processed on the server. Consider using DB Connector, a part of Internet Information Server, for simple data processing, and ISAPI for full database access.</TD>
</TR>
</TABLE><BR>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=50%><B>I want to:</B></TD>
<TD class=label width=50%><B>Use a filter to:</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Count visitors to my server.</TD>
<TD width=50%>Request <B>SF_NOTIFY_LOG</B> notification.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Do custom encryption.</TD>
<TD width=50%><B>SF_NOTIFY_READ_RAW_DATA, SF_NOTIFY_WRITE_RAW_DATA</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Do custom compression.</TD>
<TD width=50%><B>SF_NOTIFY_READ_RAW_DATA, SF_NOTIFY_WRITE_RAW_DATA</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Read raw data.</TD>
<TD width=50%><B>SF_NOTIFY_READ_RAW_DATA</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Process header information.</TD>
<TD width=50%>Call <B>GetServerVariable</B>.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Authenticate a user.</TD>
<TD width=50%>Create a filter with high priority notification request, <B>SF_NOTIFY_AUTHENTICATION</B>.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Log requests from a certain user, or requests containing key words.</TD>
<TD width=50%>Request <B>SF_NOTIFY_URL_MAP</B> notification.</TD>
</TR>
</TABLE><BR>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_internet.3a_.where_is.......htm">Internet: Where Is...</A></P>
</font>
</BODY>
</HTML>
