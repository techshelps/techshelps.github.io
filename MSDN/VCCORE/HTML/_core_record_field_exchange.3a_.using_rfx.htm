<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Record Field Exchange: Using RFX</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll Tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CRecordset">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.DoFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CFieldExchange.3a3a.SetFieldType">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.m_nParams">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.m_nFields">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.Move">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_Macros.2c_.Global_Functions.2c_.and_Global_Variables">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_record_field_exchange.3a_.using_rfx"></A>Record Field Exchange: Using RFX</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains what you do to use RFX in relation to what the framework does.</P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>This article applies to classes derived from <A HREF="JavaScript:hhobj_3.Click()">CRecordset</A> in which bulk row fetching has not been implemented. If you are using bulk row fetching, then bulk record field exchange (Bulk RFX) is implemented. Bulk RFX is similar to RFX. To understand the differences, see the article <A HREF="_core_recordset.3a_.fetching_records_in_bulk_.28.odbc.29.htm">Recordset: Fetching Records in Bulk (ODBC)</A>.</P>

<P>The following articles contain related information:

<UL type=disc>
	<LI><A HREF="_core_record_field_exchange.3a_.working_with_the_wizard_code.htm">Record Field Exchange: Working with the Wizard Code</A> introduces the main components of RFX and explains the code that AppWizard and ClassWizard write to support RFX and how you might want to modify the wizard code.<BR><BR></LI>

	<LI><A HREF="_core_record_field_exchange.3a_.using_the_rfx_functions.htm">Record Field Exchange: Using the RFX Functions</A> explains writing calls to the RFX functions in your <B>DoFieldExchange</B> override.</LI>
</UL>

<P>The following table shows your role in relation to what the framework does for you.</P>

<P class=label><B><A NAME="_core_using_rfx.3a_.you_and_the_framework"></A>Using RFX: You and the Framework</B></P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=45%><B>You...</B></TD>
<TD class=label width=55%><B>The framework...</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%>Declare your recordset classes with ClassWizard. Specify names and data types of field data members.</TD>
<TD width=55%>ClassWizard derives a <B>CRecordset</B> class and writes a <A HREF="JavaScript:hhobj_4.Click()">DoFieldExchange</A> override for you, including an RFX function call for each field data member.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>(Optional) Manually add any needed <A HREF="_core_recordset.3a_.architecture_.28.odbc.29.htm#_core_parameter_data_members">parameter data members</A> to the class. Manually add an RFX function call to <B>DoFieldExchange</B> for each parameter data member, add a call to <A HREF="JavaScript:hhobj_5.Click()">CFieldExchange::SetFieldType</A> for the group of parameters, and specify the total number of parameters in <A HREF="JavaScript:hhobj_6.Click()">m_nParams</A>. See <A HREF="_core_recordset.3a_.parameterizing_a_recordset_.28.odbc.29.htm">Recordset: Parameterizing a Recordset (ODBC)</A>. </TD>
<TD width=55%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>(Optional) Manually bind additional columns to field data members. Manually increment <A HREF="JavaScript:hhobj_7.Click()">m_nFields</A>. See <A HREF="_core_recordset.3a_.dynamically_binding_data_columns_.28.odbc.29.htm">Recordset: Dynamically Binding Data Columns (ODBC)</A>. </TD>
<TD width=55%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>Construct an object of your recordset class. Before using the object, set the values of its parameter data members, if any.</TD>
<TD width=55%>For efficiency, the framework prebinds the parameters, using ODBC. When you pass parameter values, the framework passes them to the data source. Only the parameter values are sent for requeries, unless the sort and/or filter strings have changed. </TD>
</TR>

<TR VALIGN="top">
<TD width=45%>Open a recordset object using <A HREF="JavaScript:hhobj_8.Click()">CRecordset::Open</A>. </TD>
<TD width=55%>Executes the recordset’s query, binds columns to field data members of the recordset, and calls <B>DoFieldExchange</B> to exchange data between the first selected record and the recordset’s field data members. </TD>
</TR>

<TR VALIGN="top">
<TD width=45%>Scroll in the recordset using <A HREF="JavaScript:hhobj_9.Click()">CRecordset::Move</A> or a menu or toolbar command. </TD>
<TD width=55%>Calls <B>DoFieldExchange</B> to transfer data to the field data members from the new current record.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>Add, update, and delete records.</TD>
<TD width=55%>Calls <B>DoFieldExchange</B> to transfer data to the data source.</TD>
</TR>
</TABLE><BR>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_record_field_exchange.3a_.how_rfx_works.htm">Record Field Exchange: How RFX Works</A>, <A HREF="_core_recordset.3a_.obtaining_sums_and_other_aggregate_results_.28.odbc.29.htm">Recordset: Obtaining SUMs and Other Aggregate Results (ODBC)</A>, <A HREF="JavaScript:hhobj_10.Click()">CRecordset</A>, <A HREF="JavaScript:hhobj_11.Click()">CFieldExchange</A>, <A HREF="JavaScript:hhobj_12.Click()">Macros and Globals</A> </P>
</font>
</BODY>
</HTML>
