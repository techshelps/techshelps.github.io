<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO Recordset: Creating Recordsets</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.GetDefaultSQL">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.GetDefaultSQL">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Open">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_recordset.3a_.creating_recordsets"></A>DAO Recordset: Creating Recordsets</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains the process of creating recordset objects based either on class <A HREF="JavaScript:hhobj_3.Click()">CDaoRecordset</A> itself or on a class derived from <B>CDaoRecordset</B>.</P>

<P>You can use recordset objects in two ways:

<UL type=disc>
	<LI>Create recordsets directly from class <B>CDaoRecordset</B> and bind record fields dynamically.
<P class=tl>For information about why and how to bind records dynamically, see the article <A HREF="_core_dao_recordset.3a_.binding_records_dynamically.htm">DAO Recordset: Binding Records Dynamically</A>.</P></LI>

	<LI>Use AppWizard or ClassWizard to derive your own custom recordset class from <A HREF="JavaScript:hhobj_4.Click()">CDaoRecordset</A> and use DAO Record Field Exchange (DFX) to manage binding record data to recordset class field data members.
<P class=tl>For information about deriving recordset classes with the wizards, see the articles <A HREF="_core_overview.3a_.creating_a_program_that_supports_a_database.htm">Overview: Creating a Program That Supports a Database</A> and <A HREF="_core_classwizard.3a_.creating_a_recordset_class.htm">ClassWizard: Creating a Recordset Class</A>.</P>
<P class=tl>For information about using DFX, see the article <A HREF="_core_dao_record_field_exchange_.28.dfx.29.htm">DAO Record Field Exchange (DFX)</A>.</P></LI>
</UL>

<P>In either case, you can base your recordset objects on a query defined by a <A HREF="JavaScript:hhobj_5.Click()">CDaoQueryDef</A> object or a <A HREF="JavaScript:hhobj_6.Click()">CDaoTableDef</A> object, or you can specify the recordset objects’ SQL strings either at design time, when you create the class with a wizard, or at run time, when you pass a string containing an SQL statement to the <A HREF="JavaScript:hhobj_7.Click()">CDaoRecordset::Open</A> member function.</P>

<P>The following table describes the characteristics of a recordset, depending on how you create it:</P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=45%><B>If you base your recordset on...</B></TD>
<TD class=label width=55%><B>It has these characteristics...</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%>A querydef</TD>
<TD width=55%>The recordset inherits the querydef’s SQL string.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>A tabledef</TD>
<TD width=55%>The recordset (a table-type recordset) is based on the table. Creating a recordset from a tabledef is similar to creating one from a querydef. See the following procedure for creating from a querydef.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>The SQL string specified at design time, in the wizard</TD>
<TD width=55%>The recordset uses the SQL string retrieved by calling its <A HREF="JavaScript:hhobj_8.Click()">GetDefaultSQL</A> member function. The wizard codes the string as the value returned by this function.</TD>
</TR>

<TR VALIGN="top">
<TD width=45%>An SQL string specified at run time, in the <B>Open</B> call</TD>
<TD width=55%>The SQL string passed to <B>Open</B> overrides the SQL defined at design time.</TD>
</TR>
</TABLE><BR>

<P>The following procedure shows how to use a querydef as the basis for a recordset. Using a tabledef to create a recordset is similar.</P>

<P class=label><B>To create a recordset from a querydef</B>

<OL>
	<LI>Create the querydef, as described in <A HREF="_core_dao_queries.htm#_core_creating_a_query_with_a_querydef">Creating a Query with a Querydef</A>, or use an existing querydef object.<BR><BR></LI>

	<LI>Construct a <A HREF="JavaScript:hhobj_9.Click()">CDaoRecordset</A> object.<BR><BR></LI>

	<LI>Call the recordset object's <A HREF="JavaScript:hhobj_10.Click()">Open</A> member function, passing a pointer to the querydef object.</LI>
</OL>

<P>Opening the recordset runs the query, using the SQL statement defined by the querydef.</P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>You can only create a dynaset-type or snapshot-type recordset from a querydef.</P>

<P>The following code shows the process of creating a recordset from a querydef:</P>

<PRE><CODE>// pdb is a pointer to an open CDaoDatabase object
try
{
    // Construct the querydef
    CDaoQueryDef qd( pdb );

    // Set up the SQL string and create the querydef
    CString strSQL = 
      _T(“SELECT [Company Name] FROM Publishers WHERE State = ‘NY’”);
    qd.Create( _T(“My Querydef”), strSQL );

    // Construct a CDaoRecordset-derived object
    // and open it based on the querydef
    CPublisherSet rsPub( pdb );
    rsPub.Open( &amp;qd );
}
catch( CDaoException* e )
// ...
</CODE></PRE>

<P class=label><B>To create a recordset without a querydef</B>

<OL>
	<LI>Construct a <A HREF="JavaScript:hhobj_11.Click()">CDaoRecordset</A> object.<BR><BR></LI>

	<LI>Call the recordset object's <A HREF="JavaScript:hhobj_12.Click()">Open</A> member function. Specify an SQL string, or rely on the one that the wizard creates.</LI>
</OL>

<P>For an example in code, see the article <A HREF="#_core_dao_recordset.3a_.creating_recordsets">DAO Recordset: Creating Recordsets</A>.</P>

<P>The SQL statement for the recordset is one of the following:

<UL type=disc>
	<LI>The default SQL string that you established when you created the recordset class using AppWizard or ClassWizard. If you pass <B>NULL</B> for the <I>lpszSQL</I> parameter to <B>Open</B>, the recordset uses the default SQL string. The recordset obtains the default SQL string by calling its own <A HREF="JavaScript:hhobj_13.Click()">GetDefaultSQL</A> member function. The default SQL string is coded as the value returned by that function rather than being stored in a data member.<BR><BR></LI>

	<LI>An SQL string that you pass in your call to <B>Open</B>. This string overrides the default SQL string defined in the recordset class. </LI>
</UL>

<P>In either case, your SQL string can consist of any of the following:

<UL type=disc>
	<LI>A <B>SELECT</B> statement of the basic form:
<PRE><CODE>SELECT <I>column-list</I> FROM <I>table-list</I>
</CODE></PRE>
</LI>

	<LI>One or more tabledef and/or querydef names, separated by commas, which base the query on tables and/or queries. This list is usually based on choices you made with one of the wizards. The query selects all columns (fields) in the tables/queries, unless you modify it.</LI>
</UL>

<P>For details, see <A HREF="JavaScript:hhobj_14.Click()">CDaoRecordset::Open</A>. For related information, see the topic "Recordset Object" in DAO Help.</P>

<P>For information about SQL, see the topic "SQL Property" in DAO Help.</P>

<P>For information about the SQL syntax used by DAO, see the topic "Comparison of Microsoft Jet Database Engine SQL and ANSI SQL" in DAO Help.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao_recordset.htm">DAO Recordset</A>, <A HREF="_core_dao_querydef.htm">DAO Querydef</A>, <A HREF="_core_dao_record_field_exchange_.28.dfx.29.htm">DAO Record Field Exchange (DFX)</A>, <A HREF="_core_dao_queries.3a_.sql_for_dao.htm">DAO Queries: SQL for DAO</A>, <A HREF="_core_dao_queries.htm">DAO Queries</A></P>
</font>
</BODY>
</HTML>
