<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Prepare the MFC DLL for Use</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_begin_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="MFC Samples">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfcnotes_tn033">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="building">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_prepare_the_mfc_dll_for_use"></A>Prepare the MFC DLL for Use</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_overview.3a_.creating_an_mfc_dll.htm">Overview</A>  |&nbsp; <A HREF="_core_create_an_mfc_dll_with_appwizard.htm">How Do I</A>  |&nbsp; <A HREF="_core_details.3a_.beginning_your_program.htm">Details</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Sample</A></P>

<P class=label><B>To prepare the MFC DLL for use</B>

<OL>
	<LI>Add code to the starter code generated by AppWizard.<BR><BR></LI>

	<LI>Make sure you have exported the entry points to your DLL by using either the <B>__declspec(dllexport)</B> keyword or by listing the functions in the DLL’s .DEF file. If exporting C++ classes, you may want to use the <B>AFX_EXT_CLASS</B> macro.<BR><BR></LI>

	<LI>Prepare a header (.H) file to include in the programs using your DLL. This header file must contain the declarations of the exported functions and/or exported C++ classes. Use the <B>__declspec(dllimport)</B> keyword on the declarations of the exported functions and C++ classes in this header file. The compiler produces more efficient code with <B>__declspec(dllimport)</B>. See <A HREF="JavaScript:hhobj_3.Click()">Technote 33</A> on exporting functions and classes from an MFC DLL.<BR><BR></LI>

	<LI>Build the DLL.<BR><BR></LI>

	<LI>If applications will be linking to your DLL implicitly, provide an import library for the applications to link to.</LI>
</OL>

<P>When you build your DLL, the linker also builds an import library for you. This library has the same base name as your DLL, but has the extension .LIB. You may want to provide both a debug and retail (/release) version of your DLL. This permits client programs to build both debug and retail versions of their applications and link them with the appropriate debug or retail version of all DLLs.</P>

<P>If you are building an application that implicitly links to a DLL, add the import library to the <B>Object/library modules</B> text box on the <B>Link</B> tab in the <B>Project Settings</B> dialog box. Make sure you put the debug version of the import library in the debug settings and the release version in the release settings. The only other change you must make is to add the include file for the DLL to any source files that call the DLL’s exported functions.</P>

<H3>What do you want to do?</H3>

<UL type=disc>
	<LI><A HREF="_core_add_code_to_the_mfc_dll_starter_files.htm">Add code to the AppWizard’s starter files for MFC DLLs</A><BR><BR></LI>

	<LI><A HREF="_core_dlls.3a_.overview.htm">Learn more about DLLs</A><BR><BR></LI>

	<LI><A HREF="_core_export_from_a_dll.htm">Export from a DLL</A><BR><BR></LI>

	<LI><A HREF="_core_link_an_executable_to_a_dll.htm">Link an executable to a DLL</A><BR><BR></LI>

	<LI><A HREF="_core_initialize_a_dll.htm">Initialize a DLL</A><BR><BR></LI>

	<LI><A HREF="JavaScript:hhobj_4.Click()">Learn how to build my program</A><BR><BR></LI>

	<LI><A HREF="_core_updating_dependencies_in_a_project.htm">Learn about updating dependencies in a project</A></LI>
</UL>
</font>
</BODY>
</HTML>
