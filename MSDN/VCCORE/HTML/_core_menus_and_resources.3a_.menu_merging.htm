<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Menus and Resources: Menu Merging</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_Menu_Creation">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_menus_and_resources.3a_.menu_merging"></A>Menus and Resources: Menu Merging</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_ole_in_mfc.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_ole_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_ole_sample_list.htm">Sample</A>  |&nbsp; <A HREF="_core_ole_tutorial_list.htm">Tutorial</A></P>

<P>This article details the steps necessary for OLE document applications to handle visual editing and in-place activation properly. In-place activation poses a challenge for both container and server (component) applications. The user remains in the same frame window (within the context of the container document), but is actually running another application, the server. This requires coordination between the resources of the container and server applications.</P>

<P>Topics covered in this article include:

<UL type=disc>
	<LI><A HREF="#_core_menu_layouts">Menu layouts</A><BR><BR></LI>

	<LI><A HREF="#_core_toolbars_and_status_bars">Toolbars and status bars</A></LI>
</UL>



<H2><A NAME="_core_menu_layouts"></A>Menu Layouts</H2>

<P>The first step is to coordinate menu layouts.</P>

<P>For more information, see <A HREF="JavaScript:hhobj_2.Click()">Menu Creation</A> in the Win32 SDK.</P>

<P>Container applications should create a new menu to be used only when embedded items are activated in place. At the minimum, this menu should consist of the following, in the order listed:

<OL>
	<LI>File menu identical to the one used when files are open. (Usually no other menu items are placed before the next item.)<BR><BR></LI>

	<LI>Two consecutive separators.<BR><BR></LI>

	<LI>Window menu identical to the one used when files are open (only if the container application in an MDI application). Some applications may have other menus, such as an Options menu, that belong in this group, which remains on the menu when an embedded item is activated in place.</LI>
</OL>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;There may be other menus that affect the view of the container document, such as Zoom. These container menus appear between the two separators in this menu resource.</P>

<P>Server (component) applications should also create a new menu specifically for in-place activation. It should be like the menu used when files are open, but without menu items, such as File and Window that manipulate the server document instead of the data. Typically, this menu consists of the following:

<OL>
	<LI>Edit menu identical to the one used when files are open.<BR><BR></LI>

	<LI>Separator.<BR><BR></LI>

	<LI>Object editing menus, such as the Pen menu in the Scribble tutorial application.<BR><BR></LI>

	<LI>Separator.<BR><BR></LI>

	<LI>Help menu.</LI>
</OL>

<P>For an example, look at the layout of some sample in-place menus for a container and a server. The details of each menu item have been removed to make the example clearer. The container’s in-place menu has the following entries:</P>

<PRE><CODE>IDR_CONTAINERTYPE_CNTR_IP MENU PRELOAD DISCARDABLE 
BEGIN
    POPUP "&amp;File C1"
    MENUITEM SEPARATOR
    POPUP "&amp;Zoom C2"
    MENUITEM SEPARATOR
    POPUP "&amp;Options C3"
    POPUP "&amp;Window C3"
END
</CODE></PRE>

<P>The consecutive separators indicate where the first part of the server’s menu should go. Now look at the server’s in-place menu:</P>

<PRE><CODE>IDR_SERVERTYPE_SRVR_IP MENU PRELOAD DISCARDABLE 
BEGIN
    POPUP "&amp;Edit S1"
    MENUITEM SEPARATOR
    POPUP "&amp;Format S2"
    MENUITEM SEPARATOR
    POPUP "&amp;Help S3"
END
</CODE></PRE>

<P>The separators here indicate where the second group of container menu items should go. The resulting menu structure when an object from this server is activated in place inside this container looks like this:</P>

<PRE><CODE>BEGIN
    POPUP "&amp;File C1"
    POPUP "&amp;Edit S1"
    POPUP "&amp;Zoom C2"
    POPUP "&amp;Format S2"
    POPUP "&amp;Options C3
    POPUP "&amp;Window C3"
    POPUP "&amp;Help S3"
END
</CODE></PRE>

<P>As you can see, the separators have been replaced with the different groups of each application’s menu.</P>

<P>Accelerator tables associated with the in-place menu should also be supplied by the server application. The container will incorporate them into its own accelerator tables.</P>

<P>When an embedded item is activated in place, the framework loads the in-place menu. It then asks the server application for its menu for in-place activation and inserts it where the separators are. This is how the menus combine. You get menus from the container for operating on the file and window placement, and you get menus from the server for operating on the item.</P>



<H2><A NAME="_core_toolbars_and_status_bars"></A>Toolbars and Status Bars</H2>

<P>Server applications should create a new toolbar and store its bitmap in a separate file. AppWizard-generated applications store this bitmap in a file called ITOOLBAR.BMP. The new toolbar replaces the container application’s toolbar when your server’s item is activated in place, and should contain the same items as your normal toolbar, but remove icons representing items on the File and Window menus.</P>

<P>This toolbar is loaded in your <B>COleIPFrameWnd</B>-derived class, created for you by AppWizard. The status bar is handled by the container application. For more information on the implementation of in-place frame windows, see the article <A HREF="_core_servers.3a_.implementing_a_server.htm">Servers: Implementing a Server</A>. </P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_activation.htm">Activation</A>, <A HREF="_core_servers.htm">Servers</A>, <A HREF="_core_containers.htm">Containers</A> </P>
</font>
</BODY>
</HTML>
