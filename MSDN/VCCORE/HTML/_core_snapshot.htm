<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Snapshot</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Open">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_snapshot"></A>Snapshot</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>A snapshot is a recordset that reflects a static view of the data as it existed at the time the snapshot was created. Once you open the snapshot and move to all the records, the set of records it contains and their values don’t change until you rebuild the snapshot by calling <B>Requery</B>. </P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>This article applies to the MFC ODBC classes. If you’re using the MFC DAO classes instead of the MFC ODBC classes, see <A HREF="JavaScript:hhobj_3.Click()">CDaoRecordset::Open</A> for a description of snapshot-type recordsets. Also see the article <A HREF="_core_dao_recordset.3a_.creating_recordsets.htm">DAO Recordset: Creating Recordsets</A>.</P>

<P>You can create updatable or read-only snapshots with the database classes. Unlike a dynaset, an updatable snapshot doesn’t reflect changes to record values made by other users, but does reflect updates and deletions made by your program. Records added to a snapshot don’t become visible to the snapshot until you call <B>Requery</B>.</P>

<P class=indent><B><B>Tip&nbsp;&nbsp;&nbsp;</B></B>A snapshot is an ODBC “static cursor.” Static cursors don’t actually get a row of data until you scroll to that record. To ensure that all records are immediately retrieved, you can scroll to the end of your recordset, then scroll to the first record you’re interested in. Note, however, that scrolling to the end entails extra overhead and can lower performance.</P>

<P>Snapshots are most valuable when you need the data to remain fixed during your operations, as when you’re generating a report or performing calculations. Even so, the data source can diverge considerably from your snapshot, so you may want to rebuild it from time to time.</P>

<P>Snapshot support is based on the ODBC Cursor Library, which provides static cursors and positioned updates (needed for updatability) for any Level 1 driver. The cursor library DLL must be loaded in memory for this support. When you construct a <B>CDatabase</B> object and call its <B>OpenEx</B> member function, you must specify the <B>CDatabase::useCursorLib</B> option of the <I>dwOptions</I> parameter. If you call the <B>Open</B> member function, then the cursor library is loaded by default. Note that if you are using dynasets instead of snapshots, you do <I>not</I> want to cause the cursor library to be loaded.</P>

<P>Snapshots are available only if the ODBC Cursor Library was loaded when the <B>CDatabase</B> object was constructed or the ODBC driver you’re using supports static cursors.</P>

<P class=indent><B><B>Important&nbsp;&nbsp;&nbsp;</B></B>For some ODBC drivers, snapshots (static cursors) may not be updatable. Check your driver documentation for cursor types supported and the concurrency types they support. To guarantee updatable snapshots, make sure you load the cursor library into memory when you create a <B>CDatabase</B> object. See the article <A HREF="_core_odbc.3a_.the_odbc_cursor_library.htm">ODBC: The ODBC Cursor Library</A>. </P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>If you want to use both snapshots and dynasets, you must base them on two different <B>CDatabase</B> objects (two different connections).</P>

<P>For more information about the properties snapshots share with all recordsets, see the article <A HREF="_core_recordset_.28.odbc.29.htm">Recordset (ODBC)</A>. For more information about ODBC and snapshots<I>,</I> including the ODBC Cursor Library, see the article <A HREF="_core_odbc.htm">ODBC</A>. </P>
</font>
</BODY>
</HTML>
