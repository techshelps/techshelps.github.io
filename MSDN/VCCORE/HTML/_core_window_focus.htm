<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Window Focus</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_window_focus"></A><SUP></SUP>Window Focus</H1>

<P>In Win32, each thread of execution can set or get the focus only to windows created by the current thread. This prevents applications from interfering with each other. One application’s delay in responding cannot cause other applications to suspend their response to user actions, as often happens in Windows 3.<I>x</I>.</P>

<P>Consequently, the following API functions work differently under Win32:</P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD width=50%><B>GetActiveWindow( VOID )</B></TD>
<TD width=50%><B>SetActiveWindow( HWND )</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>GetCapture( VOID )</B></TD>
<TD width=50%><B>SetCapture( HWND )</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>GetFocus( VOID )</B></TD>
<TD width=50%><B>SetFocus( HWND )</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>ReleaseCapture( VOID )</B></TD>
<TD width=50%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P>The <B>Get</B> functions in the preceding list can now return NULL, which could not happen in Windows 3.<I>x</I>. Therefore, it’s important to test the return value of <B>GetFocus</B> before using it. Instead of returning the window handle of another thread, the function returns NULL. For example, you call <B>GetFocus</B> and another thread has the focus. Note that it’s possible for a call to <B>GetFocus</B> to return NULL even though an earlier call to <B>SetFocus</B> successfully set the focus. Similar considerations apply to <B>GetCapture</B> and <B>GetActiveWindow</B>.</P>

<P>The <B>Set</B> functions can only specify a window created by the current thread. If you attempt to pass a window handle created by another thread, the call to the <B>Set</B> function fails.</P>
</font>
</BODY>
</HTML>
