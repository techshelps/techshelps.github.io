<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Special CWinApp Services</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="MFC samples">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CWinApp">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CWinApp.3a3a.RegisterShellFileTypes">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CWinApp.3a3a.EnableShellOpen">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CWinApp">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CWnd">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CWnd.3a3a.DragAcceptFiles">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CWinApp">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CWinApp.3a3a.LoadStdProfileSettings">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_special_cwinapp_services"></A>Special CWinApp Services</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_mfc.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_mfc_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Sample</A>  |&nbsp; <A HREF="_core_mfc_tutorials_available.htm">Tutorial</A></P>

<P>Besides running the message loop and giving you an opportunity to initialize the application and clean up after it, <A HREF="JavaScript:hhobj_3.Click()">CWinApp</A> provides several other services.</P>



<H2><A NAME="_core_shell_registration"></A>Shell Registration</H2>

<P>By default, AppWizard makes it possible for the user to open data files that your application has created by double-clicking them in the Windows Explorer or File Manager. If your application is an MDI application and you specify an extension for the files your application creates, AppWizard adds calls to the <A HREF="JavaScript:hhobj_4.Click()">RegisterShellFileTypes</A> and <A HREF="JavaScript:hhobj_5.Click()">EnableShellOpen</A> member functions of <A HREF="JavaScript:hhobj_6.Click()">CWinApp</A> to the <CODE>InitInstance</CODE> override that it writes for you.</P>

<P><B>RegisterShellFileTypes</B> registers your application's document types with Windows Explorer or File Manager. The function adds entries to the registration database that Windows maintains. The entries register each document type, associate a file extension with the file type, specify a command line to open the application, and specify a dynamic data exchange (DDE) command to open a document of that type.</P>

<P><B>EnableShellOpen</B> completes the process by allowing your application to receive DDE commands from Windows Explorer or File Manager to open the file chosen by the user.</P>

<P>This automatic registration support in <B>CWinApp</B> eliminates the need to ship an .REG file with your application or to do special installation work.</P>



<H2><A NAME="_core_file_manager_drag_and_drop"></A>File Manager Drag and Drop</H2>

<P>Windows versions 3.1 and later allow the user to drag file names from the file view window in the File Manager (or Windows Explorer in Windows 95 and later and in Windows NT 4.0 and later) and drop them into a window in your application. You might, for example, allow the user to drag one or more filenames into an MDI application's main window, where the application could retrieve the file names and open MDI child windows for those files. </P>

<P>To enable file drag and drop in your application, AppWizard writes a call to the <A HREF="JavaScript:hhobj_7.Click()">CWnd</A> member function <A HREF="JavaScript:hhobj_8.Click()">DragAcceptFiles</A> for your main frame window in your <CODE>InitInstance</CODE>. You can remove that call if you do not want to implement the drag-and-drop feature.</P>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;You can also implement more general drag-and-drop capabilities — dragging data between or within documents — using OLE. For information, see the article <A HREF="_core_drag_and_drop_.28.ole.29.htm">Drag and Drop (OLE)</A>.</P>



<H2><A NAME="_core_keeping_track_of_the_most_recently_used_documents"></A>Keeping Track of the Most Recently Used Documents</H2>

<P>As the user opens and closes files, the application object keeps track of the four most recently used files. The names of these files are added to the File menu and updated when they change. The framework stores these file names in either the registry or in the .INI file, with the same name as your project and reads them from the file when your application starts up. The <CODE>InitInstance</CODE> override that AppWizard creates for you includes a call to the <A HREF="JavaScript:hhobj_9.Click()">CWinApp</A> member function <A HREF="JavaScript:hhobj_10.Click()">LoadStdProfileSettings</A>, which loads information from the registry or .INI file, including the most recently used file names.</P>

<P>These entries are stored as follows: 

<UL type=disc>
	<LI>In Windows NT, the value is stored to a registry key.<BR><BR></LI>

	<LI>In Windows 3.x, the value is stored in the WIN.INI file. <BR><BR></LI>

	<LI>In Windows 95, the value is stored in a cached version of WIN.INI. </LI>
</UL>
</font>
</BODY>
</HTML>
