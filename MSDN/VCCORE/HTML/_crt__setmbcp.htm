<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_setmbcp</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_crt__setmbcp"></A><SUP></SUP>_setmbcp</H1>

<P>Sets a new multibyte code page.</P>

<P><B>int</B> <B>_setmbcp(</B> <B>int</B> <I>codepage</I> <B>);</B></P>

<TABLE border=1 cellpadding=5 cols=3 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=16%><B>Routine</B></TD>
<TD class=label width=26%><B>Required Header</B></TD>
<TD class=label width=58%><B>Compatibility</B></TD>
</TR>

<TR VALIGN="top">
<TD width=16%><B>_setmbcp</B></TD>
<TD width=26%>&lt;mbctype.h&gt;</TD>
<TD width=58%>Win 95, Win NT</TD>
</TR>
</TABLE><BR>

<P>For additional compatibility information, see <A HREF="_crt_compatibility.htm">Compatibility</A> in the Introduction.</P>

<P class=label><B>Libraries</B></P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD width=24%>LIBC.LIB</TD>
<TD width=76%>Single thread static library, retail version</TD>
</TR>

<TR VALIGN="top">
<TD width=24%>LIBCMT.LIB</TD>
<TD width=76%>Multithread static library, retail version</TD>
</TR>

<TR VALIGN="top">
<TD width=24%>MSVCRT.LIB</TD>
<TD width=76%>Import library for MSVCRT.DLL, retail version</TD>
</TR>
</TABLE><BR>

<P class=label><B>Return Value</B></P>

<P><B>_setmbcp</B> returns 0 if the code page is set successfully. If an invalid code page value is supplied for <I>codepage</I>, the function returns –1 and the code page setting is unchanged. </P>

<P class=label><B>Parameter</B></P>

<P class=dt><I>codepage</I></P>

<P class=indent>New code page setting for locale-independent multibyte routines</P>

<P class=label><B>Remarks</B></P>

<P>The <B>_setmbcp</B> function specifies a new multibyte code page. By default, the run-time system automatically sets the multibyte code page to the system-default ANSI code page. The multibyte code page setting affects all multibyte routines that are not locale-dependent. However, it is possible to instruct <B>_setmbcp</B> to use the code page defined for the current locale (see the following list of manifest constants and associated behavior results). For a list of the multibyte routines that are dependent on the locale code page rather than the multibyte code page, see <A HREF="_crt_interpretation_of_multibyte.2d.character_sequences.htm">Interpretation of Multibyte-Character Sequences</A>.</P>

<P>The multibyte code page also affects multibyte-character processing by the following run-time library routines:</P>

<TABLE border=1 cellpadding=5 cols=3 frame=below rules=rows>

<TR VALIGN="top">
<TD width=31%><A HREF="_crt__exec.2c_._wexec_functions.htm">_exec functions</A></TD>
<TD width=34%><A HREF="_crt__mktemp.2c_._wmktemp.htm">_mktemp</A></TD>
<TD width=35%><A HREF="_crt__stat.2c_._wstat.2c_._stati64.2c_._wstati64.htm">_stat</A></TD>
</TR>

<TR VALIGN="top">
<TD width=31%><A HREF="_crt__fullpath.2c_._wfullpath.htm">_fullpath</A></TD>
<TD width=34%><A HREF="_crt__spawn.2c_._wspawn_functions.htm">_spawn functions</A></TD>
<TD width=35%><A HREF="_crt__tempnam.2c_._wtempnam.2c_.tmpnam.2c_._wtmpnam.htm">_tempnam</A></TD>
</TR>

<TR VALIGN="top">
<TD width=31%><A HREF="_crt__makepath.2c_._wmakepath.htm">_makepath</A></TD>
<TD width=34%><A HREF="_crt__splitpath.2c_._wsplitpath.htm">_splitpath</A></TD>
<TD width=35%><A HREF="_crt__tempnam.2c_._wtempnam.2c_.tmpnam.2c_._wtmpnam.htm">tmpnam</A></TD>
</TR>
</TABLE><BR>

<P>In addition, all run-time library routines that receive multibyte-character <I>argv</I> or <I>envp</I> program arguments as parameters (such as the <B>_exec</B> and <B>_spawn</B> families) process these strings according to the multibyte code page. Hence these routines are also affected by a call to <B>_setmbcp</B> that changes the multibyte code page.</P>

<P>The <I>codepage</I> argument can be set to any of the following values:

<UL type=disc>
	<LI><B>_MB_CP_ANSI</B>&nbsp;&nbsp;&nbsp;Use ANSI code page obtained from operating system at program startup<BR><BR></LI>

	<LI><B>_MB_CP_LOCALE</B>&nbsp;&nbsp;&nbsp;Use the current locale’s code page obtained from a previous call to <A HREF="_crt_setlocale.2c_._wsetlocale.htm">setlocale</A><BR><BR></LI>

	<LI><B>_MB_CP_OEM</B>&nbsp;&nbsp;&nbsp;Use OEM code page obtained from operating system at program startup<BR><BR></LI>

	<LI><B>_MB_CP_SBCS</B>&nbsp;&nbsp;&nbsp;Use single-byte code page. When the code page is set to <B>_MB_CP_SBCS</B>, a routine such as <A HREF="_crt__ismbblead.htm">_ismbblead</A> always returns false. <BR><BR></LI>

	<LI>Any other valid code page value, regardless of whether the value is an ANSI, OEM, or other operating-sytem – supported code page.</LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_crt__getmbcp.htm">_getmbcp</A>, <A HREF="_crt_setlocale.2c_._wsetlocale.htm">setlocale</A></P>
</font>
</BODY>
</HTML>
