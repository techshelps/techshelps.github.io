<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Dynaset</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CRecordset">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDatabase.3a3a.OpenEx">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDatabase.3a3a.Open">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dynaset"></A>Dynaset</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article describes dynasets and discusses their <A HREF="#_core_availability_of_dynasets">availability</A>. </P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>This article applies to the MFC ODBC classes, including <A HREF="JavaScript:hhobj_3.Click()">CRecordset</A>. For information about dynasets in the DAO classes, see class <A HREF="JavaScript:hhobj_4.Click()">CDaoRecordset</A>. With DAO, you can open dynaset-type recordsets.</P>

<P>A “dynaset” is a recordset with dynamic properties. During its lifetime, a recordset object in dynaset mode (usually called simply a “dynaset”) stays synchronized with the data source in the following way. In a multiuser environment, other users may edit or delete records that are in your dynaset or add records to the table your dynaset represents. Records your application adds to or deletes from the recordset are reflected in your dynaset. Records that other users add to the table will not be reflected in your dynaset until you rebuild the dynaset by calling its <B>Requery</B> member function. When other users delete records, MFC code skips over the deletions in your recordset. Other users’ editing changes to existing records are reflected in your dynaset as soon as you scroll to the affected record.</P>

<P>Similarly, edits you make to records in a dynaset are reflected in dynasets in use by other users. Records you add are not reflected in other users’ dynasets until they requery their dynasets. Records you delete are marked as “deleted” in other users’ recordsets. If you have multiple connections to the same database (multiple <B>CDatabase</B> objects), recordsets associated with those connections have the same status as the recordsets of other users.</P>

<P>Dynasets are most valuable when data must be dynamic, as, for example, in an airline reservation system.</P>

<P class=indent><B><B>Important&nbsp;&nbsp;&nbsp;</B></B>To use dynasets, you must have an ODBC driver for your data source that supports dynasets, and the ODBC cursor library must not be loaded. See <A HREF="#_core_availability_of_dynasets">Availability of Dynasets</A>. </P>

<P>To specify that a recordset is a dynaset, pass <B>CRecordset::dynaset</B> as the first parameter to the <B>Open</B> member function of your recordset object.</P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>For updatable dynasets, your ODBC driver must support either positioned update statements or the <B>::SQLSetPos</B> ODBC API function. If both are supported, MFC uses <B>::SQLSetPos</B> for efficiency. </P>



<H2><A NAME="_core_availability_of_dynasets"></A>Availability of Dynasets</H2>

<P>The MFC database classes support dynasets if the following requirements are met:

<UL type=disc>
	<LI>The ODBC cursor library DLL must not be in use for this data source.
<P class=tl>If the cursor library is used, it masks some functionality of the underlying ODBC driver that is necessary for dynaset support. If you want to use dynasets (and your ODBC driver has the functionality required for dynasets, as described in the rest of this section), you can cause MFC not to load the cursor library when you create a <B>CDatabase</B> object. For more information, see the article <A HREF="_core_odbc.htm">ODBC</A> and the <A HREF="JavaScript:hhobj_5.Click()">OpenEx</A> or <A HREF="JavaScript:hhobj_6.Click()">Open</A> member function of class <B>CDatabase</B>.</P>
<P class=tl>In ODBC terminology, dynasets and snapshots are referred to as “cursors.” A cursor is a mechanism used for keeping track of its position in a recordset. For more information about cursors, see the ODBC SDK <I>Programmer’s Reference</I> on the MSDN Library CD.</P></LI>

	<LI>The ODBC driver for your data source must support keyset-driven cursors.
<P class=tl>Keyset-driven cursors manage data from a table by getting and storing a set of keys. The keys are used to obtain current data from the table when the user scrolls onto a particular record. To determine whether your driver provides this support, call the <B>::SQLGetInfo</B> ODBC API function with the <B>SQL_SCROLL_OPTIONS</B> parameter.</P>
<P class=tl>If you try to open a dynaset without keyset support, you get a <B>CDBException</B> with the return code value <B>AFX_SQL_ERROR_DYNASET_NOT_SUPPORTED</B>. </P></LI>

	<LI>The ODBC driver for your data source must support extended fetching.
<P class=tl>“Extended fetching” is the ability to scroll backward as well as forward over the resulting records of your SQL query. To determine whether your driver supports this ability, call the <B>::SQLGetFunctions</B> ODBC API function with the <B>SQL_API_SQLEXTENDEDFETCH</B> parameter.</P></LI>
</UL>

<P>If you want updatable dynasets (or snapshots, for that matter), your ODBC driver must also support either the ::SQLSetPos ODBC API function or positioned updates. The <B>::SQLSetPos</B> function allows MFC to update the data source without sending SQL statements. If this support is available, MFC uses it in preference to making updates via SQL. To determine whether your driver supports <B>::SQLSetPos</B>, call <B>::SQLGetInfo</B> with the <B>SQL_POS_OPERATIONS</B> parameter.</P>

<P>Positioned updates use SQL syntax (of the form <B>WHERE CURRENT OF</B> &lt;cursorname&gt;) to identify a particular row in the table on the data source. To determine whether your driver supports positioned updates, call <B>::SQLGetInfo</B> with the <B>SQL_POSITIONED_STATEMENTS</B> parameter.</P>

<P>Generally, MFC dynasets (but not forward-only recordsets) require an ODBC driver with level 2 API conformance. If the driver for your data source conforms to the level 1 API set, you can still use both updatable and read-only snapshots and forward-only recordsets, but not dynasets. However, a level 1 driver can support dynasets if it supports extended fetching and keyset-driven cursors. For more information about ODBC conformance levels, see the article <A HREF="_core_odbc.htm">ODBC</A>. </P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>If you want to use both snapshots and dynasets, you must base them on two different <B>CDatabase</B> objects (two different connections).</P>

<P>Unlike snapshots, which use intermediate storage maintained by the ODBC cursor library, dynasets fetch a record directly from the data source as soon as you scroll to it. This keeps the records originally selected by the dynaset synchronized with the data source.</P>

<P>See the article <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A> for a list of ODBC drivers included in this version of Visual C++ and for information about obtaining additional drivers.</P>
</font>
</BODY>
</HTML>
