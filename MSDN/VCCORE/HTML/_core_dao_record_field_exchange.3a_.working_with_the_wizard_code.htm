<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO Record Field Exchange: Working with the Wizard Code</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.DoFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.DoFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.DoFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.IsFieldDirty">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.IsFieldNull">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoFieldExchange.3a3a.SetFieldType">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_DFX_Text">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_DFX_Short">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_Record_Field_Exchange_Functions">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDaoFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.m_nFields">
</OBJECT>
<OBJECT ID="hhobj_15" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.m_nFields">
</OBJECT>
<OBJECT ID="hhobj_16" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_17" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.m_nParams">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_record_field_exchange.3a_.working_with_the_wizard_code"></A>DAO Record Field Exchange: Working with the Wizard Code</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains the code that the wizards write to support DFX and how you might want to alter that code.</P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>This article is about the DAO version of record field exchange. If you are using the MFC ODBC classes rather than the MFC DAO classes, see the article <A HREF="_core_record_field_exchange.3a_.working_with_the_wizard_code.htm">Record Field Exchange: Working with the Wizard Code</A> instead.</P>

<P>When you create a recordset class with a wizard, the wizard writes the following DFX-related elements for you, based on the data source, table, and column (field) choices you make in the wizard:

<UL type=disc>
	<LI>Declarations of the recordset field data members as described in the article <A HREF="_core_dao_recordset.3a_.architecture.htm">DAO Recordset: Architecture</A><BR><BR></LI>

	<LI>An override of <A HREF="JavaScript:hhobj_3.Click()">CDaoRecordset::DoFieldExchange</A><BR><BR></LI>

	<LI>Initialization of recordset field data members in the recordset class constructor</LI>
</UL>



<H2><A NAME="_core_the_field_data_member_declarations_for_dao"></A>The Field Data Member Declarations for DAO</H2>

<P>The wizards write a recordset class declaration in an .H file that resembles the following for a user-defined class called <CODE>CSectionSet</CODE>: </P>

<PRE><CODE>class CSectionSet : public CDaoRecordset
{
public:
    CSectionSet(CDaoDatabase* pDatabase = NULL);
    DECLARE_DYNAMIC(CSectionSet)

// Field/Param Data
    //{{AFX_FIELD(CSectionSet, CDaoRecordset)
    CString    m_CourseID;
    CString    m_SectionNo;
    CString    m_InstructorID;
    CString    m_RoomNo;
    CString    m_Schedule;
    int        m_Capacity;
    //}}AFX_FIELD 

// Overrides
    // ClassWizard generated virtual function overrides
    //{{AFX_VIRTUAL(CSectionSet)
    public:
    virtual CString GetDefaultDBName();
    virtual CString GetDefaultSQL();
    virtual void DoFieldExchange(CDaoFieldExchange* 
                                                  pFX);
    //}}AFX_VIRTUAL

// Implementation
#ifdef _DEBUG
    virtual void AssertValid() const;
    virtual void Dump(CDumpContext&amp; dc) const;
#endif

};
</CODE></PRE>

<P>Notice the following key features about the class above:

<UL type=disc>
	<LI>Special “//{{AFX_FIELD” comments that bracket the field data member declarations. ClassWizard uses these to update your source file.<BR><BR></LI>

	<LI>The wizard overrides several <A HREF="JavaScript:hhobj_4.Click()">CDaoRecordset</A> virtual functions. The most important of these is the <A HREF="JavaScript:hhobj_5.Click()">DoFieldExchange</A> member function.</LI>
</UL>

<P class=indent><B><B>Caution&nbsp;&nbsp;&nbsp;</B></B>Never edit the code inside “//{{AFX” brackets. Always use ClassWizard. If you add parameter data members or new field data members that you bind yourself, add them outside the brackets.</P>



<H2><A NAME="_core_the_dofieldexchange_override_for_dao"></A>The DoFieldExchange Override for DAO</H2>

<P><A HREF="JavaScript:hhobj_6.Click()">DoFieldExchange</A> is the heart of DFX. The framework calls <B>DoFieldExchange</B> any time it needs to move data either from data source to recordset or from recordset to data source. <B>DoFieldExchange</B> also supports obtaining information about field data members through the <A HREF="JavaScript:hhobj_7.Click()">IsFieldDirty</A> and <A HREF="JavaScript:hhobj_8.Click()">IsFieldNull</A> member functions.</P>

<P>The following <B>DoFieldExchange</B> override is for a user-defined <CODE>CSectionSet</CODE> class. ClassWizard writes the function in the .CPP file for your recordset class.</P>

<PRE><CODE>void CSectionSet::DoFieldExchange(CDaoFieldExchange* pFX)
{
    //{{AFX_FIELD_MAP(CSectionSet)
    pFX-&gt;SetFieldType(CDaoFieldExchange::outputColumn);
    DFX_Text(pFX, _T("CourseID"), m_CourseID);
    DFX_Text(pFX, _T("SectionNo"), m_SectionNo);
    DFX_Text(pFX, _T("InstructorID"), m_InstructorID);
    DFX_Text(pFX, _T("RoomNo"), m_RoomNo);
    DFX_Text(pFX, _T("Schedule"), m_Schedule);
    DFX_Short(pFX, _T("Capacity"), m_Capacity);
    //}}AFX_FIELD_MAP
}
</CODE></PRE>

<P>Notice the following key features of the function:

<UL type=disc>
	<LI>The special “//{{AFX_FIELD_MAP” comments. ClassWizard uses these to update your source file. This section of the function is called the “field map.”<BR><BR></LI>

	<LI>A call to <B>CDaoFieldExchange::SetFieldType</B>, through the <I>pFX</I> pointer. This call specifies that all DFX function calls up to the end of <B>DoFieldExchange</B> or the next call to <B>SetFieldType</B> are “output columns.” See <A HREF="JavaScript:hhobj_9.Click()">CDaoFieldExchange::SetFieldType</A> in the <I>Class Library Reference</I> for more information. <BR><BR></LI>

	<LI>Several calls to the <A HREF="JavaScript:hhobj_10.Click()">DFX_Text</A> and <A HREF="JavaScript:hhobj_11.Click()">DFX_Short</A> global functions — one per field data member. These calls specify the relationship between a column name on the data source and a field data member. The DFX functions do the actual data transfer. The class library supplies DFX functions for all of the common data types. For more information about DFX functions, see the article <A HREF="_core_dao_record_field_exchange.3a_.using_the_dfx_functions.htm">DAO Record Field Exchange: Using the DFX Functions</A> and, in the <I>Class Library Reference</I> under Macros and Globals, <A HREF="JavaScript:hhobj_12.Click()">Record Field Exchange Functions</A>.<BR><BR></LI>

	<LI>The <I>pFX</I> pointer to a <A HREF="JavaScript:hhobj_13.Click()">CDaoFieldExchange</A> object that the framework passes when it calls <B>DoFieldExchange</B>. The <B>CDaoFieldExchange</B> object specifies the operation that <B>DoFieldExchange</B> is to perform, the direction of transfer, and other context information.<BR><BR></LI>

	<LI>The use of the <B>_T</B> macro for Unicode enabling. For more information, see the article <A HREF="_core_strings.3a_.unicode_and_multibyte_character_set_.28.mbcs.29_.support.htm">Strings: Unicode and Multibyte Character Set (MBCS) Support</A>.</LI>
</UL>



<H2><A NAME="_core_the_recordset_constructor_for_dao"></A>The Recordset Constructor for DAO</H2>

<P>The recordset constructor that the wizards write contains two things related to DFX:

<UL type=disc>
	<LI>An initialization for each field data member<BR><BR></LI>

	<LI>An initialization for the <A HREF="JavaScript:hhobj_14.Click()">m_nFields</A> data member, which contains the number of field data members</LI>
</UL>

<P>The constructor for the <CODE>CSectionSet</CODE> recordset example looks like this:</P>

<PRE><CODE>CSectionSet::CSectionSet(CDaoDatabase* pdb)
    : CDaoRecordset(pdb)
{
    //{{AFX_FIELD_INIT(CSectionSet)
    m_CourseID = _T("");
    m_SectionNo = _T("");
    m_InstructorID = _T("");
    m_RoomNo = _T("");
    m_Schedule = _T("");
    m_Capacity = 0;
    m_nFields = 6;
    //}}AFX_FIELD_INIT 
    m_nDefaultType = dbOpenDynaset;

    m_bCheckCacheForDirtyFields = TRUE;
}
</CODE></PRE>

<P>This code initializes all of the field data members that require initialization and specifies how many field data members there are (in <A HREF="JavaScript:hhobj_15.Click()">m_nFields</A>). The code also sets the values of two special recordset data members:

<UL type=disc>
	<LI><B>m_nDefaultType<B>&nbsp;&nbsp;&nbsp;</B></B>Set to the type of recordset you specify in the wizard. All recordsets created from this class default to the type set here, but you can override the default for any particular recordset object by specifying a new type when you call <A HREF="JavaScript:hhobj_16.Click()">CDaoRecordset::Open</A>.<BR><BR></LI>

	<LI><B>m_bCheckCacheForDirtyFields<B>&nbsp;&nbsp;&nbsp;</B></B>If set to <B>TRUE</B> (the default), the recordset uses a “double-buffering” mechanism to detect edits to fields by comparing them to a copy of the record. For more information, see the article <A HREF="_core_dao_record_field_exchange.3a_.double_buffering_records.htm">DAO Record Field Exchange: Double Buffering Records</A>.</LI>
</UL>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>The code above is enabled for Unicode.</P>

<P class=indent><B><B>Important&nbsp;&nbsp;&nbsp;</B></B>If you add any field data members manually, you must increment <B>m_nFields</B>. Do so with another line of code outside the “//{{AFX_FIELD_INIT” brackets, such as:</P>

<PRE><CODE>    m_nFields += 3;
</CODE></PRE>

<P>This is the code for adding three new fields. If you add any parameter data members, you must initialize the <A HREF="JavaScript:hhobj_17.Click()">m_nParams</A> data member, which contains the number of parameter data members. Put the <B>m_nParams</B> initialization outside the brackets. </P>

<P>For more information about these special recordset data members, see the article <A HREF="_core_dao_recordset.3a_.architecture.htm">DAO Recordset: Architecture</A>.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao_record_field_exchange_.28.dfx.29.htm">DAO Record Field Exchange (DFX)</A>, <A HREF="_core_dao_record_field_exchange.3a_.using_dfx.htm">DAO Record Field Exchange: Using DFX</A>, <A HREF="_core_dao_record_field_exchange.3a_.how_dfx_works.htm">DAO Record Field Exchange: How DFX Works</A>, <A HREF="_core_dao_recordset.htm">DAO Recordset</A>, <A HREF="_core_dao_queries.3a_.filtering_and_parameterizing_queries.htm">DAO Queries: Filtering and Parameterizing Queries</A></P>
</font>
</BODY>
</HTML>
