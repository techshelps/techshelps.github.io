<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Calculating Necessary Values</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="vcconcalculatingnecessaryvalues"></A>Calculating Necessary Values</H1>

<P>There are two critical pieces of information that need to be calculated by the delay helper routine. To that end, there are a couple of inline functions in the header file, Delayimp.h, for calculating this information. The first one is for calculating the index of the current import into the three different tables (IAT, BIAT, and UIAT) and the second for counting the number of imports in a valid IAT:</P>

<PRE><CODE>// utility function for calculating the index of the current import
// for all the tables (INT, BIAT, UIAT, and IAT).
__inline unsigned
IndexFromPImgThunkData(PCImgThunkData pitdCur, PCImgThunkData pitdBase) {
    return pitdCur - pitdBase;
    }

// utility function for calculating the count of imports given the base
// of the IAT. NB: this only works on a valid IAT!
__inline unsigned
CountOfImports(PCImgThunkData pitdBase) {
    unsigned        cRet = 0;
    PCImgThunkData  pitd = pitdBase;
    while (pitd-&gt;u1.Function) {
        pitd++;
        cRet++;
        }
    return cRet;
    }
</CODE></PRE>
</font>
</BODY>
</HTML>
