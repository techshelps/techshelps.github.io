<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OLE Background: MFC Implementation</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CMonikerFile">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CAsyncMonikerFile">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFCNOTES_TN038">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFCNOTES_TN039">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFCNOTES_TN040">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_ole_background.3a_.mfc_implementation"></A>OLE Background: MFC Implementation</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_ole_in_mfc.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_ole_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_ole_sample_list.htm">Sample</A>  |&nbsp; <A HREF="_core_ole_tutorial_list.htm">Tutorial</A></P>

<P>Because of the size and complexity of the raw OLE API, calling it directly to write OLE applications can be very time-consuming. The goal of the Microsoft Foundation Class Library implementation of OLE is to reduce the amount of work you have to do to write full-featured, OLE-capable applications. </P>

<P>This article explains the parts of the OLE API that have <I>not</I> been implemented inside MFC. The discussion also explains how what is implemented maps to the OLE section of the Win32 SDK.</P>



<H2><A NAME="_core_portions_of_ole_not_implemented_by_the_class_library"></A>Portions of OLE Not Implemented by the Class Library</H2>

<P>There are a few interfaces and features of OLE not directly provided by MFC. If you want to use these features, you can call the OLE API directly. </P>

<P class=dt><I>IMoniker Interface</I></P>

<P class=indent>The <B>IMoniker</B> interface is implemented by the class library (for example, the <B>COleServerItem</B> class), but has not previously been exposed to the programmer. For more information about this interface, see OLE Moniker Implementations in the OLE section of the Win32 SDK. However, see also class <A HREF="JavaScript:hhobj_2.Click()">CMonikerFile</A> and <A HREF="JavaScript:hhobj_3.Click()">CAsyncMonikerFile</A>.</P>

<P class=dt><I>IUnknown and IMarshal Interfaces</I></P>

<P class=indent>The <B>IUnknown</B> interface is implemented by the class library, but is not exposed to the programmer. The <B>IMarshal</B> interface is not implemented by the class library, but is used internally. Automation servers built using the class library already have marshalling capabilities built in. For more information about these interfaces, see the <I>OLE Programmer’s Reference</I>.</P>

<P class=dt><I>Docfiles (Compound Files)</I></P>

<P class=indent>Compound files are partially supported by the class library. None of the functions that directly manipulate compound files beyond creation are supported. MFC uses class <B>COleFileStream</B> to support manipulation of streams with standard file functions. For more information, see the article <A HREF="_core_containers.3a_.compound_files.htm">Containers: Compound Files</A>. </P>

<P class=dt><I>In-Process Servers and Object Handlers</I></P>

<P class=indent>In-process servers and object handlers allow implementation of visual editing data or full component object model (COM) objects in a DLL. To do this, you can implement your DLL by calling the OLE API directly. However, if you are writing an Automation server and your server has no user interface, you can use AppWizard to make your server an in-process server and put it completely into a DLL. For more information about these topics, see the article <A HREF="_core_automation_servers.htm">Automation Servers</A> and also The OLE Messaging Library: An Automation Server in the Win32 SDK.</P>

<P class=atl><B><B>Tip</B></B>&nbsp;&nbsp;&nbsp;The easiest way to implement an Automation server is to place it in a DLL. MFC supports this approach.</p>
<P>For detailed information on how the Microsoft Foundation OLE classes implement OLE interfaces, see MFC Technical Notes <A HREF="JavaScript:hhobj_4.Click()">38</A>, <A HREF="JavaScript:hhobj_5.Click()">39</A>, and <A HREF="JavaScript:hhobj_6.Click()">40</A>.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_ole_background.3a_.implementation_strategies.htm">OLE Background: Implementation Strategies</A></P>
</font>
</BODY>
</HTML>
