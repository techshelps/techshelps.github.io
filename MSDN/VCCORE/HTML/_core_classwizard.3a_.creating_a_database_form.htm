<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ClassWizard: Creating a Database Form</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Scribble start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordView">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordView">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordView">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordView">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_classwizard.3a_.creating_a_database_form"></A>ClassWizard: Creating a Database Form</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_working_with_classes.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_working_with_classes_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A></P>

<P>The Microsoft Foundation Class Library database classes supply class <A HREF="JavaScript:hhobj_3.Click()">CRecordView</A> (for ODBC) and class <A HREF="JavaScript:hhobj_4.Click()">CDaoRecordView</A> (for DAO) for implementing database forms with controls in which to display record fields. This article explains how to create a record view class with ClassWizard and associate it with a recordset class.</P>

<P class=indent><B><B>Important</B></B>&nbsp;&nbsp;&nbsp;To use the MFC database classes, you must have specified at least minimum database support ("Only include header files") in AppWizard. If you didn't, open file Stdafx.h and add an <B>#include</B> directive for Afxdb.h (if you're using the MFC ODBC classes) or Afxdao.h (if you're using the MFC DAO classes).</P>

<P>The purpose of a record view class is to provide a form view whose controls are mapped directly to the field data members of a recordset object (and indirectly to the corresponding columns in a table on the data source). Setting up this mapping enables dialog data exchange (DDX) directly between the form's controls and the recordset's field data members. This article explains how to make the association.</P>

<P class=indent><B><B>Tip</B></B>&nbsp;&nbsp;&nbsp;The easiest way to use a record view as your application's main view is to do so when you initially run AppWizard. See <A HREF="_core_database_options_in_appwizard.htm">Database Options in AppWizard</A>. </P>

<P>The following procedure begins the process.</P>

<P class=label><B><A NAME="_core_to_create_a_record_view_associated_with_a_recordset"></A>To create a record view associated with a recordset</B>

<OL>
	<LI>Create the recordset class.
<P class=tl>See the article <A HREF="_core_classwizard.3a_.creating_a_recordset_class.htm">ClassWizard: Creating a Recordset Class</A>.</P></LI>

	<LI>Create a dialog-template resource.
<P class=tl>See <A HREF="_core_using_the_dialog_editor_to_add_controls.htm">Using the Dialog Editor to Add Controls</A> or <A HREF="_core_dialog_editor_topics_for_visual_c.2b2b.htm">Dialog Editor Topics for Visual C++</A> for more information.</P>
<P class=tl>In the <B>Styles</B> and <B>More Styles</B> property pages of your dialog template, set the following properties, as you would for a <B>CFormView</B> object:</P>
<UL type=disc>
	<LI>In the Style box, select <B>Child </B>(<B>WS_CHILD</B> on).<BR><BR></LI>

	<LI>In the <B>Border </B>box, select <B>None </B>(<B>WS_BORDER</B> off).<BR><BR></LI>

	<LI>Clear the <B>Visible </B>check box (<B>WS_VISIBLE</B> off).<BR><BR></LI>

	<LI>Clear the <B>Titlebar </B>check box (<B>WS_CAPTION</B> off).</LI>
</UL>
</LI>
</OL>

<P class=indent><B><B>Tip</B></B>&nbsp;&nbsp;&nbsp;As you place controls on your dialog template, you can help ClassWizard be smarter. See the tips in the article <A HREF="_core_classwizard.3a_.mapping_form_controls_to_recordset_fields.htm">ClassWizard: Mapping Form Controls to Recordset Fields</A>. </P>

<P>To continue from step 2, see the following procedure.</P>

<P class=label><B><A NAME="_core_to_create_the_record_view_class"></A>To create the record view class</B>

<OL>
	<LI>Run ClassWizard with the Visual C++ dialog editor open on your dialog-template resource. <BR><BR></LI>

	<LI>In the <B>Adding a Class </B>dialog box, click <B>Create a new class</B> (unless you are importing or using an existing class). For more information, see <A HREF="_core_adding_a_class.htm">Adding a Class</A>.<BR><BR></LI>

	<LI>In the <B>New Class </B>dialog box, specify <A HREF="JavaScript:hhobj_5.Click()">CRecordView</A> (for ODBC) or <A HREF="JavaScript:hhobj_6.Click()">CDaoRecordView</A> (for DAO) as the base class for the new class.<BR><BR></LI>

	<LI>Enter a name for the class and filenames for its .h and .cpp files and select any other options you need, such as Automation.<BR><BR></LI>

	<LI>Click <B>Create</B>. <BR><BR></LI>

	<LI>In the <B>Select a Recordset</B> dialog box, select the recordset class you created in step 1 of the procedure <A HREF="#_core_to_create_a_record_view_associated_with_a_recordset">To create a record view associated with a recordset</A>. 
<P class=tl>-or-</P>
<P class=tl>Click <B>New</B> to create a new recordset class. In this case, select a data source and table for the recordset as prompted. Close the <B>Select a Recordset</B> dialog box. On returning to the <B>Member Variables</B> tab, select your new recordset class. </P></LI>

	<LI>Bind columns to recordset field data members. See the article <A HREF="_core_classwizard.3a_.binding_recordset_fields_to_table_columns.htm">ClassWizard: Binding Recordset Fields to Table Columns</A>. 
<P class=atl><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;If you next click the <B>Class Info</B> tab, you'll see your recordset class listed in the Foreign Class box. For more information about "foreign" classes, see the article <A HREF="_core_classwizard.3a_.foreign_objects.htm">ClassWizard: Foreign Objects</A>. </p></LI>

	<LI>Click <B>OK</B> to exit ClassWizard.</LI>
</OL>

<P>For information about binding your record view controls to the recordset, see the article <A HREF="_core_classwizard.3a_.mapping_form_controls_to_recordset_fields.htm">ClassWizard: Mapping Form Controls to Recordset Fields</A>. </P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_classwizard.3a_.database_support.htm">ClassWizard: Database Support</A>, <A HREF="_core_classwizard.3a_.creating_a_recordset_class.htm">ClassWizard: Creating a Recordset Class</A>, <A HREF="_core_classwizard.3a_.binding_recordset_fields_to_table_columns.htm">ClassWizard: Binding Recordset Fields to Table Columns</A></P>
</font>
</BODY>
</HTML>
