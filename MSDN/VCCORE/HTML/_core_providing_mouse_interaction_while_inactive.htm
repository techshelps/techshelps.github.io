<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Providing Mouse Interaction While Inactive</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="circle sample start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleControl.3a3a.GetControlFlags">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleControl.3a3a.GetActivationPolicy">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_providing_mouse_interaction_while_inactive"></A>Providing Mouse Interaction While Inactive</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_activex_controls.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_activex_control_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_frequently_asked_questions_about_activex_controls.htm">FAQ</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_activex_control_sample_list.htm">Sample</A></P>

<P>If your control is not immediately activated, you may still want it to process <B>WM_SETCURSOR</B> and <B>WM_MOUSEMOVE</B> messages, even though the control has no window of its own. This can be accomplished by enabling <B>COleControl</B>’s implementation of the <B>IPointerInactive</B> interface, which is disabled by default. (See the <I>ActiveX SDK </I>for a description of this interface.) To enable it, include the <CODE>pointerInactive</CODE> flag in the set of flags returned by <A HREF="JavaScript:hhobj_3.Click()">COleControl::GetControlFlags</A>:</P>

<PRE><CODE>DWORD CMyCtrl::GetControlFlags()
{
    return COleControl::GetControlFlags() | pointerInactive;
}

</CODE></PRE>

<P>The code to include this flag is automatically generated if you select the Mouse Pointer Notifications When Inactive option on the Advanced ActiveX Features page when creating your control with ControlWizard.</P>

<P>When the <B>IPointerInactive</B> interface is enabled, the container delegates <B>WM_SETCURSOR</B> and <B>WM_MOUSEMOVE</B> messages to it. <B>COleControl</B>’s implementation of <B>IPointerInactive</B> dispatches the messages through your control’s message map after adjusting the mouse coordinates appropriately. You can process the messages just like ordinary window messages by adding the corresponding entries to the message map. In your handlers for these messages, avoid using the <CODE>m_hWnd</CODE> member variable (or any member function that uses it) without first checking that its value is not <B>NULL</B>.</P>

<P>You may also want an inactive control to be the target of an OLE drag-and-drop operation. This requires activating the control at the moment the user drags an object over it, so that the control’s window can be registered as a drop target. To cause activation to occur during a drag, override <A HREF="JavaScript:hhobj_4.Click()">COleControl::GetActivationPolicy</A>, and return the <B>POINTERINACTIVE_ACTIVATEONDRAG</B> flag:</P>

<PRE><CODE>DWORD CMyCtrl::GetActivationPolicy()
{
    return POINTERINACTIVE_ACTIVATEONDRAG;
}

</CODE></PRE>

<P>Enabling the <B>IPointerInactive</B> interface typically means that you want the control to be capable of processing mouse messages at all times. To get this behavior in a container that doesn’t support the <B>IPointerInactive</B> interface, you need to have your control always activated when visible, which means the control should include the <B>OLEMISC_ACTIVATEWHENVISIBLE</B> flag among its miscellaneous flags. However, to prevent this flag from taking effect in a container that does support <B>IPointerInactive</B>, you can also specify the <B>OLEMISC_IGNOREACTIVATEWHENVISIBLE</B> flag:</P>

<PRE><CODE>static const DWORD BASED_CODE _dwMyOleMisc =
    OLEMISC_ACTIVATEWHENVISIBLE |
    OLEMISC_IGNOREACTIVATEWHENVISIBLE |
    OLEMISC_SETCLIENTSITEFIRST |
    OLEMISC_INSIDEOUT |
    OLEMISC_CANTLINKINSIDE |
    OLEMISC_RECOMPOSEONRESIZE;
</CODE></PRE>
</font>
</BODY>
</HTML>
