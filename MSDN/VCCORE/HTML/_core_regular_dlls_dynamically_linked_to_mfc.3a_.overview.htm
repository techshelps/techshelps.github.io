<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Regular DLLs Dynamically Linked to MFC: Overview</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_DLLTRACE">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_DLLTRACE">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_regular_dlls_dynamically_linked_to_mfc.3a_.overview"></A>Regular DLLs Dynamically Linked to MFC: Overview</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_dlls.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dll_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_dlls.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dll_topics.htm">Details</A>  |&nbsp; <A HREF="_core_dll_sample_programs.htm">Sample</A></P>

<P>A regular DLL dynamically linked to MFC is a DLL that uses MFC internally, and the exported functions in the DLL can be called by either MFC or non-MFC executables. As the name describes, this kind of DLL is built using the dynamic-link library version of MFC (also known as the shared version of MFC). Functions are usually exported from a regular DLL using the standard C interface. For an example of how to write, build, and use a regular DLL, see the sample <A HREF="JavaScript:hhobj_2.Click()">DLLTRACE</A>. For more information about regular DLLs that dynamically link to MFC, see the section titled “Converting DLLTRACE to Dynamically Link with the MFC DLL” in the abstract for the sample.</P>

<P>You must add the <B>AFX_MANAGE_STATE</B> macro at the beginning of all the exported functions in regular DLLs that dynamically link to MFC to set the current module state to the one for the DLL. This is done by adding the following line of code to the beginning of functions exported from the DLL:</P>

<PRE><CODE>AFX_MANAGE_STATE(AfxGetStaticModuleState( ))
</CODE></PRE>

<P>For detailed information on converting a regular DLL that statically links to MFC to a DLL that dynamically links to MFC, see the section titled “Converting DLLTRACE to Dynamically Link with the MFC DLL” in the abstract for the <A HREF="JavaScript:hhobj_3.Click()">DLLTRACE</A> sample.</P>

<H3>What do you want to do?</H3>

<UL type=disc>
	<LI><A HREF="_core_initialize_regular_dlls.htm">Initialize a regular DLL</A></LI>
</UL>

<H3>What do you want to know more about?</H3>

<UL type=disc>
	<LI><A HREF="_core_regular_dlls_dynamically_linked_to_mfc.htm">Regular DLLs dynamically linked to MFC</A><BR><BR></LI>

	<LI><A HREF="_core_non.2d.mfc_dlls.3a_.overview.htm">Non-MFC DLLs: Overview</A><BR><BR></LI>

	<LI><A HREF="_core_regular_dlls_statically_linked_to_mfc.3a_.overview.htm">Regular DLLs statically linked to MFC: Overview</A><BR><BR></LI>

	<LI><A HREF="_core_extension_dlls.3a_.overview.htm">Extension DLLs: Overview</A><BR><BR></LI>

	<LI><A HREF="_core_which_kind_of_dll_to_use.htm">Which kind of DLL to use</A><BR><BR></LI>

	<LI><A HREF="_core_using_extension_dll.2c.database.2f.ole.2f.sockets_in_regular_dll.htm">Using extension DLL, Database/OLE/Sockets in regular DLL</A><BR><BR></LI>

	<LI><A HREF="_core_build_settings_for_an_mfc_dll.htm">The build settings generated by AppWizard for MFC DLLs</A><BR><BR></LI>

	<LI><A HREF="_core_managing_the_state_data_of_mfc_modules.htm">Managing the state data of MFC modules</A></LI>
</UL>
</font>
</BODY>
</HTML>
