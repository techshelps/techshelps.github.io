<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ActiveX Control Containers: Handling Events from an ActiveX Control</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="circle sample start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_Event_Sink_Maps">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_Event_Sink_Maps">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_activex_control_containers.3a_.handling_events_from_an_activex_control"></A>ActiveX Control Containers: Handling Events from an ActiveX Control</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_activex_controls.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_activex_control_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_activex_control_sample_list.htm">Sample</A></P>

<P>This article discusses using ClassWizard to install event handlers for ActiveX controls in an ActiveX control container. The event handlers are used to receive notifications (from the control) of certain events and perform some action in response. This notification is called “firing” the event.</P>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;This article uses a dialog-based ActiveX control container project named Container and an embedded control named Circ2 as examples in the procedures and code.</P>

<P>Using the Message Maps tab in ClassWizard, you can create a map of events that can occur in your ActiveX control container application. This map, called an “event sink map,’’ is created and maintained by ClassWizard when you add event handlers to the control container class. Each event handler, implemented with an event map entry, maps a specific event to a container event handler member function. This event handler function is called when the specified event is fired by the ActiveX control object.</P>

<P>For more information on event sink maps, see <A HREF="JavaScript:hhobj_3.Click()">Event Sink Maps</A> in the <I>Class Library Reference</I>.</P>

<P class=label><B>To create an event handler function</B>

<OL>
	<LI>On the <B>View </B>menu, click <B>ClassWizard</B>.<BR><BR></LI>

	<LI>Click the <B>Message Maps</B> tab.<BR><BR></LI>

	<LI>In the <B>Class name</B> box, select the dialog box class that contains the ActiveX control. For this example, use <CODE>CContainerDlg</CODE>.<BR><BR></LI>

	<LI>In the <B>Object IDs </B>box, select the control ID of the embedded ActiveX control. For this example, use <CODE>IDC_CIRC2CTRL1</CODE>.
<P class=tl>The <B>Messages </B>box displays a list of events that can be fired by the embedded ActiveX control. Any member function shown in bold already has handler functions assigned to it.</P></LI>

	<LI>Select the message you want the application to handle. For this example, select <B>ClickIn</B>.<BR><BR></LI>

	<LI>Click <B>Add Function</B>.
<P class=tl>A suggested name for the handler function appears in the <B>Member Functions </B>box. For this example, use the suggested name.</P></LI>

	<LI>Click <B>OK </B>to close the <B>Add Function</B> dialog box.<BR><BR></LI>

	<LI>Click <B>Edit Code </B>to jump to the event handler code in the implementation (.CPP) file of <CODE>CContainerDlg</CODE> or <B>Close </B>to close <B>ClassWizard</B>.</LI>
</OL>



<H2><A NAME="_core_event_handler_modifications_to_the_project"></A>Event Handler Modifications to the Project</H2>

<P>When you use ClassWizard to add event handlers, an event sink map is declared and defined in your project. The following statements are added to the control .CPP file the first time an event handler is added. This code declares an event sink map for the dialog box class (in this case, <CODE>CContainerDlg</CODE>):</P>

<PRE><CODE>BEGIN_EVENTSINK_MAP(CContainerDlg, CDialog)
    //{{AFX_EVENTSINK_MAP(CContainerDlg)
    //}}AFX_EVENTSINK_MAP
END_EVENTSINK_MAP()
</CODE></PRE>

<P>As you use ClassWizard to add events, an event map entry (<B>ON_EVENT</B>) is added to the event sink map and an event handler function is added to the container’s implementation (.CPP) file.</P>

<P>The following example declares an event handler, called <CODE>OnClickInCirc2Ctrl</CODE>, for the Circ2 control’s ClickIn event:</P>

<PRE><CODE>BEGIN_EVENTSINK_MAP(CContainerDlg, CDialog)
    //{{AFX_EVENTSINK_MAP(CContainerDlg)
   ON_EVENT(CContainerDlg, IDC_CIRC2CTRL1, 1 /*
ClickIn */, OnClickInCirc2ctrl, VTS_I4 VTS_I4)
   //}}AFX_EVENTSINK_MAP
END_EVENTSINK_MAP()
</CODE></PRE>

<P>In addition, the following template is added to the <CODE>CContainerDlg</CODE> class implementation (.CPP) file for the event handler member function:</P>

<PRE><CODE>BOOL CContainerDlg::OnClickInCirc2ctrl1(OLE_XPOS_PIXELS nX, OLE_YPOS_PIXELS nY)
{
   // use nX and nY here
}
</CODE></PRE>

<P>For more information on event sink macros, see <A HREF="JavaScript:hhobj_4.Click()">Event Sink Maps</A> in the <I>Class Library Reference</I>.</P>
</font>
</BODY>
</HTML>
