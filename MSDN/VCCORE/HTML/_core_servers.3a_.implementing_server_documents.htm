<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Servers: Implementing Server Documents</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_COleServerItem">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_COleServerDoc">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_servers.3a_.implementing_server_documents"></A>Servers: Implementing Server Documents</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_ole_in_mfc.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_ole_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_ole_sample_list.htm">Sample</A>  |&nbsp; <A HREF="_core_ole_tutorial_list.htm">Tutorial</A></P>

<P>This article explains the steps you must take to successfully implement a server document if you did not specify the OLE Server option in AppWizard.</P>

<P class=label><B>To define a server document class</B>

<OL>
	<LI>Derive your document class from <B>COleServerDoc</B> instead of <B>CDocument</B>. <BR><BR></LI>

	<LI>Create a server item class derived from <B>COleServerItem</B>.<BR><BR></LI>

	<LI>Implement the <B>OnGetEmbeddedItem</B> member function of your server document class. 
<P class=tl><B>OnGetEmbeddedItem</B> is called when the user of a container application creates or edits an embedded item. It should return an item representing the entire document. This should be an object of your <B>COleServerItem</B>-derived class. </P></LI>

	<LI>Override the <B>Serialize</B> member function to serialize the contents of the document. You do not need to serialize the list of server items unless you are using them to represent the native data in your document. For more information, see <A HREF="_core_servers.3a_.server_items.htm#_core_implementing_server_items">Implementing Server Items</A> in the article Servers: Server Items. </LI>
</OL>

<P>When a server document is created, the framework automatically registers the document with the OLE system DLLs. This allows the DLLs to identify the server documents.</P>

<P>For more information, see <A HREF="JavaScript:hhobj_2.Click()">COleServerItem</A> and <A HREF="JavaScript:hhobj_3.Click()">COleServerDoc</A> in the <I>Class Library Reference</I>.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_servers.3a_.server_items.htm">Servers: Server Items</A>, <A HREF="_core_servers.3a_.implementing_a_server.htm">Servers: Implementing a Server</A>, <A HREF="_core_servers.3a_.implementing_in.2d.place_frame_windows.htm">Servers: Implementing In-Place Frame Windows</A> </P>
</font>
</BODY>
</HTML>
