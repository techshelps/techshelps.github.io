<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Document Templates and the Document/View Creation Process</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="MFC samples">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CSingleDocTemplate">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CMultiDocTemplate">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CWinApp.3a3a.AddDocTemplate">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_document_templates_and_the_document.2f.view_creation_process"></A>Document Templates and the Document/View Creation Process</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_mfc.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_mfc_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Sample</A>  |&nbsp; <A HREF="_core_mfc_tutorials_available.htm">Tutorial</A></P>

<P>To manage the complex process of creating documents with their associated views and frame windows, the framework uses two document template classes: <A HREF="JavaScript:hhobj_3.Click()">CSingleDocTemplate</A> for SDI applications and <A HREF="JavaScript:hhobj_4.Click()">CMultiDocTemplate</A> for MDI applications. A <B>CSingleDocTemplate</B> can create and store one document of one type at a time. A <B>CMultiDocTemplate</B> keeps a list of many open documents of one type.</P>

<P>Some applications support multiple document types. For example, an application might support text documents and graphics documents. In such an application, when the user chooses the New command on the File menu, a dialog box shows a list of possible new document types to open. For each supported document type, the application uses a distinct document template object. The figure An MDI Application with Two Document Types illustrates the configuration of an MDI application that supports two document types. The following figure shows several open documents.</P>

<P class=label><B>An MDI Application with Two Document Types</B></P>

<P><IMG SRC="m01mdit.gif" ALT="" BORDER=0></P>

<P>Document templates are created and maintained by the application object. One of the key tasks performed during your application's <CODE>InitInstance</CODE> function is to construct one or more document templates of the appropriate kind. This feature is described in <A HREF="_core_document_template_creation.htm">Document Template Creation</A>. The application object stores a pointer to each document template in its template list and provides an interface for adding document templates. </P>

<P>If you need to support two or more document types, you must add an extra call to <A HREF="JavaScript:hhobj_5.Click()">AddDocTemplate</A> for each document type. </P>

<P>An icon is registered for each document template based on its position in the application's list of document templates. The order of the document templates is determined by the order they are added with calls to <B>AddDocTemplate</B>. MFC assumes that the first Icon resource in the application is the application icon, the next Icon resource is the first document icon, and so on.</P>

<P>For example, suppose a document template is the third of three for the application: If there is an Icon resource in the application at index 3, that icon is used for the document template. If not, the icon at index 0 is used as a default.</P>

<H3>What do you want to know more about?</H3>

<UL type=disc>
	<LI><A HREF="_core_document_template_creation.htm">Document template creation</A><BR><BR></LI>

	<LI><A HREF="_core_document.2f.view_creation.htm">Document/view creation</A><BR><BR></LI>

	<LI><A HREF="_core_relationships_among_mfc_objects.htm">Relationships among MFC objects</A><BR><BR></LI>

	<LI><A HREF="_core_creating_new_documents.2c_.windows.2c_.and_views.htm">Creating new documents, windows, and views</A></LI>
</UL>
</font>
</BODY>
</HTML>
