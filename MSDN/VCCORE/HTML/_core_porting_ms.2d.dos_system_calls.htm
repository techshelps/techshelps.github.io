<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Porting MS-DOS System Calls</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_porting_ms.2d.dos_system_calls"></A><SUP></SUP>Porting MS-DOS System Calls</H1>

<P>The <B>DOS3Call</B> API function in Windows 3.<I>x</I> must be called from assembly language. It is typically used to perform file I/O. In Win32, you should replace assembly language code that calls <B>DOS3Call</B> with the appropriate Win32 file I/O calls. Other (non-file) INT 21H functions should be replaced with the portable Windows API call as shown in the following table.</P>

<TABLE border=1 cellpadding=5 cols=3 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=31%><B>INT 21H subfunction</B></TD>
<TD class=label width=34%><B>MS-DOS operation</B></TD>
<TD class=label width=35%><B>Win32 API equivalent</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>0EH</TD>
<TD width=34%>Select Disk</TD>
<TD width=35%><B>SetCurrentDirectory</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>19H</TD>
<TD width=34%>Get Current Disk</TD>
<TD width=35%><B>GetCurrentDirectory</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>2AH</TD>
<TD width=34%>Get Date</TD>
<TD width=35%><B>GetDateAndTime</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>2BH</TD>
<TD width=34%>Set Date</TD>
<TD width=35%><B>SetDateAndTime</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>2CH</TD>
<TD width=34%>Get Time</TD>
<TD width=35%><B>GetDateAndTime</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>2DH</TD>
<TD width=34%>Set Time</TD>
<TD width=35%><B>SetDateAndTime</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>36H</TD>
<TD width=34%>Get Disk Free Space</TD>
<TD width=35%><B>GetDiskFreeSpace</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>39H</TD>
<TD width=34%>Create Directory</TD>
<TD width=35%><B>CreateDirectory</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>3AH</TD>
<TD width=34%>Remove Directory</TD>
<TD width=35%><B>RemoveDirectory</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>3BH</TD>
<TD width=34%>Set Current Directory</TD>
<TD width=35%><B>SetCurrentDirectory</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>3CH</TD>
<TD width=34%>Create Handle</TD>
<TD width=35%><B>CreateFile</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>3DH</TD>
<TD width=34%>Open Handle</TD>
<TD width=35%><B>CreateFile</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>3EH</TD>
<TD width=34%>Close Handle</TD>
<TD width=35%><B>CloseHandle</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>3FH</TD>
<TD width=34%>Read Handle</TD>
<TD width=35%><B>ReadFile</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>40H</TD>
<TD width=34%>Write Handle</TD>
<TD width=35%><B>WriteFile</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>41H</TD>
<TD width=34%>Delete File</TD>
<TD width=35%><B>DeleteFile</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>42H</TD>
<TD width=34%>Move File Pointer</TD>
<TD width=35%><B>SetFilePointer</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>43H</TD>
<TD width=34%>Get File Attributes</TD>
<TD width=35%><B>GetAttributesFile</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>43H</TD>
<TD width=34%>Set File Attributes</TD>
<TD width=35%><B>SetAttributesFile</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>47H</TD>
<TD width=34%>Get Current Directory</TD>
<TD width=35%><B>GetCurrentDirectory</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>4EH</TD>
<TD width=34%>Find First File</TD>
<TD width=35%><B>FindFirstFile</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>4FH</TD>
<TD width=34%>Find Next File</TD>
<TD width=35%><B>FindNextFile</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>56H</TD>
<TD width=34%>Change Directory Entry</TD>
<TD width=35%><B>MoveFile</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>57H</TD>
<TD width=34%>Get Date/Time of File</TD>
<TD width=35%><B>GetDateAndTimeFile</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>57H</TD>
<TD width=34%>Set Date/Time of File</TD>
<TD width=35%><B>SetDataAndTimeFile</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>59H</TD>
<TD width=34%>Get Extended Error</TD>
<TD width=35%><B>GetLastError</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>5AH</TD>
<TD width=34%>Create Unique File</TD>
<TD width=35%><B>GetTempFileName</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>5BH</TD>
<TD width=34%>Create New File</TD>
<TD width=35%><B>CreateFile</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>5CH</TD>
<TD width=34%>Lock</TD>
<TD width=35%><B>LockFile</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>5CH</TD>
<TD width=34%>Unlock</TD>
<TD width=35%><B>UnlockFile</B></TD>
</TR>

<TR VALIGN="top">
<TD width=31%>67H</TD>
<TD width=34%>Set Handle Count</TD>
<TD width=35%><B>SetHandleCount</B></TD>
</TR>
</TABLE><BR>
</font>
</BODY>
</HTML>
