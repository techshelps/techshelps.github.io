<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ActiveX Controls: Property Pages</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="circle sample start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COlePropertyPage">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COlePropertyPage.3a3a.SetHelpInfo">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COlePropertyPage.3a3a.OnHelp">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_TESTHELP">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CWnd.3a3a.DoDataExchange">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Circle linking controls">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_Property_Pages">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_COlePropertyPage">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_activex_controls.3a_.property_pages"></A>ActiveX Controls: Property Pages</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_activex_controls.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_activex_control_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_frequently_asked_questions_about_activex_controls.htm">FAQ</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_activex_control_sample_list.htm">Sample</A></P>

<P>Property pages allow an ActiveX control user to view and change ActiveX control properties. These properties are accessed by invoking a control properties dialog box, which contains one or more property pages that provide a customized, graphical interface for viewing and editing the control properties.</P>

<P>ActiveX control property pages are displayed in two ways:

<UL type=disc>
	<LI>When the control’s Properties verb (<B>OLEIVERB_PROPERTIES</B>) is invoked, the control opens a modal property dialog box that contains the control’s property pages.<BR><BR></LI>

	<LI>The container can display its own modeless dialog box that shows the property pages of the selected control.</LI>
</UL>

<P>The properties dialog box (illustrated in the figure below) consists of an area for displaying the current property page, tabs for switching between property pages, and a collection of buttons that perform common tasks such as closing the property page dialog, canceling any changes made, or immediately applying any changes to the ActiveX control.</P>

<P class=label><B>A Properties Dialog Box</B></P>

<P><IMG SRC="proppg.gif" ALT="" BORDER=0></P>

<P>This article covers topics related to using property pages in an ActiveX control. These include:

<UL type=disc>
	<LI><A HREF="#_core_implementing_the_default_property_page">Implementing the default property page for an ActiveX control</A><BR><BR></LI>

	<LI><A HREF="#_core_adding_controls_to_a_property_page">Adding controls to a property page</A><BR><BR></LI>

	<LI><A HREF="#_core_adding_a_help_button_to_a_property_page">Adding a Help button to a property page</A><BR><BR></LI>

	<LI><A HREF="#_core_customizing_the_dodataexchange_function">Customizing the DoDataExchange function</A></LI>
</UL>

<P>For more information on using property pages in an ActiveX control, see the following articles:

<UL type=disc>
	<LI><A HREF="_core_activex_controls.3a_.adding_another_custom_property_page.htm">ActiveX Controls: Adding Another Custom Property Page</A><BR><BR></LI>

	<LI><A HREF="_core_activex_controls.3a_.using_stock_property_pages.htm">ActiveX Controls: Using Stock Property Pages</A></LI>
</UL>

<P>For information on using property sheets in an MFC application other than an ActiveX control, see the article <A HREF="_core_property_sheets.3a_.overview.htm">Property Sheets: Overview</A>.</P>



<H2><A NAME="_core_implementing_the_default_property_page"></A>Implementing the Default Property Page</H2>

<P>If you use ControlWizard to create your control project, ControlWizard provides a default property page class for the control derived from <A HREF="JavaScript:hhobj_3.Click()">COlePropertyPage</A>. Initially, this property page is blank, but you can add any dialog box control or set of controls to it. Because ControlWizard creates only one property page class by default, additional property page classes (also derived from <B>COlePropertyPage</B>) must be created using ClassWizard. For more information on this procedure, see <A HREF="_core_activex_controls.3a_.adding_another_custom_property_page.htm">ActiveX Controls: Adding Another Custom Property Page</A>.</P>

<P>Implementing a property page (in this case, the default) is a three step process:</P>

<P class=label><B>To implement a property page</B>

<OL>
	<LI>Add a <B>COlePropertyPage</B>-derived class to the control project. If the project was created using ControlWizard (as in this case), the default property page class already exists.<BR><BR></LI>

	<LI>Use the dialog editor to add any controls to the property page template.<BR><BR></LI>

	<LI>Customize the <CODE>DoDataExchange</CODE> function of the control to exchange values between the property page control and the ActiveX control.</LI>
</OL>

<P>For example purposes, the following procedures use a simple control (named “Sample”). Sample was created using ControlWizard and contains only the stock Caption property.</P>



<H2><A NAME="_core_adding_controls_to_a_property_page"></A>Adding Controls to a Property Page</H2>

<P class=label><B>To add controls to a property page</B>

<OL>
	<LI>With your control project open, click the <B>ResourceView</B> tab in the Project Workspace window.<BR><BR></LI>

	<LI>Double-click the <B>Dialog</B> directory icon.<BR><BR></LI>

	<LI>Open the <B>IDD_PROPPAGE_SAMPLE </B>dialog box.
<P class=tl>ControlWizard appends the name of the project to the end of the dialog ID, in this case, Sample.</P></LI>

	<LI>Click the desired control on the <B>Control Palette</B> and drag and drop it into the dialog box area.
<P class=tl>For this example, a text label control “Caption :” and an edit box control with an IDC_CAPTION identifier are sufficient.</P></LI>

	<LI>Click Save on the Toolbar to save your changes.</LI>
</OL>

<P>Now that the user interface has been modified, you need to link the edit box with the Caption property. This is done in the following section by editing the <CODE>CSamplePropPage::DoDataExchange</CODE> function.</P>



<H2><A NAME="_core_adding_a_help_button_to_a_property_page"></A>Adding a Help Button to a Property Page</H2>

<P>To enable help in your ActiveX control, call <A HREF="JavaScript:hhobj_4.Click()">SetHelpInfo</A> from your property page's constructor, and override the property page's <A HREF="JavaScript:hhobj_5.Click()">OnHelp</A> function to invoke WinHelp. </P>

<P>Here is an example of changing the default property page generated by ControlWizard:</P>

<PRE><CODE>CMyPropPage::CMyPropPage() :
        COlePropertyPage(IDD, IDS_MY_PPG_CAPTION)
{
        //{{AFX_DATA_INIT(CMyPropPage)
        // NOTE: ClassWizard will add member initialization here
        //    DO NOT EDIT what you see in these blocks of generated code !
        //}}AFX_DATA_INIT

        SetHelpInfo("Custom Help String goes here!!!","My.hlp",0);  
}

BOOL CMyPropPage::OnHelp(LPCTSTR lpszHelpDir)
{
        AfxGetApp()-&gt;WinHelp(0,HELP_CONTENTS);
        return TRUE;
}
</CODE></PRE>

<P>The sample <A HREF="JavaScript:hhobj_6.Click()">TESTHELP</A> demonstrates how to create an ActiveX control with tooltips and Help.</P>



<H2><A NAME="_core_customizing_the_dodataexchange_function"></A>Customizing the DoDataExchange Function</H2>

<P>Your property page <A HREF="JavaScript:hhobj_7.Click()">DoDataExchange</A> function allows you to link property page values with the actual values of properties in the control. To establish links, you must map the appropriate property page fields to their respective control properties.</P>

<P>These mappings are implemented using the property page <B>DDP_</B> functions. The <B>DDP_</B> functions work like the <B>DDX_</B> functions used in standard MFC dialogs, with one exception. In addition to the reference to a member variable, <B>DDP_</B> functions take the name of the control property. The following is a typical entry in the <CODE>DoDataExchange</CODE> function for a property page.</P>

<PRE><CODE>DDP_Text(pDX, IDC_CAPTION, m_caption, _T("Caption"));
</CODE></PRE>

<P>This function associates the property page’s <CODE>m_caption</CODE> member variable with the Caption property of the control.</P>

<P>Once you have the property page control inserted, you need to establish a link between the property page control, <CODE>IDC_CAPTION</CODE>, and the actual control property, Caption.</P>

<P>For more information on this procedure, see <A HREF="JavaScript:hhobj_8.Click()">Linking Controls with Properties</A> in <I>Tutorials</I>.</P>

<P><A HREF="JavaScript:hhobj_9.Click()">DDP functions</A> are available for other dialog control types, such as check boxes, radio buttons, and list boxes. The table below lists the entire set of property page <B>DDP_</B> functions and their purposes:</P>

<P class=label><B>Property Page Functions</B></P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=33%><B>Function Name</B></TD>
<TD class=label width=67%><B>Use this function to link ...</B></TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>DDP_CBIndex</B></TD>
<TD width=67%>The selected string’s index in a combo box with a control property.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>DDP_CBString</B></TD>
<TD width=67%>The selected string in a combo box with a control property. The selected string can begin with the same letters as the property’s value but need not match it fully.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>DDP_CBStringExact</B></TD>
<TD width=67%>The selected string in a combo box with a control property. The selected string and the property’s string value must match exactly.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>DDP_Check</B></TD>
<TD width=67%>A check box with a control property.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>DDP_LBIndex</B></TD>
<TD width=67%>The selected string’s index in a list box with a control property.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>DDP_LBString</B></TD>
<TD width=67%>The selected string in a list box with a control property. The selected string can begin with the same letters as the property’s value but need not match it fully.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>DDP_LBStringExact</B></TD>
<TD width=67%>The selected string in a list box with a control property. The selected string and the property’s string value must match exactly.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>DDP_Radio</B></TD>
<TD width=67%>A radio button with a control property.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>DDP_Text</B></TD>
<TD width=67%>Text with a control property.</TD>
</TR>
</TABLE><BR>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="JavaScript:hhobj_10.Click()">COlePropertyPage</A></P>
</font>
</BODY>
</HTML>
