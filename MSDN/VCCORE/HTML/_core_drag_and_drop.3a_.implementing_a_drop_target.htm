<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Drag and Drop: Implementing a Drop Target</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_OCLIENT">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_COleDropTarget">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_drag_and_drop.3a_.implementing_a_drop_target"></A>Drag and Drop: Implementing a Drop Target</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_ole_in_mfc.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_ole_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_ole_sample_list.htm">Sample</A>  |&nbsp; <A HREF="_core_ole_tutorial_list.htm">Tutorial</A></P>

<P>This article outlines how to make your application a drop target. Implementing a drop target takes slightly more work than implementing a drop source, but it’s still relatively simple. These techniques also apply to non-OLE applications.</P>

<P class=label><B><A NAME="_core_to_implement_a_drop_target"></A>To implement a drop target</B>

<OL>
	<LI>Add a member variable to each view in the application that you want to be a drop target. This member variable must be of type <B>COleDropTarget</B> or a class derived from it.<BR><BR></LI>

	<LI>From your view class’s function that handles the <B>WM_CREATE</B> message (typically <B>OnCreate</B>), call the new member variable’s <B>Register</B> member function. <B>Revoke</B> will be called automatically for you when your view is destroyed.<BR><BR></LI>

	<LI>Override the following functions. If you want the same behavior throughout your application, override these functions in your view class. If you want to modify behavior in isolated cases or want to enable dropping on non-<B>CView</B> windows, override these functions in your <B>COleDropTarget</B>-derived class.
<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=33%><B>Override</B></TD>
<TD class=label width=67%><B>To allow</B></TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>OnDragEnter</B></TD>
<TD width=67%>Drop operations to occur in the window. Called when the cursor first enters the window.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>OnDragLeave</B></TD>
<TD width=67%>Special behavior when the drag operation leaves the specified window.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>OnDragOver</B></TD>
<TD width=67%>Drop operations to occur in the window. Called when the cursor is being dragged across the window.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>OnDrop</B></TD>
<TD width=67%>Handling of data being dropped into the specified window.</TD>
</TR>

<TR VALIGN="top">
<TD width=33%><B>OnScrollBy</B></TD>
<TD width=67%>Special behavior for when scrolling is necessary in the target window.</TD>
</TR>
</TABLE><BR>
</LI>
</OL>

<P>See the MAINVIEW.CPP file that is part of the MFC OLE sample <A HREF="JavaScript:hhobj_2.Click()">OCLIENT</A> for an example of how these functions work together. </P>

<H3>What do you want to know more about?</H3>

<UL type=disc>
	<LI><A HREF="_core_drag_and_drop.3a_.implementing_a_drop_source.htm">Implementing a drop source</A><BR><BR></LI>

	<LI><A HREF="_core_data_objects_and_data_sources.3a_.creation_and_destruction.htm">Creating and destroying OLE data objects and data sources</A><BR><BR></LI>

	<LI><A HREF="_core_data_objects_and_data_sources.3a_.manipulation.htm">Manipulating OLE data objects and data sources</A></LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="JavaScript:hhobj_3.Click()">COleDropTarget</A></P>
</font>
</BODY>
</HTML>
