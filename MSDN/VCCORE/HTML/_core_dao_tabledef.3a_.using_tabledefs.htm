<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO Tabledef: Using Tabledefs</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.Create">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.SetAttributes">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.SetConnect">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.SetName">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.SetSourceTableName">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.SetValidationRule">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.SetValidationText">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.CreateField">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.CreateIndex">
</OBJECT>
<OBJECT ID="hhobj_15" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.Append">
</OBJECT>
<OBJECT ID="hhobj_16" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef">
</OBJECT>
<OBJECT ID="hhobj_17" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_18" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoTableDef.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_19" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_DAOVIEW">
</OBJECT>
<OBJECT ID="hhobj_20" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_21" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_tabledef.3a_.using_tabledefs"></A>DAO Tabledef: Using Tabledefs</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains how to use <A HREF="JavaScript:hhobj_3.Click()">CDaoTableDef</A> objects. Topics covered include:

<UL type=disc>
	<LI><A HREF="#_core_creating_a_tabledef">Creating a tabledef</A><BR><BR></LI>

	<LI><A HREF="#_core_opening_an_existing_tabledef">Opening an existing tabledef</A><BR><BR></LI>

	<LI><A HREF="#_core_creating_a_table.2d.type_recordset">Creating a table-type recordset</A></LI>
</UL>



<H2><A NAME="_core_creating_a_tabledef"></A>Creating a Tabledef</H2>

<P>Creating a tabledef creates a new table in the target database. You create the tabledef and add fields (and possibly indexes) to it. The new table doesn't contain any data until you either add records from Microsoft Access (for a Microsoft Jet (.MDB) database) or create a recordset that adds records to the table.</P>

<P>Creating a new MFC <A HREF="JavaScript:hhobj_4.Click()">CDaoTableDef</A> object creates the underlying DAO tabledef object.</P>

<P class=label><B>To create a tabledef</B>

<OL>
	<LI>Construct a <B>CDaoTableDef</B> object, supplying a pointer to the <A HREF="JavaScript:hhobj_5.Click()">CDaoDatabase</A> object to which the tabledef will belong.<BR><BR></LI>

	<LI>Call the tabledef object's <A HREF="JavaScript:hhobj_6.Click()">Create</A> member function.<BR><BR></LI>

	<LI>Set any of the tabledef object’s properties that you want. Call the <A HREF="JavaScript:hhobj_7.Click()">SetAttributes</A>, <A HREF="JavaScript:hhobj_8.Click()">SetConnect</A>, <A HREF="JavaScript:hhobj_9.Click()">SetName</A>, <A HREF="JavaScript:hhobj_10.Click()">SetSourceTableName</A>, <A HREF="JavaScript:hhobj_11.Click()">SetValidationRule</A>, or <A HREF="JavaScript:hhobj_12.Click()">SetValidationText</A> member functions.<BR><BR></LI>

	<LI>Add fields to the tabledef by calling its <A HREF="JavaScript:hhobj_13.Click()">CreateField</A> member function for each field. (You can’t modify the schema of an attached table, so this step applies only to local base tables and tables in external data sources that you open directly.)<BR><BR></LI>

	<LI>Optionally add indexes to the tabledef by calling its <A HREF="JavaScript:hhobj_14.Click()">CreateIndex</A> member function for each index.<BR><BR></LI>

	<LI>Call the tabledef object’s <A HREF="JavaScript:hhobj_15.Click()">Append</A> member function to save the tabledef in the database’s TableDefs collection. </LI>
</OL>

<P class=indent><B><B>Tip</B></B>&nbsp;&nbsp;&nbsp;The easiest way to create a tabledef is to create it in Microsoft Access. Open the target database, create tables, and save them in the database. Then you can use the tabledefs from your application’s code.</P>



<H2><A NAME="_core_opening_an_existing_tabledef"></A>Opening an Existing Tabledef</H2>

<P>If you want to examine or manipulate the structure of an existing table, open an MFC tabledef object based on the DAO tabledef object stored in the database's TableDefs collection. Objects in the TableDefs collection are accessed by the user-defined name specified when the tabledef was created and appended to the collection.</P>

<P class=label><B>To open a tabledef for an existing table</B>

<OL>
	<LI>Construct a <A HREF="JavaScript:hhobj_16.Click()">CDaoTableDef</A> object, passing a pointer to the <A HREF="JavaScript:hhobj_17.Click()">CDaoDatabase</A> object to which the tabledef belongs.<BR><BR></LI>

	<LI>Call the tabledef object's <A HREF="JavaScript:hhobj_18.Click()">Open</A> member function, specifying the user-defined name of the tabledef saved in the TableDefs collection. The name may or may not be the same as the name of the underlying source table.</LI>
</OL>

<P>For examples, see the MFC Database sample <A HREF="JavaScript:hhobj_19.Click()">DAOVIEW</A>. </P>

<P>The following code from the LISTVIEW.CPP file in DAOVIEW illustrates opening a tabledef to get information about its fields and then add the field information to a list control:</P>

<PRE><CODE>// db is an open CDaoDatabase object
// strTableName is the user-defined name of the tabledef to open
CDaoTableDef td( &amp;db );
try
{
    td.Open( strTableName );
    short nFields = td.GetFieldCount( );
    for( short i=0; i &lt; nFields; i++ )
    {
        td.GetFieldInfo(i,fieldInfo);
        m_ctlList.AddColumn(fieldInfo.m_strName,i);
    }
}
catch( CDaoException* e )
{
    // Do nothing. Used to catch security violations opening tables.
    e-&gt;Delete( );
}
td.Close( );
</CODE></PRE>



<H2><A NAME="_core_creating_a_table.2d.type_recordset"></A>Creating a Table-Type Recordset</H2>

<P>Unless a table is in an external data source, you can create table-type recordsets based on the table, in two ways:

<UL type=disc>
	<LI>Create a tabledef, then create a recordset from the tabledef.<BR><BR></LI>

	<LI>Create a recordset and specify <B>dbOpenTable</B> in the <I>nOpenType</I> parameter to <A HREF="JavaScript:hhobj_20.Click()">CDaoRecordset::Open</A>.</LI>
</UL>

<P>A table-type recordset represents a base table (a table in a Microsoft Jet (.MDB) database) in code. You can’t open a table-type recordset on an ODBC database or on an attached table, but you can open one on an ISAM database opened directly, such as a FoxPro, dBASE or Paradox database. </P>

<P>You can use a table-type recordset to examine, add, change, or delete records in a single base table. You can’t use an SQL statement to filter or sort data as you can with dynaset-type and snapshot-type recordsets. This means you get all records, but table-type recordsets behave somewhat like dynaset-type recordsets in that only the current record is loaded into memory. When you move to a new record, it is loaded. Sorting is based on a predefined index. Table-type recordsets support bi-directional scrolling.</P>

<P>For more information, see class <A HREF="JavaScript:hhobj_21.Click()">CDaoRecordset</A> in the <I>Class Library Reference</I> and see the following topics in DAO Help:

<UL type=disc>
	<LI>Recordset Object<BR><BR></LI>

	<LI>Table-Type Recordset Object</LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao_recordset.htm">DAO Recordset</A>, <A HREF="_core_dao_external.3a_.working_with_external_data_sources.htm">DAO External: Working with External Data Sources</A>, <A HREF="_core_dao_external.3a_.creating_an_external_table.htm">DAO External: Creating an External Table</A></P>
</font>
</BODY>
</HTML>
