<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Automation Clients: Using Type Libraries</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Autoclik start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_oa96_ODL_File_Syntax">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_oa96_MkTypLib_Type_Library_Creation_Tool">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleDispatchDriver">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_automation_clients.3a_.using_type_libraries"></A>Automation Clients: Using Type Libraries</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_automation.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_automation_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_automation_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A></P>

<P>Automation clients must have information about server objects’ properties and methods if the clients are to manipulate the servers’ objects. Properties have data types; methods often return values and accept parameters. The client requires information about the data types of all of these in order to statically bind to the server object type.</P>

<P>This type information can be made known in several ways. The recommended way is to create a type library.</P>

<P>For information on Microsoft <A HREF="JavaScript:hhobj_3.Click()">Object Description Language (ODL)</A> and <A HREF="JavaScript:hhobj_4.Click()">MkTypLib</A>, see the <I>OLE Programmer's Reference</I> in the <I>Win32 SDK</I>. </P>

<P>ClassWizard can read a type-library file and create a dispatch class derived from <A HREF="JavaScript:hhobj_5.Click()">COleDispatchDriver</A>. An object of that class has properties and operations duplicating those of the server object. Your application calls this object’s properties and operations, and functionality inherited from <B>COleDispatchDriver</B> routes these calls to the OLE system, which in turn routes them to the server object.</P>

<P>ClassWizard automatically maintains this type-library file for you if you chose to include <U>Automation</U> when the project was created. As part of each build, the .tlb file will be built with MkTypLib.</P>

<P class=label><B>To create a dispatch class from a type-library (.tlb) file</B>

<OL>
	<LI>In <B>ClassWizard</B>, click the <B>Add Class</B> button. The <B>Add Class </B>button appears on each tab of <B>ClassWizard</B>.
<P class=tl>The <B>Add Class</B> menu appears.</P></LI>

	<LI>On the <B>Add Class</B> menu, click <B>From a type library</B>.
<P class=tl>An <B>Import from Type Library </B>dialog box appears.</P></LI>

	<LI>In the <B>Import from Type Library </B>dialog box, select the .TLB file. 
<P class=atl><B><B>Tip</B></B>&nbsp;&nbsp;&nbsp;Some type library information is stored in files with .DLL, .OCX, or .OLB file extensions.</p></LI>

	<LI>Click <B>OK</B>.
<P class=tl>The <B>Confirm Classes</B> dialog box appears. The list contains the external names of the classes described in the type-library file. Other controls in the <B>Confirm Classes</B> dialog box show the proposed names for the dispatch classes and for the header and implementation files for those classes. As you select a class in the list box, the <B>Class Name</B> box shows the name for the corresponding class.</P>
<P class=tl>You can use the <B>Browse </B>buttons to select other files, if you prefer to have the header and implementation information written in existing files or in a directory other than the project directory.</P></LI>

	<LI>In the <B>Confirm Classes</B> dialog box, edit the names of the new dispatch classes and their files.<BR><BR></LI>

	<LI>Click <B>OK </B>to close the <B>Confirm Classes</B> dialog box.
<P class=tl>The <B>Type Library Tool</B> writes header and implementation code for your dispatch class, using the class names and file names you have supplied, and adds the .CPP file to your project.</P></LI>
</OL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_classwizard.3a_.adding_automation_properties_and_methods.htm">ClassWizard: Adding Automation Properties and Methods</A> </P>
</font>
</BODY>
</HTML>
