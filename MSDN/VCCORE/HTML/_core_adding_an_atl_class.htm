<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding an ATL Class</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Scribble start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="COM AppWizard">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_atl_home">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_atl_Adding_a_New_Interface_to_an_Existing_Object_or_Control">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_atl_Adding_Connection_Points_to_an_Object">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="newmethod">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_adding_an_atl_class"></A>Adding an ATL Class</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_working_with_classes.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_working_with_classes_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A></P>

<P>To add an ATL (Active Template Library) class to your project, your project must have been created as an ATL COM application, or contain ATL support for MFC applications. You can use the <A HREF="JavaScript:hhobj_3.Click()">ATL COM AppWizard</A> to create an ATL COM application, or <A HREF="vchowaddingatlsupporttoyourmfcproject.htm">add an ATL object to your MFC application</A> to implement MFC support for the Active Template Library.</P>

<P>You can define COM interfaces for your new ATL class when you first create it, or add them later by using the <B>Implement Interface</B> command from the ClassView popup menu.</P>

<P class=label><B>To add an ATL class to your ATL COM project</B>

<OL>
	<LI>Open the <B>New Class</B> dialog as described in <A HREF="_core_adding_a_class.htm#_core_the_new_class_dialog_box">the New Class dialog box</A>.<BR><BR></LI>

	<LI>In the <B>Class type</B> drop-down list, select <B>ATL Class</B>.<BR><BR></LI>

	<LI>In the<B> Name </B>box, specify the name of the new class.
<P class=tl>The name you specify is reflected in the read-only <B>File name</B> box, where the implementation (.cpp) file is specified. By default, the header file and the implementation file have the same name as the class (except for a leading capital 'C' in the name).</P>
<UL type=disc>
	<LI>To change the names of the header and implementation files for this class, click the <B>Change</B> button and type the names into the <B>Change Files</B> dialog box.<BR><BR></LI>

	<LI>To add the new class to existing files, click <B>Change</B>, then click the <B>Browse</B> button and locate the files you wish to add it to. </LI>
</UL>
</LI>

	<LI>Under <B>Interface Type</B>, specify whether you want the interfaces for this class to be <B>Dual</B> or <B>Custom</B>.
<P class=tl>Implementing a dual interface, derived from IDispatch, enables both COM clients and automation controllers to access your class functions. Custom interfaces are derived from IUnknown and have no restrictions on the data types you can use, such as data structures or unsigned arguments.</P></LI>

	<LI>Under <B>Interfaces</B>, specify the number of interfaces for the new class.
<P class=tl>The <B>Names </B>box displays the names of the interfaces. </P></LI>

	<LI>Click <B>Edit</B> to edit the default interface data. 
<P class=tl>If you do so, the <B>Edit Interface Information</B> dialog box appears: </P>
<UL type=disc>
	<LI>In the <B>Object short name </B>box, enter the control name; <BR><BR></LI>

	<LI>In <B>CoClass name</B>, type the name of the CoClass class that contains a list of interfaces supported by the object; <BR><BR></LI>

	<LI>In <B>Type name</B>, type an object description that will appear in the registry; <BR><BR></LI>

	<LI>In <B>Type ID (ProgID)</B>, type a name that containers can use instead of the CLSID of the object. </LI>
</UL>

<P class=tl>The related fields display text based on what you type in the Object short name box. </P></LI>

	<LI>Click <B>OK </B>to save changes and return to the <B>New Class</B> dialog box.<BR><BR></LI>

	<LI>Select the <B>Aggregatable</B> checkbox if you want this class to enable objects that can directly expose another object's interface pointer (default setting).<BR><BR></LI>

	<LI>Click <B>OK</B> to save your entries and exit the <B>New Class</B> dialog box.</LI>
</OL>

<P>This creates the associated implementation and header files for the new class, which you can view from the ClassView pane of the Project workspace.</P>

<P>For more information on ATL projects and ATL COM classes, see the <A HREF="JavaScript:hhobj_4.Click()">Active Template Library Home Page</A>.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="JavaScript:hhobj_5.Click()">Adding a New interface to an Existing Object or Control</A>, <A HREF="JavaScript:hhobj_6.Click()">Adding a Connection Point to an Object</A>, <A HREF="JavaScript:hhobj_7.Click()">Adding a method to an Interface or non-MFC Dispinterface</A>, <A HREF="_core_adding_an_mfc_class.htm">Adding an MFC Class</A>, <A HREF="_core_adding_a_generic_class.htm">Adding a Generic Class</A></P>
</font>
</BODY>
</HTML>
