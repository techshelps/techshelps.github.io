<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using the System Registry</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_using_the_system_registry"></A>Using the System Registry</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_win32_programming.3a_.overview.htm">Overview</A> |&nbsp; <A HREF="_core_win32_programming_tasks.htm">How Do I</A></P>

<P>Your Windows 95 application must not store any information in the WIN.INI and SYSTEM.INI files; instead, use the system registry to store any initialization information. MFC applications never store information in WIN.INI or SYSTEM.INI. Instead, they normally use a private .INI file to store information such as the MRU (most recently used) file list, the position of dockable toolbars, etc. Private .INI files are permissible for Windows 95 applications (though they are not recommended), as long as they are stored in the application directory and are deleted when the application is uninstalled. </P>

<P>You can make your MFC application compliant by using the <B>CWinApp::SetRegistryKey</B> function; this function makes your application use the registry instead of a private .INI file. Call this function from the <B>InitInstance</B> member function of your <B>CWinApp</B>-derived class, specifying the name of your software company (in string form) as the parameter; this creates a subkey in the registry (under HKEY_CURRENT_USER) with your software company’s name. After this function is called, all the information that your application would normally write to its .INI file is instead stored in the registry under that key. </P>
</font>
</BODY>
</HTML>
