<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Multithreading: When to Use the Synchronization Classes</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CSyncObject">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CSemaphore">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CMutex">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CCriticalSection">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CEvent">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CMultiLock">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CSingleLock">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_MTGDI">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_MUTEXES">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_Win32_Synchronization">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_multithreading.3a_.when_to_use_the_synchronization_classes"></A>Multithreading: When to Use the Synchronization Classes</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_multithreaded_programs.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_multithreading_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_multithreading_sample_list.htm">Sample</A></P>

<P>The six multithreaded classes provided with MFC fall into two categories: synchronization objects (<A HREF="JavaScript:hhobj_2.Click()">CSyncObject</A>, <A HREF="JavaScript:hhobj_3.Click()">CSemaphore</A>, <A HREF="JavaScript:hhobj_4.Click()">CMutex</A>, <A HREF="JavaScript:hhobj_5.Click()">CCriticalSection</A>, and <A HREF="JavaScript:hhobj_6.Click()">CEvent</A>) and synchronization access objects (<A HREF="JavaScript:hhobj_7.Click()">CMultiLock</A> and <A HREF="JavaScript:hhobj_8.Click()">CSingleLock</A>).</P>

<P>Synchronization classes are used when access to a resource must be controlled to ensure integrity of the resource. Synchronization access classes are used to gain access to these controlled resources. This article describes when to use each class.</P>

<P>To determine which synchronization class you should use, ask the following series of questions:

<OL>
	<LI>Does the application have to wait for something to happen before it can access the resource (for example, data must be received from a communications port before it can be written to a file)?
<P class=tl>If yes, use <B>CEvent</B>.</P></LI>

	<LI>Can more than one thread within the same application access this resource at one time (for example, your application allows up to five windows with views on the same document)?
<P class=tl>If yes, use <B>CSemaphore</B>.</P></LI>

	<LI>Can more than one application use this resource (for example, the resource is in a DLL)?
<P class=tl>If yes, use <B>CMutex</B>.</P>
<P class=tl>If no, use <B>CCriticalSection</B>.</P></LI>
</OL>

<P><B>CSyncObject </B>is never used directly. It is the base class for the other four synchronization classes.</P>

<H2>Example 1: Using Three Synchronization Classes</H2>

<P>As an example, take an application that maintains a linked list of accounts. This application allows up to three accounts to be examined in separate windows, but only one can be updated at any particular time. When an account is updated, the updated data is sent over the network to a data archive. </P>

<P>This example application uses all three types of synchronization classes. Because it allows up to three accounts to be examined at one time, it uses <B>CSemaphore</B> to limit access to three view objects. When an attempt to view a fourth account occurs, the application either waits until one of the first three windows closes or it fails. When an account is updated, the application uses <B>CCriticalSection </B>to ensure that only one account is updated at a time. After the update succeeds, it signals <B>CEvent</B>, which releases a thread waiting for the event to be signaled. This thread sends the new data to the data archive.</P>

<H2>Example 2: Using Synchronization Access Classes</H2>

<P>Choosing which synchronization access class to use is even simpler. If your application is concerned with accessing a single controlled resource only, use <B>CSingleLock</B>. If it needs access to any one of a number of controlled resources, use <B>CMultiLock</B>. In example 1, <B>CSingleLock </B>would have been used, as in each case only one resource was needed at any particular time.</P>

<P>For example code that uses the synchronization classes, see the MFC sample programs <A HREF="JavaScript:hhobj_9.Click()">MTGDI</A> and <A HREF="JavaScript:hhobj_10.Click()">MUTEXES</A>. These and other MFC sample programs can be found in Visual C++ Samples.</P>

<P>For information on how the synchronization classes are used, see the article <A HREF="_core_multithreading.3a_.how_to_use_the_synchronization_classes.htm">Multithreading: How to Use the Synchronization Classes</A>. For more information on synchronization, see <A HREF="JavaScript:hhobj_11.Click()">Synchronization</A> in the <I>Win32 Programmer’s Reference</I> of the Win32 SDK. For more information on multithreading support in MFC, see the article <A HREF="_core_multithreading_with_c.2b2b_.and_mfc.htm">Multithreading with C++ and MFC</A>.</P>
</font>
</BODY>
</HTML>
