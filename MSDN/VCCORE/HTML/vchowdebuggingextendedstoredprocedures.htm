<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Debugging Extended Stored Procedures</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="vcconRegisteringExtendedStoredProcedure">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="vcconCreatingExtendedStoredProcedure">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="vchowdebuggingextendedstoredprocedures"></A>Debugging Extended Stored Procedures</H1>

<P><B>Caution</B>  You should not debug an extended stored procedure on a computer that is running as a production server.</P>

<P>To debug an extended stored procedure, you must have the following products installed:

<UL type=disc>
	<LI>SQL Server 6.5<BR><BR></LI>

	<LI>Windows NT (server or workstation)<BR><BR></LI>

	<LI>Visual C++</LI>
</UL>

<P class=label><B>To debug an extended stored procedure</B>

<OL>
	<LI>Use Visual C++ to create a debug build of an extended stored procedure DLL.<BR><BR></LI>

	<LI>Stop SQL Server if it is currently running as a service.&nbsp; Open the Services tool in Control Panel, highlight MSSQLSERVER and click <B>Stop</B>.<BR><BR></LI>

	<LI>Copy the debug version of the DLL to the directory where sqlservr.exe resides or to any directory in the search path.&nbsp; 
<P class=tl><B>Tip&nbsp; </B>You can use the <B>Post-build step</B> tab in the <B>Project Settings</B> dialog box to copy the DLL.&nbsp; Type in a command to copy the dll, for example, <B>Copy c:\MyProjects\MyXProc\debug\MyXProc.dll c:\mssql\binn</B>.</P></LI>

	<LI><A HREF="JavaScript:hhobj_1.Click()">Register the extended stored procedure</A>.<BR><BR></LI>

	<LI>Specify SQL Server as the calling executable and working directory for the extended stored procedure DLL.&nbsp; Modify the settings in the <B>Debug</B> tab of the <B>Project Settings</B> dialog box as follows:
<UL type=disc>
	<LI>If SQL Server was installed in the default location, type <B>C:\MSSQL\BINN\SQLSERVR.EXE</B> in the <B>Executable for debug session</B> box.<BR><BR></LI>

	<LI>Set the <B>Working directory</B> entry to <B>C:\MSSQL\BINN</B>.<BR><BR></LI>

	<LI>Set the <B>Program arguments</B> entry to -c.&nbsp; The -c option indicates to SQL Server that it is being started from the command line and not as a service.&nbsp; This will cause SQL Server to start up faster.</LI>
</UL>

<P class=tl>This will start the SQL Server not as a service but as a console application under the control of the Visual C++ debugging environment. This will allow breakpoints to be properly trapped and handled.</P></LI>

	<LI>Set breakpoints in the source code of the extended stored procedure and begin the debugging session.
<P class=tl>A console window will appear as SQL Server starts. When text scrolling stops (the last messsage will say&nbsp; “Launched startup procedure 'sp_sqlregister'”), SQL Server will be started and ready to process requests.</P></LI>

	<LI>Execute the extended stored procedure.&nbsp; You can do this is one of three ways:
<UL type=disc>
	<LI>Start Visual C++ Enterprise Edition and create a database project with a data connection for the database that contains the extended stored procedure.&nbsp; Create an SQL script file that calls the extended stored procedure.<BR><BR></LI>

	<LI>Call the extended stored procedure from your own application.<BR><BR></LI>

	<LI>Use any application that allows you to call extended stored procedures. For example, ISQL/W (included with SQL Server) or ODBC Test (included with ODBC SDK).</LI>
</UL>

<P class=tl>The VC++ debugger will break when a line containing a breakpoint is executed.</P></LI>
</OL>

<P>For specific tips on writing extended stored procedures, consult the SQL Server section of the Microsoft Knowledge Base.</P>

<P><B>See Also&nbsp; </B><A HREF="_core_debugging_dlls.htm">Debugging DLLs</A>, <A HREF="JavaScript:hhobj_2.Click()">Creating an Extended Stored Procedure</A>.</P>
</font>
</BODY>
</HTML>
