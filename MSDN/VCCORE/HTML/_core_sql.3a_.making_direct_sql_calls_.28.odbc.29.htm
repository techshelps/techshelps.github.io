<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQL: Making Direct SQL Calls (ODBC)</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDatabase">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDatabase.3a3a.ExecuteSQL">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_sql.3a_.making_direct_sql_calls_.28.odbc.29"></A>SQL: Making Direct SQL Calls (ODBC)</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains:

<UL type=disc>
	<LI>When to use direct SQL calls.<BR><BR></LI>

	<LI><A HREF="#_core_making_direct_sql_function_calls">How you make direct SQL calls to the data source</A>.</LI>
</UL>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>This information applies to the MFC ODBC classes.&nbsp; If you’re working with the MFC DAO classes, see the topic Comparison of Microsoft Jet Database Engine SQL and ANSI SQL in DAO Help.</P>

<H2><A NAME="_core_when_to_call_sql_directly"></A>When to Call SQL Directly</H2>

<P>To create new tables, drop (delete) tables, alter existing tables, create indexes, and perform other SQL functions that change the <A HREF="_core_data_source_.28.odbc.29.htm">data source</A> schema, you must issue an SQL statement directly to the data source using Database Definition Language (DDL). When you use ClassWizard to create a recordset for a table — at design time — you can choose which columns of the table to represent in the recordset. This doesn’t allow for columns you or another user of the data source add to the table later, after your program has been compiled. The database classes don’t support DDL directly, but you can still write code to bind a new column to your recordset dynamically, at run time. For information on how to do this binding, see the article <A HREF="_core_recordset.3a_.dynamically_binding_data_columns_.28.odbc.29.htm">Recordset: Dynamically Binding Data Columns (ODBC)</A>. </P>

<P>You can use the DBMS itself to alter the schema, or another tool that lets you perform DDL functions. </P>

<P>You can also use ODBC function calls for sending SQL statements, such as calling a predefined query (stored procedure) that doesn’t return records.</P>

<H2><A NAME="_core_making_direct_sql_function_calls"></A>Making Direct SQL Function Calls</H2>

<P>You can directly execute an SQL call using a <A HREF="JavaScript:hhobj_3.Click()">CDatabase</A> object. Set up your SQL statement string (usually in a <B>CString</B>) and pass it to the <A HREF="JavaScript:hhobj_4.Click()">ExecuteSQL</A> member function of your <B>CDatabase</B> object. If you use ODBC function calls to send an SQL statement that normally returns records, the records are ignored. </P>
</font>
</BODY>
</HTML>
