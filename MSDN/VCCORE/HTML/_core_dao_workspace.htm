<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO Workspace</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfcnotes_tn054">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_workspace"></A>DAO Workspace</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains the role of <A HREF="JavaScript:hhobj_3.Click()">CDaoWorkspace</A> objects in your application. For task-oriented information about using workspaces, see the article <A HREF="_core_dao_database.3a_.using_workspaces_and_databases.htm">DAO Database: Using Workspaces and Databases</A>. For an understanding of the DAO workspace object underlying each MFC <B>CDaoWorkspace</B> object, see the topic "Workspace Object" in DAO Help.</P>

<P>Topics covered include:

<UL type=disc>
	<LI><A HREF="#_core_workspace.3a_.definition">Workspace: definition</A><BR><BR></LI>

	<LI><A HREF="#_core_mfc_workspaces_are_transaction_spaces">MFC workspaces are transaction spaces</A><BR><BR></LI>

	<LI><A HREF="#_core_database_engine_access">Database engine access</A><BR><BR></LI>

	<LI><A HREF="#_core_workspace_collections">Workspace collections</A><BR><BR></LI>

	<LI><A HREF="#_core_default_workspace">Default workspace</A><BR><BR></LI>

	<LI><A HREF="#_core_workspace_roles">Workspace roles</A><BR><BR></LI>

	<LI><A HREF="#_core_accessing_workspace_objects">Accessing workspace objects</A><BR><BR></LI>

	<LI><A HREF="#_core_workspace_persistence">Workspace persistence</A><BR><BR></LI>

	<LI><A HREF="#_core_further_reading_about_workspaces">Further reading about workspaces</A></LI>
</UL>

<H2><A NAME="_core_workspace.3a_.definition"></A>Workspace: Definition</H2>

<P>A DAO workspace, represented in MFC by class <A HREF="JavaScript:hhobj_4.Click()">CDaoWorkspace</A>, manages a session with the Microsoft Jet database engine. A workspace can contain one or more open DAO database objects, represented in your program, explicitly or implicitly, by <A HREF="JavaScript:hhobj_5.Click()">CDaoDatabase</A> objects. In DAO, workspaces manage a single transaction space in which any transaction applies to all open databases and recordsets. DAO workspaces also manage database security. </P>



<H2><A NAME="_core_mfc_workspaces_are_transaction_spaces"></A>Transaction Spaces</H2>

<P>In MFC, workspaces are primarily transaction spaces; MFC does not expose DAO's security features, although you can program them yourself by directly calling DAO. For more information, see <A HREF="JavaScript:hhobj_6.Click()">Technical Note 54</A>.</P>

<H2><A NAME="_core_database_engine_access"></A>Database Engine Access</H2>

<P>In DAO, a separate DBEngine object manages the properties of the single instance of the Microsoft Jet database engine underlying multiple open workspaces. In MFC, access to the database engine's properties is through static member functions of class <A HREF="JavaScript:hhobj_7.Click()">CDaoWorkspace</A>. For more information, see the article <A HREF="_core_dao_workspace.3a_.the_database_engine.htm">DAO Workspace: The Database Engine</A>.</P>



<H2><A NAME="_core_workspace_collections"></A>Workspace Collections</H2>

<P>In DAO:

<UL type=disc>
	<LI>The DBEngine object contains a "collection" of open workspace objects, called the Workspaces collection.<BR><BR></LI>

	<LI>Each DAO workspace object in turn contains collections of open databases, active users, and active user groups. </LI>
</UL>

<P>In MFC, access to both the DBEngine's Workspaces collection and any workspace's Databases collection is through member functions of a <A HREF="JavaScript:hhobj_8.Click()">CDaoWorkspace</A> object. MFC doesn’t provides direct access to the Users collection or the Groups collection, which are part of DAO's security support; and MFC doesn’t expose DAO security features. For information about DAO collections in MFC, see the article <A HREF="_core_dao_collections.htm">DAO Collections</A>.</P>



<H2><A NAME="_core_default_workspace"></A>Default Workspace</H2>

<P>In DAO, the first workspace in the Workspaces collection is called the default workspace. By default, if you open databases, they exist within the default workspace. In MFC, if you open a database object without specifying a workspace, or open a recordset object without specifying a database object, MFC implicitly uses DAO's underlying default workspace to manage transactions.</P>

<P>You seldom have to explicitly create a <A HREF="JavaScript:hhobj_9.Click()">CDaoWorkspace</A> object, but you can create explicit <B>CDaoWorkspace</B> objects if you need an explicit object for any of the activities described in <A HREF="#_core_workspace_roles">Workspace Roles</A>.</P>

<H3>Information About Workspaces in DAO Help</H3>

<P>For information about workspaces in DAO, see the topic "Workspace Object" in DAO Help. For more information about workspaces in MFC, see the rest of this article and the article <A HREF="_core_dao_database.3a_.using_workspaces_and_databases.htm">DAO Database: Using Workspaces and Databases</A>.</P>

<H2><A NAME="_core_workspace_roles"></A>Workspace Roles</H2>

<P><A HREF="JavaScript:hhobj_10.Click()">CDaoWorkspace</A> provides the following:

<UL type=disc>
	<LI>Explicit access to DAO's default workspace.<BR><BR></LI>

	<LI>Access to the Workspaces collection or the default workspace's Databases collection.<BR><BR></LI>

	<LI>A separate transaction space if you need to separate the transactions on one database from those on another database.<BR><BR></LI>

	<LI>Access to the properties of the database engine.</LI>
</UL>



<H2><A NAME="_core_accessing_workspace_objects"></A>Accessing Workspace Objects</H2>

<P>MFC implicitly creates a <A HREF="JavaScript:hhobj_11.Click()">CDaoWorkspace</A> object, and its underlying DAO workspace, when you:

<UL type=disc>
	<LI>Construct a <A HREF="JavaScript:hhobj_12.Click()">CDaoDatabase</A> object without specifying the workspace.<BR><BR></LI>

	<LI>Construct a <A HREF="JavaScript:hhobj_13.Click()">CDaoRecordset</A> object without specifying the database.</LI>
</UL>

<P>See the article <A HREF="_core_dao.3a_.accessing_implicit_mfc_dao_objects.htm">DAO: Accessing Implicit MFC DAO Objects</A> for information on accessing:

<UL type=disc>
	<LI>The <B>CDaoWorkspace</B> object associated with a <B>CDaoDatabase</B> object<BR><BR></LI>

	<LI>The <B>CDaoWorkspace</B> object associated with the <B>CDaoDatabase</B> object associated with a <B>CDaoRecordset</B> object</LI>
</UL>

<H2><A NAME="_core_workspace_persistence"></A>Workspace Persistence</H2>

<P>Workspaces exist in memory for the life of a database engine session. When that session terminates, the default workspace, the Workspaces collection, and the Databases collections of any workspaces cease to exist (the actual databases do persist). These software objects are not stored on disk or in a database. When you begin a new database engine session and want to use the workspaces and databases you used in the last session, you must re-create any explicit workspace objects you need and reopen any databases you want associated with a workspace.</P>

<P class=indent><B><B>Tip&nbsp;&nbsp;&nbsp;</B></B>Use a Windows registry entry to preserve a record of the workspaces and databases you had open during a database engine session.</P>

<H2><A NAME="_core_further_reading_about_workspaces"></A>Further Reading About Workspaces</H2>

<P>For more information about workspaces in MFC see the following articles (in the recommended order):

<UL type=disc>
	<LI><A HREF="_core_dao_database.3a_.using_workspaces_and_databases.htm">DAO Database: Using Workspaces and Databases</A><BR><BR></LI>

	<LI><A HREF="_core_dao_workspace.3a_.explicitly_opening_the_default_workspace.htm">DAO Workspace: Explicitly Opening the Default Workspace</A><BR><BR></LI>

	<LI><A HREF="_core_dao.3a_.accessing_implicit_mfc_dao_objects.htm">DAO: Accessing Implicit MFC DAO Objects</A><BR><BR></LI>

	<LI><A HREF="_core_dao_workspace.3a_.opening_a_separate_transaction_space.htm">DAO Workspace: Opening a Separate Transaction Space</A><BR><BR></LI>

	<LI><A HREF="_core_dao_workspace.3a_.accessing_properties_of_the_database_engine.htm">DAO Workspace: Accessing Properties of the Database Engine</A><BR><BR></LI>

	<LI><A HREF="_core_dao_collections.htm">DAO Collections</A></LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao_database.3a_.using_workspaces_and_databases.htm">DAO Database: Using Workspaces and Databases</A>, <A HREF="_core_dao_workspace.3a_.the_database_engine.htm">DAO Workspace: The Database Engine</A>, <A HREF="_core_dao_database.htm">DAO Database</A>, <A HREF="_core_dao.3a_.creating.2c_.opening.2c_.and_closing_dao_objects.htm">DAO: Creating, Opening, and Closing DAO Objects</A></P>
</font>
</BODY>
</HTML>
