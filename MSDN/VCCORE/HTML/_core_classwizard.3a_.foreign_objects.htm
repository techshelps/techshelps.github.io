<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ClassWizard: Foreign Objects</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Scribble start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CFormView">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordView">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordView">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordView">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordView">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset">
</OBJECT>
<OBJECT ID="hhobj_15" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_classwizard.3a_.foreign_objects"></A>ClassWizard: Foreign Objects</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_working_with_classes.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_working_with_classes_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A></P>

<P>ClassWizard extends dialog data exchange (DDX) by allowing you to map controls on a form or dialog box indirectly to a "foreign object" — a <A HREF="JavaScript:hhobj_3.Click()">CRecordset</A> or <A HREF="JavaScript:hhobj_4.Click()">CDaoRecordset</A> object. This article explains:

<UL type=disc>
	<LI><A HREF="#_core_foreign_objects">What foreign objects are</A>.<BR><BR></LI>

	<LI><A HREF="#_core_classwizard_and_foreign_objects">How to use foreign objects</A>. </LI>
</UL>



<H2><A NAME="_core_foreign_objects"></A>Foreign Objects</H2>

<P>The best way to understand foreign objects is to consider DDX for a dialog box or form view and then see how it is extended. This discussion considers a form view, based on class <A HREF="JavaScript:hhobj_5.Click()">CFormView</A>.</P>

<P>DDX maps the controls in a form view to data members of the <B>CFormView</B>-derived class associated with the dialog-template resource. Controls in a form view correspond one-to-one with form view class data members. Two entities are connected: the form view on the screen and the form view class. (Dialog boxes work this way too.)</P>

<P>DDX for foreign objects connects not two entities but three. The following figure shows this connection, with a record view on screen at one end, a <A HREF="JavaScript:hhobj_6.Click()">CRecordView</A> class in the middle, and a third object — the foreign object — at the other end: a <A HREF="JavaScript:hhobj_7.Click()">CRecordset</A> object. (These could be a <A HREF="JavaScript:hhobj_8.Click()">CDaoRecordView</A> and a <A HREF="JavaScript:hhobj_9.Click()">CDaoRecordset</A>.)</P>

<P class=label><B>DDX for Foreign Objects</B></P>

<P><IMG SRC="mcddxf.gif" ALT="" BORDER=0></P>

<P>The record view class in the preceding figure contains a member variable, a pointer whose type matches the class of the foreign object. The DDX mapping is from three record view controls to members of the foreign object through the pointer, as illustrated by the following <B>DoDataExchange</B> function:</P>

<PRE><CODE>void CSectionForm::DoDataExchange(CDataExchange* pDX)
{
  CRecordView::DoDataExchange(pDX);
  //{{AFX_DATA_MAP(CSectionForm)
  DDX_FieldText(pDX, IDC_COURSE,
    m_pSet-&gt;m_strCourseID, m_pSet);
  DDX_FieldText(pDX, IDC_INSTRUCTOR,
    m_pSet-&gt;m_strInstructorID, m_pSet);
  DDX_FieldText(pDX, IDC_ROOMNO,
    m_pSet-&gt;m_strRoomNo, m_pSet);
  //}}AFX_DATA_MAP
} 
</CODE></PRE>

<P>Notice the indirect reference to recordset fields, through the <CODE>m_pSet</CODE> pointer to a <CODE>CSections</CODE> recordset object:</P>

<PRE><CODE>m_pSet-&gt;m_strCourseID
</CODE></PRE>

<P>Also notice that <CODE>m_pSet</CODE> is repeated as the fourth argument in each <B>DDX_FieldText</B> call.</P>



<H2><A NAME="_core_classwizard_and_foreign_objects"></A>ClassWizard and Foreign Objects</H2>

<P>You set the foreign class and object on ClassWizard's Class Info tab. The Foreign Class box names the class of the foreign object (<A HREF="JavaScript:hhobj_10.Click()">CRecordset</A> for ODBC or <A HREF="JavaScript:hhobj_11.Click()">CDaoRecordset</A> for DAO). The Foreign Object box names the pointer variable that points to an object of that class. (You can specify only one foreign object per class.)</P>

<P>If you select a class based on a dialog-template resource on ClassWizard's Member Variables tab, ClassWizard locates the appropriate pointer variable in the class and puts its type into the Foreign Class box. It also puts the variable name into the Foreign Object box. You can change these values if you wish.</P>

<P>If you create a <A HREF="JavaScript:hhobj_12.Click()">CRecordView</A> or <A HREF="JavaScript:hhobj_13.Click()">CDaoRecordView</A> class with AppWizard and then use ClassWizard to specify the DDX connections, ClassWizard automatically notes the presence in the view class of a pointer to a <A HREF="JavaScript:hhobj_14.Click()">CRecordset</A>-derived or <A HREF="JavaScript:hhobj_15.Click()">CDaoRecordset</A>-derived object. ClassWizard sets this as the value in the Foreign Class box. It puts the name of the pointer variable into the Foreign Object box.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_classwizard.3a_.mapping_form_controls_to_recordset_fields.htm">ClassWizard: Mapping Form Controls to Recordset Fields</A> </P>
</font>
</BODY>
</HTML>
