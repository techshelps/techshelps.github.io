<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>_CrtIsMemoryBlock</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_crt__crtismemoryblock"></A><SUP></SUP>_CrtIsMemoryBlock</H1>

<P>Verifies that a specified memory block is in the local heap and that it has a valid debug heap block type identifier (debug version only).</P>

<P><B>int</B> <B>_CrtIsMemoryBlock(</B> <B>const</B> <B>void</B> *<I>userData</I><B>,</B> <B>unsigned</B> <B>int</B> <I>size</I><B>,</B> <B>long</B> <I>*requestNumber</I><B>,</B> <B>char</B> **<I>filename</I><B>,</B> <B>int</B> <I>*linenumber</I> <B>);</B></P>

<TABLE border=1 cellpadding=5 cols=3 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=30%><B>Routine</B></TD>
<TD class=label width=24%><B>Required Header</B></TD>
<TD class=label width=46%><B>Compatibility</B></TD>
</TR>

<TR VALIGN="top">
<TD width=30%><B>_CrtIsMemoryBlock</B></TD>
<TD width=24%>&lt;crtdbg.h&gt;</TD>
<TD width=46%>Win NT, Win 95</TD>
</TR>
</TABLE><BR>

<P>For additional compatibility information, see <A HREF="_crt_compatibility.htm">Compatibility</A> in the Introduction.</P>

<P class=label><B>Libraries</B></P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD width=24%>LIBCD.LIB</TD>
<TD width=76%>Single thread static library, debug version</TD>
</TR>

<TR VALIGN="top">
<TD width=24%>LIBCMTD.LIB</TD>
<TD width=76%>Multithread static library, debug version</TD>
</TR>

<TR VALIGN="top">
<TD width=24%>MSVCRTD.LIB</TD>
<TD width=76%>Import library for MSVCRTD.DLL, debug version</TD>
</TR>
</TABLE><BR>

<P class=label><B>Return Value</B></P>

<P><B>_CrtIsMemoryBlock</B> returns TRUE if the specified memory block is located within the local heap and has a valid debug heap block type identifier; otherwise, the function returns FALSE.</P>

<P class=label><B>Parameter</B></P>

<P class=dt><I>userData</I></P>

<P class=indent>Pointer to the beginning of the memory block to verify</P>

<P class=dt><I>size</I></P>

<P class=indent>Size of the specified block (bytes)</P>

<P class=dt><I>requestNumber</I></P>

<P class=indent>Pointer to the allocation number of the block or NULL</P>

<P class=dt><I>filename</I></P>

<P class=indent>Pointer to name of source file that requested the block or NULL</P>

<P class=dt><I>linenumber</I></P>

<P class=indent>Pointer to the line number in the source file or NULL</P>

<P class=label><B>Remarks</B></P>

<P>The <B>_CrtIsMemoryBlock</B> function verifies that a specified memory block is located within the application’s local heap and that it has a valid block type identifier. This function can also be used to obtain the object allocation order number and source file name/line number where the memory block allocation was originally requested. Passing non-NULL values for the <I>requestNumber</I>, <I>filename</I>, and/or <I>linenumber</I> parameters causes <B>_CrtIsMemoryBlock</B> to set these parameters to the values in the memory block’s debug header, if it finds the block in the local heap. When <A HREF="_crt__debug.htm">_DEBUG</A> is not defined, calls to <B>_CrtIsMemoryBlock</B> are removed during preprocessing.</P>

<P>Because this function returns TRUE or FALSE, it can be passed to one of the <A HREF="_crt__assert.2c_._asserte_macros.htm">_ASSERT</A> macros to create a simple debugging error handling mechanism. The following example will cause an assertion failure if the specified address is not located within the local heap:</P>

<PRE><CODE>_ASSERTE( _CrtIsMemoryBlock( userData, size, &amp;requestNumber, &amp;filename, &amp;linenumber ) );
</CODE></PRE>

<P>For more information about how <B>_CrtIsMemoryBlock</B> can be used with other debug functions and macros, see <A HREF="_core_using_macros_for_verification_and_reporting.htm">Using Macros for Verification and Reporting</A>. For information about how memory blocks are allocated, initialized, and managed in the debug version of the base heap, see <A HREF="_core_memory_management_and_the_debug_heap.htm">Memory Management and the Debug Heap</A>.</P>

<P class=label><B>Example</B></P>

<PRE><CODE>/*
 * ISVALID.C
 * This program allocates a block of memory using _malloc_dbg
 * and then tests the validity of this memory by calling _CrtIsMemoryBlock,
 * _CrtIsValidPointer, and _CrtIsValidHeapPointer.
 */

#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;malloc.h&gt;
#include &lt;crtdbg.h&gt;

#define  TRUE   1
#define  FALSE  0

void main( void )
{
        char *my_pointer;

        /* 
         * Call _malloc_dbg to include the filename and line number
         * of our allocation request in the header information
         */
        my_pointer = (char *)_malloc_dbg( sizeof(char) * 10, _NORMAL_BLOCK, __FILE__, __LINE__ );

        /* 
         * Ensure that the memory got allocated correctly
         */
        _CrtIsMemoryBlock((const void *)my_pointer, sizeof(char) * 10, NULL, NULL, NULL );

        /* 
         * Test for read/write accessibility
         */
        if (_CrtIsValidPointer((const void *)my_pointer, sizeof(char) * 10, TRUE))
                printf("my_pointer has read and write accessibility.\n");
        else
                printf("my_pointer only has read access.\n");

        /* 
         * Make sure my_pointer is within the local heap
         */
        if (_CrtIsValidHeapPointer((const void *)my_pointer))
                printf("my_pointer is within the local heap.\n");
        else
                printf("my_pointer is not located within the local heap.\n");

        free(my_pointer);
}
</CODE></PRE>

<P class=label><B>Output</B></P>

<PRE><CODE>my_pointer has read and write accessibility.
my_pointer is within the local heap.

</CODE></PRE>

<P><A HREF="_crt_debug_functions.htm">Debug Functions</A></P>
</font>
</BODY>
</HTML>
