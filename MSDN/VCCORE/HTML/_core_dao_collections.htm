<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO Collections</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace.3a3a.GetWorkspaceCount">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace.3a3a.GetWorkspaceInfo">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase.3a3a.GetTableDefCount">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase.3a3a.GetTableDefInfo">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_DAOVIEW">
</OBJECT>
<OBJECT ID="hhobj_15" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace.3a3a.GetDatabaseInfo">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_collections"></A>DAO Collections</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains how to access the “collections” in which DAO keeps active DAO objects at all levels of the DAO object hierarchy. The article also explains how the collections are exposed in MFC. Topics covered include:

<UL type=disc>
	<LI><A HREF="#_core_dao_collections.3a_.definition">DAO collections: definitions</A><BR><BR></LI>

	<LI><A HREF="#_core_how_mfc_exposes_dao_collections">How MFC exposes DAO collections</A><BR><BR></LI>

	<LI><A HREF="#_core_the_default_object_in_a_collection">The default object in a collection</A><BR><BR></LI>

	<LI><A HREF="#_core_how_to_access_a_collection">How to access a collection</A><BR><BR></LI>

	<LI><A HREF="#_core_the_information_you_obtain_about_objects_in_a_collection">The information you obtain about objects in a collection</A><BR><BR></LI>

	<LI><A HREF="#_core_contents_of_mfc_dao_information_structures">Contents of MFC DAO information structures</A><BR><BR></LI>

	<LI><A HREF="#_core_primary.2c_.secondary.2c_.and_all_information">Primary, Secondary, and All information</A><BR><BR></LI>

	<LI><A HREF="#_core_information_about_collections_in_dao">Information about collections in DAO</A></LI>
</UL>

<H2><A NAME="_core_dao_collections.3a_.definition"></A>DAO Collections: Definition</H2>

<P>In DAO, each object in the object hierarchy maintains one or more "collections" of subordinate objects. For example, the Microsoft Jet database engine maintains a collection of open workspaces. Each workspace object maintains a collection of open databases (and other collections, related to security). And so on. For a list of the DAO objects and the collections they house, see the topic "Data Access Objects and Collections Reference" in DAO Help.</P>



<H2><A NAME="_core_how_mfc_exposes_dao_collections"></A>How MFC Exposes DAO Collections</H2>

<P>In the MFC DAO classes, MFC doesn't maintain a collection (such as a <B>CObArray</B>) of C++ objects parallel to the underlying DAO collection. Rather, MFC supplies member functions and/or data members through which you can access the underlying collection itself in DAO, where the DAO collections are stored. For example, class <A HREF="JavaScript:hhobj_3.Click()">CDaoWorkspace</A> supplies the <A HREF="JavaScript:hhobj_4.Click()">GetWorkspaceCount</A> member function to determine how many workspaces are in the database engine's Workspaces collection and the <A HREF="JavaScript:hhobj_5.Click()">GetWorkspaceInfo</A> member function to examine information about any workspace in the collection. </P>

<P>In general, the MFC DAO classes supply similar functions for all relevant DAO collections. The one significant exception is the Recordsets collection of the database object. MFC does not supply <B>GetRecordsetCount</B> and <B>GetRecordsetInfo</B> member functions in class <A HREF="JavaScript:hhobj_6.Click()">CDaoDatabase</A>. When you work with recordsets, you always have an explicit MFC <A HREF="JavaScript:hhobj_7.Click()">CDaoRecordset</A> object in your application. It's up to you to keep track of which recordsets you have open.</P>



<H2><A NAME="_core_the_default_object_in_a_collection"></A>The Default Object in a Collection</H2>

<P>The first element in a DAO collection, at element 0, is the default element of the collection. In particular, DAO's default workspace is element 0 in the Workspaces collection. Collections are zero-based.</P>



<H2><A NAME="_core_how_to_access_a_collection"></A>How to Access a Collection</H2>

<P>The following procedure uses the TableDefs collection of a <A HREF="JavaScript:hhobj_8.Click()">CDaoDatabase</A> object to illustrate the general process for accessing objects in a DAO collection.</P>

<P class=label><B>To access the TableDefs collection (for example)</B>

<OL>
	<LI>Construct a <A HREF="JavaScript:hhobj_9.Click()">CDaoDatabase</A> object, or get a pointer to one from a <A HREF="JavaScript:hhobj_10.Click()">CDaoRecordset</A> object. <BR><BR></LI>

	<LI>Call the object's <A HREF="JavaScript:hhobj_11.Click()">Open</A>  member function unless you have obtained a database pointer from a recordset.<BR><BR></LI>

	<LI>Use the <A HREF="JavaScript:hhobj_12.Click()">GetTableDefCount</A> and <A HREF="JavaScript:hhobj_13.Click()">GetTableDefInfo</A> member functions of the object to determine how many tabledefs the collection contains and to loop through the collection, obtaining information about each tabledef object.</LI>
</OL>

<P>For an example, see the LISTVIEW.CPP file in the MFC Database sample <A HREF="JavaScript:hhobj_14.Click()">DAOVIEW</A>. For a procedure, see the article <A HREF="_core_dao_collections.3a_.obtaining_information_about_dao_objects.htm">DAO Collections: Obtaining Information About DAO Objects</A>.</P>



<H2><A NAME="_core_the_information_you_obtain_about_objects_in_a_collection"></A>The Information You Obtain About Objects in a Collection</H2>

<P>To obtain information about the objects in a collection, you call a <I>GetXInfo</I> member function of the appropriate class. This function returns an object of one of the <I>CDaoXInfo</I> structures listed in the table <A HREF="_core_classes_for_obtaining_information_about_collections.htm">Classes for Obtaining Information About DAO Objects</A> in the article <A HREF="_core_dao_collections.3a_.obtaining_information_about_dao_objects.htm">DAO Collections: Obtaining Information About DAO Objects</A>. In general, there is a <I>CDaoXInfo</I> structure associated with each DAO object. These structures are commonly referred to as the MFC DAO “information structures.”</P>

<H2><A NAME="_core_contents_of_mfc_dao_information_structures"></A>Contents of MFC DAO Information Structures</H2>

<P>A typical information structure looks something like this:</P>

<PRE><CODE>struct CDaoDatabaseInfo
{
   CString m_strName;       // Primary
   BOOL m_bUpdatable;       // Primary
   BOOL m_bTransactions;    // Primary
   CString m_strVersion;    // Secondary
   long m_lCollatingOrder;  // Secondary
   short m_nQueryTimeout;   // Secondary
   CString m_strConnect;    // All
};
</CODE></PRE>

<P>For detailed descriptions of the structure members, see the individual structure in the <I>Class Library Reference</I>. Structures are listed in the table <A HREF="_core_classes_for_obtaining_information_about_collections.htm">Classes for Obtaining Information About DAO Objects</A> in the article <A HREF="_core_dao_collections.3a_.obtaining_information_about_dao_objects.htm">DAO Collections: Obtaining Information About DAO Objects</A>.</P>

<H2><A NAME="_core_primary.2c_.secondary.2c_.and_all_information"></A>Primary, Secondary, and All Information</H2>

<P>The notations “Primary,” “Secondary,” and “All” indicate which MFC DAO structure members are filled when you call a function such as <A HREF="JavaScript:hhobj_15.Click()">GetDatabaseInfo</A>. You can specify that you want just primary information, both primary and secondary information, or all information. Some structures don’t include anything under the All designation.</P>

<P class=indent><B><B>Caution&nbsp;&nbsp;&nbsp;</B></B>Using the Secondary and All options can be slow. In general, Primary is faster than Secondary, and Secondary is faster than All. Don’t use All unless you must.</P>

<P>For more information about using <B>GetTableDefCount</B>, <B>GetTableDefInfo</B>, and similar functions, see the article <A HREF="_core_dao_collections.3a_.obtaining_information_about_dao_objects.htm">DAO Collections: Obtaining Information About DAO Objects</A>.</P>

<H2><A NAME="_core_information_about_collections_in_dao"></A>Information About Collections in DAO</H2>

<P>For general information about the DAO collections, see the topic "Data Access Objects and Collections Reference" in DAO Help. </P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A></P>
</font>
</BODY>
</HTML>
