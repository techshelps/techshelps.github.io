<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO: Database Application Design Options</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordView">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_DAOENROL">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordView">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_ENROLL">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordView">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CListView">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CTreeView">
</OBJECT>
<OBJECT ID="hhobj_15" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_DAOVIEW">
</OBJECT>
<OBJECT ID="hhobj_16" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Scribble enhancing views">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao.3a_.database_application_design_options"></A>DAO: Database Application Design Options</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article continues the discussion begun in the article <A HREF="_core_dao.3a_.writing_a_database_application.htm">DAO: Writing a Database Application</A>. The article <A HREF="_core_dao.3a_.steps_in_writing_mfc_dao_applications.htm">DAO: Steps in Writing MFC DAO Applications</A> completes the discussion. Those articles discuss the decisions you need to make before you run AppWizard and the steps involved in creating your starter application.</P>

<P>Topics covered include:

<UL type=disc>
	<LI><A HREF="#_core_application_design_examples">Application design examples</A><BR><BR></LI>

	<LI><A HREF="#_core_dao_in_dlls.2c_.multithreaded_applications.2c_.and_activex_controls">DAO in DLLs, multithreaded applications, and ActiveX controls</A></LI>
</UL>



<H2><A NAME="_core_application_design_examples"></A>Application Design Examples</H2>

<P>This article gives examples to suggest some of the ways you might organize your application. Sample applications mentioned in the list are available under Visual C++ Programmer’s Guide/Samples in the documentation.</P>

<P>Examples:

<UL type=disc>
	<LI>An application that uses a single form to view one record at a time. 
<P class=tl>This approach might be suitable for simple data entry or data viewing applications. </P>
<P class=tl>Let AppWizard create the <A HREF="JavaScript:hhobj_3.Click()">CDaoRecordView</A> and <A HREF="JavaScript:hhobj_4.Click()">CDaoRecordset</A> classes for you. Then design the form in the Visual C++ dialog editor. </P>
<P class=tl>In this scenario, a single <B>CDaoRecordset</B> object persists for a session, and it uses an implicitly created <A HREF="JavaScript:hhobj_5.Click()">CDaoDatabase</A> object. The recordset, a data member of the <B>CDaoRecordView</B> class called <B>m_pSet</B>, contains all records in a table or all records returned by a query. The view lets the user scroll through the records one at a time. </P>
<P class=tl>For an example, see Step 1 of the MFC Database sample <A HREF="JavaScript:hhobj_6.Click()">DAOENROL</A>. </P></LI>

	<LI>A similar single-form application that displays one record at a time but also uses a second recordset to fill a list box or combo box. 
<P class=tl>Let AppWizard create the <A HREF="JavaScript:hhobj_7.Click()">CDaoRecordView</A> and a <A HREF="JavaScript:hhobj_8.Click()">CDaoRecordset</A> to control which record is currently displayed in the form's general controls. </P>
<P class=tl>Use ClassWizard to create a second <B>CDaoRecordset</B> based on the table or query that fills the list or combo box. </P>
<P class=tl>For a view of how this works, see the MFC Database sample <A HREF="JavaScript:hhobj_9.Click()">ENROLL</A> for the MFC ODBC classes. You’ll have to translate some of the code, but the model is the same in DAO, and most of the code is very similar as well. </P>
<P class=tl>Create additional recordsets to fill more list or combo boxes as needed. </P></LI>

	<LI>An application based on multiple forms. 
<P class=tl>Perhaps the forms appear in separate windows or as panes in a splitter window. Let AppWizard create the first <A HREF="JavaScript:hhobj_10.Click()">CDaoRecordView</A> and <A HREF="JavaScript:hhobj_11.Click()">CDaoRecordset</A>. Then use ClassWizard to add more of each. </P></LI>

	<LI>A bulk data processing application, where no view is required. 
<P class=tl>In AppWizard, select basic database support, without a view. A dialog-based application might be appropriate for this need. </P>
<P class=tl>Use ClassWizard to create a <A HREF="JavaScript:hhobj_12.Click()">CDaoRecordset</A> class for each end of the migration. Then write code to use one recordset for input and the other for output. Perform any necessary data manipulation between the two recordsets. Note that you can use the MFC DAO classes in console applications. For more information, see <A HREF="#_core_dao_in_dlls.2c_.multithreaded_applications.2c_.and_activex_controls">DAO in DLLs, Multithreaded Applications, and ActiveX Controls</A>.</P></LI>

	<LI>An application that displays multiple records at a time, perhaps in a <A HREF="JavaScript:hhobj_13.Click()">CListView</A> or a <A HREF="JavaScript:hhobj_14.Click()">CTreeView</A>. 
<P class=tl>Use AppWizard to specify the view class on which to base your application-specific view. You can also use multiple views, perhaps displayed as panes of a splitter window. </P>
<P class=tl>For an example, see the MFC Database sample <A HREF="JavaScript:hhobj_15.Click()">DAOVIEW</A>. </P></LI>
</UL>

<P>For information about splitter windows, see <A HREF="JavaScript:hhobj_16.Click()">Enhancing Views</A> in the Scribble tutorial. For information about using multiple views in general, see <A HREF="_core_multiple_document_types.2c_.views.2c_.and_frame_windows.htm">Multiple Document Types, Views, and Frame Windows</A>.</P>



<H2><A NAME="_core_dao_in_dlls.2c_.multithreaded_applications.2c_.and_activex_controls"></A>DAO in DLLs, Multithreaded Applications, and ActiveX Controls</H2>

<P>This topic discusses the MFC DAO classes with respect to support for using the MFC DAO classes:

<UL type=disc>
	<LI>In dynamic link libraries (DLLs)<BR><BR></LI>

	<LI>In ActiveX controls<BR><BR></LI>

	<LI>In multithreaded applications<BR><BR></LI>

	<LI>In console applications<BR><BR></LI>

	<LI>In applications built for Unicode or double-byte character systems (DBCS)</LI>
</UL>

<P>You can use the MFC DAO classes in any DLL, as well as in <A HREF="_core_activex_control_topics.htm">ActiveX controls</A>. For more information about using the MFC DAO classes in a DLL, see the article <A HREF="_core_dao.3a_.using_dao_in_dlls.htm">DAO: Using DAO in DLLs</A>. </P>

<P>DAO itself is not <A HREF="_core_multithreading_topics.htm">multithreaded</A>, so you can’t use the MFC DAO classes in multiple threads. Confine your DAO code to a single thread of execution.</P>

<P>Depending on what MFC functionality you call, you should be able to use the MFC DAO classes in console applications as well. Make sure the application uses no graphical user-interface elements. For example, if you’re using an ODBC data source and you supply incomplete connection information, ODBC attempts to display a dialog box for the missing information. Avoid this situation in your console applications.</P>

<P>The MFC DAO classes are fully enabled for Unicode and DBCS.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao.3a_.database_tasks.htm">DAO: Database Tasks</A>, <A HREF="_core_dao.3a_.writing_a_database_application.htm">DAO: Writing a Database Application</A>, <A HREF="_core_dao.3a_.steps_in_writing_mfc_dao_applications.htm">DAO: Steps in Writing MFC DAO Applications</A>, <A HREF="_core_mfc.3a_.using_database_classes_with_documents_and_views.htm">MFC: Using Database Classes with Documents and Views</A>, <A HREF="_core_mfc.3a_.using_database_classes_without_documents_and_views.htm">MFC: Using Database Classes Without Documents and Views</A></P>
</font>
</BODY>
</HTML>
