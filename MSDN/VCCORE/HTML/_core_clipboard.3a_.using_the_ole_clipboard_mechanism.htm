<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Clipboard: Using the OLE Clipboard Mechanism</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_win32_RegisterClipboardFormat">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_clipboard.3a_.using_the_ole_clipboard_mechanism"></A>Clipboard: Using the OLE Clipboard Mechanism</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_clipboard.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_clipboard_tasks.htm">How Do I</A></P>

<P>OLE uses standard formats and some OLE-specific formats for transferring data through the Clipboard.</P>

<P>When you cut or copy data from an application, the data is stored on the Clipboard to be used later in paste operations. This data is in a variety of formats. When a user chooses to paste data from the Clipboard, the application can choose which of these formats to use. The application should be written to choose the format that provides the most information, unless the user specifically asks for a certain format, using Paste Special. Before continuing, you may want to read the <A HREF="_core_data_objects_and_data_sources_.28.ole.29.htm">Data Objects and Data Sources (OLE)</A> family of articles. They describe the fundamentals of how data transfers work, and how to implement them in your applications.</P>

<P>Windows defines a number of standard formats that can be used for transferring data through the Clipboard. These include metafiles, text, bitmaps, and others. OLE defines a number of OLE-specific formats, as well. It is a good idea for applications that need more detail than given by these standard formats to register their own custom Clipboard formats. Use the Win32 API function <A HREF="JavaScript:hhobj_2.Click()">RegisterClipboardFormat</A> to do this.</P>

<P>For example, Microsoft Excel registers a custom format for spreadsheets. This format carries much more information than, for example, a bitmap does. When this data is pasted into an application that supports the spreadsheet format, all the formulas and values from the spreadsheet are retained and can be updated if necessary. Microsoft Excel also puts data on the Clipboard in formats so that it can be pasted as an OLE item. Any OLE document container can paste this information as an embedded item. This embedded item can be changed using Microsoft Excel. The Clipboard also contains a simple bitmap of the image of the selected range on the spreadsheet. This can also be pasted into OLE document containers or into bitmap editors, like Paint. In the case of a bitmap, however, there is no way to manipuate the data as a spreadsheet.</P>

<P>To retrieve the maximum amount of information from the Clipboard, applications should check for these custom formats before pasting data from the Clipboard.</P>

<P>For example, to enable the Copy command, you might write a handler something like the following:</P>

<PRE><CODE>void CMyView::OnEditCopy()
{
  // Create an OLE data source on the heap
  COleDataSource* pData = new COleDataSource;
  // ...
  // Get the currently selected data
  // ...
  // For the appropriate data formats...
  pData-&gt;CacheData( CF_??, hData );
  // ...
  // The Clipboard now owns the allocated memory
  // and will delete this data object
  // when new data is put on the Clipboard
  pData-&gt;SetClipboard();
}
</CODE></PRE>

<H3>What do you want to know more about?</H3>

<UL type=disc>
	<LI><A HREF="_core_clipboard.3a_.copying_and_pasting_data.htm">Copying and pasting data</A><BR><BR></LI>

	<LI><A HREF="_core_clipboard.3a_.adding_other_formats.htm">Adding other Clipboard formats</A><BR><BR></LI>

	<LI><A HREF="_core_clipboard.3a_.using_the_windows_clipboard.htm">Using the Windows Clipboard</A> <BR><BR></LI>

	<LI><A HREF="_core_ole_background.htm">OLE</A><BR><BR></LI>

	<LI><A HREF="_core_data_objects_and_data_sources_.28.ole.29.htm">OLE data objects and data sources and uniform data transfer</A></LI>
</UL>
</font>
</BODY>
</HTML>
