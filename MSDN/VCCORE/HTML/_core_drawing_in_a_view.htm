<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Drawing in a View</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_scribble">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Scribble view">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDocument.3a3a.UpdateAllViews">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CView.3a3a.OnUpdate">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CWnd.3a3a.OnPaint">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CPaintDC">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDC">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDC">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_core_Microsoft_Foundation_Class_Library_Samples_Index">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_drawing_in_a_view"></A>Drawing in a View</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_document.2f.view.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_document.2f.view_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_3.Click()">Tutorial</A></P>

<P>Nearly all drawing in your application occurs in the view's <CODE>OnDraw</CODE> member function, which you must override in your view class. (The exception is mouse drawing, discussed in <A HREF="_core_interpreting_user_input_through_a_view.htm">Interpreting User Input Through a View</A>.) Your <CODE>OnDraw</CODE> override:

<OL>
	<LI>Gets data by calling the document member functions you provide.<BR><BR></LI>

	<LI>Displays the data by calling member functions of a device-context object that the framework passes to <CODE>OnDraw</CODE>.</LI>
</OL>

<P>When a document's data changes in some way, the view must be redrawn to reflect the changes. Typically, this happens when the user makes a change through a view on the document. In this case, the view calls the document's <A HREF="JavaScript:hhobj_4.Click()">UpdateAllViews</A> member function to notify all views on the same document to update themselves. <B>UpdateAllViews</B> calls each view's <A HREF="JavaScript:hhobj_5.Click()">OnUpdate</A> member function. The default implementation of <B>OnUpdate</B> invalidates the view's entire client area. You can override it to invalidate only those regions of the client area that map to the modified portions of the document.</P>

<P>The <B>UpdateAllViews</B> member function of class <B>CDocument</B> and the <B>OnUpdate</B> member function of class <B>CView</B> let you pass information describing what parts of the document were modified. This "hint" mechanism lets you limit the area that the view must redraw. <B>OnUpdate</B> takes two "hint" arguments. The first, <I>lHint</I>, of type <B>LPARAM</B>, lets you pass any data you like, while the second, <I>pHint</I>, of type <B>CObject</B>*, lets you pass a pointer to any object derived from <B>CObject</B>. </P>

<P>When a view becomes invalid, Windows sends it a <B>WM_PAINT</B> message. The view's <A HREF="JavaScript:hhobj_6.Click()">OnPaint</A> handler function responds to the message by creating a device-context object of class <A HREF="JavaScript:hhobj_7.Click()">CPaintDC</A> and calls your view's <CODE>OnDraw</CODE> member function. You do not normally have to write an overriding <CODE>OnPaint</CODE> handler function.</P>

<P>A <A HREF="_core_device_contexts.htm">device context</A> is a Windows data structure that contains information about the drawing attributes of a device such as a display or a printer. All drawing calls are made through a device-context object. For drawing on the screen, <CODE>OnDraw</CODE> is passed a <B>CPaintDC</B> object. For drawing on a printer, it is passed a <A HREF="JavaScript:hhobj_8.Click()">CDC</A> object set up for the current printer. </P>

<P>Your code for drawing in the view first retrieves a pointer to the document, then makes drawing calls through the device context. The following simple <CODE>OnDraw</CODE> example illustrates the process:</P>

<PRE><CODE>void CMyView::OnDraw( CDC* pDC )
{
    CMyDoc* pDoc = GetDocument();
    CString s = pDoc-&gt;GetData();   // Returns a CString
    CRect rect;

    GetClientRect( &amp;rect );
    pDC-&gt;SetTextAlign( TA_BASELINE | TA_CENTER );
    pDC-&gt;TextOut( rect.right / 2, rect.bottom / 2, 
                  s, s.GetLength() );
}
</CODE></PRE>

<P>In this example, you would define the <CODE>GetData</CODE> function as a member of your derived document class.</P>

<P>The example prints whatever string it gets from the document, centered in the view. If the <CODE>OnDraw</CODE> call is for screen drawing, the <B>CDC</B> object passed in <I>pDC</I> is a <B>CPaintDC</B> whose constructor has already called <B>BeginPaint</B>. Calls to drawing functions are made through the device-context pointer. For information about device contexts and drawing calls, see class <A HREF="JavaScript:hhobj_9.Click()">CDC</A>  in the <I>Class Library Reference</I> and <A HREF="_core_working_with_window_objects.htm">Working with Window Objects</A>.</P>

<P>For more examples of how to write <CODE>OnDraw</CODE>, see the <A HREF="JavaScript:hhobj_10.Click()">MFC Samples</A>.</P>
</font>
</BODY>
</HTML>
