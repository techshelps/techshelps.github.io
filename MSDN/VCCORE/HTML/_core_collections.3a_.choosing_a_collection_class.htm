<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Collections: Choosing a Collection Class</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_Sample_mfc_collect">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_collections.3a_.choosing_a_collection_class"></A>Collections: Choosing a Collection Class</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_collections.2c_.working_with_aggregate_data.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_collection_class_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_3.Click()">Tutorial</A></P>

<P>This article contains detailed information designed to help you choose a collection class for your particular application needs.</P>

<P>Your choice of a collection class depends on a number of factors, including:

<UL type=disc>
	<LI>The features of the class shape: order, indexing, and performance, as shown in the <A HREF="#_core_collection_shape_features">Collection Shape Features</A> table later in this topic<BR><BR></LI>

	<LI>Whether the class uses C++ templates<BR><BR></LI>

	<LI>Whether the elements stored in the collection can be serialized<BR><BR></LI>

	<LI>Whether the elements stored in the collection can be dumped for diagnostics<BR><BR></LI>

	<LI>Whether the collection is type-safe</LI>
</UL>

<P>The following table, <A HREF="#_core_collection_shape_features">Collection Shape Features</A>, summarizes the characteristics of the available collection shapes.

<UL type=disc>
	<LI>Columns 2 and 3 describe each shape’s ordering and access characteristics. In the table, the term “ordered” means that the order in which items are inserted and deleted determines their order in the collection; it does not mean the items are sorted on their contents. The term “indexed” means that the items in the collection can be retrieved by an integer index, much like items in a typical array.<BR><BR></LI>

	<LI>Columns 4 and 5 describe each shape’s performance. In applications that require many insertions into the collection, insertion speed might be especially important; for other applications, lookup speed may be more important.<BR><BR></LI>

	<LI>Column 6 describes whether each shape allows duplicate elements.</LI>
</UL>

<P class=label><B><A NAME="_core_collection_shape_features"></A>Collection Shape Features</B></P>

<TABLE border=1 cellpadding=5 cols=6 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=10%><B><BR>
Shape</B></TD>
<TD class=label width=16%><B><BR>
Ordered?</B></TD>
<TD class=label width=16%><B><BR>
Indexed?</B></TD>
<TD class=label width=15%><B>Insert an element</B></TD>
<TD class=label width=23%><B>Search for specified element</B></TD>
<TD class=label width=20%><B>Duplicate elements?</B></TD>
</TR>

<TR VALIGN="top">
<TD width=10%>List</TD>
<TD width=16%>Yes</TD>
<TD width=16%>No</TD>
<TD width=15%>Fast</TD>
<TD width=23%>Slow</TD>
<TD width=20%>Yes</TD>
</TR>

<TR VALIGN="top">
<TD width=10%>Array</TD>
<TD width=16%>Yes</TD>
<TD width=16%>By int</TD>
<TD width=15%>Slow</TD>
<TD width=23%>Slow</TD>
<TD width=20%>Yes</TD>
</TR>

<TR VALIGN="top">
<TD width=10%>Map</TD>
<TD width=16%>No</TD>
<TD width=16%>By key</TD>
<TD width=15%>Fast</TD>
<TD width=23%>Fast</TD>
<TD width=20%>No (keys)<BR>
Yes (values)</TD>
</TR>
</TABLE><BR>

<P>The following table, <A HREF="#_core_characteristics_of_mfc_collection_classes">Characteristics of MFC Collection Classes</A>, summarizes other important characteristics of specific MFC collection classes as a guide to selection. Your choice may depend on whether the class is based on C++ templates, whether its elements can be serialized via MFC’s document <A HREF="_core_serialization_.28.object_persistence.29.htm">serialization</A> mechanism, whether its elements can be dumped via MFC’s diagnostic dumping mechanism, or whether the class is type-safe — that is, whether you can guarantee the type of elements stored in and retrieved from a collection based on the class.</P>

<P class=label><B><A NAME="_core_characteristics_of_mfc_collection_classes"></A>Characteristics of MFC Collection Classes</B></P>

<TABLE border=1 cellpadding=5 cols=5 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=22%><B><BR>
Class</B></TD>
<TD class=label width=19%><B>Uses C++<BR>
templates</B></TD>
<TD class=label width=20%><B>Can be<BR>
serialized</B></TD>
<TD class=label width=19%><B>Can be<BR>
dumped</B></TD>
<TD class=label width=20%><B>Is<BR>
type-safe</B></TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CArray</B></TD>
<TD width=19%>Yes</TD>
<TD width=20%>Yes <SUP>1</SUP></TD>
<TD width=19%>Yes <SUP>1</SUP></TD>
<TD width=20%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CByteArray</B></TD>
<TD width=19%>No</TD>
<TD width=20%>Yes</TD>
<TD width=19%>Yes</TD>
<TD width=20%>Yes <SUP>3</SUP></TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CDWordArray</B></TD>
<TD width=19%>No</TD>
<TD width=20%>Yes</TD>
<TD width=19%>Yes</TD>
<TD width=20%>Yes <SUP>3</SUP></TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CList</B></TD>
<TD width=19%>Yes</TD>
<TD width=20%>Yes <SUP>1</SUP></TD>
<TD width=19%>Yes <SUP>1</SUP></TD>
<TD width=20%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CMap</B></TD>
<TD width=19%>Yes</TD>
<TD width=20%>Yes <SUP>1</SUP></TD>
<TD width=19%>Yes <SUP>1</SUP></TD>
<TD width=20%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CMapPtrToPtr</B></TD>
<TD width=19%>No</TD>
<TD width=20%>No</TD>
<TD width=19%>Yes</TD>
<TD width=20%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CMapPtrToWord</B></TD>
<TD width=19%>No</TD>
<TD width=20%>No</TD>
<TD width=19%>Yes</TD>
<TD width=20%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CMapStringToOb</B></TD>
<TD width=19%>No</TD>
<TD width=20%>Yes</TD>
<TD width=19%>Yes</TD>
<TD width=20%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CMapStringToPtr</B></TD>
<TD width=19%>No</TD>
<TD width=20%>No</TD>
<TD width=19%>Yes</TD>
<TD width=20%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CMapStringToString</B></TD>
<TD width=19%>No</TD>
<TD width=20%>Yes</TD>
<TD width=19%>Yes</TD>
<TD width=20%>Yes <SUP>3</SUP></TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CMapWordToOb</B></TD>
<TD width=19%>No</TD>
<TD width=20%>Yes</TD>
<TD width=19%>Yes</TD>
<TD width=20%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CMapWordToPtr</B></TD>
<TD width=19%>No</TD>
<TD width=20%>No</TD>
<TD width=19%>Yes</TD>
<TD width=20%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CObArray</B></TD>
<TD width=19%>No</TD>
<TD width=20%>Yes</TD>
<TD width=19%>Yes</TD>
<TD width=20%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CObList</B></TD>
<TD width=19%>No</TD>
<TD width=20%>Yes</TD>
<TD width=19%>Yes</TD>
<TD width=20%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CPtrArray</B></TD>
<TD width=19%>No</TD>
<TD width=20%>No</TD>
<TD width=19%>Yes</TD>
<TD width=20%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CPtrList</B></TD>
<TD width=19%>No</TD>
<TD width=20%>No</TD>
<TD width=19%>Yes</TD>
<TD width=20%>No</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CStringArray</B></TD>
<TD width=19%>No</TD>
<TD width=20%>Yes</TD>
<TD width=19%>Yes</TD>
<TD width=20%>Yes <SUP>3</SUP></TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CStringList</B></TD>
<TD width=19%>No</TD>
<TD width=20%>Yes</TD>
<TD width=19%>Yes</TD>
<TD width=20%>Yes <SUP>3</SUP></TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CTypedPtrArray</B></TD>
<TD width=19%>Yes</TD>
<TD width=20%>Depends <SUP>2</SUP></TD>
<TD width=19%>Yes</TD>
<TD width=20%>Yes</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CTypedPtrList</B></TD>
<TD width=19%>Yes</TD>
<TD width=20%>Depends <SUP>2</SUP></TD>
<TD width=19%>Yes</TD>
<TD width=20%>Yes</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CTypedPtrMap</B></TD>
<TD width=19%>Yes</TD>
<TD width=20%>Depends <SUP>2</SUP></TD>
<TD width=19%>Yes</TD>
<TD width=20%>Yes</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CUIntArray</B></TD>
<TD width=19%>No</TD>
<TD width=20%>No</TD>
<TD width=19%>Yes</TD>
<TD width=20%>Yes <SUP>3</SUP></TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>CWordArray</B></TD>
<TD width=19%>No</TD>
<TD width=20%>Yes</TD>
<TD width=19%>Yes</TD>
<TD width=20%>Yes <SUP>3</SUP></TD>
</TR>
</TABLE><BR>

<P class=mini>1. To serialize, you must explicitly call the collection object’s <B>Serialize</B> function; to dump, you must explicitly call its <B>Dump</B> function. You cannot use the form <CODE>ar &lt;&lt; collObj</CODE> to serialize or the form <CODE>dmp</CODE> <CODE>&lt;&lt; collObj</CODE> to dump.</P>

<P class=mini>2. Serializability depends on the underlying collection type. For example, if a typed pointer array is based on <B>CObArray</B>, it is serializable; if based on <B>CPtrArray</B>, it is not serializable. In general, the “Ptr” classes cannot be serialized.</P>

<P class=mini>3. If marked Yes in this column, a nontemplate collection class is type-safe provided you use it as intended. For example, if you store bytes in a <B>CByteArray</B>, the array is type-safe. But if you use it to store characters, its type safety is less certain.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_collections.3a_.template.2d.based_classes.htm">Collections: Template-Based Classes</A>, <A HREF="_core_collections.3a_.how_to_make_a_type.2d.safe_collection.htm">Collections: How to Make a Type-Safe Collection</A>, <A HREF="_core_collections.3a_.accessing_all_members_of_a_collection.htm">Collections: Accessing All Members of a Collection</A> </P>
</font>
</BODY>
</HTML>
