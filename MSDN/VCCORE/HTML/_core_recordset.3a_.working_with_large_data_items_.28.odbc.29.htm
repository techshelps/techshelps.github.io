<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Recordset: Working with Large Data Items (ODBC)</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CByteArray">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CLongBinary">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CByteArray">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CLongBinary">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfcnotes_TN045">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfcnotes_TN045">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CLongBinary">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CByteArray">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_recordset.3a_.working_with_large_data_items_.28.odbc.29"></A>Recordset: Working with Large Data Items (ODBC)</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article applies to both the MFC ODBC classes and the MFC DAO classes. </P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>If you’re using the MFC DAO classes, manage your large data items with class <A HREF="JavaScript:hhobj_3.Click()">CByteArray</A> rather than class <A HREF="JavaScript:hhobj_4.Click()">CLongBinary</A>. If you're using the MFC ODBC classes with bulk row fetching, use <B>CLongBinary</B> rather than <B>CByteArray</B>. For more information about bulk row fetching, see the article <A HREF="_core_recordset.3a_.fetching_records_in_bulk_.28.odbc.29.htm">Recordset: Fetching Records in Bulk (ODBC)</A>.</P>

<P>Suppose your database can store large pieces of data, such as bitmaps (employee photographs, maps, pictures of products, OLE objects, and so on). This kind of data is often referred to as a Binary Large Object (or BLOB) because:

<UL type=disc>
	<LI>Each field value is large.<BR><BR></LI>

	<LI>Unlike numbers and other simple data types, it has no predictable size.<BR><BR></LI>

	<LI>The data is formless from the perspective of your program.</LI>
</UL>

<P>This article explains what support the database classes provide for working with such objects.</P>

<H2><A NAME="_core_managing_large_objects"></A>Managing Large Objects</H2>

<P>Recordsets have two ways to solve the special difficulty of managing binary large objects. You can use class <A HREF="JavaScript:hhobj_5.Click()">CByteArray</A>, or you can use class <A HREF="JavaScript:hhobj_6.Click()">CLongBinary</A>. In general, <B>CByteArray</B> is the preferred way to manage large binary data.</P>

<P><B>CByteArray</B> requires more overhead than <B>CLongBinary</B> but is more capable, as described in <A HREF="#_core_the_cbytearray_class">The CByteArray Class</A>. <B>CLongBinary</B> is described briefly in <A HREF="#_core_the_clongbinary_class">The CLongBinary Class</A>.</P>

<P>For detailed information about using <B>CByteArray</B> to work with large data items, see <A HREF="JavaScript:hhobj_7.Click()">Technical Note 45</A>.</P>

<H2><A NAME="_core_the_cbytearray_class"></A>The CByteArray Class</H2>

<P><B>CByteArray</B> is one of the MFC collection classes. A <B>CByteArray</B> object stores a dynamic array of bytes — the array can grow if needed. The class provides fast access by index, as with built-in C++ arrays. <B>CByteArray</B> objects can be serialized and dumped for diagnostic purposes. The class supplies member functions for getting and setting specified bytes, inserting and appending bytes, and removing one byte or all bytes. These facilities make parsing the binary data easier. For example, if the binary object is an OLE object, you might have to work through some header bytes to reach the actual object.</P>



<H2><A NAME="_core_using_cbytearray_in_recordsets"></A>Using CByteArray in Recordsets</H2>

<P>By giving a field data member of your recordset the type <B>CByteArray</B>, you provide a fixed base from which <A HREF="_core_record_field_exchange_.28.rfx.29.htm">RFX</A> can manage the transfer of such an object between your recordset and the data source and through which you can manipulate the data inside the object. RFX needs a specific site for retrieved data, and you need a way to access the underlying data.</P>

<P>For detailed information about using <B>CByteArray</B> to work with large data items, see <A HREF="JavaScript:hhobj_8.Click()">Technical Note 45</A>.</P>



<H2><A NAME="_core_the_clongbinary_class"></A>The CLongBinary Class</H2>

<P>A <A HREF="JavaScript:hhobj_9.Click()">CLongBinary</A> object is a simple shell around an <B>HGLOBAL</B> handle to a block of storage allocated on the heap. When it binds a table column containing a binary large object, RFX allocates the <B>HGLOBAL</B> handle when it needs to transfer the data to the recordset and stores the handle in the <B>CLongBinary</B> field of the recordset.</P>

<P>In turn, you use the <B>HGLOBAL</B> handle, <B>m_hData</B>, to work with the data itself, operating on it as you would on any handle data. This is where <A HREF="JavaScript:hhobj_10.Click()">CByteArray</A> adds capabilities.</P>

<P class=indent><B><B>Caution&nbsp;&nbsp;&nbsp;</B>CLongBinary</B> objects can’t be used as parameters in function calls. In addition, their implementation, which calls <B>::SQLGetData</B>, necessarily slows scrolling performance for a scrollable snapshot. This may also be true when you use an <B>::SQLGetData</B> call yourself to retrieve dynamic schema columns.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_recordset.3a_.obtaining_sums_and_other_aggregate_results_.28.odbc.29.htm">Recordset: Obtaining SUMs and Other Aggregate Results (ODBC)</A>, <A HREF="_core_record_field_exchange_.28.rfx.29.htm">Record Field Exchange</A> </P>
</font>
</BODY>
</HTML>
