<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Add Code to the MFC DLL Starter Files</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_begin_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="MFC Samples">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_add_code_to_the_mfc_dll_starter_files"></A>Add Code to the MFC DLL Starter Files</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_overview.3a_.creating_an_mfc_dll.htm">Overview</A>  |&nbsp; <A HREF="_core_create_an_mfc_dll_with_appwizard.htm">How Do I</A>  |&nbsp; <A HREF="_core_details.3a_.beginning_your_program.htm">Details</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Sample</A></P>

<P>If your DLL needs initialization or termination code, where you add that code depends on the kind of DLL that you have created.</P>

<P>For <A HREF="_core_extension_dlls.3a_.overview.htm">extension DLLs</A>, the .CPP file that AppWizard creates contains the function <B>DllMain. </B>Any initialization or termination code for your DLL should be added to this function.</P>

<P>For <A HREF="_core_regular_dlls_dynamically_linked_to_mfc.3a_.overview.htm">regular DLLs</A>, initialization code should be added to the <B>InitInstance</B> member function of the application-derived <B>CWinApp</B> class. Termination code should be added to <B>ExitInstance</B>.</P>

<P>Add the rest of your code to either the .CPP file created by AppWizard or create new source files and add them to the project. Make sure you have exported the entry points to your DLL by using either the keyword <B>__declspec(dllexport)</B> or by listing the functions in the DLL’s .DEF file. If exporting C++ classes, you may want to use the <B>AFX_EXT_CLASS</B> macro.</P>

<P>The easiest way to add functions and navigate to them in your starter files is by using either <A HREF="_core_using_classwizard.htm">ClassWizard</A> or <A HREF="_core_using_wizardbar.htm">WizardBar</A>.</P>

<H3>What do you want to do?</H3>

<UL type=disc>
	<LI><A HREF="_core_dlls.3a_.overview.htm">Learn more about DLLs</A><BR><BR></LI>

	<LI><A HREF="_core_export_from_a_dll.htm">Export from a DLL</A><BR><BR></LI>

	<LI><A HREF="_core_link_an_executable_to_a_dll.htm">Link an executable to a DLL</A><BR><BR></LI>

	<LI><A HREF="_core_initialize_a_dll.htm">Initialize a DLL</A></LI>
</UL>
</font>
</BODY>
</HTML>
