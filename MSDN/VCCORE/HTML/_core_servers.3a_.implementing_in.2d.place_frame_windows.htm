<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Servers: Implementing In-Place Frame Windows</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_COleIPFrameWnd">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_COleResizeBar">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDocTemplate.3a3a.SetServerInfo">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_servers.3a_.implementing_in.2d.place_frame_windows"></A>Servers: Implementing In-Place Frame Windows</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_ole_in_mfc.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_ole_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_ole_sample_list.htm">Sample</A>  |&nbsp; <A HREF="_core_ole_tutorial_list.htm">Tutorial</A></P>

<P>This article explains what you must do to implement in-place frame windows in your visual editing server application if you do not use AppWizard to create your server application. In place of following the procedure outlined in this article, you could use an existing in-place frame-window class from either an AppWizard-generated application or a sample provided with Visual C++.</P>

<P class=label><B>To declare an in-place frame-window class</B>

<OL>
	<LI>Derive an in-place frame-window class from <B>COleIPFrameWnd</B>.
<UL type=disc>
	<LI>Use the <B>DECLARE_DYNCREATE</B> macro in your class header file.<BR><BR></LI>

	<LI>Use the <B>IMPLEMENT_DYNCREATE</B> macro in your class implementation (.CPP) file. This allows objects of this class to be created by the framework.</LI>
</UL>
</LI>

	<LI>Declare a <B>COleResizeBar</B> member in the frame-window class. This is needed if you want to support in-place resizing in server applications.
<P class=tl>Declare an <B>OnCreate</B> message handler (using ClassWizard), Call <B>Create</B> for your <B>COleResizeBar</B> member, if you’ve defined it.</P></LI>

	<LI>If you have a toolbar, declare a <B>CToolBar</B> member in the frame-window class. 
<P class=tl>Override the <B>OnCreateControlBars</B> member function to create a toolbar when the server is active in place. For example:</P>
<PRE><CODE>BOOL CInPlaceFrame::OnCreateControlBars
   (CWnd* pWndFrame, CWnd* pWndDoc)
{
   // create toolbar on client's frame window
   if (!m_wndToolBar.Create(pWndFrame) ||
       !m_wndToolBar.LoadToolBar(IDR_PROJ_SRVR_IP))
   {
      TRACE("Failed to create toolbar\n");
      return FALSE;
   }

   // set this window as owner, so messages are 
   // delivered to proper app
   m_wndToolBar.SetOwner(this);

   // enable docking for the toolbar
   m_wndToolBar.EnableDocking(CBRS_ALIGN_ANY);
   pWndFrame-&gt;EnableDocking(CBRS_ALIGN_ANY);
   pWndFrame-&gt;DockControlBar(&amp;m_wndToolBar);

   // enable tooltips for the toolbar
   m_wndToolBar.SetBarStyle(CBRS_TOOLTIPS |
      CBRS_FLYBY | m_wndToolBar.GetBarStyle());

    return TRUE;
}
</CODE></PRE>

<P class=tl>See the discussion of this code following step 5.</P></LI>

	<LI>Include the header file for this in-place frame-window class in your main .CPP file.<BR><BR></LI>

	<LI>In <B>InitInstance</B> for your application class, call the <B>SetServerInfo</B> function of the document template object to specify the resources and in-place frame window to be used in open and in-place editing.</LI>
</OL>

<P>The series of function calls in the <B>if</B> statement creates the toolbar from the resources the server provided. At this point, the toolbar is part of the container’s window hierarchy. Because this toolbar is derived from <B>CToolBar</B>, it will pass its messages to its owner, the container application’s frame window, unless you change the owner. That is why the call to <B>SetOwner</B> is necessary. This call changes the window where commands are sent to be the server’s in-place frame window, causing the messages to be passed to the server. This allows the server to react to operations on the toolbar that it provides.</P>

<P>The ID for the toolbar bitmap should be the same as the other in-place resources defined in your server application. See the article <A HREF="_core_menus_and_resources.3a_.server_additions.htm">Menus and Resources: Server Additions</A> for details. </P>

<P>For more information, see <A HREF="JavaScript:hhobj_2.Click()">COleIPFrameWnd</A>, <A HREF="JavaScript:hhobj_3.Click()">COleResizeBar</A>, and <A HREF="JavaScript:hhobj_4.Click()">CDocTemplate::SetServerInfo</A> in the <I>Class Library Reference</I>.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_servers.3a_.implementing_a_server.htm">Servers: Implementing a Server</A>, <A HREF="_core_servers.3a_.implementing_server_documents.htm">Servers: Implementing Server Documents</A>, <A HREF="_core_servers.3a_.server_items.htm">Servers: Server Items</A> </P>
</font>
</BODY>
</HTML>
