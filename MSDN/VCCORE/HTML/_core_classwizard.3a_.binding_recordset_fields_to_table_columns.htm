<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ClassWizard: Binding Recordset Fields to Table Columns</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Scribble start">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_classwizard.3a_.binding_recordset_fields_to_table_columns"></A>ClassWizard: Binding Recordset Fields to Table Columns</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_working_with_classes.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_working_with_classes_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A></P>

<P>Both AppWizard and ClassWizard bind all columns of your selected tables to the recordset. This article applies to both the MFC ODBC classes and the MFC DAO classes. The article explains how to:

<UL type=disc>
	<LI><A HREF="#_core_removing_columns_from_your_recordset">Remove data members for any columns you don't want in the recordset</A>. 
<P class=tl>If you want only a subset of the columns bound by the wizards, use ClassWizard to remove the field data members for any columns you don't want.</P></LI>

	<LI><A HREF="#_core_adding_columns_to_your_recordset">Select table columns and map them to recordset field data members</A>. 
<P class=tl>If you subsequently remove any of the bindings the wizards made, you can later rebind them with ClassWizard. </P></LI>

	<LI><A HREF="#_core_updating_your_recordsets_columns">Update columns in your recordset to reflect new columns in the table on the data source</A>. </LI>
</UL>

<P>This and related articles use the terms "column" and "field" interchangeably when referring to recordset fields.</P>



<H2><A NAME="_core_removing_columns_from_your_recordset"></A>Removing Columns from Your Recordset</H2>

<P>You might sometimes need to remove columns from a recordset. Both AppWizard and ClassWizard automatically bind all table columns to the recordset. If you want only a subset of the columns, use the following procedure.</P>

<P class=label><B><A NAME="_core_to_remove_a_column_from_a_recordset"></A>To remove a column from a recordset</B>

<OL>
	<LI>In ClassWizard, click the <B>Member Variables</B> tab.<BR><BR></LI>

	<LI>Click a member variable name in the <B>Members</B> column of the <B>Column Names</B> box.<BR><BR></LI>

	<LI>Click <B>Delete Variable</B>.
<P class=tl>The member variable is removed from your recordset class. (The column in the data source to which the member variable was bound is not deleted.)</P></LI>
</OL>

<P class=indent><B><B>Warning</B></B>&nbsp;&nbsp;&nbsp;Be careful not to remove any columns that are part of the table's primary key. In some tables, the primary key is a single column; in others, it's composed of two or more columns taken together. Removing these columns could damage your data on the data source. </P>



<H2><A NAME="_core_adding_columns_to_your_recordset"></A>Adding Columns to Your Recordset</H2>

<P>Once you select a table, ClassWizard displays a list of all columns in the table. You can remove column bindings, and you can later rebind columns whose bindings have been removed. The following procedure explains how to bind an unbound column.</P>

<P class=label><B><A NAME="_core_to_add_a_column_to_the_recordset"></A>To add a column to the recordset</B>

<OL>
	<LI>Create the recordset class and associate it with one or more database tables.
<P class=tl>If you create the class with ClassWizard, follow the procedure <A HREF="_core_classwizard.3a_.creating_a_recordset_class.htm#_core_to_create_the_recordset_class">To Create the Recordset Class</A> in the article ClassWizard: Creating a Recordset Class. </P>
<P class=tl>If you create the class with AppWizard, follow the information in the article <A HREF="_core_database_options_in_appwizard.htm">Database Options in AppWizard</A>. </P></LI>

	<LI>In ClassWizard, on the <B>Member Variables</B> tab, select the recordset class name in the <B>Class Name</B> box if it is not already selected.<BR><BR></LI>

	<LI>Select a column in the <B>Column Names</B> box.<BR><BR></LI>

	<LI>Click <B>Add Variable</B> to open the <B>Add Member Variable</B> dialog box.<BR><BR></LI>

	<LI>Type a name for the recordset data member that will represent the selected column.<BR><BR></LI>

	<LI>ClassWizard supplies a standard data member prefix, <CODE>m_</CODE>, for the name. Append the rest of the name to this prefix or type over it.
<P class=tl>The variable's property and data type are already specified in the dialog box. The property for these variables is always "Value." The data type is based on the data type of the column on the data source.</P></LI>

	<LI>Click <B>OK</B> to close the <B>Add Member Variable </B>dialog box.<BR><BR></LI>

	<LI>Click <B>OK</B> to close ClassWizard. 
<P class=tl>ClassWizard writes your class files to the specified directory and adds them to your project.</P></LI>
</OL>

<P class=indent><B><B>Tip</B></B>&nbsp;&nbsp;&nbsp;Rather than binding columns to data members one at a time, you can click the Bind All button to bind all columns. ClassWizard gives the data members default names based on the column names. Binding columns one at a time gives you more control over the columns bound and how they're named, but Bind All is quick and easy.</P>

<P>The following figure shows the Member Variables tab with a data member added for one of the available columns.</P>

<P class=label><B>Adding a Data Member to the Recordset</B></P>

<P><IMG SRC="mcmemv.gif" ALT="" BORDER=0></P>



<H2><A NAME="_core_updating_your_recordsets_columns"></A>Updating Your Recordset's Columns</H2>

<P>Tables in a data source sometimes change—in particular, columns may be added to a table. To bring your recordset class up to date with respect to these changes, use the Update Columns button.</P>

<P class=label><B><A NAME="_core_to_update_the_columns_in_your_recordset"></A>To update the columns in your recordset</B>

<OL>
	<LI>On ClassWizard's <B>Member Variables</B> tab, click your recordset class.<BR><BR></LI>

	<LI>Click <B>Update Columns</B>.</LI>
</OL>

<P>Any new columns are shown in the list but not yet bound to recordset field data members. To bind them, see the procedure <A HREF="#_core_to_add_a_column_to_the_recordset">To add a column to the recordset</A> in Adding Columns to Your Recordset.</P>

<P>When you use Update Columns, columns you've previously bound to recordset data members are left alone; to unbind a column, delete its data member. Any columns in the table that aren't bound to the recordset disappear from the refreshed recordset. </P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_classwizard.3a_.creating_a_database_form.htm">ClassWizard: Creating a Database Form</A>, <A HREF="_core_classwizard.3a_.creating_a_recordset_class.htm">ClassWizard: Creating a Recordset Class</A></P>
</font>
</BODY>
</HTML>
