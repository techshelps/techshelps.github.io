<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ODBC: Calling ODBC API Functions Directly</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_CATALOG">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_Macros.2c_.Global_Functions.2c_.and_Global_Variables">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_odbc.3a_.calling_odbc_api_functions_directly"></A>ODBC: Calling ODBC API Functions Directly</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>The database classes provide a simpler interface to a <A HREF="_core_data_source_.28.odbc.29.htm">data source</A> than does ODBC. As a result, the classes don’t encapsulate all of the ODBC API. For any functionality that falls outside the abilities of the classes, you must call ODBC API functions directly. For example, you must call the ODBC catalog functions (<B>::SQLColumns</B>, <B>::SQLProcedures</B>, <B>::SQLTables</B>, and others) directly. Samples of direct ODBC function calls used with the classes are in the MFC Database sample <A HREF="JavaScript:hhobj_3.Click()">CATALOG</A>. </P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>ODBC data sources are accessible through the MFC ODBC classes, as described in this article, or through the MFC Data Access Object (DAO) classes. For information about the DAO classes, see the article <A HREF="_core_dao_and_mfc.htm">DAO and MFC</A>.</P>

<P>To call an ODBC API function directly, you must take the same steps you’d take if you were making the calls without the framework. They are:

<UL type=disc>
	<LI>Allocate storage for any results the call returns.<BR><BR></LI>

	<LI>Pass an ODBC <B>HDBC</B> or <B>HSTMT</B> handle, depending on the parameter signature of the function.
<P class=tl>Member variables <B>CDatabase::m_hdbc</B> and <B>CRecordset::m_hstmt</B> are available so that you do not need to allocate and initialize these yourself.</P></LI>

	<LI>Perhaps call additional ODBC functions to prepare for or follow up the main call. <BR><BR></LI>

	<LI>Deallocate storage when you finish.</LI>
</UL>

<P>For more information about these steps, see the ODBC SDK <I>Programmer’s Reference</I> on the MSDN Library CD.</P>

<P>In addition to these steps, you need to take extra steps to check function return values, assure that your program isn’t waiting for an asynchronous call to finish, and so on. You can simplify these last steps by using the <B>AFX_SQL_ASYNC</B> and <B>AFX_SQL_SYNC</B> macros. See <A HREF="JavaScript:hhobj_4.Click()">Macros and Globals</A> in the <I>Class Library Reference</I> for information.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_odbc.htm">ODBC</A> </P>
</font>
</BODY>
</HTML>
