<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Setup and an Uninstall Program</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_creating_a_setup_and_an_uninstall_program"></A>Creating a Setup and an Uninstall Program</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_win32_programming.3a_.overview.htm">Overview</A> |&nbsp; <A HREF="_core_win32_programming_tasks.htm">How Do I</A></P>

<P>Your Windows 95 application must be accompanied by a setup program having a graphical user interface. This program must be named SETUP.EXE so it can be identified by the Add/Remove Programs applet in the Control Panel. Your application must also add entries to the system registry specifying the command needed to uninstall your application. Again, this allows your uninstall program to be identified by the Add/Remove Programs applet. </P>

<P>A complete discussion of what’s involved in writing your own setup and uninstall programs is beyond the scope of this article. For information on the requirements for setup and uninstall programs, see the article "Windows 95 Application Setup Guidelines for ISVs" on the MSDN Library CD.</P>

<P>However, as a shortcut for developing setup and uninstall programs, Visual C++ includes the SDK Edition of Stirling Software’s InstallSHIELD. Using this toolkit, you can write a script that specifies the steps you want performed during installation; the InstallSHIELD SETUP application uses this script to install your product. The DRAWCLI sample includes a setup script for use with InstallSHIELD. </P>

<P>The script for DRAWCLI’s setup program installs the executable file for DRAWCLI, the DLLs needed by DRAWCLI, a help file, and some sample files. You can use the script as a basis for creating your own setup program using InstallSHIELD. </P>

<P>At a minimum, the changes you need to make to the script are as follows:

<UL type=disc>
	<LI>Change the size requirements to reflect the sizes of your program files, help files, and sample files.<BR><BR></LI>

	<LI>Change the application name.<BR><BR></LI>

	<LI>Change the version number.<BR><BR></LI>

	<LI>Change the company name. (This must be consistent with the one you specify in your call to <B>CWinApp::SetRegistryKey</B>).<BR><BR></LI>

	<LI>Change the command lines for the program group items.<BR><BR></LI>

	<LI>Change the filetype extension. (This must be consistent with the extension you specified in AppWizard; this is used by <B>CWinApp::RegisterShellFileTypes</B>).<BR><BR></LI>

	<LI>Change the filetype name. (This must be consistent with the one generated by AppWizard for <B>CDocTemplate::regFileTypeId</B>; this is used by <B>CWinApp::RegisterShellFileTypes</B>).</LI>
</UL>

<P>Other changes may be necessary, depending on the details of the installation process for your application.</P>

<P>With InstallSHIELD, you don’t have to write a separate script for uninstallation. InstallSHIELD’s uninstall program, UNINST, uses a log file that is created automatically during the setup process. This log file enables UNINST to reverse the steps performed during setup. </P>

<P>For more information on using InstallSHIELD, see the <I>InstallSHIELD User’s Guide</I>. For more information on using the system registry, see "Integrating with the System" on the MSDN Library CD. </P>

<P>For a list of the files that you can redistribute with your application, see <A HREF="_core_redistributable_files.htm">Redistributable Files</A> in DLL Topics or the file Redistrb.wri in the \OS\System directory on the Visual C++ CD-ROM.</P>
</font>
</BODY>
</HTML>
