<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO: Accessing Implicit MFC DAO Objects</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase.3a3a.m_pWorkspace">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.m_pDatabase">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase.3a3a.m_pWorkspace">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao.3a_.accessing_implicit_mfc_dao_objects"></A>DAO: Accessing Implicit MFC DAO Objects</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article describes how to access the implicit MFC DAO objects that MFC creates for you in certain situations. The classic example is the workspace object associated with an existing <A HREF="JavaScript:hhobj_3.Click()">CDaoDatabase</A> or <A HREF="JavaScript:hhobj_4.Click()">CDaoRecordset</A> object. Normally you don't need an explicit <A HREF="JavaScript:hhobj_5.Click()">CDaoWorkspace</A> object, so you let MFC implicitly provide one. For a discussion, see the article <A HREF="_core_dao_database.3a_.using_workspaces_and_databases.htm">DAO Database: Using Workspaces and Databases</A>.</P>



<H2><A NAME="_core_the_most_likely_case"></A>The Most Likely Case</H2>

<P>In the most likely case — that you already have a <B>CDaoDatabase</B> or a <B>CDaoRecordset</B> object associated with the workspace you want to access — you can use data members of these objects to obtain a pointer to the implicit <B>CDaoWorkspace</B> object that they belong to. There are two scenarios, based on whether you are working from:

<UL type=disc>
	<LI>A database object (Scenario 1)<BR><BR></LI>

	<LI>A recordset object (<A HREF="#_core_scenario_2.._two_levels_of_indirection">Scenario 2</A>)</LI>
</UL>

<H3><A NAME="_core_scenario_1.._one_level_of_indirection"></A>Scenario 1. A Database Object: One Level of Indirection</H3>

<P>You have a <A HREF="JavaScript:hhobj_6.Click()">CDaoDatabase</A> object based on the workspace. Access the <B>CDaoDatabase</B> object's <A HREF="JavaScript:hhobj_7.Click()">m_pWorkspace</A> data member to obtain a <A HREF="JavaScript:hhobj_8.Click()">CDaoWorkspace</A> pointer, like this:</P>

<PRE><CODE>// pdbAccounts is a pointer to a CDaoDatabase object 
// for the Accounts database
CDaoWorkspace* pws = pdbAccounts-&gt;m_pWorkspace;
</CODE></PRE>

<P>Or you might simply use the implicit workspace to call a <B>CDaoWorkspace</B> member function:</P>

<PRE><CODE>pdbAccounts-&gt;m_pWorkspace-&gt;BeginTrans( );
</CODE></PRE>

<P>Calling transaction functions in this way is common.</P>

<H3><A NAME="_core_scenario_2.._two_levels_of_indirection"></A>Scenario 2. A Recordset Object: Two Levels of Indirection</H3>

<P>You have a <A HREF="JavaScript:hhobj_9.Click()">CDaoRecordset</A> object indirectly based on the workspace (through a <A HREF="JavaScript:hhobj_10.Click()">CDaoDatabase</A>). Follow these steps:

<OL>
	<LI>Access the <B>CDaoRecordset</B> object's <A HREF="JavaScript:hhobj_11.Click()">m_pDatabase</A> data member to obtain a <B>CDaoDatabase</B> pointer.<BR><BR></LI>

	<LI>Access the database object's <A HREF="JavaScript:hhobj_12.Click()">m_pWorkspace</A> data member to obtain a <A HREF="JavaScript:hhobj_13.Click()">CDaoWorkspace</A> pointer, like this:
<PRE><CODE>// rsDelinquentAccts is an existing CDaoRecordset 
// object based on the Accounts database
CDaoDatabase* pdbAccounts = rs.m_pDatabase;
CDaoWorkspace* pws = pdbAccounts-&gt;m_pWorkspace;
</CODE></PRE>
</LI>
</OL>

<P>Or you might simply use the implicit workspace behind your recordset's implicit database to call a <B>CDaoWorkspace</B> member function:</P>

<PRE><CODE>pdbAccounts-&gt;m_pWorkspace-&gt;CommitTrans( );
</CODE></PRE>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>This is the recommended method for accessing such functions because it doesn’t create a copy of a pointer to an implicit object. Copies of such pointers can be dangerous.</P>



<H2><A NAME="_core_uses_for_the_workspace_pointer"></A>Uses for the Workspace Pointer</H2>

<P>You can use the workspace pointer obtained in this indirect way to access the Workspaces collection, the Databases collection, properties of the database engine, and so on. Note that in most cases the workspace accessed this way is DAO's default workspace.</P>

<P class=indent><B><B>Caution&nbsp;&nbsp;&nbsp;</B></B>If you store a copy to one of these pointers, be careful not to use it after the original object goes out of scope or is otherwise destroyed.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao.3a_.creating.2c_.opening.2c_.and_closing_dao_objects.htm">DAO: Creating, Opening, and Closing DAO Objects</A></P>
</font>
</BODY>
</HTML>
