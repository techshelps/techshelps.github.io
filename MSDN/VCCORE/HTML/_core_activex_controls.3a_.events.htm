<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ActiveX Controls: Events</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="circle sample start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleControl">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleControl">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_activex_controls.3a_.events"></A>ActiveX Controls: Events</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_activex_controls.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_activex_control_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_frequently_asked_questions_about_activex_controls.htm">FAQ</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_activex_control_sample_list.htm">Sample</A></P>

<P>ActiveX controls use events to notify a container that something has happened to the control. Common examples of events include clicks on the control, data entered using the keyboard, and changes in the control’s state. When these actions occur, the control fires an event to alert the container.</P>

<P>MFC supports two kinds of events: stock and custom. Stock events are those events that class <A HREF="JavaScript:hhobj_3.Click()">COleControl</A> handles automatically. For a complete list of stock events, see the article <A HREF="_core_activex_controls.3a_.adding_stock_events_to_an_activex_control.htm">ActiveX Controls: Adding Stock Events to an ActiveX Control</A>. Custom events allow a control the ability to notify the container when an action specific to that control occurs. Some examples would be a change in the internal state of a control or receipt of a certain window message.</P>

<P>For your control to fire events properly, your control class must map each event of the control to a member function that should be called when the related event occurs. This mapping mechanism (called an event map) centralizes information about the event and allows ClassWizard to easily access and manipulate the control’s events. This event map is declared by the following macro, located in the header (.H) file of the control class declaration:</P>

<PRE><CODE>DECLARE_EVENT_MAP()
</CODE></PRE>

<P>The following figure shows the <B>ActiveX Events</B> tab in ClassWizard. You use this tab to add custom and stock events.</P>

<P class=label><B>The ActiveX Events tab</B></P>

<P><IMG SRC="d06evnt.gif" ALT="" BORDER=0></P>

<P>Once the event map has been declared, it must be defined in your control’s implementation (.CPP) file. The following lines of code define the event map, allowing your control to fire specific events:</P>

<PRE><CODE>BEGIN_EVENT_MAP(CSampleCtrl, COleControl)
//{{AFX_EVENT_MAP(CSampleCtrl)
...
//}}AFX_EVENT_MAP
END_EVENT_MAP()
</CODE></PRE>

<P>If you use ControlWizard to create the project, it automatically adds these lines. If you do not use ControlWizard, you must add these lines manually.</P>

<P>With ClassWizard, you can add stock events supported by class <B>COleControl</B> or custom events that you define. For each new event, ClassWizard automatically adds the proper entry to the control’s event map and the control’s .ODL file.</P>

<P>Two other articles discuss events in detail:

<UL type=disc>
	<LI><A HREF="_core_activex_controls.3a_.adding_stock_events_to_an_activex_control.htm">ActiveX Controls: Adding Stock Events to an ActiveX Control</A><BR><BR></LI>

	<LI><A HREF="_core_activex_controls.3a_.adding_custom_events_to_an_activex_control.htm">ActiveX Controls: Adding Custom Events to an ActiveX Control</A></LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_activex_controls.3a_.methods.htm">ActiveX Controls: Methods</A>, <A HREF="JavaScript:hhobj_4.Click()">COleControl</A></P>
</font>
</BODY>
</HTML>
