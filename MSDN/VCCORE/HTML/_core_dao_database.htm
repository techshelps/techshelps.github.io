<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO Database</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoDatabase">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoWorkspace">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_database"></A>DAO Database</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains the role of <A HREF="JavaScript:hhobj_3.Click()">CDaoDatabase</A> objects in your application. For task-oriented information about using database objects, see the article <A HREF="_core_dao_database.3a_.using_workspaces_and_databases.htm">DAO Database: Using Workspaces and Databases</A>. For an understanding of the DAO database object underlying each MFC <B>CDaoDatabase</B> object, see the following topics in DAO Help:

<UL type=disc>
	<LI>Database Object<BR><BR></LI>

	<LI>Databases Collection</LI>
</UL>

<P>Topics covered in this article include:

<UL type=disc>
	<LI><A HREF="#_core_database.3a_.definition">Database: Definition</A><BR><BR></LI>

	<LI><A HREF="#_core_external_databases">External databases</A><BR><BR></LI>

	<LI><A HREF="#_core_database_collections">Database collections</A><BR><BR></LI>

	<LI><A HREF="#_core_database_roles">Database roles</A><BR><BR></LI>

	<LI><A HREF="#_core_accessing_database_objects">Accessing database objects</A><BR><BR></LI>

	<LI><A HREF="#_core_database_persistence">Database persistence</A><BR><BR></LI>

	<LI><A HREF="#_core_further_reading_about_databases">Further reading about databases</A></LI>
</UL>

<H2><A NAME="_core_database.3a_.definition"></A>Database: Definition</H2>

<P>A DAO database object, represented in MFC by class <A HREF="JavaScript:hhobj_4.Click()">CDaoDatabase</A>, represents a connection to a database through which you can operate on the data. You can have one or more <B>CDaoDatabase</B> objects active at a time in a given <A HREF="_core_dao_workspace.htm">workspace</A>, represented by a <A HREF="JavaScript:hhobj_5.Click()">CDaoWorkspace</A> object. </P>

<P>For information about database management systems (DBMSs) you can work with, see <A HREF="_core_what_data_sources_can_i_access_with_dao_and_odbc.3f.htm">What Data Sources Can I Access with DAO and ODBC?</A>.</P>

<H2><A NAME="_core_external_databases"></A>External Databases</H2>

<P>Besides using <A HREF="JavaScript:hhobj_6.Click()">CDaoDatabase</A> to work with Microsoft Jet (.MDB) databases, you can also access external data sources, particularly Open Database Connectivity (ODBC) data sources. For a list of external data sources, see the topic <A HREF="_core_dao_external.3a_.working_with_external_data_sources.htm#_core_external_data_source.3a_.definition">External Data Source: Definition</A> in the article DAO: Working with External Data Sources.</P>

<H2><A NAME="_core_database_collections"></A>Database Collections</H2>

<P>In DAO:

<UL type=disc>
	<LI>Each workspace object contains a collection of open database objects, called the Databases collection.<BR><BR></LI>

	<LI>Each DAO database objects contains collections of tabledefs, querydefs, recordsets, and relations.</LI>
</UL>

<P>In MFC, access to a workspace’s Databases collection is through member functions of class <A HREF="JavaScript:hhobj_7.Click()">CDaoWorkspace</A>. Access to a database object’s collections is through member functions of class <A HREF="JavaScript:hhobj_8.Click()">CDaoDatabase</A>. </P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>DAO collections are not collections in the sense of the MFC collection classes. They are an integral part of DAO.</P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>MFC exposes all of a database’s collections via member functions except for the Recordsets collection. In MFC, you always have an explicit <A HREF="JavaScript:hhobj_9.Click()">CDaoRecordset</A> object for each recordset you create, and it is up to you to track these objects.</P>

<P>For more information about DAO collections in MFC, see the article <A HREF="_core_dao_collections.htm">DAO Collections</A>. For related information, see the topic "Databases Collection" in DAO Help.</P>

<H2><A NAME="_core_database_roles"></A>Database Roles</H2>

<P><A HREF="JavaScript:hhobj_10.Click()">CDaoDatabase</A> allows you to:

<UL type=disc>
	<LI>Create new Microsoft Jet (.MDB) database files.<BR><BR></LI>

	<LI>Store tabledef objects that you can use to manipulate the structure of the database’s tables.<BR><BR></LI>

	<LI>Store querydef objects so you can reuse the queries they represent later.<BR><BR></LI>

	<LI>View and manipulate data in the database’s tables.<BR><BR></LI>

	<LI>Work with data in local or remote databases.<BR><BR></LI>

	<LI>Work with the database’s collections.</LI>
</UL>

<H2><A NAME="_core_accessing_database_objects"></A>Accessing Database Objects</H2>

<P>When you open a <A HREF="JavaScript:hhobj_11.Click()">CDaoRecordset</A> object without specifying an open <A HREF="JavaScript:hhobj_12.Click()">CDaoDatabase</A> object, MFC implicitly creates a <B>CDaoDatabase</B> object, along with the <A HREF="JavaScript:hhobj_13.Click()">CDaoWorkspace</A> that contains the database and the underlying DAO database object. You can also create explicit <B>CDaoDatabase</B> objects.</P>

<P>See the article <A HREF="_core_dao.3a_.accessing_implicit_mfc_dao_objects.htm">DAO: Accessing Implicit MFC DAO Objects</A> for information on accessing:

<UL type=disc>
	<LI>The <B>CDaoDatabase</B> object associated with a <B>CDaoRecordset</B> object.<BR><BR></LI>

	<LI>The <B>CDaoWorkspace</B> object associated with a <B>CDaoDatabase</B> object.</LI>
</UL>

<H2><A NAME="_core_database_persistence"></A>Database Persistence</H2>

<P>Database objects exist in memory for the life of a database engine session. When that session terminates, the default workspace, the Workspaces collection, the Databases collection in each open workspace, and the database objects in the Databases collection(s) cease to exist (although the databases they represent do persist). These software objects are not stored on disk or in a database. When you begin a new database engine session and want to use the workspaces and databases you used in the last session, you must re-create any explicit workspace objects you need, and reopen any databases you were using in the workspace.</P>

<P class=indent><B><B>Tip&nbsp;&nbsp;&nbsp;</B></B>Use a Windows registry entry to preserve a record of the workspaces and databases you had open during a database engine session.</P>

<H2><A NAME="_core_further_reading_about_databases"></A>Further Reading About Databases</H2>

<P>For more information about databases in MFC, see the following articles (in recommended reading order):

<UL type=disc>
	<LI><A HREF="_core_dao_database.3a_.using_workspaces_and_databases.htm">DAO Database: Using Workspaces and Databases</A><BR><BR></LI>

	<LI><A HREF="_core_dao_external.3a_.working_with_external_data_sources.htm">DAO External: Working with External Data Sources</A><BR><BR></LI>

	<LI><A HREF="_core_dao.3a_.accessing_implicit_mfc_dao_objects.htm">DAO: Accessing Implicit MFC DAO Objects</A><BR><BR></LI>

	<LI><A HREF="_core_dao_collections.htm">DAO Collections</A><BR><BR></LI>

	<LI><A HREF="_core_dao_tabledef.htm">DAO Tabledef</A><BR><BR></LI>

	<LI><A HREF="_core_dao_querydef.htm">DAO Querydef</A><BR><BR></LI>

	<LI><A HREF="_core_dao_recordset.htm">DAO Recordset</A></LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao.3a_.database_tasks.htm">DAO: Database Tasks</A></P>
</font>
</BODY>
</HTML>
