<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Record Field Exchange: Using the RFX Functions</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll Tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CRecordset">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.DoFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFCNOTES_TN043">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_Macros.2c_.Global_Functions.2c_.and_Global_Variables">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_Macros.2c_.Global_Functions.2c_.and_Global_Variables">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CFieldExchange">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_record_field_exchange.3a_.using_the_rfx_functions"></A>Record Field Exchange: Using the RFX Functions</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains how to use the RFX function calls that make up the body of your <B>DoFieldExchange</B> override.</P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>This article applies to classes derived from <A HREF="JavaScript:hhobj_3.Click()">CRecordset</A> in which bulk row fetching has not been implemented. If you are using bulk row fetching, then bulk record field exchange (Bulk RFX) is implemented. Bulk RFX is similar to RFX. To understand the differences, see the article <A HREF="_core_recordset.3a_.fetching_records_in_bulk_.28.odbc.29.htm">Recordset: Fetching Records in Bulk (ODBC)</A>.</P>

<P>The RFX global functions exchange data between columns on the data source and field data members in your recordset. Normally you use ClassWizard to write the RFX function calls in your recordset’s <A HREF="JavaScript:hhobj_4.Click()">DoFieldExchange</A> member function. This article describes the functions briefly and shows the data types for which RFX functions are available. <A HREF="JavaScript:hhobj_5.Click()">Technical Note 43</A> describes how to write your own RFX functions for additional data types.</P>



<H2><A NAME="_core_rfx_function_syntax"></A>RFX Function Syntax</H2>

<P>Each RFX function takes three parameters (and some take an optional fourth or fifth parameter):

<UL type=disc>
	<LI>A pointer to a <A HREF="JavaScript:hhobj_6.Click()">CFieldExchange</A> object. You simply pass along the <I>pFX</I> pointer passed to <B>DoFieldExchange</B>.<BR><BR></LI>

	<LI>The name of the column as it appears on the data source.<BR><BR></LI>

	<LI>The name of the corresponding field data member or parameter data member in the recordset class.<BR><BR></LI>

	<LI>(Optional) In some of the functions, the maximum length of the string or array being transferred. This defaults to 255 bytes, but you might want to change it. The maximum size is based on the maximum size of a <B>CString</B> object — <B>INT_MAX</B> (2,147,483,647) bytes — but you will probably encounter driver limits before that size.<BR><BR></LI>

	<LI>(Optional) In the <B>RFX_Text</B> function, you sometimes use a fifth parameter to specify the data type of a column.</LI>
</UL>

<P>For more information, see the RFX functions under <A HREF="JavaScript:hhobj_7.Click()">Macros and Globals</A> in the <I>Class Library Reference</I>. For an example of when you might make special use of the parameters, see the article <A HREF="_core_recordset.3a_.obtaining_sums_and_other_aggregate_results_.28.odbc.29.htm">Recordset: Obtaining SUMs and Other Aggregate Results (ODBC)</A>. </P>



<H2><A NAME="_core_rfx_data_types"></A>RFX Data Types</H2>

<P>The class library supplies RFX functions for transferring many different data types between the data source and your recordsets. The following list summarizes the RFX functions by data type. In cases where you must write your own RFX function calls, select from these functions by data type.</P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=45%><B>Function</B></TD>
<TD class=label width=55%><B>Data Type</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>RFX_Bool</B></TD>
<TD width=55%><B>BOOL</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>RFX_Byte</B></TD>
<TD width=55%><B>BYTE</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>RFX_Binary</B></TD>
<TD width=55%><B>CByteArray</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>RFX_Double</B></TD>
<TD width=55%><B>double</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>RFX_Single</B></TD>
<TD width=55%><B>float</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>RFX_Int</B></TD>
<TD width=55%><B>int</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>RFX_Long</B></TD>
<TD width=55%><B>long</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>RFX_LongBinary</B></TD>
<TD width=55%><B>CLongBinary</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>RFX_Text</B></TD>
<TD width=55%><B>CString</B></TD>
</TR>

<TR VALIGN="top">
<TD width=45%><B>RFX_Date</B></TD>
<TD width=55%><B>CTime</B></TD>
</TR>
</TABLE><BR>

<P>For more information, see the RFX function documentation under <A HREF="JavaScript:hhobj_8.Click()">Macros and Globals</A> in the <I>Class Library Reference</I>. For information about how C++ data types map to SQL data types, see the table ANSI SQL Data Types Mapped to C++ Data Types in the article <A HREF="_core_sql.3a_.sql_and_c.2b2b_.data_types_.28.odbc.29.htm">SQL: SQL and C++ Data Types (ODBC)</A>. </P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_record_field_exchange.3a_.how_rfx_works.htm">Record Field Exchange: How RFX Works</A>, <A HREF="_core_recordset.3a_.parameterizing_a_recordset_.28.odbc.29.htm">Recordset: Parameterizing a Recordset (ODBC)</A>, <A HREF="_core_recordset.3a_.dynamically_binding_data_columns_.28.odbc.29.htm">Recordset: Dynamically Binding Data Columns (ODBC)</A>, <A HREF="JavaScript:hhobj_9.Click()">CRecordset</A>, <A HREF="JavaScript:hhobj_10.Click()">CFieldExchange</A></P>
</font>
</BODY>
</HTML>
