<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Recordset: Requerying a Recordset (ODBC)</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.Requery">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CRecordset.3a3a.Requery">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll requery">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CRecordset.3a3a.Requery">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_recordset.3a_.requerying_a_recordset_.28.odbc.29"></A>Recordset: Requerying a Recordset (ODBC)</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article applies to the MFC ODBC classes. For DAO recordsets, see the article <A HREF="_core_dao_recordset.htm">DAO Recordset</A>.</P>

<P>This article explains how you can use a recordset object to “requery” — refresh — itself from the database, and when you might want to do that with the <A HREF="JavaScript:hhobj_3.Click()">Requery</A> member function.</P>

<P>The principal reasons for requerying a recordset are to:

<UL type=disc>
	<LI>Bring the recordset up to date with respect to records added by you or by other users and records deleted by other users (those you delete are already reflected in the recordset).<BR><BR></LI>

	<LI>Refresh the recordset based on changing parameter values.</LI>
</UL>

<H2><A NAME="_core_bringing_the_recordset_up_to_date"></A>Bringing the Recordset Up to Date</H2>

<P>Frequently you will want to requery your recordset object to bring it up to date. In a multiuser database environment, other users can make changes to the data during the life of your recordset. For more information about when your recordset reflects changes made by other users and when other users’ recordsets reflect your changes, see the articles <A HREF="_core_recordset.3a_.how_recordsets_update_records_.28.odbc.29.htm">Recordset: How Recordsets Update Records (ODBC)</A> and <A HREF="_core_dynaset.htm">Dynaset</A>. </P>

<H2><A NAME="_core_requerying_based_on_new_parameters"></A>Requerying Based on New Parameters</H2>

<P>Another frequent — and equally important — use of <A HREF="JavaScript:hhobj_4.Click()">Requery</A> is to select a new set of records based on changing parameter values. For example, Step 2 in the ENROLL tutorial application illustrates using a combo box in a record view to select from a list of all available college courses. When the user selects a different course from the combo box, ENROLL requeries a Section table to select only those class sections for the course the user chose in the combo box. See the <CODE>CSectionForm::OnSelendokCourseList</CODE> member function in <A HREF="JavaScript:hhobj_5.Click()">Requerying the CSectionSet Recordset</A> in <I>Tutorials</I>. </P>

<P class=indent><B><B>Tip&nbsp;&nbsp;&nbsp;</B></B>Query speed is probably significantly faster if you call <B>Requery</B> with changing parameter values than if you call <B>Open</B> again.</P>

<H2><A NAME="_core_requerying_dynasets_vs.._snapshots"></A>Requerying Dynasets vs. Snapshots</H2>

<P>Because dynasets are meant to present a set of records with dynamic, up-to-date data, you’ll want to requery dynasets often if you want to reflect other users’ additions. Snapshots, on the other hand, are useful because you can safely rely on their static contents while you prepare reports, calculate totals, and so on. Still, you may sometimes want to requery a snapshot as well. In a multiuser environment, snapshot data may lose synchronization with the data source as other users change the database.</P>

<P class=label><B><A NAME="_core_to_requery_a_recordset_object"></A>To requery a recordset object</B>

<UL type=disc>
	<LI>Call the <A HREF="JavaScript:hhobj_6.Click()">Requery</A> member function of the object. </LI>
</UL>

<P>Alternatively, you can simply close and reopen the original recordset. In either case, the new recordset represents the current state of the data source.</P>

<P>For an example, see the article <A HREF="_core_record_views.3a_.filling_a_list_box_from_a_second_recordset.htm">Record Views: Filling a List Box from a Second Recordset</A>. </P>

<P class=indent><B><B>Tip&nbsp;&nbsp;&nbsp;</B></B>To optimize <B>Requery</B> performance, avoid changing the recordset’s <A HREF="_core_recordset.3a_.filtering_records_.28.odbc.29.htm">filter</A> or <A HREF="_core_recordset.3a_.sorting_records_.28.odbc.29.htm">sort</A>. Change only the parameter value before calling <B>Requery</B>.</P>

<P>If the <B>Requery</B> call fails, you can retry the call, otherwise, your application should terminate gracefully. A call to <B>Requery</B> or <B>Open</B> might fail for any of a number of reasons. Perhaps a network error occurs; or, during the call, after the existing data is released but before the new data is obtained, another user might get exclusive access; or the table on which your recordset depends could be deleted.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_recordset.3a_.dynamically_binding_data_columns_.28.odbc.29.htm">Recordset: Dynamically Binding Data Columns (ODBC)</A>, <A HREF="_core_recordset.3a_.creating_and_closing_recordsets_.28.odbc.29.htm">Recordset: Creating and Closing Recordsets (ODBC)</A> </P>
</font>
</BODY>
</HTML>
