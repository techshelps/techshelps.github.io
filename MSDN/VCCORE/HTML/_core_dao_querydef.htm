<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO Querydef</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoQueryDef">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_querydef"></A>DAO Querydef</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article describes “querydefs” and the key features of the MFC <A HREF="JavaScript:hhobj_3.Click()">CDaoQueryDef</A> class. For task-oriented information, see the article <A HREF="_core_dao_querydef.3a_.using_querydefs.htm">DAO Querydef: Using Querydefs</A>. For an understanding of the DAO querydef object underlying each MFC <B>CDaoQueryDef</B> object, see the topic "QueryDef Object" in DAO Help.</P>

<P>Topics covered include:

<UL type=disc>
	<LI><A HREF="#_core_querydef.3a_.definition">Querydef: definition</A><BR><BR></LI>

	<LI><A HREF="#_core_querydef_uses">Querydef uses</A><BR><BR></LI>

	<LI><A HREF="#_core_querydef_parameters">Querydef parameters</A><BR><BR></LI>

	<LI><A HREF="#_core_querydefs_and_dao_collections">Querydefs and DAO collections</A><BR><BR></LI>

	<LI><A HREF="#_core_further_reading_about_querydefs">Further reading about querydefs</A></LI>
</UL>

<H2><A NAME="_core_querydef.3a_.definition"></A>Querydef: Definition</H2>

<P>A DAO querydef, represented in MFC by a <A HREF="JavaScript:hhobj_4.Click()">CDaoQueryDef</A> object, is a query definition. The object defines the SQL statement for a query and provides operations for executing the query, for saving it in the database for reuse, for parameterizing the query, and more. </P>

<P>For information about specifying a query with SQL, see the article <A HREF="_core_dao_queries.htm">DAO Queries</A>.</P>

<P>Saved queries are advantageous because you can keep frequently used queries, especially complex ones, for easy reuse later. For information about saving querydefs in a database, see the article <A HREF="_core_dao_querydef.3a_.using_querydefs.htm">DAO Querydef: Using Querydefs</A>.</P>

<P class=indent><B><B>Tip&nbsp;&nbsp;&nbsp;</B></B>If you are working with Microsoft Jet (.MDB) databases, the easiest way to create a querydef is to do it in Microsoft Access. Open your target database, create querydefs, and save them in the database. Then you can use the querydefs in your code.</P>

<H2><A NAME="_core_querydef_uses"></A>Querydef Uses</H2>

<P>Querydef objects have two primary uses, corresponding to two ways to run the query:

<UL type=disc>
	<LI>Creating recordsets, which you then open to run the query.<BR><BR></LI>

	<LI>Directly executing queries that don't return records. These include action queries and some SQL pass-through queries (those that return no records).</LI>
</UL>

<P>For information about these querydef uses, see the article <A HREF="_core_dao_querydef.3a_.using_querydefs.htm">DAO Querydef: Using Querydefs</A>. For information about action queries and SQL pass-through queries, see the article <A HREF="_core_dao_querydef.3a_.action_queries_and_sql_pass.2d.through_queries.htm">DAO Querydef: Action Queries and SQL Pass-Through Queries</A>.</P>

<H2><A NAME="_core_querydef_parameters"></A>QueryDef Parameters</H2>

<P>Sometimes you'd like to be able to select records using information you've calculated or obtained from your user at run time. Parameterized queries let you pass such information at run time. </P>

<P>A query parameter is an element containing a value that you can change to affect the results of the query. For example, a query returning data about an employee might have a parameter for the employee's name. You can then use one querydef object to find data about any employee by setting the parameter to a specific name before running the query. This has two valuable effects:

<UL type=disc>
	<LI>It can result in better execution speed, particularly on the second and subsequent requeries.<BR><BR></LI>

	<LI>It lets you build a query at run time, based on information not available to you at design time, such as information that you must obtain from the user or information that you must calculate.</LI>
</UL>

<P class=indent><B><B>Important&nbsp;&nbsp;&nbsp;</B></B>In DAO, the parameter names are exposed rather than only the positions as in ODBC. While ODBC does allow named parameters, users of the MFC ODBC classes will be more familiar with using positional parameters.</P>

<P>For more information about DAO parameters, see the following topics in DAO Help:

<UL type=disc>
	<LI>Parameter Object, Parameters Collection Summary<BR><BR></LI>

	<LI>Creating Parameter Queries with DAO<BR><BR></LI>

	<LI>PARAMETERS Declaration (SQL)</LI>
</UL>

<P>For more information about using parameterized queries, see the article <A HREF="_core_dao_queries.3a_.filtering_and_parameterizing_queries.htm">DAO Queries: Filtering and Parameterizing Queries</A>.</P>



<H2><A NAME="_core_querydefs_and_dao_collections"></A>QueryDefs and DAO Collections</H2>

<P>Each DAO database object maintains a QueryDefs collection — a collection of all saved querydefs in the database. Each querydef object maintains two collections of its own:

<UL type=disc>
	<LI>Parameters.&nbsp; All defined parameters for the query.<BR><BR></LI>

	<LI>Fields.&nbsp; The fields in one or more tables that correspond to the parameters. For example, an Employee Name field corresponds to an Employee Name parameter.</LI>
</UL>

<P>MFC objects don't store a representation of a DAO collection. Instead, MFC accesses the collection through the underlying DAO object. For more information, see the article <A HREF="_core_dao_collections.htm">DAO Collections</A>.</P>

<P>MFC also doesn't provide a C++ class to represent every DAO object. In particular, there is no MFC parameter object or field object. You work with a querydef's parameters and fields through member functions of class <A HREF="JavaScript:hhobj_5.Click()">CDaoQueryDef</A>. For more information, see the article <A HREF="_core_dao_queries.3a_.filtering_and_parameterizing_queries.htm">DAO Queries: Filtering and Parameterizing Queries</A>.</P>

<H2><A NAME="_core_further_reading_about_querydefs"></A>Further Reading About Querydefs</H2>

<P>For more information about querydefs in MFC, see the following additional articles (in the recommended reading order):

<UL type=disc>
	<LI><A HREF="_core_dao_queries.htm">DAO Queries</A><BR><BR></LI>

	<LI><A HREF="_core_dao_querydef.3a_.using_querydefs.htm">DAO Querydef: Using Querydefs</A><BR><BR></LI>

	<LI><A HREF="_core_dao_queries.3a_.filtering_and_parameterizing_queries.htm">DAO Queries: Filtering and Parameterizing Queries</A><BR><BR></LI>

	<LI><A HREF="_core_dao_querydef.3a_.action_queries_and_sql_pass.2d.through_queries.htm">DAO Querydef: Action Queries and SQL Pass-Through Queries</A></LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao_recordset.htm">DAO Recordset</A></P>
</font>
</BODY>
</HTML>
