<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setting the Day State of a Month Calendar Control</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CMonthCalCtrl.3a3a.SetDayState">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_setting_the_day_state_of_a_month_calendar_control"></A>Setting the Day State of a Month Calendar Control</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_using_cmonthcalctrl.htm">Overview</A>  |&nbsp; <A HREF="_core_common_control_sample_list.htm">Sample</A></P>

<P>One of the attributes of a month calendar control is the ability to store information, referred to as the day state of the control, for each day of the month. This information is used to emphasize certain dates for the month currently displayed.</P>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;The <B>CMonthCalCtrl</B> object must have the <B>MCS_DAYSTATE</B> style to display day state information.</P>

<P>Day state information is expressed as a 32-bit data type, <B>MONTHDAYSTATE</B>. Each bit in a <B>MONTHDAYSTATE</B> bit field (1 through 31) represents the state of a day in a month. If a bit is on, the corresponding day will be displayed in bold; otherwise it will be displayed with no emphasis.</P>

<P>There are two methods for setting the day state of the month calendar control: explicitly with a call to <A HREF="JavaScript:hhobj_2.Click()">CMonthCalCtrl::SetDayState</A> or by handling the <B>MCN_GETDAYSTATE</B> notification message.</P>

<H3>Handling the MCN_GETDAYSTATE Notification Message</H3>

<P>The <B>MCN_GETDAYSTATE</B> message is sent by the control to determine how the days within the visible months should be displayed.</P>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;Because the control caches the previous and following months, in respect to the visible month, you will receive this notification every time a new month is chosen.</P>

<P>To properly handle this message, you must determine how many months day state information is being requested for, initialize an array of <B>MONTHDAYSTATE</B> structures with the proper values, and initialize the related structure member with the new information. The following procedure, detailing the necessary steps, assumes that you have a <B>CMonthCalCtrl</B> object called <CODE>m_monthcal</CODE> and an array of <B>MONTHDAYSTATE</B> objects, <CODE>mdState</CODE>.</P>

<P class=label><B>To handle the MCN_GETDAYSTATE notification message</B>

<OL>
	<LI>Using ClassWizard, add a notification handler for the <B>MCN_GETDAYSTATE</B> message to the <CODE>m_monthcal</CODE> object.<BR><BR></LI>

	<LI>In the body of the handler, add the following code:
<PRE><CODE>NMDAYSTATE* pDayState= (NMDAYSTATE *)pNMHDR;

#define BOLDDAY(ds,iDay) if(iDay&gt;0 &amp;&amp; iDay&lt;32)\
                            (ds)|=(0x00000001&lt;&lt;(iDay-1))
MONTHDAYSTATE mdState[3];
INT i, iMax;
</CODE></PRE>

<P class=tl>The example converts the <B>pNMHDR</B> pointer to the proper type and defines a helpful macro that sets specific bits in the <B>MONTHDAYSTATE</B> bitfield.</P></LI>

	<LI>After adding the previous code example, add the following code:
<PRE><CODE>iMax=pDayState-&gt;cDayState;

for(i=0;i&lt;iMax;i++)
{
    mdState[i] = (MONTHDAYSTATE)0;
    BOLDDAY(mdState[i],15);
 }
pDayState-&gt;prgDayState = mdState;
</CODE></PRE>

<P class=tl>The example first determines how many months of information are being requested (<CODE>pDayState-&gt;cDayState</CODE>). For each month, the current bitfield (<CODE>mdState</CODE>) is initialized to zero and then the needed dates are set (in this case, the 15th of each month). Finally, the <CODE>pDayState-&gt;prgDayState</CODE> member is set, completing the <B>MCN_DAYSTATE</B> handler.</P></LI>
</OL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_control_topics.htm#_core_windows_common_controls_and_mfc_classes">Windows Common Controls and MFC Classes</A></P>
</font>
</BODY>
</HTML>
