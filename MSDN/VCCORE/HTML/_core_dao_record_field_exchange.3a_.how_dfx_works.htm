<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DAO Record Field Exchange: How DFX Works</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Daoenrol tutorial">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetFieldDirty">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetFieldNull">
</OBJECT>
<OBJECT ID="hhobj_5" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Update">
</OBJECT>
<OBJECT ID="hhobj_6" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.AddNew">
</OBJECT>
<OBJECT ID="hhobj_7" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_8" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.DoFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_9" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.DoFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_10" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoFieldExchange.3a3a.m_nOperation">
</OBJECT>
<OBJECT ID="hhobj_11" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDaoFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_12" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Open">
</OBJECT>
<OBJECT ID="hhobj_13" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.DoFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_14" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.DoFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_15" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.MoveNext">
</OBJECT>
<OBJECT ID="hhobj_16" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.AddNew">
</OBJECT>
<OBJECT ID="hhobj_17" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Edit">
</OBJECT>
<OBJECT ID="hhobj_18" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoFieldExchange.3a3a.m_nOperation">
</OBJECT>
<OBJECT ID="hhobj_19" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Update">
</OBJECT>
<OBJECT ID="hhobj_20" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleDateTime">
</OBJECT>
<OBJECT ID="hhobj_21" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleCurrency">
</OBJECT>
<OBJECT ID="hhobj_22" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetFieldDirty">
</OBJECT>
<OBJECT ID="hhobj_23" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.SetFieldNull">
</OBJECT>
<OBJECT ID="hhobj_24" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Update">
</OBJECT>
<OBJECT ID="hhobj_25" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.AddNew">
</OBJECT>
<OBJECT ID="hhobj_26" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Edit">
</OBJECT>
<OBJECT ID="hhobj_27" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.Move">
</OBJECT>
<OBJECT ID="hhobj_28" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_MFC_CDaoFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_29" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_CDaoRecordset.3a3a.DoFieldExchange">
</OBJECT>
<OBJECT ID="hhobj_30" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_Record_Field_Exchange_Functions">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_dao_record_field_exchange.3a_.how_dfx_works"></A>DAO Record Field Exchange: How DFX Works</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_dao_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_dao_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>This article explains the DFX process. This is a fairly advanced topic, covering:

<UL type=disc>
	<LI><A HREF="#_core_dfx_and_the_recordset">DFX and the recordset</A><BR><BR></LI>

	<LI><A HREF="#_core_the_dao_record_field_exchange_process">The DFX process</A></LI>
</UL>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>This article is about the DAO version of record field exchange. If you are using the MFC ODBC classes rather than the MFC DAO classes, see the article <A HREF="_core_record_field_exchange.3a_.how_rfx_works.htm">Record Field Exchange: How RFX Works</A> instead.</P>



<H2><A NAME="_core_dfx_and_the_recordset"></A>DFX and the Recordset</H2>

<P>The recordset object’s field data members, taken together, constitute an edit buffer that holds the selected columns of one record. When the recordset is first opened and is about to read the first record, DFX binds (associates) each selected column to the address of the appropriate field data member. When the recordset updates a record, DFX calls DAO to send the appropriate commands to the database engine. DFX uses its knowledge of the field data members to specify the columns (fields) in the data source to write. </P>

<P>There are two ways of working with the edit buffer in a recordset:

<UL type=disc>
	<LI>Use MFC’s “double-buffering” mechanism.
<P class=tl>By default, your recordsets keep a second copy of the edit buffer for most data types (excluding the variable-length types, such as text and binary data). The copy is used for comparison with the edit buffer, to detect changes. You can choose to turn double buffering off, but keeping it turned on simplifies managing record field updates, adding and deleting records, and so on. For more information about double buffering, see the article <A HREF="_core_dao_record_field_exchange.3a_.double_buffering_records.htm">DAO Record Field Exchange: Double Buffering Records</A>.</P></LI>

	<LI>Don’t use double buffering; instead, manage all field activity yourself.
<P class=tl>If you turn off the default double buffering, each time you edit a field you must call <A HREF="JavaScript:hhobj_3.Click()">SetFieldDirty</A> and <A HREF="JavaScript:hhobj_4.Click()">SetFieldNull</A> (passing the parameter <B>FALSE</B>). That is, you must take explicit actions so MFC does not have to compare the edit buffer with a copy to detect your changes. For more information, see the article <A HREF="_core_dao_record_field_exchange.3a_.double_buffering_records.htm">DAO Record Field Exchange: Double Buffering Records</A>.</P></LI>
</UL>

<P>If you have double buffering enabled (the default), the framework backs up the edit buffer at certain stages so it can restore its contents if necessary. With double buffering enabled, DFX backs up the edit buffer before adding a new record and before editing an existing record. It restores the edit buffer in some cases — for example, after an <A HREF="JavaScript:hhobj_5.Click()">Update</A> call following <A HREF="JavaScript:hhobj_6.Click()">AddNew</A>.</P>

<P>Besides exchanging data between the data source and the recordset’s field data members, DFX manages binding parameters. When the recordset is opened, any parameter data members are bound in the order of the named parameters in the SQL statement that <A HREF="JavaScript:hhobj_7.Click()">CDaoRecordset::Open</A> receives or constructs. For more information, see the article <A HREF="_core_dao_queries.3a_.filtering_and_parameterizing_queries.htm">DAO Queries: Filtering and Parameterizing Queries</A>.</P>

<P>Your recordset class’s override of <A HREF="JavaScript:hhobj_8.Click()">DoFieldExchange</A> does all the work, moving data in both directions. Like dialog data exchange (DDX), DFX needs information about the data members of your class. ClassWizard provides the necessary information by writing a recordset-specific implementation of <B>DoFieldExchange</B> for you, based on the field data member names and data types you specify with the wizard. </P>

<H2><A NAME="_core_the_dao_record_field_exchange_process"></A>The DAO Record Field Exchange Process</H2>

<P>This section describes the sequence of DFX events as a recordset object is opened and as you scroll and add, update, and delete records. The table <A HREF="_core_dao_record_field_exchange.3a_.using_dfx.htm#_core_using_dfx.3a_.you_and_the_framework">Using DFX: You and the Framework</A> in the article <A HREF="_core_dao_record_field_exchange.3a_.using_dfx.htm">DAO Record Field Exchange: Using DFX</A> shows the process at a high level, illustrating operations as a recordset is opened. The table <A HREF="#_core_sequence_of_dfx_operations_during_recordset_open">Sequence of DFX Operations During Recordset Open</A> and the table <A HREF="#_core_sequence_of_dfx_operations_during_scrolling">Sequence of DFX Operations During Scrolling</A> in this article show the process as DFX processes a <B>Move</B> command in the recordset and as DFX manages an update. During these processes, <A HREF="JavaScript:hhobj_9.Click()">DoFieldExchange</A> is called to perform many different operations. The <A HREF="JavaScript:hhobj_10.Click()">m_nOperation</A> data member of the <A HREF="JavaScript:hhobj_11.Click()">CDaoFieldExchange</A> object determines which operation is requested. </P>



<H3><A NAME="_core_dfx.3a_.initial_binding_of_columns_and_parameters"></A>DFX: Initial Binding of Columns and Parameters</H3>

<P>The following DFX activities occur, in the order shown, when you call a recordset object’s <A HREF="JavaScript:hhobj_12.Click()">Open</A> member function:

<UL type=disc>
	<LI>If the recordset has parameter data members, the framework calls <A HREF="JavaScript:hhobj_13.Click()">DoFieldExchange</A> to bind the parameters to named parameters in the recordset’s SQL statement. <BR><BR></LI>

	<LI>The framework calls <B>DoFieldExchange</B> a second time to bind the columns to corresponding field data members in the recordset. This establishes the recordset object as an edit buffer containing the columns of the first record.<BR><BR></LI>

	<LI>The recordset opens either a table-type recordset or an SQL-based recordset (dynaset or snapshot) and selects the first record. The record’s columns are loaded into the recordset’s field data members.</LI>
</UL>

<P>The following table shows the sequence of DFX operations when you open a recordset.</P>

<P class=label><B><A NAME="_core_sequence_of_dfx_operations_during_recordset_open"></A>Sequence of DFX Operations During Recordset Open</B></P>

<TABLE border=1 cellpadding=5 cols=3 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=26%><B>Your operation</B></TD>
<TD class=label width=38%><B>DoFieldExchange operation</B></TD>
<TD class=label width=36%><B>Database operation</B></TD>
</TR>

<TR VALIGN="top">
<TD width=26%>1. Open the recordset.</TD>
<TD width=38%>&nbsp;</TD>
<TD width=36%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>&nbsp;</TD>
<TD width=38%>2. Build an SQL statement. <B>DoFieldExchange</B> might have a querydef, a tabledef, or an SQL statement handed to it. If not, MFC builds the statement.</TD>
<TD width=36%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>&nbsp;</TD>
<TD width=38%>&nbsp;</TD>
<TD width=36%>3. Open the querydef or tabledef, or create a temporary querydef (using either an SQL statement passed in or one built by MFC) and open it.</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>&nbsp;</TD>
<TD width=38%>4. Bind parameter data member(s).</TD>
<TD width=36%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>&nbsp;</TD>
<TD width=38%>5. Bind field data member(s) to column(s).</TD>
<TD width=36%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>&nbsp;</TD>
<TD width=38%>&nbsp;</TD>
<TD width=36%>6. Create the recordset.</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>&nbsp;</TD>
<TD width=38%>&nbsp;</TD>
<TD width=36%>7. DAO moves to the first record and fills in the data.</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>&nbsp;</TD>
<TD width=38%>8. Fix up the data for C++.</TD>
<TD width=36%>&nbsp;</TD>
</TR>
</TABLE><BR>



<H3><A NAME="_core_dfx.3a_.scrolling"></A>DFX: Scrolling</H3>

<P>When you scroll from one record to another, the framework calls <A HREF="JavaScript:hhobj_14.Click()">DoFieldExchange</A> to replace the values previously stored in the field data members with values for the new record.</P>

<P>The following table shows the sequence of DFX operations when the user moves from record to record.</P>

<P class=label><B><A NAME="_core_sequence_of_dfx_operations_during_scrolling"></A>Sequence of DFX Operations During Scrolling</B></P>

<TABLE border=1 cellpadding=5 cols=3 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=26%><B>Your operation</B></TD>
<TD class=label width=38%><B>DoFieldExchange operation</B></TD>
<TD class=label width=36%><B>Database operation</B></TD>
</TR>

<TR VALIGN="top">
<TD width=26%>1. Call <A HREF="JavaScript:hhobj_15.Click()">MoveNext</A> or one of the other Move functions.</TD>
<TD width=38%>&nbsp;</TD>
<TD width=36%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>&nbsp;</TD>
<TD width=38%>&nbsp;</TD>
<TD width=36%>2. DAO does the move and fills in the data.</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>&nbsp;</TD>
<TD width=38%>3. Fix up the data for C++.</TD>
<TD width=36%>&nbsp;</TD>
</TR>
</TABLE><BR>



<H3><A NAME="_core_dfx.3a_.adding_new_records_and_editing_existing_records"></A>DFX: Adding New Records and Editing Existing Records</H3>

<P>If you add a new record, the recordset operates as an edit buffer to build up the contents of the new record. As with adding records, editing records involves changing the values of the recordset’s field data members. From the DFX perspective, the sequence is as follows:

<OL>
	<LI>If double buffering is on, your call to the recordset’s <A HREF="JavaScript:hhobj_16.Click()">AddNew</A> or <A HREF="JavaScript:hhobj_17.Click()">Edit</A> member function causes DFX to store the current edit buffer so it can be restored later. <BR><BR></LI>

	<LI>If double buffering is on, <B>AddNew</B> or <B>Edit</B> prepares the fields in the edit buffer so DFX can detect changed field data members. If double buffering is off for an <B>Edit</B> call, the fields are not prepared for detection. (In this case, it’s up to you to manage edits explicitly — see the article <A HREF="_core_dao_record_field_exchange.3a_.double_buffering_records.htm">DAO Record Field Exchange: Double Buffering Records</A>.) The fields of a record prepared for <B>AddNew</B> are set to null whether double buffering is in effect or not.
<P class=tl>Since a new record has no previous values to compare new ones with, <B>AddNew</B> (with double buffering) sets the value of each field data member to a <B>PSEUDO_NULL</B> value as described under <A HREF="JavaScript:hhobj_18.Click()">CDaoFieldExchange::m_nOperation</A>. Later, when you call <A HREF="JavaScript:hhobj_19.Click()">Update</A>, DFX compares each data member’s value with the <B>PSEUDO_NULL</B> value; if there’s a difference, the data member has been set. (<B>PSEUDO_NULL</B> is not the same thing as a record column with a true Null value; nor is either the same as C++ <B>NULL</B>.)&nbsp; </P>
<P class=atl><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>MFC does not use a <B>PSEUDO_NULL</B> value for <A HREF="JavaScript:hhobj_20.Click()">COleDateTime</A> or <A HREF="JavaScript:hhobj_21.Click()">COleCurrency</A> fields. Those data types have Nulls built in.</p>
<P class=tl>Unlike the <B>Update</B> call for <B>AddNew</B>, the <B>Update</B> call for <B>Edit</B> compares updated values with previously stored values rather than using <B>PSEUDO_NULL</B>, if double buffering is on. If double buffering is off, you must call <A HREF="JavaScript:hhobj_22.Click()">SetFieldDirty</A> after an edit (and <A HREF="JavaScript:hhobj_23.Click()">SetFieldNull</A> if appropriate). The difference between <B>Edit</B> and <B>AddNew</B> is that <B>AddNew</B> has no previous stored values for comparison.</P></LI>

	<LI>You directly set the values of field data members whose values you want to edit or that you want filled for a new record. (This can include calling <B>SetFieldNull</B>.)<BR><BR></LI>

	<LI>If double buffering is on, your call to <A HREF="JavaScript:hhobj_24.Click()">Update</A> checks for changed field data members, as described in step 2 (see the table <A HREF="#_core_sequence_of_dfx_operations_during_scrolling">Sequence of DFX Operations During Scrolling</A>). If none have changed, <B>Update</B> returns 0. If some field data members have changed, <B>Update</B> propagates the changes to the database.<BR><BR></LI>

	<LI>For <B>AddNew</B>, <B>Update</B> concludes by restoring the previously stored values of the record that was current before the <B>AddNew</B> call. For <B>Edit</B>, the new, edited values remain in place if double buffering is in effect.</LI>
</OL>

<P>The following table shows the sequence of DFX operations when you add a new record or edit an existing record.</P>

<P class=label><B><A NAME="_core_sequence_of_dfx_operations_during_addnew_and_edit"></A>Sequence of DFX Operations During AddNew and Edit</B></P>

<TABLE border=1 cellpadding=5 cols=3 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=26%><B>Your operation</B></TD>
<TD class=label width=38%><B>DoFieldExchange operation</B></TD>
<TD class=label width=36%><B>Database operation</B></TD>
</TR>

<TR VALIGN="top">
<TD width=26%>1. Call <A HREF="JavaScript:hhobj_25.Click()">AddNew</A> or <A HREF="JavaScript:hhobj_26.Click()">Edit</A>.</TD>
<TD width=38%>&nbsp;</TD>
<TD width=36%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>&nbsp;</TD>
<TD width=38%>2. Back up the edit buffer if double buffering is on.</TD>
<TD width=36%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>&nbsp;</TD>
<TD width=38%>3. For <B>AddNew</B>, mark field data members as “clean” and Null. For <B>Edit</B>, call <B>Edit</B> in DAO.</TD>
<TD width=36%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>4. Assign values to recordset field data members.</TD>
<TD width=38%>&nbsp;</TD>
<TD width=36%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>5. Call <B>Update</B>.</TD>
<TD width=38%>&nbsp;</TD>
<TD width=36%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>&nbsp;</TD>
<TD width=38%>6. Check for changed fields if double buffering is on.</TD>
<TD width=36%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>&nbsp;</TD>
<TD width=38%>&nbsp;</TD>
<TD width=36%>7. Propagate changes to the database. Call <B>Update</B> in DAO.</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>&nbsp;</TD>
<TD width=38%>8. For <B>AddNew</B>, restore the edit buffer to its backed-up contents if double buffering is on. If it is off, the values set for the new record remain in the recordset data members. For <B>Edit</B>, delete the backup if double buffering is on.</TD>
<TD width=36%>&nbsp;</TD>
</TR>

<TR VALIGN="top">
<TD width=26%>9. If double buffering is off, you must refresh the current record after <B>AddNew</B>. Call <A HREF="JavaScript:hhobj_27.Click()">Move</A> with the <B>AFX_MOVE_REFRESH</B> parameter to restore the record that was previously current.</TD>
<TD width=38%>&nbsp;</TD>
<TD width=36%>&nbsp;</TD>
</TR>
</TABLE><BR>

<H3>DFX: Deleting Existing Records</H3>

<P>When you delete a record, DFX sets all the fields to <B>NULL</B> as a reminder that the record is deleted and you must move off it. You won’t need any other DFX sequence information.</P>

<P>In the <I>Class Library Reference</I> see <A HREF="JavaScript:hhobj_28.Click()">CDaoFieldExchange</A>, <A HREF="JavaScript:hhobj_29.Click()">CDaoRecordset::DoFieldExchange</A>, and, under Macros and Globals, <A HREF="JavaScript:hhobj_30.Click()">Record Field Exchange Functions</A>.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_dao.3a_.where_is.......htm">DAO: Where Is...</A>, <A HREF="_core_dao_record_field_exchange_.28.dfx.29.htm">DAO Record Field Exchange (DFX)</A>, <A HREF="_core_dao_record_field_exchange.3a_.using_dfx.htm">DAO Record Field Exchange: Using DFX</A>, <A HREF="_core_dao_record_field_exchange.3a_.working_with_the_wizard_code.htm">DAO Record Field Exchange: Working with the Wizard Code</A>, <A HREF="_core_dao_record_field_exchange.3a_.using_the_dfx_functions.htm">DAO Record Field Exchange: Using the DFX Functions</A>, <A HREF="_core_classwizard.3a_.creating_a_recordset_class.htm">ClassWizard</A> </P>
</font>
</BODY>
</HTML>
