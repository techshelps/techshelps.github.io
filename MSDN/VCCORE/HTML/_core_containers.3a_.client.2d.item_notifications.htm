<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Containers: Client-Item Notifications</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleClientItem">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_mfc_COleClientItem.3a3a.OnChangeItemPosition">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_containers.3a_.client.2d.item_notifications"></A>Containers: Client-Item Notifications</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_ole_in_mfc.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_ole_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_ole_sample_list.htm">Sample</A>  |&nbsp; <A HREF="_core_ole_tutorial_list.htm">Tutorial</A></P>

<P>This article discusses the overridable functions that the MFC framework calls when server applications modify items in your client application’s document.</P>

<P><A HREF="JavaScript:hhobj_2.Click()">COleClientItem</A> defines several overridable functions that are called in response to requests from the component application, which is also called the server application. These overridables usually act as notifications. They inform the container application of various events, such as scrolling, activation, or a change of position, and of changes that the user makes when editing or otherwise manipulating the item.</P>

<P>The framework notifies your container application of changes through a call to <B>COleClientItem::OnChange</B>, an overridable function whose implementation is required. This protected function receives two arguments. The first specifies the reason the server changed the item:</P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=37%><B>Notification</B></TD>
<TD class=label width=63%><B>Meaning</B></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>OLE_CHANGED</B></TD>
<TD width=63%>The OLE item’s appearance has changed.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>OLE_SAVED</B></TD>
<TD width=63%>The OLE item has been saved.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>OLE_CLOSED</B></TD>
<TD width=63%>The OLE item has been closed.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>OLE_RENAMED</B></TD>
<TD width=63%>The server document containing the OLE item has been renamed.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>OLE_CHANGED_STATE</B></TD>
<TD width=63%>The OLE item has changed from one state to another. </TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>OLE_CHANGED_ASPECT</B></TD>
<TD width=63%>The OLE item’s draw aspect has been changed by the framework.</TD>
</TR>
</TABLE><BR>

<P>These values are from the <B>OLE_NOTIFICATION</B> enumeration, which is defined in AFXOLE.H.</P>

<P>The second argument to this function specifies how the item has changed or what state it has entered:</P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=37%><B>When first argument is</B></TD>
<TD class=label width=63%><B>Second argument</B></TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>OLE_SAVED</B> or <B>OLE_CLOSED</B></TD>
<TD width=63%>Is not used.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>OLE_CHANGED</B></TD>
<TD width=63%>Specifies the aspect of the OLE item that has changed.</TD>
</TR>

<TR VALIGN="top">
<TD width=37%><B>OLE_CHANGED_STATE</B></TD>
<TD width=63%>Describes the state being entered (<B>emptyState</B>, <B>loadedState</B>, <B>openState</B>, <B>activeState</B>, or <B>activeUIState</B>).</TD>
</TR>
</TABLE><BR>

<P>For further information about the states a client item can assume, see the article <A HREF="_core_containers.3a_.client.2d.item_states.htm">Containers: Client-Item States</A>. </P>

<P>The framework calls <B>COleClientItem::OnGetItemPosition</B> when an item is being activated for in-place editing. Implementation is required for applications that support in-place editing. AppWizard provides a basic implementation, which assigns the item’s coordinates to the <B>CRect</B> object that is passed as an argument to <B>OnGetItemPosition</B>.</P>

<P>If an OLE item’s position or size changes during in-place editing, the container’s information about the item’s position and clipping rectangles must be updated and the server must receive information about the changes. The framework calls <B>COleClientItem::OnChangeItemPosition</B> for this purpose. AppWizard provides an override that calls the base class’s function. You should edit the function AppWizard writes for your <B>COleClientItem</B>-derived class so that the function updates any information retained by your client-item object.</P>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_containers.3a_.client.2d.item_states.htm">Containers: Client-Item States</A>, <A HREF="JavaScript:hhobj_3.Click()">COleClientItem::OnChangeItemPosition</A></P>
</font>
</BODY>
</HTML>
