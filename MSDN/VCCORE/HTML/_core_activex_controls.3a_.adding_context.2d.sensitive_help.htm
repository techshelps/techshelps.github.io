<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ActiveX Controls: Adding Context-Sensitive Help</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_sample_mfc_TESTHELP">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_activex_controls.3a_.adding_context.2d.sensitive_help"></A>ActiveX Controls: Adding Context-Sensitive Help</H1>

<P>You can make an ActiveX Control provide context-sensitive help on the currently selected control, property, or event by modifying the .ODL file. This article gives an example of modifying the help file for GENERIC. You can also examine the sample <A HREF="JavaScript:hhobj_1.Click()">TESTHELP</A>, which demonstrates how to create an ActiveX control with tooltips and Help.</P>

<P>The help file for a control is given by the help-file attribute in the library declaration in the .ODL file. In the following code, GENERIC.HLP is the help file for the control.</P>

<PRE><CODE>   [uuid(5CE3E2E3-8D26-101B-B883-444553540000), version(1.0),
    helpstring("GENERIC ActiveX Control module"),
    helpfile("GENERIC.HLP")]
    library GENERICLib
</CODE></PRE>

<P>The associated GENERIC.HPJ file lists help-context attributes for each of the help topics:</P>

<PRE><CODE>[MAP]
GENERIC                  10
GenericShape             50
FlashColor               60
ClickIn                  70
ClickOut                 80
</CODE></PRE>

<P>To specify the help topic ID for help on the control, add the help-context attribute <CODE>10</CODE> to the coclass declaration in GENERIC.ODL, as follows:</P>

<PRE><CODE>   [ uuid(5CE3E2E0-8D26-101B-B883-444553540000),
    helpstring("GENERIC Control"), helpcontext(10)]
    coclass CGENERIC
</CODE></PRE>

<P>To specify the help topic ID for a control property, add the help-context attribute to the property declaration in the property list. The following code adds a help-context ID of <CODE>50</CODE> and <CODE>60</CODE> for the <CODE>GenericShape</CODE> and <CODE>FlashColor</CODE> properties, respectively:</P>

<PRE><CODE>[ uuid(5CE3E2E1-8D26-101B-B883-444553540000),
  helpstring("Dispatch interface for GENERIC Control") ]
 dispinterface _DGENERIC
{
            properties:
         // NOTE - ClassWizard will maintain property information here.
         //    Use extreme caution when editing this section.
         //{{AFX_ODL_PROP(CGENERICCtrl)
            [id(3), helpcontext(50)] GenericShapeConstants
                                                          GenericShape;
            [id(1), helpcontext(60)] OLE_COLOR FlashColor;
            [id(4)] BSTR FontName;
            [id(5)] boolean FontBold;
            [id(6)] boolean FontItalic;
            [id(7)] boolean FontStrikethru;
            [id(8)] boolean FontUnderline;
            [id(9)] float FontSize;
            [id(DISPID_BACKCOLOR), bindable, requestedit]
                                                          OLE_COLOR
BackColor
;
            [id(DISPID_CAPTION), bindable, requestedit] BSTR
                                                          Caption;
            [id(DISPID_FONT), bindable] IFontDisp* Font;
            [id(DISPID_BORDERSTYLE), bindable, requestedit]

BorderStyleConstants BorderStyle;
            [id(DISPID_ENABLED), bindable, requestedit] boolean
                                                          Enabled;
            [id(2)] MousePointerConstants MousePointer;
            [id(10)] IPictureDisp* MouseIcon;
        //}}AFX_ODL_PROP
</CODE></PRE>

<P>To specify the help topic ID for a control event, add the helpcontext-attribute to the event declaration in the event list. The following code adds a help-context ID of <CODE>70</CODE> and <CODE>80</CODE> for the <CODE>ClickIn</CODE> and <CODE>ClickOut</CODE> events, respectively:</P>

<PRE><CODE>[ uuid(5CE3E2E2-8D26-101B-B883-444553540000),
  helpstring("Event interface for GENERIC Control") ]
dispinterface _DGENERICEvents
{
            properties:
            //  Event interface has no properties

            methods:
            // NOTE - ClassWizard will maintain event information here.
            //    Use extreme caution when editing this section.
            //{{AFX_ODL_EVENT(CGENERICCtrl)
            [id(1), helpcontext(70)] void ClickIn(float* X, float* Y,

     BSTR* Caption);
            [id(2), helpcontext(80)] void ClickOut();
            //}}AFX_ODL_EVENT
};
</CODE></PRE>
</font>
</BODY>
</HTML>
