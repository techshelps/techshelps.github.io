<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Displaying Context-Sensitive Help</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addui_home">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="vchowdisplayingcontrolhelp"></A>Displaying Context-Sensitive Help</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A></P>

<P>Context-sensitive help, for the purpose of this discussion, refers to help support for the controls in a dialog box that users access with:

<UL type=disc>
	<LI>The F1 key.<BR><BR></LI>

	<LI>By right-clicking a control (What's This? Help).<BR><BR></LI>

	<LI>By using the question-mark pointer (the What's This? Help pointer).</LI>
</UL>

<P>Context-sensitive help also refers to accessing the help viewer via a command button or menu option.</P>

<P>To implement help for a dialog-box control, you must first create a text file that you include in your HTML Help project and then create a two-dimensional array. Then, you can implement code that supports F1, right-click, or question-mark-pointer access to text in the help file.</P>

<P>The source information for context-sensitive help is stored in a .txt file that you include in your HTML Help project. </P>

<P class=label><B>To create the context-sensitive help text file</B>

<OL>
	<LI>Use a text editor to create a .txt file.<BR><BR></LI>

	<LI>Format the topics as follows:
<PRE><CODE>.topic 1
help text for control 1
.topic 2
help text for control 2</CODE></PRE>
</LI>
</OL>

<PRE></PRE>

<P class=indent><B>Note</B>&nbsp;&nbsp;&nbsp;For more information, see "Designing context-sensitive help" in HTML Help's online help. From the <B>Help</B> menu (in HTML Help Workshop), choose <B>Help Topics</B>.</P>

<P>To support help for resources in a dialog box, you must create a two-dimensional array that maps control IDs to help IDs (topic numbers).</P>

<P class=label><B>To create the two-dimensional array</B>

<UL type=disc>
	<LI>In the .cpp file, for every class that represents a dialog box, add a two-dimensional array to the end of the class. For example:
<PRE><CODE>static DWORD myarray[] = {
IDC_CHECK1, 1,
IDC_CHECK2, 2,
IDC_CHECK3, -1,
0,0
};</CODE></PRE>
</LI>
</UL>

<P>Each entry in the two-dimensional array pairs a resource ID for a dialog-box control with a topic number from the context-sensitive help text file. If you do not want a specific resource to have What's This? Help, use –1. The last pair in this array should be 0,0.</P>

<P>What's This? Help displays the control's help when a user right-clicks the control.</P>

<P class=label><B>To implement right-click What's This? Help</B>

<UL type=disc>
	<LI>Implement a handler for the <B>WM_CONTEXTMENU</B> message (in each dialog-box class where you want What's This? Help) and implement the following code for the handler:
<PRE><CODE>void CMyDialog::OnContextMenu(CWnd* pWnd, CPoint point) 
{
HtmlHelp(
pWnd-&gt;GetSafeHwnd(),
"my_chm.chm::/ctrlhlp.txt",
HH_TP_HELP_CONTEXTMENU,
(DWORD)(LPVOID)myarray);
}
</CODE></PRE>
</LI>
</UL>

<P>F1 access to context-sensitive help means that users will be able to press F1 when a control has focus to access help.</P>

<P class=label><B>To implement F1 access to context-sensitive help</B>

<UL type=disc>
	<LI>Implement a handler for the <B>WM_HELPINFO</B> message (in each dialog-box class where you want F1 access to context-sensitive help) and implement the following code for the handler:
<PRE><CODE>BOOL CMyDialog::OnHelpInfo(HELPINFO* pHelpInfo) 
{
if (pHelpInfo-&gt;iContextType == HELPINFO_WINDOW)
{
return HtmlHelp(
(HWND)pHelpInfo-&gt;hItemHandle,
"my_chm.chm::/ctrlhlp.txt",
HH_TP_HELP_WM_HELP,
(DWORD)(LPVOID)myarray) 
!= NULL;
}
return TRUE;
}
</CODE></PRE>
</LI>
</UL>

<P>If you already implement F1 access to context-sensitive help, you can easily enable the What's This? pointer, which causes a question mark to appear on the title bar, in the upper right-hand corner of the dialog box.</P>

<P class=label><B>To enable the What's This? Help question-mark pointer</B>

<UL type=disc>
	<LI>Select the <B>Context help</B> check box in the <B>Extended Styles</B> tab of the dialog box properties.</LI>
</UL>

<P><A HREF="vcovrhelptopicshtmlhelpcontextsensitivehelpforyourprograms.htm">Back to Help Topics (HTML Help)</A></P>
</font>
</BODY>
</HTML>
