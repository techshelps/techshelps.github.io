<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQL</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Enroll tutorial">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_sql"></A>SQL</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_databases.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_odbc_database_tasks.htm">How Do I</A>  |&nbsp; <A HREF="_core_databases.3a_.frequently_asked_questions.htm">FAQ</A>  |&nbsp; <A HREF="_core_odbc_database_sample_list.htm">Sample</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A>  |&nbsp; <A HREF="_core_odbc_driver_list.htm">ODBC Driver List</A></P>

<P>Structured Query Language (SQL) is a way to communicate with a relational database that lets you define, query, modify, and control the data. Using SQL syntax, you can construct a statement that extracts records according to criteria you specify. </P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>This information applies to the MFC ODBC classes. If you’re working with the MFC DAO classes, see the topic Comparison of Microsoft Jet Database Engine SQL and ANSI SQL in DAO Help.</P>

<P>SQL statements begin with a keyword “verb” such as <B>CREATE</B> or <B>SELECT</B>. SQL is a very powerful language; a single statement can affect an entire table.</P>

<P>Many versions of SQL exist, each developed with a particular DBMS in mind. The MFC database classes recognize a set of SQL statements that corresponds to the X/Open and SQL Access Group Common Applications Environment (CAE) SQL draft specification (1991). For details on the syntax of these statements, see Appendix C in the ODBC SDK <I>Programmer’s Reference</I> on the MSDN Library CD.</P>

<P>This article explains:

<UL type=disc>
	<LI><A HREF="#_core_open_database_connectivity_.28.odbc.29">The relationship between ODBC and SQL</A>.<BR><BR></LI>

	<LI><A HREF="#_core_the_database_classes">The most common SQL keywords used by the database classes</A>.<BR><BR></LI>

	<LI><A HREF="#_core_how_the_database_classes_use_sql">How the database classes use SQL</A>.</LI>
</UL>

<H2><A NAME="_core_open_database_connectivity_.28.odbc.29"></A>Open Database Connectivity (ODBC)</H2>

<P>The database classes are implemented with ODBC, which uses SQL in a call-level interface rather than embedding SQL commands in the code. ODBC uses SQL to communicate with a <A HREF="_core_data_source_.28.odbc.29.htm">data source</A> through ODBC drivers. These drivers interpret the SQL and translate it, if necessary, for use with a particular database format, such as Microsoft Access. For more information about how ODBC uses SQL, see the article <A HREF="_core_odbc.htm">ODBC</A> and the ODBC SDK <I>Programmer’s Reference</I> on the MSDN Library CD.</P>

<H2><A NAME="_core_the_database_classes"></A>The Database Classes</H2>

<P>The database classes are designed to let you manipulate and update data in an existing <A HREF="_core_data_source_.28.odbc.29.htm">data source</A>. <A HREF="_core_classwizard.3a_.database_support.htm">ClassWizard</A> and the database classes construct most of the SQL statements for you. </P>

<P>The database classes use a portion of SQL known as the Data Manipulation Language (DML). These commands let you work with all or part of the data source, add new records, edit records, and delete records. The following table lists the most common SQL keywords and the ways the database classes use them.</P>

<P class=label><B><A NAME="_core_some_common_sql_keywords"></A>Some Common SQL Keywords</B></P>

<TABLE border=1 cellpadding=5 cols=2 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=22%><B>SQL keyword</B></TD>
<TD class=label width=78%><B>ClassWizard and database classes use it ...</B></TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>SELECT</B></TD>
<TD width=78%>To identify which tables and columns in the data source are to be used.</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>WHERE</B></TD>
<TD width=78%>To apply a filter that narrows the selection.</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>ORDER BY</B></TD>
<TD width=78%>To apply a sort order to the recordset.</TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>INSERT</B></TD>
<TD width=78%>To add new records to a recordset. </TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>DELETE</B></TD>
<TD width=78%>To delete records from a recordset. </TD>
</TR>

<TR VALIGN="top">
<TD width=22%><B>UPDATE</B></TD>
<TD width=78%>To modify the fields of a record. </TD>
</TR>
</TABLE><BR>

<P>In addition, the database classes recognize ODBC <B>CALL</B> statements, which you can use to call a predefined query (or stored procedure) on some data sources. The ODBC database driver interprets these statements and substitutes the command appropriate for each DBMS. </P>

<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>Not all DBMSs support <B>CALL</B> statements. </P>

<P>If the classes cannot recognize a user-supplied statement in <B>CRecordset::Open</B>, it is interpreted as a table name.</P>

<P>For an explanation of how the framework constructs SQL statements, see the articles <A HREF="_core_recordset.3a_.how_recordsets_select_records_.28.odbc.29.htm">Recordset: How Recordsets Select Records (ODBC)</A> and <A HREF="_core_sql.3a_.customizing_your_recordset.92.s_sql_statement_.28.odbc.29.htm">SQL: Customizing Your Recordset’s SQL Statement (ODBC)</A>. </P>

<P>SQL databases use data types similar to those used in C and C++. For a discussion of these similarities, see the article <A HREF="_core_sql.3a_.sql_and_c.2b2b_.data_types_.28.odbc.29.htm">SQL: SQL and C++ Data Types (ODBC)</A>. </P>

<P>You can find more information about SQL, including a list of supported SQL statements, data types, SQL core grammar, and a reading list of recommended publications about SQL, in the ODBC SDK <I>Programmer's Reference</I> on the MSDN Library CD.</P>

<H2><A NAME="_core_how_the_database_classes_use_sql"></A>How the Database Classes Use SQL</H2>

<P>The recordsets you derive from the database classes use ODBC to communicate with a data source, and ODBC retrieves records from the data source by sending SQL statements. This article explains the relationship between the database classes and SQL.</P>

<P>A recordset constructs an SQL statement by building up the pieces of an SQL statement into a <B>CString</B>. The string is constructed as a <B>SELECT</B> statement, which returns a set of records.</P>

<P>When the recordset calls ODBC to send an SQL statement to the data source, the ODBC Driver Manager passes the statement to the ODBC driver, and the driver sends it to the underlying DBMS. The DBMS returns a result set of records, and the ODBC driver returns the records to the application. The database classes let your program access the result set in a type-safe C++ class derived from <B>CRecordset</B>. </P>

<P>The following articles provide more information about how the database classes use SQL:

<UL type=disc>
	<LI><A HREF="_core_sql.3a_.customizing_your_recordset.92.s_sql_statement_.28.odbc.29.htm">SQL: Customizing Your Recordset’s SQL Statement (ODBC)</A> <BR><BR></LI>

	<LI><A HREF="_core_sql.3a_.sql_and_c.2b2b_.data_types_.28.odbc.29.htm">SQL: SQL and C++ Data Types (ODBC)</A> <BR><BR></LI>

	<LI><A HREF="_core_sql.3a_.making_direct_sql_calls_.28.odbc.29.htm">SQL: Making Direct SQL Calls (ODBC)</A> </LI>
</UL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_odbc.htm">ODBC</A> </P>
</font>
</BODY>
</HTML>
