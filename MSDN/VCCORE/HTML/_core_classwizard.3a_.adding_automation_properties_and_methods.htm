<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ClassWizard: Adding Automation Properties and Methods</TITLE>
<style>@import url(stylesheets/msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="stylesheets/msdn_ie3.css"></HEAD>
<BODY>

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="_vc_addpf_home">
</OBJECT>
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="Scribble start">
</OBJECT>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="newproperty">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="DefaultTopic" VALUE="_topic_not_found.htm">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="newmethod">
</OBJECT>
</TD></TR></TABLE>


<font face="verdana,arial,helvetica" size="2">
<H1><A NAME="_core_classwizard.3a_.adding_automation_properties_and_methods"></A>ClassWizard: Adding Automation Properties and Methods</H1>

<P><A HREF="JavaScript:hhobj_1.Click()">Home</A>  |&nbsp; <A HREF="_core_working_with_classes.3a_.overview.htm">Overview</A>  |&nbsp; <A HREF="_core_working_with_classes_tasks.htm">How Do I</A>  |&nbsp; <A HREF="JavaScript:hhobj_2.Click()">Tutorial</A></P>

<P>This article explains how to use ClassWizard to add Automation (formerly OLE Automation) <A HREF="JavaScript:hhobj_3.Click()">properties</A> and <A HREF="JavaScript:hhobj_4.Click()">methods</A> to an Automation class. Topics include:

<UL type=disc>
	<LI><A HREF="#_core_adding_a_property_to_your_automation_class">Adding a property to your automation class</A><BR><BR></LI>

	<LI><A HREF="#_core_adding_a_method_to_your_automation_class">Adding a method to your automation class</A></LI>
</UL>

<P>A class that supports Automation exposes a set of functions (known as methods) and properties — the dispatch interface — for use by other applications. ClassWizard offers a simple, quick way to implement this ability in your classes.</P>

<H2><A NAME="_core_adding_a_property_to_your_automation_class"></A>Adding a Property to Your Automation Class</H2>

<P class=label><B>To add a member variable property to your Automation class</B></P>

<P>Use member variable properties if you need to allocate storage for the values. The most common case for member variables is when there is no user interface to be updated when changes occur.

<OL>
	<LI>In ClassWizard, click the <B>Automation</B> tab.<BR><BR></LI>

	<LI>Select a class name that supports Automation. (Your document class supports Automation if you checked the Automation check box in AppWizard when creating your project.) Notice that the <B>Add Property</B> and <B>Add Method</B> buttons are unavailable for classes that do not support Automation. <BR><BR></LI>

	<LI>Click <B>Add Property</B> and supply the following information:
<UL type=disc>
	<LI>External Name: Name that automation clients use to refer to this property.<BR><BR></LI>

	<LI>Type: Any of the choices found in the list box.<BR><BR></LI>

	<LI>Implementation: Click <B>Member Variable</B>.<BR><BR></LI>

	<LI>Variable Name: Name of the C++ class data member.</LI>
</UL>

<P class=atl><B><B>Tip</B></B>&nbsp;&nbsp;&nbsp;You can also supply the name of a notification function that is called when the variable changes.</p></LI>

	<LI>Click <B>OK</B> to close ClassWizard.</LI>
</OL>

<P class=label><B>To add a Get/Set method property to your Automation class</B></P>

<P>Use Get/Set methods properties if you are dealing with calculated properties. The most common use of Get/Set properties is to reflect changes in a user interface for calculated properties or items that are updated.

<OL>
	<LI>In ClassWizard, click the <B>Automation</B> tab.<BR><BR></LI>

	<LI>Select a class name that supports Automation. You can also select the name of your document class if you checked the Automation check box in AppWizard when creating your project. Notice that the <B>Add Property</B> and <B>Add Method</B> buttons are unavailable for classes that do not support Automation. <BR><BR></LI>

	<LI>Click <B>Add Property</B> and supply the following information:
<UL type=disc>
	<LI>External Name: Name that automation clients use to refer to this property.<BR><BR></LI>

	<LI>Type: Any of the choices found in the list box.<BR><BR></LI>

	<LI>Implementation: Choose Get/Set Methods.<BR><BR></LI>

	<LI>Get Function: The name of the member function used to get the property value.<BR><BR></LI>

	<LI>Set Function: The name of the member function used to set the property value. This function can include special processing for when the property value is changed.</LI>
</UL>
</LI>

	<LI>Add any method parameters you need, using the grid control:
<UL type=disc>
	<LI>Double-click in the first empty row under the Name label to activate an edit control; then enter the parameter name.<BR><BR></LI>

	<LI>Double-click the row under the Type label to activate a drop-down list; then select the parameter's type.
<P class=tl>Continue this procedure until you have entered all the parameters you need. To delete a parameter, delete its row by clicking once in the row and pressing the DELETE key or the BACKSPACE key.</P></LI>
</UL>
</LI>

	<LI>Click <B>OK</B> to create the necessary code.</LI>
</OL>

<P class=indent><B><B>Tip</B></B>&nbsp;&nbsp;&nbsp;To create a read-only property, delete the name of the Set Function.</P>

<H2><A NAME="_core_adding_a_method_to_your_automation_class"></A>Adding a Method to Your Automation Class</H2>

<OL>
	<LI>In ClassWizard, click the <B>Automation</B> tab.<BR><BR></LI>

	<LI>Select a class name that supports Automation. You can also select the name of your document class if you checked the Automation check box in AppWizard when creating your project. Notice that the <B>Add Property</B> and <B>Add Method</B> buttons are unavailable for classes that do not support Automation. <BR><BR></LI>

	<LI>Open the <B>Add Method</B> dialog box and supply the following information:
<UL type=disc>
	<LI>External Name: Name that automation clients use to refer to this method.<BR><BR></LI>

	<LI>Internal Name: Name of the C++ member function to add to the class.<BR><BR></LI>

	<LI>Return Type: Any choice found in the list box.</LI>
</UL>
</LI>

	<LI>Add any method parameters you need, using the grid control:
<UL type=disc>
	<LI>Double-click in the first empty row under the Name label to activate an edit control; then enter the parameter name.<BR><BR></LI>

	<LI>Double-click the row under the Type label to activate a drop-down list; then select the parameter's type.
<P class=tl>Continue this procedure until you have entered all the parameters you need. To delete a parameter, delete its row by clicking once in the row and pressing the DELETE key or the BACKSPACE key.</P></LI>
</UL>
</LI>

	<LI>Click <B>OK</B> in the <B>Add Method</B> dialog box to create the member function.</LI>
</OL>

<P><B>See Also</B>&nbsp;&nbsp;&nbsp;<A HREF="_core_classwizard.3a_.accessing_automation_servers.htm">ClassWizard: Accessing Automation Servers</A>, <A HREF="_core_automation_topics.htm">Automation Topics</A> </P>
</font>
</BODY>
</HTML>
