<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OpenURL Method</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbmthopenurlmethod"></a>OpenURL Method</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbmthOpenURLMethod_C;vbmthOpenURLMethodC;vbproBooksOnlineJumpTopic">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbmthOpenURLMethod_X;vbmthOpenURLMethodX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbmthOpenURLMethod_A;vbmthOpenURLMethodA">
</object></p>
<p>
Opens and returns the document at the specified URL. The document is returned as a variant. When the method has completed, the URL properties (and portions of the URL such as the protocol) are updated to reflect the current URL.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<i>object.</i><b>OpenUrl</b><i> url [,datatype]</i></p>
<p>
The <b>OpenURL</b> property syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=17%><b>Part</b></td>
<td class=label width=83%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=17%><i>object</i></td>
<td width=83%>An <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectexpression">
</object><a href=JavaScript:alink_4.Click()>object expression</a> that evaluates to an object in the Applies To list.</td>
</tr>
<tr valign=top>
<td width=17%><i>url</i></td>
<td width=83%>Required. The URL of the document to be retrieved.</td>
</tr>
<tr valign=top>
<td width=17%><i>datatype</i></td>
<td width=83%>Optional. Integer that specifies the type of the data, as shown in Settings.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
The settings for <i>datatype</i> are:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=19%><b>Constant</b></td>
<td class=label width=18%><b>Value</b></td>
<td class=label width=63%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=19%><b>icString</b></td>
<td width=18%>0</td>
<td width=63%>Default. Retrieves data as string.</td>
</tr>
<tr valign=top>
<td width=19%><b>icByteArray</b></td>
<td width=18%>1</td>
<td width=63%>Retrieves data as a byte array.</td>
</tr>
</table><br>
<p class=label>
<b>Return Type</b></p>
<p>
Variant</p>
<p class=label>
<b>Remarks</b></p>
<p>
The <b>OpenURL</b> method's return value depends on the target of the URL. For example, if the target URL is the directory of an FTP server, the directory will be returned. On the other hand, if the target is a file, the file will be retrieved.</p>
<p>
The <b>OpenURL</b> method is equivalent to invoking the <b>Execute</b> method with a GET operation, followed by a <b>GetChunk</b> method invoked in the StateChanged event. The <b>OpenURL</b> method, however, results in a synchronous stream of data being returned from the site.</p>
<p>
If you are retrieving a binary file, be sure to use a byte array as a temporary variable before writing it to disk, as shown below:</p>
<pre><code>Dim b() As Byte
Dim strURL As String
' Set the strURL to a valid address.
strURL = "FTP://ftp.GreatSite.com/China.exe"
b() = Inet1.<span class=cfe><b>OpenURL</b></span>(strURL, icByteArray)

Open "C:\Temp\China.exe" For Binary Access _
Write As #1
Put #1, , b()
Close #1
</code></pre>
<p class=indent>
<B><b>Note</b></B>&nbsp;&nbsp;&nbsp;When using the <b>OpenURL</b> method, set the <b>URL </b>property before you set the <b>Password </b>and <b>UserName </b>properties. If you set the <b>URL</b> property last, the <b>UserName </b>and <b>Password </b>properties will be set to "".</p>
</BODY>
</HTML>
