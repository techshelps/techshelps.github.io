<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>StateChanged Event</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY>

<h1><a name="vbevtstatechangedevent"></a>StateChanged Event</h1>
<p>
<object id=alink_1 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:See Also">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtStateChangedEvent_C;vbevtStateChangedEventC;vbproBooksOnlineJumpTopic">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_2 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Example">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtStateChangedEvent_X;vbevtStateChangedEventX">
</object>&nbsp;&nbsp;&nbsp;<object id=alink_3 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="Font" value=",,,,underline">
<PARAM name="Text" value="Text:Applies To">
<PARAM name="Flags" value=",,1">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="vbevtStateChangedEvent_A;vbevtStateChangedEventA">
</object></p>
<p>
Occurs whenever there is a state change in the connection.</p>
<p class=label>
<b>Syntax</b></p>
<p>
<i>object</i><b>_StateChanged(ByVal</b> <i>State </i><b>As Integer)</b></p>
<p>
The StateChanged event syntax has these parts:</p>
<table border=1 cellpadding=5 cols=2 frame=below rules=rows>
<tr valign=top>
<td class=label width=17%><b>Part</b></td>
<td class=label width=83%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=17%><i>object</i></td>
<td width=83%>An <object id=alink_4 type="application/x-oleobject"
	classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM name="Command" value="ALink">
<PARAM name="DefaultTopic" value="_topic_not_found.htm">
<PARAM name="Item1" value="">
<PARAM name="Item2" value="defobjectexpression">
</object><a href=JavaScript:alink_4.Click()>object expression</a> that evaluates to an object in the Applies To list.</td>
</tr>
<tr valign=top>
<td width=17%><i>State</i></td>
<td width=83%>Integer. Specifies the state, as shown in Settings below.</td>
</tr>
</table><br>
<p class=label>
<b>Settings</b></p>
<p>
The settings for <i>State</i> are:</p>
<table border=1 cellpadding=5 cols=3 frame=below rules=rows>
<tr valign=top>
<td class=label width=34%><b>Constant</b></td>
<td class=label width=11%><b>Value</b></td>
<td class=label width=55%><b>Description</b></td>
</tr>
<tr valign=top>
<td width=34%><b>icNone</b></td>
<td width=11%>0</td>
<td width=55%>No state to report.</td>
</tr>
<tr valign=top>
<td width=34%><b>icHostResolvingHost</b></td>
<td width=11%>1</td>
<td width=55%>The control is looking up the IP address of the specified host computer.</td>
</tr>
<tr valign=top>
<td width=34%><b>icHostResolved</b></td>
<td width=11%>2</td>
<td width=55%>The control successfully found the IP&nbsp;address of the specified host computer.</td>
</tr>
<tr valign=top>
<td width=34%><b>icConnecting</b></td>
<td width=11%>3</td>
<td width=55%>The control is connecting to the host computer.</td>
</tr>
<tr valign=top>
<td width=34%><b>icConnected</b></td>
<td width=11%>4</td>
<td width=55%>The control successfully connected to the host computer.</td>
</tr>
<tr valign=top>
<td width=34%><b>icRequesting</b></td>
<td width=11%>5</td>
<td width=55%>The control is sending a request to the host computer.</td>
</tr>
<tr valign=top>
<td width=34%><b>icRequestSent</b></td>
<td width=11%>6</td>
<td width=55%>The control successfully sent the request.</td>
</tr>
<tr valign=top>
<td width=34%><b>icReceivingResponse</b></td>
<td width=11%>7</td>
<td width=55%>The control is receiving a response from the host computer.</td>
</tr>
<tr valign=top>
<td width=34%><b>icResponseReceived</b></td>
<td width=11%>8</td>
<td width=55%>The control successfully received a response from the host computer.</td>
</tr>
<tr valign=top>
<td width=34%><b>icDisconnecting</b></td>
<td width=11%>9</td>
<td width=55%>The control is disconnecting from the host computer.</td>
</tr>
<tr valign=top>
<td width=34%><b>icDisconnected</b></td>
<td width=11%>10</td>
<td width=55%>The control successfully disconnected from the host computer.</td>
</tr>
<tr valign=top>
<td width=34%><b>icError</b></td>
<td width=11%>11</td>
<td width=55%>An error occurred in communicating with the host computer.</td>
</tr>
<tr valign=top>
<td width=34%><b>icResponseCompleted</b></td>
<td width=11%>12</td>
<td width=55%>The request has completed and all data has been received.</td>
</tr>
</table><br>
<p class=label>
<b>Remarks</b></p>
<p>
In general, you will use the StateChanged event to determine when to retrieve data using the <b>GetChunk</b> method. To do this, use a <b>Select Case </b>statement and test for <b>icResponseReceived</b> (8) or <b>icResponseCompleted</b> (12).</p>
<p>
Note, however, that the <b>icResponseReceived</b> state may occur when the control has completed an operation that hasn't resulted in any data in the buffer. For example, when connecting to an FTP site, the control will perform a "handshake" with the site that doesn't result in any data transfer, yet the <b>icResponseReceived</b> state will occur.</p>
<p>
On the other hand, the <b>icResponseCompleted</b> state occurs after an operation has completed in its entirety. For example, if you are using the <b>Execute</b> method with the GET operation to retrieve a file, the <b>icResponseCompleted</b> event will occur only once — after the file has been totally retrieved.</p>
<p>
In practice, using the <b>icResponseReceived</b> state allows you to parse the data until you have retrieved only the information you need (for example, when retrieving an HTML file, retrieving only the headers). Once you have the information, you can cancel the retrieval. On the other hand, if you are intent on retrieving the whole file, the <b>icResponseCompleted</b> state will notify you that the transfer is completed, allowing you to proceed.</p>
</BODY>
</HTML>
