<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Connecting to a Microsoft Exchange or Outlook Folder</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2connecting_to_a_microsoft_exchange_or_outlook_folder"></a>Connecting to a Microsoft Exchange or Outlook Folder</h4>
<p>
You can open a Microsoft Exchange or Outlook folder directly, link a folder to a Microsoft Access&nbsp;97 table, or import the data in a folder to an existing Microsoft Access table. The following sections describe these methods of accessing data stored in Microsoft Exchange or Outlook folders.</p>
<h5>Opening a Folder</h5>
<p>
To open a Microsoft Exchange or Outlook folder directly, use the connection string as an argument to the <b>OpenDatabase</b> method. Even though you are opening the folder directly, you must still specify a Microsoft Access database file that will contain the system files necessary to maintain the connection. This technique is useful when you don’t need to maintain a persistent connection to the data in a folder.</p>
<p>
The following code fragment uses the <b>OpenDatabase</b> method to open the personal folder store, and prints the name of each top-level folder to the Debug window. In this example, <code>strDbPath</code> is the path to the database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database
Dim tdf As TableDef
Dim strConnect As String

strConnect = &quot;Exchange 4.0;MAPILEVEL=Personal Folders|;&quot;
' Open Microsoft Exchange folder.
Set dbs = OpenDatabase(strDbPath, 0, 0, strConnect)

' Open each top-level folder.
For Each tdf In dbs.TableDefs
&#09;Debug.Print tdf.Name
Next tdf
Debug.Print &quot;Done&quot;
dbs.Close</font></pre>
<h5>Linking to a Folder</h5>
<p>
When you create a link to a Microsoft Exchange or Outlook folder, the folder is treated as a linked table. The following example creates a linked table in the current database that contains all the entries in the Inbox folder. In this example, <code>strDbPath</code> is the path to the database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database
Dim tdf As TableDef
Dim strConnect As String

' Open database.
Set dbs = OpenDatabase(strDbPath)

' Build the connection string.
strConnect = &quot;Exchange 4.0;MAPILEVEL=Mailbox - David Jones&quot; _
&#09;&amp; &quot;|;TABLETYPE=0;&quot; _
&#09;&amp; &quot;DATABASE=&quot; &amp; dbs.Name &amp; &quot;;&quot;

' Create a TableDef object. The name specified for the
' TableDef object is displayed as the name of the link
' in the Database window.
Set tdf = dbs.CreateTableDef(&quot;Linked Exchange Folder&quot;)
With tdf
&#09;' Set connection information and specify a folder.
&#09;.Connect = strConnect
&#09;.SourceTableName = &quot;Inbox&quot;
End With
' Append the TableDef object to create the link.
dbs.TableDefs.Append tdf</font></pre>
<h5>Importing a Folder</h5>
<p>
To import the data in Microsoft Exchange or Outlook folders to an existing Microsoft Access table, you need to make sure that the table that will receive the data contains the fields you want to import. Once you have a table in the correct format, you establish a temporary link to the folder and run an append query to add records to the specified table.</p>
<p>
<b>See Also   </b>For more information about creating a table and importing data from a Microsoft Exchange or Outlook folder, see the white paper “Accessing Microsoft Exchange and Microsoft Outlook Data Using Visual Basic,” located in the Papers folder on the companion CD-ROM.</p>
</BODY>
</HTML>
