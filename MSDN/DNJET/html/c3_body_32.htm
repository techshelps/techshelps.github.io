<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Parameter Queries</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2creating_parameter_queries"></a>Creating Parameter Queries</h4>
<p>
The <b>Parameters</b> collection of a <b>QueryDef</b> object identifies the parameters for a parameter query. The following example creates a new parameter query and prompts the user to input values for the parameters, then displays the records that match their criteria. In this example, <code>strDbPath</code> is the path to the NorthwindTables database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database
Dim qdf As QueryDef, rst As Recordset
Dim strSQL As String, strResults As String

Set dbs = OpenDatabase(strDbPath)
&#09;
' Define SQL string with PARAMETERS clause.
strSQL = &quot;PARAMETERS [Enter Start of Customer Company Name] Text, &quot; &amp; _
&#09;&quot;[Enter the City] Text; &quot; &amp; _
&#09;&quot;SELECT Customers.* &quot; &amp; _
&#09;&quot;FROM Customers WHERE &quot; &amp; _
&#09;&quot;(((Customers.CompanyName) Like &quot; &amp; _
&#09;&quot;[Enter Start of Customer Company Name] &amp; '*') &quot; &amp; _
&#09;&quot;AND ((Customers.City)=[Enter the City]));&quot;

' Create QueryDef object.
Set qdf = dbs.CreateQueryDef(&quot;qryCustSearch&quot;)
qdf.SQL = strSQL

' Prompt user for parameter values.
qdf.Parameters(&quot;[Enter Start of Customer Company Name]&quot;) = _
&#09;InputBox(&quot;Enter the first few letters of the customer's company name.&quot;)
qdf.Parameters(&quot;[Enter the City]&quot;) = _
&#09;InputBox(&quot;Enter the customer's city.&quot;)
&#09;
' Open Recordset object on QueryDef object.
Set rst = qdf.OpenRecordset
Do Until rst.EOF
&#09;strResults = strResults &amp; rst!CompanyName &amp; vbCrLf
&#09;rst.MoveNext
Loop

' Show customers returned.
If Not rst.BOF And rst.EOF Then
&#09;MsgBox &quot;Customers matching your criteria: &quot; &amp; vbCrLf &amp; strResults
End If</font></pre>
<p>
Unlike a <b>TableDef</b> object, in which you have to explicitly append each <b>Field</b> object to the <b>Fields</b> collection, the <b>Fields</b> and <b>Parameters</b> collections for <b>QueryDef</b> objects are automatically derived by Microsoft Jet based on the contents of the <b>SQL</b> property of the <b>QueryDef</b> object.</p>
<p>
<b>See Also   </b>For information about using permanent <b>QueryDef</b> objects, including how to supply parameter values programmatically, see Chapter&nbsp;4, “<a href="c4_body.htm">Queries</a>.”</p>
</BODY>
</HTML>
