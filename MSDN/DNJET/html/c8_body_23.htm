<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Example: Opening a Table in a Microsoft Excel 8.0 Workbook</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2example__opening_a_table_in_a_microsoft_excel_8.0_workbook"></a>Example: Opening a Table in a Microsoft Excel 8.0 Workbook</h4>
<p>
This example steps you through opening a table that is stored in a Microsoft Excel 8.0 workbook. The example follows the steps outlined in the previous section, “Opening an External Table.”</p>
<p>
The first step is to open the Microsoft Excel 8.0 workbook:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database, rst As Recordset

Set dbs = OpenDatabase(&quot;C:\JetBook\Samples\Excel\Products97.xls&quot;, _
&#09;False, False, &quot;Excel 8.0;HDR=NO;&quot;)</font></pre>
<p>
Note that the example uses <b>HDR=NO</b> to suppress the column header row from the count of records. If you don’t suppress headers in this example, the <b>RecordCount</b> property value displayed in the message box will incorrectly include the first row of column headings in the count of records.</p>
<p>
The second step is to create a <b>Recordset</b> object for the external data by using code similar to the following:</p>
<pre><FONT FACE="Courier New" SIZE="3">Set rst = dbs.OpenRecordset(&quot;Products97$&quot;)</font></pre>
<p>
The argument for the <b>OpenRecordset</b> method is the name of a particular worksheet in the Microsoft Excel workbook. The dollar sign character following the sheet name tells the IISAM driver that you’re referencing the entire sheet, rather than just a range on the sheet.</p>
<p>
The following example establishes the connection, creates a <b>Recordset</b> object, and displays the total number of records in a message box:</p>
<pre><FONT FACE="Courier New" SIZE="3">Sub OpenExcelWorkbook()
&#09;Dim dbs As Database
&#09;Dim rst As Recordset

&#09;' Open the Microsoft Jet sample database.
&#09;Set dbs = OpenDatabase(&quot;C:\JetBook\Samples\Excel\Products97.xls&quot;, _
&#09;&#09;False, False, &quot;Excel 8.0;HDR=NO;&quot;)

&#09;' Create a Recordset object for the Microsoft Excel Products worksheet.
&#09;Set rst = dbs.OpenRecordset(&quot;Products$&quot;)

&#09;' Move to the last record and display the RecordCount property value.
&#09;With rst
&#09;&#09;.MoveLast
&#09;&#09;MsgBox &quot;There are &quot; &amp; .RecordCount &amp; &quot; records in this worksheet.&quot;
&#09;&#09;.Close
&#09;End With
&#09;dbs.Close
End Sub</font></pre>
<p>
<b>See Also   </b>The sample workbook discussed in this chapter can be found in the JetBook\Samples\Excel sample file folder on the companion CD-ROM.</p>
</BODY>
</HTML>
