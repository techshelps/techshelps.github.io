<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Registering an ODBC Data Source</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h3><a name="jb2registering_an_odbc_data_source"></a>Registering an ODBC Data Source</h3>
<p>
Before you can use ODBC in a Microsoft Jet workspace or in an ODBCDirect workspace, you must register the ODBC data source. Registering the data source stores information about the data source in the Windows Registry and makes this information available to applications. You can register a data source from the ODBC Data Source Administrator or from Visual Basic.</p>
<p>
<b><font face="Symbol"><span style="font-family:symbol">&#219;</span></font>&#09;To register a SQL Server data source by using the ODBC Data Source Administrator</b>
<ol>
<li>
In Windows Control Panel, double-click the 32bit ODBC icon. In Microsoft Windows&nbsp;NT Workstation&nbsp;3.51 and 4.0, this icon is named ODBC.<br><br></li>
<li>
Click the tab for the kind of data source name (DSN) you want to define:<ul>
<li>
To create a DSN that is visible only to the user currently logged on to the current computer, click the <b>User DSN</b> tab.<br><br></li>
<li>
To create a DSN that is available to any user logged on to the current workstation, click the <b>System DSN</b> tab.<br><br></li>
<li>
To create a disk file that contains DSN information and that can be distributed with your application or accessed from a network location, click the <b>File DSN</b> tab. This option is only supported for the Microsoft SQL Server driver. Microsoft Jet will return an error if you try to use a .dsn file created for other drivers.</li>
</ul>
</li>
<li>
Click <b>Add</b> and then in the <b>Create New Data Source</b> dialog box, double-click the ODBC driver for the data source you want to access. For example, double-click <b>SQL Server</b>.<br><br></li>
<li>
In the <b>Data Source Name</b> box, type a data source name. This can be any string, such as SalesDB or Pubs. The string doesn’t have to correspond to the actual name of a database or table you want to access.<br><br></li>
<li>
In the <b>Description</b> box, type a description of the database, such as Sales Data for 1996. You can enter any text.<br><br></li>
<li>
In the <b>Server</b> box, type the name of the network server where your data source resides. Do not include a double-backslash (\\) before the name. If you don’t know the name of the server, you must get the exact name from your network administrator. If you are using Microsoft Windows&nbsp;NT Workstation, the names of registered servers will be available in the drop-down list.<br><br></li>
<li>
Click <b>Options</b>, and then type the exact name of the database you want to access in the <b>Database Name</b> box. For example, to specify the Microsoft SQL Server Pubs sample database, type <b>Pubs</b>.</li>
</ol>
<p>
<b>Note   </b>This procedure describes the steps for registering a Microsoft SQL Server data source. The steps for registering other ODBC data sources may vary because the data source driver requires a different set of information. If the dialog box for the data source you selected has values not described in the preceding steps, click the <b>Help</b> button for more information.</p>
<p>
In some cases, you may want to register the data source in Visual Basic code instead of relying on users to register it with the ODBC Data Source Administrator. To do this, use the <b>RegisterDatabase</b> method of the <b>DBEngine</b> object. The following example registers a data source named Pubs.</p>
<pre><FONT FACE="Courier New" SIZE="3">Function RegisterDB() As Boolean
&#09;Dim str As String, errLoop As Error

&#09;On Error GoTo Error_RegisterDB
&#09;' Build keywords string.
&#09;str = &quot;Description=SQL Server on Server Publishers&quot; &amp; _
&#09;&#09;vbCr &amp; &quot;OemToAnsi=No&quot; &amp; _
&#09;&#09;vbCr &amp; &quot;Network=(Default)&quot; &amp; _
&#09;&#09;vbCr &amp; &quot;Address=(Default)&quot; &amp; _
&#09;&#09;vbCr &amp; &quot;Server=Publishers&quot; &amp; _
&#09;&#09;vbCr &amp; &quot;Database=Pubs&quot;
&#09;' Register database.
&#09;DBEngine.RegisterDatabase &quot;Pubs&quot;, &quot;SQL Server&quot;, True, str
&#09;RegisterDB = True

Exit_RegisterDB:
&#09;Exit Function

Error_RegisterDB:
&#09;' Notify user of any errors that result from
&#09;' invalid data.
&#09;For Each errLoop In DBEngine.Errors
&#09;&#09;MsgBox &quot;Error number: &quot; &amp; errLoop.Number &amp; _
&#09;&#09;&#09;vbCr &amp; errLoop.Description
&#09;Next errLoop
&#09;RegisterDB = False
&#09;Resume Exit_RegisterDB
End Function</font></pre>
</BODY>
</HTML>
