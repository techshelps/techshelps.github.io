<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating an External Table</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h2><a name="jb2creating_an_external_table"></a>Creating an External Table</h2>
<p>
You can create a table in an external data format through Microsoft Access by exporting the structure and data from a Microsoft Jet object to the external data format.</p>
<p>
You create a table in an external format by using the <b>TransferDatabase</b> method of the <b>DoCmd</b> object.</p>
<p>
<b>Important   </b>This example uses the <b>TransferDatabase</b> method, which is only available in Microsoft Access; you cannot create a database or database table in an external data format by using VBA.</p>
<p>
After you’ve created the table, you can access it from the table’s native application or you can link or open it as you would any other external table. The following example demonstrates how to create a structure in a Microsoft Access table and use that structure as the basis for a FoxPro table:</p>
<pre><FONT FACE="Courier New" SIZE="3">Sub CreateExternalFoxProTable()
&#09;Dim dbs As Database
&#09;Dim tdf As TableDef
&#09;Dim fldContact As Field, fldPhone As Field
&#09;Dim rst As Recordset
&#09;Const conObjectExists = 3012

&#09;On Error GoTo Err_CreateExternalFoxProTable
&#09;' Create a Database object pointing to the current database. This
&#09;' code should be run from within a Microsoft Access database.
&#09;Set dbs = CurrentDb
&#09;' Create a table definition for the Microsoft Access table that will
&#09;' provide the structure information for the FoxPro table.
&#09;Set tdf = dbs.CreateTableDef(&quot;AccessTable&quot;)
&#09;With tdf
&#09;&#09;' Create two text fields in the Microsoft Access table.
&#09;&#09;Set fldContact = .CreateField(&quot;Contact&quot;, dbText)
&#09;&#09;fldContact.Size = 30
&#09;&#09;Set fldPhone = .CreateField(&quot;Phone&quot;, dbText)
&#09;&#09;fldPhone.Size = 25
&#09;&#09;' Append the newly created fields to the Microsoft Access table.
&#09;&#09;.Fields.Append fldContact
&#09;&#09;.Fields.Append fldPhone
&#09;End With
&#09;' Append the TableDef object to the TableDefs collection.
&#09;dbs.TableDefs.Append tdf

&#09;' Use the TransferDatabase method to export the Microsoft Access
&#09;' table's structure to a FoxPro table; this creates a new FoxPro
&#09;' table in the specified directory.
&#09;DoCmd.TransferDatabase acExport, &quot;FoxPro&nbsp;3.0&quot;, _
&#09;&#09;&quot;C:\JetBook\Samples\FoxTables&quot;, acTable, &quot;AccessTable&quot;, &quot;FoxTable&quot;
&#09;' Delete the TableDef object for the Microsoft Access table.
&#09;dbs.TableDefs.Delete &quot;AccessTable&quot;

&#09;' Link the new table and test it by inserting a few records.
&#09;Set tdf = dbs.CreateTableDef(&quot;LinkedFoxTable&quot;)
&#09;With tdf
&#09;&#09;.Connect = &quot;FoxPro&nbsp;3.0;DATABASE=C:\JetBook\Samples\FoxTables;&quot;
&#09;&#09;.SourceTableName = &quot;FoxTable&quot;
&#09;End With
&#09;dbs.TableDefs.Append tdf
&#09;Set rst = dbs.OpenRecordset(tdf.Name)
&#09;With rst
&#09;&#09;.AddNew
&#09;&#09;!Contact = &quot;Nancy Davolio&quot;
&#09;&#09;!Phone = &quot;555-9857&quot;
&#09;&#09;.Update
&#09;&#09;
&#09;&#09;.AddNew
&#09;&#09;!Contact = &quot;Andrew Fuller&quot;
&#09;&#09;!Phone = &quot;555-9482&quot;
&#09;&#09;.Update
&#09;&#09;
&#09;&#09;.AddNew
&#09;&#09;!Contact = &quot;Janet Leverling&quot;
&#09;&#09;!Phone = &quot;555-3412&quot;
&#09;&#09;.Update
&#09;&#09;
&#09;&#09;.AddNew
&#09;&#09;!Contact = &quot;Margaret Peacock&quot;
&#09;&#09;!Phone = &quot;555-8122&quot;
&#09;&#09;.Update
&#09;&#09;.Close
&#09;End With

Exit_CreateExternalFoxProTable:
&#09;On Error Resume Next
&#09;dbs.Close
&#09;Set dbs = Nothing
&#09;Exit Sub
&#09;
Err_CreateExternalFoxProTable:
&#09;If Err = conObjectExists Then
&#09;&#09;dbs.TableDefs.Delete tdf.Name
&#09;&#09;Resume
&#09;Else
&#09;&#09;MsgBox &quot;Error: &quot; &amp; Err.Number &amp; &quot; - &quot; &amp; Err.Description
&#09;&#09;Resume Exit_CreateExternalFoxProTable
&#09;End If
End Sub</font></pre>
</BODY>
</HTML>
