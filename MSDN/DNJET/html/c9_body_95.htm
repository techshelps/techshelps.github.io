<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Connections That Microsoft Jet Cannot Close</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2connections_that_microsoft_jet_cannot_close"></a>Connections That Microsoft Jet Cannot Close</h4>
<p>
There are two reasons that Microsoft Jet refuses a request to close a connection even when the idle time has expired. The first is pending query results, as discussed earlier in this chapter. If your application hasn’t finished retrieving the results of a query against a remote data source, Microsoft Jet will be unable to close the connection until the active statement on the connection has completed. To learn how to complete a statement, see “Completing Active Statements” earlier in this chapter.</p>
<p>
The second reason that Microsoft Jet might refuse to close a connection is that the connection has a pending transaction. Your application must commit or roll back the transaction before Microsoft Jet can release the connection. Because the decision to commit or roll back is usually based on logic in your application, you must ensure that all branches in your decision tree result in one of these conclusions. If the application does not determine the outcome of the transaction, Microsoft Jet will automatically roll back the transaction when you close the <b>Workspace</b> object that initiated the transaction.</p>
</BODY>
</HTML>
