<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Making Bulk Changes</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h3><a name="jb2making_bulk_changes"></a>Making Bulk Changes</h3>
<p>
Many of the changes you may otherwise perform by looping through all the records in a <b>Recordset </b>object can be done more efficiently with an update or delete query. For example, the following code shows how to update employee records to change the Title field value for all sales representatives to “Account Executive”. In this example, <code>strDbPath</code> is the path to the NorthwindTables database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database, qdf As QueryDef

Set dbs = OpenDatabase(strDbPath)
' Create temporary QueryDef object.
Set qdf = dbs.CreateQueryDef(&quot;&quot;)

With qdf
&#09;.SQL = &quot;UPDATE Employees &quot; &amp; _
&#09;&#09;&quot;SET Employees.Title = &quot;&quot;Account Executive&quot;&quot; &quot; &amp; _
&#09;&#09;&quot;WHERE Employees.Title = &quot;&quot;Sales Representative&quot;&quot;;&quot;
&#09;' Invoke query.
&#09;.Execute dbFailOnError
End With</font></pre>
<p>
Of course, the entire SQL string in this example can be replaced with a stored or temporary parameter query, in which case the program would prompt the user for parameter values. The following example shows how the previous example might be rewritten as a parameter query. In this example, <code>strDbPath</code> is the path to the NorthwindTables database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database, qdf As QueryDef
Dim strSQLUpdate As String, strOld As String, strNew As String

Set dbs = OpenDatabase(strDbPath)
strSQLUpdate = &quot;PARAMETERS [Old Title] Text, [New Title] Text; &quot; &amp; _
&#09;&quot;UPDATE Employees &quot; &amp; _
&#09;&quot;SET Employees.Title = [New Title] &quot; &amp; _
&#09;&quot;WHERE Employees.Title = [Old Title]; &quot;

' Create the QueryDef object.
Set qdf = dbs.CreateQueryDef(&quot;&quot;, strSQLUpdate)
' Prompt for old title.
strOld = InputBox(&quot;Enter old job title&quot;)
If Len(strOld) = 0 Then Exit Sub
' Prompt for new title.
strNew = InputBox(&quot;Enter new job title&quot;)
If Len(strNew) = 0 Then Exit Sub
With qdf
&#09;' Set parameter values.
&#09;.Parameters(&quot;Old Title&quot;) = strOld
&#09;.Parameters(&quot;New Title&quot;) = strNew
&#09;' Invoke query.
&#09;.Execute
End With</font></pre>
</BODY>
</HTML>
