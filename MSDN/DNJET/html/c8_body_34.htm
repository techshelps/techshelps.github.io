<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Understanding Schema.ini Files</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2understanding_schema.ini_files"></a>Understanding Schema.ini Files</h4>
<p>
Schema.ini files provide schema information about the records in a text file. Each Schema.ini entry specifies one of five characteristics of the table: the text file’s name; the file format; the field names, widths, and types; the character set; and special data type conversions. The following sections discuss these characteristics.</p>
<h5>Specifying the File Name</h5>
<p>
The first entry in the Schema.ini file is always the name of the text source file enclosed in square brackets. The following example illustrates the entry for the file Sample.txt:</p>
<pre><FONT FACE="Courier New" SIZE="3">[SAMPLE.TXT]</font></pre>
<h5>Specifying the File Format</h5>
<p>
The Format option in the Schema.ini file specifies the format of the text file. The text IISAM driver can read the format automatically from most character-delimited files. You can use any single character as a delimiter in the file except the double quotation mark. The Format option in Schema.ini overrides the Format setting in the \HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\3.5\Engines\Text key of the registry on a file-by-file basis. The following table lists the valid values for the Format option.</p>
<table>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Format specifier</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Table format</b></font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
TabDelimited</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Fields in the file are delimited by tabs.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
CSVDelimited</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Fields in the file are delimited by commas (comma-separated values).</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Delimited(*)</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Fields in the file are delimited by asterisks. You can substitute any character for the asterisk except the double quotation mark.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
FixedLength</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Fields in the file are of a fixed-length.</font></td>
</tr>
</table><br>
<p>
For example, to specify a format of comma-delimited, you would add the following line to the Schema.ini file:</p>
<pre><FONT FACE="Courier New" SIZE="3">Format=CSVDelimited</font></pre>
<h5>Specifying the Fields</h5>
<p>
You can specify field names in a character-delimited text file in two ways: either include the field names in the first row of the table and set the ColNameHeader option in Schema.ini to <b>True</b>; or specify each column by number and designate the column name and data type. For fixed-length files, you must specify each column by number and designate the column name, data type, and width.</p>
<p>
<b>Note   </b>The ColNameHeader option in Schema.ini overrides the FirstRowHasNames setting in the registry on a file-by-file basis.</p>
<p>
If you use the ColNameHeader option to specify field names in a character-delimited file, you can also instruct Microsoft Jet to guess the data types of the fields. Use the MaxScanRows option to indicate how many rows Microsoft Jet should scan when guessing the column types. If you set MaxScanRows to zero, Microsoft Jet scans the entire file. The MaxScanRows option in Schema.ini overrides the MaxScanRows setting in the \HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\3.5\Engines<BR>\Text key of the registry on a file-by-file basis.</p>
<p>
The following example shows how to indicate that Microsoft Jet should use the data in the first row of the table to determine field names and should examine the entire file to determine the data types used:</p>
<pre><FONT FACE="Courier New" SIZE="3">ColNameHeader=True
MaxScanRows=0</font></pre>
<p>
The next example shows how to designate fields in a table by using the column number (Col<i>n</i>) option, which is optional for character-delimited files and required for fixed-length files. The example shows the Schema.ini entries for two fields, a 10-character CustomerNumber text field and a 30-character CustomerName text field:</p>
<pre><FONT FACE="Courier New" SIZE="3">Col1=CustomerNumber Text Width 10
Col2=CustomerName Text Width 30</font></pre>
<p>
The syntax of the Col<i>n</i> entry follows:</p>
<p>
<b>Col</b><i>n</i><b>=</b><i>columnname</i> <i>type</i> [<b>Width</b> <i>#</i>]</p>
<p>
The following table describes each part of the Col<i>n</i> entry.</p>
<table>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Argument</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Description</b></font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<i>columnname</i></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
The text name of the column. If the column name contains embedded spaces, it must be enclosed in double quotation marks.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<i>Type</i></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Value types are:<p>
Microsoft Jet data types:<BR>Bit (Boolean)<BR>Byte<BR>Short (Integer)<BR>Long<BR>Currency<BR>Single<BR>Double<BR>Date/Time<BR>Text<BR>Memo</p>
<p>
ODBC Text Driver data types:<BR>Char (same as Text)<BR>Float (same as Double)<BR>Integer (same as Short)<BR>LongChar (same as Memo)<BR>Date <i>date format</i></p>
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Width</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
The literal string value <code>Width</code>. Indicates that the following number designates the width of the column (optional for character-delimited files, required for fixed-length files).</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<i>#</i></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
The integer value that designates the width of the column (required if  <b>Width</b> is specified).</font></td>
</tr>
</table><br>
<h5>Selecting a Character Set</h5>
<p>
You can select from two character sets: ANSI and OEM. The following example shows the Schema.ini entry for an OEM character set. The CharacterSet option in the Schema.ini file overrides the CharacterSet setting in the \HKEY_LOCAL_MACHINE<BR>\SOFTWARE\Microsoft\Jet\3.5\Engines\Text key of the registry on a file-by-file basis. The following example shows the Schema.ini entry that sets the character set to ANSI:</p>
<pre><FONT FACE="Courier New" SIZE="3">CharacterSet=ANSI</font></pre>
<h5>Specifying Data Type Formats and Conversions</h5>
<p>
The Schema.ini file contains a number of options that you can use to specify how data is converted or displayed when read by Microsoft Jet. The following table lists each of these options.</p>
<table>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Option </b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Description</b></font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
DateTimeFormat</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Can be set to a format string indicating dates and times. This entry should be specified if all Date/Time fields in the import or export are handled with the same format. All of the Microsoft Jet formats except AM and PM are supported. In the absence of a format string, the short date picture and time options in the Windows Control Panel are used.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
DecimalSymbol</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Can be set to any single character that is used to separate the integer from the fractional part of a number. If this entry is absent, the default value in the Control Panel is used.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
NumberDigits</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Indicates the number of decimal digits in the fractional portion of a number. If this entry is absent, the default value in the Control Panel is used.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
NumberLeadingZeros</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Specifies whether a decimal value less than 1 and greater than &nbsp;–&nbsp;1 should contain leading zeros; this value can either be <b>False</b> (no leading zeros) or <b>True</b>.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
CurrencySymbol</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Indicates the currency symbol to be used for currency values in the text file. Examples include the dollar sign ($) and Dm. If this entry is absent, the default value in the Control Panel is used.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
CurrencyPosFormat</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Can be set to any of the following values:<ul>
<li>
Currency symbol prefix with no separation ($1)<br><br></li>
<li>
Currency symbol suffix with no separation (1$)<br><br></li>
<li>
Currency symbol prefix with one character separation ($ 1)<br><br></li>
<li>
Currency symbol suffix with one character separation (1 $)</li>
</ul>
<p>
If this entry is absent, the default value in the Control Panel is used.</p>
</font></td>
</tr>
</table><br>
<table>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Option </b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Description</b></font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
CurrencyDigits</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Specifies the number of digits used for the fractional part of a currency amount. If this entry is absent, the default value in the Control Panel is used.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
CurrencyNegFormat</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Can be one of the following values:<p>
($1)</p>
<p>
$1</p>
<p>
$–1</p>
<p>
$1–</p>
<p>
(1$)</p>
<p>
–1$</p>
<p>
1–$</p>
<p>
1$–</p>
<p>
–1 $</p>
<p>
–$ 1</p>
<p>
1 $–</p>
<p>
$ 1–</p>
<p>
$ –1</p>
<p>
1– $</p>
<p>
($ 1)</p>
<p>
(1 $)</p>
<p>
The dollar sign is shown for the purposes of this example, but it is replaced with the appropriate CurrencySymbol value in the actual program. If this entry is absent, the default value in the Control Panel is used.</p>
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
CurrencyThousandSymbol</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Indicates the single-character symbol to be used for separating currency values in the text file by thousands. If this entry is absent, the default value in the Control Panel is used.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
CurrencyDecimalSymbol</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Can be set to any single character that is used to separate the whole from the fractional part of a currency amount. If this entry is absent, the default value in the Control Panel is used.</font></td>
</tr>
</table><br>
</BODY>
</HTML>
