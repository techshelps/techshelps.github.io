<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Linking Tables by Using DAO</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2linking_tables_by_using_dao"></a>Linking Tables by Using DAO</h4>
<p>
To link to an external table by using DAO, you must create and append a <b>TableDef</b> object to a database’s <b>TableDefs</b> collection that specifies the following items:
<ul>
<li>
The name you want displayed for the linked table in the local database<br><br></li>
<li>
The name of the table as it exists in its original location<br><br></li>
<li>
The database format and location of the external table, and any additional information required to open the database where the external table resides</li>
</ul>
<p>
The following code opens a specified database and creates a new table. It then opens a second specified database and creates a link to the new table in the first database. Note that this code works only when both databases are Microsoft Jet databases. In this example, <code>strDbPathBase</code> is the path to the database containing the base table, <code>strBaseTableName</code> is the name of the new base table, <code>strFieldName</code> is the name of the field in the base table, <code>intType</code> is a constant specifying what type of field to create, <code>strDbPathLinked</code> is the path to the linked table, and <code>strLinkedTableName</code> is the name of the new linked table:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbsBase As Database, dbsLinked As Database
Dim tdfBase As TableDef, tdfLinked As TableDef, fld As Field
&#09;
' Open the first database and create a new TableDef object.
Set dbsBase = OpenDatabase(strDbPathBase)
Set tdfBase = dbsBase.CreateTableDef(strBaseTableName)
Set fld = tdfBase.CreateField(strFieldName, intType)
tdfBase.Fields.Append fld
dbsBase.TableDefs.Append tdfBase
dbsBase.Close
Set dbsBase = Nothing

' Open the second database and create a new TableDef object.
Set dbsLinked = OpenDatabase(strDbPathLinked)
Set tdfLinked = dbsLinked.CreateTableDef(strLinkedTableName)

' Create a link to the new table in first database.
tdfLinked.SourceTableName = strBaseTableName
tdfLinked.Connect = &quot;;DATABASE=&quot; &amp; strDbPathBase
dbsLinked.TableDefs.Append tdfLinked
dbsLinked.Close
dbsLinked = Nothing</font></pre>
<p>
Depending on the database format you are linking to, the contents of the <b>Connect</b> property of the new <b>TableDef</b> object may change. The <b>Connect</b> property in this example begins with:</p>
<pre><FONT FACE="Courier New" SIZE="3">;DATABASE=</font></pre>
<p>
Note that nothing precedes the semicolon. This is the default value used when you are linking to tables in Microsoft Jet-format databases. If you are linking to a table in another format, such as FoxPro, you must specify the name of the installable ISAM driver that Microsoft Jet should use. For example:</p>
<pre><FONT FACE="Courier New" SIZE="3">FoxPro 3.0;DATABASE=C:\JetBook\Samples\FoxTables</font></pre>
<p>
The connection to an external ODBC source may require more information:</p>
<pre><FONT FACE="Courier New" SIZE="3">ODBC;DSN=SuperDb;UID=sa;DATABASE=NorthwindSQL;TABLE=dbo.Products</font></pre>
<p>
In the Microsoft Access user interface, you can view the connection information used to link a table by opening the table in Design view, and then viewing the text in the table’s <b>Description</b> property.</p>
<p>
<b>See Also   </b>For more information about how to specify different database formats by using the <b>Connect</b> property, search the DAO Help index for “Connect property.”</p>
</BODY>
</HTML>
