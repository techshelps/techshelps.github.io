<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Linking a Comma-Delimited Text File</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2linking_a_comma-delimited_text_file"></a>Linking a Comma-Delimited Text File</h4>
<p>
The procedures for linking a comma-delimited file are similar to those for linking other database tables. If you want Microsoft Jet to use the information in the Schema.ini file, however, you must place the data file and the Schema.ini file in the same directory. The following example illustrates how to link a comma-delimited text file. In this example, <code>strDbPath</code> is the path to the database that will contain the linked table:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database
Dim tdf As TableDef
Dim qdf As QueryDef
Dim rst As Recordset

' Open database.
Set dbs = OpenDatabase(strDbPath)

' Create a table definition for text table.
Set tdf = dbs.CreateTableDef(&quot;TextProducts&quot;)

' Provide source database type, database name with Connect property.
tdf.Connect = &quot;TEXT;DATABASE=C:\JetBook\Samples\Text\CommaDelimited&quot;

' Provide name of text table with the SourceTableName property.
tdf.SourceTableName = &quot;Sample1.txt&quot;

' Append TableDef object to the TableDefs collection to create the link.
dbs.TableDefs.Append tdf

' Run a simple query to ensure the data is accessible.
Set qdf = dbs.CreateQueryDef(&quot;&quot;)
qdf.SQL = &quot;SELECT Sum(UnitPrice) AS Tally FROM TextProducts;&quot;
Set rst = qdf.OpenRecordset()
MsgBox &quot;Total Sales = $&quot; &amp; rst!Tally
rst.Close
dbs.Close</font></pre>
</BODY>
</HTML>
