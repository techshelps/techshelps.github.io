<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>New Fields</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2new_fields"></a>New Fields</h4>
<p>
The conversion process adds several new system fields to each existing table in a database. Among these fields are a unique identifier, a generation indicator, and a lineage indicator. All replication fields are read-only.</p>
<h5>Unique Identifier (GUID)</h5>
<p>
During the conversion of a database, Microsoft Jet first looks at the existing fields in a table to determine if any field uses both the dbGUID data type (in Microsoft Access, the AutoNumber data type) and either the <b>dbAutoIncrField</b> or the <b>dbSystemField</b> attribute constant (in Microsoft Access, the Replication ID field size). If no field uses that data type and one of those attributes, Microsoft Jet adds the s_GUID field, which stores the AutoNumber that uniquely identifies each record. The AutoNumber for a specific record is identical across all replicas.</p>
<p>
The AutoNumber is a 16-byte GUID (globally unique identifier, sometimes referred to as a UUID, or universally unique identifier) that appears in the following format:</p>
<p>
{2FAC1234-31F8-11B4-A222-08002B34C003}</p>
<p>
The hyphens and braces are used for display only and are not stored as part of the GUID.</p>
<p>
Autogenerated GUID fields are identified by the dbGUID data type and either the <b>dbAutoIncrField</b> or the <b>dbSystemField</b> attribute constant. There can be more than one field in a table with the dbGUID data type, but there can be only one autogenerated field with the dbGUID data type in a table (regardless of whether it is replicable). If an autogenerated GUID field is added to a table, GUID values are generated for all records in the table. The value of an autogenerated GUID cannot be changed or deleted.</p>
<h5>Generation Identifier</h5>
<p>
During the conversion process, Microsoft Jet also adds a field called s_Generation to each table in the database. The s_Generation field is used to determine which records are sent during synchronization. This allows the sending replica to avoid sending records that have not been updated since the last synchronization. Whenever a record is modified, its generation field is set to 0.</p>
<p>
In general, during a synchronization all records with an s_Generation field set to 0 are sent, and then the generation field for the record is incremented to 1 more than the last generation, which now becomes the new highest generation. The sending replica knows the last generation sent to that specific receiving replica, and sends only records with generation 0 and generations higher than the previous generations.</p>
<p>
The receiving replica does not apply generations received out of sequence. In some cases, Microsoft Jet might determine that there are too many records to be sent in a single message and split a synchronization into more than one message.</p>
<p>
Generally, there is a single generation field per record. To optimize synchronizations for databases that contain Memo (Long Text) or OLE Object (Long Binary) fields (sometimes referred to as a BLOBs, or binary large objects), an extra generation field is associated with each BLOB. If the BLOB is modified, this generation value is set to 0 so that the BLOB is sent during the next synchronization. If a record modifies other fields, but not the BLOB, the BLOB’s generation field is not set to 0 and the BLOB is not sent.</p>
<p>
This extra generation field is named Gen<i>_xxxx</i>, where <i>xxxx</i> is the BLOB field’s name (truncated, if necessary). If this name duplicates an existing field name, the prefix is changed, one character at a time, until a unique name is found. A <b>ColGeneration</b> property is set on the BLOB field to identify the added Gen_<i>xxxx</i> field. One of these fields is set for each BLOB field.</p>
<h5>Lineage Identifier</h5>
<p>
During the conversion process, Microsoft Jet also adds a field named s_Lineage to each table in the database. The s_Lineage field is used to determine which replicas have already received an update and also determine the winner if a conflict occurs. It contains a list of nicknames for replicas that have updated the record and the last version created by each of those replicas. The version field is an integral field that is incremented when the record is changed. The first pair of values in the lineage reflects the current version and the name of the last member of the replica set to update the record. This is a binary field and is not usually readable by users.</p>
</BODY>
</HTML>
