<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Example: Linking a FoxPro Database</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2example__linking_a_foxpro_database"></a>Example: Linking a FoxPro Database</h4>
<p>
The following example steps you through linking a FoxPro database to a Microsoft Jet database. The example follows the steps outlined in the previous section, “Creating a Link to an External Table.”</p>
<p>
<b>Note   </b>If you link a FoxPro&nbsp;3.0 table to a Microsoft Jet database and then view the connection string in table Design view in Microsoft Access, the specifier in the connection string appears as <b>FoxPro&nbsp;2.0</b>. Microsoft Access uses the FoxPro&nbsp;2.0 specifier for both FoxPro&nbsp;2.<i>x</i> and 3.0 tables.</p>
<p>
The first step is to open a Microsoft Jet database. In the following line of code, <code>strDbPath</code> is the path to the database that will contain the linked table:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database, tdf As TableDef

Set dbs = OpenDatabase(strDbPath)</font></pre>
<p>
The second step is to create the table definition:</p>
<pre><FONT FACE="Courier New" SIZE="3">Set tdf = dbs.CreateTableDef(&quot;EmployeeSalesQ1&quot;)</font></pre>
<p>
The third step is to set the connection information:</p>
<pre><FONT FACE="Courier New" SIZE="3">tdf.Connect = &quot;FoxPro&nbsp;3.0;DATABASE=C:\JetBook\Samples\FoxTables\Sales&quot;
tdf.SourceTableName = &quot;EmpSales&quot;</font></pre>
<p>
<b>Note   </b>You can use the <b>Connect</b> property to specify the database name and the <b>SourceTableName</b> property to specify the table name for all IISAM drivers. For external data sources that store one table per file, the <b>Connect</b> property should contain the full directory or network path to the file, and the<b> SourceTableName</b> property should contain the data file name with no extension. For external data sources that store multiple tables in a file, the <b>Connect</b> property should contain the full directory or network path to the file including the file name and extension; the<b> SourceTableName</b> property should contain the table name.</p>
<p>
The fourth and final step is to append the <b>TableDef</b> object to the <b>TableDefs</b> collection:</p>
<pre><FONT FACE="Courier New" SIZE="3">dbs.TableDefs.Append tdf</font></pre>
<p>
The following example establishes the connection, appends the linked table, and tests the data to make sure that it can be accessed. In this example, <code>strDbPath</code> is the path to the database that will contain the linked table:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database
Dim tdf As TableDef, qdf As QueryDef, rst As Recordset

Set dbs = OpenDatabase(strDbPath)
' Create a table definition for the FoxPro table.
Set tdf = dbs.CreateTableDef(&quot;EmployeeSalesQ1&quot;)
With tdf
&#09;' Provide source database type and name with Connect property.
&#09;.Connect = &quot;FoxPro&nbsp;3.0;DATABASE=C:\JetBook\Samples\FoxTables\Sales&quot;
&#09;' Provide name of FoxPro table.
&#09;.SourceTableName = &quot;EmpSales&quot;
End With

' Append TableDef object to the TableDefs collection to create the link.
dbs.TableDefs.Append tdf

' Run a simple query to ensure the data is accessible.
Set qdf = dbs.CreateQueryDef(&quot;&quot;)
qdf.SQL = &quot;SELECT Sum(Sales) As TotalSales FROM &quot; _
&#09;&amp; &quot;EmployeeSalesQ1;&quot;
Set rst = qdf.OpenRecordset()
MsgBox &quot;Total Sales = &quot; &amp; Format(rst!TotalSales, &quot;Currency&quot;)</font></pre>
<p>
<b>See Also   </b>The FoxPro database discussed in this chapter can be found in the JetBook\Samples\FoxTables sample file folder on the companion CD-ROM.</p>
</BODY>
</HTML>
