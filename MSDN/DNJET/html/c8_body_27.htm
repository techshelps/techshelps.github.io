<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Working with dBASE Databases</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2working_with_dbase_databases"></a>Working with dBASE Databases</h4>
<p>
Borland’s dBASE product line includes the following versions supported by the Microsoft Jet Xbase IISAM driver: dBASE III, dBASE IV, and dBASE 5.0. dBASE databases differ from Microsoft Jet databases in four major areas: data types, handling of deleted records, specification of indexes, and storage of Long Text (Memo) fields. The following sections describe these differences.</p>
<h5>Converting dBASE Data Types to Microsoft Jet Data Types</h5>
<p>
Microsoft Jet translates each dBASE data type into the corresponding Microsoft Jet data type when your application reads the data. The following table shows the one-to-one correspondence between data types.</p>
<table>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>dBASE data type</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Microsoft Jet data type</b></font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Character</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Text</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Numeric, Float</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Double</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Logical</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Boolean</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Date</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Date/Time</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Memo</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Memo</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
OLE</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Long Binary (OLE Object)</font></td>
</tr>
</table><br>
<h5>Handling Deleted Records</h5>
<p>
When you delete a record from a dBASE table through your application, the record is marked as deleted in the table. The record is not, however, removed from the table because dBASE allows users to recover deleted records until the table is packed. Because you cannot pack a dBASE table through Microsoft Jet, deleted records will continue to appear in your application’s data set.</p>
<p>
To force Microsoft Jet to filter out deleted records in a dBASE table, you must set a setting in the registry. You can do this by setting the Deleted setting under the \HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\3.5\Engines\Xbase key to 01 (<b>True</b>) and restarting Microsoft Jet. This will hide deleted dBASE records from your application.</p>
<h5>Handling dBASE Indexes</h5>
<p>
You can speed up Microsoft Jet access to dBASE tables by specifying the dBASE .ndx or .mdx index files to use. Index files are specified in an .inf file, which you can create either by linking your dBASE table through the Microsoft Access user interface or by creating a text file with the same file name as your dBASE database and appending an .inf extension. The following procedure describes how to create an .inf file for the hypothetical dBASE database Sales.dbf.
<ol>
<li>
Create the text file Sales.inf.<br><br></li>
<li>
On the first line, add the database type identifier enclosed in square brackets. For example, to specify dBASE III indexes, type the following:<pre><FONT FACE="Courier New" SIZE="3">[dBASE III]</font></pre>
</li>
<li>
Assign an index number to the first index for the database. Number the first index NDX1, the second NDX2, and so on. If you want to specify multiple-index (.mdx) files for dBASE IV or dBASE 5.0 databases, use index numbers of the form MDX1, MDX2, and so on. You can specify unique indexes by prepending a “U” to the index number.<br><br></li>
<li>
Follow the index number with an equal sign and the file name of the index you want to specify, including the extension. Don’t put any spaces in this entry. For example, to specify the index Custname.ndx as the first index and the unique index Custno.ndx as the second index, add the following entries:<pre><FONT FACE="Courier New" SIZE="3">NDX1=CUSTNAME.NDX
UNDX1=CUSTNO.NDX</font></pre>
</li>
<li>
Repeat steps 3 and 4 until you’ve specified all indexes for the database table. Your completed .inf file should look similar to the following:<pre><FONT FACE="Courier New" SIZE="3">[dBASE III]
NDX1=CUSTNAME.NDX
UNDX1=CUSTNO.NDX</font></pre>
</li>
<li>
Save the .inf file to the directory that contains your dBASE database. Alternatively, you can create an INFPath setting in the registry to point to the path where the .inf file is stored. This is useful if you cannot store the .inf file in the same directory as the database, (for example, if the file is on a CD-ROM or a read-only network server), or if you want to keep all .inf files in one shared location for easy maintenance.<p>
To create an INFPath setting in your registry, you must manually add the registry setting in the Registry Editor as a string value. To add the setting, open the \HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\3.5\Engines\Xbase key in the registry. On the <b>Edit</b> menu, point to <b>New</b>, and then click <b>String Value</b>. Type <b>INFPath</b> as the name, and type the full directory or network path to the .inf file in the data field. Save the registry changes and restart Microsoft Jet to use this setting.</p>
</li>
</ol>
<p>
Keep in mind that Microsoft Jet will need to periodically update your index files as you change data from within your dBASE database. If you associate index files with a dBASE database that is linked or opened from a Microsoft Jet database, you need to make sure the indexes are available to your Microsoft Jet database as well.</p>
<p>
<b>Important   </b>Don’t delete or move the index files or the .inf file without updating associated references (such as the registry). If Microsoft Jet doesn’t have access to up-to-date index information, it cannot correctly process queries.</p>
<h5>Handling Memo Fields</h5>
<p>
Memo fields for dBASE databases are stored in the file system instead of in the database. If you want to link or open a dBASE database that has Memo fields, make sure the Memo field files are stored in the same directory as the database files.</p>
</BODY>
</HTML>
