<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Updating Links to Tables That Have Moved</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h3><a name="jb2updating_links_to_tables_that_have_moved"></a>Updating Links to Tables That Have Moved</h3>
<p>
If you move a table that you previously linked, you need to <i>refresh</i> the link before you can access the table again. To refresh a link, you must reset the <b>Connect</b> property of the <b>TableDef</b> object to point to the table’s new location. Then, use the <b>RefreshLink</b> method of the <b>TableDef</b> object to update the link information.</p>
<p>
The following procedure shows how to re-create the link to a FoxPro table that was moved to another directory after it was linked to a Microsoft Jet database. The <b>TableDef</b> object LostLink is linked to the FoxPro table LostLink.dbf, which was originally in the JetBook\Samples\FoxTables\Sales directory but is now in the JetBook\Samples\FoxTables\LostLink directory. When you try to open the linked table, Microsoft Jet reports that it couldn’t find the object “LostLink.”
<ol>
<li>
Try to open the table LostLink.dbf through Microsoft Access. Microsoft Access displays the message “Couldn’t find object ‘LostLink’.”<br><br></li>
<li>
Run the following code, where <code>strDbPath</code> is the path to the Microsoft Jet sample database:<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database
Dim qdf As QueryDef
Dim rst As Recordset

Set dbs = OpenDatabase(strDbPath)
' Update connection string to include new location.
dbs!LostLink.Connect = &quot;FoxPro&nbsp;3.0&quot; &amp; _
&#09;&quot;;DATABASE=C:\JetBook\Samples\FoxTables\LostLink&quot;
' Refresh link.
dbs.TableDefs!LostLink.RefreshLink

' Run a simple query to ensure the data is accessible.
Set qdf = dbs.CreateQueryDef(&quot;&quot;)
qdf.SQL = &quot;SELECT Sum(Sales) As Tally FROM LostLink;&quot;
Set rst = qdf.OpenRecordset()
MsgBox &quot;Total Sales = $&quot; &amp; rst!Tally
rst.Close
dbs.Close</font></pre>
</li>
<li>
Try to open the table LostLink.dbf through Microsoft Access once again. Microsoft Access opens the linked table.</li>
</ol>
</BODY>
</HTML>
