<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Finding the Current Position in a Recordset</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h3><a name="jb2finding_the_current_position_in_a_recordset"></a>Finding the Current Position in a Recordset</h3>
<p>
In some situations, you need to determine how far through a <b>Recordset </b>object you have moved the current record position, and perhaps indicate the current record position to a user. For example, you may want to indicate the current position on a dial, meter, or similar type of control. Two properties are available to indicate the current position: the <b>AbsolutePosition</b> property and the <b>PercentPosition</b> property.</p>
<p>
The <b>AbsolutePosition</b> property value is the position of the current record from 0 to one less than the total number of records in a non-table-type <b>Recordset</b> object. However, don’t think of this property as a record number; if the current record is undefined, the <b>AbsolutePosition</b> property returns &nbsp;–&nbsp;1. Further, there is no guarantee that records will appear in the same order every time the <b>Recordset </b>object is accessed.</p>
<p>
The <b>PercentPosition</b> property shows the current position expressed as a percentage of the total number of records indicated by the <b>RecordCount</b> property. Because the <b>RecordCount</b> property does not reflect the total number of records in the <b>Recordset</b> object until the <b>Recordset</b> object has been fully populated, the <b>PercentPosition</b> property reflects the current record position only as a percentage of the number of records that have been accessed since the <b>Recordset</b> object was opened. To make sure that the <b>PercentPosition</b> property reflects the current record position relative to the entire <b>Recordset</b> object, use the <b>MoveLast</b> and <b>MoveFirst</b> methods immediately after opening the <b>Recordset</b> object. This fully populates the <b>Recordset </b>object before you attempt to use the <b>PercentPosition</b> property. If you have a large result set, you may not want to use the <b>MoveLast</b> method because it may take a long time.</p>
<p>
<b>Caution   </b>The <b>PercentPosition</b> property is only an approximation and shouldn’t be used as a critical parameter. This property is best suited for driving an indicator, such as a “percent complete” control, or a similar indicator that marks a user’s progress while moving though a set of records.</p>
<p>
The following example opens a <b>Recordset</b> object on a table called Employees and fully populates it. The program then lists the content of each field of each record in the table, numbering the records as they are printed. When half the records have been printed, a message indicates that the user is more than halfway through the table. In this example, <code>strDbPath</code> is the path to the NorthwindTables database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database, rst As Recordset

Set dbs = OpenDatabase(strDbPath)
Set rst = dbs.OpenRecordset(&quot;Employees&quot;, dbOpenDynaset)

With rst
&#09;' Move to end of recordset.
&#09;.MoveLast
&#09;' Move back to start of recordset.
&#09;.MoveFirst
&#09;Do While Not .EOF
&#09;&#09;Debug.Print &quot;Record No. &quot; &amp; .AbsolutePosition + 1
&#09;&#09;Debug.Print !FirstName &amp; &quot; &quot; &amp; !LastName
&#09;&#09;Debug.Print &quot;AbsolutePosition = &quot; &amp; .AbsolutePosition
&#09;&#09;Debug.Print &quot;PercentPosition = &quot; &amp; .PercentPosition
&#09;&#09;If .PercentPosition &gt; 50 Then
&#09;&#09;&#09;Debug.Print &quot;More than half way!&quot;
&#09;&#09;End If
&#09;&#09;Debug.Print
&#09;&#09;.MoveNext
&#09;Loop
&#09;.Close
End With</font></pre>
</BODY>
</HTML>
