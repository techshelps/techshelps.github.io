<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>TOP N and TOP N PERCENT Predicates</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2top_n_and_top_n_percent_predicates"></a>TOP N and TOP N PERCENT Predicates</h4>
<p>
Although you can use the WHERE and HAVING clauses to filter the selection of records, sometimes this isn’t sufficient. For example, you may want to select all records where the state is CA, but only see the orders for the top 10 customers. Microsoft Jet provides TOP N and TOP N PERCENT predicates to limit the presentation of records after they’re selected.</p>
<h5>TOP N Predicate</h5>
<p>
You can use the TOP N predicate to specify that your query return only a specific number of records to your program:</p>
<pre><FONT FACE="Courier New" SIZE="3">SELECT TOP 5 
&#09;Employees.EmployeeID, 
&#09;Employees.Salary
FROM Employees
ORDER BY Employees.Salary;</font></pre>
<p>
The TOP criteria is applied after the records are selected. TOP doesn’t necessarily imply “higher” or “more.” Think of it as the “first <i>n</i> records” of the result set. For example, the previous query actually produces a list of employees with the <i>lowest</i> salary, not the highest, because the records are sorted in ascending order by salary. If you want to find the employees with the highest salary, sort the records in descending order based on salary:</p>
<pre><FONT FACE="Courier New" SIZE="3">SELECT TOP 5 
&#09;Employees.EmployeeID, 
&#09;Employees.Salary
FROM Employees
ORDER BY Employees.Salary DESC;</font></pre>
<p>
If more than one record ties for the <i>n</i>th value, all of the tied values are displayed. If the fifth, sixth, and seventh highest salaries are the same, the previous query retrieves seven records, not five.</p>
<p>
Note that the selection of records is based on the <i>entire</i> output set, even if the query uses the GROUP BY clause to group like values. It’s not possible, for example, to retrieve the “top 5 records within each group,” or the “top 10 salesmen within each region.”</p>
<h5>TOP N PERCENT Predicate</h5>
<p>
TOP N PERCENT works much the same as the TOP N predicate, except the number of records returned isn’t fixed. A selected percentage of the records are retrieved:</p>
<pre><FONT FACE="Courier New" SIZE="3">SELECT TOP 10 PERCENT 
&#09;Products.UnitsInStock, 
&#09;Products.ProductID, 
&#09;Products.ProductName
FROM Products
ORDER BY Products.UnitsInStock DESC, Products.ProductName DESC;</font></pre>
<p>
This query retrieves the 10 percent of products that have the highest value for the UnitsInStock field.</p>
<p>
<b>Note   </b>If you’re working with a back-end server such as SQL&nbsp;Server, be cautious about using the TOP N PERCENT predicate. Because most servers don’t natively support this predicate, the output of this query must be evaluated on the local machine. It’s possible that a large number of records will need to be returned from the server in order for Microsoft Jet to determine which records to select, which could cause performance to decrease.</p>
</BODY>
</HTML>
