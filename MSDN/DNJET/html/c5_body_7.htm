<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Moving Through a Recordset</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h2><a name="jb2moving_through_a_recordset"></a>Moving Through a Recordset</h2>
<p>
A <b>Recordset</b> object has a <i>current position</i>, usually at a record. When you refer to the fields in a <b>Recordset</b> object, you obtain values from the record at the current position, which is known as the <i>current record</i>. However, the current position can also be immediately before the first record in a <b>Recordset</b> object or immediately after the last record. In certain circumstances, the current position is undefined. When you open a <b>Recordset</b> object that contains at least one record, the first record is the current record and the <b>Recordset</b> object’s <b>BOF</b> property is <b>False</b>. If the <b>Recordset</b> object contains no records, the <b>Recordset</b> object’s <b>BOF</b> and <b>EOF</b> properties will both be <b>True</b>. For more information about the <b>BOF</b> and <b>EOF</b> properties, see the section “Detecting the Limits of a Recordset.”</p>
<p>
You can use the Move methods to loop through the records in a <b>Recordset</b> object:
<ul>
<li>
The <b>MoveFirst</b> method moves to the first record.<br><br></li>
<li>
The <b>MoveLast</b> method moves to the last record.<br><br></li>
<li>
The <b>MoveNext</b> method moves to the next record.<br><br></li>
<li>
The <b>MovePrevious</b> method moves to the previous record.<br><br></li>
<li>
The <b>Move</b> <i>rows</i>, <i>start</i> method moves forward or backward the number of records specified by the <i>rows</i> argument, beginning with the record specified by the <i>start</i> argument. The <i>start</i> argument is optional, and if left blank, the <b>Move</b> operation begins at the current record.</li>
</ul>
<p>
The following example changes the job title of all sales representatives in a table called Employees. After opening the table, the code sets the index, which makes it necessary to use the <b>MoveFirst</b> method to locate the first record. For each record satisfying the title condition, the example changes the title and saves the change with the <b>Update</b> method. It uses the <b>MoveNext</b> method to move to the next record. In this example, <code>strDbPath</code> is the path to the NorthwindTables database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database, rst As Recordset

Set dbs = OpenDatabase(strDbPath)
Set rst = dbs.OpenRecordset(&quot;Employees&quot;, dbOpenTable)

With rst
&#09;' Set current index.
&#09;.Index = &quot;LastName&quot;
&#09;' Locate first record.
&#09;.MoveFirst
&#09;' Begin loop.
&#09;Do Until .EOF
&#09;&#09;If !Title = &quot;Sales Representative&quot; Then
&#09;&#09;&#09;' Enable editing.
&#09;&#09;&#09;.Edit
&#09;&#09;&#09;' Change title.
&#09;&#09;&#09;!Title = &quot;Account Executive&quot;
&#09;&#09;&#09;' Save changes.
&#09;&#09;&#09;.Update
&#09;&#09;End If
&#09;' Locate next record.
&#09;.MoveNext
&#09;' End of loop.
&#09;Loop
&#09;' Close recordset.
&#09;.Close
End With</font></pre>
<p>
<b>Visual Basic Users   </b>You can use the <b>Data</b> control to browse and display records in a <b>Recordset</b> object and to edit data in records as they are displayed. For more information on the <b>Data</b> control, see the <i>Microsoft Visual Basic Programmer’s Guide</i>.</p>
</BODY>
</HTML>
