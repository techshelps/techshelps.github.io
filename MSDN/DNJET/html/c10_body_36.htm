<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Evaluating Users and Groups</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2evaluating_users_and_groups"></a>Evaluating Users and Groups</h4>
<p>
The following code shows all the groups a given user belongs to:</p>
<pre><FONT FACE="Courier New" SIZE="3">Sub ShowUserGroups(strWorkgroup As String, strUser As String)
&#09;Dim usr As User
&#09;Dim grp As Group

&#09;' Specify a workgroup information file.
&#09;DBEngine.SystemDB = strWorkgroup

&#09;' Return a reference to the specified user.
&#09;Set usr = DBEngine.Workspaces(0).Users(strUser)

&#09;' Enumerate the Groups collection of the User object.
&#09;For Each grp In usr.Groups
&#09;&#09;Debug.Print grp.Name
&#09;Next grp
End Sub </font></pre>
<p>
The following code reverses this logic to show all the users in a given group:</p>
<pre><FONT FACE="Courier New" SIZE="3">Sub ShowGroupUsers(strWorkgroup As String, strGroup As String)
&#09;Dim usr As User
&#09;Dim grp As Group

&#09;' Specify a workgroup information file.
&#09;DBEngine.SystemDB = strWorkgroup

&#09;' Return a reference to the specified group.
&#09;Set grp = DBEngine.Workspaces(0).Groups(strGroup)

&#09;' Enumerate the Users collection of the Group object.
&#09;For Each usr In grp.Users
&#09;&#09;Debug.Print usr.Name
&#09;Next usr
End Sub </font></pre>
<p>
Or you can show all the users and all the groups they belong to with the following code:</p>
<pre><FONT FACE="Courier New" SIZE="3">Sub ShowUsersGroups(strWorkgroup As String)
&#09;Dim wrk As Workspace
&#09;Dim usr As User
&#09;Dim grp As Group

&#09;' Specify a workgroup information file.
&#09;DBEngine.SystemDB = strWorkgroup
&#09;' Return a reference to the default Workspace object.
&#09;Set wrk = DBEngine.Workspaces(0)

&#09;For Each usr In wrk.Users
&#09;&#09;Debug.Print &quot;User: &quot; &amp; usr.Name
&#09;&#09;For Each grp In usr.Groups
&#09;&#09;&#09;Debug.Print &quot;  Group: &quot; &amp; grp.Name
&#09;&#09;Next grp
&#09;Next usr
End Sub </font></pre>
<p>
And, as with other collections, you use the <b>Count</b> property to determine the number of members. To find the number of user accounts in the current workgroup information file, you use:</p>
<pre><FONT FACE="Courier New" SIZE="3">Debug.Print DBEngine.Workspaces(0).Users.Count</font></pre>
<p>
Similarly, to find the number of groups in the current workgroup information file, use:</p>
<pre><FONT FACE="Courier New" SIZE="3">Debug.Print DBEngine.Workspaces(0).Groups.Count</font></pre>
<p>
To determine the number of groups a specific user belongs to, use the <b>Count</b> property of that user’s <b>User</b> object’s <b>Groups</b> collection:</p>
<pre><FONT FACE="Courier New" SIZE="3">Debug.Print DBEngine.Workspaces(0).Users!Hannah.Groups.Count</font></pre>
</BODY>
</HTML>
