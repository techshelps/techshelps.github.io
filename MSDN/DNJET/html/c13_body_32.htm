<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Prevent Unnecessary Query Recompilation</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2prevent_unnecessary_query_recompilation"></a>Prevent Unnecessary Query Recompilation</h4>
<p>
An area that can cause performance degradation is the constant recompiling of stored queries. This can occur when DAO objects are not explicitly closed. The reason for this is that stored queries reference a particular memory address in order to use the Visual Basic for Applications expression service. If a DAO object is opened, and then a stored query is executed, re-executing that query may cause Microsoft Jet to recompile the query because the original memory address space is occupied. In certain circumstances, this also causes the database to increase in size. Many of these issues were resolved by enhancements to Microsoft Jet&nbsp;3.5, but some of the issues can be resolved only by using the <b>Close</b> method to explicitly close DAO objects when they are no longer being used. You should not rely on Visual Basic for Applications to implicitly close objects in your code when a <b>Sub</b> or <b>Function</b> procedure is exited.</p>
<p>
If you cannot explicitly close a DAO object because it is nested in an explicit transaction or some other scenario, another possible workaround is to use the <b>dbOpenSnapShot</b> or the <b>dbForwardOnly</b> constant for the <i>type</i> argument of the <b>OpenRecordset</b> method when you open a recordset. Using the <b>dbOpenSnapShot</b> or the <b>dbForwardOnly</b> constant prevents Microsoft Jet from recompiling the query. This is most useful when using the data grid that comes with Microsoft Visual Basic&nbsp;5.0, because you can’t explicitly close the DAO objects being used.</p>
</BODY>
</HTML>
