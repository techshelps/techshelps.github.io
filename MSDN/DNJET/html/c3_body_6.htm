<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Communicating with Microsoft Jet by Using SQL DDL</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2communicating_with_microsoft_jet_by_using_sql_ddl"></a>Communicating with Microsoft Jet by Using SQL DDL</h4>
<p>
You can pass SQL DDL statements to Microsoft Jet in three ways.</p>
<p>
In Microsoft Access, you can use the RunSQL action or the <b>RunSQL</b> method of the <b>DoCmd</b> object to execute an SQL statement that acts on the current database. For example, the CREATE TABLE statement from the previous example can be executed in Microsoft Access by using the <b>RunSQL</b> method as follows:</p>
<pre><FONT FACE="Courier New" SIZE="3">DoCmd.RunSQL &quot;CREATE TABLE MyTable (MyField TEXT);&quot;</font></pre>
<p>
The <b>DoCmd</b> object and its methods are not available in other Microsoft Jet host languages such as Visual&nbsp;C++ and Visual&nbsp;J++, or when you are using Visual Basic for Applications in Visual Basic 5.0, Microsoft Excel&nbsp;97, PowerPoint&nbsp;97, or Word&nbsp;97. In all of these languages and in Microsoft Access&nbsp;97, you can execute SQL statements by using the <b>Execute</b> method on a <b>Database</b> object declared in code. In the following example, <code>strDbPath</code> is the path to the database, <code>strTableName</code> is the name of the new table, <code>strFieldName</code> is the name of the new field, and <code>strFieldType</code> is the type of field to create.</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database
Dim strSQL As String

Set dbs = OpenDatabase(strDbPath)
strSQL = &quot;CREATE TABLE &quot; &amp; strTableName &amp; &quot; (&quot; &amp; strFieldName _
&#09;&amp; &quot; &quot; &amp; strFieldType &amp; &quot;);&quot;

' Execute SQL command.
dbs.Execute strSQL</font></pre>
<p>
<b>Note   </b>To use any DAO method, such as the <b>Execute</b> method, when you are using Visual Basic for Applications in Microsoft Excel, PowerPoint, or Word, you must first install the Data Access Objects for Visual Basic component by rerunning Setup. Then you can use the <b>References</b> command (<b>Tools</b> menu) in the Visual Basic Editor to set a reference to the Microsoft DAO 3.5 object library.</p>
<p>
Another way to execute an SQL statement is to create a permanent DAO <b>QueryDef</b> object that contains the SQL statement, and then use the <b>Execute</b> method to run the <b>QueryDef</b> object in code. The following example creates a <b>QueryDef</b> object that includes a CREATE TABLE statement and then executes that <b>QueryDef </b>object. In this example, <code>strDbPath</code> is the path to the database and <code>strQueryName</code> is the name of the new <b>QueryDef</b> object:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database, qdf As QueryDef
Dim strSQL As String

Set dbs = OpenDatabase(strDbPath)
strSQL = &quot;CREATE TABLE MyTable (MyField TEXT);&quot;
Set qdf = dbs.CreateQueryDef(strQueryName)

' Execute query.
qdf.Execute</font></pre>
<p>
<b>Note   </b>Another method of creating a table by using SQL is to use a make-table query. For a complete discussion of using make-table and other queries, see Chapter&nbsp;4, “<a href="c4_body.htm">Queries</a>.”</p>
<p>
<b>See Also   </b>For information about creating <b>QueryDef</b> objects, see the “Microsoft Jet QueryDef Objects” section later in this chapter.</p>
<p>
For the remainder of this chapter, SQL DDL examples are given with the text of the SQL statement only. Remember, however, that to communicate your SQL statements to Microsoft Jet, you must execute the DDL statement by using one of the previously described techniques.</p>
</BODY>
</HTML>
