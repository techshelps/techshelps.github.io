<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Getting a Table Structure</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2getting_a_table_structure"></a>Getting a Table Structure</h4>
<p>
The concepts demonstrated in the previous two examples are included in the following example, which prints the properties of a <b>TableDef</b> object, the names of its fields, and the properties of each <b>Field</b> object and their values. The first procedure iterates through the <b>Properties</b> collection for the <b>TableDef</b> object and each <b>Field</b> object, and then calls the GetProperty function for each <b>Property</b> object in each collection. The GetProperty function returns a string containing the property’s name and value. If reading the property’s <b>Value</b> property returns an error, then the error message is included in the string:</p>
<pre><FONT FACE="Courier New" SIZE="3">Sub GetTableInfo(strDbName As String, strTableName As String)
&#09;Dim dbs As Database
&#09;Dim tdf As TableDef, fld As Field, prp As Property

&#09;' Open database.
&#09;Set dbs = OpenDatabase(strDbName)
&#09;Set tdf = dbs.TableDefs(strTableName)
&#09;With tdf
&#09;&#09;' Print table properties.
&#09;&#09;Debug.Print &quot;Properties for table '&quot; &amp; strTableName &amp; &quot;':&quot;
&#09;&#09;For Each prp In tdf.Properties
&#09;&#09;&#09;Debug.Print GetProperty(prp)
&#09;&#09;Next prp
&#09;&#09;Debug.Print
&#09;&#09;
&#09;&#09;' Print fields and field properties.
&#09;&#09;Debug.Print &quot;Fields and field properties for table '&quot; &amp; _
&#09;&#09;&#09;strTableName &amp; &quot;':&quot;
&#09;&#09;For Each fld In .Fields
&#09;&#09;&#09;Debug.Print &quot;Field: &quot; &amp; fld.Name
&#09;&#09;&#09;For Each prp In fld.Properties
&#09;&#09;&#09;&#09;Debug.Print &quot;    &quot; &amp; GetProperty(prp)
&#09;&#09;&#09;Next prp
&#09;&#09;&#09;Debug.Print
&#09;&#09;Next fld
&#09;End With
End Sub

Function GetProperty(prp As Property) As String
&#09;' This procedure checks whether a property has a value.
&#09;' It returns either the value or an appropriate
&#09;' error string.
&#09;Dim varValue As Variant
&#09;   
&#09;' Disable error handling.
&#09;On Error Resume Next
&#09;' Attempt to retrieve the property value.
&#09;varValue = prp.Value
&#09;' Check for an error.
&#09;If Err Then
&#09;&#09;varValue = &quot;&lt;Error: &quot; &amp; Err.Description &amp; &quot;&gt;&quot;
&#09;End If
&#09;' Re-enable error handling.
&#09;On Error GoTo 0
&#09;' Return string.
&#09;GetProperty = &quot;Property: &quot; &amp; prp.Name &amp; vbTab &amp; vbTab &amp; &quot;Value: &quot; &amp; varValue
End Function</font></pre>
</BODY>
</HTML>
