<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Opening the Database in Shared Mode</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2opening_the_database_in_shared_mode"></a>Opening the Database in Shared Mode</h4>
<p>
If you want to implement recordset locking, you must open your database in shared mode. This is the typical mode for opening databases in multiuser environments. When a database is opened in shared mode, multiple users can simultaneously access the database and Microsoft Jet handles conflicts between users.</p>
<p>
<b><font face="Symbol"><span style="font-family:symbol">&#219;</span></font>&#09;To open a database in shared mode</b>
<ol>
<li>
Declare a database variable using the <b>Dim</b> statement.<br><br></li>
<li>
Use the <b>OpenDatabase</b> method to open the database, specifying a value of <b>False</b> for the <i>options</i> argument.</li>
</ol>
<p>
The following code checks to see whether a database is open exclusively, using the IsDbOpenedExclusively function defined in Chapter&nbsp;2, “Introducing Data Access Objects.” If this function returns false, then the following code opens the database in shared mode. In this example, <code>strDbPath</code> is the path to the database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Function OpenDatabaseShared(strDbPath As String) As Database
&#09;Dim dbs As Database
  
&#09;' Check whether database is open exclusively.
&#09;If IsDbOpenedExclusively(strDbPath) Then
&#09;&#09;MsgBox &quot;Cannot open database in shared mode. &quot; &amp; _
&#09;&#09;&#09;&quot;You or another user may have it open exclusively.&quot;
&#09;&#09;' Return Nothing.
&#09;&#09;Set OpenDatabaseShared = Nothing
&#09;Else
&#09;&#09;' Open database and return reference.
&#09;&#09;Set dbs = OpenDatabase(strDbPath, False)
&#09;&#09;Set OpenDatabaseShared = dbs
&#09;End If
End Function</font></pre>
</BODY>
</HTML>
