<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Putting It All Together: Building a Connection String</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2putting_it_all_together__building_a_connection_string"></a>Putting It All Together: Building a Connection String</h4>
<p>
Before you create a connection string, you need to know the data source you will connect to and the DAO object you will use with the data source. An external data source will be either an ODBC database or an ISAM (desktop) database.</p>
<p>
The recommended way to connect to an ODBC database is through an ODBCDirect workspace object. For more information about ODBCDirect, see Chapter&nbsp;9 “<a href="c9_body.htm">Developing Client/Server Applications</a>.” However, there may be situations where you will connect to an ODBC data source through a Microsoft Jet workspace; for example, to take advantage of specific Microsoft Jet features such as heterogeneous joins or indexed searches. If you are using a version of DAO earlier than 3.5, you must connect to an ODBC data source through a Microsoft Jet workspace.</p>
<p>
You can use the DAO <b>Connection</b>, <b>Database</b>, <b>QueryDef</b>, and <b>TableDef</b> objects to connect to an external data source. The following table shows which objects can connect to which database type and workspace type.</p>
<table>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b><BR>Object</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>ODBC data source<BR>(via ODBCDirect)</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>ODBC data source<BR>(via Microsoft Jet)</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b><BR>ISAM data source</b></font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Connection</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Yes</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
N/A</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
N/A</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Database</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Yes</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Yes</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Yes</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>QueryDef</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
No</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Yes</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
No</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>TableDef</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
No</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Yes</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Yes</font></td>
</tr>
</table><br>
<p>
A complete connection string includes all information necessary to connect to and open an external data source on a local drive, network, or ODBC-compliant database server. Connection strings consist of a database type followed by a database name or a DSN (ODBC data sources only). If the external data source requires additional information, such as a password, you can include this in the connection string as well. You can set a connection string by using the <b>OpenDatabase</b> method, the <b>CreateTableDef</b> method, or the <b>Connect</b> property.</p>
<p>
For ODBCDirect workspaces, you can also set the connection string by using the <b>OpenConnection</b> method. An ODBC connection string uses the same syntax, regardless of which object you connect it to and regardless of whether you connect through an ODBCDirect or Microsoft Jet workspace.</p>
<p>
Connecting to an ISAM database can only be done through a Microsoft Jet workspace. The IISAM drivers expose the database to Microsoft Jet as a Microsoft Jet database supporting all the functionality of a native Microsoft Jet database. Any IISAM driver (except Microsoft Exchange or an external Microsoft Jet database) can use FTP or HTTP protocols to connect to a file on an intranet or the Internet.</p>
<p>
All IISAM drivers accept a connection string that uses the same basic syntax:</p>
<p>
<code>&quot;</code><i>identifier</i><b>;</b> <i>source</i><b>;</b> <i>options</i><code>&quot;</code></p>
<p>
The <i>identifier</i> argument is a keyword that specifies the type of file being opened. The “Specifying Source Database Types” section earlier in this chapter contains a table with the identifier for each ISAM database listed as “Source Database Types.” No <i>identifier</i> argument is used when you are connecting to an external Microsoft Jet database.</p>
<p>
The <i>source</i> argument contains a drive letter or transfer protocol (such as HTTP), a fully qualified path, and (if needed) a file name that is the file (or the directory containing the file) you want to open. The <i>source</i> argument (except for Microsoft Jet databases) always begins with <b>DATABASE=</b>, for example:</p>
<pre><FONT FACE="Courier New" SIZE="3">strConnect = &quot;FoxPro&nbsp;3.0;DATABASE=C:\JetBook\Samples\FoxTables&quot;</font></pre>
<p>
The <i>options</i> argument is used to specify additional, optional arguments to the IISAM driver. For example, you can specify a password or indicate whether the first record in a spreadsheet file contains column header information. Multiple arguments are separated by semicolons.</p>
<p>
The connection string is slightly different when you are opening or creating an external Microsoft Jet database file. There are two IISAM drivers for Microsoft Jet databases: one for databases created by using Microsoft Jet&nbsp;2.5 or earlier and another for databases created by using Microsoft Jet&nbsp;3.0 or later. When you are creating a connection string for an external Microsoft Jet database, the <i>identifier</i> argument is left blank (but the semicolon is included). The <i>source</i> argument is the drive, path, and file name to the .mdb file. The <i>options</i> argument may contain, where needed, the password associated with a password-protected .mdb file. For example, the following code fragment creates a connection string for an external Microsoft Jet database. You could use this code to link the Employees table in the NorthwindTables database to the JetSamples database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database, tdf As TableDef

' Create new TableDef object in a Microsoft Jet database.
Set tdf = dbs.CreateTableDef(&quot;LinkedEmployees&quot;)
' Link table from another Microsoft Jet database.
With tdf
&#09;.Connect = &quot;;DATABASE=C:\JetBook\Samples\NorthwindTables.mdb&quot;
&#09;.SourceTableName = &quot;Employees&quot;
End With
dbs.TableDefs.Append tdf</font></pre>
<p>
The following code fragment sets the connection string by using the <b>OpenDatabase</b> method:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database

Set dbs = OpenDatabase(&quot;C:\JetBook\Samples\FoxTables\Sales&quot;, _
&#09;False, False, &quot;FoxPro&nbsp;3.0&quot;)</font></pre>
<p>
Note that the connection information appears in a slightly different format when it is specified in the arguments to the <b>OpenDatabase</b> method. The <i>identifier</i> and <i>options</i> arguments are passed in the <i>connect</i> argument (the fourth argument in the example above), while the <i>source</i> argument is supplied in the first argument without prepending the <b>DATABASE=</b> information.</p>
<p>
The following code fragment sets the connection string with the <b>CreateTableDef</b> method; connection information is supplied as arguments in the method. In this example, <code>strDbPath</code> is the path to the Microsoft Jet database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database, tdf As TableDef

Set dbs = OpenDatabase(strDbPath)
Set tdf = dbs.CreateTableDef(&quot;Q1Orders1996&quot;, 0, &quot;Q1Ord96&quot;, _
&#09;&quot;FoxPro&nbsp;3.0;DATABASE=C:\JetBook\Samples\FoxTables\Sales;&quot;)
dbs.TableDefs.Append tdf</font></pre>
<p>
The following code fragment sets the connection string by using the <b>Connect</b> property, <b>CreateTableDef</b> method, and <b>SourceTableName</b> property:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database, tdf As TableDef

Set dbs = OpenDatabase(strDbPath)
Set tdf = dbs.CreateTableDef(&quot;EmployeeSalesTotals&quot;)
With tdf
&#09;.Connect = &quot;Paradox 3.X;DATABASE=C:\JetBook\Samples\pdx&quot;
&#09;.SourceTableName = &quot;PDXSales&quot;
End With
dbs.TableDefs.Append tdf</font></pre>
<p>
The following code fragment sets the connection string by using the <b>OpenConnection</b> method of an ODBCDirect workspace object:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim wrk As Workspace, cnn As Connection

' Create an ODBCDirect workspace.
Set wrk = CreateWorkspace(&quot;NewWS&quot;, &quot;admin&quot;, &quot;&quot;, dbUseODBC)
' Open a connection on the workspace.
Set cnn = wrk.OpenConnection(&quot;NorthwindConnection&quot;, , , _
&#09;&quot;ODBC;DSN=NorthwindSQLDSN;DATABASE=NorthwindSQL;UID=sa;PWD=;&quot;)</font></pre>
</BODY>
</HTML>
