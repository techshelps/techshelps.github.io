<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Working with FoxPro Databases</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2working_with_foxpro_databases"></a>Working with FoxPro Databases</h4>
<p>
The Microsoft FoxPro product line includes the following versions supported by the Microsoft Jet Xbase IISAM driver: FoxPro&nbsp;2.0, FoxPro&nbsp;2.5, FoxPro&nbsp;2.6, FoxPro&nbsp;3.0, and FoxPro DBC. FoxPro databases differ from Microsoft Jet databases in four major areas: data types, handling of deleted records, specification of indexes, and storage of Long Text (Memo) fields. The following sections describe these differences.</p>
<h5>Converting FoxPro Data Types to Microsoft Jet Data Types</h5>
<p>
Microsoft Jet translates each FoxPro data type into the corresponding Microsoft Jet data type when your application reads the data. The following table shows the one-to-one correspondence between data types.</p>
<table>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>FoxPro data type</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Microsoft Jet data type</b></font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Character</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Text</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Numeric, Float</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Double</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Logical</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Boolean</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Date</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Date/Time</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Memo</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Memo</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
General</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Long Binary (OLE Object)</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Double*</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Double</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Currency*</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Currency</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Integer*</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Long</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
DateTime*</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Date/Time</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
*&#09;Supported in Microsoft FoxPro&nbsp;3.0 and Microsoft FoxPro DBC only</font></td>
</tr>
</table><br>
<h5>Handling Deleted Records</h5>
<p>
When you delete a record from a FoxPro table through your application, the record is marked as deleted in the table. The record is not, however, removed from the table because FoxPro allows users to recover deleted records until the table is packed. Because you cannot pack a FoxPro table through the Microsoft Jet database engine, deleted records will continue to appear in your application’s data set.</p>
<p>
To force Microsoft Jet to filter out deleted records in a FoxPro table, you must set a value in the registry. You can do this by setting the Deleted setting under the \HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\3.5\Engines\Xbase key to&nbsp;01 (<b>True</b>) and restarting the Microsoft Jet database engine to hide deleted records from your application.</p>
<h5>Handling FoxPro Indexes</h5>
<p>
You can speed up Microsoft Jet access to FoxPro tables by specifying which FoxPro .idx or .cdx index files to use. Index files are specified in an .inf file, which you can create by linking your FoxPro table through the Microsoft Access user interface or by creating a text file with the same file name as your FoxPro database and appending an .inf extension. If there is no .inf file but there is a .cdx index file in the same directory as the database file, the IISAM driver will automatically use that index file. The following procedure describes how to create an .inf file for the hypothetical FoxPro database Sales.dbf.
<ol>
<li>
Create the text file Sales.inf.<br><br></li>
<li>
On the first line, add the database type identifier enclosed in square brackets. For example, to specify FoxPro&nbsp;2.0 indexes, type the following:<pre><FONT FACE="Courier New" SIZE="3">[FoxPro&nbsp;2.0]</font></pre>
</li>
<li>
Assign an index number to the first index for the database. Number the first index IDX1, the second IDX2, and so on. If you want to specify combined-index (.cdx) files for FoxPro databases, use index numbers of the form CDX1, CDX2, and so on. You can specify unique indexes by prepending a “U” to the index number.<br><br></li>
<li>
Follow the index number with an equal sign and the file name of the index you want to specify, including the extension. Do not put any spaces in this entry. For example, to specify the index Custname.idx as the first index and the unique index Custno.idx as the second index, add the following entries:<pre><FONT FACE="Courier New" SIZE="3">IDX1=CUSTNAME.IDX
UIDX1=CUSTNO.IDX</font></pre>
</li>
<li>
Repeat steps 3 and 4 until you have specified all indexes for the database table. Your completed .inf file should look similar to the following:<pre><FONT FACE="Courier New" SIZE="3">[FoxPro&nbsp;2.0]
IDX1=CUSTNAME.IDX
UIDX1=CUSTNO.IDX</font></pre>
</li>
<li>
Save the .inf file to the directory that contains your FoxPro database. Alternatively, you can create an INFPath setting in the registry to point to the path where the .inf file is stored. This is useful if you cannot store the .inf file in the same directory as the database or if you want to keep all .inf files in one shared location for easy maintenance.<p>
To create an INFPath setting in your registry, you must manually add the registry setting in the Registry Editor as a string value. To add the setting, open the \HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\3.5\Engines\Xbase key in the registry. On the <b>Edit</b> menu, point to <b>New</b>, and then click <b>String Value</b>. Type <b>INFPath</b> as the name and type the full directory or network path to the .inf file in the data field. Save the registry changes and restart Microsoft Jet to use this setting.</p>
</li>
</ol>
<p>
Keep in mind that Microsoft Jet will need to periodically update your index files as you change data from within your FoxPro database. If you associate index files with a FoxPro database that is linked or opened from a Microsoft Jet database, you must make sure the indexes are available to your Microsoft Jet database as well.</p>
<p>
<b>Important   </b>Don’t delete or move the index files or the .inf file without updating associated references (such as the registry). If Microsoft Jet doesn’t have access to up-to-date index information, it cannot correctly process queries.</p>
<h5>Handling Memo Fields</h5>
<p>
Memo fields for FoxPro databases are stored in the file system rather than in the database. If you want to link or open a FoxPro database that has Memo fields, make sure the Memo field files are stored in the same directory as the database files.</p>
</BODY>
</HTML>
