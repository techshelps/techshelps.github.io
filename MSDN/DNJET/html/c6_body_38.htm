<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Refreshing DAO Collections</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h3><a name="jb2refreshing_dao_collections"></a>Refreshing DAO Collections</h3>
<p>
In a single-user system, Data Access Objects (DAO) always keep track of changes to collections. As you add objects to collections and delete objects from collections, Microsoft Jet knows about these changes. However, in a multiuser setting, other users may be modifying collections by adding new tables or queries to the database, or deleting existing objects. In this case, DAO doesn’t automatically keep track of changes to collections.</p>
<p>
As an example, consider the following code, which displays all the <b>TableDef</b> objects in the current database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Sub ShowAllTables(dbs As Database)
&#09;Dim tdf As TableDef
&#09;
&#09;For Each tdf In dbs.TableDefs
&#09;&#09;Debug.Print tdf.Name
&#09;Next tdf
End Sub</font></pre>
<p>
When this code runs, it takes a snapshot of the <b>TableDefs</b> collection as it exists at that time. It iterates through each <b>TableDef</b> object and displays its name. Assume you have to run this code twice. The first time you run it, ten table names are displayed. But before you can run it again, another user on the network who also has the database open adds a new table. Now you run the code again. It still displays ten table names. This is because DAO doesn’t automatically know about changes made to the collections by other users. To solve this problem, use the <b>Refresh</b> method. The <b>Refresh</b> method forces Microsoft Jet to re-inventory the database and update the collections with the most recent changes.</p>
<p>
<b>See Also   </b>For more information about DAO, see Chapter&nbsp;2, “<a href="c2_body.htm">Introducing Data Access Objects</a>.”</p>
<p>
To change the previous code to always display the most current list of <b>TableDef</b> objects, add a <b>Refresh</b> method, as follows:</p>
<pre><FONT FACE="Courier New" SIZE="3">Sub BetterShowAllTables(dbs As Database)
&#09;Dim tdf As TableDef
&#09; 
&#09;dbs.TableDefs.Refresh
&#09;For Each tdf In dbs.TableDefs
&#09;&#09;Debug.Print tdf.Name
&#09;Next tdf
End Sub</font></pre>
</BODY>
</HTML>
