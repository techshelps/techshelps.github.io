<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Summing and Analyzing</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2summing_and_analyzing"></a>Summing and Analyzing</h4>
<p>
Microsoft Jet supports the standard SQL aggregate functions <b>Count</b>, <b>Sum</b>, <b>Avg</b>, <b>Max</b>, and <b>Min</b> to perform table-level or group-level totaling:</p>
<pre><FONT FACE="Courier New" SIZE="3">SELECT 
&#09;Count(Products.UnitPrice) AS CountOfUnitPrice, 
&#09;Sum(Products.UnitPrice) AS SumOfUnitPrice, 
&#09;Avg(Products.UnitPrice) AS AvgOfUnitPrice, 
&#09;Min(Products.UnitPrice) AS MinOfUnitPrice, 
&#09;Max(Products.UnitPrice) AS MaxOfUnitPrice
FROM Products;</font></pre>
<p>
The previous query retrieves a single record that collects statistics on all products in the table. It can be combined with a WHERE clause:</p>
<pre><FONT FACE="Courier New" SIZE="3">SELECT 
&#09;Count(Products.UnitPrice) AS CountOfUnitPrice, 
&#09;Avg(Products.UnitPrice) AS AvgOfUnitPrice
FROM Products
WHERE Products.SupplierID = 6;</font></pre>
<p>
If no records match the selection criteria, the output is still produced. The value of any <b>Count</b> aggregate fields is zero; the value of the other aggregate types is <b>Null</b>.</p>
<p>
You use the SQL function <b>Count(</b><i>fieldname</i><b>)</b> to tally occurrences of non-<b>Null</b> values in a specified field. A special form of <b>Count</b> is <b>Count(*)</b>, which counts the number of records. As discussed in the section “Common Pitfalls” later in this chapter, <b>Count(*)</b> should be used whenever possible, because this expression can sometimes be executed more quickly by using the Rushmore query-optimization technology.</p>
<p>
<b>See Also   </b>For information about how to optimize queries used with Open Database Connectivity (ODBC) data sources, see Chapter&nbsp;8, “<a href="c8_body.htm">Accessing External Data</a>,” and Chapter&nbsp;9, “<a href="c9_body.htm">Developing Client/Server Applications</a>.”</p>
<p>
The argument to these aggregate functions can be an expression as well as a field name, as in the following example:</p>
<pre><FONT FACE="Courier New" SIZE="3">SELECT Max(UnitPrice*Quantity) AS MaxExtPrice
FROM [Order Details];</font></pre>
<p>
In addition to these standard aggregate functions, Microsoft Jet supports the SQL aggregate functions <b>First</b> and <b>Last</b>, which retrieve the first and last values of the set of records, and the <b>StDev</b>, <b>StDevP</b>, <b>Var</b>, and <b>VarP</b> statistical and financial functions. Note that because the <b>StDev</b>, <b>StDevP</b>, <b>Var</b>, and <b>VarP</b> functions are Microsoft Jet-specific, they aren’t likely to be supported on any other client/server DBMS, and so will have to be evaluated locally.</p>
</BODY>
</HTML>
