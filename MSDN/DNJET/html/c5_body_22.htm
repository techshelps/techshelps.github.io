<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Adding a New Record</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h3><a name="jb2adding_a_new_record"></a>Adding a New Record</h3>
<p>
Adding a new record to a dynaset- or table-type <b>Recordset </b>object is a three-step process:
<ol>
<li>
Use the <b>AddNew</b> method to prepare a new record for editing.<br><br></li>
<li>
Assign values to each of the record’s fields.<br><br></li>
<li>
Use the <b>Update</b> method to save the new record.</li>
</ol>
<p>
The following example adds a new record to a table called Shippers. In this example, <code>strDbPath</code> is the path to the NorthwindTables database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database, rst As Recordset

Set dbs = OpenDatabase(strDbPath)
Set rst = dbs.OpenRecordset(&quot;Shippers&quot;)
With rst
&#09;' Add new record.
&#09;.AddNew
&#09;' Supply values for fields.
&#09;!CompanyName = &quot;Global Parcel Service&quot;
&#09;!Phone = &quot;(503)555-9786&quot;
&#09;' Update.
&#09;.Update
&#09;.Close
End With</font></pre>
<p>
When you use the <b>AddNew</b> method, Microsoft Jet prepares a new, blank record and makes it the current record. When you use the <b>Update</b> method to save the new record, the record that was current before you used the <b>AddNew</b> method becomes the current record again. The new record’s position in the <b>Recordset </b>object depends on whether you added the record to a dynaset- or a table-type <b>Recordset </b>object.</p>
<p>
If you add a record to a dynaset-type<b> Recordset </b>object, the new record appears at the end of the <b>Recordset </b>object, no matter how the <b>Recordset </b>object is sorted. To force the new record to appear in its properly sorted position, you can use the <b>Requery</b> method or re-create the <b>Recordset</b> object.</p>
<p>
If you add a record to a table-type<b> Recordset </b>object, the record appears positioned according to the current index, or at the end of the table if there is no primary key and no current index. Because Microsoft Jet version 3.5 allows multiple users to create new records on a table simultaneously, your record may not appear at the end of the <b>Recordset </b>object as it did in previous versions of Microsoft Jet. Be sure to use the <b>LastModified</b> property rather than the <b>MoveLast</b> method to move to the record you just added.</p>
<p>
<b>Important   </b>If you use the <b>AddNew</b> method to add a new record, and then move to another record or close the <b>Recordset</b> object without first using the <b>Update</b> method, your changes will be lost without warning. For example, omitting the <b>Update</b> method from the preceding example results in no changes being made to the Shippers table.</p>
<h5>Caching ODBC Data with a Recordset</h5>
<p>
You can use a dynaset-type <b>Recordset</b> object to create a local cache for ODBC data. Creating a local cache lets you retrieve records in batches instead of one at a time as each record is requested, and makes much better use of your server connection, improving performance.</p>
<p>
The <b>CacheSize</b> and <b>CacheStart</b> properties establish the size and starting offset (expressed as a <b>Bookmark</b> property value) for the cache. For example, you may set the <b>CacheSize</b> property to 100 records. Then, by using the <b>FillCache</b> method, you can retrieve sufficient records to fill the cache.</p>
<p>
<b>See Also   </b>For more information about caching ODBC data, see Chapter&nbsp;9, “<a href="c9_body.htm">Developing Client/Server Applications</a>.”</p>
</BODY>
</HTML>
