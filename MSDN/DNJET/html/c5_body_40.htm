<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Write Permission</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2write_permission"></a>Write Permission</h4>
<p>
Even if a <b>Recordset </b>object is a dynaset or table type object, which are normally updatable, the tables underlying a <b>Recordset </b>object may not permit you to modify data. Check the <b>Updatable</b> property of the <b>Recordset </b>object to determine whether its data can be changed. If the property is <b>True</b>, the <b>Recordset </b>object can be updated.</p>
<p>
Individual fields within an updatable <b>Recordset</b> object may not be updatable, so attempting to write to these fields can generate a run-time error. To determine whether a given field is updatable, check the <b>DataUpdatable</b> property of the corresponding <b>Field </b>object in the <b>Fields</b> collection of the <b>Recordset</b> object.</p>
<p>
In the following example, a <b>Recordset</b> object variable is passed to a function that first determines whether the <b>Recordset</b> object is updatable. If it is, the function counts how many <b>Field</b> objects are updatable and returns the total. It also prints the <b>Name</b> property of each <b>Field</b> object that is not updatable. If all the fields are updatable, the function returns &nbsp;–&nbsp;1. If the entire <b>Recordset</b> object is not updatable, the function returns 0. If some of the fields are updatable, the function returns the number of updatable fields.</p>
<pre><FONT FACE="Courier New" SIZE="3">Function UpdateTest(rst As Recordset) As Integer
&#09;Dim intCount As Integer, intX As Integer
&#09;Dim fld As Field

&#09;' Initialize counter variable.
&#09;intCount = 0
&#09;' Check whether recordset is updatable.
&#09;If rst.Updatable Then
&#09;&#09;' Check whether each field is updatable.
&#09;&#09;For Each fld In rst.Fields
&#09;&#09;&#09;If fld.DataUpdatable Then
&#09;&#09;&#09;&#09;' Increment counter for each updatable field.
&#09;&#09;&#09;&#09;intCount = intCount + 1
&#09;&#09;&#09;Else
&#09;&#09;&#09;&#09;' Print nonupdatable fields.
&#09;&#09;&#09;&#09;Debug.Print fld.Name
&#09;&#09;&#09;End If
&#09;&#09;Next fld
&#09;&#09;If intCount = rst.Fields.Count Then
&#09;&#09;&#09;' If all fields are updatable, return -1.
&#09;&#09;&#09;UpdateTest = -1
&#09;&#09;Else
&#09;&#09;&#09;' If some fields are updatable, return number.
&#09;&#09;&#09;UpdateTest = intCount
&#09;&#09;End If
&#09;Else
&#09;&#09;' If no fields are updatable, return 0.
&#09;&#09;UpdateTest = 0
&#09;End If
End Function</font></pre>
</BODY>
</HTML>
