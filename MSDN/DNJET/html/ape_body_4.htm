<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Visual Basic for Applications (VBA) Interface Components</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h2><a name="jb2visual_basic_for_applications__vba__interface_components"></a>Visual Basic for Applications (VBA) Interface Components</h2>
<p>
Although VBA is not a component of Microsoft Jet, it works as an <i>expression evaluator</i> to evaluate various functions that appear in SQL statements and to do arithmetic. The Microsoft Jet expression service takes an expression and builds a tree out of it. Elements of this tree are then passed to VBA for evaluation.</p>
<p>
Various VBA components are used to provide this functionality to Microsoft Jet. VBAJet32.dll is used to start VBA. When Microsoft Jet is running in a stand-alone environment (not being run by a host application such as Microsoft Access), the VBA run-time component, VBAR332.dll, is used. However, if a host application other than Visual Basic 5.0 (for example, Microsoft Access&nbsp;97) is running, then VBA332.dll is used. If Visual Basic 5.0 is running, then VBA5.dll is used. The following table describes the VBA interface components.</p>
<table>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Component</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Description</b></font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
VBAJet32.dll</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Initializes the VBA expression service for Microsoft Jet.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
VBAEn232.olb</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Contains international resources and localized strings for the VBA components.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
VBA332.dll</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
The full version of the VBA expression service.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
VBAR332.dll</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
The run-time version of the VBA expression service.</font></td>
</tr>
</table><br>
<h3>Notable VBA Interactions</h3>
<p>
Prior to version&nbsp;3.0, Microsoft Jet made calls to the Basic interpreter built into Microsoft Access and Visual Basic to get its expression evaluation functionality. In current versions, Microsoft Jet uses VBA.</p>
<p>
VBAJet32.dll checks to see whether there is a version of VBA already in memory. If there isn’t one, Microsoft Jet will load one of three potential DLLs (VBAR332.dll, VBA332.dll, VBA5.dll) to get its expression evaluation functionality, as described earlier in this section.</p>
<p>
It is also worthwhile to note the order in which you load engine hosts, such as Microsoft Access and Microsoft Excel. For example, if you first load the ODBC Desktop Database Drivers, Microsoft Jet uses the VBA run-time DLL (VBAR332.dll). If you subsequently load Microsoft Access, the instance of Microsoft Jet loaded by Microsoft Access uses the full VBA DLL (VBA332.dll). If, on the other hand, you load Microsoft Access first, and then the ODBC Desktop Database Drivers, both instances of Microsoft Jet use the VBA332.dll because the engine’s VBA initialization DLL sees that VBA332.dll is already in memory and uses it. If you want to reduce the memory footprint of Microsoft Jet, load Microsoft Access first, and then other applications or drivers that use the Jet database engine.</p>
</BODY>
</HTML>
