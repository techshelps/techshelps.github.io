<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Opening the Recordset</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2opening_the_recordset"></a>Opening the Recordset</h4>
<p>
After you open the database in shared mode, you can implement recordset locking by specifying various constants in the <i>options</i> argument of the <b>OpenRecordset</b> method. You can combine options to more completely describe the type of locking you want to use.</p>
<p>
<b><font face="Symbol"><span style="font-family:symbol">&#219;</span></font>&#09;To open a Recordset with locking enabled</b>
<ol>
<li>
Open the <b>Recordset</b> object’s database in shared mode.<br><br></li>
<li>
Determine the locking mode to use.<br><br></li>
<li>
Open the <b>Recordset</b> using the <b>OpenRecordset</b> method and set the <i>options</i> argument to the constant or combination of constants that specify the locking mode you want.<br><br></li>
<li>
Close the <b>Recordset</b> object when you’re finished performing operations on the data to release any recordset-level locks.</li>
</ol>
<p>
For example, the following code opens the Orders table exclusively by combining the <b>dbDenyWrite</b> and the <b>dbDenyRead</b> constants in the <i>options</i> argument.</p>
<pre><FONT FACE="Courier New" SIZE="3">Function OpenTableExclusive(strDbPath As String, _
&#09;&#09;strRstSource As String) As Recordset
&#09;Dim dbs As Database
&#09;Dim rst As Recordset
  
&#09;' Open the database in shared mode by calling the
&#09;' OpenDatabaseShared function defined in preceding section.
&#09;Set dbs = OpenDatabaseShared(strDbPath)
  
&#09;' Open table exclusively.
&#09;If Not dbs Is Nothing Then
&#09;&#09;Set rst = dbs.OpenRecordset(strRstSource, _
&#09;&#09;&#09;dbOpenTable, dbDenyRead + dbDenyWrite)
&#09;&#09;If Not rst Is Nothing Then
&#09;&#09;&#09;Set OpenTableExclusive = rst
&#09;&#09;Else
&#09;&#09;&#09;Set OpenTableExclusive = Nothing
&#09;&#09;End If
&#09;Else
&#09;&#09;Set OpenTableExclusive = Nothing
&#09;End If
End Function</font></pre>
<p>
<b>Note   </b>If you open a <b>Recordset</b> object without specifying any value for the <i>options</i> argument, Microsoft Jet uses page locking by default. The <b>Recordset</b> is opened in shared mode; it does not lock other users out of its data, and locks only the data being edited in the current page.</p>
<p>
<b>See Also   </b>For more information about opening a recordset, see “Creating a Recordset Variable” in Chapter&nbsp;5, “Working with Records and Fields” and search the DAO Help index for “OpenRecordset method.”</p>
</BODY>
</HTML>
