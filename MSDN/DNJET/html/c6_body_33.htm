<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating Record Sizes That Are Larger Than Half a Page</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2creating_record_sizes_that_are_larger_than_half_a_page"></a>Creating Record Sizes That Are Larger Than Half a Page</h4>
<p>
You can force Microsoft Jet to lock individual records by creating record sizes that are larger than half a page&nbsp;— that is, larger than 1,024&nbsp;bytes. This works because Microsoft Jet does not begin storing a new record on a partially filled page unless it can fit the entire record on the page. This strategy wastes a lot of disk space and increases network traffic. However, if you decide to use pessimistic locking and absolutely must have record locking, you may want to consider this technique. In order to use this technique, you need to be able to estimate the size of records.</p>
<p>
You can use the following table, which gives the size of fields with various data types, to calculate the size of your fields. Then add the sizes of all the fields in a record to estimate the size of the record.</p>
<table>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Microsoft Access data type</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Microsoft Jet data type</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Size</b></font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Number with <b>FieldSize</b> property set to&nbsp;byte</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Byte</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
1&nbsp;byte</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Number with <b>FieldSize</b> property set to Integer</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Integer</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
2&nbsp;bytes</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Number with <b>FieldSize</b> property set to Long Integer</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Long Integer</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
4&nbsp;bytes</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Number with <b>FieldSize</b> property set to Single</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Single</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
4&nbsp;bytes</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Number with <b>FieldSize</b> property set to Double</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Double</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
8&nbsp;bytes</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Currency</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Currency</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
8&nbsp;bytes</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
AutoNumber with <b>FieldSize</b> property set to Long Integer</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Long Integer</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
4&nbsp;bytes</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
AutoNumber with <b>FieldSize</b> property set to ReplicationID</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
GUID</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
16&nbsp;bytes</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Yes/No</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Boolean</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
1 bit</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Date/Time</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
DateTime</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
8&nbsp;bytes</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Text</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Text</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Variable</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Memo</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Long Text</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
14&nbsp;bytes</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
OLE Object</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Long Binary</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
14&nbsp;bytes</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Hyperlink</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Long Text</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
14&nbsp;bytes</font></td>
</tr>
</table><br>
<p>
When you estimate the size of records, you also need to account for overhead, which includes the following:
<ul>
<li>
Seven&nbsp;bytes per record for record overhead<br><br></li>
<li>
One&nbsp;byte variable-length field overhead for each Text, Memo, Hyperlink, and Long Binary (OLE Object) field<br><br></li>
<li>
One additional&nbsp;byte for every 256&nbsp;bytes of the total space occupied by all Text, Memo, Hyperlink, and Long Binary (OLE Object) fields<br><br></li>
<li>
One&nbsp;byte fixed-length field overhead for each Yes/No,&nbsp;byte, Integer, Long Integer, AutoNumber, Single, Double, Currency, and Date/Time field</li>
</ul>
<p>
<b>Note   </b>These numbers are for estimating the record size rather than calculating the exact size.</p>
<p>
The contents of the Memo, OLE Object, and Hyperlink fields are stored elsewhere in the .mdb file, so you need to count only the overhead for their address pointers, as described in the preceding list.</p>
<p>
Text fields present the greatest problem for estimating record size because they are variable-length fields. Microsoft Jet uses one&nbsp;byte per actual stored character up to the maximum length specified by the <b>FieldSize</b> property. Zero-length strings (&quot;&quot;) use 1&nbsp;byte; <b>Null</b> values use 0&nbsp;bytes.</p>
<p>
The recommended way to avoid the variable length of Text fields is to use the SQL data definition language (DDL) CHAR data type, which is a fixed-length data type. With this method, you don’t have to pad the field with data as you do with the methods described in the following paragraphs. The CHAR data type, however, is not available through the Microsoft Access user interface and can only be used with SQL DDL commands such as ALTER TABLE and CREATE TABLE.</p>
<p>
<b>See Also   </b>For more information about creating tables using SQL DDL statements, see Chapter&nbsp;3, “<a href="c1_body_7.htm">Data Definition and Integrity</a>.”</p>
<p>
A less ideal strategy is to add one or more dummy Text fields to the table with default values that are 255&nbsp;characters long until the record size exceeds 1,024&nbsp;bytes. For example, if you estimated the record size to be at least 130&nbsp;bytes, you would calculate the needed dummy fields as follows:
<ul>
<li>
Bytes you need to pad&nbsp;=&nbsp;(1,025&nbsp;–&nbsp;130)&nbsp;=&nbsp;895&nbsp;bytes.<br><br></li>
<li>
Each whole dummy text field&nbsp;=&nbsp;(255&nbsp;+&nbsp;2&nbsp;bytes overhead)&nbsp;=&nbsp;257&nbsp;bytes.<br><br></li>
<li>
You need three completely filled dummy fields (257&nbsp;*&nbsp;3&nbsp;=&nbsp;771) of 255&nbsp;<i>x</i>s plus one partially filled dummy field (895&nbsp;–&nbsp;771&nbsp;–&nbsp;1 overhead&nbsp;byte) of 123&nbsp;<i>x</i>s.</li>
</ul>
<p>
Do not place these dummy fields on your forms. Whenever a new record is created, Microsoft Access automatically creates a record with the four <i>x</i>-filled dummy fields, which forces it into record-locking mode.</p>
<p>
Using either of these techniques may cause performance degradations because the size of the database will increase due to the fact that every record will occupy 2K of disk space.</p>
<p>
Using the Microsoft Access <b>Format</b> property is not recommended to force padding when a record is being added because only Microsoft Access recognizes the <b>Format</b> property associated with the table. Other applications that use Microsoft Jet do not recognize the <b>Format</b> property and would not properly pad the record.</p>
</BODY>
</HTML>
