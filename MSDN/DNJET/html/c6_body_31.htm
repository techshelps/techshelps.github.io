<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Testing a Record for Locking Status</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h3><a name="jb2testing_a_record_for_locking_status"></a>Testing a Record for Locking Status</h3>
<p>
You may want to test a record to check if it’s locked without actually locking its page or pages. In Microsoft Jet 3.0 and 3.5, <b>Recordset</b> objects have an <b>EditMode</b> property. You can use this property in conjunction with the <b>LockEdits</b> property to determine if the current record is locked.</p>
<p>
The following procedure tests whether the current record in a given <b>Recordset</b> is on a locked page:</p>
<pre><FONT FACE="Courier New" SIZE="3">Function IsRecordLocked(rst As Recordset) As Boolean
&#09;IsRecordLocked = False
  
&#09;If rst.LockEdits Then
&#09;&#09;If rst.EditMode = dbEditInProgress Then
&#09;&#09;&#09;IsRecordLocked = True
&#09;&#09;End If
&#09;End If
End Function</font></pre>
<p>
If you’re using Microsoft Jet 2.0, the <b>EditMode</b> property is not available. In this situation, you can accomplish the same test by setting the <b>LockEdits</b> property of the <b>Recordset</b> to <b>True</b>, using the <b>Edit</b> method to attempt a lock, and then trapping error message 3260 (or other relevant error messages) if they occur.</p>
<p>
The following procedure tests whether the current record in a given <b>Recordset</b> is on a locked page without using the <b>EditMode</b> property:</p>
<pre><FONT FACE="Courier New" SIZE="3">Function IsRecordLocked2(rst As Recordset) As Boolean
&#09;IsRecordLocked2 = False
  
&#09;On Error GoTo Err_IsRecordLocked2
&#09;With rst
&#09;&#09;.LockEdits = True
&#09;&#09;' Attempt the lock.
&#09;&#09;.Edit
&#09;End With
&#09;' Return to the calling routine to edit the record.
Exit Function
  
Err_IsRecordLocked2:
&#09;IsRecordLocked2 = True
&#09;Exit Function
End Function</font></pre>
</BODY>
</HTML>
