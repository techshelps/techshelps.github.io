<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating .Mdb Files Programmatically</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h3><a name="jb2creating_.mdb_files_programmatically"></a>Creating .Mdb Files Programmatically</h3>
<p>
Use the <b>SQLConfigDataSource</b> function to add, modify, or delete a data source dynamically. If you call <b>SQLConfigDataSource</b> with a window handle, data source setup is performed interactively through the <b>Setup</b> dialog box. If you call the function with a NULL window handle, the data source is set up by using keywords that are contained in the <i>lpszAttributes</i> argument.</p>
<p>
<b>SQLConfigDataSource</b> takes as arguments the type of request (add, configure, or remove), the name of the driver, and a list of keyword-value pairs. The following keyword-value pairs are used to add, modify, or delete a file.</p>
<table>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Keyword</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Description</b></font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
DBQ</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
The name of the database file</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
DEFAULTDIR</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
The path to the database file for Microsoft Access, or the directory for the other drivers</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
DESCRIPTION</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
A description of the data in the data source</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
DRIVER</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
The path specification for the driver</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
DRIVERID</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
An integer ID for the driver (“25” for Microsoft Access)</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
FIL</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
The file type (Microsoft Access)</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
JETINIPATH</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
The path to the Microsoft Jet initialization file</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
PWD</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
A password</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
READONLY</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Indicates whether the file is read-only (TRUE) or not (FALSE)</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
SYSTEMDB</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
The path to the system database file</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
UID</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
The user ID name used for logging on</font></td>
</tr>
</table><br>
<p>
<b>See Also   </b>For a complete specification of the keywords, see the Microsoft ODBC Desktop Database Drivers Help file (ODBCJET.HLP).</p>
<p>
To perform the following operations on a Microsoft Access database file, or to set the following settings, include the appropriate keyword in the call to <b>SQLConfigDataSource</b>.</p>
<table>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Keyword</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Description</b></font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
COMPACT_DB</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Compacts data. See the “<u>Database Compaction</u> ” section later in this chapter.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
CREATE_DB</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Creates a Microsoft Access database file. (If the path contains a space, the entire path must be enclosed in double quotation marks.)</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
CREATE_SYSDB</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Creates a system database. This keyword takes the database name and the desired sort order as arguments.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
CREATE_V2DB</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Creates a database that is compatible with Microsoft Access 2.0. This keyword takes the database name and the desired sort order as arguments.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
EXCLUSIVE</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Opens the database so that it can be accessed by only one user at a time (EXCLUSIVE=TRUE), or by more than one user at a time (EXCLUSIVE=FALSE).</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
IMPLICITCOMMIT<BR>SYNC</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Indicates whether implicit commits are performed asynchronously. A value of YES (the default) means that the driver will wait for commits in an implicit transaction to be completed.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
MAXBUFFERSIZE</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Indicates the size of the internal buffer, in kilobytes, that is used to transfer data to and from the disk. Any integer value divisible by 256 can be used. The default is 512 KB.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
MAXSCANROWS</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Indicates the number of records (rows) to be scanned when a field’s data type is set based upon existing data. A number from 1 to 16 can be entered; a value of 0 means all records will be scanned.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
PAGETIMEOUT</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Indicates the period of time, in tenths of a second, that a page (if not used) remains in the buffer before being removed.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
REPAIR_DB</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Repairs a file damaged during the commit process. See the “<u>Database Repair</u> ” section later in this chapter.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
SAFETRANSACTIONS</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
If this is 1, it indicates that transactions will be committed immediately, without the delay specified by the PAGETIMEOUT value. If this is 0, it indicates that transactions will be truly committed when the operating system flushes the data to disk.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
THREADS</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
The number of background threads for the engine to use.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
USERCOMMITSYNC</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Indicates whether user-defined transactions are performed asynchronously. A value of YES (the default) means that the driver will wait for commits in a user-defined transaction to be completed.</font></td>
</tr>
</table><br>
<p>
All of the previously listed values are used for Microsoft Jet files, but this is not a complete list of the keywords that can be used in a call to <b>SQLConfigDataSource</b>. Other keywords can be used for other drivers.</p>
</BODY>
</HTML>
