<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Important Considerations When Compacting Replicated Databases</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h3><a name="jb2important_considerations_when_compacting_replicated_databases"></a>Important Considerations When Compacting Replicated Databases</h3>
<p>
Replicated databases make extensive use of temporary space, especially when many design changes are made to an application. Just as with non-replicated databases, compacting regularly reduces file size and improves performance.</p>
<p>
For optimal results, compact a replicated database twice. Compacting a replica the first time reclaims some space and flags other space as available for reclaiming later. Compacting a second time reclaims all available space. Compacting more than twice doesn’t provide additional benefits.</p>
<p>
When Microsoft Jet opens a replica, it stores the name and location of the file in the database. The next time Microsoft Jet opens the replica, it checks to see if the file has the same name and location. If so, then the file opens normally. If not, Microsoft Jet gives the replica a new <b>ReplicaID</b> property value and it will be treated as an additional replica in the replica set. Additionally, if the file was the Design Master, Microsoft Jet removes the Design Master flag. This prevents two replicas from having the same <b>ReplicaID</b> property value and keeps a replica set from having two Design Masters.</p>
<p>
To prevent this, when using the <b>CompactDatabase</b> method with a replicated database, make sure your code renames the new compacted .mdb file to the original file name before opening it.</p>
</BODY>
</HTML>
