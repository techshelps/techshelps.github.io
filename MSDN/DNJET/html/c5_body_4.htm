<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating a Recordset Object from a Query</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2creating_a_recordset_object_from_a_query"></a>Creating a Recordset Object from a Query</h4>
<p>
You can also create a <b>Recordset</b> object based on a stored SELECT query. In the following example, Current Product List is an existing SELECT query stored in the NorthwindTables database, and <code>strDbPath</code> is the path to the database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database, rst As Recordset

Set dbs = OpenDatabase(strDbPath)
Set rst = dbs.OpenRecordset(&quot;Current Product List&quot;)</font></pre>
<p>
<b>See Also   </b>For more information about SQL statements, see Chapter&nbsp;4, “<a href="c4_body.htm">Queries</a>,” and Appendix&nbsp;B, “<a href="apb_body.htm">SQL Reference</a>.”</p>
<p>
The <b>OpenRecordset</b> method also accepts an SQL string instead of the name of an existing query. The previous example can be rewritten as follows:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database, rst As Recordset
Dim strSQL As String

Set dbs = OpenDatabase(strDbPath)
strSQL = &quot;SELECT ProductID, ProductName FROM Products &quot; &amp; _
&#09;&quot;WHERE Discontinued=False ORDER BY ProductName;&quot;
Set rst = dbs.OpenRecordset(strSQL)</font></pre>
<p>
The disadvantage of this approach is that the query must be compiled each time it’s executed, whereas the stored query is compiled when it’s saved, which usually results in slightly better performance.</p>
<p>
<b>Note   </b>When you create a <b>Recordset</b> object by using an SQL string or a stored query, your code doesn’t continue running until the query returns the first record in the <b>Recordset</b> object. You may want to consider displaying a message in the status bar while the query is running.</p>
</BODY>
</HTML>
