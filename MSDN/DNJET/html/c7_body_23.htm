<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Making a Database Replicable</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2making_a_database_replicable"></a>Making a Database Replicable</h4>
<p>
Before you convert a database, you might want to determine whether the database is already replicable. You can check whether the <b>Replicable</b> or <b>ReplicableBool</b> property exists in the <b>Properties</b> collection of the <b>Database</b> object. If a database has been made replicable, both properties exist in the <b>Properties</b> collection of the <b>Database</b> object.</p>
<p>
Note that you may want to make a copy of the nonreplicable database before you make the database replicable. Microsoft Jet doesn’t do this for you automatically.</p>
<p>
The following code makes a database replicable by setting its <b>ReplicableBool</b> property to <b>True</b>. If the <b>ReplicableBool</b> property doesn’t exist, it is first created and appended and then set to <b>True</b>:</p>
<pre><FONT FACE="Courier New" SIZE="3">Function MakeDbReplicable(strDbPath As String) As Boolean
&#09;Dim dbs As Database
&#09;Const conErrPropNotFound = 3270
&#09;
&#09;On Error GoTo Err_MakeDbReplicable

&#09;' To create a replica, the database must be opened in exclusive mode.
&#09;' You open the database in exclusive mode by setting the options
&#09;' argument of the OpenDatabase method to True. If you try to open the
&#09;' current database exclusively in Microsoft Access, and you already have 
&#09;' it open in shared mode, you'll get an error. Close the current database 
&#09;' and reopen it in exclusive mode.
&#09;' To determine whether the database can be opened exclusively, use the 
&#09;' CanOpenDbExclusively function defined in Chapter&nbsp;2.
&#09;If CanOpenDbExclusively(strDbPath) Then
&#09;&#09;Set dbs = OpenDatabase(strDbPath, True)
&#09;Else
&#09;&#09;MsgBox &quot;Database must be open in exclusive mode to make replicable.&quot;
&#09;&#09;Exit Function
&#09;End If
&#09;' Does the ReplicableBool property exist?
&#09;dbs.Properties(&quot;ReplicableBool&quot;) = True
&#09;MakeDbReplicable = True
&#09;
Exit_MakeDbReplicable:
&#09;On Error Resume Next
&#09;dbs.Close
&#09;Set dbs = Nothing
&#09;Exit Function

Err_MakeDbReplicable:
&#09;If Err = conErrPropNotFound Then
&#09;&#09;' Add the ReplicableBool property to the database's Properties
&#09;&#09;' collection and set its value to True. Use the SetCustomProperty
&#09;&#09;' function defined in Chapter&nbsp;2.
&#09;&#09;If SetCustomProperty(dbs, &quot;ReplicableBool&quot;, dbBoolean, True) Then
&#09;&#09;&#09;Resume Next
&#09;&#09;End If
&#09;End If
&#09;MsgBox &quot;Error: &quot; &amp; Err.Number &amp; &quot; - &quot; &amp; Err.Description
&#09;MakeDbReplicable = False
&#09;Resume Exit_MakeDbReplicable
End Function</font></pre>
<p>
To create a Design Master by using DAO code, you must set the <i>options</i> argument of the <b>OpenDatabase</b> method to <b>True</b> to open the database exclusively. You cannot make a database replicable if it is currently open. During the conversion process, Microsoft Jet maintains all the property settings of your original database.</p>
<p>
Once you have created a Design Master, you can create additional replicas by using the <b>MakeReplica</b> method of the database object. For example, the following code fragment creates a database defined by the <code>strPathAndName</code> variable that is a replica of the Design Master represented by the <code>dbs</code> database variable.</p>
<pre><FONT FACE="Courier New" SIZE="3">strPathAndName = &quot;C:\JetBook\Samples\NewReplica.mdb&quot; 
dbs.MakeReplica strPathAndName</font></pre>
</BODY>
</HTML>
