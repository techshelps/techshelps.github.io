<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Executing SQL Pass-Through Queries with the Execute Method</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2executing_sql_pass-through_queries_with_the_execute_method"></a>Executing SQL Pass-Through Queries with the Execute Method</h4>
<p>
Another way to create and execute an SQL pass-through query is to use the <b>Execute</b> method on the <b>Database</b> object.</p>
<p>
<b><font face="Symbol"><span style="font-family:symbol">&#219;</span></font>&#09;To execute an SQL pass-through query by using the Execute method</b>
<ol>
<li>
Open the remote database, supplying a valid connect string for the <i>connect</i> argument.<br><br></li>
<li>
To run the query, use the <b>Execute</b> method of the <b>Database</b> object and specify the <b>dbSQLPassThrough</b> constant in the <i>options</i> argument.</li>
</ol>
<p>
This example shows how to execute an SQL pass-through query from code by using the <b>Execute</b> method.</p>
<pre><FONT FACE="Courier New" SIZE="3">Sub SQLPassThroughExecute()
&#09;Dim dbs As Database, strSQL As String

&#09;On Error GoTo Err_SQLPassThroughExecute
&#09;' Open remote database.
&#09;Set dbs = OpenDatabase(&quot;&quot;, False, False, _
&#09;&#09;&quot;ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Pubs&quot;)
&#09;strSQL = &quot;UPDATE Titles SET Royalty = 33 WHERE Type = 'Business'&quot;
&#09;' Call Execute method with pass-through flag.
&#09;dbs.Execute strSQL, dbSQLPassThrough

Exit_SQLPassThroughExecute:
&#09;On Error Resume Next
&#09;dbs.Close
&#09;Set dbs = Nothing
&#09;Exit Sub

Err_SQLPassThroughExecute:
&#09;VerboseErrorHandler
&#09;Resume Exit_SQLPassThroughExecute
End Sub</font></pre>
<p>
Note that you can also execute an SQL pass-through query by opening a Microsoft Jet database and setting the <b>Connect</b> property of the <b>Database</b> object to point to the remote database server you want to query. Then call the <b>Execute</b> method of the <b>Database</b> object with the <b>dbSQLPassThrough</b> option. For example, you could rewrite the previous procedure with the following code, where strDbPath is the path to a Microsoft Jet database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database, strSQL As String

' Open local Microsoft Jet database.
Set dbs = OpenDatabase(strDbPath)
dbs.Connect = &quot;ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Pubs&quot;
strSQL = &quot;UPDATE Titles SET Royalty = 33 WHERE Type = 'Business'&quot;
' Call Execute method with pass-through flag.
dbs.Execute strSQL, dbSQLPassThrough</font></pre>
<p>
The Microsoft Jet database may or may not contain linked ODBC tables that point to tables on the remote database server.</p>
<p>
The data loading section of the BookSales sample application (located in the Dataload.bas module) performs several cleanup tasks on the server tables before loading new data. It deletes all the records in the Sales, TitleAuthor, Authors, Titles, and Stores tables that have been added since the instance of the application began running (it does not remove the original data in the Pubs SQL Server database). If this application was originally .mdb-based, it might delete these records by opening a <b>Recordset</b> and stepping through each record using the <b>Delete</b> method, but using a delete query is faster than programmatically stepping through individual records and deleting them.</p>
<p>
When using SQL statements with a Microsoft Jet <b>Workspace</b> object, you can tell Microsoft Jet to assign more of the processing burden to the server. To do this, use the <b>dbSQLPassThrough</b> constant in the <i>options</i> argument of the <b>Execute</b> method. This instructs Microsoft Jet to send the command directly to the server without doing any of its own processing. For example:</p>
<pre><FONT FACE="Courier New" SIZE="3">dbs.Execute &quot;DELETE stores&quot;, dbSQLPassThrough</font></pre>
<p>
Note that the DELETE statement is not valid Microsoft Jet SQL syntax. If you run this query without using the <b>dbSQLPassThrough</b> constant, a run-time error will occur. When sending a query directly to the server as a pass-through query, you must use the syntax and keywords of the server’s dialect of SQL, not Microsoft Jet SQL. Microsoft Jet will not translate a pass-through query.</p>
<p>
<b>Note   </b>All SQL queries are passed directly to an ODBC server when using an ODBCDirect <b>Workspace</b> object. For information on how to use ODBCDirect features, see “The Object Model for ODBCDirect Workspaces” later in this chapter.</p>
</BODY>
</HTML>
