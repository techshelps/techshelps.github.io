<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Creating the Connection String</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2creating_the_connection_string"></a>Creating the Connection String</h4>
<p>
The following sections contain the information you need to build a connection string to access data in Microsoft Exchange and Outlook folders.</p>
<h5>Understanding the Elements of the Connection String</h5>
<p>
The following table contains a description of the required and optional elements used to create the <i>identifier</i>, <i>source</i>, and <i>options</i> portions of a connection string for a Microsoft Exchange or Outlook external data source.</p>
<table>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Element</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Description</b></font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Source</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Exchange 4.0</b> (required.) The setting works with Microsoft Exchange&nbsp;4.<i>x</i>, 5.0, and Outlook data.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Table name</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>MAPILEVEL=</b><i>storage</i><b>|</b><i>folders</i> (required). The <i>storage</i> entry is the exact name of a mailbox on a server, a personal folder, or public folder; and <i>folders</i> is the path to the folder immediately above the folder you want to connect to. The <i>storage</i> entry and the pipe character (|) are always required. The <i>folders</i> entry is required to access folders below the top-level of folders within <i>storage</i>. When you are listing nested folders, separate each folder name with a backslash (\). </font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Source table type</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>TABLETYPE=0</b> (for folders) (default)<BR><b>TABLETYPE=1</b> (for address books; required)</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Database name</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>DATABASE=</b><i>path</i> (required). The <i>path</i> entry is the path to a Microsoft Access database (.mdb) in which to store system tables used by the driver (usually the current database).</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Profile name</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>PROFILE=</b><i>profile</i> (optional; if not specified, the default profile is used). The <i>profile</i> entry is the name of the Microsoft Exchange or Outlook profile to use.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Password</font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>PWD=</b><i>password</i> (optional; not required if your network logon password is passed to your Microsoft Exchange server). The <i>password</i> entry is the Microsoft Exchange or Outlook logon password.</font></td>
</tr>
</table><br>
<h5>Building the Connection String</h5>
<p>
All IISAM drivers accept a connection string that uses the same basic syntax:</p>
<p>
<code>&quot;</code><i>identifier</i><b>,</b> <i>source</i><b>,</b> <i>options</i><code>&quot;</code></p>
<p>
When you are building a connection string to a Microsoft Exchange or Outlook data source, the <i>source</i> argument will always be <b>Exchange 4.0;</b> even if you are working with Microsoft Exchange 5.0 or Outlook. The <i>source</i> argument consists of the table name, source table name, and the database name. The <i>options</i> argument, if used, can consist of settings for either or both the profile name and the password.</p>
<p>
The following code sample illustrates a connection string used to link a Microsoft Exchange folder named SampleMessages, which is a subfolder of the Inbox folder, to a Microsoft Jet table named SampleMessages. In this example, <code>strDbPath</code> is the path to the database that will contain the linked table:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database
Dim tdf As TableDef
Dim strConnect As String

' Open a Microsoft Jet database.
Set dbs = OpenDatabase(strDbPath)
' Create connection string.
strConnect = &quot;Exchange 4.0;MAPILEVEL=Mailbox - &quot; &amp; _
&#09;&quot;David Jones|Inbox;TABLETYPE=0;&quot; &amp; _
&#09;&quot;DATABASE=&quot; &amp; dbs.Name &amp; &quot;;&quot;
' Create TableDef object in Microsoft Jet database.
Set tdf = dbs.CreateTableDef(&quot;SampleMessages&quot;)
' Link TableDef object to Microsoft Exchange data source.
With tdf
&#09;.Connect = strConnect
&#09;.SourceTableName = &quot;SampleMessages&quot;
End With
dbs.TableDefs.Append tdf</font></pre>
<p>
In the example above, the connection string <i>identifier</i> is <b>Exchange 4.0;</b> and the <i>source</i> is <b>MAPILEVEL=</b><code>&quot;</code><b>Mailbox - Dave Jones|Inbox;TABLETYPE=0;DATABASE=</b><code>&quot;</code><b> &amp; dbs.Name &amp; </b><code>&quot;</code><b>;</b><code>&quot;</code>.</p>
<p>
The <b>MAPILEVEL=</b> portion of the connection string specifies the path to the folder immediately above the folder you want to access. The <b>SourceTableName</b> property specifies the name of the folder you want to access. The information that appears to the left of the pipe character ( | ) can be any valid mailbox name or any valid local personal folder file. You must preserve any spaces and capitalization that appear in the name.</p>
<p>
The <b>DATABASE=</b> portion of the connection string must contain the path and name of an existing Microsoft Access&nbsp;97 database. Although you may specify any database here, it is preferable to use the current database for this purpose. The specified database is used to store system tables that contain information about the structure of the Microsoft Exchange or Outlook folder.</p>
<p>
In the <i>options</i> argument, if the PROFILE argument is omitted, the default profile is used. If the PWD argument is omitted, your network logon password is used. If, for some reason, either of these default values is invalid, you are prompted to enter the correct information.</p>
</BODY>
</HTML>
