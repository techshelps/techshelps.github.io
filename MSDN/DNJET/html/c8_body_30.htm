<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Special Considerations for Spreadsheets</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h3><a name="jb2special_considerations_for_spreadsheets"></a>Special Considerations for Spreadsheets</h3>
<p>
The following sections describe special information that will help you understand how Microsoft Jet interacts with Lotus 1-2-3 spreadsheets and Microsoft Excel worksheets and workbooks. Both products have one common feature worth mentioning: the HDR argument in the connection string. Additional considerations for each product are covered separately in the sections that follow.</p>
<h5>Using the HDR Argument to Suppress Headers</h5>
<p>
The registry keys that manage behavior in Lotus 1-2-3 spreadsheets and Microsoft Excel worksheets and workbooks contain a setting that determines whether the IISAM driver should use the data in the cells of the first row of the sheet as field names in the Microsoft Jet database. This setting, FirstRowHasNames, is found in the \HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\3.5\Engines\Lotus key for Lotus 1-2-3 and the \HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\3.5<BR>\Engines\Excel key for Microsoft Excel. When the value of FirstRowHasNames is 01 (<b>True</b>, the default), <i>all</i> sheets of that product family are handled as if the first row contained field name information.</p>
<p>
To override this registry setting on a sheet-by-sheet basis, you must use the HDR argument in the <i>options</i> portion of the connection string. Set HDR to <b>True</b> (HDR=YES) to instruct the IISAM driver to use the data in the first row of the sheet as field names, regardless of the registry setting. Set HDR to <b>False</b> (HDR=NO) to instruct the IISAM driver to treat the first row of the sheet as data, regardless of the registry setting.</p>
<p>
The following procedure opens a worksheet in a Microsoft Excel 8.0 workbook and computes the number of records in the Products worksheet contained in the Products97.xls workbook. The HDR argument is set according to the value of the <i>blnHDRParam </i>argument passed to the procedure. When the HDR argument in the connection string is set to NO, the count is 80 records; when it’s set to YES, the count is&nbsp;79.</p>
<pre><FONT FACE="Courier New" SIZE="3">Sub TestHDRConnectParameter(blnHDRParam As Boolean)
&#09;Dim dbs As Database
&#09;Dim rst As Recordset
&#09;Dim strHDRParam As String

&#09;If blnHDRParam = True Then
&#09;&#09;strHDRParam = &quot;YES&quot;
&#09;Else
&#09;&#09;strHDRParam = &quot;NO&quot;
&#09;End If

&#09;' Open the Microsoft Jet sample database.
&#09;Set dbs = OpenDatabase(&quot;C:\JetBook\Samples\Excel\Products97.xls&quot;, _
&#09;&#09;False, False, &quot;Excel 8.0;HDR=&quot; &amp; strHDRParam &amp; &quot;;&quot;)

&#09;' Create a Recordset object for the Microsoft Excel Products worksheet.
&#09;Set rst = dbs.OpenRecordset(&quot;Products$&quot;)

&#09;' Move to the last record and display the RecordCount property value.
&#09;With rst
&#09;&#09;.MoveLast
&#09;&#09;MsgBox &quot;There are &quot; &amp; .RecordCount &amp; &quot; records in this worksheet.&quot;
&#09;&#09;.Close
&#09;End With
&#09;dbs.Close
End Sub</font></pre>
</BODY>
</HTML>
