<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Determining Whether You Can Open a Database Exclusively</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2determining_whether_you_can_open_a_database_exclusively"></a>Determining Whether You Can Open a Database Exclusively</h4>
<p>
You may also want to determine whether your own code is able to open a database exclusively. This information can be helpful with many operations, such as:
<ul>
<li>
Repairing a database.<br><br></li>
<li>
Compacting a database.<br><br></li>
<li>
Saving your Microsoft Access&nbsp;97 database as an MDE file.<br><br></li>
<li>
Converting a database into a Design Master replica.<br><br></li>
<li>
Converting or enabling a database from a previous version.</li>
</ul>
<p>
In addition, the user that is currently logged on may not have permission to open the database exclusively.</p>
<p>
<b>See Also   </b>For more information about Design Master replicas, see Chapter&nbsp;7, “<a href="c7_body.htm">Database Replication</a>.” For more information about user permissions, see Chapter&nbsp;10, “<a href="c10_body.htm">Managing Security</a>.”</p>
<p>
To determine whether you can open a database exclusively, use the <b>PrivDBEngine</b> object in code that is similar to the IsDbOpenedExclusively function shown in the preceding example:</p>
<pre><FONT FACE="Courier New" SIZE="3">Function CanOpenDbExclusively(strDbPath As String) As Boolean
&#09;On Error Resume Next
&#09;Dim dbe As PrivDBEngine
&#09;Dim wrk As Workspace
&#09;Dim dbs As Database
&#09;Const conFileInUse = 3045
&#09;Const conDBOpenedExclusively = 3356
&#09;
&#09;Set dbe = New PrivDBEngine
&#09;Set wrk = dbe.Workspaces(0)
&#09;Set dbs = wrk.OpenDatabase(strDbPath, True)
&#09;If dbs Is Nothing Then
&#09;&#09;' If error is unanticipated, display message.
&#09;&#09;If (Err = conFileInUse Or Err = conDBOpenedExclusively) Then
&#09;&#09;&#09;' If database cannot be opened exclusively, return False.
&#09;&#09;&#09;CanOpenDbExclusively = False
&#09;&#09;Else
&#09;&#09;&#09;MsgBox &quot;Error: &quot; &amp; Err &amp; &quot;: &quot; &amp; vbCrLf &amp; Err.Description
&#09;&#09;End If
&#09;Else
&#09;&#09;' If database can be opened exclusively, return True.
&#09;&#09;CanOpenDbExclusively = True
&#09;&#09;dbs.Close
&#09;End If
End Function</font></pre>
<p>
This function returns <b>True</b> if you can open the database exclusively.</p>
</BODY>
</HTML>
