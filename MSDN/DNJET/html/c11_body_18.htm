<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Initializing CdbDBEngine</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h3><a name="jb2initializing_cdbdbengine"></a>Initializing CdbDBEngine</h3>
<p>
In dbDAO, the <b>CdbDBEngine</b> class initializes the DAO <b>DBEngine</b> object. (As noted earlier in this chapter, declaring a variable of class <b>CdbDBEngine</b> is not done in Visual Basic). <b>CdbDBEngine</b> has two constructors:</p>
<pre><FONT FACE="Courier New" SIZE="3">void CdbDBEngine::CdbDBEngine(BOOL bPrivate=FALSE, BOOL bStart=TRUE,
&#09;&#09;LPCTSTR pstrIniPath=NULL, LPCTSTR pstrDefUser=NULL,
&#09;&#09;LPCTSTR pstrDefPW=NULL, LONG lType=dbUseJet)

void CdbDBEngine::CdbDBEngine(DAODBEngine *peng, BOOL bAddRef=FALSE)</font></pre>
<p>
The first constructor allows you to specify the whether the <b>DBEngine</b> object is private or shared, whether the engine should start on construction, the <b>IniPath</b>, the default user, the default password, and the default type for workspaces. Once the engine is started, these properties cannot be modified. The second constructor allows you to add an additional reference to an existing instance of the <b>DBEngine</b> object. Both constructors call <b>CoCreateInstance</b> to create an instance of the <b>DBEngine</b> object and obtain a <b>DAODBEngine</b> interface pointer (the underlying Automation interface as defined in Dbdaoint.h).</p>
<p>
Each private engine is a new instance of DAO. A shared engine is common across all instances, enabling them to share open workspaces, databases, recordsets, and so on.</p>
<p>
If you don’t start the engine on construction, you can use a <b>Start</b> method to start it. Before invoking the <b>Start</b> method, you can override the default registry key by setting the <b>IniPath</b> property and override the default workgroup information file by setting the <b>SystemDB</b> property.</p>
</BODY>
</HTML>
