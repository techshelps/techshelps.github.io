<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Switching Between Connection and Database Objects</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2switching_between_connection_and_database_objects"></a>Switching Between Connection and Database Objects</h4>
<p>
With ODBCDirect, you can open a <b>Database</b> object and a <b>Connection</b> object against the same ODBC data source, and use both in your code. You can then take advantage of each object for its different capabilities.</p>
<p>
Alternatively, you may want to create a single object and then switch to the other type when needed. To do this, use the <b>Connection</b> property of the <b>Database</b> object or the <b>Database</b> property of the <b>Connection</b> object. You can use these properties to create <b>Connection</b> objects from <b>Database</b> objects and to create <b>Database</b> objects from <b>Connection</b> objects. This is especially useful for adding ODBCDirect capabilities to existing applications that only use <b>Database</b> objects.</p>
<p>
For example, you can use a <b>Database</b> object for most of your ODBC data access needs, but when you need to run an asynchronous query, you can create a <b>Connection</b> object from the <b>Database</b> object and then run the query on the <b>Connection</b> object. The following example illustrates this technique.</p>
<pre><FONT FACE="Courier New" SIZE="3">Sub DeleteWashingtonRecords()
&#09;Dim dbs As Database, cnn As Connection
&#09;Dim strSQL As String, strConnect As String

&#09;strConnect = &quot;ODBC;DSN=Pubs;DATABASE=Pubs;UID=sa;PWD=;&quot;
&#09;strSQL = &quot;DELETE FROM Authors WHERE State = &quot;&quot;WA&quot;&quot;&quot;

&#09;' Open database in default workspace.
&#09;Set dbs = OpenDatabase(&quot;&quot;, False, False, strConnect)

&#09;' Try to create Connection object from a Database object. If workspace is an
&#09;' ODBCDirect workspace, the query runs asynchronously. If workspace is a
&#09;' Microsoft Jet workspace, an error occurs and the query runs synchronously.

&#09;Err.Clear
&#09;On Error Resume Next
&#09;Set cnn = dbs.Connection
&#09;If Err.Number = 0 Then
&#09;&#09;cnn.Execute strSQL, dbRunAsync
&#09;Else
&#09;&#09;dbs.Execute strSQL
&#09;End If
End Sub</font></pre>
</BODY>
</HTML>
