<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Using Transactions in Your Applications</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h3><a name="jb2using_transactions_in_your_applications"></a>Using Transactions in Your Applications</h3>
<p>
Microsoft Jet supports transactions through the <b>BeginTrans</b>, <b>CommitTrans</b> and <b>Rollback</b> methods of the <b>Workspace</b> object. The basic syntax is shown in the following table.</p>
<table>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Method</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<b>Operation</b></font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<i>workspace.</i><b>BeginTrans</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Begins the transaction.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<i>workspace.</i><b>Rollback</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Undoes the transaction.</font></td>
</tr>
<tr valign=top>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
<i>workspace.</i><b>CommitTrans</b></font></td>
<td><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">
Posts the transaction, writing its updates to the permanent database objects.</font></td>
</tr>
</table><br>
<p>
The following example changes the job title of all sales associates in the Employees table of the NorthwindTables database. After the <b>BeginTrans</b> method starts a transaction that isolates all of the changes made to the Employees table, the <b>CommitTrans </b>method saves the changes. Note that you can use the <b>Rollback</b> method to undo changes that you saved with the <b>Update</b> method. In this example, <code>strDbPath</code> is the path to the database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database
Dim rst As Recordset
Dim wsp As Workspace
Dim strCriteria As String
&#09;
' Return reference to default workspace.
Set wsp = DBEngine.Workspaces(0)
Set dbs = OpenDatabase(strDbPath)
' Open dynaset-type recordset.
Set rst = dbs.OpenRecordset(&quot;Employees&quot;, dbOpenDynaset)
strCriteria = &quot;Title = &quot;&quot;Sales Associate&quot;&quot;&quot;

' Begin transaction.
wsp.BeginTrans
With rst
&#09;' Search recordset for records matching criteria.
&#09;.MoveFirst
&#09;.FindFirst strCriteria
&#09;' Edit matching records.
&#09;Do While Not .NoMatch
&#09;&#09;.Edit
&#09;&#09;!Title = &quot;Sales Representative&quot;
&#09;&#09;.Update
&#09;&#09;.FindNext strCriteria
&#09;Loop
End With

' Prompt user to save changes or roll back.
If MsgBox(&quot;Save all changes?&quot;, vbQuestion + vbYesNo) = vbYes Then
&#09;wsp.CommitTrans
Else
&#09;wsp.Rollback
End If
rst.Close
dbs.Close</font></pre>
<p>
<b>Important   </b>Because transactions are scoped to the <b>Workspace</b> object, transactions are global to the workspace, not to a specific database or recordset. If you perform operations on more than one database or recordset within a workspace transaction, the <b>Commit</b> and <b>Rollback</b> methods affect all the objects changed within that workspace during the transaction.</p>
</BODY>
</HTML>
