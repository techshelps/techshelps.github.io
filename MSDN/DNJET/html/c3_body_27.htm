<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Indexes and ODBC Views</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h3><a name="jb2indexes_and_odbc_views"></a>Indexes and ODBC Views</h3>
<p>
Earlier in this chapter, linking to tables from external data sources such as FoxPro or Microsoft SQL&nbsp;Server to a Microsoft Jet database file was discussed. To link to external tables, you specify the original source of the table in the <b>Connect</b> property of a new <b>TableDef</b> object and then append the <b>TableDef</b> object to the <b>TableDefs</b> collection of the database.</p>
<p>
In addition to linking to tables in external databases, you can also link to views in SQL data sources, such as Microsoft SQL&nbsp;Server or Oracle. A <i>view</i> is a named SQL SELECT statement executed on the server that joins one or more tables and selects one or more fields.</p>
<p>
Normally, a linked view is not updatable even if it’s based on an updatable table. For a linked table to be updatable, it must contain a primary key or a unique index.</p>
<p>
When you link to a view rather than to a table, there is no index available and Microsoft Jet doesn’t have enough information to treat the view as updatable. To make the linked view updatable, you must create a <i>pseudo index</i> for the <b>TableDef</b> object of the linked view. The pseudo index tells Microsoft Jet which of the fields in the linked view comprise the primary key or unique index in the table underlying the view. The index exists within the Microsoft Jet database only. Nothing is created on the server. In previous versions of DAO, a pseudo index was referred to as an <i>index specification</i>.</p>
<p>
The following code creates a view named USCustomers in a SQL&nbsp;Server database. In this case, the SQL Server database is the Microsoft Access Northwind database that’s been upsized to SQL Server by using the Microsoft Access&nbsp;97 Upsizing Tools:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim wrk As Workspace, con As Connection
Dim strSQL As String, strConnect As String

' Create ODBCDirect workspace.
Set wrk = DBEngine.CreateWorkspace(&quot;ODBCWorkspace&quot;, &quot;admin&quot;, &quot;&quot;, dbUseODBC)

' Initialize connection string.
strConnect = &quot;ODBC;DATABASE=NorthwindSQL;UID=sa;&quot; _
&#09;&amp; &quot;DSN=NorthwindSQLDSN&quot;

' Open connection.
Set con = wrk.OpenConnection(&quot;NorthwindConnection&quot;, , , strConnect)
strSQL = &quot;CREATE VIEW USCustomers AS &quot; _
&#09;&amp; &quot;(SELECT * FROM Customers WHERE Country = 'USA')&quot;

' Execute SQL statement.
con.Execute strSQL</font></pre>
<p>
<b>Notes</b>
<ul>
<li>
This code uses objects in the ODBCDirect object model. For more information about ODBCDirect, see Chapter 9, “<a href="c9_body.htm">Developing Client/Server Applications</a>.”<br><br></li>
<li>
The Microsoft Access Upsizing Tools are located in the Upsizing folder on the companion CD-ROM.</li>
</ul>
<p>
The following code links to a view on the server and then creates an index on the view to make it updatable. In this example, <code>strDbPath</code> is the path to the database:</p>
<pre><FONT FACE="Courier New" SIZE="3">Dim dbs As Database
Dim tdf As TableDef

Set dbs = OpenDatabase(strDBPath)

' Create linked table based on SQL view.
Set tdf = dbs.CreateTableDef(&quot;USCustomersLinked&quot;)

' Specify SQL view as source table.
tdf.SourceTableName = &quot;USCustomers&quot;

' Connect to SQL database.
tdf.Connect = &quot;ODBC;DATABASE=NorthwindSQL;UID=sa;&quot; _
&#09;&amp; &quot;DSN=NorthwindSQLDSN&quot;
dbs.TableDefs.Append tdf
dbs.TableDefs.Refresh

' Create primary key on linked table.
dbs.Execute &quot;CREATE INDEX PrimaryKey &quot; &amp; _
&#09;&quot;ON USCustomersLinked (CustomerID) WITH PRIMARY&quot;</font></pre>
<p>
The newly linked view, USCustomersLinked, can now be updated as though it were a regular table.</p>
<p>
<b>See Also   </b>For more information about the updatability of external data sources, see Chapter&nbsp;8, “<a href="c8_body.htm">Accessing External Data</a>.” For more information about working with Microsoft SQL Server databases, see Chapter&nbsp;9, “<a href="c9_body.htm">Developing Client/Server Applications</a>.”</p>
</BODY>
</HTML>
