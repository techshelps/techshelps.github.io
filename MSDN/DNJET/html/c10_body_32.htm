<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text-html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Determining If a User Has Read Permission for a Table</title>
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>	<BODY bgcolor="#FFFFFF" link=#003399 vlink=#996699>

	<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END--><h4><a name="jb2determining_if_a_user_has_read_permission_for_a_table"></a>Determining If a User Has Read Permission for a Table</h4>
<p>
In general, you shouldn’t check for a specific permission with the equal sign (=) as in the following line:</p>
<pre><FONT FACE="Courier New" SIZE="3">If (doc.Permissions = dbSecRetrieveData) Then</font></pre>
<p>
Rarely does a user have only one permission set. If the user had any other permission set (besides the <b>dbSecRetrieveData</b> permission constant), this example would fail. To check for a specific permission, use <b>And</b> with that permission’s value and the object’s <b>Permission</b> property, and check for a resulting value greater than 0. If it is, the user has the specified permission. The following example shows how to do this. In this example, <code>strDbPath</code> is the path to the database, <code>strUser</code> is the name of a user or group, and <code>strDocument</code> is the name of the <b>Document</b> object.</p>
<pre><FONT FACE="Courier New" SIZE="3">Sub CheckReadPerms(strDbPath As String, strUser As String, _
&#09;strDocument As String)
&#09;
&#09;Dim dbs As Database
&#09;Dim doc As Document
&#09;
&#09;Set dbs = OpenDatabase(strDbPath)
&#09;Set doc = dbs.Containers(&quot;Tables&quot;).Documents(strDocument)
&#09;' Specify user or group name.
&#09;doc.UserName = strUser
&#09;' Use And operator to compare permissions.
&#09;If (doc.Permissions And dbSecRetrieveData) &gt; 0 Then
&#09;&#09;Debug.Print strUser &amp; &quot; has read permissions for &quot; _
&#09;&#09;&#09;&amp; strDocument &amp; &quot;.&quot;
&#09;Else
&#09;&#09;Debug.Print strUser &amp; &quot; does not have read permissions &quot; _
&#09;&#09;&#09;&amp; &quot;for &quot; &amp; strDocument &amp; &quot;.&quot;
&#09;End If
End Sub</font></pre>
<p>
You should also note that this example checks only for explicit permissions: those assigned to that user for that object. It does not take into account any implicit permissions that exist through group membership. The following example is more thorough in that it uses the <b>AllPermissions</b> property to take into account the user’s group permissions. In this example, <code>strDbPath</code> is the path to the database, <code>strUser</code> is the name of a user or group, and <code>strDocument</code> is the name of the <b>Document</b> object:</p>
<pre><FONT FACE="Courier New" SIZE="3">Sub CheckAllReadPerms(strDbPath As String, strUser As String, _
&#09;&#09;strDocument As String)
&#09;Dim dbs As Database, doc As Document
&#09;&#09;
&#09;Set dbs = OpenDatabase(strDbPath)
&#09;Set doc = dbs.Containers(&quot;Tables&quot;).Documents(strDocument)
&#09;' Specify name of user or group.
&#09;doc.UserName = strUser
&#09;' Check all permissions for user on document.
&#09;If (doc.AllPermissions And dbSecRetrieveData) &gt; 0 Then
&#09;&#09;Debug.Print strUser &amp; &quot; has implicit or explicit read &quot; _
&#09;&#09;&#09;&amp; &quot;permissions for &quot; &amp; strDocument &amp; &quot;.&quot;
&#09;Else
&#09;&#09;Debug.Print strUser &amp; &quot; has no permissions.&quot;
&#09;End If
End Sub</font></pre>
</BODY>
</HTML>
