<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>WINMAIN.CXX</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context24"></a>WINMAIN.CXX</h2>
<pre><code>//+--------------------------------------------------------------------------- <br>// <br>//  Microsoft Windows <br>//  Copyright 1992 - 1998 Microsoft Corporation. <br>// <br>//  File:       winmain.cxx <br>// <br>//  Contents:   main entry point for Stereo Shop <br>// <br>//  Classes: <br>// <br>//  Functions:  WinMain <br>// <br>//  History:    6-08-94   stevebl   Created <br>// <br>//---------------------------------------------------------------------------- <br> <br>#include "dfv.h" <br>#include "mwclass.h" <br>#include &lt;ole2ver.h&gt; <br> <br>//+--------------------------------------------------------------------------- <br>// <br>//  Function:   InitApplication <br>// <br>//  Synopsis:   initializes the application and registers its window class <br>//              (called once for all instances) <br>// <br>//  Arguments:  [hInstance] - handle to the first instance <br>// <br>//  Returns:    TRUE on success <br>// <br>//  History:    4-11-94   stevebl   Created for MFract <br>//              6-08-94   stevebl   Stolen from MFract <br>// <br>//---------------------------------------------------------------------------- <br> <br>BOOL InitApplication(HINSTANCE hInstance) <br>{ <br>    WNDCLASS wc; <br> <br>    wc.style = 0; <br>    wc.lpfnWndProc = &amp;WindowProc; <br>    wc.cbClsExtra = 0; <br>    wc.cbWndExtra = 0; <br>    wc.hInstance = hInstance; <br>    wc.hIcon = LoadIcon(hInstance, TEXT("StreamIcon")); <br>    wc.hCursor = (HCURSOR) LoadCursor(NULL, IDC_ARROW); <br>    wc.hbrBackground = (HBRUSH) GetStockObject(WHITE_BRUSH); <br>    wc.lpszMenuName = NULL; <br>    wc.lpszClassName = TEXT(STREAM_VIEW_CLASS_NAME); <br>    ATOM aReturn = RegisterClass(&amp;wc); <br>    if (!aReturn) <br>    { <br>        return(aReturn); <br>    } <br>    wc.style = CS_DBLCLKS; <br>    wc.hIcon = LoadIcon(hInstance, TEXT("AppIcon")); <br>    wc.lpszMenuName = TEXT(MAIN_WINDOW_CLASS_MENU_STR); <br>    wc.lpszClassName = TEXT(MAIN_WINDOW_CLASS_NAME); <br>    return(RegisterClass(&amp;wc)); <br>} <br> <br>//+--------------------------------------------------------------------------- <br>// <br>//  Function:   WinMain <br>// <br>//  Synopsis:   main window proceedure <br>// <br>//  Arguments:  [hInstance]     - instance handle <br>//              [hPrevInstance] - handle of the previous instance (if any) <br>//              [lpCmdLine]     - pointer to the command line <br>//              [nCmdShow]      - show state <br>// <br>//  History:    4-11-94   stevebl   Created for MFract <br>//              6-08-94   stevebl   Stolen from MFract <br>// <br>//  Notes:      initializes application and starts message loop <br>// <br>//---------------------------------------------------------------------------- <br> <br>extern "C" int PASCAL WinMain(HINSTANCE hInstance, <br>            HINSTANCE hPrevInstance, <br>            LPSTR lpCmdLine, <br>            int nCmdShow) <br>{ <br>    DWORD dwBuildVersion = CoBuildVersion(); <br>    if (HIWORD(dwBuildVersion) != rmm || LOWORD(dwBuildVersion) &lt; rup) <br>    { <br>        // alert the caller that the OLE version is incompatible <br>        // with this build. <br>        MessageBoxFromStringIdsAndArgs( <br>            NULL, <br>            hInstance, <br>            IDS_OLEINCOMPATIBLE, <br>            IDS_ERROR, <br>            MB_OK | MB_ICONEXCLAMATION, <br>            rmm, rup); <br>        return(FALSE); <br>    } <br>    if (FAILED(CoInitialize(NULL))) <br>    { <br>        // alert the caller that OLE couldn't be initialized <br>        MessageBoxFromStringIds( <br>            NULL, <br>            hInstance, <br>            IDS_OLEINITFAILED, <br>            IDS_ERROR, <br>            MB_OK | MB_ICONEXCLAMATION); <br>        return(FALSE); <br>    } <br>    if (!hPrevInstance) <br>    { <br>        if (!InitApplication(hInstance)) <br>        { <br>            CoUninitialize(); <br>            return(FALSE); <br>        } <br>    } <br>    CMainWindow * pw = new CMainWindow; <br>    if (pw == NULL) <br>    { <br>        CoUninitialize(); <br>        return(FALSE); <br>    } <br>    if (!pw-&gt;InitInstance(hInstance, nCmdShow)) <br>    { <br>        // Note, if InitInstance has failed then it would have <br>        // already deleted pw for me so I don't delete it here. <br>        // This is because when WM_CREATE returns -1 (failure) <br>        // Windows sends the WM_DESTROY message to the window <br>        // and the the CHlprWindow class destroys itself whenever <br>        // it receives this message. <br>        CoUninitialize(); <br>        return(FALSE); <br>    } <br> <br>    // check command line and try and load as a file <br> <br>    if (strlen(lpCmdLine) &gt; 0) <br>    { <br>#ifdef UNICODE <br>        mbstowcs(pw-&gt;_szFileName, lpCmdLine, MAX_PATH - 1); <br>#else <br>        strncpy(pw-&gt;_szFileName, lpCmdLine, MAX_PATH - 1); <br>#endif <br>        pw-&gt;OpenFile(); <br>    } <br> <br>    MSG msg; <br>    HACCEL haccel = LoadAccelerators(hInstance, TEXT("AppAccel")); <br>    if (haccel == NULL) <br>    { <br>        CoUninitialize(); <br>        return(FALSE); <br>    } <br> <br>    while (GetMessage(&amp;msg, NULL, 0, 0)) <br>    { <br>        if (!TranslateAccelerator( <br>            pw-&gt;GetHwnd(), <br>            haccel, <br>            &amp;msg)) <br>        { <br>            TranslateMessage(&amp;msg); <br>            DispatchMessage(&amp;msg); <br>        } <br>    } <br>    CoUninitialize(); <br>    return(msg.wParam); <br>} <br> <br> <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
