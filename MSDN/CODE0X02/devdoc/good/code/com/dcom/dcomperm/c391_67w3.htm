<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DCOMPERM.H</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context393"></a>DCOMPERM.H</h2>
<pre><code>/*++ <br> <br>DCOM Permission Configuration Sample <br>Copyright (c) 1996, Microsoft Corporation. All rights reserved. <br> <br>Module Name: <br> <br>    dcomperm.h <br> <br>Abstract: <br> <br>    Include file for DCOM Permission Configuration sample <br> <br>Author: <br> <br>    Michael Nelson <br> <br>Environment: <br> <br>    Windows NT <br> <br>--*/ <br> <br>#define GUIDSTR_MAX 38 <br> <br>#ifndef STR2UNI <br> <br>#define STR2UNI(unistr, regstr) \ <br>        mbstowcs (unistr, regstr, strlen (regstr)+1); <br> <br>#define UNI2STR(regstr, unistr) \ <br>        wcstombs (regstr, unistr, wcslen (unistr)+1); <br> <br>#endif <br> <br> <br>// <br>// Wrappers <br>// <br> <br>DWORD <br>ListDefaultAccessACL(); <br> <br>DWORD <br>ListDefaultLaunchACL(); <br> <br>DWORD <br>ListAppIDAccessACL ( <br>    LPTSTR AppID <br>    ); <br> <br>DWORD <br>ListAppIDLaunchACL ( <br>    LPTSTR AppID <br>    ); <br> <br>DWORD <br>ChangeDefaultAccessACL ( <br>    LPTSTR Principal, <br>    BOOL SetPrincipal, <br>    BOOL Permit <br>    ); <br> <br>DWORD <br>ChangeDefaultLaunchACL ( <br>    LPTSTR Principal, <br>    BOOL SetPrincipal, <br>    BOOL Permit <br>    ); <br> <br>DWORD <br>ChangeAppIDAccessACL ( <br>    LPTSTR AppID, <br>    LPTSTR Principal, <br>    BOOL SetPrincipal, <br>    BOOL Permit <br>    ); <br> <br>DWORD <br>ChangeAppIDLaunchACL ( <br>    LPTSTR AppID, <br>    LPTSTR Principal, <br>    BOOL SetPrincipal, <br>    BOOL Permit <br>    ); <br> <br>DWORD GetRunAsPassword ( <br>    LPTSTR AppID, <br>    LPTSTR Password <br>    ); <br> <br>DWORD SetRunAsPassword ( <br>    LPTSTR AppID, <br>    LPTSTR Principal, <br>    LPTSTR Password <br>    ); <br> <br>DWORD GetRunAsPassword ( <br>    LPTSTR AppID, <br>    LPTSTR Password <br>    ); <br> <br>DWORD SetRunAsPassword ( <br>    LPTSTR AppID, <br>    LPTSTR Password <br>    ); <br> <br>// <br>// Internal functions <br>// <br> <br>DWORD <br>CreateNewSD ( <br>    SECURITY_DESCRIPTOR **SD <br>    ); <br> <br>DWORD <br>MakeSDAbsolute ( <br>    PSECURITY_DESCRIPTOR OldSD, <br>    PSECURITY_DESCRIPTOR *NewSD <br>    ); <br> <br>DWORD <br>SetNamedValueSD ( <br>    HKEY RootKey, <br>    LPTSTR KeyName, <br>    LPTSTR ValueName, <br>    SECURITY_DESCRIPTOR *SD <br>    ); <br> <br>DWORD <br>GetNamedValueSD ( <br>    HKEY RootKey, <br>    LPTSTR KeyName, <br>    LPTSTR ValueName, <br>    SECURITY_DESCRIPTOR **SD, <br>    BOOL *NewSD <br>    ); <br> <br>DWORD <br>ListNamedValueSD ( <br>    HKEY RootKey, <br>    LPTSTR KeyName, <br>    LPTSTR ValueName <br>    ); <br> <br>DWORD <br>AddPrincipalToNamedValueSD ( <br>    HKEY RootKey, <br>    LPTSTR KeyName, <br>    LPTSTR ValueName, <br>    LPTSTR Principal, <br>    BOOL Permit <br>    ); <br> <br>DWORD <br>RemovePrincipalFromNamedValueSD ( <br>    HKEY RootKey, <br>    LPTSTR KeyName, <br>    LPTSTR ValueName, <br>    LPTSTR Principal <br>    ); <br> <br>DWORD <br>GetCurrentUserSID ( <br>    PSID *Sid <br>    ); <br> <br>DWORD <br>GetPrincipalSID ( <br>    LPTSTR Principal, <br>    PSID *Sid <br>    ); <br> <br>DWORD <br>CopyACL ( <br>    PACL OldACL, <br>    PACL NewACL <br>    ); <br> <br>DWORD <br>AddAccessDeniedACEToACL ( <br>    PACL *Acl, <br>    DWORD PermissionMask, <br>    LPTSTR Principal <br>    ); <br> <br>DWORD <br>AddAccessAllowedACEToACL ( <br>    PACL *Acl, <br>    DWORD PermissionMask, <br>    LPTSTR Principal <br>    ); <br> <br>DWORD <br>RemovePrincipalFromACL ( <br>    PACL Acl, <br>    LPTSTR Principal <br>    ); <br> <br>void <br>ListACL ( <br>    PACL Acl <br>    ); <br> <br>DWORD <br>SetAccountRights ( <br>    LPTSTR User, <br>    LPTSTR Privilege <br>    ); <br> <br>// <br>// Utility Functions <br>// <br> <br>LPTSTR <br>SystemMessage ( <br>    LPTSTR szBuffer, <br>    HRESULT hr <br>    ); <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
