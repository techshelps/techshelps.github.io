<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>VBBANK.FRM</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context1212"></a>VBBANK.FRM</h2>
<pre><code>VERSION 5.00 <br>Begin VB.Form Form1  <br>   AutoRedraw      =   -1  'True <br>   BorderStyle     =   1  'Fixed Single <br>   Caption         =   "Sample Bank - Visual Basic" <br>   ClientHeight    =   4320 <br>   ClientLeft      =   5040 <br>   ClientTop       =   5325 <br>   ClientWidth     =   8205 <br>   LinkTopic       =   "Form1" <br>   MaxButton       =   0   'False <br>   MinButton       =   0   'False <br>   PaletteMode     =   1  'UseZOrder <br>   ScaleHeight     =   4320 <br>   ScaleWidth      =   8205 <br>   Begin VB.Frame Frame7  <br>      Caption         =   "Language" <br>      Height          =   735 <br>      Left            =   5760 <br>      TabIndex        =   32 <br>      Top             =   2280 <br>      Width           =   2415 <br>      Begin VB.OptionButton VB  <br>         Caption         =   "VB" <br>         Height          =   255 <br>         Left            =   600 <br>         TabIndex        =   35 <br>         Top             =   360 <br>         Width           =   255 <br>      End <br>      Begin VB.OptionButton VC  <br>         Caption         =   "Option2" <br>         Height          =   255 <br>         Left            =   1320 <br>         TabIndex        =   34 <br>         Top             =   360 <br>         Width           =   255 <br>      End <br>      Begin VB.OptionButton VJ  <br>         Caption         =   "Option3" <br>         Height          =   375 <br>         Left            =   2040 <br>         TabIndex        =   33 <br>         Top             =   240 <br>         Width           =   255 <br>      End <br>      Begin VB.Label Label12  <br>         Alignment       =   2  'Center <br>         Caption         =   "Visual Basic" <br>         Height          =   375 <br>         Left            =   120 <br>         TabIndex        =   38 <br>         Top             =   240 <br>         Width           =   495 <br>      End <br>      Begin VB.Label Label11  <br>         Alignment       =   2  'Center <br>         Caption         =   "Visual C++" <br>         Height          =   375 <br>         Left            =   840 <br>         TabIndex        =   37 <br>         Top             =   240 <br>         Width           =   495 <br>      End <br>      Begin VB.Label Label10  <br>         Alignment       =   2  'Center <br>         Caption         =   "Visual J++" <br>         Height          =   375 <br>         Left            =   1560 <br>         TabIndex        =   36 <br>         Top             =   240 <br>         Width           =   495 <br>      End <br>   End <br>   Begin VB.Frame Frame6  <br>      Caption         =   "Component" <br>      Height          =   975 <br>      Left            =   5760 <br>      TabIndex        =   27 <br>      Top             =   1320 <br>      Width           =   2415 <br>      Begin VB.OptionButton StatefulMoveMoney  <br>         Caption         =   "Option2" <br>         Height          =   255 <br>         Left            =   2040 <br>         TabIndex        =   40 <br>         Top             =   600 <br>         Width           =   255 <br>      End <br>      Begin VB.OptionButton MoveMoney  <br>         Caption         =   "Option2" <br>         Height          =   255 <br>         Left            =   2040 <br>         TabIndex        =   31 <br>         Top             =   240 <br>         Width           =   255 <br>      End <br>      Begin VB.OptionButton Account  <br>         Caption         =   "VB" <br>         Height          =   255 <br>         Left            =   840 <br>         TabIndex        =   29 <br>         Top             =   240 <br>         Width           =   255 <br>      End <br>      Begin VB.Label Label6  <br>         Alignment       =   2  'Center <br>         Caption         =   "Stateful MoveMoney" <br>         Height          =   255 <br>         Index           =   1 <br>         Left            =   480 <br>         TabIndex        =   39 <br>         Top             =   600 <br>         Width           =   1575 <br>      End <br>      Begin VB.Label Label6  <br>         Alignment       =   2  'Center <br>         Caption         =   "MoveMoney" <br>         Height          =   255 <br>         Index           =   0 <br>         Left            =   1080 <br>         TabIndex        =   30 <br>         Top             =   240 <br>         Width           =   975 <br>      End <br>      Begin VB.Label Label5  <br>         Alignment       =   2  'Center <br>         Caption         =   "Account" <br>         Height          =   255 <br>         Left            =   120 <br>         TabIndex        =   28 <br>         Top             =   240 <br>         Width           =   735 <br>      End <br>   End <br>   Begin VB.Frame Frame5  <br>      Caption         =   "Response (sec)" <br>      Height          =   975 <br>      Left            =   0 <br>      TabIndex        =   17 <br>      Top             =   2040 <br>      Width           =   5655 <br>      Begin VB.TextBox AvgResp  <br>         Enabled         =   0   'False <br>         Height          =   285 <br>         Left            =   4680 <br>         TabIndex        =   22 <br>         Top             =   360 <br>         Width           =   615 <br>      End <br>      Begin VB.TextBox MaxResp  <br>         Enabled         =   0   'False <br>         Height          =   285 <br>         Left            =   2880 <br>         TabIndex        =   20 <br>         Top             =   360 <br>         Width           =   615 <br>      End <br>      Begin VB.TextBox MinResp  <br>         Enabled         =   0   'False <br>         Height          =   285 <br>         Left            =   960 <br>         TabIndex        =   18 <br>         Top             =   360 <br>         Width           =   615 <br>      End <br>      Begin VB.Label AvgRespCap  <br>         Caption         =   "Average" <br>         Height          =   255 <br>         Left            =   3840 <br>         TabIndex        =   23 <br>         Top             =   360 <br>         Width           =   735 <br>      End <br>      Begin VB.Label Label4  <br>         Caption         =   "Maximum" <br>         Height          =   255 <br>         Left            =   2160 <br>         TabIndex        =   21 <br>         Top             =   360 <br>         Width           =   735 <br>      End <br>      Begin VB.Label Label7  <br>         Caption         =   "Minimum" <br>         Height          =   255 <br>         Left            =   240 <br>         TabIndex        =   19 <br>         Top             =   360 <br>         Width           =   735 <br>      End <br>   End <br>   Begin VB.Frame Frame3  <br>      Caption         =   "Result" <br>      Height          =   1095 <br>      Left            =   0 <br>      TabIndex        =   15 <br>      Top             =   3120 <br>      Width           =   8175 <br>      Begin VB.TextBox Result  <br>         Height          =   735 <br>         Left            =   120 <br>         MultiLine       =   -1  'True <br>         TabIndex        =   16 <br>         Top             =   240 <br>         Width           =   7935 <br>      End <br>   End <br>   Begin VB.Frame Frame2  <br>      Caption         =   "Iterations" <br>      Height          =   615 <br>      Left            =   2760 <br>      TabIndex        =   12 <br>      Top             =   1320 <br>      Width           =   2895 <br>      Begin VB.CheckBox Step  <br>         Caption         =   "Check1" <br>         Height          =   255 <br>         Left            =   2520 <br>         TabIndex        =   41 <br>         Top             =   240 <br>         Width           =   255 <br>      End <br>      Begin VB.TextBox nCurTrans  <br>         Enabled         =   0   'False <br>         Height          =   285 <br>         Left            =   240 <br>         TabIndex        =   26 <br>         Text            =   "11111" <br>         Top             =   240 <br>         Width           =   615 <br>      End <br>      Begin VB.TextBox nTrans  <br>         Height          =   285 <br>         Left            =   1200 <br>         TabIndex        =   7 <br>         Top             =   240 <br>         Width           =   615 <br>      End <br>      Begin VB.Label Label13  <br>         Caption         =   "&amp;Step" <br>         Height          =   255 <br>         Left            =   2040 <br>         TabIndex        =   43 <br>         Top             =   240 <br>         Width           =   375 <br>      End <br>      Begin VB.Label Label9  <br>         Caption         =   "Label9" <br>         Height          =   15 <br>         Left            =   2040 <br>         TabIndex        =   42 <br>         Top             =   360 <br>         Width           =   15 <br>      End <br>      Begin VB.Label Label8  <br>         Caption         =   "&amp;of" <br>         Height          =   255 <br>         Left            =   960 <br>         TabIndex        =   13 <br>         Top             =   240 <br>         Width           =   135 <br>      End <br>   End <br>   Begin VB.CommandButton Close  <br>      Cancel          =   -1  'True <br>      Caption         =   "&amp;Close" <br>      Height          =   375 <br>      Left            =   5760 <br>      TabIndex        =   9 <br>      Top             =   720 <br>      Width           =   2415 <br>   End <br>   Begin VB.CommandButton Command1  <br>      Caption         =   "&amp;Submit" <br>      Default         =   -1  'True <br>      Height          =   375 <br>      Index           =   0 <br>      Left            =   5760 <br>      TabIndex        =   8 <br>      Top             =   240 <br>      Width           =   2415 <br>   End <br>   Begin VB.Frame Frame4  <br>      Caption         =   "Transaction Type" <br>      Height          =   615 <br>      Left            =   0 <br>      TabIndex        =   3 <br>      Top             =   1320 <br>      Width           =   2655 <br>      Begin VB.OptionButton Transfer  <br>         Caption         =   "Trans&amp;fer" <br>         Height          =   315 <br>         Left            =   1680 <br>         TabIndex        =   6 <br>         Top             =   240 <br>         Width           =   915 <br>      End <br>      Begin VB.OptionButton Credit  <br>         Caption         =   "&amp;Credit" <br>         Height          =   315 <br>         Left            =   240 <br>         TabIndex        =   4 <br>         Top             =   240 <br>         Value           =   -1  'True <br>         Width           =   735 <br>      End <br>      Begin VB.OptionButton Debit  <br>         Caption         =   "&amp;Debit" <br>         Height          =   315 <br>         Left            =   960 <br>         TabIndex        =   5 <br>         Top             =   240 <br>         Width           =   735 <br>      End <br>   End <br>   Begin VB.Frame Frame1  <br>      Caption         =   "Your Account Information" <br>      Height          =   1095 <br>      Left            =   0 <br>      TabIndex        =   0 <br>      Top             =   120 <br>      Width           =   5655 <br>      Begin VB.TextBox PrimeAcct  <br>         Height          =   285 <br>         Left            =   1860 <br>         TabIndex        =   1 <br>         Top             =   360 <br>         Width           =   1215 <br>      End <br>      Begin VB.TextBox SecondAcct  <br>         Enabled         =   0   'False <br>         Height          =   285 <br>         Left            =   1860 <br>         TabIndex        =   14 <br>         Top             =   720 <br>         Width           =   1215 <br>      End <br>      Begin VB.TextBox Amount  <br>         Height          =   285 <br>         Left            =   4200 <br>         TabIndex        =   2 <br>         Top             =   360 <br>         Width           =   1215 <br>      End <br>      Begin VB.Label promptSecondAcct  <br>         Alignment       =   1  'Right Justify <br>         Caption         =   "&amp;Transfer to Account " <br>         Enabled         =   0   'False <br>         Height          =   315 <br>         Left            =   240 <br>         TabIndex        =   25 <br>         Top             =   720 <br>         Width           =   1515 <br>      End <br>      Begin VB.Label Label1  <br>         Alignment       =   1  'Right Justify <br>         Caption         =   "&amp;Account Number" <br>         Height          =   315 <br>         Left            =   240 <br>         TabIndex        =   24 <br>         Top             =   360 <br>         Width           =   1515 <br>      End <br>      Begin VB.Label Label3  <br>         Caption         =   "Label3" <br>         Height          =   15 <br>         Left            =   300 <br>         TabIndex        =   11 <br>         Top             =   2100 <br>         Width           =   615 <br>      End <br>      Begin VB.Label Label2  <br>         Alignment       =   1  'Right Justify <br>         Caption         =   "A&amp;mount" <br>         Height          =   315 <br>         Left            =   3240 <br>         TabIndex        =   10 <br>         Top             =   360 <br>         Width           =   915 <br>      End <br>   End <br>End <br>Attribute VB_Name = "Form1" <br>Attribute VB_GlobalNameSpace = False <br>Attribute VB_Creatable = False <br>Attribute VB_PredeclaredId = True <br>Attribute VB_Exposed = False <br>' Filename: Bank.vbp <br>' <br>' Description: Sample bank client <br>' <br>' This file is provided as part of the Microsoft Transaction Server Samples <br>' <br>' THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT <br>' WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, <br>' INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES <br>' OF MERCHANTABILITY AND/OR FITNESS FOR A  PARTICULAR <br>' PURPOSE. <br>' <br>' Copyright (C) 1997 Microsoft Corporation, All rights reserved <br> <br>Option Explicit <br>Private Const APP_ERROR = -2147467008 <br> <br>' Timer Variables <br>Private Declare Function GetTickCount Lib "kernel32" () As Long <br>Private Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long) <br>Private StartTime As Long <br>Private Elapsed As Long <br>Private AvgResponseTime As Long <br>Private minRespTime As Long <br>Private maxRespTime As Long <br>Private lRet As Long <br>Private Res As Variant <br> <br>Private Sub Account_Click() <br>    VC.Enabled = True <br>    VJ.Enabled = True <br>    Transfer.Enabled = False <br>End Sub <br> <br>Private Sub Close_Click() <br>    End <br>End Sub <br> <br>Private Sub Command1_Click(Index As Integer) <br>    Dim lSecondAcct As Long <br>    Dim TranType As String <br>     <br>    Screen.MousePointer = 11 <br>    On Error GoTo ErrorHandler <br>     <br>    ' Decide which component to use <br>    Dim ProgID As String <br>    If Account = True Then <br>        ProgID = "Bank.Account" <br>    Else <br>        ProgID = "Bank.MoveMoney" <br>    End If <br>     <br>    ' Decide which language to use <br>    If VC = True Then <br>        ProgID = ProgID + ".VC" <br>    ElseIf VJ = True Then <br>        ProgID = ProgID + ".VJ" <br>    End If <br>     <br>    ' Decide transaction type <br>    Result = "" <br>    lSecondAcct = 0 <br>    Dim Mult As Long <br>    If Debit = True Then <br>        TranType = 1 <br>        Mult = -1 <br>    ElseIf Credit = True Then <br>        TranType = 2 <br>        Mult = 1 <br>    Else <br>        If ProgID = "Bank.Account" Then <br>            MsgBox "Error. Use MoveMoney component to transfer." <br>            MoveMoney.SetFocus <br>            Screen.MousePointer = 0 <br>            Exit Sub <br>        End If <br>        If SecondAcct = "" Then <br>            MsgBox "Error. Transfer to Account must be filled in." <br>            SecondAcct.SetFocus <br>            Screen.MousePointer = 0 <br>            Exit Sub <br>        Else <br>            TranType = 3 <br>            lSecondAcct = CLng(SecondAcct) <br>        End If <br>    End If <br>    <br>    ' Create the appropriate MoveMoney object <br>    On Error GoTo objError <br>    Dim obj As Object <br>    Set obj = CreateObject(ProgID) <br>    On Error GoTo ErrorHandler <br>     <br>    If obj Is Nothing Then <br>        Screen.MousePointer = 0 <br>        MsgBox "Create object " + ProgID + "failed." <br>        Exit Sub <br>    End If <br>     <br>    InitTimer <br>     <br>    ' Call the object <br>    Dim i As Long <br>    For i = 1 To nTrans <br>        StartTimer <br>        Res = "" <br>        If Account = True Then <br>            Res = obj.Post(CLng(PrimeAcct), CLng(Amount * Mult)) <br>        ElseIf MoveMoney = True Then <br>            Res = obj.Perform(CLng(PrimeAcct), lSecondAcct, CLng(Amount), TranType) <br>        Else <br>            obj.PrimeAccount = PrimeAcct <br>            obj.SecondAccount = lSecondAcct <br>            Res = obj.StatefulPerform(CLng(Amount), TranType) <br>        End If <br>        EndTimer <br>        nCurTrans = i <br>        Result = Res <br>        If lRet &lt;&gt; 0 Then <br>            Exit For <br>        End If <br>        If Step = 1 And i &lt;&gt; nTrans Then <br>            MsgBox "Step mode, OK to continue" <br>        End If <br>    Next i <br>     <br>    FinishTimer <br>     <br>    Set obj = Nothing <br>   <br>    Result = Res <br>    Screen.MousePointer = 0 <br>    Exit Sub <br>     <br>objError: <br>    MsgBox "Error " &amp; Err.Number &amp; ": Make sure the Sample Bank package has been correctly installed in MTS." <br>    Screen.MousePointer = 0 <br>    Err.Clear <br>    Exit Sub <br>     <br>ErrorHandler: <br>    Screen.MousePointer = 0 <br>    MsgBox Err.Number &amp; "(" &amp; Err.Source &amp; ") :" &amp; Err.Description <br>    Err.Clear <br> <br>End Sub <br> <br>Private Sub Credit_Click() <br>    SecondAcct.Enabled = False <br>    promptSecondAcct.Enabled = False <br>    SecondAcct = "" <br>    Account.Enabled = True <br>End Sub <br>Private Sub Debit_Click() <br>    SecondAcct.Enabled = False <br>    promptSecondAcct.Enabled = False <br>    SecondAcct = "" <br>    Account.Enabled = True <br>End Sub <br>Private Sub Form_Load() <br>    PrimeAcct = 1 <br>    SecondAcct = "" <br>    Amount = 1 <br>    Result = "" <br>    Debit = 0 <br>    Credit = 1 <br>    Transfer = 0 <br>    MoveMoney = 1 <br>    VB = 1 <br>    nCurTrans = 0 <br>    nTrans = 1 <br>    Step = 0 <br>    MinResp = 0 <br>    MaxResp = 0 <br>    AvgResp = 0 <br>End Sub <br> <br>Private Sub MoveMoney_Click() <br>    VC.Enabled = True <br>    VJ.Enabled = True <br>    Transfer.Enabled = True <br>End Sub <br> <br>Private Sub transfer_Click() <br>    SecondAcct.Enabled = True <br>    promptSecondAcct.Enabled = True <br>    Account.Enabled = False <br>End Sub <br> <br>Public Sub StartTimer() <br>    StartTime = GetTickCount() <br>End Sub <br> <br>Public Sub EndTimer() <br>    Elapsed = GetTickCount - StartTime <br>    If Elapsed &lt; minRespTime Then minRespTime = Elapsed <br>    If Elapsed &gt; maxRespTime Then maxRespTime = Elapsed <br>    AvgResponseTime = AvgResponseTime + Elapsed <br>End Sub <br> <br>Public Sub FinishTimer() <br>    AvgResponseTime = AvgResponseTime / nTrans <br>    AvgResp = Format(AvgResponseTime / 1000, "#0.###") <br>    MinResp = Format(minRespTime / 1000, "#0.###") <br>    MaxResp = Format(maxRespTime / 1000, "#0.###") <br>    Form1.Refresh <br>End Sub <br>Public Sub InitTimer() <br>    minRespTime = 99999999 <br>    maxRespTime = 0 <br>    AvgResponseTime = 0 <br>End Sub <br> <br>Private Sub VC_Click() <br>    StatefulMoveMoney.Enabled = False <br>End Sub <br> <br>Private Sub VJ_Click() <br>    StatefulMoveMoney.Enabled = False <br>End Sub <br> <br>Private Sub VB_Click() <br>    StatefulMoveMoney.Enabled = True <br>End Sub <br>Private Sub StatefulMoveMoney_Click() <br>    VC.Enabled = False <br>    VJ.Enabled = False <br>    Transfer.Enabled = True <br>End Sub <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
