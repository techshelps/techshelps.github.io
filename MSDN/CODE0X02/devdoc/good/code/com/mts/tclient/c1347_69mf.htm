<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>FRMMAIN.FRM</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context1347"></a>FRMMAIN.FRM</h2>
<pre><code>VERSION 5.00 <br>Begin VB.Form frmMain  <br>   AutoRedraw      =   -1  'True <br>   BorderStyle     =   3  'Fixed Dialog <br>   Caption         =   "Tic-Tac-Toe client" <br>   ClientHeight    =   5550 <br>   ClientLeft      =   45 <br>   ClientTop       =   330 <br>   ClientWidth     =   9300 <br>   LinkTopic       =   "Form1" <br>   MaxButton       =   0   'False <br>   MinButton       =   0   'False <br>   ScaleHeight     =   6366.517 <br>   ScaleMode       =   0  'User <br>   ScaleWidth      =   9423.598 <br>   ShowInTaskbar   =   0   'False <br>   StartUpPosition =   2  'CenterScreen <br>   Begin VB.TextBox lossesT  <br>      Height          =   375 <br>      Left            =   5280 <br>      Locked          =   -1  'True <br>      TabIndex        =   16 <br>      Text            =   "0" <br>      Top             =   3000 <br>      Width           =   375 <br>   End <br>   Begin VB.TextBox tiesT  <br>      Height          =   375 <br>      Left            =   4680 <br>      Locked          =   -1  'True <br>      TabIndex        =   15 <br>      Text            =   "0" <br>      Top             =   3000 <br>      Width           =   375 <br>   End <br>   Begin VB.TextBox winsT  <br>      Height          =   375 <br>      Left            =   4080 <br>      Locked          =   -1  'True <br>      TabIndex        =   12 <br>      Text            =   "0" <br>      Top             =   3000 <br>      Width           =   375 <br>   End <br>   Begin VB.OptionButton Hard  <br>      Caption         =   "Hard" <br>      Height          =   255 <br>      Left            =   4440 <br>      TabIndex        =   10 <br>      Top             =   1440 <br>      Value           =   -1  'True <br>      Width           =   1095 <br>   End <br>   Begin VB.OptionButton Easy  <br>      Caption         =   "Easy" <br>      Height          =   255 <br>      Left            =   4440 <br>      TabIndex        =   9 <br>      Top             =   1800 <br>      Width           =   855 <br>   End <br>   Begin VB.TextBox Nombre  <br>      Height          =   285 <br>      Left            =   4440 <br>      TabIndex        =   8 <br>      Top             =   600 <br>      Width           =   1335 <br>   End <br>   Begin VB.Timer ServerPoll  <br>      Enabled         =   0   'False <br>      Interval        =   300 <br>      Left            =   3840 <br>      Top             =   0 <br>   End <br>   Begin VB.TextBox Result  <br>      Height          =   285 <br>      Left            =   120 <br>      Locked          =   -1  'True <br>      TabIndex        =   7 <br>      Top             =   5160 <br>      Width           =   5895 <br>   End <br>   Begin VB.CommandButton Exit  <br>      Caption         =   "Exit Tic-Tac-Toe" <br>      BeginProperty Font  <br>         Name            =   "Arial" <br>         Size            =   8.25 <br>         Charset         =   0 <br>         Weight          =   400 <br>         Underline       =   0   'False <br>         Italic          =   0   'False <br>         Strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   375 <br>      Left            =   3960 <br>      TabIndex        =   5 <br>      Top             =   4560 <br>      Width           =   2055 <br>   End <br>   Begin VB.TextBox Name2  <br>      Height          =   315 <br>      Left            =   2520 <br>      Locked          =   -1  'True <br>      TabIndex        =   4 <br>      Top             =   600 <br>      Width           =   1215 <br>   End <br>   Begin VB.TextBox Name1  <br>      Height          =   285 <br>      Left            =   120 <br>      Locked          =   -1  'True <br>      TabIndex        =   3 <br>      Top             =   600 <br>      Width           =   1215 <br>   End <br>   Begin VB.CommandButton PlayHuman  <br>      Caption         =   "Play against a Human" <br>      BeginProperty Font  <br>         Name            =   "Arial" <br>         Size            =   8.25 <br>         Charset         =   0 <br>         Weight          =   400 <br>         Underline       =   0   'False <br>         Italic          =   0   'False <br>         Strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   375 <br>      Left            =   3960 <br>      TabIndex        =   1 <br>      Top             =   4080 <br>      Width           =   2055 <br>   End <br>   Begin VB.CommandButton PlayComputer  <br>      Caption         =   "Play against the computer" <br>      BeginProperty Font  <br>         Name            =   "Arial" <br>         Size            =   8.25 <br>         Charset         =   0 <br>         Weight          =   400 <br>         Underline       =   0   'False <br>         Italic          =   0   'False <br>         Strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   375 <br>      Left            =   3960 <br>      TabIndex        =   0 <br>      Top             =   3600 <br>      Width           =   2055 <br>   End <br>   Begin VB.Image bmpSmallX  <br>      Height          =   315 <br>      Left            =   8640 <br>      Picture         =   "frmMain.frx":0000 <br>      Top             =   2400 <br>      Visible         =   0   'False <br>      Width           =   315 <br>   End <br>   Begin VB.Image bmpSmallO  <br>      Height          =   315 <br>      Left            =   8160 <br>      Picture         =   "frmMain.frx":017E <br>      Top             =   2400 <br>      Visible         =   0   'False <br>      Width           =   315 <br>   End <br>   Begin VB.Image bmpNull  <br>      Height          =   315 <br>      Left            =   8400 <br>      Picture         =   "frmMain.frx":02FC <br>      Top             =   2880 <br>      Visible         =   0   'False <br>      Width           =   315 <br>   End <br>   Begin VB.Image bmpBigX  <br>      Height          =   900 <br>      Left            =   8040 <br>      Picture         =   "frmMain.frx":047A <br>      Top             =   1200 <br>      Visible         =   0   'False <br>      Width           =   900 <br>   End <br>   Begin VB.Image bmpBigO  <br>      Height          =   900 <br>      Left            =   8040 <br>      Picture         =   "frmMain.frx":0C7C <br>      Top             =   120 <br>      Visible         =   0   'False <br>      Width           =   900 <br>   End <br>   Begin VB.Image Image12  <br>      Height          =   900 <br>      Left            =   1440 <br>      Top             =   3960 <br>      Width           =   900 <br>   End <br>   Begin VB.Label Label4  <br>      Caption         =   "Losses" <br>      Height          =   255 <br>      Left            =   5280 <br>      TabIndex        =   18 <br>      Top             =   2640 <br>      Width           =   495 <br>   End <br>   Begin VB.Label Label3  <br>      Caption         =   "Ties" <br>      Height          =   255 <br>      Left            =   4680 <br>      TabIndex        =   17 <br>      Top             =   2640 <br>      Width           =   375 <br>   End <br>   Begin VB.Label Label2  <br>      Caption         =   "Wins" <br>      Height          =   255 <br>      Left            =   4080 <br>      TabIndex        =   14 <br>      Top             =   2640 <br>      Width           =   375 <br>   End <br>   Begin VB.Label SessionLabel  <br>      Caption         =   "This session:" <br>      Height          =   255 <br>      Left            =   4440 <br>      TabIndex        =   13 <br>      Top             =   2280 <br>      Width           =   975 <br>   End <br>   Begin VB.Label ComputerLabel  <br>      Caption         =   "Select degree of difficulty" <br>      Height          =   255 <br>      Left            =   4320 <br>      TabIndex        =   11 <br>      Top             =   1080 <br>      Width           =   1935 <br>   End <br>   Begin VB.Image Image02  <br>      Height          =   900 <br>      Left            =   240 <br>      Top             =   3960 <br>      Width           =   900 <br>   End <br>   Begin VB.Image Image22  <br>      Height          =   900 <br>      Left            =   2760 <br>      Top             =   3960 <br>      Width           =   900 <br>   End <br>   Begin VB.Image Image21  <br>      Height          =   900 <br>      Left            =   2760 <br>      Top             =   2640 <br>      Width           =   900 <br>   End <br>   Begin VB.Image Image10  <br>      Height          =   915 <br>      Left            =   1440 <br>      Top             =   1320 <br>      Width           =   945 <br>   End <br>   Begin VB.Image Image20  <br>      Height          =   900 <br>      Left            =   2760 <br>      Top             =   1320 <br>      Width           =   900 <br>   End <br>   Begin VB.Image Image01  <br>      Height          =   900 <br>      Left            =   240 <br>      Top             =   2640 <br>      Width           =   900 <br>   End <br>   Begin VB.Image Image11  <br>      Height          =   900 <br>      Left            =   1440 <br>      Top             =   2640 <br>      Width           =   900 <br>   End <br>   Begin VB.Image Image00  <br>      Height          =   900 <br>      Left            =   240 <br>      Top             =   1320 <br>      Width           =   900 <br>   End <br>   Begin VB.Label NameLabel  <br>      Caption         =   "Your name is..." <br>      Height          =   255 <br>      Left            =   4560 <br>      TabIndex        =   6 <br>      Top             =   240 <br>      Width           =   1095 <br>   End <br>   Begin VB.Image Player2  <br>      Height          =   315 <br>      Left            =   3000 <br>      Top             =   120 <br>      Width           =   315 <br>   End <br>   Begin VB.Image Player1  <br>      Height          =   315 <br>      Left            =   600 <br>      Top             =   120 <br>      Width           =   315 <br>   End <br>   Begin VB.Image GameScreen  <br>      Height          =   3615 <br>      Left            =   120 <br>      Picture         =   "frmMain.frx":147E <br>      Top             =   1320 <br>      Width           =   3615 <br>   End <br>   Begin VB.Label Label1  <br>      Caption         =   "Versus" <br>      Height          =   255 <br>      Left            =   1680 <br>      TabIndex        =   2 <br>      Top             =   360 <br>      Width           =   495 <br>   End <br>End <br>Attribute VB_Name = "frmMain" <br>Attribute VB_GlobalNameSpace = False <br>Attribute VB_Creatable = False <br>Attribute VB_PredeclaredId = True <br>Attribute VB_Exposed = False <br>' Filename: tClient.vbp <br>' <br>' Description:  Tic-Tac-Toe Client <br>' <br>' This file is provided as part of the Microsoft Transaction Server <br>' Software Development Kit <br>' <br>' THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT <br>' WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, <br>' INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES <br>' OF MERCHANTABILITY AND/OR FITNESS FOR A  PARTICULAR <br>' PURPOSE. <br>' <br>' Copyright (C) 1997 Microsoft Corporation, All rights reserved <br> <br>Option Explicit <br> <br>Private viper As Boolean <br>Private organic As Boolean <br>Private playing As Boolean <br>Private gameID As Long <br>Private localX As Long <br>Private localY As Long <br>Private localOrder As Long <br>Private localName As String <br>Private remoteName As String <br>Private easyComputer As Boolean <br>Private wins As Long <br>Private ties As Long <br>Private losses As Long <br> <br>Private localPic As Picture <br>Private remotePic As Picture <br> <br>Private full(3, 3) As Long <br>Private waiting As Boolean <br> <br>Private Sub Easy_Click() <br>    easyComputer = True <br>End Sub <br> <br>Private Sub Form_Load() <br>    Me.Left = GetSetting(App.Title, "Settings", "MainLeft", 1000) <br>    Me.Top = GetSetting(App.Title, "Settings", "MainTop", 1000) <br>    Me.Width = GetSetting(App.Title, "Settings", "MainWidth", 6500) <br>    Me.Height = GetSetting(App.Title, "Settings", "MainHeight", 6500) <br>     <br>    ' Make sure the Tic-Tac-Toe components are properly installed in MTS <br>    On Error GoTo objError <br>    Dim computer As Object <br>    Dim human As Object <br>    Set computer = CreateObject("tServer.Computer") <br>    Set human = CreateObject("tServer.Human") <br>    On Error GoTo 0 <br>     <br>    ' Init <br>    localName = "tClient User" <br>    remoteName = "No one" <br>    viper = False <br>    organic = False <br>    playing = False <br>    gameID = -1 <br>    waiting = False <br>    ServerPoll.Enabled = False <br>    easyComputer = False <br>    wins = 0 <br>    ties = 0 <br>    losses = 0 <br>     <br>    Nombre = localName <br>    Name1 = "No one" <br>    Name2 = remoteName <br>    Player1.Picture = bmpNull <br>    Player2.Picture = bmpNull <br>    Result = "Press a button and start a game" <br>     <br>    Exit Sub <br>     <br>objError: <br>    MsgBox "Error " &amp; Err.Number &amp; ": Make sure the Tic-Tac-Toe package has been correctly installed in MTS." <br>    End <br>End Sub <br> <br> <br>Private Sub Form_Unload(Cancel As Integer) <br>    Dim i As Integer <br> <br>    'Close all sub forms <br>    For i = Forms.Count - 1 To 1 Step -1 <br>        Unload Forms(i) <br>    Next <br>    If Me.WindowState &lt;&gt; vbMinimized Then <br>        SaveSetting App.Title, "Settings", "MainLeft", Me.Left <br>        SaveSetting App.Title, "Settings", "MainTop", Me.Top <br>        SaveSetting App.Title, "Settings", "MainWidth", Me.Width <br>        SaveSetting App.Title, "Settings", "MainHeight", Me.Height <br>    End If <br>End Sub <br> <br>Private Sub Hard_Click() <br>    easyComputer = False <br>End Sub <br> <br>Private Sub Image00_Click() <br>     <br>    If playing And full(0, 0) = 0 Then <br>        If localOrder = 1 Then <br>            Image00.Picture = bmpBigX <br>        Else <br>            Image00.Picture = bmpBigO <br>        End If <br>     <br>        MovePiece 0, 0 <br>    End If <br>     <br>End Sub <br> <br>Private Sub Image01_Click() <br>     <br>    If playing And full(0, 1) = 0 Then <br>        If localOrder = 1 Then <br>            Image01.Picture = bmpBigX <br>        Else <br>            Image01.Picture = bmpBigO <br>        End If <br>     <br>        MovePiece 0, 1 <br>    End If <br>     <br>End Sub <br> <br>Private Sub Image02_Click() <br> <br>    If playing And full(0, 2) = 0 Then <br>        If localOrder = 1 Then <br>            Image02.Picture = bmpBigX <br>        Else <br>            Image02.Picture = bmpBigO <br>        End If <br>     <br>        MovePiece 0, 2 <br>    End If <br>     <br>End Sub <br> <br>Private Sub Image10_Click() <br>     <br>    If playing And full(1, 0) = 0 Then <br>        If localOrder = 1 Then <br>            Image10.Picture = bmpBigX <br>        Else <br>            Image10.Picture = bmpBigO <br>        End If <br>     <br>        MovePiece 1, 0 <br>    End If <br>     <br>End Sub <br> <br>Private Sub Image11_Click() <br> <br>    If playing And full(1, 1) = 0 Then <br>        If (localOrder = 1) Then <br>            Image11.Picture = bmpBigX <br>        Else <br>            Image11.Picture = bmpBigO <br>        End If <br>     <br>        MovePiece 1, 1 <br>    End If <br>     <br>End Sub <br> <br>Private Sub Image12_Click() <br>     <br>    If playing And full(1, 2) = 0 Then <br>        If localOrder = 1 Then <br>            Image12.Picture = bmpBigX <br>        Else <br>            Image12.Picture = bmpBigO <br>        End If <br>     <br>        MovePiece 1, 2 <br>    End If <br>     <br>End Sub <br> <br>Private Sub Image20_Click() <br>     <br>    If playing And full(2, 0) = 0 Then <br>        If localOrder = 1 Then <br>            Image20.Picture = bmpBigX <br>        Else <br>            Image20.Picture = bmpBigO <br>        End If <br>     <br>        MovePiece 2, 0 <br>    End If <br>     <br>End Sub <br> <br>Private Sub Image21_Click() <br>     <br>    If playing And full(2, 1) = 0 Then <br>        If localOrder = 1 Then <br>            Image21.Picture = bmpBigX <br>        Else <br>            Image21.Picture = bmpBigO <br>        End If <br>     <br>        MovePiece 2, 1 <br>    End If <br>     <br>End Sub <br> <br>Private Sub Image22_Click() <br>     <br>    If playing And full(2, 2) = 0 Then <br>        If localOrder = 1 Then <br>            Image22.Picture = bmpBigX <br>        Else <br>            Image22.Picture = bmpBigO <br>        End If <br>     <br>        MovePiece 2, 2 <br>    End If <br>     <br>End Sub <br> <br>Private Sub Nombre_Change() <br>    localName = Nombre <br>End Sub <br> <br> <br>Private Sub PlayHuman_Click() <br>       <br>    ' Present hourglass pointer <br>    Me.MousePointer = vbHourglass <br>     <br>    ' Clean up screen <br>    ClearScreen <br>    InitArray <br>     <br>    ' Create server human object <br>    Dim human As Object <br>    Set human = CreateObject("tServer.Human") <br>    If human Is Nothing Then <br>        MsgBox "Create object " + "tServer.Human" + " failed." <br>        Exit Sub <br>    End If <br>     <br>    ' Notify server of new game <br>    Dim order As Variant <br>    Dim player2Name As Variant <br>    Dim gameNumber As Variant <br>    human.EnterNewGame localName, gameNumber, player2Name, order <br>    remoteName = player2Name <br>    gameID = gameNumber <br>     <br>    ' Set up screen <br>    Name1 = localName <br>    Name2 = remoteName <br>    PlayComputer.Enabled = False <br>    PlayHuman.Enabled = False <br>    Nombre.Locked = True <br>    Easy.Enabled = False <br>    Hard.Enabled = False <br>     <br>    ' Set up local variables <br>    viper = False <br>    organic = True <br>    playing = False <br>    ServerPoll.Enabled = True <br>     <br>    ' Set up order <br>    localOrder = order <br>    If order = 1 Then <br>        Player1.Picture = bmpSmallX <br>        Player2.Picture = bmpSmallO <br>        Set localPic = bmpBigX <br>        Set remotePic = bmpBigO <br>        Result = "You are now in game " &amp; gameID &amp; ", we are waiting for another 'human' to join the game." <br>    Else <br>        Player1.Picture = bmpSmallO <br>        Player2.Picture = bmpSmallX <br>        Set localPic = bmpBigO <br>        Set remotePic = bmpBigX <br>        Result = "Game " &amp; gameID &amp; " against '" &amp; remoteName &amp; "' has begun.  Waiting for '" &amp; remoteName &amp; "' to move." <br>        waiting = True <br>    End If <br>     <br>    ' Clean up <br>    Set human = Nothing <br>     <br>    ' Return control <br>    Me.MousePointer = vbArrow <br>     <br>End Sub <br> <br>Private Sub PlayComputer_Click() <br> <br>    ' Present hourglass pointer <br>    Me.MousePointer = vbHourglass <br>     <br>    ' Clean up screen <br>    InitArray <br>    ClearScreen <br>     <br>    ' Create server computer object <br>    Dim computer As Object <br>    Set computer = CreateObject("tServer.Computer") <br>    If computer Is Nothing Then <br>        MsgBox "Create object " + "tServer.Computer" + " failed." <br>        Exit Sub <br>    End If <br>     <br>    ' Notify server of new game <br>    Dim lGameID As Variant <br>    Dim order As Variant <br>    Dim foeX As Variant <br>    Dim foeY As Variant <br>    computer.AddNewGame easyComputer, lGameID, order, foeX, foeY <br>    gameID = lGameID <br> <br>    ' Set up screen <br>    If easyComputer = True Then <br>        remoteName = "I am, I think" <br>    Else <br>        remoteName = "I think I am" <br>    End If <br>    Name1 = localName <br>    Name2 = remoteName <br>    PlayComputer.Enabled = False <br>    PlayHuman.Enabled = False <br>    Nombre.Locked = True <br>    Easy.Enabled = False <br>    Hard.Enabled = False <br>     <br>    ' Set up local variables <br>    viper = True <br>    organic = False <br>    playing = True <br>     <br>    ' Set up order <br>    localOrder = order <br>    If order = 1 Then <br>        Player1.Picture = bmpSmallX <br>        Player2.Picture = bmpSmallO <br>        Set localPic = bmpBigX <br>        Set remotePic = bmpBigO <br> <br>    Else <br>        Player1.Picture = bmpSmallO <br>        Player2.Picture = bmpSmallX <br>        Set localPic = bmpBigO <br>        Set remotePic = bmpBigX <br>        <br>        ' Process opponent's first move <br>        Display remotePic, foeX, foeY <br>        full(foeX, foeY) = 1 <br>         <br>    End If <br>     <br>    ' Clean up <br>    Set computer = Nothing <br>     <br>    ' Return control <br>    Result = "Game " &amp; gameID &amp; " against '" &amp; remoteName &amp; "' has begun.  It is now your turn." <br>    Me.MousePointer = vbArrow <br>     <br>End Sub <br> <br>Private Sub Exit_Click() <br>    ' Notify opponent of exit <br>    End <br>End Sub <br> <br>Private Sub MovePiece(X As Long, Y As Long) <br> <br>    Dim win As Variant <br>    If viper Then <br>         <br>        ' Create server computer object <br>        Dim computer As Object <br>        Set computer = CreateObject("tServer.Computer") <br>        If computer Is Nothing Then <br>            MsgBox "Create object " + "tServer.Computer" + " failed." <br>            Exit Sub <br>        End If <br>     <br>        ' Submit move <br>        Dim foeX As Variant <br>        Dim foeY As Variant <br>        computer.NewMove gameID, easyComputer, X, Y, foeX, foeY, win <br>          <br>        ' Win protocol <br>        ' ============ <br>        ' 0  -&gt; moves did not end game <br>        ' 1  -&gt; player won <br>        ' -1 -&gt; computer won <br>        ' 2  -&gt; player's move tied the game <br>        ' -2 -&gt; computer's move tied the game <br>     <br>        ' Display local move <br>        Display localPic, X, Y <br>        full(X, Y) = 1 <br>         <br>        ' Check for win or loss <br>        If Abs(win) = 1 Then <br>            If win = 1 Then <br>                wins = wins + 1 <br>                winsT = wins <br>                Result = "Congratulations!  You won your game against '" &amp; remoteName &amp; "'." <br>                Cleanup <br>                Exit Sub <br>            Else <br>                Display remotePic, foeX, foeY <br>                losses = losses + 1 <br>                lossesT = losses <br>                Result = "Too bad, '" &amp; remoteName &amp; "' won.  Better luck next time!" <br>                Cleanup <br>                Exit Sub <br>            End If <br>        Else <br>            If Abs(win) = 2 Then <br>                If win = 2 Then <br>                    Display remotePic, foeX, foeY <br>                End If <br>                ties = ties + 1 <br>                tiesT = ties <br>                Result = "You tied '" &amp; remoteName &amp; ".' " &amp; " Keep trying!" <br>                Cleanup <br>                Exit Sub <br>            Else <br>                ' Display opponent's move <br>                Display remotePic, foeX, foeY <br>                full(foeX, foeY) = 1 <br>            End If <br>        End If <br>         <br>        ' Clean up <br>        Set computer = Nothing <br>     <br>        Result = "It is now your turn." <br> <br>    Else <br>     <br>        ' Shut down server polling <br>        ServerPoll.Enabled = False <br>         <br>        ' Create server human object <br>        Dim human As Object <br>        Set human = CreateObject("tServer.Human") <br>        If human Is Nothing Then <br>            MsgBox "Create object " + "tServer.Human" + " failed." <br>            Exit Sub <br>        End If <br>         <br>        ' Submit move <br>        human.NewMove gameID, localOrder, X, Y, win <br>         <br>        ' Win protocol <br>        ' ============ <br>        ' 0  -&gt; move did not end game <br>        ' 1  -&gt; player won <br>        ' -1 -&gt; remote player won (won't occur in this function) <br>        ' 2  -&gt; player's move tied the game <br>        ' -2 -&gt; remote player's move tied the game (won't occur in this function) <br>         <br>        ' Display local move <br>        Display localPic, X, Y <br>        full(X, Y) = 1 <br>         <br>        ' Check for win or loss <br>        If win = 1 Then <br>            wins = wins + 1 <br>            winsT = wins <br>            Result = "Congratulations!  You won your game against '" &amp; remoteName &amp; "'." <br>            Cleanup <br>            Exit Sub <br>        Else <br>            If win = 2 Then <br>                ties = ties + 1 <br>                tiesT = ties <br>                Result = "You tied '" &amp; remoteName &amp; ".' " &amp; " Keep trying!" <br>                Cleanup <br>                Exit Sub <br>            Else <br>                ' Reenable server polling <br>                ServerPoll.Enabled = True <br>            End If <br>        End If <br> <br>        ' We're waiting for a move or we finished the game <br>        playing = False <br>         <br>        ' Clean up <br>        Set human = Nothing <br>         <br>        Result = "Waiting for '" &amp; remoteName &amp; "'s next move." <br>    End If <br> <br>End Sub <br> <br>Private Sub Display(pic As Picture, X As Variant, Y As Variant) <br> <br>    Dim hash As Long <br>    hash = X * 10 + Y <br>     <br>    Select Case hash <br>     <br>        Case 0 <br>            Image00.Picture = pic <br>        Case 1 <br>            Image01.Picture = pic <br>        Case 2 <br>            Image02.Picture = pic <br>        Case 10 <br>            Image10.Picture = pic <br>        Case 11 <br>            Image11.Picture = pic <br>        Case 12 <br>            Image12.Picture = pic <br>        Case 20 <br>            Image20.Picture = pic <br>        Case 21 <br>            Image21.Picture = pic <br>        Case 22 <br>            Image22.Picture = pic <br>        Case Else <br>            MsgBox ("Invalid Display Parameter") <br>             <br>    End Select <br>     <br>End Sub <br> <br>Private Sub Cleanup() <br> <br>    ' Reset variables <br>    playing = False <br>    viper = False <br>    organic = False <br>    PlayHuman.Enabled = True <br>    PlayComputer.Enabled = True <br>    Nombre.Locked = False <br>    Easy.Enabled = True <br>    Hard.Enabled = True <br> <br>End Sub <br> <br>Private Sub InitArray() <br>     <br>    Dim i, j As Long <br>    For i = 0 To 2 <br>        For j = 0 To 2 <br>            full(i, j) = 0 <br>        Next <br>    Next <br> <br>End Sub <br> <br> <br>Private Sub ServerPoll_Timer() <br> <br>    If organic And Not playing Then <br> <br>        ' Create server human object <br>        Dim human As Object <br>        Set human = CreateObject("tServer.Human") <br>        If human Is Nothing Then <br>            MsgBox "Create object " + "tServer.Human" + " failed." <br>            Exit Sub <br>        End If <br>     <br>        ' Poll server <br>        Dim name As Variant <br>        Dim foeX As Variant <br>        Dim foeY As Variant <br>        Dim win As Variant <br>        Dim update As Variant <br>        human.GetNewMove gameID, localOrder, name, foeX, foeY, win, update <br>         <br>        ' Win protocol <br>        ' ============ <br>        ' 0  -&gt; move did not end game <br>        ' 1  -&gt; player won (won't occur in this function) <br>        ' -1 -&gt; remote player won <br>        ' 2  -&gt; player's move tied the game (won't occur in this function) <br>        ' -2 -&gt; remote player's move tied the game <br>     <br>        ' Routine move <br>        If update = 1 Then <br>         <br>            ' Stop polling <br>            ServerPoll.Enabled = False <br>             <br>            ' Display opponent's move <br>            Display remotePic, foeX, foeY <br>            full(foeX, foeY) = 2 <br>             <br>            ' Check for win or loss <br>            If win = -1 Then <br>                losses = losses + 1 <br>                lossesT = losses <br>                Result = "Too bad, '" &amp; remoteName &amp; "' won.  Better luck next time!" <br>                Cleanup <br>                Exit Sub <br>            Else <br>                If win = -2 Then <br>                    ties = ties + 1 <br>                    tiesT = ties + 1 <br>                    Result = "You tied '" &amp; remoteName &amp; ".' " &amp; " Keep trying!" <br>                    Cleanup <br>                    Exit Sub <br>                Else <br>                    Result = "'" &amp; remoteName &amp; "' has moved.  It is now your turn." <br>                    playing = True <br>                End If <br>            End If <br>        Else <br>            ' Player just joined <br>            If update = 2 Then <br>                remoteName = name <br>                Name2 = remoteName <br>                Result = "'" &amp; remoteName &amp; "' has joined your game.  It is now your turn." <br>                playing = True <br>            End If <br>        End If <br>         <br>        ' Clean up <br>        Set human = Nothing <br>     <br>    End If <br> <br>End Sub <br> <br>Private Sub ClearScreen() <br> <br>    Image00.Picture = LoadPicture <br>    Image10.Picture = LoadPicture <br>    Image20.Picture = LoadPicture <br>    Image01.Picture = LoadPicture <br>    Image11.Picture = LoadPicture <br>    Image21.Picture = LoadPicture <br>    Image02.Picture = LoadPicture <br>    Image12.Picture = LoadPicture <br>    Image22.Picture = LoadPicture <br>     <br>End Sub <br> <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
