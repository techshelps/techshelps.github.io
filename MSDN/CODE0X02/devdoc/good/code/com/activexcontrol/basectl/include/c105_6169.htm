<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IPSERVER.H</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context111"></a>IPSERVER.H</h2>
<pre><code>//=--------------------------------------------------------------------------= <br>// IPServer.H <br>//=--------------------------------------------------------------------------= <br>// Copyright 1995 - 1998 Microsoft Corporation.  All Rights Reserved. <br>// <br>// THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT WARRANTY OF <br>// ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO <br>// THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A <br>// PARTICULAR PURPOSE. <br>//=--------------------------------------------------------------------------= <br>// <br>// global header file that contains all the windows stuff, etc ...  should <br>// be pre-compiled to speed things up a little bit. <br>// <br>#ifndef _IPSERVER_H_ <br> <br>//#define INC_OLE2 <br>#include &lt;windows.h&gt; <br>#include &lt;stddef.h&gt;                    // for offsetof() <br>#include &lt;olectl.h&gt; <br> <br>// things that -everybody- wants [read: is going to get] <br>// <br>#include "Debug.H" <br> <br>//=--------------------------------------------------------------------------= <br>// controls can register for thread notifications in their InitializeLibrary() <br>// <br>#ifdef __cplusplus <br>extern "C" { <br>#endif // __cplusplus <br> <br>typedef void (CALLBACK *THRDNFYPROC)(HANDLE, DWORD, void *); <br>void SetLibraryThreadProc(THRDNFYPROC pfnThreadNotify); <br> <br>#ifdef __cplusplus <br>} <br>#endif // __cplusplus <br>//=--------------------------------------------------------------------------= <br> <br>//=--------------------------------------------------------------------------= <br>// we don't want to use the CRTs, and would like some memory tracking in the <br>// debug case, so we'll override these guys <br>//=--------------------------------------------------------------------------= <br>// <br>//void * _cdecl operator new(size_t size); <br>//void  _cdecl operator delete(void *ptr); <br> <br> <br>//=--------------------------------------------------------------------------= <br>// Useful macros <br>//=--------------------------------------------------------------------------= <br>// <br>// handy error macros, randing from cleaning up, to returning to clearing <br>// rich error information as well. <br>// <br>#define RETURN_ON_FAILURE(hr) if (FAILED(hr)) return hr <br>#define RETURN_ON_NULLALLOC(ptr) if (!(ptr)) return E_OUTOFMEMORY <br>#define CLEANUP_ON_FAILURE(hr) if (FAILED(hr)) goto CleanUp <br>#define CLEARERRORINFORET(hr) { SetErrorInfo(0, NULL); return hr; } <br>#define CLEARERRORINFORET_ON_FAILURE(hr) if (FAILED(hr)) { SetErrorInfo(0, NULL); return hr; } <br> <br>#define CLEANUP_ON_ERROR(l)    if (l != ERROR_SUCCESS) goto CleanUp <br> <br>// conversions <br>// <br>#define BOOL_TO_VARIANTBOOL(f) (f) ? VARIANT_TRUE : VARIANT_FALSE <br> <br>// Reference counting help. <br>// <br>#define RELEASE_OBJECT(ptr)    if (ptr) { IUnknown *pUnk = (ptr); (ptr) = NULL; pUnk-&gt;Release(); } <br>#define QUICK_RELEASE(ptr)     if (ptr) ((IUnknown *)ptr)-&gt;Release(); <br>#define ADDREF_OBJECT(ptr)     if (ptr) (ptr)-&gt;AddRef() <br> <br> <br> <br>//=--------------------------------------------------------------------------= <br>// QueryInterface Optimizations <br>//=--------------------------------------------------------------------------= <br>// for optimizing QI's <br>// <br>#define DO_GUIDS_MATCH(riid1, riid2) ((riid1.Data1 == riid2.Data1) &amp;&amp; (riid1 == riid2)) <br> <br>// Data1_* <br>// <br>// the first dword of GUIDs for most of the interesting interfaces.  these are <br>// used by speed critical versions of QueryInterface <br>// <br>#define Data1_IAdviseSink                  0x0000010f <br>#define Data1_IAdviseSink2                 0x00000125 <br>#define Data1_IAdviseSinkEx                0x3af24290 <br>#define Data1_IBindCtx                     0x0000000e <br>#define Data1_ICDataDoc                    0xF413E4C0 <br>#define Data1_IClassFactory                0x00000001 <br>#define Data1_IClassFactory2               0xb196b28f <br>#define Data1_IConnectionPoint             0xb196b286 <br>#define Data1_IConnectionPointContainer    0xb196b284 <br>#define Data1_IControl_95                  0x9a4bbfb5 <br>#define Data1_IControl                     0xa7fddba0 <br>#define Data1_ICreateErrorInfo             0x22f03340 <br>#define Data1_ICreateTypeInfo              0x00020405 <br>#define Data1_ICreateTypeLib               0x00020406 <br>#define Data1_IDataAdviseHolder            0x00000110 <br>#define Data1_IDataFrame                   0x97F254E0 <br>#define Data1_IDataFrameExpert             0x73687490 <br>#define Data1_IDataObject                  0x0000010e <br>#define Data1_IDispatch                    0x00020400 <br>#define Data1_IDropSource                  0x00000121 <br>#define Data1_IDropTarget                  0x00000122 <br>#define Data1_IEnumCallback                0x00000108 <br>#define Data1_IEnumConnectionPoints        0xb196b285 <br>#define Data1_IEnumConnections             0xb196b287 <br>#define Data1_IEnumFORMATETC               0x00000103 <br>#define Data1_IEnumGeneric                 0x00000106 <br>#define Data1_IEnumHolder                  0x00000107 <br>#define Data1_IEnumMoniker                 0x00000102 <br>#define Data1_IEnumOLEVERB                 0x00000104 <br>#define Data1_IEnumSTATDATA                0x00000105 <br>#define Data1_IEnumSTATSTG                 0x0000000d <br>#define Data1_IEnumString                  0x00000101 <br>#define Data1_IEnumOleUndoActions          0xb3e7c340 <br>#define Data1_IEnumUnknown                 0x00000100 <br>#define Data1_IEnumVARIANT                 0x00020404 <br>#define Data1_IErrorInfo                   0x1cf2b120 <br>#define Data1_IExternalConnection          0x00000019 <br>#define Data1_IFont                        0xbef6e002 <br>#define Data1_IFontDisp                    0xbef6e003 <br>#define Data1_IFormExpert                  0x5aac7f70 <br>#define Data1_IGangConnectWithDefault      0x6d5140c0 <br>#define Data1_IInternalMoniker             0x00000011 <br>#define Data1_ILockBytes                   0x0000000a <br>#define Data1_IMalloc                      0x00000002 <br>#define Data1_IMarshal                     0x00000003 <br>#define Data1_IMessageFilter               0x00000016 <br>#define Data1_IMoniker                     0x0000000f <br>#define Data1_IMsoCommandTarget            0xb722bccb <br>#define Data1_IMsoDocument                 0xb722bcc5 <br>#define Data1_IOleInPlaceComponent         0x5efc7970 <br>#define Data1_IMsoView                     0xb722bcc6 <br>#define Data1_IOleAdviseHolder             0x00000111 <br>#define Data1_IOleCache                    0x0000011e <br>#define Data1_IOleCache2                   0x00000128 <br>#define Data1_IOleCacheControl             0x00000129 <br>#define Data1_IOleClientSite               0x00000118 <br>#define Data1_IOleCompoundUndoAction       0xa1faf330 <br>#define Data1_IOleContainer                0x0000011b <br>#define Data1_IOleControl                  0xb196b288 <br>#define Data1_IOleControlSite              0xb196b289 <br>#define Data1_IOleInPlaceActiveObject      0x00000117 <br>#define Data1_IOleInPlaceFrame             0x00000116 <br>#define Data1_IOleInPlaceObject            0x00000113 <br>#define Data1_IOleInPlaceObjectWindowless  0x1c2056cc <br>#define Data1_IOleInPlaceSite              0x00000119 <br>#define Data1_IOleInPlaceSiteEx            0x9c2cad80 <br>#define Data1_IOleInPlaceSiteWindowless    0x922eada0 <br>#define Data1_IOleInPlaceUIWindow          0x00000115 <br>#define Data1_IOleItemContainer            0x0000011c <br>#define Data1_IOleLink                     0x0000011d <br>#define Data1_IOleManager                  0x0000011f <br>#define Data1_IOleObject                   0x00000112 <br>#define Data1_IOlePresObj                  0x00000120 <br>#define Data1_IOlePropertyFrame            0xb83bb801 <br>#define Data1_IOleStandardTool             0xd97877c4 <br>#define Data1_IOleUndoAction               0x894ad3b0 <br>#define Data1_IOleUndoActionManager        0xd001f200 <br>#define Data1_IOleWindow                   0x00000114 <br>#define Data1_IPSFactory                   0x00000009 <br>#define Data1_IPSFactoryBuffer             0xd5f569d0 <br>#define Data1_IParseDisplayName            0x0000011a <br>#define Data1_IPerPropertyBrowsing         0x376bd3aa <br>#define Data1_IPersist                     0x0000010c <br>#define Data1_IPersistFile                 0x0000010b <br>#define Data1_IPersistPropertyBag          0x37D84F60 <br>#define Data1_IPersistStorage              0x0000010a <br>#define Data1_IPersistStream               0x00000109 <br>#define Data1_IPersistStreamInit           0x7fd52380 <br>#define Data1_IPicture                     0x7bf80980 <br>#define Data1_IPictureDisp                 0x7bf80981 <br>#define Data1_IPointerInactive             0x55980ba0 <br>#define Data1_IPropertyNotifySink          0x9bfbbc02 <br>#define Data1_IPropertyPage                0xb196b28d <br>#define Data1_IPropertyPage2               0x01e44665 <br>#define Data1_IPropertyPage3               0xb83bb803 <br>#define Data1_IPropertyPageInPlace         0xb83bb802 <br>#define Data1_IPropertyPageSite            0xb196b28c <br>#define Data1_IPropertyPageSite2           0xb83bb804 <br>#define Data1_IProvideClassInfo            0xb196b283 <br>#define Data1_IProvideDynamicClassInfo     0x6d5140d1 <br>#define Data1_IQuickActivate               0xcf51ed10 <br>#define Data1_IRequireClasses              0x6d5140d0 <br>#define Data1_IRootStorage                 0x00000012 <br>#define Data1_IRunnableObject              0x00000126 <br>#define Data1_IRunningObjectTable          0x00000010 <br>#define Data1_ISelectionContainer          0x6d5140c6 <br>#define Data1_IServiceProvider             0x6d5140c1 <br>#define Data1_ISimpleFrameSite             0x742b0e01 <br>#define Data1_ISpecifyPropertyPages        0xb196b28b <br>#define Data1_IStdMarshalInfo              0x00000018 <br>#define Data1_IStorage                     0x0000000b <br>#define Data1_IStream                      0x0000000c <br>#define Data1_ISupportErrorInfo            0xdf0b3d60 <br>#define Data1_ITypeComp                    0x00020403 <br>#define Data1_ITypeInfo                    0x00020401 <br>#define Data1_ITypeLib                     0x00020402 <br>#define Data1_IUnknown                     0x00000000 <br>#define Data1_IViewObject                  0x0000010d <br>#define Data1_IViewObject2                 0x00000127 <br>#define Data1_IViewObjectEx                0x3af24292 <br>#define Data1_IWeakRef                     0x0000001a <br>#define Data1_ICategorizeProperties        0x4d07fc10 <br> <br> <br>#define QI_INHERITS(pObj, itf)              \ <br>    case Data1_##itf:                       \ <br>      if(DO_GUIDS_MATCH(riid, IID_##itf))    \ <br>      {                                     \ <br>        *ppvObjOut = (void *)(itf *)pObj;   \ <br>      }                                     \ <br>      break; <br> <br>#include "extobj.h" <br> <br> <br>#define _IPSERVER_H_ <br>#endif // _IPSERVER_H_ </code></pre>
<p>&nbsp;</p></body>
</HTML>
