<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IOCS.CPP</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context347"></a>IOCS.CPP</h2>
<pre><code>//********************************************************************** <br>// File name: IOCS.CPP <br>// <br>//      Implementation file for COleClientSite <br>// <br>// Functions: <br>// <br>//      See IOCS.H for class definition <br>// <br>// Copyright 1992 - 1998 Microsoft Corporation. All rights reserved. <br>//********************************************************************** <br> <br>#include "pre.h" <br>#include "iocs.h" <br>#include "ias.h" <br>#include "app.h" <br>#include "site.h" <br>#include "doc.h" <br> <br> <br>//********************************************************************** <br>// <br>// COleClientSite::QueryInterface <br>// <br>// Purpose: <br>// <br>//      Used for interface negotiation at this interface <br>// <br>// Parameters: <br>// <br>//      REFIID riid         -   A reference to the interface that is <br>//                              being queried. <br>// <br>//      LPVOID FAR* ppvObj  -   An out parameter to return a pointer to <br>//                              the interface. <br>// <br>// Return Value: <br>// <br>//      S_OK                -   The interface is supported. <br>//      E_NOINTERFACE       -   The interface is not supported <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>//      CSimpleSite::QueryInterface SITE.CPP <br>// <br>// Comments: <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP COleClientSite::QueryInterface(REFIID riid, LPVOID FAR* ppvObj) <br>{ <br>OutputDebugString("In IOCS::QueryInterface\r\n"); <br> <br>// delegate to the container Site <br>return m_pSite-&gt;QueryInterface(riid, ppvObj); <br>} <br> <br>//********************************************************************** <br>// <br>// CSimpleApp::AddRef <br>// <br>// Purpose: <br>// <br>//      Adds to the reference count at the interface level. <br>// <br>// Parameters: <br>// <br>//      None <br>// <br>// Return Value: <br>// <br>//      ULONG   -   The new reference count of the interface <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>// <br>// Comments: <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP_(ULONG) COleClientSite::AddRef() <br>{ <br>OutputDebugString("In IOCS::AddRef\r\n"); <br> <br>// increment the interface reference count (for debugging only) <br>++m_nCount; <br> <br>// delegate to the container Site <br>return m_pSite-&gt;AddRef(); <br>} <br> <br> <br>//********************************************************************** <br>// <br>// CSimpleApp::Release <br>// <br>// Purpose: <br>// <br>//      Decrements the reference count at this level <br>// <br>// Parameters: <br>// <br>//      None <br>// <br>// Return Value: <br>// <br>//      ULONG   -   The new reference count of the interface. <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>// <br>// Comments: <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP_(ULONG) COleClientSite::Release() <br>{ <br>OutputDebugString("In IOCS::Release\r\n"); <br> <br>// decrement the interface reference count (for debugging only) <br>--m_nCount; <br> <br>// delegate to the container Site <br>return m_pSite-&gt;Release(); <br>} <br> <br>//********************************************************************** <br>// <br>// COleClientSite::SaveObject <br>// <br>// Purpose: <br>// <br>//      Called by the object when it wants to be saved to persistant <br>//      storage <br>// <br>// Parameters: <br>// <br>//      None <br>// <br>// Return Value: <br>// <br>//      S_OK <br>// <br>// Function Calls: <br>//      Function                            Location <br>// <br>//      OutputDebugString                   Windows API <br>//      IOleObject::QueryInterface          Object <br>//      IPersistStorage::SaveCompleted      Object <br>//      IPersistStorage::Release            Object <br>//      OleSave                             OLE API <br>//                           OLE API <br>// <br>// Comments: <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP COleClientSite::SaveObject() <br>{ <br>LPPERSISTSTORAGE lpPS; <br>SCODE sc = E_FAIL; <br> <br>OutputDebugString("In IOCS::SaveObject\r\n"); <br> <br>// get a pointer to IPersistStorage <br>HRESULT hErr = m_pSite-&gt;m_lpOleObject-&gt;QueryInterface(IID_IPersistStorage, (LPVOID FAR *)&amp;lpPS); <br> <br>// save the object <br>if (hErr == NOERROR) <br>{ <br>sc =  OleSave(lpPS, m_pSite-&gt;m_lpObjStorage, TRUE) ; <br>lpPS-&gt;SaveCompleted(NULL); <br>lpPS-&gt;Release(); <br>} <br> <br>return sc; <br>} <br> <br>//********************************************************************** <br>// <br>// COleClientSite::GetMoniker <br>// <br>// Purpose: <br>// <br>//      Not Implemented <br>// <br>// Parameters: <br>// <br>//      Not Implemented <br>// <br>// Return Value: <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>// <br>// Comments: <br>// <br>//      This function is not implemented because we don't support <br>//      linking. <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP COleClientSite::GetMoniker(DWORD dwAssign, DWORD dwWhichMoniker, LPMONIKER FAR* ppmk) <br>{ <br>OutputDebugString("In IOCS::GetMoniker\r\n"); <br> <br>// need to null the out pointer <br>*ppmk = NULL; <br> <br>return E_NOTIMPL; <br>} <br> <br>//********************************************************************** <br>// <br>// COleClientSite::GetContainer <br>// <br>// Purpose: <br>// <br>//      Not Implemented <br>// <br>// Parameters: <br>// <br>//      Not Implemented <br>// <br>// Return Value: <br>// <br>//      Not Implemented <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>// <br>// Comments: <br>// <br>//      Not Implemented <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP COleClientSite::GetContainer(LPOLECONTAINER FAR* ppContainer) <br>{ <br>OutputDebugString("In IOCS::GetContainer\r\n"); <br> <br>// NULL the out pointer <br>*ppContainer = NULL; <br> <br>return E_NOTIMPL; <br>} <br> <br>//********************************************************************** <br>// <br>// COleClientSite::ShowObject <br>// <br>// Purpose: <br>// <br>//      Not Implemented <br>// <br>// Parameters: <br>// <br>//      Not Implemented <br>// <br>// Return Value: <br>// <br>//      Not Implemented <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>// <br>// Comments: <br>// <br>//      This function is not implemented because we don't support <br>//      linking. <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP COleClientSite::ShowObject() <br>{ <br>OutputDebugString("In IOCS::ShowObject\r\n"); <br>return NOERROR; <br>} <br> <br>//********************************************************************** <br>// <br>// COleClientSite::OnShowWindow <br>// <br>// Purpose: <br>// <br>//      Object calls this method when it is opening/closing non-InPlace <br>//      Window <br>// <br>// Parameters: <br>// <br>//      BOOL fShow  - TRUE if Window is opening, FALSE if closing <br>// <br>// Return Value: <br>// <br>//      S_OK <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>//      InvalidateRect              Windows API <br>//                   OLE API <br>// <br>// Comments: <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP COleClientSite::OnShowWindow(BOOL fShow) <br>{ <br>OutputDebugString("In IOCS::OnShowWindow\r\n"); <br>m_pSite-&gt;m_fObjectOpen = fShow; <br>InvalidateRect(m_pSite-&gt;m_lpDoc-&gt;m_hDocWnd, NULL, TRUE); <br> <br>// if object window is closing, then bring container window to top <br>if (! fShow) { <br>BringWindowToTop(m_pSite-&gt;m_lpDoc-&gt;m_hDocWnd); <br>SetFocus(m_pSite-&gt;m_lpDoc-&gt;m_hDocWnd); <br>} <br>return S_OK; <br>} <br> <br>//********************************************************************** <br>// <br>// COleClientSite::RequestNewObjectLayout <br>// <br>// Purpose: <br>// <br>//      Not Implemented <br>// <br>// Parameters: <br>// <br>//      Not Implemented <br>// <br>// Return Value: <br>// <br>//      Not Implemented <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>// <br>// Comments: <br>// <br>//      Not Implemented <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP COleClientSite::RequestNewObjectLayout() <br>{ <br>OutputDebugString("In IOCS::RequestNewObjectLayout\r\n"); <br>return E_NOTIMPL; <br>} </code></pre>
<p>&nbsp;</p></body>
</HTML>
