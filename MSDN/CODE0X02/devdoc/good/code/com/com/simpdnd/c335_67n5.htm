<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IAS.CPP</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context341"></a>IAS.CPP</h2>
<pre><code>//********************************************************************** <br>// File name: IAS.CPP <br>// <br>//      Implementation file of CAdviseSink <br>// <br>// <br>// Functions: <br>// <br>//      See IAS.H for Class Definition <br>// <br>// Copyright 1992 - 1998 Microsoft Corporation. All rights reserved. <br>//********************************************************************** <br> <br>#include "pre.h" <br>#include "iocs.h" <br>#include "ias.h" <br>#include "app.h" <br>#include "site.h" <br>#include "doc.h" <br> <br>//********************************************************************** <br>// <br>// CAdviseSink::QueryInterface <br>// <br>// Purpose: <br>// <br>//      Returns a pointer to a requested interface. <br>// <br>// Parameters: <br>// <br>//      REFIID riid         - The requested interface <br>// <br>//      LPVOID FAR* ppvObj  - Place to return the interface <br>// <br>// Return Value: <br>// <br>//      HRESULT from CSimpleSite::QueryInterface <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      CSimpleSite::QueryInterface SITE.CPP <br>//      OutputDebugString           Windows API <br>// <br>// Comments: <br>// <br>//      This function simply delegates to the Object class, which is <br>//      aware of the supported interfaces. <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP CAdviseSink::QueryInterface(REFIID riid, LPVOID FAR* ppvObj) <br>{ <br>OutputDebugString("In IAS::QueryInterface\r\n"); <br> <br>// delegate to the document Object <br>return m_pSite-&gt;QueryInterface(riid, ppvObj); <br>} <br> <br>//********************************************************************** <br>// <br>// CAdviseSink::AddRef <br>// <br>// Purpose: <br>// <br>//      Increments the reference count on this interface <br>// <br>// Parameters: <br>// <br>//      None <br>// <br>// Return Value: <br>// <br>//      The current reference count on this interface. <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      CSimpleSite::AddReff        SITE.CPP <br>//      OutputDebugString           Windows API <br>// <br>// Comments: <br>// <br>//      This function adds one to the ref count of the interface, <br>//      and calls then calls CSimpleSite to increment its ref. <br>//      count. <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP_(ULONG) CAdviseSink::AddRef() <br>{ <br>OutputDebugString("In IAS::AddRef\r\n"); <br> <br>// increment the interface reference count (for debugging only) <br>++m_nCount; <br> <br>// delegate to the container Site <br>return m_pSite-&gt;AddRef(); <br>} <br> <br>//********************************************************************** <br>// <br>// CAdviseSink::Release <br>// <br>// Purpose: <br>// <br>//      Decrements the reference count on this interface <br>// <br>// Parameters: <br>// <br>//      None <br>// <br>// Return Value: <br>// <br>//      The current reference count on this interface. <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      CSimpleSite::Release        SITE.CPP <br>//      OutputDebugString           Windows API <br>// <br>// Comments: <br>// <br>//      This function subtracts one from the ref count of the interface, <br>//      and calls then calls CSimpleSite to decrement its ref. <br>//      count. <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP_(ULONG) CAdviseSink::Release() <br>{ <br>OutputDebugString("In IAS::Release\r\n"); <br> <br>// decrement the interface reference count (for debugging only) <br>m_nCount--; <br> <br>// delegate to the container Site <br>return m_pSite-&gt;Release(); <br>} <br> <br>//********************************************************************** <br>// <br>// CAdviseSink::OnDataChange <br>// <br>// Purpose: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>// Parameters: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>// Return Value: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>// <br>// Comments: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP_(void) CAdviseSink::OnDataChange (FORMATETC FAR* pFormatetc, STGMEDIUM FAR* pStgmed) <br>{ <br>OutputDebugString("In IAS::OnDataChange\r\n"); <br>} <br> <br>//********************************************************************** <br>// <br>// CAdviseSink::OnViewChange <br>// <br>// Purpose: <br>// <br>//      Notifies us that the view has changed and needs to be updated. <br>// <br>// Parameters: <br>// <br>//      DWORD dwAspect  - Aspect that has changed <br>// <br>//      LONG lindex     - Index that has changed <br>// <br>// Return Value: <br>// <br>//      None <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>//      InvalidateRect              Windows API <br>//      IViewObject2::GetExtent     Object <br>// <br>// Comments: <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP_(void) CAdviseSink::OnViewChange (DWORD dwAspect, LONG lindex) <br>{ <br>LPVIEWOBJECT2 lpViewObject2; <br>OutputDebugString("In IAS::OnViewChange\r\n"); <br> <br>// get a pointer to IViewObject2 <br>HRESULT hErr = m_pSite-&gt;m_lpOleObject-&gt;QueryInterface( <br>IID_IViewObject2,(LPVOID FAR *)&amp;lpViewObject2); <br> <br>if (hErr == NOERROR) { <br>// get extent of the object <br>// NOTE: this method will never be remoted; it can be called w/i this async method <br>lpViewObject2-&gt;GetExtent(DVASPECT_CONTENT, -1 , NULL, &amp;m_pSite-&gt;m_sizel); <br>lpViewObject2-&gt;Release(); <br>} <br> <br>InvalidateRect(m_pSite-&gt;m_lpDoc-&gt;m_hDocWnd, NULL, TRUE); <br>} <br> <br>//********************************************************************** <br>// <br>// CAdviseSink::OnRename <br>// <br>// Purpose: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>// Parameters: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>// Return Value: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>// <br>// Comments: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP_(void) CAdviseSink::OnRename (LPMONIKER pmk) <br>{ <br>OutputDebugString("In IAS::OnRename\r\n"); <br>} <br> <br>//********************************************************************** <br>// <br>// CAdviseSink::OnSave <br>// <br>// Purpose: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>// Parameters: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>// Return Value: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>// <br>// Comments: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP_(void) CAdviseSink::OnSave () <br>{ <br>OutputDebugString("In IAS::OnSave\r\n"); <br>} <br> <br>//********************************************************************** <br>// <br>// CAdviseSink::OnClose <br>// <br>// Purpose: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>// Parameters: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>// Return Value: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>// <br>// Comments: <br>// <br>//      Not Implemented (needs to be stubbed out) <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP_(void) CAdviseSink::OnClose() <br>{ <br>OutputDebugString("In IAS::OnClose\r\n"); <br>} </code></pre>
<p>&nbsp;</p></body>
</HTML>
