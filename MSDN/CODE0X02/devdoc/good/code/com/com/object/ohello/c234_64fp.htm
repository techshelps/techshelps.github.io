<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CLIENT.CXX</title>
<link disabled rel=stylesheet href=../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context235"></a>CLIENT.CXX</h2>
<pre><code>/*+---------------------------------------------------------------------------- <br> <br>Microsoft Windows Sample Program <br>Copyright 1994 - 1998 Microsoft Corporation.  All rights reserved. <br> <br>FILE:       client.cxx <br> <br>USAGE:      client  <br> <br>PURPOSE:    OLE client application uses a custom interface to call the  <br>            server and print "Hello". <br> <br>FUNCTIONS:  main() - Main entry point for the client application. <br> <br>COMMENTS:   The server program must be installed before running the client. <br>            Run server.exe /REGSERVER to install the server program. <br> <br>-----------------------------------------------------------------------------*/ <br>#include &lt;windows.h&gt; <br>#include &lt;stdio.h&gt; <br>#include "ohello.h"     // generated by MIDL from ohello.idl <br> <br>// the class ID of the server exe <br>const CLSID CLSID_OHello =  <br>    {0xf9246031,0x9f33,0x11cd,{0xb2,0x3f,0x00,0xaa,0x00,0x33,0x9c,0xce}}; <br> <br>void PrintErrorMessage(HRESULT hr); <br> <br>//+--------------------------------------------------------------------------- <br>// <br>//  Function:   main <br>// <br>//  Synopsis:   Main entry point for the client application.  First we  <br>//              call CoCreateInstance to create an instance of the server <br>//              object.  Next, we use the IHello custom interface to  <br>//              call the server object and print "Hello".  After waiting <br>//              5 seconds, we call the server object to print "Goodbye". <br>//              Finally, we release the IHello interface pointer and <br>//              terminate. <br>// <br>//---------------------------------------------------------------------------- <br>void __cdecl main(int argc, char *argv[]) <br>{ <br>    HRESULT hr; <br>    IHello *pHello = 0; <br> <br>    hr = CoInitialize(NULL); <br> <br>    if(SUCCEEDED(hr)) <br>    { <br>        hr = CoCreateInstance(CLSID_OHello, 0, CLSCTX_LOCAL_SERVER, IID_IHello, (void **) &amp;pHello); <br>        if(SUCCEEDED(hr)) <br>        { <br>            hr = pHello-&gt;HelloProc((unsigned char *) "Hello"); <br> <br>            if(SUCCEEDED(hr)) <br>            { <br>                printf("Successfully printed Hello.\n"); <br>            } <br>            else <br>            { <br>                printf("IHello::HelloProc failed.\n"); <br>                PrintErrorMessage(hr); <br>            } <br> <br>            printf(" &lt;pausing for 5 sec&gt;\n"); <br>            Sleep( 5000 ); // 5000 msec = 5 sec <br> <br>            hr = pHello-&gt;HelloProc((unsigned char *) "Goodbye"); <br> <br>            if(SUCCEEDED(hr)) <br>            { <br>                printf("Successfully printed Goodbye.\n"); <br>            } <br>            else <br>            { <br>                printf("IHello::HelloProc failed.\n"); <br>                PrintErrorMessage(hr); <br>            } <br> <br>            pHello-&gt;Release(); <br>        } <br>        else <br>        { <br>            printf("CoCreateInstance failed.\n"); <br>            PrintErrorMessage(hr); <br> <br>            if(hr == REGDB_E_CLASSNOTREG) <br>                printf("Run server.exe /REGSERVER to install the server program.\n"); <br>        } <br> <br>        CoUninitialize(); <br>    } <br>    else <br>    { <br>        printf("CoInitialize failed.\n"); <br>        PrintErrorMessage(hr); <br>    }    <br>} <br> <br> </code></pre>
<p>&nbsp;</p></body>
</HTML>
