<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>IEC.CPP</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context364"></a>IEC.CPP</h2>
<pre><code>//********************************************************************** <br>// File name: IEC.CPP <br>// <br>//    Implementation file for the CExternalConnection Class <br>// <br>// Functions: <br>// <br>//    See iec.h for a list of member functions. <br>// <br>// Copyright 1993 - 1998 Microsoft Corporation. All rights reserved. <br>//********************************************************************** <br> <br>#include "pre.h" <br>#include "obj.h" <br>#include "iec.h" <br>#include "app.h" <br>#include "doc.h" <br> <br> <br>//********************************************************************** <br>// <br>// CExternalConnection::QueryInterface <br>// <br>// Purpose: <br>// <br>// <br>// Parameters: <br>// <br>//      REFIID riid         -   Interface being queried for. <br>// <br>//      LPVOID FAR *ppvObj  -   Out pointer for the interface. <br>// <br>// Return Value: <br>// <br>//      S_OK            - Success <br>//      E_NOINTERFACE   - Failure <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      CSimpSvrObj::QueryInterface OBJ.CPP <br>// <br>// Comments: <br>// <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP CExternalConnection::QueryInterface (REFIID riid, LPVOID FAR* ppvObj) <br>{ <br>OutputDebugString("In CExternalConnection::QueryInterface\r\n"); <br> <br>return m_lpObj-&gt;QueryInterface(riid, ppvObj); <br>} <br> <br> <br>//********************************************************************** <br>// <br>// CExternalConnection::AddRef <br>// <br>// Purpose: <br>// <br>//      Increments the reference count on CExternalConnection and the "object" <br>//      object. <br>// <br>// Parameters: <br>// <br>//      None <br>// <br>// Return Value: <br>// <br>//      The Reference count on the Object. <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OuputDebugString            Windows API <br>//      CSimpSvrObj::AddRef         OBJ.CPP <br>// <br>// Comments: <br>// <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP_(ULONG) CExternalConnection::AddRef () <br>{ <br>OutputDebugString("In CExternalConnection::AddRef\r\n"); <br>++m_nCount; <br>return m_lpObj-&gt;AddRef(); <br>}; <br> <br>//********************************************************************** <br>// <br>// CExternalConnection::Release <br>// <br>// Purpose: <br>// <br>//      Decrements the reference count of COleObject and the <br>//      "object" object. <br>// <br>// Parameters: <br>// <br>//      None <br>// <br>// Return Value: <br>// <br>//      The new reference count <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>//      CSimpSvrObj::Release        OBJ.CPP <br>// <br>// Comments: <br>// <br>// <br>//******************************************************************** <br> <br> <br>STDMETHODIMP_(ULONG) CExternalConnection::Release () <br>{ <br>OutputDebugString("In CExternalConnection::Release\r\n"); <br>--m_nCount; <br>return m_lpObj-&gt;Release(); <br>}; <br> <br> <br> <br>//********************************************************************** <br>// <br>// CExternalConnection::AddConnection <br>// <br>// Purpose: <br>// <br>//      Called when another connection is made to the object. <br>// <br>// Parameters: <br>// <br>//      DWORD extconn   -   Type of connection <br>// <br>//      DWORD reserved  -   Reserved <br>// <br>// Return Value: <br>// <br>//      Strong connection count <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>// <br>// Comments: <br>// <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP_(DWORD) CExternalConnection::AddConnection (DWORD extconn, DWORD reserved) <br>{ <br>OutputDebugString("In CExternalConnection::AddConnection\r\n"); <br> <br>if (extconn &amp; EXTCONN_STRONG) <br>return ++m_dwStrong; <br> <br>return 0; <br>} <br> <br>//********************************************************************** <br>// <br>// CExternalConnection::ReleaseConnection <br>// <br>// Purpose: <br>// <br>//      Called when a connection to the object is released. <br>// <br>// Parameters: <br>// <br>//      DWORD extconn               - Type of Connection <br>// <br>//      DWORD reserved              - Reserved <br>// <br>//      BOOL fLastReleaseCloses     - Close flag <br>// <br>// Return Value: <br>// <br>//      The new reference count <br>// <br>// Function Calls: <br>//      Function                    Location <br>// <br>//      OutputDebugString           Windows API <br>//      COleObject::Close           IOO.CPP <br>// <br>// Comments: <br>// <br>// <br>//******************************************************************** <br> <br>STDMETHODIMP_(DWORD) CExternalConnection::ReleaseConnection (DWORD extconn, DWORD reserved, BOOL fLastReleaseCloses) <br>{ <br>OutputDebugString("In CExternalConnection::ReleaseConnection\r\n"); <br> <br>if (extconn &amp; EXTCONN_STRONG) <br>{ <br>DWORD dwSave = --m_dwStrong; <br> <br>if (!m_dwStrong &amp;&amp; fLastReleaseCloses) <br>m_lpObj-&gt;m_OleObject.Close(OLECLOSE_SAVEIFDIRTY); <br> <br>return dwSave; <br>} <br>return 0; <br>} </code></pre>
<p>&nbsp;</p></body>
</HTML>
