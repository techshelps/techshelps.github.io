<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>COSMOTST.FRM</title>
<link disabled rel=stylesheet href=../../../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context752"></a>COSMOTST.FRM</h2>
<pre><code>VERSION 4.00 <br>Begin VB.Form Form1  <br>   Caption         =   "Test Cosmo" <br>   ClientHeight    =   3000 <br>   ClientLeft      =   9420 <br>   ClientTop       =   1500 <br>   ClientWidth     =   4800 <br>   BeginProperty Font  <br>      name            =   "MS Sans Serif" <br>      charset         =   1 <br>      weight          =   700 <br>      size            =   7.8 <br>      underline       =   0   'False <br>      italic          =   0   'False <br>      strikethrough   =   0   'False <br>   EndProperty <br>   Height          =   3348 <br>   Left            =   9384 <br>   LinkTopic       =   "Form1" <br>   ScaleHeight     =   3000 <br>   ScaleWidth      =   4800 <br>   Top             =   1188 <br>   Width           =   4872 <br>   Begin VB.CommandButton CreateFigure  <br>      Caption         =   "C&amp;reate Figure" <br>      BeginProperty Font  <br>         name            =   "MS Sans Serif" <br>         charset         =   1 <br>         weight          =   700 <br>         size            =   7.8 <br>         underline       =   0   'False <br>         italic          =   0   'False <br>         strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   615 <br>      Left            =   120 <br>      TabIndex        =   9 <br>      Top             =   2280 <br>      Width           =   1455 <br>   End <br>   Begin VB.CommandButton ReleaseFigure  <br>      Caption         =   "Release F&amp;igure" <br>      BeginProperty Font  <br>         name            =   "MS Sans Serif" <br>         charset         =   1 <br>         weight          =   700 <br>         size            =   7.8 <br>         underline       =   0   'False <br>         italic          =   0   'False <br>         strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   615 <br>      Left            =   3240 <br>      TabIndex        =   8 <br>      Top             =   1560 <br>      Width           =   1455 <br>   End <br>   Begin VB.CommandButton TestFigure  <br>      Caption         =   "Test Fi&amp;gure" <br>      BeginProperty Font  <br>         name            =   "MS Sans Serif" <br>         charset         =   1 <br>         weight          =   700 <br>         size            =   7.8 <br>         underline       =   0   'False <br>         italic          =   0   'False <br>         strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   615 <br>      Left            =   1680 <br>      TabIndex        =   7 <br>      Top             =   1560 <br>      Width           =   1455 <br>   End <br>   Begin VB.CommandButton GetFigure  <br>      Caption         =   "Get &amp;Figure" <br>      BeginProperty Font  <br>         name            =   "MS Sans Serif" <br>         charset         =   1 <br>         weight          =   700 <br>         size            =   7.8 <br>         underline       =   0   'False <br>         italic          =   0   'False <br>         strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   615 <br>      Left            =   120 <br>      TabIndex        =   6 <br>      Top             =   1560 <br>      Width           =   1455 <br>   End <br>   Begin VB.CommandButton GetCollection  <br>      Caption         =   "&amp;Get Collection" <br>      BeginProperty Font  <br>         name            =   "MS Sans Serif" <br>         charset         =   1 <br>         weight          =   700 <br>         size            =   7.8 <br>         underline       =   0   'False <br>         italic          =   0   'False <br>         strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   615 <br>      Left            =   120 <br>      TabIndex        =   5 <br>      Top             =   840 <br>      Width           =   1455 <br>   End <br>   Begin VB.CommandButton ReleaseCollection  <br>      Caption         =   "Release C&amp;oll." <br>      BeginProperty Font  <br>         name            =   "MS Sans Serif" <br>         charset         =   1 <br>         weight          =   700 <br>         size            =   7.8 <br>         underline       =   0   'False <br>         italic          =   0   'False <br>         strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   615 <br>      Left            =   3240 <br>      TabIndex        =   4 <br>      Top             =   840 <br>      Width           =   1455 <br>   End <br>   Begin VB.CommandButton TestCollection  <br>      Caption         =   "Test &amp;Collection" <br>      BeginProperty Font  <br>         name            =   "MS Sans Serif" <br>         charset         =   1 <br>         weight          =   700 <br>         size            =   7.8 <br>         underline       =   0   'False <br>         italic          =   0   'False <br>         strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   615 <br>      Left            =   1680 <br>      TabIndex        =   3 <br>      Top             =   840 <br>      Width           =   1455 <br>   End <br>   Begin VB.CommandButton QuitApp  <br>      Caption         =   "&amp;Quit App" <br>      BeginProperty Font  <br>         name            =   "MS Sans Serif" <br>         charset         =   1 <br>         weight          =   700 <br>         size            =   7.8 <br>         underline       =   0   'False <br>         italic          =   0   'False <br>         strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   615 <br>      Left            =   3240 <br>      TabIndex        =   2 <br>      Top             =   120 <br>      Width           =   1455 <br>   End <br>   Begin VB.CommandButton CreateApp  <br>      Caption         =   "&amp;Create App" <br>      BeginProperty Font  <br>         name            =   "MS Sans Serif" <br>         charset         =   1 <br>         weight          =   700 <br>         size            =   7.8 <br>         underline       =   0   'False <br>         italic          =   0   'False <br>         strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   615 <br>      Left            =   120 <br>      TabIndex        =   1 <br>      Top             =   120 <br>      Width           =   1455 <br>   End <br>   Begin VB.CommandButton TestApp  <br>      Caption         =   "&amp;Test App" <br>      BeginProperty Font  <br>         name            =   "MS Sans Serif" <br>         charset         =   1 <br>         weight          =   700 <br>         size            =   7.8 <br>         underline       =   0   'False <br>         italic          =   0   'False <br>         strikethrough   =   0   'False <br>      EndProperty <br>      Height          =   615 <br>      Left            =   1680 <br>      TabIndex        =   0 <br>      Top             =   120 <br>      Width           =   1455 <br>   End <br>End <br>Attribute VB_Name = "Form1" <br>Attribute VB_Creatable = False <br>Attribute VB_Exposed = False <br>Dim Cosmo As Object <br>Dim Figures As Object <br>Dim CosmoFigure As Object <br>Dim fCreatedObject As Integer <br> <br>Private Sub CreateApp_Click() <br>    Set Cosmo = CreateObject("Cosmo.Application.2") <br>    CreateApp.Enabled = False <br>    QuitApp.Enabled = True <br>    TestApp.Enabled = True <br> <br>    CreateFigure.Enabled = False <br>    GetCollection.Enabled = True <br> <br>    fCreatedObject = False <br>End Sub <br> <br>Private Sub CreateFigure_Click() <br>    Set CosmoFigure = CreateObject("Cosmo.Figure.2") <br> <br>    CreateApp.Enabled = False <br>    QuitApp.Enabled = False <br>    TestApp.Enabled = False <br> <br>    GetCollection.Enabled = False <br>    TestCollection.Enabled = False <br>    GetFigure.Enabled = False <br>    ReleaseCollection.Enabled = False <br> <br>    CreateFigure.Enabled = False <br>    TestFigure.Enabled = True <br>    ReleaseFigure.Enabled = True <br> <br>    fCreatedObject = True <br> <br>    CosmoFigure.Application.Visible = True <br>End Sub <br> <br>Private Sub Form_Load() <br>    QuitApp.Enabled = False <br>    TestApp.Enabled = False <br>    GetCollection.Enabled = False <br>    TestCollection.Enabled = False <br>    ReleaseCollection.Enabled = False <br> <br>    GetFigure.Enabled = False <br>    TestFigure.Enabled = False <br>    ReleaseFigure.Enabled = False <br> <br>    fCreatedObject = False <br>End Sub <br> <br>Private Sub GetCollection_Click() <br>    Set Figures = Cosmo.Figures <br>     <br>    GetCollection.Enabled = False <br>    TestCollection.Enabled = True <br>    ReleaseCollection.Enabled = True <br> <br>    GetFigure.Enabled = True <br>End Sub <br> <br>Private Sub GetFigure_Click() <br>    Set CosmoFigure = Figures.Add <br>     <br>    CreateFigure.Enabled = False <br>    GetFigure.Enabled = False <br>    TestFigure.Enabled = True <br>    ReleaseFigure.Enabled = True <br>End Sub <br> <br>Private Sub QuitApp_Click() <br>    'You can use either Quit method or set the <br>    'object variable to "Nothing" to destroy the <br>    'object and terminate the application <br>    Cosmo.Quit <br>    Set Cosmo = Nothing <br> <br>    GetCollection.Enabled = False <br> <br>    CreateApp.Enabled = True <br>    QuitApp.Enabled = False <br>    TestApp.Enabled = False <br>    CreateFigure.Enabled = True <br>End Sub <br> <br>Private Sub ReleaseCollection_Click() <br>    Set Figures = Nothing <br>    GetCollection.Enabled = True <br>    TestCollection.Enabled = False <br>    ReleaseCollection.Enabled = False <br> <br>    GetFigure.Enabled = False <br>End Sub <br> <br>Private Sub ReleaseFigure_Click() <br>    CosmoFigure.Close (True) <br>    Set CosmoFigure = Nothing <br>     <br>    If (fCreatedObject) Then <br>        CreateFigure.Enabled = True <br>    Else <br>        GetFigure.Enabled = True <br>    End If <br> <br>    TestFigure.Enabled = False <br>    ReleaseFigure.Enabled = False <br>End Sub <br> <br>Private Sub TestApp_Click() <br>    Dim Copy As Object <br> <br>    'Show the window and hide it to show position <br>    Cosmo.Visible = True <br>    Cosmo.Visible = False <br>     <br>    'Move and resize the window and show it again <br>    Cosmo.Left = 35 <br>    Cosmo.Top = 35 <br>    Cosmo.Width = 450 <br>    Cosmo.Height = 450 <br> <br>    Cosmo.Visible = True <br>     <br>    Debug.Print "Left=" + Str$(Cosmo.Left) <br>    Debug.Print "Top=" + Str$(Cosmo.Top) <br>    Debug.Print "Width=" + Str$(Cosmo.Width) <br>    Debug.Print "Height=" + Str$(Cosmo.Height) <br> <br>    Debug.Print "Status Bar=" + Cosmo.StatusBar <br>    Cosmo.StatusBar = "This is a string from VB" <br>    Debug.Print "Status Bar=" + Cosmo.StatusBar <br> <br>    Debug.Print "FullName=" + Cosmo.FullName <br>    Debug.Print "Name=" + Cosmo.Name <br>    Debug.Print "Path=" + Cosmo.Path <br>    Debug.Print "Caption=" + Cosmo.Caption <br> <br>    Set Copy = Cosmo    'Should get 'Appication' property <br>    Debug.Print Copy.Name <br>    Set Copy = Nothing  'Just calls Release, no shutdown <br>End Sub <br> <br>Private Sub TestCollection_Click() <br>    Dim Fig1 As Object <br>    Dim Fig2 As Object <br>    Dim Fig3 As Object <br>    Dim Fig4 As Object <br>    Dim FiguresCopy As Object <br> <br>    Set Fig1 = Figures.Open("c:\inole\chap14\cosmotst\newvb\samp1.cos") <br>    Fig1.Visible = True <br> <br>    Set Fig2 = Figures.Add <br>    Fig2.Visible = True <br> <br>    Set Fig3 = Figures.Open("c:\inole\chap14\cosmotst\newvb\samp2.cos") <br>    Fig3.Visible = True <br> <br>    Debug.Print "Figures.Application=" + Figures.Application.Caption <br>    Debug.Print "Figures.Parent=" + Figures.Parent.Name <br> <br>    cFigs = Figures.Count <br>    Debug.Print "Number of Figures=" + Str$(cFigs) <br>     <br>    Set FiguresCopy = Figures <br>    Set Fig4 = FiguresCopy.Item("c:\inole\chap14\cosmotst\newvb\samp1.cos") <br>    Debug.Print "Item from pathname: " + Fig4.Name <br>    Set Fig4 = Nothing <br>    Set FiguresCopy = Nothing <br> <br>    'Closes all documents, rendering Fig1, 2, and 3 invalid <br>    Figures.Close <br>End Sub <br> <br>Private Sub TestFigure_Click() <br>    Dim FigTemp As Object <br>     <br>    CosmoFigure.Visible = True <br>    CosmoFigure.Left = 10 <br>    CosmoFigure.Width = 300 <br>    CosmoFigure.Top = 10 <br>    CosmoFigure.Height = 320 <br> <br>    CosmoFigure.Visible = False <br>    CosmoFigure.Visible = True <br> <br>    CosmoFigure.AddPoint 2000, 2000 <br>    CosmoFigure.AddPoint 30000, 30000 <br>    CosmoFigure.AddPoint 30000, 2000 <br>    CosmoFigure.AddPoint 2000, 30000 <br>    CosmoFigure.AddPoint 14880, 7522 <br>    CosmoFigure.AddPoint 25463, 7823 <br>    CosmoFigure.AddPoint 3241, 21894 <br>    CosmoFigure.RemovePoint <br> <br>    CosmoFigure.BackColor = RGB(0, 0, 255) <br>    CosmoFigure.LineColor = RGB(255, 255, 255) <br> <br>    Debug.Print CosmoFigure.BackColor <br>    Debug.Print CosmoFigure.LineColor <br>    Debug.Print CosmoFigure.LineStyle <br> <br>    CosmoFigure.LineStyle = 3 <br> <br>    CosmoFigure.Cut <br>    CosmoFigure.Paste <br> <br>    Set FigTemp = CosmoFigure.Application.Figures.Add <br>    FigTemp.Visible = True <br>    FigTemp.Activate <br>    CosmoFigure.Activate <br>    CosmoFigure.Copy <br>    FigTemp.Activate <br>    FigTemp.Paste <br>    FigTemp.Close (False) <br>    Set FigTemp = Nothing <br> <br>    CosmoFigure.Activate <br>    CosmoFigure.SaveAs ("c:\temp\temp.cos") <br>    CosmoFigure.RemovePoint <br>    CosmoFigure.RevertToSaved <br>    CosmoFigure.LineStyle = 0 <br>    CosmoFigure.Save <br> <br>    CosmoFigure.RemovePoint <br>    CosmoFigure.RemovePoint <br>    CosmoFigure.RemovePoint <br> <br>    CosmoFigure.Import ("c:\inole\chap14\cosmotst\newvb\samp1.cos") <br> <br>    Set FigTemp = CosmoFigure.Application.ActiveFigure <br>    Debug.Print "Cosmo.ActiveFigure=" + FigTemp.Name <br>    Set FigTemp = Nothing <br>End Sub <br></code></pre>
<p>&nbsp;</p></body>
</HTML>
