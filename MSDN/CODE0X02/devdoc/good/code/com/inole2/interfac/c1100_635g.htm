<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ICONSITE.CPP</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context1114"></a>ICONSITE.CPP</h2>
<pre><code>/* <br> * ICONSITE.CPP <br> * <br> * Template IOleControlSite interface implementation. <br> * <br> * Copyright (c)1993-1995 Microsoft Corporation, All Rights Reserved <br> * <br> * Kraig Brockschmidt, Microsoft <br> * Internet  :  kraigb@microsoft.com <br> * Compuserve:  &gt;INTERNET:kraigb@microsoft.com <br> */ <br> <br> <br>#include "iconsite.h" <br> <br> <br>/* <br> * CImpIOleControlSite::CImpIOleControlSite <br> * CImpIOleControlSite::~CImpIOleControlSite <br> * <br> * Parameters (Constructor): <br> *  pObj            LPVOID of the object we're in. <br> *  pUnkOuter       LPUNKNOWN to which we delegate. <br> */ <br> <br>CImpIOleControlSite::CImpIOleControlSite(LPVOID pObj <br>    , LPUNKNOWN pUnkOuter) <br>    { <br>    m_cRef=0; <br>    m_pObj=pObj; <br>    m_pUnkOuter=pUnkOuter; <br>    return; <br>    } <br> <br>CImpIOleControlSite::~CImpIOleControlSite(void) <br>    { <br>    return; <br>    } <br> <br> <br> <br>/* <br> * CImpIOleControlSite::QueryInterface <br> * CImpIOleControlSite::AddRef <br> * CImpIOleControlSite::Release <br> * <br> * Purpose: <br> *  Delegating IUnknown members for CImpIOleControlSite. <br> */ <br> <br>STDMETHODIMP CImpIOleControlSite::QueryInterface(REFIID riid <br>    , LPVOID *ppv) <br>    { <br>    return m_pUnkOuter-&gt;QueryInterface(riid, ppv); <br>    } <br> <br>STDMETHODIMP_(ULONG) CImpIOleControlSite::AddRef(void) <br>    { <br>    ++m_cRef; <br>    return m_pUnkOuter-&gt;AddRef(); <br>    } <br> <br>STDMETHODIMP_(ULONG) CImpIOleControlSite::Release(void) <br>    { <br>    --m_cRef; <br>    return m_pUnkOuter-&gt;Release(); <br>    } <br> <br> <br> <br> <br> <br>/* <br> * CImpIOleControlSite::OnControlInfoChanged <br> * <br> * Purpose: <br> *  Informs the site that the CONTROLINFO for the control has <br> *  changed and we thus need to reload the data. <br> * <br> * Parameters: <br> *  None <br> */ <br> <br>STDMETHODIMP CImpIOleControlSite::OnControlInfoChanged(void) <br>    { <br>    return NOERROR; <br>    } <br> <br> <br> <br> <br> <br>/* <br> * CImpIOleControlSite::LockInPlaceActive <br> * <br> * Purpose: <br> *  Forces the container to keep this control in-place active <br> *  (but not UI active) regardless of other considerations, or <br> *  removes this lock. <br> * <br> * Parameters: <br> *  fLock           BOOL indicating to lock (TRUE) or unlock (FALSE) <br> *                  in-place activation. <br> */ <br> <br>STDMETHODIMP CImpIOleControlSite::LockInPlaceActive(BOOL fLock) <br>    { <br>    return ResultFromScode(E_NOTIMPL); <br>    } <br> <br> <br> <br> <br> <br>/* <br> * CImpIOleControlSite::GetExtendedControl <br> * <br> * Purpose: <br> *  Returns a pointer to the container's extended control that wraps <br> *  the actual control in this site, if one exists. <br> * <br> * Parameters: <br> *  ppDispatch      LPDISPATCH * in which to return the pointer <br> *                  to the extended control's IDispatch interface. <br> */ <br> <br>STDMETHODIMP CImpIOleControlSite::GetExtendedControl(LPDISPATCH <br>    *ppDispatch) <br>    { <br>    *ppDispatch=NULL; <br>    return ResultFromScode(E_NOTIMPL); <br>    } <br> <br> <br> <br> <br> <br> <br>/* <br> * CImpIOleControlSite::TransformCoords <br> * <br> * Purpose: <br> *  Converts coordinates in HIMETRIC units into those used by the <br> *  container. <br> * <br> * Parameters: <br> *  pptlHiMet       POINTL * containing the coordinates to transform <br> *  pptlCont        POINTF * in which to return the new coordinates <br> *  dwFlags         DWORD containing instructional flags. <br> */ <br> <br>STDMETHODIMP CImpIOleControlSite::TransformCoords(POINTL *pptlHiMet <br>    , POINTF *pptlCont, DWORD dwFlags) <br>    { <br>    return ResultFromScode(E_NOTIMPL); <br>    } <br> <br> <br> <br> <br> <br>/* <br> * CImpIOleControlSite::TranslateAccelerator <br> * <br> * Purpose: <br> *  Instructs the object to translate a keyboard accelerator <br> *  message that the control has picked up instead. <br> * <br> * Parameters: <br> *  pMsg            LPMSG to the message to translate. <br> *  grfModifiers    DWORD flags with additional instructions. <br> */ <br> <br>STDMETHODIMP CImpIOleControlSite::TranslateAccelerator(LPMSG pMsg <br>    , DWORD grfModifiers) <br>    { <br>    return ResultFromScode(E_NOTIMPL); <br>    } <br> <br> <br> <br> <br> <br> <br>/* <br> * CImpIOleControlSite::OnFocus <br> * <br> * Purpose: <br> *  Informs the container that focus has either been lost or <br> *  gained in the control. <br> * <br> * Parameters: <br> *  fGotFocus       BOOL indicating that the control gained (TRUE) <br> *                  or lost (FALSE) focus. <br> */ <br> <br>STDMETHODIMP CImpIOleControlSite::OnFocus(BOOL fGotFocus) <br>    { <br>    return NOERROR; <br>    } <br> <br> <br> <br> <br>/* <br> * CImpIOleControlSite::ShowPropertyFrame <br> * <br> * Purpose: <br> *  Instructs the container to show the property frame if <br> *  this is an extended object and requires its own property <br> *  pages. <br> * <br> * Parameters: <br> *  None <br> */ <br> <br>STDMETHODIMP CImpIOleControlSite::ShowPropertyFrame(void) <br>    { <br>    return ResultFromScode(E_NOTIMPL); <br>    } </code></pre>
<p>&nbsp;</p></body>
</HTML>
