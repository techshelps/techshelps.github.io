<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>README.TXT</title>
<link disabled rel=stylesheet href=../../../../../backsdk3.css>
<style type="text/css">
@import url(../../../../../backsdk4.css);
</style>
</HEAD>
<BODY BGCOLOR = #FFFFFF TEXT = #000000>
<h2><a name="_code_context1424"></a>README.TXT</h2>
<pre><code>OLE Automation Server that Implements Collections <br> <br> <br>SUMMARY <br>======= <br> <br>The LINES sample is an OLE Automation server application that implements  <br>collections. LINES allows a collection on lines to be drawn on a pane using  <br>OLE Automation. It exposes the following objects: <br> <br>Application object <br>    Properties <br>        Application <br>        FullName <br>        Name <br>        Pane (Returns the pane in the drawing window) <br>        Parent <br>        Visible <br>    Methods <br>        CreateLine (Returns a new Line object with no start point or  <br>          endpoint) <br>        CreatePoint (Returns a new Point object initialized to (0,0)) <br> <br>Pane object <br>    Properties <br>        Lines (Returns a collection of all Line objects in the drawing) <br>        Points (Returns a collection of all Point objects in the drawing) <br>        MaxX (Returns the maximum visible X-coordinate value, in twips) <br>        MaxY (Returns the maximum visible Y-coordinate value, in twips) <br>    Methods <br>        Clear (Removes all Lines and Points from the drawing and refreshes  <br>                the client area. It is as if the application had just  <br>                started) <br>        Refresh (Clears the drawing and redraws each line in the collection) <br> <br>Line object <br>    Properties <br>        Color (An RGB color) <br>        EndPoint (A Point object indicating the endpoint for the line) <br>        StartPoint (A Point object indicating the start point for the line) <br>        Thickness (A thickness, in twips) <br> <br>Point object <br>    Properties <br>        x <br>        y <br> <br>Lines collection <br> <br>  - Standard collection properties and methods. Objects that are added must  <br>    be of type Line.  <br>  - Objects returned are of type Line. <br>  - Add and Remove cause redrawing of the pane. <br>  - Adding a line causes two points to be added to the Points collection.  <br>  - Removing a line can cause one or more points to be removed from the  <br>    points collection. <br> <br>Points collection <br> <br>  - Standard collection properties and methods. Objects returned are of type  <br>    Point. <br>  - This collection does not allow addition and removal of members. <br>  - The Points collection does not have duplicates. If there are two lines  <br>    in the drawing that share an endpoint (x, y), (x, y) appears in the  <br>    collection only once. <br> <br>MORE INFORMATION <br>================ <br> <br>This sample implements the following features: <br> <br>  - Dual interfaces that allow access to automation properties and methods  <br>    through vtable binding and through IDispatch.  <br>  - Rich Error information for vtable-binding controllers. This is done by  <br>    implementing ISupportErrorInfo and using IErrorInfo. <br>  - Two collections. <br>  - Active object registration, using RegisterActiveObject and  <br>    RevokeActiveObject.  <br>  - Correct shutdown behavior.  <br>  - A registry file that contains Lines.Application as progID. <br>  - Initial invisibility. <br> <br> <br>To compile: <br>----------- <br> <br>To compile an ANSI debug version of the sample for Windows NT and Windows 95, <br>use the following command: <br> <br>   nmake <br> <br>To compile a Unicode debug version of the sample for Windows NT only, use the <br>following command: <br> <br>   nmake dev=win32 HOST=NT <br> <br>To compile a 16-bit debug version of the sample and if your development <br>environment is Win 3.x, use the following command. If your development <br>environment is Win95 or NT, change the HOST appropriately. <br> <br>   nmake dev=win16 HOST=DOS <br> <br>Also modify the .REG file to use 16 bit version of the keys. For example <br>use LocalServer instead of LocalServer32. <br> <br>To clean up between builds which use different options, use one of the <br>following commands: <br> <br>   nmake clean <br>   nmake dev=win16 clean <br> <br>See the makefile header comments for other make options. <br> <br>If one of the build tools cannot find SDKUTIL.LIB, use the SAMPLES\COM\COMMON <br>sample to build SDKUTIL.LIB. <br> <br>Visual C++ 2.x and above can use makefile as an external makefile  <br>after making the following replacement in the makefile: <br> <br>   !include &lt;$(MSTOOLS)\samples\com\include\olesampl.mak&gt; <br> <br>with <br> <br>   !include &lt;win32.mak&gt; <br> <br> <br>To run: <br>------- <br> <br>Change LINES.REG to provide the full path of LINES.EXE and LINES.TLB. <br>Register lines.reg in the registration database by double-clicking it. <br> <br>The VB 4.0 files vb.frm &amp; vb.vbp in this directory will control the sample.  <br>Load vb.vbp into VB 4.0, reference the lines type library using <br>VB's Tools/References menu and run. This will launch and control LINES.  <br> <br>Files <br>------ <br> <br>LINES.ODL  Object description language that describes the objects LINES <br>exposes. <br> <br>TLB.H  Header file generated by mktyplib.exe <br> <br>MAKEFILE  Makefile for project. <br> <br>Other files implement the LINES automation server. </code></pre>
<p>&nbsp;</p></body>
</HTML>
