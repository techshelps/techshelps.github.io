<HTML>

<Head>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Customizing Client Installations</TITLE>

<META NAME="GENERATOR" CONTENT="Internet Assistant For Microsoft Word&nbsp;2.0z Beta">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#ffffff" TOPMARGIN=0 LEFTMARGIN=0>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>


<!--TOPBAR_START-->

<TABLE WIDTH=100% CELLPADDING=0 CELLSPACING=0 BORDER=0 BGCOLOR="#000000">
<TR>
<TD WIDTH=100% HEIGHT=20 VALIGN=TOP>&nbsp;</TD>
</TR>
</TABLE>

<!--TOPBAR_END-->

<!--Header/Footer Info_START-->
<TABLE WIDTH=98% BORDER=0 CELLPADDING=0>
<TR>
<TD WIDTH=20% ALIGN=LEFT><FONT COLOR="#000000" FACE="VERDANA,ARIAL,HELVETICA" Size=1>
<B>C H A P T E R &nbsp;&nbsp; 6</B></FONT></TD>
<TD WIDTH=50% ALIGN=CENTER><FONT COLOR="#000000" FACE="VERDANA,ARIAL,HELVETICA" Size=1>
<B>Part 2&nbsp;&nbsp;Deploying Microsoft Office</B></FONT></TD>
<TD WIDTH=30% ALIGN=RIGHT><FONT COLOR="#000000" FACE="VERDANA,ARIAL,HELVETICA" SIZE=1>
<B>Microsoft Office Resource Kit</B></FONT></TD></TR>
</TABLE>
<P>
<!--Header/Footer Info_END-->

<P><!--NAV_START-->
<TABLE WIDTH="98%" BGCOLOR="#ffffff" BORDER=0 CELLSPACING=0 CELLPADDING=3>
<TR><TD VALIGN="TOP" WIDTH=68%><FONT SIZE=5><B>Customizing Client Installations</B></FONT></TD>
<TD WIDTH=30% VALIGN=TOP ALIGN=RIGHT>
<a href="005.htm"><IMG SRC="prevpage.gif" ALT="Previous" BORDER="0" ALIGN="RIGHT"></A>
<BR>
<BR>
<A HREF="fulltoc.htm"><IMG SRC="CNTBUTT.gif" ALT="Contents" BORDER="0" ALIGN="RIGHT"></A>
</TD>
<TD WIDTH=10% VALIGN=TOP ALIGN=RIGHT>
<a href="007.htm"><IMG SRC="nextpage.gif" ALT="Next" BORDER="0" ALIGN=RIGHT></A>
<BR>
<BR>
<A HREF="a.htm"><IMG SRC="indxbutt.gif" ALT="Index" BORDER="0" ALIGN=RIGHT></A>

</TD>
</TR>
</TABLE><HR>
<!--NAV_END-->
<MENU><MENU><MENU>

<P>
<FONT SIZE=3><B>In This Chapter</B></FONT>
<BR>
<A HREF="#ORK006C1">Understanding the
Office Setup Program</A>
<BR>
<A HREF="#ORK006C2">Modifying Client
Setup with the Network Installation Wizard</A>
<BR>
<A HREF="#ORK006C3">Running Client Setup with the Modified STF File</A>
<BR>

<P>
<FONT SIZE=3><B><A NAME="_Toc363801679">See Also</A></B></FONT>

<P>
<UL TYPE="square">
<P>
<LI>For information about installing Office applications, see Chapter&nbsp;4,
"<a href="004.htm">Installing Microsoft Office</A>."
<P>
<LI>For information about installing and configuring Windows&nbsp;NT Workstation
and Office&nbsp;97 on client computers using the Zero Administration Kit
(ZAK), see "<a href="004.htm#CH004H103">Installing Office&nbsp;97 with the Zero Administration Kit</A>" in
Chapter&nbsp;4, "Installing Microsoft Office."
<P>
<LI>For information about deploying and customizing Office&nbsp;98 for the
Macintosh, see "<a href="004.htm#CH004H105">Rolling Out Office&nbsp;98 for the Macintosh</A>" in Chapter&nbsp;4, "Installing Microsoft Office."
<P>
<LI>For information about system requirements for Office, see Chapter&nbsp;5, "<a href="005.htm">System
Requirements for Microsoft Office</A>."
<P>
</UL>
<P>
The flexibility available in the standard Setup process is sufficient
for many situations. But there are cases in which it is beneficial
to customize the client installation process using the tools and strategies
described in this chapter. For example, if you want to install a uniform
configuration of Microsoft Office&nbsp;97 for Windows on all your
client computers, including a particular selection of converters and
templates, you can create a customized Setup script using the Network Installation Wizard.

<P>
</MENU></MENU>
<TABLE WIDTH=93% CELLPADDING=0 CELLSPACING=0 BORDER=0>

<TR>

<TD WIDTH=80 ALIGN=RIGHT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><IMG SRC="WINDOWSO.GIF" WIDTH=27 HEIGHT=27 BORDER=0 ALT="">&nbsp;&nbsp;</FONT></TD><TD><B><FONT SIZE=2 COLOR="#0000FF" FACE="VERDANA,ARIAL,HELVETICA">Note&nbsp;&nbsp;&nbsp;</FONT></B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
The information in the following sections pertains only to Office&nbsp;97 for Windows and the Windows&nbsp;95 and Windows&nbsp;NT operating systems.</FONT>

</TD>

</TR>

</TABLE>
<P>
<MENU><MENU>
<A NAME="ORK006C1"></A>
</MENU></MENU></MENU>
<!--ToTop_START-->
<TABLE width=98% cellpadding=0 cellspacing=0 border=0>
<TR><TD align=right><TABLE cellpadding=0 cellspacing=0 border=0><TR><TD><A href="#top"><FONT SIZE=1 FACE="VERDANA,ARIAL,HELVETICA">Top</FONT></A></TD><TD><A href="#top"><IMG SRC="ar_up.gif" WIDTH=11 HEIGHT=7 BORDER=0 ALIGN=MIDDLE></A></TD></TR></TABLE>
</TD></TR>

</TABLE>
<HR>
<!--ToTop_END-->
<MENU>
<FONT SIZE=5><B><A NAME="CH006H101">Understanding the Office Setup Program</A></B></FONT>
<MENU><MENU>

<P>
<a name="dex1"></a>
<P>
The Office Setup program receives all of its instructions from
a set of tables that describe which files are to be installed
and how each installation is to occur. Setup uses the following
three primary files:
<P>
<UL TYPE="square">
<P>
<LI>The tables in the Off97Std.stf
or Off97Pro.stf (STF) file specify where and in what order files
are copied and what registry entries are created.
<P>
<LI>The
tables in the Off97Std.inf or Off97Pro.inf (INF) file contain
detailed descriptions of all Offices files and are used by the
STF file to determine which files to copy during installation.
<P>
<LI>The instructions in the Setup.1st (LST) file provide Setup with
the names of the STF and INF files and installation parameters.
</UL>
<P>
These files are designed for the standard Office client installation
process. By making modifications, however, you can create a customized
client installation process.
<P>
<IMG SRC="Caution.gif" WIDTH=366 HEIGHT=11 BORDER=0 ALT="">
<BR>
<P>
<UL TYPE="square">
<FONT COLOR="#FFCC33"><B>Caution&nbsp;&nbsp;&nbsp;</B></FONT>Do
not modify any of these files with a standard text editor.
The STF and INF files are tab-delimited files that rely heavily
on positional parameters, and they can easily be damaged by modifying
them with anything other than the tools described here. In particular,
the LST file provides information to Setup that, if modified incorrectly,
causes the installation to fail.
</UL>
<P>
<IMG SRC="Caution.gif" WIDTH=366 HEIGHT=11 BORDER=0 ALT="">
<BR>

<P>
For more information about the contents of the Setup files, see
Appendix&nbsp;B, "<A HREF="AppB.htm">Setup Command-Line Options and File Formats</A>."
<P>
<FONT SIZE=4><B><A NAME="CH006H201">Customizing a Network Installation</A>
</B></FONT>

<P>
<a name="dex2"></a>
<P>
The LST, STF, and INF files reside in the same folder as Setup.exe.
The most common method for creating customized client installations
is to create an administrative installation point and modify these
Setup files directly on the server. That way, all users who install
Office over the network run the custom client installation that
you design.
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>The
majority of this chapter assumes a network installation. If you are installing Office directly from the Office CD or floppy disks, you cannot customize the Setup process using the tools described in this chapter.  For
more information about network installations, see Chapter&nbsp;4,
"<a href="004.htm">Installing Microsoft Office</A>."
<P>
<a name="dex3"></a>
<P>
There are two ways you can modify the Setup files to customize
the client installation. You can change values in the STF file
to select the following:
<P>
<UL TYPE="square">
<P>
<LI>Type of installation to
use during batch mode (Typical, Custom, or Run from Network Server).
<P>
<LI>Specific
components, such as Microsoft Word or the spelling checker, to
install during batch mode.
<P>
<LI>Destination folders
to use for Office and its components.
<P>
<LI>Responses
to Yes/No questions, such as "Would you like to remove your
previous version of Office?"
<P>
<LI>Items to appear
on the Windows <B>Start</B> menu or Windows&nbsp;NT Workstation
version&nbsp;3.51 program group.
<P>
<LI>Default working
folder for <B>Start</B> menu and Windows&nbsp;NT Workstations&nbsp;3.51 program group items.
<P>
</UL>
<P>
<a name="dex5"></a>

You can also add new entries to the STF or INF file so that Setup
performs the following additional tasks during client installation:
<P>
<UL TYPE="square">
<P>
<LI>Create additional registry
settings.
<P>
<LI>Install files other than Office files.
</UL>
<A NAME="CH006H202"></A>


<P>
<A NAME="ORK006C2"></A>
</MENU></MENU></MENU>
<!--ToTop_START-->
<TABLE width=98% cellpadding=0 cellspacing=0 border=0>
<TR><TD align=right><TABLE cellpadding=0 cellspacing=0 border=0><TR><TD><A href="#top"><FONT SIZE=1 FACE="VERDANA,ARIAL,HELVETICA">Top</FONT></A></TD><TD><A href="#top"><IMG SRC="ar_up.gif" WIDTH=11 HEIGHT=7 BORDER=0 ALIGN=MIDDLE></A></TD></TR></TABLE>
</TD></TR>

</TABLE>
<HR>
<!--ToTop_END-->
<MENU>
<FONT SIZE=5><B><A NAME="CH006H102">Modifying Client Setup with the Network Installation Wizard</A>
</B></FONT>
<MENU><MENU>

<P>
<a name="dex7"></a>
<P>
The Network Installation Wizard modifies the LST, STF, and INF files
for the client Setup used in Office&nbsp;97. Using this tool,
you can change the values for items in the STF file. If the user
installs Office in batch mode, Setup uses the default values you
specify in the modified STF file. If the user installs Office
in interactive mode, the values you set with the Network Installation
Wizard appear as default responses during client Setup.
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>The
Network Installation Wizard runs on the Windows&nbsp;95 or Windows&nbsp;NT
operating system only.
<P>
</MENU></MENU>
<P>
<TABLE WIDTH=93% CELLPADDING=0 CELLSPACING=0 BORDER=0>

<TR>

<TD WIDTH=80 ALIGN=RIGHT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><IMG SRC="CDO.GIF" WIDTH=27 HEIGHT=27 BORDER=0 ALT="">&nbsp;&nbsp;</FONT></TD><TD><B><FONT SIZE=2 COLOR="#0000FF" FACE="VERDANA,ARIAL,HELVETICA">Tools and Utilities&nbsp;&nbsp;&nbsp;</FONT></B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The Office Resource Kit Tools and Utilities include a new version
of the Network Installation Wizard that replaces
the Network Installation Wizard in the <I>Microsoft Office for Windows&nbsp;95
Resource Kit</I>. This new version works with STF and INF files from both Office&nbsp;97
and Office 95. For information about installing the updated Network
Installation Wizard, see "<A HREF="appa.htm#CHappaH201">Network
Installation Wizard Version 2.1</A>" in Appendix&nbsp;A, "Microsoft
Office Resource Kit Tools and Utilities."</FONT>

</TD>

</TR>

</TABLE>
<MENU><MENU>
<P>To understand how the Network Installation Wizard modifies Office
Setup, first become familiar with the basic client installation
process for Office. If you have not already done so, read Chapter&nbsp;4,
"<a href="004.htm">Installing
Microsoft Office</A>."
<P>
The Network Installation Wizard guides you through the process
of creating a customized Setup in the following steps:
<P>
<OL>
<P>
<LI>Start the Network Installation
Wizard.
<P>
<LI>Specify the appropriate LST file.
<P>
<LI>Select a destination folder for the Office
application files.
<P>
<LI>Select a default folder for
Office documents.
<P>
<LI>Select a location for shared
Office applications.
<P>
<LI>Specify an installation
log (optional).
<P>
<LI>Choose the type of installation.
<P>
<LI>Configure the installation environment.
<P>
<LI>Select items for the Desktop, <B>Start</B> menu, or Program Manager.
<P>
<LI>Specify the destination folder for the LST, STF, and INF files, and any additional files you add to the installation.
<P>
<LI>Add additional files to the Office installation (optional).
<P>
<LI>Add Windows registry entries (optional).
<P>
<li>Select type of quiet mode for client Setup (optional).
<P>
<LI>Save changes to the LST, STF, and INF files.
<P>
</OL>
<P>
<a name="dex8"></a>
<P>
The following sections describe each of these steps in more detail.
<P>
<!-- /MENU --><!-- /MENU -->
<!-- TABLE WIDTH=100% CELLPADDING=0 CELLSPACING=0 BORDER=0 -->
<!-- TR -->
<!-- TD WIDTH=42 VALIGN=TOP --><!-- FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2 --><!-- IMG SRC="WEBO.gif" HSPACE=4 --><!-- /FONT -->
<!-- /TD --><!-- TD --><!-- B --><!-- FONT SIZE=2 COLOR="#0000FF" FACE="VERDANA,ARIAL,HELVETICA" --><!-- World Wide
Web&nbsp;&nbsp;&nbsp; --><!-- /FONT --><!-- /B --><!-- FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2 --><!-- For the
latest information about the Network Installation Wizard, connect
to the Office Resource Kit home page at: --><!-- /FONT -->

<!-- /TD -->

<!-- /TR -->

<!-- /TABLE -->
<!-- MENU --><!-- MENU -->
<!-- P --><!-- http://www.microsoft.com/office/ork/ -->
<P>
</MENU></MENU>
<P>
<TABLE WIDTH=93% CELLPADDING=0 CELLSPACING=0 BORDER=0>

<TR>

<TD WIDTH=80 ALIGN=RIGHT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><IMG SRC="CDO.GIF" WIDTH=27 HEIGHT=27 BORDER=0 ALT="">&nbsp;&nbsp;</FONT></TD><TD><B><FONT SIZE=2 COLOR="#0000FF" FACE="VERDANA,ARIAL,HELVETICA">Tools and Utilities&nbsp;&nbsp;&nbsp;</FONT></B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The
Office Resource Kit Tools and Utilities include documents that
describe more advanced techniques for customizing your Office
installation. For more information, see "<A HREF="appa.htm#CHappaH215">Advanced Documentation</A>" in Appendix&nbsp;A, "Microsoft
Office Resource Kit Tools and Utilities."</FONT>

</TD>

</TR>

</TABLE>
<P>
<MENU><MENU>
<TABLE WIDTH=70% VALIGN="TOP" CELLPADDING=15 CELLSPACING=0 BORDER=1 BORDERCOLOR=#0000FF><TR BGCOLOR="#FFFFFF"><TD>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
<P>
<B><A NAME="EditIntItem">Editing International STF Files</A></B>
<P>
Although the user interface of the Network Installation Wizard is English
only, the Network Installation Wizard can edit STF files of any language.
You can edit STF files for international versions of Office (including double&#173;byte
character system versions such as Japanese, Korean, and Chinese) by using
the Network Installation Wizard version 2.1, which is included with the Office Resource
Kit Tools and Utilities.
<P>
For more information about this version of the Network Installation Wizard,
see "<A HREF="Appa.htm#CHappaH201">Network Installation Wizard Version 2.1</A>" in Appendix A, "Office
Resource Kit Tools and Utilities."
<br>
</FONT></TD></TR>
</TABLE>

</MENU></MENU>

<MENU><MENU>
<P><P>
<FONT SIZE=4><B><A NAME="CH006H203">Start the Network Installation Wizard</A>
</B></FONT>

<a name="dex9"></a>
<P>
Like other Office wizards, the Network Installation Wizard guides you through a series of panels and
options. You proceed to the next panel by clicking <B>Next</B>,
and you can go back to the previous panel by clicking <B>Back</B>.
The Setup files are not modified until you click <B>Finish</B>, so
you can go back and change any answers before you complete the
final panel.
<P>
You can quit the Network Installation Wizard at any time by clicking
<B>Cancel</B>.
<P>
<IMG SRC="00601.gif">
<P>
<FONT SIZE=4><B><A NAME="CH006H204">Specify the LST or STF File</A></B></FONT>

<P>
<a name="dex10"></a>
<P>
After the initial <B>Welcome</B> panel, the Network Installation
Wizard asks for the name of the LST file to customize. Enter the
name of the LST file from the folder containing the main Office
application files. For example, in Office&nbsp;97 Professional
Edition, the LST file name is Setup.lst.
<P>
<FONT SIZE=2 COLOR="#0000FF"><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>
Office&nbsp;95 does not use an LST file. If you are customizing an Office&nbsp;95
installation, you must specify the STF file instead. In the <B>Open LST or STF File</B>
panel, click <B>Browse</B>. In the <B>Files of type</B> box, select
<B>Setup Table File (*.stf)</B> and then select the correct STF file.
<P>
The Network Installation Wizard finds the name of the STF file, which
is defined in the LST file, and then opens the STF file. The Network
Installation Wizard looks for the STF and INF files in the same folder
in which the LST file resides. While the Network Installation Wizard is
reading the STF file, which can take a minute or two, it displays a progress bar.
<P>
<IMG SRC="00602.gif">
<P>
After opening the STF file, the Network Installation Wizard opens
the INF file specified in the STF file. The INF file resides in the same folder
as the STF file and has the same file name with an INF extension.
In Office&nbsp;97 Professional Edition, the name of the INF file
is Off97Pro.inf. If the Network Installation Wizard cannot find
the INF file specified in the STF file, you are prompted to enter the
location and name of the file.
<P>
<FONT SIZE=4><B><A NAME="CH006H205">Select a Primary Location for the Office
Application Files</A></B></FONT>

<P>
<a name="dex11"></a>
<P>
The Network Installation Wizard then displays the name of the
folder where the main Office application files are installed during
client Setup. You can change the default folder by entering a
new name, or by clicking <B>Browse</B> and selecting a new folder.
<P>
<a name="dex12"></a>
<P>
<IMG SRC="00603.gif">
<P>
If you run client Setup in batch mode (using the <B>/q</B> command&#173;line
option), Setup installs the Office application files in this folder.
If a user runs client Setup interactively, this folder appears
as the default folder, which the user can change.
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>Remember
that the folder name you enter here is used by Setup when users
install Office. If you specify a folder on a network server, that
folder must be accessible during client Setup. If you specify
a local folder, Setup creates a folder with that name on the user's
hard disk.
<P>
<FONT SIZE=4><B><A NAME="CH006H206">Select a Default Folder for Office Documents</A>
</B></FONT>

<P>
<a name="dex13"></a>
<P>
Both Windows&nbsp;95 and Windows&nbsp;NT Workstation version&nbsp;4.0
provide a default folder to store all user documents, including
Office documents. By default, this folder is named My Documents
and is located at the root directory of the C drive. If the default
folder has not yet been defined on the user's hard disk, the Network
Installation Wizard allows you to specify a name and path for
this folder, which is created during client Setup. If the folder
has already been defined in the user's hard disk, then setting
this option has no effect.
<P>
<a name="dex14"></a>
<P>
<IMG SRC="00604.gif">
<P>
</MENU></MENU>
<P>
<TABLE WIDTH=93% CELLPADDING=0 CELLSPACING=0 BORDER=0>

<TR>

<TD WIDTH=80 ALIGN=RIGHT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><IMG SRC="WINDOWSO.GIF" WIDTH=27 HEIGHT=27 BORDER=0 ALT="">&nbsp;&nbsp;</FONT></TD><TD><B><FONT SIZE=2 COLOR="#0000FF" FACE="VERDANA,ARIAL,HELVETICA">Tip&nbsp;&nbsp;&nbsp;</FONT></B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>In
Windows&nbsp;95 and Windows&nbsp;NT Workstation&nbsp;4.0, you
can use a system policy to define a default file name and path
for the documents folder for all users in your workgroup. In the
System Policy Editor, set the following policy:</FONT>

</TD>

</TR>

</TABLE>
<MENU><MENU>
<P><B>User\Office\Common\Personal Folder</B>
<P>
For more information, see "<a href="007.htm#CH007H101">Using
Windows System Policies to Customize Office</A>" in
Chapter&nbsp;7, "Customizing and Optimizing Microsoft Office."
<P>
<FONT SIZE=4><B><A NAME="CH006H207">Select a Location for Shared Office Applications</A>
</B></FONT>

<P>
<a name="dex15"></a>
<P>
Next, the Network Installation Wizard displays a panel similar
to the dialog box that was displayed when you created the administrative
installation point. The options in this panel determine whether
users choose where to install shared applications, or whether
you make that choice for them. The panel contains these options:
<P>
<UL TYPE="square">
<P>
<LI><B>Server</B>
<P>
Shared applications are stored on the server, and
users run them over the network. Users running client Setup do
not make the choice.
<P>
<LI><B>Local hard drive</B>
<P>
Shared applications are installed on each user's computer.
Users running client Setup do not make the choice.
<P>
<LI><B>User's choice</B>
<P>
Users choose where to install shared applications
when they run client Setup.
<P>
</UL>
<P>
<IMG SRC="00605.gif">
<BR>
<P>
If users install Office in batch mode with no user interaction,
you must select either <B>Server</B> or <B>Local hard drive</B>.
If you select <B>Server</B>, a second panel is displayed for you
to specify a location on the network for the shared applications.
(This panel is also displayed if you select <B>User's choice</B>,
since users in that scenario may choose to store shared applications
on the network.)
<P>
<IMG SRC="00606.gif">
<P>
<a name="dex16"></a>
<P>
Under <B>Connect to server using</B>, you can specify whether
you want the location of the shared applications to be defined
with a drive letter or with a UNC path. If you select the <B>Drive
letters </B>option here, you must enter a drive letter and a path
under <B>Network location</B>. You do not need to have a valid
connection to the drive while running the Network Installation
Wizard. However, users must have a valid connection to the drive
during client Setup. If you select the <B>UNC</B> option, you
must enter a server name and path under <B>Network location</B>.
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>UNC
stands for Universal Naming Convention and refers to the \\servername\sharename
syntax used for defining servers and shared areas on the server
for LAN Manager&#173;compatible networks.
<P>
When you click <B>Next</B>, the Network Installation Wizard attempts
to connect to the server to verify it. If it encounters any errors,
the Network Installation Wizard asks whether you want to use the
path as specified. To continue and leave the path as it is, click
<B>Yes</B>; to change the path, click <B>No</B>.
<P>
<a name="dex17"></a>
<P>
The following table shows some reasons why the verification might
fail and what you can do to fix the problem.
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>If the error is caused by this</FONT></B>
</TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Do this</FONT></B></TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Misspelled server or share name.</FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Click <B>No </B>and correct the name.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Share not yet created.</FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Click <B>Yes </B>and create the share before users begin installing Office.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Cannot connect to a share on the server. (Many networks do not allow you to do this if you run directly from the server.)</FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Click <B>Yes</B>; you can verify the share later from another computer on the network.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Invalid UNC path</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Click <B>Yes</B>; verify that the share is accessible before users try to install from this server</FONT>
</TD></TR>

<P>
</TABLE>
<P>
<FONT SIZE=4><B><A NAME="CH006H208">Specify an Installation Log</A></B></FONT>

<P>
<a name="dex18"></a>
<P>
Office Setup can create a log file containing information about
the installation. If you specify a log file in the <B>Installation
Log</B> panel in the Network Installation Wizard, then each time
Office is installed from this administrative installation point,
Setup writes one record into the log file. The log file is a text
file, and each record contains the following fields:
<P>
<UL TYPE="square">
<P>
<LI>Date
<P>
<LI>Time
<P>
<LI>User
name
<P>
<LI>Machine name
<P>
<LI>Application
name&nbsp;&#151; MS Office&nbsp;97 Standard or MS Office&nbsp;97
Professional
<P>
<LI>Version&nbsp;&#151; a number
similar to 97.0.0.1114(1033)
<P>
<LI>Operation&nbsp;&#151;
for example, Install or RemoveAll
<P>
</UL>
<P>
The Network Installation Wizard gives you the opportunity to create
a log file by specifying the log file name. If you do not want
a log file, click <B>Next</B> without entering a file name.
<P>
<IMG SRC="00607.gif">
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>The
installation log file is a new feature of Setup for Office&nbsp;97.
If you are using the Network Installation Wizard with an Office
95 STF file, the Installation Log panel does not appear.
<P>
<FONT SIZE=4><B><A NAME="CH006H209">Choose the Type of Installation</A></B></FONT>

<P>
<a name="dex19"></a>
<P>
Office&nbsp;97 Setup offers three types of installation: Typical,
Custom, and Run from Network Server. If you select <B>Typical</B>
or <B>Custom</B> in the <B>Installation Type</B> panel, the Network
Installation Wizard displays the <B>Components</B> panel so you
can select which components you want Setup to install. If you
run Setup in batch mode (<B>/q</B> command&#173;line option) using
the Typical or Custom installation type (<B>/b</B> command&#173;line
option), Setup installs the components you selected.
<P>
For example, if you select <B>Custom</B> in the <B>Installation
Type</B> panel and then select a number of text converters in
the <B>Components</B> panel, you can use the command <B>setup.exe
/q /b2</B> to install those converters with Office. For more information
about Setup command&#173;line options, see Appendix&nbsp;B, "<A HREF="AppB.htm">Setup Command-Line Options and File Formats</A>."
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>After you
finish customizing the Setup files, the
Network Installation Wizard displays a suggested Setup command string
in the final panel. This string includes the correct installation type
parameter. For example, if you select <B>Typical</B> in the <B>Installation
Type</B> panel, the Network Installation Wizard displays in the final panel
a suggested command string that includes the parameter <B>/b1</B>.
<P>
If you run Setup interactively, then the components you select
with the Network Installation Wizard are displayed as default
selections.
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>A
fourth installation type, Run from CD, is available when you install
Office directly from the Office CD. Because you are modifying
the STF file for a network installation, that option is not discussed
here.
<P>
<IMG SRC="00608.gif">
<BR>
<P>
If you select <B>Typical</B> in the <B>Installation Type</B> panel,
the Network Installation Wizard displays the list of Typical installation
options in the <B>Components</B> panel in a format similar to
the one presented to an end user running client Setup in interactive
mode.
<P>
<IMG SRC="00622.gif">
<P>
If you select <B>Custom</B> in the <B>Installation Type</B> panel,
the Network Installation Wizard displays the list of Custom options
in the <B>Components</B> panel.
<P>
<IMG SRC="00609.gif">
<P>
<a name="dex20"></a>
<P>
When you select an installation option in the <B>All Components</B>
box, a description appears under <B>Description for selected</B>
<B>component</B>, and the folder name appears in the <B>Folder
for selected component</B> box. Each of these installation options
may have additional options&nbsp;&#151; if so, a plus sign
(+) appears to the left of the option in the <B>All Components</B>
box. Clicking the plus sign (+) expands the list, displaying its
additional components.
<P>
<IMG SRC="00610.gif">
<BR>
<P>
You can select all or only some of a set of additional components:
<P>
<UL TYPE="square">
<P>
<LI>If a check box is selected,
all of that option's additional components are selected.
<P>
<LI>If
a check box is cleared, none of that option's additional components
are selected.
<P>
<LI>If a check box is grayed, some
of that option's additional components are selected. Click the
plus sign (+) to see what those components are.
<P>
</UL>
<P>
The <B>Select All</B> button allows you to select all the Office
options, along with all their additional components.
<P>
<a name="dex21"></a>
<P>
If you use the modified STF file in batch mode, the state of a
check box for a particular option indicates whether the option
is installed when client Setup is run: selected options are installed;
cleared options are not.
<P>
<a name="dex22"></a>
<P>
If you use the modified STF file in interactive mode, the state
of the check boxes in the <B>All</B> <B>Components</B> box represents
the default settings that are presented to the user during client
Setup. For example, if you select the <B>Office Tools</B> check
box, that check box is selected when the user runs client Setup
interactively and views the options for a Custom installation.
<P>
With the <B>Browse</B> button you can modify the default folder
for a selected option. Both the long and short names of the folder
you select are kept in the STF file. However, the <B>Return long
folder name to previous dialog</B> check box in the <B>Browse
Folders</B> dialog box determines which form of the name is displayed
in the <B>Components</B> panel. This option does not affect the
STF file, but only the way you view the folder name in the Network
Installation Wizard. (The default is to use long folder names.)
<P>
<IMG SRC="00611.gif">
<BR>
<P>
<a name="dex23"></a>
<P>
When you are creating a customized network installation, you can
use a set of special folder identifiers to specify standard system
folders in the <B>Browse Folders</B> dialog box. That way, you
do not need to know the exact location of these folders on each
user's computer.
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>This folder identifier</FONT></B>
</TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Represents this folder</FONT></B>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>&lt;ParentDestFolder&gt;</FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The destination folder of the Office component.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>&lt;SetupSourceFolder&gt;</FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The folder from which Setup is run.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>&lt;WindowsFolder&gt;</FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The main Windows folder.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>&lt;SystemFolder&gt;</FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The Windows system folder.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>&lt;SharedFilesFolder&gt;</FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The folder in which shared applications are stored.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>&lt;ProgramFilesFolder&gt;</FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The Program Files folder in Windows&nbsp;95, or the Windows directory on Windows&nbsp;NT Workstation.</FONT>
</TD></TR>

<P>
</TABLE>
<P>
The Network Installation Wizard may also display the identifier
&lt;NoneSpecified&gt; for a particular folder. This
means that the folder name has not yet been determined, but will
be resolved by Setup during installation.
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>You
can specify a subfolder for any of these folders by appending
a backslash (&nbsp;\&nbsp;) and a subfolder name to the folder
identifier&nbsp;&#151; for example, <B>&lt;WindowsFolder&gt;\Media</B>.
<P>
<FONT SIZE=4><B><A NAME="CH006H210">Configure the Installation Environment</A>
</B></FONT>

<P>
<a name="dex24"></a>
<P>
The STF file contains a number of questions that Setup uses to
further configure the network installation. The questions Setup
displays to the user depend on previous user responses and on
the installation environment.
<P>
For example, suppose a user is installing Microsoft Outlook. If Setup finds
Microsoft Schedule+&nbsp;95 on the hard disk, Setup asks whether to
configure Outlook to use Schedule+ as the primary calendar. If
Schedule+&nbsp;95 is not found, Setup does not display that question.
If the same question can be asked in several situations during
installation, then the STF file defines that question in multiple
locations.
<P>
<a name="dex25"></a>
<P>
The Network Installation Wizard displays every Yes/No question
that may appear during client Setup in the STF file and allows
you to determine the default answers. Because a particular question
may appear more than once in the STF file, the Network Installation
Wizard may repeat the same question several times in the <B>Yes/No
Questions</B> panel. To ensure that your default answer is used
during client Setup, change every occurrence of the question in
this panel.
<P>
<IMG SRC="00612.gif">
<P>
Clicking a question in the <B>Yes/No Questions</B> panel switches
the answer from <B>Yes</B> to <B>No</B> and back again.
<P>
<TABLE WIDTH=70% VALIGN="TOP" CELLPADDING=15 CELLSPACING=0 BORDER=1 BORDERCOLOR=#0000FF>
<TR BGCOLOR="#FFFFFF"><TD>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
<P>
<B><A NAME="WhyDupItem">Why Are There Duplicate Items in the List?</A></B>
<P>
In some of the lists displayed in the Network Installation Wizard,
you may see what appear to be duplicate entries. This occurs because
there are several execution paths that Setup can take through
the STF file, depending on the configuration of the user's computer
and whether Setup finds a previous version of Office installed.
The same question may appear in more than one path; however, Setup
asks each question only once during installation.
<P>
Because the Network Installation Wizard does not know what path
Setup will take, it displays every instance of a question. If
you want to specify a default answer, you must do so for all the
duplicate questions in the list, so that Setup uses the same answer
in every context.
<P>
In these lists, the Network Installation Wizard displays an Object
ID column with the heading <B>ObjID</B>. The Object ID is a number
in the STF file that uniquely identifies each item in the list.
This number helps the Network Installation Wizard distinguish
between duplicate items in the STF. You do not need to use this
number when running the Network Installation Wizard.
<P>
For more information about the structure of the STF file, see
Appendix&nbsp;B, "<A HREF="AppB.htm">Setup
Command-Line Options and File Formats</A>."
<br>
</FONT></TD></TR>
</TABLE>

<P>
<FONT SIZE=4><B><A NAME="CH006H211">Select Items for Program Manager</A></B></FONT>

<P>
<a name="dex26"></a>
<P>
The Network Installation Wizard allows you to specify which application
icons you want to install in the Program Manager group when you
install Office on a computer running Windows&nbsp;NT Workstation&nbsp;3.51.
In the <B>Program Manager Items</B> panel, you can specify the
Program Manager group and the default working folder for each
item you select. The corresponding Program Manager icons are created
when you install Office on a computer running Windows&nbsp;NT
Workstation&nbsp;3.51.
<P>
<IMG SRC="00613.gif">
<P>
When you click an item in the <B>Program Manager Item</B> box,
the corresponding Program Manager group appears to the right.
You can change the group name, and you can select the <B>Prevent
users from changing groups during installation</B> check box if
you do not want users to modify the location of the selected item.
<P>
<a name="dex27"></a>
<P>
The working folder for the application appears below the <B>Program
Manager Items</B> box. This is the default folder used for creating
new files or browsing for existing files. Some applications explicitly
define the folder to be used for certain types of files (for example,
Word defines a specific folder to be used for template files),
in which case the working folder is used only for those files
that have no other folder explicitly defined for them. You can
change this folder by clicking <B>Browse</B>.
<P>
Clicking <B>Select None</B> clears the check boxes for all items
in the list.
<P>
<TABLE WIDTH=70% VALIGN="TOP" CELLPADDING=15 CELLSPACING=0 BORDER=1 BORDERCOLOR=#0000FF>
<TR BGCOLOR="#FFFFFF"><TD>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
<P>
<B>Which Icons Are Actually Installed?</B>
<P>
The items listed in the <B>Program Manager Items</B> panel include
all the program icons defined in the Office STF file; however,
not all of these icons are necessarily installed during client
Setup. The icons that are actually installed depend on the options
the user selects during Setup, along with other factors that Setup
encounters, such as whether a previous version of Office is installed.
Clearing a check box in this list, however, guarantees that the
corresponding icon is not installed.
<P>
If there are duplicates of an item in the list, only one corresponding
program icon is actually created in Program Manager during installation.
However, you must modify each duplicate item the same way, so
that the correct icon is created regardless of the path Setup
takes. For an explanation of duplicate items displayed in the
<B>Program Manager Items</B> or <B>Shortcuts</B> panels, see the
sidebar "<A HREF="#WhyDupItem">Why Are There Duplicate Items in the List?</A>"
earlier in this chapter.
<br>
</FONT></TD></TR>
</TABLE>

<P>
<FONT SIZE=4><B><A NAME="CH006H212">Select Shortcuts for the Start Menu or Desktop</A></B></FONT>

<P>
The <B>Start Menu and Desktop Items</B> panel in the Network Installation Wizard
allows you to select the shortcuts that appear in the Windows\Start
Menu folder or on the Desktop when you install Office on a computer running Windows&nbsp;95
or Windows&nbsp;NT Workstation&nbsp;4.0.
<P>
<IMG SRC="00623.gif">
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>The shortcuts
in the list include all the program files defined in the Office STF file;
however, not all of these items are necessarily installed during client
Setup. For more information about which items are installed and about how
Setup handles duplicate items, see the sidebar "Why Are There Duplicate
Items in the List?" earlier in this chapter.
<P>
To change the properties of a shortcut, select it in the list and then click
<B>Edit</B>. In the <B>Edit Shortcut</B> dialog box, you can change the folder
in which the shortcut is installed, as well as the name and working
folder of the shortcut.
<P>
<IMG SRC="00624.gif">

<P>
You can use a set of standard folder identifiers to specify Start Menu folders in the <B>Edit Shortcut</B> dialog box.
<P>

<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=50% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>This folder identifier</FONT></B>
</TD>
<TD WIDTH=50% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Represents this folder</FONT></B></TD>
</TR>

<TR><TD WIDTH=50% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>&lt;StartMenuFolder&gt;</FONT></TD>
<TD WIDTH=50% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Start Menu folder</FONT></TD>
</TR>

<TR><TD WIDTH=50% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>&lt;ProgramsFolder&gt;</FONT></TD>

<TD WIDTH=50% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Programs folder in the Start Menu folder</FONT>
</TD></TR>

<TR><TD WIDTH=50% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>&lt;StartupFolder&gt;</FONT></TD>
<TD WIDTH=50% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Startup folder in the Start Menu folder</FONT></TD>
</TR>

<TR><TD WIDTH=50% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>&lt;DesktopFolder&gt;</FONT></TD>
<TD WIDTH=50% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Desktop folder</FONT></TD>
</TR>
</TABLE>

<P>
You can also append a subfolder to a standard folder identifier in the <B>Folder</B>
box. For example, <B>&lt;ProgramsFolder&gt;\Microsoft Office</B> or <B>&lt;DesktopFolder&gt;\ValuPack</B>.
<P>
In the <B>Working directory</B> box, you can enter a full path or a special
folder identifier, like the ones used in the <B>Browse Folders</B> dialog
box of the <B>Components</B> panel. For a list of folder identifiers that you use to specify standard system folders,
see the table in "<A HREF="#CH006H209">Choose the Type of Installation</A>" earlier in this chapter.
<P>

<FONT SIZE=4><B><A NAME="CH006H2??">Choose Folder for Modified Setup Files</A></B></FONT>
<P>
In the <B>Choose Setup Files Subfolder</B> panel, specify the subfolder in which you want the Network Installation Wizard to create the customized LST, STF, and INF files. The subfolder name you specify is created in the folder in which the original STF folder resides.
<P>

<IMG SRC="00625.gif">
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>The folder name you enter in the <B>Subfolder</B> box must conform to the standard MS&#173;DOS eight&#173;character filename format.
<P>
<FONT SIZE=4><B><A NAME="CH006H213">Add Additional Files to the Office
Installation</A></B></FONT>

<P>
<a name="dex28"></a>
<P>
The Network Installation Wizard allows you to add files to the
Office installation process. These are additional files, provided
by you, that Setup installs along with the Office files. For example,
you could add a Word template file you have created for your workgroup
to use.
<P>
<A NAME="_Toc363801696"><IMG SRC="00614.gif"></A>
<P>
<B><FONT COLOR="#0000FF"><IMG SRC="Proced.gif" WIDTH=5 HEIGHT=10 BORDER=0 ALT="">&#09;To
add files to the installation process</FONT></B>
<P>
<OL>
<P>
<LI>In the <B>Add Files</B>
panel, click <B>Add</B>.
<P>
<LI>In the <B>Add</B> box,
select the file you want, and then click <B>Open</B>.
<P>
This can be any type of file located anywhere on the
network.
<P>
<LI>When the Network Installation Wizard
asks if you want to copy the selected file to the Custom folder,
click <B>Yes</B>.
<P>
In order for added files to be accessible during client
Setup, they must reside in the Custom folder. If you click No,
you must remember to copy the file to the Custom folder yourself.
<P>
<LI>In
the <B>Destination folder for selected file</B> box, enter a folder
name, or click <B>Browse</B> to find the folder.
<P>
Setup installs the file in this folder during client
Setup. You must specify a folder; entering a description in the
Description for selected file box is optional.
</OL>
<P>
<FONT SIZE=4><B><A NAME="CH006H214">Add Registry Entries</A></B></FONT>
<P>
<a name="dex29"></a>
<P>
The Network Installation Wizard allows you to add registry entries
to the user's Windows registry during the installation process.
This can be useful if, for example, you have written an application
that relies on the contents of a particular registry entry. You
can add the entry to Office Setup so that your application is
ready after the user installs Office.
<P>
<A NAME="_Toc363801698"><IMG SRC="00615.gif">
<BR>
</A>
<P>
<B><FONT COLOR="#0000FF"><IMG SRC="Proced.gif" WIDTH=5 HEIGHT=10 BORDER=0 ALT="">&#09;To
add a new registry entry</FONT></B>
<P>
<OL>
<P>
<LI>In the Add Registry Entries
panel, click Add.
<P>
The Add dialog box appears.
<P>
<LI>In the
<B>Root</B> box, enter the name of the top&#173;level key for
the new registry entry.
<P>
Top&#173;level keys include the following: HKEY_CLASSES_ROOT;
HKEY_CURRENT_USER; HKEY_LOCAL_MACHINE; and HKEY_USERS.
<P>
<LI>In
the <B>Data type</B> box, click the type of data stored in the
new entry&nbsp;&#151; either <B>DWORD</B> (double&#173;word
integer), or <B>SZ</B> (string).
<P>
<LI>In the <B>Key</B>
box, enter the name of the subkey in which the new entry is stored.
<P>
<LI>In
the <B>Value name</B> box, enter a name for the new registry entry.
<P>
<LI>In
the <B>Value data</B> box, enter the data to be stored in the
new entry.
<P>
The data must match the data type already specified.
<P>
<LI>In
the <B>Description</B> box, type a description of the new registry
entry.
<P>
This description is stored with the key in the registry
and is optional.
<P>
<IMG SRC="00618.gif">
<BR>
<P>
</OL>
<P>
For example, you can enter the new registry key <B>HKEY_LOCAL_MACHINE\SOFTWARE\AcmeApps\ClipArt\Installed</B>
with a value of <B>Yes</B> using the following entries in the
<B>Add</B> dialog box.
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>In this box</FONT></B></TD>
<TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Select or type this text</FONT></B>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Root</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>HKEY_LOCAL_MACHINE</B></FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Data type</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>SZ</B></FONT></TD>
</TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Key</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>SOFTWARE\AcmeApps\ClipArt</B></FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Value name</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Installed</B></FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Value data</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Yes</B></FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Description</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Acme clip art is installed</B></FONT>
</TD></TR>

<P>
</TABLE>
<P>
<FONT SIZE=4><B><A NAME="CH006H215">Select Quiet Mode</A></B></FONT>
<P>
When you run client Setup to install Office on a client computer, you can
specify a command&#173;line option that runs Setup in batch mode, without
requiring input from the user during the installation. Setup can run in
several of these <I>quiet modes</I>; the one you choose determines whether Setup
displays anything to the user or runs completely silently.
<P>
The <B>Select Quiet Mode</B> panel allows you to choose how you want Setup to run.
When the Network Installation Wizard is finished, it displays a suggested Setup
command string that includes the appropriate command&#173;line option corresponding
to the quiet mode you select in this panel.
<P>
<IMG SRC="00626.gif">
<P>
For example, if you select <B>4: No Exit or Progress dialogs; force system restart if necessary</B>,
then the Network Installation Wizard suggests that you use the /<B>QT</B> Setup command&#173;line options. For a description of all Setup command&#173;line options, see Appendix&nbsp;B, "<A HREF="APPB.htm">Setup Command&#173;Line Options and File Formats</A>."
<P>
<FONT SIZE=4><B><A NAME="CH006H216">Save Changes</A></B></FONT>

<P>
<a name="dex31"></a>
<P>
To complete the customization process, the Network Installation
Wizard saves the modified LST, STF, and INF files. These files are created in the subfolder you specified in the <B>Choose Setup Files Subfolder</B> panel.
<P>
In the <B>Save Changes</B> panel, you can specify the names of the customized STF, INF, and LST files.
<P>
<IMG SRC="00616.gif">
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>The name of the INF file you specify here is stored in the STF file, and the name of the STF file is stored in the LST file. If you rename either the STF or INF file on the disk, Setup cannot find it during installation.
<P>
For more information about how to use the modified STF file with Setup,
see "<A HREF="#CH006H103">Running Client Setup
with the Modified STF File</A>" later in this chapter.
<P>
<FONT SIZE=4><B><A NAME="CH006H2??">Finish the Network Installation Wizard</A></B></FONT>
<P>
When the Network Installation Wizard finishes writing the new LST, STF, and INF files, it displays<BR>
 the <B>Done!</B> panel.
<P>
<IMG SRC="00627.gif">
<P>
Based on the name of the LST file you entered in the <B>Save Changes</B> panel and the installation type and quiet mode you selected, the Network Installation Wizard suggests a Setup command string to use when running Setup. The following command&#173;line options may be included in the string:
<P>
<UL TYPE="square">
<li>The /<B>L <I>file</I></B> command&#173;line option specifies the name of the customized LST file.
<P>
<li>The /<B>B<I>n</I></B> command&#173;line option specifies the installation type to use when running in batch mode.
<P>
<li>The /<B>Q<I>n</I></B> command&#173;line option specifies the quiet mode you selected, if any.
</ul>
<P>
For a description of all Setup command&#173;line options, see Appendix B, "<A HREF="APPB.htm">Setup Command&#173;Line Options and File Formats</A>."
<P>
</MENU></MENU></MENU>
<A NAME="ORK006C3"></A>
<!--ToTop_START-->
<TABLE width=98% cellpadding=0 cellspacing=0 border=0>
<TR><TD align=right><TABLE cellpadding=0 cellspacing=0 border=0><TR><TD><A href="#top"><FONT SIZE=1 FACE="VERDANA,ARIAL,HELVETICA">Top</FONT></A></TD><TD><A href="#top"><IMG SRC="ar_up.gif" WIDTH=11 HEIGHT=7 BORDER=0 ALIGN=MIDDLE></A></TD></TR></TABLE>
</TD></TR>

</TABLE>
<HR>
<!--ToTop_END-->
<MENU>


<FONT SIZE=5><B><A NAME="CH006H103">Running Client Setup with the Modified STF File</A></B></FONT>
<MENU><MENU>

<a name="dex32"></a><P>
When you have successfully modified the LST, STF, and INF files with the Network Installation Wizard, you need to make them available so that users running client Setup use your modified files and not the original ones.
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>Because the LST, STF, and INF files are interrelated, you cannot rename them directly on disk after you have created them with the Network Installation Wizard. To change the name of any of these files, run the Network Installation Wizard again and specify a different name.
<P>
<FONT SIZE=4><B><A NAME="CH006H2??">Using the Modified STF File</A></B></FONT>
<P>
The Network Installation Wizard creates the modified LST, STF, and INF files in a subfolder of the folder containing the Office Setup program. To use the modified files, the user runs Setup from the Setup folder with the command string suggested by the Network Installation Wizard.
<P>
For example, suppose your administrative installation point is in folder MSOffice on the network
share \\Server1\Install. In the <B>Choose Setup Files Subfolder</B> panel of the Network Installation
Wizard, you enter <B>Custom</B> as the name of the subfolder that contains the modified Setup files
(for example, NewSetup.stf, NewSetup.inf, and NewSetup.lst). To install Office using your customized
Setup files, users connect to \\Server1\Install\MSOffice and run Setup with the following command string
(along with any other command&#173;line options you require):
<P>
<FONT SIZE=3 FACE="COURIER NEW,COURIER"><pre><code>setup /l Custom\NewSetup.lst</code></pre></font>
<P>
Setup opens your modified LST file in the Custom subfolder and installs Office using
the custom files you created with the Network Installation Wizard.
<P>
You can create more than one customized Office installation by running the Network
Installation Wizard for each variation. Save each set of modified LST, STF, and INF files
in a separate subfolder. Users specify the appropriate subfolder in the Setup
command string when they run Setup. 
<P>
For example, suppose you have three departments with unique installation requirements: Engineering, Accounting, and Services. You can run the Network Installation Wizard three times, creating a customized Office installation for each department, and save the custom files in separate subfolders: Engineer, Account, Services. Users from each department run Setup by connecting to the administrative installation point and using one of the following command strings:
<P>
<FONT SIZE=3 FACE="COURIER NEW,COURIER"><pre><code>setup /l Engineer\NewSetup.lst
setup /l Account\NewSetup.lst
setup /l Services\NewSetup.lst</code></pre></font>
<P>
For more information about command&#173;line options for Setup.exe, see Appendix&nbsp;B, "<A HREF="APPB.htm">Setup Command&#173;Line Options and File Formats</A>."
<P>
<FONT SIZE=4><B><A NAME="CH006H217">Installing Office over the Network</A>
</B></FONT>

<P>
Once you have modified the LST, STF, and INF files, there are three
ways to initiate a client installation of Office: interactive,
batch, and push.
<P>
<FONT SIZE=3><B><A NAME="_Toc363801703">Interactive Installation</A></B></FONT>

<P>
<a name="dex33"></a>
<P>
In an <I>interactive installation</I>, users connect
to the Office server and run Setup using the command&#173;line
options you have chosen. Setup prompts the user for installation
information. Modifications you have made to the STF file are displayed
as default responses to user prompts.
<P>
<FONT SIZE=3><B><A NAME="_Toc363801704">Batch Installation</A></B></FONT>

<P>
<a name="dex34"></a>
<P>
In a <I>batch installation</I>, you create a batch
file which runs Setup using your customized STF file with the
appropriate command&#173;line options. The user runs the batch
file, which in turn installs Office with no additional user interaction.
Setup does not prompt the user for information, but uses the responses
from the customized STF file instead.
<P>
For example, a command line for Setup might be
<P>
<FONT SIZE=3 FACE="COURIER NEW,COURIER"><pre><code>setup.exe /l Custom\NewSetup.lst /q1</code></pre></font>
<P>
The /<B>l</B> option directs Setup to use your custom LST, STF, and INF files in the Custom subfolder. The <B>/q1</B> option directs Setup to run without further user intervention, displaying only progress indicators to the user.
For a description of all the available Setup command&#173;line
options, see Appendix&nbsp;B, "<A HREF="AppB.htm">Setup
Command-Line Options and File Formats</A>."
<P>
By placing this command line in a batch file that the user can
run, you can create a simple mechanism for users to launch a customized
version of Office client Setup.
<P>
<FONT SIZE=3><B><A NAME="_Toc363801705">Push Installation</A></B></FONT>

<P>
<a name="dex35"></a>
<P>
In a <I>push installation</I>, you initiate client
Setup automatically with no user intervention. This can be done
by putting the customized Setup command line in the user's system
logon script, so Office installation is initiated the next time
the user logs on to the network.
<P>
You can also use a network administration tool, such as Microsoft
Systems Management Server, to initiate a push installation. For
more information, see the following section, "<A HREF="#CH006H218">Using Microsoft Systems Management Server to Install Office</A>."
<P>
<FONT SIZE=4><B><A NAME="CH006H218">Using Microsoft Systems Management
Server to Install Office</A></B></FONT>

<P>
<a name="dex36"></a>
<P>
You can use a network administration tool, such as Microsoft Systems
Management Server, to distribute a customized version of Office
client Setup to your users.
<P>
Microsoft Systems Management Server version&nbsp;1.2 helps you
automate large&#173;scale deployment of Office by performing an
automatic installation that requires no intervention from you
or the user.
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Important&nbsp;&nbsp;&nbsp;</B></FONT>This
section supplements the Microsoft Systems Management Server documentation;
it does not replace it. The procedures that follow provide additional
information for using Systems Management Server to install Office,
but they do not cover all Systems Management Server options and
features. For complete information, see the Microsoft Systems
Management Server Administrator's Guide.
<P>
<a name="dex37"></a>
<P>
To use Systems Management Server to distribute Office, perform
the following steps:
<P>
<OL>
<P>
<LI>Create a package for Office.
A <I>package</I> consists of a folder (the <I>package
source folder</I> that contains all the Office installation
files) and a package definition file (PDF). The PDF describes
the Setup commands that can be used to install Office on client
computers.
<P>
<LI>Create and run a job to distribute
the package. A <I>job</I> consists of a package and
a list of destination client computers. Systems Management Server
copies the package to distribution servers servicing the client
computers and executes the jobs on the client computers.
<P>
</OL>
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>Before
you use Systems Management Server to install Office, you must
create an administrative installation point on a server. Systems
Management Server uses the administrative installation point as
the package source folder. For more information, see "<a href="004.htm#CH004H206">Installing
Office from the Network</A>" in Chapter&nbsp;4, "Installing
Microsoft Office."
<P>
To install Office on your users' computers, you create a package
to run Setup using the standard Typical, Custom, or Run from Network
Server installation types, or using a Setup script you have customized.
Once the package is created, you create a Run On Workstation job
to execute Setup on the user computers that you designate.
<P>
<FONT SIZE=3><B>Creating a Package for Office</B></FONT>

<P>
<a name="dex38"></a>
<P>
You create a package for Office by using the Systems Management
Server Administrator program and importing the Office PDF. The
Office PDF is located in the main Office folder in the administrative
installation point and is named Off97std.pdf (Standard Edition)
or Off97pro.pdf (Professional Edition).
<P>
</MENU></MENU>
<P>
<TABLE WIDTH=93% CELLPADDING=0 CELLSPACING=0 BORDER=0>

<TR>

<TD WIDTH=80 ALIGN=RIGHT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><IMG SRC="CDO.GIF" WIDTH=27 HEIGHT=27 BORDER=0 ALT="">&nbsp;&nbsp;</FONT></TD><TD><B><FONT SIZE=2 COLOR="#0000FF" FACE="VERDANA,ARIAL,HELVETICA">Tools and Utilities&nbsp;&nbsp;&nbsp;</FONT></B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The
standard Office PDF described in this section supports only local
client installations and does not support Run from Network Server
installations or sharing Office components over the network. The
Office Resource Kit Tools and Utilities include additional PDF
files that support Run from Network Server installations. For
more information, see "<A HREF="appa.htm#CHappaH202">Package
Definition Files</A>" in Appendix&nbsp;A, "Microsoft
Office Resource Kit Tools and Utilities."</FONT>

</TD>

</TR>

</TABLE>
<MENU><MENU>
<P>The Office PDF file contains command definitions for the standard
installation types: Typical and Custom, as well as the complete
installation (a Custom installation with all the Office components
selected) and Uninstall options. Each of these command definitions
contains a Setup command line that directs Setup to run in batch
mode with the specific installation type (except for Custom, which
always runs interactively).
<P>
For example, the following command&#173;line installs a Typical installation using your customized Setup files:
<P>
<FONT SIZE=3 FACE="COURIER NEW,COURIER"><pre><code>CommandLine = setup.exe /l Custom\NewSetup.lst /q1 /b1</code></pre></FONT>
<P>
The <B>/l</B> command&#173;line option in this example directs Setup to use your custom LST file in the Custom subfolder. The <B>/q1</B> command&#173;line option directs Setup to run with no user interaction, and the <B>/b1</B> option
directs Setup to use the Typical installation type. When this
command is run from the Systems Management Server package, Setup
automatically installs Office using the options you defined for
the Typical installation type in your custom STF file. For a description of all the available
Setup command&#173;line options, see Appendix&nbsp;B, "<A HREF="AppB.htm">Setup
Command&#173;Line Options and File Formats</A>."
<P>
To use one of the standard Office installation types for installing
Office on your client computers, create a package using the unmodified
Office PDF.
<P>
<B><FONT COLOR="#0000FF"><IMG SRC="Proced.gif" WIDTH=5 HEIGHT=10 BORDER=0 ALT="">&#09;To
create an Office Setup package</FONT></B>
<P>
<OL>
<P>
<LI>Start the Systems Management
Server Administrator program and switch to the Packages window.
<P>
<LI>On
the <B>File</B> menu, click <B>New</B>.
<P>
<LI>In the
<B>Package Properties</B> dialog box, click <B>Import</B>.
<P>
<LI>In
the <B>File Browser</B> dialog box, select the appropriate PDF
file (Off97std.pdf or Off97pro.pdf) and then click <B>OK</B>.
<P>
The PDF file is located in the administrative installation
point in the folder containing the main Office application files.
<P>
<LI>In
the Package Properties dialog box, click Workstations.
<P>
<LI>In
the <B>Source Directory</B> box, enter the location of the administrative
installation point for Office.
<P>
<LI>In the <B>Workstation
Command Lines</B> box, click the Office installation type you
want, and then click <B>Close</B>.
<P>
<IMG SRC="00620.gif">
<BR>
<P>
</OL>
<P>
To create a Setup command that differs from those available in
the Office PDF, you add a new command to the Office PDF. For example,
if you want Setup to run with your custom Setup files and to generate a
log file, then you can add a new command in the PDF that runs Setup using
the command&#173;line options <B>/l</B> and <B>/g</B>. You do this with
the Systems Management Server Administrator program.
<P>
<a name="dex39"></a>
<P>
<B><FONT COLOR="#0000FF"><IMG SRC="Proced.gif" WIDTH=5 HEIGHT=10 BORDER=0 ALT="">&#09;To
add a new command to the Office package</FONT></B>
<P>
<OL>
<P>
<LI>Start the Systems Management
Server Administrator program, switch to the Packages window, and
select the package you created for Office.
<P>
<LI>On
the <B>File</B> menu, click <B>Properties</B>.
<P>
<LI>In
the Package Properties dialog box, click <B>Workstations</B>.
<P>
<LI>In
the <B>Source Directory</B> box, enter the location of the administrative
installation point for Office, and then click <B>New</B>.
<P>
<LI>In
the <B>Command Name</B> box, type a name for the new command.
<P>
For example, type <B>Install Office</B>
<P>
<LI>In
the <B>Command Line</B> box, type the command to run your custom
Setup.
<P>
For example, to run a Typical installation of Setup
with your custom Setup files in full quiet mode, and generating a log file,
type the following string:
<P>
<FONT SIZE=3 FACE="COURIER NEW,COURIER"><pre><code>setup.exe /l Custom\NewSetup.lst /b1 /qt /g "setup.log"</code></pre></font>
<P>
<LI>To indicate that
no user input is required to run the package, select the <B>Automated
Command<BR>
 Line</B> check box.
<P>
If you are installing on Windows&nbsp;NT Workstation,
you can also select the System (Background) Task check box to
indicate that you want the package to run in the background.
<P>
<LI>In
the <B>Supported Platforms</B> box, select the appropriate operating
systems: Windows&nbsp;95, Windows&nbsp;NT, or both; and then click
<B>OK</B>.
<P>
<LI>In the <B>Workstation Command Lines</B>
box, select the command you created, and then click <B>Close</B>.
<P>
</OL>
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>For
more information about creating, modifying, or distributing packages,
or for information about other package options available in Systems
Management Server, see the Microsoft Systems Management Server
Administrator's Guide.
<P>
<FONT SIZE=3><B>Creating a Job for the Office Package</B></FONT>

<P>
<a name="dex40"></a>
<P>
Once you have created the Systems Management Server package for
Office, you create a Run On Workstation job to distribute the
package.
<P>
<a name="dex41"></a>
<P>
<B><FONT COLOR="#0000FF"><IMG SRC="Proced.gif" WIDTH=5 HEIGHT=10 BORDER=0 ALT="">&#09;To
create a Run On Workstation job</FONT></B>
<P>
<OL>
<P>
<LI>Start the Systems Management
Server Administrator program, and switch to the Jobs window.
<P>
<LI>On
the <B>File</B> menu, click <B>New</B>.
<P>
<LI>In the
<B>Job Properties</B> dialog box, click <B>Details</B>.
<P>
<LI>In
the <B>Package</B> box, click the Office package you created.
<P>
<LI>Under
<B>Run Phase</B>, select the <B>Run Workstation Command</B> check
box, select one of the Setup commands in the package, and then
click <B>OK</B>.
<P>
<a name="dex42"></a>
<P>
<IMG SRC="00621.gif">
<BR>
<P>
</OL>
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Important&nbsp;&nbsp;&nbsp;</B></FONT>The
previous procedure describes how to create a simple job for the
Office package and how to select the appropriate Office Setup
command line. To finish creating the job, you must define job
targets (user computers) on which to install Office, and you must
set the job schedule. For more information about creating and
scheduling the job, see the Microsoft Systems Management Server
Administrator's Guide.
<P>
When the job is executed, Systems Management Server copies all
the files from the main Office folder on the administrative installation
point to a folder on one or more Systems Management Server distribution
servers that service the users on your network. When a user runs
the package, Setup is run from within this copy of the administrative
installation point.
<BR>
</MENU></MENU></MENU>
<HR>
<!--ToTop_START-->
<TABLE width=98% cellpadding=0 cellspacing=0 border=0>
<TR><TD align=right><TABLE cellpadding=0 cellspacing=0 border=0><TR><TD><A href="#top"><FONT SIZE=1 FACE="VERDANA,ARIAL,HELVETICA">Top</FONT></A></TD><TD><A href="#top"><IMG SRC="ar_up.gif" WIDTH=11 HEIGHT=7 BORDER=0 ALIGN=MIDDLE></A></TD></TR></TABLE>
</TD></TR>

</TABLE>


<!--ToTop_END-->

<!--EndNav_Start--><CENTER>
<A HREF="FULLTOC.htm">Contents</A>
| <a href="005.htm">&lt;&lt; Previous</A>
| <a href="007.htm">Next &gt;&gt;</A>
| <A HREF="A.HTM">Index</A>
</CENTER>
<P><FONT SIZE=3 FACE="COURIER NEW,COURIER"></FONT>
</FONT>
</BODY>
</HTML>
