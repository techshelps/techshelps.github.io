<HTML>

<Head>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Setup Command&#173;Line Options and File Formats</TITLE>

<META NAME="GENERATOR" CONTENT="Internet Assistant For Microsoft Word&nbsp;2.0z Beta">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#ffffff" TOPMARGIN=0 LEFTMARGIN=0>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>


<!--TOPBAR_START-->

<TABLE WIDTH=100% CELLPADDING=0 CELLSPACING=0 BORDER=0 BGCOLOR="#000000">
<TR>
<TD WIDTH=100% HEIGHT=20 VALIGN=TOP>&nbsp;</TD>
</TR>
</TABLE>

<!--TOPBAR_END-->

<!--Header/Footer Info_START-->
<TABLE WIDTH=98% BORDER=0 CELLPADDING=0>
<TR>
<TD WIDTH=20% ALIGN=LEFT><FONT COLOR="#000000" FACE="VERDANA,ARIAL,HELVETICA" Size=1>
<B>A P P E N D I X &nbsp;&nbsp; B</B></FONT></TD>
<TD WIDTH=50% ALIGN=CENTER><FONT COLOR="#000000" FACE="VERDANA,ARIAL,HELVETICA" Size=1>
<B>Appendixes</B></FONT></TD>
<TD WIDTH=30% ALIGN=RIGHT><FONT COLOR="#000000" FACE="VERDANA,ARIAL,HELVETICA" SIZE=1>
<B>Microsoft Office Resource Kit</B></FONT></TD></TR>
</TABLE>
<P>
<!--Header/Footer Info_END-->

<P><!--NAV_START-->
<TABLE WIDTH="98%" BGCOLOR="#ffffff" BORDER=0 CELLSPACING=0 CELLPADDING=3>
<TR><TD VALIGN="TOP" WIDTH=68%><FONT SIZE=5><B>Setup Command&#173;Line Options and File&nbsp;Formats</B></FONT></TD>
<TD WIDTH=30% VALIGN=TOP ALIGN=RIGHT>
<A HREF="AppA.htm"><IMG SRC="prevpage.gif" ALT="Previous" BORDER="0" ALIGN="RIGHT"></A>
<BR>
<BR>
<A HREF="fulltoc.htm"><IMG SRC="CNTBUTT.gif" ALT="Contents" BORDER="0" ALIGN="RIGHT"></A>
</TD>
<TD WIDTH=10% VALIGN=TOP ALIGN=RIGHT>
<A HREF="AppC.htm"><IMG SRC="nextpage.gif" ALT="Next" BORDER="0" ALIGN=RIGHT></A>
<BR>
<BR>
<A HREF="a.htm"><IMG SRC="indxbutt.gif" ALT="Index" BORDER="0" ALIGN=RIGHT></A>

</TD>
</TR>
</TABLE><HR>
<!--NAV_END-->
<MENU><MENU><MENU>




<P>
<FONT SIZE=3><B>In This Appendix</B></FONT>

<BR>
<A HREF="#ORKappbC1">Setup File Formats</A>
<BR>
<A HREF="#ORKappbC2">Setup Command&#173;Line
Options</A>
<BR>
<A HREF="#ORKappbC3">Setup Process</A>
<BR>

<P>
This appendix describes the technical details of the Setup program
for Microsoft Office&nbsp;97 for Windows, including the format of the Setup
files, command&#173;line options, and general sequence of the
Setup process.
<P>
</MENU></MENU>
<P>
<TABLE WIDTH=93% CELLPADDING=0 CELLSPACING=0 BORDER=0>
<TR>
<TD WIDTH=80 ALIGN=RIGHT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><IMG SRC="WINDOWSO.GIF" WIDTH=27 HEIGHT=27 BORDER=0 ALT="">&nbsp;&nbsp;</font></TD>
<TD><FONT COLOR="#0000FF" FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The
majority of this appendix assumes that you are running the Windows&nbsp;95
or Windows&nbsp;NT version 4.0 operating system.
</FONT></TD>

</TR>

</TABLE>
<MENU><MENU>
<P><A NAME="ORKappbC1"></A>
</MENU></MENU></MENU>

<MENU>
<FONT SIZE=5><B><A NAME="CHappbH101">Setup File Formats</A></B></FONT>
<MENU><MENU>

<P>
<a name="dex1"></a>
<P>
Setup files that contain application&#173;specific information
control the way Setup installs Office. This section describes
the general format of two types of Setup files: the information
file (INF) and the Setup table file (STF). These are the files
that the Network Installation Wizard modifies. This information
is provided to help you understand how Setup works and how you
can use the Network Installation Wizard to modify the behavior
of Setup.
<P>
<IMG SRC="Caution.gif" WIDTH=366 HEIGHT=11 BORDER=0 ALT="">
<BR>
<P>
<UL TYPE="square"><B><FONT COLOR="#FFCC33">Caution&nbsp;&nbsp;&nbsp;</FONT></B>The
behavior of Setup and the successful installation of Office depend
on the internal integrity of the Setup files. These files are
tab&#173;delimited and rely on positional parameters. Do not modify
them directly; instead, use the Network Installation Wizard to
customize the Setup process. For more information about using
the Network Installation Wizard, see Chapter&nbsp;6, "<a href="006.htm">Customizing
Client Installations</A>."
</UL>
<P>
<IMG SRC="Caution.gif" WIDTH=366 HEIGHT=11 BORDER=0 ALT="">
<BR>

<P>
Setup relies on a set of files that work together to control the
installation process for Office. The following table identifies
the primary Setup files.
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>File name</FONT></B></TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Description</FONT></B>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Setup.exe</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Primary executable file for Setup</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Off97Std.inf (Standard Edition)<BR>
Off97Pro.inf (Professional Edition)</FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Disk INF file; provides detailed information about the files to be installed</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Off97Std.stf (Standard Edition)<BR>
Off97Pro.stf (Professional Edition)</FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>STF file; specifies the logic of the installation process</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>*.dll</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Dynamic-link library (DLL) files containing custom procedures</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Setup.lst, Setup.ini</FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Additional information files for Setup</FONT>
</TD></TR>

<P>
</TABLE>
<P>
<FONT SIZE=4><B><A NAME="CHappbH201">The INF File</A></B></FONT>

<P>
<a name="dex2"></a>
<P>
The disk INF file, Off97Std.inf (Standard Edition) or Off97Pro.inf (Professional Edition), is a text file that contains information about all
the Setup files involved in an Office installation. This information
includes the following:
<P>
<UL TYPE="square">
<P>
<LI>Where a file is located
and its default attributes
<P>
<LI>Whether a file is
to be appended to an existing copy
<P>
<LI>Whether a
file is to be backed up, renamed, or copied
<P>
<LI>Whether
a file supports English or another language
<P>
</UL>

<A NAME="CHappbH202"></A>
<P>
<FONT SIZE=4><B>The STF File</B></FONT>

<P>
<a name="dex3"></a>
<P>
The STF file is the primary tool for configuring Setup to install
Office. It specifies the installation process for each installation
mode, and determines the nature, sequence, and extent of user
input. It determines which options to install, where to install
them, and how to respond to current configurations and user input.
<P>
The STF file consists of data in a tree&#173;structured table.
Setup takes different paths through the tree based on options
that the user selects or based on the environment in which Setup
is run. For example, Setup takes one path through the tree if
it finds a previous version of Office installed, and a different
path if it does not.
<P>
To eliminate duplicating portions of the table throughout the
STF file, a portion of the table may be referenced by multiple
paths in the tree. Because Setup carries out each line of the
STF file only once no matter how many paths reference it, multiple
references to a single line allow Setup to process the STF file
more quickly.
<P>
The tree structure of the STF file affects the installation process.
In particular, there are two effects to be aware of:
<P>
<UL TYPE="square">
<P>
<LI>First, because Setup does
not know which path it will take through the STF file until the
installation begins, Setup cannot precisely predict the amount
of disk space required. Setup may display disk space requirements
that are slightly higher than the actual space needed.
<P>
<LI>Second,
if you use the Network Installation Wizard to modify entries in
the STF file, you may see duplicate Yes/No questions or <B>Start</B>
menu items. This is because the Network Installation Wizard displays
all the items in the tree even though some items may never be
carried out by Setup during installation. For more information
about the Network Installation Wizard, see Chapter&nbsp;6, "<a href="006.htm">Customizing
Client Installations</A>."
<P>
</UL>
<P>
You can use the <B>/g</B> command&#173;line option to generate
a log file that keeps track of everything Setup does: what files
it copies, where it copies them, what modifications it makes to
INI files or the Windows registry, and any errors it encounters.
For a description of this Setup command&#173;line option, see
"<A HREF="#ORKappbC2">Setup Command-Line Options</A>"
in the next section.
<P>
<A NAME="ORKappbC2"></A>
</MENU></MENU></MENU>
<!--ToTop_START-->
<TABLE width=98% cellpadding=0 cellspacing=0 border=0>
<TR><TD align=right><TABLE cellpadding=0 cellspacing=0 border=0><TR><TD><A href="#top"><FONT SIZE=1 FACE="VERDANA,ARIAL,HELVETICA">Top</FONT></A></TD><TD><A href="#top"><IMG SRC="ar_up.gif" WIDTH=11 HEIGHT=7 BORDER=0 ALIGN=MIDDLE></A></TD></TR></TABLE>
</TD></TR>

</TABLE>
<HR>
<!--ToTop_END-->
<MENU>
<FONT SIZE=5><B><A NAME="CHappbH102">Setup Command&#173;Line Options</A></B></FONT>
<MENU><MENU>

<P>
<a name="dex4"></a>
<P>
You can run the Office Setup program from a command line. If you
run Setup from a command line, you can add parameters to the command
that allow you to specify certain options, such as choosing a
Typical installation or creating a network installation log.
<P>
<B><FONT COLOR="#0000FF"><IMG SRC="Proced.gif" WIDTH=5 HEIGHT=10 BORDER=0 ALT="">&#09;To
run Setup from a command line</FONT></B>
<P>
<OL>
<P>
<LI>In Windows&nbsp;95 or Windows&nbsp;NT
Workstation&nbsp;4.0, click <B>Start</B>, and then click <B>Run</B>.
<P>
&#150;&nbsp;or&nbsp;&#150;
<P>
In Windows&nbsp;NT Workstation version&nbsp;3.51,
click <B>Run</B> on the Program Manager <B>File</B> menu.
<P>
<LI>Type
the location you are installing from followed by the word <B>setup</B>.
For example, <B>a:\setup</B> or <B>x:\msoffice\setup</B>
<P>
If you want to add a command&#173;line option, type
it after the command. For example, to run Setup in administrative
mode, type <B>a:\setup /a</B>
<P>
</OL>
<P>
Some command&#173;line options are stand&#173;alone parameters, while
others take an argument, such as a number or file name. Options
are not case&#173;sensitive; that is, they can be in uppercase
or lowercase. With a few exceptions, you can combine options in
the same command line. For example, to run Setup from drive A
so that it specifies the user name Laura Callahan, the organization
Island Trading, and the log file C:\Tmp\Offlog.txt, you would
type the following:
<P>
<FONT SIZE=3 FACE="COURIER NEW,COURIER"><pre><code>a:\setup /n "laura callahan" /o "island trading" /g "c:\tmp\offlog.txt"

</code></pre></FONT>
<P>
<FONT SIZE=4><B><A NAME="CHappbH203">Command&#173;Line Option Descriptions</A>
</B></FONT>

<P>
The following table shows the command&#173;line options recognized
by the Office Setup program.
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Command&#173;line option</FONT></B>
</TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Description</FONT></B></TD>
</TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/a</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Creates an administrative installation point. Valid only when running from CD or floppy disks.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/b </B><I>number</I></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Bypasses the <B>Microsoft Office&nbsp;97 Setup</B> dialog box by preselecting the type of installation:
<P> 
<UL TYPE="square"><B>1</B>&nbsp;&#150;&nbsp;Typical
<P>
<B>2</B>&nbsp;&#150;&nbsp;Custom
<P>
<B>3</B>&nbsp;&#150;&nbsp;Run from CD or Run from Network Server</UL></FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/c </B><B>"</B><I>number</I><B>"</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Bypasses the dialog box for entering and validating the 20&#173;character Product ID from the OEM Certificate of Authorization by entering the number you specify.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/f</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Specifies that all files be created with an 8&#173;character file name with a 3&#173;character extension, instead of with a long file name.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/g</B>{<B>+</B>} <B>"</B><I>file</I><B>"</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Generates a log file that records details of the Setup process. If <B>+</B> is specified, Setup appends new information to the log file instead of overwriting it.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/gc</B>{<B>+</B>} <B>"</B><I>file</I><B>"</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Does the same as <B>/g</B>, except all calls and returns from custom actions are also logged, which can make the log file very large.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/k </B><B>"</B><I>number</I><B>"</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Bypasses the dialog box for entering and validating the 11&#173;digit key from the CD sticker by entering the number you specify.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/l </B><B>"</B><I>file</I><B>"</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Overrides the default LST file (Setup.1st) with the specified file.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/l </B><B>"</B><I>file</I><B>"</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Overrides the default LST file (Setup.lst) with the specified file.</FONT>
</TD></TR>

<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/m </B><I>number</I></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Specifies the Microsoft License Pak (MLP) licensing information needed to activate the MLP for floppy disks. Setup does not install any software, but terminates immediately after setting the count at the number you specify.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/n </B><B>""</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Prompts for a user name to use if no default user name exists in the Windows registry.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/n </B><B>"</B><I>name</I><B>"</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Specifies the user name to use if no default user name exists in the Windows registry.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/o </B><B>""</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Prompts for an organization name to use if no default organization name exists in the Windows registry.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/o </B><B>"</B><I>organization</I><B>"</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Specifies the organization name to use if no default organization exists in the Windows registry.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/q</B>{<I>option</I>}</FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Specifies the level of user interaction for batch mode installation:
<P>
<UL TYPE="square"><B>0</B>&nbsp;&#150;&nbsp;Suppresses all dialog boxes except the final one. Using <B>0</B> is the same as using no argument.
<P>
<B>1</B>&nbsp;&#150;&nbsp;Suppresses all dialog boxes, including the final one.
<P>
<B>t</B>&nbsp;&#150;&nbsp;Suppresses all Setup user interface elements.</UL></FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/qn</B>{<I>option</I>}</FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Does the same as <B>/q</B>, except that the system is not rebooted and <B>0 </B>is not a valid value. To suppress all dialog boxes except the final one, use <B>/qn </B>with no argument.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/r</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Reinstalls an application. Use in maintenance mode only.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/s </B><B>"</B><I>folder</I><B>"</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Overrides the default source (the folder containing Setup.exe or the source specified in the maintenance mode STF file) with the specified folder.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/u</B>{<B>a</B>}</FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Removes Office. If <B>a </B>is specified, shared components are removed without prompting the user; otherwise the user is prompted before removing shared components. Use in maintenance mode only.</FONT>
</TD></TR>

<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/x </B><B>"</B><I>file</I><B>"</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Creates a network installation log file for tracking the number of installations made from an administrative installation point. This overrides the value, if any, specified in the STF file.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/y</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Proceeds normally, including setting registry entries, but does not copy any files to the user's disk. Use this option to restore registry values or to track down processing problems.</FONT>
</TD></TR>

<P>
</TABLE>
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>If
you enter any invalid parameter, Setup displays a partial list
of valid command&#173;line options.
<P>
Following are special considerations when combining options on
the same command line:
<P>
<UL TYPE="square">
<P>
<LI>The <B>/a</B> and <B>/q</B>
options are mutually exclusive; using both results in a usage
error message.
<P>
<LI>The <B>/n</B> option is ignored
if <B>/a</B> is used.
<P>
<LI>The <B>/u</B> and <B>/r</B>
options are mutually exclusive; using both results in a usage
error message.
<P>
<LI>The prompt elicited by the <B>/u</B>
option is suppressed if <B>/q</B> is used, and the shared components
are not removed.
<P>
</UL>
<A NAME="CHappbH204"></A>
<P>
<FONT SIZE=4><B>ERRORLEVEL Values</B></FONT>

<P>
<a name="dex5"></a>
<P>
Under Windows&nbsp;95, Setup returns one of the following values
as the MS&#173;DOS <B>ERRORLEVEL</B> value used to control batch
file processing.
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>This ERRORLEVEL value</FONT></B>
</TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Indicates this condition</FONT></B>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>0</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Success</FONT></TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>1</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>User quit</FONT></TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>2</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Parsing Command Line error</FONT></TD>
</TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>3</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Default user or organization name error</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>4</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>External error</FONT></TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>5</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Internal error</FONT></TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>6</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Out of memory</FONT></TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>7</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Partly installed</FONT></TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>8</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Restart failed</FONT></TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>9</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Failed to run Acmesetup.exe</FONT>
</TD></TR>

<P>
</TABLE>
<P>
<A NAME="ORKappbC3"></A>
</MENU></MENU></MENU>
<!--ToTop_START-->
<TABLE width=98% cellpadding=0 cellspacing=0 border=0>
<TR><TD align=right><TABLE cellpadding=0 cellspacing=0 border=0><TR><TD><A href="#top"><FONT SIZE=1 FACE="VERDANA,ARIAL,HELVETICA">Top</FONT></A></TD><TD><A href="#top"><IMG SRC="ar_up.gif" WIDTH=11 HEIGHT=7 BORDER=0 ALIGN=MIDDLE></A></TD></TR></TABLE>
</TD></TR>

</TABLE>
<HR>
<!--ToTop_END-->
<MENU>
<FONT SIZE=5><B><A NAME="CHappbH103">Setup Process</A></B></FONT>
<MENU><MENU>

<P>
<a name="dex6"></a>
<P>
This section describes the process that Setup follows during an
installation. Setup performs the following steps in a client installation:
<P>
<OL>
<P>
<LI>Determine whether this is a new or a maintenance mode installation.
<P>
For information about how Setup determines this, see
"<A HREF="#CHappbH205">Determining Maintenance
Mode Installation</A>" later in this appendix.
<P>
<LI>If Setup is running from Disk 1 of a floppy disk set, search from
drive Z to drive A, and create the Mssetup temporary folder on
the first hard disk that has sufficient disk space. If no hard
disk is found, create the Mssetup folder in the user's Windows
folder.
<P>
If Setup is running from a CD, a hard disk, or a network
server, it does not create a temporary folder.
<P>
<LI>Check the STF file for syntax errors.
<P>
If the STF file has been modified, syntax errors may
have been introduced.
<P>
<LI>Check for active applications that are potentially disruptive.
<P>
The list of applications that Setup checks is in the
<B>Check Modules</B> item in the <B>Header</B> section of the STF file.
<P>
<LI>Run the STF file according to the branching logic defined in the file,
and then perform the following steps:
<UL TYPE="square">
<P>
<LI>Check for duplicate versions of the application being installed.
<P>
<LI>Prompt the user for input regarding corrections and custom configurations.
<P>
<LI>Determine whether there is adequate space on the hard disk.
</UL>
<P>
<LI>Copy the files into the system&#173;specified and user&#173;specified folders according to the instructions in the STF and INF files.
<P>
The STF file determines which files or groups of files are copied and their destinations. The INF file specifies the characteristics of each file or group of files in the product, such as size and date. It also specifies instructions to be used when copying the files, such as whether to decompress the file or overwrite the destination file if it already exists.
<P>
<LI>Delete or replace existing files as indicated.
<P>
<LI>Make appropriate changes to the Windows registry and INI files.
<P>
<LI>Remove the Mssetup folder, if one was created.
<P>
</OL>
<A NAME="CHappbH205"></A>
<P>
<FONT SIZE=4><B>Determining Maintenance Mode Installation</B></FONT>

<P>
<a name="dex7"></a>
<P>
Setup determines whether an installation is in maintenance mode
by looking for an entry in the Windows registry to indicate that
Setup has been run before. The entry is under the following key:
<P>
<B>HKEY_LOCAL_MACHINE\Software\Microsoft\MS Setup (ACME)\Table
Files</B>
<P>
The <B>Name</B> value in the <B>Table Files</B> subkey is the
product name and version, and the <B>Data</B> value is the path
to the STF file. The following is an example of these value entries
for Office&nbsp;97.
<P>
<B>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MS Office&nbsp;97 Professional@v97.0.0.1114(1033)</B>
<BR>
<B>Data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"C:\Program Files\Microsoft  Office\Office\Setup\Off97Pro.STF"</B>
<P>
If the <B>Name</B> value matches the product name and version
of software Setup is attempting to install, Setup runs in maintenance
mode using the STF file identified in the <B>Data</B> value.
<P>
If the <B>Name</B> value does not match the product name and version
of software Setup is attempting to install, or if Setup cannot
find or open the STF file identified in the <B>Data</B> value,
Setup runs in install mode.
<BR>
</MENU></MENU></MENU>
<HR>
<!--ToTop_START-->
<TABLE width=98% cellpadding=0 cellspacing=0 border=0>
<TR><TD align=right><TABLE cellpadding=0 cellspacing=0 border=0><TR><TD><A href="#top"><FONT SIZE=1 FACE="VERDANA,ARIAL,HELVETICA">Top</FONT></A></TD><TD><A href="#top"><IMG SRC="ar_up.gif" WIDTH=11 HEIGHT=7 BORDER=0 ALIGN=MIDDLE></A></TD></TR></TABLE>
</TD></TR>

</TABLE>


<!--ToTop_END-->

<!--EndNav_Start--><CENTER>
<A HREF="FULLTOC.htm">Contents</A>
| <A HREF="AppA.htm">&lt;&lt; Previous</A>
| <A HREF="AppC.htm">Next &gt;&gt;</A>
| <A HREF="A.HTM">Index</A>
</CENTER>
<P><FONT SIZE=3 FACE="COURIER NEW,COURIER"></FONT>
</FONT>
</BODY>
</HTML>
