<HTML>

<Head>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Troubleshooting Installation</TITLE>

<META NAME="GENERATOR" CONTENT="Internet Assistant For Microsoft Word&nbsp;2.0z Beta">
<style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD>
<BODY BGCOLOR="#ffffff" TOPMARGIN=0 LEFTMARGIN=0>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>


<!--TOPBAR_START-->

<TABLE WIDTH=100% CELLPADDING=0 CELLSPACING=0 BORDER=0 BGCOLOR="#000000">
<TR>
<TD WIDTH=100% HEIGHT=20 VALIGN=TOP>&nbsp;</TD>
</TR>
</TABLE>

<!--TOPBAR_END-->

<!--Header/Footer Info_START-->
<TABLE WIDTH=98% BORDER=0 CELLPADDING=0>
<TR>
<TD WIDTH=20% ALIGN=LEFT><FONT COLOR="#000000" FACE="VERDANA,ARIAL,HELVETICA" Size=1>
<B>C H A P T E R &nbsp;&nbsp; 9</B></FONT></TD>
<TD WIDTH=50% ALIGN=CENTER><FONT COLOR="#000000" FACE="VERDANA,ARIAL,HELVETICA" Size=1>
<B>Part 2&nbsp;&nbsp;Deploying Microsoft Office</B></FONT></TD>
<TD WIDTH=30% ALIGN=RIGHT><FONT COLOR="#000000" FACE="VERDANA,ARIAL,HELVETICA" SIZE=1>
<B>Microsoft Office Resource Kit</B></FONT></TD></TR>
</TABLE>
<P>
<!--Header/Footer Info_END-->

<P><!--NAV_START-->
<TABLE WIDTH="98%" BGCOLOR="#ffffff" BORDER=0 CELLSPACING=0 CELLPADDING=3>
<TR><TD VALIGN="TOP" WIDTH=68%><FONT SIZE=5><B>Troubleshooting Installation</B></FONT></TD>
<TD WIDTH=30% VALIGN=TOP ALIGN=RIGHT>
<a href="008.htm"><IMG SRC="prevpage.gif" ALT="Previous" BORDER="0" ALIGN="RIGHT"></A>
<BR>
<BR>
<A HREF="fulltoc.htm"><IMG SRC="CNTBUTT.gif" ALT="Contents" BORDER="0" ALIGN="RIGHT"></A>
</TD>
<TD WIDTH=10% VALIGN=TOP ALIGN=RIGHT>
<a href="010.htm"><IMG SRC="nextpage.gif" ALT="Next" BORDER="0" ALIGN=RIGHT></A>
<BR>
<BR>
<A HREF="a.htm"><IMG SRC="indxbutt.gif" ALT="Index" BORDER="0" ALIGN=RIGHT></A>

</TD>
</TR>
</TABLE><HR>
<!--NAV_END-->
<MENU><MENU><MENU>

<P>
<FONT SIZE=3><B>In This Chapter</B></FONT>
<BR>
<A HREF="#ORK009C1">Removing Previous
Versions of Office</A>
<BR>
<A HREF="#ORK009C2">Solving Common Setup
Problems</A>
<BR>

<P>
<FONT SIZE=3><B>See Also</B></FONT>

<P>
<UL TYPE="square">
<P>
<LI>For information about installing
Office applications, see Chapter&nbsp;4, "<a href="004.htm">Installing
Microsoft Office</A>."
<P>
<LI>For information
about customizing the Office installation process, see Chapter&nbsp;6,
"<a href="006.htm">Customizing Client Installations</A>."
<P>
<LI>For information
about available support resources, see Appendix&nbsp;E, "<A HREF="AppE.htm">Other Support
Resources</A>."
<P>
</ul>
</MENU></MENU>
<TABLE WIDTH=93% CELLPADDING=0 CELLSPACING=0 BORDER=0>
<TR>
<TD WIDTH=80 ALIGN=RIGHT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><IMG SRC="WINDOWSO.GIF" WIDTH=27 HEIGHT=27 BORDER=0 ALT="">&nbsp;&nbsp;</font></TD>
<TD><FONT COLOR="#0000FF" FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The
information in this chapter applies to Office&nbsp;97 for Windows. For
information about troubleshooting Office for the Macintosh installation,
see "<a href="004.htm#CH004H105">Rolling Out Office&nbsp;98 for the Macintosh</A>" in Chapter&nbsp;4, "Installing
Microsoft Office."
</FONT></TD>

</TR>

</TABLE>
<MENU><MENU>
<P>
<A NAME="CH009H101"></A>

<P>
<a name="dex1"></a>
<P>
For administrators who want to completely remove previous versions
of Microsoft Office from the computers in their organization, this chapter
describes the Microsoft Office&nbsp;97 Upgrade Wizard. This chapter
also addresses some of the issues that you may encounter when
installing Office&nbsp;97, or that may arise after Office has
been installed.
<P>
<A NAME="ORK009C1"></A>
</MENU></MENU></MENU>
<!--ToTop_START-->
<TABLE width=98% cellpadding=0 cellspacing=0 border=0>
<TR><TD align=right><TABLE cellpadding=0 cellspacing=0 border=0><TR><TD><A href="#top"><FONT SIZE=1 FACE="VERDANA,ARIAL,HELVETICA">Top</FONT></A></TD><TD><A href="#top"><IMG SRC="ar_up.gif" WIDTH=11 HEIGHT=7 BORDER=0 ALIGN=MIDDLE></A></TD></TR></TABLE>
</TD></TR>

</TABLE>
<HR>
<!--ToTop_END-->
<MENU>
<FONT SIZE=5><B><A NAME="CH009H101">Removing Previous Versions of Office</A></B></FONT>
<MENU><MENU>

<P>
<a name="dex2"></a>
<P>
When you install Office&nbsp;97 for Windows, Setup allows you to remove files
from previous versions of Office or Office applications from your
hard disk. Because some shared files installed with previous versions
of Office might be used by other applications, however, Setup
may leave some files on your computer.
<P>
The Office&nbsp;97 Upgrade Wizard allows you to find and remove
all files left behind by previous installations of Office. This
section describes how to use the Upgrade Wizard and how you can
customize its operation.
<P>
</MENU></MENU>
<P>
<TABLE WIDTH=93% CELLPADDING=0 CELLSPACING=0 BORDER=0>

<TR>

<TD WIDTH=80 ALIGN=RIGHT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><IMG SRC="CDO.GIF" WIDTH=27 HEIGHT=27 BORDER=0 ALT="">&nbsp;&nbsp;</FONT></TD>
<TD><B><FONT SIZE=2 COLOR="#0000FF" FACE="VERDANA,ARIAL,HELVETICA">Tools and Utilities&nbsp;&nbsp;&nbsp;</FONT></B>
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The
Office Resource Kit Tools and Utilities include the Office&nbsp;97
Upgrade Wizard. For more information about how to install the
Upgrade Wizard, see "<A HREF="appa.htm#CHappaH201">Network
Installation Wizard version 2.1</A>" in Appendix&nbsp;A, "Microsoft
Office Resource Kit Tools and Utilities."</FONT>

</TD>

</TR>

</TABLE>
<MENU><MENU>
<P><P>
<FONT SIZE=4><B><A NAME="CH009H201">Using the Office&nbsp;97 Upgrade Wizard</A>
</B></FONT>

<a name="dex3"></a>
<P>
The Upgrade Wizard helps you find and remove old Office files,
registry entries, INI file entries, and<BR>
 <B>Start</B> menu items
or Program Manager items that you no longer need on your computer.
The Upgrade Wizard recognizes components of the following versions
of Office and Office&#173;related products:
<P>
<UL TYPE="square">
<P>
<LI>Microsoft Office, versions
4.<I>x</I> and&nbsp;95
<P>
<LI>Microsoft
Project, versions 4.0 and&nbsp;95
<P>
<LI>Microsoft
Publisher, versions 2.0, 3.0, and 4.0
<P>
<LI>Microsoft
Team Manager 97
<P>
</UL>
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>The
Office&nbsp;97 Upgrade Wizard runs on Windows&nbsp;95 and the
Windows&nbsp;NT operating system only.
<P>
<FONT SIZE=3><B>Start the Upgrade Wizard</B></FONT>

<P>
<a name="dex4"></a>
<P>
To start the Upgrade Wizard, double&#173;click Offcln97.exe. The
Upgrade Wizard displays a <B>Welcome</B> panel.
<P>
<IMG SRC="00901.gif">
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>No
files are removed by the Upgrade Wizard until you click Finish
in the last panel. Until that time, you can click Exit to quit
without removing any files, or you can click Back to change the
option or files you have selected.
<P>
<FONT SIZE=3><B>Select the Type of Cleanup</B></FONT>

<P>
<a name="dex5"></a>
<P>
After the initial <B>Welcome</B> panel, the Upgrade Wizard presents
you with three options, so you can control the degree to which
the wizard cleans up your system.
<P>
<a name="dex6"></a>
<P>
<IMG SRC="00902.gif">
<P>
These options are:
<P>
<UL TYPE="square">
<P>
<LI><B>Remove only the files that I absolutely do not need</B>
<P>
The Upgrade Wizard runs in safe mode and looks only
for Office files that are not being used by any other application.
This typically includes files belonging to versions of Office
that are no longer installed on the computer. The Upgrade Wizard
does not remove files belonging to currently installed products
or files shared among various applications, such as the spelling
checker or clip art files.
<P>
When you select this option, the Upgrade Wizard displays
the list of files that will be removed and allows you to select
files you want to keep.
<P>
<LI><B>Let me decide which Microsoft Office applications will be removed</B>
<P>
The Upgrade Wizard runs in safe mode, but first it
displays a list of the Office and Office&#173;related applications
currently installed on the computer. When you select one or more
of these applications, the Upgrade Wizard adds the files from
those applications to its list of files to remove, and also allows
you to select files you want to keep.
<P>
<LI><B>Completely remove all of my old Office applications</B>
<P>
The Upgrade Wizard runs in aggressive mode and looks
for files belonging to all previous Office and Office&#173;related
applications, as well as all shared files on your computer. In
aggressive mode, the Upgrade Wizard performs the most thorough
cleaning of your computer. When you select this option, the Upgrade
Wizard displays the list of files that will be removed (typically
a long list) and allows you to select files you want to keep.
<P>
</UL>
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>If
Office&nbsp;97 is installed on your computer and you select the
Completely remove all of my old Office applications option, the
Upgrade Wizard displays a warning that Office&nbsp;97 files may
be removed. If you continue, you must reinstall Office&nbsp;97
after the wizard finishes to restore any shared files needed by
Office&nbsp;97.
<P>
<FONT SIZE=3><B>Select Applications to Remove</B></FONT>

<P>
<a name="dex7"></a>
<P>
If you select the option <B>Let me decide which Microsoft Office
applications will be removed</B>, the Upgrade Wizard displays
a panel with a list of the applications it finds in the <B>Applications
to keep</B> box. To move an application from this box to the <B>Applications
to remove</B> box, select the application and then click the appropriate
move button. All applications you move to the <B>Applications
to remove</B> box are removed by the Upgrade Wizard.
<P>
<IMG SRC="00903.gif">
<P>
<a name="dex8"></a>
<P>
Two special entries in the list of applications are <B>Files in
Temporary Folder</B> and <B>Files in Recycle Bin</B>. If you move
<B>Files in Temporary Folder</B> to the <B>Applications to remove</B>
box, then the Upgrade Wizard deletes all files found in the following
folders.
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Temporary folder</FONT></B>
</TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Description</FONT></B></TD>
</TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Windows\Temp or Windows\Tmp</FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The Windows temporary folder.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>%TEMP% or %TMP%</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The folder identified by the MS&#173;DOS environment variable <B>%</B><B>TEMP</B><B>%</B> or <B>%</B><B>TMP</B><B>%</B>.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>drive</I>:\Temp or <I>drive</I>:\Tmp</FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The MS&#173;DOS temporary folder; <I>drive</I> refers to a hard disk (the Upgrade Wizard looks at every hard disk on the computer).</FONT>
</TD></TR>

<P>
</TABLE>
<P>
If you move <B>Files in Recycle Bin</B> to the <B>Applications
to remove</B> box, then the Upgrade Wizard deletes all files currently
in the Recycle Bin.
<P>
<FONT SIZE=3><B>Select Files to Keep</B></FONT>

<P>
<a name="dex9"></a>
<P>
In the next step, the Upgrade Wizard searches the computer for
files belonging to the Office and Office&#173;related applications
you selected in the previous panels and then displays a list of
the files it finds in the <B>Files to remove</B> box. All files
in this list are removed by the Upgrade Wizard. When you select
a file in the <B>Files to remove</B> box, a description of the
file is displayed below the box, including which applications
use the file. To keep a file, select it and then click the appropriate
move button to move it to the <BR>
<B>Files to keep</B> box.
<P>
<IMG SRC="00904.gif">
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>Another
way to review this list of files is to save the list to a text
file by clicking the Save As button, or to print the list by clicking
the Print button.
<P>
<FONT SIZE=3><B>Start File Removal</B></FONT>

<P>
<a name="dex10"></a>
<P>
In the final panel of the Upgrade Wizard, click <B>Finish</B>
to remove the selected files from your computer. To return to
a previous panel to change options or selected files, click <B>Back</B>.
Click <B>Exit</B> to quit the Upgrade Wizard before any files
are removed.
<P>
<IMG SRC="Caution.gif" WIDTH=366 HEIGHT=11 BORDER=0 ALT="">
<BR>
<P>
<UL TYPE="square">
<B><FONT COLOR="#FFCC33">Caution&nbsp;&nbsp;&nbsp;</FONT></B>After
you click <B>Finish</B>, you cannot stop the Upgrade Wizard as
it removes files. Files are removed permanently, and they cannot
be retrieved without reinstalling the original applications.
</UL>
<P>
<IMG SRC="Caution.gif" WIDTH=366 HEIGHT=11 BORDER=0 ALT="">
<BR>

<P>
<IMG SRC="00905.gif">
<P>
<FONT SIZE=4><B><A NAME="CH009H202">Running the Clean&#173;up Process</A></B></FONT>

<P>
<a name="dex11"></a>
<P>
The Upgrade Wizard uses a text file (OPC) to identify all files,
registry entries, INI entries, or <B>Start</B> menu or Program
Manager items that were installed or modified by previous versions
of Office and Office&#173;related products. The OPC file also
contains rules that describe what files or entries to clean up,
where they are located, and under what conditions the Upgrade
Wizard can delete them. Files that are associated with a single
Office application are marked so that they can be deleted in safe
mode. Files that are shared by multiple Office applications, or
that might be used by other applications, are marked so that they
can be deleted only in aggressive mode. The default OPC included
in the Office Resource Kit is named Offcln97.opc.
<P>
The Upgrade Wizard searches the computer to determine what Office
applications have been installed. If you selected <B>Remove only
the files that I absolutely do not need</B>, then the Upgrade
Wizard looks for files belonging to an Office application that
is no longer installed on the computer, and it flags only those
files for deletion. These are files that may have been left behind
due to an incomplete uninstall of the<BR>
 Office application.
<P>
In addition, the Upgrade Wizard looks for files belonging to shared
components that remain on the system even though a newer version
of these components has been installed. For example, if the computer
contains files from both Microsoft Graph version&nbsp;4.0 and
Microsoft Graph&nbsp;95, the Upgrade Wizard flags the
Graph&nbsp;4.0 files for deletion because their functionality
is replaced by Graph&nbsp;95. However, if the computer
has only Graph&nbsp;4.0 files, they are not flagged
for deletion.
<P>
If you selected <B>Let me decide which Microsoft Office applications
will be removed</B>, the Upgrade Wizard also gives you the choice
of marking for deletion any previous Office applications currently
installed on the computer. The Upgrade Wizard does not delete
any files that remove functionality from other Office applications.
For example, if you select to remove Microsoft Word&nbsp;95 but not
Microsoft Excel&nbsp;95, then the Upgrade Wizard will not remove
any shared files used by Excel&nbsp;95.
<P>
If you selected <B>Completely remove all of my old Office applications</B>,
the Upgrade Wizard looks for all files associated with previous
versions of Office applications and marks them for deletion. If
you have already installed Office&nbsp;97, you must reinstall
it because there are some files installed by Office&nbsp;97 that
were also installed in previous versions of Office&nbsp;&#151;
the Upgrade Wizard removes all these files. To reinstall Office&nbsp;97,
rerun Setup and click <B>Reinstall</B>.
<P>
<FONT SIZE=4><B><A NAME="CH009H203">Customizing the Office&nbsp;97 Upgrade
Wizard</A></B></FONT>

<P>
<a name="dex12"></a>
<P>
By specifying command&#173;line options for the Upgrade Wizard,
or by creating a copy of the OPC file with a few modifications,
you can customize the Upgrade Wizard to perform the operations
you need for your users' computers. For example, you can create
a batch file that runs the Upgrade Wizard in quiet mode, removing
all files from previous versions of Office and emptying the user's
temporary folders and Recycle Bin. (For more information, see
"<A HREF="#CustEx">Customization Example</A>" later in this chapter.)
<P>
<FONT SIZE=3><B>Command&#173;Line Options</B></FONT>

<P>
<a name="dex13"></a>
<P>
Using command&#173;line options, you can specify the mode in which
the Upgrade Wizard runs, the OPC file it uses, the log file it
creates, and so forth. To run the Upgrade Wizard with command&#173;line
options, click the <B>Run</B> command on the <B>Start</B> menu
(Windows&nbsp;95 or Windows&nbsp;NT Workstation version&nbsp;4.0)
or on the <B>File</B> menu in Program Manager (Windows&nbsp;NT
Workstation version&nbsp;3.51).
<P>
<a name="dex14"></a>
<P>
The Upgrade Wizard recognizes the following command&#173;line
options:

<FONT SIZE=3 FACE="COURIER NEW,COURIER"><pre><code>Offcln97.exe [/a|/s [/q[/r]] [/l][!][log file]]] [opc file]

</code></pre></FONT>
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Option</FONT></B></TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Description</FONT></B>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/s</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Indicates safe mode. This option performs the same function as selecting <B>Let me decide which Microsoft Office applications will be removed </B>in the Upgrade Wizard. When you use this command&#173;line option, the Upgrade Wizard does not allow you to select which files to keep.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/a</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Indicates aggressive mode. This option performs the same function as selecting <B>Completely remove all of my old Office applications </B>in the Upgrade Wizard. When you use this command&#173;line option, the Upgrade Wizard does not allow you to select which files to keep.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/q</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Indicates quiet mode. The Upgrade Wizard runs without prompting the user for information or displaying progress indicators. If the system needs to be restarted, the Upgrade Wizard does not do so automatically; the tasks are completed the next time the user restarts the system. This command&#173;line option must be preceded by the <B>/a </B>or <B>/s </B>option.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/r</B></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Used with the <B>/q </B>option to restart the system automatically (without prompting the user) if needed. This command&#173;line option must be preceded by the <B>/q </B>option.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/l</B><I>logfile</I></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Generates the log file specified by <I>logfile</I>. (There is no space between <B>/l </B>and the name of the log file.) If <B>/l </B>is specified without a log file name, the default log file created is Pclogout.txt in the current folder of the Upgrade Wizard.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>/l!</B><I>logfile</I></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Does the same as <B>/l</B>, except the Upgrade Wizard does not delete any files. This option is useful to test what the Upgrade Wizard does before actually deleting files.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>Opc file</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Indicates the name of the OPC file. The default is Offcln97.opc in the current folder of the Upgrade Wizard.</FONT>
</TD></TR>

<P>
</TABLE>
<P>
For example, to run the Upgrade Wizard in aggressive mode without
user intervention, restarting the system automatically if needed
and creating the default log file, type this:
<P>
<B>Offcln97.exe /a /q /r /l</B>
<P>
<FONT SIZE=3><B>OPC File Syntax</B></FONT>

<P>
<a name="dex15"></a>
<P>
The OPC file consists of two sections: <I>Definitions</I>
and <I>Commands</I>. The Upgrade Wizard uses the Definitions
section to help determine which commands in the Commands section
to execute. When all the commands in the Commands section have
been evaluated and either executed or skipped, the Upgrade Wizard
is finished.
<P>
By making careful changes to the OPC file, particularly in the
Definitions section, you can customize the way in which the Upgrade
Wizard works.
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>Throughout
the OPC file, comments are identified by a semicolon (;) at the
beginning of the line. The Upgrade Wizard ignores all text following
a semicolon.
<P>
<B>Definitions Section</B>

<P>
<a name="dex16"></a>
<P>
The Definitions section allows you to change the default value
of <I>dependency variables</I>. These are special
keywords that are used by the Upgrade Wizard in the Commands section
to determine which groups of files may be deleted. Dependency
variables represent either a specific application, such as
Word&nbsp;95, or a special set of files, such as files in the
Windows\Temp folder.
<P>
The Definitions section consists of one or more lines, formatted
as follows:
<P>
<I>dependency variable </I><B>=</B><I> value</I>
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>
<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Item</B></FONT></TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Description</FONT></B>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>dependency variable</I></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>A reserved keyword recognized by the Upgrade Wizard. These may be application names or special purpose keywords used to trigger certain functions.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>Value</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>A dependency variable may have one of three values:
<UL TYPE="square">
<LI><B>KEEP</B> (equivalent terms are <B>FALSE</B> or <B>EXIST</B>)
<P><LI><B>REMOVE</B> (equivalent terms are <B>TRUE</B> or <B>NOTEXIST</B>)
<P><LI><B>DETECT</B>
</UL>
</FONT>
</TD></TR>

<P>
</TABLE>
<P>
<a name="dex17"></a>
<P>
The values of the dependency variables indicate the following:
<P>
<UL TYPE="square">
<P>
<LI><B>KEEP</B> indicates that
files associated with this variable should not be deleted. The
values <B>FALSE</B> and <B>EXIST</B> are synonymous with the value
<B>KEEP</B>; these values may be used interchangeably in the OPC
file.
<P>
<LI><B>REMOVE</B> indicates that files associated
with this variable should be deleted. The values <B>TRUE</B> and
<B>NOTEXIST</B> are synonymous with the value <B>REMOVE</B>; these
values may be used interchangeably in the OPC file.
<P>
<LI><B>DETECT</B>
is used for dependency variables that represent applications.
<P>
In safe mode, if the dependency variable is assigned
the value DETECT in the Definitions section, then the Upgrade
Wizard examines the computer to determine whether the application
is currently installed. If it is, then the Upgrade Wizard reassigns
the value KEEP to the dependency variable. If the application
is not installed, then the Upgrade Wizard reassigns the value
REMOVE to the dependency variable.
<P>
In aggressive mode, if the dependency variable is
assigned the value DETECT in the Definitions section, then the
Upgrade Wizard reassigns the value REMOVE to the dependency variable
whether or not the application is currently installed.
<P>
</UL>
<P>
After the Upgrade Wizard processes the Definitions section, all
dependency variables have either the value <B>KEEP</B> or <B>REMOVE</B>.
For example, suppose Word&nbsp;95 is currently installed on the
computer, and Excel&nbsp;95 is not. The following definitions
assign the values shown in safe mode.
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>This definition</FONT></B></TD>
<TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Results in this value</FONT></B>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>WORD95 = DETECT</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>KEEP</B></FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>EXCEL95 = DETECT</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>REMOVE</B></FONT>
</TD></TR>

<P>
</TABLE>
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>The
Upgrade Wizard determines whether a particular application is
currently installed on the computer by looking for a specific
file in a specific folder, or by checking registry or INI entries.
The files or entries that the Upgrade Wizard looks for are defined
by an internal table in the Upgrade Wizard and cannot be modified
by the user. The Upgrade Wizard detects whether an application
is installed only if the dependency variable is set to DETECT.
<P>
<a name="dex18"></a>
<P>
The following dependency variable application names are recognized
by the Upgrade Wizard.
<P>
<UL TYPE="square">
<P>
<LI>Office 4.<I>x</I> application and component names
<P>
<UL TYPE="square">
<P>
<B>
<LI>ACCESS94
<P>
<LI>ARTGALLERY94
<P>
<LI>BOOKS94
<P>
<LI>EQUATION94
<P>
<LI>EXCEL94
<P>
<LI>GRAPH94
<P>
<LI>IMAGER94
<P>
<LI>MSINFO94
<P>
<LI>MSQUERY94
<P>
<LI>OFFICEMANAGER94
<P>
<LI>ORGCHART94
<P>
<LI>POWERPOINT94
<P>
<LI>RUNFROMNET94
<P>
<LI>SETUP94
<P>
<LI>WORD94
<P>
<LI>WORDART94
</B><P>
</UL>
<LI>Office&nbsp;95 application and component names
<UL TYPE="square">
<P>
<B><LI>ACCESS95
<P>
<LI>ARTGALLERY95
<P>
<LI>BINDER95
<P>
<LI>BOOKS95
<P>
<LI>EQUATION95
<P>
<LI>EXCEL95
<P>
<LI>GRAPH95
<P>
<LI>IMAGER95
<P>
<LI>MSINFO95
<P>
<LI>MSQUERY95
<P>
<LI>ORGCHART95
<P>
<LI>POWERPOINT95
<P>
<LI>RUNFROMNETCD95
<P>
<LI>SCHEDULE95
<P>
<LI>SETUP95
<P>
<LI>SHORTCUTBAR95
<P>
<LI>WORD95
<P>
<LI>WORDART95
</B>
<P>
</UL>
<P>
<LI>Office&nbsp;97 application and component names
<P>
<UL TYPE="square">
<P>
<B><LI>ACCESS97
<P>
<LI>ARTGALLERY97
<P>
<LI>BINDER97
<P>
<LI>BOOKS97
<P>
<LI>DAO97
<P>
<LI>DATAMAP97
<P>
<LI>EQUATION97
<P>
<LI>EXCEL97
<P>
<LI>GRAPH97
<P>
<LI>INFO97
<P>
<LI>OFFICE97
<P>
<LI>ORGCHART97
<P>
<LI>OUTLOOK97
<P>
<LI>PHOTOED97
<P>
<LI>POWERPOINT97
<P>
<LI>QUERY97
<P>
<LI>RUNFROMNETCD97
<P>
<LI>SCHEDULE97
<P>
<LI>SETUP97
<P>
<LI>SHORTCUTBAR97
<P>
<LI>WORD97
</B>
<P>
</UL>
<LI>Other application names
<UL TYPE="square">
<P>
<B><LI>PROJECT94
<P>
<LI>PROJECT95
<P>
<LI>PUBLISHER2
<P>
<LI>PUBLISHER3
<P>
<LI>PUBLISHER4
<P>
<LI>TEAMMANAGER97
</B>
<P>
</UL></UL>
<P>
<a name="dex19"></a>
<P>
Dependency variables may be special purpose keywords. These have
predefined values that may be changed in the Definitions section.
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Special purpose keyword</FONT></B>
</TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Description</FONT></B></TD>
</TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>TEMPFOLDERCONTENTS</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Used to determine whether to remove files from temporary folders. Defaults to <B>KEEP</B>.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>TEMPTWIDDLEFILESONLY</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Used to determine whether to remove files preceded by a tilde (~) from temporary folders. Defaults to <B>KEEP</B>.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>RECYCLEBINCONTENTS</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Used to determine whether to empty the contents of the Windows Recycle Bin. Defaults to <B>KEEP</B>.</FONT>
</TD></TR>

<P>
</TABLE>
<P>
The Upgrade Wizard also uses certain special purpose keywords
with predefined values that may not be changed in the Definitions
section.
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Special purpose keyword</FONT></B>
</TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Description</FONT></B></TD>
</TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>RISKY</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Set to <B>REMOVE </B>in aggressive mode and <B>KEEP </B>in safe mode.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>SAFE</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Always set to <B>REMOVE</B>. This keyword is used only to clarify which section in the OPC file might be deleted in safe mode.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>AFTER97INSTALL</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Defaults to <B>REMOVE </B>if <B>RISKY </B>has the value <B>REMOVE </B>or if <B>OFFICE97 </B>has the value <B>KEEP</B>. Otherwise, it defaults to <B>KEEP</B>.</FONT>
</TD></TR>

<P>
</TABLE>
<P>
In safe mode, the Upgrade Wizard sets the value of the dependency
variable <B>SAFE</B> to <B>REMOVE</B><BR>
 and <B>RISKY</B> to <B>KEEP</B>.
The result is that any command that has the dependency variable
<B>RISKY</B> is not executed in safe mode. In aggressive mode,
however, the Upgrade Wizard sets the value of both <B>SAFE</B>
and <B>RISKY</B> to <B>REMOVE</B>. The result is that any command
that has the dependency variable <B>RISKY</B> is executed in aggressive
mode, if no other dependency variables have the value <B>KEEP</B>.
<P>
The OPC file included in the Office Resource Kit uses the <B>RISKY</B>
dependency variable for commands that include files shared by
several applications, such as the spelling checker or clip art
files. These files are removed only if the Upgrade Wizard is run
in aggressive mode, after which you need to reinstall Office&nbsp;97
to restore the files.
<P>
<B>Commands Section</B>

<P>
<a name="dex20"></a>
<P>
The Commands section contains one or more commands that consist
of a <I>dependency list</I> and a set of <I>actions</I>.
The Upgrade Wizard evaluates the dependency list to determine
whether the command should be executed.
<P>
The dependency lists contains dependency variables, each of which
has the value <B>KEEP</B> or <B>REMOVE</B>. (The Upgrade Wizard
already changed all <B>DETECT</B> values to <B>KEEP</B> or <B>REMOVE</B>
when it finished processing the Definitions section.) If all the
dependency variables in the dependency list have the value <B>REMOVE</B>,
then the Upgrade Wizard executes the actions listed in the command.
If any dependency variable has the value <B>KEEP</B>, then the
Upgrade Wizard skips this command and goes to the next one.
<P>
<a name="dex21"></a>
<P>
Commands are formatted as follows:
<P>
<B>[</B><I>dependency list</I><B>]</B> <B>"</B><I>description</I><B>"</B>
<BR>
<UL TYPE="square">
<I>action</I>
<BR>
&#09;<I>action</I>
</UL>
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>Item</B></FONT></TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Description</FONT></B>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>dependency list</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>A list of one or more dependency variables separated by commas.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>description</I></FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>A string that describes the files listed under this command. In the Upgrade Wizard, if a user selects a file associated with this command in the <B>Files to remove </B>list, the string is displayed. The string may contain any number of characters and spaces, but must not begin with a space, tab character, or quotation mark (").
</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>action</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The name and path of a file to delete, a registry entry to remove, an INI file entry to remove, or a special action to execute.</FONT>
</TD></TR>

<P>
</TABLE>
<P>
<a name="dex22"></a>
<P>
The following sections describe actions that may be associated
with commands.
<P>
<FONT SIZE=3><B>File</B></FONT>

<P>
This action indicates a file to be removed. The syntax is:
<P>
<I>folder</I><B>\</B><I>file</I> <B>"</B><I>description</I><B>"</B>
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Item</FONT></B></TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Description</FONT></B>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>folder</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>A fully qualified path, or one of a predefined list of folder keywords; optional</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>file</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The name of the file to be removed</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>description</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>An optional string describing the file</FONT>
</TD></TR>

<P>
</TABLE>
<P>
<a name="dex23"></a>
<P>
A folder name may be an explicit path, such as C:\Users\Tools.dat,
or you can use one of the following predefined folder names.
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>This folder keyword</FONT></B>
</TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Represents this folder</FONT></B>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>WINDIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Windows root folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>SYSDIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Windows System folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>ROOTDIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Root folder of the hard disk containing Office&nbsp;95</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>SYSMENUROOTDIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Windows Start Menu folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>SYSMENUPROGRAMSDIR</FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Programs folder under Windows Start Menu folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>SYSMENUSTARTUPDIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Start up folder under Windows Start Menu\Programs folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>SYSPROGRAMFILESDIR</FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>System Program Files folder </FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>OFFICE94DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Office 4.3 folder </FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>ACCESS94DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Microsoft Access version 2.0 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>BOOKS94DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Bookshelf 4.3 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>BUTTONS94DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>MS&#173;Bttns folder under the Office 4.3 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>CLIPART94DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Clip art folder for Office 4.3</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>EXCEL94DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Excel version 5.0 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>MSAPPS94DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Shared application files folder for Office 4.3</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>POWERPOINT94DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Microsoft PowerPoint version 4.0 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>SETUP94DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Setup for Office 4.3 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>STARTMENU94DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Office 4.3 folder under Windows Start Menu\Programs folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>WORD94DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Word version 6.0 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>OFFICEROOT95DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Office&nbsp;95 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>OFFICE95DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Office folder under Office&nbsp;95 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>ACCESS95DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Access&nbsp;95 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>BINDER95DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Office&nbsp;95 Binders folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>BOOKS95DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Bookshelf&nbsp;95 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>CLIPART95DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Office&nbsp;95 Clip art folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>EXCEL95DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Excel&nbsp;95 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>EXCEL95VIEWERDIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Excel&nbsp;95 Viewer folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>IMAGER95DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Microsoft Imager&nbsp;95 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>MSAPPS95DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Shared application files folder for Office&nbsp;95</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>POWERPOINT95DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>PowerPoint&nbsp;95 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>POWERPOINT95VIEWERDIR</FONT></TD>
<TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>PowerPoint&nbsp;95 Viewer folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>SCHEDULE95DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Schedule+&nbsp;95 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>SOUNDS95DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Shared sound files folder for Office&nbsp;95</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>TEMPLATES95DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Templates folder for Office&nbsp;95</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>WORD95DIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Word&nbsp;95 folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>WORD95IADIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Word&nbsp;95 Internet Assistant folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>WORD95VIEWERDIR</FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Word&nbsp;95 Viewer folder</FONT>
</TD></TR>

<P>
</TABLE>
<P>
<FONT SIZE=3><B>Registry Entry</B></FONT>

<P>
This action indicates a registry entry to be removed. The syntax
is:
<P>
<B>HK</B><I>xx</I><B>\</B><I>key</I>
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Item</FONT></B></TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Description</FONT></B>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>HK<I>xx</I></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The top&#173;level registry key:
<UL TYPE="square">
<LI><B>HKLM</B> for <B>HKEY_LOCAL_MACHINE</B>
<P><LI><B>HKCR</B> for <B>HKEY_CLASSES_ROOT</B>
<P><LI><B>HKCU</B> for <B>HKEY_CURRENT_USER</B>
<P><LI><B>HKUR</B> for <B>HKEY_USERS</B>
</UL>
</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>key</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The registry key or value to remove.</FONT>
</TD></TR>

<P>
</TABLE>
<P>
For example:

<FONT SIZE=3 FACE="COURIER NEW,COURIER"><pre><code>HKCR\MSOfficeSetup

</code></pre></FONT>
<P>
<FONT SIZE=3><B>Win.ini Entry</B></FONT>

<P>
This action indicates a section or key to be removed from the
Win.ini file. The syntax is:
<P>
<B>Win.ini,</B> <I>section</I><B>,</B> <I>key</I>
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Item</FONT></B></TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Description</FONT></B>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>section</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Section name in the Win.ini file.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>Key</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Optional. If present, then only this key is deleted from the Win.ini file. If not present, then the entire section is deleted.</FONT>
</TD></TR>

<P>
</TABLE>
<P>
<FONT SIZE=3><B>Application INI Entry</B></FONT>

<P>
This action indicates a section or key to be removed from an application
INI file. The syntax is:
<P>
<B>INI=</B><I>folder</I><B>\</B><I>file</I><B>,</B>
<I>section</I><B>,</B> <I>key</I>
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Item</FONT></B></TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Description</FONT></B>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>folder</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>A fully qualified path, or one of the predefined folder keywords described earlier in this section.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>file</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The name of the INI file.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>section</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>The section name in the INI file.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>key</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Optional. If present, then only this key is deleted from the INI file. If not present, then the entire section is deleted.</FONT>
</TD></TR>

<P>
</TABLE>
<P>
<FONT SIZE=3><B>Menu Item</B></FONT>

<P>
This action indicates an item on the <B>Start</B> menu (Windows&nbsp;95
or Windows&nbsp;NT Workstation&nbsp;4.0) or in a Program Manager
group (Windows&nbsp;NT Workstation&nbsp;3.51) to be removed. The
syntax is:
<P>
<B>MENU_ITEM=</B><I>group</I><B>\</B><I>item</I>
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Item</FONT></B></TD><TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Description</FONT></B>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>group</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Name of the Program\Start Menu folder or Program Manager group.</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><I>item</I></FONT></TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Item to be removed.</FONT>
</TD></TR>

<P>
</TABLE>
<P>
<FONT SIZE=3><B>Special Action</B></FONT>

<P>
This action includes special functions that are predefined in
the Upgrade Wizard. The syntax is:
<P>
SPECIAL<B>\</B><I>function</I>
<P>
<TABLE WIDTH=80% VALIGN="TOP" BORDER=1 BORDERCOLOR="#C0C0C0" CELLPADDING=4 CELLSPACING=0>

<TR><TD WIDTH=41% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>This function</FONT></B></TD>
<TD WIDTH=59% VALIGN="BOTTOM" BGCOLOR="#C0C0C0"><B><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Removes these files</FONT></B></TD>
</TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>RemoveTempFiles</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>All files from any of these folders and subfolders:</FONT>
<UL TYPE="square">
<LI><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Windows\Temp or Windows\Tmp</FONT>
<P><LI><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>%TEMP% or %TMP% (MS&#173;DOS environment variable)</FONT>
<P><LI><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>drive:\Temp or drive:\Tmp (all hard disks are checked)</FONT>
</UL>

</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>RemoveTwiddleTempFiles</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>All files that start with a tilde (~) character in the temporary folders listed under <B>RemoveTempFiles</B></FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>RemoveInternetExplorerCacheFiles</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>All temporary files from the Microsoft Internet Explorer cache folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>RemoveNetscapeCacheFiles</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>All temporary files from the Netscape Navigator cache folder </FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>EmptyRecycleBinContents</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>All files except Desktop.ini and Info from the Recycle Bin</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>RemoveOffice95ShortcutLnksAndTmps</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>All LMK, TMP, and PIF files in the Office&nbsp;95 Shortcut Bar folder</FONT>
</TD></TR>
<TR><TD WIDTH=41% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2><B>RemoveDuplicateWWINTL32DLL</B></FONT>
</TD><TD WIDTH=59% VALIGN="TOP"><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>Wwintl32.dll in the Windows\System folder if it is also found in the Word&nbsp;95 folder</FONT>
</TD></TR>

<P>
</TABLE>
<P>
<FONT SIZE=3><B><A NAME="CustEx">Customization Example</A></B></FONT>

<P>
<a name="dex24"></a>
<P>
Suppose you want to create a command for your users that does
the following:
<P>
<UL TYPE="square">
<P>
<LI>Runs the Upgrade Wizard
without user intervention
<P>
<LI>Removes all files
from previous versions of Office
<P>
<LI>Empties temporary
folders
<P>
<LI>Empties the Recycle Bin
<P>
<LI>Restarts
the computer automatically, if necessary
<P>
</UL>
<P>
In addition, suppose you want to remove an internal company tool
that is being replaced by Office&nbsp;97 functionality. The program
is called Chart.exe, and it resides in the C:\Program Files\Internal\Chart
folder on users' computers, along with support files, Chartsub.dll,
Chartprt.dat, and Readme.txt in the same folder.
<P>
To do this, use the following procedure:
<P>
<B><FONT COLOR="#0000FF"><IMG SRC="Proced.gif" WIDTH=5 HEIGHT=10 BORDER=0 ALT="">&#09;To
create the customized Upgrade Wizard command</FONT></B>
<P>
<OL>
<P>
<LI>Create a copy of the OPC
file and name it Newopc.opc.
<P>
<LI>Open Newopc.opc
in a text editor.
<P>
This file is too large for Notepad, but it can be
edited in WordPad.
<P>
<LI>Change the following values
at the beginning of the file to <B>REMOVE</B>, as shown here:

<P><FONT SIZE=3 FACE="COURIER NEW,COURIER"><pre><code>RECYCLEBINCONTENTS = REMOVE
TEMPFOLDERCONTENTS = REMOVE
TEMPTWIDDLEFILESONLY = REMOVE

</code></pre></FONT>
<P>
<LI>To indicate that the
listed files will always be deleted, go to the beginning of the
Commands section (immediately before the <FONT SIZE=2 FACE="COURIER NEW,COURIER">[RECYCLEBINCONTENTS]</FONT>
command) and add the following lines:
<P><FONT SIZE=3 FACE="COURIER NEW,COURIER"><pre><code>[SAFE] "Internal charting tool"
C:\program files\internal\chart\chart.exe
C:\program files\internal\chart\chartsub.dll
C:\program files\internal\chart\chartprt.dat
C:\program files\internal\chart\readme.txt

</code></pre></FONT>
<P>
<LI>Save and close Newopc.opc.
<P>
<LI>Test your customized Newopc.opc
file on a user's computer using the <B>/l!</B><I>logfile</I>
command&#173;line option to generate a log of the files that would
be deleted.

<P>
</OL>
<P>
You can distribute your customized OPC file to users, along with
the Upgrade Wizard (Offcln97.exe). Instruct users to enter the
following command using the <B>Run</B> command on the <B>Start</B>
menu (Windows&nbsp;95 or Windows&nbsp;NT Workstation&nbsp;4.0)
or on the <B>File</B> menu in Program Manager (Windows&nbsp;NT
Workstation&nbsp;3.51):

<FONT SIZE=3 FACE="COURIER NEW,COURIER"><pre><code>Offcln97.exe /a /q /r Newopc.opc

</code></pre></FONT>
<P>
<A NAME="ORK009C2"></A>
</MENU></MENU></MENU>
<!--ToTop_START-->
<TABLE width=98% cellpadding=0 cellspacing=0 border=0>
<TR><TD align=right><TABLE cellpadding=0 cellspacing=0 border=0><TR><TD><A href="#top"><FONT SIZE=1 FACE="VERDANA,ARIAL,HELVETICA">Top</FONT></A></TD><TD><A href="#top"><IMG SRC="ar_up.gif" WIDTH=11 HEIGHT=7 BORDER=0 ALIGN=MIDDLE></A></TD></TR></TABLE>
</TD></TR>

</TABLE>
<HR>
<!--ToTop_END-->
<MENU>
<FONT SIZE=5><B><A NAME="CH009H102">Solving Common Setup Problems</A></B></FONT>
<MENU><MENU>

<P>
<a name="dex25"></a>
<P>
This section addresses some common Setup errors that you may encounter
during or after your installation of Office&nbsp;97. In addition
to explaining the possible causes of each error, the following
sections also describe steps you can take to resolve the problem.
Typically, these Setup errors can be corrected by changing the
way you install Office.
<P>
<FONT SIZE=4><B><A NAME="CH009H204">Problems Related to Running Setup</A>
</B></FONT>

<P>
<a name="dex26"></a>
<P>
The following errors may occur when you run the Office Setup program.
<P>
<B>Cannot Open Setup.exe</B>

<P>
When you rerun Office Setup to add or remove components after
installing Office, and the message "Cannot open Setup.exe"
is displayed, Setup is unable to locate the Setup.exe file.
<P>
<B>Cause&nbsp;&nbsp;&nbsp;</B>This can occur if you
originally installed Office from a network server using a drive
letter, but the Setup files have been moved or you are disconnected
from the correct network drive.
<P>
<B>Solution&nbsp;&nbsp;&nbsp;</B>Connect to the administrative
installation point using the same drive letter you used when you
installed Office.
<P>
<B>Disk Is Full</B>

<P>
If you install Office or an Office component on a compressed drive,
you may receive a message stating that the disk is full. This
can occur even though Setup indicates that you have sufficient
disk space for the components when you began the installation
process.
<P>
<B>Cause&nbsp;&nbsp;&nbsp;</B>When you install to
a compressed drive, the amount of available disk space depends
on the types of files that are on the compressed drive and how
effective the disk compression technology is when you compress
different types of data. In some cases, you may need significantly
more disk space than the Setup program indicates.
<P>
<B>Solution&nbsp;&nbsp;&nbsp;</B>Free some disk space
and rerun Setup.
<P>
<B>Setup Creates Mscreate.dir in Every Folder</B>

<P>
After you run Setup, the file Mscreate.dir appears in every new
folder created by the Setup program.
<P>
<B>Cause&nbsp;&nbsp;&nbsp;</B>Setup creates Mscreate.dir
(a 0&#173;byte hidden file) in each folder to indicate that the
folder was created by Setup. When you run Setup in maintenance
mode and remove a component or click <B>Remove All</B>, Setup
uses this file to determine whether an empty folder can be removed.
If an empty folder does not contain Mscreate.dir, Setup does not
remove the folder.
<P>
For example, you might create the folder My Files in the
Office folder. When you run Office Setup in maintenance
mode and click <B>Remove All</B>, your My Files folder is not
removed by Setup, even if it is empty when you run Setup.
<P>
<B>Solution&nbsp;&nbsp;&nbsp;</B>No action is needed.
<P>
<B>~Mssetup.t\~Msstfqf.t Folder Remains After Setup</B>

<P>
After you run Setup, a folder with the name ~Mssetup.t\~Msstfqf.t
may be left on your hard disk.
<P>
<B>Cause&nbsp;&nbsp;&nbsp;</B>This can occur if you
run Setup to add or remove Office components and Setup restarts
your computer to complete the installation update. Setup creates
these temporary folders during installation, but cannot remove
them while the computer is restarting.
<P>
<B>Solution&nbsp;&nbsp;&nbsp;</B>After Setup has completed,
you can delete these temporary folders manually if they remain
on your hard disk after Setup is complete.
<P>
<FONT SIZE=4><B><A NAME="CH009H205">Problems Caused by Previously Installed
Files</A></B></FONT>

<P>
<a name="dex27"></a>
<P>
The following errors are caused by previously installed files.
Most of these errors can be corrected by manually deleting the
old files after you run Setup.
<P>
<B>Not All Folders Are Deleted When You Remove Office</B>

<P>
After you run Setup and select <B>Remove All</B>, the
Office folder structure (Program Files\Microsoft Office by default
or another folder you choose during Setup) remains on your disk.
<P>
<B>Cause&nbsp;&nbsp;&nbsp;</B>This behavior is a function
of Setup. Setup leaves Office folders intact so that files and
INI entries that were not created by Office are not deleted. The
Setup program deletes only what it installed.
<P>
<B>Solution&nbsp;&nbsp;&nbsp;</B>Once you have removed
any user files from the Office folder structure, you
can delete the folders manually.
<P>
<B>Setup Does Not Remove Application Shortcut</B>

<P>
When you run Setup and click <B>Remove All</B>, the shortcut for
the application that you remove may still be available in Windows.
(This error occurs only when you install Office&nbsp;97 in Windows&nbsp;95
or Windows&nbsp;NT Workstation&nbsp;4.0.)
<P>
<FONT COLOR="#0000FF" SIZE=2><B>Note&nbsp;&nbsp;&nbsp;</B></FONT>Shortcuts
are added to the Windows\Start Menu\Programs folder and appear
on the Programs submenu (Start menu).
<P>
<B>Cause&nbsp;&nbsp;&nbsp;</B>This occurs if you have
renamed the shortcut for the application. For example, if you
rename the shortcut for Microsoft Word to Word, the shortcut is
not removed when you run Setup and click <B>Remove All</B>. If
Setup cannot locate the shortcut with the original name, it assumes
that the shortcut does not exist.
<P>
<B>Solution&nbsp;&nbsp;&nbsp;</B>You can delete the
shortcut manually after running Setup.
<P>
<B>Program Group Cannot Be Displayed</B>

<P>
When you run Setup, you may receive the following message: "Program
group <I>groupname</I> cannot be displayed."
The message may appear repeatedly. (This error occurs only when
installing Office&nbsp;97 in Windows&nbsp;NT Workstation&nbsp;3.51.)
<P>
<B>Cause&nbsp;&nbsp;&nbsp;</B>This occurs when Setup
tries to exceed the maximum of 40&nbsp;program groups that Program
Manager allows. If you already have 40&nbsp;program groups, and
you run Setup, you receive this error message if you choose to
add a new program group.
<P>
<B>Solution&nbsp;&nbsp;&nbsp;</B>To avoid receiving
this error message when you already have 40 program groups in
Program Manager, do one of the following:
<P>
<UL TYPE="square">
<P>
<LI>Eliminate at least one program
group before running Setup.
<P>
<LI>When Setup prompts
you to add the program icons to a program group, select an existing
program group instead of creating a new program group.
<P>
</UL>
<P>
<B>Setup Installs Shared Files Locally</B>

<P>
When you install Office from an administrative installation point,
the Setup program may copy shared files to the hard disk even
if you specify that they should be run from the server. You do
not receive a message informing you that these files are being
installed locally; after Office is installed, the applications
function correctly.
<P>
<B>Cause&nbsp;&nbsp;&nbsp;</B>Setup checks the computer
to see if a previous version of shared files exists on the hard
disk. If so, Setup updates the existing version with Office&nbsp;97
shared files.
<P>
<B>Solution&nbsp;&nbsp;&nbsp;</B>Rerun Setup and click
<B>Remove All</B> to uninstall Office&nbsp;97, remove the previous
Office files, and then install Office&nbsp;97 again. You can remove
files from previous versions of Office using the Office&nbsp;97
Upgrade Wizard. See "<A HREF="#CH009H201">Using
the Office&nbsp;97 Upgrade Wizard</A>" earlier in this chapter.
<P>
<B>Cannot Install _MSIMP.DLL into Notes Folder</B>

<P>
When you run Setup on a workstation on which Lotus Notes is already
installed, you may receive the error message: "_MSIMP.DLL
can't be installed into Notes directory." _MSIMP.DLL is a
converter that allows Lotus Notes to import Word documents.
<P>
<B>Cause&nbsp;&nbsp;&nbsp;</B>If the Lotus Notes program
file (Notes.exe) is located on a network server instead of in
your local Notes folder and the server location is read&#173;only,
Setup cannot write the converter file to the server folder. Lotus
Notes requires that the converter be in the same folder as the
Lotus Notes program file.
<P>
<B>Solution&nbsp;&nbsp;&nbsp;</B>Change the read&#173;only
setting of the Notes folder on the server and run Setup again.
<BR>
</MENU></MENU></MENU>
<HR>
<!--ToTop_START-->
<TABLE width=98% cellpadding=0 cellspacing=0 border=0>
<TR><TD align=right><TABLE cellpadding=0 cellspacing=0 border=0><TR><TD><A href="#top"><FONT SIZE=1 FACE="VERDANA,ARIAL,HELVETICA">Top</FONT></A></TD><TD><A href="#top"><IMG SRC="ar_up.gif" WIDTH=11 HEIGHT=7 BORDER=0 ALIGN=MIDDLE></A></TD></TR></TABLE>
</TD></TR>

</TABLE>


<!--ToTop_END-->

<!--EndNav_Start--><CENTER>
<A HREF="FULLTOC.htm">Contents</A>
| <a href="008.htm">&lt;&lt; Previous</A>
| <a href="010.htm">Next &gt;&gt;</A>
| <A HREF="A.HTM">Index</A>
</CENTER>
<P><FONT SIZE=3 FACE="COURIER NEW,COURIER"></FONT>
</FONT>
</BODY>
</HTML>
