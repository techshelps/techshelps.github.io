<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLRequest Function</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>SQLRequest Function</H1>Description</P>
Don't use <SPAN CLASS="lee">SQLRequest</SPAN> and the other ODBC functions in the Xlodbc.xla add-in; use the objects, methods, and properties in the Data Access Objects (DAO) library instead.</P>
<SPAN CLASS="lee">SQLRequest</SPAN> connects to an external data source and runs a query from a worksheet, and then it returns the result of the query as an array.</P>
This function is contained in the Xlodbc.xla add-in (ODBC Add-In on the Macintosh). Before you use the function, you must establish a reference to the add-in by using the <SPAN CLASS="eln">References</SPAN> command (<SPAN CLASS="eln">Tools</SPAN> menu).</P>
Syntax</P>
<SPAN CLASS="lee">SQLRequest</SPAN><SPAN CLASS="l">(</SPAN><SPAN CLASS="narg">ConnectionStr,</SPAN> <SPAN CLASS="narg">QueryText,</SPAN> <SPAN CLASS="narg">OutputRef,</SPAN> <SPAN CLASS="narg">DriverPrompt,</SPAN> <SPAN CLASS="narg">ColNamesLogical</SPAN><SPAN CLASS="l">)</SPAN></P>
<SPAN CLASS="narg">ConnectionStr</SPAN>   Required. Supplies information — such as the data source name, user ID, and passwords — required by the driver being used to connect to a data source; must follow the driver's format. </P>
You must define the data source name (DSN) used in <SPAN CLASS="narg">ConnectionStr</SPAN> before you try to connect to it. </P>
If <SPAN CLASS="lee">SQLRequest</SPAN> is unable to access the data source using <SPAN CLASS="narg">ConnectionStr</SPAN>, it returns Error 2042.</P>
<SPAN CLASS="narg">QueryText</SPAN>   Required. The SQL statement you want to execute on the data source.</P>
If <SPAN CLASS="lee">SQLRequest</SPAN> is unable to execute <SPAN CLASS="narg">QueryText</SPAN> on the specified data source, it returns Error 2042.</P>
<SPAN CLASS="narg">OutputRef</SPAN>   Optional. A <SPAN CLASS="lee">Range</SPAN> object (must be a single cell) where you want the completed connection string to be placed.</P>
<SPAN CLASS="narg">DriverPrompt</SPAN>   Optional. Specifies whether the driver dialog box is displayed and which options are available. Use one of the values described in the following table. If <SPAN CLASS="narg">DriverPrompt</SPAN> is omitted, <SPAN CLASS="lee">SQLRequest</SPAN> uses 2 as the default.</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"><COL WIDTH="275pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Value</P></TD><TD COLSPAN="3" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Meaning</P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">1</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The driver dialog box is always displayed.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">2</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The driver dialog box is displayed only if information provided by the connection string and the data source specification isn't sufficient to complete the connection. All dialog box options are available.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">3</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The driver dialog box is displayed only if information provided by the connection string and the data source specification isn't sufficient to complete the connection. Dialog box options that aren't required are dimmed (unavailable).</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">4</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The dialog box isn't displayed. If the connection isn't successful, it returns an error.</P></TD></TR></TBODY></TABLE>
<BR></P><SPAN CLASS="narg">ColNamesLogical</SPAN>   Optional. <SPAN CLASS="lee">True</SPAN> to have the column names be returned as the first row of results. <SPAN CLASS="lee">False</SPAN> to not have the column names be returned. If <SPAN CLASS="narg">ColNamesLogical</SPAN> is omitted, the default value is <SPAN CLASS="lee">False</SPAN>.</P>
Remarks</P>
The arguments to the <SPAN CLASS="lee">SQLRequest</SPAN> function are in a different order than the arguments to the SQL.REQUEST macro function.</P>
Return Value</P>
If this function completes all of its actions, it returns an array of query results or the number of rows affected by the query.</P>
If <SPAN CLASS="lee">SQLRequest</SPAN> is unable to complete all of its actions, it returns an error value and places the error information in memory for <SPAN CLASS="lee">SQLError</SPAN>.</P>
If <SPAN CLASS="lee">SQLRequest</SPAN> is unable to access the data source using <SPAN CLASS="narg">ConnectionStr</SPAN>, it returns Error 2042.</P>
See Also</P>
<SPAN CLASS="eln">SQLBind</SPAN> function, <SPAN CLASS="eln">SQLClose</SPAN> function, <SPAN CLASS="eln">SQLError</SPAN> function, <SPAN CLASS="eln">SQLExecQuery</SPAN> function, <SPAN CLASS="eln">SQLGetSchema</SPAN> function, <SPAN CLASS="eln">SQLOpen</SPAN> function, <SPAN CLASS="eln">SQLRetrieve</SPAN> function, <SPAN CLASS="eln">SQLRetrieveToFile</SPAN> function.</P>
Example</P>
This example runs a query on the NWind sample database. The result of the query, displayed on Sheet1, is a list of all products that are currently on order. The <SPAN CLASS="lee">SQLRequest</SPAN> function also writes the full connection string to Sheet2.</P>

<pre><code>If Application.OperatingSystem Like "*Win*" Then
    databaseName = "NWind"
Else            'Macintosh.
    databaseName = "NorthWind"
End If
queryString = "SELECT * FROM product.dbf WHERE (product.ON_ORDER&lt;&gt;0)"
returnArray = SQLRequest("DSN=" &amp; databaseName, _
            queryString, _
            Worksheets("Sheet1").Range("A1"), _
            2, True)
For i = LBound(returnArray, 1) To UBound(returnArray, 1)
    For j = LBound(returnArray, 2) To UBound(returnArray, 2)
        Worksheets("Sheet1").Cells(i, j).Formula = returnArray(i, j)
    Next j
Next i</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
