<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Add Method (QueryTables Collection)</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>Add Method (QueryTables Collection)</H1>Applies To</P>
<SPAN CLASS="eln">QueryTables</SPAN> collection object.</P>
Description</P>
Creates a new query table. Returns a <SPAN CLASS="lee">QueryTable</SPAN> object that represents the new query table.</P>
Syntax</P>
<SPAN CLASS="p">expression</SPAN><SPAN CLASS="l">.</SPAN><SPAN CLASS="lee">Add</SPAN><SPAN CLASS="l">(</SPAN><SPAN CLASS="narg">Connection,</SPAN> <SPAN CLASS="narg">Destination,</SPAN> <SPAN CLASS="narg">Sql</SPAN><SPAN CLASS="l">)</SPAN></P>
<SPAN CLASS="p">expression</SPAN>   Required. An expression that returns a <SPAN CLASS="lee">QueryTables</SPAN> object.</P>
<SPAN CLASS="narg">Connection</SPAN>   Required <SPAN CLASS="lee">Variant</SPAN>. The data source for the query table. Can be one of the following:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI2">A string containing an ODBC connection string.</LI><LI CLASS="ULI2">A <SPAN CLASS="lee">QueryTable</SPAN> object from which the query information is initially copied, including the connection string and the SQL text, but not including the <SPAN CLASS="narg">Destination</SPAN> range. Specifying a <SPAN CLASS="lee">QueryTable</SPAN> object causes the <SPAN CLASS="narg">Sql</SPAN> argument to be ignored.</LI><LI CLASS="ULI2">A DAO <SPAN CLASS="lee">RecordSet</SPAN> object. Data is read from the DAO recordset. Microsoft Excel retains the DAO recordset until the query table is deleted or the connection is changed. The resulting query table cannot be edited.</LI><LI CLASS="ULI2">A Web query. A string in the form "URL;&lt;url&gt;", where "URL;" is required but not localized and the rest of the string is used for the URL of the Web query.</LI><LI CLASS="ULI2">Data Finder. A string in the form "FINDER;&lt;data finder file path&gt;" where "FINDER;" is required but not localized. The rest of the string is the path and file name of a Data Finder file (*.dqy or *.iqy). The file is read when the <SPAN CLASS="lee">Add</SPAN> method is run; subsequent calls to the <SPAN CLASS="lee">Connection</SPAN> property of the query table will return strings beginning with "ODBC;" or "URL;" as appropriate.</LI></UL></SPAN><SPAN CLASS="narg">Destination</SPAN>   Required <SPAN CLASS="lee">Range</SPAN>. The cell in the upper-left corner of the query table destination range (the range where the resulting query table will be placed). The destination range must be on the worksheet that contains the <SPAN CLASS="lee">QueryTables</SPAN> object specified by <SPAN CLASS="p">expression</SPAN>.</P>
<SPAN CLASS="narg">Sql</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. The SQL query string to be run on the ODBC data source. This argument is optional when you're using an ODBC data source (if you don't specify it here, you should set it by using the <SPAN CLASS="lee">Sql</SPAN> property of the query table before the table is refreshed). This argument cannot be used when a <SPAN CLASS="lee">QueryTable</SPAN> object or a DAO <SPAN CLASS="lee">Recordset</SPAN> object is specified as the data source.</P>
Remarks</P>
A query created by this method isn't run until the <SPAN CLASS="lee">Refresh</SPAN> method is called.</P>
Example</P>
This example creates a new query table.</P>

<pre><code>sqlstring = "select 96Sales.totals from 96Sales where profit &lt; 5"
connstring = _
    "ODBC;DSN=96SalesData;UID=Rep21;PWD=NUyHwYQI;Database=96Sales"
With ActiveSheet.QueryTables.Add(Connection:=connstring, _
        Destination:=Range("B1"), Sql:=sqlstring)
    .Refresh
End With</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
