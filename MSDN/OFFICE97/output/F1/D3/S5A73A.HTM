<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Refresh Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>Refresh Method</H1>Applies To</P>
<SPAN CLASS="eln">Chart</SPAN> object, <SPAN CLASS="eln">PivotCache</SPAN> object, <SPAN CLASS="eln">QueryTable</SPAN> object.</P>
Description</P>
Updates the PivotTable cache or query table.</P>
Syntax</P>
<SPAN CLASS="p">expression</SPAN><SPAN CLASS="l">.</SPAN><SPAN CLASS="lee">Refresh</SPAN><SPAN CLASS="l">(</SPAN><SPAN CLASS="narg">BackgroundQuery</SPAN><SPAN CLASS="l">)</SPAN></P>
<SPAN CLASS="p">expression</SPAN>   Required. An expression that returns a <SPAN CLASS="lee">PivotCache</SPAN> or <SPAN CLASS="lee">QueryTable</SPAN> object.</P>
<SPAN CLASS="narg">BackgroundQuery</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. Used only with query tables. <SPAN CLASS="lee">True</SPAN> to return control to the procedure as soon as a database connection is made and the query is submitted (the query is updated in the background). <SPAN CLASS="lee">False</SPAN> to return control to the procedure only after all data has been fetched to the worksheet. If this argument isn't specified, the setting of the <SPAN CLASS="lee">BackgroundQuery</SPAN> property determines the query mode.</P>
Remarks</P>
The following remarks apply to the <SPAN CLASS="lee">QueryTable</SPAN> object.</P>
The <SPAN CLASS="lee">Refresh</SPAN> method causes Microsoft Excel to connect to the query table's data source, execute the SQL query, and return data to the query table destination range. Until this method is called, the query table doesn't communicate with the data source.</P>
When making the connection to the ODBC data source, Microsoft Excel uses the connection string specified by the <SPAN CLASS="lee">Connection</SPAN> property. If the specified connection string is missing required values, the ODBC driver manager or the ODBC driver (or both) will display modal dialog boxes to prompt the user for the required information. If the <SPAN CLASS="lee">DisplayAlerts</SPAN> property is <SPAN CLASS="lee">False</SPAN>, dialog boxes aren't displayed and the <SPAN CLASS="lee">Refresh</SPAN> method fails with the Insufficient Connection Information exception.</P>
After Microsoft Excel makes a successful connection, it stores the completed connection string so that prompts won't be displayed for subsequent calls to the <SPAN CLASS="lee">Refresh</SPAN> method during the same editing session. You can obtain the completed connection string by examining the value of the <SPAN CLASS="lee">Connection</SPAN> property.</P>
After the database connection is made, the SQL query is validated. If the query isn't valid, the <SPAN CLASS="lee">Refresh</SPAN> method fails with the SQL Syntax Error exception.</P>
If the query requires parameters, the <SPAN CLASS="lee">Parameters</SPAN> collection must have been initialized with parameter binding information. If not enough parameters have been bound, the <SPAN CLASS="lee">Refresh</SPAN> method fails with the Parameter Error exception. If parameters are set to prompt for their values, dialog boxes are displayed to the user regardless of the setting of the <SPAN CLASS="lee">DisplayAlerts</SPAN> property. If the user cancels a parameter dialog box, the <SPAN CLASS="lee">Refresh</SPAN> method halts and returns <SPAN CLASS="lee">False</SPAN>. If there are extra parameters bound with the <SPAN CLASS="lee">Parameters</SPAN> collection, the extra parameters are ignored.</P>
The <SPAN CLASS="lee">Refresh</SPAN> method returns <SPAN CLASS="lee">True</SPAN> if the query is successfully completed or started; it returns <SPAN CLASS="lee">False</SPAN> if the user cancels a connection or parameter dialog box.</P>
To see whether the number of fetched rows exceeded the number of available rows on the worksheet, examine the <SPAN CLASS="lee">FetchedRowOverflow</SPAN> property. This property is initialized every time the <SPAN CLASS="lee">Refresh</SPAN> method is called.</P>
Example</P>
This example refreshes the PivotTable.</P>

<pre><code>Worksheets(1).PivotTables(1).PivotCache.Refresh</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
