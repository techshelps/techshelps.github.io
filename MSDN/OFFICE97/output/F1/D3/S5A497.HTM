<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DDEPoke Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>DDEPoke Method</H1>Applies To</P>
<SPAN CLASS="eln">Application</SPAN> object.</P>
Description</P>
Sends data to an application.</P>
Syntax</P>
<SPAN CLASS="p">expression</SPAN><SPAN CLASS="l">.</SPAN><SPAN CLASS="lee">DDEPoke</SPAN><SPAN CLASS="l">(</SPAN><SPAN CLASS="narg">Channel,</SPAN> <SPAN CLASS="narg">Item,</SPAN> <SPAN CLASS="narg">Data</SPAN><SPAN CLASS="l">)</SPAN></P>
<SPAN CLASS="p">expression</SPAN>   Optional. An expression that returns an <SPAN CLASS="lee">Application</SPAN> object.</P>
<SPAN CLASS="narg">Channel</SPAN>   Required <SPAN CLASS="lee">Long</SPAN>. The channel number returned by the <SPAN CLASS="lee">DDEInitiate</SPAN> method.</P>
<SPAN CLASS="narg">Item</SPAN>   Required <SPAN CLASS="lee">Variant</SPAN>. The item to which the data is to be sent.</P>
<SPAN CLASS="narg">Data</SPAN>   Required <SPAN CLASS="lee">Variant</SPAN>. The data to be sent to the application.</P>
Remarks</P>
An error occurs if the method call doesn't succeed.</P>
Example</P>
This example opens a channel to Word for Windows, opens the Word document Sales.doc, and then inserts the contents of cell A1 (on Sheet1) at the beginning of the document.</P>

<pre><code>channelNumber = Application.DDEInitiate(app:="WinWord", _
    topic:="C:\WINWORD\SALES.DOC")
Set rangeToPoke = Worksheets("Sheet1").Range("A1")
Application.DDEPoke channelNumber, "\StartOfDoc", rangeToPoke
Application.DDETerminate channelNumber</code></pre>
This example opens a channel to Word for the Macintosh, opens the Word document Sales Report, and then inserts the contents of cell A1 (on Sheet1) at the beginning of the document. On the Macintosh, you must use the <SPAN CLASS="lee">Shell</SPAN> function to start Word, because the <SPAN CLASS="lee">DDEInitiate</SPAN> method doesn't automatically start Word as it does in Windows. Also, because the <SPAN CLASS="lee">Shell</SPAN> function is asynchronous, the macro may call the <SPAN CLASS="lee">DDEInitiate</SPAN> method before Word has started. This example demonstrates how you can program around this by putting the <SPAN CLASS="lee">DDEInitiate</SPAN> method call in a loop, testing <SPAN CLASS="cte">channelNumber</SPAN> until it is no longer an error.</P>

<pre><code>Shell "HD:Sales Report", 6
Do
    channelNumber = Application.DDEInitiate( _
        app:="WinWord", _
        topic:="HD:Sales Report")
Loop Until TypeName(channelNumber) &lt;&gt; "Error"
Set rangeToPoke = Worksheets("Sheet1").Range("A1")
Application.DDEPoke channelNumber, "\StartOfDoc", rangeToPoke
Application.DDETerminate channelNumber</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
