<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ExecuteExcel4Macro Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>ExecuteExcel4Macro Method</H1>Applies To</P>
<SPAN CLASS="eln">Application</SPAN> object.</P>
Description</P>
Runs a Microsoft Excel&nbsp;4.0 macro function and then returns the result of the function. The return type depends on the function.</P>
Syntax</P>
<SPAN CLASS="p">expression</SPAN><SPAN CLASS="l">.</SPAN><SPAN CLASS="lee">ExecuteExcel4Macro</SPAN><SPAN CLASS="l">(</SPAN><SPAN CLASS="narg">String</SPAN><SPAN CLASS="l">)</SPAN></P>
<SPAN CLASS="p">expression</SPAN>   Optional. An expression that returns an <SPAN CLASS="lee">Application</SPAN> object.</P>
<SPAN CLASS="narg">String</SPAN>   Required <SPAN CLASS="lee">String</SPAN>. A Microsoft Excel&nbsp;4.0 macro language function without the equal sign. All references must be given as R1C1 strings. If <SPAN CLASS="narg">String</SPAN> contains embedded double quotation marks, you must double them. For example, to run the macro function =MID("sometext",1,4), <SPAN CLASS="narg">String</SPAN> would have to be "MID(""sometext"",1,4)".</P>
Remarks</P>
The Microsoft Excel&nbsp;4.0 macro isn't evaluated in the context of the current workbook or sheet. This means that any references should be external and should specify an explicit workbook name. For example, to run the Microsoft Excel&nbsp;4.0 macro "My_Macro" in Book1 you must use "Book1!My_Macro( )". If you don't specify the workbook name, this method fails.</P>
See Also</P>
<SPAN CLASS="eln">Run</SPAN> method.</P>
Example</P>
This example runs the <SPAN CLASS="lee">GET.CELL(42)</SPAN> macro function on cell C3 on Sheet1 and then displays the result in a message box. The <SPAN CLASS="lee">GET.CELL(42)</SPAN> macro function returns the horizontal distance from the left edge of the active window to the left edge of the active cell. This macro function has no direct Visual&nbsp;Basic equivalent.</P>

<pre><code>Worksheets("Sheet1").Activate
Range("C3").Select
MsgBox ExecuteExcel4Macro("GET.CELL(42)")</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
