<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SolverOptions Function</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>SolverOptions Function</H1>Description</P>
Allows you to specify advanced options for your Solver model. This function and its arguments correspond to the options in the <SPAN CLASS="eln">Solver Options</SPAN> dialog box.</P>
Before you use this function, you must establish a reference to the Solver add-in. With a Visual&nbsp;Basic module active, click <SPAN CLASS="eln">References</SPAN> on the <SPAN CLASS="eln">Tools</SPAN> menu, and then select the <SPAN CLASS="eln">Solver.xla</SPAN> check box under <SPAN CLASS="eln">Available References</SPAN>. If <SPAN CLASS="eln">Solver.xla</SPAN> doesn't appear under <SPAN CLASS="eln">Available References</SPAN>, click <SPAN CLASS="eln">Browse</SPAN> and open <SPAN CLASS="eln">Solver.xla</SPAN> in the \Excel\Library\Solver folder.</P>
Syntax</P>
<SPAN CLASS="lee">SolverOptions</SPAN><SPAN CLASS="l">(</SPAN><SPAN CLASS="narg">MaxTime,</SPAN> <SPAN CLASS="narg">Iterations,</SPAN> <SPAN CLASS="narg">Precision,</SPAN> <SPAN CLASS="narg">AssumeLinear,</SPAN> <SPAN CLASS="narg">StepThru,</SPAN> <SPAN CLASS="narg">Estimates,</SPAN><BR>ú<SPAN CLASS="narg">Derivatives,</SPAN> <SPAN CLASS="narg">Search,</SPAN> <SPAN CLASS="narg">IntTolerance,</SPAN> <SPAN CLASS="narg">Scaling,</SPAN> <SPAN CLASS="narg">Convergence,</SPAN> <SPAN CLASS="narg">AssumeNonNeg</SPAN><SPAN CLASS="l">)</SPAN></P>
<SPAN CLASS="narg">MaxTime</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. The maximum amount of time (in seconds) Microsoft Excel will spend solving the problem. The value must be a positive integer. The default value 100 is adequate for most small problems, but you can enter a value as high as 32,767.</P>
<SPAN CLASS="narg">Iterations</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. The maximum number of iterations Microsoft Excel will use in solving the problem. The value must be a positive integer. The default value 100 is adequate for most small problems, but you can enter a value as high as 32,767.</P>
<SPAN CLASS="narg">Precision</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. A number between 0 (zero) and 1 that specifies the degree of precision to be used in solving the problem. The default precision is 0.000001. A smaller number of decimal places (for example, 0.0001) indicates a lower degree of precision. In general, the higher the degree of precision you specify (the smaller the number), the more time Solver will take to reach solutions.</P>
<SPAN CLASS="narg">AssumeLinear</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. <SPAN CLASS="lee">True</SPAN> to have Solver assume that the underlying model is linear. This speeds the solution process, but it should be used only if all the relationships in the model are linear. The default value is <SPAN CLASS="lee">False</SPAN>.</P>
<SPAN CLASS="narg">StepThru</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. <SPAN CLASS="lee">True</SPAN> to have Solver pause at each trial solution. You can pass Solver a macro to run at each pause by using the <SPAN CLASS="narg">ShowRef</SPAN> argument of the <SPAN CLASS="lee">SolverSolve</SPAN> function. <SPAN CLASS="lee">False</SPAN> to not have Solver pause at each trial solution. The default value if <SPAN CLASS="lee">False</SPAN>.</P>
<SPAN CLASS="narg">Estimates</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. Specifies the approach used to obtain initial estimates of the basic variables in each one-dimensional search: 1 represents tangent estimates, and 2 represents quadratic estimates. Tangent estimates use linear extrapolation from a tangent vector. Quadratic estimates use quadratic extrapolation; this may improve the results for highly nonlinear problems. The default value is 1 (tangent estimates).</P>
<SPAN CLASS="narg">Derivatives</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. Specifies forward differencing or central differencing for estimates of partial derivatives of the objective and constraint functions: 1 represents forward differencing, and 2 represents central differencing. Central differencing requires more worksheet recalculations, but it may help with problems that generate a message saying that Solver couldn't improve the solution. With constraints whose values change rapidly near their limits, you should use central differencing. The default value is 1 (forward differencing).</P>
<SPAN CLASS="narg">Search</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. Use the <SPAN CLASS="narg">Search</SPAN> options to specify the search algorithm that will be used at each iteration to decide which direction to search in: 1 represents the Newton search method, and 2 represents the conjugate search method. Newton, which uses a quasi-Newton method, is the default search method. This method typically requires more memory than the conjugate search method, but it requires fewer iterations. Conjugate gradient searching requires less memory than the Newton search method, but it typically requires more iterations to reach a particular level of accuracy. You can try this method if you have a large problem and memory usage is a concern. Conjugate searching is especially useful if stepping through the iterations reveals slow progress between successive trial points.</P>
<SPAN CLASS="narg">IntTolerance</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. A decimal number between 0 (zero) and 1 that specifies the degree of integer tolerance. This argument applies only if integer constraints have been defined. You can adjust the tolerance figure, which represents the percentage of error allowed in the optimal solution when an integer constraint is used on any element of the problem. A higher degree of tolerance (allowable percentage of error) would tend to speed up the solution process.</P>
<SPAN CLASS="narg">Scaling</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. If two or more constraints differ by several orders of magnitude, <SPAN CLASS="lee">True</SPAN> to have Solver scale the constraints to similar orders of magnitude during computation. This is useful when the inputs (in the <SPAN CLASS="eln">By Changing Cells</SPAN> box in the<SPAN CLASS="eln"> Solver Parameters</SPAN> dialog box) and outputs (in the <SPAN CLASS="eln">Set Target Cell</SPAN> and <SPAN CLASS="eln">Subject to the Constraints</SPAN> boxes in the <SPAN CLASS="eln">Solver Parameters</SPAN> dialog box) have large differences in magnitude — for example, maximizing percentage of profit based on million-dollar investments. <SPAN CLASS="lee">False</SPAN> to have Solver calculate without scaling the constraints. The default value is <SPAN CLASS="lee">False</SPAN>.</P>
<SPAN CLASS="narg">Convergence</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. A number between 0 (zero) and 1 that specifies the degree of convergence tolerance for the nonlinear Solver. When the relative change in the target cell value is less than this tolerance for the last five iterations, Solver stops and displays the message "Solver converged to the current solution. All constraints are satisfied."</P>
<SPAN CLASS="narg">AssumeNonNeg</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. <SPAN CLASS="lee">True</SPAN> to have Solver assume a lower limit of 0 (zero) for all adjustable (changing) cells that don't have explicit lower limits in the <SPAN CLASS="lee">Constraint</SPAN> list box (the cells must contain nonnegative values). <SPAN CLASS="lee">False</SPAN> to have Solver use only the limits specified in the <SPAN CLASS="lee">Constraint</SPAN> list box.</P>
See Also</P>
<SPAN CLASS="eln">SolverOk</SPAN> function.</P>
Example</P>
This example sets the <SPAN CLASS="lee">Precision</SPAN> option to .001.</P>

<pre><code>Worksheets("Sheet1").Activate
SolverReset
SolverOptions Precision:=0.001
SolverOK SetCell:=Range("TotalProfit"), _
    MaxMinVal:=1, _
    ByChange:=Range("C4:E6")
SolverAdd CellRef:=Range("F4:F6"), _
    Relation:=1, _
    FormulaText:=100
SolverAdd CellRef:=Range("C4:E6"), _
    Relation:=3, _
    FormulaText:=0
SolverAdd CellRef:=Range("C4:E6"), _
    Relation:=4
SolverSolve UserFinish:=False
SolverSave SaveArea:=Range("A33")</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
