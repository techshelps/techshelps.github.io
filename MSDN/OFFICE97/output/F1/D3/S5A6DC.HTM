<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PivotTableWizard Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>PivotTableWizard Method</H1>Applies To</P>
<SPAN CLASS="eln">PivotTable</SPAN> object, <SPAN CLASS="eln">Worksheet</SPAN> object.</P>
Description</P>
Creates a <SPAN CLASS="lee">PivotTable</SPAN>. This method doesn't display the PivotTable Wizard.</P>
Syntax</P>
<SPAN CLASS="p">expression</SPAN><SPAN CLASS="l">.</SPAN><SPAN CLASS="lee">PivotTableWizard</SPAN><SPAN CLASS="l">(</SPAN><SPAN CLASS="narg">SourceType,</SPAN> <SPAN CLASS="narg">SourceData,</SPAN> <SPAN CLASS="narg">TableDestination,</SPAN> <SPAN CLASS="narg">TableName,</SPAN><BR>ú<SPAN CLASS="narg">RowGrand,</SPAN> <SPAN CLASS="narg">ColumnGrand,</SPAN> <SPAN CLASS="narg">SaveData,</SPAN> <SPAN CLASS="narg">HasAutoFormat,</SPAN> <SPAN CLASS="narg">AutoPage,</SPAN> <B><I>Reserved</I></B><SPAN CLASS="narg">,</SPAN><BR>ú<B><I>BackgroundQuery</I></B><SPAN CLASS="narg">,</SPAN> <B><I>OptimizeCache</I></B><SPAN CLASS="narg">,</SPAN> <B><I>PageFieldOrder</I></B><SPAN CLASS="narg">,</SPAN> <B><I>PageFieldWrapCount</I></B><SPAN CLASS="narg">,</SPAN> <B><I>ReadData</I></B><SPAN CLASS="narg">,</SPAN><BR>ú<B><I>Connection</I></B><SPAN CLASS="l">)</SPAN></P>
<SPAN CLASS="p">expression</SPAN>   Required. An expression that returns a <SPAN CLASS="lee">Worksheet</SPAN> or <SPAN CLASS="lee">PivotTable</SPAN> object.</P>
<SPAN CLASS="narg">SourceType</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. The source of the PivotTable data. Can be one of the following <SPAN CLASS="lee">XlPivotTableSourceType</SPAN> constants.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="119pt" VALIGN="TOP"><COL WIDTH="229pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">xlConsolidation</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Multiple consolidation ranges</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">xlDatabase</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Microsoft Excel list or database</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">xlExternal</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Data from another application</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">xlPivotTable</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Same source as another PivotTable</P></TD></TR></TBODY></TABLE>
<BR></P>If you specify this argument, you must also specify <SPAN CLASS="narg">SourceData</SPAN>. If <SPAN CLASS="narg">SourceType</SPAN> and <SPAN CLASS="narg">SourceData</SPAN> omitted, Microsoft Excel assumes that the source type is <SPAN CLASS="lee">xlDatabase</SPAN>, and the source data comes from the named range "Database." If this named range doesn't exist, Microsoft Excel uses the current region if the current selection is in a range of more than 10 cells that contain data. If this isn't true, this method will fail.</P>
<SPAN CLASS="narg">SourceData</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. The data for the new PivotTable. Can be a <SPAN CLASS="lee">Range</SPAN> object, an array of ranges, or a text constant that represents the name of another PivotTable. For an external database, this is a two-element array. The first element is the connection string specifying the ODBC source for the data. The second element is the SQL query string used to get the data. If you specify this argument, you must specify <SPAN CLASS="narg">SourceType</SPAN>. If the active cell is inside the <SPAN CLASS="narg">SourceData</SPAN> range, you must specify <SPAN CLASS="narg">TableDestination</SPAN><SPAN CLASS="p">.</SPAN></P>
<SPAN CLASS="narg">TableDestination</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. A <SPAN CLASS="lee">Range</SPAN> object specifying where the PivotTable should be placed on the worksheet. If this argument is omitted, the PivotTable is placed at the active cell.</P>
<SPAN CLASS="narg">TableName</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. A string that specifies the name of the new PivotTable.</P>
<SPAN CLASS="narg">RowGrand</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. <SPAN CLASS="lee">True</SPAN> to show grand totals for rows in the PivotTable. <SPAN CLASS="lee">False</SPAN> to omit grand totals for rows.</P>
<SPAN CLASS="narg">ColumnGrand</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. <SPAN CLASS="lee">True</SPAN> to show grand totals for columns in the PivotTable. <SPAN CLASS="lee">False</SPAN> to omit grand totals for columns.</P>
<SPAN CLASS="narg">SaveData</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. <SPAN CLASS="lee">True</SPAN> to save data with the PivotTable. <SPAN CLASS="lee">False</SPAN> to save only the PivotTable definition.</P>
<SPAN CLASS="narg">HasAutoFormat</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. <SPAN CLASS="lee">True</SPAN> to have Microsoft Excel automatically format the PivotTable when it's refreshed or when fields are moved.</P>
<SPAN CLASS="narg">AutoPage</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. Valid only if <SPAN CLASS="narg">SourceType</SPAN> is <SPAN CLASS="lee">xlConsolidation</SPAN>. <SPAN CLASS="lee">True</SPAN> to have Microsoft Excel create a page field for the consolidation. If <SPAN CLASS="lee">False</SPAN>, you must create the page field or fields.</P>
<B><I>Reserved</I></B>   Optional <B>Variant</B>. Not used by Microsoft Excel.</P>
<B><I>BackgroundQuery</I></B>   Optional <B>Variant</B>. <SPAN CLASS="lee">True</SPAN> if queries for the PivotTable are performed asynchronously (in the background). The default value is <SPAN CLASS="lee">False</SPAN>.</P>
<SPAN CLASS="narg">OptimizeCache</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. <SPAN CLASS="lee">True</SPAN> to optimize the PivotTable cache when it's constructed. The default value is <SPAN CLASS="lee">False</SPAN>.</P>
<SPAN CLASS="narg">PageFieldOrder</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. The order in which page fields are added to the PivotTable layout. Can be one of the following <SPAN CLASS="lee">XlOrder</SPAN> constants: <SPAN CLASS="lee">xlDownThenOver</SPAN> or <SPAN CLASS="lee">xlOverThenDown</SPAN>. The default value is <B>xlDownThe</B><SPAN CLASS="lee">n</SPAN><B>Over</B>.</P>
<SPAN CLASS="narg">PageFieldWrapCount</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. The number of PivotTable page fields in each column or row. The default value is 0 (zero).</P>
<SPAN CLASS="narg">ReadData</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. <SPAN CLASS="lee">True</SPAN> to create a pivot cache containing all records from the external database; this cache may be very large. If <B>False</B>, some fields can be set to be server-based page fields before the data is actually read.</P>
<SPAN CLASS="narg">Connection</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. A string that contains ODBC settings that allow Microsoft Excel to connect to an ODBC data source; a URL that allows Microsoft Excel to connect to a Web data source; or a file that specifies a database or Web query. Overrides any previous setting of the <SPAN CLASS="lee">Connection</SPAN> property of the <SPAN CLASS="lee">PivotCache</SPAN> object.</P>
Example</P>
This example creates a new PivotTable from a Microsoft Excel database (contained in the range A1:C100).</P>

<pre><code>ActiveSheet.PivotTableWizard xlDatabase, Range("A1:C100")</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
