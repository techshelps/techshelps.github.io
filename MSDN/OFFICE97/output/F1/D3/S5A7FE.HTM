<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>SQLOpen Function</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>SQLOpen Function</H1>Description</P>
Don't use <SPAN CLASS="lee">SQLOpen</SPAN> and the other ODBC functions in the Xlodbc.xla add-in; use the objects, methods, and properties in the Data Access Objects (DAO) library instead.</P>
<SPAN CLASS="lee">SQLOpen</SPAN> establishes a connection to a data source.</P>
This function is contained in the Xlodbc.xla add-in (ODBC Add-In on the Macintosh). Before you use the function, you must establish a reference to the add-in by using the <SPAN CLASS="eln">References</SPAN> command (<SPAN CLASS="eln">Tools</SPAN> menu).</P>
Syntax</P>
<SPAN CLASS="lee">SQLOpen</SPAN><SPAN CLASS="l">(</SPAN><SPAN CLASS="narg">ConnectionStr,</SPAN> <SPAN CLASS="narg">OutputRef,</SPAN> <SPAN CLASS="narg">DriverPrompt</SPAN><SPAN CLASS="l">)</SPAN></P>
<SPAN CLASS="narg">ConnectionStr</SPAN>   Required. Supplies the information required by the driver being used to connect to a data source; must follow the driver's format.</P>
<SPAN CLASS="narg">ConnectionStr</SPAN> supplies the data source name and other information — such as user ID and passwords — that the driver requires to make a connection.</P>
You must define the data source name (DSN) used in <SPAN CLASS="narg">ConnectionStr</SPAN> before you try to connect to it.</P>
<SPAN CLASS="narg">OutputRef</SPAN>   Optional. A <SPAN CLASS="lee">Range</SPAN> object (must be a single cell) that contains the completed connection string.</P>
Use <SPAN CLASS="narg">OutputRef</SPAN> when you want <SPAN CLASS="lee">SQLOpen</SPAN> to return the completed connection string to a worksheet.</P>
<SPAN CLASS="narg">DriverPrompt</SPAN>   Optional. Specifies whether the driver dialog box is displayed and, if it is, which options are available in it. Use one of the values described in the following table. If <SPAN CLASS="narg">DriverPrompt</SPAN> is omitted, <SPAN CLASS="lee">SQLOpen</SPAN> uses 2 as the default.</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"><COL WIDTH="275pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Value</P></TD><TD COLSPAN="3" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Meaning</P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">1</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The driver dialog box is always displayed.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">2</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The driver dialog box is displayed only if information provided by the connection string and the data source specification aren't sufficient to complete the connection. All dialog box options are available.</P></TD></TR></TBODY></TABLE>
<BR></P><I>(continued)</I></P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"><COL WIDTH="275pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Value</P></TD><TD COLSPAN="3" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Meaning</P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">3</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The same as 2 except that dialog box options that aren't required are dimmed (unavailable).</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">4</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The driver dialog box isn't displayed. If the connection isn't successful, SQLOpen returns an error.</P></TD></TR></TBODY></TABLE>
<BR></P>Return Value</P>
If successful, <SPAN CLASS="lee">SQLOpen</SPAN> returns a unique connection ID number. Use the connection ID number with the other ODBC functions.</P>
If <SPAN CLASS="lee">SQLOpen</SPAN> is unable to connect using the information you provide, it returns Error 2042. Additional error information is placed in memory for use by <SPAN CLASS="lee">SQLError</SPAN>.</P>
See Also</P>
<SPAN CLASS="eln">SQLBind</SPAN> function, <SPAN CLASS="eln">SQLClose</SPAN> function, <SPAN CLASS="eln">SQLError</SPAN> function, <SPAN CLASS="eln">SQLExecQuery</SPAN> function, <SPAN CLASS="eln">SQLGetSchema</SPAN> function, <SPAN CLASS="eln">SQLRequest</SPAN> function, <SPAN CLASS="eln">SQLRetrieve</SPAN> function, <SPAN CLASS="eln">SQLRetrieveToFile</SPAN> function.</P>
Example</P>
This example runs a query on the NWind sample database. The result of the query, displayed on Sheet1, is a list of all products that are currently on order.</P>

<pre><code>If Application.OperatingSystem Like "*Win*" Then
    databaseName = "NWind"
Else            'Macintosh.
    databaseName = "NorthWind"
End If
queryString = "SELECT * FROM product.dbf WHERE (product.ON_ORDER&lt;&gt;0)"
chan = SQLOpen("DSN=" &amp; databaseName)
SQLExecQuery chan, queryString
Set output = Worksheets("Sheet1").Range("A1")
SQLRetrieve chan, output, , , True
SQLClose chan</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
