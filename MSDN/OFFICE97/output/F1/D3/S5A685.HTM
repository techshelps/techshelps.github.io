<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OnTime Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>OnTime Method</H1>Applies To</P>
<SPAN CLASS="eln">Application</SPAN> object.</P>
Description</P>
Schedules a procedure to be run at a specified time in the future (either at a specific time of day or after a specific amount of time has passed).</P>
Syntax</P>
<SPAN CLASS="p">expression</SPAN><SPAN CLASS="l">.</SPAN><SPAN CLASS="lee">OnTime</SPAN><SPAN CLASS="l">(</SPAN><SPAN CLASS="narg">EarliestTime</SPAN><SPAN CLASS="l">, </SPAN><SPAN CLASS="narg">Procedure</SPAN><SPAN CLASS="l">, </SPAN><SPAN CLASS="narg">LatestTime</SPAN><SPAN CLASS="l">, </SPAN><SPAN CLASS="narg">Schedule</SPAN><SPAN CLASS="l">)</SPAN></P>
<SPAN CLASS="p">expression</SPAN>   Required. An expression that returns an <SPAN CLASS="lee">Application</SPAN> object.</P>
<SPAN CLASS="narg">EarliestTime</SPAN>   Required <SPAN CLASS="lee">Variant</SPAN>. The time when you want this procedure to be run.</P>
<SPAN CLASS="narg">Procedure</SPAN>   Required <SPAN CLASS="lee">String</SPAN>. The name of the procedure to be run.</P>
<SPAN CLASS="narg">LatestTime</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. The latest time at which the procedure can be run. For example, if <SPAN CLASS="narg">LatestTime</SPAN> is set to <SPAN CLASS="narg">EarliestTime</SPAN> + 30 and Microsoft Excel is not in Ready, Copy, Cut, or Find mode at <SPAN CLASS="narg">EarliestTime</SPAN> because another procedure is running, Microsoft Excel will wait 30 seconds for the first procedure to complete. If Microsoft Excel is not in Ready mode within 30 seconds, the procedure won't be run. If this argument is omitted, Microsoft Excel will wait until the procedure can be run.</P>
<SPAN CLASS="narg">Schedule</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. <SPAN CLASS="lee">True</SPAN> to schedule a new <SPAN CLASS="lee">OnTime</SPAN> procedure. <SPAN CLASS="lee">False</SPAN> to clear a previously set procedure. The default value is <SPAN CLASS="lee">True</SPAN>.</P>
Remarks</P>
Use <SPAN CLASS="cte">Now + TimeValue(time)</SPAN> to schedule something to be run when a specific amount of time (counting from now) has elapsed. Use <SPAN CLASS="cte">TimeValue(time)</SPAN> to schedule something to be run a specific time.</P>
Example</P>
This example runs my_Procedure 15 seconds from now.</P>

<pre><code>Application.OnTime Now + TimeValue("00:00:15"), "my_Procedure"</code></pre>
This example runs my_Procedure at 5 P.M.</P>

<pre><code>Application.OnTime TimeValue("17:00:00"), "my_Procedure"</code></pre>
This example cancels the <SPAN CLASS="lee">OnTime</SPAN> setting from the previous example.</P>

<pre><code>Application.OnTime EarliestTime:=TimeValue("17:00:00"), _
    Procedure:="my_Procedure", Schedule:=False</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
