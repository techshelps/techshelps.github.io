<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Variables Collection Object</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>Variables Collection Object</H1>Description</P>
A collection of <SPAN CLASS="lee">Variable</SPAN> objects that represent the variables added to a document or template. Document variables are used to preserve macro settings in between macro sessions.</P>
Using the Variables Collection</P>
Use the <SPAN CLASS="lee">Variables</SPAN> property to return the <SPAN CLASS="lee">Variables</SPAN> collection. The following example displays the number of variables in the document named "Sales.doc."</P>

<pre><code>MsgBox Documents("Sales.doc").Variables.Count &amp; " variables"</code></pre>
Use the <SPAN CLASS="lee">Add</SPAN> method to add a variable to a document. The following example adds a document variable named "Temp" with a value of 12 to the active document.</P>

<pre><code>ActiveDocument.Variables.Add Name:="Temp", Value:="12"</code></pre>
If you try to add a document variable with a name that already exists in the <SPAN CLASS="lee">Variables</SPAN> collection, an error occurs. To avoid this error, you can enumerate the collection before adding any new variables. If the Blue document variable already exists in the active document, the following example sets its value to 6. If this variable doesn't already exist, this example adds it to the document and sets it to 6.</P>

<pre><code>For Each aVar In ActiveDocument.Variables
    If aVar.Name = "Blue" Then num = aVar.Index
Next aVar
If num = 0 Then
    ActiveDocument.Variables.Add Name:="Blue", Value:=6
Else
    ActiveDocument.Variables(num).Value = 6
End If</code></pre>
Use <SPAN CLASS="lee">Variables</SPAN>(<SPAN CLASS="p">index</SPAN>), where <SPAN CLASS="p">index</SPAN> is the document variable name or the index number, to return a single <SPAN CLASS="lee">Variable</SPAN> object. The following example displays the value of the Temp document variable in the active document.</P>

<pre><code>MsgBox ActiveDocument.Variables("Temp").Value</code></pre>
The index number represents the position of the document variable in the <SPAN CLASS="lee">Variables</SPAN> collection. The last variable added to the <SPAN CLASS="lee">Variables</SPAN> collection is index number 1; the second-to-last variable added to the collection is index number 2, and so on. The following example displays the name of the first document variable in the active document.</P>

<pre><code>MsgBox ActiveDocument.Variables(1).Name</code></pre>
To add a variable to a template, open the template as a document by using the <SPAN CLASS="lee">OpenAsDocument</SPAN> method. The following example stores the user name (from the <SPAN CLASS="eln">Options</SPAN> dialog box) in the template attached to the active document.</P>

<pre><code>ScreenUpdating = False
With ActiveDocument.AttachedTemplate.OpenAsDocument
    .Variables.Add Name:="UserName", Value:= Application.UserName
    .Close SaveChanges:=wdSaveChanges
End With</code></pre>
Properties</P>
<SPAN CLASS="eln">Application</SPAN> property, <SPAN CLASS="eln">Count</SPAN> property, <SPAN CLASS="eln">Creator</SPAN> property, <SPAN CLASS="eln">Parent</SPAN> property.</P>
Methods</P>
<SPAN CLASS="eln">Add</SPAN> method (<SPAN CLASS="eln">Variables</SPAN> collection), <SPAN CLASS="eln">Item</SPAN> method.</P>
<HR CLASS="rr"></FONT></BODY>
</HTML>
