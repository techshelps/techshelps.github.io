<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OnTime Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>OnTime Method</H1>Applies To</P>
<SPAN CLASS="eln">Application</SPAN> object.</P>
Description</P>
Starts a background timer that runs a macro on the specified date and at the specified time.</P>
Syntax</P>
<SPAN CLASS="p">expression</SPAN><SPAN CLASS="l">.</SPAN><SPAN CLASS="lee">OnTime</SPAN><SPAN CLASS="l">(</SPAN><SPAN CLASS="narg">When</SPAN><SPAN CLASS="l">, </SPAN><SPAN CLASS="narg">Name</SPAN><SPAN CLASS="l">, </SPAN><SPAN CLASS="narg">Tolerance</SPAN><SPAN CLASS="l">)</SPAN></P>
<SPAN CLASS="p">expression</SPAN>   Required. An expression that returns an <SPAN CLASS="lee">Application</SPAN> object.</P>
<SPAN CLASS="narg">When</SPAN>   Required <SPAN CLASS="lee">Variant</SPAN>. The time at which the macro is to be run. Can be a string that specifies a time (for example, <SPAN CLASS="cte">"4:30 pm"</SPAN> or <SPAN CLASS="cte">"16:30"</SPAN>), or it can be a serial number returned by a function such as <SPAN CLASS="lee">TimeValue</SPAN> or <SPAN CLASS="lee">TimeSerial</SPAN> (for example, <SPAN CLASS="cte">TimeValue("2:30 pm")</SPAN> or <SPAN CLASS="cte">TimeSerial(14, 30, 00)</SPAN>). You can also include the date (for example, <SPAN CLASS="cte">"6/30 4:15 pm"</SPAN> or <SPAN CLASS="cte">TimeValue("6/30 4:15&nbsp;pm")</SPAN>).</P>
Use the sum of the return values of the <SPAN CLASS="lee">Now</SPAN> function and either the <SPAN CLASS="lee">TimeValue</SPAN> or <SPAN CLASS="lee">TimeSerial</SPAN> function to set a timer to run a macro a specified amount of time after the statement is run. For example, use <SPAN CLASS="cte">Now+TimeValue("00:05:30")</SPAN> to run a macro 5 minutes and 30 seconds after the statement is run.</P>
<SPAN CLASS="narg">Name</SPAN>   Required <SPAN CLASS="lee">String</SPAN>. The name of the macro to be run. Use the complete macro path to ensure that the correct macro is run (for example, <SPAN CLASS="cte">"Project.Module1.Macro1"</SPAN>). For the macro to run, the document or template must be available both when the <SPAN CLASS="lee">OnTime</SPAN> instruction is run and when the time specified by <SPAN CLASS="narg">When</SPAN> arrives. For this reason, it's best to store the macro in Normal.dot or another global template that's loaded automatically.</P>
<SPAN CLASS="narg">Tolerance</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. The maximum time (in seconds) that can elapse before a macro that wasn't run at the time specified by <SPAN CLASS="narg">When</SPAN> is canceled. Macros may not always run at the specified time. For example, if a sort operation is under way or a dialog box is being displayed, the macro will be delayed until Word has completed the task. If this argument is 0 (zero) or omitted, the macro is run regardless of how much time has elapsed since the time specified by <SPAN CLASS="narg">When</SPAN>.</P>
Remarks</P>
Word can maintain only one background timer set by <SPAN CLASS="lee">OnTime</SPAN>. If you start another timer before an existing timer runs, the existing timer is canceled.</P>
Example</P>
This example runs the macro named "MyMacro" in the current module at 3:55 P.M.</P>

<pre><code>Application.OnTime When:="15:55:00", Name:="MyMacro"</code></pre>
This example runs the macro named "Macro1" 15 seconds from the time the example is run. The macro name includes the project and module name.</P>

<pre><code>Application.OnTime When:=Now + TimeValue("00:00:15"), Name:="Project1.Module1.Macro1"</code></pre>
This example runs the macro named "Start" at 1:30 P.M. The macro name includes the project and module name.</P>

<pre><code>Application.OnTime When:=TimeValue(<SPAN CLASS="cte">"1:30 pm"</SPAN>), Name:="VBAProj.MyModule.Start"</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
