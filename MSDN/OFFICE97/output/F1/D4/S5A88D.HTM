<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Add Method (Variables Collection)</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>Add Method (Variables Collection)</H1>Applies To</P>
<SPAN CLASS="eln">Variables</SPAN> collection object.</P>
Description</P>
Adds a variable to a document.</P>
Syntax</P>
<SPAN CLASS="p">expression</SPAN><SPAN CLASS="l">.</SPAN><SPAN CLASS="lee">Add</SPAN><SPAN CLASS="l">(</SPAN><SPAN CLASS="narg">Name</SPAN><SPAN CLASS="l">, </SPAN><SPAN CLASS="narg">Value</SPAN><SPAN CLASS="l">)</SPAN></P>
<SPAN CLASS="p">expression</SPAN>   Required. An expression that returns a <SPAN CLASS="lee">Variables</SPAN> object.</P>
<SPAN CLASS="narg">Name</SPAN>   Required <SPAN CLASS="lee">String</SPAN>. The name of the document variable.</P>
<SPAN CLASS="narg">Value</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. The value for the document variable.</P>
Remarks</P>
Document variables are invisible to the user unless a DOCVARIABLE field is inserted with the appropriate variable name. If you try to add a variable with a name that already exists in the <SPAN CLASS="lee">Variables</SPAN> collection, an error occurs. To avoid this error, you can enumerate the collection before adding a new variable to it.</P>
See Also</P>
<SPAN CLASS="eln">Variables</SPAN> collection object.</P>
Example</P>
This example adds a variable named "<SPAN CLASS="cte">Temp"</SPAN> to the active document and then inserts a DOCVARIABLE field to display the value in the <SPAN CLASS="cte">Temp</SPAN> variable.</P>

<pre><code>With ActiveDocument
    .Variables.Add Name:="Temp", Value:="12"
    .Fields.Add Range:=Selection.Range, Type:=wdFieldDocVariable, Text:="Temp"
End With
ActiveWindow.View.ShowFieldCodes = False</code></pre>
This example sets the value of the <SPAN CLASS="cte">Blue</SPAN> variable to 6. If this variable doesn't already exist, the example adds it to the document and sets it to 6.</P>

<pre><code>For Each aVar In ActiveDocument.Variables
    If aVar.Name = "Blue" Then num = aVar.Index
Next aVar
If num = 0 Then
    ActiveDocument.Variables.Add Name:="Blue", Value:=6
Else
    ActiveDocument.Variables(num).Value = 6
End If</code></pre>
This example stores the user name (from the <SPAN CLASS="eln">Options</SPAN> dialog box) in the template attached to the active document.</P>

<pre><code>ScreenUpdating = False
With ActiveDocument.AttachedTemplate.OpenAsDocument
    .Variables.Add Name:="UserName", Value:= Application.UserName
    .Close SaveChanges:=wdSaveChanges
End With</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
