<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CancelUpdate Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>CancelUpdate Method</H2>Applies To</P>
Dynamic-Type <SPAN CLASS="eln">Recordset</SPAN> object, Dynaset-Type <SPAN CLASS="eln">Recordset</SPAN> object, Forward-Only–Type <SPAN CLASS="eln">Recordset</SPAN> object, <SPAN CLASS="eln">Recordset</SPAN> object, Snapshot-Type <SPAN CLASS="eln">Recordset</SPAN> object, Table-Type <SPAN CLASS="eln">Recordset</SPAN> object.</P>
Description</P>
Cancels any pending updates for a Recordset object.</P>
Syntax</P>
<SPAN CLASS="p">recordset</SPAN><SPAN CLASS="eln">.CancelUpdate</SPAN><SPAN CLASS="eln"> </SPAN><SPAN CLASS="eln">type</SPAN></P>
The <SPAN CLASS="eln">AppendChunk</SPAN> method syntax has these parts.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="264pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">recordset</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">An <SPAN CLASS="pop">object variable</SPAN> that represents the <SPAN CLASS="eln">Recordset</SPAN> object for which you are canceling pending updates.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">type</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. A constant indicating the type of update, as specified in Settings (<SPAN CLASS="pop">ODBCDirect workspaces</SPAN> only). </P></TD></TR></TBODY></TABLE>
<BR></P>Settings</P>
You can use the following values for the <SPAN CLASS="p">type</SPAN> argument only if batch updating is enabled.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="263pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"> </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><B>dbUpdateRegular</B></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Default. Cancels pending changes that aren't cached.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><B>dbUpdateBatch</B></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Cancels pending changes in the update cache.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
You can use the <SPAN CLASS="eln">CancelUpdate</SPAN> method to cancel any pending updates resulting from an Edit or AddNew operation. For example, if a user invokes the <SPAN CLASS="eln">Edit</SPAN> or <SPAN CLASS="eln">AddNew</SPAN> method and hasn't yet invoked the <SPAN CLASS="eln">Update</SPAN> method, <SPAN CLASS="eln">CancelUpdate</SPAN> cancels any changes made after <SPAN CLASS="eln">Edit</SPAN> or <SPAN CLASS="eln">AddNew</SPAN> was invoked.</P>
Check the EditMode property of the <B>Recordset</B> to determine if there is a pending operation that can be canceled.</P>
<SPAN CLASS="nh">Note</SPAN>   Using the <SPAN CLASS="eln">CancelUpdate</SPAN> method has the same effect as moving to another record without using the Update method, except that the <SPAN CLASS="pop">current record</SPAN> doesn't change, and various properties, such as <SPAN CLASS="eln">BOF</SPAN> and <SPAN CLASS="eln">EOF</SPAN>, aren't updated.</P>
See Also</P>
<SPAN CLASS="eln">AddNew</SPAN> method, <SPAN CLASS="eln">BOF</SPAN>, <SPAN CLASS="eln">EOF</SPAN> properties, <SPAN CLASS="eln">EditMode</SPAN> property, <SPAN CLASS="eln">Update</SPAN> method.</P>
Example</P>
This example shows how the <SPAN CLASS="eln">CancelUpdate</SPAN> method is used with the <SPAN CLASS="eln">AddNew</SPAN> method.</P>

<pre><code>Sub CancelUpdateX()

    Dim dbsNorthwind As Database
    Dim rstEmployees As Recordset
    Dim intCommand As Integer

    Set dbsNorthwind = OpenDatabase("Northwind.mdb")
    Set rstEmployees = dbsNorthwind.OpenRecordset( _
        "Employees", dbOpenDynaset)

    With rstEmployees
        .AddNew
        !FirstName = "Kimberly"
        !LastName = "Bowen"
        intCommand = MsgBox("Add new record for " &amp; _
            !FirstName &amp; " " &amp; !LastName &amp; "?", vbYesNo)
        If intCommand = vbYes Then
            .Update
            MsgBox "Record added."
            ' Delete new record because this is a
            ' demonstration.
            .Bookmark = .LastModified
            .Delete
        Else
            .CancelUpdate
            MsgBox "Record not added."
        End If
    End With

    dbsNorthwind.Close

End Sub</code></pre>
This example shows how the <SPAN CLASS="eln">CancelUpdate</SPAN> method is used with the <SPAN CLASS="eln">Edit</SPAN> method.</P>

<pre><code>Sub CancelUpdateX2()

    Dim dbsNorthwind As Database
    Dim rstEmployees As Recordset
    Dim strFirst As String
    Dim strLast As String
    Dim intCommand As Integer

    Set dbsNorthwind = OpenDatabase("Northwind.mdb")
    Set rstEmployees = dbsNorthwind.OpenRecordset( _
        "Employees", dbOpenDynaset)

    With rstEmployees
        strFirst = !FirstName
        strLast = !LastName
        .Edit
        !FirstName = "Cora"
        !LastName = "Edmonds"
        intCommand = MsgBox("Replace current name with " &amp; _
            !FirstName &amp; " " &amp; !LastName &amp; "?", vbYesNo)
        If intCommand = vbYes Then
            .Update
            MsgBox "Record modified."
            ' Restore data because this is a demonstration.
            .Bookmark = .LastModified
            .Edit
            !FirstName = strFirst
            !LastName = strLast
            .Update
        Else
            .CancelUpdate
            MsgBox "Record not modified."
        End If
        .Close
    End With

    dbsNorthwind.Close

End Sub</code></pre>
Example (Microsoft Access)</P>
The following example creates a new record in an Employees table, enters values, and prompts the user to save the changes. If the user chooses not to save the changes, the <SPAN CLASS="eln">Update</SPAN> method is canceled.</P>

<pre><code>Sub NewRecord()
    Dim dbs As Database, rst As Recordset

    ' Return reference to current database.
    Set dbs = CurrentDb
    Set rst = dbs.OpenRecordset("Employees")
    With rst
        ' Add new record to end of Recordset object.
        .AddNew
        ' Add data.
        !LastName = "Christopher"
        !FirstName = "Kevin"
    End With
    ' Prompt user to save changes.
    If MsgBox("Save these changes?", vbYesNo) = vbNo Then
        ' If user chooses No, cancel changes.
        rst.CancelUpdate
    Else
        ' If user chooses Yes, save changes.
        rst.Update
    End If
    rst.Close
    Set dbs = Nothing
End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
