<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DVar, DVarP Functions</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>DVar, DVarP Functions</H2>Description</P>
You can use the <SPAN CLASS="eln">DVar</SPAN> and <SPAN CLASS="eln">DVarP</SPAN> functions to estimate variance across a set of values in a specified set of records (a <SPAN CLASS="pop">domain</SPAN>). Use the <SPAN CLASS="eln">DVar</SPAN> and <SPAN CLASS="eln">DVarP</SPAN> functions in Visual Basic, a <SPAN CLASS="pop">macro</SPAN>, a query expression, or a <SPAN CLASS="pop">calculated control</SPAN> on a form or report.</P>
Use the <SPAN CLASS="eln">DVarP</SPAN> function to evaluate variance across a population, and the <SPAN CLASS="eln">DVar</SPAN> function to evaluate variance across a population sample.</P>
For example, you could use the <SPAN CLASS="eln">DVar</SPAN> function to calculate the variance across a set of students' test scores.</P>
Syntax</P>
<SPAN CLASS="l">DVar(</SPAN><SPAN CLASS="p">expr</SPAN><SPAN CLASS="l">, </SPAN><SPAN CLASS="p">domain</SPAN>[<SPAN CLASS="l">, </SPAN><SPAN CLASS="p">criteria</SPAN>]<SPAN CLASS="l">)</SPAN></P>
<SPAN CLASS="l">DVarP(</SPAN><SPAN CLASS="p">expr</SPAN><SPAN CLASS="l">, </SPAN><SPAN CLASS="p">domain</SPAN>[<SPAN CLASS="l">, </SPAN><SPAN CLASS="p">criteria</SPAN>]<SPAN CLASS="l">)</SPAN></P>
The <SPAN CLASS="eln">DVar</SPAN> and <SPAN CLASS="eln">DVarP</SPAN> functions have the following arguments.</P>

<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="269pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">expr</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">An expression that identifies the numeric field on which you want to find the variance. It can be a <SPAN CLASS="pop">string expression</SPAN> identifying a field from a table or query, or it can be an expression that performs a <SPAN CLASS="jump">calculation on data in that field</SPAN>. In <SPAN CLASS="p">expr</SPAN>, you can include the name field in a table, a control on a form, a constant, or a function. If <SPAN CLASS="p">expr</SPAN>  includes a function, it can be either built-in or user-defined, but not another domain aggregate or <SPAN CLASS="jump">SQL aggregate</SPAN> function. Any field included in <SPAN CLASS="p">expr</SPAN>  must be a numeric field.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">domain</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A string expression identifying the set of records that constitutes the domain. It can be a table name or a query name.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">criteria</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">An optional string expression used to restrict the range of data on which the <SPAN CLASS="eln">DVar</SPAN> or <SPAN CLASS="eln">DVarP</SPAN> function is performed. For example, <SPAN CLASS="p">criteria</SPAN> is often equivalent to the WHERE clause in an SQL expression, without the word WHERE. If <SPAN CLASS="p">criteria</SPAN> is omitted, the <SPAN CLASS="eln">DVar</SPAN> and <SPAN CLASS="eln">DVarP</SPAN> functions evaluate <SPAN CLASS="p">expr</SPAN>  against the entire domain. Any field that is included in <SPAN CLASS="p">criteria</SPAN> must also be a field in <SPAN CLASS="p">domain</SPAN>; otherwise the <SPAN CLASS="eln">DVar</SPAN> and <SPAN CLASS="eln">DVarP</SPAN> functions return a Null.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
If <SPAN CLASS="p">domain</SPAN> refers to fewer than two records or if fewer than two records satisfy <SPAN CLASS="p">criteria</SPAN>, the <SPAN CLASS="eln">DVar</SPAN> and <SPAN CLASS="eln">DVarP</SPAN> functions return a <SPAN CLASS="eln">Null</SPAN>, indicating that a variance can't be calculated.</P>
Whether you use the <SPAN CLASS="eln">DVar</SPAN> or <SPAN CLASS="eln">DVarP</SPAN> function in a macro, module, query expression, or calculated control, you must construct the <SPAN CLASS="p">criteria</SPAN> argument carefully to ensure that it will be evaluated correctly.</P>
You can use the <SPAN CLASS="eln">DVar</SPAN> and <SPAN CLASS="eln">DVarP</SPAN> function to specify criteria in the <SPAN CLASS="eln">Criteria</SPAN> row of a select query, in a calculated field expression in a query, or in the <SPAN CLASS="eln">Update To</SPAN> row of an update query.</P>
<SPAN CLASS="nh">Note</SPAN>   You can use the <SPAN CLASS="eln">DVar</SPAN> and <SPAN CLASS="eln">DVarP</SPAN> functions or the Var<SPAN CLASS="jump"> and </SPAN>VarP functions in a calculated field expression in a <SPAN CLASS="pop">totals query</SPAN>. If you use the <SPAN CLASS="eln">DVar</SPAN> or <SPAN CLASS="eln">DVarP</SPAN> function, values are calculated before data is grouped. If you use the <SPAN CLASS="eln">Var</SPAN> or <SPAN CLASS="eln">VarP</SPAN> function, the data is grouped before values in the field expression are evaluated.</P>
Use the <SPAN CLASS="eln">DVar</SPAN> and <SPAN CLASS="eln">DVarP</SPAN> functions in a calculated control when you need to specify <SPAN CLASS="p">criteria</SPAN> to restrict the range of data on which the function is performed. For example, to display a variance for orders to be shipped to California, set the ControlSource property of a text box to the following expression:</P>

<pre><code>=DVar("[Freight]", "Orders", "[ShipRegion] = 'CA'")</code></pre>
If you simply want to find the standard deviation across all records in <SPAN CLASS="p">domain</SPAN>, use the <SPAN CLASS="eln">Var</SPAN> or <SPAN CLASS="eln">VarP</SPAN> function.</P>
<SPAN CLASS="nh">Note</SPAN>   Unsaved changes to records in <SPAN CLASS="p">domain</SPAN> are not included when you use these functions. If you want the <SPAN CLASS="eln">DVar</SPAN> or <SPAN CLASS="eln">DVarP</SPAN> function to be based on the changed values, you must first save the changes by clicking <SPAN CLASS="eln">Save Record</SPAN> on the <SPAN CLASS="eln">File</SPAN> menu, moving the focus to another record, or by using the Update method.</P>
Example</P>
The following example returns estimates of the variance for a population and a population sample for orders shipped to the United Kingdom. The domain is an Orders table. The <SPAN CLASS="p">criteria</SPAN> argument restricts the resulting set of records to those for which ShipCountry equals UK.</P>

<pre><code>Dim dblX As Double, dblY As Double
' Sample estimate.
dblX = DVar("[Freight]", "Orders", "[ShipCountry] = 'UK'")
' Population estimate.
dblY = DVarP("[Freight]", "Orders", "[ShipCountry] = 'UK'")</code></pre>
The next example returns estimates by using a variable, <SPAN CLASS="cte">strCountry</SPAN>, in the <SPAN CLASS="p">criteria</SPAN> argument. Note that single quotation marks (<SPAN CLASS="cte">'</SPAN>) are included in the string expression, so that when the strings are concatenated, the string literal <SPAN CLASS="cte">UK</SPAN> will be enclosed in single quotation marks.</P>

<pre><code>Dim strCountry As String, dblX As Double
strCountry = "UK"
dblX = DVar("[Freight]", "Orders", "[ShipCountry] = '" _
    &amp; strCountry &amp; "'")</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
