<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OpenConnection Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>OpenConnection Method</H1>Applies To</P>
<SPAN CLASS="eln">DBEngine</SPAN> object, <SPAN CLASS="eln">Workspace</SPAN> object.</P>
Description</P>
Opens a <SPAN CLASS="lee">Connection</SPAN> object on an <SPAN CLASS="pop">ODBC data source</SPAN> (<SPAN CLASS="pop">ODBCDirect workspaces</SPAN> only).</P>
Syntax</P>
<SPAN CLASS="lee">Set</SPAN> <SPAN CLASS="p">connection</SPAN><SPAN CLASS="l"> = </SPAN><SPAN CLASS="p">workspace</SPAN><SPAN CLASS="l">.</SPAN><SPAN CLASS="lee">OpenConnection(</SPAN><SPAN CLASS="p">name</SPAN><SPAN CLASS="l">,</SPAN> <SPAN CLASS="p">options</SPAN><SPAN CLASS="l">,</SPAN> <SPAN CLASS="p">readonly</SPAN><SPAN CLASS="l">,</SPAN> <SPAN CLASS="p">connect</SPAN><SPAN CLASS="lee">)</SPAN></P>
The <SPAN CLASS="lee">OpenConnection</SPAN> method syntax has these parts.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="66pt" VALIGN="TOP"><COL WIDTH="294pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">connection</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A <SPAN CLASS="lee">Connection</SPAN> <SPAN CLASS="pop">object variable to which the new connection will be assigned.</SPAN></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">workspace</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><P>Optional. A variable of a <SPAN CLASS="lee">Workspace</SPAN> object data type that references the existing <SPAN CLASS="lee">Workspace</SPAN> object that will contain the new connection.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">name</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A <SPAN CLASS="pop">string expression</SPAN>. See the discussion under Remarks.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">options</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. A <SPAN CLASS="lee">Variant</SPAN> that sets various options for the connection, as specified in Settings. Based on this value, the <SPAN CLASS="pop">ODBC driver manager</SPAN> prompts the user for connection information such as data source name (DSN), user name, and password. </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">readonly</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. A <SPAN CLASS="lee">Boolean</SPAN> value that is <SPAN CLASS="lee">True</SPAN> if the connection is to be opened for read-only access and <SPAN CLASS="lee">False</SPAN> if the connection is to be opened for read/write access (default).</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">connect</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. An ODBC connect string. See the <SPAN CLASS="lee">Connect</SPAN> property for the specific elements and syntax of this string. A prepended "ODBC;" is required. If <SPAN CLASS="p">connect</SPAN> is omitted, the UID and/or PWD will be taken from the <SPAN CLASS="lee">UserName</SPAN> and <SPAN CLASS="lee">Password</SPAN> properties of the <SPAN CLASS="lee">Workspace</SPAN>.</P></TD></TR></TBODY></TABLE>
<BR></P>Settings</P>
The <SPAN CLASS="p">options</SPAN> argument determines if and when to prompt the user to establish the connection, and whether or not to open the connection asynchronously. You can use one of the following constants.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="141pt" VALIGN="TOP"><COL WIDTH="218pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">  </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbDriverNoPrompt</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The <SPAN CLASS="pop">ODBC Driver Manager</SPAN> uses the <SPAN CLASS="pop">connection string</SPAN> provided in <SPAN CLASS="p">dbname</SPAN> and <SPAN CLASS="p">connect</SPAN>. If you don't provide sufficient information, a run-time error occurs.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbDriverPrompt</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The ODBC Driver Manager displays the <SPAN CLASS="lee">ODBC Data Sources</SPAN> dialog box, which displays any relevant information supplied in <SPAN CLASS="p">dbname</SPAN><I> </I>or <SPAN CLASS="p">connect</SPAN>. The connection string is made up of the DSN that the user selects via the dialog boxes, or, if the user doesn't specify a DSN, the default DSN is used.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbDriverComplete</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Default. If the <I>connect</I> argument includes all the necessary information to complete a connection, the ODBC Driver Manager uses the string in <I>connect</I>. Otherwise it behaves as it does when you specify <SPAN CLASS="lee">dbDriverPrompt</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbDriverCompleteRequired</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">This option behaves like <SPAN CLASS="lee">dbDriverComplete</SPAN> except the <SPAN CLASS="pop">ODBC driver</SPAN> disables the prompts for any information not required to complete the connection.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbRunAsync</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Execute the method asynchronously. This constant may be used with any of the other <I>options</I> constants.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
Use the <SPAN CLASS="lee">OpenConnection</SPAN> method to establish a connection to an ODBC data source from an ODBCDirect workspace. The <SPAN CLASS="lee">OpenConnection</SPAN> method is similar but not equivalent to <SPAN CLASS="lee">OpenDatabase</SPAN>. The main difference is that <SPAN CLASS="lee">OpenConnection</SPAN> is available only in an ODBCDirect workspace.</P>
If you specify a registered ODBC data source name (DSN) in the <SPAN CLASS="p">connect</SPAN> argument, then the <SPAN CLASS="p">name</SPAN> argument can be any valid string, and will also provide the <SPAN CLASS="lee">Name</SPAN> property for the <SPAN CLASS="lee">Connection</SPAN> object. If a valid DSN is not included in the <SPAN CLASS="p">connect</SPAN> argument, then <SPAN CLASS="p">name</SPAN> must refer to a valid ODBC DSN, which will also be the <SPAN CLASS="lee">Name</SPAN> property. If neither <SPAN CLASS="p">name</SPAN> nor <SPAN CLASS="p">connect</SPAN> contains a valid DSN, the ODBC driver manager can be set (via the <SPAN CLASS="p">options</SPAN> argument) to prompt the user for the required connection information. The DSN supplied through the prompt then provides the <SPAN CLASS="lee">Name</SPAN> property.</P>
<SPAN CLASS="lee">OpenConnection</SPAN> returns a <SPAN CLASS="lee">Connection</SPAN> object which contains information about the connection. The <SPAN CLASS="lee">Connection</SPAN> object is similar to a <SPAN CLASS="lee">Database</SPAN> object. The principal difference is that a <SPAN CLASS="lee">Database</SPAN> object usually represents a database, although it can be used to represent a connection to an ODBC data source from a <SPAN CLASS="pop">Microsoft Jet workspace</SPAN>.</P>
See Also</P>
<SPAN CLASS="eln">Cancel</SPAN> method, <SPAN CLASS="eln">Connection</SPAN> object, <SPAN CLASS="eln">StillExecuting</SPAN> property.</P>
Example</P>
This example uses the <SPAN CLASS="eln">OpenConnection</SPAN> method with different parameters to open three different <SPAN CLASS="eln">Connection</SPAN> objects.</P>

<pre><code>Sub OpenConnectionX()

    Dim wrkODBC As Workspace
    Dim conPubs As Connection
    Dim conPubs2 As Connection
    Dim conPubs3 As Connection
    Dim conLoop As Connection

    ' Create ODBCDirect Workspace object.
    Set wrkODBC = CreateWorkspace("NewODBCWorkspace", _
        "admin", "", dbUseODBC)

    ' Open Connection object using supplied information in
    ' the connect string. If this information were
    ' insufficient, you could trap for an error rather than
    ' go to an ODBC Driver Manager dialog box.
    MsgBox "Opening Connection1..."
    Set conPubs = wrkODBC.OpenConnection("Connection1", _
        dbDriverNoPrompt, , _
        "ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers")

    ' Open read-only Connection object based on information
    ' you enter in the ODBC Driver Manager dialog box.
    MsgBox "Opening Connection2..."
    Set conPubs2 = wrkODBC.OpenConnection("Connection2", _
        dbDriverPrompt, True, "ODBC;DSN=Publishers;")

    ' Open read-only Connection object by entering only the
    ' missing information in the ODBC Driver Manager dialog
    ' box.
    MsgBox "Opening Connection3..."
    Set conPubs3 = wrkODBC.OpenConnection("Connection3", _
        dbDriverCompleteRequired, True, _
        "ODBC;DATABASE=pubs;DSN=Publishers;")

    ' Enumerate the Connections collection.
    For Each conLoop In wrkODBC.Connections
        Debug.Print "Connection properties for " &amp; _
            conLoop.Name &amp; ":"

        With conLoop
            ' Print property values by explicitly calling each
            ' Property object; the Connection object does not
            ' support a Properties collection.
            Debug.Print "    Connect = " &amp; .Connect
            ' Property actually returns a Database object.
            Debug.Print "    Database[.Name] = " &amp; _
                .Database.Name
            Debug.Print "    Name = " &amp; .Name
            Debug.Print "    QueryTimeout = " &amp; .QueryTimeout
            Debug.Print "    RecordsAffected = " &amp; _
                .RecordsAffected
            Debug.Print "    StillExecuting = " &amp; _
                .StillExecuting
            Debug.Print "    Transactions = " &amp; .Transactions
            Debug.Print "    Updatable = " &amp; .Updatable
        End With

    Next conLoop

    conPubs.Close
    conPubs2.Close
    conPubs3.Close
    wrkODBC.Close

End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
