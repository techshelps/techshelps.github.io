<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OpenRecordset Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>OpenRecordset Method</H1>Applies To</P>
<SPAN CLASS="eln">Connection</SPAN> object, <SPAN CLASS="eln">Database</SPAN> object, Dynaset-Type <SPAN CLASS="eln">Recordset</SPAN> object, <SPAN CLASS="eln">QueryDef</SPAN> object, <SPAN CLASS="eln">Recordset</SPAN> object, Snapshot-Type <SPAN CLASS="eln">Recordset</SPAN> object, Table-Type <SPAN CLASS="eln">Recordset</SPAN> object, <SPAN CLASS="eln">TableDef</SPAN> object.</P>
Description</P>
Creates a new <SPAN CLASS="eln">Recordset</SPAN> object and appends it to the <SPAN CLASS="eln">Recordsets</SPAN> collection.</P>
Syntax</P>
For Connection and Database objects:</P>
<SPAN CLASS="eln">Set</SPAN> <SPAN CLASS="p">recordset</SPAN><SPAN CLASS="l"> = </SPAN><SPAN CLASS="p">object</SPAN><SPAN CLASS="eln">.OpenRecordset(</SPAN><SPAN CLASS="p">source</SPAN><B>,</B> <SPAN CLASS="p">type</SPAN><B>,</B> <SPAN CLASS="p">options</SPAN><SPAN CLASS="p">,</SPAN><SPAN CLASS="p"> lockedits</SPAN><B>)</B></P>
For QueryDef, Recordset, and TableDef objects:</P>
<SPAN CLASS="eln">Set</SPAN> <SPAN CLASS="p">recordset</SPAN><SPAN CLASS="l"> = </SPAN><SPAN CLASS="p">object</SPAN><SPAN CLASS="eln">.OpenRecordset</SPAN><B>(</B><SPAN CLASS="p">type</SPAN><B>,</B> <SPAN CLASS="p">options</SPAN><SPAN CLASS="p">,</SPAN><SPAN CLASS="p"> lockedits</SPAN><SPAN CLASS="p">)</SPAN></P>
The <SPAN CLASS="eln">OpenRecordset</SPAN> method syntax has these parts.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="61pt" VALIGN="TOP"><COL WIDTH="299pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">recordset</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">An <SPAN CLASS="pop">object variable</SPAN> that represents the <SPAN CLASS="eln">Recordset</SPAN> object you want to open.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">object</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">An object variable that represents an existing object from which you want to create the new <SPAN CLASS="eln">Recordset</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">source</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A <SPAN CLASS="eln">String</SPAN> specifying the source of the records for the new <SPAN CLASS="eln">Recordset</SPAN>. The source can be a table name, a query name, or an <SPAN CLASS="pop">SQL statement</SPAN> that returns records. For table-type <SPAN CLASS="eln">Recordset</SPAN> objects in <SPAN CLASS="pop">Microsoft Jet databases</SPAN>, the source can only be a table name.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">type</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. A constant that indicates the type of <SPAN CLASS="eln">Recordset </SPAN>to open, as specified in Settings. </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">options</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. A combination of constants that specify characteristics of the new <SPAN CLASS="eln">Recordset</SPAN>, as listed in Settings.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">lockedits</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. A constant that determines the locking for the <SPAN CLASS="eln">Recordset</SPAN>, as specified in Settings. </P></TD></TR></TBODY></TABLE>
<BR></P>Settings</P>
You can use one of the following constants for the <SPAN CLASS="p">type</SPAN> argument.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="106pt" VALIGN="TOP"><COL WIDTH="253pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"> </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbOpenTable</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Opens a table-type <SPAN CLASS="eln">Recordset</SPAN> object (<SPAN CLASS="pop">Microsoft Jet workspaces</SPAN> only).</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbOpenDynamic</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Opens a dynamic-type <SPAN CLASS="eln">Recordset</SPAN> object, which is similar to an <SPAN CLASS="pop">ODBC</SPAN> <SPAN CLASS="pop">dynamic cursor</SPAN> (<SPAN CLASS="pop">ODBCDirect workspaces</SPAN> only).</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbOpenDynaset</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Opens a dynaset-type <SPAN CLASS="eln">Recordset</SPAN> object, which is similar to an ODBC <SPAN CLASS="pop">keyset cursor</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbOpenSnapshot</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Opens a snapshot-type <SPAN CLASS="eln">Recordset</SPAN> object, which is similar to an ODBC <SPAN CLASS="pop">static cursor</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbOpenForwardOnly</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Opens a forward-only-type <SPAN CLASS="eln">Recordset</SPAN> object. </P></TD></TR></TBODY></TABLE>
<BR></P><SPAN CLASS="nh">Note</SPAN>&nbsp;&nbsp;&nbsp;If you open a <SPAN CLASS="eln">Recordset</SPAN> in a Microsoft Jet workspace and you don't specify a type, <SPAN CLASS="eln">OpenRecordset</SPAN> creates a table-type <SPAN CLASS="eln">Recordset</SPAN>, if possible. If you specify a <SPAN CLASS="pop">linked table</SPAN> or query, <SPAN CLASS="eln">OpenRecordset</SPAN> creates a dynaset-type <SPAN CLASS="eln">Recordset</SPAN>. In an ODBCDirect workspace, the default setting is <SPAN CLASS="eln">dbOpenForwardOnly</SPAN>.</P>
You can use a combination of the following constants for the <SPAN CLASS="p">options</SPAN> argument.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="106pt" VALIGN="TOP"><COL WIDTH="254pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbAppendOnly</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Allows users to append new records to the <SPAN CLASS="eln">Recordset</SPAN>, but prevents them from editing or deleting existing records (Microsoft Jet dynaset-type <SPAN CLASS="eln">Recordset</SPAN> only).</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbSQLPassThrough</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Passes an <SPAN CLASS="pop">SQL statement</SPAN> to a Microsoft Jet-connected ODBC data source for processing (Microsoft Jet snapshot-type <SPAN CLASS="eln">Recordset</SPAN> only).</P></TD></TR></TBODY></TABLE>
<BR></P><I>(continued)</I></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="106pt" VALIGN="TOP"><COL WIDTH="254pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbSeeChanges</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Generates a <SPAN CLASS="pop">run-time error</SPAN> if one user is changing data that another user is editing (Microsoft Jet dynaset-type <SPAN CLASS="eln">Recordset</SPAN> only). This is useful in applications where multiple users have simultaneous read/write access to the same data. </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbDenyWrite</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Prevents other users from modifying or adding records (Microsoft Jet <SPAN CLASS="eln">Recordset</SPAN> objects only).</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbDenyRead</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Prevents other users from reading data in a table (Microsoft Jet table-type <SPAN CLASS="eln">Recordset</SPAN> only).</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbForwardOnly</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Creates a forward-only <SPAN CLASS="eln">Recordset</SPAN> (Microsoft Jet snapshot-type <SPAN CLASS="eln">Recordset </SPAN>only). It is provided only for backward compatibility, and you should use the <SPAN CLASS="eln">dbOpenForwardOnly</SPAN> constant in the <SPAN CLASS="p">type</SPAN> argument instead of using this option. </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbReadOnly</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Prevents users from making changes to the <SPAN CLASS="eln">Recordset </SPAN>(Microsoft Jet only). The <SPAN CLASS="eln">dbReadOnly</SPAN> constant in the <SPAN CLASS="p">lockedits</SPAN> argument replaces this option, which is provided only for backward compatibility.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbRunAsync</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Runs an <SPAN CLASS="pop">asynchronous query</SPAN> (ODBCDirect workspaces only). </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbExecDirect</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Runs a query by skipping <SPAN CLASS="eln">SQLPrepare</SPAN> and directly calling <SPAN CLASS="eln">SQLExecDirect</SPAN> (ODBCDirect workspaces only). Use this option only when you're not opening a <SPAN CLASS="eln">Recordset</SPAN> based on a <SPAN CLASS="pop">parameter query</SPAN>. For more information, see the<SPAN CLASS="crbt"> Microsoft ODBC 3.0 Programmer's Reference</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbInconsistent</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Allows <SPAN CLASS="pop">inconsistent</SPAN> updates (Microsoft Jet dynaset-type and snapshot-type <SPAN CLASS="eln">Recordset</SPAN> objects only).</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbConsistent</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Allows only consistent updates (Microsoft Jet dynaset-type and snapshot-type <SPAN CLASS="eln">Recordset</SPAN> objects only).</P></TD></TR></TBODY></TABLE>
<BR></P><SPAN CLASS="nh">Note</SPAN>&nbsp;&nbsp;&nbsp;The constants <SPAN CLASS="eln">dbConsistent</SPAN> and <SPAN CLASS="eln">dbInconsistent</SPAN> are mutually exclusive, and using both causes an error. Supplying a <I>lockedits</I> argument when <I>options</I> uses the <SPAN CLASS="eln">dbReadOnly</SPAN> constant also causes an error.</P>
You can use the following constants for the <SPAN CLASS="p">lockedits</SPAN> argument.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="106pt" VALIGN="TOP"><COL WIDTH="254pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbReadOnly</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Prevents users from making changes to the <SPAN CLASS="eln">Recordset</SPAN> (default for ODBCDirect workspaces). You can use <SPAN CLASS="eln">dbReadOnly</SPAN> in either the <SPAN CLASS="p">options</SPAN> argument or the <SPAN CLASS="p">lockedits</SPAN> argument, but not both. If you use it for both arguments, a run-time error occurs.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbPessimistic</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Uses pessimistic locking to determine how changes are made to the <SPAN CLASS="eln">Recordset</SPAN> in a multiuser environment. The <SPAN CLASS="pop">page</SPAN> containing the record you're editing is locked as soon as you use the <SPAN CLASS="eln">Edit</SPAN> method (default for Microsoft Jet workspaces).</P></TD></TR></TBODY></TABLE>
<BR></P><I>(continued)</I></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="101pt" VALIGN="TOP"><COL WIDTH="259pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbOptimistic</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Uses <SPAN CLASS="pop">optimistic</SPAN> locking to determine how changes are made to the <SPAN CLASS="eln">Recordset</SPAN> in a multiuser environment. The page containing the record is not locked until the Update method is executed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbOptimisticValue</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Uses optimistic concurrency based on row values (ODBCDirect workspaces only).</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbOptimisticBatch</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Enables <SPAN CLASS="pop">batch optimistic updating</SPAN> (ODBCDirect workspaces only).</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
In a Microsoft Jet workspace, if <SPAN CLASS="p">object</SPAN> refers to a <SPAN CLASS="eln">QueryDef </SPAN>object, or a dynaset- or snapshot-type <SPAN CLASS="eln">Recordset</SPAN>, or if <SPAN CLASS="p">source</SPAN> refers to an SQL statement or a <SPAN CLASS="eln">TableDef</SPAN> that represents a <SPAN CLASS="pop">linked table</SPAN>, you can't use <SPAN CLASS="eln">dbOpenTable</SPAN> for the <SPAN CLASS="p">type</SPAN><B> </B>argument; if you do, a run-time error occurs. If you want to use an SQL <SPAN CLASS="pop">pass-through query</SPAN> on a linked table&nbsp;in a <SPAN CLASS="pop">Microsoft Jet-connected ODBC data source</SPAN>, you must first set the <SPAN CLASS="eln">Connect </SPAN>property of the linked table's database to a valid ODBC <SPAN CLASS="pop">connection string</SPAN>. If you only need to make a single pass through a <SPAN CLASS="eln">Recordset</SPAN> opened from a Microsoft Jet-connected ODBC data source, you can improve performance by using <SPAN CLASS="eln">dbOpenForwardOnly</SPAN> for the <I>type</I> argument.</P>
If <SPAN CLASS="p">object</SPAN> refers to a dynaset- or snapshot-type <SPAN CLASS="eln">Recordset</SPAN>, the new <B>Recordset</B> is of the same type <SPAN CLASS="p">object</SPAN>. If <SPAN CLASS="p">object</SPAN> refers to a table-type <SPAN CLASS="eln">Recordset</SPAN> object, the type of the new object is a dynaset-type <SPAN CLASS="eln">Recordset</SPAN>. You can't open new <SPAN CLASS="eln">Recordset</SPAN><SPAN CLASS="eln"> objects</SPAN> from forward-only–type or <SPAN CLASS="pop">ODBCDirect</SPAN> <SPAN CLASS="eln">Recordset </SPAN>objects.</P>
In an ODBCDirect workspace, you can open a <B>Recordset</B> containing more than one <SPAN CLASS="pop">select query</SPAN> in the <I>source</I> argument, such as</P>

<pre><code>"SELECT LastName, FirstName FROM Authors
WHERE LastName = 'Smith';
SELECT Title, ISBN FROM Titles
WHERE ISBN Like '1-55615-*'"</code></pre>
The returned <B>Recordset</B> will open with the results of the first query. To obtain the result sets of records from subsequent queries, use the <B>NextRecordset</B> method.</P>
<SPAN CLASS="nh">Note</SPAN>&nbsp;&nbsp;&nbsp;You can send DAO queries to a variety of different database servers with ODBCDirect, and different servers will recognize slightly different dialects of SQL. Therefore, context-sensitive Help is no longer provided for Microsoft Jet SQL, although online Help for Microsoft Jet SQL is still included through the Help menu. Be sure to check the appropriate reference documentation for the SQL dialect of your database server when using either ODBCDirect connections or pass-through queries in Microsoft Jet-connected client/server applications.</P>
Use the <SPAN CLASS="eln">dbSeeChanges</SPAN> constant in a Microsoft Jet workspace if you want to trap changes while two or more users are editing or deleting the same record. For example, if two users start editing the same record, the first user to execute the <SPAN CLASS="eln">Update</SPAN> method succeeds. When the second user invokes the <SPAN CLASS="eln">Update</SPAN> method, a run-time error occurs. Similarly, if the second user tries to use the <SPAN CLASS="eln">Delete</SPAN> method to delete the record, and the first user has already changed it, a run-time error occurs.</P>
Typically, if the user gets this error while updating a record, your code should refresh the contents of the fields and retrieve the newly modified values. If the error occurs while deleting a record, your code could display the new record data to the user and a&nbsp;message indicating that the data has recently changed. At this point, your code can request a confirmation that the user still wants to delete the record.</P>
You should also use the <B>dbSeeChanges</B> constant if you open a <SPAN CLASS="eln">Recordset </SPAN>in a Microsoft Jet-connected ODBC workspace against a Microsoft SQL Server 6.0 (or&nbsp;later) table that has an IDENTITY column, otherwise an error may result.</P>
In an ODBCDirect workspace, you can execute asynchronous queries by setting the <B>dbRunAsync</B> constant in the <I>options</I> argument. This allows your application to continue processing other statements while the query runs in the background. But, you&nbsp;cannot access the <B>Recordset</B> data until the query has completed. To determine whether the query has finished executing, check the <B>StillExecuting</B> property of the new <B>Recordset</B>. If the query takes longer to complete than you anticipated, you can terminate execution of the query with the <B>Cancel</B> method.</P>
Opening more than one <SPAN CLASS="eln">Recordset</SPAN> on an ODBC data source may fail because the connection is busy with a prior <B>OpenRecordset</B> call. One way around this is to use a <SPAN CLASS="pop">server-side cursor</SPAN> and ODBCDirect, if the server supports this. Another solution is to&nbsp;fully populate the <B>Recordset</B> by using the <B>MoveLast</B> method as soon as the <B>Recordset</B> is opened.</P>
If you open a <SPAN CLASS="eln">Connection</SPAN> object with <B>DefaultCursorDriver</B> set to <B>dbUseClientBatchCursor</B>, you can open a <B>Recordset</B> to cache changes to the data (known as batch updating) in an <SPAN CLASS="pop">ODBCDirect</SPAN> workspace. Include <B>dbOptimisticBatch</B> in the <I>lockedits</I> argument to enable update caching. See the Update method topic for details about how to write changes to disk immediately, or to cache changes and write them to disk as a batch.</P>
Closing a <SPAN CLASS="eln">Recordset</SPAN> with the <SPAN CLASS="eln">Close</SPAN> method automatically deletes it from the <SPAN CLASS="eln">Recordsets</SPAN> collection.</P>
<SPAN CLASS="nh">Note</SPAN>   If <SPAN CLASS="p">source</SPAN> refers to an SQL statement composed of a string concatenated with a non-integer value, and the system parameters specify a non-U.S. decimal character such as a comma (for example, <SPAN CLASS="cte">strSQL = "PRICE &gt; " &amp; lngPrice</SPAN>, and <SPAN CLASS="cte">lngPrice = 125,50</SPAN>), an error occurs when you try to open the <SPAN CLASS="eln">Recordset</SPAN>. This is because during concatenation, the number will be converted to a string using your system's default decimal character, and SQL only accepts U.S. decimal characters.</P>
See Also</P>
<SPAN CLASS="eln">Cancel</SPAN> method, <SPAN CLASS="eln">Connect</SPAN> property, <SPAN CLASS="eln">StillExecuting</SPAN> property, <SPAN CLASS="eln">Type</SPAN> property.</P>
Example</P>
This example uses the <SPAN CLASS="eln">OpenRecordset</SPAN> method to open five different <SPAN CLASS="eln">Recordset</SPAN> objects and display their contents. The OpenRecordsetOutput procedure is required for this procedure to run.</P>

<pre><code>Sub OpenRecordsetX()

    Dim wrkJet As Workspace
    Dim wrkODBC As Workspace
    Dim dbsNorthwind As Database
    Dim conPubs As Connection
    Dim rstTemp As Recordset
    Dim rstTemp2 As Recordset

    ' Open Microsoft Jet and ODBCDirect workspaces, Microsoft
    ' Jet database, and ODBCDirect connection.
    Set wrkJet = CreateWorkspace("", "admin", "", dbUseJet)
    Set wrkODBC = CreateWorkspace("", "admin", "", dbUseODBC)
    Set dbsNorthwind = wrkJet.OpenDatabase("Northwind.mdb")
    Set conPubs = wrkODBC.OpenConnection("", , , _
        "ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers")

    ' Open five different Recordset objects and display the
    ' contents of each.

    Debug.Print "Opening forward-only-type recordset " &amp; _
        "where the source is a QueryDef object..."
    Set rstTemp = dbsNorthwind.OpenRecordset( _
        "Ten Most Expensive Products", dbOpenForwardOnly)
    OpenRecordsetOutput rstTemp

    Debug.Print "Opening read-only dynaset-type " &amp; _
        "recordset where the source is an SQL statement..."
    Set rstTemp = dbsNorthwind.OpenRecordset( _
        "SELECT * FROM Employees", dbOpenDynaset, dbReadOnly)
    OpenRecordsetOutput rstTemp

    ' Use the Filter property to retrieve only certain
    ' records with the next OpenRecordset call.
    Debug.Print "Opening recordset from existing " &amp; _
        "Recordset object to filter records..."
    rstTemp.Filter = "LastName &gt;= 'M'"
    Set rstTemp2 = rstTemp.OpenRecordset()
    OpenRecordsetOutput rstTemp2

    Debug.Print "Opening dynamic-type recordset from " &amp; _
        "an ODBC connection..."
    Set rstTemp = conPubs.OpenRecordset( _
        "SELECT * FROM stores", dbOpenDynamic)
    OpenRecordsetOutput rstTemp

    ' Use the StillExecuting property to determine when the
    ' Recordset is ready for manipulation.
    Debug.Print "Opening snapshot-type recordset based " &amp; _
        "on asynchronous query to ODBC connection..."
    Set rstTemp = conPubs.OpenRecordset("publishers", _
        dbOpenSnapshot, dbRunAsync)
    Do While rstTemp.StillExecuting
        Debug.Print "    [still executing...]"
    Loop
    OpenRecordsetOutput rstTemp
    rstTemp.Close
    dbsNorthwind.Close
    conPubs.Close
    wrkJet.Close
    wrkODBC.Close

End Sub

Sub OpenRecordsetOutput(rstOutput As Recordset)

    ' Enumerate the specified Recordset object.
    With rstOutput
        Do While Not .EOF
            Debug.Print , .Fields(0), .Fields(1)
            .MoveNext
        Loop
    End With

End Sub</code></pre>
Example (Microsoft Access)</P>
The following example opens a dynaset-type <SPAN CLASS="eln">Recordset</SPAN> object and prints the number of records in the <SPAN CLASS="eln">Recordset</SPAN> object.</P>

<pre><code>Sub UKOrders()
    Dim dbs As Database, rst As Recordset
    Dim strSQL As String

    ' Return reference to current database.
    Set dbs = CurrentDb
    strSQL = "SELECT * FROM Orders WHERE [ShipCountry] = 'UK'"
    Set rst = dbs.OpenRecordset(strSQL)
    rst.MoveLast
    Debug.Print rst.RecordCount
    rst.Close
    Set dbs = Nothing
End Sub</code></pre>
Example (Microsoft Excel)</P>
This example displays a custom dialog box that contains a list of all the available recordsets in the Nwindex.mdb database. The example opens a new recordset based&nbsp;on the recordset selected by the user and then copies the records <BR>onto Sheet1.</P>
To create the Nwindex.mdb database, run the Microsoft Excel example for the <SPAN CLASS="lee">CreateDatabase</SPAN> method.</P>

<pre><code>Dim db As Database, rs1 As Recordset
Set db = Workspaces(0).OpenDatabase(Application.Path &amp; "\NWINDEX.MDB")
Application.ScreenUpdating = False
Set theDialog = DialogSheets.Add
Set list1 = theDialog.ListBoxes.Add(78, 42, 84, 80)
Set label1 = theDialog.Labels.Add(78, 125, 240, 25)
label1.Text = "Recordsets for " &amp; db.Name
i = 0
Do Until i = db.TableDefs.Count
    list1.AddItem (db.TableDefs(i).Name)
    i = i + 1
Loop
Sheets("Sheet1").Activate
Application.ScreenUpdating = True
If theDialog.Show = True Then
    If list1.Value = 0 Then
        MsgBox "You have not selected an item from the list."
    Else
        Set rs1 = db.OpenRecordset(db.TableDefs(list1.Value - 1).Name)
        ActiveCell.CopyFromRecordset rs1
    End If
End If
rs1.Close
db.Close</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
