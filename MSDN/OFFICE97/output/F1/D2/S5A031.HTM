<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AddMenu Action</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>AddMenu Action</H2>Description</P>
You can use the AddMenu action to create:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">A custom <SPAN CLASS="pop">menu bar</SPAN> for a <SPAN CLASS="pop">form</SPAN> or <SPAN CLASS="pop">report</SPAN>. The custom menu bar replaces the built-in menu bar for the form or report.</LI><LI CLASS="ULI1">A custom <SPAN CLASS="pop">shortcut menu</SPAN> for a form, form <SPAN CLASS="pop">control</SPAN>, or report. The custom shortcut menu replaces the built-in shortcut menu for the form, form control, or report.</LI><LI CLASS="ULI1">A <SPAN CLASS="pop">global menu bar</SPAN>. The global menu bar replaces the built-in menu bar for all Microsoft Access windows, except where you've added a custom menu bar for a form or report.</LI><LI CLASS="ULI1">A <SPAN CLASS="pop">global shortcut menu</SPAN>. The global shortcut menu replaces the built-in shortcut menu for fields in table and query datasheets, forms in <SPAN CLASS="pop">Form view</SPAN>, <SPAN CLASS="pop">Datasheet view</SPAN>, and Print Preview, and reports in Print Preview, except where you've added a custom shortcut menu for a form, form control, or report.
</LI></UL></SPAN><SPAN CLASS="nh">Note</SPAN>   While you can still create all these types of custom menus by using macros containing AddMenu actions in Microsoft Access&nbsp;97 (and any existing custom menus you've created by using macros will still work), it's recommended that you create them by using the <SPAN CLASS="eln">Customize</SPAN> dialog box, available by pointing to <SPAN CLASS="eln">Toolbars</SPAN> on the <SPAN CLASS="eln">View</SPAN> menu and clicking <SPAN CLASS="eln">Customize</SPAN>. While the <SPAN CLASS="eln">Customize</SPAN> dialog box is displayed, you can easily create a new menu or customize a built-in menu.</P>
Setting</P>
The AddMenu action has the following arguments.</P>

<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="269pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Action argument</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Menu Name</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The name of the drop-down menu to add to the custom menu bar or global menu bar. Enter the menu name in the <SPAN CLASS="eln">Menu Name</SPAN> box in the <SPAN CLASS="eln">Action Arguments</SPAN> section of the <SPAN CLASS="pop">Macro window</SPAN>. This is a required argument for custom menu bars and global menu bars. This argument is ignored for custom shortcut menus and global shortcut menus.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">To create an <SPAN CLASS="pop">access key</SPAN> so that you can use the keyboard to choose the menu, type an ampersand (&amp;) before the letter you want to be the access key. This letter will be underlined in the menu name on the menu bar.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Menu Macro Name</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The name of the <SPAN CLASS="pop">macro group</SPAN> that contains the macros for the menu's commands. This is a required argument.</P>
If you run a macro containing the AddMenu action in a <SPAN CLASS="pop">library database</SPAN>, Microsoft Access looks for the macro group with this name in the current database only.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Status Bar Text</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The text to display in the <SPAN CLASS="pop">status bar</SPAN> when the menu is selected. This argument is ignored for custom shortcut menus and global shortcut menus.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
To create a custom menu bar, a custom shortcut menu, a global menu bar, or a global shortcut menu by using macros, you must do the following:</P>
<SPAN CLASS="list"><OL><LI CLASS="OLI1">Create a <SPAN CLASS="pop">menu bar macro</SPAN> that contains an AddMenu action for each drop-down menu you want on the custom menu bar or global menu bar. For custom shortcut menus and global shortcut menus, the menu bar macro should contain just one AddMenu action.</LI><LI CLASS="OLI1">Assign commands to each drop-down menu by creating a macro group for each menu. Each command runs the set of actions defined by a macro in this macro group. For custom shortcut menus and global shortcut menus, create just one macro group in which each macro contains the set of actions for one of the commands in the shortcut menu.</LI><LI CLASS="OLI1">Attach the menu bar macro to the appropriate Microsoft Access object:
For custom menu bars, enter the name of the menu bar macro in the MenuBar property for the form or report.</P>

For custom shortcut menus, enter the name of the menu bar macro in the ShortcutMenuBar property for the form, form control, or report.</P>

For global menu bars, click <SPAN CLASS="eln">Startup</SPAN> on the <SPAN CLASS="eln">Tools</SPAN> menu, then in the <SPAN CLASS="eln">Startup</SPAN> dialog box enter the name of the menu bar macro in the <SPAN CLASS="eln">Menu Bar</SPAN> box.</P>

For global shortcut menus, click <SPAN CLASS="eln">Startup</SPAN> on the <SPAN CLASS="eln">Tools</SPAN> menu, then in the <SPAN CLASS="eln">Startup</SPAN> dialog box enter the name of the menu bar macro in the <SPAN CLASS="eln">Shortcut Menu Bar</SPAN> box.</P></LI></OL></SPAN>Each menu on the menu bar requires a separate AddMenu action.</P>
The custom and global menu bars and shortcut menus replace the built-in menu bars and shortcut menus for the objects they're attached to. If you want to retain certain Microsoft Access commands to use on these menus, use the <SPAN CLASS="jump">RunCommand</SPAN> action to put the commands into the macro groups for the desired menus.</P>
You can run a macro from a menu command by using the <SPAN CLASS="jump">RunMacro</SPAN> action in the macro for the command.</P>
<SPAN CLASS="nh">Note</SPAN>   AddMenu actions can be used only in a menu bar macro specified by the <SPAN CLASS="eln">MenuBar</SPAN> or <SPAN CLASS="eln">ShortcutMenuBar</SPAN> property of a form, form control, or report, or by the <SPAN CLASS="eln">Menu Bar</SPAN> box or <SPAN CLASS="eln">Shortcut Menu Bar</SPAN> box in the <SPAN CLASS="eln">Startup</SPAN> dialog box, available by clicking <SPAN CLASS="eln">Startup</SPAN> on the <SPAN CLASS="eln">Tools</SPAN> menu. Menu bar macros should contain only AddMenu actions.</P>
When you specify a menu bar macro for a form or report or for the database, Microsoft Access runs this menu bar macro whenever the form, report, or database is opened. If you make changes to the menu bar macro or the macro groups that define the commands on the drop-down menus while the form, report, or database is open, you must close the form, report, or database and reopen it to see the changes in the custom menu bar and its menus.</P>
When you are creating the macro groups that contain the commands for a custom menu, the following information applies:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">In the macro group, the name in the Macro Name column for each macro will be the command name. The text in the Comment column in that row will appear in the status bar when you choose the command.</LI><LI CLASS="ULI1">To create a line between two menu commands, type a hyphen (-) in the Macro Name column between the appropriate menu commands.</LI><LI CLASS="ULI1">To create an access key so that you can use the keyboard to choose the command, type an ampersand (&amp;) before the letter you want to be the access key in the command name. This letter will be underlined on the menu.
</LI></UL></SPAN>You can create a <SPAN CLASS="pop">submenu</SPAN> for a custom menu or a custom shortcut menu by using the AddMenu action in a macro group specified by the Menu Macro Name argument. If you put an AddMenu action in such a macro group, Microsoft Access creates a submenu with the menu name and status bar text specified by the Menu Name and Status Bar Text arguments for this AddMenu action. The submenu contains the commands defined by the macros in the macro group specified by the Menu Macro Name argument for the AddMenu action. The Macro Name and Comment columns of such an AddMenu action (which normally specify the command name and status bar text for a command on the custom menu) are ignored, since this action defines a submenu, not a command on the top-level menu. You can create multiple levels of submenus by using AddMenu actions in the macro groups for each level of menu.</P>
Macro conditions are supported in the top-level menu bar macro only. In other words, you can use a condition in a menu bar macro to determine if a particular menu will be displayed on the custom menu bar or global menu bar, but only for the menus on the top level of the menu bar. You can't use conditions to display or hide commands or submenus on the menus. You can also use a condition to hide or show a custom shortcut menu or global shortcut menu.</P>
The AddMenu action isn't available in Visual Basic. You can, however, set the <SPAN CLASS="eln">MenuBar</SPAN> or <SPAN CLASS="eln">ShortcutMenuBar</SPAN> property in Visual Basic to attach a custom menu bar or custom shortcut menu to a form, form control, or report. You can set the StartupMenuBar property (the programmatic equivalent of setting the <SPAN CLASS="eln">Menu Bar</SPAN> box) to create a global menu bar. You can also set the <SPAN CLASS="eln">MenuBar</SPAN> property of the Application object to create a global menu bar. Similarly, you can set the StartupShortcutMenuBar property (the programmatic equivalent of setting the <SPAN CLASS="eln">Shortcut Menu Bar</SPAN> box) or the <SPAN CLASS="eln">ShortcutMenuBar</SPAN> property of the <SPAN CLASS="eln">Application</SPAN> object to create a global shortcut menu.</P>
See Also</P>
<SPAN CLASS="eln">Application</SPAN> object, Event properties, <SPAN CLASS="eln">MenuBar</SPAN> property, <SPAN CLASS="eln">ShortcutMenuBar</SPAN> property, <SPAN CLASS="eln">StartupMenuBar</SPAN> property, <SPAN CLASS="eln">StartupShortcutMenuBar</SPAN> property.</P>
<HR CLASS="rr"></FONT></BODY>
</HTML>
