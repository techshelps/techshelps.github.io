<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DDE Function</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>DDE Function</H2>Description</P>
You can use the <SPAN CLASS="eln">DDE</SPAN> function to initiate a <SPAN CLASS="pop">dynamic data exchange</SPAN> (DDE) conversation with another application, request an item of information from that application, and display that information in a control on a form or report.</P>
For example, you can use the <SPAN CLASS="eln">DDE</SPAN> function in the ControlSource property of a text box to display data from a specified cell in a Microsoft Excel spreadsheet.</P>
Syntax</P>
<SPAN CLASS="l">DDE(</SPAN><SPAN CLASS="p">application</SPAN><SPAN CLASS="l">, </SPAN><SPAN CLASS="p">topic</SPAN><SPAN CLASS="l">, </SPAN><SPAN CLASS="p">item</SPAN><SPAN CLASS="l">)</SPAN></P>
The <SPAN CLASS="eln">DDE</SPAN> function has the following arguments.</P>

<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="75pt" VALIGN="TOP"><COL WIDTH="284pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">application</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A <SPAN CLASS="pop">string expression</SPAN> identifying an application that can participate in a DDE conversation. Usually, <SPAN CLASS="p">application</SPAN> is the name of an .exe file (without the .exe extension) for a Microsoft Windows–based application, such as Microsoft Excel. For example, to initiate a DDE conversation with Microsoft Excel, type "<SPAN CLASS="l">Excel</SPAN>" for the <SPAN CLASS="p">application</SPAN> argument.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">topic</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A string expression that is the name of a <SPAN CLASS="pop">topic</SPAN> recognized by <SPAN CLASS="p">application</SPAN>. The <SPAN CLASS="p">topic</SPAN> argument is often a document or data file. Check the other application's documentation for a list of possible topics.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">item</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A string expression that is the name of a <SPAN CLASS="pop">data item</SPAN> recognized by <SPAN CLASS="p">application</SPAN>. Check the other application's documentation for a list of possible items.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
The <SPAN CLASS="eln">DDE</SPAN> function attempts to initiate a DDE conversation with the specified <SPAN CLASS="p">application</SPAN> and <SPAN CLASS="p">topic</SPAN>, and requests the data in <SPAN CLASS="p">item</SPAN>. If successful, the <SPAN CLASS="eln">DDE</SPAN> function returns a string that contains the requested information.</P>
If you are requesting data from Microsoft Excel, <SPAN CLASS="p">item</SPAN> might be a row-and-column identifier, such as <SPAN CLASS="cte">"R1C1"</SPAN> or the name of a range of cells. In the following example, the <SPAN CLASS="eln">DDE</SPAN> function requests information from the cell at row 1, column 1 in a Microsoft Excel worksheet. You can enter this expression for a text box control in the <SPAN CLASS="eln">ControlSource</SPAN> property box on the control's property sheet:</P>

<pre><code>=DDE("Excel", "Sheet1", "R1C1")</code></pre>
You can use the <SPAN CLASS="eln">DDE</SPAN> function only in the <SPAN CLASS="eln">ControlSource</SPAN> property of a text box, option group, check box, or combo box. You can't call the <SPAN CLASS="eln">DDE</SPAN> function from Visual Basic.</P>
When you use the <SPAN CLASS="eln">DDE</SPAN> function, the control becomes read-only in <SPAN CLASS="pop">Form view</SPAN> and <SPAN CLASS="pop">Print Preview</SPAN>. For example, if you use the <SPAN CLASS="eln">DDE</SPAN> function in a text box, the text in the text box can't be edited. You must edit the text in the other application. Because the <SPAN CLASS="eln">ControlSource</SPAN> property is read-only in Form view and Print Preview, changes to the control must be made in <SPAN CLASS="pop">Design view</SPAN>.</P>
The maximum number of DDE conversations that can be open simultaneously is determined by Microsoft Windows and your computer's memory and resources. If the conversation can't be initiated because <SPAN CLASS="p">application</SPAN> isn't running or doesn't recognize <SPAN CLASS="p">topic</SPAN>, or if the maximum number of conversations has already been reached, the <SPAN CLASS="eln">DDE</SPAN> function returns a Null.</P>
<SPAN CLASS="nh">Note</SPAN>   The other application may be configured to ignore your request for a DDE conversation. If so, the <SPAN CLASS="eln">DDE</SPAN> function returns a <SPAN CLASS="eln">Null</SPAN>. Similarly, you can set Microsoft Access to ignore requests from other applications: Click <SPAN CLASS="eln">Options</SPAN> on the <SPAN CLASS="eln">Tools</SPAN> menu, and on the <SPAN CLASS="eln">Advanced</SPAN> tab of the <SPAN CLASS="eln">Options</SPAN> dialog box, under <SPAN CLASS="eln">DDE Operations</SPAN>, select <SPAN CLASS="eln">Ignore DDE Requests</SPAN>.</P>
<SPAN CLASS="nh">Tip</SPAN>   If you need to manipulate another application's objects from Microsoft Access, you may want to consider using <SPAN CLASS="jump">Automation</SPAN>.</P>
The following table illustrates how the <SPAN CLASS="eln">DDE</SPAN> function behaves when you use it with each of the <SPAN CLASS="pop">controls</SPAN>.</P>

<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="75pt" VALIGN="TOP"><COL WIDTH="284pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Control</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Remarks</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Text box</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The <SPAN CLASS="p">item</SPAN> argument can refer to text or numbers. If <SPAN CLASS="p">item</SPAN> refers to more than one piece of information, such as a named range in a Microsoft Excel worksheet that contains multiple cells, the <SPAN CLASS="eln">DDE</SPAN> function returns the first entry. You could use this function with a text box to display the data contained in a cell on the worksheet.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Combo box</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The <SPAN CLASS="eln">DDE</SPAN> function fills the combo box with the information referred to by <SPAN CLASS="p">item</SPAN>. You can't enter data in the text portion of the box. You might use the <SPAN CLASS="eln">DDE</SPAN> function with a combo box to display a list of regions or countries that you maintain in a Microsoft Excel worksheet.</P></TD></TR></TBODY></TABLE>
<BR></P><I>(continued)</I></P>

<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="75pt" VALIGN="TOP"><COL WIDTH="284pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Control</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Remarks</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Option group</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The OptionValue property of each option button in an option group is set to a number. Usually, the first button value is 1, the second is 2, and so on. The number returned by the <SPAN CLASS="eln">DDE</SPAN> function determines which option button will be selected.</P>
For example, if the <SPAN CLASS="eln">DDE</SPAN> function returns 2, the second button will be selected. If this function returns a value that doesn't match any of the <SPAN CLASS="eln">OptionValue</SPAN> property settings, none of the buttons will be selected. If <SPAN CLASS="p">item</SPAN> refers to more than one piece of information, such as a named range in a Microsoft Excel worksheet that contains multiple cells, the <SPAN CLASS="eln">DDE</SPAN> function returns the first entry.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Check box</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">If the <SPAN CLASS="eln">DDE</SPAN> function returns 0, the check box will be cleared. If this function returns a nonzero number, such as 1 or –1, the box will be selected. If <SPAN CLASS="p">item</SPAN> refers to text or to more than one piece of information, such as a named range in a Microsoft Excel worksheet that contains multiple cells, the check box will be unavailable.</P></TD></TR></TBODY></TABLE>
<BR></P>See Also</P>
<SPAN CLASS="eln">DDEExecute</SPAN> statement, <SPAN CLASS="eln">DDEInitiate</SPAN> function, <SPAN CLASS="eln">DDEPoke</SPAN> statement, <SPAN CLASS="eln">DDERequest</SPAN> function, <SPAN CLASS="eln">DDESend</SPAN> function, <SPAN CLASS="eln">DDETerminate</SPAN> statement, <SPAN CLASS="eln">DDETerminateAll</SPAN> statement, <B>Enabled</B>, <SPAN CLASS="eln">Locked</SPAN> properties.</P>
Example</P>
The following example establishes a DDE link with Microsoft Excel, places some values into cells in the first row of a new worksheet, and charts the values. First, the <SPAN CLASS="eln">DDEInitiate</SPAN> function opens a channel to begin the DDE conversation. Then, the <SPAN CLASS="eln">DDEExecute</SPAN> statement sends Microsoft Excel the command to open a new worksheet, and the <SPAN CLASS="eln">DDERequest</SPAN> function asks Microsoft Excel for the name of the newly created worksheet. A new channel is opened, and the <SPAN CLASS="eln">DDEPoke</SPAN> statement sends to Microsoft Excel the data to be charted. Finally, the <SPAN CLASS="eln">DDETerminate</SPAN> statement terminates the DDE link with Microsoft Excel, and the <SPAN CLASS="eln">DDETerminateAll</SPAN> statement terminates all active DDE links.</P>

<pre><code>Sub ExcelDDE()
    Dim intI As Integer, intChan1 As Integer
    Dim strTopics As String, strResp As String, strSheetName As String

    On Error Resume Next                    ' Set up error handling.

    intChan1 = DDEInitiate("Excel", "System")    ' Establish link.
    If Err Then                                ' If error occurs, Excel may
        Err = 0                                ' not be running. Reset error
        Shell "C:\Excel\Excel.exe", 1        ' and start spreadsheet.
        If Err Then Exit Sub                ' If another error, exit.
        ' Establish Spreadsheet link.
        intChan1 = DDEInitiate("Excel", "System")
    End If

    ' Create new worksheet.
    DDEExecute intChan1, "[New(1)]"
    ' Get topic list, worksheet name.
    strTopics = DDERequest(intChan1, "Selection")
    strSheetName = Left(strTopics, InStr(1, strTopics, "!") - 1)
    ' Terminate DDE link.
    DDETerminate intChan1
    ' Establish link with new worksheet.
    intChan1 = DDEInitiate("Excel", strSheetName)
    For intI = 1 To 10                        ' Put some values into
        DDEPoke intChan1, "R1C" &amp; intI, intI    ' first row.
    Next intI
    ' Make chart.
    DDEExecute intChan1, "[Select(""R1C1:R1C10"")][New(2,2)]"
    ' Terminate all links.
    DDETerminateAll
End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
