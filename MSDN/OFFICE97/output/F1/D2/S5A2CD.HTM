<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ODBCTimeout Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>ODBCTimeout Property</H1>Applies To</P>
<SPAN CLASS="eln">QueryDef</SPAN> object.</P>
Description</P>
Indicates the number of seconds to wait before a timeout error occurs when a QueryDef is executed on an <SPAN CLASS="pop">ODBC</SPAN> database.</P>
Settings and Return Values</P>
The setting or return value is an <SPAN CLASS="eln">Integer</SPAN> representing the number of seconds to wait before a timeout error occurs.</P>
When the <SPAN CLASS="eln">ODBCTimeout</SPAN> property is set to –1, the timeout defaults to the current setting of the QueryTimeout property of the Connection or Database object that contains the <B>QueryDef</B>. When the <SPAN CLASS="eln">ODBCTimeout</SPAN> property is set to 0, no timeout error occurs.</P>
Remarks</P>
When you're using an ODBC database, such as Microsoft SQL Server, delays can occur because of network traffic or heavy use of the ODBC server. Rather than waiting indefinitely, you can specify how long to wait before returning an error.</P>
Setting the <SPAN CLASS="eln">ODBCTimeout</SPAN> property of a <SPAN CLASS="eln">QueryDef</SPAN> object overrides the value specified by the <SPAN CLASS="eln">QueryTimeout</SPAN> property of the <B>Connection</B> or <SPAN CLASS="eln">Database</SPAN> object containing the <SPAN CLASS="eln">QueryDef</SPAN>, but only for that <SPAN CLASS="eln">QueryDef</SPAN> object.</P>
<SPAN CLASS="nh">Note</SPAN>   In an ODBCDirect workspace, after setting <B>ODBCTimeout</B> to an explicit value you can reset it back to the default (i.e., –1) only once during the life of the <B>QueryDef </B>object. Otherwise, an error will occur.</P>
See Also</P>
<SPAN CLASS="eln">QueryTimeout</SPAN> property.</P>
Example</P>
This example uses the <SPAN CLASS="eln">ODBCTimeout</SPAN> and <SPAN CLASS="eln">QueryTimeout</SPAN> properties to show how the <SPAN CLASS="eln">QueryTimeout</SPAN> setting on a <SPAN CLASS="eln">Database</SPAN> object sets the default <SPAN CLASS="eln">ODBCTimeout</SPAN> setting on any <SPAN CLASS="eln">QueryDef</SPAN> objects created from the <SPAN CLASS="eln">Database</SPAN> object.</P>

<pre><code>Sub ODBCTimeoutX()
<B></B>
    Dim dbsCurrent As Database
<B>    </B>Dim qdfStores As QueryDef
<B>    </B>Dim rstStores As Recordset
<B></B>
    Set dbsCurrent = OpenDatabase("Northwind.mdb")
<B></B>
    ' Change the default QueryTimeout of the Northwind
    ' database.
<B>    </B>Debug.Print "Default QueryTimeout of Database: " &amp; _
        dbsCurrent.QueryTimeout
<B>    </B>dbsCurrent.QueryTimeout = 30
<B>    </B>Debug.Print "New QueryTimeout of Database: " &amp; _
        dbsCurrent.QueryTimeout
<B></B>
    ' Create a new QueryDef object.
<B>    </B>Set qdfStores = dbsCurrent.CreateQueryDef("Stores", _
<B>        </B>"SELECT * FROM stores")
<B>    </B>qdfStores.Connect = _
        "ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers"
<B></B>
    ' Change the ODBCTimeout setting of the new QueryDef
    ' object from its default setting.
<B>    </B>Debug.Print "Default ODBCTimeout of QueryDef: " &amp; _
        qdfStores.ODBCTimeout
<B>    </B>qdfStores.ODBCTimeout = 0
<B>    </B>Debug.Print "New ODBCTimeout of QueryDef: " &amp; _
        qdfStores.ODBCTimeout
<B></B>
    ' Execute the query and display the results.
<B>    </B>Set rstStores = qdfStores.OpenRecordset()
<B></B>
    Debug.Print "Contents of recordset:"
<B>    </B>With rstStores
<B>        </B>Do While Not .EOF
<B>            </B>Debug.Print , .Fields(0), .Fields(1)
<B>            </B>.MoveNext
<B>        </B>Loop
<B>        </B>.Close
<B>    </B>End With
<B></B>
    ' Delete new QueryDef because this is a demonstration.
<B>    </B>dbsCurrent.QueryDefs.Delete qdfStores.Name
<B>    </B>dbsCurrent.Close

End Sub</code></pre>
Example (Microsoft Access)</P>
The following example sets the <SPAN CLASS="eln">ODBCTimeout</SPAN> property to 120 seconds, creates a query, and runs it on a database on an ODBC server:</P>

<pre><code>Sub SetTimeout()
    Dim dbs As Database
    Dim qdf As QueryDef, rst As Recordset

    ' Return reference to current database.
    Set dbs = CurrentDb
    ' Create new QueryDef object.
    Set qdf = dbs.CreateQueryDef("All Cust", _
        "SELECT * FROM Customers;")
    qdf.Connect = "ODBC;DSN=HumanResources;SERVER=HRSRVR: " _
        &amp; "UID=Smith; PWD=Sesame"
    ' Log on to server and run query.
    qdf.ODBCTimeout = 120
    Set rst = qdf.OpenRecordset()
    ' Perform operations with recordset.
    .
    .
    .
    rst.Close
    Set dbs = Nothing
End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
