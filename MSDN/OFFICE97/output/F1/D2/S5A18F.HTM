<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>OpenQuery Action</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>OpenQuery Action</H2>Description</P>
You can use the OpenQuery action to open a <SPAN CLASS="pop">select</SPAN> or <SPAN CLASS="pop">crosstab</SPAN> query in <SPAN CLASS="pop">Datasheet view</SPAN>, <SPAN CLASS="pop">Design view</SPAN>, or <SPAN CLASS="pop">Print Preview</SPAN>. This action runs an <SPAN CLASS="pop">action query</SPAN>. You can also select a data entry mode for the query.</P>
Setting</P>
The OpenQuery action has the following arguments.</P>

<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="269pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Action argument</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Query Name</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The name of the query to open. The <SPAN CLASS="eln">Query Name</SPAN> box in the <SPAN CLASS="eln">Action Arguments</SPAN> section of the <SPAN CLASS="pop">Macro window</SPAN> shows all queries in the current database. This is a required argument.</P>
If you run a macro containing the OpenQuery action in a <SPAN CLASS="pop">library database</SPAN>, Microsoft Access looks for the query with this name first in the library database, then in the current database.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">View</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The <SPAN CLASS="pop">view</SPAN> in which the query will open. Click <SPAN CLASS="eln">Datasheet</SPAN>, <SPAN CLASS="eln">Design</SPAN>, or <SPAN CLASS="eln">Print Preview</SPAN> in the <SPAN CLASS="eln">View</SPAN> box. The default is Datasheet.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Data Mode</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The data entry mode for the query. This applies only to queries opened in Datasheet view. Click <SPAN CLASS="eln">Add</SPAN> (the user can add new <SPAN CLASS="pop">records</SPAN> but can't edit existing records), <SPAN CLASS="eln">Edit</SPAN> (the user can edit existing records and add new records), or <SPAN CLASS="eln">Read Only</SPAN> (the user can only view records). The default is Edit.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
If you use Datasheet for the View argument, Microsoft Access displays the <SPAN CLASS="pop">result set</SPAN> if the query is a select, crosstab, <SPAN CLASS="pop">union</SPAN>, or <SPAN CLASS="pop">pass-through</SPAN> query whose ReturnsRecords property is set to Yes; and it runs the query if it were an action, <SPAN CLASS="pop">data-definition</SPAN>, or pass-through query whose <SPAN CLASS="eln">ReturnsRecords</SPAN> property is set to No.</P>
The OpenQuery action is similar to clicking the <SPAN CLASS="eln">Open</SPAN> button or <SPAN CLASS="eln">Design</SPAN> button in the <SPAN CLASS="pop">Database window</SPAN> after selecting a query in the Queries<SPAN CLASS="pop"> tab</SPAN>. With this action you can select additional options.</P>
<SPAN CLASS="nh">Tip</SPAN>   You can select a query in the Database window and drag it to a macro <SPAN CLASS="pop">action row</SPAN>. This automatically creates an OpenQuery action that opens the query in Datasheet view.</P>
Switching to Design view while the query is open removes the Data Mode argument setting for the query. This setting isn't in effect even if the user returns to Datasheet view.</P>
<SPAN CLASS="nh">Tip</SPAN>   If you don't want to display the system messages that normally appear when an action query is run (indicating it's an action query and showing how many records will be affected), you can use the <SPAN CLASS="jump">SetWarnings</SPAN> action to suppress the display of these messages.</P>
To run the OpenQuery action in Visual Basic, use the OpenQuery method of the DoCmd object.</P>
See Also</P>
<SPAN CLASS="eln">OpenQuery</SPAN> method, RunSQL action, SetWarnings action.</P>
<HR CLASS="rr"></FONT></BODY>
</HTML>
