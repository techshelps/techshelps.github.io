<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>RepairDatabase Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>RepairDatabase Method</H1>Applies To</P>
<SPAN CLASS="eln">DBEngine</SPAN> object.</P>
Description</P>
<P>Attempts to repair a corrupted <SPAN CLASS="pop">Microsoft&nbsp;Jet database</SPAN> (<SPAN CLASS="pop">Microsoft&nbsp;Jet databases</SPAN> only).</P>
Syntax</P>
<SPAN CLASS="eln">DBEngine.RepairDatabase </SPAN><SPAN CLASS="p">dbname</SPAN></P>
The <SPAN CLASS="p">dbname</SPAN> argument is a String that is the path and file name for an existing Microsoft&nbsp;Jet database file. If you omit the path, only the current directory is searched. If your system supports the uniform naming convention (UNC), you can also specify a&nbsp;network path, such as <SPAN CLASS="cte">"\\server1\share1\dir1\db1.mdb"</SPAN>.</P>
Remarks</P>
You must close the database specified by <SPAN CLASS="p">dbname</SPAN> before you repair it. In a multiuser environment, other users can't have <SPAN CLASS="p">dbname</SPAN> open while you're repairing it. If <SPAN CLASS="p">dbname</SPAN> isn't closed or isn't available for <SPAN CLASS="pop">exclusive</SPAN> use, an error occurs.</P>
This method attempts to repair a database that was marked as possibly corrupt by an incomplete write operation. This can occur if an application using the Microsoft&nbsp;Jet database engine is closed unexpectedly because of a power outage or computer hardware problem. The database won't be marked as possibly corrupt if you use the <SPAN CLASS="eln">Close</SPAN> method or if you quit your application in a usual way.</P>
The <SPAN CLASS="eln">RepairDatabase</SPAN> method also attempts to validate all system tables and all indexes. Any data that can't be repaired is discarded. If the database can't be repaired, a run-time error occurs.</P>
When you attempt to open or compact a corrupted database, a run-time error usually occurs. In some situations, however, a corrupted database may not be detected, and&nbsp;no&nbsp;error occurs. It's a good idea to provide your users with a way to use the <SPAN CLASS="eln">RepairDatabase</SPAN> method in your application if their database behaves unpredictably.</P>
Some types of databases can become corrupted if a user ends an application without closing <SPAN CLASS="eln">Database</SPAN> or <SPAN CLASS="eln">Recordset </SPAN>objects<SPAN CLASS="eln"> </SPAN>and the Microsoft&nbsp;Jet database engine; Microsoft&nbsp;Windows doesn't have a chance to write data caches to disk. To avoid corrupt databases, establish procedures for closing applications and shutting down systems that ensure that all cached pages are saved to the database. In some cases, power supplies that can't be interrupted may be necessary to prevent accidental data loss during power fluctuations.</P>
<SPAN CLASS="nh">Note</SPAN>   After repairing a database, it's also a good idea to compact it using the <SPAN CLASS="eln">CompactDatabase</SPAN> method to defragment the file and to recover disk space.</P>
See Also</P>
<SPAN CLASS="eln">Close</SPAN> method, <SPAN CLASS="eln">CompactDatabase</SPAN> method, <SPAN CLASS="eln">Database</SPAN> object.</P>
Example</P>
This example attempts to repair the database named Northwind.mdb. You cannot run this procedure from a module within Northwind.mdb.</P>

<pre><code>Sub RepairDatabaseX()

    Dim errLoop As Error

    If MsgBox("Repair the Northwind database?", _
            vbYesNo) = vbYes Then
        On Error GoTo Err_Repair
        DBEngine.RepairDatabase "Northwind.mdb"
        On Error GoTo 0
        MsgBox "End of repair procedure!"
    End If

    Exit Sub

Err_Repair:

    For Each errLoop In DBEngine.Errors
        MsgBox "Repair unsuccessful!" &amp; vbCr &amp; _
            "Error number: " &amp; errLoop.Number &amp; _
            vbCr &amp; errLoop.Description
    Next errLoop

End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
