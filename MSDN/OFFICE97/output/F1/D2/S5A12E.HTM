<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ItemsSelected Collection</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>ItemsSelected Collection</H2>Description</P>
The <SPAN CLASS="eln">ItemsSelected</SPAN> collection provides a way to access data in the selected rows of a <SPAN CLASS="pop">list box</SPAN> control.</P>
Remarks</P>
The <SPAN CLASS="eln">ItemsSelected</SPAN> collection is unlike other collections in that it is a collection of Variants rather than of objects. Each <SPAN CLASS="eln">Variant</SPAN> is an integer index referring to a selected row in a list box or combo box.</P>
Use the <SPAN CLASS="eln">ItemsSelected</SPAN> collection in conjunction with the Column property or the ItemData property to retrieve data from selected rows in a list box or combo box. You can list the <SPAN CLASS="eln">ItemsSelected</SPAN> collection by using the For Each...Next statement.</P>
For example, if you have an Employees list box on a form, you can list the <SPAN CLASS="eln">ItemsSelected</SPAN> collection and use the control's <SPAN CLASS="eln">ItemData</SPAN> property to return the value of the bound column for each selected row in the list box.</P>
<SPAN CLASS="nh">Tip</SPAN>   To enable multiple selection of rows in a list box, set the control's MultiSelect property to Simple or Extended.</P>
The <SPAN CLASS="eln">ItemsSelected</SPAN> collection has no methods and one property, the Count property.</P>
Properties</P>
<SPAN CLASS="eln">Count</SPAN> property.</P>
See Also</P>
<B>For Each...</B><SPAN CLASS="eln">Next</SPAN> statement, <SPAN CLASS="eln">ItemData</SPAN> property, <SPAN CLASS="eln">MultiSelect</SPAN> property.</P>
Example</P>
The following example prints the value of the bound column for each selected row in a Names list box on a Contacts form. To try this example, create the list box and set its <SPAN CLASS="eln">BoundColumn</SPAN> property as desired and its <SPAN CLASS="eln">MultiSelect</SPAN> property to Simple or Extended. Switch to Form view, select several rows in the list box, and run the following code:</P>

<pre><code>Sub BoundData()
    Dim frm As Form, ctl As Control
    Dim varItm As Variant

    Set frm = Forms!Contacts
    Set ctl = frm!Names
    For Each varItm In ctl.ItemsSelected
        Debug.Print ctl.ItemData(varItm)
    Next varItm
End Sub</code></pre>
The next example uses the same list box control, but prints the values of each column for each selected row in the list box, instead of only the values in the bound column.</P>

<pre><code>Sub AllSelectedData()
    Dim frm As Form, ctl As Control
    Dim varItm As Variant, intI As Integer

    Set frm = Forms!Contacts
    Set ctl = frm!Names
    For Each varItm In ctl.ItemsSelected
        For intI = 0 To ctl.ColumnCount - 1
            Debug.Print ctl.Column(intI, varItm)
        Next intI
        Debug.Print
    Next varItm
End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
