<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Delete, BeforeDelConfirm, AfterDelConfirm Events -- Event Procedures</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>Delete, BeforeDelConfirm, AfterDelConfirm Events — Event Procedures</H2>Description</P>
To create an <SPAN CLASS="pop">event procedure</SPAN> that runs when a Delete, BeforeDelConfirm, or AfterDelConfirm event occurs, set the OnDelete<SPAN CLASS="jump">, </SPAN>BeforeDelConfirm<SPAN CLASS="jump">, or </SPAN>AfterDelConfirm property to [Event Procedure], and click the <SPAN CLASS="eln">Build</SPAN> button.</P>
Syntax</P>
<SPAN CLASS="l">Private Sub Form_Delete(</SPAN>Cancel<SPAN CLASS="l"> As Integer)</SPAN></P>
<SPAN CLASS="l">Private Sub Form_BeforeDelConfirm(</SPAN>Cancel<SPAN CLASS="l"> As Integer, </SPAN>Response<SPAN CLASS="l"> As Integer)</SPAN></P>
<SPAN CLASS="l">Private Sub Form_AfterDelConfirm(</SPAN>Status<SPAN CLASS="l"> As Integer)</SPAN></P>
The Delete event procedure has the following argument.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="66pt" VALIGN="TOP"><COL WIDTH="293pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Cancel</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The setting determines if the Delete event occurs. Setting the Cancel argument to <SPAN CLASS="eln">True</SPAN> (–1) cancels the Delete event.</P></TD></TR></TBODY></TABLE>
<BR></P>The BeforeDelConfirm event procedure has the following arguments.</P>

<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="66pt" VALIGN="TOP"><COL WIDTH="293pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Cancel</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The setting determines if the BeforeDelConfirm event occurs. Setting the Cancel argument to <SPAN CLASS="eln">True</SPAN> cancels the BeforeDelConfirm event and prevents the <SPAN CLASS="eln">Delete Confirm</SPAN> dialog box from being displayed. If the event is canceled, the original <SPAN CLASS="pop">records</SPAN> are restored, but the AfterDelConfirm event still occurs. If Cancel is set to <SPAN CLASS="eln">True</SPAN>, the Response argument is ignored.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">If Cancel is set to <SPAN CLASS="eln">False</SPAN> (0), which it is by default, the value in the Response argument is used by Microsoft Access to determine the type of response to the delete event.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Response</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The setting determines whether Microsoft Access displays the <SPAN CLASS="eln">Delete Confirm</SPAN> dialog box asking if the record should be deleted. The Response argument can be set to one of the following <SPAN CLASS="pop">intrinsic constants</SPAN>:</P></TD></TR></TBODY></TABLE>
<BR></P><I>(continued)</I></P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="86pt" VALIGN="TOP"><COL WIDTH="102pt" VALIGN="TOP"><COL WIDTH="171pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">acDataErrContinue</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Continues without displaying the <SPAN CLASS="eln">Delete Confirm</SPAN> dialog box. Setting the Cancel argument to <SPAN CLASS="eln">False</SPAN> and the Response argument to <SPAN CLASS="eln">acDataErrContinue</SPAN> enables Microsoft Access to delete records without prompting the user.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">acDataErrDisplay</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">(Default) Displays the <SPAN CLASS="eln">Delete Confirm</SPAN> dialog box.</P></TD></TR></TBODY></TABLE>
<BR></P>The AfterDelConfirm event procedure has the following argument.</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="87pt" VALIGN="TOP"><COL WIDTH="106pt" VALIGN="TOP"><COL WIDTH="165pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</P></TD><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Status</P></TD><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The setting indicates whether a record has been deleted. The Status argument can be any of the following intrinsic constants:</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">acDeleteOK</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Indicates the deletion was successful.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">acDeleteCancel</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Indicates the deletion was canceled in Visual Basic.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">acDeleteUserCancel</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Indicates the deletion was canceled by the user.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
The AfterDelConfirm event can't be canceled.</P>
You can use these events to customize how records are deleted. For example, when a user deletes a record, such as an employee record, the Delete event occurs. You can place code in the Delete event procedure to save the data from the Employee ID and Name fields in a set of temporary variables. When the BeforeDelConfirm event occurs, you can prevent the <SPAN CLASS="eln">Delete Confirm</SPAN> dialog box from being displayed by setting the Response argument to <SPAN CLASS="eln">acDataErrContinue</SPAN>. This enables you to display a <SPAN CLASS="pop">custom dialog box</SPAN>. When the AfterDelConfirm event occurs and the Status argument is set to <SPAN CLASS="eln">acDeleteOK</SPAN>, you can clear the temporary variables, or save the employee information in another table.</P>
See Also</P>
Delete, BeforeDelConfirm, AfterDelConfirm events&nbsp;— macros.</P>
Example</P>
The following example shows how you can prevent a user from deleting records from a table.</P>
To try this example, add the following event procedure to a form that is based on a table. Switch to form Datasheet view and try to delete a record.</P>

<pre><code>Private Sub Form_Delete(Cancel As Integer)
    Cancel = True
    MsgBox "This record can't be deleted."
End Sub</code></pre>
The following example shows how you can use the BeforeDelConfirm event procedure to suppress the <SPAN CLASS="eln">Delete Confirm</SPAN> dialog box and display a custom dialog box when a record is deleted. It also shows how you can use the AfterDelConfirm event procedure to display a message indicating whether the deletion progressed in the usual way or whether it was canceled in Visual Basic or by the user.</P>
To try the example, add the following event procedure to a form that is based on a table or query:</P>

<pre><code>Private Sub Form_BeforeDelConfirm(Cancel As Integer, _
        Response As Integer)
    ' Suppress default Delete Confirm dialog box.
    Response = acDataErrContinue
    ' Display custom dialog box.
    If MsgBox("Delete this record?", vbOKCancel) = vbCancel Then
        Cancel = True
    End If
End Sub

Private Sub Form_AfterDelConfirm(Status As Integer)
    Select Case Status
        Case acDeleteOK
            MsgBox "Deletion occurred normally."
        Case acDeleteCancel
            MsgBox "Programmer canceled the deletion."
        Case acDeleteUserCancel
            MsgBox "User canceled the deletion."
    End Select
End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
