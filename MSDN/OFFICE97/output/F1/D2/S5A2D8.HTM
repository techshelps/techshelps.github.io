<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>PercentPosition Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>PercentPosition Property</H1>Applies To</P>
Dynamic-Type <SPAN CLASS="eln">Recordset</SPAN> object, <SPAN CLASS="eln">Recordset</SPAN> object, Snapshot-Type <SPAN CLASS="eln">Recordset</SPAN> object, Table-Type <SPAN CLASS="eln">Recordset</SPAN> object.</P>
Description</P>
Sets or returns a value indicating the approximate location of the <SPAN CLASS="pop">current record</SPAN> in the Recordset object based on a percentage of the records in the <SPAN CLASS="eln">Recordset</SPAN>.</P>
Settings and Return Values</P>
The setting or return value is a <SPAN CLASS="eln">Single</SPAN> that is a number between 0.0 and 100.00.</P>
Remarks</P>
To indicate or change the approximate position of the current record in a <SPAN CLASS="eln">Recordset</SPAN> object, you can check or set the <SPAN CLASS="eln">PercentPosition</SPAN> property. When working with a dynaset- or snapshot-type <SPAN CLASS="eln">Recordset</SPAN> object opened directly from a <SPAN CLASS="pop">base table</SPAN>, first populate the <SPAN CLASS="eln">Recordset</SPAN> object by moving to the last record before you set or check the <SPAN CLASS="eln">PercentPosition</SPAN> property. If you use the <SPAN CLASS="eln">PercentPosition</SPAN> property before fully populating the <SPAN CLASS="eln">Recordset</SPAN> object, the amount of movement is relative to the number of records accessed as indicated by the RecordCount property setting. You can move to the last record by using the <SPAN CLASS="eln">MoveLast</SPAN> method.</P>
<SPAN CLASS="nh">Note</SPAN>   Using the <SPAN CLASS="eln">PercentPosition</SPAN> property to move the current record to a specific record in a <SPAN CLASS="eln">Recordset</SPAN> object isn't recommended — the <SPAN CLASS="eln">Bookmark</SPAN> property is better suited for this task.</P>
Once you set the <SPAN CLASS="eln">PercentPosition</SPAN> property to a value, the record at the approximate position corresponding to that value becomes current, and the <SPAN CLASS="eln">PercentPosition</SPAN> property is reset to a value that reflects the approximate position of the current record. For example, if your <SPAN CLASS="eln">Recordset</SPAN> object contains only five records, and you set its <SPAN CLASS="eln">PercentPosition</SPAN> property value to 77, the value returned from the <SPAN CLASS="eln">PercentPosition</SPAN> property may be 80, not 77.</P>
The <SPAN CLASS="eln">PercentPosition</SPAN> property applies to all types of <SPAN CLASS="eln">Recordset</SPAN> objects except for forward-only-type <SPAN CLASS="eln">Recordset</SPAN> objects or <SPAN CLASS="eln">Recordset</SPAN> objects opened from <SPAN CLASS="pop">pass-through queries</SPAN> against remote databases.</P>
You can use the <SPAN CLASS="eln">PercentPosition</SPAN> property with a scroll bar on a form or text box to indicate the location of the current record in a <SPAN CLASS="eln">Recordset</SPAN> object.</P>
See Also</P>
<SPAN CLASS="eln">Bookmark</SPAN> property, <SPAN CLASS="eln">Index</SPAN> property, <SPAN CLASS="eln">Move</SPAN> method, <SPAN CLASS="eln">MoveFirst</SPAN>, <SPAN CLASS="eln">MoveLast</SPAN>, <SPAN CLASS="eln">MoveNext</SPAN>, <SPAN CLASS="eln">MovePrevious</SPAN> methods.</P>
Example</P>
This example uses the <SPAN CLASS="eln">PercentPosition</SPAN> property to show the position of the <SPAN CLASS="pop">current record</SPAN> pointer relative to the beginning of the <SPAN CLASS="eln">Recordset</SPAN>.</P>

<pre><code>Sub PercentPositionX()

    Dim dbsNorthwind As Database
    Dim rstProducts As Recordset
    Dim strFind As String
    Dim strMessage As String

    Set dbsNorthwind = OpenDatabase("Northwind.mdb")
    ' PercentPosition only works with dynasets or snapshots.
    Set rstProducts = dbsNorthwind.OpenRecordset( _
        "SELECT ProductName FROM Products " &amp; _
        "ORDER BY ProductName", dbOpenSnapshot)

    With rstProducts
        ' Populate the Recordset.
        .MoveLast
        .MoveFirst
        Do While True
            ' Show current record information and ask user
            ' for input.
            strMessage = "Product: " &amp; !ProductName &amp; vbCr &amp; _
                "The record pointer is " &amp; _
                Format(.PercentPosition, "##0.0") &amp; _
                "% from the " &amp; vbCr &amp; _
                "beginning of the Recordset." &amp; vbCr &amp; _
                "Please enter a character search string " &amp; _
                "for a product name."
            strFind = Trim(InputBox(strMessage))
            If strFind = "" Then Exit Do

            ' Try to find a record matching the search string.
            .FindFirst "ProductName &gt;= '" &amp; strFind &amp; "'"
            If .NoMatch Then .MoveLast
        Loop

        .Close
    End With

    dbsNorthwind.Close

End Sub</code></pre>
Example (Microsoft&nbsp;Access)</P>
The following example expresses the current position of a record in a recordset as a percent, then displays it in a message box:</P>

<pre><code>Sub PercentOfRecords()
    Dim dbs As Database, rst As Recordset
    Dim strInput As String, strSQL As String

    strSQL = "SELECT * FROM Products ORDER BY ProductName;"
    ' Return reference to current database.
    Set dbs = CurrentDb
    ' Open dynaset-type Recordset object.
    Set rst = dbs.OpenRecordset(strSQL, dbOpenDynaset)
    ' Move to end of recordset.
    rst.MoveLast
    ' Return to start of recordset.
    rst.MoveFirst
    ' Prompt user to input name of product.
    strInput = InputBox("Please enter the full product name.")
    ' Find first occurrence.
    rst.FindFirst "ProductName = '" &amp; strInput &amp; "'"
    ' Display current position as a percent.
    MsgBox("The current position in the Recordset is " _
        &amp; rst.PercentPosition &amp; "%.")
    rst.Close
    Set dbs = Nothing
End Sub</code></pre>
Example (Microsoft&nbsp;Excel)</P>
This example selects and changes records in the Customer recordset in the Nwindex.mdb database, and then it copies the recordset to Sheet1. The status bar shows the percentage of records that have been changed.</P>
To create the Nwindex.mdb database, run the Microsoft&nbsp;Excel example for the <SPAN CLASS="lee">CreateDatabase</SPAN> method.</P>

<pre><code>Dim db As Database, rs As Recordset, sQLText As String
Set db = Workspaces(0).OpenDatabase(Application.Path &amp; "\NWINDEX.MDB")
sQLText = "SELECT [CON_TITLE], [CONTACT], [COMPANY] FROM Customer " _
    &amp; "WHERE [CON_TITLE] = 'Owner';"
Set rs = db.OpenRecordset(sQLText, dbOpenDynaset)
rs.MoveFirst
Sheets("Sheet1").Activate
Do While Not rs.EOF
    rs.Edit
    rs.Fields("CON_TITLE").Value = "Account Excecutive"
    rs.Update
    Application.StatusBar = rs.PercentPosition &amp; "% of the" _
        &amp; " records have been replaced."
    rs.MoveNext
Loop
Application.StatusBar = "Done"
rs.MoveFirst
numberOfRows = ActiveCell.CopyFromRecordset(rs)
MsgBox numberOfRows &amp; " Records have been changed"
rs.Close
db.Close</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
