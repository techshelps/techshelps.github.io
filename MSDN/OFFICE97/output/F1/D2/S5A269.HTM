<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BatchSize Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>BatchSize Property</H2>Applies To</P>
Dynamic-Type <SPAN CLASS="eln">Recordset</SPAN> object, Dynaset-Type <SPAN CLASS="eln">Recordset</SPAN> object, Forward-Only–Type <SPAN CLASS="eln">Recordset</SPAN> object, <SPAN CLASS="eln">Recordset</SPAN> object, Snapshot-Type <SPAN CLASS="eln">Recordset</SPAN> object.</P>
Description</P>
Sets or returns the number of statements sent back to the server in each batch (<SPAN CLASS="pop">ODBCDirect workspaces</SPAN> only).</P>
Settings And Return Values</P>
The setting or return value is a <SPAN CLASS="lee">Long</SPAN> that indicates the number of batched statements sent the server in a single batch update. The default value is 15.</P>
Remarks</P>
The <SPAN CLASS="lee">BatchSize</SPAN> property determines the batch size used when sending statements to the server in a batch update. The value of the property determines the number of statements sent to the server in one command buffer. By default, 15 statements are sent to the server in each batch. This property can be changed at any time. If a database server doesn't support statement batching, you can set this property to 1, causing each statement to be sent separately.</P>
Example</P>
This example uses the <SPAN CLASS="eln">BatchSize</SPAN> and <SPAN CLASS="eln">UpdateOptions</SPAN> properties to control aspects of any <SPAN CLASS="pop">batch updating</SPAN> for the specified <SPAN CLASS="eln">Recordset</SPAN> object.</P>

<pre><code>Sub BatchSizeX()

    Dim wrkMain As Workspace
    Dim conMain As Connection
    Dim rstTemp As Recordset

    Set wrkMain = CreateWorkspace("ODBCWorkspace", _
        "admin", "", dbUseODBC)
    ' This DefaultCursorDriver setting is required for
    ' batch updating.
    wrkMain.DefaultCursorDriver = dbUseClientBatchCursor

    Set conMain = wrkMain.OpenConnection("Publishers", _
        dbDriverNoPrompt, False, _
        "ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers")
    ' The following locking argument is required for
    ' batch updating.
    Set rstTemp = conMain.OpenRecordset( _
        "SELECT * FROM roysched", dbOpenDynaset, 0, _
        dbOptimisticBatch)

    With rstTemp
        ' Increase the number of statements sent to the server
        ' during a single batch update, thereby reducing the
        ' number of times an update would have to access the
        ' server.
        .BatchSize = 25

        ' Change the UpdateOptions property so that the WHERE
        ' clause of any batched statements going to the server
        ' will include any updated columns in addition to the
        ' key column(s). Also, any modifications to records
        ' will be made by deleting the original record
        ' and adding a modified version rather than just
        ' modifying the original record.
        .UpdateOptions = dbCriteriaModValues + _
            dbCriteriaDeleteInsert

        ' Engage in batch updating using the new settings
        ' above.
        ' ...

        .Close
    End With

    conMain.Close
    wrkMain.Close

End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
