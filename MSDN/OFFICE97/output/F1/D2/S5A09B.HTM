<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CurrentObjectType, CurrentObjectName Properties</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>CurrentObjectType, CurrentObjectName Properties</H2>Applies To</P>
<SPAN CLASS="eln">Application</SPAN> object.</P>
Description</P>
You can use the <SPAN CLASS="eln">CurrentObjectType</SPAN> and <SPAN CLASS="eln">CurrentObjectName</SPAN> properties together with the Application object to determine the type of the active database object (table, query, form, report, macro, or module) and the name of the active database object. The active database object is the object that has the <SPAN CLASS="pop">focus</SPAN> or in which code is running.</P>
Setting</P>
The <SPAN CLASS="eln">CurrentObjectType</SPAN> property is set by Microsoft Access to one of the following Microsoft Access <SPAN CLASS="pop">intrinsic constants</SPAN>.</P>

<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="268pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Setting</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">acTable</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The active object is a table.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">acQuery</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The active object is a query.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">acForm</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The active object is a form.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">acReport</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The active object is a report.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">acMacro</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The active object is a macro.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">acModule</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The active object is a module.</P></TD></TR></TBODY></TABLE>
<BR></P>The <SPAN CLASS="eln">CurrentObjectName</SPAN> property is set by Microsoft Access to a <SPAN CLASS="pop">string expression</SPAN> containing the name of the active object.</P>
These properties are available only by using <SPAN CLASS="jump">Visual&nbsp;Basic</SPAN> and are read-only in all views.</P>
Remarks</P>
The following conditions determine which object is considered the active object:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">If the active object is a property sheet, <SPAN CLASS="pop">command bar</SPAN>, menu, palette, or <SPAN CLASS="pop">field list</SPAN> of an object, the <SPAN CLASS="eln">CurrentObjectType</SPAN> and <SPAN CLASS="eln">CurrentObjectName</SPAN> properties return the type and name of the underlying object.</LI><LI CLASS="ULI1">If the active object is a <SPAN CLASS="pop">pop-up form</SPAN>, the <SPAN CLASS="eln">CurrentObjectType</SPAN> and <SPAN CLASS="eln">CurrentObjectName</SPAN> properties refer to the pop-up form itself, not the form from which it was opened.</LI><LI CLASS="ULI1">If the active object is the <SPAN CLASS="pop">Database window</SPAN>, the <SPAN CLASS="eln">CurrentObjectType</SPAN> and <SPAN CLASS="eln">CurrentObjectName</SPAN> properties return the item selected in the Database window.</LI><LI CLASS="ULI1">If no object is selected, the <SPAN CLASS="eln">CurrentObjectType</SPAN> property returns <SPAN CLASS="eln">True</SPAN> (–1), and the <SPAN CLASS="eln">CurrentObjectName</SPAN> property returns a <SPAN CLASS="pop">zero-length string</SPAN> (" ").</LI><LI CLASS="ULI1">If the current state is ambiguous (the active object isn't a table, query, form, report, macro, or module) — for example, if a dialog box has the focus — the <SPAN CLASS="eln">CurrentObjectType</SPAN> property returns <SPAN CLASS="eln">True</SPAN>, and the <SPAN CLASS="eln">CurrentObjectName</SPAN> property returns the dialog box name.
</LI></UL></SPAN>You can use these properties with the SysCmd function to determine the active object and its state (for example, if the object is open, new, or has been changed but not saved).</P>
See Also</P>
<SPAN CLASS="eln">SysCmd</SPAN> function.</P>
Example</P>
The following example uses the <SPAN CLASS="eln">CurrentObjectType</SPAN> and <SPAN CLASS="eln">CurrentObjectName</SPAN> properties with the <SPAN CLASS="eln">SysCmd</SPAN> function to determine if the active object is the Products form and if this form is open and has been changed but not saved. If these conditions are true, the form is saved and then closed.</P>

<pre><code>Sub CheckProducts()
    Dim intState As Integer
    Dim intCurrentType As Integer
    Dim strCurrentName As String

    intCurrentType = Application.CurrentObjectType
    strCurrentName = Application.CurrentObjectName
    If intCurrentType = acForm And strCurrentName = "Products" Then
        intState = SysCmd(acSysCmdGetObjectState, intCurrentType, _
            strCurrentName)
        ' Products form changed but not saved.
        If intState = acObjStateDirty + _
            acObjStateOpen Then
            ' Close Products form and save changes.
            DoCmd.Close intCurrentType, _
                strCurrentName, acSaveYes
        End If
    End If
End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
