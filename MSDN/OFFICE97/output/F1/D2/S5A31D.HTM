<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CONSTRAINT Clause</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>CONSTRAINT Clause</H2>Description</P>
A <SPAN CLASS="pop">constraint</SPAN> is similar to an <SPAN CLASS="pop">index</SPAN>, although it can also be used to establish a <SPAN CLASS="pop">relationship</SPAN> with another table.</P>
You use the CONSTRAINT clause in <SPAN CLASS="jump">ALTER TABLE</SPAN> and <SPAN CLASS="jump">CREATE TABLE</SPAN> statements to create or delete constraints. There are two types of CONSTRAINT clauses: one for creating a constraint on a single field and one for creating a constraint&nbsp;on more than one field.</P>
<SPAN CLASS="nh">Note</SPAN>&nbsp;&nbsp;&nbsp;The <SPAN CLASS="pop">Microsoft Jet database engine</SPAN> doesn't support the use of CONSTRAINT, or any of the <SPAN CLASS="pop">data definition language (DDL)</SPAN> statements, with non-Microsoft Jet databases. Use the <SPAN CLASS="pop">DAO</SPAN>&nbsp;Create methods instead.</P>
Syntax</P>
Single-field constraint:</P>
CONSTRAINT <SPAN CLASS="p">name</SPAN> {PRIMARY KEY | UNIQUE | NOT NULL |<BR>REFERENCES <SPAN CLASS="p">foreigntable</SPAN> [(<SPAN CLASS="p">foreignfield1, foreignfield2</SPAN>)]}</P>
Multiple-field constraint:</P>
CONSTRAINT <SPAN CLASS="p">name</SPAN><BR>{PRIMARY KEY (<SPAN CLASS="p">primary1</SPAN>[, <SPAN CLASS="p">primary2</SPAN> [, ...]]) |<BR>UNIQUE (<SPAN CLASS="p">unique1</SPAN>[, <SPAN CLASS="p">unique2</SPAN> [, ...]]) |<BR>NOT NULL (<SPAN CLASS="p">notnull1</SPAN>[, <SPAN CLASS="p">notnull2</SPAN> [, ...]]) |<BR>FOREIGN KEY (<SPAN CLASS="p">ref1</SPAN>[, <SPAN CLASS="p">ref2</SPAN> [, ...]])<BR>REFERENCES <SPAN CLASS="p">foreigntable</SPAN> [(<SPAN CLASS="p">foreignfield1</SPAN> [, <SPAN CLASS="p">foreignfield2</SPAN> [, ...]])]}</P>
The CONSTRAINT clause has these parts</P>
</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="111pt" VALIGN="TOP"><COL WIDTH="249pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">name</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The name of the constraint to be created.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">primary1</SPAN>, <SPAN CLASS="p">primary2</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The name of the field or fields to be designated the <SPAN CLASS="pop">primary key</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">unique1</SPAN>, <SPAN CLASS="p">unique2</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The name of the field or fields to be designated as a unique key.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">notnull1</SPAN>,<SPAN CLASS="p"> notnull2</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The name of the field or fields that are restricted to non-Null values.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">ref1</SPAN>, <SPAN CLASS="p">ref2</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The name of a <SPAN CLASS="pop">foreign key</SPAN> field or fields that refer to fields in another table.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">foreigntable</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The name of the <SPAN CLASS="pop">foreign table</SPAN> containing the field or fields specified by <SPAN CLASS="p">foreignfield</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">foreignfield1</SPAN>, <SPAN CLASS="p">foreignfield2</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The name of the field or fields in <SPAN CLASS="p">foreigntable</SPAN> specified by <SPAN CLASS="p">ref1</SPAN>, <SPAN CLASS="p">ref2</SPAN>. You can omit this clause if the referenced field is the primary key of <SPAN CLASS="p">foreigntable</SPAN>.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
You use the syntax for a single-field constraint in the field-definition clause of an ALTER TABLE or CREATE TABLE statement immediately following the specification of the field's data type.</P>
You use the syntax for a multiple-field constraint whenever you use the <SPAN CLASS="pop">reserved word</SPAN> CONSTRAINT outside a field-definition clause in an ALTER TABLE or CREATE TABLE statement.</P>
Using CONSTRAINT, you can designate a field as one of the following types of constraints:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">You can use the UNIQUE reserved word to designate a field as a unique key. This means that no two records in the table can have the same value in this field. You can constrain any field or list of fields as unique. If a multiple-field constraint is designated as a unique key, the combined values of all fields in the index must be unique, even if two or more records have the same value in just one of the fields.</LI><LI CLASS="ULI1">You can use the PRIMARY KEY reserved words to designate one field or set of fields in a table as a primary key. All values in the primary key must be unique and not <SPAN CLASS="eln">Null</SPAN>, and there can be only one primary key for a table.
<SPAN CLASS="nh">Note</SPAN>   Don't set a PRIMARY KEY constraint on a table that already has a primary key; if you do, an error occurs.</P></LI><LI CLASS="ULI1">You can use the FOREIGN KEY reserved words to designate a field as a foreign key. If the foreign table's primary key consists of more than one field, you must use a multiple-field constraint definition, listing all of the referencing fields, the name of the foreign table, and the names of the referenced fields in the foreign table in the same order that the referencing fields are listed. If the referenced field or fields are the foreign table's primary key, you don't have to specify the referenced fields — by default, the database engine behaves as if the foreign table's primary key is the referenced fields.
</LI></UL></SPAN>See Also</P>
ALTER TABLE statement, CREATE INDEX statement, CREATE TABLE statement, <SPAN CLASS="eln">CreateField</SPAN> method ("DAO Language Reference"), <SPAN CLASS="eln">CreateIndex</SPAN> method ("DAO Language Reference"), <SPAN CLASS="eln">CreateRelation</SPAN> method ("DAO Language Reference"), <SPAN CLASS="eln">CreateTableDef</SPAN> method ("DAO Language Reference"), DROP statement.</P>
Example</P>
This example creates a new table called ThisTable with two Text fields.</P>

<pre><code>Sub CreateTableX1()

    Dim dbs As Database

    ' Modify this line to include the path to Northwind
    ' on your computer.
    Set dbs = OpenDatabase("Northwind.mdb")

' Create a table with two text fields.
    dbs.Execute "CREATE TABLE ThisTable " _
        &amp; "(FirstName TEXT, LastName TEXT);"

    dbs.Close

End Sub</code></pre>
This example creates a new table called MyTable with two Text fields, a Date/Time field, and a unique index made up of all three fields.</P>

<pre><code>Sub CreateTableX2()

    Dim dbs As Database

    ' Modify this line to include the path to Northwind
    ' on your computer.
    Set dbs = OpenDatabase("Northwind.mdb")

    ' Create a table with three fields and a unique
    ' index made up of all three fields.
    dbs.Execute "CREATE TABLE MyTable " _
        &amp; "(FirstName TEXT, LastName TEXT, " _
        &amp; "DateOfBirth DATETIME, " _
        &amp; "CONSTRAINT MyTableConstraint UNIQUE " _
        &amp; "(FirstName, LastName, DateOfBirth));"

    dbs.Close

End Sub</code></pre>
This example creates a new table with two Text fields and an Integer field. The SSN field is the primary key.</P>

<pre><code>Sub CreateTableX3()

     Dim dbs As Database

    ' Modify this line to include the path to Northwind
    ' on your computer.
    Set dbs = OpenDatabase("Northwind.mdb")

    ' Create a table with three fields and a primary
    ' key.
    dbs.Execute "CREATE TABLE NewTable " _
        &amp; "(FirstName TEXT, LastName TEXT, " _
        &amp; "SSN INTEGER CONSTRAINT MyFieldConstraint " _
        &amp; "PRIMARY KEY);"

    dbs.Close

End Sub</code></pre>
Example (Microsoft Access)</P>
To try the following examples in Microsoft Access, first create a new query in the Northwind sample database. Close the <SPAN CLASS="eln">Show Table</SPAN> dialog box without specifying a table or query. Switch to SQL view, paste an individual example into the SQL window, and run the query.</P>
<HR CLASS="ws">
<SPAN CLASS="wh">Warning</SPAN>   These examples makes changes to the Northwind sample database. Before beginning, you may wish to make a backup copy of the sample database.</P>
<HR CLASS="we">
The following example creates a new table with two Text fields:</P>

<pre><code>CREATE TABLE FirstTable (FirstName TEXT, LastName TEXT);</code></pre>
The next example creates a new table with two Text fields, a Date/Time field, and a unique index made up of all three fields:</P>

<pre><code>CREATE TABLE SecondTable (FirstName TEXT,
LastName TEXT, DateOfBirth DATETIME,
CONSTRAINT MyTableConstraint UNIQUE (FirstName, LastName, DateOfBirth));</code></pre>
The following example creates a new table with two Text fields and an Integer Number field. The SSN field is the primary key.</P>

<pre><code>CREATE TABLE ThirdTable (FirstName TEXT, LastName TEXT, SSN INTEGER
CONSTRAINT MyFieldConstraint PRIMARY KEY);</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
