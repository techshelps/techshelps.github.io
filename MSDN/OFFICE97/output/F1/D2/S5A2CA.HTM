<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>NextRecordset Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>NextRecordset Method</H1>Applies To</P>
Dynamic-Type <SPAN CLASS="eln">Recordset</SPAN> object, Dynaset-Type <SPAN CLASS="eln">Recordset</SPAN> object, Forward-Only–Type <SPAN CLASS="eln">Recordset</SPAN> object, <SPAN CLASS="eln">Recordset</SPAN> object, Snapshot-Type <SPAN CLASS="eln">Recordset</SPAN> object.</P>
Description</P>
Gets the next set of records, if any, returned by a multi-part select query in an <SPAN CLASS="lee">OpenRecordset</SPAN> call, and returns a <SPAN CLASS="lee">Boolean</SPAN> value indicating whether one or more additional records are pending (<SPAN CLASS="pop">ODBCDirect workspaces</SPAN> only).</P>
Syntax</P>
<SPAN CLASS="lee">Set</SPAN><SPAN CLASS="p"> boolean</SPAN><SPAN CLASS="l"> = </SPAN><SPAN CLASS="p">recordset</SPAN><SPAN CLASS="l">.</SPAN><SPAN CLASS="lee">NextRecordset</SPAN></P>
The <SPAN CLASS="lee">NextRecordset</SPAN> method syntax has these parts.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="61pt" VALIGN="TOP"><COL WIDTH="299pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">boolean</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A <SPAN CLASS="lee">Boolean</SPAN> variable. <SPAN CLASS="lee">True</SPAN> indicates the next set of records is available in <SPAN CLASS="p">recordset</SPAN>; <SPAN CLASS="lee">False</SPAN> indicates that no more records are pending and <I>recordset</I> is now empty.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">recordset</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">An existing <SPAN CLASS="lee">Recordset</SPAN> variable to which you want to return pending records.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
In an ODBCDirect workspace, you can open a <SPAN CLASS="lee">Recordset</SPAN> containing more than one <SPAN CLASS="pop">select query</SPAN> in the <SPAN CLASS="narg">source</SPAN> argument of <SPAN CLASS="lee">OpenRecordset</SPAN>, or the <SPAN CLASS="lee">SQL</SPAN> property of a select query <SPAN CLASS="lee">QueryDef</SPAN> object, as in the following example.</P>

<pre><code>SELECT LastName, FirstName FROM Authors
WHERE LastName = 'Smith';
SELECT Title, ISBN FROM Titles
WHERE Pub_ID = 9999</code></pre>
The returned <SPAN CLASS="lee">Recordset</SPAN> will open with the results of the first query. To obtain the result sets of records from subsequent queries, use the <SPAN CLASS="lee">NextRecordset</SPAN> method.</P>
If more records are available (that is, there was another select query in the <SPAN CLASS="lee">OpenRecordset</SPAN> call or in the <SPAN CLASS="lee">SQL</SPAN> property), the records returned from the next query will be loaded into the <SPAN CLASS="lee">Recordset</SPAN>, and <SPAN CLASS="lee">NextRecordset</SPAN> will return <SPAN CLASS="lee">True</SPAN>, indicating that the records are available. When no more records are available (that is,&nbsp;results of the last select query have been loaded into the <SPAN CLASS="lee">Recordset</SPAN>), then <SPAN CLASS="lee">NextRecordset</SPAN> will return <SPAN CLASS="lee">False</SPAN>, and the <SPAN CLASS="lee">Recordset</SPAN> will be empty.</P>
You can also use the <SPAN CLASS="lee">Cancel</SPAN><B> </B>method to flush the contents of a <SPAN CLASS="lee">Recordset</SPAN>. However, <SPAN CLASS="lee">Cancel</SPAN> also flushes any additional records not yet loaded.</P>
Example</P>
This example uses the <SPAN CLASS="eln">NextRecordset</SPAN> method to view the data from a compound SELECT query. The <SPAN CLASS="eln">DefaultCursorDriver</SPAN> property must be set to <SPAN CLASS="eln">dbUseODBCCursor</SPAN> when executing such queries. The <SPAN CLASS="eln">NextRecordset</SPAN> method will return <SPAN CLASS="eln">True</SPAN> even if some or all of the SELECT statements return zero records — it will return <SPAN CLASS="eln">False</SPAN> only after all the individual SQL clauses have been checked.</P>

<pre><code>Sub NextRecordsetX()

    Dim wrkODBC As Workspace
    Dim conPubs As Connection
    Dim rstTemp As Recordset
    Dim intCount As Integer
    Dim booNext As Boolean

    ' Create ODBCDirect Workspace object and open Connection
    ' object. The DefaultCursorDriver setting is required
    ' when using compound SQL statements.
    Set wrkODBC = CreateWorkspace("", _
        "admin", "", dbUseODBC)
    wrkODBC.DefaultCursorDriver = dbUseODBCCursor
    Set conPubs = wrkODBC.OpenConnection("Publishers", , , _
        "ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers")

    ' Construct compound SELECT statement.
    Set rstTemp = conPubs.OpenRecordset("SELECT * " &amp; _
        "FROM authors; " &amp; _
        "SELECT * FROM stores; " &amp; _
        "SELECT * FROM jobs")

    ' Try printing results from each of the three SELECT
    ' statements.
    booNext = True
    intCount = 1
    With rstTemp
        Do While booNext
            Debug.Print "Contents of recordset #" &amp; intCount
            Do While Not .EOF
                Debug.Print , .Fields(0), .Fields(1)
                .MoveNext
            Loop
            booNext = .NextRecordset
            Debug.Print "    rstTemp.NextRecordset = " &amp; _
                booNext
            intCount = intCount + 1
        Loop
    End With

    rstTemp.Close
    conPubs.Close
    wrkODBC.Close

End Sub</code></pre>
Another way to accomplish the same task would be to create a prepared statement containing the compound SQL statement. The <SPAN CLASS="eln">CacheSize</SPAN> property of the <SPAN CLASS="eln">QueryDef</SPAN> object must be set to 1, and the <SPAN CLASS="eln">Recordset</SPAN> object must be forward-only and read-only.</P>

<pre><code>Sub NextRecordsetX2()

    Dim wrkODBC As Workspace
    Dim conPubs As Connection
    Dim qdfTemp As QueryDef
    Dim rstTemp As Recordset
    Dim intCount As Integer
    Dim booNext As Boolean

    ' Create ODBCDirect Workspace object and open Connection
    ' object. The DefaultCursorDriver setting is required
    ' when using compound SQL statements.
    Set wrkODBC = CreateWorkspace("", _
        "admin", "", dbUseODBC)
    wrkODBC.DefaultCursorDriver = dbUseODBCCursor
    Set conPubs = wrkODBC.OpenConnection("Publishers", , , _
        "ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers")

    ' Create a temporary stored procedure with a compound
    ' SELECT statement.
    Set qdfTemp = conPubs.CreateQueryDef("", _
        "SELECT * FROM authors; " &amp; _
        "SELECT * FROM stores; " &amp; _
        "SELECT * FROM jobs")
    ' Set CacheSize and open Recordset object with arguments
    ' that will allow access to multiple recordsets.
    qdfTemp.CacheSize = 1
    Set rstTemp = qdfTemp.OpenRecordset(dbOpenForwardOnly, _
        dbReadOnly)

    ' Try printing results from each of the three SELECT
    ' statements.
    booNext = True
    intCount = 1
    With rstTemp
        Do While booNext
            Debug.Print "Contents of recordset #" &amp; intCount
            Do While Not .EOF
                Debug.Print , .Fields(0), .Fields(1)
                .MoveNext
            Loop
            booNext = .NextRecordset
            Debug.Print "    rstTemp.NextRecordset = " &amp; _
                booNext
            intCount = intCount + 1
        Loop
    End With

    rstTemp.Close
    qdfTemp.Close
    conPubs.Close
    wrkODBC.Close

End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
