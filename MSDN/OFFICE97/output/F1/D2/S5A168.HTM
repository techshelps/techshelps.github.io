<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>KeyDown, KeyUp Events -- Event Procedures</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>KeyDown, KeyUp Events — Event Procedures</H2>Description</P>
To create an <SPAN CLASS="pop">event procedure</SPAN> that runs when the <SPAN CLASS="jump">KeyDown or KeyUp</SPAN> event occurs, set the OnKeyDown<SPAN CLASS="jump"> or </SPAN>OnKeyUp property to <SPAN CLASS="eln">[Event Procedure]</SPAN>, and click the <SPAN CLASS="eln">Build</SPAN> button.</P>
Syntax</P>
<SPAN CLASS="l">Private Sub Form_KeyDown(</SPAN>KeyCode<SPAN CLASS="l"> As Integer, </SPAN>Shift<SPAN CLASS="l"> As Integer)</SPAN></P>
<SPAN CLASS="l">Private Sub </SPAN><SPAN CLASS="p">controlname</SPAN><SPAN CLASS="l">_KeyDown(</SPAN>KeyCode<SPAN CLASS="l"> As Integer, </SPAN>Shift<SPAN CLASS="l"> As Integer)</SPAN></P>
<SPAN CLASS="l">Private Sub Form_KeyUp(</SPAN>KeyCode<SPAN CLASS="l"> As Integer, </SPAN>Shift<SPAN CLASS="l"> As Integer)</SPAN></P>
<SPAN CLASS="l">Private Sub </SPAN><SPAN CLASS="p">controlname</SPAN><SPAN CLASS="l">_KeyUp(</SPAN>KeyCode<SPAN CLASS="l"> As Integer, </SPAN>Shift<SPAN CLASS="l"> As Integer)</SPAN></P>
The KeyDown and KeyUp events have the following arguments.</P>

<TABLE COLS="4" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="87pt" VALIGN="TOP"><COL WIDTH="73pt" VALIGN="TOP"><COL WIDTH="198pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</P></TD><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">controlname</SPAN></P></TD><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The name of the <SPAN CLASS="pop">control</SPAN> whose KeyUp or KeyDown event procedure you want to run.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">KeyCode</P></TD><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A key code, such as <SPAN CLASS="eln">vbKeyF1</SPAN> (the <SPAN CLASS="kn">F1</SPAN> key) or <SPAN CLASS="eln">vbKeyHome</SPAN> (the <SPAN CLASS="kn">HOME</SPAN> key). To specify key codes, use the <SPAN CLASS="pop">intrinsic constants</SPAN> shown in the <SPAN CLASS="jump">Object Browser</SPAN>. You can prevent an object from receiving a keystroke by setting KeyCode to 0.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Shift</P></TD><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The state of the <SPAN CLASS="kn">SHIFT</SPAN>, <SPAN CLASS="kn">CTRL</SPAN>, and <SPAN CLASS="kn">ALT</SPAN> keys at the time of the event. If you need to test for the Shift argument, you can <SPAN CLASS="jump">use one of the following intrinsic constants as bit masks</SPAN>:</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"> </P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">acShiftMask</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The bit mask for the <SPAN CLASS="kn">SHIFT</SPAN> key.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">acCtrlMask</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The bit mask for the <SPAN CLASS="kn">CTRL</SPAN> key.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">acAltMask</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The bit mask for the <SPAN CLASS="kn">ALT</SPAN> key.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
You test for a condition by first assigning each result to a temporary integer variable and then comparing the Shift argument to an intrinsic constant. Use the And operator with the Shift argument to test whether the condition is greater than 0, indicating that the <SPAN CLASS="kn">SHIFT</SPAN>, <SPAN CLASS="kn">CTRL</SPAN>, or <SPAN CLASS="kn">ALT</SPAN> key was pressed, as in the following example:</P>

<pre><code>ShiftDown = (Shift And acShiftMask) &gt; 0</code></pre>
In an event procedure, you can test for any combination of conditions, as in the following example:</P>

<pre><code>If ShiftDown And CtrlDown Then
.            ' Do this if SHIFT and CTRL keys are pressed.
.
.
End If</code></pre>
You can use the KeyDown and KeyUp event procedures to interpret the uppercase and lowercase version of each character by testing for both the KeyCode argument and the Shift argument. The KeyCode argument indicates the physical key pressed (thus, A and a are considered the same key), and the Shift argument indicates the state of <SPAN CLASS="kn">SHIFT+</SPAN><SPAN CLASS="p">key</SPAN> and returns either A or a.</P>
Use the KeyDown and KeyUp event procedures for <SPAN CLASS="pop">keyboard handlers</SPAN> if you need to respond to both the pressing and releasing of a key.</P>
You can respond to specific keys pressed in a form, regardless of which control has the focus. For example, you may want the key combination <SPAN CLASS="kn">CTRL+X</SPAN> to always perform the same action on a form. To make sure a form receives all keyboard events, even those that occur for controls, before they occur for the controls, set the KeyPreview property of the form to Yes. With this property setting, all keyboard events occur first for the form, and then for the control that has the focus. You can respond to specific keystrokes in the form's KeyDown, <SPAN CLASS="jump">KeyPress</SPAN> and KeyUp events. You can prevent a control from receiving keystrokes you've responded to, and prevent the keyboard events from occurring for the control, by setting the KeyCode argument to 0 for both the KeyDown and KeyUp events, and setting the KeyAscii argument to 0 for the KeyPress event (if the key is an <SPAN CLASS="pop">ANSI</SPAN> key). You must set all three arguments to 0 if you don't want the control to receive the keystrokes.</P>
You can use the arguments for the KeyDown, KeyPress, and KeyUp events, in conjunction with the arguments for the <SPAN CLASS="jump">MouseDown</SPAN>, <SPAN CLASS="jump">MouseUp</SPAN>, and <SPAN CLASS="jump">MouseMove</SPAN> events, to make your application work smoothly for both keyboard and mouse users.</P>
You can't cancel the KeyDown or KeyUp event.</P>
See Also</P>
KeyDown, KeyUp events&nbsp;— macros.</P>
Example</P>
The following example determines whether you have pressed the <SPAN CLASS="kn">SHIFT</SPAN>, <SPAN CLASS="kn">CTRL</SPAN>, or <SPAN CLASS="kn">ALT</SPAN> key.</P>
To try the example, add the following event procedure to a form containing a text box named KeyHandler.</P>

<pre><code>Private Sub KeyHandler_KeyDown(KeyCode As Integer, Shift As Integer)
    Dim intShiftDown As Integer, intAltDown As Integer
    Dim intCtrlDown As Integer

    ' Use bit masks to determine which key was pressed.
    intShiftDown = (Shift And acShiftMask) &gt; 0
    intAltDown = (Shift And acAltMask) &gt; 0
    intCtrlDown = (Shift And acCtrlMask) &gt; 0
    ' Display message telling user which key was pressed.
    If intShiftDown Then MsgBox "You pressed the SHIFT key."
    If intAltDown Then MsgBox "You pressed the ALT key."
    If intCtrlDown Then MsgBox "You pressed the CTRL key."
End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
