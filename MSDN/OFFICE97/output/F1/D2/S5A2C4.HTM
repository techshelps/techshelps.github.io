<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MakeReplica Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>MakeReplica Method</H1>Applies To</P>
<SPAN CLASS="eln">Database</SPAN> object.</P>
Description</P>
Makes a new <SPAN CLASS="pop">replica</SPAN> from another database replica (<SPAN CLASS="pop">Microsoft Jet workspaces</SPAN> only).</P>
Syntax</P>
<SPAN CLASS="p">database</SPAN><SPAN CLASS="eln">.MakeReplica</SPAN> <SPAN CLASS="p">replica</SPAN><SPAN CLASS="eln">,</SPAN> <SPAN CLASS="p">description</SPAN><SPAN CLASS="p">,</SPAN><SPAN CLASS="p"> options</SPAN></P>
The <SPAN CLASS="eln">MakeReplica</SPAN> method syntax has the following parts.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="121pt" VALIGN="TOP"><COL WIDTH="239pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">database</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">An <SPAN CLASS="pop">object variable</SPAN> that represents an existing Database that is&nbsp;a replica.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">replica</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A <SPAN CLASS="eln">String</SPAN> that is the path and file name of the new replica. If&nbsp;<SPAN CLASS="p">replica</SPAN> is an existing file name, then an error occurs.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">description</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A <SPAN CLASS="eln">String</SPAN> that describes the replica that you are creating.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">options</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. A constant or combination of constants that specifies characteristics of the replica you are creating, as&nbsp;specified in Settings. </P></TD></TR></TBODY></TABLE>
<BR></P>Settings</P>
You can use one or more of the following constants in the <SPAN CLASS="p">options</SPAN> argument.</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="121pt" VALIGN="TOP"><COL WIDTH="238pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">  </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbRepMakePartial</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Creates a <SPAN CLASS="pop">partial replica</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbRepMakeReadOnly</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Prevents users from modifying the replicable objects of the new replica; however, when you synchronize the new replica with another member of the <SPAN CLASS="pop">replica set</SPAN>, design and data changes will be propagated to the new replica.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
A newly created partial replica will have all ReplicaFilter properties set to <SPAN CLASS="eln">False</SPAN>, meaning that no data will be in the tables.</P>
Example</P>
This example uses the <SPAN CLASS="eln">NextRecordset</SPAN> method to view the data from a compound SELECT query. The <SPAN CLASS="eln">DefaultCursorDriver</SPAN> property must be set to <SPAN CLASS="eln">dbUseODBCCursor</SPAN> when executing such queries. The <SPAN CLASS="eln">NextRecordset</SPAN> method will return <SPAN CLASS="eln">True</SPAN> even if some or all of the SELECT statements return zero records — it will return <SPAN CLASS="eln">False</SPAN> only after all the individual SQL clauses have been checked.</P>

<pre><code>Sub NextRecordsetX()

    Dim wrkODBC As Workspace
    Dim conPubs As Connection
    Dim rstTemp As Recordset
    Dim intCount As Integer
    Dim booNext As Boolean

    ' Create ODBCDirect Workspace object and open Connection
    ' object. The DefaultCursorDriver setting is required
    ' when using compound SQL statements.
    Set wrkODBC = CreateWorkspace("", _
        "admin", "", dbUseODBC)
    wrkODBC.DefaultCursorDriver = dbUseODBCCursor
    Set conPubs = wrkODBC.OpenConnection("Publishers", , , _
        "ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers")

    ' Construct compound SELECT statement.
    Set rstTemp = conPubs.OpenRecordset("SELECT * " &amp; _
        "FROM authors; " &amp; _
        "SELECT * FROM stores; " &amp; _
        "SELECT * FROM jobs")

    ' Try printing results from each of the three SELECT
    ' statements.
    booNext = True
    intCount = 1
    With rstTemp
        Do While booNext
            Debug.Print "Contents of recordset #" &amp; intCount
            Do While Not .EOF
                Debug.Print , .Fields(0), .Fields(1)
                .MoveNext
            Loop
            booNext = .NextRecordset
            Debug.Print "    rstTemp.NextRecordset = " &amp; _
                booNext
            intCount = intCount + 1
        Loop
    End With

    rstTemp.Close
    conPubs.Close
    wrkODBC.Close

End Sub</code></pre>
Another way to accomplish the same task would be to create a prepared statement containing the compound SQL statement. The <SPAN CLASS="eln">CacheSize</SPAN> property of the <SPAN CLASS="eln">QueryDef</SPAN> object must be set to 1, and the <SPAN CLASS="eln">Recordset</SPAN> object must be forward-only and read-only.</P>

<pre><code>Sub NextRecordsetX2()

    Dim wrkODBC As Workspace
    Dim conPubs As Connection
    Dim qdfTemp As QueryDef
    Dim rstTemp As Recordset
    Dim intCount As Integer
    Dim booNext As Boolean

    ' Create ODBCDirect Workspace object and open Connection
    ' object. The DefaultCursorDriver setting is required
    ' when using compound SQL statements.
    Set wrkODBC = CreateWorkspace("", _
        "admin", "", dbUseODBC)
    wrkODBC.DefaultCursorDriver = dbUseODBCCursor
    Set conPubs = wrkODBC.OpenConnection("Publishers", , , _
        "ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers")

    ' Create a temporary stored procedure with a compound
    ' SELECT statement.
    Set qdfTemp = conPubs.CreateQueryDef("", _
        "SELECT * FROM authors; " &amp; _
        "SELECT * FROM stores; " &amp; _
        "SELECT * FROM jobs")
    ' Set CacheSize and open Recordset object with arguments
    ' that will allow access to multiple recordsets.
    qdfTemp.CacheSize = 1
    Set rstTemp = qdfTemp.OpenRecordset(dbOpenForwardOnly, _
        dbReadOnly)

    ' Try printing results from each of the three SELECT
    ' statements.
    booNext = True
    intCount = 1
    With rstTemp
        Do While booNext
            Debug.Print "Contents of recordset #" &amp; intCount
            Do While Not .EOF
                Debug.Print , .Fields(0), .Fields(1)
                .MoveNext
            Loop
            booNext = .NextRecordset
            Debug.Print "    rstTemp.NextRecordset = " &amp; _
                booNext
            intCount = intCount + 1
        Loop
    End With

    rstTemp.Close
    qdfTemp.Close
    conPubs.Close
    wrkODBC.Close

End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
