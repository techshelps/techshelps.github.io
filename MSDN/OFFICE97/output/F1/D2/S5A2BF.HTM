<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LastModified Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>LastModified Property</H1>Applies To</P>
Dynamic-Type <SPAN CLASS="eln">Recordset</SPAN> object, Dynaset-Type <SPAN CLASS="eln">Recordset</SPAN> object, <SPAN CLASS="eln">Recordset</SPAN> object,&nbsp;Snapshot-Type <SPAN CLASS="eln">Recordset</SPAN> object, Table-Type <SPAN CLASS="eln">Recordset</SPAN> object.</P>
Description</P>
Returns a <SPAN CLASS="pop">bookmark</SPAN> indicating the most recently added or changed record.</P>
Return Values</P>
The return value is a <SPAN CLASS="eln">Variant</SPAN> array of <SPAN CLASS="pop">Byte</SPAN> data.</P>
Remarks</P>
You can use the <SPAN CLASS="eln">LastModified</SPAN> property to move to the most recently added or updated record. Use the <SPAN CLASS="eln">LastModified</SPAN> property with table- and dynaset-type <SPAN CLASS="eln">Recordset</SPAN> objects. A record must be added or modified in the <SPAN CLASS="eln">Recordset</SPAN> object itself&nbsp;in order for the <SPAN CLASS="eln">LastModified</SPAN> property to have a value.</P>
See Also</P>
<SPAN CLASS="eln">Bookmark</SPAN> property, <SPAN CLASS="eln">Bookmarkable</SPAN> property, <SPAN CLASS="eln">DateCreated</SPAN>, <SPAN CLASS="eln">LastUpdated</SPAN> properties.</P>
Specifics (Microsoft Access)</P>
When you use the <SPAN CLASS="eln">LastModified</SPAN> property in a Microsoft Access module, you must include an <SPAN CLASS="eln">Option Compare Binary</SPAN> statement in the <SPAN CLASS="pop">Declarations section</SPAN> of the module. The <SPAN CLASS="pop">bookmark</SPAN> returned by the <SPAN CLASS="eln">LastModified</SPAN> property is a <SPAN CLASS="eln">Variant</SPAN> array of Byte data, so the <SPAN CLASS="pop">string comparison</SPAN> method for the module must be binary. If a bookmark is evaluated with a text-based string comparison method, such as the <SPAN CLASS="eln">Option Compare Text</SPAN> statement or the default setting for the <SPAN CLASS="eln">Option Compare Database</SPAN> statement, the current record may be set to an incorrect record.</P>
Example</P>
This example uses the <SPAN CLASS="eln">LastModified</SPAN> property to move the <SPAN CLASS="pop">current record</SPAN> pointer to both a record that has been modified and a newly created record.</P>

<pre><code>Sub LastModifiedX()

    Dim dbsNorthwind As Database
    Dim rstEmployees As Recordset
    Dim strFirst As String
    Dim strLast As String

    Set dbsNorthwind = OpenDatabase("Northwind.mdb")
    Set rstEmployees = _
        dbsNorthwind.OpenRecordset("Employees", _
        dbOpenDynaset)

    With rstEmployees
        ' Store current data.
        strFirst = !FirstName
        strLast = !LastName
        ' Change data in current record.
        .Edit
        !FirstName = "Julie"
        !LastName = "Warren"
        .Update
        ' Move current record pointer to the most recently
        ' changed or added record.
        .Bookmark = .LastModified
        Debug.Print _
            "Data in LastModified record after Edit: " &amp; _
            !FirstName &amp; " " &amp; !LastName

        ' Restore original data because this is a demonstration.
        .Edit
        !FirstName = strFirst
        !LastName = strLast
        .Update

        ' Add new record.
        .AddNew
        !FirstName = "Roger"
        !LastName = "Harui"
        .Update
        ' Move current record pointer to the most recently
        ' changed or added record.
        .Bookmark = .LastModified
        Debug.Print _
            "Data in LastModified record after AddNew: " &amp; _
            !FirstName &amp; " " &amp; !LastName

        ' Delete new record because this is a demonstration.
        .Delete
        .Close
    End With

    dbsNorthwind.Close

End Sub</code></pre>
Example (Microsoft Access)</P>
The following example determines the most recently modified record in a recordset and sets a bookmark for that record:</P>

<pre><code>Sub LastChangedRecord()
    Dim dbs As Database, rst As Recordset, varBook As Variant

    ' Return reference to current database.
    Set dbs = CurrentDb
    ' Create dynaset-type Recordset object.
    Set rst = dbs.OpenRecordset("SELECT * FROM Orders " &amp; _
        "ORDER BY ShipCountry;")
    With rst
        .FindFirst "ShipCountry = 'UK'"
        ' Alter record and save changes.
        .Edit
        !ShipCountry = "USA"
        .Update
    End With
    ' Check to see if recordset supports bookmarks.
    If rst.Bookmarkable Then
        ' Set bookmark to most recently modified record.
        varBook = rst.LastModified
        ' Set currency to last modified record.
        rst.Bookmark = varBook
    End If
    rst.Close
    Set dbs = Nothing
End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
