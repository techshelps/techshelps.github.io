<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>First, Last Functions</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>First, Last Functions</H1>Description</P>
Return a field value from the first or last record in the result set returned by a query.</P>
Syntax</P>
<SPAN CLASS="eln">First(</SPAN><SPAN CLASS="p">expr</SPAN><SPAN CLASS="eln">)</SPAN></P>
<SPAN CLASS="eln">Last(</SPAN><SPAN CLASS="p">expr</SPAN><SPAN CLASS="eln">)</SPAN></P>
The <SPAN CLASS="p">expr</SPAN> placeholder represents a <SPAN CLASS="pop">string expression</SPAN> identifying the field that contains the data you want to use or an expression that performs a calculation using the data in that field. Operands in <SPAN CLASS="p">expr</SPAN> can include the name of a table field, a constant, or a function (which can be either intrinsic or user-defined but not one of the other <SPAN CLASS="pop">SQL</SPAN> aggregate functions).</P>
Remarks</P>
The <SPAN CLASS="eln">First</SPAN> and <SPAN CLASS="eln">Last</SPAN> functions are analogous to the <SPAN CLASS="eln">MoveFirst</SPAN> and <SPAN CLASS="eln">MoveLast</SPAN> methods of a <SPAN CLASS="pop">DAO</SPAN> <SPAN CLASS="eln">Recordset</SPAN> object. They simply return the value of a specified field in the first or last record, respectively, of the result set returned by a query. Because records are usually returned in no particular order (unless the query includes an <SPAN CLASS="jump">ORDER BY</SPAN> clause), the records returned by these functions will be arbitrary.</P>
See Also</P>
<B>MoveFirst</B>, <B>MoveLast</B>, <B>MoveNext</B>, <SPAN CLASS="eln">MovePrevious</SPAN> methods ("DAO Language Reference"), <SPAN CLASS="eln">Recordset</SPAN> object ("DAO Language Reference"), SELECT statement.</P>
Specifics (Microsoft Access)</P>
In Microsoft Access, you can use the <SPAN CLASS="eln">First</SPAN> and <SPAN CLASS="eln">Last</SPAN> functions in the <SPAN CLASS="pop">query design grid</SPAN>, in an <SPAN CLASS="pop">SQL</SPAN> statement in <SPAN CLASS="pop">SQL view</SPAN> of the <SPAN CLASS="pop">Query window</SPAN>, or in an SQL statement within Visual Basic code. You can also use the <SPAN CLASS="eln">First</SPAN> and <SPAN CLASS="eln">Last</SPAN> functions in a <SPAN CLASS="pop">calculated control</SPAN> on a form or report.</P>
The <SPAN CLASS="eln">First</SPAN> and <SPAN CLASS="eln">Last</SPAN> functions are most useful in calculated controls on a report. For example, if you have an Order report that is grouped on a ShipCountry field and sorted on an OrderDate field, you can use the <SPAN CLASS="eln">First</SPAN> and <SPAN CLASS="eln">Last</SPAN> functions in calculated controls to show the range of earliest to latest order dates for each grouping. To group on the ShipCountry field, click the <SPAN CLASS="eln">Sorting And Grouping</SPAN> button on the <SPAN CLASS="eln">Report Design</SPAN> <SPAN CLASS="pop">toolbar</SPAN>. Choose ShipCountry in the <SPAN CLASS="eln">Field/Expression</SPAN> column, and set the <SPAN CLASS="eln">GroupHeader</SPAN> and <SPAN CLASS="eln">GroupFooter</SPAN> properties to Yes. In <SPAN CLASS="pop">Design view</SPAN>, create two new text boxes in the ShipCountry footer, and set the <SPAN CLASS="eln">ControlSource</SPAN> property for both to the following expressions:</P>

<pre><code>=First([OrderDate])
=Last([OrderDate])</code></pre>
When you switch to <SPAN CLASS="pop">Print Preview</SPAN>, you will see the first and last order dates for each group of orders.</P>
<SPAN CLASS="nh">Note</SPAN>&nbsp;&nbsp;&nbsp;  If you want to return the first or last record in a set of records in Microsoft Access&nbsp;97, you&nbsp;should create a query sorted as either ascending or descending and set the <SPAN CLASS="eln">TopValues</SPAN> property to 1. For more information, see the <SPAN CLASS="eln">TopValues</SPAN> property topic. From Visual Basic, you can also create a sorted result set of the query, and use the DAO <SPAN CLASS="eln">MoveFirst</SPAN> or <SPAN CLASS="eln">MoveLast</SPAN> method to return the first or last record in a set of records.</P>
Example</P>
This example uses the Employees table to return the values from the LastName field of the first and last records returned from the table.</P>
This example calls the EnumFields procedure, which you can find in the SELECT statement example.</P>

<pre><code>Sub FirstLastX1()

    Dim dbs As Database, rst As Recordset

    ' Modify this line to include the path to Northwind
    ' on your computer.
    Set dbs = OpenDatabase("Northwind.mdb")
    
    ' Return the values from the LastName field of the 
    ' first and last records returned from the table.
    Set rst = dbs.OpenRecordset("SELECT " _
        &amp; "First(LastName) as First, " _
        &amp; "Last(LastName) as Last FROM Employees;")
    
    ' Populate the Recordset.
    rst.MoveLast
    
    ' Call EnumFields to print the contents of the 
    ' Recordset. Pass the Recordset object and desired
    ' field width.
    EnumFields rst, 12

    dbs.Close

End Sub</code></pre>
The next example compares using the <B>First</B> and <B>Last</B> functions with simply using the <SPAN CLASS="eln">Min</SPAN> and <SPAN CLASS="eln">Max</SPAN> functions to find the earliest and latest birth dates of Employees.</P>

<pre><code>Sub FirstLastX2()

    Dim dbs As Database, rst As Recordset

    ' Modify this line to include the path to Northwind
    ' on your computer.
    Set dbs = OpenDatabase("Northwind.mdb")
    
    ' Find the earliest and latest birth dates of
    ' Employees.
    Set rst = dbs.OpenRecordset("SELECT " _
        &amp; "First(BirthDate) as FirstBD, " _
        &amp; "Last(BirthDate) as LastBD FROM Employees;")
    
    ' Populate the Recordset.
    rst.MoveLast
    
    ' Call EnumFields to print the contents of the 
    ' Recordset. Pass the Recordset object and desired
    ' field width.
    EnumFields rst, 12
    
    Debug.Print

    ' Find the earliest and latest birth dates of
    ' Employees.
    Set rst = dbs.OpenRecordset("SELECT " _<BR>        &amp; "Min(BirthDate) as MinBD," _
        &amp; "Max(BirthDate) as MaxBD FROM Employees;")
    
    ' Populate the Recordset.
    rst.MoveLast
    
    ' Call EnumFields to print the contents of the 
    ' Recordset. Pass the Recordset object and desired
    ' field width.
    EnumFields rst, 12

    dbs.Close

End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
