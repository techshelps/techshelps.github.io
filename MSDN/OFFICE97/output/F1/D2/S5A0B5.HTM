<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DCount Function</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>DCount Function</H2>Description</P>
You can use the <SPAN CLASS="eln">DCount</SPAN> function to determine the number of records that are in a specified set of records (a <SPAN CLASS="pop">domain</SPAN>). Use the <SPAN CLASS="eln">DCount</SPAN> function in Visual Basic, a <SPAN CLASS="pop">macro</SPAN>, a query expression, or a <SPAN CLASS="pop">calculated control</SPAN>.</P>
For example, you could use the <SPAN CLASS="eln">DCount</SPAN> function in a module to return the number of records in an Orders table that correspond to orders placed on a particular date.</P>
Syntax</P>
<SPAN CLASS="l">DCount(</SPAN><SPAN CLASS="p">expr</SPAN><SPAN CLASS="l">, </SPAN><SPAN CLASS="p">domain</SPAN>[<SPAN CLASS="l">, </SPAN><SPAN CLASS="p">criteria</SPAN>]<SPAN CLASS="l">)</SPAN></P>
The <SPAN CLASS="eln">DCount</SPAN> function has the following arguments.</P>

<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="269pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">expr</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">An expression that identifies the field for which you want to count records. It can be a <SPAN CLASS="pop">string expression</SPAN> identifying a field in a table or query, or it can be an expression that performs a <SPAN CLASS="jump">calculation on data in that field</SPAN>. In <SPAN CLASS="p">expr</SPAN>, you can include the name of a field in a table, a control on a form, a constant, or a function. If <SPAN CLASS="p">expr</SPAN>  includes a function, it can be either built-in or user-defined, but not another domain aggregate or <SPAN CLASS="jump">SQL aggregate</SPAN> function.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">domain</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A string expression identifying the set of records that constitutes the domain. It can be a table name or a query name.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">criteria</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">An optional string expression used to restrict the range of data on which the <SPAN CLASS="eln">DCount</SPAN> function is performed. For example, <SPAN CLASS="p">criteria</SPAN> is often equivalent to the WHERE clause in an SQL expression, without the word WHERE. If <SPAN CLASS="p">criteria</SPAN> is omitted, the <SPAN CLASS="eln">DCount</SPAN> function evaluates <SPAN CLASS="p">expr</SPAN>  against the entire domain. Any field that is included in <SPAN CLASS="p">criteria</SPAN> must also be a field in <SPAN CLASS="p">domain</SPAN>; otherwise the <SPAN CLASS="eln">DCount</SPAN> function returns a Null.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
Use the <SPAN CLASS="eln">DCount</SPAN> function to count the number of records in a domain when you don't need to know their particular values. Although the <SPAN CLASS="p">expr</SPAN>  argument can perform a calculation on a field, the <SPAN CLASS="eln">DCount</SPAN> function simply tallies the number of records. The value of any calculation performed by <SPAN CLASS="p">expr</SPAN>  is unavailable.</P>
Whether you use the <SPAN CLASS="eln">DCount</SPAN> function in a macro or module, a query expression, or a calculated control, you must construct the <SPAN CLASS="p">criteria</SPAN> argument carefully to ensure that it will be evaluated correctly.</P>
Use the <SPAN CLASS="eln">DCount</SPAN> function in a calculated control when you need to specify criteria to restrict the range of data on which the function is performed. For example, to display the number of orders to be shipped to California, set the ControlSource property of a text box to the following expression:</P>

<pre><code>=DCount("[OrderID]", "Orders", "[ShipRegion] = 'CA'")</code></pre>
If you simply want to count all records in <SPAN CLASS="p">domain</SPAN> without specifying any restrictions, use the Count function.</P>
<SPAN CLASS="nh">Tip</SPAN>   The <SPAN CLASS="eln">Count</SPAN> function has been optimized to speed counting of records in queries. Use the <SPAN CLASS="eln">Count</SPAN> function in a query expression instead of the <SPAN CLASS="eln">DCount</SPAN> function, and set optional criteria to enforce any restrictions on the results. Use the <SPAN CLASS="eln">DCount</SPAN> function when you must count records in a domain from within a code module or macro, or in a calculated control.</P>
You can use the <SPAN CLASS="eln">DCount</SPAN> function to count the number of records containing a particular field that isn't in the record source on which your form or report is based. For example, you could display the number of orders in the Orders table in a calculated control on a form based on the Products table.</P>
The <SPAN CLASS="eln">DCount</SPAN> function doesn't count records that contain <SPAN CLASS="eln">Null</SPAN> values in the field referenced by <SPAN CLASS="p">expr</SPAN>, unless <SPAN CLASS="p">expr</SPAN>  is the asterisk (*) <SPAN CLASS="jump">wildcard character</SPAN>. If you use an asterisk, the <SPAN CLASS="eln">DCount</SPAN> function calculates the total number of records, including those that contain <SPAN CLASS="eln">Null</SPAN> fields. The following example calculates the number of records in an Orders table.</P>

<pre><code>intX = DCount("*", "Orders")</code></pre>
If <SPAN CLASS="p">domain</SPAN> is a table with a <SPAN CLASS="pop">primary key</SPAN>, you can also count the total number of records by setting <SPAN CLASS="p">expr</SPAN>  to the primary key field, since there will never be a <SPAN CLASS="eln">Null</SPAN> in the primary key field.</P>
If <SPAN CLASS="p">expr</SPAN>  identifies multiple fields, separate the field names with a <SPAN CLASS="jump">concatenation operator</SPAN>, either an ampersand (&amp;) or the addition operator (+). If you use an ampersand to separate the fields, the <SPAN CLASS="eln">DCount</SPAN> function returns the number of records containing data in any of the listed fields. If you use the addition operator, the <SPAN CLASS="eln">DCount</SPAN> function returns only the number of records containing data in all of the listed fields. The following example demonstrates the effects of each operator when used with a field that contains data in all records (ShipName) and a field that contains no data (ShipRegion).</P>

<pre><code>intW = DCount("[ShipName]", "Orders")                ' Returns 831.
intX = DCount("[ShipRegion]", "Orders")            ' Returns 323.
intY = DCount("[ShipName] + [ShipRegion]", "Orders")        ' Returns 323.
intZ = DCount("[ShipName] &amp; [ShipRegion]", "Orders")        ' Returns 831.</code></pre>
<SPAN CLASS="nh">Note</SPAN>   The ampersand is the preferred operator for performing string concatenation. You should avoid using the addition operator for anything other than numeric addition, unless you specifically wish to propagate <B>Nulls</B> through an expression.</P>
Unsaved changes to records in <SPAN CLASS="p">domain</SPAN> aren't included when you use this function. If you want the <SPAN CLASS="eln">DCount</SPAN> function to be based on the changed values, you must first save the changes by clicking <SPAN CLASS="eln">Save Record</SPAN> on the <SPAN CLASS="eln">File</SPAN> menu, moving the focus to another record, or by using the Update method.</P>
See Also</P>
<SPAN CLASS="eln">Count</SPAN> function ("SQL Language Reference"), <SPAN CLASS="eln">DAvg</SPAN> function, <SPAN CLASS="eln">DSum</SPAN> function.</P>
Example</P>
The following example returns the number of orders shipped to the United Kingdom after January 1, 1995. The domain is an Orders table. The <SPAN CLASS="p">criteria</SPAN> argument restricts the resulting set of records to those for which ShipCountry equals UK and ShippedDate is greater than 1-1-95.</P>

<pre><code>intX = DCount("[ShippedDate]", "Orders", _
    "[ShipCountry] = 'UK' AND [ShippedDate] &gt; #1-1-95#")</code></pre>
In the next example, the <SPAN CLASS="p">criteria</SPAN> argument includes the current value of a combo box called ShipCountry. The values in the ShipCountry combo box come from the field ShipCountry in an Orders table. Note that the reference to the control isn't included in the quotation marks that denote the strings. This ensures that each time the <SPAN CLASS="eln">DCount</SPAN> function is called, Microsoft Access will obtain the current value from the control.</P>

<pre><code>intX = DCount("[ShippedDate]", "Orders", "[ShipCountry] = '" _
    &amp; Forms!Orders![ShipCountry] &amp; "'AND [ShippedDate] &gt; #1-1-95#")</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
