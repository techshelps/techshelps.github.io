<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CompactDatabase Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>CompactDatabase Method</H2>Applies To</P>
<SPAN CLASS="eln">DBEngine</SPAN> object.</P>
Description</P>
Copies and compacts a closed database, and gives you the option of changing its version, collating order, and encryption. (<SPAN CLASS="pop">Microsoft&nbsp;Jet workspaces</SPAN> only).</P>
Syntax</P>
<SPAN CLASS="eln">DBEngine.CompactDatabase </SPAN><SPAN CLASS="p">olddb</SPAN><SPAN CLASS="l">,</SPAN> <SPAN CLASS="p">newdb</SPAN><SPAN CLASS="l">,</SPAN> <SPAN CLASS="p">locale</SPAN><SPAN CLASS="l">,</SPAN> <SPAN CLASS="p">options</SPAN><SPAN CLASS="l">,</SPAN> <SPAN CLASS="p">password</SPAN></P>
The <SPAN CLASS="eln">CompactDatabase</SPAN> method syntax has these parts.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="61pt" VALIGN="TOP"><COL WIDTH="299pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">olddb</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A String that identifies an existing, closed database. It can be a full path and file name, such as <SPAN CLASS="ctt">"C:\db1.mdb"</SPAN>. If the file name has an extension, you must specify it. If your network supports it, you can also specify a network path, such as <SPAN CLASS="ctt">"\\server1\share1\dir1\db1.mdb"</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">newdb</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A <SPAN CLASS="eln">String</SPAN> that is the file name (and path) of the compacted database that you're creating. You can also specify a network path. You can't use the <SPAN CLASS="p">newdb</SPAN> argument to specify the same database file as <SPAN CLASS="p">olddb</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">locale</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. A Variant that is a <SPAN CLASS="pop">string expression</SPAN> that specifies a collating order for creating <SPAN CLASS="p">newdb</SPAN>, as specified in Settings. If you omit this argument, the locale of <SPAN CLASS="p">newdb</SPAN> is the same as <SPAN CLASS="p">olddb</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">You can also create a password for <I>newdb</I> by concatenating the password string (starting with <SPAN CLASS="ctt">";pwd="</SPAN>) with a constant in the <I>locale</I> argument, like this:</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="ctt">dbLangSpanish &amp; ";pwd=NewPassword"</SPAN></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">If you want to use the same <I>locale</I> as <I>olddb</I> (the default value), but specify a new password, simply enter a password string for <I>locale</I>:</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="ctt">";pwd=NewPassword"</SPAN></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">options</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. A constant or combination of constants that indicates one or more options, as specified in Settings. You can combine options by summing the corresponding constants.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">password</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. A <SPAN CLASS="eln">Variant</SPAN> that is a string expression containing a password, if the database is password protected. The string <SPAN CLASS="ctt">";pwd="</SPAN> must precede the actual password. If you include a password setting in <I>locale</I>, this setting is ignored.</P></TD></TR></TBODY></TABLE>
<BR></P>Settings</P>
You can use one of the following constants for the <SPAN CLASS="p">locale</SPAN> argument to specify the <SPAN CLASS="eln">CollatingOrder</SPAN> property for string comparisons of text.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="146pt" VALIGN="TOP"><COL WIDTH="214pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Collating order</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangGeneral</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">English, German, French, Portuguese, Italian, and Modern Spanish</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangArabic</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Arabic</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangChineseSimplified</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Simplified Chinese</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangChineseTraditional</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Traditional Chinese</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangCyrillic</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Russian</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangCzech</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Czech</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangDutch</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Dutch</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangGreek</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Greek</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangHebrew</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Hebrew</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangHungarian</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Hungarian</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangIcelandic</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Icelandic</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangJapanese</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Japanese</P></TD></TR></TBODY></TABLE>
<BR></P><I>(continued)</I></P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="146pt" VALIGN="TOP"><COL WIDTH="214pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Collating order</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangKorean</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Korean</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangNordic</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Nordic languages (Microsoft&nbsp;Jet database engine version 1.0 only)</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangNorwDan</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Norwegian and Danish</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangPolish</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Polish</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangSlovenian</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Slovenian</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangSpanish</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Traditional Spanish</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangSwedFin</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Swedish and Finnish</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangThai</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Thai</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbLangTurkish</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Turkish</P></TD></TR></TBODY></TABLE>
<BR></P>You can use one of the following constants in the <SPAN CLASS="p">options</SPAN> argument to specify whether to encrypt or to decrypt the database while it's compacted.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="146pt" VALIGN="TOP"><COL WIDTH="214pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbEncrypt</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Encrypt the database while compacting.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbDecrypt</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Decrypt the database while compacting.</P></TD></TR></TBODY></TABLE>
<BR></P>If you omit an encryption constant or if you include both <SPAN CLASS="eln">dbDecrypt</SPAN> and <SPAN CLASS="eln">dbEncrypt</SPAN>, <SPAN CLASS="p">newdb</SPAN> will have the same encryption as <SPAN CLASS="p">olddb.</SPAN></P>
You can use one of the following constants in the <SPAN CLASS="p">options</SPAN> argument to specify the version of the data format for the compacted database. This constant affects only the version of the data format of <SPAN CLASS="p">newdb</SPAN> and doesn't affect the version of any Microsoft&nbsp;Access-defined objects, such as forms and reports.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="146pt" VALIGN="TOP"><COL WIDTH="214pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbVersion10</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Creates a database that uses the <SPAN CLASS="pop">Microsoft&nbsp;Jet database engine</SPAN> version 1.0 file format while compacting.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbVersion11</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Creates a database that uses the Microsoft&nbsp;Jet database engine version 1.1 file format while compacting.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbVersion20</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Creates a database that uses the Microsoft&nbsp;Jet database engine version 2.0 file format while compacting.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbVersion30</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Creates a database that uses the Microsoft&nbsp;Jet database engine version 3.0 file format (compatible with version&nbsp;3.5) while compacting.</P></TD></TR></TBODY></TABLE>
<BR></P>You can specify only one version constant. If you omit a version constant, <SPAN CLASS="p">newdb</SPAN> will have the same version as <SPAN CLASS="p">olddb</SPAN>. You can compact <SPAN CLASS="p">newdb</SPAN> only to a version that is the same or later than that of <SPAN CLASS="p">olddb</SPAN>.</P>
Remarks</P>
As you change data in a database, the database file can become fragmented and use more disk space than is necessary. Periodically, you can use the <SPAN CLASS="eln">CompactDatabase</SPAN> method to compact your database to defragment the database file. The compacted database is usually smaller and often runs faster. You can also change the collating order, the encryption, or the version of the data format while you copy and compact the database.</P>
You must close <SPAN CLASS="p">olddb</SPAN> before you compact it. In a multiuser environment, other users can't have <SPAN CLASS="p">olddb</SPAN> open while you're compacting it. If <SPAN CLASS="p">olddb</SPAN> isn't closed or isn't available for <SPAN CLASS="pop">exclusive</SPAN> use, an error occurs.</P>
Because <SPAN CLASS="eln">CompactDatabase</SPAN> creates a copy of the database, you must have enough disk space for both the original and the duplicate databases. The compact operation fails if there isn't enough disk space available. The <SPAN CLASS="p">newdb</SPAN> duplicate database doesn't have to be on the same disk as <SPAN CLASS="p">olddb</SPAN>. After successfully compacting a database, you can delete the <SPAN CLASS="p">olddb</SPAN> file and rename the compacted <SPAN CLASS="p">newdb</SPAN> file to the original file name.</P>
The <SPAN CLASS="eln">CompactDatabase</SPAN> method copies all the data and the security <SPAN CLASS="pop">permission</SPAN> settings from the database specified by <SPAN CLASS="p">olddb</SPAN> to the database specified by <SPAN CLASS="p">newdb</SPAN>.</P>
If you use <B>CompactDatabase</B> to convert a version 1.<SPAN CLASS="p">x</SPAN> database to version 2.5 or 3.<SPAN CLASS="p">x</SPAN>, only applications using version Microsoft&nbsp;Jet 2.5 or 3.<SPAN CLASS="p">x</SPAN> can open the converted database.</P>
<SPAN CLASS="nh">Note</SPAN>   In an <SPAN CLASS="pop">ODBCDirect workspace</SPAN>, using the <B>CompactDatabase</B> method doesn't return an error, but instead loads the Microsoft&nbsp;Jet database engine into memory.</P>
<HR CLASS="ws">
<SPAN CLASS="wh">Caution</SPAN>&nbsp;&nbsp;&nbsp;Because the <SPAN CLASS="eln">CompactDatabase</SPAN> method doesn't convert Microsoft&nbsp;Access objects, you shouldn't use <SPAN CLASS="eln">CompactDatabase</SPAN> to convert a database containing such objects. To convert a database containing Microsoft&nbsp;Access objects, on the <SPAN CLASS="eln">Tools</SPAN> menu, point to <SPAN CLASS="eln">Database Utilities</SPAN>, and then click <SPAN CLASS="eln">Convert Database</SPAN>.</P>
<HR CLASS="we">
See Also</P>
<SPAN CLASS="eln">CollatingOrder</SPAN> property, <SPAN CLASS="eln">CreateDatabase</SPAN> method, <SPAN CLASS="eln">Database</SPAN> object, <SPAN CLASS="eln">RepairDatabase</SPAN> method.</P>
Specifics (Microsoft&nbsp;Access)</P>
To compact a database from the Microsoft&nbsp;Access window, point to <B>Database Utilities</B> on the <B>Tools</B> menu, and click <B>Compact Database</B>. Use the DAO <B>CompactDatabase</B> method to compact a database from Visual&nbsp;Basic code.</P>
<SPAN CLASS="l">Note</SPAN>   The <SPAN CLASS="eln">CompactDatabase</SPAN> method won't completely convert a Microsoft&nbsp;Access database from one version to another. Only the data format is converted. Microsoft&nbsp;Access–defined objects, such as forms and reports, aren't converted. To convert a database created in a previous version, point to <B>Database Utilities</B> on the <B>Tools</B> menu and click <B>Convert Database</B>.</P>
Example</P>
This example uses the <SPAN CLASS="eln">CompactDatabase</SPAN> method to change the collating order of a database. You cannot use this code in a module belonging to Northwind.mdb.</P>

<pre><code>Sub CompactDatabaseX()

    Dim dbsNorthwind As Database

    Set dbsNorthwind = OpenDatabase("Northwind.mdb")

    ' Show the properties of the original database.
    With dbsNorthwind
        Debug.Print .Name &amp; ", version " &amp; .Version
        Debug.Print "    CollatingOrder = " &amp; .CollatingOrder
        .Close
    End With

    ' Make sure there isn't already a file with the
    ' name of the compacted database.
    If Dir("NwindKorean.mdb") &lt;&gt; "" Then Kill "NwindKorean.mdb"

    ' This statement creates a compact version of the
    ' Northwind database that uses a Korean language
    ' collating order.
    DBEngine.CompactDatabase "Northwind.mdb", 
        "NwindKorean.mdb", dbLangKorean

    Set dbsNorthwind = OpenDatabase("NwindKorean.mdb")

    ' Show the properties of the compacted database.
    With dbsNorthwind
        Debug.Print .Name &amp; ", version " &amp; .Version
        Debug.Print "    CollatingOrder = " &amp; .CollatingOrder
        .Close
    End With

End Sub</code></pre>
This example uses the <SPAN CLASS="eln">CompactDatabase</SPAN> method to change the version of a database. To run this code, you must have a Microsoft&nbsp;Jet version 1.1 database called Nwind11.mdb and you cannot use this code in a module belonging to Nwind11.mdb.</P>

<pre><code>Sub CompactDatabaseX2()

    Dim dbsNorthwind As Database
    Dim prpLoop As Property

    Set dbsNorthwind = OpenDatabase("Nwind11.mdb")

    ' Show the properties of the original database.
    With dbsNorthwind
        Debug.Print .Name &amp; ", version " &amp; .Version
        Debug.Print "    CollatingOrder = " &amp; .CollatingOrder
        .Close
    End With
    ' Make sure there isn't already a file with the
    ' name of the compacted database.
    If Dir("Nwind20.mdb") &lt;&gt; "" Then Kill "Nwind20.mdb"

    ' This statement creates a compact and encrypted
    ' Microsoft Jet 2.0 version of a Microsoft Jet version
    ' 1.1 database.
    DBEngine.CompactDatabase "Nwind11.mdb", _
        "Nwind20.mdb", , dbEncrypt + dbVersion20

    Set dbsNorthwind = OpenDatabase("Nwind20.mdb")

    ' Show the properties of the compacted database.
    With dbsNorthwind
        Debug.Print .Name &amp; ", version " &amp; .Version
        For Each prpLoop In .Properties
            On Error Resume Next
            If prpLoop &lt;&gt; "" Then Debug.Print "    " &amp; _
                prpLoop.Name &amp; " = " &amp; prpLoop
            On Error GoTo 0
        Next prpLoop
        .Close
    End With

End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
