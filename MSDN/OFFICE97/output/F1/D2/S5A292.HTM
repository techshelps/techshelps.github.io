<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DefaultCursorDriver Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>DefaultCursorDriver Property</H1>Applies To</P>
<SPAN CLASS="eln">Workspace</SPAN> object.</P>
Description</P>
Sets or returns the type of cursor driver used on the connection created by the <SPAN CLASS="lee">OpenConnection</SPAN> or <SPAN CLASS="lee">OpenDatabase</SPAN> methods (<SPAN CLASS="pop">ODBCDirect workspaces</SPAN> only).</P>
Settings And Return Values</P>
The setting or return value is a <SPAN CLASS="lee">Long</SPAN> that can be set to one of the following constants.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="131pt" VALIGN="TOP"><COL WIDTH="229pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">  </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbUseDefaultCursor</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">(Default) Uses <SPAN CLASS="pop">server-side cursors</SPAN> if the server supports them; otherwise use the ODBC Cursor Library.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbUseODBCCursor</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Always uses the ODBC Cursor Library. This option provides better performance for small result sets, but degrades quickly for larger result sets.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbUseServerCursor</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Always uses server-side cursors. For most large operations this option provides better performance, but might cause more network traffic.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbUseClientBatchCursor</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Always uses the client batch cursor library. This option is required for batch updates.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbUseNoCursor</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Opens all cursors (that is, <SPAN CLASS="lee">Recordset</SPAN> objects) as forward-only type, read-only, with a rowset size of 1. Also&nbsp;known as "cursorless queries."</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
This property setting only affects connections established after the property has been set.&nbsp;Changing the <SPAN CLASS="lee">DefaultCursorDriver</SPAN> property has no effect on existing connections.</P>
Example</P>
This example uses the <SPAN CLASS="eln">RecordStatus</SPAN> and <SPAN CLASS="eln">DefaultCursorDriver</SPAN> properties to show how changes to a local <SPAN CLASS="eln">Recordset</SPAN> are tracked during <SPAN CLASS="pop">batch updating</SPAN>. The RecordStatusOutput function is required for this procedure to run.</P>

<pre><code>Sub RecordStatusX()

    Dim wrkMain As Workspace
    Dim conMain As Connection
    Dim rstTemp As Recordset
    Set wrkMain = CreateWorkspace("ODBCWorkspace", _
        "admin", "", dbUseODBC)
    ' This DefaultCursorDriver setting is required for
    ' batch updating.
    wrkMain.DefaultCursorDriver = dbUseClientBatchCursor

    Set conMain = wrkMain.OpenConnection("Publishers", _
        dbDriverNoPrompt, False, _
        "ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers")
    ' The following locking argument is required for
    ' batch updating.
    Set rstTemp = conMain.OpenRecordset( _
        "SELECT * FROM authors", dbOpenDynaset, 0, _
        dbOptimisticBatch)

    With rstTemp
        .MoveFirst
        Debug.Print "Original record: " &amp; !au_lname
        Debug.Print , RecordStatusOutput2(.RecordStatus)

        .Edit
        !au_lname = "Bowen"
        .Update
        Debug.Print "Edited record: " &amp; !au_lname
        Debug.Print , RecordStatusOutput2(.RecordStatus)

        .AddNew
        !au_lname = "NewName"
        .Update
        Debug.Print "New record: " &amp; !au_lname
        Debug.Print , RecordStatusOutput2(.RecordStatus)

        .Delete
        Debug.Print "Deleted record: " &amp; !au_lname
        Debug.Print , RecordStatusOutput2(.RecordStatus)

        ' Close the local recordset without updating the
        ' data on the server.
        .Close
    End With

    conMain.Close
    wrkMain.Close

End Sub
Function RecordStatusOutput(lngTemp As Long) As String

    Dim strTemp As String

    strTemp = ""

    ' Construct an output string based on the RecordStatus
    ' value.
If lngTemp = dbRecordUnmodified Then _
        strTemp = "[dbRecordUnmodified]"
    If lngTemp = dbRecordModified Then _
        strTemp = "[dbRecordModified]"
    If lngTemp = dbRecordNew Then _
        strTemp = "[dbRecordNew]"
    If lngTemp = dbRecordDeleted Then _
        strTemp = "[dbRecordDeleted]"
    If lngTemp = dbRecordDBDeleted Then _
        strTemp = "[dbRecordDBDeleted]"

    RecordStatusOutput = strTemp

End Function</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
