<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>EditMode Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>EditMode Property</H1>Applies To</P>
Dynamic-Type <SPAN CLASS="eln">Recordset</SPAN> object, Dynaset-Type <SPAN CLASS="eln">Recordset</SPAN> object, Forward-Only–Type <SPAN CLASS="eln">Recordset</SPAN> object, <SPAN CLASS="eln">Recordset</SPAN> object, Snapshot-Type <SPAN CLASS="eln">Recordset</SPAN> object, Table-Type <SPAN CLASS="eln">Recordset</SPAN> object.</P>
Description</P>
Returns a value that indicates the state of editing for the <SPAN CLASS="pop">current record</SPAN>.</P>
Return Values</P>
The return value is a <SPAN CLASS="eln">Long</SPAN> that indicates the state of editing, as listed in the following table.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="121pt" VALIGN="TOP"><COL WIDTH="239pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbEditNone</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">No editing operation is in progress.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbEditInProgress</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The Edit method has been invoked, and the current record is in the <SPAN CLASS="pop">copy buffer</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">dbEditAdd</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The AddNew method has been invoked, and the current record in the copy buffer is a new record that hasn't been saved in the database.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
The <SPAN CLASS="eln">EditMode</SPAN> property is useful when an editing process is interrupted, for example, by an error during validation. You can use the value of the <SPAN CLASS="eln">EditMode</SPAN> property to determine whether you should use the Update or CancelUpdate method.</P>
You can also check to see if the LockEdits property setting is <SPAN CLASS="eln">True</SPAN> and the <SPAN CLASS="eln">EditMode</SPAN> property setting is <SPAN CLASS="eln">dbEditInProgress</SPAN> to determine whether the current <SPAN CLASS="pop">page</SPAN> is locked.</P>
See Also</P>
<SPAN CLASS="eln">AddNew</SPAN> method, <SPAN CLASS="eln">CancelUpdate</SPAN> method, <SPAN CLASS="eln">LockEdits</SPAN> property.</P>
Example</P>
This example shows the value of the <SPAN CLASS="eln">EditMode</SPAN> property under various conditions. The EditModeOutput function is required for this procedure to run.</P>

<pre><code>Sub EditModeX()

    Dim dbsNorthwind As Database
    Dim rstEmployees As Recordset

    Set dbsNorthwind = OpenDatabase("Northwind.mdb")
    Set rstEmployees = _
        dbsNorthwind.OpenRecordset("Employees", _
        dbOpenDynaset)

    ' Show the EditMode property under different editing
    ' states.
    With rstEmployees
        EditModeOutput "Before any Edit or AddNew:", .EditMode
        .Edit
        EditModeOutput "After Edit:", .EditMode
        .Update
        EditModeOutput "After Update:", .EditMode
        .AddNew
        EditModeOutput "After AddNew:", .EditMode
        .CancelUpdate
        EditModeOutput "After CancelUpdate:", .EditMode
        .Close
    End With

    dbsNorthwind.Close

End Sub

Function EditModeOutput(strTemp As String, _
    intEditMode As Integer)

    ' Print report based on the value of the EditMode
    ' property.
    Debug.Print strTemp
    Debug.Print "    EditMode = ";

    Select Case intEditMode
        Case dbEditNone
            Debug.Print "dbEditNone"
        Case dbEditInProgress
            Debug.Print "dbEditInProgress"
        Case dbEditAdd
            Debug.Print "dbEditAdd"
    End Select

End Function</code></pre>
Example (Microsoft Excel)</P>
This example checks to see whether the Customer recordset in the Nwindex.mdb database can be edited. If so, the example updates the value of the first field in the first record with the value in cell C3 on Sheet1.</P>
To create the Nwindex.mdb database, run the Microsoft Excel example for the <SPAN CLASS="lee">CreateDatabase</SPAN> method.</P>

<pre><code>Dim db As Database, rs As Recordset
Set db = Workspaces(0).OpenDatabase(Application.Path &amp; "\NWINDEX.MDB")
Set rs = db.OpenRecordset("Customer")
If Not ((rs.EditMode = dbEditAdd) Or _
        (rs.EditMode = dbEditInProgress)) Then
    rs.Edit
    rs.Fields(0).Value = Worksheets(1).Cells(3, 3).Value
    rs.Update
Else
    MsgBox ("Cannot update database with cell value")
End If
rs.Close
db.Close</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
