<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DSum Function</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>DSum Function</H2>Description</P>
You can use the <SPAN CLASS="eln">DSum</SPAN> functions to calculate the sum of a set of values in a specified set of records (a <SPAN CLASS="pop">domain</SPAN>). Use the <SPAN CLASS="eln">DSum</SPAN> function in Visual Basic, a <SPAN CLASS="pop">macro</SPAN>, a query expression, or a <SPAN CLASS="pop">calculated control</SPAN>.</P>
For example, you could use the <SPAN CLASS="eln">DSum</SPAN> function in a calculated field expression in a query to calculate the total sales made by a particular employee over a period of time. Or you could use the <SPAN CLASS="eln">DSum</SPAN> function in a calculated control to display a running sum of sales for a particular product.</P>
Syntax</P>
<SPAN CLASS="l">DSum(</SPAN><SPAN CLASS="p">expr</SPAN><SPAN CLASS="l">, </SPAN><SPAN CLASS="p">domain</SPAN>[<SPAN CLASS="l">, </SPAN><SPAN CLASS="p">criteria</SPAN>]<SPAN CLASS="l">)</SPAN></P>
The <SPAN CLASS="eln">DSum</SPAN> function has the following arguments.</P>

<TABLE COLS="3" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="269pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Argument</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">expr</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">An expression that identifies the numeric field whose values you want to total. It can be a <SPAN CLASS="pop">string expression</SPAN> identifying a field in a table or query, or it can be an expression that performs a <SPAN CLASS="jump">calculation on data in that field</SPAN>. In <SPAN CLASS="p">expr</SPAN>, you can include the name of a field in a table, a control on a form, a constant, or a function. If <SPAN CLASS="p">expr</SPAN>  includes a function, it can be either built-in or user-defined, but not another domain aggregate or <SPAN CLASS="jump">SQL aggregate</SPAN> function.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">domain</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A string expression identifying the set of records that constitutes the domain. It can be a table name or a query name.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">criteria</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">An optional string expression used to restrict the range of data on which the <SPAN CLASS="eln">DSum</SPAN> function is performed. For example, <SPAN CLASS="p">criteria</SPAN> is often equivalent to the WHERE clause in an SQL expression, without the word WHERE. If <SPAN CLASS="p">criteria</SPAN> is omitted, the <SPAN CLASS="eln">DSum</SPAN> function evaluates <SPAN CLASS="p">expr</SPAN>  against the entire domain. Any field that is included in <SPAN CLASS="p">criteria</SPAN> must also be a field in <SPAN CLASS="p">domain</SPAN>; otherwise, the <SPAN CLASS="eln">DSum</SPAN> function returns a Null.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
If no record satisfies the <SPAN CLASS="p">criteria</SPAN> argument or if domain contains no records, the <SPAN CLASS="eln">DSum</SPAN> function returns a <SPAN CLASS="eln">Null</SPAN>.</P>
Whether you use the <SPAN CLASS="eln">DSum</SPAN> function in a macro, module, query expression, or calculated control, you must construct the <SPAN CLASS="p">criteria</SPAN> argument carefully to ensure that it will be evaluated correctly.</P>
You can use the <SPAN CLASS="eln">DSum</SPAN> function to specify criteria in the <SPAN CLASS="eln">Criteria</SPAN> row of a query, in a calculated field in a query expression, or in the <SPAN CLASS="eln">Update To</SPAN> row of an <SPAN CLASS="pop">update query</SPAN>.</P>
<B>Note</B>   You can use either the <SPAN CLASS="eln">DSum</SPAN> or Sum function in a calculated field expression in a <SPAN CLASS="pop">totals query</SPAN>. If you use the <SPAN CLASS="eln">DSum</SPAN> function, values are calculated before data is grouped. If you use the <SPAN CLASS="eln">Sum</SPAN> function, the data is grouped before values in the field expression are evaluated.</P>
You may want to use the <SPAN CLASS="eln">DSum</SPAN> function when you need to display the sum of a set of values from a field that is not in the record source for your form or report. For example, suppose you have a form that displays information about a particular product. You could use the <SPAN CLASS="eln">DSum</SPAN> function to maintain a running total of sales of that product in a calculated control.</P>
<SPAN CLASS="nh">Tip</SPAN>   If you need to maintain a running total in a control on a report, you can use the RunningSum property of that control if the field on which it is based is included in the record source for the report. Use the <SPAN CLASS="eln">DSum</SPAN> function to maintain a running sum on a form.</P>
<SPAN CLASS="nh">Note</SPAN>   Unsaved changes to records in <SPAN CLASS="p">domain</SPAN> aren't included when you use this function. If you want the <SPAN CLASS="eln">DSum</SPAN> function to be based on the changed values, you must first save the changes by clicking <SPAN CLASS="eln">Save Record</SPAN> on the <SPAN CLASS="eln">File</SPAN> menu, moving the focus to another record, or by using the Update method.</P>
See Also</P>
<SPAN CLASS="eln">DCount</SPAN> function, <SPAN CLASS="eln">RunningSum</SPAN> property, <SPAN CLASS="eln">Sum</SPAN> function ("SQL Language Reference").</P>
Example</P>
The following example totals the values from the Freight field for orders shipped to the United Kingdom. The domain is an Orders table. The <SPAN CLASS="p">criteria</SPAN> argument restricts the resulting set of records to those for which ShipCountry equals UK.</P>

<pre><code>Dim curX As Currency
curX = DSum("[Freight]", "Orders", "[ShipCountry] = 'UK'")</code></pre>
The next example calculates a total by using two separate criteria. Note that single quotation marks (<SPAN CLASS="cte">'</SPAN>) and number signs (<SPAN CLASS="cte">#</SPAN>) are included in the string expression, so that when the strings are concatenated, the string literal will be enclosed in single quotation marks, and the date will be enclosed in number signs.</P>

<pre><code>Dim curX As Currency
curX = DSum("[Freight]", "Orders", _
    "[ShipCountry] = 'UK' AND [ShippedDate] &gt; #1-1-95#")</code></pre>
You can use a domain function in the <SPAN CLASS="eln">Update To</SPAN> row of an update query. For example, suppose you want to track current sales by product in a Products table. You could add a new field called SalesSoFar to the Products table, and run an update query to calculate the correct values and update the records. Create a new query based on the Products table, and click <SPAN CLASS="eln">Update</SPAN> on the <SPAN CLASS="eln">Query</SPAN> menu. Add the SalesSoFar field to the query grid, and enter the following in the <SPAN CLASS="eln">Update To</SPAN> row:</P>

<pre><code>DSum("[Quantity]*[UnitPrice]", "Order Details", "[ProductID] = " _
    &amp; [ProductID])</code></pre>
When the query is run, Microsoft Access calculates the total amount of sales for each product, based on information from an Order Details table. The sum of sales for each product is added to the Products table.</P>
<HR CLASS="rr"></FONT></BODY>
</HTML>
