<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>DesignMasterID Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>DesignMasterID Property</H1>Applies To</P>
<SPAN CLASS="eln">Database</SPAN> object.</P>
Description</P>
Sets or returns a 16-byte value that uniquely identifies the <SPAN CLASS="pop">Design Master</SPAN> in a <SPAN CLASS="pop">replica set</SPAN> (<SPAN CLASS="pop">Microsoft Jet workspaces</SPAN> only).</P>
Settings and Return Values</P>
The setting or return value is a GUID that uniquely identifies the Design Master.</P>
Remarks</P>
You should set the <SPAN CLASS="eln">DesignMasterID</SPAN> property only if you need to move the current Design Master. Setting this property makes a specific <SPAN CLASS="pop">replica</SPAN> in the replica set the Design Master.</P>
<HR CLASS="cas">
<SPAN CLASS="cah">Caution</SPAN>&nbsp;&nbsp;&nbsp;Never create a second Design Master in a replica set. The existence of a second Design Master can result in the loss of data.</P>
<HR CLASS="cae">
Under extreme circumstances — for example, if the Design Master is erased or corrupted — you can set this property at the current replica. However, setting this property at a replica when there is already another Design Master in the set might partition your replica set into two irreconcilable sets and prevent any further synchronization of data.</P>
If you decide to make a replica the new Design Master for the set, synchronize it with all the replicas in the replica set before setting the <SPAN CLASS="eln">DesignMasterID</SPAN> property in the replica. The replica must be open in exclusive mode in order to make it the Design Master.</P>
If you make a replica that is designated read-only into the Design Master, the target replica is made read/write; the old Design Master also remains read/write.</P>
The <SPAN CLASS="eln">DesignMasterID</SPAN> property setting is stored in the MSysRepInfo system table.</P>
See Also</P>
<SPAN CLASS="eln">ReplicaID</SPAN> property.</P>
Example</P>
This example sets the <SPAN CLASS="eln">DesignMasterID</SPAN> property to the <SPAN CLASS="eln">ReplicaID</SPAN> property setting of another database, making that database the <SPAN CLASS="pop">Design Master</SPAN> in the <SPAN CLASS="pop">replica set</SPAN>. The old and new Design Masters are synchronized to update the design change. For this code to work, you must create a Design Master and replica, include their names and paths as appropriate, and run this code from a database other than the old or new Design Master.</P>

<pre><code>Sub SetNewDesignMaster(strOldDM as String, _
    strNewDM as String)

    Dim dbsOld As Database
    Dim dbsNew As Database

    ' Open the current Design Master in exclusive mode.
    Set dbsOld = OpenDatabase(strOldDM, True)

    ' Open the database that will become the new
    ' Design Master.
    Set dbsNew = OpenDatabase(strNewDM)

    ' Make the new database the Design Master.
    dbsOld.DesignMasterID = dbsNew.ReplicaID

    ' Synchronize the old Design Master with the new
    ' Design Master, and allow two-way exchanges.
    dbsOld.Synchronize strNewDM, dbRepImpExpChanges
    dbsOld.Close
    dbsNew.Close

End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
