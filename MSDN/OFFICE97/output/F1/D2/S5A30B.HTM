<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>UpdateOptions Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>UpdateOptions Property</H1>Applies To</P>
Dynamic-Type <SPAN CLASS="eln">Recordset</SPAN> object, Dynaset-Type <SPAN CLASS="eln">Recordset</SPAN> object, Forward-Only-Type <SPAN CLASS="eln">Recordset</SPAN> object, <SPAN CLASS="eln">Recordset</SPAN> object, Snapshot-Type <SPAN CLASS="eln">Recordset</SPAN> object.</P>
Description</P>
Sets or returns a value that indicates how the WHERE clause is constructed for each record during a batch update, and whether the batch update should use an UPDATE statement or a DELETE followed by an INSERT (<SPAN CLASS="pop">ODBCDirect workspaces</SPAN> only).</P>
Settings And Return Values</P>
The setting or return value is a <SPAN CLASS="lee">Long</SPAN> that can be any of the following constants.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="121pt" VALIGN="TOP"><COL WIDTH="239pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">  </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbCriteriaKey</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">(Default) Uses just the key column(s) in the WHERE clause.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbCriteriaModValues</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Uses the key column(s) and all updated columns in the WHERE clause.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbCriteriaAllCols</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Uses the key column(s) and all the columns in the WHERE clause.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbCriteriaTimeStamp</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Uses just the timestamp column if available (will generate a run-time error if no timestamp column is in the result set).</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbCriteriaDeleteInsert</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Uses a set of DELETE and INSERT statements for each modified row.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbCriteriaUpdate</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">(Default) Uses an UPDATE statement for each modified row.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
When a batch-mode <SPAN CLASS="lee">Update</SPAN> is executed, DAO and the <SPAN CLASS="pop">client batch cursor library</SPAN> create a series of SQL UPDATE statements to make the needed changes. An SQL WHERE clause is created for each update to isolate the records that are marked as changed by the&nbsp;<SPAN CLASS="lee">RecordStatus</SPAN> property. Because some remote servers use triggers or other ways to&nbsp;enforce referential integrity, is it often important to limit the fields being updated to just those affected by the change. To do this, set the <SPAN CLASS="lee">UpdateOptions</SPAN> property to one of&nbsp;the constants <SPAN CLASS="lee">dbCriteriaKey</SPAN>, <B>dbCriteriaModValues</B>, <B>dbCriteriaAllCols</B>, or <B>dbCriteriaTimeStamp</B>. This way, only the absolute minimum amount of trigger code is executed. As a result, the update operation is executed more quickly, and with fewer potential errors.</P>
You can also concatenate either of the constants <SPAN CLASS="lee">dbCriteriaDeleteInsert</SPAN> or <SPAN CLASS="lee">dbCriteriaUpdate</SPAN> to determine whether to use a set of SQL DELETE and INSERT statements or an SQL UPDATE statement for each update when sending batched modifications back to the server. In the former case, two separate operations are required to update the record. In some cases, especially where the remote system implements DELETE, INSERT, and UPDATE triggers, choosing the correct <SPAN CLASS="lee">UpdateOptions</SPAN> property setting can significantly impact performance.</P>
If you don't specify any constants, <SPAN CLASS="lee">dbCriteriaUpdate</SPAN> and <SPAN CLASS="lee">dbCriteriaKey</SPAN> will be used.</P>
Newly added records will always generate INSERT statements and deleted records will always generate DELETE statements, so this property only applies to how the cursor library updates modified records.</P>
Example</P>
See the <SPAN CLASS="eln">BatchSize</SPAN> property example.</P>
<HR CLASS="rr"></FONT></BODY>
</HTML>
