<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ReplicaFilter Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>ReplicaFilter Property</H1>Applies To</P>
<SPAN CLASS="eln">TableDef</SPAN> object.</P>
Description</P>
Sets or returns a value on a <SPAN CLASS="lee">TableDef</SPAN> object within a partial replica that indicates which subset of records is replicated to that table from a full replica. (<SPAN CLASS="pop">Microsoft Jet databases</SPAN> only.)</P>
Settings And Return Values</P>
The setting or return value is a <SPAN CLASS="lee">String</SPAN> or <SPAN CLASS="lee">Boolean</SPAN> that indicates which subset of records is replicated, as specified in the following table:</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="91pt" VALIGN="TOP"><COL WIDTH="268pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Value</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A string</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A criteria that a record in the partial replica table must satisfy in order to be replicated from the full replica.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">True</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Replicates all records.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">False</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">(Default) Doesn't replicate any records. </P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
This property is similar to an SQL WHERE clause (without the word WHERE), but you cannot specify subqueries, aggregate functions (such as <SPAN CLASS="lee">Count</SPAN>), or user-defined functions within the criteria.</P>
You can only synchronize data between a full replica and a partial replica. You can't synchronize data between two partial replicas. Also, with partial replication you can set restrictions on which records are replicated, but you can't indicate which fields are&nbsp;replicated.</P>
Usually, you reset a replica filter when you want to replicate a different set of records. For example, when a sales representative temporarily takes over another sales representative's region, the database application can temporarily replicate data for both regions and then return to the previous filter. In this scenario, the application resets the <SPAN CLASS="lee">ReplicaFilter</SPAN> property and then repopulates the partial replica.</P>
If your application changes replica filters, you should follow these steps:</P>
<SPAN CLASS="list"><OL><LI CLASS="OLI1">Use the <SPAN CLASS="lee">Synchronize</SPAN> method to synchronize your full replica with the partial replica in which the filters are being changed.</LI><LI CLASS="OLI1">Use the <SPAN CLASS="lee">ReplicaFilter</SPAN> property to make the desired changes to the replica filter.</LI><LI CLASS="OLI1">Use the <SPAN CLASS="lee">PopulatePartial</SPAN> method to remove all records from the partial replica and transfer all records from the full replica that meet the new replica filter criteria.
</LI></OL></SPAN>To remove a filter, set the <SPAN CLASS="lee">ReplicaFilter</SPAN> property to <SPAN CLASS="lee">False</SPAN>. If you remove all filters and invoke the <SPAN CLASS="lee">PopulatePartial</SPAN> method, no records will appear in any replicated tables in the partial replica.</P>
<SPAN CLASS="nh">Note</SPAN>&nbsp;&nbsp;&nbsp;If a replica filter has changed, and the <SPAN CLASS="lee">Synchronize</SPAN> method is invoked without first invoking <SPAN CLASS="lee">PopulatePartial</SPAN>, a trappable error occurs.</P>
Example</P>
The following example uses the <SPAN CLASS="eln">ReplicaFilter</SPAN> property to replicate only customer records from the California region.</P>

<pre><code>Sub ReplicaFilterX()

    ' This example assumes the current open database
    ' is the replica.
    Dim tdfCustomers As TableDef
    Dim strFilter As String
    Dim dbsTemp As Database

    Set dbsTemp = OpenDatabase("Northwind.mdb")
    Set tdfCustomers = dbsTemp.TableDefs("Customers")

    ' Synchronize with full replica
    ' before setting replica filter.
    dbsTemp.Synchronize "C:\Sales\Fy96.mdb"

    strFilter = "Region = 'CA'"
    tdfCustomers.ReplicaFilter = strFilter
    dbsTemp.PopulatePartial "C:\Sales\Fy96.mdb"

    ' Now remove the replica filter (for example purposes
    ' only).
    tdfCustomers.ReplicaFilter = False
    ' Repopulate the database.
    dbsTemp.PopulatePartial "C:\Sales\Data96.mdb"

End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
