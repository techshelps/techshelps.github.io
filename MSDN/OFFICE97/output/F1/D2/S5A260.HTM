<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>AbsolutePosition Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>AbsolutePosition Property</H2>Applies To</P>
Dynamic-Type <SPAN CLASS="eln">Recordset</SPAN> object, Dynaset-Type <SPAN CLASS="eln">Recordset</SPAN> object, <SPAN CLASS="eln">Recordset</SPAN> object, Snapshot-Type <SPAN CLASS="eln">Recordset</SPAN> object.</P>
Description</P>
Sets or returns the relative record number of a Recordset object's <SPAN CLASS="pop">current record</SPAN>.</P>
Settings and Return Values</P>
The setting or return value is a <SPAN CLASS="eln">Long</SPAN> integer from 0 to one less than the number of records in the <SPAN CLASS="eln">Recordset</SPAN> object. It corresponds to the ordinal position of the current record in the <SPAN CLASS="eln">Recordset</SPAN> object specified by the object.</P>
Remarks</P>
You can use the <SPAN CLASS="eln">AbsolutePosition</SPAN> property to position the current record pointer to a specific record based on its ordinal position in a dynaset- or snapshot-type <SPAN CLASS="eln">Recordset</SPAN> object. You can also determine the current record number by checking the <SPAN CLASS="eln">AbsolutePosition</SPAN> property setting.</P>
Because the <SPAN CLASS="eln">AbsolutePosition</SPAN> property value is zero-based (that is, a setting of 0 refers to the first record in the <SPAN CLASS="eln">Recordset</SPAN> object), you cannot set it to a value greater than or equal to the number of populated records; doing so causes a trappable error. You can determine the number of populated records in the <SPAN CLASS="eln">Recordset</SPAN> object by checking the <SPAN CLASS="eln">RecordCount</SPAN> property setting. The maximum allowable setting for the <SPAN CLASS="eln">AbsolutePosition</SPAN> property is the value of the <SPAN CLASS="eln">RecordCount</SPAN> property minus 1.</P>
If there is no current record, as when there are no records in the <SPAN CLASS="eln">Recordset</SPAN> object, <SPAN CLASS="eln">AbsolutePosition</SPAN> returns –1. If the current record is deleted, the <SPAN CLASS="eln">AbsolutePosition</SPAN> property value isn't defined, and a trappable error occurs if it's referenced. New records are added to the end of the sequence.</P>
You shouldn't use this property as a surrogate record number. <SPAN CLASS="pop">Bookmarks</SPAN> are still the recommended way of retaining and returning to a given position and are the only way to position the current record across all types of <SPAN CLASS="eln">Recordset</SPAN> objects. In particular, the position of a record changes when one or more records preceding it are deleted. There is also no assurance that a record will have the same absolute position if the <SPAN CLASS="eln">Recordset</SPAN> object is re-created again because the order of individual records within a <SPAN CLASS="eln">Recordset</SPAN> object isn't guaranteed unless it's created with an <SPAN CLASS="pop">SQL statement</SPAN> by using an ORDER BY clause.</P>
<SPAN CLASS="nh">Notes</SPAN></P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Setting the <SPAN CLASS="eln">AbsolutePosition</SPAN> property to a value greater than zero on a newly opened but unpopulated <SPAN CLASS="eln">Recordset</SPAN> object causes a trappable error. Populate the <SPAN CLASS="eln">Recordset</SPAN> object first with the <SPAN CLASS="eln">MoveLast</SPAN> method.</LI><LI CLASS="ULI1">The <SPAN CLASS="eln">AbsolutePosition</SPAN> property isn't available on <SPAN CLASS="pop">forward-only–type</SPAN> <SPAN CLASS="eln">Recordset</SPAN> objects, or on <SPAN CLASS="eln">Recordset</SPAN> objects opened from <SPAN CLASS="pop">pass-through queries</SPAN> against Microsoft Jet-connected ODBC databases.
</LI></UL></SPAN>See Also</P>
<SPAN CLASS="eln">PercentPosition</SPAN> property, <SPAN CLASS="eln">RecordCount</SPAN> property.</P>
Example</P>
This example uses the <SPAN CLASS="eln">AbsolutePosition</SPAN> property to track the progress of a loop that enumerates all the records of a <SPAN CLASS="eln">Recordset</SPAN>.</P>

<pre><code>Sub AbsolutePositionX()

    Dim dbsNorthwind As Database
    Dim rstEmployees As Recordset
    Dim strMessage As String

    Set dbsNorthwind = OpenDatabase("Northwind.mdb")
    ' AbsolutePosition only works with dynasets or snapshots.
    Set rstEmployees = _
        dbsNorthwind.OpenRecordset("Employees", _
            dbOpenSnapshot)

    With rstEmployees
        ' Populate Recordset.
        .MoveLast
        .MoveFirst

        ' Enumerate Recordset.
        Do While Not .EOF
            ' Display current record information. Add 1 to
            ' AbsolutePosition value because it is zero-based.
            strMessage = "Employee: " &amp; !LastName &amp; vbCr &amp; _
                "(record " &amp; (.AbsolutePosition + 1) &amp; _
                " of " &amp; .RecordCount &amp; ")"
            If MsgBox(strMessage, vbOKCancel) = vbCancel _
                Then Exit Do
            .MoveNext
        Loop

        .Close
    End With

    dbsNorthwind.Close

End Sub</code></pre>
Example (Microsoft Access)</P>
The following example finds a particular record in a dynaset-type <SPAN CLASS="eln">Recordset</SPAN> object and determines the ordinal position of that record:</P>

<pre><code>Sub RecordOrdinalPosition()
    Dim dbs As Database, rst As Recordset

    ' Return reference to current database.
    Set dbs = CurrentDb
    ' Return reference to dynaset-type Recordset object object.
    Set rst = dbs.OpenRecordset("SELECT * FROM Orders WHERE " _
        &amp; "ShippedDate &gt;= #1-1-96#;")
    ' Find first order shipped to London.
    rst.FindFirst "ShipCity = 'London'"
    ' Return ordinal position of that record.
    Debug.Print rst.AbsolutePosition
    rst.Close
    Set dbs = Nothing
End Sub</code></pre>
Example (Microsoft Excel)</P>
This example prompts the user for a record number. The example uses this number to move to a record in the Customer recordset in the Nwindex.mdb database, and then it copies the values for three specified fields to Sheet1.</P>
To create the Nwindex.mdb database, run the Microsoft Excel example for the <SPAN CLASS="lee">CreateDatabase</SPAN> method.</P>

<pre><code>Dim db As Database, rs As Recordset
Sheets("Sheet1").Activate
recordNumber = Application.InputBox(Prompt:="Record number to copy " _
    &amp; "to Sheet1", Title:="Record to copy", Type:=1)
If recordNumber = False Then    ' user cancelled InputBox
    Exit Sub
End If
Set db = Workspaces(0).OpenDatabase(Application.Path &amp; "\NWINDEX.MDB")
Set rs = db.OpenRecordset("Customer", dbOpenSnapshot)
rs.MoveLast
If rs.RecordCount &gt; recordNumber Then
    rs.AbsolutePosition = recordNumber
    ActiveCell.Value = rs.Fields("CONTACT").Value
    ActiveCell.Offset(, 1).Value = rs.Fields("ADDRESS").Value
    ActiveCell.Offset(, 2).Value = rs.Fields("CITY").Value
Else
    MsgBox "The record #" &amp; recordNumber &amp; " doesn't exist."
End If
rs.Close
db.Close</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
