<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>UseTransaction Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>UseTransaction Property</H2>Applies To</P>
Action query, <SPAN CLASS="eln">QueryDef</SPAN> object.</P>
Description</P>
You can use the <SPAN CLASS="eln">UseTransaction</SPAN> property to specify or determine whether an <SPAN CLASS="pop">action query</SPAN> runs as a single transaction. In some situations, setting this property to No can make queries run much faster.</P>
Setting</P>
The <SPAN CLASS="eln">UseTransaction</SPAN> property uses the following settings.</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="72pt" VALIGN="TOP"><COL WIDTH="200pt" VALIGN="TOP"><COL WIDTH="87pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Setting</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Visual&nbsp;Basic</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Yes</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">(Default) The query runs as a single transaction.</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">True</SPAN> (–1)</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">No</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The query doesn't run as a single transaction.</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="eln">False</SPAN> (0)</P></TD></TR></TBODY></TABLE>
<BR></P>You can set the <SPAN CLASS="eln">UseTransaction</SPAN> property by using the query's <SPAN CLASS="jump">property sheet</SPAN> or <SPAN CLASS="jump">Visual</SPAN>&nbsp;<SPAN CLASS="jump">Basic</SPAN>. To set this property with Visual&nbsp;Basic, you must first add it to a QueryDef object's Properties collection by using the CreateProperty method.</P>
Remarks</P>
When a <SPAN CLASS="pop">make-table</SPAN>, <SPAN CLASS="pop">delete</SPAN>, <SPAN CLASS="pop">append</SPAN>, or <SPAN CLASS="pop">update</SPAN> query has its <SPAN CLASS="eln">UseTransaction</SPAN> property set to Yes, the <SPAN CLASS="pop">Microsoft Jet database engine</SPAN> stores the returned records in a cache and, if necessary, stores the results in a temporary database on disk. When the query has finished, the Jet database engine reads the records from the temporary database and writes them back to the original database.</P>
You may get substantial performance benefits by setting the <SPAN CLASS="eln">UseTransaction</SPAN> property to No in the right circumstances. When the <SPAN CLASS="eln">UseTransaction</SPAN> property is set to No, the user will never encounter problems associated with too many lock requests. In addition, the Jet database engine doesn't store query results in a temporary database, thereby achieving a substantial performance increase.</P>
If there is a large number of records that must be written to the temporary database, performance may suffer as a result of running an action query as a single transaction. In addition, when running delete or update queries in a shared database, a large number of lock requests are generated. This may cause performance to suffer and in some Network Operating Systems like Netware it can cause the query to fail when the lock requests exceed 10,000.</P>
If a transaction can't be completed, an error message appears and you have the option of saving any changes.</P>
When the <SPAN CLASS="eln">UseTransaction</SPAN> property is set to No, the only way to roll back an entire transaction is to use the DAO RollBack method in Visual&nbsp;Basic.</P>
See Also</P>
<B>BeginTrans</B>, <B>CommitTrans</B>, <SPAN CLASS="eln">Rollback</SPAN> methods, <SPAN CLASS="eln">CreateProperty</SPAN> method ("DAO Language Reference"), <SPAN CLASS="eln">FailOnError</SPAN> property.</P>
<HR CLASS="rr"></FONT></BODY>
</HTML>
