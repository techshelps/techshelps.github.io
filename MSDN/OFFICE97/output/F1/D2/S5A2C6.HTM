<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Move Method</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>Move Method</H1>Applies To</P>
Dynamic-Type <SPAN CLASS="eln">Recordset</SPAN> object, Dynaset-Type <SPAN CLASS="eln">Recordset</SPAN> object, Forward-Only–Type <SPAN CLASS="eln">Recordset</SPAN> object, <SPAN CLASS="eln">Recordset</SPAN> object, Snapshot-Type <SPAN CLASS="eln">Recordset</SPAN> object, Table-Type <SPAN CLASS="eln">Recordset</SPAN> object.</P>
Description</P>
Moves the position of the <SPAN CLASS="pop">current record</SPAN> in a Recordset object.</P>
Syntax</P>
<SPAN CLASS="p">recordset</SPAN><SPAN CLASS="l">.</SPAN><SPAN CLASS="eln">Move </SPAN><SPAN CLASS="p">rows</SPAN><SPAN CLASS="l">,</SPAN> <SPAN CLASS="p">start</SPAN></P>
The <SPAN CLASS="eln">Move</SPAN> method syntax has these parts.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="90pt" VALIGN="TOP"><COL WIDTH="270pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">recordset</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">An <SPAN CLASS="pop">object variable</SPAN> that represents the <SPAN CLASS="eln">Recordset</SPAN> object whose current record position is being moved.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">rows</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">A signed <SPAN CLASS="eln">Long</SPAN> value specifying the number of rows the position will move. If <SPAN CLASS="p">rows</SPAN> is greater than 0, the position is moved forward (toward the end of the file). If <SPAN CLASS="p">rows</SPAN> is less than 0, the position is moved backward (toward the beginning of the file).</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">startbookmark</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. A Variant (<SPAN CLASS="eln">String</SPAN> subtype) value identifying a <SPAN CLASS="pop">bookmark</SPAN>. If you specify <SPAN CLASS="p">startbookmark,</SPAN> the move begins relative to this bookmark. Otherwise, <SPAN CLASS="eln">Move</SPAN> begins from the current record.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
If you use <SPAN CLASS="eln">Move</SPAN> to position the current record pointer before the first record, the current record pointer moves to the beginning of the file. If the <SPAN CLASS="eln">Recordset</SPAN> contains no records and its <SPAN CLASS="eln">BOF</SPAN> property is <SPAN CLASS="eln">True</SPAN>, using this method to move backward causes an error.</P>
If you use <SPAN CLASS="eln">Move</SPAN> to position the current record pointer after the last record, the current record pointer position moves to the end of the file. If the <SPAN CLASS="eln">Recordset</SPAN> contains no records and its <SPAN CLASS="eln">EOF</SPAN> property is <SPAN CLASS="eln">True</SPAN>, then using this method to move forward causes an error.</P>
If either the <SPAN CLASS="eln">BOF</SPAN> or <SPAN CLASS="eln">EOF</SPAN> property is <SPAN CLASS="eln">True</SPAN> and you attempt to use the <SPAN CLASS="eln">Move</SPAN> method without a valid bookmark, a run-time error occurs.</P>
<SPAN CLASS="eln">Notes</SPAN></P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">When you use <SPAN CLASS="eln">Move</SPAN> on a <SPAN CLASS="pop">forward-only-type</SPAN> <SPAN CLASS="eln">Recordset</SPAN> object, the <SPAN CLASS="p">rows</SPAN> argument must be a positive integer and bookmarks aren't allowed. This means you can only move forward.</LI><LI CLASS="ULI1">To make the first, last, next, or previous record in a <SPAN CLASS="eln">Recordset </SPAN>the current record, use either the MoveFirst, MoveLast, MoveNext, or MovePrevious method.</LI><LI CLASS="ULI1">Using <SPAN CLASS="eln">Move</SPAN> with <SPAN CLASS="p">rows</SPAN> equal to 0 is an easy way to retrieve the underlying data for the current record. This is useful if you want to make sure that the current record has the most recent data from the base tables. It will also cancel any pending Edit or AddNew calls.
</LI></UL></SPAN>See Also</P>
<SPAN CLASS="eln">BOF</SPAN>, <SPAN CLASS="eln">EOF</SPAN> properties, <SPAN CLASS="eln">Bookmark</SPAN> property, <SPAN CLASS="eln">MoveFirst</SPAN>, <SPAN CLASS="eln">MoveLast</SPAN>, <SPAN CLASS="eln">MoveNext</SPAN>, <SPAN CLASS="eln">MovePrevious</SPAN> methods.</P>
Specifics (Microsoft Access)</P>
When you use a <SPAN CLASS="pop">bookmark</SPAN> in a Microsoft Access module, you must include an <SPAN CLASS="eln">Option Compare</SPAN> <SPAN CLASS="eln">Binary</SPAN> statement in the <SPAN CLASS="pop">Declarations section</SPAN> of the module. A bookmark is a <SPAN CLASS="pop">Variant</SPAN> array of <SPAN CLASS="pop">Byte</SPAN> data, so the <SPAN CLASS="pop">string comparison</SPAN> method for the module must be binary. If a bookmark is evaluated with a text-based string comparison method, such as the <SPAN CLASS="eln">Option Compare Text</SPAN> statement or the default setting for the <SPAN CLASS="eln">Option Compare Database</SPAN> statement, the current record may be set to an incorrect record.</P>
Example</P>
This example uses the <SPAN CLASS="eln">Move</SPAN> method to position the record pointer based on user input.</P>

<pre><code>Sub MoveX()

    Dim dbsNorthwind As Database
    Dim rstSuppliers As Recordset
    Dim varBookmark As Variant
    Dim strCommand As String
    Dim lngMove As Long

    Set dbsNorthwind = OpenDatabase("Northwind.mdb")
    Set rstSuppliers = _
        dbsNorthwind.OpenRecordset("SELECT CompanyName, " &amp; _
        "City, Country FROM Suppliers ORDER BY CompanyName", _
        dbOpenDynaset)

    With rstSuppliers
        ' Populate recordset.
        .MoveLast
        .MoveFirst

        Do While True
            ' Display information about current record and ask
            ' how many records to move.
            strCommand = InputBox( _
                "Record " &amp; (.AbsolutePosition + 1) &amp; " of " &amp; _
                .RecordCount &amp; vbCr &amp; "Company: " &amp; _
                !CompanyName &amp; vbCr &amp; "Location: " &amp; !City &amp; _
                ", " &amp; !Country &amp; vbCr &amp; vbCr &amp; _
                "Enter number of records to Move " &amp; _
                "(positive or negative).")

            If strCommand = "" Then Exit Do

            ' Store bookmark in case the Move doesn't work.
            varBookmark = .Bookmark

            ' Move method requires parameter of data type Long.
            lngMove = CLng(strCommand)
            .Move lngMove

            ' Trap for BOF or EOF.
            If .BOF Then
                MsgBox "Too far backward! " &amp; _
                    "Returning to current record."
                .Bookmark = varBookmark
            End If
            If .EOF Then
                MsgBox "Too far forward! " &amp; _
                    "Returning to current record."
                .Bookmark = varBookmark
            End If
        Loop
        .Close
    End With

    dbsNorthwind.Close

End Sub</code></pre>
Example (Microsoft Access)</P>
The following example uses the <SPAN CLASS="eln">Move</SPAN> method to move forward two rows in a <SPAN CLASS="eln">Recordset</SPAN> object:</P>

<pre><code>Sub MoveForward()
    Dim dbs As Database, rst As Recordset
    Dim strCriteria As String

    ' Return reference to current database.
    Set dbs = CurrentDb
    ' Open dynaset-type Recordset object.
    Set rst = dbs.OpenRecordset("SELECT * FROM Orders " _
        &amp; "ORDER BY ShipCountry;")
    rst.MoveLast
    rst.MoveFirst
    ' Check number of records in Recordset object.
    If rst.RecordCount &gt; 2 Then
        ' Move forward two rows.
        rst.Move 2
        Debug.Print rst!ShipCountry
    End If
    rst.Close
    Set dbs = Nothing
End Sub</code></pre>
Example (Microsoft Excel)</P>
This example prompts the user to select a record number. The example then copies the selected record from the Customer recordset in the Nwindex.mdb database to Sheet1.</P>

<pre><code>Dim db As Database, rs As Recordset
Set db = Workspaces(0).OpenDatabase(Application.Path &amp; "\NWINDEX.MDB")
Set rs = db.OpenRecordset("SELECT [CUSTMR_ID], [CONTACT], [REGION] " _
    &amp; "FROM Customer")
Sheets("Sheet1").Activate
aDistance = Application.InputBox("What record # you want to copy", _
    Type:=2)
If aDistance = False Then    ' user cancelled InputBox
    Exit Sub
End If
rs.MoveFirst
rs.Move aDistance
For i = 0 To 2
    ActiveCell.Offset(, i).Value = rs.Fields(i).Value
Next
rs.Close
db.Close</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
