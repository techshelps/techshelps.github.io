<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Prepare Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>Prepare Property</H1>Applies To</P>
<SPAN CLASS="eln">QueryDef</SPAN> object.</P>
Description</P>
Sets or returns a value that indicates whether the query should be prepared on the server as a temporary stored procedure, using the ODBC <SPAN CLASS="lee">SQLPrepare</SPAN> API function, prior to execution, or just executed using the ODBC <SPAN CLASS="lee">SQLExecDirect</SPAN> API function (<SPAN CLASS="pop">ODBCDirect workspaces</SPAN> only).</P>
Settings and Return Values</P>
The setting or return value is a <SPAN CLASS="lee">Long</SPAN> value that can be one of the following constants.</P>

<TABLE COLS="2" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="96pt" VALIGN="TOP"><COL WIDTH="264pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD  VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">  </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbQPrepare</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">(Default) The statement is prepared (that is, the ODBC <SPAN CLASS="lee">SQLPrepare</SPAN> API is called). </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="lee">dbQUnprepare</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The statement is not prepared (that is, the ODBC <SPAN CLASS="lee">SQLExecDirect</SPAN> API is called).</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
You can use the <SPAN CLASS="lee">Prepare</SPAN> property to either have the server create a temporary stored procedure from your query and then execute it, or just have the query executed directly. By default the <SPAN CLASS="lee">Prepare</SPAN> property is set to <SPAN CLASS="lee">dbQPrepare</SPAN>. However, you can set this property to <SPAN CLASS="lee">dbQUnprepare</SPAN> to prohibit preparing of the query. In this case, the query is&nbsp;executed using the <SPAN CLASS="lee">SQLExecDirect</SPAN> API.</P>
Creating a stored procedure can slow down the initial operation, but increases performance of all subsequent references to the query. However, some queries cannot be executed in the form of stored procedures. In these cases, you must set the <SPAN CLASS="lee">Prepare</SPAN> property to <SPAN CLASS="lee">dbQUnprepare</SPAN>.</P>
If <SPAN CLASS="lee">Prepare</SPAN> is set to <SPAN CLASS="lee">dbQPrepare</SPAN>, this can be overridden when the query is executed by setting the <SPAN CLASS="lee">Execute</SPAN> method's <SPAN CLASS="narg">options</SPAN> argument to <SPAN CLASS="lee">dbExecDirect</SPAN>.</P>
<SPAN CLASS="nh">Note</SPAN>&nbsp;&nbsp;&nbsp;The ODBC <SPAN CLASS="lee">SQLPrepare</SPAN> API is called as soon as the DAO <SPAN CLASS="lee">SQL</SPAN> property is set. Therefore, if you want to improve performance using the <SPAN CLASS="lee">dbQUnprepare</SPAN> option, you must set&nbsp;the <SPAN CLASS="lee">Prepare</SPAN> property before setting the <SPAN CLASS="lee">SQL</SPAN> property.</P>
Example</P>
This example uses the <SPAN CLASS="eln">Prepare</SPAN> property to specify that a query should be executed directly rather than first creating a temporary stored procedure on the server.</P>

<pre><code>Sub PrepareX()

    Dim wrkODBC As Workspace
    Dim conPubs As Connection
    Dim qdfTemp As QueryDef
    Dim rstTemp As Recordset

    ' Create ODBCDirect Workspace object and open Connection
    ' object.
    Set wrkODBC = CreateWorkspace("", _
        "admin", "", dbUseODBC)
    Set conPubs = wrkODBC.OpenConnection("Publishers", , , _
        "ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers")

    Set qdfTemp = conPubs.CreateQueryDef("")

    With qdfTemp
        ' Because you will only run this query once, specify
        ' the ODBC SQLExecDirect API function. If you do
        ' not set this property before you set the SQL
        ' property, the ODBC SQLPrepare API function will
        ' be called anyway which will nullify any
        ' performance gain.
        .Prepare = dbQUnprepare
        .SQL = "UPDATE roysched " &amp; _
            "SET royalty = royalty * 2 " &amp; _
            "WHERE title_id LIKE 'BU____' OR " &amp; _
            "title_id LIKE 'PC____'"
        .Execute
    End With
    Debug.Print "Query results:"

    ' Open recordset containing modified records.
    Set rstTemp = conPubs.OpenRecordset( _
        "SELECT * FROM roysched " &amp; _
        "WHERE title_id LIKE 'BU____' OR " &amp; _
        "title_id LIKE 'PC____'")

    ' Enumerate recordset.
    With rstTemp
        Do While Not .EOF
            Debug.Print , !title_id, !lorange, _
                !hirange, !royalty
            .MoveNext
        Loop
        .Close
    End With

    conPubs.Close
    wrkODBC.Close

End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
