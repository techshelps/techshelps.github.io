<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Transactions Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>Transactions Property</H1>Applies To</P>
<SPAN CLASS="eln">Connection</SPAN> object, <SPAN CLASS="eln">Database</SPAN> object, Dynaset-Type <SPAN CLASS="eln">Recordset</SPAN> object, Forward-Only-Type <SPAN CLASS="eln">Recordset</SPAN> object, <SPAN CLASS="eln">Recordset</SPAN> object, Snapshot-Type <SPAN CLASS="eln">Recordset</SPAN> object, Table-Type <SPAN CLASS="eln">Recordset</SPAN> object.</P>
Description</P>
Returns a value that indicates whether an object supports <SPAN CLASS="pop">transactions</SPAN>.</P>
Return Values</P>
The return value is a<SPAN CLASS="eln"> </SPAN>Boolean data type that is <SPAN CLASS="eln">True</SPAN> if the object supports transactions.</P>
Remarks</P>
In an ODBCDirect workspace, the <B>Transactions</B> property is available on Connection and Database objects, and indicates whether or not the ODBC driver you are using supports transactions.</P>
In a <SPAN CLASS="pop">Microsoft Jet workspace</SPAN>, you can also use the <SPAN CLASS="eln">Transactions</SPAN> property with dynaset- or table-type <SPAN CLASS="eln">Recordset</SPAN> objects. Snapshot- and forward-only-type Recordset objects always return <SPAN CLASS="eln">False</SPAN>.</P>
If a dynaset- or table-type <SPAN CLASS="eln">Recordset</SPAN> is based on a <SPAN CLASS="pop">Microsoft Jet database engine</SPAN> table, the <SPAN CLASS="eln">Transactions</SPAN> property is <SPAN CLASS="eln">True</SPAN> and you can use transactions. Other database engines may not support transactions. For example, you can't use transactions in a dynaset-type <SPAN CLASS="eln">Recordset</SPAN> object based on a Paradox table.</P>
Check the <SPAN CLASS="eln">Transactions</SPAN> property before using the <SPAN CLASS="eln">BeginTrans</SPAN> method on the <SPAN CLASS="eln">Recordset</SPAN> object's Workspace object to make sure that transactions are supported. Using the <SPAN CLASS="eln">BeginTrans</SPAN><SPAN CLASS="eln">, </SPAN><SPAN CLASS="eln">CommitTrans</SPAN><SPAN CLASS="eln">, or</SPAN><SPAN CLASS="eln"> Rollback</SPAN> methods on an unsupported object has no effect.</P>
See Also</P>
<SPAN CLASS="eln">BeginTrans</SPAN>, <SPAN CLASS="eln">CommitTrans</SPAN>, <SPAN CLASS="eln">Rollback</SPAN> methods.</P>
Example</P>
This example demonstrates the <SPAN CLASS="eln">Transactions</SPAN> property in <SPAN CLASS="pop">Microsoft Jet</SPAN> and <SPAN CLASS="pop">ODBCDirect workspaces</SPAN>.</P>

<pre><code>Sub TransactionsX()
<B></B>
    Dim wrkJet As Workspace
<B>    </B>Dim wrkODBC As Workspace
<B>    </B>Dim dbsNorthwind As Database
<B>    </B>Dim conPubs As Connection
<B>    </B>Dim rstTemp As Recordset
<B></B>
    ' Open Microsoft Jet and ODBCDirect workspaces, a Microsoft
<B>    </B>' Jet database, and an ODBCDirect connection.
<B>    </B>Set wrkJet = CreateWorkspace("", "admin", "", dbUseJet)
<B>    </B>Set wrkODBC = CreateWorkspace("", "admin", "", dbUseODBC)
<B>    </B>Set dbsNorthwind = wrkJet.OpenDatabase("Northwind.mdb")
<B>    </B>Set conPubs = wrkODBC.OpenConnection("", , , _
<B>        </B>"ODBC;DATABASE=pubs;UID=sa;PWD=;DSN=Publishers")
<B></B>
    ' Open two different Recordset objects and display the
<B>    </B>' Transactions property of each.
<B></B>
    Debug.Print "Opening Microsoft Jet table-type " &amp; _
<B>        </B>"recordset..."
<B>    </B>Set rstTemp = dbsNorthwind.OpenRecordset( _
<B>        </B>"Employees", dbOpenTable)
<B>    </B>Debug.Print "    Transactions = " &amp; rstTemp.Transactions
<B></B>
    Debug.Print "Opening forward-only-type " &amp; _
<B>        </B>"recordset where the source is an SQL statement..."
<B>    </B>Set rstTemp = dbsNorthwind.OpenRecordset( _
<B>        </B>"SELECT * FROM Employees", dbOpenForwardOnly)
<B>    </B>Debug.Print "    Transactions = " &amp; rstTemp.Transactions
<B></B>
    ' Display Transactions property of a Connection object in
    ' an ODBCDirect workspace.
<B>    </B>Debug.Print "Testing Transaction property of " &amp; _
<B>        </B>"an ODBC connection..."
<B>    </B>Debug.Print "    Transactions = " &amp; conPubs.Transactions
<B></B>
    rstTemp.Close
<B>    </B>dbsNorthwind.Close
<B>    </B>conPubs.Close
<B>    </B>wrkJet.Close
<B>    </B>wrkODBC.Close

End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
