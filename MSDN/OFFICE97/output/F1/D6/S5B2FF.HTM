<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>CommandBar Object</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>CommandBar Object</H1>Description</P>
Represents a <SPAN CLASS="pop">command bar</SPAN> in the container application. The <SPAN CLASS="lee">CommandBar</SPAN> object is a member of the <SPAN CLASS="lee">CommandBars</SPAN> collection.</P>
Using the CommandBar Object</P>
Use <SPAN CLASS="lee">CommandBars</SPAN>(<SPAN CLASS="p">index</SPAN>), where <SPAN CLASS="p">index</SPAN> is the name or index number of a command bar, to return a single <SPAN CLASS="lee">CommandBar</SPAN> object. The following example steps through the collection of command bars to find the command bar named "Forms." If it finds this command bar, the example makes it visible and protects its docking state. In this example, the variable <SPAN CLASS="cte">cb</SPAN> represents a <SPAN CLASS="lee">CommandBar</SPAN> object.</P>

<pre><code>foundFlag = False
For Each cb In CommandBars
    If cb.Name = "Forms" Then
        cb.Protection = msoBarNoChangeDock
        cb.Visible = True
        foundFlag = True
    End If
Next cb
If Not foundFlag Then
    MsgBox "The collection does not contain a Forms command bar."
End If</code></pre>
You can use a name or index number to specify a menu bar or toolbar in the list of available menu bars and toolbars in the container application. However, you must use a name to specify a menu, shortcut menu, or submenu (all of which are represented by <SPAN CLASS="lee">CommandBar</SPAN> objects). This example adds a new menu item to the bottom of the <SPAN CLASS="eln">Tools</SPAN> menu. When clicked, the new menu item runs the procedure named "qtrReport."</P>

<pre><code>Set newItem = CommandBars("Tools").Controls.Add(Type:=msoControlButton)
With newItem
    .BeginGroup = True
    .Caption = "Make Report"
    .FaceID = 0
    .OnAction = "qtrReport"
End With</code></pre>
If two or more custom menus or submenus have the same name, <SPAN CLASS="lee">CommandBars</SPAN>(<SPAN CLASS="p">index</SPAN>) returns the first one. To ensure that you return the correct menu or submenu, locate the <SPAN CLASS="pop">pop-up control</SPAN> that displays that menu. Then apply the <SPAN CLASS="lee">CommandBar</SPAN> property to the pop-up control to return the command bar that represents that menu.</P>
Assuming that the third control on the toolbar named "Custom Tools" is a pop-up control, this example adds the <SPAN CLASS="eln">Save</SPAN> command to the bottom of that menu.</P>

<pre><code>Set viewMenu = CommandBars("Custom Tools").Controls(3).CommandBar
viewMenu.Controls.Add ID:=3             'ID of Save command is 3</code></pre>
Properties</P>
<SPAN CLASS="eln">Application</SPAN> property, <SPAN CLASS="eln">BuiltIn</SPAN> property, <SPAN CLASS="eln">Context</SPAN> property, <SPAN CLASS="eln">Controls</SPAN> property, <SPAN CLASS="eln">Creator</SPAN> property, <SPAN CLASS="eln">Enabled</SPAN> property, <SPAN CLASS="eln">Height</SPAN> property, <SPAN CLASS="eln">Index</SPAN> property, <SPAN CLASS="eln">Left</SPAN> property, <SPAN CLASS="eln">Name</SPAN> property, <SPAN CLASS="eln">NameLocal</SPAN> property, <SPAN CLASS="eln">Parent</SPAN> property, <SPAN CLASS="eln">Position</SPAN> property, <SPAN CLASS="eln">Protection</SPAN> property, <SPAN CLASS="eln">RowIndex</SPAN> property, <SPAN CLASS="eln">Top</SPAN> property, <SPAN CLASS="eln">Type</SPAN> property, <SPAN CLASS="eln">Visible</SPAN> property, <SPAN CLASS="eln">Width</SPAN> property.</P>
Methods</P>
<SPAN CLASS="eln">Delete</SPAN> method, <SPAN CLASS="eln">FindControl</SPAN> method, <SPAN CLASS="eln">Reset</SPAN> method, <SPAN CLASS="eln">ShowPopup</SPAN> method.</P>
<HR CLASS="rr"></FONT></BODY>
</HTML>
