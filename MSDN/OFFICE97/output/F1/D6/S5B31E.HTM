<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Execute Method (FileSearch and FileFind Objects)</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>Execute Method (FileSearch and FileFind Objects)</H1>Applies To</P>
<SPAN CLASS="eln">FileFind</SPAN> object, <SPAN CLASS="eln">FileSearch</SPAN> object.</P>
Description</P>
<B>FileSearch</B> object: Begins the search for the specified files.</P>
<B>FileFind</B> object: Begins the search for the specified files and updates the <B>FindFileResults</B> collection. Macintosh only.</P>
Syntax 1</P>
<SPAN CLASS="p">expression</SPAN><SPAN CLASS="l">.</SPAN><SPAN CLASS="lee">Execute</SPAN><SPAN CLASS="l">(</SPAN><SPAN CLASS="narg">SortBy,</SPAN> <SPAN CLASS="narg">SortOrder,</SPAN> <SPAN CLASS="narg">AlwaysAccurate</SPAN><SPAN CLASS="l">)</SPAN></P>
Syntax 2</P>
<SPAN CLASS="p">expression</SPAN><B>.</B><SPAN CLASS="lee">Execute</SPAN></P>
<SPAN CLASS="p">expression</SPAN>   Required<SPAN CLASS="p">.</SPAN> An expression that returns a <SPAN CLASS="lee">FileSearch</SPAN> object (Syntax 1) or a <SPAN CLASS="lee">FileFind</SPAN> object (Syntax 2).</P>
<SPAN CLASS="narg">SortBy</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. The method used to sort the returned files. Can be one of the following <B>MsoSortBy</B> constants: <B>msoSortbyFileName</B>, <B>msoSortbyFileType</B>, <B>msoSortbyLastModified</B>, or <B>msoSortbySize</B>.</P>
<SPAN CLASS="narg">SortOrder</SPAN>   Optional <SPAN CLASS="lee">Variant</SPAN>. The order in which the returned files are to be sorted. Can be either of the following <SPAN CLASS="lee">MsoSortOrder</SPAN> constants: <SPAN CLASS="lee">msoSortOrderAscending</SPAN> or <SPAN CLASS="lee">msoSortOrderDescending</SPAN>.</P>
<SPAN CLASS="narg">AlwaysAccurate</SPAN>   Optional <SPAN CLASS="lee">Boolean</SPAN>. <SPAN CLASS="lee">True</SPAN> to have the file search include files that have been added, modified, or deleted since the file index was last updated. The default value is <SPAN CLASS="lee">True</SPAN>.</P>
Example</P>
This example searches for all files that begin with "cmd" in the My Documents folder and displays the location and name of each file that's found. The example sorts the list of returned files in ascending alphabetic order, by file name.</P>

<pre><code>Set fs = Application.FileSearch
With fs
    .LookIn = "C:\My Documents"
    .FileName = "cmd*"
    If .Execute(SortBy:=msoSortbyFileName, _
            SortOrder:=msoSortOrderAscending) &gt; 0 Then
        MsgBox "There were " &amp; .FoundFiles.Count &amp; _
            " file(s) found."
        For i = 1 To .FoundFiles.Count
            MsgBox .FoundFiles(i)
        Next i
    Else
        MsgBox "There were no files found."
    End If
End With</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
