<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>KeyDown, KeyUp Events</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>KeyDown, KeyUp Events</H1>Applies To</P>
<SPAN CLASS="eln">CheckBox </SPAN>control, <SPAN CLASS="eln">ComboBox</SPAN> control, <SPAN CLASS="eln">CommandButton</SPAN> control, <SPAN CLASS="eln">Frame</SPAN> control, <SPAN CLASS="eln">ListBox</SPAN> control, <SPAN CLASS="eln">MultiPage</SPAN> control, <SPAN CLASS="eln">OptionButton</SPAN> control, <SPAN CLASS="eln">ScrollBar</SPAN> control, <SPAN CLASS="eln">SpinButton</SPAN> control, <SPAN CLASS="eln">TabStrip</SPAN> control, <SPAN CLASS="eln">TextBox</SPAN> control, <SPAN CLASS="eln">ToggleButton</SPAN> control, <SPAN CLASS="eln">UserForm</SPAN> object.</P>
Description</P>
Occur in sequence when a user presses and releases a key. KeyDown occurs when the user presses a key. KeyUp occurs when the user releases a key.</P>
Syntax</P>
<SPAN CLASS="lee">Private Sub </SPAN><SPAN CLASS="p">object</SPAN>_<SPAN CLASS="lee">KeyDown( ByVal </SPAN><SPAN CLASS="p">KeyCode</SPAN><SPAN CLASS="lee"> As MSForms.ReturnInteger</SPAN>, <BR>ú<SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Shift</SPAN><SPAN CLASS="lee"> As fmShiftState)</SPAN></P>
<SPAN CLASS="lee">Private Sub </SPAN><SPAN CLASS="p">object</SPAN>_<SPAN CLASS="lee">KeyUp( ByVal </SPAN><SPAN CLASS="p">KeyCode</SPAN><SPAN CLASS="lee"> As MSForms.ReturnInteger</SPAN>, <BR>ú<SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Shift</SPAN><SPAN CLASS="lee"> As fmShiftState)</SPAN></P>
The KeyDown and KeyUp event syntaxes have these parts:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="63pt" VALIGN="TOP"><COL WIDTH="296pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">object</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. A valid object name.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">KeyCode</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. An integer that represents the key code of the key that was pressed or released.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">Shift</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. The state of <SPAN CLASS="kn">SHIFT</SPAN>, <SPAN CLASS="kn">CTRL</SPAN>, and <SPAN CLASS="kn">ALT</SPAN>.</P></TD></TR></TBODY></TABLE>
<BR></P>Settings</P>
The settings for <SPAN CLASS="p">Shift</SPAN> are:</P>

<TABLE COLS="4" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="55pt" VALIGN="TOP"><COL WIDTH="221pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Value</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">fmShiftMask</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">1</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="kn">SHIFT</SPAN> was pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">fmCtrlMask</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">2</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="kn">CTRL</SPAN> was pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">fmAltMask</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">4</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="kn">ALT</SPAN> was pressed.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
The KeyDown event occurs when the user presses a key on a running form while that form or a control on it has the <SPAN CLASS="pop">focus</SPAN>. The KeyDown and KeyPress events alternate repeatedly until the user releases the key, at which time the KeyUp event occurs. The form or control with the focus receives all keystrokes. A form can have the focus only if it has no controls or all its visible controls are disabled.</P>
These events also occur if you send a keystroke to a form or control using either the SendKeys action in a macro or the <SPAN CLASS="eln">SendKeys</SPAN><SPAN CLASS="jump"> statement</SPAN> in Visual Basic.</P>
The KeyDown and KeyUp events are typically used to recognize or distinguish between:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">Extended character keys, such as function keys.</LI><LI CLASS="ULI1">Navigation keys, such as <SPAN CLASS="kn">HOME</SPAN>, <SPAN CLASS="kn">END</SPAN>, <SPAN CLASS="kn">PAGEUP</SPAN>, <SPAN CLASS="kn">PAGEDOWN</SPAN>, <SPAN CLASS="kn">UP ARROW</SPAN>, <SPAN CLASS="kn">DOWN ARROW</SPAN>, <SPAN CLASS="kn">RIGHT ARROW</SPAN>, <SPAN CLASS="kn">LEFT ARROW</SPAN>, and <SPAN CLASS="kn">TAB</SPAN>.</LI><LI CLASS="ULI1">Combinations of keys and standard keyboard modifiers (<SPAN CLASS="kn">SHIFT</SPAN>, <SPAN CLASS="kn">CTRL</SPAN>, or <SPAN CLASS="kn">ALT</SPAN>).</LI><LI CLASS="ULI1">The numeric keypad and keyboard number keys.
</LI></UL></SPAN>The KeyDown and KeyUp events do not occur under the following circumstances:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">The user presses enter on a form with a command button whose <SPAN CLASS="lee">Default</SPAN> property is set to <SPAN CLASS="lee">True</SPAN>.</LI><LI CLASS="ULI1">The user presses esc on a form with a command button whose <SPAN CLASS="lee">Cancel</SPAN> property is set to <SPAN CLASS="lee">True</SPAN>.
</LI></UL></SPAN>The KeyDown and KeyPress events occur when you press or send an ANSI key. The KeyUp event occurs after any event for a control caused by pressing or sending the key. If a keystroke causes the focus to move from one control to another control, the KeyDown event occurs for the first control, while the KeyPress and KeyUp events occur for the second control.</P>
The sequence of keyboard-related events is:</P>
<SPAN CLASS="list"><OL><LI CLASS="OLI1">KeyDown</LI><LI CLASS="OLI1">KeyPress</LI><LI CLASS="OLI1">KeyUp
</LI></OL></SPAN><SPAN CLASS="nh">Note</SPAN><B>   </B>The KeyDown and KeyUp events apply only to forms and controls on a form. To interpret ANSI characters or to find out the ANSI character corresponding to the key pressed, use the KeyPress event.</P>
See Also</P>
<SPAN CLASS="eln">Cancel</SPAN> property, <SPAN CLASS="eln">Default</SPAN> property, KeyPress event.</P>
Example</P>
See the <SPAN CLASS="eln">CurLine</SPAN> property example.</P>
<HR CLASS="rr"></FONT></BODY>
</HTML>
