<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>LastDLLError Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<HR CLASS="rr">
<H1>LastDLLError Property</H1>Applies To</P>
<SPAN CLASS="eln">Err</SPAN> object.</P>
Description</P>
Returns a system error code produced by a call to a <SPAN CLASS="pop">dynamic-link library</SPAN> (DLL). Read-only.</P>
Remarks</P>
The <SPAN CLASS="lee">LastDLLError</SPAN> <SPAN CLASS="pop">property</SPAN> applies only to DLL calls made from Visual Basic code. When such a call is made, the called function usually returns a code indicating success or failure, and the <SPAN CLASS="lee">LastDLLError</SPAN> property is filled. Check the documentation for the DLL's functions to determine the return values that indicate success or failure. Whenever the failure code is returned, the Visual Basic application should immediately check the <SPAN CLASS="lee">LastDLLError</SPAN> property. No exception is raised when the <SPAN CLASS="lee">LastDLLError</SPAN> property is set.</P>
See Also</P>
<SPAN CLASS="eln">Declare</SPAN> statement, <SPAN CLASS="eln">Description</SPAN> property, <SPAN CLASS="eln">Err</SPAN> object, <SPAN CLASS="eln">HelpContext</SPAN> property, <SPAN CLASS="eln">HelpContextID</SPAN> property ("Extensibility Object Model Language Reference"), <SPAN CLASS="eln">HelpFile</SPAN> property, <SPAN CLASS="eln">Number</SPAN> property, <SPAN CLASS="eln">Source</SPAN> property.</P>
Example</P>
When pasted into a <SPAN CLASS="eln">UserForm</SPAN> module, the following code causes an attempt to call a DLL function. The call fails because the argument that is passed in (a null pointer) generates an error, and in any event, SQL can't be cancelled if it isn't running. The code following the call checks the return of the call, and then prints at the <SPAN CLASS="lee">LastDLLError</SPAN> property of the <SPAN CLASS="lee">Err</SPAN> object to reveal the error code.</P>

<pre><code>Private Declare Function SQLCancel Lib "ODBC32.dll" _
    (ByVal hstmt As Long) As Integer

Private Sub UserForm_Click()
    Dim RetVal
    ' Call with invalid argument.
    RetVal = SQLCancel(myhandle&amp;)
    ' Check for SQL error code.
    If RetVal = -2 Then
        ' Display the information code.
        MsgBox "Error code is :" &amp; Err.LastDllError
    End If
End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
