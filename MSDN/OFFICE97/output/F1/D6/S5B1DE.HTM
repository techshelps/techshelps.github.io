<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>#If...Then...#Else Directive</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H2>#If...Then...#Else Directive</H2>Description</P>
Conditionally compiles selected blocks of Visual Basic code.</P>
Syntax</P>
<SPAN CLASS="lee">#If</SPAN> <SPAN CLASS="p">expression</SPAN> <SPAN CLASS="lee">Then</SPAN></P>
    <SPAN CLASS="p">statements</SPAN></P>
[<SPAN CLASS="lee">#ElseIf</SPAN> <SPAN CLASS="p">expression-n</SPAN> <SPAN CLASS="lee">Then</SPAN></P>
    [<SPAN CLASS="p">elseifstatements</SPAN>]]</P>
[<SPAN CLASS="lee">#Else</SPAN></P>
    [<SPAN CLASS="p">elsestatements</SPAN>]]</P>
<SPAN CLASS="lee">#End If</SPAN></P>
The <SPAN CLASS="lee">#If...Then...#Else</SPAN> directive syntax has these parts</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="89pt" VALIGN="TOP"><COL WIDTH="270pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">expression</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. Any <SPAN CLASS="pop">expression</SPAN>, consisting exclusively of one or more <SPAN CLASS="pop">conditional compiler constants</SPAN>, literals, and operators, that evaluates to <SPAN CLASS="lee">True</SPAN> or <SPAN CLASS="lee">False</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">statements</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. Visual Basic program lines or compiler directives that are evaluated if the associated expression is <SPAN CLASS="lee">True</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">expression-n</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. Any expression, consisting exclusively of one or more <SPAN CLASS="pop">conditional compiler constants</SPAN>, literals, and operators, that evaluates to <SPAN CLASS="lee">True</SPAN> or <SPAN CLASS="lee">False</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">elseifstatements</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. One or more program lines or compiler directives that are evaluated if <SPAN CLASS="p">expression-n</SPAN> is <SPAN CLASS="lee">True</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">elsestatements</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. One or more program lines or compiler directives that are evaluated if no previous <SPAN CLASS="p">expression</SPAN> or <SPAN CLASS="p">expression-n</SPAN> is <SPAN CLASS="lee">True</SPAN>.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
The behavior of the <SPAN CLASS="lee">#If...Then...#Else</SPAN> directive is the same as the <SPAN CLASS="lee">If...Then...Else</SPAN> statement, except that there is no single-line form of the <SPAN CLASS="lee">#If</SPAN>, <SPAN CLASS="lee">#Else</SPAN>, <SPAN CLASS="lee">#ElseIf</SPAN>, and <SPAN CLASS="lee">#End If</SPAN> directives; that is, no other code can appear on the same line as any of the directives. Conditional compilation is typically used to compile the same program for different platforms. It is also used to prevent debugging code from appearing in an executable file. Code excluded during conditional compilation is completely omitted from the final executable file, so it has no size or performance effect.</P>
Regardless of the outcome of any evaluation, all expressions are evaluated. Therefore, all <SPAN CLASS="pop">constants</SPAN> used in expressions must be defined — any undefined constant evaluates as Empty.</P>
<SPAN CLASS="nh">Note</SPAN>&nbsp;&nbsp;&nbsp;The <SPAN CLASS="lee">Option Compare</SPAN> statement does not affect expressions in <SPAN CLASS="lee">#If</SPAN> and <SPAN CLASS="lee">#ElseIf</SPAN> statements. Expressions in a conditional-compiler directive are always evaluated with <SPAN CLASS="lee">Option Compare Text</SPAN>.</P>
See Also</P>
#<SPAN CLASS="eln">Const</SPAN> directive, <B>If...Then...</B><SPAN CLASS="eln">Else</SPAN> statement.</P>
Example</P>
This example references conditional compiler constants in an <SPAN CLASS="lee">#If...Then...#Else</SPAN> construct to determine whether to compile certain statements.</P>

<pre><code>' If Mac evaluates as true, do the statements following the #If.
#If Mac Then
    '. Place exclusively Mac  statements here.
    '.
    '.
' Otherwise, if it is a 32-bit Windows program, do this:
#ElseIf Win32 Then    
    '. Place exclusively 32-bit Windows statements here.
    '.
    '.
' Otherwise, if it is neither, do this:
#Else
    '. Place other platform statements here.
    '.
    '.
#End If</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
