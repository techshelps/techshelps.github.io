<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>MouseMove Event</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>MouseMove Event</H1>Applies To</P>
<SPAN CLASS="eln">CheckBox</SPAN> control, <SPAN CLASS="eln">ComboBox</SPAN> control, <SPAN CLASS="eln">CommandButton</SPAN> control, <SPAN CLASS="eln">Frame</SPAN> control, <SPAN CLASS="eln">Image</SPAN> control, <SPAN CLASS="eln">Label</SPAN> control, <SPAN CLASS="eln">ListBox</SPAN> control, <SPAN CLASS="eln">MultiPage</SPAN> control, <SPAN CLASS="eln">OptionButton</SPAN> control, <SPAN CLASS="eln">TabStrip</SPAN> control, <SPAN CLASS="eln">TextBox</SPAN> control, <SPAN CLASS="eln">ToggleButton</SPAN> control, <SPAN CLASS="eln">UserForm</SPAN> object.</P>
Description</P>
Occurs when the user moves the mouse.</P>
Syntax</P>
For MultiPage, TabStrip:</P>
<SPAN CLASS="lee">Private Sub </SPAN><SPAN CLASS="p">object</SPAN>_<SPAN CLASS="lee">MouseMove( </SPAN><SPAN CLASS="p">index</SPAN><SPAN CLASS="lee"> As Long</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Button</SPAN><SPAN CLASS="lee"> As fmButton</SPAN>, <BR>ú<SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Shift</SPAN><SPAN CLASS="lee"> As fmShiftState</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">X</SPAN><SPAN CLASS="lee"> As Single</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Y</SPAN><SPAN CLASS="lee"> As Single)</SPAN></P>
For other controls:</P>
<SPAN CLASS="lee">Private Sub </SPAN><SPAN CLASS="p">object</SPAN>_<SPAN CLASS="lee">MouseMove( ByVal </SPAN><SPAN CLASS="p">Button</SPAN><SPAN CLASS="lee"> As fmButton</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Shift</SPAN><SPAN CLASS="lee"> As <BR></SPAN>ú<SPAN CLASS="lee">fmShiftState</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">X</SPAN><SPAN CLASS="lee"> As Single</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Y</SPAN><SPAN CLASS="lee"> As Single)</SPAN></P>
The MouseMove event syntax has these parts:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="54pt" VALIGN="TOP"><COL WIDTH="305pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">object</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. A valid object name.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">index</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. The index of the page or tab in a <SPAN CLASS="lee">MultiPage</SPAN> or <SPAN CLASS="lee">TabStrip</SPAN> associated with this event.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">Button</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. An integer value that identifies the state of the mouse buttons. </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">Shift</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. Specifies the state of <SPAN CLASS="kn">SHIFT</SPAN>, <SPAN CLASS="kn">CTRL</SPAN>, and <SPAN CLASS="kn">ALT</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">X, Y</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. The horizontal or vertical position, measured in points, from the left or top edge of the control.</P></TD></TR></TBODY></TABLE>
<BR></P>Settings</P>
The <SPAN CLASS="p">index</SPAN> argument specifies which page or tab was clicked over. A <SPAN CLASS="p">–</SPAN><SPAN CLASS="p">1</SPAN> designates that the user did not click on any of the pages or tabs.</P>
The settings for <SPAN CLASS="p">Button</SPAN> are:</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="54pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"><COL WIDTH="305pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Value</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">0</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">No button is pressed. </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">1</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The left button is pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">2</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The right button is pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">3</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The right and left buttons are pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">4</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The middle button is pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">5</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The middle and left buttons are pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">6</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The middle and right buttons are pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">7</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">All three buttons are pressed.</P></TD></TR></TBODY></TABLE>
<BR></P>The settings for <SPAN CLASS="p">Shift</SPAN> are:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="54pt" VALIGN="TOP"><COL WIDTH="305pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Value</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">1</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="kn">SHIFT</SPAN> was pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">2</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="kn">CTRL</SPAN> was pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">3</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="kn">SHIFT</SPAN> and <SPAN CLASS="kn">CTRL</SPAN> were pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">4</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="kn">ALT</SPAN> was pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">5</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="kn">ALT</SPAN> and <SPAN CLASS="kn">SHIFT</SPAN> were pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">6</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="kn">ALT</SPAN> and <SPAN CLASS="kn">CTRL</SPAN> were pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">7</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="kn">ALT</SPAN>, <SPAN CLASS="kn">SHIFT</SPAN>, and <SPAN CLASS="kn">CTRL</SPAN> were pressed.</P></TD></TR></TBODY></TABLE>
<BR></P>You can identify individual keyboard modifiers by using the following constants:</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="77pt" VALIGN="TOP"><COL WIDTH="60pt" VALIGN="TOP"><COL WIDTH="221pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Value</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">fmShiftMask</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">1</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Mask to detect <SPAN CLASS="kn">SHIFT</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">fmCtrlMask</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">2</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Mask to detect <SPAN CLASS="kn">CTRL</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">fmAltMask</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">4</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Mask to detect <SPAN CLASS="kn">ALT</SPAN>.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
The MouseMove event applies to forms, controls on a form, and labels.</P>
MouseMove events are generated continually as the mouse pointer moves across objects. Unless another object has captured the mouse, an object recognizes a MouseMove event whenever the mouse position is within its borders.</P>
Moving a form can also generate a MouseMove event even if the mouse is stationary. MouseMove events are generated when the form moves underneath the pointer. If a macro or event procedure moves a form in response to a MouseMove event, the event can continually generate (cascade) MouseMove events.</P>
If two controls are very close together, and you move the mouse pointer quickly over the space between them, the MouseMove event might not occur for that space. In such cases, you might need to respond to the MouseMove event in both controls.</P>
You can use the value returned in the <SPAN CLASS="p">Button</SPAN> argument to identify the state of the mouse buttons.</P>
Use the <SPAN CLASS="p">Shift</SPAN> argument to identify the state of <SPAN CLASS="kn">SHIFT</SPAN>, <SPAN CLASS="kn">CTRL</SPAN>, and <SPAN CLASS="kn">ALT</SPAN> when the MouseMove event occurred. For example, if both <SPAN CLASS="kn">CTRL</SPAN> and <SPAN CLASS="kn">ALT</SPAN> are pressed, the value of <SPAN CLASS="p">Shift</SPAN> is <SPAN CLASS="p">6</SPAN>.</P>
<SPAN CLASS="nh">Note</SPAN><B>   </B>You can use MouseDown and MouseUp event procedures to respond to events caused by pressing and releasing mouse buttons.</P>
See Also</P>
MouseDown, MouseUp events.</P>
Example</P>
The following example demonstrates a drag-and-drop operation from one <SPAN CLASS="lee">ListBox</SPAN> to another using a <SPAN CLASS="lee">DataObject</SPAN> to contain the dragged text. This code sample uses the <SPAN CLASS="lee">SetText</SPAN> and <SPAN CLASS="lee">StartDrag</SPAN> methods in the MouseMove event to implement the drag-and-drop operation.</P>
To use this example, copy this sample code to the Declarations portion of a form. Make sure that the form contains two <SPAN CLASS="lee">ListBox</SPAN> controls named ListBox1 and ListBox2. You also need to add choices to the second <SPAN CLASS="lee">ListBox</SPAN>.</P>

<pre><code>Private Sub ListBox2_BeforeDragOver(ByVal Cancel As MSForms.ReturnBoolean, _<BR>        ByVal Data As MSForms.DataObject, ByVal X As Single, ByVal Y As _<BR>        Single, ByVal DragState As Long, ByVal Effect As MSForms.Return _<BR>        Effect, ByVal Shift As Integer)
    Cancel = True
    Effect = 1
End Sub

Private Sub ListBox2_BeforeDropOrPaste(ByVal Cancel As MSForms.Return _<BR>        Boolean, ByVal Action As Long, ByVal Data As MSForms.DataObject, _<BR>        ByVal X As Single, ByVal Y As Single, ByVal Effect As MSForms. _<BR>        ReturnEffect, ByVal Shift As Integer)
    Cancel = True
    Effect = 1
    ListBox2.AddItem Data.GetText
End Sub

Private Sub ListBox1_MouseMove(ByVal Button As Integer, ByVal Shift As _<BR>        Integer, ByVal X As Single, ByVal Y As Single)
    Dim MyDataObject As DataObject
    If Button = 1 Then
        Set MyDataObject = New DataObject
        Dim Effect As Integer
        MyDataObject.SetText ListBox1.Value
        Effect = MyDataObject.StartDrag
    End If
End Sub

Private Sub UserForm_Initialize()
    For i = 1 To 10
        ListBox1.AddItem "Choice " &amp; (ListBox1.ListCount + 1)
    Next i
End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
