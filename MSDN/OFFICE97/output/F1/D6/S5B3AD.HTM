<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>ColumnWidths Property</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>ColumnWidths Property</H1>Applies To</P>
<SPAN CLASS="crkt">ComboBox</SPAN> control, <SPAN CLASS="crkt">ListBox</SPAN> control.</P>
Description</P>
Specifies the width of each column in a multicolumn combo box or list box.</P>
Syntax</P>
<SPAN CLASS="p">object</SPAN><SPAN CLASS="l">.</SPAN><SPAN CLASS="lee">ColumnWidths</SPAN> [= <SPAN CLASS="p">String</SPAN>]</P>
The <SPAN CLASS="lee">ColumnWidths</SPAN> property syntax has these parts:</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="63pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"><COL WIDTH="296pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">object</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. A valid object.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">String</SPAN></P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. Sets the column width in points. A setting of –1 or blank results in a calculated width. A width of 0 hides a column. To specify a different unit of measurement, include the unit of measure. A value greater than 0 explicitly specifies the width of the column.</P></TD></TR></TBODY></TABLE>
<BR></P>Settings</P>
To separate column entries, use semicolons (;) as list separators. Or use the list separator specified in the Regional Settings section of the Windows Control Panel.</P>
Any or all of the <SPAN CLASS="lee">ColumnWidths</SPAN> property settings can be blank. You create a blank setting by typing a list separator without a preceding value.</P>
If you specify a –1 in the property page, the displayed value in the property page is a blank.</P>
To calculate column widths when <SPAN CLASS="lee">ColumnWidths</SPAN> is blank or –1, the width of the control is divided equally among all columns of the list. If the sum of the specified column widths exceeds the width of the control, the list is left-aligned within the control and one or more of the rightmost columns are not displayed. Users can scroll the list using the horizontal scroll bar to display the rightmost columns.</P>
The minimum calculated column width is 72 <SPAN CLASS="pop">points</SPAN> (1 inch). To produce columns narrower than this, you must specify the width explicitly.</P>
Unless specified otherwise, column widths are measured in points. To specify another unit of measure, include the units as part of the values. The following examples specify column widths in several units of measure and describe how the various settings would fit in a three-column list box that is 4 inches wide.</P>

<TABLE COLS="4" BORDER="1" CELLPADDING="7"><COLGROUP><COL WIDTH="83pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"><COL WIDTH="276pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Setting</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Effect</P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><B></B></P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">90;72;90</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The first column is 90 points (1.25 inch); the second column is 72 points (1 inch); the third column is 90 points.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">6 cm;0;6 cm</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The first column is 6 centimeters; the second column is hidden; the third column is 6 centimeters. Because only part of the third column is visible, a horizontal scroll bar appears.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">1.5 in;0;2.5 in</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The first column is 1.5 inches, the second column is hidden, and the third column is 2.5 inches.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">2 in;;2 in</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">The first column is 2 inches, the second column is 1 inch (default), and the third column is 2 inches. Because only half of the third column is visible, a horizontal scroll bar appears.</P></TD></TR><TR><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">(Blank)</P></TD><TD COLSPAN="2" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">All three columns are the same width (1.33 inches).</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
In a combo box, the system displays the column designated by the <SPAN CLASS="lee">TextColumn</SPAN> property in the text box portion of the control.</P>
See Also</P>
<SPAN CLASS="eln">ColumnCount</SPAN> property, <SPAN CLASS="eln">ColumnHeads</SPAN> property, <SPAN CLASS="eln">TextColumn</SPAN> property.</P>
Example</P>
The following example uses the <SPAN CLASS="lee">ColumnWidths</SPAN> property to change the column widths of a multicolumn <SPAN CLASS="lee">ListBox</SPAN>. The example uses three <SPAN CLASS="lee">TextBox</SPAN> controls to specify the individual column widths and uses the Exit event to specify the units of measure of each <SPAN CLASS="lee">TextBox</SPAN>.</P>
To use this example, copy this sample code to the Declarations portion of a form. Make sure that the form contains:</P>
<SPAN CLASS="list"><UL><LI CLASS="ULI1">A <SPAN CLASS="lee">ListBox</SPAN> named ListBox1.</LI><LI CLASS="ULI1">Three <SPAN CLASS="lee">TextBox</SPAN> controls named TextBox1 through TextBox3.</LI><LI CLASS="ULI1">A <SPAN CLASS="lee">CommandButton</SPAN> named CommandButton1.
</LI></UL></SPAN>Try entering the value 0 to hide a column.</P>

<pre><code>Dim MyArray(2, 3) As String

Private Sub CommandButton1_Click()
    'ColumnWidths requires a value for each column separated by semicolons
    ListBox1.ColumnWidths = TextBox1.Text &amp; ";" &amp; TextBox2.Text &amp; ";" _<BR>        &amp; TextBox3.Text
End Sub

Private Sub TextBox1_Exit(ByVal Cancel as MSForms.ReturnBoolean)
    'ColumnWidths accepts points (no units), inches or centimeters; <BR>    'make inches the default
    If Not (InStr(TextBox1.Text, "in") &gt; 0 Or InStr(TextBox1.Text, "cm") _<BR>            &gt; 0) Then
        TextBox1.Text = TextBox1.Text &amp; " in"
    End If
End Sub

Private Sub TextBox2_Exit(ByVal Cancel as MSForms.ReturnBoolean)
    'ColumnWidths accepts points (no units), inches or centimeters; make <BR>    'inches the default
    If Not (InStr(TextBox2.Text, "in") &gt; 0 Or InStr(TextBox2.Text, "cm") _<BR>             &gt; 0) Then
        TextBox2.Text = TextBox2.Text &amp; " in"
    End If
End Sub

Private Sub TextBox3_Exit(ByVal Cancel as MSForms.ReturnBoolean)
    'ColumnWidths accepts points (no units), inches or centimeters; make <BR>    'inches the default
    If Not (InStr(TextBox3.Text, "in") &gt; 0 Or InStr(TextBox3.Text, "cm") _<BR>            &gt; 0) Then
        TextBox3.Text = TextBox3.Text &amp; " in"
    End If
End Sub

Private Sub UserForm_Initialize()
Dim i, j, Rows As Single

ListBox1.ColumnCount = 3
Rows = 2

For j = 0 To ListBox1.ColumnCount - 1
    For i = 0 To Rows - 1
        MyArray(i, j) = "Row " &amp; i &amp; ", Column " &amp; j
    Next i
Next j
    
ListBox1.List() = MyArray           'Load MyArray into ListBox1
   
TextBox1.Text = "1 in"              '1-inch columns initially
TextBox2.Text = "1 in"
TextBox3.Text = "1 in"

End Sub</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
