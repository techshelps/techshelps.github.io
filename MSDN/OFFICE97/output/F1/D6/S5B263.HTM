<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>Lock, Unlock Statements</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>Lock, Unlock Statements</H1>Description</P>
Controls access by other processes to all or part of a file opened using the <SPAN CLASS="lee">Open</SPAN> statement.</P>
Syntax</P>
<SPAN CLASS="lee">Lock</SPAN> [<SPAN CLASS="lee">#</SPAN>]<SPAN CLASS="p">filenumber</SPAN>[<B>,</B> <SPAN CLASS="p">recordrange</SPAN>]<BR><SPAN CLASS="lee">. . .</SPAN></P>
<SPAN CLASS="lee">Unlock </SPAN>[<SPAN CLASS="lee">#</SPAN>]<SPAN CLASS="p">filenumber</SPAN>[<B>,</B> <SPAN CLASS="p">recordrange</SPAN>]</P>
The <SPAN CLASS="lee">Lock</SPAN> and <SPAN CLASS="lee">Unlock</SPAN> statement syntax has these parts:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="68pt" VALIGN="TOP"><COL WIDTH="291pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">filenumber</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. Any valid <SPAN CLASS="pop">file number</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">recordrange</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. The range of records to lock or unlock.</P></TD></TR></TBODY></TABLE>
<BR></P>Settings</P>
The <SPAN CLASS="p">recordrange</SPAN> <SPAN CLASS="pop">argument</SPAN> settings are:</P>
<SPAN CLASS="p">recnumber</SPAN> | [<SPAN CLASS="p">start</SPAN>] <SPAN CLASS="lee">To</SPAN> <SPAN CLASS="p">end</SPAN></P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="68pt" VALIGN="TOP"><COL WIDTH="291pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Setting</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">recnumber</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Record number (<SPAN CLASS="lee">Random</SPAN> mode files) or byte number (<SPAN CLASS="lee">Binary</SPAN> mode files) at which locking or unlocking begins.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">start</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Number of the first record or byte to lock or unlock.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">end</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Number of the last record or byte to lock or unlock.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
The <SPAN CLASS="lee">Lock</SPAN> and <SPAN CLASS="lee">Unlock</SPAN> statements are used in environments where several processes might need access to the same file.</P>
<SPAN CLASS="lee">Lock</SPAN> and <SPAN CLASS="lee">Unlock</SPAN> statements are always used in pairs. The arguments to <SPAN CLASS="lee">Lock</SPAN> and <SPAN CLASS="lee">Unlock</SPAN> must match exactly.</P>
The first record or byte in a file is at position 1, the second record or byte is at position 2, and so on. If you specify just one record, then only that record is locked or unlocked. If you specify a range of records and omit a starting record (<SPAN CLASS="p">start</SPAN>), all records from the first record to the end of the range (<SPAN CLASS="p">end</SPAN>) are locked or unlocked. Using <SPAN CLASS="lee">Lock</SPAN> without <SPAN CLASS="p">recnumber</SPAN> locks the entire file; using <SPAN CLASS="lee">Unlock</SPAN> without <SPAN CLASS="p">recnumber</SPAN> unlocks the entire file.</P>
If the file has been opened for sequential input or output, <SPAN CLASS="lee">Lock</SPAN> and <SPAN CLASS="lee">Unlock</SPAN> affect the entire file, regardless of the range specified by <SPAN CLASS="p">start</SPAN> and <SPAN CLASS="p">end</SPAN>.</P>
<HR CLASS="cas">
<SPAN CLASS="cah">Caution</SPAN>&nbsp;&nbsp;&nbsp;Be sure to remove all locks with an <SPAN CLASS="lee">Unlock</SPAN> statement before closing a file or quitting your program. Failure to remove locks produces unpredictable results.</P>
<HR CLASS="cae">
See Also</P>
<SPAN CLASS="eln">Open</SPAN> statement.</P>
Example</P>
This example illustrates the use of the <SPAN CLASS="lee">Lock</SPAN> and <SPAN CLASS="lee">Unlock</SPAN> statements. While a record is being modified, access by other processes to the record is denied. This example assumes that <SPAN CLASS="cte">TESTFILE</SPAN> is a file containing five records of the user-defined type <SPAN CLASS="cte">Record</SPAN>.</P>

<pre><code>Type Record                                    ' Define user-defined type.
    ID As Integer
    Name As String * 20
End Type

Dim MyRecord As Record, RecordNumber        ' Declare variables.
' Open sample file for random access.
Open "TESTFILE" For Random Shared As #1 Len = Len(MyRecord)
RecordNumber = 4                            ' Define record number.
Lock #1, RecordNumber                        ' Lock record.
Get #1, RecordNumber, MyRecord        ' Read record.
MyRecord.ID = 234                            ' Modify record.
MyRecord.Name = "John Smith"
Put #1, RecordNumber, MyRecord        ' Write modified record.
Unlock #1, RecordNumber                    ' Unlock current record.
Close #1                                        ' Close file.</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
