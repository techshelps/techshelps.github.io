<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>With Statement</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>With Statement</H1>Description</P>
Executes a series of <SPAN CLASS="pop">statements</SPAN> on a single object or a <SPAN CLASS="pop">user-defined type</SPAN>.</P>
Syntax</P>
<SPAN CLASS="lee">With</SPAN> <SPAN CLASS="p">object</SPAN><BR>[<SPAN CLASS="p">statements</SPAN>]</P>
<SPAN CLASS="lee">End With</SPAN></P>
The <SPAN CLASS="lee">With</SPAN> statement syntax has these parts:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="56pt" VALIGN="TOP"><COL WIDTH="303pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">object</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. Name of an object or a user-defined type.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">statements</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Optional. One or more statements to be executed on <SPAN CLASS="p">object</SPAN>.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
The <SPAN CLASS="lee">With</SPAN> statement allows you to perform a series of statements on a specified object without requalifying the name of the object. For example, to change a number of different <SPAN CLASS="pop">properties</SPAN> on a single object, place the property assignment statements within the <SPAN CLASS="lee">With</SPAN> control structure, referring to the object once instead of referring to it with each property assignment. The following example illustrates use of the <SPAN CLASS="lee">With</SPAN> statement to assign values to several properties of the same object.</P>

<pre><code>With MyLabel
    .Height = 2000
    .Width = 2000
    .Caption = "This is MyLabel"
End With</code></pre>
<SPAN CLASS="nh">Note</SPAN>&nbsp;&nbsp;&nbsp;Once a <SPAN CLASS="lee">With</SPAN> block is entered, <SPAN CLASS="p">object</SPAN> can't be changed. As a result, you can't use a single <SPAN CLASS="lee">With</SPAN> statement to affect a number of different objects.</P>
You can nest <SPAN CLASS="lee">With</SPAN> statements by placing one <SPAN CLASS="lee">With</SPAN> block within another. However, because members of outer <SPAN CLASS="lee">With</SPAN> blocks are masked within the inner <SPAN CLASS="lee">With</SPAN> blocks, you must provide a fully qualified object reference in an inner <SPAN CLASS="lee">With</SPAN> block to any member of an object in an outer <SPAN CLASS="lee">With</SPAN> block.</P>
<SPAN CLASS="ih">Important</SPAN>&nbsp;&nbsp;&nbsp;Do not jump into or out of <SPAN CLASS="lee">With</SPAN> blocks. If statements in a <SPAN CLASS="lee">With</SPAN> block are executed, but either the <SPAN CLASS="lee">With</SPAN> or <SPAN CLASS="lee">End With</SPAN> statement is not executed, you may get errors or unpredictable behavior.</P>
See Also</P>
<B>Do...</B><SPAN CLASS="eln">Loop</SPAN> statement.</P>
Example </P>
This example uses the <SPAN CLASS="lee">With</SPAN> statement to execute a series of statements on a single object. The object <SPAN CLASS="cte">MyObject</SPAN> and its properties are generic names used for illustration purposes only.</P>

<pre><code>With MyObject
    .Height = 100                    ' Same as MyObject.Height = 100.
    .Caption = "Hello World"        ' Same as MyObject.Caption = "Hello World".
    With .Font
        .Color = Red                    ' Same as MyObject.Font.Color = Red.
        .Bold = True                    ' Same as MyObject.Font.Bold = True.
    End With
End With</code></pre>
Example (Microsoft Excel)</P>
This example creates a formatted multiplication table in cells A1:K11 on Sheet1.</P>

<pre><code>Set dataTableRange = Worksheets("Sheet1").Range("A1:K11")
Set rowInputCell = Worksheets("Sheet1").Range("A12")
Set columnInputCell = Worksheets("Sheet1").Range("A13")

Worksheets("Sheet1").Range("A1").Formula = "=A12*A13"
For i = 2 To 11
    Worksheets("Sheet1").Cells(i, 1) = i - 1
    Worksheets("Sheet1").Cells(1, i) = i - 1
Next i
dataTableRange.Table rowInputCell, columnInputCell
With Worksheets("Sheet1").Range("A1").CurrentRegion
    .Rows(1).Font.Bold = True
    .Columns(1).Font.Bold = True
    .Columns.AutoFit
End With</code></pre>
<HR CLASS="rr"></FONT></BODY>
</HTML>
