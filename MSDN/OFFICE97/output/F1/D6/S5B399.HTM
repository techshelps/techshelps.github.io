<HTML>
<HEAD>

<meta http-equiv="Content-Type" content="text/html; charset=iso8859-1">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-83731338-2"></script><script>  window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-83731338-2');</script><title>BeforeDropOrPaste Event</TITLE><style>@import url(msdn_ie4.css);</style>
<link disabled rel="stylesheet" href="msdn_ie3.css"></HEAD><BODY BGCOLOR="#FFFFFF">

<FONT FACE="Verdana, Arial, Helvetica" SIZE="2">

<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE=2>
	<!--TOOLBAR_START-->
	<!--TOOLBAR_EXEMPT-->
	<!--TOOLBAR_END-->



<H1>BeforeDropOrPaste Event</H1>Applies To</P>
<SPAN CLASS="crkt">CheckBox</SPAN> control, <SPAN CLASS="crkt">ComboBox</SPAN> control, <SPAN CLASS="crkt">CommandButton</SPAN> control, <SPAN CLASS="crkt">Frame</SPAN> control, <SPAN CLASS="crkt">Image</SPAN> control, <SPAN CLASS="crkt">Label</SPAN> control, <SPAN CLASS="crkt">ListBox</SPAN> control, <SPAN CLASS="crkt">MultiPage</SPAN> control, <SPAN CLASS="crkt">OptionButton</SPAN> control, <SPAN CLASS="crkt">TabStrip</SPAN> control, <SPAN CLASS="crkt">TextBox</SPAN> control, <SPAN CLASS="crkt">ToggleButton</SPAN> control, <SPAN CLASS="eln">UserForm</SPAN> object.</P>
Description</P>
Occurs when the user is about to drop or paste data onto an object.</P>
Syntax</P>
For Frame</P>
<SPAN CLASS="lee">Private Sub </SPAN><SPAN CLASS="p">object</SPAN>_<SPAN CLASS="lee">BeforeDropOrPaste( ByVal </SPAN><SPAN CLASS="p">Cancel</SPAN><SPAN CLASS="lee"> As<BR></SPAN>ú<SPAN CLASS="lee">MSForms.ReturnBoolean</SPAN>, <SPAN CLASS="p">ctrl</SPAN><SPAN CLASS="lee"> As Control</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Action</SPAN><SPAN CLASS="lee"> As fmAction</SPAN>, <SPAN CLASS="lee"><BR></SPAN>ú<SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Data</SPAN><SPAN CLASS="lee"> As DataObject</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">X</SPAN><SPAN CLASS="lee"> As Single</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Y</SPAN><SPAN CLASS="lee"> As Single</SPAN>, <SPAN CLASS="lee">ByVal</SPAN> <SPAN CLASS="p">Effect</SPAN><SPAN CLASS="lee"> As<BR></SPAN>ú<SPAN CLASS="lee">MSForms.ReturnEffect</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Shift</SPAN><SPAN CLASS="lee"> As fmShiftState)</SPAN></P>
For MultiPage</P>
<SPAN CLASS="lee">Private Sub </SPAN><SPAN CLASS="p">object</SPAN>_<SPAN CLASS="lee">BeforeDropOrPaste( </SPAN><SPAN CLASS="p">index</SPAN><SPAN CLASS="lee"> As Long</SPAN>, <SPAN CLASS="lee">ByVal</SPAN> <SPAN CLASS="p">Cancel</SPAN><SPAN CLASS="lee"> As<BR></SPAN>ú<SPAN CLASS="lee">MSForms.ReturnBoolean</SPAN>, <SPAN CLASS="p">ctrl</SPAN><SPAN CLASS="lee"> As Control</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Action</SPAN><SPAN CLASS="lee"> As fmAction</SPAN>, <SPAN CLASS="lee">ByVal<BR></SPAN>ú<SPAN CLASS="p">Data</SPAN><SPAN CLASS="lee"> As DataObject</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">X</SPAN><SPAN CLASS="lee"> As Single</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Y</SPAN><SPAN CLASS="lee"> As Single</SPAN>, <SPAN CLASS="lee">ByVal</SPAN> <SPAN CLASS="p">Effect</SPAN><SPAN CLASS="lee"> As<BR></SPAN>ú<SPAN CLASS="lee">MSForms.ReturnEffect</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Shift</SPAN><SPAN CLASS="lee"> As fmShiftState)</SPAN></P>
For TabStrip</P>
<SPAN CLASS="lee">Private Sub </SPAN><SPAN CLASS="p">object</SPAN>_<SPAN CLASS="lee">BeforeDropOrPaste( </SPAN><SPAN CLASS="p">index</SPAN><SPAN CLASS="lee"> As Long</SPAN>, <SPAN CLASS="lee">ByVal</SPAN> <SPAN CLASS="p">Cancel</SPAN><SPAN CLASS="lee"> As<BR></SPAN>ú<SPAN CLASS="lee">MSForms.ReturnBoolean</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Action</SPAN><SPAN CLASS="lee"> As fmAction</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Data</SPAN><SPAN CLASS="lee"> As DataObject</SPAN>,<BR>ú<SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">X</SPAN><SPAN CLASS="lee"> As Single</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Y</SPAN><SPAN CLASS="lee"> As Single</SPAN>, <SPAN CLASS="lee">ByVal</SPAN> <SPAN CLASS="p">Effect</SPAN><SPAN CLASS="lee"> As MSForms.ReturnEffect</SPAN>,<BR>ú<SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Shift</SPAN><SPAN CLASS="lee"> As fmShiftState)</SPAN></P>
For other controls</P>
<SPAN CLASS="lee">Private Sub </SPAN><SPAN CLASS="p">object</SPAN>_<SPAN CLASS="lee">BeforeDropOrPaste( ByVal </SPAN><SPAN CLASS="p">Cancel</SPAN><SPAN CLASS="lee"> As MSForms.ReturnBoolean</SPAN>,<BR>ú<SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Action</SPAN><SPAN CLASS="lee"> As fmAction</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Data</SPAN><SPAN CLASS="lee"> As DataObject</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">X</SPAN><SPAN CLASS="lee"> As Single</SPAN>, <SPAN CLASS="lee">ByVal<BR></SPAN>ú<SPAN CLASS="p">Y</SPAN><SPAN CLASS="lee"> As Single</SPAN>, <SPAN CLASS="lee">ByVal</SPAN> <SPAN CLASS="p">Effect</SPAN><SPAN CLASS="lee"> As MSForms.ReturnEffect</SPAN>, <SPAN CLASS="lee">ByVal </SPAN><SPAN CLASS="p">Shift</SPAN><SPAN CLASS="lee"> As fmShiftState)</SPAN></P>
The <SPAN CLASS="lee">BeforeDropOrPaste</SPAN> event syntax has these parts:</P>

<TABLE COLS="3" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="58pt" VALIGN="TOP"><COL WIDTH="301pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Part</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="3" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">object</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. A valid object name.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">index</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. The index of the <SPAN CLASS="lee">Page</SPAN> in a <SPAN CLASS="lee">MultiPage</SPAN> that the drop or paste operation will affect. </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">Cancel</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. Event status. <SPAN CLASS="lee">False</SPAN> indicates that the control should handle the event (default). <SPAN CLASS="lee">True</SPAN> indicates the application handles the event.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">ctrl</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. The target control.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">Action</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. Indicates the result, based on the current keyboard settings, of the pending drag-and-drop operation.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">Data</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. Data that is dragged in a drag-and-drop operation. The data is packaged in a <SPAN CLASS="lee">DataObject</SPAN>.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">X, Y</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. The horizontal and vertical position of the mouse pointer when the drop occurs. Both coordinates are measured in points. <SPAN CLASS="p">X</SPAN> is measured from the left edge of the control; <SPAN CLASS="p">Y</SPAN> is measured from the top of the control..</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">Effect</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. Effect of the drag-and-drop operation on the target control.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">Shift</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Required. Specifies the state of <SPAN CLASS="kn">SHIFT</SPAN>, <SPAN CLASS="kn">CTRL</SPAN>, and <SPAN CLASS="kn">ALT</SPAN>.</P></TD></TR></TBODY></TABLE>
<BR></P>Settings</P>
The settings for <SPAN CLASS="p">Action</SPAN> are:</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="100pt" VALIGN="TOP"><COL WIDTH="51pt" VALIGN="TOP"><COL WIDTH="207pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Value</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">fmActionPaste</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">2</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Pastes the selected object into the drop target. </P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">fmActionDragDrop</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">3</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Indicates the user has dragged the object from its source to the drop target and dropped it on the drop target.</P></TD></TR></TBODY></TABLE>
<BR></P>The settings for <SPAN CLASS="p">Effect</SPAN> are:</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="138pt" VALIGN="TOP"><COL WIDTH="51pt" VALIGN="TOP"><COL WIDTH="170pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Value</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">fmDropEffectNone</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">0</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Does not copy or move the <SPAN CLASS="pop">drop source</SPAN> to the drop target.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">fmDropEffectCopy</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">1</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Copies the drop source to the drop target.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">fmDropEffectMove</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">2</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Moves the drop source to the drop target.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">fmDropEffectCopyOrMove</SPAN> </P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">3</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Copies or moves the drop source to the drop target.</P></TD></TR></TBODY></TABLE>
<BR></P>The settings for <SPAN CLASS="p">Shift</SPAN> are:</P>

<TABLE COLS="4" BORDER="0" CELLPADDING="7"><COLGROUP><COL WIDTH="82pt" VALIGN="TOP"><COL WIDTH="51pt" VALIGN="TOP"><COL WIDTH="226pt" VALIGN="TOP"><COL WIDTH="0pt" VALIGN="TOP"></COLGROUP><TBODY><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Constant</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Value</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">Description</P></TD></TR><TR><TD COLSPAN="4" VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"></P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">fmShiftMask</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">1</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="kn">SHIFT</SPAN> was pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">fmCtrlMask</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">2</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="kn">CTRL</SPAN> was pressed.</P></TD></TR><TR><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="p">fmAltMask</SPAN></P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2">4</P></TD><TD VALIGN="TOP"><FONT FACE="Verdana, Arial, Helvetica" SIZE="2"><SPAN CLASS="kn">ALT</SPAN> was pressed.</P></TD></TR></TBODY></TABLE>
<BR></P>Remarks</P>
For a <SPAN CLASS="lee">MultiPage</SPAN> or <SPAN CLASS="lee">TabStrip</SPAN>, Visual Basic for Applications initiates this event when it transfers a data object to the control.</P>
For other controls, the system initiates this event immediately prior to the drop or paste operation.</P>
When a control handles this event, you can update the <SPAN CLASS="p">Action</SPAN> argument to identify the drag-and-drop action to perform. When <SPAN CLASS="p">Effect</SPAN> is set to <SPAN CLASS="l">fmDropEffectCopyOrMove</SPAN>, you can assign <SPAN CLASS="p">Action</SPAN> to <SPAN CLASS="l">fmDropEffectNone</SPAN>, <SPAN CLASS="l">fmDropEffectCopy</SPAN>, or <SPAN CLASS="l">fmDropEffectMove</SPAN>. When <SPAN CLASS="p">Effect</SPAN> is set to <SPAN CLASS="l">fmDropEffectCopy</SPAN> or <SPAN CLASS="l">fmDropEffectMove</SPAN>, you can reassign <SPAN CLASS="p">Action</SPAN> to <SPAN CLASS="l">fmDropEffectNone</SPAN>. You cannot reassign <SPAN CLASS="p">Action</SPAN> when <SPAN CLASS="p">Effect</SPAN> is set to <SPAN CLASS="l">fmDropEffectNone</SPAN>.</P>
See Also</P>
BeforeDragOver event, <SPAN CLASS="eln">DataObject</SPAN> object.</P>
<HR CLASS="rr"></FONT></BODY>
</HTML>
